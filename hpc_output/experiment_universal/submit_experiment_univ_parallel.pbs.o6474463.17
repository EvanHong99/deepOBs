This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W5/deepLOB_L1/h300
Epoch 1/50
9913/9913 - 190s - loss: 3.2169 - accuracy300: 0.4105 - val_loss: 3.4905 - val_accuracy300: 0.3396 - 190s/epoch - 19ms/step
Epoch 2/50
9913/9913 - 159s - loss: 3.1933 - accuracy300: 0.4231 - val_loss: 3.4245 - val_accuracy300: 0.3251 - 159s/epoch - 16ms/step
Epoch 3/50
9913/9913 - 159s - loss: 3.1813 - accuracy300: 0.4296 - val_loss: 3.4143 - val_accuracy300: 0.3180 - 159s/epoch - 16ms/step
Epoch 4/50
9913/9913 - 161s - loss: 3.1728 - accuracy300: 0.4335 - val_loss: 3.4220 - val_accuracy300: 0.3209 - 161s/epoch - 16ms/step
Epoch 5/50
9913/9913 - 160s - loss: 3.1667 - accuracy300: 0.4363 - val_loss: 3.4686 - val_accuracy300: 0.3060 - 160s/epoch - 16ms/step
Epoch 6/50
9913/9913 - 159s - loss: 3.1611 - accuracy300: 0.4388 - val_loss: 3.4784 - val_accuracy300: 0.3091 - 159s/epoch - 16ms/step
Epoch 7/50
9913/9913 - 158s - loss: 3.1561 - accuracy300: 0.4410 - val_loss: 3.5006 - val_accuracy300: 0.3057 - 158s/epoch - 16ms/step
Epoch 8/50
9913/9913 - 155s - loss: 3.1528 - accuracy300: 0.4421 - val_loss: 3.5013 - val_accuracy300: 0.3112 - 155s/epoch - 16ms/step
Epoch 9/50
9913/9913 - 157s - loss: 3.1491 - accuracy300: 0.4436 - val_loss: 3.5049 - val_accuracy300: 0.3079 - 157s/epoch - 16ms/step
Epoch 10/50
9913/9913 - 161s - loss: 3.1457 - accuracy300: 0.4445 - val_loss: 3.4898 - val_accuracy300: 0.3234 - 161s/epoch - 16ms/step
Epoch 11/50
9913/9913 - 159s - loss: 3.1429 - accuracy300: 0.4456 - val_loss: 3.4905 - val_accuracy300: 0.3230 - 159s/epoch - 16ms/step
Epoch 12/50
9913/9913 - 159s - loss: 3.1412 - accuracy300: 0.4463 - val_loss: 3.4952 - val_accuracy300: 0.3293 - 159s/epoch - 16ms/step
Epoch 13/50
9913/9913 - 161s - loss: 3.1392 - accuracy300: 0.4470 - val_loss: 3.4585 - val_accuracy300: 0.3287 - 161s/epoch - 16ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 344s - 344s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1374028
{'0': {'precision': 0.386066497537039, 'recall': 0.21460650485408875, 'f1-score': 0.275865175720797, 'support': 4850962}, '1': {'precision': 0.22586274176048762, 'recall': 0.45142760791366904, 'f1-score': 0.30108409865521574, 'support': 3024640}, '2': {'precision': 0.3816026611667528, 'recall': 0.314995056207306, 'f1-score': 0.34511440019127226, 'support': 4962789}, 'accuracy': 0.30920603680009434, 'macro avg': {'precision': 0.3311773001547598, 'recall': 0.32700972299168796, 'f1-score': 0.307354558189095, 'support': 12838391}, 'weighted avg': {'precision': 0.34659801851126043, 'recall': 0.30920603680009434, 'f1-score': 0.3085754625881284, 'support': 12838391}}
[[1041048 2333757 1476157]
 [ 602096 1365406 1057138]
 [1053407 2346128 1563254]]
Evaluating performance on  train set...
9913/9913 - 67s - 67s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1315273
{'0': {'precision': 0.33840115954955957, 'recall': 0.2686504808078138, 'f1-score': 0.299518618104354, 'support': 847324}, '1': {'precision': 0.30069424442273485, 'recall': 0.24211852664775424, 'f1-score': 0.26824588996870913, 'support': 836487}, '2': {'precision': 0.3318603987168506, 'recall': 0.4631690228334478, 'f1-score': 0.38667111536847093, 'support': 853222}, 'accuracy': 0.3253205614589956, 'macro avg': {'precision': 0.323651934229715, 'recall': 0.3246460100963386, 'f1-score': 0.3181452078138447, 'support': 2537033}, 'weighted avg': {'precision': 0.3237690813097819, 'recall': 0.3253205614589956, 'f1-score': 0.3185176604820775, 'support': 2537033}}
[[227634 240840 378850]
 [217174 202529 416784]
 [227867 230169 395186]]
Evaluating performance on  val set...
3496/3496 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1384581
{'0': {'precision': 0.327416554119236, 'recall': 0.23865137818709856, 'f1-score': 0.2760743275580601, 'support': 305764}, '1': {'precision': 0.2759919978340002, 'recall': 0.26003833576032, 'f1-score': 0.26777775548141, 'support': 282243}, '2': {'precision': 0.3407116535363153, 'recall': 0.45109923843611616, 'f1-score': 0.3882107937507202, 'support': 306212}, 'accuracy': 0.31815137007824706, 'macro avg': {'precision': 0.3147067351631838, 'recall': 0.3165963174611783, 'f1-score': 0.3106876255967301, 'support': 894219}, 'weighted avg': {'precision': 0.31573809273906944, 'recall': 0.31815137007824706, 'f1-score': 0.31185513985701246, 'support': 894219}}
[[ 72971  97871 134922]
 [ 76481  73394 132368]
 [ 73417  94663 138132]]
testing model out of sample: results/universal/W5/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 136s - 136s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1289481
{'0': {'precision': 0.36193774484831454, 'recall': 0.234434328989295, 'f1-score': 0.2845560215568306, 'support': 1906214}, '1': {'precision': 0.27180169625347017, 'recall': 0.48270570463303125, 'f1-score': 0.3477771832491821, 'support': 1503357}, '2': {'precision': 0.3587653806394524, 'recall': 0.2671893023829033, 'f1-score': 0.3062786312560218, 'support': 1939273}, 'accuracy': 0.31608960739928105, 'macro avg': {'precision': 0.33083494058041235, 'recall': 0.32810977866840985, 'f1-score': 0.3128706120206781, 'support': 5348844}, 'weighted avg': {'precision': 0.3354537531925825, 'recall': 0.31608960739928105, 'f1-score': 0.3102008237715724, 'support': 5348844}}
[[446882 974707 484625]
 [336189 725679 441489]
 [451622 969498 518153]]
Evaluating performance on  train set...
4957/4957 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1290253
{'0': {'precision': 0.33305260654819996, 'recall': 0.3146416060392618, 'f1-score': 0.3235854357915459, 'support': 427337}, '1': {'precision': 0.3281218202432916, 'recall': 0.3774731128852705, 'f1-score': 0.35107158251163123, 'support': 418602}, '2': {'precision': 0.33970992095398206, 'recall': 0.3080740048058143, 'f1-score': 0.32311945900110867, 'support': 422405}, 'accuracy': 0.33319115318872483, 'macro avg': {'precision': 0.3336281159151579, 'recall': 0.33339624124344885, 'f1-score': 0.33259215910142864, 'support': 1268344}, 'weighted avg': {'precision': 0.33364238809229774, 'recall': 0.33319115318872483, 'f1-score': 0.33250172747830953, 'support': 1268344}}
[[134458 164955 127924]
 [135579 158011 125012]
 [133677 158596 130132]]
Evaluating performance on  val set...
1701/1701 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1283365
{'0': {'precision': 0.34458715352873276, 'recall': 0.35267557052357124, 'f1-score': 0.34858444822506557, 'support': 147277}, '1': {'precision': 0.3156304068142496, 'recall': 0.4001391984139817, 'f1-score': 0.3528959515889525, 'support': 142243}, '2': {'precision': 0.34204403422747814, 'recall': 0.24442123777069363, 'f1-score': 0.28510750835463733, 'support': 145552}, 'accuracy': 0.3319772359517505, 'macro avg': {'precision': 0.3340871981901535, 'recall': 0.3324120022360822, 'f1-score': 0.3288626360562184, 'support': 435072}, 'weighted avg': {'precision': 0.3342692047215366, 'recall': 0.3319772359517505, 'f1-score': 0.3287580416095371, 'support': 435072}}
[[51941 63170 32166]
 [49058 56917 36268]
 [49735 60241 35576]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1421207
{'0': {'precision': 0.2979613917202893, 'recall': 0.235179109173446, 'f1-score': 0.2628736498367244, 'support': 88996}, '1': {'precision': 0.2690109697619934, 'recall': 0.2970862048119937, 'f1-score': 0.28235240043205484, 'support': 82710}, '2': {'precision': 0.3457178267446735, 'recall': 0.3808400425642982, 'f1-score': 0.36243002082656633, 'support': 99614}, 'accuracy': 0.30752985404688193, 'macro avg': {'precision': 0.30423006274231873, 'recall': 0.304368452183246, 'f1-score': 0.3025520236984485, 'support': 271320}, 'weighted avg': {'precision': 0.30666963334769737, 'recall': 0.30752985404688193, 'f1-score': 0.3053633144450168, 'support': 271320}}
[[20930 31415 36651]
 [22992 24572 35146]
 [26322 35355 37937]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279591
{'0': {'precision': 0.33413231064237775, 'recall': 0.202448132780083, 'f1-score': 0.25213167278176835, 'support': 24100}, '1': {'precision': 0.32277271160414905, 'recall': 0.4510422140479944, 'f1-score': 0.3762763256434143, 'support': 22836}, '2': {'precision': 0.31421661772326825, 'recall': 0.3200633440373026, 'f1-score': 0.31711303362461596, 'support': 22733}, 'accuracy': 0.3223097790983077, 'macro avg': {'precision': 0.323707213323265, 'recall': 0.3245178969551266, 'f1-score': 0.3151736773499329, 'support': 69669}, 'weighted avg': {'precision': 0.32391038624605933, 'recall': 0.3223097790983077, 'f1-score': 0.3140270433022151, 'support': 69669}}
[[ 4879 11065  8156]
 [ 4812 10300  7724]
 [ 4911 10546  7276]]
Evaluating performance on  val set...
96/96 - 1s - 724ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1294119
{'0': {'precision': 0.39816124469589814, 'recall': 0.24267241379310345, 'f1-score': 0.3015532940546331, 'support': 9280}, '1': {'precision': 0.26732673267326734, 'recall': 0.4728406055209261, 'f1-score': 0.34155231560891935, 'support': 6738}, '2': {'precision': 0.357297531398874, 'recall': 0.291759990569374, 'f1-score': 0.3212199870214147, 'support': 8483}, 'accuracy': 0.3229664095343047, 'macro avg': {'precision': 0.34092850292267984, 'recall': 0.3357576699611345, 'f1-score': 0.3214418655616557, 'support': 24501}, 'weighted avg': {'precision': 0.34803227763711925, 'recall': 0.3229664095343047, 'f1-score': 0.3193626064773909, 'support': 24501}}
[[2252 4649 2379]
 [1479 3186 2073]
 [1925 4083 2475]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1427131
{'0': {'precision': 0.4040264732044492, 'recall': 0.22229256465517241, 'f1-score': 0.2867933927862851, 'support': 222720}, '1': {'precision': 0.19670109799501495, 'recall': 0.44700583619126205, 'f1-score': 0.2731881050812378, 'support': 116343}, '2': {'precision': 0.3977338689080313, 'recall': 0.31125223150406783, 'f1-score': 0.34921856485032576, 'support': 220143}, 'accuracy': 0.3040650493735761, 'macro avg': {'precision': 0.3328204800358318, 'recall': 0.32685021078350074, 'f1-score': 0.3030666875726162, 'support': 559206}, 'weighted avg': {'precision': 0.35841514407776326, 'recall': 0.3040650493735761, 'f1-score': 0.3085377672497669, 'support': 559206}}
[[ 49509 109411  63800]
 [ 24381  52006  39956]
 [ 48649 102974  68520]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1191401
{'0': {'precision': 0.3392857142857143, 'recall': 0.18874301046637856, 'f1-score': 0.24255425555716412, 'support': 48823}, '1': {'precision': 0.3311737804878049, 'recall': 0.26515999104945176, 'f1-score': 0.29451304239767734, 'support': 49159}, '2': {'precision': 0.36221501467251194, 'recall': 0.5784211424993834, 'f1-score': 0.4454704850964349, 'support': 52709}, 'accuracy': 0.34997445102892677, 'macro avg': {'precision': 0.3442248364820104, 'recall': 0.34410804800507117, 'f1-score': 0.3275125943504254, 'support': 150691}, 'weighted avg': {'precision': 0.3446596645582341, 'recall': 0.34997445102892677, 'f1-score': 0.3304808971288453, 'support': 150691}}
[[ 9215 13584 26024]
 [ 8465 13035 27659]
 [ 9480 12741 30488]]
Evaluating performance on  val set...
222/222 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1399958
{'0': {'precision': 0.36917404720875246, 'recall': 0.4572846860263093, 'f1-score': 0.40853252915872107, 'support': 20145}, '1': {'precision': 0.23847560388797998, 'recall': 0.16380222104706504, 'f1-score': 0.1942082369998824, 'support': 15128}, '2': {'precision': 0.3890818625610214, 'recall': 0.3877894736842105, 'f1-score': 0.3884345931254246, 'support': 21375}, 'accuracy': 0.3526867674057337, 'macro avg': {'precision': 0.33224383788591794, 'recall': 0.33629212691919497, 'f1-score': 0.33039178642800937, 'support': 56648}, 'weighted avg': {'precision': 0.3417824976853466, 'recall': 0.3526867674057337, 'f1-score': 0.34371309556017166, 'support': 56648}}
[[9212 4193 6740]
 [6375 2478 6275]
 [9366 3720 8289]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
2341/2341 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1368817
{'0': {'precision': 0.3938321868894981, 'recall': 0.20904698208816058, 'f1-score': 0.27312083201694093, 'support': 229513}, '1': {'precision': 0.20091010183776192, 'recall': 0.4475335299773479, 'f1-score': 0.27732250783888995, 'support': 122726}, '2': {'precision': 0.4286337287645592, 'recall': 0.35409076925567917, 'f1-score': 0.3878126904959823, 'support': 247044}, 'accuracy': 0.31767795849373337, 'macro avg': {'precision': 0.3411253391639397, 'recall': 0.3368904271070625, 'f1-score': 0.31275201011727105, 'support': 599283}, 'weighted avg': {'precision': 0.3686703790306455, 'recall': 0.31767795849373337, 'f1-score': 0.3212610101181399, 'support': 599283}}
[[ 47979 108283  73251]
 [ 24448  54924  43354]
 [ 49399 110169  87476]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1215823
{'0': {'precision': 0.3408845072163674, 'recall': 0.26681825878710175, 'f1-score': 0.2993378202344768, 'support': 41339}, '1': {'precision': 0.3309662619266792, 'recall': 0.5498215889506517, 'f1-score': 0.4132036922178846, 'support': 41197}, '2': {'precision': 0.31661966866408175, 'recall': 0.17545658755737864, 'f1-score': 0.22579023439954754, 'support': 40956}, 'accuracy': 0.3309283192433518, 'macro avg': {'precision': 0.32949014593570947, 'recall': 0.330698811765044, 'f1-score': 0.31277724895063636, 'support': 123492}, 'weighted avg': {'precision': 0.329528365288577, 'recall': 0.3309283192433518, 'f1-score': 0.3129315542629571, 'support': 123492}}
[[11030 22939  7370]
 [10406 22651  8140]
 [10921 22849  7186]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1260113
{'0': {'precision': 0.38303142901377923, 'recall': 0.32787754290636806, 'f1-score': 0.3533150058909636, 'support': 15091}, '1': {'precision': 0.27490297542043984, 'recall': 0.507549262134266, 'f1-score': 0.35663979380825367, 'support': 11723}, '2': {'precision': 0.37006360005916283, 'recall': 0.17244468950306707, 'f1-score': 0.23526093088857541, 'support': 14509}, 'accuracy': 0.3242746170413571, 'macro avg': {'precision': 0.34266600149779397, 'recall': 0.33595716484790034, 'f1-score': 0.3150719101959309, 'support': 41323}, 'weighted avg': {'precision': 0.34780310358297206, 'recall': 0.3242746170413571, 'f1-score': 0.31280802223887494, 'support': 41323}}
[[4948 8037 2106]
 [3620 5950 2153]
 [4350 7657 2502]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1107383
{'0': {'precision': 0.3117759575485523, 'recall': 0.25209701459958717, 'f1-score': 0.27877834904017573, 'support': 160347}, '1': {'precision': 0.3821801924214863, 'recall': 0.5160668221971225, 'f1-score': 0.43914538918536644, 'support': 202747}, '2': {'precision': 0.27844329530788486, 'recall': 0.20635114229408857, 'f1-score': 0.23703692779613025, 'support': 155783}, 'accuracy': 0.341506754009139, 'macro avg': {'precision': 0.32413314842597446, 'recall': 0.3248383263635994, 'f1-score': 0.31832022200722415, 'support': 518877}, 'weighted avg': {'precision': 0.3292783430579213, 'recall': 0.341506754009139, 'f1-score': 0.3289084038752442, 'support': 518877}}
[[ 40423  85423  34501]
 [ 49314 104631  48802]
 [ 39917  83720  32146]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1380452
{'0': {'precision': 0.3186369006902556, 'recall': 0.37028472322589967, 'f1-score': 0.3425248170059159, 'support': 27676}, '1': {'precision': 0.29480097753674134, 'recall': 0.31587631824377643, 'f1-score': 0.3049749779216956, 'support': 27878}, '2': {'precision': 0.3318353726362625, 'recall': 0.2575809905367134, 'f1-score': 0.29003091640902995, 'support': 28954}, 'accuracy': 0.3137217778198514, 'macro avg': {'precision': 0.31509108362108645, 'recall': 0.3145806773354632, 'f1-score': 0.3125102371122139, 'support': 84508}, 'weighted avg': {'precision': 0.3152958050667763, 'recall': 0.3137217778198514, 'f1-score': 0.3121522746209094, 'support': 84508}}
[[10248 10411  7017]
 [11072  8806  8000]
 [10842 10654  7458]]
Evaluating performance on  val set...
136/136 - 1s - 955ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1284138
{'0': {'precision': 0.3568396226415094, 'recall': 0.25368879946344736, 'f1-score': 0.2965503724029792, 'support': 11928}, '1': {'precision': 0.3024775542675304, 'recall': 0.4821557971014493, 'f1-score': 0.371743836860116, 'support': 11040}, '2': {'precision': 0.3054364205401646, 'recall': 0.22450370622816734, 'f1-score': 0.25879002160675707, 'support': 11737}, 'accuracy': 0.31649618210632474, 'macro avg': {'precision': 0.3215845324830681, 'recall': 0.32011610093102133, 'f1-score': 0.30902807695661744, 'support': 34705}, 'weighted avg': {'precision': 0.32216229609166896, 'recall': 0.31649618210632474, 'f1-score': 0.30769984972070086, 'support': 34705}}
[[3026 6152 2750]
 [2475 5323 3242]
 [2979 6123 2635]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
2900/2900 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1272461
{'0': {'precision': 0.36350023927014885, 'recall': 0.26293790105260023, 'f1-score': 0.30514741614093893, 'support': 268668}, '1': {'precision': 0.28097018561788245, 'recall': 0.5635115486377613, 'f1-score': 0.374975415088474, 'support': 209765}, '2': {'precision': 0.35387310115148374, 'recall': 0.1707037984275836, 'f1-score': 0.23030935055043078, 'support': 263925}, 'accuracy': 0.31507843924359946, 'macro avg': {'precision': 0.33278117534650503, 'recall': 0.33238441603931507, 'f1-score': 0.3034773939266146, 'support': 742358}, 'weighted avg': {'precision': 0.33675740207793653, 'recall': 0.31507843924359946, 'f1-score': 0.2982718032132879, 'support': 742358}}
[[ 70643 152809  45216]
 [ 54515 118205  37045]
 [ 69183 149689  45053]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1323125
{'0': {'precision': 0.3347098599891413, 'recall': 0.34214598049108647, 'f1-score': 0.3383870726291365, 'support': 59460}, '1': {'precision': 0.33236135015575435, 'recall': 0.3916986572343386, 'f1-score': 0.35959863338360676, 'support': 59653}, '2': {'precision': 0.31852186250483683, 'recall': 0.2533296859238489, 'f1-score': 0.2822097574447418, 'support': 58489}, 'accuracy': 0.3295402078805419, 'macro avg': {'precision': 0.3285310242165775, 'recall': 0.32905810788309137, 'f1-score': 0.326731821152495, 'support': 177602}, 'weighted avg': {'precision': 0.3285899095271504, 'recall': 0.3295402078805419, 'f1-score': 0.32701095212298426, 'support': 177602}}
[[20344 23838 15278]
 [19864 23366 16423]
 [20573 23099 14817]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1140709
{'0': {'precision': 0.3419426048565121, 'recall': 0.2379050837045001, 'f1-score': 0.28059052622045105, 'support': 19533}, '1': {'precision': 0.34487972046767906, 'recall': 0.4683578956974038, 'f1-score': 0.3972446353592229, 'support': 21917}, '2': {'precision': 0.31296750984982585, 'recall': 0.2822784158211876, 'f1-score': 0.29683184402924456, 'support': 19417}, 'accuracy': 0.335041976769021, 'macro avg': {'precision': 0.333263278391339, 'recall': 0.3295137984076972, 'f1-score': 0.3248890018696395, 'support': 60867}, 'weighted avg': {'precision': 0.3337569433832199, 'recall': 0.335041976769021, 'f1-score': 0.3277764525497889, 'support': 60867}}
[[ 4647  9973  4913]
 [ 4533 10265  7119]
 [ 4410  9526  5481]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
7167/7167 - 47s - 47s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1221279
{'0': {'precision': 0.3418886198547216, 'recall': 0.1562918615830849, 'f1-score': 0.21451827537260468, 'support': 618855}, '1': {'precision': 0.2970515744661293, 'recall': 0.37050479572057626, 'f1-score': 0.32973704643179996, 'support': 558206}, '2': {'precision': 0.3602200063126147, 'recall': 0.46865142735471704, 'f1-score': 0.4073433183074015, 'support': 657510}, 'accuracy': 0.33342018379228716, 'macro avg': {'precision': 0.33305340021115515, 'recall': 0.3318160282194594, 'f1-score': 0.3171995467039354, 'support': 1834571}, 'weighted avg': {'precision': 0.33481599205876533, 'recall': 0.33342018379228716, 'f1-score': 0.3186844282758869, 'support': 1834571}}
[[ 96722 243339 278794]
 [ 82895 206818 268493]
 [103288 246079 308143]]
Evaluating performance on  train set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1201632
{'0': {'precision': 0.3357088427834159, 'recall': 0.28393461352550864, 'f1-score': 0.30765873362272145, 'support': 136542}, '1': {'precision': 0.33052351607616876, 'recall': 0.47171742834085545, 'f1-score': 0.3886954513969061, 'support': 133828}, '2': {'precision': 0.34191014304018147, 'recall': 0.24789650419937714, 'f1-score': 0.28741055939827054, 'support': 131329}, 'accuracy': 0.33471330523601006, 'macro avg': {'precision': 0.33604750063325534, 'recall': 0.3345161820219138, 'f1-score': 0.3279215814726327, 'support': 401699}, 'weighted avg': {'precision': 0.33600874061448666, 'recall': 0.33471330523601006, 'f1-score': 0.32803670168726895, 'support': 401699}}
[[38769 66852 30921]
 [38958 63129 31741]
 [37757 61016 32556]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1244489
{'0': {'precision': 0.3545004256636483, 'recall': 0.20735626980534178, 'f1-score': 0.26166062094770215, 'support': 44180}, '1': {'precision': 0.31634286139645673, 'recall': 0.419541931980848, 'f1-score': 0.3607061769261782, 'support': 40518}, '2': {'precision': 0.3289656068613012, 'recall': 0.36999415375621164, 'f1-score': 0.34827570393469687, 'support': 41052}, 'accuracy': 0.32881908548707756, 'macro avg': {'precision': 0.33326963130713544, 'recall': 0.3322974518474671, 'f1-score': 0.32354750060285903, 'support': 125750}, 'weighted avg': {'precision': 0.33386962192247915, 'recall': 0.32881908548707756, 'f1-score': 0.3218502847561952, 'support': 125750}}
[[ 9161 19539 15480]
 [ 8016 16999 15503]
 [ 8665 17198 15189]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
6357/6357 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1247461
{'0': {'precision': 0.3512164822002825, 'recall': 0.23582983126729035, 'f1-score': 0.2821832684591387, 'support': 568236}, '1': {'precision': 0.3008807981695465, 'recall': 0.5079925402957239, 'f1-score': 0.37792122380583437, 'support': 495462}, '2': {'precision': 0.34299835738589696, 'recall': 0.24903144971081032, 'f1-score': 0.2885576947793229, 'support': 563471}, 'accuracy': 0.3232731203704102, 'macro avg': {'precision': 0.33169854591857534, 'recall': 0.3309512737579416, 'f1-score': 0.31622072901476533, 'support': 1627169}, 'weighted avg': {'precision': 0.33304375786216944, 'recall': 0.3232731203704102, 'f1-score': 0.31354222576784174, 'support': 1627169}}
[[134007 295045 139184]
 [114173 251691 129598]
 [133371 289778 140322]]
Evaluating performance on  train set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.131585
{'0': {'precision': 0.33720497745528577, 'recall': 0.3502172041990553, 'f1-score': 0.34358793649105074, 'support': 147557}, '1': {'precision': 0.32401610752363247, 'recall': 0.3472322930819647, 'f1-score': 0.3352227160896573, 'support': 142049}, '2': {'precision': 0.341703863321533, 'recall': 0.304508545250048, 'f1-score': 0.3220357422611622, 'support': 145812}, 'accuracy': 0.333936585074572, 'macro avg': {'precision': 0.3343083161001504, 'recall': 0.3339860141770226, 'f1-score': 0.33361546494729005, 'support': 435418}, 'weighted avg': {'precision': 0.33440887293275295, 'recall': 0.333936585074572, 'f1-score': 0.33364154075673097, 'support': 435418}}
[[51677 52925 42955]
 [50141 49324 42584]
 [51433 49978 44401]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1203027
{'0': {'precision': 0.34545989934682514, 'recall': 0.26393291747622455, 'f1-score': 0.2992429073286107, 'support': 48895}, '1': {'precision': 0.3253900599297376, 'recall': 0.5313857835899599, 'f1-score': 0.4036240126888508, 'support': 47410}, '2': {'precision': 0.3278800505481745, 'recall': 0.201030280185953, 'f1-score': 0.24924383056612098, 'support': 47754}, 'accuracy': 0.3311004518981806, 'macro avg': {'precision': 0.3329100032749124, 'recall': 0.3321163270840458, 'f1-score': 0.3173702501945275, 'support': 144059}, 'weighted avg': {'precision': 0.3330273599963168, 'recall': 0.3311004518981806, 'f1-score': 0.3170207087392345, 'support': 144059}}
[[12905 26607  9383]
 [11921 25193 10296]
 [12530 25624  9600]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
7459/7459 - 51s - 51s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1274498
{'0': {'precision': 0.356975208400996, 'recall': 0.2457448632051215, 'f1-score': 0.2910964073997237, 'support': 670895}, '1': {'precision': 0.28632154770391643, 'recall': 0.5011673847363999, 'f1-score': 0.3644369218289316, 'support': 559370}, '2': {'precision': 0.35051964663601676, 'recall': 0.24175461644275434, 'f1-score': 0.286150346252239, 'support': 678986}, 'accuracy': 0.3191591886032795, 'macro avg': {'precision': 0.3312721342469764, 'recall': 0.3295556214614252, 'f1-score': 0.31389455849363146, 'support': 1909251}, 'weighted avg': {'precision': 0.33397939787389314, 'recall': 0.3191591886032795, 'f1-score': 0.31082465543100923, 'support': 1909251}}
[[164869 349993 156033]
 [130914 280338 148118]
 [166067 348771 164148]]
Evaluating performance on  train set...
1664/1664 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1244074
{'0': {'precision': 0.35847088862516635, 'recall': 0.2061790277097884, 'f1-score': 0.2617876214654644, 'support': 145039}, '1': {'precision': 0.32795324679298393, 'recall': 0.3092442187567622, 'f1-score': 0.318324070877279, 'support': 138638}, '2': {'precision': 0.3371511663590053, 'recall': 0.501897586551031, 'f1-score': 0.4033504754320119, 'support': 142286}, 'accuracy': 0.33850357894934535, 'macro avg': {'precision': 0.34119176725905187, 'recall': 0.3391069443391939, 'f1-score': 0.32782072259158507, 'support': 425963}, 'weighted avg': {'precision': 0.34141681859867795, 'recall': 0.33850357894934535, 'f1-score': 0.3274752809876279, 'support': 425963}}
[[29904 45125 70010]
 [25375 42873 70390]
 [28142 42731 71413]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1315427
{'0': {'precision': 0.34323221003762105, 'recall': 0.1885581109010158, 'f1-score': 0.24340126014644947, 'support': 45482}, '1': {'precision': 0.2876856472851903, 'recall': 0.23296976189316843, 'f1-score': 0.2574526474386569, 'support': 41074}, '2': {'precision': 0.3518152797316308, 'recall': 0.5701227531784305, 'f1-score': 0.4351222939739687, 'support': 45620}, 'accuracy': 0.33405459387483355, 'macro avg': {'precision': 0.3275777123514807, 'recall': 0.33055020865753826, 'f1-score': 0.31199206718635836, 'support': 132176}, 'weighted avg': {'precision': 0.32893339724972753, 'recall': 0.33405459387483355, 'f1-score': 0.31393948376383507, 'support': 132176}}
[[ 8576 12340 24566]
 [ 8152  9569 23353]
 [ 8258 11353 26009]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
8238/8238 - 51s - 51s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1288774
{'0': {'precision': 0.37166641304650677, 'recall': 0.23096799285030253, 'f1-score': 0.28489261346927575, 'support': 750801}, '1': {'precision': 0.2643220174069651, 'recall': 0.4675144340924659, 'f1-score': 0.33771031255141654, 'support': 592694}, '2': {'precision': 0.3494352675301143, 'recall': 0.27116681629703393, 'f1-score': 0.30536555215446193, 'support': 765219}, 'accuracy': 0.3120413673926384, 'macro avg': {'precision': 0.32847456599452873, 'recall': 0.3232164144132674, 'f1-score': 0.30932282605838474, 'support': 2108714}, 'weighted avg': {'precision': 0.33342790646377873, 'recall': 0.3120413673926384, 'f1-score': 0.30716733398971136, 'support': 2108714}}
[[173411 387219 190171]
 [119453 277093 196148]
 [173713 384004 207502]]
Evaluating performance on  train set...
1806/1806 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.127783
{'0': {'precision': 0.32580340595167323, 'recall': 0.30077930798484, 'f1-score': 0.312791657993863, 'support': 154881}, '1': {'precision': 0.3298890188762766, 'recall': 0.34125743293189503, 'f1-score': 0.3354769422704677, 'support': 152867}, '2': {'precision': 0.3523034220673982, 'recall': 0.3674254444192598, 'f1-score': 0.3597055709476381, 'support': 154415}, 'accuracy': 0.3364354134796598, 'macro avg': {'precision': 0.3359986156317827, 'recall': 0.33648739511199827, 'f1-score': 0.3359913904039897, 'support': 462163}, 'weighted avg': {'precision': 0.3360087996752188, 'recall': 0.3364354134796598, 'f1-score': 0.3359697211885993, 'support': 462163}}
[[46585 54319 53977]
 [50370 52167 50330]
 [46030 51649 56736]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1405816
{'0': {'precision': 0.3341963190184049, 'recall': 0.49996328793274347, 'f1-score': 0.4006089220315051, 'support': 54478}, '1': {'precision': 0.31754377009851464, 'recall': 0.22848223303645213, 'f1-score': 0.26574965024509545, 'support': 54455}, '2': {'precision': 0.35749312557286894, 'recall': 0.2816624239469931, 'f1-score': 0.3150794211796545, 'support': 55389}, 'accuracy': 0.33641265320529207, 'macro avg': {'precision': 0.3364110715632629, 'recall': 0.33670264830539626, 'f1-score': 0.3271459978187517, 'support': 164322}, 'weighted avg': {'precision': 0.336530591159765, 'recall': 0.33641265320529207, 'f1-score': 0.3270876943942314, 'support': 164322}}
[[27237 13823 13418]
 [27392 12442 14621]
 [26871 12917 15601]]
testing model on single stock: results/universal/W5/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
31315/31315 - 202s - 202s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1446372
{'0': {'precision': 0.40539998388169873, 'recall': 0.21684095596645211, 'f1-score': 0.282550743366852, 'support': 3178145}, '1': {'precision': 0.18835612058938128, 'recall': 0.4544992550255861, 'f1-score': 0.26633585012955463, 'support': 1587974}, '2': {'precision': 0.398283489106603, 'recall': 0.30447577150518695, 'f1-score': 0.34511867554172276, 'support': 3250367}, 'accuracy': 0.2994507818014028, 'macro avg': {'precision': 0.3306798645258943, 'recall': 0.32527199416574176, 'f1-score': 0.29800175634604315, 'support': 8016486}, 'weighted avg': {'precision': 0.3595206258262617, 'recall': 0.2994507818014028, 'f1-score': 0.304707572821283, 'support': 8016486}}
[[ 689152 1546006  942987]
 [ 314078  721733  552163]
 [ 696701 1564008  989658]]
Evaluating performance on  train set...
5759/5759 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1375182
{'0': {'precision': 0.33767364040945624, 'recall': 0.2862886412505825, 'f1-score': 0.3098652932730704, 'support': 489244}, '1': {'precision': 0.263789250434139, 'recall': 0.1522206068371856, 'f1-score': 0.19304427083333334, 'support': 486984}, '2': {'precision': 0.32547066788974793, 'recall': 0.508760021207204, 'f1-score': 0.39698003456851255, 'support': 497944}, 'accuracy': 0.3171461674757084, 'macro avg': {'precision': 0.3089778529111144, 'recall': 0.315756423098324, 'f1-score': 0.2999631995583054, 'support': 1474172}, 'weighted avg': {'precision': 0.3091444642237103, 'recall': 0.3171461674757084, 'f1-score': 0.3006996694163052, 'support': 1474172}}
[[140065 103754 245425]
 [133252  74129 279603]
 [141477 103133 253334]]
Evaluating performance on  val set...
2129/2129 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1435747
{'0': {'precision': 0.3106254091814931, 'recall': 0.2346151965179401, 'f1-score': 0.2673221350603357, 'support': 184029}, '1': {'precision': 0.2594750827467251, 'recall': 0.22329969108738387, 'f1-score': 0.24003203548546082, 'support': 174483}, '2': {'precision': 0.3376768079566513, 'recall': 0.46330486836741264, 'f1-score': 0.3906389214271823, 'support': 186428}, 'accuracy': 0.30922853892171615, 'macro avg': {'precision': 0.3025924332949565, 'recall': 0.30707325199091223, 'f1-score': 0.2993310306576596, 'support': 544940}, 'weighted avg': {'precision': 0.3035021951827732, 'recall': 0.30922853892171615, 'f1-score': 0.30077176879005935, 'support': 544940}}
[[43176 55479 85374]
 [51482 38962 84039]
 [44339 55716 86373]]
training model: results/universal/W5/deepLOB_L1/h500
Epoch 1/50
9913/9913 - 163s - loss: 3.1958 - accuracy500: 0.4233 - val_loss: 3.4554 - val_accuracy500: 0.3369 - 163s/epoch - 16ms/step
Epoch 2/50
9913/9913 - 156s - loss: 3.1716 - accuracy500: 0.4350 - val_loss: 3.4776 - val_accuracy500: 0.3245 - 156s/epoch - 16ms/step
Epoch 3/50
9913/9913 - 154s - loss: 3.1565 - accuracy500: 0.4415 - val_loss: 3.4570 - val_accuracy500: 0.3255 - 154s/epoch - 16ms/step
Epoch 4/50
9913/9913 - 155s - loss: 3.1424 - accuracy500: 0.4472 - val_loss: 3.4528 - val_accuracy500: 0.3161 - 155s/epoch - 16ms/step
Epoch 5/50
9913/9913 - 153s - loss: 3.1358 - accuracy500: 0.4495 - val_loss: 3.4578 - val_accuracy500: 0.3297 - 153s/epoch - 15ms/step
Epoch 6/50
9913/9913 - 156s - loss: 3.1291 - accuracy500: 0.4522 - val_loss: 3.4402 - val_accuracy500: 0.3423 - 156s/epoch - 16ms/step
Epoch 7/50
9913/9913 - 151s - loss: 3.1230 - accuracy500: 0.4536 - val_loss: 3.4221 - val_accuracy500: 0.3344 - 151s/epoch - 15ms/step
Epoch 8/50
9913/9913 - 153s - loss: 3.1173 - accuracy500: 0.4560 - val_loss: 3.4532 - val_accuracy500: 0.3393 - 153s/epoch - 15ms/step
Epoch 9/50
9913/9913 - 157s - loss: 3.1169 - accuracy500: 0.4554 - val_loss: 3.5055 - val_accuracy500: 0.3420 - 157s/epoch - 16ms/step
Epoch 10/50
9913/9913 - 153s - loss: 3.1102 - accuracy500: 0.4584 - val_loss: 3.4896 - val_accuracy500: 0.3435 - 153s/epoch - 15ms/step
Epoch 11/50
9913/9913 - 152s - loss: 3.1062 - accuracy500: 0.4599 - val_loss: 3.5673 - val_accuracy500: 0.3439 - 152s/epoch - 15ms/step
Epoch 12/50
9913/9913 - 154s - loss: 3.1037 - accuracy500: 0.4606 - val_loss: 3.4923 - val_accuracy500: 0.3389 - 154s/epoch - 16ms/step
Epoch 13/50
9913/9913 - 153s - loss: 3.1004 - accuracy500: 0.4614 - val_loss: 3.5334 - val_accuracy500: 0.3401 - 153s/epoch - 15ms/step
Epoch 14/50
9913/9913 - 154s - loss: 3.0972 - accuracy500: 0.4628 - val_loss: 3.4946 - val_accuracy500: 0.3321 - 154s/epoch - 16ms/step
Epoch 15/50
9913/9913 - 156s - loss: 3.0954 - accuracy500: 0.4634 - val_loss: 3.5367 - val_accuracy500: 0.3288 - 156s/epoch - 16ms/step
Epoch 16/50
9913/9913 - 153s - loss: 3.0928 - accuracy500: 0.4638 - val_loss: 3.5164 - val_accuracy500: 0.3259 - 153s/epoch - 15ms/step
Epoch 17/50
9913/9913 - 152s - loss: 3.0909 - accuracy500: 0.4645 - val_loss: 3.4991 - val_accuracy500: 0.3266 - 152s/epoch - 15ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 280s - 280s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124163
{'0': {'precision': 0.49780876494023907, 'recall': 0.0010391874294499231, 'f1-score': 0.0020740452409936413, 'support': 4809527}, '1': {'precision': 0.22154018766138026, 'recall': 0.2859863262426351, 'f1-score': 0.24967154483032353, 'support': 3138713}, '2': {'precision': 0.37764016414129187, 'recall': 0.6777686415000272, 'f1-score': 0.48503036862642257, 'support': 4890151}, 'accuracy': 0.3284693541425869, 'macro avg': {'precision': 0.3656630389143037, 'recall': 0.3215980517240374, 'f1-score': 0.24559198623257994, 'support': 12838391}, 'weighted avg': {'precision': 0.3844946916765231, 'recall': 0.3284693541425868, 'f1-score': 0.24656471689043188, 'support': 12838391}}
[[   4998 1581450 3223079]
 [   1969  897629 2239115]
 [   3073 1572687 3314391]]
Evaluating performance on  train set...
9913/9913 - 68s - 68s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1370752
{'0': {'precision': 0.3329312113666476, 'recall': 0.15149769923088743, 'f1-score': 0.20823824268450275, 'support': 852541}, '1': {'precision': 0.2695687437490981, 'recall': 0.13028343449695548, 'f1-score': 0.1756666272156732, 'support': 831656}, '2': {'precision': 0.331309464733689, 'recall': 0.6787319015613787, 'f1-score': 0.44526949193937654, 'support': 852836}, 'accuracy': 0.32177586968715033, 'macro avg': {'precision': 0.31126980661647824, 'recall': 0.3201710117630739, 'f1-score': 0.2763914539465175, 'support': 2537033}, 'weighted avg': {'precision': 0.31161542230107114, 'recall': 0.32177586968715033, 'f1-score': 0.2772402631766227, 'support': 2537033}}
[[129158 147706 575677]
 [130680 108351 592625]
 [128104 145885 578847]]
Evaluating performance on  val set...
3496/3496 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1413245
{'0': {'precision': 0.29702378335604696, 'recall': 0.10692908849773208, 'f1-score': 0.15724845460639011, 'support': 315929}, '1': {'precision': 0.2667203252822281, 'recall': 0.1458037793674756, 'f1-score': 0.18854089262635407, 'support': 263642}, '2': {'precision': 0.3574233574233574, 'recall': 0.7228744501792479, 'f1-score': 0.4783351612126463, 'support': 314648}, 'accuracy': 0.33512260419427453, 'macro avg': {'precision': 0.30705582202054416, 'recall': 0.32520243934815185, 'f1-score': 0.2747081694817968, 'support': 894219}, 'weighted avg': {'precision': 0.3093421761520324, 'recall': 0.33512260419427453, 'f1-score': 0.2794548615432866, 'support': 894219}}
[[ 33782  53423 228724]
 [ 45014  38440 180188]
 [ 34939  52258 227451]]
testing model out of sample: results/universal/W5/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 124s - 124s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112419
{'0': {'precision': 0.2642177667203278, 'recall': 0.0046764242838367295, 'f1-score': 0.009190190207514841, 'support': 1930321}, '1': {'precision': 0.24776713071777257, 'recall': 0.30148685058138214, 'f1-score': 0.2719999652656203, 'support': 1454551}, '2': {'precision': 0.3631327263715248, 'recall': 0.6554156576570338, 'f1-score': 0.4673373958539634, 'support': 1963972}, 'accuracy': 0.32432671433304094, 'macro avg': {'precision': 0.2917058746032084, 'recall': 0.3205263108407509, 'f1-score': 0.24950918377569953, 'support': 5348844}, 'weighted avg': {'precision': 0.2960635117239076, 'recall': 0.32432671433304094, 'f1-score': 0.2488790846468384, 'support': 5348844}}
[[   9027  667994 1253300]
 [  11782  438528 1004241]
 [  13356  663398 1287218]]
Evaluating performance on  train set...
4957/4957 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1345875
{'0': {'precision': 0.3039736206770414, 'recall': 0.13622493308072234, 'f1-score': 0.18813685679586137, 'support': 427007}, '1': {'precision': 0.2826894369914158, 'recall': 0.20797787312303906, 'f1-score': 0.23964566885904715, 'support': 419761}, '2': {'precision': 0.32933416128692106, 'recall': 0.6000839706245137, 'f1-score': 0.42527285487944794, 'support': 421576}, 'accuracy': 0.31415057744586644, 'macro avg': {'precision': 0.3053324063184594, 'recall': 0.3147622589427584, 'f1-score': 0.2843517935114521, 'support': 1268344}, 'weighted avg': {'precision': 0.3053589901352394, 'recall': 0.31415057744586644, 'f1-score': 0.2840037793251917, 'support': 1268344}}
[[ 58169 111216 257622]
 [ 74904  87301 257556]
 [ 58289 110306 252981]]
Evaluating performance on  val set...
1701/1701 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1347973
{'0': {'precision': 0.32575388364300945, 'recall': 0.1410307130329285, 'f1-score': 0.19684155308712417, 'support': 151662}, '1': {'precision': 0.2720608565574642, 'recall': 0.28758027892476823, 'f1-score': 0.27960538299562104, 'support': 133441}, '2': {'precision': 0.34720330707351144, 'recall': 0.5286892624475725, 'f1-score': 0.4191442346323825, 'support': 149969}, 'accuracy': 0.319604571197411, 'macro avg': {'precision': 0.31500601575799503, 'recall': 0.3191000848017564, 'f1-score': 0.2985303902383759, 'support': 435072}, 'weighted avg': {'precision': 0.31667928761091985, 'recall': 0.319604571197411, 'f1-score': 0.2988536317211906, 'support': 435072}}
[[21389 53232 77041]
 [23035 38375 72031]
 [21236 49446 79287]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1460713
{'0': {'precision': 0.2595294772312734, 'recall': 0.09843696868074528, 'f1-score': 0.14273569667601804, 'support': 85283}, '1': {'precision': 0.33058738015298883, 'recall': 0.21480781773609517, 'f1-score': 0.2604084303514464, 'support': 88926}, '2': {'precision': 0.34974695211130796, 'recall': 0.6525625315360772, 'f1-score': 0.4554117469511538, 'support': 97111}, 'accuracy': 0.3349108064278343, 'macro avg': {'precision': 0.31328793649852343, 'recall': 0.32193577265097256, 'f1-score': 0.28618529132620607, 'support': 271320}, 'weighted avg': {'precision': 0.3151096197872645, 'recall': 0.3349108064278343, 'f1-score': 0.2932164921687567, 'support': 271320}}
[[ 8395 17561 59327]
 [11331 19102 58493]
 [12621 21119 63371]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1139863
{'0': {'precision': 0.4570446735395189, 'recall': 0.005597171955222625, 'f1-score': 0.011058911570282295, 'support': 23762}, '1': {'precision': 0.33678292452360814, 'recall': 0.28341148886283707, 'f1-score': 0.30780074119546186, 'support': 23884}, '2': {'precision': 0.31074088354065627, 'recall': 0.6953185306270717, 'f1-score': 0.42952511850999975, 'support': 22023}, 'accuracy': 0.3188649183998622, 'macro avg': {'precision': 0.36818949386792776, 'recall': 0.32810906381504384, 'f1-score': 0.24946159042524796, 'support': 69669}, 'weighted avg': {'precision': 0.36956846488658907, 'recall': 0.3188649183998622, 'f1-score': 0.2450692050178872, 'support': 69669}}
[[  133  6665 16964]
 [  113  6769 17002]
 [   45  6665 15313]]
Evaluating performance on  val set...
96/96 - 1s - 693ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1153365
{'0': {'precision': 0.3333333333333333, 'recall': 0.0003337783711615487, 'f1-score': 0.0006668889629876625, 'support': 8988}, '1': {'precision': 0.28845729419554184, 'recall': 0.3544406779661017, 'f1-score': 0.31806290685648236, 'support': 7375}, '2': {'precision': 0.33519118600129616, 'recall': 0.6355369869746866, 'f1-score': 0.43890020366598775, 'support': 8138}, 'accuracy': 0.3179053916166687, 'macro avg': {'precision': 0.3189939378433904, 'recall': 0.3301038144373166, 'f1-score': 0.25254333316181926, 'support': 24501}, 'weighted avg': {'precision': 0.32044236628589323, 'recall': 0.3179053916166687, 'f1-score': 0.24176473586791147, 'support': 24501}}
[[   3 3486 5499]
 [   2 2614 4759]
 [   4 2962 5172]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1139948
{'0': {'precision': 0.3197969543147208, 'recall': 0.0002949272512780181, 'f1-score': 0.0005893110205837921, 'support': 213612}, '1': {'precision': 0.23636804020709073, 'recall': 0.342327199380271, 'f1-score': 0.2796470532046996, 'support': 136834}, '2': {'precision': 0.37208696495628196, 'recall': 0.6431404483617551, 'f1-score': 0.4714297000500356, 'support': 208760}, 'accuracy': 0.323971845795646, 'macro avg': {'precision': 0.3094173198260312, 'recall': 0.32858752499776805, 'f1-score': 0.25055535475843965, 'support': 559206}, 'weighted avg': {'precision': 0.31890309872041184, 'recall': 0.323971845795646, 'f1-score': 0.2446446800756541, 'support': 559206}}
[[    63  76925 136624]
 [    43  46842  89949]
 [    91  74407 134262]]
Evaluating performance on  train set...
589/589 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1338791
{'0': {'precision': 0.3352390421741652, 'recall': 0.08250071367399373, 'f1-score': 0.13241478620870223, 'support': 49042}, '1': {'precision': 0.32290860868604265, 'recall': 0.12292806058056374, 'f1-score': 0.17806758280264484, 'support': 47540}, '2': {'precision': 0.36004447247021343, 'recall': 0.8019737936387662, 'f1-score': 0.49697365331867416, 'support': 54109}, 'accuracy': 0.3535977596538612, 'macro avg': {'precision': 0.3393973744434738, 'recall': 0.3358008559644412, 'f1-score': 0.2691520074433404, 'support': 150691}, 'weighted avg': {'precision': 0.3402559855872657, 'recall': 0.3535977596538612, 'f1-score': 0.2777204095739298, 'support': 150691}}
[[ 4046  5751 39245]
 [ 3811  5844 37885]
 [ 4212  6503 43394]]
Evaluating performance on  val set...
222/222 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1713992
{'0': {'precision': 0.3505836028687948, 'recall': 0.3736884181073249, 'f1-score': 0.3617674801073838, 'support': 20014}, '1': {'precision': 0.19321314952279958, 'recall': 0.056965982991495745, 'f1-score': 0.08798956874486888, 'support': 15992}, '2': {'precision': 0.36196078431372547, 'recall': 0.5365759131867067, 'f1-score': 0.432301627571133, 'support': 20642}, 'accuracy': 0.3436308431012569, 'macro avg': {'precision': 0.3019191789017733, 'recall': 0.32241010476184245, 'f1-score': 0.29401955880779523, 'support': 56648}, 'weighted avg': {'precision': 0.3103029131617814, 'recall': 0.3436308431012569, 'f1-score': 0.31018065468437456, 'support': 56648}}
[[ 7479  2070 10465]
 [ 6022   911  9059]
 [ 7832  1734 11076]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1134348
{'0': {'precision': 0.4020100502512563, 'recall': 0.00037088376966263486, 'f1-score': 0.0007410838351088467, 'support': 215701}, '1': {'precision': 0.23982634761486382, 'recall': 0.3032465495608532, 'f1-score': 0.2678333342952954, 'support': 153024}, '2': {'precision': 0.3869140076036628, 'recall': 0.680653024401669, 'f1-score': 0.4933726530766232, 'support': 230558}, 'accuracy': 0.33942895092969433, 'macro avg': {'precision': 0.34291680182326095, 'recall': 0.32809015257739493, 'f1-score': 0.2539823570690091, 'support': 599283}, 'weighted avg': {'precision': 0.3547894344270544, 'recall': 0.33942895092969433, 'f1-score': 0.25846852458614744, 'support': 599283}}
[[    80  73531 142090]
 [    46  46404 106574]
 [    73  73555 156930]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1082457
{'0': {'precision': 0.3695652173913043, 'recall': 0.0004034459026508769, 'f1-score': 0.0008060119005286489, 'support': 42137}, '1': {'precision': 0.30135500285990413, 'recall': 0.3866730778964418, 'f1-score': 0.3387241589536108, 'support': 39514}, '2': {'precision': 0.32891607670630285, 'recall': 0.5718553571855357, 'f1-score': 0.41762518981376434, 'support': 41841}, 'accuracy': 0.3176157159977974, 'macro avg': {'precision': 0.33327876565250375, 'recall': 0.31964396032820946, 'f1-score': 0.2523851202226346, 'support': 123492}, 'weighted avg': {'precision': 0.33396729110948126, 'recall': 0.3176157159977974, 'f1-score': 0.25015519148886783, 'support': 123492}}
[[   17 17521 24599]
 [   16 15279 24219]
 [   13 17901 23927]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1120366
{'0': {'precision': 0.44484167517875384, 'recall': 0.05731771518820742, 'f1-score': 0.10155065873848665, 'support': 15196}, '1': {'precision': 0.2701083559074807, 'recall': 0.44629023928386985, 'f1-score': 0.33653534107873045, 'support': 11618}, '2': {'precision': 0.3657593336308196, 'recall': 0.5084430353573643, 'f1-score': 0.4254570621143088, 'support': 14509}, 'accuracy': 0.3250732037848172, 'macro avg': {'precision': 0.3602364549056847, 'recall': 0.33735032994314723, 'f1-score': 0.28784768731050864, 'support': 41323}, 'weighted avg': {'precision': 0.36794848260288493, 'recall': 0.3250732037848172, 'f1-score': 0.2813442372784948, 'support': 41323}}
[[ 871 7337 6988]
 [ 629 5185 5804]
 [ 458 6674 7377]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
2027/2027 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042393
{'0': {'precision': 0.31840796019900497, 'recall': 0.00040894829998913733, 'f1-score': 0.000816847479259732, 'support': 156499}, '1': {'precision': 0.3698451102806161, 'recall': 0.32983662775016376, 'f1-score': 0.3486970070368749, 'support': 207624}, '2': {'precision': 0.2881935282688479, 'recall': 0.6210889540819623, 'f1-score': 0.39370343214559284, 'support': 154754}, 'accuracy': 0.31734303120007246, 'macro avg': {'precision': 0.325482199582823, 'recall': 0.3171115100440384, 'f1-score': 0.24773909555390916, 'support': 518877}, 'weighted avg': {'precision': 0.32997868437761557, 'recall': 0.31734303120007246, 'f1-score': 0.2571956053957679, 'support': 518877}}
[[    64  58108  98327]
 [    73  68482 139069]
 [    64  58574  96116]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1379292
{'0': {'precision': 0.3011529762233133, 'recall': 0.2009645118539243, 'f1-score': 0.24106334591861517, 'support': 27164}, '1': {'precision': 0.30427220834819835, 'recall': 0.24553764214768964, 'f1-score': 0.2717677049310922, 'support': 27788}, '2': {'precision': 0.34818117705939894, 'recall': 0.5178305589389633, 'f1-score': 0.416388938010964, 'support': 29556}, 'accuracy': 0.32644246698537416, 'macro avg': {'precision': 0.3178687872103035, 'recall': 0.3214442376468591, 'f1-score': 0.3097399962868905, 'support': 84508}, 'weighted avg': {'precision': 0.3186263837846998, 'recall': 0.32644246698537416, 'f1-score': 0.31247831169842505, 'support': 84508}}
[[ 5459  7410 14295]
 [ 6608  6823 14357]
 [ 6060  8191 15305]]
Evaluating performance on  val set...
136/136 - 1s - 928ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.114387
{'0': {'precision': 0.3684210526315789, 'recall': 0.0005873468702802483, 'f1-score': 0.0011728239926279635, 'support': 11918}, '1': {'precision': 0.302849129022734, 'recall': 0.3765256492612646, 'f1-score': 0.3356923706279403, 'support': 10897}, '2': {'precision': 0.3327183271832718, 'recall': 0.5915054667788057, 'f1-score': 0.4258810706067579, 'support': 11890}, 'accuracy': 0.3210776545166403, 'macro avg': {'precision': 0.33466283627919496, 'recall': 0.3228728209701168, 'f1-score': 0.2542487550757754, 'support': 34705}, 'weighted avg': {'precision': 0.33560034503480746, 'recall': 0.3210776545166403, 'f1-score': 0.2517142604406038, 'support': 34705}}
[[   7 4597 7314]
 [   3 4103 6791]
 [   9 4848 7033]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
2900/2900 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077276
{'0': {'precision': 0.3167259786476868, 'recall': 0.0003365920995404951, 'f1-score': 0.0006724695499743101, 'support': 264415}, '1': {'precision': 0.2858415438865414, 'recall': 0.3909419423653383, 'f1-score': 0.33023101374587127, 'support': 217508}, '2': {'precision': 0.3501104378376676, 'recall': 0.5976808032714497, 'f1-score': 0.44156197830160177, 'support': 260435}, 'accuracy': 0.3243435108128423, 'macro avg': {'precision': 0.31755932012396526, 'recall': 0.32965311257877616, 'f1-score': 0.25748848719914913, 'support': 742358}, 'weighted avg': {'precision': 0.319388939096844, 'recall': 0.3243435108128423, 'f1-score': 0.25190526968507254, 'support': 742358}}
[[    89 107771 156555]
 [    93  85033 132382]
 [    99 104679 155657]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1334109
{'0': {'precision': 0.31454507071986487, 'recall': 0.14885858434487237, 'f1-score': 0.20208184993049197, 'support': 60057}, '1': {'precision': 0.30177040775454617, 'recall': 0.2583277614908536, 'f1-score': 0.27836432325583543, 'support': 58329}, '2': {'precision': 0.3226765274867, 'recall': 0.540816671169954, 'f1-score': 0.40419275040387714, 'support': 59216}, 'accuracy': 0.31549757322552674, 'macro avg': {'precision': 0.31299733532037033, 'recall': 0.31600100566856, 'f1-score': 0.2948796411967349, 'support': 177602}, 'weighted avg': {'precision': 0.3130607351144147, 'recall': 0.31549757322552674, 'f1-score': 0.2945226978321256, 'support': 177602}}
[[ 8940 17192 33925]
 [ 9963 15068 33298]
 [ 9519 17672 32025]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151149
{'0': {'precision': 0.4642857142857143, 'recall': 0.0006463481330482772, 'f1-score': 0.0012908991609155453, 'support': 20113}, '1': {'precision': 0.29942679002413514, 'recall': 0.2842075120507803, 'f1-score': 0.2916187164858843, 'support': 20953}, '2': {'precision': 0.31969915264584503, 'recall': 0.6611787283470532, 'f1-score': 0.4309981564392942, 'support': 19801}, 'accuracy': 0.31314176811737066, 'macro avg': {'precision': 0.3611372189852315, 'recall': 0.3153441961769606, 'f1-score': 0.24130259069536467, 'support': 60867}, 'weighted avg': {'precision': 0.36049798781514863, 'recall': 0.31314176811737066, 'f1-score': 0.241024616245366, 'support': 60867}}
[[   13  7234 12866]
 [    5  5955 14993]
 [   10  6699 13092]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
7167/7167 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1155143
{'0': {'precision': 0.5685497760936962, 'recall': 0.0050612765579026294, 'f1-score': 0.010033236425420165, 'support': 652207}, '1': {'precision': 0.24418539000306072, 'recall': 0.16887243014853967, 'f1-score': 0.1996629924665331, 'support': 486604}, '2': {'precision': 0.37653678156760095, 'recall': 0.8075830746234334, 'f1-score': 0.5136046493558963, 'support': 695760}, 'accuracy': 0.3528666919950223, 'macro avg': {'precision': 0.39642398255478595, 'recall': 0.3271722604432919, 'f1-score': 0.2411002927492832, 'support': 1834571}, 'weighted avg': {'precision': 0.4096941260257928, 'recall': 0.3528666919950223, 'f1-score': 0.2513100494073858, 'support': 1834571}}
[[  3301 121967 526939]
 [  1011  82174 403419]
 [  1494 132382 561884]]
Evaluating performance on  train set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1224469
{'0': {'precision': 0.1937493474402255, 'recall': 0.040397370216100896, 'f1-score': 0.06685521109169623, 'support': 137806}, '1': {'precision': 0.2892671663201823, 'recall': 0.28157739495359063, 'f1-score': 0.2853704866918425, 'support': 133917}, '2': {'precision': 0.327926828765627, 'recall': 0.6120976180217886, 'f1-score': 0.4270595971389079, 'support': 129976}, 'accuracy': 0.30578368380304655, 'macro avg': {'precision': 0.2703144475086783, 'recall': 0.3113574610638267, 'f1-score': 0.2597617649741489, 'support': 401699}, 'weighted avg': {'precision': 0.2690079666145266, 'recall': 0.30578368380304655, 'f1-score': 0.2562528332999098, 'support': 401699}}
[[ 5567 48110 84129]
 [17287 37708 78922]
 [ 5879 44539 79558]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1163095
{'0': {'precision': 0.43478260869565216, 'recall': 0.0004220477758082215, 'f1-score': 0.0008432769743222161, 'support': 47388}, '1': {'precision': 0.25716258198136005, 'recall': 0.2755804689278398, 'f1-score': 0.2660531556898565, 'support': 35144}, '2': {'precision': 0.33956135070363347, 'recall': 0.6917488083668841, 'f1-score': 0.4555199183306542, 'support': 43218}, 'accuracy': 0.3149184890656064, 'macro avg': {'precision': 0.34383551379354854, 'recall': 0.3225837750235107, 'f1-score': 0.24080545033161097, 'support': 125750}, 'weighted avg': {'precision': 0.35241640156447007, 'recall': 0.3149184890656064, 'f1-score': 0.23122698324642316, 'support': 125750}}
[[   20 14667 32701]
 [   13  9685 25446]
 [   13 13309 29896]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
6357/6357 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104839
{'0': {'precision': 0.3616666666666667, 'recall': 0.0003570635227525155, 'f1-score': 0.0007134227029514989, 'support': 607735}, '1': {'precision': 0.24261930088460823, 'recall': 0.34217477888359393, 'f1-score': 0.283922866202713, 'support': 415279}, '2': {'precision': 0.3674581078043129, 'recall': 0.6330858802790674, 'f1-score': 0.46501211823899824, 'support': 604155}, 'accuracy': 0.3225215082145739, 'macro avg': {'precision': 0.32391469178519594, 'recall': 0.3252059075618046, 'f1-score': 0.24988280238155425, 'support': 1627169}, 'weighted avg': {'precision': 0.33343423174804865, 'recall': 0.3225215082145739, 'f1-score': 0.2453833450581081, 'support': 1627169}}
[[   217 222150 385368]
 [   145 142098 273036]
 [   238 221435 382482]]
Evaluating performance on  train set...
1701/1701 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1453913
{'0': {'precision': 0.28359032736555245, 'recall': 0.16961006808335052, 'f1-score': 0.2122671348713513, 'support': 145410}, '1': {'precision': 0.2646507701177827, 'recall': 0.1752490165465615, 'f1-score': 0.21086524066364512, 'support': 146677}, '2': {'precision': 0.33337179645316983, 'recall': 0.5845490507985014, 'f1-score': 0.42459470827611023, 'support': 143331}, 'accuracy': 0.30809934361923486, 'macro avg': {'precision': 0.29387096464550166, 'recall': 0.3098027118094711, 'f1-score': 0.2825756946037022, 'support': 435418}, 'weighted avg': {'precision': 0.29359733283470196, 'recall': 0.30809934361923486, 'f1-score': 0.2816889267747034, 'support': 435418}}
[[24663 36376 84371]
 [37804 25705 83168]
 [24500 35047 83784]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1115416
{'0': {'precision': 0.32, 'recall': 0.00030277798804026945, 'f1-score': 0.0006049835520096796, 'support': 52844}, '1': {'precision': 0.26385961550744075, 'recall': 0.41537842797174673, 'f1-score': 0.32271923914423256, 'support': 39783}, '2': {'precision': 0.35559897273319324, 'recall': 0.5626652667599937, 'f1-score': 0.4357856535128338, 'support': 51432}, 'accuracy': 0.3157039823961016, 'macro avg': {'precision': 0.313152862746878, 'recall': 0.3261154909065936, 'f1-score': 0.25303662540302535, 'support': 144059}, 'weighted avg': {'precision': 0.31720596040057275, 'recall': 0.3157039823961016, 'f1-score': 0.24492768222165553, 'support': 144059}}
[[   16 23626 29202]
 [   18 16525 23240]
 [   16 22477 28939]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
7459/7459 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110815
{'0': {'precision': 0.39097744360902253, 'recall': 0.000433406771702983, 'f1-score': 0.0008658537262237121, 'support': 719878}, '1': {'precision': 0.2303886395569318, 'recall': 0.3678068051151608, 'f1-score': 0.2833137905177923, 'support': 459184}, '2': {'precision': 0.38284542144985934, 'recall': 0.6162651039662334, 'f1-score': 0.47228863564326096, 'support': 730189}, 'accuracy': 0.3243119945989291, 'macro avg': {'precision': 0.3347371682052713, 'recall': 0.32816843861769907, 'f1-score': 0.252156093295759, 'support': 1909251}, 'weighted avg': {'precision': 0.349244993277331, 'recall': 0.3243119945989291, 'f1-score': 0.2490905780358714, 'support': 1909251}}
[[   312 284272 435294]
 [   194 168891 290099]
 [   292 279907 449990]]
Evaluating performance on  train set...
1664/1664 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.133477
{'0': {'precision': 0.35431408577348605, 'recall': 0.06271755302584686, 'f1-score': 0.10657087086380848, 'support': 144505}, '1': {'precision': 0.2626134521433219, 'recall': 0.1710691733536397, 'f1-score': 0.20717946040943455, 'support': 139201}, '2': {'precision': 0.32731258899540533, 'recall': 0.7125905930815355, 'f1-score': 0.4485799753962705, 'support': 142257}, 'accuracy': 0.3151611759706829, 'macro avg': {'precision': 0.3147467089707378, 'recall': 0.31545910648700737, 'f1-score': 0.25411010222317115, 'support': 425963}, 'weighted avg': {'precision': 0.31532954526383633, 'recall': 0.3151611759706829, 'f1-score': 0.25366816677170456, 'support': 425963}}
[[  9063  33340 102102]
 [  9154  23813 106234]
 [  7362  33524 101371]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1444712
{'0': {'precision': 0.26690736174709406, 'recall': 0.06337689492943022, 'f1-score': 0.10243152363089504, 'support': 47825}, '1': {'precision': 0.2443561495394618, 'recall': 0.14690952523141237, 'f1-score': 0.18349805889433268, 'support': 36839}, '2': {'precision': 0.3707941462623642, 'recall': 0.770058090587641, 'f1-score': 0.5005609369014392, 'support': 47512}, 'accuracy': 0.3406821208086188, 'macro avg': {'precision': 0.29401921918297336, 'recall': 0.32678150358282787, 'f1-score': 0.26216350647555564, 'support': 132176}, 'weighted avg': {'precision': 0.29796523003916336, 'recall': 0.3406821208086188, 'f1-score': 0.2681373611193943, 'support': 132176}}
[[ 3031  8792 36002]
 [ 5344  5412 26083]
 [ 2981  7944 36587]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
8238/8238 - 56s - 56s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110932
{'0': {'precision': 0.39300134589502017, 'recall': 0.0003856378939416551, 'f1-score': 0.0007705197049859486, 'support': 757187}, '1': {'precision': 0.2275851986461908, 'recall': 0.24969041796162217, 'f1-score': 0.238125902076163, 'support': 579814}, '2': {'precision': 0.35787789433634093, 'recall': 0.6825581530957753, 'f1-score': 0.46955788430226525, 'support': 771713}, 'accuracy': 0.3185851661249463, 'macro avg': {'precision': 0.32615481295918397, 'recall': 0.31087806965044634, 'f1-score': 0.23615143536113806, 'support': 2108714}, 'weighted avg': {'precision': 0.334664453280073, 'recall': 0.3185851661249463, 'f1-score': 0.2375931884830288, 'support': 2108714}}
[[   292 246650 510245]
 [   184 144774 434856]
 [   267 244707 526739]]
Evaluating performance on  train set...
1806/1806 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1347213
{'0': {'precision': 0.3222491170985278, 'recall': 0.15653330420647515, 'f1-score': 0.21071249416201068, 'support': 155641}, '1': {'precision': 0.27149205643817353, 'recall': 0.16145272435368038, 'f1-score': 0.2024883269046721, 'support': 151357}, '2': {'precision': 0.33151576462653853, 'recall': 0.6335900493023555, 'f1-score': 0.4352788815956964, 'support': 155165}, 'accuracy': 0.31830977382438663, 'macro avg': {'precision': 0.3084189793877466, 'recall': 0.31719202595417034, 'f1-score': 0.2828265675541264, 'support': 462163}, 'weighted avg': {'precision': 0.3087374836127545, 'recall': 0.31830977382438663, 'f1-score': 0.28341424272816346, 'support': 462163}}
[[24363 32946 98332]
 [27013 24437 99907]
 [24227 32627 98311]]
Evaluating performance on  val set...
642/642 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1718855
{'0': {'precision': 0.32167216721672165, 'recall': 0.37541497771500887, 'f1-score': 0.3464718876691691, 'support': 54521}, '1': {'precision': 0.2584502866179087, 'recall': 0.14605674709562108, 'f1-score': 0.18663906930269075, 'support': 53712}, '2': {'precision': 0.34884415252068585, 'recall': 0.4374654566849115, 'f1-score': 0.388160756800367, 'support': 56089}, 'accuracy': 0.321624615085016, 'macro avg': {'precision': 0.30965553545177205, 'recall': 0.31964572716518047, 'f1-score': 0.30709057125740896, 'support': 164322}, 'weighted avg': {'precision': 0.31028157942562007, 'recall': 0.321624615085016, 'f1-score': 0.30845717655683763, 'support': 164322}}
[[20468 11747 22306]
 [22372  7845 23495]
 [20790 10762 24537]]
testing model on single stock: results/universal/W5/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
31315/31315 - 209s - 209s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124797
{'0': {'precision': 0.4297029702970297, 'recall': 0.00042447326356366495, 'f1-score': 0.0008481087403077359, 'support': 3067331}, '1': {'precision': 0.20451726598931544, 'recall': 0.2874208736212223, 'f1-score': 0.23898342709435152, 'support': 1848467}, '2': {'precision': 0.3827652616748743, 'recall': 0.6685413043814792, 'f1-score': 0.48681211660637896, 'support': 3100688}, 'accuracy': 0.32502121253626587, 'macro avg': {'precision': 0.33899516598707313, 'recall': 0.31879555042208835, 'f1-score': 0.2422145508136794, 'support': 8016486}, 'weighted avg': {'precision': 0.3596239440058615, 'recall': 0.32502121253626587, 'f1-score': 0.2437236086955471, 'support': 8016486}}
[[   1302 1039850 2026179]
 [    606  531288 1316573]
 [   1122 1026628 2072938]]
Evaluating performance on  train set...
5759/5759 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1422741
{'0': {'precision': 0.3455682185207401, 'recall': 0.21224272504979516, 'f1-score': 0.26297203823205584, 'support': 494024}, '1': {'precision': 0.24160468304881255, 'recall': 0.07038140766954326, 'f1-score': 0.1090079218171299, 'support': 483210}, '2': {'precision': 0.329342020821622, 'recall': 0.6826163424813558, 'f1-score': 0.4443152086710218, 'support': 496938}, 'accuracy': 0.32430408391965115, 'macro avg': {'precision': 0.3055049741303915, 'recall': 0.32174682506689806, 'f1-score': 0.27209838957340254, 'support': 1474172}, 'weighted avg': {'precision': 0.30602084263271995, 'recall': 0.32430408391965115, 'f1-score': 0.27363518455334157, 'support': 1474172}}
[[104853  53724 335447]
 [ 93879  34009 355322]
 [104690  53030 339218]]
Evaluating performance on  val set...
2129/2129 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1448314
{'0': {'precision': 0.28674211104392144, 'recall': 0.1230771675565726, 'f1-score': 0.1722291199525601, 'support': 188784}, '1': {'precision': 0.2748568687988969, 'recall': 0.1113006008375311, 'f1-score': 0.15844176040640712, 'support': 164770}, '2': {'precision': 0.35862704469179507, 'recall': 0.7442655157639535, 'f1-score': 0.4840249212926859, 'support': 191386}, 'accuracy': 0.3376812126105626, 'macro avg': {'precision': 0.30674200817820446, 'recall': 0.32621442805268575, 'f1-score': 0.2715652672172177, 'support': 544940}, 'weighted avg': {'precision': 0.30839484078741475, 'recall': 0.3376812126105626, 'f1-score': 0.2775647679190549, 'support': 544940}}
[[ 23235  23578 141971]
 [ 33657  18339 112774]
 [ 24139  24805 142442]]
training model: results/universal/W5/deepLOB_L1/h1000
Epoch 1/50
9913/9913 - 158s - loss: 3.1570 - accuracy1000: 0.4411 - val_loss: 3.5207 - val_accuracy1000: 0.2960 - 158s/epoch - 16ms/step
Epoch 2/50
9913/9913 - 157s - loss: 3.1198 - accuracy1000: 0.4567 - val_loss: 3.8220 - val_accuracy1000: 0.3353 - 157s/epoch - 16ms/step
Epoch 3/50
9913/9913 - 154s - loss: 3.0969 - accuracy1000: 0.4651 - val_loss: 3.6815 - val_accuracy1000: 0.3258 - 154s/epoch - 16ms/step
Epoch 4/50
9913/9913 - 157s - loss: 3.0822 - accuracy1000: 0.4704 - val_loss: 3.6532 - val_accuracy1000: 0.3329 - 157s/epoch - 16ms/step
Epoch 5/50
9913/9913 - 157s - loss: 3.0746 - accuracy1000: 0.4731 - val_loss: 3.7361 - val_accuracy1000: 0.3330 - 157s/epoch - 16ms/step
Epoch 6/50
9913/9913 - 156s - loss: 3.0675 - accuracy1000: 0.4756 - val_loss: 3.5845 - val_accuracy1000: 0.3005 - 156s/epoch - 16ms/step
Epoch 7/50
9913/9913 - 154s - loss: 3.0596 - accuracy1000: 0.4774 - val_loss: 3.5856 - val_accuracy1000: 0.3059 - 154s/epoch - 16ms/step
Epoch 8/50
9913/9913 - 155s - loss: 3.0534 - accuracy1000: 0.4793 - val_loss: 3.6166 - val_accuracy1000: 0.3175 - 155s/epoch - 16ms/step
Epoch 9/50
9913/9913 - 155s - loss: 3.0447 - accuracy1000: 0.4812 - val_loss: 3.5942 - val_accuracy1000: 0.3235 - 155s/epoch - 16ms/step
Epoch 10/50
9913/9913 - 156s - loss: 3.0415 - accuracy1000: 0.4825 - val_loss: 3.5952 - val_accuracy1000: 0.3253 - 156s/epoch - 16ms/step
Epoch 11/50
9913/9913 - 154s - loss: 3.0376 - accuracy1000: 0.4833 - val_loss: 3.5920 - val_accuracy1000: 0.3080 - 154s/epoch - 15ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 347s - 347s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1740409
{'0': {'precision': 0.3844643745545979, 'recall': 0.005807367941939726, 'f1-score': 0.011441904911299526, 'support': 4923573}, '1': {'precision': 0.21626973634499597, 'recall': 0.7193688737318858, 'f1-score': 0.3325594198042079, 'support': 2916437}, '2': {'precision': 0.37059165924251086, 'recall': 0.22711273910492216, 'f1-score': 0.2816311442670047, 'support': 4998381}, 'accuracy': 0.2540647811707869, 'macro avg': {'precision': 0.3237752567140349, 'recall': 0.3174296602595826, 'f1-score': 0.20854415632750403, 'support': 12838391}, 'weighted avg': {'precision': 0.3408553130522304, 'recall': 0.2540647811707869, 'f1-score': 0.18958165483648393, 'support': 12838391}}
[[  28593 3767752 1127228]
 [  17668 2097994  800775]
 [  28110 3835075 1135196]]
Evaluating performance on  train set...
9913/9913 - 69s - 69s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1736016
{'0': {'precision': 0.32930184977759935, 'recall': 0.11788825173722979, 'f1-score': 0.173621103117506, 'support': 862868}, '1': {'precision': 0.2821490871031515, 'recall': 0.3689369166836978, 'f1-score': 0.31975872199837735, 'support': 822024}, '2': {'precision': 0.31804820438827114, 'recall': 0.4304346346437972, 'f1-score': 0.36580387823458393, 'support': 852141}, 'accuracy': 0.3042088928287492, 'macro avg': {'precision': 0.30983304708967396, 'recall': 0.30575326768824157, 'f1-score': 0.2863945677834891, 'support': 2537033}, 'weighted avg': {'precision': 0.3102439994380855, 'recall': 0.3042088928287492, 'f1-score': 0.2855216783934174, 'support': 2537033}}
[[101722 389378 371768]
 [104052 303275 414697]
 [103128 382222 366791]]
Evaluating performance on  val set...
3496/3496 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1773418
{'0': {'precision': 0.3035363638031969, 'recall': 0.10702176670031317, 'f1-score': 0.1582479824338999, 'support': 309096}, '1': {'precision': 0.2539085154428006, 'recall': 0.37749313882325314, 'f1-score': 0.3036061810128469, 'support': 272548}, '2': {'precision': 0.33895303553384976, 'recall': 0.4121026953531153, 'f1-score': 0.37196563130317767, 'support': 312575}, 'accuracy': 0.29609972501143456, 'macro avg': {'precision': 0.2987993049266157, 'recall': 0.2988725336255605, 'f1-score': 0.27793993158330815, 'support': 894219}, 'weighted avg': {'precision': 0.3007902751507297, 'recall': 0.29609972501143456, 'f1-score': 0.2772567268260559, 'support': 894219}}
[[ 33080 152445 123571]
 [ 42015 102885 127648]
 [ 33887 149875 128813]]
testing model out of sample: results/universal/W5/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 132s - 132s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.162702
{'0': {'precision': 0.2954643766922473, 'recall': 0.009241599525341987, 'f1-score': 0.017922611674965342, 'support': 1995542}, '1': {'precision': 0.2389889373586802, 'recall': 0.7859755641992495, 'f1-score': 0.3665287228823141, 'support': 1311682}, '2': {'precision': 0.3654672028080594, 'recall': 0.17410879595615247, 'f1-score': 0.23585576374081899, 'support': 2041620}, 'accuracy': 0.2626466578572865, 'macro avg': {'precision': 0.29997350561966235, 'recall': 0.3231086532269147, 'f1-score': 0.20676903276603278, 'support': 5348844}, 'weighted avg': {'precision': 0.3083347001936678, 'recall': 0.2626466578572865, 'f1-score': 0.18659401863343444, 'support': 5348844}}
[[  18442 1621584  355516]
 [  19083 1030950  261649]
 [  24892 1661264  355464]]
Evaluating performance on  train set...
4957/4957 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.153942
{'0': {'precision': 0.32118333096287865, 'recall': 0.13174309443190807, 'f1-score': 0.18684573709345928, 'support': 428531}, '1': {'precision': 0.3168990784745715, 'recall': 0.5920037947118391, 'f1-score': 0.41281739233572523, 'support': 417423}, '2': {'precision': 0.3216465510350891, 'recall': 0.2381756196879661, 'f1-score': 0.2736882196513708, 'support': 422390}, 'accuracy': 0.3186635486902607, 'macro avg': {'precision': 0.31990965349084644, 'recall': 0.3206408362772377, 'f1-score': 0.2911171163601851, 'support': 1268344}, 'weighted avg': {'precision': 0.3199276101173307, 'recall': 0.3186635486902607, 'f1-score': 0.290135666681827, 'support': 1268344}}
[[ 56456 269444 102631]
 [ 60766 247116 109541]
 [ 58553 263234 100603]]
Evaluating performance on  val set...
1701/1701 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1481867
{'0': {'precision': 0.3579447588582677, 'recall': 0.15208740369975887, 'f1-score': 0.21347237699542784, 'support': 153037}, '1': {'precision': 0.2991790975248703, 'recall': 0.6609367138784285, 'f1-score': 0.41190541230685174, 'support': 131182}, '2': {'precision': 0.3742040002492367, 'recall': 0.19905470888878576, 'f1-score': 0.2598724350708358, 'support': 150853}, 'accuracy': 0.32179961017946457, 'macro avg': {'precision': 0.34377595221079166, 'recall': 0.33735960882232435, 'f1-score': 0.2950834081243718, 'support': 435072}, 'weighted avg': {'precision': 0.34586344440115285, 'recall': 0.32179961017946457, 'f1-score': 0.28939183492209913, 'support': 435072}}
[[ 23275 105035  24727]
 [ 18989  86703  25490]
 [ 22760  98065  30028]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1719921
{'0': {'precision': 0.23216489755615896, 'recall': 0.09413589900784466, 'f1-score': 0.13395646948858325, 'support': 79927}, '1': {'precision': 0.36385096679068274, 'recall': 0.4972645075069431, 'f1-score': 0.420222785926988, 'support': 95778}, '2': {'precision': 0.3244179049206129, 'recall': 0.36649061339747946, 'f1-score': 0.3441732554142317, 'support': 95615}, 'accuracy': 0.33242296918767505, 'macro avg': {'precision': 0.3068112564224849, 'recall': 0.3192970066374224, 'f1-score': 0.29945083694326763, 'support': 271320}, 'weighted avg': {'precision': 0.3111616528204096, 'recall': 0.33242296918767505, 'f1-score': 0.30909244635029043, 'support': 271320}}
[[ 7524 35812 36591]
 [11769 47627 36382]
 [13115 47458 35042]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1565751
{'0': {'precision': 0.4625176803394625, 'recall': 0.013488429649795818, 'f1-score': 0.0262124248496994, 'support': 24243}, '1': {'precision': 0.3288678698967281, 'recall': 0.7439088289232382, 'f1-score': 0.4561018378465204, 'support': 22902}, '2': {'precision': 0.2743486623535583, 'recall': 0.20897709110282364, 'f1-score': 0.2372420049897936, 'support': 22524}, 'accuracy': 0.3167980019807949, 'macro avg': {'precision': 0.3552447375299163, 'recall': 0.32212478322528587, 'f1-score': 0.23985208922867116, 'support': 69669}, 'weighted avg': {'precision': 0.3577484584491812, 'recall': 0.3167980019807949, 'f1-score': 0.23575408038557158, 'support': 69669}}
[[  327 17109  6807]
 [  222 17037  5643]
 [  158 17659  4707]]
Evaluating performance on  val set...
96/96 - 1s - 694ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1361375
{'0': {'precision': 0.30337078651685395, 'recall': 0.003061224489795918, 'f1-score': 0.006061286339656528, 'support': 8820}, '1': {'precision': 0.30244516738377586, 'recall': 0.7593202476617047, 'f1-score': 0.43258658861495747, 'support': 7591}, '2': {'precision': 0.37243182667164737, 'recall': 0.24647713226205192, 'f1-score': 0.296637905385302, 'support': 8090}, 'accuracy': 0.3177421329741643, 'macro avg': {'precision': 0.32608259352409236, 'recall': 0.3362862014711842, 'f1-score': 0.24509526011330532, 'support': 24501}, 'weighted avg': {'precision': 0.32588731400606186, 'recall': 0.3177421329741643, 'f1-score': 0.23415476895877743, 'support': 24501}}
[[  27 7231 1562]
 [  29 5764 1798]
 [  33 6063 1994]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1513622
{'0': {'precision': 0.32805995004163196, 'recall': 0.0042281709941030966, 'f1-score': 0.008348740007734239, 'support': 186369}, '1': {'precision': 0.2893262214232493, 'recall': 0.6606837099013163, 'f1-score': 0.4024234169323345, 'support': 185137}, '2': {'precision': 0.24248912629906222, 'recall': 0.17316462440063932, 'f1-score': 0.20204575758611792, 'support': 187700}, 'accuracy': 0.2782659699645569, 'macro avg': {'precision': 0.2866250992546478, 'recall': 0.27935883509868625, 'f1-score': 0.20427263817539557, 'support': 559206}, 'weighted avg': {'precision': 0.286514097651454, 'recall': 0.2782659699645569, 'f1-score': 0.2038307871625436, 'support': 559206}}
[[   788 146148  39433]
 [   717 122317  62103]
 [   897 154300  32503]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1667628
{'0': {'precision': 0.25198230531675153, 'recall': 0.06236572467360767, 'f1-score': 0.09998509662355727, 'support': 48408}, '1': {'precision': 0.2763840523061616, 'recall': 0.3186855960502325, 'f1-score': 0.2960312853839786, 'support': 48813}, '2': {'precision': 0.360687161817873, 'recall': 0.5560127174116327, 'f1-score': 0.4375404721257432, 'support': 53470}, 'accuracy': 0.3205566357645778, 'macro avg': {'precision': 0.29635117314692877, 'recall': 0.312354679378491, 'f1-score': 0.277852284711093, 'support': 150691}, 'weighted avg': {'precision': 0.2984586785103002, 'recall': 0.3205566357645778, 'f1-score': 0.28326537573819804, 'support': 150691}}
[[ 3019 20016 25373]
 [ 5934 15556 27323]
 [ 3028 20712 29730]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1520327
{'0': {'precision': 0.3067099567099567, 'recall': 0.332336558194078, 'f1-score': 0.31900942732517235, 'support': 17055}, '1': {'precision': 0.38501515807708964, 'recall': 0.23949353448275862, 'f1-score': 0.29529978408902174, 'support': 22272}, '2': {'precision': 0.32594390063337997, 'recall': 0.4575370937012875, 'f1-score': 0.38068932388615345, 'support': 17321}, 'accuracy': 0.3341159440756955, 'macro avg': {'precision': 0.33922300514014214, 'recall': 0.34312239545937473, 'f1-score': 0.3316661784334492, 'support': 56648}, 'weighted avg': {'precision': 0.3433778812182606, 'recall': 0.3341159440756955, 'f1-score': 0.328547210021423, 'support': 56648}}
[[5668 4770 6617]
 [7166 5334 9772]
 [5646 3750 7925]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1601119
{'0': {'precision': 0.3469387755102041, 'recall': 0.004048156577567534, 'f1-score': 0.008002933201761733, 'support': 218371}, '1': {'precision': 0.2519696348444099, 'recall': 0.712381700887448, 'f1-score': 0.37226796996392664, 'support': 152685}, '2': {'precision': 0.3852813590538969, 'recall': 0.2786392495191191, 'f1-score': 0.32339562096505564, 'support': 228227}, 'accuracy': 0.2890904631034086, 'macro avg': {'precision': 0.32806325646950363, 'recall': 0.3316897023280449, 'f1-score': 0.23455550804358136, 'support': 599283}, 'weighted avg': {'precision': 0.3373447265748423, 'recall': 0.2890904631034086, 'f1-score': 0.22092226194658587, 'support': 599283}}
[[   884 159272  58215]
 [   667 108770  43248]
 [   997 163637  63593]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1292459
{'0': {'precision': 0.2916666666666667, 'recall': 0.004597980780926894, 'f1-score': 0.009053241683232342, 'support': 41105}, '1': {'precision': 0.3259216538751608, 'recall': 0.8969769486227779, 'f1-score': 0.4781168446605101, 'support': 40952}, '2': {'precision': 0.26570667718709934, 'recall': 0.06501749728490407, 'f1-score': 0.1044712452010703, 'support': 41435}, 'accuracy': 0.3207981083794902, 'macro avg': {'precision': 0.29443166590964226, 'recall': 0.3221974755628696, 'f1-score': 0.19721377718160424, 'support': 123492}, 'weighted avg': {'precision': 0.2943158914915653, 'recall': 0.3207981083794902, 'f1-score': 0.19661792315966076, 'support': 123492}}
[[  189 37426  3490]
 [  264 36733  3955]
 [  195 38546  2694]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1378186
{'0': {'precision': 0.48619072433559146, 'recall': 0.058719869091824535, 'f1-score': 0.10478436657681942, 'support': 15889}, '1': {'precision': 0.2516563955675144, 'recall': 0.8152591620582997, 'f1-score': 0.38459497700742834, 'support': 10669}, '2': {'precision': 0.4461888039661227, 'recall': 0.14629190653572638, 'f1-score': 0.22034071202693054, 'support': 14765}, 'accuracy': 0.2853374633981076, 'macro avg': {'precision': 0.3946786412897428, 'recall': 0.34009031256195027, 'f1-score': 0.23657335187039275, 'support': 41323}, 'weighted avg': {'precision': 0.4113443891740151, 'recall': 0.2853374633981076, 'f1-score': 0.21831651194997861, 'support': 41323}}
[[  933 13670  1286]
 [  576  8698  1395]
 [  410 12195  2160]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030428
{'0': {'precision': 0.28053733208372383, 'recall': 0.005810078998958326, 'f1-score': 0.011384381338742394, 'support': 154559}, '1': {'precision': 0.4023832836545127, 'recall': 0.8840413481948238, 'f1-score': 0.5530420543356903, 'support': 210118}, '2': {'precision': 0.25523647398416105, 'recall': 0.08945525291828794, 'f1-score': 0.13247920708399763, 'support': 154200}, 'accuracy': 0.38630542498511206, 'macro avg': {'precision': 0.31271902990746586, 'recall': 0.3264355600373567, 'f1-score': 0.2323018809194768, 'support': 518877}, 'weighted avg': {'precision': 0.32235964321564614, 'recall': 0.38630542498511206, 'f1-score': 0.2667143517646643, 'support': 518877}}
[[   898 136381  17280]
 [  1395 185753  22970]
 [   908 139498  13794]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1559952
{'0': {'precision': 0.29069693702834676, 'recall': 0.1681769820596544, 'f1-score': 0.21308046297587507, 'support': 27257}, '1': {'precision': 0.3131582642887235, 'recall': 0.5588372176278953, 'f1-score': 0.4013885317562355, 'support': 27933}, '2': {'precision': 0.3337391488460724, 'recall': 0.2150555972440139, 'f1-score': 0.26156399087326276, 'support': 29318}, 'accuracy': 0.3135679462299427, 'macro avg': {'precision': 0.31253145005438093, 'recall': 0.3140232656438545, 'f1-score': 0.29201099520179113, 'support': 84508}, 'weighted avg': {'precision': 0.3130536821937297, 'recall': 0.3135679462299427, 'f1-score': 0.2921433843103928, 'support': 84508}}
[[ 4584 16625  6048]
 [ 5784 15610  6539]
 [ 5401 17612  6305]]
Evaluating performance on  val set...
136/136 - 1s - 875ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1442707
{'0': {'precision': 0.4074074074074074, 'recall': 0.004572283647851027, 'f1-score': 0.00904307793488984, 'support': 12029}, '1': {'precision': 0.29541945445187856, 'recall': 0.7984790874524715, 'f1-score': 0.4312762973352034, 'support': 10783}, '2': {'precision': 0.296221198156682, 'recall': 0.13512150004204154, 'f1-score': 0.18558725025984527, 'support': 11893}, 'accuracy': 0.2959804062815156, 'macro avg': {'precision': 0.33301602000532265, 'recall': 0.31272429038078803, 'f1-score': 0.20863554184331282, 'support': 34705}, 'weighted avg': {'precision': 0.3345100242252047, 'recall': 0.2959804062815156, 'f1-score': 0.20073247848968817, 'support': 34705}}
[[   55 10292  1682]
 [   37  8610  2136]
 [   43 10243  1607]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1320194
{'0': {'precision': 0.3387668320340184, 'recall': 0.00545015050624829, 'f1-score': 0.010727711384166526, 'support': 263112}, '1': {'precision': 0.2998436732067913, 'recall': 0.9295734605577618, 'f1-score': 0.45342904905792025, 'support': 225114}, '2': {'precision': 0.31271751019190613, 'recall': 0.049501833692726614, 'f1-score': 0.08547356977850253, 'support': 254132}, 'accuracy': 0.3007632436102258, 'macro avg': {'precision': 0.317109338477572, 'recall': 0.3281751482522456, 'f1-score': 0.18321011007352975, 'support': 742358}, 'weighted avg': {'precision': 0.3180462171357994, 'recall': 0.3007632436102258, 'f1-score': 0.17056108478966467, 'support': 742358}}
[[  1434 248496  13182]
 [  1388 209260  14466]
 [  1411 240141  12580]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1564074
{'0': {'precision': 0.3013714506470929, 'recall': 0.1297916943963796, 'f1-score': 0.18144181232483225, 'support': 60104}, '1': {'precision': 0.3198604448320977, 'recall': 0.6176232821341956, 'f1-score': 0.42145426545458725, 'support': 59376}, '2': {'precision': 0.3016429708365932, 'recall': 0.19237121915969857, 'f1-score': 0.2349221023437582, 'support': 58122}, 'accuracy': 0.3133635882478801, 'macro avg': {'precision': 0.30762495543859464, 'recall': 0.31326206523009126, 'f1-score': 0.2792727267077259, 'support': 177602}, 'weighted avg': {'precision': 0.3076415591773064, 'recall': 0.3133635882478801, 'f1-score': 0.2791848604521751, 'support': 177602}}
[[ 7801 39958 12345]
 [ 9163 36672 13541]
 [ 8921 38020 11181]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1276634
{'0': {'precision': 0.2975778546712803, 'recall': 0.00428031057137169, 'f1-score': 0.008439232618615377, 'support': 20092}, '1': {'precision': 0.3326186768066989, 'recall': 0.7747938751472321, 'f1-score': 0.4654289191407466, 'support': 21225}, '2': {'precision': 0.31857771392655115, 'recall': 0.1814833759590793, 'f1-score': 0.23123798351093297, 'support': 19550}, 'accuracy': 0.3298831879343487, 'macro avg': {'precision': 0.3162580818015101, 'recall': 0.320185853892561, 'f1-score': 0.23503537842343167, 'support': 60867}, 'weighted avg': {'precision': 0.3165419682018437, 'recall': 0.3298831879343487, 'f1-score': 0.23935782029957622, 'support': 60867}}
[[   86 17079  2927]
 [  118 16445  4662]
 [   85 15917  3548]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
7167/7167 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1898601
{'0': {'precision': 0.4454322896533952, 'recall': 0.00975106163026355, 'f1-score': 0.019084343468497997, 'support': 709051}, '1': {'precision': 0.1860935543456132, 'recall': 0.5471182438341787, 'f1-score': 0.27772378702904055, 'support': 365888}, '2': {'precision': 0.3954921892236578, 'recall': 0.38700581334119677, 'f1-score': 0.39120298290577815, 'support': 759632}, 'accuracy': 0.2731319747232459, 'macro avg': {'precision': 0.34233934440755537, 'recall': 0.31462503960187965, 'f1-score': 0.22933703780110556, 'support': 1834571}, 'weighted avg': {'precision': 0.37303115088365774, 'recall': 0.2731319747232459, 'f1-score': 0.22474893482991154, 'support': 1834571}}
[[  6914 415438 286699]
 [  3053 200184 162651]
 [  5555 460095 293982]]
Evaluating performance on  train set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1410675
{'0': {'precision': 0.2623401082947501, 'recall': 0.047916980212566206, 'f1-score': 0.08103309315896959, 'support': 139533}, '1': {'precision': 0.30612973666497073, 'recall': 0.7356845590692306, 'f1-score': 0.4323513725210157, 'support': 131676}, '2': {'precision': 0.29219366927658436, 'recall': 0.1338416736914706, 'f1-score': 0.18358894576951781, 'support': 130490}, 'accuracy': 0.30127782244914725, 'macro avg': {'precision': 0.28688783807876833, 'recall': 0.3058144043244225, 'f1-score': 0.2323244704831677, 'support': 401699}, 'weighted avg': {'precision': 0.2863920334371993, 'recall': 0.30127782244914725, 'f1-score': 0.22950918834573183, 'support': 401699}}
[[  6686 114204  18643]
 [ 11140  96872  23664]
 [  7660 105365  17465]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1695203
{'0': {'precision': 0.3788706739526412, 'recall': 0.004444729362993355, 'f1-score': 0.008786381109280617, 'support': 46797}, '1': {'precision': 0.2594247802900287, 'recall': 0.6254651485698417, 'f1-score': 0.36673749684520757, 'support': 36010}, '2': {'precision': 0.3066541608045438, 'recall': 0.27408425121672914, 'f1-score': 0.2894558868736551, 'support': 42943}, 'accuracy': 0.27436182902584494, 'macro avg': {'precision': 0.3149832050157379, 'recall': 0.301331376383188, 'f1-score': 0.22165992160938108, 'support': 125750}, 'weighted avg': {'precision': 0.3200043490627054, 'recall': 0.27436182902584494, 'f1-score': 0.2071371585541336, 'support': 125750}}
[[  208 33324 13265]
 [  140 22523 13347]
 [  201 30972 11770]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
6357/6357 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1833768
{'0': {'precision': 0.38623909072457885, 'recall': 0.005766622980128939, 'f1-score': 0.011363585470972251, 'support': 660005}, '1': {'precision': 0.1858722484441686, 'recall': 0.8252194889160549, 'f1-score': 0.30340550950448114, 'support': 305938}, '2': {'precision': 0.37550475219851914, 'recall': 0.1471055282157689, 'f1-score': 0.21139586031834343, 'support': 661226}, 'accuracy': 0.2172742966465069, 'macro avg': {'precision': 0.31587203045575557, 'recall': 0.3260305467039843, 'f1-score': 0.1753883184312656, 'support': 1627169}, 'weighted avg': {'precision': 0.34420433298287134, 'recall': 0.2172742966465069, 'f1-score': 0.14755918846192861, 'support': 1627169}}
[[  3806 545934 110265]
 [  1969 252466  51503]
 [  4079 559877  97270]]
Evaluating performance on  train set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1618505
{'0': {'precision': 0.30546066512609266, 'recall': 0.16385623336814092, 'f1-score': 0.21329568225766138, 'support': 148435}, '1': {'precision': 0.2863417942892634, 'recall': 0.490879670491321, 'f1-score': 0.36169707605357554, 'support': 142758}, '2': {'precision': 0.31204192252975815, 'recall': 0.24029121164846595, 'f1-score': 0.2715061871540658, 'support': 144225}, 'accuracy': 0.2963933507572034, 'macro avg': {'precision': 0.3012814606483714, 'recall': 0.29834237183597595, 'f1-score': 0.2821663151551009, 'support': 435418}, 'weighted avg': {'precision': 0.301372203202423, 'recall': 0.2963933507572034, 'f1-score': 0.2812324608111457, 'support': 435418}}
[[24322 89474 34639]
 [30914 70077 41767]
 [24388 85181 34656]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.152071
{'0': {'precision': 0.295, 'recall': 0.0033141722995113, 'f1-score': 0.0065547058714611065, 'support': 53407}, '1': {'precision': 0.2699234472417331, 'recall': 0.8533220229036201, 'f1-score': 0.41011805193325784, 'support': 40081}, '2': {'precision': 0.3044957907934802, 'recall': 0.10084831227383283, 'f1-score': 0.1515151515151515, 'support': 50571}, 'accuracy': 0.2740474388965632, 'macro avg': {'precision': 0.2898064126784044, 'recall': 0.3191615024923214, 'f1-score': 0.18939596977329018, 'support': 144059}, 'weighted avg': {'precision': 0.29135648119945995, 'recall': 0.2740474388965632, 'f1-score': 0.1697240821002975, 'support': 144059}}
[[  177 47265  5965]
 [  195 34202  5684]
 [  228 45243  5100]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
7459/7459 - 48s - 48s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1864116
{'0': {'precision': 0.39218844372860884, 'recall': 0.004986675745761454, 'f1-score': 0.009848132494792827, 'support': 781282}, '1': {'precision': 0.16873209225378913, 'recall': 0.80805947758294, 'f1-score': 0.27917023555160997, 'support': 331957}, '2': {'precision': 0.39968407995555155, 'recall': 0.1554386114782189, 'f1-score': 0.22382921605233072, 'support': 796012}, 'accuracy': 0.20734204146023755, 'macro avg': {'precision': 0.32020153864598316, 'recall': 0.3228282549356401, 'f1-score': 0.17094919469957784, 'support': 1909251}, 'weighted avg': {'precision': 0.35646171964558065, 'recall': 0.20734204146023755, 'f1-score': 0.14588832189327144, 'support': 1909251}}
[[  3896 653462 123924]
 [  1799 268241  61917]
 [  4239 668042 123731]]
Evaluating performance on  train set...
1664/1664 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1739459
{'0': {'precision': 0.3854067893040015, 'recall': 0.057075253113897745, 'f1-score': 0.09942636284690372, 'support': 142426}, '1': {'precision': 0.2767398849788452, 'recall': 0.3850182935856133, 'f1-score': 0.32202070705879576, 'support': 141853}, '2': {'precision': 0.2981408662464581, 'recall': 0.4366689252138562, 'f1-score': 0.3543470790378007, 'support': 141684}, 'accuracy': 0.2925465357319767, 'macro avg': {'precision': 0.3200958468431016, 'recall': 0.29292082397112246, 'f1-score': 0.2585980496478334, 'support': 425963}, 'weighted avg': {'precision': 0.3201924128869856, 'recall': 0.2925465357319767, 'f1-score': 0.2583459456798741, 'support': 425963}}
[[ 8129 69668 64629]
 [ 6219 54616 81018]
 [ 6744 73071 61869]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1898718
{'0': {'precision': 0.2747560534875316, 'recall': 0.06649756182895629, 'f1-score': 0.10707934998855614, 'support': 45731}, '1': {'precision': 0.17680017509301815, 'recall': 0.1996441105234541, 'f1-score': 0.18752901847896739, 'support': 40462}, '2': {'precision': 0.3288207059322708, 'recall': 0.5393080051323315, 'f1-score': 0.40854688182140175, 'support': 45983}, 'accuracy': 0.27174373562522697, 'macro avg': {'precision': 0.26012564483760686, 'recall': 0.2684832258282473, 'f1-score': 0.2343850834296418, 'support': 132176}, 'weighted avg': {'precision': 0.26357826146604235, 'recall': 0.27174373562522697, 'f1-score': 0.23658497886769275, 'support': 132176}}
[[ 3041 19655 23035]
 [ 4800  8078 27584]
 [ 3227 17957 24799]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
8238/8238 - 54s - 54s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1569325
{'0': {'precision': 0.3609441104431084, 'recall': 0.006281914982942075, 'f1-score': 0.012348908075165059, 'support': 774127}, '1': {'precision': 0.24338109801766142, 'recall': 0.7754990444728816, 'f1-score': 0.37048873775103336, 'support': 532167}, '2': {'precision': 0.3674727892944112, 'recall': 0.18298397348022233, 'f1-score': 0.24431212650386405, 'support': 802420}, 'accuracy': 0.2676455887332279, 'macro avg': {'precision': 0.3239326659183937, 'recall': 0.321588310978682, 'f1-score': 0.2090499241100208, 'support': 2108714}, 'weighted avg': {'precision': 0.33375957373042453, 'recall': 0.2676455887332279, 'f1-score': 0.19099908276489275, 'support': 2108714}}
[[  4863 632590 136674]
 [  3409 412695 116063]
 [  5201 650389 146830]]
Evaluating performance on  train set...
1806/1806 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1519239
{'0': {'precision': 0.34432950857672695, 'recall': 0.15368847158635318, 'f1-score': 0.21252034265071446, 'support': 154644}, '1': {'precision': 0.33821445626560825, 'recall': 0.5705748340872322, 'f1-score': 0.42468954975191014, 'support': 151435}, '2': {'precision': 0.345352849308103, 'recall': 0.30459880577125137, 'f1-score': 0.3236981232276535, 'support': 156084}, 'accuracy': 0.3412540597148625, 'macro avg': {'precision': 0.34263227138347946, 'recall': 0.34295403714827893, 'f1-score': 0.32030267187675937, 'support': 462163}, 'weighted avg': {'precision': 0.3426714229402347, 'recall': 0.3412540597148625, 'f1-score': 0.31958844758542476, 'support': 462163}}
[[23767 85458 45419]
 [20327 86405 44703]
 [24930 83611 47543]]
Evaluating performance on  val set...
642/642 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1566795
{'0': {'precision': 0.35467392880738674, 'recall': 0.40142990023527697, 'f1-score': 0.37660626593432917, 'support': 54829}, '1': {'precision': 0.3608012296097972, 'recall': 0.4229502479851209, 'f1-score': 0.3894116283010622, 'support': 51616}, '2': {'precision': 0.4118492264955218, 'recall': 0.29714739879399416, 'f1-score': 0.3452200531941587, 'support': 57877}, 'accuracy': 0.37145969498910675, 'macro avg': {'precision': 0.3757747949709019, 'recall': 0.373842515671464, 'f1-score': 0.37041264914318334, 'support': 164322}, 'weighted avg': {'precision': 0.37673671688514515, 'recall': 0.37145969498910675, 'f1-score': 0.36957386460741276, 'support': 164322}}
[[22010 19994 12825]
 [18050 21831 11735]
 [21997 18682 17198]]
testing model on single stock: results/universal/W5/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
31315/31315 - 204s - 204s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1737664
{'0': {'precision': 0.36678232924244897, 'recall': 0.005093276486978028, 'f1-score': 0.010047036076514398, 'support': 3092312}, '1': {'precision': 0.21483366479150162, 'recall': 0.7247502792955992, 'f1-score': 0.331424902563691, 'support': 1823337}, '2': {'precision': 0.36812419819121817, 'recall': 0.21635609998203711, 'f1-score': 0.2725358445052576, 'support': 3100837}, 'accuracy': 0.2504961650279187, 'macro avg': {'precision': 0.31658006407505623, 'recall': 0.31539988525487145, 'f1-score': 0.20466926104848768, 'support': 8016486}, 'weighted avg': {'precision': 0.3327408919956924, 'recall': 0.2504961650279187, 'f1-score': 0.18467656380336228, 'support': 8016486}}
[[  15750 2416167  660395]
 [  10711 1321464  491162]
 [  16480 2413472  670885]]
Evaluating performance on  train set...
5759/5759 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1843616
{'0': {'precision': 0.3373756630945409, 'recall': 0.15621363143352518, 'f1-score': 0.21354870566908146, 'support': 505244}, '1': {'precision': 0.26556078640048725, 'recall': 0.25600902174673396, 'f1-score': 0.26069744098949843, 'support': 471749}, '2': {'precision': 0.3205423642497931, 'recall': 0.5063970923952943, 'f1-score': 0.39258429366558845, 'support': 497179}, 'accuracy': 0.3062519163299805, 'macro avg': {'precision': 0.3078262712482738, 'recall': 0.3062065818585178, 'f1-score': 0.2889434801080561, 'support': 1474172}, 'weighted avg': {'precision': 0.3087170269571865, 'recall': 0.3062519163299805, 'f1-score': 0.28901825965815925, 'support': 1474172}}
[[ 78926 168924 257394]
 [ 74691 120772 276286]
 [ 80324 165085 251770]]
Evaluating performance on  val set...
2129/2129 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1805
{'0': {'precision': 0.30657027212789245, 'recall': 0.12846962940837617, 'f1-score': 0.1810637098289795, 'support': 187484}, '1': {'precision': 0.25391511056350596, 'recall': 0.3577514553339754, 'f1-score': 0.29701966855780887, 'support': 163021}, '2': {'precision': 0.3505008724602534, 'recall': 0.4266670095404634, 'f1-score': 0.38485161972713056, 'support': 194435}, 'accuracy': 0.3034572613498734, 'macro avg': {'precision': 0.30366208505055065, 'recall': 0.30429603142760503, 'f1-score': 0.28764499937130633, 'support': 544940}, 'weighted avg': {'precision': 0.3064927391558859, 'recall': 0.3034572613498734, 'f1-score': 0.28846408162950704, 'support': 544940}}
[[24086 84607 78791]
 [29763 58321 74937]
 [24717 86759 82959]]
training model: results/universal/W5/deepOF_L1/h300
Epoch 1/50
9913/9913 - 144s - loss: 3.2471 - accuracy300: 0.3891 - val_loss: 3.2876 - val_accuracy300: 0.3666 - 144s/epoch - 15ms/step
Epoch 2/50
9913/9913 - 141s - loss: 3.2459 - accuracy300: 0.3900 - val_loss: 3.2966 - val_accuracy300: 0.3556 - 141s/epoch - 14ms/step
Epoch 3/50
9913/9913 - 140s - loss: 3.2449 - accuracy300: 0.3905 - val_loss: 3.3050 - val_accuracy300: 0.3448 - 140s/epoch - 14ms/step
Epoch 4/50
9913/9913 - 137s - loss: 3.2438 - accuracy300: 0.3911 - val_loss: 3.3081 - val_accuracy300: 0.3446 - 137s/epoch - 14ms/step
Epoch 5/50
9913/9913 - 141s - loss: 3.2423 - accuracy300: 0.3920 - val_loss: 3.3106 - val_accuracy300: 0.3433 - 141s/epoch - 14ms/step
Epoch 6/50
9913/9913 - 141s - loss: 3.2409 - accuracy300: 0.3927 - val_loss: 3.3046 - val_accuracy300: 0.3480 - 141s/epoch - 14ms/step
Epoch 7/50
9913/9913 - 142s - loss: 3.2398 - accuracy300: 0.3935 - val_loss: 3.3062 - val_accuracy300: 0.3467 - 142s/epoch - 14ms/step
Epoch 8/50
9913/9913 - 141s - loss: 3.2383 - accuracy300: 0.3945 - val_loss: 3.3045 - val_accuracy300: 0.3498 - 141s/epoch - 14ms/step
Epoch 9/50
9913/9913 - 140s - loss: 3.2371 - accuracy300: 0.3952 - val_loss: 3.3028 - val_accuracy300: 0.3462 - 140s/epoch - 14ms/step
Epoch 10/50
9913/9913 - 141s - loss: 3.2363 - accuracy300: 0.3955 - val_loss: 3.3083 - val_accuracy300: 0.3436 - 141s/epoch - 14ms/step
Epoch 11/50
9913/9913 - 140s - loss: 3.2352 - accuracy300: 0.3964 - val_loss: 3.3049 - val_accuracy300: 0.3463 - 140s/epoch - 14ms/step
testing model in sample: results/universal/W5/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 338s - 338s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984583
{'0': {'precision': 0.4118282121248072, 'recall': 0.4221992439005234, 'f1-score': 0.41694924674210526, 'support': 4850949}, '1': {'precision': 0.24820630320381976, 'recall': 0.11912136262256838, 'f1-score': 0.1609825548131929, 'support': 3024638}, '2': {'precision': 0.4120901608991455, 'recall': 0.5325645167757823, 'f1-score': 0.4646451292603018, 'support': 4962779}, 'accuracy': 0.3934586379606252, 'macro avg': {'precision': 0.35737489207592416, 'recall': 0.3579617077662913, 'f1-score': 0.34752564360519994, 'support': 12838366}, 'weighted avg': {'precision': 0.3733811816009387, 'recall': 0.3934586379606252, 'f1-score': 0.37508235659465905, 'support': 12838366}}
[[2048067  553872 2249010]
 [1142704  360299 1521635]
 [1782339  537440 2643000]]
Evaluating performance on  train set...
9913/9913 - 67s - 67s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943105
{'0': {'precision': 0.37106172961418865, 'recall': 0.42574227043818064, 'f1-score': 0.39652577855603155, 'support': 847299}, '1': {'precision': 0.3405678684506179, 'recall': 0.11957813250837351, 'f1-score': 0.17700673098020342, 'support': 836566}, '2': {'precision': 0.3669887667497681, 'recall': 0.5467819086901534, 'f1-score': 0.43919732542232776, 'support': 853161}, 'accuracy': 0.3654905389223445, 'macro avg': {'precision': 0.35953945493819156, 'recall': 0.36403410387890256, 'f1-score': 0.33757661165285424, 'support': 2537026}, 'weighted avg': {'precision': 0.3596369272950419, 'recall': 0.3654905389223445, 'f1-score': 0.3384907123177178, 'support': 2537026}}
[[360731 100879 385689]
 [317576 100035 418955]
 [293852  92816 466493]]
Evaluating performance on  val set...
3496/3496 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096082
{'0': {'precision': 0.3750724368929788, 'recall': 0.4233910401287364, 'f1-score': 0.3977697509022553, 'support': 305741}, '1': {'precision': 0.32617483577564427, 'recall': 0.10978785827926738, 'f1-score': 0.16428027963277655, 'support': 282217}, '2': {'precision': 0.36839045402193804, 'recall': 0.5462206824942287, 'f1-score': 0.44001757071687475, 'support': 306259}, 'accuracy': 0.36648486888529297, 'macro avg': {'precision': 0.3565459088968537, 'recall': 0.3597998603007442, 'f1-score': 0.33402253375063556, 'support': 894217}, 'weighted avg': {'precision': 0.35735173633972067, 'recall': 0.36648486888529297, 'f1-score': 0.3385493121668556, 'support': 894217}}
[[129448  33070 143223]
 [107644  30984 143589]
 [108036  30938 167285]]
testing model out of sample: results/universal/W5/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 140s - 140s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989947
{'0': {'precision': 0.3867080048814275, 'recall': 0.3998003356417667, 'f1-score': 0.3931452018528043, 'support': 1906199}, '1': {'precision': 0.28118826401649455, 'recall': 0.1300870386568708, 'f1-score': 0.17788059887477903, 'support': 1503355}, '2': {'precision': 0.38640049027392265, 'recall': 0.5345071457485181, 'f1-score': 0.44854405608839926, 'support': 1939265}, 'accuracy': 0.37283314316674393, 'macro avg': {'precision': 0.35143225305728154, 'recall': 0.3547981733490519, 'f1-score': 0.33985661893866087, 'support': 5348819}, 'weighted avg': {'precision': 0.35693881988127624, 'recall': 0.37283314316674393, 'f1-score': 0.35272767077709616, 'support': 5348819}}
[[ 762099  254343  889757]
 [ 551514  195567  756274]
 [ 657122  245592 1036551]]
Evaluating performance on  train set...
4957/4957 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954893
{'0': {'precision': 0.3733892800860894, 'recall': 0.41083847356252984, 'f1-score': 0.39121972197865984, 'support': 427348}, '1': {'precision': 0.33297452225169083, 'recall': 0.12271766977669012, 'f1-score': 0.17933973054859464, 'support': 418432}, '2': {'precision': 0.36295615280206484, 'recall': 0.5530906853464597, 'f1-score': 0.4382912727688709, 'support': 422560}, 'accuracy': 0.3631786429506284, 'macro avg': {'precision': 0.35643998504661506, 'recall': 0.3622156095618932, 'f1-score': 0.3362835750987085, 'support': 1268340}, 'weighted avg': {'precision': 0.35658034067291905, 'recall': 0.3631786429506284, 'f1-score': 0.33700175670739707, 'support': 1268340}}
[[175571  53639 198138]
 [155017  51349 212066]
 [139621  49225 233714]]
Evaluating performance on  val set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951754
{'0': {'precision': 0.37484854635250414, 'recall': 0.4138200286531006, 'f1-score': 0.3933714138186982, 'support': 147279}, '1': {'precision': 0.3367903824117773, 'recall': 0.12184342547181742, 'f1-score': 0.17894753135786926, 'support': 142322}, '2': {'precision': 0.3631748042897869, 'recall': 0.5517189229320336, 'f1-score': 0.4380189871172491, 'support': 145469}, 'accuracy': 0.364414921736732, 'macro avg': {'precision': 0.3582712443513561, 'recall': 0.36246079235231726, 'f1-score': 0.33677931076460554, 'support': 435070}, 'weighted avg': {'precision': 0.35849558799524306, 'recall': 0.364414921736732, 'f1-score': 0.3381563956390416, 'support': 435070}}
[[60947 17711 68621]
 [52870 17341 72111]
 [48774 16437 80258]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022719
{'0': {'precision': 0.34045847412089364, 'recall': 0.4200507899408949, 'f1-score': 0.3760897013476329, 'support': 88994}, '1': {'precision': 0.2857330100268694, 'recall': 0.10542860597267562, 'f1-score': 0.1540255060585721, 'support': 82710}, '2': {'precision': 0.3635475350768714, 'recall': 0.47809980825410847, 'f1-score': 0.41302811251945926, 'support': 99611}, 'accuracy': 0.3454508597018226, 'macro avg': {'precision': 0.3299130064082115, 'recall': 0.33452640138922635, 'f1-score': 0.31438110664188806, 'support': 271315}, 'weighted avg': {'precision': 0.3322524453929175, 'recall': 0.3454508597018226, 'f1-score': 0.32195536481216147, 'support': 271315}}
[[37382 10064 41548]
 [32164  8720 41826]
 [40253 11734 47624]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976578
{'0': {'precision': 0.37229639759599814, 'recall': 0.429253112033195, 'f1-score': 0.3987511322681982, 'support': 24100}, '1': {'precision': 0.31276075384836716, 'recall': 0.09523392325214648, 'f1-score': 0.1460089324691897, 'support': 22828}, '2': {'precision': 0.3460635556827942, 'recall': 0.5315743183817062, 'f1-score': 0.419212762268077, 'support': 22740}, 'accuracy': 0.35320376643509216, 'macro avg': {'precision': 0.3437069023757198, 'recall': 0.35202045122234926, 'f1-score': 0.3213242756684883, 'support': 69668}, 'weighted avg': {'precision': 0.34422591329076224, 'recall': 0.35320376643509216, 'f1-score': 0.3226142908084962, 'support': 69668}}
[[10345  2474 11281]
 [ 9093  2174 11561]
 [ 8349  2303 12088]]
Evaluating performance on  val set...
96/96 - 1s - 697ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971102
{'0': {'precision': 0.40293999194522756, 'recall': 0.4304614391739271, 'f1-score': 0.4162462946591087, 'support': 9297}, '1': {'precision': 0.27598439162823696, 'recall': 0.11573936328473669, 'f1-score': 0.16308563043706115, 'support': 6722}, '2': {'precision': 0.37846808510638297, 'recall': 0.5242867248290497, 'f1-score': 0.43960063266113086, 'support': 8482}, 'accuracy': 0.37659687359699606, 'macro avg': {'precision': 0.3524641562266158, 'recall': 0.35682917576257117, 'f1-score': 0.3396441859191002, 'support': 24501}, 'weighted avg': {'precision': 0.35963701414277494, 'recall': 0.37659687359699606, 'f1-score': 0.3548751469521803, 'support': 24501}}
[[4002 1110 4185]
 [2826  778 3118]
 [3104  931 4447]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092022
{'0': {'precision': 0.4540235095035204, 'recall': 0.4722360663981645, 'f1-score': 0.46295073596732167, 'support': 222717}, '1': {'precision': 0.21617189083605137, 'recall': 0.100831163026568, 'f1-score': 0.13751831662856806, 'support': 116343}, '2': {'precision': 0.44434157997387325, 'recall': 0.5516055618898796, 'f1-score': 0.49219737994098384, 'support': 220141}, 'accuracy': 0.42620989590505026, 'macro avg': {'precision': 0.37151232677114837, 'recall': 0.37489093043820404, 'f1-score': 0.3642221441789579, 'support': 559201}, 'weighted avg': {'precision': 0.4007264651148026, 'recall': 0.42620989590505026, 'f1-score': 0.40675734841593564, 'support': 559201}}
[[105175  23360  94182]
 [ 46942  11731  57670]
 [ 79534  19176 121431]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0862894
{'0': {'precision': 0.3922349113080289, 'recall': 0.5082587960783511, 'f1-score': 0.4427723195977391, 'support': 48857}, '1': {'precision': 0.34475820938420637, 'recall': 0.0977070011811184, 'f1-score': 0.1522618726496676, 'support': 49106}, '2': {'precision': 0.4062942393553305, 'recall': 0.5660856866501034, 'f1-score': 0.47306067786133715, 'support': 52727}, 'accuracy': 0.3947043599442564, 'macro avg': {'precision': 0.381095786682522, 'recall': 0.3906838279698577, 'f1-score': 0.3560316233695813, 'support': 150690}, 'weighted avg': {'precision': 0.381682885727558, 'recall': 0.3947043599442564, 'f1-score': 0.35870043863903406, 'support': 150690}}
[[24832  4900 19125]
 [19817  4798 24491]
 [18660  4219 29848]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0901089
{'0': {'precision': 0.4095374381188119, 'recall': 0.5253783180352269, 'f1-score': 0.46028123709547714, 'support': 20155}, '1': {'precision': 0.28488246711235715, 'recall': 0.08728690366063169, 'f1-score': 0.13363006423549642, 'support': 15134}, '2': {'precision': 0.43330147199388264, 'recall': 0.5305960016854722, 'f1-score': 0.4770383465925832, 'support': 21359}, 'accuracy': 0.4103057477757379, 'macro avg': {'precision': 0.3759071257416839, 'recall': 0.38108707446044354, 'f1-score': 0.35698321597451893, 'support': 56648}, 'weighted avg': {'precision': 0.3851949665103871, 'recall': 0.4103057477757379, 'f1-score': 0.3793317993692686, 'support': 56648}}
[[10589  1772  7794]
 [ 6785  1321  7028]
 [ 8482  1544 11333]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
2341/2341 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014452
{'0': {'precision': 0.41848379914709477, 'recall': 0.3775418171678046, 'f1-score': 0.3969599237690349, 'support': 229511}, '1': {'precision': 0.20504731861198738, 'recall': 0.14617929371119404, 'f1-score': 0.1706799608025954, 'support': 122726}, '2': {'precision': 0.4398629602039845, 'recall': 0.5425779526475363, 'f1-score': 0.4858509886365696, 'support': 247041}, 'accuracy': 0.39819416030623517, 'macro avg': {'precision': 0.35446469265435554, 'recall': 0.3554330211755117, 'f1-score': 0.35116362440273335, 'support': 599278}, 'weighted avg': {'precision': 0.38358734677691514, 'recall': 0.39819416030623517, 'f1-score': 0.3872637607544096, 'support': 599278}}
[[ 86650  34673 108188]
 [ 42284  17940  62502]
 [ 78123  34879 134039]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003377
{'0': {'precision': 0.35542325291181365, 'recall': 0.3302891933028919, 'f1-score': 0.34239559201051906, 'support': 41391}, '1': {'precision': 0.3190464272306345, 'recall': 0.12429915655014383, 'f1-score': 0.17889972633499404, 'support': 41022}, '2': {'precision': 0.34746400950091244, 'recall': 0.5840210326444168, 'f1-score': 0.4357048808172531, 'support': 41079}, 'accuracy': 0.34626534512357077, 'macro avg': {'precision': 0.3406445632144535, 'recall': 0.34620312749915083, 'f1-score': 0.31900006638758877, 'support': 123492}, 'weighted avg': {'precision': 0.3406918702864635, 'recall': 0.34626534512357077, 'f1-score': 0.31912384058654375, 'support': 123492}}
[[13671  5671 22049]
 [12917  5099 23006]
 [11876  5212 23991]]
Evaluating performance on  val set...
162/162 - 1s - 950ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1019198
{'0': {'precision': 0.389375162492417, 'recall': 0.2972150558973341, 'f1-score': 0.33710984393757504, 'support': 15117}, '1': {'precision': 0.2948378557246856, 'recall': 0.1523988711194732, 'f1-score': 0.20093589671308565, 'support': 11693}, '2': {'precision': 0.3718197135636057, 'recall': 0.6082133259836009, 'f1-score': 0.46150628708859437, 'support': 14513}, 'accuracy': 0.3654623333252668, 'macro avg': {'precision': 0.3520109105935694, 'recall': 0.35260908433346944, 'f1-score': 0.3331840092464184, 'support': 41323}, 'weighted avg': {'precision': 0.356458700513884, 'recall': 0.3654623333252668, 'f1-score': 0.3422663818112722, 'support': 41323}}
[[4493 2278 8346]
 [3344 1782 6567]
 [3702 1984 8827]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987705
{'0': {'precision': 0.3401365344246679, 'recall': 0.36076186199670707, 'f1-score': 0.35014572759381496, 'support': 160344}, '1': {'precision': 0.38520961151910876, 'recall': 0.1446193759679599, 'f1-score': 0.2102896404327573, 'support': 202746}, '2': {'precision': 0.30097033972892095, 'recall': 0.5268323683095608, 'f1-score': 0.38308866431722177, 'support': 155782}, 'accuracy': 0.3261652199386361, 'macro avg': {'precision': 0.34210549522423256, 'recall': 0.34407120209140923, 'f1-score': 0.31450801078126467, 'support': 518872}, 'weighted avg': {'precision': 0.3459896117664722, 'recall': 0.3261652199386361, 'f1-score': 0.30538835837961564, 'support': 518872}}
[[ 57846  24321  78177]
 [ 60985  29321 112440]
 [ 51236  22475  82071]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969014
{'0': {'precision': 0.3612068965517241, 'recall': 0.36378106573092645, 'f1-score': 0.3624894111709894, 'support': 27643}, '1': {'precision': 0.333790502314418, 'recall': 0.1392903133495493, 'f1-score': 0.19655746807329263, 'support': 27956}, '2': {'precision': 0.36336363030289565, 'recall': 0.5656611084203972, 'f1-score': 0.44248697652391583, 'support': 28906}, 'accuracy': 0.358570498787054, 'macro avg': {'precision': 0.3527870097230126, 'recall': 0.35624416250029095, 'f1-score': 0.3338446185893993, 'support': 84505}, 'weighted avg': {'precision': 0.35287472482831406, 'recall': 0.358570498787054, 'f1-score': 0.33495987117752724, 'support': 84505}}
[[10056  3941 13646]
 [ 9060  3894 15002]
 [ 8724  3831 16351]]
Evaluating performance on  val set...
136/136 - 1s - 904ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998029
{'0': {'precision': 0.3714605663093905, 'recall': 0.3905146316851665, 'f1-score': 0.3807493645978519, 'support': 11892}, '1': {'precision': 0.3123098762928412, 'recall': 0.138788752703677, 'f1-score': 0.19217570350034313, 'support': 11096}, '2': {'precision': 0.3534043538675313, 'recall': 0.5209524622343603, 'f1-score': 0.421125254406844, 'support': 11717}, 'accuracy': 0.3540700187292897, 'macro avg': {'precision': 0.34572493215658767, 'recall': 0.35008528220773466, 'f1-score': 0.33135010750167965, 'support': 34705}, 'weighted avg': {'precision': 0.34645262227813, 'recall': 0.3540700187292897, 'f1-score': 0.33408954489907655, 'support': 34705}}
[[4644 1777 5471]
 [3859 1540 5697]
 [3999 1614 6104]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104367
{'0': {'precision': 0.3755433771068142, 'recall': 0.33795744870916833, 'f1-score': 0.35576043366592286, 'support': 268664}, '1': {'precision': 0.282628536659568, 'recall': 0.17272185540962506, 'f1-score': 0.21441125820368215, 'support': 209765}, '2': {'precision': 0.36682197188393734, 'recall': 0.5175694518118853, 'f1-score': 0.4293480054501823, 'support': 263924}, 'accuracy': 0.35512350593316117, 'macro avg': {'precision': 0.34166462855010654, 'recall': 0.3427495853102262, 'f1-score': 0.3331732324399291, 'support': 742353}, 'weighted avg': {'precision': 0.34618797656494377, 'recall': 0.35512350593316117, 'f1-score': 0.3419818357546218, 'support': 742353}}
[[ 90797  46867 131000]
 [ 68748  36231 104786]
 [ 82230  45095 136599]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981619
{'0': {'precision': 0.3634917977904252, 'recall': 0.36528950644282204, 'f1-score': 0.36438843488329165, 'support': 59446}, '1': {'precision': 0.3364554787516872, 'recall': 0.13777740557742232, 'f1-score': 0.1954987285215201, 'support': 59705}, '2': {'precision': 0.348281288471626, 'recall': 0.5566029665873979, 'f1-score': 0.4284623083811831, 'support': 58451}, 'accuracy': 0.35176968727829644, 'macro avg': {'precision': 0.3494095216712461, 'recall': 0.35322329286921406, 'f1-score': 0.32944982392866495, 'support': 177602}, 'weighted avg': {'precision': 0.3493969514013024, 'recall': 0.35176968727829644, 'f1-score': 0.3286997718135947, 'support': 177602}}
[[21715  8484 29247]
 [19847  8226 31632]
 [18178  7739 32534]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097549
{'0': {'precision': 0.3420310633213859, 'recall': 0.36683751922091234, 'f1-score': 0.35400024731049834, 'support': 19510}, '1': {'precision': 0.3730540293040293, 'recall': 0.14867700729927008, 'f1-score': 0.21261743215031315, 'support': 21920}, '2': {'precision': 0.3401589437928603, 'recall': 0.5461233729485003, 'f1-score': 0.419208972612207, 'support': 19437}, 'accuracy': 0.3455238470764125, 'macro avg': {'precision': 0.3517480121394252, 'recall': 0.3538792998228943, 'f1-score': 0.3286088840243395, 'support': 60867}, 'weighted avg': {'precision': 0.35260551297495174, 'recall': 0.3455238470764125, 'f1-score': 0.3239075975228967, 'support': 60867}}
[[ 7157  2792  9561]
 [ 7631  3259 11030]
 [ 6137  2685 10615]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/EXC
Evaluating performance on  test set...
7167/7167 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950016
{'0': {'precision': 0.37772644013307916, 'recall': 0.40819710011909127, 'f1-score': 0.3923710885442068, 'support': 618853}, '1': {'precision': 0.3086648880640297, 'recall': 0.1430119758869949, 'f1-score': 0.19546175176137165, 'support': 558205}, '2': {'precision': 0.39266679233344465, 'recall': 0.5417607086149522, 'f1-score': 0.45531930395502174, 'support': 657508}, 'accuracy': 0.37537815483335024, 'macro avg': {'precision': 0.35968604017685113, 'recall': 0.36432326154034617, 'f1-score': 0.3477173814202001, 'support': 1834566}, 'weighted avg': {'precision': 0.36206763986198187, 'recall': 0.37537815483335024, 'f1-score': 0.3550179373790111, 'support': 1834566}}
[[252614  91039 275200]
 [202626  79830 275749]
 [213535  87761 356212]]
Evaluating performance on  train set...
1570/1570 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924989
{'0': {'precision': 0.3860635647835872, 'recall': 0.4234925239738321, 'f1-score': 0.4039128004471772, 'support': 136503}, '1': {'precision': 0.3346446560535314, 'recall': 0.13593595985543178, 'f1-score': 0.19333666110857398, 'support': 133916}, '2': {'precision': 0.366250936405418, 'recall': 0.5511730652041438, 'f1-score': 0.4400749291457347, 'support': 131280}, 'accuracy': 0.3693561597116249, 'macro avg': {'precision': 0.36231971908084554, 'recall': 0.3702005163444692, 'f1-score': 0.34577479690049534, 'support': 401699}, 'weighted avg': {'precision': 0.36244683575269543, 'recall': 0.3693561597116249, 'f1-score': 0.34553040462313545, 'support': 401699}}
[[57808 19182 59513]
 [50019 18204 65693]
 [41910 17012 72358]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940659
{'0': {'precision': 0.39658379117942577, 'recall': 0.4201907177965526, 'f1-score': 0.408046103424763, 'support': 44149}, '1': {'precision': 0.3244517319122771, 'recall': 0.1170540533878879, 'f1-score': 0.17204028401680918, 'support': 40571}, '2': {'precision': 0.3600317085302164, 'recall': 0.5645381428223252, 'f1-score': 0.4396674449063266, 'support': 41030}, 'accuracy': 0.36948707753479126, 'macro avg': {'precision': 0.3603557438739731, 'recall': 0.36726097133558855, 'f1-score': 0.33991794411596626, 'support': 125750}, 'weighted avg': {'precision': 0.3613853678981172, 'recall': 0.36948707753479126, 'f1-score': 0.3422205093236772, 'support': 125750}}
[[18551  5365 20233]
 [14882  4749 20940]
 [13344  4523 23163]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/AAL
Evaluating performance on  test set...
6357/6357 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958873
{'0': {'precision': 0.38304995333360387, 'recall': 0.4651366604896231, 'f1-score': 0.4201211695411914, 'support': 568233}, '1': {'precision': 0.3095980956342878, 'recall': 0.10814978373676233, 'f1-score': 0.1603022719759714, 'support': 495461}, '2': {'precision': 0.3793941503813717, 'recall': 0.5144710454860063, 'f1-score': 0.43672649097513166, 'support': 563470}, 'accuracy': 0.3735204318679617, 'macro avg': {'precision': 0.3573473997830878, 'recall': 0.36258582990413063, 'f1-score': 0.33904997749743143, 'support': 1627164}, 'weighted avg': {'precision': 0.35941836723837617, 'recall': 0.3735204318679617, 'f1-score': 0.34675823234605974, 'support': 1627164}}
[[264306  61249 242678]
 [210360  53584 231517]
 [215338  58243 289889]]
Evaluating performance on  train set...
1701/1701 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940211
{'0': {'precision': 0.37815593062093267, 'recall': 0.4613345446656181, 'f1-score': 0.41562447508665845, 'support': 147496}, '1': {'precision': 0.3287671232876712, 'recall': 0.11522541041308816, 'f1-score': 0.17064398085884966, 'support': 142052}, '2': {'precision': 0.37300248428483224, 'recall': 0.5259751833824639, 'f1-score': 0.4364736903485293, 'support': 145870}, 'accuracy': 0.3700742734567703, 'macro avg': {'precision': 0.35997517939781204, 'recall': 0.36751171282039, 'f1-score': 0.3409140487646791, 'support': 435418}, 'weighted avg': {'precision': 0.3603167230632492, 'recall': 0.3700742734567703, 'f1-score': 0.34268607075840474, 'support': 435418}}
[[68045 17277 62174]
 [58889 16368 66795]
 [53005 16141 76724]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943849
{'0': {'precision': 0.37897864884827454, 'recall': 0.45123223233459453, 'f1-score': 0.41196131152438575, 'support': 48895}, '1': {'precision': 0.3298719500541505, 'recall': 0.10915530071463204, 'f1-score': 0.16403205879557767, 'support': 47437}, '2': {'precision': 0.36257359964643654, 'recall': 0.5328863279203772, 'f1-score': 0.4315335799368785, 'support': 47725}, 'accuracy': 0.3656399897262889, 'macro avg': {'precision': 0.35714139951628715, 'recall': 0.3644246203232013, 'f1-score': 0.33584231675228066, 'support': 144057}, 'weighted avg': {'precision': 0.35737327428227234, 'recall': 0.3656399897262889, 'f1-score': 0.33680402342515936, 'support': 144057}}
[[22063  5482 21350]
 [18898  5178 23361]
 [17256  5037 25432]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/WBA
Evaluating performance on  test set...
7458/7458 - 51s - 51s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001755
{'0': {'precision': 0.37441257470104383, 'recall': 0.36719213467403194, 'f1-score': 0.3707672047258908, 'support': 670894}, '1': {'precision': 0.29991582239807885, 'recall': 0.1254786634964335, 'f1-score': 0.17693241357753162, 'support': 559370}, '2': {'precision': 0.3743021702394961, 'recall': 0.5607851165421175, 'f1-score': 0.4489486470983226, 'support': 678982}, 'accuracy': 0.3652221871880313, 'macro avg': {'precision': 0.3495435224462063, 'recall': 0.35115197157086103, 'f1-score': 0.3322160884672483, 'support': 1909246}, 'weighted avg': {'precision': 0.3525472881021351, 'recall': 0.3652221871880313, 'f1-score': 0.34178111544261397, 'support': 1909246}}
[[246347  83857 340690]
 [193373  70189 295808]
 [218236  79983 380763]]
Evaluating performance on  train set...
1664/1664 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939807
{'0': {'precision': 0.3809615200076768, 'recall': 0.4106386793363582, 'f1-score': 0.3952438000484514, 'support': 145018}, '1': {'precision': 0.331578509301261, 'recall': 0.11493796884016157, 'f1-score': 0.17070348905719399, 'support': 138640}, '2': {'precision': 0.36696481758940014, 'recall': 0.5714215441698348, 'f1-score': 0.44691954458890165, 'support': 142303}, 'accuracy': 0.3681088174739002, 'macro avg': {'precision': 0.3598349489661126, 'recall': 0.3656660641154515, 'f1-score': 0.33762227789818233, 'support': 425961}, 'weighted avg': {'precision': 0.3602125938182709, 'recall': 0.3681088174739002, 'f1-score': 0.3394249451756151, 'support': 425961}}
[[59550 17090 68378]
 [50810 15935 71895]
 [45955 15033 81315]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967319
{'0': {'precision': 0.37614962675794944, 'recall': 0.40111267481748614, 'f1-score': 0.38823028626157285, 'support': 45476}, '1': {'precision': 0.3135196481770464, 'recall': 0.10757922406659202, 'f1-score': 0.16019135981443897, 'support': 41086}, '2': {'precision': 0.3702484802322406, 'recall': 0.5648170477714687, 'f1-score': 0.4472898364526546, 'support': 45613}, 'accuracy': 0.3663627766219028, 'macro avg': {'precision': 0.3533059183890788, 'recall': 0.3578363155518489, 'f1-score': 0.33190382750955544, 'support': 132175}, 'weighted avg': {'precision': 0.3546449224155841, 'recall': 0.3663627766219028, 'f1-score': 0.33772660501216006, 'support': 132175}}
[[18241  5049 22186]
 [15032  4420 21634]
 [15221  4629 25763]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
8238/8238 - 57s - 57s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983475
{'0': {'precision': 0.3918541386900724, 'recall': 0.3769967114945851, 'f1-score': 0.38428187114892337, 'support': 750797}, '1': {'precision': 0.2851001465559355, 'recall': 0.13292885186766168, 'f1-score': 0.18131773294148243, 'support': 592693}, '2': {'precision': 0.3858638564224159, 'recall': 0.5597378005512148, 'f1-score': 0.45681516040768894, 'support': 765219}, 'accuracy': 0.37471078275855035, 'macro avg': {'precision': 0.3542727138894746, 'recall': 0.35655445463782054, 'f1-score': 0.3408049214993649, 'support': 2108709}, 'weighted avg': {'precision': 0.35967510323921986, 'recall': 0.37471078275855035, 'f1-score': 0.3535561650921467, 'support': 2108709}}
[[283048 101825 365924]
 [198119  78786 315788]
 [241163  95734 428322]]
Evaluating performance on  train set...
1806/1806 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943241
{'0': {'precision': 0.37483942118913155, 'recall': 0.39930929864764547, 'f1-score': 0.3866876287338682, 'support': 154915}, '1': {'precision': 0.3414538380539344, 'recall': 0.12518894159986912, 'f1-score': 0.18320756885126593, 'support': 152825}, '2': {'precision': 0.36690017876325687, 'recall': 0.5728532573500842, 'f1-score': 0.4473087396118032, 'support': 154420}, 'accuracy': 0.3666500778951013, 'macro avg': {'precision': 0.36106447933544095, 'recall': 0.36578383253253294, 'f1-score': 0.33906797906564573, 'support': 462160}, 'weighted avg': {'precision': 0.3611469130576617, 'recall': 0.3666500778951013, 'f1-score': 0.3396568856799735, 'support': 462160}}
[[61859 19471 73585]
 [54637 19132 79056]
 [48532 17428 88460]]
Evaluating performance on  val set...
642/642 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930125
{'0': {'precision': 0.3784763816492375, 'recall': 0.42930591259640105, 'f1-score': 0.402291928351429, 'support': 54460}, '1': {'precision': 0.35285359801488836, 'recall': 0.11730522456461961, 'f1-score': 0.176074843502786, 'support': 54550}, '2': {'precision': 0.36821342684183717, 'recall': 0.5619395429563205, 'f1-score': 0.44490248702809093, 'support': 55312}, 'accuracy': 0.37037645598276553, 'macro avg': {'precision': 0.366514468835321, 'recall': 0.3695168933724471, 'f1-score': 0.34108975296076866, 'support': 164322}, 'weighted avg': {'precision': 0.36651579570480725, 'recall': 0.37037645598276553, 'f1-score': 0.34153763643087093, 'support': 164322}}
[[23380  5897 25183]
 [20003  6399 28148]
 [18391  5839 31082]]
testing model on single stock: results/universal/W5/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
31315/31315 - 209s - 209s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992794
{'0': {'precision': 0.4270581932888372, 'recall': 0.43595170887635254, 'f1-score': 0.4314591262205006, 'support': 3178141}, '1': {'precision': 0.20405524863211033, 'recall': 0.10655212238991318, 'f1-score': 0.14000002482240603, 'support': 1587974}, '2': {'precision': 0.43174565896973793, 'recall': 0.5237425569920433, 'f1-score': 0.4733152573135868, 'support': 3250366}, 'accuracy': 0.40629710218236653, 'macro avg': {'precision': 0.35428636696356186, 'recall': 0.3554154627527697, 'f1-score': 0.3482581361188311, 'support': 8016481}, 'weighted avg': {'precision': 0.3847844201753034, 'recall': 0.40629710218236653, 'f1-score': 0.39069538840498935, 'support': 8016481}}
[[1385516  331672 1460953]
 [ 639122  169202  779650]
 [1219688  328323 1702355]]
Evaluating performance on  train set...
5759/5759 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955878
{'0': {'precision': 0.3627974483322035, 'recall': 0.4265897914886833, 'f1-score': 0.39211601107658556, 'support': 489278}, '1': {'precision': 0.3476477436556338, 'recall': 0.11835349975767433, 'f1-score': 0.1765889156995672, 'support': 486948}, '2': {'precision': 0.3633403539021449, 'recall': 0.5349165068431252, 'f1-score': 0.4327420393833126, 'support': 497945}, 'accuracy': 0.36136377665820313, 'macro avg': {'precision': 0.3579285152966607, 'recall': 0.35995326602982763, 'f1-score': 0.33381565538648844, 'support': 1474171}, 'weighted avg': {'precision': 0.3579765820427284, 'recall': 0.36136377665820313, 'f1-score': 0.3346457716169468, 'support': 1474171}}
[[208721  55396 225161]
 [187752  57632 241564]
 [178837  52749 266359]]
Evaluating performance on  val set...
2129/2129 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967369
{'0': {'precision': 0.36608629825889477, 'recall': 0.4203641025919628, 'f1-score': 0.39135217700269836, 'support': 184069}, '1': {'precision': 0.33613861386138616, 'recall': 0.10905753456089026, 'f1-score': 0.16468448178786438, 'support': 174330}, '2': {'precision': 0.36515545865085064, 'recall': 0.5422697544762517, 'f1-score': 0.4364277254890963, 'support': 186540}, 'accuracy': 0.3625047941145706, 'macro avg': {'precision': 0.3557934569237105, 'recall': 0.3572304638763682, 'f1-score': 0.330821461426553, 'support': 544939}, 'weighted avg': {'precision': 0.35618717442759945, 'recall': 0.3625047941145706, 'f1-score': 0.3342694824402807, 'support': 544939}}
[[ 77376  19235  87458]
 [ 66912  19012  88406]
 [ 67072  18313 101155]]
training model: results/universal/W5/deepOF_L1/h500
Epoch 1/50
9913/9913 - 142s - loss: 3.2633 - accuracy500: 0.3811 - val_loss: 3.2841 - val_accuracy500: 0.3699 - 142s/epoch - 14ms/step
Epoch 2/50
9913/9913 - 139s - loss: 3.2606 - accuracy500: 0.3830 - val_loss: 3.2876 - val_accuracy500: 0.3648 - 139s/epoch - 14ms/step
Epoch 3/50
9913/9913 - 138s - loss: 3.2596 - accuracy500: 0.3840 - val_loss: 3.2876 - val_accuracy500: 0.3646 - 138s/epoch - 14ms/step
Epoch 4/50
9913/9913 - 135s - loss: 3.2582 - accuracy500: 0.3848 - val_loss: 3.2857 - val_accuracy500: 0.3677 - 135s/epoch - 14ms/step
Epoch 5/50
9913/9913 - 136s - loss: 3.2592 - accuracy500: 0.3835 - val_loss: 3.2895 - val_accuracy500: 0.3650 - 136s/epoch - 14ms/step
Epoch 6/50
9913/9913 - 136s - loss: 3.2568 - accuracy500: 0.3850 - val_loss: 3.2914 - val_accuracy500: 0.3630 - 136s/epoch - 14ms/step
Epoch 7/50
9913/9913 - 138s - loss: 3.2556 - accuracy500: 0.3859 - val_loss: 3.2917 - val_accuracy500: 0.3629 - 138s/epoch - 14ms/step
Epoch 8/50
9913/9913 - 135s - loss: 3.2539 - accuracy500: 0.3871 - val_loss: 3.2923 - val_accuracy500: 0.3633 - 135s/epoch - 14ms/step
Epoch 9/50
9913/9913 - 135s - loss: 3.2525 - accuracy500: 0.3878 - val_loss: 3.2914 - val_accuracy500: 0.3620 - 135s/epoch - 14ms/step
Epoch 10/50
9913/9913 - 136s - loss: 3.2511 - accuracy500: 0.3889 - val_loss: 3.2903 - val_accuracy500: 0.3650 - 136s/epoch - 14ms/step
Epoch 11/50
9913/9913 - 137s - loss: 3.2498 - accuracy500: 0.3896 - val_loss: 3.2900 - val_accuracy500: 0.3647 - 137s/epoch - 14ms/step
testing model in sample: results/universal/W5/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 253s - 253s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0816255
{'0': {'precision': 0.397930831930887, 'recall': 0.3966475614791848, 'f1-score': 0.39728816044287096, 'support': 4809514}, '1': {'precision': 0.23793677204658903, 'recall': 4.556013316302977e-05, 'f1-score': 9.110282195769135e-05, 'support': 3138709}, '2': {'precision': 0.3954908655291971, 'recall': 0.6505400762308996, 'f1-score': 0.4919216966509107, 'support': 4890143}, 'accuracy': 0.3963946034877024, 'macro avg': {'precision': 0.3437861565022244, 'recall': 0.3490777326144158, 'f1-score': 0.29643365330524646, 'support': 12838366}, 'weighted avg': {'precision': 0.35788628262259936, 'recall': 0.3963946034877024, 'f1-score': 0.33622786235857527, 'support': 12838366}}
[[1907682     228 2901604]
 [1177643     143 1960923]
 [1708679     230 3181234]]
Evaluating performance on  train set...
9913/9913 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018898
{'0': {'precision': 0.3633720930232558, 'recall': 0.39746303930940247, 'f1-score': 0.3796538050245941, 'support': 852595}, '1': {'precision': 0.3283582089552239, 'recall': 5.292309912857306e-05, 'f1-score': 0.0001058291412566489, 'support': 831395}, '2': {'precision': 0.35466693427945256, 'recall': 0.6670234316019488, 'f1-score': 0.4630975557349723, 'support': 853036}, 'accuracy': 0.35786546925415824, 'macro avg': {'precision': 0.3487990787526441, 'recall': 0.3548464646701599, 'f1-score': 0.28095239663360766, 'support': 2537026}, 'weighted avg': {'precision': 0.34897090756480154, 'recall': 0.35786546925415824, 'f1-score': 0.283330879647184, 'support': 2537026}}
[[338875     48 513672]
 [309710     44 521641]
 [283999     42 568995]]
Evaluating performance on  val set...
3496/3496 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942788
{'0': {'precision': 0.3773172336390727, 'recall': 0.37036661844267094, 'f1-score': 0.37380961890231723, 'support': 315887}, '1': {'precision': 0.4358974358974359, 'recall': 6.448994146589431e-05, 'f1-score': 0.00012896080350166512, 'support': 263607}, '2': {'precision': 0.36578384208453885, 'recall': 0.6788763452305678, 'f1-score': 0.4754120064572618, 'support': 314723}, 'accuracy': 0.3697860810071828, 'macro avg': {'precision': 0.39299950387368243, 'recall': 0.34976915120490154, 'f1-score': 0.2831168620543602, 'support': 894217}, 'weighted avg': {'precision': 0.3905269218763829, 'recall': 0.3697860810071828, 'f1-score': 0.29941131399310655, 'support': 894217}}
[[116994      5 198888]
 [ 92026     17 171564]
 [101048     17 213658]]
testing model out of sample: results/universal/W5/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 106s - 106s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0890523
{'0': {'precision': 0.3839310852445038, 'recall': 0.39560650197093, 'f1-score': 0.389681360135636, 'support': 1930307}, '1': {'precision': 0.3186046511627907, 'recall': 9.418727041852836e-05, 'f1-score': 0.00018831886920704698, 'support': 1454549}, '2': {'precision': 0.3804215717121696, 'recall': 0.6507154157181169, 'f1-score': 0.4801421813055854, 'support': 1963963}, 'accuracy': 0.38172164733934727, 'macro avg': {'precision': 0.3609857693731547, 'recall': 0.3488053683198218, 'f1-score': 0.29000395343680946, 'support': 5348819}, 'weighted avg': {'precision': 0.36487771026721905, 'recall': 0.38172164733934727, 'f1-score': 0.31697839375116016, 'support': 5348819}}
[[ 763642     139 1166526]
 [ 539538     137  914874]
 [ 685828     154 1277981]]
Evaluating performance on  train set...
4957/4957 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033624
{'0': {'precision': 0.3621425232028412, 'recall': 0.40451116903067474, 'f1-score': 0.38215610751113366, 'support': 427029}, '1': {'precision': 0.4, 'recall': 7.623839746888521e-05, 'f1-score': 0.0001524477390094708, 'support': 419736}, '2': {'precision': 0.34806027264995176, 'recall': 0.6532882642471683, 'f1-score': 0.45415493805479007, 'support': 421575}, 'accuracy': 0.3533595092798461, 'macro avg': {'precision': 0.37006759861759764, 'recall': 0.35262522389177064, 'f1-score': 0.27882116443497773, 'support': 1268340}, 'weighted avg': {'precision': 0.3699901201438017, 'recall': 0.3533595092798461, 'f1-score': 0.27966956513947433, 'support': 1268340}}
[[172738     17 254274]
 [158117     32 261587]
 [146134     31 275410]]
Evaluating performance on  val set...
1701/1701 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971156
{'0': {'precision': 0.3740218994132965, 'recall': 0.39294873062647917, 'f1-score': 0.383251782648672, 'support': 151689}, '1': {'precision': 0.2222222222222222, 'recall': 5.995563283170454e-05, 'f1-score': 0.00011987892228848863, 'support': 133432}, '2': {'precision': 0.35918075663204785, 'recall': 0.6603245103335134, 'f1-score': 0.4652763745894205, 'support': 149949}, 'accuracy': 0.36460569563518513, 'macro avg': {'precision': 0.3184749594225222, 'recall': 0.35111106553094146, 'f1-score': 0.282882678720127, 'support': 435070}, 'weighted avg': {'precision': 0.32235125090647027, 'recall': 0.36460569563518513, 'f1-score': 0.29401889911017126, 'support': 435070}}
[[59606    14 92069]
 [48839     8 84585]
 [50920    14 99015]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049556
{'0': {'precision': 0.32221602297852997, 'recall': 0.36568949343339585, 'f1-score': 0.3425790647347665, 'support': 85280}, '1': {'precision': 0.2823529411764706, 'recall': 0.00026988732204304703, 'f1-score': 0.0005392591926840503, 'support': 88926}, '2': {'precision': 0.3529843388136021, 'recall': 0.6340915878033961, 'f1-score': 0.45350999620700194, 'support': 97109}, 'accuracy': 0.3419862521423438, 'macro avg': {'precision': 0.3191844343228675, 'recall': 0.333350322852945, 'f1-score': 0.26554277337815085, 'support': 271315}, 'weighted avg': {'precision': 0.3201631175737351, 'recall': 0.3419862521423438, 'f1-score': 0.27017672825024514, 'support': 271315}}
[[31186    22 54072]
 [30106    24 58796]
 [35494    39 61576]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081603
{'0': {'precision': 0.35973512211902303, 'recall': 0.35177865612648224, 'f1-score': 0.3557124027382117, 'support': 23782}, '1': {'precision': 0.35294117647058826, 'recall': 0.00025138260432378077, 'f1-score': 0.0005024073686414066, 'support': 23868}, '2': {'precision': 0.3255307684017674, 'recall': 0.6859387773639749, 'f1-score': 0.44152427170274655, 'support': 22018}, 'accuracy': 0.3369552735832807, 'macro avg': {'precision': 0.3460690223304596, 'recall': 0.34598960536492696, 'f1-score': 0.2659130272698666, 'support': 69668}, 'weighted avg': {'precision': 0.3465975359261744, 'recall': 0.3369552735832807, 'f1-score': 0.26113890502592235, 'support': 69668}}
[[ 8366     3 15413]
 [ 7983     6 15879]
 [ 6907     8 15103]]
Evaluating performance on  val set...
96/96 - 1s - 653ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963421
{'0': {'precision': 0.3898941618299761, 'recall': 0.38130217028380636, 'f1-score': 0.3855503038487509, 'support': 8985}, '1': {'precision': 0.46153846153846156, 'recall': 0.0008137800081378001, 'f1-score': 0.0016246953696181965, 'support': 7373}, '2': {'precision': 0.3493408063180689, 'recall': 0.6735846739530885, 'f1-score': 0.4600738131186043, 'support': 8143}, 'accuracy': 0.363944328802906, 'macro avg': {'precision': 0.40025780989550225, 'recall': 0.35190020808167755, 'f1-score': 0.2824162707789911, 'support': 24501}, 'weighted avg': {'precision': 0.3979757686140748, 'recall': 0.363944328802906, 'f1-score': 0.29478508710934315, 'support': 24501}}
[[3426    5 5554]
 [2705    6 4662]
 [2656    2 5485]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0793157
{'0': {'precision': 0.4220752536899254, 'recall': 0.40871213894480596, 'f1-score': 0.415286224275015, 'support': 213610}, '1': {'precision': 0.29, 'recall': 0.0002119356300334712, 'f1-score': 0.0004235617158631165, 'support': 136834}, '2': {'precision': 0.39669386295116593, 'recall': 0.6693763562419464, 'f1-score': 0.498161355124944, 'support': 208757}, 'accuracy': 0.4060632938782298, 'macro avg': {'precision': 0.36958970554703036, 'recall': 0.35943347693892863, 'f1-score': 0.304623713705274, 'support': 559201}, 'weighted avg': {'precision': 0.3802818229738529, 'recall': 0.4060632938782298, 'f1-score': 0.3447095373989537, 'support': 559201}}
[[ 87305     39 126266]
 [ 50554     29  86251]
 [ 68988     32 139737]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0946592
{'0': {'precision': 0.380832681637061, 'recall': 0.4172208396230264, 'f1-score': 0.39819718090491396, 'support': 49022}, '1': {'precision': 0.6086956521739131, 'recall': 0.00029451363177381354, 'f1-score': 0.0005887424041716605, 'support': 47536}, '2': {'precision': 0.3897649570445849, 'recall': 0.6981452745141506, 'f1-score': 0.5002481915111884, 'support': 54132}, 'accuracy': 0.38661490477138494, 'macro avg': {'precision': 0.4597644302851864, 'recall': 0.37188687592298364, 'f1-score': 0.2996780382734247, 'support': 150690}, 'weighted avg': {'precision': 0.4559220445662526, 'recall': 0.38661490477138494, 'f1-score': 0.3094289187346808, 'support': 150690}}
[[20453     4 28565]
 [16918    14 30604]
 [16335     5 37792]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0886335
{'0': {'precision': 0.3997956005450652, 'recall': 0.4101962350826384, 'f1-score': 0.4049291435613062, 'support': 20027}, '1': {'precision': 0.3333333333333333, 'recall': 0.00012514861397910017, 'f1-score': 0.00025020329017326574, 'support': 15981}, '2': {'precision': 0.3905358231284978, 'recall': 0.6829457364341085, 'f1-score': 0.4969154299009412, 'support': 20640}, 'accuracy': 0.3938885750600198, 'macro avg': {'precision': 0.37455491900229876, 'recall': 0.3644223733769087, 'f1-score': 0.30069825891747354, 'support': 56648}, 'weighted avg': {'precision': 0.3776720428168376, 'recall': 0.3938885750600198, 'f1-score': 0.3242806265011645, 'support': 56648}}
[[ 8215     2 11810]
 [ 5791     2 10188]
 [ 6542     2 14096]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
2341/2341 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0851467
{'0': {'precision': 0.38191685552018056, 'recall': 0.3859591375017965, 'f1-score': 0.3839273567437817, 'support': 215699}, '1': {'precision': 0.38333333333333336, 'recall': 0.00015030322040987036, 'f1-score': 0.0003004886206265841, 'support': 153024}, '2': {'precision': 0.3997130386427305, 'recall': 0.6609485805989894, 'f1-score': 0.4981603194555004, 'support': 230555}, 'accuracy': 0.3932381966299447, 'macro avg': {'precision': 0.3883210758320815, 'recall': 0.34901934044039856, 'f1-score': 0.29412938827330287, 'support': 599278}, 'weighted avg': {'precision': 0.3891251196324947, 'recall': 0.3932381966299447, 'f1-score': 0.32991713586185817, 'support': 599278}}
[[ 83251     26 132422]
 [ 56572     23  96429]
 [ 78159     11 152385]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025897
{'0': {'precision': 0.35394837111830824, 'recall': 0.3531913882420037, 'f1-score': 0.3535694745105502, 'support': 42082}, '1': {'precision': 0.3, 'recall': 7.582459244281562e-05, 'f1-score': 0.00015161086544535692, 'support': 39565}, '2': {'precision': 0.34653331697140755, 'recall': 0.6748476520492293, 'f1-score': 0.4579235415737625, 'support': 41845}, 'accuracy': 0.34905095066886926, 'macro avg': {'precision': 0.33349389602990526, 'recall': 0.34270495496122527, 'f1-score': 0.2705482089832527, 'support': 123492}, 'weighted avg': {'precision': 0.33415154019749616, 'recall': 0.34905095066886926, 'f1-score': 0.27569980004695377, 'support': 123492}}
[[14863     3 27216]
 [13527     3 26035]
 [13602     4 28239]]
Evaluating performance on  val set...
162/162 - 1s - 985ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927246
{'0': {'precision': 0.38096296296296295, 'recall': 0.3382439986846432, 'f1-score': 0.3583347848806828, 'support': 15205}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11633}, '2': {'precision': 0.36473421270172157, 'recall': 0.7005868139454609, 'f1-score': 0.47972014748983643, 'support': 14485}, 'accuracy': 0.3700360574014471, 'macro avg': {'precision': 0.2485657252215615, 'recall': 0.346276937543368, 'f1-score': 0.27935164412350644, 'support': 41323}, 'weighted avg': {'precision': 0.26802790026949375, 'recall': 0.3700360574014471, 'f1-score': 0.30000790698886975, 'support': 41323}}
[[ 5143     0 10062]
 [ 4020     0  7613]
 [ 4337     0 10148]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
2027/2027 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1215094
{'0': {'precision': 0.32436763883219183, 'recall': 0.4112692976178305, 'f1-score': 0.3626855705104544, 'support': 156496}, '1': {'precision': 0.3333333333333333, 'recall': 3.3714954508893525e-05, 'f1-score': 6.742308951859915e-05, 'support': 207623}, '2': {'precision': 0.29652839327399605, 'recall': 0.6139848662061479, 'f1-score': 0.39991497976560514, 'support': 154753}, 'accuracy': 0.30717595090889466, 'macro avg': {'precision': 0.31807645514650706, 'recall': 0.34176262625949577, 'f1-score': 0.25422265778852604, 'support': 518872}, 'weighted avg': {'precision': 0.3196521745588123, 'recall': 0.30717595090889466, 'f1-score': 0.22869008636115626, 'support': 518872}}
[[ 64362      4  92130]
 [ 74334      7 133282]
 [ 59727     10  95016]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022643
{'0': {'precision': 0.3475323638057839, 'recall': 0.38457006076229056, 'f1-score': 0.3651143276693938, 'support': 27155}, '1': {'precision': 0.3333333333333333, 'recall': 3.5951824555096173e-05, 'f1-score': 7.18958947444101e-05, 'support': 27815}, '2': {'precision': 0.36012708207077665, 'recall': 0.6639580159133232, 'f1-score': 0.46697147211506407, 'support': 29535}, 'accuracy': 0.35564759481687475, 'macro avg': {'precision': 0.34699759306996464, 'recall': 0.3495213428333896, 'f1-score': 0.2773858985597341, 'support': 84505}, 'weighted avg': {'precision': 0.34726065173389875, 'recall': 0.35564759481687475, 'f1-score': 0.2805595145978714, 'support': 84505}}
[[10443     2 16710]
 [ 9681     1 18133]
 [ 9925     0 19610]]
Evaluating performance on  val set...
136/136 - 1s - 834ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004207
{'0': {'precision': 0.36520795660036165, 'recall': 0.42275810097965333, 'f1-score': 0.39188140329090343, 'support': 11943}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10871}, '2': {'precision': 0.34562697576396206, 'recall': 0.606845513413506, 'f1-score': 0.4404162470627727, 'support': 11891}, 'accuracy': 0.35340729001584786, 'macro avg': {'precision': 0.23694497745477458, 'recall': 0.34320120479771976, 'f1-score': 0.27743255011789203, 'support': 34705}, 'weighted avg': {'precision': 0.2441011091913958, 'recall': 0.35340729001584786, 'f1-score': 0.2857579367044141, 'support': 34705}}
[[5049    1 6893]
 [4102    0 6769]
 [4674    1 7216]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
2900/2900 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963768
{'0': {'precision': 0.3640152645716966, 'recall': 0.38745362333639677, 'f1-score': 0.3753689220605774, 'support': 264411}, '1': {'precision': 0.30303030303030304, 'recall': 4.597532044798352e-05, 'f1-score': 9.193669239361776e-05, 'support': 217508}, '2': {'precision': 0.35656694526171445, 'recall': 0.6310082400915396, 'f1-score': 0.4556547874862405, 'support': 260434}, 'accuracy': 0.35938832334482385, 'macro avg': {'precision': 0.3412041709545714, 'recall': 0.3395026129161281, 'f1-score': 0.2770385487464038, 'support': 742353}, 'weighted avg': {'precision': 0.343533751590512, 'recall': 0.35938832334482385, 'f1-score': 0.2935795611269033, 'support': 742353}}
[[102447     13 161951]
 [ 82901     10 134597]
 [ 96088     10 164336]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038846
{'0': {'precision': 0.35751934677959907, 'recall': 0.39067467914037923, 'f1-score': 0.3733623933119626, 'support': 60073}, '1': {'precision': 0.14285714285714285, 'recall': 1.714207350521119e-05, 'f1-score': 3.428003359443293e-05, 'support': 58336}, '2': {'precision': 0.341703066520174, 'recall': 0.6462588481746152, 'f1-score': 0.4470387509933156, 'support': 59193}, 'accuracy': 0.3475411312935665, 'macro avg': {'precision': 0.28069318538563864, 'recall': 0.34565022312949994, 'f1-score': 0.2734784747796242, 'support': 177602}, 'weighted avg': {'precision': 0.28173896477142035, 'recall': 0.3475411312935665, 'f1-score': 0.27529286607705217, 'support': 177602}}
[[23469     4 36600]
 [21238     1 37097]
 [20937     2 38254]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078912
{'0': {'precision': 0.34516157053509383, 'recall': 0.3948427485467283, 'f1-score': 0.368334453430975, 'support': 20127}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20927}, '2': {'precision': 0.3354120973495759, 'recall': 0.640639983848988, 'f1-score': 0.4403010961565145, 'support': 19813}, 'accuracy': 0.3391000049287791, 'macro avg': {'precision': 0.2268578892948899, 'recall': 0.3451609107985721, 'f1-score': 0.2695451831958298, 'support': 60867}, 'weighted avg': {'precision': 0.22331619457090018, 'recall': 0.3391000049287791, 'f1-score': 0.265121546360988, 'support': 60867}}
[[ 7947     0 12180]
 [ 7957     0 12970]
 [ 7120     0 12693]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/EXC
Evaluating performance on  test set...
7167/7167 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0857557
{'0': {'precision': 0.38529408460514414, 'recall': 0.420682792500506, 'f1-score': 0.4022115176000798, 'support': 652204}, '1': {'precision': 0.2631578947368421, 'recall': 7.192707006107636e-05, 'f1-score': 0.00014381483223999816, 'support': 486604}, '2': {'precision': 0.40045797785846343, 'recall': 0.6459774806757522, 'f1-score': 0.4944152714700043, 'support': 695758}, 'accuracy': 0.39456198359721045, 'macro avg': {'precision': 0.3496366524001499, 'recall': 0.3555774000821064, 'f1-score': 0.29892353463410803, 'support': 1834566}, 'weighted avg': {'precision': 0.3586493312997126, 'recall': 0.39456198359721045, 'f1-score': 0.33053448169479704, 'support': 1834566}}
[[274371     49 377784]
 [191472     35 295097]
 [246265     49 449444]]
Evaluating performance on  train set...
1570/1570 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021469
{'0': {'precision': 0.3803803419623496, 'recall': 0.4315635160241523, 'f1-score': 0.4043586910327242, 'support': 137792}, '1': {'precision': 0.45, 'recall': 6.721584501519825e-05, 'f1-score': 0.00013441161316337733, 'support': 133897}, '2': {'precision': 0.3462905447816553, 'recall': 0.6534958849319283, 'f1-score': 0.4526955743347648, 'support': 130010}, 'accuracy': 0.3595627571888404, 'macro avg': {'precision': 0.39222362891466833, 'recall': 0.3617088722670319, 'f1-score': 0.2857295589935508, 'support': 401699}, 'weighted avg': {'precision': 0.39255325954692216, 'recall': 0.3595627571888404, 'f1-score': 0.2852641945481857, 'support': 401699}}
[[59466     7 78319]
 [51822     9 82066]
 [45045     4 84961]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0901309
{'0': {'precision': 0.4087264878199198, 'recall': 0.39169621749408984, 'f1-score': 0.4000301795684322, 'support': 47376}, '1': {'precision': 0.5, 'recall': 2.8434940855323022e-05, 'f1-score': 5.686664771111743e-05, 'support': 35168}, '2': {'precision': 0.3616359246259926, 'recall': 0.6724991899273249, 'f1-score': 0.47034447034447036, 'support': 43206}, 'accuracy': 0.3786401590457256, 'macro avg': {'precision': 0.42345413748197086, 'recall': 0.35474128078742334, 'f1-score': 0.29014383885353784, 'support': 125750}, 'weighted avg': {'precision': 0.41807290533874475, 'recall': 0.3786401590457256, 'f1-score': 0.3123302811865124, 'support': 125750}}
[[18557     0 28819]
 [12696     1 22471]
 [14149     1 29056]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/AAL
Evaluating performance on  test set...
6357/6357 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.083939
{'0': {'precision': 0.400267347370329, 'recall': 0.43604911375408895, 'f1-score': 0.41739276983946977, 'support': 607732}, '1': {'precision': 0.1875, 'recall': 2.8896305607328102e-05, 'f1-score': 5.778370595798161e-05, 'support': 415278}, '2': {'precision': 0.3915972394926635, 'recall': 0.6255143556113176, 'f1-score': 0.48165746236602996, 'support': 604154}, 'accuracy': 0.3951169027830016, 'macro avg': {'precision': 0.3264548622876642, 'recall': 0.353864121890338, 'f1-score': 0.2997026719704859, 'support': 1627164}, 'weighted avg': {'precision': 0.3427466064763695, 'recall': 0.3951169027830016, 'f1-score': 0.33474328440170137, 'support': 1627164}}
[[265001     24 342707]
 [170840     12 244426]
 [226219     28 377907]]
Evaluating performance on  train set...
1701/1701 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042929
{'0': {'precision': 0.3628621597892889, 'recall': 0.4546723413617893, 'f1-score': 0.40361204952377466, 'support': 145441}, '1': {'precision': 0.23809523809523808, 'recall': 6.81946821786837e-05, 'f1-score': 0.00013635031121958535, 'support': 146639}, '2': {'precision': 0.3504637823146451, 'recall': 0.6189217095257363, 'f1-score': 0.4475198878110544, 'support': 143338}, 'accuracy': 0.35564216454074016, 'macro avg': {'precision': 0.31714039339972405, 'recall': 0.3578874151899014, 'f1-score': 0.2837560958820162, 'support': 435418}, 'weighted avg': {'precision': 0.31676196351638697, 'recall': 0.35564216454074016, 'f1-score': 0.282184797245716, 'support': 435418}}
[[66128    12 79301]
 [61509    10 85120]
 [54603    20 88715]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.08935
{'0': {'precision': 0.39361551528878824, 'recall': 0.42104067687531943, 'f1-score': 0.4068664660746458, 'support': 52831}, '1': {'precision': 0.23076923076923078, 'recall': 7.533713367318751e-05, 'f1-score': 0.00015062509414068382, 'support': 39821}, '2': {'precision': 0.3727094091303752, 'recall': 0.634646435171676, 'f1-score': 0.46962292261960464, 'support': 51405}, 'accuracy': 0.38089783904982055, 'macro avg': {'precision': 0.3323647183961314, 'recall': 0.35192081639355616, 'f1-score': 0.29221333792946375, 'support': 144057}, 'weighted avg': {'precision': 0.34114059020408904, 'recall': 0.38089783904982055, 'f1-score': 0.31683379945663287, 'support': 144057}}
[[22244     0 30587]
 [15497     3 24321]
 [18771    10 32624]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/WBA
Evaluating performance on  test set...
7458/7458 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0816314
{'0': {'precision': 0.3984777664092806, 'recall': 0.3759980885596964, 'f1-score': 0.3869116836687654, 'support': 719876}, '1': {'precision': 0.18666666666666668, 'recall': 3.048893360599151e-05, 'f1-score': 6.096790910555722e-05, 'support': 459183}, '2': {'precision': 0.39506271210970595, 'recall': 0.6654322796763021, 'f1-score': 0.4957825980706018, 'support': 730187}, 'accuracy': 0.3962695221045376, 'macro avg': {'precision': 0.3267357150618844, 'recall': 0.3471536190565348, 'f1-score': 0.29425174988282427, 'support': 1909246}, 'weighted avg': {'precision': 0.34623008095284585, 'recall': 0.3962695221045376, 'f1-score': 0.33550964022316737, 'support': 1909246}}
[[270672     31 449173]
 [164326     14 294843]
 [244267     30 485890]]
Evaluating performance on  train set...
1664/1664 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014851
{'0': {'precision': 0.36591911812837935, 'recall': 0.3868057045191915, 'f1-score': 0.37607263112926065, 'support': 144517}, '1': {'precision': 0.4411764705882353, 'recall': 0.00010780508840017249, 'f1-score': 0.0002155575035566988, 'support': 139140}, '2': {'precision': 0.3523416593144702, 'recall': 0.6763407915448617, 'f1-score': 0.46331700624601346, 'support': 142304}, 'accuracy': 0.3572181490793758, 'macro avg': {'precision': 0.3864790826770283, 'recall': 0.3544181003841511, 'f1-score': 0.2798683982929436, 'support': 425961}, 'weighted avg': {'precision': 0.38596597998242194, 'recall': 0.3572181490793758, 'f1-score': 0.28244544538299265, 'support': 425961}}
[[55900    10 88607]
 [50817    15 88308]
 [46049     9 96246]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0904744
{'0': {'precision': 0.38379274973264366, 'recall': 0.3675717480821889, 'f1-score': 0.37550715353405933, 'support': 47841}, '1': {'precision': 0.125, 'recall': 2.7170959678295838e-05, 'f1-score': 5.433010974682169e-05, 'support': 36804}, '2': {'precision': 0.37102191133552603, 'recall': 0.674037450031559, 'f1-score': 0.4785999193295388, 'support': 47530}, 'accuracy': 0.37543408360128616, 'macro avg': {'precision': 0.2932715536893899, 'recall': 0.3472121230244754, 'f1-score': 0.28472046765778164, 'support': 132175}, 'weighted avg': {'precision': 0.3071397797294266, 'recall': 0.37543408360128616, 'f1-score': 0.3080347377591453, 'support': 132175}}
[[17585     3 30253]
 [12745     1 24058]
 [15489     4 32037]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
8238/8238 - 42s - 42s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894862
{'0': {'precision': 0.38615751855309155, 'recall': 0.37260246835317656, 'f1-score': 0.379258914726598, 'support': 757185}, '1': {'precision': 0.3067484662576687, 'recall': 8.623469980838649e-05, 'f1-score': 0.00017242092776252808, 'support': 579813}, '2': {'precision': 0.37892941637516875, 'recall': 0.6766030288540659, 'f1-score': 0.4857923448969158, 'support': 771711}, 'accuracy': 0.38142816291863885, 'macro avg': {'precision': 0.35727846706197636, 'recall': 0.3497639106356836, 'f1-score': 0.2884078935170921, 'support': 2108709}, 'weighted avg': {'precision': 0.36167789296303005, 'recall': 0.38142816291863885, 'f1-score': 0.31401223664118266, 'support': 2108709}}
[[282129     60 474996]
 [198961     50 380802]
 [249516     53 522142]]
Evaluating performance on  train set...
1806/1806 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018897
{'0': {'precision': 0.36500966953306496, 'recall': 0.38560626015894534, 'f1-score': 0.37502538388240625, 'support': 155651}, '1': {'precision': 0.3870967741935484, 'recall': 7.929794882639035e-05, 'f1-score': 0.0001585634154559689, 'support': 151328}, '2': {'precision': 0.3520650330035775, 'recall': 0.675391961644789, 'f1-score': 0.462855174484848, 'support': 155181}, 'accuracy': 0.35667301367491777, 'macro avg': {'precision': 0.36805715891006363, 'recall': 0.3536925065841869, 'f1-score': 0.27934637392757006, 'support': 462160}, 'weighted avg': {'precision': 0.36789532760122157, 'recall': 0.35667301367491777, 'f1-score': 0.28177124792917546, 'support': 462160}}
[[ 60020      7  95624]
 [ 54053     12  97263]
 [ 50361     12 104808]]
Evaluating performance on  val set...
642/642 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011548
{'0': {'precision': 0.3613881961762261, 'recall': 0.3826112465851378, 'f1-score': 0.37169702097341584, 'support': 54541}, '1': {'precision': 0.4, 'recall': 0.00011177763702075338, 'f1-score': 0.0002234928202931481, 'support': 53678}, '2': {'precision': 0.3559865994763661, 'recall': 0.6761670498903802, 'f1-score': 0.46641584596658187, 'support': 56103}, 'accuracy': 0.3578887793478658, 'macro avg': {'precision': 0.3724582652175307, 'recall': 0.3529633580375129, 'f1-score': 0.2794454532534303, 'support': 164322}, 'weighted avg': {'precision': 0.3721570440846029, 'recall': 0.3578887793478658, 'f1-score': 0.28268918388762254, 'support': 164322}}
[[20868     6 33667]
 [18711     6 34961]
 [18165     3 37935]]
testing model on single stock: results/universal/W5/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
31315/31315 - 166s - 166s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0782727
{'0': {'precision': 0.40391619078125285, 'recall': 0.3946610861309909, 'f1-score': 0.3992350074772775, 'support': 3067328}, '1': {'precision': 0.1522633744855967, 'recall': 2.0016608375057142e-05, 'f1-score': 4.00279546580639e-05, 'support': 1848465}, '2': {'precision': 0.40070106887700874, 'recall': 0.6486289494460584, 'f1-score': 0.49537573272317664, 'support': 3100688}, 'accuracy': 0.4018955449404795, 'macro avg': {'precision': 0.3189602113812861, 'recall': 0.34777001739514146, 'f1-score': 0.29821692271837075, 'support': 8016481}, 'weighted avg': {'precision': 0.34464573121414643, 'recall': 0.4018955449404795, 'f1-score': 0.34437358452348743, 'support': 8016481}}
[[1210555     104 1856669]
 [ 697100      37 1151328]
 [1089390     102 2011196]]
Evaluating performance on  train set...
5759/5759 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026921
{'0': {'precision': 0.3551525135094524, 'recall': 0.387467137817769, 'f1-score': 0.3706067504471649, 'support': 494109}, '1': {'precision': 0.3, 'recall': 2.484436043369972e-05, 'f1-score': 4.9684606259846356e-05, 'support': 483007}, '2': {'precision': 0.35312021423132534, 'recall': 0.6642926839082194, 'f1-score': 0.4611208984728224, 'support': 497055}, 'accuracy': 0.35386193324926346, 'macro avg': {'precision': 0.3360909092469259, 'recall': 0.350594888695474, 'f1-score': 0.27725911117541574, 'support': 1474171}, 'weighted avg': {'precision': 0.33639674188570623, 'recall': 0.35386193324926346, 'f1-score': 0.2797142102644284, 'support': 1474171}}
[[191451     16 302642]
 [180763     12 302232]
 [166853     12 330190]]
Evaluating performance on  val set...
2129/2129 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963963
{'0': {'precision': 0.3647868681718074, 'recall': 0.35636989931107577, 'f1-score': 0.3605292644874895, 'support': 188700}, '1': {'precision': 0.28, 'recall': 4.248011020554305e-05, 'f1-score': 8.494733265375468e-05, 'support': 164783}, '2': {'precision': 0.36327682989061705, 'recall': 0.6841571953869297, 'f1-score': 0.474566323203339, 'support': 191456}, 'accuracy': 0.3637838363559958, 'macro avg': {'precision': 0.3360212326874748, 'recall': 0.3468565249360703, 'f1-score': 0.27839351167449405, 'support': 544939}, 'weighted avg': {'precision': 0.33861781000728164, 'recall': 0.3637838363559958, 'f1-score': 0.29160041777212575, 'support': 544939}}
[[ 67247      8 121445]
 [ 56639      7 108137]
 [ 60460     10 130986]]
training model: results/universal/W5/deepOF_L1/h1000
Epoch 1/50
9913/9913 - 143s - loss: 3.2709 - accuracy1000: 0.3702 - val_loss: 3.2946 - val_accuracy1000: 0.3513 - 143s/epoch - 14ms/step
Epoch 2/50
9913/9913 - 138s - loss: 3.2712 - accuracy1000: 0.3703 - val_loss: 3.2962 - val_accuracy1000: 0.3512 - 138s/epoch - 14ms/step
Epoch 3/50
9913/9913 - 136s - loss: 3.2688 - accuracy1000: 0.3728 - val_loss: 3.3164 - val_accuracy1000: 0.3150 - 136s/epoch - 14ms/step
Epoch 4/50
9913/9913 - 139s - loss: 3.2674 - accuracy1000: 0.3738 - val_loss: 3.3392 - val_accuracy1000: 0.3065 - 139s/epoch - 14ms/step
Epoch 5/50
9913/9913 - 139s - loss: 3.2664 - accuracy1000: 0.3750 - val_loss: 3.3534 - val_accuracy1000: 0.3056 - 139s/epoch - 14ms/step
Epoch 6/50
9913/9913 - 136s - loss: 3.2657 - accuracy1000: 0.3752 - val_loss: 3.3704 - val_accuracy1000: 0.3052 - 136s/epoch - 14ms/step
Epoch 7/50
9913/9913 - 139s - loss: 3.2648 - accuracy1000: 0.3761 - val_loss: 3.3822 - val_accuracy1000: 0.3051 - 139s/epoch - 14ms/step
Epoch 8/50
9913/9913 - 140s - loss: 3.2635 - accuracy1000: 0.3774 - val_loss: 3.3969 - val_accuracy1000: 0.3049 - 140s/epoch - 14ms/step
Epoch 9/50
9913/9913 - 139s - loss: 3.2626 - accuracy1000: 0.3778 - val_loss: 3.4022 - val_accuracy1000: 0.3049 - 139s/epoch - 14ms/step
Epoch 10/50
9913/9913 - 137s - loss: 3.2619 - accuracy1000: 0.3785 - val_loss: 3.4058 - val_accuracy1000: 0.3049 - 137s/epoch - 14ms/step
Epoch 11/50
9913/9913 - 136s - loss: 3.2614 - accuracy1000: 0.3791 - val_loss: 3.4091 - val_accuracy1000: 0.3049 - 136s/epoch - 14ms/step
testing model in sample: results/universal/W5/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 253s - 253s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006644
{'0': {'precision': 0.4057719316607965, 'recall': 0.0677170721423263, 'f1-score': 0.11606473201658768, 'support': 4923559}, '1': {'precision': 0.23366044924034188, 'recall': 0.06123917085042898, 'f1-score': 0.09704435812845662, 'support': 2916434}, '2': {'precision': 0.392828586899635, 'recall': 0.8843361629874361, 'f1-score': 0.5440058148822489, 'support': 4998373}, 'accuracy': 0.3841805880904159, 'macro avg': {'precision': 0.3440869892669245, 'recall': 0.33776413532673044, 'f1-score': 0.2523716350090977, 'support': 12838366}, 'weighted avg': {'precision': 0.3616348939641537, 'recall': 0.3841805880904159, 'f1-score': 0.27835465965118117, 'support': 12838366}}
[[ 333409  305013 4285137]
 [ 190870  178600 2546964]
 [ 297387  280744 4420242]]
Evaluating performance on  train set...
9913/9913 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992475
{'0': {'precision': 0.3656134464224687, 'recall': 0.06817957972920517, 'f1-score': 0.11492748669368621, 'support': 863015}, '1': {'precision': 0.33361859261605226, 'recall': 0.060246828249690305, 'f1-score': 0.10206258780505653, 'support': 821786}, '2': {'precision': 0.34091174347574704, 'recall': 0.89113203672739, 'f1-score': 0.49316003406589726, 'support': 852225}, 'accuracy': 0.3420520719929555, 'macro avg': {'precision': 0.3467145941714227, 'recall': 0.3398528149020952, 'f1-score': 0.23671670285488, 'support': 2537026}, 'weighted avg': {'precision': 0.34695209580015357, 'recall': 0.3420520719929555, 'f1-score': 0.2378142993972971, 'support': 2537026}}
[[ 58840  53755 750420]
 [ 54453  49510 717823]
 [ 47642  45138 759445]]
Evaluating performance on  val set...
3496/3496 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994767
{'0': {'precision': 0.35799364115218524, 'recall': 0.0488062081703818, 'f1-score': 0.08590127160982332, 'support': 309141}, '1': {'precision': 0.3142036627277435, 'recall': 0.04899031791589286, 'f1-score': 0.08476427555374924, 'support': 272462}, '2': {'precision': 0.3522935711824148, 'recall': 0.9123487751668191, 'f1-score': 0.5083091027202743, 'support': 312614}, 'accuracy': 0.35075266965401014, 'macro avg': {'precision': 0.34149695835411453, 'recall': 0.336715100417698, 'f1-score': 0.22632488329461564, 'support': 894217}, 'weighted avg': {'precision': 0.34265840733868125, 'recall': 0.35075266965401014, 'f1-score': 0.23322660035590229, 'support': 894217}}
[[ 15088  15177 278876]
 [ 13614  13348 245500]
 [ 13444  13957 285213]]
testing model out of sample: results/universal/W5/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 105s - 105s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003574
{'0': {'precision': 0.38985598443609704, 'recall': 0.07109700845941949, 'f1-score': 0.12026212933035976, 'support': 1995527}, '1': {'precision': 0.24865073560399464, 'recall': 0.06972122032719846, 'f1-score': 0.10890552637313826, 'support': 1311681}, '2': {'precision': 0.38463652672550147, 'recall': 0.8698562066916763, 'f1-score': 0.53340838281483, 'support': 2041611}, 'accuracy': 0.3756410527258447, 'macro avg': {'precision': 0.3410477489218644, 'recall': 0.33689147849276474, 'f1-score': 0.25419201283944265, 'support': 5348819}, 'weighted avg': {'precision': 0.3532362475802925, 'recall': 0.3756410527258447, 'f1-score': 0.2751725301869136, 'support': 5348819}}
[[ 141876  142566 1711085]
 [  90115   91452 1130114]
 [ 131928  133775 1775908]]
Evaluating performance on  train set...
4957/4957 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993032
{'0': {'precision': 0.36195524803303386, 'recall': 0.07569102807053574, 'f1-score': 0.1252004933439105, 'support': 428492}, '1': {'precision': 0.33003327590682746, 'recall': 0.06697621624728206, 'f1-score': 0.11135441591585016, 'support': 417596}, '2': {'precision': 0.33665877810471584, 'recall': 0.8722303269137861, 'f1-score': 0.4858079949031849, 'support': 422252}, 'accuracy': 0.33800321680306544, 'macro avg': {'precision': 0.34288243401485907, 'recall': 0.33829919041053463, 'f1-score': 0.24078763472098186, 'support': 1268340}, 'weighted avg': {'precision': 0.34302343724713463, 'recall': 0.33800321680306544, 'f1-score': 0.24069410877727884, 'support': 1268340}}
[[ 32433  30260 365799]
 [ 29738  27969 359889]
 [ 27434  26517 368301]]
Evaluating performance on  val set...
1701/1701 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099952
{'0': {'precision': 0.3727413890457369, 'recall': 0.06902816809358865, 'f1-score': 0.11648451027317945, 'support': 153010}, '1': {'precision': 0.30089360008682753, 'recall': 0.06339225146533128, 'f1-score': 0.10472173256106773, 'support': 131199}, '2': {'precision': 0.3495026286425758, 'recall': 0.8782521659010613, 'f1-score': 0.5000207565184902, 'support': 150861}, 'accuracy': 0.3479279196451146, 'macro avg': {'precision': 0.3410458725917134, 'recall': 0.3368908618199937, 'f1-score': 0.2404089997842458, 'support': 435070}, 'weighted avg': {'precision': 0.3430170212502069, 'recall': 0.3479279196451146, 'f1-score': 0.24592896052661561, 'support': 435070}}
[[ 10562  10134 132314]
 [  8597   8317 114285]
 [  9177   9190 132494]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965637
{'0': {'precision': 0.297261858850752, 'recall': 0.048220809769280816, 'f1-score': 0.08298076198473446, 'support': 79924}, '1': {'precision': 0.34014488791689446, 'recall': 0.05196391655703815, 'f1-score': 0.0901548772756091, 'support': 95778}, '2': {'precision': 0.3496130774091368, 'recall': 0.8911654272954515, 'f1-score': 0.5022058108454576, 'support': 95613}, 'accuracy': 0.3466008145513518, 'macro avg': {'precision': 0.3290066080589278, 'recall': 0.3304500512072568, 'f1-score': 0.22511381670193373, 'support': 271315}, 'weighted avg': {'precision': 0.3308490465031849, 'recall': 0.3466008145513518, 'f1-score': 0.2332506954976243, 'support': 271315}}
[[ 3854  4122 71948]
 [ 4238  4977 86563]
 [ 4873  5533 85207]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011077
{'0': {'precision': 0.34941275167785235, 'recall': 0.03433494085157248, 'f1-score': 0.06252580221429913, 'support': 24261}, '1': {'precision': 0.32608695652173914, 'recall': 0.04326544882440346, 'f1-score': 0.07639478354811328, 'support': 22882}, '2': {'precision': 0.3234808865645623, 'recall': 0.9226637069922309, 'f1-score': 0.47901997165016763, 'support': 22525}, 'accuracy': 0.32448182809898374, 'macro avg': {'precision': 0.3329935315880513, 'recall': 0.33342136555606894, 'f1-score': 0.20598018580419333, 'support': 69668}, 'weighted avg': {'precision': 0.33336727733613103, 'recall': 0.32448182809898374, 'f1-score': 0.20174152819212646, 'support': 69668}}
[[  833  1056 22372]
 [  799   990 21093]
 [  752   990 20783]]
Evaluating performance on  val set...
96/96 - 1s - 682ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013999
{'0': {'precision': 0.3759765625, 'recall': 0.04367555303460011, 'f1-score': 0.07825998577091167, 'support': 8815}, '1': {'precision': 0.3298585256887565, 'recall': 0.05834321085210062, 'f1-score': 0.09914950760966876, 'support': 7593}, '2': {'precision': 0.3336495888678052, 'recall': 0.9125169899913506, 'f1-score': 0.48863598769312205, 'support': 8093}, 'accuracy': 0.3352108077221338, 'macro avg': {'precision': 0.3464948923521873, 'recall': 0.3381785846260171, 'f1-score': 0.2220151603579008, 'support': 24501}, 'weighted avg': {'precision': 0.3477031674910973, 'recall': 0.3352108077221338, 'f1-score': 0.22028631624224473, 'support': 24501}}
[[ 385  490 7940]
 [ 341  443 6809]
 [ 298  410 7385]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986332
{'0': {'precision': 0.35312781804214954, 'recall': 0.05673214678564338, 'f1-score': 0.09775875141002645, 'support': 186367}, '1': {'precision': 0.359961441587114, 'recall': 0.06252734491047074, 'f1-score': 0.10654689038813772, 'support': 185135}, '2': {'precision': 0.3421256444867341, 'recall': 0.9060836765246485, 'f1-score': 0.49670268691588787, 'support': 187699}, 'accuracy': 0.34374044395485703, 'macro avg': {'precision': 0.3517383013719992, 'recall': 0.3417810560735875, 'f1-score': 0.23366944290468403, 'support': 559201}, 'weighted avg': {'precision': 0.3516972875545772, 'recall': 0.34374044395485703, 'f1-score': 0.23457604941240362, 'support': 559201}}
[[ 10573  11261 164533]
 [ 11062  11576 162497]
 [  8306   9322 170071]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096123
{'0': {'precision': 0.3801488833746898, 'recall': 0.06327310273618998, 'f1-score': 0.10848897937505532, 'support': 48425}, '1': {'precision': 0.3287720561757292, 'recall': 0.05612244897959184, 'f1-score': 0.0958781832501969, 'support': 48804}, '2': {'precision': 0.36235563928249653, 'recall': 0.9102710387011093, 'f1-score': 0.5183638687686408, 'support': 53461}, 'accuracy': 0.36145066029597184, 'macro avg': {'precision': 0.35709219294430516, 'recall': 0.3432221968056304, 'f1-score': 0.24091034379796436, 'support': 150690}, 'weighted avg': {'precision': 0.3571968673349339, 'recall': 0.36145066029597184, 'f1-score': 0.24981796051376978, 'support': 150690}}
[[ 3064  3116 42245]
 [ 2675  2739 43390]
 [ 2321  2476 48664]]
Evaluating performance on  val set...
222/222 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971636
{'0': {'precision': 0.3606082548877625, 'recall': 0.05834797891036907, 'f1-score': 0.10044372730939895, 'support': 17070}, '1': {'precision': 0.3861316437873988, 'recall': 0.04926130495307378, 'f1-score': 0.08737554759060134, 'support': 22269}, '2': {'precision': 0.3104319717895974, 'recall': 0.9154774972557629, 'f1-score': 0.46364514146940927, 'support': 17309}, 'accuracy': 0.316674904674481, 'macro avg': {'precision': 0.35239062348825284, 'recall': 0.34102892703973525, 'f1-score': 0.21715480545646984, 'support': 56648}, 'weighted avg': {'precision': 0.3553102578403798, 'recall': 0.316674904674481, 'f1-score': 0.20628396851010708, 'support': 56648}}
[[  996   993 15081]
 [ 1054  1097 20118]
 [  712   751 15846]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999719
{'0': {'precision': 0.38382902161764304, 'recall': 0.06447801656828579, 'f1-score': 0.11040885780154636, 'support': 218369}, '1': {'precision': 0.25576843365725604, 'recall': 0.07274501584972885, 'f1-score': 0.11327316302075364, 'support': 152684}, '2': {'precision': 0.38446247753621654, 'recall': 0.874579910176361, 'f1-score': 0.5341252405023321, 'support': 228225}, 'accuracy': 0.3750980346350108, 'macro avg': {'precision': 0.3413533109370386, 'recall': 0.3372676475314586, 'f1-score': 0.252602420441544, 'support': 599278}, 'weighted avg': {'precision': 0.35144299654225686, 'recall': 0.3750980346350108, 'f1-score': 0.2725039205603599, 'support': 599278}}
[[ 14080  16735 187554]
 [  9563  11107 132014]
 [ 13040  15584 199601]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992316
{'0': {'precision': 0.3625541125541126, 'recall': 0.06520681265206812, 'f1-score': 0.11053369627979873, 'support': 41100}, '1': {'precision': 0.3221735771310842, 'recall': 0.06110636219318598, 'f1-score': 0.10272833651536614, 'support': 40945}, '2': {'precision': 0.33712407923643545, 'recall': 0.8811735469394648, 'f1-score': 0.48767200112163755, 'support': 41447}, 'accuracy': 0.33770608622420883, 'macro avg': {'precision': 0.34061725630721074, 'recall': 0.335828907261573, 'f1-score': 0.23364467797226748, 'support': 123492}, 'weighted avg': {'precision': 0.3406305902707772, 'recall': 0.33770608622420883, 'f1-score': 0.23452278759927692, 'support': 123492}}
[[ 2680  2735 35685]
 [ 2316  2502 36127]
 [ 2396  2529 36522]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023257
{'0': {'precision': 0.3924752475247525, 'recall': 0.06248029758527205, 'f1-score': 0.10779941259654084, 'support': 15861}, '1': {'precision': 0.26608084358523726, 'recall': 0.07070801419764618, 'f1-score': 0.11172607187661426, 'support': 10706}, '2': {'precision': 0.35941367896976606, 'recall': 0.8757115749525617, 'f1-score': 0.5096531187757598, 'support': 14756}, 'accuracy': 0.35500810686542605, 'macro avg': {'precision': 0.339323256693252, 'recall': 0.33629996224515996, 'f1-score': 0.24305953441630498, 'support': 41323}, 'weighted avg': {'precision': 0.34792294023404685, 'recall': 0.35500810686542605, 'f1-score': 0.25231438253175903, 'support': 41323}}
[[  991  1123 13747]
 [  665   757  9284]
 [  869   965 12922]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983075
{'0': {'precision': 0.32583879293230095, 'recall': 0.08495357639675197, 'f1-score': 0.13476964449759046, 'support': 154555}, '1': {'precision': 0.37201817905060125, 'recall': 0.08142091586632273, 'f1-score': 0.13360145252923605, 'support': 210118}, '2': {'precision': 0.2943648590232299, 'recall': 0.8258095058982224, 'f1-score': 0.43402046394950133, 'support': 154199}, 'accuracy': 0.3036914691870057, 'macro avg': {'precision': 0.3307406103353774, 'recall': 0.33072799938709907, 'f1-score': 0.2341305203254426, 'support': 518872}, 'weighted avg': {'precision': 0.3351857438519115, 'recall': 0.3036914691870057, 'f1-score': 0.22322829894157378, 'support': 518872}}
[[ 13130  14800 126625]
 [ 14385  17108 178625]
 [ 12781  14079 127339]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981009
{'0': {'precision': 0.3411689961880559, 'recall': 0.078837260515305, 'f1-score': 0.12807823027845686, 'support': 27246}, '1': {'precision': 0.32537867962274936, 'recall': 0.08144068099717443, 'f1-score': 0.1302743370426524, 'support': 27959}, '2': {'precision': 0.34817654575838003, 'recall': 0.8462116040955632, 'f1-score': 0.4933589358378685, 'support': 29300}, 'accuracy': 0.34576652269096503, 'macro avg': {'precision': 0.33824140718972845, 'recall': 0.3354965152026808, 'f1-score': 0.25057050105299256, 'support': 84505}, 'weighted avg': {'precision': 0.3383743655929561, 'recall': 0.34576652269096503, 'f1-score': 0.2554567951197196, 'support': 84505}}
[[ 2148  2357 22741]
 [ 2006  2277 23676]
 [ 2142  2364 24794]]
Evaluating performance on  val set...
136/136 - 1s - 892ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007962
{'0': {'precision': 0.3346600331674959, 'recall': 0.08383880348982135, 'f1-score': 0.13408637873754153, 'support': 12035}, '1': {'precision': 0.3036762434352796, 'recall': 0.09117046930068633, 'f1-score': 0.1402382480918753, 'support': 10782}, '2': {'precision': 0.3393315291884863, 'recall': 0.8121635262449529, 'f1-score': 0.47866934384373216, 'support': 11888}, 'accuracy': 0.3356000576285838, 'macro avg': {'precision': 0.3258892685970873, 'recall': 0.32905759967848686, 'f1-score': 0.250997990224383, 'support': 34705}, 'weighted avg': {'precision': 0.32663431709790297, 'recall': 0.3356000576285838, 'f1-score': 0.2540325462799942, 'support': 34705}}
[[1009 1156 9870]
 [ 871  983 8928]
 [1135 1098 9655]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015131
{'0': {'precision': 0.3456148355767037, 'recall': 0.08060948355808262, 'f1-score': 0.13072850212960052, 'support': 263108}, '1': {'precision': 0.31090951026370417, 'recall': 0.08982115728031131, 'f1-score': 0.1393766650927627, 'support': 225114}, '2': {'precision': 0.3424487622412136, 'recall': 0.8300128673794224, 'f1-score': 0.4848548931538715, 'support': 254131}, 'accuracy': 0.3399474374051159, 'macro avg': {'precision': 0.3329910360272072, 'recall': 0.33348116940593875, 'f1-score': 0.2516533534587449, 'support': 742353}, 'weighted avg': {'precision': 0.3340068108427402, 'recall': 0.3399474374051159, 'f1-score': 0.2545797109678194, 'support': 742353}}
[[ 21209  22714 219185]
 [ 19059  20220 185835]
 [ 21098  22101 210932]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999814
{'0': {'precision': 0.3556118009965989, 'recall': 0.07483230971521779, 'f1-score': 0.12364556405038227, 'support': 60081}, '1': {'precision': 0.3320155154408474, 'recall': 0.07485704675412042, 'f1-score': 0.1221694617517086, 'support': 59460}, '2': {'precision': 0.32877607173728, 'recall': 0.8581836344534197, 'f1-score': 0.4754167183489652, 'support': 58061}, 'accuracy': 0.3309309579847074, 'macro avg': {'precision': 0.3388011293915754, 'recall': 0.33595766364091934, 'f1-score': 0.24041058138368535, 'support': 177602}, 'weighted avg': {'precision': 0.3389388783061433, 'recall': 0.3309309579847074, 'f1-score': 0.23815112112209813, 'support': 177602}}
[[ 4496  4645 50940]
 [ 4223  4451 50786]
 [ 3924  4310 49827]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996522
{'0': {'precision': 0.34526795895096923, 'recall': 0.07541718555417186, 'f1-score': 0.12379394930498773, 'support': 20075}, '1': {'precision': 0.36749041329356624, 'recall': 0.08114973890953568, 'f1-score': 0.1329428538399291, 'support': 21257}, '2': {'precision': 0.3248435931103731, 'recall': 0.861172254927054, 'f1-score': 0.4717412335431768, 'support': 19535}, 'accuracy': 0.3296038904496689, 'macro avg': {'precision': 0.3458673217849695, 'recall': 0.33924639313025384, 'f1-score': 0.24282601222936454, 'support': 60867}, 'weighted avg': {'precision': 0.3464737473956854, 'recall': 0.3296038904496689, 'f1-score': 0.2386612577199297, 'support': 60867}}
[[ 1514  1541 17020]
 [ 1587  1725 17945]
 [ 1284  1428 16823]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
7167/7167 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992477
{'0': {'precision': 0.42298949678633013, 'recall': 0.10655272985749907, 'f1-score': 0.17022508618164614, 'support': 709048}, '1': {'precision': 0.20144784986426406, 'recall': 0.06996949886304006, 'f1-score': 0.10386370044606906, 'support': 365888}, '2': {'precision': 0.42176537034893113, 'recall': 0.8488658952384713, 'f1-score': 0.5635344389488481, 'support': 759630}, 'accuracy': 0.4066226017488605, 'macro avg': {'precision': 0.34873423899984174, 'recall': 0.3417960413196702, 'f1-score': 0.27920774185885444, 'support': 1834566}, 'weighted avg': {'precision': 0.3782981020506475, 'recall': 0.4066226017488605, 'f1-score': 0.31984562255838633, 'support': 1834566}}
[[ 75551  53125 580372]
 [ 36614  25601 303673]
 [ 66447  48359 644824]]
Evaluating performance on  train set...
1570/1570 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994564
{'0': {'precision': 0.38806620209059234, 'recall': 0.1085572995054827, 'f1-score': 0.16965535780289198, 'support': 139530}, '1': {'precision': 0.3232803287475433, 'recall': 0.06872165715891741, 'f1-score': 0.11334820086198255, 'support': 131647}, '2': {'precision': 0.3310575411883519, 'recall': 0.8488913746341613, 'f1-score': 0.47634586117058325, 'support': 130522}, 'accuracy': 0.33605510593753035, 'macro avg': {'precision': 0.3474680240088292, 'recall': 0.3420567770995205, 'f1-score': 0.2531164732784859, 'support': 401699}, 'weighted avg': {'precision': 0.34831068787155123, 'recall': 0.33605510593753035, 'f1-score': 0.2508534429132803, 'support': 401699}}
[[ 15147  10575 113808]
 [ 12525   9047 110075]
 [ 11360   8363 110799]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010835
{'0': {'precision': 0.40377230630223626, 'recall': 0.07641338035695201, 'f1-score': 0.12850698251226658, 'support': 46785}, '1': {'precision': 0.2916201117318436, 'recall': 0.05796779566907274, 'f1-score': 0.09671144048170449, 'support': 36020}, '2': {'precision': 0.346723044397463, 'recall': 0.8859704272907207, 'f1-score': 0.49839862196344015, 'support': 42945}, 'accuracy': 0.3476023856858847, 'macro avg': {'precision': 0.34737182081051426, 'recall': 0.3401172011055818, 'f1-score': 0.2412056816524704, 'support': 125750}, 'weighted avg': {'precision': 0.3521643333326456, 'recall': 0.3476023856858847, 'f1-score': 0.24572146388236443, 'support': 125750}}
[[ 3575  2852 40358]
 [ 2602  2088 31330]
 [ 2677  2220 38048]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
6357/6357 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011705
{'0': {'precision': 0.4248600656243968, 'recall': 0.08337853521655995, 'f1-score': 0.1393999191921239, 'support': 660002}, '1': {'precision': 0.1930111564042051, 'recall': 0.07057312265883937, 'f1-score': 0.10335517781149922, 'support': 305938}, '2': {'precision': 0.4110198264509029, 'recall': 0.8614040022745696, 'f1-score': 0.5565034472415472, 'support': 661224}, 'accuracy': 0.39713390905895163, 'macro avg': {'precision': 0.34296368282650164, 'recall': 0.3384518867166563, 'f1-score': 0.2664195147483901, 'support': 1627164}, 'weighted avg': {'precision': 0.37564382811160685, 'recall': 0.39713390905895163, 'f1-score': 0.30211947735740186, 'support': 1627164}}
[[ 55030  47606 557366]
 [ 25519  21591 258828]
 [ 48976  42667 569581]]
Evaluating performance on  train set...
1701/1701 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992377
{'0': {'precision': 0.3661979262855183, 'recall': 0.09351209324260594, 'f1-score': 0.14898058851625853, 'support': 148430}, '1': {'precision': 0.3303170264241053, 'recall': 0.07361993263352498, 'f1-score': 0.12040451703048768, 'support': 142801}, '2': {'precision': 0.3364534794688368, 'recall': 0.8533154861395271, 'f1-score': 0.4826163275312577, 'support': 144187}, 'accuracy': 0.3385941784675875, 'macro avg': {'precision': 0.3443228107261535, 'recall': 0.340149170671886, 'f1-score': 0.2506671443593346, 'support': 435418}, 'weighted avg': {'precision': 0.3445805587576107, 'recall': 0.3385941784675875, 'f1-score': 0.25009088877283064, 'support': 435418}}
[[ 13880  11522 123028]
 [ 12665  10513 119623]
 [ 11358   9792 123037]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009241
{'0': {'precision': 0.3934096109839817, 'recall': 0.08045073375262055, 'f1-score': 0.1335840494801784, 'support': 53424}, '1': {'precision': 0.27326392615648815, 'recall': 0.06356418834573326, 'f1-score': 0.10313746936460674, 'support': 40054}, '2': {'precision': 0.3543674029802528, 'recall': 0.8674746436268016, 'f1-score': 0.5031824489374636, 'support': 50579}, 'accuracy': 0.35208285609168594, 'macro avg': {'precision': 0.34034698004024094, 'recall': 0.33716318857505184, 'f1-score': 0.24663465592741626, 'support': 144057}, 'weighted avg': {'precision': 0.3462960996745623, 'recall': 0.35208285609168594, 'f1-score': 0.25488610440427734, 'support': 144057}}
[[ 4298  3679 45447]
 [ 3016  2546 34492]
 [ 3611  3092 43876]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
7458/7458 - 38s - 38s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017048
{'0': {'precision': 0.4355844316182598, 'recall': 0.07225313299568273, 'f1-score': 0.12394648234613453, 'support': 781281}, '1': {'precision': 0.17798398009699354, 'recall': 0.0637915868368097, 'f1-score': 0.09392082637553695, 'support': 331956}, '2': {'precision': 0.4213159363703751, 'recall': 0.8789699613949089, 'f1-score': 0.5696040431769355, 'support': 796009}, 'accuracy': 0.40712092627141816, 'macro avg': {'precision': 0.34496144936187617, 'recall': 0.33833822707580047, 'f1-score': 0.26249045063286897, 'support': 1909246}, 'weighted avg': {'precision': 0.3848471949714543, 'recall': 0.40712092627141816, 'f1-score': 0.304530981507578, 'support': 1909246}}
[[ 56450  51193 673638]
 [ 23413  21176 287367]
 [ 49733  46608 699668]]
Evaluating performance on  train set...
1664/1664 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990852
{'0': {'precision': 0.3584299534746326, 'recall': 0.06814272978076671, 'f1-score': 0.11451457828269421, 'support': 142451}, '1': {'precision': 0.3421591804570528, 'recall': 0.06124032101098715, 'f1-score': 0.10388678206984006, 'support': 141802}, '2': {'precision': 0.33642660355181675, 'recall': 0.8867177576424761, 'f1-score': 0.4877845215612366, 'support': 141708}, 'accuracy': 0.3381671091954428, 'macro avg': {'precision': 0.3456719124945007, 'recall': 0.3387002694780767, 'f1-score': 0.23539529397125694, 'support': 425961}, 'weighted avg': {'precision': 0.34569339105154395, 'recall': 0.3381671091954428, 'f1-score': 0.23515542184241103, 'support': 425961}}
[[  9707   8908 123836]
 [  9110   8684 124008]
 [  8265   7788 125655]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997057
{'0': {'precision': 0.3763426053428808, 'recall': 0.05976513809617529, 'f1-score': 0.10314959144005585, 'support': 45729}, '1': {'precision': 0.30842032011134307, 'recall': 0.05477691261895934, 'f1-score': 0.09303106633081444, 'support': 40455}, '2': {'precision': 0.3502905001359065, 'recall': 0.8966754364984454, 'f1-score': 0.5037778144259372, 'support': 45991}, 'accuracy': 0.34944581047853224, 'macro avg': {'precision': 0.34501780853004343, 'recall': 0.33707249573785997, 'f1-score': 0.23331949073226918, 'support': 132175}, 'weighted avg': {'precision': 0.34648856017839574, 'recall': 0.34944581047853224, 'f1-score': 0.239453337761594, 'support': 132175}}
[[ 2733  2602 40394]
 [ 2144  2216 36095]
 [ 2385  2367 41239]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
8238/8238 - 55s - 55s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999125
{'0': {'precision': 0.3883985794178879, 'recall': 0.06145397894910893, 'f1-score': 0.10611760533298238, 'support': 774124}, '1': {'precision': 0.2556678852431888, 'recall': 0.06386904862571335, 'f1-score': 0.10220580386072056, 'support': 532167}, '2': {'precision': 0.3836010925482468, 'recall': 0.8859733954123661, 'f1-score': 0.5353925518695636, 'support': 802418}, 'accuracy': 0.37581430154658607, 'macro avg': {'precision': 0.3425558524031079, 'recall': 0.33709880766239614, 'f1-score': 0.24790532035442217, 'support': 2108709}, 'weighted avg': {'precision': 0.3530762636569979, 'recall': 0.37581430154658607, 'f1-score': 0.2684805546047412, 'support': 2108709}}
[[ 47573  51088 675463]
 [ 31280  33989 466898]
 [ 43632  47865 710921]]
Evaluating performance on  train set...
1806/1806 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098917
{'0': {'precision': 0.3605235280046475, 'recall': 0.06823179407579873, 'f1-score': 0.11474687709032373, 'support': 154620}, '1': {'precision': 0.3320286328855037, 'recall': 0.06214853341077699, 'f1-score': 0.10469958358120166, 'support': 151508}, '2': {'precision': 0.34114224127276055, 'recall': 0.8844660069729287, 'f1-score': 0.49237383377633487, 'support': 156032}, 'accuracy': 0.34181019560325426, 'macro avg': {'precision': 0.34456480072097057, 'recall': 0.3382821114865015, 'f1-score': 0.23727343148262006, 'support': 462160}, 'weighted avg': {'precision': 0.3446387575765252, 'recall': 0.34181019560325426, 'f1-score': 0.23894551816841708, 'support': 462160}}
[[ 10550  10015 134055]
 [  9614   9416 132478]
 [  9099   8928 138005]]
Evaluating performance on  val set...
642/642 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983629
{'0': {'precision': 0.3508337816030124, 'recall': 0.059469317042035195, 'f1-score': 0.10169967254015282, 'support': 54835}, '1': {'precision': 0.307870858830977, 'recall': 0.05656244548256411, 'f1-score': 0.09556716393469467, 'support': 51589}, '2': {'precision': 0.35443733725412063, 'recall': 0.8910152336868286, 'f1-score': 0.5071394515524928, 'support': 57898}, 'accuracy': 0.35154757123209307, 'macro avg': {'precision': 0.33771399256270335, 'recall': 0.335682332070476, 'f1-score': 0.23480209600911342, 'support': 164322}, 'weighted avg': {'precision': 0.33861523778174274, 'recall': 0.35154757123209307, 'f1-score': 0.2426289597859841, 'support': 164322}}
[[ 3261  3391 48183]
 [ 2893  2918 45778]
 [ 3141  3169 51588]]
testing model on single stock: results/universal/W5/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
31315/31315 - 204s - 204s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010348
{'0': {'precision': 0.4007991213281324, 'recall': 0.05735133757698133, 'f1-score': 0.10034417847263517, 'support': 3092308}, '1': {'precision': 0.23379393279332017, 'recall': 0.05651176935475998, 'f1-score': 0.0910220413088482, 'support': 1823337}, '2': {'precision': 0.38953186233793363, 'recall': 0.8960918926379854, 'f1-score': 0.5430147699343596, 'support': 3100836}, 'accuracy': 0.3815916235565206, 'macro avg': {'precision': 0.34137497215312873, 'recall': 0.33665166652324224, 'f1-score': 0.24479366323861432, 'support': 8016481}, 'weighted avg': {'precision': 0.35845577120410277, 'recall': 0.3815916235565206, 'f1-score': 0.26945223330816714, 'support': 8016481}}
[[ 177348  175502 2739458]
 [ 105124  103040 1615173]
 [ 160014  162188 2778634]]
Evaluating performance on  train set...
5759/5759 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996573
{'0': {'precision': 0.3587253677061814, 'recall': 0.05738251514258068, 'f1-score': 0.09893859113411418, 'support': 505363}, '1': {'precision': 0.3408386257938691, 'recall': 0.05781277169648878, 'f1-score': 0.09885742672627919, 'support': 471574}, '2': {'precision': 0.3419614358462063, 'recall': 0.903222627575749, 'f1-score': 0.4960990357775252, 'support': 497234}, 'accuracy': 0.3428197949898621, 'macro avg': {'precision': 0.3471751431154189, 'recall': 0.33947263813827283, 'f1-score': 0.2312983512126395, 'support': 1474171}, 'weighted avg': {'precision': 0.3473491302649215, 'recall': 0.3428197949898621, 'f1-score': 0.23287380048727702, 'support': 1474171}}
[[ 28999  28272 448092]
 [ 28172  27263 416139]
 [ 23668  24453 449113]]
Evaluating performance on  val set...
2129/2129 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992386
{'0': {'precision': 0.3384917710636207, 'recall': 0.03674235556361387, 'f1-score': 0.06628919986338075, 'support': 187522}, '1': {'precision': 0.32114588954847995, 'recall': 0.04382702410762508, 'f1-score': 0.07712829153435725, 'support': 162936}, '2': {'precision': 0.3591255464339462, 'recall': 0.9276278916706516, 'f1-score': 0.5177913089150997, 'support': 194481}, 'accuracy': 0.35680507359539326, 'macro avg': {'precision': 0.3395877356820156, 'recall': 0.3360657571139635, 'f1-score': 0.2204029334376126, 'support': 544939}, 'weighted avg': {'precision': 0.3406692784860024, 'recall': 0.35680507359539326, 'f1-score': 0.23066477201180394, 'support': 544939}}
[[  6890   7654 172978]
 [  6831   7141 148964]
 [  6634   7441 180406]]
training model: results/universal/W5/deepLOB_L2/h300
Epoch 1/50
9913/9913 - 416s - loss: 3.2171 - accuracy300: 0.4108 - val_loss: 3.3793 - val_accuracy300: 0.3171 - 416s/epoch - 42ms/step
Epoch 2/50
9913/9913 - 406s - loss: 3.1882 - accuracy300: 0.4259 - val_loss: 3.3991 - val_accuracy300: 0.3049 - 406s/epoch - 41ms/step
Epoch 3/50
9913/9913 - 407s - loss: 3.1735 - accuracy300: 0.4325 - val_loss: 3.4112 - val_accuracy300: 0.3083 - 407s/epoch - 41ms/step
Epoch 4/50
9913/9913 - 406s - loss: 3.1627 - accuracy300: 0.4372 - val_loss: 3.4162 - val_accuracy300: 0.3118 - 406s/epoch - 41ms/step
Epoch 5/50
9913/9913 - 411s - loss: 3.1530 - accuracy300: 0.4413 - val_loss: 3.4450 - val_accuracy300: 0.3145 - 411s/epoch - 42ms/step
Epoch 6/50
9913/9913 - 416s - loss: 3.1456 - accuracy300: 0.4442 - val_loss: 3.4757 - val_accuracy300: 0.3070 - 416s/epoch - 42ms/step
Epoch 7/50
9913/9913 - 412s - loss: 3.1405 - accuracy300: 0.4460 - val_loss: 3.5080 - val_accuracy300: 0.3149 - 412s/epoch - 42ms/step
Epoch 8/50
9913/9913 - 407s - loss: 3.1349 - accuracy300: 0.4478 - val_loss: 3.5179 - val_accuracy300: 0.3131 - 407s/epoch - 41ms/step
Epoch 9/50
9913/9913 - 411s - loss: 3.1301 - accuracy300: 0.4497 - val_loss: 3.5503 - val_accuracy300: 0.3059 - 411s/epoch - 41ms/step
Epoch 10/50
9913/9913 - 412s - loss: 3.1255 - accuracy300: 0.4513 - val_loss: 3.5551 - val_accuracy300: 0.3105 - 412s/epoch - 42ms/step
Epoch 11/50
9913/9913 - 420s - loss: 3.1225 - accuracy300: 0.4522 - val_loss: 3.6104 - val_accuracy300: 0.3036 - 420s/epoch - 42ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 699s - 699s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1306251
{'0': {'precision': 0.4183110675327859, 'recall': 0.0007035717863796912, 'f1-score': 0.0014047808235275474, 'support': 4850962}, '1': {'precision': 0.22801760245081215, 'recall': 0.39579354898434194, 'f1-score': 0.28934364477865254, 'support': 3024640}, '2': {'precision': 0.3831462150533492, 'recall': 0.5852090427378638, 'f1-score': 0.46309580690757274, 'support': 4962789}, 'accuracy': 0.3197297075622638, 'macro avg': {'precision': 0.34315829501231576, 'recall': 0.32723538783619516, 'f1-score': 0.2512814108365843, 'support': 12838391}, 'weighted avg': {'precision': 0.35988591368779765, 'recall': 0.3197297075622639, 'f1-score': 0.24771185708579763, 'support': 12838391}}
[[   3413 1997075 2850474]
 [   2196 1197133 1825311]
 [   2550 2055970 2904269]]
Evaluating performance on  train set...
9913/9913 - 146s - 146s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1237875
{'0': {'precision': 0.3256312852347319, 'recall': 0.10784304469128692, 'f1-score': 0.16202606162373595, 'support': 847324}, '1': {'precision': 0.31001492217950527, 'recall': 0.2650059116280349, 'f1-score': 0.2857489059186738, 'support': 836487}, '2': {'precision': 0.3339537762460976, 'recall': 0.6032978521416466, 'f1-score': 0.4299242376787046, 'support': 853222}, 'accuracy': 0.3262862564263058, 'macro avg': {'precision': 0.32319999455344495, 'recall': 0.32538226948698945, 'f1-score': 0.29256640174037146, 'support': 2537033}, 'weighted avg': {'precision': 0.3232813149122024, 'recall': 0.3262862564263058, 'f1-score': 0.29291484723500394, 'support': 2537033}}
[[ 91378 246713 509233]
 [ 97421 221674 517392]
 [ 91819 246656 514747]]
Evaluating performance on  val set...
3496/3496 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1267768
{'0': {'precision': 0.2866855032353253, 'recall': 0.09722858152038827, 'f1-score': 0.14520970148706963, 'support': 305764}, '1': {'precision': 0.27675916261299405, 'recall': 0.2489521440744323, 'f1-score': 0.26212023994270023, 'support': 282243}, '2': {'precision': 0.3431568943509089, 'recall': 0.6013807427533865, 'f1-score': 0.43697136016382565, 'support': 306212}, 'accuracy': 0.31775661219455187, 'macro avg': {'precision': 0.30220052006640946, 'recall': 0.3158538227827357, 'f1-score': 0.28143376719786517, 'support': 894219}, 'weighted avg': {'precision': 0.3028902332399622, 'recall': 0.31775661219455187, 'f1-score': 0.28201970231691037, 'support': 894219}}
[[ 29729  92571 183464]
 [ 42957  70265 169021]
 [ 31013  91049 184150]]
testing model out of sample: results/universal/W5/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 289s - 289s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.121432
{'0': {'precision': 0.2566619004289614, 'recall': 0.004143291361830308, 'f1-score': 0.00815493761958011, 'support': 1906214}, '1': {'precision': 0.2746135660191805, 'recall': 0.4363128651411474, 'f1-score': 0.3370740671461548, 'support': 1503357}, '2': {'precision': 0.36006097966855105, 'recall': 0.5439146525527865, 'f1-score': 0.4332914199755421, 'support': 1939273}, 'accuracy': 0.3213088659904832, 'macro avg': {'precision': 0.29711214870556435, 'recall': 0.32812360301858806, 'f1-score': 0.2595068082470923, 'support': 5348844}, 'weighted avg': {'precision': 0.2991957273120995, 'recall': 0.3213088659904832, 'f1-score': 0.25473879337524924, 'support': 5348844}}
[[   7898  859355 1038961]
 [  11682  655934  835741]
 [  11192  873282 1054799]]
Evaluating performance on  train set...
4957/4957 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1192579
{'0': {'precision': 0.3242164104611699, 'recall': 0.11780866154814584, 'f1-score': 0.17282051986213903, 'support': 427337}, '1': {'precision': 0.3361106631546883, 'recall': 0.35848849264934235, 'f1-score': 0.34693910578748177, 'support': 418602}, '2': {'precision': 0.338648920705738, 'recall': 0.5344183899338313, 'f1-score': 0.4145847834431285, 'support': 422405}, 'accuracy': 0.33598850154216836, 'macro avg': {'precision': 0.3329919981071987, 'recall': 0.33690518137710646, 'f1-score': 0.3114481363642498, 'support': 1268344}, 'weighted avg': {'precision': 0.33294852292897753, 'recall': 0.33598850154216836, 'f1-score': 0.31080266198087664, 'support': 1268344}}
[[ 50344 150677 226316]
 [ 54002 150064 214536]
 [ 50933 145731 225741]]
Evaluating performance on  val set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182132
{'0': {'precision': 0.3342976591578613, 'recall': 0.12867589644004154, 'f1-score': 0.18582508849514132, 'support': 147277}, '1': {'precision': 0.3272797422429198, 'recall': 0.33991830880957236, 'f1-score': 0.3334793209163422, 'support': 142243}, '2': {'precision': 0.33931505720863486, 'recall': 0.5376909970319885, 'f1-score': 0.41606702835467396, 'support': 145552}, 'accuracy': 0.33457450720800236, 'macro avg': {'precision': 0.33363081953647206, 'recall': 0.33542840076053415, 'f1-score': 0.31179047925538583, 'support': 435072}, 'weighted avg': {'precision': 0.33368176745569283, 'recall': 0.33457450720800236, 'f1-score': 0.31112608652012014, 'support': 435072}}
[[18951 50534 77792]
 [19299 48351 74593]
 [18439 48851 78262]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1296407
{'0': {'precision': 0.24671981695327302, 'recall': 0.07754281091285002, 'f1-score': 0.1179990937614883, 'support': 88996}, '1': {'precision': 0.27726853533800966, 'recall': 0.2399105307701608, 'f1-score': 0.25724027068370975, 'support': 82710}, '2': {'precision': 0.3598842725997334, 'recall': 0.620615576123838, 'f1-score': 0.45558351787234197, 'support': 99614}, 'accuracy': 0.32642636001769126, 'macro avg': {'precision': 0.29462420829700536, 'recall': 0.3126896392689496, 'f1-score': 0.27694096077251334, 'support': 271320}, 'weighted avg': {'precision': 0.29758023484494367, 'recall': 0.32642636001769126, 'f1-score': 0.284388495820369, 'support': 271320}}
[[ 6901 24045 58050]
 [10956 19843 51911]
 [10114 27678 61822]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1217718
{'0': {'precision': 0.3715277777777778, 'recall': 0.004439834024896266, 'f1-score': 0.008774807282269969, 'support': 24100}, '1': {'precision': 0.33242724076691677, 'recall': 0.40164652303380627, 'f1-score': 0.36377337537430343, 'support': 22836}, '2': {'precision': 0.3250299114620723, 'recall': 0.5975014296397307, 'f1-score': 0.42102816050090663, 'support': 22733}, 'accuracy': 0.3281516886994216, 'macro avg': {'precision': 0.34299497666892226, 'recall': 0.3345292622328111, 'f1-score': 0.26452544771916003, 'support': 69669}, 'weighted avg': {'precision': 0.3435392052686998, 'recall': 0.3281516886994216, 'f1-score': 0.2596540043379037, 'support': 69669}}
[[  107  9327 14666]
 [  123  9172 13541]
 [   58  9092 13583]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1286719
{'0': {'precision': 0.5454545454545454, 'recall': 0.001293103448275862, 'f1-score': 0.002580090303160611, 'support': 9280}, '1': {'precision': 0.29062788550323176, 'recall': 0.3737013950727219, 'f1-score': 0.3269705233086612, 'support': 6738}, '2': {'precision': 0.3571925387290547, 'recall': 0.6659200754450076, 'f1-score': 0.46497654127911764, 'support': 8483}, 'accuracy': 0.3338231092608465, 'macro avg': {'precision': 0.39775832322894394, 'recall': 0.3469715246553351, 'f1-score': 0.2648423849636465, 'support': 24501}, 'weighted avg': {'precision': 0.41019277500418466, 'recall': 0.3338231092608465, 'f1-score': 0.25188631581314413, 'support': 24501}}
[[  12 3316 5952]
 [   6 2518 4214]
 [   4 2830 5649]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1377952
{'0': {'precision': 0.3897058823529412, 'recall': 0.0002379669540229885, 'f1-score': 0.0004756434648382812, 'support': 222720}, '1': {'precision': 0.1917226991443594, 'recall': 0.35071297800469303, 'f1-score': 0.24791746413663626, 'support': 116343}, '2': {'precision': 0.3899210679081696, 'recall': 0.613278641610226, 'f1-score': 0.4767351118487262, 'support': 220143}, 'accuracy': 0.31449054552347433, 'macro avg': {'precision': 0.32378321646849006, 'recall': 0.32140986218964734, 'f1-score': 0.24170940648340022, 'support': 559206}, 'weighted avg': {'precision': 0.3486001254577159, 'recall': 0.31449054552347433, 'f1-score': 0.23944538250707534, 'support': 559206}}
[[    53  86945 135722]
 [    24  40803  75516]
 [    59  85075 135009]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1168636
{'0': {'precision': 0.35995992349029965, 'recall': 0.08094545603506544, 'f1-score': 0.1321694926591084, 'support': 48823}, '1': {'precision': 0.331646314550537, 'recall': 0.22927642954494598, 'f1-score': 0.2711199846050226, 'support': 49159}, '2': {'precision': 0.35205765793033, 'recall': 0.7061792103815288, 'f1-score': 0.4698679593021788, 'support': 52709}, 'accuracy': 0.3480300747888062, 'macro avg': {'precision': 0.3478879653237222, 'recall': 0.3388003653205134, 'f1-score': 0.29105247885543656, 'support': 150691}, 'weighted avg': {'precision': 0.3479592783471243, 'recall': 0.3480300747888062, 'f1-score': 0.29561930526808167, 'support': 150691}}
[[ 3952 11164 33707]
 [ 3090 11271 34798]
 [ 3937 11550 37222]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1263546
{'0': {'precision': 0.35845168476747424, 'recall': 0.3194837428642343, 'f1-score': 0.33784776902887137, 'support': 20145}, '1': {'precision': 0.24613097840342746, 'recall': 0.1860787942887361, 'f1-score': 0.21193299454169018, 'support': 15128}, '2': {'precision': 0.3838787789844438, 'recall': 0.4894970760233918, 'f1-score': 0.4303016594353396, 'support': 21375}, 'accuracy': 0.3480087558254484, 'macro avg': {'precision': 0.32948714738511514, 'recall': 0.3316865377254541, 'f1-score': 0.3266941410019671, 'support': 56648}, 'weighted avg': {'precision': 0.33805054956433245, 'recall': 0.3480087558254484, 'f1-score': 0.3391075345809858, 'support': 56648}}
[[ 6436  4455  9254]
 [ 4774  2815  7539]
 [ 6745  4167 10463]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
2341/2341 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128801
{'0': {'precision': 0.34854771784232363, 'recall': 0.0003659923403031637, 'f1-score': 0.0007312168667357261, 'support': 229513}, '1': {'precision': 0.20210686521732643, 'recall': 0.441471244886984, 'f1-score': 0.2772759607166801, 'support': 122726}, '2': {'precision': 0.4162330873866198, 'recall': 0.5576294101455611, 'f1-score': 0.4766664936592792, 'support': 247044}, 'accuracy': 0.3204212367112032, 'macro avg': {'precision': 0.32229589014875665, 'recall': 0.33315554912428275, 'f1-score': 0.25155789041423166, 'support': 599283}, 'weighted avg': {'precision': 0.3464604975381363, 'recall': 0.3204212367112032, 'f1-score': 0.2535603222370956, 'support': 599283}}
[[    84 104723 124706]
 [    45  54180  68501]
 [   112 109173 137759]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135494
{'0': {'precision': 0.2647058823529412, 'recall': 0.0004354241757178451, 'f1-score': 0.0008694182143115898, 'support': 41339}, '1': {'precision': 0.35439891940567314, 'recall': 0.4776561400101949, 'f1-score': 0.4068981203862617, 'support': 41197}, '2': {'precision': 0.3402848348282007, 'recall': 0.5641420060552789, 'f1-score': 0.42450966882550184, 'support': 40956}, 'accuracy': 0.3465892527451171, 'macro avg': {'precision': 0.3197965455289383, 'recall': 0.34741119008039717, 'f1-score': 0.27742573580869173, 'support': 123492}, 'weighted avg': {'precision': 0.31969321452861355, 'recall': 0.3465892527451171, 'f1-score': 0.2768206907454046, 'support': 123492}}
[[   18 18021 23300]
 [   25 19678 21494]
 [   25 17826 23105]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1192493
{'0': {'precision': 0.4293537787513691, 'recall': 0.051951494268106815, 'f1-score': 0.09268782881125494, 'support': 15091}, '1': {'precision': 0.28318646457525554, 'recall': 0.3426597287383775, 'f1-score': 0.31009726725335807, 'support': 11723}, '2': {'precision': 0.36354298356510745, 'recall': 0.6342270314976911, 'f1-score': 0.46216820270711434, 'support': 14509}, 'accuracy': 0.3388669748082182, 'macro avg': {'precision': 0.35869440896391064, 'recall': 0.34294608483472516, 'f1-score': 0.2883177662572424, 'support': 41323}, 'weighted avg': {'precision': 0.3647803389855232, 'recall': 0.3388669748082182, 'f1-score': 0.28409410598647933, 'support': 41323}}
[[ 784 5304 9003]
 [ 599 4017 7107]
 [ 443 4864 9202]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105783
{'0': {'precision': 0.2863247863247863, 'recall': 0.000835687602512052, 'f1-score': 0.0016665112085315422, 'support': 160347}, '1': {'precision': 0.3929771834041721, 'recall': 0.4359620610909163, 'f1-score': 0.4133551257859429, 'support': 202747}, '2': {'precision': 0.3009761998057822, 'recall': 0.5670195079052271, 'f1-score': 0.39322631480541675, 'support': 155783}, 'accuracy': 0.34084378378690905, 'macro avg': {'precision': 0.32675938984491354, 'recall': 0.3346057521995518, 'f1-score': 0.2694159839332971, 'support': 518877}, 'weighted avg': {'precision': 0.33239715934761105, 'recall': 0.34084378378690905, 'f1-score': 0.2800889358360637, 'support': 518877}}
[[   134  69198  91015]
 [   219  88390 114138]
 [   115  67336  88332]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1208593
{'0': {'precision': 0.30295352540900533, 'recall': 0.1512140482728718, 'f1-score': 0.2017353579175705, 'support': 27676}, '1': {'precision': 0.31499468030339434, 'recall': 0.3292201736136021, 'f1-score': 0.3219503639393142, 'support': 27878}, '2': {'precision': 0.34781143970931494, 'recall': 0.49920563652690475, 'f1-score': 0.4099785849016466, 'support': 28954}, 'accuracy': 0.32916410280683484, 'macro avg': {'precision': 0.32191988180723824, 'recall': 0.32654661947112623, 'f1-score': 0.3112214355861771, 'support': 84508}, 'weighted avg': {'precision': 0.32229488204739387, 'recall': 0.32916410280683484, 'f1-score': 0.3127405684535092, 'support': 84508}}
[[ 4185  9913 13578]
 [ 5175  9178 13525]
 [ 4454 10046 14454]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1198597
{'0': {'precision': 0.38461538461538464, 'recall': 0.00041918175720992624, 'f1-score': 0.0008374507997655138, 'support': 11928}, '1': {'precision': 0.3036409116175653, 'recall': 0.3958333333333333, 'f1-score': 0.34366152878263606, 'support': 11040}, '2': {'precision': 0.33738916256157636, 'recall': 0.5835392348981853, 'f1-score': 0.42756812435621316, 'support': 11737}, 'accuracy': 0.32341161215963116, 'macro avg': {'precision': 0.34188181959817543, 'recall': 0.32659724999624284, 'f1-score': 0.25735570131287155, 'support': 34705}, 'weighted avg': {'precision': 0.34288501866980114, 'recall': 0.32341161215963116, 'f1-score': 0.2542106171003826, 'support': 34705}}
[[   5 5137 6786]
 [   5 4370 6665]
 [   3 4885 6849]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209959
{'0': {'precision': 0.3723849372384937, 'recall': 0.0006625277293909211, 'f1-score': 0.0013227021765138624, 'support': 268668}, '1': {'precision': 0.2819766068982888, 'recall': 0.512344766762806, 'f1-score': 0.3637551340913822, 'support': 209765}, '2': {'precision': 0.35245410847641806, 'recall': 0.4817467083451738, 'f1-score': 0.4070808926996304, 'support': 263925}, 'accuracy': 0.31628270995934576, 'macro avg': {'precision': 0.33560521753773354, 'recall': 0.3315846676124569, 'f1-score': 0.2573862429891755, 'support': 742358}, 'weighted avg': {'precision': 0.33975277405732784, 'recall': 0.31628270995934576, 'f1-score': 0.24798990252248698, 'support': 742358}}
[[   178 137060 131430]
 [   126 107472 102167]
 [   174 136606 127145]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1204644
{'0': {'precision': 0.3293149206063605, 'recall': 0.12312478977463841, 'f1-score': 0.17923639078968306, 'support': 59460}, '1': {'precision': 0.3499698766528205, 'recall': 0.37004006504283105, 'f1-score': 0.3597252438338751, 'support': 59653}, '2': {'precision': 0.3303357638926509, 'recall': 0.5212775051719126, 'f1-score': 0.40440093907922486, 'support': 58489}, 'accuracy': 0.3371808876026171, 'macro avg': {'precision': 0.3365401870506106, 'recall': 0.33814745332979407, 'f1-score': 0.31445419123426105, 'support': 177602}, 'weighted avg': {'precision': 0.33658870241068317, 'recall': 0.3371808876026171, 'f1-score': 0.31401162313814873, 'support': 177602}}
[[ 7321 20747 31392]
 [ 7163 22074 30416]
 [ 7747 20253 30489]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126419
{'0': {'precision': 0.29411764705882354, 'recall': 0.0005119541289100496, 'f1-score': 0.0010221290949046866, 'support': 19533}, '1': {'precision': 0.3671622974526308, 'recall': 0.45179540995574213, 'f1-score': 0.40510575624923295, 'support': 21917}, '2': {'precision': 0.3209898417198205, 'recall': 0.5598187155585311, 'f1-score': 0.4080253748991198, 'support': 19417}, 'accuracy': 0.34143296038904497, 'macro avg': {'precision': 0.3274232620770916, 'recall': 0.3373753598810611, 'f1-score': 0.2713844200810858, 'support': 60867}, 'weighted avg': {'precision': 0.32899199615461683, 'recall': 0.34143296038904497, 'f1-score': 0.27636152285707233, 'support': 60867}}
[[   10  8531 10992]
 [   13  9902 12002]
 [   11  8536 10870]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
7167/7167 - 106s - 106s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1214293
{'0': {'precision': 0.4657253473012981, 'recall': 0.003304489743154697, 'f1-score': 0.0065624167664132625, 'support': 618855}, '1': {'precision': 0.29357032497185975, 'recall': 0.36864347570610134, 'f1-score': 0.3268514937351042, 'support': 558206}, '2': {'precision': 0.3546195760462688, 'recall': 0.6090340831318155, 'f1-score': 0.44824280238221964, 'support': 657510}, 'accuracy': 0.33155980335457175, 'macro avg': {'precision': 0.3713050827731423, 'recall': 0.3269940161936905, 'f1-score': 0.26055223762791235, 'support': 1834571}, 'weighted avg': {'precision': 0.37352334364359246, 'recall': 0.33155980335457175, 'f1-score': 0.2623151539701704, 'support': 1834571}}
[[  2045 239231 377579]
 [  1225 205779 351202]
 [  1121 255943 400446]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.116825
{'0': {'precision': 0.3070457976849522, 'recall': 0.044682222319872275, 'f1-score': 0.07801191724420121, 'support': 136542}, '1': {'precision': 0.3304310339937719, 'recall': 0.43529007382610513, 'f1-score': 0.3756807738814994, 'support': 133828}, '2': {'precision': 0.3259200513788607, 'recall': 0.5100701292174615, 'f1-score': 0.39771300328622194, 'support': 131329}, 'accuracy': 0.3269662110186981, 'macro avg': {'precision': 0.32113229435252827, 'recall': 0.330014141787813, 'f1-score': 0.28380189813730755, 'support': 401699}, 'weighted avg': {'precision': 0.32100733671816867, 'recall': 0.3269662110186981, 'f1-score': 0.2817028691133094, 'support': 401699}}
[[ 6101 60474 69967]
 [ 6996 58254 68578]
 [ 6773 57569 66987]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1250808
{'0': {'precision': 0.3389830508474576, 'recall': 0.0004526935264825713, 'f1-score': 0.0009041795700626144, 'support': 44180}, '1': {'precision': 0.3281903426063015, 'recall': 0.31183671454662126, 'f1-score': 0.31980459901033953, 'support': 40518}, '2': {'precision': 0.3275415175704193, 'recall': 0.6956786514664328, 'f1-score': 0.445385359159103, 'support': 41052}, 'accuracy': 0.3277455268389662, 'macro avg': {'precision': 0.33157163700805947, 'recall': 0.3359893531798455, 'f1-score': 0.25536471257983506, 'support': 125750}, 'weighted avg': {'precision': 0.3317703528227726, 'recall': 0.3277455268389662, 'f1-score': 0.24876142473404214, 'support': 125750}}
[[   20 13389 30771]
 [   21 12635 27862]
 [   18 12475 28559]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
6357/6357 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1184158
{'0': {'precision': 0.3416422287390029, 'recall': 0.000410040898499919, 'f1-score': 0.0008190987101831897, 'support': 568236}, '1': {'precision': 0.30505730602786046, 'recall': 0.4548522389204419, 'f1-score': 0.36519082979869794, 'support': 495462}, '2': {'precision': 0.34569138953785705, 'recall': 0.5446278513002444, 'f1-score': 0.4229340444664951, 'support': 563471}, 'accuracy': 0.32724136214492777, 'macro avg': {'precision': 0.33079697476824016, 'recall': 0.3332967103730621, 'f1-score': 0.2629813243251254, 'support': 1627169}, 'weighted avg': {'precision': 0.33190454673312836, 'recall': 0.32724136214492777, 'f1-score': 0.2579416700158266, 'support': 1627169}}
[[   233 257054 310949]
 [   197 225362 269903]
 [   252 256337 306882]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1207187
{'0': {'precision': 0.33018357407484494, 'recall': 0.16126649362619191, 'f1-score': 0.21669565534135304, 'support': 147557}, '1': {'precision': 0.3225201459162012, 'recall': 0.3304986307541764, 'f1-score': 0.3264606483735032, 'support': 142049}, '2': {'precision': 0.3353383596741756, 'recall': 0.5008641264093491, 'f1-score': 0.40171838128922605, 'support': 145812}, 'accuracy': 0.330199945799209, 'macro avg': {'precision': 0.32934735988840724, 'recall': 0.3308764169299058, 'f1-score': 0.3149582283346941, 'support': 435418}, 'weighted avg': {'precision': 0.32940971376429834, 'recall': 0.330199945799209, 'f1-score': 0.31446501997748466, 'support': 435418}}
[[23796 49916 73845]
 [24193 46947 70909]
 [24080 48700 73032]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1156504
{'0': {'precision': 0.22727272727272727, 'recall': 0.00020451988955925963, 'f1-score': 0.0004086720202701322, 'support': 48895}, '1': {'precision': 0.33369326972666324, 'recall': 0.43672221050411303, 'f1-score': 0.3783186244952402, 'support': 47410}, '2': {'precision': 0.3336830675759757, 'recall': 0.5727478326422918, 'f1-score': 0.42168962619776285, 'support': 47754}, 'accuracy': 0.3336549608146662, 'macro avg': {'precision': 0.2982163548584554, 'recall': 0.3365581876786547, 'f1-score': 0.2668056409044244, 'support': 144059}, 'weighted avg': {'precision': 0.2975697396675268, 'recall': 0.3336549608146662, 'f1-score': 0.2644293963945218, 'support': 144059}}
[[   10 20952 27933]
 [   22 20705 26683]
 [   12 20391 27351]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
7459/7459 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1204287
{'0': {'precision': 0.30257801899592945, 'recall': 0.0003323918049769338, 'f1-score': 0.0006640541248779093, 'support': 670895}, '1': {'precision': 0.2880030602419174, 'recall': 0.3903284051701021, 'f1-score': 0.3314479157178857, 'support': 559370}, '2': {'precision': 0.35194679434355236, 'recall': 0.5963024274432757, 'f1-score': 0.44264044298919314, 'support': 678986}, 'accuracy': 0.32653747464319777, 'macro avg': {'precision': 0.3141759578604664, 'recall': 0.3289877414727849, 'f1-score': 0.2582508042773189, 'support': 1909251}, 'weighted avg': {'precision': 0.3158648590289839, 'recall': 0.32653747464319777, 'f1-score': 0.2547565485264557, 'support': 1909251}}
[[   223 265962 404710]
 [   219 218338 340813]
 [   295 273810 404881]]
Evaluating performance on  train set...
1664/1664 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1265999
{'0': {'precision': 0.4002419709634844, 'recall': 0.05017960686436062, 'f1-score': 0.08917860840690343, 'support': 145039}, '1': {'precision': 0.32764020154995277, 'recall': 0.2528022620060878, 'f1-score': 0.2853967077753665, 'support': 138638}, '2': {'precision': 0.3338608015744262, 'recall': 0.7058178598034943, 'f1-score': 0.453303362266246, 'support': 142286}, 'accuracy': 0.3351323941281285, 'macro avg': {'precision': 0.35391432469595446, 'recall': 0.33626657622464756, 'f1-score': 0.2759595594828386, 'support': 425963}, 'weighted avg': {'precision': 0.35443875524839946, 'recall': 0.3351323941281285, 'f1-score': 0.2746715727908415, 'support': 425963}}
[[  7278  36087 101674]
 [  4884  35048  98706]
 [  6022  35836 100428]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1329092
{'0': {'precision': 0.3027315484804631, 'recall': 0.07358955191064596, 'f1-score': 0.11839824542785382, 'support': 45482}, '1': {'precision': 0.26995090288757595, 'recall': 0.15795880605735987, 'f1-score': 0.19929962523806596, 'support': 41074}, '2': {'precision': 0.34555960694641863, 'recall': 0.7354011398509426, 'f1-score': 0.4701834540944319, 'support': 45620}, 'accuracy': 0.32822902796271636, 'macro avg': {'precision': 0.30608068610481926, 'recall': 0.3223164992729828, 'f1-score': 0.2626271082534506, 'support': 132176}, 'weighted avg': {'precision': 0.3073268138095292, 'recall': 0.32822902796271636, 'f1-score': 0.2649557482550989, 'support': 132176}}
[[ 3347  8949 33186]
 [ 4235  6488 30351]
 [ 3474  8597 33549]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
8238/8238 - 114s - 114s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1207362
{'0': {'precision': 0.3776077885952712, 'recall': 0.00072322759293075, 'f1-score': 0.0014436901038100921, 'support': 750801}, '1': {'precision': 0.2680230139277808, 'recall': 0.41955545357300733, 'f1-score': 0.3270914448069031, 'support': 592694}, '2': {'precision': 0.35785720947189037, 'recall': 0.5515924199477535, 'f1-score': 0.4340896247202023, 'support': 765219}, 'accuracy': 0.31834568367260807, 'macro avg': {'precision': 0.3344960039983141, 'recall': 0.32395703370456386, 'f1-score': 0.25420825321030516, 'support': 2108714}, 'weighted avg': {'precision': 0.33963973942265324, 'recall': 0.31834568367260807, 'f1-score': 0.2499735333007614, 'support': 2108714}}
[[   543 336526 413732]
 [   357 248668 343669]
 [   538 342592 422089]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1188713
{'0': {'precision': 0.31879664563322735, 'recall': 0.12493462722993783, 'f1-score': 0.1795173904572823, 'support': 154881}, '1': {'precision': 0.3364909497555394, 'recall': 0.33856227962869684, 'f1-score': 0.33752343686312875, 'support': 152867}, '2': {'precision': 0.3434655856059566, 'recall': 0.5508661723278179, 'f1-score': 0.4231171951362066, 'support': 154415}, 'accuracy': 0.3379045921027862, 'macro avg': {'precision': 0.33291772699824107, 'recall': 0.33812102639548414, 'f1-score': 0.3133860074855392, 'support': 462163}, 'weighted avg': {'precision': 0.33289152028601104, 'recall': 0.3379045921027862, 'f1-score': 0.31317017991775103, 'support': 462163}}
[[19350 51796 83735]
 [22251 51755 78861]
 [19096 50257 85062]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1201228
{'0': {'precision': 0.33136473341622175, 'recall': 0.3326663974448401, 'f1-score': 0.332014289640011, 'support': 54478}, '1': {'precision': 0.32763328460711033, 'recall': 0.21814342117344596, 'f1-score': 0.26190581179998235, 'support': 54455}, '2': {'precision': 0.3488612977525793, 'recall': 0.4621314701475022, 'f1-score': 0.3975862443888725, 'support': 55389}, 'accuracy': 0.338353963559353, 'macro avg': {'precision': 0.33595310525863714, 'recall': 0.33764709625526274, 'f1-score': 0.3305021152762886, 'support': 164322}, 'weighted avg': {'precision': 0.3360258327037569, 'recall': 0.338353963559353, 'f1-score': 0.33088363057309317, 'support': 164322}}
[[18123 12517 23838]
 [18638 11879 23938]
 [17931 11861 25597]]
testing model on single stock: results/universal/W5/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
31315/31315 - 435s - 435s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1362922
{'0': {'precision': 0.4003466204506066, 'recall': 0.0002907356335220703, 'f1-score': 0.0005810493033539563, 'support': 3178145}, '1': {'precision': 0.19188957134675722, 'recall': 0.4049077629734492, 'f1-score': 0.2603817832412153, 'support': 1587974}, '2': {'precision': 0.40229760339118764, 'recall': 0.5771862069729357, 'f1-score': 0.47412856714669205, 'support': 3250367}, 'accuracy': 0.3143489553901797, 'macro avg': {'precision': 0.33151126506285045, 'recall': 0.3274615685266356, 'f1-score': 0.2450304665637538, 'support': 8016486}, 'weighted avg': {'precision': 0.35984471431292875, 'recall': 0.3143489553901797, 'f1-score': 0.24404932650163497, 'support': 8016486}}
[[    924 1334449 1842772]
 [    449  642983  944542]
 [    935 1373365 1876067]]
Evaluating performance on  train set...
5759/5759 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1258622
{'0': {'precision': 0.3198358400544746, 'recall': 0.14208861018224037, 'f1-score': 0.19676390793568577, 'support': 489244}, '1': {'precision': 0.29264983978924347, 'recall': 0.2214939299853794, 'f1-score': 0.25214800581139163, 'support': 486984}, '2': {'precision': 0.3330980381560964, 'recall': 0.594189306428032, 'f1-score': 0.42688664613076127, 'support': 497944}, 'accuracy': 0.32102970345387105, 'macro avg': {'precision': 0.31519457266660483, 'recall': 0.3192572821985506, 'f1-score': 0.29193285329261287, 'support': 1474172}, 'weighted avg': {'precision': 0.31533479459868696, 'recall': 0.32102970345387105, 'f1-score': 0.29279029174145027, 'support': 1474172}}
[[ 69516 128939 290789]
 [ 77536 107864 301584]
 [ 70297 131774 295873]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1261061
{'0': {'precision': 0.2668640956235092, 'recall': 0.1082166397687321, 'f1-score': 0.15398890413871757, 'support': 184029}, '1': {'precision': 0.26407174088483637, 'recall': 0.2512966879294831, 'f1-score': 0.25752587915718383, 'support': 174483}, '2': {'precision': 0.3432750959667666, 'recall': 0.5602645525350269, 'f1-score': 0.42571428571428577, 'support': 186428}, 'accuracy': 0.3086780195984879, 'macro avg': {'precision': 0.2914036441583707, 'recall': 0.30659262674441407, 'f1-score': 0.27907635633672906, 'support': 544940}, 'weighted avg': {'precision': 0.29211078615847624, 'recall': 0.3086780195984879, 'f1-score': 0.2800994143756558, 'support': 544940}}
[[ 19915  61055 103059]
 [ 33872  43847  96764]
 [ 20839  61140 104449]]
training model: results/universal/W5/deepLOB_L2/h500
Epoch 1/50
9913/9913 - 410s - loss: 3.1948 - accuracy500: 0.4247 - val_loss: 3.3980 - val_accuracy500: 0.3493 - 410s/epoch - 41ms/step
Epoch 2/50
9913/9913 - 407s - loss: 3.1681 - accuracy500: 0.4364 - val_loss: 3.4254 - val_accuracy500: 0.3388 - 407s/epoch - 41ms/step
Epoch 3/50
9913/9913 - 404s - loss: 3.1506 - accuracy500: 0.4448 - val_loss: 3.4496 - val_accuracy500: 0.3290 - 404s/epoch - 41ms/step
Epoch 4/50
9913/9913 - 405s - loss: 3.1378 - accuracy500: 0.4493 - val_loss: 3.4605 - val_accuracy500: 0.3408 - 405s/epoch - 41ms/step
Epoch 5/50
9913/9913 - 406s - loss: 3.1259 - accuracy500: 0.4543 - val_loss: 3.4610 - val_accuracy500: 0.3398 - 406s/epoch - 41ms/step
Epoch 6/50
9913/9913 - 406s - loss: 3.1183 - accuracy500: 0.4568 - val_loss: 3.4554 - val_accuracy500: 0.3195 - 406s/epoch - 41ms/step
Epoch 7/50
9913/9913 - 405s - loss: 3.1108 - accuracy500: 0.4593 - val_loss: 3.4716 - val_accuracy500: 0.3182 - 405s/epoch - 41ms/step
Epoch 8/50
9913/9913 - 405s - loss: 3.1053 - accuracy500: 0.4615 - val_loss: 3.4816 - val_accuracy500: 0.3158 - 405s/epoch - 41ms/step
Epoch 9/50
9913/9913 - 404s - loss: 3.0993 - accuracy500: 0.4637 - val_loss: 3.5366 - val_accuracy500: 0.3220 - 404s/epoch - 41ms/step
Epoch 10/50
9913/9913 - 405s - loss: 3.0943 - accuracy500: 0.4651 - val_loss: 3.4904 - val_accuracy500: 0.3294 - 405s/epoch - 41ms/step
Epoch 11/50
9913/9913 - 405s - loss: 3.0901 - accuracy500: 0.4665 - val_loss: 3.4877 - val_accuracy500: 0.3239 - 405s/epoch - 41ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 672s - 672s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098868
{'0': {'precision': 0.41462222997731635, 'recall': 0.0024703052919756974, 'f1-score': 0.004911348932305565, 'support': 4809527}, '1': {'precision': 0.24590465027013417, 'recall': 0.037964286635955566, 'f1-score': 0.06577397815850634, 'support': 3138713}, '2': {'precision': 0.3808505721872053, 'recall': 0.9598977618482538, 'f1-score': 0.5453336805435951, 'support': 4890151}, 'accuracy': 0.3758325322853931, 'macro avg': {'precision': 0.3471258174782186, 'recall': 0.333444117925395, 'f1-score': 0.20533966921146898, 'support': 12838391}, 'weighted avg': {'precision': 0.36051073213701545, 'recall': 0.3758325322853931, 'f1-score': 0.22563816204445766, 'support': 12838391}}
[[  11881  179460 4618186]
 [   6623  119159 3012931]
 [  10151  185955 4694045]]
Evaluating performance on  train set...
9913/9913 - 139s - 139s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1387266
{'0': {'precision': 0.32977352332844834, 'recall': 0.07443278387784283, 'f1-score': 0.12145263917425145, 'support': 852541}, '1': {'precision': 0.3150006169351958, 'recall': 0.05832459574631819, 'f1-score': 0.09842508900281338, 'support': 831656}, '2': {'precision': 0.3365394271941277, 'recall': 0.864445215727291, 'f1-score': 0.48446897211591033, 'support': 852836}, 'accuracy': 0.33471894137758557, 'macro avg': {'precision': 0.327104522485924, 'recall': 0.33240086511715067, 'f1-score': 0.23478223343099172, 'support': 2537033}, 'weighted avg': {'precision': 0.32720525959273966, 'recall': 0.33471894137758557, 'f1-score': 0.23593376616599931, 'support': 2537033}}
[[ 63457  53068 736016]
 [ 65776  48506 717374]
 [ 63193  52413 737230]]
Evaluating performance on  val set...
3496/3496 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.132704
{'0': {'precision': 0.2972639211465473, 'recall': 0.08305030560663947, 'f1-score': 0.12982874560235927, 'support': 315929}, '1': {'precision': 0.3051516063250092, 'recall': 0.03462270806624134, 'f1-score': 0.06218936826148421, 'support': 263642}, '2': {'precision': 0.3566912057481499, 'recall': 0.8797354504080751, 'f1-score': 0.507581904649263, 'support': 314648}, 'accuracy': 0.3491012827953779, 'macro avg': {'precision': 0.31970224440656886, 'recall': 0.33246948802698534, 'f1-score': 0.2332000061710355, 'support': 894219}, 'weighted avg': {'precision': 0.3205000650230978, 'recall': 0.3491012827953779, 'f1-score': 0.24280632186375295, 'support': 894219}}
[[ 26238  10329 279362]
 [ 34642   9128 219872]
 [ 27385  10456 276807]]
testing model out of sample: results/universal/W5/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 291s - 291s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10944
{'0': {'precision': 0.28440126050420167, 'recall': 0.004488372659262371, 'f1-score': 0.008837276906953082, 'support': 1930321}, '1': {'precision': 0.28166747950063126, 'recall': 0.04248527552488706, 'f1-score': 0.07383383474277576, 'support': 1454551}, '2': {'precision': 0.3670153440401743, 'recall': 0.9528674543221594, 'f1-score': 0.5299212581702701, 'support': 1963972}, 'accuracy': 0.36304405213537727, 'macro avg': {'precision': 0.3110280280150024, 'recall': 0.33328036750210294, 'f1-score': 0.20419745660666633, 'support': 5348844}, 'weighted avg': {'precision': 0.31399182679811244, 'recall': 0.36304405213537727, 'f1-score': 0.2178422800527418, 'support': 5348844}}
[[   8664   77426 1844231]
 [   9407   61797 1383347]
 [  12393   80174 1871405]]
Evaluating performance on  train set...
4957/4957 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1245465
{'0': {'precision': 0.3064487141084343, 'recall': 0.08385576817241872, 'f1-score': 0.13167920684303816, 'support': 427007}, '1': {'precision': 0.3561445498330526, 'recall': 0.05742791731485298, 'f1-score': 0.09890716324031126, 'support': 419761}, '2': {'precision': 0.3356778337222381, 'recall': 0.862980814847145, 'f1-score': 0.48334616501116984, 'support': 421576}, 'accuracy': 0.3340773481011461, 'macro avg': {'precision': 0.332757032554575, 'recall': 0.33475483344480556, 'f1-score': 0.23797751169817308, 'support': 1268344}, 'weighted avg': {'precision': 0.33261091381916774, 'recall': 0.3340773481011461, 'f1-score': 0.23772135610377815, 'support': 1268344}}
[[ 35807  22091 369109]
 [ 44763  24106 350892]
 [ 36275  21489 363812]]
Evaluating performance on  val set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162615
{'0': {'precision': 0.34023845007451564, 'recall': 0.1053724729991692, 'f1-score': 0.16091062870031012, 'support': 151662}, '1': {'precision': 0.3588889485843228, 'recall': 0.05005957689165998, 'f1-score': 0.08786352216975549, 'support': 133441}, '2': {'precision': 0.34710099624075413, 'recall': 0.8551767365255486, 'f1-score': 0.4937839055323048, 'support': 149969}, 'accuracy': 0.3468644270373639, 'macro avg': {'precision': 0.34874279829986415, 'recall': 0.3368695954721259, 'f1-score': 0.24751935213412346, 'support': 435072}, 'weighted avg': {'precision': 0.34832426198071004, 'recall': 0.3468644270373639, 'f1-score': 0.25324751434377524, 'support': 435072}}
[[ 15981   6062 129619]
 [ 15141   6680 111620]
 [ 15848   5871 128250]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1381109
{'0': {'precision': 0.24806279058141278, 'recall': 0.05818275623512306, 'f1-score': 0.0942575461124936, 'support': 85283}, '1': {'precision': 0.34772816294555425, 'recall': 0.039932078357285836, 'f1-score': 0.071637515382598, 'support': 88926}, '2': {'precision': 0.3530246158312768, 'recall': 0.8764815520383891, 'f1-score': 0.5033233200085152, 'support': 97111}, 'accuracy': 0.3450869821612856, 'macro avg': {'precision': 0.31627185645274797, 'recall': 0.32486546221026597, 'f1-score': 0.2230727938345356, 'support': 271320}, 'weighted avg': {'precision': 0.31829642877503356, 'recall': 0.3450869821612856, 'f1-score': 0.23325679982077113, 'support': 271320}}
[[ 4962  3124 77197]
 [ 6583  3551 78792]
 [ 8458  3537 85116]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1346631
{'0': {'precision': 0.43037974683544306, 'recall': 0.007154279942765761, 'f1-score': 0.014074595355383534, 'support': 23762}, '1': {'precision': 0.3562386980108499, 'recall': 0.04124099815776252, 'f1-score': 0.0739239746331945, 'support': 23884}, '2': {'precision': 0.3169345502112496, 'recall': 0.9571357217454479, 'f1-score': 0.4761894004427777, 'support': 22023}, 'accuracy': 0.31913763653848914, 'macro avg': {'precision': 0.3678509983525142, 'recall': 0.33517699994865874, 'f1-score': 0.1880626568104519, 'support': 69669}, 'weighted avg': {'precision': 0.3691015832995635, 'recall': 0.31913763653848914, 'f1-score': 0.1806708853424785, 'support': 69669}}
[[  170   910 22682]
 [  151   985 22748]
 [   74   870 21079]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.122671
{'0': {'precision': 0.42105263157894735, 'recall': 0.0026702269692923898, 'f1-score': 0.005306799336650083, 'support': 8988}, '1': {'precision': 0.30198019801980197, 'recall': 0.033084745762711865, 'f1-score': 0.059635830380056216, 'support': 7375}, '2': {'precision': 0.33317820274158066, 'recall': 0.9676824772671418, 'f1-score': 0.4956882986089255, 'support': 8138}, 'accuracy': 0.332353781478307, 'macro avg': {'precision': 0.35207034411344335, 'recall': 0.33447914999971534, 'f1-score': 0.18687697610854392, 'support': 24501}, 'weighted avg': {'precision': 0.3560233960629608, 'recall': 0.332353781478307, 'f1-score': 0.18454035082527903, 'support': 24501}}
[[  24  318 8646]
 [  16  244 7115]
 [  17  246 7875]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1145374
{'0': {'precision': 0.37624660018132366, 'recall': 0.0019427747504821827, 'f1-score': 0.003865589269496775, 'support': 213612}, '1': {'precision': 0.2337655784852919, 'recall': 0.033858543929140415, 'f1-score': 0.059149840730787155, 'support': 136834}, '2': {'precision': 0.372808777522646, 'recall': 0.9612808967235102, 'f1-score': 0.5372561723271989, 'support': 208760}, 'accuracy': 0.36788768360854496, 'macro avg': {'precision': 0.3276069853964205, 'recall': 0.3323607384677109, 'f1-score': 0.20009053410916097, 'support': 559206}, 'weighted avg': {'precision': 0.34009904815044356, 'recall': 0.36788768360854496, 'f1-score': 0.21651599606695623, 'support': 559206}}
[[   415   7529 205668]
 [   262   4633 131939]
 [   426   7657 200677]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1319883
{'0': {'precision': 0.3308242378622507, 'recall': 0.07169365034052445, 'f1-score': 0.11784816490698845, 'support': 49042}, '1': {'precision': 0.33293160590539317, 'recall': 0.023243584350021034, 'f1-score': 0.043453469395780486, 'support': 47540}, '2': {'precision': 0.35970865266483354, 'recall': 0.9090539466632168, 'f1-score': 0.5154543025260279, 'support': 54109}, 'accuracy': 0.35708171025475977, 'macro avg': {'precision': 0.34115483214415915, 'recall': 0.33466372711792075, 'f1-score': 0.22558531227626558, 'support': 150691}, 'weighted avg': {'precision': 0.3418606705445207, 'recall': 0.35708171025475977, 'f1-score': 0.2371475701523301, 'support': 150691}}
[[ 3516  1042 44484]
 [ 3363  1105 43072]
 [ 3749  1172 49188]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1236062
{'0': {'precision': 0.3545633172979199, 'recall': 0.26146697311881684, 'f1-score': 0.3009806459034308, 'support': 20014}, '1': {'precision': 0.2802244039270687, 'recall': 0.062468734367183594, 'f1-score': 0.10216290842153705, 'support': 15992}, '2': {'precision': 0.3647322826427304, 'recall': 0.6771630655944192, 'f1-score': 0.47410372078825086, 'support': 20642}, 'accuracy': 0.35676458127383137, 'macro avg': {'precision': 0.333173334622573, 'recall': 0.3336995910268065, 'f1-score': 0.2924157583710729, 'support': 56648}, 'weighted avg': {'precision': 0.3372825638736318, 'recall': 0.35676458127383137, 'f1-score': 0.30793787747315987, 'support': 56648}}
[[ 5233  1319 13462]
 [ 4109   999 10884]
 [ 5417  1247 13978]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
2341/2341 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1059909
{'0': {'precision': 0.3617407071622847, 'recall': 0.0018497828011923914, 'f1-score': 0.003680743897714064, 'support': 215701}, '1': {'precision': 0.26100297248058296, 'recall': 0.03557611877875366, 'f1-score': 0.06261717716612415, 'support': 153024}, '2': {'precision': 0.3846640176539262, 'recall': 0.9632066551583549, 'f1-score': 0.5497722434024855, 'support': 230558}, 'accuracy': 0.3803178131200117, 'macro avg': {'precision': 0.3358025657655979, 'recall': 0.33354418557943366, 'f1-score': 0.2053567214887746, 'support': 599283}, 'weighted avg': {'precision': 0.3448369430114564, 'recall': 0.3803178131200117, 'f1-score': 0.22882387778819036, 'support': 599283}}
[[   399   7340 207962]
 [   295   5444 147285]
 [   409   8074 222075]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113003
{'0': {'precision': 0.36531365313653136, 'recall': 0.002349479080143342, 'f1-score': 0.00466893039049236, 'support': 42137}, '1': {'precision': 0.34314903846153844, 'recall': 0.04335172343979349, 'f1-score': 0.07697838493686245, 'support': 39514}, '2': {'precision': 0.3392484077510594, 'recall': 0.9586051958605196, 'f1-score': 0.5011432498282001, 'support': 41841}, 'accuracy': 0.33946328507109774, 'macro avg': {'precision': 0.3492370331163764, 'recall': 0.3347687994601522, 'f1-score': 0.19426352171851832, 'support': 123492}, 'weighted avg': {'precision': 0.3493902854978082, 'recall': 0.33946328507109774, 'f1-score': 0.19601912138698122, 'support': 123492}}
[[   99  1640 40398]
 [   79  1713 37722]
 [   93  1639 40109]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015354
{'0': {'precision': 0.45005945303210465, 'recall': 0.0498157409844696, 'f1-score': 0.08970257139471502, 'support': 15196}, '1': {'precision': 0.27970897332255457, 'recall': 0.029781373730418316, 'f1-score': 0.05383119408790353, 'support': 11618}, '2': {'precision': 0.3558743880845745, 'recall': 0.9419670549314219, 'f1-score': 0.5165838262808761, 'support': 14509}, 'accuracy': 0.3574280666940929, 'macro avg': {'precision': 0.36188093814641126, 'recall': 0.3405213898821033, 'f1-score': 0.2200391972544982, 'support': 41323}, 'weighted avg': {'precision': 0.3690957528992666, 'recall': 0.3574280666940929, 'f1-score': 0.2295004192177863, 'support': 41323}}
[[  757   459 13980]
 [  515   346 10757]
 [  410   432 13667]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1241922
{'0': {'precision': 0.3150684931506849, 'recall': 0.0023514527249375397, 'f1-score': 0.004668066240874755, 'support': 156499}, '1': {'precision': 0.4099866250557289, 'recall': 0.044291604053481294, 'f1-score': 0.0799464473558382, 'support': 207624}, '2': {'precision': 0.29851457461350067, 'recall': 0.9553743360430101, 'f1-score': 0.45489382846717014, 'support': 154754}, 'accuracy': 0.303370548318773, 'macro avg': {'precision': 0.34118989760663815, 'recall': 0.33400579760714294, 'f1-score': 0.17983611402129437, 'support': 518877}, 'weighted avg': {'precision': 0.3481119641647199, 'recall': 0.303370548318773, 'f1-score': 0.16906894777576892, 'support': 518877}}
[[   368   6660 149471]
 [   468   9196 197960]
 [   332   6574 147848]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1205953
{'0': {'precision': 0.30541500699752394, 'recall': 0.10443969960241496, 'f1-score': 0.1556524840205196, 'support': 27164}, '1': {'precision': 0.35051546391752575, 'recall': 0.07586008348927595, 'f1-score': 0.1247263475533992, 'support': 27788}, '2': {'precision': 0.35246008236399107, 'recall': 0.8252808228447692, 'f1-score': 0.49396016646247, 'support': 29556}, 'accuracy': 0.34715056562692287, 'macro avg': {'precision': 0.3361301844263469, 'recall': 0.3351935353121534, 'f1-score': 0.25811299934546295, 'support': 84508}, 'weighted avg': {'precision': 0.33669862209224055, 'recall': 0.34715056562692287, 'f1-score': 0.26380374049453326, 'support': 84508}}
[[ 2837  1879 22448]
 [ 3315  2108 22365]
 [ 3137  2027 24392]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1210074
{'0': {'precision': 0.27419354838709675, 'recall': 0.0014264138278234602, 'f1-score': 0.0028380634390651085, 'support': 11918}, '1': {'precision': 0.29736408566721584, 'recall': 0.033128383958887765, 'f1-score': 0.05961522582775989, 'support': 10897}, '2': {'precision': 0.3425468904244817, 'recall': 0.9630782169890665, 'f1-score': 0.5053509565524393, 'support': 11890}, 'accuracy': 0.34084425875234114, 'macro avg': {'precision': 0.3047015081595981, 'recall': 0.3325443382585926, 'f1-score': 0.18926808193975478, 'support': 34705}, 'weighted avg': {'precision': 0.30488683700735214, 'recall': 0.34084425875234114, 'f1-score': 0.19282737442214035, 'support': 34705}}
[[   17   437 11464]
 [   22   361 10514]
 [   23   416 11451]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
2900/2900 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067554
{'0': {'precision': 0.3691588785046729, 'recall': 0.002390182100107785, 'f1-score': 0.004749612027340331, 'support': 264415}, '1': {'precision': 0.29737877633917237, 'recall': 0.04308347279180536, 'f1-score': 0.07526303108184082, 'support': 217508}, '2': {'precision': 0.35078560610547516, 'recall': 0.9551481175725229, 'f1-score': 0.513122841179947, 'support': 260435}, 'accuracy': 0.3485609369064521, 'macro avg': {'precision': 0.3391077536497735, 'recall': 0.33354059082147874, 'f1-score': 0.19771182809637602, 'support': 742358}, 'weighted avg': {'precision': 0.34168185305455484, 'recall': 0.3485609369064521, 'f1-score': 0.20375792699945, 'support': 742358}}
[[   632  11038 252745]
 [   502   9371 207635]
 [   578  11103 248754]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246872
{'0': {'precision': 0.30960219478738, 'recall': 0.07516192950030805, 'f1-score': 0.12095877379851817, 'support': 60057}, '1': {'precision': 0.3472775564409031, 'recall': 0.06276466251778703, 'f1-score': 0.10631470430224624, 'support': 58329}, '2': {'precision': 0.3327124868835257, 'recall': 0.856727911375304, 'f1-score': 0.4792910588768801, 'support': 59216}, 'accuracy': 0.33167982342541186, 'macro avg': {'precision': 0.32986407937060297, 'recall': 0.331551501131133, 'f1-score': 0.2355215123258815, 'support': 177602}, 'weighted avg': {'precision': 0.3296811647688763, 'recall': 0.33167982342541186, 'f1-score': 0.23562432184162713, 'support': 177602}}
[[ 4514  3540 52003]
 [ 4923  3661 49745]
 [ 5143  3341 50732]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200923
{'0': {'precision': 0.296, 'recall': 0.001839606224829712, 'f1-score': 0.0036564877952366833, 'support': 20113}, '1': {'precision': 0.43803559657218194, 'recall': 0.06342767145516155, 'f1-score': 0.11081002209530161, 'support': 20953}, '2': {'precision': 0.32785748942954185, 'recall': 0.9555072976112318, 'f1-score': 0.4882013701634649, 'support': 19801}, 'accuracy': 0.33328404554191926, 'macro avg': {'precision': 0.3539643620005746, 'recall': 0.340258191763741, 'f1-score': 0.2008892933513344, 'support': 60867}, 'weighted avg': {'precision': 0.3552584159424858, 'recall': 0.33328404554191926, 'f1-score': 0.19817340533614633, 'support': 60867}}
[[   37   865 19211]
 [   47  1329 19577]
 [   41   840 18920]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
7167/7167 - 98s - 98s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197598
{'0': {'precision': 0.5299215173315893, 'recall': 0.0049692812251325115, 'f1-score': 0.009846230497795155, 'support': 652207}, '1': {'precision': 0.25842399751321105, 'recall': 0.03416946839730047, 'f1-score': 0.060358221525236684, 'support': 486604}, '2': {'precision': 0.3793120063034439, 'recall': 0.9617540531217661, 'f1-score': 0.5440520351643884, 'support': 695760}, 'accuracy': 0.3755744531010247, 'macro avg': {'precision': 0.38921917371608145, 'recall': 0.33363093424806634, 'f1-score': 0.20475216239580674, 'support': 1834571}, 'weighted avg': {'precision': 0.4007905910678227, 'recall': 0.3755744531010247, 'f1-score': 0.2258413419089894, 'support': 1834571}}
[[  3241  22618 626348]
 [  1360  16627 468617]
 [  1515  25095 669150]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1191971
{'0': {'precision': 0.1986005350895246, 'recall': 0.021007793564866553, 'f1-score': 0.037996364423853055, 'support': 137806}, '1': {'precision': 0.4060895084372707, 'recall': 0.06613051367638163, 'f1-score': 0.11373896291539572, 'support': 133917}, '2': {'precision': 0.32988880798436415, 'recall': 0.927194251246384, 'f1-score': 0.48663611217670466, 'support': 129976}, 'accuracy': 0.3292614619404081, 'macro avg': {'precision': 0.31152628383705316, 'recall': 0.3381108528292107, 'f1-score': 0.21279047983865115, 'support': 401699}, 'weighted avg': {'precision': 0.3102528553631369, 'recall': 0.3292614619404081, 'f1-score': 0.20841157933879323, 'support': 401699}}
[[  2895   6673 128238]
 [  8498   8856 116563]
 [  3184   6279 120513]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1292471
{'0': {'precision': 0.4423076923076923, 'recall': 0.0019414197687178188, 'f1-score': 0.003865871081603496, 'support': 47388}, '1': {'precision': 0.2919047619047619, 'recall': 0.034885044388800364, 'f1-score': 0.06232208214721432, 'support': 35144}, '2': {'precision': 0.34406058907880205, 'recall': 0.9660095330649267, 'f1-score': 0.5074015556635877, 'support': 43218}, 'accuracy': 0.3424811133200795, 'macro avg': {'precision': 0.35942434776375204, 'recall': 0.33427866574081494, 'f1-score': 0.19119650296413515, 'support': 125750}, 'weighted avg': {'precision': 0.3665080589603622, 'recall': 0.3424811133200795, 'f1-score': 0.19325903448481635, 'support': 125750}}
[[   92  1568 45728]
 [   53  1226 33865]
 [   63  1406 41749]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
6357/6357 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065576
{'0': {'precision': 0.3690270581462291, 'recall': 0.002109472056077073, 'f1-score': 0.004194964406610505, 'support': 607735}, '1': {'precision': 0.26477344218642557, 'recall': 0.04357793194454812, 'f1-score': 0.0748385122449486, 'support': 415279}, '2': {'precision': 0.3712878034855267, 'recall': 0.9558490784649635, 'f1-score': 0.5348281848445543, 'support': 604155}, 'accuracy': 0.366808856363414, 'macro avg': {'precision': 0.3350294346060605, 'recall': 0.3338454941551962, 'f1-score': 0.2046205538320378, 'support': 1627169}, 'weighted avg': {'precision': 0.34325930029089385, 'recall': 0.366808856363414, 'f1-score': 0.21924422800273555, 'support': 1627169}}
[[  1282  24918 581535]
 [   852  18097 396330]
 [  1340  25334 577481]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1241668
{'0': {'precision': 0.2904091094807525, 'recall': 0.11242693074754144, 'f1-score': 0.16209972087673458, 'support': 145410}, '1': {'precision': 0.3919245955929181, 'recall': 0.06293420236301533, 'f1-score': 0.10845326910650298, 'support': 146677}, '2': {'precision': 0.3372650264925247, 'recall': 0.8366787366305963, 'f1-score': 0.48074274959260616, 'support': 143331}, 'accuracy': 0.334163952799379, 'macro avg': {'precision': 0.3398662438553985, 'recall': 0.337346623247051, 'f1-score': 0.2504319131919479, 'support': 435418}, 'weighted avg': {'precision': 0.34003014581294005, 'recall': 0.334163952799379, 'f1-score': 0.24891910671418807, 'support': 435418}}
[[ 16348   7242 121820]
 [ 23616   9231 113830]
 [ 16329   7080 119922]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097747
{'0': {'precision': 0.4111111111111111, 'recall': 0.0021005222920293695, 'f1-score': 0.004179688970892797, 'support': 52844}, '1': {'precision': 0.2911439114391144, 'recall': 0.03966518362114471, 'f1-score': 0.06981837488662257, 'support': 39783}, '2': {'precision': 0.35711756245979953, 'recall': 0.9607637268626537, 'f1-score': 0.5206927255388539, 'support': 51432}, 'accuracy': 0.354736600975989, 'macro avg': {'precision': 0.3531241950033417, 'recall': 0.3341764775919425, 'f1-score': 0.1982302631321231, 'support': 144059}, 'weighted avg': {'precision': 0.35870444926571926, 'recall': 0.354736600975989, 'f1-score': 0.20671200099963694, 'support': 144059}}
[[  111  1912 50821]
 [   71  1578 38134]
 [   88  1930 49414]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
7459/7459 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036987
{'0': {'precision': 0.37459201606829023, 'recall': 0.0020725734082719573, 'f1-score': 0.004122338404748979, 'support': 719878}, '1': {'precision': 0.2410801167693805, 'recall': 0.03884717237534409, 'f1-score': 0.0669122391105376, 'support': 459184}, '2': {'precision': 0.3822214674358207, 'recall': 0.9585915427375652, 'f1-score': 0.5465255234797274, 'support': 730189}, 'accuracy': 0.3767356937353968, 'macro avg': {'precision': 0.3326312000911638, 'recall': 0.3331704295070604, 'f1-score': 0.205853366998338, 'support': 1909251}, 'weighted avg': {'precision': 0.3453996330327099, 'recall': 0.3767356937353968, 'f1-score': 0.2266645589259902, 'support': 1909251}}
[[  1492  27418 690968]
 [   991  17838 440355]
 [  1500  28736 699953]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1455342
{'0': {'precision': 0.35560659845479226, 'recall': 0.035355178021521744, 'f1-score': 0.06431592728737599, 'support': 144505}, '1': {'precision': 0.3285989248025486, 'recall': 0.035567273223611896, 'f1-score': 0.0641869992480618, 'support': 139201}, '2': {'precision': 0.33593255474378925, 'recall': 0.9363827439071539, 'f1-score': 0.49447090310438657, 'support': 142257}, 'accuracy': 0.3363367240816691, 'macro avg': {'precision': 0.34004602600037676, 'recall': 0.33576839838409583, 'f1-score': 0.2076579432132748, 'support': 425963}, 'weighted avg': {'precision': 0.34021027150559213, 'recall': 0.3363367240816691, 'f1-score': 0.20793077055498352, 'support': 425963}}
[[  5109   5253 134143]
 [  5071   4951 129179]
 [  4187   4863 133207]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1443254
{'0': {'precision': 0.2619626168224299, 'recall': 0.05860951385258756, 'f1-score': 0.09578812473302008, 'support': 47825}, '1': {'precision': 0.2449877750611247, 'recall': 0.013599717690491056, 'f1-score': 0.025768953811336287, 'support': 36839}, '2': {'precision': 0.36680593815676, 'recall': 0.9220407476006062, 'f1-score': 0.5248258387593371, 'support': 47512}, 'accuracy': 0.3564338457813824, 'macro avg': {'precision': 0.2912521100134382, 'recall': 0.3314166597145616, 'f1-score': 0.2154609724345645, 'support': 132176}, 'weighted avg': {'precision': 0.2949185217340021, 'recall': 0.3564338457813824, 'f1-score': 0.23049490683593182, 'support': 132176}}
[[ 2803   791 44231]
 [ 4946   501 31392]
 [ 2951   753 43808]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
8238/8238 - 117s - 117s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109714
{'0': {'precision': 0.35964713865641257, 'recall': 0.0020998775731754507, 'f1-score': 0.004175376309072384, 'support': 757187}, '1': {'precision': 0.28536111204755643, 'recall': 0.04379680380259877, 'f1-score': 0.07593865458139393, 'support': 579814}, '2': {'precision': 0.365998380393231, 'recall': 0.9557931510807774, 'f1-score': 0.5293100113849324, 'support': 771713}, 'accuracy': 0.3625821235122449, 'macro avg': {'precision': 0.3370022103657333, 'recall': 0.3338966108188506, 'f1-score': 0.2031413474251329, 'support': 2108714}, 'weighted avg': {'precision': 0.3415457069697343, 'recall': 0.3625821235122449, 'f1-score': 0.21608774473195239, 'support': 2108714}}
[[  1590  31108 724489]
 [  1203  25394 553217]
 [  1628  32487 737598]]
Evaluating performance on  train set...
1806/1806 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1267163
{'0': {'precision': 0.32140740578151406, 'recall': 0.09408189358845034, 'f1-score': 0.14555666003976142, 'support': 155641}, '1': {'precision': 0.33676645786095843, 'recall': 0.05789623208705247, 'f1-score': 0.098805939857254, 'support': 151357}, '2': {'precision': 0.3377003095372815, 'recall': 0.8500628363355138, 'f1-score': 0.48337327850949524, 'support': 155165}, 'accuracy': 0.3360416130239764, 'macro avg': {'precision': 0.33195805772658465, 'recall': 0.3340136540036722, 'f1-score': 0.24257862613550354, 'support': 462163}, 'weighted avg': {'precision': 0.33190757229603834, 'recall': 0.3360416130239764, 'f1-score': 0.243663316890683, 'support': 462163}}
[[ 14643   8758 132240]
 [ 16151   8763 126443]
 [ 14765   8500 131900]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234877
{'0': {'precision': 0.3348999597153216, 'recall': 0.2744630509345023, 'f1-score': 0.30168442486618346, 'support': 54521}, '1': {'precision': 0.3968757340850364, 'recall': 0.06290959189752755, 'f1-score': 0.10860412046411468, 'support': 53712}, '2': {'precision': 0.344716807947735, 'recall': 0.6829681399204836, 'f1-score': 0.4581765989893251, 'support': 56089}, 'accuracy': 0.34474994218668226, 'macro avg': {'precision': 0.35883083391603104, 'recall': 0.3401135942508378, 'f1-score': 0.2894883814398744, 'support': 164322}, 'weighted avg': {'precision': 0.35850884953807177, 'recall': 0.34474994218668226, 'f1-score': 0.2919885852607074, 'support': 164322}}
[[14964  2577 36980]
 [14494  3379 35839]
 [15224  2558 38307]]
testing model on single stock: results/universal/W5/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
31315/31315 - 431s - 431s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078675
{'0': {'precision': 0.38527155569193006, 'recall': 0.0020467305289191156, 'f1-score': 0.004071829722540931, 'support': 3067331}, '1': {'precision': 0.23237609005451906, 'recall': 0.03846160088332656, 'f1-score': 0.06599935481325558, 'support': 1848467}, '2': {'precision': 0.3867115972292531, 'recall': 0.9596105767494182, 'f1-score': 0.5512685537313763, 'support': 3100688}, 'accuracy': 0.3808184783208004, 'macro avg': {'precision': 0.3347864143252341, 'recall': 0.33337296938722133, 'f1-score': 0.2071132460890576, 'support': 8016486}, 'weighted avg': {'precision': 0.3505734219752232, 'recall': 0.3808184783208004, 'f1-score': 0.23000090915901292, 'support': 8016486}}
[[   6278  115987 2945066]
 [   3648   71095 1773724]
 [   6369  118866 2975453]]
Evaluating performance on  train set...
5759/5759 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436847
{'0': {'precision': 0.34137532706118134, 'recall': 0.09930084368370767, 'f1-score': 0.15384928997942698, 'support': 494024}, '1': {'precision': 0.2915355584058466, 'recall': 0.06538358063781792, 'f1-score': 0.1068120849046876, 'support': 483210}, '2': {'precision': 0.33549055435043207, 'recall': 0.8250566469056502, 'f1-score': 0.4770141387464479, 'support': 496938}, 'accuracy': 0.33283293943990255, 'macro avg': {'precision': 0.32280047993915334, 'recall': 0.32991369040905855, 'f1-score': 0.24589183787685412, 'support': 1474172}, 'weighted avg': {'precision': 0.3230549127585908, 'recall': 0.33283293943990255, 'f1-score': 0.24736893745097102, 'support': 1474172}}
[[ 49057  38602 406365]
 [ 45886  31594 405730]
 [ 48761  38175 410002]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1326176
{'0': {'precision': 0.28888287800919665, 'recall': 0.09617340452580728, 'f1-score': 0.14430539714584337, 'support': 188784}, '1': {'precision': 0.31728529274732103, 'recall': 0.03719730533470899, 'f1-score': 0.06658808063578635, 'support': 164770}, '2': {'precision': 0.3580775929503386, 'recall': 0.8658365815681398, 'f1-score': 0.506631405160817, 'support': 191386}, 'accuracy': 0.3486512276580908, 'macro avg': {'precision': 0.3214152545689521, 'recall': 0.33306909714288535, 'f1-score': 0.23917496098081556, 'support': 544940}, 'weighted avg': {'precision': 0.3217723072860457, 'recall': 0.3486512276580908, 'f1-score': 0.2480574489838285, 'support': 544940}}
[[ 18156   6545 164083]
 [ 25659   6129 132982]
 [ 19034   6643 165709]]
training model: results/universal/W5/deepLOB_L2/h1000
Epoch 1/50
9913/9913 - 410s - loss: 3.1571 - accuracy1000: 0.4402 - val_loss: 3.6073 - val_accuracy1000: 0.3397 - 410s/epoch - 41ms/step
Epoch 2/50
9913/9913 - 405s - loss: 3.1135 - accuracy1000: 0.4598 - val_loss: 3.6233 - val_accuracy1000: 0.3460 - 405s/epoch - 41ms/step
Epoch 3/50
9913/9913 - 405s - loss: 3.0816 - accuracy1000: 0.4714 - val_loss: 3.6242 - val_accuracy1000: 0.3394 - 405s/epoch - 41ms/step
Epoch 4/50
9913/9913 - 404s - loss: 3.0714 - accuracy1000: 0.4738 - val_loss: 3.6086 - val_accuracy1000: 0.3301 - 404s/epoch - 41ms/step
Epoch 5/50
9913/9913 - 406s - loss: 3.0574 - accuracy1000: 0.4785 - val_loss: 3.5973 - val_accuracy1000: 0.3393 - 406s/epoch - 41ms/step
Epoch 6/50
9913/9913 - 405s - loss: 3.0459 - accuracy1000: 0.4828 - val_loss: 3.6558 - val_accuracy1000: 0.3267 - 405s/epoch - 41ms/step
Epoch 7/50
9913/9913 - 403s - loss: 3.0379 - accuracy1000: 0.4850 - val_loss: 3.6757 - val_accuracy1000: 0.3178 - 403s/epoch - 41ms/step
Epoch 8/50
9913/9913 - 405s - loss: 3.0289 - accuracy1000: 0.4877 - val_loss: 3.7807 - val_accuracy1000: 0.3187 - 405s/epoch - 41ms/step
Epoch 9/50
9913/9913 - 405s - loss: 3.0227 - accuracy1000: 0.4896 - val_loss: 3.6395 - val_accuracy1000: 0.3250 - 405s/epoch - 41ms/step
Epoch 10/50
9913/9913 - 404s - loss: 3.0169 - accuracy1000: 0.4909 - val_loss: 3.6024 - val_accuracy1000: 0.3301 - 404s/epoch - 41ms/step
Epoch 11/50
9913/9913 - 405s - loss: 3.0119 - accuracy1000: 0.4927 - val_loss: 3.6709 - val_accuracy1000: 0.3255 - 405s/epoch - 41ms/step
Epoch 12/50
9913/9913 - 404s - loss: 3.0070 - accuracy1000: 0.4942 - val_loss: 3.5959 - val_accuracy1000: 0.3233 - 404s/epoch - 41ms/step
Epoch 13/50
9913/9913 - 404s - loss: 3.0026 - accuracy1000: 0.4954 - val_loss: 3.5828 - val_accuracy1000: 0.3273 - 404s/epoch - 41ms/step
Epoch 14/50
9913/9913 - 404s - loss: 3.0005 - accuracy1000: 0.4961 - val_loss: 3.6125 - val_accuracy1000: 0.3272 - 404s/epoch - 41ms/step
Epoch 15/50
9913/9913 - 404s - loss: 2.9979 - accuracy1000: 0.4966 - val_loss: 3.6028 - val_accuracy1000: 0.3226 - 404s/epoch - 41ms/step
Epoch 16/50
9913/9913 - 405s - loss: 2.9929 - accuracy1000: 0.4979 - val_loss: 3.5722 - val_accuracy1000: 0.3345 - 405s/epoch - 41ms/step
Epoch 17/50
9913/9913 - 404s - loss: 2.9895 - accuracy1000: 0.4987 - val_loss: 3.6026 - val_accuracy1000: 0.3284 - 404s/epoch - 41ms/step
Epoch 18/50
9913/9913 - 404s - loss: 2.9861 - accuracy1000: 0.4996 - val_loss: 3.6262 - val_accuracy1000: 0.3236 - 404s/epoch - 41ms/step
Epoch 19/50
9913/9913 - 404s - loss: 2.9815 - accuracy1000: 0.5010 - val_loss: 3.6047 - val_accuracy1000: 0.3334 - 404s/epoch - 41ms/step
Epoch 20/50
9913/9913 - 405s - loss: 2.9780 - accuracy1000: 0.5013 - val_loss: 3.6075 - val_accuracy1000: 0.3210 - 405s/epoch - 41ms/step
Epoch 21/50
9913/9913 - 406s - loss: 2.9746 - accuracy1000: 0.5025 - val_loss: 3.6401 - val_accuracy1000: 0.3064 - 406s/epoch - 41ms/step
Epoch 22/50
9913/9913 - 406s - loss: 2.9742 - accuracy1000: 0.5029 - val_loss: 3.6245 - val_accuracy1000: 0.3144 - 406s/epoch - 41ms/step
Epoch 23/50
9913/9913 - 404s - loss: 2.9700 - accuracy1000: 0.5042 - val_loss: 3.6396 - val_accuracy1000: 0.3291 - 404s/epoch - 41ms/step
Epoch 24/50
9913/9913 - 404s - loss: 2.9661 - accuracy1000: 0.5049 - val_loss: 3.6234 - val_accuracy1000: 0.3386 - 404s/epoch - 41ms/step
Epoch 25/50
9913/9913 - 404s - loss: 2.9644 - accuracy1000: 0.5054 - val_loss: 3.6332 - val_accuracy1000: 0.3290 - 404s/epoch - 41ms/step
Epoch 26/50
9913/9913 - 403s - loss: 2.9601 - accuracy1000: 0.5064 - val_loss: 3.6115 - val_accuracy1000: 0.3331 - 403s/epoch - 41ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 671s - 671s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1486723
{'0': {'precision': 0.40264115647012405, 'recall': 0.05534334516823453, 'f1-score': 0.09731119032084228, 'support': 4923573}, '1': {'precision': 0.2065458216222061, 'recall': 0.19517822603402712, 'f1-score': 0.20070118925745759, 'support': 2916437}, '2': {'precision': 0.3870208286110276, 'recall': 0.7282774162273744, 'f1-score': 0.50544063956248, 'support': 4998381}, 'accuracy': 0.3491029366530432, 'macro avg': {'precision': 0.33206926890111926, 'recall': 0.326266329143212, 'f1-score': 0.2678176730469266, 'support': 12838391}, 'weighted avg': {'precision': 0.35201362533615754, 'recall': 0.3491029366530432, 'f1-score': 0.2796951746502315, 'support': 12838391}}
[[ 272487 1094456 3556630]
 [ 138334  569225 2208878]
 [ 265928 1092245 3640208]]
Evaluating performance on  train set...
9913/9913 - 139s - 139s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1999686
{'0': {'precision': 0.3490164175949472, 'recall': 0.18943569584223774, 'f1-score': 0.2455786365306072, 'support': 862868}, '1': {'precision': 0.27933781665433866, 'recall': 0.10015157708290756, 'f1-score': 0.14744086838009718, 'support': 822024}, '2': {'precision': 0.3306100659987869, 'recall': 0.688258163848471, 'f1-score': 0.4466624246557554, 'support': 852141}, 'accuracy': 0.32805170449103344, 'macro avg': {'precision': 0.3196547667493576, 'recall': 0.32594847892453876, 'f1-score': 0.27989397652215325, 'support': 2537033}, 'weighted avg': {'precision': 0.3202575133492766, 'recall': 0.32805170449103344, 'f1-score': 0.28132123017073607, 'support': 2537033}}
[[163458 107285 592125]
 [144343  82327 595354]
 [160538 105110 586493]]
Evaluating performance on  val set...
3496/3496 - 47s - 47s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1924195
{'0': {'precision': 0.31385882793484365, 'recall': 0.1355824727592722, 'f1-score': 0.18936290867356045, 'support': 309096}, '1': {'precision': 0.26433115876501745, 'recall': 0.12012196016848409, 'f1-score': 0.16517996791152462, 'support': 272548}, '2': {'precision': 0.3520659885245541, 'recall': 0.717296648804287, 'f1-score': 0.47231078571706936, 'support': 312575}, 'accuracy': 0.3342089577609064, 'macro avg': {'precision': 0.3100853250748051, 'recall': 0.3243336939106811, 'f1-score': 0.2756178874340515, 'support': 894219}, 'weighted avg': {'precision': 0.31211869050143076, 'recall': 0.3342089577609064, 'f1-score': 0.28089688472200436, 'support': 894219}}
[[ 41908  45060 222128]
 [ 49308  32739 190501]
 [ 42309  46057 224209]]
testing model out of sample: results/universal/W5/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 284s - 284s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1473459
{'0': {'precision': 0.37085227523502673, 'recall': 0.06315878092267664, 'f1-score': 0.10793539599477091, 'support': 1995542}, '1': {'precision': 0.23255489162957965, 'recall': 0.2183501793879919, 'f1-score': 0.22522879234993087, 'support': 1311682}, '2': {'precision': 0.3800934816459674, 'recall': 0.7032528090437985, 'f1-score': 0.49347435988648314, 'support': 2041620}, 'accuracy': 0.3455357830589189, 'macro avg': {'precision': 0.32783354950352456, 'recall': 0.32825392311815565, 'f1-score': 0.2755461827437283, 'support': 5348844}, 'weighted avg': {'precision': 0.3404653062208518, 'recall': 0.3455357830589189, 'f1-score': 0.2838567158497763, 'support': 5348844}}
[[ 126036  470868 1398638]
 [  82263  286406  943013]
 [ 131556  474289 1435775]]
Evaluating performance on  train set...
4957/4957 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1889086
{'0': {'precision': 0.3273223998884231, 'recall': 0.18620356520298414, 'f1-score': 0.23737299366809012, 'support': 428531}, '1': {'precision': 0.30719653917655665, 'recall': 0.16705596002136922, 'f1-score': 0.21642063185402088, 'support': 417423}, '2': {'precision': 0.3278153085379554, 'recall': 0.6189895594119179, 'f1-score': 0.42862951019625267, 'support': 422390}, 'accuracy': 0.3240303892319434, 'macro avg': {'precision': 0.32077808253431167, 'recall': 0.3240830282120904, 'f1-score': 0.29414104523945456, 'support': 1268344}, 'weighted avg': {'precision': 0.32086295554883265, 'recall': 0.3240303892319434, 'f1-score': 0.29417055197310543, 'support': 1268344}}
[[ 79794  78873 269864]
 [ 81441  69733 266249]
 [ 82543  78392 261455]]
Evaluating performance on  val set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1753556
{'0': {'precision': 0.3601555291946751, 'recall': 0.21426191051837137, 'f1-score': 0.26868129842142563, 'support': 153037}, '1': {'precision': 0.28197566508558464, 'recall': 0.20845847753502766, 'f1-score': 0.2397068749397358, 'support': 131182}, '2': {'precision': 0.34440675496259837, 'recall': 0.5640259060144645, 'f1-score': 0.4276691940960189, 'support': 150853}, 'accuracy': 0.3337861319505737, 'macro avg': {'precision': 0.3288459830809527, 'recall': 0.3289154313559545, 'f1-score': 0.3120191224857268, 'support': 435072}, 'weighted avg': {'precision': 0.3311223099280016, 'recall': 0.3337861319505737, 'f1-score': 0.3150710412801349, 'support': 435072}}
[[32790 35497 84750]
 [26623 27346 77213]
 [31631 34137 85085]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1933966
{'0': {'precision': 0.2404127669786417, 'recall': 0.1253393721771116, 'f1-score': 0.16477380198524633, 'support': 79927}, '1': {'precision': 0.36616362192216045, 'recall': 0.15883605838501536, 'f1-score': 0.22156198798470783, 'support': 95778}, '2': {'precision': 0.33957991100620405, 'recall': 0.6680541756000627, 'f1-score': 0.4502780930360428, 'support': 95615}, 'accuracy': 0.3284203154946189, 'macro avg': {'precision': 0.31538543330233537, 'recall': 0.3174098687207299, 'f1-score': 0.27887129433533236, 'support': 271320}, 'weighted avg': {'precision': 0.31975093541803323, 'recall': 0.3284203154946189, 'f1-score': 0.28543409856300805, 'support': 271320}}
[[10018 11196 58713]
 [15051 15213 65514]
 [16601 15138 63876]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1627882
{'0': {'precision': 0.35613382899628254, 'recall': 0.059274842222497216, 'f1-score': 0.10163377890939952, 'support': 24243}, '1': {'precision': 0.31517976972522427, 'recall': 0.19483014583879138, 'f1-score': 0.24080520251490867, 'support': 22902}, '2': {'precision': 0.31524758630067795, 'recall': 0.7204759367785474, 'f1-score': 0.4385886677207065, 'support': 22524}, 'accuracy': 0.3176018028104322, 'macro avg': {'precision': 0.3288537283407283, 'recall': 0.32486030827994533, 'f1-score': 0.26034254971500487, 'support': 69669}, 'weighted avg': {'precision': 0.32945264230059906, 'recall': 0.3176018028104322, 'f1-score': 0.2563205959872857, 'support': 69669}}
[[ 1437  4725 18081]
 [ 1272  4462 17168]
 [ 1326  4970 16228]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1365662
{'0': {'precision': 0.3924259055982437, 'recall': 0.0810657596371882, 'f1-score': 0.13437323811313662, 'support': 8820}, '1': {'precision': 0.31116349553796935, 'recall': 0.2434461862732183, 'f1-score': 0.2731707317073171, 'support': 7591}, '2': {'precision': 0.3391278375149343, 'recall': 0.7017305315203956, 'f1-score': 0.4572694321385421, 'support': 8090}, 'accuracy': 0.3363128035590384, 'macro avg': {'precision': 0.3475724128837158, 'recall': 0.3420808258102674, 'f1-score': 0.2882711339863319, 'support': 24501}, 'weighted avg': {'precision': 0.3496503321293438, 'recall': 0.3363128035590384, 'f1-score': 0.2839933345801769, 'support': 24501}}
[[ 715 2259 5846]
 [ 526 1848 5217]
 [ 581 1832 5677]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1428425
{'0': {'precision': 0.35305348305574397, 'recall': 0.07540953699381335, 'f1-score': 0.12427490096208262, 'support': 186369}, '1': {'precision': 0.2864256263875674, 'recall': 0.19512037032035737, 'f1-score': 0.2321168680543731, 'support': 185137}, '2': {'precision': 0.32587043803508453, 'recall': 0.6827810335641982, 'f1-score': 0.441179457433057, 'support': 187700}, 'accuracy': 0.3189093107012443, 'macro avg': {'precision': 0.32178318249279864, 'recall': 0.31777031362612296, 'f1-score': 0.2658570754831709, 'support': 559206}, 'weighted avg': {'precision': 0.32187080788710487, 'recall': 0.3189093107012443, 'f1-score': 0.2663487047323699, 'support': 559206}}
[[ 14054  44498 127817]
 [ 11709  36124 137304]
 [ 14044  45498 128158]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1693878
{'0': {'precision': 0.2625655365256903, 'recall': 0.07759048091224591, 'f1-score': 0.11978377688836446, 'support': 48408}, '1': {'precision': 0.33300355002036897, 'recall': 0.11722287095650749, 'f1-score': 0.17340444875446998, 'support': 48813}, '2': {'precision': 0.36727263575581154, 'recall': 0.81877688423415, 'f1-score': 0.5070856474376423, 'support': 53470}, 'accuracy': 0.35342522114791197, 'macro avg': {'precision': 0.32094724076729025, 'recall': 0.33786341203430115, 'f1-score': 0.26675795769349225, 'support': 150691}, 'weighted avg': {'precision': 0.32253580249081315, 'recall': 0.35342522114791197, 'f1-score': 0.27458012752689026, 'support': 150691}}
[[ 3756  5621 39031]
 [ 6699  5722 36392]
 [ 3850  5840 43780]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2487632
{'0': {'precision': 0.3101070586100526, 'recall': 0.40082087364409263, 'f1-score': 0.34967646231361416, 'support': 17055}, '1': {'precision': 0.39380113278791695, 'recall': 0.11238326149425287, 'f1-score': 0.1748637697359229, 'support': 22272}, '2': {'precision': 0.315809968847352, 'recall': 0.5150395473702443, 'f1-score': 0.39153810704645703, 'support': 17321}, 'accuracy': 0.32234147719248696, 'macro avg': {'precision': 0.3399060534151072, 'recall': 0.34274789416952994, 'f1-score': 0.30535944636533136, 'support': 56648}, 'weighted avg': {'precision': 0.34475637594358, 'recall': 0.32234147719248696, 'f1-score': 0.29374610747897273, 'support': 56648}}
[[ 6836  1949  8270]
 [ 8712  2503 11057]
 [ 6496  1904  8921]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1371161
{'0': {'precision': 0.3795537407029313, 'recall': 0.05959124609036914, 'f1-score': 0.10300962573617883, 'support': 218371}, '1': {'precision': 0.25, 'recall': 0.20289484887186038, 'f1-score': 0.22399774404286318, 'support': 152685}, '2': {'precision': 0.3842505475172417, 'recall': 0.7426202859433809, 'f1-score': 0.5064506827190431, 'support': 228227}, 'accuracy': 0.35622235237775807, 'macro avg': {'precision': 0.3379347627400577, 'recall': 0.33503546030187015, 'f1-score': 0.27781935083269504, 'support': 599283}, 'weighted avg': {'precision': 0.3483348094627368, 'recall': 0.35622235237775807, 'f1-score': 0.28747875460465044, 'support': 599283}}
[[ 13013  46884 158474]
 [  8584  30979 113122]
 [ 12688  46053 169486]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1373036
{'0': {'precision': 0.35278886611284926, 'recall': 0.07955236589222722, 'f1-score': 0.12982887997776632, 'support': 41105}, '1': {'precision': 0.3110692006383287, 'recall': 0.2617942957608908, 'f1-score': 0.2843125555246165, 'support': 40952}, '2': {'precision': 0.3270894455728579, 'recall': 0.6296126463135031, 'f1-score': 0.430519914516515, 'support': 41435}, 'accuracy': 0.324547339098889, 'macro avg': {'precision': 0.3303158374413453, 'recall': 0.32365310265554037, 'f1-score': 0.2815537833396326, 'support': 123492}, 'weighted avg': {'precision': 0.3303310613110232, 'recall': 0.324547339098889, 'f1-score': 0.2819484383063031, 'support': 123492}}
[[ 3270 11770 26065]
 [ 2626 10721 27605]
 [ 3373 11974 26088]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1246926
{'0': {'precision': 0.424978466838932, 'recall': 0.15526464849896154, 'f1-score': 0.22743615746289295, 'support': 15889}, '1': {'precision': 0.25945603044960747, 'recall': 0.3066829131127566, 'f1-score': 0.28109965635738826, 'support': 10669}, '2': {'precision': 0.37691535338542803, 'recall': 0.5847612597358618, 'f1-score': 0.4583775748566574, 'support': 14765}, 'accuracy': 0.3478208261742855, 'macro avg': {'precision': 0.3537832835579892, 'recall': 0.3489029404491933, 'f1-score': 0.3223044628923129, 'support': 41323}, 'weighted avg': {'precision': 0.3650696813204873, 'recall': 0.3478208261742855, 'f1-score': 0.32380829640547465, 'support': 41323}}
[[2467 4988 8434]
 [1558 3272 5839]
 [1780 4351 8634]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1387597
{'0': {'precision': 0.30126655990682777, 'recall': 0.06694530891116014, 'f1-score': 0.10954770677169355, 'support': 154559}, '1': {'precision': 0.39041452411748007, 'recall': 0.2355961888081935, 'f1-score': 0.29386134146993004, 'support': 210118}, '2': {'precision': 0.28993447682089585, 'recall': 0.672632944228275, 'f1-score': 0.40520690086260786, 'support': 154200}, 'accuracy': 0.31523848619229605, 'macro avg': {'precision': 0.3272051869484012, 'recall': 0.32505814731587623, 'f1-score': 0.2695386497014105, 'support': 518877}, 'weighted avg': {'precision': 0.3339991434134452, 'recall': 0.31523848619229605, 'f1-score': 0.2720491474297745, 'support': 518877}}
[[ 10347  37701 106511]
 [ 13110  49503 147505]
 [ 10888  39592 103720]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2043324
{'0': {'precision': 0.29827013803948976, 'recall': 0.25050445757053236, 'f1-score': 0.27230852060858646, 'support': 27257}, '1': {'precision': 0.30004190529403546, 'recall': 0.15379658468478144, 'f1-score': 0.20335613358263707, 'support': 27933}, '2': {'precision': 0.34456002367964816, 'recall': 0.5558701139231871, 'f1-score': 0.4254202777487731, 'support': 29318}, 'accuracy': 0.32447815591423296, 'macro avg': {'precision': 0.3142906890043911, 'recall': 0.3200570520595003, 'f1-score': 0.30036164397999887, 'support': 84508}, 'weighted avg': {'precision': 0.31491492482795225, 'recall': 0.32447815591423296, 'f1-score': 0.3026356312849739, 'support': 84508}}
[[ 6828  4735 15694]
 [ 8330  4296 15307]
 [ 7734  5287 16297]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1419462
{'0': {'precision': 0.3281677301731996, 'recall': 0.059855349571867986, 'f1-score': 0.10124446319341911, 'support': 12029}, '1': {'precision': 0.2853361566966649, 'recall': 0.24993044607252157, 'f1-score': 0.26646232944433457, 'support': 10783}, '2': {'precision': 0.3305731379519639, 'recall': 0.6411334398385605, 'f1-score': 0.436225292485483, 'support': 11893}, 'accuracy': 0.31810978245209626, 'macro avg': {'precision': 0.31469234160727616, 'recall': 0.3169730784943167, 'f1-score': 0.26797736170774555, 'support': 34705}, 'weighted avg': {'precision': 0.3156840724269201, 'recall': 0.31810978245209626, 'f1-score': 0.2673724347984944, 'support': 34705}}
[[ 720 3290 8019]
 [ 666 2695 7422]
 [ 808 3460 7625]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
2900/2900 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1350944
{'0': {'precision': 0.3700604642090891, 'recall': 0.07210997597981088, 'f1-score': 0.12070029454612541, 'support': 263112}, '1': {'precision': 0.291073615845495, 'recall': 0.27235089776735344, 'f1-score': 0.2814011768269734, 'support': 225114}, '2': {'precision': 0.3411648149458637, 'recall': 0.6449955141422568, 'f1-score': 0.44627586150566445, 'support': 254132}, 'accuracy': 0.3289477583591744, 'macro avg': {'precision': 0.33409963166681594, 'recall': 0.3298187959631404, 'f1-score': 0.2827924442929211, 'support': 742358}, 'weighted avg': {'precision': 0.3362164771825007, 'recall': 0.3289477583591744, 'f1-score': 0.2808860652879136, 'support': 742358}}
[[ 18973  76699 167440]
 [ 14704  61310 149100]
 [ 17593  72625 163914]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1954046
{'0': {'precision': 0.3145154761583506, 'recall': 0.1939138826034873, 'f1-score': 0.23991107543150028, 'support': 60104}, '1': {'precision': 0.3130044589941864, 'recall': 0.18679264349232014, 'f1-score': 0.23396266216643816, 'support': 59376}, '2': {'precision': 0.31661767084320386, 'recall': 0.5725886927497333, 'f1-score': 0.4077606856456721, 'support': 58122}, 'accuracy': 0.31545815925496334, 'macro avg': {'precision': 0.3147125353319136, 'recall': 0.3177650729485136, 'f1-score': 0.2938781410812035, 'support': 177602}, 'weighted avg': {'precision': 0.3146982759259975, 'recall': 0.31545815925496334, 'f1-score': 0.2928528331754545, 'support': 177602}}
[[11655 12265 36184]
 [12638 11091 35647]
 [12764 12078 33280]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1408645
{'0': {'precision': 0.397288842544317, 'recall': 0.05688831375671909, 'f1-score': 0.09952544734206975, 'support': 20092}, '1': {'precision': 0.31611936231094157, 'recall': 0.21861012956419318, 'f1-score': 0.2584742222098432, 'support': 21225}, '2': {'precision': 0.31843369043221276, 'recall': 0.7054731457800512, 'f1-score': 0.4388024561738411, 'support': 19550}, 'accuracy': 0.32160283897678543, 'macro avg': {'precision': 0.3439472984291571, 'recall': 0.3269905297003211, 'f1-score': 0.26560070857525137, 'support': 60867}, 'weighted avg': {'precision': 0.3436564893521927, 'recall': 0.32160283897678543, 'f1-score': 0.26392575077791547, 'support': 60867}}
[[ 1143  5197 13752]
 [  817  4640 15768]
 [  917  4841 13792]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
7167/7167 - 97s - 97s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1549163
{'0': {'precision': 0.4083473020857646, 'recall': 0.027141912217879954, 'f1-score': 0.05090057922716814, 'support': 709051}, '1': {'precision': 0.17861078079486817, 'recall': 0.13423779954521603, 'f1-score': 0.15327746197788342, 'support': 365888}, '2': {'precision': 0.41228520820151104, 'recall': 0.8208737915201044, 'f1-score': 0.5488896762225004, 'support': 759632}, 'accuracy': 0.37715792956500455, 'macro avg': {'precision': 0.33308109702738126, 'recall': 0.3274178344277335, 'f1-score': 0.25102257247585064, 'support': 1834571}, 'weighted avg': {'precision': 0.3641590549132285, 'recall': 0.37715792956500455, 'f1-score': 0.27751864230821105, 'support': 1834571}}
[[ 19245 109465 580341]
 [  8222  49116 308550]
 [ 19662 116408 623562]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1687217
{'0': {'precision': 0.3074453538376172, 'recall': 0.11118516766643016, 'f1-score': 0.163310420329063, 'support': 139533}, '1': {'precision': 0.293478031597376, 'recall': 0.21132932349099304, 'f1-score': 0.24571953340927352, 'support': 131676}, '2': {'precision': 0.32313002105919975, 'recall': 0.6349681967966894, 'f1-score': 0.4283011553074358, 'support': 130490}, 'accuracy': 0.3141606028394395, 'macro avg': {'precision': 0.30801780216473096, 'recall': 0.31916089598470415, 'f1-score': 0.2791103696819241, 'support': 401699}, 'weighted avg': {'precision': 0.3079619871935337, 'recall': 0.3141606028394395, 'f1-score': 0.2764049099376447, 'support': 401699}}
[[15514 34807 89212]
 [19498 27827 84351]
 [15449 32184 82857]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1557664
{'0': {'precision': 0.3789792159957906, 'recall': 0.061563775455691604, 'f1-score': 0.10592106472545451, 'support': 46797}, '1': {'precision': 0.26998279368058814, 'recall': 0.19172452096639822, 'f1-score': 0.22422136338540485, 'support': 36010}, '2': {'precision': 0.3395372450743173, 'recall': 0.731970286193326, 'f1-score': 0.46389067215667174, 'support': 42943}, 'accuracy': 0.3277773359840954, 'macro avg': {'precision': 0.32949975158356537, 'recall': 0.328419527538472, 'f1-score': 0.26467770008917707, 'support': 125750}, 'weighted avg': {'precision': 0.33429756410830536, 'recall': 0.3277773359840954, 'f1-score': 0.26204259638878313, 'support': 125750}}
[[ 2881  9829 34087]
 [ 2050  6904 27056]
 [ 2671  8839 31433]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
6357/6357 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1523483
{'0': {'precision': 0.4053811915631761, 'recall': 0.06444345118597586, 'f1-score': 0.11120814300991207, 'support': 660005}, '1': {'precision': 0.1816487065266471, 'recall': 0.22485601657852244, 'f1-score': 0.20095611315028036, 'support': 305938}, '2': {'precision': 0.4026561402803053, 'recall': 0.6963625144806768, 'f1-score': 0.5102636631361979, 'support': 661226}, 'accuracy': 0.3513943542434744, 'macro avg': {'precision': 0.3298953461233762, 'recall': 0.32855399408172503, 'f1-score': 0.27414263976546344, 'support': 1627169}, 'weighted avg': {'precision': 0.3622079601614759, 'recall': 0.3513943542434744, 'f1-score': 0.29024498542752664, 'support': 1627169}}
[[ 42533 152603 464869]
 [ 18929  68792 218217]
 [ 43459 157314 460453]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2070717
{'0': {'precision': 0.3173092810559157, 'recall': 0.21994138848654293, 'f1-score': 0.25980216614542306, 'support': 148435}, '1': {'precision': 0.27376187753546244, 'recall': 0.14086776222698552, 'f1-score': 0.186017686017686, 'support': 142758}, '2': {'precision': 0.3293897858904633, 'recall': 0.5916866007973652, 'f1-score': 0.42319079192061454, 'support': 144225}, 'accuracy': 0.3171504163815001, 'macro avg': {'precision': 0.3068203148272805, 'recall': 0.31749858383696455, 'f1-score': 0.2896702146945745, 'support': 435418}, 'weighted avg': {'precision': 0.3070331109802408, 'recall': 0.3171504163815001, 'f1-score': 0.2897306480601613, 'support': 435418}}
[[32647 27246 88542]
 [37453 20110 85195]
 [32787 26102 85336]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1416161
{'0': {'precision': 0.3804672972754467, 'recall': 0.08811579006497276, 'f1-score': 0.14309170518122113, 'support': 53407}, '1': {'precision': 0.253538212697129, 'recall': 0.2502931563583743, 'f1-score': 0.25190523421511885, 'support': 40081}, '2': {'precision': 0.3465513123900914, 'recall': 0.6312906606553162, 'f1-score': 0.4474641362926002, 'support': 50571}, 'accuracy': 0.3239158955705648, 'macro avg': {'precision': 0.326852274120889, 'recall': 0.32323320235955444, 'f1-score': 0.28082035856298004, 'support': 144059}, 'weighted avg': {'precision': 0.33324629816660345, 'recall': 0.3239158955705648, 'f1-score': 0.28021450397158626, 'support': 144059}}
[[ 4706 15366 33335]
 [ 3187 10032 26862]
 [ 4476 14170 31925]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
7459/7459 - 101s - 101s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1450647
{'0': {'precision': 0.4262855789459019, 'recall': 0.07832639175099387, 'f1-score': 0.13233697650177975, 'support': 781282}, '1': {'precision': 0.1671221885646126, 'recall': 0.23467196052500774, 'f1-score': 0.19521882897772053, 'support': 331957}, '2': {'precision': 0.4176320538026186, 'recall': 0.6818238921021291, 'f1-score': 0.5179862157296058, 'support': 796012}, 'accuracy': 0.3571222432252229, 'macro avg': {'precision': 0.33701327377104434, 'recall': 0.3316074147927102, 'f1-score': 0.28184734040303533, 'support': 1909251}, 'weighted avg': {'precision': 0.3776175874470592, 'recall': 0.3571222432252229, 'f1-score': 0.30405640643455234, 'support': 1909251}}
[[ 61195 194348 525739]
 [ 22970  77901 231086]
 [ 59389 193883 542740]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.169823
{'0': {'precision': 0.38402683638535945, 'recall': 0.11735216884557595, 'f1-score': 0.1797697218054413, 'support': 142426}, '1': {'precision': 0.27048634243837444, 'recall': 0.12020894870041522, 'f1-score': 0.1664462285560897, 'support': 141853}, '2': {'precision': 0.32476721832948235, 'recall': 0.7321221874029531, 'f1-score': 0.44994165896738547, 'support': 141684}, 'accuracy': 0.32278859900977314, 'macro avg': {'precision': 0.3264267990510721, 'recall': 0.3232277683163148, 'f1-score': 0.26538586977630546, 'support': 425963}, 'weighted avg': {'precision': 0.32650494032281285, 'recall': 0.32278859900977314, 'f1-score': 0.26519747787099773, 'support': 425963}}
[[ 16714  22903 102809]
 [ 11942  17052 112859]
 [ 14867  23087 103730]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1894406
{'0': {'precision': 0.319192175790677, 'recall': 0.10990356650849534, 'f1-score': 0.16350830391853863, 'support': 45731}, '1': {'precision': 0.19478439161914526, 'recall': 0.0751322228263556, 'f1-score': 0.10843781768891901, 'support': 40462}, '2': {'precision': 0.3478571357725916, 'recall': 0.7627166561555357, 'f1-score': 0.47780063485143653, 'support': 45983}, 'accuracy': 0.3263678731388452, 'macro avg': {'precision': 0.2872779010608046, 'recall': 0.3159174818301289, 'f1-score': 0.24991558548629808, 'support': 132176}, 'weighted avg': {'precision': 0.29108051476068564, 'recall': 0.3263678731388452, 'f1-score': 0.2559898606267502, 'support': 132176}}
[[ 5026  6660 34045]
 [ 5716  3040 31706]
 [ 5004  5907 35072]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
8238/8238 - 113s - 113s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1446617
{'0': {'precision': 0.387339427224161, 'recall': 0.053479597017026925, 'f1-score': 0.09398304219021351, 'support': 774127}, '1': {'precision': 0.23263484834531892, 'recall': 0.2088667655078199, 'f1-score': 0.22011103377054406, 'support': 532167}, '2': {'precision': 0.37957067915106935, 'recall': 0.7209179731312779, 'f1-score': 0.49730512732891896, 'support': 802420}, 'accuracy': 0.3466714784461051, 'macro avg': {'precision': 0.3331816515735164, 'recall': 0.3277547785520416, 'f1-score': 0.27046640109655884, 'support': 2108714}, 'weighted avg': {'precision': 0.3453410953228093, 'recall': 0.3466714784461051, 'f1-score': 0.2792878594638361, 'support': 2108714}}
[[ 41400 183740 548987]
 [ 24446 111152 396569]
 [ 41037 182904 578479]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1868954
{'0': {'precision': 0.3414021617674717, 'recall': 0.1995486407490753, 'f1-score': 0.2518762778891006, 'support': 154644}, '1': {'precision': 0.33622937828686694, 'recall': 0.1540991184336514, 'f1-score': 0.21133852562941496, 'support': 151435}, '2': {'precision': 0.33345680278070833, 'recall': 0.645979088183286, 'f1-score': 0.43985752083637797, 'support': 156084}, 'accuracy': 0.3354271112140089, 'macro avg': {'precision': 0.33702944761168235, 'recall': 0.3332089491220042, 'f1-score': 0.30102410811829783, 'support': 462163}, 'weighted avg': {'precision': 0.3370238712542213, 'recall': 0.3354271112140089, 'f1-score': 0.30207940927507776, 'support': 462163}}
[[ 30859  23057 100728]
 [ 27285  23336 100814]
 [ 32245  23012 100827]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2344265
{'0': {'precision': 0.3498826635376943, 'recall': 0.4350799759251491, 'f1-score': 0.3878577990228357, 'support': 54829}, '1': {'precision': 0.32134528047133915, 'recall': 0.15216212027278364, 'f1-score': 0.20652931354115991, 'support': 51616}, '2': {'precision': 0.35297973528960547, 'recall': 0.4372894241235724, 'f1-score': 0.3906372995415888, 'support': 57877}, 'accuracy': 0.3469894475481068, 'macro avg': {'precision': 0.3414025597662129, 'recall': 0.34151050677383504, 'f1-score': 0.3283414707018615, 'support': 164322}, 'weighted avg': {'precision': 0.342009485615276, 'recall': 0.3469894475481068, 'f1-score': 0.3318787946588534, 'support': 164322}}
[[23855  7818 23156]
 [20526  7854 23236]
 [23799  8769 25309]]
testing model on single stock: results/universal/W5/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
31315/31315 - 421s - 421s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1491469
{'0': {'precision': 0.407256023979135, 'recall': 0.05413166588623658, 'f1-score': 0.09556148767917208, 'support': 3092312}, '1': {'precision': 0.20268270803052327, 'recall': 0.19578443260900208, 'f1-score': 0.19917385874139412, 'support': 1823337}, '2': {'precision': 0.38382753993629903, 'recall': 0.7234040357490574, 'f1-score': 0.50154348470361, 'support': 3100837}, 'accuracy': 0.345229942396207, 'macro avg': {'precision': 0.33125542398198576, 'recall': 0.3244400447480987, 'f1-score': 0.26542627704139204, 'support': 8016486}, 'weighted avg': {'precision': 0.3516638347885434, 'recall': 0.345229942396207, 'f1-score': 0.2761648427555417, 'support': 8016486}}
[[ 167392  708287 2216633]
 [  81965  356981 1384391]
 [ 161667  696012 2243158]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2200004
{'0': {'precision': 0.35748018914264407, 'recall': 0.23911021209554195, 'f1-score': 0.2865522598702546, 'support': 505244}, '1': {'precision': 0.25619560162115473, 'recall': 0.057216867444340104, 'f1-score': 0.09354260742393944, 'support': 471749}, '2': {'precision': 0.3294405011694017, 'recall': 0.6830739029605032, 'f1-score': 0.44450174340073084, 'support': 497179}, 'accuracy': 0.33063373880388447, 'macro avg': {'precision': 0.31437209731106686, 'recall': 0.3264669941667951, 'f1-score': 0.27486553689830834, 'support': 1474172}, 'weighted avg': {'precision': 0.3156115015637701, 'recall': 0.33063373880388447, 'f1-score': 0.2780573595060515, 'support': 1474172}}
[[120809  39761 344674]
 [ 98172  26992 346585]
 [118965  38604 339610]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1986264
{'0': {'precision': 0.3078741165923459, 'recall': 0.14104136886347635, 'f1-score': 0.19345729095411765, 'support': 187484}, '1': {'precision': 0.27197282357673913, 'recall': 0.1119733040528521, 'f1-score': 0.15863525363043043, 'support': 163021}, '2': {'precision': 0.3608592262983053, 'recall': 0.7274050453879188, 'f1-score': 0.4824027191069105, 'support': 194435}, 'accuracy': 0.341560538774911, 'macro avg': {'precision': 0.3135687221557968, 'recall': 0.32680657276808245, 'f1-score': 0.2781650878971529, 'support': 544940}, 'weighted avg': {'precision': 0.3160392267273717, 'recall': 0.341560538774911, 'f1-score': 0.2861360830713112, 'support': 544940}}
[[ 26443  23257 137784]
 [ 32050  18254 112717]
 [ 27396  25606 141433]]
training model: results/universal/W5/deepOF_L2/h300
Epoch 1/50
9913/9913 - 227s - loss: 3.2335 - accuracy300: 0.3984 - val_loss: 3.2883 - val_accuracy300: 0.3651 - 227s/epoch - 23ms/step
Epoch 2/50
9913/9913 - 220s - loss: 3.2211 - accuracy300: 0.4041 - val_loss: 3.2945 - val_accuracy300: 0.3560 - 220s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 221s - loss: 3.2115 - accuracy300: 0.4098 - val_loss: 3.3058 - val_accuracy300: 0.3501 - 221s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 222s - loss: 3.2050 - accuracy300: 0.4131 - val_loss: 3.3034 - val_accuracy300: 0.3529 - 222s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 221s - loss: 3.2004 - accuracy300: 0.4152 - val_loss: 3.3030 - val_accuracy300: 0.3607 - 221s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 222s - loss: 3.1972 - accuracy300: 0.4170 - val_loss: 3.3007 - val_accuracy300: 0.3649 - 222s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 222s - loss: 3.1944 - accuracy300: 0.4184 - val_loss: 3.3011 - val_accuracy300: 0.3648 - 222s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 221s - loss: 3.1923 - accuracy300: 0.4193 - val_loss: 3.3050 - val_accuracy300: 0.3676 - 221s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 220s - loss: 3.1899 - accuracy300: 0.4206 - val_loss: 3.3072 - val_accuracy300: 0.3681 - 220s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 220s - loss: 3.1880 - accuracy300: 0.4211 - val_loss: 3.3026 - val_accuracy300: 0.3715 - 220s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 222s - loss: 3.1858 - accuracy300: 0.4224 - val_loss: 3.2977 - val_accuracy300: 0.3759 - 222s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 380s - 380s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026086
{'0': {'precision': 0.4237382025682344, 'recall': 0.2944038372697796, 'f1-score': 0.3474247319152248, 'support': 4850949}, '1': {'precision': 0.2505631708826817, 'recall': 0.26043513306385757, 'f1-score': 0.2554037938903231, 'support': 3024638}, '2': {'precision': 0.4168565053542495, 'recall': 0.5312136607332303, 'f1-score': 0.4671381467967419, 'support': 4962779}, 'accuracy': 0.3779418658106491, 'macro avg': {'precision': 0.3637192929350552, 'recall': 0.36201754368895583, 'f1-score': 0.3566555575340966, 'support': 12838366}, 'weighted avg': {'precision': 0.38027907981809245, 'recall': 0.3779418658106491, 'f1-score': 0.3720214131008615, 'support': 12838366}}
[[1428138 1195391 2227420]
 [ 776403  787722 1460513]
 [1165790 1160693 2636296]]
Evaluating performance on  train set...
9913/9913 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923163
{'0': {'precision': 0.3905505421310296, 'recall': 0.3112691033507652, 'f1-score': 0.3464317872687257, 'support': 847299}, '1': {'precision': 0.33984739014147575, 'recall': 0.26853828627986315, 'f1-score': 0.3000137553602502, 'support': 836566}, '2': {'precision': 0.3725980597919873, 'recall': 0.524375821210768, 'f1-score': 0.43564571438030986, 'support': 853161}, 'accuracy': 0.36884328343501405, 'macro avg': {'precision': 0.36766533068816426, 'recall': 0.3680610702804654, 'f1-score': 0.36069708566976194, 'support': 2537026}, 'weighted avg': {'precision': 0.3677944131705251, 'recall': 0.36884328343501405, 'f1-score': 0.36112698392295806, 'support': 2537026}}
[[263738 223653 359908]
 [218505 224650 393411]
 [193055 212729 447377]]
Evaluating performance on  val set...
3496/3496 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964819
{'0': {'precision': 0.3936796315250768, 'recall': 0.29185814136802063, 'f1-score': 0.33520722006742987, 'support': 305741}, '1': {'precision': 0.32440638853464504, 'recall': 0.26500175396946324, 'f1-score': 0.2917104660120331, 'support': 282217}, '2': {'precision': 0.37128016200816905, 'recall': 0.5297966753630098, 'f1-score': 0.4365953874345127, 'support': 306259}, 'accuracy': 0.36487340321197204, 'macro avg': {'precision': 0.36312206068929703, 'recall': 0.36221885690016453, 'f1-score': 0.3545043578379919, 'support': 894217}, 'weighted avg': {'precision': 0.3641452724692667, 'recall': 0.36487340321197204, 'f1-score': 0.35620381855574257, 'support': 894217}}
[[ 89233  80407 136101]
 [ 68770  74788 138659]
 [ 68661  75343 162255]]
testing model out of sample: results/universal/W5/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 159s - 159s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999868
{'0': {'precision': 0.39776453807400847, 'recall': 0.2563063982301953, 'f1-score': 0.3117386523043136, 'support': 1906199}, '1': {'precision': 0.28721867347335417, 'recall': 0.29490373198612435, 'f1-score': 0.2910104744604004, 'support': 1503355}, '2': {'precision': 0.3882384853083901, 'recall': 0.5159016431483062, 'f1-score': 0.4430571461215727, 'support': 1939265}, 'accuracy': 0.3612733951176886, 'macro avg': {'precision': 0.3577405656185843, 'recall': 0.35570392445487525, 'f1-score': 0.34860209096209555, 'support': 5348819}, 'weighted avg': {'precision': 0.36324042742580115, 'recall': 0.3612733951176886, 'f1-score': 0.3535234928663125, 'support': 5348819}}
[[ 488571  558108  859520]
 [ 343053  443345  716957]
 [ 396668  542127 1000470]]
Evaluating performance on  train set...
4957/4957 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938174
{'0': {'precision': 0.3873794356179804, 'recall': 0.2834504899987832, 'f1-score': 0.32736431887833695, 'support': 427348}, '1': {'precision': 0.3407362967614605, 'recall': 0.29047013612725603, 'f1-score': 0.31360174214589437, 'support': 418432}, '2': {'precision': 0.3679984639529836, 'recall': 0.5216040325634229, 'f1-score': 0.4315398923152227, 'support': 422560}, 'accuracy': 0.36510951322200674, 'macro avg': {'precision': 0.3653713987774749, 'recall': 0.36517488622982075, 'f1-score': 0.3575019844464847, 'support': 1268340}, 'weighted avg': {'precision': 0.36553465798361395, 'recall': 0.36510951322200674, 'f1-score': 0.3575310941942468, 'support': 1268340}}
[[121132 122119 184097]
 [102456 121542 194434]
 [ 89108 113043 220409]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934823
{'0': {'precision': 0.3878506430021809, 'recall': 0.2801349819050917, 'f1-score': 0.32530799708265157, 'support': 147279}, '1': {'precision': 0.33999738771245247, 'recall': 0.2926392265426287, 'f1-score': 0.31454572917453366, 'support': 142322}, '2': {'precision': 0.36694698248268637, 'recall': 0.5201314369384542, 'f1-score': 0.43031293987175295, 'support': 145469}, 'accuracy': 0.3644700852736341, 'macro avg': {'precision': 0.36493167106577323, 'recall': 0.3643018817953915, 'f1-score': 0.3567222220429794, 'support': 435070}, 'weighted avg': {'precision': 0.3652073773404367, 'recall': 0.3644700852736341, 'f1-score': 0.35689660702902487, 'support': 435070}}
[[41258 41655 64366]
 [34506 41649 66167]
 [30612 39194 75663]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033366
{'0': {'precision': 0.34271440178401646, 'recall': 0.22276782704451986, 'f1-score': 0.2700199535552059, 'support': 88994}, '1': {'precision': 0.2909455310158263, 'recall': 0.3562930721799057, 'f1-score': 0.320320440007174, 'support': 82710}, '2': {'precision': 0.36360881076118057, 'recall': 0.40949292748792804, 'f1-score': 0.3851892422754401, 'support': 99611}, 'accuracy': 0.3320273482852035, 'macro avg': {'precision': 0.3324229145203411, 'recall': 0.3295179422374512, 'f1-score': 0.32517654527927337, 'support': 271315}, 'weighted avg': {'precision': 0.33460393856372744, 'recall': 0.3320273482852035, 'f1-score': 0.3276374138989153, 'support': 271315}}
[[19825 33862 35307]
 [17157 29469 36084]
 [20865 37956 40790]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101916
{'0': {'precision': 0.3703196714711329, 'recall': 0.1908298755186722, 'f1-score': 0.2518688901667625, 'support': 24100}, '1': {'precision': 0.321387966710628, 'recall': 0.3095759593481689, 'f1-score': 0.31537139924582186, 'support': 22828}, '2': {'precision': 0.3385422575155984, 'recall': 0.524934036939314, 'f1-score': 0.4116206896551724, 'support': 22740}, 'accuracy': 0.3387925589940862, 'macro avg': {'precision': 0.3434166318991198, 'recall': 0.34177995726871835, 'f1-score': 0.32628699302258557, 'support': 69668}, 'weighted avg': {'precision': 0.34391398522175504, 'recall': 0.3387925589940862, 'f1-score': 0.3248204776620718, 'support': 69668}}
[[ 4599  7877 11624]
 [ 4062  7067 11699]
 [ 3758  7045 11937]]
Evaluating performance on  val set...
96/96 - 1s - 945ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103511
{'0': {'precision': 0.3926242410613897, 'recall': 0.18780251694094868, 'f1-score': 0.2540745052386496, 'support': 9297}, '1': {'precision': 0.28010406342913774, 'recall': 0.3363582267182386, 'f1-score': 0.30566445856428276, 'support': 6722}, '2': {'precision': 0.36821899515940576, 'recall': 0.5201603395425607, 'f1-score': 0.4311962470680219, 'support': 8482}, 'accuracy': 0.34361862781110974, 'macro avg': {'precision': 0.3469824332166444, 'recall': 0.348107027733916, 'f1-score': 0.3303117369569848, 'support': 24501}, 'weighted avg': {'precision': 0.35330478757848593, 'recall': 0.34361862781110974, 'f1-score': 0.32954629334736524, 'support': 24501}}
[[1746 3140 4411]
 [1302 2261 3159]
 [1399 2671 4412]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1044294
{'0': {'precision': 0.4715207929185074, 'recall': 0.2597421840272633, 'f1-score': 0.3349652434981746, 'support': 222717}, '1': {'precision': 0.17379774689210284, 'recall': 0.2382867899229004, 'f1-score': 0.20099617191578217, 'support': 116343}, '2': {'precision': 0.43436509483686037, 'recall': 0.5465587964077568, 'f1-score': 0.48404583791786265, 'support': 220141}, 'accuracy': 0.3681896133948258, 'macro avg': {'precision': 0.35989454488249023, 'recall': 0.34819592345264017, 'f1-score': 0.34000241777727314, 'support': 559201}, 'weighted avg': {'precision': 0.39495175088310003, 'recall': 0.3681896133948258, 'f1-score': 0.36578133188327094, 'support': 559201}}
[[ 57849  69590  95278]
 [ 27216  27723  61404]
 [ 37621  62200 120320]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0848545
{'0': {'precision': 0.42547390949857317, 'recall': 0.3417933970567165, 'f1-score': 0.3790704273310255, 'support': 48857}, '1': {'precision': 0.276347726111395, 'recall': 0.17621064635686068, 'f1-score': 0.21520057698525205, 'support': 49106}, '2': {'precision': 0.39700486709097715, 'recall': 0.6033341551766647, 'f1-score': 0.47889083751702954, 'support': 52727}, 'accuracy': 0.37934833101068416, 'macro avg': {'precision': 0.36627550090031513, 'recall': 0.3737793995300806, 'f1-score': 0.3577206139444357, 'support': 150690}, 'weighted avg': {'precision': 0.36691609172409523, 'recall': 0.37934833101068416, 'f1-score': 0.3605969911162659, 'support': 150690}}
[[16699 11459 20699]
 [12834  8653 27619]
 [ 9715 11200 31812]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947132
{'0': {'precision': 0.44021925316889343, 'recall': 0.31877945919126766, 'f1-score': 0.36978417266187047, 'support': 20155}, '1': {'precision': 0.21613855854417752, 'recall': 0.17893484868507994, 'f1-score': 0.19578498355203702, 'support': 15134}, '2': {'precision': 0.4149505487061374, 'recall': 0.5735755419261201, 'f1-score': 0.4815360729516735, 'support': 21359}, 'accuracy': 0.37748905521818954, 'macro avg': {'precision': 0.3571027868064028, 'recall': 0.35709661660082254, 'f1-score': 0.349035076388527, 'support': 56648}, 'weighted avg': {'precision': 0.3708266622376962, 'recall': 0.37748905521818954, 'f1-score': 0.3654345947474107, 'support': 56648}}
[[ 6425  4948  8782]
 [ 3935  2708  8491]
 [ 4235  4873 12251]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1053499
{'0': {'precision': 0.40748592338540895, 'recall': 0.26297650221558005, 'f1-score': 0.3196576534111522, 'support': 229511}, '1': {'precision': 0.20895826022388023, 'recall': 0.3347782865896387, 'f1-score': 0.2573109669984876, 'support': 122726}, '2': {'precision': 0.4334890408860009, 'recall': 0.44664246015843523, 'f1-score': 0.43996746268775744, 'support': 247041}, 'accuracy': 0.3533935836122801, 'macro avg': {'precision': 0.34997774149843003, 'recall': 0.34813241632121805, 'f1-score': 0.3389786943657991, 'support': 599278}, 'weighted avg': {'precision': 0.3775487826282011, 'recall': 0.3533935836122801, 'f1-score': 0.3564851294019631, 'support': 599278}}
[[ 60356  77201  91954]
 [ 29396  41086  52244]
 [ 58366  78336 110339]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998707
{'0': {'precision': 0.3570157559286939, 'recall': 0.2666038510787369, 'f1-score': 0.30525587828492395, 'support': 41391}, '1': {'precision': 0.31752448652901755, 'recall': 0.2852859441275413, 'f1-score': 0.30054315027157513, 'support': 41022}, '2': {'precision': 0.3472705738793382, 'recall': 0.47109228559604666, 'f1-score': 0.3998140591911575, 'support': 41079}, 'accuracy': 0.340831794772131, 'macro avg': {'precision': 0.3406036054456832, 'recall': 0.3409940269341083, 'f1-score': 0.3352043625825522, 'support': 123492}, 'weighted avg': {'precision': 0.3406557229976619, 'recall': 0.340831794772131, 'f1-score': 0.33514469687142, 'support': 123492}}
[[11035 12866 17490]
 [10435 11703 18884]
 [ 9439 12288 19352]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022685
{'0': {'precision': 0.38842890728815294, 'recall': 0.2513726268439505, 'f1-score': 0.3052208835341365, 'support': 15117}, '1': {'precision': 0.2843033775633293, 'recall': 0.3225006414093902, 'f1-score': 0.3021997836278399, 'support': 11693}, '2': {'precision': 0.3659991245349092, 'recall': 0.4608971267139806, 'f1-score': 0.4080026838268932, 'support': 14513}, 'accuracy': 0.34508627156789196, 'macro avg': {'precision': 0.34624380312879716, 'recall': 0.3449234649891071, 'f1-score': 0.33847445032962326, 'support': 41323}, 'weighted avg': {'precision': 0.35108739635791575, 'recall': 0.34508627156789196, 'f1-score': 0.34046388492426916, 'support': 41323}}
[[3800 4926 6391]
 [2726 3771 5196]
 [3257 4567 6689]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
2027/2027 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998266
{'0': {'precision': 0.31033387298775084, 'recall': 0.3168001297210996, 'f1-score': 0.3135336651966336, 'support': 160344}, '1': {'precision': 0.3995291869946436, 'recall': 0.28879977903386506, 'f1-score': 0.33525812980781616, 'support': 202746}, '2': {'precision': 0.30843782353617855, 'recall': 0.4130772489761333, 'f1-score': 0.3531697464971159, 'support': 155782}, 'accuracy': 0.33476464330316535, 'macro avg': {'precision': 0.3394336278395243, 'recall': 0.3395590525770326, 'f1-score': 0.3339871805005219, 'support': 518872}, 'weighted avg': {'precision': 0.3446171312055322, 'recall': 0.33476464330316535, 'f1-score': 0.3339223859586145, 'support': 518872}}
[[50797 45474 64073]
 [63984 58553 80209]
 [48904 42528 64350]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999092
{'0': {'precision': 0.327549322557642, 'recall': 0.3489491010382375, 'f1-score': 0.3379107405590976, 'support': 27643}, '1': {'precision': 0.33170379868568683, 'recall': 0.2961081699813993, 'f1-score': 0.31289688539461746, 'support': 27956}, '2': {'precision': 0.35853820598006647, 'recall': 0.373348093821352, 'f1-score': 0.36579330915500124, 'support': 28906}, 'accuracy': 0.33981421217679425, 'macro avg': {'precision': 0.3392637757411318, 'recall': 0.33946845494699623, 'f1-score': 0.3388669783695721, 'support': 84505}, 'weighted avg': {'precision': 0.33952384712830913, 'recall': 0.33981421217679425, 'f1-score': 0.33917322435123987, 'support': 84505}}
[[ 9646  8403  9594]
 [ 9964  8278  9714]
 [ 9839  8275 10792]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024134
{'0': {'precision': 0.3379316906098373, 'recall': 0.29868819374369326, 'f1-score': 0.3171003883408472, 'support': 11892}, '1': {'precision': 0.3099216171617162, 'recall': 0.27081831290555153, 'f1-score': 0.28905348210850323, 'support': 11096}, '2': {'precision': 0.33721892674851706, 'recall': 0.4172569770419049, 'f1-score': 0.3729925615105855, 'support': 11717}, 'accuracy': 0.32980838495893966, 'macro avg': {'precision': 0.3283574115066902, 'recall': 0.32892116123038323, 'f1-score': 0.3263821439866453, 'support': 34705}, 'weighted avg': {'precision': 0.32873557393663627, 'recall': 0.32980838495893966, 'f1-score': 0.3270032876774194, 'support': 34705}}
[[3552 3406 4934]
 [3416 3005 4675]
 [3543 3285 4889]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
2900/2900 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029972
{'0': {'precision': 0.3733656873790334, 'recall': 0.24053836762647768, 'f1-score': 0.29258243934904216, 'support': 268664}, '1': {'precision': 0.2826482064404611, 'recall': 0.31805115248015636, 'f1-score': 0.29930642165615384, 'support': 209765}, '2': {'precision': 0.3654303797088489, 'recall': 0.46139040026674344, 'f1-score': 0.4078418763700425, 'support': 263924}, 'accuracy': 0.34095908550244963, 'macro avg': {'precision': 0.34048142450944785, 'recall': 0.3399933067911258, 'f1-score': 0.33324357912507946, 'support': 742353}, 'weighted avg': {'precision': 0.3449106659396031, 'recall': 0.34095908550244963, 'f1-score': 0.3354598680183972, 'support': 742353}}
[[ 64624  85911 118129]
 [ 49721  66716  93328]
 [ 58740  83412 121772]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977181
{'0': {'precision': 0.3605114838824656, 'recall': 0.2722302593950813, 'f1-score': 0.3102122969281641, 'support': 59446}, '1': {'precision': 0.33752862508015025, 'recall': 0.3085838706975965, 'f1-score': 0.3224079097033862, 'support': 59705}, '2': {'precision': 0.3450363506041368, 'recall': 0.46118971446168583, 'f1-score': 0.3947458979784593, 'support': 58451}, 'accuracy': 0.34664024053783177, 'macro avg': {'precision': 0.3476921531889175, 'recall': 0.3473346148514545, 'f1-score': 0.3424553682033365, 'support': 177602}, 'weighted avg': {'precision': 0.3476922104506133, 'recall': 0.34664024053783177, 'f1-score': 0.3421331794392588, 'support': 177602}}
[[16183 18476 24787]
 [14897 18424 26384]
 [13809 17685 26957]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093914
{'0': {'precision': 0.3497018144905469, 'recall': 0.28252178370066633, 'f1-score': 0.312542526650034, 'support': 19510}, '1': {'precision': 0.37767411935016887, 'recall': 0.32135036496350367, 'f1-score': 0.3472431046806832, 'support': 21920}, '2': {'precision': 0.34301050880774175, 'recall': 0.4668415907804702, 'f1-score': 0.3954588045586281, 'support': 19437}, 'accuracy': 0.35536497609542117, 'macro avg': {'precision': 0.35679548088281915, 'recall': 0.35690457981488005, 'f1-score': 0.35174814529644843, 'support': 60867}, 'weighted avg': {'precision': 0.35763869348846417, 'recall': 0.35536497609542117, 'f1-score': 0.3515173465711928, 'support': 60867}}
[[5512 5873 8125]
 [5621 7044 9255]
 [4629 5734 9074]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/EXC
Evaluating performance on  test set...
7167/7167 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.089636
{'0': {'precision': 0.4115952487991861, 'recall': 0.33730627467266056, 'f1-score': 0.37076613064371605, 'support': 618853}, '1': {'precision': 0.34471943331772703, 'recall': 0.284907874347238, 'f1-score': 0.3119727489488082, 'support': 558205}, '2': {'precision': 0.4114470393437853, 'recall': 0.5419508203702464, 'f1-score': 0.4677670675244787, 'support': 657508}, 'accuracy': 0.3947075221060458, 'macro avg': {'precision': 0.3892539071535661, 'recall': 0.388054989796715, 'f1-score': 0.3835019823723343, 'support': 1834566}, 'weighted avg': {'precision': 0.39119376774948306, 'recall': 0.3947075221060458, 'f1-score': 0.38764212876948007, 'support': 1834566}}
[[208743 151662 258448]
 [147895 159037 251273]
 [150518 150653 356337]]
Evaluating performance on  train set...
1570/1570 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0851214
{'0': {'precision': 0.41601209228861846, 'recall': 0.35889321113821676, 'f1-score': 0.38534751282131957, 'support': 136503}, '1': {'precision': 0.37496909831572384, 'recall': 0.26050658621822637, 'f1-score': 0.3074292915273206, 'support': 133916}, '2': {'precision': 0.3806842289982766, 'recall': 0.5535725167580744, 'f1-score': 0.45113150682380404, 'support': 131280}, 'accuracy': 0.3897171762936925, 'macro avg': {'precision': 0.3905551398675396, 'recall': 0.3909907713715059, 'f1-score': 0.3813027703908147, 'support': 401699}, 'weighted avg': {'precision': 0.39078386051898445, 'recall': 0.3897171762936925, 'f1-score': 0.38087059405836277, 'support': 401699}}
[[48990 30385 57128]
 [37930 34886 61100]
 [30841 27766 72673]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0896461
{'0': {'precision': 0.42255326943036814, 'recall': 0.31352918525900925, 'f1-score': 0.35996723315172874, 'support': 44149}, '1': {'precision': 0.3530366014397242, 'recall': 0.2574745507875083, 'f1-score': 0.2977765108323831, 'support': 40571}, '2': {'precision': 0.37020330268283835, 'recall': 0.5720692176456251, 'f1-score': 0.44951308494441417, 'support': 41030}, 'accuracy': 0.37980119284294234, 'macro avg': {'precision': 0.3819310578509769, 'recall': 0.3810243178973809, 'f1-score': 0.36908560964284204, 'support': 125750}, 'weighted avg': {'precision': 0.38304408555204167, 'recall': 0.37980119284294234, 'f1-score': 0.369119730200124, 'support': 125750}}
[[13842 10252 20055]
 [10249 10446 19876]
 [ 8667  8891 23472]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/AAL
Evaluating performance on  test set...
6357/6357 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954171
{'0': {'precision': 0.41146744412050534, 'recall': 0.2831444143511552, 'f1-score': 0.335452690791689, 'support': 568233}, '1': {'precision': 0.3304404501542517, 'recall': 0.2302360831629533, 'f1-score': 0.2713839814625373, 'support': 495461}, '2': {'precision': 0.38461650703928146, 'recall': 0.6081353044527659, 'f1-score': 0.4712131952785996, 'support': 563470}, 'accuracy': 0.3795751380930257, 'macro avg': {'precision': 0.3755081337713462, 'recall': 0.37383860065562474, 'f1-score': 0.35934995584427526, 'support': 1627164}, 'weighted avg': {'precision': 0.377497043488073, 'recall': 0.3795751380930257, 'f1-score': 0.36295663303125963, 'support': 1627164}}
[[160892 119575 287766]
 [120891 114073 260497]
 [109237 111567 342666]]
Evaluating performance on  train set...
1701/1701 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0901606
{'0': {'precision': 0.4053995894855327, 'recall': 0.33209036177252266, 'f1-score': 0.36510137149672034, 'support': 147496}, '1': {'precision': 0.34623446082682857, 'recall': 0.2697885281446231, 'f1-score': 0.3032681807390995, 'support': 142052}, '2': {'precision': 0.3814502761076182, 'recall': 0.533214506067046, 'f1-score': 0.4447417775948035, 'support': 145870}, 'accuracy': 0.3791437193685149, 'macro avg': {'precision': 0.37769477547332647, 'recall': 0.37836446532806395, 'f1-score': 0.37103710994354105, 'support': 435418}, 'weighted avg': {'precision': 0.37807409720303026, 'recall': 0.3791437193685149, 'f1-score': 0.37160918151841404, 'support': 435418}}
[[48982 37307 61207]
 [38809 38324 64919]
 [33033 35057 77780]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0911779
{'0': {'precision': 0.40532955505299584, 'recall': 0.30424378770835464, 'f1-score': 0.3475863358100846, 'support': 48895}, '1': {'precision': 0.34815840327651354, 'recall': 0.25446381516537725, 'f1-score': 0.29402737857456035, 'support': 47437}, '2': {'precision': 0.3715209465501823, 'recall': 0.5658250392875851, 'f1-score': 0.44853417490241676, 'support': 47725}, 'accuracy': 0.3745114780954761, 'macro avg': {'precision': 0.37500296829323054, 'recall': 0.3748442140537723, 'f1-score': 0.3633826297623539, 'support': 144057}, 'weighted avg': {'precision': 0.3753029422010153, 'recall': 0.3745114780954761, 'f1-score': 0.36339299127493524, 'support': 144057}}
[[14876 11932 22087]
 [11772 12071 23594]
 [10053 10668 27004]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/WBA
Evaluating performance on  test set...
7458/7458 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984697
{'0': {'precision': 0.40007200798370396, 'recall': 0.2467856323055505, 'f1-score': 0.3052666222319327, 'support': 670894}, '1': {'precision': 0.31204390864146253, 'recall': 0.3062355864633427, 'f1-score': 0.30911246490208677, 'support': 559370}, '2': {'precision': 0.3875058772564703, 'recall': 0.5401512853065324, 'f1-score': 0.4512697278930398, 'support': 678982}, 'accuracy': 0.36853239446357355, 'macro avg': {'precision': 0.3665405979605456, 'recall': 0.36439083469180855, 'f1-score': 0.3552162716756864, 'support': 1909246}, 'weighted avg': {'precision': 0.3698127043096315, 'recall': 0.36853239446357355, 'f1-score': 0.3583162186183564, 'support': 1909246}}
[[165567 193710 311617]
 [119996 171299 268075]
 [128280 183949 366753]]
Evaluating performance on  train set...
1664/1664 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0883592
{'0': {'precision': 0.41024313597268014, 'recall': 0.3114716793777324, 'f1-score': 0.35409864338882335, 'support': 145018}, '1': {'precision': 0.3522146587973526, 'recall': 0.2694604731679169, 'f1-score': 0.3053296608992015, 'support': 138640}, '2': {'precision': 0.38071995118974983, 'recall': 0.5612812098128641, 'f1-score': 0.4536957355259234, 'support': 142303}, 'accuracy': 0.3812532133223464, 'macro avg': {'precision': 0.38105924865326085, 'recall': 0.38073778745283776, 'f1-score': 0.37104134660464944, 'support': 425961}, 'weighted avg': {'precision': 0.38149330713916546, 'recall': 0.3812532133223464, 'f1-score': 0.37149843649200553, 'support': 425961}}
[[45169 36170 63679]
 [35041 37358 66241]
 [29893 32538 79872]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932094
{'0': {'precision': 0.405398322851153, 'recall': 0.27214354824522824, 'f1-score': 0.32566707015420243, 'support': 45476}, '1': {'precision': 0.33176979468022355, 'recall': 0.2874945236820328, 'f1-score': 0.30804939430687583, 'support': 41086}, '2': {'precision': 0.38123069468838955, 'recall': 0.5519917567360182, 'f1-score': 0.45098829450907685, 'support': 45613}, 'accuracy': 0.37348969169661433, 'macro avg': {'precision': 0.37279960407325535, 'recall': 0.3705432762210931, 'f1-score': 0.3615682529900517, 'support': 132175}, 'weighted avg': {'precision': 0.3741710882620179, 'recall': 0.37348969169661433, 'f1-score': 0.363438488173008, 'support': 132175}}
[[12376 12304 20796]
 [ 9204 11812 20070]
 [ 8948 11487 25178]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
8238/8238 - 63s - 63s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004281
{'0': {'precision': 0.39889513869767973, 'recall': 0.24312830232406363, 'f1-score': 0.3021157536632818, 'support': 750797}, '1': {'precision': 0.2885639298473726, 'recall': 0.3235216208053748, 'f1-score': 0.30504451605051597, 'support': 592693}, '2': {'precision': 0.39005332449490726, 'recall': 0.502897863226083, 'f1-score': 0.4393453665330913, 'support': 765219}, 'accuracy': 0.35999087593404305, 'macro avg': {'precision': 0.35917079767998655, 'recall': 0.3565159287851738, 'f1-score': 0.3488352120822964, 'support': 2108709}, 'weighted avg': {'precision': 0.3646758797152661, 'recall': 0.35999087593404305, 'f1-score': 0.3527375151752779, 'support': 2108709}}
[[182540 241647 326610]
 [125780 191749 275164]
 [149294 231098 384827]]
Evaluating performance on  train set...
1806/1806 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093078
{'0': {'precision': 0.39212624232433946, 'recall': 0.2625827066455798, 'f1-score': 0.31453845321126456, 'support': 154915}, '1': {'precision': 0.3443739616372149, 'recall': 0.2983935874366105, 'f1-score': 0.31973917158933546, 'support': 152825}, '2': {'precision': 0.3708711831258877, 'recall': 0.542792384406165, 'f1-score': 0.44065684777208525, 'support': 154420}, 'accuracy': 0.3680500259650338, 'macro avg': {'precision': 0.369123795695814, 'recall': 0.3679228928294518, 'f1-score': 0.35831149085756175, 'support': 462160}, 'weighted avg': {'precision': 0.36923384891635364, 'recall': 0.3680500259650338, 'f1-score': 0.3583977276491445, 'support': 462160}}
[[40678 45220 69017]
 [34055 45602 73168]
 [29004 41598 83818]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913389
{'0': {'precision': 0.3893183415319747, 'recall': 0.2848329048843188, 'f1-score': 0.32897862232779096, 'support': 54460}, '1': {'precision': 0.3494646056414316, 'recall': 0.3075160403299725, 'f1-score': 0.327151103830252, 'support': 54550}, '2': {'precision': 0.37164600659030284, 'recall': 0.5138487127567255, 'f1-score': 0.43132910431905785, 'support': 55312}, 'accuracy': 0.3694514428986989, 'macro avg': {'precision': 0.370142984587903, 'recall': 0.36873255265700555, 'f1-score': 0.3624862768257003, 'support': 164322}, 'weighted avg': {'precision': 0.37013945201551995, 'recall': 0.3694514428986989, 'f1-score': 0.3628238696218855, 'support': 164322}}
[[15512 15734 23214]
 [12935 16775 24840]
 [11397 15493 28422]]
testing model on single stock: results/universal/W5/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
31315/31315 - 237s - 237s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066338
{'0': {'precision': 0.43694920004088006, 'recall': 0.2973024167272629, 'f1-score': 0.3538461480847341, 'support': 3178141}, '1': {'precision': 0.20319634203703907, 'recall': 0.23395345263839332, 'f1-score': 0.21749288853425067, 'support': 1587974}, '2': {'precision': 0.42939023548097505, 'recall': 0.5318182629279288, 'f1-score': 0.47514679599630794, 'support': 3250366}, 'accuracy': 0.3798406058718283, 'macro avg': {'precision': 0.35651192585296476, 'recall': 0.3543580440978616, 'f1-score': 0.34882861087176426, 'support': 8016481}, 'weighted avg': {'precision': 0.3875805478434244, 'recall': 0.3798406058718283, 'f1-score': 0.37601872864325236, 'support': 8016481}}
[[ 944869  735483 1497789]
 [ 417137  371512  799325]
 [ 800417  721345 1728604]]
Evaluating performance on  train set...
5759/5759 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957705
{'0': {'precision': 0.37771246903996153, 'recall': 0.292359353986895, 'f1-score': 0.3295998119798339, 'support': 489278}, '1': {'precision': 0.3349322534662451, 'recall': 0.27889836286420727, 'f1-score': 0.30435776475465864, 'support': 486948}, '2': {'precision': 0.36605674118627485, 'recall': 0.5072246934902449, 'f1-score': 0.4252306552629807, 'support': 497945}, 'accuracy': 0.3604900652637991, 'macro avg': {'precision': 0.3595671545641605, 'recall': 0.3594941367804491, 'f1-score': 0.35306274399915777, 'support': 1474171}, 'weighted avg': {'precision': 0.35964424505557024, 'recall': 0.3604900652637991, 'f1-score': 0.35356401684237826, 'support': 1474171}}
[[143045 137284 208949]
 [122683 135809 228456]
 [112986 132389 252570]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985925
{'0': {'precision': 0.38572209986901007, 'recall': 0.2911571204276657, 'f1-score': 0.33183390039348504, 'support': 184069}, '1': {'precision': 0.32758499578533296, 'recall': 0.26750989502667355, 'f1-score': 0.2945151409896113, 'support': 174330}, '2': {'precision': 0.366124633492264, 'recall': 0.5174439798434652, 'f1-score': 0.4288268836479874, 'support': 186540}, 'accuracy': 0.36105325550199197, 'macro avg': {'precision': 0.3598105763822024, 'recall': 0.35870366509926815, 'f1-score': 0.3517253083436946, 'support': 544939}, 'weighted avg': {'precision': 0.3604151338914866, 'recall': 0.36105325550199197, 'f1-score': 0.3530973661564742, 'support': 544939}}
[[53593 49012 81464]
 [42046 46635 85649]
 [43303 46713 96524]]
training model: results/universal/W5/deepOF_L2/h500
Epoch 1/50
9913/9913 - 222s - loss: 3.2456 - accuracy500: 0.3918 - val_loss: 3.2919 - val_accuracy500: 0.3675 - 222s/epoch - 22ms/step
Epoch 2/50
9913/9913 - 218s - loss: 3.2401 - accuracy500: 0.3934 - val_loss: 3.2979 - val_accuracy500: 0.3664 - 218s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 220s - loss: 3.2354 - accuracy500: 0.3966 - val_loss: 3.2943 - val_accuracy500: 0.3672 - 220s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 218s - loss: 3.2304 - accuracy500: 0.3991 - val_loss: 3.2891 - val_accuracy500: 0.3687 - 218s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 219s - loss: 3.2265 - accuracy500: 0.4014 - val_loss: 3.2860 - val_accuracy500: 0.3689 - 219s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 219s - loss: 3.2233 - accuracy500: 0.4030 - val_loss: 3.2857 - val_accuracy500: 0.3687 - 219s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 218s - loss: 3.2211 - accuracy500: 0.4043 - val_loss: 3.2873 - val_accuracy500: 0.3692 - 218s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 220s - loss: 3.2191 - accuracy500: 0.4053 - val_loss: 3.2858 - val_accuracy500: 0.3708 - 220s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 219s - loss: 3.2172 - accuracy500: 0.4066 - val_loss: 3.2861 - val_accuracy500: 0.3703 - 219s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 220s - loss: 3.2151 - accuracy500: 0.4079 - val_loss: 3.2899 - val_accuracy500: 0.3699 - 220s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 219s - loss: 3.2130 - accuracy500: 0.4091 - val_loss: 3.2900 - val_accuracy500: 0.3699 - 219s/epoch - 22ms/step
Epoch 12/50
9913/9913 - 218s - loss: 3.2114 - accuracy500: 0.4105 - val_loss: 3.2933 - val_accuracy500: 0.3695 - 218s/epoch - 22ms/step
Epoch 13/50
9913/9913 - 219s - loss: 3.2101 - accuracy500: 0.4113 - val_loss: 3.2980 - val_accuracy500: 0.3690 - 219s/epoch - 22ms/step
Epoch 14/50
9913/9913 - 218s - loss: 3.2085 - accuracy500: 0.4123 - val_loss: 3.2965 - val_accuracy500: 0.3695 - 218s/epoch - 22ms/step
Epoch 15/50
9913/9913 - 219s - loss: 3.2071 - accuracy500: 0.4131 - val_loss: 3.3015 - val_accuracy500: 0.3690 - 219s/epoch - 22ms/step
Epoch 16/50
9913/9913 - 219s - loss: 3.2053 - accuracy500: 0.4142 - val_loss: 3.3046 - val_accuracy500: 0.3683 - 219s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 381s - 381s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0856892
{'0': {'precision': 0.4138419453878166, 'recall': 0.19537025986409437, 'f1-score': 0.2654326611189524, 'support': 4809514}, '1': {'precision': 0.2945023701748104, 'recall': 0.08778513713759384, 'f1-score': 0.1352538623869559, 'support': 3138709}, '2': {'precision': 0.3951797615139621, 'recall': 0.7783974824458099, 'f1-score': 0.5242210226198759, 'support': 4890143}, 'accuracy': 0.39114346794599875, 'macro avg': {'precision': 0.36784135902552967, 'recall': 0.35385095981583276, 'f1-score': 0.3083025153752614, 'support': 12838366}, 'weighted avg': {'precision': 0.37755750337917765, 'recall': 0.39114346794599875, 'f1-score': 0.3321793738459385, 'support': 12838366}}
[[ 939636  334346 3535532]
 [ 572922  275532 2290255]
 [ 757961  325707 3806475]]
Evaluating performance on  train set...
9913/9913 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976516
{'0': {'precision': 0.3676490840483656, 'recall': 0.2974624528644902, 'f1-score': 0.32885250748173006, 'support': 852595}, '1': {'precision': 0.35662372922786817, 'recall': 0.09826857270010043, 'f1-score': 0.1540800084489405, 'support': 831395}, '2': {'precision': 0.36211454887942923, 'recall': 0.6868866026756197, 'f1-score': 0.47422566103094116, 'support': 853036}, 'accuracy': 0.3631235943187023, 'macro avg': {'precision': 0.36212912071855435, 'recall': 0.3608725427467368, 'f1-score': 0.3190527256538706, 'support': 2537026}, 'weighted avg': {'precision': 0.36217512256221757, 'recall': 0.3631235943187023, 'f1-score': 0.320458250417608, 'support': 2537026}}
[[253615  75942 523038]
 [240568  81700 509127]
 [195646  71451 585939]]
Evaluating performance on  val set...
3496/3496 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095099
{'0': {'precision': 0.3764378901184705, 'recall': 0.2564018145729327, 'f1-score': 0.3050357219525239, 'support': 315887}, '1': {'precision': 0.3334343114440329, 'recall': 0.09186023132921356, 'f1-score': 0.14403830711120363, 'support': 263607}, '2': {'precision': 0.37065143007906864, 'recall': 0.7142026480428821, 'f1-score': 0.48802919803117384, 'support': 314723}, 'accuracy': 0.3690211660033303, 'macro avg': {'precision': 0.360174543880524, 'recall': 0.35415489798167615, 'f1-score': 0.3123677423649671, 'support': 894217}, 'weighted avg': {'precision': 0.36172426196488683, 'recall': 0.3690211660033303, 'f1-score': 0.32198039001164713, 'support': 894217}}
[[ 80994  24757 210136]
 [ 67869  24215 171523]
 [ 66296  23651 224776]]
testing model out of sample: results/universal/W5/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 158s - 158s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959674
{'0': {'precision': 0.39693215985253927, 'recall': 0.22534861035058154, 'f1-score': 0.2874847332885686, 'support': 1930307}, '1': {'precision': 0.274857293376024, 'recall': 0.11549834347278778, 'f1-score': 0.16264943594827685, 'support': 1454549}, '2': {'precision': 0.37881932001817825, 'recall': 0.7024327851390275, 'f1-score': 0.49219808915174934, 'support': 1963963}, 'accuracy': 0.37065041834468504, 'macro avg': {'precision': 0.3502029244155805, 'recall': 0.3477599129874656, 'f1-score': 0.31411075279619827, 'support': 5348819}, 'weighted avg': {'precision': 0.3570847052615052, 'recall': 0.37065041834468504, 'f1-score': 0.32870325266828515, 'support': 5348819}}
[[ 434992  221902 1273413]
 [ 297801  167998  988750]
 [ 363092  221319 1379552]]
Evaluating performance on  train set...
4957/4957 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041071
{'0': {'precision': 0.36823030824293207, 'recall': 0.24864119298689316, 'f1-score': 0.29684374445219486, 'support': 427029}, '1': {'precision': 0.32385195339273476, 'recall': 0.10581651323689176, 'f1-score': 0.1595131464116276, 'support': 419736}, '2': {'precision': 0.347461588657531, 'recall': 0.6946759176896163, 'f1-score': 0.46322715858987284, 'support': 421575}, 'accuracy': 0.349630225333901, 'macro avg': {'precision': 0.34651461676439926, 'recall': 0.34971120797113375, 'f1-score': 0.3065280164845651, 'support': 1268340}, 'weighted avg': {'precision': 0.3466408558006706, 'recall': 0.349630225333901, 'f1-score': 0.30669953384300175, 'support': 1268340}}
[[106177  47926 272926]
 [ 98255  44415 277066]
 [ 83912  44805 292858]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999414
{'0': {'precision': 0.3840040549328641, 'recall': 0.26470607624811293, 'f1-score': 0.31338559938810473, 'support': 151689}, '1': {'precision': 0.31170205728649863, 'recall': 0.10594160321362192, 'f1-score': 0.1581358406559908, 'support': 133432}, '2': {'precision': 0.35701635952376776, 'recall': 0.6789308364844047, 'f1-score': 0.4679570861219386, 'support': 149949}, 'accuracy': 0.3587790470499, 'macro avg': {'precision': 0.3509074905810435, 'recall': 0.34985950531537985, 'f1-score': 0.31315950872201137, 'support': 435070}, 'weighted avg': {'precision': 0.35252825083502143, 'recall': 0.3587790470499, 'f1-score': 0.31904573237155165, 'support': 435070}}
[[ 40153  15850  95686]
 [ 31632  14136  87664]
 [ 32779  15365 101805]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1075971
{'0': {'precision': 0.3085866405889224, 'recall': 0.13320825515947468, 'f1-score': 0.1860876544928866, 'support': 85280}, '1': {'precision': 0.2952104365463514, 'recall': 0.1440298675303061, 'f1-score': 0.1936029989721265, 'support': 88926}, '2': {'precision': 0.3567780824211474, 'recall': 0.7021594290951405, 'f1-score': 0.4731442449475237, 'support': 97109}, 'accuracy': 0.34039400696607264, 'macro avg': {'precision': 0.3201917198521404, 'recall': 0.32646585059497374, 'f1-score': 0.2842782994708456, 'support': 271315}, 'weighted avg': {'precision': 0.32145113537983283, 'recall': 0.34039400696607264, 'f1-score': 0.29129410443343634, 'support': 271315}}
[[11360 14310 59610]
 [12798 12808 63320]
 [12655 16268 68186]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108559
{'0': {'precision': 0.37086170462549894, 'recall': 0.13283155327558657, 'f1-score': 0.19560371517027864, 'support': 23782}, '1': {'precision': 0.32946979038224417, 'recall': 0.11194905312552371, 'f1-score': 0.16711489148789793, 'support': 23868}, '2': {'precision': 0.32154977375565613, 'recall': 0.7745935143973113, 'f1-score': 0.4544485597804365, 'support': 22018}, 'accuracy': 0.32850088993512083, 'macro avg': {'precision': 0.3406270895877997, 'recall': 0.3397913735994738, 'f1-score': 0.2723890554795377, 'support': 69668}, 'weighted avg': {'precision': 0.34109635607164057, 'recall': 0.32850088993512083, 'f1-score': 0.26764933934458235, 'support': 69668}}
[[ 3159  2920 17703]
 [ 2914  2672 18282]
 [ 2445  2518 17055]]
Evaluating performance on  val set...
96/96 - 1s - 944ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045914
{'0': {'precision': 0.3683758235462618, 'recall': 0.1431274346132443, 'f1-score': 0.2061558191728118, 'support': 8985}, '1': {'precision': 0.3086597197269134, 'recall': 0.1165061711650617, 'f1-score': 0.16916108704214258, 'support': 7373}, '2': {'precision': 0.3367531683765842, 'recall': 0.7537762495394817, 'f1-score': 0.4655290102389079, 'support': 8143}, 'accuracy': 0.3380678339659606, 'macro avg': {'precision': 0.33792957054991984, 'recall': 0.3378032851059292, 'f1-score': 0.2802819721512874, 'support': 24501}, 'weighted avg': {'precision': 0.3398957568344239, 'recall': 0.3380678339659606, 'f1-score': 0.28122678504570664, 'support': 24501}}
[[1286 1012 6687]
 [1112  859 5402]
 [1093  912 6138]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0857021
{'0': {'precision': 0.44753066734698216, 'recall': 0.19709283273254996, 'f1-score': 0.27366388892500093, 'support': 213610}, '1': {'precision': 0.287069238065128, 'recall': 0.11944399783679495, 'f1-score': 0.16869658560753065, 'support': 136834}, '2': {'precision': 0.39451190980737055, 'recall': 0.7714088629363327, 'f1-score': 0.5220423048869439, 'support': 208757}, 'accuracy': 0.39249214504265906, 'macro avg': {'precision': 0.3763706050731603, 'recall': 0.3626485645018926, 'f1-score': 0.32146759313982515, 'support': 559201}, 'weighted avg': {'precision': 0.3884738774234127, 'recall': 0.39249214504265906, 'f1-score': 0.34070174650899054, 'support': 559201}}
[[ 42101  21799 149710]
 [ 23044  16344  97446]
 [ 28929  18791 161037]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.083324
{'0': {'precision': 0.4229398957577357, 'recall': 0.26153563706091143, 'f1-score': 0.3232076232731673, 'support': 49022}, '1': {'precision': 0.4155113103304493, 'recall': 0.08385223830360149, 'f1-score': 0.1395438393810499, 'support': 47536}, '2': {'precision': 0.39060144607024544, 'recall': 0.7993792950565285, 'f1-score': 0.5247794318285177, 'support': 54132}, 'accuracy': 0.3986926803371159, 'macro avg': {'precision': 0.40968421738614347, 'recall': 0.38158905680701377, 'f1-score': 0.3291769648275783, 'support': 150690}, 'weighted avg': {'precision': 0.40897964494245465, 'recall': 0.3986926803371159, 'f1-score': 0.3376800070386629, 'support': 150690}}
[[12821  2904 33297]
 [ 9336  3986 34214]
 [ 8157  2703 43272]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0858866
{'0': {'precision': 0.41585511703399963, 'recall': 0.24307185299845208, 'f1-score': 0.3068099454826206, 'support': 20027}, '1': {'precision': 0.37828601472134593, 'recall': 0.09004442775796258, 'f1-score': 0.14546373515289363, 'support': 15981}, '2': {'precision': 0.3885215615732413, 'recall': 0.7743701550387597, 'f1-score': 0.5174333905273723, 'support': 20640}, 'accuracy': 0.3934825589605988, 'macro avg': {'precision': 0.3942208977761956, 'recall': 0.36916214526505814, 'f1-score': 0.32323569038762884, 'support': 56648}, 'weighted avg': {'precision': 0.3952973496146985, 'recall': 0.3934825589605988, 'f1-score': 0.3380342449891223, 'support': 56648}}
[[ 4868  1222 13937]
 [ 3324  1439 11218]
 [ 3514  1143 15983]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963489
{'0': {'precision': 0.37076634181778306, 'recall': 0.12540623739563003, 'f1-score': 0.18742032038135362, 'support': 215699}, '1': {'precision': 0.2436016838654398, 'recall': 0.1281955771643664, 'f1-score': 0.1679875659914452, 'support': 153024}, '2': {'precision': 0.390381612949537, 'recall': 0.7548263971720414, 'f1-score': 0.5146145395780568, 'support': 230555}, 'accuracy': 0.36826981801434394, 'macro avg': {'precision': 0.33491654621092, 'recall': 0.3361427372440126, 'f1-score': 0.29000747531695187, 'support': 599278}, 'weighted avg': {'precision': 0.34584160608125036, 'recall': 0.36826981801434394, 'f1-score': 0.3083367988756994, 'support': 599278}}
[[ 27050  30670 157979]
 [ 19623  19617 113784]
 [ 26284  30242 174029]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097363
{'0': {'precision': 0.3598935723288055, 'recall': 0.12214248372225654, 'f1-score': 0.1823859200908381, 'support': 42082}, '1': {'precision': 0.2868468220046877, 'recall': 0.10516870971818526, 'f1-score': 0.1539087496069982, 'support': 39565}, '2': {'precision': 0.34097820577800303, 'recall': 0.7717051021627435, 'f1-score': 0.4729730719375462, 'support': 41845}, 'accuracy': 0.3368072425744178, 'macro avg': {'precision': 0.3292395333704987, 'recall': 0.3330054318677284, 'f1-score': 0.2697559138784608, 'support': 123492}, 'weighted avg': {'precision': 0.33008104852246944, 'recall': 0.3368072425744178, 'f1-score': 0.27172709295088066, 'support': 123492}}
[[ 5140  5235 31707]
 [ 4699  4161 30705]
 [ 4443  5110 32292]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023992
{'0': {'precision': 0.3836717428087986, 'recall': 0.1193028609010194, 'f1-score': 0.18200973260422415, 'support': 15205}, '1': {'precision': 0.2737088357027173, 'recall': 0.13074873205535975, 'f1-score': 0.1769633507853403, 'support': 11633}, '2': {'precision': 0.35514530575423675, 'recall': 0.7609941318605454, 'f1-score': 0.48428267029853045, 'support': 14485}, 'accuracy': 0.3474578321999855, 'macro avg': {'precision': 0.33750862808858423, 'recall': 0.3370152416056415, 'f1-score': 0.28108525122936495, 'support': 41323}, 'weighted avg': {'precision': 0.3427162473437943, 'recall': 0.3474578321999855, 'f1-score': 0.28654519573136766, 'support': 41323}}
[[ 1814  2109 11282]
 [ 1379  1521  8733]
 [ 1535  1927 11023]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098753
{'0': {'precision': 0.2977942821350275, 'recall': 0.08506287700644106, 'f1-score': 0.13232735911887794, 'support': 156496}, '1': {'precision': 0.3836214499911801, 'recall': 0.20949027805204626, 'f1-score': 0.27099435207770645, 'support': 207623}, '2': {'precision': 0.2963413620111422, 'recall': 0.6908880603283942, 'f1-score': 0.4147743253230089, 'support': 154753}, 'accuracy': 0.3155383215899104, 'macro avg': {'precision': 0.32591903137911654, 'recall': 0.32848040512896054, 'f1-score': 0.27269867883986443, 'support': 518872}, 'weighted avg': {'precision': 0.33170409095852604, 'recall': 0.3155383215899104, 'f1-score': 0.27205348124548867, 'support': 518872}}
[[ 13312  35235 107949]
 [ 18204  43495 145924]
 [ 13186  34650 106917]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030327
{'0': {'precision': 0.3146948516876918, 'recall': 0.10197017123918248, 'f1-score': 0.15403014963564557, 'support': 27155}, '1': {'precision': 0.3211574101751659, 'recall': 0.19313320150997662, 'f1-score': 0.24121054285842575, 'support': 27815}, '2': {'precision': 0.35115888706149645, 'recall': 0.7012358219062129, 'f1-score': 0.46797116840273845, 'support': 29535}, 'accuracy': 0.34142358440328974, 'macro avg': {'precision': 0.32900371630811803, 'recall': 0.332113064885124, 'f1-score': 0.28773728696560325, 'support': 84505}, 'weighted avg': {'precision': 0.3295664137147246, 'recall': 0.34142358440328974, 'f1-score': 0.2924500138659008, 'support': 84505}}
[[ 2769  5630 18756]
 [ 2931  5372 19512]
 [ 3099  5725 20711]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105738
{'0': {'precision': 0.339993110575267, 'recall': 0.08264255212258227, 'f1-score': 0.13296510844671966, 'support': 11943}, '1': {'precision': 0.30046822742474916, 'recall': 0.2066047281758808, 'f1-score': 0.2448490134089175, 'support': 10871}, '2': {'precision': 0.34250010276647347, 'recall': 0.7006980068959717, 'f1-score': 0.4601027113589927, 'support': 11891}, 'accuracy': 0.3332372856937041, 'macro avg': {'precision': 0.3276538135888299, 'recall': 0.3299817623981449, 'f1-score': 0.2793056110715433, 'support': 34705}, 'weighted avg': {'precision': 0.3284713021734908, 'recall': 0.3332372856937041, 'f1-score': 0.28009904208953457, 'support': 34705}}
[[ 987 2662 8294]
 [ 924 2246 7701]
 [ 992 2567 8332]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
2900/2900 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046842
{'0': {'precision': 0.35295881647341065, 'recall': 0.08012525953912658, 'f1-score': 0.13060243192010726, 'support': 264411}, '1': {'precision': 0.28295406126903244, 'recall': 0.14960369273773838, 'f1-score': 0.19572402551509885, 'support': 217508}, '2': {'precision': 0.35070364938800835, 'recall': 0.763970910096224, 'f1-score': 0.48072755212247004, 'support': 260434}, 'accuracy': 0.3403906227899665, 'macro avg': {'precision': 0.3288721757101505, 'recall': 0.3312332874576963, 'f1-score': 0.26901800318589203, 'support': 742353}, 'weighted avg': {'precision': 0.33165639501123084, 'recall': 0.3403906227899665, 'f1-score': 0.27251463963589956, 'support': 742353}}
[[ 21186  41580 201645]
 [ 18249  32540 166719]
 [ 20589  40881 198964]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10875
{'0': {'precision': 0.3511793554413825, 'recall': 0.10012817738418257, 'f1-score': 0.15582699705962355, 'support': 60073}, '1': {'precision': 0.3090917198020243, 'recall': 0.11882885353812397, 'f1-score': 0.17166276636578628, 'support': 58336}, '2': {'precision': 0.3347048468999689, 'recall': 0.7805821634314868, 'f1-score': 0.4685155140945042, 'support': 59193}, 'accuracy': 0.3330593123951307, 'macro avg': {'precision': 0.3316586407144586, 'recall': 0.33317973145126445, 'f1-score': 0.265335092506638, 'support': 177602}, 'weighted avg': {'precision': 0.33186425821978865, 'recall': 0.3330593123951307, 'f1-score': 0.2652444970150858, 'support': 177602}}
[[ 6015  7829 46229]
 [ 5791  6932 45613]
 [ 5322  7666 46205]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097411
{'0': {'precision': 0.33173356602675974, 'recall': 0.11333035226312912, 'f1-score': 0.16894419138614228, 'support': 20127}, '1': {'precision': 0.34332833583208394, 'recall': 0.12037081282553638, 'f1-score': 0.17824794791961507, 'support': 20927}, '2': {'precision': 0.3305182835341021, 'recall': 0.7782768889113209, 'f1-score': 0.4639896489987513, 'support': 19813}, 'accuracy': 0.3321997141308098, 'macro avg': {'precision': 0.33519339513098195, 'recall': 0.33732601799999545, 'f1-score': 0.2703939294348362, 'support': 60867}, 'weighted avg': {'precision': 0.3353244339139399, 'recall': 0.3321997141308098, 'f1-score': 0.2681840974872251, 'support': 60867}}
[[ 2281  2468 15378]
 [ 2552  2519 15856]
 [ 2043  2350 15420]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/EXC
Evaluating performance on  test set...
7167/7167 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0846112
{'0': {'precision': 0.4200302080888281, 'recall': 0.25242102164353486, 'f1-score': 0.3153372305947793, 'support': 652204}, '1': {'precision': 0.35329854984336573, 'recall': 0.13372886371669776, 'f1-score': 0.1940187032920835, 'support': 486604}, '2': {'precision': 0.4093001523325474, 'recall': 0.7403091304735268, 'f1-score': 0.5271506491951392, 'support': 695758}, 'accuracy': 0.40597013135531784, 'macro avg': {'precision': 0.3942096367549138, 'recall': 0.3754863386112531, 'f1-score': 0.3455021943606673, 'support': 1834566}, 'weighted avg': {'precision': 0.3982608010673564, 'recall': 0.40597013135531784, 'f1-score': 0.36348856439195437, 'support': 1834566}}
[[164630  59606 427968]
 [106144  65073 315387]
 [121174  59508 515076]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947927
{'0': {'precision': 0.40447306288903195, 'recall': 0.3418993845796563, 'f1-score': 0.37056322684422277, 'support': 137792}, '1': {'precision': 0.39418236545747054, 'recall': 0.11345287795843073, 'f1-score': 0.17619392814683793, 'support': 133897}, '2': {'precision': 0.3581394971745458, 'recall': 0.6795477270979156, 'f1-score': 0.46906789559751105, 'support': 130010}, 'accuracy': 0.3750320513618406, 'macro avg': {'precision': 0.3855983085070161, 'recall': 0.3782999965453342, 'f1-score': 0.33860835019619057, 'support': 401699}, 'weighted avg': {'precision': 0.38604702649727063, 'recall': 0.3750320513618406, 'f1-score': 0.33765581606384065, 'support': 401699}}
[[47111 12299 78382]
 [38750 15191 79956]
 [30614 11048 88348]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0909535
{'0': {'precision': 0.43158146364785027, 'recall': 0.2667595406957109, 'f1-score': 0.3297199285145906, 'support': 47376}, '1': {'precision': 0.3508094958476638, 'recall': 0.11891492265696087, 'f1-score': 0.17762110046932406, 'support': 35168}, '2': {'precision': 0.3693728857663284, 'recall': 0.7227931305837152, 'f1-score': 0.48890036946584003, 'support': 43206}, 'accuracy': 0.38209940357852884, 'macro avg': {'precision': 0.38392128175394746, 'recall': 0.3694891979787956, 'f1-score': 0.3320804661499182, 'support': 125750}, 'weighted avg': {'precision': 0.38761826381050635, 'recall': 0.38209940357852884, 'f1-score': 0.3418753046342228, 'support': 125750}}
[[12638  4101 30637]
 [ 8306  4182 22680]
 [ 8339  3638 31229]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/AAL
Evaluating performance on  test set...
6357/6357 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0866717
{'0': {'precision': 0.41200309986914485, 'recall': 0.3735363614224691, 'f1-score': 0.39182790019702723, 'support': 607732}, '1': {'precision': 0.3098099739558214, 'recall': 0.07734096195801367, 'f1-score': 0.12378118809591714, 'support': 415278}, '2': {'precision': 0.398882060003928, 'recall': 0.6420780132217945, 'f1-score': 0.49207151587187326, 'support': 604154}, 'accuracy': 0.39765014466888404, 'macro avg': {'precision': 0.3735650446096314, 'recall': 0.3643184455340924, 'f1-score': 0.3358935347216059, 'support': 1627164}, 'weighted avg': {'precision': 0.38105005170573697, 'recall': 0.39765014466888404, 'f1-score': 0.36063785351242517, 'support': 1627164}}
[[227010  35290 345432]
 [144003  32118 239157]
 [179978  36262 387914]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099248
{'0': {'precision': 0.3678807355829316, 'recall': 0.39668319112217326, 'f1-score': 0.3817394440051742, 'support': 145441}, '1': {'precision': 0.3477302776553548, 'recall': 0.09146952720626846, 'f1-score': 0.14483942725093407, 'support': 146639}, '2': {'precision': 0.3582829549573572, 'recall': 0.5999386066500161, 'f1-score': 0.44863898997013213, 'support': 143338}, 'accuracy': 0.3608050195444378, 'macro avg': {'precision': 0.35796465606521455, 'recall': 0.3626971083261526, 'f1-score': 0.3250726204087468, 'support': 435418}, 'weighted avg': {'precision': 0.35793496007675013, 'recall': 0.3608050195444378, 'f1-score': 0.3239799245611001, 'support': 435418}}
[[57694 13085 74662]
 [53865 13413 79361]
 [45269 12075 85994]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0890926
{'0': {'precision': 0.4051680042331775, 'recall': 0.43480153697639645, 'f1-score': 0.4194620455416978, 'support': 52831}, '1': {'precision': 0.33123978318850555, 'recall': 0.09668265488059065, 'f1-score': 0.1496773190265143, 'support': 39821}, '2': {'precision': 0.38800353846763225, 'recall': 0.5716759070129365, 'f1-score': 0.4622632605549613, 'support': 51405}, 'accuracy': 0.39017888752368857, 'macro avg': {'precision': 0.37480377529643844, 'recall': 0.36772003295664124, 'f1-score': 0.3438008750410578, 'support': 144057}, 'weighted avg': {'precision': 0.3786074410332099, 'recall': 0.39017888752368857, 'f1-score': 0.3601598170015761, 'support': 144057}}
[[22971  4019 25841]
 [15460  3850 20511]
 [18264  3754 29387]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/WBA
Evaluating performance on  test set...
7458/7458 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0905204
{'0': {'precision': 0.42059684998557506, 'recall': 0.11948585589740456, 'f1-score': 0.18610251378487058, 'support': 719876}, '1': {'precision': 0.2766959860520697, 'recall': 0.12304026934795059, 'f1-score': 0.17033605629429083, 'support': 459183}, '2': {'precision': 0.3935594325017943, 'recall': 0.8087736429161297, 'f1-score': 0.5294714125997764, 'support': 730187}, 'accuracy': 0.38395733184723185, 'macro avg': {'precision': 0.3636174228464797, 'recall': 0.3504332560538283, 'f1-score': 0.29530332755964595, 'support': 1909246}, 'weighted avg': {'precision': 0.37564758668278, 'recall': 0.38395733184723185, 'f1-score': 0.313631295759044, 'support': 1909246}}
[[ 86015  76090 557771]
 [ 50461  56498 352224]
 [ 68031  71600 590556]]
Evaluating performance on  train set...
1664/1664 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981753
{'0': {'precision': 0.3746410850943691, 'recall': 0.21578084239224452, 'f1-score': 0.27383931786049864, 'support': 144517}, '1': {'precision': 0.3564925847976115, 'recall': 0.10469311484835418, 'f1-score': 0.1618537571804758, 'support': 139140}, '2': {'precision': 0.35861751396333424, 'recall': 0.7607164942657971, 'f1-score': 0.48744388359307106, 'support': 142304}, 'accuracy': 0.36154483626435285, 'macro avg': {'precision': 0.3632503946184383, 'recall': 0.36039681716879857, 'f1-score': 0.3077123195446818, 'support': 425961}, 'weighted avg': {'precision': 0.36335976920507024, 'recall': 0.36154483626435285, 'f1-score': 0.30861976303972777, 'support': 425961}}
[[ 31184  13966  99367]
 [ 30331  14567  94242]
 [ 21722  12329 108253]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951581
{'0': {'precision': 0.4054636247919319, 'recall': 0.17311511047009887, 'f1-score': 0.2426355340061816, 'support': 47841}, '1': {'precision': 0.31035980597987406, 'recall': 0.11648190414085426, 'f1-score': 0.1693897307228797, 'support': 36804}, '2': {'precision': 0.3743567227577193, 'recall': 0.771365453397854, 'f1-score': 0.5040765539713747, 'support': 47530}, 'accuracy': 0.372475884244373, 'macro avg': {'precision': 0.36339338450984177, 'recall': 0.35365415600293576, 'f1-score': 0.30536727290014537, 'support': 132175}, 'weighted avg': {'precision': 0.3677960477066654, 'recall': 0.372475884244373, 'f1-score': 0.31625424507035405, 'support': 132175}}
[[ 8282  4825 34734]
 [ 5978  4287 26539]
 [ 6166  4701 36663]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
8238/8238 - 64s - 64s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985254
{'0': {'precision': 0.39556970462920005, 'recall': 0.1959362639249325, 'f1-score': 0.26206481140465926, 'support': 757185}, '1': {'precision': 0.26414466675886505, 'recall': 0.1218824000151773, 'f1-score': 0.1667996299058715, 'support': 579813}, '2': {'precision': 0.37585839046842134, 'recall': 0.7140652394484464, 'f1-score': 0.49248847207581287, 'support': 771711}, 'accuracy': 0.36519073992665657, 'macro avg': {'precision': 0.34519092061882883, 'recall': 0.34396130112951867, 'f1-score': 0.3071176377954479, 'support': 2108709}, 'weighted avg': {'precision': 0.3522193023475001, 'recall': 0.36519073992665657, 'f1-score': 0.3201972910022899, 'support': 2108709}}
[[148360  99871 508954]
 [103034  70669 406110]
 [123660  96999 551052]]
Evaluating performance on  train set...
1806/1806 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.104505
{'0': {'precision': 0.3714465654657198, 'recall': 0.21977372455043656, 'f1-score': 0.2761549173545379, 'support': 155651}, '1': {'precision': 0.32128823628945835, 'recall': 0.11292688729118207, 'f1-score': 0.16711569209405575, 'support': 151328}, '2': {'precision': 0.34997491140095366, 'recall': 0.7146429008705962, 'f1-score': 0.4698532807409258, 'support': 155181}, 'accuracy': 0.3509520512376666, 'macro avg': {'precision': 0.34756990438537727, 'recall': 0.3491145042374049, 'f1-score': 0.30437463006317317, 'support': 462160}, 'weighted avg': {'precision': 0.3478132947650755, 'recall': 0.3509520512376666, 'f1-score': 0.3054902511100443, 'support': 462160}}
[[ 34208  18574 102869]
 [ 31130  17089 103109]
 [ 26756  17526 110899]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044409
{'0': {'precision': 0.35772432086344097, 'recall': 0.21512256834308136, 'f1-score': 0.26867414701167847, 'support': 54541}, '1': {'precision': 0.31250339029020885, 'recall': 0.10732516114609338, 'f1-score': 0.15977701662668314, 'support': 53678}, '2': {'precision': 0.35149617996604415, 'recall': 0.7085182610555585, 'f1-score': 0.46988314981293333, 'support': 56103}, 'accuracy': 0.3483647959494164, 'macro avg': {'precision': 0.3405746303732313, 'recall': 0.34365533018157773, 'f1-score': 0.2994447711504316, 'support': 164322}, 'weighted avg': {'precision': 0.3408258745198192, 'recall': 0.3483647959494164, 'f1-score': 0.3017984305485939, 'support': 164322}}
[[11733  6233 36575]
 [11154  5761 36763]
 [ 9912  6441 39750]]
testing model on single stock: results/universal/W5/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
31315/31315 - 237s - 237s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0832063
{'0': {'precision': 0.4126010101503757, 'recall': 0.2064295047676675, 'f1-score': 0.27518198259825016, 'support': 3067328}, '1': {'precision': 0.2491874695631921, 'recall': 0.05093469446270284, 'f1-score': 0.08458080840067611, 'support': 1848465}, '2': {'precision': 0.3985037088636254, 'recall': 0.7844958925244978, 'f1-score': 0.5285285344009601, 'support': 3100688}, 'accuracy': 0.3941648461463328, 'macro avg': {'precision': 0.35343072952573107, 'recall': 0.3472866972516227, 'f1-score': 0.2960971084666288, 'support': 8016481}, 'weighted avg': {'precision': 0.36946792678952206, 'recall': 0.3941648461463328, 'f1-score': 0.32922427541387866, 'support': 8016481}}
[[ 633187  141866 2292275]
 [ 375040   94151 1379274]
 [ 526396  141815 2432477]]
Evaluating performance on  train set...
5759/5759 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994608
{'0': {'precision': 0.3539553910111711, 'recall': 0.322742552756578, 'f1-score': 0.3376291224437514, 'support': 494109}, '1': {'precision': 0.345281173594132, 'recall': 0.08771301451117686, 'f1-score': 0.13988941848121286, 'support': 483007}, '2': {'precision': 0.3618267264860689, 'recall': 0.6558268199696211, 'f1-score': 0.4663584620479847, 'support': 497055}, 'accuracy': 0.35804394469841017, 'macro avg': {'precision': 0.353687763697124, 'recall': 0.35542746241245865, 'f1-score': 0.31462566765764965, 'support': 1474171}, 'weighted avg': {'precision': 0.35376733882626415, 'recall': 0.35804394469841017, 'f1-score': 0.3162448330398412, 'support': 1474171}}
[[159470  41163 293476]
 [159165  42366 281476]
 [131902  39171 325982]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967548
{'0': {'precision': 0.3582166788296955, 'recall': 0.2861367249602544, 'f1-score': 0.31814512565182806, 'support': 188700}, '1': {'precision': 0.33688032397709816, 'recall': 0.0731992984713229, 'f1-score': 0.1202664167347997, 'support': 164783}, '2': {'precision': 0.3691169741409136, 'recall': 0.6909838291826843, 'f1-score': 0.481187938748045, 'support': 191456}, 'accuracy': 0.3639838587438227, 'macro avg': {'precision': 0.3547379923159024, 'recall': 0.3501066175380872, 'f1-score': 0.30653316037822426, 'support': 544939}, 'weighted avg': {'precision': 0.3555944741011461, 'recall': 0.3639838587438227, 'f1-score': 0.3155915876093584, 'support': 544939}}
[[ 53994  11985 122721]
 [ 49331  12062 103390]
 [ 47405  11758 132293]]
training model: results/universal/W5/deepOF_L2/h1000
Epoch 1/50
9913/9913 - 221s - loss: 3.2538 - accuracy1000: 0.3856 - val_loss: 3.3068 - val_accuracy1000: 0.3301 - 221s/epoch - 22ms/step
Epoch 2/50
9913/9913 - 219s - loss: 3.2491 - accuracy1000: 0.3848 - val_loss: 3.3072 - val_accuracy1000: 0.3210 - 219s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 218s - loss: 3.2456 - accuracy1000: 0.3869 - val_loss: 3.3140 - val_accuracy1000: 0.3147 - 218s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 219s - loss: 3.2431 - accuracy1000: 0.3888 - val_loss: 3.3137 - val_accuracy1000: 0.3164 - 219s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 218s - loss: 3.2415 - accuracy1000: 0.3900 - val_loss: 3.3147 - val_accuracy1000: 0.3163 - 218s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 219s - loss: 3.2400 - accuracy1000: 0.3912 - val_loss: 3.3186 - val_accuracy1000: 0.3172 - 219s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 218s - loss: 3.2381 - accuracy1000: 0.3929 - val_loss: 3.3179 - val_accuracy1000: 0.3181 - 218s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 218s - loss: 3.2368 - accuracy1000: 0.3939 - val_loss: 3.3236 - val_accuracy1000: 0.3166 - 218s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 218s - loss: 3.2347 - accuracy1000: 0.3956 - val_loss: 3.3302 - val_accuracy1000: 0.3154 - 218s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 218s - loss: 3.2335 - accuracy1000: 0.3966 - val_loss: 3.3336 - val_accuracy1000: 0.3175 - 218s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 218s - loss: 3.2319 - accuracy1000: 0.3972 - val_loss: 3.3385 - val_accuracy1000: 0.3163 - 218s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 376s - 376s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1141443
{'0': {'precision': 0.3843447265076423, 'recall': 0.015286096906729461, 'f1-score': 0.02940279072965505, 'support': 4923559}, '1': {'precision': 0.22832722169194714, 'recall': 0.6050783251052484, 'f1-score': 0.3315453164626406, 'support': 2916434}, '2': {'precision': 0.3962299246172149, 'recall': 0.3895299530467214, 'f1-score': 0.3928513743682424, 'support': 4998373}, 'accuracy': 0.29497126036132637, 'macro avg': {'precision': 0.33630062427226814, 'recall': 0.33663145835289976, 'f1-score': 0.2512664938535127, 'support': 12838366}, 'weighted avg': {'precision': 0.3535302052275107, 'recall': 0.29497126036132637, 'f1-score': 0.2395409284210802, 'support': 12838366}}
[[  75262 2985723 1862574]
 [  47499 1764671 1104264]
 [  73058 2978299 1947016]]
Evaluating performance on  train set...
9913/9913 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027461
{'0': {'precision': 0.35849551804893803, 'recall': 0.020575540401962886, 'f1-score': 0.038917447539688364, 'support': 863015}, '1': {'precision': 0.33076481334025803, 'recall': 0.6889713380369098, 'f1-score': 0.4469538041086433, 'support': 821786}, '2': {'precision': 0.3537241070818557, 'recall': 0.3219795241866878, 'f1-score': 0.33710613476431966, 'support': 852225}, 'accuracy': 0.33832644994572386, 'macro avg': {'precision': 0.3476614794903506, 'recall': 0.3438421342085201, 'f1-score': 0.27432579547088376, 'support': 2537026}, 'weighted avg': {'precision': 0.347910281393441, 'recall': 0.33832644994572386, 'f1-score': 0.27125342647304834, 'support': 2537026}}
[[ 17757 583891 261367]
 [ 15622 566187 239977]
 [ 16153 561673 274399]]
Evaluating performance on  val set...
3496/3496 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046466
{'0': {'precision': 0.35923452350372465, 'recall': 0.018095302790635988, 'f1-score': 0.03445504183694524, 'support': 309141}, '1': {'precision': 0.31223468899439166, 'recall': 0.6657221924525255, 'f1-score': 0.4250935100728394, 'support': 272462}, '2': {'precision': 0.3636097983696255, 'recall': 0.34628967352709733, 'f1-score': 0.3547384477755731, 'support': 312614}, 'accuracy': 0.3301581159830332, 'macro avg': {'precision': 0.34502633695591395, 'recall': 0.3433690562567529, 'f1-score': 0.27142899989511926, 'support': 894217}, 'weighted avg': {'precision': 0.3464435603111739, 'recall': 0.3301581159830332, 'f1-score': 0.265449548759299, 'support': 894217}}
[[  5594 200560 102987]
 [  4597 181384  86481]
 [  5381 198978 108255]]
testing model out of sample: results/universal/W5/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 160s - 160s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1115739
{'0': {'precision': 0.37793455271127724, 'recall': 0.02695277989222897, 'f1-score': 0.050317142536391864, 'support': 1995527}, '1': {'precision': 0.246102234244874, 'recall': 0.6278401532079827, 'f1-score': 0.35359965753226147, 'support': 1311681}, '2': {'precision': 0.38812566188052017, 'recall': 0.3536437646544812, 'f1-score': 0.3700832504451104, 'support': 2041611}, 'accuracy': 0.29900320051959134, 'macro avg': {'precision': 0.33738748294555715, 'recall': 0.3361455659182309, 'f1-score': 0.25800001683792123, 'support': 5348819}, 'weighted avg': {'precision': 0.34949543993961624, 'recall': 0.29900320051959134, 'f1-score': 0.2467432911658228, 'support': 5348819}}
[[  53785 1255957  685785]
 [  35713  823526  452442]
 [  52815 1266793  722003]]
Evaluating performance on  train set...
4957/4957 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022502
{'0': {'precision': 0.3585593016462178, 'recall': 0.024348179195877635, 'f1-score': 0.045599872374554457, 'support': 428492}, '1': {'precision': 0.33517308929129863, 'recall': 0.6801406143737009, 'f1-score': 0.44905299721499997, 'support': 417596}, '2': {'precision': 0.3454911087972887, 'recall': 0.32061423036480585, 'f1-score': 0.33258813413585553, 'support': 422252}, 'accuracy': 0.33889729883154357, 'macro avg': {'precision': 0.346407833244935, 'recall': 0.34170100797812814, 'f1-score': 0.27574700124180335, 'support': 1268340}, 'weighted avg': {'precision': 0.3465088583097222, 'recall': 0.33889729883154357, 'f1-score': 0.27397852370314424, 'support': 1268340}}
[[ 10433 286273 131786]
 [  8890 284024 124682]
 [  9774 277098 135380]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054236
{'0': {'precision': 0.3614543968951078, 'recall': 0.023129207241356774, 'f1-score': 0.04347639142265711, 'support': 153010}, '1': {'precision': 0.30908051178961476, 'recall': 0.6714990205718031, 'f1-score': 0.423315506993595, 'support': 131199}, '2': {'precision': 0.35856389047347403, 'recall': 0.3333200760965392, 'f1-score': 0.3454814651959286, 'support': 150861}, 'accuracy': 0.3262095754706139, 'macro avg': {'precision': 0.3430329330527322, 'recall': 0.34264943463656633, 'f1-score': 0.2707577878707269, 'support': 435070}, 'weighted avg': {'precision': 0.34465832720234646, 'recall': 0.3262095754706139, 'f1-score': 0.2627406467339886, 'support': 435070}}
[[ 3539 99778 49693]
 [ 2837 88100 40262]
 [ 3415 97161 50285]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988526
{'0': {'precision': 0.29641751437417074, 'recall': 0.0419273309644162, 'f1-score': 0.07346348200681801, 'support': 79924}, '1': {'precision': 0.3525942018025698, 'recall': 0.5354883167324438, 'f1-score': 0.425208405012498, 'support': 95778}, '2': {'precision': 0.3457411982435771, 'recall': 0.41422191542991016, 'f1-score': 0.376896138253935, 'support': 95613}, 'accuracy': 0.3473600796122588, 'macro avg': {'precision': 0.33158430480677253, 'recall': 0.33054585437559003, 'f1-score': 0.291856008424417, 'support': 271315}, 'weighted avg': {'precision': 0.33363062885115413, 'recall': 0.3473600796122588, 'f1-score': 0.3045658235559163, 'support': 271315}}
[[ 3351 42295 34278]
 [ 3822 51288 40668]
 [ 4132 51876 39605]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052792
{'0': {'precision': 0.3592375366568915, 'recall': 0.030295536045505132, 'f1-score': 0.05587866347360019, 'support': 24261}, '1': {'precision': 0.32809969172893044, 'recall': 0.548859365440084, 'f1-score': 0.4106932635709614, 'support': 22882}, '2': {'precision': 0.3262677208287895, 'recall': 0.42503884572697004, 'f1-score': 0.3691607704023598, 'support': 22525}, 'accuracy': 0.32824252167422635, 'macro avg': {'precision': 0.3378683164048704, 'recall': 0.3347312490708531, 'f1-score': 0.27857756581564047, 'support': 69668}, 'weighted avg': {'precision': 0.3383507411529356, 'recall': 0.32824252167422635, 'f1-score': 0.2737053147051287, 'support': 69668}}
[[  735 13393 10133]
 [  686 12559  9637]
 [  625 12326  9574]]
Evaluating performance on  val set...
96/96 - 1s - 941ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054164
{'0': {'precision': 0.3575498575498576, 'recall': 0.028474191718661373, 'f1-score': 0.0527477146159504, 'support': 8815}, '1': {'precision': 0.3172339663203153, 'recall': 0.5830370077703148, 'f1-score': 0.4108966029329868, 'support': 7593}, '2': {'precision': 0.3362454286875254, 'recall': 0.40899542814778206, 'f1-score': 0.36906952110163344, 'support': 8093}, 'accuracy': 0.326027509081262, 'macro avg': {'precision': 0.33700975085256607, 'recall': 0.3401688758789194, 'f1-score': 0.2775712795501902, 'support': 24501}, 'weighted avg': {'precision': 0.3380186014832166, 'recall': 0.326027509081262, 'f1-score': 0.2682253232392674, 'support': 24501}}
[[ 251 4988 3576]
 [ 208 4427 2958]
 [ 243 4540 3310]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000389
{'0': {'precision': 0.3967629046369204, 'recall': 0.01946696571817972, 'f1-score': 0.03711300131450404, 'support': 186367}, '1': {'precision': 0.3434641629966607, 'recall': 0.7283495827369217, 'f1-score': 0.46680121578863554, 'support': 185135}, '2': {'precision': 0.3638574876159025, 'recall': 0.3052387066526726, 'f1-score': 0.3319803337012797, 'support': 187699}, 'accuracy': 0.3500780578003258, 'macro avg': {'precision': 0.3680281850831612, 'recall': 0.351018418369258, 'f1-score': 0.2786315169348064, 'support': 559201}, 'weighted avg': {'precision': 0.3680723686704298, 'recall': 0.3500780578003258, 'f1-score': 0.2783440273826508, 'support': 559201}}
[[  3628 130525  52214]
 [  2339 134843  47953]
 [  3177 127229  57293]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990372
{'0': {'precision': 0.4007905138339921, 'recall': 0.01046979865771812, 'f1-score': 0.020406520426645196, 'support': 48425}, '1': {'precision': 0.32613821177331037, 'recall': 0.6944102942381772, 'f1-score': 0.4438274717287532, 'support': 48804}, '2': {'precision': 0.3799217788715064, 'recall': 0.3234320345672546, 'f1-score': 0.3494084245198185, 'support': 53461}, 'accuracy': 0.3430088260667596, 'macro avg': {'precision': 0.36895016815960296, 'recall': 0.3427707091543833, 'f1-score': 0.271214138891739, 'support': 150690}, 'weighted avg': {'precision': 0.3692091588031409, 'recall': 0.3430088260667596, 'f1-score': 0.27426150020017503, 'support': 150690}}
[[  507 34222 13696]
 [  389 33890 14525]
 [  369 35801 17291]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.093108
{'0': {'precision': 0.3504950495049505, 'recall': 0.010369068541300527, 'f1-score': 0.020142247510668565, 'support': 17070}, '1': {'precision': 0.3956462516395924, 'recall': 0.7043423593336028, 'f1-score': 0.5066787266002294, 'support': 22269}, '2': {'precision': 0.32329232074671194, 'recall': 0.30816338321104625, 'f1-score': 0.3155466161855182, 'support': 17309}, 'accuracy': 0.37417031492727015, 'macro avg': {'precision': 0.3564778739637516, 'recall': 0.3409582703619832, 'f1-score': 0.2807891967654721, 'support': 56648}, 'weighted avg': {'precision': 0.35993263050092544, 'recall': 0.37417031492727015, 'f1-score': 0.3016673687901207, 'support': 56648}}
[[  177 12132  4761]
 [  180 15685  6404]
 [  148 11827  5334]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067954
{'0': {'precision': 0.3808991381318425, 'recall': 0.03744121189362959, 'f1-score': 0.06818049150662542, 'support': 218369}, '1': {'precision': 0.2603795691565259, 'recall': 0.5880249403997799, 'f1-score': 0.36093556531107795, 'support': 152684}, '2': {'precision': 0.3909253608353612, 'recall': 0.39910614525139665, 'f1-score': 0.394973396989762, 'support': 228225}, 'accuracy': 0.3154529283571231, 'macro avg': {'precision': 0.3440680227079098, 'recall': 0.34152409918160204, 'f1-score': 0.27469648460248847, 'support': 599278}, 'weighted avg': {'precision': 0.35401149134201093, 'recall': 0.3154529283571231, 'f1-score': 0.2672222159527887, 'support': 599278}}
[[  8176 125899  84294]
 [  5281  89782  57621]
 [  8008 129131  91086]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101332
{'0': {'precision': 0.3368917576961271, 'recall': 0.033017031630170314, 'f1-score': 0.06014004609111859, 'support': 41100}, '1': {'precision': 0.33937841960175197, 'recall': 0.5923311759677616, 'f1-score': 0.4315173297274216, 'support': 40945}, '2': {'precision': 0.341805379054603, 'recall': 0.3958549472820711, 'f1-score': 0.3668500134156158, 'support': 41447}, 'accuracy': 0.34024066336280895, 'macro avg': {'precision': 0.33935851878416073, 'recall': 0.34040105162666773, 'f1-score': 0.28616912974471864, 'support': 123492}, 'weighted avg': {'precision': 0.33936536923509775, 'recall': 0.34024066336280895, 'f1-score': 0.28621340221286623, 'support': 123492}}
[[ 1357 23627 16116]
 [ 1214 24253 15478]
 [ 1457 23583 16407]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109749
{'0': {'precision': 0.3815789473684211, 'recall': 0.03656768173507345, 'f1-score': 0.06673954317933375, 'support': 15861}, '1': {'precision': 0.26757490761764835, 'recall': 0.561367457500467, 'f1-score': 0.3624084180058492, 'support': 10706}, '2': {'precision': 0.35912812824357054, 'recall': 0.4220656004337219, 'f1-score': 0.38806156146800425, 'support': 14756}, 'accuracy': 0.3101904508385161, 'macro avg': {'precision': 0.33609399440987997, 'recall': 0.34000024655642075, 'f1-score': 0.2724031742177291, 'support': 41323}, 'weighted avg': {'precision': 0.3440257315666142, 'recall': 0.3101904508385161, 'f1-score': 0.2580823468421921, 'support': 41323}}
[[ 580 8477 6804]
 [ 386 6010 4310]
 [ 554 7974 6228]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
2027/2027 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983644
{'0': {'precision': 0.30521516101453405, 'recall': 0.04850700397916599, 'f1-score': 0.08371017988141896, 'support': 154555}, '1': {'precision': 0.40674307545367716, 'recall': 0.5066914781218173, 'f1-score': 0.45124907813202, 'support': 210118}, '2': {'precision': 0.2973567997798408, 'recall': 0.4484659433589063, 'f1-score': 0.3576034626303786, 'support': 154199}, 'accuracy': 0.3529097735086881, 'macro avg': {'precision': 0.33643834541601736, 'recall': 0.3345548084866299, 'f1-score': 0.29752090688127253, 'support': 518872}, 'weighted avg': {'precision': 0.34399368612688436, 'recall': 0.3529097735086881, 'f1-score': 0.3139415443204841, 'support': 518872}}
[[  7497  77431  69627]
 [  9874 106465  93779]
 [  7192  77854  69153]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018248
{'0': {'precision': 0.32083333333333336, 'recall': 0.04804374954121706, 'f1-score': 0.08357275106939924, 'support': 27246}, '1': {'precision': 0.32915247733704256, 'recall': 0.49089738545727674, 'f1-score': 0.3940738188552479, 'support': 27959}, '2': {'precision': 0.3461925788209776, 'recall': 0.45757679180887373, 'f1-score': 0.394167021917768, 'support': 29300}, 'accuracy': 0.3365599668658659, 'macro avg': {'precision': 0.33205946316378454, 'recall': 0.3321726422691225, 'f1-score': 0.2906045306141384, 'support': 84505}, 'weighted avg': {'precision': 0.33237845894705653, 'recall': 0.3365599668658659, 'f1-score': 0.29399475556714194, 'support': 84505}}
[[ 1309 13553 12384]
 [ 1298 13725 12936]
 [ 1473 14420 13407]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103955
{'0': {'precision': 0.34575442883323154, 'recall': 0.047029497299543, 'f1-score': 0.08279695728496196, 'support': 12035}, '1': {'precision': 0.3154008438818565, 'recall': 0.4991652754590985, 'f1-score': 0.3865546218487395, 'support': 10782}, '2': {'precision': 0.3438515371157211, 'recall': 0.4629037685060565, 'f1-score': 0.39459343180840384, 'support': 11888}, 'accuracy': 0.3299524564183835, 'macro avg': {'precision': 0.33500226994360305, 'recall': 0.336366180421566, 'f1-score': 0.2879816703140351, 'support': 34705}, 'weighted avg': {'precision': 0.33567248301322034, 'recall': 0.3299524564183835, 'f1-score': 0.2839711866023897, 'support': 34705}}
[[ 566 5864 5605]
 [ 504 5382 4896]
 [ 567 5818 5503]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
2900/2900 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046202
{'0': {'precision': 0.36134818906924054, 'recall': 0.044251790139410434, 'f1-score': 0.07884765803561453, 'support': 263108}, '1': {'precision': 0.30770053590338764, 'recall': 0.5111365796885133, 'f1-score': 0.38414721681562175, 'support': 225114}, '2': {'precision': 0.3438027984675059, 'recall': 0.45480874037405905, 'f1-score': 0.3915909302660444, 'support': 254131}, 'accuracy': 0.3263784210476687, 'macro avg': {'precision': 0.3376171744800447, 'recall': 0.33673237006732765, 'f1-score': 0.2848619350390936, 'support': 742353}, 'weighted avg': {'precision': 0.3390735226318621, 'recall': 0.3263784210476687, 'f1-score': 0.2784898301429461, 'support': 742353}}
[[ 11643 131524 119941]
 [  9388 115064 100662]
 [ 11190 127360 115581]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021999
{'0': {'precision': 0.339291313891502, 'recall': 0.036018042309548776, 'f1-score': 0.06512285770174092, 'support': 60081}, '1': {'precision': 0.3425759361495358, 'recall': 0.5572822065253952, 'f1-score': 0.4243145992598568, 'support': 59460}, '2': {'precision': 0.33227737657386774, 'recall': 0.4263447064294449, 'f1-score': 0.3734789791715387, 'support': 58061}, 'accuracy': 0.33813808403058526, 'macro avg': {'precision': 0.3380482088716352, 'recall': 0.3398816517547963, 'f1-score': 0.28763881204437886, 'support': 177602}, 'weighted avg': {'precision': 0.33809801328038014, 'recall': 0.33813808403058526, 'f1-score': 0.2861845896738105, 'support': 177602}}
[[ 2164 32410 25507]
 [ 2087 33136 24237]
 [ 2127 31180 24754]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984578
{'0': {'precision': 0.3366571699905033, 'recall': 0.03531755915317559, 'f1-score': 0.06392858752986791, 'support': 20075}, '1': {'precision': 0.370034742327736, 'recall': 0.6012607611610293, 'f1-score': 0.4581249887986809, 'support': 21257}, '2': {'precision': 0.3335535279303084, 'recall': 0.4135653954440747, 'f1-score': 0.36927507084742667, 'support': 19535}, 'accuracy': 0.3543627910033351, 'macro avg': {'precision': 0.34674848008284925, 'recall': 0.35004790525275986, 'f1-score': 0.29710954905865844, 'support': 60867}, 'weighted avg': {'precision': 0.34731774809566124, 'recall': 0.3543627910033351, 'f1-score': 0.2995961323962104, 'support': 60867}}
[[  709 10990  8376]
 [  710 12781  7766]
 [  687 10769  8079]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
7167/7167 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.12131
{'0': {'precision': 0.4128769402920839, 'recall': 0.020294817840259053, 'f1-score': 0.03868794369143207, 'support': 709048}, '1': {'precision': 0.19919437417715918, 'recall': 0.7629383855168795, 'f1-score': 0.3159086575268364, 'support': 365888}, '2': {'precision': 0.4340451598973684, 'recall': 0.22759501336176824, 'f1-score': 0.29861099116713363, 'support': 759630}, 'accuracy': 0.2542443280863158, 'macro avg': {'precision': 0.3487054914555372, 'recall': 0.3369427389063023, 'f1-score': 0.21773586412846738, 'support': 1834566}, 'weighted avg': {'precision': 0.37902486187577433, 'recall': 0.2542443280863158, 'f1-score': 0.2016022662602443, 'support': 1834566}}
[[ 14390 548417 146241]
 [  7549 279150  79189]
 [ 12914 573828 172888]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037087
{'0': {'precision': 0.4023207990599295, 'recall': 0.01963018705654698, 'f1-score': 0.037433885935300476, 'support': 139530}, '1': {'precision': 0.3309336941813261, 'recall': 0.7895204600180786, 'f1-score': 0.46638038957018046, 'support': 131647}, '2': {'precision': 0.35333349831716493, 'recall': 0.2187753788633334, 'f1-score': 0.27023062582214274, 'support': 130522}, 'accuracy': 0.33665007879033804, 'macro avg': {'precision': 0.3621959971861402, 'recall': 0.3426420086459863, 'f1-score': 0.2580149671092079, 'support': 401699}, 'weighted avg': {'precision': 0.36300823252752434, 'recall': 0.33665007879033804, 'f1-score': 0.25365204044285833, 'support': 401699}}
[[  2739 110201  26590]
 [  2038 103938  25671]
 [  2031  99936  28555]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1105732
{'0': {'precision': 0.41465594280607687, 'recall': 0.019835417334615794, 'f1-score': 0.037859780103216854, 'support': 46785}, '1': {'precision': 0.29007838217475684, 'recall': 0.7510549694614104, 'f1-score': 0.4185147082711303, 'support': 36020}, '2': {'precision': 0.3627648672771148, 'recall': 0.2555361508906741, 'f1-score': 0.299852450953604, 'support': 42945}, 'accuracy': 0.3097813121272366, 'macro avg': {'precision': 0.35583306408598286, 'recall': 0.3421421792289001, 'f1-score': 0.2520756464426504, 'support': 125750}, 'weighted avg': {'precision': 0.36125040823326243, 'recall': 0.3097813121272366, 'f1-score': 0.2363684541571184, 'support': 125750}}
[[  928 34970 10887]
 [  577 27053  8390]
 [  733 31238 10974]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
6357/6357 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1208158
{'0': {'precision': 0.4324938205624958, 'recall': 0.009809061184663077, 'f1-score': 0.019183046382733483, 'support': 660002}, '1': {'precision': 0.18886274868093464, 'recall': 0.6756761173832606, 'f1-score': 0.29520951285396324, 'support': 305938}, '2': {'precision': 0.41859872119303804, 'recall': 0.32771950201444594, 'f1-score': 0.36762592735224714, 'support': 661224}, 'accuracy': 0.2641927918759265, 'macro avg': {'precision': 0.3466517634788228, 'recall': 0.3377348935274565, 'f1-score': 0.22733949552964794, 'support': 1627164}, 'weighted avg': {'precision': 0.381040017470262, 'recall': 0.2641927918759265, 'f1-score': 0.21267662209204166, 'support': 1627164}}
[[  6474 448773 204755]
 [  3004 206715  96219]
 [  5491 439037 216696]]
Evaluating performance on  train set...
1701/1701 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023325
{'0': {'precision': 0.3719326383319968, 'recall': 0.015623526241325878, 'f1-score': 0.029987392105518377, 'support': 148430}, '1': {'precision': 0.3342556511915134, 'recall': 0.7334402420151119, 'f1-score': 0.4592254166465706, 'support': 142801}, '2': {'precision': 0.3542583864228863, 'recall': 0.28461650495537044, 'f1-score': 0.3156417168854243, 'support': 144187}, 'accuracy': 0.3401168532306887, 'macro avg': {'precision': 0.35348222531546547, 'recall': 0.34456009107060276, 'f1-score': 0.26828484187917107, 'support': 435418}, 'weighted avg': {'precision': 0.35372321933538414, 'recall': 0.3401168532306887, 'f1-score': 0.26535492231677993, 'support': 435418}}
[[  2319 107480  38631]
 [  1892 104736  36173]
 [  2024 101125  41038]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1106378
{'0': {'precision': 0.37191358024691357, 'recall': 0.013533243486073675, 'f1-score': 0.026116168183788473, 'support': 53424}, '1': {'precision': 0.2817298182871642, 'recall': 0.7040994657212762, 'f1-score': 0.40243441283703274, 'support': 40054}, '2': {'precision': 0.3657700547488693, 'recall': 0.30380197315091245, 'f1-score': 0.33191847843696337, 'support': 50579}, 'accuracy': 0.30745468807485926, 'macro avg': {'precision': 0.33980448442764905, 'recall': 0.3404782274527541, 'f1-score': 0.2534896864859282, 'support': 144057}, 'weighted avg': {'precision': 0.34468162499516336, 'recall': 0.30745468807485926, 'f1-score': 0.23811715405491157, 'support': 144057}}
[[  723 37348 15353]
 [  561 28202 11291]
 [  660 34553 15366]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
7458/7458 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1232885
{'0': {'precision': 0.4158448533943823, 'recall': 0.024179520556624312, 'f1-score': 0.04570169188916535, 'support': 781281}, '1': {'precision': 0.1760004123032521, 'recall': 0.6892570099651761, 'f1-score': 0.28040098776325545, 'support': 331956}, '2': {'precision': 0.4244134486452739, 'recall': 0.3006071539392143, 'f1-score': 0.35193956816121047, 'support': 796009}, 'accuracy': 0.2550640409879083, 'macro avg': {'precision': 0.3387529047809694, 'recall': 0.3380145614870049, 'f1-score': 0.22601408260454373, 'support': 1909246}, 'weighted avg': {'precision': 0.3777161249069165, 'recall': 0.2550640409879083, 'f1-score': 0.21418597579737508, 'support': 1909246}}
[[ 18891 533041 229349]
 [  7984 228803  95169]
 [ 18553 538170 239286]]
Evaluating performance on  train set...
1664/1664 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013925
{'0': {'precision': 0.3904720782959125, 'recall': 0.019045145348225004, 'f1-score': 0.03631885086245557, 'support': 142451}, '1': {'precision': 0.34205834173387095, 'recall': 0.7657367314988505, 'f1-score': 0.4728792227191763, 'support': 141802}, '2': {'precision': 0.3579494550717218, 'recall': 0.2565698478561549, 'f1-score': 0.2988971600741529, 'support': 141708}, 'accuracy': 0.3466373682097657, 'macro avg': {'precision': 0.36349329170050176, 'recall': 0.3471172415677435, 'f1-score': 0.2693650778852616, 'support': 425961}, 'weighted avg': {'precision': 0.36353562034829706, 'recall': 0.3466373682097657, 'f1-score': 0.2690034884039157, 'support': 425961}}
[[  2713 105749  33989]
 [  1993 108583  31226]
 [  2242 103108  36358]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046908
{'0': {'precision': 0.39857369255150554, 'recall': 0.0219991690174725, 'f1-score': 0.04169688931258161, 'support': 45729}, '1': {'precision': 0.3180892485939495, 'recall': 0.7451489309108886, 'f1-score': 0.4458528071939892, 'support': 40455}, '2': {'precision': 0.36999025285247406, 'recall': 0.28062012132808595, 'f1-score': 0.3191670891397623, 'support': 45991}, 'accuracy': 0.3333232456969926, 'macro avg': {'precision': 0.36221773133264307, 'recall': 0.349256073752149, 'f1-score': 0.2689055952154444, 'support': 132175}, 'weighted avg': {'precision': 0.3639939372611625, 'recall': 0.3333232456969926, 'f1-score': 0.2619447396484561, 'support': 132175}}
[[ 1006 32433 12290]
 [  624 30145  9686]
 [  894 32191 12906]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
8238/8238 - 64s - 64s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099067
{'0': {'precision': 0.3861421002929078, 'recall': 0.031164257922503373, 'f1-score': 0.057673849302116546, 'support': 774124}, '1': {'precision': 0.2602711599186477, 'recall': 0.6788583283067158, 'f1-score': 0.37627877038064705, 'support': 532167}, '2': {'precision': 0.39379819050585313, 'recall': 0.3230186760516339, 'f1-score': 0.35491399843764226, 'support': 802418}, 'accuracy': 0.30567849807631114, 'macro avg': {'precision': 0.34673715023913626, 'recall': 0.34434708742695097, 'f1-score': 0.2629555393734686, 'support': 2108709}, 'weighted avg': {'precision': 0.3572898612548719, 'recall': 0.30567849807631114, 'f1-score': 0.2511865013677304, 'support': 2108709}}
[[ 24125 507680 242319]
 [ 14221 361266 156680]
 [ 24131 519091 259196]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018076
{'0': {'precision': 0.37742694646009023, 'recall': 0.024893286767559177, 'f1-score': 0.04670606365809559, 'support': 154620}, '1': {'precision': 0.33373058788567644, 'recall': 0.7189851360984238, 'f1-score': 0.45586349036962637, 'support': 151508}, '2': {'precision': 0.35066703834972723, 'recall': 0.28217288761279735, 'f1-score': 0.31271329997478575, 'support': 156032}, 'accuracy': 0.3392959148346893, 'macro avg': {'precision': 0.3539415242318313, 'recall': 0.34201710349292674, 'f1-score': 0.2717609513341692, 'support': 462160}, 'weighted avg': {'precision': 0.35406761229623257, 'recall': 0.3392959148346893, 'f1-score': 0.270646397099277, 'support': 462160}}
[[  3849 108988  41783]
 [  2832 108932  39744]
 [  3517 108487  44028]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025002
{'0': {'precision': 0.35673930589184827, 'recall': 0.02418163581654053, 'f1-score': 0.0452930728241563, 'support': 54835}, '1': {'precision': 0.3222268973859991, 'recall': 0.7125356180581132, 'f1-score': 0.443769730845612, 'support': 51589}, '2': {'precision': 0.36823779740795665, 'recall': 0.2959169574078552, 'f1-score': 0.3281398132631075, 'support': 57898}, 'accuracy': 0.3360353452367912, 'macro avg': {'precision': 0.34906800022860135, 'recall': 0.3442114037608363, 'f1-score': 0.2724008723109586, 'support': 164322}, 'weighted avg': {'precision': 0.34995554607509455, 'recall': 0.3360353452367912, 'f1-score': 0.2700546561094332, 'support': 164322}}
[[ 1326 37973 15536]
 [  972 36759 13858]
 [ 1419 39346 17133]]
testing model on single stock: results/universal/W5/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
31315/31315 - 236s - 236s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112322
{'0': {'precision': 0.37744547982631604, 'recall': 0.010007411939561001, 'f1-score': 0.019497866613573528, 'support': 3092308}, '1': {'precision': 0.23239651832745764, 'recall': 0.5572014389002142, 'f1-score': 0.3279939448225343, 'support': 1823337}, '2': {'precision': 0.39556096453324224, 'recall': 0.45449194991286224, 'f1-score': 0.4229837249538053, 'support': 3100836}, 'accuracy': 0.3063959111235965, 'macro avg': {'precision': 0.335134320895672, 'recall': 0.34056693358421253, 'f1-score': 0.25682517879663774, 'support': 8016481}, 'weighted avg': {'precision': 0.3514615111528099, 'recall': 0.3063959111235965, 'f1-score': 0.24573626083986597, 'support': 8016481}}
[[  30946 1695362 1366000]
 [  19875 1015966  787496]
 [  31167 1660364 1409305]]
Evaluating performance on  train set...
5759/5759 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033359
{'0': {'precision': 0.3420270931940591, 'recall': 0.0207336112853533, 'f1-score': 0.039097160810301526, 'support': 505363}, '1': {'precision': 0.32732332997700503, 'recall': 0.6486808008923308, 'f1-score': 0.4350972565067024, 'support': 471574}, '2': {'precision': 0.35197246273451177, 'recall': 0.3602891194085682, 'f1-score': 0.35608223673422335, 'support': 497234}, 'accuracy': 0.3361394302289219, 'macro avg': {'precision': 0.3404409619685253, 'recall': 0.3432345105287508, 'f1-score': 0.2767588846837424, 'support': 1474171}, 'weighted avg': {'precision': 0.3406780390088651, 'recall': 0.3361394302289219, 'f1-score': 0.27269225009769754, 'support': 1474171}}
[[ 10478 320636 174249]
 [ 10087 305901 155586]
 [ 10070 308016 179148]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044321
{'0': {'precision': 0.32872539831302716, 'recall': 0.014963577606894124, 'f1-score': 0.028624182639831068, 'support': 187522}, '1': {'precision': 0.30689446240266, 'recall': 0.631051455786321, 'f1-score': 0.4129581322682153, 'support': 162936}, '2': {'precision': 0.37041506510533057, 'recall': 0.38352846807657304, 'f1-score': 0.37685772533327266, 'support': 194481}, 'accuracy': 0.33070857472120735, 'macro avg': {'precision': 0.3353449752736726, 'recall': 0.3431811671565961, 'f1-score': 0.27281334674710633, 'support': 544939}, 'weighted avg': {'precision': 0.3370764297384571, 'recall': 0.33070857472120735, 'f1-score': 0.2678191091053871, 'support': 544939}}
[[  2806 115267  69449]
 [  2787 102821  57328]
 [  2943 116949  74589]]
training model: results/universal/W5/deepVOL_L2/h300
Epoch 1/50
9913/9913 - 325s - loss: 3.2410 - accuracy300: 0.3922 - val_loss: 3.3117 - val_accuracy300: 0.3502 - 325s/epoch - 33ms/step
Epoch 2/50
9913/9913 - 323s - loss: 3.2297 - accuracy300: 0.4000 - val_loss: 3.3470 - val_accuracy300: 0.3287 - 323s/epoch - 33ms/step
Epoch 3/50
9913/9913 - 320s - loss: 3.2230 - accuracy300: 0.4035 - val_loss: 3.4241 - val_accuracy300: 0.3215 - 320s/epoch - 32ms/step
Epoch 4/50
9913/9913 - 322s - loss: 3.2155 - accuracy300: 0.4071 - val_loss: 3.4407 - val_accuracy300: 0.3211 - 322s/epoch - 33ms/step
Epoch 5/50
9913/9913 - 326s - loss: 3.2093 - accuracy300: 0.4098 - val_loss: 3.4018 - val_accuracy300: 0.3292 - 326s/epoch - 33ms/step
Epoch 6/50
9913/9913 - 322s - loss: 3.2044 - accuracy300: 0.4124 - val_loss: 3.3750 - val_accuracy300: 0.3424 - 322s/epoch - 33ms/step
Epoch 7/50
9913/9913 - 323s - loss: 3.2005 - accuracy300: 0.4147 - val_loss: 3.3653 - val_accuracy300: 0.3459 - 323s/epoch - 33ms/step
Epoch 8/50
9913/9913 - 321s - loss: 3.1974 - accuracy300: 0.4163 - val_loss: 3.3557 - val_accuracy300: 0.3456 - 321s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 317s - loss: 3.1947 - accuracy300: 0.4173 - val_loss: 3.3840 - val_accuracy300: 0.3364 - 317s/epoch - 32ms/step
Epoch 10/50
9913/9913 - 320s - loss: 3.1924 - accuracy300: 0.4183 - val_loss: 3.3734 - val_accuracy300: 0.3402 - 320s/epoch - 32ms/step
Epoch 11/50
9913/9913 - 317s - loss: 3.1904 - accuracy300: 0.4192 - val_loss: 3.3831 - val_accuracy300: 0.3366 - 317s/epoch - 32ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 772s - 772s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1097351
{'0': {'precision': 0.4280290891799415, 'recall': 0.06828542462299231, 'f1-score': 0.11778075108740524, 'support': 4850962}, '1': {'precision': 0.2226068473468264, 'recall': 0.14757293429961912, 'f1-score': 0.17748535866571952, 'support': 3024640}, '2': {'precision': 0.3944874071611656, 'recall': 0.7996096549742494, 'f1-score': 0.5283254595195617, 'support': 4962789}, 'accuracy': 0.3696646254191822, 'macro avg': {'precision': 0.3483744478959778, 'recall': 0.33848933796562025, 'f1-score': 0.2745305230908955, 'support': 12838391}, 'weighted avg': {'precision': 0.36666714591910826, 'recall': 0.3696646254191822, 'f1-score': 0.2905463030386572, 'support': 12838391}}
[[ 331250  806083 3713629]
 [ 200840  446355 2377445]
 [ 241806  752689 3968294]]
Evaluating performance on  train set...
9913/9913 - 156s - 156s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1013883
{'0': {'precision': 0.41501066338996934, 'recall': 0.10403576435932418, 'f1-score': 0.16636643380927083, 'support': 847324}, '1': {'precision': 0.31970777312411336, 'recall': 0.1241979851450172, 'f1-score': 0.17889860862377738, 'support': 836487}, '2': {'precision': 0.34988605625625413, 'recall': 0.8200175335375788, 'f1-score': 0.4904894785749062, 'support': 853222}, 'accuracy': 0.3514731578186015, 'macro avg': {'precision': 0.36153483092344557, 'recall': 0.3494170943473067, 'f1-score': 0.2785848403359848, 'support': 2537033}, 'weighted avg': {'precision': 0.36168641561011866, 'recall': 0.3514731578186015, 'f1-score': 0.2795032805964774, 'support': 2537033}}
[[ 88152 120192 638980]
 [ 71563 103890 661034]
 [ 52694 100871 699657]]
Evaluating performance on  val set...
3496/3496 - 55s - 55s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039693
{'0': {'precision': 0.3934537829999864, 'recall': 0.09451079917845136, 'f1-score': 0.1524111906036481, 'support': 305764}, '1': {'precision': 0.30838549296399875, 'recall': 0.14768125338803798, 'f1-score': 0.19971969669745213, 'support': 282243}, '2': {'precision': 0.35355376963579876, 'recall': 0.7916084281478192, 'f1-score': 0.4887973850146498, 'support': 306212}, 'accuracy': 0.3500037462858651, 'macro avg': {'precision': 0.35179768186659466, 'recall': 0.34460016023810286, 'f1-score': 0.28030942410525, 'support': 894219}, 'weighted avg': {'precision': 0.35294044982667894, 'recall': 0.3500037462858651, 'f1-score': 0.2825336595384562, 'support': 894219}}
[[ 28898  49346 227520]
 [ 24871  41682 215690]
 [ 19678  44134 242400]]
testing model out of sample: results/universal/W5/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 328s - 328s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059651
{'0': {'precision': 0.3953602530771049, 'recall': 0.07985567202842912, 'f1-score': 0.13287331941071082, 'support': 1906214}, '1': {'precision': 0.2754394398422973, 'recall': 0.14749989523446527, 'f1-score': 0.19211875155951094, 'support': 1503357}, '2': {'precision': 0.37220073079405325, 'recall': 0.7981831335763454, 'f1-score': 0.5076699272241215, 'support': 1939273}, 'accuracy': 0.35930417862252106, 'macro avg': {'precision': 0.3476668079044852, 'recall': 0.3418462336130799, 'f1-score': 0.2775539993981144, 'support': 5348844}, 'weighted avg': {'precision': 0.3532583652152303, 'recall': 0.35930417862252106, 'f1-score': 0.28541094757168545, 'support': 5348844}}
[[ 152222  307364 1446628]
 [ 117371  221745 1164241]
 [ 115428  275950 1547895]]
Evaluating performance on  train set...
4957/4957 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103177
{'0': {'precision': 0.38835166981894387, 'recall': 0.1023431156206928, 'f1-score': 0.16199528107949937, 'support': 427337}, '1': {'precision': 0.31973412789365113, 'recall': 0.12996832313271317, 'f1-score': 0.18481246146555722, 'support': 418602}, '2': {'precision': 0.3433302555881368, 'recall': 0.8010700630911093, 'f1-score': 0.48065626165237296, 'support': 422405}, 'accuracy': 0.3441621515929432, 'macro avg': {'precision': 0.35047201776691056, 'recall': 0.3444605006148384, 'f1-score': 0.2758213347324765, 'support': 1268344}, 'weighted avg': {'precision': 0.3507114785434103, 'recall': 0.3441621515929432, 'f1-score': 0.2756515989576533, 'support': 1268344}}
[[ 43735  63000 320602]
 [ 37605  54405 326592]
 [ 31277  52752 338376]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104125
{'0': {'precision': 0.3822788922277268, 'recall': 0.09588055161362602, 'f1-score': 0.1533091588135667, 'support': 147277}, '1': {'precision': 0.3236669622211791, 'recall': 0.13088166025744677, 'f1-score': 0.18639180624943685, 'support': 142243}, '2': {'precision': 0.34551721303293464, 'recall': 0.8085632626140485, 'f1-score': 0.48414738998613643, 'support': 145552}, 'accuracy': 0.3457496690203001, 'macro avg': {'precision': 0.3504876891606135, 'recall': 0.3451084914950404, 'f1-score': 0.27461611834971333, 'support': 435072}, 'weighted avg': {'precision': 0.3508177255930508, 'recall': 0.3457496690203001, 'f1-score': 0.2748061552712802, 'support': 435072}}
[[ 14121  21009 112147]
 [ 12847  18617 110779]
 [  9971  17893 117688]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020621
{'0': {'precision': 0.34857372438730416, 'recall': 0.04874376376466358, 'f1-score': 0.08552754803284666, 'support': 88996}, '1': {'precision': 0.30446855859936583, 'recall': 0.1869181477451336, 'f1-score': 0.23163304291803696, 'support': 82710}, '2': {'precision': 0.37416986227642746, 'recall': 0.7816571967795691, 'f1-score': 0.5060836106489185, 'support': 99614}, 'accuracy': 0.3599513489606369, 'macro avg': {'precision': 0.3424040484210325, 'recall': 0.3391063694297887, 'f1-score': 0.2744147338666007, 'support': 271320}, 'weighted avg': {'precision': 0.34452608844954347, 'recall': 0.3599513489606369, 'f1-score': 0.28447217837116107, 'support': 271320}}
[[ 4338 17620 67038]
 [ 4054 15460 63196]
 [ 4053 17697 77864]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057754
{'0': {'precision': 0.4104709538608654, 'recall': 0.0712448132780083, 'f1-score': 0.12141569140473076, 'support': 24100}, '1': {'precision': 0.33194457023820306, 'recall': 0.16049220528989316, 'f1-score': 0.21637098916669129, 'support': 22836}, '2': {'precision': 0.338267976857379, 'recall': 0.8101438437513746, 'f1-score': 0.47726035916971155, 'support': 22733}, 'accuracy': 0.34160099900960256, 'macro avg': {'precision': 0.36022783365214917, 'recall': 0.34729362077309206, 'f1-score': 0.2716823465803779, 'support': 69669}, 'weighted avg': {'precision': 0.3611718570943355, 'recall': 0.34160099900960256, 'f1-score': 0.26865213820306916, 'support': 69669}}
[[ 1717  4129 18254]
 [ 1397  3665 17774]
 [ 1069  3247 18417]]
Evaluating performance on  val set...
96/96 - 1s - 853ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1125404
{'0': {'precision': 0.38354577056778677, 'recall': 0.07133620689655172, 'f1-score': 0.1202980192622206, 'support': 9280}, '1': {'precision': 0.29630665920537214, 'recall': 0.15716829919857525, 'f1-score': 0.20539177657098528, 'support': 6738}, '2': {'precision': 0.3661788448518306, 'recall': 0.8288341388659672, 'f1-score': 0.5079468284929923, 'support': 8483}, 'accuracy': 0.3572099097996, 'macro avg': {'precision': 0.3486770915416632, 'recall': 0.3524462149870314, 'f1-score': 0.2778788747753994, 'support': 24501}, 'weighted avg': {'precision': 0.3535412498050259, 'recall': 0.3572099097996, 'f1-score': 0.2779155281578205, 'support': 24501}}
[[ 662 1469 7149]
 [ 658 1059 5021]
 [ 406 1046 7031]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1095439
{'0': {'precision': 0.5151515151515151, 'recall': 0.09502963362068965, 'f1-score': 0.16045943026098825, 'support': 222720}, '1': {'precision': 0.15635060438559192, 'recall': 0.06637270828498491, 'f1-score': 0.09318659039895737, 'support': 116343}, '2': {'precision': 0.4082567437256257, 'recall': 0.8692667947652208, 'f1-score': 0.5555812012338958, 'support': 220143}, 'accuracy': 0.3938620114948695, 'macro avg': {'precision': 0.35991962108757763, 'recall': 0.34355637889029844, 'f1-score': 0.26974240729794713, 'support': 559206}, 'weighted avg': {'precision': 0.39842152651181995, 'recall': 0.3938620114948695, 'f1-score': 0.30201114469041235, 'support': 559206}}
[[ 21165  25368 176187]
 [  7439   7722 101182]
 [ 12481  16299 191363]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0895201
{'0': {'precision': 0.47169307934475213, 'recall': 0.18106220428896216, 'f1-score': 0.2616778165887159, 'support': 48823}, '1': {'precision': 0.2894736842105263, 'recall': 0.08771537256656971, 'f1-score': 0.134634298649598, 'support': 49159}, '2': {'precision': 0.3759376014489039, 'recall': 0.8348669107742511, 'f1-score': 0.5184286328587502, 'support': 52709}, 'accuracy': 0.37929936094391836, 'macro avg': {'precision': 0.3790347883347274, 'recall': 0.36788149587659436, 'f1-score': 0.30491358269902136, 'support': 150691}, 'weighted avg': {'precision': 0.3787552215442486, 'recall': 0.37929936094391836, 'f1-score': 0.3100400046185793, 'support': 150691}}
[[ 8840  6261 33722]
 [ 5520  4312 39327]
 [ 4381  4323 44005]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964934
{'0': {'precision': 0.44821562266034437, 'recall': 0.17830727227599902, 'f1-score': 0.2551226961184701, 'support': 20145}, '1': {'precision': 0.24145717296402228, 'recall': 0.10602855631940772, 'f1-score': 0.1473519819943962, 'support': 15128}, '2': {'precision': 0.40199090281250743, 'recall': 0.7897076023391812, 'f1-score': 0.5327778303822239, 'support': 21375}, 'accuracy': 0.38970484394859484, 'macro avg': {'precision': 0.36388789947895805, 'recall': 0.35801447697819605, 'f1-score': 0.3117508361650301, 'support': 56648}, 'weighted avg': {'precision': 0.37555824351627093, 'recall': 0.38970484394859484, 'f1-score': 0.3311099001083505, 'support': 56648}}
[[ 3592  2824 13729]
 [ 2142  1604 11382]
 [ 2280  2215 16880]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
2341/2341 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1068993
{'0': {'precision': 0.42589390044402897, 'recall': 0.07940290963910542, 'f1-score': 0.13385089404082953, 'support': 229513}, '1': {'precision': 0.20802120141342756, 'recall': 0.14390593680230757, 'f1-score': 0.17012320229643685, 'support': 122726}, '2': {'precision': 0.4234074721210875, 'recall': 0.8082608766049773, 'f1-score': 0.5557075408029367, 'support': 247044}, 'accuracy': 0.3930713869741007, 'macro avg': {'precision': 0.35244085799284797, 'recall': 0.34385657434879674, 'f1-score': 0.286560545713401, 'support': 599283}, 'weighted avg': {'precision': 0.38025118730208707, 'recall': 0.3930713869741007, 'f1-score': 0.3151820994073687, 'support': 599283}}
[[ 18224  35315 175974]
 [  9122  17661  95943]
 [ 15444  31924 199676]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080523
{'0': {'precision': 0.36068818514007306, 'recall': 0.05730665957086528, 'f1-score': 0.09889995199031457, 'support': 41339}, '1': {'precision': 0.30870256445704014, 'recall': 0.1084059518897007, 'f1-score': 0.16046277665995973, 'support': 41197}, '2': {'precision': 0.33680470831665965, 'recall': 0.842562750268581, 'f1-score': 0.4812394971167189, 'support': 40956}, 'accuracy': 0.3347828199397532, 'macro avg': {'precision': 0.3353984859712576, 'recall': 0.33609178724304895, 'f1-score': 0.24686740858899772, 'support': 123492}, 'weighted avg': {'precision': 0.3354248215856839, 'recall': 0.3347828199397532, 'f1-score': 0.2462398776382301, 'support': 123492}}
[[ 2369  5363 33607]
 [ 2389  4466 34342]
 [ 1810  4638 34508]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139393
{'0': {'precision': 0.3615098351940457, 'recall': 0.045059969518255916, 'f1-score': 0.08013198208814518, 'support': 15091}, '1': {'precision': 0.2712867103317135, 'recall': 0.10952827774460462, 'f1-score': 0.15605250364608655, 'support': 11723}, '2': {'precision': 0.3566510127056383, 'recall': 0.8531945688882763, 'f1-score': 0.5030273477183145, 'support': 14509}, 'accuracy': 0.34709483822568543, 'macro avg': {'precision': 0.32981585274379915, 'recall': 0.3359276053837123, 'f1-score': 0.24640394448418204, 'support': 41323}, 'weighted avg': {'precision': 0.3342082755723962, 'recall': 0.34709483822568543, 'f1-score': 0.2501536439750332, 'support': 41323}}
[[  680  1887 12524]
 [  633  1284  9806]
 [  568  1562 12379]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
2027/2027 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048928
{'0': {'precision': 0.27765404602821087, 'recall': 0.0023324415174590107, 'f1-score': 0.004626021992158027, 'support': 160347}, '1': {'precision': 0.4015256588072122, 'recall': 0.12850991629962466, 'f1-score': 0.1947040207445159, 'support': 202747}, '2': {'precision': 0.30075998586072816, 'recall': 0.8738822592965856, 'f1-score': 0.4475044500290094, 'support': 155783}, 'accuracy': 0.31330161097909526, 'macro avg': {'precision': 0.32664656356538374, 'recall': 0.3349082057045564, 'f1-score': 0.2156114975885611, 'support': 518877}, 'weighted avg': {'precision': 0.3329930001561318, 'recall': 0.31330161097909526, 'f1-score': 0.21186333289225404, 'support': 518877}}
[[   374  19619 140354]
 [   542  26055 176150]
 [   431  19216 136136]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071192
{'0': {'precision': 0.3219178082191781, 'recall': 0.0033964445729151613, 'f1-score': 0.006721967963386729, 'support': 27676}, '1': {'precision': 0.337172871360118, 'recall': 0.1312504483822369, 'f1-score': 0.18894913503743868, 'support': 27878}, '2': {'precision': 0.3429338640205005, 'recall': 0.868930026939283, 'f1-score': 0.49178052737543737, 'support': 28954}, 'accuracy': 0.34212145595683247, 'macro avg': {'precision': 0.33400818119993225, 'recall': 0.3345256399648117, 'f1-score': 0.22915054345875427, 'support': 84508}, 'weighted avg': {'precision': 0.3341507273500842, 'recall': 0.34212145595683247, 'f1-score': 0.2330261580152982, 'support': 84508}}
[[   94  3512 24070]
 [   84  3659 24135]
 [  114  3681 25159]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1115917
{'0': {'precision': 0.3177570093457944, 'recall': 0.002850435949027498, 'f1-score': 0.005650186954715413, 'support': 11928}, '1': {'precision': 0.3216399912299934, 'recall': 0.1328804347826087, 'f1-score': 0.18806486763668995, 'support': 11040}, '2': {'precision': 0.33958118320737757, 'recall': 0.8690466047541962, 'f1-score': 0.4883420309283287, 'support': 11737}, 'accuracy': 0.3371560293905777, 'macro avg': {'precision': 0.3263260612610552, 'recall': 0.3349258251619441, 'f1-score': 0.22735236183991137, 'support': 34705}, 'weighted avg': {'precision': 0.326373014204315, 'recall': 0.3371560293905777, 'f1-score': 0.2269212501285318, 'support': 34705}}
[[   34  1603 10291]
 [   27  1467  9546]
 [   46  1491 10200]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
2900/2900 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117791
{'0': {'precision': 0.3575341235632184, 'recall': 0.029638810725505085, 'f1-score': 0.05473980889530487, 'support': 268668}, '1': {'precision': 0.28054103572775774, 'recall': 0.1489094939575239, 'f1-score': 0.194551971772649, 'support': 209765}, '2': {'precision': 0.35801584902684874, 'recall': 0.8257648953301128, 'f1-score': 0.49947918397468005, 'support': 263925}, 'accuracy': 0.3463813954992066, 'macro avg': {'precision': 0.3320303361059416, 'recall': 0.3347710666710473, 'f1-score': 0.24959032154754465, 'support': 742358}, 'weighted avg': {'precision': 0.3359497725131633, 'recall': 0.3463813954992066, 'f1-score': 0.25236081912728214, 'support': 742358}}
[[  7963  41499 219206]
 [  6931  31236 171598]
 [  7378  38607 217940]]
Evaluating performance on  train set...
694/694 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062901
{'0': {'precision': 0.3571032699057824, 'recall': 0.0650184998318197, 'f1-score': 0.110007682895598, 'support': 59460}, '1': {'precision': 0.31641967990515707, 'recall': 0.134226275292106, 'f1-score': 0.1884931377857294, 'support': 59653}, '2': {'precision': 0.3348389422567169, 'recall': 0.8098958778573749, 'f1-score': 0.47379475895179035, 'support': 58489}, 'accuracy': 0.3335716940124548, 'macro avg': {'precision': 0.33612063068921877, 'recall': 0.3363802176604336, 'f1-score': 0.2574318598777059, 'support': 177602}, 'weighted avg': {'precision': 0.3361062290268875, 'recall': 0.3335716940124548, 'f1-score': 0.25617402748637763, 'support': 177602}}
[[ 3866  9172 46422]
 [ 3967  8007 47679]
 [ 2993  8126 47370]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047269
{'0': {'precision': 0.3208345080349591, 'recall': 0.05826037986996365, 'f1-score': 0.09861351819757365, 'support': 19533}, '1': {'precision': 0.3353785598518175, 'recall': 0.13218049915590638, 'f1-score': 0.1896252659139257, 'support': 21917}, '2': {'precision': 0.3204058995111129, 'recall': 0.8033166812586908, 'f1-score': 0.4580977694239269, 'support': 19417}, 'accuracy': 0.3225557362774574, 'macro avg': {'precision': 0.3255396557992965, 'recall': 0.3312525200948536, 'f1-score': 0.24877885117847542, 'support': 60867}, 'weighted avg': {'precision': 0.32593480362965843, 'recall': 0.3225557362774574, 'f1-score': 0.24606304225431028, 'support': 60867}}
[[ 1138  2947 15448]
 [ 1384  2897 17636]
 [ 1025  2794 15598]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
7167/7167 - 62s - 62s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933189
{'0': {'precision': 0.43770747623776424, 'recall': 0.17449806497483256, 'f1-score': 0.24952112480793, 'support': 618855}, '1': {'precision': 0.3093098327395436, 'recall': 0.0794760357287453, 'f1-score': 0.1264589138227141, 'support': 558206}, '2': {'precision': 0.38093929288222944, 'recall': 0.8368526714422594, 'f1-score': 0.5235542264111627, 'support': 657510}, 'accuracy': 0.3829734581000136, 'macro avg': {'precision': 0.3759855339531791, 'recall': 0.36360892404861245, 'f1-score': 0.2998447550139356, 'support': 1834571}, 'weighted avg': {'precision': 0.3782941402454993, 'recall': 0.3829734581000136, 'f1-score': 0.31029034011217727, 'support': 1834571}}
[[107989  55354 455512]
 [ 75166  44364 438676]
 [ 63560  43711 550239]]
Evaluating performance on  train set...
1570/1570 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956362
{'0': {'precision': 0.4494910645605624, 'recall': 0.18402396332264065, 'f1-score': 0.2611370639617964, 'support': 136542}, '1': {'precision': 0.3378699941961695, 'recall': 0.08699973099799743, 'f1-score': 0.13836993725042784, 'support': 133828}, '2': {'precision': 0.35280627485241123, 'recall': 0.8363880026498336, 'f1-score': 0.49627372268544984, 'support': 131329}, 'accuracy': 0.36497974851816906, 'macro avg': {'precision': 0.3800557778697144, 'recall': 0.36913723232349055, 'f1-score': 0.29859357463255803, 'support': 401699}, 'weighted avg': {'precision': 0.3806944249067227, 'recall': 0.36497974851816906, 'f1-score': 0.2971107238912203, 'support': 401699}}
[[ 25127  13636  97779]
 [ 18468  11643 103717]
 [ 12306   9181 109842]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994108
{'0': {'precision': 0.4602394047233905, 'recall': 0.16100045269352647, 'f1-score': 0.23855118638383502, 'support': 44180}, '1': {'precision': 0.3129063014648522, 'recall': 0.0890962041561775, 'f1-score': 0.1386994525021612, 'support': 40518}, '2': {'precision': 0.3472326292553515, 'recall': 0.835330799961025, 'f1-score': 0.49055146269937777, 'support': 41052}, 'accuracy': 0.35797216699801193, 'macro avg': {'precision': 0.3734594451478648, 'recall': 0.36180915227024296, 'f1-score': 0.28926736719512464, 'support': 125750}, 'weighted avg': {'precision': 0.37587521526539136, 'recall': 0.35797216699801193, 'f1-score': 0.28864520459368, 'support': 125750}}
[[ 7113  4662 32405]
 [ 4847  3610 32061]
 [ 3495  3265 34292]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
6357/6357 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052909
{'0': {'precision': 0.41559453484579423, 'recall': 0.08072350220682956, 'f1-score': 0.13518850352486264, 'support': 568236}, '1': {'precision': 0.29984123145509795, 'recall': 0.11511276344099043, 'f1-score': 0.16635845501373828, 'support': 495462}, '2': {'precision': 0.35533547467440785, 'recall': 0.8365683415827966, 'f1-score': 0.4988026797117966, 'support': 563471}, 'accuracy': 0.3529356815426056, 'macro avg': {'precision': 0.3569237469917666, 'recall': 0.3441348690768722, 'f1-score': 0.2667832127501325, 'support': 1627169}, 'weighted avg': {'precision': 0.35948137382908824, 'recall': 0.3529356815426056, 'f1-score': 0.27059519451689185, 'support': 1627169}}
[[ 45870  72036 450330]
 [ 33557  57034 404871]
 [ 30945  61144 471382]]
Evaluating performance on  train set...
1701/1701 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035448
{'0': {'precision': 0.4131755232376523, 'recall': 0.08067390906564921, 'f1-score': 0.13499047446248752, 'support': 147557}, '1': {'precision': 0.3242897314069621, 'recall': 0.11771994171025492, 'f1-score': 0.17273544268492982, 'support': 142049}, '2': {'precision': 0.3454098388359687, 'recall': 0.841048747702521, 'f1-score': 0.4897035862746429, 'support': 145812}, 'accuracy': 0.34739262042451163, 'macro avg': {'precision': 0.3609583644935277, 'recall': 0.3464808661594751, 'f1-score': 0.26580983447402007, 'support': 435418}, 'weighted avg': {'precision': 0.3614845324707662, 'recall': 0.34739262042451163, 'f1-score': 0.2660899311927644, 'support': 435418}}
[[ 11904  19295 116358]
 [  9278  16722 116049]
 [  7629  15548 122635]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057702
{'0': {'precision': 0.3938698915763136, 'recall': 0.0772676142754883, 'f1-score': 0.1291911022962368, 'support': 48895}, '1': {'precision': 0.33044865893328423, 'recall': 0.11356253954861843, 'f1-score': 0.16903442538028038, 'support': 47410}, '2': {'precision': 0.3404725235669437, 'recall': 0.8425472211751895, 'f1-score': 0.4849693843112676, 'support': 47754}, 'accuracy': 0.3428942308359769, 'macro avg': {'precision': 0.3549303580255138, 'recall': 0.34445912499976544, 'f1-score': 0.26106497066259493, 'support': 144059}, 'weighted avg': {'precision': 0.3552972334881312, 'recall': 0.3428942308359769, 'f1-score': 0.2602402420706368, 'support': 144059}}
[[ 3778  5989 39128]
 [ 3215  5384 38811]
 [ 2599  4920 40235]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
7459/7459 - 67s - 67s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038872
{'0': {'precision': 0.41319005478297516, 'recall': 0.09061179469216495, 'f1-score': 0.1486294361636193, 'support': 670895}, '1': {'precision': 0.29375769688033987, 'recall': 0.12324043119938502, 'f1-score': 0.17363543284179822, 'support': 559370}, '2': {'precision': 0.36596370949790896, 'recall': 0.8232747066949834, 'f1-score': 0.5066917810516316, 'support': 678986}, 'accuracy': 0.36072784563161153, 'macro avg': {'precision': 0.357637153720408, 'recall': 0.34570897752884444, 'f1-score': 0.2763188833523497, 'support': 1909251}, 'weighted avg': {'precision': 0.3614038279748064, 'recall': 0.36072784563161153, 'f1-score': 0.28329319889989907, 'support': 1909251}}
[[ 60791  87506 522598]
 [ 44571  68937 445862]
 [ 41764  78230 558992]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998033
{'0': {'precision': 0.4191246431969553, 'recall': 0.1336330228421321, 'f1-score': 0.20265261418944705, 'support': 145039}, '1': {'precision': 0.3202973887814313, 'recall': 0.11466553181667363, 'f1-score': 0.16887448876613373, 'support': 138638}, '2': {'precision': 0.34954724057596936, 'recall': 0.8109090142389273, 'f1-score': 0.4885164901465579, 'support': 142286}, 'accuracy': 0.3536926916187556, 'macro avg': {'precision': 0.3629897575181187, 'recall': 0.35306918963257766, 'f1-score': 0.2866811977007129, 'support': 425963}, 'weighted avg': {'precision': 0.36371818017789254, 'recall': 0.3536926916187556, 'f1-score': 0.28714703201915565, 'support': 425963}}
[[ 19382  18797 106860]
 [ 14895  15897 107846]
 [ 11967  14938 115381]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010575
{'0': {'precision': 0.40732182829085134, 'recall': 0.124027087639066, 'f1-score': 0.1901535453641435, 'support': 45482}, '1': {'precision': 0.3047340736411455, 'recall': 0.12694161756829137, 'f1-score': 0.17922452908015948, 'support': 41074}, '2': {'precision': 0.3592281928924983, 'recall': 0.7970188513809733, 'f1-score': 0.49524302457827385, 'support': 45620}, 'accuracy': 0.35721310979300325, 'macro avg': {'precision': 0.35709469827483176, 'recall': 0.34932918552944353, 'f1-score': 0.28820703300752565, 'support': 132176}, 'weighted avg': {'precision': 0.35884312503644145, 'recall': 0.35721310979300325, 'f1-score': 0.2920577006336347, 'support': 132176}}
[[ 5641  6341 33500]
 [ 4503  5214 31357]
 [ 3705  5555 36360]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
8238/8238 - 78s - 78s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046999
{'0': {'precision': 0.38242375601926165, 'recall': 0.10027557235539111, 'f1-score': 0.15888881033356583, 'support': 750801}, '1': {'precision': 0.27239039793396613, 'recall': 0.1694145714314638, 'f1-score': 0.20890169069085004, 'support': 592694}, '2': {'precision': 0.37639295057014016, 'recall': 0.7590715860426884, 'f1-score': 0.5032463538083793, 'support': 765219}, 'accuracy': 0.3587750638540836, 'macro avg': {'precision': 0.3437357015077893, 'recall': 0.34292057660984776, 'f1-score': 0.2903456182775984, 'support': 2108714}, 'weighted avg': {'precision': 0.34930831312279614, 'recall': 0.3587750638540836, 'f1-score': 0.297907790228769, 'support': 2108714}}
[[ 75287 141471 534043]
 [ 63965 100411 428318]
 [ 57616 126747 580856]]
Evaluating performance on  train set...
1806/1806 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998731
{'0': {'precision': 0.38476214907569223, 'recall': 0.15494476404465363, 'f1-score': 0.22092316756577615, 'support': 154881}, '1': {'precision': 0.31695823761559755, 'recall': 0.140802135189413, 'f1-score': 0.19498584531763105, 'support': 152867}, '2': {'precision': 0.34735329211411214, 'recall': 0.7465660719489687, 'f1-score': 0.4741157189301232, 'support': 154415}, 'accuracy': 0.3479356850288751, 'macro avg': {'precision': 0.3496912262684673, 'recall': 0.34743765706101176, 'f1-score': 0.2966749106045101, 'support': 462163}, 'weighted avg': {'precision': 0.34983622644473156, 'recall': 0.3479356850288751, 'f1-score': 0.2969391341810579, 'support': 462163}}
[[ 23998  24848 106035]
 [ 20775  21524 110568]
 [ 17598  21536 115281]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985056
{'0': {'precision': 0.3890182863372813, 'recall': 0.1440948639817908, 'f1-score': 0.21029508284554696, 'support': 54478}, '1': {'precision': 0.32474269588313415, 'recall': 0.14369663024515655, 'f1-score': 0.1992336189227381, 'support': 54455}, '2': {'precision': 0.35355319166659727, 'recall': 0.7662712813013414, 'f1-score': 0.48385736108894417, 'support': 55389}, 'accuracy': 0.3536836211827996, 'macro avg': {'precision': 0.35577139129567087, 'recall': 0.3513542585094296, 'f1-score': 0.29779535428574305, 'support': 164322}, 'weighted avg': {'precision': 0.3557634366708027, 'recall': 0.3536836211827996, 'f1-score': 0.2988406763248557, 'support': 164322}}
[[ 7850  8657 37971]
 [ 6997  7825 39633]
 [ 5332  7614 42443]]
testing model on single stock: results/universal/W5/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
31315/31315 - 311s - 311s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1152139
{'0': {'precision': 0.4162524703849659, 'recall': 0.04426953458699965, 'f1-score': 0.08002789415351852, 'support': 3178145}, '1': {'precision': 0.197791080289044, 'recall': 0.1882442659640523, 'f1-score': 0.1928996247863631, 'support': 1587974}, '2': {'precision': 0.4106901804803025, 'recall': 0.7792320067241638, 'f1-score': 0.5378888416719387, 'support': 3250367}, 'accuracy': 0.37078739986572673, 'macro avg': {'precision': 0.34157791038477076, 'recall': 0.3372486024250719, 'f1-score': 0.27027212020394015, 'support': 8016486}, 'weighted avg': {'precision': 0.3707224849241627, 'recall': 0.37078739986572673, 'f1-score': 0.288030937878982, 'support': 8016486}}
[[ 140695  618655 2418795]
 [  73477  298927 1215570]
 [ 123832  593745 2532790]]
Evaluating performance on  train set...
5759/5759 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104303
{'0': {'precision': 0.37645140898958646, 'recall': 0.06938255757863152, 'f1-score': 0.11716990412743888, 'support': 489244}, '1': {'precision': 0.3192044086320274, 'recall': 0.1415426379511442, 'f1-score': 0.19612077550346838, 'support': 486984}, '2': {'precision': 0.34662145213306494, 'recall': 0.8130934402262102, 'f1-score': 0.4860429590547448, 'support': 497944}, 'accuracy': 0.34442995796962633, 'macro avg': {'precision': 0.347425756584893, 'recall': 0.34133954525199534, 'f1-score': 0.2664445462285507, 'support': 1474172}, 'weighted avg': {'precision': 0.3474642750194057, 'recall': 0.34442995796962633, 'f1-score': 0.26784834301306876, 'support': 1474172}}
[[ 33945  77870 377429]
 [ 32298  68929 385757]
 [ 23928  69141 404875]]
Evaluating performance on  val set...
2129/2129 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1060272
{'0': {'precision': 0.34940602936232207, 'recall': 0.0677664933244217, 'f1-score': 0.11351668707133136, 'support': 184029}, '1': {'precision': 0.31239383453916325, 'recall': 0.17075015904128196, 'f1-score': 0.22080910718057606, 'support': 174483}, '2': {'precision': 0.3502433084145569, 'recall': 0.7775548737314137, 'f1-score': 0.48294703034785597, 'support': 186428}, 'accuracy': 0.3435644291114618, 'macro avg': {'precision': 0.33734772410534736, 'recall': 0.3386905086990391, 'f1-score': 0.27242427486658777, 'support': 544940}, 'weighted avg': {'precision': 0.33784162496884906, 'recall': 0.3435644291114618, 'f1-score': 0.2742552332861023, 'support': 544940}}
[[ 12471  34008 137550]
 [ 13320  29793 131370]
 [  9901  31569 144958]]
training model: results/universal/W5/deepVOL_L2/h500
Epoch 1/50
9913/9913 - 324s - loss: 3.2498 - accuracy500: 0.3895 - val_loss: 3.3284 - val_accuracy500: 0.3509 - 324s/epoch - 33ms/step
Epoch 2/50
9913/9913 - 322s - loss: 3.2414 - accuracy500: 0.3927 - val_loss: 3.3341 - val_accuracy500: 0.3543 - 322s/epoch - 32ms/step
Epoch 3/50
9913/9913 - 320s - loss: 3.2388 - accuracy500: 0.3939 - val_loss: 3.3716 - val_accuracy500: 0.3489 - 320s/epoch - 32ms/step
Epoch 4/50
9913/9913 - 323s - loss: 3.2347 - accuracy500: 0.3962 - val_loss: 3.4294 - val_accuracy500: 0.3118 - 323s/epoch - 33ms/step
Epoch 5/50
9913/9913 - 323s - loss: 3.2335 - accuracy500: 0.3968 - val_loss: 3.4601 - val_accuracy500: 0.3206 - 323s/epoch - 33ms/step
Epoch 6/50
9913/9913 - 325s - loss: 3.2328 - accuracy500: 0.3978 - val_loss: 3.3970 - val_accuracy500: 0.3127 - 325s/epoch - 33ms/step
Epoch 7/50
9913/9913 - 322s - loss: 3.2287 - accuracy500: 0.4008 - val_loss: 3.3663 - val_accuracy500: 0.3298 - 322s/epoch - 32ms/step
Epoch 8/50
9913/9913 - 321s - loss: 3.2262 - accuracy500: 0.4017 - val_loss: 3.3814 - val_accuracy500: 0.3346 - 321s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 319s - loss: 3.2233 - accuracy500: 0.4038 - val_loss: 3.3890 - val_accuracy500: 0.3403 - 319s/epoch - 32ms/step
Epoch 10/50
9913/9913 - 322s - loss: 3.2230 - accuracy500: 0.4029 - val_loss: 3.3766 - val_accuracy500: 0.3403 - 322s/epoch - 32ms/step
Epoch 11/50
9913/9913 - 318s - loss: 3.2190 - accuracy500: 0.4057 - val_loss: 3.3917 - val_accuracy500: 0.3355 - 318s/epoch - 32ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 776s - 776s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097055
{'0': {'precision': 0.4398767646112107, 'recall': 0.003977937955229278, 'f1-score': 0.007884573341017895, 'support': 4809527}, '1': {'precision': 0.2474209138532771, 'recall': 0.022541404709509917, 'f1-score': 0.04131846979574949, 'support': 3138713}, '2': {'precision': 0.3811786495469681, 'recall': 0.9750500546915627, 'f1-score': 0.5480908373734862, 'support': 4890151}, 'accuracy': 0.37839827436319706, 'macro avg': {'precision': 0.3561587760038187, 'recall': 0.33385646578543393, 'f1-score': 0.19909796017008452, 'support': 12838391}, 'weighted avg': {'precision': 0.3704672625342365, 'recall': 0.37839827436319706, 'f1-score': 0.22182334555225208, 'support': 12838391}}
[[  19132  106310 4684085]
 [  11246   70751 3056716]
 [  13116  108893 4768142]]
Evaluating performance on  train set...
9913/9913 - 157s - 157s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1156994
{'0': {'precision': 0.4250708661417323, 'recall': 0.00791516185145348, 'f1-score': 0.01554093890485666, 'support': 852541}, '1': {'precision': 0.3210888364779874, 'recall': 0.01964393932106544, 'f1-score': 0.03702285232557085, 'support': 831656}, '2': {'precision': 0.33675845390680725, 'recall': 0.9754360744621474, 'f1-score': 0.5006671453341655, 'support': 852836}, 'accuracy': 0.3369967990168043, 'macro avg': {'precision': 0.3609727188421757, 'recall': 0.3343317252115554, 'f1-score': 0.18441031218819767, 'support': 2537033}, 'weighted avg': {'precision': 0.36129822965540515, 'recall': 0.3369967990168043, 'f1-score': 0.1856603877154017, 'support': 2537033}}
[[  6748  17255 828538]
 [  5466  16337 809853]
 [  3661  17288 831887]]
Evaluating performance on  val set...
3496/3496 - 56s - 56s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109013
{'0': {'precision': 0.4078674948240166, 'recall': 0.006235578247011196, 'f1-score': 0.012283365392709168, 'support': 315929}, '1': {'precision': 0.29181456383779714, 'recall': 0.02058093930405626, 'f1-score': 0.03845009141286016, 'support': 263642}, '2': {'precision': 0.3522734972065756, 'recall': 0.9749243599196562, 'f1-score': 0.5175415435411066, 'support': 314648}, 'accuracy': 0.3513166237800807, 'macro avg': {'precision': 0.35065185195612975, 'recall': 0.3339136258235746, 'f1-score': 0.18942500011555863, 'support': 894219}, 'weighted avg': {'precision': 0.35408987771523065, 'recall': 0.3513166237800807, 'f1-score': 0.19778280481352398, 'support': 894219}}
[[  1970   6563 307396]
 [  1575   5426 256641]
 [  1285   6605 306758]]
testing model out of sample: results/universal/W5/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 328s - 328s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102513
{'0': {'precision': 0.3875093192636348, 'recall': 0.003500454069556307, 'f1-score': 0.006938233599861996, 'support': 1930321}, '1': {'precision': 0.26776577600909607, 'recall': 0.022019166051929426, 'f1-score': 0.04069210113565113, 'support': 1454551}, '2': {'precision': 0.3673646027904014, 'recall': 0.9748759147279086, 'f1-score': 0.5336374494879782, 'support': 1963972}, 'accuracy': 0.36520302330746607, 'macro avg': {'precision': 0.3408798993543774, 'recall': 0.33346517828313144, 'f1-score': 0.19375592807449712, 'support': 5348844}, 'weighted avg': {'precision': 0.34754989070565073, 'recall': 0.36520302330746607, 'f1-score': 0.20950896368738464, 'support': 5348844}}
[[   6757   43090 1880474]
 [   5831   32028 1416692]
 [   4849   44494 1914629]]
Evaluating performance on  train set...
4957/4957 - 81s - 81s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1168768
{'0': {'precision': 0.3891278169619818, 'recall': 0.005297337045996904, 'f1-score': 0.01045238205258537, 'support': 427007}, '1': {'precision': 0.3165502199549, 'recall': 0.02039970364088136, 'f1-score': 0.03832931971388414, 'support': 419761}, '2': {'precision': 0.3327241234176191, 'recall': 0.9750887147275936, 'f1-score': 0.4961497981963193, 'support': 421576}, 'accuracy': 0.3326376755832802, 'macro avg': {'precision': 0.3461340534448336, 'recall': 0.33359525180482397, 'f1-score': 0.1816438333209296, 'support': 1268344}, 'weighted avg': {'precision': 0.3463604855385289, 'recall': 0.3326376755832802, 'f1-score': 0.18111588118046804, 'support': 1268344}}
[[  2262   9448 415297]
 [  2089   8563 409109]
 [  1462   9040 411074]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108259
{'0': {'precision': 0.4060840173829068, 'recall': 0.005545225567380095, 'f1-score': 0.010941047140171595, 'support': 151662}, '1': {'precision': 0.3023537175538935, 'recall': 0.02060086480167265, 'f1-score': 0.03857352332442311, 'support': 133441}, '2': {'precision': 0.345340627351625, 'recall': 0.9761550720482233, 'f1-score': 0.5101885766661207, 'support': 149969}, 'accuracy': 0.3447314467490438, 'macro avg': {'precision': 0.3512594540961418, 'recall': 0.3341003874724253, 'f1-score': 0.18656771571023847, 'support': 435072}, 'weighted avg': {'precision': 0.35333067908698185, 'recall': 0.3447314467490438, 'f1-score': 0.1915064662201854, 'support': 435072}}
[[   841   3276 147545]
 [   721   2749 129971]
 [   509   3067 146393]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1116339
{'0': {'precision': 0.3104013104013104, 'recall': 0.004444027531864498, 'f1-score': 0.00876260057338389, 'support': 85283}, '1': {'precision': 0.30593113394627724, 'recall': 0.01908328272946045, 'f1-score': 0.03592560837487959, 'support': 88926}, '2': {'precision': 0.35796365175844447, 'recall': 0.9751727404722431, 'f1-score': 0.5236919452639612, 'support': 97111}, 'accuracy': 0.3566858322276279, 'macro avg': {'precision': 0.3247653653686774, 'recall': 0.33290001691118937, 'f1-score': 0.18946005140407493, 'support': 271320}, 'weighted avg': {'precision': 0.3259597344765439, 'recall': 0.3566858322276279, 'f1-score': 0.20196915086087638, 'support': 271320}}
[[  379  1761 83143]
 [  520  1697 86709]
 [  322  2089 94700]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1225817
{'0': {'precision': 0.3765281173594132, 'recall': 0.006480935948152512, 'f1-score': 0.012742542716478424, 'support': 23762}, '1': {'precision': 0.34014300306435136, 'recall': 0.02788477641936024, 'f1-score': 0.051543998142558625, 'support': 23884}, '2': {'precision': 0.3160381563697958, 'recall': 0.9658084729600872, 'f1-score': 0.4762384550797648, 'support': 22023}, 'accuracy': 0.31707072011942183, 'macro avg': {'precision': 0.34423642559785345, 'recall': 0.3333913951092, 'f1-score': 0.1801749986462673, 'support': 69669}, 'weighted avg': {'precision': 0.34493311124912596, 'recall': 0.31707072011942183, 'f1-score': 0.1725597417486614, 'support': 69669}}
[[  154   654 22954]
 [  140   666 23078]
 [  115   638 21270]]
Evaluating performance on  val set...
96/96 - 1s - 930ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1174119
{'0': {'precision': 0.3568075117370892, 'recall': 0.008455718736092568, 'f1-score': 0.01651994348440387, 'support': 8988}, '1': {'precision': 0.29733163913595934, 'recall': 0.031728813559322035, 'f1-score': 0.057338887527566766, 'support': 7375}, '2': {'precision': 0.3330496574613846, 'recall': 0.9617842221676087, 'f1-score': 0.49476911406808055, 'support': 8138}, 'accuracy': 0.3321088935145504, 'macro avg': {'precision': 0.3290629361114777, 'recall': 0.33398958482100777, 'f1-score': 0.18954264836001708, 'support': 24501}, 'weighted avg': {'precision': 0.33101362664958195, 'recall': 0.3321088935145504, 'f1-score': 0.1876570996220426, 'support': 24501}}
[[  76  285 8627]
 [  94  234 7047]
 [  43  268 7827]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944797
{'0': {'precision': 0.464059487744423, 'recall': 0.007888133625451753, 'f1-score': 0.015512582683906961, 'support': 213612}, '1': {'precision': 0.28246983676366216, 'recall': 0.02036043673356037, 'f1-score': 0.037983053504843316, 'support': 136834}, '2': {'precision': 0.37376308382443485, 'recall': 0.977040620808584, 'f1-score': 0.5406880573434136, 'support': 208760}, 'accuracy': 0.37273920523027293, 'macro avg': {'precision': 0.3734308027775067, 'recall': 0.33509639705586536, 'f1-score': 0.19806123117738797, 'support': 559206}, 'weighted avg': {'precision': 0.38591670031968484, 'recall': 0.37273920523027293, 'f1-score': 0.21706685158343705, 'support': 559206}}
[[  1685   3475 208452]
 [   755   2786 133293]
 [  1191   3602 203967]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039789
{'0': {'precision': 0.482687338501292, 'recall': 0.019044900289547733, 'f1-score': 0.03664397669537242, 'support': 49042}, '1': {'precision': 0.3039260969976905, 'recall': 0.013840976020193522, 'f1-score': 0.02647620963685746, 'support': 47540}, '2': {'precision': 0.3606974507302631, 'recall': 0.9771941821138812, 'f1-score': 0.5269058295964125, 'support': 54109}, 'accuracy': 0.3614482616745526, 'macro avg': {'precision': 0.3824369620764152, 'recall': 0.33669335280787416, 'f1-score': 0.19667533864288078, 'support': 150691}, 'weighted avg': {'precision': 0.3824885193383439, 'recall': 0.3614482616745526, 'f1-score': 0.20947581769888676, 'support': 150691}}
[[  934   696 47412]
 [  578   658 46304]
 [  423   811 52875]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990573
{'0': {'precision': 0.4169921875, 'recall': 0.021335065454182074, 'f1-score': 0.040593212282536366, 'support': 20014}, '1': {'precision': 0.28346456692913385, 'recall': 0.013506753376688344, 'f1-score': 0.02578488719111854, 'support': 15992}, '2': {'precision': 0.3662462177828005, 'recall': 0.9734037399476795, 'f1-score': 0.5322367026912481, 'support': 20642}, 'accuracy': 0.36604999293885043, 'macro avg': {'precision': 0.3555676574039781, 'recall': 0.3360818529261833, 'f1-score': 0.19953826738830102, 'support': 56648}, 'weighted avg': {'precision': 0.3608053492167115, 'recall': 0.36604999293885043, 'f1-score': 0.21556302929557608, 'support': 56648}}
[[  427   284 19303]
 [  310   216 15466]
 [  287   262 20093]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
2341/2341 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947348
{'0': {'precision': 0.3655093475772606, 'recall': 0.004441333141710052, 'f1-score': 0.00877602806863257, 'support': 215701}, '1': {'precision': 0.24085024772255073, 'recall': 0.009848128398159765, 'f1-score': 0.01892253313326762, 'support': 153024}, '2': {'precision': 0.3848663205765534, 'recall': 0.9855524423355512, 'f1-score': 0.5535620971956106, 'support': 230558}, 'accuracy': 0.3832780172305906, 'macro avg': {'precision': 0.33040863862545494, 'recall': 0.3332806346251403, 'f1-score': 0.19375355279917025, 'support': 599283}, 'weighted avg': {'precision': 0.34112532681345425, 'recall': 0.3832780172305906, 'f1-score': 0.22095866184397495, 'support': 599283}}
[[   958   2251 212492]
 [   831   1507 150686]
 [   832   2499 227227]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1167191
{'0': {'precision': 0.3430232558139535, 'recall': 0.0028003892066354986, 'f1-score': 0.005555424778136107, 'support': 42137}, '1': {'precision': 0.3147616312464101, 'recall': 0.013868502302981221, 'f1-score': 0.026566476790692038, 'support': 39514}, '2': {'precision': 0.3389919856350952, 'recall': 0.9836284983628498, 'f1-score': 0.5042144467313536, 'support': 41841}, 'accuracy': 0.33866161370777054, 'macro avg': {'precision': 0.3322589575651529, 'recall': 0.33343246329082216, 'f1-score': 0.17877878276672723, 'support': 123492}, 'weighted avg': {'precision': 0.33261446651006726, 'recall': 0.33866161370777054, 'f1-score': 0.18123176694417686, 'support': 123492}}
[[  118   609 41410]
 [  125   548 38841]
 [  101   584 41156]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1103766
{'0': {'precision': 0.4206896551724138, 'recall': 0.004014214266912345, 'f1-score': 0.007952545466397235, 'support': 15196}, '1': {'precision': 0.23486238532110093, 'recall': 0.011017386813565157, 'f1-score': 0.021047438954205376, 'support': 11618}, '2': {'precision': 0.35119238057736324, 'recall': 0.9835274657109381, 'f1-score': 0.517572812012622, 'support': 14509}, 'accuracy': 0.34990199162693897, 'macro avg': {'precision': 0.3355814736902927, 'recall': 0.3328530222638052, 'f1-score': 0.18219093214440818, 'support': 41323}, 'weighted avg': {'precision': 0.34404281979666324, 'recall': 0.34990199162693897, 'f1-score': 0.19056796351108252, 'support': 41323}}
[[   61   214 14921]
 [   48   128 11442]
 [   36   203 14270]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
2027/2027 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1366487
{'0': {'precision': 0.3870967741935484, 'recall': 0.00023003341874388973, 'f1-score': 0.0004597936037600899, 'support': 156499}, '1': {'precision': 0.3956083513318934, 'recall': 0.015879667090509766, 'f1-score': 0.030533714889006195, 'support': 207624}, '2': {'precision': 0.2984954451954158, 'recall': 0.984575519857322, 'f1-score': 0.4581060847499414, 'support': 154754}, 'accuracy': 0.30007111511976825, 'macro avg': {'precision': 0.36040019024028586, 'recall': 0.3335617401221919, 'f1-score': 0.16303319774756922, 'support': 518877}, 'weighted avg': {'precision': 0.3640774413343057, 'recall': 0.30007111511976825, 'f1-score': 0.14898567155357112, 'support': 518877}}
[[    36   2679 153784]
 [    28   3297 204299]
 [    29   2358 152367]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138133
{'0': {'precision': 0.2857142857142857, 'recall': 0.00022088057723457517, 'f1-score': 0.0004414199006805224, 'support': 27164}, '1': {'precision': 0.33448275862068966, 'recall': 0.017453577083633223, 'f1-score': 0.03317600383063137, 'support': 27788}, '2': {'precision': 0.3498922167226658, 'recall': 0.9830152930031127, 'f1-score': 0.5160889220466637, 'support': 29556}, 'accuracy': 0.34961187106546127, 'macro avg': {'precision': 0.32336308701921374, 'recall': 0.3335632502213268, 'f1-score': 0.18323544859265853, 'support': 84508}, 'weighted avg': {'precision': 0.32419610109279234, 'recall': 0.34961187106546127, 'f1-score': 0.19154884395132843, 'support': 84508}}
[[    6   469 26689]
 [    9   485 27294]
 [    6   496 29054]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1165411
{'0': {'precision': 0.3333333333333333, 'recall': 8.39066957543212e-05, 'f1-score': 0.00016777116013757238, 'support': 11918}, '1': {'precision': 0.30401234567901236, 'recall': 0.018078370193631274, 'f1-score': 0.034127327847553054, 'support': 10897}, '2': {'precision': 0.3428378457743584, 'recall': 0.9819175777964676, 'f1-score': 0.5082274072784259, 'support': 11890}, 'accuracy': 0.34211208759544737, 'macro avg': {'precision': 0.32672784159556806, 'recall': 0.33335995156195103, 'f1-score': 0.18084083542870552, 'support': 34705}, 'weighted avg': {'precision': 0.32738312012067383, 'recall': 0.34211208759544737, 'f1-score': 0.18489292207986713, 'support': 34705}}
[[    1   237 11680]
 [    1   197 10699]
 [    1   214 11675]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
2900/2900 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1099863
{'0': {'precision': 0.33491912464319695, 'recall': 0.0013312406633511715, 'f1-score': 0.002651940361477553, 'support': 264415}, '1': {'precision': 0.27986712540040337, 'recall': 0.010845578093679312, 'f1-score': 0.020881927262909574, 'support': 217508}, '2': {'precision': 0.3507527855932365, 'recall': 0.9870370725900897, 'f1-score': 0.5175790511148047, 'support': 260435}, 'accuracy': 0.3499255076391714, 'macro avg': {'precision': 0.32184634521227895, 'recall': 0.3330712971157067, 'f1-score': 0.18037097291306395, 'support': 742358}, 'weighted avg': {'precision': 0.3243438890267181, 'recall': 0.3499255076391714, 'f1-score': 0.188640654809223, 'support': 742358}}
[[   352   2992 261071]
 [   401   2359 214748]
 [   298   3078 257059]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1175512
{'0': {'precision': 0.3003533568904594, 'recall': 0.0028306442213230764, 'f1-score': 0.005608432443132145, 'support': 60057}, '1': {'precision': 0.3430690774223458, 'recall': 0.012686656723070856, 'f1-score': 0.024468472043117414, 'support': 58329}, '2': {'precision': 0.3334191069253598, 'recall': 0.9846663064036747, 'f1-score': 0.49815673124158993, 'support': 59216}, 'accuracy': 0.3334309298318713, 'macro avg': {'precision': 0.32561384707938834, 'recall': 0.3333945357826895, 'f1-score': 0.1760778785759465, 'support': 177602}, 'weighted avg': {'precision': 0.325407054016455, 'recall': 0.3334309298318713, 'f1-score': 0.1760278382576895, 'support': 177602}}
[[  170   707 59180]
 [  198   740 57391]
 [  198   710 58308]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1212676
{'0': {'precision': 0.34299516908212563, 'recall': 0.003530055188186745, 'f1-score': 0.006988188976377954, 'support': 20113}, '1': {'precision': 0.33290816326530615, 'recall': 0.012456450150336468, 'f1-score': 0.02401435340663385, 'support': 20953}, '2': {'precision': 0.32515532099672656, 'recall': 0.9832331700419171, 'f1-score': 0.4886981186540658, 'support': 19801}, 'accuracy': 0.32531585259664514, 'macro avg': {'precision': 0.33368621778138613, 'recall': 0.3330732251268134, 'f1-score': 0.17323355367902585, 'support': 60867}, 'weighted avg': {'precision': 0.33371920895892576, 'recall': 0.32531585259664514, 'f1-score': 0.16955719255557603, 'support': 60867}}
[[   71   231 19811]
 [   96   261 20596]
 [   40   292 19469]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
7167/7167 - 76s - 76s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0923885
{'0': {'precision': 0.4428309385509019, 'recall': 0.013325523951751515, 'f1-score': 0.025872501053089088, 'support': 652207}, '1': {'precision': 0.3056255247691016, 'recall': 0.02019712127315024, 'f1-score': 0.03789028088079096, 'support': 486604}, '2': {'precision': 0.3808506676060193, 'recall': 0.9758767391054387, 'f1-score': 0.5478820664356712, 'support': 695760}, 'accuracy': 0.38019515189109604, 'macro avg': {'precision': 0.37643571030867423, 'recall': 0.3364664614434468, 'f1-score': 0.20388161612318376, 'support': 1834571}, 'weighted avg': {'precision': 0.3829324137838089, 'recall': 0.38019515189109604, 'f1-score': 0.22703194102344965, 'support': 1834571}}
[[  8691  10968 632548]
 [  5512   9828 471264]
 [  5423  11361 678976]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1159774
{'0': {'precision': 0.4648130393096836, 'recall': 0.017589945285401216, 'f1-score': 0.03389712000335615, 'support': 137806}, '1': {'precision': 0.3253104596082448, 'recall': 0.01897443939156343, 'f1-score': 0.035857417024158955, 'support': 133917}, '2': {'precision': 0.3250856118125005, 'recall': 0.9721179294639011, 'f1-score': 0.48723510505177875, 'support': 129976}, 'accuracy': 0.3269039753646387, 'macro avg': {'precision': 0.37173637024347633, 'recall': 0.3362274380469552, 'f1-score': 0.1856632140264313, 'support': 401699}, 'weighted avg': {'precision': 0.3730951632824805, 'recall': 0.3269039753646387, 'f1-score': 0.18123523894512258, 'support': 401699}}
[[  2424   2665 132717]
 [  1772   2541 129604]
 [  1019   2605 126352]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1063656
{'0': {'precision': 0.4798165137614679, 'recall': 0.011036549337384991, 'f1-score': 0.021576797722678325, 'support': 47388}, '1': {'precision': 0.30560369728480646, 'recall': 0.030104712041884817, 'f1-score': 0.054810133139926435, 'support': 35144}, '2': {'precision': 0.34465915279130016, 'recall': 0.9665417187283076, 'f1-score': 0.508125729855975, 'support': 43218}, 'accuracy': 0.3447554671968191, 'macro avg': {'precision': 0.3766931212791915, 'recall': 0.33589432670252584, 'f1-score': 0.19483755357285992, 'support': 125750}, 'weighted avg': {'precision': 0.384677221127953, 'recall': 0.3447554671968191, 'f1-score': 0.19808275469158954, 'support': 125750}}
[[  523  1228 45637]
 [  297  1058 33789]
 [  270  1176 41772]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
6357/6357 - 60s - 60s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984617
{'0': {'precision': 0.44604546910022413, 'recall': 0.004584234905016167, 'f1-score': 0.00907519939542103, 'support': 607735}, '1': {'precision': 0.25686094214174565, 'recall': 0.017489446853801903, 'f1-score': 0.03274903901432743, 'support': 415279}, '2': {'precision': 0.371198388594585, 'recall': 0.978536964851735, 'f1-score': 0.5382260212800243, 'support': 604155}, 'accuracy': 0.3694988043651274, 'macro avg': {'precision': 0.35803493327885166, 'recall': 0.3335368822035177, 'f1-score': 0.19335008656325758, 'support': 1627169}, 'weighted avg': {'precision': 0.36997248645756414, 'recall': 0.3694988043651274, 'f1-score': 0.21158665532826654, 'support': 1627169}}
[[  2786   9799 595150]
 [  1707   7263 406309]
 [  1753  11214 591188]]
Evaluating performance on  train set...
1701/1701 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198021
{'0': {'precision': 0.4030274361400189, 'recall': 0.005859294408912729, 'f1-score': 0.011550662942978768, 'support': 145410}, '1': {'precision': 0.31167400881057267, 'recall': 0.013505866632123645, 'f1-score': 0.025889840753301575, 'support': 146677}, '2': {'precision': 0.32946400966862477, 'recall': 0.9813927203466103, 'f1-score': 0.49331642932669795, 'support': 143331}, 'accuracy': 0.3295614788548016, 'macro avg': {'precision': 0.34805515153973876, 'recall': 0.3335859604625489, 'f1-score': 0.1769189776743261, 'support': 435418}, 'weighted avg': {'precision': 0.3480380554989508, 'recall': 0.3295614788548016, 'f1-score': 0.1749687959674049, 'support': 435418}}
[[   852   2179 142379]
 [   791   1981 143905]
 [   471   2196 140664]]
Evaluating performance on  val set...
563/563 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.104611
{'0': {'precision': 0.4246153846153846, 'recall': 0.005222920293694648, 'f1-score': 0.010318914270759339, 'support': 52844}, '1': {'precision': 0.2774118558698179, 'recall': 0.017997637181710782, 'f1-score': 0.03380228495892739, 'support': 39783}, '2': {'precision': 0.35773425739199594, 'recall': 0.979526364909006, 'f1-score': 0.5240715697492978, 'support': 51432}, 'accuracy': 0.3565969498608209, 'macro avg': {'precision': 0.35325383262573284, 'recall': 0.33424897412813714, 'f1-score': 0.1893975896596615, 'support': 144059}, 'weighted avg': {'precision': 0.3600860728789558, 'recall': 0.3565969498608209, 'f1-score': 0.2002241996931181, 'support': 144059}}
[[  276   956 51612]
 [  230   716 38837]
 [  144   909 50379]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
7459/7459 - 72s - 72s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936894
{'0': {'precision': 0.4706748794858061, 'recall': 0.004882771802999953, 'f1-score': 0.00966527622342049, 'support': 719878}, '1': {'precision': 0.24729986431478967, 'recall': 0.019846074776124604, 'f1-score': 0.03674344903776757, 'support': 459184}, '2': {'precision': 0.3830207305034551, 'recall': 0.9782508364272812, 'f1-score': 0.5505005159680354, 'support': 730189}, 'accuracy': 0.3807440718899715, 'macro avg': {'precision': 0.3669984914346836, 'recall': 0.33432656100213526, 'f1-score': 0.19896974707640783, 'support': 1909251}, 'weighted avg': {'precision': 0.3834289760621274, 'recall': 0.3807440718899715, 'f1-score': 0.22301899796009303, 'support': 1909251}}
[[  3515  14162 702201]
 [  1647   9113 448424]
 [  2306  13575 714308]]
Evaluating performance on  train set...
1664/1664 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129411
{'0': {'precision': 0.4080349822355835, 'recall': 0.010331822428289679, 'f1-score': 0.020153343592235633, 'support': 144505}, '1': {'precision': 0.3327215804814855, 'recall': 0.0221406455413395, 'f1-score': 0.04151848259510724, 'support': 139201}, '2': {'precision': 0.33485779862047593, 'recall': 0.9722544409062471, 'f1-score': 0.4981469409218114, 'support': 142257}, 'accuracy': 0.33543993257630356, 'macro avg': {'precision': 0.35853812044584826, 'recall': 0.3349089696252921, 'f1-score': 0.18660625570305142, 'support': 425963}, 'weighted avg': {'precision': 0.3589845542709327, 'recall': 0.33543993257630356, 'f1-score': 0.18676871602987033, 'support': 425963}}
[[  1493   3263 139749]
 [  1137   3082 134982]
 [  1029   2918 138310]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042347
{'0': {'precision': 0.4048582995951417, 'recall': 0.00836382645060115, 'f1-score': 0.01638907668039252, 'support': 47825}, '1': {'precision': 0.26356877323420075, 'recall': 0.019245907869377563, 'f1-score': 0.0358723974803309, 'support': 36839}, '2': {'precision': 0.3595542343071487, 'recall': 0.9724280181848796, 'f1-score': 0.5249928981307881, 'support': 47512}, 'accuracy': 0.35793941411451397, 'macro avg': {'precision': 0.3426604357121637, 'recall': 0.3333459175016194, 'f1-score': 0.19241812409717052, 'support': 132176}, 'weighted avg': {'precision': 0.3491942485452247, 'recall': 0.35793941411451397, 'f1-score': 0.20464209401863945, 'support': 132176}}
[[  400   941 46484]
 [  318   709 35812]
 [  270  1040 46202]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
8238/8238 - 78s - 78s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041349
{'0': {'precision': 0.35763499439192437, 'recall': 0.0029477526687595006, 'f1-score': 0.005847309765950423, 'support': 757187}, '1': {'precision': 0.2693214752514633, 'recall': 0.03269496769653717, 'f1-score': 0.05831110947059529, 'support': 579814}, '2': {'precision': 0.3664748275785708, 'recall': 0.9650064207807825, 'f1-score': 0.5312137322303533, 'support': 771713}, 'accuracy': 0.36320572633368015, 'macro avg': {'precision': 0.33114376574065285, 'recall': 0.33354971371535974, 'f1-score': 0.1984573838222997, 'support': 2108714}, 'weighted avg': {'precision': 0.33658728446116054, 'recall': 0.36320572633368015, 'f1-score': 0.21253790106530193, 'support': 2108714}}
[[  2232  25995 728960]
 [  2440  18957 558417]
 [  1569  25436 744708]]
Evaluating performance on  train set...
1806/1806 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132003
{'0': {'precision': 0.3722410865874363, 'recall': 0.00563476204856047, 'f1-score': 0.011101476610315386, 'support': 155641}, '1': {'precision': 0.3104495346227474, 'recall': 0.03107223319701104, 'f1-score': 0.05649045680035555, 'support': 151357}, '2': {'precision': 0.3361729688884491, 'recall': 0.9633744723359005, 'f1-score': 0.4984203673416992, 'support': 155165}, 'accuracy': 0.33551366076470857, 'macro avg': {'precision': 0.3396211966995443, 'recall': 0.333360489193824, 'f1-score': 0.18867076691745668, 'support': 462163}, 'weighted avg': {'precision': 0.33989515362983747, 'recall': 0.33551366076470857, 'f1-score': 0.18957698320638447, 'support': 462163}}
[[   877   5386 149378]
 [   856   4703 145798]
 [   623   5060 149482]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1121377
{'0': {'precision': 0.4198952879581152, 'recall': 0.007354964142257112, 'f1-score': 0.014456701997260075, 'support': 54521}, '1': {'precision': 0.3002680965147453, 'recall': 0.025022341376228777, 'f1-score': 0.04619509177149928, 'support': 53712}, '2': {'precision': 0.34145420445462615, 'recall': 0.9672841377097113, 'f1-score': 0.5047353242162061, 'support': 56089}, 'accuracy': 0.3407882085174231, 'macro avg': {'precision': 0.3538725296424956, 'recall': 0.3332204810760657, 'f1-score': 0.1884623726616552, 'support': 164322}, 'weighted avg': {'precision': 0.35401793958459565, 'recall': 0.3407882085174231, 'f1-score': 0.19218074401958454, 'support': 164322}}
[[  401  1535 52585]
 [  316  1344 52052]
 [  238  1597 54254]]
testing model on single stock: results/universal/W5/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
31315/31315 - 347s - 347s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964983
{'0': {'precision': 0.40815837790372794, 'recall': 0.0016669215027657596, 'f1-score': 0.0033202829481099455, 'support': 3067331}, '1': {'precision': 0.2314300533267535, 'recall': 0.0248633056473283, 'f1-score': 0.0449025770692908, 'support': 1848467}, '2': {'precision': 0.3867742626488526, 'recall': 0.9736281109224791, 'f1-score': 0.5536219312932443, 'support': 3100688}, 'accuracy': 0.3829594413312766, 'macro avg': {'precision': 0.34212089795977807, 'recall': 0.3333861126908577, 'f1-score': 0.2006149304368817, 'support': 8016486}, 'weighted avg': {'precision': 0.3591366562282663, 'recall': 0.3829594413312766, 'f1-score': 0.22575904425465684, 'support': 8016486}}
[[   5113   74981 2987237]
 [   3290   45959 1799218]
 [   4124   77647 3018917]]
Evaluating performance on  train set...
5759/5759 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1176596
{'0': {'precision': 0.382466870540265, 'recall': 0.003797386361796188, 'f1-score': 0.00752010807148913, 'support': 494024}, '1': {'precision': 0.3179899497487437, 'recall': 0.019643633202955237, 'f1-score': 0.037001520290024556, 'support': 483210}, '2': {'precision': 0.33724209176354036, 'recall': 0.976846206166564, 'f1-score': 0.5013874005541339, 'support': 496938}, 'accuracy': 0.3370027378080712, 'macro avg': {'precision': 0.34589963735084966, 'recall': 0.33342907524377186, 'f1-score': 0.18196967630521588, 'support': 1474172}, 'weighted avg': {'precision': 0.3460872594694951, 'recall': 0.3370027378080712, 'f1-score': 0.18366450491925113, 'support': 1474172}}
[[  1876  10035 482113]
 [  1846   9492 471872]
 [  1183  10323 485432]]
Evaluating performance on  val set...
2129/2129 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1115723
{'0': {'precision': 0.3370720188902007, 'recall': 0.003024620730570387, 'f1-score': 0.005995443043291089, 'support': 188784}, '1': {'precision': 0.284141167975449, 'recall': 0.019105419675911877, 'f1-score': 0.0358034450011089, 'support': 164770}, '2': {'precision': 0.35109091694900285, 'recall': 0.9762417313701107, 'f1-score': 0.5164486913881913, 'support': 191386}, 'accuracy': 0.3496862039857599, 'macro avg': {'precision': 0.32410136793821753, 'recall': 0.3327905905921977, 'f1-score': 0.18608252647753043, 'support': 544940}, 'weighted avg': {'precision': 0.3259911742442916, 'recall': 0.3496862039857599, 'f1-score': 0.19428235512595468, 'support': 544940}}
[[   571   3867 184346]
 [   640   3148 160982]
 [   483   4064 186839]]
training model: results/universal/W5/deepVOL_L2/h1000
Epoch 1/50
9913/9913 - 330s - loss: 3.2558 - accuracy1000: 0.3827 - val_loss: 3.3028 - val_accuracy1000: 0.3458 - 330s/epoch - 33ms/step
Epoch 2/50
9913/9913 - 323s - loss: 3.2572 - accuracy1000: 0.3788 - val_loss: 3.3085 - val_accuracy1000: 0.3466 - 323s/epoch - 33ms/step
Epoch 3/50
9913/9913 - 324s - loss: 3.2540 - accuracy1000: 0.3813 - val_loss: 3.3212 - val_accuracy1000: 0.3265 - 324s/epoch - 33ms/step
Epoch 4/50
9913/9913 - 325s - loss: 3.2433 - accuracy1000: 0.3899 - val_loss: 3.3201 - val_accuracy1000: 0.3488 - 325s/epoch - 33ms/step
Epoch 5/50
9913/9913 - 325s - loss: 3.2389 - accuracy1000: 0.3931 - val_loss: 3.3188 - val_accuracy1000: 0.3345 - 325s/epoch - 33ms/step
Epoch 6/50
9913/9913 - 324s - loss: 3.2342 - accuracy1000: 0.3976 - val_loss: 3.3231 - val_accuracy1000: 0.3476 - 324s/epoch - 33ms/step
Epoch 7/50
9913/9913 - 329s - loss: 3.2294 - accuracy1000: 0.4008 - val_loss: 3.3508 - val_accuracy1000: 0.3375 - 329s/epoch - 33ms/step
Epoch 8/50
9913/9913 - 331s - loss: 3.2238 - accuracy1000: 0.4047 - val_loss: 3.3677 - val_accuracy1000: 0.3411 - 331s/epoch - 33ms/step
Epoch 9/50
9913/9913 - 323s - loss: 3.2202 - accuracy1000: 0.4074 - val_loss: 3.3657 - val_accuracy1000: 0.3424 - 323s/epoch - 33ms/step
Epoch 10/50
9913/9913 - 324s - loss: 3.2170 - accuracy1000: 0.4091 - val_loss: 3.3696 - val_accuracy1000: 0.3382 - 324s/epoch - 33ms/step
Epoch 11/50
9913/9913 - 329s - loss: 3.2128 - accuracy1000: 0.4114 - val_loss: 3.3725 - val_accuracy1000: 0.3440 - 329s/epoch - 33ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 790s - 790s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984879
{'0': {'precision': 0.404674271254757, 'recall': 0.032871047103394224, 'f1-score': 0.060803151005530756, 'support': 4923573}, '1': {'precision': 0.2163708363137596, 'recall': 0.15091051169629244, 'f1-score': 0.17780719767653722, 'support': 2916437}, '2': {'precision': 0.3871987414497318, 'recall': 0.8059713735307492, 'f1-score': 0.5230957389185413, 'support': 4998381}, 'accuracy': 0.36067728424847006, 'macro avg': {'precision': 0.3360812830060828, 'recall': 0.3299176441101453, 'f1-score': 0.2539020292002031, 'support': 12838391}, 'weighted avg': {'precision': 0.3550945021831195, 'recall': 0.36067728424847006, 'f1-score': 0.2673671525791136, 'support': 12838391}}
[[ 161843  772862 3988868]
 [  89384  440121 2386932]
 [ 148707  821122 4028552]]
Evaluating performance on  train set...
9913/9913 - 156s - 156s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023338
{'0': {'precision': 0.3615303186580533, 'recall': 0.030872624781542485, 'f1-score': 0.05688739119664471, 'support': 862868}, '1': {'precision': 0.3462090812214859, 'recall': 0.20235540568158594, 'f1-score': 0.25542039542782735, 'support': 822024}, '2': {'precision': 0.3388754264619481, 'recall': 0.7885443840866712, 'f1-score': 0.47403515876044877, 'support': 852141}, 'accuracy': 0.34092225051861763, 'macro avg': {'precision': 0.3488716087804957, 'recall': 0.34059080484993315, 'f1-score': 0.26211431512830696, 'support': 2537033}, 'weighted avg': {'precision': 0.3489567386638482, 'recall': 0.34092225051861763, 'f1-score': 0.261326044564465, 'support': 2537033}}
[[ 26639 159184 677045]
 [ 21794 166341 633889]
 [ 25251 154939 671951]]
Evaluating performance on  val set...
3496/3496 - 55s - 55s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017218
{'0': {'precision': 0.3569686075624318, 'recall': 0.03597911328519295, 'f1-score': 0.06536958119030126, 'support': 309096}, '1': {'precision': 0.31354818042884885, 'recall': 0.17238431395570689, 'f1-score': 0.2224621263237143, 'support': 272548}, '2': {'precision': 0.35232648460086763, 'recall': 0.8039254578901064, 'f1-score': 0.4899351431131111, 'support': 312575}, 'accuracy': 0.3459901880859163, 'macro avg': {'precision': 0.3409477575307161, 'recall': 0.337429628377002, 'f1-score': 0.2592556168757089, 'support': 894219}, 'weighted avg': {'precision': 0.3421118866035675, 'recall': 0.3459901880859163, 'f1-score': 0.2616568883365862, 'support': 894219}}
[[ 11121  52232 245743]
 [  9373  46983 216192]
 [ 10660  50628 251287]]
testing model out of sample: results/universal/W5/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 329s - 329s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967604
{'0': {'precision': 0.3845911495109213, 'recall': 0.05199589885855572, 'f1-score': 0.09160676014805756, 'support': 1995542}, '1': {'precision': 0.2603707687411816, 'recall': 0.17402998592646693, 'f1-score': 0.208619901014485, 'support': 1311682}, '2': {'precision': 0.38333501493932415, 'recall': 0.7890307696828989, 'f1-score': 0.5159876309106796, 'support': 2041620}, 'accuracy': 0.3632435344908171, 'macro avg': {'precision': 0.34276564439714235, 'recall': 0.3383522181559739, 'f1-score': 0.27207143069107403, 'support': 5348844}, 'weighted avg': {'precision': 0.35364947558046494, 'recall': 0.3632435344908171, 'f1-score': 0.28228506447032636, 'support': 5348844}}
[[ 103760  319392 1572390]
 [  64369  228272 1019041]
 [ 101664  329055 1610901]]
Evaluating performance on  train set...
4957/4957 - 81s - 81s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011066
{'0': {'precision': 0.35897860776483453, 'recall': 0.050554102270314163, 'f1-score': 0.08862706594665358, 'support': 428531}, '1': {'precision': 0.35669700346950106, 'recall': 0.2169861267826641, 'f1-score': 0.26982944812690846, 'support': 417423}, '2': {'precision': 0.3352171962585476, 'recall': 0.7571675465801747, 'f1-score': 0.4646999763160227, 'support': 422390}, 'accuracy': 0.3406481206991163, 'macro avg': {'precision': 0.3502976024976278, 'recall': 0.34156925854438436, 'f1-score': 0.27438549679652824, 'support': 1268344}, 'weighted avg': {'precision': 0.3503145728374714, 'recall': 0.3406481206991163, 'f1-score': 0.2735039436610169, 'support': 1268344}}
[[ 21664  80528 326339]
 [ 18939  90575 307909]
 [ 19746  82824 319820]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987643
{'0': {'precision': 0.3802644003777148, 'recall': 0.05262779589249659, 'f1-score': 0.09245940407652525, 'support': 153037}, '1': {'precision': 0.34628459309621046, 'recall': 0.23140369867817231, 'f1-score': 0.2774213595072289, 'support': 131182}, '2': {'precision': 0.3492535940900592, 'recall': 0.7552849462721988, 'f1-score': 0.4776401590498929, 'support': 150853}, 'accuracy': 0.3501650301559282, 'macro avg': {'precision': 0.35860086252132817, 'recall': 0.34643881361428924, 'f1-score': 0.2825069742112157, 'support': 435072}, 'weighted avg': {'precision': 0.3592664684498637, 'recall': 0.3501650301559282, 'f1-score': 0.2817828991929841, 'support': 435072}}
[[  8054  27730 117253]
 [  5786  30356  95040]
 [  7340  29576 113937]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989181
{'0': {'precision': 0.30364963503649633, 'recall': 0.013011873334417657, 'f1-score': 0.02495441021211249, 'support': 79927}, '1': {'precision': 0.3972176567269312, 'recall': 0.0706529683225793, 'f1-score': 0.11996737993511443, 'support': 95778}, '2': {'precision': 0.352564588075373, 'recall': 0.9250013073262563, 'f1-score': 0.5105375872359831, 'support': 95615}, 'accuracy': 0.35475084770750404, 'macro avg': {'precision': 0.35114395994626685, 'recall': 0.3362220496610844, 'f1-score': 0.21848645912773668, 'support': 271320}, 'weighted avg': {'precision': 0.35391780994538125, 'recall': 0.35475084770750404, 'f1-score': 0.22961749323314692, 'support': 271320}}
[[ 1040  4135 74752]
 [ 1348  6767 87663]
 [ 1037  6134 88444]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049916
{'0': {'precision': 0.3966189856957087, 'recall': 0.012580951202408942, 'f1-score': 0.024388293619062848, 'support': 24243}, '1': {'precision': 0.33518367346938777, 'recall': 0.08964282595406514, 'f1-score': 0.14145450787198124, 'support': 22902}, '2': {'precision': 0.3235364396654719, 'recall': 0.9017048481619606, 'f1-score': 0.47620722400028137, 'support': 22524}, 'accuracy': 0.3253670929681781, 'macro avg': {'precision': 0.35177969961018946, 'recall': 0.33464287510614493, 'f1-score': 0.21401667516377518, 'support': 69669}, 'weighted avg': {'precision': 0.3527960115265336, 'recall': 0.3253670929681781, 'f1-score': 0.20894412227638395, 'support': 69669}}
[[  305  2086 21852]
 [  236  2053 20613]
 [  228  1986 20310]]
Evaluating performance on  val set...
96/96 - 1s - 917ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079329
{'0': {'precision': 0.3766519823788546, 'recall': 0.019387755102040816, 'f1-score': 0.03687729135216735, 'support': 8820}, '1': {'precision': 0.28904347826086957, 'recall': 0.109471742853379, 'f1-score': 0.15879992356201034, 'support': 7591}, '2': {'precision': 0.32254864915926695, 'recall': 0.8441285537700866, 'f1-score': 0.4667486843004579, 'support': 8090}, 'accuracy': 0.3196196073629648, 'macro avg': {'precision': 0.3294147032663304, 'recall': 0.3243293505751688, 'f1-score': 0.2208086330715452, 'support': 24501}, 'weighted avg': {'precision': 0.33164434511890245, 'recall': 0.3196196073629648, 'f1-score': 0.21659135486208891, 'support': 24501}}
[[ 171  924 7725]
 [ 142  831 6618]
 [ 141 1120 6829]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046329
{'0': {'precision': 0.4340892983699504, 'recall': 0.019718944674275228, 'f1-score': 0.03772422819308646, 'support': 186369}, '1': {'precision': 0.3422748455861039, 'recall': 0.08291157359144849, 'f1-score': 0.13348754695978848, 'support': 185137}, '2': {'precision': 0.33653163811319786, 'recall': 0.9070271710175812, 'f1-score': 0.49091902599939735, 'support': 187700}, 'accuracy': 0.33846918666824033, 'macro avg': {'precision': 0.37096526068975066, 'recall': 0.336552563094435, 'f1-score': 0.22071026705075744, 'support': 559206}, 'weighted avg': {'precision': 0.3709465116773265, 'recall': 0.33846918666824033, 'f1-score': 0.2215455696929192, 'support': 559206}}
[[  3675  14520 168174]
 [  2317  15350 167470]
 [  2474  14977 170249]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002611
{'0': {'precision': 0.35400277649236467, 'recall': 0.015803173029251362, 'f1-score': 0.030255690245011763, 'support': 48408}, '1': {'precision': 0.3344311522255049, 'recall': 0.14145821809763792, 'f1-score': 0.19881946443996543, 'support': 48813}, '2': {'precision': 0.3563569825543661, 'recall': 0.8522910043014774, 'f1-score': 0.5025778454175006, 'support': 53470}, 'accuracy': 0.3533190436057893, 'macro avg': {'precision': 0.34826363709074526, 'recall': 0.3365174651427889, 'f1-score': 0.2438843333674926, 'support': 150691}, 'weighted avg': {'precision': 0.3484983316535687, 'recall': 0.3533190436057893, 'f1-score': 0.2524532279005536, 'support': 150691}}
[[  765  6556 41087]
 [  684  6905 41224]
 [  712  7186 45572]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1104275
{'0': {'precision': 0.360062893081761, 'recall': 0.013427147464086778, 'f1-score': 0.02588887004691651, 'support': 17055}, '1': {'precision': 0.4183168316831683, 'recall': 0.11382004310344827, 'f1-score': 0.17894959762812368, 'support': 22272}, '2': {'precision': 0.3061739269698911, 'recall': 0.8829744241094625, 'f1-score': 0.45468464317036555, 'support': 17321}, 'accuracy': 0.3187755966671374, 'macro avg': {'precision': 0.36151788391160683, 'recall': 0.33674053822566585, 'f1-score': 0.21984103694846857, 'support': 56648}, 'weighted avg': {'precision': 0.366488908801766, 'recall': 0.3187755966671374, 'f1-score': 0.21717788485696995, 'support': 56648}}
[[  229  1654 15172]
 [  251  2535 19486]
 [  156  1871 15294]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
2341/2341 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961192
{'0': {'precision': 0.3446202787587955, 'recall': 0.05853799268217849, 'f1-score': 0.10007672313907244, 'support': 218371}, '1': {'precision': 0.26526904511693356, 'recall': 0.09754068834528605, 'f1-score': 0.14263412952286092, 'support': 152685}, '2': {'precision': 0.380363879244418, 'recall': 0.8433796176613635, 'f1-score': 0.5242784028850266, 'support': 228227}, 'accuracy': 0.36736900596212474, 'macro avg': {'precision': 0.330084401040049, 'recall': 0.3331527662296094, 'f1-score': 0.25566308518232, 'support': 599283}, 'weighted avg': {'precision': 0.33801557213341893, 'recall': 0.36736900596212474, 'f1-score': 0.2724696566230668, 'support': 599283}}
[[ 12783  20084 185504]
 [  9731  14893 128061]
 [ 14579  21166 192482]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021
{'0': {'precision': 0.33122835608066814, 'recall': 0.03955723148035519, 'f1-score': 0.07067414265223629, 'support': 41105}, '1': {'precision': 0.3640654499685337, 'recall': 0.14126294198085565, 'f1-score': 0.20354667323458006, 'support': 40952}, '2': {'precision': 0.33789060598093346, 'recall': 0.8374321226016652, 'f1-score': 0.481502553285968, 'support': 41435}, 'accuracy': 0.34099374858290415, 'macro avg': {'precision': 0.3443948040100451, 'recall': 0.3394174320209587, 'f1-score': 0.2519077897242615, 'support': 123492}, 'weighted avg': {'precision': 0.3443530523647461, 'recall': 0.34099374858290415, 'f1-score': 0.2525812383913677, 'support': 123492}}
[[ 1626  4896 34583]
 [ 1756  5785 33411]
 [ 1527  5209 34699]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971751
{'0': {'precision': 0.4366616989567809, 'recall': 0.03688086097300019, 'f1-score': 0.06801694620161336, 'support': 15889}, '1': {'precision': 0.3033637873754153, 'recall': 0.13693879463867278, 'f1-score': 0.18869874071682272, 'support': 10669}, '2': {'precision': 0.36152424285511164, 'recall': 0.8610226887910599, 'f1-score': 0.5092329260965351, 'support': 14765}, 'accuracy': 0.3571860707112262, 'macro avg': {'precision': 0.36718324306243594, 'recall': 0.34494744813424427, 'f1-score': 0.25531620433832375, 'support': 41323}, 'weighted avg': {'precision': 0.3753989649344994, 'recall': 0.3571860707112262, 'f1-score': 0.25682482580452914, 'support': 41323}}
[[  586  1734 13569]
 [  325  1461  8883]
 [  431  1621 12713]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1180588
{'0': {'precision': 0.2772543741588156, 'recall': 0.0013328243583356518, 'f1-score': 0.002652895648478448, 'support': 154559}, '1': {'precision': 0.4327579285427539, 'recall': 0.005130450508761744, 'f1-score': 0.010140680780211563, 'support': 210118}, '2': {'precision': 0.2975411282612195, 'recall': 0.9949740596627756, 'f1-score': 0.45809241867124084, 'support': 154200}, 'accuracy': 0.298161221252821, 'macro avg': {'precision': 0.335851143654263, 'recall': 0.33381244484329103, 'f1-score': 0.15696199836664362, 'support': 518877}, 'weighted avg': {'precision': 0.3462539893328068, 'recall': 0.298161221252821, 'f1-score': 0.14103269064116356, 'support': 518877}}
[[   206    770 153583]
 [   405   1078 208635]
 [   132    643 153425]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050557
{'0': {'precision': 0.22033898305084745, 'recall': 0.0009538834060975163, 'f1-score': 0.001899543378995434, 'support': 27257}, '1': {'precision': 0.34285714285714286, 'recall': 0.0055847921812909465, 'f1-score': 0.010990559391292096, 'support': 27933}, '2': {'precision': 0.34666110680884016, 'recall': 0.9924619687563954, 'f1-score': 0.5138406929617758, 'support': 29318}, 'accuracy': 0.3464642400719459, 'macro avg': {'precision': 0.30328574423894344, 'recall': 0.33300021478126124, 'f1-score': 0.1755769319106878, 'support': 84508}, 'weighted avg': {'precision': 0.304660133500581, 'recall': 0.3464642400719459, 'f1-score': 0.18251001781620182, 'support': 84508}}
[[   26   120 27111]
 [   50   156 27727]
 [   42   179 29097]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048541
{'0': {'precision': 0.3157894736842105, 'recall': 0.000997589159531133, 'f1-score': 0.001988895334383028, 'support': 12029}, '1': {'precision': 0.3434343434343434, 'recall': 0.006306222758045071, 'f1-score': 0.012385028685912031, 'support': 10783}, '2': {'precision': 0.3427137427833706, 'recall': 0.9932733540738249, 'f1-score': 0.5095983779819679, 'support': 11893}, 'accuracy': 0.3426883734332229, 'macro avg': {'precision': 0.3339791866339748, 'recall': 0.3335257219971337, 'f1-score': 0.1746574340007543, 'support': 34705}, 'weighted avg': {'precision': 0.33360549336183604, 'recall': 0.3426883734332229, 'f1-score': 0.17917088879518883, 'support': 34705}}
[[   12    64 11953]
 [   12    68 10703]
 [   14    66 11813]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
2900/2900 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100912
{'0': {'precision': 0.36233100233100235, 'recall': 0.029538751558271764, 'f1-score': 0.05462429980109783, 'support': 263112}, '1': {'precision': 0.325734646709223, 'recall': 0.10517782101513011, 'f1-score': 0.15901169233248938, 'support': 225114}, '2': {'precision': 0.34213230076208695, 'recall': 0.872684274314136, 'f1-score': 0.49155318545312693, 'support': 254132}, 'accuracy': 0.3411103537646257, 'macro avg': {'precision': 0.3433993166007707, 'recall': 0.33580028229584596, 'f1-score': 0.23506305919557136, 'support': 742358}, 'weighted avg': {'precision': 0.34431881895512056, 'recall': 0.3411103537646257, 'f1-score': 0.23585313420556728, 'support': 742358}}
[[  7772  24276 231064]
 [  6058  23677 195379]
 [  7620  24735 221777]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019317
{'0': {'precision': 0.3628957600444362, 'recall': 0.03261014241980567, 'f1-score': 0.05984276009464926, 'support': 60104}, '1': {'precision': 0.37133768625481334, 'recall': 0.14942064133656696, 'f1-score': 0.2130950665321612, 'support': 59376}, '2': {'precision': 0.32820664963016405, 'recall': 0.8374797839028251, 'f1-score': 0.47159583589674037, 'support': 58122}, 'accuracy': 0.33506379432664046, 'macro avg': {'precision': 0.35414669864313786, 'recall': 0.3398368558863993, 'f1-score': 0.24817788750785028, 'support': 177602}, 'weighted avg': {'precision': 0.35436571722492416, 'recall': 0.33506379432664046, 'f1-score': 0.24582839774964665, 'support': 177602}}
[[ 1960  7347 50797]
 [ 1668  8872 48836]
 [ 1773  7673 48676]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1026983
{'0': {'precision': 0.3573667711598746, 'recall': 0.034043400358351586, 'f1-score': 0.06216486412796511, 'support': 20092}, '1': {'precision': 0.39485797687212304, 'recall': 0.16570082449941106, 'f1-score': 0.2334395327226868, 'support': 21225}, '2': {'precision': 0.3187867162210766, 'recall': 0.8160613810741688, 'f1-score': 0.45847462497844704, 'support': 19550}, 'accuracy': 0.331131811983505, 'macro avg': {'precision': 0.35700382141769144, 'recall': 0.3386018686439772, 'f1-score': 0.251359673943033, 'support': 60867}, 'weighted avg': {'precision': 0.35804876250475726, 'recall': 0.331131811983505, 'f1-score': 0.24918181363344247, 'support': 60867}}
[[  684  2500 16908]
 [  524  3517 17184]
 [  706  2890 15954]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
7167/7167 - 61s - 61s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102228
{'0': {'precision': 0.42746304412925706, 'recall': 0.044290185050158595, 'f1-score': 0.08026407094031185, 'support': 709051}, '1': {'precision': 0.20653949008397463, 'recall': 0.3795314413153752, 'f1-score': 0.26750424278149243, 'support': 365888}, '2': {'precision': 0.4175487871971667, 'recall': 0.5984608336668281, 'f1-score': 0.4918980886619768, 'support': 759632}, 'accuracy': 0.34061369115722423, 'macro avg': {'precision': 0.35051710713679946, 'recall': 0.3407608200107873, 'f1-score': 0.2798888007945937, 'support': 1834571}, 'weighted avg': {'precision': 0.3792967621132664, 'recall': 0.34061369115722423, 'f1-score': 0.28805068925302346, 'support': 1834571}}
[[ 31404 254240 423407]
 [ 16280 138866 210742]
 [ 25782 279240 454610]]
Evaluating performance on  train set...
1570/1570 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046573
{'0': {'precision': 0.394008631632394, 'recall': 0.0222456336493876, 'f1-score': 0.04211354647889235, 'support': 139533}, '1': {'precision': 0.3464391227277467, 'recall': 0.3784820316534524, 'f1-score': 0.36175239809676585, 'support': 131676}, '2': {'precision': 0.3318531320259555, 'recall': 0.6356962219327151, 'f1-score': 0.4360661942511092, 'support': 130490}, 'accuracy': 0.3382955894836681, 'macro avg': {'precision': 0.3574336287953654, 'recall': 0.3454746290785184, 'f1-score': 0.2799773796089225, 'support': 401699}, 'weighted avg': {'precision': 0.35822454006589144, 'recall': 0.3382955894836681, 'f1-score': 0.2748640547784691, 'support': 401699}}
[[ 3104 48924 87505]
 [ 2330 49837 79509]
 [ 2444 45094 82952]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065058
{'0': {'precision': 0.42076167076167076, 'recall': 0.029275380900485076, 'f1-score': 0.05474197350808143, 'support': 46797}, '1': {'precision': 0.2980867850098619, 'recall': 0.41968897528464316, 'f1-score': 0.3485872448391189, 'support': 36010}, '2': {'precision': 0.34926316962420256, 'recall': 0.5839135598351303, 'f1-score': 0.4370865544680443, 'support': 42943}, 'accuracy': 0.3304811133200795, 'macro avg': {'precision': 0.35603720846524506, 'recall': 0.3442926386734195, 'f1-score': 0.28013859093841487, 'support': 125750}, 'weighted avg': {'precision': 0.36121588332414445, 'recall': 0.3304811133200795, 'f1-score': 0.2694568169338814, 'support': 125750}}
[[ 1370 18850 26577]
 [  755 15113 20142]
 [ 1131 16737 25075]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
6357/6357 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962895
{'0': {'precision': 0.422130245255603, 'recall': 0.043576942598919706, 'f1-score': 0.07899876122383395, 'support': 660005}, '1': {'precision': 0.19298110494968165, 'recall': 0.1719923644660029, 'f1-score': 0.1818832288861774, 'support': 305938}, '2': {'precision': 0.4082069572409847, 'recall': 0.7941399763469676, 'f1-score': 0.5392344826807174, 'support': 661226}, 'accuracy': 0.37272465244851644, 'macro avg': {'precision': 0.3411061024820898, 'recall': 0.3365697611372968, 'f1-score': 0.2667054909302429, 'support': 1627169}, 'weighted avg': {'precision': 0.3733880004564045, 'recall': 0.37272465244851644, 'f1-score': 0.28536705697168263, 'support': 1627169}}
[[ 28761 110131 521113]
 [ 13166  52619 240153]
 [ 26206 109914 525106]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032192
{'0': {'precision': 0.38314680710994076, 'recall': 0.03528817327449726, 'f1-score': 0.06462438157748635, 'support': 148435}, '1': {'precision': 0.34214163485586413, 'recall': 0.14565908740666023, 'f1-score': 0.20432949777432763, 'support': 142758}, '2': {'precision': 0.3313091633399913, 'recall': 0.8292113017854047, 'f1-score': 0.4734518879801107, 'support': 144225}, 'accuracy': 0.3344487366163089, 'macro avg': {'precision': 0.3521992017685987, 'recall': 0.33671952082218737, 'f1-score': 0.24746858911064154, 'support': 435418}, 'weighted avg': {'precision': 0.3525323158547138, 'recall': 0.3344487366163089, 'f1-score': 0.2458460354570852, 'support': 435418}}
[[  5238  19872 123325]
 [  3911  20794 118053]
 [  4522  20110 119593]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000683
{'0': {'precision': 0.40148339245404707, 'recall': 0.046623101840582694, 'f1-score': 0.08354443121005216, 'support': 53407}, '1': {'precision': 0.3095823095823096, 'recall': 0.18233078017015544, 'f1-score': 0.22949738565170286, 'support': 40081}, '2': {'precision': 0.35130545903318133, 'recall': 0.7936762175950643, 'f1-score': 0.4870344978218927, 'support': 50571}, 'accuracy': 0.3466288118062738, 'macro avg': {'precision': 0.35412372035651263, 'recall': 0.3408766998686008, 'f1-score': 0.26669210489454925, 'support': 144059}, 'weighted avg': {'precision': 0.35829944994709706, 'recall': 0.3466288118062738, 'f1-score': 0.2657950127468057, 'support': 144059}}
[[ 2490  8129 42788]
 [ 1447  7308 31326]
 [ 2265  8169 40137]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
7459/7459 - 74s - 74s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097319
{'0': {'precision': 0.4667204768409288, 'recall': 0.03848546363540949, 'f1-score': 0.07110745341761796, 'support': 781282}, '1': {'precision': 0.17844880153340778, 'recall': 0.2459595670523592, 'f1-score': 0.20683470550981634, 'support': 331957}, '2': {'precision': 0.4173586662860669, 'recall': 0.7273696878941524, 'f1-score': 0.5303861684352466, 'support': 796012}, 'accuracy': 0.3617706629458358, 'macro avg': {'precision': 0.3541759815534678, 'recall': 0.33727157286064036, 'f1-score': 0.2694427757875603, 'support': 1909251}, 'weighted avg': {'precision': 0.3960192468489291, 'recall': 0.3617706629458358, 'f1-score': 0.2861902161980918, 'support': 1909251}}
[[ 30068 182023 569191]
 [ 11211  81648 239098]
 [ 23145 193872 578995]]
Evaluating performance on  train set...
1664/1664 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985903
{'0': {'precision': 0.3930389847252831, 'recall': 0.03631359442798365, 'f1-score': 0.06648455828003985, 'support': 142426}, '1': {'precision': 0.3641661853721469, 'recall': 0.34226276497500935, 'f1-score': 0.3528749082398773, 'support': 141853}, '2': {'precision': 0.3403212359964649, 'recall': 0.6713108043251179, 'f1-score': 0.45166881545800125, 'support': 141684}, 'accuracy': 0.3494129771834643, 'macro avg': {'precision': 0.36584213536463167, 'recall': 0.3499623879093703, 'f1-score': 0.29034276065930614, 'support': 425963}, 'weighted avg': {'precision': 0.36588884558753104, 'recall': 0.3494129771834643, 'f1-score': 0.28997762365627, 'support': 425963}}
[[ 5172 42934 94320]
 [ 3253 48551 90049]
 [ 4734 41836 95114]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006619
{'0': {'precision': 0.4185535282479666, 'recall': 0.041634777284555335, 'f1-score': 0.07573587907716786, 'support': 45731}, '1': {'precision': 0.3158241758241758, 'recall': 0.28411843210913945, 'f1-score': 0.29913351200853483, 'support': 40462}, '2': {'precision': 0.35228605566334525, 'recall': 0.6989104669116848, 'f1-score': 0.4684498214415859, 'support': 45983}, 'accuracy': 0.344525481176613, 'macro avg': {'precision': 0.3622212532451625, 'recall': 0.34155455876845986, 'f1-score': 0.2811064041757629, 'support': 132176}, 'weighted avg': {'precision': 0.3640518619119444, 'recall': 0.344525481176613, 'f1-score': 0.28074495966223634, 'support': 132176}}
[[ 1904 12563 31264]
 [ 1141 11496 27825]
 [ 1504 12341 32138]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
8238/8238 - 84s - 84s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0955182
{'0': {'precision': 0.38405284265156875, 'recall': 0.06939946546238537, 'f1-score': 0.11755618622909496, 'support': 774127}, '1': {'precision': 0.2844940795497005, 'recall': 0.24465816181762493, 'f1-score': 0.26307664641378514, 'support': 532167}, '2': {'precision': 0.3860728333430388, 'recall': 0.7270805812417437, 'f1-score': 0.5043438871782282, 'support': 802420}, 'accuracy': 0.3638933492166316, 'macro avg': {'precision': 0.35153991851476935, 'recall': 0.3470460695072513, 'f1-score': 0.29499223994036944, 'support': 2108714}, 'weighted avg': {'precision': 0.35969628820512295, 'recall': 0.3638933492166316, 'f1-score': 0.3014632375080781, 'support': 2108714}}
[[ 53724 160480 559923]
 [ 34139 130199 367829]
 [ 52024 166972 583424]]
Evaluating performance on  train set...
1806/1806 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977011
{'0': {'precision': 0.3566343042071197, 'recall': 0.0819495098419596, 'f1-score': 0.1332744414472681, 'support': 154644}, '1': {'precision': 0.3628996651201967, 'recall': 0.35279162677056164, 'f1-score': 0.3577742657005478, 'support': 151435}, '2': {'precision': 0.3464573692517474, 'recall': 0.620204505266395, 'f1-score': 0.444569972100713, 'support': 156084}, 'accuracy': 0.352477372701839, 'macro avg': {'precision': 0.3553304461930213, 'recall': 0.35164854729297207, 'f1-score': 0.31187289308284294, 'support': 462163}, 'weighted avg': {'precision': 0.35525024320331255, 'recall': 0.352477372701839, 'f1-score': 0.311967635173957, 'support': 462163}}
[[12673 46231 95740]
 [11143 53425 86867]
 [11719 47561 96804]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0954285
{'0': {'precision': 0.35347296813462226, 'recall': 0.0720239289427128, 'f1-score': 0.1196648535628248, 'support': 54829}, '1': {'precision': 0.36379920762033213, 'recall': 0.334450557966522, 'f1-score': 0.3485080954495902, 'support': 51616}, '2': {'precision': 0.36242880659993565, 'recall': 0.6618864142923787, 'f1-score': 0.46838453308879724, 'support': 57877}, 'accuracy': 0.3622156497608354, 'macro avg': {'precision': 0.35990032745163, 'recall': 0.3561203004005378, 'f1-score': 0.31218582736707073, 'support': 164322}, 'weighted avg': {'precision': 0.35987099298918424, 'recall': 0.3622156497608354, 'f1-score': 0.3143729368696978, 'support': 164322}}
[[ 3949 14499 36381]
 [ 3344 17263 31009]
 [ 3879 15690 38308]]
testing model on single stock: results/universal/W5/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
31315/31315 - 275s - 275s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962077
{'0': {'precision': 0.3807702964810197, 'recall': 0.03110746910402314, 'f1-score': 0.05751609444947028, 'support': 3092312}, '1': {'precision': 0.2374936801466905, 'recall': 0.11180928155354715, 'f1-score': 0.15203992328869695, 'support': 1823337}, '2': {'precision': 0.3866363524462562, 'recall': 0.8610249426203312, 'f1-score': 0.5336440979556153, 'support': 3100837}, 'accuracy': 0.37048128070079583, 'macro avg': {'precision': 0.3349667763579888, 'recall': 0.33464723109263383, 'f1-score': 0.24773337189792752, 'support': 8016486}, 'weighted avg': {'precision': 0.35045129231683725, 'recall': 0.37048128070079583, 'f1-score': 0.263185277245051, 'support': 8016486}}
[[  96194  321194 2674924]
 [  58843  203866 1560628]
 [  97593  333346 2669898]]
Evaluating performance on  train set...
5759/5759 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1029482
{'0': {'precision': 0.3471226622882544, 'recall': 0.03431213433509354, 'f1-score': 0.06245114249999099, 'support': 505244}, '1': {'precision': 0.33134073441502987, 'recall': 0.12830551840067494, 'f1-score': 0.18498070825533866, 'support': 471749}, '2': {'precision': 0.3368995629670558, 'recall': 0.8413046407832994, 'f1-score': 0.481130800416165, 'support': 497179}, 'accuracy': 0.3365570638975642, 'macro avg': {'precision': 0.3384543198901134, 'recall': 0.334640764506356, 'f1-score': 0.2428542170571649, 'support': 1474172}, 'weighted avg': {'precision': 0.3386244551661004, 'recall': 0.3365570638975642, 'f1-score': 0.24286559465253832, 'support': 1474172}}
[[ 17336  60548 427360]
 [ 15306  60528 395915]
 [ 17300  61600 418279]]
Evaluating performance on  val set...
2129/2129 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997188
{'0': {'precision': 0.3406935908691835, 'recall': 0.0413955324187664, 'f1-score': 0.07382148156603127, 'support': 187484}, '1': {'precision': 0.31478894410157565, 'recall': 0.10919452095128848, 'f1-score': 0.16214419091861368, 'support': 163021}, '2': {'precision': 0.3578308931704792, 'recall': 0.8568930490909559, 'f1-score': 0.5048436018095709, 'support': 194435}, 'accuracy': 0.35264799794472784, 'macro avg': {'precision': 0.33777114271374614, 'recall': 0.3358277008203369, 'f1-score': 0.24693642476473862, 'support': 544940}, 'weighted avg': {'precision': 0.33905871354736866, 'recall': 0.35264799794472784, 'f1-score': 0.2540325916899347, 'support': 544940}}
[[  7761  18784 160939]
 [  7158  17801 138062]
 [  7861  19964 166610]]
training model: results/universal/W5/deepVOL_L3/h300
Epoch 1/50
9913/9913 - 529s - loss: 3.2483 - accuracy300: 0.3860 - val_loss: 3.3170 - val_accuracy300: 0.3509 - 529s/epoch - 53ms/step
Epoch 2/50
9913/9913 - 514s - loss: 3.2319 - accuracy300: 0.3981 - val_loss: 3.3312 - val_accuracy300: 0.3517 - 514s/epoch - 52ms/step
Epoch 3/50
9913/9913 - 516s - loss: 3.2257 - accuracy300: 0.4016 - val_loss: 3.3169 - val_accuracy300: 0.3559 - 516s/epoch - 52ms/step
Epoch 4/50
9913/9913 - 518s - loss: 3.2152 - accuracy300: 0.4076 - val_loss: 3.3090 - val_accuracy300: 0.3571 - 518s/epoch - 52ms/step
Epoch 5/50
9913/9913 - 513s - loss: 3.2065 - accuracy300: 0.4117 - val_loss: 3.3014 - val_accuracy300: 0.3603 - 513s/epoch - 52ms/step
Epoch 6/50
9913/9913 - 514s - loss: 3.1988 - accuracy300: 0.4154 - val_loss: 3.3005 - val_accuracy300: 0.3621 - 514s/epoch - 52ms/step
Epoch 7/50
9913/9913 - 512s - loss: 3.1930 - accuracy300: 0.4190 - val_loss: 3.3033 - val_accuracy300: 0.3618 - 512s/epoch - 52ms/step
Epoch 8/50
9913/9913 - 512s - loss: 3.1894 - accuracy300: 0.4207 - val_loss: 3.3077 - val_accuracy300: 0.3581 - 512s/epoch - 52ms/step
Epoch 9/50
9913/9913 - 511s - loss: 3.1850 - accuracy300: 0.4232 - val_loss: 3.3279 - val_accuracy300: 0.3565 - 511s/epoch - 52ms/step
Epoch 10/50
9913/9913 - 517s - loss: 3.1818 - accuracy300: 0.4247 - val_loss: 3.3345 - val_accuracy300: 0.3575 - 517s/epoch - 52ms/step
Epoch 11/50
9913/9913 - 515s - loss: 3.1787 - accuracy300: 0.4261 - val_loss: 3.3435 - val_accuracy300: 0.3578 - 515s/epoch - 52ms/step
Epoch 12/50
9913/9913 - 516s - loss: 3.1750 - accuracy300: 0.4281 - val_loss: 3.3419 - val_accuracy300: 0.3579 - 516s/epoch - 52ms/step
Epoch 13/50
9913/9913 - 521s - loss: 3.1723 - accuracy300: 0.4294 - val_loss: 3.3404 - val_accuracy300: 0.3599 - 521s/epoch - 53ms/step
Epoch 14/50
9913/9913 - 517s - loss: 3.1696 - accuracy300: 0.4308 - val_loss: 3.3500 - val_accuracy300: 0.3595 - 517s/epoch - 52ms/step
Epoch 15/50
9913/9913 - 516s - loss: 3.1665 - accuracy300: 0.4320 - val_loss: 3.3430 - val_accuracy300: 0.3595 - 516s/epoch - 52ms/step
Epoch 16/50
9913/9913 - 514s - loss: 3.1643 - accuracy300: 0.4325 - val_loss: 3.3396 - val_accuracy300: 0.3584 - 514s/epoch - 52ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1370s - 1370s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0762862
{'0': {'precision': 0.4111323899723464, 'recall': 0.33731206305058664, 'f1-score': 0.37058171541887613, 'support': 4850962}, '1': {'precision': 0.3828213551572436, 'recall': 0.006588222069403301, 'f1-score': 0.012953518599353269, 'support': 3024640}, '2': {'precision': 0.39289349635446286, 'recall': 0.6971827736379684, 'f1-score': 0.5025677286500794, 'support': 4962789}, 'accuracy': 0.3985067910768569, 'macro avg': {'precision': 0.3956157471613509, 'recall': 0.34702768625265284, 'f1-score': 0.2953676542227696, 'support': 12838391}, 'weighted avg': {'precision': 0.39741209831257723, 'recall': 0.3985067910768568, 'f1-score': 0.33734719135659047, 'support': 12838391}}
[[1636288   18173 3196501]
 [ 854801   19927 2149912]
 [1488865   13953 3459971]]
Evaluating performance on  train set...
9913/9913 - 271s - 271s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999091
{'0': {'precision': 0.3896693533585723, 'recall': 0.29566848100608506, 'f1-score': 0.3362223418147071, 'support': 847324}, '1': {'precision': 0.41231755381350427, 'recall': 0.03414279002542777, 'f1-score': 0.06306348081267099, 'support': 836487}, '2': {'precision': 0.35292770231318404, 'recall': 0.7548305130434987, 'f1-score': 0.4809724629639449, 'support': 853222}, 'accuracy': 0.3638600680401083, 'macro avg': {'precision': 0.3849715364950869, 'recall': 0.3615472613583372, 'f1-score': 0.293419428530441, 'support': 2537033}, 'weighted avg': {'precision': 0.3847802329828013, 'recall': 0.3638600680401083, 'f1-score': 0.2948394160522849, 'support': 2537033}}
[[250527  23659 573138]
 [200259  28560 607668]
 [192136  17048 644038]]
Evaluating performance on  val set...
3496/3496 - 95s - 95s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994515
{'0': {'precision': 0.377494958447089, 'recall': 0.3287568189845763, 'f1-score': 0.3514441894166779, 'support': 305764}, '1': {'precision': 0.39948975763487654, 'recall': 0.01886317818333847, 'f1-score': 0.03602530703386676, 'support': 282243}, '2': {'precision': 0.3549727060469733, 'recall': 0.7124737110237351, 'f1-score': 0.4738574548471629, 'support': 306212}, 'accuracy': 0.36234300546063103, 'macro avg': {'precision': 0.3773191407096463, 'recall': 0.35336456939721667, 'f1-score': 0.2871089837659025, 'support': 894219}, 'weighted avg': {'precision': 0.37672478263469233, 'recall': 0.3623430054606309, 'f1-score': 0.2938068983432696, 'support': 894219}}
[[100522   4676 200566]
 [ 81048   5324 195871]
 [ 84717   3327 218168]]
testing model out of sample: results/universal/W5/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 567s - 567s/epoch - 27ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931029
{'0': {'precision': 0.3813852718978845, 'recall': 0.3195223621272323, 'f1-score': 0.3477237714120316, 'support': 1906214}, '1': {'precision': 0.3913819606287499, 'recall': 0.0052502499406328635, 'f1-score': 0.010361503986809528, 'support': 1503357}, '2': {'precision': 0.37049068216789194, 'recall': 0.7129197384793168, 'f1-score': 0.487590141660943, 'support': 1939273}, 'accuracy': 0.3738222688865108, 'macro avg': {'precision': 0.3810859715648421, 'recall': 0.345897450182394, 'f1-score': 0.2818918056865947, 'support': 5348844}, 'weighted avg': {'precision': 0.3802450270657144, 'recall': 0.3738222688865108, 'f1-score': 0.30361389442966635, 'support': 5348844}}
[[ 609078    7407 1289729]
 [ 436077    7893 1059387]
 [ 551860    4867 1382546]]
Evaluating performance on  train set...
4957/4957 - 138s - 138s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050323
{'0': {'precision': 0.37808431436702494, 'recall': 0.28663794616426846, 'f1-score': 0.32607095559119675, 'support': 427337}, '1': {'precision': 0.3970907411683214, 'recall': 0.02054218565606471, 'f1-score': 0.03906354697369946, 'support': 418602}, '2': {'precision': 0.3434423129235481, 'recall': 0.750223127093666, 'f1-score': 0.4711831544640016, 'support': 422405}, 'accuracy': 0.35320701639302904, 'macro avg': {'precision': 0.3728724561529648, 'recall': 0.3524677529713331, 'f1-score': 0.27877255234296594, 'support': 1268344}, 'weighted avg': {'precision': 0.3728201065906996, 'recall': 0.35320701639302904, 'f1-score': 0.27967521681903834, 'support': 1268344}}
[[122491   7543 297303]
 [101493   8599 308510]
 [ 99994   5513 316898]]
Evaluating performance on  val set...
1701/1701 - 47s - 47s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021203
{'0': {'precision': 0.37834092258958624, 'recall': 0.28546208844558213, 'f1-score': 0.32540373608257, 'support': 147277}, '1': {'precision': 0.4433420365535248, 'recall': 0.029843296330926652, 'f1-score': 0.05592222266134451, 'support': 142243}, '2': {'precision': 0.3458990059642147, 'recall': 0.7471006925360009, 'f1-score': 0.47286634618102436, 'support': 145552}, 'accuracy': 0.35632952706678434, 'macro avg': {'precision': 0.3891939883691085, 'recall': 0.3541353591041699, 'f1-score': 0.28473076830831295, 'support': 435072}, 'weighted avg': {'precision': 0.3887391270360145, 'recall': 0.35632952706678434, 'f1-score': 0.28663226586953594, 'support': 435072}}
[[ 42042   2852 102383]
 [ 34748   4245 103250]
 [ 34332   2478 108742]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038492
{'0': {'precision': 0.32776134756332775, 'recall': 0.37234257719448066, 'f1-score': 0.3486325402294618, 'support': 88996}, '1': {'precision': 0.3333333333333333, 'recall': 6.045218232378189e-05, 'f1-score': 0.00012088244182532489, 'support': 82710}, '2': {'precision': 0.37029094498366666, 'recall': 0.6326921918605819, 'f1-score': 0.4671667568509143, 'support': 99614}, 'accuracy': 0.35444125018428424, 'macro avg': {'precision': 0.3437952086267759, 'recall': 0.3350317404124621, 'f1-score': 0.27197339317406716, 'support': 271320}, 'weighted avg': {'precision': 0.3450744916753239, 'recall': 0.35444125018428424, 'f1-score': 0.28591054494313556, 'support': 271320}}
[[33137     8 55851]
 [31377     5 51328]
 [36587     2 63025]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081821
{'0': {'precision': 0.3726809748999636, 'recall': 0.425103734439834, 'f1-score': 0.39716999418491955, 'support': 24100}, '1': {'precision': 0.1111111111111111, 'recall': 8.758101243650377e-05, 'f1-score': 0.00017502406580904875, 'support': 22836}, '2': {'precision': 0.35146225184412133, 'recall': 0.6518277394096688, 'f1-score': 0.4566832064597652, 'support': 22733}, 'accuracy': 0.3597726391939026, 'macro avg': {'precision': 0.27841811261839866, 'recall': 0.3590063516206465, 'f1-score': 0.28467607490349794, 'support': 69669}, 'weighted avg': {'precision': 0.280020327543023, 'recall': 0.3597726391939026, 'f1-score': 0.2864627458679358, 'support': 69669}}
[[10245     9 13846]
 [ 9337     2 13497]
 [ 7908     7 14818]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0888063
{'0': {'precision': 0.406295907660021, 'recall': 0.41724137931034483, 'f1-score': 0.41169590643274856, 'support': 9280}, '1': {'precision': 0.3333333333333333, 'recall': 0.00014841199168892847, 'f1-score': 0.00029669188547693225, 'support': 6738}, '2': {'precision': 0.3769374665954035, 'recall': 0.6650948956737004, 'f1-score': 0.48117351072448933, 'support': 8483}, 'accuracy': 0.38835149585731193, 'macro avg': {'precision': 0.3721889025295859, 'recall': 0.36082822899191136, 'f1-score': 0.2977220363475716, 'support': 24501}, 'weighted avg': {'precision': 0.37606573414202693, 'recall': 0.38835149585731193, 'f1-score': 0.3226126285905103, 'support': 24501}}
[[3872    1 5407]
 [2818    1 3919]
 [2840    1 5642]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0646123
{'0': {'precision': 0.4728556818607739, 'recall': 0.3965113146551724, 'f1-score': 0.43133136824419205, 'support': 222720}, '1': {'precision': 0.18838457784285018, 'recall': 0.003317775886817428, 'f1-score': 0.0065207108588418135, 'support': 116343}, '2': {'precision': 0.421305845635482, 'recall': 0.7088574244922619, 'f1-score': 0.5285002345315044, 'support': 220143}, 'accuracy': 0.4376687660718948, 'macro avg': {'precision': 0.360848701779702, 'recall': 0.3695621716780839, 'f1-score': 0.3221174378781794, 'support': 559206}, 'weighted avg': {'precision': 0.39337771264924587, 'recall': 0.4376687660718948, 'f1-score': 0.3812018979218135, 'support': 559206}}
[[ 88311   1085 133324]
 [ 34935    386  81022]
 [ 63515    578 156050]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0740943
{'0': {'precision': 0.4631883539168307, 'recall': 0.3180263400446511, 'f1-score': 0.37712065091991015, 'support': 48823}, '1': {'precision': 0.43268900048152986, 'recall': 0.12795215525132733, 'f1-score': 0.19750062798291887, 'support': 49159}, '2': {'precision': 0.39301582352482656, 'recall': 0.7652583050332961, 'f1-score': 0.5193220077120657, 'support': 52709}, 'accuracy': 0.41245329847170703, 'macro avg': {'precision': 0.42963105930772905, 'recall': 0.40374560010975813, 'f1-score': 0.3646477622049649, 'support': 150691}, 'weighted avg': {'precision': 0.42869364872569055, 'recall': 0.41245329847170703, 'f1-score': 0.36826378891486783, 'support': 150691}}
[[15527  4451 28845]
 [ 9418  6290 33451]
 [ 8577  3796 40336]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0764171
{'0': {'precision': 0.45489049278247884, 'recall': 0.3629188384214445, 'f1-score': 0.4037330535383935, 'support': 20145}, '1': {'precision': 0.3340990301174068, 'recall': 0.08652829190904283, 'f1-score': 0.13745668381812454, 'support': 15128}, '2': {'precision': 0.4189262916689399, 'recall': 0.7184561403508772, 'f1-score': 0.529250598797236, 'support': 21375}, 'accuracy': 0.4232629572094337, 'macro avg': {'precision': 0.4026386048562752, 'recall': 0.3893010902271215, 'f1-score': 0.35681344538458465, 'support': 56648}, 'weighted avg': {'precision': 0.4090624309621303, 'recall': 0.4232629572094337, 'f1-score': 0.37998479426674275, 'support': 56648}}
[[ 7311  1416 11418]
 [ 3936  1309  9883]
 [ 4825  1193 15357]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
2341/2341 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.065246
{'0': {'precision': 0.40666945385732517, 'recall': 0.4831491026652085, 'f1-score': 0.4416225763606929, 'support': 229513}, '1': {'precision': 0.26153846153846155, 'recall': 0.00027703991004351155, 'f1-score': 0.0005534935208699615, 'support': 122726}, '2': {'precision': 0.42851104365698045, 'recall': 0.5662918346529363, 'f1-score': 0.4878600783580723, 'support': 247044}, 'accuracy': 0.4185368181643731, 'macro avg': {'precision': 0.36557298635092234, 'recall': 0.3499059924093961, 'f1-score': 0.31001204941321175, 'support': 599283}, 'weighted avg': {'precision': 0.38595217595546777, 'recall': 0.4185368181643731, 'f1-score': 0.37035750323637684, 'support': 599283}}
[[110889     41 118583]
 [ 54697     34  67995]
 [107090     55 139899]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1120133
{'0': {'precision': 0.36286227125470627, 'recall': 0.40100147560415106, 'f1-score': 0.3809797409880146, 'support': 41339}, '1': {'precision': 0.2926829268292683, 'recall': 0.00029128334587469963, 'f1-score': 0.0005819874872690238, 'support': 41197}, '2': {'precision': 0.337135288747155, 'recall': 0.6401504053130188, 'f1-score': 0.44166673685806457, 'support': 40956}, 'accuracy': 0.34663783888834904, 'macro avg': {'precision': 0.33089349561037656, 'recall': 0.34714772142101485, 'f1-score': 0.2744094884444494, 'support': 123492}, 'weighted avg': {'precision': 0.3309180744818461, 'recall': 0.34663783888834904, 'f1-score': 0.27420562081734406, 'support': 123492}}
[[16577    15 24747]
 [14383    12 26802]
 [14724    14 26218]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964458
{'0': {'precision': 0.3926300765537823, 'recall': 0.4010337287124776, 'f1-score': 0.3967874118996886, 'support': 15091}, '1': {'precision': 0.2, 'recall': 0.00017060479399471124, 'f1-score': 0.00034091877610159375, 'support': 11723}, '2': {'precision': 0.35680914321016255, 'recall': 0.6369150182645255, 'f1-score': 0.4573846763017224, 'support': 14509}, 'accuracy': 0.3701328557945938, 'macro avg': {'precision': 0.31647973992131495, 'recall': 0.3460397839236659, 'f1-score': 0.28483766899250423, 'support': 41323}, 'weighted avg': {'precision': 0.32540532739901207, 'recall': 0.3701328557945938, 'f1-score': 0.3055951816724857, 'support': 41323}}
[[6052    5 9034]
 [4097    2 7624]
 [5265    3 9241]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
2027/2027 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1246885
{'0': {'precision': 0.2880745277677698, 'recall': 0.034905548591492204, 'f1-score': 0.06226637593449627, 'support': 160347}, '1': {'precision': 0.5714285714285714, 'recall': 1.9729021884417527e-05, 'f1-score': 3.94566814958028e-05, 'support': 202747}, '2': {'precision': 0.30073622309742293, 'recall': 0.9641616864484571, 'f1-score': 0.4584691647436602, 'support': 155783}, 'accuracy': 0.3002657662605974, 'macro avg': {'precision': 0.38674644076458803, 'recall': 0.33302898802061126, 'f1-score': 0.17359166578655075, 'support': 518877}, 'weighted avg': {'precision': 0.4025942678480507, 'recall': 0.3002657662605974, 'f1-score': 0.15690409903895053, 'support': 518877}}
[[  5597      2 154748]
 [  8250      4 194493]
 [  5582      1 150200]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071953
{'0': {'precision': 0.3057510313030818, 'recall': 0.04552681023269259, 'f1-score': 0.0792527596943108, 'support': 27676}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 27878}, '2': {'precision': 0.34288308909511606, 'recall': 0.9519582786488914, 'f1-score': 0.504170477409914, 'support': 28954}, 'accuracy': 0.3410683012259194, 'macro avg': {'precision': 0.21621137346606592, 'recall': 0.3324950296271946, 'f1-score': 0.19447441236807494, 'support': 84508}, 'weighted avg': {'precision': 0.2176101967151522, 'recall': 0.3410683012259194, 'f1-score': 0.19869303947823158, 'support': 84508}}
[[ 1260     0 26416]
 [ 1471     0 26407]
 [ 1390     1 27563]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105818
{'0': {'precision': 0.3092391304347826, 'recall': 0.04770288397048961, 'f1-score': 0.0826554328878559, 'support': 11928}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11040}, '2': {'precision': 0.33868857447132206, 'recall': 0.9483684075998977, 'f1-score': 0.49912559974889026, 'support': 11737}, 'accuracy': 0.3371272150986889, 'macro avg': {'precision': 0.21597590163536826, 'recall': 0.3320237638567958, 'f1-score': 0.1939270108789154, 'support': 34705}, 'weighted avg': {'precision': 0.22082674388116968, 'recall': 0.3371272150986889, 'f1-score': 0.19720936947814638, 'support': 34705}}
[[  569     0 11359]
 [  665     0 10375]
 [  606     0 11131]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967377
{'0': {'precision': 0.36208058818770955, 'recall': 0.4498191075974809, 'f1-score': 0.40120908506919367, 'support': 268668}, '1': {'precision': 0.28865979381443296, 'recall': 0.0001334827068386051, 'f1-score': 0.00026684201999409133, 'support': 209765}, '2': {'precision': 0.35767338245734287, 'recall': 0.5535890878090367, 'f1-score': 0.4345709123086189, 'support': 263925}, 'accuracy': 0.35964588513897605, 'macro avg': {'precision': 0.3361379214864951, 'recall': 0.33451389270445203, 'f1-score': 0.2786822797992689, 'support': 742358}, 'weighted avg': {'precision': 0.33976751995904175, 'recall': 0.35964588513897605, 'f1-score': 0.2997773912515881, 'support': 742358}}
[[120852     33 147783]
 [ 95136     28 114601]
 [117783     36 146106]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1137043
{'0': {'precision': 0.3577333858247717, 'recall': 0.4737470568449378, 'f1-score': 0.4076467225747632, 'support': 59460}, '1': {'precision': 0.41304347826086957, 'recall': 0.00031850870869864047, 'f1-score': 0.0006365265749845056, 'support': 59653}, '2': {'precision': 0.33855869167012437, 'recall': 0.5719707979278155, 'f1-score': 0.4253474208846677, 'support': 58489}, 'accuracy': 0.3470794247812525, 'macro avg': {'precision': 0.3697785185852552, 'recall': 0.34867878782715067, 'f1-score': 0.2778768900114718, 'support': 177602}, 'weighted avg': {'precision': 0.36999622215363837, 'recall': 0.3470794247812525, 'f1-score': 0.27676935025616994, 'support': 177602}}
[[28169    15 31276]
 [25551    19 34083]
 [25023    12 33454]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1216257
{'0': {'precision': 0.34384297360998417, 'recall': 0.4555879793170532, 'f1-score': 0.39190557977716123, 'support': 19533}, '1': {'precision': 0.42857142857142855, 'recall': 0.00027376009490349956, 'f1-score': 0.0005471706716519995, 'support': 21917}, '2': {'precision': 0.32054214800411757, 'recall': 0.5773291445640418, 'f1-score': 0.4122157053816029, 'support': 19417}, 'accuracy': 0.33047464143131744, 'macro avg': {'precision': 0.36431885006184345, 'recall': 0.3443969613253328, 'f1-score': 0.2682228186101387, 'support': 60867}, 'weighted avg': {'precision': 0.36691888365320735, 'recall': 0.33047464143131744, 'f1-score': 0.25746424796346906, 'support': 60867}}
[[ 8899     3 10631]
 [ 8780     6 13131]
 [ 8202     5 11210]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
7167/7167 - 101s - 101s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0881797
{'0': {'precision': 0.4203349135766173, 'recall': 0.2772313385203319, 'f1-score': 0.33410449650444973, 'support': 618855}, '1': {'precision': 0.40169408298551434, 'recall': 0.029309968004643448, 'f1-score': 0.05463355016228779, 'support': 558206}, '2': {'precision': 0.3821239597135261, 'recall': 0.805310945841128, 'f1-score': 0.5183081716495708, 'support': 657510}, 'accuracy': 0.3910598172542791, 'macro avg': {'precision': 0.4013843187585526, 'recall': 0.3706174174553678, 'f1-score': 0.30234873943876944, 'support': 1834571}, 'weighted avg': {'precision': 0.40096825632788813, 'recall': 0.3910598172542791, 'f1-score': 0.31508827929115885, 'support': 1834571}}
[[171566  13759 433530]
 [119199  16361 422646]
 [117400  10610 529500]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0927606
{'0': {'precision': 0.4371005400816019, 'recall': 0.2714695844502058, 'f1-score': 0.33492663004192574, 'support': 136542}, '1': {'precision': 0.4045150663695378, 'recall': 0.0935902800609738, 'f1-score': 0.15201072874125407, 'support': 133828}, '2': {'precision': 0.35946756943910135, 'recall': 0.7826451126560013, 'f1-score': 0.4926581077162366, 'support': 131329}, 'accuracy': 0.3793288009181004, 'macro avg': {'precision': 0.40036105863008037, 'recall': 0.3825683257223937, 'f1-score': 0.32653182216647214, 'support': 401699}, 'weighted avg': {'precision': 0.4008636831876413, 'recall': 0.3793288009181004, 'f1-score': 0.32555505578414384, 'support': 401699}}
[[ 37067  11001  88474]
 [ 26627  12525  94676]
 [ 21108   7437 102784]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094038
{'0': {'precision': 0.4371520656314093, 'recall': 0.27016749660479855, 'f1-score': 0.3339488556879861, 'support': 44180}, '1': {'precision': 0.4318830841592474, 'recall': 0.06345328002369317, 'f1-score': 0.1106496524714338, 'support': 40518}, '2': {'precision': 0.35072924437525, 'recall': 0.7902172853941343, 'f1-score': 0.4858287468643528, 'support': 41052}, 'accuracy': 0.37333598409542745, 'macro avg': {'precision': 0.40658813138863553, 'recall': 0.3746126873408753, 'f1-score': 0.31014241834125755, 'support': 125750}, 'weighted avg': {'precision': 0.4072409861125472, 'recall': 0.37333598409542745, 'f1-score': 0.31158174774877284, 'support': 125750}}
[[11936  2150 30094]
 [ 7988  2571 29959]
 [ 7380  1232 32440]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992132
{'0': {'precision': 0.4088629140893949, 'recall': 0.2067116479772489, 'f1-score': 0.2745946047037894, 'support': 568236}, '1': {'precision': 0.39454443194600675, 'recall': 0.011326802055455313, 'f1-score': 0.022021401411849648, 'support': 495462}, '2': {'precision': 0.35930232382711075, 'recall': 0.84531768272014, 'f1-score': 0.5042662518017562, 'support': 563471}, 'accuracy': 0.3683606312558806, 'macro avg': {'precision': 0.3875698899541708, 'recall': 0.35445204425094806, 'f1-score': 0.26696075263913177, 'support': 1627169}, 'weighted avg': {'precision': 0.38734073713334, 'recall': 0.3683606312558806, 'f1-score': 0.2772205693162589, 'support': 1627169}}
[[117461   5183 445592]
 [ 86096   5612 403754]
 [ 83730   3429 476312]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006249
{'0': {'precision': 0.40356934963221675, 'recall': 0.2067336690228183, 'f1-score': 0.2734096663604383, 'support': 147557}, '1': {'precision': 0.40857821311962006, 'recall': 0.01938063625931897, 'f1-score': 0.03700592121623529, 'support': 142049}, '2': {'precision': 0.3470200401028627, 'recall': 0.8403286423613968, 'f1-score': 0.491196703173356, 'support': 145812}, 'accuracy': 0.3577895263861393, 'macro avg': {'precision': 0.38638920095156654, 'recall': 0.3554809825478447, 'f1-score': 0.2672040969166765, 'support': 435418}, 'weighted avg': {'precision': 0.38626628941979557, 'recall': 0.3577895263861393, 'f1-score': 0.26921840145585524, 'support': 435418}}
[[ 30505   2483 114569]
 [ 23303   2753 115993]
 [ 21780   1502 122530]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006229
{'0': {'precision': 0.40361684340212084, 'recall': 0.18760609469270886, 'f1-score': 0.25615034486610255, 'support': 48895}, '1': {'precision': 0.4393414211438475, 'recall': 0.042775785699219575, 'f1-score': 0.07796101949025487, 'support': 47410}, '2': {'precision': 0.34290928407416293, 'recall': 0.8381078024877497, 'f1-score': 0.48669058186903386, 'support': 47754}, 'accuracy': 0.35557653461428995, 'macro avg': {'precision': 0.3952891828733771, 'recall': 0.3561632276265594, 'f1-score': 0.27360064874179707, 'support': 144059}, 'weighted avg': {'precision': 0.39524994818965903, 'recall': 0.35557653461428995, 'f1-score': 0.2739296058756129, 'support': 144059}}
[[ 9173  1379 38343]
 [ 7032  2028 38350]
 [ 6522  1209 40023]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
7459/7459 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961266
{'0': {'precision': 0.401489457639413, 'recall': 0.24420363842330023, 'f1-score': 0.30368974654367203, 'support': 670895}, '1': {'precision': 0.380905752753978, 'recall': 0.0055634016840374, 'f1-score': 0.010966627902879092, 'support': 559370}, '2': {'precision': 0.36503566948177946, 'recall': 0.8026719254888908, 'f1-score': 0.5018446141089384, 'support': 678986}, 'accuracy': 0.3728949205735652, 'macro avg': {'precision': 0.38247695995839015, 'recall': 0.3508129885320761, 'f1-score': 0.2721669961851632, 'support': 1909251}, 'weighted avg': {'precision': 0.382494826337523, 'recall': 0.3728949205735652, 'f1-score': 0.2883978074715278, 'support': 1909251}}
[[163835   2783 504277]
 [112525   3112 443733]
 [131708   2275 545003]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985827
{'0': {'precision': 0.42364161679294793, 'recall': 0.19814670536890078, 'f1-score': 0.2700056840335029, 'support': 145039}, '1': {'precision': 0.4075668623613829, 'recall': 0.06760051356770871, 'f1-score': 0.11596641774885079, 'support': 138638}, '2': {'precision': 0.3505565004625071, 'recall': 0.8256750488452834, 'f1-score': 0.49215778273036515, 'support': 142286}, 'accuracy': 0.3652735096710278, 'macro avg': {'precision': 0.3939216598722793, 'recall': 0.36380742259396426, 'f1-score': 0.2927099615042396, 'support': 425963}, 'weighted avg': {'precision': 0.39399688082509055, 'recall': 0.3652735096710278, 'f1-score': 0.29407687734374377, 'support': 425963}}
[[ 28739   7959 108341]
 [ 19959   9372 109307]
 [ 19140   5664 117482]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967171
{'0': {'precision': 0.39583891077370253, 'recall': 0.22756255221846006, 'f1-score': 0.2889890965949546, 'support': 45482}, '1': {'precision': 0.41493302935309206, 'recall': 0.035448215416078295, 'f1-score': 0.0653163761972052, 'support': 41074}, '2': {'precision': 0.35626219274287946, 'recall': 0.8006137658921526, 'f1-score': 0.49310112056163086, 'support': 45620}, 'accuracy': 0.3656488318605496, 'macro avg': {'precision': 0.3890113776232247, 'recall': 0.35454151117556365, 'f1-score': 0.28246886445126357, 'support': 132176}, 'weighted avg': {'precision': 0.3881127119930139, 'recall': 0.3656488318605496, 'f1-score': 0.2899306988203405, 'support': 132176}}
[[10350  1147 33985]
 [ 7607  1456 32011]
 [ 8190   906 36524]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
8238/8238 - 115s - 115s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937184
{'0': {'precision': 0.37645522034591244, 'recall': 0.301701782496294, 'f1-score': 0.3349584551435328, 'support': 750801}, '1': {'precision': 0.39169295478443744, 'recall': 0.003770917201793843, 'f1-score': 0.007469919786096257, 'support': 592694}, '2': {'precision': 0.37106431447516974, 'recall': 0.7279968218248632, 'f1-score': 0.4915716382073969, 'support': 765219}, 'accuracy': 0.3726584069722115, 'macro avg': {'precision': 0.3797374965351732, 'recall': 0.34448984050765036, 'f1-score': 0.2780000043790087, 'support': 2108714}, 'weighted avg': {'precision': 0.37878179956708863, 'recall': 0.3726584069722115, 'f1-score': 0.29974405117780134, 'support': 2108714}}
[[226518   2117 522166]
 [168407   2235 422052]
 [206788   1354 557077]]
Evaluating performance on  train set...
1806/1806 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032804
{'0': {'precision': 0.3833982675011398, 'recall': 0.23889954222919532, 'f1-score': 0.2943724665757054, 'support': 154881}, '1': {'precision': 0.38891527033444134, 'recall': 0.037503189046687646, 'f1-score': 0.06840962245238891, 'support': 152867}, '2': {'precision': 0.34212941062482544, 'recall': 0.7775021856684907, 'f1-score': 0.4751676630472425, 'support': 154415}, 'accuracy': 0.3522393614374149, 'macro avg': {'precision': 0.37148098282013553, 'recall': 0.3513016389814579, 'f1-score': 0.2793165840251123, 'support': 462163}, 'weighted avg': {'precision': 0.371434603463911, 'recall': 0.3522393614374149, 'f1-score': 0.28003819094254867, 'support': 462163}}
[[ 37001   5042 112838]
 [ 29116   5733 118018]
 [ 30391   3966 120058]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998715
{'0': {'precision': 0.3721723946344948, 'recall': 0.2582143250486435, 'f1-score': 0.3048929829314549, 'support': 54478}, '1': {'precision': 0.43573925560353693, 'recall': 0.038912863832522265, 'f1-score': 0.07144542971779223, 'support': 54455}, '2': {'precision': 0.34981341750094525, 'recall': 0.7683655599487262, 'f1-score': 0.4807541329899295, 'support': 55389}, 'accuracy': 0.35749930015457454, 'macro avg': {'precision': 0.38590835591299233, 'recall': 0.355164249609964, 'f1-score': 0.28569751521305886, 'support': 164322}, 'weighted avg': {'precision': 0.3857012710455597, 'recall': 0.35749930015457454, 'f1-score': 0.2868088963839375, 'support': 164322}}
[[14067  1474 38937]
 [12170  2119 40166]
 [11560  1270 42559]]
testing model on single stock: results/universal/W5/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
31315/31315 - 431s - 431s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0665113
{'0': {'precision': 0.40813716095726216, 'recall': 0.379804256885699, 'f1-score': 0.39346130972317095, 'support': 3178145}, '1': {'precision': 0.21540762902019447, 'recall': 0.00018136317093352914, 'f1-score': 0.00036242120013011927, 'support': 1587974}, '2': {'precision': 0.4110809981985637, 'recall': 0.6396496149511732, 'f1-score': 0.5005046943920786, 'support': 3250367}, 'accuracy': 0.40996229520016625, 'macro avg': {'precision': 0.34487526272534014, 'recall': 0.3398784116692686, 'f1-score': 0.29810947510512653, 'support': 8016486}, 'weighted avg': {'precision': 0.37115325874303323, 'recall': 0.40996229520016625, 'f1-score': 0.35899477048049483, 'support': 8016486}}
[[1207073     516 1970556]
 [ 579707     288 1007979]
 [1170738     533 2079096]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045098
{'0': {'precision': 0.37022664592320204, 'recall': 0.34243036194618637, 'f1-score': 0.3557864245091085, 'support': 489244}, '1': {'precision': 0.420479302832244, 'recall': 0.0003963169221165377, 'f1-score': 0.000791887461713472, 'support': 486984}, '2': {'precision': 0.34838489190668637, 'recall': 0.7144799415195283, 'f1-score': 0.46838320239345155, 'support': 497944}, 'accuracy': 0.35511188653698483, 'macro avg': {'precision': 0.37969694688737743, 'recall': 0.3524355401292771, 'f1-score': 0.2749871714547579, 'support': 1474172}, 'weighted avg': {'precision': 0.3794496331392074, 'recall': 0.35511188653698483, 'f1-score': 0.2765488798653035, 'support': 1474172}}
[[167532    161 321551]
 [142912    193 343879]
 [142068    105 355771]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030405
{'0': {'precision': 0.3618718357758024, 'recall': 0.38335262377125345, 'f1-score': 0.3723026423418527, 'support': 184029}, '1': {'precision': 0.3333333333333333, 'recall': 0.00022924869471524446, 'f1-score': 0.00045818227636409454, 'support': 174483}, '2': {'precision': 0.3506761140662023, 'recall': 0.6581092968867338, 'f1-score': 0.4575466860589787, 'support': 186428}, 'accuracy': 0.35467757918302933, 'macro avg': {'precision': 0.3486270943917793, 'recall': 0.34723038978423415, 'f1-score': 0.27676917022573183, 'support': 544940}, 'weighted avg': {'precision': 0.3489040236707143, 'recall': 0.35467757918302933, 'f1-score': 0.28240529521462715, 'support': 544940}}
[[ 70548     35 113446]
 [ 60712     40 113731]
 [ 63693     45 122690]]
training model: results/universal/W5/deepVOL_L3/h500
Epoch 1/50
9913/9913 - 512s - loss: 3.2538 - accuracy500: 0.3879 - val_loss: 3.3180 - val_accuracy500: 0.3522 - 512s/epoch - 52ms/step
Epoch 2/50
9913/9913 - 518s - loss: 3.2485 - accuracy500: 0.3893 - val_loss: 3.3258 - val_accuracy500: 0.3562 - 518s/epoch - 52ms/step
Epoch 3/50
9913/9913 - 504s - loss: 3.2456 - accuracy500: 0.3918 - val_loss: 3.3578 - val_accuracy500: 0.3555 - 504s/epoch - 51ms/step
Epoch 4/50
9913/9913 - 498s - loss: 3.2365 - accuracy500: 0.3982 - val_loss: 3.3518 - val_accuracy500: 0.3551 - 498s/epoch - 50ms/step
Epoch 5/50
9913/9913 - 504s - loss: 3.2336 - accuracy500: 0.4015 - val_loss: 3.3431 - val_accuracy500: 0.3541 - 504s/epoch - 51ms/step
Epoch 6/50
9913/9913 - 502s - loss: 3.2296 - accuracy500: 0.4035 - val_loss: 3.3359 - val_accuracy500: 0.3574 - 502s/epoch - 51ms/step
Epoch 7/50
9913/9913 - 499s - loss: 3.2222 - accuracy500: 0.4072 - val_loss: 3.3539 - val_accuracy500: 0.3572 - 499s/epoch - 50ms/step
Epoch 8/50
9913/9913 - 509s - loss: 3.2165 - accuracy500: 0.4099 - val_loss: 3.3729 - val_accuracy500: 0.3553 - 509s/epoch - 51ms/step
Epoch 9/50
9913/9913 - 507s - loss: 3.2080 - accuracy500: 0.4148 - val_loss: 3.3545 - val_accuracy500: 0.3563 - 507s/epoch - 51ms/step
Epoch 10/50
9913/9913 - 503s - loss: 3.2040 - accuracy500: 0.4168 - val_loss: 3.3620 - val_accuracy500: 0.3570 - 503s/epoch - 51ms/step
Epoch 11/50
9913/9913 - 505s - loss: 3.1992 - accuracy500: 0.4187 - val_loss: 3.3752 - val_accuracy500: 0.3559 - 505s/epoch - 51ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1330s - 1330s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0908113
{'0': {'precision': 0.41901459326686896, 'recall': 0.0024118795881590853, 'f1-score': 0.004796152162888904, 'support': 4809527}, '1': {'precision': 0.2631578947368421, 'recall': 1.593009618910681e-06, 'f1-score': 3.1859999515728014e-06, 'support': 3138713}, '2': {'precision': 0.381044952464692, 'recall': 0.9982203003547334, 'f1-score': 0.5515499011092074, 'support': 4890151}, 'accuracy': 0.3811266536437471, 'macro avg': {'precision': 0.35440581348946765, 'recall': 0.3335445909841705, 'f1-score': 0.185449746424016, 'support': 12838391}, 'weighted avg': {'precision': 0.3664482924935335, 'recall': 0.3811266536437471, 'f1-score': 0.21188321213476677, 'support': 12838391}}
[[  11600       9 4797918]
 [   7386       5 3131322]
 [   8698       5 4881448]]
Evaluating performance on  train set...
9913/9913 - 270s - 270s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137351
{'0': {'precision': 0.36941788134806425, 'recall': 0.004667224215609572, 'f1-score': 0.009217988398168913, 'support': 852541}, '1': {'precision': 0.3333333333333333, 'recall': 1.2024202314418462e-06, 'f1-score': 2.4048317880285073e-06, 'support': 831656}, '2': {'precision': 0.33629014285550296, 'recall': 0.9961540085080837, 'f1-score': 0.5028304915961227, 'support': 852836}, 'accuracy': 0.33643078351759714, 'macro avg': {'precision': 0.3463471191789669, 'recall': 0.3336074783813083, 'f1-score': 0.17068362827535988, 'support': 2537033}, 'weighted avg': {'precision': 0.34645308000382435, 'recall': 0.33643078351759714, 'f1-score': 0.17212730704355036, 'support': 2537033}}
[[  3979      2 848560]
 [  3512      1 828143]
 [  3280      0 849556]]
Evaluating performance on  val set...
3496/3496 - 93s - 93s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054614
{'0': {'precision': 0.4066115702479339, 'recall': 0.0038932798191998836, 'f1-score': 0.0077127109238322765, 'support': 315929}, '1': {'precision': 1.0, 'recall': 3.7930223560737665e-06, 'f1-score': 7.5860159382194864e-06, 'support': 263642}, '2': {'precision': 0.35205729847519, 'recall': 0.9971491952912461, 'f1-score': 0.5203853576051901, 'support': 314648}, 'accuracy': 0.3522425714506178, 'macro avg': {'precision': 0.5862229562410413, 'recall': 0.3336820893776007, 'f1-score': 0.17603521818165355, 'support': 894219}, 'weighted avg': {'precision': 0.5623639305667639, 'recall': 0.3522425714506178, 'f1-score': 0.18583465688117481, 'support': 894219}}
[[  1230      0 314699]
 [   898      1 262743]
 [   897      0 313751]]
testing model out of sample: results/universal/W5/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 559s - 559s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984546
{'0': {'precision': 0.3670940911453821, 'recall': 0.0021949717171392737, 'f1-score': 0.0043638505909016235, 'support': 1930321}, '1': {'precision': 0.09090909090909091, 'recall': 6.874973789162428e-07, 'f1-score': 1.37498435955291e-06, 'support': 1454551}, '2': {'precision': 0.3672514764512559, 'recall': 0.9980427419535512, 'f1-score': 0.5369284738818476, 'support': 1963972}, 'accuracy': 0.3672505685340608, 'macro avg': {'precision': 0.2750848861685763, 'recall': 0.33341280038935645, 'f1-score': 0.1804312331523696, 'support': 5348844}, 'weighted avg': {'precision': 0.2920468345896198, 'recall': 0.3672505685340608, 'f1-score': 0.19872296165826392, 'support': 5348844}}
[[   4237       1 1926083]
 [   3470       1 1451080]
 [   3835       9 1960128]]
Evaluating performance on  train set...
4957/4957 - 136s - 136s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1158727
{'0': {'precision': 0.3510431154381085, 'recall': 0.005910910125595131, 'f1-score': 0.011626059139054392, 'support': 427007}, '1': {'precision': 0.4, 'recall': 4.764616055326721e-06, 'f1-score': 9.529118604174706e-06, 'support': 419761}, '2': {'precision': 0.3325293046261782, 'recall': 0.9947648822513615, 'f1-score': 0.49844032744506683, 'support': 421576}, 'accuracy': 0.3326345218647307, 'macro avg': {'precision': 0.36119080668809556, 'recall': 0.3335601856643373, 'f1-score': 0.17002530523424178, 'support': 1268344}, 'weighted avg': {'precision': 0.36109181871871204, 'recall': 0.3326345218647307, 'f1-score': 0.1695903383231411, 'support': 1268344}}
[[  2524      1 424482]
 [  2461      2 417298]
 [  2205      2 419369]]
Evaluating performance on  val set...
1701/1701 - 46s - 46s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1093433
{'0': {'precision': 0.36312849162011174, 'recall': 0.00428584615790376, 'f1-score': 0.008471704506946797, 'support': 151662}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 133441}, '2': {'precision': 0.34488242041538864, 'recall': 0.9964125919356667, 'f1-score': 0.5124080582940419, 'support': 149969}, 'accuracy': 0.3449566968225949, 'macro avg': {'precision': 0.2360036373451668, 'recall': 0.3335661460311901, 'f1-score': 0.17362658760032956, 'support': 435072}, 'weighted avg': {'precision': 0.24546388874339145, 'recall': 0.3449566968225949, 'f1-score': 0.17957983906854896, 'support': 435072}}
[[   650      0 151012]
 [   603      0 132838]
 [   537      1 149431]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105758
{'0': {'precision': 0.37735849056603776, 'recall': 0.0007035399786592873, 'f1-score': 0.0014044615060508883, 'support': 85283}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 88926}, '2': {'precision': 0.35794232946478294, 'recall': 0.9994748277744024, 'f1-score': 0.5271103966633358, 'support': 97111}, 'accuracy': 0.35795370779890906, 'macro avg': {'precision': 0.24510027334360687, 'recall': 0.3333927892510206, 'f1-score': 0.17617161938979556, 'support': 271320}, 'weighted avg': {'precision': 0.24672859246497839, 'recall': 0.35795370779890906, 'f1-score': 0.18910509516804413, 'support': 271320}}
[[   60     0 85223]
 [   48     0 88878]
 [   51     0 97060]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1211617
{'0': {'precision': 0.4883720930232558, 'recall': 0.000883763992929888, 'f1-score': 0.0017643352236925015, 'support': 23762}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 23884}, '2': {'precision': 0.3161606296498434, 'recall': 0.999545929255778, 'f1-score': 0.48037621796200725, 'support': 22023}, 'accuracy': 0.31626691928978456, 'macro avg': {'precision': 0.2681775742243664, 'recall': 0.333476564416236, 'f1-score': 0.1607135177285666, 'support': 69669}, 'weighted avg': {'precision': 0.2665102588123427, 'recall': 0.31626691928978456, 'f1-score': 0.15245302188581242, 'support': 69669}}
[[   21     0 23741]
 [   12     0 23872]
 [   10     0 22013]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113844
{'0': {'precision': 0.4482758620689655, 'recall': 0.0014463729417000446, 'f1-score': 0.0028834423866030833, 'support': 8988}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7375}, '2': {'precision': 0.33221641059169665, 'recall': 0.9990169574834111, 'f1-score': 0.49862005519779207, 'support': 8138}, 'accuracy': 0.332353781478307, 'macro avg': {'precision': 0.2601640908868874, 'recall': 0.3334877768083704, 'f1-score': 0.16716783252813172, 'support': 24501}, 'weighted avg': {'precision': 0.2747920736978527, 'recall': 0.332353781478307, 'f1-score': 0.16667427408556468, 'support': 24501}}
[[  13    0 8975]
 [   8    0 7367]
 [   8    0 8130]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944468
{'0': {'precision': 0.5607476635514018, 'recall': 0.003651480253918319, 'f1-score': 0.007255712710985427, 'support': 213612}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 136834}, '2': {'precision': 0.37358263940553765, 'recall': 0.9982276298141406, 'f1-score': 0.5436910935003098, 'support': 208760}, 'accuracy': 0.37404820406075756, 'macro avg': {'precision': 0.3114434343189798, 'recall': 0.3339597033560196, 'f1-score': 0.18364893540376506, 'support': 559206}, 'weighted avg': {'precision': 0.35366491366123054, 'recall': 0.37404820406075756, 'f1-score': 0.20573967372085364, 'support': 559206}}
[[   780      0 212832]
 [   241      0 136593]
 [   370      0 208390]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015209
{'0': {'precision': 0.3740685543964232, 'recall': 0.005118062069246768, 'f1-score': 0.010097962303622794, 'support': 49042}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 47540}, '2': {'precision': 0.3593502113079764, 'recall': 0.9963037572307749, 'f1-score': 0.5281907831888972, 'support': 54109}, 'accuracy': 0.35941098008507477, 'macro avg': {'precision': 0.24447292190146652, 'recall': 0.33380727310000724, 'f1-score': 0.17942958183084, 'support': 150691}, 'weighted avg': {'precision': 0.25077244578888375, 'recall': 0.35941098008507477, 'f1-score': 0.19294516165439418, 'support': 150691}}
[[  251     0 48791]
 [  222     0 47318]
 [  198     2 53909]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981865
{'0': {'precision': 0.38305084745762713, 'recall': 0.005646047766563406, 'f1-score': 0.011128071298439117, 'support': 20014}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15992}, '2': {'precision': 0.36443490142494633, 'recall': 0.9949132835965507, 'f1-score': 0.5334632118968764, 'support': 20642}, 'accuracy': 0.3645318457844937, 'macro avg': {'precision': 0.24916191629419115, 'recall': 0.33351977712103803, 'f1-score': 0.18153042773177183, 'support': 56648}, 'weighted avg': {'precision': 0.26813029403033983, 'recall': 0.3645318457844937, 'f1-score': 0.198320590999546, 'support': 56648}}
[[  113     0 19901]
 [   77     0 15915]
 [  105     0 20537]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0906342
{'0': {'precision': 0.3521703521703522, 'recall': 0.0019935002619366625, 'f1-score': 0.003964558689298458, 'support': 215701}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 153024}, '2': {'precision': 0.384694872262194, 'recall': 0.997887733238491, 'f1-score': 0.5553119105403087, 'support': 230558}, 'accuracy': 0.3846279637500146, 'macro avg': {'precision': 0.2456217414775154, 'recall': 0.33329374450014254, 'f1-score': 0.1864254897432024, 'support': 599283}, 'weighted avg': {'precision': 0.2747582986544322, 'recall': 0.3846279637500146, 'f1-score': 0.21506827783233107, 'support': 599283}}
[[   430      1 215270]
 [   304      0 152720]
 [   487      0 230071]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.114237
{'0': {'precision': 0.32051282051282054, 'recall': 0.001186605596031991, 'f1-score': 0.002364457475232308, 'support': 42137}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 39514}, '2': {'precision': 0.33892780696633584, 'recall': 0.99906789990679, 'f1-score': 0.5061479503805009, 'support': 41841}, 'accuracy': 0.3389045444239303, 'macro avg': {'precision': 0.21981354249305216, 'recall': 0.3334181685009407, 'f1-score': 0.16950413595191105, 'support': 123492}, 'weighted avg': {'precision': 0.2241969284587437, 'recall': 0.3389045444239303, 'f1-score': 0.17229753778790852, 'support': 123492}}
[[   50     0 42087]
 [   67     0 39447]
 [   39     0 41802]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071221
{'0': {'precision': 0.4594594594594595, 'recall': 0.001118715451434588, 'f1-score': 0.0022319963237707606, 'support': 15196}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11618}, '2': {'precision': 0.35103909315506465, 'recall': 0.9988972361982218, 'f1-score': 0.5195089165695851, 'support': 14509}, 'accuracy': 0.3511361711395591, 'macro avg': {'precision': 0.27016618420484134, 'recall': 0.33333865054988543, 'f1-score': 0.17391363763111864, 'support': 41323}, 'weighted avg': {'precision': 0.29221431523686037, 'recall': 0.3511361711395591, 'f1-score': 0.18322658777543088, 'support': 41323}}
[[   17     0 15179]
 [    4     0 11614]
 [   16     0 14493]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
2027/2027 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1332517
{'0': {'precision': 0.34615384615384615, 'recall': 0.00017252506405791732, 'f1-score': 0.0003448782388217938, 'support': 156499}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 207624}, '2': {'precision': 0.2982561647188988, 'recall': 0.9998772244982359, 'f1-score': 0.4594590180728168, 'support': 154754}, 'accuracy': 0.2982633649207808, 'macro avg': {'precision': 0.21480333695758166, 'recall': 0.33334991652076457, 'f1-score': 0.15326796543721286, 'support': 518877}, 'weighted avg': {'precision': 0.1933580892661252, 'recall': 0.2982633649207808, 'f1-score': 0.13713672793810106, 'support': 518877}}
[[    27      0 156472]
 [    32      0 207592]
 [    19      0 154735]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089174
{'0': {'precision': 0.35, 'recall': 0.000257694006773671, 'f1-score': 0.0005150088287227781, 'support': 27164}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 27788}, '2': {'precision': 0.34978931919325823, 'recall': 0.9998984977669508, 'f1-score': 0.5182736487671425, 'support': 29556}, 'accuracy': 0.3497893690538174, 'macro avg': {'precision': 0.23326310639775275, 'recall': 0.33338539725790817, 'f1-score': 0.1729295525319551, 'support': 84508}, 'weighted avg': {'precision': 0.23483898705537867, 'recall': 0.3497893690538174, 'f1-score': 0.18142762416321637, 'support': 84508}}
[[    7     0 27157]
 [   10     0 27778]
 [    3     0 29553]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1086851
{'0': {'precision': 0.25, 'recall': 8.39066957543212e-05, 'f1-score': 0.0001677570877369569, 'support': 11918}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10897}, '2': {'precision': 0.34258378721074323, 'recall': 0.9998317914213625, 'f1-score': 0.5103131506084867, 'support': 11890}, 'accuracy': 0.3425731162656678, 'macro avg': {'precision': 0.19752792907024774, 'recall': 0.3333052327057056, 'f1-score': 0.1701603025654079, 'support': 34705}, 'weighted avg': {'precision': 0.20322204955873033, 'recall': 0.3425731162656678, 'f1-score': 0.17489187983594745, 'support': 34705}}
[[    1     0 11917]
 [    1     0 10896]
 [    2     0 11888]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
2900/2900 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057727
{'0': {'precision': 0.34511434511434513, 'recall': 0.0006278009946485638, 'f1-score': 0.001253322058468229, 'support': 264415}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 217508}, '2': {'precision': 0.35081961025884345, 'recall': 0.9993472459538848, 'f1-score': 0.5193293106338146, 'support': 260435}, 'accuracy': 0.3508159136158026, 'macro avg': {'precision': 0.23197798512439619, 'recall': 0.3333250156495111, 'f1-score': 0.17352754423076092, 'support': 742358}, 'weighted avg': {'precision': 0.24599871593108913, 'recall': 0.3508159136158026, 'f1-score': 0.182638196351366, 'support': 742358}}
[[   166      0 264249]
 [   145      0 217363]
 [   170      0 260265]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1159711
{'0': {'precision': 0.27235772357723576, 'recall': 0.0011156068401685065, 'f1-score': 0.002222111669402849, 'support': 60057}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 58329}, '2': {'precision': 0.3334705338415391, 'recall': 0.9987672250743043, 'f1-score': 0.5, 'support': 59216}, 'accuracy': 0.3333858852940845, 'macro avg': {'precision': 0.20194275247292492, 'recall': 0.33329427730482425, 'f1-score': 0.16740737055646762, 'support': 177602}, 'weighted avg': {'precision': 0.20328475432055174, 'recall': 0.3333858852940845, 'f1-score': 0.16746125246635357, 'support': 177602}}
[[   67     0 59990]
 [  106     0 58223]
 [   73     0 59143]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197059
{'0': {'precision': 0.3125, 'recall': 0.0009943817431511957, 'f1-score': 0.0019824552708529513, 'support': 20113}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20953}, '2': {'precision': 0.32541692707476727, 'recall': 0.9992424625018939, 'f1-score': 0.4909494683820701, 'support': 19801}, 'accuracy': 0.32539799891566856, 'macro avg': {'precision': 0.2126389756915891, 'recall': 0.33341228141501505, 'f1-score': 0.16431064121764102, 'support': 60867}, 'weighted avg': {'precision': 0.20912634223811702, 'recall': 0.32539799891566856, 'f1-score': 0.16036873094281032, 'support': 60867}}
[[   20     0 20093]
 [   30     0 20923]
 [   14     1 19786]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
7167/7167 - 99s - 99s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939975
{'0': {'precision': 0.3983044432669745, 'recall': 0.008067990683939302, 'f1-score': 0.01581562266124451, 'support': 652207}, '1': {'precision': 0.35714285714285715, 'recall': 1.0275295723010908e-05, 'f1-score': 2.05500002055e-05, 'support': 486604}, '2': {'precision': 0.3798696129126481, 'recall': 0.9944147407151891, 'f1-score': 0.5497376749330382, 'support': 695760}, 'accuracy': 0.3800021912479811, 'macro avg': {'precision': 0.3784389711074933, 'recall': 0.33416433556495045, 'f1-score': 0.18852461586482938, 'support': 1834571}, 'weighted avg': {'precision': 0.3803952917423586, 'recall': 0.3800021912479811, 'f1-score': 0.21411574925840043, 'support': 1834571}}
[[  5262      6 646939]
 [  4066      5 482533]
 [  3883      3 691874]]
Evaluating performance on  train set...
1570/1570 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1190561
{'0': {'precision': 0.36576289207868157, 'recall': 0.009985051449138645, 'f1-score': 0.019439421338155516, 'support': 137806}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 133917}, '2': {'precision': 0.32400266375161774, 'recall': 0.9919677478919185, 'f1-score': 0.48846112318174845, 'support': 129976}, 'accuracy': 0.324392144366802, 'macro avg': {'precision': 0.2299218519434331, 'recall': 0.3339842664470191, 'f1-score': 0.16930018150663464, 'support': 401699}, 'weighted avg': {'precision': 0.23031396973747773, 'recall': 0.324392144366802, 'f1-score': 0.16471808952373992, 'support': 401699}}
[[  1376      2 136428]
 [  1342      0 132575]
 [  1044      0 128932]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087669
{'0': {'precision': 0.4953560371517028, 'recall': 0.010129146619397315, 'f1-score': 0.019852348160555866, 'support': 47388}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 35144}, '2': {'precision': 0.3443232543416065, 'recall': 0.994145957702809, 'f1-score': 0.5114911398282133, 'support': 43218}, 'accuracy': 0.34548707753479124, 'macro avg': {'precision': 0.27989309716443644, 'recall': 0.33475836810740206, 'f1-score': 0.17711449599625637, 'support': 125750}, 'weighted avg': {'precision': 0.30500909975889023, 'recall': 0.34548707753479124, 'f1-score': 0.18327146843521386, 'support': 125750}}
[[  480     0 46908]
 [  236     0 34908]
 [  253     0 42965]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
6357/6357 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963613
{'0': {'precision': 0.40338872596937114, 'recall': 0.0020370720791134294, 'f1-score': 0.004053673518837467, 'support': 607735}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 415279}, '2': {'precision': 0.3713527492149498, 'recall': 0.9982769322442089, 'f1-score': 0.5413330161942866, 'support': 604155}, 'accuracy': 0.37141317220276443, 'macro avg': {'precision': 0.25824715839477363, 'recall': 0.3334380014411074, 'f1-score': 0.18179556323770804, 'support': 1627169}, 'weighted avg': {'precision': 0.2885429033978362, 'recall': 0.37141317220276443, 'f1-score': 0.2025066896400005, 'support': 1627169}}
[[  1238      0 606497]
 [   790      0 414489]
 [  1041      0 603114]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1171948
{'0': {'precision': 0.36649214659685864, 'recall': 0.0028883845677738808, 'f1-score': 0.0057315974780971085, 'support': 145410}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 146677}, '2': {'precision': 0.3292544764571513, 'recall': 0.9975929840718337, 'f1-score': 0.49510130660678703, 'support': 143331}, 'accuracy': 0.329352484279474, 'macro avg': {'precision': 0.2319155410180033, 'recall': 0.3334937895465359, 'f1-score': 0.16694430136162805, 'support': 435418}, 'weighted avg': {'precision': 0.2307759357714407, 'recall': 0.329352484279474, 'f1-score': 0.16489166035062283, 'support': 435418}}
[[   420      0 144990]
 [   381      0 146296]
 [   345      0 142986]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023535
{'0': {'precision': 0.34564643799472294, 'recall': 0.002478994777079706, 'f1-score': 0.004922683802115627, 'support': 52844}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 39783}, '2': {'precision': 0.35715478841870824, 'recall': 0.9977445948047908, 'f1-score': 0.5260158268071672, 'support': 51432}, 'accuracy': 0.3571245114848777, 'macro avg': {'precision': 0.2342670754711437, 'recall': 0.3334078631939568, 'f1-score': 0.17697950353642758, 'support': 144059}, 'weighted avg': {'precision': 0.25430223344146596, 'recall': 0.3571245114848777, 'f1-score': 0.18960412266630491, 'support': 144059}}
[[  131     0 52713]
 [  132     0 39651]
 [  116     0 51316]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
7459/7459 - 101s - 101s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0904669
{'0': {'precision': 0.4371176070700204, 'recall': 0.005359241427019578, 'f1-score': 0.010588661514140172, 'support': 719878}, '1': {'precision': 0.6, 'recall': 6.533328687410711e-06, 'f1-score': 1.3066515095091563e-05, 'support': 459184}, '2': {'precision': 0.38274013112890837, 'recall': 0.9961352471757312, 'f1-score': 0.5530027457520293, 'support': 730189}, 'accuracy': 0.38299207385514006, 'macro avg': {'precision': 0.4732859127329762, 'recall': 0.3338336739771461, 'f1-score': 0.18786815792708822, 'support': 1909251}, 'weighted avg': {'precision': 0.4554950513846731, 'recall': 0.38299207385514006, 'f1-score': 0.21549029767488515, 'support': 1909251}}
[[  3858      0 716020]
 [  2148      3 457033]
 [  2820      2 727367]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1135278
{'0': {'precision': 0.37900755564631405, 'recall': 0.012843846233694335, 'f1-score': 0.02484571826347706, 'support': 144505}, '1': {'precision': 0.5, 'recall': 1.4367712875625894e-05, 'f1-score': 2.873460005028555e-05, 'support': 139201}, '2': {'precision': 0.3341360654725432, 'recall': 0.9889987838911266, 'f1-score': 0.49951093430187865, 'support': 142257}, 'accuracy': 0.3346534792928024, 'macro avg': {'precision': 0.4043812070396191, 'recall': 0.3339523326125655, 'f1-score': 0.1747951290551353, 'support': 425963}, 'weighted avg': {'precision': 0.4035612977995699, 'recall': 0.3346534792928024, 'f1-score': 0.17525761012977112, 'support': 425963}}
[[  1856      2 142647]
 [  1476      2 137723]
 [  1565      0 140692]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014495
{'0': {'precision': 0.3771186440677966, 'recall': 0.009304756926293779, 'f1-score': 0.01816141210080604, 'support': 47825}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 36839}, '2': {'precision': 0.3599804574185471, 'recall': 0.9925071560868833, 'f1-score': 0.528334864543886, 'support': 47512}, 'accuracy': 0.36013345841907757, 'macro avg': {'precision': 0.2456997004954479, 'recall': 0.33393730433772567, 'f1-score': 0.18216542554823068, 'support': 132176}, 'weighted avg': {'precision': 0.26585076447624667, 'recall': 0.36013345841907757, 'f1-score': 0.19648662100479786, 'support': 132176}}
[[  445     0 47380]
 [  379     0 36460]
 [  356     0 47156]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
8238/8238 - 115s - 115s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987813
{'0': {'precision': 0.36991995073891626, 'recall': 0.003173588558704785, 'f1-score': 0.006293187094645291, 'support': 757187}, '1': {'precision': 0.6666666666666666, 'recall': 3.4493820432069595e-06, 'f1-score': 6.898728391889165e-06, 'support': 579814}, '2': {'precision': 0.3661533192370904, 'recall': 0.9974342793240493, 'f1-score': 0.5356661683939193, 'support': 771713}, 'accuracy': 0.3661653500664386, 'macro avg': {'precision': 0.46757997888089103, 'recall': 0.3335371057549324, 'f1-score': 0.18065541807231886, 'support': 2108714}, 'weighted avg': {'precision': 0.45013525819775807, 'recall': 0.3661653500664386, 'f1-score': 0.1982960540147757, 'support': 2108714}}
[[  2403      1 754783]
 [  2113      2 577699]
 [  1980      0 769733]]
Evaluating performance on  train set...
1806/1806 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1141626
{'0': {'precision': 0.3495575221238938, 'recall': 0.01218188009586163, 'f1-score': 0.02354328997609661, 'support': 155641}, '1': {'precision': 0.6666666666666666, 'recall': 1.3213792556670653e-05, 'f1-score': 2.642706131078224e-05, 'support': 151357}, '2': {'precision': 0.33599059412877463, 'recall': 0.9890052524731737, 'f1-score': 0.5015811381252849, 'support': 155165}, 'accuracy': 0.33615196370111844, 'macro avg': {'precision': 0.45073826097311165, 'recall': 0.3337334487871973, 'f1-score': 0.1750502850542308, 'support': 462163}, 'weighted avg': {'precision': 0.4488549050995924, 'recall': 0.33615196370111844, 'f1-score': 0.17633635408524329, 'support': 462163}}
[[  1896      0 153745]
 [  1823      2 149532]
 [  1705      1 153459]]
Evaluating performance on  val set...
642/642 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114674
{'0': {'precision': 0.4024390243902439, 'recall': 0.009684341813246271, 'f1-score': 0.018913545752511952, 'support': 54521}, '1': {'precision': 1.0, 'recall': 1.8617813523979743e-05, 'f1-score': 3.7234933814905145e-05, 'support': 53712}, '2': {'precision': 0.3419136366703679, 'recall': 0.9936886020431813, 'f1-score': 0.5087677660225105, 'support': 56089}, 'accuracy': 0.34240089580214456, 'macro avg': {'precision': 0.5814508870202039, 'recall': 0.33446385388998384, 'f1-score': 0.1759061822362791, 'support': 164322}, 'weighted avg': {'precision': 0.5771045387470014, 'recall': 0.34240089580214456, 'f1-score': 0.17994827606269617, 'support': 164322}}
[[  528     0 53993]
 [  430     1 53281]
 [  354     0 55735]]
testing model on single stock: results/universal/W5/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
31315/31315 - 416s - 416s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.087174
{'0': {'precision': 0.4131019310681985, 'recall': 0.0005509676001709629, 'f1-score': 0.0011004674707676117, 'support': 3067331}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1848467}, '2': {'precision': 0.38680993635486016, 'recall': 0.9995439721764976, 'f1-score': 0.5577703324990914, 'support': 3100688}, 'accuracy': 0.3868233537737108, 'macro avg': {'precision': 0.26663728914101953, 'recall': 0.3333649799255562, 'f1-score': 0.18629026665661966, 'support': 8016486}, 'weighted avg': {'precision': 0.3076781132358526, 'recall': 0.3868233537737108, 'f1-score': 0.216160456679338, 'support': 8016486}}
[[   1690       0 3065641]
 [    987       0 1847480]
 [   1414       0 3099274]]
Evaluating performance on  train set...
5759/5759 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138268
{'0': {'precision': 0.35648148148148145, 'recall': 0.0010910401114115913, 'f1-score': 0.0021754221691259565, 'support': 494024}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 483210}, '2': {'precision': 0.3371359813344307, 'recall': 0.9990904297920465, 'f1-score': 0.5041500896630579, 'support': 496938}, 'accuracy': 0.33715536585961475, 'macro avg': {'precision': 0.2312058209386374, 'recall': 0.3333938233011527, 'f1-score': 0.16877517061072791, 'support': 1474172}, 'weighted avg': {'precision': 0.23311125682741002, 'recall': 0.33715536585961475, 'f1-score': 0.17067618162511627, 'support': 1474172}}
[[   539      1 493484]
 [   522      0 482688]
 [   451      1 496486]]
Evaluating performance on  val set...
2129/2129 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062034
{'0': {'precision': 0.289272030651341, 'recall': 0.0007998559199932198, 'f1-score': 0.00159530073003497, 'support': 188784}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 164770}, '2': {'precision': 0.3512686942753546, 'recall': 0.9992214686549695, 'f1-score': 0.5198041869845774, 'support': 191386}, 'accuracy': 0.3512093074466914, 'macro avg': {'precision': 0.21351357497556522, 'recall': 0.3333404415249876, 'f1-score': 0.17379982923820414, 'support': 544940}, 'weighted avg': {'precision': 0.2235802865582739, 'recall': 0.3512093074466914, 'f1-score': 0.18311082207811732, 'support': 544940}}
[[   151      0 188633]
 [   222      0 164548]
 [   149      0 191237]]
training model: results/universal/W5/deepVOL_L3/h1000
Epoch 1/50
9913/9913 - 519s - loss: 3.2586 - accuracy1000: 0.3856 - val_loss: 3.4840 - val_accuracy1000: 0.3458 - 519s/epoch - 52ms/step
Epoch 2/50
9913/9913 - 506s - loss: 3.2612 - accuracy1000: 0.3777 - val_loss: 3.3094 - val_accuracy1000: 0.3511 - 506s/epoch - 51ms/step
Epoch 3/50
9913/9913 - 512s - loss: 3.2525 - accuracy1000: 0.3875 - val_loss: 3.4501 - val_accuracy1000: 0.3498 - 512s/epoch - 52ms/step
Epoch 4/50
9913/9913 - 522s - loss: 3.2408 - accuracy1000: 0.3945 - val_loss: 3.4476 - val_accuracy1000: 0.3509 - 522s/epoch - 53ms/step
Epoch 5/50
9913/9913 - 510s - loss: 3.2352 - accuracy1000: 0.3984 - val_loss: 3.3920 - val_accuracy1000: 0.3501 - 510s/epoch - 51ms/step
Epoch 6/50
9913/9913 - 502s - loss: 3.2178 - accuracy1000: 0.4093 - val_loss: 3.3906 - val_accuracy1000: 0.3499 - 502s/epoch - 51ms/step
Epoch 7/50
9913/9913 - 509s - loss: 3.2040 - accuracy1000: 0.4172 - val_loss: 3.3622 - val_accuracy1000: 0.3490 - 509s/epoch - 51ms/step
Epoch 8/50
9913/9913 - 509s - loss: 3.1930 - accuracy1000: 0.4235 - val_loss: 3.3529 - val_accuracy1000: 0.3501 - 509s/epoch - 51ms/step
Epoch 9/50
9913/9913 - 505s - loss: 3.1887 - accuracy1000: 0.4257 - val_loss: 3.3840 - val_accuracy1000: 0.3495 - 505s/epoch - 51ms/step
Epoch 10/50
9913/9913 - 502s - loss: 3.1801 - accuracy1000: 0.4295 - val_loss: 3.3659 - val_accuracy1000: 0.3496 - 502s/epoch - 51ms/step
Epoch 11/50
9913/9913 - 506s - loss: 3.1745 - accuracy1000: 0.4316 - val_loss: 3.3666 - val_accuracy1000: 0.3509 - 506s/epoch - 51ms/step
Epoch 12/50
9913/9913 - 507s - loss: 3.1688 - accuracy1000: 0.4340 - val_loss: 3.3566 - val_accuracy1000: 0.3511 - 507s/epoch - 51ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1313s - 1313s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001443
{'0': {'precision': 0.3877142753734997, 'recall': 0.206696640833801, 'f1-score': 0.26964255244284624, 'support': 4923573}, '1': {'precision': 0.21737739326302857, 'recall': 0.03494332296565981, 'f1-score': 0.06020820305011175, 'support': 2916437}, '2': {'precision': 0.3889736411643615, 'recall': 0.7583349488564397, 'f1-score': 0.5141987235945495, 'support': 4998381}, 'accuracy': 0.38245002820057433, 'macro avg': {'precision': 0.3313551032669632, 'recall': 0.33332497088530016, 'f1-score': 0.2813498263625025, 'support': 12838391}, 'weighted avg': {'precision': 0.34950995557902365, 'recall': 0.38245002820057433, 'f1-score': 0.3172795837248444, 'support': 12838391}}
[[1017686  186625 3719262]
 [ 579496  101910 2235031]
 [1027653  180281 3790447]]
Evaluating performance on  train set...
9913/9913 - 270s - 270s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1055709
{'0': {'precision': 0.34454093963296417, 'recall': 0.1653821905552182, 'f1-score': 0.2234883336687415, 'support': 862868}, '1': {'precision': 0.36621726986508224, 'recall': 0.0902783860325246, 'f1-score': 0.14484915084525105, 'support': 822024}, '2': {'precision': 0.3380930607517519, 'recall': 0.7618563125116617, 'f1-score': 0.46834579629043815, 'support': 852141}, 'accuracy': 0.34139209068230486, 'macro avg': {'precision': 0.3496170900832661, 'recall': 0.3391722963664681, 'f1-score': 0.2788944269348102, 'support': 2537033}, 'weighted avg': {'precision': 0.3493985673126244, 'recall': 0.34139209068230486, 'f1-score': 0.28025140590099795, 'support': 2537033}}
[[142703  64651 655514]
 [132328  74211 615485]
 [139152  63780 649209]]
Evaluating performance on  val set...
3496/3496 - 93s - 93s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041393
{'0': {'precision': 0.3397543041264959, 'recall': 0.17295597484276728, 'f1-score': 0.22922316671847698, 'support': 309096}, '1': {'precision': 0.364613880742913, 'recall': 0.0793768437119333, 'f1-score': 0.13037163811234112, 'support': 272548}, '2': {'precision': 0.35245507249799274, 'recall': 0.763979844837239, 'f1-score': 0.48237217847291874, 'support': 312575}, 'accuracy': 0.3510269855594659, 'macro avg': {'precision': 0.3522744191224672, 'recall': 0.33877088779731324, 'f1-score': 0.2806556611012456, 'support': 894219}, 'weighted avg': {'precision': 0.35177079064866984, 'recall': 0.3510269855594659, 'f1-score': 0.28758276982532166, 'support': 894219}}
[[ 53460  18903 236733]
 [ 48912  21634 202002]
 [ 54977  18797 238801]]
testing model out of sample: results/universal/W5/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 567s - 567s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017897
{'0': {'precision': 0.37238650974186527, 'recall': 0.16981251208944736, 'f1-score': 0.23325711091806936, 'support': 1995542}, '1': {'precision': 0.2539611924291474, 'recall': 0.04874352167674787, 'f1-score': 0.08178903275283878, 'support': 1311682}, '2': {'precision': 0.383929302841896, 'recall': 0.7873894260440238, 'f1-score': 0.5161735502918016, 'support': 2041620}, 'accuracy': 0.37584831414040115, 'macro avg': {'precision': 0.33675900167096956, 'recall': 0.33531515327007305, 'f1-score': 0.2770732313209032, 'support': 5348844}, 'weighted avg': {'precision': 0.3477512128787495, 'recall': 0.37584831414040115, 'f1-score': 0.30410043879419985, 'support': 5348844}}
[[ 338868   92660 1564014]
 [ 232211   63936 1015535]
 [ 338911   95159 1607550]]
Evaluating performance on  train set...
4957/4957 - 136s - 136s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1055977
{'0': {'precision': 0.33971329479768786, 'recall': 0.17142983821473826, 'f1-score': 0.2278696177461805, 'support': 428531}, '1': {'precision': 0.3736249903168332, 'recall': 0.0924362097919856, 'f1-score': 0.14820576345077255, 'support': 417423}, '2': {'precision': 0.33624641924407317, 'recall': 0.7553161769928265, 'f1-score': 0.46533723450494896, 'support': 422390}, 'accuracy': 0.3398809786619403, 'macro avg': {'precision': 0.34986156811953145, 'recall': 0.33972740833318343, 'f1-score': 0.28047087190063397, 'support': 1268344}, 'weighted avg': {'precision': 0.349719372102896, 'recall': 0.3398809786619403, 'f1-score': 0.2807341573278588, 'support': 1268344}}
[[ 73463  32410 322658]
 [ 71712  38585 307126]
 [ 71075  32277 319038]]
Evaluating performance on  val set...
1701/1701 - 46s - 46s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037668
{'0': {'precision': 0.3568754108668934, 'recall': 0.16317622535726653, 'f1-score': 0.22395307854769492, 'support': 153037}, '1': {'precision': 0.3794625662904038, 'recall': 0.09763534631275632, 'f1-score': 0.15530966744475094, 'support': 131182}, '2': {'precision': 0.3514795756688648, 'recall': 0.7720164663612921, 'f1-score': 0.4830422357620728, 'support': 150853}, 'accuracy': 0.3545183325978229, 'macro avg': {'precision': 0.362605850942054, 'recall': 0.34427601267710495, 'f1-score': 0.2874349939181729, 'support': 435072}, 'weighted avg': {'precision': 0.36181493879707216, 'recall': 0.3545183325978229, 'f1-score': 0.2930901332833574, 'support': 435072}}
[[ 24972  10558 117507]
 [ 20997  12808  97377]
 [ 24005  10387 116461]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098941
{'0': {'precision': 0.2849321685922467, 'recall': 0.08855580717404632, 'f1-score': 0.13511759315821625, 'support': 79927}, '1': {'precision': 0.3942920330682955, 'recall': 0.07818079308400677, 'f1-score': 0.13048819803256978, 'support': 95778}, '2': {'precision': 0.3520361513574342, 'recall': 0.8375673273022015, 'f1-score': 0.4957180837070532, 'support': 95615}, 'accuracy': 0.3488500663423264, 'macro avg': {'precision': 0.34375345100599214, 'recall': 0.33476797585341816, 'f1-score': 0.25377462496594644, 'support': 271320}, 'weighted avg': {'precision': 0.34718491963116904, 'recall': 0.3488500663423264, 'f1-score': 0.2605614295782475, 'support': 271320}}
[[ 7078  5132 67717]
 [ 8603  7488 79687]
 [ 9160  6371 80084]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1086085
{'0': {'precision': 0.3313379891364594, 'recall': 0.12329332178360763, 'f1-score': 0.17971380471380471, 'support': 24243}, '1': {'precision': 0.33363903154805574, 'recall': 0.07942537769627107, 'f1-score': 0.12830641179375044, 'support': 22902}, '2': {'precision': 0.32754185085875787, 'recall': 0.8026549458355532, 'f1-score': 0.46523417395779715, 'support': 22524}, 'accuracy': 0.32851052835550965, 'macro avg': {'precision': 0.33083962384775767, 'recall': 0.3351245484384773, 'f1-score': 0.2577514634884508, 'support': 69669}, 'weighted avg': {'precision': 0.33086710904263616, 'recall': 0.32851052835550965, 'f1-score': 0.25512365248249097, 'support': 69669}}
[[ 2989  2024 19230]
 [ 3196  1819 17887]
 [ 2836  1609 18079]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1097357
{'0': {'precision': 0.37074148296593185, 'recall': 0.08390022675736962, 'f1-score': 0.13683431952662722, 'support': 8820}, '1': {'precision': 0.2838983050847458, 'recall': 0.06178369121327888, 'f1-score': 0.10148220274802554, 'support': 7591}, '2': {'precision': 0.3319426461420419, 'recall': 0.8556242274412855, 'f1-score': 0.4783194554814636, 'support': 8090}, 'accuracy': 0.3318640055507939, 'macro avg': {'precision': 0.3288608113975731, 'recall': 0.33376938180397797, 'f1-score': 0.2388786592520388, 'support': 24501}, 'weighted avg': {'precision': 0.3310243631258701, 'recall': 0.3318640055507939, 'f1-score': 0.23863656561487917, 'support': 24501}}
[[ 740  619 7461]
 [ 652  469 6470]
 [ 604  564 6922]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051855
{'0': {'precision': 0.3550729685486399, 'recall': 0.10940124162280207, 'f1-score': 0.16726622393771712, 'support': 186369}, '1': {'precision': 0.3089122973132915, 'recall': 0.05639067285307637, 'f1-score': 0.0953716433794814, 'support': 185137}, '2': {'precision': 0.33211535338512954, 'recall': 0.8280554075652637, 'f1-score': 0.4740852356608631, 'support': 187700}, 'accuracy': 0.33307046061737533, 'macro avg': {'precision': 0.33203353974902033, 'recall': 0.3312824406803807, 'f1-score': 0.2455743676593539, 'support': 559206}, 'weighted avg': {'precision': 0.33208467343612397, 'recall': 0.33307046061737533, 'f1-score': 0.24644917537175828, 'support': 559206}}
[[ 20389  10630 155350]
 [ 17485  10440 157212]
 [ 19548  12726 155426]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032451
{'0': {'precision': 0.31293172690763055, 'recall': 0.04024128243265576, 'f1-score': 0.0713122105687039, 'support': 48408}, '1': {'precision': 0.3033184308292929, 'recall': 0.09868272796181345, 'f1-score': 0.14891643738213745, 'support': 48813}, '2': {'precision': 0.3496442042228876, 'recall': 0.8408266317561249, 'f1-score': 0.49390568784158634, 'support': 53470}, 'accuracy': 0.3432454492969056, 'macro avg': {'precision': 0.321964787319937, 'recall': 0.3265835473835314, 'f1-score': 0.2380447785974759, 'support': 150691}, 'weighted avg': {'precision': 0.32284447777247915, 'recall': 0.3432454492969056, 'f1-score': 0.24640009473713573, 'support': 150691}}
[[ 1948  5113 41347]
 [ 1717  4817 42279]
 [ 2560  5951 44959]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051
{'0': {'precision': 0.3497481813094572, 'recall': 0.0732922896511287, 'f1-score': 0.12118861796500073, 'support': 17055}, '1': {'precision': 0.3799654576856649, 'recall': 0.08890086206896551, 'f1-score': 0.1440890732452789, 'support': 22272}, '2': {'precision': 0.3029688903746109, 'recall': 0.8371918480457249, 'f1-score': 0.44492513500245456, 'support': 17321}, 'accuracy': 0.31300310690580424, 'macro avg': {'precision': 0.344227509789911, 'recall': 0.333128333255273, 'f1-score': 0.23673427540424474, 'support': 56648}, 'weighted avg': {'precision': 0.3473250610080948, 'recall': 0.31300310690580424, 'f1-score': 0.22917970594000592, 'support': 56648}}
[[ 1250  1678 14127]
 [ 1057  1980 19235]
 [ 1267  1553 14501]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
2341/2341 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007409
{'0': {'precision': 0.35967531687113447, 'recall': 0.17816010367677027, 'f1-score': 0.2382877337400241, 'support': 218371}, '1': {'precision': 0.2973225114283049, 'recall': 0.041746078527687726, 'f1-score': 0.07321261407166199, 'support': 152685}, '2': {'precision': 0.38404396203356345, 'recall': 0.790340319068296, 'f1-score': 0.5169098946131637, 'support': 228227}, 'accuracy': 0.3765433025799163, 'macro avg': {'precision': 0.3470139301110009, 'recall': 0.33674883375758463, 'f1-score': 0.27613674747494993, 'support': 599283}, 'weighted avg': {'precision': 0.3530694973842597, 'recall': 0.3765433025799163, 'f1-score': 0.302338616650152, 'support': 599283}}
[[ 38905   7049 172417]
 [ 29427   6374 116884]
 [ 39835   8015 180377]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062936
{'0': {'precision': 0.33500452042409795, 'recall': 0.1983213720958521, 'f1-score': 0.24914806155350785, 'support': 41105}, '1': {'precision': 0.3357825128581925, 'recall': 0.03347821840203165, 'f1-score': 0.06088597757299879, 'support': 40952}, '2': {'precision': 0.33344201945832236, 'recall': 0.7651019669361651, 'f1-score': 0.4644641418211119, 'support': 41435}, 'accuracy': 0.33382729245619147, 'macro avg': {'precision': 0.33474301758020425, 'recall': 0.3323005191446829, 'f1-score': 0.25816606031587286, 'support': 123492}, 'weighted avg': {'precision': 0.33473825312454925, 'recall': 0.33382729245619147, 'f1-score': 0.2589617573614822, 'support': 123492}}
[[ 8152  1440 31513]
 [ 7721  1371 31860]
 [ 8461  1272 31702]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052037
{'0': {'precision': 0.38666318674148503, 'recall': 0.186481213418088, 'f1-score': 0.25161345108695654, 'support': 15889}, '1': {'precision': 0.22380657160570366, 'recall': 0.03383634829880963, 'f1-score': 0.058785214134505784, 'support': 10669}, '2': {'precision': 0.3541361125846413, 'recall': 0.768642058923129, 'f1-score': 0.48487567290438344, 'support': 14765}, 'accuracy': 0.35508070566028604, 'macro avg': {'precision': 0.32153529031061, 'recall': 0.3296532068800089, 'f1-score': 0.2650914460419486, 'support': 41323}, 'weighted avg': {'precision': 0.33299381431427866, 'recall': 0.35508070566028604, 'f1-score': 0.28517423430909944, 'support': 41323}}
[[ 2963   640 12286]
 [ 1896   361  8412]
 [ 2804   612 11349]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074036
{'0': {'precision': 0.33093525179856115, 'recall': 0.02083346812544077, 'f1-score': 0.03919921601567968, 'support': 154559}, '1': {'precision': 0.43255004351610093, 'recall': 0.018922700577770585, 'f1-score': 0.03625917650813917, 'support': 210118}, '2': {'precision': 0.298818893700433, 'recall': 0.9688456549935149, 'f1-score': 0.45676024795346665, 'support': 154200}, 'accuracy': 0.3017902123239226, 'macro avg': {'precision': 0.354101396338365, 'recall': 0.33620060789890877, 'f1-score': 0.1774062134924285, 'support': 518877}, 'weighted avg': {'precision': 0.3625395711023165, 'recall': 0.3017902123239226, 'f1-score': 0.16209954866399778, 'support': 518877}}
[[  3220   2918 148421]
 [  4004   3976 202138]
 [  2506   2298 149396]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052705
{'0': {'precision': 0.3002309468822171, 'recall': 0.023847085152437907, 'f1-score': 0.04418462375093468, 'support': 27257}, '1': {'precision': 0.33663366336633666, 'recall': 0.020692371030680556, 'f1-score': 0.03898819561551433, 'support': 27933}, '2': {'precision': 0.34545928112519536, 'recall': 0.950030697864793, 'f1-score': 0.506676126027796, 'support': 29318}, 'accuracy': 0.3441212666256449, 'macro avg': {'precision': 0.32744129712458303, 'recall': 0.33152338468263715, 'f1-score': 0.196616315131415, 'support': 84508}, 'weighted avg': {'precision': 0.3279542557155411, 'recall': 0.3441212666256449, 'f1-score': 0.2029172175485198, 'support': 84508}}
[[  650   532 26075]
 [  657   578 26698]
 [  858   607 27853]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091328
{'0': {'precision': 0.3900862068965517, 'recall': 0.030093939645855848, 'f1-score': 0.055877132052172575, 'support': 12029}, '1': {'precision': 0.27190721649484534, 'recall': 0.01956783826393397, 'f1-score': 0.036508348473051296, 'support': 10783}, '2': {'precision': 0.34289870003939277, 'recall': 0.9514840662574624, 'f1-score': 0.5041208179266717, 'support': 11893}, 'accuracy': 0.3425731162656678, 'macro avg': {'precision': 0.3349640411435966, 'recall': 0.3337152813890841, 'f1-score': 0.19883543281729854, 'support': 34705}, 'weighted avg': {'precision': 0.3371968516868185, 'recall': 0.3425731162656678, 'f1-score': 0.2034670632658811, 'support': 34705}}
[[  362   293 11374]
 [  261   211 10311]
 [  305   272 11316]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078281
{'0': {'precision': 0.36429563702290974, 'recall': 0.11760771078476086, 'f1-score': 0.17781148902181845, 'support': 263112}, '1': {'precision': 0.27807934860700884, 'recall': 0.03094876373748412, 'f1-score': 0.05569857056058329, 'support': 225114}, '2': {'precision': 0.34184059130687805, 'recall': 0.8506091322619741, 'f1-score': 0.48768970799576755, 'support': 254132}, 'accuracy': 0.34225804800379334, 'macro avg': {'precision': 0.3280718589789322, 'recall': 0.33305520226140634, 'f1-score': 0.24039992252605644, 'support': 742358}, 'weighted avg': {'precision': 0.3304641982449028, 'recall': 0.34225804800379334, 'f1-score': 0.24686259915709705, 'support': 742358}}
[[ 30944   9627 222541]
 [ 24493   6967 193654]
 [ 29505   8460 216167]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099248
{'0': {'precision': 0.3277179525003688, 'recall': 0.18481299081591906, 'f1-score': 0.23634293981850868, 'support': 60104}, '1': {'precision': 0.31008184523809523, 'recall': 0.028075316626246294, 'f1-score': 0.05148875710402768, 'support': 59376}, '2': {'precision': 0.32772119047791165, 'recall': 0.7799800419806614, 'f1-score': 0.4615251485088036, 'support': 58122}, 'accuracy': 0.3271866307811849, 'macro avg': {'precision': 0.32184032940545854, 'recall': 0.3309561164742756, 'f1-score': 0.24978561514377998, 'support': 177602}, 'weighted avg': {'precision': 0.3218228989138438, 'recall': 0.3271866307811849, 'f1-score': 0.24823547695571602, 'support': 177602}}
[[11108  1792 47204]
 [11916  1667 45793]
 [10871  1917 45334]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108589
{'0': {'precision': 0.3319906323185012, 'recall': 0.17638861238303802, 'f1-score': 0.23037670231091753, 'support': 20092}, '1': {'precision': 0.319, 'recall': 0.030058892815076562, 'f1-score': 0.054940796555435954, 'support': 21225}, '2': {'precision': 0.32748173970783534, 'recall': 0.8072634271099745, 'f1-score': 0.4659443181482684, 'support': 19550}, 'accuracy': 0.3279938225968094, 'macro avg': {'precision': 0.32615745734211216, 'recall': 0.33790364410269635, 'f1-score': 0.2504206056715406, 'support': 60867}, 'weighted avg': {'precision': 0.3260124335983621, 'recall': 0.3279938225968094, 'f1-score': 0.24486270934198712, 'support': 60867}}
[[ 3544   788 15760]
 [ 3937   638 16650]
 [ 3194   574 15782]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
7167/7167 - 99s - 99s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981158
{'0': {'precision': 0.38805824686120505, 'recall': 0.19092843815183957, 'f1-score': 0.2559345729461174, 'support': 709051}, '1': {'precision': 0.1919123111221204, 'recall': 0.08469804967640371, 'f1-score': 0.11752703994174846, 'support': 365888}, '2': {'precision': 0.4153988239212041, 'recall': 0.7241453756555806, 'f1-score': 0.5279464149034748, 'support': 759632}, 'accuracy': 0.3905283578558693, 'macro avg': {'precision': 0.3317897939681765, 'recall': 0.3332572878279413, 'f1-score': 0.30046934259711355, 'support': 1834571}, 'weighted avg': {'precision': 0.3602595588287108, 'recall': 0.3905283578558693, 'f1-score': 0.3409611236186445, 'support': 1834571}}
[[135378  65351 508322]
 [ 69073  30990 265825]
 [144409  65139 550084]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067089
{'0': {'precision': 0.353933164990623, 'recall': 0.1717729856019723, 'f1-score': 0.2312933047690734, 'support': 139533}, '1': {'precision': 0.3682418122363227, 'recall': 0.16505665421185334, 'f1-score': 0.22794275735853212, 'support': 131676}, '2': {'precision': 0.32395011619914243, 'recall': 0.6826040309602268, 'f1-score': 0.43937955205216933, 'support': 130490}, 'accuracy': 0.33551241103413254, 'macro avg': {'precision': 0.34870836447536274, 'recall': 0.33981122359135085, 'f1-score': 0.2995385380599249, 'support': 401699}, 'weighted avg': {'precision': 0.3488836562737092, 'recall': 0.33551241103413254, 'f1-score': 0.2977908258660658, 'support': 401699}}
[[23968 18591 96974]
 [21030 21734 88912]
 [22721 18696 89073]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056178
{'0': {'precision': 0.3642218822961114, 'recall': 0.1933457272902109, 'f1-score': 0.2525998408688005, 'support': 46797}, '1': {'precision': 0.3409059899031246, 'recall': 0.13876700916412107, 'f1-score': 0.19724480934712244, 'support': 36010}, '2': {'precision': 0.349831884057971, 'recall': 0.7026290664369047, 'f1-score': 0.46709961066002026, 'support': 42943}, 'accuracy': 0.35163419483101394, 'macro avg': {'precision': 0.35165325208573567, 'recall': 0.3449139342970789, 'f1-score': 0.3056480869586477, 'support': 125750}, 'weighted avg': {'precision': 0.3526309878276269, 'recall': 0.35163419483101394, 'f1-score': 0.30999887807793547, 'support': 125750}}
[[ 9048  5049 32700]
 [ 7636  4997 23377]
 [ 8158  4612 30173]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103453
{'0': {'precision': 0.4235260134159258, 'recall': 0.09996742448920841, 'f1-score': 0.1617548633839591, 'support': 660005}, '1': {'precision': 0.19432192005415755, 'recall': 0.060048114323817244, 'f1-score': 0.09174559337989448, 'support': 305938}, '2': {'precision': 0.40721359339649704, 'recall': 0.8479249152332183, 'f1-score': 0.5501967301433561, 'support': 661226}, 'accuracy': 0.3964062737183415, 'macro avg': {'precision': 0.3416871756221935, 'recall': 0.335980151348748, 'f1-score': 0.26789906230240323, 'support': 1627169}, 'weighted avg': {'precision': 0.3738025746368688, 'recall': 0.3964062737183415, 'f1-score': 0.3064413500017263, 'support': 1627169}}
[[ 65979  37766 556260]
 [ 27652  18371 259915]
 [ 62154  38402 560670]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063228
{'0': {'precision': 0.3362359195038603, 'recall': 0.0894869808333614, 'f1-score': 0.1413536234968607, 'support': 148435}, '1': {'precision': 0.3898758131283264, 'recall': 0.11545412516286303, 'f1-score': 0.17815200531797032, 'support': 142758}, '2': {'precision': 0.3365418874668446, 'recall': 0.8251967412029815, 'f1-score': 0.47809939682201724, 'support': 144225}, 'accuracy': 0.341692350798543, 'macro avg': {'precision': 0.35421787336634375, 'recall': 0.3433792823997353, 'f1-score': 0.2658683418789494, 'support': 435418}, 'weighted avg': {'precision': 0.35392387030861094, 'recall': 0.341692350798543, 'f1-score': 0.26495995706561226, 'support': 435418}}
[[ 13283  13295 121857]
 [ 13509  16482 112767]
 [ 12713  12498 119014]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062403
{'0': {'precision': 0.4013329958660255, 'recall': 0.08907072106652686, 'f1-score': 0.14578608642353663, 'support': 53407}, '1': {'precision': 0.37419299302745973, 'recall': 0.10845537785983383, 'f1-score': 0.16816898139193004, 'support': 40081}, '2': {'precision': 0.3566494456376618, 'recall': 0.8504478851515691, 'f1-score': 0.5025473241411544, 'support': 50571}, 'accuracy': 0.3617406756953748, 'macro avg': {'precision': 0.3773918115103823, 'recall': 0.34932466135930995, 'f1-score': 0.27216746398554037, 'support': 144059}, 'weighted avg': {'precision': 0.3780960563317296, 'recall': 0.3617406756953748, 'f1-score': 0.27725237013955456, 'support': 144059}}
[[ 4757  3797 44853]
 [ 3006  4347 32728]
 [ 4090  3473 43008]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
7459/7459 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980301
{'0': {'precision': 0.42875032913115796, 'recall': 0.17090371978363766, 'f1-score': 0.2443909992422495, 'support': 781282}, '1': {'precision': 0.18637791620334884, 'recall': 0.05200673581216844, 'f1-score': 0.08132156971732464, 'support': 331957}, '2': {'precision': 0.41848370577652344, 'recall': 0.7913197288483088, 'f1-score': 0.5474515993339151, 'support': 796012}, 'accuracy': 0.4088975205460152, 'macro avg': {'precision': 0.34453731703701007, 'recall': 0.3380767281480383, 'f1-score': 0.2910547227644964, 'support': 1909251}, 'weighted avg': {'precision': 0.3823292066763073, 'recall': 0.4088975205460152, 'f1-score': 0.3423916475505973, 'support': 1909251}}
[[133524  38067 609691]
 [ 49088  17264 265605]
 [128814  37298 629900]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014906
{'0': {'precision': 0.36025109221961105, 'recall': 0.16037099967702526, 'f1-score': 0.22194151455820121, 'support': 142426}, '1': {'precision': 0.39929518229544336, 'recall': 0.19409529583442015, 'f1-score': 0.26121523478821856, 'support': 141853}, '2': {'precision': 0.3409705523729079, 'recall': 0.7065794302814714, 'f1-score': 0.4599738105630729, 'support': 141684}, 'accuracy': 0.3532818578139416, 'macro avg': {'precision': 0.36683894229598746, 'recall': 0.353681908597639, 'f1-score': 0.3143768533031642, 'support': 425963}, 'weighted avg': {'precision': 0.3668403436378956, 'recall': 0.3532818578139416, 'f1-score': 0.31419474515086515, 'support': 425963}}
[[ 22841  20982  98603]
 [ 19428  27533  94892]
 [ 21134  20439 100111]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007686
{'0': {'precision': 0.36409681757059614, 'recall': 0.17762568061052678, 'f1-score': 0.23876780176658194, 'support': 45731}, '1': {'precision': 0.40330857936364184, 'recall': 0.16509317384212346, 'f1-score': 0.23428320911880754, 'support': 40462}, '2': {'precision': 0.3605457487969304, 'recall': 0.7315747123937107, 'f1-score': 0.4830349065950634, 'support': 45983}, 'accuracy': 0.3665037525723278, 'macro avg': {'precision': 0.3759837152437228, 'recall': 0.35809785561545365, 'f1-score': 0.3186953058268176, 'support': 132176}, 'weighted avg': {'precision': 0.3748650168673727, 'recall': 0.3665037525723278, 'f1-score': 0.3223735902123952, 'support': 132176}}
[[ 8123  4849 32759]
 [ 6878  6680 26904]
 [ 7309  5034 33640]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
8238/8238 - 113s - 113s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990354
{'0': {'precision': 0.36604008669409743, 'recall': 0.2535087911931763, 'f1-score': 0.2995546702384632, 'support': 774127}, '1': {'precision': 0.27198537572631715, 'recall': 0.04697021799547886, 'f1-score': 0.08010652668214573, 'support': 532167}, '2': {'precision': 0.38531439060860123, 'recall': 0.7110054584880736, 'f1-score': 0.49978231294900693, 'support': 802420}, 'accuracy': 0.3754748154562449, 'macro avg': {'precision': 0.3411132843430053, 'recall': 0.33716148922557626, 'f1-score': 0.29314783662320526, 'support': 2108714}, 'weighted avg': {'precision': 0.34963827666935504, 'recall': 0.3754748154562449, 'f1-score': 0.32036527084710886, 'support': 2108714}}
[[196248  33017 544862]
 [141884  24996 365287]
 [198006  33889 570525]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102804
{'0': {'precision': 0.34549158239931305, 'recall': 0.2445746359380254, 'f1-score': 0.2864033742621641, 'support': 154644}, '1': {'precision': 0.3783960434867862, 'recall': 0.11468947073001617, 'f1-score': 0.17602643234313398, 'support': 151435}, '2': {'precision': 0.3418450997584675, 'recall': 0.6719138412649599, 'f1-score': 0.4531460977585742, 'support': 156084}, 'accuracy': 0.34633884581846663, 'macro avg': {'precision': 0.35524424188152226, 'recall': 0.3437259826443338, 'f1-score': 0.30519196812129074, 'support': 462163}, 'weighted avg': {'precision': 0.35504173995902194, 'recall': 0.34633884581846663, 'f1-score': 0.3065498140565773, 'support': 462163}}
[[ 37822  13810 103012]
 [ 35163  17368  98904]
 [ 36488  14721 104875]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986751
{'0': {'precision': 0.34186510576027673, 'recall': 0.23434678728410147, 'f1-score': 0.27807475057891656, 'support': 54829}, '1': {'precision': 0.41825661817314574, 'recall': 0.13590747055176688, 'f1-score': 0.2051529508100836, 'support': 51616}, '2': {'precision': 0.35947801573227844, 'recall': 0.6830001555021856, 'f1-score': 0.47103823834320374, 'support': 57877}, 'accuracy': 0.36144886259904335, 'macro avg': {'precision': 0.3731999132219003, 'recall': 0.351084804446018, 'f1-score': 0.3180886465774013, 'support': 164322}, 'weighted avg': {'precision': 0.3720643894541959, 'recall': 0.36144886259904335, 'f1-score': 0.32313394024594577, 'support': 164322}}
[[12849  4747 37233]
 [11399  7015 33202]
 [13337  5010 39530]]
testing model on single stock: results/universal/W5/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
31315/31315 - 424s - 424s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002988
{'0': {'precision': 0.38186325650996383, 'recall': 0.23436283272839223, 'f1-score': 0.29046012842843894, 'support': 3092312}, '1': {'precision': 0.227330306272956, 'recall': 0.021554984075900396, 'f1-score': 0.039376381985570745, 'support': 1823337}, '2': {'precision': 0.387609046542727, 'recall': 0.743226103145699, 'f1-score': 0.5095016038108554, 'support': 3100837}, 'accuracy': 0.38279216105410774, 'macro avg': {'precision': 0.3322675364418823, 'recall': 0.33304797331666386, 'f1-score': 0.27977937140828835, 'support': 8016486}, 'weighted avg': {'precision': 0.3489374973233985, 'recall': 0.38279216105410774, 'f1-score': 0.3180784173411229, 'support': 8016486}}
[[ 724723   70520 2297069]
 [ 439986   39302 1344049]
 [ 733151   63063 2304623]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066351
{'0': {'precision': 0.33975456724988523, 'recall': 0.18455835200418017, 'f1-score': 0.2391874802808267, 'support': 505244}, '1': {'precision': 0.34278531748822166, 'recall': 0.04133342095054786, 'f1-score': 0.07377140662803873, 'support': 471749}, '2': {'precision': 0.3388217361401568, 'recall': 0.7788281484133481, 'f1-score': 0.47221211051375805, 'support': 497179}, 'accuracy': 0.3391483490393251, 'macro avg': {'precision': 0.34045387362608787, 'recall': 0.3349066404560254, 'f1-score': 0.2617236658075412, 'support': 1474172}, 'weighted avg': {'precision': 0.34040982956383586, 'recall': 0.3391483490393251, 'f1-score': 0.26484261774439916, 'support': 1474172}}
[[ 93247  19307 392690]
 [ 89323  19499 362927]
 [ 91884  18078 387217]]
Evaluating performance on  val set...
2129/2129 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104237
{'0': {'precision': 0.3292023156438608, 'recall': 0.18532248085169933, 'f1-score': 0.237145382507414, 'support': 187484}, '1': {'precision': 0.34959851760345895, 'recall': 0.048607234650750515, 'f1-score': 0.08534792419501636, 'support': 163021}, '2': {'precision': 0.35766957581749376, 'recall': 0.7665903772468948, 'f1-score': 0.48776273549248483, 'support': 194435}, 'accuracy': 0.3518203838954747, 'macro avg': {'precision': 0.34549013635493786, 'recall': 0.3335066975831149, 'f1-score': 0.2700853473983051, 'support': 544940}, 'weighted avg': {'precision': 0.3454610615085724, 'recall': 0.3518203838954747, 'f1-score': 0.2811550194878281, 'support': 544940}}
[[ 34745   7233 145506]
 [ 32924   7924 122173]
 [ 37874   7509 149052]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        81 (peak)  20.03 (ave)

============================================
