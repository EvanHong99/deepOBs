This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W6/deepLOB_L1/h300
Epoch 1/50
9426/9426 - 167s - loss: 3.2139 - accuracy300: 0.4141 - val_loss: 3.4246 - val_accuracy300: 0.3469 - 167s/epoch - 18ms/step
Epoch 2/50
9426/9426 - 148s - loss: 3.1914 - accuracy300: 0.4269 - val_loss: 3.5553 - val_accuracy300: 0.3470 - 148s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 149s - loss: 3.1801 - accuracy300: 0.4326 - val_loss: 3.5629 - val_accuracy300: 0.3515 - 149s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 144s - loss: 3.1731 - accuracy300: 0.4362 - val_loss: 3.6144 - val_accuracy300: 0.3457 - 144s/epoch - 15ms/step
Epoch 5/50
9426/9426 - 145s - loss: 3.1683 - accuracy300: 0.4380 - val_loss: 3.5821 - val_accuracy300: 0.3416 - 145s/epoch - 15ms/step
Epoch 6/50
9426/9426 - 145s - loss: 3.1635 - accuracy300: 0.4401 - val_loss: 3.6785 - val_accuracy300: 0.3288 - 145s/epoch - 15ms/step
Epoch 7/50
9426/9426 - 145s - loss: 3.1617 - accuracy300: 0.4410 - val_loss: 3.7285 - val_accuracy300: 0.3472 - 145s/epoch - 15ms/step
Epoch 8/50
9426/9426 - 145s - loss: 3.1569 - accuracy300: 0.4432 - val_loss: 3.6831 - val_accuracy300: 0.3304 - 145s/epoch - 15ms/step
Epoch 9/50
9426/9426 - 144s - loss: 3.1529 - accuracy300: 0.4447 - val_loss: 3.5367 - val_accuracy300: 0.3223 - 144s/epoch - 15ms/step
Epoch 10/50
9426/9426 - 147s - loss: 3.1493 - accuracy300: 0.4459 - val_loss: 3.7106 - val_accuracy300: 0.3211 - 147s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 146s - loss: 3.1470 - accuracy300: 0.4466 - val_loss: 3.6529 - val_accuracy300: 0.3209 - 146s/epoch - 15ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 223s - 223s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1263714
{'0': {'precision': 0.3021995467857569, 'recall': 0.17529413139303776, 'f1-score': 0.22188275774969823, 'support': 3252288}, '1': {'precision': 0.3952336204581594, 'recall': 0.822020084266075, 'f1-score': 0.5338081498259314, 'support': 4266723}, '2': {'precision': 0.37443780048594716, 'recall': 0.006585307753806653, 'f1-score': 0.012942984808715861, 'support': 3299618}, 'accuracy': 0.37889902685451177, 'macro avg': {'precision': 0.35729032257662113, 'recall': 0.3346331744709731, 'f1-score': 0.2562112974614485, 'support': 10818629}, 'weighted avg': {'precision': 0.3609231858087282, 'recall': 0.3788990268545118, 'f1-score': 0.2811765748261229, 'support': 10818629}}
[[ 570107 2664914   17267]
 [ 740356 3507332   19035]
 [ 576062 2701827   21729]]
Evaluating performance on  train set...
9426/9426 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1564136
{'0': {'precision': 0.3418234282226292, 'recall': 0.15851853304185007, 'f1-score': 0.21659326059420825, 'support': 816056}, '1': {'precision': 0.3317721602328257, 'recall': 0.7561433403697958, 'f1-score': 0.46118896061539844, 'support': 786380}, '2': {'precision': 0.35037016181122577, 'recall': 0.10449971164402425, 'f1-score': 0.1609848574926352, 'support': 809763}, 'accuracy': 0.33521114966053794, 'macro avg': {'precision': 0.3413219167555602, 'recall': 0.33972052835189004, 'f1-score': 0.2795890262340806, 'support': 2412199}, 'weighted avg': {'precision': 0.3414157970566603, 'recall': 0.33521114966053794, 'f1-score': 0.2776643162002857, 'support': 2412199}}
[[129360 600722  85974]
 [120842 594616  70922]
 [128239 596904  84620]]
Evaluating performance on  val set...
3323/3323 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.143746
{'0': {'precision': 0.32068039251004377, 'recall': 0.1488179389798477, 'f1-score': 0.20329356627594664, 'support': 275155}, '1': {'precision': 0.35452624244881226, 'recall': 0.7660652368691898, 'f1-score': 0.48472656612235604, 'support': 300229}, '2': {'precision': 0.3185823936321425, 'recall': 0.08560401866745236, 'f1-score': 0.13494730323290938, 'support': 274917}, 'accuracy': 0.3463208910726907, 'macro avg': {'precision': 0.33126300953033283, 'recall': 0.33349573150549666, 'f1-score': 0.2743224785437373, 'support': 850301}, 'weighted avg': {'precision': 0.3319525539255314, 'recall': 0.3463208910726907, 'f1-score': 0.28056596571318704, 'support': 850301}}
[[ 40948 208394  25813]
 [ 45710 229995  24524]
 [ 41033 210350  23534]]
testing model out of sample: results/universal/W6/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 89s - 89s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1330416
{'0': {'precision': 0.30688701540796226, 'recall': 0.15605205022838337, 'f1-score': 0.20689698276836063, 'support': 1378822}, '1': {'precision': 0.37418666001088496, 'recall': 0.8347075139653672, 'f1-score': 0.5167307833230165, 'support': 1681123}, '2': {'precision': 0.34713328808758004, 'recall': 0.008254291684383503, 'f1-score': 0.01612515223561035, 'support': 1425198}, 'accuracy': 0.3634617669938283, 'macro avg': {'precision': 0.34273565450214244, 'recall': 0.3330046186260447, 'f1-score': 0.24658430610899584, 'support': 4485143}, 'weighted avg': {'precision': 0.34490093999503674, 'recall': 0.3634617669938283, 'f1-score': 0.26240939273126035, 'support': 4485143}}
[[ 215168 1151898   11756]
 [ 267508 1403246   10369]
 [ 218455 1194979   11764]]
Evaluating performance on  train set...
5153/5153 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1567761
{'0': {'precision': 0.3378002811142346, 'recall': 0.14269071870495023, 'f1-score': 0.20063212384441342, 'support': 444647}, '1': {'precision': 0.3319022707924147, 'recall': 0.7676681710528117, 'f1-score': 0.4634369922856692, 'support': 438274}, '2': {'precision': 0.33521504458033, 'recall': 0.09008845657732262, 'f1-score': 0.14201155600901616, 'support': 435694}, 'accuracy': 0.3330365572968607, 'macro avg': {'precision': 0.3349725321623264, 'recall': 0.3334824487783615, 'f1-score': 0.26869355737969963, 'support': 1318615}, 'weighted avg': {'precision': 0.3349857244603301, 'recall': 0.3330365572968607, 'f1-score': 0.2686124753713924, 'support': 1318615}}
[[ 63447 341904  39296]
 [ 63280 336449  38545]
 [ 61097 335346  39251]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1336167
{'0': {'precision': 0.32150247940338134, 'recall': 0.16983155723616364, 'f1-score': 0.22225721265233958, 'support': 145450}, '1': {'precision': 0.37487571272083814, 'recall': 0.7866779834845189, 'f1-score': 0.5077793143855017, 'support': 169659}, '2': {'precision': 0.3670905528449038, 'recall': 0.06645430961935694, 'f1-score': 0.11253621652180057, 'support': 143783}, 'accuracy': 0.365497764179807, 'macro avg': {'precision': 0.3544895816563744, 'recall': 0.34098795011334654, 'f1-score': 0.2808575811865473, 'support': 458892}, 'weighted avg': {'precision': 0.35551928369512936, 'recall': 0.365497764179807, 'f1-score': 0.29344036744978486, 'support': 458892}}
[[ 24702 112460   8288]
 [ 28006 133467   8186]
 [ 24125 110103   9555]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1565987
{'0': {'precision': 0.30849489065036767, 'recall': 0.15453338595672922, 'f1-score': 0.20591727292285872, 'support': 83613}, '1': {'precision': 0.33809559264725847, 'recall': 0.8420690934080918, 'f1-score': 0.4824747809347616, 'support': 91673}, '2': {'precision': 0.3430232558139535, 'recall': 0.003079942786147566, 'f1-score': 0.006105069277014932, 'support': 95781}, 'accuracy': 0.33353746490720004, 'macro avg': {'precision': 0.3298712463705265, 'recall': 0.3332274740503228, 'f1-score': 0.2314990410448784, 'support': 271067}, 'weighted avg': {'precision': 0.3307061760443639, 'recall': 0.33353746490720004, 'f1-score': 0.22884386950072547, 'support': 271067}}
[[12921 70440   252]
 [14165 77195   313]
 [14798 80688   295]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1596328
{'0': {'precision': 0.324738770525173, 'recall': 0.13309232480533928, 'f1-score': 0.18880429208252794, 'support': 17980}, '1': {'precision': 0.34623585369854026, 'recall': 0.8108538191395961, 'f1-score': 0.48526345171830615, 'support': 18224}, '2': {'precision': 0.38736895934543597, 'recall': 0.08532807659814137, 'f1-score': 0.13985045693713655, 'support': 17755}, 'accuracy': 0.346281435905039, 'macro avg': {'precision': 0.35278119452304973, 'recall': 0.34309140684769224, 'f1-score': 0.27130606691265685, 'support': 53959}, 'weighted avg': {'precision': 0.3526073716159125, 'recall': 0.346281435905039, 'f1-score': 0.2728217197997947, 'support': 53959}}
[[ 2393 14089  1498]
 [ 2549 14777   898]
 [ 2427 13813  1515]]
Evaluating performance on  val set...
81/81 - 1s - 610ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1362995
{'0': {'precision': 0.33142448103078026, 'recall': 0.13973140184095367, 'f1-score': 0.19658210381063582, 'support': 6627}, '1': {'precision': 0.3491851765934002, 'recall': 0.8349743447510748, 'f1-score': 0.4924347754968513, 'support': 7211}, '2': {'precision': 0.3383333333333333, 'recall': 0.029857331960582437, 'f1-score': 0.054872280037842946, 'support': 6799}, 'accuracy': 0.34646508697969663, 'macro avg': {'precision': 0.3396476636525046, 'recall': 0.334854359517537, 'f1-score': 0.24796305311511002, 'support': 20637}, 'weighted avg': {'precision': 0.33990660839944387, 'recall': 0.34646508697969663, 'f1-score': 0.2532719581352993, 'support': 20637}}
[[ 926 5448  253]
 [1046 6021  144]
 [ 822 5774  203]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1602775
{'0': {'precision': 0.36363636363636365, 'recall': 0.27763100304271937, 'f1-score': 0.3148662589895788, 'support': 189633}, '1': {'precision': 0.3096412170368478, 'recall': 0.6964685605749728, 'f1-score': 0.42869153550268096, 'support': 170582}, '2': {'precision': 0.439769433679617, 'recall': 0.06787293928427825, 'f1-score': 0.11759634601401159, 'support': 198960}, 'accuracy': 0.3307676487682747, 'macro avg': {'precision': 0.3710156714509428, 'recall': 0.34732416763399016, 'f1-score': 0.28705138016875714, 'support': 559175}, 'weighted avg': {'precision': 0.37425349694627036, 'recall': 0.3307676487682747, 'f1-score': 0.2793992252926845, 'support': 559175}}
[[ 52648 128730   8255]
 [ 42829 118805   8948]
 [ 49305 136151  13504]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1612395
{'0': {'precision': 0.33502962704775185, 'recall': 0.10233152347492813, 'f1-score': 0.15677703474147775, 'support': 46965}, '1': {'precision': 0.3311280185246444, 'recall': 0.7547847685790956, 'f1-score': 0.4603139180242506, 'support': 45091}, '2': {'precision': 0.33415156421371495, 'recall': 0.14469220679361347, 'f1-score': 0.20194113469581, 'support': 44218}, 'accuracy': 0.33196354403627987, 'macro avg': {'precision': 0.3334364032620371, 'recall': 0.33393616628254574, 'f1-score': 0.2730106958205128, 'support': 136274}, 'weighted avg': {'precision': 0.3334537313353571, 'recall': 0.33196354403627987, 'f1-score': 0.2718675712773112, 'support': 136274}}
[[ 4806 35770  6389]
 [ 4697 34034  6360]
 [ 4842 32978  6398]]
Evaluating performance on  val set...
189/189 - 6s - 6s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1782343
{'0': {'precision': 0.41661966535062983, 'recall': 0.1262102745187379, 'f1-score': 0.1937316955894567, 'support': 17558}, '1': {'precision': 0.2933280694828267, 'recall': 0.6608220570484722, 'f1-score': 0.406304318106361, 'support': 15741}, '2': {'precision': 0.2258455733728608, 'recall': 0.11246057840703214, 'f1-score': 0.15015230245475722, 'support': 14903}, 'accuracy': 0.29654371187917516, 'macro avg': {'precision': 0.3119311027354391, 'recall': 0.29983096999141406, 'f1-score': 0.2500627720501916, 'support': 48202}, 'weighted avg': {'precision': 0.31737400535104926, 'recall': 0.29654371187917516, 'f1-score': 0.24967630276658967, 'support': 48202}}
[[ 2216 13551  1791]
 [ 1385 10402  3954]
 [ 1718 11509  1676]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1598698
{'0': {'precision': 0.3663293738084763, 'recall': 0.15836903263202703, 'f1-score': 0.22113742996977476, 'support': 110413}, '1': {'precision': 0.2922804949911609, 'recall': 0.7534313459556231, 'f1-score': 0.42117393743650394, 'support': 92165}, '2': {'precision': 0.3502600063031831, 'recall': 0.08223346497840342, 'f1-score': 0.13319550871515992, 'support': 108119}, 'accuracy': 0.30839370833963636, 'macro avg': {'precision': 0.3362899583676067, 'recall': 0.33134461452201786, 'f1-score': 0.25850229204047953, 'support': 310697}, 'weighted avg': {'precision': 0.3387715960973858, 'recall': 0.30839370833963636, 'f1-score': 0.24987337568712445, 'support': 310697}}
[[17486 83929  8998]
 [15230 69440  7495]
 [15017 84211  8891]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1461515
{'0': {'precision': 0.34217671682317, 'recall': 0.13746477592946096, 'f1-score': 0.19613501507733214, 'support': 44004}, '1': {'precision': 0.3496078431372549, 'recall': 0.7059211683969734, 'f1-score': 0.46762443175195245, 'support': 45464}, '2': {'precision': 0.3082115259286845, 'recall': 0.1595729297213921, 'f1-score': 0.2102772572807826, 'support': 41492}, 'accuracy': 0.3418142944410507, 'macro avg': {'precision': 0.3333320286297031, 'recall': 0.3343196246826088, 'f1-score': 0.29134556803668904, 'support': 130960}, 'weighted avg': {'precision': 0.33399532575833774, 'recall': 0.3418142944410507, 'f1-score': 0.2948658088555889, 'support': 130960}}
[[ 6049 30672  7283]
 [ 5792 32094  7578]
 [ 5837 29034  6621]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1423224
{'0': {'precision': 0.33773762976944854, 'recall': 0.18070985427788197, 'f1-score': 0.2354433948963767, 'support': 13862}, '1': {'precision': 0.35612241708087156, 'recall': 0.7582029950083194, 'f1-score': 0.4846216020759773, 'support': 15025}, '2': {'precision': 0.38412189254210105, 'recall': 0.10077138849929874, 'f1-score': 0.15965779678906727, 'support': 14260}, 'accuracy': 0.35538971423273924, 'macro avg': {'precision': 0.359327313130807, 'recall': 0.34656141259516676, 'f1-score': 0.2932409312538071, 'support': 43147}, 'weighted avg': {'precision': 0.359469639329607, 'recall': 0.35538971423273924, 'f1-score': 0.29716726756106404, 'support': 43147}}
[[ 2505 10235  1122]
 [ 2451 11392  1182]
 [ 2461 10362  1437]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1095/1095 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2147132
{'0': {'precision': 0.345543256626857, 'recall': 0.19106677270302103, 'f1-score': 0.2460700742229281, 'support': 99337}, '1': {'precision': 0.2554231116367371, 'recall': 0.8034937551574148, 'f1-score': 0.38762414984346316, 'support': 71499}, '2': {'precision': 0.3401639344262295, 'recall': 0.0007597045390057939, 'f1-score': 0.001516023270043928, 'support': 109253}, 'accuracy': 0.2731703137217099, 'macro avg': {'precision': 0.31371010089660784, 'recall': 0.3317734107998139, 'f1-score': 0.21173674911214505, 'support': 280089}, 'weighted avg': {'precision': 0.32043978117786137, 'recall': 0.2731703137217099, 'f1-score': 0.18681287784619494, 'support': 280089}}
[[18980 80251   106]
 [13995 57449    55]
 [21953 87217    83]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1542056
{'0': {'precision': 0.33347098905637, 'recall': 0.17299092199341243, 'f1-score': 0.22780569514237856, 'support': 37343}, '1': {'precision': 0.33187902825979176, 'recall': 0.7964201676228749, 'f1-score': 0.4685196130276542, 'support': 37823}, '2': {'precision': 0.35870792861983286, 'recall': 0.040306614548961874, 'f1-score': 0.07247005134055903, 'support': 39398}, 'accuracy': 0.3331849446597535, 'macro avg': {'precision': 0.34135264864533155, 'recall': 0.33657256805508307, 'f1-score': 0.25626511983686395, 'support': 114564}, 'weighted avg': {'precision': 0.3416242676754155, 'recall': 0.3331849446597535, 'f1-score': 0.2538575859778128, 'support': 114564}}
[[ 6460 29292  1591]
 [ 6452 30123  1248]
 [ 6460 31350  1588]]
Evaluating performance on  val set...
136/136 - 1s - 873ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1688044
{'0': {'precision': 0.3385493372606775, 'recall': 0.15771869639794167, 'f1-score': 0.21518839223028316, 'support': 11660}, '1': {'precision': 0.29714928732183044, 'recall': 0.7850559904865722, 'f1-score': 0.431117520611684, 'support': 10091}, '2': {'precision': 0.39574785527788137, 'recall': 0.0814774996160344, 'f1-score': 0.13513341399732534, 'support': 13022}, 'accuracy': 0.3112184741034711, 'macro avg': {'precision': 0.34381549328679645, 'recall': 0.34141739550018274, 'f1-score': 0.2604797756130975, 'support': 34773}, 'weighted avg': {'precision': 0.34795523257276223, 'recall': 0.3112184741034711, 'f1-score': 0.2478707868452758, 'support': 34773}}
[[1839 8818 1003]
 [1552 7922  617]
 [2041 9920 1061]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
1722/1722 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1718073
{'0': {'precision': 0.3309740184084819, 'recall': 0.15585822840369792, 'f1-score': 0.21192114735448256, 'support': 145812}, '1': {'precision': 0.3066429658357909, 'recall': 0.8407795238376559, 'f1-score': 0.44938831010181346, 'support': 135416}, '2': {'precision': 0.35595238095238096, 'recall': 0.0018737740566894987, 'f1-score': 0.0037279238954934513, 'support': 159571}, 'accuracy': 0.31052702025186085, 'macro avg': {'precision': 0.3311897883988846, 'recall': 0.3328371754326811, 'f1-score': 0.22167912711726315, 'support': 440799}, 'weighted avg': {'precision': 0.3325416455453606, 'recall': 0.31052702025186085, 'f1-score': 0.2095056528774493, 'support': 440799}}
[[ 22726 122821    265]
 [ 21285 113855    276]
 [ 24653 134619    299]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1622051
{'0': {'precision': 0.3397182917829756, 'recall': 0.19599422457517307, 'f1-score': 0.24857669417413045, 'support': 54022}, '1': {'precision': 0.3230041395623891, 'recall': 0.7492602245781811, 'f1-score': 0.4514076234216258, 'support': 51029}, '2': {'precision': 0.3653754752851711, 'recall': 0.058126346829987525, 'f1-score': 0.10029681333376823, 'support': 52902}, 'accuracy': 0.3285597614480257, 'macro avg': {'precision': 0.3426993022101786, 'recall': 0.33446026532778056, 'f1-score': 0.2667603769765082, 'support': 157953}, 'weighted avg': {'precision': 0.34291170911578245, 'recall': 0.3285597614480257, 'f1-score': 0.26444190238387383, 'support': 157953}}
[[10588 40680  2754]
 [10208 38234  2587]
 [10371 39456  3075]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1541915
{'0': {'precision': 0.3479069075767715, 'recall': 0.24390116763969974, 'f1-score': 0.2867649312046088, 'support': 19184}, '1': {'precision': 0.32234840252119107, 'recall': 0.6437174479166666, 'f1-score': 0.42958001448225924, 'support': 18432}, '2': {'precision': 0.36541939073584645, 'recall': 0.13247604639435198, 'f1-score': 0.19445575335874754, 'support': 19830}, 'accuracy': 0.3337221042370226, 'macro avg': {'precision': 0.34522490027793634, 'recall': 0.34003155398357277, 'f1-score': 0.30360023301520517, 'support': 57446}, 'weighted avg': {'precision': 0.3457514603021135, 'recall': 0.3337221042370226, 'f1-score': 0.30072372064669745, 'support': 57446}}
[[ 4679 12295  2210]
 [ 4215 11865  2352]
 [ 4555 12648  2627]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
4450/4450 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1688327
{'0': {'precision': 0.3374342975758385, 'recall': 0.141531529238054, 'f1-score': 0.19941962235996327, 'support': 392810}, '1': {'precision': 0.3182443364437935, 'recall': 0.8455604941535445, 'f1-score': 0.46243980315301575, 'support': 363126}, '2': {'precision': 0.32269206615030355, 'recall': 0.008045722040267756, 'f1-score': 0.015699994143693396, 'support': 383185}, 'accuracy': 0.32105720112262, 'macro avg': {'precision': 0.32612356672331183, 'recall': 0.3317125818106221, 'f1-score': 0.22585313988555747, 'support': 1139121}, 'weighted avg': {'precision': 0.32635788359099527, 'recall': 0.32105720112262, 'f1-score': 0.22146369005128544, 'support': 1139121}}
[[ 55595 333455   3760]
 [ 53370 307045   2711]
 [ 55793 324309   3083]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1544045
{'0': {'precision': 0.3382652725718419, 'recall': 0.15983717985566803, 'f1-score': 0.2170933587959422, 'support': 128731}, '1': {'precision': 0.33180496789777103, 'recall': 0.7969457236194749, 'f1-score': 0.4685366790542261, 'support': 127035}, '2': {'precision': 0.35232089868588384, 'recall': 0.051521467924031214, 'f1-score': 0.08989690721649485, 'support': 129053}, 'accuracy': 0.3338322691966873, 'macro avg': {'precision': 0.34079704638516556, 'recall': 0.33610145713305806, 'f1-score': 0.2585089816888877, 'support': 384819}, 'weighted avg': {'precision': 0.34084631953840244, 'recall': 0.3338322691966873, 'f1-score': 0.2574422462555756, 'support': 384819}}
[[ 20576 101554   6601]
 [ 20173 101240   5622]
 [ 20079 102325   6649]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1501538
{'0': {'precision': 0.31470839049349303, 'recall': 0.21381968410711136, 'f1-score': 0.25463490730185395, 'support': 39697}, '1': {'precision': 0.35805424205713393, 'recall': 0.7924622137652172, 'f1-score': 0.493247108066459, 'support': 46247}, '2': {'precision': 0.4780405405405405, 'recall': 0.012699979805685822, 'f1-score': 0.02474262857642456, 'support': 44567}, 'accuracy': 0.350185041873865, 'macro avg': {'precision': 0.3836010576970558, 'recall': 0.3396606258926714, 'f1-score': 0.2575415479815792, 'support': 130511}, 'weighted avg': {'precision': 0.3858429272636539, 'recall': 0.350185041873865, 'f1-score': 0.2606841235579893, 'support': 130511}}
[[ 8488 30907   302]
 [ 9282 36649   316]
 [ 9201 34800   566]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
6203/6203 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1519579
{'0': {'precision': 0.3205807694533789, 'recall': 0.1520712113100316, 'f1-score': 0.20628753466656913, 'support': 509919}, '1': {'precision': 0.33783953980055936, 'recall': 0.8436639272261676, 'f1-score': 0.4824751528451902, 'support': 537336}, '2': {'precision': 0.3385731559854897, 'recall': 0.002589624116059554, 'f1-score': 0.00513993472282902, 'support': 540619}, 'accuracy': 0.33521236571667523, 'macro avg': {'precision': 0.3323311550798093, 'recall': 0.3327749208840863, 'f1-score': 0.23130087407819613, 'support': 1587874}, 'weighted avg': {'precision': 0.3325469485317414, 'recall': 0.33521236571667523, 'f1-score': 0.23126516870279787, 'support': 1587874}}
[[ 77544 431077   1298]
 [ 82568 453331   1437]
 [ 81774 457445   1400]]
Evaluating performance on  train set...
1766/1766 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1519731
{'0': {'precision': 0.3394884347949482, 'recall': 0.12516922271998954, 'f1-score': 0.18290241350146452, 'support': 152905}, '1': {'precision': 0.3350895773709294, 'recall': 0.7382367784601469, 'f1-score': 0.4609510401938175, 'support': 152573}, '2': {'precision': 0.3396714917368571, 'recall': 0.13789902602499438, 'f1-score': 0.19616105323456023, 'support': 146513}, 'accuracy': 0.336241208342644, 'macro avg': {'precision': 0.33808316796757826, 'recall': 0.3337683424017103, 'f1-score': 0.28000483564328077, 'support': 451991}, 'weighted avg': {'precision': 0.33806290496797176, 'recall': 0.336241208342644, 'f1-score': 0.2810576338566208, 'support': 451991}}
[[ 19139 114449  19317]
 [ 19978 112635  19960]
 [ 17259 109050  20204]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1466923
{'0': {'precision': 0.32344592676696, 'recall': 0.09302420506959468, 'f1-score': 0.1444919955618957, 'support': 48998}, '1': {'precision': 0.35194193090321313, 'recall': 0.8940632435336557, 'f1-score': 0.5050674760175601, 'support': 52116}, '2': {'precision': 0.30138713745271123, 'recall': 0.010179309169896504, 'f1-score': 0.019693473961766645, 'support': 46958}, 'accuracy': 0.34868847587660057, 'macro avg': {'precision': 0.32559166504096143, 'recall': 0.33242225259104896, 'f1-score': 0.2230843151804075, 'support': 148072}, 'weighted avg': {'precision': 0.3264799988599045, 'recall': 0.34868847587660057, 'f1-score': 0.231824257989151, 'support': 148072}}
[[ 4558 43859   581]
 [ 4994 46595   527]
 [ 4540 41940   478]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
5183/5183 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1154612
{'0': {'precision': 0.27475868925804714, 'recall': 0.18129435047398287, 'f1-score': 0.21844914414073177, 'support': 365836}, '1': {'precision': 0.4228697873598529, 'recall': 0.8139376899506862, 'f1-score': 0.5565775825063144, 'support': 562317}, '2': {'precision': 0.3120772946859903, 'recall': 0.002430478044180021, 'f1-score': 0.004823391207390889, 'support': 398687}, 'accuracy': 0.3956648880045823, 'macro avg': {'precision': 0.3365685904346301, 'recall': 0.3325541728229497, 'f1-score': 0.25995003928481236, 'support': 1326840}, 'weighted avg': {'precision': 0.348741860698133, 'recall': 0.3956648880045823, 'f1-score': 0.2975585759612109, 'support': 1326840}}
[[ 66324 298744    768]
 [103258 457691   1368]
 [ 71808 325910    969]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1560177
{'0': {'precision': 0.3399506408036024, 'recall': 0.12090204955267089, 'f1-score': 0.17836818610357008, 'support': 129882}, '1': {'precision': 0.33377096391665256, 'recall': 0.751191459617462, 'f1-score': 0.4621835597693285, 'support': 125896}, '2': {'precision': 0.35211814247734374, 'recall': 0.14482516422032263, 'f1-score': 0.20523696414432757, 'support': 125289}, 'accuracy': 0.33700110479259554, 'macro avg': {'precision': 0.3419465823991996, 'recall': 0.3389728911301519, 'f1-score': 0.2819295700057421, 'support': 381067}, 'weighted avg': {'precision': 0.3419095024102016, 'recall': 0.33700110479259554, 'f1-score': 0.28096847060727365, 'support': 381067}}
[[15703 96545 17634]
 [15572 94572 15752]
 [14917 92227 18145]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.148067
{'0': {'precision': 0.3237646707034462, 'recall': 0.20345273047563123, 'f1-score': 0.24988100217802073, 'support': 42575}, '1': {'precision': 0.3574391203411398, 'recall': 0.7785629654705484, 'f1-score': 0.4899442791236444, 'support': 47264}, '2': {'precision': 0.2850114791734995, 'recall': 0.020250273809801225, 'f1-score': 0.03781384622079109, 'support': 42913}, 'accuracy': 0.3489890924430517, 'macro avg': {'precision': 0.32207175673936184, 'recall': 0.33408865658532694, 'f1-score': 0.2592130425074854, 'support': 132752}, 'weighted avg': {'precision': 0.32322662592484663, 'recall': 0.3489890924430517, 'f1-score': 0.26679911156970876, 'support': 132752}}
[[ 8662 32824  1089]
 [ 9375 36798  1091]
 [ 8717 33327   869]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
7324/7324 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000053
{'0': {'precision': 0.27976200396660056, 'recall': 0.15863835256537476, 'f1-score': 0.2024678253947194, 'support': 529065}, '1': {'precision': 0.43875177803054016, 'recall': 0.8364759203088293, 'f1-score': 0.5755917908513969, 'support': 824533}, '2': {'precision': 0.3025210084033613, 'recall': 0.001588922066059243, 'f1-score': 0.0031612404432608877, 'support': 521108}, 'accuracy': 0.41311010899842426, 'macro avg': {'precision': 0.3403449301335007, 'recall': 0.3322343983134211, 'f1-score': 0.26040695222979243, 'support': 1874706}, 'weighted avg': {'precision': 0.35601514161180675, 'recall': 0.41311010899842426, 'f1-score': 0.31117434617131373, 'support': 1874706}}
[[ 83930 444312    823]
 [133745 689702   1086]
 [ 82330 437950    828]]
Evaluating performance on  train set...
2046/2046 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1617074
{'0': {'precision': 0.33472620184654567, 'recall': 0.14358469522465517, 'f1-score': 0.2009636827014973, 'support': 175736}, '1': {'precision': 0.32682269900951405, 'recall': 0.8118595892013287, 'f1-score': 0.46603718158546314, 'support': 170984}, '2': {'precision': 0.33000380920133743, 'recall': 0.044042884902164584, 'f1-score': 0.077713932592109, 'support': 177032}, 'accuracy': 0.32810375903099176, 'macro avg': {'precision': 0.3305175700191324, 'recall': 0.33316238977604945, 'f1-score': 0.2482382656263565, 'support': 523752}, 'weighted avg': {'precision': 0.33054982229314345, 'recall': 0.32810375903099176, 'f1-score': 0.2458402223076674, 'support': 523752}}
[[ 25233 142262   8241]
 [ 24580 138815   7589]
 [ 25571 143664   7797]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1152072
{'0': {'precision': 0.31151399162054516, 'recall': 0.21213829056517375, 'f1-score': 0.2523966682382524, 'support': 56779}, '1': {'precision': 0.41842051788202506, 'recall': 0.7499837398373984, 'f1-score': 0.5371575509975917, 'support': 76875}, '2': {'precision': 0.3707736826073713, 'recall': 0.08704590961098398, 'f1-score': 0.14099148665083686, 'support': 55936}, 'accuracy': 0.3933171580779577, 'macro avg': {'precision': 0.36690273070331386, 'recall': 0.34972264667118536, 'f1-score': 0.31018190196222695, 'support': 189590}, 'weighted avg': {'precision': 0.3723462574646845, 'recall': 0.3933171580779577, 'f1-score': 0.3349929688071143, 'support': 189590}}
[[12045 40483  4251]
 [15208 57655  4012]
 [11413 39654  4869]]
testing model on single stock: results/universal/W6/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
29350/29350 - 149s - 149s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1159658
{'0': {'precision': 0.29411208740908884, 'recall': 0.17078821702275895, 'f1-score': 0.21609312162024502, 'support': 2204672}, '1': {'precision': 0.41268966785953315, 'recall': 0.828073963627376, 'f1-score': 0.5508503962241006, 'support': 3099199}, '2': {'precision': 0.2931829125679301, 'recall': 0.0019289143905069533, 'f1-score': 0.003832613182139051, 'support': 2209533}, 'accuracy': 0.39225363097738386, 'macro avg': {'precision': 0.33332822261218403, 'recall': 0.33359703168021393, 'f1-score': 0.25692537700882817, 'support': 7513404}, 'weighted avg': {'precision': 0.3427508237634931, 'recall': 0.39225363097738386, 'f1-score': 0.29175560598874445, 'support': 7513404}}
[[ 376532 1823842    4298]
 [ 526856 2566366    5977]
 [ 376845 1828426    4262]]
Evaluating performance on  train set...
5452/5452 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1568269
{'0': {'precision': 0.3413123288938606, 'recall': 0.1715387785727118, 'f1-score': 0.22832474828603821, 'support': 473135}, '1': {'precision': 0.3311477065773798, 'recall': 0.7421976095086952, 'f1-score': 0.457964519959406, 'support': 450535}, '2': {'precision': 0.3504141171698049, 'recall': 0.1098504678839775, 'f1-score': 0.1672653337851576, 'support': 471805}, 'accuracy': 0.33492180082050915, 'macro avg': {'precision': 0.3409580508803485, 'recall': 0.34119561865512815, 'f1-score': 0.2845182006768673, 'support': 1395475}, 'weighted avg': {'precision': 0.3411079189991482, 'recall': 0.33492180082050915, 'f1-score': 0.28182095385924644, 'support': 1395475}}
[[ 81161 337810  54164]
 [ 74236 334386  41913]
 [ 82394 337583  51828]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1355201
{'0': {'precision': 0.3143524141520892, 'recall': 0.1217670241041151, 'f1-score': 0.17553795879539508, 'support': 163665}, '1': {'precision': 0.3626712346734802, 'recall': 0.7642990612872196, 'f1-score': 0.4919194147535618, 'support': 180886}, '2': {'precision': 0.32757634871518904, 'recall': 0.12211620442349165, 'f1-score': 0.17790990793511618, 'support': 159512}, 'accuracy': 0.3524539591281249, 'macro avg': {'precision': 0.3348666658469195, 'recall': 0.3360607632716088, 'f1-score': 0.28178909382802436, 'support': 504063}, 'weighted avg': {'precision': 0.33587665699249114, 'recall': 0.3524539591281249, 'f1-score': 0.2898239317662819, 'support': 504063}}
[[ 19929 122226  21510]
 [ 24160 138251  18475]
 [ 19308 120725  19479]]
training model: results/universal/W6/deepLOB_L1/h500
Epoch 1/50
9426/9426 - 146s - loss: 3.1895 - accuracy500: 0.4323 - val_loss: 3.3189 - val_accuracy500: 0.3706 - 146s/epoch - 15ms/step
Epoch 2/50
9426/9426 - 147s - loss: 3.1621 - accuracy500: 0.4446 - val_loss: 3.3418 - val_accuracy500: 0.3775 - 147s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 148s - loss: 3.1479 - accuracy500: 0.4508 - val_loss: 3.3364 - val_accuracy500: 0.3785 - 148s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 148s - loss: 3.1378 - accuracy500: 0.4539 - val_loss: 3.3421 - val_accuracy500: 0.3774 - 148s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 148s - loss: 3.1287 - accuracy500: 0.4569 - val_loss: 3.3820 - val_accuracy500: 0.3763 - 148s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 147s - loss: 3.1193 - accuracy500: 0.4600 - val_loss: 3.4023 - val_accuracy500: 0.3710 - 147s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 148s - loss: 3.1135 - accuracy500: 0.4625 - val_loss: 3.5065 - val_accuracy500: 0.3533 - 148s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 147s - loss: 3.1071 - accuracy500: 0.4641 - val_loss: 3.4566 - val_accuracy500: 0.3661 - 147s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 145s - loss: 3.1019 - accuracy500: 0.4654 - val_loss: 3.4321 - val_accuracy500: 0.3744 - 145s/epoch - 15ms/step
Epoch 10/50
9426/9426 - 144s - loss: 3.0978 - accuracy500: 0.4668 - val_loss: 3.5765 - val_accuracy500: 0.3614 - 144s/epoch - 15ms/step
Epoch 11/50
9426/9426 - 145s - loss: 3.0941 - accuracy500: 0.4674 - val_loss: 3.4029 - val_accuracy500: 0.3779 - 145s/epoch - 15ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 272s - 272s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951365
{'0': {'precision': 0.32242407560326636, 'recall': 0.021401326795781488, 'f1-score': 0.040138413047240105, 'support': 3284002}, '1': {'precision': 0.38545619760745015, 'recall': 0.891215358893097, 'f1-score': 0.5381563985492379, 'support': 4167592}, '2': {'precision': 0.311036064751326, 'recall': 0.0891193587236248, 'f1-score': 0.13854284112829576, 'support': 3367035}, 'accuracy': 0.37754987253930233, 'macro avg': {'precision': 0.3396387793206808, 'recall': 0.3339120148041677, 'f1-score': 0.23894588424159124, 'support': 10818629}, 'weighted avg': {'precision': 0.34316129991226124, 'recall': 0.37754987253930233, 'f1-score': 0.26261271415675586, 'support': 10818629}}
[[  70282 2924577  289143]
 [  77844 3714222  375526]
 [  69854 2997113  300068]]
Evaluating performance on  train set...
9426/9426 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132938
{'0': {'precision': 0.3706229629887377, 'recall': 0.07881819572091739, 'f1-score': 0.12999180279518585, 'support': 810828}, '1': {'precision': 0.3412484937464508, 'recall': 0.7737360972582675, 'f1-score': 0.4736142183072085, 'support': 796066}, '2': {'precision': 0.344207548471676, 'recall': 0.1858401475217464, 'f1-score': 0.24136537926529825, 'support': 805305}, 'accuracy': 0.34388166150471, 'macro avg': {'precision': 0.3520263350689548, 'recall': 0.3461314801669771, 'f1-score': 0.28165713345589755, 'support': 2412199}, 'weighted avg': {'precision': 0.3521101945067457, 'recall': 0.34388166150471, 'f1-score': 0.2805746609367644, 'support': 2412199}}
[[ 63908 595195 151725]
 [ 46714 615945 133407]
 [ 61812 593835 149658]]
Evaluating performance on  val set...
3323/3323 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060851
{'0': {'precision': 0.3116469517743403, 'recall': 0.057224226314790204, 'f1-score': 0.09669367930036639, 'support': 263350}, '1': {'precision': 0.3887343811734492, 'recall': 0.7735576125747069, 'f1-score': 0.5174404391387325, 'support': 325606}, '2': {'precision': 0.31097533261043186, 'recall': 0.18325584954753296, 'f1-score': 0.23061292295246946, 'support': 261345}, 'accuracy': 0.37026652914673747, 'macro avg': {'precision': 0.33711888851940713, 'recall': 0.3380125628123434, 'f1-score': 0.2815823471305228, 'support': 850301}, 'weighted avg': {'precision': 0.34095963660775175, 'recall': 0.37026652914673747, 'f1-score': 0.2989712189200892, 'support': 850301}}
[[ 15070 197844  50436]
 [ 18051 251875  55680]
 [ 15235 198217  47893]]
testing model out of sample: results/universal/W6/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 98s - 98s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0897996
{'0': {'precision': 0.36376775479691004, 'recall': 0.01128988349718797, 'f1-score': 0.021900076960812996, 'support': 1293016}, '1': {'precision': 0.41591641677713126, 'recall': 0.8987895248272576, 'f1-score': 0.5686767006571586, 'support': 1857535}, '2': {'precision': 0.3027203148714569, 'recall': 0.09774073274828562, 'f1-score': 0.14777020421433498, 'support': 1334592}, 'accuracy': 0.40457461445487913, 'macro avg': {'precision': 0.36080149548183266, 'recall': 0.33594004702424374, 'f1-score': 0.24611566061076884, 'support': 4485143}, 'weighted avg': {'precision': 0.36720009572482243, 'recall': 0.40457461445487913, 'f1-score': 0.2858029180896965, 'support': 4485143}}
[[  14598 1152152  126266]
 [  13806 1669533  174196]
 [  11726 1192422  130444]]
Evaluating performance on  train set...
5153/5153 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1155767
{'0': {'precision': 0.3617321889018403, 'recall': 0.09099511748686075, 'f1-score': 0.14541143228343942, 'support': 450178}, '1': {'precision': 0.3302880844692308, 'recall': 0.7414593409652389, 'f1-score': 0.457001677125467, 'support': 431085}, '2': {'precision': 0.3330541925818696, 'recall': 0.18096407470412848, 'f1-score': 0.23450856758510544, 'support': 437352}, 'accuracy': 0.33348702995188134, 'macro avg': {'precision': 0.34169148865098026, 'recall': 0.3378061777187427, 'f1-score': 0.2789738923313373, 'support': 1318615}, 'weighted avg': {'precision': 0.34194061910636303, 'recall': 0.33348702995188134, 'f1-score': 0.2768286321607195, 'support': 1318615}}
[[ 40964 328290  80924]
 [ 33888 319632  77565]
 [ 38392 319815  79145]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032523
{'0': {'precision': 0.3164233576642336, 'recall': 0.09007168334660803, 'f1-score': 0.14022697253147154, 'support': 144385}, '1': {'precision': 0.3729334751564392, 'recall': 0.777133256698205, 'f1-score': 0.5040038078707465, 'support': 169635}, '2': {'precision': 0.3328615863141524, 'recall': 0.14773731293831796, 'f1-score': 0.2046449811638269, 'support': 144872}, 'accuracy': 0.3622573503133635, 'macro avg': {'precision': 0.34073947304494173, 'recall': 0.3383140843277103, 'f1-score': 0.28295858718868167, 'support': 458892}, 'weighted avg': {'precision': 0.34250255024497445, 'recall': 0.3622573503133635, 'f1-score': 0.29503823358933373, 'support': 458892}}
[[ 13005 111524  19856]
 [ 14765 131829  23041]
 [ 13330 110139  21403]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067506
{'0': {'precision': 0.32903225806451614, 'recall': 0.0005862473274018898, 'f1-score': 0.0011704092990166269, 'support': 86994}, '1': {'precision': 0.29959757001997966, 'recall': 0.9117886479686228, 'f1-score': 0.45100341946563616, 'support': 81078}, '2': {'precision': 0.38164811059144904, 'recall': 0.08952861789407253, 'f1-score': 0.1450344458775048, 'support': 102995}, 'accuracy': 0.30692780751622295, 'macro avg': {'precision': 0.33675931289198163, 'recall': 0.3339678377300324, 'f1-score': 0.19906942488071921, 'support': 271067}, 'weighted avg': {'precision': 0.34022013447048416, 'recall': 0.30692780751622295, 'f1-score': 0.1903813322283683, 'support': 271067}}
[[   51 79110  7833]
 [   45 73926  7107]
 [   59 93715  9221]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1136003
{'0': {'precision': 0.40270903881219067, 'recall': 0.08494038789077524, 'f1-score': 0.14029038112522685, 'support': 18201}, '1': {'precision': 0.34397093479968577, 'recall': 0.7790936891854323, 'f1-score': 0.4772398290219853, 'support': 17985}, '2': {'precision': 0.33248081841432225, 'recall': 0.17554717830416924, 'f1-score': 0.2297750119674485, 'support': 17773}, 'accuracy': 0.3461517077781278, 'macro avg': {'precision': 0.3597202640087329, 'recall': 0.3465270851267923, 'f1-score': 0.28243507403822027, 'support': 53959}, 'weighted avg': {'precision': 0.35999937106823293, 'recall': 0.3461517077781278, 'f1-score': 0.282072959830948, 'support': 53959}}
[[ 1546 13367  3288]
 [  997 14012  2976]
 [ 1296 13357  3120]]
Evaluating performance on  val set...
81/81 - 1s - 600ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1063302
{'0': {'precision': 0.3157894736842105, 'recall': 0.004357931435212086, 'f1-score': 0.008597220232124945, 'support': 6884}, '1': {'precision': 0.3250265407610214, 'recall': 0.8721139430284858, 'f1-score': 0.47356209549395534, 'support': 6670}, '2': {'precision': 0.35274102079395087, 'recall': 0.13172384582803898, 'f1-score': 0.19181743421052633, 'support': 7083}, 'accuracy': 0.3285361244366914, 'macro avg': {'precision': 0.33118567841306096, 'recall': 0.33606524009724564, 'f1-score': 0.22465891664553553, 'support': 20637}, 'weighted avg': {'precision': 0.33145740243260513, 'recall': 0.3285361244366914, 'f1-score': 0.22176117301622272, 'support': 20637}}
[[  30 5966  888]
 [  29 5817  824]
 [  36 6114  933]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1109575
{'0': {'precision': 0.38360275364820035, 'recall': 0.20303571609812537, 'f1-score': 0.26553001141522203, 'support': 197054}, '1': {'precision': 0.2763724049583663, 'recall': 0.7147692207750025, 'f1-score': 0.39861606738520067, 'support': 153935}, '2': {'precision': 0.42803283887107574, 'recall': 0.11670333259681247, 'f1-score': 0.18340202605794345, 'support': 208186}, 'accuracy': 0.3117682299816694, 'macro avg': {'precision': 0.36266933249254746, 'recall': 0.34483608982331343, 'f1-score': 0.2825160349527887, 'support': 559175}, 'weighted avg': {'precision': 0.37062509548508493, 'recall': 0.3117682299816694, 'f1-score': 0.27159019877364876, 'support': 559175}}
[[ 40009 139473  17572]
 [ 29013 110028  14894]
 [ 35276 148614  24296]]
Evaluating performance on  train set...
533/533 - 12s - 12s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1201105
{'0': {'precision': 0.34093701996927805, 'recall': 0.09301594618946839, 'f1-score': 0.14615675880348353, 'support': 47723}, '1': {'precision': 0.3157860594855827, 'recall': 0.671062607696726, 'f1-score': 0.4294725698069373, 'support': 43525}, '2': {'precision': 0.33444946523194957, 'recall': 0.22849020565895262, 'f1-score': 0.27149775027379364, 'support': 45026}, 'accuracy': 0.3224019255323833, 'macro avg': {'precision': 0.3303908482289368, 'recall': 0.3308562531817157, 'f1-score': 0.2823756929614048, 'support': 136274}, 'weighted avg': {'precision': 0.33076043313205455, 'recall': 0.3224019255323833, 'f1-score': 0.27805957339663784, 'support': 136274}}
[[ 4439 32901 10383]
 [ 4227 29208 10090]
 [ 4354 30384 10288]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127013
{'0': {'precision': 0.38873858640514036, 'recall': 0.1391983531121337, 'f1-score': 0.20499331252786446, 'support': 16516}, '1': {'precision': 0.3228530126815165, 'recall': 0.5558257918552036, 'f1-score': 0.40845421671723675, 'support': 17680}, '2': {'precision': 0.230126582278481, 'recall': 0.19470227045551905, 'f1-score': 0.2109375, 'support': 14006}, 'accuracy': 0.3081407410480893, 'macro avg': {'precision': 0.31390606045504593, 'recall': 0.2965754718076188, 'f1-score': 0.27479500974836707, 'support': 48202}, 'weighted avg': {'precision': 0.3184847240502244, 'recall': 0.3081407410480893, 'f1-score': 0.2813478844502501, 'support': 48202}}
[[ 2299 10878  3339]
 [ 2069  9827  5784]
 [ 1546  9733  2727]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.117757
{'0': {'precision': 0.39159270135612234, 'recall': 0.10228301057476019, 'f1-score': 0.1621998387295166, 'support': 116031}, '1': {'precision': 0.26497670166989945, 'recall': 0.7053496183930966, 'f1-score': 0.3852337333151818, 'support': 84249}, '2': {'precision': 0.37462806236080176, 'recall': 0.1904235760797703, 'f1-score': 0.25250087065124716, 'support': 110417}, 'accuracy': 0.2971351509670193, 'macro avg': {'precision': 0.34373248846227455, 'recall': 0.3326854016825424, 'f1-score': 0.26664481423198183, 'support': 310697}, 'weighted avg': {'precision': 0.3512303679524818, 'recall': 0.2971351509670193, 'f1-score': 0.25476961451315605, 'support': 310697}}
[[11868 84008 20155]
 [ 9880 59425 14944]
 [ 8559 80832 21026]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1254236
{'0': {'precision': 0.38041733547351525, 'recall': 0.10080173532101312, 'f1-score': 0.1593732663113831, 'support': 47023}, '1': {'precision': 0.3066086814201709, 'recall': 0.649762164304826, 'f1-score': 0.4166223203577357, 'support': 40364}, '2': {'precision': 0.3198628682382209, 'recall': 0.24196176531338215, 'f1-score': 0.2755115373559464, 'support': 43573}, 'accuracy': 0.31696701282834455, 'macro avg': {'precision': 0.33562962837730237, 'recall': 0.33084188831307376, 'f1-score': 0.2838357080083551, 'support': 130960}, 'weighted avg': {'precision': 0.3375206318002358, 'recall': 0.31696701282834455, 'f1-score': 0.27730312047869937, 'support': 130960}}
[[ 4740 30635 11648]
 [ 3367 26227 10770]
 [ 4353 28677 10543]]
Evaluating performance on  val set...
169/169 - 5s - 5s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1116757
{'0': {'precision': 0.35038577658503856, 'recall': 0.14512991524246213, 'f1-score': 0.20524661033601888, 'support': 14394}, '1': {'precision': 0.3230003318951211, 'recall': 0.7140655954215276, 'f1-score': 0.4447999268721862, 'support': 13629}, '2': {'precision': 0.38015591778880226, 'recall': 0.17733403861412325, 'f1-score': 0.24185039902610575, 'support': 15124}, 'accuracy': 0.33612997427399355, 'macro avg': {'precision': 0.3511806754229873, 'recall': 0.345509849759371, 'f1-score': 0.2972989787447703, 'support': 43147}, 'weighted avg': {'precision': 0.35217054470070913, 'recall': 0.33612997427399355, 'f1-score': 0.29374564505964507, 'support': 43147}}
[[ 2089 10107  2198]
 [ 1722  9732  2175]
 [ 2151 10291  2682]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1183791
{'0': {'precision': 0.2920806404938748, 'recall': 0.03037873087534487, 'f1-score': 0.055033532651169545, 'support': 99675}, '1': {'precision': 0.24821833495302884, 'recall': 0.8851729913937504, 'f1-score': 0.38771457123701825, 'support': 69252}, '2': {'precision': 0.3881029786486249, 'recall': 0.07946960292186178, 'f1-score': 0.1319255697261133, 'support': 111162}, 'accuracy': 0.26120982973269213, 'macro avg': {'precision': 0.30946731803184285, 'recall': 0.3316737750636523, 'f1-score': 0.19155789120476704, 'support': 280089}, 'weighted avg': {'precision': 0.31934512703438034, 'recall': 0.26120982973269213, 'f1-score': 0.16780590111073806, 'support': 280089}}
[[ 3028 88481  8166]
 [ 2190 61300  5762]
 [ 5149 97179  8834]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1073155
{'0': {'precision': 0.3338834791219673, 'recall': 0.05558761300250048, 'f1-score': 0.0953076415716574, 'support': 36393}, '1': {'precision': 0.332133899184032, 'recall': 0.8307435741324086, 'f1-score': 0.4745437224986013, 'support': 37777}, '2': {'precision': 0.3444634703196347, 'recall': 0.11952270139129574, 'f1-score': 0.17746737732034554, 'support': 40394}, 'accuracy': 0.33373485562654936, 'macro avg': {'precision': 0.33682694954187803, 'recall': 0.335284629508735, 'f1-score': 0.24910624713020144, 'support': 114564}, 'weighted avg': {'precision': 0.33703695039674114, 'recall': 0.33373485562654936, 'f1-score': 0.24932776826948277, 'support': 114564}}
[[ 2023 29602  4768]
 [ 1974 31383  4420]
 [ 2062 33504  4828]]
Evaluating performance on  val set...
136/136 - 1s - 926ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117977
{'0': {'precision': 0.41461877756773785, 'recall': 0.057063567773827074, 'f1-score': 0.10032017075773746, 'support': 11531}, '1': {'precision': 0.30003976430611284, 'recall': 0.8267755752564997, 'f1-score': 0.44029494456527507, 'support': 10039}, '2': {'precision': 0.39272134709397066, 'recall': 0.16428084526244036, 'f1-score': 0.23165652034604295, 'support': 13203}, 'accuracy': 0.3199896471400224, 'macro avg': {'precision': 0.3691266296559405, 'recall': 0.3493733294309223, 'f1-score': 0.25742387855635185, 'support': 34773}, 'weighted avg': {'precision': 0.37322544110903133, 'recall': 0.3199896471400224, 'f1-score': 0.24833847742866802, 'support': 34773}}
[[  658  8963  1910]
 [  295  8300  1444]
 [  634 10400  2169]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
1722/1722 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084051
{'0': {'precision': 0.30864197530864196, 'recall': 0.0006702817194066666, 'f1-score': 0.0013376584289201755, 'support': 149191}, '1': {'precision': 0.2937465058701382, 'recall': 0.909586923760578, 'f1-score': 0.44407971067808416, 'support': 129395}, '2': {'precision': 0.36881642087279853, 'recall': 0.09049829545104277, 'f1-score': 0.14533502296847775, 'support': 162213}, 'accuracy': 0.3005360719965336, 'macro avg': {'precision': 0.3237349673505262, 'recall': 0.33358516697700913, 'f1-score': 0.19691746402516072, 'support': 440799}, 'weighted avg': {'precision': 0.32641351759958026, 'recall': 0.3005360719965336, 'f1-score': 0.1842937276233508, 'support': 440799}}
[[   100 135563  13528]
 [   104 117696  11595]
 [   120 147413  14680]]
Evaluating performance on  train set...
618/618 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1149653
{'0': {'precision': 0.3297592903586961, 'recall': 0.1413254101537269, 'f1-score': 0.19785557421521766, 'support': 54187}, '1': {'precision': 0.3303802750778112, 'recall': 0.7404571228152218, 'f1-score': 0.45689929843756577, 'support': 51321}, '2': {'precision': 0.35158311345646437, 'recall': 0.1321193631423396, 'f1-score': 0.19206408603938854, 'support': 52445}, 'accuracy': 0.3329344805100251, 'macro avg': {'precision': 0.33724089296432386, 'recall': 0.33796729870376274, 'f1-score': 0.282272986230724, 'support': 157953}, 'weighted avg': {'precision': 0.3372072018205371, 'recall': 0.3329344805100251, 'f1-score': 0.2800993326334419, 'support': 157953}}
[[ 7658 39753  6776]
 [ 7317 38001  6003]
 [ 8248 37268  6929]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1191833
{'0': {'precision': 0.33522422384055195, 'recall': 0.22601819309489352, 'f1-score': 0.2699966042046121, 'support': 19348}, '1': {'precision': 0.3137020309275267, 'recall': 0.5782973092192325, 'f1-score': 0.4067559968197948, 'support': 18136}, '2': {'precision': 0.36305616338439095, 'recall': 0.19947901011922653, 'f1-score': 0.2574846427416747, 'support': 19962}, 'accuracy': 0.32801239424851164, 'macro avg': {'precision': 0.3373274727174899, 'recall': 0.3345981708111175, 'f1-score': 0.3114124145886939, 'support': 57446}, 'weighted avg': {'precision': 0.3381009199813361, 'recall': 0.32801239424851164, 'f1-score': 0.3088244524402734, 'support': 57446}}
[[ 4373 11512  3463]
 [ 4125 10488  3523]
 [ 4547 11433  3982]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
4450/4450 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0784607
{'0': {'precision': 0.1914340741646541, 'recall': 0.022590921061650632, 'f1-score': 0.04041277565165763, 'support': 277191}, '1': {'precision': 0.508349762675987, 'recall': 0.8554731100638767, 'f1-score': 0.6377361183318552, 'support': 585033}, '2': {'precision': 0.23073073483686243, 'recall': 0.10156845325157007, 'f1-score': 0.14104737354183175, 'support': 276897}, 'accuracy': 0.4695427439227264, 'macro avg': {'precision': 0.3101715238925012, 'recall': 0.3265441614590325, 'f1-score': 0.2730654225084482, 'support': 1139121}, 'weighted avg': {'precision': 0.36374874788851935, 'recall': 0.4695427439227264, 'f1-score': 0.3716500062796766, 'support': 1139121}}
[[  6262 241840  29089]
 [ 19875 500480  64678]
 [  6574 242199  28124]]
Evaluating performance on  train set...
1504/1504 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1092345
{'0': {'precision': 0.35416944926761945, 'recall': 0.06207666136030215, 'f1-score': 0.10563777729086575, 'support': 128148}, '1': {'precision': 0.34029217398074885, 'recall': 0.8220891591949339, 'f1-score': 0.4813403298970018, 'support': 127592}, '2': {'precision': 0.3476171997708668, 'recall': 0.1457402056105176, 'f1-score': 0.20537566322408787, 'support': 129079}, 'accuracy': 0.3421322751735231, 'macro avg': {'precision': 0.34735960767307833, 'recall': 0.34330200872191785, 'f1-score': 0.2641179234706518, 'support': 384819}, 'weighted avg': {'precision': 0.34737044214688545, 'recall': 0.3421322751735231, 'f1-score': 0.2636619566336126, 'support': 384819}}
[[  7955 101442  18751]
 [  6146 104892  16554]
 [  8360 101907  18812]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0815817
{'0': {'precision': 0.3111314914593603, 'recall': 0.08477805891356636, 'f1-score': 0.1332482325216025, 'support': 32013}, '1': {'precision': 0.49064062528204483, 'recall': 0.872668314765467, 'f1-score': 0.6281283941487764, 'support': 62294}, '2': {'precision': 0.27252047315741584, 'recall': 0.0827256656723014, 'f1-score': 0.12692291392973684, 'support': 36204}, 'accuracy': 0.46027537908682026, 'macro avg': {'precision': 0.35809752996627364, 'recall': 0.3467240131171116, 'f1-score': 0.29609984686670526, 'support': 130511}, 'weighted avg': {'precision': 0.386101943572567, 'recall': 0.46027537908682026, 'f1-score': 0.3677040481547926, 'support': 130511}}
[[ 2714 26787  2512]
 [ 2449 54362  5483]
 [ 3560 29649  2995]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
6203/6203 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0652584
{'0': {'precision': 0.20405405405405405, 'recall': 0.000448489096665736, 'f1-score': 0.0008950110542756042, 'support': 336686}, '1': {'precision': 0.5557820556511428, 'recall': 0.9090906000956237, 'f1-score': 0.6898295773521773, 'support': 882626}, '2': {'precision': 0.23122725307824243, 'recall': 0.08998214683011271, 'f1-score': 0.1295499113260467, 'support': 368562}, 'accuracy': 0.526302464805142, 'macro avg': {'precision': 0.33035445426114646, 'recall': 0.33317374534080074, 'f1-score': 0.2734248332441665, 'support': 1587874}, 'weighted avg': {'precision': 0.40587062622312103, 'recall': 0.526302464805142, 'f1-score': 0.4137041305859364, 'support': 1587874}}
[[   151 306101  30434]
 [   411 802387  79828]
 [   178 335220  33164]]
Evaluating performance on  train set...
1766/1766 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1177434
{'0': {'precision': 0.3713583978839977, 'recall': 0.12582497423455835, 'f1-score': 0.18796348979425956, 'support': 156217}, '1': {'precision': 0.33159420289855074, 'recall': 0.6641182501476769, 'f1-score': 0.44233204297963175, 'support': 147281}, '2': {'precision': 0.34059335549449493, 'recall': 0.23873852639518361, 'f1-score': 0.28071217322105163, 'support': 148493}, 'accuracy': 0.33832310820348194, 'macro avg': {'precision': 0.3478486520923478, 'recall': 0.3428939169258063, 'f1-score': 0.30366923533164764, 'support': 451991}, 'weighted avg': {'precision': 0.3482939920856609, 'recall': 0.33832310820348194, 'f1-score': 0.30132013877574243, 'support': 451991}}
[[ 19656 101088  35473]
 [ 16307  97812  33162]
 [ 16967  96075  35451]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942798
{'0': {'precision': 0.3034379671150972, 'recall': 0.004612273646422648, 'f1-score': 0.009086433015531982, 'support': 44013}, '1': {'precision': 0.4109533150255002, 'recall': 0.8574422107262131, 'f1-score': 0.5556133111269055, 'support': 61084}, '2': {'precision': 0.2764496566932291, 'recall': 0.12835369400814428, 'f1-score': 0.17531146707348083, 'support': 42975}, 'accuracy': 0.39234291425792855, 'macro avg': {'precision': 0.3302803129446088, 'recall': 0.33013605946026003, 'f1-score': 0.24667040373863944, 'support': 148072}, 'weighted avg': {'precision': 0.33995834146932535, 'recall': 0.39234291425792855, 'f1-score': 0.2827882041889847, 'support': 148072}}
[[  203 37795  6015]
 [  286 52376  8422]
 [  180 37279  5516]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
5183/5183 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021391
{'0': {'precision': 0.29684268578519235, 'recall': 0.020605434168843972, 'f1-score': 0.03853588688025775, 'support': 417948}, '1': {'precision': 0.33654532746313714, 'recall': 0.8976563164420412, 'f1-score': 0.48955053731811465, 'support': 446818}, '2': {'precision': 0.35188834928568063, 'recall': 0.08075762756614742, 'f1-score': 0.13136684391826361, 'support': 462074}, 'accuracy': 0.33690346989840525, 'macro avg': {'precision': 0.3284254541780034, 'recall': 0.33300645939234425, 'f1-score': 0.21981775603887865, 'support': 1326840}, 'weighted avg': {'precision': 0.3293824229543918, 'recall': 0.33690346989840525, 'f1-score': 0.22274516284549986, 'support': 1326840}}
[[  8612 376037  33299]
 [ 10299 401089  35430]
 [ 10101 414657  37316]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132593
{'0': {'precision': 0.36627293460870747, 'recall': 0.08297347316471314, 'f1-score': 0.13529740910491206, 'support': 129680}, '1': {'precision': 0.3511390006043829, 'recall': 0.7348991192454245, 'f1-score': 0.4752167305371686, 'support': 128072}, '2': {'precision': 0.3601879303749044, 'recall': 0.24432550784576085, 'f1-score': 0.2911534912037418, 'support': 123315}, 'accuracy': 0.35429202738626014, 'macro avg': {'precision': 0.3591999551959983, 'recall': 0.3540660334186328, 'f1-score': 0.30055587694860747, 'support': 381067}, 'weighted avg': {'precision': 0.35921746800337745, 'recall': 0.35429202738626014, 'f1-score': 0.29997590422122794, 'support': 381067}}
[[10760 89298 29622]
 [10055 94120 23897]
 [ 8562 84624 30129]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1082518
{'0': {'precision': 0.2583957633686386, 'recall': 0.09408804439845735, 'f1-score': 0.13794649013929114, 'support': 42524}, '1': {'precision': 0.35425360371365744, 'recall': 0.7553763440860215, 'f1-score': 0.48231357234570527, 'support': 47988}, '2': {'precision': 0.32577126413705415, 'recall': 0.11524621212121212, 'f1-score': 0.1702603920745676, 'support': 42240}, 'accuracy': 0.3398668193322888, 'macro avg': {'precision': 0.3128068770731168, 'recall': 0.32157020020189697, 'f1-score': 0.2635068181865214, 'support': 132752}, 'weighted avg': {'precision': 0.3144850666931432, 'recall': 0.3398668193322888, 'f1-score': 0.27271226962786743, 'support': 132752}}
[[ 4001 33316  5207]
 [ 6871 36249  4868]
 [ 4612 32760  4868]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
7324/7324 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990585
{'0': {'precision': 0.28366828366828367, 'recall': 0.0040654578440493016, 'f1-score': 0.008016032064128254, 'support': 604114}, '1': {'precision': 0.36270033327777723, 'recall': 0.9054260078478419, 'f1-score': 0.5179268092693121, 'support': 680187}, '2': {'precision': 0.3143069645672805, 'recall': 0.0894707870021426, 'f1-score': 0.13929094097327516, 'support': 590405}, 'accuracy': 0.35799693391923854, 'macro avg': {'precision': 0.3202251938377805, 'recall': 0.3329874175646779, 'f1-score': 0.22174459410223854, 'support': 1874706}, 'weighted avg': {'precision': 0.32199205450163293, 'recall': 0.35799693391923854, 'f1-score': 0.23436621412433786, 'support': 1874706}}
[[  2456 547408  54250]
 [  3337 615859  60991]
 [  2865 534716  52824]]
Evaluating performance on  train set...
2046/2046 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1115586
{'0': {'precision': 0.36079875920899573, 'recall': 0.042646806072758524, 'f1-score': 0.07627752559149922, 'support': 174550}, '1': {'precision': 0.33376648901117956, 'recall': 0.8289535644963074, 'f1-score': 0.4759132173571879, 'support': 174134}, '2': {'precision': 0.3236922205705387, 'recall': 0.1306006808782873, 'f1-score': 0.18611087369710586, 'support': 175068}, 'accuracy': 0.33347271227603903, 'macro avg': {'precision': 0.33941915626357133, 'recall': 0.33406701714911774, 'f1-score': 0.24610053888193098, 'support': 523752}, 'weighted avg': {'precision': 0.3394080917843674, 'recall': 0.33347271227603903, 'f1-score': 0.24585867494477856, 'support': 523752}}
[[  7444 143505  23601]
 [  5615 144349  24170]
 [  7573 144631  22864]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037552
{'0': {'precision': 0.29607971556886226, 'recall': 0.10593177785960567, 'f1-score': 0.15603658686916003, 'support': 59746}, '1': {'precision': 0.3680404716136599, 'recall': 0.7563894118318215, 'f1-score': 0.4951521121106168, 'support': 70116}, '2': {'precision': 0.3334300999460872, 'recall': 0.1346102330565229, 'f1-score': 0.19179160553905608, 'support': 59728}, 'accuracy': 0.3555250804367319, 'macro avg': {'precision': 0.33251676237620315, 'recall': 0.33231047424931665, 'f1-score': 0.280993434839611, 'support': 189590}, 'weighted avg': {'precision': 0.33445971519394757, 'recall': 0.3555250804367319, 'f1-score': 0.29271573620691804, 'support': 189590}}
[[ 6329 45778  7639]
 [ 8647 53035  8434]
 [ 6400 45288  8040]]
testing model on single stock: results/universal/W6/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
29350/29350 - 188s - 188s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943966
{'0': {'precision': 0.28917118953380894, 'recall': 0.00532298722500517, 'f1-score': 0.010453548281795996, 'support': 2292134}, '1': {'precision': 0.38761538352016484, 'recall': 0.906680185157082, 'f1-score': 0.5430648086958481, 'support': 2912554}, '2': {'precision': 0.30712285157080627, 'recall': 0.08758374784945398, 'f1-score': 0.13629855913375466, 'support': 2308716}, 'accuracy': 0.3800091143774513, 'macro avg': {'precision': 0.32796980820826, 'recall': 0.3331956400771804, 'f1-score': 0.2299389720371329, 'support': 7513404}, 'weighted avg': {'precision': 0.3328490378623622, 'recall': 0.3800091143774513, 'f1-score': 0.2555887023395413, 'support': 7513404}}
[[  12201 2078612  201321]
 [  16938 2640755  254861]
 [  13054 2093456  202206]]
Evaluating performance on  train set...
5452/5452 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1140956
{'0': {'precision': 0.38310921226201494, 'recall': 0.08299920662679895, 'f1-score': 0.13643933205484637, 'support': 468884}, '1': {'precision': 0.34153513081930964, 'recall': 0.7752036593334786, 'f1-score': 0.47416510563915076, 'support': 459100}, '2': {'precision': 0.33871627389862813, 'recall': 0.18247196202707647, 'f1-score': 0.2371742829498315, 'support': 467491}, 'accuracy': 0.34405274189792007, 'macro avg': {'precision': 0.3544535389933176, 'recall': 0.34689160932911794, 'f1-score': 0.28259290688127625, 'support': 1395475}, 'weighted avg': {'precision': 0.3545598223132275, 'recall': 0.34405274189792007, 'f1-score': 0.2812950876802797, 'support': 1395475}}
[[ 38917 342383  87584]
 [ 24247 355896  78957]
 [ 38418 343769  85304]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1093318
{'0': {'precision': 0.32525494901019797, 'recall': 0.03372603659977856, 'f1-score': 0.06111499357514822, 'support': 160766}, '1': {'precision': 0.38024927328475294, 'recall': 0.7635084352762453, 'f1-score': 0.5076661350345562, 'support': 187605}, '2': {'precision': 0.31900305335236406, 'recall': 0.22681319528299462, 'f1-score': 0.26512256466083556, 'support': 155692}, 'accuracy': 0.36498017112940245, 'macro avg': {'precision': 0.3415024252157717, 'recall': 0.3413492223863395, 'f1-score': 0.27796789775684666, 'support': 504063}, 'weighted avg': {'precision': 0.34379199709103, 'recall': 0.36498017112940245, 'f1-score': 0.290327559565838, 'support': 504063}}
[[  5422 118020  37324]
 [  6306 143238  38061]
 [  4942 115437  35313]]
training model: results/universal/W6/deepLOB_L1/h1000
Epoch 1/50
9426/9426 - 146s - loss: 3.1325 - accuracy1000: 0.4563 - val_loss: 3.3439 - val_accuracy1000: 0.3600 - 146s/epoch - 16ms/step
Epoch 2/50
9426/9426 - 142s - loss: 3.0918 - accuracy1000: 0.4715 - val_loss: 3.6049 - val_accuracy1000: 0.3629 - 142s/epoch - 15ms/step
Epoch 3/50
9426/9426 - 143s - loss: 3.0667 - accuracy1000: 0.4795 - val_loss: 3.6161 - val_accuracy1000: 0.3646 - 143s/epoch - 15ms/step
Epoch 4/50
9426/9426 - 144s - loss: 3.0493 - accuracy1000: 0.4846 - val_loss: 3.5936 - val_accuracy1000: 0.3648 - 144s/epoch - 15ms/step
Epoch 5/50
9426/9426 - 143s - loss: 3.0360 - accuracy1000: 0.4885 - val_loss: 3.6423 - val_accuracy1000: 0.3657 - 143s/epoch - 15ms/step
Epoch 6/50
9426/9426 - 146s - loss: 3.0273 - accuracy1000: 0.4909 - val_loss: 3.6401 - val_accuracy1000: 0.3653 - 146s/epoch - 15ms/step
Epoch 7/50
9426/9426 - 144s - loss: 3.0199 - accuracy1000: 0.4930 - val_loss: 3.6309 - val_accuracy1000: 0.3633 - 144s/epoch - 15ms/step
Epoch 8/50
9426/9426 - 147s - loss: 3.0153 - accuracy1000: 0.4942 - val_loss: 3.6446 - val_accuracy1000: 0.3666 - 147s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 145s - loss: 3.0086 - accuracy1000: 0.4961 - val_loss: 3.6751 - val_accuracy1000: 0.3616 - 145s/epoch - 15ms/step
Epoch 10/50
9426/9426 - 145s - loss: 3.0034 - accuracy1000: 0.4971 - val_loss: 3.6970 - val_accuracy1000: 0.3665 - 145s/epoch - 15ms/step
Epoch 11/50
9426/9426 - 143s - loss: 2.9993 - accuracy1000: 0.4982 - val_loss: 3.7147 - val_accuracy1000: 0.3635 - 143s/epoch - 15ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 213s - 213s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024022
{'0': {'precision': 0.3057973428394672, 'recall': 0.08636258117329391, 'f1-score': 0.1346871326030331, 'support': 3273860}, '1': {'precision': 0.38381446326278207, 'recall': 0.898314205329333, 'f1-score': 0.5378336714651495, 'support': 4149675}, '2': {'precision': 0.31752284643782636, 'recall': 0.016998645692873304, 'f1-score': 0.03226972552113577, 'support': 3395094}, 'accuracy': 0.3760331369159623, 'macro avg': {'precision': 0.33571155084669185, 'recall': 0.3338918107318334, 'f1-score': 0.2349301765297728, 'support': 10818629}, 'weighted avg': {'precision': 0.3394018671379145, 'recall': 0.3760331369159623, 'f1-score': 0.25718050855421376, 'support': 10818629}}
[[ 282739 2936318   54803]
 [ 352721 3727712   69242]
 [ 289136 3048246   57712]]
Evaluating performance on  train set...
9426/9426 - 53s - 53s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1271122
{'0': {'precision': 0.3447924533360741, 'recall': 0.09541510852575137, 'f1-score': 0.14946771570565565, 'support': 808656}, '1': {'precision': 0.3355139085337105, 'recall': 0.853744814271528, 'f1-score': 0.4817173152213022, 'support': 793524}, '2': {'precision': 0.34906574639830756, 'recall': 0.07292544989685427, 'f1-score': 0.12064600789383657, 'support': 810019}, 'accuracy': 0.3373254030865613, 'macro avg': {'precision': 0.3431240360893641, 'recall': 0.3406951242313779, 'f1-score': 0.25061034627359813, 'support': 2412199}, 'weighted avg': {'precision': 0.34317513262050564, 'recall': 0.3373254030865613, 'f1-score': 0.2490871501992575, 'support': 2412199}}
[[ 77158 668933  62565]
 [ 68467 677467  47590]
 [ 78156 672792  59071]]
Evaluating performance on  val set...
3323/3323 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.115565
{'0': {'precision': 0.31884882431880507, 'recall': 0.08091580447537433, 'f1-score': 0.12907549726750142, 'support': 270145}, '1': {'precision': 0.3667312862970204, 'recall': 0.86223883296939, 'f1-score': 0.5145934003649435, 'support': 309572}, '2': {'precision': 0.3092993914205136, 'recall': 0.061607486030216124, 'f1-score': 0.10274901380670612, 'support': 270584}, 'accuracy': 0.35923043722164266, 'macro avg': {'precision': 0.3316265006787797, 'recall': 0.33492070782499345, 'f1-score': 0.248805970479717, 'support': 850301}, 'weighted avg': {'precision': 0.33324272220692797, 'recall': 0.35923043722164266, 'f1-score': 0.26105467063896104, 'support': 850301}}
[[ 21859 229906  18380]
 [ 23801 266925  18846]
 [ 22896 231018  16670]]
testing model out of sample: results/universal/W6/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 92s - 92s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106149
{'0': {'precision': 0.31212616445968744, 'recall': 0.06899953186651508, 'f1-score': 0.11301551922952136, 'support': 1375676}, '1': {'precision': 0.37067200946193063, 'recall': 0.9168423792161975, 'f1-score': 0.527913023811473, 'support': 1659908}, '2': {'precision': 0.35278028572945985, 'recall': 0.018329712691929064, 'f1-score': 0.03484875809492581, 'support': 1449559}, 'accuracy': 0.3664019185118512, 'macro avg': {'precision': 0.3451928198836926, 'recall': 0.33472387459154723, 'f1-score': 0.22525910037864005, 'support': 4485143}, 'weighted avg': {'precision': 0.34693247138449973, 'recall': 0.3664019185118512, 'f1-score': 0.24130225499962166, 'support': 4485143}}
[[  94921 1257597   23158]
 [ 112446 1521874   25588]
 [  96744 1326245   26570]]
Evaluating performance on  train set...
5153/5153 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1252885
{'0': {'precision': 0.3460141162386625, 'recall': 0.09299389812028143, 'f1-score': 0.14659049685306436, 'support': 447567}, '1': {'precision': 0.33606760623176324, 'recall': 0.8384386934478358, 'f1-score': 0.4798136625677832, 'support': 438069}, '2': {'precision': 0.3397368396087695, 'recall': 0.08271070883345381, 'f1-score': 0.1330336744738944, 'support': 432979}, 'accuracy': 0.3372682701167513, 'macro avg': {'precision': 0.34060618735973175, 'recall': 0.33804776680052373, 'f1-score': 0.25314594463158063, 'support': 1318615}, 'weighted avg': {'precision': 0.34064849651634266, 'recall': 0.3372682701167513, 'f1-score': 0.2528420711067855, 'support': 1318615}}
[[ 41621 368370  37576]
 [ 38752 367294  32023]
 [ 39914 357253  35812]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1132176
{'0': {'precision': 0.3175313244278761, 'recall': 0.10421849721984311, 'f1-score': 0.15693017876242968, 'support': 147114}, '1': {'precision': 0.36532579166753076, 'recall': 0.8488745399678354, 'f1-score': 0.5108148223324496, 'support': 166021}, '2': {'precision': 0.358186722492854, 'recall': 0.06103995005385676, 'f1-score': 0.10430490750076205, 'support': 145757}, 'accuracy': 0.359910392859322, 'macro avg': {'precision': 0.3470146128627536, 'recall': 0.33804432908051174, 'f1-score': 0.25734996953188044, 'support': 458892}, 'weighted avg': {'precision': 0.34773602205030507, 'recall': 0.359910392859322, 'f1-score': 0.26824565331167305, 'support': 458892}}
[[ 15332 123520   8262]
 [ 17410 140931   7680]
 [ 15543 121317   8897]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250286
{'0': {'precision': 0.29618136913431703, 'recall': 0.05768092348675448, 'f1-score': 0.09655741935483872, 'support': 81084}, '1': {'precision': 0.32420464879848454, 'recall': 0.9291502583597004, 'f1-score': 0.48068560863664334, 'support': 87862}, '2': {'precision': 0.37936004612280194, 'recall': 0.01288667365184438, 'f1-score': 0.024926602898001707, 'support': 102121}, 'accuracy': 0.32327800875798235, 'macro avg': {'precision': 0.3332486880185345, 'recall': 0.33323928516609974, 'f1-score': 0.20072321029649462, 'support': 271067}, 'weighted avg': {'precision': 0.336601158598155, 'recall': 0.32327800875798235, 'f1-score': 0.19408039470517374, 'support': 271067}}
[[ 4677 75363  1044]
 [ 5116 81637  1109]
 [ 5998 94807  1316]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1274288
{'0': {'precision': 0.3397887323943662, 'recall': 0.08315829159261054, 'f1-score': 0.1336160270001298, 'support': 18567}, '1': {'precision': 0.341312948434252, 'recall': 0.8360251847796332, 'f1-score': 0.4847311281823377, 'support': 18265}, '2': {'precision': 0.2760906757912746, 'recall': 0.07537805803701758, 'f1-score': 0.11842407008209882, 'support': 17127}, 'accuracy': 0.3355325339609704, 'macro avg': {'precision': 0.3190641188732976, 'recall': 0.33152051146975375, 'f1-score': 0.24559040842152213, 'support': 53959}, 'weighted avg': {'precision': 0.32008642491141365, 'recall': 0.3355325339609704, 'f1-score': 0.24764565462402782, 'support': 53959}}
[[ 1544 15288  1735]
 [ 1345 15270  1650]
 [ 1655 14181  1291]]
Evaluating performance on  val set...
81/81 - 1s - 604ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069394
{'0': {'precision': 0.3348909657320872, 'recall': 0.06342182890855458, 'f1-score': 0.1066468253968254, 'support': 6780}, '1': {'precision': 0.34681740248606946, 'recall': 0.9040502793296089, 'f1-score': 0.501316604708798, 'support': 7160}, '2': {'precision': 0.40493468795355586, 'recall': 0.0416604449753621, 'f1-score': 0.07554833468724614, 'support': 6697}, 'accuracy': 0.34801569995638904, 'macro avg': {'precision': 0.36221435205723745, 'recall': 0.33637751773784186, 'f1-score': 0.2278372549309565, 'support': 20637}, 'weighted avg': {'precision': 0.36175902285646033, 'recall': 0.34801569995638904, 'f1-score': 0.23348546607093848, 'support': 20637}}
[[ 430 6178  172]
 [ 449 6473  238]
 [ 405 6013  279]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0899318
{'0': {'precision': 0.3303650846988595, 'recall': 0.22672671654242943, 'f1-score': 0.2689057377873419, 'support': 147433}, '1': {'precision': 0.4414347850646783, 'recall': 0.8168275642928517, 'f1-score': 0.5731334176257126, 'support': 239179}, '2': {'precision': 0.4382539888442081, 'recall': 0.03915671377989488, 'f1-score': 0.07189024422681016, 'support': 172563}, 'accuracy': 0.4212491617114499, 'macro avg': {'precision': 0.4033512862025819, 'recall': 0.36090366487172537, 'f1-score': 0.3046431332132882, 'support': 559175}, 'weighted avg': {'precision': 0.4111683624380824, 'recall': 0.4212491617114499, 'f1-score': 0.3382351742263379, 'support': 559175}}
[[ 33427 110152   3854]
 [ 39004 195368   4807]
 [ 28751 137055   6757]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1319742
{'0': {'precision': 0.3187222574508561, 'recall': 0.08398429341242324, 'f1-score': 0.13293880384831552, 'support': 47878}, '1': {'precision': 0.32075436999439094, 'recall': 0.8007483414824507, 'f1-score': 0.45803461225347303, 'support': 43563}, '2': {'precision': 0.36162361623616235, 'recall': 0.12022394218544376, 'f1-score': 0.18045465198031405, 'support': 44833}, 'accuracy': 0.3250363238768951, 'macro avg': {'precision': 0.33370008122713646, 'recall': 0.33498552569343926, 'f1-score': 0.2571426893607009, 'support': 136274}, 'weighted avg': {'precision': 0.33348605345857324, 'recall': 0.3250363238768951, 'f1-score': 0.2524951881979036, 'support': 136274}}
[[ 4021 38329  5528]
 [ 4693 34883  3987]
 [ 3902 35541  5390]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1479557
{'0': {'precision': 0.4917268701934281, 'recall': 0.10687873569040623, 'f1-score': 0.17559189447842552, 'support': 19742}, '1': {'precision': 0.2599524658348188, 'recall': 0.725867269984917, 'f1-score': 0.3828103249413356, 'support': 13260}, '2': {'precision': 0.25112563543936095, 'recall': 0.11375, 'f1-score': 0.15657686212361333, 'support': 15200}, 'accuracy': 0.27932450935645825, 'macro avg': {'precision': 0.33426832382253596, 'recall': 0.3154986685584411, 'f1-score': 0.23832636051445813, 'support': 48202}, 'weighted avg': {'precision': 0.3520964114975861, 'recall': 0.27932450935645825, 'f1-score': 0.22659990029032215, 'support': 48202}}
[[ 2110 15208  2424]
 [  903  9625  2732]
 [ 1278 12193  1729]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1240239
{'0': {'precision': 0.38826725308841603, 'recall': 0.10538234674531283, 'f1-score': 0.16577148774594408, 'support': 113928}, '1': {'precision': 0.2977176853192175, 'recall': 0.8271604938271605, 'f1-score': 0.43784351439121977, 'support': 92745}, '2': {'precision': 0.4198117476694723, 'recall': 0.08918134276705375, 'f1-score': 0.14711152693423826, 'support': 104024}, 'accuracy': 0.3154134092057535, 'macro avg': {'precision': 0.3685988953590353, 'recall': 0.3405747277798424, 'f1-score': 0.250242176357134, 'support': 310697}, 'weighted avg': {'precision': 0.37179900537937954, 'recall': 0.3154134092057535, 'f1-score': 0.24073917764233577, 'support': 310697}}
[[12006 94842  7080]
 [10289 76715  5741]
 [ 8627 86120  9277]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1216338
{'0': {'precision': 0.3800579230450972, 'recall': 0.10349023230661769, 'f1-score': 0.16268196790989267, 'support': 44381}, '1': {'precision': 0.35350921909415306, 'recall': 0.7914468442472922, 'f1-score': 0.4887240040423381, 'support': 46439}, '2': {'precision': 0.2834429088957467, 'recall': 0.1052566018933732, 'f1-score': 0.153507975148058, 'support': 40140}, 'accuracy': 0.34798411728772144, 'macro avg': {'precision': 0.33900335034499895, 'recall': 0.33339789281576104, 'f1-score': 0.2683046490334296, 'support': 130960}, 'weighted avg': {'precision': 0.34103057171085144, 'recall': 0.34798411728772144, 'f1-score': 0.2754860458458624, 'support': 130960}}
[[ 4593 34957  4831]
 [ 3835 36754  5850]
 [ 3657 32258  4225]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1153488
{'0': {'precision': 0.3169912693082606, 'recall': 0.14209377587115227, 'f1-score': 0.19622719950111733, 'support': 13287}, '1': {'precision': 0.36699785816277963, 'recall': 0.7894164320450473, 'f1-score': 0.5010559662090812, 'support': 15628}, '2': {'precision': 0.36671328671328673, 'recall': 0.09211635750421585, 'f1-score': 0.14724546526646823, 'support': 14232}, 'accuracy': 0.360071383873734, 'macro avg': {'precision': 0.3502341380614424, 'recall': 0.34120885514013843, 'f1-score': 0.2815095436588889, 'support': 43147}, 'weighted avg': {'precision': 0.35150460099590414, 'recall': 0.360071383873734, 'f1-score': 0.29048070320901204, 'support': 43147}}
[[ 1888 10420   979]
 [ 2006 12337  1285]
 [ 2062 10859  1311]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1392041
{'0': {'precision': 0.3209343700579863, 'recall': 0.09818566676746296, 'f1-score': 0.15036816350473134, 'support': 99210}, '1': {'precision': 0.27119994471612136, 'recall': 0.8776688811418799, 'f1-score': 0.4143619300784428, 'support': 76015}, '2': {'precision': 0.3794858061060525, 'recall': 0.0135127403112603, 'f1-score': 0.026096244866387962, 'support': 104864}, 'accuracy': 0.2780330537793344, 'macro avg': {'precision': 0.32387337362672003, 'recall': 0.3297890960735344, 'f1-score': 0.19694211281652071, 'support': 280089}, 'weighted avg': {'precision': 0.32935803341992675, 'recall': 0.2780330537793344, 'f1-score': 0.17548816354046795, 'support': 280089}}
[[ 9741 88195  1274]
 [ 8256 66716  1043]
 [12355 91092  1417]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1279999
{'0': {'precision': 0.3081232492997199, 'recall': 0.09479489831092727, 'f1-score': 0.1449848424937393, 'support': 34812}, '1': {'precision': 0.3290847389959078, 'recall': 0.877611860842716, 'f1-score': 0.4786765293011709, 'support': 37569}, '2': {'precision': 0.36080786026200873, 'recall': 0.031339639191143354, 'f1-score': 0.05767007655898968, 'support': 42183}, 'accuracy': 0.3281397297580392, 'macro avg': {'precision': 0.33267194951921214, 'recall': 0.3345821327815955, 'f1-score': 0.2271104827846333, 'support': 114564}, 'weighted avg': {'precision': 0.334395875522777, 'recall': 0.3281397297580392, 'f1-score': 0.22226273267078314, 'support': 114564}}
[[ 3300 30198  1314]
 [ 3570 32971  1028]
 [ 3840 37021  1322]]
Evaluating performance on  val set...
136/136 - 1s - 909ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1319938
{'0': {'precision': 0.3549262994569434, 'recall': 0.0816745514594305, 'f1-score': 0.13279152456280385, 'support': 11203}, '1': {'precision': 0.2974912754329361, 'recall': 0.8868387476690549, 'f1-score': 0.44552917683603277, 'support': 10189}, '2': {'precision': 0.4255903349807798, 'recall': 0.05791794335251476, 'f1-score': 0.10196026838573871, 'support': 13381}, 'accuracy': 0.30845771144278605, 'macro avg': {'precision': 0.3593359699568864, 'recall': 0.34214374749366666, 'f1-score': 0.2267603232615251, 'support': 34773}, 'weighted avg': {'precision': 0.365289224702503, 'recall': 0.30845771144278605, 'f1-score': 0.2125640751079573, 'support': 34773}}
[[  915  9744   544]
 [  651  9036   502]
 [ 1012 11594   775]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
1722/1722 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1317735
{'0': {'precision': 0.31939016231822825, 'recall': 0.06331137106005193, 'f1-score': 0.10567519236706141, 'support': 143276}, '1': {'precision': 0.296844806985972, 'recall': 0.9220266503760833, 'f1-score': 0.44910203026521583, 'support': 130955}, '2': {'precision': 0.3911347517730496, 'recall': 0.013243840353489265, 'f1-score': 0.02562018024714299, 'support': 166568}, 'accuracy': 0.29950385549876474, 'macro avg': {'precision': 0.33578990702574996, 'recall': 0.3328606205965415, 'f1-score': 0.19346580095980673, 'support': 440799}, 'weighted avg': {'precision': 0.339802925887962, 'recall': 0.29950385549876474, 'f1-score': 0.17745134952295843, 'support': 440799}}
[[  9071 132413   1792]
 [  8569 120744   1642]
 [ 10761 153601   2206]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1284437
{'0': {'precision': 0.3335744642372728, 'recall': 0.1348589811548374, 'f1-score': 0.19206789279810485, 'support': 54709}, '1': {'precision': 0.32465785747994336, 'recall': 0.8153964679388408, 'f1-score': 0.46440746616262196, 'support': 50622}, '2': {'precision': 0.37481311098332376, 'recall': 0.06193227167344457, 'f1-score': 0.10630004729520362, 'support': 52622}, 'accuracy': 0.3286673884003469, 'macro avg': {'precision': 0.3443484775668466, 'recall': 0.33739590692237426, 'f1-score': 0.25425846875197683, 'support': 157953}, 'weighted avg': {'precision': 0.3444554453000014, 'recall': 0.3286673884003469, 'f1-score': 0.25077585223417076, 'support': 157953}}
[[ 7378 44239  3092]
 [ 7001 41277  2344]
 [ 7739 41624  3259]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1371375
{'0': {'precision': 0.34948562638207864, 'recall': 0.18443350753462884, 'f1-score': 0.24144802391232145, 'support': 19709}, '1': {'precision': 0.308771516151851, 'recall': 0.7450076804915514, 'f1-score': 0.43659459549569074, 'support': 17577}, '2': {'precision': 0.3978425026968716, 'recall': 0.09146825396825396, 'f1-score': 0.14873966525509175, 'support': 20160}, 'accuracy': 0.3233297357518365, 'macro avg': {'precision': 0.3520332150769338, 'recall': 0.3403031473314781, 'f1-score': 0.2755940948877013, 'support': 57446}, 'weighted avg': {'precision': 0.35399843338325393, 'recall': 0.3233297357518365, 'f1-score': 0.2686229495501576, 'support': 57446}}
[[ 3635 14548  1526]
 [ 3217 13095  1265]
 [ 3549 14767  1844]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
4450/4450 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974104
{'0': {'precision': 0.2836166316522677, 'recall': 0.07408396476132902, 'f1-score': 0.11748062349193643, 'support': 340762}, '1': {'precision': 0.4047114094762376, 'recall': 0.8777692036668374, 'f1-score': 0.553993889607763, 'support': 462633}, '2': {'precision': 0.28247281445329225, 'recall': 0.03930586251883977, 'f1-score': 0.06900915694405949, 'support': 335726}, 'accuracy': 0.3902359801987673, 'macro avg': {'precision': 0.3236002851939325, 'recall': 0.33038634364900205, 'f1-score': 0.2468278900145863, 'support': 1139121}, 'weighted avg': {'precision': 0.3324599337914552, 'recall': 0.3902359801987673, 'f1-score': 0.2804767496845978, 'support': 1139121}}
[[ 25245 300918  14599]
 [ 37627 406085  18921]
 [ 26139 296391  13196]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.12309
{'0': {'precision': 0.33661551841958126, 'recall': 0.08522602157979176, 'f1-score': 0.1360150611860684, 'support': 127156}, '1': {'precision': 0.34029142256271594, 'recall': 0.8882562835744814, 'f1-score': 0.4920704223822401, 'support': 127515}, '2': {'precision': 0.392212389380531, 'recall': 0.05959369333374313, 'f1-score': 0.10346644610900263, 'support': 130148}, 'accuracy': 0.3426520000311835, 'macro avg': {'precision': 0.3563731101209427, 'recall': 0.3443586661626721, 'f1-score': 0.2438506432257704, 'support': 384819}, 'weighted avg': {'precision': 0.35663676081831286, 'recall': 0.3426520000311835, 'f1-score': 0.24299071007003695, 'support': 384819}}
[[ 10837 108780   7539]
 [  9769 113266   4480]
 [ 11588 110804   7756]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045961
{'0': {'precision': 0.2774160509181359, 'recall': 0.11018451256719454, 'f1-score': 0.15772398302969803, 'support': 34415}, '1': {'precision': 0.41205632430833994, 'recall': 0.9025565800502934, 'f1-score': 0.5658002376559244, 'support': 52492}, '2': {'precision': 0.39785522788203753, 'recall': 0.017016787450692596, 'f1-score': 0.03263762123644681, 'support': 43604}, 'accuracy': 0.3977519136318011, 'macro avg': {'precision': 0.3624425343695045, 'recall': 0.34325262668939355, 'f1-score': 0.2520539473073564, 'support': 130511}, 'weighted avg': {'precision': 0.37180784243864035, 'recall': 0.3977519136318011, 'f1-score': 0.2800621234025934, 'support': 130511}}
[[ 3792 30215   408]
 [ 4400 47377   715]
 [ 5477 37385   742]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
6203/6203 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0872152
{'0': {'precision': 0.2664680101358332, 'recall': 0.058195378001567585, 'f1-score': 0.09552790454227349, 'support': 421030}, '1': {'precision': 0.43562488483758033, 'recall': 0.9300649539421446, 'f1-score': 0.5933403426572104, 'support': 691413}, '2': {'precision': 0.3027295285359802, 'recall': 0.01257385403980809, 'f1-score': 0.02414485296196519, 'support': 475431}, 'accuracy': 0.4241766034332699, 'macro avg': {'precision': 0.33494080783646457, 'recall': 0.3336113953278401, 'f1-score': 0.23767103338714968, 'support': 1587874}, 'weighted avg': {'precision': 0.3509817134666135, 'recall': 0.4241766034332699, 'f1-score': 0.29091889632026424, 'support': 1587874}}
[[ 24502 391266   5262]
 [ 39847 643059   8507]
 [ 27602 441851   5978]]
Evaluating performance on  train set...
1766/1766 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127657
{'0': {'precision': 0.3496015002344116, 'recall': 0.09624605535729266, 'f1-score': 0.15093843141025315, 'support': 154957}, '1': {'precision': 0.34259640209302644, 'recall': 0.8255023286759814, 'f1-score': 0.4842298348147642, 'support': 150300}, '2': {'precision': 0.3686832287603866, 'recall': 0.1185342183815612, 'f1-score': 0.17939250167603527, 'support': 146734}, 'accuracy': 0.3459803403165107, 'macro avg': {'precision': 0.3536270436959416, 'recall': 0.3467608674716118, 'f1-score': 0.2715202559670175, 'support': 451991}, 'weighted avg': {'precision': 0.3534667809654001, 'recall': 0.3459803403165107, 'f1-score': 0.27100471033633194, 'support': 451991}}
[[ 14914 122129  17914]
 [ 14358 124073  11869]
 [ 13388 115953  17393]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964276
{'0': {'precision': 0.2693262411347518, 'recall': 0.03402930238809983, 'f1-score': 0.06042404232467482, 'support': 44638}, '1': {'precision': 0.4098212877200099, 'recall': 0.9047263681592039, 'f1-score': 0.5641121089448297, 'support': 60300}, '2': {'precision': 0.3040910555137979, 'recall': 0.06565586312421755, 'f1-score': 0.10799473754456879, 'support': 43134}, 'accuracy': 0.3978199794694473, 'macro avg': {'precision': 0.3277461947895199, 'recall': 0.33480384455717377, 'f1-score': 0.2441769629380244, 'support': 148072}, 'weighted avg': {'precision': 0.33666778317184753, 'recall': 0.3978199794694473, 'f1-score': 0.27940065360033967, 'support': 148072}}
[[ 1519 39802  3317]
 [ 2581 54555  3164]
 [ 1540 38762  2832]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
5183/5183 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1393832
{'0': {'precision': 0.34501884621658985, 'recall': 0.08846132678781742, 'f1-score': 0.14081762813549106, 'support': 454255}, '1': {'precision': 0.267983824901544, 'recall': 0.8993714757950719, 'f1-score': 0.4129282797569575, 'support': 355754}, '2': {'precision': 0.3954492912331934, 'recall': 0.012576644976791253, 'f1-score': 0.02437798630332216, 'support': 516831}, 'accuracy': 0.2763249525187664, 'macro avg': {'precision': 0.33615065411710904, 'recall': 0.3334698158532268, 'f1-score': 0.19270796473192356, 'support': 1326840}, 'weighted avg': {'precision': 0.3440077976767986, 'recall': 0.2763249525187664, 'f1-score': 0.16842068218057674, 'support': 1326840}}
[[ 40184 408604   5467]
 [ 31329 319955   4470]
 [ 44956 465375   6500]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1270475
{'0': {'precision': 0.3627831928345627, 'recall': 0.08278603525751815, 'f1-score': 0.13480905008381974, 'support': 133078}, '1': {'precision': 0.3209336601464251, 'recall': 0.8219408520974201, 'f1-score': 0.46162283481078153, 'support': 121864}, '2': {'precision': 0.34360263253355444, 'recall': 0.10514172447968285, 'f1-score': 0.16101360498788847, 'support': 126125}, 'accuracy': 0.32656461986999663, 'macro avg': {'precision': 0.3424398285048474, 'recall': 0.3366228706115404, 'f1-score': 0.25248182996082996, 'support': 381067}, 'weighted avg': {'precision': 0.3430514931086041, 'recall': 0.32656461986999663, 'f1-score': 0.2479961918443032, 'support': 381067}}
[[ 11017 108580  13481]
 [  9847 100165  11852]
 [  9504 103360  13261]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1191618
{'0': {'precision': 0.3146149746869171, 'recall': 0.10697864051280889, 'f1-score': 0.1596659961799158, 'support': 44149}, '1': {'precision': 0.33364669155795207, 'recall': 0.8437282737894997, 'f1-score': 0.4781945521335147, 'support': 44589}, '2': {'precision': 0.33012241621513144, 'recall': 0.037374471758985776, 'f1-score': 0.06714696818172541, 'support': 44014}, 'accuracy': 0.3313622393636254, 'macro avg': {'precision': 0.3261280274866669, 'recall': 0.32936046202043145, 'f1-score': 0.2350025054983853, 'support': 132752}, 'weighted avg': {'precision': 0.3261488857013305, 'recall': 0.3313622393636254, 'f1-score': 0.23597925159680344, 'support': 132752}}
[[ 4723 37786  1640]
 [ 5270 37621  1698]
 [ 5019 37350  1645]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
7324/7324 - 38s - 38s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1106895
{'0': {'precision': 0.32178615213964623, 'recall': 0.0715412146836741, 'f1-score': 0.11705756646623927, 'support': 616358}, '1': {'precision': 0.34996676115952485, 'recall': 0.9127536598100567, 'f1-score': 0.5059448421923056, 'support': 656933}, '2': {'precision': 0.3179668544639553, 'recall': 0.012856347114721117, 'f1-score': 0.024713455600800346, 'support': 601415}, 'accuracy': 0.34749182005071727, 'macro avg': {'precision': 0.3299065892543755, 'recall': 0.33238374053615066, 'f1-score': 0.21590528808644838, 'support': 1874706}, 'weighted avg': {'precision': 0.33043592928530546, 'recall': 0.34749182005071727, 'f1-score': 0.22370668972525373, 'support': 1874706}}
[[ 44095 564278   7985]
 [ 48715 599618   8600]
 [ 44222 549461   7732]]
Evaluating performance on  train set...
2046/2046 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1232179
{'0': {'precision': 0.34040406653387484, 'recall': 0.07521448617628734, 'f1-score': 0.12320584242310753, 'support': 174953}, '1': {'precision': 0.32891914146127244, 'recall': 0.8686812453970297, 'f1-score': 0.47716398988322384, 'support': 172443}, '2': {'precision': 0.31125716211661614, 'recall': 0.05236566944135725, 'f1-score': 0.08964887926766525, 'support': 176356}, 'accuracy': 0.32876628633399013, 'macro avg': {'precision': 0.3268601233705878, 'recall': 0.3320871336715581, 'f1-score': 0.2300062371913322, 'support': 523752}, 'weighted avg': {'precision': 0.3268084594341314, 'recall': 0.32876628633399013, 'f1-score': 0.2284457900094149, 'support': 523752}}
[[ 13159 151795   9999]
 [ 12209 149798  10436]
 [ 13289 153832   9235]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1188788
{'0': {'precision': 0.3151808578745198, 'recall': 0.12562998405103667, 'f1-score': 0.17965150754914927, 'support': 62700}, '1': {'precision': 0.3450779238894736, 'recall': 0.8327468021298733, 'f1-score': 0.48795466975084506, 'support': 65356}, '2': {'precision': 0.40363372093023253, 'recall': 0.045129521890337046, 'f1-score': 0.08118221416669102, 'support': 61534}, 'accuracy': 0.34326177541009545, 'macro avg': {'precision': 0.3546308342314086, 'recall': 0.33450210269041564, 'f1-score': 0.24959613048889515, 'support': 189590}, 'weighted avg': {'precision': 0.35419563250263075, 'recall': 0.34326177541009545, 'f1-score': 0.25397110230550696, 'support': 189590}}
[[ 7877 52455  2368]
 [ 9196 54425  1735]
 [ 7919 50838  2777]]
testing model on single stock: results/universal/W6/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
29350/29350 - 156s - 156s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961546
{'0': {'precision': 0.2962591281294618, 'recall': 0.07789669384463757, 'f1-score': 0.12335826544576645, 'support': 2232200}, '1': {'precision': 0.4013277377909013, 'recall': 0.9084282519046157, 'f1-score': 0.5567104989792441, 'support': 3016094}, '2': {'precision': 0.3021402481359616, 'recall': 0.013256309848086848, 'f1-score': 0.02539827810721208, 'support': 2265110}, 'accuracy': 0.3918081604556337, 'macro avg': {'precision': 0.3332423713521082, 'recall': 0.3331937518657801, 'f1-score': 0.2351556808440742, 'support': 7513404}, 'weighted avg': {'precision': 0.34020967130884266, 'recall': 0.3918081604556337, 'f1-score': 0.2677856015142765, 'support': 7513404}}
[[ 173881 2029011   29308]
 [ 236143 2739905   40046]
 [ 176898 2058185   30027]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127529
{'0': {'precision': 0.3506583103971649, 'recall': 0.10367765152491132, 'f1-score': 0.1600376512388285, 'support': 465732}, '1': {'precision': 0.3401075993544725, 'recall': 0.8566195765561658, 'f1-score': 0.486899326107252, 'support': 463013}, '2': {'precision': 0.34243853443381805, 'recall': 0.06720373663574229, 'f1-score': 0.1123572966331498, 'support': 466730}, 'accuracy': 0.3413017073039646, 'macro avg': {'precision': 0.34440148139515186, 'recall': 0.3425003215722731, 'f1-score': 0.2530980913264101, 'support': 1395475}, 'weighted avg': {'precision': 0.34440844393063347, 'recall': 0.3413017073039646, 'f1-score': 0.252541890125763, 'support': 1395475}}
[[ 48286 383315  34131]
 [ 40288 396626  26099]
 [ 49127 386237  31366]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126524
{'0': {'precision': 0.3197589989185849, 'recall': 0.06442515998904355, 'f1-score': 0.10724296765301733, 'support': 160636}, '1': {'precision': 0.3780756132756133, 'recall': 0.8662307846933486, 'f1-score': 0.5263988607560349, 'support': 189042}, '2': {'precision': 0.30770227879604906, 'recall': 0.07687923049519059, 'f1-score': 0.12302159019061143, 'support': 154385}, 'accuracy': 0.3689459452489074, 'macro avg': {'precision': 0.3351789636634157, 'recall': 0.3358450583925276, 'f1-score': 0.25222113953322123, 'support': 504063}, 'weighted avg': {'precision': 0.3379371089468227, 'recall': 0.3689459452489074, 'f1-score': 0.26927440218490545, 'support': 504063}}
[[ 10349 136744  13543]
 [ 12127 163754  13161]
 [  9889 132627  11869]]
training model: results/universal/W6/deepOF_L1/h300
Epoch 1/50
9426/9426 - 137s - loss: 3.2419 - accuracy300: 0.3925 - val_loss: 3.2875 - val_accuracy300: 0.3530 - 137s/epoch - 14ms/step
Epoch 2/50
9426/9426 - 131s - loss: 3.2443 - accuracy300: 0.3919 - val_loss: 3.2867 - val_accuracy300: 0.3532 - 131s/epoch - 14ms/step
Epoch 3/50
9426/9426 - 130s - loss: 3.2431 - accuracy300: 0.3926 - val_loss: 3.2859 - val_accuracy300: 0.3530 - 130s/epoch - 14ms/step
Epoch 4/50
9426/9426 - 128s - loss: 3.2424 - accuracy300: 0.3935 - val_loss: 3.2855 - val_accuracy300: 0.3533 - 128s/epoch - 14ms/step
Epoch 5/50
9426/9426 - 130s - loss: 3.2419 - accuracy300: 0.3945 - val_loss: 3.2849 - val_accuracy300: 0.3536 - 130s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 129s - loss: 3.2410 - accuracy300: 0.3955 - val_loss: 3.2846 - val_accuracy300: 0.3545 - 129s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 132s - loss: 3.2395 - accuracy300: 0.3964 - val_loss: 3.2848 - val_accuracy300: 0.3544 - 132s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 131s - loss: 3.2389 - accuracy300: 0.3968 - val_loss: 3.2845 - val_accuracy300: 0.3552 - 131s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 134s - loss: 3.2382 - accuracy300: 0.3971 - val_loss: 3.2843 - val_accuracy300: 0.3547 - 134s/epoch - 14ms/step
Epoch 10/50
9426/9426 - 130s - loss: 3.2370 - accuracy300: 0.3977 - val_loss: 3.2849 - val_accuracy300: 0.3561 - 130s/epoch - 14ms/step
Epoch 11/50
9426/9426 - 128s - loss: 3.2367 - accuracy300: 0.3979 - val_loss: 3.2847 - val_accuracy300: 0.3565 - 128s/epoch - 14ms/step
Epoch 12/50
9426/9426 - 131s - loss: 3.2357 - accuracy300: 0.3984 - val_loss: 3.2845 - val_accuracy300: 0.3565 - 131s/epoch - 14ms/step
Epoch 13/50
9426/9426 - 128s - loss: 3.2349 - accuracy300: 0.3986 - val_loss: 3.2847 - val_accuracy300: 0.3568 - 128s/epoch - 14ms/step
Epoch 14/50
9426/9426 - 132s - loss: 3.2344 - accuracy300: 0.3992 - val_loss: 3.2845 - val_accuracy300: 0.3585 - 132s/epoch - 14ms/step
Epoch 15/50
9426/9426 - 127s - loss: 3.2335 - accuracy300: 0.3994 - val_loss: 3.2848 - val_accuracy300: 0.3592 - 127s/epoch - 13ms/step
Epoch 16/50
9426/9426 - 131s - loss: 3.2331 - accuracy300: 0.3999 - val_loss: 3.2846 - val_accuracy300: 0.3588 - 131s/epoch - 14ms/step
Epoch 17/50
9426/9426 - 130s - loss: 3.2320 - accuracy300: 0.4004 - val_loss: 3.2850 - val_accuracy300: 0.3588 - 130s/epoch - 14ms/step
Epoch 18/50
9426/9426 - 131s - loss: 3.2314 - accuracy300: 0.4007 - val_loss: 3.2840 - val_accuracy300: 0.3608 - 131s/epoch - 14ms/step
Epoch 19/50
9426/9426 - 129s - loss: 3.2303 - accuracy300: 0.4015 - val_loss: 3.2846 - val_accuracy300: 0.3610 - 129s/epoch - 14ms/step
Epoch 20/50
9426/9426 - 132s - loss: 3.2297 - accuracy300: 0.4020 - val_loss: 3.2845 - val_accuracy300: 0.3602 - 132s/epoch - 14ms/step
Epoch 21/50
9426/9426 - 130s - loss: 3.2289 - accuracy300: 0.4023 - val_loss: 3.2862 - val_accuracy300: 0.3594 - 130s/epoch - 14ms/step
Epoch 22/50
9426/9426 - 133s - loss: 3.2283 - accuracy300: 0.4030 - val_loss: 3.2860 - val_accuracy300: 0.3606 - 133s/epoch - 14ms/step
Epoch 23/50
9426/9426 - 129s - loss: 3.2278 - accuracy300: 0.4032 - val_loss: 3.2864 - val_accuracy300: 0.3589 - 129s/epoch - 14ms/step
Epoch 24/50
9426/9426 - 130s - loss: 3.2267 - accuracy300: 0.4041 - val_loss: 3.2872 - val_accuracy300: 0.3592 - 130s/epoch - 14ms/step
Epoch 25/50
9426/9426 - 131s - loss: 3.2256 - accuracy300: 0.4044 - val_loss: 3.2863 - val_accuracy300: 0.3599 - 131s/epoch - 14ms/step
Epoch 26/50
9426/9426 - 127s - loss: 3.2254 - accuracy300: 0.4048 - val_loss: 3.2876 - val_accuracy300: 0.3587 - 127s/epoch - 13ms/step
Epoch 27/50
9426/9426 - 130s - loss: 3.2246 - accuracy300: 0.4056 - val_loss: 3.2897 - val_accuracy300: 0.3595 - 130s/epoch - 14ms/step
Epoch 28/50
9426/9426 - 131s - loss: 3.2239 - accuracy300: 0.4061 - val_loss: 3.2924 - val_accuracy300: 0.3601 - 131s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 258s - 258s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0889281
{'0': {'precision': 0.3573115669871056, 'recall': 0.04051437177264674, 'f1-score': 0.07277682148485948, 'support': 3252278}, '1': {'precision': 0.39474993064601616, 'recall': 0.7647168702696381, 'f1-score': 0.520708193221891, 'support': 4266719}, '2': {'precision': 0.34425337137499357, 'recall': 0.22788865461856517, 'f1-score': 0.2742376336166425, 'support': 3299607}, 'accuracy': 0.3832785634819428, 'macro avg': {'precision': 0.36543828966937175, 'recall': 0.34437329888694995, 'f1-score': 0.28924088277446436, 'support': 10818604}, 'weighted avg': {'precision': 0.36809411008631593, 'recall': 0.3832785634819428, 'f1-score': 0.3108795194320412, 'support': 10818604}}
[[ 131764 2547392  573122]
 [ 144680 3262832  859207]
 [  92321 2455343  751943]]
Evaluating performance on  train set...
9426/9426 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989739
{'0': {'precision': 0.3884684274281218, 'recall': 0.04598826791129109, 'f1-score': 0.08224060214648388, 'support': 815882}, '1': {'precision': 0.3287040307043328, 'recall': 0.7691008064926216, 'f1-score': 0.46056735504568086, 'support': 786616}, '2': {'precision': 0.3843744540404689, 'recall': 0.2255289665700044, 'f1-score': 0.28426655915091614, 'support': 809692}, 'accuracy': 0.34206136332544285, 'macro avg': {'precision': 0.36718230405764113, 'recall': 0.34687268032463897, 'f1-score': 0.2756915054476936, 'support': 2412190}, 'weighted avg': {'precision': 0.3676050260403889, 'recall': 0.34206136332544285, 'f1-score': 0.273426486441414, 'support': 2412190}}
[[ 37521 635279 143082]
 [ 32239 604987 149390]
 [ 26827 600256 182609]]
Evaluating performance on  val set...
3323/3323 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949086
{'0': {'precision': 0.36323661214429753, 'recall': 0.04713172096741955, 'f1-score': 0.08343707478069541, 'support': 275165}, '1': {'precision': 0.35655025518697747, 'recall': 0.7810110563474091, 'f1-score': 0.48959065084396886, 'support': 300280}, '2': {'precision': 0.37489559490184327, 'recall': 0.2139289001757303, 'f1-score': 0.27241055006555565, 'support': 274853}, 'accuracy': 0.36021488936819795, 'macro avg': {'precision': 0.36489415407770615, 'recall': 0.3473572258301863, 'f1-score': 0.28181275856340665, 'support': 850298}, 'weighted avg': {'precision': 0.36464403297877634, 'recall': 0.36021488936819795, 'f1-score': 0.28795328253697544, 'support': 850298}}
[[ 12969 216728  45468]
 [ 13184 234522  52574]
 [  9551 206503  58799]]
testing model out of sample: results/universal/W6/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 102s - 102s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913398
{'0': {'precision': 0.34293289163906077, 'recall': 0.04775063116066112, 'f1-score': 0.08382878245884094, 'support': 1378809}, '1': {'precision': 0.37632815781417966, 'recall': 0.7861193727990863, 'f1-score': 0.5089930471639342, 'support': 1681120}, '2': {'precision': 0.3634338147311573, 'recall': 0.19926409760389674, 'f1-score': 0.2574003192250138, 'support': 1425189}, 'accuracy': 0.3726521799426459, 'macro avg': {'precision': 0.36089828806146595, 'recall': 0.34437803385454807, 'f1-score': 0.283407382949263, 'support': 4485118}, 'weighted avg': {'precision': 0.3619645291462608, 'recall': 0.3726521799426459, 'f1-score': 0.29834362768549305, 'support': 4485118}}
[[  65839 1099532  213438]
 [  75581 1321561  283978]
 [  50568 1090632  283989]]
Evaluating performance on  train set...
5152/5152 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001354
{'0': {'precision': 0.3658784858445552, 'recall': 0.03879877394704945, 'f1-score': 0.07015781747500173, 'support': 444679}, '1': {'precision': 0.33285144616627127, 'recall': 0.7520477360285212, 'f1-score': 0.4614625591601171, 'support': 438411}, '2': {'precision': 0.36955554368914756, 'recall': 0.23835874357090375, 'f1-score': 0.2898000488536832, 'support': 435520}, 'accuracy': 0.3418516468098983, 'macro avg': {'precision': 0.356095158566658, 'recall': 0.3430684178488248, 'f1-score': 0.2738068084962673, 'support': 1318610}, 'weighted avg': {'precision': 0.356112152159903, 'recall': 0.3418516468098983, 'f1-score': 0.27280370042519664, 'support': 1318610}}
[[ 17253 342590  84836]
 [ 16446 329706  92259]
 [ 13456 318254 103810]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943204
{'0': {'precision': 0.3438373718546132, 'recall': 0.04058857909031526, 'f1-score': 0.07260628647687926, 'support': 145435}, '1': {'precision': 0.3710899123954355, 'recall': 0.7525434118853667, 'f1-score': 0.4970683278177925, 'support': 169654}, '2': {'precision': 0.3571845405682109, 'recall': 0.24261474269819194, 'f1-score': 0.28895744901128484, 'support': 143800}, 'accuracy': 0.36711056486427, 'macro avg': {'precision': 0.3573706082727532, 'recall': 0.3452489112246246, 'f1-score': 0.28621068776865216, 'support': 458889}, 'weighted avg': {'precision': 0.3580953413721393, 'recall': 0.36711056486427, 'f1-score': 0.29732943376107834, 'support': 458889}}
[[  5903 112011  27521]
 [  6716 127672  35266]
 [  4549 104363  34888]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989196
{'0': {'precision': 0.33929524826481583, 'recall': 0.015201530917354383, 'f1-score': 0.029099317734328493, 'support': 83610}, '1': {'precision': 0.3429730515800981, 'recall': 0.7460838642115368, 'f1-score': 0.4699233913909787, 'support': 91672}, '2': {'precision': 0.375946272349701, 'recall': 0.2665065775736062, 'f1-score': 0.31190508192915356, 'support': 95780}, 'accuracy': 0.3511816484789458, 'macro avg': {'precision': 0.3527381907315383, 'recall': 0.3425973242341658, 'f1-score': 0.2703092636848203, 'support': 271062}, 'weighted avg': {'precision': 0.35348973761547675, 'recall': 0.3511816484789458, 'f1-score': 0.2781137888694665, 'support': 271062}}
[[ 1271 61946 20393]
 [ 1298 68395 21979]
 [ 1177 69077 25526]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1054012
{'0': {'precision': 0.3493150684931507, 'recall': 0.005668241178105029, 'f1-score': 0.011155465631322798, 'support': 17995}, '1': {'precision': 0.33377486883798246, 'recall': 0.7053625336187497, 'f1-score': 0.4531302339521518, 'support': 18219}, '2': {'precision': 0.3419716452357402, 'recall': 0.2922513384051846, 'f1-score': 0.31516256457003955, 'support': 17745}, 'accuracy': 0.3361626420059675, 'macro avg': {'precision': 0.3416871941889578, 'recall': 0.33442737106734644, 'f1-score': 0.25981608805117135, 'support': 53959}, 'weighted avg': {'precision': 0.3416530298486195, 'recall': 0.3361626420059675, 'f1-score': 0.2603621646936611, 'support': 53959}}
[[  102 13183  4710]
 [   99 12851  5269]
 [   91 12468  5186]]
Evaluating performance on  val set...
81/81 - 1s - 875ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006337
{'0': {'precision': 0.3958333333333333, 'recall': 0.00858563036601898, 'f1-score': 0.01680672268907563, 'support': 6639}, '1': {'precision': 0.3509549573039567, 'recall': 0.7478816502291985, 'f1-score': 0.4777284826974268, 'support': 7199}, '2': {'precision': 0.33585711512327704, 'recall': 0.25448661370991466, 'f1-score': 0.2895639802493932, 'support': 6798}, 'accuracy': 0.34749951540996316, 'macro avg': {'precision': 0.360881801920189, 'recall': 0.33698463143504404, 'f1-score': 0.2613663952119652, 'support': 20636}, 'weighted avg': {'precision': 0.3604196019693362, 'recall': 0.34749951540996316, 'f1-score': 0.2674550841542413, 'support': 20636}}
[[  57 4938 1644]
 [  38 5384 1777]
 [  49 5019 1730]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970924
{'0': {'precision': 0.42951142036000606, 'recall': 0.02994779307071666, 'f1-score': 0.05599156034941731, 'support': 189630}, '1': {'precision': 0.30423759847510307, 'recall': 0.7597753573061636, 'f1-score': 0.434491382518296, 'support': 170582}, '2': {'precision': 0.40828831532613047, 'recall': 0.24615748047326572, 'f1-score': 0.30713994543915213, 'support': 198958}, 'accuracy': 0.32952053937085324, 'macro avg': {'precision': 0.3806791113870798, 'recall': 0.3452935436167153, 'f1-score': 0.26587429610228847, 'support': 559170}, 'weighted avg': {'precision': 0.3837436473820202, 'recall': 0.32952053937085324, 'f1-score': 0.26081878116937385, 'support': 559170}}
[[  5679 149277  34674]
 [  4675 129604  36303]
 [  2868 147115  48975]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0882082
{'0': {'precision': 0.4989071038251366, 'recall': 0.03888829730593121, 'f1-score': 0.0721525239553492, 'support': 46955}, '1': {'precision': 0.3358200256440145, 'recall': 0.7659008839362857, 'f1-score': 0.46691471905028803, 'support': 45139}, '2': {'precision': 0.4150288237872097, 'recall': 0.2786744233424633, 'f1-score': 0.33345070422535217, 'support': 44177}, 'accuracy': 0.3574421557044419, 'macro avg': {'precision': 0.4165853177521202, 'recall': 0.3611545348615601, 'f1-score': 0.2908393157436631, 'support': 136271}, 'weighted avg': {'precision': 0.4176933576924072, 'recall': 0.3574421557044419, 'f1-score': 0.28762419756292795, 'support': 136271}}
[[ 1826 37157  7972]
 [ 1187 34572  9380]
 [  647 31219 12311]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0884732
{'0': {'precision': 0.48680555555555555, 'recall': 0.03993391819528313, 'f1-score': 0.07381278298410025, 'support': 17554}, '1': {'precision': 0.33497496734871574, 'recall': 0.7822964986973375, 'f1-score': 0.46908876145478107, 'support': 15737}, '2': {'precision': 0.41222899390548506, 'recall': 0.2767270288397049, 'f1-score': 0.33115293551105585, 'support': 14910}, 'accuracy': 0.3555527893612166, 'macro avg': {'precision': 0.4113365056032521, 'recall': 0.3663191485774419, 'f1-score': 0.2913514933166457, 'support': 48201}, 'weighted avg': {'precision': 0.4141660978510766, 'recall': 0.3555527893612166, 'f1-score': 0.28246819982960164, 'support': 48201}}
[[  701 13911  2942]
 [  485 12311  2941]
 [  254 10530  4126]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106669
{'0': {'precision': 0.38415233415233413, 'recall': 0.056642393942687386, 'f1-score': 0.09872762289647334, 'support': 110412}, '1': {'precision': 0.2967070465790821, 'recall': 0.7547415476758821, 'f1-score': 0.4259592656550441, 'support': 92164}, '2': {'precision': 0.3798606016140866, 'recall': 0.21070886825261756, 'f1-score': 0.27106039693493883, 'support': 108116}, 'accuracy': 0.3173400023174076, 'macro avg': {'precision': 0.35357332744850095, 'recall': 0.34069760329039567, 'f1-score': 0.26524909516215206, 'support': 310692}, 'weighted avg': {'precision': 0.35671901614283796, 'recall': 0.3173400023174076, 'f1-score': 0.2557670938874987, 'support': 310692}}
[[ 6254 84506 19652]
 [ 5065 69560 17539]
 [ 4961 80374 22781]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984864
{'0': {'precision': 0.36732623033992895, 'recall': 0.04937261320240044, 'f1-score': 0.08704538623384431, 'support': 43992}, '1': {'precision': 0.3497282194564389, 'recall': 0.7563113835607409, 'f1-score': 0.478289263432867, 'support': 45513}, '2': {'precision': 0.35136353391931485, 'recall': 0.225642262694488, 'f1-score': 0.27480646914523255, 'support': 41455}, 'accuracy': 0.35085522296884547, 'macro avg': {'precision': 0.35613932790522757, 'recall': 0.3437754198192098, 'f1-score': 0.2800470396039813, 'support': 130960}, 'weighted avg': {'precision': 0.3561573860404723, 'recall': 0.35085522296884547, 'f1-score': 0.2824509930989231, 'support': 130960}}
[[ 2172 33563  8257]
 [ 2080 34422  9011]
 [ 1661 30440  9354]]
Evaluating performance on  val set...
169/169 - 1s - 995ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09779
{'0': {'precision': 0.36383804769828065, 'recall': 0.04725884302283697, 'f1-score': 0.08365212955878602, 'support': 13881}, '1': {'precision': 0.35190069821567105, 'recall': 0.7545412203074057, 'f1-score': 0.4799593685190671, 'support': 15029}, '2': {'precision': 0.36225049352928274, 'recall': 0.23201742062377073, 'f1-score': 0.2828637492506637, 'support': 14236}, 'accuracy': 0.3545867519584666, 'macro avg': {'precision': 0.3593297464810781, 'recall': 0.3446058279846711, 'f1-score': 0.2821584157761723, 'support': 43146}, 'weighted avg': {'precision': 0.35915611086696386, 'recall': 0.3545867519584666, 'f1-score': 0.2874271750384976, 'support': 43146}}
[[  656 10531  2694]
 [  568 11340  3121]
 [  579 10354  3303]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101218
{'0': {'precision': 0.4299544419134396, 'recall': 0.06840489253536014, 'f1-score': 0.11803124918576675, 'support': 99335}, '1': {'precision': 0.2480785177067321, 'recall': 0.7155305043497721, 'f1-score': 0.36842275825564685, 'support': 71498}, '2': {'precision': 0.4115813224478548, 'recall': 0.218725686721403, 'f1-score': 0.28564939334170103, 'support': 109251}, 'accuracy': 0.29223375844389543, 'macro avg': {'precision': 0.3632047606893422, 'recall': 0.33422036120217835, 'f1-score': 0.2573678002610382, 'support': 280084}, 'weighted avg': {'precision': 0.3763596399837836, 'recall': 0.29223375844389543, 'f1-score': 0.2473315376087337, 'support': 280084}}
[[ 6795 74972 17568]
 [ 3744 51159 16595]
 [ 5265 80090 23896]]
Evaluating performance on  train set...
448/448 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003461
{'0': {'precision': 0.37486077963404935, 'recall': 0.06307391641902926, 'f1-score': 0.10797928411017921, 'support': 37353}, '1': {'precision': 0.3257231238024885, 'recall': 0.7455155469843869, 'f1-score': 0.453366106786836, 'support': 37853}, '2': {'precision': 0.3703789279112754, 'recall': 0.20364865208222171, 'f1-score': 0.2627998098267128, 'support': 39357}, 'accuracy': 0.3368539580841982, 'macro avg': {'precision': 0.3569876104492711, 'recall': 0.3374127051618793, 'f1-score': 0.2747150669079093, 'support': 114563}, 'weighted avg': {'precision': 0.3570854077910871, 'recall': 0.3368539580841982, 'f1-score': 0.2752863451107213, 'support': 114563}}
[[ 2356 29076  5921]
 [ 1929 28220  7704]
 [ 2000 29342  8015]]
Evaluating performance on  val set...
136/136 - 1s - 853ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10649
{'0': {'precision': 0.36988457502623295, 'recall': 0.06047868233679334, 'f1-score': 0.10395930103959301, 'support': 11657}, '1': {'precision': 0.29228822333857424, 'recall': 0.7547281909099911, 'f1-score': 0.42138434321096857, 'support': 10099}, '2': {'precision': 0.4228276877761414, 'recall': 0.2205577321963586, 'f1-score': 0.28989751098096633, 'support': 13017}, 'accuracy': 0.32203146119115406, 'macro avg': {'precision': 0.3616668287136495, 'recall': 0.3452548684810477, 'f1-score': 0.27174705174384267, 'support': 34773}, 'weighted avg': {'precision': 0.36716737901127566, 'recall': 0.32203146119115406, 'f1-score': 0.2657524503133278, 'support': 34773}}
[[ 705 8929 2023]
 [ 581 7622 1896]
 [ 620 9526 2871]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
1722/1722 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051985
{'0': {'precision': 0.3511299180696858, 'recall': 0.05349464024854433, 'f1-score': 0.09284443201228403, 'support': 145809}, '1': {'precision': 0.3075242624598848, 'recall': 0.8222796588265702, 'f1-score': 0.44763687017208137, 'support': 135415}, '2': {'precision': 0.39509363163297817, 'recall': 0.1398884502099392, 'f1-score': 0.20662013810467075, 'support': 159570}, 'accuracy': 0.3209458386457166, 'macro avg': {'precision': 0.3512492707208496, 'recall': 0.3385542497616845, 'f1-score': 0.2490338134296787, 'support': 440794}, 'weighted avg': {'precision': 0.3536490764949215, 'recall': 0.3209458386457166, 'f1-score': 0.2430266201422747, 'support': 440794}}
[[  7800 120787  17222]
 [  7112 111349  16954]
 [  7302 129946  22322]]
Evaluating performance on  train set...
617/617 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035789
{'0': {'precision': 0.3680139720558882, 'recall': 0.05460131783519657, 'f1-score': 0.09509380439687963, 'support': 54028}, '1': {'precision': 0.323234690887782, 'recall': 0.755956692836306, 'f1-score': 0.4528416954002768, 'support': 51077}, '2': {'precision': 0.3556969915685181, 'recall': 0.20515828713077375, 'f1-score': 0.26022465437788017, 'support': 52847}, 'accuracy': 0.33177167747163694, 'macro avg': {'precision': 0.3489818848373962, 'recall': 0.33857209926742543, 'f1-score': 0.2693867180583455, 'support': 157952}, 'weighted avg': {'precision': 0.34941270830462573, 'recall': 0.33177167747163694, 'f1-score': 0.26602775305043547, 'support': 157952}}
[[ 2950 41397  9681]
 [ 2507 38612  9958]
 [ 2559 39446 10842]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028532
{'0': {'precision': 0.3617368592882795, 'recall': 0.05773539680058361, 'f1-score': 0.09957760402624248, 'support': 19191}, '1': {'precision': 0.3224674360531822, 'recall': 0.7784294558488107, 'f1-score': 0.45602481507993325, 'support': 18414}, '2': {'precision': 0.38143187997180544, 'recall': 0.1909274193548387, 'f1-score': 0.25447583218568404, 'support': 19840}, 'accuracy': 0.33475498302724344, 'macro avg': {'precision': 0.35521205843775566, 'recall': 0.34236409066807766, 'f1-score': 0.27002608376395326, 'support': 57445}, 'weighted avg': {'precision': 0.3559511869218433, 'recall': 0.33475498302724344, 'f1-score': 0.26733458533055066, 'support': 57445}}
[[ 1108 15061  3022]
 [  959 14334  3121]
 [  996 15056  3788]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/EXC
Evaluating performance on  test set...
4450/4450 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952234
{'0': {'precision': 0.4206028916339135, 'recall': 0.06102456919266106, 'f1-score': 0.10658491199441529, 'support': 392809}, '1': {'precision': 0.3178554289476915, 'recall': 0.7843271169077229, 'f1-score': 0.4523799312871976, 'support': 363124}, '2': {'precision': 0.4003944243231915, 'recall': 0.1944527810471759, 'f1-score': 0.26177414509983715, 'support': 383183}, 'accuracy': 0.33648021799360206, 'macro avg': {'precision': 0.37961758163493214, 'recall': 0.34660148904918664, 'f1-score': 0.2735796627938167, 'support': 1139116}, 'weighted avg': {'precision': 0.3810515107648922, 'recall': 0.33648021799360206, 'f1-score': 0.26901994626195885, 'support': 1139116}}
[[ 23971 317163  51675]
 [ 18408 284808  59908]
 [ 14613 294059  74511]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934108
{'0': {'precision': 0.41121905970805056, 'recall': 0.06548697335582837, 'f1-score': 0.1129815430840219, 'support': 128621}, '1': {'precision': 0.3310191521851697, 'recall': 0.7894380820538636, 'f1-score': 0.46645086780421946, 'support': 127136}, '2': {'precision': 0.4141529804357783, 'recall': 0.1961708029536421, 'f1-score': 0.266234824625512, 'support': 129061}, 'accuracy': 0.3484946130378517, 'macro avg': {'precision': 0.3854637307763329, 'recall': 0.3503652861211113, 'f1-score': 0.28188907850458444, 'support': 384818}, 'weighted avg': {'precision': 0.3857066338345526, 'recall': 0.3484946130378517, 'f1-score': 0.2811589615952487, 'support': 384818}}
[[  8423 104322  15876]
 [  6832 100366  19938]
 [  5228  98515  25318]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0903286
{'0': {'precision': 0.3767896475770925, 'recall': 0.0688622754491018, 'f1-score': 0.11644330993405659, 'support': 39746}, '1': {'precision': 0.35396476845752206, 'recall': 0.7847035915188231, 'f1-score': 0.48786360426404807, 'support': 46220}, '2': {'precision': 0.4106919449523626, 'recall': 0.19160399595914243, 'f1-score': 0.26130084038758855, 'support': 44545}, 'accuracy': 0.3642681459800323, 'macro avg': {'precision': 0.38048212032899237, 'recall': 0.3483899543090225, 'f1-score': 0.2885359181952311, 'support': 130511}, 'weighted avg': {'precision': 0.3802775675506952, 'recall': 0.3642681459800323, 'f1-score': 0.297422114004095, 'support': 130511}}
[[ 2737 32205  4804]
 [ 2508 36269  7443]
 [ 2019 33991  8535]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/AAL
Evaluating performance on  test set...
6203/6203 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952495
{'0': {'precision': 0.3670135216260256, 'recall': 0.05035545139876254, 'f1-score': 0.08856016017189854, 'support': 509915}, '1': {'precision': 0.33757426600016915, 'recall': 0.7798398022838596, 'f1-score': 0.4711840602793915, 'support': 537336}, '2': {'precision': 0.3988257071788049, 'recall': 0.2040479599273424, 'f1-score': 0.2699722225621321, 'support': 540618}, 'accuracy': 0.349540799650349, 'macro avg': {'precision': 0.3678044982683332, 'recall': 0.3447477378699882, 'f1-score': 0.2765721476711407, 'support': 1587869}, 'weighted avg': {'precision': 0.3678822760813347, 'recall': 0.349540799650349, 'f1-score': 0.27980529584331926, 'support': 1587869}}
[[ 25677 410482  73756]
 [ 25776 419036  92524]
 [ 18509 411797 110312]]
Evaluating performance on  train set...
1766/1766 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983073
{'0': {'precision': 0.36470588235294116, 'recall': 0.019259695245569287, 'f1-score': 0.036587259682579115, 'support': 152910}, '1': {'precision': 0.3380062256954251, 'recall': 0.7138549873497372, 'f1-score': 0.4587818753567449, 'support': 152566}, '2': {'precision': 0.37577341188650876, 'recall': 0.31213612443946953, 'f1-score': 0.3410112820359862, 'support': 146513}, 'accuracy': 0.34865229021060246, 'macro avg': {'precision': 0.359495173311625, 'recall': 0.34841693567825865, 'f1-score': 0.2787934723584367, 'support': 451989}, 'weighted avg': {'precision': 0.3592811422308165, 'recall': 0.34865229021060246, 'f1-score': 0.27777591808357893, 'support': 451989}}
[[  2945 114493  35472]
 [  3159 108910  40497]
 [  1971  98810  45732]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945638
{'0': {'precision': 0.36423642364236425, 'recall': 0.024792206996548695, 'f1-score': 0.04642447418738049, 'support': 48967}, '1': {'precision': 0.35208423199090233, 'recall': 0.6890108203514695, 'f1-score': 0.46602823627115125, 'support': 52124}, '2': {'precision': 0.3748917748917749, 'recall': 0.34101019561099166, 'f1-score': 0.35714922644790226, 'support': 46981}, 'accuracy': 0.35894024528607704, 'macro avg': {'precision': 0.3637374768416805, 'recall': 0.3516044076530033, 'f1-score': 0.28986731230214463, 'support': 148072}, 'weighted avg': {'precision': 0.3633394155612129, 'recall': 0.35894024528607704, 'f1-score': 0.2927207765322265, 'support': 148072}}
[[ 1214 35836 11917]
 [ 1413 35914 14797]
 [  706 30254 16021]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/WBA
Evaluating performance on  test set...
5183/5183 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0786949
{'0': {'precision': 0.34258248812427783, 'recall': 0.05835176159613813, 'f1-score': 0.09971855329386073, 'support': 365833}, '1': {'precision': 0.4249485494257452, 'recall': 0.7854448647293253, 'f1-score': 0.5515126768161113, 'support': 562317}, '2': {'precision': 0.36222332753046504, 'recall': 0.20458256518303924, 'f1-score': 0.2614813235640632, 'support': 398685}, 'accuracy': 0.410435359332547, 'macro avg': {'precision': 0.37658478836016274, 'recall': 0.3494597305028342, 'f1-score': 0.30423751789134507, 'support': 1326835}, 'weighted avg': {'precision': 0.3833911376937518, 'recall': 0.410435359332547, 'f1-score': 0.3397965631608276, 'support': 1326835}}
[[ 21347 295039  49447]
 [ 26483 441669  94165]
 [ 14482 302639  81564]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984509
{'0': {'precision': 0.3924021708083405, 'recall': 0.05287466034438962, 'f1-score': 0.0931920551364845, 'support': 129911}, '1': {'precision': 0.3320635485128472, 'recall': 0.7714698825809937, 'f1-score': 0.4642850312685268, 'support': 125874}, '2': {'precision': 0.37358342003880657, 'recall': 0.21208492975734355, 'f1-score': 0.27056750949582997, 'support': 125280}, 'accuracy': 0.3425845984280897, 'macro avg': {'precision': 0.36601637978666474, 'recall': 0.34547649089424226, 'f1-score': 0.27601486530028047, 'support': 381065}, 'weighted avg': {'precision': 0.36628411525553417, 'recall': 0.3425845984280897, 'f1-score': 0.27408653298090346, 'support': 381065}}
[[  6869 101431  21611]
 [  5825  97108  22941]
 [  4811  93899  26570]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094618
{'0': {'precision': 0.3570337688783302, 'recall': 0.049426799473783124, 'f1-score': 0.08683271083964425, 'support': 42568}, '1': {'precision': 0.35893655756520365, 'recall': 0.7670691222802529, 'f1-score': 0.489036876268022, 'support': 47293}, '2': {'precision': 0.3680884063590539, 'recall': 0.22133364420610865, 'f1-score': 0.2764414676761794, 'support': 42890}, 'accuracy': 0.3606300517510226, 'macro avg': {'precision': 0.3613529109341959, 'recall': 0.34594318865338153, 'f1-score': 0.2841036849279485, 'support': 132751}, 'weighted avg': {'precision': 0.361283243360003, 'recall': 0.3606300517510226, 'f1-score': 0.29137927678885184, 'support': 132751}}
[[ 2104 32981  7483]
 [ 2202 36277  8814]
 [ 1587 31810  9493]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
7324/7324 - 47s - 47s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.081133
{'0': {'precision': 0.3112782711514755, 'recall': 0.04677325762716349, 'f1-score': 0.0813262762483958, 'support': 529063}, '1': {'precision': 0.44286491052747906, 'recall': 0.7922254172968214, 'f1-score': 0.5681347034217274, 'support': 824533}, '2': {'precision': 0.3211273323444453, 'recall': 0.19733642931846748, 'f1-score': 0.24445342493433014, 'support': 521105}, 'accuracy': 0.4164904163383921, 'macro avg': {'precision': 0.3584235046744666, 'recall': 0.34544503474748406, 'f1-score': 0.29797146820148446, 'support': 1874701}, 'weighted avg': {'precision': 0.3718905616221035, 'recall': 0.4164904163383921, 'f1-score': 0.3407788426568484, 'support': 1874701}}
[[ 24746 421911  82406]
 [ 36331 653216 134986]
 [ 18421 399851 102833]]
Evaluating performance on  train set...
2046/2046 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006231
{'0': {'precision': 0.3657050635464999, 'recall': 0.05157208370790992, 'f1-score': 0.09039638175118057, 'support': 175754}, '1': {'precision': 0.3276827944483213, 'recall': 0.7906873406768166, 'f1-score': 0.4633432692637134, 'support': 171036}, '2': {'precision': 0.3774706993890634, 'recall': 0.18400203435804702, 'f1-score': 0.24740427245546517, 'support': 176960}, 'accuracy': 0.33768210023866346, 'macro avg': {'precision': 0.3569528524612949, 'recall': 0.3420871529142578, 'f1-score': 0.2670479744901197, 'support': 523750}, 'weighted avg': {'precision': 0.357263765410412, 'recall': 0.33768210023866346, 'f1-score': 0.26523449190225223, 'support': 523750}}
[[  9064 140242  26448]
 [  8548 135236  27252]
 [  7173 137226  32561]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0896883
{'0': {'precision': 0.3271992818671454, 'recall': 0.051376922670331414, 'f1-score': 0.08880902709040797, 'support': 56757}, '1': {'precision': 0.40605326714523693, 'recall': 0.7893819581729269, 'f1-score': 0.5362584544157342, 'support': 76888}, '2': {'precision': 0.3259413555519949, 'recall': 0.18180355706497453, 'f1-score': 0.2334136546184739, 'support': 55945}, 'accuracy': 0.3891608207183923, 'macro avg': {'precision': 0.3530646348547924, 'recall': 0.340854145969411, 'f1-score': 0.2861603787082054, 'support': 189590}, 'weighted avg': {'precision': 0.35880722813203697, 'recall': 0.3891608207183923, 'f1-score': 0.31294214305247, 'support': 189590}}
[[ 2916 45345  8496]
 [ 3656 60694 12538]
 [ 2340 43434 10171]]
testing model on single stock: results/universal/W6/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
29350/29350 - 178s - 178s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088387
{'0': {'precision': 0.3365031455689298, 'recall': 0.03357779913646979, 'f1-score': 0.061062506418417734, 'support': 2204671}, '1': {'precision': 0.4135332633076569, 'recall': 0.7604125325326101, 'f1-score': 0.5357246938529631, 'support': 3099198}, '2': {'precision': 0.3280515758413842, 'recall': 0.23674401343272097, 'f1-score': 0.27501718551816146, 'support': 2209530}, 'accuracy': 0.3931363155344206, 'macro avg': {'precision': 0.359362661572657, 'recall': 0.3435781150339336, 'f1-score': 0.2906014619298474, 'support': 7513399}, 'weighted avg': {'precision': 0.36579183235044155, 'recall': 0.3931363155344206, 'f1-score': 0.31977515885229285, 'support': 7513399}}
[[  74028 1710783  419860]
 [  90937 2356669  651592]
 [  55027 1631410  523093]]
Evaluating performance on  train set...
5452/5452 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015286
{'0': {'precision': 0.37459410579966296, 'recall': 0.03853146232258446, 'f1-score': 0.06987540732221582, 'support': 473042}, '1': {'precision': 0.3269254097987778, 'recall': 0.7655243734105022, 'f1-score': 0.45818008907094465, 'support': 450614}, '2': {'precision': 0.3784161858034787, 'recall': 0.23392544143174154, 'f1-score': 0.28912348719023423, 'support': 471817}, 'accuracy': 0.3393494535544579, 'macro avg': {'precision': 0.3599785671339732, 'recall': 0.34599375905494273, 'f1-score': 0.27239299452779825, 'support': 1395473}, 'weighted avg': {'precision': 0.3604936112300206, 'recall': 0.3393494535544579, 'f1-score': 0.2693923432719694, 'support': 1395473}}
[[ 18227 362837  91978]
 [ 16343 344956  89315]
 [ 14088 347359 110370]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959822
{'0': {'precision': 0.34503702914380097, 'recall': 0.039574676118308484, 'f1-score': 0.0710052683803979, 'support': 163640}, '1': {'precision': 0.3625298042693258, 'recall': 0.7840502733086093, 'f1-score': 0.4958076591044922, 'support': 180931}, '2': {'precision': 0.36280455367592296, 'recall': 0.2138051676897129, 'f1-score': 0.2690536963322695, 'support': 159491}, 'accuracy': 0.3619296832532506, 'macro avg': {'precision': 0.35679046236301654, 'recall': 0.3458100390388769, 'f1-score': 0.2786222079390532, 'support': 504062}, 'weighted avg': {'precision': 0.3569378380748234, 'recall': 0.3619296832532506, 'f1-score': 0.28615114959852794, 'support': 504062}}
[[  6476 129007  28157]
 [  7339 141859  31733]
 [  4954 120437  34100]]
training model: results/universal/W6/deepOF_L1/h500
Epoch 1/50
9426/9426 - 132s - loss: 3.2454 - accuracy500: 0.3930 - val_loss: 3.3124 - val_accuracy500: 0.3249 - 132s/epoch - 14ms/step
Epoch 2/50
9426/9426 - 126s - loss: 3.2514 - accuracy500: 0.3902 - val_loss: 3.3123 - val_accuracy500: 0.3253 - 126s/epoch - 13ms/step
Epoch 3/50
9426/9426 - 128s - loss: 3.2500 - accuracy500: 0.3915 - val_loss: 3.3129 - val_accuracy500: 0.3261 - 128s/epoch - 14ms/step
Epoch 4/50
9426/9426 - 126s - loss: 3.2490 - accuracy500: 0.3925 - val_loss: 3.3136 - val_accuracy500: 0.3268 - 126s/epoch - 13ms/step
Epoch 5/50
9426/9426 - 128s - loss: 3.2482 - accuracy500: 0.3935 - val_loss: 3.3147 - val_accuracy500: 0.3270 - 128s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 130s - loss: 3.2476 - accuracy500: 0.3941 - val_loss: 3.3177 - val_accuracy500: 0.3273 - 130s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 126s - loss: 3.2467 - accuracy500: 0.3945 - val_loss: 3.3216 - val_accuracy500: 0.3272 - 126s/epoch - 13ms/step
Epoch 8/50
9426/9426 - 128s - loss: 3.2457 - accuracy500: 0.3955 - val_loss: 3.3252 - val_accuracy500: 0.3280 - 128s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 129s - loss: 3.2451 - accuracy500: 0.3959 - val_loss: 3.3282 - val_accuracy500: 0.3279 - 129s/epoch - 14ms/step
Epoch 10/50
9426/9426 - 127s - loss: 3.2442 - accuracy500: 0.3970 - val_loss: 3.3347 - val_accuracy500: 0.3279 - 127s/epoch - 14ms/step
Epoch 11/50
9426/9426 - 129s - loss: 3.2437 - accuracy500: 0.3970 - val_loss: 3.3343 - val_accuracy500: 0.3279 - 129s/epoch - 14ms/step
Epoch 12/50
9426/9426 - 126s - loss: 3.2431 - accuracy500: 0.3976 - val_loss: 3.3370 - val_accuracy500: 0.3281 - 126s/epoch - 13ms/step
testing model in sample: results/universal/W6/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 220s - 220s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102821
{'0': {'precision': 0.3242723248717347, 'recall': 0.40046900236054167, 'f1-score': 0.35836514230655203, 'support': 3283992}, '1': {'precision': 0.5279503105590062, 'recall': 0.00014276846530138424, 'f1-score': 0.0002854597365038715, 'support': 4167587}, '2': {'precision': 0.3255334620659139, 'recall': 0.6537519026440255, 'f1-score': 0.4346396420678131, 'support': 3367025}, 'accuracy': 0.32508177580027886, 'macro avg': {'precision': 0.39258536583221826, 'recall': 0.3514545578232895, 'f1-score': 0.2644300813702896, 'support': 10818604}, 'weighted avg': {'precision': 0.40312649180470406, 'recall': 0.32508177580027886, 'f1-score': 0.24416278473025113, 'support': 10818604}}
[[1315137     232 1968623]
 [1574993     595 2591999]
 [1165526     300 2201199]]
Evaluating performance on  train set...
9426/9426 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978593
{'0': {'precision': 0.35838055814225656, 'recall': 0.43814239072650824, 'f1-score': 0.3942678983884985, 'support': 810741}, '1': {'precision': 0.319634703196347, 'recall': 8.791451694740703e-05, 'f1-score': 0.00017578068597157124, 'support': 796228}, '2': {'precision': 0.35033115379471985, 'recall': 0.618149551489591, 'f1-score': 0.44720982960102174, 'support': 805221}, 'accuracy': 0.35363590761921737, 'macro avg': {'precision': 0.3427821383777745, 'recall': 0.35212661891101554, 'f1-score': 0.2805511695584973, 'support': 2412190}, 'weighted avg': {'precision': 0.34290413049352264, 'recall': 0.35363590761921737, 'f1-score': 0.2818566770911842, 'support': 2412190}}
[[355220     69 455452]
 [328567     70 467591]
 [307394     80 497747]]
Evaluating performance on  val set...
3323/3323 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028564
{'0': {'precision': 0.3242409542289693, 'recall': 0.4314938443193815, 'f1-score': 0.3702568046218967, 'support': 263334}, '1': {'precision': 0.46, 'recall': 0.00014130932303618442, 'f1-score': 0.00028253185393103155, 'support': 325527}, '2': {'precision': 0.326201881710748, 'recall': 0.6235613168755761, 'f1-score': 0.42833176781245275, 'support': 261437}, 'accuracy': 0.32540944468880323, 'macro avg': {'precision': 0.3701476119799058, 'recall': 0.3517321568393313, 'f1-score': 0.26629036809609347, 'support': 850298}, 'weighted avg': {'precision': 0.37681769072695015, 'recall': 0.32540944468880323, 'f1-score': 0.24647235382971777, 'support': 850298}}
[[113627     24 149683]
 [138428     46 187053]
 [ 98385     30 163022]]
testing model out of sample: results/universal/W6/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 110s - 110s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057884
{'0': {'precision': 0.3046152698479516, 'recall': 0.44212847311914444, 'f1-score': 0.3607103117101991, 'support': 1293002}, '1': {'precision': 0.47390396659707723, 'recall': 0.0001222050309711693, 'f1-score': 0.00024434705246949295, 'support': 1857534}, '2': {'precision': 0.3134799423605045, 'recall': 0.6125775711046605, 'f1-score': 0.4147275496155247, 'support': 1334582}, 'accuracy': 0.30978783612828026, 'macro avg': {'precision': 0.3639997262685111, 'recall': 0.35160941641825866, 'f1-score': 0.25856073612606445, 'support': 4485118}, 'weighted avg': {'precision': 0.3773647810978982, 'recall': 0.30978783612828026, 'f1-score': 0.22749478609942012, 'support': 4485118}}
[[ 571673     125  721204]
 [ 788112     227 1069195]
 [ 516920     127  817535]]
Evaluating performance on  train set...
5152/5152 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981534
{'0': {'precision': 0.36227205891337727, 'recall': 0.39519198085856533, 'f1-score': 0.3780166583612159, 'support': 450123}, '1': {'precision': 0.504, 'recall': 0.00029232778761226197, 'f1-score': 0.0005843166625316215, 'support': 431023}, '2': {'precision': 0.34553880295019906, 'recall': 0.6534846295923779, 'f1-score': 0.45205005068002957, 'support': 437464}, 'accuracy': 0.3518000015167487, 'macro avg': {'precision': 0.40393695395452545, 'recall': 0.34965631274618514, 'f1-score': 0.2768836752345924, 'support': 1318610}, 'weighted avg': {'precision': 0.40304818321419683, 'recall': 0.3518000015167487, 'f1-score': 0.2792042147435924, 'support': 1318610}}
[[177885     60 272178]
 [161617    126 269280]
 [151524     64 285876]]
Evaluating performance on  val set...
1795/1795 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017423
{'0': {'precision': 0.33278048039805413, 'recall': 0.3946355111708243, 'f1-score': 0.3610781080199096, 'support': 144394}, '1': {'precision': 0.5614035087719298, 'recall': 0.00018865811023529203, 'f1-score': 0.00037718946698413446, 'support': 169619}, '2': {'precision': 0.33054009228126663, 'recall': 0.6561680333526602, 'f1-score': 0.43962309960113305, 'support': 144876}, 'accuracy': 0.3314047623717282, 'macro avg': {'precision': 0.4082413604837502, 'recall': 0.3503307342112399, 'f1-score': 0.2670261323626756, 'support': 458889}, 'weighted avg': {'precision': 0.4165790264101414, 'recall': 0.3314047623717282, 'f1-score': 0.2525498039993135, 'support': 458889}}
[[ 56983      9  87402]
 [ 64453     32 105134]
 [ 49797     16  95063]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951276
{'0': {'precision': 0.33530068368913074, 'recall': 0.27624696807715743, 'f1-score': 0.30292258336957417, 'support': 86991}, '1': {'precision': 0.3, 'recall': 0.00025901303698952846, 'f1-score': 0.0005175792081038115, 'support': 81077}, '2': {'precision': 0.3878799129047471, 'recall': 0.7506553779831835, 'f1-score': 0.5114714404794982, 'support': 102994}, 'accuracy': 0.37395503611719827, 'macro avg': {'precision': 0.34106019886462596, 'recall': 0.3423871196991102, 'f1-score': 0.2716372010190587, 'support': 271062}, 'weighted avg': {'precision': 0.3447201951011676, 'recall': 0.37395503611719827, 'f1-score': 0.29171182888085934, 'support': 271062}}
[[24031    22 62938]
 [21985    21 59071]
 [25654    27 77313]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998473
{'0': {'precision': 0.36475834889027176, 'recall': 0.19309322499176457, 'f1-score': 0.25251292360712235, 'support': 18214}, '1': {'precision': 0.21428571428571427, 'recall': 0.00016707507239919803, 'f1-score': 0.000333889816360601, 'support': 17956}, '2': {'precision': 0.3341308714985441, 'recall': 0.8321434594412277, 'f1-score': 0.4768086065837788, 'support': 17789}, 'accuracy': 0.3395726384847755, 'macro avg': {'precision': 0.30439164489151005, 'recall': 0.3418012531684638, 'f1-score': 0.24321847333575394, 'support': 53959}, 'weighted avg': {'precision': 0.30458824154430764, 'recall': 0.3395726384847755, 'f1-score': 0.2425399658748594, 'support': 53959}}
[[ 3517     4 14693]
 [ 3146     3 14807]
 [ 2979     7 14803]]
Evaluating performance on  val set...
81/81 - 1s - 574ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098689
{'0': {'precision': 0.34449866903283055, 'recall': 0.22556281771968045, 'f1-score': 0.27262354077064865, 'support': 6885}, '1': {'precision': 0.3333333333333333, 'recall': 0.000149812734082397, 'f1-score': 0.0002994908655286014, 'support': 6675}, '2': {'precision': 0.3477829457364341, 'recall': 0.7925381571509327, 'f1-score': 0.48342743847247965, 'support': 7076}, 'accuracy': 0.3470633843768172, 'macro avg': {'precision': 0.34187164936753267, 'recall': 0.3394169292015652, 'f1-score': 0.2521168233695523, 'support': 20636}, 'weighted avg': {'precision': 0.34201325161475316, 'recall': 0.3470633843768172, 'f1-score': 0.25682034960092004, 'support': 20636}}
[[1553    1 5331]
 [1488    1 5186]
 [1467    1 5608]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0910491
{'0': {'precision': 0.3980629384130253, 'recall': 0.3139035072138685, 'f1-score': 0.3510091050700685, 'support': 197051}, '1': {'precision': 0.23728813559322035, 'recall': 9.094747783155227e-05, 'f1-score': 0.00018182526591945138, 'support': 153935}, '2': {'precision': 0.39273904503357515, 'recall': 0.7616195288783, 'f1-score': 0.5182405765600869, 'support': 208184}, 'accuracy': 0.394202121000769, 'macro avg': {'precision': 0.3426967063466069, 'recall': 0.35853799452333335, 'f1-score': 0.28981050229869165, 'support': 559170}, 'weighted avg': {'precision': 0.3518207961461402, 'recall': 0.394202121000769, 'f1-score': 0.3166909537815986, 'support': 559170}}
[[ 61855     10 135186]
 [ 43943     14 109978]
 [ 49592     35 158557]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933677
{'0': {'precision': 0.40736178537787116, 'recall': 0.353399685699319, 'f1-score': 0.3784669239745086, 'support': 47725}, '1': {'precision': 0.375, 'recall': 0.00013784230839919133, 'f1-score': 0.00027558331802314903, 'support': 43528}, '2': {'precision': 0.3612575380592924, 'recall': 0.7611622017859523, 'f1-score': 0.4899692571673697, 'support': 45018}, 'accuracy': 0.3752669313353538, 'macro avg': {'precision': 0.38120644114572116, 'recall': 0.37156657659789016, 'f1-score': 0.28957058815330045, 'support': 136271}, 'weighted avg': {'precision': 0.38179387437908374, 'recall': 0.3752669313353538, 'f1-score': 0.2944996775286817, 'support': 136271}}
[[16866     4 30855]
 [13791     6 29731]
 [10746     6 34266]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986309
{'0': {'precision': 0.3792089962302728, 'recall': 0.35947910357359175, 'f1-score': 0.36908056341531675, 'support': 16510}, '1': {'precision': 0.3333333333333333, 'recall': 0.00016959692464243314, 'f1-score': 0.00033902135834557577, 'support': 17689}, '2': {'precision': 0.32617313542915094, 'recall': 0.7580345664905014, 'f1-score': 0.4560943643512451, 'support': 14002}, 'accuracy': 0.34339536524138503, 'macro avg': {'precision': 0.346238488330919, 'recall': 0.3725610889962452, 'f1-score': 0.27517131637496917, 'support': 48201}, 'weighted avg': {'precision': 0.34696687005195137, 'recall': 0.34339536524138503, 'f1-score': 0.2590350893226445, 'support': 48201}}
[[ 5935     1 10574]
 [ 6333     3 11353]
 [ 3383     5 10614]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0934328
{'0': {'precision': 0.38804635418976247, 'recall': 0.4525161812995027, 'f1-score': 0.4178089004714823, 'support': 116029}, '1': {'precision': 0.35714285714285715, 'recall': 0.00011869577086968391, 'f1-score': 0.00023731267131008456, 'support': 84249}, '2': {'precision': 0.3715028684177511, 'recall': 0.5900157588711576, 'f1-score': 0.45592990215976376, 'support': 110414}, 'accuracy': 0.3787062428385668, 'macro avg': {'precision': 0.3722306932501236, 'recall': 0.34755021198051006, 'f1-score': 0.2913253717675187, 'support': 310692}, 'weighted avg': {'precision': 0.3737871484144751, 'recall': 0.3787062428385668, 'f1-score': 0.3181253025025394, 'support': 310692}}
[[52505     8 63516]
 [37543    10 46696]
 [45258    10 65146]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974317
{'0': {'precision': 0.37438935026868586, 'recall': 0.39144036775346897, 'f1-score': 0.3827250405759707, 'support': 46988}, '1': {'precision': 0.5294117647058824, 'recall': 0.00022264552358805631, 'f1-score': 0.00044510385756676556, 'support': 40423}, '2': {'precision': 0.3435433600195563, 'recall': 0.6454109164389539, 'f1-score': 0.4484062410261319, 'support': 43549}, 'accuracy': 0.3551389737324374, 'macro avg': {'precision': 0.4157814916647082, 'recall': 0.345691309905337, 'f1-score': 0.27719212848655644, 'support': 130960}, 'weighted avg': {'precision': 0.4119821956370079, 'recall': 0.3551389737324374, 'f1-score': 0.2865693343789336, 'support': 130960}}
[[18393     3 28592]
 [15298     9 25116]
 [15437     5 28107]]
Evaluating performance on  val set...
169/169 - 1s - 989ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970235
{'0': {'precision': 0.3538975644238802, 'recall': 0.38336233901844763, 'f1-score': 0.36804116821493016, 'support': 14365}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13650}, '2': {'precision': 0.3643646909552293, 'recall': 0.6642654153724142, 'f1-score': 0.4705964977994194, 'support': 15131}, 'accuracy': 0.3605896259212905, 'macro avg': {'precision': 0.23942075179303648, 'recall': 0.34920925146362064, 'f1-score': 0.27954588867144986, 'support': 43146}, 'weighted avg': {'precision': 0.2456065603252356, 'recall': 0.3605896259212905, 'f1-score': 0.28757027278566927, 'support': 43146}}
[[ 5507     0  8858]
 [ 4974     0  8676]
 [ 5080     0 10051]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0890934
{'0': {'precision': 0.39222653775170097, 'recall': 0.42857142857142855, 'f1-score': 0.4095943082336923, 'support': 99673}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69251}, '2': {'precision': 0.4116478650254421, 'recall': 0.633888089240734, 'f1-score': 0.49914816900610265, 'support': 111160}, 'accuracy': 0.40409305779694665, 'macro avg': {'precision': 0.2679581342590477, 'recall': 0.35415317260405416, 'f1-score': 0.30291415907993163, 'support': 280084}, 'weighted avg': {'precision': 0.3029561573440591, 'recall': 0.40409305779694665, 'f1-score': 0.3438639977695805, 'support': 280084}}
[[42717     0 56956]
 [25497     0 43754]
 [40695     2 70463]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097803
{'0': {'precision': 0.34791012823976886, 'recall': 0.45987527129866207, 'f1-score': 0.39613309352517984, 'support': 36399}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 37782}, '2': {'precision': 0.36354194888467445, 'recall': 0.5981130206527661, 'f1-score': 0.4522186856393933, 'support': 40382}, 'accuracy': 0.35693897680752074, 'macro avg': {'precision': 0.23715069237481443, 'recall': 0.35266276398380936, 'f1-score': 0.28278392638819105, 'support': 114563}, 'weighted avg': {'precision': 0.2386820503797934, 'recall': 0.35693897680752074, 'f1-score': 0.2852608908173931, 'support': 114563}}
[[16739     2 19658]
 [15155     0 22627]
 [16219    10 24153]]
Evaluating performance on  val set...
136/136 - 1s - 798ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0949394
{'0': {'precision': 0.34777236218850827, 'recall': 0.4394898932940054, 'f1-score': 0.3882884954395646, 'support': 11527}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10034}, '2': {'precision': 0.39296144137009353, 'recall': 0.600893127459885, 'f1-score': 0.475175819242855, 'support': 13212}, 'accuracy': 0.37399706668967303, 'macro avg': {'precision': 0.24691126785286724, 'recall': 0.3467943402512968, 'f1-score': 0.28782143822747325, 'support': 34773}, 'weighted avg': {'precision': 0.26458972715407386, 'recall': 0.37399706668967303, 'f1-score': 0.3092578843001312, 'support': 34773}}
[[5066    2 6459]
 [4229    0 5805]
 [5272    1 7939]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
1722/1722 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954756
{'0': {'precision': 0.35164250292984245, 'recall': 0.4605763236743148, 'f1-score': 0.3988043762152123, 'support': 149187}, '1': {'precision': 0.14285714285714285, 'recall': 7.728273890026662e-06, 'f1-score': 1.54557116582433e-05, 'support': 129395}, '2': {'precision': 0.38063606429107033, 'recall': 0.5758020368406777, 'f1-score': 0.4583067547277206, 'support': 162212}, 'accuracy': 0.36777950698058504, 'macro avg': {'precision': 0.2917119033593519, 'recall': 0.3454620295962942, 'f1-score': 0.2857088622181971, 'support': 440794}, 'weighted avg': {'precision': 0.30102321570932794, 'recall': 0.36777950698058504, 'f1-score': 0.30363680917644503, 'support': 440794}}
[[68712     5 80470]
 [57882     1 71512]
 [68809     1 93402]]
Evaluating performance on  train set...
617/617 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988597
{'0': {'precision': 0.3573359769286229, 'recall': 0.4388570163625966, 'f1-score': 0.39392308647596963, 'support': 54209}, '1': {'precision': 0.5726495726495726, 'recall': 0.0013064503548865143, 'f1-score': 0.002606953172117274, 'support': 51284}, '2': {'precision': 0.33957198742041883, 'recall': 0.5907279971024991, 'f1-score': 0.4312473037476169, 'support': 52459}, 'accuracy': 0.3472320705024311, 'macro avg': {'precision': 0.42318584566620476, 'recall': 0.34363048793999407, 'f1-score': 0.2759257811319013, 'support': 157952}, 'weighted avg': {'precision': 0.4213444182104193, 'recall': 0.3472320705024311, 'f1-score': 0.2792663207085123, 'support': 157952}}
[[23790    31 30388]
 [21335    67 29882]
 [21451    19 30989]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981787
{'0': {'precision': 0.34662428582924276, 'recall': 0.4452426481988733, 'f1-score': 0.3897925480171029, 'support': 19349}, '1': {'precision': 0.4, 'recall': 0.00011018676656933502, 'f1-score': 0.00022031284423881914, 'support': 18151}, '2': {'precision': 0.3561652243294666, 'recall': 0.5819002256204563, 'f1-score': 0.44187241819116335, 'support': 19945}, 'accuracy': 0.3520410827748281, 'macro avg': {'precision': 0.3675965033862365, 'recall': 0.34241768686196633, 'f1-score': 0.2772950930175017, 'support': 57445}, 'weighted avg': {'precision': 0.36680213605642314, 'recall': 0.3520410827748281, 'f1-score': 0.2847809259437976, 'support': 57445}}
[[ 8615     2 10732]
 [ 7901     2 10248]
 [ 8338     1 11606]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/EXC
Evaluating performance on  test set...
4450/4450 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1136304
{'0': {'precision': 0.26565010149271784, 'recall': 0.5070763991356079, 'f1-score': 0.34864831679877367, 'support': 277189}, '1': {'precision': 0.8117977528089888, 'recall': 0.000493989227958081, 'f1-score': 0.0009873776241097801, 'support': 585033}, '2': {'precision': 0.26254555832942406, 'recall': 0.5780659747051218, 'f1-score': 0.361091058392514, 'support': 276894}, 'accuracy': 0.26415922522377, 'macro avg': {'precision': 0.44666447087704353, 'recall': 0.36187878768956255, 'f1-score': 0.23690891760513247, 'support': 1139116}, 'weighted avg': {'precision': 0.5453887492843869, 'recall': 0.26415922522377, 'f1-score': 0.17311939635755963, 'support': 1139116}}
[[140556     37 136596]
 [271745    289 312999]
 [116801     30 160063]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954248
{'0': {'precision': 0.36691511433855034, 'recall': 0.5078583468597827, 'f1-score': 0.4260323653408049, 'support': 128144}, '1': {'precision': 0.42424242424242425, 'recall': 0.0002193016807907392, 'f1-score': 0.000438376753507014, 'support': 127678}, '2': {'precision': 0.3641843150869884, 'recall': 0.5854910229774567, 'f1-score': 0.4490516677567037, 'support': 128996}, 'accuracy': 0.36545327921251086, 'macro avg': {'precision': 0.3851139512226543, 'recall': 0.36452289050601006, 'f1-score': 0.29184080328367185, 'support': 384818}, 'weighted avg': {'precision': 0.3850202292075334, 'recall': 0.36545327921251086, 'f1-score': 0.29254175071153143, 'support': 384818}}
[[65079    19 63046]
 [58838    28 68812]
 [53451    19 75526]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097775
{'0': {'precision': 0.27013847591538526, 'recall': 0.4968592768524016, 'f1-score': 0.3499900939969621, 'support': 31999}, '1': {'precision': 0.6451612903225806, 'recall': 0.0003212128999100604, 'f1-score': 0.0006421061080343528, 'support': 62264}, '2': {'precision': 0.2993507853403141, 'recall': 0.5915084970205253, 'f1-score': 0.39752301317289773, 'support': 36248}, 'accuracy': 0.2862593957597444, 'macro avg': {'precision': 0.40488351719276, 'recall': 0.36289632892427903, 'f1-score': 0.2493850710926314, 'support': 130511}, 'weighted avg': {'precision': 0.45716721914993586, 'recall': 0.2862593957597444, 'f1-score': 0.19652540624170098, 'support': 130511}}
[[15899     5 16095]
 [28155    20 34089]
 [14801     6 21441]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/AAL
Evaluating performance on  test set...
6203/6203 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179738
{'0': {'precision': 0.23182251318421532, 'recall': 0.47329230549895746, 'f1-score': 0.3112111923457386, 'support': 336682}, '1': {'precision': 0.6831683168316832, 'recall': 7.817580719353385e-05, 'f1-score': 0.00015633372492288106, 'support': 882626}, '2': {'precision': 0.24759410612921245, 'recall': 0.6048713781436451, 'f1-score': 0.35136340639613406, 'support': 368561}, 'accuracy': 0.24079442321753242, 'macro avg': {'precision': 0.38752831204837035, 'recall': 0.359413953149932, 'f1-score': 0.2209103108222652, 'support': 1587869}, 'weighted avg': {'precision': 0.4863663926588767, 'recall': 0.24079442321753242, 'f1-score': 0.14762933169953396, 'support': 1587869}}
[[159349     16 177317]
 [382413     69 500144]
 [145613     16 222932]]
Evaluating performance on  train set...
1766/1766 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972408
{'0': {'precision': 0.37151046607860155, 'recall': 0.35360683454158875, 'f1-score': 0.3623376239865342, 'support': 156148}, '1': {'precision': 0.3793103448275862, 'recall': 7.466789755564455e-05, 'f1-score': 0.00014930640388739581, 'support': 147319}, '2': {'precision': 0.3481639232932349, 'recall': 0.7110798400237002, 'f1-score': 0.4674511296665553, 'support': 148522}, 'accuracy': 0.35584273068592376, 'macro avg': {'precision': 0.3663282447331409, 'recall': 0.35492044748761487, 'f1-score': 0.27664602001899224, 'support': 451989}, 'weighted avg': {'precision': 0.36638112689081925, 'recall': 0.35584273068592376, 'f1-score': 0.2788277317826313, 'support': 451989}}
[[ 55215      7 100926]
 [ 50508     11  96800]
 [ 42900     11 105611]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042283
{'0': {'precision': 0.316946174039442, 'recall': 0.3319322003090066, 'f1-score': 0.32426613395483045, 'support': 44012}, '1': {'precision': 0.5151515151515151, 'recall': 0.00027832351015062213, 'f1-score': 0.0005563464402009392, 'support': 61080}, '2': {'precision': 0.31591234575167243, 'recall': 0.7493252675663099, 'f1-score': 0.4444475111436181, 'support': 42980}, 'accuracy': 0.3162785671835323, 'macro avg': {'precision': 0.38267001164754316, 'recall': 0.36051193046182234, 'f1-score': 0.25642333051288313, 'support': 148072}, 'weighted avg': {'precision': 0.3984061954838548, 'recall': 0.3162785671835323, 'f1-score': 0.22561954155505548, 'support': 148072}}
[[14609     6 29397]
 [20720    17 40343]
 [10764    10 32206]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/WBA
Evaluating performance on  test set...
5183/5183 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960134
{'0': {'precision': 0.3505523888190664, 'recall': 0.47116134620261946, 'f1-score': 0.40200553645650455, 'support': 417946}, '1': {'precision': 0.4312977099236641, 'recall': 0.0002528999568055826, 'f1-score': 0.0005055035016182821, 'support': 446817}, '2': {'precision': 0.3720835060294366, 'recall': 0.6158802091448952, 'f1-score': 0.4639013842170082, 'support': 462072}, 'accuracy': 0.362979571687512, 'macro avg': {'precision': 0.3846445349240557, 'recall': 0.3624314851014401, 'f1-score': 0.28880414139171035, 'support': 1326835}, 'weighted avg': {'precision': 0.3852419384101032, 'recall': 0.362979571687512, 'f1-score': 0.2883541012302617, 'support': 1326835}}
[[196920     57 220969]
 [187423    113 259281]
 [177399     92 284581]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986912
{'0': {'precision': 0.3643507792754844, 'recall': 0.4267400538069579, 'f1-score': 0.39308525557500384, 'support': 129723}, '1': {'precision': 0.3333333333333333, 'recall': 8.585901948999742e-05, 'f1-score': 0.00017167381974248926, 'support': 128117}, '2': {'precision': 0.3381726437825191, 'recall': 0.6287198214648002, 'f1-score': 0.43979212138930124, 'support': 123225}, 'accuracy': 0.3486098172227835, 'macro avg': {'precision': 0.345285585463779, 'recall': 0.35184857809708275, 'f1-score': 0.27768301692801584, 'support': 381065}, 'weighted avg': {'precision': 0.3454572496469664, 'recall': 0.3486098172227835, 'f1-score': 0.27608827129732944, 'support': 381065}}
[[55358    11 74354]
 [50838    11 77268]
 [45740    11 77474]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003648
{'0': {'precision': 0.3413191247624831, 'recall': 0.40945622033181367, 'f1-score': 0.37229575975129, 'support': 42554}, '1': {'precision': 0.6428571428571429, 'recall': 0.00018780518342306247, 'f1-score': 0.00037550066755674227, 'support': 47922}, '2': {'precision': 0.33782195671334836, 'recall': 0.6527735068007097, 'f1-score': 0.44522962496874063, 'support': 42275}, 'accuracy': 0.3391989514203283, 'macro avg': {'precision': 0.44066607477765807, 'recall': 0.3541391774386488, 'f1-score': 0.2726336284625291, 'support': 132751}, 'weighted avg': {'precision': 0.44905814084413304, 'recall': 0.3391989514203283, 'f1-score': 0.26126169218311396, 'support': 132751}}
[[17424     2 25128]
 [18949     9 28964]
 [14676     3 27596]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
7324/7324 - 38s - 38s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014812
{'0': {'precision': 0.33913713189831235, 'recall': 0.4417170297609884, 'f1-score': 0.38368918023169707, 'support': 604113}, '1': {'precision': 0.4365079365079365, 'recall': 0.0001617202328183279, 'f1-score': 0.0003233206797376399, 'support': 680187}, '2': {'precision': 0.3299083861097013, 'recall': 0.6077411793001706, 'f1-score': 0.4276627836918634, 'support': 590401}, 'accuracy': 0.3337961626947444, 'macro avg': {'precision': 0.3685178181719834, 'recall': 0.34987330976465914, 'f1-score': 0.2705584282010994, 'support': 1874701}, 'weighted avg': {'precision': 0.37155920599581627, 'recall': 0.3337961626947444, 'f1-score': 0.2584433866600379, 'support': 1874701}}
[[266847     67 337199]
 [288479    110 391598]
 [231515     75 358811]]
Evaluating performance on  train set...
2046/2046 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987067
{'0': {'precision': 0.3538468638944016, 'recall': 0.4391970853096858, 'f1-score': 0.39192912681413167, 'support': 174564}, '1': {'precision': 0.5352112676056338, 'recall': 0.000218339356818221, 'f1-score': 0.0004365006432641058, 'support': 174041}, '2': {'precision': 0.346787879182695, 'recall': 0.6078791858174656, 'f1-score': 0.44163068231311997, 'support': 175145}, 'accuracy': 0.34973365155131264, 'macro avg': {'precision': 0.4119486702275768, 'recall': 0.34909820349465653, 'f1-score': 0.27799876992350525, 'support': 523750}, 'weighted avg': {'precision': 0.4117533007611791, 'recall': 0.34973365155131264, 'f1-score': 0.27845745289807694, 'support': 523750}}
[[ 76668     15  97881]
 [ 71342     38 102661]
 [ 68660     18 106467]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023828
{'0': {'precision': 0.33354443740764195, 'recall': 0.44929160463676965, 'f1-score': 0.3828610525115457, 'support': 59783}, '1': {'precision': 0.5294117647058824, 'recall': 0.0002569116366698543, 'f1-score': 0.0005135740473914718, 'support': 70063}, '2': {'precision': 0.3253506012272189, 'recall': 0.5937332619175147, 'f1-score': 0.42035657784809, 'support': 59744}, 'accuracy': 0.32886755630571235, 'macro avg': {'precision': 0.3961022677802477, 'recall': 0.34776059273031806, 'f1-score': 0.2679104014690091, 'support': 189590}, 'weighted avg': {'precision': 0.40334516531382597, 'recall': 0.32886755630571235, 'f1-score': 0.2533801794806499, 'support': 189590}}
[[26860     6 32917]
 [29407    18 40638]
 [24262    10 35472]]
testing model on single stock: results/universal/W6/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
29350/29350 - 168s - 168s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037796
{'0': {'precision': 0.32324756541489064, 'recall': 0.380744921869717, 'f1-score': 0.3496482455748494, 'support': 2292133}, '1': {'precision': 0.3818615751789976, 'recall': 5.493466037161238e-05, 'f1-score': 0.00010985351720065776, 'support': 2912551}, '2': {'precision': 0.31743794482433074, 'recall': 0.6617845857977273, 'f1-score': 0.4290659829867263, 'support': 2308715}, 'accuracy': 0.31952915052162145, 'macro avg': {'precision': 0.3408490284727397, 'recall': 0.3475281474426053, 'f1-score': 0.25960802735959215, 'support': 7513399}, 'weighted avg': {'precision': 0.3441839664433366, 'recall': 0.31952915052162145, 'f1-score': 0.23855398960667368, 'support': 7513399}}
[[ 872718     124 1419291]
 [1046418     160 1865973]
 [ 780708     135 1527872]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098797
{'0': {'precision': 0.3515439180864468, 'recall': 0.4291370666666667, 'f1-score': 0.3864844379675358, 'support': 468750}, '1': {'precision': 0.3119266055045872, 'recall': 7.405422947663262e-05, 'f1-score': 0.0001480733049961675, 'support': 459123}, '2': {'precision': 0.34769319359388495, 'recall': 0.6120701454234388, 'f1-score': 0.4434689572194792, 'support': 467600}, 'accuracy': 0.34926938751233455, 'macro avg': {'precision': 0.33705457239497294, 'recall': 0.3470937554398607, 'f1-score': 0.27670048949733705, 'support': 1395473}, 'weighted avg': {'precision': 0.33721915639113414, 'recall': 0.34926938751233455, 'f1-score': 0.27847091885914, 'support': 1395473}}
[[201158     40 267552]
 [189694     34 269395]
 [181361     35 286204]]
Evaluating performance on  val set...
1969/1969 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026754
{'0': {'precision': 0.32956016755521705, 'recall': 0.43070969989548596, 'f1-score': 0.37340625202252276, 'support': 160744}, '1': {'precision': 0.3548387096774194, 'recall': 5.8629768998710146e-05, 'f1-score': 0.00011724016648103639, 'support': 187618}, '2': {'precision': 0.32491809859466375, 'recall': 0.6134232498394349, 'f1-score': 0.42481835912741217, 'support': 155700}, 'accuracy': 0.3268546329618182, 'macro avg': {'precision': 0.3364389919424334, 'recall': 0.3480638598346399, 'f1-score': 0.2661139504388053, 'support': 504062}, 'weighted avg': {'precision': 0.3375352566885482, 'recall': 0.3268546329618182, 'f1-score': 0.25034426212807415, 'support': 504062}}
[[ 69234      6  91504]
 [ 80670     11 106937]
 [ 60176     14  95510]]
training model: results/universal/W6/deepOF_L1/h1000
Epoch 1/50
9426/9426 - 130s - loss: 3.2435 - accuracy1000: 0.3881 - val_loss: 3.2924 - val_accuracy1000: 0.3624 - 130s/epoch - 14ms/step
Epoch 2/50
9426/9426 - 125s - loss: 3.2449 - accuracy1000: 0.3869 - val_loss: 3.2914 - val_accuracy1000: 0.3604 - 125s/epoch - 13ms/step
Epoch 3/50
9426/9426 - 125s - loss: 3.2430 - accuracy1000: 0.3896 - val_loss: 3.2914 - val_accuracy1000: 0.3592 - 125s/epoch - 13ms/step
Epoch 4/50
9426/9426 - 130s - loss: 3.2415 - accuracy1000: 0.3915 - val_loss: 3.2908 - val_accuracy1000: 0.3589 - 130s/epoch - 14ms/step
Epoch 5/50
9426/9426 - 128s - loss: 3.2411 - accuracy1000: 0.3927 - val_loss: 3.2908 - val_accuracy1000: 0.3587 - 128s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 127s - loss: 3.2398 - accuracy1000: 0.3934 - val_loss: 3.2908 - val_accuracy1000: 0.3593 - 127s/epoch - 13ms/step
Epoch 7/50
9426/9426 - 130s - loss: 3.2393 - accuracy1000: 0.3936 - val_loss: 3.2903 - val_accuracy1000: 0.3582 - 130s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 130s - loss: 3.2386 - accuracy1000: 0.3944 - val_loss: 3.2897 - val_accuracy1000: 0.3597 - 130s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 127s - loss: 3.2380 - accuracy1000: 0.3954 - val_loss: 3.2894 - val_accuracy1000: 0.3588 - 127s/epoch - 13ms/step
Epoch 10/50
9426/9426 - 131s - loss: 3.2373 - accuracy1000: 0.3955 - val_loss: 3.2886 - val_accuracy1000: 0.3602 - 131s/epoch - 14ms/step
Epoch 11/50
9426/9426 - 127s - loss: 3.2369 - accuracy1000: 0.3960 - val_loss: 3.2883 - val_accuracy1000: 0.3607 - 127s/epoch - 13ms/step
Epoch 12/50
9426/9426 - 125s - loss: 3.2361 - accuracy1000: 0.3968 - val_loss: 3.2881 - val_accuracy1000: 0.3611 - 125s/epoch - 13ms/step
Epoch 13/50
9426/9426 - 126s - loss: 3.2351 - accuracy1000: 0.3976 - val_loss: 3.2878 - val_accuracy1000: 0.3622 - 126s/epoch - 13ms/step
Epoch 14/50
9426/9426 - 128s - loss: 3.2347 - accuracy1000: 0.3980 - val_loss: 3.2885 - val_accuracy1000: 0.3622 - 128s/epoch - 14ms/step
Epoch 15/50
9426/9426 - 126s - loss: 3.2347 - accuracy1000: 0.3982 - val_loss: 3.2890 - val_accuracy1000: 0.3628 - 126s/epoch - 13ms/step
Epoch 16/50
9426/9426 - 125s - loss: 3.2346 - accuracy1000: 0.3980 - val_loss: 3.2886 - val_accuracy1000: 0.3628 - 125s/epoch - 13ms/step
Epoch 17/50
9426/9426 - 126s - loss: 3.2339 - accuracy1000: 0.3984 - val_loss: 3.2890 - val_accuracy1000: 0.3636 - 126s/epoch - 13ms/step
Epoch 18/50
9426/9426 - 129s - loss: 3.2329 - accuracy1000: 0.3995 - val_loss: 3.2902 - val_accuracy1000: 0.3637 - 129s/epoch - 14ms/step
Epoch 19/50
9426/9426 - 124s - loss: 3.2321 - accuracy1000: 0.3998 - val_loss: 3.2931 - val_accuracy1000: 0.3639 - 124s/epoch - 13ms/step
Epoch 20/50
9426/9426 - 126s - loss: 3.2313 - accuracy1000: 0.4004 - val_loss: 3.2944 - val_accuracy1000: 0.3639 - 126s/epoch - 13ms/step
Epoch 21/50
9426/9426 - 129s - loss: 3.2300 - accuracy1000: 0.4013 - val_loss: 3.2986 - val_accuracy1000: 0.3640 - 129s/epoch - 14ms/step
Epoch 22/50
9426/9426 - 126s - loss: 3.2296 - accuracy1000: 0.4016 - val_loss: 3.3035 - val_accuracy1000: 0.3639 - 126s/epoch - 13ms/step
Epoch 23/50
9426/9426 - 127s - loss: 3.2287 - accuracy1000: 0.4020 - val_loss: 3.3019 - val_accuracy1000: 0.3637 - 127s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 220s - 220s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0929288
{'0': {'precision': 0.35151351107502143, 'recall': 0.004760144783664493, 'f1-score': 0.009393089714132791, 'support': 3273850}, '1': {'precision': 0.3831962057111844, 'recall': 0.9677981622635053, 'f1-score': 0.5490127752783943, 'support': 4149670}, '2': {'precision': 0.3388479245424262, 'recall': 0.02933152758517904, 'f1-score': 0.05398958137648683, 'support': 3395084}, 'accuracy': 0.3818616523906412, 'macro avg': {'precision': 0.357852547109544, 'recall': 0.3339632782107829, 'f1-score': 0.20413181545633796, 'support': 10818604}, 'weighted avg': {'precision': 0.35969127571669024, 'recall': 0.3818616523906412, 'f1-score': 0.2303691468740437, 'support': 10818604}}
[[  15584 3181056   77210]
 [  16533 4016043  117094]
 [  12217 3283284   99583]]
Evaluating performance on  train set...
9426/9426 - 53s - 53s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017736
{'0': {'precision': 0.3730254189720151, 'recall': 0.005753317247460662, 'f1-score': 0.011331858795100895, 'support': 808577}, '1': {'precision': 0.3285214206960031, 'recall': 0.9616054438913743, 'f1-score': 0.4897316616645172, 'support': 793550}, '2': {'precision': 0.35862077928829506, 'recall': 0.03406278277121656, 'f1-score': 0.062216109266576856, 'support': 810063}, 'accuracy': 0.3297115898830523, 'macro avg': {'precision': 0.3533892063187711, 'recall': 0.3338071813033505, 'f1-score': 0.1877598765753983, 'support': 2412190}, 'weighted avg': {'precision': 0.35354734574061847, 'recall': 0.3297115898830523, 'f1-score': 0.18580137079734804, 'support': 2412190}}
[[  4652 780720  23205]
 [  4324 763082  26144]
 [  3495 778975  27593]]
Evaluating performance on  val set...
3323/3323 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0958874
{'0': {'precision': 0.3580933465739821, 'recall': 0.006673007812933718, 'f1-score': 0.013101864635865537, 'support': 270193}, '1': {'precision': 0.36290041166724013, 'recall': 0.9608682449021787, 'f1-score': 0.5268284301830245, 'support': 309544}, '2': {'precision': 0.33780045969846895, 'recall': 0.03204822572358913, 'f1-score': 0.058542348850555315, 'support': 270561}, 'accuracy': 0.3621142234840021, 'macro avg': {'precision': 0.3529314059798971, 'recall': 0.3331964928129005, 'f1-score': 0.19949088122314843, 'support': 850298}, 'weighted avg': {'precision': 0.35338621377030827, 'recall': 0.3621142234840021, 'f1-score': 0.21457875727272985, 'support': 850298}}
[[  1803 261583   6807]
 [  1922 297431  10191]
 [  1310 260580   8671]]
testing model out of sample: results/universal/W6/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 110s - 110s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957578
{'0': {'precision': 0.30014064697609, 'recall': 0.006980628990800079, 'f1-score': 0.013643929389148933, 'support': 1375664}, '1': {'precision': 0.3684494306834741, 'recall': 0.9579776649599404, 'f1-score': 0.5322061444933909, 'support': 1659903}, '2': {'precision': 0.3205251430818297, 'recall': 0.03036733443666349, 'f1-score': 0.05547850033241224, 'support': 1449551}, 'accuracy': 0.3664947053789889, 'macro avg': {'precision': 0.3297050735804646, 'recall': 0.331775209462468, 'f1-score': 0.20044285807165066, 'support': 4485118}, 'weighted avg': {'precision': 0.3320092225000359, 'recall': 0.3664947053789889, 'f1-score': 0.21907984449407034, 'support': 4485118}}
[[   9603 1328568   37493]
 [  13931 1590150   55822]
 [   8461 1397071   44019]]
Evaluating performance on  train set...
5152/5152 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019698
{'0': {'precision': 0.34702549575070823, 'recall': 0.006021848472863696, 'f1-score': 0.0118382703386536, 'support': 447537}, '1': {'precision': 0.3310250368072249, 'recall': 0.9571025872202504, 'f1-score': 0.4919154177786903, 'support': 438115}, '2': {'precision': 0.3354870888027387, 'recall': 0.034178834898535196, 'f1-score': 0.062037407743566426, 'support': 432958}, 'accuracy': 0.3312685327731475, 'macro avg': {'precision': 0.33784587378689057, 'recall': 0.3324344235305498, 'f1-score': 0.18859703195363678, 'support': 1318610}, 'weighted avg': {'precision': 0.3379206909445842, 'recall': 0.3312685327731475, 'f1-score': 0.18782898600382217, 'support': 1318610}}
[[  2695 431505  13337]
 [  2820 419321  15974]
 [  2251 415909  14798]]
Evaluating performance on  val set...
1795/1795 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970578
{'0': {'precision': 0.2852852852852853, 'recall': 0.007105025190543858, 'f1-score': 0.0138647490414085, 'support': 147079}, '1': {'precision': 0.3596745430227374, 'recall': 0.9521638856606068, 'f1-score': 0.5221208694144742, 'support': 166067}, '2': {'precision': 0.33260674445441724, 'recall': 0.0355969068840356, 'f1-score': 0.06431099348584675, 'support': 145743}, 'accuracy': 0.35816068809668566, 'macro avg': {'precision': 0.3258555242541466, 'recall': 0.3316219392450621, 'f1-score': 0.2000988706472432, 'support': 458889}, 'weighted avg': {'precision': 0.32723523895245155, 'recall': 0.35816068809668566, 'f1-score': 0.21381889077516036, 'support': 458889}}
[[  1045 141791   4243]
 [  1777 158123   6167]
 [   841 139714   5188]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024832
{'0': {'precision': 0.2594262295081967, 'recall': 0.0078068152387060176, 'f1-score': 0.015157501526525629, 'support': 81083}, '1': {'precision': 0.32379343556712664, 'recall': 0.9795470066014114, 'f1-score': 0.4867045942950211, 'support': 87860}, '2': {'precision': 0.40976645435244163, 'recall': 0.01133971151303871, 'f1-score': 0.022068702653771022, 'support': 102119}, 'accuracy': 0.3241103511373782, 'macro avg': {'precision': 0.33099537314258837, 'recall': 0.332897844451052, 'f1-score': 0.17464359949177258, 'support': 271062}, 'weighted avg': {'precision': 0.33692841035688453, 'recall': 0.3241103511373782, 'f1-score': 0.1706049361302443, 'support': 271062}}
[[   633  79709    741]
 [   870  86063    927]
 [   937 100024   1158]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009612
{'0': {'precision': 0.33970276008492567, 'recall': 0.008623012665049851, 'f1-score': 0.016819089666771786, 'support': 18555}, '1': {'precision': 0.33838900249943193, 'recall': 0.9788038120276044, 'f1-score': 0.5029126213592232, 'support': 18258}, '2': {'precision': 0.3121301775147929, 'recall': 0.012306077219176485, 'f1-score': 0.023678599483784087, 'support': 17146}, 'accuracy': 0.3380714987305176, 'macro avg': {'precision': 0.33007398003305016, 'recall': 0.3332443006372769, 'f1-score': 0.18113677016992635, 'support': 53959}, 'weighted avg': {'precision': 0.3304967687443997, 'recall': 0.3380714987305176, 'f1-score': 0.1834772719341094, 'support': 53959}}
[[  160 18153   242]
 [  164 17871   223]
 [  147 16788   211]]
Evaluating performance on  val set...
81/81 - 1s - 585ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997462
{'0': {'precision': 0.2945205479452055, 'recall': 0.006353427895981087, 'f1-score': 0.012438530517789991, 'support': 6768}, '1': {'precision': 0.3466186553544123, 'recall': 0.9811505166154706, 'f1-score': 0.5122653544742118, 'support': 7162}, '2': {'precision': 0.3640552995391705, 'recall': 0.011780495079033702, 'f1-score': 0.022822475805286725, 'support': 6706}, 'accuracy': 0.34643341732893973, 'macro avg': {'precision': 0.3350648342795961, 'recall': 0.33309481319682843, 'f1-score': 0.18250878693242953, 'support': 20636}, 'weighted avg': {'precision': 0.33519832898096186, 'recall': 0.34643341732893973, 'f1-score': 0.18928454962390778, 'support': 20636}}
[[  43 6666   59]
 [  56 7027   79]
 [  47 6580   79]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0860785
{'0': {'precision': 0.31815440289505426, 'recall': 0.007155889873907116, 'f1-score': 0.013996961796918015, 'support': 147431}, '1': {'precision': 0.4268502836076444, 'recall': 0.9662467544956246, 'f1-score': 0.5921234342052334, 'support': 239177}, '2': {'precision': 0.323474406040036, 'recall': 0.027062736871385357, 'f1-score': 0.04994679115931101, 'support': 172562}, 'accuracy': 0.423536670422233, 'macro avg': {'precision': 0.3561596975142449, 'recall': 0.333488460413639, 'f1-score': 0.21868906238715413, 'support': 559170}, 'weighted avg': {'precision': 0.36628929039599223, 'recall': 0.423536670422233, 'f1-score': 0.2723765775589169, 'support': 559170}}
[[  1055 143099   3277]
 [  1583 231104   6490]
 [   678 167214   4670]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101697
{'0': {'precision': 0.4206471494607088, 'recall': 0.011402318053670252, 'f1-score': 0.02220279364821178, 'support': 47885}, '1': {'precision': 0.3191817065824889, 'recall': 0.960886032365431, 'f1-score': 0.4791890839991758, 'support': 43565}, '2': {'precision': 0.4079016221873365, 'recall': 0.0347828027040896, 'f1-score': 0.06409966490553624, 'support': 44821}, 'accuracy': 0.32263651106985347, 'macro avg': {'precision': 0.38257682607684473, 'recall': 0.33569038437439697, 'f1-score': 0.18849718085097458, 'support': 136271}, 'weighted avg': {'precision': 0.3840171306239095, 'recall': 0.32263651106985347, 'f1-score': 0.18207883041145775, 'support': 136271}}
[[  546 46336  1003]
 [  444 41861  1260]
 [  308 42954  1559]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079534
{'0': {'precision': 0.5133858267716536, 'recall': 0.016518875095008868, 'f1-score': 0.032007854688267064, 'support': 19735}, '1': {'precision': 0.27545233012011816, 'recall': 0.9623295411738115, 'f1-score': 0.4283079605660251, 'support': 13273}, '2': {'precision': 0.4276150627615063, 'recall': 0.03363391035345225, 'f1-score': 0.06236270441786674, 'support': 15193}, 'accuracy': 0.2823592871517188, 'macro avg': {'precision': 0.4054844065510927, 'recall': 0.33749410887409087, 'f1-score': 0.17422617322405298, 'support': 48201}, 'weighted avg': {'precision': 0.4208315951444675, 'recall': 0.2823592871517188, 'f1-score': 0.1507039924708295, 'support': 48201}}
[[  326 19024   385]
 [  201 12773   299]
 [  108 14574   511]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1073574
{'0': {'precision': 0.43967828418230565, 'recall': 0.011516247388655794, 'f1-score': 0.02244461551620905, 'support': 113926}, '1': {'precision': 0.29712742616033755, 'recall': 0.9491072198740619, 'f1-score': 0.4525725332524409, 'support': 92744}, '2': {'precision': 0.3362716006283819, 'recall': 0.03704024148737767, 'f1-score': 0.06673016972635955, 'support': 104022}, 'accuracy': 0.2999401336371712, 'macro avg': {'precision': 0.35769243699034164, 'recall': 0.3325545695833651, 'f1-score': 0.18058243949833652, 'support': 310692}, 'weighted avg': {'precision': 0.3625044051862721, 'recall': 0.2999401336371712, 'f1-score': 0.1656683081847598, 'support': 310692}}
[[  1312 108705   3909]
 [  1024  88024   3696]
 [   648  99521   3853]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987673
{'0': {'precision': 0.31733021077283374, 'recall': 0.0061063542136097345, 'f1-score': 0.011982137330326745, 'support': 44380}, '1': {'precision': 0.3538343386505816, 'recall': 0.9513055448014798, 'f1-score': 0.5158137799132342, 'support': 46494}, '2': {'precision': 0.32053291536050155, 'recall': 0.04081225365464252, 'f1-score': 0.07240539942465148, 'support': 40086}, 'accuracy': 0.35229841172877213, 'macro avg': {'precision': 0.33056582159463893, 'recall': 0.332741384223244, 'f1-score': 0.2000671055560708, 'support': 130960}, 'weighted avg': {'precision': 0.33127039508597717, 'recall': 0.35229841172877213, 'f1-score': 0.20934984712387283, 'support': 130960}}
[[  271 42555  1554]
 [  350 44230  1914]
 [  233 38217  1636]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969692
{'0': {'precision': 0.3247863247863248, 'recall': 0.005719876571084519, 'f1-score': 0.011241772058279713, 'support': 13287}, '1': {'precision': 0.36175603576388043, 'recall': 0.9510664190097995, 'f1-score': 0.5241440169431698, 'support': 15613}, '2': {'precision': 0.3517426273458445, 'recall': 0.046048013477467356, 'f1-score': 0.0814350443796164, 'support': 14246}, 'accuracy': 0.3611226996708849, 'macro avg': {'precision': 0.3460949959653499, 'recall': 0.33427810301945043, 'f1-score': 0.2056069444603553, 'support': 43146}, 'weighted avg': {'precision': 0.34706481140745987, 'recall': 0.3611226996708849, 'f1-score': 0.22001932054197582, 'support': 43146}}
[[   76 12669   542]
 [   97 14849   667]
 [   61 13529   656]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1085366
{'0': {'precision': 0.4750277469478357, 'recall': 0.008628336424481896, 'f1-score': 0.016948816948816947, 'support': 99208}, '1': {'precision': 0.2711335039992541, 'recall': 0.9182113585834002, 'f1-score': 0.4186470567065343, 'support': 76013}, '2': {'precision': 0.40174505009827893, 'recall': 0.07991379228135759, 'f1-score': 0.13331000143173033, 'support': 104863}, 'accuracy': 0.2821724911098099, 'macro avg': {'precision': 0.3826354336817896, 'recall': 0.33558449576307986, 'f1-score': 0.18963529169569385, 'support': 280084}, 'weighted avg': {'precision': 0.39225523395535633, 'recall': 0.2821724911098099, 'f1-score': 0.16953258177342356, 'support': 280084}}
[[  856 91675  6677]
 [  415 69796  5802]
 [  531 95952  8380]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011473
{'0': {'precision': 0.3880952380952381, 'recall': 0.004681486587397323, 'f1-score': 0.00925137635507123, 'support': 34818}, '1': {'precision': 0.32793471661726364, 'recall': 0.9779540976622824, 'f1-score': 0.4911675425576016, 'support': 37558}, '2': {'precision': 0.404862085086489, 'recall': 0.020527650698082347, 'f1-score': 0.03907413256328115, 'support': 42187}, 'accuracy': 0.3295915784328273, 'macro avg': {'precision': 0.3736306799329969, 'recall': 0.33438774498258733, 'f1-score': 0.17983101715865135, 'support': 114563}, 'weighted avg': {'precision': 0.37454665878385607, 'recall': 0.3295915784328273, 'f1-score': 0.17822338290509512, 'support': 114563}}
[[  163 34069   586]
 [  141 36730   687]
 [  116 41205   866]]
Evaluating performance on  val set...
136/136 - 1s - 806ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074104
{'0': {'precision': 0.30120481927710846, 'recall': 0.0066916488222698075, 'f1-score': 0.013092432573972244, 'support': 11208}, '1': {'precision': 0.2914222764760175, 'recall': 0.963291014663911, 'f1-score': 0.4474718844290025, 'support': 10161}, '2': {'precision': 0.35218783351120597, 'recall': 0.024619516562220233, 'f1-score': 0.0460218952653232, 'support': 13404}, 'accuracy': 0.2931297270871078, 'macro avg': {'precision': 0.31493830975477727, 'recall': 0.33153406001613367, 'f1-score': 0.1688620707560993, 'support': 34773}, 'weighted avg': {'precision': 0.31799876588487763, 'recall': 0.2931297270871078, 'f1-score': 0.15271559215795497, 'support': 34773}}
[[   75 10819   314]
 [   80  9788   293]
 [   94 12980   330]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
1722/1722 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1073941
{'0': {'precision': 0.34524660471765545, 'recall': 0.0033711864761678755, 'f1-score': 0.006677173191771733, 'support': 143273}, '1': {'precision': 0.29660579466993614, 'recall': 0.9828031217068589, 'f1-score': 0.45568714925558096, 'support': 130954}, '2': {'precision': 0.3854718014236174, 'recall': 0.012679582390269381, 'f1-score': 0.024551573416411888, 'support': 166567}, 'accuracy': 0.2978647622245312, 'macro avg': {'precision': 0.342441400270403, 'recall': 0.33295129685776537, 'f1-score': 0.16230529862125487, 'support': 440794}, 'weighted avg': {'precision': 0.345996346548835, 'recall': 0.2978647622245312, 'f1-score': 0.14682639851624918, 'support': 440794}}
[[   483 141210   1580]
 [   465 128702   1787]
 [   451 164004   2112]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042079
{'0': {'precision': 0.3426248548199768, 'recall': 0.00539640727325943, 'f1-score': 0.010625461487204424, 'support': 54666}, '1': {'precision': 0.31779365343080246, 'recall': 0.9427304090685067, 'f1-score': 0.4753479125248509, 'support': 50725}, '2': {'precision': 0.3097037484885127, 'recall': 0.03898327657388558, 'f1-score': 0.06924987748618552, 'support': 52561}, 'accuracy': 0.31759015397082657, 'macro avg': {'precision': 0.32337408557976394, 'recall': 0.32903669763855053, 'f1-score': 0.1850744171660803, 'support': 157952}, 'weighted avg': {'precision': 0.3236955031159531, 'recall': 0.31759015397082657, 'f1-score': 0.17937548844607207, 'support': 157952}}
[[  295 52377  1994]
 [  332 47820  2573]
 [  234 50278  2049]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058652
{'0': {'precision': 0.36312849162011174, 'recall': 0.006590286930954071, 'f1-score': 0.012945628360884285, 'support': 19726}, '1': {'precision': 0.3044527069919289, 'recall': 0.9552153872417913, 'f1-score': 0.46173736040050617, 'support': 17573}, '2': {'precision': 0.3796106557377049, 'recall': 0.036781495085873125, 'f1-score': 0.06706489275047516, 'support': 20146}, 'accuracy': 0.30737226912699106, 'macro avg': {'precision': 0.34906395144991514, 'recall': 0.33286238975287286, 'f1-score': 0.18058262717062187, 'support': 57445}, 'weighted avg': {'precision': 0.35095928829592293, 'recall': 0.30737226912699106, 'f1-score': 0.16921516979225296, 'support': 57445}}
[[  130 19033   563]
 [  139 16786   648]
 [   89 19316   741]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
4450/4450 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.090112
{'0': {'precision': 0.3450778569543415, 'recall': 0.007674022772625895, 'f1-score': 0.015014152920439342, 'support': 340760}, '1': {'precision': 0.4000909670642959, 'recall': 0.9221692403465389, 'f1-score': 0.5580619927898326, 'support': 462632}, '2': {'precision': 0.2607102333711552, 'recall': 0.05064576854797393, 'f1-score': 0.08481526006255269, 'support': 335724}, 'accuracy': 0.3917450022649142, 'macro avg': {'precision': 0.33529301912993087, 'recall': 0.3268296772223796, 'f1-score': 0.21929713525760822, 'support': 1139116}, 'weighted avg': {'precision': 0.34255536503652695, 'recall': 0.3917450022649142, 'f1-score': 0.2561355269935241, 'support': 1139116}}
[[  2615 322786  15359]
 [  3151 426625  32856]
 [  1812 316909  17003]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005213
{'0': {'precision': 0.3566265060240964, 'recall': 0.006984976008809879, 'f1-score': 0.013701589260916526, 'support': 127130}, '1': {'precision': 0.33089397298368856, 'recall': 0.9292138091093705, 'f1-score': 0.4880078568149016, 'support': 127539}, '2': {'precision': 0.3620004964010921, 'recall': 0.06723831915727359, 'f1-score': 0.11341148111428628, 'support': 130149}, 'accuracy': 0.3330145679256168, 'macro avg': {'precision': 0.3498403251362923, 'recall': 0.3344790347584847, 'f1-score': 0.20504030906336812, 'support': 384818}, 'weighted avg': {'precision': 0.34991558798527034, 'recall': 0.3330145679256168, 'f1-score': 0.2046222056884015, 'support': 384818}}
[[   888 119001   7241]
 [   846 118511   8182]
 [   756 120642   8751]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0887852
{'0': {'precision': 0.2736236647493837, 'recall': 0.009675451085219514, 'f1-score': 0.018690015154066344, 'support': 34417}, '1': {'precision': 0.39955695368601357, 'recall': 0.9232218289759105, 'f1-score': 0.557734530364512, 'support': 52554}, '2': {'precision': 0.33960824217756297, 'recall': 0.061322921451538816, 'f1-score': 0.10388700828761527, 'support': 43540}, 'accuracy': 0.39477132195753617, 'macro avg': {'precision': 0.33759628687098675, 'recall': 0.3314067338375563, 'f1-score': 0.2267705179353979, 'support': 130511}, 'weighted avg': {'precision': 0.34634754678230484, 'recall': 0.39477132195753617, 'f1-score': 0.2641744764899268, 'support': 130511}}
[[  333 32371  1713]
 [  556 48519  3479]
 [  328 40542  2670]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
6203/6203 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0846814
{'0': {'precision': 0.2864113422942368, 'recall': 0.007389092360091776, 'f1-score': 0.014406512799614716, 'support': 421026}, '1': {'precision': 0.4347158955633222, 'recall': 0.9559684298675322, 'f1-score': 0.5976549307714044, 'support': 691413}, '2': {'precision': 0.3060748076753029, 'recall': 0.03640283532801884, 'f1-score': 0.0650669674326801, 'support': 475430}, 'accuracy': 0.42912041232620574, 'macro avg': {'precision': 0.3424006818442873, 'recall': 0.3332534525185476, 'f1-score': 0.22570947033456643, 'support': 1587869}, 'weighted avg': {'precision': 0.3568757807558217, 'recall': 0.42912041232620574, 'f1-score': 0.2835414592979262, 'support': 1587869}}
[[  3111 403954  13961]
 [  5167 660969  25277]
 [  2584 455539  17307]]
Evaluating performance on  train set...
1766/1766 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017171
{'0': {'precision': 0.37101702313400264, 'recall': 0.00548454326659397, 'f1-score': 0.010809298540108855, 'support': 154981}, '1': {'precision': 0.3317945534952285, 'recall': 0.9677464441885695, 'f1-score': 0.49416370844541724, 'support': 150247}, '2': {'precision': 0.34562412831241285, 'recall': 0.02701671424969849, 'f1-score': 0.05011596822407463, 'support': 146761}, 'accuracy': 0.33234437121257376, 'macro avg': {'precision': 0.3494785683138813, 'recall': 0.3334159005682873, 'f1-score': 0.1850296584032002, 'support': 451989}, 'weighted avg': {'precision': 0.34973388342766415, 'recall': 0.33234437121257376, 'f1-score': 0.18424545777082324, 'support': 451989}}
[[   850 150744   3387]
 [   726 145401   4120]
 [   715 142081   3965]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0893832
{'0': {'precision': 0.25392802838317285, 'recall': 0.011227897178458573, 'f1-score': 0.021504914795896467, 'support': 44621}, '1': {'precision': 0.4034634437991117, 'recall': 0.9396601740571903, 'f1-score': 0.5645325937028498, 'support': 60325}, '2': {'precision': 0.3173300017847582, 'recall': 0.04122802949496823, 'f1-score': 0.07297502513903426, 'support': 43126}, 'accuracy': 0.3982116808039332, 'macro avg': {'precision': 0.3249071579890142, 'recall': 0.33070536691020574, 'f1-score': 0.21967084454592686, 'support': 148072}, 'weighted avg': {'precision': 0.3333150660397405, 'recall': 0.3982116808039332, 'f1-score': 0.2577267846208473, 'support': 148072}}
[[  501 42805  1315]
 [ 1130 56685  2510]
 [  342 41006  1778]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
5183/5183 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1102757
{'0': {'precision': 0.37631444614599285, 'recall': 0.008114420818354529, 'f1-score': 0.01588628762541806, 'support': 454253}, '1': {'precision': 0.2670998729079481, 'recall': 0.9522928765382821, 'f1-score': 0.4171868438778764, 'support': 355754}, '2': {'precision': 0.42592668694008384, 'recall': 0.04010812107703143, 'f1-score': 0.07331263174275328, 'support': 516828}, 'accuracy': 0.27373185060689537, 'macro avg': {'precision': 0.35644700199800833, 'recall': 0.3335051394778894, 'f1-score': 0.16879525441534926, 'support': 1326835}, 'weighted avg': {'precision': 0.36635651912221145, 'recall': 0.27373185060689537, 'f1-score': 0.14585257632485032, 'support': 1326835}}
[[  3686 436512  14055]
 [  3088 338782  13884]
 [  3021 493078  20729]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103194
{'0': {'precision': 0.38575982996811903, 'recall': 0.008183847234851617, 'f1-score': 0.01602766943851645, 'support': 133067}, '1': {'precision': 0.319386189258312, 'recall': 0.9479627426039144, 'f1-score': 0.4777945525613716, 'support': 121855}, '2': {'precision': 0.35437918754149816, 'recall': 0.04654241614675408, 'f1-score': 0.08227874710952279, 'support': 126143}, 'accuracy': 0.3213992363507538, 'macro avg': {'precision': 0.3531750689226431, 'recall': 0.33422966866184006, 'f1-score': 0.19203365636980363, 'support': 381065}, 'weighted avg': {'precision': 0.35414735344491494, 'recall': 0.3213992363507538, 'f1-score': 0.18562003093482093, 'support': 381065}}
[[  1089 126628   5350]
 [   995 115514   5346]
 [   739 119533   5871]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100542
{'0': {'precision': 0.37592592592592594, 'recall': 0.009187391097734834, 'f1-score': 0.017936427293410797, 'support': 44191}, '1': {'precision': 0.3336704546359488, 'recall': 0.9413403428366022, 'f1-score': 0.49269772582959004, 'support': 44511}, '2': {'precision': 0.3469990160708429, 'recall': 0.04803741288110967, 'f1-score': 0.08439188784972182, 'support': 44049}, 'accuracy': 0.3346264811564508, 'macro avg': {'precision': 0.3521984655442392, 'recall': 0.3328550489384822, 'f1-score': 0.19834201365757423, 'support': 132751}, 'weighted avg': {'precision': 0.3521593649599466, 'recall': 0.3346264811564508, 'f1-score': 0.19917345557333951, 'support': 132751}}
[[  406 41987  1798]
 [  427 41900  2184]
 [  247 41686  2116]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
7324/7324 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099541
{'0': {'precision': 0.28769910883446775, 'recall': 0.006651999818286835, 'f1-score': 0.013003344396747897, 'support': 616356}, '1': {'precision': 0.34814669091842704, 'recall': 0.9536375149939416, 'f1-score': 0.510078004745991, 'support': 656932}, '2': {'precision': 0.3234305576049711, 'recall': 0.03280108677398061, 'f1-score': 0.05956165855985604, 'support': 601413}, 'accuracy': 0.3468830496169789, 'macro avg': {'precision': 0.3197587857859553, 'recall': 0.33103020052873633, 'f1-score': 0.19421433590086498, 'support': 1874701}, 'weighted avg': {'precision': 0.3203439459540907, 'recall': 0.3468830496169789, 'f1-score': 0.20212418348966263, 'support': 1874701}}
[[  4100 595092  17164]
 [  6355 626475  24102]
 [  3796 577890  19727]]
Evaluating performance on  train set...
2046/2046 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102398
{'0': {'precision': 0.3335287221570926, 'recall': 0.006504529736217885, 'f1-score': 0.01276020788598788, 'support': 174955}, '1': {'precision': 0.3275819669672972, 'recall': 0.9504382479363772, 'f1-score': 0.4872324038527303, 'support': 172391}, '2': {'precision': 0.34432488719194726, 'recall': 0.03936418675313485, 'f1-score': 0.07065131682699889, 'support': 176404}, 'accuracy': 0.3282653937947494, 'macro avg': {'precision': 0.33514519210544574, 'recall': 0.33210232147524327, 'f1-score': 0.19021464285523904, 'support': 523750}, 'weighted avg': {'precision': 0.3352076140384949, 'recall': 0.3282653937947494, 'f1-score': 0.1884298203280553, 'support': 523750}}
[[  1138 167848   5969]
 [  1290 163847   7254]
 [   984 168476   6944]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999799
{'0': {'precision': 0.31019522776572667, 'recall': 0.004563077364902596, 'f1-score': 0.00899385210459284, 'support': 62677}, '1': {'precision': 0.3438918741090032, 'recall': 0.9590941064929505, 'f1-score': 0.506259736695537, 'support': 65394}, '2': {'precision': 0.3354007633587786, 'recall': 0.034282091711503766, 'f1-score': 0.062205966935567125, 'support': 61519}, 'accuracy': 0.3434463843029696, 'macro avg': {'precision': 0.3298292884111695, 'recall': 0.3326464251897856, 'f1-score': 0.19248651857856566, 'support': 189590}, 'weighted avg': {'precision': 0.3299967881598465, 'recall': 0.3434463843029696, 'f1-score': 0.19777892172444045, 'support': 189590}}
[[  286 60555  1836]
 [  332 62719  2343]
 [  304 59106  2109]]
testing model on single stock: results/universal/W6/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
29350/29350 - 168s - 168s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0902051
{'0': {'precision': 0.34267941270639896, 'recall': 0.0033563330851474646, 'f1-score': 0.006647557452970438, 'support': 2232198}, '1': {'precision': 0.40153473396873857, 'recall': 0.9781555216780379, 'f1-score': 0.5693501357562644, 'support': 3016094}, '2': {'precision': 0.3375357132950542, 'recall': 0.02148860958886269, 'f1-score': 0.04040491244177278, 'support': 2265107}, 'accuracy': 0.400135145225217, 'macro avg': {'precision': 0.3605832866567306, 'recall': 0.33433348811734936, 'f1-score': 0.20546753521700253, 'support': 7513399}, 'weighted avg': {'precision': 0.3647549276344471, 'recall': 0.400135145225217, 'f1-score': 0.24270954368472997, 'support': 7513399}}
[[   7492 2186857   37849]
 [   8204 2950209   57681]
 [   6167 2210266   48674]]
Evaluating performance on  train set...
5452/5452 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017941
{'0': {'precision': 0.3619172439618049, 'recall': 0.004150945827257949, 'f1-score': 0.00820775426841437, 'support': 465677}, '1': {'precision': 0.3312497012087714, 'recall': 0.9726779732762028, 'f1-score': 0.49419809752463134, 'support': 463033}, '2': {'precision': 0.3488372093023256, 'recall': 0.022784582325505662, 'f1-score': 0.04277526395173453, 'support': 466763}, 'accuracy': 0.3317513129956653, 'macro avg': {'precision': 0.347334718157634, 'recall': 0.3332045004763221, 'f1-score': 0.18172703858159345, 'support': 1395473}, 'weighted avg': {'precision': 0.3473663636930158, 'recall': 0.3317513129956653, 'f1-score': 0.18102686372540241, 'support': 1395473}}
[[  1933 454655   9089]
 [  1888 450382  10763]
 [  1520 454608  10635]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945191
{'0': {'precision': 0.34456711214410224, 'recall': 0.0036914381046052715, 'f1-score': 0.0073046198949268, 'support': 160642}, '1': {'precision': 0.3744586987666246, 'recall': 0.9761220873337036, 'f1-score': 0.5412744064214573, 'support': 189045}, '2': {'precision': 0.31601550225201636, 'recall': 0.01954331983805668, 'f1-score': 0.036810190212418104, 'support': 154375}, 'accuracy': 0.3732497192805647, 'macro avg': {'precision': 0.34501377105424774, 'recall': 0.3331189484254552, 'f1-score': 0.19512973884293405, 'support': 504062}, 'weighted avg': {'precision': 0.3470334758373859, 'recall': 0.3732497192805647, 'f1-score': 0.21660276320204114, 'support': 504062}}
[[   593 157390   2659]
 [   643 184531   3871]
 [   485 150873   3017]]
training model: results/universal/W6/deepLOB_L2/h300
Epoch 1/50
9426/9426 - 384s - loss: 3.2134 - accuracy300: 0.4140 - val_loss: 3.5332 - val_accuracy300: 0.3443 - 384s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 375s - loss: 3.1905 - accuracy300: 0.4271 - val_loss: 3.6435 - val_accuracy300: 0.3416 - 375s/epoch - 40ms/step
Epoch 3/50
9426/9426 - 377s - loss: 3.1765 - accuracy300: 0.4343 - val_loss: 3.7190 - val_accuracy300: 0.3489 - 377s/epoch - 40ms/step
Epoch 4/50
9426/9426 - 380s - loss: 3.1680 - accuracy300: 0.4382 - val_loss: 3.7029 - val_accuracy300: 0.3499 - 380s/epoch - 40ms/step
Epoch 5/50
9426/9426 - 376s - loss: 3.1618 - accuracy300: 0.4405 - val_loss: 3.8911 - val_accuracy300: 0.3474 - 376s/epoch - 40ms/step
Epoch 6/50
9426/9426 - 376s - loss: 3.1565 - accuracy300: 0.4424 - val_loss: 3.7166 - val_accuracy300: 0.3467 - 376s/epoch - 40ms/step
Epoch 7/50
9426/9426 - 377s - loss: 3.1518 - accuracy300: 0.4442 - val_loss: 3.8474 - val_accuracy300: 0.3423 - 377s/epoch - 40ms/step
Epoch 8/50
9426/9426 - 378s - loss: 3.1476 - accuracy300: 0.4463 - val_loss: 3.6163 - val_accuracy300: 0.3471 - 378s/epoch - 40ms/step
Epoch 9/50
9426/9426 - 378s - loss: 3.1441 - accuracy300: 0.4476 - val_loss: 3.8023 - val_accuracy300: 0.3466 - 378s/epoch - 40ms/step
Epoch 10/50
9426/9426 - 379s - loss: 3.1403 - accuracy300: 0.4490 - val_loss: 3.7651 - val_accuracy300: 0.3461 - 379s/epoch - 40ms/step
Epoch 11/50
9426/9426 - 378s - loss: 3.1377 - accuracy300: 0.4500 - val_loss: 3.6874 - val_accuracy300: 0.3487 - 378s/epoch - 40ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 560s - 560s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1662349
{'0': {'precision': 0.2998093277577209, 'recall': 0.3552047051183659, 'f1-score': 0.3251645873610249, 'support': 3252288}, '1': {'precision': 0.39485825614922204, 'recall': 0.6334212462351083, 'f1-score': 0.4864661954581684, 'support': 4266723}, '2': {'precision': 0.3377518513921642, 'recall': 0.01237082595621675, 'f1-score': 0.023867459266598508, 'support': 3299618}, 'accuracy': 0.36036728868325185, 'macro avg': {'precision': 0.34413981176636904, 'recall': 0.3336655924365637, 'f1-score': 0.2784994140285973, 'support': 10818629}, 'weighted avg': {'precision': 0.3488676033343217, 'recall': 0.36036728868325185, 'f1-score': 0.29688594447534994, 'support': 10818629}}
[[1155228 2056865   40195]
 [1524249 2702633   39841]
 [1173732 2085067   40819]]
Evaluating performance on  train set...
9426/9426 - 131s - 131s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1875591
{'0': {'precision': 0.3317763437258901, 'recall': 0.2719127118727146, 'f1-score': 0.29887639844080416, 'support': 816056}, '1': {'precision': 0.3333419543683545, 'recall': 0.5572573056283222, 'f1-score': 0.41715111989848613, 'support': 786380}, '2': {'precision': 0.3488745793228585, 'recall': 0.18473059401331007, 'f1-score': 0.24155615985324613, 'support': 809763}, 'accuracy': 0.3356688233433477, 'macro avg': {'precision': 0.337997625805701, 'recall': 0.3379668705047823, 'f1-score': 0.3191945593975121, 'support': 2412199}, 'weighted avg': {'precision': 0.33802652600717326, 'recall': 0.3356688233433477, 'f1-score': 0.31819199682241167, 'support': 2412199}}
[[221896 439763 154397]
 [223376 438216 124788]
 [223540 436635 149588]]
Evaluating performance on  val set...
3323/3323 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1796588
{'0': {'precision': 0.31591446912824955, 'recall': 0.27024404426595916, 'f1-score': 0.2913000556282466, 'support': 275155}, '1': {'precision': 0.36385856096329877, 'recall': 0.533036448844049, 'f1-score': 0.4324918147533075, 'support': 300229}, '2': {'precision': 0.331789471279597, 'recall': 0.21132560009020904, 'f1-score': 0.25819798719609616, 'support': 274917}, 'accuracy': 0.3439828954687811, 'macro avg': {'precision': 0.33718750045704843, 'recall': 0.3382020310667391, 'f1-score': 0.3273299525258834, 'support': 850301}, 'weighted avg': {'precision': 0.3379754977686804, 'recall': 0.34398289546878097, 'f1-score': 0.3304503557022162, 'support': 850301}}
[[ 74359 138806  61990]
 [ 85181 160033  55015]
 [ 75837 140983  58097]]
testing model out of sample: results/universal/W6/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 233s - 233s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1778696
{'0': {'precision': 0.3052802190309213, 'recall': 0.3393208115333234, 'f1-score': 0.32140169424168724, 'support': 1378822}, '1': {'precision': 0.3745628689630501, 'recall': 0.6377605921755873, 'f1-score': 0.47194685550046145, 'support': 1681123}, '2': {'precision': 0.3677351375332742, 'recall': 0.0232634342736939, 'f1-score': 0.04375863657300783, 'support': 1425198}, 'accuracy': 0.3507518043460376, 'macro avg': {'precision': 0.3491927418424152, 'recall': 0.33344827932753485, 'f1-score': 0.27903572877171884, 'support': 4485143}, 'weighted avg': {'precision': 0.35109442857598294, 'recall': 0.3507518043460376, 'f1-score': 0.28960529502488364, 'support': 4485143}}
[[ 467863  880351   30608]
 [ 582572 1072154   26397]
 [ 482134  909909   33155]]
Evaluating performance on  train set...
5153/5153 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1778946
{'0': {'precision': 0.3299046757846351, 'recall': 0.2363043043133092, 'f1-score': 0.2753679211781864, 'support': 444647}, '1': {'precision': 0.33622299789718135, 'recall': 0.5417592647521869, 'f1-score': 0.41493303881538074, 'support': 438274}, '2': {'precision': 0.336667483193163, 'recall': 0.22712270538497203, 'f1-score': 0.271252785689028, 'support': 435694}, 'accuracy': 0.33479597911444964, 'macro avg': {'precision': 0.33426505229165987, 'recall': 0.3350620914834894, 'f1-score': 0.32051791522753176, 'support': 1318615}, 'weighted avg': {'precision': 0.3342392775574083, 'recall': 0.33479597911444964, 'f1-score': 0.3203960928018297, 'support': 1318615}}
[[105072 236703 102872]
 [108735 237439  92100]
 [104685 232053  98956]]
Evaluating performance on  val set...
1795/1795 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1645883
{'0': {'precision': 0.31464809046234826, 'recall': 0.2909797181161911, 'f1-score': 0.3023514157430195, 'support': 145450}, '1': {'precision': 0.37952986879137435, 'recall': 0.5643319835670374, 'f1-score': 0.4538393900395564, 'support': 169659}, '2': {'precision': 0.3383578550330731, 'recall': 0.16970017317763575, 'f1-score': 0.22603475747582172, 'support': 143783}, 'accuracy': 0.3540419096432276, 'macro avg': {'precision': 0.34417860476226525, 'recall': 0.34167062495362144, 'f1-score': 0.32740852108613255, 'support': 458892}, 'weighted avg': {'precision': 0.3460647172695202, 'recall': 0.3540419096432276, 'f1-score': 0.33444668032715624, 'support': 458892}}
[[42323 78653 24474]
 [50676 95744 23239]
 [41510 77873 24400]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
1059/1059 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2126186
{'0': {'precision': 0.31070904539962024, 'recall': 0.34443208591965363, 'f1-score': 0.32670262789207094, 'support': 83613}, '1': {'precision': 0.33963923832937687, 'recall': 0.6570527854439148, 'f1-score': 0.44780313731321086, 'support': 91673}, '2': {'precision': 0.35174418604651164, 'recall': 0.0037898956995646316, 'f1-score': 0.007498992903845559, 'support': 95781}, 'accuracy': 0.3297930032058495, 'macro avg': {'precision': 0.3340308232585029, 'recall': 0.33509158902104436, 'f1-score': 0.26066825270304245, 'support': 271067}, 'weighted avg': {'precision': 0.3349927257544752, 'recall': 0.3297930032058495, 'f1-score': 0.25486800264206616, 'support': 271067}}
[[28799 54496   318]
 [31088 60234   351]
 [32801 62617   363]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1782604
{'0': {'precision': 0.3128737802958766, 'recall': 0.2211345939933259, 'f1-score': 0.25912408759124084, 'support': 17980}, '1': {'precision': 0.3635107376283847, 'recall': 0.5340759438103599, 'f1-score': 0.4325873908309073, 'support': 18224}, '2': {'precision': 0.34436308372478586, 'recall': 0.2807659814136863, 'f1-score': 0.3093295274735503, 'support': 17755}, 'accuracy': 0.34644822921106766, 'macro avg': {'precision': 0.3402492005496824, 'recall': 0.34532550640579074, 'f1-score': 0.33368033529856617, 'support': 53959}, 'weighted avg': {'precision': 0.3403372338959787, 'recall': 0.34644822921106766, 'f1-score': 0.33422912703507945, 'support': 53959}}
[[3976 8480 5524]
 [4524 9733 3967]
 [4208 8562 4985]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1659622
{'0': {'precision': 0.32232200128287364, 'recall': 0.3033046627433228, 'f1-score': 0.31252429448806657, 'support': 6627}, '1': {'precision': 0.3624066390041494, 'recall': 0.6056025516571905, 'f1-score': 0.45345516847515704, 'support': 7211}, '2': {'precision': 0.44066354742662694, 'recall': 0.15237534931607588, 'f1-score': 0.22644808743169395, 'support': 6799}, 'accuracy': 0.3592091873818869, 'macro avg': {'precision': 0.3751307292378833, 'recall': 0.3537608545721964, 'f1-score': 0.3308091834649725, 'support': 20637}, 'weighted avg': {'precision': 0.37531684039899993, 'recall': 0.3592091873818869, 'f1-score': 0.3334101015600553, 'support': 20637}}
[[2010 3864  753]
 [2282 4367  562]
 [1944 3819 1036]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2133408
{'0': {'precision': 0.3471358867905653, 'recall': 0.40256179040567835, 'f1-score': 0.3727999921864318, 'support': 189633}, '1': {'precision': 0.3061060699854106, 'recall': 0.5768662578701153, 'f1-score': 0.399972360476294, 'support': 170582}, '2': {'precision': 0.4422655503736585, 'recall': 0.03956071572175312, 'f1-score': 0.07262510553292398, 'support': 198960}, 'accuracy': 0.32657575893056734, 'macro avg': {'precision': 0.3651691690498782, 'recall': 0.3396629213325155, 'f1-score': 0.2817991527318832, 'support': 559175}, 'weighted avg': {'precision': 0.3684674013544054, 'recall': 0.32657575893056734, 'f1-score': 0.2742840025213705, 'support': 559175}}
[[ 76339 108749   4545]
 [ 66798  98403   5381]
 [ 76774 114315   7871]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1702441
{'0': {'precision': 0.3300254562713035, 'recall': 0.16286596401575643, 'f1-score': 0.21810042485244222, 'support': 46965}, '1': {'precision': 0.3257616164151476, 'recall': 0.4605353618238673, 'f1-score': 0.38159816974007005, 'support': 45091}, '2': {'precision': 0.32424874875889037, 'recall': 0.3618888235560179, 'f1-score': 0.34203635819555617, 'support': 44218}, 'accuracy': 0.3259389171815607, 'macro avg': {'precision': 0.32667860714844715, 'recall': 0.32843004979854723, 'f1-score': 0.3139116509293562, 'support': 136274}, 'weighted avg': {'precision': 0.32674019821960026, 'recall': 0.3259389171815607, 'f1-score': 0.3124139102956951, 'support': 136274}}
[[ 7649 22336 16980]
 [ 7956 20766 16369]
 [ 7572 20644 16002]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1812739
{'0': {'precision': 0.3814054641837706, 'recall': 0.15981319056840187, 'f1-score': 0.22524583584186234, 'support': 17558}, '1': {'precision': 0.310778132826669, 'recall': 0.45721364589289115, 'f1-score': 0.3700352194143809, 'support': 15741}, '2': {'precision': 0.270311528241081, 'recall': 0.3208078910286519, 'f1-score': 0.29340288432034367, 'support': 14903}, 'accuracy': 0.30670926517571884, 'macro avg': {'precision': 0.3208317084171735, 'recall': 0.3126115758299816, 'f1-score': 0.2962279798588623, 'support': 48202}, 'weighted avg': {'precision': 0.3239933702821474, 'recall': 0.30670926517571884, 'f1-score': 0.29360138499521327, 'support': 48202}}
[[2806 8365 6387]
 [2025 7197 6519]
 [2526 7596 4781]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.182405
{'0': {'precision': 0.362893504713809, 'recall': 0.259027469591443, 'f1-score': 0.3022872362913795, 'support': 110413}, '1': {'precision': 0.2987199258737442, 'recall': 0.5107036293603863, 'f1-score': 0.3769530780750719, 'support': 92165}, '2': {'precision': 0.3788635170956847, 'recall': 0.26041676301112665, 'f1-score': 0.3086671490276042, 'support': 108119}, 'accuracy': 0.3341680157838666, 'macro avg': {'precision': 0.34682564922774595, 'recall': 0.3433826206543187, 'f1-score': 0.3293024877980186, 'support': 310697}, 'weighted avg': {'precision': 0.3494144684660224, 'recall': 0.3341680157838666, 'f1-score': 0.3266562102213559, 'support': 310697}}
[[28600 56125 25688]
 [24623 47069 20473]
 [25588 54375 28156]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1687021
{'0': {'precision': 0.3447736825650467, 'recall': 0.22554767748386512, 'f1-score': 0.2726985478974049, 'support': 44004}, '1': {'precision': 0.34627942108084403, 'recall': 0.46889846911842337, 'f1-score': 0.3983667672643351, 'support': 45464}, '2': {'precision': 0.3159566609209554, 'recall': 0.3092403354863588, 'f1-score': 0.3125624223526832, 'support': 41492}, 'accuracy': 0.3365455100794136, 'macro avg': {'precision': 0.33566992152228203, 'recall': 0.33456216069621575, 'f1-score': 0.3278759125048078, 'support': 130960}, 'weighted avg': {'precision': 0.3361663294329879, 'recall': 0.3365455100794136, 'f1-score': 0.3289555103607259, 'support': 130960}}
[[ 9925 20833 13246]
 [ 9613 21318 14533]
 [ 9249 19412 12831]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1706554
{'0': {'precision': 0.3369695928534616, 'recall': 0.28300389554176886, 'f1-score': 0.307638017565872, 'support': 13862}, '1': {'precision': 0.34274763881918147, 'recall': 0.4999667221297837, 'f1-score': 0.40669157057008287, 'support': 15025}, '2': {'precision': 0.33395911556111807, 'recall': 0.22454417952314165, 'f1-score': 0.26853404897685346, 'support': 14260}, 'accuracy': 0.3392356363130693, 'macro avg': {'precision': 0.33789211574458705, 'recall': 0.3358382657315648, 'f1-score': 0.3276212123709361, 'support': 43147}, 'weighted avg': {'precision': 0.33798671419320997, 'recall': 0.3392356363130693, 'f1-score': 0.3292074671639637, 'support': 43147}}
[[3923 7140 2799]
 [3926 7512 3587]
 [3793 7265 3202]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2578902
{'0': {'precision': 0.352092840355193, 'recall': 0.3875796531000534, 'f1-score': 0.36898498222209447, 'support': 99337}, '1': {'precision': 0.25627806125455166, 'recall': 0.608330186436174, 'f1-score': 0.36062964053114, 'support': 71499}, '2': {'precision': 0.410958904109589, 'recall': 0.0038442880287040174, 'f1-score': 0.007617320335524824, 'support': 109253}, 'accuracy': 0.2942493278922057, 'macro avg': {'precision': 0.3397766019064446, 'recall': 0.33325137585497716, 'f1-score': 0.24574398102958647, 'support': 280089}, 'weighted avg': {'precision': 0.3505955776010052, 'recall': 0.2942493278922057, 'f1-score': 0.2258951081475862, 'support': 280089}}
[[38501 60476   360]
 [27762 43495   242]
 [43086 65747   420]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1992407
{'0': {'precision': 0.3268103354684616, 'recall': 0.32244329593230325, 'f1-score': 0.3246121288096297, 'support': 37343}, '1': {'precision': 0.33479431563201195, 'recall': 0.5917298997964202, 'f1-score': 0.4276365442855369, 'support': 37823}, '2': {'precision': 0.35988960441582335, 'recall': 0.0992943804254023, 'f1-score': 0.15564573883981855, 'support': 39398}, 'accuracy': 0.33460773017701895, 'macro avg': {'precision': 0.34049808517209895, 'recall': 0.33782252538470864, 'f1-score': 0.302631470644995, 'support': 114564}, 'weighted avg': {'precision': 0.34082202430364655, 'recall': 0.33460773017701895, 'f1-score': 0.30051864948379103, 'support': 114564}}
[[12041 21544  3758]
 [12242 22381  3200]
 [12561 22925  3912]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2193031
{'0': {'precision': 0.3381128584643848, 'recall': 0.3134648370497427, 'f1-score': 0.3253226524254562, 'support': 11660}, '1': {'precision': 0.2965446358653093, 'recall': 0.6004360321078188, 'f1-score': 0.3970120892441765, 'support': 10091}, '2': {'precision': 0.4239592183517417, 'recall': 0.11495929964675165, 'f1-score': 0.1808735576632635, 'support': 13022}, 'accuracy': 0.3224053144681218, 'macro avg': {'precision': 0.35287223756047864, 'recall': 0.3429533896014377, 'f1-score': 0.3010694331109654, 'support': 34773}, 'weighted avg': {'precision': 0.35819816500123497, 'recall': 0.3224053144681218, 'f1-score': 0.2920325133791971, 'support': 34773}}
[[3655 6822 1183]
 [3181 6059  851]
 [3974 7551 1497]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
1722/1722 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.224569
{'0': {'precision': 0.3315240056299849, 'recall': 0.3489218994321455, 'f1-score': 0.3400005346235582, 'support': 145812}, '1': {'precision': 0.3078629900150841, 'recall': 0.6495982749453536, 'f1-score': 0.41774487293035445, 'support': 135416}, '2': {'precision': 0.3397755610972569, 'recall': 0.003415407561524337, 'f1-score': 0.006762835427330541, 'support': 159571}, 'accuracy': 0.31621668833187005, 'macro avg': {'precision': 0.3263875189141086, 'recall': 0.3339785273130078, 'f1-score': 0.25483608099374777, 'support': 440799}, 'weighted avg': {'precision': 0.3272423009685874, 'recall': 0.31621668833187005, 'f1-score': 0.2432506654489727, 'support': 440799}}
[[ 50877  94365    570]
 [ 46961  87966    489]
 [ 55626 103400    545]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1822135
{'0': {'precision': 0.3322107808216221, 'recall': 0.2848654251971419, 'f1-score': 0.3067218097563406, 'support': 54022}, '1': {'precision': 0.33198883028234566, 'recall': 0.5661486605655608, 'f1-score': 0.4185440057950018, 'support': 51029}, '2': {'precision': 0.36677638262424317, 'recall': 0.17061736796340404, 'f1-score': 0.23289597605501158, 'support': 52902}, 'accuracy': 0.33747380549910416, 'macro avg': {'precision': 0.34365866457607036, 'recall': 0.3405438179087022, 'f1-score': 0.31938726386878463, 'support': 157953}, 'weighted avg': {'precision': 0.3437158712757035, 'recall': 0.33747380549910416, 'f1-score': 0.31812166026370126, 'support': 157953}}
[[15389 29411  9222]
 [15778 28890  6361]
 [15156 28720  9026]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1880095
{'0': {'precision': 0.33984824097493677, 'recall': 0.30817347789824856, 'f1-score': 0.32323674138873704, 'support': 19184}, '1': {'precision': 0.33211615371239783, 'recall': 0.5181206597222222, 'f1-score': 0.40477250090067174, 'support': 18432}, '2': {'precision': 0.3667109340416113, 'recall': 0.20887544125063034, 'f1-score': 0.2661526104417671, 'support': 19830}, 'accuracy': 0.3412596177279532, 'macro avg': {'precision': 0.3462251095763153, 'recall': 0.34505652629036704, 'f1-score': 0.33138728424372527, 'support': 57446}, 'weighted avg': {'precision': 0.3466401737655408, 'recall': 0.3412596177279532, 'f1-score': 0.32969304474572564, 'support': 57446}}
[[5912 9413 3859]
 [5588 9550 3294]
 [5896 9792 4142]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
4450/4450 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1934135
{'0': {'precision': 0.3355899926622174, 'recall': 0.29340138998498, 'f1-score': 0.3130808244073248, 'support': 392810}, '1': {'precision': 0.3188498490444064, 'recall': 0.6383872264723539, 'f1-score': 0.42528580640841124, 'support': 363126}, '2': {'precision': 0.3336537621253168, 'recall': 0.059783133473387526, 'f1-score': 0.10139805197823137, 'support': 383185}, 'accuracy': 0.32478902592437503, 'macro avg': {'precision': 0.32936453461064685, 'recall': 0.3305239166435738, 'f1-score': 0.2799215609313225, 'support': 1139121}, 'weighted avg': {'precision': 0.3296022917159233, 'recall': 0.32478902592437503, 'f1-score': 0.2776419931864838, 'support': 1139121}}
[[115251 251858  25701]
 [111262 231815  20049]
 [116915 243362  22908]]
Evaluating performance on  train set...
1504/1504 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1893646
{'0': {'precision': 0.33204092622509424, 'recall': 0.2873899837645944, 'f1-score': 0.30810614988070006, 'support': 128731}, '1': {'precision': 0.33091068751138536, 'recall': 0.5576809540677766, 'f1-score': 0.4153597204551984, 'support': 127035}, '2': {'precision': 0.33789707965198623, 'recall': 0.15528503793015272, 'f1-score': 0.21278290091898006, 'support': 129053}, 'accuracy': 0.33231467261231906, 'macro avg': {'precision': 0.33361623112948857, 'recall': 0.33345199192084124, 'f1-score': 0.3120829237516262, 'support': 384819}, 'weighted avg': {'precision': 0.3336317372120899, 'recall': 0.33231467261231906, 'f1-score': 0.31154466536375713, 'support': 384819}}
[[36996 71339 20396]
 [37318 70845 18872]
 [37106 71907 20040]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2036833
{'0': {'precision': 0.30601630011876974, 'recall': 0.3764516210292969, 'f1-score': 0.33759925901661564, 'support': 39697}, '1': {'precision': 0.35886503787738355, 'recall': 0.6279109996324086, 'f1-score': 0.45671012692071783, 'support': 46247}, '2': {'precision': 0.48021108179419525, 'recall': 0.008167478178921623, 'f1-score': 0.01606177606177606, 'support': 44567}, 'accuracy': 0.3397951130556045, 'macro avg': {'precision': 0.38169747326344955, 'recall': 0.3375100329468757, 'f1-score': 0.27012372066636986, 'support': 130511}, 'weighted avg': {'precision': 0.3842275957953894, 'recall': 0.3397951130556045, 'f1-score': 0.2700077096844726, 'support': 130511}}
[[14944 24568   185]
 [16999 29039   209]
 [16891 27312   364]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
6203/6203 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.2025762
{'0': {'precision': 0.32070428307187926, 'recall': 0.34070117018585305, 'f1-score': 0.33040043437206706, 'support': 509919}, '1': {'precision': 0.338329548273455, 'recall': 0.6548621346792324, 'f1-score': 0.4461559918599712, 'support': 537336}, '2': {'precision': 0.33229610219456274, 'recall': 0.0037531052367748823, 'f1-score': 0.0074223787095889174, 'support': 540619}, 'accuracy': 0.33229336836550005, 'macro avg': {'precision': 0.33044331117996567, 'recall': 0.3331054700339534, 'f1-score': 0.26132626831387573, 'support': 1587874}, 'weighted avg': {'precision': 0.3306153006744346, 'recall': 0.33229336836550005, 'f1-score': 0.25960864280934054, 'support': 1587874}}
[[173730 334188   2001]
 [183379 351881   2076]
 [184605 353985   2029]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1647909
{'0': {'precision': 0.33016036875210064, 'recall': 0.179882933847814, 'f1-score': 0.2328830335332941, 'support': 152905}, '1': {'precision': 0.33785591267977366, 'recall': 0.4950155007766774, 'f1-score': 0.40160800599811763, 'support': 152573}, '2': {'precision': 0.3308024087420248, 'recall': 0.327697883464266, 'f1-score': 0.3292428279004701, 'support': 146513}, 'accuracy': 0.3341725830824065, 'macro avg': {'precision': 0.3329395633912997, 'recall': 0.3341987726962525, 'f1-score': 0.32124462247729396, 'support': 451991}, 'weighted avg': {'precision': 0.33296617556843244, 'recall': 0.3341725830824065, 'f1-score': 0.3210724837125976, 'support': 451991}}
[[27505 75499 49901]
 [29822 75526 47225]
 [25981 72520 48012]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1705481
{'0': {'precision': 0.32660614304241925, 'recall': 0.21072288664843464, 'f1-score': 0.2561685129820992, 'support': 48998}, '1': {'precision': 0.35615510596116196, 'recall': 0.5549735206078747, 'f1-score': 0.43387211700731293, 'support': 52116}, '2': {'precision': 0.3067517730496454, 'recall': 0.23026960262362112, 'f1-score': 0.26306442195406776, 'support': 46958}, 'accuracy': 0.33808552596034364, 'macro avg': {'precision': 0.3298376740177422, 'recall': 0.33198866995997683, 'f1-score': 0.31770168398116, 'support': 148072}, 'weighted avg': {'precision': 0.33070990503221154, 'recall': 0.33808552596034364, 'f1-score': 0.3209006643738798, 'support': 148072}}
[[10325 26252 12421]
 [11177 28923 12016]
 [10111 26034 10813]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
5183/5183 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1611552
{'0': {'precision': 0.2754641099923719, 'recall': 0.3662160093593851, 'f1-score': 0.31442260416312195, 'support': 365836}, '1': {'precision': 0.42197809562905947, 'recall': 0.6270128770782317, 'f1-score': 0.5044575343132135, 'support': 562317}, '2': {'precision': 0.2928311057108141, 'recall': 0.0036269053167020744, 'f1-score': 0.007165066584081759, 'support': 398687}, 'accuracy': 0.367791896536131, 'macro avg': {'precision': 0.3300911037774152, 'recall': 0.3322852639181063, 'f1-score': 0.27534840168680574, 'support': 1326840}, 'weighted avg': {'precision': 0.34277539114402833, 'recall': 0.367791896536131, 'f1-score': 0.30263541500122926, 'support': 1326840}}
[[133975 230558   1303]
 [207548 352580   2189]
 [144838 252403   1446]]
Evaluating performance on  train set...
1489/1489 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1668296
{'0': {'precision': 0.3329059829059829, 'recall': 0.20992131319197424, 'f1-score': 0.25748175010151947, 'support': 129882}, '1': {'precision': 0.3395061728395062, 'recall': 0.5469593950562369, 'f1-score': 0.418958384035045, 'support': 125896}, '2': {'precision': 0.35037314594729246, 'recall': 0.269425089193784, 'f1-score': 0.30461305226682067, 'support': 125289}, 'accuracy': 0.34083507624643433, 'macro avg': {'precision': 0.3409284338975938, 'recall': 0.34210193248066506, 'f1-score': 0.3270177288011284, 'support': 381067}, 'weighted avg': {'precision': 0.3408294737938149, 'recall': 0.34083507624643433, 'f1-score': 0.32632606362823147, 'support': 381067}}
[[27265 68545 34072]
 [28521 68860 28515]
 [26114 65419 33756]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1818749
{'0': {'precision': 0.317823416154763, 'recall': 0.32568408690546097, 'f1-score': 0.32170574109949773, 'support': 42575}, '1': {'precision': 0.3625629142005284, 'recall': 0.5197190250507786, 'f1-score': 0.4271442855279746, 'support': 47264}, '2': {'precision': 0.329574697047677, 'recall': 0.1641460629646028, 'f1-score': 0.21914569268581027, 'support': 42913}, 'accuracy': 0.3425485115101844, 'macro avg': {'precision': 0.3366536758009895, 'recall': 0.33651639164028074, 'f1-score': 0.32266523977109424, 'support': 132752}, 'weighted avg': {'precision': 0.3375508052155129, 'recall': 0.3425485115101844, 'f1-score': 0.3260920253459947, 'support': 132752}}
[[13866 21562  7147]
 [15518 24564  7182]
 [14244 21625  7044]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
7324/7324 - 97s - 97s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1404119
{'0': {'precision': 0.2789465815479839, 'recall': 0.35265799098409456, 'f1-score': 0.31150104137536677, 'support': 529065}, '1': {'precision': 0.4368334837417157, 'recall': 0.6352019870641927, 'f1-score': 0.5176647684620291, 'support': 824533}, '2': {'precision': 0.2840942134341378, 'recall': 0.0037497025568596146, 'f1-score': 0.007401711409014633, 'support': 521108}, 'accuracy': 0.3799411747762049, 'macro avg': {'precision': 0.33329142624127917, 'recall': 0.3305365602017156, 'f1-score': 0.2788558404154702, 'support': 1874706}, 'weighted avg': {'precision': 0.3498192588016088, 'recall': 0.3799411747762049, 'f1-score': 0.3176461130537212, 'support': 1874706}}
[[186579 340503   1983]
 [297847 523745   2941]
 [184444 334710   1954]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1899989
{'0': {'precision': 0.32714003594344715, 'recall': 0.27241999362680386, 'f1-score': 0.297282947866504, 'support': 175736}, '1': {'precision': 0.3311357137999929, 'recall': 0.5980735039535863, 'f1-score': 0.4262624452118891, 'support': 170984}, '2': {'precision': 0.34549218567763007, 'recall': 0.13386280446472953, 'f1-score': 0.19296159984366348, 'support': 177032}, 'accuracy': 0.33189944859399106, 'macro avg': {'precision': 0.3345893118070234, 'recall': 0.33478543401503985, 'f1-score': 0.30550233097401885, 'support': 523752}, 'weighted avg': {'precision': 0.3346476249442824, 'recall': 0.33189944859399106, 'f1-score': 0.30412819808210956, 'support': 523752}}
[[ 47874 102861  25001]
 [ 48830 102261  19893]
 [ 49637 103697  23698]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1498716
{'0': {'precision': 0.3009118091121703, 'recall': 0.35803730252382043, 'f1-score': 0.3269983995110064, 'support': 56779}, '1': {'precision': 0.41795511681231756, 'recall': 0.5904, 'f1-score': 0.4894321392369574, 'support': 76875}, '2': {'precision': 0.3872311927970831, 'recall': 0.09303489702517162, 'f1-score': 0.15002522522522524, 'support': 55936}, 'accuracy': 0.37407036236088403, 'macro avg': {'precision': 0.36869937290719035, 'recall': 0.347157399849664, 'f1-score': 0.32215192132439635, 'support': 189590}, 'weighted avg': {'precision': 0.37383794089785577, 'recall': 0.37407036236088403, 'f1-score': 0.34064849848554635, 'support': 189590}}
[[20329 31901  4549]
 [27802 45387  3686]
 [19427 31305  5204]]
testing model on single stock: results/universal/W6/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
29350/29350 - 397s - 397s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1562564
{'0': {'precision': 0.2933571477028438, 'recall': 0.3589377467487227, 'f1-score': 0.32285076729788625, 'support': 2204672}, '1': {'precision': 0.4124360870219059, 'recall': 0.63714688859928, 'f1-score': 0.5007367224807433, 'support': 3099199}, '2': {'precision': 0.29192900081812684, 'recall': 0.0037143595501854918, 'f1-score': 0.0073353872775228975, 'support': 2209533}, 'accuracy': 0.3692323745668408, 'macro avg': {'precision': 0.33257407851429216, 'recall': 0.3332663316327294, 'f1-score': 0.2769742923520508, 'support': 7513404}, 'weighted avg': {'precision': 0.34205595213131174, 'recall': 0.3692323745668408, 'f1-score': 0.30344043481133587, 'support': 7513404}}
[[ 791340 1404993    8339]
 [1112987 1974645   11567]
 [ 793204 1408122    8207]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1932567
{'0': {'precision': 0.3320375067139716, 'recall': 0.2913650438035656, 'f1-score': 0.31037448469797846, 'support': 473135}, '1': {'precision': 0.3329459177384658, 'recall': 0.5671679225809315, 'f1-score': 0.4195830261392726, 'support': 450535}, '2': {'precision': 0.3560993717607146, 'recall': 0.16062568222040885, 'f1-score': 0.2213893214065572, 'support': 471805}, 'accuracy': 0.33620666798043675, 'macro avg': {'precision': 0.3403609320710507, 'recall': 0.3397195495349687, 'f1-score': 0.3171156107479361, 'support': 1395475}, 'weighted avg': {'precision': 0.34046601972875085, 'recall': 0.33620666798043675, 'f1-score': 0.3155473650803174, 'support': 1395475}}
[[137855 256131  79149]
 [137122 255529  57884]
 [140202 255819  75784]]
Evaluating performance on  val set...
1969/1969 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1703626
{'0': {'precision': 0.3119034339893236, 'recall': 0.2391898084501879, 'f1-score': 0.27074954612259017, 'support': 163665}, '1': {'precision': 0.37619041827314853, 'recall': 0.5129750229426269, 'f1-score': 0.43406160316038384, 'support': 180886}, '2': {'precision': 0.33760690240795777, 'recall': 0.2791576809268268, 'f1-score': 0.30561274913523306, 'support': 159512}, 'accuracy': 0.3500871914820171, 'macro avg': {'precision': 0.3419002515568099, 'recall': 0.34377417077321387, 'f1-score': 0.3368079661394024, 'support': 504063}, 'weighted avg': {'precision': 0.3431071269672988, 'recall': 0.3500871914820171, 'f1-score': 0.34038759531146345, 'support': 504063}}
[[39147 77398 47120]
 [47849 92790 40247]
 [38514 76469 44529]]
training model: results/universal/W6/deepLOB_L2/h500
Epoch 1/50
9426/9426 - 383s - loss: 3.1912 - accuracy500: 0.4302 - val_loss: 3.3194 - val_accuracy500: 0.3787 - 383s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 378s - loss: 3.1568 - accuracy500: 0.4459 - val_loss: 3.3818 - val_accuracy500: 0.3794 - 378s/epoch - 40ms/step
Epoch 3/50
9426/9426 - 379s - loss: 3.1434 - accuracy500: 0.4510 - val_loss: 3.4656 - val_accuracy500: 0.3744 - 379s/epoch - 40ms/step
Epoch 4/50
9426/9426 - 382s - loss: 3.1348 - accuracy500: 0.4540 - val_loss: 3.4500 - val_accuracy500: 0.3736 - 382s/epoch - 41ms/step
Epoch 5/50
9426/9426 - 379s - loss: 3.1238 - accuracy500: 0.4580 - val_loss: 3.5232 - val_accuracy500: 0.3550 - 379s/epoch - 40ms/step
Epoch 6/50
9426/9426 - 379s - loss: 3.1159 - accuracy500: 0.4605 - val_loss: 3.4504 - val_accuracy500: 0.3463 - 379s/epoch - 40ms/step
Epoch 7/50
9426/9426 - 382s - loss: 3.1092 - accuracy500: 0.4629 - val_loss: 3.4780 - val_accuracy500: 0.3381 - 382s/epoch - 40ms/step
Epoch 8/50
9426/9426 - 378s - loss: 3.1035 - accuracy500: 0.4649 - val_loss: 3.6150 - val_accuracy500: 0.3355 - 378s/epoch - 40ms/step
Epoch 9/50
9426/9426 - 381s - loss: 3.0986 - accuracy500: 0.4659 - val_loss: 3.6644 - val_accuracy500: 0.3540 - 381s/epoch - 40ms/step
Epoch 10/50
9426/9426 - 377s - loss: 3.0941 - accuracy500: 0.4680 - val_loss: 3.6213 - val_accuracy500: 0.3561 - 377s/epoch - 40ms/step
Epoch 11/50
9426/9426 - 377s - loss: 3.0902 - accuracy500: 0.4686 - val_loss: 3.6841 - val_accuracy500: 0.3409 - 377s/epoch - 40ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 561s - 561s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956624
{'0': {'precision': 0.3590970853582402, 'recall': 0.008932698579355311, 'f1-score': 0.017431774080404836, 'support': 3284002}, '1': {'precision': 0.38504077274525705, 'recall': 0.9826093821084214, 'f1-score': 0.5532769830808731, 'support': 4167592}, '2': {'precision': 0.30250882625589237, 'recall': 0.009110389407891512, 'f1-score': 0.017688082557071095, 'support': 3367035}, 'accuracy': 0.3840713088506871, 'macro avg': {'precision': 0.3488822281197965, 'recall': 0.33355082336522274, 'f1-score': 0.19613227990611637, 'support': 10818629}, 'weighted avg': {'precision': 0.3514794893595197, 'recall': 0.3840713088506871, 'f1-score': 0.2239318034168773, 'support': 10818629}}
[[  29335 3228671   25996]
 [  27746 4095115   44731]
 [  24610 3311750   30675]]
Evaluating performance on  train set...
9426/9426 - 129s - 129s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197951
{'0': {'precision': 0.38021423713443664, 'recall': 0.04964184759283103, 'f1-score': 0.08781793666793208, 'support': 810828}, '1': {'precision': 0.34176628625110467, 'recall': 0.8477312182658222, 'f1-score': 0.48714007235096607, 'support': 796066}, '2': {'precision': 0.35442515222764814, 'recall': 0.14600306716088934, 'f1-score': 0.20681151581511725, 'support': 805305}, 'accuracy': 0.345194571426321, 'macro avg': {'precision': 0.35880189187106315, 'recall': 0.3477920443398475, 'f1-score': 0.26058984161133847, 'support': 2412199}, 'weighted avg': {'precision': 0.3589161661673432, 'recall': 0.345194571426321, 'f1-score': 0.25932654749140643, 'support': 2412199}}
[[ 40251 649458 121119]
 [ 28172 674850  93044]
 [ 37441 650287 117577]]
Evaluating performance on  val set...
3323/3323 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068181
{'0': {'precision': 0.3081489476524555, 'recall': 0.028186823618758305, 'f1-score': 0.05164921948656932, 'support': 263350}, '1': {'precision': 0.3913360897881258, 'recall': 0.8511114660049262, 'f1-score': 0.5361524219307732, 'support': 325606}, '2': {'precision': 0.3201277359896998, 'recall': 0.14460961564215882, 'f1-score': 0.19922456714663378, 'support': 261345}, 'accuracy': 0.3790928153677345, 'macro avg': {'precision': 0.33987092447676037, 'recall': 0.3413026350886144, 'f1-score': 0.26234206952132544, 'support': 850301}, 'weighted avg': {'precision': 0.3436855741414566, 'recall': 0.3790928153677345, 'f1-score': 0.2825383151941681, 'support': 850301}}
[[  7423 215053  40874]
 [  9090 277127  39389]
 [  7576 215976  37793]]
testing model out of sample: results/universal/W6/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 234s - 234s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.085647
{'0': {'precision': 0.3899198965122643, 'recall': 0.0060610232201303, 'f1-score': 0.011936502134238051, 'support': 1293016}, '1': {'precision': 0.4163074043615121, 'recall': 0.9878850196631558, 'f1-score': 0.585765656198078, 'support': 1857535}, '2': {'precision': 0.37707498819290175, 'recall': 0.016152502038076055, 'f1-score': 0.030978019933020108, 'support': 1334592}, 'accuracy': 0.4156890872821669, 'macro avg': {'precision': 0.3944340963555593, 'recall': 0.3366995149737873, 'f1-score': 0.2095600594217787, 'support': 4485143}, 'weighted avg': {'precision': 0.39702624908764433, 'recall': 0.4156890872821669, 'f1-score': 0.2552554765830097, 'support': 4485143}}
[[   7837 1265464   19715]
 [   6607 1835031   15897]
 [   5655 1307380   21557]]
Evaluating performance on  train set...
5153/5153 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.123985
{'0': {'precision': 0.36588547661801496, 'recall': 0.05295683040930477, 'f1-score': 0.0925223398371933, 'support': 450178}, '1': {'precision': 0.33209641094446307, 'recall': 0.8038461092359975, 'f1-score': 0.4700139365969611, 'support': 431085}, '2': {'precision': 0.3372681040722258, 'recall': 0.16194964239331247, 'f1-score': 0.21882414730598118, 'support': 437352}, 'accuracy': 0.3345897020737668, 'macro avg': {'precision': 0.34508333054490126, 'recall': 0.3395841940128716, 'f1-score': 0.2604534745800452, 'support': 1318615}, 'weighted avg': {'precision': 0.3453473934826577, 'recall': 0.3345897020737668, 'f1-score': 0.25782404889501065, 'support': 1318615}}
[[ 23840 352046  74292]
 [ 19672 346526  64887]
 [ 21645 344878  70829]]
Evaluating performance on  val set...
1795/1795 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1070693
{'0': {'precision': 0.30856063600825756, 'recall': 0.048654638639747894, 'f1-score': 0.08405523116684215, 'support': 144385}, '1': {'precision': 0.3710902769058899, 'recall': 0.8537624900521709, 'f1-score': 0.5173241509380045, 'support': 169635}, '2': {'precision': 0.33676496248473214, 'recall': 0.10657684024518195, 'f1-score': 0.16191275167785235, 'support': 144872}, 'accuracy': 0.36455854536579413, 'macro avg': {'precision': 0.33880529179962654, 'recall': 0.3363313229790335, 'f1-score': 0.25443071126089967, 'support': 458892}, 'weighted avg': {'precision': 0.34057957035222014, 'recall': 0.36455854536579413, 'f1-score': 0.2687979329721737, 'support': 458892}}
[[  7025 123171  14189]
 [  8588 144828  16219]
 [  7154 122278  15440]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
1059/1059 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1209308
{'0': {'precision': 0.3254437869822485, 'recall': 0.0006322275099432145, 'f1-score': 0.0012620033729908331, 'support': 86994}, '1': {'precision': 0.2990978795175375, 'recall': 0.9973729001702065, 'f1-score': 0.4601910420241236, 'support': 81078}, '2': {'precision': 0.3850467289719626, 'recall': 0.002000097092091849, 'f1-score': 0.003979522843620207, 'support': 102995}, 'accuracy': 0.29928394087070725, 'macro avg': {'precision': 0.3365294651572495, 'recall': 0.3333350749240805, 'f1-score': 0.1551441894135782, 'support': 271067}, 'weighted avg': {'precision': 0.3402103632339013, 'recall': 0.29928394087070725, 'f1-score': 0.1395633809424995, 'support': 271067}}
[[    55  86764    175]
 [    59  80865    154]
 [    55 102734    206]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1233534
{'0': {'precision': 0.40584088620342396, 'recall': 0.04428328113839899, 'f1-score': 0.07985337098132463, 'support': 18201}, '1': {'precision': 0.3429845641926241, 'recall': 0.8252988601612454, 'f1-score': 0.4845823607188912, 'support': 17985}, '2': {'precision': 0.32551454524548695, 'recall': 0.15928655826253305, 'f1-score': 0.21390253116735927, 'support': 17773}, 'accuracy': 0.3424822550454975, 'macro avg': {'precision': 0.3581133318805117, 'recall': 0.3429562331873925, 'f1-score': 0.259446087622525, 'support': 53959}, 'weighted avg': {'precision': 0.3584324648240498, 'recall': 0.3424822550454975, 'f1-score': 0.2589061074000227, 'support': 53959}}
[[  806 14194  3201]
 [  477 14843  2665]
 [  703 14239  2831]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157182
{'0': {'precision': 0.23529411764705882, 'recall': 0.0005810575246949448, 'f1-score': 0.0011592522822779306, 'support': 6884}, '1': {'precision': 0.32688809189666823, 'recall': 0.9428785607196402, 'f1-score': 0.48546837006445637, 'support': 6670}, '2': {'precision': 0.3931933381607531, 'recall': 0.07666243117323168, 'f1-score': 0.12830812854442344, 'support': 7083}, 'accuracy': 0.33124969714590297, 'macro avg': {'precision': 0.3184585159014934, 'recall': 0.3400406831391889, 'f1-score': 0.2049785836303859, 'support': 20637}, 'weighted avg': {'precision': 0.3190917620306122, 'recall': 0.33124969714590297, 'f1-score': 0.20133065830892458, 'support': 20637}}
[[   4 6418  462]
 [   5 6289  376]
 [   8 6532  543]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1254004
{'0': {'precision': 0.3968612183020948, 'recall': 0.11690704070965319, 'f1-score': 0.18061010889761742, 'support': 197054}, '1': {'precision': 0.27625976758164694, 'recall': 0.8598824179036606, 'f1-score': 0.41817110561058707, 'support': 153935}, '2': {'precision': 0.4726479014142149, 'recall': 0.04992650802647632, 'f1-score': 0.09031310686993052, 'support': 208186}, 'accuracy': 0.29650288371261235, 'macro avg': {'precision': 0.38192296243265217, 'recall': 0.34223865554659666, 'f1-score': 0.22969810712604502, 'support': 559175}, 'weighted avg': {'precision': 0.39187698634202456, 'recall': 0.29650288371261235, 'f1-score': 0.21238974919783643, 'support': 559175}}
[[ 23037 168141   5876]
 [ 15848 132366   5721]
 [ 19163 178629  10394]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1304778
{'0': {'precision': 0.366584226435834, 'recall': 0.055905957295224525, 'f1-score': 0.09701641788331121, 'support': 47723}, '1': {'precision': 0.31503512586769256, 'recall': 0.692360712234348, 'f1-score': 0.43303324448020925, 'support': 43525}, '2': {'precision': 0.3346730653869226, 'recall': 0.2478123750721805, 'f1-score': 0.2847663527550213, 'support': 45026}, 'accuracy': 0.3225927176130443, 'macro avg': {'precision': 0.3387641392301497, 'recall': 0.33202634820058435, 'f1-score': 0.2716053383728472, 'support': 136274}, 'weighted avg': {'precision': 0.3395760917981434, 'recall': 0.3225927176130443, 'f1-score': 0.2663719878758527, 'support': 136274}}
[[ 2668 33833 11222]
 [ 2430 30135 10960]
 [ 2180 31688 11158]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1352366
{'0': {'precision': 0.3897511702389751, 'recall': 0.09578590457737951, 'f1-score': 0.15377885783718104, 'support': 16516}, '1': {'precision': 0.32473685884186093, 'recall': 0.5776018099547511, 'f1-score': 0.41573879943819086, 'support': 17680}, '2': {'precision': 0.2278670447385003, 'recall': 0.20655433385691846, 'f1-score': 0.21668788854767435, 'support': 14006}, 'accuracy': 0.3046969005435459, 'macro avg': {'precision': 0.31411835793977877, 'recall': 0.293314016129683, 'f1-score': 0.26206851527434877, 'support': 48202}, 'weighted avg': {'precision': 0.3188661014189961, 'recall': 0.30469690054354587, 'f1-score': 0.26814248697366966, 'support': 48202}}
[[ 1582 11193  3741]
 [ 1406 10212  6062]
 [ 1071 10042  2893]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
1214/1214 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1344104
{'0': {'precision': 0.4052363976389457, 'recall': 0.059759891753065994, 'f1-score': 0.10415946883778222, 'support': 116031}, '1': {'precision': 0.27078535402085385, 'recall': 0.7857303944260466, 'f1-score': 0.40276594709046215, 'support': 84249}, '2': {'precision': 0.38767990554322823, 'recall': 0.17247344158961028, 'f1-score': 0.23873636705528395, 'support': 110417}, 'accuracy': 0.2966716769070831, 'macro avg': {'precision': 0.3545672190676759, 'recall': 0.33932124258957425, 'f1-score': 0.24855392766117612, 'support': 310697}, 'weighted avg': {'precision': 0.3625391679858964, 'recall': 0.2966716769070831, 'f1-score': 0.23295657520440927, 'support': 310697}}
[[ 6934 91642 17455]
 [ 5428 66197 12624]
 [ 4749 86624 19044]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1353204
{'0': {'precision': 0.4238696277360601, 'recall': 0.05641919911532654, 'f1-score': 0.09958334897338689, 'support': 47023}, '1': {'precision': 0.30391454508516624, 'recall': 0.7041670795758597, 'f1-score': 0.42458192356240715, 'support': 40364}, '2': {'precision': 0.3190711399063442, 'recall': 0.22830652009271796, 'f1-score': 0.266163663362363, 'support': 43573}, 'accuracy': 0.3132559560171045, 'macro avg': {'precision': 0.3489517709091902, 'recall': 0.3296309329279681, 'f1-score': 0.26344297863271904, 'support': 130960}, 'weighted avg': {'precision': 0.3520289781764626, 'recall': 0.3132559560171045, 'f1-score': 0.25517777859756274, 'support': 130960}}
[[ 2653 33543 10827]
 [ 1538 28423 10403]
 [ 2068 31557  9948]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1192496
{'0': {'precision': 0.3594382932757224, 'recall': 0.09246908434069752, 'f1-score': 0.14709620379068356, 'support': 14394}, '1': {'precision': 0.31958388774646185, 'recall': 0.7754053855748771, 'f1-score': 0.4526200826605564, 'support': 13629}, '2': {'precision': 0.3771957340025094, 'recall': 0.15901877810103146, 'f1-score': 0.22372093023255812, 'support': 15124}, 'accuracy': 0.3315178343801423, 'macro avg': {'precision': 0.3520726383415645, 'recall': 0.34229774933886875, 'f1-score': 0.2744790722279327, 'support': 43147}, 'weighted avg': {'precision': 0.35307372194037195, 'recall': 0.3315178343801423, 'f1-score': 0.27046184468864654, 'support': 43147}}
[[ 1331 11082  1981]
 [ 1071 10568  1990]
 [ 1301 11418  2405]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1095/1095 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1398267
{'0': {'precision': 0.21671525753158405, 'recall': 0.004474542262352646, 'f1-score': 0.008768049698721163, 'support': 99675}, '1': {'precision': 0.24794165654760403, 'recall': 0.9936319528677872, 'f1-score': 0.3968556524146363, 'support': 69252}, '2': {'precision': 0.4203187250996016, 'recall': 0.001898130656159479, 'f1-score': 0.0037791947270382578, 'support': 111162}, 'accuracy': 0.24802116470121996, 'macro avg': {'precision': 0.29499187972626323, 'recall': 0.33333487526209976, 'f1-score': 0.1364676322801319, 'support': 280089}, 'weighted avg': {'precision': 0.3052423301636881, 'recall': 0.24802116470121996, 'f1-score': 0.10274272048879267, 'support': 280089}}
[[   446  99059    170]
 [   320  68811    121]
 [  1292 109659    211]]
Evaluating performance on  train set...
448/448 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1163874
{'0': {'precision': 0.32442196531791906, 'recall': 0.037012612315555186, 'f1-score': 0.06644469108398075, 'support': 36393}, '1': {'precision': 0.3311786190503797, 'recall': 0.9072980914312941, 'f1-score': 0.4852375929950237, 'support': 37777}, '2': {'precision': 0.3444637178375253, 'recall': 0.058993909986631676, 'f1-score': 0.10073554277984442, 'support': 40394}, 'accuracy': 0.33173597290597395, 'macro avg': {'precision': 0.3333547674019413, 'recall': 0.3344348712444936, 'f1-score': 0.21747260895294962, 'support': 114564}, 'weighted avg': {'precision': 0.333716444031373, 'recall': 0.33173597290597395, 'f1-score': 0.21663047474111727, 'support': 114564}}
[[ 1347 32546  2500]
 [ 1467 34275  2035]
 [ 1338 36673  2383]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1233983
{'0': {'precision': 0.3895463510848126, 'recall': 0.03425548521377157, 'f1-score': 0.06297329613391789, 'support': 11531}, '1': {'precision': 0.29738840162324914, 'recall': 0.9051698376332304, 'f1-score': 0.4476906022909226, 'support': 10039}, '2': {'precision': 0.418045582266625, 'recall': 0.101416344770128, 'f1-score': 0.16323296354992076, 'support': 13203}, 'accuracy': 0.31118971615908897, 'macro avg': {'precision': 0.36832677832489563, 'recall': 0.3469472225390433, 'f1-score': 0.22463228732492044, 'support': 34773}, 'weighted avg': {'precision': 0.3737611641480753, 'recall': 0.31118971615908897, 'f1-score': 0.2121092759286913, 'support': 34773}}
[[  395 10037  1099]
 [  187  9087   765]
 [  432 11432  1339]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
1722/1722 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.123947
{'0': {'precision': 0.30625, 'recall': 0.0006568760850185333, 'f1-score': 0.001310940332149474, 'support': 149191}, '1': {'precision': 0.29354987639215185, 'recall': 0.9975114958074114, 'f1-score': 0.4536103125680909, 'support': 129395}, '2': {'precision': 0.3721227621483376, 'recall': 0.0017939376005622237, 'f1-score': 0.00357066167673855, 'support': 162213}, 'accuracy': 0.2936984884266979, 'macro avg': {'precision': 0.32397421284682987, 'recall': 0.3333207698309974, 'f1-score': 0.1528306381923263, 'support': 440799}, 'weighted avg': {'precision': 0.3267629455196831, 'recall': 0.2936984884266979, 'f1-score': 0.13491340641973015, 'support': 440799}}
[[    98 148832    261]
 [    92 129073    230]
 [   130 161792    291]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.123045
{'0': {'precision': 0.32016371533578347, 'recall': 0.07073652352040158, 'f1-score': 0.11587236808295168, 'support': 54187}, '1': {'precision': 0.33129010038155826, 'recall': 0.8340640283704527, 'f1-score': 0.4742200655853939, 'support': 51321}, '2': {'precision': 0.36437343507809705, 'recall': 0.11654113833539899, 'f1-score': 0.1765989107037085, 'support': 52445}, 'accuracy': 0.3339601020556748, 'macro avg': {'precision': 0.33860908359847963, 'recall': 0.3404472300754178, 'f1-score': 0.25556378145735137, 'support': 157953}, 'weighted avg': {'precision': 0.3384577392468193, 'recall': 0.3339601020556748, 'f1-score': 0.2524672140894753, 'support': 157953}}
[[ 3833 44389  5965]
 [ 3819 42805  4697]
 [ 4320 42013  6112]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273026
{'0': {'precision': 0.3262717083384653, 'recall': 0.13691337605954104, 'f1-score': 0.1928860086649434, 'support': 19348}, '1': {'precision': 0.3125124975004999, 'recall': 0.6894022937803265, 'f1-score': 0.4300701706108971, 'support': 18136}, '2': {'precision': 0.3688163966090782, 'recall': 0.17217713655946298, 'f1-score': 0.23475974181209658, 'support': 19962}, 'accuracy': 0.32359085053789644, 'macro avg': {'precision': 0.3358668674826812, 'recall': 0.3328309354664435, 'f1-score': 0.28590530702931233, 'support': 57446}, 'weighted avg': {'precision': 0.33671177413069864, 'recall': 0.32359085053789644, 'f1-score': 0.2823170468945031, 'support': 57446}}
[[ 2649 13797  2902]
 [ 2653 12503  2980]
 [ 2817 13708  3437]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
4450/4450 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0603329
{'0': {'precision': 0.23841846258272525, 'recall': 0.010137414273912211, 'f1-score': 0.01944791453991148, 'support': 277191}, '1': {'precision': 0.5110937991299165, 'recall': 0.9307628800426643, 'f1-score': 0.6598535670314968, 'support': 585033}, '2': {'precision': 0.23525516795865634, 'recall': 0.05260800947644792, 'f1-score': 0.08598742093814656, 'support': 276897}, 'accuracy': 0.4932785893684692, 'macro avg': {'precision': 0.3282558098904327, 'recall': 0.33116943459767484, 'f1-score': 0.2550963008365183, 'support': 1139121}, 'weighted avg': {'precision': 0.37769090455745147, 'recall': 0.4932785893684692, 'f1-score': 0.3645236613633497, 'support': 1139121}}
[[  2810 259626  14755]
 [  7908 544527  32598]
 [  1068 261262  14567]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1163257
{'0': {'precision': 0.3758544431041415, 'recall': 0.029177201360926427, 'f1-score': 0.05415073572007879, 'support': 128148}, '1': {'precision': 0.34111380718470735, 'recall': 0.9034735720107844, 'f1-score': 0.49524415077803463, 'support': 127592}, '2': {'precision': 0.364409303836885, 'recall': 0.1042617311878772, 'f1-score': 0.1621348111559545, 'support': 129079}, 'accuracy': 0.34424755534420076, 'macro avg': {'precision': 0.3604591847085779, 'recall': 0.34563750151986267, 'f1-score': 0.2371765658846893, 'support': 384819}, 'weighted avg': {'precision': 0.3604966921882288, 'recall': 0.34424755534420076, 'f1-score': 0.23662215081980645, 'support': 384819}}
[[  3739 110742  13667]
 [  2510 115276   9806]
 [  3699 111922  13458]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0664822
{'0': {'precision': 0.26924073594195386, 'recall': 0.03245556492674851, 'f1-score': 0.05792818911685996, 'support': 32013}, '1': {'precision': 0.4840671890365765, 'recall': 0.9798214916364337, 'f1-score': 0.6479993205439895, 'support': 62294}, '2': {'precision': 0.4857142857142857, 'recall': 0.007512981990940228, 'f1-score': 0.014797084104014797, 'support': 36204}, 'accuracy': 0.47772218433695246, 'macro avg': {'precision': 0.41300740356427207, 'recall': 0.3399300128513742, 'f1-score': 0.24024153125495473, 'support': 130511}, 'weighted avg': {'precision': 0.43182938720532577, 'recall': 0.47772218433695246, 'f1-score': 0.3276094614635323, 'support': 130511}}
[[ 1039 30900    74]
 [ 1043 61037   214]
 [ 1777 34155   272]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
6203/6203 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.038928
{'0': {'precision': 0.23382519863791146, 'recall': 0.0006118460524049114, 'f1-score': 0.0012204984491967523, 'support': 336686}, '1': {'precision': 0.5558590314488996, 'recall': 0.9974881773253904, 'f1-score': 0.7138942394821483, 'support': 882626}, '2': {'precision': 0.2399103139013453, 'recall': 0.0020322225297236284, 'f1-score': 0.004030305313115442, 'support': 368562}, 'accuracy': 0.5550591545676798, 'macro avg': {'precision': 0.3431981813293854, 'recall': 0.33337741530250636, 'f1-score': 0.23971501441482015, 'support': 1587874}, 'weighted avg': {'precision': 0.4142413878130935, 'recall': 0.5550591545676798, 'f1-score': 0.39801518202631275, 'support': 1587874}}
[[   206 335852    628]
 [   472 880409   1745]
 [   203 367610    749]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269422
{'0': {'precision': 0.36959046909903204, 'recall': 0.07943437654032531, 'f1-score': 0.13076420502444783, 'support': 156217}, '1': {'precision': 0.33314328726317644, 'recall': 0.706194281679239, 'f1-score': 0.45271890764898165, 'support': 147281}, '2': {'precision': 0.3436367231266065, 'recall': 0.245789363808395, 'f1-score': 0.2865914944406056, 'support': 148493}, 'accuracy': 0.3383164709031817, 'macro avg': {'precision': 0.348790159829605, 'recall': 0.34380600734265315, 'f1-score': 0.29002486903801167, 'support': 451991}, 'weighted avg': {'precision': 0.34918756950888524, 'recall': 0.3383164709031817, 'f1-score': 0.28686703062167757, 'support': 451991}}
[[ 12409 106842  36966]
 [ 10525 104009  32747]
 [ 10641 101354  36498]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966969
{'0': {'precision': 0.35, 'recall': 0.00047713175652648083, 'f1-score': 0.0009529643999727725, 'support': 44013}, '1': {'precision': 0.41013708679106875, 'recall': 0.8786752668456551, 'f1-score': 0.5592393852565772, 'support': 61084}, '2': {'precision': 0.27335821766009566, 'recall': 0.10906340895869691, 'f1-score': 0.15591889689126925, 'support': 42975}, 'accuracy': 0.39427440704522126, 'macro avg': {'precision': 0.3444984348170548, 'recall': 0.3294052691869595, 'f1-score': 0.23870374884927306, 'support': 148072}, 'weighted avg': {'precision': 0.3525645173529651, 'recall': 0.39427440704522126, 'f1-score': 0.27623815458054907, 'support': 148072}}
[[   21 38924  5068]
 [   20 53673  7391]
 [   19 38269  4687]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
5183/5183 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095783
{'0': {'precision': 0.33807626636311894, 'recall': 0.0014212294352407477, 'f1-score': 0.002830559559690735, 'support': 417948}, '1': {'precision': 0.3367347710419531, 'recall': 0.9965847392003008, 'f1-score': 0.5033823196925165, 'support': 446818}, '2': {'precision': 0.34320621991854866, 'recall': 0.0020061721715569367, 'f1-score': 0.003989026948523478, 'support': 462074}, 'accuracy': 0.33674972114196133, 'macro avg': {'precision': 0.3393390857745402, 'recall': 0.33333738026903276, 'f1-score': 0.1700673020669102, 'support': 1326840}, 'weighted avg': {'precision': 0.33941102707485427, 'recall': 0.33674972114196133, 'f1-score': 0.17179654944487388, 'support': 1326840}}
[[   594 416519    835]
 [   587 445292    939]
 [   576 460571    927]]
Evaluating performance on  train set...
1489/1489 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1174314
{'0': {'precision': 0.4217871919965417, 'recall': 0.05266810610734115, 'f1-score': 0.093643100505234, 'support': 129680}, '1': {'precision': 0.35944653789336567, 'recall': 0.8036495096508214, 'f1-score': 0.49672429810697005, 'support': 128072}, '2': {'precision': 0.37052883574639317, 'recall': 0.2359648055792077, 'f1-score': 0.28831881731617176, 'support': 123315}, 'accuracy': 0.36437949232024813, 'macro avg': {'precision': 0.38392085521210023, 'recall': 0.3640941404457901, 'f1-score': 0.29289540530945857, 'support': 381067}, 'weighted avg': {'precision': 0.3842478184656691, 'recall': 0.36437949232024813, 'f1-score': 0.2921117455408585, 'support': 381067}}
[[  6830  93811  29039]
 [  4753 102925  20394]
 [  4610  89607  29098]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102974
{'0': {'precision': 0.24486845909222318, 'recall': 0.01991816386040824, 'f1-score': 0.03683970162886284, 'support': 42524}, '1': {'precision': 0.3675837148490721, 'recall': 0.9051637909477369, 'f1-score': 0.5228428534458374, 'support': 47988}, '2': {'precision': 0.3490650845019777, 'recall': 0.09192708333333334, 'f1-score': 0.14552882092796646, 'support': 42240}, 'accuracy': 0.3628344582379173, 'macro avg': {'precision': 0.32050575281442434, 'recall': 0.33900301271382616, 'f1-score': 0.23507045866755558, 'support': 132752}, 'weighted avg': {'precision': 0.32238235832212325, 'recall': 0.3628344582379173, 'f1-score': 0.24710657255048443, 'support': 132752}}
[[  847 37425  4252]
 [ 1562 43437  2989]
 [ 1050 37307  3883]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
7324/7324 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030576
{'0': {'precision': 0.3095093882495457, 'recall': 0.0008458668397024403, 'f1-score': 0.001687122894191642, 'support': 604114}, '1': {'precision': 0.36283116262128523, 'recall': 0.9973316161584976, 'f1-score': 0.5320877698688159, 'support': 680187}, '2': {'precision': 0.3001179245283019, 'recall': 0.0017242401402427147, 'f1-score': 0.0034287812164763383, 'support': 590405}, 'accuracy': 0.3626707334376697, 'macro avg': {'precision': 0.3241528251330443, 'recall': 0.33330057437948096, 'f1-score': 0.17906789132649462, 'support': 1874706}, 'weighted avg': {'precision': 0.32589809698907574, 'recall': 0.3626707334376697, 'f1-score': 0.19467733503705414, 'support': 1874706}}
[[   511 602450   1153]
 [   594 678372   1221]
 [   546 588841   1018]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118373
{'0': {'precision': 0.3639961305074312, 'recall': 0.023712403322830134, 'f1-score': 0.04452428719725044, 'support': 174550}, '1': {'precision': 0.3359123492295145, 'recall': 0.8988193000792493, 'f1-score': 0.4890528282667317, 'support': 174134}, '2': {'precision': 0.33313236149092396, 'recall': 0.08837137569401604, 'f1-score': 0.13968732647431933, 'support': 175068}, 'accuracy': 0.3362755655348333, 'macro avg': {'precision': 0.3443469470759566, 'recall': 0.3369676930320318, 'f1-score': 0.22442148064610049, 'support': 523752}, 'weighted avg': {'precision': 0.34434255499224337, 'recall': 0.3362755655348333, 'f1-score': 0.2241274885802541, 'support': 523752}}
[[  4139 153730  16681]
 [  3330 156515  14289]
 [  3902 155695  15471]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051558
{'0': {'precision': 0.27884260965720603, 'recall': 0.050647742108258294, 'f1-score': 0.08572480806821722, 'support': 59746}, '1': {'precision': 0.36923786477550435, 'recall': 0.8791859204746421, 'f1-score': 0.5200617544333271, 'support': 70116}, '2': {'precision': 0.37213643305616834, 'recall': 0.07343289579426734, 'f1-score': 0.12266129708868194, 'support': 59728}, 'accuracy': 0.36424389472018565, 'macro avg': {'precision': 0.3400723024962929, 'recall': 0.33442218612572255, 'f1-score': 0.2428159531967421, 'support': 189590}, 'weighted avg': {'precision': 0.3416645263819691, 'recall': 0.36424389472018565, 'f1-score': 0.257991868290541, 'support': 189590}}
[[ 3026 53014  3706]
 [ 4777 61645  3694]
 [ 3049 52293  4386]]
testing model on single stock: results/universal/W6/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
29350/29350 - 385s - 385s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094683
{'0': {'precision': 0.3089839441107979, 'recall': 0.0010998484381803159, 'f1-score': 0.0021918946847205986, 'support': 2292134}, '1': {'precision': 0.387666320293986, 'recall': 0.9970616853799106, 'f1-score': 0.5582717083695309, 'support': 2912554}, '2': {'precision': 0.3096588919240737, 'recall': 0.00191491720939258, 'f1-score': 0.00380629644600737, 'support': 2308716}, 'accuracy': 0.387432647039877, 'macro avg': {'precision': 0.3354363854429525, 'recall': 0.3333588170091612, 'f1-score': 0.18808996650008628, 'support': 7513404}, 'weighted avg': {'precision': 0.33969238628927306, 'recall': 0.387432647039877, 'f1-score': 0.2182510445512338, 'support': 7513404}}
[[   2521 2285236    4377]
 [   3079 2903996    5479]
 [   2559 2301736    4421]]
Evaluating performance on  train set...
5452/5452 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1206264
{'0': {'precision': 0.3761251701476809, 'recall': 0.05480673258204588, 'f1-score': 0.09567261781771272, 'support': 468884}, '1': {'precision': 0.3405186750278547, 'recall': 0.8540862557177086, 'f1-score': 0.48690962622259504, 'support': 459100}, '2': {'precision': 0.34887070786433694, 'recall': 0.13107418110722988, 'f1-score': 0.19055497160769483, 'support': 467491}, 'accuracy': 0.3433132087640409, 'macro avg': {'precision': 0.35517151767995747, 'recall': 0.34665572313566145, 'f1-score': 0.25771240521600086, 'support': 1395475}, 'weighted avg': {'precision': 0.3552805418047762, 'recall': 0.3433132087640409, 'f1-score': 0.2561724884813319, 'support': 1395475}}
[[ 25698 378745  64441]
 [ 17065 392111  49924]
 [ 25560 380655  61276]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124436
{'0': {'precision': 0.30703098399727613, 'recall': 0.02243633604120274, 'f1-score': 0.041816896020033155, 'support': 160766}, '1': {'precision': 0.38132952350610305, 'recall': 0.81664134751206, 'f1-score': 0.5198948713293619, 'support': 187605}, '2': {'precision': 0.3253669365081118, 'recall': 0.18922616447858592, 'f1-score': 0.23928784636064962, 'support': 155692}, 'accuracy': 0.3695450767066815, 'macro avg': {'precision': 0.3379091480038303, 'recall': 0.34276794934394955, 'f1-score': 0.2669998712366815, 'support': 504063}, 'weighted avg': {'precision': 0.3403473325943176, 'recall': 0.3695450767066815, 'f1-score': 0.2807443034241431, 'support': 504063}}
[[  3607 125582  31577]
 [  4890 153206  29509]
 [  3251 122980  29461]]
training model: results/universal/W6/deepLOB_L2/h1000
Epoch 1/50
9426/9426 - 385s - loss: 3.1337 - accuracy1000: 0.4547 - val_loss: 3.4281 - val_accuracy1000: 0.3515 - 385s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 375s - loss: 3.0805 - accuracy1000: 0.4749 - val_loss: 3.6366 - val_accuracy1000: 0.3170 - 375s/epoch - 40ms/step
Epoch 3/50
9426/9426 - 377s - loss: 3.0591 - accuracy1000: 0.4825 - val_loss: 3.4905 - val_accuracy1000: 0.3400 - 377s/epoch - 40ms/step
Epoch 4/50
9426/9426 - 379s - loss: 3.0409 - accuracy1000: 0.4876 - val_loss: 3.6733 - val_accuracy1000: 0.3330 - 379s/epoch - 40ms/step
Epoch 5/50
9426/9426 - 377s - loss: 3.0333 - accuracy1000: 0.4898 - val_loss: 3.6208 - val_accuracy1000: 0.3581 - 377s/epoch - 40ms/step
Epoch 6/50
9426/9426 - 378s - loss: 3.0264 - accuracy1000: 0.4919 - val_loss: 3.6449 - val_accuracy1000: 0.3440 - 378s/epoch - 40ms/step
Epoch 7/50
9426/9426 - 379s - loss: 3.0179 - accuracy1000: 0.4940 - val_loss: 3.6545 - val_accuracy1000: 0.3374 - 379s/epoch - 40ms/step
Epoch 8/50
9426/9426 - 379s - loss: 3.0149 - accuracy1000: 0.4947 - val_loss: 3.6168 - val_accuracy1000: 0.3491 - 379s/epoch - 40ms/step
Epoch 9/50
9426/9426 - 377s - loss: 3.0100 - accuracy1000: 0.4959 - val_loss: 3.6203 - val_accuracy1000: 0.3508 - 377s/epoch - 40ms/step
Epoch 10/50
9426/9426 - 376s - loss: 3.0043 - accuracy1000: 0.4974 - val_loss: 3.7307 - val_accuracy1000: 0.3426 - 376s/epoch - 40ms/step
Epoch 11/50
9426/9426 - 376s - loss: 3.0006 - accuracy1000: 0.4985 - val_loss: 3.8053 - val_accuracy1000: 0.3317 - 376s/epoch - 40ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 557s - 557s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1167222
{'0': {'precision': 0.304018088187732, 'recall': 0.28511420769367046, 'f1-score': 0.2942628572365317, 'support': 3273860}, '1': {'precision': 0.38466315815595326, 'recall': 0.6947929657141825, 'f1-score': 0.49517761870293736, 'support': 4149675}, '2': {'precision': 0.3206805248182106, 'recall': 0.02390066372241829, 'f1-score': 0.04448575627978578, 'support': 3395094}, 'accuracy': 0.3602798469196051, 'macro avg': {'precision': 0.33645392372063193, 'recall': 0.3346026123767571, 'f1-score': 0.2779754107397516, 'support': 10818629}, 'weighted avg': {'precision': 0.34017991325354174, 'recall': 0.3602798469196051, 'f1-score': 0.29294237808824636, 'support': 10818629}}
[[ 933424 2259945   80491]
 [1175106 2883165   91404]
 [ 961761 2352188   81145]]
Evaluating performance on  train set...
9426/9426 - 128s - 128s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1555344
{'0': {'precision': 0.3241129173221465, 'recall': 0.22012821273817296, 'f1-score': 0.2621867156845417, 'support': 808656}, '1': {'precision': 0.3532585668906851, 'recall': 0.5705347286282456, 'f1-score': 0.43634497365206265, 'support': 793524}, '2': {'precision': 0.3593771500123841, 'recall': 0.2579433321934424, 'f1-score': 0.30032679057446005, 'support': 810019}, 'accuracy': 0.3480973170124024, 'macro avg': {'precision': 0.3455828780750719, 'recall': 0.3495354245199536, 'f1-score': 0.33295282663702147, 'support': 2412199}, 'weighted avg': {'precision': 0.3455425219806919, 'recall': 0.3480973170124024, 'f1-score': 0.3322858007176073, 'support': 2412199}}
[[178008 410496 220152]
 [188490 452733 152301]
 [182718 418362 208939]]
Evaluating performance on  val set...
3323/3323 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1435864
{'0': {'precision': 0.30737163969932474, 'recall': 0.2232652834588832, 'f1-score': 0.25865300083624587, 'support': 270145}, '1': {'precision': 0.3788710994293498, 'recall': 0.5606159471786855, 'f1-score': 0.45216414857890225, 'support': 309572}, '2': {'precision': 0.32927725227293597, 'recall': 0.23851742896845343, 'f1-score': 0.27664353409660813, 'support': 270584}, 'accuracy': 0.35093925562830103, 'macro avg': {'precision': 0.3385066638005368, 'recall': 0.3407995532020074, 'f1-score': 0.3291535611705854, 'support': 850301}, 'weighted avg': {'precision': 0.3403735284659631, 'recall': 0.35093925562830103, 'f1-score': 0.3348302409908635, 'support': 850301}}
[[ 60314 140384  69447]
 [ 74005 173551  62016]
 [ 61906 144139  64539]]
testing model out of sample: results/universal/W6/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 238s - 238s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.121863
{'0': {'precision': 0.30736803098194754, 'recall': 0.28217690793471717, 'f1-score': 0.29423426393871005, 'support': 1375676}, '1': {'precision': 0.3729398663697105, 'recall': 0.7001008489627136, 'f1-score': 0.4866460579300364, 'support': 1659908}, '2': {'precision': 0.39120523013734765, 'recall': 0.028648713160347387, 'f1-score': 0.053387739255248236, 'support': 1449559}, 'accuracy': 0.3549084165209448, 'macro avg': {'precision': 0.35717104249633524, 'recall': 0.3369754900192594, 'f1-score': 0.2780893537079982, 'support': 4485143}, 'weighted avg': {'precision': 0.35873098210866383, 'recall': 0.3549084165209448, 'f1-score': 0.2876045151585531, 'support': 4485143}}
[[ 388184  952315   35177]
 [ 468356 1162103   29449]
 [ 406389 1001642   41528]]
Evaluating performance on  train set...
5153/5153 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1596498
{'0': {'precision': 0.32700674885948045, 'recall': 0.19378551144297948, 'f1-score': 0.2433568042514208, 'support': 447567}, '1': {'precision': 0.35421696225311117, 'recall': 0.49335378673222713, 'f1-score': 0.4123650559238017, 'support': 438069}, '2': {'precision': 0.33997455114813124, 'recall': 0.34803304548257535, 'f1-score': 0.34395660455524346, 'support': 432979}, 'accuracy': 0.34395634813800846, 'macro avg': {'precision': 0.3403994207535743, 'recall': 0.34505744788592735, 'f1-score': 0.33322615491015534, 'support': 1318615}, 'weighted avg': {'precision': 0.34030459321759265, 'recall': 0.34395634813800846, 'f1-score': 0.3325374041517837, 'support': 1318615}}
[[ 86732 196983 163852]
 [ 93247 216123 128699]
 [ 85251 197037 150691]]
Evaluating performance on  val set...
1795/1795 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1365681
{'0': {'precision': 0.3183242186085256, 'recall': 0.23897793547860843, 'f1-score': 0.27300258582532866, 'support': 147114}, '1': {'precision': 0.37867116416672647, 'recall': 0.5720541377295644, 'f1-score': 0.4556950485453197, 'support': 166021}, '2': {'precision': 0.34740173286085907, 'recall': 0.23272295670190796, 'f1-score': 0.27872752147708085, 'support': 145757}, 'accuracy': 0.35749370222187354, 'macro avg': {'precision': 0.3481323718787037, 'recall': 0.3479183433033603, 'f1-score': 0.3358083852825764, 'support': 458892}, 'weighted avg': {'precision': 0.3493927739404892, 'recall': 0.35749370222187354, 'f1-score': 0.3409166806429068, 'support': 458892}}
[[35157 78513 33444]
 [40771 94973 30277]
 [34516 77320 33921]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
1059/1059 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1449255
{'0': {'precision': 0.2985109055027296, 'recall': 0.2872823245029846, 'f1-score': 0.2927889993589663, 'support': 81084}, '1': {'precision': 0.3248928244401898, 'recall': 0.7107395688693633, 'f1-score': 0.4459385153711572, 'support': 87862}, '2': {'precision': 0.3987878787878788, 'recall': 0.003221668412961095, 'f1-score': 0.006391700503176422, 'support': 102121}, 'accuracy': 0.31752297402487206, 'macro avg': {'precision': 0.34073053624359934, 'recall': 0.33374785392843637, 'f1-score': 0.24837307174443332, 'support': 271067}, 'weighted avg': {'precision': 0.3448402371828524, 'recall': 0.31752297402487206, 'f1-score': 0.2345334544915018, 'support': 271067}}
[[23294 57567   223]
 [25142 62447   273]
 [29598 72194   329]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1748803
{'0': {'precision': 0.3342577003070219, 'recall': 0.18177411536597188, 'f1-score': 0.2354870220485627, 'support': 18567}, '1': {'precision': 0.3384386932541366, 'recall': 0.4367369285518752, 'f1-score': 0.38135532448906423, 'support': 18265}, '2': {'precision': 0.2819337670017741, 'recall': 0.33403398143282537, 'f1-score': 0.3057804858494348, 'support': 17127}, 'accuracy': 0.31640690153635165, 'macro avg': {'precision': 0.31821005352097753, 'recall': 0.3175150084502241, 'f1-score': 0.3075409441290206, 'support': 53959}, 'weighted avg': {'precision': 0.3190649397010075, 'recall': 0.31640690153635165, 'f1-score': 0.3071747979264199, 'support': 53959}}
[[3375 7602 7590]
 [3307 7977 6981]
 [3415 7991 5721]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1202968
{'0': {'precision': 0.34500100583383625, 'recall': 0.2529498525073746, 'f1-score': 0.2918900519104757, 'support': 6780}, '1': {'precision': 0.3484425848442585, 'recall': 0.628072625698324, 'f1-score': 0.4482208711252866, 'support': 7160}, '2': {'precision': 0.4492753623188406, 'recall': 0.18515753322383158, 'f1-score': 0.2622396108702549, 'support': 6697}, 'accuracy': 0.3610989969472307, 'macro avg': {'precision': 0.3809063176656451, 'recall': 0.3553933371431767, 'f1-score': 0.3341168446353391, 'support': 20637}, 'weighted avg': {'precision': 0.3800335721513581, 'recall': 0.3610989969472307, 'f1-score': 0.3365069856669174, 'support': 20637}}
[[1715 4448  617]
 [1760 4497  903]
 [1496 3961 1240]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0952848
{'0': {'precision': 0.29383015797432854, 'recall': 0.3808713110361995, 'f1-score': 0.33173627931706745, 'support': 147433}, '1': {'precision': 0.44556882392614044, 'recall': 0.6573946709368297, 'f1-score': 0.5311410064773293, 'support': 239179}, '2': {'precision': 0.5361612435779213, 'recall': 0.04717117806250471, 'f1-score': 0.08671336120802152, 'support': 172563}, 'accuracy': 0.39616935664148073, 'macro avg': {'precision': 0.4251867418261301, 'recall': 0.3618123866785113, 'f1-score': 0.31653021566747275, 'support': 559175}, 'weighted avg': {'precision': 0.4335182368560761, 'recall': 0.39616935664148073, 'f1-score': 0.34141398919288984, 'support': 559175}}
[[ 56153  88117   3163]
 [ 78065 157235   3879]
 [ 56889 107534   8140]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1712521
{'0': {'precision': 0.3151868654136963, 'recall': 0.12189314507707089, 'f1-score': 0.1757990179835527, 'support': 47878}, '1': {'precision': 0.36948775561153857, 'recall': 0.3737116360213943, 'f1-score': 0.37158769286953347, 'support': 43563}, '2': {'precision': 0.35039418158133984, 'recall': 0.5759819775611714, 'f1-score': 0.4357209145364043, 'support': 44833}, 'accuracy': 0.3517839059541806, 'macro avg': {'precision': 0.34502293420219154, 'recall': 0.35719558621987885, 'f1-score': 0.3277025417964969, 'support': 136274}, 'weighted avg': {'precision': 0.3441282576486976, 'recall': 0.3517839059541806, 'f1-score': 0.32389931908436415, 'support': 136274}}
[[ 5836 14341 27701]
 [ 7110 16280 20173]
 [ 5570 13440 25823]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2154369
{'0': {'precision': 0.45903096755074824, 'recall': 0.1569243237767197, 'f1-score': 0.2338907553508739, 'support': 19742}, '1': {'precision': 0.22586928293175587, 'recall': 0.2361236802413273, 'f1-score': 0.23088267826856426, 'support': 13260}, '2': {'precision': 0.28694139393280416, 'recall': 0.5208552631578948, 'f1-score': 0.37003108130214296, 'support': 15200}, 'accuracy': 0.29347329986307624, 'macro avg': {'precision': 0.32394721480510275, 'recall': 0.3046344223919806, 'f1-score': 0.27826817164052703, 'support': 48202}, 'weighted avg': {'precision': 0.34062331938178037, 'recall': 0.29347329986307624, 'f1-score': 0.2759936940743265, 'support': 48202}}
[[ 3098  5697 10947]
 [ 1402  3131  8727]
 [ 2249  5034  7917]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1508831
{'0': {'precision': 0.37997845580528705, 'recall': 0.2291183905624605, 'f1-score': 0.28586604170317154, 'support': 113928}, '1': {'precision': 0.3087923977983723, 'recall': 0.49542293385088143, 'f1-score': 0.38045242274699437, 'support': 92745}, '2': {'precision': 0.401171648677067, 'recall': 0.3594362839344767, 'f1-score': 0.37915893442041115, 'support': 104024}, 'accuracy': 0.3522435041213787, 'macro avg': {'precision': 0.36331416742690886, 'recall': 0.3613258694492729, 'f1-score': 0.3484924662901923, 'support': 310697}, 'weighted avg': {'precision': 0.36582463309519564, 'recall': 0.3522435041213787, 'f1-score': 0.34533592323381873, 'support': 310697}}
[[26103 56644 31181]
 [22166 45948 24631]
 [20427 46207 37390]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1634008
{'0': {'precision': 0.339107088728186, 'recall': 0.17644938149207995, 'f1-score': 0.23211903844443785, 'support': 44381}, '1': {'precision': 0.3500055348511125, 'recall': 0.40851439522814875, 'f1-score': 0.3770034081537345, 'support': 46439}, '2': {'precision': 0.3058045280909345, 'recall': 0.4088440458395615, 'f1-score': 0.3498960609775598, 'support': 40140}, 'accuracy': 0.3299709835064142, 'macro avg': {'precision': 0.33163905055674436, 'recall': 0.33126927418659674, 'f1-score': 0.3196728358585774, 'support': 130960}, 'weighted avg': {'precision': 0.3327642982236297, 'recall': 0.3299709835064142, 'f1-score': 0.3195950229390128, 'support': 130960}}
[[ 7831 18834 17716]
 [ 7930 18971 19538]
 [ 7332 16397 16411]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1404002
{'0': {'precision': 0.3299630354424875, 'recall': 0.22841875517423046, 'f1-score': 0.2699577496108517, 'support': 13287}, '1': {'precision': 0.34979630840416437, 'recall': 0.44503455336575376, 'f1-score': 0.3917096111064177, 'support': 15628}, '2': {'precision': 0.33115313521967865, 'recall': 0.32729061270376614, 'f1-score': 0.3292105449148349, 'support': 14232}, 'accuracy': 0.3394905787192621, 'macro avg': {'precision': 0.33697082635544345, 'recall': 0.3335813070812501, 'f1-score': 0.33029263521070146, 'support': 43147}, 'weighted avg': {'precision': 0.33753927225788766, 'recall': 0.3394905787192621, 'f1-score': 0.3336011981523261, 'support': 43147}}
[[3035 6385 3867]
 [3132 6955 5541]
 [3031 6543 4658]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1095/1095 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1644306
{'0': {'precision': 0.354784799391377, 'recall': 0.2867352081443403, 'f1-score': 0.3171508046669008, 'support': 99210}, '1': {'precision': 0.2730536156283105, 'recall': 0.7154640531474051, 'f1-score': 0.3952585830983459, 'support': 76015}, '2': {'precision': 0.34610123119015046, 'recall': 0.0024126487641135184, 'f1-score': 0.004791893555566079, 'support': 104864}, 'accuracy': 0.29664142469000926, 'macro avg': {'precision': 0.32464654873661264, 'recall': 0.3348706366852863, 'f1-score': 0.23906709377360424, 'support': 280089}, 'weighted avg': {'precision': 0.3293522060742424, 'recall': 0.29664142469000926, 'f1-score': 0.22140323129803335, 'support': 280089}}
[[28447 70491   272]
 [21423 54386   206]
 [30311 74300   253]]
Evaluating performance on  train set...
448/448 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1475642
{'0': {'precision': 0.3045450096251101, 'recall': 0.26812593358611975, 'f1-score': 0.28517743389193567, 'support': 34812}, '1': {'precision': 0.3306077040745376, 'recall': 0.6328089648380314, 'f1-score': 0.4343116031385014, 'support': 37569}, '2': {'precision': 0.37451062057476053, 'recall': 0.10658322072872958, 'f1-score': 0.16594079870081938, 'support': 42183}, 'accuracy': 0.32823574595859084, 'macro avg': {'precision': 0.3365544447581361, 'recall': 0.3358393730509603, 'f1-score': 0.2951432785770855, 'support': 114564}, 'weighted avg': {'precision': 0.3388534200721933, 'recall': 0.32823574595859084, 'f1-score': 0.29017955167900117, 'support': 114564}}
[[ 9334 21563  3915]
 [10201 23774  3594]
 [11114 26573  4496]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1481986
{'0': {'precision': 0.34040681693238045, 'recall': 0.2763545478889583, 'f1-score': 0.30505468519065915, 'support': 11203}, '1': {'precision': 0.2990205053094105, 'recall': 0.6411816665030916, 'f1-score': 0.40784093392015486, 'support': 10189}, '2': {'precision': 0.49843342036553523, 'recall': 0.142664972722517, 'f1-score': 0.22183487304630758, 'support': 13381}, 'accuracy': 0.33180916228108015, 'macro avg': {'precision': 0.37928691420244204, 'recall': 0.35340039570485565, 'f1-score': 0.3115768307190405, 'support': 34773}, 'weighted avg': {'precision': 0.3890902452075538, 'recall': 0.33180916228108015, 'f1-score': 0.30314874615753756, 'support': 34773}}
[[3096 7214  893]
 [2628 6533 1028]
 [3371 8101 1909]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
1722/1722 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1538424
{'0': {'precision': 0.32659353265935326, 'recall': 0.28612607833831205, 'f1-score': 0.30502345618845306, 'support': 143276}, '1': {'precision': 0.29781129287531727, 'recall': 0.7141308082929251, 'f1-score': 0.4203327819927367, 'support': 130955}, '2': {'precision': 0.3808764940239044, 'recall': 0.002869698861726142, 'f1-score': 0.005696477836768499, 'support': 166568}, 'accuracy': 0.30624388893804205, 'macro avg': {'precision': 0.33509377318619166, 'recall': 0.3343755284976544, 'f1-score': 0.24368423867265276, 'support': 440799}, 'weighted avg': {'precision': 0.33855505275729386, 'recall': 0.30624388893804205, 'f1-score': 0.22617127329016284, 'support': 440799}}
[[ 40995 101877    404]
 [ 37063  93519    373]
 [ 47465 118625    478]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.160527
{'0': {'precision': 0.32718775677896467, 'recall': 0.23290500648887752, 'f1-score': 0.27211087738780393, 'support': 54709}, '1': {'precision': 0.34777834525025536, 'recall': 0.5380664533206906, 'f1-score': 0.4224845279272852, 'support': 50622}, '2': {'precision': 0.3555506402221731, 'recall': 0.27492303599255064, 'f1-score': 0.31008134089228495, 'support': 52622}, 'accuracy': 0.3447038042962147, 'macro avg': {'precision': 0.3435055807504644, 'recall': 0.3486314986007062, 'f1-score': 0.3348922487357913, 'support': 157953}, 'weighted avg': {'precision': 0.3432358750302305, 'recall': 0.3447038042962147, 'f1-score': 0.33295363864047034, 'support': 157953}}
[[12742 26007 15960]
 [13122 27238 10262]
 [13080 25075 14467]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1640507
{'0': {'precision': 0.3475725771803842, 'recall': 0.2873306611192856, 'f1-score': 0.3145936336870174, 'support': 19709}, '1': {'precision': 0.329148113000949, 'recall': 0.5130568356374808, 'f1-score': 0.4010227904391329, 'support': 17577}, '2': {'precision': 0.3987640857869866, 'recall': 0.2720734126984127, 'f1-score': 0.3234556980687011, 'support': 20160}, 'accuracy': 0.3510427183789994, 'macro avg': {'precision': 0.3584949253227732, 'recall': 0.35748696981839306, 'f1-score': 0.34635737406495054, 'support': 57446}, 'weighted avg': {'precision': 0.35990022412929573, 'recall': 0.3510427183789994, 'f1-score': 0.34414877253335446, 'support': 57446}}
[[5663 9201 4845]
 [5134 9018 3425]
 [5496 9179 5485]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
4450/4450 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.116473
{'0': {'precision': 0.29455770637135653, 'recall': 0.23167195872779242, 'f1-score': 0.2593573312920723, 'support': 340762}, '1': {'precision': 0.41412315363343155, 'recall': 0.5917152472910493, 'f1-score': 0.4872412587070299, 'support': 462633}, '2': {'precision': 0.3045825181715624, 'recall': 0.1905929239915884, 'f1-score': 0.23446749492036564, 'support': 335726}, 'accuracy': 0.36578993803116616, 'macro avg': {'precision': 0.33775445939211685, 'recall': 0.33799337667014334, 'f1-score': 0.32702202830648924, 'support': 1139121}, 'weighted avg': {'precision': 0.3460715591838597, 'recall': 0.36578993803116616, 'f1-score': 0.34457256284871685, 'support': 1139121}}
[[ 78945 192981  68836]
 [111628 273747  77258]
 [ 77439 194300  63987]]
Evaluating performance on  train set...
1504/1504 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1447718
{'0': {'precision': 0.31631069884131646, 'recall': 0.22606876592532008, 'f1-score': 0.2636824363060976, 'support': 127156}, '1': {'precision': 0.36948193193778506, 'recall': 0.6194251656667843, 'f1-score': 0.46286735620733105, 'support': 127515}, '2': {'precision': 0.40082330193974924, 'recall': 0.2468881580969358, 'f1-score': 0.3055636123301936, 'support': 130148}, 'accuracy': 0.3634539874590392, 'macro avg': {'precision': 0.36220531090628355, 'recall': 0.36412736322968003, 'f1-score': 0.34403780161454073, 'support': 384819}, 'weighted avg': {'precision': 0.3625123574297724, 'recall': 0.3634539874590392, 'f1-score': 0.34384951838465877, 'support': 384819}}
[[28746 66144 32266]
 [32762 78986 15767]
 [29371 68645 32132]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166424
{'0': {'precision': 0.26749165878193315, 'recall': 0.3121603951765219, 'f1-score': 0.28810491170199926, 'support': 34415}, '1': {'precision': 0.40712212547443627, 'recall': 0.6947725367675074, 'f1-score': 0.5134016554986205, 'support': 52492}, '2': {'precision': 0.5123537061118335, 'recall': 0.00903586826896615, 'f1-score': 0.017758546864084016, 'support': 43604}, 'accuracy': 0.3647738504800362, 'macro avg': {'precision': 0.39565583012273436, 'recall': 0.33865626673766513, 'f1-score': 0.27308837135490127, 'support': 130511}, 'weighted avg': {'precision': 0.4054604673068532, 'recall': 0.3647738504800362, 'f1-score': 0.28839679348192415, 'support': 130511}}
[[10743 23544   128]
 [15775 36470   247]
 [13644 29566   394]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
6203/6203 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962231
{'0': {'precision': 0.2660917377073717, 'recall': 0.28712918319359665, 'f1-score': 0.2762104628221722, 'support': 421030}, '1': {'precision': 0.43638546530688194, 'recall': 0.7123224469311396, 'f1-score': 0.5412118418283725, 'support': 691413}, '2': {'precision': 0.30402263998382856, 'recall': 0.003163445379035023, 'f1-score': 0.0062617355499211035, 'support': 475431}, 'accuracy': 0.38724924017900664, 'macro avg': {'precision': 0.3354999476660274, 'recall': 0.3342050251679238, 'f1-score': 0.2745613467334886, 'support': 1587874}, 'weighted avg': {'precision': 0.3516003006544055, 'recall': 0.38724924017900664, 'f1-score': 0.31077454354081885, 'support': 1587874}}
[[120890 298803   1337]
 [196798 492509   2106]
 [136629 337298   1504]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.163774
{'0': {'precision': 0.31359110655405953, 'recall': 0.15000290403144098, 'f1-score': 0.20293435888929146, 'support': 154957}, '1': {'precision': 0.4002279301096914, 'recall': 0.4299268130405855, 'f1-score': 0.41454613107171384, 'support': 150300}, '2': {'precision': 0.3597192444181576, 'recall': 0.5305450679460793, 'f1-score': 0.4287429436871816, 'support': 146734}, 'accuracy': 0.3666245566836508, 'macro avg': {'precision': 0.3578460936939695, 'recall': 0.3701582616727019, 'f1-score': 0.3487411445493957, 'support': 451991}, 'weighted avg': {'precision': 0.35737534288124756, 'recall': 0.3666245566836508, 'f1-score': 0.3466076759260282, 'support': 451991}}
[[23244 48854 82859]
 [29974 64618 55708]
 [20904 47981 77849]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1263987
{'0': {'precision': 0.26844656459182886, 'recall': 0.15632420807383843, 'f1-score': 0.19758749575263335, 'support': 44638}, '1': {'precision': 0.45128721415216455, 'recall': 0.5203648424543947, 'f1-score': 0.48337056150350466, 'support': 60300}, '2': {'precision': 0.3152546243434574, 'recall': 0.38405897899568786, 'f1-score': 0.3462720260864112, 'support': 43134}, 'accuracy': 0.3709141498730347, 'macro avg': {'precision': 0.3449961343624836, 'recall': 0.35358267650797365, 'f1-score': 0.3424100277808497, 'support': 148072}, 'weighted avg': {'precision': 0.3565409377198679, 'recall': 0.3709141498730347, 'f1-score': 0.3572806004327533, 'support': 148072}}
[[ 6978 18825 18835]
 [11775 31378 17147]
 [ 7241 19327 16566]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
5183/5183 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1654655
{'0': {'precision': 0.34217292505916796, 'recall': 0.287400248758957, 'f1-score': 0.31240398374723016, 'support': 454255}, '1': {'precision': 0.26861347831906635, 'recall': 0.7107579956936535, 'f1-score': 0.38988102580549666, 'support': 355754}, '2': {'precision': 0.40554854981084487, 'recall': 0.003111268480412359, 'f1-score': 0.006175162635657724, 'support': 516831}, 'accuracy': 0.29017515299508606, 'macro avg': {'precision': 0.3387783177296931, 'recall': 0.3337565043110076, 'f1-score': 0.23615339072946154, 'support': 1326840}, 'weighted avg': {'precision': 0.3471361610939995, 'recall': 0.29017515299508606, 'f1-score': 0.21389490938745917, 'support': 1326840}}
[[130553 322409   1293]
 [101835 252855   1064]
 [149153 366070   1608]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1653078
{'0': {'precision': 0.34234836901121307, 'recall': 0.1615142998842784, 'f1-score': 0.2194810631975575, 'support': 133078}, '1': {'precision': 0.3378714443899871, 'recall': 0.45820751001116, 'f1-score': 0.38894441909790306, 'support': 121864}, '2': {'precision': 0.34025199979087156, 'recall': 0.412796828543112, 'f1-score': 0.37303011739586805, 'support': 126125}, 'accuracy': 0.3395649583931435, 'macro avg': {'precision': 0.34015727106402394, 'recall': 0.34417287947951686, 'f1-score': 0.3271518665637762, 'support': 381067}, 'weighted avg': {'precision': 0.34022280970023455, 'recall': 0.3395649583931435, 'f1-score': 0.3244963409943797, 'support': 381067}}
[[21494 56066 55518]
 [20591 55839 45434]
 [20699 53362 52064]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1464472
{'0': {'precision': 0.3288939697056302, 'recall': 0.26066275566830505, 'f1-score': 0.2908300585046564, 'support': 44149}, '1': {'precision': 0.3290040957102824, 'recall': 0.5476687075287627, 'f1-score': 0.411066129127284, 'support': 44589}, '2': {'precision': 0.3236468688928541, 'recall': 0.17308129231608124, 'f1-score': 0.2255447655139744, 'support': 44014}, 'accuracy': 0.32802518982764856, 'macro avg': {'precision': 0.3271816447695889, 'recall': 0.3271375851710497, 'f1-score': 0.3091469843819716, 'support': 132752}, 'weighted avg': {'precision': 0.3271912798271192, 'recall': 0.32802518982764856, 'f1-score': 0.3095698083185987, 'support': 132752}}
[[11508 25109  7532]
 [11781 24420  8388]
 [11701 24695  7618]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
7324/7324 - 98s - 98s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127841
{'0': {'precision': 0.3294603522178403, 'recall': 0.28707017674792895, 'f1-score': 0.30680797494737355, 'support': 616358}, '1': {'precision': 0.35078806424634273, 'recall': 0.7112582257246934, 'f1-score': 0.46984938140136595, 'support': 656933}, '2': {'precision': 0.3180049522461974, 'recall': 0.0029896161552339065, 'f1-score': 0.005923544111130694, 'support': 601415}, 'accuracy': 0.34457936337751094, 'macro avg': {'precision': 0.33275112290346015, 'recall': 0.3337726728759521, 'f1-score': 0.2608603001532901, 'support': 1874706}, 'weighted avg': {'precision': 0.3332590430376673, 'recall': 0.34457936337751094, 'f1-score': 0.2674155957127958, 'support': 1874706}}
[[176938 437550   1870]
 [187698 467249   1986]
 [172418 427199   1798]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1532315
{'0': {'precision': 0.3307611393949594, 'recall': 0.22466605316856528, 'f1-score': 0.26758070445355153, 'support': 174953}, '1': {'precision': 0.33206233365108323, 'recall': 0.5636007260370093, 'f1-score': 0.4179039658071146, 'support': 172443}, '2': {'precision': 0.32357396154463, 'recall': 0.2059243802308966, 'f1-score': 0.25167885235108634, 'support': 176356}, 'accuracy': 0.3299481433961111, 'macro avg': {'precision': 0.3287991448635575, 'recall': 0.3313970531454904, 'f1-score': 0.31238784087058413, 'support': 523752}, 'weighted avg': {'precision': 0.328769509585691, 'recall': 0.3299481433961111, 'f1-score': 0.3117195471275845, 'support': 523752}}
[[39306 96052 39595]
 [38931 97189 36323]
 [40598 99442 36316]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.13741
{'0': {'precision': 0.327086535434529, 'recall': 0.2817065390749601, 'f1-score': 0.3027052038971388, 'support': 62700}, '1': {'precision': 0.3558350042494905, 'recall': 0.6598323030785238, 'f1-score': 0.4623392496260996, 'support': 65356}, '2': {'precision': 0.4142241978052507, 'recall': 0.09692202684694641, 'f1-score': 0.15708792077121636, 'support': 61534}, 'accuracy': 0.3520808059496809, 'macro avg': {'precision': 0.36571524582975673, 'recall': 0.34615362300014346, 'f1-score': 0.3073774580981516, 'support': 189590}, 'weighted avg': {'precision': 0.3652784962140565, 'recall': 0.3520808059496809, 'f1-score': 0.31047264307004585, 'support': 189590}}
[[17663 39793  5244]
 [19042 43124  3190]
 [17296 38274  5964]]
testing model on single stock: results/universal/W6/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
29350/29350 - 388s - 388s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080656
{'0': {'precision': 0.2973006537315724, 'recall': 0.2863479974912642, 'f1-score': 0.2917215577231802, 'support': 2232200}, '1': {'precision': 0.40141614158719313, 'recall': 0.7107271855585403, 'f1-score': 0.5130586275785826, 'support': 3016094}, '2': {'precision': 0.30667525220004294, 'recall': 0.0031539307141816514, 'f1-score': 0.006243650053202997, 'support': 2265110}, 'accuracy': 0.3713296929061714, 'macro avg': {'precision': 0.3351306825062695, 'recall': 0.3334097045879954, 'f1-score': 0.2703412784516553, 'support': 7513404}, 'weighted avg': {'precision': 0.3419217861723846, 'recall': 0.3713296929061714, 'f1-score': 0.2945078507171571, 'support': 7513404}}
[[ 639186 1586163    6851]
 [ 863174 2143620    9300]
 [ 647605 1610361    7144]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1551672
{'0': {'precision': 0.3240474753803025, 'recall': 0.240996968213479, 'f1-score': 0.27641881982659794, 'support': 465732}, '1': {'precision': 0.3523305065898748, 'recall': 0.598784483373037, 'f1-score': 0.4436267803395786, 'support': 463013}, '2': {'precision': 0.3593245289207031, 'recall': 0.20187474557024404, 'f1-score': 0.2585126216309279, 'support': 466730}, 'accuracy': 0.34662462602339705, 'macro avg': {'precision': 0.34523417029696013, 'recall': 0.3472187323855867, 'f1-score': 0.32618607393236815, 'support': 1395475}, 'weighted avg': {'precision': 0.3452304204909988, 'recall': 0.34662462602339705, 'f1-score': 0.3259088497713348, 'support': 1395475}}
[[112240 252797 100695]
 [118467 277245  67301]
 [115662 256847  94221]]
Evaluating performance on  val set...
1969/1969 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1428274
{'0': {'precision': 0.30432237475687823, 'recall': 0.20065240668343334, 'f1-score': 0.24184580754079907, 'support': 160636}, '1': {'precision': 0.39791044776119405, 'recall': 0.5429534177590165, 'f1-score': 0.4592520671510899, 'support': 189042}, '2': {'precision': 0.33237754905527145, 'recall': 0.30183631829517116, 'f1-score': 0.3163715612524781, 'support': 154385}, 'accuracy': 0.360018489752273, 'macro avg': {'precision': 0.3448701238577812, 'recall': 0.3484807142458737, 'f1-score': 0.3391564786481223, 'support': 504063}, 'weighted avg': {'precision': 0.3480140850806657, 'recall': 0.360018489752273, 'f1-score': 0.3462069144183643, 'support': 504063}}
[[ 32232  78491  49913]
 [ 42714 102641  43687]
 [ 30968  76818  46599]]
training model: results/universal/W6/deepOF_L2/h300
Epoch 1/50
9426/9426 - 208s - loss: 3.2307 - accuracy300: 0.4006 - val_loss: 3.3073 - val_accuracy300: 0.3533 - 208s/epoch - 22ms/step
Epoch 2/50
9426/9426 - 207s - loss: 3.2160 - accuracy300: 0.4072 - val_loss: 3.3079 - val_accuracy300: 0.3536 - 207s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 207s - loss: 3.2105 - accuracy300: 0.4103 - val_loss: 3.2975 - val_accuracy300: 0.3554 - 207s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 205s - loss: 3.2075 - accuracy300: 0.4121 - val_loss: 3.2904 - val_accuracy300: 0.3576 - 205s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 205s - loss: 3.2046 - accuracy300: 0.4142 - val_loss: 3.2859 - val_accuracy300: 0.3628 - 205s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 205s - loss: 3.2025 - accuracy300: 0.4155 - val_loss: 3.2818 - val_accuracy300: 0.3665 - 205s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 206s - loss: 3.2007 - accuracy300: 0.4164 - val_loss: 3.2791 - val_accuracy300: 0.3740 - 206s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 204s - loss: 3.1992 - accuracy300: 0.4176 - val_loss: 3.2784 - val_accuracy300: 0.3741 - 204s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 205s - loss: 3.1976 - accuracy300: 0.4184 - val_loss: 3.2791 - val_accuracy300: 0.3758 - 205s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 205s - loss: 3.1962 - accuracy300: 0.4194 - val_loss: 3.2793 - val_accuracy300: 0.3750 - 205s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 204s - loss: 3.1949 - accuracy300: 0.4203 - val_loss: 3.2785 - val_accuracy300: 0.3760 - 204s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 205s - loss: 3.1938 - accuracy300: 0.4210 - val_loss: 3.2788 - val_accuracy300: 0.3763 - 205s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 206s - loss: 3.1923 - accuracy300: 0.4220 - val_loss: 3.2840 - val_accuracy300: 0.3743 - 206s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 206s - loss: 3.1906 - accuracy300: 0.4228 - val_loss: 3.2854 - val_accuracy300: 0.3762 - 206s/epoch - 22ms/step
Epoch 15/50
9426/9426 - 205s - loss: 3.1891 - accuracy300: 0.4237 - val_loss: 3.2862 - val_accuracy300: 0.3753 - 205s/epoch - 22ms/step
Epoch 16/50
9426/9426 - 204s - loss: 3.1873 - accuracy300: 0.4249 - val_loss: 3.2835 - val_accuracy300: 0.3732 - 204s/epoch - 22ms/step
Epoch 17/50
9426/9426 - 204s - loss: 3.1859 - accuracy300: 0.4256 - val_loss: 3.2897 - val_accuracy300: 0.3773 - 204s/epoch - 22ms/step
Epoch 18/50
9426/9426 - 205s - loss: 3.1846 - accuracy300: 0.4267 - val_loss: 3.2852 - val_accuracy300: 0.3760 - 205s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 314s - 314s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.086288
{'0': {'precision': 0.39263466923238227, 'recall': 0.01957427993547907, 'f1-score': 0.037289539411717844, 'support': 3252278}, '1': {'precision': 0.4021896738465117, 'recall': 0.7877090101316726, 'f1-score': 0.5324964791315365, 'support': 4266719}, '2': {'precision': 0.35743010827960947, 'recall': 0.24913451814109983, 'f1-score': 0.29361480678762303, 'support': 3299607}, 'accuracy': 0.39253123600789896, 'macro avg': {'precision': 0.3840848171195011, 'recall': 0.35213926940275053, 'f1-score': 0.28780027511029244, 'support': 10818604}, 'weighted avg': {'precision': 0.3856658684499983, 'recall': 0.39253123600789896, 'f1-score': 0.31077043446479624, 'support': 10818604}}
[[  63661 2554530  634087]
 [  62040 3360933  843746]
 [  36437 2441124  822046]]
Evaluating performance on  train set...
9426/9426 - 73s - 73s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994776
{'0': {'precision': 0.4404331162391788, 'recall': 0.02014139299555573, 'f1-score': 0.03852117867821231, 'support': 815882}, '1': {'precision': 0.34383064437711824, 'recall': 0.7417075167553164, 'f1-score': 0.4698531706325159, 'support': 786616}, '2': {'precision': 0.3950604719764012, 'recall': 0.3308060348873399, 'f1-score': 0.3600893195634581, 'support': 809692}, 'accuracy': 0.3597241510826262, 'macro avg': {'precision': 0.39310807753089944, 'recall': 0.36421831487940404, 'f1-score': 0.28948788962472877, 'support': 2412190}, 'weighted avg': {'precision': 0.3937009280265324, 'recall': 0.3597241510826262, 'f1-score': 0.2871184273662439, 'support': 2412190}}
[[ 16433 579878 219571]
 [ 12599 583439 190578]
 [  8279 533562 267851]]
Evaluating performance on  val set...
3323/3323 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939236
{'0': {'precision': 0.41755400060845754, 'recall': 0.01995166536441771, 'f1-score': 0.038083610520510694, 'support': 275165}, '1': {'precision': 0.3696932843000042, 'recall': 0.7653123751165579, 'f1-score': 0.4985540699730339, 'support': 300280}, '2': {'precision': 0.3856503906612475, 'recall': 0.30241620065998914, 'f1-score': 0.3389989498047452, 'support': 274853}, 'accuracy': 0.37447812414000736, 'macro avg': {'precision': 0.39096589185656977, 'recall': 0.36256008038032156, 'f1-score': 0.29187887676609664, 'support': 850298}, 'weighted avg': {'precision': 0.3903395195701358, 'recall': 0.37447812414000736, 'f1-score': 0.2979660909129065, 'support': 850298}}
[[  5490 202988  66687]
 [  4747 229808  65725]
 [  2911 188822  83120]]
testing model out of sample: results/universal/W6/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 132s - 132s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0895892
{'0': {'precision': 0.3931639757073026, 'recall': 0.02310037140749734, 'f1-score': 0.043636856847517606, 'support': 1378809}, '1': {'precision': 0.3825685617910255, 'recall': 0.8179410155134672, 'f1-score': 0.5213094903207266, 'support': 1681120}, '2': {'precision': 0.37903510613338603, 'recall': 0.21537774989843453, 'f1-score': 0.27467685957032134, 'support': 1425189}, 'accuracy': 0.3821219419422187, 'macro avg': {'precision': 0.38492254787723806, 'recall': 0.35213971227313307, 'f1-score': 0.27987440224618854, 'support': 4485118}, 'weighted avg': {'precision': 0.38470300060205176, 'recall': 0.3821219419422187, 'f1-score': 0.29609413623793523, 'support': 4485118}}
[[  31851 1119979  226979]
 [  30166 1375057  275897]
 [  18995 1099240  306954]]
Evaluating performance on  train set...
5152/5152 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023779
{'0': {'precision': 0.41931376917690494, 'recall': 0.01481293247488638, 'f1-score': 0.028614994309147938, 'support': 444679}, '1': {'precision': 0.3384636218122018, 'recall': 0.7924459012205441, 'f1-score': 0.4743334534810057, 'support': 438411}, '2': {'precision': 0.3862353860400509, 'recall': 0.24516440117560617, 'f1-score': 0.2999404467616522, 'support': 435520}, 'accuracy': 0.3494422156664973, 'macro avg': {'precision': 0.3813375923430526, 'recall': 0.3508077449570122, 'f1-score': 0.26762963151726865, 'support': 1318610}, 'weighted avg': {'precision': 0.38150737351778696, 'recall': 0.3494422156664973, 'f1-score': 0.26642263755173523, 'support': 1318610}}
[[  6587 354065  84027]
 [  5347 347417  85647]
 [  3775 324971 106774]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0893177
{'0': {'precision': 0.40671506352087117, 'recall': 0.015408945577061918, 'f1-score': 0.029692934512570806, 'support': 145435}, '1': {'precision': 0.37822240533781964, 'recall': 0.7791799780730192, 'f1-score': 0.5092495569766545, 'support': 169654}, '2': {'precision': 0.3750348983855285, 'recall': 0.27090403337969404, 'f1-score': 0.31457607409770144, 'support': 143800}, 'accuracy': 0.37784300778619667, 'macro avg': {'precision': 0.3866574557480731, 'recall': 0.3551643190099251, 'f1-score': 0.28450618852897563, 'support': 458889}, 'weighted avg': {'precision': 0.3862536857631788, 'recall': 0.37784300778619667, 'f1-score': 0.2962604371109408, 'support': 458889}}
[[  2241 113638  29556]
 [  2102 132191  35361]
 [  1167 103677  38956]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066854
{'0': {'precision': 0.328, 'recall': 0.017653390742734122, 'f1-score': 0.03350357507660878, 'support': 83610}, '1': {'precision': 0.3437688724010008, 'recall': 0.695457718823632, 'f1-score': 0.4601050777979851, 'support': 91672}, '2': {'precision': 0.36060217493157104, 'recall': 0.30535602422217584, 'f1-score': 0.33068756148027545, 'support': 95780}, 'accuracy': 0.3485438755709026, 'macro avg': {'precision': 0.3441236824441906, 'recall': 0.3394890445961807, 'f1-score': 0.2747654047849564, 'support': 271062}, 'weighted avg': {'precision': 0.3448529723299113, 'recall': 0.3485438755709026, 'f1-score': 0.282788591697224, 'support': 271062}}
[[ 1476 56713 25421]
 [ 1480 63754 26438]
 [ 1544 64989 29247]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1079923
{'0': {'precision': 0.34826589595375723, 'recall': 0.013392609058071686, 'f1-score': 0.025793332263070578, 'support': 17995}, '1': {'precision': 0.34243525798179614, 'recall': 0.6669959931939184, 'f1-score': 0.4525378914832607, 'support': 18219}, '2': {'precision': 0.349718785151856, 'recall': 0.3504085657931812, 'f1-score': 0.3500633356790992, 'support': 17745}, 'accuracy': 0.3449100242776923, 'macro avg': {'precision': 0.3468066463624698, 'recall': 0.3435990560150571, 'f1-score': 0.27613151980847683, 'support': 53959}, 'weighted avg': {'precision': 0.3467750070493873, 'recall': 0.3449100242776923, 'f1-score': 0.2765212985902833, 'support': 53959}}
[[  241 12021  5733]
 [  238 12152  5829]
 [  213 11314  6218]]
Evaluating performance on  val set...
81/81 - 1s - 821ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032915
{'0': {'precision': 0.37962962962962965, 'recall': 0.012351257719536074, 'f1-score': 0.023924142961342088, 'support': 6639}, '1': {'precision': 0.35859450606714804, 'recall': 0.6691207112098903, 'f1-score': 0.4669445521519969, 'support': 7199}, '2': {'precision': 0.33648203807070276, 'recall': 0.3458370108855546, 'f1-score': 0.34109539354370694, 'support': 6798}, 'accuracy': 0.35132777670091103, 'macro avg': {'precision': 0.35823539125582676, 'recall': 0.3424363266049936, 'f1-score': 0.27732136288568193, 'support': 20636}, 'weighted avg': {'precision': 0.35807752738385096, 'recall': 0.35132777670091103, 'f1-score': 0.2829585530806695, 'support': 20636}}
[[  82 4230 2327]
 [  73 4817 2309]
 [  61 4386 2351]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104718
{'0': {'precision': 0.4643985675163261, 'recall': 0.023250540526288034, 'f1-score': 0.04428396376127438, 'support': 189630}, '1': {'precision': 0.3078296363929319, 'recall': 0.8399889789075049, 'f1-score': 0.45054767104206067, 'support': 170582}, '2': {'precision': 0.4555052790346908, 'recall': 0.1927743543863529, 'f1-score': 0.2709008013165748, 'support': 198958}, 'accuracy': 0.33272528926802225, 'macro avg': {'precision': 0.4092444943146496, 'recall': 0.3520046246067153, 'f1-score': 0.25524414537330326, 'support': 559170}, 'weighted avg': {'precision': 0.4134708848820288, 'recall': 0.33272528926802225, 'f1-score': 0.24885235706152037, 'support': 559170}}
[[  4409 163791  21430]
 [  2878 143287  24417]
 [  2207 158397  38354]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.087754
{'0': {'precision': 0.5327548806941431, 'recall': 0.026152699393035887, 'f1-score': 0.04985789687373122, 'support': 46955}, '1': {'precision': 0.3356741961348116, 'recall': 0.8069075522275637, 'f1-score': 0.474115824687919, 'support': 45139}, '2': {'precision': 0.45147099257629913, 'recall': 0.2601806369830455, 'f1-score': 0.3301166063530358, 'support': 44177}, 'accuracy': 0.36064166256943886, 'macro avg': {'precision': 0.4399666898017513, 'recall': 0.36441362953454837, 'f1-score': 0.284696775971562, 'support': 136271}, 'weighted avg': {'precision': 0.4411220068933663, 'recall': 0.36064166256943886, 'f1-score': 0.2812465827443263, 'support': 136271}}
[[ 1228 39787  5940]
 [  691 36423  8025]
 [  386 32297 11494]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099734
{'0': {'precision': 0.531442663378545, 'recall': 0.024552808476700466, 'f1-score': 0.04693710863054723, 'support': 17554}, '1': {'precision': 0.3318698609278246, 'recall': 0.8309715956027197, 'f1-score': 0.47431131100270224, 'support': 15737}, '2': {'precision': 0.4154770848985725, 'recall': 0.22253521126760564, 'f1-score': 0.289832285115304, 'support': 14910}, 'accuracy': 0.3490798946079957, 'macro avg': {'precision': 0.426263203068314, 'recall': 0.3593532051156753, 'f1-score': 0.2703602349161845, 'support': 48201}, 'weighted avg': {'precision': 0.43041314184780133, 'recall': 0.3490798946079957, 'f1-score': 0.26160391853321163, 'support': 48201}}
[[  431 14864  2259]
 [  251 13077  2409]
 [  129 11463  3318]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1134139
{'0': {'precision': 0.3802714932126697, 'recall': 0.019028728761366517, 'f1-score': 0.036243822075782535, 'support': 110412}, '1': {'precision': 0.30621998863315986, 'recall': 0.7424482444338354, 'f1-score': 0.4336023268413699, 'support': 92164}, '2': {'precision': 0.3954962672867458, 'recall': 0.2989011802138444, 'f1-score': 0.3404802292625878, 'support': 108116}, 'accuracy': 0.33101592573996114, 'macro avg': {'precision': 0.3606625830441918, 'recall': 0.3534593844696821, 'f1-score': 0.2701087927265801, 'support': 310692}, 'weighted avg': {'precision': 0.3636027627842289, 'recall': 0.33101592573996114, 'f1-score': 0.259986218508984, 'support': 310692}}
[[ 2101 80936 27375]
 [ 1718 68427 22019]
 [ 1706 74094 32316]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041602
{'0': {'precision': 0.35318642048838594, 'recall': 0.013479723586106565, 'f1-score': 0.025968338770773577, 'support': 43992}, '1': {'precision': 0.35651034174099294, 'recall': 0.7350866785314086, 'f1-score': 0.48015155429260303, 'support': 45513}, '2': {'precision': 0.3450533325808454, 'recall': 0.29497044988541793, 'f1-score': 0.3180523584721626, 'support': 41455}, 'accuracy': 0.35336744043982893, 'macro avg': {'precision': 0.3515833649367414, 'recall': 0.347845617334311, 'f1-score': 0.2747240838451797, 'support': 130960}, 'weighted avg': {'precision': 0.35176708991998956, 'recall': 0.35336744043982893, 'f1-score': 0.2762705969012417, 'support': 130960}}
[[  593 31659 11740]
 [  587 33456 11470]
 [  499 28728 12228]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1013739
{'0': {'precision': 0.38492063492063494, 'recall': 0.013975938332973128, 'f1-score': 0.02697254084115398, 'support': 13881}, '1': {'precision': 0.35425556936930885, 'recall': 0.7015104132011445, 'f1-score': 0.47077472650145125, 'support': 15029}, '2': {'precision': 0.3595217762596072, 'recall': 0.3253020511379601, 'f1-score': 0.3415569568905115, 'support': 14236}, 'accuracy': 0.3561859732072498, 'macro avg': {'precision': 0.3662326601831836, 'recall': 0.34692946755735926, 'f1-score': 0.27976807474437226, 'support': 43146}, 'weighted avg': {'precision': 0.3658587654062125, 'recall': 0.3561859732072498, 'f1-score': 0.2853586437282643, 'support': 43146}}
[[  194  9759  3928]
 [  164 10543  4322]
 [  146  9459  4631]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1160903
{'0': {'precision': 0.378752107925801, 'recall': 0.011305179443297932, 'f1-score': 0.021955034213098728, 'support': 99335}, '1': {'precision': 0.24979935219422708, 'recall': 0.4875520993594226, 'f1-score': 0.33034504326071096, 'support': 71498}, '2': {'precision': 0.39889947736078096, 'recall': 0.5023020384252775, 'f1-score': 0.4446686275939746, 'support': 109251}, 'accuracy': 0.32439910883877693, 'macro avg': {'precision': 0.3424836458269363, 'recall': 0.33371977240933265, 'f1-score': 0.2656562350225948, 'support': 280084}, 'weighted avg': {'precision': 0.3536926833561895, 'recall': 0.32439910883877693, 'f1-score': 0.2655646358231166, 'support': 280084}}
[[ 1123 51378 46834]
 [  779 34859 35860]
 [ 1063 53311 54877]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071538
{'0': {'precision': 0.36004273504273504, 'recall': 0.009022033036168447, 'f1-score': 0.017602966909556268, 'support': 37353}, '1': {'precision': 0.32529014106521825, 'recall': 0.43983303833249676, 'f1-score': 0.3739877576234065, 'support': 37853}, '2': {'precision': 0.34539194491152214, 'recall': 0.548009248672409, 'f1-score': 0.4237244847841889, 'support': 39357}, 'accuracy': 0.3365309916814329, 'macro avg': {'precision': 0.34357494033982516, 'recall': 0.3322881066803581, 'f1-score': 0.27177173643905056, 'support': 114563}, 'weighted avg': {'precision': 0.34352692202260554, 'recall': 0.3365309916814329, 'f1-score': 0.27487589151770453, 'support': 114563}}
[[  337 17065 19951]
 [  278 16649 20926]
 [  321 17468 21568]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1079568
{'0': {'precision': 0.3875, 'recall': 0.01063738526207429, 'f1-score': 0.020706353844869334, 'support': 11657}, '1': {'precision': 0.298632885990217, 'recall': 0.47153183483513217, 'f1-score': 0.36567479362641586, 'support': 10099}, '2': {'precision': 0.3900145890744043, 'recall': 0.5545056464623185, 'f1-score': 0.4579368100494861, 'support': 13017}, 'accuracy': 0.3480861588013689, 'macro avg': {'precision': 0.35871582502154037, 'recall': 0.34555828885317497, 'f1-score': 0.28143931917359044, 'support': 34773}, 'weighted avg': {'precision': 0.3626319535730803, 'recall': 0.3480861588013689, 'f1-score': 0.28456811790806014, 'support': 34773}}
[[ 124 5499 6034]
 [  82 4762 5255]
 [ 114 5685 7218]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
1722/1722 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1044536
{'0': {'precision': 0.35444138530647734, 'recall': 0.016775370518966593, 'f1-score': 0.03203457533887761, 'support': 145809}, '1': {'precision': 0.3253365161007907, 'recall': 0.7025144924860613, 'f1-score': 0.4447212982939206, 'support': 135415}, '2': {'precision': 0.3991165141181044, 'recall': 0.3538823087046437, 'f1-score': 0.37514075501154276, 'support': 159570}, 'accuracy': 0.34947390390976285, 'macro avg': {'precision': 0.3596314718417908, 'recall': 0.3577240572365572, 'f1-score': 0.283965542881447, 'support': 440794}, 'weighted avg': {'precision': 0.3616728232139427, 'recall': 0.34947390390976285, 'f1-score': 0.28302126227047, 'support': 440794}}
[[  2446  96382  46981]
 [  2249  95131  38035]
 [  2206 100895  56469]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1092445
{'0': {'precision': 0.3695774647887324, 'recall': 0.01214185237284371, 'f1-score': 0.023511280755514938, 'support': 54028}, '1': {'precision': 0.3291488879269474, 'recall': 0.6252520704035084, 'f1-score': 0.4312674287489112, 'support': 51077}, '2': {'precision': 0.3497151358387855, 'recall': 0.39143186935871477, 'f1-score': 0.36939945356167075, 'support': 52847}, 'accuracy': 0.33730500405186387, 'macro avg': {'precision': 0.34948049618482174, 'recall': 0.34294193071168894, 'f1-score': 0.2747260543553656, 'support': 157952}, 'weighted avg': {'precision': 0.3498585950157176, 'recall': 0.33730500405186387, 'f1-score': 0.27109354017195547, 'support': 157952}}
[[  656 33465 19907]
 [  583 31936 18558]
 [  536 31625 20686]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056544
{'0': {'precision': 0.37251908396946565, 'recall': 0.012714293158251264, 'f1-score': 0.024589337901844203, 'support': 19191}, '1': {'precision': 0.33286230604092504, 'recall': 0.6652003910068426, 'f1-score': 0.44369985329541956, 'support': 18414}, '2': {'precision': 0.37601920864388977, 'recall': 0.3788810483870968, 'f1-score': 0.3774447038738671, 'support': 19840}, 'accuracy': 0.348333188267038, 'macro avg': {'precision': 0.3604668662180935, 'recall': 0.3522652441840635, 'f1-score': 0.2819112983570436, 'support': 57445}, 'weighted avg': {'precision': 0.3610159516649035, 'recall': 0.348333188267038, 'f1-score': 0.2808022631580411, 'support': 57445}}
[[  244 12430  6517]
 [  208 12249  5957]
 [  203 12120  7517]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/EXC
Evaluating performance on  test set...
4450/4450 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987744
{'0': {'precision': 0.48625544753603755, 'recall': 0.05908214933975545, 'f1-score': 0.10536231916955899, 'support': 392809}, '1': {'precision': 0.31634507479598617, 'recall': 0.7995918749518071, 'f1-score': 0.45333556083981147, 'support': 363124}, '2': {'precision': 0.43010405743325, 'recall': 0.19481031256605852, 'f1-score': 0.2681605989140372, 'support': 383183}, 'accuracy': 0.3407967230729794, 'macro avg': {'precision': 0.41090152658842455, 'recall': 0.351161445619207, 'f1-score': 0.27561949297446925, 'support': 1139116}, 'weighted avg': {'precision': 0.41320336828808135, 'recall': 0.3407967230729794, 'f1-score': 0.2710512996031559, 'support': 1139116}}
[[ 23208 328994  40607]
 [ 14470 290351  58303]
 [ 10050 298485  74648]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904393
{'0': {'precision': 0.47846563797484043, 'recall': 0.06002907767782866, 'f1-score': 0.106674587932964, 'support': 128621}, '1': {'precision': 0.3359042206812428, 'recall': 0.8317471054618676, 'f1-score': 0.47854587582561553, 'support': 127136}, '2': {'precision': 0.474774473772135, 'recall': 0.1981853542123492, 'f1-score': 0.2796403093995135, 'support': 129061}, 'accuracy': 0.3613240544880957, 'macro avg': {'precision': 0.42971477747607273, 'recall': 0.3633205124506818, 'f1-score': 0.28828692438603104, 'support': 384818}, 'weighted avg': {'precision': 0.4301283104792342, 'recall': 0.3613240544880957, 'f1-score': 0.2875428348333545, 'support': 384818}}
[[  7721 108949  11951]
 [  5046 105745  16345]
 [  3370 100113  25578]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0854571
{'0': {'precision': 0.4460033228724386, 'recall': 0.060785991043123835, 'f1-score': 0.106990235369661, 'support': 39746}, '1': {'precision': 0.35651754195019925, 'recall': 0.8150151449588923, 'f1-score': 0.4960462467326394, 'support': 46220}, '2': {'precision': 0.4584984305048114, 'recall': 0.20002244920866538, 'f1-score': 0.27853324580324484, 'support': 44545}, 'accuracy': 0.37541663154829863, 'macro avg': {'precision': 0.4203397651091498, 'recall': 0.3586078617368938, 'f1-score': 0.29385657596851505, 'support': 130511}, 'weighted avg': {'precision': 0.4185769892703525, 'recall': 0.37541663154829863, 'f1-score': 0.30332274561753936, 'support': 130511}}
[[ 2416 33516  3814]
 [ 1841 37670  6709]
 [ 1160 34475  8910]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/AAL
Evaluating performance on  test set...
6203/6203 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972708
{'0': {'precision': 0.45609840333678703, 'recall': 0.03366835649078768, 'f1-score': 0.06270774130865153, 'support': 509915}, '1': {'precision': 0.34044150784687993, 'recall': 0.842098798517129, 'f1-score': 0.4848636163695717, 'support': 537336}, '2': {'precision': 0.4270989276394046, 'recall': 0.17467416919155485, 'f1-score': 0.24794445195669265, 'support': 540618}, 'accuracy': 0.3552497088865643, 'macro avg': {'precision': 0.4078796129410239, 'recall': 0.35014710806649046, 'f1-score': 0.265171936544972, 'support': 1587869}, 'weighted avg': {'precision': 0.40708664471719547, 'recall': 0.3552497088865643, 'f1-score': 0.26863269438655485, 'support': 1587869}}
[[ 17168 438403  54344]
 [ 12521 452490  72325]
 [  7952 438234  94432]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930349
{'0': {'precision': 0.46865542585386943, 'recall': 0.014178274802171213, 'f1-score': 0.027523867560430633, 'support': 152910}, '1': {'precision': 0.3434810372591482, 'recall': 0.81089495693667, 'f1-score': 0.4825586157668709, 'support': 152566}, '2': {'precision': 0.4167096796393792, 'recall': 0.24796434446090107, 'f1-score': 0.3109167465425168, 'support': 146513}, 'accuracy': 0.35888705256101366, 'macro avg': {'precision': 0.40961538091746563, 'recall': 0.3576791920665808, 'f1-score': 0.2736664099566061, 'support': 451989}, 'weighted avg': {'precision': 0.4095653088699034, 'recall': 0.35888705256101366, 'f1-score': 0.27298022219111007, 'support': 451989}}
[[  2168 127160  23582]
 [  1580 123715  27271]
 [   878 109305  36330]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0864348
{'0': {'precision': 0.4890337877889745, 'recall': 0.016848081360916537, 'f1-score': 0.032573932956923436, 'support': 48967}, '1': {'precision': 0.3560708117443869, 'recall': 0.7910559435193001, 'f1-score': 0.4910912079273957, 'support': 52124}, '2': {'precision': 0.41504005231322544, 'recall': 0.27019433387965347, 'f1-score': 0.32730835675424796, 'support': 46981}, 'accuracy': 0.36976605975471394, 'macro avg': {'precision': 0.4200482172821956, 'recall': 0.35936611958662334, 'f1-score': 0.28365783254618904, 'support': 148072}, 'weighted avg': {'precision': 0.41875134512774037, 'recall': 0.36976605975471394, 'f1-score': 0.2874950011195943, 'support': 148072}}
[[  825 40552  7590]
 [  590 41233 10301]
 [  272 34015 12694]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/WBA
Evaluating performance on  test set...
5183/5183 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0720813
{'0': {'precision': 0.34678668215253583, 'recall': 0.019588172745487697, 'f1-score': 0.03708178847442542, 'support': 365833}, '1': {'precision': 0.4315026518901849, 'recall': 0.8339513121602228, 'f1-score': 0.5687321909248075, 'support': 562317}, '2': {'precision': 0.3702751607801312, 'recall': 0.2037648770332468, 'f1-score': 0.26287041890746243, 'support': 398685}, 'accuracy': 0.42005901261272127, 'macro avg': {'precision': 0.3828548316076173, 'recall': 0.3524347873129858, 'f1-score': 0.2895614661022318, 'support': 1326835}, 'weighted avg': {'precision': 0.38974736230990914, 'recall': 0.42005901261272127, 'f1-score': 0.3302415253511937, 'support': 1326835}}
[[  7166 304370  54297]
 [  9508 468945  83864]
 [  3990 313457  81238]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988677
{'0': {'precision': 0.44495238095238093, 'recall': 0.017981541208981534, 'f1-score': 0.034566184032376206, 'support': 129911}, '1': {'precision': 0.3388633232699241, 'recall': 0.8266123266123266, 'f1-score': 0.4806768808598217, 'support': 125874}, '2': {'precision': 0.41162269858351996, 'recall': 0.22592592592592592, 'f1-score': 0.29173065624967787, 'support': 125280}, 'accuracy': 0.35345413512130475, 'macro avg': {'precision': 0.39847946760194164, 'recall': 0.35683993124907804, 'f1-score': 0.2689912403806252, 'support': 381065}, 'weighted avg': {'precision': 0.39895131380138965, 'recall': 0.35345413512130475, 'f1-score': 0.2664722969838187, 'support': 381065}}
[[  2336 107124  20451]
 [  1818 104049  20007]
 [  1096  95880  28304]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929178
{'0': {'precision': 0.3965894184521207, 'recall': 0.021307085134373238, 'f1-score': 0.04044142236094081, 'support': 42568}, '1': {'precision': 0.3621212121212121, 'recall': 0.8338443321421775, 'f1-score': 0.5049522065649549, 'support': 47293}, '2': {'precision': 0.4056761268781302, 'recall': 0.20396362788528793, 'f1-score': 0.27144940577776394, 'support': 42890}, 'accuracy': 0.36979005807865856, 'macro avg': {'precision': 0.3881289191504877, 'recall': 0.3530383483872795, 'f1-score': 0.2722810115678866, 'support': 132751}, 'weighted avg': {'precision': 0.38724579047480895, 'recall': 0.36979005807865856, 'f1-score': 0.28056044915627937, 'support': 132751}}
[[  907 35774  5887]
 [  929 39435  6929]
 [  451 33691  8748]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
7324/7324 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.073091
{'0': {'precision': 0.3282958319340274, 'recall': 0.016629399523308188, 'f1-score': 0.03165533891505446, 'support': 529063}, '1': {'precision': 0.4449765939530753, 'recall': 0.8434216702060439, 'f1-score': 0.5825883385824694, 'support': 824533}, '2': {'precision': 0.3336022844473756, 'recall': 0.18248913366787883, 'f1-score': 0.2359225119485761, 'support': 521105}, 'accuracy': 0.4263735923755308, 'macro avg': {'precision': 0.3689582367781594, 'recall': 0.3475134011324103, 'f1-score': 0.2833887298153666, 'support': 1874701}, 'weighted avg': {'precision': 0.381089508198573, 'recall': 0.4263735923755308, 'f1-score': 0.3307468122851577, 'support': 1874701}}
[[  8798 446981  73284]
 [ 12426 695429 116678]
 [  5575 420434  95096]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073818
{'0': {'precision': 0.42646642108245963, 'recall': 0.01712621049876532, 'f1-score': 0.03293000459488436, 'support': 175754}, '1': {'precision': 0.33141197914651827, 'recall': 0.8515049463270891, 'f1-score': 0.47712385111460925, 'support': 171036}, '2': {'precision': 0.4047899540423328, 'recall': 0.17669529837251358, 'f1-score': 0.24600617611770026, 'support': 176960}, 'accuracy': 0.3435150357995227, 'macro avg': {'precision': 0.38755611809043694, 'recall': 0.3484421517327893, 'f1-score': 0.2520200106090646, 'support': 523750}, 'weighted avg': {'precision': 0.38810155399248064, 'recall': 0.3435150357995227, 'f1-score': 0.24997840181879877, 'support': 523750}}
[[  3010 149802  22942]
 [  2363 145638  23035]
 [  1685 144007  31268]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.082601
{'0': {'precision': 0.34559735427862753, 'recall': 0.014729460683263739, 'f1-score': 0.028254697850479925, 'support': 56757}, '1': {'precision': 0.41290469379794564, 'recall': 0.8260456768286338, 'f1-score': 0.550592090434662, 'support': 76888}, '2': {'precision': 0.3553116848070523, 'recall': 0.21181517561891144, 'f1-score': 0.2654094248342591, 'support': 55945}, 'accuracy': 0.4019146579460942, 'macro avg': {'precision': 0.37127124429454184, 'recall': 0.3508634377102697, 'f1-score': 0.281418737706467, 'support': 189590}, 'weighted avg': {'precision': 0.37576031088168704, 'recall': 0.4019146579460942, 'f1-score': 0.31006860492427135, 'support': 189590}}
[[  836 46716  9205]
 [ 1079 63513 12296]
 [  504 43591 11850]]
testing model on single stock: results/universal/W6/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
29350/29350 - 219s - 219s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0844219
{'0': {'precision': 0.3400076207333112, 'recall': 0.012546996808140535, 'f1-score': 0.024200928422574004, 'support': 2204671}, '1': {'precision': 0.42164396728059056, 'recall': 0.781915514917085, 'f1-score': 0.5478581900844289, 'support': 3099198}, '2': {'precision': 0.34001543255675915, 'recall': 0.25925920897204385, 'f1-score': 0.29419610300235216, 'support': 2209530}, 'accuracy': 0.40245619858601944, 'macro avg': {'precision': 0.3672223401902203, 'recall': 0.35124057356575644, 'f1-score': 0.28875174050311836, 'support': 7513399}, 'weighted avg': {'precision': 0.373684051654243, 'recall': 0.40245619858601944, 'f1-score': 0.3196038447480819, 'support': 7513399}}
[[  27662 1706496  470513]
 [  34491 2423311  641396]
 [  19204 1617485  572841]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026243
{'0': {'precision': 0.3693701044386423, 'recall': 0.0095699747591123, 'f1-score': 0.018656578020103114, 'support': 473042}, '1': {'precision': 0.350317275437434, 'recall': 0.7121816011042711, 'f1-score': 0.4696278247889983, 'support': 450614}, '2': {'precision': 0.38686378270996025, 'recall': 0.3830256222221751, 'f1-score': 0.38493513519846034, 'support': 471817}, 'accuracy': 0.3627185907573991, 'macro avg': {'precision': 0.3688503875286789, 'recall': 0.3682590660285195, 'f1-score': 0.2910731793358539, 'support': 1395473}, 'weighted avg': {'precision': 0.369132438294896, 'recall': 0.3627185907573991, 'f1-score': 0.2881210588117343, 'support': 1395473}}
[[  4527 307227 161288]
 [  4565 320919 125130]
 [  3164 287935 180718]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949762
{'0': {'precision': 0.36272838002436053, 'recall': 0.009099242239061354, 'f1-score': 0.017753137202301116, 'support': 163640}, '1': {'precision': 0.38334633440651283, 'recall': 0.7469311505491043, 'f1-score': 0.5066602182707051, 'support': 180931}, '2': {'precision': 0.37186444357015913, 'recall': 0.34372472427911294, 'f1-score': 0.35724130290994516, 'support': 159491}, 'accuracy': 0.37982033956140315, 'macro avg': {'precision': 0.37264638600034417, 'recall': 0.3665850390224262, 'f1-score': 0.29388488612765046, 'support': 504062}, 'weighted avg': {'precision': 0.37301986602271026, 'recall': 0.37982033956140315, 'f1-score': 0.3006622914763096, 'support': 504062}}
[[  1489 113707  48444]
 [  1631 135143  44157]
 [   985 103685  54821]]
training model: results/universal/W6/deepOF_L2/h500
Epoch 1/50
9426/9426 - 210s - loss: 3.2389 - accuracy500: 0.3986 - val_loss: 3.2937 - val_accuracy500: 0.3370 - 210s/epoch - 22ms/step
Epoch 2/50
9426/9426 - 206s - loss: 3.2240 - accuracy500: 0.4047 - val_loss: 3.2983 - val_accuracy500: 0.3356 - 206s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 205s - loss: 3.2183 - accuracy500: 0.4073 - val_loss: 3.2964 - val_accuracy500: 0.3349 - 205s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 206s - loss: 3.2153 - accuracy500: 0.4085 - val_loss: 3.2932 - val_accuracy500: 0.3367 - 206s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 205s - loss: 3.2132 - accuracy500: 0.4101 - val_loss: 3.2893 - val_accuracy500: 0.3414 - 205s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 204s - loss: 3.2109 - accuracy500: 0.4113 - val_loss: 3.2853 - val_accuracy500: 0.3454 - 204s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 206s - loss: 3.2099 - accuracy500: 0.4119 - val_loss: 3.2858 - val_accuracy500: 0.3454 - 206s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 204s - loss: 3.2078 - accuracy500: 0.4128 - val_loss: 3.2824 - val_accuracy500: 0.3512 - 204s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 206s - loss: 3.2065 - accuracy500: 0.4140 - val_loss: 3.2843 - val_accuracy500: 0.3506 - 206s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 205s - loss: 3.2055 - accuracy500: 0.4147 - val_loss: 3.2854 - val_accuracy500: 0.3498 - 205s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 206s - loss: 3.2043 - accuracy500: 0.4156 - val_loss: 3.2884 - val_accuracy500: 0.3489 - 206s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 204s - loss: 3.2038 - accuracy500: 0.4160 - val_loss: 3.2852 - val_accuracy500: 0.3522 - 204s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 205s - loss: 3.2027 - accuracy500: 0.4167 - val_loss: 3.2862 - val_accuracy500: 0.3518 - 205s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 203s - loss: 3.2019 - accuracy500: 0.4174 - val_loss: 3.2940 - val_accuracy500: 0.3469 - 203s/epoch - 22ms/step
Epoch 15/50
9426/9426 - 204s - loss: 3.2010 - accuracy500: 0.4180 - val_loss: 3.2956 - val_accuracy500: 0.3464 - 204s/epoch - 22ms/step
Epoch 16/50
9426/9426 - 207s - loss: 3.1999 - accuracy500: 0.4188 - val_loss: 3.3047 - val_accuracy500: 0.3405 - 207s/epoch - 22ms/step
Epoch 17/50
9426/9426 - 205s - loss: 3.1989 - accuracy500: 0.4196 - val_loss: 3.3043 - val_accuracy500: 0.3436 - 205s/epoch - 22ms/step
Epoch 18/50
9426/9426 - 204s - loss: 3.1975 - accuracy500: 0.4204 - val_loss: 3.3081 - val_accuracy500: 0.3444 - 204s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 310s - 310s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968535
{'0': {'precision': 0.3258103976394154, 'recall': 0.3532070114665322, 'f1-score': 0.33895601294365235, 'support': 3283992}, '1': {'precision': 0.40325389676442686, 'recall': 0.22600943903510592, 'f1-score': 0.2896694652665518, 'support': 4167587}, '2': {'precision': 0.3319962581396128, 'recall': 0.48538784238311267, 'f1-score': 0.39429919743875236, 'support': 3367025}, 'accuracy': 0.34534548080325334, 'macro avg': {'precision': 0.35368685084781837, 'recall': 0.3548680976282503, 'f1-score': 0.3409748918829855, 'support': 10818604}, 'weighted avg': {'precision': 0.3575686972442984, 'recall': 0.34534548080325334, 'f1-score': 0.3371938549425507, 'support': 10818604}}
[[1159929  689100 1434963]
 [1372264  941914 1853409]
 [1027942  704770 1634313]]
Evaluating performance on  train set...
9426/9426 - 74s - 74s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936757
{'0': {'precision': 0.36557611195676226, 'recall': 0.33622328215792713, 'f1-score': 0.35028585453737054, 'support': 810741}, '1': {'precision': 0.3599635073325137, 'recall': 0.21952254881767533, 'f1-score': 0.272724790432242, 'support': 796228}, '2': {'precision': 0.3606363593255702, 'recall': 0.5289231155173548, 'f1-score': 0.4288615031097242, 'support': 805221}, 'accuracy': 0.36202786679324594, 'macro avg': {'precision': 0.36205865953828203, 'recall': 0.36155631549765244, 'f1-score': 0.3506240493597789, 'support': 2412190}, 'weighted avg': {'precision': 0.362074519831682, 'recall': 0.36202786679324594, 'f1-score': 0.350913695366153, 'support': 2412190}}
[[272590 156972 381179]
 [247549 174790 373889]
 [225506 153815 425900]]
Evaluating performance on  val set...
3323/3323 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093183
{'0': {'precision': 0.32911049962898836, 'recall': 0.32338399143293306, 'f1-score': 0.326222116662772, 'support': 263334}, '1': {'precision': 0.4175751219022327, 'recall': 0.2299256282888977, 'f1-score': 0.29655941628745036, 'support': 325527}, '2': {'precision': 0.33722204974969927, 'recall': 0.5318221980821384, 'f1-score': 0.4127342702908091, 'support': 261437}, 'accuracy': 0.3516919950417383, 'macro avg': {'precision': 0.3613025570936401, 'recall': 0.36171060593465637, 'f1-score': 0.3451719344136772, 'support': 850298}, 'weighted avg': {'precision': 0.3654722015542554, 'recall': 0.3516919950417383, 'f1-score': 0.34146555842433773, 'support': 850298}}
[[ 85158  51884 126292]
 [103706  74847 146974]
 [ 69888  52511 139038]]
testing model out of sample: results/universal/W6/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 133s - 133s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0903307
{'0': {'precision': 0.3009030168818999, 'recall': 0.343218339956164, 'f1-score': 0.32067073338160207, 'support': 1293002}, '1': {'precision': 0.44269478381319355, 'recall': 0.26960798564117805, 'f1-score': 0.33512167588273695, 'support': 1857534}, '2': {'precision': 0.33418750335946934, 'recall': 0.47051736049189935, 'f1-score': 0.3908042042582164, 'support': 1334582}, 'accuracy': 0.3506110653053052, 'macro avg': {'precision': 0.3592617680181876, 'recall': 0.3611145620297471, 'f1-score': 0.34886553784085184, 'support': 4485118}, 'weighted avg': {'precision': 0.3695308444055372, 'recall': 0.3506110653053052, 'f1-score': 0.3475244270541781, 'support': 4485118}}
[[443782 312402 536818]
 [642473 500806 714255]
 [388579 318059 627944]]
Evaluating performance on  train set...
5152/5152 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958575
{'0': {'precision': 0.36879186753072335, 'recall': 0.3001424055202689, 'f1-score': 0.33094455678621165, 'support': 450123}, '1': {'precision': 0.34635922175620376, 'recall': 0.25252016713725256, 'f1-score': 0.29208782332285393, 'support': 431023}, '2': {'precision': 0.3591837374418131, 'recall': 0.5238602490719236, 'f1-score': 0.4261669521168877, 'support': 437464}, 'accuracy': 0.3587967632582795, 'macro avg': {'precision': 0.35811160890958, 'recall': 0.3588409405764817, 'f1-score': 0.3497331107419844, 'support': 1318610}, 'weighted avg': {'precision': 0.35827154893698765, 'recall': 0.3587967632582795, 'f1-score': 0.34983431503418644, 'support': 1318610}}
[[135101 105395 209627]
 [122948 108842 199233]
 [108285 100009 229170]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938249
{'0': {'precision': 0.334000390854016, 'recall': 0.29590564704904637, 'f1-score': 0.31380109357040825, 'support': 144394}, '1': {'precision': 0.39549934800951136, 'recall': 0.2431861996592363, 'f1-score': 0.30118102331015095, 'support': 169619}, '2': {'precision': 0.34682001870577234, 'recall': 0.5426226566166928, 'f1-score': 0.42316926124496695, 'support': 144876}, 'accuracy': 0.3543100837021589, 'macro avg': {'precision': 0.35877325252309994, 'recall': 0.3605715011083252, 'f1-score': 0.34605045937517537, 'support': 458889}, 'weighted avg': {'precision': 0.36077952048756357, 'recall': 0.3543100837021589, 'f1-score': 0.34366500175418424, 'support': 458889}}
[[42727 32095 69572]
 [49887 41249 78483]
 [35311 30952 78613]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968208
{'0': {'precision': 0.32661211893307746, 'recall': 0.28954719453736594, 'f1-score': 0.3069648406556578, 'support': 86991}, '1': {'precision': 0.312984101100693, 'recall': 0.11363271951354885, 'f1-score': 0.16673151574927836, 'support': 81077}, '2': {'precision': 0.3866522397223218, 'recall': 0.6175796648348447, 'f1-score': 0.47556457732868285, 'support': 102994}, 'accuracy': 0.3615704156244697, 'macro avg': {'precision': 0.34208281991869743, 'recall': 0.34025319296191986, 'f1-score': 0.3164203112445397, 'support': 271062}, 'weighted avg': {'precision': 0.34534898872217074, 'recall': 0.3615704156244697, 'f1-score': 0.32908178805317945, 'support': 271062}}
[[25188  9483 52320]
 [23284  9213 48580]
 [28647 10740 63607]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015226
{'0': {'precision': 0.35223951338968323, 'recall': 0.24481168332052267, 'f1-score': 0.2888608168950215, 'support': 18214}, '1': {'precision': 0.3584813426755744, 'recall': 0.1225217197594119, 'f1-score': 0.18262565890507615, 'support': 17956}, '2': {'precision': 0.33927708102266585, 'recall': 0.6706391590308618, 'f1-score': 0.4505967668832149, 'support': 17789}, 'accuracy': 0.34450230730740006, 'macro avg': {'precision': 0.3499993123626412, 'recall': 0.34599085403693214, 'f1-score': 0.30736108089443753, 'support': 53959}, 'weighted avg': {'precision': 0.35004320836699176, 'recall': 0.34450230730740006, 'f1-score': 0.30682931737635943, 'support': 53959}}
[[ 4459  2039 11716]
 [ 4239  2200 11517]
 [ 3961  1898 11930]]
Evaluating performance on  val set...
81/81 - 1s - 799ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018944
{'0': {'precision': 0.341358024691358, 'recall': 0.240958605664488, 'f1-score': 0.28250319284802045, 'support': 6885}, '1': {'precision': 0.3211888782358581, 'recall': 0.10037453183520599, 'f1-score': 0.15295057641821708, 'support': 6675}, '2': {'precision': 0.3502556610664719, 'recall': 0.6776427360090447, 'f1-score': 0.4618125782529135, 'support': 7076}, 'accuracy': 0.3452219422368676, 'macro avg': {'precision': 0.33760085466456263, 'recall': 0.3396586245029129, 'f1-score': 0.29908878250638365, 'support': 20636}, 'weighted avg': {'precision': 0.33788499805828204, 'recall': 0.3452219422368676, 'f1-score': 0.3020820597047798, 'support': 20636}}
[[1659  737 4489]
 [1599  670 4406]
 [1602  679 4795]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952411
{'0': {'precision': 0.39859678962474754, 'recall': 0.38057152716809356, 'f1-score': 0.38937566038666527, 'support': 197051}, '1': {'precision': 0.2926528007465913, 'recall': 0.2770520024685744, 'f1-score': 0.28463879545090504, 'support': 153935}, '2': {'precision': 0.41222187207335964, 'recall': 0.44611497521423354, 'f1-score': 0.4284992560296204, 'support': 208184}, 'accuracy': 0.37647584813205287, 'macro avg': {'precision': 0.36782382081489945, 'recall': 0.36791283495030047, 'f1-score': 0.3675045706223969, 'support': 559170}, 'weighted avg': {'precision': 0.37450400252337024, 'recall': 0.37647584813205287, 'f1-score': 0.37510850966585896, 'support': 559170}}
[[74992 50579 71480]
 [50340 42648 60947]
 [62808 52502 92874]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0858223
{'0': {'precision': 0.41980315319420397, 'recall': 0.38608695652173913, 'f1-score': 0.40223975899669273, 'support': 47725}, '1': {'precision': 0.3425955162614462, 'recall': 0.2741913251240581, 'f1-score': 0.3046002679767754, 'support': 43528}, '2': {'precision': 0.38554447186402974, 'recall': 0.49280287884846063, 'f1-score': 0.43262480499219963, 'support': 45018}, 'accuracy': 0.3855992837801146, 'macro avg': {'precision': 0.38264771377322665, 'recall': 0.3843603868314193, 'f1-score': 0.3798216106552226, 'support': 136271}, 'weighted avg': {'precision': 0.38382373470801934, 'recall': 0.3855992837801146, 'f1-score': 0.3810894205938834, 'support': 136271}}
[[18426 11983 17316]
 [13552 11935 18041]
 [11914 10919 22185]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895863
{'0': {'precision': 0.3736450718427023, 'recall': 0.3591156874621442, 'f1-score': 0.36623633331274325, 'support': 16510}, '1': {'precision': 0.37490768852055467, 'recall': 0.2582961162304257, 'f1-score': 0.3058642388539296, 'support': 17689}, '2': {'precision': 0.3378834508090936, 'recall': 0.48614483645193546, 'f1-score': 0.3986763500058568, 'support': 14002}, 'accuracy': 0.35901744777079314, 'macro avg': {'precision': 0.3621454037241168, 'recall': 0.3678522133815018, 'f1-score': 0.35692564072417654, 'support': 48201}, 'weighted avg': {'precision': 0.3637199708842563, 'recall': 0.35901744777079314, 'f1-score': 0.35350429735612454, 'support': 48201}}
[[5929 4180 6401]
 [6182 4569 6938]
 [3757 3438 6807]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961641
{'0': {'precision': 0.39239693349100846, 'recall': 0.33173603150936404, 'f1-score': 0.3595256887460828, 'support': 116029}, '1': {'precision': 0.28881614659582516, 'recall': 0.20840603449299103, 'f1-score': 0.24210918216792376, 'support': 84249}, '2': {'precision': 0.37392215115245014, 'recall': 0.5141014726393393, 'f1-score': 0.43294778068880835, 'support': 110414}, 'accuracy': 0.3631023650431939, 'macro avg': {'precision': 0.35171174374642794, 'recall': 0.3514145128805648, 'f1-score': 0.344860883867605, 'support': 310692}, 'weighted avg': {'precision': 0.3577437968403645, 'recall': 0.3631023650431939, 'f1-score': 0.3537791732164289, 'support': 310692}}
[[38491 22572 54966]
 [26614 17558 40077]
 [32987 20663 56764]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977813
{'0': {'precision': 0.37174118600567335, 'recall': 0.2928407252915638, 'f1-score': 0.32760734735664204, 'support': 46988}, '1': {'precision': 0.3285373781148429, 'recall': 0.18754174603567275, 'f1-score': 0.23877917414721728, 'support': 40423}, '2': {'precision': 0.34626781430788767, 'recall': 0.5635031803256102, 'f1-score': 0.4289497373687936, 'support': 43549}, 'accuracy': 0.3503436163714111, 'macro avg': {'precision': 0.34884879280946796, 'recall': 0.34796188388428223, 'f1-score': 0.33177875295755094, 'support': 130960}, 'weighted avg': {'precision': 0.349934776487974, 'recall': 0.3503436163714111, 'f1-score': 0.3338891013043712, 'support': 130960}}
[[13760  8042 25186]
 [11698  7581 21144]
 [11557  7452 24540]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959377
{'0': {'precision': 0.34966216216216217, 'recall': 0.2882004872955099, 'f1-score': 0.31597023468803664, 'support': 14365}, '1': {'precision': 0.34358384825405947, 'recall': 0.17516483516483516, 'f1-score': 0.23203454801300405, 'support': 13650}, '2': {'precision': 0.3675606850946729, 'recall': 0.5914348027228868, 'f1-score': 0.45336643193677495, 'support': 15131}, 'accuracy': 0.35878181059657904, 'macro avg': {'precision': 0.3536022318369649, 'recall': 0.351600041727744, 'f1-score': 0.3337904048792719, 'support': 43146}, 'weighted avg': {'precision': 0.35401606671058417, 'recall': 0.35878181059657904, 'f1-score': 0.3375995801072288, 'support': 43146}}
[[4140 2281 7944]
 [3805 2391 7454]
 [3895 2287 8949]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0879098
{'0': {'precision': 0.3495757191249278, 'recall': 0.3095723014256619, 'f1-score': 0.3283601149302969, 'support': 99673}, '1': {'precision': 0.2654018870780564, 'recall': 0.07595558186885389, 'f1-score': 0.11810935219490289, 'support': 69251}, '2': {'precision': 0.4008244281910255, 'recall': 0.6201961137099676, 'f1-score': 0.48694368515104647, 'support': 111160}, 'accuracy': 0.37509104411533684, 'macro avg': {'precision': 0.3386006781313366, 'recall': 0.3352413323348278, 'f1-score': 0.3111377174254154, 'support': 280084}, 'weighted avg': {'precision': 0.34910330533731243, 'recall': 0.37509104411533684, 'f1-score': 0.3393142361780288, 'support': 280084}}
[[30856  7222 61595]
 [22529  5260 41462]
 [34882  7337 68941]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081895
{'0': {'precision': 0.30934877592066023, 'recall': 0.24508915080084617, 'f1-score': 0.2734951024725233, 'support': 36399}, '1': {'precision': 0.33968434522963176, 'recall': 0.0632311682811921, 'f1-score': 0.10661608836327122, 'support': 37782}, '2': {'precision': 0.35197987088903576, 'recall': 0.6858996582635828, 'f1-score': 0.4652233065152762, 'support': 40382}, 'accuracy': 0.34049387673158, 'macro avg': {'precision': 0.3336709973464426, 'recall': 0.331406659115207, 'f1-score': 0.28177816578369025, 'support': 114563}, 'weighted avg': {'precision': 0.33438013296127983, 'recall': 0.34049387673158, 'f1-score': 0.2860414343997484, 'support': 114563}}
[[ 8921  2080 25398]
 [ 9797  2389 25596]
 [10120  2564 27698]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969754
{'0': {'precision': 0.33051521782375176, 'recall': 0.2882796911598855, 'f1-score': 0.3079560724711552, 'support': 11527}, '1': {'precision': 0.2823027718550107, 'recall': 0.06597568267889177, 'f1-score': 0.10695532757088619, 'support': 10034}, '2': {'precision': 0.3864306784660767, 'recall': 0.6544050862851952, 'f1-score': 0.4859214297757545, 'support': 13212}, 'accuracy': 0.3632415954907543, 'macro avg': {'precision': 0.33308288938161307, 'recall': 0.33622015337465755, 'f1-score': 0.3002776099392653, 'support': 34773}, 'weighted avg': {'precision': 0.3378482458384773, 'recall': 0.3632415954907543, 'f1-score': 0.31757378812350234, 'support': 34773}}
[[3323  738 7466]
 [3110  662 6262]
 [3621  945 8646]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945606
{'0': {'precision': 0.3388115405835199, 'recall': 0.3498897357008318, 'f1-score': 0.34426153825861, 'support': 149187}, '1': {'precision': 0.3345795070959312, 'recall': 0.14247845743653156, 'f1-score': 0.19985148810007755, 'support': 129395}, '2': {'precision': 0.3808925557037824, 'recall': 0.543887012058294, 'f1-score': 0.4480257160921087, 'support': 162212}, 'accuracy': 0.36039510519653173, 'macro avg': {'precision': 0.35142786779441115, 'recall': 0.3454184017318858, 'f1-score': 0.3307129141502654, 'support': 440794}, 'weighted avg': {'precision': 0.35305502314354, 'recall': 0.36039510519653173, 'f1-score': 0.3400551660631268, 'support': 440794}}
[[52199 17869 79119]
 [46676 18436 64283]
 [55190 18797 88225]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992473
{'0': {'precision': 0.35045600543924227, 'recall': 0.2757475695917652, 'f1-score': 0.3086452891742892, 'support': 54209}, '1': {'precision': 0.3481371941038973, 'recall': 0.14230559238748927, 'f1-score': 0.2020291499993079, 'support': 51284}, '2': {'precision': 0.340389670963365, 'recall': 0.6121161287862903, 'f1-score': 0.4374944650703361, 'support': 52459}, 'accuracy': 0.344136193273906, 'macro avg': {'precision': 0.34632762350216817, 'recall': 0.343389763588515, 'f1-score': 0.3160563014146444, 'support': 157952}, 'weighted avg': {'precision': 0.3463599018078107, 'recall': 0.344136193273906, 'f1-score': 0.3168224368956285, 'support': 157952}}
[[14948  7048 32213]
 [13974  7298 30012]
 [13731  6617 32111]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977436
{'0': {'precision': 0.3428100012691966, 'recall': 0.27918755491239855, 'f1-score': 0.3077448941806477, 'support': 19349}, '1': {'precision': 0.3447069116360455, 'recall': 0.151947551099113, 'f1-score': 0.21092077087794434, 'support': 18151}, '2': {'precision': 0.3583684616754735, 'recall': 0.6052644773126097, 'f1-score': 0.45018739162051796, 'support': 19945}, 'accuracy': 0.3521977543737488, 'macro avg': {'precision': 0.34862845819357186, 'recall': 0.3454665277747071, 'f1-score': 0.3229510188930367, 'support': 57445}, 'weighted avg': {'precision': 0.34881129490435836, 'recall': 0.3521977543737488, 'f1-score': 0.3266074748990887, 'support': 57445}}
[[ 5402  2603 11344]
 [ 5123  2758 10270]
 [ 5233  2640 12072]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/EXC
Evaluating performance on  test set...
4450/4450 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0807315
{'0': {'precision': 0.26844474376179184, 'recall': 0.39114106259627907, 'f1-score': 0.3183809030189217, 'support': 277189}, '1': {'precision': 0.5019190700734729, 'recall': 0.29729263135583806, 'f1-score': 0.3734100509363376, 'support': 585033}, '2': {'precision': 0.28609098767210683, 'recall': 0.40162300374872695, 'f1-score': 0.33415263684522073, 'support': 276894}, 'accuracy': 0.3454898359780742, 'macro avg': {'precision': 0.3521516005024572, 'recall': 0.36335223256694804, 'f1-score': 0.3419811969334934, 'support': 1139116}, 'weighted avg': {'precision': 0.39264309108234957, 'recall': 0.3454898359780742, 'f1-score': 0.35047681419887955, 'support': 1139116}}
[[108420  85898  82871]
 [216473 173926 194634]
 [ 78989  86698 111207]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0897365
{'0': {'precision': 0.38790472565901435, 'recall': 0.4215569983768261, 'f1-score': 0.40403133823226944, 'support': 128144}, '1': {'precision': 0.3442657319200322, 'recall': 0.32153542505365057, 'f1-score': 0.3325125746174967, 'support': 127678}, '2': {'precision': 0.39540333626265745, 'recall': 0.387167043939347, 'f1-score': 0.3912418479857425, 'support': 128996}, 'accuracy': 0.37684307906594805, 'macro avg': {'precision': 0.37585793128056794, 'recall': 0.37675315578994123, 'f1-score': 0.37592858694516956, 'support': 384818}, 'weighted avg': {'precision': 0.3759394624198254, 'recall': 0.37684307906594805, 'f1-score': 0.3760150661643102, 'support': 384818}}
[[54020 38740 35384]
 [45643 41053 40982]
 [39598 39455 49943]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0824955
{'0': {'precision': 0.282504658648145, 'recall': 0.4169192787274602, 'f1-score': 0.3367961324362874, 'support': 31999}, '1': {'precision': 0.4643198390746794, 'recall': 0.29657587048695877, 'f1-score': 0.36195777877962243, 'support': 62264}, '2': {'precision': 0.3243789783303077, 'recall': 0.38942838225557275, 'f1-score': 0.35393969786247104, 'support': 36248}, 'accuracy': 0.3518707235405445, 'macro avg': {'precision': 0.35706782535104403, 'recall': 0.3676411771566639, 'f1-score': 0.3508978696927936, 'support': 130511}, 'weighted avg': {'precision': 0.3808749165874511, 'recall': 0.3518707235405445, 'f1-score': 0.3535616518751831, 'support': 130511}}
[[13341 10000  8658]
 [23055 18466 20743]
 [10828 11304 14116]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/AAL
Evaluating performance on  test set...
6203/6203 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0804552
{'0': {'precision': 0.23453458138325534, 'recall': 0.40187179593800676, 'f1-score': 0.29620329647475546, 'support': 336682}, '1': {'precision': 0.5518414599591378, 'recall': 0.2934708472218131, 'f1-score': 0.38317052623170406, 'support': 882626}, '2': {'precision': 0.27148596898738153, 'recall': 0.39893803196757116, 'f1-score': 0.3230972579154796, 'support': 368561}, 'accuracy': 0.34093555576688, 'macro avg': {'precision': 0.35262067010992487, 'recall': 0.3647602250424637, 'f1-score': 0.33415702687397975, 'support': 1587869}, 'weighted avg': {'precision': 0.4194882150751287, 'recall': 0.34093555576688, 'f1-score': 0.3507868946519422, 'support': 1587869}}
[[135303  99576 101803]
 [330851 259025 292750]
 [110746 110782 147033]]
Evaluating performance on  train set...
1766/1766 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932893
{'0': {'precision': 0.39582197697139454, 'recall': 0.3022709224581807, 'f1-score': 0.3427780864298398, 'support': 156148}, '1': {'precision': 0.34219896150993157, 'recall': 0.2818305853284369, 'f1-score': 0.30909476677746794, 'support': 147319}, '2': {'precision': 0.37058689976160747, 'recall': 0.5275178088094693, 'f1-score': 0.4353416421717074, 'support': 148522}, 'accuracy': 0.36962403952308576, 'macro avg': {'precision': 0.3695359460809779, 'recall': 0.3705397721986956, 'f1-score': 0.36240483179300503, 'support': 451989}, 'weighted avg': {'precision': 0.3700522056890862, 'recall': 0.36962403952308576, 'f1-score': 0.36221557596614684, 'support': 451989}}
[[47199 42083 66866]
 [39598 41519 66202]
 [32446 37728 78348]]
Evaluating performance on  val set...
579/579 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0889195
{'0': {'precision': 0.3284013263665595, 'recall': 0.29703262746523673, 'f1-score': 0.3119303268909568, 'support': 44012}, '1': {'precision': 0.42387712958182755, 'recall': 0.2688441388343156, 'f1-score': 0.32901222199959923, 'support': 61080}, '2': {'precision': 0.3353518209539152, 'recall': 0.5424616100511866, 'f1-score': 0.4144741520301501, 'support': 42980}, 'accuracy': 0.3566440650494354, 'macro avg': {'precision': 0.36254342563410075, 'recall': 0.3694461254502463, 'f1-score': 0.3518055669735687, 'support': 148072}, 'weighted avg': {'precision': 0.36980276835257386, 'recall': 0.3566440650494354, 'f1-score': 0.3487414441698374, 'support': 148072}}
[[13073 11732 19207]
 [17657 16421 27002]
 [ 9078 10587 23315]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/WBA
Evaluating performance on  test set...
5183/5183 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0913795
{'0': {'precision': 0.3399976872411986, 'recall': 0.3306384078325908, 'f1-score': 0.3352527393081162, 'support': 417946}, '1': {'precision': 0.3580679200499338, 'recall': 0.2863096077365006, 'f1-score': 0.3181932370754517, 'support': 446817}, '2': {'precision': 0.38548908671493337, 'recall': 0.46979042227185375, 'f1-score': 0.42348513889579814, 'support': 462072}, 'accuracy': 0.36417037536694463, 'macro avg': {'precision': 0.36118489800202197, 'recall': 0.36224614594698173, 'f1-score': 0.3589770384264554, 'support': 1326835}, 'weighted avg': {'precision': 0.3619253490458151, 'recall': 0.36417037536694463, 'f1-score': 0.36023493056263306, 'support': 1326835}}
[[138189 109050 170707]
 [143552 127928 175337]
 [124700 120295 217077]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0920426
{'0': {'precision': 0.3730588299398805, 'recall': 0.31666705210332785, 'f1-score': 0.3425576537398316, 'support': 129723}, '1': {'precision': 0.3589456251177643, 'recall': 0.28251520094913246, 'f1-score': 0.31617704866479723, 'support': 128117}, '2': {'precision': 0.3629977544470179, 'recall': 0.5011239602353419, 'f1-score': 0.4210214120863574, 'support': 123225}, 'accuracy': 0.3648327713119809, 'macro avg': {'precision': 0.3650007365015542, 'recall': 0.36676873776260077, 'f1-score': 0.35991870483032873, 'support': 381065}, 'weighted avg': {'precision': 0.3650604110617283, 'recall': 0.3648327713119809, 'f1-score': 0.35906111808804636, 'support': 381065}}
[[41079 33471 55173]
 [38732 36195 53190]
 [30303 31171 61751]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0923686
{'0': {'precision': 0.35388464906793443, 'recall': 0.3323541852704799, 'f1-score': 0.34278166240502195, 'support': 42554}, '1': {'precision': 0.374528730714725, 'recall': 0.2922874671340929, 'f1-score': 0.3283365173872787, 'support': 47922}, '2': {'precision': 0.35634715727517285, 'recall': 0.46687167356593734, 'f1-score': 0.40418996129507895, 'support': 42275}, 'accuracy': 0.360727979450249, 'macro avg': {'precision': 0.36158684568594407, 'recall': 0.36383777532350337, 'f1-score': 0.35843604702912657, 'support': 132751}, 'weighted avg': {'precision': 0.3621211837466826, 'recall': 0.360727979450249, 'f1-score': 0.35712276413711336, 'support': 132751}}
[[14143 11707 16704]
 [14969 14007 18946]
 [10853 11685 19737]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
7324/7324 - 55s - 55s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957414
{'0': {'precision': 0.3393633562222097, 'recall': 0.3193823009933572, 'f1-score': 0.3290697961978652, 'support': 604113}, '1': {'precision': 0.38114768370019847, 'recall': 0.28964975808123355, 'f1-score': 0.32915848362151856, 'support': 680187}, '2': {'precision': 0.34513560256190967, 'recall': 0.46138133234869183, 'f1-score': 0.39488104281067166, 'support': 590401}, 'accuracy': 0.35331447521498094, 'macro avg': {'precision': 0.35521554749477263, 'recall': 0.3568044638077608, 'f1-score': 0.3510364408766851, 'support': 1874701}, 'weighted avg': {'precision': 0.3563415817448269, 'recall': 0.35331447521498094, 'f1-score': 0.34982795968317837, 'support': 1874701}}
[[192943 162624 248546]
 [214862 197016 268309]
 [160739 157262 272400]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963048
{'0': {'precision': 0.35416868184661415, 'recall': 0.31462386288123556, 'f1-score': 0.33322715593213137, 'support': 174564}, '1': {'precision': 0.35028982961531707, 'recall': 0.2864554903729581, 'f1-score': 0.3151729326160207, 'support': 174041}, '2': {'precision': 0.36487417827101154, 'recall': 0.4715521425104913, 'f1-score': 0.41141029696361375, 'support': 175145}, 'accuracy': 0.35774128878281625, 'macro avg': {'precision': 0.35644422991098096, 'recall': 0.35754383192156164, 'f1-score': 0.3532701285039219, 'support': 523750}, 'weighted avg': {'precision': 0.35645972690640204, 'recall': 0.35774128878281625, 'f1-score': 0.3533726664921309, 'support': 523750}}
[[54922 46419 73223]
 [53647 49855 70539]
 [46504 46051 82590]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954453
{'0': {'precision': 0.33067307519862266, 'recall': 0.3084154358262382, 'f1-score': 0.31915667030170847, 'support': 59783}, '1': {'precision': 0.3915960524426024, 'recall': 0.2724119720822688, 'f1-score': 0.3213077220922207, 'support': 70063}, '2': {'precision': 0.34213557091148405, 'recall': 0.4872957953936797, 'f1-score': 0.4020133116076114, 'support': 59744}, 'accuracy': 0.351479508412891, 'macro avg': {'precision': 0.35480156618423636, 'recall': 0.3560410677673955, 'f1-score': 0.3474925680005135, 'support': 189590}, 'weighted avg': {'precision': 0.35679925220434106, 'recall': 0.351479508412891, 'f1-score': 0.34606155093770463, 'support': 189590}}
[[18438 14796 26549]
 [21547 19086 29430]
 [15774 14857 29113]]
testing model on single stock: results/universal/W6/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
29350/29350 - 218s - 218s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007143
{'0': {'precision': 0.3266048999609831, 'recall': 0.3524171590392006, 'f1-score': 0.33902041751636486, 'support': 2292133}, '1': {'precision': 0.4037690219188976, 'recall': 0.20326991699029476, 'f1-score': 0.2704080094637368, 'support': 2912551}, '2': {'precision': 0.3201898795275117, 'recall': 0.4956475788479739, 'f1-score': 0.38905136539193824, 'support': 2308715}, 'accuracy': 0.3386123910097148, 'macro avg': {'precision': 0.3501879338024641, 'recall': 0.35044488495915643, 'f1-score': 0.3328265974573466, 'support': 7513399}, 'weighted avg': {'precision': 0.35454618015555067, 'recall': 0.3386123910097148, 'f1-score': 0.32779647774402804, 'support': 7513399}}
[[ 807787  435856 1048490]
 [ 939471  592034 1381046]
 [ 726027  438379 1144309]]
Evaluating performance on  train set...
5452/5452 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945772
{'0': {'precision': 0.35610009197896275, 'recall': 0.322112, 'f1-score': 0.33825440207894625, 'support': 468750}, '1': {'precision': 0.3750379674462649, 'recall': 0.18287474162697143, 'f1-score': 0.24586273186344346, 'support': 459123}, '2': {'precision': 0.35353878545239553, 'recall': 0.5652288280581694, 'f1-score': 0.4349964244186286, 'support': 467600}, 'accuracy': 0.35776614810892077, 'macro avg': {'precision': 0.36155894829254104, 'recall': 0.35673852322838034, 'f1-score': 0.33970451945367275, 'support': 1395473}, 'weighted avg': {'precision': 0.36147256945889344, 'recall': 0.35776614810892077, 'f1-score': 0.34027337976012184, 'support': 1395473}}
[[150990  69992 247768]
 [139643  83962 235518]
 [133377  69922 264301]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963387
{'0': {'precision': 0.33092340828337424, 'recall': 0.3001293982979147, 'f1-score': 0.31477506279972595, 'support': 160744}, '1': {'precision': 0.42194035123707935, 'recall': 0.1973371424916586, 'f1-score': 0.26890853957474625, 'support': 187618}, '2': {'precision': 0.33148017402940166, 'recall': 0.5759473346178549, 'f1-score': 0.42078319401073133, 'support': 155700}, 'accuracy': 0.3470664323039626, 'macro avg': {'precision': 0.36144797784995175, 'recall': 0.3578046251358094, 'f1-score': 0.33482226546173455, 'support': 504062}, 'weighted avg': {'precision': 0.364972999860888, 'recall': 0.3470664323039626, 'f1-score': 0.3304478980365208, 'support': 504062}}
[[48244 25633 86867]
 [56607 37024 93987]
 [40935 25090 89675]]
training model: results/universal/W6/deepOF_L2/h1000
Epoch 1/50
9426/9426 - 215s - loss: 3.2420 - accuracy1000: 0.3907 - val_loss: 3.2874 - val_accuracy1000: 0.3698 - 215s/epoch - 23ms/step
Epoch 2/50
9426/9426 - 205s - loss: 3.2350 - accuracy1000: 0.3937 - val_loss: 3.3106 - val_accuracy1000: 0.3672 - 205s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 204s - loss: 3.2258 - accuracy1000: 0.4001 - val_loss: 3.3171 - val_accuracy1000: 0.3661 - 204s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 204s - loss: 3.2198 - accuracy1000: 0.4038 - val_loss: 3.3032 - val_accuracy1000: 0.3673 - 204s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 203s - loss: 3.2158 - accuracy1000: 0.4060 - val_loss: 3.3088 - val_accuracy1000: 0.3681 - 203s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 205s - loss: 3.2127 - accuracy1000: 0.4074 - val_loss: 3.3134 - val_accuracy1000: 0.3669 - 205s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 204s - loss: 3.2112 - accuracy1000: 0.4083 - val_loss: 3.3106 - val_accuracy1000: 0.3668 - 204s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 205s - loss: 3.2104 - accuracy1000: 0.4088 - val_loss: 3.3021 - val_accuracy1000: 0.3703 - 205s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 204s - loss: 3.2096 - accuracy1000: 0.4091 - val_loss: 3.3051 - val_accuracy1000: 0.3670 - 204s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 205s - loss: 3.2081 - accuracy1000: 0.4096 - val_loss: 3.3020 - val_accuracy1000: 0.3702 - 205s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 205s - loss: 3.2072 - accuracy1000: 0.4103 - val_loss: 3.3014 - val_accuracy1000: 0.3697 - 205s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 314s - 314s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0936872
{'0': {'precision': 0.31844662371668714, 'recall': 0.03469554194602685, 'f1-score': 0.06257354269773345, 'support': 3273850}, '1': {'precision': 0.3913586789550896, 'recall': 0.7969069829649105, 'f1-score': 0.524927167548212, 'support': 4149670}, '2': {'precision': 0.33112139769416643, 'recall': 0.19624079993307972, 'f1-score': 0.24643225567105181, 'support': 3395084}, 'accuracy': 0.377751417835425, 'macro avg': {'precision': 0.34697556678864777, 'recall': 0.34261444161467236, 'f1-score': 0.2779776553056657, 'support': 10818604}, 'weighted avg': {'precision': 0.3503909383986644, 'recall': 0.377751417835425, 'f1-score': 0.29761595122933243, 'support': 10818604}}
[[ 113588 2527170  633092]
 [ 130001 3306901  712768]
 [ 113105 2615725  666254]]
Evaluating performance on  train set...
9426/9426 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051345
{'0': {'precision': 0.35167987733247597, 'recall': 0.03517290251886957, 'f1-score': 0.06394991938802355, 'support': 808577}, '1': {'precision': 0.34015018713395434, 'recall': 0.7858950286686409, 'f1-score': 0.4747985912426208, 'support': 793550}, '2': {'precision': 0.35919055987948784, 'recall': 0.2207630764520784, 'f1-score': 0.2734563870764516, 'support': 810063}, 'accuracy': 0.3444666464913626, 'macro avg': {'precision': 0.35034020811530603, 'recall': 0.34727700254652966, 'f1-score': 0.2707349659023653, 'support': 2412190}, 'weighted avg': {'precision': 0.35040914010988705, 'recall': 0.3444666464913626, 'f1-score': 0.2694654058485871, 'support': 2412190}}
[[ 28440 606164 173973]
 [ 24833 623647 145070]
 [ 27596 603635 178832]]
Evaluating performance on  val set...
3323/3323 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962628
{'0': {'precision': 0.3393167561030912, 'recall': 0.03323180097189787, 'f1-score': 0.060534964858168575, 'support': 270193}, '1': {'precision': 0.3764599056252698, 'recall': 0.8170147055022873, 'f1-score': 0.5154249215863305, 'support': 309544}, '2': {'precision': 0.3446917380266498, 'recall': 0.19370493160507243, 'f1-score': 0.2480271268578135, 'support': 270561}, 'accuracy': 0.36962335557651554, 'macro avg': {'precision': 0.35348946658500363, 'recall': 0.34798381269308587, 'f1-score': 0.2746623377674375, 'support': 850298}, 'weighted avg': {'precision': 0.3545487095593068, 'recall': 0.36962335557651554, 'f1-score': 0.28579307861152103, 'support': 850298}}
[[  8979 209069  52145]
 [  9150 252902  47492]
 [  8333 209819  52409]]
testing model out of sample: results/universal/W6/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 133s - 133s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0934137
{'0': {'precision': 0.3185455955249093, 'recall': 0.033447120808569535, 'f1-score': 0.06053780389288129, 'support': 1375664}, '1': {'precision': 0.38652838257897665, 'recall': 0.8132529430936627, 'f1-score': 0.5240043964600849, 'support': 1659903}, '2': {'precision': 0.36356616563513117, 'recall': 0.21275208668063422, 'f1-score': 0.26842620400983375, 'support': 1449551}, 'accuracy': 0.37999624536076865, 'macro avg': {'precision': 0.35621338124633906, 'recall': 0.3531507168609555, 'f1-score': 0.28432280145426664, 'support': 4485118}, 'weighted avg': {'precision': 0.358255686675967, 'recall': 0.37999624536076865, 'f1-score': 0.29925045887319784, 'support': 4485118}}
[[  46012 1049815  279837]
 [  49964 1349921  260018]
 [  48468 1092688  308395]]
Evaluating performance on  train set...
5152/5152 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078151
{'0': {'precision': 0.3475956173277874, 'recall': 0.030623166352726144, 'f1-score': 0.05628741285307978, 'support': 447537}, '1': {'precision': 0.3401154282904672, 'recall': 0.7957636693562192, 'f1-score': 0.476549840175455, 'support': 438115}, '2': {'precision': 0.34704678707748005, 'recall': 0.20370336152698415, 'f1-score': 0.25672111869222, 'support': 432958}, 'accuracy': 0.34167494558664047, 'macro avg': {'precision': 0.3449192775652448, 'recall': 0.34336339907864316, 'f1-score': 0.26318612390691826, 'support': 1318610}, 'weighted avg': {'precision': 0.3449300805370774, 'recall': 0.34167494558664047, 'f1-score': 0.26173303343766874, 'support': 1318610}}
[[ 13705 344462  89370]
 [ 12914 348636  76565]
 [ 12809 331954  88195]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979017
{'0': {'precision': 0.32885436349639585, 'recall': 0.03194881662235941, 'f1-score': 0.05823955183183779, 'support': 147079}, '1': {'precision': 0.3736373308674848, 'recall': 0.807806487742899, 'f1-score': 0.5109454299616268, 'support': 166067}, '2': {'precision': 0.347023211238634, 'recall': 0.20372848095620372, 'f1-score': 0.256734614470072, 'support': 145743}, 'accuracy': 0.3672805406100386, 'macro avg': {'precision': 0.34983830186750486, 'recall': 0.3478279284404873, 'f1-score': 0.27530653208784556, 'support': 458889}, 'weighted avg': {'precision': 0.35083125860373476, 'recall': 0.3672805406100386, 'f1-score': 0.2851109150100004, 'support': 458889}}
[[  4699 113185  29195]
 [  5242 134150  26675]
 [  4348 111703  29692]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980883
{'0': {'precision': 0.28874948215659585, 'recall': 0.06017290924114796, 'f1-score': 0.09959175341906511, 'support': 81083}, '1': {'precision': 0.3427926301965332, 'recall': 0.5080127475529251, 'f1-score': 0.40936042592414257, 'support': 87860}, '2': {'precision': 0.39321383049097275, 'recall': 0.4773058882284394, 'f1-score': 0.431198220075461, 'support': 102119}, 'accuracy': 0.36248164626543006, 'macro avg': {'precision': 0.34158531428136724, 'recall': 0.3484971816741708, 'f1-score': 0.31338346647288956, 'support': 271062}, 'weighted avg': {'precision': 0.34562217465627165, 'recall': 0.36248164626543006, 'f1-score': 0.32492616523178913, 'support': 271062}}
[[ 4879 39003 37201]
 [ 5211 44634 38015]
 [ 6807 46570 48742]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027492
{'0': {'precision': 0.3502556610664719, 'recall': 0.051684182161142546, 'f1-score': 0.09007655097919504, 'support': 18555}, '1': {'precision': 0.34847140712433466, 'recall': 0.5593712345273305, 'f1-score': 0.4294243787579364, 'support': 18258}, '2': {'precision': 0.3265641400082143, 'recall': 0.41735681791671525, 'f1-score': 0.36642003123479866, 'support': 17146}, 'accuracy': 0.3396653014325692, 'macro avg': {'precision': 0.3417637360663403, 'recall': 0.3428040782017294, 'f1-score': 0.29530698699064334, 'support': 53959}, 'weighted avg': {'precision': 0.3421237140596626, 'recall': 0.3396653014325692, 'f1-score': 0.29271184726057237, 'support': 53959}}
[[  959  9990  7606]
 [  894 10213  7151]
 [  885  9105  7156]]
Evaluating performance on  val set...
81/81 - 1s - 791ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101066
{'0': {'precision': 0.32055063913470994, 'recall': 0.048167848699763594, 'f1-score': 0.08375080282594734, 'support': 6768}, '1': {'precision': 0.3590339892665474, 'recall': 0.5604579726333426, 'f1-score': 0.43768400392541706, 'support': 7162}, '2': {'precision': 0.3328593435241142, 'recall': 0.4188786161646287, 'f1-score': 0.3709475074281941, 'support': 6706}, 'accuracy': 0.34643341732893973, 'macro avg': {'precision': 0.3374813239751238, 'recall': 0.3425014791659116, 'f1-score': 0.2974607713931862, 'support': 20636}, 'weighted avg': {'precision': 0.3379067122728939, 'recall': 0.34643341732893973, 'f1-score': 0.29991724435226397, 'support': 20636}}
[[ 326 3635 2807]
 [ 325 4014 2823]
 [ 366 3531 2809]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0770822
{'0': {'precision': 0.312878588359231, 'recall': 0.032232027185598686, 'f1-score': 0.05844335532748326, 'support': 147431}, '1': {'precision': 0.43829618873752557, 'recall': 0.9124455946851077, 'f1-score': 0.5921508188892627, 'support': 239177}, '2': {'precision': 0.3713609621605193, 'recall': 0.09912958820597814, 'f1-score': 0.15648713550600343, 'support': 172562}, 'accuracy': 0.42937568181411734, 'macro avg': {'precision': 0.3741785797524253, 'recall': 0.34793573669222816, 'f1-score': 0.26902710324091644, 'support': 559170}, 'weighted avg': {'precision': 0.384572064034924, 'recall': 0.42937568181411734, 'f1-score': 0.3169858036124083, 'support': 559170}}
[[  4752 128813  13866]
 [  5850 218236  15091]
 [  4586 150870  17106]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1151366
{'0': {'precision': 0.3904275996112731, 'recall': 0.033559569802652185, 'f1-score': 0.06180650372108228, 'support': 47885}, '1': {'precision': 0.322771502616009, 'recall': 0.9091242970274303, 'f1-score': 0.47640298067612513, 'support': 43565}, '2': {'precision': 0.36659964017356333, 'recall': 0.07728520113339729, 'f1-score': 0.12765800626497145, 'support': 44821}, 'accuracy': 0.32785405552171776, 'macro avg': {'precision': 0.35993291413361517, 'recall': 0.33998968932115986, 'f1-score': 0.2219558302207263, 'support': 136271}, 'weighted avg': {'precision': 0.36096108923447784, 'recall': 0.32785405552171776, 'f1-score': 0.21600971433864657, 'support': 136271}}
[[ 1607 42956  3322]
 [ 1296 39606  2663]
 [ 1213 40144  3464]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.129466
{'0': {'precision': 0.4308476736775016, 'recall': 0.034253863693944765, 'f1-score': 0.06346226060833646, 'support': 19735}, '1': {'precision': 0.2780847990093788, 'recall': 0.9136593083703759, 'f1-score': 0.42639147709292924, 'support': 13273}, '2': {'precision': 0.3529606351306649, 'recall': 0.07022971105114198, 'f1-score': 0.1171497584541063, 'support': 15193}, 'accuracy': 0.2877533661127363, 'macro avg': {'precision': 0.3539643692725151, 'recall': 0.3393809610384875, 'f1-score': 0.20233449871845735, 'support': 48201}, 'weighted avg': {'precision': 0.36423164056383, 'recall': 0.2877533661127363, 'f1-score': 0.18032360467113145, 'support': 48201}}
[[  676 17787  1272]
 [  462 12127   684]
 [  431 13695  1067]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1103067
{'0': {'precision': 0.3864031277150304, 'recall': 0.04684619840949388, 'f1-score': 0.08356166528362742, 'support': 113926}, '1': {'precision': 0.3067522032767548, 'recall': 0.684162856896403, 'f1-score': 0.4235851733173117, 'support': 92744}, '2': {'precision': 0.35380821735218654, 'recall': 0.3062140701005556, 'f1-score': 0.32829513890678225, 'support': 104022}, 'accuracy': 0.3239285208502311, 'macro avg': {'precision': 0.34898784944799055, 'recall': 0.3457410418021509, 'f1-score': 0.2784806591692404, 'support': 310692}, 'weighted avg': {'precision': 0.35171368253502194, 'recall': 0.3239285208502311, 'f1-score': 0.26699994377906283, 'support': 310692}}
[[ 5337 75589 33000]
 [ 4116 63452 25176]
 [ 4359 67810 31853]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988947
{'0': {'precision': 0.33339148639218424, 'recall': 0.04305993690851735, 'f1-score': 0.07626915708812261, 'support': 44380}, '1': {'precision': 0.3702925874659921, 'recall': 0.667440960123887, 'f1-score': 0.47632350458180484, 'support': 46494}, '2': {'precision': 0.32611529548088064, 'recall': 0.33700044903457566, 'f1-score': 0.33146853146853145, 'support': 40086}, 'accuracy': 0.35470372632865, 'macro avg': {'precision': 0.34326645644635234, 'recall': 0.34916711535566, 'f1-score': 0.29468706437948633, 'support': 130960}, 'weighted avg': {'precision': 0.3442650844714077, 'recall': 0.35470372632865, 'f1-score': 0.2964130861793286, 'support': 130960}}
[[ 1911 28012 14457]
 [ 2004 31032 13458]
 [ 1817 24760 13509]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971739
{'0': {'precision': 0.3229107447413303, 'recall': 0.04274855121547377, 'f1-score': 0.07550179449687625, 'support': 13287}, '1': {'precision': 0.3738528821336392, 'recall': 0.6679690001921476, 'f1-score': 0.4793950676871452, 'support': 15613}, '2': {'precision': 0.3474909198725076, 'recall': 0.3290748280219009, 'f1-score': 0.33803223131557125, 'support': 14246}, 'accuracy': 0.3635331201038335, 'macro avg': {'precision': 0.3480848489158257, 'recall': 0.34659745980984075, 'f1-score': 0.2976430311665309, 'support': 43146}, 'weighted avg': {'precision': 0.34946080189668355, 'recall': 0.3635331201038335, 'f1-score': 0.30833900483477084, 'support': 43146}}
[[  568  8507  4212]
 [  593 10429  4591]
 [  598  8960  4688]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971787
{'0': {'precision': 0.363647022041582, 'recall': 0.09379283928715426, 'f1-score': 0.14912336933876086, 'support': 99208}, '1': {'precision': 0.290020762700728, 'recall': 0.29034507255337905, 'f1-score': 0.2901828270144829, 'support': 76013}, '2': {'precision': 0.38270608414892543, 'recall': 0.6510780732956334, 'f1-score': 0.48205718401050623, 'support': 104863}, 'accuracy': 0.355782550949001, 'macro avg': {'precision': 0.3454579562970785, 'recall': 0.3450719950453889, 'f1-score': 0.30712112678791664, 'support': 280084}, 'weighted avg': {'precision': 0.3508010100540569, 'recall': 0.355782550949001, 'f1-score': 0.3120558865986825, 'support': 280084}}
[[ 9305 26994 62909]
 [ 6728 22070 47215]
 [ 9555 27034 68274]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985634
{'0': {'precision': 0.3030943900267142, 'recall': 0.07820667470848412, 'f1-score': 0.12433222227295558, 'support': 34818}, '1': {'precision': 0.3324848870505886, 'recall': 0.30605996059428087, 'f1-score': 0.31872565193883357, 'support': 37558}, '2': {'precision': 0.3693490690927527, 'recall': 0.6216607011638656, 'f1-score': 0.463385545042538, 'support': 42187}, 'accuracy': 0.35302846468755184, 'macro avg': {'precision': 0.33497611539001854, 'recall': 0.33530911215554354, 'f1-score': 0.30214780641810907, 'support': 114563}, 'weighted avg': {'precision': 0.33712749349800636, 'recall': 0.35302846468755184, 'f1-score': 0.31291554288319984, 'support': 114563}}
[[ 2723 10432 21663]
 [ 2946 11495 23117]
 [ 3315 12646 26226]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968193
{'0': {'precision': 0.3291803278688525, 'recall': 0.08957887223411849, 'f1-score': 0.1408332164398934, 'support': 11208}, '1': {'precision': 0.3016370944025096, 'recall': 0.3028245251451629, 'f1-score': 0.30222964345349185, 'support': 10161}, '2': {'precision': 0.38881144875011614, 'recall': 0.6242912563413906, 'f1-score': 0.4791845616446201, 'support': 13404}, 'accuracy': 0.35800764961320564, 'macro avg': {'precision': 0.33987629034049277, 'recall': 0.3388982179068907, 'f1-score': 0.3074158071793351, 'support': 34773}, 'weighted avg': {'precision': 0.34411803094425436, 'recall': 0.35800764961320564, 'f1-score': 0.3184195772948478, 'support': 34773}}
[[1004 3229 6975]
 [ 905 3077 6179]
 [1141 3895 8368]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
1722/1722 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008155
{'0': {'precision': 0.32514469453376205, 'recall': 0.05293390938976639, 'f1-score': 0.09104551075042917, 'support': 143273}, '1': {'precision': 0.3191043645709958, 'recall': 0.6048688852574187, 'f1-score': 0.41779629727306294, 'support': 130954}, '2': {'precision': 0.4068587770247514, 'recall': 0.4133952103357808, 'f1-score': 0.41010094994193147, 'support': 166567}, 'accuracy': 0.3531173291832466, 'macro avg': {'precision': 0.3503692787098364, 'recall': 0.3570660016609886, 'f1-score': 0.3063142526551412, 'support': 440794}, 'weighted avg': {'precision': 0.3542282669243403, 'recall': 0.3531173291832466, 'f1-score': 0.30868329583392834, 'support': 440794}}
[[ 7584 80584 55105]
 [ 6464 79210 45280]
 [ 9277 88432 68858]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015744
{'0': {'precision': 0.34602592040371605, 'recall': 0.05518969743533458, 'f1-score': 0.09519602429596907, 'support': 54666}, '1': {'precision': 0.341228622701829, 'recall': 0.5660325283390832, 'f1-score': 0.4257792804816561, 'support': 50725}, '2': {'precision': 0.34759563681057, 'recall': 0.4304522364490782, 'f1-score': 0.38461211549413094, 'support': 52561}, 'accuracy': 0.34411720016207453, 'macro avg': {'precision': 0.3449500599720383, 'recall': 0.35055815407449864, 'f1-score': 0.30186247342391864, 'support': 157952}, 'weighted avg': {'precision': 0.3450076549694856, 'recall': 0.34411720016207453, 'f1-score': 0.2976678818190493, 'support': 157952}}
[[ 3017 28410 23239]
 [ 2787 28712 19226]
 [ 2915 27021 22625]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027011
{'0': {'precision': 0.36641483516483514, 'recall': 0.054091047348676875, 'f1-score': 0.09426627793974733, 'support': 19726}, '1': {'precision': 0.32705699512836606, 'recall': 0.6227166676150914, 'f1-score': 0.4288681611537859, 'support': 17573}, '2': {'precision': 0.37050393850242, 'recall': 0.3875707336443959, 'f1-score': 0.3788452207666182, 'support': 20146}, 'accuracy': 0.3449908608233963, 'macro avg': {'precision': 0.3546585895985404, 'recall': 0.3547928162027214, 'f1-score': 0.30065988662005044, 'support': 57445}, 'weighted avg': {'precision': 0.35580892956605564, 'recall': 0.3449908608233963, 'f1-score': 0.2964263663009701, 'support': 57445}}
[[ 1067 11176  7483]
 [  847 10943  5783]
 [  998 11340  7808]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
4450/4450 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0815945
{'0': {'precision': 0.3442820292347378, 'recall': 0.029375513557929334, 'f1-score': 0.054132248164722105, 'support': 340760}, '1': {'precision': 0.42078615446405754, 'recall': 0.8967818914385516, 'f1-score': 0.5728029070907279, 'support': 462632}, '2': {'precision': 0.3550295381093998, 'recall': 0.1312119479095924, 'f1-score': 0.19160897866685803, 'support': 335724}, 'accuracy': 0.4116709799528757, 'macro avg': {'precision': 0.3733659072693984, 'recall': 0.3524564509686911, 'f1-score': 0.27284804464076934, 'support': 1139116}, 'weighted avg': {'precision': 0.3785203799668209, 'recall': 0.4116709799528757, 'f1-score': 0.3052988388818703, 'support': 1139116}}
[[ 10010 288028  42722]
 [ 10448 414880  37304]
 [  8617 283056  44051]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125333
{'0': {'precision': 0.3626040026984484, 'recall': 0.025367733815779125, 'f1-score': 0.04741810268776099, 'support': 127130}, '1': {'precision': 0.3360723781216983, 'recall': 0.9078399548373439, 'f1-score': 0.49054893096895963, 'support': 127539}, '2': {'precision': 0.3676114649681529, 'recall': 0.08869065455746875, 'f1-score': 0.14290401054788332, 'support': 130149}, 'accuracy': 0.3392590783175423, 'macro avg': {'precision': 0.3554292819294332, 'recall': 0.3406327810701973, 'f1-score': 0.22695701473486798, 'support': 384818}, 'weighted avg': {'precision': 0.3555042811158967, 'recall': 0.3392590783175423, 'f1-score': 0.22657775252285925, 'support': 384818}}
[[  3225 112994  10911]
 [  2808 115785   8946]
 [  2861 115745  11543]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0873371
{'0': {'precision': 0.2933135215453195, 'recall': 0.028677688351686666, 'f1-score': 0.05224710179450532, 'support': 34417}, '1': {'precision': 0.40885704257304534, 'recall': 0.9087605129961563, 'f1-score': 0.5639772089865085, 'support': 52554}, '2': {'precision': 0.37097242380261247, 'recall': 0.08805695911805236, 'f1-score': 0.14232946635730856, 'support': 43540}, 'accuracy': 0.4028779183363854, 'macro avg': {'precision': 0.35771432930699243, 'recall': 0.3418317201552985, 'f1-score': 0.25285125904610745, 'support': 130511}, 'weighted avg': {'precision': 0.36574835698734076, 'recall': 0.4028779183363854, 'f1-score': 0.2883624499753712, 'support': 130511}}
[[  987 30395  3035]
 [ 1329 47759  3466]
 [ 1049 38657  3834]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
6203/6203 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0751278
{'0': {'precision': 0.30336598614544236, 'recall': 0.023611368419052505, 'f1-score': 0.0438127348251964, 'support': 421026}, '1': {'precision': 0.443864640649306, 'recall': 0.921941010654992, 'f1-score': 0.5992316915711217, 'support': 691413}, '2': {'precision': 0.3536249180548318, 'recall': 0.08849883263571924, 'f1-score': 0.1415684743914995, 'support': 475430}, 'accuracy': 0.43420332533729167, 'macro avg': {'precision': 0.36695184828319344, 'recall': 0.3446837372365879, 'f1-score': 0.2615376335959392, 'support': 1587869}, 'weighted avg': {'precision': 0.37959217369879905, 'recall': 0.43420332533729167, 'f1-score': 0.314930754260413, 'support': 1587869}}
[[  9941 375160  35925]
 [ 12989 637442  40982]
 [  9839 423516  42075]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1127369
{'0': {'precision': 0.3443024906439541, 'recall': 0.017215013453262012, 'f1-score': 0.03279051189086216, 'support': 154981}, '1': {'precision': 0.33540473240680546, 'recall': 0.9099416294501721, 'f1-score': 0.49014272346924515, 'support': 150247}, '2': {'precision': 0.34580204778157, 'recall': 0.086296768214989, 'f1-score': 0.13812395711777342, 'support': 146761}, 'accuracy': 0.336399779640655, 'macro avg': {'precision': 0.3418364236107765, 'recall': 0.337817803706141, 'f1-score': 0.22035239749262692, 'support': 451989}, 'weighted avg': {'precision': 0.3418316672903255, 'recall': 0.336399779640655, 'f1-score': 0.21902212258927303, 'support': 451989}}
[[  2668 139368  12945]
 [  2516 136716  11015]
 [  2565 131531  12665]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0873321
{'0': {'precision': 0.2948717948717949, 'recall': 0.021133546984603662, 'f1-score': 0.03944038980321629, 'support': 44621}, '1': {'precision': 0.40929667414964477, 'recall': 0.9157728968089515, 'f1-score': 0.5657405605792174, 'support': 60325}, '2': {'precision': 0.32128067871932126, 'recall': 0.07376060844965913, 'f1-score': 0.11997661568634846, 'support': 43126}, 'accuracy': 0.4009400832027662, 'macro avg': {'precision': 0.3418163825802536, 'recall': 0.33688901741440475, 'f1-score': 0.24171918868959405, 'support': 148072}, 'weighted avg': {'precision': 0.3491804444966039, 'recall': 0.4009400832027662, 'f1-score': 0.27731293207655777, 'support': 148072}}
[[  943 40498  3180]
 [ 1541 55244  3540]
 [  714 39231  3181]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
5183/5183 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1215454
{'0': {'precision': 0.3770468494514088, 'recall': 0.03502673620207241, 'f1-score': 0.06409884540700812, 'support': 454253}, '1': {'precision': 0.28159827618512273, 'recall': 0.8449040629198828, 'f1-score': 0.4224110672492225, 'support': 355754}, '2': {'precision': 0.41845274263934157, 'recall': 0.17588636838561378, 'f1-score': 0.2476705028444386, 'support': 516828}, 'accuracy': 0.30704043833634176, 'macro avg': {'precision': 0.3590326227586244, 'recall': 0.35193905583585633, 'f1-score': 0.24472680516688974, 'support': 1326835}, 'weighted avg': {'precision': 0.36758336170105443, 'recall': 0.30704043833634176, 'f1-score': 0.23167505400817365, 'support': 1326835}}
[[ 15911 356976  81366]
 [ 10209 300578  44967]
 [ 16079 409846  90903]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099465
{'0': {'precision': 0.3802608454352049, 'recall': 0.030894211186845724, 'f1-score': 0.05714563727602553, 'support': 133067}, '1': {'precision': 0.33165856362744284, 'recall': 0.8542858315210701, 'f1-score': 0.477815339350835, 'support': 121855}, '2': {'precision': 0.3689251507626818, 'recall': 0.16489222549011837, 'f1-score': 0.22791648175846332, 'support': 126143}, 'accuracy': 0.33855116581160694, 'macro avg': {'precision': 0.36028151994177654, 'recall': 0.3500240893993447, 'f1-score': 0.2542924861284413, 'support': 381065}, 'weighted avg': {'precision': 0.36096663163241294, 'recall': 0.33855116581160694, 'f1-score': 0.24819507288904186, 'support': 381065}}
[[  4111 107948  21008]
 [  3184 104099  14572]
 [  3516 101827  20800]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057711
{'0': {'precision': 0.3689171974522293, 'recall': 0.032766852979113394, 'f1-score': 0.06018787929171169, 'support': 44191}, '1': {'precision': 0.34705607644501923, 'recall': 0.8681898856462448, 'f1-score': 0.49588410037277286, 'support': 44511}, '2': {'precision': 0.36903535873669757, 'recall': 0.146427841721719, 'f1-score': 0.20966404992929932, 'support': 44049}, 'accuracy': 0.3505962290302898, 'macro avg': {'precision': 0.36166954421131536, 'recall': 0.34912819344902574, 'f1-score': 0.25524534319792797, 'support': 132751}, 'weighted avg': {'precision': 0.36162643903434627, 'recall': 0.3505962290302898, 'f1-score': 0.2558741666790324, 'support': 132751}}
[[ 1448 36390  6353]
 [ 1192 38644  4675]
 [ 1285 36314  6450]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
7324/7324 - 54s - 54s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036837
{'0': {'precision': 0.318673860076575, 'recall': 0.02970848016406103, 'f1-score': 0.054350149002101465, 'support': 616356}, '1': {'precision': 0.3569709267794113, 'recall': 0.799613963089026, 'f1-score': 0.4935892556959075, 'support': 656932}, '2': {'precision': 0.3383133505922508, 'recall': 0.19447534389845247, 'f1-score': 0.24697823314272196, 'support': 601413}, 'accuracy': 0.35235645577614777, 'macro avg': {'precision': 0.33798604581607905, 'recall': 0.3412659290505132, 'f1-score': 0.2649725459469103, 'support': 1874701}, 'weighted avg': {'precision': 0.33839434538742286, 'recall': 0.35235645577614777, 'f1-score': 0.2700641528917022, 'support': 1874701}}
[[ 18311 479709 118336]
 [ 21221 525292 110419]
 [ 17928 466525 116960]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1084219
{'0': {'precision': 0.34213793103448276, 'recall': 0.02835586293618359, 'f1-score': 0.05237127550077855, 'support': 174955}, '1': {'precision': 0.3381693961141923, 'recall': 0.8251822890986188, 'f1-score': 0.4797369530393728, 'support': 172391}, '2': {'precision': 0.36176361029901455, 'recall': 0.1816795537516156, 'f1-score': 0.24188380912847413, 'support': 176404}, 'accuracy': 0.34227016706443913, 'macro avg': {'precision': 0.34735697914922986, 'recall': 0.3450725685954727, 'f1-score': 0.2579973458895419, 'support': 523750}, 'weighted avg': {'precision': 0.34744181384409933, 'recall': 0.34227016706443913, 'f1-score': 0.2568672478131715, 'support': 523750}}
[[  4961 138855  31139]
 [  4734 142254  25403]
 [  4805 139550  32049]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043345
{'0': {'precision': 0.33869405154039917, 'recall': 0.027889018300173908, 'f1-score': 0.0515345381644506, 'support': 62677}, '1': {'precision': 0.3543795572315766, 'recall': 0.821986726611004, 'f1-score': 0.4952459046601191, 'support': 65394}, '2': {'precision': 0.3464439490640364, 'recall': 0.18441457110811293, 'f1-score': 0.24070184371883815, 'support': 61519}, 'accuracy': 0.3525818872303392, 'macro avg': {'precision': 0.346505852612004, 'recall': 0.34476343867309694, 'f1-score': 0.2624940955144693, 'support': 189590}, 'weighted avg': {'precision': 0.34661906818117927, 'recall': 0.3525818872303392, 'f1-score': 0.26596274941513953, 'support': 189590}}
[[ 1748 49404 11525]
 [ 1764 53753  9877]
 [ 1649 48525 11345]]
testing model on single stock: results/universal/W6/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
29350/29350 - 222s - 222s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0916848
{'0': {'precision': 0.3005218584367114, 'recall': 0.03297019350433967, 'f1-score': 0.0594212891568016, 'support': 2232198}, '1': {'precision': 0.40381829945623393, 'recall': 0.7795181449915023, 'f1-score': 0.5320273759550374, 'support': 3016094}, '2': {'precision': 0.3081173617122486, 'recall': 0.19674125769775996, 'f1-score': 0.24014405194319505, 'support': 2265107}, 'accuracy': 0.382028959196763, 'macro avg': {'precision': 0.337485839868398, 'recall': 0.3364098653978673, 'f1-score': 0.27719757235167797, 'support': 7513399}, 'weighted avg': {'precision': 0.3442778740054677, 'recall': 0.382028959196763, 'f1-score': 0.30362245267845633, 'support': 7513399}}
[[  73596 1726006  432596]
 [  96898 2351100  568096]
 [  74400 1745067  445640]]
Evaluating performance on  train set...
5452/5452 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013443
{'0': {'precision': 0.35211355547692885, 'recall': 0.036329902486057934, 'f1-score': 0.06586416052199236, 'support': 465677}, '1': {'precision': 0.34671752679835666, 'recall': 0.7620450378266775, 'f1-score': 0.47659323872208625, 'support': 463033}, '2': {'precision': 0.3553268856923632, 'recall': 0.25101175543048615, 'f1-score': 0.2941960788252546, 'support': 466763}, 'accuracy': 0.3489376003691938, 'macro avg': {'precision': 0.35138598932254955, 'recall': 0.3497955652477405, 'f1-score': 0.2788844926897778, 'support': 1395473}, 'weighted avg': {'precision': 0.3513979015762238, 'recall': 0.3489376003691938, 'f1-score': 0.2785218102573937, 'support': 1395473}}
[[ 16918 331701 117058]
 [ 14669 352852  95512]
 [ 16460 333140 117163]]
Evaluating performance on  val set...
1969/1969 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0927712
{'0': {'precision': 0.3320817968488099, 'recall': 0.03083253445549732, 'f1-score': 0.05642611801295306, 'support': 160642}, '1': {'precision': 0.3882067287455212, 'recall': 0.800074056441588, 'f1-score': 0.522762188999701, 'support': 189045}, '2': {'precision': 0.3273622343899131, 'recall': 0.21107044534412955, 'f1-score': 0.2566578708991375, 'support': 154375}, 'accuracy': 0.3745313076565978, 'macro avg': {'precision': 0.3492169199947481, 'recall': 0.3473256787470716, 'f1-score': 0.2786153926372638, 'support': 504062}, 'weighted avg': {'precision': 0.3516856457718026, 'recall': 0.3745313076565978, 'f1-score': 0.2926456294847452, 'support': 504062}}
[[  4953 121292  34397]
 [  5241 151250  32554]
 [  4721 117070  32584]]
training model: results/universal/W6/deepVOL_L2/h300
Epoch 1/50
9426/9426 - 303s - loss: 3.2431 - accuracy300: 0.3874 - val_loss: 3.3030 - val_accuracy300: 0.3541 - 303s/epoch - 32ms/step
Epoch 2/50
9426/9426 - 297s - loss: 3.2340 - accuracy300: 0.3953 - val_loss: 3.3354 - val_accuracy300: 0.3510 - 297s/epoch - 32ms/step
Epoch 3/50
9426/9426 - 304s - loss: 3.2288 - accuracy300: 0.3992 - val_loss: 3.3396 - val_accuracy300: 0.3507 - 304s/epoch - 32ms/step
Epoch 4/50
9426/9426 - 304s - loss: 3.2246 - accuracy300: 0.4023 - val_loss: 3.3334 - val_accuracy300: 0.3527 - 304s/epoch - 32ms/step
Epoch 5/50
9426/9426 - 300s - loss: 3.2204 - accuracy300: 0.4050 - val_loss: 3.3618 - val_accuracy300: 0.3519 - 300s/epoch - 32ms/step
Epoch 6/50
9426/9426 - 301s - loss: 3.2162 - accuracy300: 0.4077 - val_loss: 3.3495 - val_accuracy300: 0.3547 - 301s/epoch - 32ms/step
Epoch 7/50
9426/9426 - 300s - loss: 3.2134 - accuracy300: 0.4095 - val_loss: 3.3548 - val_accuracy300: 0.3534 - 300s/epoch - 32ms/step
Epoch 8/50
9426/9426 - 301s - loss: 3.2112 - accuracy300: 0.4102 - val_loss: 3.3396 - val_accuracy300: 0.3544 - 301s/epoch - 32ms/step
Epoch 9/50
9426/9426 - 298s - loss: 3.2086 - accuracy300: 0.4119 - val_loss: 3.3288 - val_accuracy300: 0.3545 - 298s/epoch - 32ms/step
Epoch 10/50
9426/9426 - 300s - loss: 3.2063 - accuracy300: 0.4128 - val_loss: 3.3529 - val_accuracy300: 0.3528 - 300s/epoch - 32ms/step
Epoch 11/50
9426/9426 - 294s - loss: 3.2052 - accuracy300: 0.4136 - val_loss: 3.3477 - val_accuracy300: 0.3558 - 294s/epoch - 31ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 663s - 663s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939783
{'0': {'precision': 0.33098429720413636, 'recall': 0.08901640937087982, 'f1-score': 0.140299924424027, 'support': 3252288}, '1': {'precision': 0.3960317091252731, 'recall': 0.8682637705799041, 'f1-score': 0.5439550968172387, 'support': 4266723}, '2': {'precision': 0.324814812930103, 'recall': 0.05803429366672142, 'f1-score': 0.09847429661492195, 'support': 3299618}, 'accuracy': 0.38689181411064194, 'macro avg': {'precision': 0.35061027308650417, 'recall': 0.3384381578725018, 'f1-score': 0.2609097726187292, 'support': 10818629}, 'weighted avg': {'precision': 0.35475647269634253, 'recall': 0.38689181411064194, 'f1-score': 0.28673957160472413, 'support': 10818629}}
[[ 289507 2807873  154908]
 [ 318942 3704641  243140]
 [ 266236 2841891  191491]]
Evaluating performance on  train set...
9426/9426 - 157s - 157s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1088587
{'0': {'precision': 0.36286565377132124, 'recall': 0.09210152244453812, 'f1-score': 0.14691380346662627, 'support': 816056}, '1': {'precision': 0.3249648915377748, 'recall': 0.8562984816500928, 'f1-score': 0.4711344642176223, 'support': 786380}, '2': {'precision': 0.3560111345170027, 'recall': 0.058438086205469995, 'f1-score': 0.10039642170273572, 'support': 809763}, 'accuracy': 0.329930076249928, 'macro avg': {'precision': 0.3479472266086996, 'recall': 0.33561269676670036, 'f1-score': 0.23948156312899474, 'support': 2412199}, 'weighted avg': {'precision': 0.34820892873323317, 'recall': 0.329930076249928, 'f1-score': 0.2369945093255106, 'support': 2412199}}
[[ 75160 703575  37321]
 [ 64726 673376  48278]
 [ 67243 695199  47321]]
Evaluating performance on  val set...
3323/3323 - 52s - 52s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020088
{'0': {'precision': 0.35174684470459117, 'recall': 0.08386545765114209, 'f1-score': 0.13543882920186995, 'support': 275155}, '1': {'precision': 0.3534102947168274, 'recall': 0.8667250665325468, 'f1-score': 0.502091113707383, 'support': 300229}, '2': {'precision': 0.36018761493481, 'recall': 0.063408228665379, 'f1-score': 0.10783325188516427, 'support': 274917}, 'accuracy': 0.35366770120228014, 'macro avg': {'precision': 0.3551149181187429, 'recall': 0.3379995842830226, 'f1-score': 0.24845439826480573, 'support': 850301}, 'weighted avg': {'precision': 0.3550632316817966, 'recall': 0.35366770120228014, 'f1-score': 0.2559730943922307, 'support': 850301}}
[[ 23076 239447  12632]
 [ 21680 260216  18333]
 [ 20848 236637  17432]]
testing model out of sample: results/universal/W6/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 280s - 280s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965006
{'0': {'precision': 0.3611441947488368, 'recall': 0.06355570189625637, 'f1-score': 0.10808937305770741, 'support': 1378822}, '1': {'precision': 0.37439908792137055, 'recall': 0.8821591281542159, 'f1-score': 0.5256892498207698, 'support': 1681123}, '2': {'precision': 0.32527804427388696, 'recall': 0.0642317769180142, 'f1-score': 0.10727938367353636, 'support': 1425198}, 'accuracy': 0.37059977797809346, 'macro avg': {'precision': 0.35360710898136477, 'recall': 0.33664886898949553, 'f1-score': 0.24701933551733787, 'support': 4485143}, 'weighted avg': {'precision': 0.35471557917298824, 'recall': 0.37059977797809346, 'f1-score': 0.2643569351785156, 'support': 4485143}}
[[  87632 1221025   70165]
 [  78383 1483018  119722]
 [  76636 1257019   91543]]
Evaluating performance on  train set...
5153/5153 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085446
{'0': {'precision': 0.3831533061957114, 'recall': 0.05376849500839992, 'f1-score': 0.09430326696841503, 'support': 444647}, '1': {'precision': 0.33188975070525795, 'recall': 0.8893272245216463, 'f1-score': 0.48338435647284894, 'support': 438274}, '2': {'precision': 0.36043214704732107, 'recall': 0.06768970883234564, 'f1-score': 0.11397477962119192, 'support': 435694}, 'accuracy': 0.33608672736166356, 'macro avg': {'precision': 0.3584917346494301, 'recall': 0.3369284761207973, 'f1-score': 0.23055413435415198, 'support': 1318615}, 'weighted avg': {'precision': 0.35860712991755456, 'recall': 0.33608672736166356, 'f1-score': 0.23012371907551624, 'support': 1318615}}
[[ 23908 397419  23320]
 [ 19493 389769  29012]
 [ 18997 387205  29492]]
Evaluating performance on  val set...
1795/1795 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984707
{'0': {'precision': 0.36980740996631833, 'recall': 0.058879339979374355, 'f1-score': 0.10158474093755931, 'support': 145450}, '1': {'precision': 0.36754744976816073, 'recall': 0.8760336911098144, 'f1-score': 0.5178334384374444, 'support': 169659}, '2': {'precision': 0.32437258841162026, 'recall': 0.07074549842470945, 'f1-score': 0.116157175320597, 'support': 143783}, 'accuracy': 0.3647110867044969, 'macro avg': {'precision': 0.35390914938203305, 'recall': 0.33521950983796606, 'f1-score': 0.24519178489853358, 'support': 458892}, 'weighted avg': {'precision': 0.3547359388252691, 'recall': 0.3647110867044969, 'f1-score': 0.2600438252145337, 'support': 458892}}
[[  8564 129077   7809]
 [  7654 148627  13378]
 [  6940 126671  10172]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057659
{'0': {'precision': 0.30916976456009915, 'recall': 0.0835516008276225, 'f1-score': 0.13155194004274592, 'support': 83613}, '1': {'precision': 0.338447700965477, 'recall': 0.9112388598605915, 'f1-score': 0.4935744799021548, 'support': 91673}, '2': {'precision': 0.3933333333333333, 'recall': 0.006775874129524645, 'f1-score': 0.01332224856565159, 'support': 95781}, 'accuracy': 0.33634119977717686, 'macro avg': {'precision': 0.3469835996196365, 'recall': 0.3338554449392462, 'f1-score': 0.21281622283685075, 'support': 271067}, 'weighted avg': {'precision': 0.3488103960082627, 'recall': 0.33634119977717686, 'f1-score': 0.2122092469711585, 'support': 271067}}
[[ 6986 76259   368]
 [ 7504 83536   633]
 [ 8106 87026   649]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057286
{'0': {'precision': 0.3547706905640485, 'recall': 0.07486095661846497, 'f1-score': 0.12363369155873978, 'support': 17980}, '1': {'precision': 0.33843320583652076, 'recall': 0.9176360842844601, 'f1-score': 0.4944926593432588, 'support': 18224}, '2': {'precision': 0.3404255319148936, 'recall': 0.014418473669388905, 'f1-score': 0.027665207759226238, 'support': 17755}, 'accuracy': 0.339609703663893, 'macro avg': {'precision': 0.3445431427718209, 'recall': 0.33563850485743796, 'f1-score': 0.21526385288707495, 'support': 53959}, 'weighted avg': {'precision': 0.34453268367937284, 'recall': 0.339609703663893, 'f1-score': 0.21730876706133825, 'support': 53959}}
[[ 1346 16439   195]
 [ 1200 16723   301]
 [ 1248 16251   256]]
Evaluating performance on  val set...
81/81 - 1s - 744ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004238
{'0': {'precision': 0.34285714285714286, 'recall': 0.08329560887279312, 'f1-score': 0.13402937962850553, 'support': 6627}, '1': {'precision': 0.3480077120822622, 'recall': 0.9011232838718625, 'f1-score': 0.5021056291774525, 'support': 7211}, '2': {'precision': 0.352112676056338, 'recall': 0.018385056625974408, 'f1-score': 0.0349454850433324, 'support': 6799}, 'accuracy': 0.34767650336773753, 'macro avg': {'precision': 0.347659176998581, 'recall': 0.33426798312354333, 'f1-score': 0.22369349794976348, 'support': 20637}, 'weighted avg': {'precision': 0.3477061579709513, 'recall': 0.34767650336773753, 'f1-score': 0.2299990668995655, 'support': 20637}}
[[ 552 5986   89]
 [ 572 6498  141]
 [ 486 6188  125]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1094574
{'0': {'precision': 0.3861593920828609, 'recall': 0.12032188490399878, 'f1-score': 0.18347539401736893, 'support': 189633}, '1': {'precision': 0.2989086921711282, 'recall': 0.805407370062492, 'f1-score': 0.4360042779119474, 'support': 170582}, '2': {'precision': 0.3916353569309868, 'recall': 0.07963409730599115, 'f1-score': 0.13235539813546296, 'support': 198960}, 'accuracy': 0.31483703670586133, 'macro avg': {'precision': 0.3589011470616586, 'recall': 0.3351211174241606, 'f1-score': 0.25061169002159306, 'support': 559175}, 'weighted avg': {'precision': 0.36149108444006556, 'recall': 0.31483703670586133, 'f1-score': 0.24232288843654176, 'support': 559175}}
[[ 22817 155026  11790]
 [ 20372 137388  12822]
 [ 15898 167218  15844]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959522
{'0': {'precision': 0.4499536607970343, 'recall': 0.14472479506015118, 'f1-score': 0.21900726587295194, 'support': 46965}, '1': {'precision': 0.3284099830208314, 'recall': 0.7978532301346166, 'f1-score': 0.4652961451657753, 'support': 45091}, '2': {'precision': 0.4050077439339184, 'recall': 0.10644986204713013, 'f1-score': 0.16858882521489973, 'support': 44218}, 'accuracy': 0.3484156919148187, 'macro avg': {'precision': 0.39445712925059473, 'recall': 0.349675962413966, 'f1-score': 0.2842974120845423, 'support': 136274}, 'weighted avg': {'precision': 0.39515271177917305, 'recall': 0.3484156919148187, 'f1-score': 0.28414081480506626, 'support': 136274}}
[[ 6797 37143  3025]
 [ 5225 35976  3890]
 [ 3084 36427  4707]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1104591
{'0': {'precision': 0.44145873320537427, 'recall': 0.14409386034855906, 'f1-score': 0.21726995577311176, 'support': 17558}, '1': {'precision': 0.3270763558947997, 'recall': 0.8003303475001589, 'f1-score': 0.4643739172103653, 'support': 15741}, '2': {'precision': 0.3464845725847243, 'recall': 0.09192779977185801, 'f1-score': 0.1453041310919022, 'support': 14903}, 'accuracy': 0.34226795568648605, 'macro avg': {'precision': 0.3716732205616327, 'recall': 0.34545066920685863, 'f1-score': 0.2756493346917931, 'support': 48202}, 'weighted avg': {'precision': 0.37474173148396644, 'recall': 0.34226795568648605, 'f1-score': 0.275714766605852, 'support': 48202}}
[[ 2530 13832  1196]
 [ 1755 12598  1388]
 [ 1446 12087  1370]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1164206
{'0': {'precision': 0.4278326821420363, 'recall': 0.06743771113908688, 'f1-score': 0.11651032335291862, 'support': 110413}, '1': {'precision': 0.2964574587898024, 'recall': 0.8796614766993979, 'f1-score': 0.44346230318809976, 'support': 92165}, '2': {'precision': 0.38043094312963616, 'recall': 0.06972872483097328, 'f1-score': 0.11785580290145072, 'support': 108119}, 'accuracy': 0.309172602245918, 'macro avg': {'precision': 0.368240361353825, 'recall': 0.33894263755648607, 'f1-score': 0.22594280981415638, 'support': 310697}, 'weighted avg': {'precision': 0.3723663400771296, 'recall': 0.309172602245918, 'f1-score': 0.21396540378439113, 'support': 310697}}
[[ 7446 96931  6036]
 [ 4849 81074  6242]
 [ 5109 95471  7539]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105494
{'0': {'precision': 0.36488586112107085, 'recall': 0.06938005635851287, 'f1-score': 0.11659124324530752, 'support': 44004}, '1': {'precision': 0.34518976017616904, 'recall': 0.8826544078831603, 'f1-score': 0.49628979198100376, 'support': 45464}, '2': {'precision': 0.3190348525469169, 'recall': 0.0487563867733539, 'f1-score': 0.08458595530282441, 'support': 41492}, 'accuracy': 0.34518173488087966, 'macro avg': {'precision': 0.3430368246147189, 'recall': 0.3335969503383423, 'f1-score': 0.23248899684304525, 'support': 130960}, 'weighted avg': {'precision': 0.34352121862628, 'recall': 0.34518173488087966, 'f1-score': 0.23826695653493934, 'support': 130960}}
[[ 3053 39163  1788]
 [ 2805 40129  2530]
 [ 2509 36960  2023]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105829
{'0': {'precision': 0.3640699523052464, 'recall': 0.08259991343240514, 'f1-score': 0.13465043805491855, 'support': 13862}, '1': {'precision': 0.3484198615898745, 'recall': 0.8812645590682197, 'f1-score': 0.4993965452213925, 'support': 15025}, '2': {'precision': 0.3136568284142071, 'recall': 0.04396914446002805, 'f1-score': 0.07712651454579003, 'support': 14260}, 'accuracy': 0.3479500312883862, 'macro avg': {'precision': 0.34204888076977596, 'recall': 0.33594453898688426, 'f1-score': 0.23705783260736701, 'support': 43147}, 'weighted avg': {'precision': 0.3419587102795046, 'recall': 0.3479500312883862, 'f1-score': 0.24265375487731872, 'support': 43147}}
[[ 1145 12120   597]
 [ 1009 13241   775]
 [  991 12642   627]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1213069
{'0': {'precision': 0.3538186703051701, 'recall': 0.5064276150880337, 'f1-score': 0.41658661808545877, 'support': 99337}, '1': {'precision': 0.2602051953721895, 'recall': 0.5001468552007721, 'f1-score': 0.3423172465287251, 'support': 71499}, '2': {'precision': 0.42016806722689076, 'recall': 0.001830613347001913, 'f1-score': 0.0036453444394827254, 'support': 109253}, 'accuracy': 0.30799852903898406, 'macro avg': {'precision': 0.3447306443014168, 'recall': 0.33613502787860255, 'f1-score': 0.25418306968455556, 'support': 280089}, 'weighted avg': {'precision': 0.3558023284197535, 'recall': 0.30799852903898406, 'f1-score': 0.2365536329750877, 'support': 280089}}
[[50307 48836   194]
 [35657 35760    82]
 [56219 52834   200]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085097
{'0': {'precision': 0.33151859956236324, 'recall': 0.5071365450017407, 'f1-score': 0.4009400008468476, 'support': 37343}, '1': {'precision': 0.33737296126846644, 'recall': 0.5108003066916955, 'f1-score': 0.40635615055369184, 'support': 37823}, '2': {'precision': 0.2947976878612717, 'recall': 0.0012944819533986496, 'f1-score': 0.0025776452452553637, 'support': 39398}, 'accuracy': 0.33438951153940155, 'macro avg': {'precision': 0.3212297495640338, 'recall': 0.3397437778822783, 'f1-score': 0.26995793221526493, 'support': 114564}, 'weighted avg': {'precision': 0.3208232593473772, 'recall': 0.33438951153940155, 'f1-score': 0.2657332600239926, 'support': 114564}}
[[18938 18341    64]
 [18445 19320    58]
 [19742 19605    51]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1173111
{'0': {'precision': 0.3289330818903937, 'recall': 0.49365351629502574, 'f1-score': 0.3948009190987345, 'support': 11660}, '1': {'precision': 0.2960446070744032, 'recall': 0.505103557625607, 'f1-score': 0.3732972022850447, 'support': 10091}, '2': {'precision': 0.5087719298245614, 'recall': 0.002227000460758716, 'f1-score': 0.004434589800443459, 'support': 13022}, 'accuracy': 0.3129439507663992, 'macro avg': {'precision': 0.37791653959645277, 'recall': 0.33366135812713044, 'f1-score': 0.2575109037280742, 'support': 34773}, 'weighted avg': {'precision': 0.38673608647528923, 'recall': 0.3129439507663992, 'f1-score': 0.24237391117622883, 'support': 34773}}
[[5756 5889   15]
 [4981 5097   13]
 [6762 6231   29]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1113187
{'0': {'precision': 0.35389286308434537, 'recall': 0.11671193043096591, 'f1-score': 0.17553378029912328, 'support': 145812}, '1': {'precision': 0.3095137310234904, 'recall': 0.8747415371891062, 'f1-score': 0.4572401307789997, 'support': 135416}, '2': {'precision': 0.34166583341665835, 'recall': 0.021413665390327817, 'f1-score': 0.04030146486448235, 'support': 159571}, 'accuracy': 0.3150846530958555, 'macro avg': {'precision': 0.33502414250816476, 'recall': 0.3376223776701333, 'f1-score': 0.22435845864753512, 'support': 440799}, 'weighted avg': {'precision': 0.33583310365146274, 'recall': 0.3150846530958555, 'f1-score': 0.2131209602844723, 'support': 440799}}
[[ 17018 126294   2500]
 [ 12878 118454   4084]
 [ 18192 137962   3417]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1086947
{'0': {'precision': 0.3582335947172926, 'recall': 0.06427011217652068, 'f1-score': 0.10898703581630412, 'support': 54022}, '1': {'precision': 0.3215629804314405, 'recall': 0.905857453604813, 'f1-score': 0.47463805318821234, 'support': 51029}, '2': {'precision': 0.29711751662971175, 'recall': 0.025329855203962044, 'f1-score': 0.046680136556817395, 'support': 52902}, 'accuracy': 0.32311510386000897, 'macro avg': {'precision': 0.325638030592815, 'recall': 0.3318191403284319, 'f1-score': 0.21010174185377795, 'support': 157953}, 'weighted avg': {'precision': 0.3259174782815051, 'recall': 0.32311510386000897, 'f1-score': 0.20624790570067314, 'support': 157953}}
[[ 3472 49360  1190]
 [ 2824 46225  1980]
 [ 3396 48166  1340]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10909
{'0': {'precision': 0.3507078507078507, 'recall': 0.11363636363636363, 'f1-score': 0.17165354330708663, 'support': 19184}, '1': {'precision': 0.32026853191831484, 'recall': 0.8644748263888888, 'f1-score': 0.46738237709726627, 'support': 18432}, '2': {'precision': 0.3159675236806495, 'recall': 0.023550176500252144, 'f1-score': 0.04383330204617984, 'support': 19830}, 'accuracy': 0.32345158931866447, 'macro avg': {'precision': 0.32898130210227167, 'recall': 0.3338871221751682, 'f1-score': 0.22762307415017757, 'support': 57446}, 'weighted avg': {'precision': 0.3289490126881779, 'recall': 0.32345158931866447, 'f1-score': 0.22241771279176456, 'support': 57446}}
[[ 2180 16570   434]
 [ 1921 15934   577]
 [ 2115 17248   467]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
4450/4450 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146872
{'0': {'precision': 0.41663481385215195, 'recall': 0.04162317659937374, 'f1-score': 0.07568515899669716, 'support': 392810}, '1': {'precision': 0.31562242687510866, 'recall': 0.8349801446329924, 'f1-score': 0.4580877292776654, 'support': 363126}, '2': {'precision': 0.3762201297162188, 'recall': 0.13669637381421507, 'f1-score': 0.20053138136183699, 'support': 383185}, 'accuracy': 0.32650877299250913, 'macro avg': {'precision': 0.3694924568144931, 'recall': 0.33776656501552704, 'f1-score': 0.2447680898787332, 'support': 1139121}, 'weighted avg': {'precision': 0.3708393937220224, 'recall': 0.32650877299250913, 'f1-score': 0.23958303767054567, 'support': 1139121}}
[[ 16350 335658  40802]
 [ 13878 303203  46045]
 [  9015 321790  52380]]
Evaluating performance on  train set...
1504/1504 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1100316
{'0': {'precision': 0.4474336722043144, 'recall': 0.028035205195329795, 'f1-score': 0.052764315006908036, 'support': 128731}, '1': {'precision': 0.3308801009754151, 'recall': 0.8419411973078286, 'f1-score': 0.47506229429557467, 'support': 127035}, '2': {'precision': 0.3855829252794079, 'recall': 0.15986455177330244, 'f1-score': 0.22602008117923522, 'support': 129053}, 'accuracy': 0.3409291121280394, 'macro avg': {'precision': 0.38796556615304584, 'recall': 0.3432803180921536, 'f1-score': 0.25128223016057266, 'support': 384819}, 'weighted avg': {'precision': 0.38821516333660466, 'recall': 0.3409291121280394, 'f1-score': 0.25027483343446255, 'support': 384819}}
[[  3609 109801  15321]
 [  2525 106956  17554]
 [  1932 106490  20631]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954524
{'0': {'precision': 0.38489687292082503, 'recall': 0.029145779278031084, 'f1-score': 0.05418823033510526, 'support': 39697}, '1': {'precision': 0.35277045338020946, 'recall': 0.833156745302398, 'f1-score': 0.4956680023927292, 'support': 46247}, '2': {'precision': 0.3947814670969859, 'recall': 0.1619359615859268, 'f1-score': 0.22966522403258655, 'support': 44567}, 'accuracy': 0.35939499352544996, 'macro avg': {'precision': 0.37748293113267345, 'recall': 0.3414128287221186, 'f1-score': 0.259840485586807, 'support': 130511}, 'weighted avg': {'precision': 0.3768881700846971, 'recall': 0.35939499352544996, 'f1-score': 0.27055005574801744, 'support': 130511}}
[[ 1157 34100  4440]
 [ 1092 38531  6624]
 [  757 36593  7217]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
6203/6203 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023221
{'0': {'precision': 0.37141074739632973, 'recall': 0.08406433178602876, 'f1-score': 0.13709815410349366, 'support': 509919}, '1': {'precision': 0.33722093567285877, 'recall': 0.8531086694358837, 'f1-score': 0.4833721727210419, 'support': 537336}, '2': {'precision': 0.3790319728372356, 'recall': 0.07929244070223207, 'f1-score': 0.1311488951607352, 'support': 540619}, 'accuracy': 0.34268399129905774, 'macro avg': {'precision': 0.36255455196880804, 'recall': 0.33882181397471484, 'f1-score': 0.2505397406617569, 'support': 1587874}, 'weighted avg': {'precision': 0.36243570441709716, 'recall': 0.34268399129905774, 'f1-score': 0.2522516320542024, 'support': 1587874}}
[[ 42866 436846  30207]
 [ 38908 458406  40022]
 [ 33640 464112  42867]]
Evaluating performance on  train set...
1766/1766 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052494
{'0': {'precision': 0.38921642897137776, 'recall': 0.0772832804682646, 'f1-score': 0.12896009079698362, 'support': 152905}, '1': {'precision': 0.338737579562983, 'recall': 0.8765508969476906, 'f1-score': 0.48864238398497584, 'support': 152573}, '2': {'precision': 0.369914606406384, 'recall': 0.06770730242367572, 'f1-score': 0.11446373968730168, 'support': 146513}, 'accuracy': 0.34397808805927554, 'macro avg': {'precision': 0.3659562049802483, 'recall': 0.34051382661321034, 'f1-score': 0.24402207148975374, 'support': 451991}, 'weighted avg': {'precision': 0.3659202186037998, 'recall': 0.34397808805927554, 'f1-score': 0.24567458871494816, 'support': 451991}}
[[ 11817 133266   7822]
 [  9760 133738   9075]
 [  8784 127809   9920]]
Evaluating performance on  val set...
579/579 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024377
{'0': {'precision': 0.3839977461614312, 'recall': 0.05563492387444385, 'f1-score': 0.09718879797493626, 'support': 48998}, '1': {'precision': 0.35045758370814595, 'recall': 0.8611750709954716, 'f1-score': 0.49817959817959817, 'support': 52116}, '2': {'precision': 0.36191804167634983, 'recall': 0.09949316410409302, 'f1-score': 0.1560793091352498, 'support': 46958}, 'accuracy': 0.3530647252687882, 'macro avg': {'precision': 0.36545779051530897, 'recall': 0.33876771965800284, 'f1-score': 0.25048256842992805, 'support': 148072}, 'weighted avg': {'precision': 0.3651906937164999, 'recall': 0.3530647252687882, 'f1-score': 0.25699900629610545, 'support': 148072}}
[[ 2726 42840  3432]
 [ 2430 44881  4805]
 [ 1943 40343  4672]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
5183/5183 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0828716
{'0': {'precision': 0.3038968246627113, 'recall': 0.06286423424703966, 'f1-score': 0.10417813292020847, 'support': 365836}, '1': {'precision': 0.41879833738250827, 'recall': 0.8693850621624457, 'f1-score': 0.5652875494396788, 'support': 562317}, '2': {'precision': 0.3135830739322814, 'recall': 0.06594897751870515, 'f1-score': 0.10897884915881577, 'support': 398687}, 'accuracy': 0.40559600253233247, 'macro avg': {'precision': 0.34542607865916697, 'recall': 0.3327327579760635, 'f1-score': 0.25948151050623436, 'support': 1326840}, 'weighted avg': {'precision': 0.3555027873941598, 'recall': 0.40559600253233247, 'f1-score': 0.3010395833769332, 'support': 1326840}}
[[ 22998 324643  18195]
 [ 34088 488870  39359]
 [ 18591 353803  26293]]
Evaluating performance on  train set...
1489/1489 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1100011
{'0': {'precision': 0.3965014577259475, 'recall': 0.036648650313361356, 'f1-score': 0.06709564653562342, 'support': 129882}, '1': {'precision': 0.3298658268159041, 'recall': 0.895167439791574, 'f1-score': 0.482085108567322, 'support': 125896}, '2': {'precision': 0.36127526081564165, 'recall': 0.07904923816137091, 'f1-score': 0.12971585365055044, 'support': 125289}, 'accuracy': 0.3342246901463522, 'macro avg': {'precision': 0.3625475151191644, 'recall': 0.3369551094221021, 'f1-score': 0.2262988695844986, 'support': 381067}, 'weighted avg': {'precision': 0.36290470341831615, 'recall': 0.3342246901463522, 'f1-score': 0.22478743417707445, 'support': 381067}}
[[  4760 117155   7967]
 [  3655 112698   9543]
 [  3590 111795   9904]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028125
{'0': {'precision': 0.34627209838585704, 'recall': 0.04232530827950675, 'f1-score': 0.07543062851880533, 'support': 42575}, '1': {'precision': 0.355734569886104, 'recall': 0.8894719025050779, 'f1-score': 0.5082143591107458, 'support': 47264}, '2': {'precision': 0.3741728922091782, 'recall': 0.08170018409339827, 'f1-score': 0.13411625193657595, 'support': 42913}, 'accuracy': 0.35666505966011813, 'macro avg': {'precision': 0.35872652016037976, 'recall': 0.3378324649593276, 'f1-score': 0.23925374652204234, 'support': 132752}, 'weighted avg': {'precision': 0.35866016800686357, 'recall': 0.35666505966011813, 'f1-score': 0.2484861485894955, 'support': 132752}}
[[ 1802 38085  2688]
 [ 2048 42040  3176]
 [ 1354 38053  3506]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
7324/7324 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0834789
{'0': {'precision': 0.3392857142857143, 'recall': 0.025030950828348122, 'f1-score': 0.04662231977989675, 'support': 529065}, '1': {'precision': 0.4363425639794079, 'recall': 0.8990604378478484, 'f1-score': 0.5875355021460792, 'support': 824533}, '2': {'precision': 0.27048724847917643, 'recall': 0.07099104216400438, 'f1-score': 0.1124649630021463, 'support': 521108}, 'accuracy': 0.4222219377331699, 'macro avg': {'precision': 0.34870517558143294, 'recall': 0.3316941436134003, 'f1-score': 0.2488742616427074, 'support': 1874706}, 'weighted avg': {'precision': 0.3628494861672663, 'recall': 0.4222219377331699, 'f1-score': 0.3028288380927392, 'support': 1874706}}
[[ 13243 484958  30864]
 [ 14318 741305  68910]
 [ 11471 472643  36994]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126164
{'0': {'precision': 0.3810223266745006, 'recall': 0.022141166294896892, 'f1-score': 0.041850409791984865, 'support': 175736}, '1': {'precision': 0.3251419418107712, 'recall': 0.8939140504374679, 'f1-score': 0.4768426586134765, 'support': 170984}, '2': {'precision': 0.3647619266794007, 'recall': 0.08953183605223915, 'f1-score': 0.14377395287661293, 'support': 177032}, 'accuracy': 0.32951855076448394, 'macro avg': {'precision': 0.3569753983882242, 'recall': 0.3351956842615347, 'f1-score': 0.22082234042735807, 'support': 523752}, 'weighted avg': {'precision': 0.35728349062714915, 'recall': 0.32951855076448394, 'f1-score': 0.2183088163505313, 'support': 523752}}
[[  3891 159532  12313]
 [  2849 152845  15290]
 [  3472 157710  15850]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907187
{'0': {'precision': 0.37206001622060014, 'recall': 0.03231828669050177, 'f1-score': 0.05947075885984671, 'support': 56779}, '1': {'precision': 0.40078313607725374, 'recall': 0.8853983739837399, 'f1-score': 0.5517926268215074, 'support': 76875}, '2': {'precision': 0.2922848664688427, 'recall': 0.07748140732265446, 'f1-score': 0.12249166242722288, 'support': 55936}, 'accuracy': 0.39155018724616275, 'macro avg': {'precision': 0.3550426729222322, 'recall': 0.3317326893322987, 'f1-score': 0.24458501603619234, 'support': 189590}, 'weighted avg': {'precision': 0.36017008037201076, 'recall': 0.39155018724616275, 'f1-score': 0.2776910281857469, 'support': 189590}}
[[ 1835 51581  3363]
 [ 1679 68065  7131]
 [ 1418 50184  4334]]
testing model on single stock: results/universal/W6/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
29350/29350 - 245s - 245s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.090618
{'0': {'precision': 0.3163919594036427, 'recall': 0.08025955788434742, 'f1-score': 0.12803923682692858, 'support': 2204672}, '1': {'precision': 0.4131826207901547, 'recall': 0.8837667410192117, 'f1-score': 0.5631014887305443, 'support': 3099199}, '2': {'precision': 0.29720437778878, 'recall': 0.0437409171983401, 'f1-score': 0.07625852165130664, 'support': 2209533}, 'accuracy': 0.40095834058703617, 'macro avg': {'precision': 0.34225965266085917, 'recall': 0.3359224053672998, 'f1-score': 0.2557997490695932, 'support': 7513404}, 'weighted avg': {'precision': 0.3506744132967362, 'recall': 0.40095834058703617, 'f1-score': 0.2922701629282399, 'support': 7513404}}
[[ 176946 1943935   83791]
 [ 215481 2738969  144749]
 [ 166835 1946051   96647]]
Evaluating performance on  train set...
5452/5452 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1094089
{'0': {'precision': 0.3540354244830294, 'recall': 0.0857598782588479, 'f1-score': 0.13807348424912164, 'support': 473135}, '1': {'precision': 0.3212516994960546, 'recall': 0.8847525719422464, 'f1-score': 0.47135532452298295, 'support': 450535}, '2': {'precision': 0.30145296584781306, 'recall': 0.0255932005807484, 'f1-score': 0.0471807775939171, 'support': 471805}, 'accuracy': 0.32337591142800837, 'macro avg': {'precision': 0.325580029942299, 'recall': 0.33203521692728094, 'f1-score': 0.21886986212200724, 'support': 1395475}, 'weighted avg': {'precision': 0.3256731231638406, 'recall': 0.32337591142800837, 'f1-score': 0.21494444248508096, 'support': 1395475}}
[[ 40576 421650  10909]
 [ 34851 398612  17072]
 [ 39183 420547  12075]]
Evaluating performance on  val set...
1969/1969 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016346
{'0': {'precision': 0.3497677119628339, 'recall': 0.07360156417071458, 'f1-score': 0.12161227631811415, 'support': 163665}, '1': {'precision': 0.3576236871794532, 'recall': 0.8954866601063654, 'f1-score': 0.5111237679920104, 'support': 180886}, '2': {'precision': 0.30780294857964763, 'recall': 0.03219820452379758, 'f1-score': 0.05829805105619814, 'support': 159512}, 'accuracy': 0.355437713143, 'macro avg': {'precision': 0.33839811590731156, 'recall': 0.3337621429336259, 'f1-score': 0.2303446984554409, 'support': 504063}, 'weighted avg': {'precision': 0.3393070207322826, 'recall': 0.355437713143, 'f1-score': 0.24135484219370043, 'support': 504063}}
[[ 12046 147230   4389]
 [ 11744 161981   7161]
 [ 10650 143726   5136]]
training model: results/universal/W6/deepVOL_L2/h500
Epoch 1/50
9426/9426 - 298s - loss: 3.2390 - accuracy500: 0.3979 - val_loss: 3.3080 - val_accuracy500: 0.3452 - 298s/epoch - 32ms/step
Epoch 2/50
9426/9426 - 292s - loss: 3.2406 - accuracy500: 0.3931 - val_loss: 3.3025 - val_accuracy500: 0.3549 - 292s/epoch - 31ms/step
Epoch 3/50
9426/9426 - 295s - loss: 3.2381 - accuracy500: 0.3961 - val_loss: 3.2970 - val_accuracy500: 0.3453 - 295s/epoch - 31ms/step
Epoch 4/50
9426/9426 - 298s - loss: 3.2367 - accuracy500: 0.3981 - val_loss: 3.2898 - val_accuracy500: 0.3572 - 298s/epoch - 32ms/step
Epoch 5/50
9426/9426 - 292s - loss: 3.2343 - accuracy500: 0.3985 - val_loss: 3.2966 - val_accuracy500: 0.3726 - 292s/epoch - 31ms/step
Epoch 6/50
9426/9426 - 296s - loss: 3.2321 - accuracy500: 0.4004 - val_loss: 3.2923 - val_accuracy500: 0.3604 - 296s/epoch - 31ms/step
Epoch 7/50
9426/9426 - 291s - loss: 3.2312 - accuracy500: 0.4023 - val_loss: 3.2932 - val_accuracy500: 0.3672 - 291s/epoch - 31ms/step
Epoch 8/50
9426/9426 - 298s - loss: 3.2290 - accuracy500: 0.4034 - val_loss: 3.3002 - val_accuracy500: 0.3503 - 298s/epoch - 32ms/step
Epoch 9/50
9426/9426 - 296s - loss: 3.2305 - accuracy500: 0.4024 - val_loss: 3.3496 - val_accuracy500: 0.3623 - 296s/epoch - 31ms/step
Epoch 10/50
9426/9426 - 296s - loss: 3.2256 - accuracy500: 0.4057 - val_loss: 3.3481 - val_accuracy500: 0.3605 - 296s/epoch - 31ms/step
Epoch 11/50
9426/9426 - 298s - loss: 3.2230 - accuracy500: 0.4062 - val_loss: 3.2924 - val_accuracy500: 0.3643 - 298s/epoch - 32ms/step
Epoch 12/50
9426/9426 - 296s - loss: 3.2224 - accuracy500: 0.4074 - val_loss: 3.3109 - val_accuracy500: 0.3582 - 296s/epoch - 31ms/step
Epoch 13/50
9426/9426 - 300s - loss: 3.2257 - accuracy500: 0.4048 - val_loss: 3.3261 - val_accuracy500: 0.3580 - 300s/epoch - 32ms/step
Epoch 14/50
9426/9426 - 299s - loss: 3.2168 - accuracy500: 0.4099 - val_loss: 3.3359 - val_accuracy500: 0.3586 - 299s/epoch - 32ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 639s - 639s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970825
{'0': {'precision': 0.32393605038952233, 'recall': 0.26885945867268046, 'f1-score': 0.2938391732760388, 'support': 3284002}, '1': {'precision': 0.3949162898434119, 'recall': 0.5379941222653273, 'f1-score': 0.45548348472676603, 'support': 4167592}, '2': {'precision': 0.3107383389443737, 'recall': 0.2229204626622533, 'f1-score': 0.2596038295474059, 'support': 3367035}, 'accuracy': 0.35823910774646217, 'macro avg': {'precision': 0.34319689305910267, 'recall': 0.3432580145334203, 'f1-score': 0.33630882918340355, 'support': 10818629}, 'weighted avg': {'precision': 0.34717185242602794, 'recall': 0.35823910774646217, 'f1-score': 0.3454534710466918, 'support': 10818629}}
[[ 882935 1696302  704765]
 [ 965322 2242140  960130]
 [ 877389 1739065  750581]]
Evaluating performance on  train set...
9426/9426 - 151s - 151s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024271
{'0': {'precision': 0.35477330482707414, 'recall': 0.2734180368709517, 'f1-score': 0.30882762655671026, 'support': 810828}, '1': {'precision': 0.334155230704061, 'recall': 0.5251888662497833, 'f1-score': 0.408438499518375, 'support': 796066}, '2': {'precision': 0.3400157049410878, 'recall': 0.22636764952409336, 'f1-score': 0.2717896114777978, 'support': 805305}, 'accuracy': 0.340798997097669, 'macro avg': {'precision': 0.342981413490741, 'recall': 0.3416581842149428, 'f1-score': 0.329685245850961, 'support': 2412199}, 'weighted avg': {'precision': 0.3430422176443853, 'recall': 0.340798997097669, 'f1-score': 0.3293358559614886, 'support': 2412199}}
[[221695 416250 172883]
 [197022 418085 180959]
 [206175 416835 182295]]
Evaluating performance on  val set...
3323/3323 - 53s - 53s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960373
{'0': {'precision': 0.3307029039181053, 'recall': 0.26447693183975696, 'f1-score': 0.2939054185778606, 'support': 263350}, '1': {'precision': 0.38945098726959587, 'recall': 0.5319711553226906, 'f1-score': 0.4496889798122456, 'support': 325606}, '2': {'precision': 0.30879765245450863, 'recall': 0.23032007499665194, 'f1-score': 0.263847003541747, 'support': 261345}, 'accuracy': 0.3564102594257798, 'macro avg': {'precision': 0.3429838478807366, 'recall': 0.3422560540530331, 'f1-score': 0.33581380064395105, 'support': 850301}, 'weighted avg': {'precision': 0.3464666163963827, 'recall': 0.3564102594257798, 'f1-score': 0.3443210311217363, 'support': 850301}}
[[ 69650 135518  58182]
 [ 75841 173213  76552]
 [ 65121 136031  60193]]
testing model out of sample: results/universal/W6/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 275s - 275s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925319
{'0': {'precision': 0.3060358127911251, 'recall': 0.2247427719378569, 'f1-score': 0.25916394842512924, 'support': 1293016}, '1': {'precision': 0.41453425261090665, 'recall': 0.5515826081338979, 'f1-score': 0.47333794389984635, 'support': 1857535}, '2': {'precision': 0.29784020384550675, 'recall': 0.23743960701098163, 'f1-score': 0.26423212502631815, 'support': 1334592}, 'accuracy': 0.363882489365445, 'macro avg': {'precision': 0.3394700897491795, 'recall': 0.3379216623609122, 'f1-score': 0.33224467245043127, 'support': 4485143}, 'weighted avg': {'precision': 0.34853208443211564, 'recall': 0.363882489365445, 'f1-score': 0.3493728092419778, 'support': 4485143}}
[[ 290596  711863  290557]
 [ 376450 1024584  456501]
 [ 282503  735204  316885]]
Evaluating performance on  train set...
5153/5153 - 82s - 82s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102769
{'0': {'precision': 0.3628233721513102, 'recall': 0.22188112257818018, 'f1-score': 0.27536527540387057, 'support': 450178}, '1': {'precision': 0.32971044655127474, 'recall': 0.5604360171103544, 'f1-score': 0.4151712487960042, 'support': 431084}, '2': {'precision': 0.33530286832987727, 'recall': 0.2380982867386299, 'f1-score': 0.27846138007292254, 'support': 437353}, 'accuracy': 0.33794094561338983, 'macro avg': {'precision': 0.3426122290108207, 'recall': 0.3401384754757215, 'f1-score': 0.32299930142426575, 'support': 1318615}, 'weighted avg': {'precision': 0.34287014294704604, 'recall': 0.33794094561338983, 'f1-score': 0.3220978007422737, 'support': 1318615}}
[[ 99886 248206 102086]
 [ 85144 241595 104345]
 [ 90272 242948 104133]]
Evaluating performance on  val set...
1795/1795 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982491
{'0': {'precision': 0.3305164125948266, 'recall': 0.2223915226650968, 'f1-score': 0.2658816905140434, 'support': 144385}, '1': {'precision': 0.37263257575757575, 'recall': 0.5613641052848763, 'f1-score': 0.4479299696368892, 'support': 169635}, '2': {'precision': 0.3166806354707173, 'recall': 0.23212214920757634, 'f1-score': 0.26788708720191506, 'support': 144872}, 'accuracy': 0.35076880834706203, 'macro avg': {'precision': 0.3399432079410399, 'recall': 0.3386259257191832, 'f1-score': 0.32723291578428254, 'support': 458892}, 'weighted avg': {'precision': 0.3417172150376432, 'recall': 0.35076880834706203, 'f1-score': 0.33381115029536296, 'support': 458892}}
[[32110 80066 32209]
 [34056 95227 40352]
 [30985 80259 33628]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058264
{'0': {'precision': 0.32035366722050795, 'recall': 0.3102857668344943, 'f1-score': 0.31523935207352816, 'support': 86994}, '1': {'precision': 0.3041632967456191, 'recall': 0.48703717407928165, 'f1-score': 0.37446598673323755, 'support': 81078}, '2': {'precision': 0.3735565617212453, 'recall': 0.20667022671003446, 'f1-score': 0.2661132537802309, 'support': 102995}, 'accuracy': 0.3237834188595439, 'macro avg': {'precision': 0.3326911752291241, 'recall': 0.33466438920793684, 'f1-score': 0.3186061975289989, 'support': 271067}, 'weighted avg': {'precision': 0.3357260632028312, 'recall': 0.3237834188595439, 'f1-score': 0.3142884233039685, 'support': 271067}}
[[26993 42004 17997]
 [23891 39488 17699]
 [33376 48333 21286]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022507
{'0': {'precision': 0.34091246842027045, 'recall': 0.2520740618647327, 'f1-score': 0.2898385925013424, 'support': 18201}, '1': {'precision': 0.3426952364087126, 'recall': 0.5380338078291815, 'f1-score': 0.4187022653021485, 'support': 17984}, '2': {'precision': 0.3250448393934453, 'recall': 0.22431641723866322, 'f1-score': 0.26544607190412783, 'support': 17774}, 'accuracy': 0.33823829203654626, 'macro avg': {'precision': 0.33621751474080946, 'recall': 0.3381414289775258, 'f1-score': 0.3246623099025396, 'support': 53959}, 'weighted avg': {'precision': 0.33627987814212135, 'recall': 0.33823829203654626, 'f1-score': 0.32475272416714057, 'support': 53959}}
[[4588 9399 4214]
 [4243 9676 4065]
 [4627 9160 3987]]
Evaluating performance on  val set...
81/81 - 1s - 718ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028095
{'0': {'precision': 0.3379571248423707, 'recall': 0.2725159790819291, 'f1-score': 0.30172899075190984, 'support': 6884}, '1': {'precision': 0.32522368553332665, 'recall': 0.48500749625187406, 'f1-score': 0.38936029367515196, 'support': 6670}, '2': {'precision': 0.3502626970227671, 'recall': 0.25412960609911056, 'f1-score': 0.29455081001472755, 'support': 7083}, 'accuracy': 0.33488394631002566, 'macro avg': {'precision': 0.3378145024661548, 'recall': 0.3372176938109712, 'f1-score': 0.3285466981472631, 'support': 20637}, 'weighted avg': {'precision': 0.3380651021434525, 'recall': 0.33488394631002566, 'f1-score': 0.32758825984802664, 'support': 20637}}
[[1876 3321 1687]
 [1783 3235 1652]
 [1892 3391 1800]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.104681
{'0': {'precision': 0.3856099709147515, 'recall': 0.3821541303399068, 'f1-score': 0.38387427295573756, 'support': 197054}, '1': {'precision': 0.26452425672270835, 'recall': 0.37511287231623736, 'f1-score': 0.31025858015984953, 'support': 153935}, '2': {'precision': 0.39282402796760924, 'recall': 0.27472548586360274, 'f1-score': 0.32332814182705216, 'support': 208186}, 'accuracy': 0.3402190727410918, 'macro avg': {'precision': 0.34765275186835637, 'recall': 0.343997496173249, 'f1-score': 0.33915366498087973, 'support': 559175}, 'weighted avg': {'precision': 0.3549622063820991, 'recall': 0.3402190727410918, 'f1-score': 0.34106676452690665, 'support': 559175}}
[[75305 75085 46664]
 [54453 57743 41739]
 [65530 85462 57194]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988612
{'0': {'precision': 0.4160882676750754, 'recall': 0.3642897554638225, 'f1-score': 0.38846991788168256, 'support': 47723}, '1': {'precision': 0.3099207756887785, 'recall': 0.3613095921883975, 'f1-score': 0.333648042262934, 'support': 43525}, '2': {'precision': 0.3575542857142857, 'recall': 0.34742148980588994, 'f1-score': 0.3524150671352618, 'support': 45026}, 'accuracy': 0.3577645038672087, 'macro avg': {'precision': 0.3611877763593799, 'recall': 0.3576736124860367, 'f1-score': 0.35817767575995946, 'support': 136274}, 'weighted avg': {'precision': 0.3628389966441371, 'recall': 0.3577645038672087, 'f1-score': 0.3590473732582447, 'support': 136274}}
[[17385 17099 13239]
 [12931 15726 14868]
 [11466 17917 15643]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108657
{'0': {'precision': 0.38123667377398723, 'recall': 0.32477597481230325, 'f1-score': 0.35074870855947166, 'support': 16516}, '1': {'precision': 0.3399592252803262, 'recall': 0.33953619909502264, 'f1-score': 0.3397475805082348, 'support': 17680}, '2': {'precision': 0.26775525069806966, 'recall': 0.3149364558046551, 'f1-score': 0.2894356955380577, 'support': 14006}, 'accuracy': 0.3273308161487075, 'macro avg': {'precision': 0.3296503832507944, 'recall': 0.32641620990399367, 'f1-score': 0.32664399486858803, 'support': 48202}, 'weighted avg': {'precision': 0.33312236106975857, 'recall': 0.3273308161487075, 'f1-score': 0.3288979553889851, 'support': 48202}}
[[5364 6107 5045]
 [4659 6003 7018]
 [4047 5548 4411]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102679
{'0': {'precision': 0.39949587534372133, 'recall': 0.3005058992855358, 'f1-score': 0.34300160837337873, 'support': 116031}, '1': {'precision': 0.263973478810357, 'recall': 0.49335897161984116, 'f1-score': 0.3439273834544161, 'support': 84249}, '2': {'precision': 0.360668910518815, 'recall': 0.21544689676408524, 'f1-score': 0.26975478384124735, 'support': 110417}, 'accuracy': 0.3225715085758794, 'macro avg': {'precision': 0.3413794215576311, 'recall': 0.3364372558898207, 'f1-score': 0.31889459188968067, 'support': 310697}, 'weighted avg': {'precision': 0.3489489329509364, 'recall': 0.3225715085758794, 'f1-score': 0.31722183258036485, 'support': 310697}}
[[34868 58093 23070]
 [23585 41565 19099]
 [28827 57801 23789]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038193
{'0': {'precision': 0.3754743359296984, 'recall': 0.2798630457435723, 'f1-score': 0.3206940247587484, 'support': 47023}, '1': {'precision': 0.3113805970149254, 'recall': 0.5375334456446338, 'f1-score': 0.39433317582058086, 'support': 40364}, '2': {'precision': 0.3444016621554649, 'recall': 0.2073302274344204, 'f1-score': 0.2588390350123202, 'support': 43573}, 'accuracy': 0.335148136835675, 'macro avg': {'precision': 0.34375219836669624, 'recall': 0.34157557294087554, 'f1-score': 0.3246220785305498, 'support': 130960}, 'weighted avg': {'precision': 0.34538110676109296, 'recall': 0.335148136835675, 'f1-score': 0.32281042079752886, 'support': 130960}}
[[13160 24963  8900]
 [10370 21697  8297]
 [11519 23020  9034]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032182
{'0': {'precision': 0.34273446708200034, 'recall': 0.28282617757398915, 'f1-score': 0.30991169305724725, 'support': 14394}, '1': {'precision': 0.3258090718652473, 'recall': 0.5591752879888473, 'f1-score': 0.4117233927606699, 'support': 13629}, '2': {'precision': 0.34475755267834474, 'recall': 0.17958212113197566, 'f1-score': 0.23615337796713326, 'support': 15124}, 'accuracy': 0.33392819894778314, 'macro avg': {'precision': 0.3377670305418641, 'recall': 0.3405278622316041, 'f1-score': 0.3192628212616835, 'support': 43147}, 'weighted avg': {'precision': 0.3380973181527582, 'recall': 0.33392819894778314, 'f1-score': 0.31621736663443833, 'support': 43147}}
[[4071 7724 2599]
 [3445 7621 2563]
 [4362 8046 2716]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1095/1095 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994172
{'0': {'precision': 0.3551857744501638, 'recall': 0.9518836217707549, 'f1-score': 0.5173336968375136, 'support': 99675}, '1': {'precision': 0.2627986348122867, 'recall': 0.04002772483105181, 'f1-score': 0.06947368421052631, 'support': 69252}, '2': {'precision': 0.3716887417218543, 'recall': 0.00807830013853655, 'f1-score': 0.01581292151649087, 'support': 111162}, 'accuracy': 0.3518488766070785, 'macro avg': {'precision': 0.32989105032810156, 'recall': 0.33332988224678106, 'f1-score': 0.20087343418817694, 'support': 280089}, 'weighted avg': {'precision': 0.3388927699182236, 'recall': 0.3518488766070785, 'f1-score': 0.20755625459351382, 'support': 280089}}
[[ 94879   3912    884]
 [ 65846   2772    634]
 [106400   3864    898]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1126887
{'0': {'precision': 0.31798658589756673, 'recall': 0.9418844283241282, 'f1-score': 0.4754559955614121, 'support': 36393}, '1': {'precision': 0.33744935365618367, 'recall': 0.046298012017894484, 'f1-score': 0.0814245810055866, 'support': 37777}, '2': {'precision': 0.3465909090909091, 'recall': 0.013591127395157696, 'f1-score': 0.026156558197150886, 'support': 40394}, 'accuracy': 0.3192625955797633, 'macro avg': {'precision': 0.33400894954821986, 'recall': 0.33392452257906013, 'f1-score': 0.1943457115880499, 'support': 114564}, 'weighted avg': {'precision': 0.3344899203541949, 'recall': 0.3192625955797633, 'f1-score': 0.1871077690629712, 'support': 114564}}
[[34278  1626   489]
 [35482  1749   546]
 [38037  1808   549]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1074841
{'0': {'precision': 0.33099600621932257, 'recall': 0.9415488682681468, 'f1-score': 0.48980420463773344, 'support': 11531}, '1': {'precision': 0.30434782608695654, 'recall': 0.04602051997210878, 'f1-score': 0.07995154451847365, 'support': 10039}, '2': {'precision': 0.3722466960352423, 'recall': 0.012800121184579263, 'f1-score': 0.024749212857875083, 'support': 13203}, 'accuracy': 0.3303712650619734, 'macro avg': {'precision': 0.3358635094471738, 'recall': 0.3334565031416116, 'f1-score': 0.19816832067136073, 'support': 34773}, 'weighted avg': {'precision': 0.33896517129828513, 'recall': 0.3303712650619734, 'f1-score': 0.1949020704702265, 'support': 34773}}
[[10857   548   126]
 [ 9418   462   159]
 [12526   508   169]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
1722/1722 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030447
{'0': {'precision': 0.3417032718366478, 'recall': 0.43016669906361643, 'f1-score': 0.38086562257051804, 'support': 149191}, '1': {'precision': 0.3113998903413254, 'recall': 0.4696472042969203, 'f1-score': 0.37449236779994205, 'support': 129395}, '2': {'precision': 0.3564055124237027, 'recall': 0.12706749767281292, 'f1-score': 0.18734264653754215, 'support': 162213}, 'accuracy': 0.33021626637084023, 'macro avg': {'precision': 0.33650289153389196, 'recall': 0.34229380034444995, 'f1-score': 0.31423354563600076, 'support': 440799}, 'weighted avg': {'precision': 0.3382182106268009, 'recall': 0.33021626637084023, 'f1-score': 0.3077787738882938, 'support': 440799}}
[[64177 65680 19334]
 [50738 60770 17887]
 [72900 68701 20612]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010722
{'0': {'precision': 0.35561765861752764, 'recall': 0.3005887020872165, 'f1-score': 0.32579583754212965, 'support': 54187}, '1': {'precision': 0.33806669520955235, 'recall': 0.5538863233374253, 'f1-score': 0.4198663269450907, 'support': 51321}, '2': {'precision': 0.3240816617379841, 'recall': 0.17343884069024693, 'f1-score': 0.22595389507154212, 'support': 52445}, 'accuracy': 0.3406709590827651, 'macro avg': {'precision': 0.33925533852168804, 'recall': 0.3426379553716296, 'f1-score': 0.3238720198529208, 'support': 157953}, 'weighted avg': {'precision': 0.3394442503922432, 'recall': 0.3406709590827651, 'f1-score': 0.32321013745273214, 'support': 157953}}
[[16288 28305  9594]
 [13518 28426  9377]
 [15996 27353  9096]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10332
{'0': {'precision': 0.34130824372759855, 'recall': 0.39373578664461445, 'f1-score': 0.36565229912642794, 'support': 19348}, '1': {'precision': 0.3269327164064006, 'recall': 0.4675231583590648, 'f1-score': 0.3847881827051802, 'support': 18136}, '2': {'precision': 0.3468610597323469, 'recall': 0.15970343652940588, 'f1-score': 0.21870819469694372, 'support': 19962}, 'accuracy': 0.3357065766110782, 'macro avg': {'precision': 0.3383673399554487, 'recall': 0.3403207938443617, 'f1-score': 0.32304955884285064, 'support': 57446}, 'weighted avg': {'precision': 0.33869937191040567, 'recall': 0.3357065766110782, 'f1-score': 0.32063176109006136, 'support': 57446}}
[[7618 8647 3083]
 [6737 8479 2920]
 [7965 8809 3188]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
4450/4450 - 39s - 39s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0762261
{'0': {'precision': 0.2528333046619646, 'recall': 0.13255480877806278, 'f1-score': 0.1739247744464115, 'support': 277191}, '1': {'precision': 0.507541407936318, 'recall': 0.5872079010927589, 'f1-score': 0.5444759314555241, 'support': 585033}, '2': {'precision': 0.2648919487715069, 'recall': 0.30319216170633845, 'f1-score': 0.28275095566071096, 'support': 276897}, 'accuracy': 0.40753528378460235, 'macro avg': {'precision': 0.3417555537899298, 'recall': 0.3409849571923867, 'f1-score': 0.3337172205208822, 'support': 1139121}, 'weighted avg': {'precision': 0.38657822566763894, 'recall': 0.40753528378460235, 'f1-score': 0.3906869078266302, 'support': 1139121}}
[[ 36743 168395  72053]
 [ 80570 343536 160927]
 [ 28012 164932  83953]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045574
{'0': {'precision': 0.4011974794314066, 'recall': 0.14954583762524581, 'f1-score': 0.2178779524202029, 'support': 128148}, '1': {'precision': 0.3285047039659586, 'recall': 0.6195842999561101, 'f1-score': 0.4293612861177493, 'support': 127592}, '2': {'precision': 0.36308659391726483, 'recall': 0.27117501685014606, 'f1-score': 0.310471299388424, 'support': 129079}, 'accuracy': 0.3461913263118505, 'macro avg': {'precision': 0.36426292577154334, 'recall': 0.3467683848105007, 'f1-score': 0.3192368459754587, 'support': 384819}, 'weighted avg': {'precision': 0.36431174458342, 'recall': 0.3461913263118505, 'f1-score': 0.31905652766323495, 'support': 384819}}
[[19164 80080 28904]
 [16041 79054 32497]
 [12562 81514 35003]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0769728
{'0': {'precision': 0.2779688339602364, 'recall': 0.16159060381719925, 'f1-score': 0.20437350611382177, 'support': 32013}, '1': {'precision': 0.4758138513033252, 'recall': 0.5910360548367419, 'f1-score': 0.5272028237383031, 'support': 62294}, '2': {'precision': 0.3062974335206535, 'recall': 0.2920671748978014, 'f1-score': 0.2990130927805899, 'support': 36204}, 'accuracy': 0.40276298549547546, 'macro avg': {'precision': 0.35336003959473833, 'recall': 0.3482312778505809, 'f1-score': 0.3435298075442383, 'support': 130511}, 'weighted avg': {'precision': 0.3802603352808585, 'recall': 0.40276298549547546, 'f1-score': 0.3847158612239896, 'support': 130511}}
[[ 5173 18863  7977]
 [ 9505 36818 15971]
 [ 3932 21698 10574]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
6203/6203 - 53s - 53s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0744638
{'0': {'precision': 0.2437732688761418, 'recall': 0.2697379754429944, 'f1-score': 0.25609919448192625, 'support': 336686}, '1': {'precision': 0.5580054756163592, 'recall': 0.5382710230607302, 'f1-score': 0.5479606259843359, 'support': 882626}, '2': {'precision': 0.24186075907627036, 'recall': 0.2388119230957071, 'f1-score': 0.24032667192734797, 'support': 368562}, 'accuracy': 0.4118248677162042, 'macro avg': {'precision': 0.34787983452292376, 'recall': 0.34894030719981056, 'f1-score': 0.34812883079787005, 'support': 1587874}, 'weighted avg': {'precision': 0.41799656195193424, 'recall': 0.4118248677162042, 'f1-score': 0.4146705517706566, 'support': 1587874}}
[[ 90817 176701  69168]
 [200803 475092 206731]
 [ 80927 199618  88017]]
Evaluating performance on  train set...
1766/1766 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027058
{'0': {'precision': 0.3682222153407859, 'recall': 0.3044739048887125, 'f1-score': 0.33332749335118034, 'support': 156217}, '1': {'precision': 0.33112750226686194, 'recall': 0.515735227218718, 'f1-score': 0.40331003284015576, 'support': 147281}, '2': {'precision': 0.34159290140965676, 'recall': 0.2149192217814981, 'f1-score': 0.2638392857142857, 'support': 148493}, 'accuracy': 0.34389180315537254, 'macro avg': {'precision': 0.3469808730057682, 'recall': 0.3450427846296429, 'f1-score': 0.33349227063520726, 'support': 451991}, 'weighted avg': {'precision': 0.3473863731452206, 'recall': 0.34389180315537254, 'f1-score': 0.3333022405958166, 'support': 451991}}
[[47564 77866 30787]
 [40597 75958 30726]
 [41011 75568 31914]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933663
{'0': {'precision': 0.31690499067427796, 'recall': 0.25478835798514077, 'f1-score': 0.282472071436668, 'support': 44013}, '1': {'precision': 0.41782924792454684, 'recall': 0.5569870997315173, 'f1-score': 0.477475581003705, 'support': 61084}, '2': {'precision': 0.31025657431697484, 'recall': 0.22566608493310064, 'f1-score': 0.261285412148236, 'support': 42975}, 'accuracy': 0.3710019449997299, 'macro avg': {'precision': 0.3483302709719332, 'recall': 0.34581384754991956, 'f1-score': 0.34041102152953634, 'support': 148072}, 'weighted avg': {'precision': 0.3566096048951997, 'recall': 0.3710019449997299, 'f1-score': 0.35676766881816163, 'support': 148072}}
[[11214 23806  8993]
 [14494 34023 12567]
 [ 9678 23599  9698]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
5183/5183 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012454
{'0': {'precision': 0.3312694270967006, 'recall': 0.22235541263506464, 'f1-score': 0.26609915187749467, 'support': 417948}, '1': {'precision': 0.33690885231724554, 'recall': 0.551038677940459, 'f1-score': 0.4181549072239711, 'support': 446818}, '2': {'precision': 0.35621757141815713, 'recall': 0.24322294697386132, 'f1-score': 0.28907050766807063, 'support': 462074}, 'accuracy': 0.34030779898103763, 'macro avg': {'precision': 0.34146528361070105, 'recall': 0.33887234584979503, 'f1-score': 0.3244415222565121, 'support': 1326840}, 'weighted avg': {'precision': 0.34185675151968015, 'recall': 0.34030779898103763, 'f1-score': 0.32530426684838526, 'support': 1326840}}
[[ 92933 228615  96400]
 [ 93890 246214 106714]
 [ 93713 255974 112387]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010587
{'0': {'precision': 0.36574536574536576, 'recall': 0.17786088834053054, 'f1-score': 0.23933424300752815, 'support': 129680}, '1': {'precision': 0.33920762440603386, 'recall': 0.587489849459679, 'f1-score': 0.43008865744842606, 'support': 128072}, '2': {'precision': 0.33223827840731884, 'recall': 0.2591574423225074, 'f1-score': 0.2911824332019772, 'support': 123315}, 'accuracy': 0.3418401488452162, 'macro avg': {'precision': 0.3457304228529061, 'recall': 0.3415027267075723, 'f1-score': 0.32020177788597715, 'support': 381067}, 'weighted avg': {'precision': 0.34598330793426646, 'recall': 0.3418401488452162, 'f1-score': 0.3202227978813512, 'support': 381067}}
[[23065 74892 31723]
 [20322 75241 32509]
 [19676 71681 31958]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958294
{'0': {'precision': 0.35633920407108494, 'recall': 0.21077509171291506, 'f1-score': 0.2648758071427516, 'support': 42524}, '1': {'precision': 0.36696072475634556, 'recall': 0.5790405934817038, 'f1-score': 0.4492280333036941, 'support': 47988}, '2': {'precision': 0.3272578975436835, 'recall': 0.24696969696969698, 'f1-score': 0.28150087024569265, 'support': 42240}, 'accuracy': 0.3554146076895263, 'macro avg': {'precision': 0.35018594212370463, 'recall': 0.34559512738810527, 'f1-score': 0.3318682368973795, 'support': 132752}, 'weighted avg': {'precision': 0.3509254336339303, 'recall': 0.3554146076895263, 'f1-score': 0.33680645447371116, 'support': 132752}}
[[ 8963 23788  9773]
 [ 8529 27787 11672]
 [ 7661 24147 10432]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
7324/7324 - 69s - 69s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004286
{'0': {'precision': 0.3398599010632014, 'recall': 0.12191242050341491, 'f1-score': 0.17945269231425237, 'support': 604114}, '1': {'precision': 0.35844153332331113, 'recall': 0.5994219236768712, 'f1-score': 0.4486186665962466, 'support': 680187}, '2': {'precision': 0.31594255799433263, 'recall': 0.2785477765262828, 'f1-score': 0.2960690592566589, 'support': 590405}, 'accuracy': 0.34449348324483947, 'macro avg': {'precision': 0.3380813307936151, 'recall': 0.33329404023552295, 'f1-score': 0.30804680605571927, 'support': 1874706}, 'weighted avg': {'precision': 0.33906941219056314, 'recall': 0.34449348324483947, 'f1-score': 0.31383860811842557, 'support': 1874706}}
[[ 73649 369671 160794]
 [ 77193 407719 195275]
 [ 65862 360087 164456]]
Evaluating performance on  train set...
2046/2046 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103436
{'0': {'precision': 0.3458417456126728, 'recall': 0.10206244629046118, 'f1-score': 0.15761162866824144, 'support': 174550}, '1': {'precision': 0.32740352806329265, 'recall': 0.6052924759093572, 'f1-score': 0.42495066190655695, 'support': 174134}, '2': {'precision': 0.33084952796609607, 'recall': 0.2840553384970412, 'f1-score': 0.30567191701882446, 'support': 175068}, 'accuracy': 0.33020589897508745, 'macro avg': {'precision': 0.33469826721402046, 'recall': 0.3304700868989532, 'f1-score': 0.29607806919787427, 'support': 523752}, 'weighted avg': {'precision': 0.33470025472825676, 'recall': 0.33020589897508745, 'f1-score': 0.29598519817228286, 'support': 523752}}
[[ 17815 108411  48324]
 [ 16478 105402  52254]
 [ 17219 108120  49729]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991434
{'0': {'precision': 0.329128803291288, 'recall': 0.12184916145013892, 'f1-score': 0.1778537836682343, 'support': 59746}, '1': {'precision': 0.3650451515335877, 'recall': 0.5990216213132523, 'f1-score': 0.4536406495547407, 'support': 70116}, '2': {'precision': 0.3068836570381959, 'recall': 0.2693041789445486, 'f1-score': 0.28686843466319484, 'support': 59728}, 'accuracy': 0.34477556833166306, 'macro avg': {'precision': 0.3336858706210239, 'recall': 0.3300583205693133, 'f1-score': 0.30612095596205663, 'support': 189590}, 'weighted avg': {'precision': 0.33540367315759106, 'recall': 0.34477556833166306, 'f1-score': 0.3141916652185549, 'support': 189590}}
[[ 7280 36646 15820]
 [ 7606 42001 20509]
 [ 7233 36410 16085]]
testing model on single stock: results/universal/W6/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
29350/29350 - 223s - 223s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988452
{'0': {'precision': 0.3172429598491888, 'recall': 0.25424996967891056, 'f1-score': 0.2822747535620674, 'support': 2292134}, '1': {'precision': 0.3939391615054906, 'recall': 0.5466425686871385, 'f1-score': 0.4578951689986938, 'support': 2912554}, '2': {'precision': 0.3034690601962746, 'recall': 0.21489304011407206, 'f1-score': 0.25161325987024946, 'support': 2308716}, 'accuracy': 0.3555017140033998, 'macro avg': {'precision': 0.3382170605169847, 'recall': 0.338595192826707, 'f1-score': 0.3305943941436702, 'support': 7513404}, 'weighted avg': {'precision': 0.34274162948119463, 'recall': 0.3555017140033998, 'f1-score': 0.34093195639468615, 'support': 7513404}}
[[ 582775 1220876  488483]
 [ 670186 1592126  650242]
 [ 584038 1228551  496127]]
Evaluating performance on  train set...
5452/5452 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018375
{'0': {'precision': 0.3504028500959167, 'recall': 0.2726943124525469, 'f1-score': 0.3067029350527235, 'support': 468884}, '1': {'precision': 0.3352615745635876, 'recall': 0.5352537573513396, 'f1-score': 0.412284565019525, 'support': 459100}, '2': {'precision': 0.33355398004099324, 'recall': 0.21234419486150535, 'f1-score': 0.2594925375865409, 'support': 467491}, 'accuracy': 0.33885666171017037, 'macro avg': {'precision': 0.33973946823349915, 'recall': 0.3400974215551306, 'f1-score': 0.3261600125529298, 'support': 1395475}, 'weighted avg': {'precision': 0.3397770383058535, 'recall': 0.33885666171017037, 'f1-score': 0.3256227225056663, 'support': 1395475}}
[[127862 243483  97539]
 [112563 245735 100802]
 [124475 243747  99269]]
Evaluating performance on  val set...
1969/1969 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990748
{'0': {'precision': 0.327393151712072, 'recall': 0.2444360125897267, 'f1-score': 0.2798971495320446, 'support': 160766}, '1': {'precision': 0.37616933129125024, 'recall': 0.5459342768049892, 'f1-score': 0.44542441875636035, 'support': 187605}, '2': {'precision': 0.3112954313630751, 'recall': 0.22346042185854123, 'f1-score': 0.2601643647131843, 'support': 155692}, 'accuracy': 0.3501705143999857, 'macro avg': {'precision': 0.3382859714554658, 'recall': 0.3379435704177524, 'f1-score': 0.32849531100052975, 'support': 504063}, 'weighted avg': {'precision': 0.3405747756229239, 'recall': 0.3501705143999857, 'f1-score': 0.3354090728606955, 'support': 504063}}
[[ 39297  86121  35348]
 [ 43562 102420  41623]
 [ 37171  83730  34791]]
training model: results/universal/W6/deepVOL_L2/h1000
Epoch 1/50
9426/9426 - 317s - loss: 3.2380 - accuracy1000: 0.3919 - val_loss: 3.2942 - val_accuracy1000: 0.3620 - 317s/epoch - 34ms/step
Epoch 2/50
9426/9426 - 302s - loss: 3.2382 - accuracy1000: 0.3947 - val_loss: 3.2982 - val_accuracy1000: 0.3646 - 302s/epoch - 32ms/step
Epoch 3/50
9426/9426 - 300s - loss: 3.2365 - accuracy1000: 0.3950 - val_loss: 3.3295 - val_accuracy1000: 0.3641 - 300s/epoch - 32ms/step
Epoch 4/50
9426/9426 - 294s - loss: 3.2352 - accuracy1000: 0.3950 - val_loss: 3.3038 - val_accuracy1000: 0.3618 - 294s/epoch - 31ms/step
Epoch 5/50
9426/9426 - 297s - loss: 3.2349 - accuracy1000: 0.3952 - val_loss: 3.3301 - val_accuracy1000: 0.3641 - 297s/epoch - 31ms/step
Epoch 6/50
9426/9426 - 302s - loss: 3.2334 - accuracy1000: 0.3954 - val_loss: 3.3258 - val_accuracy1000: 0.3642 - 302s/epoch - 32ms/step
Epoch 7/50
9426/9426 - 300s - loss: 3.2289 - accuracy1000: 0.3974 - val_loss: 3.3070 - val_accuracy1000: 0.3640 - 300s/epoch - 32ms/step
Epoch 8/50
9426/9426 - 299s - loss: 3.2293 - accuracy1000: 0.3980 - val_loss: 3.3200 - val_accuracy1000: 0.3641 - 299s/epoch - 32ms/step
Epoch 9/50
9426/9426 - 299s - loss: 3.2251 - accuracy1000: 0.4008 - val_loss: 3.3241 - val_accuracy1000: 0.3641 - 299s/epoch - 32ms/step
Epoch 10/50
9426/9426 - 299s - loss: 3.2260 - accuracy1000: 0.3989 - val_loss: 3.2977 - val_accuracy1000: 0.3623 - 299s/epoch - 32ms/step
Epoch 11/50
9426/9426 - 299s - loss: 3.2289 - accuracy1000: 0.3970 - val_loss: 3.2947 - val_accuracy1000: 0.3633 - 299s/epoch - 32ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 655s - 655s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0945237
{'0': {'precision': 0.3066035582205853, 'recall': 0.006153592395520884, 'f1-score': 0.012065037173980938, 'support': 3273860}, '1': {'precision': 0.38373094988679757, 'recall': 0.9413696253321043, 'f1-score': 0.5452154610431632, 'support': 4149675}, '2': {'precision': 0.31159478470319235, 'recall': 0.05258234381728459, 'f1-score': 0.0899803025384927, 'support': 3395094}, 'accuracy': 0.3794423489334924, 'macro avg': {'precision': 0.3339764309368584, 'recall': 0.33336852051496996, 'f1-score': 0.21575360025187895, 'support': 10818629}, 'weighted avg': {'precision': 0.3377534656715414, 'recall': 0.3794423489334924, 'f1-score': 0.24101554791954866, 'support': 10818629}}
[[  20146 3078081  175633]
 [  24522 3906378  218775]
 [  21039 3195533  178522]]
Evaluating performance on  train set...
9426/9426 - 152s - 152s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1092511
{'0': {'precision': 0.32418648085626034, 'recall': 0.0055808650402643396, 'f1-score': 0.010972832938436159, 'support': 808656}, '1': {'precision': 0.327914542929145, 'recall': 0.9455000730916772, 'f1-score': 0.486947802242378, 'support': 793524}, '2': {'precision': 0.3356401697928382, 'recall': 0.045684113582520905, 'f1-score': 0.08042196266099878, 'support': 810019}, 'accuracy': 0.3282461355800247, 'macro avg': {'precision': 0.3292470645260812, 'recall': 0.33225501723815415, 'f1-score': 0.19278086594727098, 'support': 2412199}, 'weighted avg': {'precision': 0.3292590359759008, 'recall': 0.3282461355800247, 'f1-score': 0.19087203534697772, 'support': 2412199}}
[[  4513 769481  34662]
 [  4662 750277  38585]
 [  4746 768268  37005]]
Evaluating performance on  val set...
3323/3323 - 52s - 52s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985341
{'0': {'precision': 0.31552330694810904, 'recall': 0.005311962094430769, 'f1-score': 0.010448027434262978, 'support': 270145}, '1': {'precision': 0.36402273135725044, 'recall': 0.9487259829700361, 'f1-score': 0.5261598352542622, 'support': 309572}, '2': {'precision': 0.3198417997842724, 'recall': 0.04602637258670136, 'f1-score': 0.08047247045444265, 'support': 270584}, 'accuracy': 0.3617401367280528, 'macro avg': {'precision': 0.33312927936321063, 'recall': 0.33335477255038937, 'f1-score': 0.20569344438098927, 'support': 850301}, 'weighted avg': {'precision': 0.3345548956193762, 'recall': 0.3617401367280528, 'f1-score': 0.22048827160735593, 'support': 850301}}
[[  1435 256469  12241]
 [  1630 293699  14243]
 [  1483 256647  12454]]
testing model out of sample: results/universal/W6/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 280s - 280s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0929374
{'0': {'precision': 0.31405951405951404, 'recall': 0.004181217088907563, 'f1-score': 0.008252564040944311, 'support': 1375676}, '1': {'precision': 0.3714664612007352, 'recall': 0.9488851189343024, 'f1-score': 0.5339168786854703, 'support': 1659908}, '2': {'precision': 0.345888341442113, 'recall': 0.05409645278322579, 'f1-score': 0.09356021829444934, 'support': 1449559}, 'accuracy': 0.3699391524417393, 'macro avg': {'precision': 0.3438047722341207, 'recall': 0.3357209296021452, 'f1-score': 0.21190988700695468, 'support': 4485143}, 'weighted avg': {'precision': 0.3455920680956246, 'recall': 0.3699391524417393, 'f1-score': 0.23036652544307182, 'support': 4485143}}
[[   5752 1300436   69488]
 [   6041 1575062   78805]
 [   6522 1364621   78416]]
Evaluating performance on  train set...
5153/5153 - 85s - 85s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046573
{'0': {'precision': 0.3479978452145807, 'recall': 0.004330077954809001, 'f1-score': 0.008553723385473678, 'support': 447567}, '1': {'precision': 0.33331512948557535, 'recall': 0.9474078284471168, 'f1-score': 0.4931361010725232, 'support': 438069}, '2': {'precision': 0.33827775159085555, 'recall': 0.05303952385681523, 'f1-score': 0.09170099048250334, 'support': 432979}, 'accuracy': 0.33363263727471626, 'macro avg': {'precision': 0.3398635754303372, 'recall': 0.33492581008624706, 'f1-score': 0.1977969383135001, 'support': 1318615}, 'weighted avg': {'precision': 0.33992828813097664, 'recall': 0.33363263727471626, 'f1-score': 0.1968433592317161, 'support': 1318615}}
[[  1938 422075  23554]
 [  1670 415030  21369]
 [  1961 408053  22965]]
Evaluating performance on  val set...
1795/1795 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0935098
{'0': {'precision': 0.34676503972758227, 'recall': 0.004153241703712767, 'f1-score': 0.008208173244848061, 'support': 147114}, '1': {'precision': 0.3637711767136495, 'recall': 0.9544937086272218, 'f1-score': 0.5267792587273805, 'support': 166021}, '2': {'precision': 0.34388656438865645, 'recall': 0.05074884911187799, 'f1-score': 0.08844541959860583, 'support': 145757}, 'accuracy': 0.3627738117029715, 'macro avg': {'precision': 0.3514742602766294, 'recall': 0.33646526648093755, 'f1-score': 0.20781095052361145, 'support': 458892}, 'weighted avg': {'precision': 0.35200334838972513, 'recall': 0.3627738117029715, 'f1-score': 0.22130587488200928, 'support': 458892}}
[[   611 139382   7121]
 [   563 158466   6992]
 [   588 137772   7397]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037178
{'0': {'precision': 0.2895212285456188, 'recall': 0.007905382072912042, 'f1-score': 0.015390525582847127, 'support': 81084}, '1': {'precision': 0.3254430696870025, 'recall': 0.9166647697525665, 'f1-score': 0.48034830321464783, 'support': 87862}, '2': {'precision': 0.39316959064327484, 'recall': 0.08229453295600317, 'f1-score': 0.1361015741400531, 'support': 102121}, 'accuracy': 0.33049024779851477, 'macro avg': {'precision': 0.33604462962529874, 'recall': 0.3356215615938272, 'f1-score': 0.21061346764584934, 'support': 271067}, 'weighted avg': {'precision': 0.3402128995794923, 'recall': 0.33049024779851477, 'f1-score': 0.2115754291232844, 'support': 271067}}
[[  641 74132  6311]
 [  662 80540  6660]
 [  911 92806  8404]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053524
{'0': {'precision': 0.3605577689243028, 'recall': 0.00974847848333064, 'f1-score': 0.018983690807069065, 'support': 18567}, '1': {'precision': 0.3370091999342862, 'recall': 0.8984943881741034, 'f1-score': 0.49016591747435073, 'support': 18265}, '2': {'precision': 0.2980466288594833, 'recall': 0.08285163776493257, 'f1-score': 0.12966008771929827, 'support': 17127}, 'accuracy': 0.33379047054244887, 'macro avg': {'precision': 0.33187119923935743, 'recall': 0.33036483480745554, 'f1-score': 0.21293656533357266, 'support': 53959}, 'weighted avg': {'precision': 0.33274511656801714, 'recall': 0.33379047054244887, 'f1-score': 0.21360734988143384, 'support': 53959}}
[[  181 16705  1681]
 [  193 16411  1661]
 [  128 15580  1419]]
Evaluating performance on  val set...
81/81 - 1s - 708ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050972
{'0': {'precision': 0.35570469798657717, 'recall': 0.007817109144542773, 'f1-score': 0.015298022802713234, 'support': 6780}, '1': {'precision': 0.3443124835048825, 'recall': 0.9110335195530727, 'f1-score': 0.4997510055544915, 'support': 7160}, '2': {'precision': 0.29228775113415423, 'recall': 0.06734358668060325, 'f1-score': 0.10946601941747572, 'support': 6697}, 'accuracy': 0.3405049183505354, 'macro avg': {'precision': 0.33076831087520464, 'recall': 0.3287314051260729, 'f1-score': 0.20817168259156013, 'support': 20637}, 'weighted avg': {'precision': 0.33117247194792765, 'recall': 0.3405049183505354, 'f1-score': 0.2139376714838101, 'support': 20637}}
[[  53 6219  508]
 [  53 6523  584]
 [  43 6203  451]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0784544
{'0': {'precision': 0.32992700729927005, 'recall': 0.001532899690028691, 'f1-score': 0.0030516210048744923, 'support': 147433}, '1': {'precision': 0.42993549374059814, 'recall': 0.9870222720222093, 'f1-score': 0.5989676165490889, 'support': 239179}, '2': {'precision': 0.3606853980417199, 'recall': 0.019639204232657057, 'f1-score': 0.03725014975901164, 'support': 172563}, 'accuracy': 0.42864934948808514, 'macro avg': {'precision': 0.37351596636052936, 'recall': 0.3360647919816317, 'f1-score': 0.21308979577099166, 'support': 559175}, 'weighted avg': {'precision': 0.38219631469005066, 'recall': 0.42864934948808514, 'f1-score': 0.26849981274390045, 'support': 559175}}
[[   226 144080   3127]
 [   224 236075   2880]
 [   235 168939   3389]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1232407
{'0': {'precision': 0.32116788321167883, 'recall': 0.0018380049291950374, 'f1-score': 0.0036550922080079745, 'support': 47878}, '1': {'precision': 0.32117226225918455, 'recall': 0.9831278837545624, 'f1-score': 0.4841729221307769, 'support': 43563}, '2': {'precision': 0.35760090531874766, 'recall': 0.02114513862556599, 'f1-score': 0.03992923932271923, 'support': 44833}, 'accuracy': 0.3218809163890397, 'macro avg': {'precision': 0.333313683596537, 'recall': 0.33537034243644115, 'f1-score': 0.17591908455383468, 'support': 136274}, 'weighted avg': {'precision': 0.33315544095983846, 'recall': 0.3218809163890397, 'f1-score': 0.1691971403061003, 'support': 136274}}
[[   88 46748  1042]
 [   74 42828   661]
 [  112 43773   948]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1431394
{'0': {'precision': 0.3888888888888889, 'recall': 0.0014182960186404619, 'f1-score': 0.0028262844453416773, 'support': 19742}, '1': {'precision': 0.2757889828532672, 'recall': 0.9812971342383107, 'f1-score': 0.43056865372842934, 'support': 13260}, '2': {'precision': 0.31612223393045313, 'recall': 0.019736842105263157, 'f1-score': 0.0371540033438603, 'support': 15200}, 'accuracy': 0.2767520019916186, 'macro avg': {'precision': 0.3269333685575364, 'recall': 0.3341507574540714, 'f1-score': 0.15684964717254377, 'support': 48202}, 'weighted avg': {'precision': 0.3348297645911302, 'recall': 0.2767520019916186, 'f1-score': 0.13131981467129134, 'support': 48202}}
[[   28 19295   419]
 [   18 13012   230]
 [   26 14874   300]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1243638
{'0': {'precision': 0.3677811550151976, 'recall': 0.0021241485850712733, 'f1-score': 0.004223901698287749, 'support': 113928}, '1': {'precision': 0.29797129709841796, 'recall': 0.9753841177421964, 'f1-score': 0.45648915824372127, 'support': 92745}, '2': {'precision': 0.3059261557555073, 'recall': 0.01895716373144659, 'f1-score': 0.03570200054313388, 'support': 104024}, 'accuracy': 0.29828418040727783, 'macro avg': {'precision': 0.3238928692897076, 'recall': 0.33215514335290475, 'f1-score': 0.16547168682838095, 'support': 310697}, 'weighted avg': {'precision': 0.3262328950851637, 'recall': 0.29828418040727783, 'f1-score': 0.14976704814818106, 'support': 310697}}
[[   242 111301   2385]
 [   194  90462   2089]
 [   222 101830   1972]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018407
{'0': {'precision': 0.3161953727506427, 'recall': 0.002771456253802303, 'f1-score': 0.005494750949296403, 'support': 44381}, '1': {'precision': 0.35484536737156286, 'recall': 0.9625960938004694, 'f1-score': 0.5185395702230086, 'support': 46439}, '2': {'precision': 0.31120783460282914, 'recall': 0.035625311410064774, 'f1-score': 0.06393204426064604, 'support': 40140}, 'accuracy': 0.3531994502138057, 'macro avg': {'precision': 0.32741619157501156, 'recall': 0.3336642871547788, 'f1-score': 0.19598878847765033, 'support': 130960}, 'weighted avg': {'precision': 0.328372123811636, 'recall': 0.3531994502138057, 'f1-score': 0.20533410125297302, 'support': 130960}}
[[  123 42700  1558]
 [  130 44702  1607]
 [  136 38574  1430]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986942
{'0': {'precision': 0.33043478260869563, 'recall': 0.0028599382855422593, 'f1-score': 0.005670795403671094, 'support': 13287}, '1': {'precision': 0.3621349928195309, 'recall': 0.9681341182492962, 'f1-score': 0.5271042363433669, 'support': 15628}, '2': {'precision': 0.3354632587859425, 'recall': 0.02951096121416526, 'f1-score': 0.054249547920433995, 'support': 14232}, 'accuracy': 0.3612765661575544, 'macro avg': {'precision': 0.34267767807138966, 'recall': 0.3335016725830012, 'f1-score': 0.19567485988915734, 'support': 43147}, 'weighted avg': {'precision': 0.34357535224573904, 'recall': 0.3612765661575544, 'f1-score': 0.21055953902024083, 'support': 43147}}
[[   38 12879   370]
 [   36 15130   462]
 [   41 13771   420]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1095/1095 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068332
{'0': {'precision': 0.35439236297329185, 'recall': 0.033303094446124386, 'f1-score': 0.06088470787686694, 'support': 99210}, '1': {'precision': 0.2734584570463818, 'recall': 0.8033019798723936, 'f1-score': 0.40801967164917113, 'support': 76015}, '2': {'precision': 0.38036951987696715, 'recall': 0.17217538907537383, 'f1-score': 0.237049582816367, 'support': 104864}, 'accuracy': 0.29427074965457406, 'macro avg': {'precision': 0.33607344663221356, 'recall': 0.3362601544646306, 'f1-score': 0.23531798744746837, 'support': 280089}, 'weighted avg': {'precision': 0.3421529595069399, 'recall': 0.29427074965457406, 'f1-score': 0.2210510040070521, 'support': 280089}}
[[ 3304 78965 16941]
 [ 2481 61063 12471]
 [ 3538 83271 18055]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005155
{'0': {'precision': 0.30643372157515253, 'recall': 0.03174192807078019, 'f1-score': 0.05752511843406736, 'support': 34812}, '1': {'precision': 0.32927529947422624, 'recall': 0.8084857196092523, 'f1-score': 0.4679618531129153, 'support': 37569}, '2': {'precision': 0.371613316945439, 'recall': 0.1648531398904772, 'f1-score': 0.22838938518129268, 'support': 42183}, 'accuracy': 0.33547187598198386, 'macro avg': {'precision': 0.33577411266493923, 'recall': 0.3350269291901699, 'f1-score': 0.2512921189094251, 'support': 114564}, 'weighted avg': {'precision': 0.3379235972044522, 'recall': 0.33547187598198386, 'f1-score': 0.25503275651712876, 'support': 114564}}
[[ 1105 27984  5723]
 [ 1159 30374  6036]
 [ 1342 33887  6954]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034138
{'0': {'precision': 0.3333333333333333, 'recall': 0.033651700437382845, 'f1-score': 0.061131830711853415, 'support': 11203}, '1': {'precision': 0.2967869323281278, 'recall': 0.8113651977622927, 'f1-score': 0.43460203974345496, 'support': 10189}, '2': {'precision': 0.4086746155175393, 'recall': 0.17674314326283536, 'f1-score': 0.24676544240400666, 'support': 13381}, 'accuracy': 0.31659620970293045, 'macro avg': {'precision': 0.34626496039300014, 'recall': 0.34058668048750357, 'f1-score': 0.24749977095310502, 'support': 34773}, 'weighted avg': {'precision': 0.3516167836270906, 'recall': 0.31659620970293045, 'f1-score': 0.24199777031659533, 'support': 34773}}
[[  377  9008  1818]
 [  318  8267  1604]
 [  436 10580  2365]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
1722/1722 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099786
{'0': {'precision': 0.29429735234215887, 'recall': 0.004034171808258187, 'f1-score': 0.00795923987882126, 'support': 143276}, '1': {'precision': 0.29850098843741557, 'recall': 0.9616356763773816, 'f1-score': 0.4555842361074683, 'support': 130955}, '2': {'precision': 0.42295217314383443, 'recall': 0.043057490034100185, 'f1-score': 0.07815828906143577, 'support': 166568}, 'accuracy': 0.3032697442598554, 'macro avg': {'precision': 0.3385835046411363, 'recall': 0.33624244607324666, 'f1-score': 0.18056725501590842, 'support': 440799}, 'weighted avg': {'precision': 0.34416194676308054, 'recall': 0.3032697442598554, 'f1-score': 0.1674687818818027, 'support': 440799}}
[[   578 137511   5187]
 [   426 125931   4598]
 [   960 158436   7172]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1064893
{'0': {'precision': 0.3541963015647226, 'recall': 0.004551353525014166, 'f1-score': 0.00898722298419115, 'support': 54709}, '1': {'precision': 0.3208382506884297, 'recall': 0.9505550946228912, 'f1-score': 0.4797483561896501, 'support': 50622}, '2': {'precision': 0.3337917755466923, 'recall': 0.04612139409372506, 'f1-score': 0.08104452941078256, 'support': 52622}, 'accuracy': 0.3215830025387299, 'macro avg': {'precision': 0.3362754425999482, 'recall': 0.33374261408054345, 'f1-score': 0.18992670286154126, 'support': 157953}, 'weighted avg': {'precision': 0.33670769280401225, 'recall': 0.3215830025387299, 'f1-score': 0.18386626715496876, 'support': 157953}}
[[  249 51909  2551]
 [  210 48119  2293]
 [  244 49951  2427]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1110569
{'0': {'precision': 0.3344370860927152, 'recall': 0.005124562382667817, 'f1-score': 0.010094448053570536, 'support': 19709}, '1': {'precision': 0.30601442000547596, 'recall': 0.9538032656312226, 'f1-score': 0.4633647494541334, 'support': 17577}, '2': {'precision': 0.35142009325985585, 'recall': 0.041121031746031746, 'f1-score': 0.07362671521826013, 'support': 20160}, 'accuracy': 0.3080284092887233, 'macro avg': {'precision': 0.3306238664526824, 'recall': 0.3333496199199741, 'f1-score': 0.1823619709086547, 'support': 57446}, 'weighted avg': {'precision': 0.3317004677498219, 'recall': 0.3080284092887233, 'f1-score': 0.1710794181778235, 'support': 57446}}
[[  101 18799   809]
 [   91 16765   721]
 [  110 19221   829]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
4450/4450 - 39s - 39s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.08216
{'0': {'precision': 0.3519108280254777, 'recall': 0.0012970929857202388, 'f1-score': 0.0025846592869381148, 'support': 340762}, '1': {'precision': 0.40844821919084173, 'recall': 0.985770578406642, 'f1-score': 0.5775796997928033, 'support': 462633}, '2': {'precision': 0.3548447612794297, 'recall': 0.022536234905845838, 'f1-score': 0.042380856355448006, 'support': 335726}, 'accuracy': 0.4073825344278615, 'macro avg': {'precision': 0.3717346028319164, 'recall': 0.33653463543273604, 'f1-score': 0.2075150718117298, 'support': 1139121}, 'weighted avg': {'precision': 0.37573714723355317, 'recall': 0.4073825344278615, 'f1-score': 0.24783718174185948, 'support': 1139121}}
[[   442 332821   7499]
 [   326 456050   6257]
 [   488 327672   7566]]
Evaluating performance on  train set...
1504/1504 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1258179
{'0': {'precision': 0.3631578947368421, 'recall': 0.0005426405360344774, 'f1-score': 0.001083661834686602, 'support': 127156}, '1': {'precision': 0.3320679378338388, 'recall': 0.9926283182370701, 'f1-score': 0.4976537635127299, 'support': 127515}, '2': {'precision': 0.3598495805611802, 'recall': 0.009558348956572517, 'f1-score': 0.018622057557726134, 'support': 130148}, 'accuracy': 0.33233286298233716, 'macro avg': {'precision': 0.35169180437728703, 'recall': 0.33424310257655904, 'f1-score': 0.1724531609683809, 'support': 384819}, 'weighted avg': {'precision': 0.35173692454612776, 'recall': 0.33233286298233716, 'f1-score': 0.17156049286963507, 'support': 384819}}
[[    69 125767   1320]
 [    47 126575    893]
 [    74 128830   1244]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0861448
{'0': {'precision': 0.36363636363636365, 'recall': 0.0010460554990556444, 'f1-score': 0.0020861099843541755, 'support': 34415}, '1': {'precision': 0.4032986070648923, 'recall': 0.9889697477710889, 'f1-score': 0.5729500642889859, 'support': 52492}, '2': {'precision': 0.38261383796570075, 'recall': 0.014838088248784515, 'f1-score': 0.02856827464400044, 'support': 43604}, 'accuracy': 0.4030005133666894, 'macro avg': {'precision': 0.3831829362223189, 'recall': 0.3349512971729764, 'f1-score': 0.20120148297244686, 'support': 130511}, 'weighted avg': {'precision': 0.3859290766851238, 'recall': 0.4030005133666894, 'f1-score': 0.2405374205802269, 'support': 130511}}
[[   36 33885   494]
 [   29 51913   550]
 [   34 42923   647]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
6203/6203 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0740161
{'0': {'precision': 0.29180226251355956, 'recall': 0.004472365389639693, 'f1-score': 0.008809707052678117, 'support': 421030}, '1': {'precision': 0.43791867695758646, 'recall': 0.9543774849474916, 'f1-score': 0.6003603787206419, 'support': 691413}, '2': {'precision': 0.3305626684184419, 'recall': 0.05186241536626766, 'f1-score': 0.08965823185254407, 'support': 475431}, 'accuracy': 0.4322817805443001, 'macro avg': {'precision': 0.3534278692965293, 'recall': 0.33690408856779963, 'f1-score': 0.2329427725419547, 'support': 1587874}, 'weighted avg': {'precision': 0.36703158612472275, 'recall': 0.4322817805443001, 'f1-score': 0.29059763200395694, 'support': 1587874}}
[[  1883 398320  20827]
 [  2437 659869  29107]
 [  2133 448641  24657]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081669
{'0': {'precision': 0.3568753344034243, 'recall': 0.004304419935853172, 'f1-score': 0.00850624258732608, 'support': 154957}, '1': {'precision': 0.3341554814923503, 'recall': 0.9545841650033267, 'f1-score': 0.4950255579535005, 'support': 150300}, '2': {'precision': 0.36234886073510286, 'recall': 0.05126282933744054, 'f1-score': 0.08981867898956972, 'support': 146734}, 'accuracy': 0.3355442918111201, 'macro avg': {'precision': 0.35112655887695915, 'recall': 0.33671713809220677, 'f1-score': 0.19778349317679877, 'support': 451991}, 'weighted avg': {'precision': 0.3510972514774769, 'recall': 0.3355442918111201, 'f1-score': 0.1966851048712716, 'support': 451991}}
[[   667 147322   6968]
 [   557 143474   6269]
 [   645 138567   7522]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0820453
{'0': {'precision': 0.28810408921933084, 'recall': 0.003472377794704064, 'f1-score': 0.0068620506463609, 'support': 44638}, '1': {'precision': 0.40999922410083867, 'recall': 0.9639469320066335, 'f1-score': 0.5753027401259952, 'support': 60300}, '2': {'precision': 0.3335068540690613, 'recall': 0.044558816710715446, 'f1-score': 0.07861422991185554, 'support': 43134}, 'accuracy': 0.4065792317251067, 'macro avg': {'precision': 0.3438700557964103, 'recall': 0.33732604217068435, 'f1-score': 0.22025967356140388, 'support': 148072}, 'weighted avg': {'precision': 0.3509699888653355, 'recall': 0.4065792317251067, 'f1-score': 0.2592523207586022, 'support': 148072}}
[[  155 42645  1838]
 [  171 58126  2003]
 [  212 41000  1922]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
5183/5183 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233032
{'0': {'precision': 0.342988413903316, 'recall': 0.003779815301977964, 'f1-score': 0.007477229723403468, 'support': 454255}, '1': {'precision': 0.26920272010910745, 'recall': 0.9587580181811026, 'f1-score': 0.4203721802704279, 'support': 355754}, '2': {'precision': 0.39844234487287056, 'recall': 0.04226720146430845, 'f1-score': 0.07642694832740612, 'support': 516831}, 'accuracy': 0.2748213801211902, 'macro avg': {'precision': 0.336877826295098, 'recall': 0.3349350116491297, 'f1-score': 0.1680921194404125, 'support': 1326840}, 'weighted avg': {'precision': 0.34480532844226647, 'recall': 0.2748213801211902, 'f1-score': 0.14504044929225232, 'support': 1326840}}
[[  1717 433008  19530]
 [  1221 341082  13451]
 [  2068 492918  21845]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110373
{'0': {'precision': 0.3563696919233972, 'recall': 0.003216158944378485, 'f1-score': 0.006374786824447606, 'support': 133078}, '1': {'precision': 0.3218179325472991, 'recall': 0.963098207838246, 'f1-score': 0.4824319102934043, 'support': 121864}, '2': {'precision': 0.364433601476988, 'recall': 0.043821605550049554, 'f1-score': 0.0782356979566993, 'support': 126125}, 'accuracy': 0.3236228799659902, 'macro avg': {'precision': 0.34754040864922814, 'recall': 0.336711990777558, 'f1-score': 0.18901413169151707, 'support': 381067}, 'weighted avg': {'precision': 0.34798913151758354, 'recall': 0.3236228799659902, 'f1-score': 0.1824007421314571, 'support': 381067}}
[[   428 127205   5445]
 [   303 117367   4194]
 [   470 120128   5527]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069355
{'0': {'precision': 0.3457142857142857, 'recall': 0.0027407189290810665, 'f1-score': 0.005438324456729365, 'support': 44149}, '1': {'precision': 0.3374343973156672, 'recall': 0.9675480499674808, 'f1-score': 0.5003653402303383, 'support': 44589}, '2': {'precision': 0.337216970762805, 'recall': 0.03485254691689008, 'f1-score': 0.06317566871898359, 'support': 44014}, 'accuracy': 0.33744877666626494, 'macro avg': {'precision': 0.34012188459758597, 'recall': 0.3350471052711506, 'f1-score': 0.18965977780201707, 'support': 132752}, 'weighted avg': {'precision': 0.3401159311578159, 'recall': 0.33744877666626494, 'f1-score': 0.19081822213577226, 'support': 132752}}
[[  121 42368  1660]
 [   92 43142  1355]
 [  137 42343  1534]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
7324/7324 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982193
{'0': {'precision': 0.3218826075196105, 'recall': 0.0038613922428199195, 'f1-score': 0.007631238056150522, 'support': 616358}, '1': {'precision': 0.3511442747054856, 'recall': 0.9406286485836455, 'f1-score': 0.511384560891863, 'support': 656933}, '2': {'precision': 0.33769095591858744, 'recall': 0.060389248688509596, 'f1-score': 0.10245625319126729, 'support': 601415}, 'accuracy': 0.350257053639344, 'macro avg': {'precision': 0.3369059460478945, 'recall': 0.3349597631716583, 'f1-score': 0.2071573507130936, 'support': 1874706}, 'weighted avg': {'precision': 0.33720785460464103, 'recall': 0.350257053639344, 'f1-score': 0.21457641671772165, 'support': 1874706}}
[[  2380 579393  34585]
 [  2356 617930  36647]
 [  2658 562438  36319]]
Evaluating performance on  train set...
2046/2046 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015193
{'0': {'precision': 0.3415, 'recall': 0.0039039056203666127, 'f1-score': 0.007719563952009856, 'support': 174953}, '1': {'precision': 0.33057227687237967, 'recall': 0.9400787506596383, 'f1-score': 0.48914133985079244, 'support': 172443}, '2': {'precision': 0.3424107142857143, 'recall': 0.060888203406745445, 'f1-score': 0.10339116871112479, 'support': 176356}, 'accuracy': 0.33132283981731814, 'macro avg': {'precision': 0.338160997052698, 'recall': 0.3349569532289168, 'f1-score': 0.20008402417130902, 'support': 523752}, 'weighted avg': {'precision': 0.3382087487384778, 'recall': 0.33132283981731814, 'f1-score': 0.1984397460805979, 'support': 523752}}
[[   683 163383  10887]
 [   598 162110   9735]
 [   719 164899  10738]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949985
{'0': {'precision': 0.33421750663129973, 'recall': 0.0040191387559808615, 'f1-score': 0.007942761685630536, 'support': 62700}, '1': {'precision': 0.3469587194608256, 'recall': 0.9452230858681682, 'f1-score': 0.5075963616344709, 'support': 65356}, '2': {'precision': 0.3495271648433154, 'recall': 0.061266941853284365, 'f1-score': 0.10425884955752214, 'support': 61534}, 'accuracy': 0.34705416952370904, 'macro avg': {'precision': 0.3435677969784803, 'recall': 0.3368363888258111, 'f1-score': 0.20659932429254121, 'support': 189590}, 'weighted avg': {'precision': 0.34357865022592327, 'recall': 0.34705416952370904, 'f1-score': 0.21144545080090763, 'support': 189590}}
[[  252 58768  3680]
 [  244 61776  3336]
 [  258 57506  3770]]
testing model on single stock: results/universal/W6/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
29350/29350 - 207s - 207s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0920641
{'0': {'precision': 0.2916440531467969, 'recall': 0.0064998656034405515, 'f1-score': 0.01271632275743235, 'support': 2232200}, '1': {'precision': 0.4003623162613199, 'recall': 0.9323396419342368, 'f1-score': 0.5601757486609283, 'support': 3016094}, '2': {'precision': 0.28951920301302175, 'recall': 0.056233913584770714, 'f1-score': 0.0941758559030146, 'support': 2265110}, 'accuracy': 0.3931518922714658, 'macro avg': {'precision': 0.3271751908070462, 'recall': 0.3316911403741493, 'f1-score': 0.22235597577379176, 'support': 7513404}, 'weighted avg': {'precision': 0.3346460641904755, 'recall': 0.3931518922714658, 'f1-score': 0.2570401861932823, 'support': 7513404}}
[[  14509 2088828  128863]
 [  20352 2812024  183718]
 [  14888 2122846  127376]]
Evaluating performance on  train set...
5452/5452 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036149
{'0': {'precision': 0.3160939898453182, 'recall': 0.005747940875868525, 'f1-score': 0.011290570876063102, 'support': 465732}, '1': {'precision': 0.3293339610034623, 'recall': 0.9367901117247248, 'f1-score': 0.48734054547814026, 'support': 463013}, '2': {'precision': 0.3193979933110368, 'recall': 0.047879930580849744, 'f1-score': 0.08327619359935608, 'support': 466730}, 'accuracy': 0.32875544169548004, 'macro avg': {'precision': 0.32160864805327244, 'recall': 0.33013932772714766, 'f1-score': 0.19396910331785314, 'support': 1395475}, 'weighted avg': {'precision': 0.32159201474967025, 'recall': 0.32875544169548004, 'f1-score': 0.19331832241878089, 'support': 1395475}}
[[  2677 441647  21408]
 [  3056 433746  26211]
 [  2736 441647  22347]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0949516
{'0': {'precision': 0.3186153302719887, 'recall': 0.0056151796608481285, 'f1-score': 0.011035866566340606, 'support': 160636}, '1': {'precision': 0.3731343597553921, 'recall': 0.9382994255244866, 'f1-score': 0.5339373734789251, 'support': 189042}, '2': {'precision': 0.2878301558451603, 'recall': 0.04821064222560482, 'f1-score': 0.0825880473136415, 'support': 154385}, 'accuracy': 0.3684519593780936, 'macro avg': {'precision': 0.32652661529084703, 'recall': 0.3307084158036465, 'f1-score': 0.20918709578630237, 'support': 504063}, 'weighted avg': {'precision': 0.32963303484009954, 'recall': 0.3684519593780936, 'f1-score': 0.22905807826297545, 'support': 504063}}
[[   902 151855   7879]
 [  1127 177378  10537]
 [   802 146140   7443]]
training model: results/universal/W6/deepVOL_L3/h300
Epoch 1/50
9426/9426 - 495s - loss: 3.2473 - accuracy300: 0.3826 - val_loss: 3.3015 - val_accuracy300: 0.3531 - 495s/epoch - 53ms/step
Epoch 2/50
9426/9426 - 498s - loss: 3.2435 - accuracy300: 0.3895 - val_loss: 3.3153 - val_accuracy300: 0.3531 - 498s/epoch - 53ms/step
Epoch 3/50
9426/9426 - 517s - loss: 3.2362 - accuracy300: 0.3943 - val_loss: 3.3098 - val_accuracy300: 0.3532 - 517s/epoch - 55ms/step
Epoch 4/50
9426/9426 - 477s - loss: 3.2371 - accuracy300: 0.3942 - val_loss: 3.2950 - val_accuracy300: 0.3564 - 477s/epoch - 51ms/step
Epoch 5/50
9426/9426 - 483s - loss: 3.2342 - accuracy300: 0.3964 - val_loss: 3.3021 - val_accuracy300: 0.3530 - 483s/epoch - 51ms/step
Epoch 6/50
9426/9426 - 489s - loss: 3.2305 - accuracy300: 0.3995 - val_loss: 3.3072 - val_accuracy300: 0.3528 - 489s/epoch - 52ms/step
Epoch 7/50
9426/9426 - 492s - loss: 3.2270 - accuracy300: 0.4014 - val_loss: 3.3024 - val_accuracy300: 0.3495 - 492s/epoch - 52ms/step
Epoch 8/50
9426/9426 - 493s - loss: 3.2248 - accuracy300: 0.4030 - val_loss: 3.2981 - val_accuracy300: 0.3517 - 493s/epoch - 52ms/step
Epoch 9/50
9426/9426 - 497s - loss: 3.2219 - accuracy300: 0.4035 - val_loss: 3.2978 - val_accuracy300: 0.3525 - 497s/epoch - 53ms/step
Epoch 10/50
9426/9426 - 521s - loss: 3.2152 - accuracy300: 0.4081 - val_loss: 3.2998 - val_accuracy300: 0.3541 - 521s/epoch - 55ms/step
Epoch 11/50
9426/9426 - 518s - loss: 3.2109 - accuracy300: 0.4101 - val_loss: 3.3018 - val_accuracy300: 0.3530 - 518s/epoch - 55ms/step
Epoch 12/50
9426/9426 - 528s - loss: 3.2072 - accuracy300: 0.4116 - val_loss: 3.2987 - val_accuracy300: 0.3506 - 528s/epoch - 56ms/step
Epoch 13/50
9426/9426 - 531s - loss: 3.2026 - accuracy300: 0.4145 - val_loss: 3.3048 - val_accuracy300: 0.3509 - 531s/epoch - 56ms/step
Epoch 14/50
9426/9426 - 522s - loss: 3.1992 - accuracy300: 0.4163 - val_loss: 3.3089 - val_accuracy300: 0.3495 - 522s/epoch - 55ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1176s - 1176s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924472
{'0': {'precision': 0.33123644807355945, 'recall': 0.13118948875376352, 'f1-score': 0.18794248686621345, 'support': 3252288}, '1': {'precision': 0.3965833631760423, 'recall': 0.8855836200287668, 'f1-score': 0.5478346190552653, 'support': 4266723}, '2': {'precision': 0.34227467811158796, 'recall': 0.00029003357358336633, 'f1-score': 0.0005795760313516114, 'support': 3299618}, 'accuracy': 0.38878891216253003, 'macro avg': {'precision': 0.35669816312039654, 'recall': 0.33902104745203787, 'f1-score': 0.24545222731761016, 'support': 10818629}, 'weighted avg': {'precision': 0.36037499494196856, 'recall': 0.38878891216253003, 'f1-score': 0.27273456216586217, 'support': 10818629}}
[[ 426666 2824894     728]
 [ 487072 3778540    1111]
 [ 374363 2924298     957]]
Evaluating performance on  train set...
9426/9426 - 277s - 277s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055284
{'0': {'precision': 0.3739923893625365, 'recall': 0.12621560285078476, 'f1-score': 0.18873618822494642, 'support': 816056}, '1': {'precision': 0.3283562523760209, 'recall': 0.891863984333274, 'f1-score': 0.47999386785221526, 'support': 786380}, '2': {'precision': 0.4133180252583238, 'recall': 0.00044457452365692185, 'f1-score': 0.0008881936854363376, 'support': 809763}, 'accuracy': 0.3335972695453402, 'macro avg': {'precision': 0.3718888889989604, 'recall': 0.3395080539025719, 'f1-score': 0.22320608325419933, 'support': 2412199}, 'weighted avg': {'precision': 0.3723163665702313, 'recall': 0.3335972695453402, 'f1-score': 0.22062694786086137, 'support': 2412199}}
[[102999 712855    202]
 [ 84727 701344    309]
 [ 87678 721725    360]]
Evaluating performance on  val set...
3323/3323 - 96s - 96s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990465
{'0': {'precision': 0.35882105807452414, 'recall': 0.12105540513528738, 'f1-score': 0.1810350450019566, 'support': 275155}, '1': {'precision': 0.35573331854176243, 'recall': 0.89717182550653, 'f1-score': 0.509462208381367, 'support': 300229}, '2': {'precision': 0.3274647887323944, 'recall': 0.00033828391841901373, 'f1-score': 0.0006758696371016094, 'support': 274917}, 'accuracy': 0.3560609713501454, 'macro avg': {'precision': 0.3473397217828936, 'recall': 0.3395218381867455, 'f1-score': 0.2303910410068084, 'support': 850301}, 'weighted avg': {'precision': 0.3475927983748274, 'recall': 0.3560609713501454, 'f1-score': 0.23868469544392618, 'support': 850301}}
[[ 33309 241780     66]
 [ 30747 269357    125]
 [ 28773 246051     93]]
testing model out of sample: results/universal/W6/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 515s - 515s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924764
{'0': {'precision': 0.35840203259723763, 'recall': 0.0961675981381208, 'f1-score': 0.15164524997827072, 'support': 1378822}, '1': {'precision': 0.37768506049984685, 'recall': 0.9242744284624028, 'f1-score': 0.5362450159037255, 'support': 1681123}, '2': {'precision': 0.3036837376460018, 'recall': 0.0002371600296941197, 'f1-score': 0.00047394993097578305, 'support': 1425198}, 'accuracy': 0.37607608051738817, 'macro avg': {'precision': 0.34659027691436206, 'recall': 0.34022639554340595, 'f1-score': 0.22945473860432405, 'support': 4485143}, 'weighted avg': {'precision': 0.3482424317079921, 'recall': 0.37607608051738817, 'f1-score': 0.24776492281971493, 'support': 4485143}}
[[ 132598 1245977     247]
 [ 126776 1553819     528]
 [ 110596 1314264     338]]
Evaluating performance on  train set...
5153/5153 - 148s - 148s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1044366
{'0': {'precision': 0.386630690225433, 'recall': 0.08990952373455798, 'f1-score': 0.14589233059877968, 'support': 444647}, '1': {'precision': 0.33379264022441835, 'recall': 0.925256802821979, 'f1-score': 0.49059854290118, 'support': 438274}, '2': {'precision': 0.34411764705882353, 'recall': 0.0002685370925466038, 'f1-score': 0.0005366553984322323, 'support': 435694}, 'accuracy': 0.33793867049897053, 'macro avg': {'precision': 0.35484699250289164, 'recall': 0.33847828788302786, 'f1-score': 0.21234250963279733, 'support': 1318615}, 'weighted avg': {'precision': 0.35502159935692523, 'recall': 0.33793867049897053, 'f1-score': 0.21243576817523835, 'support': 1318615}}
[[ 39978 404566    103]
 [ 32638 405516    120]
 [ 30785 404792    117]]
Evaluating performance on  val set...
1795/1795 - 58s - 58s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935912
{'0': {'precision': 0.381695753744675, 'recall': 0.0954829838432451, 'f1-score': 0.1527538702670003, 'support': 145450}, '1': {'precision': 0.37243691271831075, 'recall': 0.9272363977154174, 'f1-score': 0.5314213326577147, 'support': 169659}, '2': {'precision': 0.31896551724137934, 'recall': 0.000257332229818546, 'f1-score': 0.0005142495778288939, 'support': 143783}, 'accuracy': 0.37315751854466844, 'macro avg': {'precision': 0.35769939456812166, 'recall': 0.3409922379294937, 'f1-score': 0.22822981750084795, 'support': 458892}, 'weighted avg': {'precision': 0.3586175843609305, 'recall': 0.37315751854466844, 'f1-score': 0.24505200059002857, 'support': 458892}}
[[ 13888 131533     29]
 [ 12295 157314     50]
 [ 10202 133544     37]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052264
{'0': {'precision': 0.2994903959231674, 'recall': 0.12792269144750218, 'f1-score': 0.179272084272629, 'support': 83613}, '1': {'precision': 0.3409197141084586, 'recall': 0.8751758969380298, 'f1-score': 0.49069285978587607, 'support': 91673}, '2': {'precision': 0.2631578947368421, 'recall': 5.220242010419603e-05, 'f1-score': 0.00010438413361169103, 'support': 95781}, 'accuracy': 0.3354558098182368, 'macro avg': {'precision': 0.3011893349228227, 'recall': 0.334383596935212, 'f1-score': 0.22335644273070557, 'support': 271067}, 'weighted avg': {'precision': 0.3006634881471296, 'recall': 0.3354558098182368, 'f1-score': 0.22128389414476643, 'support': 271067}}
[[10696 72914     3]
 [11432 80230    11]
 [13586 82190     5]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038942
{'0': {'precision': 0.35273116744019994, 'recall': 0.10989988876529477, 'f1-score': 0.16758544652701213, 'support': 17980}, '1': {'precision': 0.3421917978201973, 'recall': 0.9079236172080772, 'f1-score': 0.4970485302732175, 'support': 18224}, '2': {'precision': 0.25, 'recall': 5.632216277105041e-05, 'f1-score': 0.00011261895376991947, 'support': 17755}, 'accuracy': 0.3432791563965233, 'macro avg': {'precision': 0.31497432175346574, 'recall': 0.339293276045381, 'f1-score': 0.22158219858466652, 'support': 53959}, 'weighted avg': {'precision': 0.3153683299180873, 'recall': 0.3432791563965233, 'f1-score': 0.22375133515778609, 'support': 53959}}
[[ 1976 16003     1]
 [ 1676 16546     2]
 [ 1950 15804     1]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996698
{'0': {'precision': 0.3538575667655786, 'recall': 0.14395654142145767, 'f1-score': 0.20465515392041186, 'support': 6627}, '1': {'precision': 0.3541283380721414, 'recall': 0.8808764387740952, 'f1-score': 0.5051693971687609, 'support': 7211}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6799}, 'accuracy': 0.35402432524107186, 'macro avg': {'precision': 0.23599530161257332, 'recall': 0.34161099339851764, 'f1-score': 0.23660818369639092, 'support': 20637}, 'weighted avg': {'precision': 0.23737139801297186, 'recall': 0.35402432524107186, 'f1-score': 0.2422360918745217, 'support': 20637}}
[[ 954 5672    1]
 [ 856 6352    3]
 [ 886 5913    0]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
2185/2185 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118898
{'0': {'precision': 0.39797450466629375, 'recall': 0.14257012228884214, 'f1-score': 0.2099337259819775, 'support': 189633}, '1': {'precision': 0.301049261234437, 'recall': 0.865378527628941, 'f1-score': 0.44669986246590027, 'support': 170582}, '2': {'precision': 0.33816964285714285, 'recall': 0.00152291917973462, 'f1-score': 0.003032183171883756, 'support': 198960}, 'accuracy': 0.3128841596995574, 'macro avg': {'precision': 0.3457311362526245, 'recall': 0.3364905230325059, 'f1-score': 0.21988859053992052, 'support': 559175}, 'weighted avg': {'precision': 0.34712731518063783, 'recall': 0.3128841596995574, 'f1-score': 0.20854401817351728, 'support': 559175}}
[[ 27036 162309    288]
 [ 22659 147618    305]
 [ 18239 180418    303]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996954
{'0': {'precision': 0.4709559287788862, 'recall': 0.15882039816884913, 'f1-score': 0.23753642341926337, 'support': 46965}, '1': {'precision': 0.327472966560947, 'recall': 0.8724357410569736, 'f1-score': 0.47620142839849894, 'support': 45091}, '2': {'precision': 0.43322475570032576, 'recall': 0.0030078248677009364, 'f1-score': 0.005974171813587872, 'support': 44218}, 'accuracy': 0.3443870437500917, 'macro avg': {'precision': 0.4105512170133863, 'recall': 0.3447546546978413, 'f1-score': 0.23990400787711672, 'support': 136274}, 'weighted avg': {'precision': 0.4112366333846299, 'recall': 0.3443870437500917, 'f1-score': 0.2413700534442054, 'support': 136274}}
[[ 7459 39433    73]
 [ 5651 39339   101]
 [ 2728 41357   133]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1095768
{'0': {'precision': 0.4670189504373178, 'recall': 0.14597334548354027, 'f1-score': 0.22242471578581968, 'support': 17558}, '1': {'precision': 0.3311517710532489, 'recall': 0.8968299345657836, 'f1-score': 0.48369909715440884, 'support': 15741}, '2': {'precision': 0.25, 'recall': 0.0014091122592766556, 'f1-score': 0.002802428771602055, 'support': 14903}, 'accuracy': 0.34647939919505416, 'macro avg': {'precision': 0.3493902404968556, 'recall': 0.34807079743620023, 'f1-score': 0.23630874723727688, 'support': 48202}, 'weighted avg': {'precision': 0.35555223351577975, 'recall': 0.34647939919505416, 'f1-score': 0.23984492851039704, 'support': 48202}}
[[ 2563 14970    25]
 [ 1586 14117    38]
 [ 1339 13543    21]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1169589
{'0': {'precision': 0.439192946222893, 'recall': 0.050075625152835264, 'f1-score': 0.0899009772198826, 'support': 110413}, '1': {'precision': 0.29796860944401926, 'recall': 0.9631855910595128, 'f1-score': 0.45513716100684715, 'support': 92165}, '2': {'precision': 0.34782608695652173, 'recall': 0.0005919403620085276, 'f1-score': 0.001181869384966252, 'support': 108119}, 'accuracy': 0.30372034490194627, 'macro avg': {'precision': 0.36166254754114463, 'recall': 0.3379510521914522, 'f1-score': 0.18207333587056532, 'support': 310697}, 'weighted avg': {'precision': 0.3655056095049791, 'recall': 0.30372034490194627, 'f1-score': 0.16737121883380957, 'support': 310697}}
[[  5529 104837     47]
 [  3320  88772     73]
 [  3740 104315     64]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030107
{'0': {'precision': 0.3926216860709777, 'recall': 0.06360785383146987, 'f1-score': 0.1094792012985743, 'support': 44004}, '1': {'precision': 0.3487857292895345, 'recall': 0.9495864860109098, 'f1-score': 0.5101806880088867, 'support': 45464}, '2': {'precision': 0.32075471698113206, 'recall': 0.00040971753591053696, 'f1-score': 0.0008183896979179204, 'support': 41492}, 'accuracy': 0.35116065974343313, 'macro avg': {'precision': 0.35405404411388136, 'recall': 0.33786801912609676, 'f1-score': 0.20682609300179297, 'support': 130960}, 'weighted avg': {'precision': 0.35463403930412213, 'recall': 0.35116065974343313, 'f1-score': 0.2141595464181773, 'support': 130960}}
[[ 2799 41188    17]
 [ 2273 43172    19]
 [ 2057 39418    17]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029674
{'0': {'precision': 0.36864244741873803, 'recall': 0.06954263454047035, 'f1-score': 0.11701159191600413, 'support': 13862}, '1': {'precision': 0.3498099797640788, 'recall': 0.9434276206322796, 'f1-score': 0.5103785983041389, 'support': 15025}, '2': {'precision': 0.2, 'recall': 0.00014025245441795232, 'f1-score': 0.00028030833917309044, 'support': 14260}, 'accuracy': 0.35091663383317495, 'macro avg': {'precision': 0.3061508090609389, 'recall': 0.3377035025423893, 'f1-score': 0.20922349951977207, 'support': 43147}, 'weighted avg': {'precision': 0.30634844953470297, 'recall': 0.35091663383317495, 'f1-score': 0.2154135936119764, 'support': 43147}}
[[  964 12895     3]
 [  845 14175     5]
 [  806 13452     2]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1095/1095 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1219934
{'0': {'precision': 0.35235174253723506, 'recall': 0.3376989439987115, 'f1-score': 0.3448697717214189, 'support': 99337}, '1': {'precision': 0.25693546729553285, 'recall': 0.6643869145023007, 'f1-score': 0.3705642361788269, 'support': 71499}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 109253}, 'accuracy': 0.28936873636594085, 'macro avg': {'precision': 0.20309573661092264, 'recall': 0.3340286195003374, 'f1-score': 0.23847800263341526, 'support': 280089}, 'weighted avg': {'precision': 0.19055440957904315, 'recall': 0.28936873636594085, 'f1-score': 0.21690712893416214, 'support': 280089}}
[[33546 65791     0]
 [23996 47503     0]
 [37664 71589     0]]
Evaluating performance on  train set...
448/448 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1084759
{'0': {'precision': 0.3290899795501023, 'recall': 0.3447500200840854, 'f1-score': 0.3367380301583773, 'support': 37343}, '1': {'precision': 0.3319813371507343, 'recall': 0.6621896729503213, 'f1-score': 0.4422470799085347, 'support': 37823}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 39398}, 'accuracy': 0.3309940295380748, 'macro avg': {'precision': 0.22035710556694554, 'recall': 0.3356465643448023, 'f1-score': 0.2596617033556373, 'support': 114564}, 'weighted avg': {'precision': 0.21687211708208243, 'recall': 0.3309940295380748, 'f1-score': 0.25576899866960645, 'support': 114564}}
[[12874 24469     0]
 [12777 25046     0]
 [13469 25929     0]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.118057
{'0': {'precision': 0.32863199086906897, 'recall': 0.34571183533447686, 'f1-score': 0.3369556131405166, 'support': 11660}, '1': {'precision': 0.29288665748433823, 'recall': 0.653255376077693, 'f1-score': 0.40444199030615385, 'support': 10091}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13022}, 'accuracy': 0.3054956431714261, 'macro avg': {'precision': 0.20717288278446908, 'recall': 0.3329890704707233, 'f1-score': 0.2471325344822235, 'support': 34773}, 'weighted avg': {'precision': 0.19519075933073943, 'recall': 0.3054956431714261, 'f1-score': 0.23035477449164068, 'support': 34773}}
[[4031 7629    0]
 [3499 6592    0]
 [4736 8286    0]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1094306
{'0': {'precision': 0.34419577921249395, 'recall': 0.09250267467698133, 'f1-score': 0.1458170044162401, 'support': 145812}, '1': {'precision': 0.30867392046063, 'recall': 0.9152832752407396, 'f1-score': 0.4616567930526507, 'support': 135416}, '2': {'precision': 0.4666666666666667, 'recall': 0.00021933810028137944, 'f1-score': 0.0004384701151297245, 'support': 159571}, 'accuracy': 0.31185869296436697, 'macro avg': {'precision': 0.3731787887799302, 'recall': 0.3360017626726674, 'f1-score': 0.20263742252800687, 'support': 440799}, 'weighted avg': {'precision': 0.3776182097470628, 'recall': 0.31185869296436697, 'f1-score': 0.19021720205966872, 'support': 440799}}
[[ 13488 132309     15]
 [ 11447 123944     25]
 [ 14252 145284     35]]
Evaluating performance on  train set...
618/618 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066073
{'0': {'precision': 0.36876964526268524, 'recall': 0.06080855947576913, 'f1-score': 0.10440171619259495, 'support': 54022}, '1': {'precision': 0.3257035873897814, 'recall': 0.9511650238099904, 'f1-score': 0.48524626220313816, 'support': 51029}, '2': {'precision': 0.21739130434782608, 'recall': 9.45143850894106e-05, 'f1-score': 0.0001889466225791214, 'support': 52902}, 'accuracy': 0.3281165916443499, 'macro avg': {'precision': 0.30395484566676423, 'recall': 0.3373560325569496, 'f1-score': 0.1966123083394374, 'support': 157953}, 'weighted avg': {'precision': 0.30415653339855925, 'recall': 0.3281165916443499, 'f1-score': 0.19253585990989713, 'support': 157953}}
[[ 3285 50731     6]
 [ 2480 48537    12]
 [ 3143 49754     5]]
Evaluating performance on  val set...
225/225 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1068746
{'0': {'precision': 0.36661730484451027, 'recall': 0.09033569641367807, 'f1-score': 0.14495420517753338, 'support': 19184}, '1': {'precision': 0.32303839732888145, 'recall': 0.923828125, 'f1-score': 0.47869110536376924, 'support': 18432}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19830}, 'accuracy': 0.32658496675138393, 'macro avg': {'precision': 0.22988523405779726, 'recall': 0.3380546071378927, 'f1-score': 0.20788177018043422, 'support': 57446}, 'weighted avg': {'precision': 0.2260806690753582, 'recall': 0.32658496675138393, 'f1-score': 0.2019990238866204, 'support': 57446}}
[[ 1733 17448     3]
 [ 1400 17028     4]
 [ 1594 18236     0]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
4450/4450 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1115844
{'0': {'precision': 0.4305160958367822, 'recall': 0.09798375805096611, 'f1-score': 0.15963518120660622, 'support': 392810}, '1': {'precision': 0.3166085446097115, 'recall': 0.9145695984313985, 'f1-score': 0.4703796134463779, 'support': 363126}, '2': {'precision': 0.4118404118404118, 'recall': 0.0008351057583151742, 'f1-score': 0.0016668316135450903, 'support': 383185}, 'accuracy': 0.32561334572885586, 'macro avg': {'precision': 0.38632168409563516, 'recall': 0.33779615408022656, 'f1-score': 0.2105605420888431, 'support': 1139121}, 'weighted avg': {'precision': 0.3879226966991748, 'recall': 0.32561334572885586, 'f1-score': 0.20555504455973747, 'support': 1139121}}
[[ 38489 354127    194]
 [ 30759 332104    263]
 [ 20154 362711    320]]
Evaluating performance on  train set...
1504/1504 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081305
{'0': {'precision': 0.45059105307888436, 'recall': 0.09060754596794866, 'f1-score': 0.1508760356235084, 'support': 128731}, '1': {'precision': 0.3302570881931313, 'recall': 0.9321446845357578, 'f1-score': 0.48771697876187475, 'support': 127035}, '2': {'precision': 0.43007915567282323, 'recall': 0.001263046965200344, 'f1-score': 0.0025186970764571356, 'support': 129053}, 'accuracy': 0.3384500245569995, 'macro avg': {'precision': 0.4036424323149463, 'recall': 0.34133842582296897, 'f1-score': 0.21370390382061344, 'support': 384819}, 'weighted avg': {'precision': 0.40398798221906185, 'recall': 0.3384500245569995, 'f1-score': 0.21231954439014872, 'support': 384819}}
[[ 11664 116973     94]
 [  8498 118415    122]
 [  5724 123166    163]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930768
{'0': {'precision': 0.41226264012811714, 'recall': 0.09078771695594126, 'f1-score': 0.14880571440368298, 'support': 39697}, '1': {'precision': 0.3542526090886679, 'recall': 0.9321469500724371, 'f1-score': 0.5133949040413964, 'support': 46247}, '2': {'precision': 0.3924050632911392, 'recall': 0.0006955819328202481, 'f1-score': 0.0013887022353626305, 'support': 44567}, 'accuracy': 0.35816138103301637, 'macro avg': {'precision': 0.3863067708359747, 'recall': 0.3412100829870662, 'f1-score': 0.22119644022681398, 'support': 130511}, 'weighted avg': {'precision': 0.38492561464846403, 'recall': 0.35816138103301637, 'f1-score': 0.22765900854647403, 'support': 130511}}
[[ 3604 36077    16]
 [ 3106 43109    32]
 [ 2032 42504    31]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
6203/6203 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986844
{'0': {'precision': 0.38350829365009115, 'recall': 0.12745553705588536, 'f1-score': 0.1913256970264327, 'support': 509919}, '1': {'precision': 0.3383710539363834, 'recall': 0.892839861836914, 'f1-score': 0.4907545265815353, 'support': 537336}, '2': {'precision': 0.3280701754385965, 'recall': 0.00034589979264509755, 'f1-score': 0.0006910709567267627, 'support': 540619}, 'accuracy': 0.3431846607476412, 'macro avg': {'precision': 0.34998317434169035, 'recall': 0.3402137662284815, 'f1-score': 0.22759043152156488, 'support': 1587874}, 'weighted avg': {'precision': 0.3493590073287679, 'recall': 0.3431846607476412, 'f1-score': 0.22774747145352342, 'support': 1587874}}
[[ 64992 444808    119]
 [ 57317 479755    264]
 [ 47158 493274    187]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031158
{'0': {'precision': 0.39791472440495446, 'recall': 0.13677773781105915, 'f1-score': 0.20357824241716307, 'support': 152905}, '1': {'precision': 0.3384788760612056, 'recall': 0.8858579171937367, 'f1-score': 0.48980671627863154, 'support': 152573}, '2': {'precision': 0.36885245901639346, 'recall': 0.0003071399807525612, 'f1-score': 0.0006137688819176868, 'support': 146513}, 'accuracy': 0.34539847032352416, 'macro avg': {'precision': 0.36841535316085117, 'recall': 0.3409809316618495, 'f1-score': 0.23133290919257077, 'support': 451991}, 'weighted avg': {'precision': 0.3684311608423502, 'recall': 0.34539847032352416, 'f1-score': 0.23440585409836118, 'support': 451991}}
[[ 20914 131958     33]
 [ 17371 135158     44]
 [ 14274 132194     45]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974383
{'0': {'precision': 0.4109481776765376, 'recall': 0.11782113555655332, 'f1-score': 0.18313612283094882, 'support': 48998}, '1': {'precision': 0.351972530138469, 'recall': 0.9047509402103001, 'f1-score': 0.506790053793778, 'support': 52116}, '2': {'precision': 0.3898305084745763, 'recall': 0.0004897993952042251, 'f1-score': 0.000978369525916158, 'support': 46958}, 'accuracy': 0.3575827975579448, 'macro avg': {'precision': 0.384250405429861, 'recall': 0.34102062505401926, 'f1-score': 0.23030151538354762, 'support': 148072}, 'weighted avg': {'precision': 0.3834938422351329, 'recall': 0.3575827975579448, 'f1-score': 0.2392830276229492, 'support': 148072}}
[[ 5773 43214    11]
 [ 4939 47152    25]
 [ 3336 43599    23]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
5183/5183 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.080481
{'0': {'precision': 0.30172280276595936, 'recall': 0.09052690276517347, 'f1-score': 0.13926858551006205, 'support': 365836}, '1': {'precision': 0.422034863792504, 'recall': 0.9130650504964282, 'f1-score': 0.5772531030760929, 'support': 562317}, '2': {'precision': 0.25680933852140075, 'recall': 0.00033108679239604, 'f1-score': 0.0006613209886748783, 'support': 398687}, 'accuracy': 0.4120180277953634, 'macro avg': {'precision': 0.32685566835995467, 'recall': 0.3346410133513325, 'f1-score': 0.23906100319160994, 'support': 1326840}, 'weighted avg': {'precision': 0.33921572045082954, 'recall': 0.4120180277953634, 'f1-score': 0.2832386387899899, 'support': 1326840}}
[[ 33118 332631     87]
 [ 48590 513432    295]
 [ 28055 370500    132]]
Evaluating performance on  train set...
1489/1489 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1047076
{'0': {'precision': 0.4015579186906481, 'recall': 0.07064874270491676, 'f1-score': 0.12015739885944751, 'support': 129882}, '1': {'precision': 0.33155811985623285, 'recall': 0.943032344157082, 'f1-score': 0.4906203832842606, 'support': 125896}, '2': {'precision': 0.4306569343065693, 'recall': 0.00047091125318264175, 'f1-score': 0.000940793774815429, 'support': 125289}, 'accuracy': 0.33579134377944037, 'macro avg': {'precision': 0.3879243242844834, 'recall': 0.3380506660383938, 'f1-score': 0.20390619197284118, 'support': 381067}, 'weighted avg': {'precision': 0.38799886449137505, 'recall': 0.33579134377944037, 'f1-score': 0.20335347370376047, 'support': 381067}}
[[  9176 120670     36]
 [  7130 118724     42]
 [  6545 118685     59]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0993147
{'0': {'precision': 0.35868635002139493, 'recall': 0.07875513799177922, 'f1-score': 0.12915278393005025, 'support': 42575}, '1': {'precision': 0.3532454056858438, 'recall': 0.9219702098849019, 'f1-score': 0.5107869396271312, 'support': 47264}, '2': {'precision': 0.35555555555555557, 'recall': 0.0003728473889031296, 'f1-score': 0.0007449136365752595, 'support': 42913}, 'accuracy': 0.3536293238519947, 'macro avg': {'precision': 0.35582910375426474, 'recall': 0.3336993984218614, 'f1-score': 0.21356154573125222, 'support': 132752}, 'weighted avg': {'precision': 0.35573714717708327, 'recall': 0.3536293238519947, 'f1-score': 0.22351814036131262, 'support': 132752}}
[[ 3353 39214     8]
 [ 3667 43576    21]
 [ 2328 40569    16]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
7324/7324 - 106s - 106s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0772967
{'0': {'precision': 0.3376001554784053, 'recall': 0.07223309045202385, 'f1-score': 0.11900402326769054, 'support': 529065}, '1': {'precision': 0.4434888709470454, 'recall': 0.9473156320001747, 'f1-score': 0.6041452111723391, 'support': 824533}, '2': {'precision': 0.2796934865900383, 'recall': 0.0001400861241815516, 'f1-score': 0.00028003199269615187, 'support': 521108}, 'accuracy': 0.43707226626468365, 'macro avg': {'precision': 0.35359417100516294, 'recall': 0.33989626952546, 'f1-score': 0.2411430888109086, 'support': 1874706}, 'weighted avg': {'precision': 0.36807592705028114, 'recall': 0.43707226626468365, 'f1-score': 0.299377317768937, 'support': 1874706}}
[[ 38216 490803     46]
 [ 43298 781093    142]
 [ 31685 489350     73]]
Evaluating performance on  train set...
2046/2046 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1053952
{'0': {'precision': 0.3744745365584729, 'recall': 0.06184276414621933, 'f1-score': 0.10615458248273572, 'support': 175736}, '1': {'precision': 0.32791945901689057, 'recall': 0.9486677115987461, 'f1-score': 0.48737228437636615, 'support': 170984}, '2': {'precision': 0.49333333333333335, 'recall': 0.00020900176239323963, 'f1-score': 0.000417826511656795, 'support': 177032}, 'accuracy': 0.3305228428721991, 'macro avg': {'precision': 0.398575776302899, 'recall': 0.3369064925024529, 'f1-score': 0.19798156445691953, 'support': 523752}, 'weighted avg': {'precision': 0.3994513139880143, 'recall': 0.3305228428721991, 'f1-score': 0.19486706120837008, 'support': 523752}}
[[ 10868 164853     15]
 [  8754 162207     23]
 [  9400 167595     37]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.083369
{'0': {'precision': 0.36366531327123636, 'recall': 0.08045227989221367, 'f1-score': 0.13175656186905105, 'support': 56779}, '1': {'precision': 0.40946892655367234, 'recall': 0.9427772357723577, 'f1-score': 0.5709581486952241, 'support': 76875}, '2': {'precision': 0.20689655172413793, 'recall': 0.00010726544622425629, 'f1-score': 0.00021441972661484854, 'support': 55936}, 'accuracy': 0.406403291312833, 'macro avg': {'precision': 0.3266769305163489, 'recall': 0.3411122603702652, 'f1-score': 0.23430971009696333, 'support': 189590}, 'weighted avg': {'precision': 0.3359852421978083, 'recall': 0.406403291312833, 'f1-score': 0.2710343757009132, 'support': 189590}}
[[ 4568 52203     8]
 [ 4384 72476    15]
 [ 3609 52321     6]]
testing model on single stock: results/universal/W6/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
29350/29350 - 418s - 418s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.089097
{'0': {'precision': 0.3178901505291797, 'recall': 0.13350013063167673, 'f1-score': 0.18803407336564085, 'support': 2204672}, '1': {'precision': 0.4155656380075852, 'recall': 0.8832411213348997, 'f1-score': 0.5652028794304816, 'support': 3099199}, '2': {'precision': 0.26990291262135924, 'recall': 6.290922108880021e-05, 'f1-score': 0.00012578912313216726, 'support': 2209533}, 'accuracy': 0.40351923043137305, 'macro avg': {'precision': 0.3344529003860414, 'recall': 0.3389347203958884, 'f1-score': 0.2511209139730849, 'support': 7513404}, 'weighted avg': {'precision': 0.3440682167401017, 'recall': 0.40351923043137305, 'f1-score': 0.2883523354450053, 'support': 7513404}}
[[ 294324 1910218     130]
 [ 361613 2737340     246]
 [ 269930 1939464     139]]
Evaluating performance on  train set...
5452/5452 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105341
{'0': {'precision': 0.35936371052324906, 'recall': 0.13035180233971277, 'f1-score': 0.1913098773952897, 'support': 473135}, '1': {'precision': 0.3264730613248829, 'recall': 0.88677905157202, 'f1-score': 0.4772453616325906, 'support': 450535}, '2': {'precision': 0.30851063829787234, 'recall': 6.146607178813281e-05, 'f1-score': 0.0001229076560874255, 'support': 471805}, 'accuracy': 0.33051684910156043, 'macro avg': {'precision': 0.33144913671533477, 'recall': 0.33906410666117365, 'f1-score': 0.22289271556132262, 'support': 1395475}, 'weighted avg': {'precision': 0.33155158749855873, 'recall': 0.33051684910156043, 'f1-score': 0.21898574054801406, 'support': 1395475}}
[[ 61674 411440     21]
 [ 50966 399525     44]
 [ 58980 412796     29]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981131
{'0': {'precision': 0.34780326492047664, 'recall': 0.12145541196957199, 'f1-score': 0.18003967067902074, 'support': 163665}, '1': {'precision': 0.36220585207794415, 'recall': 0.8948398438795706, 'f1-score': 0.5156793093011772, 'support': 180886}, '2': {'precision': 0.23076923076923078, 'recall': 3.761472491097848e-05, 'f1-score': 7.521718963507127e-05, 'support': 159512}, 'accuracy': 0.3605660403560666, 'macro avg': {'precision': 0.31359278258921724, 'recall': 0.3387776235246846, 'f1-score': 0.231931399056611, 'support': 504063}, 'weighted avg': {'precision': 0.3159360053220378, 'recall': 0.3605660403560666, 'f1-score': 0.24353574511179701, 'support': 504063}}
[[ 19878 143779      8]
 [ 19010 161864     12]
 [ 18265 141241      6]]
training model: results/universal/W6/deepVOL_L3/h500
Epoch 1/50
9426/9426 - 512s - loss: 3.2383 - accuracy500: 0.3990 - val_loss: 3.3241 - val_accuracy500: 0.3124 - 512s/epoch - 54ms/step
Epoch 2/50
9426/9426 - 508s - loss: 3.2350 - accuracy500: 0.4021 - val_loss: 3.3445 - val_accuracy500: 0.3109 - 508s/epoch - 54ms/step
Epoch 3/50
9426/9426 - 494s - loss: 3.2344 - accuracy500: 0.4021 - val_loss: 3.3587 - val_accuracy500: 0.3128 - 494s/epoch - 52ms/step
Epoch 4/50
9426/9426 - 509s - loss: 3.2346 - accuracy500: 0.4020 - val_loss: 3.3614 - val_accuracy500: 0.3122 - 509s/epoch - 54ms/step
Epoch 5/50
9426/9426 - 504s - loss: 3.2348 - accuracy500: 0.4015 - val_loss: 3.3312 - val_accuracy500: 0.3193 - 504s/epoch - 53ms/step
Epoch 6/50
9426/9426 - 516s - loss: 3.2368 - accuracy500: 0.3993 - val_loss: 3.3332 - val_accuracy500: 0.3324 - 516s/epoch - 55ms/step
Epoch 7/50
9426/9426 - 525s - loss: 3.2343 - accuracy500: 0.4010 - val_loss: 3.3344 - val_accuracy500: 0.3320 - 525s/epoch - 56ms/step
Epoch 8/50
9426/9426 - 519s - loss: 3.2331 - accuracy500: 0.4013 - val_loss: 3.3149 - val_accuracy500: 0.3349 - 519s/epoch - 55ms/step
Epoch 9/50
9426/9426 - 512s - loss: 3.2201 - accuracy500: 0.4093 - val_loss: 3.3086 - val_accuracy500: 0.3409 - 512s/epoch - 54ms/step
Epoch 10/50
9426/9426 - 512s - loss: 3.2124 - accuracy500: 0.4120 - val_loss: 3.3213 - val_accuracy500: 0.3281 - 512s/epoch - 54ms/step
Epoch 11/50
9426/9426 - 513s - loss: 3.2072 - accuracy500: 0.4155 - val_loss: 3.3375 - val_accuracy500: 0.3444 - 513s/epoch - 54ms/step
Epoch 12/50
9426/9426 - 502s - loss: 3.2032 - accuracy500: 0.4173 - val_loss: 3.3393 - val_accuracy500: 0.3360 - 502s/epoch - 53ms/step
Epoch 13/50
9426/9426 - 504s - loss: 3.1970 - accuracy500: 0.4197 - val_loss: 3.3296 - val_accuracy500: 0.3430 - 504s/epoch - 53ms/step
Epoch 14/50
9426/9426 - 505s - loss: 3.1923 - accuracy500: 0.4212 - val_loss: 3.3178 - val_accuracy500: 0.3411 - 505s/epoch - 54ms/step
Epoch 15/50
9426/9426 - 510s - loss: 3.1879 - accuracy500: 0.4241 - val_loss: 3.3281 - val_accuracy500: 0.3447 - 510s/epoch - 54ms/step
Epoch 16/50
9426/9426 - 509s - loss: 3.1844 - accuracy500: 0.4254 - val_loss: 3.3302 - val_accuracy500: 0.3376 - 509s/epoch - 54ms/step
Epoch 17/50
9426/9426 - 506s - loss: 3.1814 - accuracy500: 0.4268 - val_loss: 3.3473 - val_accuracy500: 0.3305 - 506s/epoch - 54ms/step
Epoch 18/50
9426/9426 - 518s - loss: 3.1781 - accuracy500: 0.4288 - val_loss: 3.3510 - val_accuracy500: 0.3284 - 518s/epoch - 55ms/step
Epoch 19/50
9426/9426 - 504s - loss: 3.1761 - accuracy500: 0.4295 - val_loss: 3.3569 - val_accuracy500: 0.3277 - 504s/epoch - 53ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1234s - 1234s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1085503
{'0': {'precision': 0.31066164370109545, 'recall': 0.4383112434158079, 'f1-score': 0.36360859965541664, 'support': 3284002}, '1': {'precision': 0.37167396598838287, 'recall': 0.3109236700713506, 'f1-score': 0.33859546963028037, 'support': 4167592}, '2': {'precision': 0.2875746568812534, 'recall': 0.230505474401068, 'f1-score': 0.25589683412898573, 'support': 3367035}, 'accuracy': 0.3245640459618312, 'macro avg': {'precision': 0.32330342219024394, 'recall': 0.3265801292960755, 'f1-score': 0.31936696780489426, 'support': 10818629}, 'weighted avg': {'precision': 0.3269797717743452, 'recall': 0.3245640459618312, 'f1-score': 0.32045028402900927, 'support': 10818629}}
[[1439415 1066040  778547]
 [1727609 1295803 1144180]
 [1466361 1124554  776120]]
Evaluating performance on  train set...
9426/9426 - 273s - 273s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081258
{'0': {'precision': 0.3484984646856657, 'recall': 0.40844174103509007, 'f1-score': 0.3760966020525552, 'support': 810828}, '1': {'precision': 0.31505804069862037, 'recall': 0.35270316782779315, 'f1-score': 0.33281947973360215, 'support': 796066}, '2': {'precision': 0.32242956265769557, 'recall': 0.22850596978784435, 'f1-score': 0.26746171036136696, 'support': 805305}, 'accuracy': 0.3299760923539061, 'macro avg': {'precision': 0.3286620226806605, 'recall': 0.3298836262169092, 'f1-score': 0.32545926404917475, 'support': 2412199}, 'weighted avg': {'precision': 0.328759545256006, 'recall': 0.3299760923539061, 'f1-score': 0.3255470134368017, 'support': 2412199}}
[[331176 302907 176745]
 [305333 280775 209958]
 [313785 307503 184017]]
Evaluating performance on  val set...
3323/3323 - 90s - 90s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021029
{'0': {'precision': 0.3306938091708399, 'recall': 0.4167457755838238, 'f1-score': 0.3687662542756725, 'support': 263350}, '1': {'precision': 0.37900201717182164, 'recall': 0.3600732173240051, 'f1-score': 0.3692952200960706, 'support': 325606}, '2': {'precision': 0.3008193075344726, 'recall': 0.24065889915628766, 'f1-score': 0.2673970715779807, 'support': 261345}, 'accuracy': 0.3409228026310683, 'macro avg': {'precision': 0.3368383779590447, 'recall': 0.3391592973547055, 'f1-score': 0.33515284864990796, 'support': 850301}, 'weighted avg': {'precision': 0.34001038147195595, 'recall': 0.3409228026310683, 'f1-score': 0.3378123983973286, 'support': 850301}}
[[109750  95351  58249]
 [120429 117242  87935]
 [101699  96751  62895]]
testing model out of sample: results/universal/W6/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 498s - 498s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051543
{'0': {'precision': 0.309032811337953, 'recall': 0.3988125436962884, 'f1-score': 0.34822906076523535, 'support': 1293016}, '1': {'precision': 0.3856380394521492, 'recall': 0.3012643099591663, 'f1-score': 0.33826926913010097, 'support': 1857535}, '2': {'precision': 0.2859882067473928, 'recall': 0.2925808037212871, 'f1-score': 0.2892469450348877, 'support': 1334592}, 'accuracy': 0.3268025122052965, 'macro avg': {'precision': 0.32688635251249837, 'recall': 0.33088588579224726, 'f1-score': 0.32524842497674133, 'support': 4485143}, 'weighted avg': {'precision': 0.3339019732521614, 'recall': 0.3268025122052965, 'f1-score': 0.3265535598164884, 'support': 4485143}}
[[515671 433495 343850]
 [666895 559609 631031]
 [486095 458021 390476]]
Evaluating performance on  train set...
5153/5153 - 151s - 151s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081278
{'0': {'precision': 0.35703493556718896, 'recall': 0.34329531874058705, 'f1-score': 0.3500303499759918, 'support': 450178}, '1': {'precision': 0.3227347021116294, 'recall': 0.3636878195432909, 'f1-score': 0.3419895950352831, 'support': 431084}, '2': {'precision': 0.3248428026751672, 'recall': 0.2970803904397592, 'f1-score': 0.3103419448531519, 'support': 437353}, 'accuracy': 0.33463368761920653, 'macro avg': {'precision': 0.3348708134513285, 'recall': 0.33468784290787906, 'f1-score': 0.33412062995480896, 'support': 1318615}, 'weighted avg': {'precision': 0.33514408210679236, 'recall': 0.33463368761920653, 'f1-score': 0.3342379588318368, 'support': 1318615}}
[[154544 167325 128309]
 [132567 156780 141737]
 [145743 161681 129929]]
Evaluating performance on  val set...
1795/1795 - 49s - 49s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033134
{'0': {'precision': 0.3417249351128257, 'recall': 0.3337465803234408, 'f1-score': 0.3376886394135929, 'support': 144385}, '1': {'precision': 0.36930004183455534, 'recall': 0.39549621245615585, 'f1-score': 0.3819494852022328, 'support': 169635}, '2': {'precision': 0.30478672637838633, 'recall': 0.2865633110607985, 'f1-score': 0.29539422659579767, 'support': 144872}, 'accuracy': 0.34167734456037585, 'macro avg': {'precision': 0.3386039011085891, 'recall': 0.33860203461346505, 'f1-score': 0.3383441170705411, 'support': 458892}, 'weighted avg': {'precision': 0.34025703210506986, 'recall': 0.34167734456037585, 'f1-score': 0.34069787121893336, 'support': 458892}}
[[48188 56624 39573]
 [47423 67090 55122]
 [45403 57954 41515]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108426
{'0': {'precision': 0.31912586820260885, 'recall': 0.43308733935673727, 'f1-score': 0.36747393369551434, 'support': 86994}, '1': {'precision': 0.3011594682711616, 'recall': 0.516095611633242, 'f1-score': 0.3803636925566196, 'support': 81078}, '2': {'precision': 0.41396473265073946, 'recall': 0.05652701587455702, 'f1-score': 0.0994712068273264, 'support': 102995}, 'accuracy': 0.3148372911494206, 'macro avg': {'precision': 0.34475002304150326, 'recall': 0.3352366556215121, 'f1-score': 0.28243627769315344, 'support': 271067}, 'weighted avg': {'precision': 0.3497871035067711, 'recall': 0.3148372911494206, 'f1-score': 0.2694986545768894, 'support': 271067}}
[[37676 45487  3831]
 [34823 41844  4411]
 [45561 51612  5822]]
Evaluating performance on  train set...
211/211 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056795
{'0': {'precision': 0.34290229128259153, 'recall': 0.3576726553486072, 'f1-score': 0.3501317700209756, 'support': 18201}, '1': {'precision': 0.3364835232712561, 'recall': 0.60581628113879, 'f1-score': 0.4326588964120485, 'support': 17984}, '2': {'precision': 0.27360308285163776, 'recall': 0.039945988522561045, 'f1-score': 0.06971378074525013, 'support': 17774}, 'accuracy': 0.3357178598565578, 'macro avg': {'precision': 0.31766296580182846, 'recall': 0.33447830833665276, 'f1-score': 0.2841681490594248, 'support': 53959}, 'weighted avg': {'precision': 0.31793594174743284, 'recall': 0.3357178598565578, 'f1-score': 0.2852680494114445, 'support': 53959}}
[[ 6510 10764   927]
 [ 6131 10895   958]
 [ 6344 10720   710]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1076778
{'0': {'precision': 0.3312035467466423, 'recall': 0.3689715281812899, 'f1-score': 0.3490689204974919, 'support': 6884}, '1': {'precision': 0.323342939481268, 'recall': 0.5887556221889055, 'f1-score': 0.41743289928248734, 'support': 6670}, '2': {'precision': 0.3487241798298906, 'recall': 0.04051955386135818, 'f1-score': 0.07260308626359727, 'support': 7083}, 'accuracy': 0.3272762513931288, 'macro avg': {'precision': 0.3344235553526003, 'recall': 0.3327489014105179, 'f1-score': 0.2797016353478588, 'support': 20637}, 'weighted avg': {'precision': 0.33467635741043067, 'recall': 0.3272762513931288, 'f1-score': 0.276276374808547, 'support': 20637}}
[[2540 4059  285]
 [2492 3927  251]
 [2637 4159  287]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123235
{'0': {'precision': 0.4000353436147002, 'recall': 0.29867954976808386, 'f1-score': 0.3420060956299157, 'support': 197054}, '1': {'precision': 0.2934277627163177, 'recall': 0.47881898203787315, 'f1-score': 0.36387018423806794, 'support': 153935}, '2': {'precision': 0.3933169624817382, 'recall': 0.3038965156158435, 'f1-score': 0.34287247216433947, 'support': 208186}, 'accuracy': 0.350212366432691, 'macro avg': {'precision': 0.36226002293758536, 'recall': 0.36046501580726686, 'f1-score': 0.3495829173441077, 'support': 559175}, 'weighted avg': {'precision': 0.3681860820058312, 'recall': 0.350212366432691, 'f1-score': 0.3483476093690697, 'support': 559175}}
[[58856 81639 56559]
 [39199 73707 41029]
 [49072 95847 63267]]
Evaluating performance on  train set...
533/533 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044447
{'0': {'precision': 0.4188391769958475, 'recall': 0.28110135574041867, 'f1-score': 0.3364178954759755, 'support': 47723}, '1': {'precision': 0.32375710656828355, 'recall': 0.4919471568064331, 'f1-score': 0.3905125796773693, 'support': 43525}, '2': {'precision': 0.35946889186281455, 'recall': 0.3042464353928841, 'f1-score': 0.3295603536416672, 'support': 45026}, 'accuracy': 0.35609140408295054, 'macro avg': {'precision': 0.3673550584756486, 'recall': 0.35909831597991193, 'f1-score': 0.3521636095983373, 'support': 136274}, 'weighted avg': {'precision': 0.36885419399278263, 'recall': 0.35609140408295054, 'f1-score': 0.3514295884712211, 'support': 136274}}
[[13415 21948 12360]
 [10063 21412 12050]
 [ 8551 22776 13699]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1072946
{'0': {'precision': 0.37700098007187194, 'recall': 0.2794865584887382, 'f1-score': 0.32100139082058415, 'support': 16516}, '1': {'precision': 0.3873407011792079, 'recall': 0.41430995475113125, 'f1-score': 0.4003716760952147, 'support': 17680}, '2': {'precision': 0.31295829178154516, 'recall': 0.3809081822076253, 'f1-score': 0.34360609280906834, 'support': 14006}, 'accuracy': 0.35840836479814114, 'macro avg': {'precision': 0.359099991010875, 'recall': 0.3582348984824983, 'f1-score': 0.3549930532416224, 'support': 48202}, 'weighted avg': {'precision': 0.36218467321703984, 'recall': 0.35840836479814114, 'f1-score': 0.35668182108709123, 'support': 48202}}
[[4616 6335 5565]
 [4208 7325 6147]
 [3420 5251 5335]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1227139
{'0': {'precision': 0.39271143708457484, 'recall': 0.22150115055459316, 'f1-score': 0.28324406533095287, 'support': 116031}, '1': {'precision': 0.26347974817883013, 'recall': 0.6070457809588244, 'f1-score': 0.3674660056402795, 'support': 84249}, '2': {'precision': 0.3029757947835608, 'recall': 0.14034070840540858, 'f1-score': 0.19182609879737317, 'support': 110417}, 'accuracy': 0.2972027409340933, 'macro avg': {'precision': 0.3197223266823219, 'recall': 0.3229625466396087, 'f1-score': 0.2808453899228685, 'support': 310697}, 'weighted avg': {'precision': 0.32577811949679264, 'recall': 0.2972027409340933, 'f1-score': 0.27359323715553496, 'support': 310697}}
[[25701 71037 19293]
 [16749 51143 16357]
 [22995 71926 15496]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105771
{'0': {'precision': 0.36878580410786643, 'recall': 0.280649894732365, 'f1-score': 0.31873732006569416, 'support': 47023}, '1': {'precision': 0.2973025903488615, 'recall': 0.5641413140422158, 'f1-score': 0.3893943021307158, 'support': 40364}, '2': {'precision': 0.32120755529247164, 'recall': 0.13698850205402427, 'f1-score': 0.1920651264560139, 'support': 43573}, 'accuracy': 0.3202275503970678, 'macro avg': {'precision': 0.32909864991639987, 'recall': 0.327259903609535, 'f1-score': 0.3000655828841413, 'support': 130960}, 'weighted avg': {'precision': 0.3309232852028445, 'recall': 0.3202275503970678, 'f1-score': 0.29836858863562343, 'support': 130960}}
[[13197 28004  5822]
 [10801 22771  6792]
 [11787 25817  5969]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077137
{'0': {'precision': 0.3472740851381628, 'recall': 0.29074614422676115, 'f1-score': 0.316505955757232, 'support': 14394}, '1': {'precision': 0.309846215298582, 'recall': 0.569154009831976, 'f1-score': 0.4012518104696875, 'support': 13629}, '2': {'precision': 0.33641313314634547, 'recall': 0.13481883099709072, 'f1-score': 0.19249468963889543, 'support': 15124}, 'accuracy': 0.32403179827102696, 'macro avg': {'precision': 0.3311778111943634, 'recall': 0.33157299501860926, 'f1-score': 0.30341748528860496, 'support': 43147}, 'weighted avg': {'precision': 0.3316445981293814, 'recall': 0.32403179827102696, 'f1-score': 0.29980618207893067, 'support': 43147}}
[[4185 8352 1857]
 [3707 7757 2165]
 [4159 8926 2039]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1095/1095 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084937
{'0': {'precision': 0.358437774470256, 'recall': 0.6837521946325558, 'f1-score': 0.47032234467624057, 'support': 99675}, '1': {'precision': 0.2689987413740723, 'recall': 0.17899844047825333, 'f1-score': 0.21495829503875702, 'support': 69252}, '2': {'precision': 0.4127610103036382, 'recall': 0.16288839711412173, 'f1-score': 0.23359349803263885, 'support': 111162}, 'accuracy': 0.3522308980359814, 'macro avg': {'precision': 0.3467325087159889, 'recall': 0.3418796774083102, 'f1-score': 0.3062913792492121, 'support': 280089}, 'weighted avg': {'precision': 0.3578838349072368, 'recall': 0.3522308980359814, 'f1-score': 0.3132304088412343, 'support': 280089}}
[[68153 16441 15081]
 [46176 12396 10680]
 [75810 17245 18107]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1109208
{'0': {'precision': 0.31819372756569814, 'recall': 0.6674085675816778, 'f1-score': 0.4309349135522102, 'support': 36393}, '1': {'precision': 0.3458813577244369, 'recall': 0.173174153585515, 'f1-score': 0.23079501155386217, 'support': 37777}, '2': {'precision': 0.3595464899565127, 'recall': 0.1719314749715304, 'f1-score': 0.23262435102997822, 'support': 40394}, 'accuracy': 0.32973709018539854, 'macro avg': {'precision': 0.3412071917488826, 'recall': 0.33750473204624104, 'f1-score': 0.2981180920453502, 'support': 114564}, 'weighted avg': {'precision': 0.3419041347487682, 'recall': 0.32973709018539854, 'f1-score': 0.29501750546315403, 'support': 114564}}
[[24289  5843  6261]
 [25125  6542  6110]
 [26920  6529  6945]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1100317
{'0': {'precision': 0.33262305561474537, 'recall': 0.676871043274651, 'f1-score': 0.44605097725454335, 'support': 11531}, '1': {'precision': 0.3126346015793252, 'recall': 0.1735232592887738, 'f1-score': 0.2231759656652361, 'support': 10039}, '2': {'precision': 0.400278940027894, 'recall': 0.17389987124138453, 'f1-score': 0.24246264322297906, 'support': 13203}, 'accuracy': 0.3405803353176315, 'macro avg': {'precision': 0.34851219907398817, 'recall': 0.34143139126826977, 'f1-score': 0.3038965287142528, 'support': 34773}, 'weighted avg': {'precision': 0.352540708731969, 'recall': 0.3405803353176315, 'f1-score': 0.30440605114624675, 'support': 34773}}
[[7805 1876 1850]
 [6707 1742 1590]
 [8953 1954 2296]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
1722/1722 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1119184
{'0': {'precision': 0.3438859120071125, 'recall': 0.38370947309154035, 'f1-score': 0.3627078587969929, 'support': 149191}, '1': {'precision': 0.28644253726527713, 'recall': 0.5145871169674253, 'f1-score': 0.3680254248998203, 'support': 129395}, '2': {'precision': 0.30215397841245584, 'recall': 0.0780023795873327, 'f1-score': 0.12399492378325144, 'support': 162213}, 'accuracy': 0.30962865160764885, 'macro avg': {'precision': 0.31082747589494847, 'recall': 0.32543298988209945, 'f1-score': 0.2849094024933549, 'support': 440799}, 'weighted avg': {'precision': 0.3116663570196696, 'recall': 0.30962865160764885, 'f1-score': 0.2764230104613372, 'support': 440799}}
[[57246 78719 13226]
 [46813 66585 15997]
 [62409 87151 12653]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054224
{'0': {'precision': 0.3591912080364042, 'recall': 0.30881945854171666, 'f1-score': 0.33210617712726365, 'support': 54187}, '1': {'precision': 0.32705026455026454, 'recall': 0.655209368484636, 'f1-score': 0.436313149989944, 'support': 51321}, '2': {'precision': 0.29734471868054746, 'recall': 0.0484698255315092, 'f1-score': 0.08335246089779323, 'support': 52445}, 'accuracy': 0.33492241362937075, 'macro avg': {'precision': 0.32786206375573873, 'recall': 0.3374995508526206, 'f1-score': 0.28392392933833366, 'support': 157953}, 'weighted avg': {'precision': 0.3282133570622532, 'recall': 0.33492241362937075, 'f1-score': 0.28337090401837073, 'support': 157953}}
[[16734 34886  2567]
 [14255 33626  3440]
 [15599 34304  2542]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1086785
{'0': {'precision': 0.33080883080883083, 'recall': 0.3454103783336779, 'f1-score': 0.3379519595448799, 'support': 19348}, '1': {'precision': 0.31374202095628084, 'recall': 0.574547860608734, 'f1-score': 0.40585806652644696, 'support': 18136}, '2': {'precision': 0.30853174603174605, 'recall': 0.06231840496944194, 'f1-score': 0.10369258981412019, 'support': 19962}, 'accuracy': 0.3193781986561292, 'macro avg': {'precision': 0.31769419926561926, 'recall': 0.32742554797061796, 'f1-score': 0.28250087196181567, 'support': 57446}, 'weighted avg': {'precision': 0.31767965158301853, 'recall': 0.3193781986561292, 'f1-score': 0.27798711634695966, 'support': 57446}}
[[ 6683 11464  1201]
 [ 6129 10420  1587]
 [ 7390 11328  1244]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
4450/4450 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0910938
{'0': {'precision': 0.27514165402359353, 'recall': 0.25646575826776485, 'f1-score': 0.2654756547733524, 'support': 277191}, '1': {'precision': 0.5145731162180179, 'recall': 0.34040302000058115, 'f1-score': 0.4097476768098662, 'support': 585033}, '2': {'precision': 0.251159031942495, 'recall': 0.4478380047454469, 'f1-score': 0.3218284308382255, 'support': 276897}, 'accuracy': 0.34609317184039273, 'macro avg': {'precision': 0.3469579340613688, 'recall': 0.34823559433793094, 'f1-score': 0.3323505874738147, 'support': 1139121}, 'weighted avg': {'precision': 0.39227986016288935, 'recall': 0.34609317184039273, 'f1-score': 0.35326949625474285, 'support': 1139121}}
[[ 71090  94138 111963]
 [128123 199147 257763]
 [ 59163  93729 124005]]
Evaluating performance on  train set...
1504/1504 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1118342
{'0': {'precision': 0.380989380989381, 'recall': 0.17218372506789026, 'f1-score': 0.23717773012366775, 'support': 128148}, '1': {'precision': 0.32928858384508447, 'recall': 0.4715264279892156, 'f1-score': 0.3877756221438746, 'support': 127592}, '2': {'precision': 0.3461906545167062, 'recall': 0.386739903469968, 'f1-score': 0.36534358910555953, 'support': 129079}, 'accuracy': 0.3434030024505027, 'macro avg': {'precision': 0.35215620645039053, 'recall': 0.34348335217569126, 'f1-score': 0.33009898045770064, 'support': 384819}, 'weighted avg': {'precision': 0.3521748138198767, 'recall': 0.3434030024505027, 'f1-score': 0.3301009151799302, 'support': 384819}}
[[22065 59947 46136]
 [19287 60163 48142]
 [16563 62596 49920]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0782422
{'0': {'precision': 0.30033630069238376, 'recall': 0.23712241901727424, 'f1-score': 0.26501186985057956, 'support': 32013}, '1': {'precision': 0.4914307455510783, 'recall': 0.4561595017176614, 'f1-score': 0.473138689777467, 'support': 62294}, '2': {'precision': 0.29875772467466727, 'recall': 0.39125510993260415, 'f1-score': 0.3388067019864382, 'support': 36204}, 'accuracy': 0.3844273662756396, 'macro avg': {'precision': 0.3635082569727098, 'recall': 0.36151234355584655, 'f1-score': 0.3589857538714949, 'support': 130511}, 'weighted avg': {'precision': 0.39110938941197143, 'recall': 0.3844273662756396, 'f1-score': 0.3848233817014745, 'support': 130511}}
[[ 7591 13172 11250]
 [11880 28416 21998]
 [ 5804 16235 14165]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
6203/6203 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957347
{'0': {'precision': 0.25563755428634655, 'recall': 0.5215215363870194, 'f1-score': 0.34309703552234233, 'support': 336686}, '1': {'precision': 0.6095416338144982, 'recall': 0.2531332636926626, 'f1-score': 0.3577135803299319, 'support': 882626}, '2': {'precision': 0.2636856226588782, 'recall': 0.38238071206472724, 'f1-score': 0.31212985643856, 'support': 368562}, 'accuracy': 0.3400408344742719, 'macro avg': {'precision': 0.376288270253241, 'recall': 0.38567850404813636, 'f1-score': 0.33764682409694474, 'support': 1587874}, 'weighted avg': {'precision': 0.45422456702988373, 'recall': 0.3400408344742719, 'f1-score': 0.3440338963940907, 'support': 1587874}}
[[175589  66838  94259]
 [359928 223422 299276]
 [151350  76281 140931]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1100162
{'0': {'precision': 0.3579435663677352, 'recall': 0.3699661368481023, 'f1-score': 0.36385556580343176, 'support': 156217}, '1': {'precision': 0.32761779489829473, 'recall': 0.2841099666623665, 'f1-score': 0.30431668018167074, 'support': 147281}, '2': {'precision': 0.33342956297411014, 'recall': 0.3655660536186891, 'f1-score': 0.34875906687482733, 'support': 148493}, 'accuracy': 0.34054439137062464, 'macro avg': {'precision': 0.33966364141338, 'recall': 0.3398807190430526, 'f1-score': 0.33897710428664324, 'support': 451991}, 'weighted avg': {'precision': 0.3400083246179654, 'recall': 0.34054439137062464, 'f1-score': 0.33949518909534715, 'support': 451991}}
[[57795 44477 53945]
 [50861 41844 54576]
 [52808 41401 54284]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966301
{'0': {'precision': 0.3417946127116347, 'recall': 0.3151114443459887, 'f1-score': 0.3279111006029082, 'support': 44013}, '1': {'precision': 0.44077216098341954, 'recall': 0.3921157749983629, 'f1-score': 0.4150227420402859, 'support': 61084}, '2': {'precision': 0.3052263235128118, 'recall': 0.377521815008726, 'f1-score': 0.3375464219954436, 'support': 42975}, 'accuracy': 0.36499135555675616, 'macro avg': {'precision': 0.3625976990692887, 'recall': 0.3615830114510259, 'f1-score': 0.36016008821287926, 'support': 148072}, 'weighted avg': {'precision': 0.372012495432975, 'recall': 0.36499135555675616, 'f1-score': 0.36664364586740783, 'support': 148072}}
[[13869 14992 15152]
 [15354 23952 21778]
 [11354 15397 16224]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
5183/5183 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114587
{'0': {'precision': 0.31908132000306594, 'recall': 0.3884550231129231, 'f1-score': 0.35036713730017854, 'support': 417948}, '1': {'precision': 0.3155356802286358, 'recall': 0.24808311213961837, 'f1-score': 0.2777731140343733, 'support': 446818}, '2': {'precision': 0.3263205934153522, 'recall': 0.3296030505936279, 'f1-score': 0.327953608758005, 'support': 462074}, 'accuracy': 0.32068900545657353, 'macro avg': {'precision': 0.32031253121568465, 'recall': 0.32204706194872307, 'f1-score': 0.3186979533641856, 'support': 1326840}, 'weighted avg': {'precision': 0.3204084011507382, 'recall': 0.32068900545657353, 'f1-score': 0.3181153020561575, 'support': 1326840}}
[[162354 110537 145057]
 [166606 110848 169364]
 [179857 129916 152301]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051911
{'0': {'precision': 0.3661276417879255, 'recall': 0.3242211597779149, 'f1-score': 0.3439024689489893, 'support': 129680}, '1': {'precision': 0.3386783606898969, 'recall': 0.27920232369292275, 'f1-score': 0.3060778162488819, 'support': 128072}, '2': {'precision': 0.3209792778044059, 'recall': 0.4181567530308559, 'f1-score': 0.3631798396979899, 'support': 123315}, 'accuracy': 0.3394888562903636, 'macro avg': {'precision': 0.34192842676074275, 'recall': 0.3405267455005645, 'f1-score': 0.3377200416319537, 'support': 381067}, 'weighted avg': {'precision': 0.34229205688182124, 'recall': 0.3394888562903636, 'f1-score': 0.3374283057527662, 'support': 381067}}
[[42045 34919 52716]
 [35946 35758 56368]
 [36846 34904 51565]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058477
{'0': {'precision': 0.3497911040325001, 'recall': 0.35636346533722135, 'f1-score': 0.3530466993604902, 'support': 42524}, '1': {'precision': 0.35587335703066875, 'recall': 0.2691297824456114, 'f1-score': 0.30648204178976973, 'support': 47988}, '2': {'precision': 0.32566148518950655, 'recall': 0.40968276515151514, 'f1-score': 0.3628719411184969, 'support': 42240}, 'accuracy': 0.3417952271905508, 'macro avg': {'precision': 0.34377531541755846, 'recall': 0.345058670978116, 'f1-score': 0.34080022742291893, 'support': 132752}, 'weighted avg': {'precision': 0.34431201563419395, 'recall': 0.3417952271905508, 'f1-score': 0.3393404909745862, 'support': 132752}}
[[15154 11608 15762]
 [15002 12915 20071]
 [13167 11768 17305]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
7324/7324 - 107s - 107s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077737
{'0': {'precision': 0.3468118343344806, 'recall': 0.36345623508145813, 'f1-score': 0.35493901251272003, 'support': 604114}, '1': {'precision': 0.34023208333253, 'recall': 0.2594521800622476, 'f1-score': 0.29440144134525553, 'support': 680187}, '2': {'precision': 0.29836797591941416, 'recall': 0.3653288844098542, 'f1-score': 0.3284705602861775, 'support': 590405}, 'accuracy': 0.3263108988822781, 'macro avg': {'precision': 0.328470631195475, 'recall': 0.32941243318451996, 'f1-score': 0.3259370047147177, 'support': 1874706}, 'weighted avg': {'precision': 0.3291680238797687, 'recall': 0.3263108988822781, 'f1-score': 0.3246388078638332, 'support': 1874706}}
[[219569 171861 212684]
 [209181 176476 294530]
 [204357 170356 215692]]
Evaluating performance on  train set...
2046/2046 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068182
{'0': {'precision': 0.35633229815487755, 'recall': 0.34773990260670296, 'f1-score': 0.35198367020304966, 'support': 174550}, '1': {'precision': 0.32590714408086346, 'recall': 0.2731115118242273, 'f1-score': 0.2971827069384083, 'support': 174134}, '2': {'precision': 0.3200794270456802, 'recall': 0.37934973838736946, 'f1-score': 0.3472032706493724, 'support': 175068}, 'accuracy': 0.3334937145824741, 'macro avg': {'precision': 0.3341062897604737, 'recall': 0.3334003842727666, 'f1-score': 0.33212321593027677, 'support': 523752}, 'weighted avg': {'precision': 0.3340989292725261, 'recall': 0.3334937145824741, 'f1-score': 0.3321658825360083, 'support': 523752}}
[[60698 49050 64802]
 [50304 47558 76272]
 [59339 49317 66412]]
Evaluating performance on  val set...
741/741 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050874
{'0': {'precision': 0.3412239230336893, 'recall': 0.34549593278211094, 'f1-score': 0.34334664005322685, 'support': 59746}, '1': {'precision': 0.3672679509632224, 'recall': 0.2990900792971647, 'f1-score': 0.3296912338070683, 'support': 70116}, '2': {'precision': 0.3005028057114284, 'recall': 0.36222542191267076, 'f1-score': 0.32848987276426467, 'support': 59728}, 'accuracy': 0.333604093042882, 'macro avg': {'precision': 0.3363315599027801, 'recall': 0.3356038113306488, 'f1-score': 0.3338425822081866, 'support': 189590}, 'weighted avg': {'precision': 0.33802708863779896, 'recall': 0.333604093042882, 'f1-score': 0.3336160241927343, 'support': 189590}}
[[20642 18119 20985]
 [19769 20971 29376]
 [20083 18010 21635]]
testing model on single stock: results/universal/W6/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
29350/29350 - 409s - 409s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1103727
{'0': {'precision': 0.30591379738734115, 'recall': 0.47107717088093454, 'f1-score': 0.3709412646786773, 'support': 2292134}, '1': {'precision': 0.3671861743783854, 'recall': 0.3090837114092992, 'f1-score': 0.3356389747352558, 'support': 2912554}, '2': {'precision': 0.27281515185733224, 'recall': 0.1810400239786964, 'f1-score': 0.21764855514987974, 'support': 2308716}, 'accuracy': 0.31915826701186306, 'macro avg': {'precision': 0.31530504120768627, 'recall': 0.3204003020896434, 'f1-score': 0.30807626485460426, 'support': 7513404}, 'weighted avg': {'precision': 0.3194953556505883, 'recall': 0.31915826701186306, 'f1-score': 0.31015268510058464, 'support': 7513404}}
[[1079772  762812  449550]
 [1347788  900223  664543]
 [1102101  788645  417970]]
Evaluating performance on  train set...
5452/5452 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078943
{'0': {'precision': 0.3430707788613738, 'recall': 0.49044113256157174, 'f1-score': 0.4037279348445333, 'support': 468884}, '1': {'precision': 0.3040377978604181, 'recall': 0.34214550206926597, 'f1-score': 0.32196797722351067, 'support': 459100}, '2': {'precision': 0.2944617878225509, 'recall': 0.13135012224834275, 'f1-score': 0.18166514798291186, 'support': 467491}, 'accuracy': 0.3213558107454451, 'macro avg': {'precision': 0.3138567881814476, 'recall': 0.32131225229306015, 'f1-score': 0.30245368668365197, 'support': 1395475}, 'weighted avg': {'precision': 0.31394499200939213, 'recall': 0.3213558107454451, 'f1-score': 0.3024374417604309, 'support': 1395475}}
[[229960 179154  59770]
 [214663 157079  87358]
 [225676 180410  61405]]
Evaluating performance on  val set...
1969/1969 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062256
{'0': {'precision': 0.328018402891883, 'recall': 0.46565816155157186, 'f1-score': 0.384903506764938, 'support': 160766}, '1': {'precision': 0.35304512464499843, 'recall': 0.35781562325097943, 'f1-score': 0.3554143668347695, 'support': 187605}, '2': {'precision': 0.2771943335900488, 'recall': 0.15257688256300903, 'f1-score': 0.19681842661253576, 'support': 155692}, 'accuracy': 0.3288180247310356, 'macro avg': {'precision': 0.3194192870423101, 'recall': 0.3253502224551868, 'f1-score': 0.31237876673741444, 'support': 504063}, 'weighted avg': {'precision': 0.3216347507229122, 'recall': 0.3288180247310356, 'f1-score': 0.31583346513187416, 'support': 504063}}
[[74862 62041 23863]
 [82397 67128 38080]
 [70966 60971 23755]]
training model: results/universal/W6/deepVOL_L3/h1000
Epoch 1/50
9426/9426 - 508s - loss: 3.2391 - accuracy1000: 0.3933 - val_loss: 3.2993 - val_accuracy1000: 0.3589 - 508s/epoch - 54ms/step
Epoch 2/50
9426/9426 - 513s - loss: 3.2367 - accuracy1000: 0.3936 - val_loss: 3.3114 - val_accuracy1000: 0.3395 - 513s/epoch - 54ms/step
Epoch 3/50
9426/9426 - 520s - loss: 3.2372 - accuracy1000: 0.3938 - val_loss: 3.3146 - val_accuracy1000: 0.3431 - 520s/epoch - 55ms/step
Epoch 4/50
9426/9426 - 510s - loss: 3.2329 - accuracy1000: 0.3993 - val_loss: 3.3181 - val_accuracy1000: 0.3365 - 510s/epoch - 54ms/step
Epoch 5/50
9426/9426 - 508s - loss: 3.2226 - accuracy1000: 0.4047 - val_loss: 3.3377 - val_accuracy1000: 0.3502 - 508s/epoch - 54ms/step
Epoch 6/50
9426/9426 - 517s - loss: 3.2050 - accuracy1000: 0.4141 - val_loss: 3.3855 - val_accuracy1000: 0.3558 - 517s/epoch - 55ms/step
Epoch 7/50
9426/9426 - 503s - loss: 3.1891 - accuracy1000: 0.4214 - val_loss: 3.3901 - val_accuracy1000: 0.3530 - 503s/epoch - 53ms/step
Epoch 8/50
9426/9426 - 509s - loss: 3.1788 - accuracy1000: 0.4263 - val_loss: 3.4304 - val_accuracy1000: 0.3546 - 509s/epoch - 54ms/step
Epoch 9/50
9426/9426 - 515s - loss: 3.1742 - accuracy1000: 0.4289 - val_loss: 3.4364 - val_accuracy1000: 0.3541 - 515s/epoch - 55ms/step
Epoch 10/50
9426/9426 - 515s - loss: 3.1697 - accuracy1000: 0.4308 - val_loss: 3.4457 - val_accuracy1000: 0.3545 - 515s/epoch - 55ms/step
Epoch 11/50
9426/9426 - 517s - loss: 3.1650 - accuracy1000: 0.4328 - val_loss: 3.4671 - val_accuracy1000: 0.3576 - 517s/epoch - 55ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1242s - 1242s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015688
{'0': {'precision': 0.3029322798291229, 'recall': 0.194399882707263, 'f1-score': 0.2368236124793829, 'support': 3273860}, '1': {'precision': 0.3867952119488152, 'recall': 0.7190016085597065, 'f1-score': 0.5029972494341198, 'support': 4149675}, '2': {'precision': 0.2865552060653266, 'recall': 0.08474051086656216, 'f1-score': 0.1308005099229478, 'support': 3395094}, 'accuracy': 0.3612068590206763, 'macro avg': {'precision': 0.3254275659477549, 'recall': 0.33271400071117724, 'f1-score': 0.2902071239454835, 'support': 10818629}, 'weighted avg': {'precision': 0.3299599381369142, 'recall': 0.3612068590206763, 'f1-score': 0.30564709164475684, 'support': 10818629}}
[[ 636438 2338564  298858]
 [ 748610 2983623  417442]
 [ 715877 2391515  287702]]
Evaluating performance on  train set...
9426/9426 - 274s - 274s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1061686
{'0': {'precision': 0.34945347841532354, 'recall': 0.21044795314695, 'f1-score': 0.2626954142531326, 'support': 808656}, '1': {'precision': 0.3342340067635256, 'recall': 0.7206524314324456, 'f1-score': 0.45666820791338353, 'support': 793524}, '2': {'precision': 0.3250275356096104, 'recall': 0.08597699560133774, 'f1-score': 0.13598337184792933, 'support': 810019}, 'accuracy': 0.33648882202504854, 'macro avg': {'precision': 0.3362383402628198, 'recall': 0.3390257933935778, 'f1-score': 0.2851156646714818, 'support': 2412199}, 'weighted avg': {'precision': 0.3362445790713796, 'recall': 0.33648882202504854, 'f1-score': 0.2839552295666439, 'support': 2412199}}
[[170180 569524  68952]
 [145996 571855  75673]
 [170813 569563  69643]]
Evaluating performance on  val set...
3323/3323 - 94s - 94s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996515
{'0': {'precision': 0.3354718106050255, 'recall': 0.19995557941105702, 'f1-score': 0.2505641717865401, 'support': 270145}, '1': {'precision': 0.3688042148868485, 'recall': 0.7373761192872741, 'f1-score': 0.4916873177881815, 'support': 309572}, '2': {'precision': 0.3194756447806182, 'recall': 0.08304260414510836, 'f1-score': 0.13182055508949367, 'support': 270584}, 'accuracy': 0.35841190354944896, 'macro avg': {'precision': 0.34125055675749744, 'recall': 0.34012476761447985, 'f1-score': 0.2913573482214051, 'support': 850301}, 'weighted avg': {'precision': 0.342516930538909, 'recall': 0.35841190354944896, 'f1-score': 0.30056393866164255, 'support': 850301}}
[[ 54017 195139  20989]
 [ 54426 228271  26875]
 [ 52575 195539  22470]]
testing model out of sample: results/universal/W6/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 526s - 526s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996578
{'0': {'precision': 0.3331976207647985, 'recall': 0.18739368863017164, 'f1-score': 0.23987773161438003, 'support': 1375676}, '1': {'precision': 0.3779522838988131, 'recall': 0.7482854471452635, 'f1-score': 0.5022317863469423, 'support': 1659908}, '2': {'precision': 0.3130829579270516, 'recall': 0.09181413105641095, 'f1-score': 0.14198886834583876, 'support': 1449559}, 'accuracy': 0.36408382073882595, 'macro avg': {'precision': 0.3414109541968877, 'recall': 0.3424977556106153, 'f1-score': 0.29469946210238707, 'support': 4485143}, 'weighted avg': {'precision': 0.3432600051358284, 'recall': 0.36408382073882595, 'f1-score': 0.3053356025300531, 'support': 4485143}}
[[ 257793  996992  120891]
 [ 246709 1242085  171114]
 [ 269192 1047277  133090]]
Evaluating performance on  train set...
5153/5153 - 149s - 149s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067858
{'0': {'precision': 0.3469396782644169, 'recall': 0.1577149343003394, 'f1-score': 0.21685155431580308, 'support': 447567}, '1': {'precision': 0.3334487328313284, 'recall': 0.7409540506175968, 'f1-score': 0.45992097762733103, 'support': 438069}, '2': {'precision': 0.31241268362897423, 'recall': 0.10226131059474015, 'f1-score': 0.15408600934392427, 'support': 432979}, 'accuracy': 0.333269377339102, 'macro avg': {'precision': 0.3309336982415732, 'recall': 0.33364343183755873, 'f1-score': 0.2769528470956861, 'support': 1318615}, 'weighted avg': {'precision': 0.3311204826802722, 'recall': 0.333269377339102, 'f1-score': 0.27699421635459276, 'support': 1318615}}
[[ 70588 331222  45757]
 [ 61788 324589  51692]
 [ 71083 317619  44277]]
Evaluating performance on  val set...
1795/1795 - 53s - 53s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015265
{'0': {'precision': 0.34965456904093883, 'recall': 0.1575648816564025, 'f1-score': 0.21723646723646722, 'support': 147114}, '1': {'precision': 0.3653813427536955, 'recall': 0.7500858325151637, 'f1-score': 0.4913947711618785, 'support': 166021}, '2': {'precision': 0.2947890914709518, 'recall': 0.10471538245161467, 'f1-score': 0.1545362040772934, 'support': 145757}, 'accuracy': 0.3551445656058506, 'macro avg': {'precision': 0.33660833442186205, 'recall': 0.3374553655410603, 'f1-score': 0.28772248082521307, 'support': 458892}, 'weighted avg': {'precision': 0.3379174877329121, 'recall': 0.3551445656058506, 'f1-score': 0.2965079156790398, 'support': 458892}}
[[ 23180 108774  15160]
 [ 20138 124530  21353]
 [ 22976 107518  15263]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1198655
{'0': {'precision': 0.27760193632470676, 'recall': 0.31260174633713184, 'f1-score': 0.29406407527075074, 'support': 81084}, '1': {'precision': 0.3280475305110603, 'recall': 0.6265393457922651, 'f1-score': 0.43062541557476436, 'support': 87862}, '2': {'precision': 0.3329986613119143, 'recall': 0.038973374722143336, 'f1-score': 0.06977987779755068, 'support': 102121}, 'accuracy': 0.31127359656468695, 'macro avg': {'precision': 0.3128827093825604, 'recall': 0.32603815561718014, 'f1-score': 0.2648231228810219, 'support': 271067}, 'weighted avg': {'precision': 0.3148230652294425, 'recall': 0.31127359656468695, 'f1-score': 0.25383205127532, 'support': 271067}}
[[25347 51933  3804]
 [28645 55049  4168]
 [37315 60826  3980]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106273
{'0': {'precision': 0.3379113218070273, 'recall': 0.26105455916410836, 'f1-score': 0.29455197350429946, 'support': 18567}, '1': {'precision': 0.33952291343812263, 'recall': 0.6717218724336163, 'f1-score': 0.45105788496534993, 'support': 18265}, '2': {'precision': 0.3144581776372521, 'recall': 0.06387575173702341, 'f1-score': 0.10618266524313305, 'support': 17127}, 'accuracy': 0.337478455864638, 'macro avg': {'precision': 0.330630804294134, 'recall': 0.332217394444916, 'f1-score': 0.2839308412375941, 'support': 53959}, 'weighted avg': {'precision': 0.33101263430255573, 'recall': 0.337478455864638, 'f1-score': 0.28773901051846, 'support': 53959}}
[[ 4847 12530  1190]
 [ 4801 12269  1195]
 [ 4696 11337  1094]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032064
{'0': {'precision': 0.33132024828048984, 'recall': 0.29129793510324486, 'f1-score': 0.3100227611647437, 'support': 6780}, '1': {'precision': 0.3442857142857143, 'recall': 0.6395251396648045, 'f1-score': 0.4476050830889541, 'support': 7160}, '2': {'precision': 0.33648255813953487, 'recall': 0.06913543377631776, 'f1-score': 0.11470333209463644, 'support': 6697}, 'accuracy': 0.3400203517953191, 'macro avg': {'precision': 0.33736284023524626, 'recall': 0.3333195028481224, 'f1-score': 0.2907770587827781, 'support': 20637}, 'weighted avg': {'precision': 0.3374938551866987, 'recall': 0.3400203517953191, 'f1-score': 0.2943729675171611, 'support': 20637}}
[[1975 4346  459]
 [2127 4579  454]
 [1859 4375  463]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.087178
{'0': {'precision': 0.28117359413202936, 'recall': 0.05148101171379542, 'f1-score': 0.08702781106136091, 'support': 147433}, '1': {'precision': 0.43011378218838225, 'recall': 0.73570840249353, 'f1-score': 0.5428586412954616, 'support': 239179}, '2': {'precision': 0.3272796710708075, 'recall': 0.23340461164907889, 'f1-score': 0.272483416714869, 'support': 172563}, 'accuracy': 0.4002915008718201, 'macro avg': {'precision': 0.34618901579707306, 'recall': 0.3401980086188014, 'f1-score': 0.3007899563572305, 'support': 559175}, 'weighted avg': {'precision': 0.35910906727356257, 'recall': 0.4002915008718201, 'f1-score': 0.3392349695054049, 'support': 559175}}
[[  7590 108212  31631]
 [ 12055 175966  51158]
 [  7349 124937  40277]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109057
{'0': {'precision': 0.36945031712473575, 'recall': 0.05839842934124232, 'f1-score': 0.10085488583486633, 'support': 47878}, '1': {'precision': 0.32793427687036425, 'recall': 0.7733627160663866, 'f1-score': 0.4605699364990396, 'support': 43563}, '2': {'precision': 0.33659325427383335, 'recall': 0.19499029732563067, 'f1-score': 0.24693171386201537, 'support': 44833}, 'accuracy': 0.3318901624667948, 'macro avg': {'precision': 0.34465928275631114, 'recall': 0.3422504809110865, 'f1-score': 0.26945217873197375, 'support': 136274}, 'weighted avg': {'precision': 0.34536909869425236, 'recall': 0.3318901624667948, 'f1-score': 0.2639038106703049, 'support': 136274}}
[[ 2796 35388  9694]
 [ 2337 33690  7536]
 [ 2435 33656  8742]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1225681
{'0': {'precision': 0.3659560723514212, 'recall': 0.05739033532570155, 'f1-score': 0.09922059725019704, 'support': 19742}, '1': {'precision': 0.27988531098367886, 'recall': 0.7656108597285067, 'f1-score': 0.40991682144876035, 'support': 13260}, '2': {'precision': 0.3079012904686439, 'recall': 0.17894736842105263, 'f1-score': 0.2263460098194225, 'support': 15200}, 'accuracy': 0.29054811003692793, 'macro avg': {'precision': 0.31791422460124796, 'recall': 0.33398285449175363, 'f1-score': 0.24516114283945992, 'support': 48202}, 'weighted avg': {'precision': 0.323971694517421, 'recall': 0.29054811003692793, 'f1-score': 0.22477842065846174, 'support': 48202}}
[[ 1133 14830  3779]
 [  773 10152  2335]
 [ 1190 11290  2720]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1168611
{'0': {'precision': 0.35015650828262934, 'recall': 0.17477705217330244, 'f1-score': 0.23316978348185535, 'support': 113928}, '1': {'precision': 0.3086312448038697, 'recall': 0.7925278990781174, 'f1-score': 0.4442570783583104, 'support': 92745}, '2': {'precision': 0.28986154533273784, 'recall': 0.04367261401215104, 'f1-score': 0.0759083352130797, 'support': 104024}, 'accuracy': 0.3152846664113268, 'macro avg': {'precision': 0.3162164328064123, 'recall': 0.3369925217545236, 'f1-score': 0.2511117323510818, 'support': 310697}, 'weighted avg': {'precision': 0.3175736903370519, 'recall': 0.3152846664113268, 'f1-score': 0.24352819141178617, 'support': 310697}}
[[19912 87579  6437]
 [14549 73503  4693]
 [22405 77076  4543]]
Evaluating performance on  train set...
512/512 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102333
{'0': {'precision': 0.3653162176525898, 'recall': 0.20134742344697054, 'f1-score': 0.2596089596467273, 'support': 44381}, '1': {'precision': 0.3621497885046031, 'recall': 0.7835440039621869, 'f1-score': 0.4953510216861565, 'support': 46439}, '2': {'precision': 0.2536520584329349, 'recall': 0.03806676631788739, 'f1-score': 0.06619876960402044, 'support': 40140}, 'accuracy': 0.3577504581551619, 'macro avg': {'precision': 0.32703935486337593, 'recall': 0.34098606457568165, 'f1-score': 0.27371958364563476, 'support': 130960}, 'weighted avg': {'precision': 0.32996767493511653, 'recall': 0.3577504581551619, 'f1-score': 0.28392280044341944, 'support': 130960}}
[[ 8936 33447  1998]
 [ 7554 36387  2498]
 [ 7971 30641  1528]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034769
{'0': {'precision': 0.3203728967712597, 'recall': 0.21208700233310754, 'f1-score': 0.2552189467010823, 'support': 13287}, '1': {'precision': 0.37312277442328534, 'recall': 0.7710519580240593, 'f1-score': 0.5028900527930222, 'support': 15628}, '2': {'precision': 0.3035019455252918, 'recall': 0.04384485666104553, 'f1-score': 0.07662082514734775, 'support': 14232}, 'accuracy': 0.35905161424896287, 'macro avg': {'precision': 0.3323325389066123, 'recall': 0.3423279390060708, 'f1-score': 0.2782432748804841, 'support': 43147}, 'weighted avg': {'precision': 0.3339142254803992, 'recall': 0.35905161424896287, 'f1-score': 0.28601588692988356, 'support': 43147}}
[[ 2818  9909   560]
 [ 2706 12050   872]
 [ 3272 10336   624]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1095/1095 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1163809
{'0': {'precision': 0.35835293060319645, 'recall': 0.48229009172462456, 'f1-score': 0.4111853977966073, 'support': 99210}, '1': {'precision': 0.27841341440842376, 'recall': 0.5342761297112412, 'f1-score': 0.3660675656186905, 'support': 76015}, '2': {'precision': 0.3184438040345821, 'recall': 0.0021074916081782117, 'f1-score': 0.004187271452661096, 'support': 104864}, 'accuracy': 0.31662078839226104, 'macro avg': {'precision': 0.3184033830154008, 'recall': 0.33955790434801464, 'f1-score': 0.2604800782893196, 'support': 280089}, 'weighted avg': {'precision': 0.3217158867634283, 'recall': 0.31662078839226104, 'f1-score': 0.24656242604857032, 'support': 280089}}
[[47848 51173   189]
 [35118 40613   284]
 [50556 54087   221]]
Evaluating performance on  train set...
448/448 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1140631
{'0': {'precision': 0.3058816930900389, 'recall': 0.46998161553487305, 'f1-score': 0.37057757644394107, 'support': 34812}, '1': {'precision': 0.3301987780174898, 'recall': 0.5336846868428757, 'f1-score': 0.4079763963780649, 'support': 37569}, '2': {'precision': 0.36056338028169016, 'recall': 0.0030343977431666787, 'f1-score': 0.006018148479007006, 'support': 42183}, 'accuracy': 0.31893963199608955, 'macro avg': {'precision': 0.3322146171297396, 'recall': 0.33556690004030515, 'f1-score': 0.261524040433671, 'support': 114564}, 'weighted avg': {'precision': 0.3339900532594187, 'recall': 0.31893963199608955, 'f1-score': 0.24860929597416243, 'support': 114564}}
[[16361 18347   104]
 [17396 20050   123]
 [19731 22324   128]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1195649
{'0': {'precision': 0.31809695874736527, 'recall': 0.4714808533428546, 'f1-score': 0.37989067894131184, 'support': 11203}, '1': {'precision': 0.2914664457332229, 'recall': 0.5179114731573266, 'f1-score': 0.37301194599561743, 'support': 10189}, '2': {'precision': 0.3333333333333333, 'recall': 0.0015693894327778193, 'f1-score': 0.003124070217197262, 'support': 13381}, 'accuracy': 0.30425905156299426, 'macro avg': {'precision': 0.3142989126046405, 'recall': 0.330320571977653, 'f1-score': 0.25200889838470886, 'support': 34773}, 'weighted avg': {'precision': 0.31615693721438687, 'recall': 0.30425905156299426, 'f1-score': 0.23289153013847466, 'support': 34773}}
[[5282 5893   28]
 [4898 5277   14]
 [6425 6935   21]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
1722/1722 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1187577
{'0': {'precision': 0.33011868915513815, 'recall': 0.3282685167090092, 'f1-score': 0.32919100329309986, 'support': 143276}, '1': {'precision': 0.3072717066646338, 'recall': 0.6771639112672292, 'f1-score': 0.4227260918167669, 'support': 130955}, '2': {'precision': 0.3285361842105263, 'recall': 0.019187358916478554, 'f1-score': 0.03625720379361982, 'support': 166568}, 'accuracy': 0.31512548803422874, 'macro avg': {'precision': 0.3219755266767661, 'recall': 0.34153992896423896, 'f1-score': 0.2627247663011622, 'support': 440799}, 'weighted avg': {'precision': 0.3227331885626729, 'recall': 0.31512548803422874, 'f1-score': 0.2462858478880001, 'support': 440799}}
[[ 47033  93566   2677]
 [ 38422  88678   3855]
 [ 57018 106354   3196]]
Evaluating performance on  train set...
618/618 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1073462
{'0': {'precision': 0.358063121487246, 'recall': 0.30276554131861305, 'f1-score': 0.3281007041765294, 'support': 54709}, '1': {'precision': 0.3273214203259916, 'recall': 0.7001698866105646, 'f1-score': 0.44609740288344757, 'support': 50622}, '2': {'precision': 0.2511737089201878, 'recall': 0.016266960586826803, 'f1-score': 0.030555059789398535, 'support': 52622}, 'accuracy': 0.3346818357359468, 'macro avg': {'precision': 0.31218608357780847, 'recall': 0.3397341295053348, 'f1-score': 0.2682510556164585, 'support': 157953}, 'weighted avg': {'precision': 0.31260060374912924, 'recall': 0.3346818357359468, 'f1-score': 0.26678994707158055, 'support': 157953}}
[[16564 37126  1019]
 [13645 35444  1533]
 [16051 35715   856]]
Evaluating performance on  val set...
225/225 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1113846
{'0': {'precision': 0.35972978044661286, 'recall': 0.29179562636359024, 'f1-score': 0.3222209771402958, 'support': 19709}, '1': {'precision': 0.3153811502077181, 'recall': 0.7169596631962223, 'f1-score': 0.4380637872599287, 'support': 17577}, '2': {'precision': 0.2691538974017322, 'recall': 0.02003968253968254, 'f1-score': 0.0373020636166382, 'support': 20160}, 'accuracy': 0.3265153361417679, 'macro avg': {'precision': 0.3147549426853544, 'recall': 0.3429316573664983, 'f1-score': 0.2658622760056209, 'support': 57446}, 'weighted avg': {'precision': 0.3143736951509639, 'recall': 0.3265153361417679, 'f1-score': 0.25767694930260215, 'support': 57446}}
[[ 5751 13493   465]
 [ 4343 12602   632]
 [ 5893 13863   404]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
4450/4450 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0935564
{'0': {'precision': 0.32463985799139755, 'recall': 0.055816082779183124, 'f1-score': 0.0952547890321773, 'support': 340762}, '1': {'precision': 0.4050051188715732, 'recall': 0.769594905681177, 'f1-score': 0.5307166179858436, 'support': 462633}, '2': {'precision': 0.29571122904390046, 'recall': 0.17742444731715745, 'f1-score': 0.22178163262646627, 'support': 335726}, 'accuracy': 0.38154506852213244, 'macro avg': {'precision': 0.341785401968957, 'recall': 0.3342784785925059, 'f1-score': 0.2825843465481624, 'support': 1139121}, 'weighted avg': {'precision': 0.348752773875444, 'recall': 0.38154506852213244, 'f1-score': 0.3094000496382567, 'support': 1139121}}
[[ 19020 263813  57929]
 [ 22655 356040  83938]
 [ 16913 259247  59566]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103298
{'0': {'precision': 0.3826968907609599, 'recall': 0.05430337538142125, 'f1-score': 0.09511084787085311, 'support': 127156}, '1': {'precision': 0.3375376499499156, 'recall': 0.7637062306395326, 'f1-score': 0.46816079686944145, 'support': 127515}, '2': {'precision': 0.3491049410321608, 'recall': 0.20993023327288932, 'f1-score': 0.26219345428024426, 'support': 130148}, 'accuracy': 0.3420075412076847, 'macro avg': {'precision': 0.3564464939143454, 'recall': 0.34264661309794775, 'f1-score': 0.27515503300684624, 'support': 384819}, 'weighted avg': {'precision': 0.3563717725486989, 'recall': 0.3420075412076847, 'f1-score': 0.2752343119033578, 'support': 384819}}
[[ 6905 93924 26327]
 [ 5517 97384 24614]
 [ 5621 97205 27322]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0865052
{'0': {'precision': 0.3469750889679715, 'recall': 0.06799360743861688, 'f1-score': 0.11370538642824168, 'support': 34415}, '1': {'precision': 0.40410850723579, 'recall': 0.7798712184713861, 'f1-score': 0.5323614705385126, 'support': 52492}, '2': {'precision': 0.34943245047852217, 'recall': 0.18002935510503623, 'f1-score': 0.23763035614282038, 'support': 43604}, 'accuracy': 0.39174475714690715, 'macro avg': {'precision': 0.3668386822274279, 'recall': 0.3426313936716798, 'f1-score': 0.29456573770319155, 'support': 130511}, 'weighted avg': {'precision': 0.3707753677415644, 'recall': 0.39174475714690715, 'f1-score': 0.32349398314844785, 'support': 130511}}
[[ 2340 26482  5593]
 [ 2533 40937  9022]
 [ 1871 33883  7850]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
6203/6203 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0835193
{'0': {'precision': 0.32704053992580984, 'recall': 0.18782984585421467, 'f1-score': 0.23861529386383762, 'support': 421030}, '1': {'precision': 0.44363428402084126, 'recall': 0.7707766559205569, 'f1-score': 0.563142077599853, 'support': 691413}, '2': {'precision': 0.3265304712967567, 'recall': 0.09944450403949259, 'f1-score': 0.15245806750152768, 'support': 475431}, 'accuracy': 0.41520045041357184, 'macro avg': {'precision': 0.3657350984144692, 'recall': 0.35268366860475475, 'f1-score': 0.3180718129884061, 'support': 1587874}, 'weighted avg': {'precision': 0.3776566013687194, 'recall': 0.41520045041357184, 'f1-score': 0.3541283766629831, 'support': 1587874}}
[[ 79082 309858  32090]
 [ 93065 532925  65423]
 [ 69664 358488  47279]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1072612
{'0': {'precision': 0.32255899787495806, 'recall': 0.11166968901049969, 'f1-score': 0.16590365430986131, 'support': 154957}, '1': {'precision': 0.3315572381384607, 'recall': 0.7679906852960745, 'f1-score': 0.46315920407991296, 'support': 150300}, '2': {'precision': 0.3176503396211382, 'recall': 0.10867965161448608, 'f1-score': 0.16195026835993237, 'support': 146734}, 'accuracy': 0.32894460287926086, 'macro avg': {'precision': 0.32392219187818566, 'recall': 0.3294466753070201, 'f1-score': 0.26367104224990223, 'support': 451991}, 'weighted avg': {'precision': 0.3239576284923563, 'recall': 0.32894460287926086, 'f1-score': 0.2634662451500813, 'support': 451991}}
[[ 17304 120354  17299]
 [ 17914 115429  16957]
 [ 18428 112359  15947]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0940988
{'0': {'precision': 0.3431040325313453, 'recall': 0.0907298714100094, 'f1-score': 0.14351015201445733, 'support': 44638}, '1': {'precision': 0.41219474391210004, 'recall': 0.7938474295190713, 'f1-score': 0.5426339892989934, 'support': 60300}, '2': {'precision': 0.28689908621374655, 'recall': 0.13393146937450734, 'f1-score': 0.18261419314050892, 'support': 43134}, 'accuracy': 0.38964827921551676, 'macro avg': {'precision': 0.3473992875523973, 'recall': 0.3395029234345293, 'f1-score': 0.28958611148465324, 'support': 148072}, 'weighted avg': {'precision': 0.3548674026607162, 'recall': 0.38964827921551676, 'f1-score': 0.31743824846880814, 'support': 148072}}
[[ 4050 34640  5948]
 [ 4020 47869  8411]
 [ 3734 33623  5777]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
5183/5183 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1165645
{'0': {'precision': 0.33617021276595743, 'recall': 0.1784328185710669, 'f1-score': 0.2331264875281327, 'support': 454255}, '1': {'precision': 0.2628715094978275, 'recall': 0.6941931784322874, 'f1-score': 0.38134017689495003, 'support': 355754}, '2': {'precision': 0.3715094494434264, 'recall': 0.10512914279522706, 'f1-score': 0.16388295281284546, 'support': 516831}, 'accuracy': 0.28816586777606945, 'macro avg': {'precision': 0.3235170572357371, 'recall': 0.32591837993286044, 'f1-score': 0.2594498724119761, 'support': 1326840}, 'weighted avg': {'precision': 0.3302826197998143, 'recall': 0.28816586777606945, 'f1-score': 0.24589397083928255, 'support': 1326840}}
[[ 81054 325438  47763]
 [ 64637 246962  44155]
 [ 95419 367078  54334]]
Evaluating performance on  train set...
1489/1489 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051397
{'0': {'precision': 0.3981338571629016, 'recall': 0.1279324907197283, 'f1-score': 0.19364194722474976, 'support': 133078}, '1': {'precision': 0.32402488943669616, 'recall': 0.7593382787369527, 'f1-score': 0.45422349409861895, 'support': 121864}, '2': {'precision': 0.32654299912749896, 'recall': 0.13649950445986125, 'f1-score': 0.19252209989544136, 'support': 126125}, 'accuracy': 0.33268952703855226, 'macro avg': {'precision': 0.34956724857569893, 'recall': 0.34125675797218075, 'f1-score': 0.28012918040627, 'support': 381067}, 'weighted avg': {'precision': 0.3507390100291916, 'recall': 0.33268952703855226, 'f1-score': 0.2766044417042722, 'support': 381067}}
[[17025 98875 17178]
 [11000 92536 18328]
 [14737 94172 17216]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028836
{'0': {'precision': 0.3761315734918112, 'recall': 0.12328705066932433, 'f1-score': 0.1857045377004435, 'support': 44149}, '1': {'precision': 0.3452595869621283, 'recall': 0.7806185382044899, 'f1-score': 0.47876591267030255, 'support': 44589}, '2': {'precision': 0.33806606744146106, 'recall': 0.13416185759076657, 'f1-score': 0.19209186577967174, 'support': 44014}, 'accuracy': 0.34767837772688925, 'macro avg': {'precision': 0.3531524092984668, 'recall': 0.34602248215486026, 'f1-score': 0.28552077205013926, 'support': 132752}, 'weighted avg': {'precision': 0.353141590736959, 'recall': 0.34767837772688925, 'f1-score': 0.28625628461657426, 'support': 132752}}
[[ 5443 32880  5826]
 [ 4046 34807  5736]
 [ 4982 33127  5905]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
7324/7324 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030433
{'0': {'precision': 0.3591474480073085, 'recall': 0.14095866363379725, 'f1-score': 0.20245681122541123, 'support': 616358}, '1': {'precision': 0.3537067000337986, 'recall': 0.7487232335717645, 'f1-score': 0.4804449083111642, 'support': 656933}, '2': {'precision': 0.30357916988361194, 'recall': 0.12226000349176526, 'f1-score': 0.17431740755930974, 'support': 601415}, 'accuracy': 0.34793242247051004, 'macro avg': {'precision': 0.3388111059749064, 'recall': 0.33731396689910903, 'f1-score': 0.2857397090319617, 'support': 1874706}, 'weighted avg': {'precision': 0.3394143256530595, 'recall': 0.34793242247051004, 'f1-score': 0.29084192074497667, 'support': 1874706}}
[[ 86881 453783  75694]
 [ 72088 491861  92984]
 [ 82940 444946  73529]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1072867
{'0': {'precision': 0.3550863131935882, 'recall': 0.13168108006150223, 'f1-score': 0.1921170147561011, 'support': 174953}, '1': {'precision': 0.32801710567740583, 'recall': 0.7250337792777903, 'f1-score': 0.4516846910150415, 'support': 172443}, '2': {'precision': 0.31709388511426806, 'recall': 0.13972873052235252, 'f1-score': 0.1939795645260324, 'support': 176356}, 'accuracy': 0.3297495761352701, 'macro avg': {'precision': 0.3333991013284207, 'recall': 0.332147863287215, 'f1-score': 0.27926042343239166, 'support': 523752}, 'weighted avg': {'precision': 0.33338121612843213, 'recall': 0.3297495761352701, 'f1-score': 0.27820566095572696, 'support': 523752}}
[[ 23038 127985  23930]
 [ 18276 125027  29140]
 [ 23566 128148  24642]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038893
{'0': {'precision': 0.3594997676285437, 'recall': 0.1357097288676236, 'f1-score': 0.19703828920098648, 'support': 62700}, '1': {'precision': 0.34101246721517625, 'recall': 0.7261307301548442, 'f1-score': 0.4640794832804455, 'support': 65356}, '2': {'precision': 0.2950740020929885, 'recall': 0.12830305197126793, 'f1-score': 0.17884245101370486, 'support': 61534}, 'accuracy': 0.3368373859380769, 'macro avg': {'precision': 0.3318620789789028, 'recall': 0.3300478369979119, 'f1-score': 0.2799867411650456, 'support': 189590}, 'weighted avg': {'precision': 0.33221651923843404, 'recall': 0.3368373859380769, 'f1-score': 0.28318777795693845, 'support': 189590}}
[[ 8509 46312  7879]
 [ 6917 47457 10982]
 [ 8243 45396  7895]]
testing model on single stock: results/universal/W6/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
29350/29350 - 416s - 416s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006372
{'0': {'precision': 0.2933998069413365, 'recall': 0.2156863184302482, 'f1-score': 0.24861146683631316, 'support': 2232200}, '1': {'precision': 0.405201110972918, 'recall': 0.7172405767194259, 'f1-score': 0.5178472640642465, 'support': 3016094}, '2': {'precision': 0.25037473674743493, 'recall': 0.05899360295967966, 'f1-score': 0.09548816679040939, 'support': 2265110}, 'accuracy': 0.36978538622440643, 'macro avg': {'precision': 0.31632521822056314, 'recall': 0.33064016603645124, 'f1-score': 0.2873156325636564, 'support': 7513404}, 'weighted avg': {'precision': 0.32530900888694203, 'recall': 0.36978538622440643, 'f1-score': 0.31052739128778806, 'support': 7513404}}
[[ 481455 1589249  161496]
 [ 614244 2163265  238585]
 [ 545253 1586230  133627]]
Evaluating performance on  train set...
5452/5452 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106371
{'0': {'precision': 0.34761955695976876, 'recall': 0.2721479305695121, 'f1-score': 0.3052884991732392, 'support': 465732}, '1': {'precision': 0.3374551833443612, 'recall': 0.7104616933001882, 'f1-score': 0.45757251613208355, 'support': 463013}, '2': {'precision': 0.29061780814586197, 'recall': 0.03490240610202901, 'f1-score': 0.062320312634496534, 'support': 466730}, 'accuracy': 0.3382296350704957, 'macro avg': {'precision': 0.32523084948333064, 'recall': 0.3391706766572431, 'f1-score': 0.27506044264660645, 'support': 1395475}, 'weighted avg': {'precision': 0.32518227693346563, 'recall': 0.3382296350704957, 'f1-score': 0.27455268365589786, 'support': 1395475}}
[[126748 323629  15355]
 [109652 328953  24408]
 [128217 322223  16290]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987203
{'0': {'precision': 0.3323957533469102, 'recall': 0.24792076495928683, 'f1-score': 0.2840098699224099, 'support': 160636}, '1': {'precision': 0.3784338046803936, 'recall': 0.7262513092328688, 'f1-score': 0.4975862218936198, 'support': 189042}, '2': {'precision': 0.2710498112855878, 'recall': 0.037678530945363865, 'f1-score': 0.06616016286978378, 'support': 154385}, 'accuracy': 0.3629189208491796, 'macro avg': {'precision': 0.3272931231042972, 'recall': 0.33728353504583986, 'f1-score': 0.28258541822860445, 'support': 504063}, 'weighted avg': {'precision': 0.3308725946049416, 'recall': 0.3629189208491796, 'f1-score': 0.297385526747096, 'support': 504063}}
[[ 39825 114856   5955]
 [ 42061 137292   9689]
 [ 37926 110642   5817]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        81 (peak)  26.09 (ave)

============================================
