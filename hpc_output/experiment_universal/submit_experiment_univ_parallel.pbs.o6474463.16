This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W5/deepLOB_L1/h50
Epoch 1/50
9913/9913 - 182s - loss: 3.0526 - accuracy50: 0.4586 - val_loss: 3.5791 - val_accuracy50: 0.3734 - 182s/epoch - 18ms/step
Epoch 2/50
9913/9913 - 154s - loss: 2.9880 - accuracy50: 0.4817 - val_loss: 3.5086 - val_accuracy50: 0.3818 - 154s/epoch - 15ms/step
Epoch 3/50
9913/9913 - 151s - loss: 2.9582 - accuracy50: 0.4908 - val_loss: 3.5486 - val_accuracy50: 0.3839 - 151s/epoch - 15ms/step
Epoch 4/50
9913/9913 - 151s - loss: 2.9420 - accuracy50: 0.4953 - val_loss: 3.5570 - val_accuracy50: 0.3858 - 151s/epoch - 15ms/step
Epoch 5/50
9913/9913 - 149s - loss: 2.9302 - accuracy50: 0.4985 - val_loss: 3.5473 - val_accuracy50: 0.3901 - 149s/epoch - 15ms/step
Epoch 6/50
9913/9913 - 149s - loss: 2.9227 - accuracy50: 0.5004 - val_loss: 3.5476 - val_accuracy50: 0.3913 - 149s/epoch - 15ms/step
Epoch 7/50
9913/9913 - 148s - loss: 2.9164 - accuracy50: 0.5019 - val_loss: 3.5425 - val_accuracy50: 0.3915 - 148s/epoch - 15ms/step
Epoch 8/50
9913/9913 - 152s - loss: 2.9115 - accuracy50: 0.5031 - val_loss: 3.5231 - val_accuracy50: 0.3926 - 152s/epoch - 15ms/step
Epoch 9/50
9913/9913 - 154s - loss: 2.9073 - accuracy50: 0.5042 - val_loss: 3.5229 - val_accuracy50: 0.3938 - 154s/epoch - 16ms/step
Epoch 10/50
9913/9913 - 150s - loss: 2.9035 - accuracy50: 0.5053 - val_loss: 3.5219 - val_accuracy50: 0.3943 - 150s/epoch - 15ms/step
Epoch 11/50
9913/9913 - 153s - loss: 2.8997 - accuracy50: 0.5060 - val_loss: 3.5005 - val_accuracy50: 0.3942 - 153s/epoch - 15ms/step
Epoch 12/50
9913/9913 - 149s - loss: 2.8966 - accuracy50: 0.5071 - val_loss: 3.4946 - val_accuracy50: 0.3950 - 149s/epoch - 15ms/step
Epoch 13/50
9913/9913 - 152s - loss: 2.8941 - accuracy50: 0.5075 - val_loss: 3.4726 - val_accuracy50: 0.3988 - 152s/epoch - 15ms/step
Epoch 14/50
9913/9913 - 155s - loss: 2.8921 - accuracy50: 0.5079 - val_loss: 3.5010 - val_accuracy50: 0.3970 - 155s/epoch - 16ms/step
Epoch 15/50
9913/9913 - 152s - loss: 2.8891 - accuracy50: 0.5086 - val_loss: 3.4954 - val_accuracy50: 0.3994 - 152s/epoch - 15ms/step
Epoch 16/50
9913/9913 - 151s - loss: 2.8874 - accuracy50: 0.5091 - val_loss: 3.4459 - val_accuracy50: 0.4047 - 151s/epoch - 15ms/step
Epoch 17/50
9913/9913 - 149s - loss: 2.8857 - accuracy50: 0.5097 - val_loss: 3.3671 - val_accuracy50: 0.4209 - 149s/epoch - 15ms/step
Epoch 18/50
9913/9913 - 151s - loss: 2.8838 - accuracy50: 0.5100 - val_loss: 3.4641 - val_accuracy50: 0.4117 - 151s/epoch - 15ms/step
Epoch 19/50
9913/9913 - 153s - loss: 2.8815 - accuracy50: 0.5105 - val_loss: 3.4567 - val_accuracy50: 0.4095 - 153s/epoch - 15ms/step
Epoch 20/50
9913/9913 - 151s - loss: 2.8798 - accuracy50: 0.5111 - val_loss: 3.4487 - val_accuracy50: 0.4184 - 151s/epoch - 15ms/step
Epoch 21/50
9913/9913 - 152s - loss: 2.8783 - accuracy50: 0.5116 - val_loss: 3.3879 - val_accuracy50: 0.4223 - 152s/epoch - 15ms/step
Epoch 22/50
9913/9913 - 149s - loss: 2.8771 - accuracy50: 0.5118 - val_loss: 3.3926 - val_accuracy50: 0.4245 - 149s/epoch - 15ms/step
Epoch 23/50
9913/9913 - 152s - loss: 2.8755 - accuracy50: 0.5121 - val_loss: 3.4240 - val_accuracy50: 0.4210 - 152s/epoch - 15ms/step
Epoch 24/50
9913/9913 - 154s - loss: 2.8742 - accuracy50: 0.5125 - val_loss: 3.3820 - val_accuracy50: 0.4269 - 154s/epoch - 16ms/step
Epoch 25/50
9913/9913 - 150s - loss: 2.8727 - accuracy50: 0.5131 - val_loss: 3.3613 - val_accuracy50: 0.4277 - 150s/epoch - 15ms/step
Epoch 26/50
9913/9913 - 151s - loss: 2.8713 - accuracy50: 0.5134 - val_loss: 3.3778 - val_accuracy50: 0.4295 - 151s/epoch - 15ms/step
Epoch 27/50
9913/9913 - 148s - loss: 2.8699 - accuracy50: 0.5137 - val_loss: 3.3880 - val_accuracy50: 0.4268 - 148s/epoch - 15ms/step
Epoch 28/50
9913/9913 - 152s - loss: 2.8684 - accuracy50: 0.5141 - val_loss: 3.3544 - val_accuracy50: 0.4293 - 152s/epoch - 15ms/step
Epoch 29/50
9913/9913 - 151s - loss: 2.8672 - accuracy50: 0.5146 - val_loss: 3.3997 - val_accuracy50: 0.4274 - 151s/epoch - 15ms/step
Epoch 30/50
9913/9913 - 150s - loss: 2.8665 - accuracy50: 0.5145 - val_loss: 3.4021 - val_accuracy50: 0.4189 - 150s/epoch - 15ms/step
Epoch 31/50
9913/9913 - 152s - loss: 2.8648 - accuracy50: 0.5151 - val_loss: 3.3699 - val_accuracy50: 0.4288 - 152s/epoch - 15ms/step
Epoch 32/50
9913/9913 - 148s - loss: 2.8639 - accuracy50: 0.5154 - val_loss: 3.3926 - val_accuracy50: 0.4291 - 148s/epoch - 15ms/step
Epoch 33/50
9913/9913 - 155s - loss: 2.8625 - accuracy50: 0.5156 - val_loss: 3.4133 - val_accuracy50: 0.4197 - 155s/epoch - 16ms/step
Epoch 34/50
9913/9913 - 150s - loss: 2.8620 - accuracy50: 0.5159 - val_loss: 3.4344 - val_accuracy50: 0.4150 - 150s/epoch - 15ms/step
Epoch 35/50
9913/9913 - 148s - loss: 2.8604 - accuracy50: 0.5164 - val_loss: 3.3887 - val_accuracy50: 0.4297 - 148s/epoch - 15ms/step
Epoch 36/50
9913/9913 - 150s - loss: 2.8593 - accuracy50: 0.5165 - val_loss: 3.4301 - val_accuracy50: 0.4191 - 150s/epoch - 15ms/step
Epoch 37/50
9913/9913 - 154s - loss: 2.8584 - accuracy50: 0.5169 - val_loss: 3.4317 - val_accuracy50: 0.4229 - 154s/epoch - 16ms/step
Epoch 38/50
9913/9913 - 151s - loss: 2.8574 - accuracy50: 0.5173 - val_loss: 3.3911 - val_accuracy50: 0.4235 - 151s/epoch - 15ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 304s - 304s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2565721
{'0': {'precision': 0.4343619955053631, 'recall': 0.26579228657594905, 'f1-score': 0.3297846515881333, 'support': 4610352}, '1': {'precision': 0.27290688880330505, 'recall': 0.6121310272115874, 'f1-score': 0.37750873980290484, 'support': 3512217}, '2': {'precision': 0.45657182575723226, 'recall': 0.20712422987975374, 'f1-score': 0.28497107069288985, 'support': 4715822}, 'accuracy': 0.338990610271957, 'macro avg': {'precision': 0.3879469033553001, 'recall': 0.3616825145557634, 'f1-score': 0.3307548206946427, 'support': 12838391}, 'weighted avg': {'precision': 0.39835064763647887, 'recall': 0.338990610271957, 'f1-score': 0.3263795896339407, 'support': 12838391}}
[[1225396 2837399  547557]
 [ 747261 2149937  615019]
 [ 848483 2890578  976761]]
Evaluating performance on  train set...
9913/9913 - 68s - 68s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1252561
{'0': {'precision': 0.4157791563362451, 'recall': 0.45706135194001657, 'f1-score': 0.43544400495073143, 'support': 778215}, '1': {'precision': 0.46118554803182377, 'recall': 0.4407499992350693, 'f1-score': 0.4507362650428992, 'support': 980481}, '2': {'precision': 0.420638939443799, 'recall': 0.40236041714578646, 'f1-score': 0.4112966985629595, 'support': 778337}, 'accuracy': 0.43397582924621003, 'macro avg': {'precision': 0.4325345479372893, 'recall': 0.43339058944029074, 'f1-score': 0.4324923228521967, 'support': 2537033}, 'weighted avg': {'precision': 0.4348181886786139, 'recall': 0.43397582924621003, 'f1-score': 0.4339458094032118, 'support': 2537033}}
[[355692 255851 166672]
 [283663 432147 264671]
 [216128 249037 313172]]
Evaluating performance on  val set...
3496/3496 - 24s - 24s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1101425
{'0': {'precision': 0.4150479730936925, 'recall': 0.4567527759285002, 'f1-score': 0.434902846933011, 'support': 289903}, '1': {'precision': 0.4455704424964569, 'recall': 0.43629255568619135, 'f1-score': 0.44088269378718875, 'support': 311298}, '2': {'precision': 0.4278692162592004, 'recall': 0.39479827177852556, 'f1-score': 0.4106690238343734, 'support': 293018}, 'accuracy': 0.4293288333171181, 'macro avg': {'precision': 0.42949587728311656, 'recall': 0.42928120113107243, 'f1-score': 0.4288181881848578, 'support': 894219}, 'weighted avg': {'precision': 0.42987480937206785, 'recall': 0.4293288333171181, 'f1-score': 0.4290436200426131, 'support': 894219}}
[[132414  85468  72021]
 [ 92815 135817  82666]
 [ 93804  83531 115683]]
testing model out of sample: results/universal/W5/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 133s - 133s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.170105
{'0': {'precision': 0.4222961610698127, 'recall': 0.47926645374103355, 'f1-score': 0.4489813135981569, 'support': 1909900}, '1': {'precision': 0.37644905186883765, 'recall': 0.4285680011879126, 'f1-score': 0.4008213666925618, 'support': 1542201}, '2': {'precision': 0.45794103411267073, 'recall': 0.3441831602910885, 'f1-score': 0.3929954823642445, 'support': 1896743}, 'accuracy': 0.416747244825237, 'macro avg': {'precision': 0.41889541568377364, 'recall': 0.4173392050733449, 'f1-score': 0.414266054218321, 'support': 5348844}, 'weighted avg': {'precision': 0.4217172894057815, 'recall': 0.416747244825237, 'f1-score': 0.4152426119703172, 'support': 5348844}}
[[915351 544132 450417]
 [558937 660938 322326]
 [693269 550647 652827]]
Evaluating performance on  train set...
4957/4957 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1110834
{'0': {'precision': 0.4138005407277821, 'recall': 0.47083247606039497, 'f1-score': 0.44047809541036753, 'support': 403411}, '1': {'precision': 0.47676814174468535, 'recall': 0.4570549692067743, 'f1-score': 0.46670348118042054, 'support': 462277}, '2': {'precision': 0.4496763798235792, 'recall': 0.4089297067471986, 'f1-score': 0.42833619050344285, 'support': 402656}, 'accuracy': 0.4461589284925856, 'macro avg': {'precision': 0.44674835409868224, 'recall': 0.44560571733812265, 'f1-score': 0.44517258903141027, 'support': 1268344}, 'weighted avg': {'precision': 0.4481398804985764, 'recall': 0.4461589284925856, 'f1-score': 0.44618189642603845, 'support': 1268344}}
[[189939 116791  96681]
 [146160 211286 104831]
 [122912 115086 164658]]
Evaluating performance on  val set...
1701/1701 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1399748
{'0': {'precision': 0.3967441331893858, 'recall': 0.4967734591221817, 'f1-score': 0.4411596528749649, 'support': 140553}, '1': {'precision': 0.45389018016686594, 'recall': 0.437202350139766, 'f1-score': 0.44539000547121677, 'support': 154544}, '2': {'precision': 0.4511885320268554, 'recall': 0.3552777281657439, 'f1-score': 0.3975299266572074, 'support': 139975}, 'accuracy': 0.4300897322741983, 'macro avg': {'precision': 0.4339409484610357, 'recall': 0.4297511791425639, 'f1-score': 0.42802652833446303, 'support': 435072}, 'weighted avg': {'precision': 0.43455956008737623, 'recall': 0.4300897322741983, 'f1-score': 0.42862541643663876, 'support': 435072}}
[[69823 40002 30728]
 [57215 67567 29762]
 [48952 41293 49730]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1996384
{'0': {'precision': 0.4255215351019839, 'recall': 0.35999685540771603, 'f1-score': 0.3900262970178969, 'support': 101762}, '1': {'precision': 0.2964106449474382, 'recall': 0.4452189251472304, 'f1-score': 0.3558855635404348, 'support': 70298}, '2': {'precision': 0.4262035711594967, 'recall': 0.3419504332057223, 'f1-score': 0.37945645004415923, 'support': 99260}, 'accuracy': 0.37547545333923044, 'macro avg': {'precision': 0.3827119170696396, 'recall': 0.38238873792022293, 'f1-score': 0.37512277020083035, 'support': 271320}, 'weighted avg': {'precision': 0.39231890183862134, 'recall': 0.37547545333923044, 'f1-score': 0.37731367615466593, 'support': 271320}}
[[36634 37517 27611]
 [20915 31298 18085]
 [28543 36775 33942]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1826565
{'0': {'precision': 0.3780883354022344, 'recall': 0.40326300503971985, 'f1-score': 0.3902701138735611, 'support': 23414}, '1': {'precision': 0.38460274422808316, 'recall': 0.4075750979538528, 'f1-score': 0.39575583361515043, 'support': 22970}, '2': {'precision': 0.4151026825194065, 'recall': 0.36285162121537473, 'f1-score': 0.3872224386443319, 'support': 23285}, 'accuracy': 0.3911782858947308, 'macro avg': {'precision': 0.3925979207165747, 'recall': 0.39122990806964913, 'f1-score': 0.39108279537768115, 'support': 69669}, 'weighted avg': {'precision': 0.39260720381362396, 'recall': 0.3911782858947308, 'f1-score': 0.39106016202627897, 'support': 69669}}
[[9442 7752 6220]
 [7923 9362 5685]
 [7608 7228 8449]]
Evaluating performance on  val set...
96/96 - 1s - 705ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1873881
{'0': {'precision': 0.3927359557622219, 'recall': 0.37542047092743874, 'f1-score': 0.38388305386647015, 'support': 8324}, '1': {'precision': 0.3687654933068914, 'recall': 0.4655733600400601, 'f1-score': 0.411553145576274, 'support': 7988}, '2': {'precision': 0.4251432110233782, 'recall': 0.3353278788618879, 'f1-score': 0.3749317312943747, 'support': 8189}, 'accuracy': 0.3914125954042692, 'macro avg': {'precision': 0.3955482200308305, 'recall': 0.3921072366097956, 'f1-score': 0.39012264357903964, 'support': 24501}, 'weighted avg': {'precision': 0.39575244322152675, 'recall': 0.3914125954042692, 'f1-score': 0.3899124531577245, 'support': 24501}}
[[3125 3251 1948]
 [2504 3719 1765]
 [2328 3115 2746]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721259
{'0': {'precision': 0.36802761156647196, 'recall': 0.46774735192466455, 'f1-score': 0.4119384960427854, 'support': 142934}, '1': {'precision': 0.6448667119096093, 'recall': 0.39709526532647105, 'f1-score': 0.4915218091647042, 'support': 272796}, '2': {'precision': 0.4019831934377103, 'recall': 0.5871365245755388, 'f1-score': 0.47723043193772896, 'support': 143476}, 'accuracy': 0.463913119673251, 'macro avg': {'precision': 0.4716258389712638, 'recall': 0.4839930472755582, 'f1-score': 0.46023024571507287, 'support': 559206}, 'weighted avg': {'precision': 0.5117893206356956, 'recall': 0.463913119673251, 'f1-score': 0.4675134277868473, 'support': 559206}}
[[ 66857  32095  43982]
 [ 83131 108326  81339]
 [ 31675  27561  84240]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0129828
{'0': {'precision': 0.3514859704466213, 'recall': 0.5624762772337357, 'f1-score': 0.4326273227553389, 'support': 26346}, '1': {'precision': 0.8107078485990497, 'recall': 0.40610668226168856, 'f1-score': 0.5411406033180441, 'support': 97467}, '2': {'precision': 0.3116604696345426, 'recall': 0.6923134161767989, 'f1-score': 0.4298253718931905, 'support': 26878}, 'accuracy': 0.4844947608019059, 'macro avg': {'precision': 0.4912847628934045, 'recall': 0.5536321252240745, 'f1-score': 0.4678644326555245, 'support': 150691}, 'weighted avg': {'precision': 0.6414073923434545, 'recall': 0.4844947608019059, 'f1-score': 0.5023139867321681, 'support': 150691}}
[[14819  4880  6647]
 [23434 39582 34451]
 [ 3908  4362 18608]]
Evaluating performance on  val set...
222/222 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9760211
{'0': {'precision': 0.38053645892032006, 'recall': 0.58110317528612, 'f1-score': 0.459903973848197, 'support': 11621}, '1': {'precision': 0.7455304215867596, 'recall': 0.4791673016550337, 'f1-score': 0.5833828113403593, 'support': 32809}, '2': {'precision': 0.39724950884086446, 'recall': 0.5792273694549026, 'f1-score': 0.4712815902507242, 'support': 12218}, 'accuracy': 0.5216600762604152, 'macro avg': {'precision': 0.5077721297826481, 'recall': 0.5464992821320188, 'f1-score': 0.5048561251464269, 'support': 56648}, 'weighted avg': {'precision': 0.5955358757585566, 'recall': 0.5216600762604152, 'f1-score': 0.5338735561191762, 'support': 56648}}
[[ 6753  2488  2380]
 [ 8730 15721  8358]
 [ 2263  2878  7077]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2349219
{'0': {'precision': 0.4192476144035002, 'recall': 0.4458092107453939, 'f1-score': 0.432120625259372, 'support': 210211}, '1': {'precision': 0.34130542152653776, 'recall': 0.3016571246285321, 'f1-score': 0.3202588166091816, 'support': 178683}, '2': {'precision': 0.41312870705327137, 'recall': 0.4277362409631682, 'f1-score': 0.4203055927251837, 'support': 210389}, 'accuracy': 0.3964837981387758, 'macro avg': {'precision': 0.3912272476611031, 'recall': 0.3917341921123647, 'f1-score': 0.3908950115312458, 'support': 599283}, 'weighted avg': {'precision': 0.3938601169301169, 'recall': 0.3964837981387758, 'f1-score': 0.39461988448268165, 'support': 599283}}
[[93714 51717 64780]
 [61725 53901 63057]
 [68090 52308 89991]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2061907
{'0': {'precision': 0.38205090043161183, 'recall': 0.4948552977180173, 'f1-score': 0.4311975727288952, 'support': 41499}, '1': {'precision': 0.3867086264346538, 'recall': 0.30824848753135603, 'f1-score': 0.34304951145414236, 'support': 40662}, '2': {'precision': 0.41529147021003, 'recall': 0.37506956037840844, 'f1-score': 0.3941570576793501, 'support': 41331}, 'accuracy': 0.39332102484371456, 'macro avg': {'precision': 0.3946836656920986, 'recall': 0.39272444854259386, 'f1-score': 0.38946804728746254, 'support': 123492}, 'weighted avg': {'precision': 0.3947096835450726, 'recall': 0.39332102484371456, 'f1-score': 0.3897762823208789, 'support': 123492}}
[[20536 10215 10748]
 [17050 12534 11078]
 [16166  9663 15502]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2041539
{'0': {'precision': 0.41093194514982223, 'recall': 0.4480514985810203, 'f1-score': 0.42868969171164606, 'support': 14447}, '1': {'precision': 0.3532259658136548, 'recall': 0.2973962232759338, 'f1-score': 0.3229157257700298, 'support': 12021}, '2': {'precision': 0.43404530744336567, 'recall': 0.45143049478290137, 'f1-score': 0.4425672331298465, 'support': 14855}, 'accuracy': 0.4054400696948431, 'macro avg': {'precision': 0.39940107280228093, 'recall': 0.3989594055466185, 'f1-score': 0.3980575502038408, 'support': 41323}, 'weighted avg': {'precision': 0.4024539890302404, 'recall': 0.4054400696948431, 'f1-score': 0.40290845688317767, 'support': 41323}}
[[6473 3215 4759]
 [4461 3575 3985]
 [4818 3331 6706]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2714826
{'0': {'precision': 0.38446056934832257, 'recall': 0.4159408688227132, 'f1-score': 0.3995816489491236, 'support': 187380}, '1': {'precision': 0.3390350444446438, 'recall': 0.23875034740645293, 'f1-score': 0.2801896198337306, 'support': 158316}, '2': {'precision': 0.36129419984658007, 'recall': 0.4269810198578366, 'f1-score': 0.39140077491478054, 'support': 173181}, 'accuracy': 0.3655625514331913, 'macro avg': {'precision': 0.3615966045465155, 'recall': 0.36055741202900093, 'f1-score': 0.35705734789921156, 'support': 518877}, 'weighted avg': {'precision': 0.3628686266772616, 'recall': 0.3655625514331913, 'f1-score': 0.3604231577699537, 'support': 518877}}
[[77939 39229 70212]
 [60008 37798 60510]
 [64776 34460 73945]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3186487
{'0': {'precision': 0.37055149658260667, 'recall': 0.4444680024029118, 'f1-score': 0.4041578972735891, 'support': 28299}, '1': {'precision': 0.36143690860671995, 'recall': 0.2298159022949166, 'f1-score': 0.28097608245606304, 'support': 27757}, '2': {'precision': 0.3799179705301534, 'recall': 0.43951216083227895, 'f1-score': 0.40754803070053935, 'support': 28452}, 'accuracy': 0.37229611397737494, 'macro avg': {'precision': 0.37063545857316, 'recall': 0.37126535517670245, 'f1-score': 0.36422733681006375, 'support': 84508}, 'weighted avg': {'precision': 0.3707112601352752, 'recall': 0.37229611397737494, 'f1-score': 0.36483970778115665, 'support': 84508}}
[[12578  5809  9912]
 [10880  6379 10498]
 [10486  5461 12505]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.324156
{'0': {'precision': 0.3870357227348001, 'recall': 0.3943752511048614, 'f1-score': 0.39067101806893256, 'support': 12445}, '1': {'precision': 0.27919140514560364, 'recall': 0.19074753718369714, 'f1-score': 0.22664677530410837, 'support': 10354}, '2': {'precision': 0.3732441471571906, 'recall': 0.46867125818914834, 'f1-score': 0.4155495978552279, 'support': 11906}, 'accuracy': 0.35911251980982567, 'macro avg': {'precision': 0.3464904250125314, 'recall': 0.3512646821592356, 'f1-score': 0.34428913040942294, 'support': 34705}, 'weighted avg': {'precision': 0.3501297275425927, 'recall': 0.35911251980982567, 'f1-score': 0.3502704233808081, 'support': 34705}}
[[4908 2618 4919]
 [3928 1975 4451]
 [3845 2481 5580]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
2900/2900 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2516762
{'0': {'precision': 0.4199423269617629, 'recall': 0.38515286293547346, 'f1-score': 0.401795940471965, 'support': 285092}, '1': {'precision': 0.24633504873621337, 'recall': 0.23972854319346545, 'f1-score': 0.2429868986343141, 'support': 171519}, '2': {'precision': 0.4260379341646362, 'recall': 0.46810990141628783, 'f1-score': 0.44608412037778133, 'support': 285747}, 'accuracy': 0.3834847876630952, 'macro avg': {'precision': 0.36410510328753753, 'recall': 0.3643304358484089, 'f1-score': 0.3636223198280201, 'support': 742358}, 'weighted avg': {'precision': 0.38217733314130353, 'recall': 0.3834847876630952, 'f1-score': 0.3821510339667415, 'support': 742358}}
[[109804  64097 111191]
 [ 61388  41118  69013]
 [ 90282  61704 133761]]
Evaluating performance on  train set...
694/694 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.269356
{'0': {'precision': 0.3778899914370624, 'recall': 0.505159498358724, 'f1-score': 0.43235338611265195, 'support': 59405}, '1': {'precision': 0.3485058381159707, 'recall': 0.26439677031896436, 'f1-score': 0.3006801301448478, 'support': 59944}, '2': {'precision': 0.3728681729364673, 'recall': 0.3374075154927643, 'f1-score': 0.3542526539660797, 'support': 58253}, 'accuracy': 0.3688753505028097, 'macro avg': {'precision': 0.3664213341631668, 'recall': 0.36898792805681757, 'f1-score': 0.3624287234078598, 'support': 177602}, 'weighted avg': {'precision': 0.3663251459972887, 'recall': 0.3688753505028097, 'f1-score': 0.3622943574673196, 'support': 177602}}
[[30009 14789 14607]
 [25644 15849 18451]
 [23759 14839 19655]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.259771
{'0': {'precision': 0.377984508504352, 'recall': 0.4788326336553538, 'f1-score': 0.42247361492290875, 'support': 19771}, '1': {'precision': 0.35791891724095115, 'recall': 0.2691284253769665, 'f1-score': 0.3072372628437433, 'support': 21421}, '2': {'precision': 0.37090392614385714, 'recall': 0.3716391359593393, 'f1-score': 0.3712711670771028, 'support': 19675}, 'accuracy': 0.37038132321290684, 'macro avg': {'precision': 0.36893578396305343, 'recall': 0.3732000649972198, 'f1-score': 0.3669940149479183, 'support': 60867}, 'weighted avg': {'precision': 0.3686340314248829, 'recall': 0.37038132321290684, 'f1-score': 0.36536736590038366, 'support': 60867}}
[[9467 5250 5054]
 [8308 5765 7348]
 [7271 5092 7312]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
7167/7167 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98861116
{'0': {'precision': 0.4845041113602845, 'recall': 0.4634168964604352, 'f1-score': 0.47372595344224927, 'support': 517493}, '1': {'precision': 0.596119457933767, 'recall': 0.5110625703739794, 'f1-score': 0.5503238575633639, 'support': 798413}, '2': {'precision': 0.47390281617257585, 'recall': 0.5985713321700905, 'f1-score': 0.5289911005014594, 'support': 518665}, 'accuracy': 0.5223629938552392, 'macro avg': {'precision': 0.5181754618222091, 'recall': 0.5243502663348351, 'f1-score': 0.5176803038356909, 'support': 1834571}, 'weighted avg': {'precision': 0.530082408921535, 'recall': 0.5223629938552392, 'f1-score': 0.5226860972156527, 'support': 1834571}}
[[239815 150279 127399]
 [173122 408039 217252]
 [ 82033 126174 310458]]
Evaluating performance on  train set...
1570/1570 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99418944
{'0': {'precision': 0.4212999044187927, 'recall': 0.5681016021573604, 'f1-score': 0.4838099580367622, 'support': 100864}, '1': {'precision': 0.6859630101038672, 'recall': 0.4351670479636746, 'f1-score': 0.5325135937104502, 'support': 200631}, '2': {'precision': 0.43935091864085946, 'recall': 0.6068719811584368, 'f1-score': 0.5096997254992351, 'support': 100204}, 'accuracy': 0.5113779222751363, 'macro avg': {'precision': 0.5155379443878397, 'recall': 0.5367135437598239, 'f1-score': 0.5086744257488158, 'support': 401699}, 'weighted avg': {'precision': 0.5579903302993903, 'recall': 0.5113779222751363, 'f1-score': 0.5145934984181357, 'support': 401699}}
[[57301 19507 24056]
 [59779 87308 53544]
 [18930 20463 60811]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.012779
{'0': {'precision': 0.44777380565485864, 'recall': 0.4036444600691393, 'f1-score': 0.4245655121410083, 'support': 34134}, '1': {'precision': 0.6778579197435457, 'recall': 0.4086305364321825, 'f1-score': 0.5098875074008289, 'support': 57957}, '2': {'precision': 0.4072316045434862, 'recall': 0.7264327520128346, 'f1-score': 0.5218941099881538, 'support': 33659}, 'accuracy': 0.49234194831013917, 'macro avg': {'precision': 0.5109544433139636, 'recall': 0.5129025828380521, 'f1-score': 0.48544904317666365, 'support': 125750}, 'weighted avg': {'precision': 0.5429656549831318, 'recall': 0.49234194831013917, 'f1-score': 0.4899411793713105, 'support': 125750}}
[[13778  6078 14278]
 [12961 23683 21313]
 [ 4031  5177 24451]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
6357/6357 - 42s - 42s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1500514
{'0': {'precision': 0.3657421775436437, 'recall': 0.5731184153072184, 'f1-score': 0.44652758631253253, 'support': 483223}, '1': {'precision': 0.49199935799471045, 'recall': 0.5311115798354777, 'f1-score': 0.5108078638212782, 'support': 663740}, '2': {'precision': 0.4495448117664692, 'recall': 0.1436550147228481, 'f1-score': 0.2177322503112873, 'support': 480206}, 'accuracy': 0.4292412158786211, 'macro avg': {'precision': 0.4357621157682745, 'recall': 0.4159616699551814, 'f1-score': 0.3916892334816993, 'support': 1627169}, 'weighted avg': {'precision': 0.44197548135056064, 'recall': 0.4292412158786211, 'f1-score': 0.4052267123860018, 'support': 1627169}}
[[276944 176285  29994]
 [256745 352520  54475]
 [223522 187700  68984]]
Evaluating performance on  train set...
1701/1701 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0515252
{'0': {'precision': 0.397475043308117, 'recall': 0.5126832561728395, 'f1-score': 0.4477875981944162, 'support': 124416}, '1': {'precision': 0.5453385999655588, 'recall': 0.5491181012761115, 'f1-score': 0.5472218247207515, 'support': 184545}, '2': {'precision': 0.4786345886260604, 'recall': 0.33730042623184164, 'f1-score': 0.39572673757845367, 'support': 126457}, 'accuracy': 0.4771897349213859, 'macro avg': {'precision': 0.47381607729991204, 'recall': 0.4663672612269309, 'f1-score': 0.4635787201645405, 'support': 435418}, 'weighted avg': {'precision': 0.4837155585959984, 'recall': 0.4771897349213859, 'f1-score': 0.474811352571566, 'support': 435418}}
[[ 63786  41305  19325]
 [ 56071 101337  27137]
 [ 40621  43182  42654]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1353676
{'0': {'precision': 0.3558846453624318, 'recall': 0.6521614930489431, 'f1-score': 0.4604834100917739, 'support': 42008}, '1': {'precision': 0.5312907824201417, 'recall': 0.4381996423130423, 'f1-score': 0.48027587458596127, 'support': 60388}, '2': {'precision': 0.44881889763779526, 'recall': 0.18606437366488252, 'f1-score': 0.2630694833290914, 'support': 41663}, 'accuracy': 0.427671995501843, 'macro avg': {'precision': 0.4453314418067896, 'recall': 0.42547516967562266, 'f1-score': 0.40127625600227557, 'support': 144059}, 'weighted avg': {'precision': 0.4562903510607183, 'recall': 0.427671995501843, 'f1-score': 0.4116865346113204, 'support': 144059}}
[[27396 11087  3525]
 [27931 26462  5995]
 [21653 12258  7752]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
7459/7459 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1493429
{'0': {'precision': 0.4287433418415502, 'recall': 0.5969890205960248, 'f1-score': 0.4990679383943702, 'support': 700038}, '1': {'precision': 0.3427525265217302, 'recall': 0.3848277620562381, 'f1-score': 0.36257356003493274, 'support': 478466}, '2': {'precision': 0.5002818985869834, 'recall': 0.2720024851282318, 'f1-score': 0.3524036547928156, 'support': 730747}, 'accuracy': 0.4194351606991433, 'macro avg': {'precision': 0.42392592231675463, 'recall': 0.4179397559268316, 'f1-score': 0.4046817177407062, 'support': 1909251}, 'weighted avg': {'precision': 0.43457437415906225, 'recall': 0.4194351606991433, 'f1-score': 0.4087275879191776, 'support': 1909251}}
[[417915 167829 114294]
 [210092 184127  84247]
 [346737 185245 198765]]
Evaluating performance on  train set...
1664/1664 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0132626
{'0': {'precision': 0.45459995777918516, 'recall': 0.4310915016455402, 'f1-score': 0.4425337432390221, 'support': 124883}, '1': {'precision': 0.5597749302799857, 'recall': 0.5171791466612183, 'f1-score': 0.537634662355898, 'support': 176202}, '2': {'precision': 0.4532346763941856, 'recall': 0.5253367286471596, 'f1-score': 0.4866294293492371, 'support': 124878}, 'accuracy': 0.49433166730443723, 'macro avg': {'precision': 0.4892031881511188, 'recall': 0.4912024589846394, 'f1-score': 0.48893261164805235, 'support': 425963}, 'weighted avg': {'precision': 0.49770592448472084, 'recall': 0.49433166730443723, 'f1-score': 0.4948001448755567, 'support': 425963}}
[[53836 37761 33286]
 [39219 91128 45855]
 [25370 33905 65603]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0315424
{'0': {'precision': 0.46163079585741007, 'recall': 0.38070353147014135, 'f1-score': 0.4172796204943163, 'support': 43438}, '1': {'precision': 0.5100002259938078, 'recall': 0.5042003664149426, 'f1-score': 0.507083712516993, 'support': 44758}, '2': {'precision': 0.47608628896054045, 'recall': 0.5640291041382447, 'f1-score': 0.5163398692810458, 'support': 43980}, 'accuracy': 0.4835219707057257, 'macro avg': {'precision': 0.48257243693725277, 'recall': 0.48297766734110953, 'f1-score': 0.48023440076411833, 'support': 132176}, 'weighted avg': {'precision': 0.4828197525569664, 'recall': 0.4835219707057257, 'f1-score': 0.48065059020433415, 'support': 132176}}
[[16537 11861 15040]
 [ 9933 22567 12258]
 [ 9353  9821 24806]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
8238/8238 - 54s - 54s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1350385
{'0': {'precision': 0.47413949081282347, 'recall': 0.48012444371585755, 'f1-score': 0.47711319904940785, 'support': 829612}, '1': {'precision': 0.29858061545040376, 'recall': 0.39640930122870727, 'f1-score': 0.3406096413504683, 'support': 457961}, '2': {'precision': 0.4926811177378826, 'recall': 0.3963691984689597, 'f1-score': 0.4393083634945177, 'support': 821141}, 'accuracy': 0.42932896542632143, 'macro avg': {'precision': 0.42180040800036994, 'recall': 0.4243009811378415, 'f1-score': 0.4190104012981313, 'support': 2108714}, 'weighted avg': {'precision': 0.4432325835485007, 'recall': 0.42932896542632143, 'f1-score': 0.4327466295384443, 'support': 2108714}}
[[398317 214363 216932]
 [158208 181540 118213]
 [283559 212107 325475]]
Evaluating performance on  train set...
1806/1806 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0699863
{'0': {'precision': 0.4710012929587325, 'recall': 0.4262753997038991, 'f1-score': 0.44752363693130526, 'support': 154677}, '1': {'precision': 0.46559607951585624, 'recall': 0.46962816886790004, 'f1-score': 0.46760343229548484, 'support': 154156}, '2': {'precision': 0.4697599635235747, 'recall': 0.5106697971695037, 'f1-score': 0.4893613696943562, 'support': 153330}, 'accuracy': 0.468735056679137, 'macro avg': {'precision': 0.4687857786660545, 'recall': 0.4688577885804343, 'f1-score': 0.4681628129737154, 'support': 462163}, 'weighted avg': {'precision': 0.46878653512266005, 'recall': 0.468735056679137, 'f1-score': 0.4681016591847506, 'support': 462163}}
[[65935 42795 45947]
 [39325 72396 42435]
 [34729 40300 78301]]
Evaluating performance on  val set...
642/642 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.075496
{'0': {'precision': 0.46338128641065274, 'recall': 0.41756691605806834, 'f1-score': 0.43928279593121006, 'support': 56003}, '1': {'precision': 0.4434333809750675, 'recall': 0.5295869210636118, 'f1-score': 0.4826960309777347, 'support': 52726}, '2': {'precision': 0.4908422748889675, 'recall': 0.4492831831345673, 'f1-score': 0.4691441504897679, 'support': 55593}, 'accuracy': 0.4642409415659498, 'macro avg': {'precision': 0.46588564742489585, 'recall': 0.4654790067520825, 'f1-score': 0.4637076591329043, 'support': 164322}, 'weighted avg': {'precision': 0.46627113360383615, 'recall': 0.4642409415659498, 'f1-score': 0.4633154179479635, 'support': 164322}}
[[23385 17414 15204]
 [14098 27923 10705]
 [12983 17633 24977]]
testing model on single stock: results/universal/W5/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
31315/31315 - 204s - 204s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3553165
{'0': {'precision': 0.4374572470731682, 'recall': 0.1382390309638476, 'f1-score': 0.21008878546065193, 'support': 3062507}, '1': {'precision': 0.22133025022979774, 'recall': 0.7821963545586861, 'f1-score': 0.34503064304867004, 'support': 1804226}, '2': {'precision': 0.46003387577198246, 'recall': 0.09821500289070285, 'f1-score': 0.1618712734255836, 'support': 3149753}, 'accuracy': 0.2674451124844477, 'macro avg': {'precision': 0.37294045769164946, 'recall': 0.3395501294710788, 'f1-score': 0.2389969006449685, 'support': 8016486}, 'weighted avg': {'precision': 0.39768531420473296, 'recall': 0.2674451124844477, 'f1-score': 0.22151428470852774, 'support': 8016486}}
[[ 423358 2447717  191432]
 [ 221295 1411259  171672]
 [ 323117 2517283  309353]]
Evaluating performance on  train set...
5759/5759 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.193568
{'0': {'precision': 0.4139205578734692, 'recall': 0.43663109177358217, 'f1-score': 0.4249726284507704, 'support': 497823}, '1': {'precision': 0.35786710667050176, 'recall': 0.4342967744093106, 'f1-score': 0.39239489152758433, 'support': 478424}, '2': {'precision': 0.4217906056444302, 'recall': 0.312099211728674, 'f1-score': 0.35874735531113544, 'support': 497925}, 'accuracy': 0.39381089859256585, 'macro avg': {'precision': 0.3978594233961337, 'recall': 0.3943423593038556, 'f1-score': 0.39203829176316346, 'support': 1474172}, 'weighted avg': {'precision': 0.3983873481788252, 'recall': 0.39381089859256585, 'f1-score': 0.39203129573125656, 'support': 1474172}}
[[217365 187775  92683]
 [150297 207778 120349]
 [157475 185048 155402]]
Evaluating performance on  val set...
2129/2129 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1517986
{'0': {'precision': 0.40832751593217287, 'recall': 0.4815711895466497, 'f1-score': 0.4419351693882525, 'support': 188265}, '1': {'precision': 0.36435245847730735, 'recall': 0.4353705718776448, 'f1-score': 0.39670819068918134, 'support': 165420}, '2': {'precision': 0.42966417016655756, 'recall': 0.2813625787561109, 'f1-score': 0.34004745700591155, 'support': 191255}, 'accuracy': 0.39728043454325246, 'macro avg': {'precision': 0.400781381525346, 'recall': 0.39943478006013516, 'f1-score': 0.39289693902778183, 'support': 544940}, 'weighted avg': {'precision': 0.40246703184477495, 'recall': 0.39728043454325246, 'f1-score': 0.39244718676982665, 'support': 544940}}
[[90663 62490 35112]
 [57083 72019 36318]
 [74289 63154 53812]]
training model: results/universal/W5/deepLOB_L1/h100
Epoch 1/50
9913/9913 - 156s - loss: 3.1528 - accuracy100: 0.4338 - val_loss: 3.5023 - val_accuracy100: 0.3440 - 156s/epoch - 16ms/step
Epoch 2/50
9913/9913 - 149s - loss: 3.1218 - accuracy100: 0.4462 - val_loss: 3.5536 - val_accuracy100: 0.3350 - 149s/epoch - 15ms/step
Epoch 3/50
9913/9913 - 150s - loss: 3.1059 - accuracy100: 0.4514 - val_loss: 3.4743 - val_accuracy100: 0.3607 - 150s/epoch - 15ms/step
Epoch 4/50
9913/9913 - 148s - loss: 3.0952 - accuracy100: 0.4544 - val_loss: 3.4805 - val_accuracy100: 0.3503 - 148s/epoch - 15ms/step
Epoch 5/50
9913/9913 - 150s - loss: 3.0887 - accuracy100: 0.4564 - val_loss: 3.5062 - val_accuracy100: 0.3504 - 150s/epoch - 15ms/step
Epoch 6/50
9913/9913 - 153s - loss: 3.0816 - accuracy100: 0.4583 - val_loss: 3.5399 - val_accuracy100: 0.3491 - 153s/epoch - 15ms/step
Epoch 7/50
9913/9913 - 151s - loss: 3.0766 - accuracy100: 0.4599 - val_loss: 3.4632 - val_accuracy100: 0.3562 - 151s/epoch - 15ms/step
Epoch 8/50
9913/9913 - 150s - loss: 3.0728 - accuracy100: 0.4612 - val_loss: 3.4645 - val_accuracy100: 0.3541 - 150s/epoch - 15ms/step
Epoch 9/50
9913/9913 - 150s - loss: 3.0691 - accuracy100: 0.4623 - val_loss: 3.4580 - val_accuracy100: 0.3493 - 150s/epoch - 15ms/step
Epoch 10/50
9913/9913 - 152s - loss: 3.0660 - accuracy100: 0.4632 - val_loss: 3.5314 - val_accuracy100: 0.3448 - 152s/epoch - 15ms/step
Epoch 11/50
9913/9913 - 152s - loss: 3.0639 - accuracy100: 0.4635 - val_loss: 3.5048 - val_accuracy100: 0.3466 - 152s/epoch - 15ms/step
Epoch 12/50
9913/9913 - 149s - loss: 3.0613 - accuracy100: 0.4646 - val_loss: 3.5174 - val_accuracy100: 0.3475 - 149s/epoch - 15ms/step
Epoch 13/50
9913/9913 - 151s - loss: 3.0593 - accuracy100: 0.4651 - val_loss: 3.5023 - val_accuracy100: 0.3539 - 151s/epoch - 15ms/step
Epoch 14/50
9913/9913 - 149s - loss: 3.0568 - accuracy100: 0.4656 - val_loss: 3.4381 - val_accuracy100: 0.3562 - 149s/epoch - 15ms/step
Epoch 15/50
9913/9913 - 151s - loss: 3.0548 - accuracy100: 0.4664 - val_loss: 3.4580 - val_accuracy100: 0.3603 - 151s/epoch - 15ms/step
Epoch 16/50
9913/9913 - 152s - loss: 3.0533 - accuracy100: 0.4669 - val_loss: 3.4720 - val_accuracy100: 0.3539 - 152s/epoch - 15ms/step
Epoch 17/50
9913/9913 - 150s - loss: 3.0513 - accuracy100: 0.4672 - val_loss: 3.4788 - val_accuracy100: 0.3574 - 150s/epoch - 15ms/step
Epoch 18/50
9913/9913 - 151s - loss: 3.0497 - accuracy100: 0.4679 - val_loss: 3.5149 - val_accuracy100: 0.3424 - 151s/epoch - 15ms/step
Epoch 19/50
9913/9913 - 152s - loss: 3.0480 - accuracy100: 0.4683 - val_loss: 3.4438 - val_accuracy100: 0.3506 - 152s/epoch - 15ms/step
Epoch 20/50
9913/9913 - 150s - loss: 3.0463 - accuracy100: 0.4689 - val_loss: 3.4582 - val_accuracy100: 0.3530 - 150s/epoch - 15ms/step
Epoch 21/50
9913/9913 - 151s - loss: 3.0445 - accuracy100: 0.4693 - val_loss: 3.4549 - val_accuracy100: 0.3504 - 151s/epoch - 15ms/step
Epoch 22/50
9913/9913 - 150s - loss: 3.0437 - accuracy100: 0.4694 - val_loss: 3.4668 - val_accuracy100: 0.3362 - 150s/epoch - 15ms/step
Epoch 23/50
9913/9913 - 150s - loss: 3.0420 - accuracy100: 0.4701 - val_loss: 3.4427 - val_accuracy100: 0.3404 - 150s/epoch - 15ms/step
Epoch 24/50
9913/9913 - 149s - loss: 3.0405 - accuracy100: 0.4704 - val_loss: 3.4301 - val_accuracy100: 0.3385 - 149s/epoch - 15ms/step
Epoch 25/50
9913/9913 - 152s - loss: 3.0393 - accuracy100: 0.4710 - val_loss: 3.4663 - val_accuracy100: 0.3404 - 152s/epoch - 15ms/step
Epoch 26/50
9913/9913 - 149s - loss: 3.0379 - accuracy100: 0.4714 - val_loss: 3.4720 - val_accuracy100: 0.3490 - 149s/epoch - 15ms/step
Epoch 27/50
9913/9913 - 147s - loss: 3.0367 - accuracy100: 0.4716 - val_loss: 3.4480 - val_accuracy100: 0.3418 - 147s/epoch - 15ms/step
Epoch 28/50
9913/9913 - 148s - loss: 3.0354 - accuracy100: 0.4720 - val_loss: 3.4792 - val_accuracy100: 0.3361 - 148s/epoch - 15ms/step
Epoch 29/50
9913/9913 - 148s - loss: 3.0346 - accuracy100: 0.4723 - val_loss: 3.5435 - val_accuracy100: 0.3339 - 148s/epoch - 15ms/step
Epoch 30/50
9913/9913 - 149s - loss: 3.0333 - accuracy100: 0.4726 - val_loss: 3.5901 - val_accuracy100: 0.3310 - 149s/epoch - 15ms/step
Epoch 31/50
9913/9913 - 151s - loss: 3.0324 - accuracy100: 0.4727 - val_loss: 3.5542 - val_accuracy100: 0.3340 - 151s/epoch - 15ms/step
Epoch 32/50
9913/9913 - 150s - loss: 3.0314 - accuracy100: 0.4733 - val_loss: 3.6025 - val_accuracy100: 0.3295 - 150s/epoch - 15ms/step
Epoch 33/50
9913/9913 - 149s - loss: 3.0301 - accuracy100: 0.4737 - val_loss: 3.6608 - val_accuracy100: 0.3284 - 149s/epoch - 15ms/step
Epoch 34/50
9913/9913 - 152s - loss: 3.0293 - accuracy100: 0.4737 - val_loss: 3.6199 - val_accuracy100: 0.3307 - 152s/epoch - 15ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 319s - 319s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1985848
{'0': {'precision': 0.4362320541358404, 'recall': 0.13714227541384919, 'f1-score': 0.20867992663582258, 'support': 5068634}, '1': {'precision': 0.1999113251099297, 'recall': 0.74029461545126, 'f1-score': 0.31481034348341397, 'support': 2585472}, '2': {'precision': 0.4552830150279717, 'recall': 0.14671338477726437, 'f1-score': 0.22191532104830658, 'support': 5184285}, 'accuracy': 0.2624736230575934, 'macro avg': {'precision': 0.3638087980912472, 'recall': 0.3413834252141245, 'f1-score': 0.24846853038918104, 'support': 12838391}, 'weighted avg': {'precision': 0.39633336144705905, 'recall': 0.2624736230575934, 'f1-score': 0.23539770441884073, 'support': 12838391}}
[[ 695124 3807775  565735]
 [ 327182 1914011  344279]
 [ 571167 3852514  760604]]
Evaluating performance on  train set...
9913/9913 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.134541
{'0': {'precision': 0.37741971289596166, 'recall': 0.29816119236608946, 'f1-score': 0.33314118484706745, 'support': 832496}, '1': {'precision': 0.3443538365321356, 'recall': 0.48666887828485567, 'f1-score': 0.40332542629737145, 'support': 871157}, '2': {'precision': 0.38195108705713915, 'recall': 0.29706736422760327, 'f1-score': 0.33420359190902516, 'support': 833380}, 'accuracy': 0.36253095643612043, 'macro avg': {'precision': 0.36790821216174546, 'recall': 0.36063247829284945, 'f1-score': 0.356890067684488, 'support': 2537033}, 'weighted avg': {'precision': 0.3675541679633417, 'recall': 0.36253095643612043, 'f1-score': 0.3575897757902743, 'support': 2537033}}
[[248218 413951 170327]
 [216917 423965 230275]
 [192536 393274 247570]]
Evaluating performance on  val set...
3496/3496 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1392164
{'0': {'precision': 0.3784430817020593, 'recall': 0.23015337912884304, 'f1-score': 0.28623220694627854, 'support': 307017}, '1': {'precision': 0.29903331700335983, 'recall': 0.5610150601755693, 'f1-score': 0.39012269259415827, 'support': 276358}, '2': {'precision': 0.4071205628736179, 'recall': 0.247577563021966, 'f1-score': 0.30790959321749084, 'support': 310844}, 'accuracy': 0.3384629492327942, 'macro avg': {'precision': 0.36153232052634565, 'recall': 0.3462486674421261, 'f1-score': 0.32808816425264253, 'support': 894219}, 'weighted avg': {'precision': 0.3638702524563027, 'recall': 0.3384629492327942, 'f1-score': 0.3258749033000414, 'support': 894219}}
[[ 70661 183780  52576]
 [ 61821 155041  59496]
 [ 54233 179653  76958]]
testing model out of sample: results/universal/W5/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 142s - 142s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.173057
{'0': {'precision': 0.38944498113240916, 'recall': 0.183226173488703, 'f1-score': 0.24920589452242273, 'support': 1922984}, '1': {'precision': 0.27964009530490513, 'recall': 0.7159303526536197, 'f1-score': 0.40218717310916596, 'support': 1505585}, '2': {'precision': 0.3968707912243742, 'recall': 0.12184296520029683, 'f1-score': 0.1864454659443298, 'support': 1920275}, 'accuracy': 0.31113395716906306, 'macro avg': {'precision': 0.3553186225538962, 'recall': 0.34033316378087314, 'f1-score': 0.2792795111919728, 'support': 5348844}, 'weighted avg': {'precision': 0.3612031794357707, 'recall': 0.31113395716906306, 'f1-score': 0.26973538394728247, 'support': 5348844}}
[[ 352341 1392246  178397]
 [ 250518 1077894  177173]
 [ 301867 1384436  233972]]
Evaluating performance on  train set...
4957/4957 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1358806
{'0': {'precision': 0.376525907886474, 'recall': 0.28858367083406705, 'f1-score': 0.32674083230325507, 'support': 425925}, '1': {'precision': 0.3424183442574468, 'recall': 0.592411286925605, 'f1-score': 0.4339881518983811, 'support': 420203}, '2': {'precision': 0.41390509692248995, 'recall': 0.21068363112719557, 'f1-score': 0.27923343744604706, 'support': 422216}, 'accuracy': 0.36330995376648606, 'macro avg': {'precision': 0.37761644968880365, 'recall': 0.36389286296228923, 'f1-score': 0.3466541405492278, 'support': 1268344}, 'weighted avg': {'precision': 0.3776691238581839, 'recall': 0.36330995376648606, 'f1-score': 0.34645729976697137, 'support': 1268344}}
[[122915 241509  61501]
 [106811 248933  64459]
 [ 96719 236543  88954]]
Evaluating performance on  val set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1487331
{'0': {'precision': 0.3749364183730201, 'recall': 0.2152573566863841, 'f1-score': 0.2734960135298381, 'support': 147247}, '1': {'precision': 0.33358129038286005, 'recall': 0.6549011584428045, 'f1-score': 0.4420164946097292, 'support': 141742}, '2': {'precision': 0.3982369466240434, 'recall': 0.19699075183286213, 'f1-score': 0.2635932290330854, 'support': 146083}, 'accuracy': 0.3523554721977052, 'macro avg': {'precision': 0.3689182184599746, 'recall': 0.3557164223206836, 'f1-score': 0.32636857905755084, 'support': 435072}, 'weighted avg': {'precision': 0.369286899481694, 'recall': 0.3523554721977052, 'f1-score': 0.3250732273279837, 'support': 435072}}
[[31696 94049 21502]
 [26933 92827 21982]
 [25908 91398 28777]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1873221
{'0': {'precision': 0.36601274396668504, 'recall': 0.21935671400936163, 'f1-score': 0.27431343302290023, 'support': 99769}, '1': {'precision': 0.2532951993943433, 'recall': 0.5497584405370485, 'f1-score': 0.3468041657253474, 'support': 71204}, '2': {'precision': 0.39795381159623755, 'recall': 0.2259858291727705, 'f1-score': 0.2882712243613782, 'support': 100347}, 'accuracy': 0.3085176175733451, 'macro avg': {'precision': 0.339087251652422, 'recall': 0.33170032790639353, 'f1-score': 0.30312960770320857, 'support': 271320}, 'weighted avg': {'precision': 0.34824497995995385, 'recall': 0.3085176175733451, 'f1-score': 0.2984998277552727, 'support': 271320}}
[[21885 59048 18836]
 [16588 39145 15471]
 [21320 56350 22677]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1512872
{'0': {'precision': 0.36940035962786333, 'recall': 0.2002712669011995, 'f1-score': 0.2597295514511873, 'support': 23593}, '1': {'precision': 0.336965085653828, 'recall': 0.6508543849732598, 'f1-score': 0.444039037702827, 'support': 22999}, '2': {'precision': 0.3614612605379366, 'recall': 0.1950860163799454, 'f1-score': 0.2534053810649556, 'support': 23077}, 'accuracy': 0.34729937274828115, 'macro avg': {'precision': 0.3559422352732093, 'recall': 0.34873722275146823, 'f1-score': 0.31905799007298996, 'support': 69669}, 'weighted avg': {'precision': 0.3560631586370772, 'recall': 0.34729937274828115, 'f1-score': 0.318478650681812, 'support': 69669}}
[[ 4725 14904  3964]
 [ 4041 14969  3989]
 [ 4025 14550  4502]]
Evaluating performance on  val set...
96/96 - 1s - 680ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1637241
{'0': {'precision': 0.41305620608899296, 'recall': 0.16054158607350097, 'f1-score': 0.23121671446128633, 'support': 8789}, '1': {'precision': 0.29597767960939314, 'recall': 0.7042876901798064, 'f1-score': 0.41679626749611204, 'support': 7230}, '2': {'precision': 0.3913939706261273, 'recall': 0.17908512143362415, 'f1-score': 0.24573323626951388, 'support': 8482}, 'accuracy': 0.32741520754254927, 'macro avg': {'precision': 0.36680928544150443, 'recall': 0.34797146589564387, 'f1-score': 0.29791540607563743, 'support': 24501}, 'weighted avg': {'precision': 0.37100825589742803, 'recall': 0.32741520754254927, 'f1-score': 0.29100485806437093, 'support': 24501}}
[[1411 6247 1131]
 [ 907 5092 1231]
 [1098 5865 1519]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1148404
{'0': {'precision': 0.4308829506197927, 'recall': 0.18329461343130368, 'f1-score': 0.2571846595862425, 'support': 185090}, '1': {'precision': 0.3641137648729934, 'recall': 0.7591831865475783, 'f1-score': 0.49217448321662455, 'support': 192798}, '2': {'precision': 0.41315953773428643, 'recall': 0.17883497501626977, 'f1-score': 0.24962182593600488, 'support': 181318}, 'accuracy': 0.3803982789884229, 'macro avg': {'precision': 0.4027187510756909, 'recall': 0.3737709249983839, 'f1-score': 0.3329936562462906, 'support': 559206}, 'weighted avg': {'precision': 0.4021162005291541, 'recall': 0.3803982789884229, 'f1-score': 0.33575014376290835, 'support': 559206}}
[[ 33926 130783  20381]
 [ 20753 146369  25676]
 [ 24057 124835  32426]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0196042
{'0': {'precision': 0.4240199090573922, 'recall': 0.3731008380643417, 'f1-score': 0.3969340504472375, 'support': 36990}, '1': {'precision': 0.5767866554607485, 'recall': 0.5332885534789996, 'f1-score': 0.5541853717288953, 'support': 75927}, '2': {'precision': 0.36272996537482793, 'recall': 0.46036956636840154, 'f1-score': 0.4057585514956368, 'support': 37774}, 'accuracy': 0.4756886609021109, 'macro avg': {'precision': 0.4545121766309895, 'recall': 0.45558631930391424, 'f1-score': 0.45229265789058987, 'support': 150691}, 'weighted avg': {'precision': 0.4856291254107407, 'recall': 0.4756886609021109, 'f1-score': 0.47837858113290993, 'support': 150691}}
[[13801 15055  8134]
 [13018 40491 22418]
 [ 5729 14655 17390]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0850298
{'0': {'precision': 0.36637931034482757, 'recall': 0.5139437314906219, 'f1-score': 0.4277937551355792, 'support': 16208}, '1': {'precision': 0.48257241040746196, 'recall': 0.4155393980385526, 'f1-score': 0.44655430881751695, 'support': 23656}, '2': {'precision': 0.44609363461822477, 'recall': 0.3599261201143947, 'f1-score': 0.3984040097606015, 'support': 16784}, 'accuracy': 0.42721720096031635, 'macro avg': {'precision': 0.4316817851235048, 'recall': 0.42980308321452304, 'f1-score': 0.4242506912378992, 'support': 56648}, 'weighted avg': {'precision': 0.43851935401250125, 'recall': 0.42721720096031635, 'f1-score': 0.4269203292692873, 'support': 56648}}
[[8330 5299 2579]
 [8904 9830 4922]
 [5502 5241 6041]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
2341/2341 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1834171
{'0': {'precision': 0.3658636043025921, 'recall': 0.15923349961627015, 'f1-score': 0.22189321426661673, 'support': 208480}, '1': {'precision': 0.2883867005119986, 'recall': 0.6712702862695603, 'f1-score': 0.40344711845064274, 'support': 179062}, '2': {'precision': 0.38374260209920547, 'recall': 0.16627861396706353, 'f1-score': 0.232020824409371, 'support': 211741}, 'accuracy': 0.3147160857224383, 'macro avg': {'precision': 0.345997635637932, 'recall': 0.33226079995096464, 'f1-score': 0.2857870523755435, 'support': 599283}, 'weighted avg': {'precision': 0.3490310686323019, 'recall': 0.3147160857224383, 'f1-score': 0.2797187082156141, 'support': 599283}}
[[ 33197 148299  26984]
 [ 29306 120199  29557]
 [ 28233 148300  35208]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1574826
{'0': {'precision': 0.35696229197387824, 'recall': 0.1640288466192343, 'f1-score': 0.22477201127507876, 'support': 41322}, '1': {'precision': 0.33232314578826755, 'recall': 0.7535207847707848, 'f1-score': 0.4612309201432754, 'support': 41184}, '2': {'precision': 0.36288437331415213, 'recall': 0.09847264919728688, 'f1-score': 0.15490903508098564, 'support': 40986}, 'accuracy': 0.338864055971237, 'macro avg': {'precision': 0.35072327035876594, 'recall': 0.338674093529102, 'f1-score': 0.28030398883311325, 'support': 123492}, 'weighted avg': {'precision': 0.35071074393274415, 'recall': 0.338864055971237, 'f1-score': 0.2804429839740124, 'support': 123492}}
[[ 6778 31200  3344]
 [ 6409 31033  3742]
 [ 5801 31149  4036]]
Evaluating performance on  val set...
162/162 - 1s - 984ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1804745
{'0': {'precision': 0.3776313380926231, 'recall': 0.1404739207408416, 'f1-score': 0.20477443049282845, 'support': 14686}, '1': {'precision': 0.2896833044260294, 'recall': 0.7477821076196004, 'f1-score': 0.41759462900798705, 'support': 12061}, '2': {'precision': 0.3988573846804909, 'recall': 0.12932217343578487, 'f1-score': 0.19531654750803026, 'support': 14576}, 'accuracy': 0.3137961909832297, 'macro avg': {'precision': 0.3553906757330478, 'recall': 0.33919273393207566, 'f1-score': 0.2725618690029486, 'support': 41323}, 'weighted avg': {'precision': 0.3594489607485768, 'recall': 0.3137961909832297, 'f1-score': 0.26355443949277785, 'support': 41323}}
[[ 2063 11173  1450]
 [ 1651  9019  1391]
 [ 1749 10942  1885]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
2027/2027 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1672429
{'0': {'precision': 0.34949886048962187, 'recall': 0.16055025216138327, 'f1-score': 0.220026380950177, 'support': 177664}, '1': {'precision': 0.33521614099946706, 'recall': 0.7411938157475295, 'f1-score': 0.46164591676283767, 'support': 175672}, '2': {'precision': 0.3343435170775657, 'recall': 0.09863417521943205, 'f1-score': 0.15232977418286475, 'support': 165541}, 'accuracy': 0.3373805352713649, 'macro avg': {'precision': 0.3396861728555516, 'recall': 0.3334594143761149, 'f1-score': 0.2780006906319598, 'support': 518877}, 'weighted avg': {'precision': 0.3398281589513967, 'recall': 0.3373805352713649, 'f1-score': 0.2802318306317279, 'support': 518877}}
[[ 28524 133698  15442]
 [ 28399 130207  17066]
 [ 24691 124522  16328]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2008964
{'0': {'precision': 0.3336240913811007, 'recall': 0.285917698989036, 'f1-score': 0.30793413460616864, 'support': 28092}, '1': {'precision': 0.31253947855633724, 'recall': 0.5143932604409392, 'f1-score': 0.38883017640842205, 'support': 27895}, '2': {'precision': 0.3601432309599229, 'recall': 0.18337365450019283, 'f1-score': 0.24301280115233598, 'support': 28521}, 'accuracy': 0.32672646376674397, 'macro avg': {'precision': 0.3354356002991203, 'recall': 0.32789487131005607, 'f1-score': 0.3132590373889756, 'support': 84508}, 'weighted avg': {'precision': 0.33561440123556197, 'recall': 0.32672646376674397, 'f1-score': 0.3127262694885123, 'support': 84508}}
[[ 8032 15829  4231]
 [ 8485 14349  5061]
 [ 7558 15733  5230]]
Evaluating performance on  val set...
136/136 - 1s - 886ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1797026
{'0': {'precision': 0.37390967241713513, 'recall': 0.155765503875969, 'f1-score': 0.21991677592202016, 'support': 12384}, '1': {'precision': 0.2941078700241004, 'recall': 0.6714732947538185, 'f1-score': 0.409050192157656, 'support': 10541}, '2': {'precision': 0.3452554744525547, 'recall': 0.1606112054329372, 'f1-score': 0.21923522595596753, 'support': 11780}, 'accuracy': 0.3140469672957787, 'macro avg': {'precision': 0.3377576722979301, 'recall': 0.32928333468757487, 'f1-score': 0.2827340646785479, 'support': 34705}, 'weighted avg': {'precision': 0.3399451932052712, 'recall': 0.3140469672957787, 'f1-score': 0.2771312027175752, 'support': 34705}}
[[1929 8739 1716]
 [1591 7078 1872]
 [1639 8249 1892]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
2900/2900 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1833012
{'0': {'precision': 0.3657373671947391, 'recall': 0.15473118525115512, 'f1-score': 0.217461654698386, 'support': 262746}, '1': {'precision': 0.29403286547472063, 'recall': 0.7822668945075385, 'f1-score': 0.42741285487577163, 'support': 218281}, '2': {'precision': 0.36890703019735277, 'recall': 0.07124298303683833, 'f1-score': 0.11942308987520805, 'support': 261331}, 'accuracy': 0.3098599328086988, 'macro avg': {'precision': 0.3428924209556041, 'recall': 0.33608035426517735, 'f1-score': 0.2547658664831219, 'support': 742358}, 'weighted avg': {'precision': 0.3457693744771941, 'recall': 0.3098599328086988, 'f1-score': 0.24468280910382645, 'support': 742358}}
[[ 40655 205061  17030]
 [ 32707 170754  14820]
 [ 37797 204916  18618]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1726775
{'0': {'precision': 0.3574291792632404, 'recall': 0.2632611994458006, 'f1-score': 0.3032018464519438, 'support': 60628}, '1': {'precision': 0.3196722887858915, 'recall': 0.5793858273205759, 'f1-score': 0.41201695461418336, 'support': 57378}, '2': {'precision': 0.3680102234656167, 'recall': 0.17878716692395463, 'f1-score': 0.24065771493749222, 'support': 59596}, 'accuracy': 0.3370457539892569, 'macro avg': {'precision': 0.3483705638382495, 'recall': 0.3404780645634437, 'f1-score': 0.31862550533453976, 'support': 177602}, 'weighted avg': {'precision': 0.34878160236926115, 'recall': 0.3370457539892569, 'f1-score': 0.3173695541038718, 'support': 177602}}
[[15961 35688  8979]
 [14815 33244  9319]
 [13879 35062 10655]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1531056
{'0': {'precision': 0.357839291718032, 'recall': 0.15585493239615367, 'f1-score': 0.21713702822169328, 'support': 20487}, '1': {'precision': 0.32453273774538616, 'recall': 0.6868003383252899, 'f1-score': 0.44078296133090655, 'support': 20099}, '2': {'precision': 0.36008077372728237, 'recall': 0.16705290666140724, 'f1-score': 0.22822499157965645, 'support': 20281}, 'accuracy': 0.33491054265858344, 'macro avg': {'precision': 0.3474842677302335, 'recall': 0.33656939246095025, 'f1-score': 0.29538166037741875, 'support': 60867}, 'weighted avg': {'precision': 0.34758794153375144, 'recall': 0.33491054265858344, 'f1-score': 0.2946820788143778, 'support': 60867}}
[[ 3193 14529  2765]
 [ 3039 13804  3256]
 [ 2691 14202  3388]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
7167/7167 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1069163
{'0': {'precision': 0.474178378260964, 'recall': 0.2703228153273429, 'f1-score': 0.34434124560917484, 'support': 646035}, '1': {'precision': 0.31408735819577477, 'recall': 0.6528641974843785, 'f1-score': 0.4241296057572118, 'support': 531161}, '2': {'precision': 0.4880093870789619, 'recall': 0.2688830576155163, 'f1-score': 0.3467268224505309, 'support': 657375}, 'accuracy': 0.3805636304073268, 'macro avg': {'precision': 0.4254250411785669, 'recall': 0.3973566901424126, 'f1-score': 0.37173255793897253, 'support': 1834571}, 'weighted avg': {'precision': 0.43278344348486947, 'recall': 0.3805636304073268, 'f1-score': 0.36829708255453036, 'support': 1834571}}
[[174638 378863  92534]
 [ 91476 346776  92909]
 [102182 378436 176757]]
Evaluating performance on  train set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1150777
{'0': {'precision': 0.39300988054859165, 'recall': 0.2624004968530118, 'f1-score': 0.3146913490535189, 'support': 132031}, '1': {'precision': 0.35673340470279175, 'recall': 0.6687209120280099, 'f1-score': 0.4652671188790414, 'support': 140522}, '2': {'precision': 0.43295164379189277, 'recall': 0.16805011382466356, 'f1-score': 0.24212099914097976, 'support': 129146}, 'accuracy': 0.37420556187593196, 'macro avg': {'precision': 0.3942316430144254, 'recall': 0.3663905075685618, 'f1-score': 0.34069315569118, 'support': 401699}, 'weighted avg': {'precision': 0.39316092901277966, 'recall': 0.37420556187593196, 'f1-score': 0.34403430962254516, 'support': 401699}}
[[34645 85366 12020]
 [30147 93970 16405]
 [23361 84082 21703]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1083763
{'0': {'precision': 0.43607981852435695, 'recall': 0.26322263222632225, 'f1-score': 0.32828735998147557, 'support': 43089}, '1': {'precision': 0.34394595250616933, 'recall': 0.6231310466138962, 'f1-score': 0.44323957980345646, 'support': 40932}, '2': {'precision': 0.4217479674796748, 'recall': 0.2585731745309018, 'f1-score': 0.3205918618988903, 'support': 41729}, 'accuracy': 0.378831013916501, 'macro avg': {'precision': 0.4005912461700671, 'recall': 0.3816422844570401, 'f1-score': 0.3640396005612741, 'support': 125750}, 'weighted avg': {'precision': 0.4013340752551721, 'recall': 0.378831013916501, 'f1-score': 0.3631509689060491, 'support': 125750}}
[[11342 24710  7037]
 [ 7669 25506  7757]
 [ 6998 23941 10790]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
6357/6357 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1513567
{'0': {'precision': 0.381148763900827, 'recall': 0.15154740128311148, 'f1-score': 0.2168669813926498, 'support': 564721}, '1': {'precision': 0.31200980997948546, 'recall': 0.7743893268743668, 'f1-score': 0.44480349538553865, 'support': 505344}, '2': {'precision': 0.386161631816926, 'recall': 0.10286409718831672, 'f1-score': 0.16245430565142885, 'support': 557104}, 'accuracy': 0.328313162308279, 'macro avg': {'precision': 0.35977340189907947, 'recall': 0.3429336084485983, 'f1-score': 0.27470826080987243, 'support': 1627169}, 'weighted avg': {'precision': 0.3613928155249078, 'recall': 0.328313162308279, 'f1-score': 0.26902679418473546, 'support': 1627169}}
[[ 85582 435699  43440]
 [ 66358 391333  47653]
 [ 72597 427201  57306]]
Evaluating performance on  train set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1202053
{'0': {'precision': 0.3857703838196174, 'recall': 0.3137129671597511, 'f1-score': 0.3460301709281935, 'support': 145614}, '1': {'precision': 0.3511115614550613, 'recall': 0.5975952152647953, 'f1-score': 0.44233391032612857, 'support': 144961}, '2': {'precision': 0.44134722103645524, 'recall': 0.21414220915059753, 'f1-score': 0.2883679417630078, 'support': 144843}, 'accuracy': 0.37510162648305767, 'macro avg': {'precision': 0.39274305543704463, 'recall': 0.375150130525048, 'f1-score': 0.35891067433910995, 'support': 435418}, 'weighted avg': {'precision': 0.39271942654226555, 'recall': 0.37510162648305767, 'f1-score': 0.35891047470041026, 'support': 435418}}
[[45681 81301 18632]
 [37704 86628 20629]
 [35030 78796 31017]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1518599
{'0': {'precision': 0.38654713514115485, 'recall': 0.1419428711636371, 'f1-score': 0.20763915891484463, 'support': 48907}, '1': {'precision': 0.3332064458825022, 'recall': 0.7787168244688738, 'f1-score': 0.46671109841632546, 'support': 47211}, '2': {'precision': 0.38322973487251044, 'recall': 0.12602991176654638, 'f1-score': 0.18968088279152995, 'support': 47941}, 'accuracy': 0.3453307325470814, 'macro avg': {'precision': 0.3676611052987225, 'recall': 0.34889653579968577, 'f1-score': 0.2880103800409, 'support': 144059}, 'weighted avg': {'precision': 0.36796234164078806, 'recall': 0.3453307325470814, 'f1-score': 0.28656590157012185, 'support': 144059}}
[[ 6942 37136  4829]
 [ 5552 36764  4895]
 [ 5465 36434  6042]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
7459/7459 - 48s - 48s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2014893
{'0': {'precision': 0.4178776014098829, 'recall': 0.189199479388876, 'f1-score': 0.2604684878928268, 'support': 740668}, '1': {'precision': 0.2160844415060796, 'recall': 0.7135391610765297, 'f1-score': 0.331714278091895, 'support': 409501}, '2': {'precision': 0.43194182553072474, 'recall': 0.12614183974853838, 'f1-score': 0.1952608181410335, 'support': 759082}, 'accuracy': 0.27659066304011365, 'macro avg': {'precision': 0.3553012894822291, 'recall': 0.34296016007131463, 'f1-score': 0.2624811947085851, 'support': 1909251}, 'weighted avg': {'precision': 0.3801881612054936, 'recall': 0.27659066304011365, 'f1-score': 0.24982413257326844, 'support': 1909251}}
[[140134 522749  77785]
 [ 69165 292195  48141]
 [126048 537282  95752]]
Evaluating performance on  train set...
1664/1664 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099265
{'0': {'precision': 0.43938386136880797, 'recall': 0.2621746577727026, 'f1-score': 0.3283983027564944, 'support': 143618}, '1': {'precision': 0.3620050396754344, 'recall': 0.5908141664825414, 'f1-score': 0.4489365965674301, 'support': 140303}, '2': {'precision': 0.4230039987419688, 'recall': 0.33140901986736315, 'f1-score': 0.3716461332585946, 'support': 142042}, 'accuracy': 0.3935083563595899, 'macro avg': {'precision': 0.40813096659540377, 'recall': 0.39479928137420234, 'f1-score': 0.3829936775275064, 'support': 425963}, 'weighted avg': {'precision': 0.40843490742847305, 'recall': 0.3935083563595899, 'f1-score': 0.3825224698243736, 'support': 425963}}
[[37653 75261 30704]
 [23903 82893 33507]
 [24139 70829 47074]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054476
{'0': {'precision': 0.47092405735528414, 'recall': 0.2236114905331288, 'f1-score': 0.30323582633971186, 'support': 47587}, '1': {'precision': 0.3095978585464729, 'recall': 0.5527195381343056, 'f1-score': 0.3968858474660319, 'support': 36201}, '2': {'precision': 0.4502235767836088, 'recall': 0.4182441927750682, 'f1-score': 0.4336451001189213, 'support': 48388}, 'accuracy': 0.3850018157608038, 'macro avg': {'precision': 0.41024849756178866, 'recall': 0.39819174048083417, 'f1-score': 0.3779222579748884, 'support': 132176}, 'weighted avg': {'precision': 0.4191610703002968, 'recall': 0.3850018157608038, 'f1-score': 0.37662636890736634, 'support': 132176}}
[[10641 23378 13568]
 [ 5047 20009 11145]
 [ 6908 21242 20238]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
8238/8238 - 50s - 50s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1812027
{'0': {'precision': 0.40736662327270123, 'recall': 0.2166250882799758, 'f1-score': 0.2828429579911652, 'support': 787268}, '1': {'precision': 0.24622195696308685, 'recall': 0.6703874785120765, 'f1-score': 0.36016237776829085, 'support': 531694}, '2': {'precision': 0.41412295609418054, 'recall': 0.12712218519231352, 'f1-score': 0.19453002383305237, 'support': 789752}, 'accuracy': 0.297516875213993, 'macro avg': {'precision': 0.35590384544332293, 'recall': 0.3380449173281219, 'f1-score': 0.27917845319750284, 'support': 2108714}, 'weighted avg': {'precision': 0.36926575949961715, 'recall': 0.297516875213993, 'f1-score': 0.2692635703652193, 'support': 2108714}}
[[170542 544292  72434]
 [105654 356441  69599]
 [142449 546908 100395]]
Evaluating performance on  train set...
1806/1806 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1288327
{'0': {'precision': 0.37758118820158537, 'recall': 0.32100304972604154, 'f1-score': 0.34700099530286893, 'support': 154768}, '1': {'precision': 0.34768109263060876, 'recall': 0.5400016918161646, 'f1-score': 0.4230078165817555, 'support': 153681}, '2': {'precision': 0.42145468790807, 'recall': 0.2519614348725555, 'f1-score': 0.31537803835348727, 'support': 153714}, 'accuracy': 0.37086266100921106, 'macro avg': {'precision': 0.382238989580088, 'recall': 0.3709887254715872, 'f1-score': 0.3617956167460372, 'support': 462163}, 'weighted avg': {'precision': 0.3822308346389664, 'recall': 0.37086266100921106, 'f1-score': 0.36175750566056375, 'support': 462163}}
[[49681 78789 26298]
 [43825 82988 26868]
 [38071 76913 38730]]
Evaluating performance on  val set...
642/642 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1335967
{'0': {'precision': 0.3721296713192256, 'recall': 0.33438155136268344, 'f1-score': 0.3522471910112359, 'support': 54378}, '1': {'precision': 0.3621681129387385, 'recall': 0.5071181153769427, 'f1-score': 0.42255819752023027, 'support': 55141}, '2': {'precision': 0.4125751633986928, 'recall': 0.2879586883929712, 'f1-score': 0.3391830462209709, 'support': 54803}, 'accuracy': 0.37686371879602243, 'macro avg': {'precision': 0.38229098255221894, 'recall': 0.3764861183775325, 'f1-score': 0.37132947825081236, 'support': 164322}, 'weighted avg': {'precision': 0.3822758721430508, 'recall': 0.37686371879602243, 'f1-score': 0.37148420664500115, 'support': 164322}}
[[18183 25023 11172]
 [15881 27963 11297]
 [14798 24224 15781]]
testing model on single stock: results/universal/W5/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
31315/31315 - 199s - 199s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2265403
{'0': {'precision': 0.4365662067877308, 'recall': 0.0958599074409108, 'f1-score': 0.15720189170334328, 'support': 3319177}, '1': {'precision': 0.15785701982684106, 'recall': 0.7826793801024805, 'f1-score': 0.26272547119320727, 'support': 1276340}, '2': {'precision': 0.4582548539110114, 'recall': 0.12851358781678524, 'f1-score': 0.20073327473831998, 'support': 3420969}, 'accuracy': 0.2191461445825515, 'macro avg': {'precision': 0.35089269350852775, 'recall': 0.33568429178672554, 'f1-score': 0.2068868792116235, 'support': 8016486}, 'weighted avg': {'precision': 0.4014471416231462, 'recall': 0.2191461445825515, 'f1-score': 0.19257942212451212, 'support': 8016486}}
[[ 318176 2641163  359838]
 [ 117473  998965  159902]
 [ 293166 2688162  439641]]
Evaluating performance on  train set...
5759/5759 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1577941
{'0': {'precision': 0.36066701250413713, 'recall': 0.3124480188708021, 'f1-score': 0.3348304176146021, 'support': 491765}, '1': {'precision': 0.30855060876642887, 'recall': 0.3958315348091509, 'f1-score': 0.34678352410905056, 'support': 486510}, '2': {'precision': 0.3665611689959483, 'recall': 0.3134320231822334, 'f1-score': 0.3379210560929821, 'support': 495897}, 'accuracy': 0.3402974686807238, 'macro avg': {'precision': 0.34525959675550477, 'recall': 0.34057052562072876, 'f1-score': 0.3398449992722116, 'support': 1474172}, 'weighted avg': {'precision': 0.34545016056242833, 'recall': 0.3402974686807238, 'f1-score': 0.3398148727461114, 'support': 1474172}}
[[153651 222876 115238]
 [140580 192576 153354]
 [131788 208679 155430]]
Evaluating performance on  val set...
2129/2129 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1575044
{'0': {'precision': 0.35078676564002975, 'recall': 0.20589190887834288, 'f1-score': 0.25948239116352906, 'support': 187749}, '1': {'precision': 0.27692606538760384, 'recall': 0.5615107739292726, 'f1-score': 0.370921128474446, 'support': 165028}, '2': {'precision': 0.3813147959489423, 'recall': 0.19867508313254892, 'f1-score': 0.261238175068854, 'support': 192163}, 'accuracy': 0.31104158255954784, 'macro avg': {'precision': 0.3363425423255253, 'recall': 0.3220259219800548, 'f1-score': 0.2972138982356097, 'support': 544940}, 'weighted avg': {'precision': 0.33918415663168794, 'recall': 0.31104158255954784, 'f1-score': 0.29384930980327834, 'support': 544940}}
[[ 38656 121110  27983]
 [ 38402  92665  33961]
 [ 33140 120845  38178]]
training model: results/universal/W5/deepLOB_L1/h200
Epoch 1/50
9913/9913 - 153s - loss: 3.2262 - accuracy200: 0.4031 - val_loss: 3.4199 - val_accuracy200: 0.3088 - 153s/epoch - 15ms/step
Epoch 2/50
9913/9913 - 153s - loss: 3.2065 - accuracy200: 0.4146 - val_loss: 3.3982 - val_accuracy200: 0.3140 - 153s/epoch - 15ms/step
Epoch 3/50
9913/9913 - 153s - loss: 3.1979 - accuracy200: 0.4189 - val_loss: 3.4326 - val_accuracy200: 0.3090 - 153s/epoch - 15ms/step
Epoch 4/50
9913/9913 - 153s - loss: 3.1917 - accuracy200: 0.4228 - val_loss: 3.4394 - val_accuracy200: 0.3127 - 153s/epoch - 15ms/step
Epoch 5/50
9913/9913 - 149s - loss: 3.1875 - accuracy200: 0.4246 - val_loss: 3.4802 - val_accuracy200: 0.3101 - 149s/epoch - 15ms/step
Epoch 6/50
9913/9913 - 151s - loss: 3.1826 - accuracy200: 0.4268 - val_loss: 3.5254 - val_accuracy200: 0.3079 - 151s/epoch - 15ms/step
Epoch 7/50
9913/9913 - 148s - loss: 3.1779 - accuracy200: 0.4290 - val_loss: 3.5549 - val_accuracy200: 0.3093 - 148s/epoch - 15ms/step
Epoch 8/50
9913/9913 - 151s - loss: 3.1746 - accuracy200: 0.4305 - val_loss: 3.5579 - val_accuracy200: 0.3094 - 151s/epoch - 15ms/step
Epoch 9/50
9913/9913 - 147s - loss: 3.1709 - accuracy200: 0.4320 - val_loss: 3.5576 - val_accuracy200: 0.3096 - 147s/epoch - 15ms/step
Epoch 10/50
9913/9913 - 149s - loss: 3.1680 - accuracy200: 0.4332 - val_loss: 3.5729 - val_accuracy200: 0.3118 - 149s/epoch - 15ms/step
Epoch 11/50
9913/9913 - 152s - loss: 3.1655 - accuracy200: 0.4343 - val_loss: 3.5558 - val_accuracy200: 0.3138 - 152s/epoch - 15ms/step
Epoch 12/50
9913/9913 - 150s - loss: 3.1628 - accuracy200: 0.4353 - val_loss: 3.5718 - val_accuracy200: 0.3128 - 150s/epoch - 15ms/step
testing model in sample: results/universal/W5/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 305s - 305s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1535589
{'0': {'precision': 0.4237770324968197, 'recall': 0.015272978864404589, 'f1-score': 0.029483373160507535, 'support': 4798540}, '1': {'precision': 0.23830572359064708, 'recall': 0.8679901032600082, 'f1-score': 0.3739452045403406, 'support': 3116986}, '2': {'precision': 0.38625943262876117, 'recall': 0.10296869810567627, 'f1-score': 0.16259339318494778, 'support': 4922865}, 'accuracy': 0.25592786510396826, 'macro avg': {'precision': 0.3494473962387426, 'recall': 0.328743926743363, 'f1-score': 0.1886739902952653, 'support': 12838391}, 'weighted avg': {'precision': 0.3643610548609395, 'recall': 0.25592786510396826, 'f1-score': 0.16415487246855293, 'support': 12838391}}
[[  73288 4292208  433044]
 [  39085 2705513  372388]
 [  60567 4355397  506901]]
Evaluating performance on  train set...
9913/9913 - 68s - 68s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1252723
{'0': {'precision': 0.3914276348139649, 'recall': 0.028489895935110657, 'f1-score': 0.05311391768799549, 'support': 838227}, '1': {'precision': 0.32948652928573646, 'recall': 0.7090875412665066, 'f1-score': 0.4499145502591387, 'support': 852992}, '2': {'precision': 0.35147118538185224, 'recall': 0.26607150035350563, 'f1-score': 0.30286640190456454, 'support': 845814}, 'accuracy': 0.3365245938858501, 'macro avg': {'precision': 0.35746178316051785, 'recall': 0.33454964585170766, 'f1-score': 0.2686316232838996, 'support': 2537033}, 'weighted avg': {'precision': 0.357281058160564, 'recall': 0.3365245938858501, 'f1-score': 0.2697890310441393, 'support': 2537033}}
[[ 23881 628071 186275]
 [ 19168 604846 228978]
 [ 17961 602806 225047]]
Evaluating performance on  val set...
3496/3496 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1313679
{'0': {'precision': 0.3566722115405388, 'recall': 0.053919007184846504, 'f1-score': 0.09367668210922894, 'support': 306200}, '1': {'precision': 0.2977264218907789, 'recall': 0.6775610437123455, 'f1-score': 0.4136786994023519, 'support': 279349}, '2': {'precision': 0.3532555421505052, 'recall': 0.2428418699582078, 'f1-score': 0.2878228782287823, 'support': 308670}, 'accuracy': 0.3139544116150518, 'macro avg': {'precision': 0.33588472519394097, 'recall': 0.3247739736184666, 'f1-score': 0.2650594199134544, 'support': 894219}, 'weighted avg': {'precision': 0.3370784982180838, 'recall': 0.3139544116150518, 'f1-score': 0.26065965818672127, 'support': 894219}}
[[ 16510 226404  63286]
 [ 16125 189276  73948]
 [ 13654 220058  74958]]
testing model out of sample: results/universal/W5/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 130s - 130s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1395276
{'0': {'precision': 0.40143000592811257, 'recall': 0.017192415047003102, 'f1-score': 0.032972678616500946, 'support': 1929979}, '1': {'precision': 0.2718546191912395, 'recall': 0.9196952570143346, 'f1-score': 0.41966082807008803, 'support': 1465891}, '2': {'precision': 0.3744503579594682, 'recall': 0.05886560701780976, 'f1-score': 0.10173752827443638, 'support': 1952974}, 'accuracy': 0.27974586658350853, 'macro avg': {'precision': 0.34924499435960676, 'recall': 0.33191775969304915, 'f1-score': 0.18479034498700844, 'support': 5348844}, 'weighted avg': {'precision': 0.3560680652450385, 'recall': 0.27974586658350853, 'f1-score': 0.1640549538869192, 'support': 5348844}}
[[  33181 1800761   96037]
 [  21700 1348173   96018]
 [  27776 1810235  114963]]
Evaluating performance on  train set...
4957/4957 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119816
{'0': {'precision': 0.3750534965334246, 'recall': 0.04109996998461712, 'f1-score': 0.07408174479056596, 'support': 426448}, '1': {'precision': 0.3328627111057698, 'recall': 0.8369559268961809, 'f1-score': 0.47629847884547166, 'support': 420279}, '2': {'precision': 0.36850565648600286, 'recall': 0.14408811788898454, 'f1-score': 0.20717101583707317, 'support': 421617}, 'accuracy': 0.33904997382413604, 'macro avg': {'precision': 0.3588072880417325, 'recall': 0.34071467158992746, 'f1-score': 0.25251707982437027, 'support': 1268344}, 'weighted avg': {'precision': 0.3588965377067789, 'recall': 0.33904997382413604, 'f1-score': 0.25160136562109536, 'support': 1268344}}
[[ 17527 358249  50672]
 [ 15091 351755  53433]
 [ 14114 346753  60750]]
Evaluating performance on  val set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1198989
{'0': {'precision': 0.3906821963394343, 'recall': 0.06318409633691009, 'f1-score': 0.10877609520224688, 'support': 148645}, '1': {'precision': 0.32147344989767707, 'recall': 0.8375690766751094, 'f1-score': 0.46461836288705055, 'support': 138976}, '2': {'precision': 0.38209754203869806, 'recall': 0.1268285735600301, 'f1-score': 0.19044369990936588, 'support': 147451}, 'accuracy': 0.33211744263018533, 'macro avg': {'precision': 0.3647510627586031, 'recall': 0.34252724885734986, 'f1-score': 0.25461271933288776, 'support': 435072}, 'weighted avg': {'precision': 0.3656652552198322, 'recall': 0.33211744263018533, 'f1-score': 0.2501216770264798, 'support': 435072}}
[[  9392 124802  14451]
 [  6783 116402  15791]
 [  7865 120885  18701]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1430539
{'0': {'precision': 0.34160401002506263, 'recall': 0.029911669501289297, 'f1-score': 0.05500681027089744, 'support': 91135}, '1': {'precision': 0.2846812094493429, 'recall': 0.6784577071279008, 'f1-score': 0.4010722800232913, 'support': 80711}, '2': {'precision': 0.3396912154166901, 'recall': 0.24241510344411604, 'f1-score': 0.2829252267367507, 'support': 99474}, 'accuracy': 0.3007481940144479, 'macro avg': {'precision': 0.32199214496369855, 'recall': 0.31692816002443536, 'f1-score': 0.2463347723436465, 'support': 271320}, 'weighted avg': {'precision': 0.32396959498695205, 'recall': 0.3007481940144479, 'f1-score': 0.24151442743406176, 'support': 271320}}
[[ 2726 65451 22958]
 [ 2036 54759 23916]
 [ 3218 72142 24114]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293969
{'0': {'precision': 0.39354187689202824, 'recall': 0.016028275521946408, 'f1-score': 0.03080203767326146, 'support': 24332}, '1': {'precision': 0.32080143345821793, 'recall': 0.8898025572674287, 'f1-score': 0.47158267782526964, 'support': 22133}, '2': {'precision': 0.3387760702524698, 'recall': 0.10640406826409239, 'f1-score': 0.16194411648957102, 'support': 23204}, 'accuracy': 0.32371643055017296, 'macro avg': {'precision': 0.35103979353423864, 'recall': 0.3374116336844892, 'f1-score': 0.22144294399603406, 'support': 69669}, 'weighted avg': {'precision': 0.3521927831518449, 'recall': 0.32371643055017296, 'f1-score': 0.21451098577554578, 'support': 69669}}
[[  390 21236  2706]
 [  326 19694  2113]
 [  275 20460  2469]]
Evaluating performance on  val set...
96/96 - 1s - 709ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1350824
{'0': {'precision': 0.39655172413793105, 'recall': 0.020501392757660167, 'f1-score': 0.038987180845428536, 'support': 8975}, '1': {'precision': 0.2886991793227054, 'recall': 0.8674886621315193, 'f1-score': 0.43322245027956685, 'support': 7056}, '2': {'precision': 0.39470899470899473, 'recall': 0.1321133412042503, 'f1-score': 0.19796550199026983, 'support': 8470}, 'accuracy': 0.30300804048814334, 'macro avg': {'precision': 0.3599866327232104, 'recall': 0.3400344653644766, 'f1-score': 0.22339171103842173, 'support': 24501}, 'weighted avg': {'precision': 0.36485442711008226, 'recall': 0.30300804048814334, 'f1-score': 0.20748113787673686, 'support': 24501}}
[[ 184 7882  909]
 [ 128 6121  807]
 [ 152 7199 1119]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1542252
{'0': {'precision': 0.4881399395549043, 'recall': 0.024308263441375128, 'f1-score': 0.04631037508797233, 'support': 219267}, '1': {'precision': 0.21665169662706718, 'recall': 0.8600319447581556, 'f1-score': 0.3461135152858984, 'support': 123964}, '2': {'precision': 0.41875322549071947, 'recall': 0.10895242504919551, 'f1-score': 0.17291525822286236, 'support': 215975}, 'accuracy': 0.2422613491271553, 'macro avg': {'precision': 0.37451495389089695, 'recall': 0.3310975444162421, 'f1-score': 0.1884463828655777, 'support': 559206}, 'weighted avg': {'precision': 0.4011584620379987, 'recall': 0.2422613491271553, 'f1-score': 0.16166730277929464, 'support': 559206}}
[[  5330 196404  17533]
 [  2222 106613  15129]
 [  3367 189077  23531]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896543
{'0': {'precision': 0.4518710550045086, 'recall': 0.08627442541103555, 'f1-score': 0.14488615829418144, 'support': 46468}, '1': {'precision': 0.3678331366967214, 'recall': 0.6169193065262776, 'f1-score': 0.4608739286101768, 'support': 55085}, '2': {'precision': 0.3777917138695582, 'recall': 0.3800520981724938, 'f1-score': 0.37891853505123263, 'support': 49138}, 'accuracy': 0.37604767371641307, 'macro avg': {'precision': 0.3991653018569294, 'recall': 0.36108194336993565, 'f1-score': 0.3282262073185303, 'support': 150691}, 'weighted avg': {'precision': 0.396994921760495, 'recall': 0.37604767371641307, 'f1-score': 0.3367096199272225, 'support': 150691}}
[[ 4009 30360 12099]
 [ 2444 33983 18658]
 [ 2419 28044 18675]]
Evaluating performance on  val set...
222/222 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1149343
{'0': {'precision': 0.42081564389553583, 'recall': 0.16660724290734988, 'f1-score': 0.23870685251404802, 'support': 19633}, '1': {'precision': 0.288840560010874, 'recall': 0.6428096073567668, 'f1-score': 0.39858198596991407, 'support': 16529}, '2': {'precision': 0.4293631100082713, 'recall': 0.253392560773211, 'f1-score': 0.318700884086444, 'support': 20486}, 'accuracy': 0.33694040389775454, 'macro avg': {'precision': 0.37967310463822707, 'recall': 0.3542698036791092, 'f1-score': 0.31866324085680203, 'support': 56648}, 'weighted avg': {'precision': 0.38539845757396973, 'recall': 0.33694040389775454, 'f1-score': 0.314284698363577, 'support': 56648}}
[[ 3271 13183  3179]
 [ 2184 10625  3720]
 [ 2318 12977  5191]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1483762
{'0': {'precision': 0.438027199173696, 'recall': 0.02341632654939331, 'f1-score': 0.04445609207451571, 'support': 217327}, '1': {'precision': 0.2506016266566888, 'recall': 0.8347031544148033, 'f1-score': 0.38547322728147065, 'support': 152453}, '2': {'precision': 0.4009514866979656, 'recall': 0.13954501684073847, 'f1-score': 0.2070347600669731, 'support': 229503}, 'accuracy': 0.27427442460406853, 'macro avg': {'precision': 0.3631934375094501, 'recall': 0.33255483260164503, 'f1-score': 0.21232135980765318, 'support': 599283}, 'weighted avg': {'precision': 0.3761489579299883, 'recall': 0.27427442460406853, 'f1-score': 0.1934697923696665, 'support': 599283}}
[[  5089 186984  25254]
 [  2605 127253  22595]
 [  3924 193553  32026]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1206954
{'0': {'precision': 0.37750653879686136, 'recall': 0.02092697308008313, 'f1-score': 0.039655646121439694, 'support': 41382}, '1': {'precision': 0.3301630205253822, 'recall': 0.9595914960475279, 'f1-score': 0.4912898117191624, 'support': 40734}, '2': {'precision': 0.3176638176638177, 'recall': 0.021558391337973704, 'f1-score': 0.04037660691653087, 'support': 41376}, 'accuracy': 0.33075826774204, 'macro avg': {'precision': 0.3417777923286871, 'recall': 0.33402562015519494, 'f1-score': 0.19044068825237767, 'support': 123492}, 'weighted avg': {'precision': 0.3418399101660898, 'recall': 0.33075826774204, 'f1-score': 0.18886933263809932, 'support': 123492}}
[[  866 39579   937]
 [  667 39088   979]
 [  761 39723   892]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1388053
{'0': {'precision': 0.4089439655172414, 'recall': 0.05017518344681695, 'f1-score': 0.08938350114820703, 'support': 15127}, '1': {'precision': 0.2740124514041813, 'recall': 0.8870797394824855, 'f1-score': 0.4186935299615744, 'support': 11362}, '2': {'precision': 0.4124441132637854, 'recall': 0.07462585951193204, 'f1-score': 0.12638429044411462, 'support': 14834}, 'accuracy': 0.28906420153425455, 'macro avg': {'precision': 0.36513351006173594, 'recall': 0.3372935941470782, 'f1-score': 0.211487107184632, 'support': 41323}, 'weighted avg': {'precision': 0.3731002302685819, 'recall': 0.28906420153425455, 'f1-score': 0.1932116417912623, 'support': 41323}}
[[  759 13560   808]
 [  514 10079   769]
 [  583 13144  1107]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
2027/2027 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069775
{'0': {'precision': 0.3369639990827792, 'recall': 0.017762708586417177, 'f1-score': 0.033746505072309835, 'support': 165459}, '1': {'precision': 0.37286280065685673, 'recall': 0.9530226888119622, 'f1-score': 0.5360141756771418, 'support': 194413}, '2': {'precision': 0.24239220720380578, 'recall': 0.020188044401119463, 'f1-score': 0.03727184060192281, 'support': 159005}, 'accuracy': 0.36892943799782996, 'macro avg': {'precision': 0.3174063356478139, 'recall': 0.33032448059983294, 'f1-score': 0.20234417378379146, 'support': 518877}, 'weighted avg': {'precision': 0.3214339330800559, 'recall': 0.36892943799782996, 'f1-score': 0.22301662230853983, 'support': 518877}}
[[  2939 158673   3847]
 [  2947 185280   6186]
 [  2836 152959   3210]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1328332
{'0': {'precision': 0.33026584867075665, 'recall': 0.03483105679367362, 'f1-score': 0.0630161930155427, 'support': 27820}, '1': {'precision': 0.3218586387434555, 'recall': 0.7937094286841445, 'f1-score': 0.4579948884037126, 'support': 27883}, '2': {'precision': 0.3327610426096457, 'recall': 0.1480298559277903, 'f1-score': 0.20490641293639925, 'support': 28805}, 'accuracy': 0.32380366355847967, 'macro avg': {'precision': 0.32829517667461927, 'recall': 0.3255234471352028, 'f1-score': 0.2419724981185515, 'support': 84508}, 'weighted avg': {'precision': 0.32834243108906924, 'recall': 0.32380366355847967, 'f1-score': 0.24170150977050808, 'support': 84508}}
[[  969 23060  3791]
 [  993 22131  4759]
 [  972 23569  4264]]
Evaluating performance on  val set...
136/136 - 1s - 902ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1377609
{'0': {'precision': 0.3628620102214651, 'recall': 0.017679282868525898, 'f1-score': 0.03371586861891571, 'support': 12048}, '1': {'precision': 0.30381191508787947, 'recall': 0.8576820399521311, 'f1-score': 0.4486876956417048, 'support': 10863}, '2': {'precision': 0.30831643002028397, 'recall': 0.09021536374427674, 'f1-score': 0.13958674975401772, 'support': 11794}, 'accuracy': 0.30525860826970175, 'macro avg': {'precision': 0.3249967851098762, 'recall': 0.3218588955216446, 'f1-score': 0.20733010467154608, 'support': 34705}, 'weighted avg': {'precision': 0.32584222182414857, 'recall': 0.30525860826970175, 'f1-score': 0.1995847673094776, 'support': 34705}}
[[  213 10817  1018]
 [  177  9317  1369]
 [  197 10533  1064]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1330361
{'0': {'precision': 0.37602769363911726, 'recall': 0.016499018412828605, 'f1-score': 0.03161103512498909, 'support': 263349}, '1': {'precision': 0.2954942295826886, 'recall': 0.9748896812710903, 'f1-score': 0.45352317962167743, 'support': 219591}, '2': {'precision': 0.33970309538850285, 'recall': 0.008291637434565065, 'f1-score': 0.016188146754468485, 'support': 259418}, 'accuracy': 0.29712483734262984, 'macro avg': {'precision': 0.3370750062034363, 'recall': 0.33322677903949466, 'f1-score': 0.16710745383371164, 'support': 742358}, 'weighted avg': {'precision': 0.33951205221733277, 'recall': 0.29712483734262984, 'f1-score': 0.1510239529717269, 'support': 742358}}
[[  4345 256770   2234]
 [  3567 214077   1947]
 [  3643 253624   2151]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269245
{'0': {'precision': 0.37294745484400654, 'recall': 0.030331864316239316, 'f1-score': 0.056101025071013964, 'support': 59904}, '1': {'precision': 0.33088601707584464, 'recall': 0.8493800208081049, 'f1-score': 0.4762451227909112, 'support': 58631}, '2': {'precision': 0.344251968503937, 'recall': 0.1295308717219429, 'f1-score': 0.18823500467450674, 'support': 59067}, 'accuracy': 0.33371245819303835, 'macro avg': {'precision': 0.349361813474596, 'recall': 0.3364142522820957, 'f1-score': 0.24019371751214394, 'support': 177602}, 'weighted avg': {'precision': 0.3495183242630785, 'recall': 0.33371245819303835, 'f1-score': 0.23874663923445133, 'support': 177602}}
[[ 1817 50899  7188]
 [ 1445 49800  7386]
 [ 1610 49806  7651]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1162462
{'0': {'precision': 0.37333333333333335, 'recall': 0.01549841493483621, 'f1-score': 0.029761329597062517, 'support': 19873}, '1': {'precision': 0.3421126523277363, 'recall': 0.8700371322479291, 'f1-score': 0.49111209641662296, 'support': 21006}, '2': {'precision': 0.3419423047877964, 'recall': 0.11326796077646588, 'f1-score': 0.1701679882746439, 'support': 19988}, 'accuracy': 0.34251729180015444, 'macro avg': {'precision': 0.35246276348295535, 'recall': 0.33293450265307706, 'f1-score': 0.23034713809610982, 'support': 60867}, 'weighted avg': {'precision': 0.35225022584041005, 'recall': 0.34251729180015444, 'f1-score': 0.2350874094343994, 'support': 60867}}
[[  308 17671  1894]
 [  267 18276  2463]
 [  250 17474  2264]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
7167/7167 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1369355
{'0': {'precision': 0.48871665577240325, 'recall': 0.024075712526700106, 'f1-score': 0.04589070523968329, 'support': 652151}, '1': {'precision': 0.2657772844700682, 'recall': 0.7730046674680292, 'f1-score': 0.3955538138086246, 'support': 497486}, '2': {'precision': 0.4026839407969127, 'recall': 0.2090172191773222, 'f1-score': 0.27519280007996494, 'support': 684934}, 'accuracy': 0.29621257503797893, 'macro avg': {'precision': 0.3857259603464614, 'recall': 0.33536586639068383, 'f1-score': 0.23887910637609097, 'support': 1834571}, 'weighted avg': {'precision': 0.3961413628724631, 'recall': 0.29621257503797893, 'f1-score': 0.22631942795298346, 'support': 1834571}}
[[ 15701 528474 107976]
 [  8544 384559 104383]
 [  7882 533889 143163]]
Evaluating performance on  train set...
1570/1570 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062953
{'0': {'precision': 0.43296365433183265, 'recall': 0.0291467390099127, 'f1-score': 0.05461672715184087, 'support': 135281}, '1': {'precision': 0.33686118949276844, 'recall': 0.9091103066690212, 'f1-score': 0.4915746150342048, 'support': 135912}, '2': {'precision': 0.37822227390781876, 'recall': 0.07476284615266732, 'f1-score': 0.12484725181218533, 'support': 130506}, 'accuracy': 0.34169614562147277, 'macro avg': {'precision': 0.3826823725774733, 'recall': 0.33767329727720036, 'f1-score': 0.22367953133274368, 'support': 401699}, 'weighted avg': {'precision': 0.38266341262143944, 'recall': 0.34169614562147277, 'f1-score': 0.22527516869436587, 'support': 401699}}
[[  3943 124694   6644]
 [  2957 123559   9396]
 [  2207 118542   9757]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1254277
{'0': {'precision': 0.4281984334203655, 'recall': 0.025484493972961573, 'f1-score': 0.048105933623868585, 'support': 45047}, '1': {'precision': 0.29419822028946635, 'recall': 0.807031373167271, 'f1-score': 0.431203801848979, 'support': 38058}, '2': {'precision': 0.3644884841992501, 'recall': 0.1595732207761754, 'f1-score': 0.2219685231998695, 'support': 42645}, 'accuracy': 0.3074910536779324, 'macro avg': {'precision': 0.36229504596969403, 'recall': 0.3306963626388027, 'f1-score': 0.23375941955757237, 'support': 125750}, 'weighted avg': {'precision': 0.3660378696361092, 'recall': 0.3074910536779324, 'f1-score': 0.22301097379388699, 'support': 125750}}
[[ 1148 38664  5235]
 [  714 30714  6630]
 [  819 35021  6805]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
6357/6357 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1445822
{'0': {'precision': 0.4073718461620526, 'recall': 0.012578378102389348, 'f1-score': 0.024403259306598497, 'support': 607153}, '1': {'precision': 0.25691548765467553, 'recall': 0.9601770650232183, 'f1-score': 0.40536663929544364, 'support': 419281}, '2': {'precision': 0.37331048464954625, 'recall': 0.025746793511282014, 'f1-score': 0.04817127009017904, 'support': 600735}, 'accuracy': 0.2616126536333964, 'macro avg': {'precision': 0.34586593948875816, 'recall': 0.33283407887896327, 'f1-score': 0.15931372289740706, 'support': 1627169}, 'weighted avg': {'precision': 0.3560278588690627, 'recall': 0.2616126536333964, 'f1-score': 0.13134297047561488, 'support': 1627169}}
[[  7637 585592  13924]
 [  4656 402584  12041]
 [  6454 578814  15467]]
Evaluating performance on  train set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1161718
{'0': {'precision': 0.3884180098966244, 'recall': 0.05457198711418266, 'f1-score': 0.09569851587632101, 'support': 145276}, '1': {'precision': 0.33425947887371665, 'recall': 0.808038060654048, 'f1-score': 0.47289672212024547, 'support': 146503}, '2': {'precision': 0.36679758754991704, 'recall': 0.1553895529765593, 'f1-score': 0.21829918333414838, 'support': 143639}, 'accuracy': 0.34134555760212026, 'macro avg': {'precision': 0.36315835877341934, 'recall': 0.33933320024826336, 'f1-score': 0.26229814044357164, 'support': 435418}, 'weighted avg': {'precision': 0.3630632401904851, 'recall': 0.34134555760212026, 'f1-score': 0.2630570221446162, 'support': 435418}}
[[  7928 120146  17202]
 [  6794 118380  21329]
 [  5689 115630  22320]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1234548
{'0': {'precision': 0.37440944881889765, 'recall': 0.01904399543424715, 'f1-score': 0.036244449949501684, 'support': 49937}, '1': {'precision': 0.31389108888905337, 'recall': 0.9302432711079913, 'f1-score': 0.4693947578145754, 'support': 45587}, '2': {'precision': 0.33468370208787784, 'recall': 0.044256721953229626, 'f1-score': 0.07817589576547232, 'support': 48535}, 'accuracy': 0.31588446400433157, 'macro avg': {'precision': 0.3409947465986096, 'recall': 0.3311813294984894, 'f1-score': 0.1946050345098498, 'support': 144059}, 'weighted avg': {'precision': 0.34187458746548094, 'recall': 0.31588446400433157, 'f1-score': 0.1874405974121611, 'support': 144059}}
[[  951 47110  1876]
 [  786 42407  2394]
 [  803 45584  2148]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
7459/7459 - 51s - 51s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1631342
{'0': {'precision': 0.4289996150250234, 'recall': 0.02075158486721167, 'f1-score': 0.03958820753041245, 'support': 751798}, '1': {'precision': 0.2057076483760848, 'recall': 0.9270009834820294, 'f1-score': 0.3366994600219353, 'support': 397567}, '2': {'precision': 0.3943214949132109, 'recall': 0.04218264318595158, 'f1-score': 0.0762124409308408, 'support': 759886}, 'accuracy': 0.21799124368666037, 'macro avg': {'precision': 0.34300958610477306, 'recall': 0.3299784038450642, 'f1-score': 0.15083336949439619, 'support': 1909251}, 'weighted avg': {'precision': 0.3687011339536486, 'recall': 0.21799124368666037, 'f1-score': 0.11603277743820098, 'support': 1909251}}
[[ 15601 708824  27373]
 [  7160 368545  21862]
 [ 13605 714227  32054]]
Evaluating performance on  train set...
1664/1664 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1182779
{'0': {'precision': 0.4085554157611804, 'recall': 0.025392763204663396, 'f1-score': 0.04781377791758415, 'support': 140670}, '1': {'precision': 0.3452505851020902, 'recall': 0.6974810467106872, 'f1-score': 0.4618748144349375, 'support': 147204}, '2': {'precision': 0.35621182282452685, 'recall': 0.3091267226209184, 'f1-score': 0.33100319860424543, 'support': 138089}, 'accuracy': 0.34963365362719295, 'macro avg': {'precision': 0.3700059412292658, 'recall': 0.3440001775120897, 'f1-score': 0.280230596985589, 'support': 425963}, 'weighted avg': {'precision': 0.36970979138213744, 'recall': 0.34963365362719295, 'f1-score': 0.2827092611701222, 'support': 425963}}
[[  3572 101794  35304]
 [  2687 102672  41845]
 [  2484  92918  42687]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.129638
{'0': {'precision': 0.38272849462365593, 'recall': 0.05071576463254447, 'f1-score': 0.08956338831115218, 'support': 44917}, '1': {'precision': 0.3064672701036337, 'recall': 0.558525389691116, 'f1-score': 0.39577156990631723, 'support': 41828}, '2': {'precision': 0.37084450134016084, 'recall': 0.4080913913407145, 'f1-score': 0.3885774168194917, 'support': 45431}, 'accuracy': 0.3342513012952427, 'macro avg': {'precision': 0.3533467553558169, 'recall': 0.3391108485547916, 'f1-score': 0.29130412501232034, 'support': 132176}, 'weighted avg': {'precision': 0.3545103899897893, 'recall': 0.3342513012952427, 'f1-score': 0.28924095571313846, 'support': 132176}}
[[ 2278 27475 15164]
 [ 2176 23362 16290]
 [ 1498 25393 18540]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
8238/8238 - 53s - 53s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1349654
{'0': {'precision': 0.4032569943803251, 'recall': 0.017771948629521382, 'f1-score': 0.03404356259875809, 'support': 751015}, '1': {'precision': 0.27927194235973113, 'recall': 0.9250658830859385, 'f1-score': 0.42902405043124586, 'support': 593855}, '2': {'precision': 0.3810576949658585, 'recall': 0.05413670854258199, 'f1-score': 0.0948045710329301, 'support': 763844}, 'accuracy': 0.2864561054747111, 'macro avg': {'precision': 0.35452887723530485, 'recall': 0.33232484675268065, 'f1-score': 0.1859573946876447, 'support': 2108714}, 'weighted avg': {'precision': 0.3602990850907611, 'recall': 0.2864561054747111, 'f1-score': 0.16728736395264188, 'support': 2108714}}
[[ 13347 706264  31404]
 [  8737 549355  35763]
 [ 11014 711478  41352]]
Evaluating performance on  train set...
1806/1806 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1188738
{'0': {'precision': 0.3692393736017897, 'recall': 0.04244185298995847, 'f1-score': 0.076132707542927, 'support': 155554}, '1': {'precision': 0.3349884517266077, 'recall': 0.8200659320453382, 'f1-score': 0.4756704459100943, 'support': 152278}, '2': {'precision': 0.38352447552447555, 'recall': 0.1776830319248887, 'f1-score': 0.24285416971097856, 'support': 154331}, 'accuracy': 0.3438224176318745, 'macro avg': {'precision': 0.36258410028429094, 'recall': 0.3467302723200618, 'f1-score': 0.26488577438799993, 'support': 462163}, 'weighted avg': {'precision': 0.3627242959852801, 'recall': 0.3438224176318745, 'f1-score': 0.26344994778269754, 'support': 462163}}
[[  6602 126450  22502]
 [  5824 124878  21576]
 [  5454 121455  27422]]
Evaluating performance on  val set...
642/642 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1111774
{'0': {'precision': 0.3941355674028941, 'recall': 0.1323698682695997, 'f1-score': 0.19818094782192436, 'support': 54733}, '1': {'precision': 0.34021787095601913, 'recall': 0.7286204021124804, 'f1-score': 0.4638488126555698, 'support': 53965}, '2': {'precision': 0.39503408305068, 'recall': 0.21566230404142098, 'f1-score': 0.2790059424823528, 'support': 55624}, 'accuracy': 0.3563795474738623, 'macro avg': {'precision': 0.37646250713653107, 'recall': 0.3588841914745004, 'f1-score': 0.31367856765328234, 'support': 164322}, 'weighted avg': {'precision': 0.37673260581306944, 'recall': 0.3563795474738623, 'f1-score': 0.3127887047183798, 'support': 164322}}
[[ 7245 38572  8916]
 [ 5190 39320  9455]
 [ 5947 37681 11996]]
testing model on single stock: results/universal/W5/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
31315/31315 - 190s - 190s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1580057
{'0': {'precision': 0.3956350182069385, 'recall': 0.011226417131665374, 'f1-score': 0.021833299302936867, 'support': 3009865}, '1': {'precision': 0.2330345121170878, 'recall': 0.8722191519450965, 'f1-score': 0.36780183797023797, 'support': 1903556}, '2': {'precision': 0.3778949927198855, 'recall': 0.09819291571397956, 'f1-score': 0.155881342548456, 'support': 3103065}, 'accuracy': 0.24933705366665643, 'macro avg': {'precision': 0.335521507681304, 'recall': 0.3272128282635805, 'f1-score': 0.1818388266072103, 'support': 8016486}, 'weighted avg': {'precision': 0.35015778277506054, 'recall': 0.24933705366665643, 'f1-score': 0.15587336110869937, 'support': 8016486}}
[[  33790 2699412  276663]
 [  18294 1660318  224944]
 [  33323 2765043  304699]]
Evaluating performance on  train set...
5759/5759 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1355731
{'0': {'precision': 0.3695123512095226, 'recall': 0.023664516340565753, 'f1-score': 0.044480394422617676, 'support': 487988}, '1': {'precision': 0.3189839913606997, 'recall': 0.6618478234081182, 'f1-score': 0.43048942174428506, 'support': 486908}, '2': {'precision': 0.34500627523673705, 'recall': 0.29896890697730316, 'f1-score': 0.32034200030259813, 'support': 499276}, 'accuracy': 0.3276924266639171, 'macro avg': {'precision': 0.34450087260231976, 'recall': 0.32816041557532905, 'f1-score': 0.26510393882316696, 'support': 1474172}, 'weighted avg': {'precision': 0.3445234366020961, 'recall': 0.3276924266639171, 'f1-score': 0.2654057427622087, 'support': 1474172}}
[[ 11548 347920 128520]
 [  9784 322259 154865]
 [  9920 340088 149268]]
Evaluating performance on  val set...
2129/2129 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1345106
{'0': {'precision': 0.32742725933034034, 'recall': 0.0517677657066999, 'f1-score': 0.08940084403978778, 'support': 184555}, '1': {'precision': 0.2973863715548857, 'recall': 0.6696538056964858, 'f1-score': 0.41186689066018517, 'support': 172071}, '2': {'precision': 0.33902347769151625, 'recall': 0.23096530263283666, 'f1-score': 0.27475158398766925, 'support': 188314}, 'accuracy': 0.30879729878518736, 'macro avg': {'precision': 0.32127903619224746, 'recall': 0.3174622913453408, 'f1-score': 0.2586731062292141, 'support': 544940}, 'weighted avg': {'precision': 0.32194879319472214, 'recall': 0.30879729878518736, 'f1-score': 0.2552745078386716, 'support': 544940}}
[[  9554 136241  38760]
 [ 10805 115228  46038]
 [  8820 136000  43494]]
training model: results/universal/W5/deepOF_L1/h50
Epoch 1/50
9913/9913 - 139s - loss: 3.1300 - accuracy50: 0.4472 - val_loss: 3.4290 - val_accuracy50: 0.3731 - 139s/epoch - 14ms/step
Epoch 2/50
9913/9913 - 135s - loss: 3.1131 - accuracy50: 0.4512 - val_loss: 3.5195 - val_accuracy50: 0.3692 - 135s/epoch - 14ms/step
Epoch 3/50
9913/9913 - 131s - loss: 3.0995 - accuracy50: 0.4558 - val_loss: 3.6015 - val_accuracy50: 0.3676 - 131s/epoch - 13ms/step
Epoch 4/50
9913/9913 - 132s - loss: 3.0886 - accuracy50: 0.4592 - val_loss: 3.6299 - val_accuracy50: 0.3701 - 132s/epoch - 13ms/step
Epoch 5/50
9913/9913 - 137s - loss: 3.0795 - accuracy50: 0.4618 - val_loss: 3.6372 - val_accuracy50: 0.3719 - 137s/epoch - 14ms/step
Epoch 6/50
9913/9913 - 133s - loss: 3.0706 - accuracy50: 0.4640 - val_loss: 3.6520 - val_accuracy50: 0.3726 - 133s/epoch - 13ms/step
Epoch 7/50
9913/9913 - 137s - loss: 3.0631 - accuracy50: 0.4661 - val_loss: 3.6479 - val_accuracy50: 0.3743 - 137s/epoch - 14ms/step
Epoch 8/50
9913/9913 - 137s - loss: 3.0570 - accuracy50: 0.4677 - val_loss: 3.6720 - val_accuracy50: 0.3747 - 137s/epoch - 14ms/step
Epoch 9/50
9913/9913 - 134s - loss: 3.0510 - accuracy50: 0.4699 - val_loss: 3.6335 - val_accuracy50: 0.3773 - 134s/epoch - 13ms/step
Epoch 10/50
9913/9913 - 131s - loss: 3.0464 - accuracy50: 0.4712 - val_loss: 3.6300 - val_accuracy50: 0.3795 - 131s/epoch - 13ms/step
Epoch 11/50
9913/9913 - 134s - loss: 3.0420 - accuracy50: 0.4729 - val_loss: 3.6026 - val_accuracy50: 0.3808 - 134s/epoch - 14ms/step
testing model in sample: results/universal/W5/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 312s - 312s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1549441
{'0': {'precision': 0.5162406499160341, 'recall': 0.07721381129942449, 'f1-score': 0.13433518739102404, 'support': 4610341}, '1': {'precision': 0.27425599393097305, 'recall': 0.8705899268695111, 'f1-score': 0.4171120346621755, 'support': 3512215}, '2': {'precision': 0.48752514426380694, 'recall': 0.10335318852964814, 'f1-score': 0.17055043433333786, 'support': 4715810}, 'accuracy': 0.30386070937687865, 'macro avg': {'precision': 0.42600726270360467, 'recall': 0.3503856422328613, 'f1-score': 0.24066588546217912, 'support': 12838366}, 'weighted avg': {'precision': 0.4394926426361045, 'recall': 0.30386070937687865, 'f1-score': 0.22499760567084875, 'support': 12838366}}
[[ 355982 4017559  236800]
 [ 178979 3057699  275537]
 [ 154605 4073811  487394]]
Evaluating performance on  train set...
9913/9913 - 60s - 60s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0827942
{'0': {'precision': 0.5033405166286653, 'recall': 0.11373015057299964, 'f1-score': 0.1855378833846312, 'support': 778360}, '1': {'precision': 0.3944784668903176, 'recall': 0.8701613355708464, 'f1-score': 0.5428579883935132, 'support': 980255}, '2': {'precision': 0.4643034944709012, 'recall': 0.1186134317218025, 'f1-score': 0.18895533262114386, 'support': 778411}, 'accuracy': 0.40749799174308815, 'macro avg': {'precision': 0.45404082599662804, 'recall': 0.3675016392885495, 'f1-score': 0.30578373479976273, 'support': 2537026}, 'weighted avg': {'precision': 0.4493010956605273, 'recall': 0.40749799174308815, 'f1-score': 0.324647612497823, 'support': 2537026}}
[[ 88523 652874  36963]
 [ 57711 852980  69564]
 [ 29637 656444  92330]]
Evaluating performance on  val set...
3496/3496 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.108685
{'0': {'precision': 0.4935684397224183, 'recall': 0.09886145324232318, 'f1-score': 0.1647279916322801, 'support': 289931}, '1': {'precision': 0.3545969841296686, 'recall': 0.8754528752762218, 'f1-score': 0.5047485627461201, 'support': 311344}, '2': {'precision': 0.4780591905389985, 'recall': 0.11011736111585228, 'f1-score': 0.1790027717739631, 'support': 292942}, 'accuracy': 0.3729385596561014, 'macro avg': {'precision': 0.4420748714636951, 'recall': 0.3614772298781324, 'f1-score': 0.2828264420507878, 'support': 894217}, 'weighted avg': {'precision': 0.44010128427317224, 'recall': 0.3729385596561014, 'f1-score': 0.2877910147431495, 'support': 894217}}
[[ 28663 247482  13786]
 [ 17344 272567  21433]
 [ 12066 248618  32258]]
testing model out of sample: results/universal/W5/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 136s - 136s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1524284
{'0': {'precision': 0.4868728700466522, 'recall': 0.09245620685610884, 'f1-score': 0.15540189705760696, 'support': 1909888}, '1': {'precision': 0.292066932102441, 'recall': 0.8527062366221695, 'f1-score': 0.43510330486225185, 'support': 1542197}, '2': {'precision': 0.48723743905112055, 'recall': 0.12422880593694213, 'f1-score': 0.19797961296220365, 'support': 1896734}, 'accuracy': 0.322921938469034, 'macro avg': {'precision': 0.42205908040007123, 'recall': 0.3564637498050735, 'f1-score': 0.26282827162735417, 'support': 5348819}, 'weighted avg': {'precision': 0.4308347721686669, 'recall': 0.322921938469034, 'f1-score': 0.2511451393342084, 'support': 5348819}}
[[ 176581 1612563  120744]
 [  99927 1315041  127229]
 [  86176 1574929  235629]]
Evaluating performance on  train set...
4957/4957 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0981364
{'0': {'precision': 0.4911348309588674, 'recall': 0.10912482820554803, 'f1-score': 0.17857273343590538, 'support': 403098}, '1': {'precision': 0.3730679523120516, 'recall': 0.8562092068481689, 'f1-score': 0.5196943800172559, 'support': 462547}, '2': {'precision': 0.47932734966896456, 'recall': 0.13951253430015273, 'f1-score': 0.216121084125308, 'support': 402695}, 'accuracy': 0.3912247504612328, 'macro avg': {'precision': 0.4478433776466278, 'recall': 0.3682821897846232, 'f1-score': 0.30479606585948976, 'support': 1268340}, 'weighted avg': {'precision': 0.444328537539527, 'recall': 0.3912247504612328, 'f1-score': 0.3148968479021628, 'support': 1268340}}
[[ 43988 335263  23847]
 [ 29330 396037  37180]
 [ 16246 330268  56181]]
Evaluating performance on  val set...
1701/1701 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.106922
{'0': {'precision': 0.4941125321546321, 'recall': 0.09705518154257818, 'f1-score': 0.16224222128373356, 'support': 140518}, '1': {'precision': 0.3643393983575744, 'recall': 0.8665170080349864, 'f1-score': 0.51298637880816, 'support': 154574}, '2': {'precision': 0.4857185884242759, 'recall': 0.13825029647516038, 'f1-score': 0.21523745968190414, 'support': 139978}, 'accuracy': 0.3836876824419059, 'macro avg': {'precision': 0.4480568396454941, 'recall': 0.367274162017575, 'f1-score': 0.2968220199245992, 'support': 435070}, 'weighted avg': {'precision': 0.4453053980405029, 'recall': 0.3836876824419059, 'f1-score': 0.30390699910265884, 'support': 435070}}
[[ 13638 118485   8395]
 [  8538 133941  12095]
 [  5425 115201  19352]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1943077
{'0': {'precision': 0.46205442698351856, 'recall': 0.04738647195825431, 'f1-score': 0.08595748473639646, 'support': 101759}, '1': {'precision': 0.26023779148205967, 'recall': 0.9082335201570457, 'f1-score': 0.40455710479376755, 'support': 70298}, '2': {'precision': 0.4259879006307118, 'recall': 0.06668480122509017, 'f1-score': 0.11531760688525733, 'support': 99258}, 'accuracy': 0.27749295099791754, 'macro avg': {'precision': 0.3827600396987633, 'recall': 0.3407682644467967, 'f1-score': 0.20194406547180713, 'support': 271315}, 'weighted avg': {'precision': 0.3965689318387295, 'recall': 0.27749295099791754, 'f1-score': 0.17924809931739902, 'support': 271315}}
[[ 4822 92189  4748]
 [ 2280 63847  4171]
 [ 3334 89305  6619]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1420246
{'0': {'precision': 0.4311199207135778, 'recall': 0.0558169375534645, 'f1-score': 0.09883742946945887, 'support': 23380}, '1': {'precision': 0.3315461227606835, 'recall': 0.9063981558000956, 'f1-score': 0.485502941347778, 'support': 22991}, '2': {'precision': 0.43068391866913125, 'recall': 0.07000901403614199, 'f1-score': 0.12044011224339092, 'support': 23297}, 'accuracy': 0.34126141126485615, 'macro avg': {'precision': 0.39778332071446415, 'recall': 0.344074702463234, 'f1-score': 0.23492682768687592, 'support': 69668}, 'weighted avg': {'precision': 0.398113967788785, 'recall': 0.34126141126485615, 'f1-score': 0.23366410002378407, 'support': 69668}}
[[ 1305 21092   983]
 [  979 20839  1173]
 [  743 20923  1631]]
Evaluating performance on  val set...
96/96 - 1s - 757ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1405914
{'0': {'precision': 0.4065693430656934, 'recall': 0.06710843373493976, 'f1-score': 0.11520165460186144, 'support': 8300}, '1': {'precision': 0.32815079801871216, 'recall': 0.8905899925317401, 'f1-score': 0.4795897848381259, 'support': 8034}, '2': {'precision': 0.43632253202712884, 'recall': 0.0708950655075303, 'f1-score': 0.12197177164524964, 'support': 8167}, 'accuracy': 0.33839435125096934, 'macro avg': {'precision': 0.3903475577038448, 'recall': 0.34286449725807006, 'f1-score': 0.23892107036174567, 'support': 24501}, 'weighted avg': {'precision': 0.39077324100212846, 'recall': 0.33839435125096934, 'f1-score': 0.2369430441048001, 'support': 24501}}
[[ 557 7376  367]
 [ 498 7155  381]
 [ 315 7273  579]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0049312
{'0': {'precision': 0.557414560933002, 'recall': 0.15850194498083003, 'f1-score': 0.2468201007762495, 'support': 142932}, '1': {'precision': 0.5139546082659855, 'recall': 0.8998482382439625, 'f1-score': 0.6542371164793928, 'support': 272796}, '2': {'precision': 0.5282378230494895, 'recall': 0.15072522356122756, 'f1-score': 0.23453047811681518, 'support': 143473}, 'accuracy': 0.5181589446370805, 'macro avg': {'precision': 0.5332023307494923, 'recall': 0.40302513559534003, 'f1-score': 0.37852923179081915, 'support': 559201}, 'weighted avg': {'precision': 0.5287276033594057, 'recall': 0.5181589446370805, 'f1-score': 0.44241793265412105, 'support': 559201}}
[[ 22655 114860   5417]
 [ 13425 245475  13896]
 [  4563 117285  21625]]
Evaluating performance on  train set...
589/589 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9153243
{'0': {'precision': 0.4709631000102785, 'recall': 0.17368560706569122, 'f1-score': 0.2537801163112711, 'support': 26381}, '1': {'precision': 0.6756987998747164, 'recall': 0.9078135744562931, 'f1-score': 0.7747442365636605, 'support': 97433}, '2': {'precision': 0.4789222509445218, 'recall': 0.17923054025896712, 'f1-score': 0.26084366708182166, 'support': 26876}, 'accuracy': 0.649346340168558, 'macro avg': {'precision': 0.5418613836098389, 'recall': 0.4202432405936505, 'f1-score': 0.4297893399855845, 'support': 150690}, 'weighted avg': {'precision': 0.6047604560750505, 'recall': 0.649346340168558, 'f1-score': 0.591884417320365, 'support': 150690}}
[[ 4582 21178   621]
 [ 4362 88451  4620]
 [  785 21274  4817]]
Evaluating performance on  val set...
222/222 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9484404
{'0': {'precision': 0.5029635901778154, 'recall': 0.15309278350515465, 'f1-score': 0.2347362181387078, 'support': 11640}, '1': {'precision': 0.6066813613475966, 'recall': 0.9148040859887178, 'f1-score': 0.7295430780828247, 'support': 32795}, '2': {'precision': 0.5492610837438424, 'recall': 0.1643330876934414, 'f1-score': 0.25297787861599547, 'support': 12213}, 'accuracy': 0.5964906086710916, 'macro avg': {'precision': 0.5529686784230848, 'recall': 0.41074331906243794, 'f1-score': 0.40575239161250937, 'support': 56648}, 'weighted avg': {'precision': 0.5729899917177614, 'recall': 0.5964906086710916, 'f1-score': 0.5251255764792746, 'support': 56648}}
[[ 1782  9585   273]
 [ 1420 30001  1374]
 [  341  9865  2007]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
2341/2341 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1416587
{'0': {'precision': 0.49982373837351196, 'recall': 0.08768457908357437, 'f1-score': 0.14919562094016228, 'support': 210208}, '1': {'precision': 0.3043406796879796, 'recall': 0.8600818208783152, 'f1-score': 0.44959262780662623, 'support': 178683}, '2': {'precision': 0.4993557822892363, 'recall': 0.1363202098989006, 'f1-score': 0.21417289906318024, 'support': 210387}, 'accuracy': 0.33505985535928234, 'macro avg': {'precision': 0.4345067334502426, 'recall': 0.3613622032869301, 'f1-score': 0.27098704926998957, 'support': 599278}, 'weighted avg': {'precision': 0.4413734844816463, 'recall': 0.33505985535928234, 'f1-score': 0.26157453855500507, 'support': 599278}}
[[ 18432 178227  13549]
 [  9796 153682  15205]
 [  8649 173058  28680]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1319927
{'0': {'precision': 0.4786666666666667, 'recall': 0.07791550110928909, 'f1-score': 0.13401634244473018, 'support': 41468}, '1': {'precision': 0.33426238924303914, 'recall': 0.873348586611558, 'f1-score': 0.4834795162344737, 'support': 40647}, '2': {'precision': 0.4741485627549568, 'recall': 0.12079174420571816, 'f1-score': 0.19253438113948917, 'support': 41377}, 'accuracy': 0.3540958118744534, 'macro avg': {'precision': 0.42902587288822086, 'recall': 0.3573519439755218, 'f1-score': 0.27001007993956433, 'support': 123492}, 'weighted avg': {'precision': 0.4296226294011515, 'recall': 0.3540958118744534, 'f1-score': 0.2686479826489924, 'support': 123492}}
[[ 3231 35690  2547]
 [ 2152 35499  2996]
 [ 1367 35012  4998]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1492796
{'0': {'precision': 0.5198019801980198, 'recall': 0.08024734245813937, 'f1-score': 0.1390309960878724, 'support': 14393}, '1': {'precision': 0.2971022695115739, 'recall': 0.8686191776288574, 'f1-score': 0.44276225619399046, 'support': 12087}, '2': {'precision': 0.48365665692266807, 'recall': 0.1226167216869905, 'f1-score': 0.19563581640331076, 'support': 14843}, 'accuracy': 0.3260653873145706, 'macro avg': {'precision': 0.43352030221075394, 'recall': 0.35716108059132906, 'f1-score': 0.25914302289505786, 'support': 41323}, 'weighted avg': {'precision': 0.4416789872777789, 'recall': 0.3260653873145706, 'f1-score': 0.24820470295438019, 'support': 41323}}
[[ 1155 12300   938]
 [  583 10499  1005]
 [  484 12539  1820]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
2027/2027 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1682235
{'0': {'precision': 0.4614068441064639, 'recall': 0.025904717177485204, 'f1-score': 0.04905532620174938, 'support': 187379}, '1': {'precision': 0.3071282833272481, 'recall': 0.9032751160660708, 'f1-score': 0.458394839123292, 'support': 158315}, '2': {'precision': 0.41937672546909366, 'recall': 0.10350621903475037, 'f1-score': 0.16603371619118193, 'support': 173178}, 'accuracy': 0.319502690451595, 'macro avg': {'precision': 0.39597061763426855, 'recall': 0.3442286840927688, 'f1-score': 0.22449462717207444, 'support': 518872}, 'weighted avg': {'precision': 0.40030641426028973, 'recall': 0.319502690451595, 'f1-score': 0.21299299986647588, 'support': 518872}}
[[  4854 170248  12277]
 [  2773 143002  12540]
 [  2893 152360  17925]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1307331
{'0': {'precision': 0.47256977863330124, 'recall': 0.034725414618621595, 'f1-score': 0.06469677504364726, 'support': 28279}, '1': {'precision': 0.33286096677688554, 'recall': 0.9107816034179442, 'f1-score': 0.4875414404458752, 'support': 27853}, '2': {'precision': 0.46870474658085276, 'recall': 0.10266802946463187, 'f1-score': 0.16843992136000926, 'support': 28373}, 'accuracy': 0.34628720194071355, 'macro avg': {'precision': 0.42471183066367985, 'recall': 0.34939168250039926, 'f1-score': 0.2402260456165106, 'support': 84505}, 'weighted avg': {'precision': 0.425223798027883, 'recall': 0.34628720194071355, 'f1-score': 0.23889944655281706, 'support': 84505}}
[[  982 25847  1450]
 [  633 25368  1852]
 [  463 24997  2913]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1514676
{'0': {'precision': 0.5102040816326531, 'recall': 0.03808836500681581, 'f1-score': 0.07088494254588867, 'support': 12471}, '1': {'precision': 0.3022833667717589, 'recall': 0.9172787011982992, 'f1-score': 0.45471747826295245, 'support': 10348}, '2': {'precision': 0.4896755162241888, 'recall': 0.0977620730270907, 'f1-score': 0.16298478154148258, 'support': 11886}, 'accuracy': 0.32067425443019737, 'macro avg': {'precision': 0.43405432154286694, 'recall': 0.35104304641073525, 'f1-score': 0.2295290674501079, 'support': 34705}, 'weighted avg': {'precision': 0.44117754119682134, 'recall': 0.32067425443019737, 'f1-score': 0.21687536945560787, 'support': 34705}}
[[  475 11406   590]
 [  235  9492   621]
 [  221 10503  1162]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2072022
{'0': {'precision': 0.443356742569341, 'recall': 0.04384549548917542, 'f1-score': 0.07979928882873795, 'support': 285092}, '1': {'precision': 0.22950100233802417, 'recall': 0.875061218778423, 'f1-score': 0.3636326192901887, 'support': 171516}, '2': {'precision': 0.45673556190602776, 'recall': 0.09620465799926507, 'f1-score': 0.1589325100525246, 'support': 285745}, 'accuracy': 0.2560466516603287, 'macro avg': {'precision': 0.376531102271131, 'recall': 0.33837045742228783, 'f1-score': 0.20078813939048376, 'support': 742353}, 'weighted avg': {'precision': 0.399096464224466, 'recall': 0.2560466516603287, 'f1-score': 0.17583699569597916, 'support': 742353}}
[[ 12500 254162  18430]
 [  7161 150087  14268]
 [  8533 249722  27490]]
Evaluating performance on  train set...
694/694 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1325636
{'0': {'precision': 0.43667711598746084, 'recall': 0.04693712514320372, 'f1-score': 0.0847632956066691, 'support': 59356}, '1': {'precision': 0.33617923335731925, 'recall': 0.8645017170673157, 'f1-score': 0.4841044981633005, 'support': 59986}, '2': {'precision': 0.4276451517830828, 'recall': 0.12452797802952283, 'f1-score': 0.19288800265869058, 'support': 58260}, 'accuracy': 0.3485264805576514, 'macro avg': {'precision': 0.40016716704262095, 'recall': 0.3453222734133474, 'f1-score': 0.25391859880955336, 'support': 177602}, 'weighted avg': {'precision': 0.3997706159367929, 'recall': 0.3485264805576514, 'f1-score': 0.25511175344730636, 'support': 177602}}
[[ 2786 52763  3807]
 [ 2225 51858  5903]
 [ 1369 49636  7255]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1250937
{'0': {'precision': 0.42176296921130324, 'recall': 0.05062265870203503, 'f1-score': 0.0903954802259887, 'support': 19754}, '1': {'precision': 0.3472214359845268, 'recall': 0.8604227064434677, 'f1-score': 0.4947768919482126, 'support': 21386}, '2': {'precision': 0.40465369932739503, 'recall': 0.11284026968114766, 'f1-score': 0.1764705882352941, 'support': 19727}, 'accuracy': 0.3553156883040071, 'macro avg': {'precision': 0.39121270150774173, 'recall': 0.3412952116088835, 'f1-score': 0.2538809868031651, 'support': 60867}, 'weighted avg': {'precision': 0.3900272208322522, 'recall': 0.3553156883040071, 'f1-score': 0.26037436084752497, 'support': 60867}}
[[ 1000 17560  1194]
 [  904 18401  2081]
 [  467 17034  2226]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/EXC
Evaluating performance on  test set...
7167/7167 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0453736
{'0': {'precision': 0.4791862303782284, 'recall': 0.15284160080388026, 'f1-score': 0.23176065015112468, 'support': 517490}, '1': {'precision': 0.44985692878425976, 'recall': 0.8102786402526011, 'f1-score': 0.5785241993321733, 'support': 798413}, '2': {'precision': 0.46369246192937275, 'recall': 0.2068857813262176, 'f1-score': 0.28611538846115386, 'support': 518663}, 'accuracy': 0.45424094854041774, 'macro avg': {'precision': 0.4642452070306203, 'recall': 0.3900020074608997, 'f1-score': 0.36546674598148393, 'support': 1834566}, 'weighted avg': {'precision': 0.4620416086537802, 'recall': 0.45424094854041774, 'f1-score': 0.39804102230910826, 'support': 1834566}}
[[ 79094 404869  33527]
 [ 60895 646937  90581]
 [ 25070 386289 107304]]
Evaluating performance on  train set...
1570/1570 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99591804
{'0': {'precision': 0.49916057790073537, 'recall': 0.20933945518192004, 'f1-score': 0.29497247296202106, 'support': 100841}, '1': {'precision': 0.5293010657565005, 'recall': 0.8203192772886359, 'f1-score': 0.6434340886560808, 'support': 200578}, '2': {'precision': 0.48585964695462314, 'recall': 0.23522138013562027, 'f1-score': 0.31698123349616, 'support': 100280}, 'accuracy': 0.5208775725107605, 'macro avg': {'precision': 0.5047737635372863, 'recall': 0.4216267042020587, 'f1-score': 0.4184625983714206, 'support': 401699}, 'weighted avg': {'precision': 0.5108900106796508, 'recall': 0.5208775725107605, 'f1-score': 0.4744620222490408, 'support': 401699}}
[[ 21110  74167   5564]
 [ 16643 164538  19397]
 [  4538  72154  23588]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0278559
{'0': {'precision': 0.5043603258265453, 'recall': 0.1541819247107075, 'f1-score': 0.23616782589185553, 'support': 34135}, '1': {'precision': 0.48461758638727953, 'recall': 0.846741511028334, 'f1-score': 0.6164314769246221, 'support': 57987}, '2': {'precision': 0.4997856836690956, 'recall': 0.20804091828238372, 'f1-score': 0.2937891067904086, 'support': 33628}, 'accuracy': 0.4879443339960239, 'macro avg': {'precision': 0.49625453196097347, 'recall': 0.40298811800714174, 'f1-score': 0.38212946986896207, 'support': 125750}, 'weighted avg': {'precision': 0.49403302325528947, 'recall': 0.4879443339960239, 'f1-score': 0.42692756160949824, 'support': 125750}}
[[ 5263 26964  1908]
 [ 3793 49100  5094]
 [ 1379 25253  6996]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/AAL
Evaluating performance on  test set...
6357/6357 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0730624
{'0': {'precision': 0.472676010653892, 'recall': 0.15681851575159192, 'f1-score': 0.23550435250132862, 'support': 483221}, '1': {'precision': 0.42192182122465655, 'recall': 0.8341140116823028, 'f1-score': 0.5603835395420138, 'support': 663739}, '2': {'precision': 0.4551608210764506, 'recall': 0.14660852471033145, 'f1-score': 0.221780843278798, 'support': 480204}, 'accuracy': 0.43008203229668307, 'macro avg': {'precision': 0.44991955098499975, 'recall': 0.37918035071474204, 'f1-score': 0.33922291177404684, 'support': 1627164}, 'weighted avg': {'precision': 0.4468037574369962, 'recall': 0.43008203229668307, 'f1-score': 0.3639762844666998, 'support': 1627164}}
[[ 75778 377534  29909]
 [ 55741 553634  54364]
 [ 28798 381004  70402]]
Evaluating performance on  train set...
1701/1701 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0528083
{'0': {'precision': 0.483038029386344, 'recall': 0.17982688997216725, 'f1-score': 0.26208424680821135, 'support': 124314}, '1': {'precision': 0.4424558758365895, 'recall': 0.832455432787826, 'f1-score': 0.5778045815696375, 'support': 184721}, '2': {'precision': 0.4795413020482739, 'recall': 0.1578297714091294, 'f1-score': 0.23749397246084336, 'support': 126383}, 'accuracy': 0.4503121138767805, 'macro avg': {'precision': 0.46834506909040247, 'recall': 0.3900373647230409, 'f1-score': 0.3591276002795641, 'support': 435418}, 'weighted avg': {'precision': 0.46480657621483634, 'recall': 0.4503121138767805, 'f1-score': 0.3888874182770574, 'support': 435418}}
[[ 22355  94616   7343]
 [ 16643 153772  14306]
 [  7282  99154  19947]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0632924
{'0': {'precision': 0.4858345475149749, 'recall': 0.14263985930890252, 'f1-score': 0.22053203997648443, 'support': 42078}, '1': {'precision': 0.43659879995586826, 'recall': 0.8524557566116524, 'f1-score': 0.5774482677337703, 'support': 60348}, '2': {'precision': 0.479313824419778, 'recall': 0.159736734644856, 'f1-score': 0.2396180524277092, 'support': 41631}, 'accuracy': 0.44493499101050277, 'macro avg': {'precision': 0.4672490572968737, 'recall': 0.384944116855137, 'f1-score': 0.345866120045988, 'support': 144057}, 'weighted avg': {'precision': 0.4633244083556622, 'recall': 0.44493499101050277, 'f1-score': 0.37556616047776953, 'support': 144057}}
[[ 6002 33466  2610]
 [ 4290 51444  4614]
 [ 2062 32919  6650]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/WBA
Evaluating performance on  test set...
7458/7458 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1776279
{'0': {'precision': 0.5154402137466336, 'recall': 0.06917062955243794, 'f1-score': 0.12197284566361873, 'support': 700037}, '1': {'precision': 0.2546265740430966, 'recall': 0.8764653631927101, 'f1-score': 0.39461225980018994, 'support': 478465}, '2': {'precision': 0.49793287793287794, 'recall': 0.11471459225118509, 'f1-score': 0.18646993529041456, 'support': 730744}, 'accuracy': 0.28891352921519803, 'macro avg': {'precision': 0.42266655524086943, 'recall': 0.35345019499877767, 'f1-score': 0.23435168025140773, 'support': 1909246}, 'weighted avg': {'precision': 0.4433784790499838, 'recall': 0.28891352921519803, 'f1-score': 0.21498300702946568, 'support': 1909246}}
[[ 48422 605440  46175]
 [ 20759 419358  38348]
 [ 24762 622155  83827]]
Evaluating performance on  train set...
1664/1664 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0589688
{'0': {'precision': 0.5396374509437488, 'recall': 0.11559370071175232, 'f1-score': 0.19040208891057508, 'support': 124903}, '1': {'precision': 0.42743197438775565, 'recall': 0.8775037602520078, 'f1-score': 0.5748530825247682, 'support': 176185}, '2': {'precision': 0.4865081058020478, 'recall': 0.14611645431758666, 'f1-score': 0.22473626190901422, 'support': 124873}, 'accuracy': 0.4396810975652701, 'macro avg': {'precision': 0.48452584371118407, 'recall': 0.37973797176044893, 'f1-score': 0.3299971444481192, 'support': 425961}, 'weighted avg': {'precision': 0.4776520987568179, 'recall': 0.4396810975652701, 'f1-score': 0.3594830834024434, 'support': 425961}}
[[ 14438 104342   6123]
 [  8447 154603  13135]
 [  3870 102757  18246]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1118789
{'0': {'precision': 0.5287896592244419, 'recall': 0.09335238797713442, 'f1-score': 0.15868973218658777, 'support': 43384}, '1': {'precision': 0.34668821544011286, 'recall': 0.8668095461344406, 'f1-score': 0.4952834099765925, 'support': 44793}, '2': {'precision': 0.48786136399936114, 'recall': 0.13884722032819674, 'f1-score': 0.2161712668082095, 'support': 43998}, 'accuracy': 0.370614715339512, 'macro avg': {'precision': 0.45444641288797194, 'recall': 0.36633638481325725, 'f1-score': 0.2900481363237966, 'support': 132175}, 'weighted avg': {'precision': 0.45345292304328394, 'recall': 0.370614715339512, 'f1-score': 0.29189278245728795, 'support': 132175}}
[[ 4050 36747  2587]
 [ 2140 38827  3826]
 [ 1469 36420  6109]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
8238/8238 - 52s - 52s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1920248
{'0': {'precision': 0.5115428392009106, 'recall': 0.07855276226844486, 'f1-score': 0.13619184056894285, 'support': 829608}, '1': {'precision': 0.22040680077336505, 'recall': 0.8592958789067191, 'f1-score': 0.3508274252754184, 'support': 457961}, '2': {'precision': 0.5235615459233165, 'recall': 0.12488735173052098, 'f1-score': 0.20166960010226057, 'support': 821140}, 'accuracy': 0.26615431527062294, 'macro avg': {'precision': 0.41850372863253077, 'recall': 0.35424533096856164, 'f1-score': 0.2295629553155406, 'support': 2108709}, 'weighted avg': {'precision': 0.45299521102827955, 'recall': 0.26615431527062294, 'f1-score': 0.2083028499452725, 'support': 2108709}}
[[ 65168 710402  54038]
 [ 25155 393524  39282]
 [ 37072 681518 102550]]
Evaluating performance on  train set...
1806/1806 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1122304
{'0': {'precision': 0.5216832990901086, 'recall': 0.09198473282442748, 'f1-score': 0.15639367342000488, 'support': 154580}, '1': {'precision': 0.34312341652982753, 'recall': 0.8686138960584169, 'f1-score': 0.49192471761761264, 'support': 154202}, '2': {'precision': 0.5090586624160923, 'recall': 0.14783736911421455, 'f1-score': 0.22913182532424556, 'support': 153378}, 'accuracy': 0.3696468755409382, 'macro avg': {'precision': 0.45795512601200955, 'recall': 0.36947866599901963, 'f1-score': 0.2924834054539544, 'support': 462160}, 'weighted avg': {'precision': 0.4579161350466005, 'recall': 0.3696468755409382, 'f1-score': 0.29248504943724596, 'support': 462160}}
[[ 14219 131235   9126]
 [  7518 133942  12742]
 [  5519 125184  22675]]
Evaluating performance on  val set...
642/642 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1227804
{'0': {'precision': 0.5305969349480227, 'recall': 0.08842176700659012, 'f1-score': 0.15158287918682262, 'support': 55993}, '1': {'precision': 0.33263103581717335, 'recall': 0.8804415865247823, 'f1-score': 0.48284363443444067, 'support': 52719}, '2': {'precision': 0.5303255874166612, 'recall': 0.14732961697536415, 'f1-score': 0.23059710944426462, 'support': 55610}, 'accuracy': 0.3624590742566424, 'macro avg': {'precision': 0.4645178527272858, 'recall': 0.37206432350224555, 'f1-score': 0.2883412076885093, 'support': 164322}, 'weighted avg': {'precision': 0.4669922205914651, 'recall': 0.3624590742566424, 'f1-score': 0.2846004733039556, 'support': 164322}}
[[ 4951 47786  3256]
 [ 2303 46416  4000]
 [ 2077 45340  8193]]
testing model on single stock: results/universal/W5/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
31315/31315 - 198s - 198s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1842582
{'0': {'precision': 0.5296864927444712, 'recall': 0.06573381315871364, 'f1-score': 0.11695373033656949, 'support': 3062503}, '1': {'precision': 0.22514817175479349, 'recall': 0.888472397582121, 'f1-score': 0.35925689858498494, 'support': 1804226}, '2': {'precision': 0.49713344482123223, 'recall': 0.08154388028009825, 'f1-score': 0.14010637137246346, 'support': 3149752}, 'accuracy': 0.25711506083529667, 'macro avg': {'precision': 0.4173227031068323, 'recall': 0.345250030340311, 'f1-score': 0.20543900009800597, 'support': 8016481}, 'weighted avg': {'precision': 0.4483552971078521, 'recall': 0.25711506083529667, 'f1-score': 0.18058448720410958, 'support': 8016481}}
[[ 201310 2721633  139560]
 [  80976 1603005  120245]
 [  97769 2795140  256843]]
Evaluating performance on  train set...
5759/5759 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.127779
{'0': {'precision': 0.4986570607008563, 'recall': 0.09507466523146624, 'f1-score': 0.15970058880378887, 'support': 497956}, '1': {'precision': 0.3273929368444109, 'recall': 0.8783160395310807, 'f1-score': 0.4769881842035481, 'support': 478206}, '2': {'precision': 0.44133556203864244, 'recall': 0.08535789513844128, 'f1-score': 0.14304895613196753, 'support': 498009}, 'accuracy': 0.3458676096599377, 'macro avg': {'precision': 0.4224618531946365, 'recall': 0.3529161999669961, 'f1-score': 0.25991257637976817, 'support': 1474171}, 'weighted avg': {'precision': 0.42373620427364006, 'recall': 0.3458676096599377, 'f1-score': 0.25700013472517536, 'support': 1474171}}
[[ 47343 427434  23179]
 [ 27559 420016  30631]
 [ 20039 435461  42509]]
Evaluating performance on  val set...
2129/2129 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1403518
{'0': {'precision': 0.4854532677442024, 'recall': 0.09171486078140849, 'f1-score': 0.15428183458700354, 'support': 188301}, '1': {'precision': 0.30607070368567146, 'recall': 0.8778691943586364, 'f1-score': 0.45389135462899294, 'support': 165421}, '2': {'precision': 0.4628563243088383, 'recall': 0.08449039572841327, 'f1-score': 0.14289631261000701, 'support': 191217}, 'accuracy': 0.3278238481738323, 'macro avg': {'precision': 0.4181267652462373, 'recall': 0.351358150289486, 'f1-score': 0.2503565006086678, 'support': 544939}, 'weighted avg': {'precision': 0.42307094080117524, 'recall': 0.3278238481738323, 'f1-score': 0.24123578917456395, 'support': 544939}}
[[ 17270 162806   8225]
 [  9679 145218  10524]
 [  8626 166435  16156]]
training model: results/universal/W5/deepOF_L1/h100
Epoch 1/50
9913/9913 - 137s - loss: 3.2020 - accuracy100: 0.4164 - val_loss: 3.3228 - val_accuracy100: 0.3450 - 137s/epoch - 14ms/step
Epoch 2/50
9913/9913 - 133s - loss: 3.1916 - accuracy100: 0.4221 - val_loss: 3.4153 - val_accuracy100: 0.3296 - 133s/epoch - 13ms/step
Epoch 3/50
9913/9913 - 132s - loss: 3.1811 - accuracy100: 0.4276 - val_loss: 3.4881 - val_accuracy100: 0.3303 - 132s/epoch - 13ms/step
Epoch 4/50
9913/9913 - 136s - loss: 3.1745 - accuracy100: 0.4302 - val_loss: 3.5072 - val_accuracy100: 0.3317 - 136s/epoch - 14ms/step
Epoch 5/50
9913/9913 - 132s - loss: 3.1693 - accuracy100: 0.4325 - val_loss: 3.5331 - val_accuracy100: 0.3354 - 132s/epoch - 13ms/step
Epoch 6/50
9913/9913 - 132s - loss: 3.1652 - accuracy100: 0.4339 - val_loss: 3.5392 - val_accuracy100: 0.3348 - 132s/epoch - 13ms/step
Epoch 7/50
9913/9913 - 131s - loss: 3.1614 - accuracy100: 0.4354 - val_loss: 3.5560 - val_accuracy100: 0.3358 - 131s/epoch - 13ms/step
Epoch 8/50
9913/9913 - 132s - loss: 3.1583 - accuracy100: 0.4364 - val_loss: 3.5483 - val_accuracy100: 0.3357 - 132s/epoch - 13ms/step
Epoch 9/50
9913/9913 - 134s - loss: 3.1558 - accuracy100: 0.4371 - val_loss: 3.5431 - val_accuracy100: 0.3365 - 134s/epoch - 14ms/step
Epoch 10/50
9913/9913 - 136s - loss: 3.1534 - accuracy100: 0.4382 - val_loss: 3.5451 - val_accuracy100: 0.3368 - 136s/epoch - 14ms/step
Epoch 11/50
9913/9913 - 133s - loss: 3.1507 - accuracy100: 0.4387 - val_loss: 3.5394 - val_accuracy100: 0.3375 - 133s/epoch - 13ms/step
testing model in sample: results/universal/W5/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 308s - 308s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1343526
{'0': {'precision': 0.4934964293922746, 'recall': 0.09573762030878598, 'f1-score': 0.1603647101007447, 'support': 5068624}, '1': {'precision': 0.19858261708747582, 'recall': 0.7020451198079113, 'f1-score': 0.3095928572786988, 'support': 2585472}, '2': {'precision': 0.4697002570824767, 'recall': 0.24595401088292085, 'f1-score': 0.32285048049978204, 'support': 5184270}, 'accuracy': 0.2784986812184666, 'macro avg': {'precision': 0.3872597678540757, 'recall': 0.347912250333206, 'f1-score': 0.26426934929307516, 'support': 12838366}, 'weighted avg': {'precision': 0.4244956557464829, 'recall': 0.2784986812184666, 'f1-score': 0.25603072406600297, 'support': 12838366}}
[[ 485258 3705971  877395]
 [ 208148 1815118  562206]
 [ 289900 3619278 1275092]]
Evaluating performance on  train set...
9913/9913 - 66s - 66s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903515
{'0': {'precision': 0.45954372488668516, 'recall': 0.12446501437238963, 'f1-score': 0.19587760414451352, 'support': 832499}, '1': {'precision': 0.3466754122366795, 'recall': 0.7043289620936038, 'f1-score': 0.46464798672150903, 'support': 871225}, '2': {'precision': 0.4147040954074632, 'recall': 0.26948933279891324, 'f1-score': 0.3266863590704468, 'support': 833302}, 'accuracy': 0.37122678285520133, 'macro avg': {'precision': 0.4069744108436093, 'recall': 0.3660944364216356, 'f1-score': 0.3290706499788231, 'support': 2537026}, 'weighted avg': {'precision': 0.40605643362014093, 'recall': 0.37122678285520133, 'f1-score': 0.33113939241863166, 'support': 2537026}}
[[103617 595042 133840]
 [ 74493 613629 183103]
 [ 47368 561368 224566]]
Evaluating performance on  val set...
3496/3496 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036022
{'0': {'precision': 0.4532909592707201, 'recall': 0.08830813347236705, 'f1-score': 0.14781885372206238, 'support': 306880}, '1': {'precision': 0.31063510636973596, 'recall': 0.72217599861088, 'f1-score': 0.43441287000950934, 'support': 276434}, '2': {'precision': 0.4260199824788286, 'recall': 0.2627732765524939, 'f1-score': 0.32505157448907934, 'support': 310903}, 'accuracy': 0.34491739700766144, 'macro avg': {'precision': 0.3966486827064282, 'recall': 0.357752469545247, 'f1-score': 0.3024277660735504, 'support': 894217}, 'weighted avg': {'precision': 0.3997093828319362, 'recall': 0.34491739700766144, 'f1-score': 0.29803576402798587, 'support': 894217}}
[[ 27100 228258  51522]
 [ 18251 199634  58549]
 [ 14434 214772  81697]]
testing model out of sample: results/universal/W5/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 129s - 129s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1144952
{'0': {'precision': 0.44354272875121165, 'recall': 0.11374384415773517, 'f1-score': 0.18105677570170822, 'support': 1922970}, '1': {'precision': 0.2803559706650785, 'recall': 0.6853553545109828, 'f1-score': 0.3979314742516981, 'support': 1505581}, '2': {'precision': 0.4257414115730919, 'recall': 0.26054331999491737, 'f1-score': 0.3232596493211756, 'support': 1920268}, 'accuracy': 0.3273427274319808, 'macro avg': {'precision': 0.383213370329794, 'recall': 0.35321417288787843, 'f1-score': 0.300749299758194, 'support': 5348819}, 'weighted avg': {'precision': 0.39121824699905816, 'recall': 0.3273427274319808, 'f1-score': 0.2931544281436958, 'support': 5348819}}
[[ 218726 1364703  339541]
 [ 138420 1031858  335303]
 [ 135988 1283967  500313]]
Evaluating performance on  train set...
4957/4957 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933876
{'0': {'precision': 0.4561634858867216, 'recall': 0.13235076650071476, 'f1-score': 0.20517289687319198, 'support': 426027}, '1': {'precision': 0.33530972555264577, 'recall': 0.6937378739004678, 'f1-score': 0.45210164471821507, 'support': 420065}, '2': {'precision': 0.4230974347067381, 'recall': 0.27619550595858355, 'f1-score': 0.33421647282017625, 'support': 422248}, 'accuracy': 0.3661660122680038, 'macro avg': {'precision': 0.4048568820487019, 'recall': 0.3674280487865887, 'f1-score': 0.3304970048038611, 'support': 1268340}, 'weighted avg': {'precision': 0.40512945020750374, 'recall': 0.3661660122680038, 'f1-score': 0.32991430400375776, 'support': 1268340}}
[[ 56385 300090  69552]
 [ 39184 291415  89466]
 [ 28038 277587 116623]]
Evaluating performance on  val set...
1701/1701 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0975649
{'0': {'precision': 0.4480208786428882, 'recall': 0.1190128256540268, 'f1-score': 0.18806723591643842, 'support': 147127}, '1': {'precision': 0.3295944290325919, 'recall': 0.6963135883095543, 'f1-score': 0.44741063660092806, 'support': 141791}, '2': {'precision': 0.41871124292262063, 'recall': 0.27627401609283486, 'f1-score': 0.3328963748938521, 'support': 146152}, 'accuracy': 0.3599857494196336, 'macro avg': {'precision': 0.39877551686603363, 'recall': 0.36386681001880533, 'f1-score': 0.3227914158037395, 'support': 435070}, 'weighted avg': {'precision': 0.3995793253377142, 'recall': 0.3599857494196336, 'f1-score': 0.3212403539118907, 'support': 435070}}
[[ 17510 104250  25367]
 [ 12371  98731  30689]
 [  9202  96572  40378]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1283437
{'0': {'precision': 0.45327132984563717, 'recall': 0.07034460637892669, 'f1-score': 0.1217884753880728, 'support': 99766}, '1': {'precision': 0.2612359680914748, 'recall': 0.7906127550805444, 'f1-score': 0.3927113926346557, 'support': 71203}, '2': {'precision': 0.3914379911256538, 'recall': 0.15736551531700316, 'f1-score': 0.22448413854869317, 'support': 100346}, 'accuracy': 0.29155409763558965, 'macro avg': {'precision': 0.36864842968758865, 'recall': 0.3394409589254914, 'f1-score': 0.2463280021904739, 'support': 271315}, 'weighted avg': {'precision': 0.38000511872506854, 'recall': 0.29155409763558965, 'f1-score': 0.2308706252589758, 'support': 271315}}
[[ 7018 80030 12718]
 [ 3077 56294 11832]
 [ 5388 79167 15791]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011455
{'0': {'precision': 0.4274633725940822, 'recall': 0.06290956749672345, 'f1-score': 0.10967789489201739, 'support': 23653}, '1': {'precision': 0.33040428147826717, 'recall': 0.7949710706051246, 'f1-score': 0.4667986461459863, 'support': 22987}, '2': {'precision': 0.40417317768177224, 'recall': 0.19094146256730937, 'f1-score': 0.259356475064146, 'support': 23028}, 'accuracy': 0.3467732674972728, 'macro avg': {'precision': 0.38734694391804053, 'recall': 0.3496073668897191, 'f1-score': 0.2786110053673832, 'support': 69668}, 'weighted avg': {'precision': 0.38774034428955334, 'recall': 0.3467732674972728, 'f1-score': 0.27698473667416645, 'support': 69668}}
[[ 1488 19273  2892]
 [ 1123 18274  3590]
 [  870 17761  4397]]
Evaluating performance on  val set...
96/96 - 1s - 649ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072176
{'0': {'precision': 0.4416722859069454, 'recall': 0.07467791585908107, 'f1-score': 0.12775502243027112, 'support': 8771}, '1': {'precision': 0.29542128371315074, 'recall': 0.7763736263736264, 'f1-score': 0.42798727850976825, 'support': 7280}, '2': {'precision': 0.4323211528564076, 'recall': 0.19881656804733727, 'f1-score': 0.27237354085603116, 'support': 8450}, 'accuracy': 0.3259866944206359, 'macro avg': {'precision': 0.3898049074921679, 'recall': 0.3499560367600149, 'f1-score': 0.2760386139320235, 'support': 24501}, 'weighted avg': {'precision': 0.39499156388548223, 'recall': 0.3259866944206359, 'f1-score': 0.2668398477417446, 'support': 24501}}
[[ 655 7024 1092]
 [ 514 5652 1114]
 [ 314 6456 1680]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0732529
{'0': {'precision': 0.550412026488938, 'recall': 0.1396571379174343, 'f1-score': 0.22278627204247323, 'support': 185089}, '1': {'precision': 0.3555117393829564, 'recall': 0.7397431508625608, 'f1-score': 0.4802304497372758, 'support': 192798}, '2': {'precision': 0.4634139753482132, 'recall': 0.28387217754834154, 'f1-score': 0.3520748612255926, 'support': 181314}, 'accuracy': 0.39331117075970895, 'macro avg': {'precision': 0.45644591374003585, 'recall': 0.3877574887761122, 'f1-score': 0.3516971943351139, 'support': 559201}, 'weighted avg': {'precision': 0.4550074220658622, 'recall': 0.39331117075970895, 'f1-score': 0.3534665709517217, 'support': 559201}}
[[ 25849 136219  23021]
 [ 13601 142621  36576]
 [  7513 122331  51470]]
Evaluating performance on  train set...
589/589 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0257089
{'0': {'precision': 0.48225520245200837, 'recall': 0.1615291098203431, 'f1-score': 0.2420010928298221, 'support': 37015}, '1': {'precision': 0.5320613985646113, 'recall': 0.7461434085549803, 'f1-score': 0.6211744835792741, 'support': 75909}, '2': {'precision': 0.4269786432160804, 'recall': 0.3599798760790129, 'f1-score': 0.39062724477774907, 'support': 37766}, 'accuracy': 0.5057601698851948, 'macro avg': {'precision': 0.48043174807756667, 'recall': 0.4225507981514454, 'f1-score': 0.4179342737289484, 'support': 150690}, 'weighted avg': {'precision': 0.4934912765419116, 'recall': 0.5057601698851948, 'f1-score': 0.4702557094126449, 'support': 150690}}
[[ 5979 27064  3972]
 [ 4997 56639 14273]
 [ 1422 22749 13595]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0499183
{'0': {'precision': 0.5129079396005846, 'recall': 0.1299037749814952, 'f1-score': 0.2073038684909932, 'support': 16212}, '1': {'precision': 0.4414112736890636, 'recall': 0.7694682966033586, 'f1-score': 0.5610004317522975, 'support': 23641}, '2': {'precision': 0.4786867884564469, 'recall': 0.3229532598987794, 'f1-score': 0.3856929531394439, 'support': 16795}, 'accuracy': 0.45404956926987716, 'macro avg': {'precision': 0.47766866724869833, 'recall': 0.40744177716121105, 'f1-score': 0.3846657511275782, 'support': 56648}, 'weighted avg': {'precision': 0.4729242347516921, 'recall': 0.45404956926987716, 'f1-score': 0.40780141701399886, 'support': 56648}}
[[ 2106 12327  1779]
 [ 1322 18191  4128]
 [  678 10693  5424]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
2341/2341 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1085916
{'0': {'precision': 0.4535621464607858, 'recall': 0.11384414662458389, 'f1-score': 0.18200501522204243, 'support': 208478}, '1': {'precision': 0.3012172725560369, 'recall': 0.7144660199596785, 'f1-score': 0.42377285803958725, 'support': 179061}, '2': {'precision': 0.43073713490959664, 'recall': 0.24865046118098225, 'f1-score': 0.3152927367510158, 'support': 211739}, 'accuracy': 0.34093692743601467, 'macro avg': {'precision': 0.3951721846421397, 'recall': 0.3589868759217482, 'f1-score': 0.30702353667088184, 'support': 599278}, 'weighted avg': {'precision': 0.39997771555043127, 'recall': 0.34093692743601467, 'f1-score': 0.30133761306740914, 'support': 599278}}
[[ 23734 150770  33974]
 [ 15521 127933  35607]
 [ 13073 146017  52649]]
Evaluating performance on  train set...
483/483 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1030753
{'0': {'precision': 0.428421754452805, 'recall': 0.10895789932658301, 'f1-score': 0.17373167764237846, 'support': 41282}, '1': {'precision': 0.33678568183882984, 'recall': 0.7198232966819583, 'f1-score': 0.45887586553711657, 'support': 41199}, '2': {'precision': 0.4018526687251875, 'recall': 0.2443490770768818, 'f1-score': 0.3039061078425426, 'support': 41011}, 'accuracy': 0.3577154795452337, 'macro avg': {'precision': 0.38902003500560745, 'recall': 0.35771009102847434, 'f1-score': 0.3121712170073459, 'support': 123492}, 'weighted avg': {'precision': 0.38902698126589014, 'recall': 0.3577154795452337, 'f1-score': 0.3120907531615558, 'support': 123492}}
[[ 4498 30007  6777]
 [ 3404 29656  8139]
 [ 2597 28393 10021]]
Evaluating performance on  val set...
162/162 - 1s - 979ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1130478
{'0': {'precision': 0.4408817635270541, 'recall': 0.10469780406553811, 'f1-score': 0.16921217448632017, 'support': 14709}, '1': {'precision': 0.2914202212789646, 'recall': 0.6962014795112625, 'f1-score': 0.41086012802589955, 'support': 12031}, '2': {'precision': 0.42506602112676056, 'recall': 0.26489748337104846, 'f1-score': 0.32639094250348527, 'support': 14583}, 'accuracy': 0.33344626479200445, 'macro avg': {'precision': 0.38578933531092646, 'recall': 0.35526558898261634, 'f1-score': 0.30215441500523504, 'support': 41323}, 'weighted avg': {'precision': 0.3917853091019097, 'recall': 0.33344626479200445, 'f1-score': 0.2950356747895169, 'support': 41323}}
[[ 1540 10508  2661]
 [ 1091  8376  2564]
 [  862  9858  3863]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1126938
{'0': {'precision': 0.4054107192009752, 'recall': 0.05803186968439894, 'f1-score': 0.10153034092923403, 'support': 177661}, '1': {'precision': 0.3348988652675313, 'recall': 0.7424063026549479, 'f1-score': 0.4615795704499887, 'support': 175672}, '2': {'precision': 0.34623593885203346, 'recall': 0.21754390204121082, 'f1-score': 0.2672018816615903, 'support': 165539}, 'accuracy': 0.3406273608905472, 'macro avg': {'precision': 0.3621818411068467, 'recall': 0.33932735812685255, 'f1-score': 0.276770597680271, 'support': 518872}, 'weighted avg': {'precision': 0.36265895697757633, 'recall': 0.3406273608905472, 'f1-score': 0.2762857130242084, 'support': 518872}}
[[ 10310 136416  30935]
 [  8189 130420  37063]
 [  6932 122595  36012]]
Evaluating performance on  train set...
331/331 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1030163
{'0': {'precision': 0.4062067602292943, 'recall': 0.07319418720615473, 'f1-score': 0.12403802625622454, 'support': 28076}, '1': {'precision': 0.32847366372599895, 'recall': 0.7253357206803939, 'f1-score': 0.452176048398799, 'support': 27925}, '2': {'precision': 0.4132268586210775, 'recall': 0.25778838057816444, 'f1-score': 0.3175042129369572, 'support': 28504}, 'accuracy': 0.3509614815691379, 'macro avg': {'precision': 0.38263576085879025, 'recall': 0.35210609615490435, 'f1-score': 0.2979060958639936, 'support': 84505}, 'weighted avg': {'precision': 0.38288747929567934, 'recall': 0.3509614815691379, 'f1-score': 0.29772969483771666, 'support': 84505}}
[[ 2055 21457  4564]
 [ 1800 20255  5870]
 [ 1204 19952  7348]]
Evaluating performance on  val set...
136/136 - 1s - 963ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1086054
{'0': {'precision': 0.4367469879518072, 'recall': 0.07024059421927983, 'f1-score': 0.12101822228404506, 'support': 12386}, '1': {'precision': 0.3068681844270136, 'recall': 0.7625748787677095, 'f1-score': 0.4376295972934629, 'support': 10517}, '2': {'precision': 0.4332623897841289, 'recall': 0.2414844941535333, 'f1-score': 0.3101196953210011, 'support': 11802}, 'accuracy': 0.33827978677424003, 'macro avg': {'precision': 0.39229252072098325, 'recall': 0.35809998904684087, 'f1-score': 0.2895891716328363, 'support': 34705}, 'weighted avg': {'precision': 0.39620353299588745, 'recall': 0.33827978677424003, 'f1-score': 0.2812711373036734, 'support': 34705}}
[[ 870 9704 1812]
 [ 581 8020 1916]
 [ 541 8411 2850]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.124327
{'0': {'precision': 0.39846280197728295, 'recall': 0.09786712541485248, 'f1-score': 0.15713905957338892, 'support': 262744}, '1': {'precision': 0.2907351260647391, 'recall': 0.7191405534176287, 'f1-score': 0.41406962006117115, 'support': 218280}, '2': {'precision': 0.3847961188986142, 'recall': 0.20305056078736, 'f1-score': 0.26582804813289646, 'support': 261329}, 'accuracy': 0.31757263727633617, 'macro avg': {'precision': 0.3579980156468787, 'recall': 0.3400194132066137, 'f1-score': 0.2790122425891522, 'support': 742353}, 'weighted avg': {'precision': 0.3619757160216049, 'recall': 0.31757263727633617, 'f1-score': 0.2709479718220639, 'support': 742353}}
[[ 25714 194118  42912]
 [ 19382 156974  41924]
 [ 19437 188829  53063]]
Evaluating performance on  train set...
694/694 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054662
{'0': {'precision': 0.42282571330354074, 'recall': 0.10129959974304492, 'f1-score': 0.16344211757202085, 'support': 60711}, '1': {'precision': 0.3200396492321958, 'recall': 0.6988549085323279, 'f1-score': 0.439027332291581, 'support': 57288}, '2': {'precision': 0.3982876712328767, 'recall': 0.2536617284364881, 'f1-score': 0.30993306888882055, 'support': 59603}, 'accuracy': 0.3451819236269862, 'macro avg': {'precision': 0.3803843445895378, 'recall': 0.3512720789039536, 'f1-score': 0.30413417291747413, 'support': 177602}, 'weighted avg': {'precision': 0.38143570102858326, 'recall': 0.3451819236269862, 'f1-score': 0.3014981414466922, 'support': 177602}}
[[ 6150 44206 10355]
 [ 4766 40036 12486]
 [ 3629 40855 15119]]
Evaluating performance on  val set...
238/238 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1065412
{'0': {'precision': 0.4015779890754603, 'recall': 0.09691436383165707, 'f1-score': 0.15614552605703047, 'support': 20482}, '1': {'precision': 0.32358714507440883, 'recall': 0.7062017434620175, 'f1-score': 0.44381486061327025, 'support': 20075}, '2': {'precision': 0.3901915455746367, 'recall': 0.2326932545544067, 'f1-score': 0.29153044229227065, 'support': 20310}, 'accuracy': 0.343174462352342, 'macro avg': {'precision': 0.3717855599081686, 'recall': 0.34526978728269375, 'f1-score': 0.2971636096541905, 'support': 60867}, 'weighted avg': {'precision': 0.372055836499798, 'recall': 0.343174462352342, 'f1-score': 0.2961989136061826, 'support': 60867}}
[[ 1985 15194  3303]
 [ 1815 14177  4083]
 [ 1143 14441  4726]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/EXC
Evaluating performance on  test set...
7167/7167 - 47s - 47s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998279
{'0': {'precision': 0.47057201305623814, 'recall': 0.17696464422096084, 'f1-score': 0.25720430784875287, 'support': 646033}, '1': {'precision': 0.29300622597166937, 'recall': 0.5994811366045323, 'f1-score': 0.39362284048633445, 'support': 531161}, '2': {'precision': 0.4497909400074077, 'recall': 0.34545128177044354, 'f1-score': 0.3907761748537967, 'support': 657372}, 'accuracy': 0.3596687172879035, 'macro avg': {'precision': 0.4044563930117717, 'recall': 0.37396568753197884, 'f1-score': 0.347201107729628, 'support': 1834566}, 'weighted avg': {'precision': 0.4117150863575626, 'recall': 0.3596687172879035, 'f1-score': 0.3445637212310733, 'support': 1834566}}
[[114325 398131 133577]
 [ 68528 318421 144212]
 [ 60096 370186 227090]]
Evaluating performance on  train set...
1570/1570 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0747339
{'0': {'precision': 0.48452453288774117, 'recall': 0.19329596242708885, 'f1-score': 0.27634642667619697, 'support': 132010}, '1': {'precision': 0.3666260147268986, 'recall': 0.6227779794830176, 'f1-score': 0.4615437374696634, 'support': 140469}, '2': {'precision': 0.4459990581757589, 'recall': 0.38112521281535366, 'f1-score': 0.41101801004823824, 'support': 129220}, 'accuracy': 0.40390192656690704, 'macro avg': {'precision': 0.43238320193013285, 'recall': 0.3990663849084867, 'f1-score': 0.38296939139803293, 'support': 401699}, 'weighted avg': {'precision': 0.43090391448984194, 'recall': 0.40390192656690704, 'f1-score': 0.3844292027179163, 'support': 401699}}
[[25517 81672 24821]
 [16634 87481 36354]
 [10513 69458 49249]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0878892
{'0': {'precision': 0.48634300881924825, 'recall': 0.13205310022551323, 'f1-score': 0.20770862283332112, 'support': 43013}, '1': {'precision': 0.3367495444372424, 'recall': 0.6723232816505921, 'f1-score': 0.44873779762389787, 'support': 40955}, '2': {'precision': 0.4475606736007925, 'recall': 0.3460341773969652, 'f1-score': 0.3903031611910482, 'support': 41782}, 'accuracy': 0.37910934393638174, 'macro avg': {'precision': 0.4235510756190944, 'recall': 0.3834701864243568, 'f1-score': 0.34891652721608907, 'support': 125750}, 'weighted avg': {'precision': 0.42473661626368114, 'recall': 0.37910934393638174, 'f1-score': 0.3468777270497078, 'support': 125750}}
[[ 5680 29410  7923]
 [ 3497 27535  9923]
 [ 2502 24822 14458]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/AAL
Evaluating performance on  test set...
6357/6357 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1002839
{'0': {'precision': 0.45542743628270277, 'recall': 0.14330894943839126, 'f1-score': 0.2180152367405875, 'support': 564717}, '1': {'precision': 0.3160450388383326, 'recall': 0.6608587417679838, 'f1-score': 0.42759815419914576, 'support': 505344}, '2': {'precision': 0.4222370454481805, 'recall': 0.29769180923455807, 'f1-score': 0.34919147681812446, 'support': 557103}, 'accuracy': 0.3569001034929485, 'macro avg': {'precision': 0.397903173523072, 'recall': 0.36728650014697767, 'f1-score': 0.33160162258595255, 'support': 1627164}, 'weighted avg': {'precision': 0.4007761998005702, 'recall': 0.3569001034929485, 'f1-score': 0.3280165314570965, 'support': 1627164}}
[[ 80929 376770 107018]
 [ 51469 333961 119914]
 [ 45301 345957 165845]]
Evaluating performance on  train set...
1701/1701 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0873716
{'0': {'precision': 0.4767730394136996, 'recall': 0.1701750772399588, 'f1-score': 0.25082347940921995, 'support': 145650}, '1': {'precision': 0.3460894766203647, 'recall': 0.6807547378155668, 'f1-score': 0.4588856763376606, 'support': 144898}, '2': {'precision': 0.43847670141640754, 'recall': 0.29788085870090425, 'f1-score': 0.35475650258130276, 'support': 144870}, 'accuracy': 0.3825749050337836, 'macro avg': {'precision': 0.42044640581682396, 'recall': 0.3829368912521433, 'f1-score': 0.3548218861093944, 'support': 435418}, 'weighted avg': {'precision': 0.42054252674013914, 'recall': 0.3825749050337836, 'f1-score': 0.3546422771563889, 'support': 435418}}
[[24786 96098 24766]
 [15760 98640 30498]
 [11441 90275 43154]]
Evaluating performance on  val set...
563/563 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0937155
{'0': {'precision': 0.4783246631986128, 'recall': 0.14672367586587837, 'f1-score': 0.22456360078277887, 'support': 48881}, '1': {'precision': 0.33847204707860445, 'recall': 0.682278427385189, 'f1-score': 0.45247527534277365, 'support': 47208}, '2': {'precision': 0.41937291685101613, 'recall': 0.2964059372915277, 'f1-score': 0.347326892306189, 'support': 47968}, 'accuracy': 0.3720680008607704, 'macro avg': {'precision': 0.4120565423760778, 'recall': 0.37513601351419834, 'f1-score': 0.34145525614391387, 'support': 144057}, 'weighted avg': {'precision': 0.41286474337108015, 'recall': 0.3720680008607704, 'f1-score': 0.3401287166773426, 'support': 144057}}
[[ 7172 32684  9025]
 [ 4339 32209 10660]
 [ 3483 30267 14218]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/WBA
Evaluating performance on  test set...
7458/7458 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1382072
{'0': {'precision': 0.4550383282767535, 'recall': 0.10266557035752909, 'f1-score': 0.16753251903553298, 'support': 740667}, '1': {'precision': 0.21346105297324589, 'recall': 0.6937785255713661, 'f1-score': 0.32647317886255, 'support': 409501}, '2': {'precision': 0.4408403676061099, 'recall': 0.23880813302453766, 'f1-score': 0.3097962109890035, 'support': 759078}, 'accuracy': 0.2835768675173341, 'macro avg': {'precision': 0.3697799162853698, 'recall': 0.34508407631781096, 'f1-score': 0.2679339696290288, 'support': 1909246}, 'weighted avg': {'precision': 0.3975792604541615, 'recall': 0.2835768675173341, 'f1-score': 0.2581838012173366, 'support': 1909246}}
[[ 76041 522141 142485]
 [ 37956 284103  87442]
 [ 53112 524692 181274]]
Evaluating performance on  train set...
1664/1664 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0871847
{'0': {'precision': 0.49014552396063166, 'recall': 0.13766667827176826, 'f1-score': 0.21495824997825513, 'support': 143615}, '1': {'precision': 0.33576456013287226, 'recall': 0.7036590584878745, 'f1-score': 0.4546053601710535, 'support': 140200}, '2': {'precision': 0.4399616591146741, 'recall': 0.2841585412181841, 'f1-score': 0.3452986484522599, 'support': 142146}, 'accuracy': 0.3728416451271361, 'macro avg': {'precision': 0.4219572477360593, 'recall': 0.375161425992609, 'f1-score': 0.33828741953385616, 'support': 425961}, 'weighted avg': {'precision': 0.4225861774921865, 'recall': 0.3728416451271361, 'f1-score': 0.3373306998751147, 'support': 425961}}
[[ 19771 101655  22189]
 [ 12320  98653  29227]
 [  8246  93508  40392]]
Evaluating performance on  val set...
517/517 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1104085
{'0': {'precision': 0.4901094856932561, 'recall': 0.11189530951330687, 'f1-score': 0.18219440454203434, 'support': 47607}, '1': {'precision': 0.27549005705060375, 'recall': 0.6975941220340856, 'f1-score': 0.3949920235227876, 'support': 36203}, '2': {'precision': 0.44153477541929603, 'recall': 0.2705262069678486, 'f1-score': 0.33549578194312674, 'support': 48365}, 'accuracy': 0.33036504634007946, 'macro avg': {'precision': 0.40237810605438523, 'recall': 0.3600052128384137, 'f1-score': 0.3042274033359829, 'support': 132175}, 'weighted avg': {'precision': 0.4135505067823424, 'recall': 0.33036504634007946, 'f1-score': 0.29657559098397906, 'support': 132175}}
[[ 5327 33943  8337]
 [ 2736 25255  8212]
 [ 2806 32475 13084]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
8238/8238 - 47s - 47s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1218303
{'0': {'precision': 0.44354283842079395, 'recall': 0.10317491568912628, 'f1-score': 0.16740811731305294, 'support': 787265}, '1': {'precision': 0.24713917904346452, 'recall': 0.6708645778673031, 'f1-score': 0.3612118573052454, 'support': 531693}, '2': {'precision': 0.4417867369429406, 'recall': 0.2697913646199878, 'f1-score': 0.33500257067792, 'support': 789751}, 'accuracy': 0.30871400463506343, 'macro avg': {'precision': 0.37748958480239975, 'recall': 0.3479436193921391, 'f1-score': 0.2878741817654061, 'support': 2108709}, 'weighted avg': {'precision': 0.3933636369456039, 'recall': 0.30871400463506343, 'f1-score': 0.2790413389036213, 'support': 2108709}}
[[ 81226 562819 143220]
 [ 49000 356694 125999]
 [ 52904 523779 213068]]
Evaluating performance on  train set...
1806/1806 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904157
{'0': {'precision': 0.4543772406615011, 'recall': 0.12696227646690061, 'f1-score': 0.1984684238707657, 'support': 154731}, '1': {'precision': 0.33329208077884825, 'recall': 0.6833818065884588, 'f1-score': 0.44806057697435075, 'support': 153693}, '2': {'precision': 0.4292582351410981, 'recall': 0.28980850288806786, 'f1-score': 0.34601151714952494, 'support': 153736}, 'accuracy': 0.36617188852345506, 'macro avg': {'precision': 0.40564251886048247, 'recall': 0.3667175286478091, 'f1-score': 0.3308468393315471, 'support': 462160}, 'weighted avg': {'precision': 0.4057541730863556, 'recall': 0.36617188852345506, 'f1-score': 0.3305509316067286, 'support': 462160}}
[[ 19645 110431  24655]
 [ 14078 105031  34584]
 [  9512  99670  44554]]
Evaluating performance on  val set...
642/642 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920393
{'0': {'precision': 0.4378289941670223, 'recall': 0.11338515953135363, 'f1-score': 0.18012349653214715, 'support': 54284}, '1': {'precision': 0.33778839493455054, 'recall': 0.6891135387792815, 'f1-score': 0.4533530389802327, 'support': 55197}, '2': {'precision': 0.425752828084338, 'recall': 0.29235426049853214, 'f1-score': 0.34666320716980725, 'support': 54841}, 'accuracy': 0.36650600649943404, 'macro avg': {'precision': 0.40045673906197027, 'recall': 0.36495098626972244, 'f1-score': 0.32671324756072906, 'support': 164322}, 'weighted avg': {'precision': 0.4001942892585181, 'recall': 0.36650600649943404, 'f1-score': 0.327484503126437, 'support': 164322}}
[[ 6155 39008  9121]
 [ 4656 38037 12504]
 [ 3247 35561 16033]]
testing model on single stock: results/universal/W5/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
31315/31315 - 207s - 207s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.147033
{'0': {'precision': 0.5168238060701963, 'recall': 0.07793384739697286, 'f1-score': 0.13544362951395206, 'support': 3319174}, '1': {'precision': 0.15840141970190305, 'recall': 0.7364001755018256, 'f1-score': 0.2607211115703511, 'support': 1276340}, '2': {'precision': 0.49222918101786606, 'recall': 0.22767509888285972, 'f1-score': 0.3113423008867952, 'support': 3420967}, 'accuracy': 0.24667207469212488, 'macro avg': {'precision': 0.3891514689299885, 'recall': 0.34733637392721933, 'f1-score': 0.23583568065703278, 'support': 8016481}, 'weighted avg': {'precision': 0.4492622127353275, 'recall': 0.24667207469212488, 'f1-score': 0.23045292493400052, 'support': 8016481}}
[[ 258676 2513735  546763]
 [  79745  939897  256698]
 [ 162090 2480008  778869]]
Evaluating performance on  train set...
5759/5759 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014174
{'0': {'precision': 0.4363908153864873, 'recall': 0.10210194333679692, 'f1-score': 0.16548542049452497, 'support': 491783}, '1': {'precision': 0.3275723859900196, 'recall': 0.7195195614745172, 'f1-score': 0.4501891932020282, 'support': 486722}, '2': {'precision': 0.39387408883709063, 'recall': 0.23045558904584942, 'f1-score': 0.29077741574177784, 'support': 495666}, 'accuracy': 0.34910943167380176, 'macro avg': {'precision': 0.38594576340453246, 'recall': 0.3506923646190545, 'f1-score': 0.30215067647944366, 'support': 1474171}, 'weighted avg': {'precision': 0.3861670493684739, 'recall': 0.34910943167380176, 'f1-score': 0.30161248565587073, 'support': 1474171}}
[[ 50212 363454  78117]
 [ 38848 350206  97668]
 [ 26002 355435 114229]]
Evaluating performance on  val set...
2129/2129 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1108238
{'0': {'precision': 0.42228209191759114, 'recall': 0.07099466061323018, 'f1-score': 0.12155356458588035, 'support': 187662}, '1': {'precision': 0.3001388633117158, 'recall': 0.7304230913649632, 'f1-score': 0.42545400668839684, 'support': 165118}, '2': {'precision': 0.41226300927793463, 'recall': 0.23933305231605076, 'f1-score': 0.3028507082320867, 'support': 192159}, 'accuracy': 0.3301635595910735, 'macro avg': {'precision': 0.3782279881690805, 'recall': 0.34691693476474805, 'f1-score': 0.283286093168788, 'support': 544939}, 'weighted avg': {'precision': 0.3817393843450028, 'recall': 0.3301635595910735, 'f1-score': 0.27756609263946924, 'support': 544939}}
[[ 13323 143061  31278]
 [ 10225 120606  34287]
 [  8002 138167  45990]]
training model: results/universal/W5/deepOF_L1/h200
Epoch 1/50
9913/9913 - 145s - loss: 3.2535 - accuracy200: 0.3863 - val_loss: 3.2841 - val_accuracy200: 0.3774 - 145s/epoch - 15ms/step
Epoch 2/50
9913/9913 - 138s - loss: 3.2520 - accuracy200: 0.3866 - val_loss: 3.2884 - val_accuracy200: 0.3763 - 138s/epoch - 14ms/step
Epoch 3/50
9913/9913 - 136s - loss: 3.2492 - accuracy200: 0.3883 - val_loss: 3.2943 - val_accuracy200: 0.3737 - 136s/epoch - 14ms/step
Epoch 4/50
9913/9913 - 135s - loss: 3.2463 - accuracy200: 0.3903 - val_loss: 3.3119 - val_accuracy200: 0.3639 - 135s/epoch - 14ms/step
Epoch 5/50
9913/9913 - 132s - loss: 3.2439 - accuracy200: 0.3922 - val_loss: 3.3358 - val_accuracy200: 0.3482 - 132s/epoch - 13ms/step
Epoch 6/50
9913/9913 - 131s - loss: 3.2419 - accuracy200: 0.3933 - val_loss: 3.3683 - val_accuracy200: 0.3384 - 131s/epoch - 13ms/step
Epoch 7/50
9913/9913 - 132s - loss: 3.2394 - accuracy200: 0.3948 - val_loss: 3.3726 - val_accuracy200: 0.3364 - 132s/epoch - 13ms/step
Epoch 8/50
9913/9913 - 133s - loss: 3.2377 - accuracy200: 0.3956 - val_loss: 3.3837 - val_accuracy200: 0.3375 - 133s/epoch - 13ms/step
Epoch 9/50
9913/9913 - 131s - loss: 3.2357 - accuracy200: 0.3969 - val_loss: 3.3846 - val_accuracy200: 0.3363 - 131s/epoch - 13ms/step
Epoch 10/50
9913/9913 - 137s - loss: 3.2341 - accuracy200: 0.3980 - val_loss: 3.4070 - val_accuracy200: 0.3330 - 137s/epoch - 14ms/step
Epoch 11/50
9913/9913 - 134s - loss: 3.2325 - accuracy200: 0.3989 - val_loss: 3.4017 - val_accuracy200: 0.3348 - 134s/epoch - 14ms/step
testing model in sample: results/universal/W5/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 306s - 306s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970434
{'0': {'precision': 0.4106978458129966, 'recall': 0.49077091974872294, 'f1-score': 0.44717813246223614, 'support': 4798528}, '1': {'precision': 0.2525363039586234, 'recall': 0.06598010577529247, 'f1-score': 0.10462488925585275, 'support': 3116985}, '2': {'precision': 0.41739435409417286, 'recall': 0.5333025381826352, 'f1-score': 0.46828273084690336, 'support': 4922853}, 'accuracy': 0.4039460317613628, 'macro avg': {'precision': 0.3602095012885977, 'recall': 0.3633511879022169, 'f1-score': 0.34002858418833076, 'support': 12838366}, 'weighted avg': {'precision': 0.3748660874992486, 'recall': 0.4039460317613628, 'f1-score': 0.372103275949819, 'support': 12838366}}
[[2354978  309512 2134038]
 [1380831  205659 1530495]
 [1998280  299203 2625370]]
Evaluating performance on  train set...
9913/9913 - 61s - 61s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0917242
{'0': {'precision': 0.37433768612157825, 'recall': 0.49561185271098607, 'f1-score': 0.42652173689804423, 'support': 838053}, '1': {'precision': 0.3457703646957773, 'recall': 0.0698403655485925, 'f1-score': 0.11620839843102376, 'support': 853074}, '2': {'precision': 0.3730437768541247, 'recall': 0.5535294402759667, 'f1-score': 0.4457083567342199, 'support': 845899}, 'accuracy': 0.37175732530924005, 'macro avg': {'precision': 0.36438394255716017, 'recall': 0.37299388617851514, 'f1-score': 0.3294794973544293, 'support': 2537026}, 'weighted avg': {'precision': 0.3643005183064185, 'recall': 0.37175732530924005, 'f1-score': 0.328576229691333, 'support': 2537026}}
[[415349  58593 364111]
 [370675  59579 422820]
 [323533  54136 468230]]
Evaluating performance on  val set...
3496/3496 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942258
{'0': {'precision': 0.38192829369627135, 'recall': 0.48220561529115114, 'f1-score': 0.4262486773021439, 'support': 306164}, '1': {'precision': 0.3214908829667134, 'recall': 0.06726000042943336, 'f1-score': 0.11124593074874224, 'support': 279438}, '2': {'precision': 0.38079633842824895, 'recall': 0.5542698831877906, 'f1-score': 0.45144169929310485, 'support': 308615}, 'accuracy': 0.37740839192276593, 'macro avg': {'precision': 0.36140517169707786, 'recall': 0.36791183296945834, 'f1-score': 0.3296454357813303, 'support': 894217}, 'weighted avg': {'precision': 0.3626512641223682, 'recall': 0.37740839192276593, 'f1-score': 0.3365067097376165, 'support': 894217}}
[[147634  20693 137837]
 [120330  18795 140313]
 [118585  18974 171056]]
testing model out of sample: results/universal/W5/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 132s - 132s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972561
{'0': {'precision': 0.39964965116651613, 'recall': 0.4782832849300376, 'f1-score': 0.4354449870190154, 'support': 1929965}, '1': {'precision': 0.27804119928336557, 'recall': 0.07908443272307794, 'f1-score': 0.12314283013196035, 'support': 1465889}, '2': {'precision': 0.3985711082263101, 'recall': 0.5351463031851569, 'f1-score': 0.4568702532842186, 'support': 1952965}, 'accuracy': 0.3896413395181254, 'macro avg': {'precision': 0.3587539862253973, 'recall': 0.36417134027942416, 'f1-score': 0.3384860234783981, 'support': 5348819}, 'weighted avg': {'precision': 0.36592802990100703, 'recall': 0.3896413395181254, 'f1-score': 0.3576787546366174, 'support': 5348819}}
[[ 923070  154108  852787]
 [ 625697  115929  724263]
 [ 760931  146912 1045122]]
Evaluating performance on  train set...
4957/4957 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924383
{'0': {'precision': 0.3803392697711574, 'recall': 0.49367783465250376, 'f1-score': 0.42965993727949825, 'support': 426278}, '1': {'precision': 0.3351969646244839, 'recall': 0.0714520196013131, 'f1-score': 0.11779446655816782, 'support': 420380}, '2': {'precision': 0.37179577374709, 'recall': 0.551434493291153, 'f1-score': 0.44413841578598534, 'support': 421682}, 'accuracy': 0.372937067347872, 'macro avg': {'precision': 0.36244400271424376, 'recall': 0.37218811584832334, 'f1-score': 0.33053093987455046, 'support': 1268340}, 'weighted avg': {'precision': 0.36253681875015403, 'recall': 0.372937067347872, 'f1-score': 0.3311085292908986, 'support': 1268340}}
[[210444  30963 184871]
 [182320  30037 208023]
 [160542  28610 232530]]
Evaluating performance on  val set...
1701/1701 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937403
{'0': {'precision': 0.3830080099952882, 'recall': 0.4868669874491066, 'f1-score': 0.42873736236384535, 'support': 148595}, '1': {'precision': 0.3234274393263992, 'recall': 0.07046204976584587, 'f1-score': 0.11571448823362632, 'support': 139011}, '2': {'precision': 0.37683421647459886, 'recall': 0.5517075353984702, 'f1-score': 0.4478038309114928, 'support': 147464}, 'accuracy': 0.37579699818420026, 'macro avg': {'precision': 0.3610898885987621, 'recall': 0.36967885753780755, 'f1-score': 0.3307518938363215, 'support': 435070}, 'weighted avg': {'precision': 0.36187861243400415, 'recall': 0.37579699818420026, 'f1-score': 0.3351845891599803, 'support': 435070}}
[[72346 10661 65588]
 [60265  9795 68951]
 [56278  9829 81357]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021185
{'0': {'precision': 0.3604482609543347, 'recall': 0.4665818090044221, 'f1-score': 0.40670492587278817, 'support': 91133}, '1': {'precision': 0.29233892509883536, 'recall': 0.06779745016168799, 'f1-score': 0.11006849108409016, 'support': 80711}, '2': {'precision': 0.3689965089504568, 'recall': 0.49942194207356916, 'f1-score': 0.42441510288294365, 'support': 99471}, 'accuracy': 0.35999115419346517, 'macro avg': {'precision': 0.34059456500120894, 'recall': 0.34460040041322637, 'f1-score': 0.313729506613274, 'support': 271315}, 'weighted avg': {'precision': 0.3433210478263803, 'recall': 0.35999115419346517, 'f1-score': 0.3249542881607066, 'support': 271315}}
[[42521  6401 42211]
 [32498  5472 42741]
 [42948  6845 49678]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958326
{'0': {'precision': 0.3858296994895717, 'recall': 0.46886296418008544, 'f1-score': 0.4233129971999184, 'support': 24344}, '1': {'precision': 0.31245836109260494, 'recall': 0.0635702344914833, 'f1-score': 0.10564649346748761, 'support': 22133}, '2': {'precision': 0.35894553425889497, 'recall': 0.5507308869820189, 'f1-score': 0.4346213397308288, 'support': 23191}, 'accuracy': 0.36735660561520356, 'macro avg': {'precision': 0.3524111982803572, 'recall': 0.36105469521786254, 'f1-score': 0.3211936101327449, 'support': 69668}, 'weighted avg': {'precision': 0.3535710081448411, 'recall': 0.36735660561520356, 'f1-score': 0.3261570438859787, 'support': 69668}}
[[11414  1642 11288]
 [ 9204  1407 11522]
 [ 8965  1454 12772]]
Evaluating performance on  val set...
96/96 - 1s - 809ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930796
{'0': {'precision': 0.4057984438680993, 'recall': 0.4875361673714667, 'f1-score': 0.4429279142654939, 'support': 8986}, '1': {'precision': 0.27991675338189387, 'recall': 0.07660543927096683, 'f1-score': 0.12029066517607603, 'support': 7023}, '2': {'precision': 0.3933633200373419, 'recall': 0.5458078191238813, 'f1-score': 0.4572133168927251, 'support': 8492}, 'accuracy': 0.3899432676217297, 'macro avg': {'precision': 0.35969283909577837, 'recall': 0.36998314192210496, 'f1-score': 0.34014396544476505, 'support': 24501}, 'weighted avg': {'precision': 0.36540555444091627, 'recall': 0.3899432676217297, 'f1-score': 0.3553980272713086, 'support': 24501}}
[[4381  720 3885]
 [3222  538 3263]
 [3193  664 4635]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0862682
{'0': {'precision': 0.46653449185517376, 'recall': 0.5162018562014001, 'f1-score': 0.4901130830336478, 'support': 219265}, '1': {'precision': 0.23507116336633663, 'recall': 0.07354554548094608, 'f1-score': 0.11203824317349521, 'support': 123964}, '2': {'precision': 0.44855638226263367, 'recall': 0.5769868316263219, 'f1-score': 0.5047298296208238, 'support': 215972}, 'accuracy': 0.4415496395750365, 'macro avg': {'precision': 0.38338734582804807, 'recall': 0.38891141110288935, 'f1-score': 0.368960385275989, 'support': 559201}, 'weighted avg': {'precision': 0.4082801462125331, 'recall': 0.4415496395750365, 'f1-score': 0.4119464462527794, 'support': 559201}}
[[113185  16220  89860]
 [ 51511   9117  63336]
 [ 77912  13447 124613]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.07814
{'0': {'precision': 0.39885625965996907, 'recall': 0.5553379672469818, 'f1-score': 0.46426611735285916, 'support': 46469}, '1': {'precision': 0.40768739352640543, 'recall': 0.0695397915077549, 'f1-score': 0.11881341732088001, 'support': 55062}, '2': {'precision': 0.39454032742369255, 'recall': 0.6147602677027604, 'f1-score': 0.4806253329834523, 'support': 49159}, 'accuracy': 0.39721282102329286, 'macro avg': {'precision': 0.40036132687002235, 'recall': 0.41321267548583235, 'f1-score': 0.3545682892190638, 'support': 150690}, 'weighted avg': {'precision': 0.40067517916458517, 'recall': 0.3972128210232928, 'f1-score': 0.3433747915317927, 'support': 150690}}
[[25806  3023 17640]
 [22496  3829 28737]
 [16398  2540 30221]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0833328
{'0': {'precision': 0.42190305206463197, 'recall': 0.5514180779432769, 'f1-score': 0.47804360323707606, 'support': 19604}, '1': {'precision': 0.3137755102040816, 'recall': 0.059431056350788186, 'f1-score': 0.09993398669578023, 'support': 16557}, '2': {'precision': 0.4304768734313374, 'recall': 0.5860301654707863, 'f1-score': 0.4963515720280298, 'support': 20487}, 'accuracy': 0.4201383985312809, 'macro avg': {'precision': 0.3887184785666837, 'recall': 0.3989597665882838, 'f1-score': 0.3581097206536287, 'support': 56648}, 'weighted avg': {'precision': 0.3934004424006467, 'recall': 0.4201383985312809, 'f1-score': 0.3741513993736746, 'support': 56648}}
[[10810  1179  7615]
 [ 7304   984  8269]
 [ 7508   973 12006]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968584
{'0': {'precision': 0.4042799420963047, 'recall': 0.4677648682848269, 'f1-score': 0.4337115515479642, 'support': 217325}, '1': {'precision': 0.2542004241204937, 'recall': 0.09199556584652319, 'f1-score': 0.13509868706231395, 'support': 152453}, '2': {'precision': 0.4228284008706557, 'recall': 0.5391808278867103, 'f1-score': 0.4739683579334027, 'support': 229500}, 'accuracy': 0.3995207566438281, 'macro avg': {'precision': 0.36043625569581805, 'recall': 0.3663137540060201, 'f1-score': 0.3475928655145603, 'support': 599278}, 'weighted avg': {'precision': 0.3732038781239033, 'recall': 0.3995207566438281, 'f1-score': 0.3731628747002029, 'support': 599278}}
[[101657  20794  94874]
 [ 64391  14025  74037]
 [ 85404  20354 123742]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978839
{'0': {'precision': 0.3646842350154393, 'recall': 0.4172332857453965, 'f1-score': 0.3891929713685969, 'support': 41327}, '1': {'precision': 0.3110613810741688, 'recall': 0.07166883547349555, 'f1-score': 0.11649671741863388, 'support': 40729}, '2': {'precision': 0.36053332535240773, 'recall': 0.5814509122502172, 'f1-score': 0.44508691877112927, 'support': 41436}, 'accuracy': 0.35836329478832635, 'macro avg': {'precision': 0.34542631381400524, 'recall': 0.35678434448970303, 'f1-score': 0.31692553585278666, 'support': 123492}, 'weighted avg': {'precision': 0.34560605739282907, 'recall': 0.35836329478832635, 'f1-score': 0.31800921758246736, 'support': 123492}}
[[17243  3433 20651]
 [15728  2919 22082]
 [14311  3032 24093]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005393
{'0': {'precision': 0.3905043314753878, 'recall': 0.38395510069329813, 'f1-score': 0.3872020242375816, 'support': 15145}, '1': {'precision': 0.26551070170685453, 'recall': 0.08650366316532793, 'f1-score': 0.13049267643142476, 'support': 11329}, '2': {'precision': 0.3847676003693769, 'recall': 0.5892652703885783, 'f1-score': 0.4655493482309125, 'support': 14849}, 'accuracy': 0.37618275536626095, 'macro avg': {'precision': 0.3469275445172064, 'recall': 0.3532413447490681, 'f1-score': 0.3277480162999729, 'support': 41323}, 'weighted avg': {'precision': 0.3541749857879772, 'recall': 0.37618275536626095, 'f1-score': 0.34497661012633646, 'support': 41323}}
[[5815 1470 7860]
 [4218  980 6131]
 [4858 1241 8750]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
2027/2027 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0999768
{'0': {'precision': 0.34860330493495806, 'recall': 0.4505910937046707, 'f1-score': 0.39308970309871927, 'support': 165456}, '1': {'precision': 0.376509073915414, 'recall': 0.09945836955347637, 'f1-score': 0.1573510084673006, 'support': 194413}, '2': {'precision': 0.31573718529966016, 'recall': 0.5036886096488745, 'f1-score': 0.3881577193649932, 'support': 159003}, 'accuracy': 0.335298493655468, 'macro avg': {'precision': 0.3469498547166774, 'recall': 0.35124602430234053, 'f1-score': 0.31286614364367105, 'support': 518872}, 'weighted avg': {'precision': 0.34898766301253037, 'recall': 0.335298493655468, 'f1-score': 0.30325084679313397, 'support': 518872}}
[[74553 16720 74183]
 [75694 19336 99383]
 [63615 15300 80088]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950791
{'0': {'precision': 0.3703141735094609, 'recall': 0.4473958520542037, 'f1-score': 0.40522194911529635, 'support': 27821}, '1': {'precision': 0.3250125439036628, 'recall': 0.09294067006241481, 'f1-score': 0.14454672245467226, 'support': 27878}, '2': {'precision': 0.3726614011789101, 'recall': 0.5552662639727834, 'f1-score': 0.44599662609617025, 'support': 28806}, 'accuracy': 0.36723270812377967, 'macro avg': {'precision': 0.3559960395306779, 'recall': 0.3652009286964673, 'f1-score': 0.33192176588871297, 'support': 84505}, 'weighted avg': {'precision': 0.35616939403008946, 'recall': 0.36723270812377967, 'f1-score': 0.33312504805933724, 'support': 84505}}
[[12447  2752 12622]
 [10983  2591 14304]
 [10182  2629 15995]]
Evaluating performance on  val set...
136/136 - 1s - 951ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0966456
{'0': {'precision': 0.3850972204097612, 'recall': 0.4899958488999585, 'f1-score': 0.4312593620985715, 'support': 12045}, '1': {'precision': 0.30330999363462763, 'recall': 0.0877289883089386, 'f1-score': 0.1360942520528383, 'support': 10863}, '2': {'precision': 0.3688489252940814, 'recall': 0.5076714418920064, 'f1-score': 0.42726689020475134, 'support': 11797}, 'accuracy': 0.37009076501944965, 'macro avg': {'precision': 0.3524187131128234, 'recall': 0.3617987597003012, 'f1-score': 0.3315401681187204, 'support': 34705}, 'weighted avg': {'precision': 0.3539738727094889, 'recall': 0.37009076501944965, 'f1-score': 0.33751270365286634, 'support': 34705}}
[[5902 1137 5006]
 [4668  953 5242]
 [4756 1052 5989]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
2900/2900 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038836
{'0': {'precision': 0.37387593555418724, 'recall': 0.43116280482710956, 'f1-score': 0.40048109226284423, 'support': 263346}, '1': {'precision': 0.29050957659316123, 'recall': 0.10132928945175348, 'f1-score': 0.15025119520298194, 'support': 219591}, '2': {'precision': 0.3672758608308499, 'recall': 0.5126013815647454, 'f1-score': 0.42793722716294513, 'support': 259416}, 'accuracy': 0.3620555180621618, 'macro avg': {'precision': 0.34388712432606616, 'recall': 0.3483644919478695, 'f1-score': 0.32622317154292374, 'support': 742353}, 'weighted avg': {'precision': 0.3469094288989438, 'recall': 0.3620555180621618, 'f1-score': 0.33605665721101896, 'support': 742353}}
[[113545  28146 121655]
 [ 89909  22251 107431]
 [100243  26196 132977]]
Evaluating performance on  train set...
694/694 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968574
{'0': {'precision': 0.3724259097842667, 'recall': 0.45676249018658027, 'f1-score': 0.4103052719238358, 'support': 59867}, '1': {'precision': 0.32055676015947404, 'recall': 0.07812286922132824, 'f1-score': 0.12562876057071587, 'support': 58664}, '2': {'precision': 0.3577953071283141, 'recall': 0.5444126559563914, 'f1-score': 0.43180353402438365, 'support': 59071}, 'accuracy': 0.36084616164232386, 'macro avg': {'precision': 0.35025932569068496, 'recall': 0.3597660051214333, 'f1-score': 0.3225791888396451, 'support': 177602}, 'weighted avg': {'precision': 0.3504267424152133, 'recall': 0.36084616164232386, 'f1-score': 0.32342371078444565, 'support': 177602}}
[[27345  5046 27476]
 [23835  4583 30246]
 [22244  4668 32159]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972247
{'0': {'precision': 0.35340133445816396, 'recall': 0.46428211586901763, 'f1-score': 0.40132381118272076, 'support': 19850}, '1': {'precision': 0.3484153876818816, 'recall': 0.0830956455599924, 'f1-score': 0.13418800138179865, 'support': 21036}, '2': {'precision': 0.35748354158269513, 'recall': 0.532656023222061, 'f1-score': 0.427833497477539, 'support': 19981}, 'accuracy': 0.3549871030279133, 'macro avg': {'precision': 0.35310008790758024, 'recall': 0.360011261550357, 'f1-score': 0.32111510334735277, 'support': 60867}, 'weighted avg': {'precision': 0.3530182402391188, 'recall': 0.3549871030279133, 'f1-score': 0.3177024916973603, 'support': 60867}}
[[ 9216  1661  8973]
 [ 9132  1748 10156]
 [ 7730  1608 10643]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/EXC
Evaluating performance on  test set...
7167/7167 - 48s - 48s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093196
{'0': {'precision': 0.4046763491514275, 'recall': 0.5075304761174576, 'f1-score': 0.45030485295428124, 'support': 652150}, '1': {'precision': 0.28108264582428716, 'recall': 0.0741690704242339, 'f1-score': 0.11736826368257322, 'support': 497485}, '2': {'precision': 0.42168440645499394, 'recall': 0.5451001633741209, 'f1-score': 0.47551490998985557, 'support': 684931}, 'accuracy': 0.40404106475318957, 'macro avg': {'precision': 0.3691478004769029, 'recall': 0.3755999033052708, 'f1-score': 0.34772934220890334, 'support': 1834566}, 'weighted avg': {'precision': 0.3775109771764136, 'recall': 0.40404106475318957, 'f1-score': 0.3694335136084072, 'support': 1834566}}
[[330986  48752 272412]
 [220963  36898 239624]
 [265954  45621 373356]]
Evaluating performance on  train set...
1570/1570 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0875615
{'0': {'precision': 0.39321470803536235, 'recall': 0.516383077844577, 'f1-score': 0.44645979649703826, 'support': 135231}, '1': {'precision': 0.34672575086164453, 'recall': 0.07767197323431009, 'f1-score': 0.1269133725820017, 'support': 135995}, '2': {'precision': 0.37831278015327097, 'recall': 0.561480152981843, 'f1-score': 0.45204663747967555, 'support': 130473}, 'accuracy': 0.3825053087012913, 'macro avg': {'precision': 0.37275107968342597, 'recall': 0.38517840135357667, 'f1-score': 0.34180660218623854, 'support': 401699}, 'weighted avg': {'precision': 0.3726357049325419, 'recall': 0.3825053087012913, 'f1-score': 0.34009213310530023, 'support': 401699}}
[[69831 10437 54963]
 [60009 10563 65423]
 [47750  9465 73258]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905957
{'0': {'precision': 0.41093354836344975, 'recall': 0.49764747658573394, 'f1-score': 0.4501525736770256, 'support': 45058}, '1': {'precision': 0.31158375390531123, 'recall': 0.06816150570422165, 'f1-score': 0.11185402467431628, 'support': 38042}, '2': {'precision': 0.3867519328051923, 'recall': 0.5700351699882766, 'f1-score': 0.4608385776025476, 'support': 42650}, 'accuracy': 0.3922703777335984, 'macro avg': {'precision': 0.36975641169131773, 'recall': 0.37861471742607744, 'f1-score': 0.34094839198462984, 'support': 125750}, 'weighted avg': {'precision': 0.37267660375640255, 'recall': 0.3922703777335984, 'f1-score': 0.3514345193331882, 'support': 125750}}
[[22423  3127 19508]
 [16407  2593 19042]
 [15736  2602 24312]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/AAL
Evaluating performance on  test set...
6357/6357 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953826
{'0': {'precision': 0.4147530180342628, 'recall': 0.5265898048258256, 'f1-score': 0.46402799386944715, 'support': 607150}, '1': {'precision': 0.2656768576002499, 'recall': 0.06491366151497806, 'f1-score': 0.10433485904424561, 'support': 419280}, '2': {'precision': 0.41241407487391457, 'recall': 0.5175335506230712, 'f1-score': 0.4590325619302696, 'support': 600734}, 'accuracy': 0.404283772256515, 'macro avg': {'precision': 0.36428131683614245, 'recall': 0.3696790056546249, 'f1-score': 0.3424651382813208, 'support': 1627164}, 'weighted avg': {'precision': 0.3754762547656178, 'recall': 0.404283772256515, 'f1-score': 0.3694996836437659, 'support': 1627164}}
[[319719  38621 248810]
 [197919  27217 194144]
 [253228  36606 310900]]
Evaluating performance on  train set...
1701/1701 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905687
{'0': {'precision': 0.37959002384929563, 'recall': 0.5413522445607271, 'f1-score': 0.446264480353261, 'support': 145240}, '1': {'precision': 0.3413012284324362, 'recall': 0.06654111738857502, 'f1-score': 0.11136933346276175, 'support': 146556}, '2': {'precision': 0.3788774779556459, 'recall': 0.5268412917241091, 'f1-score': 0.4407732434691684, 'support': 143622}, 'accuracy': 0.3767506166488294, 'macro avg': {'precision': 0.36658957674579257, 'recall': 0.37824488455780375, 'f1-score': 0.332802352428397, 'support': 435418}, 'weighted avg': {'precision': 0.36646748420359654, 'recall': 0.3767506166488294, 'f1-score': 0.33173188048037755, 'support': 435418}}
[[78626  9557 57057]
 [69816  9752 66988]
 [58692  9264 75666]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926788
{'0': {'precision': 0.39258641600970284, 'recall': 0.5188546926344474, 'f1-score': 0.44697414299029925, 'support': 49908}, '1': {'precision': 0.3227687089251643, 'recall': 0.06670463756051612, 'f1-score': 0.11056042699199391, 'support': 45649}, '2': {'precision': 0.37784541893013707, 'recall': 0.5349278350515464, 'f1-score': 0.44287018939426265, 'support': 48500}, 'accuracy': 0.3809880811067841, 'macro avg': {'precision': 0.3644001812883347, 'recall': 0.37349572174883666, 'f1-score': 0.3334682531255186, 'support': 144057}, 'weighted avg': {'precision': 0.36549959017644906, 'recall': 0.3809880811067841, 'f1-score': 0.3389891684939928, 'support': 144057}}
[[25895  3372 20641]
 [20526  3045 22078]
 [19539  3017 25944]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/WBA
Evaluating performance on  test set...
7458/7458 - 51s - 51s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029992
{'0': {'precision': 0.4181448025859672, 'recall': 0.4420361374628224, 'f1-score': 0.4297586817600758, 'support': 751796}, '1': {'precision': 0.21363515645748388, 'recall': 0.06879343607492573, 'f1-score': 0.10407371539358701, 'support': 397567}, '2': {'precision': 0.42107690732539055, 'recall': 0.546638100865528, 'f1-score': 0.4757117105561524, 'support': 759883}, 'accuracy': 0.405946640715759, 'macro avg': {'precision': 0.3509522887896139, 'recall': 0.35248922480109207, 'f1-score': 0.33651470256993843, 'support': 1909246}, 'weighted avg': {'precision': 0.3767262373844921, 'recall': 0.405946640715759, 'f1-score': 0.3802298784299775, 'support': 1909246}}
[[332321  51428 368047]
 [167172  27350 203045]
 [295258  49244 415381]]
Evaluating performance on  train set...
1664/1664 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.089666
{'0': {'precision': 0.3784627260696956, 'recall': 0.4878496037527986, 'f1-score': 0.42625017465960785, 'support': 140695}, '1': {'precision': 0.3576214996120477, 'recall': 0.06890553011049348, 'f1-score': 0.11554765486120608, 'support': 147158}, '2': {'precision': 0.36814383552141766, 'recall': 0.5764329365424161, 'f1-score': 0.4493234186056356, 'support': 138108}, 'accuracy': 0.3718368583039292, 'macro avg': {'precision': 0.36807602040105364, 'recall': 0.3777293568019027, 'f1-score': 0.3303737493754832, 'support': 425961}, 'weighted avg': {'precision': 0.3679169847015983, 'recall': 0.3718368583039292, 'f1-score': 0.32639182651600973, 'support': 425961}}
[[68638  9676 62381]
 [62762 10140 74256]
 [49960  8538 79610]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094182
{'0': {'precision': 0.376954966816718, 'recall': 0.4719957224969924, 'f1-score': 0.4191553977188418, 'support': 44886}, '1': {'precision': 0.3277892436566711, 'recall': 0.06442837712076742, 'f1-score': 0.10768985322271857, 'support': 41907}, '2': {'precision': 0.380261312467705, 'recall': 0.5675598254814684, 'f1-score': 0.45540458109744775, 'support': 45382}, 'accuracy': 0.3755853981463968, 'macro avg': {'precision': 0.3616685076470314, 'recall': 0.3679946416997428, 'f1-score': 0.3274166106796694, 'support': 132175}, 'weighted avg': {'precision': 0.36250186008598234, 'recall': 0.3755853981463968, 'f1-score': 0.33284916633536427, 'support': 132175}}
[[21186  2914 20786]
 [18015  2700 21192]
 [17002  2623 25757]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
8238/8238 - 55s - 55s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959021
{'0': {'precision': 0.3993434930648806, 'recall': 0.46054052470602963, 'f1-score': 0.42776434503527905, 'support': 751011}, '1': {'precision': 0.2880390362915523, 'recall': 0.07952122912365665, 'f1-score': 0.1246338103256251, 'support': 593854}, '2': {'precision': 0.3968479409637884, 'recall': 0.5604076224988348, 'f1-score': 0.4646546221880658, 'support': 763844}, 'accuracy': 0.38941314330237126, 'macro avg': {'precision': 0.3614101567734071, 'recall': 0.3668231254428404, 'f1-score': 0.3390175925163233, 'support': 2108709}, 'weighted avg': {'precision': 0.3670939937874674, 'recall': 0.38941314330237126, 'f1-score': 0.3557596901976634, 'support': 2108709}}
[[345871  60034 345106]
 [241140  47224 305490]
 [279088  56692 428064]]
Evaluating performance on  train set...
1806/1806 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905153
{'0': {'precision': 0.3872852688851303, 'recall': 0.4888810289389067, 'f1-score': 0.43219288670578065, 'support': 155500}, '1': {'precision': 0.34179435111685436, 'recall': 0.07294252058464326, 'f1-score': 0.12022727272727272, 'support': 152298}, '2': {'precision': 0.37752286108516236, 'recall': 0.5707427993936331, 'f1-score': 0.45444744769529155, 'support': 154362}, 'accuracy': 0.3791565691535399, 'macro avg': {'precision': 0.3688674936957157, 'recall': 0.3775221163057277, 'f1-score': 0.3356225357094483, 'support': 462160}, 'weighted avg': {'precision': 0.3690337529878403, 'recall': 0.3791565691535399, 'f1-score': 0.3368222779680363, 'support': 462160}}
[[76021 11360 68119]
 [64043 11109 77146]
 [56228 10033 88101]]
Evaluating performance on  val set...
642/642 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916691
{'0': {'precision': 0.3793447694038245, 'recall': 0.49316345556246116, 'f1-score': 0.428830289447332, 'support': 54706}, '1': {'precision': 0.33788266515022275, 'recall': 0.06605032052469707, 'f1-score': 0.11049980627663696, 'support': 53974}, '2': {'precision': 0.3795114396680016, 'recall': 0.5637288379281837, 'f1-score': 0.45363105869422166, 'support': 55642}, 'accuracy': 0.3767663489976996, 'macro avg': {'precision': 0.3655796247406829, 'recall': 0.37431420467178067, 'f1-score': 0.3309870514727302, 'support': 164322}, 'weighted avg': {'precision': 0.3657823629814066, 'recall': 0.3767663489976996, 'f1-score': 0.332667845610112, 'support': 164322}}
[[26979  3611 24116]
 [23241  3565 27168]
 [20900  3375 31367]]
testing model on single stock: results/universal/W5/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
31315/31315 - 210s - 210s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970815
{'0': {'precision': 0.41022710156538217, 'recall': 0.4994905080334275, 'f1-score': 0.4504794481450946, 'support': 3009861}, '1': {'precision': 0.24263663450471673, 'recall': 0.059250161277104536, 'f1-score': 0.09524271963539804, 'support': 1903556}, '2': {'precision': 0.4198511186682083, 'recall': 0.5258995624969385, 'f1-score': 0.4669296549687707, 'support': 3103064}, 'accuracy': 0.40517566248831627, 'macro avg': {'precision': 0.3575716182461024, 'recall': 0.3615467439358235, 'f1-score': 0.3375506075830878, 'support': 8016481}, 'weighted avg': {'precision': 0.3741571728636279, 'recall': 0.40517566248831627, 'f1-score': 0.3724942372541937, 'support': 8016481}}
[[1503397  176627 1329837]
 [ 865653  112786  925117]
 [1295742  175422 1631900]]
Evaluating performance on  train set...
5759/5759 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947534
{'0': {'precision': 0.3656910604073031, 'recall': 0.4880113644516509, 'f1-score': 0.4180880554172583, 'support': 487837}, '1': {'precision': 0.339983494945327, 'recall': 0.06767820510451127, 'f1-score': 0.11288513343414606, 'support': 486981}, '2': {'precision': 0.3702212974909703, 'recall': 0.5384187138156775, 'f1-score': 0.4387525804319623, 'support': 499353}, 'accuracy': 0.36623227563152444, 'macro avg': {'precision': 0.35863195094786676, 'recall': 0.36470276112394656, 'f1-score': 0.32324192309445554, 'support': 1474171}, 'weighted avg': {'precision': 0.35873331367520883, 'recall': 0.36623227563152444, 'f1-score': 0.3242664217054362, 'support': 1474171}}
[[238070  32623 217144]
 [213811  32958 240212]
 [199133  31359 268861]]
Evaluating performance on  val set...
2129/2129 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961246
{'0': {'precision': 0.3709955160008866, 'recall': 0.4715800423685194, 'f1-score': 0.4152840167659471, 'support': 184571}, '1': {'precision': 0.3227766214771896, 'recall': 0.06669417501118738, 'f1-score': 0.11054651941258917, 'support': 172069}, '2': {'precision': 0.37452733711099706, 'recall': 0.5465244106447724, 'f1-score': 0.4444665192453873, 'support': 188299}, 'accuracy': 0.36963036229743146, 'macro avg': {'precision': 0.35609982486302444, 'recall': 0.3615995426748264, 'f1-score': 0.3234323518079745, 'support': 544939}, 'weighted avg': {'precision': 0.35699039142990646, 'recall': 0.36963036229743146, 'f1-score': 0.32914439306913185, 'support': 544939}}
[[ 87040  12358  85173]
 [ 73903  11476  86690]
 [ 73669  11720 102910]]
training model: results/universal/W5/deepLOB_L2/h50
Epoch 1/50
9913/9913 - 429s - loss: 3.0539 - accuracy50: 0.4597 - val_loss: 3.7300 - val_accuracy50: 0.3641 - 429s/epoch - 43ms/step
Epoch 2/50
9913/9913 - 410s - loss: 3.0022 - accuracy50: 0.4772 - val_loss: 3.5071 - val_accuracy50: 0.4041 - 410s/epoch - 41ms/step
Epoch 3/50
9913/9913 - 404s - loss: 2.9481 - accuracy50: 0.4940 - val_loss: 3.4303 - val_accuracy50: 0.4081 - 404s/epoch - 41ms/step
Epoch 4/50
9913/9913 - 408s - loss: 2.9105 - accuracy50: 0.5041 - val_loss: 3.3927 - val_accuracy50: 0.4140 - 408s/epoch - 41ms/step
Epoch 5/50
9913/9913 - 406s - loss: 2.8911 - accuracy50: 0.5093 - val_loss: 3.3589 - val_accuracy50: 0.4208 - 406s/epoch - 41ms/step
Epoch 6/50
9913/9913 - 407s - loss: 2.8785 - accuracy50: 0.5128 - val_loss: 3.3558 - val_accuracy50: 0.4246 - 407s/epoch - 41ms/step
Epoch 7/50
9913/9913 - 406s - loss: 2.8685 - accuracy50: 0.5158 - val_loss: 3.3214 - val_accuracy50: 0.4306 - 406s/epoch - 41ms/step
Epoch 8/50
9913/9913 - 406s - loss: 2.8615 - accuracy50: 0.5175 - val_loss: 3.2880 - val_accuracy50: 0.4374 - 406s/epoch - 41ms/step
Epoch 9/50
9913/9913 - 404s - loss: 2.8553 - accuracy50: 0.5191 - val_loss: 3.2849 - val_accuracy50: 0.4359 - 404s/epoch - 41ms/step
Epoch 10/50
9913/9913 - 405s - loss: 2.8503 - accuracy50: 0.5202 - val_loss: 3.2650 - val_accuracy50: 0.4441 - 405s/epoch - 41ms/step
Epoch 11/50
9913/9913 - 407s - loss: 2.8459 - accuracy50: 0.5215 - val_loss: 3.2484 - val_accuracy50: 0.4487 - 407s/epoch - 41ms/step
Epoch 12/50
9913/9913 - 404s - loss: 2.8422 - accuracy50: 0.5223 - val_loss: 3.2847 - val_accuracy50: 0.4414 - 404s/epoch - 41ms/step
Epoch 13/50
9913/9913 - 403s - loss: 2.8390 - accuracy50: 0.5232 - val_loss: 3.2706 - val_accuracy50: 0.4438 - 403s/epoch - 41ms/step
Epoch 14/50
9913/9913 - 403s - loss: 2.8358 - accuracy50: 0.5238 - val_loss: 3.2740 - val_accuracy50: 0.4467 - 403s/epoch - 41ms/step
Epoch 15/50
9913/9913 - 403s - loss: 2.8327 - accuracy50: 0.5248 - val_loss: 3.2705 - val_accuracy50: 0.4469 - 403s/epoch - 41ms/step
Epoch 16/50
9913/9913 - 404s - loss: 2.8306 - accuracy50: 0.5254 - val_loss: 3.2710 - val_accuracy50: 0.4488 - 404s/epoch - 41ms/step
Epoch 17/50
9913/9913 - 404s - loss: 2.8278 - accuracy50: 0.5263 - val_loss: 3.2830 - val_accuracy50: 0.4449 - 404s/epoch - 41ms/step
Epoch 18/50
9913/9913 - 402s - loss: 2.8254 - accuracy50: 0.5268 - val_loss: 3.2685 - val_accuracy50: 0.4486 - 402s/epoch - 41ms/step
Epoch 19/50
9913/9913 - 404s - loss: 2.8234 - accuracy50: 0.5273 - val_loss: 3.2820 - val_accuracy50: 0.4462 - 404s/epoch - 41ms/step
Epoch 20/50
9913/9913 - 401s - loss: 2.8217 - accuracy50: 0.5279 - val_loss: 3.2680 - val_accuracy50: 0.4496 - 401s/epoch - 40ms/step
Epoch 21/50
9913/9913 - 403s - loss: 2.8197 - accuracy50: 0.5284 - val_loss: 3.2985 - val_accuracy50: 0.4444 - 403s/epoch - 41ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 694s - 694s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2225413
{'0': {'precision': 0.524428620944931, 'recall': 0.1329108927040712, 'f1-score': 0.21207389704120078, 'support': 4610352}, '1': {'precision': 0.29042580288796555, 'recall': 0.7125812556570394, 'f1-score': 0.4126630645996084, 'support': 3512217}, '2': {'precision': 0.46158787941926205, 'recall': 0.2987769682570716, 'f1-score': 0.36275171746446416, 'support': 4715822}, 'accuracy': 0.35241838326936764, 'macro avg': {'precision': 0.4254807677507195, 'recall': 0.3814230388727274, 'f1-score': 0.3291628930350911, 'support': 12838391}, 'weighted avg': {'precision': 0.43732935538971895, 'recall': 0.35241838326936764, 'f1-score': 0.3222966239217392, 'support': 12838391}}
[[ 612766 3114133  883453]
 [ 249448 2502740  760029]
 [ 306231 3000612 1408979]]
Evaluating performance on  train set...
9913/9913 - 142s - 142s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0601603
{'0': {'precision': 0.48645625554739025, 'recall': 0.3274827650456493, 'f1-score': 0.3914446552134612, 'support': 778215}, '1': {'precision': 0.4738123918509383, 'recall': 0.6065747321977683, 'f1-score': 0.5320363752983973, 'support': 980481}, '2': {'precision': 0.4383976799845895, 'recall': 0.42690120089370026, 'f1-score': 0.4325730685436022, 'support': 778337}, 'accuracy': 0.4658433690062368, 'macro avg': {'precision': 0.46622210912763934, 'recall': 0.45365289937903924, 'f1-score': 0.4520180330184869, 'support': 2537033}, 'weighted avg': {'precision': 0.46682590952950853, 'recall': 0.4658433690062368, 'f1-score': 0.4583965932240193, 'support': 2537033}}
[[254852 347256 176107]
 [136200 594735 249546]
 [132843 313221 332273]]
Evaluating performance on  val set...
3496/3496 - 50s - 50s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0680459
{'0': {'precision': 0.4821453146244929, 'recall': 0.30212519359923834, 'f1-score': 0.3714744976291659, 'support': 289903}, '1': {'precision': 0.4385311335816924, 'recall': 0.5929238221896703, 'f1-score': 0.5041723914700202, 'support': 311298}, '2': {'precision': 0.4423270772332357, 'recall': 0.4402801193100765, 'f1-score': 0.4413012246014914, 'support': 293018}, 'accuracy': 0.44862947443523343, 'macro avg': {'precision': 0.454334508479807, 'recall': 0.4451097116996617, 'f1-score': 0.43898270456689253, 'support': 894219}, 'weighted avg': {'precision': 0.4539145706857339, 'recall': 0.44862947443523343, 'f1-score': 0.4405505034407704, 'support': 894219}}
[[ 87587 120049  82267]
 [ 46337 184576  80385]
 [ 47737 116271 129010]]
testing model out of sample: results/universal/W5/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 291s - 291s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1611173
{'0': {'precision': 0.5170240794027429, 'recall': 0.19953924289229802, 'f1-score': 0.28794829473181555, 'support': 1909900}, '1': {'precision': 0.35825999108210876, 'recall': 0.7059345701370963, 'f1-score': 0.4753042761506349, 'support': 1542201}, '2': {'precision': 0.4704197199324054, 'recall': 0.3901034562932353, 'f1-score': 0.4265134600070497, 'support': 1896743}, 'accuracy': 0.413120853777003, 'macro avg': {'precision': 0.4485679301390857, 'recall': 0.43185908977420984, 'f1-score': 0.39658867696316674, 'support': 5348844}, 'weighted avg': {'precision': 0.45472227580424257, 'recall': 0.413120853777003, 'f1-score': 0.39110387174616257, 'support': 5348844}}
[[ 381100 1022873  505927]
 [ 126455 1088693  327053]
 [ 229548  927269  739926]]
Evaluating performance on  train set...
4957/4957 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.064608
{'0': {'precision': 0.5094559050949758, 'recall': 0.30296645356720564, 'f1-score': 0.37996996800940125, 'support': 403411}, '1': {'precision': 0.465962173992395, 'recall': 0.6682681595666667, 'f1-score': 0.5490731031050601, 'support': 462277}, '2': {'precision': 0.466726682683099, 'recall': 0.4236097313836128, 'f1-score': 0.44412417948377453, 'support': 402656}, 'accuracy': 0.47440915082974333, 'macro avg': {'precision': 0.4807149205901566, 'recall': 0.4649481148391617, 'f1-score': 0.45772241686607856, 'support': 1268344}, 'weighted avg': {'precision': 0.4800385472548438, 'recall': 0.47440915082974333, 'f1-score': 0.4619702519686751, 'support': 1268344}}
[[122220 185307  95884]
 [ 54347 308925  99005]
 [ 63336 168751 170569]]
Evaluating performance on  val set...
1701/1701 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0691019
{'0': {'precision': 0.5162944024087942, 'recall': 0.2830320235071468, 'f1-score': 0.36562747008327057, 'support': 140553}, '1': {'precision': 0.4506108145948068, 'recall': 0.7205650170825137, 'f1-score': 0.5544759045293061, 'support': 154544}, '2': {'precision': 0.47390253580059877, 'recall': 0.3754384711555635, 'f1-score': 0.4189630361904914, 'support': 139975}, 'accuracy': 0.46817997940570755, 'macro avg': {'precision': 0.48026925093473327, 'recall': 0.45967850391507464, 'f1-score': 0.44635547026768935, 'support': 435072}, 'weighted avg': {'precision': 0.4793239563134192, 'recall': 0.46817997940570755, 'f1-score': 0.4498687871960389, 'support': 435072}}
[[ 39781  70047  30725]
 [ 15570 111359  27615]
 [ 21700  65723  52552]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2022687
{'0': {'precision': 0.4307400379506641, 'recall': 0.36360330968337884, 'f1-score': 0.39433452518610485, 'support': 101762}, '1': {'precision': 0.2923362038352273, 'recall': 0.37473327832939773, 'f1-score': 0.32844585749018146, 'support': 70298}, '2': {'precision': 0.41640173334592423, 'recall': 0.3998186580697159, 'f1-score': 0.40794173729358013, 'support': 99260}, 'accuracy': 0.3797361049683031, 'macro avg': {'precision': 0.3798259917106052, 'recall': 0.3793850820274975, 'f1-score': 0.37690737332328883, 'support': 271320}, 'weighted avg': {'precision': 0.3896345800201266, 'recall': 0.3797361049683031, 'f1-score': 0.38224109422672103, 'support': 271320}}
[[37001 32363 32398]
 [20732 26343 23223]
 [28168 31406 39686]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1856017
{'0': {'precision': 0.4430724532413292, 'recall': 0.20842231143760143, 'f1-score': 0.28349018240966656, 'support': 23414}, '1': {'precision': 0.3833589418130804, 'recall': 0.4996517196343056, 'f1-score': 0.43384743328041125, 'support': 22970}, '2': {'precision': 0.4041856739910158, 'recall': 0.4984754133562379, 'f1-score': 0.4464059074650975, 'support': 23285}, 'accuracy': 0.4013836857138756, 'macro avg': {'precision': 0.4102056896818085, 'recall': 0.40218314814271494, 'f1-score': 0.3879145077183918, 'support': 69669}, 'weighted avg': {'precision': 0.41038793053610273, 'recall': 0.4013836857138756, 'f1-score': 0.3875134741235811, 'support': 69669}}
[[ 4880  9708  8826]
 [ 3209 11477  8284]
 [ 2925  8753 11607]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2396382
{'0': {'precision': 0.45451633568225497, 'recall': 0.17047092743873138, 'f1-score': 0.24794688100646517, 'support': 8324}, '1': {'precision': 0.3577688651218063, 'recall': 0.6030295443164747, 'f1-score': 0.44909565541674434, 'support': 7988}, '2': {'precision': 0.4121288692356286, 'recall': 0.3983392355598974, 'f1-score': 0.405116741182315, 'support': 8189}, 'accuracy': 0.3876576466266683, 'macro avg': {'precision': 0.4081380233465633, 'recall': 0.39061323577170115, 'f1-score': 0.3673864258685082, 'support': 24501}, 'weighted avg': {'precision': 0.40880678270203835, 'recall': 0.3876576466266683, 'f1-score': 0.36605799463322913, 'support': 24501}}
[[1419 4476 2429]
 [ 947 4817 2224]
 [ 756 4171 3262]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9856116
{'0': {'precision': 0.5287169410755019, 'recall': 0.32756377069136805, 'f1-score': 0.4045134089024053, 'support': 142934}, '1': {'precision': 0.6436086608523998, 'recall': 0.568901303538175, 'f1-score': 0.6039534797743648, 'support': 272796}, '2': {'precision': 0.3979330867328044, 'recall': 0.6365803339931417, 'f1-score': 0.48973048040600864, 'support': 143476}, 'accuracy': 0.5245794930669556, 'macro avg': {'precision': 0.523419562886902, 'recall': 0.5110151360742282, 'f1-score': 0.49939912302759293, 'support': 559206}, 'weighted avg': {'precision': 0.5512089338341378, 'recall': 0.5245794930669556, 'f1-score': 0.5236699596630159, 'support': 559206}}
[[ 46820  49780  46334]
 [ 25749 155194  91853]
 [ 15985  36157  91334]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8404702
{'0': {'precision': 0.4925720422409164, 'recall': 0.5222804220754573, 'f1-score': 0.5069913966212855, 'support': 26346}, '1': {'precision': 0.804041446663226, 'recall': 0.6233802209978762, 'f1-score': 0.7022781649849162, 'support': 97467}, '2': {'precision': 0.36148254889910786, 'recall': 0.634645434928194, 'f1-score': 0.4606099882538783, 'support': 26878}, 'accuracy': 0.6077137984352085, 'macro avg': {'precision': 0.5526986792677501, 'recall': 0.5934353593338425, 'f1-score': 0.5566265166200267, 'support': 150691}, 'weighted avg': {'precision': 0.6706488022251764, 'recall': 0.6077137984352083, 'f1-score': 0.6250301378732437, 'support': 150691}}
[[13760  8122  4464]
 [11041 60759 25667]
 [ 3134  6686 17058]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8846415
{'0': {'precision': 0.41461153346931207, 'recall': 0.5772308751398331, 'f1-score': 0.48258992805755396, 'support': 11621}, '1': {'precision': 0.7443631365848222, 'recall': 0.6107775305556402, 'f1-score': 0.6709861041352754, 'support': 32809}, '2': {'precision': 0.47291113079421315, 'recall': 0.524390243902439, 'f1-score': 0.49732205231700694, 'support': 12218}, 'accuracy': 0.585263380878407, 'macro avg': {'precision': 0.5439619336161158, 'recall': 0.5707995498659707, 'f1-score': 0.5502993615032788, 'support': 56648}, 'weighted avg': {'precision': 0.6181690258208941, 'recall': 0.585263380878407, 'f1-score': 0.5948813988091419, 'support': 56648}}
[[ 6708  3208  1705]
 [ 7334 20039  5436]
 [ 2137  3674  6407]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2620406
{'0': {'precision': 0.45468435369343274, 'recall': 0.24491106554842515, 'f1-score': 0.3183475091130012, 'support': 210211}, '1': {'precision': 0.32616755939554387, 'recall': 0.5336769586362441, 'f1-score': 0.4048827606704242, 'support': 178683}, '2': {'precision': 0.42772325277630063, 'recall': 0.3937800930657021, 'f1-score': 0.4100504353076851, 'support': 210389}, 'accuracy': 0.3832730112484419, 'macro avg': {'precision': 0.4028583886217591, 'recall': 0.3907893724167904, 'f1-score': 0.37776023503037015, 'support': 599283}, 'weighted avg': {'precision': 0.4069004428927189, 'recall': 0.3832730112484419, 'f1-score': 0.3763429224539576, 'support': 599283}}
[[ 51483 102103  56625]
 [ 29103  95359  54221]
 [ 32642  94900  82847]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.211282
{'0': {'precision': 0.46090618499162817, 'recall': 0.21889684088773223, 'f1-score': 0.2968239445824075, 'support': 41499}, '1': {'precision': 0.36921643239885066, 'recall': 0.5846244651025527, 'f1-score': 0.45259740877892746, 'support': 40662}, '2': {'precision': 0.40791410731509214, 'recall': 0.388836466574726, 'f1-score': 0.3981468864967979, 'support': 41331}, 'accuracy': 0.3961957049849383, 'macro avg': {'precision': 0.41267890823519027, 'recall': 0.3974525908550037, 'f1-score': 0.38252274661937763, 'support': 123492}, 'weighted avg': {'precision': 0.4129799688612194, 'recall': 0.3961957049849383, 'f1-score': 0.382026541620455, 'support': 123492}}
[[ 9084 20805 11610]
 [ 5173 23772 11717]
 [ 5452 19808 16071]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.194404
{'0': {'precision': 0.45643587360594795, 'recall': 0.27195957638264, 'f1-score': 0.3408371286055086, 'support': 14447}, '1': {'precision': 0.347021685424101, 'recall': 0.5258297978537559, 'f1-score': 0.4181108612250298, 'support': 12021}, '2': {'precision': 0.43648275862068964, 'recall': 0.4260518343991922, 'f1-score': 0.43120422415261456, 'support': 14855}, 'accuracy': 0.4012051399946761, 'macro avg': {'precision': 0.4133134392169129, 'recall': 0.40794706954519605, 'f1-score': 0.39671740466105093, 'support': 41323}, 'weighted avg': {'precision': 0.4174340712382594, 'recall': 0.4012051399946761, 'f1-score': 0.3958019361986534, 'support': 41323}}
[[3929 5917 4601]
 [2130 6321 3570]
 [2549 5977 6329]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
2027/2027 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2732134
{'0': {'precision': 0.3864284035489747, 'recall': 0.280782367381791, 'f1-score': 0.3252413980688154, 'support': 187380}, '1': {'precision': 0.30260238683560275, 'recall': 0.3635640112180702, 'f1-score': 0.3302938661678039, 'support': 158316}, '2': {'precision': 0.36617406435862143, 'recall': 0.4070538915931886, 'f1-score': 0.38553333916695837, 'support': 173181}, 'accuracy': 0.348184637206891, 'macro avg': {'precision': 0.3517349515810662, 'recall': 0.3504667567310166, 'f1-score': 0.34702286780119257, 'support': 518877}, 'weighted avg': {'precision': 0.35409190303475113, 'recall': 0.348184637206891, 'f1-score': 0.3469060800471589, 'support': 518877}}
[[52613 70627 64140]
 [42877 57558 57881]
 [40662 62025 70494]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2723562
{'0': {'precision': 0.3729224245636618, 'recall': 0.34806883635464153, 'f1-score': 0.36006726129551103, 'support': 28299}, '1': {'precision': 0.32336402614746607, 'recall': 0.33148394999459596, 'f1-score': 0.32737364572770455, 'support': 27757}, '2': {'precision': 0.38247697446105056, 'recall': 0.39846056516237877, 'f1-score': 0.390305200282306, 'support': 28452}, 'accuracy': 0.3595872580110759, 'macro avg': {'precision': 0.3595878083907262, 'recall': 0.3593377838372054, 'f1-score': 0.3592487024351739, 'support': 84508}, 'weighted avg': {'precision': 0.3598615733879407, 'recall': 0.3595872580110759, 'f1-score': 0.35950936325907284, 'support': 84508}}
[[ 9850  9940  8509]
 [ 8761  9201  9795]
 [ 7802  9313 11337]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3787087
{'0': {'precision': 0.3928372352285396, 'recall': 0.2265166733627963, 'f1-score': 0.2873451913765863, 'support': 12445}, '1': {'precision': 0.27080882861689615, 'recall': 0.37801815723391924, 'f1-score': 0.3155560930382553, 'support': 10354}, '2': {'precision': 0.36410217191801775, 'recall': 0.3998824122291282, 'f1-score': 0.38115443119045717, 'support': 11906}, 'accuracy': 0.33119147096960094, 'macro avg': {'precision': 0.3425827452544845, 'recall': 0.3348057476086146, 'f1-score': 0.3280185718684329, 'support': 34705}, 'weighted avg': {'precision': 0.34657295671443417, 'recall': 0.33119147096960094, 'f1-score': 0.32794419685213355, 'support': 34705}}
[[2819 5361 4265]
 [2390 3914 4050]
 [1967 5178 4761]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2591726
{'0': {'precision': 0.45680920151793747, 'recall': 0.24574172547809128, 'f1-score': 0.3195699474065931, 'support': 285092}, '1': {'precision': 0.2438589827428898, 'recall': 0.36307930899783697, 'f1-score': 0.29175997676227244, 'support': 171519}, '2': {'precision': 0.43107257080681854, 'recall': 0.5032913731377757, 'f1-score': 0.46439100628707414, 'support': 285747}, 'accuracy': 0.3719876393869265, 'macro avg': {'precision': 0.377246918355882, 'recall': 0.37070413587123463, 'f1-score': 0.35857364348531323, 'support': 742358}, 'weighted avg': {'precision': 0.39770136730602423, 'recall': 0.3719876393869265, 'f1-score': 0.3688887999776944, 'support': 742358}}
[[ 70059  98777 116256]
 [ 35695  62275  73549]
 [ 47612  94321 143814]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.263157
{'0': {'precision': 0.4074182456653742, 'recall': 0.2812389529500884, 'f1-score': 0.3327689917539736, 'support': 59405}, '1': {'precision': 0.3528105722186769, 'recall': 0.4426965167489657, 'f1-score': 0.39267534773601664, 'support': 59944}, '2': {'precision': 0.3833721631176787, 'recall': 0.4039448612088648, 'f1-score': 0.39338972850073556, 'support': 58253}, 'accuracy': 0.37598112633866737, 'macro avg': {'precision': 0.3812003270005766, 'recall': 0.3759601103026396, 'f1-score': 0.37294468933024194, 'support': 177602}, 'weighted avg': {'precision': 0.3811000801957301, 'recall': 0.37598112633866737, 'f1-score': 0.37287195444975807, 'support': 177602}}
[[16707 25328 17370]
 [12929 26537 20478]
 [11371 23351 23531]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.287254
{'0': {'precision': 0.41426211988730205, 'recall': 0.21566941479945376, 'f1-score': 0.2836615220862161, 'support': 19771}, '1': {'precision': 0.36017673428580643, 'recall': 0.5213575463330377, 'f1-score': 0.4260318913557641, 'support': 21421}, '2': {'precision': 0.37941432002861963, 'recall': 0.37733163913595935, 'f1-score': 0.37837011365373835, 'support': 19675}, 'accuracy': 0.3755072535199698, 'macro avg': {'precision': 0.3846177247339093, 'recall': 0.37145286675615025, 'f1-score': 0.3626878423652395, 'support': 60867}, 'weighted avg': {'precision': 0.383963378250796, 'recall': 0.3755072535199698, 'f1-score': 0.3643802566914042, 'support': 60867}}
[[ 4264 10244  5263]
 [ 3373 11168  6880]
 [ 2656  9595  7424]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
7167/7167 - 99s - 99s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92076606
{'0': {'precision': 0.5825992722355888, 'recall': 0.33970894292289944, 'f1-score': 0.42917146278436447, 'support': 517493}, '1': {'precision': 0.5804291315578112, 'recall': 0.7041906882778712, 'f1-score': 0.6363482539145375, 'support': 798413}, '2': {'precision': 0.5157975152923493, 'recall': 0.5610519314008079, 'f1-score': 0.5374738187500231, 'support': 518665}, 'accuracy': 0.5609104253801025, 'macro avg': {'precision': 0.5596086396952498, 'recall': 0.5349838542005262, 'f1-score': 0.5343311784829751, 'support': 1834571}, 'weighted avg': {'precision': 0.5627688040804006, 'recall': 0.5609104253801025, 'f1-score': 0.5499546239667571, 'support': 1834571}}
[[175797 237950 103746]
 [ 66751 562235 169427]
 [ 59198 168469 290998]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8808057
{'0': {'precision': 0.533682617025806, 'recall': 0.44738459708121825, 'f1-score': 0.4867380728947567, 'support': 100864}, '1': {'precision': 0.6667244796828543, 'recall': 0.6706092278860196, 'f1-score': 0.6686612114871867, 'support': 200631}, '2': {'precision': 0.4795613160518445, 'recall': 0.5520238713025428, 'f1-score': 0.5132475678384033, 'support': 100204}, 'accuracy': 0.5849778067657624, 'macro avg': {'precision': 0.5599894709201684, 'recall': 0.5566725654232602, 'f1-score': 0.5562156174067822, 'support': 401699}, 'weighted avg': {'precision': 0.5866305982354963, 'recall': 0.5849778067657624, 'f1-score': 0.584213492674918, 'support': 401699}}
[[ 45125  37048  18691]
 [ 24747 134545  41339]
 [ 14682  30207  55315]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8971313
{'0': {'precision': 0.5357799514598809, 'recall': 0.4268471318919552, 'f1-score': 0.4751500130446126, 'support': 34134}, '1': {'precision': 0.6445644312122588, 'recall': 0.6611798402263748, 'f1-score': 0.6527664213682203, 'support': 57957}, '2': {'precision': 0.4628564122235008, 'recall': 0.5377462194361092, 'f1-score': 0.49749876312462205, 'support': 33659}, 'accuracy': 0.5645328031809145, 'macro avg': {'precision': 0.5477335982985468, 'recall': 0.541924397184813, 'f1-score': 0.5418050658458182, 'support': 125750}, 'weighted avg': {'precision': 0.5663985493592943, 'recall': 0.5645328031809145, 'f1-score': 0.5629937566323213, 'support': 125750}}
[[14570 11715  7849]
 [ 6481 38320 13156]
 [ 6143  9416 18100]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
6357/6357 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0422599
{'0': {'precision': 0.6548427344475395, 'recall': 0.09340821939353053, 'f1-score': 0.16349513086094206, 'support': 483223}, '1': {'precision': 0.45800858030976155, 'recall': 0.8688748606382017, 'f1-score': 0.5998298405222939, 'support': 663740}, '2': {'precision': 0.4724036124234734, 'recall': 0.29421956410373884, 'f1-score': 0.3626041820386637, 'support': 480206}, 'accuracy': 0.4689924648269479, 'macro avg': {'precision': 0.5284183090602582, 'recall': 0.41883421471182364, 'f1-score': 0.3753097178072999, 'support': 1627169}, 'weighted avg': {'precision': 0.5207109617195085, 'recall': 0.4689924648269479, 'f1-score': 0.40024138230776457, 'support': 1627169}}
[[ 45137 358294  79792]
 [  9032 576707  78001]
 [ 14759 324161 141286]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95287687
{'0': {'precision': 0.556945290334081, 'recall': 0.30135191615226337, 'f1-score': 0.3910918715936058, 'support': 124416}, '1': {'precision': 0.5306083826558065, 'recall': 0.7748299872659785, 'f1-score': 0.6298746778847214, 'support': 184545}, '2': {'precision': 0.5085180603159795, 'recall': 0.396553769265442, 'f1-score': 0.4456104962434076, 'support': 126457}, 'accuracy': 0.5296772296965215, 'macro avg': {'precision': 0.5320239111019557, 'recall': 0.4909118908945613, 'f1-score': 0.4888590152405783, 'support': 435418}, 'weighted avg': {'precision': 0.5317182513648923, 'recall': 0.5296772296965215, 'f1-score': 0.5081298321380342, 'support': 435418}}
[[ 37493  64420  22503]
 [ 15590 142991  25964]
 [ 14236  62074  50147]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0011237
{'0': {'precision': 0.6119985800496983, 'recall': 0.16415920776994858, 'f1-score': 0.2588782941662287, 'support': 42008}, '1': {'precision': 0.4789054212115442, 'recall': 0.8746439690004637, 'f1-score': 0.6189234636184138, 'support': 60388}, '2': {'precision': 0.5065327526442094, 'recall': 0.2735760746945731, 'f1-score': 0.3552715654952076, 'support': 41663}, 'accuracy': 0.4936310817095773, 'macro avg': {'precision': 0.532478917968484, 'recall': 0.4374597504883284, 'f1-score': 0.41102444109328334, 'support': 144059}, 'weighted avg': {'precision': 0.5257057941556318, 'recall': 0.4936310817095773, 'f1-score': 0.43768309328504673, 'support': 144059}}
[[ 6896 29655  5457]
 [ 1923 52818  5647]
 [ 2449 27816 11398]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
7459/7459 - 106s - 106s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1381676
{'0': {'precision': 0.557852891965232, 'recall': 0.20527314231513147, 'f1-score': 0.30011350927444913, 'support': 700038}, '1': {'precision': 0.3146190031475909, 'recall': 0.7604260281817308, 'f1-score': 0.4450873628208594, 'support': 478466}, '2': {'precision': 0.5115060438029312, 'recall': 0.3466411767684301, 'f1-score': 0.4132369194879136, 'support': 730747}, 'accuracy': 0.39850391593352574, 'macro avg': {'precision': 0.46132597963858474, 'recall': 0.4374467824217641, 'f1-score': 0.38614593052774066, 'support': 1909251}, 'weighted avg': {'precision': 0.4791586992681595, 'recall': 0.39850391593352574, 'f1-score': 0.3797414117630141, 'support': 1909251}}
[[143699 396985 159354]
 [ 32071 363838  82557]
 [ 81823 395617 253307]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9567705
{'0': {'precision': 0.5563191584379497, 'recall': 0.3591041214576844, 'f1-score': 0.43646804058492905, 'support': 124883}, '1': {'precision': 0.5477485866311939, 'recall': 0.7010760377294242, 'f1-score': 0.6149997386284716, 'support': 176202}, '2': {'precision': 0.48525361774573134, 'recall': 0.4656224475087686, 'f1-score': 0.47523538642604946, 'support': 124878}, 'accuracy': 0.5317903198165099, 'macro avg': {'precision': 0.5297737876049583, 'recall': 0.5086008688986258, 'f1-score': 0.50890105521315, 'support': 425963}, 'weighted avg': {'precision': 0.5319398708377195, 'recall': 0.5317903198165099, 'f1-score': 0.5216839651432021, 'support': 425963}}
[[ 44846  54662  25375]
 [ 16366 123531  36305]
 [ 19400  47332  58146]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95994973
{'0': {'precision': 0.5335273395619543, 'recall': 0.4009622910815415, 'f1-score': 0.45784209350314786, 'support': 43438}, '1': {'precision': 0.5259649319365862, 'recall': 0.6293176638813173, 'f1-score': 0.5730182787277109, 'support': 44758}, '2': {'precision': 0.5027621906129018, 'recall': 0.5256025466120964, 'f1-score': 0.5139287222926254, 'support': 43980}, 'accuracy': 0.5197615300811039, 'macro avg': {'precision': 0.5207514873704808, 'recall': 0.5186275005249851, 'f1-score': 0.5149296981744947, 'support': 132176}, 'weighted avg': {'precision': 0.5207297856090767, 'recall': 0.5197615300811039, 'f1-score': 0.5155057059020873, 'support': 132176}}
[[17417 13968 12053]
 [ 5782 28167 10809]
 [ 9446 11418 23116]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
8238/8238 - 114s - 114s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1840786
{'0': {'precision': 0.5632505002013489, 'recall': 0.21411696069970057, 'f1-score': 0.31028179408463863, 'support': 829612}, '1': {'precision': 0.2873278613052695, 'recall': 0.7168361498031491, 'f1-score': 0.41022581082524884, 'support': 457961}, '2': {'precision': 0.5107720769572359, 'recall': 0.4048171994821839, 'f1-score': 0.45166392199703254, 'support': 821141}, 'accuracy': 0.39755462333915365, 'macro avg': {'precision': 0.45378347948795145, 'recall': 0.4452567699950112, 'f1-score': 0.39072384230230667, 'support': 2108714}, 'weighted avg': {'precision': 0.48289157406315203, 'recall': 0.39755462333915365, 'f1-score': 0.38704190652599274, 'support': 2108714}}
[[177634 431597 220381]
 [ 31668 328283  98010]
 [106071 382658 332412]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0363933
{'0': {'precision': 0.5360438838392386, 'recall': 0.34810605325937277, 'f1-score': 0.4221006255781502, 'support': 154677}, '1': {'precision': 0.4643165993563169, 'recall': 0.6756921559978204, 'f1-score': 0.5504082010092737, 'support': 154156}, '2': {'precision': 0.5041198992590005, 'recall': 0.4516859062153525, 'f1-score': 0.4764646798205784, 'support': 153330}, 'accuracy': 0.49173776351633514, 'macro avg': {'precision': 0.5014934608181854, 'recall': 0.4918280384908485, 'f1-score': 0.4829911688026674, 'support': 462163}, 'weighted avg': {'precision': 0.501527715685498, 'recall': 0.49173776351633514, 'f1-score': 0.48293419086821404, 'support': 462163}}
[[ 53844  65200  35633]
 [ 17502 104162  32492]
 [ 29101  54972  69257]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9908472
{'0': {'precision': 0.5314145074177891, 'recall': 0.4163884077638698, 'f1-score': 0.4669216290897441, 'support': 56003}, '1': {'precision': 0.48842598830472395, 'recall': 0.6875165952281607, 'f1-score': 0.5711179732795563, 'support': 52726}, '2': {'precision': 0.5203686476429483, 'recall': 0.4326623855521379, 'f1-score': 0.47247976742358766, 'support': 55593}, 'accuracy': 0.5088910797093511, 'macro avg': {'precision': 0.5134030477884871, 'recall': 0.5121891295147228, 'f1-score': 0.5035064565976294, 'support': 164322}, 'weighted avg': {'precision': 0.5138837742157942, 'recall': 0.5088910797093511, 'f1-score': 0.5022355251483692, 'support': 164322}}
[[23319 19663 13021]
 [ 7327 36250  9149]
 [13235 18305 24053]]
testing model on single stock: results/universal/W5/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
31315/31315 - 430s - 430s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3248305
{'0': {'precision': 0.5035904774294263, 'recall': 0.06320148819251678, 'f1-score': 0.1123081114186054, 'support': 3062507}, '1': {'precision': 0.2250367872673164, 'recall': 0.756083772210355, 'f1-score': 0.34684149946619075, 'support': 1804226}, '2': {'precision': 0.4471646661436097, 'recall': 0.22292636914704106, 'f1-score': 0.2975261275984855, 'support': 3149753}, 'accuracy': 0.28190207030861153, 'macro avg': {'precision': 0.3919306436134508, 'recall': 0.3474038765166376, 'f1-score': 0.2522252461610939, 'support': 8016486}, 'weighted avg': {'precision': 0.41872771105506257, 'recall': 0.28190207030861153, 'f1-score': 0.23786714547669127, 'support': 8016486}}
[[ 193555 2358905  510047]
 [  82034 1364146  358046]
 [ 108761 2338829  702163]]
Evaluating performance on  train set...
5759/5759 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1491472
{'0': {'precision': 0.4642943962996787, 'recall': 0.2839041185320887, 'f1-score': 0.3523532557411911, 'support': 497823}, '1': {'precision': 0.36820801582608986, 'recall': 0.5571083390465361, 'f1-score': 0.44337648424841886, 'support': 478424}, '2': {'precision': 0.4268644398494723, 'recall': 0.38226238891399306, 'f1-score': 0.40333409971996864, 'support': 497925}, 'accuracy': 0.4057911831183878, 'macro avg': {'precision': 0.41978895065841365, 'recall': 0.407758282164206, 'f1-score': 0.3996879465698595, 'support': 1474172}, 'weighted avg': {'precision': 0.4204682067117844, 'recall': 0.4057911831183878, 'f1-score': 0.3991132904002911, 'support': 1474172}}
[[141334 237606 118883]
 [ 75213 266534 136677]
 [ 87859 219728 190338]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1332482
{'0': {'precision': 0.46784733690641434, 'recall': 0.24527660478580723, 'f1-score': 0.3218290668580947, 'support': 188265}, '1': {'precision': 0.35336591743274365, 'recall': 0.5686132269374924, 'f1-score': 0.4358635134602864, 'support': 165420}, '2': {'precision': 0.42560092415692896, 'recall': 0.4006797207916133, 'f1-score': 0.4127645019942851, 'support': 191255}, 'accuracy': 0.39796858369728777, 'macro avg': {'precision': 0.4156047261653623, 'recall': 0.404856517504971, 'f1-score': 0.3901523607708888, 'support': 544940}, 'weighted avg': {'precision': 0.41826875196176455, 'recall': 0.39796858369728777, 'f1-score': 0.3883601249634029, 'support': 544940}}
[[46177 85652 56436]
 [24372 94060 46988]
 [28152 86471 76632]]
training model: results/universal/W5/deepLOB_L2/h100
Epoch 1/50
9913/9913 - 407s - loss: 3.1435 - accuracy100: 0.4357 - val_loss: 3.4900 - val_accuracy100: 0.3701 - 407s/epoch - 41ms/step
Epoch 2/50
9913/9913 - 402s - loss: 3.1136 - accuracy100: 0.4471 - val_loss: 3.4483 - val_accuracy100: 0.3802 - 402s/epoch - 41ms/step
Epoch 3/50
9913/9913 - 401s - loss: 3.0992 - accuracy100: 0.4532 - val_loss: 3.4200 - val_accuracy100: 0.3803 - 401s/epoch - 40ms/step
Epoch 4/50
9913/9913 - 403s - loss: 3.0869 - accuracy100: 0.4579 - val_loss: 3.3864 - val_accuracy100: 0.3776 - 403s/epoch - 41ms/step
Epoch 5/50
9913/9913 - 402s - loss: 3.0748 - accuracy100: 0.4614 - val_loss: 3.3764 - val_accuracy100: 0.3777 - 402s/epoch - 41ms/step
Epoch 6/50
9913/9913 - 402s - loss: 3.0667 - accuracy100: 0.4631 - val_loss: 3.3502 - val_accuracy100: 0.3778 - 402s/epoch - 41ms/step
Epoch 7/50
9913/9913 - 402s - loss: 3.0580 - accuracy100: 0.4657 - val_loss: 3.3691 - val_accuracy100: 0.3610 - 402s/epoch - 41ms/step
Epoch 8/50
9913/9913 - 402s - loss: 3.0510 - accuracy100: 0.4678 - val_loss: 3.3878 - val_accuracy100: 0.3576 - 402s/epoch - 41ms/step
Epoch 9/50
9913/9913 - 401s - loss: 3.0453 - accuracy100: 0.4691 - val_loss: 3.4255 - val_accuracy100: 0.3529 - 401s/epoch - 40ms/step
Epoch 10/50
9913/9913 - 402s - loss: 3.0406 - accuracy100: 0.4704 - val_loss: 3.4275 - val_accuracy100: 0.3512 - 402s/epoch - 41ms/step
Epoch 11/50
9913/9913 - 401s - loss: 3.0363 - accuracy100: 0.4719 - val_loss: 3.4289 - val_accuracy100: 0.3504 - 401s/epoch - 40ms/step
Epoch 12/50
9913/9913 - 400s - loss: 3.0321 - accuracy100: 0.4730 - val_loss: 3.4349 - val_accuracy100: 0.3493 - 400s/epoch - 40ms/step
Epoch 13/50
9913/9913 - 403s - loss: 3.0289 - accuracy100: 0.4737 - val_loss: 3.4639 - val_accuracy100: 0.3477 - 403s/epoch - 41ms/step
Epoch 14/50
9913/9913 - 403s - loss: 3.0256 - accuracy100: 0.4747 - val_loss: 3.4535 - val_accuracy100: 0.3509 - 403s/epoch - 41ms/step
Epoch 15/50
9913/9913 - 401s - loss: 3.0223 - accuracy100: 0.4758 - val_loss: 3.4428 - val_accuracy100: 0.3540 - 401s/epoch - 40ms/step
Epoch 16/50
9913/9913 - 401s - loss: 3.0197 - accuracy100: 0.4766 - val_loss: 3.4391 - val_accuracy100: 0.3517 - 401s/epoch - 40ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 680s - 680s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2348435
{'0': {'precision': 0.5248753130422407, 'recall': 0.03419619566139516, 'f1-score': 0.06420909891919795, 'support': 5068634}, '1': {'precision': 0.20279140532473375, 'recall': 0.7026651226545869, 'f1-score': 0.31474608287114686, 'support': 2585472}, '2': {'precision': 0.4633256648506843, 'recall': 0.3172314022087906, 'f1-score': 0.3766065456139248, 'support': 5184285}, 'accuracy': 0.283109230743946, 'macro avg': {'precision': 0.3969974610725529, 'recall': 0.35136424017492424, 'f1-score': 0.2518539091347565, 'support': 12838391}, 'weighted avg': {'precision': 0.4351576963308505, 'recall': 0.283109230743946, 'f1-score': 0.240813297522433, 'support': 12838391}}
[[ 173328 3693000 1202306]
 [  66081 1816721  702670]
 [  90818 3448849 1644618]]
Evaluating performance on  train set...
9913/9913 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1042948
{'0': {'precision': 0.41574375626531856, 'recall': 0.20823643597086353, 'f1-score': 0.27748636626292345, 'support': 832496}, '1': {'precision': 0.37372574624447524, 'recall': 0.5295773322145148, 'f1-score': 0.4382065962039414, 'support': 871157}, '2': {'precision': 0.4046377230532279, 'recall': 0.4299959202284672, 'f1-score': 0.4169315998317614, 'support': 833380}, 'accuracy': 0.39142218489077596, 'macro avg': {'precision': 0.39803574185434054, 'recall': 0.38926989613794855, 'f1-score': 0.3775415207662087, 'support': 2537033}, 'weighted avg': {'precision': 0.39766759032107585, 'recall': 0.39142218489077596, 'f1-score': 0.37847970064459113, 'support': 2537033}}
[[173356 419535 239605]
 [122160 461345 287652]
 [121462 353568 358350]]
Evaluating performance on  val set...
3496/3496 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1122967
{'0': {'precision': 0.3999664697586809, 'recall': 0.13210017686317044, 'f1-score': 0.19860535040081484, 'support': 307017}, '1': {'precision': 0.3400764747148437, 'recall': 0.5683388937537542, 'f1-score': 0.42552932092494006, 'support': 276358}, '2': {'precision': 0.42321567774333313, 'recall': 0.4506118824876787, 'f1-score': 0.4364843177887537, 'support': 310844}, 'accuracy': 0.3776390347331023, 'macro avg': {'precision': 0.3877528740722859, 'recall': 0.3836836510348678, 'f1-score': 0.3535396630381695, 'support': 894219}, 'weighted avg': {'precision': 0.38953926742508754, 'recall': 0.3776390347331023, 'f1-score': 0.35142642039020516, 'support': 894219}}
[[ 40557 160054 106406]
 [ 34803 157065  84490]
 [ 26041 144733 140070]]
testing model out of sample: results/universal/W5/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 288s - 288s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1755211
{'0': {'precision': 0.43518283877152864, 'recall': 0.07412178156448519, 'f1-score': 0.1266688972692004, 'support': 1922984}, '1': {'precision': 0.30933457488667815, 'recall': 0.5798583274939642, 'f1-score': 0.4034450314428207, 'support': 1505585}, '2': {'precision': 0.4168602356296645, 'recall': 0.47737641744021037, 'f1-score': 0.44507065366872534, 'support': 1920275}, 'accuracy': 0.36124721528614406, 'macro avg': {'precision': 0.38712588309595714, 'recall': 0.37711884216621994, 'f1-score': 0.3250615274602488, 'support': 5348844}, 'weighted avg': {'precision': 0.39318129691887493, 'recall': 0.36124721528614406, 'f1-score': 0.31888406165610117, 'support': 5348844}}
[[ 142535 1047399  733050]
 [  83259  873026  549300]
 [ 101735  901846  916694]]
Evaluating performance on  train set...
4957/4957 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.125404
{'0': {'precision': 0.4158761190521975, 'recall': 0.18279509303281094, 'f1-score': 0.25396281744536703, 'support': 425925}, '1': {'precision': 0.3734225624493779, 'recall': 0.551885636228204, 'f1-score': 0.4454441206808128, 'support': 420203}, '2': {'precision': 0.41059618481707594, 'recall': 0.44744633078803264, 'f1-score': 0.42822996061541946, 'support': 422216}, 'accuracy': 0.3931740915713718, 'macro avg': {'precision': 0.3999649554395505, 'recall': 0.39404235334968246, 'f1-score': 0.37587896624719974, 'support': 1268344}, 'weighted avg': {'precision': 0.40005360989207167, 'recall': 0.3931740915713718, 'f1-score': 0.3754120411450344, 'support': 1268344}}
[[ 77857 208924 139144]
 [ 56253 231904 132046]
 [ 53102 180195 188919]]
Evaluating performance on  val set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1316786
{'0': {'precision': 0.41327189270601733, 'recall': 0.15653290050051955, 'f1-score': 0.22706249168797007, 'support': 147247}, '1': {'precision': 0.3652426899414128, 'recall': 0.5792496225536539, 'f1-score': 0.4480008730407738, 'support': 141742}, '2': {'precision': 0.4138971049855346, 'recall': 0.43776483232135155, 'f1-score': 0.4254965235037759, 'support': 146083}, 'accuracy': 0.38867819579288027, 'macro avg': {'precision': 0.39747056254432156, 'recall': 0.3911824517918417, 'f1-score': 0.3668532960775066, 'support': 435072}, 'weighted avg': {'precision': 0.39783439644601476, 'recall': 0.38867819579288027, 'f1-score': 0.3656696342286472, 'support': 435072}}
[[23049 77038 47160]
 [16241 82104 43397]
 [16482 65651 63950]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1554183
{'0': {'precision': 0.3797499968780829, 'recall': 0.3048040974651445, 'f1-score': 0.33817445843156446, 'support': 99769}, '1': {'precision': 0.26698807587441636, 'recall': 0.3204314364361553, 'f1-score': 0.2912786207160684, 'support': 71204}, '2': {'precision': 0.3918551009604477, 'recall': 0.41308658953431593, 'f1-score': 0.40219083980575454, 'support': 100347}, 'accuracy': 0.348953265516733, 'macro avg': {'precision': 0.34619772457098236, 'recall': 0.34610737447853857, 'f1-score': 0.34388130631779584, 'support': 271320}, 'weighted avg': {'precision': 0.3546343071250532, 'recall': 0.348953265516733, 'f1-score': 0.34954361880699447, 'support': 271320}}
[[30410 30823 38536]
 [22592 22816 25796]
 [27077 31818 41452]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1671238
{'0': {'precision': 0.39615699100572366, 'recall': 0.08214300851947612, 'f1-score': 0.136071616640337, 'support': 23593}, '1': {'precision': 0.3472000500829499, 'recall': 0.4822818383407974, 'f1-score': 0.40374185564008297, 'support': 22999}, '2': {'precision': 0.3719768504416692, 'recall': 0.5291849027169909, 'f1-score': 0.4368683706870338, 'support': 23077}, 'accuracy': 0.36231322395900617, 'macro avg': {'precision': 0.3717779638434476, 'recall': 0.3645365831924215, 'f1-score': 0.32556061432248456, 'support': 69669}, 'weighted avg': {'precision': 0.3719860428353816, 'recall': 0.36231322395900617, 'f1-score': 0.3240696433077326, 'support': 69669}}
[[ 1938 11354 10301]
 [ 1590 11092 10317]
 [ 1364  9501 12212]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1956894
{'0': {'precision': 0.428125, 'recall': 0.06235066560473319, 'f1-score': 0.1088489422981428, 'support': 8789}, '1': {'precision': 0.3044789291755534, 'recall': 0.5726141078838174, 'f1-score': 0.39756085850098427, 'support': 7230}, '2': {'precision': 0.3984829592684954, 'recall': 0.4521339306767272, 'f1-score': 0.42361648072462166, 'support': 8482}, 'accuracy': 0.3478633525162238, 'macro avg': {'precision': 0.37702896281468296, 'recall': 0.3623662347217593, 'f1-score': 0.31000876050791626, 'support': 24501}, 'weighted avg': {'precision': 0.3813765047734635, 'recall': 0.3478633525162238, 'f1-score': 0.30301429942968594, 'support': 24501}}
[[ 548 5112 3129]
 [ 430 4140 2660]
 [ 302 4345 3835]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.083407
{'0': {'precision': 0.593488605058853, 'recall': 0.1280350099951375, 'f1-score': 0.21063016620744826, 'support': 185090}, '1': {'precision': 0.42679611173440557, 'recall': 0.5406332015892281, 'f1-score': 0.47701707015697226, 'support': 192798}, '2': {'precision': 0.41416958124586445, 'recall': 0.6282829062751629, 'f1-score': 0.49923746417396325, 'support': 181318}, 'accuracy': 0.43248820649277725, 'macro avg': {'precision': 0.4781514326797078, 'recall': 0.4323170392865095, 'f1-score': 0.3956282335127946, 'support': 559206}, 'weighted avg': {'precision': 0.4778751350894852, 'recall': 0.43248820649277725, 'f1-score': 0.3960512102598241, 'support': 559206}}
[[ 23698  80853  80539]
 [  7969 104233  80596]
 [  8263  59136 113919]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98261756
{'0': {'precision': 0.5371400523560209, 'recall': 0.2662611516626115, 'f1-score': 0.35603513718685603, 'support': 36990}, '1': {'precision': 0.6117151312403499, 'recall': 0.500928523450156, 'f1-score': 0.5508062822675828, 'support': 75927}, '2': {'precision': 0.3530970803231736, 'recall': 0.656006777148303, 'f1-score': 0.4590886774800145, 'support': 37774}, 'accuracy': 0.4821986714535042, 'macro avg': {'precision': 0.5006507546398481, 'recall': 0.4743988174203569, 'f1-score': 0.4553100323114844, 'support': 150691}, 'weighted avg': {'precision': 0.5285809664708763, 'recall': 0.4821986714535042, 'f1-score': 0.48000493739773864, 'support': 150691}}
[[ 9849 14003 13138]
 [ 5632 38034 32261]
 [ 2855 10139 24780]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0439603
{'0': {'precision': 0.3818982287293949, 'recall': 0.4602665350444225, 'f1-score': 0.4174360696099826, 'support': 16208}, '1': {'precision': 0.5186399636785552, 'recall': 0.434604328711532, 'f1-score': 0.4729179603946733, 'support': 23656}, '2': {'precision': 0.4306286507431612, 'recall': 0.44363679694947566, 'f1-score': 0.43703595011005136, 'support': 16784}, 'accuracy': 0.4446229346137551, 'macro avg': {'precision': 0.4437222810503704, 'recall': 0.44616922023514344, 'f1-score': 0.44246332670490246, 'support': 56648}, 'weighted avg': {'precision': 0.4534392166731244, 'recall': 0.4446229346137551, 'f1-score': 0.4464122735839234, 'support': 56648}}
[[ 7460  4638  4110]
 [ 7640 10281  5735]
 [ 4434  4904  7446]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1981539
{'0': {'precision': 0.4225672226301619, 'recall': 0.11593438219493477, 'f1-score': 0.18194957806065987, 'support': 208480}, '1': {'precision': 0.30748096372847505, 'recall': 0.5606270453809296, 'f1-score': 0.39714446220309213, 'support': 179062}, '2': {'precision': 0.3997300594147577, 'recall': 0.40702084149975676, 'f1-score': 0.4033425062712943, 'support': 211741}, 'accuracy': 0.35165355933674075, 'macro avg': {'precision': 0.37659274859113157, 'recall': 0.3611940896918737, 'f1-score': 0.32747884884501544, 'support': 599283}, 'weighted avg': {'precision': 0.38011125530279444, 'recall': 0.35165355933674075, 'f1-score': 0.32447186945981543, 'support': 599283}}
[[ 24170 117322  66988]
 [ 16243 100387  62432]
 [ 16785 108773  86183]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1657116
{'0': {'precision': 0.43474276737792905, 'recall': 0.0803688108029621, 'f1-score': 0.1356589938930986, 'support': 41322}, '1': {'precision': 0.34725764794584274, 'recall': 0.5256167443667443, 'f1-score': 0.41821466175944977, 'support': 41184}, '2': {'precision': 0.3664511547948277, 'recall': 0.47848045674132633, 'f1-score': 0.4150388351569279, 'support': 40986}, 'accuracy': 0.3609869465228517, 'macro avg': {'precision': 0.3828171900395332, 'recall': 0.3614886706370109, 'f1-score': 0.32297083026982537, 'support': 123492}, 'weighted avg': {'precision': 0.38290145626448013, 'recall': 0.3609869465228517, 'f1-score': 0.32261389623047365, 'support': 123492}}
[[ 3321 21332 16669]
 [ 2301 21647 17236]
 [ 2017 19358 19611]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1761769
{'0': {'precision': 0.437597503900156, 'recall': 0.11459893776385674, 'f1-score': 0.1816317720699331, 'support': 14686}, '1': {'precision': 0.3261870019081827, 'recall': 0.48188375756570767, 'f1-score': 0.3890357776364671, 'support': 12061}, '2': {'precision': 0.3909659697848314, 'recall': 0.5273051591657519, 'f1-score': 0.4490141667883744, 'support': 14576}, 'accuracy': 0.3673741015899136, 'macro avg': {'precision': 0.38491682519772336, 'recall': 0.3745959514984388, 'f1-score': 0.3398939054982582, 'support': 41323}, 'weighted avg': {'precision': 0.38863147273615145, 'recall': 0.3673741015899136, 'f1-score': 0.3364817465769622, 'support': 41323}}
[[1683 6174 6829]
 [1105 5812 5144]
 [1058 5832 7686]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2023215
{'0': {'precision': 0.36910275236266427, 'recall': 0.11035437680115273, 'f1-score': 0.16990926502066886, 'support': 177664}, '1': {'precision': 0.34578885279435606, 'recall': 0.33871647160617513, 'f1-score': 0.34221612590617995, 'support': 175672}, '2': {'precision': 0.3354058839553255, 'recall': 0.595030838281755, 'f1-score': 0.42899606072021973, 'support': 165541}, 'accuracy': 0.3422988492455823, 'macro avg': {'precision': 0.3500991630374486, 'recall': 0.3480338955630276, 'f1-score': 0.3137071505490228, 'support': 518877}, 'weighted avg': {'precision': 0.3504590031543103, 'recall': 0.3422988492455823, 'f1-score': 0.3109041021639203, 'support': 518877}}
[[19606 60836 97222]
 [18213 59503 97956]
 [15299 51740 98502]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1977793
{'0': {'precision': 0.33621424695760016, 'recall': 0.3088067777303147, 'f1-score': 0.3219282294875125, 'support': 28092}, '1': {'precision': 0.3160815402038505, 'recall': 0.30016131923283745, 'f1-score': 0.30791578560264776, 'support': 27895}, '2': {'precision': 0.3581139806307425, 'recall': 0.40450895831141964, 'f1-score': 0.3799002255626719, 'support': 28521}, 'accuracy': 0.33825199981066884, 'macro avg': {'precision': 0.336803255930731, 'recall': 0.33782568509152394, 'f1-score': 0.3365814135509441, 'support': 84508}, 'weighted avg': {'precision': 0.33695974382411986, 'recall': 0.33825199981066884, 'f1-score': 0.33686814260687775, 'support': 84508}}
[[ 8675  9252 10165]
 [ 9008  8373 10514]
 [ 8119  8865 11537]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2247735
{'0': {'precision': 0.4149555623659209, 'recall': 0.10933462532299741, 'f1-score': 0.17306831980571355, 'support': 12384}, '1': {'precision': 0.276974325641859, 'recall': 0.3234038516269804, 'f1-score': 0.29839380279224476, 'support': 10541}, '2': {'precision': 0.34368140482910003, 'recall': 0.5582342954159593, 'f1-score': 0.4254383127385651, 'support': 11780}, 'accuracy': 0.3267252557268405, 'macro avg': {'precision': 0.34520376427896, 'recall': 0.33032425745531235, 'f1-score': 0.2989668117788411, 'support': 34705}, 'weighted avg': {'precision': 0.34885356576335397, 'recall': 0.3267252557268405, 'f1-score': 0.29679615247852775, 'support': 34705}}
[[1354 4589 6441]
 [1015 3409 6117]
 [ 894 4310 6576]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1979296
{'0': {'precision': 0.42198923118220144, 'recall': 0.10171420307064617, 'f1-score': 0.1639183383065963, 'support': 262746}, '1': {'precision': 0.3129752457885467, 'recall': 0.3720342127807734, 'f1-score': 0.33995880707982384, 'support': 218281}, '2': {'precision': 0.37409785582854255, 'recall': 0.6005984747312795, 'f1-score': 0.461030978708655, 'support': 261331}, 'accuracy': 0.3568197554279741, 'macro avg': {'precision': 0.36968744426643024, 'recall': 0.358115630194233, 'f1-score': 0.32163604136502505, 'support': 742358}, 'weighted avg': {'precision': 0.37307592687584334, 'recall': 0.3568197554279741, 'f1-score': 0.32027286401144395, 'support': 742358}}
[[ 26725  92616 143405]
 [ 17877  81208 119196]
 [ 18729  85647 156955]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1620163
{'0': {'precision': 0.39015286748239264, 'recall': 0.198274724549713, 'f1-score': 0.26292938461706716, 'support': 60628}, '1': {'precision': 0.3454327619348553, 'recall': 0.4572658510230402, 'f1-score': 0.39355893558935584, 'support': 57378}, '2': {'precision': 0.3757923119273826, 'recall': 0.44667427344117056, 'f1-score': 0.40817891177846105, 'support': 59596}, 'accuracy': 0.36529994031598745, 'macro avg': {'precision': 0.3704593137815435, 'recall': 0.36740494967130793, 'f1-score': 0.35488907732829467, 'support': 177602}, 'weighted avg': {'precision': 0.3708862945554945, 'recall': 0.36529994031598745, 'f1-score': 0.35387179065077407, 'support': 177602}}
[[12021 26023 22584]
 [ 9508 26237 21633]
 [ 9282 23694 26620]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.177322
{'0': {'precision': 0.3860838985179603, 'recall': 0.07502318543466588, 'f1-score': 0.12563348046427986, 'support': 20487}, '1': {'precision': 0.3501950195019502, 'recall': 0.5807254092243396, 'f1-score': 0.4369162814202025, 'support': 20099}, '2': {'precision': 0.37451180166411957, 'recall': 0.43498841280015776, 'f1-score': 0.40249104637634875, 'support': 20281}, 'accuracy': 0.36195311088110144, 'macro avg': {'precision': 0.37026357322801, 'recall': 0.3635790024863878, 'f1-score': 0.321680269420277, 'support': 60867}, 'weighted avg': {'precision': 0.3703771234898576, 'recall': 0.36195311088110144, 'f1-score': 0.3206721929139777, 'support': 60867}}
[[ 1537 11318  7632]
 [ 1325 11672  7102]
 [ 1119 10340  8822]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
7167/7167 - 99s - 99s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1182077
{'0': {'precision': 0.5736489911046798, 'recall': 0.12088509136501892, 'f1-score': 0.1996895831362331, 'support': 646035}, '1': {'precision': 0.3470480604564477, 'recall': 0.6913271117420142, 'f1-score': 0.46211377100447065, 'support': 531161}, '2': {'precision': 0.5002607956923423, 'recall': 0.48730328959878305, 'f1-score': 0.49369703704103257, 'support': 657375}, 'accuracy': 0.41734171095040745, 'macro avg': {'precision': 0.4736526157511565, 'recall': 0.4331718309019387, 'f1-score': 0.38516679706057877, 'support': 1834571}, 'weighted avg': {'precision': 0.48174459390052093, 'recall': 0.41734171095040745, 'f1-score': 0.38101952025120356, 'support': 1834571}}
[[ 78096 387130 180809]
 [ 24757 367206 139198]
 [ 33286 303748 320341]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0618111
{'0': {'precision': 0.5030369101386077, 'recall': 0.1467837098863146, 'f1-score': 0.2272554043516244, 'support': 132031}, '1': {'precision': 0.4315039250123718, 'recall': 0.6329186888885726, 'f1-score': 0.5131550098662574, 'support': 140522}, '2': {'precision': 0.44900324082032866, 'recall': 0.546048658107878, 'f1-score': 0.4927936269457207, 'support': 129146}, 'accuracy': 0.4452064854530382, 'macro avg': {'precision': 0.46118135865710275, 'recall': 0.44191701896092167, 'f1-score': 0.41106801372120083, 'support': 401699}, 'weighted avg': {'precision': 0.4606415086223296, 'recall': 0.4452064854530382, 'f1-score': 0.41263894690777825, 'support': 401699}}
[[19380 66433 46218]
 [11262 88939 40321]
 [ 7884 50742 70520]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0574998
{'0': {'precision': 0.6128695652173913, 'recall': 0.08178421406855578, 'f1-score': 0.14431089907655767, 'support': 43089}, '1': {'precision': 0.4392518449699371, 'recall': 0.612186064692661, 'f1-score': 0.5114973616795436, 'support': 40932}, '2': {'precision': 0.4393912919161914, 'recall': 0.6628723429749095, 'f1-score': 0.5284767199709597, 'support': 41729}, 'accuracy': 0.4472604373757455, 'macro avg': {'precision': 0.4971709007011733, 'recall': 0.4522808739120421, 'f1-score': 0.39476166024235365, 'support': 125750}, 'weighted avg': {'precision': 0.49878928377202697, 'recall': 0.4472604373757455, 'f1-score': 0.3913131402484696, 'support': 125750}}
[[ 3524 19130 20435]
 [ 1017 25058 14857]
 [ 1209 12859 27661]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
6357/6357 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1536738
{'0': {'precision': 0.5246664598200435, 'recall': 0.002994399004109994, 'f1-score': 0.005954812446297522, 'support': 564721}, '1': {'precision': 0.34139075196443913, 'recall': 0.68572695035461, 'f1-score': 0.4558403359133697, 'support': 505344}, '2': {'precision': 0.4258939920971985, 'recall': 0.4654893879778282, 'f1-score': 0.44481227304927434, 'support': 557104}, 'accuracy': 0.3733754760568816, 'macro avg': {'precision': 0.4306504012938937, 'recall': 0.38473691244551605, 'f1-score': 0.30220247380298054, 'support': 1627169}, 'weighted avg': {'precision': 0.43392983924230977, 'recall': 0.3733754760568816, 'f1-score': 0.2959285009216218, 'support': 1627169}}
[[  1691 371594 191436]
 [   680 346528 158136]
 [   852 296926 259326]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1002306
{'0': {'precision': 0.42495106922798115, 'recall': 0.201292458142761, 'f1-score': 0.2731826887678306, 'support': 145614}, '1': {'precision': 0.3846936998486249, 'recall': 0.5943046750505309, 'f1-score': 0.4670595378793629, 'support': 144961}, '2': {'precision': 0.439436896474287, 'recall': 0.4323163701387019, 'f1-score': 0.43584755289048827, 'support': 144843}, 'accuracy': 0.4089863074103505, 'macro avg': {'precision': 0.41636055518363096, 'recall': 0.4093045011106646, 'f1-score': 0.3920299265125606, 'support': 435418}, 'weighted avg': {'precision': 0.41636718466931755, 'recall': 0.4089863074103505, 'f1-score': 0.3918398155705235, 'support': 435418}}
[[29311 74721 41582]
 [20514 86151 38296]
 [19150 63075 62618]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1341169
{'0': {'precision': 0.5302619692863595, 'recall': 0.024004743697221255, 'f1-score': 0.04593024393106551, 'support': 48907}, '1': {'precision': 0.35883974563147314, 'recall': 0.6920421088305692, 'f1-score': 0.4726168089107478, 'support': 47211}, '2': {'precision': 0.4292070241751319, 'recall': 0.45476731816190735, 'f1-score': 0.4416176306754307, 'support': 47941}, 'accuracy': 0.3862861744146496, 'macro avg': {'precision': 0.43943624636432155, 'recall': 0.39027139022989926, 'f1-score': 0.32005489450574803, 'support': 144059}, 'weighted avg': {'precision': 0.44045369819917857, 'recall': 0.3862861744146496, 'f1-score': 0.3174436407141015, 'support': 144059}}
[[ 1174 32829 14904]
 [  449 32672 14090]
 [  591 25548 21802]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
7459/7459 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1790509
{'0': {'precision': 0.5190375430747839, 'recall': 0.057957141391284626, 'f1-score': 0.10427108977340768, 'support': 740668}, '1': {'precision': 0.2421699522595422, 'recall': 0.6274197132607735, 'f1-score': 0.3494572395042048, 'support': 409501}, '2': {'precision': 0.45900802114939765, 'recall': 0.4629499843231693, 'f1-score': 0.460970575522912, 'support': 759082}, 'accuracy': 0.34111439512143765, 'macro avg': {'precision': 0.40673850549457463, 'recall': 0.3827756129917425, 'f1-score': 0.3048996349335082, 'support': 1909251}, 'weighted avg': {'precision': 0.4357876797154884, 'recall': 0.34111439512143765, 'f1-score': 0.29867619027754067, 'support': 1909251}}
[[ 42927 423638 274103]
 [ 12491 256929 140081]
 [ 27287 380378 351417]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0775348
{'0': {'precision': 0.5137006861063464, 'recall': 0.16682449275160496, 'f1-score': 0.25185800334282926, 'support': 143618}, '1': {'precision': 0.39969339920265096, 'recall': 0.6095236737632125, 'f1-score': 0.48279521935742475, 'support': 140303}, '2': {'precision': 0.4392612660554897, 'recall': 0.5113839568578308, 'f1-score': 0.47258674196339695, 'support': 142042}, 'accuracy': 0.4275371335069008, 'macro avg': {'precision': 0.45088511712149576, 'recall': 0.42924404112421605, 'f1-score': 0.4024133215545503, 'support': 425963}, 'weighted avg': {'precision': 0.4513265163373454, 'recall': 0.4275371335069008, 'f1-score': 0.4015281289397437, 'support': 425963}}
[[23959 71740 47919]
 [ 9978 85518 44807]
 [12703 56701 72638]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783584
{'0': {'precision': 0.5210149549932667, 'recall': 0.15447496164918992, 'f1-score': 0.23829745850622405, 'support': 47587}, '1': {'precision': 0.3681717531529797, 'recall': 0.5281898290102484, 'f1-score': 0.4338976127802487, 'support': 36201}, '2': {'precision': 0.4491320389523982, 'recall': 0.6138298751756633, 'f1-score': 0.518721620677611, 'support': 48388}, 'accuracy': 0.4249939474639874, 'macro avg': {'precision': 0.44610624903288154, 'recall': 0.4321648886117006, 'f1-score': 0.39697223065469456, 'support': 132176}, 'weighted avg': {'precision': 0.452838074990802, 'recall': 0.4249939474639874, 'f1-score': 0.3945291915290348, 'support': 132176}}
[[ 7351 18032 22204]
 [ 2854 19121 14226]
 [ 3904 14782 29702]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
8238/8238 - 116s - 116s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.180874
{'0': {'precision': 0.48210008415873634, 'recall': 0.075674357397989, 'f1-score': 0.13081493647649872, 'support': 787268}, '1': {'precision': 0.2839002710771509, 'recall': 0.6064860615316329, 'f1-score': 0.386756963730253, 'support': 531694}, '2': {'precision': 0.43931524704491587, 'recall': 0.47243944934612386, 'f1-score': 0.4552756442600017, 'support': 789752}, 'accuracy': 0.3581097294369934, 'macro avg': {'precision': 0.4017718674269344, 'recall': 0.3848666227585819, 'f1-score': 0.3242825148222512, 'support': 2108714}, 'weighted avg': {'precision': 0.41610201040529493, 'recall': 0.3581097294369934, 'f1-score': 0.31686498078411685, 'support': 2108714}}
[[ 59576 434923 292769]
 [ 25809 322465 183420]
 [ 38191 378451 373110]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1179125
{'0': {'precision': 0.4179170285256196, 'recall': 0.2021025018091595, 'f1-score': 0.2724497306337185, 'support': 154768}, '1': {'precision': 0.3838976554859514, 'recall': 0.567044722509614, 'f1-score': 0.4578345535214708, 'support': 153681}, '2': {'precision': 0.42400823353293415, 'recall': 0.442230375892892, 'f1-score': 0.43292764477731716, 'support': 153714}, 'accuracy': 0.4033209062603454, 'macro avg': {'precision': 0.4086076391815017, 'recall': 0.40379253340388854, 'f1-score': 0.3877373096441688, 'support': 462163}, 'weighted avg': {'precision': 0.408630634371144, 'recall': 0.4033209062603454, 'f1-score': 0.38746938184093715, 'support': 462163}}
[[31279 75410 48079]
 [22273 87144 44264]
 [21293 64444 67977]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918852
{'0': {'precision': 0.4061602656137832, 'recall': 0.33294714774357276, 'f1-score': 0.36592760272449826, 'support': 54378}, '1': {'precision': 0.4031865232392937, 'recall': 0.5043615458551712, 'f1-score': 0.4481344516149824, 'support': 55141}, '2': {'precision': 0.4281437125748503, 'recall': 0.3966206229585972, 'f1-score': 0.4117797501207718, 'support': 54803}, 'accuracy': 0.4117038497584012, 'macro avg': {'precision': 0.4124968338093091, 'recall': 0.41130977218578035, 'f1-score': 0.4086139348200841, 'support': 164322}, 'weighted avg': {'precision': 0.4124940718937435, 'recall': 0.4117038497584012, 'f1-score': 0.4088056293334013, 'support': 164322}}
[[18105 21547 14726]
 [13024 27811 14306]
 [13447 19620 21736]]
testing model on single stock: results/universal/W5/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
31315/31315 - 430s - 430s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2874855
{'0': {'precision': 0.48102907793752026, 'recall': 0.002681387584934458, 'f1-score': 0.005333047306226872, 'support': 3319177}, '1': {'precision': 0.1601750407356631, 'recall': 0.8059960512089255, 'f1-score': 0.26724138490903504, 'support': 1276340}, '2': {'precision': 0.482893773893527, 'recall': 0.2223899135011162, 'f1-score': 0.30453193948981355, 'support': 3420969}, 'accuracy': 0.22433944249388074, 'macro avg': {'precision': 0.3746992975222368, 'recall': 0.3436891174316587, 'f1-score': 0.1923687905683585, 'support': 8016486}, 'weighted avg': {'precision': 0.4307402388149554, 'recall': 0.22433944249388074, 'f1-score': 0.1747132748286551, 'support': 8016486}}
[[   8900 2740411  569866]
 [   2791 1028725  244824]
 [   6811 2653369  760789]]
Evaluating performance on  train set...
5759/5759 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1308029
{'0': {'precision': 0.386998791281903, 'recall': 0.22592091751141297, 'f1-score': 0.2852938835148412, 'support': 491765}, '1': {'precision': 0.33122062590335466, 'recall': 0.4941090625064233, 'f1-score': 0.3965908781573848, 'support': 486510}, '2': {'precision': 0.38814152309439787, 'recall': 0.36108103093989274, 'f1-score': 0.37412259029001665, 'support': 495897}, 'accuracy': 0.3598955888458063, 'macro avg': {'precision': 0.3687869800932185, 'recall': 0.36037033698590965, 'f1-score': 0.35200245065408087, 'support': 1474172}, 'weighted avg': {'precision': 0.36897514277908466, 'recall': 0.3598955888458063, 'f1-score': 0.3519055068988378, 'support': 1474172}}
[[111100 258357 122308]
 [ 86164 240389 159957]
 [ 89817 227021 179059]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1329467
{'0': {'precision': 0.357967903506082, 'recall': 0.11191537638016714, 'f1-score': 0.17051942202583112, 'support': 187749}, '1': {'precision': 0.30951177821031095, 'recall': 0.6012737232469642, 'f1-score': 0.40866109303570697, 'support': 165028}, '2': {'precision': 0.4146513733776034, 'recall': 0.35744133886336077, 'f1-score': 0.3839267997529435, 'support': 192163}, 'accuracy': 0.34669137886739826, 'macro avg': {'precision': 0.3607103516979988, 'recall': 0.35687681283016404, 'f1-score': 0.3210357716048272, 'support': 544940}, 'weighted avg': {'precision': 0.36328197143211177, 'recall': 0.34669137886739826, 'f1-score': 0.31789169348616236, 'support': 544940}}
[[ 21012 113466  53271]
 [ 22109  99227  43692]
 [ 15577 107899  68687]]
training model: results/universal/W5/deepLOB_L2/h200
Epoch 1/50
9913/9913 - 405s - loss: 3.2230 - accuracy200: 0.4052 - val_loss: 3.4104 - val_accuracy200: 0.3188 - 405s/epoch - 41ms/step
Epoch 2/50
9913/9913 - 402s - loss: 3.1961 - accuracy200: 0.4207 - val_loss: 3.4253 - val_accuracy200: 0.3075 - 402s/epoch - 41ms/step
Epoch 3/50
9913/9913 - 402s - loss: 3.1857 - accuracy200: 0.4256 - val_loss: 3.4736 - val_accuracy200: 0.3091 - 402s/epoch - 41ms/step
Epoch 4/50
9913/9913 - 401s - loss: 3.1769 - accuracy200: 0.4294 - val_loss: 3.4872 - val_accuracy200: 0.3105 - 401s/epoch - 40ms/step
Epoch 5/50
9913/9913 - 402s - loss: 3.1706 - accuracy200: 0.4324 - val_loss: 3.4919 - val_accuracy200: 0.3142 - 402s/epoch - 41ms/step
Epoch 6/50
9913/9913 - 402s - loss: 3.1655 - accuracy200: 0.4346 - val_loss: 3.4504 - val_accuracy200: 0.3148 - 402s/epoch - 41ms/step
Epoch 7/50
9913/9913 - 402s - loss: 3.1613 - accuracy200: 0.4364 - val_loss: 3.4655 - val_accuracy200: 0.3170 - 402s/epoch - 41ms/step
Epoch 8/50
9913/9913 - 404s - loss: 3.1579 - accuracy200: 0.4377 - val_loss: 3.4996 - val_accuracy200: 0.3152 - 404s/epoch - 41ms/step
Epoch 9/50
9913/9913 - 403s - loss: 3.1545 - accuracy200: 0.4389 - val_loss: 3.5248 - val_accuracy200: 0.3139 - 403s/epoch - 41ms/step
Epoch 10/50
9913/9913 - 404s - loss: 3.1514 - accuracy200: 0.4402 - val_loss: 3.5034 - val_accuracy200: 0.3165 - 404s/epoch - 41ms/step
Epoch 11/50
9913/9913 - 403s - loss: 3.1484 - accuracy200: 0.4414 - val_loss: 3.4638 - val_accuracy200: 0.3173 - 403s/epoch - 41ms/step
testing model in sample: results/universal/W5/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 679s - 679s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1523737
{'0': {'precision': 0.39661219557050154, 'recall': 0.012584035977609856, 'f1-score': 0.024394076745700485, 'support': 4798540}, '1': {'precision': 0.2230109498194839, 'recall': 0.5297373809186182, 'f1-score': 0.3138824269665485, 'support': 3116986}, '2': {'precision': 0.37608579179832224, 'recall': 0.40352904253925304, 'f1-score': 0.38932440172445637, 'support': 4922865}, 'accuracy': 0.2880491799945959, 'macro avg': {'precision': 0.3319029790627692, 'recall': 0.3152834864784937, 'f1-score': 0.24253363514556847, 'support': 12838391}, 'weighted avg': {'precision': 0.3465933600875808, 'recall': 0.2880491799945959, 'f1-score': 0.23460997210813517, 'support': 12838391}}
[[  60385 2874935 1863220]
 [  33451 1651184 1432351]
 [  58416 2877930 1986519]]
Evaluating performance on  train set...
9913/9913 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1324403
{'0': {'precision': 0.3366540725587609, 'recall': 0.15392250547882613, 'f1-score': 0.21125606336601238, 'support': 838227}, '1': {'precision': 0.3177041317573546, 'recall': 0.305186918517407, 'f1-score': 0.31131975625113245, 'support': 852992}, '2': {'precision': 0.3340729916067146, 'recall': 0.5270508646108956, 'f1-score': 0.4089387555533539, 'support': 845814}, 'accuracy': 0.3291762464264359, 'macro avg': {'precision': 0.32947706530761006, 'recall': 0.32872009620237624, 'f1-score': 0.3105048583901662, 'support': 2537033}, 'weighted avg': {'precision': 0.32942229342603097, 'recall': 0.3291762464264359, 'f1-score': 0.3108039676034458, 'support': 2537033}}
[[129022 287224 421981]
 [126038 260322 466632]
 [128188 271839 445787]]
Evaluating performance on  val set...
3496/3496 - 50s - 50s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1352193
{'0': {'precision': 0.3160219399538106, 'recall': 0.10725342913128674, 'f1-score': 0.16015312591436653, 'support': 306200}, '1': {'precision': 0.28250756348086487, 'recall': 0.3282560524648379, 'f1-score': 0.3036684411401889, 'support': 279349}, '2': {'precision': 0.3449935904731025, 'recall': 0.5205170570512198, 'f1-score': 0.41495745645242726, 'support': 308670}, 'accuracy': 0.3189453590227897, 'macro avg': {'precision': 0.3145076979692593, 'recall': 0.31867551288244816, 'f1-score': 0.29292634116899424, 'support': 894219}, 'weighted avg': {'precision': 0.3155527839779802, 'recall': 0.3189453590227897, 'f1-score': 0.2929408574434455, 'support': 894219}}
[[ 32841 117352 156007]
 [ 38613  91698 149038]
 [ 32466 115536 160668]]
testing model out of sample: results/universal/W5/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 289s - 289s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1395767
{'0': {'precision': 0.3579716635453139, 'recall': 0.01822299620876704, 'f1-score': 0.03468053625161286, 'support': 1929979}, '1': {'precision': 0.26406878368216374, 'recall': 0.5811591721348995, 'f1-score': 0.3631351628994428, 'support': 1465891}, '2': {'precision': 0.36425218895500183, 'recall': 0.3775892561805738, 'f1-score': 0.3708008334975924, 'support': 1952974}, 'accuracy': 0.30371197963522584, 'macro avg': {'precision': 0.3287642120608265, 'recall': 0.3256571415080801, 'f1-score': 0.2562055108828827, 'support': 5348844}, 'weighted avg': {'precision': 0.33453002201790855, 'recall': 0.30371197963522584, 'f1-score': 0.2474205007196519, 'support': 5348844}}
[[  35170 1194125  700684]
 [  27599  851916  586376]
 [  35479 1180073  737422]]
Evaluating performance on  train set...
4957/4957 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.124207
{'0': {'precision': 0.3354887506391682, 'recall': 0.14769913330581924, 'f1-score': 0.20510198765206972, 'support': 426448}, '1': {'precision': 0.3297293322766971, 'recall': 0.48014771140123585, 'f1-score': 0.3909699268805871, 'support': 420279}, '2': {'precision': 0.3358102412531077, 'recall': 0.3732273603768349, 'f1-score': 0.35353151833495844, 'support': 421617}, 'accuracy': 0.3328284755555275, 'macro avg': {'precision': 0.33367610805632436, 'recall': 0.33369140169462996, 'f1-score': 0.31653447762253845, 'support': 1268344}, 'weighted avg': {'precision': 0.3336871757653298, 'recall': 0.3328284755555275, 'f1-score': 0.31603151865387175, 'support': 1268344}}
[[ 62986 208231 155231]
 [ 62478 201796 156005]
 [ 62280 201978 157359]]
Evaluating performance on  val set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121532
{'0': {'precision': 0.35154276742439755, 'recall': 0.13857849238117662, 'f1-score': 0.1987927099367403, 'support': 148645}, '1': {'precision': 0.31418940305121223, 'recall': 0.5714080128943126, 'f1-score': 0.4054445942082261, 'support': 138976}, '2': {'precision': 0.34928550644983997, 'recall': 0.29308041315420036, 'f1-score': 0.31872407117175255, 'support': 147451}, 'accuracy': 0.32920068402471314, 'macro avg': {'precision': 0.33833922564181657, 'recall': 0.3343556394765632, 'f1-score': 0.30765379177223967, 'support': 435072}, 'weighted avg': {'precision': 0.3388458883903818, 'recall': 0.32920068402471314, 'f1-score': 0.3054501170187355, 'support': 435072}}
[[20599 89020 39026]
 [18081 79412 41483]
 [19916 84320 43215]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1405531
{'0': {'precision': 0.2995664292350573, 'recall': 0.1061392439787129, 'f1-score': 0.15674296131253798, 'support': 91135}, '1': {'precision': 0.2864365483921934, 'recall': 0.4267819751954504, 'f1-score': 0.34280084391544924, 'support': 80711}, '2': {'precision': 0.3548786340329873, 'recall': 0.423728813559322, 'f1-score': 0.38625960494302325, 'support': 99474}, 'accuracy': 0.31796034203154944, 'macro avg': {'precision': 0.313627203886746, 'recall': 0.3188833442444951, 'f1-score': 0.2952678033903368, 'support': 271320}, 'weighted avg': {'precision': 0.3159397170404565, 'recall': 0.31796034203154944, 'f1-score': 0.2962382302616109, 'support': 271320}}
[[ 9673 40490 40972]
 [10614 34446 35651]
 [12003 45321 42150]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1396133
{'0': {'precision': 0.3744343891402715, 'recall': 0.013603485122472465, 'f1-score': 0.026253172588832488, 'support': 24332}, '1': {'precision': 0.3171454266518542, 'recall': 0.5417250259793069, 'f1-score': 0.40007340796476415, 'support': 22133}, '2': {'precision': 0.32580134930113946, 'recall': 0.4349681089467333, 'f1-score': 0.37255227654430356, 'support': 23204}, 'accuracy': 0.32172128206232325, 'macro avg': {'precision': 0.33912705503108836, 'recall': 0.3300988733495042, 'f1-score': 0.26629295236596673, 'support': 69669}, 'weighted avg': {'precision': 0.34003662739281765, 'recall': 0.32172128206232325, 'f1-score': 0.26034993984196153, 'support': 69669}}
[[  331 12991 11010]
 [  267 11990  9876]
 [  286 12825 10093]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.135606
{'0': {'precision': 0.3945578231292517, 'recall': 0.019387186629526463, 'f1-score': 0.03695836873406967, 'support': 8975}, '1': {'precision': 0.29357914009722835, 'recall': 0.6590136054421769, 'f1-score': 0.4062022275606028, 'support': 7056}, '2': {'precision': 0.36966305802213845, 'recall': 0.3587957497048406, 'f1-score': 0.36414834341860886, 'support': 8470}, 'accuracy': 0.32092567650299986, 'macro avg': {'precision': 0.3526000070828728, 'recall': 0.3457321805921813, 'f1-score': 0.2691029799044271, 'support': 24501}, 'weighted avg': {'precision': 0.3568710247156683, 'recall': 0.32092567650299986, 'f1-score': 0.2564058914253094, 'support': 24501}}
[[ 174 5907 2894]
 [ 118 4650 2288]
 [ 149 5282 3039]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1531632
{'0': {'precision': 0.382464096749811, 'recall': 0.013846132797000917, 'f1-score': 0.02672476397966594, 'support': 219267}, '1': {'precision': 0.21814908272522676, 'recall': 0.6450905101481075, 'f1-score': 0.3260413545100389, 'support': 123964}, '2': {'precision': 0.402993074994721, 'recall': 0.34462322028012504, 'f1-score': 0.37152954565874996, 'support': 215975}, 'accuracy': 0.28153131404169485, 'macro avg': {'precision': 0.3345354181565863, 'recall': 0.33451995440841115, 'f1-score': 0.24143188804948493, 'support': 559206}, 'weighted avg': {'precision': 0.3539676208141109, 'recall': 0.28153131404169485, 'f1-score': 0.22624639742359773, 'support': 559206}}
[[  3036 148162  68069]
 [  1802  79968  42194]
 [  3100 138445  74430]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1066728
{'0': {'precision': 0.40561396739654676, 'recall': 0.09049238185417922, 'f1-score': 0.1479722002287323, 'support': 46468}, '1': {'precision': 0.38528766101975725, 'recall': 0.3377325950803304, 'f1-score': 0.3599462131545598, 'support': 55085}, '2': {'precision': 0.34408613833416635, 'recall': 0.644491025275754, 'f1-score': 0.4486456621522072, 'support': 49138}, 'accuracy': 0.3615212587347619, 'macro avg': {'precision': 0.3783292555834901, 'recall': 0.3575720007367545, 'f1-score': 0.31885469184516646, 'support': 150691}, 'weighted avg': {'precision': 0.37812042729639017, 'recall': 0.3615212587347619, 'f1-score': 0.32350412366155124, 'support': 150691}}
[[ 4205 15666 26597]
 [ 2709 18604 33772]
 [ 3453 14016 31669]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112557
{'0': {'precision': 0.35762415772398304, 'recall': 0.3649467732898691, 'f1-score': 0.36124836139961675, 'support': 19633}, '1': {'precision': 0.2719378107710624, 'recall': 0.23492044285800714, 'f1-score': 0.25207738249805245, 'support': 16529}, '2': {'precision': 0.3967045759828065, 'recall': 0.4324904813043054, 'f1-score': 0.41382531527323685, 'support': 20486}, 'accuracy': 0.35143341335969497, 'macro avg': {'precision': 0.3420888481592839, 'recall': 0.3441192324840605, 'f1-score': 0.342383686390302, 'support': 56648}, 'weighted avg': {'precision': 0.34675513886480763, 'recall': 0.35143341335969497, 'f1-score': 0.34840773801999214, 'support': 56648}}
[[7165 5550 6918]
 [6090 3883 6556]
 [6780 4846 8860]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
2341/2341 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1384839
{'0': {'precision': 0.4080157687253614, 'recall': 0.011429780929198857, 'f1-score': 0.02223664480898776, 'support': 217327}, '1': {'precision': 0.2382747192690091, 'recall': 0.5805395761316603, 'f1-score': 0.3378736920063982, 'support': 152453}, '2': {'precision': 0.3957854198796865, 'recall': 0.3824220162699398, 'f1-score': 0.38898897967233753, 'support': 229503}, 'accuracy': 0.2982831149890786, 'macro avg': {'precision': 0.34735863595801897, 'recall': 0.32479712444359965, 'f1-score': 0.24969977216257452, 'support': 599283}, 'weighted avg': {'precision': 0.3601511806027245, 'recall': 0.2982831149890786, 'f1-score': 0.2429847318805886, 'support': 599283}}
[[  2484 143385  71458]
 [  1419  88505  62529]
 [  2185 139551  87767]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1229526
{'0': {'precision': 0.3663956639566396, 'recall': 0.016335604852351263, 'f1-score': 0.031276748328590925, 'support': 41382}, '1': {'precision': 0.32497882963630964, 'recall': 0.7254382088672853, 'f1-score': 0.4488732597616642, 'support': 40734}, '2': {'precision': 0.3197473793866788, 'recall': 0.23738399071925753, 'f1-score': 0.27247759869059834, 'support': 41376}, 'accuracy': 0.3242963106921906, 'macro avg': {'precision': 0.3370406243265427, 'recall': 0.3263859348129647, 'f1-score': 0.2508758689269512, 'support': 123492}, 'weighted avg': {'precision': 0.3371047564357393, 'recall': 0.3242963106921906, 'f1-score': 0.24983586698642485, 'support': 123492}}
[[  676 30523 10183]
 [  471 29550 10713]
 [  698 30856  9822]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269408
{'0': {'precision': 0.41332294507206857, 'recall': 0.07013948568784292, 'f1-score': 0.11992765909347802, 'support': 15127}, '1': {'precision': 0.2753027545962226, 'recall': 0.7723112128146453, 'f1-score': 0.40591174021648624, 'support': 11362}, '2': {'precision': 0.4013368206916594, 'recall': 0.18619387892678982, 'f1-score': 0.25437465463252906, 'support': 14834}, 'accuracy': 0.30486653921544904, 'macro avg': {'precision': 0.3633208401199835, 'recall': 0.34288152580975934, 'f1-score': 0.2600713513141644, 'support': 41323}, 'weighted avg': {'precision': 0.37107074718601113, 'recall': 0.30486653921544904, 'f1-score': 0.24682400886348269, 'support': 41323}}
[[ 1061 11815  2251]
 [  718  8775  1869]
 [  788 11284  2762]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1199261
{'0': {'precision': 0.3333333333333333, 'recall': 0.016711088547616024, 'f1-score': 0.03182660543066634, 'support': 165459}, '1': {'precision': 0.35544284160356804, 'recall': 0.6034061508232474, 'f1-score': 0.44736219901916663, 'support': 194413}, '2': {'precision': 0.2819716078718089, 'recall': 0.32016603251470077, 'f1-score': 0.2998574575612284, 'support': 159005}, 'accuracy': 0.3295251090335474, 'macro avg': {'precision': 0.3235825942695701, 'recall': 0.31342775729518807, 'f1-score': 0.2596820873370205, 'support': 518877}, 'weighted avg': {'precision': 0.3258780109242295, 'recall': 0.3295251090335474, 'f1-score': 0.26965516017358443, 'support': 518877}}
[[  2765 107366  55328]
 [  2796 117310  74307]
 [  2734 105363  50908]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1333653
{'0': {'precision': 0.30177196100608605, 'recall': 0.2014018691588785, 'f1-score': 0.24157630370577965, 'support': 27820}, '1': {'precision': 0.3021914930004153, 'recall': 0.44360362945163717, 'f1-score': 0.35949080129043504, 'support': 27883}, '2': {'precision': 0.3404238304678129, 'recall': 0.2955736851241104, 'f1-score': 0.3164173557558302, 'support': 28805}, 'accuracy': 0.3134141146400341, 'macro avg': {'precision': 0.31479576149143806, 'recall': 0.3135263945782087, 'f1-score': 0.30582815358401494, 'support': 84508}, 'weighted avg': {'precision': 0.3150850782309988, 'recall': 0.3134141146400341, 'f1-score': 0.3059915832113253, 'support': 84508}}
[[ 5603 14258  7959]
 [ 6977 12369  8537]
 [ 5987 14304  8514]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1355516
{'0': {'precision': 0.3119266055045872, 'recall': 0.014110225763612217, 'f1-score': 0.026999126498848565, 'support': 12048}, '1': {'precision': 0.29881789007596377, 'recall': 0.6771610052471693, 'f1-score': 0.41465614430665165, 'support': 10863}, '2': {'precision': 0.3179293723147857, 'recall': 0.25724944887230794, 'f1-score': 0.28438862070581616, 'support': 11794}, 'accuracy': 0.30427892234548337, 'macro avg': {'precision': 0.3095579559651122, 'recall': 0.3161735599610298, 'f1-score': 0.24201463050377212, 'support': 34705}, 'weighted avg': {'precision': 0.30986340585203986, 'recall': 0.30427892234548337, 'f1-score': 0.23580966904669878, 'support': 34705}}
[[ 170 8703 3175]
 [ 173 7356 3334]
 [ 202 8558 3034]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1302849
{'0': {'precision': 0.36488712334076157, 'recall': 0.01430041503859897, 'f1-score': 0.027522198267986995, 'support': 263349}, '1': {'precision': 0.29074236656262087, 'recall': 0.7223747785656061, 'f1-score': 0.41461138758782196, 'support': 219591}, '2': {'precision': 0.34571238548840405, 'recall': 0.2484638691224202, 'f1-score': 0.28912982043771396, 'support': 259418}, 'accuracy': 0.3055789794142449, 'macro avg': {'precision': 0.3337806251305955, 'recall': 0.32837968757554176, 'f1-score': 0.24375446876450765, 'support': 742358}, 'weighted avg': {'precision': 0.3362543162182525, 'recall': 0.3055789794142449, 'f1-score': 0.23344309936955535, 'support': 742358}}
[[  3766 195496  64087]
 [  3063 158627  57901]
 [  3492 191470  64456]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1252884
{'0': {'precision': 0.3353987068965517, 'recall': 0.16626602564102563, 'f1-score': 0.22232142857142856, 'support': 59904}, '1': {'precision': 0.32297319863070884, 'recall': 0.5278095205607954, 'f1-score': 0.40073293751254474, 'support': 58631}, '2': {'precision': 0.32499520061432136, 'recall': 0.28660673472497333, 'f1-score': 0.30459620176866953, 'support': 59067}, 'accuracy': 0.32564385536198914, 'macro avg': {'precision': 0.3277890353805273, 'recall': 0.3268940936422648, 'f1-score': 0.30921685595088094, 'support': 177602}, 'weighted avg': {'precision': 0.32783672065367647, 'recall': 0.32564385536198914, 'f1-score': 0.3085826711766245, 'support': 177602}}
[[ 9960 32678 17266]
 [ 9790 30946 17895]
 [ 9946 32192 16929]]
Evaluating performance on  val set...
238/238 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1168575
{'0': {'precision': 0.37442218798151, 'recall': 0.01222764554923766, 'f1-score': 0.023681902348698956, 'support': 19873}, '1': {'precision': 0.3345214585039256, 'recall': 0.6612396458154813, 'f1-score': 0.4442809621289662, 'support': 21006}, '2': {'precision': 0.3281985451433462, 'recall': 0.3069841905143086, 'f1-score': 0.3172371006100714, 'support': 19988}, 'accuracy': 0.33300474805723956, 'macro avg': {'precision': 0.3457140638762606, 'recall': 0.32681716062634253, 'f1-score': 0.2617333216959122, 'support': 60867}, 'weighted avg': {'precision': 0.34547262752255264, 'recall': 0.33300474805723956, 'f1-score': 0.26523619535792575, 'support': 60867}}
[[  243 13995  5635]
 [  191 13890  6925]
 [  215 13637  6136]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
7167/7167 - 100s - 100s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1413329
{'0': {'precision': 0.45861613876319757, 'recall': 0.007459928758830394, 'f1-score': 0.014681052992113273, 'support': 652151}, '1': {'precision': 0.2618723869030642, 'recall': 0.47616214325629264, 'f1-score': 0.3379075420237593, 'support': 497486}, '2': {'precision': 0.38175845809970793, 'recall': 0.5124333147427343, 'f1-score': 0.4375476448262472, 'support': 684934}, 'accuracy': 0.3230902483468887, 'macro avg': {'precision': 0.3674156612553232, 'recall': 0.33201846225261916, 'f1-score': 0.26337874661403987, 'support': 1834571}, 'weighted avg': {'precision': 0.3765698724778061, 'recall': 0.3230902483468887, 'f1-score': 0.260207859713531, 'support': 1834571}}
[[  4865 337163 310123]
 [  2323 236884 258279]
 [  3420 330531 350983]]
Evaluating performance on  train set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1226457
{'0': {'precision': 0.3017537231195491, 'recall': 0.07084512976692958, 'f1-score': 0.11474958393697395, 'support': 135281}, '1': {'precision': 0.3286250267445059, 'recall': 0.632858025781388, 'f1-score': 0.43260873938759903, 'support': 135912}, '2': {'precision': 0.3262601430657474, 'recall': 0.2705009731353348, 'f1-score': 0.295775591936592, 'support': 130506}, 'accuracy': 0.32586339522876584, 'macro avg': {'precision': 0.3188796309766008, 'recall': 0.3247347095612174, 'f1-score': 0.28104463842038835, 'support': 401699}, 'weighted avg': {'precision': 0.3188072070957942, 'recall': 0.32586339522876584, 'f1-score': 0.2811076125494512, 'support': 401699}}
[[ 9584 90332 35365]
 [12364 86013 37535]
 [ 9813 85391 35302]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1406348
{'0': {'precision': 0.37440982058545796, 'recall': 0.01760383599351788, 'f1-score': 0.033626629916251455, 'support': 45047}, '1': {'precision': 0.2716900063653724, 'recall': 0.4486047611540281, 'f1-score': 0.33842097960316364, 'support': 38058}, '2': {'precision': 0.32670417160152654, 'recall': 0.46572869035056863, 'f1-score': 0.38402119164322246, 'support': 42645}, 'accuracy': 0.3000159045725646, 'macro avg': {'precision': 0.3242679995174523, 'recall': 0.31064576249937154, 'f1-score': 0.2520229337208792, 'support': 125750}, 'weighted avg': {'precision': 0.327143672748418, 'recall': 0.3000159045725646, 'f1-score': 0.24469970701550542, 'support': 125750}}
[[  793 23783 20471]
 [  525 17073 20460]
 [  800 21984 19861]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1491872
{'0': {'precision': 0.38532821861126676, 'recall': 0.014724459897258187, 'f1-score': 0.028365013944545447, 'support': 607153}, '1': {'precision': 0.24753072441690513, 'recall': 0.5735676074041037, 'f1-score': 0.3458187646001894, 'support': 419281}, '2': {'precision': 0.36157159392057275, 'recall': 0.38064704070846545, 'f1-score': 0.37086419232493995, 'support': 600735}, 'accuracy': 0.2938195110649232, 'macro avg': {'precision': 0.3314768456495816, 'recall': 0.32297970266994247, 'f1-score': 0.24834932362322493, 'support': 1627169}, 'weighted avg': {'precision': 0.34105051476067094, 'recall': 0.2938195110649232, 'f1-score': 0.2366123256577082, 'support': 1627169}}
[[  8940 367527 230686]
 [  5721 240486 173074]
 [  8540 363527 228668]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241336
{'0': {'precision': 0.3220105933976589, 'recall': 0.18538506016134806, 'f1-score': 0.23530336852865502, 'support': 145276}, '1': {'precision': 0.3176568248665157, 'recall': 0.4231449185340915, 'f1-score': 0.3628902671392655, 'support': 146503}, '2': {'precision': 0.3306326495431822, 'recall': 0.36052882573674283, 'f1-score': 0.34493415837957014, 'support': 143639}, 'accuracy': 0.32316073290493275, 'macro avg': {'precision': 0.3234333559357856, 'recall': 0.3230196014773941, 'f1-score': 0.3143759313491636, 'support': 435418}, 'weighted avg': {'precision': 0.32339001127098693, 'recall': 0.32316073290493275, 'f1-score': 0.3143977569796283, 'support': 435418}}
[[26932 68225 50119]
 [29789 61992 54722]
 [26916 64937 51786]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1297842
{'0': {'precision': 0.3389763779527559, 'recall': 0.01724172457296193, 'f1-score': 0.03281437582178859, 'support': 49937}, '1': {'precision': 0.29491895620186226, 'recall': 0.6753241055564086, 'f1-score': 0.41054842473745623, 'support': 45587}, '2': {'precision': 0.31469661468853516, 'recall': 0.24075409498300196, 'f1-score': 0.2728036794060654, 'support': 48535}, 'accuracy': 0.30079342491618016, 'macro avg': {'precision': 0.31619731628105113, 'recall': 0.31110664170412416, 'f1-score': 0.23872215998843674, 'support': 144059}, 'weighted avg': {'precision': 0.3168544418336176, 'recall': 0.30079342491618016, 'f1-score': 0.23320201517359182, 'support': 144059}}
[[  861 37672 11404]
 [  759 30786 14042]
 [  920 35930 11685]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
7459/7459 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1524228
{'0': {'precision': 0.4078778697121548, 'recall': 0.01862202346907015, 'f1-score': 0.03561788119401314, 'support': 751798}, '1': {'precision': 0.19733846389764792, 'recall': 0.5923479564450772, 'f1-score': 0.2960492489336479, 'support': 397567}, '2': {'precision': 0.3965675601124486, 'recall': 0.35568887964773666, 'f1-score': 0.37501751718071213, 'support': 759886}, 'accuracy': 0.2722434085408362, 'macro avg': {'precision': 0.33392796457408375, 'recall': 0.32221961985396136, 'f1-score': 0.23556154910279106, 'support': 1909251}, 'weighted avg': {'precision': 0.3595353176475293, 'recall': 0.2722434085408362, 'f1-score': 0.22492978904140049, 'support': 1909251}}
[[ 14000 481939 255859]
 [  6655 235498 155414]
 [ 13669 475934 270283]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.124203
{'0': {'precision': 0.3864555032801007, 'recall': 0.08291746641074856, 'f1-score': 0.13653922693325216, 'support': 140670}, '1': {'precision': 0.35150343494321123, 'recall': 0.41501589630716557, 'f1-score': 0.38062839946916877, 'support': 147204}, '2': {'precision': 0.3335901143801891, 'recall': 0.536248361563919, 'f1-score': 0.41131119677394273, 'support': 138089}, 'accuracy': 0.3446449574258797, 'macro avg': {'precision': 0.3571830175345003, 'recall': 0.3447272414272777, 'f1-score': 0.3094929410587879, 'support': 425963}, 'weighted avg': {'precision': 0.3572388507650622, 'recall': 0.3446449574258797, 'f1-score': 0.30996717512900673, 'support': 425963}}
[[11664 58554 70452]
 [ 8635 61092 77477]
 [ 9883 54156 74050]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1274146
{'0': {'precision': 0.34125230202578266, 'recall': 0.08250773649175146, 'f1-score': 0.1328863151478208, 'support': 44917}, '1': {'precision': 0.3050871943039934, 'recall': 0.3534235440374868, 'f1-score': 0.327481364154935, 'support': 41828}, '2': {'precision': 0.36070051193368197, 'recall': 0.5784816534965112, 'f1-score': 0.444341121969364, 'support': 45431}, 'accuracy': 0.3387150466045273, 'macro avg': {'precision': 0.335680002754486, 'recall': 0.3381376446752498, 'f1-score': 0.30156960042403996, 'support': 132176}, 'weighted avg': {'precision': 0.3364922661534516, 'recall': 0.3387150466045273, 'f1-score': 0.301519236696204, 'support': 132176}}
[[ 3706 17679 23532]
 [ 3997 14783 23048]
 [ 3157 15993 26281]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
8238/8238 - 115s - 115s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.135686
{'0': {'precision': 0.38259912759853815, 'recall': 0.012963789005545828, 'f1-score': 0.025077853133830114, 'support': 751015}, '1': {'precision': 0.2709575632210746, 'recall': 0.5549721733419775, 'f1-score': 0.36413244635069847, 'support': 593855}, '2': {'precision': 0.36341269291992523, 'recall': 0.4124624923413681, 'f1-score': 0.38638716102193793, 'support': 763844}, 'accuracy': 0.31031519684509135, 'macro avg': {'precision': 0.33898979457984596, 'recall': 0.3267994848962971, 'f1-score': 0.25853248683548885, 'support': 2108714}, 'weighted avg': {'precision': 0.3442087416931811, 'recall': 0.31031519684509135, 'f1-score': 0.2514400873814745, 'support': 2108714}}
[[  9736 447093 294186]
 [  6585 329573 257697]
 [  9126 439661 315057]]
Evaluating performance on  train set...
1806/1806 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.12254
{'0': {'precision': 0.35094564945705004, 'recall': 0.16247091042338996, 'f1-score': 0.2221138297124376, 'support': 155554}, '1': {'precision': 0.3515107006880316, 'recall': 0.44319599679533483, 'f1-score': 0.3920644833345436, 'support': 152278}, '2': {'precision': 0.3458859865154023, 'recall': 0.4440974269589389, 'f1-score': 0.38888683993270595, 'support': 154331}, 'accuracy': 0.3490110631963182, 'macro avg': {'precision': 0.3494474455534946, 'recall': 0.3499214447258879, 'f1-score': 0.334355050993229, 'support': 462163}, 'weighted avg': {'precision': 0.34944224487880376, 'recall': 0.3490110631963182, 'f1-score': 0.3338016780961708, 'support': 462163}}
[[25273 63294 66987]
 [22162 67489 62627]
 [24579 61214 68538]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1126047
{'0': {'precision': 0.3460287081339713, 'recall': 0.33033087899439095, 'f1-score': 0.3379976257910135, 'support': 54733}, '1': {'precision': 0.360807584977978, 'recall': 0.39772074492726767, 'f1-score': 0.37836599060387305, 'support': 53965}, '2': {'precision': 0.36985129121819493, 'recall': 0.34965122968502804, 'f1-score': 0.35946770169115605, 'support': 55624}, 'accuracy': 0.35900244641618284, 'macro avg': {'precision': 0.3588958614433814, 'recall': 0.3592342845355622, 'f1-score': 0.3586104393620142, 'support': 164322}, 'weighted avg': {'precision': 0.3589463299397166, 'recall': 0.35900244641618284, 'f1-score': 0.35852275516501997, 'support': 164322}}
[[18080 19822 16831]
 [16196 21463 16306]
 [17974 18201 19449]]
testing model on single stock: results/universal/W5/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
31315/31315 - 427s - 427s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1569486
{'0': {'precision': 0.3925958620689655, 'recall': 0.011820795949319986, 'f1-score': 0.022950565878296657, 'support': 3009865}, '1': {'precision': 0.21311719098568271, 'recall': 0.5159149507553232, 'f1-score': 0.3016337382050625, 'support': 1903556}, '2': {'precision': 0.37413830260193354, 'recall': 0.4000199802453381, 'f1-score': 0.38664650300040965, 'support': 3103065}, 'accuracy': 0.2817868078357525, 'macro avg': {'precision': 0.32661711855219394, 'recall': 0.30925190898332705, 'f1-score': 0.23707693569458957, 'support': 8016486}, 'weighted avg': {'precision': 0.34283307224058246, 'recall': 0.2817868078357525, 'f1-score': 0.22990672571035758, 'support': 8016486}}
[[  35579 1799603 1174683]
 [  19729  982073  901754]
 [  35317 1826460 1241288]]
Evaluating performance on  train set...
5759/5759 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1399266
{'0': {'precision': 0.33552377403131123, 'recall': 0.20110125658827677, 'f1-score': 0.25147635210020614, 'support': 487988}, '1': {'precision': 0.280748263251628, 'recall': 0.169650118708257, 'f1-score': 0.21149710165707378, 'support': 486908}, '2': {'precision': 0.3338952359596647, 'recall': 0.5934973842123394, 'f1-score': 0.42736149680869545, 'support': 499276}, 'accuracy': 0.3236108133921958, 'macro avg': {'precision': 0.3167224244142013, 'recall': 0.3214162531696244, 'f1-score': 0.29677831685532513, 'support': 1474172}, 'weighted avg': {'precision': 0.31688027491657195, 'recall': 0.3236108133921958, 'f1-score': 0.2978406940051609, 'support': 1474172}}
[[ 98135 107703 282150]
 [ 95312  82604 308992]
 [ 99036 103921 296319]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.138419
{'0': {'precision': 0.2979222663082896, 'recall': 0.11351087751618759, 'f1-score': 0.16438839888257634, 'support': 184555}, '1': {'precision': 0.27839304103694074, 'recall': 0.2812211238384155, 'f1-score': 0.279799936395964, 'support': 172071}, '2': {'precision': 0.3428578077419183, 'recall': 0.5476650700425885, 'f1-score': 0.42171009858561737, 'support': 188314}, 'accuracy': 0.31649722905273975, 'macro avg': {'precision': 0.30639103836238285, 'recall': 0.31413235713239723, 'f1-score': 0.28863281128805257, 'support': 544940}, 'weighted avg': {'precision': 0.3072839909529589, 'recall': 0.31649722905273975, 'f1-score': 0.28975313120052804, 'support': 544940}}
[[ 20949  61750 101856]
 [ 27866  48390  95815]
 [ 21502  63679 103133]]
training model: results/universal/W5/deepOF_L2/h50
Epoch 1/50
9913/9913 - 223s - loss: 2.9585 - accuracy50: 0.4909 - val_loss: 3.2030 - val_accuracy50: 0.4725 - 223s/epoch - 22ms/step
Epoch 2/50
9913/9913 - 218s - loss: 2.8976 - accuracy50: 0.5098 - val_loss: 3.1834 - val_accuracy50: 0.4805 - 218s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 218s - loss: 2.8812 - accuracy50: 0.5139 - val_loss: 3.1792 - val_accuracy50: 0.4821 - 218s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 219s - loss: 2.8722 - accuracy50: 0.5161 - val_loss: 3.1996 - val_accuracy50: 0.4845 - 219s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 219s - loss: 2.8654 - accuracy50: 0.5178 - val_loss: 3.1975 - val_accuracy50: 0.4843 - 219s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 218s - loss: 2.8605 - accuracy50: 0.5190 - val_loss: 3.1957 - val_accuracy50: 0.4846 - 218s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 219s - loss: 2.8560 - accuracy50: 0.5201 - val_loss: 3.1942 - val_accuracy50: 0.4862 - 219s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 218s - loss: 2.8522 - accuracy50: 0.5211 - val_loss: 3.2081 - val_accuracy50: 0.4856 - 218s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 217s - loss: 2.8486 - accuracy50: 0.5221 - val_loss: 3.1920 - val_accuracy50: 0.4865 - 217s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 219s - loss: 2.8458 - accuracy50: 0.5228 - val_loss: 3.2113 - val_accuracy50: 0.4862 - 219s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 221s - loss: 2.8425 - accuracy50: 0.5235 - val_loss: 3.1950 - val_accuracy50: 0.4873 - 221s/epoch - 22ms/step
Epoch 12/50
9913/9913 - 220s - loss: 2.8398 - accuracy50: 0.5242 - val_loss: 3.1929 - val_accuracy50: 0.4880 - 220s/epoch - 22ms/step
Epoch 13/50
9913/9913 - 217s - loss: 2.8377 - accuracy50: 0.5248 - val_loss: 3.1917 - val_accuracy50: 0.4878 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 402s - 402s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082713
{'0': {'precision': 0.47321329688328795, 'recall': 0.5106641786366779, 'f1-score': 0.491225961739084, 'support': 4610341}, '1': {'precision': 0.46448949798353983, 'recall': 0.3623576574896468, 'f1-score': 0.40711593504010213, 'support': 3512215}, '2': {'precision': 0.4787356742507864, 'recall': 0.5200932607547802, 'f1-score': 0.4985582398238036, 'support': 4715810}, 'accuracy': 0.47355520165105125, 'macro avg': {'precision': 0.47214615637253804, 'recall': 0.4643716989603683, 'f1-score': 0.4656333788676632, 'support': 12838366}, 'weighted avg': {'precision': 0.4728552003047003, 'recall': 0.47355520165105125, 'f1-score': 0.47090913426214004, 'support': 12838366}}
[[2354336  756399 1499606]
 [1068599 1272678 1170938]
 [1552276  710873 2452661]]
Evaluating performance on  train set...
9913/9913 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0434647
{'0': {'precision': 0.4582038900019335, 'recall': 0.49627550233824963, 'f1-score': 0.4764804091296805, 'support': 778360}, '1': {'precision': 0.5663028229024055, 'recall': 0.5118525281686908, 'f1-score': 0.5377027184880118, 'support': 980255}, '2': {'precision': 0.45499820542333447, 'recall': 0.47228777599494354, 'f1-score': 0.4634818056720842, 'support': 778411}, 'accuracy': 0.4949342261372174, 'macro avg': {'precision': 0.49316830610922446, 'recall': 0.493471935500628, 'f1-score': 0.4925549777632588, 'support': 2537026}, 'weighted avg': {'precision': 0.49898753957109054, 'recall': 0.4949342261372174, 'f1-score': 0.4961472233223691, 'support': 2537026}}
[[386281 191423 200656]
 [238809 501746 239700]
 [217943 192834 367634]]
Evaluating performance on  val set...
3496/3496 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0679755
{'0': {'precision': 0.4558475078955384, 'recall': 0.49036494890163523, 'f1-score': 0.4724766373775373, 'support': 289931}, '1': {'precision': 0.5423497369976581, 'recall': 0.4656232334652346, 'f1-score': 0.5010662896920721, 'support': 311344}, '2': {'precision': 0.45790930502739385, 'recall': 0.4924421899215544, 'f1-score': 0.4745483374343724, 'support': 292942}, 'accuracy': 0.4824309982923608, 'macro avg': {'precision': 0.4853688499735301, 'recall': 0.4828101240961414, 'f1-score': 0.48269708816799395, 'support': 894217}, 'weighted avg': {'precision': 0.48664085782399014, 'recall': 0.4824309982923608, 'f1-score': 0.48310952029998894, 'support': 894217}}
[[142172  63066  84693]
 [ 80291 144969  86084]
 [ 89422  59263 144257]]
testing model out of sample: results/universal/W5/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0976282
{'0': {'precision': 0.46893386492251066, 'recall': 0.44814512683466257, 'f1-score': 0.45830387188372385, 'support': 1909888}, '1': {'precision': 0.40607633063997356, 'recall': 0.41751215960088106, 'f1-score': 0.41171484977580264, 'support': 1542197}, '2': {'precision': 0.44376544139956614, 'recall': 0.4534136046488332, 'f1-score': 0.4485376453892424, 'support': 1896734}, 'accuracy': 0.4411811280209706, 'macro avg': {'precision': 0.43959187898735014, 'recall': 0.4396902970281256, 'f1-score': 0.43951878901625635, 'support': 5348819}, 'weighted avg': {'precision': 0.4418855566099103, 'recall': 0.4411811280209706, 'f1-score': 0.4414079208389131, 'support': 5348819}}
[[855907 471279 582702]
 [403046 643886 495265]
 [566266 470463 860005]]
Evaluating performance on  train set...
4957/4957 - 43s - 43s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0498958
{'0': {'precision': 0.46972505534636155, 'recall': 0.4205627415665669, 'f1-score': 0.4437865098094651, 'support': 403098}, '1': {'precision': 0.4979301721650476, 'recall': 0.5596166443626269, 'f1-score': 0.5269743291154187, 'support': 462547}, '2': {'precision': 0.4598909647273731, 'recall': 0.4426302784986156, 'f1-score': 0.45109556661217093, 'support': 402695}, 'accuracy': 0.4782802718513963, 'macro avg': {'precision': 0.4758487307462607, 'recall': 0.4742698881426031, 'f1-score': 0.4739521351790183, 'support': 1268340}, 'weighted avg': {'precision': 0.4768887914481318, 'recall': 0.4782802718513963, 'f1-score': 0.47644462741647625, 'support': 1268340}}
[[169528 132093 101477]
 [ 95839 258849 107859]
 [ 95542 128908 178245]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0450586
{'0': {'precision': 0.46541430581435145, 'recall': 0.43549580836618795, 'f1-score': 0.4499582725190531, 'support': 140518}, '1': {'precision': 0.5011486727770503, 'recall': 0.5447423240648492, 'f1-score': 0.5220369876687104, 'support': 154574}, '2': {'precision': 0.4626784199461513, 'recall': 0.4480918430039006, 'f1-score': 0.4552683247260863, 'support': 139978}, 'accuracy': 0.4783621026501482, 'macro avg': {'precision': 0.4764137995125177, 'recall': 0.476109991811646, 'f1-score': 0.47575452830461656, 'support': 435070}, 'weighted avg': {'precision': 0.47722996813727253, 'recall': 0.4783621026501482, 'f1-score': 0.4772752233623179, 'support': 435070}}
[[61195 43017 36306]
 [33835 84203 36536]
 [36455 40800 62723]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1701807
{'0': {'precision': 0.40516570920664796, 'recall': 0.6092237541642508, 'f1-score': 0.48667022546002636, 'support': 101759}, '1': {'precision': 0.27841310179302553, 'recall': 0.08415602150843551, 'f1-score': 0.1292450872229565, 'support': 70298}, '2': {'precision': 0.40117662816695343, 'recall': 0.3922807229643958, 'f1-score': 0.3966788070193312, 'support': 99258}, 'accuracy': 0.3938116211783351, 'macro avg': {'precision': 0.3615851463888757, 'recall': 0.3618868328790274, 'f1-score': 0.3375313732341047, 'support': 271315}, 'weighted avg': {'precision': 0.37086460900282275, 'recall': 0.3938116211783351, 'f1-score': 0.3611384982080275, 'support': 271315}}
[[61994  7837 31928]
 [38190  5916 26192]
 [52825  7496 38937]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.20655
{'0': {'precision': 0.3864242880914257, 'recall': 0.5264328485885372, 'f1-score': 0.44569173109304555, 'support': 23380}, '1': {'precision': 0.4357072897719323, 'recall': 0.1354443042929842, 'f1-score': 0.20664941270157275, 'support': 22991}, '2': {'precision': 0.37874144114770136, 'recall': 0.4986049705970726, 'f1-score': 0.4304852965701262, 'support': 23297}, 'accuracy': 0.3880978354481254, 'macro avg': {'precision': 0.4002910063370198, 'recall': 0.3868273744928647, 'f1-score': 0.36094214678824815, 'support': 69668}, 'weighted avg': {'precision': 0.4001189284770917, 'recall': 0.3880978354481254, 'f1-score': 0.3617208083276611, 'support': 69668}}
[[12308  2044  9028]
 [ 9851  3114 10026]
 [ 9692  1989 11616]]
Evaluating performance on  val set...
96/96 - 1s - 952ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1862941
{'0': {'precision': 0.38691473415042765, 'recall': 0.5286746987951807, 'f1-score': 0.44682042665852045, 'support': 8300}, '1': {'precision': 0.4337704918032787, 'recall': 0.16467513069454817, 'f1-score': 0.23872248285817396, 'support': 8034}, '2': {'precision': 0.3908011869436202, 'recall': 0.48377617240112647, 'f1-score': 0.43234666520763804, 'support': 8167}, 'accuracy': 0.3943512509693482, 'macro avg': {'precision': 0.4038288042991088, 'recall': 0.39237533396361846, 'f1-score': 0.3726298582414442, 'support': 24501}, 'weighted avg': {'precision': 0.40357445485346055, 'recall': 0.3943512509693482, 'f1-score': 0.3737594866862197, 'support': 24501}}
[[4388  895 3017]
 [3569 1323 3142]
 [3384  832 3951]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9278406
{'0': {'precision': 0.5033300912417211, 'recall': 0.3801597962667562, 'f1-score': 0.43315915133107735, 'support': 142932}, '1': {'precision': 0.6276506454952498, 'recall': 0.7045044648748515, 'f1-score': 0.6638606551006486, 'support': 272796}, '2': {'precision': 0.4591546188476839, 'recall': 0.4641918688533731, 'f1-score': 0.4616595036739221, 'support': 143473}, 'accuracy': 0.5599453505984431, 'macro avg': {'precision': 0.5300451185282183, 'recall': 0.5162853766649936, 'f1-score': 0.519559770035216, 'support': 559201}, 'weighted avg': {'precision': 0.5526435981334397, 'recall': 0.5599453505984431, 'f1-score': 0.5530149428514948, 'support': 559201}}
[[ 54337  59027  29568]
 [ 31730 192186  48880]
 [ 21888  54986  66599]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7654157
{'0': {'precision': 0.5341178899556106, 'recall': 0.3922519995451272, 'f1-score': 0.4523221505846356, 'support': 26381}, '1': {'precision': 0.7532921810699589, 'recall': 0.8266398448164379, 'f1-score': 0.7882634460957264, 'support': 97433}, '2': {'precision': 0.49479422856205935, 'recall': 0.4491367763059979, 'f1-score': 0.47086128881260725, 'support': 26876}, 'accuracy': 0.6832636538589156, 'macro avg': {'precision': 0.5940680998625428, 'recall': 0.556009540222521, 'f1-score': 0.570482295164323, 'support': 150690}, 'weighted avg': {'precision': 0.6688179097481065, 'recall': 0.6832636538589156, 'f1-score': 0.6728412701316996, 'support': 150690}}
[[10348 13482  2551]
 [ 7117 80542  9774]
 [ 1909 12896 12071]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8140782
{'0': {'precision': 0.5538461538461539, 'recall': 0.3618556701030928, 'f1-score': 0.4377240841777085, 'support': 11640}, '1': {'precision': 0.6919531015131777, 'recall': 0.842201555115109, 'f1-score': 0.759719987347169, 'support': 32795}, '2': {'precision': 0.5561520762572587, 'recall': 0.41562269712601324, 'f1-score': 0.4757263355201499, 'support': 12213}, 'accuracy': 0.651532269453467, 'macro avg': {'precision': 0.6006504438721968, 'recall': 0.5398933074480717, 'f1-score': 0.5577234690150091, 'support': 56648}, 'weighted avg': {'precision': 0.6342970008159827, 'recall': 0.651532269453467, 'f1-score': 0.6323289623744267, 'support': 56648}}
[[ 4212  6263  1165]
 [ 2289 27620  2886]
 [ 1104  6033  5076]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
2341/2341 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.171795
{'0': {'precision': 0.3982151989741841, 'recall': 0.5111698888719745, 'f1-score': 0.44767749488586417, 'support': 210208}, '1': {'precision': 0.37120760991454316, 'recall': 0.26862656212398495, 'f1-score': 0.3116939621024196, 'support': 178683}, '2': {'precision': 0.4162257231224299, 'recall': 0.39595127075342107, 'f1-score': 0.40583544038623615, 'support': 210387}, 'accuracy': 0.39840274463604536, 'macro avg': {'precision': 0.3952161773370524, 'recall': 0.3919159072497935, 'f1-score': 0.38840229912484, 'support': 599278}, 'weighted avg': {'precision': 0.3964854226567374, 'recall': 0.39840274463604536, 'f1-score': 0.39244274589064415, 'support': 599278}}
[[107452  40955  61801]
 [ 75649  47999  55035]
 [ 86733  40351  83303]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1625689
{'0': {'precision': 0.40341573577448886, 'recall': 0.4824684093759043, 'f1-score': 0.4394149041312512, 'support': 41468}, '1': {'precision': 0.4257300653358842, 'recall': 0.2901567151327281, 'f1-score': 0.34510607168983176, 'support': 40647}, '2': {'precision': 0.40069271566186815, 'recall': 0.44734997704038476, 'f1-score': 0.42273786141689124, 'support': 41377}, 'accuracy': 0.4074029086904415, 'macro avg': {'precision': 0.40994617225741375, 'recall': 0.40665836718300574, 'f1-score': 0.40241961241265806, 'support': 123492}, 'weighted avg': {'precision': 0.4098480564955244, 'recall': 0.4074029086904415, 'f1-score': 0.4027856722082242, 'support': 123492}}
[[20007  8046 13415]
 [14583 11794 14270]
 [15004  7863 18510]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1505536
{'0': {'precision': 0.40508212670978083, 'recall': 0.49176683109845065, 'f1-score': 0.4442352350467583, 'support': 14393}, '1': {'precision': 0.39749188220803944, 'recall': 0.2937039794820882, 'f1-score': 0.33780569036064323, 'support': 12087}, '2': {'precision': 0.41892888263288425, 'recall': 0.4210739068921377, 'f1-score': 0.4199986560043008, 'support': 14843}, 'accuracy': 0.40844081988238995, 'macro avg': {'precision': 0.40716763051690147, 'recall': 0.40218157249089215, 'f1-score': 0.4006798604705675, 'support': 41323}, 'weighted avg': {'precision': 0.40783565653273846, 'recall': 0.40844081988238995, 'f1-score': 0.4043988860559235, 'support': 41323}}
[[7078 2609 4706]
 [4574 3550 3963]
 [5821 2772 6250]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2324371
{'0': {'precision': 0.36898567232180324, 'recall': 0.6569626265483325, 'f1-score': 0.47255752890120706, 'support': 187379}, '1': {'precision': 0.32373928164537985, 'recall': 0.03410289612481445, 'f1-score': 0.06170567797385023, 'support': 158315}, '2': {'precision': 0.34232834050126054, 'recall': 0.3332293940338842, 'f1-score': 0.33771759135984175, 'support': 173178}, 'accuracy': 0.3588707812331365, 'macro avg': {'precision': 0.34501776482281454, 'recall': 0.3414316389023437, 'f1-score': 0.2906602660782997, 'support': 518872}, 'weighted avg': {'precision': 0.34628326064810355, 'recall': 0.3588707812331364, 'f1-score': 0.3021969746930342, 'support': 518872}}
[[123101   6346  57932]
 [ 99981   5399  52935]
 [110538   4932  57708]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2644993
{'0': {'precision': 0.3414798438633459, 'recall': 0.6991407051168712, 'f1-score': 0.45884632790651797, 'support': 28279}, '1': {'precision': 0.3410366457576758, 'recall': 0.03708756686891897, 'f1-score': 0.06689981218832977, 'support': 27853}, '2': {'precision': 0.3471880566629909, 'recall': 0.28851372783984774, 'f1-score': 0.3151431156281881, 'support': 28373}, 'accuracy': 0.3430566238684101, 'macro avg': {'precision': 0.3432348487613375, 'recall': 0.34158066660854597, 'f1-score': 0.2802964185743453, 'support': 84505}, 'weighted avg': {'precision': 0.3432503275616726, 'recall': 0.3430566238684101, 'f1-score': 0.281410938944069, 'support': 84505}}
[[19771  1136  7372]
 [18800  1033  8020]
 [19327   860  8186]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2277211
{'0': {'precision': 0.3673442096817331, 'recall': 0.6608130863603561, 'f1-score': 0.4721959604641168, 'support': 12471}, '1': {'precision': 0.2829736211031175, 'recall': 0.03420950908388094, 'f1-score': 0.061039744805586695, 'support': 10348}, '2': {'precision': 0.3529038112522686, 'recall': 0.32719165404677775, 'f1-score': 0.3395616868942636, 'support': 11886}, 'accuracy': 0.35971761993949, 'macro avg': {'precision': 0.33440721401237306, 'recall': 0.34073808316367166, 'f1-score': 0.2909324640546557, 'support': 34705}, 'weighted avg': {'precision': 0.3372417625892643, 'recall': 0.35971761993949, 'f1-score': 0.30417592025994605, 'support': 34705}}
[[8241  530 3700]
 [6563  354 3431]
 [7630  367 3889]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
2900/2900 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1527593
{'0': {'precision': 0.40423388864807713, 'recall': 0.5659050411796893, 'f1-score': 0.47159842444881284, 'support': 285092}, '1': {'precision': 0.2353001017293998, 'recall': 0.08091373399566221, 'f1-score': 0.1204185755935027, 'support': 171516}, '2': {'precision': 0.4228734257370013, 'recall': 0.42067577735393447, 'f1-score': 0.4217717388443961, 'support': 285745}, 'accuracy': 0.3979494930309435, 'macro avg': {'precision': 0.35413580537149275, 'recall': 0.355831517509762, 'f1-score': 0.3379295796289039, 'support': 742353}, 'weighted avg': {'precision': 0.37237749031511536, 'recall': 0.3979494930309435, 'f1-score': 0.37128133913454664, 'support': 742353}}
[[161335  24274  99483]
 [ 93067  13878  64571]
 [144711  20828 120206]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2432468
{'0': {'precision': 0.3769052613709394, 'recall': 0.5236707325291462, 'f1-score': 0.4383289264939186, 'support': 59356}, '1': {'precision': 0.38610617722518253, 'recall': 0.16307138332277532, 'f1-score': 0.22929876583724995, 'support': 59986}, '2': {'precision': 0.3763288346370956, 'recall': 0.45085822176450396, 'f1-score': 0.4102359868184729, 'support': 58260}, 'accuracy': 0.3779912388374005, 'macro avg': {'precision': 0.3797800910777392, 'recall': 0.3792001125388085, 'f1-score': 0.35928789304988046, 'support': 177602}, 'weighted avg': {'precision': 0.37982382938773473, 'recall': 0.3779912388374005, 'f1-score': 0.3585123822959794, 'support': 177602}}
[[31083  8227 20046]
 [26719  9782 23485]
 [24667  7326 26267]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2483273
{'0': {'precision': 0.37371016824652836, 'recall': 0.5408524855725423, 'f1-score': 0.44200815009411915, 'support': 19754}, '1': {'precision': 0.40724541218978794, 'recall': 0.2002712054615169, 'f1-score': 0.2685013948531486, 'support': 21386}, '2': {'precision': 0.3779697624190065, 'recall': 0.4169412480356871, 'f1-score': 0.3965001928268415, 'support': 19727}, 'accuracy': 0.38102748615834525, 'macro avg': {'precision': 0.3863084476184409, 'recall': 0.38602164635658215, 'f1-score': 0.36900324592470307, 'support': 60867}, 'weighted avg': {'precision': 0.386873520164826, 'recall': 0.38102748615834525, 'f1-score': 0.3662963367864979, 'support': 60867}}
[[10684  3202  5868]
 [ 9435  4283  7668]
 [ 8470  3032  8225]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/EXC
Evaluating performance on  test set...
7167/7167 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9161827
{'0': {'precision': 0.5901264356366239, 'recall': 0.3090919631297223, 'f1-score': 0.4056930746432951, 'support': 517490}, '1': {'precision': 0.5448006106023686, 'recall': 0.817123468680996, 'f1-score': 0.6537359482023068, 'support': 798413}, '2': {'precision': 0.5695917904555303, 'recall': 0.40195271303331837, 'f1-score': 0.47130927028652303, 'support': 518663}, 'accuracy': 0.5564433222898495, 'macro avg': {'precision': 0.5681729455648409, 'recall': 0.509389381614679, 'f1-score': 0.5102460977107084, 'support': 1834566}, 'weighted avg': {'precision': 0.5645948992314815, 'recall': 0.5564433222898495, 'f1-score': 0.5321934827440529, 'support': 1834566}}
[[159952 288787  68751]
 [ 57227 652402  88784]
 [ 53868 256317 208478]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84572005
{'0': {'precision': 0.6082371263161459, 'recall': 0.35631340427008856, 'f1-score': 0.449376231122784, 'support': 100841}, '1': {'precision': 0.6205334732376397, 'recall': 0.8196611791921348, 'f1-score': 0.7063311859185728, 'support': 200578}, '2': {'precision': 0.5589325712520274, 'recall': 0.43297766254487435, 'f1-score': 0.4879581034153358, 'support': 100280}, 'accuracy': 0.6068125636359563, 'macro avg': {'precision': 0.5959010569352711, 'recall': 0.5363174153356992, 'f1-score': 0.5478885068188976, 'support': 401699}, 'weighted avg': {'precision': 0.6020686167878414, 'recall': 0.6068125636359563, 'f1-score': 0.5873116033206905, 'support': 401699}}
[[ 35931  52295  12615]
 [ 14524 164406  21648]
 [  8619  48242  43419]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87500966
{'0': {'precision': 0.5835193935302975, 'recall': 0.32922220594697527, 'f1-score': 0.4209461737273851, 'support': 34135}, '1': {'precision': 0.612820106239594, 'recall': 0.7997827099177401, 'f1-score': 0.6939288519806979, 'support': 57987}, '2': {'precision': 0.5246811410768182, 'recall': 0.4807600808849768, 'f1-score': 0.5017613010350553, 'support': 33628}, 'accuracy': 0.5867355864811133, 'macro avg': {'precision': 0.5736735469489033, 'recall': 0.5365883322498973, 'f1-score': 0.538878775581046, 'support': 125750}, 'weighted avg': {'precision': 0.5812963134059903, 'recall': 0.5867355864811133, 'f1-score': 0.5684380040651758, 'support': 125750}}
[[11238 16202  6695]
 [ 3659 46377  7951]
 [ 4362 13099 16167]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/AAL
Evaluating performance on  test set...
6357/6357 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0805554
{'0': {'precision': 0.5160582916527131, 'recall': 0.3954381121681384, 'f1-score': 0.44776724464175033, 'support': 483221}, '1': {'precision': 0.539984397165542, 'recall': 0.4765698565249292, 'f1-score': 0.5062991684873513, 'support': 663739}, '2': {'precision': 0.3984654975361237, 'recall': 0.5568654155317323, 'f1-score': 0.4645336015516359, 'support': 480204}, 'accuracy': 0.47617265377060947, 'macro avg': {'precision': 0.48483606211812624, 'recall': 0.4762911280749333, 'f1-score': 0.47286667156024587, 'support': 1627164}, 'weighted avg': {'precision': 0.49111437649788964, 'recall': 0.47617265377060947, 'f1-score': 0.47659113224921346, 'support': 1627164}}
[[191084 130890 161247]
 [104980 316318 242441]
 [ 74212 138583 267409]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9498446
{'0': {'precision': 0.5208129380898304, 'recall': 0.4279485818170118, 'f1-score': 0.46983599897554557, 'support': 124314}, '1': {'precision': 0.568191292536125, 'recall': 0.6566984804109982, 'f1-score': 0.6092472427024529, 'support': 184721}, '2': {'precision': 0.49039448966812776, 'recall': 0.46475396216263265, 'f1-score': 0.47723007174253934, 'support': 126383}, 'accuracy': 0.5356760630015296, 'macro avg': {'precision': 0.5264662400980277, 'recall': 0.5164670081302142, 'f1-score': 0.5187711044735126, 'support': 435418}, 'weighted avg': {'precision': 0.532083492464693, 'recall': 0.5356760630015296, 'f1-score': 0.5311257698416766, 'support': 435418}}
[[ 53200  45102  26012]
 [ 28389 121306  35026]
 [ 20559  47087  58737]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9684809
{'0': {'precision': 0.5122173810645313, 'recall': 0.41349398735681353, 'f1-score': 0.4575914578018567, 'support': 42078}, '1': {'precision': 0.5667155425219942, 'recall': 0.6148339630145158, 'f1-score': 0.589794945159752, 'support': 60348}, '2': {'precision': 0.4720398054553197, 'recall': 0.5058970478729793, 'f1-score': 0.4883823393006214, 'support': 41631}, 'accuracy': 0.5245423686457444, 'macro avg': {'precision': 0.516990909680615, 'recall': 0.5114083327481028, 'f1-score': 0.5119229140874101, 'support': 144057}, 'weighted avg': {'precision': 0.5234367067303989, 'recall': 0.5245423686457444, 'f1-score': 0.5218720636922287, 'support': 144057}}
[[17399 14629 10050]
 [ 9738 37104 13506]
 [ 6831 13739 21061]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/WBA
Evaluating performance on  test set...
7458/7458 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0591321
{'0': {'precision': 0.531112715631606, 'recall': 0.34885584619098703, 'f1-score': 0.421109989317575, 'support': 700037}, '1': {'precision': 0.3560493035071725, 'recall': 0.6309573323022583, 'f1-score': 0.45521865924382293, 'support': 478465}, '2': {'precision': 0.5196802223614937, 'recall': 0.42779687551317563, 'f1-score': 0.4692832700461687, 'support': 730744}, 'accuracy': 0.44976550952574995, 'macro avg': {'precision': 0.46894741383342414, 'recall': 0.46920335133547364, 'f1-score': 0.4485373062025222, 'support': 1909246}, 'weighted avg': {'precision': 0.48286542777855196, 'recall': 0.44976550952574995, 'f1-score': 0.4480955849972295, 'support': 1909246}}
[[244212 271130 184695]
 [ 72336 301891 104238]
 [143264 274870 312610]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92773986
{'0': {'precision': 0.5789438187091117, 'recall': 0.3436266542837242, 'f1-score': 0.4312744300083401, 'support': 124903}, '1': {'precision': 0.5507405463657742, 'recall': 0.7802707381445639, 'f1-score': 0.6457146346389602, 'support': 176185}, '2': {'precision': 0.5266355551642159, 'recall': 0.4310699670865599, 'f1-score': 0.4740847079960896, 'support': 124873}, 'accuracy': 0.549864893734403, 'macro avg': {'precision': 0.5521066400797007, 'recall': 0.518322453171616, 'f1-score': 0.51702459088113, 'support': 425961}, 'weighted avg': {'precision': 0.5519439681794793, 'recall': 0.549864893734403, 'f1-score': 0.5325207771997732, 'support': 425961}}
[[ 42920  58185  23798]
 [ 14127 137472  24586]
 [ 17088  53956  53829]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9796331
{'0': {'precision': 0.5499326534539157, 'recall': 0.3293841047390743, 'f1-score': 0.41199959636148714, 'support': 43384}, '1': {'precision': 0.48422025236046545, 'recall': 0.7487777108030272, 'f1-score': 0.5881166764569215, 'support': 44793}, '2': {'precision': 0.5224515220452822, 'recall': 0.4384517478067185, 'f1-score': 0.4767801092409975, 'support': 43998}, 'accuracy': 0.5078191791185928, 'macro avg': {'precision': 0.5188681426198878, 'recall': 0.5055378544496066, 'f1-score': 0.49229879401980203, 'support': 132175}, 'weighted avg': {'precision': 0.5185154383837741, 'recall': 0.5078191791185928, 'f1-score': 0.49324813333434503, 'support': 132175}}
[[14290 18570 10524]
 [ 4144 33540  7109]
 [ 7551 17156 19291]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
8238/8238 - 64s - 64s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0611774
{'0': {'precision': 0.5277534975397489, 'recall': 0.4024647785460121, 'f1-score': 0.45667172958153335, 'support': 829608}, '1': {'precision': 0.329144071198042, 'recall': 0.5676400392173133, 'f1-score': 0.4166785546556303, 'support': 457961}, '2': {'precision': 0.5106848348932537, 'recall': 0.426795674306452, 'f1-score': 0.4649869012261567, 'support': 821140}, 'accuracy': 0.4478114334410296, 'macro avg': {'precision': 0.4558608012103482, 'recall': 0.4656334973565925, 'f1-score': 0.4461123951544401, 'support': 2108709}, 'weighted avg': {'precision': 0.47797368764544035, 'recall': 0.4478114334410296, 'f1-score': 0.4512241337596464, 'support': 2108709}}
[[333888 266911 228809]
 [ 91019 259957 106985]
 [207752 262929 350459]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0157473
{'0': {'precision': 0.5558216228705862, 'recall': 0.3423599430715487, 'f1-score': 0.42372514952320717, 'support': 154580}, '1': {'precision': 0.45757498181581757, 'recall': 0.730249931907498, 'f1-score': 0.5626150713848536, 'support': 154202}, '2': {'precision': 0.5226928582658271, 'recall': 0.41185176492065356, 'f1-score': 0.4606991915574826, 'support': 153378}, 'accuracy': 0.4948437770469102, 'macro avg': {'precision': 0.5120298209840769, 'recall': 0.49482054663323344, 'f1-score': 0.48234647082184773, 'support': 462160}, 'weighted avg': {'precision': 0.5120466267621472, 'recall': 0.4948437770469102, 'f1-score': 0.4823371201611739, 'support': 462160}}
[[ 52922  68784  32874]
 [ 16786 112606  24810]
 [ 25506  64703  63169]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9896822
{'0': {'precision': 0.5401626587680104, 'recall': 0.38431589662993587, 'f1-score': 0.4491031085974267, 'support': 55993}, '1': {'precision': 0.47340491791026185, 'recall': 0.7208786206111648, 'f1-score': 0.5715016128183343, 'support': 52719}, '2': {'precision': 0.5266932090666425, 'recall': 0.4186836899838159, 'f1-score': 0.4665183938446742, 'support': 55610}, 'accuracy': 0.503925219994888, 'macro avg': {'precision': 0.5134202619149716, 'recall': 0.5079594024083055, 'f1-score': 0.4957077050868117, 'support': 164322}, 'weighted avg': {'precision': 0.5141866029862361, 'recall': 0.503925219994888, 'f1-score': 0.49426559905288286, 'support': 164322}}
[[21519 21764 12710]
 [ 6502 38004  8213]
 [11817 20510 23283]]
testing model on single stock: results/universal/W5/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
31315/31315 - 245s - 245s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1275319
{'0': {'precision': 0.4660848048789529, 'recall': 0.578898371691391, 'f1-score': 0.5164020640027264, 'support': 3062503}, '1': {'precision': 0.3240147670088159, 'recall': 0.06644954678626736, 'f1-score': 0.11028221355508133, 'support': 1804226}, '2': {'precision': 0.47047518671767247, 'recall': 0.5739801101801031, 'f1-score': 0.5170990090457538, 'support': 3149752}, 'accuracy': 0.461631855673331, 'macro avg': {'precision': 0.42019158620181374, 'recall': 0.40644267621925384, 'f1-score': 0.3812610955345204, 'support': 8016481}, 'weighted avg': {'precision': 0.435834893207109, 'recall': 0.461631855673331, 'f1-score': 0.42527270322078387, 'support': 8016481}}
[[1772878  130568 1159057]
 [ 808588  119890  875748]
 [1222301  119556 1807895]]
Evaluating performance on  train set...
5759/5759 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1462483
{'0': {'precision': 0.43797517995167556, 'recall': 0.5562178184417901, 'f1-score': 0.4900650065289628, 'support': 497956}, '1': {'precision': 0.4517016931035141, 'recall': 0.24742684115213945, 'f1-score': 0.31972124607005864, 'support': 478206}, '2': {'precision': 0.43073534839281585, 'recall': 0.5015070008774942, 'f1-score': 0.4634348416235018, 'support': 498009}, 'accuracy': 0.4375666052310078, 'macro avg': {'precision': 0.44013740714933514, 'recall': 0.43505055349047456, 'f1-score': 0.4244070314075077, 'support': 1474171}, 'weighted avg': {'precision': 0.4399821382173665, 'recall': 0.4375666052310078, 'f1-score': 0.42581094773360295, 'support': 1474171}}
[[276972  66392 154592]
 [184398 118321 175487]
 [171022  77232 249755]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1497846
{'0': {'precision': 0.44026542139654173, 'recall': 0.5542615280853527, 'f1-score': 0.49073016141697107, 'support': 188301}, '1': {'precision': 0.4569831987834881, 'recall': 0.22345409591285267, 'f1-score': 0.3001445344852786, 'support': 165421}, '2': {'precision': 0.4395295050551774, 'recall': 0.521768462009131, 'f1-score': 0.4771312157470374, 'support': 191217}, 'accuracy': 0.4424403465341992, 'macro avg': {'precision': 0.44559270841173576, 'recall': 0.4331613620024455, 'f1-score': 0.422668637216429, 'support': 544939}, 'weighted avg': {'precision': 0.44508201873694014, 'recall': 0.4424403465341992, 'f1-score': 0.4281044095679839, 'support': 544939}}
[[104368  21377  62556]
 [ 63789  36964  64668]
 [ 68900  22546  99771]]
training model: results/universal/W5/deepOF_L2/h100
Epoch 1/50
9913/9913 - 222s - loss: 3.1189 - accuracy100: 0.4449 - val_loss: 3.3418 - val_accuracy100: 0.3993 - 222s/epoch - 22ms/step
Epoch 2/50
9913/9913 - 219s - loss: 3.0822 - accuracy100: 0.4554 - val_loss: 3.3620 - val_accuracy100: 0.4118 - 219s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 219s - loss: 3.0649 - accuracy100: 0.4610 - val_loss: 3.3688 - val_accuracy100: 0.4188 - 219s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 220s - loss: 3.0553 - accuracy100: 0.4647 - val_loss: 3.3813 - val_accuracy100: 0.4242 - 220s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 218s - loss: 3.0491 - accuracy100: 0.4669 - val_loss: 3.3689 - val_accuracy100: 0.4274 - 218s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 218s - loss: 3.0434 - accuracy100: 0.4688 - val_loss: 3.3796 - val_accuracy100: 0.4285 - 218s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 217s - loss: 3.0391 - accuracy100: 0.4705 - val_loss: 3.3650 - val_accuracy100: 0.4286 - 217s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 219s - loss: 3.0358 - accuracy100: 0.4713 - val_loss: 3.3710 - val_accuracy100: 0.4286 - 219s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 217s - loss: 3.0326 - accuracy100: 0.4721 - val_loss: 3.3848 - val_accuracy100: 0.4296 - 217s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 218s - loss: 3.0300 - accuracy100: 0.4732 - val_loss: 3.3767 - val_accuracy100: 0.4301 - 218s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 220s - loss: 3.0273 - accuracy100: 0.4739 - val_loss: 3.3711 - val_accuracy100: 0.4293 - 220s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 386s - 386s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.103848
{'0': {'precision': 0.4731637501367385, 'recall': 0.30636204224262836, 'f1-score': 0.37191691211296185, 'support': 5068624}, '1': {'precision': 0.24628428272826727, 'recall': 0.41498650923313035, 'f1-score': 0.30911589022475766, 'support': 2585472}, '2': {'precision': 0.47151100727472234, 'recall': 0.47294720375289095, 'f1-score': 0.4722280135330817, 'support': 5184270}, 'accuracy': 0.3955064063448573, 'macro avg': {'precision': 0.3969863467132427, 'recall': 0.3980985850762166, 'f1-score': 0.3844202719569337, 'support': 12838366}, 'weighted avg': {'precision': 0.42680592114224036, 'recall': 0.3955064063448573, 'f1-score': 0.399776341427872, 'support': 12838366}}
[[1552834 1713722 1802068]
 [ 566429 1072936  946107]
 [1162548 1569836 2451886]]
Evaluating performance on  train set...
9913/9913 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1016661
{'0': {'precision': 0.4245741259157782, 'recall': 0.3424953063006682, 'f1-score': 0.37914337137040505, 'support': 832499}, '1': {'precision': 0.3965939512370092, 'recall': 0.48733679589084333, 'f1-score': 0.4373076196150873, 'support': 871225}, '2': {'precision': 0.4238696691407724, 'recall': 0.4043360030337141, 'f1-score': 0.4138724801959462, 'support': 833302}, 'accuracy': 0.4125464224647284, 'macro avg': {'precision': 0.41501258209785324, 'recall': 0.4113893684084086, 'f1-score': 0.4101078237271462, 'support': 2537026}, 'weighted avg': {'precision': 0.41473423743058474, 'recall': 0.4125464224647284, 'f1-score': 0.4105242019253597, 'support': 2537026}}
[[285127 336792 210580]
 [199259 424580 247386]
 [187174 309194 336934]]
Evaluating performance on  val set...
3496/3496 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1124201
{'0': {'precision': 0.42251694639575876, 'recall': 0.31320059958289886, 'f1-score': 0.35973740647725705, 'support': 306880}, '1': {'precision': 0.3582869479411428, 'recall': 0.4754805848774029, 'f1-score': 0.4086474487321387, 'support': 276434}, '2': {'precision': 0.43350862508795157, 'recall': 0.41814006297784195, 'f1-score': 0.42568567611463304, 'support': 310903}, 'accuracy': 0.3998526084831758, 'macro avg': {'precision': 0.4047708398082844, 'recall': 0.4022737491460479, 'f1-score': 0.39802351044134293, 'support': 894217}, 'weighted avg': {'precision': 0.4064827963937296, 'recall': 0.3998526084831758, 'f1-score': 0.3977862396975549, 'support': 894217}}
[[ 96115 123649  87116]
 [ 62231 131439  82764]
 [ 69136 111766 130001]]
testing model out of sample: results/universal/W5/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 162s - 162s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1225293
{'0': {'precision': 0.43049687426609556, 'recall': 0.3002745752663848, 'f1-score': 0.3537830224660757, 'support': 1922970}, '1': {'precision': 0.32425113467184513, 'recall': 0.3571651076893239, 'f1-score': 0.3399132108508561, 'support': 1505581}, '2': {'precision': 0.4106767413398606, 'recall': 0.5023939366796718, 'f1-score': 0.4519288807565854, 'support': 1920268}, 'accuracy': 0.38885051073891264, 'macro avg': {'precision': 0.3884749167592671, 'recall': 0.3866112065451269, 'f1-score': 0.38187503802450573, 'support': 5348819}, 'weighted avg': {'precision': 0.3934753310285984, 'recall': 0.38885051073891264, 'f1-score': 0.3851140931503419, 'support': 5348819}}
[[577419 583706 761845]
 [345291 537741 622549]
 [418575 536962 964731]]
Evaluating performance on  train set...
4957/4957 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1031656
{'0': {'precision': 0.4392715694649375, 'recall': 0.2921012048532135, 'f1-score': 0.35087922111427683, 'support': 426027}, '1': {'precision': 0.3864289876853712, 'recall': 0.4798852558532608, 'f1-score': 0.42811618303085525, 'support': 420065}, '2': {'precision': 0.41427739053497054, 'recall': 0.4546427691783028, 'f1-score': 0.43352250016372373, 'support': 422248}, 'accuracy': 0.40840626330479207, 'macro avg': {'precision': 0.41332598256175973, 'recall': 0.4088764099615924, 'f1-score': 0.4041726347696186, 'support': 1268340}, 'weighted avg': {'precision': 0.41344958073947413, 'recall': 0.40840626330479207, 'f1-score': 0.4039726374691646, 'support': 1268340}}
[[124443 168275 133309]
 [ 80373 201583 138109]
 [ 78478 151798 191972]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1052718
{'0': {'precision': 0.4314055991475346, 'recall': 0.3026908725115037, 'f1-score': 0.35576396905219343, 'support': 147127}, '1': {'precision': 0.38347070257300564, 'recall': 0.4688943585982185, 'f1-score': 0.4219019697431211, 'support': 141791}, '2': {'precision': 0.41546607094400584, 'recall': 0.45046253215830095, 'f1-score': 0.43225711143574674, 'support': 146152}, 'accuracy': 0.4064978049509274, 'macro avg': {'precision': 0.4101141242215154, 'recall': 0.4073492544226744, 'f1-score': 0.4033076834103538, 'support': 435070}, 'weighted avg': {'precision': 0.41042890379689867, 'recall': 0.4064978049509274, 'f1-score': 0.4030147539870508, 'support': 435070}}
[[44534 56193 46400]
 [29079 66485 46227]
 [29617 50699 65836]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1418676
{'0': {'precision': 0.3828019996325627, 'recall': 0.39681855541968203, 'f1-score': 0.3896842778748431, 'support': 99766}, '1': {'precision': 0.2805360950350289, 'recall': 0.09054393775543165, 'f1-score': 0.13690223392508283, 'support': 71203}, '2': {'precision': 0.3827416071490184, 'recall': 0.552737528152592, 'f1-score': 0.45229367897872064, 'support': 100346}, 'accuracy': 0.37410758712198, 'macro avg': {'precision': 0.34869323393887, 'recall': 0.3467000071092352, 'f1-score': 0.32629339692621556, 'support': 271315}, 'weighted avg': {'precision': 0.35594134191289395, 'recall': 0.37410758712198, 'f1-score': 0.3465011257742033, 'support': 271315}}
[[39589  8087 52090]
 [27396  6447 37360]
 [36434  8447 55465]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1736423
{'0': {'precision': 0.37068147947432595, 'recall': 0.34701729167547457, 'f1-score': 0.3584592540833261, 'support': 23653}, '1': {'precision': 0.3662751838059773, 'recall': 0.16687693043894375, 'f1-score': 0.2292887029288703, 'support': 22987}, '2': {'precision': 0.35606714887185575, 'recall': 0.5729112384922703, 'f1-score': 0.43918109187749665, 'support': 23028}, 'accuracy': 0.3622466555664006, 'macro avg': {'precision': 0.3643412707173863, 'recall': 0.3622684868688962, 'f1-score': 0.34230968296323105, 'support': 69668}, 'weighted avg': {'precision': 0.3643970113735908, 'recall': 0.3622466555664006, 'f1-score': 0.34252107617290356, 'support': 69668}}
[[ 8208  3568 11877]
 [ 7169  3836 11982]
 [ 6766  3069 13193]]
Evaluating performance on  val set...
96/96 - 1s - 942ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1372895
{'0': {'precision': 0.4014879107253565, 'recall': 0.36917113214000685, 'f1-score': 0.38465193632691846, 'support': 8771}, '1': {'precision': 0.34615384615384615, 'recall': 0.18667582417582418, 'f1-score': 0.24254863466000356, 'support': 7280}, '2': {'precision': 0.3774580335731415, 'recall': 0.5588165680473373, 'f1-score': 0.45057251908396945, 'support': 8450}, 'accuracy': 0.38035182237459697, 'macro avg': {'precision': 0.3750332634841147, 'recall': 0.37155450812105606, 'f1-score': 0.35925769669029717, 'support': 24501}, 'weighted avg': {'precision': 0.3767589424376616, 'recall': 0.38035182237459697, 'f1-score': 0.36516362516255535, 'support': 24501}}
[[3238 1325 4208]
 [2341 1359 3580]
 [2486 1242 4722]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0231867
{'0': {'precision': 0.5302479972556854, 'recall': 0.28394448076330847, 'f1-score': 0.3698412754263678, 'support': 185089}, '1': {'precision': 0.43691243754739506, 'recall': 0.6245759810786419, 'f1-score': 0.5141554246627399, 'support': 192798}, '2': {'precision': 0.4568349613504049, 'recall': 0.4648069095602105, 'f1-score': 0.460786457877701, 'support': 181314}, 'accuracy': 0.46002778964987545, 'macro avg': {'precision': 0.47466513205116173, 'recall': 0.4577757904673869, 'f1-score': 0.44826105265560284, 'support': 559201}, 'weighted avg': {'precision': 0.4742650493840453, 'recall': 0.46002778964987545, 'f1-score': 0.44908490008986995, 'support': 559201}}
[[ 52555  82666  49868]
 [ 22047 120417  50334]
 [ 24512  72526  84276]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95213145
{'0': {'precision': 0.5397198879551821, 'recall': 0.2602728623531001, 'f1-score': 0.3511892827850178, 'support': 37015}, '1': {'precision': 0.5768383689353604, 'recall': 0.7107721087091122, 'f1-score': 0.636839527156625, 'support': 75909}, '2': {'precision': 0.4376431079224546, 'recall': 0.4554890642376741, 'f1-score': 0.4463877932323023, 'support': 37766}, 'accuracy': 0.5361337845908819, 'macro avg': {'precision': 0.5180671216043323, 'recall': 0.4755113450999621, 'f1-score': 0.47813886772464836, 'support': 150690}, 'weighted avg': {'precision': 0.5328355233524106, 'recall': 0.5361337845908819, 'f1-score': 0.5189422282064557, 'support': 150690}}
[[ 9634 21589  5792]
 [ 5643 53954 16312]
 [ 2573 17991 17202]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9912032
{'0': {'precision': 0.5500580383052814, 'recall': 0.23383913150752528, 'f1-score': 0.3281682825484764, 'support': 16212}, '1': {'precision': 0.48587922349878315, 'recall': 0.7262806141872171, 'f1-score': 0.5822411366757658, 'support': 23641}, '2': {'precision': 0.4865445970314884, 'recall': 0.417683834474546, 'f1-score': 0.4494921987633358, 'support': 16795}, 'accuracy': 0.4938567998870216, 'macro avg': {'precision': 0.5074939529451843, 'recall': 0.45926786005642944, 'f1-score': 0.4533005393291927, 'support': 56648}, 'weighted avg': {'precision': 0.5044437252309667, 'recall': 0.4938567998870216, 'f1-score': 0.47017102787491005, 'support': 56648}}
[[ 3791  9837  2584]
 [ 1652 17170  4819]
 [ 1449  8331  7015]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
2341/2341 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1574972
{'0': {'precision': 0.3870349001205221, 'recall': 0.3619854373123303, 'f1-score': 0.3740913045310227, 'support': 208478}, '1': {'precision': 0.3222038549000193, 'recall': 0.21444088885910387, 'f1-score': 0.25750249803845304, 'support': 179061}, '2': {'precision': 0.38315095398428733, 'recall': 0.5159370734725298, 'f1-score': 0.43973843686035674, 'support': 211739}, 'accuracy': 0.37229466124236166, 'macro avg': {'precision': 0.36412990300160963, 'recall': 0.3641211332146546, 'f1-score': 0.3571107464766108, 'support': 599278}, 'weighted avg': {'precision': 0.3662914477342028, 'recall': 0.37229466124236166, 'f1-score': 0.36244987913732374, 'support': 599278}}
[[ 75466  39268  93744]
 [ 58531  38398  82132]
 [ 60988  41507 109244]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1662108
{'0': {'precision': 0.3770717471504873, 'recall': 0.3317668717600891, 'f1-score': 0.35297149631462293, 'support': 41282}, '1': {'precision': 0.36069325256604406, 'recall': 0.2601519454355688, 'f1-score': 0.3022816369123163, 'support': 41199}, '2': {'precision': 0.36381515969019235, 'recall': 0.509692521518617, 'f1-score': 0.4245729490382467, 'support': 41011}, 'accuracy': 0.36696304214038156, 'macro avg': {'precision': 0.3671933864689079, 'recall': 0.36720377957142497, 'f1-score': 0.35994202742172865, 'support': 123492}, 'weighted avg': {'precision': 0.36720516869424213, 'recall': 0.36696304214038156, 'f1-score': 0.3598389505637476, 'support': 123492}}
[[13696  9831 17755]
 [11684 10718 18797]
 [10942  9166 20903]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1526372
{'0': {'precision': 0.3991532870037543, 'recall': 0.3397239785165545, 'f1-score': 0.3670486264139856, 'support': 14709}, '1': {'precision': 0.31447991261075375, 'recall': 0.2153603191754634, 'f1-score': 0.2556487419832264, 'support': 12031}, '2': {'precision': 0.3800145878920496, 'recall': 0.5358979633820201, 'f1-score': 0.4446910208262205, 'support': 14583}, 'accuracy': 0.37274641240955403, 'macro avg': {'precision': 0.36454926250218583, 'recall': 0.36366075369134593, 'f1-score': 0.3557961297411441, 'support': 41323}, 'weighted avg': {'precision': 0.3677469269508012, 'recall': 0.37274641240955403, 'f1-score': 0.3620152800482125, 'support': 41323}}
[[4997 2807 6905]
 [3595 2591 5845]
 [3927 2841 7815]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2424214
{'0': {'precision': 0.36161064854779873, 'recall': 0.36546569027529957, 'f1-score': 0.3635279494759473, 'support': 177661}, '1': {'precision': 0.4208927628103539, 'recall': 0.01814176419691243, 'f1-score': 0.0347842221300561, 'support': 175672}, '2': {'precision': 0.3318542856712234, 'recall': 0.6650456992007926, 'f1-score': 0.4427691218699979, 'support': 165539}, 'accuracy': 0.34345079325922384, 'macro avg': {'precision': 0.3714525656764587, 'recall': 0.3495510512243349, 'f1-score': 0.2803604311586671, 'support': 518872}, 'weighted avg': {'precision': 0.3721881494006221, 'recall': 0.34345079325922384, 'f1-score': 0.2775075752153037, 'support': 518872}}
[[ 64929   2050 110682]
 [ 61513   3187 110972]
 [ 53113   2335 110091]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2229964
{'0': {'precision': 0.35446284393502836, 'recall': 0.39873913662914945, 'f1-score': 0.37529961950418206, 'support': 28076}, '1': {'precision': 0.3632834165280089, 'recall': 0.023455684870188002, 'f1-score': 0.044066200215285255, 'support': 27925}, '2': {'precision': 0.35699055145836184, 'recall': 0.6402259332023575, 'f1-score': 0.45838513997211855, 'support': 28504}, 'accuracy': 0.3561801076859357, 'macro avg': {'precision': 0.35824560397379973, 'recall': 0.35414025156723167, 'f1-score': 0.2925836532305286, 'support': 84505}, 'weighted avg': {'precision': 0.35823024544859655, 'recall': 0.3561801076859357, 'f1-score': 0.29386747278831454, 'support': 84505}}
[[11195   559 16322]
 [10722   655 16548]
 [ 9666   589 18249]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1955177
{'0': {'precision': 0.38313193179937094, 'recall': 0.37372840303568544, 'f1-score': 0.3783717508582638, 'support': 12386}, '1': {'precision': 0.39893617021276595, 'recall': 0.021393933631263667, 'f1-score': 0.04061005324429203, 'support': 10517}, '2': {'precision': 0.3627090983272134, 'recall': 0.6779359430604982, 'f1-score': 0.4725790732701338, 'support': 11802}, 'accuracy': 0.37040772223022617, 'macro avg': {'precision': 0.3815924001131168, 'recall': 0.3576860932424824, 'f1-score': 0.2971869591242299, 'support': 34705}, 'weighted avg': {'precision': 0.380976129890576, 'recall': 0.37040772223022617, 'f1-score': 0.30805321016668474, 'support': 34705}}
[[4629  193 7564]
 [3798  225 6494]
 [3655  146 8001]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
2900/2900 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1721832
{'0': {'precision': 0.3747808326321213, 'recall': 0.3848042200773376, 'f1-score': 0.3797263926837741, 'support': 262744}, '1': {'precision': 0.3257281553398058, 'recall': 0.055332600329851565, 'f1-score': 0.09459586466165414, 'support': 218280}, '2': {'precision': 0.3699018603818123, 'recall': 0.6164375174588355, 'f1-score': 0.4623588789821349, 'support': 261329}, 'accuracy': 0.3694684334811067, 'macro avg': {'precision': 0.3568036161179131, 'recall': 0.3521914459553415, 'f1-score': 0.31222704544252106, 'support': 742353}, 'weighted avg': {'precision': 0.35863994637104657, 'recall': 0.3694684334811067, 'f1-score': 0.32497612341187243, 'support': 742353}}
[[101105  12738 148901]
 [ 80694  12078 125508]
 [ 87972  12264 161093]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1696774
{'0': {'precision': 0.3828790391396049, 'recall': 0.39170825715274005, 'f1-score': 0.38724332774258685, 'support': 60711}, '1': {'precision': 0.35201100034376076, 'recall': 0.1608713866778383, 'f1-score': 0.22082449771771556, 'support': 57288}, '2': {'precision': 0.36565894076811106, 'recall': 0.5479086623156553, 'f1-score': 0.4386050915635304, 'support': 59603}, 'accuracy': 0.3696692604813009, 'macro avg': {'precision': 0.3668496600838256, 'recall': 0.36682943538207785, 'f1-score': 0.34889097234127764, 'support': 177602}, 'weighted avg': {'precision': 0.3671430804805106, 'recall': 0.3696692604813009, 'f1-score': 0.3507995561327788, 'support': 177602}}
[[23781  8733 28197]
 [19616  9216 28456]
 [18714  8232 32657]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1743286
{'0': {'precision': 0.37215354586857513, 'recall': 0.39097744360902253, 'f1-score': 0.3813333333333333, 'support': 20482}, '1': {'precision': 0.34796351485595595, 'recall': 0.19193026151930262, 'f1-score': 0.24739951200719149, 'support': 20075}, '2': {'precision': 0.3638774932805206, 'recall': 0.5065977351058591, 'f1-score': 0.4235376445889763, 'support': 20310}, 'accuracy': 0.3639081932738594, 'macro avg': {'precision': 0.3613315180016839, 'recall': 0.3631684800780614, 'f1-score': 0.3507568299765003, 'support': 60867}, 'weighted avg': {'precision': 0.36141371146501133, 'recall': 0.3639081932738594, 'f1-score': 0.3512422839712785, 'support': 60867}}
[[ 8008  3625  8849]
 [ 7084  3853  9138]
 [ 6426  3595 10289]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/EXC
Evaluating performance on  test set...
7167/7167 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0606958
{'0': {'precision': 0.5657123174891208, 'recall': 0.2084692268042035, 'f1-score': 0.3046665482789862, 'support': 646033}, '1': {'precision': 0.3520042100608394, 'recall': 0.7253469287089979, 'f1-score': 0.4739869174906286, 'support': 531161}, '2': {'precision': 0.5255141171806677, 'recall': 0.4012887680035049, 'f1-score': 0.45507608149056067, 'support': 657372}, 'accuracy': 0.42721275767674755, 'macro avg': {'precision': 0.48107688157687595, 'recall': 0.4450349745055688, 'f1-score': 0.4112431824200585, 'support': 1834566}, 'weighted avg': {'precision': 0.4894334682229282, 'recall': 0.42721275767674755, 'f1-score': 0.40758538156009155, 'support': 1834566}}
[[134678 376920 134435]
 [ 42139 385276 103746]
 [ 61251 332325 263796]]
Evaluating performance on  train set...
1570/1570 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0217614
{'0': {'precision': 0.6013964373440612, 'recall': 0.23554276191197637, 'f1-score': 0.33850625704223436, 'support': 132010}, '1': {'precision': 0.42316429753154505, 'recall': 0.7319978073453929, 'f1-score': 0.5362976098890352, 'support': 140469}, '2': {'precision': 0.5091580226147089, 'recall': 0.4216452561522984, 'f1-score': 0.46128772806163487, 'support': 129220}, 'accuracy': 0.46901286784383334, 'macro avg': {'precision': 0.5112395858301051, 'recall': 0.4630619418032225, 'f1-score': 0.4453638649976348, 'support': 401699}, 'weighted avg': {'precision': 0.5093993489802584, 'recall': 0.46901286784383334, 'f1-score': 0.4471681537065631, 'support': 401699}}
[[ 31094  76064  24852]
 [  9973 102823  27673]
 [ 10636  64099  54485]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0267143
{'0': {'precision': 0.5816307046018713, 'recall': 0.21244739962336967, 'f1-score': 0.3112185818404741, 'support': 43013}, '1': {'precision': 0.41818886226341995, 'recall': 0.7116103039921865, 'f1-score': 0.5267971729660358, 'support': 40955}, '2': {'precision': 0.4839397243977397, 'recall': 0.4673304293714997, 'f1-score': 0.4754900767076586, 'support': 41782}, 'accuracy': 0.45970576540755465, 'macro avg': {'precision': 0.4945864304210103, 'recall': 0.4637960443290186, 'f1-score': 0.43783527717138954, 'support': 125750}, 'weighted avg': {'precision': 0.4959409615572566, 'recall': 0.45970576540755465, 'f1-score': 0.436010731328252, 'support': 125750}}
[[ 9138 22569 11306]
 [ 2295 29144  9516]
 [ 4278 17978 19526]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/AAL
Evaluating performance on  test set...
6357/6357 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095274
{'0': {'precision': 0.49960967088685865, 'recall': 0.22892351390165339, 'f1-score': 0.31397993619705805, 'support': 564717}, '1': {'precision': 0.36245683660757333, 'recall': 0.5147127501266464, 'f1-score': 0.42537077890963443, 'support': 505344}, '2': {'precision': 0.42405337545675537, 'recall': 0.495362616966701, 'f1-score': 0.45694264953153807, 'support': 557103}, 'accuracy': 0.4089028518330052, 'macro avg': {'precision': 0.42870662765039586, 'recall': 0.4129996269983336, 'f1-score': 0.3987644548794102, 'support': 1627164}, 'weighted avg': {'precision': 0.4311457663640029, 'recall': 0.4089028518330052, 'f1-score': 0.3975213926860924, 'support': 1627164}}
[[129277 245500 189940]
 [ 60359 260107 184878]
 [ 69120 212015 275968]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0481237
{'0': {'precision': 0.4985991442471133, 'recall': 0.2920219704771713, 'f1-score': 0.3683228334524042, 'support': 145650}, '1': {'precision': 0.4044364481085882, 'recall': 0.6127896865381165, 'f1-score': 0.4872751020049775, 'support': 144898}, '2': {'precision': 0.46805495986765516, 'recall': 0.42184717332781113, 'f1-score': 0.44375140685018044, 'support': 144870}, 'accuracy': 0.4419615174384155, 'macro avg': {'precision': 0.45703018407445223, 'recall': 0.4422196101143663, 'f1-score': 0.43311644743585404, 'support': 435418}, 'weighted avg': {'precision': 0.45710126787054617, 'recall': 0.4419615174384155, 'f1-score': 0.4330038600449351, 'support': 435418}}
[[42533 68982 34135]
 [20786 88792 35320]
 [21986 61771 61113]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0648023
{'0': {'precision': 0.48449812463438974, 'recall': 0.28804648022749124, 'f1-score': 0.36129429575838445, 'support': 48881}, '1': {'precision': 0.3953841610058647, 'recall': 0.5955134722928317, 'f1-score': 0.475238988766894, 'support': 47208}, '2': {'precision': 0.4603923176816349, 'recall': 0.4212808539026017, 'f1-score': 0.4399690837243226, 'support': 47968}, 'accuracy': 0.43316881512179206, 'macro avg': {'precision': 0.4467582011072964, 'recall': 0.43494693547430824, 'f1-score': 0.4255007894165337, 'support': 144057}, 'weighted avg': {'precision': 0.4472684215107293, 'recall': 0.43316881512179206, 'f1-score': 0.42483146019118423, 'support': 144057}}
[[14080 23109 11692]
 [ 7102 28113 11993]
 [ 7879 19881 20208]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/WBA
Evaluating performance on  test set...
7458/7458 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097041
{'0': {'precision': 0.4846260008604746, 'recall': 0.2342051151192101, 'f1-score': 0.315795701655457, 'support': 740667}, '1': {'precision': 0.2654480217462949, 'recall': 0.5231977455488509, 'f1-score': 0.35220326361325205, 'support': 409501}, '2': {'precision': 0.4644950536027671, 'recall': 0.45537744474217406, 'f1-score': 0.4598910631322942, 'support': 759078}, 'accuracy': 0.38412284221100895, 'macro avg': {'precision': 0.40485635873651216, 'recall': 0.4042601018034117, 'f1-score': 0.3759633428003344, 'support': 1909246}, 'weighted avg': {'precision': 0.4296123667830839, 'recall': 0.38412284221100895, 'f1-score': 0.38089394034674856, 'support': 1909246}}
[[173468 303194 264005]
 [ 60745 214250 134506]
 [123729 289682 345667]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.04214
{'0': {'precision': 0.537313921151644, 'recall': 0.22870870034467153, 'f1-score': 0.3208478839532101, 'support': 143615}, '1': {'precision': 0.40584213797389684, 'recall': 0.6846718972895863, 'f1-score': 0.509610509578656, 'support': 140200}, '2': {'precision': 0.4773903419895876, 'recall': 0.43091610034753003, 'f1-score': 0.45296427488593255, 'support': 142146}, 'accuracy': 0.44626151220416893, 'macro avg': {'precision': 0.4735154670383761, 'recall': 0.4480988993272626, 'f1-score': 0.42780755613926624, 'support': 425961}, 'weighted avg': {'precision': 0.4740446521690615, 'recall': 0.44626151220416893, 'f1-score': 0.4270649710062743, 'support': 425961}}
[[32846 75858 34911]
 [12065 95991 32144]
 [16219 64674 61253]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0627227
{'0': {'precision': 0.5037575874361692, 'recall': 0.2196525721007415, 'f1-score': 0.3059167702771886, 'support': 47607}, '1': {'precision': 0.3550646633412678, 'recall': 0.6468800928099881, 'f1-score': 0.458476898981989, 'support': 36203}, '2': {'precision': 0.4722173339199296, 'recall': 0.44385402667218027, 'f1-score': 0.4575965893951506, 'support': 48365}, 'accuracy': 0.41871004350293173, 'macro avg': {'precision': 0.44367986156578887, 'recall': 0.43679556386096996, 'f1-score': 0.40733008621810934, 'support': 132175}, 'weighted avg': {'precision': 0.45148919861588815, 'recall': 0.41871004350293173, 'f1-score': 0.4032054314547193, 'support': 132175}}
[[10457 22460 14690]
 [ 3481 23419  9303]
 [ 6820 20078 21467]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
8238/8238 - 67s - 67s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1136318
{'0': {'precision': 0.45062513819763134, 'recall': 0.29510647621830005, 'f1-score': 0.3566494810148055, 'support': 787265}, '1': {'precision': 0.2898760563824006, 'recall': 0.4153280182360874, 'f1-score': 0.3414434271286001, 'support': 531693}, '2': {'precision': 0.4360175378452989, 'recall': 0.4589813751422917, 'f1-score': 0.4472048540000099, 'support': 789751}, 'accuracy': 0.3867935310182676, 'macro avg': {'precision': 0.3921729108084436, 'recall': 0.38980528986555973, 'f1-score': 0.38176592071447185, 'support': 2108709}, 'weighted avg': {'precision': 0.4046228076041543, 'recall': 0.3867935310182676, 'f1-score': 0.3867300867131356, 'support': 2108709}}
[[232327 278045 276893]
 [118895 220827 191971]
 [164344 262926 362481]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026475
{'0': {'precision': 0.4669836238774432, 'recall': 0.2342387756816669, 'f1-score': 0.31198567641083913, 'support': 154731}, '1': {'precision': 0.3770381847897608, 'recall': 0.5778857852992654, 'f1-score': 0.4563400109952782, 'support': 153693}, '2': {'precision': 0.42981702487548834, 'recall': 0.4165257324244159, 'f1-score': 0.42306701286345705, 'support': 153736}, 'accuracy': 0.4091570019041025, 'macro avg': {'precision': 0.42461294451423076, 'recall': 0.4095500978017827, 'f1-score': 0.39713090008985813, 'support': 462160}, 'weighted avg': {'precision': 0.4247085922133708, 'recall': 0.4091570019041025, 'f1-score': 0.3969420791418541, 'support': 462160}}
[[36244 77061 41426]
 [21355 88817 43521]
 [20014 69687 64035]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0983464
{'0': {'precision': 0.4406763884579584, 'recall': 0.2616424729201975, 'f1-score': 0.32833992186235755, 'support': 54284}, '1': {'precision': 0.3865522790921648, 'recall': 0.5526387303657807, 'f1-score': 0.4549101483856536, 'support': 55197}, '2': {'precision': 0.42791327403674384, 'recall': 0.4149450228843384, 'f1-score': 0.4213293834475097, 'support': 54841}, 'accuracy': 0.41055366901571305, 'macro avg': {'precision': 0.4183806471956224, 'recall': 0.40974207539010554, 'f1-score': 0.40152648456517365, 'support': 164322}, 'weighted avg': {'precision': 0.41823611617160883, 'recall': 0.41055366901571305, 'f1-score': 0.4018902185736786, 'support': 164322}}
[[14203 25372 14709]
 [ 8979 30504 15714]
 [ 9048 23037 22756]]
testing model on single stock: results/universal/W5/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
31315/31315 - 243s - 243s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1120074
{'0': {'precision': 0.46818649698800435, 'recall': 0.3395724357927605, 'f1-score': 0.39364028730746686, 'support': 3319174}, '1': {'precision': 0.1609922889002991, 'recall': 0.27390977325790933, 'f1-score': 0.20279214648980462, 'support': 1276340}, '2': {'precision': 0.4792620467645384, 'recall': 0.4815869314144217, 'f1-score': 0.48042167642653405, 'support': 3420967}, 'accuracy': 0.38972149999482314, 'macro avg': {'precision': 0.3694802775509473, 'recall': 0.3650230468216971, 'f1-score': 0.35895137007460187, 'support': 8016481}, 'weighted avg': {'precision': 0.42400312460075845, 'recall': 0.38972149999482314, 'f1-score': 0.4002877367730457, 'support': 8016481}}
[[1127100  948851 1243223]
 [ 379892  349602  546846]
 [ 900382  873092 1647493]]
Evaluating performance on  train set...
5759/5759 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1489977
{'0': {'precision': 0.39319452515194825, 'recall': 0.40726702631038486, 'f1-score': 0.4001070750434243, 'support': 491783}, '1': {'precision': 0.3453268172255984, 'recall': 0.35176548419837195, 'f1-score': 0.3485164154586324, 'support': 486722}, '2': {'precision': 0.396370924753193, 'recall': 0.3750388366359605, 'f1-score': 0.3854099285133768, 'support': 495666}, 'accuracy': 0.3781060677492638, 'macro avg': {'precision': 0.37829742237691316, 'recall': 0.3780237823815724, 'f1-score': 0.37801113967181116, 'support': 1474171}, 'weighted avg': {'precision': 0.3784582203049677, 'recall': 0.3781060677492638, 'f1-score': 0.378131887058861, 'support': 1474171}}
[[200287 163005 128491]
 [160905 171212 154605]
 [148192 161580 185894]]
Evaluating performance on  val set...
2129/2129 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1516174
{'0': {'precision': 0.3949007112441822, 'recall': 0.3612505461947544, 'f1-score': 0.37732688063718056, 'support': 187662}, '1': {'precision': 0.31368814479174667, 'recall': 0.37105585096718713, 'f1-score': 0.33996887077487353, 'support': 165118}, '2': {'precision': 0.4151601827448821, 'recall': 0.38446807071227473, 'f1-score': 0.39922509942936196, 'support': 192159}, 'accuracy': 0.37240865491366926, 'macro avg': {'precision': 0.37458301292693696, 'recall': 0.37225815595807205, 'f1-score': 0.37217361694713874, 'support': 544939}, 'weighted avg': {'precision': 0.3774370744639366, 'recall': 0.37240865491366926, 'f1-score': 0.3737291567679812, 'support': 544939}}
[[67793 68619 51250]
 [51026 61268 52824]
 [52852 65428 73879]]
training model: results/universal/W5/deepOF_L2/h200
Epoch 1/50
9913/9913 - 224s - loss: 3.2301 - accuracy200: 0.4000 - val_loss: 3.3761 - val_accuracy200: 0.3426 - 224s/epoch - 23ms/step
Epoch 2/50
9913/9913 - 222s - loss: 3.2105 - accuracy200: 0.4093 - val_loss: 3.3726 - val_accuracy200: 0.3454 - 222s/epoch - 22ms/step
Epoch 3/50
9913/9913 - 219s - loss: 3.2010 - accuracy200: 0.4146 - val_loss: 3.3744 - val_accuracy200: 0.3458 - 219s/epoch - 22ms/step
Epoch 4/50
9913/9913 - 220s - loss: 3.1943 - accuracy200: 0.4180 - val_loss: 3.3739 - val_accuracy200: 0.3475 - 220s/epoch - 22ms/step
Epoch 5/50
9913/9913 - 218s - loss: 3.1896 - accuracy200: 0.4201 - val_loss: 3.3773 - val_accuracy200: 0.3492 - 218s/epoch - 22ms/step
Epoch 6/50
9913/9913 - 219s - loss: 3.1857 - accuracy200: 0.4218 - val_loss: 3.3732 - val_accuracy200: 0.3538 - 219s/epoch - 22ms/step
Epoch 7/50
9913/9913 - 218s - loss: 3.1826 - accuracy200: 0.4233 - val_loss: 3.3689 - val_accuracy200: 0.3529 - 218s/epoch - 22ms/step
Epoch 8/50
9913/9913 - 218s - loss: 3.1801 - accuracy200: 0.4242 - val_loss: 3.3684 - val_accuracy200: 0.3578 - 218s/epoch - 22ms/step
Epoch 9/50
9913/9913 - 220s - loss: 3.1770 - accuracy200: 0.4258 - val_loss: 3.3601 - val_accuracy200: 0.3650 - 220s/epoch - 22ms/step
Epoch 10/50
9913/9913 - 219s - loss: 3.1746 - accuracy200: 0.4267 - val_loss: 3.3519 - val_accuracy200: 0.3663 - 219s/epoch - 22ms/step
Epoch 11/50
9913/9913 - 219s - loss: 3.1726 - accuracy200: 0.4276 - val_loss: 3.3506 - val_accuracy200: 0.3689 - 219s/epoch - 22ms/step
Epoch 12/50
9913/9913 - 220s - loss: 3.1706 - accuracy200: 0.4286 - val_loss: 3.3472 - val_accuracy200: 0.3713 - 220s/epoch - 22ms/step
Epoch 13/50
9913/9913 - 219s - loss: 3.1686 - accuracy200: 0.4297 - val_loss: 3.3431 - val_accuracy200: 0.3713 - 219s/epoch - 22ms/step
Epoch 14/50
9913/9913 - 217s - loss: 3.1664 - accuracy200: 0.4301 - val_loss: 3.3428 - val_accuracy200: 0.3727 - 217s/epoch - 22ms/step
Epoch 15/50
9913/9913 - 219s - loss: 3.1649 - accuracy200: 0.4312 - val_loss: 3.3346 - val_accuracy200: 0.3747 - 219s/epoch - 22ms/step
Epoch 16/50
9913/9913 - 218s - loss: 3.1628 - accuracy200: 0.4317 - val_loss: 3.3350 - val_accuracy200: 0.3752 - 218s/epoch - 22ms/step
Epoch 17/50
9913/9913 - 221s - loss: 3.1608 - accuracy200: 0.4326 - val_loss: 3.3340 - val_accuracy200: 0.3776 - 221s/epoch - 22ms/step
Epoch 18/50
9913/9913 - 217s - loss: 3.1593 - accuracy200: 0.4334 - val_loss: 3.3378 - val_accuracy200: 0.3770 - 217s/epoch - 22ms/step
Epoch 19/50
9913/9913 - 219s - loss: 3.1574 - accuracy200: 0.4340 - val_loss: 3.3359 - val_accuracy200: 0.3771 - 219s/epoch - 22ms/step
Epoch 20/50
9913/9913 - 218s - loss: 3.1559 - accuracy200: 0.4350 - val_loss: 3.3373 - val_accuracy200: 0.3787 - 218s/epoch - 22ms/step
Epoch 21/50
9913/9913 - 218s - loss: 3.1539 - accuracy200: 0.4358 - val_loss: 3.3374 - val_accuracy200: 0.3791 - 218s/epoch - 22ms/step
Epoch 22/50
9913/9913 - 218s - loss: 3.1517 - accuracy200: 0.4363 - val_loss: 3.3342 - val_accuracy200: 0.3803 - 218s/epoch - 22ms/step
Epoch 23/50
9913/9913 - 217s - loss: 3.1501 - accuracy200: 0.4374 - val_loss: 3.3508 - val_accuracy200: 0.3785 - 217s/epoch - 22ms/step
Epoch 24/50
9913/9913 - 219s - loss: 3.1483 - accuracy200: 0.4381 - val_loss: 3.3438 - val_accuracy200: 0.3781 - 219s/epoch - 22ms/step
Epoch 25/50
9913/9913 - 218s - loss: 3.1463 - accuracy200: 0.4390 - val_loss: 3.3357 - val_accuracy200: 0.3801 - 218s/epoch - 22ms/step
Epoch 26/50
9913/9913 - 220s - loss: 3.1452 - accuracy200: 0.4394 - val_loss: 3.3484 - val_accuracy200: 0.3789 - 220s/epoch - 22ms/step
Epoch 27/50
9913/9913 - 217s - loss: 3.1430 - accuracy200: 0.4402 - val_loss: 3.3490 - val_accuracy200: 0.3799 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W5/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
50152/50152 - 385s - 385s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1120288
{'0': {'precision': 0.41010890152956514, 'recall': 0.4211297714632487, 'f1-score': 0.41554627711043185, 'support': 4798528}, '1': {'precision': 0.24205486037182608, 'recall': 0.16865239967468562, 'f1-score': 0.19879430935799045, 'support': 3116985}, '2': {'precision': 0.41955794957379344, 'recall': 0.48912551319326414, 'f1-score': 0.4516787326021865, 'support': 4922853}, 'accuracy': 0.3859044834833342, 'macro avg': {'precision': 0.35724057049172825, 'recall': 0.35963589477706615, 'f1-score': 0.3553397730235363, 'support': 12838366}, 'weighted avg': {'precision': 0.37293083299916324, 'recall': 0.3859044834833342, 'f1-score': 0.3767767120980391, 'support': 12838366}}
[[2020803  857620 1920105]
 [1180177  525687 1411121]
 [1726499  788461 2407893]]
Evaluating performance on  train set...
9913/9913 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092896
{'0': {'precision': 0.41311433221278765, 'recall': 0.3371218765400279, 'f1-score': 0.3712694142893374, 'support': 838053}, '1': {'precision': 0.37833803764181834, 'recall': 0.3217927166928074, 'f1-score': 0.3477819656035219, 'support': 853074}, '2': {'precision': 0.3878172012590051, 'recall': 0.5169482408656353, 'f1-score': 0.4431677220064699, 'support': 845899}, 'accuracy': 0.39192542764638594, 'macro avg': {'precision': 0.3930898570378704, 'recall': 0.39195427803282357, 'f1-score': 0.38740636729977646, 'support': 2537026}, 'weighted avg': {'precision': 0.39298620956386376, 'recall': 0.39192542764638594, 'f1-score': 0.3873442100539103, 'support': 2537026}}
[[282526 237791 317736]
 [206026 274513 372535]
 [195341 213272 437286]]
Evaluating performance on  val set...
3496/3496 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.110679
{'0': {'precision': 0.3982637223420343, 'recall': 0.3552703779673639, 'f1-score': 0.37554054450634156, 'support': 306164}, '1': {'precision': 0.3420946418641362, 'recall': 0.2729872100430149, 'f1-score': 0.3036586482387456, 'support': 279438}, '2': {'precision': 0.3842699112821389, 'recall': 0.4957114851838051, 'f1-score': 0.43293417155890995, 'support': 308615}, 'accuracy': 0.37802681004722566, 'macro avg': {'precision': 0.37487609182943643, 'recall': 0.3746563577313946, 'f1-score': 0.37071112143466567, 'support': 894217}, 'weighted avg': {'precision': 0.3758815986395856, 'recall': 0.37802681004722566, 'f1-score': 0.37288570891677425, 'support': 894217}}
[[108771  77277 120116]
 [ 78139  76283 125016]
 [ 86203  69428 152984]]
testing model out of sample: results/universal/W5/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 161s - 161s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1186016
{'0': {'precision': 0.40510055039467013, 'recall': 0.35840546331151085, 'f1-score': 0.38032509985657603, 'support': 1929965}, '1': {'precision': 0.29473322096268206, 'recall': 0.24489098424232666, 'f1-score': 0.2675102705707628, 'support': 1465889}, '2': {'precision': 0.39409051369111187, 'recall': 0.48900466726234215, 'f1-score': 0.43644695311484233, 'support': 1952965}, 'accuracy': 0.37498034612874354, 'macro avg': {'precision': 0.36464142834948804, 'recall': 0.3641003716053932, 'f1-score': 0.36142744118072706, 'support': 5348819}, 'weighted avg': {'precision': 0.37083345881716634, 'recall': 0.37498034612874354, 'f1-score': 0.369898498743616, 'support': 5348819}}
[[691710 437571 800684]
 [439275 358983 667631]
 [576517 421439 955009]]
Evaluating performance on  train set...
4957/4957 - 43s - 43s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1040525
{'0': {'precision': 0.40183879399428607, 'recall': 0.31015675216642663, 'f1-score': 0.3500949294185871, 'support': 426278}, '1': {'precision': 0.3733258555996208, 'recall': 0.33253247062181834, 'f1-score': 0.3517503853049414, 'support': 420380}, '2': {'precision': 0.3759079442354503, 'recall': 0.5035571829008589, 'f1-score': 0.4304687919704589, 'support': 421682}, 'accuracy': 0.38187236860778656, 'macro avg': {'precision': 0.3836908646097857, 'recall': 0.3820821352297013, 'f1-score': 0.3774380355646625, 'support': 1268340}, 'weighted avg': {'precision': 0.38376726614658374, 'recall': 0.38187236860778656, 'f1-score': 0.37736532351961993, 'support': 1268340}}
[[132213 123075 170990]
 [ 99046 139790 181544]
 [ 97761 111580 212341]]
Evaluating performance on  val set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029346
{'0': {'precision': 0.40255852628885763, 'recall': 0.3176553719842525, 'f1-score': 0.35510250141056987, 'support': 148595}, '1': {'precision': 0.3658232756131566, 'recall': 0.3189963384192618, 'f1-score': 0.34080882918056477, 'support': 139011}, '2': {'precision': 0.3775470757586547, 'recall': 0.5033431888460912, 'f1-score': 0.4314629340060803, 'support': 147464}, 'accuracy': 0.3810214448249707, 'macro avg': {'precision': 0.3819762925535563, 'recall': 0.37999829974986854, 'f1-score': 0.37579142153240497, 'support': 435070}, 'weighted avg': {'precision': 0.38234363564444246, 'recall': 0.3810214448249707, 'f1-score': 0.3764173177893114, 'support': 435070}}
[[47202 40040 61353]
 [33647 44344 61020]
 [36406 36833 74225]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1261039
{'0': {'precision': 0.35315307797157086, 'recall': 0.5572295436340294, 'f1-score': 0.4323178492225311, 'support': 91133}, '1': {'precision': 0.2871179845839387, 'recall': 0.14445366802542403, 'f1-score': 0.19220560840106168, 'support': 80711}, '2': {'precision': 0.3818229933726068, 'recall': 0.3336148224105518, 'f1-score': 0.35609470820836664, 'support': 99471}, 'accuracy': 0.3524537898752373, 'macro avg': {'precision': 0.3406980186427055, 'recall': 0.34509934469000175, 'f1-score': 0.3268727219439865, 'support': 271315}, 'weighted avg': {'precision': 0.3440200286836482, 'recall': 0.3524537898752373, 'f1-score': 0.33294372273206224, 'support': 271315}}
[[50782 13746 26605]
 [41930 11659 27122]
 [51084 15202 33185]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1220038
{'0': {'precision': 0.3730642890661661, 'recall': 0.42453992770292476, 'f1-score': 0.3971410455934059, 'support': 24344}, '1': {'precision': 0.3208961049098431, 'recall': 0.18574074910766727, 'f1-score': 0.2352907509157509, 'support': 22133}, '2': {'precision': 0.35206146669410715, 'recall': 0.44258548574878187, 'f1-score': 0.39216735122743335, 'support': 23191}, 'accuracy': 0.35468220703909975, 'macro avg': {'precision': 0.34867395355670544, 'recall': 0.3509553875197913, 'f1-score': 0.34153304924553, 'support': 69668}, 'weighted avg': {'precision': 0.3494994548013341, 'recall': 0.35468220703909975, 'f1-score': 0.34406678598868345, 'support': 69668}}
[[10335  4398  9611]
 [ 8743  4111  9279]
 [ 8625  4302 10264]]
Evaluating performance on  val set...
96/96 - 1s - 968ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211721
{'0': {'precision': 0.38979777323335607, 'recall': 0.3818161584687291, 'f1-score': 0.3857656847312796, 'support': 8986}, '1': {'precision': 0.2990596892886345, 'recall': 0.20831553467179267, 'f1-score': 0.24557280738564832, 'support': 7023}, '2': {'precision': 0.3605070787452577, 'recall': 0.4587847385774847, 'f1-score': 0.40375148971449304, 'support': 8492}, 'accuracy': 0.3587608669033917, 'macro avg': {'precision': 0.3497881804224161, 'recall': 0.3496388105726688, 'f1-score': 0.345029993943807, 'support': 24501}, 'weighted avg': {'precision': 0.35363638630479355, 'recall': 0.3587608669033917, 'f1-score': 0.35181445328436234, 'support': 24501}}
[[3431 1736 3819]
 [2468 1463 3092]
 [2903 1693 3896]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1515431
{'0': {'precision': 0.4917931938339738, 'recall': 0.25157229836043143, 'f1-score': 0.33286867735978853, 'support': 219265}, '1': {'precision': 0.20971031327309647, 'recall': 0.38157045593882094, 'f1-score': 0.2706641718023106, 'support': 123964}, '2': {'precision': 0.44130953025952213, 'recall': 0.45257255570166505, 'f1-score': 0.4468700852199993, 'support': 215972}, 'accuracy': 0.3580197460304971, 'macro avg': {'precision': 0.38093767912219745, 'recall': 0.3619051033336391, 'f1-score': 0.35013431146069945, 'support': 559201}, 'weighted avg': {'precision': 0.4097633333806662, 'recall': 0.3580197460304971, 'f1-score': 0.36310823832527006, 'support': 559201}}
[[55161 94048 70056]
 [22978 47301 53685]
 [34024 84205 97743]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0893185
{'0': {'precision': 0.4763823595254085, 'recall': 0.32055779121564915, 'f1-score': 0.3832359978388948, 'support': 46469}, '1': {'precision': 0.33881309816009286, 'recall': 0.3233990774036541, 'f1-score': 0.3309266951003076, 'support': 55062}, '2': {'precision': 0.3929767887054319, 'recall': 0.5345104660387722, 'f1-score': 0.4529446747627625, 'support': 49159}, 'accuracy': 0.3913929258743115, 'macro avg': {'precision': 0.4027240821303111, 'recall': 0.39282244488602513, 'f1-score': 0.38903578923398835, 'support': 150690}, 'weighted avg': {'precision': 0.3989055984580766, 'recall': 0.3913929258743115, 'f1-score': 0.3868630070731395, 'support': 150690}}
[[14896 18006 13567]
 [10234 17807 27021]
 [ 6139 16744 26276]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1259605
{'0': {'precision': 0.45823835884076847, 'recall': 0.28713527851458887, 'f1-score': 0.35304816859006527, 'support': 19604}, '1': {'precision': 0.26000188270733315, 'recall': 0.33363532040828653, 'f1-score': 0.292251937676904, 'support': 16557}, '2': {'precision': 0.4150012976901116, 'recall': 0.46829696880948896, 'f1-score': 0.4400412796697627, 'support': 20487}, 'accuracy': 0.366244174551617, 'macro avg': {'precision': 0.377747179746071, 'recall': 0.36302252257745476, 'f1-score': 0.3617804619789107, 'support': 56648}, 'weighted avg': {'precision': 0.3846611980030549, 'recall': 0.366244174551617, 'f1-score': 0.36674017309967816, 'support': 56648}}
[[5629 8009 5966]
 [3475 5524 7558]
 [3180 7713 9594]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1274983
{'0': {'precision': 0.3737879986192251, 'recall': 0.3936224548487289, 'f1-score': 0.3834489065000381, 'support': 217325}, '1': {'precision': 0.2785794216384946, 'recall': 0.24820764432316844, 'f1-score': 0.262517994345873, 'support': 152453}, '2': {'precision': 0.40313058157032083, 'recall': 0.4120697167755991, 'f1-score': 0.40755113782054736, 'support': 229500}, 'accuracy': 0.36369431215562725, 'macro avg': {'precision': 0.3518326672760135, 'recall': 0.3512999386491655, 'f1-score': 0.35117267955548614, 'support': 599278}, 'weighted avg': {'precision': 0.3608045245067651, 'recall': 0.36369431215562725, 'f1-score': 0.36191496355105274, 'support': 599278}}
[[85544 50476 81305]
 [55899 37840 58714]
 [87414 47516 94570]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.118705
{'0': {'precision': 0.3705573454425531, 'recall': 0.35344931884724273, 'f1-score': 0.3618012037748, 'support': 41327}, '1': {'precision': 0.35750045678786774, 'recall': 0.24019740234231138, 'f1-score': 0.28733809146180284, 'support': 40729}, '2': {'precision': 0.3445898285956126, 'recall': 0.47159474852785016, 'f1-score': 0.3982107923051842, 'support': 41436}, 'accuracy': 0.35573964305380107, 'macro avg': {'precision': 0.35754921027534453, 'recall': 0.3550804899058014, 'f1-score': 0.3491166958472623, 'support': 123492}, 'weighted avg': {'precision': 0.3575380077843525, 'recall': 0.35573964305380107, 'f1-score': 0.34945918655059877, 'support': 123492}}
[[14607  8882 17838]
 [11617  9783 19329]
 [13195  8700 19541]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117993
{'0': {'precision': 0.39754275039517173, 'recall': 0.3653350940904589, 'f1-score': 0.38075904070467603, 'support': 15145}, '1': {'precision': 0.318200325732899, 'recall': 0.2759290316885868, 'f1-score': 0.2955609133456247, 'support': 11329}, '2': {'precision': 0.37068426141857685, 'recall': 0.43888477338541315, 'f1-score': 0.4019118100524206, 'support': 14849}, 'accuracy': 0.3672531035984803, 'macro avg': {'precision': 0.3621424458488825, 'recall': 0.3600496330548196, 'f1-score': 0.3594105880342404, 'support': 41323}, 'weighted avg': {'precision': 0.36613912452550246, 'recall': 0.3672531035984803, 'f1-score': 0.36500238913518607, 'support': 41323}}
[[5533 3394 6218]
 [3357 3126 4846]
 [5028 3304 6517]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
2027/2027 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.13594
{'0': {'precision': 0.3316531769495468, 'recall': 0.45494270380040613, 'f1-score': 0.3836358586103119, 'support': 165456}, '1': {'precision': 0.4011059341559572, 'recall': 0.2014782962044719, 'f1-score': 0.26822520782831394, 'support': 194413}, '2': {'precision': 0.31161777878447805, 'recall': 0.3807035087388288, 'f1-score': 0.34271366172503304, 'support': 159003}, 'accuracy': 0.33722382398741885, 'macro avg': {'precision': 0.34812562996332735, 'recall': 0.3457081695812356, 'f1-score': 0.3315249093878863, 'support': 518872}, 'weighted avg': {'precision': 0.35153636677734523, 'recall': 0.33722382398741885, 'f1-score': 0.32785315512692764, 'support': 518872}}
[[75273 29601 60582]
 [82104 39170 73139]
 [69586 28884 60533]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1329718
{'0': {'precision': 0.3339052211814894, 'recall': 0.5176665109090256, 'f1-score': 0.40595887418431925, 'support': 27821}, '1': {'precision': 0.3436696303916526, 'recall': 0.16776669775450176, 'f1-score': 0.22546821896015617, 'support': 27878}, '2': {'precision': 0.34915718196225326, 'recall': 0.3365271124071374, 'f1-score': 0.34272582640975785, 'support': 28806}, 'accuracy': 0.34048872847760486, 'macro avg': {'precision': 0.3422440111784651, 'recall': 0.3406534403568882, 'f1-score': 0.3247176398514111, 'support': 84505}, 'weighted avg': {'precision': 0.3423255534956911, 'recall': 0.34048872847760486, 'f1-score': 0.3248605999930497, 'support': 84505}}
[[14402  4521  8898]
 [14029  4677  9172]
 [14701  4411  9694]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1396079
{'0': {'precision': 0.33630006357279085, 'recall': 0.43918638439186386, 'f1-score': 0.3809180918091809, 'support': 12045}, '1': {'precision': 0.31387493504243896, 'recall': 0.1668047500690417, 'f1-score': 0.21784082712190433, 'support': 10863}, '2': {'precision': 0.3237388274503863, 'recall': 0.3622954988556413, 'f1-score': 0.3419336773470939, 'support': 11797}, 'accuracy': 0.32779138452672524, 'macro avg': {'precision': 0.3246379420218721, 'recall': 0.3227622111055156, 'f1-score': 0.31356419875939306, 'support': 34705}, 'weighted avg': {'precision': 0.32501093884260157, 'recall': 0.32779138452672524, 'f1-score': 0.3166216658271286, 'support': 34705}}
[[5290 2114 4641]
 [4764 1812 4287]
 [5676 1847 4274]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
2900/2900 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232773
{'0': {'precision': 0.367126917792864, 'recall': 0.4850386943412848, 'f1-score': 0.4179252444083812, 'support': 263346}, '1': {'precision': 0.30618967446432493, 'recall': 0.13333879803817097, 'f1-score': 0.18577619298390322, 'support': 219591}, '2': {'precision': 0.3558400267737617, 'recall': 0.40986292287291454, 'f1-score': 0.38094572710205366, 'support': 259416}, 'accuracy': 0.354734203269873, 'macro avg': {'precision': 0.34305220634365013, 'recall': 0.3427468050841234, 'f1-score': 0.3282157214981127, 'support': 742353}, 'weighted avg': {'precision': 0.3451572210039123, 'recall': 0.354734203269873, 'f1-score': 0.336332092884927, 'support': 742353}}
[[127733  33124 102489]
 [100325  29280  89986]
 [119868  33223 106325]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211612
{'0': {'precision': 0.36195089581950896, 'recall': 0.4555598242771477, 'f1-score': 0.40339602268945474, 'support': 59867}, '1': {'precision': 0.3566760353526802, 'recall': 0.17954793399699986, 'f1-score': 0.23885707806564999, 'support': 58664}, '2': {'precision': 0.3424320347629983, 'recall': 0.42156049499754533, 'f1-score': 0.37789850673789005, 'support': 59071}, 'accuracy': 0.3530816094413351, 'macro avg': {'precision': 0.35368632197839583, 'recall': 0.3522227510905643, 'f1-score': 0.34005053583099826, 'support': 177602}, 'weighted avg': {'precision': 0.35371651188298137, 'recall': 0.3530816094413351, 'f1-score': 0.3405663450271212, 'support': 177602}}
[[27273  9550 23044]
 [23356 10533 24775]
 [24721  9448 24902]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1127117
{'0': {'precision': 0.3543785711391174, 'recall': 0.4405541561712846, 'f1-score': 0.3927953825768634, 'support': 19850}, '1': {'precision': 0.3982599881746769, 'recall': 0.2241395702605058, 'f1-score': 0.2868441064638783, 'support': 21036}, '2': {'precision': 0.3402735000615991, 'recall': 0.4146939592612982, 'f1-score': 0.37381575385725885, 'support': 19981}, 'accuracy': 0.3572707706967651, 'macro avg': {'precision': 0.3643040197917978, 'recall': 0.35979589523102956, 'f1-score': 0.3511517476326669, 'support': 60867}, 'weighted avg': {'precision': 0.36491393617370327, 'recall': 0.3572707706967651, 'f1-score': 0.3499474846065483, 'support': 60867}}
[[8745 3567 7538]
 [7794 4715 8527]
 [8138 3557 8286]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/EXC
Evaluating performance on  test set...
7167/7167 - 57s - 57s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.155493
{'0': {'precision': 0.4629678729403244, 'recall': 0.21955531702829104, 'f1-score': 0.29785671640549105, 'support': 652150}, '1': {'precision': 0.2515489629824101, 'recall': 0.385197543644532, 'f1-score': 0.30434730819472955, 'support': 497485}, '2': {'precision': 0.43669367408257304, 'recall': 0.4867833402196718, 'f1-score': 0.4603800680049019, 'support': 684931}, 'accuracy': 0.36424200601123097, 'macro avg': {'precision': 0.3837368366684359, 'recall': 0.3638454002974983, 'f1-score': 0.3541946975350408, 'support': 1834566}, 'weighted avg': {'precision': 0.3958273341326437, 'recall': 0.36424200601123097, 'f1-score': 0.36029451029821846, 'support': 1834566}}
[[143183 299404 209563]
 [ 85337 191630 220518]
 [ 80752 270766 333413]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097424
{'0': {'precision': 0.4755971348421712, 'recall': 0.2582617890868218, 'f1-score': 0.33474708264443004, 'support': 135231}, '1': {'precision': 0.36201060072826635, 'recall': 0.4364278098459502, 'f1-score': 0.39575123522233996, 'support': 135995}, '2': {'precision': 0.40776805384812004, 'recall': 0.5135315352601688, 'f1-score': 0.4545790689548725, 'support': 130473}, 'accuracy': 0.4014921620417278, 'macro avg': {'precision': 0.4151252631395192, 'recall': 0.40274037806431356, 'f1-score': 0.3950257956072141, 'support': 401699}, 'weighted avg': {'precision': 0.41511138707740874, 'recall': 0.4014921620417278, 'f1-score': 0.39432178529421313, 'support': 401699}}
[[34925 56870 43436]
 [22767 59352 53876]
 [15742 47729 67002]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1307217
{'0': {'precision': 0.4716997012161764, 'recall': 0.24876825425007768, 'f1-score': 0.3257435957047994, 'support': 45058}, '1': {'precision': 0.3013415668282925, 'recall': 0.3643078702486725, 'f1-score': 0.3298466078802375, 'support': 38042}, '2': {'precision': 0.39079577112650904, 'recall': 0.5130832356389214, 'f1-score': 0.44366725462765844, 'support': 42650}, 'accuracy': 0.37336779324055663, 'macro avg': {'precision': 0.38794567972365934, 'recall': 0.3753864533792239, 'f1-score': 0.36641915273756515, 'support': 125750}, 'weighted avg': {'precision': 0.39272302712704565, 'recall': 0.37336779324055663, 'f1-score': 0.36698042148800375, 'support': 125750}}
[[11209 17583 16266]
 [ 6336 13859 17847]
 [ 6218 14549 21883]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/AAL
Evaluating performance on  test set...
6357/6357 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1195213
{'0': {'precision': 0.4607687123226121, 'recall': 0.32428889071893274, 'f1-score': 0.38066550535447413, 'support': 607150}, '1': {'precision': 0.2133524369888469, 'recall': 0.139930356802137, 'f1-score': 0.16901181239026258, 'support': 419280}, '2': {'precision': 0.4007185944698717, 'recall': 0.6169269593530581, 'f1-score': 0.48585502705501793, 'support': 600734}, 'accuracy': 0.38482353346067144, 'macro avg': {'precision': 0.3582799145937769, 'recall': 0.3603820689580426, 'f1-score': 0.34517744826658486, 'support': 1627164}, 'weighted avg': {'precision': 0.37484569324150574, 'recall': 0.38482353346067144, 'f1-score': 0.3649625778949309, 'support': 1627164}}
[[196892 111514 298744]
 [105102  58670 255508]
 [125318 104807 370609]]
Evaluating performance on  train set...
1701/1701 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0899869
{'0': {'precision': 0.43035398230088495, 'recall': 0.30134260534288076, 'f1-score': 0.3544747711994817, 'support': 145240}, '1': {'precision': 0.37679019290720295, 'recall': 0.3290551052157537, 'f1-score': 0.3513085286565044, 'support': 146556}, '2': {'precision': 0.3889825936061518, 'recall': 0.55719179512888, 'f1-score': 0.4581352278940091, 'support': 143622}, 'accuracy': 0.3950617567486875, 'macro avg': {'precision': 0.39870892293807986, 'recall': 0.39586316856250486, 'f1-score': 0.38797284258333176, 'support': 435418}, 'weighted avg': {'precision': 0.39867881888206574, 'recall': 0.3950617567486875, 'f1-score': 0.3876013076983238, 'support': 435418}}
[[43767 42558 58915]
 [31542 48225 66789]
 [26391 37206 80025]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998298
{'0': {'precision': 0.442870819715427, 'recall': 0.2687945820309369, 'f1-score': 0.3345428247235003, 'support': 49908}, '1': {'precision': 0.3475609756097561, 'recall': 0.2934346864115315, 'f1-score': 0.3182125930941097, 'support': 45649}, '2': {'precision': 0.3877249887007152, 'recall': 0.601381443298969, 'f1-score': 0.4714772966070187, 'support': 48500}, 'accuracy': 0.38857535558841294, 'macro avg': {'precision': 0.3927189280086328, 'recall': 0.3878702372471458, 'f1-score': 0.3747442381415429, 'support': 144057}, 'weighted avg': {'precision': 0.39410281900880884, 'recall': 0.38857535558841294, 'f1-score': 0.3754701183829587, 'support': 144057}}
[[13415 13833 22660]
 [ 8855 13395 23399]
 [ 8021 11312 29167]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/WBA
Evaluating performance on  test set...
7458/7458 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1461014
{'0': {'precision': 0.46627887766399456, 'recall': 0.25152834013482384, 'f1-score': 0.3267795286272091, 'support': 751796}, '1': {'precision': 0.20153475905484478, 'recall': 0.3037374832418184, 'f1-score': 0.2422997163779447, 'support': 397567}, '2': {'precision': 0.42948667631454135, 'recall': 0.5112339662816513, 'f1-score': 0.46680845950492666, 'support': 759883}, 'accuracy': 0.3657632384721508, 'macro avg': {'precision': 0.3657667710111269, 'recall': 0.35549992988609785, 'f1-score': 0.34529590150336015, 'support': 1909246}, 'weighted avg': {'precision': 0.39650720165099756, 'recall': 0.3657632384721508, 'f1-score': 0.3649198303827971, 'support': 1909246}}
[[189098 245896 316802]
 [ 77574 120756 199237]
 [138875 232530 388478]]
Evaluating performance on  train set...
1664/1664 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0778112
{'0': {'precision': 0.46188541394863386, 'recall': 0.26420981555847756, 'f1-score': 0.3361395449777552, 'support': 140695}, '1': {'precision': 0.4005341298872252, 'recall': 0.4300819527310782, 'f1-score': 0.41478248332088136, 'support': 147158}, '2': {'precision': 0.39888833175082417, 'recall': 0.5414458250065166, 'f1-score': 0.45936100548569603, 'support': 138108}, 'accuracy': 0.41140151328408, 'macro avg': {'precision': 0.42043595852889437, 'recall': 0.4119125310986908, 'f1-score': 0.4034276779281109, 'support': 425961}, 'weighted avg': {'precision': 0.42026485880841236, 'recall': 0.41140151328408, 'f1-score': 0.40326026022757494, 'support': 425961}}
[[37173 51129 52393]
 [23573 63290 60295]
 [19735 43595 74778]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978153
{'0': {'precision': 0.42615200056453323, 'recall': 0.26908167357305174, 'f1-score': 0.3298738187578522, 'support': 44886}, '1': {'precision': 0.36773635826937673, 'recall': 0.4161834538382609, 'f1-score': 0.3904628644987967, 'support': 41907}, '2': {'precision': 0.40012410247318503, 'recall': 0.4973117094883434, 'f1-score': 0.4434554510890389, 'support': 45382}, 'accuracy': 0.39408360128617365, 'macro avg': {'precision': 0.3980041537690317, 'recall': 0.394192278966552, 'f1-score': 0.3879307114485626, 'support': 132175}, 'weighted avg': {'precision': 0.39869429379059956, 'recall': 0.39408360128617365, 'f1-score': 0.3880820031975698, 'support': 132175}}
[[12078 15729 17079]
 [ 7709 17441 16757]
 [ 8555 14258 22569]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
8238/8238 - 65s - 65s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1129721
{'0': {'precision': 0.41134507351601923, 'recall': 0.30673185878768755, 'f1-score': 0.3514181651761027, 'support': 751011}, '1': {'precision': 0.3298783545029128, 'recall': 0.3722564805490912, 'f1-score': 0.3497885281464053, 'support': 593854}, '2': {'precision': 0.3981999906664496, 'recall': 0.45799796817151145, 'f1-score': 0.4260107952106527, 'support': 763844}, 'accuracy': 0.3799784607548979, 'macro avg': {'precision': 0.3798078062284606, 'recall': 0.37899543583609674, 'f1-score': 0.3757391628443869, 'support': 2108709}, 'weighted avg': {'precision': 0.38364085751610844, 'recall': 0.3799784607548979, 'f1-score': 0.3779791398897672, 'support': 2108709}}
[[230359 228576 292076]
 [136152 221066 236636]
 [193503 220502 349839]]
Evaluating performance on  train set...
1806/1806 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045008
{'0': {'precision': 0.4256390349484184, 'recall': 0.23269453376205787, 'f1-score': 0.300892682663163, 'support': 155500}, '1': {'precision': 0.37906449478987037, 'recall': 0.4402158925264941, 'f1-score': 0.40735801193930093, 'support': 152298}, '2': {'precision': 0.3851918794499755, 'recall': 0.4997797385366865, 'f1-score': 0.43506727873585904, 'support': 154362}, 'accuracy': 0.39028691362298773, 'macro avg': {'precision': 0.39663180306275475, 'recall': 0.3908967216084129, 'f1-score': 0.3811059911127743, 'support': 462160}, 'weighted avg': {'precision': 0.3967816843899166, 'recall': 0.39028691362298773, 'f1-score': 0.38079123666409503, 'support': 462160}}
[[36184 57597 61719]
 [23838 67044 61416]
 [24989 52226 77147]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947624
{'0': {'precision': 0.4121843020618037, 'recall': 0.2989251636017987, 'f1-score': 0.3465352828989193, 'support': 54706}, '1': {'precision': 0.38530440368282065, 'recall': 0.4000815207322044, 'f1-score': 0.3925539457179734, 'support': 53974}, '2': {'precision': 0.38448195440499094, 'recall': 0.4740483807196003, 'f1-score': 0.4245931458558022, 'support': 55642}, 'accuracy': 0.3914509317072577, 'macro avg': {'precision': 0.3939902200498717, 'recall': 0.3910183550178678, 'f1-score': 0.3878941248242316, 'support': 164322}, 'weighted avg': {'precision': 0.3939747521328374, 'recall': 0.3914509317072577, 'f1-score': 0.3880824093801118, 'support': 164322}}
[[16353 17426 20927]
 [11080 21594 21300]
 [12241 17024 26377]]
testing model on single stock: results/universal/W5/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
31315/31315 - 239s - 239s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0897074
{'0': {'precision': 0.40214948682724966, 'recall': 0.5176255647686056, 'f1-score': 0.45263862045222286, 'support': 3009861}, '1': {'precision': 0.26089392238663855, 'recall': 0.06678920924837514, 'f1-score': 0.10635212552423406, 'support': 1903556}, '2': {'precision': 0.4178705314369169, 'recall': 0.49220093430235407, 'f1-score': 0.45200025214194883, 'support': 3103064}, 'accuracy': 0.4007305699346135, 'macro avg': {'precision': 0.3603046468836017, 'recall': 0.3588719027731116, 'f1-score': 0.3369969993728019, 'support': 8016481}, 'weighted avg': {'precision': 0.37469299193208816, 'recall': 0.4007305699346135, 'f1-score': 0.3701639494760807, 'support': 8016481}}
[[1557981  188803 1263077]
 [ 911793  127137  864626]
 [1404360  171373 1527331]]
Evaluating performance on  train set...
5759/5759 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942292
{'0': {'precision': 0.39804179549591034, 'recall': 0.37208944790985515, 'f1-score': 0.3846283427643938, 'support': 487837}, '1': {'precision': 0.38463939777734174, 'recall': 0.26566744903805284, 'f1-score': 0.31427061888538693, 'support': 486981}, '2': {'precision': 0.3806834099212804, 'recall': 0.5197625727691633, 'f1-score': 0.4394821951673807, 'support': 499353}, 'accuracy': 0.38695578735438424, 'macro avg': {'precision': 0.38778820106484413, 'recall': 0.3858398232390237, 'f1-score': 0.37946038560572043, 'support': 1474171}, 'weighted avg': {'precision': 0.38773452791620994, 'recall': 0.38695578735438424, 'f1-score': 0.37996712030557867, 'support': 1474171}}
[[181519 106435 199883]
 [135247 129375 222359]
 [139264 100544 259545]]
Evaluating performance on  val set...
2129/2129 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1056695
{'0': {'precision': 0.3856532621736792, 'recall': 0.4040342198936994, 'f1-score': 0.3946298212145346, 'support': 184571}, '1': {'precision': 0.3665157486089788, 'recall': 0.21782540724941737, 'f1-score': 0.27325284691541635, 'support': 172069}, '2': {'precision': 0.38028061674715613, 'recall': 0.5034917869983377, 'f1-score': 0.433297456393522, 'support': 188299}, 'accuracy': 0.37960395567210276, 'macro avg': {'precision': 0.3774832091766047, 'recall': 0.3751171380471516, 'f1-score': 0.3670600415078244, 'support': 544939}, 'weighted avg': {'precision': 0.37775396228372216, 'recall': 0.37960395567210276, 'f1-score': 0.3696653067384064, 'support': 544939}}
[[74573 33997 76001]
 [56088 37481 78500]
 [62707 30785 94807]]
training model: results/universal/W5/deepVOL_L2/h50
Epoch 1/50
9913/9913 - 323s - loss: 2.9880 - accuracy50: 0.4800 - val_loss: 3.2058 - val_accuracy50: 0.4685 - 323s/epoch - 33ms/step
Epoch 2/50
9913/9913 - 316s - loss: 2.9310 - accuracy50: 0.5018 - val_loss: 3.2620 - val_accuracy50: 0.4756 - 316s/epoch - 32ms/step
Epoch 3/50
9913/9913 - 319s - loss: 2.9104 - accuracy50: 0.5076 - val_loss: 3.2524 - val_accuracy50: 0.4773 - 319s/epoch - 32ms/step
Epoch 4/50
9913/9913 - 321s - loss: 2.8980 - accuracy50: 0.5110 - val_loss: 3.2215 - val_accuracy50: 0.4818 - 321s/epoch - 32ms/step
Epoch 5/50
9913/9913 - 315s - loss: 2.8885 - accuracy50: 0.5134 - val_loss: 3.2569 - val_accuracy50: 0.4783 - 315s/epoch - 32ms/step
Epoch 6/50
9913/9913 - 317s - loss: 2.8816 - accuracy50: 0.5144 - val_loss: 3.2119 - val_accuracy50: 0.4833 - 317s/epoch - 32ms/step
Epoch 7/50
9913/9913 - 317s - loss: 2.8749 - accuracy50: 0.5158 - val_loss: 3.2131 - val_accuracy50: 0.4825 - 317s/epoch - 32ms/step
Epoch 8/50
9913/9913 - 317s - loss: 2.8705 - accuracy50: 0.5171 - val_loss: 3.2279 - val_accuracy50: 0.4824 - 317s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 315s - loss: 2.8664 - accuracy50: 0.5183 - val_loss: 3.2082 - val_accuracy50: 0.4850 - 315s/epoch - 32ms/step
Epoch 10/50
9913/9913 - 318s - loss: 2.8629 - accuracy50: 0.5189 - val_loss: 3.1928 - val_accuracy50: 0.4867 - 318s/epoch - 32ms/step
Epoch 11/50
9913/9913 - 316s - loss: 2.8595 - accuracy50: 0.5201 - val_loss: 3.1889 - val_accuracy50: 0.4871 - 316s/epoch - 32ms/step
Epoch 12/50
9913/9913 - 315s - loss: 2.8564 - accuracy50: 0.5206 - val_loss: 3.1877 - val_accuracy50: 0.4870 - 315s/epoch - 32ms/step
Epoch 13/50
9913/9913 - 322s - loss: 2.8536 - accuracy50: 0.5212 - val_loss: 3.1763 - val_accuracy50: 0.4888 - 322s/epoch - 33ms/step
Epoch 14/50
9913/9913 - 314s - loss: 2.8512 - accuracy50: 0.5218 - val_loss: 3.1794 - val_accuracy50: 0.4883 - 314s/epoch - 32ms/step
Epoch 15/50
9913/9913 - 315s - loss: 2.8486 - accuracy50: 0.5225 - val_loss: 3.1781 - val_accuracy50: 0.4884 - 315s/epoch - 32ms/step
Epoch 16/50
9913/9913 - 318s - loss: 2.8466 - accuracy50: 0.5228 - val_loss: 3.2159 - val_accuracy50: 0.4861 - 318s/epoch - 32ms/step
Epoch 17/50
9913/9913 - 319s - loss: 2.8443 - accuracy50: 0.5236 - val_loss: 3.2126 - val_accuracy50: 0.4874 - 319s/epoch - 32ms/step
Epoch 18/50
9913/9913 - 317s - loss: 2.8424 - accuracy50: 0.5240 - val_loss: 3.2033 - val_accuracy50: 0.4881 - 317s/epoch - 32ms/step
Epoch 19/50
9913/9913 - 318s - loss: 2.8406 - accuracy50: 0.5246 - val_loss: 3.2195 - val_accuracy50: 0.4876 - 318s/epoch - 32ms/step
Epoch 20/50
9913/9913 - 318s - loss: 2.8387 - accuracy50: 0.5249 - val_loss: 3.2179 - val_accuracy50: 0.4870 - 318s/epoch - 32ms/step
Epoch 21/50
9913/9913 - 321s - loss: 2.8371 - accuracy50: 0.5254 - val_loss: 3.2098 - val_accuracy50: 0.4879 - 321s/epoch - 32ms/step
Epoch 22/50
9913/9913 - 316s - loss: 2.8354 - accuracy50: 0.5260 - val_loss: 3.2141 - val_accuracy50: 0.4874 - 316s/epoch - 32ms/step
Epoch 23/50
9913/9913 - 317s - loss: 2.8340 - accuracy50: 0.5260 - val_loss: 3.2099 - val_accuracy50: 0.4891 - 317s/epoch - 32ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 783s - 783s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1119696
{'0': {'precision': 0.5056812919071694, 'recall': 0.384858466338362, 'f1-score': 0.43707363912153846, 'support': 4610352}, '1': {'precision': 0.46553912379463047, 'recall': 0.3770151445653842, 'f1-score': 0.4166266949187872, 'support': 3512217}, '2': {'precision': 0.4637994781378879, 'recall': 0.6378209355654221, 'f1-score': 0.5370652420395927, 'support': 4715822}, 'accuracy': 0.47563140895148, 'macro avg': {'precision': 0.4783399646132292, 'recall': 0.4665648488230561, 'f1-score': 0.4635885253599728, 'support': 12838391}, 'weighted avg': {'precision': 0.47931543468761617, 'recall': 0.47563140895148, 'f1-score': 0.46820904353703496, 'support': 12838391}}
[[1774333  812403 2023616]
 [ 734286 1324159 1453772]
 [1000178  707794 3007850]]
Evaluating performance on  train set...
9913/9913 - 158s - 158s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0489571
{'0': {'precision': 0.5141577662110932, 'recall': 0.36632935628328933, 'f1-score': 0.42783381769530743, 'support': 778215}, '1': {'precision': 0.57132692097497, 'recall': 0.5331128293154075, 'f1-score': 0.551558763119394, 'support': 980481}, '2': {'precision': 0.44139324339892494, 'recall': 0.6054716658722379, 'f1-score': 0.5105741916052187, 'support': 778337}, 'accuracy': 0.5041522912788284, 'macro avg': {'precision': 0.5089593101949961, 'recall': 0.5016379504903116, 'f1-score': 0.49665559080664007, 'support': 2537033}, 'weighted avg': {'precision': 0.5139283445362416, 'recall': 0.5041522912788284, 'f1-score': 0.50103343812684, 'support': 2537033}}
[[285083 207961 285171]
 [146539 522707 311235]
 [122844 184232 471261]]
Evaluating performance on  val set...
3496/3496 - 55s - 55s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0673833
{'0': {'precision': 0.4891961623984564, 'recall': 0.3786818349585896, 'f1-score': 0.4269026314663804, 'support': 289903}, '1': {'precision': 0.5427273372613047, 'recall': 0.4911949321871647, 'f1-score': 0.5156769043467704, 'support': 311298}, '2': {'precision': 0.4503952915468423, 'recall': 0.596495778416343, 'f1-score': 0.5132508963625739, 'support': 293018}, 'accuracy': 0.48922355709283744, 'macro avg': {'precision': 0.49410626373553446, 'recall': 0.48879084852069915, 'f1-score': 0.4852768107252416, 'support': 894219}, 'weighted avg': {'precision': 0.495117300394022, 'recall': 0.48922355709283744, 'f1-score': 0.48610160787201767, 'support': 894219}}
[[109781  68444 111678]
 [ 56784 152908 101606]
 [ 57846  60388 174784]]
testing model out of sample: results/universal/W5/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 331s - 331s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0655657
{'0': {'precision': 0.5196261302509595, 'recall': 0.3615859469082151, 'f1-score': 0.42643425167470994, 'support': 1909900}, '1': {'precision': 0.47358311097494504, 'recall': 0.4309950518771548, 'f1-score': 0.45128654629298953, 'support': 1542201}, '2': {'precision': 0.45515783680068495, 'recall': 0.6278309713018579, 'f1-score': 0.5277287902446525, 'support': 1896743}, 'accuracy': 0.47601089132530316, 'macro avg': {'precision': 0.4827890260088632, 'recall': 0.4734706566957427, 'f1-score': 0.46848319607078404, 'support': 5348844}, 'weighted avg': {'precision': 0.483489840859412, 'recall': 0.47601089132530316, 'f1-score': 0.4695196249971276, 'support': 5348844}}
[[ 690593  395906  823401]
 [ 275445  664681  602075]
 [ 362981  342928 1190834]]
Evaluating performance on  train set...
4957/4957 - 80s - 80s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0550463
{'0': {'precision': 0.5222346377010658, 'recall': 0.3487212792908473, 'f1-score': 0.4181941413937228, 'support': 403411}, '1': {'precision': 0.526405982896975, 'recall': 0.5402323715002044, 'f1-score': 0.5332295643410456, 'support': 462277}, '2': {'precision': 0.44990353599670574, 'recall': 0.5860983072399268, 'f1-score': 0.5090487098847718, 'support': 402656}, 'accuracy': 0.4938809975842516, 'macro avg': {'precision': 0.49951471886491544, 'recall': 0.4916839860103262, 'f1-score': 0.4868241385398468, 'support': 1268344}, 'weighted avg': {'precision': 0.5007923198876482, 'recall': 0.4938809975842516, 'f1-score': 0.48896466370009345, 'support': 1268344}}
[[140678 118712 144021]
 [ 68009 249737 144531]
 [ 60690 105970 235996]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0512662
{'0': {'precision': 0.5225964055138719, 'recall': 0.3409390052151146, 'f1-score': 0.41266054966867455, 'support': 140553}, '1': {'precision': 0.5218682655436655, 'recall': 0.5468669116885806, 'f1-score': 0.5340752185686165, 'support': 154544}, '2': {'precision': 0.45268397003786603, 'recall': 0.5867476335059832, 'f1-score': 0.5110701795870618, 'support': 139975}, 'accuracy': 0.4931712452191821, 'macro avg': {'precision': 0.4990495470318011, 'recall': 0.4915178501365595, 'f1-score': 0.48593531594145095, 'support': 435072}, 'weighted avg': {'precision': 0.4998449464006458, 'recall': 0.4931712452191821, 'f1-score': 0.4874500018473918, 'support': 435072}}
[[47920 41304 51329]
 [22059 84515 47970]
 [21717 36128 82130]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1560022
{'0': {'precision': 0.4465249769258974, 'recall': 0.3470548927890568, 'f1-score': 0.3905559702524122, 'support': 101762}, '1': {'precision': 0.3732580660399641, 'recall': 0.22480013656149536, 'f1-score': 0.28060300436805286, 'support': 70298}, '2': {'precision': 0.4119381675773406, 'recall': 0.6220531936328834, 'f1-score': 0.49564718301096944, 'support': 99260}, 'accuracy': 0.41598481497862305, 'macro avg': {'precision': 0.410573736847734, 'recall': 0.39796940766114525, 'f1-score': 0.38893538587714477, 'support': 271320}, 'weighted avg': {'precision': 0.414888518141447, 'recall': 0.41598481497862305, 'f1-score': 0.4005142489737586, 'support': 271320}}
[[35317 13855 52590]
 [18941 15803 35554]
 [24835 12680 61745]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1543263
{'0': {'precision': 0.45357653005164267, 'recall': 0.3526095498419749, 'f1-score': 0.39677047289504036, 'support': 23414}, '1': {'precision': 0.48676442582365265, 'recall': 0.33382673051806705, 'f1-score': 0.39604369496165076, 'support': 22970}, '2': {'precision': 0.41317130537044294, 'recall': 0.6337126905733305, 'f1-score': 0.5002118679977626, 'support': 23285}, 'accuracy': 0.44036802595128394, 'macro avg': {'precision': 0.4511707537485794, 'recall': 0.4400496569777908, 'f1-score': 0.4310086786181513, 'support': 69669}, 'weighted avg': {'precision': 0.45101427580917236, 'recall': 0.44036802595128394, 'f1-score': 0.4311033726903142, 'support': 69669}}
[[ 8256  4427 10731]
 [ 5075  7668 10227]
 [ 4871  3658 14756]]
Evaluating performance on  val set...
96/96 - 1s - 856ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1312363
{'0': {'precision': 0.4560738420965881, 'recall': 0.33241230177799136, 'f1-score': 0.38454589674101874, 'support': 8324}, '1': {'precision': 0.48064836255375454, 'recall': 0.36379569354031044, 'f1-score': 0.41413709562491097, 'support': 7988}, '2': {'precision': 0.412980303519535, 'recall': 0.624740505556234, 'f1-score': 0.4972542158720901, 'support': 8189}, 'accuracy': 0.4403493734949594, 'macro avg': {'precision': 0.4499008360566259, 'recall': 0.44031616695817855, 'f1-score': 0.4319790694126733, 'support': 24501}, 'weighted avg': {'precision': 0.44968260426973844, 'recall': 0.4403493734949594, 'f1-score': 0.43186408465371107, 'support': 24501}}
[[2767 1689 3868]
 [1678 2906 3404]
 [1622 1451 5116]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89269173
{'0': {'precision': 0.6139526817071584, 'recall': 0.2972001063427876, 'f1-score': 0.40051856216853277, 'support': 142934}, '1': {'precision': 0.6291541624986107, 'recall': 0.7884976319300869, 'f1-score': 0.6998708275173178, 'support': 272796}, '2': {'precision': 0.48758176994376523, 'recall': 0.5033942959101174, 'f1-score': 0.49536187651103375, 'support': 143476}, 'accuracy': 0.5897719266245355, 'macro avg': {'precision': 0.5768962047165115, 'recall': 0.5296973447276639, 'f1-score': 0.5319170887322947, 'support': 559206}, 'weighted avg': {'precision': 0.5889452787426345, 'recall': 0.5897719266245355, 'f1-score': 0.5708848313907726, 'support': 559206}}
[[ 42480  69360  31094]
 [ 12887 215099  44810]
 [ 13824  57427  72225]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7038003
{'0': {'precision': 0.6470799253838427, 'recall': 0.34232900630076674, 'f1-score': 0.44777082712739547, 'support': 26346}, '1': {'precision': 0.7544795668878799, 'recall': 0.8864846563452246, 'f1-score': 0.8151726285102389, 'support': 97467}, '2': {'precision': 0.5445059146314037, 'recall': 0.4504055361261999, 'f1-score': 0.49300564028425403, 'support': 26878}, 'accuracy': 0.7135661718350798, 'macro avg': {'precision': 0.6486884689677088, 'recall': 0.5597397329240638, 'f1-score': 0.585316365307296, 'support': 150691}, 'weighted avg': {'precision': 0.6982504438452634, 'recall': 0.7135661718350798, 'f1-score': 0.6934747688585648, 'support': 150691}}
[[ 9019 14715  2612]
 [ 3549 86403  7515]
 [ 1370 13402 12106]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77858174
{'0': {'precision': 0.6242140899564727, 'recall': 0.3331899148093968, 'f1-score': 0.4344703770197487, 'support': 11621}, '1': {'precision': 0.6916153481762198, 'recall': 0.8899996952055839, 'f1-score': 0.7783656985965427, 'support': 32809}, '2': {'precision': 0.6088753799392097, 'recall': 0.4098870518906531, 'f1-score': 0.4899476593454973, 'support': 12218}, 'accuracy': 0.6722214376500494, 'macro avg': {'precision': 0.6415682726906341, 'recall': 0.544358887301878, 'f1-score': 0.5675945783205962, 'support': 56648}, 'weighted avg': {'precision': 0.6599427921514446, 'recall': 0.6722214376500494, 'f1-score': 0.645610806356513, 'support': 56648}}
[[ 3872  6628  1121]
 [ 1513 29200  2096]
 [  818  6392  5008]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2438899
{'0': {'precision': 0.46020748263161515, 'recall': 0.3501006131934104, 'f1-score': 0.39767323736653265, 'support': 210211}, '1': {'precision': 0.36669032841290355, 'recall': 0.33824706323489084, 'f1-score': 0.3518948722875292, 'support': 178683}, '2': {'precision': 0.4194607037877491, 'recall': 0.5473670201388856, 'f1-score': 0.4749531893131408, 'support': 210389}, 'accuracy': 0.41582023851836275, 'macro avg': {'precision': 0.4154528382774226, 'recall': 0.41190489885572895, 'f1-score': 0.40817376632240093, 'support': 599283}, 'weighted avg': {'precision': 0.418019401672462, 'recall': 0.41582023851836275, 'f1-score': 0.4111544077028902, 'support': 599283}}
[[ 73595  53989  82627]
 [ 41488  60439  76756]
 [ 44834  50395 115160]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2397752
{'0': {'precision': 0.4699338659734699, 'recall': 0.2962240053977204, 'f1-score': 0.3633864435839073, 'support': 41499}, '1': {'precision': 0.42424242424242425, 'recall': 0.3563523683045595, 'f1-score': 0.3873451220979189, 'support': 40662}, '2': {'precision': 0.4019753711735098, 'recall': 0.614454041760422, 'f1-score': 0.4860059899147442, 'support': 41331}, 'accuracy': 0.42252939461665534, 'macro avg': {'precision': 0.432050553796468, 'recall': 0.42234347182090065, 'f1-score': 0.4122458518655234, 'support': 123492}, 'weighted avg': {'precision': 0.43214439011879974, 'recall': 0.42252939461665534, 'f1-score': 0.4123142790318437, 'support': 123492}}
[[12293 10495 18711]
 [ 7101 14490 19071]
 [ 6765  9170 25396]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2268661
{'0': {'precision': 0.4729894620077648, 'recall': 0.2951477815463418, 'f1-score': 0.36348137413690224, 'support': 14447}, '1': {'precision': 0.4000991080277502, 'recall': 0.3358289659762083, 'f1-score': 0.36515761385735607, 'support': 12021}, '2': {'precision': 0.4219551714825817, 'recall': 0.6311006395153147, 'f1-score': 0.5057589081002346, 'support': 14855}, 'accuracy': 0.42775209931515135, 'macro avg': {'precision': 0.43168124717269896, 'recall': 0.4206924623459549, 'f1-score': 0.41146596536483093, 'support': 41323}, 'weighted avg': {'precision': 0.4334393487307677, 'recall': 0.42775209931515135, 'f1-score': 0.41511564184991623, 'support': 41323}}
[[4264 3075 7108]
 [2249 4037 5735]
 [2502 2978 9375]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
2027/2027 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.261496
{'0': {'precision': 0.40392985947021515, 'recall': 0.10400256163944925, 'f1-score': 0.16541468259020653, 'support': 187380}, '1': {'precision': 0.3185144364187447, 'recall': 0.5111106900123803, 'f1-score': 0.3924570946331007, 'support': 158316}, '2': {'precision': 0.3426075554283287, 'recall': 0.4284765649811469, 'f1-score': 0.38076081351166213, 'support': 173181}, 'accuracy': 0.33651327771321526, 'macro avg': {'precision': 0.3550172837724295, 'recall': 0.34786327221099217, 'f1-score': 0.3128775302449898, 'support': 518877}, 'weighted avg': {'precision': 0.35740151835643574, 'recall': 0.33651327771321526, 'f1-score': 0.306562401228904, 'support': 518877}}
[[19488 90509 77383]
 [12400 80917 64999]
 [16358 82619 74204]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2446234
{'0': {'precision': 0.39164669633687094, 'recall': 0.12127637018975936, 'f1-score': 0.18520317306135664, 'support': 28299}, '1': {'precision': 0.3682183712764753, 'recall': 0.4684944338365097, 'f1-score': 0.41234759722860814, 'support': 27757}, '2': {'precision': 0.3580350738331396, 'recall': 0.5087515816111345, 'f1-score': 0.42029006547523995, 'support': 28452}, 'accuracy': 0.365776021205093, 'macro avg': {'precision': 0.37263338048216194, 'recall': 0.36617412854580117, 'f1-score': 0.33928027858840154, 'support': 84508}, 'weighted avg': {'precision': 0.37263526662397317, 'recall': 0.365776021205093, 'f1-score': 0.3389583210304271, 'support': 84508}}
[[ 3432 11274 13593]
 [ 2392 13004 12361]
 [ 2939 11038 14475]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2668973
{'0': {'precision': 0.3773489080751651, 'recall': 0.1194053836882282, 'f1-score': 0.18140755661356284, 'support': 12445}, '1': {'precision': 0.3114923522116577, 'recall': 0.4366428433455669, 'f1-score': 0.363599806980859, 'support': 10354}, '2': {'precision': 0.34990463299083246, 'recall': 0.47765832353435245, 'f1-score': 0.4039205937710856, 'support': 11906}, 'accuracy': 0.3369543293473563, 'macro avg': {'precision': 0.3462486310925517, 'recall': 0.3445688501893825, 'f1-score': 0.3163093191218358, 'support': 34705}, 'weighted avg': {'precision': 0.34828593966816845, 'recall': 0.3369543293473563, 'f1-score': 0.31209935262855926, 'support': 34705}}
[[1486 5220 5739]
 [1006 4521 4827]
 [1446 4773 5687]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
2900/2900 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2519218
{'0': {'precision': 0.45545882202686305, 'recall': 0.37526482679275464, 'f1-score': 0.4114910565071819, 'support': 285092}, '1': {'precision': 0.23993046565817214, 'recall': 0.07564176563529405, 'f1-score': 0.11502129941975152, 'support': 171519}, '2': {'precision': 0.42676818361274754, 'recall': 0.6771444669585333, 'f1-score': 0.5235626461165469, 'support': 285747}, 'accuracy': 0.42223698000156257, 'macro avg': {'precision': 0.3740524904325942, 'recall': 0.3760170197955273, 'f1-score': 0.35002500068116005, 'support': 742358}, 'weighted avg': {'precision': 0.3946182679937419, 'recall': 0.42223698000156257, 'f1-score': 0.3861312223708598, 'support': 742358}}
[[106985  22733 155374]
 [ 54022  12974 104523]
 [ 73888  18367 193492]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3735596
{'0': {'precision': 0.4232382466951595, 'recall': 0.3584041747327666, 'f1-score': 0.38813234891987974, 'support': 59405}, '1': {'precision': 0.37661351556567957, 'recall': 0.2068597357533698, 'f1-score': 0.26704282376250416, 'support': 59944}, '2': {'precision': 0.3815220616284491, 'recall': 0.6180797555490705, 'f1-score': 0.4718099918099918, 'support': 58253}, 'accuracy': 0.3924280131980496, 'macro avg': {'precision': 0.3937912746297627, 'recall': 0.39444788867840225, 'f1-score': 0.3756617214974585, 'support': 177602}, 'weighted avg': {'precision': 0.393818725453751, 'recall': 0.3924280131980496, 'f1-score': 0.3747084192076241, 'support': 177602}}
[[21291 11064 27050]
 [16227 12400 31317]
 [12787  9461 36005]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3745012
{'0': {'precision': 0.4192095146564152, 'recall': 0.35299175560163876, 'f1-score': 0.38326148439001617, 'support': 19771}, '1': {'precision': 0.38950299552780354, 'recall': 0.215489472947108, 'f1-score': 0.2774705458042799, 'support': 21421}, '2': {'precision': 0.3778114186851211, 'recall': 0.6215501905972046, 'f1-score': 0.4699575351151932, 'support': 19675}, 'accuracy': 0.39141078088290865, 'macro avg': {'precision': 0.39550797628977996, 'recall': 0.3966771397153171, 'f1-score': 0.37689652176982974, 'support': 60867}, 'weighted avg': {'precision': 0.3953731027338759, 'recall': 0.39141078088290865, 'f1-score': 0.37405447735127273, 'support': 60867}}
[[ 6979  3832  8960]
 [ 5626  4616 11179]
 [ 4043  3403 12229]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
7167/7167 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8960637
{'0': {'precision': 0.6090445434136631, 'recall': 0.3239831263418056, 'f1-score': 0.42296742455299424, 'support': 517493}, '1': {'precision': 0.5649010009767879, 'recall': 0.766355257241553, 'f1-score': 0.6503854524582061, 'support': 798413}, '2': {'precision': 0.5489544195385039, 'recall': 0.503953418873454, 'f1-score': 0.5254922538127808, 'support': 518665}, 'accuracy': 0.5673860537422646, 'macro avg': {'precision': 0.5742999879763183, 'recall': 0.5314306008189374, 'f1-score': 0.5329483769413271, 'support': 1834571}, 'weighted avg': {'precision': 0.5728445695520015, 'recall': 0.5673860537422646, 'f1-score': 0.5509262500669215, 'support': 1834571}}
[[167659 257219  92615]
 [ 64396 611868 122149]
 [ 43227 214055 261383]]
Evaluating performance on  train set...
1570/1570 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8350188
{'0': {'precision': 0.6401231362658556, 'recall': 0.3422231916243655, 'f1-score': 0.4460035661679199, 'support': 100864}, '1': {'precision': 0.6257538584482559, 'recall': 0.8352148969999651, 'f1-score': 0.7154690235258956, 'support': 200631}, '2': {'precision': 0.5710124271747555, 'recall': 0.4558001676579777, 'f1-score': 0.5069426716243963, 'support': 100204}, 'accuracy': 0.6167827154162694, 'macro avg': {'precision': 0.6122964739629557, 'recall': 0.5444127520941028, 'f1-score': 0.5561384204394039, 'support': 401699}, 'weighted avg': {'precision': 0.61570661525986, 'recall': 0.6167827154162694, 'f1-score': 0.5957910097471889, 'support': 401699}}
[[ 34518  52593  13753]
 [ 12501 167570  20560]
 [  6905  47626  45673]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85954887
{'0': {'precision': 0.610525752794566, 'recall': 0.334417296537177, 'f1-score': 0.43213264939145574, 'support': 34134}, '1': {'precision': 0.6225483637920424, 'recall': 0.8028883482581914, 'f1-score': 0.701310445129349, 'support': 57957}, '2': {'precision': 0.541894945367877, 'recall': 0.5201283460590035, 'f1-score': 0.530788588060516, 'support': 33659}, 'accuracy': 0.6000397614314116, 'macro avg': {'precision': 0.5916563539848284, 'recall': 0.5524779969514574, 'f1-score': 0.5547438941937736, 'support': 125750}, 'weighted avg': {'precision': 0.5976967278912325, 'recall': 0.6000397614314116, 'f1-score': 0.5826010211389149, 'support': 125750}}
[[11415 15356  7363]
 [ 3987 46533  7437]
 [ 3295 12857 17507]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
6357/6357 - 61s - 61s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9648347
{'0': {'precision': 0.5766220814713876, 'recall': 0.3134970810578139, 'f1-score': 0.406168852496377, 'support': 483223}, '1': {'precision': 0.5497357352769927, 'recall': 0.6614577997408624, 'f1-score': 0.6004440733575815, 'support': 663740}, '2': {'precision': 0.4635838252447775, 'recall': 0.546234324435763, 'f1-score': 0.5015267306931186, 'support': 480206}, 'accuracy': 0.5241188837791281, 'macro avg': {'precision': 0.5299805473310526, 'recall': 0.5070630684114797, 'f1-score': 0.5027132188490256, 'support': 1627169}, 'weighted avg': {'precision': 0.5322952830302772, 'recall': 0.5241188837791281, 'f1-score': 0.5135576119625176, 'support': 1627169}}
[[151489 192997 138737]
 [ 59926 439036 164778]
 [ 51303 166598 262305]]
Evaluating performance on  train set...
1701/1701 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9298745
{'0': {'precision': 0.5884989565881903, 'recall': 0.3218637474279835, 'f1-score': 0.416134094002972, 'support': 124416}, '1': {'precision': 0.5730650704970115, 'recall': 0.7164485626811888, 'f1-score': 0.6367852739462124, 'support': 184545}, '2': {'precision': 0.4875048480457802, 'recall': 0.5268114853270282, 'f1-score': 0.5063965641746798, 'support': 126457}, 'accuracy': 0.548624540097102, 'macro avg': {'precision': 0.5496896250436607, 'recall': 0.5217079318120669, 'f1-score': 0.5197719773746213, 'support': 435418}, 'weighted avg': {'precision': 0.5526261665504698, 'recall': 0.548624540097102, 'f1-score': 0.5358682188970484, 'support': 435418}}
[[ 40045  51518  32853]
 [ 15147 132217  37181]
 [ 12854  46984  66619]]
Evaluating performance on  val set...
563/563 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.950269
{'0': {'precision': 0.5860354813700005, 'recall': 0.30589411540658923, 'f1-score': 0.4019707515445375, 'support': 42008}, '1': {'precision': 0.5546772418000716, 'recall': 0.6925382526329734, 'f1-score': 0.6159885112494016, 'support': 60388}, '2': {'precision': 0.4731143682464962, 'recall': 0.5307107025418237, 'f1-score': 0.5002601868820562, 'support': 41663}, 'accuracy': 0.5329899555043419, 'macro avg': {'precision': 0.5379423638055227, 'recall': 0.5097143568604622, 'f1-score': 0.5060731498919985, 'support': 144059}, 'weighted avg': {'precision': 0.5402327636834039, 'recall': 0.5329899555043419, 'f1-score': 0.5201107998408909, 'support': 144059}}
[[12850 18157 11001]
 [ 4944 41821 13623]
 [ 4133 15419 22111]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
7459/7459 - 65s - 65s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0402313
{'0': {'precision': 0.5570432868672047, 'recall': 0.3080218502424154, 'f1-score': 0.3966903682172325, 'support': 700038}, '1': {'precision': 0.37660515388190147, 'recall': 0.5250571618464008, 'f1-score': 0.43861039722889544, 'support': 478466}, '2': {'precision': 0.49714123325174336, 'recall': 0.5817334864186922, 'f1-score': 0.5361210112521092, 'support': 730747}, 'accuracy': 0.4671722052260284, 'macro avg': {'precision': 0.47692989133361646, 'recall': 0.4716041661691695, 'f1-score': 0.45714059223274567, 'support': 1909251}, 'weighted avg': {'precision': 0.4888978425488392, 'recall': 0.4671722052260284, 'f1-score': 0.460561400735692, 'support': 1909251}}
[[215627 216767 267644]
 [ 64899 251222 162345]
 [106566 199081 425100]]
Evaluating performance on  train set...
1664/1664 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91997707
{'0': {'precision': 0.5958607848753938, 'recall': 0.3331358151229551, 'f1-score': 0.42734832026214287, 'support': 124883}, '1': {'precision': 0.5735554297441704, 'recall': 0.7359394331505885, 'f1-score': 0.6446792115140818, 'support': 176202}, '2': {'precision': 0.5098458344546538, 'recall': 0.530982238664937, 'f1-score': 0.5201994249469468, 'support': 124878}, 'accuracy': 0.5577597115242404, 'macro avg': {'precision': 0.5597540163580726, 'recall': 0.5333524956461603, 'f1-score': 0.5307423189077238, 'support': 425963}, 'weighted avg': {'precision': 0.5614173633494092, 'recall': 0.5577597115242404, 'f1-score': 0.5444692860530757, 'support': 425963}}
[[ 41603  50871  32409]
 [ 15190 129674  31338]
 [ 13027  45543  66308]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96127254
{'0': {'precision': 0.573578526367872, 'recall': 0.3202495510843041, 'f1-score': 0.4110147582396478, 'support': 43438}, '1': {'precision': 0.5127415428940441, 'recall': 0.6918539702399571, 'f1-score': 0.5889815598520224, 'support': 44758}, '2': {'precision': 0.5114664422470019, 'recall': 0.5527512505684402, 'f1-score': 0.5313080537646159, 'support': 43980}, 'accuracy': 0.5234460113787677, 'macro avg': {'precision': 0.5325955038363059, 'recall': 0.5216182572975672, 'f1-score': 0.5104347906187621, 'support': 132176}, 'weighted avg': {'precision': 0.5323105869086854, 'recall': 0.5234460113787677, 'f1-score': 0.5113048051752092, 'support': 132176}}
[[13911 15549 13978]
 [ 4550 30966  9242]
 [ 5792 13878 24310]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
8238/8238 - 70s - 70s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0151216
{'0': {'precision': 0.5463601752408211, 'recall': 0.3902414622739305, 'f1-score': 0.45528938915796163, 'support': 829612}, '1': {'precision': 0.3972665927855688, 'recall': 0.29901454490666235, 'f1-score': 0.34120840855207507, 'support': 457961}, '2': {'precision': 0.47635685384050674, 'recall': 0.679582434685395, 'f1-score': 0.5601051088501913, 'support': 821141}, 'accuracy': 0.48309965220508805, 'macro avg': {'precision': 0.4733278739556322, 'recall': 0.456279480621996, 'f1-score': 0.45220096885340927, 'support': 2108714}, 'weighted avg': {'precision': 0.4867211519058571, 'recall': 0.48309965220508805, 'f1-score': 0.4713294234748698, 'support': 2108714}}
[[323749 112386 393477]
 [101074 136937 219950]
 [167733  95375 558033]]
Evaluating performance on  train set...
1806/1806 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98623925
{'0': {'precision': 0.5515221277033793, 'recall': 0.3810133374709879, 'f1-score': 0.4506794527671355, 'support': 154677}, '1': {'precision': 0.5147084453739668, 'recall': 0.5364111679078336, 'f1-score': 0.5253357559432296, 'support': 154156}, '2': {'precision': 0.47967634215258154, 'recall': 0.6089414987282332, 'f1-score': 0.5366342893269729, 'support': 153330}, 'accuracy': 0.508465627927809, 'macro avg': {'precision': 0.5153023050766425, 'recall': 0.5087886680356849, 'f1-score': 0.5042164993457793, 'support': 462163}, 'weighted avg': {'precision': 0.5154068084076401, 'recall': 0.508465627927809, 'f1-score': 0.5040982079728396, 'support': 462163}}
[[58934 41265 54478]
 [24662 82691 46803]
 [23261 36700 93369]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9627372
{'0': {'precision': 0.5541203142299784, 'recall': 0.3753370355159545, 'f1-score': 0.4475339855435026, 'support': 56003}, '1': {'precision': 0.5302440689537464, 'recall': 0.5892159465918143, 'f1-score': 0.5581767221244027, 'support': 52726}, '2': {'precision': 0.49120918021180565, 'recall': 0.5990502401381469, 'f1-score': 0.5397962574255821, 'support': 55593}, 'accuracy': 0.5196504424240211, 'macro avg': {'precision': 0.5251911877985102, 'recall': 0.5212010740819718, 'f1-score': 0.5151689883644958, 'support': 164322}, 'weighted avg': {'precision': 0.5251752089981355, 'recall': 0.5196504424240211, 'f1-score': 0.51424985687969, 'support': 164322}}
[[21020 14594 20389]
 [ 7553 31067 14106]
 [ 9361 12929 33303]]
testing model on single stock: results/universal/W5/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
31315/31315 - 299s - 299s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1840451
{'0': {'precision': 0.48701250875304913, 'recall': 0.4339846406881682, 'f1-score': 0.4589719930188018, 'support': 3062507}, '1': {'precision': 0.33181417554905507, 'recall': 0.09160216070492277, 'f1-score': 0.143569781467214, 'support': 1804226}, '2': {'precision': 0.454161458935798, 'recall': 0.6905747847529632, 'f1-score': 0.5479558343274629, 'support': 3149753}, 'accuracy': 0.45774320568887666, 'macro avg': {'precision': 0.42432938107930074, 'recall': 0.40538719538201806, 'f1-score': 0.3834992029378262, 'support': 8016486}, 'weighted avg': {'precision': 0.4391753940074679, 'recall': 0.45774320568887666, 'f1-score': 0.4229487592196789, 'support': 8016486}}
[[1329081  178645 1554781]
 [ 579522  165271 1059433]
 [ 820446  154167 2175140]]
Evaluating performance on  train set...
5759/5759 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1685846
{'0': {'precision': 0.4809630870510786, 'recall': 0.39448358151391155, 'f1-score': 0.4334519690774553, 'support': 497823}, '1': {'precision': 0.46470179997932753, 'recall': 0.2631222513920706, 'f1-score': 0.3359970960182353, 'support': 478424}, '2': {'precision': 0.41825708707771886, 'recall': 0.6677732590249535, 'f1-score': 0.5143519223941966, 'support': 497925}, 'accuracy': 0.4441598402357391, 'macro avg': {'precision': 0.45464065803604164, 'recall': 0.4417930306436452, 'f1-score': 0.42793366249662906, 'support': 1474172}, 'weighted avg': {'precision': 0.45450574350992423, 'recall': 0.4441598402357391, 'f1-score': 0.42914945828953777, 'support': 1474172}}
[[196383  78342 223098]
 [113171 125884 239369]
 [ 98758  66666 332501]]
Evaluating performance on  val set...
2129/2129 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1587794
{'0': {'precision': 0.45985145535187316, 'recall': 0.4179905983586965, 'f1-score': 0.43792293651500314, 'support': 188265}, '1': {'precision': 0.45991458206223307, 'recall': 0.2506287026961673, 'f1-score': 0.32444974859624753, 'support': 165420}, '2': {'precision': 0.4297876390710267, 'recall': 0.6374578442393662, 'f1-score': 0.5134179645963662, 'support': 191255}, 'accuracy': 0.44421220684846036, 'macro avg': {'precision': 0.44985122549504436, 'recall': 0.43535904843141005, 'f1-score': 0.42526354990253895, 'support': 544940}, 'weighted avg': {'precision': 0.4493192632529897, 'recall': 0.44421220684846036, 'f1-score': 0.4299735601619744, 'support': 544940}}
[[ 78693  25965  83607]
 [ 45817  41459  78144]
 [ 46617  22721 121917]]
training model: results/universal/W5/deepVOL_L2/h100
Epoch 1/50
9913/9913 - 323s - loss: 3.1338 - accuracy100: 0.4369 - val_loss: 3.3509 - val_accuracy100: 0.4014 - 323s/epoch - 33ms/step
Epoch 2/50
9913/9913 - 319s - loss: 3.0943 - accuracy100: 0.4489 - val_loss: 3.3814 - val_accuracy100: 0.4093 - 319s/epoch - 32ms/step
Epoch 3/50
9913/9913 - 330s - loss: 3.0806 - accuracy100: 0.4535 - val_loss: 3.4120 - val_accuracy100: 0.4113 - 330s/epoch - 33ms/step
Epoch 4/50
9913/9913 - 317s - loss: 3.0726 - accuracy100: 0.4564 - val_loss: 3.4543 - val_accuracy100: 0.4128 - 317s/epoch - 32ms/step
Epoch 5/50
9913/9913 - 317s - loss: 3.0665 - accuracy100: 0.4586 - val_loss: 3.4588 - val_accuracy100: 0.4136 - 317s/epoch - 32ms/step
Epoch 6/50
9913/9913 - 325s - loss: 3.0622 - accuracy100: 0.4602 - val_loss: 3.4352 - val_accuracy100: 0.4149 - 325s/epoch - 33ms/step
Epoch 7/50
9913/9913 - 328s - loss: 3.0582 - accuracy100: 0.4616 - val_loss: 3.3942 - val_accuracy100: 0.4168 - 328s/epoch - 33ms/step
Epoch 8/50
9913/9913 - 316s - loss: 3.0546 - accuracy100: 0.4630 - val_loss: 3.4055 - val_accuracy100: 0.4175 - 316s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 314s - loss: 3.0519 - accuracy100: 0.4638 - val_loss: 3.3856 - val_accuracy100: 0.4179 - 314s/epoch - 32ms/step
Epoch 10/50
9913/9913 - 314s - loss: 3.0490 - accuracy100: 0.4644 - val_loss: 3.3926 - val_accuracy100: 0.4171 - 314s/epoch - 32ms/step
Epoch 11/50
9913/9913 - 320s - loss: 3.0463 - accuracy100: 0.4653 - val_loss: 3.3778 - val_accuracy100: 0.4183 - 320s/epoch - 32ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 803s - 803s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0768569
{'0': {'precision': 0.48963320768693597, 'recall': 0.15022923335952054, 'f1-score': 0.22991573406894422, 'support': 5068634}, '1': {'precision': 0.30375979445875567, 'recall': 0.34757792774394775, 'f1-score': 0.3241949492280261, 'support': 2585472}, '2': {'precision': 0.44529778493177014, 'recall': 0.7150484589485339, 'f1-score': 0.5488180731707587, 'support': 5184285}, 'accuracy': 0.4180527762396394, 'macro avg': {'precision': 0.4128969290258206, 'recall': 0.40428520668400075, 'f1-score': 0.3676429188225763, 'support': 12838391}, 'weighted avg': {'precision': 0.43429777097962935, 'recall': 0.4180527762396394, 'f1-score': 0.3776785560648027, 'support': 12838391}}
[[ 761457 1122898 3184279]
 [ 253313  898653 1433506]
 [ 540388  936882 3707015]]
Evaluating performance on  train set...
9913/9913 - 155s - 155s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1164528
{'0': {'precision': 0.47469233526495014, 'recall': 0.15271424727566257, 'f1-score': 0.23108550239930198, 'support': 832496}, '1': {'precision': 0.4122960578534262, 'recall': 0.4293164148368205, 'f1-score': 0.4206341306781789, 'support': 871157}, '2': {'precision': 0.3911770816738113, 'recall': 0.6393457966353884, 'f1-score': 0.48537966147552064, 'support': 833380}, 'accuracy': 0.4075445609103232, 'macro avg': {'precision': 0.4260551582640626, 'recall': 0.4071254862492905, 'f1-score': 0.3790330981843338, 'support': 2537033}, 'weighted avg': {'precision': 0.4258333350553454, 'recall': 0.4075445609103232, 'f1-score': 0.37970409768619057, 'support': 2537033}}
[[127134 297556 407806]
 [ 75690 374002 421465]
 [ 65000 235562 532818]]
Evaluating performance on  val set...
3496/3496 - 54s - 54s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1169457
{'0': {'precision': 0.44259833365626816, 'recall': 0.1488028350221649, 'f1-score': 0.2227249126724308, 'support': 307017}, '1': {'precision': 0.38587291382035416, 'recall': 0.41697363564651646, 'f1-score': 0.40082088384145814, 'support': 276358}, '2': {'precision': 0.4034957663693952, 'recall': 0.6391244482763058, 'f1-score': 0.49468446024768087, 'support': 310844}, 'accuracy': 0.40212408817079487, 'macro avg': {'precision': 0.4106556712820058, 'recall': 0.40163363964832904, 'f1-score': 0.37274341892052326, 'support': 894219}, 'weighted avg': {'precision': 0.41147472523290174, 'recall': 0.40212408817079487, 'f1-score': 0.37230263357392257, 'support': 894219}}
[[ 45685  99602 161730]
 [ 29155 115234 131969]
 [ 28380  83796 198668]]
testing model out of sample: results/universal/W5/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 334s - 334s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1260576
{'0': {'precision': 0.4545523907702585, 'recall': 0.13941353646208185, 'f1-score': 0.21338178975975944, 'support': 1922984}, '1': {'precision': 0.3458058029301925, 'recall': 0.31980924358305907, 'f1-score': 0.33229985662451667, 'support': 1505585}, '2': {'precision': 0.3961950363194328, 'recall': 0.6946150941922381, 'f1-score': 0.5045847022752334, 'support': 1920275}, 'accuracy': 0.3895125750536004, 'macro avg': {'precision': 0.3988510766732946, 'recall': 0.38461262474579305, 'f1-score': 0.35008878288650314, 'support': 5348844}, 'weighted avg': {'precision': 0.40299182922252125, 'recall': 0.3895125750536004, 'f1-score': 0.35139870155064873, 'support': 5348844}}
[[ 268090  492958 1161936]
 [ 153218  481500  870867]
 [ 168481  417942 1333852]]
Evaluating performance on  train set...
4957/4957 - 79s - 79s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1160575
{'0': {'precision': 0.4593128256750355, 'recall': 0.1456946645536186, 'f1-score': 0.2212185109860631, 'support': 425925}, '1': {'precision': 0.3989623242501189, 'recall': 0.423269229396268, 'f1-score': 0.41075649503987843, 'support': 420203}, '2': {'precision': 0.38918532052438337, 'recall': 0.6336567065198856, 'f1-score': 0.482205231910545, 'support': 422216}, 'accuracy': 0.40009177320979167, 'macro avg': {'precision': 0.4158201568165126, 'recall': 0.40087353348992405, 'f1-score': 0.37139341264549547, 'support': 1268344}, 'weighted avg': {'precision': 0.4159740970139294, 'recall': 0.40009177320979167, 'f1-score': 0.3708917848575179, 'support': 1268344}}
[[ 62055 147020 216850]
 [ 39298 177859 203046]
 [ 33751 120925 267540]]
Evaluating performance on  val set...
1701/1701 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1163265
{'0': {'precision': 0.4627883462271028, 'recall': 0.13365976895963924, 'f1-score': 0.20741513589848978, 'support': 147247}, '1': {'precision': 0.39536705976861636, 'recall': 0.4236147366341663, 'f1-score': 0.409003749859508, 'support': 141742}, '2': {'precision': 0.3904543868104838, 'recall': 0.6432849818254006, 'f1-score': 0.4859511995842371, 'support': 146083}, 'accuracy': 0.39923966607825834, 'macro avg': {'precision': 0.41620326426873433, 'recall': 0.40018649580640203, 'f1-score': 0.3674566951140783, 'support': 435072}, 'weighted avg': {'precision': 0.4165357954340001, 'recall': 0.39923966607825834, 'f1-score': 0.36661397450788696, 'support': 435072}}
[[19681 50350 77216]
 [12211 60044 69487]
 [10635 41475 93973]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1698725
{'0': {'precision': 0.4134163300443679, 'recall': 0.06257454720404133, 'f1-score': 0.10869678767302168, 'support': 99769}, '1': {'precision': 0.2910582217238468, 'recall': 0.32443402056064263, 'f1-score': 0.3068411999495261, 'support': 71204}, '2': {'precision': 0.38463104325699743, 'recall': 0.6778677987383779, 'f1-score': 0.49078453230013314, 'support': 100347}, 'accuracy': 0.3588603862597671, 'macro avg': {'precision': 0.3630351983417374, 'recall': 0.35495878883435394, 'f1-score': 0.30210750664089364, 'support': 271320}, 'weighted avg': {'precision': 0.37065905480440525, 'recall': 0.3588603862597671, 'f1-score': 0.30201107943858624, 'support': 271320}}
[[ 6243 29175 64351]
 [ 3626 23101 44477]
 [ 5232 27093 68022]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1709956
{'0': {'precision': 0.3997437540038437, 'recall': 0.07934556860085619, 'f1-score': 0.13240911019946244, 'support': 23593}, '1': {'precision': 0.3661381027012077, 'recall': 0.3453628418626897, 'f1-score': 0.35544716174792473, 'support': 22999}, '2': {'precision': 0.3680587637438788, 'recall': 0.6904710317632274, 'f1-score': 0.48016393195618445, 'support': 23077}, 'accuracy': 0.36959049218447226, 'macro avg': {'precision': 0.37798020681631006, 'recall': 0.3717264807422578, 'f1-score': 0.32267340130119054, 'support': 69669}, 'weighted avg': {'precision': 0.37815465563098727, 'recall': 0.36959049218447226, 'f1-score': 0.32122752540913907, 'support': 69669}}
[[ 1872  7809 13912]
 [ 1610  7943 13446]
 [ 1201  5942 15934]]
Evaluating performance on  val set...
96/96 - 1s - 850ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1542101
{'0': {'precision': 0.42514011208967173, 'recall': 0.060416429627944024, 'f1-score': 0.10579796772265392, 'support': 8789}, '1': {'precision': 0.33745380400152925, 'recall': 0.36625172890733054, 'f1-score': 0.3512635139616635, 'support': 7230}, '2': {'precision': 0.3900032456994482, 'recall': 0.7083235086064608, 'f1-score': 0.503035123707456, 'support': 8482}, 'accuracy': 0.3749642871719522, 'macro avg': {'precision': 0.3841990539302164, 'recall': 0.3783305557139118, 'f1-score': 0.32003220179725783, 'support': 24501}, 'weighted avg': {'precision': 0.38710072968898823, 'recall': 0.3749642871719522, 'f1-score': 0.31575190659743985, 'support': 24501}}
[[ 531 3000 5258]
 [ 443 2648 4139]
 [ 275 2199 6008]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0566595
{'0': {'precision': 0.6450392509221602, 'recall': 0.11054081798044195, 'f1-score': 0.18873755240787976, 'support': 185090}, '1': {'precision': 0.41850753297208204, 'recall': 0.6637776325480554, 'f1-score': 0.5133507291606078, 'support': 192798}, '2': {'precision': 0.4397694160524678, 'recall': 0.537707232596874, 'f1-score': 0.48383190741806775, 'support': 181318}, 'accuracy': 0.439786053797706, 'macro avg': {'precision': 0.5011053999822367, 'recall': 0.4373418943751238, 'f1-score': 0.39530672966218505, 'support': 559206}, 'weighted avg': {'precision': 0.5003806133606139, 'recall': 0.439786053797706, 'f1-score': 0.3963367010459661, 'support': 559206}}
[[ 20460 101837  62793]
 [  3414 127975  61409]
 [  7845  75977  97496]]
Evaluating performance on  train set...
589/589 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9546177
{'0': {'precision': 0.6830334190231363, 'recall': 0.14366044876993783, 'f1-score': 0.23739111011838285, 'support': 36990}, '1': {'precision': 0.5730006558388951, 'recall': 0.782475272301026, 'f1-score': 0.6615519094042125, 'support': 75927}, '2': {'precision': 0.4349300226884544, 'recall': 0.4516598718695399, 'f1-score': 0.44313710211555696, 'support': 37774}, 'accuracy': 0.5427397787525466, 'macro avg': {'precision': 0.5636546991834952, 'recall': 0.45926519764683454, 'f1-score': 0.4473600405460508, 'support': 150691}, 'weighted avg': {'precision': 0.5653998821600447, 'recall': 0.5427397787525466, 'f1-score': 0.5026830393581944, 'support': 150691}}
[[ 5314 24776  6900]
 [ 1250 59411 15266]
 [ 1216 19497 17061]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0048757
{'0': {'precision': 0.6130374479889042, 'recall': 0.13635241855873642, 'f1-score': 0.22308585272295967, 'support': 16208}, '1': {'precision': 0.48088546200721305, 'recall': 0.8172979370984106, 'f1-score': 0.6055025759070483, 'support': 23656}, '2': {'precision': 0.5032715376226826, 'recall': 0.3849499523355577, 'f1-score': 0.43622982918101405, 'support': 16784}, 'accuracy': 0.4943687332297698, 'macro avg': {'precision': 0.5323981492062666, 'recall': 0.4462001026642349, 'f1-score': 0.42160608593700727, 'support': 56648}, 'weighted avg': {'precision': 0.5253291719691057, 'recall': 0.4943687332297698, 'f1-score': 0.44593323488146097, 'support': 56648}}
[[ 2210 11321  2677]
 [  622 19334  3700]
 [  773  9550  6461]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
2341/2341 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2085719
{'0': {'precision': 0.4147384872124286, 'recall': 0.1502014581734459, 'f1-score': 0.220534327759056, 'support': 208480}, '1': {'precision': 0.2859530790222749, 'recall': 0.29903050340105664, 'f1-score': 0.29234561699966966, 'support': 179062}, '2': {'precision': 0.3723482968778322, 'recall': 0.5917890252714401, 'f1-score': 0.45709595637186057, 'support': 211741}, 'accuracy': 0.35069407942491276, 'macro avg': {'precision': 0.35767995437084527, 'recall': 0.3470069956153142, 'f1-score': 0.3233253003768621, 'support': 599283}, 'weighted avg': {'precision': 0.36128074845964725, 'recall': 0.35069407942491276, 'f1-score': 0.3255739649223104, 'support': 599283}}
[[ 31314  67643 109523]
 [ 23817  53545 101700]
 [ 20372  66063 125306]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2190241
{'0': {'precision': 0.4056288625354936, 'recall': 0.11754029330622913, 'f1-score': 0.1822650855598919, 'support': 41322}, '1': {'precision': 0.3317825593309518, 'recall': 0.29091394716394714, 'f1-score': 0.3100071155960929, 'support': 41184}, '2': {'precision': 0.3551527046560664, 'recall': 0.6534182403747621, 'f1-score': 0.4601823133693608, 'support': 40986}, 'accuracy': 0.3532131636057396, 'macro avg': {'precision': 0.3641880421741706, 'recall': 0.35395749361497947, 'f1-score': 0.3174848381751152, 'support': 123492}, 'weighted avg': {'precision': 0.3642488382584388, 'recall': 0.3532131636057396, 'f1-score': 0.3171049396719785, 'support': 123492}}
[[ 4857 12971 23494]
 [ 4071 11981 25132]
 [ 3046 11159 26781]]
Evaluating performance on  val set...
162/162 - 8s - 8s/epoch - 49ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2069869
{'0': {'precision': 0.4194865810968495, 'recall': 0.09791638294974805, 'f1-score': 0.15877222038202493, 'support': 14686}, '1': {'precision': 0.3214418777943368, 'recall': 0.2861288450377249, 'f1-score': 0.30275913497390006, 'support': 12061}, '2': {'precision': 0.37320961743805, 'recall': 0.6953896816684961, 'f1-score': 0.4857314005031748, 'support': 14576}, 'accuracy': 0.36359896425719335, 'macro avg': {'precision': 0.3713793587764121, 'recall': 0.3598116365519897, 'f1-score': 0.31575425195303325, 'support': 41323}, 'weighted avg': {'precision': 0.3745467125291689, 'recall': 0.36359896425719335, 'f1-score': 0.3161272813974034, 'support': 41323}}
[[ 1438  3759  9489]
 [ 1076  3451  7534]
 [  914  3526 10136]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
2027/2027 - 21s - 21s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1925577
{'0': {'precision': 0.2916962384669979, 'recall': 0.009253422190201728, 'f1-score': 0.017937806873977086, 'support': 177664}, '1': {'precision': 0.33223084908058637, 'recall': 0.7141775581766019, 'f1-score': 0.45349753480907423, 'support': 175672}, '2': {'precision': 0.3209152784844664, 'recall': 0.26288955606164033, 'f1-score': 0.2890187614145775, 'support': 165541}, 'accuracy': 0.3288332302260459, 'macro avg': {'precision': 0.31494745534401686, 'recall': 0.32877351214281464, 'f1-score': 0.25348470103254295, 'support': 518877}, 'weighted avg': {'precision': 0.31474167162214267, 'recall': 0.3288332302260459, 'f1-score': 0.2518866248432066, 'support': 518877}}
[[  1644 132048  43972]
 [  2093 125461  48118]
 [  1899 120123  43519]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1820189
{'0': {'precision': 0.31889400921658984, 'recall': 0.012316673786131284, 'f1-score': 0.023717311581039863, 'support': 28092}, '1': {'precision': 0.33327445820160023, 'recall': 0.6764294676465317, 'f1-score': 0.446540136312003, 'support': 27895}, '2': {'precision': 0.3505558457061852, 'recall': 0.3294765260685109, 'f1-score': 0.33968948253113307, 'support': 28521}, 'accuracy': 0.33857149618970983, 'macro avg': {'precision': 0.3342414377081251, 'recall': 0.3394075558337246, 'f1-score': 0.269982310141392, 'support': 84508}, 'weighted avg': {'precision': 0.33432651102655586, 'recall': 0.33857149618970983, 'f1-score': 0.26992459353704196, 'support': 84508}}
[[  346 19004  8742]
 [  359 18869  8667]
 [  380 18744  9397]]
Evaluating performance on  val set...
136/136 - 5s - 5s/epoch - 36ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2010608
{'0': {'precision': 0.3829268292682927, 'recall': 0.01267764857881137, 'f1-score': 0.024542754416132562, 'support': 12384}, '1': {'precision': 0.30022757525011806, 'recall': 0.6633146760269424, 'f1-score': 0.4133609222583506, 'support': 10541}, '2': {'precision': 0.33926948936943485, 'recall': 0.3169779286926995, 'f1-score': 0.3277451066444308, 'support': 11780}, 'accuracy': 0.3135859386255583, 'macro avg': {'precision': 0.34080796462928187, 'recall': 0.33099008443281774, 'f1-score': 0.25521626110630463, 'support': 34705}, 'weighted avg': {'precision': 0.3429897510197947, 'recall': 0.3135859386255583, 'f1-score': 0.24555575013646602, 'support': 34705}}
[[ 157 8388 3839]
 [ 116 6992 3433]
 [ 137 7909 3734]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
2900/2900 - 25s - 25s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2287549
{'0': {'precision': 0.3894546836405092, 'recall': 0.07801070235132028, 'f1-score': 0.129984526406575, 'support': 262746}, '1': {'precision': 0.30283605044601664, 'recall': 0.11275832527796739, 'f1-score': 0.16432987488149128, 'support': 218281}, '2': {'precision': 0.3617025472797406, 'recall': 0.842146549777868, 'f1-score': 0.5060543767188176, 'support': 261331}, 'accuracy': 0.35722522017678804, 'macro avg': {'precision': 0.3513310937887555, 'recall': 0.3443051924690519, 'f1-score': 0.2667895926689613, 'support': 742358}, 'weighted avg': {'precision': 0.35421603137351254, 'recall': 0.35722522017678804, 'f1-score': 0.27247056018327287, 'support': 742358}}
[[ 20497  30913 211336]
 [ 16630  24613 177038]
 [ 15503  25749 220079]]
Evaluating performance on  train set...
694/694 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2137185
{'0': {'precision': 0.39201807228915664, 'recall': 0.12880187372171273, 'f1-score': 0.1938968068729205, 'support': 60628}, '1': {'precision': 0.3456712823600241, 'recall': 0.2501655686848618, 'f1-score': 0.2902641982548558, 'support': 57378}, '2': {'precision': 0.35766247406527374, 'recall': 0.6971105443318344, 'f1-score': 0.47276575648779817, 'support': 59596}, 'accuracy': 0.3587121766646772, 'macro avg': {'precision': 0.36511727623815143, 'recall': 0.35869266224613633, 'f1-score': 0.3189755872051915, 'support': 177602}, 'weighted avg': {'precision': 0.36551644311660064, 'recall': 0.3587121766646772, 'f1-score': 0.31860735125846196, 'support': 177602}}
[[ 7809 14595 38224]
 [ 6636 14354 36388]
 [ 5475 12576 41545]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2163435
{'0': {'precision': 0.3733650416171225, 'recall': 0.10728754820129839, 'f1-score': 0.1666793053765072, 'support': 20487}, '1': {'precision': 0.3544347347416225, 'recall': 0.2562814070351759, 'f1-score': 0.2974705474705475, 'support': 20099}, '2': {'precision': 0.3519173239053576, 'recall': 0.7018391598047433, 'f1-score': 0.46877881702015545, 'support': 20281}, 'accuracy': 0.35459280069660076, 'macro avg': {'precision': 0.3599057000880342, 'recall': 0.3551360383470725, 'f1-score': 0.31097622328907004, 'support': 60867}, 'weighted avg': {'precision': 0.3599676111407892, 'recall': 0.35459280069660076, 'f1-score': 0.31052824438274945, 'support': 60867}}
[[ 2198  4974 13315]
 [ 2050  5151 12898]
 [ 1639  4408 14234]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
7167/7167 - 50s - 50s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0463431
{'0': {'precision': 0.5897625626989013, 'recall': 0.13941195136486415, 'f1-score': 0.22551514931474093, 'support': 646035}, '1': {'precision': 0.3588135430770366, 'recall': 0.6131831968085006, 'f1-score': 0.45271434846185066, 'support': 531161}, '2': {'precision': 0.48550402637228635, 'recall': 0.5717451987069785, 'f1-score': 0.5251072111411568, 'support': 657375}, 'accuracy': 0.43149869915091865, 'macro avg': {'precision': 0.4780267107160747, 'recall': 0.4414467822934478, 'f1-score': 0.4011122363059161, 'support': 1834571}, 'weighted avg': {'precision': 0.48553761445264765, 'recall': 0.43149869915091865, 'f1-score': 0.39864755218239667, 'support': 1834571}}
[[ 90065 334896 221074]
 [ 28241 325699 177221]
 [ 34408 247116 375851]]
Evaluating performance on  train set...
1570/1570 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0213349
{'0': {'precision': 0.6338333174102736, 'recall': 0.1507449008187471, 'f1-score': 0.24356307210338243, 'support': 132031}, '1': {'precision': 0.42136258219883743, 'recall': 0.7072415707149059, 'f1-score': 0.5280950521144685, 'support': 140522}, '2': {'precision': 0.4872170607793985, 'recall': 0.5071779226611742, 'f1-score': 0.49699715080259355, 'support': 129146}, 'accuracy': 0.4600111028406842, 'macro avg': {'precision': 0.5141376534628366, 'recall': 0.4550547980649424, 'f1-score': 0.4228850916734815, 'support': 401699}, 'weighted avg': {'precision': 0.5123699437592751, 'recall': 0.4600111028406842, 'f1-score': 0.4245767177007231, 'support': 401699}}
[[19903 78514 33614]
 [ 5816 99383 35323]
 [ 5682 57964 65500]]
Evaluating performance on  val set...
492/492 - 13s - 13s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0236555
{'0': {'precision': 0.6126993992127615, 'recall': 0.13727401424957647, 'f1-score': 0.22429516713118333, 'support': 43089}, '1': {'precision': 0.42278741050759633, 'recall': 0.6737515879996091, 'f1-score': 0.5195504940609076, 'support': 40932}, '2': {'precision': 0.47166139147187763, 'recall': 0.57494787797455, 'f1-score': 0.5182081299408181, 'support': 41729}, 'accuracy': 0.4571371769383698, 'macro avg': {'precision': 0.5023827337307452, 'recall': 0.4619911600745785, 'f1-score': 0.420684597044303, 'support': 125750}, 'weighted avg': {'precision': 0.5040802934736032, 'recall': 0.4571371769383698, 'f1-score': 0.4179340145822427, 'support': 125750}}
[[ 5915 22033 15141]
 [ 1620 27578 11734]
 [ 2119 15618 23992]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
6357/6357 - 45s - 45s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0753047
{'0': {'precision': 0.5197408906882591, 'recall': 0.11366320714122549, 'f1-score': 0.18653310491833291, 'support': 564721}, '1': {'precision': 0.3810008064869232, 'recall': 0.5337987588652482, 'f1-score': 0.44463894678630206, 'support': 505344}, '2': {'precision': 0.4149762461352839, 'recall': 0.5926721043108648, 'f1-score': 0.48815610113811425, 'support': 557104}, 'accuracy': 0.4081444521128414, 'macro avg': {'precision': 0.4385726477701554, 'recall': 0.41337802343911284, 'f1-score': 0.3731093842809164, 'support': 1627169}, 'weighted avg': {'precision': 0.44078395895610306, 'recall': 0.4081444521128414, 'f1-score': 0.369960650698121, 'support': 1627169}}
[[ 64188 244557 255976]
 [ 26088 269752 209504]
 [ 33224 193700 330180]]
Evaluating performance on  train set...
1701/1701 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0575693
{'0': {'precision': 0.5458628376606347, 'recall': 0.114350268518137, 'f1-score': 0.1890891334219103, 'support': 145614}, '1': {'precision': 0.41884369113108183, 'recall': 0.6150481853739972, 'f1-score': 0.498328806018534, 'support': 144961}, '2': {'precision': 0.42777028539888673, 'recall': 0.5671796358816097, 'f1-score': 0.4877081539968535, 'support': 144843}, 'accuracy': 0.4316794436610338, 'macro avg': {'precision': 0.4641589380635344, 'recall': 0.4321926965912479, 'f1-score': 0.3917086978124326, 'support': 435418}, 'weighted avg': {'precision': 0.4642913315508302, 'recall': 0.4316794436610338, 'f1-score': 0.39137881133236796, 'support': 435418}}
[[16651 68542 60421]
 [ 6329 89158 49474]
 [ 7524 55167 82152]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0707427
{'0': {'precision': 0.5300830914005406, 'recall': 0.108266710286871, 'f1-score': 0.17980847595762023, 'support': 48907}, '1': {'precision': 0.39776228311983136, 'recall': 0.571540530808498, 'f1-score': 0.4690737779013977, 'support': 47211}, '2': {'precision': 0.4129663460812586, 'recall': 0.5705346154648422, 'f1-score': 0.47912834796013104, 'support': 47941}, 'accuracy': 0.41392762687509976, 'macro avg': {'precision': 0.44693724020054343, 'recall': 0.41678061885340373, 'f1-score': 0.3760035339397163, 'support': 144059}, 'weighted avg': {'precision': 0.44774396946374895, 'recall': 0.41392762687509976, 'f1-score': 0.37421630992661936, 'support': 144059}}
[[ 5295 22777 20835]
 [ 2182 26983 18046]
 [ 2512 18077 27352]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
7459/7459 - 53s - 53s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.090357
{'0': {'precision': 0.5094288104477959, 'recall': 0.1183917760724103, 'f1-score': 0.19213190184049078, 'support': 740668}, '1': {'precision': 0.2745503042551136, 'recall': 0.45118326939372555, 'f1-score': 0.34137184328970416, 'support': 409501}, '2': {'precision': 0.44569915915216074, 'recall': 0.6248297285405265, 'f1-score': 0.5202775708818229, 'support': 759082}, 'accuracy': 0.39111986847198194, 'macro avg': {'precision': 0.40989275795169006, 'recall': 0.39813492466888745, 'f1-score': 0.3512604386706726, 'support': 1909251}, 'weighted avg': {'precision': 0.4337137712365015, 'recall': 0.39111986847198194, 'f1-score': 0.35460575991919646, 'support': 1909251}}
[[ 87689 258679 394300]
 [ 29174 184760 195567]
 [ 55269 229516 474297]]
Evaluating performance on  train set...
1664/1664 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0487204
{'0': {'precision': 0.5489396190733487, 'recall': 0.14147948028798618, 'f1-score': 0.22497550281510023, 'support': 143618}, '1': {'precision': 0.41778508707526946, 'recall': 0.6083690298853196, 'f1-score': 0.4953788206344002, 'support': 140303}, '2': {'precision': 0.43847012055761964, 'recall': 0.5699722617254052, 'f1-score': 0.49564716974201367, 'support': 142042}, 'accuracy': 0.43814838377981186, 'macro avg': {'precision': 0.4683982755687459, 'recall': 0.4399402572995703, 'f1-score': 0.4053338310638381, 'support': 425963}, 'weighted avg': {'precision': 0.468902895669913, 'recall': 0.43814838377981186, 'f1-score': 0.404298922017317, 'support': 425963}}
[[20319 66685 56614]
 [ 7879 85356 47068]
 [ 8817 52265 80960]]
Evaluating performance on  val set...
517/517 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0604012
{'0': {'precision': 0.5212747778537252, 'recall': 0.12820728350179672, 'f1-score': 0.20579851916817057, 'support': 47587}, '1': {'precision': 0.37458352330515904, 'recall': 0.5900665727466092, 'f1-score': 0.45825780085168455, 'support': 36201}, '2': {'precision': 0.4518488163162374, 'recall': 0.5924609407291064, 'f1-score': 0.512688448951124, 'support': 48388}, 'accuracy': 0.424661057983295, 'macro avg': {'precision': 0.44923570582504063, 'recall': 0.4369115989925041, 'f1-score': 0.3922482563236597, 'support': 132176}, 'weighted avg': {'precision': 0.4556822835068801, 'recall': 0.424661057983295, 'f1-score': 0.38729189450531526, 'support': 132176}}
[[ 6101 19374 22112]
 [ 2174 21361 12666]
 [ 3429 16291 28668]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
8238/8238 - 65s - 65s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100076
{'0': {'precision': 0.45150273224043713, 'recall': 0.18555434743949964, 'f1-score': 0.2630166040698156, 'support': 787268}, '1': {'precision': 0.3294066914498141, 'recall': 0.2083209515247492, 'f1-score': 0.2552307522144286, 'support': 531694}, '2': {'precision': 0.4073675565248599, 'recall': 0.7473776577963716, 'f1-score': 0.5273153012142913, 'support': 789752}, 'accuracy': 0.40170786555218013, 'macro avg': {'precision': 0.3960923267383703, 'recall': 0.38041765225354013, 'f1-score': 0.3485208858328452, 'support': 2108714}, 'weighted avg': {'precision': 0.40418784003416447, 'recall': 0.40170786555218013, 'f1-score': 0.36003816979700565, 'support': 2108714}}
[[146081 120358 520829]
 [ 83083 110763 337848]
 [ 94380 105129 590243]]
Evaluating performance on  train set...
1806/1806 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097717
{'0': {'precision': 0.4550997134335341, 'recall': 0.20112038664323376, 'f1-score': 0.2789607642809772, 'support': 154768}, '1': {'precision': 0.4086490864908649, 'recall': 0.35453959825873077, 'f1-score': 0.37967618191510494, 'support': 153681}, '2': {'precision': 0.3881313955497533, 'recall': 0.6576043821642791, 'f1-score': 0.48814798538690185, 'support': 153714}, 'accuracy': 0.40396137293552276, 'macro avg': {'precision': 0.4172933984913841, 'recall': 0.40442145568874793, 'f1-score': 0.38226164386099465, 'support': 462163}, 'weighted avg': {'precision': 0.41738023607519126, 'recall': 0.40396137293552276, 'f1-score': 0.38202624248348693, 'support': 462163}}
[[ 31127  42846  80795]
 [ 20638  54486  78557]
 [ 16631  36000 101083]]
Evaluating performance on  val set...
642/642 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0911692
{'0': {'precision': 0.46196435001800507, 'recall': 0.18873441465298466, 'f1-score': 0.26798443742329686, 'support': 54378}, '1': {'precision': 0.4294852810519457, 'recall': 0.3944977421519378, 'f1-score': 0.41124870025522264, 'support': 55141}, '2': {'precision': 0.3959456356539139, 'recall': 0.660766746346003, 'f1-score': 0.4951729796253247, 'support': 54803}, 'accuracy': 0.4152091624980222, 'macro avg': {'precision': 0.4291317555746215, 'recall': 0.4146663010503085, 'f1-score': 0.39146870576794807, 'support': 164322}, 'weighted avg': {'precision': 0.4290475650156757, 'recall': 0.4152091624980222, 'f1-score': 0.3918287698627326, 'support': 164322}}
[[10263 15744 28371]
 [ 6514 21753 26874]
 [ 5439 13152 36212]]
testing model on single stock: results/universal/W5/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
31315/31315 - 221s - 221s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.074491
{'0': {'precision': 0.4705834520233753, 'recall': 0.16912355080792618, 'f1-score': 0.24882248906264548, 'support': 3319177}, '1': {'precision': 0.19403596945343865, 'recall': 0.1056881395239513, 'f1-score': 0.1368411815934845, 'support': 1276340}, '2': {'precision': 0.4430673771074417, 'recall': 0.7937210188107522, 'f1-score': 0.5686856233777072, 'support': 3420969}, 'accuracy': 0.4255655158631849, 'macro avg': {'precision': 0.3692289328614186, 'recall': 0.35617756971420994, 'f1-score': 0.31811643134461237, 'support': 8016486}, 'weighted avg': {'precision': 0.4148108537562044, 'recall': 0.4255655158631849, 'f1-score': 0.36749239564758474, 'support': 8016486}}
[[ 561351  295811 2462015]
 [ 190354  134894  951092]
 [ 441178  264496 2715295]]
Evaluating performance on  train set...
5759/5759 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1745536
{'0': {'precision': 0.4256485873808824, 'recall': 0.16494667168261262, 'f1-score': 0.23775781033600893, 'support': 491765}, '1': {'precision': 0.36108498268992095, 'recall': 0.22724507204374012, 'f1-score': 0.2789413263697032, 'support': 486510}, '2': {'precision': 0.3683621437574686, 'recall': 0.7260499660211697, 'f1-score': 0.4887543176266408, 'support': 495897}, 'accuracy': 0.37425619262881127, 'macro avg': {'precision': 0.385031904609424, 'recall': 0.37274723658250747, 'f1-score': 0.3351511514441176, 'support': 1474172}, 'weighted avg': {'precision': 0.3850705443494588, 'recall': 0.37425619262881127, 'f1-score': 0.33578206216107076, 'support': 1474172}}
[[ 81115 108454 302196]
 [ 60771 110557 315182]
 [ 48682  87169 360046]]
Evaluating performance on  val set...
2129/2129 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1585674
{'0': {'precision': 0.39947683588290356, 'recall': 0.1659343059084203, 'f1-score': 0.23447331185838574, 'support': 187749}, '1': {'precision': 0.3530701754385965, 'recall': 0.2419468211455026, 'f1-score': 0.2871319880913001, 'support': 165028}, '2': {'precision': 0.3827928729882865, 'recall': 0.7049067718551438, 'f1-score': 0.4961540433823906, 'support': 192163}, 'accuracy': 0.37901236833412855, 'macro avg': {'precision': 0.3784466281032622, 'recall': 0.37092929963635557, 'f1-score': 0.33925311444402545, 'support': 544940}, 'weighted avg': {'precision': 0.37953989104214786, 'recall': 0.37901236833412855, 'f1-score': 0.34269717216082773, 'support': 544940}}
[[ 31154  38553 118042]
 [ 24734  39928 100366]
 [ 22099  34607 135457]]
training model: results/universal/W5/deepVOL_L2/h200
Epoch 1/50
9913/9913 - 322s - loss: 3.2363 - accuracy200: 0.3954 - val_loss: 3.4460 - val_accuracy200: 0.3265 - 322s/epoch - 32ms/step
Epoch 2/50
9913/9913 - 315s - loss: 3.2176 - accuracy200: 0.4058 - val_loss: 3.4169 - val_accuracy200: 0.3374 - 315s/epoch - 32ms/step
Epoch 3/50
9913/9913 - 316s - loss: 3.2085 - accuracy200: 0.4102 - val_loss: 3.3988 - val_accuracy200: 0.3400 - 316s/epoch - 32ms/step
Epoch 4/50
9913/9913 - 317s - loss: 3.2055 - accuracy200: 0.4120 - val_loss: 3.3688 - val_accuracy200: 0.3489 - 317s/epoch - 32ms/step
Epoch 5/50
9913/9913 - 309s - loss: 3.2002 - accuracy200: 0.4140 - val_loss: 3.3628 - val_accuracy200: 0.3592 - 309s/epoch - 31ms/step
Epoch 6/50
9913/9913 - 310s - loss: 3.1959 - accuracy200: 0.4157 - val_loss: 3.3612 - val_accuracy200: 0.3625 - 310s/epoch - 31ms/step
Epoch 7/50
9913/9913 - 307s - loss: 3.1925 - accuracy200: 0.4167 - val_loss: 3.3640 - val_accuracy200: 0.3596 - 307s/epoch - 31ms/step
Epoch 8/50
9913/9913 - 315s - loss: 3.1894 - accuracy200: 0.4180 - val_loss: 3.3730 - val_accuracy200: 0.3622 - 315s/epoch - 32ms/step
Epoch 9/50
9913/9913 - 312s - loss: 3.1879 - accuracy200: 0.4187 - val_loss: 3.3741 - val_accuracy200: 0.3627 - 312s/epoch - 31ms/step
Epoch 10/50
9913/9913 - 310s - loss: 3.1856 - accuracy200: 0.4200 - val_loss: 3.3836 - val_accuracy200: 0.3593 - 310s/epoch - 31ms/step
Epoch 11/50
9913/9913 - 313s - loss: 3.1832 - accuracy200: 0.4207 - val_loss: 3.3907 - val_accuracy200: 0.3551 - 313s/epoch - 32ms/step
Epoch 12/50
9913/9913 - 311s - loss: 3.1818 - accuracy200: 0.4215 - val_loss: 3.3899 - val_accuracy200: 0.3569 - 311s/epoch - 31ms/step
Epoch 13/50
9913/9913 - 315s - loss: 3.1800 - accuracy200: 0.4225 - val_loss: 3.3936 - val_accuracy200: 0.3567 - 315s/epoch - 32ms/step
Epoch 14/50
9913/9913 - 315s - loss: 3.1782 - accuracy200: 0.4232 - val_loss: 3.4051 - val_accuracy200: 0.3531 - 315s/epoch - 32ms/step
Epoch 15/50
9913/9913 - 313s - loss: 3.1769 - accuracy200: 0.4236 - val_loss: 3.4040 - val_accuracy200: 0.3538 - 313s/epoch - 32ms/step
Epoch 16/50
9913/9913 - 309s - loss: 3.1751 - accuracy200: 0.4244 - val_loss: 3.4016 - val_accuracy200: 0.3549 - 309s/epoch - 31ms/step
testing model in sample: results/universal/W5/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 769s - 769s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1247958
{'0': {'precision': 0.4283608876278783, 'recall': 0.15215482209171957, 'f1-score': 0.22454921910572562, 'support': 4798540}, '1': {'precision': 0.22838316099192515, 'recall': 0.23019609327728774, 'f1-score': 0.22928604354088658, 'support': 3116986}, '2': {'precision': 0.3993213891178271, 'recall': 0.648293219497183, 'f1-score': 0.49422248761408566, 'support': 4922865}, 'accuracy': 0.3613458259683788, 'macro avg': {'precision': 0.3520218125792101, 'recall': 0.34354804495539676, 'f1-score': 0.3160192500868993, 'support': 12838391}, 'weighted avg': {'precision': 0.3686738672630384, 'recall': 0.3613458259683788, 'f1-score': 0.32910513350529974, 'support': 12838391}}
[[ 730121 1246855 2821564]
 [ 420283  717518 1979185]
 [ 554049 1177356 3191460]]
Evaluating performance on  train set...
9913/9913 - 159s - 159s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072941
{'0': {'precision': 0.4230536086379996, 'recall': 0.1598588449190971, 'f1-score': 0.23203779848255404, 'support': 838227}, '1': {'precision': 0.36501455927186205, 'recall': 0.31904754089135656, 'f1-score': 0.34048662394084694, 'support': 852992}, '2': {'precision': 0.36915414451556905, 'recall': 0.6436391452494283, 'f1-score': 0.46920148552014324, 'support': 845814}, 'accuracy': 0.37466678596612657, 'macro avg': {'precision': 0.38574077080847696, 'recall': 0.3741818436866273, 'f1-score': 0.34724196931451473, 'support': 2537033}, 'weighted avg': {'precision': 0.38557054627965825, 'recall': 0.37466678596612657, 'f1-score': 0.34756737468961624, 'support': 2537033}}
[[133998 254818 449411]
 [ 99937 272145 480910]
 [ 82805 218610 544399]]
Evaluating performance on  val set...
3496/3496 - 54s - 54s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192015
{'0': {'precision': 0.399525390741705, 'recall': 0.15285434356629654, 'f1-score': 0.22111307691762588, 'support': 306200}, '1': {'precision': 0.3259256895809071, 'recall': 0.2925372920611851, 'f1-score': 0.3083302363223734, 'support': 279349}, '2': {'precision': 0.37163381705292037, 'recall': 0.6337026597984903, 'f1-score': 0.4685104813367058, 'support': 308670}, 'accuracy': 0.36247160930376116, 'macro avg': {'precision': 0.3656949657918442, 'recall': 0.35969809847532397, 'f1-score': 0.3326512648589017, 'support': 894219}, 'weighted avg': {'precision': 0.3669055347890974, 'recall': 0.36247160930376116, 'f1-score': 0.3337568287106365, 'support': 894219}}
[[ 46804  89366 170030]
 [ 36926  81720 160703]
 [ 33419  79646 195605]]
testing model out of sample: results/universal/W5/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 322s - 322s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223147
{'0': {'precision': 0.41235514226337083, 'recall': 0.15770896989034597, 'f1-score': 0.22815716102404807, 'support': 1929979}, '1': {'precision': 0.28325524703897803, 'recall': 0.2630065946240205, 'f1-score': 0.27275563567212074, 'support': 1465891}, '2': {'precision': 0.3863444941769846, 'recall': 0.6428488039267292, 'f1-score': 0.4826325558919913, 'support': 1952974}, 'accuracy': 0.36370120347499385, 'macro avg': {'precision': 0.36065162782644444, 'recall': 0.35452145614703184, 'f1-score': 0.32784845086272, 'support': 5348844}, 'weighted avg': {'precision': 0.3674773155878794, 'recall': 0.36370120347499385, 'f1-score': 0.3332939592588002, 'support': 5348844}}
[[ 304375  511340 1114264]
 [ 200478  385539  879874]
 [ 233285  464222 1255467]]
Evaluating performance on  train set...
4957/4957 - 79s - 79s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113138
{'0': {'precision': 0.4104114005202037, 'recall': 0.15762296927175176, 'f1-score': 0.22776883587753924, 'support': 426448}, '1': {'precision': 0.3659015563186849, 'recall': 0.3369309434922992, 'f1-score': 0.3508191685185598, 'support': 420279}, '2': {'precision': 0.3656075667645448, 'recall': 0.6222353462977062, 'f1-score': 0.4605873016987717, 'support': 421617}, 'accuracy': 0.37148281538762357, 'macro avg': {'precision': 0.3806401745344778, 'recall': 0.3722630863539191, 'f1-score': 0.34639176869829025, 'support': 1268344}, 'weighted avg': {'precision': 0.3807691183099123, 'recall': 0.37148281538762357, 'f1-score': 0.3459352748374634, 'support': 1268344}}
[[ 67218 131261 227969]
 [ 51429 141605 227245]
 [ 45135 114137 262345]]
Evaluating performance on  val set...
1701/1701 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144787
{'0': {'precision': 0.4138061721710882, 'recall': 0.15425342258400887, 'f1-score': 0.2247335277253682, 'support': 148645}, '1': {'precision': 0.35666971666314745, 'recall': 0.3281645751784481, 'f1-score': 0.3418239052633552, 'support': 138976}, '2': {'precision': 0.37080061796793395, 'recall': 0.6331933998413032, 'f1-score': 0.4677089699532115, 'support': 147451}, 'accuracy': 0.3721246138570168, 'macro avg': {'precision': 0.38042550226738986, 'recall': 0.37187046586792, 'f1-score': 0.34475546764731163, 'support': 435072}, 'weighted avg': {'precision': 0.3809798629315121, 'recall': 0.3721246138570168, 'f1-score': 0.34448318810493067, 'support': 435072}}
[[22929 43652 82064]
 [17005 45607 76364]
 [15476 38610 93365]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1276019
{'0': {'precision': 0.3781104275245895, 'recall': 0.10587589839249464, 'f1-score': 0.16542938947657174, 'support': 91135}, '1': {'precision': 0.31540390230816057, 'recall': 0.3787340015611255, 'f1-score': 0.344179971626095, 'support': 80711}, '2': {'precision': 0.3801214368232987, 'recall': 0.5689325853991998, 'f1-score': 0.455745335362662, 'support': 99474}, 'accuracy': 0.3568148311956362, 'macro avg': {'precision': 0.35787858888534957, 'recall': 0.35118082845093995, 'f1-score': 0.32178489882177624, 'support': 271320}, 'weighted avg': {'precision': 0.3601940807098932, 'recall': 0.3568148311956362, 'f1-score': 0.32504175361096327, 'support': 271320}}
[[ 9649 31726 49760]
 [ 7613 30568 42530]
 [ 8257 34623 56594]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1356087
{'0': {'precision': 0.4401463669628855, 'recall': 0.10381390761137596, 'f1-score': 0.16800239433341094, 'support': 24332}, '1': {'precision': 0.3351405831856254, 'recall': 0.4356842723534993, 'f1-score': 0.37885514477664717, 'support': 22133}, '2': {'precision': 0.3676081576926359, 'recall': 0.5569729357007412, 'f1-score': 0.4428985109919295, 'support': 23204}, 'accuracy': 0.36017453960872126, 'macro avg': {'precision': 0.38096503594704895, 'recall': 0.3654903718885388, 'f1-score': 0.32991868336732916, 'support': 69669}, 'weighted avg': {'precision': 0.38262767686759247, 'recall': 0.36017453960872126, 'f1-score': 0.32654483668947193, 'support': 69669}}
[[ 2526 10376 11430]
 [ 1687  9643 10803]
 [ 1526  8754 12924]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1435599
{'0': {'precision': 0.44967032967032966, 'recall': 0.11398328690807799, 'f1-score': 0.18186666666666668, 'support': 8975}, '1': {'precision': 0.3005696530295184, 'recall': 0.411281179138322, 'f1-score': 0.3473161390700736, 'support': 7056}, '2': {'precision': 0.388195052104049, 'recall': 0.5761511216056671, 'f1-score': 0.4638562805950287, 'support': 8470}, 'accuracy': 0.3593730868127831, 'macro avg': {'precision': 0.37947834493463234, 'recall': 0.3671385292173557, 'f1-score': 0.3310130287772563, 'support': 24501}, 'weighted avg': {'precision': 0.3854790731761473, 'recall': 0.3593730868127831, 'f1-score': 0.32699802894786606, 'support': 24501}}
[[1023 3719 4233]
 [ 696 2902 3458]
 [ 556 3034 4880]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1552203
{'0': {'precision': 0.5259605518184928, 'recall': 0.10519594831871645, 'f1-score': 0.1753255144001642, 'support': 219267}, '1': {'precision': 0.20535921740821, 'recall': 0.3493594914652641, 'f1-score': 0.2586687292632886, 'support': 123964}, '2': {'precision': 0.43515118471270636, 'recall': 0.613436740363468, 'f1-score': 0.5091375132821071, 'support': 215975}, 'accuracy': 0.3556131371980987, 'macro avg': {'precision': 0.3888236513131364, 'recall': 0.3559973933824829, 'f1-score': 0.31437725231518665, 'support': 559206}, 'weighted avg': {'precision': 0.4198179552091779, 'recall': 0.3556131371980987, 'f1-score': 0.32272487124866, 'support': 559206}}
[[ 23066  96655  99546]
 [  8227  43308  72429]
 [ 12562  70926 132487]]
Evaluating performance on  train set...
589/589 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953345
{'0': {'precision': 0.5260885210507377, 'recall': 0.12585004734440905, 'f1-score': 0.2031119755487635, 'support': 46468}, '1': {'precision': 0.3655888444743473, 'recall': 0.503077062721249, 'f1-score': 0.4234524700884739, 'support': 55085}, '2': {'precision': 0.39771693793709034, 'recall': 0.5161789246611583, 'f1-score': 0.44927022814227, 'support': 49138}, 'accuracy': 0.3910253432520854, 'macro avg': {'precision': 0.4297981011540584, 'recall': 0.3817020115756054, 'f1-score': 0.3586115579265025, 'support': 150691}, 'weighted avg': {'precision': 0.42555798150126983, 'recall': 0.3910253432520854, 'f1-score': 0.3639256960606698, 'support': 150691}}
[[ 5848 26615 14005]
 [ 2968 27712 24405]
 [ 2300 21474 25364]]
Evaluating performance on  val set...
222/222 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1265904
{'0': {'precision': 0.47978806907378335, 'recall': 0.12453522131105792, 'f1-score': 0.1977435399733107, 'support': 19633}, '1': {'precision': 0.29964839171767155, 'recall': 0.556839494222276, 'f1-score': 0.38962853211980103, 'support': 16529}, '2': {'precision': 0.4450470339796506, 'recall': 0.4526505906472713, 'f1-score': 0.44881661100624365, 'support': 20486}, 'accuracy': 0.36933342748199405, 'macro avg': {'precision': 0.40816116492370186, 'recall': 0.37800843539353507, 'f1-score': 0.3453962276997851, 'support': 56648}, 'weighted avg': {'precision': 0.414662494085124, 'recall': 0.36933342748199405, 'f1-score': 0.3445298337236638, 'support': 56648}}
[[ 2445 11585  5603]
 [ 1365  9204  5960]
 [ 1286  9927  9273]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
2341/2341 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.154117
{'0': {'precision': 0.40319303338171264, 'recall': 0.12782581087485678, 'f1-score': 0.19411166661426071, 'support': 217327}, '1': {'precision': 0.26199397132152014, 'recall': 0.4270168510950916, 'f1-score': 0.32474334799916194, 'support': 152453}, '2': {'precision': 0.41762089221862764, 'recall': 0.5129736866184755, 'f1-score': 0.4604121570490822, 'support': 229503}, 'accuracy': 0.3514349647829156, 'macro avg': {'precision': 0.36093596564062014, 'recall': 0.355938782862808, 'f1-score': 0.3264223905541683, 'support': 599283}, 'weighted avg': {'precision': 0.37279840559882205, 'recall': 0.3514349647829156, 'f1-score': 0.3293265036419007, 'support': 599283}}
[[ 27780  95243  94304]
 [ 17482  65100  69871]
 [ 23638  88136 117729]]
Evaluating performance on  train set...
483/483 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1415993
{'0': {'precision': 0.3746907034287734, 'recall': 0.10246000676622687, 'f1-score': 0.1609169228433717, 'support': 41382}, '1': {'precision': 0.3351173235948453, 'recall': 0.3919821279520793, 'f1-score': 0.36132609187599, 'support': 40734}, '2': {'precision': 0.35397489539748955, 'recall': 0.5520591647331786, 'f1-score': 0.43136366211546084, 'support': 41376}, 'accuracy': 0.3485974799987044, 'macro avg': {'precision': 0.35459430747370274, 'recall': 0.3488337664838283, 'f1-score': 0.3178688922782742, 'support': 123492}, 'weighted avg': {'precision': 0.3546965392136208, 'recall': 0.3485974799987044, 'f1-score': 0.31763534489092654, 'support': 123492}}
[[ 4240 16490 20652]
 [ 3731 15967 21036]
 [ 3345 15189 22842]]
Evaluating performance on  val set...
162/162 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1619148
{'0': {'precision': 0.3928911456680419, 'recall': 0.08184041779599392, 'f1-score': 0.13546339862129336, 'support': 15127}, '1': {'precision': 0.2951776968479216, 'recall': 0.4137475796514698, 'f1-score': 0.344547053649956, 'support': 11362}, '2': {'precision': 0.3810123168210015, 'recall': 0.5713900498853984, 'f1-score': 0.45717367853290186, 'support': 14834}, 'accuracy': 0.3488372093023256, 'macro avg': {'precision': 0.35636038644565504, 'recall': 0.3556593491109541, 'f1-score': 0.31239471026805044, 'support': 41323}, 'weighted avg': {'precision': 0.3617600382312342, 'recall': 0.3488372093023256, 'f1-score': 0.3084387097227252, 'support': 41323}}
[[1238 5913 7976]
 [ 867 4701 5794]
 [1046 5312 8476]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
2027/2027 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1680613
{'0': {'precision': 0.26744186046511625, 'recall': 0.0019461014511147777, 'f1-score': 0.0038640850098702172, 'support': 165459}, '1': {'precision': 0.380386532814314, 'recall': 0.028650347456188628, 'f1-score': 0.05328715750803612, 'support': 194413}, '2': {'precision': 0.30547283462218955, 'recall': 0.966397283104305, 'f1-score': 0.4642111066635449, 'support': 159005}, 'accuracy': 0.30749869429556526, 'macro avg': {'precision': 0.3177670759672066, 'recall': 0.33233124400386943, 'f1-score': 0.17378744972715043, 'support': 518877}, 'weighted avg': {'precision': 0.32141424241935596, 'recall': 0.30749869429556526, 'f1-score': 0.16345097356270352, 'support': 518877}}
[[   322   4146 160991]
 [   466   5570 188377]
 [   416   4927 153662]]
Evaluating performance on  train set...
331/331 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1536468
{'0': {'precision': 0.2644927536231884, 'recall': 0.0026240115025161753, 'f1-score': 0.005196469248291571, 'support': 27820}, '1': {'precision': 0.32245879120879123, 'recall': 0.03367643366926084, 'f1-score': 0.06098392596200682, 'support': 27883}, '2': {'precision': 0.34015002459419574, 'recall': 0.9602846727998612, 'f1-score': 0.5023564131668559, 'support': 28805}, 'accuracy': 0.3392933213423581, 'macro avg': {'precision': 0.3090338564753918, 'recall': 0.3321950393238794, 'f1-score': 0.18951226945905142, 'support': 84508}, 'weighted avg': {'precision': 0.3094065454099924, 'recall': 0.3392933213423581, 'f1-score': 0.19306287053719637, 'support': 84508}}
[[   73   937 26810]
 [   95   939 26849]
 [  108  1036 27661]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1570525
{'0': {'precision': 0.38333333333333336, 'recall': 0.0038180610889774237, 'f1-score': 0.007560815253122946, 'support': 12048}, '1': {'precision': 0.27990235964198534, 'recall': 0.031667126944674585, 'f1-score': 0.05689712206417466, 'support': 10863}, '2': {'precision': 0.3399088619738578, 'recall': 0.9613362726810243, 'f1-score': 0.5022369878183832, 'support': 11794}, 'accuracy': 0.3379340152715747, 'macro avg': {'precision': 0.3343815183163921, 'recall': 0.33227382023822544, 'f1-score': 0.18889830837856028, 'support': 34705}, 'weighted avg': {'precision': 0.33620125200721984, 'recall': 0.3379340152715747, 'f1-score': 0.19111220785139796, 'support': 34705}}
[[   46   460 11542]
 [   43   344 10476]
 [   31   425 11338]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
2900/2900 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.151299
{'0': {'precision': 0.3619357052045285, 'recall': 0.06810354320692313, 'f1-score': 0.11463653156579376, 'support': 263349}, '1': {'precision': 0.3054187717924998, 'recall': 0.390913106639161, 'f1-score': 0.342917521387154, 'support': 219591}, '2': {'precision': 0.35693693912494384, 'recall': 0.5665258386079609, 'f1-score': 0.4379472646734102, 'support': 259418}, 'accuracy': 0.3377656063516524, 'macro avg': {'precision': 0.3414304720406574, 'recall': 0.3418474961513483, 'f1-score': 0.298500439208786, 'support': 742358}, 'weighted avg': {'precision': 0.3434710563104444, 'recall': 0.3377656063516524, 'f1-score': 0.2951438805768827, 'support': 742358}}
[[ 17935  98413 147001]
 [ 15973  85841 117777]
 [ 15645  96806 146967]]
Evaluating performance on  train set...
694/694 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1402673
{'0': {'precision': 0.372800814617865, 'recall': 0.11000934829059829, 'f1-score': 0.1698869568579936, 'support': 59904}, '1': {'precision': 0.3321308451773896, 'recall': 0.41769712268253995, 'f1-score': 0.37003180551043685, 'support': 58631}, '2': {'precision': 0.3502419102205618, 'recall': 0.5110637073154215, 'f1-score': 0.4156385966844744, 'support': 59067}, 'accuracy': 0.3449679620724992, 'macro avg': {'precision': 0.3517245233386055, 'recall': 0.34625672609618663, 'f1-score': 0.31851911968430163, 'support': 177602}, 'weighted avg': {'precision': 0.35187195241867797, 'recall': 0.3449679620724992, 'f1-score': 0.31769218839239155, 'support': 177602}}
[[ 6590 25264 28050]
 [ 6189 24490 27952]
 [ 4898 23982 30187]]
Evaluating performance on  val set...
238/238 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1378126
{'0': {'precision': 0.3402653280745787, 'recall': 0.09550646605947768, 'f1-score': 0.14914934580173667, 'support': 19873}, '1': {'precision': 0.340321960801059, 'recall': 0.379415405122346, 'f1-score': 0.3588069780528982, 'support': 21006}, '2': {'precision': 0.3350800125509884, 'recall': 0.5342705623374024, 'f1-score': 0.4118554514250453, 'support': 19988}, 'accuracy': 0.33757208339494305, 'macro avg': {'precision': 0.33855576714220864, 'recall': 0.33639747783974205, 'f1-score': 0.3066039250932267, 'support': 60867}, 'weighted avg': {'precision': 0.3385820767293, 'recall': 0.33757208339494305, 'f1-score': 0.3077745098851742, 'support': 60867}}
[[ 1898  7699 10276]
 [ 2121  7970 10915]
 [ 1559  7750 10679]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
7167/7167 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176771
{'0': {'precision': 0.47066798474791693, 'recall': 0.2044189152512225, 'f1-score': 0.28504015967654167, 'support': 652151}, '1': {'precision': 0.23498449989472997, 'recall': 0.26024450939322913, 'f1-score': 0.24697028947493918, 'support': 497486}, '2': {'precision': 0.4168270244820151, 'recall': 0.6087885840095542, 'f1-score': 0.49484335439188604, 'support': 684934}, 'accuracy': 0.37052804170566306, 'macro avg': {'precision': 0.3741598363748873, 'recall': 0.35781733621800194, 'f1-score': 0.3422846011811223, 'support': 1834571}, 'weighted avg': {'precision': 0.38665557071518786, 'recall': 0.37052804170566306, 'f1-score': 0.35304631148099364, 'support': 1834571}}
[[133312 223082 295757]
 [ 80388 129468 287630]
 [ 69540 198414 416980]]
Evaluating performance on  train set...
1570/1570 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921255
{'0': {'precision': 0.48196870530102726, 'recall': 0.16439115618601283, 'f1-score': 0.24516185930119117, 'support': 135281}, '1': {'precision': 0.36106018633648135, 'recall': 0.45935605391724055, 'f1-score': 0.4043195984781025, 'support': 135912}, '2': {'precision': 0.40279450734762706, 'recall': 0.5637135457373608, 'f1-score': 0.46985789557719937, 'support': 130506}, 'accuracy': 0.39392430650810684, 'macro avg': {'precision': 0.41527446632837856, 'recall': 0.3958202519468714, 'f1-score': 0.37311311778549766, 'support': 401699}, 'weighted avg': {'precision': 0.41533765442060233, 'recall': 0.39392430650810684, 'f1-score': 0.3720121316624594, 'support': 401699}}
[[22239 63134 49908]
 [14312 62432 59168]
 [ 9591 47347 73568]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1150032
{'0': {'precision': 0.48923140439000895, 'recall': 0.15783514995449197, 'f1-score': 0.23867069486404835, 'support': 45047}, '1': {'precision': 0.30313001605136436, 'recall': 0.3969730411477219, 'f1-score': 0.3437620878745819, 'support': 38058}, '2': {'precision': 0.39562050931130555, 'recall': 0.5693985226873022, 'f1-score': 0.46686277902751344, 'support': 42645}, 'accuracy': 0.3697813121272366, 'macro avg': {'precision': 0.39599397658422636, 'recall': 0.374735571263172, 'f1-score': 0.34976518725538125, 'support': 125750}, 'weighted avg': {'precision': 0.4011623526363434, 'recall': 0.3697813121272366, 'f1-score': 0.3478621037256456, 'support': 125750}}
[[ 7110 19716 18221]
 [ 4076 15108 18874]
 [ 3347 15016 24282]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
6357/6357 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1258637
{'0': {'precision': 0.44222557668250034, 'recall': 0.15778230528384113, 'f1-score': 0.23258151448202188, 'support': 607153}, '1': {'precision': 0.22357259799723403, 'recall': 0.17620164042730294, 'f1-score': 0.19708052563343312, 'support': 419281}, '2': {'precision': 0.38935967906645597, 'recall': 0.7000541003936844, 'f1-score': 0.5004027762408423, 'support': 600735}, 'accuracy': 0.3627299930124038, 'macro avg': {'precision': 0.3517192845820634, 'recall': 0.34467934870160954, 'f1-score': 0.31002160545209906, 'support': 1627169}, 'weighted avg': {'precision': 0.3663665635372698, 'recall': 0.3627299930124038, 'f1-score': 0.3223108023293566, 'support': 1627169}}
[[ 95798 142938 368417]
 [ 54268  73878 291135]
 [ 66561 113627 420547]]
Evaluating performance on  train set...
1701/1701 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064348
{'0': {'precision': 0.44133462908973115, 'recall': 0.1406701726369118, 'f1-score': 0.21334057135102125, 'support': 145276}, '1': {'precision': 0.3817952908217716, 'recall': 0.312560152351829, 'f1-score': 0.3437259560349649, 'support': 146503}, '2': {'precision': 0.36736050999899694, 'recall': 0.6884272377279151, 'f1-score': 0.4790754234332003, 'support': 143639}, 'accuracy': 0.3792034321043227, 'macro avg': {'precision': 0.3968301433034999, 'recall': 0.38055252090555197, 'f1-score': 0.34538065027306214, 'support': 435418}, 'weighted avg': {'precision': 0.3968985695645281, 'recall': 0.3792034321043227, 'f1-score': 0.34487334774194656, 'support': 435418}}
[[20436 41203 83637]
 [14057 45791 86655]
 [11812 32942 98885]]
Evaluating performance on  val set...
563/563 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135422
{'0': {'precision': 0.44094794094794093, 'recall': 0.13637182850391494, 'f1-score': 0.20831740107982438, 'support': 49937}, '1': {'precision': 0.3614849187935035, 'recall': 0.307587689472876, 'f1-score': 0.3323654550410657, 'support': 45587}, '2': {'precision': 0.37206790982465904, 'recall': 0.6885958586586999, 'f1-score': 0.48310205261636313, 'support': 48535}, 'accuracy': 0.37660264197308047, 'macro avg': {'precision': 0.39150025652203446, 'recall': 0.37751845887849694, 'f1-score': 0.34126163624575107, 'support': 144059}, 'weighted avg': {'precision': 0.3925957165015486, 'recall': 0.37660264197308047, 'f1-score': 0.34014985652000523, 'support': 144059}}
[[ 6810 13846 29281]
 [ 4442 14022 27123]
 [ 4192 10922 33421]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
7459/7459 - 67s - 67s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1390721
{'0': {'precision': 0.45443096192944676, 'recall': 0.14062554037121675, 'f1-score': 0.2147849803696499, 'support': 751798}, '1': {'precision': 0.1903191364380835, 'recall': 0.2770828564745062, 'f1-score': 0.22564803216783647, 'support': 397567}, '2': {'precision': 0.4174479318486562, 'recall': 0.6030786196876899, 'f1-score': 0.49338044591150887, 'support': 759886}, 'accuracy': 0.3530976283369761, 'macro avg': {'precision': 0.3540660100720621, 'recall': 0.34026233884447094, 'f1-score': 0.3112711528163317, 'support': 1909251}, 'weighted avg': {'precision': 0.38471512418936105, 'recall': 0.3530976283369761, 'f1-score': 0.3279286083384139, 'support': 1909251}}
[[105722 242156 403920]
 [ 51807 110159 235601]
 [ 75118 226497 458271]]
Evaluating performance on  train set...
1664/1664 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924047
{'0': {'precision': 0.4524122054161029, 'recall': 0.15925925925925927, 'f1-score': 0.235586705855754, 'support': 140670}, '1': {'precision': 0.39200870646766167, 'recall': 0.42821526588951386, 'f1-score': 0.4093128660666744, 'support': 147204}, '2': {'precision': 0.3772374840014097, 'recall': 0.5891055768381261, 'f1-score': 0.4599457783130214, 'support': 138089}, 'accuracy': 0.3915527874486751, 'macro avg': {'precision': 0.4072194652950581, 'recall': 0.3921933673289664, 'f1-score': 0.3682817834118166, 'support': 425963}, 'weighted avg': {'precision': 0.40716780915483164, 'recall': 0.3915527874486751, 'f1-score': 0.3683557624269584, 'support': 425963}}
[[22403 53467 64800]
 [14674 63035 69495]
 [12442 44298 81349]]
Evaluating performance on  val set...
517/517 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044145
{'0': {'precision': 0.43455775096141097, 'recall': 0.14591357392523988, 'f1-score': 0.21847030783846394, 'support': 44917}, '1': {'precision': 0.35439106055105085, 'recall': 0.42005355264416183, 'f1-score': 0.3844386582937662, 'support': 41828}, '2': {'precision': 0.38549380887493334, 'recall': 0.5728907574123396, 'f1-score': 0.4608710280042852, 'support': 45431}, 'accuracy': 0.3794259169592059, 'macro avg': {'precision': 0.3914808734624651, 'recall': 0.3796192946605805, 'f1-score': 0.35459333137883847, 'support': 132176}, 'weighted avg': {'precision': 0.3923243933214816, 'recall': 0.3794259169592059, 'f1-score': 0.3543091233624457, 'support': 132176}}
[[ 6554 16817 21546]
 [ 4315 17570 19943]
 [ 4213 15191 26027]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
8238/8238 - 59s - 59s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995905
{'0': {'precision': 0.4058764874379435, 'recall': 0.20433013987736595, 'f1-score': 0.2718187438114318, 'support': 751015}, '1': {'precision': 0.322248669320183, 'recall': 0.2190854669911005, 'f1-score': 0.26083705227366594, 'support': 593855}, '2': {'precision': 0.3873267565510329, 'recall': 0.6728337199742356, 'f1-score': 0.49163595177578795, 'support': 763844}, 'accuracy': 0.3781925856232756, 'macro avg': {'precision': 0.37181730443638644, 'recall': 0.3654164422809007, 'f1-score': 0.34143058262029524, 'support': 2108714}, 'weighted avg': {'precision': 0.37560595356378895, 'recall': 0.3781925856232756, 'f1-score': 0.3483509444665067, 'support': 2108714}}
[[153455 143018 454542]
 [105342 130105 358408]
 [119286 130618 513940]]
Evaluating performance on  train set...
1806/1806 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933133
{'0': {'precision': 0.4046125351018701, 'recall': 0.21767360530748164, 'f1-score': 0.28306421611860944, 'support': 155554}, '1': {'precision': 0.3903459054685353, 'recall': 0.2985001116379254, 'f1-score': 0.3382999784166772, 'support': 152278}, '2': {'precision': 0.37086974773880854, 'recall': 0.6296790664221705, 'f1-score': 0.4668016456872762, 'support': 154331}, 'accuracy': 0.3818869100295783, 'macro avg': {'precision': 0.38860939610307127, 'recall': 0.38195092778919254, 'f1-score': 0.36272194674085423, 'support': 462163}, 'weighted avg': {'precision': 0.3886440306048991, 'recall': 0.3818869100295783, 'f1-score': 0.36261963845658773, 'support': 462163}}
[[33860 37726 83968]
 [25940 45455 80883]
 [23885 33267 97179]]
Evaluating performance on  val set...
642/642 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0899998
{'0': {'precision': 0.41279451960004154, 'recall': 0.21798549321250435, 'f1-score': 0.28530776220766174, 'support': 54733}, '1': {'precision': 0.40001502027737446, 'recall': 0.2960993236356898, 'f1-score': 0.34030092321453287, 'support': 53965}, '2': {'precision': 0.37723754359871375, 'recall': 0.6474902919603049, 'f1-score': 0.4767268708180837, 'support': 55624}, 'accuracy': 0.3890288579739779, 'macro avg': {'precision': 0.39668236115871, 'recall': 0.3871917029361664, 'f1-score': 0.36744518541342613, 'support': 164322}, 'weighted avg': {'precision': 0.39656134988420566, 'recall': 0.3890288579739779, 'f1-score': 0.368164606885075, 'support': 164322}}
[[11931 12432 30370]
 [ 8899 15979 29087]
 [ 8073 11535 36016]]
testing model on single stock: results/universal/W5/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
31315/31315 - 264s - 264s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1181226
{'0': {'precision': 0.4089147083324583, 'recall': 0.15525978739910262, 'f1-score': 0.2250651568279034, 'support': 3009865}, '1': {'precision': 0.24008849384262976, 'recall': 0.22547537345893684, 'f1-score': 0.23255259531253766, 'support': 1903556}, '2': {'precision': 0.3990516680846161, 'recall': 0.6540533311419516, 'f1-score': 0.495679107021964, 'support': 3103065}, 'accuracy': 0.3650085586128386, 'macro avg': {'precision': 0.3493516234199014, 'recall': 0.3449294973333304, 'f1-score': 0.3177656197208017, 'support': 8016486}, 'weighted avg': {'precision': 0.36500821257657845, 'recall': 0.3650085586128386, 'f1-score': 0.33159380738763605, 'support': 8016486}}
[[ 467311  681676 1860878]
 [ 278816  429205 1195535]
 [ 396681  676814 2029570]]
Evaluating performance on  train set...
5759/5759 - 53s - 53s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114227
{'0': {'precision': 0.3983502991870694, 'recall': 0.17120912809331376, 'f1-score': 0.2394875903474588, 'support': 487988}, '1': {'precision': 0.3530940519776724, 'recall': 0.2416431851602356, 'f1-score': 0.2869259432673924, 'support': 486908}, '2': {'precision': 0.36111346764502794, 'recall': 0.6735252645831163, 'f1-score': 0.47015259774077883, 'support': 499276}, 'accuracy': 0.3645985678740337, 'macro avg': {'precision': 0.37085260626992317, 'recall': 0.3621258592788886, 'f1-score': 0.33218871045187665, 'support': 1474172}, 'weighted avg': {'precision': 0.3707910421117638, 'recall': 0.3645985678740337, 'f1-score': 0.3332782849033493, 'support': 1474172}}
[[ 83548 110795 293645]
 [ 67953 117658 301297]
 [ 58234 104767 336275]]
Evaluating performance on  val set...
2129/2129 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.120718
{'0': {'precision': 0.36855607431183735, 'recall': 0.16424913982281705, 'f1-score': 0.2272313279835684, 'support': 184555}, '1': {'precision': 0.3294403446088089, 'recall': 0.22934137652480663, 'f1-score': 0.2704251025323873, 'support': 172071}, '2': {'precision': 0.36333784382801015, 'recall': 0.6616077402636023, 'f1-score': 0.4690729606300991, 'support': 188314}, 'accuracy': 0.3566741292619371, 'macro avg': {'precision': 0.3537780875828855, 'recall': 0.35173275220374195, 'f1-score': 0.3222431303820183, 'support': 544940}, 'weighted avg': {'precision': 0.35440158284293943, 'recall': 0.3566741292619371, 'f1-score': 0.32444305990008876, 'support': 544940}}
[[ 30313  41194 113048]
 [ 27342  39463 105266]
 [ 24593  39131 124590]]
training model: results/universal/W5/deepVOL_L3/h50
Epoch 1/50
9913/9913 - 539s - loss: 3.0145 - accuracy50: 0.4639 - val_loss: 3.2688 - val_accuracy50: 0.4601 - 539s/epoch - 54ms/step
Epoch 2/50
9913/9913 - 518s - loss: 2.9152 - accuracy50: 0.5037 - val_loss: 3.2041 - val_accuracy50: 0.4639 - 518s/epoch - 52ms/step
Epoch 3/50
9913/9913 - 512s - loss: 2.8956 - accuracy50: 0.5093 - val_loss: 3.1606 - val_accuracy50: 0.4755 - 512s/epoch - 52ms/step
Epoch 4/50
9913/9913 - 512s - loss: 2.8838 - accuracy50: 0.5125 - val_loss: 3.1695 - val_accuracy50: 0.4726 - 512s/epoch - 52ms/step
Epoch 5/50
9913/9913 - 508s - loss: 2.8755 - accuracy50: 0.5144 - val_loss: 3.1383 - val_accuracy50: 0.4730 - 508s/epoch - 51ms/step
Epoch 6/50
9913/9913 - 516s - loss: 2.8686 - accuracy50: 0.5158 - val_loss: 3.1120 - val_accuracy50: 0.4762 - 516s/epoch - 52ms/step
Epoch 7/50
9913/9913 - 518s - loss: 2.8635 - accuracy50: 0.5170 - val_loss: 3.1206 - val_accuracy50: 0.4720 - 518s/epoch - 52ms/step
Epoch 8/50
9913/9913 - 537s - loss: 2.8584 - accuracy50: 0.5184 - val_loss: 3.1180 - val_accuracy50: 0.4729 - 537s/epoch - 54ms/step
Epoch 9/50
9913/9913 - 526s - loss: 2.8551 - accuracy50: 0.5190 - val_loss: 3.1483 - val_accuracy50: 0.4685 - 526s/epoch - 53ms/step
Epoch 10/50
9913/9913 - 529s - loss: 2.8514 - accuracy50: 0.5201 - val_loss: 3.1012 - val_accuracy50: 0.4774 - 529s/epoch - 53ms/step
Epoch 11/50
9913/9913 - 534s - loss: 2.8482 - accuracy50: 0.5209 - val_loss: 3.1098 - val_accuracy50: 0.4753 - 534s/epoch - 54ms/step
Epoch 12/50
9913/9913 - 525s - loss: 2.8455 - accuracy50: 0.5216 - val_loss: 3.1161 - val_accuracy50: 0.4744 - 525s/epoch - 53ms/step
Epoch 13/50
9913/9913 - 544s - loss: 2.8430 - accuracy50: 0.5225 - val_loss: 3.0996 - val_accuracy50: 0.4797 - 544s/epoch - 55ms/step
Epoch 14/50
9913/9913 - 548s - loss: 2.8409 - accuracy50: 0.5225 - val_loss: 3.1273 - val_accuracy50: 0.4764 - 548s/epoch - 55ms/step
Epoch 15/50
9913/9913 - 527s - loss: 2.8388 - accuracy50: 0.5232 - val_loss: 3.1343 - val_accuracy50: 0.4767 - 527s/epoch - 53ms/step
Epoch 16/50
9913/9913 - 531s - loss: 2.8365 - accuracy50: 0.5236 - val_loss: 3.1435 - val_accuracy50: 0.4766 - 531s/epoch - 54ms/step
Epoch 17/50
9913/9913 - 532s - loss: 2.8346 - accuracy50: 0.5242 - val_loss: 3.1195 - val_accuracy50: 0.4798 - 532s/epoch - 54ms/step
Epoch 18/50
9913/9913 - 532s - loss: 2.8328 - accuracy50: 0.5247 - val_loss: 3.1229 - val_accuracy50: 0.4789 - 532s/epoch - 54ms/step
Epoch 19/50
9913/9913 - 534s - loss: 2.8309 - accuracy50: 0.5250 - val_loss: 3.1210 - val_accuracy50: 0.4798 - 534s/epoch - 54ms/step
Epoch 20/50
9913/9913 - 529s - loss: 2.8295 - accuracy50: 0.5256 - val_loss: 3.1238 - val_accuracy50: 0.4772 - 529s/epoch - 53ms/step
Epoch 21/50
9913/9913 - 530s - loss: 2.8276 - accuracy50: 0.5263 - val_loss: 3.0987 - val_accuracy50: 0.4787 - 530s/epoch - 53ms/step
Epoch 22/50
9913/9913 - 530s - loss: 2.8265 - accuracy50: 0.5263 - val_loss: 3.1052 - val_accuracy50: 0.4763 - 530s/epoch - 53ms/step
Epoch 23/50
9913/9913 - 534s - loss: 2.8251 - accuracy50: 0.5266 - val_loss: 3.1025 - val_accuracy50: 0.4785 - 534s/epoch - 54ms/step
Epoch 24/50
9913/9913 - 529s - loss: 2.8236 - accuracy50: 0.5271 - val_loss: 3.1009 - val_accuracy50: 0.4782 - 529s/epoch - 53ms/step
Epoch 25/50
9913/9913 - 537s - loss: 2.8222 - accuracy50: 0.5275 - val_loss: 3.1198 - val_accuracy50: 0.4762 - 537s/epoch - 54ms/step
Epoch 26/50
9913/9913 - 534s - loss: 2.8207 - accuracy50: 0.5279 - val_loss: 3.1190 - val_accuracy50: 0.4771 - 534s/epoch - 54ms/step
Epoch 27/50
9913/9913 - 535s - loss: 2.8197 - accuracy50: 0.5281 - val_loss: 3.1134 - val_accuracy50: 0.4773 - 535s/epoch - 54ms/step
Epoch 28/50
9913/9913 - 524s - loss: 2.8182 - accuracy50: 0.5288 - val_loss: 3.1021 - val_accuracy50: 0.4781 - 524s/epoch - 53ms/step
Epoch 29/50
9913/9913 - 517s - loss: 2.8171 - accuracy50: 0.5286 - val_loss: 3.0875 - val_accuracy50: 0.4770 - 517s/epoch - 52ms/step
Epoch 30/50
9913/9913 - 519s - loss: 2.8156 - accuracy50: 0.5291 - val_loss: 3.1093 - val_accuracy50: 0.4777 - 519s/epoch - 52ms/step
Epoch 31/50
9913/9913 - 517s - loss: 2.8146 - accuracy50: 0.5293 - val_loss: 3.1165 - val_accuracy50: 0.4770 - 517s/epoch - 52ms/step
Epoch 32/50
9913/9913 - 539s - loss: 2.8136 - accuracy50: 0.5298 - val_loss: 3.1069 - val_accuracy50: 0.4756 - 539s/epoch - 54ms/step
Epoch 33/50
9913/9913 - 542s - loss: 2.8122 - accuracy50: 0.5301 - val_loss: 3.1271 - val_accuracy50: 0.4763 - 542s/epoch - 55ms/step
Epoch 34/50
9913/9913 - 558s - loss: 2.8111 - accuracy50: 0.5304 - val_loss: 3.1283 - val_accuracy50: 0.4766 - 558s/epoch - 56ms/step
Epoch 35/50
9913/9913 - 526s - loss: 2.8099 - accuracy50: 0.5307 - val_loss: 3.1140 - val_accuracy50: 0.4775 - 526s/epoch - 53ms/step
Epoch 36/50
9913/9913 - 516s - loss: 2.8089 - accuracy50: 0.5313 - val_loss: 3.1233 - val_accuracy50: 0.4751 - 516s/epoch - 52ms/step
Epoch 37/50
9913/9913 - 539s - loss: 2.8074 - accuracy50: 0.5316 - val_loss: 3.1290 - val_accuracy50: 0.4776 - 539s/epoch - 54ms/step
Epoch 38/50
9913/9913 - 509s - loss: 2.8065 - accuracy50: 0.5319 - val_loss: 3.1261 - val_accuracy50: 0.4754 - 509s/epoch - 51ms/step
Epoch 39/50
9913/9913 - 525s - loss: 2.8056 - accuracy50: 0.5320 - val_loss: 3.1407 - val_accuracy50: 0.4758 - 525s/epoch - 53ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1374s - 1374s/epoch - 27ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0632248
{'0': {'precision': 0.45287512985206535, 'recall': 0.6069779487553228, 'f1-score': 0.5187232511908108, 'support': 4610352}, '1': {'precision': 0.5317113997339888, 'recall': 0.2707816743669312, 'f1-score': 0.3588260328882235, 'support': 3512217}, '2': {'precision': 0.4724346933240422, 'recall': 0.4879401724662212, 'f1-score': 0.480062263082805, 'support': 4715822}, 'accuracy': 0.47127907227626886, 'macro avg': {'precision': 0.4856737409700321, 'recall': 0.45523326519615837, 'f1-score': 0.45253718238727975, 'support': 12838391}, 'weighted avg': {'precision': 0.48162713678404184, 'recall': 0.47127907227626886, 'f1-score': 0.4607789132565221, 'support': 12838391}}
[[2798382  457520 1354450]
 [1346065  951044 1215108]
 [2034700  380083 2301039]]
Evaluating performance on  train set...
9913/9913 - 294s - 294s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0233594
{'0': {'precision': 0.4608828411696452, 'recall': 0.5333718830914336, 'f1-score': 0.49448484956785377, 'support': 778215}, '1': {'precision': 0.6274890358300799, 'recall': 0.42537285271208725, 'f1-score': 0.5070309869154471, 'support': 980481}, '2': {'precision': 0.4373642273293728, 'recall': 0.5460488194702294, 'f1-score': 0.4857007353907513, 'support': 778337}, 'accuracy': 0.49552291988318636, 'macro avg': {'precision': 0.5085787014430326, 'recall': 0.5015978517579168, 'f1-score': 0.49573885729135075, 'support': 2537033}, 'weighted avg': {'precision': 0.5180554522496987, 'recall': 0.49552291988318636, 'f1-score': 0.4966386442628547, 'support': 2537033}}
[[415078 132758 230379]
 [247047 417070 316364]
 [238490 114837 425010]]
Evaluating performance on  val set...
3496/3496 - 105s - 105s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0435921
{'0': {'precision': 0.44484411155098863, 'recall': 0.5596906551501709, 'f1-score': 0.495702290227923, 'support': 289903}, '1': {'precision': 0.6059793372945774, 'recall': 0.3636483369632956, 'f1-score': 0.45453194889461723, 'support': 311298}, '2': {'precision': 0.44243435932306274, 'recall': 0.5173914230525087, 'f1-score': 0.47698602596593564, 'support': 293018}, 'accuracy': 0.4775832318481267, 'macro avg': {'precision': 0.49775260272287625, 'recall': 0.4802434717219917, 'f1-score': 0.4757400883628253, 'support': 894219}, 'weighted avg': {'precision': 0.5001493250671466, 'recall': 0.4775832318481267, 'f1-score': 0.475237004612325, 'support': 894219}}
[[162256  39419  88228]
 [ 95267 113203 102828]
 [107225  34188 151605]]
testing model out of sample: results/universal/W5/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 605s - 605s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0336252
{'0': {'precision': 0.4795112026363669, 'recall': 0.548383161422064, 'f1-score': 0.5116398696862181, 'support': 1909900}, '1': {'precision': 0.5515143237613959, 'recall': 0.3142041796108289, 'f1-score': 0.4003336072084933, 'support': 1542201}, '2': {'precision': 0.4566529718077214, 'recall': 0.5503729287520766, 'f1-score': 0.499151875592163, 'support': 1896743}, 'accuracy': 0.48156928861638143, 'macro avg': {'precision': 0.49589283273516144, 'recall': 0.47098675659498984, 'f1-score': 0.47037511749562483, 'support': 5348844}, 'weighted avg': {'precision': 0.4921657306213901, 'recall': 0.48156928861638143, 'f1-score': 0.47511924117632887, 'support': 5348844}}
[[1047357  212239  650304]
 [ 465839  484566  591796]
 [ 671022  181805 1043916]]
Evaluating performance on  train set...
4957/4957 - 147s - 147s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0264732
{'0': {'precision': 0.4792603237176064, 'recall': 0.4894214585125344, 'f1-score': 0.4842875977311053, 'support': 403411}, '1': {'precision': 0.5690097176869234, 'recall': 0.47005150591528455, 'f1-score': 0.5148183160024544, 'support': 462277}, '2': {'precision': 0.45204099481769194, 'recall': 0.5326954025272193, 'f1-score': 0.48906521652387547, 'support': 402656}, 'accuracy': 0.4960996385838542, 'macro avg': {'precision': 0.5001036787407406, 'recall': 0.4973894556516794, 'f1-score': 0.4960570434191451, 'support': 1268344}, 'weighted avg': {'precision': 0.5033303350855239, 'recall': 0.4960996385838542, 'f1-score': 0.4969319479412581, 'support': 1268344}}
[[197438  86322 119651]
 [104628 217294 140355]
 [109898  78265 214493]]
Evaluating performance on  val set...
1701/1701 - 50s - 50s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0182556
{'0': {'precision': 0.4790564282043804, 'recall': 0.49082552489096637, 'f1-score': 0.4848695701067265, 'support': 140553}, '1': {'precision': 0.5769748831312891, 'recall': 0.4711926700486593, 'f1-score': 0.5187459484103522, 'support': 154544}, '2': {'precision': 0.4558584461590722, 'recall': 0.5368887301303804, 'f1-score': 0.493066650045435, 'support': 139975}, 'accuracy': 0.4986714842600765, 'macro avg': {'precision': 0.5039632524982472, 'recall': 0.499635641690002, 'f1-score': 0.49889405618750454, 'support': 435072}, 'weighted avg': {'precision': 0.5063750608937563, 'recall': 0.4986714842600765, 'f1-score': 0.49954019306792885, 'support': 435072}}
[[68987 28352 43214]
 [35233 72820 46491]
 [39786 25038 75151]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.157122
{'0': {'precision': 0.4239806110047914, 'recall': 0.5965193294156954, 'f1-score': 0.49566417349838326, 'support': 101762}, '1': {'precision': 0.3936077057793345, 'recall': 0.012788415033144613, 'f1-score': 0.02477198203411314, 'support': 70298}, '2': {'precision': 0.40999666301187015, 'recall': 0.5198770904694741, 'f1-score': 0.45844475439983656, 'support': 99260}, 'accuracy': 0.4172379478107032, 'macro avg': {'precision': 0.40919499326533204, 'recall': 0.3763949449727713, 'f1-score': 0.326293636644111, 'support': 271320}, 'weighted avg': {'precision': 0.4109952020068682, 'recall': 0.41723794781070317, 'f1-score': 0.36004137084735494, 'support': 271320}}
[[60703   789 40270]
 [35410   899 33989]
 [47061   596 51603]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1935779
{'0': {'precision': 0.4157529006757618, 'recall': 0.5570598787050483, 'f1-score': 0.4761435403205198, 'support': 23414}, '1': {'precision': 0.5910701630049611, 'recall': 0.03630822812363953, 'f1-score': 0.06841392887904514, 'support': 22970}, '2': {'precision': 0.38044244428780566, 'recall': 0.6026626583637534, 'f1-score': 0.46643732030380075, 'support': 23285}, 'accuracy': 0.4006085920567254, 'macro avg': {'precision': 0.46242183598950953, 'recall': 0.39867692173081376, 'f1-score': 0.3369982631677886, 'support': 69669}, 'weighted avg': {'precision': 0.461753755269744, 'recall': 0.4006085920567254, 'f1-score': 0.33847027806758123, 'support': 69669}}
[[13043   288 10083]
 [ 9366   834 12770]
 [ 8963   289 14033]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1813414
{'0': {'precision': 0.4181994191674734, 'recall': 0.5189812590100913, 'f1-score': 0.463171437761338, 'support': 8324}, '1': {'precision': 0.5954198473282443, 'recall': 0.029293940911367052, 'f1-score': 0.05584059181481924, 'support': 7988}, '2': {'precision': 0.3821309333720424, 'recall': 0.642935645377946, 'f1-score': 0.4793553967314608, 'support': 8189}, 'accuracy': 0.4007591526876454, 'macro avg': {'precision': 0.4652500666225867, 'recall': 0.39707028176646814, 'f1-score': 0.33278914210253935, 'support': 24501}, 'weighted avg': {'precision': 0.4639229386144124, 'recall': 0.4007591526876454, 'f1-score': 0.3357795616169171, 'support': 24501}}
[[4320   97 3907]
 [3148  234 4606]
 [2862   62 5265]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.946549
{'0': {'precision': 0.511340353552199, 'recall': 0.4504806414149188, 'f1-score': 0.4789850328800548, 'support': 142934}, '1': {'precision': 0.6847031816630138, 'recall': 0.5073278200560125, 'f1-score': 0.582818688503189, 'support': 272796}, '2': {'precision': 0.39820987467392294, 'recall': 0.6415637458529649, 'f1-score': 0.49140892553512366, 'support': 143476}, 'accuracy': 0.5272386204725986, 'macro avg': {'precision': 0.5314178032963786, 'recall': 0.5331240691079654, 'f1-score': 0.5177375489727891, 'support': 559206}, 'weighted avg': {'precision': 0.566885496969434, 'recall': 0.5272386204725986, 'f1-score': 0.5328255430711958, 'support': 559206}}
[[ 64389  37008  41537]
 [ 36828 138397  97571]
 [ 24705  26722  92049]]
Evaluating performance on  train set...
589/589 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7102004
{'0': {'precision': 0.5878949486818273, 'recall': 0.44352083807788656, 'f1-score': 0.5056033923240016, 'support': 26346}, '1': {'precision': 0.7830195987295685, 'recall': 0.8296551653380119, 'f1-score': 0.8056630749381037, 'support': 97467}, '2': {'precision': 0.501506734923574, 'recall': 0.5139147257980504, 'f1-score': 0.5076349203432499, 'support': 26878}, 'accuracy': 0.7058284834528936, 'macro avg': {'precision': 0.6241404274449899, 'recall': 0.595696909737983, 'f1-score': 0.6063004625351184, 'support': 150691}, 'weighted avg': {'precision': 0.698693017954769, 'recall': 0.7058284834528936, 'f1-score': 0.7000444703940261, 'support': 150691}}
[[11685 11465  3196]
 [ 6069 80864 10534]
 [ 2122 10943 13813]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78546554
{'0': {'precision': 0.5450742522484836, 'recall': 0.4484984080543843, 'f1-score': 0.4920927158570552, 'support': 11621}, '1': {'precision': 0.726778848832674, 'recall': 0.7951171934530159, 'f1-score': 0.75941370828057, 'support': 32809}, '2': {'precision': 0.5363652609006433, 'recall': 0.491324275658864, 'f1-score': 0.5128577530969671, 'support': 12218}, 'accuracy': 0.6584875017652874, 'macro avg': {'precision': 0.6027394539939336, 'recall': 0.5783132923887547, 'f1-score': 0.5881213924115308, 'support': 56648}, 'weighted avg': {'precision': 0.6484342941395087, 'recall': 0.6584875017652874, 'f1-score': 0.651396515910373, 'support': 56648}}
[[ 5212  4911  1498]
 [ 3031 26087  3691]
 [ 1319  4896  6003]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
2341/2341 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1860868
{'0': {'precision': 0.4234429770208547, 'recall': 0.5689188482048989, 'f1-score': 0.4855178517419379, 'support': 210211}, '1': {'precision': 0.41772684260330145, 'recall': 0.022234907629712957, 'f1-score': 0.04222238753626577, 'support': 178683}, '2': {'precision': 0.402880179083887, 'recall': 0.5885383741545424, 'f1-score': 0.47832561697097525, 'support': 210389}, 'accuracy': 0.41280663726486483, 'macro avg': {'precision': 0.41468333290268106, 'recall': 0.39323070999638476, 'f1-score': 0.335355285416393, 'support': 599283}, 'weighted avg': {'precision': 0.4145197094806569, 'recall': 0.41280663726486483, 'f1-score': 0.35081933616267036, 'support': 599283}}
[[119593   2888  87730]
 [ 78920   3973  95790]
 [ 83917   2650 123822]]
Evaluating performance on  train set...
483/483 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1927733
{'0': {'precision': 0.4195397934386391, 'recall': 0.5324947589098532, 'f1-score': 0.4693164562338724, 'support': 41499}, '1': {'precision': 0.5583974649162518, 'recall': 0.06067089666027249, 'f1-score': 0.10944986690328305, 'support': 40662}, '2': {'precision': 0.38617812716484445, 'recall': 0.6204301855749922, 'f1-score': 0.47604726499772587, 'support': 41331}, 'accuracy': 0.4065688465649597, 'macro avg': {'precision': 0.4547051285065784, 'recall': 0.4045319470483726, 'f1-score': 0.35160452937829384, 'support': 123492}, 'weighted avg': {'precision': 0.4540955509683615, 'recall': 0.4065688465649597, 'f1-score': 0.35307650386172207, 'support': 123492}}
[[22098  1143 18258]
 [15694  2467 22501]
 [14880   808 25643]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1650451
{'0': {'precision': 0.4225927561837456, 'recall': 0.5297985740984288, 'f1-score': 0.4701618600079855, 'support': 14447}, '1': {'precision': 0.4868943606036537, 'recall': 0.050994093669411864, 'f1-score': 0.09231927710843375, 'support': 12021}, '2': {'precision': 0.41221756559766765, 'recall': 0.6091551666105688, 'f1-score': 0.49169994837938436, 'support': 14855}, 'accuracy': 0.4190402439319507, 'macro avg': {'precision': 0.44056822746168894, 'recall': 0.39664927812613654, 'f1-score': 0.35139369516526786, 'support': 41323}, 'weighted avg': {'precision': 0.43756858394493253, 'recall': 0.4190402439319507, 'f1-score': 0.3679887993328559, 'support': 41323}}
[[7654  382 6411]
 [4916  613 6492]
 [5542  264 9049]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1637323
{'0': {'precision': 0.3642288342792236, 'recall': 0.4825808517451169, 'f1-score': 0.4151342715547221, 'support': 187380}, '1': {'precision': 0.30859429855357395, 'recall': 0.3331312059425453, 'f1-score': 0.32039365773646805, 'support': 158316}, '2': {'precision': 0.3556957454917457, 'recall': 0.20478574439459293, 'f1-score': 0.25992443758771944, 'support': 173181}, 'accuracy': 0.34426463304405475, 'macro avg': {'precision': 0.34283962610818114, 'recall': 0.34016593402741835, 'f1-score': 0.3318174556263032, 'support': 518877}, 'weighted avg': {'precision': 0.34440601305714946, 'recall': 0.34426463304405475, 'f1-score': 0.3344246828208021, 'support': 518877}}
[[90426 61720 35234]
 [76569 52740 29007]
 [81272 56444 35465]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.166839
{'0': {'precision': 0.3391507824306537, 'recall': 0.4916781511714195, 'f1-score': 0.40141363144608727, 'support': 28299}, '1': {'precision': 0.35680304471931495, 'recall': 0.31073242785603633, 'f1-score': 0.3321779318313114, 'support': 27757}, '2': {'precision': 0.37081153866072813, 'recall': 0.25165190496274426, 'f1-score': 0.2998262180440108, 'support': 28452}, 'accuracy': 0.35143418374591756, 'macro avg': {'precision': 0.35558845527023225, 'recall': 0.35135416133006664, 'f1-score': 0.3444725937738031, 'support': 84508}, 'weighted avg': {'precision': 0.3556082264667739, 'recall': 0.35143418374591756, 'f1-score': 0.34447061539644447, 'support': 84508}}
[[13914  7914  6471]
 [13454  8625  5678]
 [13658  7634  7160]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1766006
{'0': {'precision': 0.36248825187969924, 'recall': 0.49586179188429086, 'f1-score': 0.41881298992161253, 'support': 12445}, '1': {'precision': 0.3051762787854086, 'recall': 0.2892601892988217, 'f1-score': 0.29700515668385563, 'support': 10354}, '2': {'precision': 0.3706622600737257, 'recall': 0.2449185284730388, 'f1-score': 0.2949476558944014, 'support': 11906}, 'accuracy': 0.3481342746002017, 'macro avg': {'precision': 0.34610893024627787, 'recall': 0.34334683655205045, 'f1-score': 0.3369219341666232, 'support': 34705}, 'weighted avg': {'precision': 0.34819381511669084, 'recall': 0.3481342746002017, 'f1-score': 0.33997884578469534, 'support': 34705}}
[[6171 3516 2758]
 [5166 2995 2193]
 [5687 3303 2916]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1686912
{'0': {'precision': 0.4273853913402041, 'recall': 0.5962320934996422, 'f1-score': 0.49788302834589165, 'support': 285092}, '1': {'precision': 0.19693301049233253, 'recall': 0.001422582920842589, 'f1-score': 0.002824760647842647, 'support': 171519}, '2': {'precision': 0.4349963307668115, 'recall': 0.5227561444214638, 'f1-score': 0.47485547800738465, 'support': 285747}, 'accuracy': 0.4305213926434416, 'macro avg': {'precision': 0.3531049108664494, 'recall': 0.37347027361398294, 'f1-score': 0.32518775566703967, 'support': 742358}, 'weighted avg': {'precision': 0.3770698309201489, 'recall': 0.4305213926434416, 'f1-score': 0.3746379734749547, 'support': 742358}}
[[169981    535 114576]
 [ 91831    244  79444]
 [135911    460 149376]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2862438
{'0': {'precision': 0.39256904566584633, 'recall': 0.5800016833599866, 'f1-score': 0.46822447052108745, 'support': 59405}, '1': {'precision': 0.4799498746867168, 'recall': 0.019167890030695314, 'f1-score': 0.036863550322435754, 'support': 59944}, '2': {'precision': 0.3786139066788655, 'recall': 0.5683140782448972, 'f1-score': 0.45446246559546444, 'support': 58253}, 'accuracy': 0.3868762739158343, 'macro avg': {'precision': 0.4170442756771429, 'recall': 0.3891612172118597, 'f1-score': 0.3198501621463292, 'support': 177602}, 'weighted avg': {'precision': 0.417484461615095, 'recall': 0.3868762739158343, 'f1-score': 0.31811818189077756, 'support': 177602}}
[[34455   739 24211]
 [28672  1149 30123]
 [24641   506 33106]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.29022
{'0': {'precision': 0.38179800221975585, 'recall': 0.5741742956856001, 'f1-score': 0.4586296056884292, 'support': 19771}, '1': {'precision': 0.5035095928872251, 'recall': 0.05023108164884926, 'f1-score': 0.09134901095169369, 'support': 21421}, '2': {'precision': 0.37810808014622205, 'recall': 0.5572554002541296, 'f1-score': 0.4505259697567389, 'support': 19675}, 'accuracy': 0.38431333891928304, 'macro avg': {'precision': 0.4211385584177343, 'recall': 0.3938869258628596, 'f1-score': 0.33350152879895395, 'support': 60867}, 'weighted avg': {'precision': 0.4234393639903554, 'recall': 0.38431333891928304, 'f1-score': 0.3267526172248673, 'support': 60867}}
[[11352   644  7775]
 [10087  1076 10258]
 [ 8294   417 10964]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
7167/7167 - 101s - 101s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8853862
{'0': {'precision': 0.5751359634876613, 'recall': 0.4003300527736607, 'f1-score': 0.47207018343397517, 'support': 517493}, '1': {'precision': 0.5905040092977853, 'recall': 0.6955460394557704, 'f1-score': 0.6387352115073623, 'support': 798413}, '2': {'precision': 0.527592826707871, 'recall': 0.5431154984431183, 'f1-score': 0.5352416420448607, 'support': 518665}, 'accuracy': 0.569177208186546, 'macro avg': {'precision': 0.5644109331644391, 'recall': 0.5463305302241831, 'f1-score': 0.5486823456620661, 'support': 1834571}, 'weighted avg': {'precision': 0.5683829332269129, 'recall': 0.569177208186546, 'f1-score': 0.5624631688455903, 'support': 1834571}}
[[207168 212851  97474]
 [ 88324 555333 154756]
 [ 64715 172255 281695]]
Evaluating performance on  train set...
1570/1570 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8188827
{'0': {'precision': 0.6076533650982728, 'recall': 0.4046042195431472, 'f1-score': 0.4857639384849783, 'support': 100864}, '1': {'precision': 0.6523294050878014, 'recall': 0.7791368233224177, 'f1-score': 0.7101164531200669, 'support': 200631}, '2': {'precision': 0.5404975396967557, 'recall': 0.511925671629875, 'f1-score': 0.5258237618586342, 'support': 100204}, 'accuracy': 0.618438183814249, 'macro avg': {'precision': 0.6001601032942766, 'recall': 0.5652222381651466, 'f1-score': 0.5739013844878932, 'support': 401699}, 'weighted avg': {'precision': 0.6132150325423179, 'recall': 0.618438183814249, 'f1-score': 0.60781110291677, 'support': 401699}}
[[ 40810  44329  15725]
 [ 16427 156319  27885]
 [  9923  38984  51297]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8465119
{'0': {'precision': 0.5658521104411298, 'recall': 0.41788246323314, 'f1-score': 0.4807387684944896, 'support': 34134}, '1': {'precision': 0.6631059343807907, 'recall': 0.7347516262056352, 'f1-score': 0.6970927187008905, 'support': 57957}, '2': {'precision': 0.5133661867136525, 'recall': 0.5539974449627143, 'f1-score': 0.5329084621759881, 'support': 33659}, 'accuracy': 0.6003578528827038, 'macro avg': {'precision': 0.580774743845191, 'recall': 0.5688771781338299, 'f1-score': 0.570246649790456, 'support': 125750}, 'weighted avg': {'precision': 0.5966267916922453, 'recall': 0.6003578528827038, 'f1-score': 0.5944183359834593, 'support': 125750}}
[[14264 11964  7906]
 [ 5603 42584  9770]
 [ 5341  9671 18647]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.943019
{'0': {'precision': 0.5330144642423605, 'recall': 0.4407054299981582, 'f1-score': 0.48248448049299925, 'support': 483223}, '1': {'precision': 0.587682482580692, 'recall': 0.5847907313104529, 'f1-score': 0.5862330408831201, 'support': 663740}, '2': {'precision': 0.46553694032350773, 'recall': 0.5498327800985411, 'f1-score': 0.504185746311693, 'support': 480206}, 'accuracy': 0.5316847850469127, 'macro avg': {'precision': 0.5287446290488534, 'recall': 0.5251096471357174, 'f1-score': 0.5243010892292708, 'support': 1627169}, 'weighted avg': {'precision': 0.5354003495689047, 'recall': 0.5316847850469127, 'f1-score': 0.5312090736526959, 'support': 1627169}}
[[212959 146913 123351]
 [ 95817 388149 179774]
 [ 90761 125412 264033]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90728146
{'0': {'precision': 0.5442935132617979, 'recall': 0.4415428883744856, 'f1-score': 0.48756351372340184, 'support': 124416}, '1': {'precision': 0.6050616343355018, 'recall': 0.6713267766669376, 'f1-score': 0.6364740907421249, 'support': 184545}, '2': {'precision': 0.4944000369990673, 'recall': 0.507207983741509, 'f1-score': 0.5007221203013388, 'support': 126457}, 'accuracy': 0.5580040329063107, 'macro avg': {'precision': 0.5479183948654557, 'recall': 0.540025882927644, 'f1-score': 0.5415865749222885, 'support': 435418}, 'weighted avg': {'precision': 0.5555587195136996, 'recall': 0.5580040329063107, 'f1-score': 0.5544985057263655, 'support': 435418}}
[[ 54935  42014  27467]
 [ 22529 123890  38126]
 [ 23465  38852  64140]]
Evaluating performance on  val set...
563/563 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.921756
{'0': {'precision': 0.5469687082439949, 'recall': 0.4190154256332127, 'f1-score': 0.4745177856555554, 'support': 42008}, '1': {'precision': 0.5943329997460753, 'recall': 0.6589057428628204, 'f1-score': 0.6249558258793595, 'support': 60388}, '2': {'precision': 0.4822052571835563, 'recall': 0.5200057605069246, 'f1-score': 0.5003926459719142, 'support': 41663}, 'accuracy': 0.5487820962244636, 'macro avg': {'precision': 0.5411689883912089, 'recall': 0.5326423096676526, 'f1-score': 0.5332887525022764, 'support': 144059}, 'weighted avg': {'precision': 0.5480932139930045, 'recall': 0.5487820962244636, 'f1-score': 0.5450630253031689, 'support': 144059}}
[[17602 14372 10034]
 [ 7368 39790 13230]
 [ 7211 12787 21665]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
7459/7459 - 106s - 106s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0016923
{'0': {'precision': 0.5120056812667623, 'recall': 0.47478708298692357, 'f1-score': 0.49269450017751404, 'support': 700038}, '1': {'precision': 0.4340394940042505, 'recall': 0.374766441084633, 'f1-score': 0.4022310653303305, 'support': 478466}, '2': {'precision': 0.49249445673657044, 'recall': 0.5708268388375183, 'f1-score': 0.5287753664938225, 'support': 730747}, 'accuracy': 0.4864797766244459, 'macro avg': {'precision': 0.4795132106691944, 'recall': 0.47346012096969164, 'f1-score': 0.47456697733388903, 'support': 1909251}, 'weighted avg': {'precision': 0.4849993114670298, 'recall': 0.4864797766244459, 'f1-score': 0.4838335945136967, 'support': 1909251}}
[[332369 123743 243926]
 [113235 179313 185918]
 [203547 110070 417130]]
Evaluating performance on  train set...
1664/1664 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8953426
{'0': {'precision': 0.5673909638149798, 'recall': 0.40606007222760504, 'f1-score': 0.47335676313959407, 'support': 124883}, '1': {'precision': 0.5960256904422453, 'recall': 0.728391278192075, 'f1-score': 0.6555940081985008, 'support': 176202}, '2': {'precision': 0.5183413604275252, 'recall': 0.5033072278543859, 'f1-score': 0.5107136762901509, 'support': 124878}, 'accuracy': 0.5679037850705343, 'macro avg': {'precision': 0.5605860048949167, 'recall': 0.5459195260913553, 'f1-score': 0.5465548158760819, 'support': 425963}, 'weighted avg': {'precision': 0.5648561890325665, 'recall': 0.5679037850705343, 'f1-score': 0.559692016798444, 'support': 425963}}
[[ 50710  46480  27693]
 [ 17147 128344  30711]
 [ 21517  40509  62852]]
Evaluating performance on  val set...
517/517 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93722266
{'0': {'precision': 0.5355424290448062, 'recall': 0.4278742115198674, 'f1-score': 0.47569200056307026, 'support': 43438}, '1': {'precision': 0.5504734778427166, 'recall': 0.6649760936592342, 'f1-score': 0.6023313702871715, 'support': 44758}, '2': {'precision': 0.5168997534732622, 'recall': 0.510118235561619, 'f1-score': 0.5134866049460421, 'support': 43980}, 'accuracy': 0.535528386393899, 'macro avg': {'precision': 0.5343052201202617, 'recall': 0.5343228469135735, 'f1-score': 0.530503325265428, 'support': 132176}, 'weighted avg': {'precision': 0.53439531467049, 'recall': 0.535528386393899, 'f1-score': 0.531150870636869, 'support': 132176}}
[[18586 12942 11910]
 [ 5937 29763  9058]
 [10182 11363 22435]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
8238/8238 - 119s - 119s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.996946
{'0': {'precision': 0.5031651398582841, 'recall': 0.5828146169534674, 'f1-score': 0.5400689955985566, 'support': 829612}, '1': {'precision': 0.44358183610333085, 'recall': 0.1984994355414544, 'f1-score': 0.2742666636495976, 'support': 457961}, '2': {'precision': 0.4818066210387095, 'recall': 0.553215586604493, 'f1-score': 0.5150477555351975, 'support': 821141}, 'accuracy': 0.48782480696765895, 'macro avg': {'precision': 0.4761845323334415, 'recall': 0.4448432130331383, 'f1-score': 0.44312780492778386, 'support': 2108714}, 'weighted avg': {'precision': 0.4819080206505839, 'recall': 0.48782480696765895, 'f1-score': 0.4725998803802084, 'support': 2108714}}
[[483510  61278 284824]
 [163305  90905 203751]
 [314122  52751 454268]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96922415
{'0': {'precision': 0.5238459043569138, 'recall': 0.4698888651835761, 'f1-score': 0.4954025260546244, 'support': 154677}, '1': {'precision': 0.5261901800889489, 'recall': 0.5763836633021096, 'f1-score': 0.5501444196435482, 'support': 154156}, '2': {'precision': 0.5029341925632614, 'recall': 0.506958846931455, 'f1-score': 0.5049385001640212, 'support': 153330}, 'accuracy': 0.5177091199425311, 'macro avg': {'precision': 0.5176567590030414, 'recall': 0.5177437918057135, 'f1-score': 0.5168284819540646, 'support': 462163}, 'weighted avg': {'precision': 0.5176900489561718, 'recall': 0.5177091199425311, 'f1-score': 0.5168255786535731, 'support': 462163}}
[[72681 42197 39799]
 [28277 88853 37026]
 [37787 37811 77732]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94013554
{'0': {'precision': 0.5225919635691756, 'recall': 0.49999107190686215, 'f1-score': 0.5110417579208644, 'support': 56003}, '1': {'precision': 0.5590724931268991, 'recall': 0.5862382885104124, 'f1-score': 0.5723332160645841, 'support': 52726}, '2': {'precision': 0.5079436640037509, 'recall': 0.5066645081215261, 'f1-score': 0.5073032797219169, 'support': 55593}, 'accuracy': 0.5299229561470771, 'macro avg': {'precision': 0.5298693735666086, 'recall': 0.5309646228462669, 'f1-score': 0.5302260845691218, 'support': 164322}, 'weighted avg': {'precision': 0.5293416957031557, 'recall': 0.5299229561470771, 'f1-score': 0.5294435556325018, 'support': 164322}}
[[28001 12866 15136]
 [ 9666 30910 12150]
 [15914 11512 28167]]
testing model on single stock: results/universal/W5/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
31315/31315 - 430s - 430s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.120194
{'0': {'precision': 0.43878701159927297, 'recall': 0.6873159800124539, 'f1-score': 0.5356265406283104, 'support': 3062507}, '1': {'precision': 0.40809368514675365, 'recall': 0.01373275853468468, 'f1-score': 0.026571364226194945, 'support': 1804226}, '2': {'precision': 0.4668338894233981, 'recall': 0.46815416954916783, 'f1-score': 0.46749309731415856, 'support': 3149753}, 'accuracy': 0.4496056002592657, 'macro avg': {'precision': 0.4379048620564749, 'recall': 0.3897343026987688, 'f1-score': 0.34323033405622133, 'support': 8016486}, 'weighted avg': {'precision': 0.44289891798257464, 'recall': 0.4496056002592657, 'f1-score': 0.3942860452818003, 'support': 8016486}}
[[2104910   21530  936067]
 [1031425   24777  748024]
 [1660776   14407 1474570]]
Evaluating performance on  train set...
5759/5759 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1394739
{'0': {'precision': 0.4362045389996164, 'recall': 0.5985119209036144, 'f1-score': 0.5046283241071708, 'support': 497823}, '1': {'precision': 0.5196644580876543, 'recall': 0.08934543417554304, 'f1-score': 0.1524758373329481, 'support': 478424}, '2': {'precision': 0.40923794435846905, 'recall': 0.5826017974594567, 'f1-score': 0.4807687208315656, 'support': 497925}, 'accuracy': 0.4278944383694711, 'macro avg': {'precision': 0.4550356471485799, 'recall': 0.42348638417953804, 'f1-score': 0.3792909607572282, 'support': 1474172}, 'weighted avg': {'precision': 0.4541820115693587, 'recall': 0.4278944383694711, 'f1-score': 0.38228269938123893, 'support': 1474172}}
[[297953  22724 177146]
 [194058  42745 241621]
 [191047  16786 290092]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1329955
{'0': {'precision': 0.4234045077532061, 'recall': 0.6255384697102488, 'f1-score': 0.5049956261470644, 'support': 188265}, '1': {'precision': 0.5170895457319732, 'recall': 0.0717023334542377, 'f1-score': 0.12594102719289862, 'support': 165420}, '2': {'precision': 0.4165070799109321, 'recall': 0.5310658544874644, 'f1-score': 0.4668615581204006, 'support': 191255}, 'accuracy': 0.4242613865746688, 'macro avg': {'precision': 0.45233371113203713, 'recall': 0.40943555255065034, 'f1-score': 0.3659327371534545, 'support': 544940}, 'weighted avg': {'precision': 0.4494224389391596, 'recall': 0.4242613865746688, 'f1-score': 0.3765474613226109, 'support': 544940}}
[[117767   6205  64293]
 [ 75562  11861  77997]
 [ 84814   4872 101569]]
training model: results/universal/W5/deepVOL_L3/h100
Epoch 1/50
9913/9913 - 523s - loss: 3.1441 - accuracy100: 0.4326 - val_loss: 3.3992 - val_accuracy100: 0.4049 - 523s/epoch - 53ms/step
Epoch 2/50
9913/9913 - 520s - loss: 3.0893 - accuracy100: 0.4501 - val_loss: 3.4222 - val_accuracy100: 0.4071 - 520s/epoch - 52ms/step
Epoch 3/50
9913/9913 - 518s - loss: 3.0754 - accuracy100: 0.4554 - val_loss: 3.4100 - val_accuracy100: 0.4105 - 518s/epoch - 52ms/step
Epoch 4/50
9913/9913 - 529s - loss: 3.0661 - accuracy100: 0.4581 - val_loss: 3.3577 - val_accuracy100: 0.4160 - 529s/epoch - 53ms/step
Epoch 5/50
9913/9913 - 527s - loss: 3.0610 - accuracy100: 0.4598 - val_loss: 3.3432 - val_accuracy100: 0.4179 - 527s/epoch - 53ms/step
Epoch 6/50
9913/9913 - 513s - loss: 3.0566 - accuracy100: 0.4617 - val_loss: 3.3317 - val_accuracy100: 0.4168 - 513s/epoch - 52ms/step
Epoch 7/50
9913/9913 - 523s - loss: 3.0523 - accuracy100: 0.4630 - val_loss: 3.3261 - val_accuracy100: 0.4201 - 523s/epoch - 53ms/step
Epoch 8/50
9913/9913 - 528s - loss: 3.0471 - accuracy100: 0.4648 - val_loss: 3.3262 - val_accuracy100: 0.4198 - 528s/epoch - 53ms/step
Epoch 9/50
9913/9913 - 522s - loss: 3.0434 - accuracy100: 0.4660 - val_loss: 3.3360 - val_accuracy100: 0.4192 - 522s/epoch - 53ms/step
Epoch 10/50
9913/9913 - 541s - loss: 3.0406 - accuracy100: 0.4670 - val_loss: 3.3334 - val_accuracy100: 0.4213 - 541s/epoch - 55ms/step
Epoch 11/50
9913/9913 - 529s - loss: 3.0376 - accuracy100: 0.4680 - val_loss: 3.3300 - val_accuracy100: 0.4237 - 529s/epoch - 53ms/step
Epoch 12/50
9913/9913 - 514s - loss: 3.0349 - accuracy100: 0.4686 - val_loss: 3.3194 - val_accuracy100: 0.4235 - 514s/epoch - 52ms/step
Epoch 13/50
9913/9913 - 521s - loss: 3.0327 - accuracy100: 0.4693 - val_loss: 3.3075 - val_accuracy100: 0.4242 - 521s/epoch - 53ms/step
Epoch 14/50
9913/9913 - 514s - loss: 3.0309 - accuracy100: 0.4697 - val_loss: 3.3363 - val_accuracy100: 0.4242 - 514s/epoch - 52ms/step
Epoch 15/50
9913/9913 - 530s - loss: 3.0285 - accuracy100: 0.4708 - val_loss: 3.3186 - val_accuracy100: 0.4237 - 530s/epoch - 54ms/step
Epoch 16/50
9913/9913 - 518s - loss: 3.0266 - accuracy100: 0.4713 - val_loss: 3.3159 - val_accuracy100: 0.4230 - 518s/epoch - 52ms/step
Epoch 17/50
9913/9913 - 538s - loss: 3.0246 - accuracy100: 0.4718 - val_loss: 3.3322 - val_accuracy100: 0.4234 - 538s/epoch - 54ms/step
Epoch 18/50
9913/9913 - 527s - loss: 3.0231 - accuracy100: 0.4723 - val_loss: 3.3234 - val_accuracy100: 0.4239 - 527s/epoch - 53ms/step
Epoch 19/50
9913/9913 - 518s - loss: 3.0210 - accuracy100: 0.4730 - val_loss: 3.3396 - val_accuracy100: 0.4229 - 518s/epoch - 52ms/step
Epoch 20/50
9913/9913 - 527s - loss: 3.0195 - accuracy100: 0.4734 - val_loss: 3.3237 - val_accuracy100: 0.4233 - 527s/epoch - 53ms/step
Epoch 21/50
9913/9913 - 524s - loss: 3.0182 - accuracy100: 0.4738 - val_loss: 3.3301 - val_accuracy100: 0.4229 - 524s/epoch - 53ms/step
Epoch 22/50
9913/9913 - 523s - loss: 3.0163 - accuracy100: 0.4744 - val_loss: 3.3527 - val_accuracy100: 0.4233 - 523s/epoch - 53ms/step
Epoch 23/50
9913/9913 - 518s - loss: 3.0159 - accuracy100: 0.4747 - val_loss: 3.3541 - val_accuracy100: 0.4204 - 518s/epoch - 52ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1422s - 1422s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0381534
{'0': {'precision': 0.4749171301035113, 'recall': 0.3893127813134663, 'f1-score': 0.42787528265681635, 'support': 5068634}, '1': {'precision': 0.35385475561539736, 'recall': 0.2398888868260805, 'f1-score': 0.2859342563185733, 'support': 2585472}, '2': {'precision': 0.45659619768176385, 'recall': 0.6104008556628349, 'f1-score': 0.522413269809348, 'support': 5184285}, 'accuracy': 0.4484987254243931, 'macro avg': {'precision': 0.4284560278002241, 'recall': 0.41320084126746054, 'f1-score': 0.4120742695949125, 'support': 12838391}, 'weighted avg': {'precision': 0.44313866856322864, 'recall': 0.4484987254243931, 'f1-score': 0.43746583956354035, 'support': 12838391}}
[[1973284  586197 2509153]
 [ 708277  620226 1256969]
 [1473446  546347 3164492]]
Evaluating performance on  train set...
9913/9913 - 290s - 290s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072567
{'0': {'precision': 0.45047987234418685, 'recall': 0.34894582076070035, 'f1-score': 0.3932649904728383, 'support': 832496}, '1': {'precision': 0.45900330016344937, 'recall': 0.3549142117896085, 'f1-score': 0.4003029596830575, 'support': 871157}, '2': {'precision': 0.4042160858907688, 'recall': 0.5910461014183206, 'f1-score': 0.4800952849263944, 'support': 833380}, 'accuracy': 0.43052179455292855, 'macro avg': {'precision': 0.43789975279946836, 'recall': 0.43163537798954316, 'f1-score': 0.42455441169409674, 'support': 2537033}, 'weighted avg': {'precision': 0.4382096060347599, 'recall': 0.43052179455292855, 'f1-score': 0.4242042044818683, 'support': 2537033}}
[[290496 193487 348513]
 [184479 309186 377492]
 [169884 170930 492566]]
Evaluating performance on  val set...
3496/3496 - 102s - 102s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1055187
{'0': {'precision': 0.43403750724002443, 'recall': 0.3612405827690323, 'f1-score': 0.3943072593819828, 'support': 307017}, '1': {'precision': 0.43936094101803336, 'recall': 0.30221307145079934, 'f1-score': 0.35810483438739416, 'support': 276358}, '2': {'precision': 0.4111185168177654, 'recall': 0.5933169049426722, 'f1-score': 0.48569287916075776, 'support': 310844}, 'accuracy': 0.42367138251367953, 'macro avg': {'precision': 0.4281723216919411, 'recall': 0.4189235197208346, 'f1-score': 0.41270165764337824, 'support': 894219}, 'weighted avg': {'precision': 0.42771572572252853, 'recall': 0.42367138251367953, 'f1-score': 0.41488593398838125, 'support': 894219}}
[[110907  55521 140589]
 [ 69254  83519 123585]
 [ 75363  51052 184429]]
testing model out of sample: results/universal/W5/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 599s - 599s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1107413
{'0': {'precision': 0.42963999945100945, 'recall': 0.4069716648708466, 'f1-score': 0.4179987282711833, 'support': 1922984}, '1': {'precision': 0.38655550633431146, 'recall': 0.22197816795464886, 'f1-score': 0.2820119468627039, 'support': 1505585}, '2': {'precision': 0.4174073192220651, 'recall': 0.5787962661597948, 'f1-score': 0.48502896672650353, 'support': 1920275}, 'accuracy': 0.4165862754643807, 'macro avg': {'precision': 0.4112009416691287, 'recall': 0.4025820329950968, 'f1-score': 0.3950132139534636, 'support': 5348844}, 'weighted avg': {'precision': 0.4131210139289527, 'recall': 0.4165862754643807, 'f1-score': 0.40378571941598107, 'support': 5348844}}
[[ 782600  276714  863670]
 [ 483754  334207  687624]
 [ 555171  253656 1111448]]
Evaluating performance on  train set...
4957/4957 - 155s - 155s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.103362
{'0': {'precision': 0.4348912553527158, 'recall': 0.3624323531138111, 'f1-score': 0.3953693565633864, 'support': 425925}, '1': {'precision': 0.4330360733950044, 'recall': 0.3715251913955874, 'f1-score': 0.3999292958533043, 'support': 420203}, '2': {'precision': 0.41475286188952537, 'recall': 0.5430964245788885, 'f1-score': 0.4703261766922884, 'support': 422216}, 'accuracy': 0.4255856455346499, 'macro avg': {'precision': 0.42756006354574855, 'recall': 0.4256846563627623, 'f1-score': 0.4218749430363264, 'support': 1268344}, 'weighted avg': {'precision': 0.42757281102008154, 'recall': 0.4255856455346499, 'f1-score': 0.4218322632645541, 'support': 1268344}}
[[154369 107727 163829]
 [104351 156116 159736]
 [ 96240  96672 229304]]
Evaluating performance on  val set...
1701/1701 - 48s - 48s/epoch - 28ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0995783
{'0': {'precision': 0.43513264148016295, 'recall': 0.36192248398948706, 'f1-score': 0.3951653566661723, 'support': 147247}, '1': {'precision': 0.4417420062487536, 'recall': 0.37505467680715665, 'f1-score': 0.40567599948108635, 'support': 141742}, '2': {'precision': 0.41482406179293124, 'recall': 0.5459362143439004, 'f1-score': 0.4714338915522347, 'support': 146083}, 'accuracy': 0.4279866320976758, 'macro avg': {'precision': 0.4305662365072826, 'recall': 0.42763779171351474, 'f1-score': 0.42409174923316445, 'support': 435072}, 'weighted avg': {'precision': 0.4304669455369161, 'recall': 0.4279866320976758, 'f1-score': 0.42419810507478556, 'support': 435072}}
[[53292 34991 58964]
 [35042 53161 53539]
 [34139 32192 79752]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1620336
{'0': {'precision': 0.39337924052400525, 'recall': 0.451773597009091, 'f1-score': 0.420559090824267, 'support': 99769}, '1': {'precision': 0.2531308805398741, 'recall': 0.05478624796359755, 'f1-score': 0.0900767765398603, 'support': 71204}, '2': {'precision': 0.40167692634260244, 'recall': 0.5657269275613621, 'f1-score': 0.46979232612122795, 'support': 100347}, 'accuracy': 0.38973536783134305, 'macro avg': {'precision': 0.3493956824688273, 'recall': 0.35742892417801686, 'f1-score': 0.3268093978284518, 'support': 271320}, 'weighted avg': {'precision': 0.3596419696060069, 'recall': 0.38973536783134305, 'f1-score': 0.3520375839542878, 'support': 271320}}
[[45073  5760 48936]
 [31678  3901 35625]
 [37828  5750 56769]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1955874
{'0': {'precision': 0.3978958193252383, 'recall': 0.42639766032297716, 'f1-score': 0.41165398150421467, 'support': 23593}, '1': {'precision': 0.3933577087141987, 'recall': 0.11226575068481238, 'f1-score': 0.17467780671785677, 'support': 22999}, '2': {'precision': 0.3848818148167733, 'recall': 0.6308012306625644, 'f1-score': 0.47807024745890736, 'support': 23077}, 'accuracy': 0.3904031922375806, 'macro avg': {'precision': 0.3920451142854035, 'recall': 0.38982154722345136, 'f1-score': 0.3548006785603263, 'support': 69669}, 'weighted avg': {'precision': 0.39208697768856854, 'recall': 0.3904031922375806, 'f1-score': 0.35542342165011886, 'support': 69669}}
[[10060  2046 11487]
 [ 8639  2582 11778]
 [ 6584  1936 14557]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1391804
{'0': {'precision': 0.42022169969768225, 'recall': 0.4270110365229264, 'f1-score': 0.42358916478555303, 'support': 8789}, '1': {'precision': 0.39948119325551235, 'recall': 0.12780082987551866, 'f1-score': 0.1936497956617416, 'support': 7230}, '2': {'precision': 0.40574790676623673, 'recall': 0.6341664701721292, 'f1-score': 0.49487096922581547, 'support': 8482}, 'accuracy': 0.41043222725603035, 'macro avg': {'precision': 0.40848359990647715, 'recall': 0.39632611219019137, 'f1-score': 0.37070330989103667, 'support': 24501}, 'weighted avg': {'precision': 0.40909070205589587, 'recall': 0.41043222725603035, 'f1-score': 0.380413401612505, 'support': 24501}}
[[3753  822 4214]
 [2642  924 3664]
 [2536  567 5379]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99818707
{'0': {'precision': 0.5064173710122656, 'recall': 0.38456966880976823, 'f1-score': 0.43716182603194875, 'support': 185090}, '1': {'precision': 0.47125360938604166, 'recall': 0.5222927623730537, 'f1-score': 0.4954622278751319, 'support': 192798}, '2': {'precision': 0.455674217328305, 'recall': 0.5151170871066303, 'f1-score': 0.4835757684013783, 'support': 181318}, 'accuracy': 0.47438153381759135, 'macro avg': {'precision': 0.4777817325755374, 'recall': 0.4739931727631507, 'f1-score': 0.472066607436153, 'support': 559206}, 'weighted avg': {'precision': 0.4778408713794271, 'recall': 0.47438153381759135, 'f1-score': 0.4723114561809498, 'support': 559206}}
[[ 71180  61248  52662]
 [ 33192 100697  58909]
 [ 36184  51734  93400]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.8888731
{'0': {'precision': 0.5700892656887813, 'recall': 0.3435793457691268, 'f1-score': 0.4287569792351939, 'support': 36990}, '1': {'precision': 0.6177327654718481, 'recall': 0.7985038260434365, 'f1-score': 0.6965813193315449, 'support': 75927}, '2': {'precision': 0.5100819780510379, 'recall': 0.4085084979086144, 'f1-score': 0.45367947549466375, 'support': 37774}, 'accuracy': 0.5890730036963057, 'macro avg': {'precision': 0.5659680030705557, 'recall': 0.5168638899070592, 'f1-score': 0.5263392580204675, 'support': 150691}, 'weighted avg': {'precision': 0.5790527255158499, 'recall': 0.5890730036963057, 'f1-score': 0.5699500235722867, 'support': 150691}}
[[12709 18983  5298]
 [ 5776 60628  9523]
 [ 3808 18535 15431]]
Evaluating performance on  val set...
222/222 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95489544
{'0': {'precision': 0.5494901019796041, 'recall': 0.3390918065153011, 'f1-score': 0.419381915299504, 'support': 16208}, '1': {'precision': 0.5200157316627806, 'recall': 0.7825076090632398, 'f1-score': 0.624812245793462, 'support': 23656}, '2': {'precision': 0.5480133948773644, 'recall': 0.3607602478551001, 'f1-score': 0.4350950310782165, 'support': 16784}, 'accuracy': 0.5306806948171162, 'macro avg': {'precision': 0.5391730761732497, 'recall': 0.4941198878112137, 'f1-score': 0.4930963973903941, 'support': 56648}, 'weighted avg': {'precision': 0.5367441840969116, 'recall': 0.5306806948171162, 'f1-score': 0.5098244522539416, 'support': 56648}}
[[ 5496  8504  2208]
 [ 2359 18511  2786]
 [ 2147  8582  6055]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
2341/2341 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1962931
{'0': {'precision': 0.3880396604712425, 'recall': 0.5087250575594782, 'f1-score': 0.44026151930261526, 'support': 208480}, '1': {'precision': 0.2736936284430053, 'recall': 0.07175168377433515, 'f1-score': 0.11369659963275147, 'support': 179062}, '2': {'precision': 0.39552361837861083, 'recall': 0.5211980674503285, 'f1-score': 0.4497464142423705, 'support': 211741}, 'accuracy': 0.3825671677654797, 'macro avg': {'precision': 0.35241896909761955, 'recall': 0.36722493626138064, 'f1-score': 0.3345681777259124, 'support': 599283}, 'weighted avg': {'precision': 0.3565180447141192, 'recall': 0.3825671677654797, 'f1-score': 0.3460372104093437, 'support': 599283}}
[[106059  17195  85226]
 [ 82779  12848  83435]
 [ 84482  16900 110359]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2094473
{'0': {'precision': 0.3811234828385803, 'recall': 0.4415081554619815, 'f1-score': 0.40909957282685466, 'support': 41322}, '1': {'precision': 0.3605628968594474, 'recall': 0.10202991452991453, 'f1-score': 0.159052197282259, 'support': 41184}, '2': {'precision': 0.3688036392627679, 'recall': 0.5756111843068364, 'f1-score': 0.4495640988995283, 'support': 40986}, 'accuracy': 0.37280147701875427, 'macro avg': {'precision': 0.37016333965359854, 'recall': 0.3730497514329108, 'f1-score': 0.3392386230028806, 'support': 123492}, 'weighted avg': {'precision': 0.370177767474323, 'recall': 0.37280147701875427, 'f1-score': 0.3391398017581699, 'support': 123492}}
[[18244  3976 19102]
 [15707  4202 21275]
 [13918  3476 23592]]
Evaluating performance on  val set...
162/162 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1810853
{'0': {'precision': 0.39968905875493943, 'recall': 0.4201280130736756, 'f1-score': 0.40965375294625367, 'support': 14686}, '1': {'precision': 0.3344891971192318, 'recall': 0.10397147831854739, 'f1-score': 0.1586337760910816, 'support': 12061}, '2': {'precision': 0.3909743867732755, 'recall': 0.593784302963776, 'f1-score': 0.47149511072372186, 'support': 14576}, 'accuracy': 0.38910534085134185, 'macro avg': {'precision': 0.37505088088248223, 'recall': 0.37262793145199974, 'f1-score': 0.3465942132536857, 'support': 41323}, 'weighted avg': {'precision': 0.3775851314023029, 'recall': 0.38910534085134185, 'f1-score': 0.3582017211507438, 'support': 41323}}
[[6170 1250 7266]
 [4591 1254 6216]
 [4676 1245 8655]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
2027/2027 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.182367
{'0': {'precision': 0.3444385553115772, 'recall': 0.05120902377521614, 'f1-score': 0.0891619870833701, 'support': 177664}, '1': {'precision': 0.3203995731562722, 'recall': 0.12305888246277152, 'f1-score': 0.17782055078472017, 'support': 175672}, '2': {'precision': 0.3183973307670045, 'recall': 0.8174168332920545, 'f1-score': 0.4582850717657976, 'support': 165541}, 'accuracy': 0.31998334865488354, 'macro avg': {'precision': 0.3277451530782846, 'recall': 0.3305615798433474, 'f1-score': 0.24175586987796263, 'support': 518877}, 'weighted avg': {'precision': 0.32799175496097416, 'recall': 0.31998334865488354, 'f1-score': 0.23694235076099948, 'support': 518877}}
[[  9098  23869 144697]
 [  9076  21618 144978]
 [  8240  21985 135316]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1754475
{'0': {'precision': 0.354068784063146, 'recall': 0.06706535668517727, 'f1-score': 0.11277047855625055, 'support': 28092}, '1': {'precision': 0.33000369959304476, 'recall': 0.1279082272808747, 'f1-score': 0.18435941819309168, 'support': 27895}, '2': {'precision': 0.33812065813528336, 'recall': 0.810595701412994, 'f1-score': 0.47719204095112294, 'support': 28521}, 'accuracy': 0.3380863350215364, 'macro avg': {'precision': 0.34073104726382475, 'recall': 0.3351897617930153, 'f1-score': 0.2581073125668217, 'support': 84508}, 'weighted avg': {'precision': 0.34074280272549695, 'recall': 0.3380863350215364, 'f1-score': 0.25939140027057156, 'support': 84508}}
[[ 1884  3612 22596]
 [ 1667  3568 22660]
 [ 1770  3632 23119]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1792648
{'0': {'precision': 0.3643474680938658, 'recall': 0.07146317829457365, 'f1-score': 0.11948963748059138, 'support': 12384}, '1': {'precision': 0.28921775898520086, 'recall': 0.12977895835309744, 'f1-score': 0.17916311963853057, 'support': 10541}, '2': {'precision': 0.3380527118274886, 'recall': 0.7904923599320883, 'f1-score': 0.4735798199664345, 'support': 11780}, 'accuracy': 0.3332372856937041, 'macro avg': {'precision': 0.3305393129688517, 'recall': 0.3305781655265865, 'f1-score': 0.25741085902851885, 'support': 34705}, 'weighted avg': {'precision': 0.3326029214137805, 'recall': 0.3332372856937041, 'f1-score': 0.25780401653577273, 'support': 34705}}
[[ 885 1700 9799]
 [ 738 1368 8435]
 [ 806 1662 9312]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
2900/2900 - 42s - 42s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2315507
{'0': {'precision': 0.3780668963921731, 'recall': 0.4726922579220997, 'f1-score': 0.4201172423357813, 'support': 262746}, '1': {'precision': 0.2881963296774894, 'recall': 0.012158639551770425, 'f1-score': 0.023332893753571584, 'support': 218281}, '2': {'precision': 0.37820932629170056, 'recall': 0.5856136470606242, 'f1-score': 0.4595958989266816, 'support': 261331}, 'accuracy': 0.37702968109726037, 'macro avg': {'precision': 0.3481575174537877, 'recall': 0.35682151484483143, 'f1-score': 0.3010153450053448, 'support': 742358}, 'weighted avg': {'precision': 0.35169172992939574, 'recall': 0.37702968109726037, 'f1-score': 0.3173454158217318, 'support': 742358}}
[[124198   3642 134906]
 [ 98931   2654 116696]
 [105379   2913 153039]]
Evaluating performance on  train set...
694/694 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2227259
{'0': {'precision': 0.37653488795773365, 'recall': 0.5113478920630732, 'f1-score': 0.4337066233920665, 'support': 60628}, '1': {'precision': 0.3522879314958523, 'recall': 0.04588866813064241, 'f1-score': 0.08120027138715845, 'support': 57378}, '2': {'precision': 0.37448315924959846, 'recall': 0.5516645412443788, 'f1-score': 0.44612555889516853, 'support': 59596}, 'accuracy': 0.3745002871589284, 'macro avg': {'precision': 0.36776865956772814, 'recall': 0.3696337004793648, 'f1-score': 0.3203441512247978, 'support': 177602}, 'weighted avg': {'precision': 0.3680129304800034, 'recall': 0.3745002871589284, 'f1-score': 0.3239894434892797, 'support': 177602}}
[[31002  2596 27030]
 [26859  2633 27886]
 [24474  2245 32877]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2247459
{'0': {'precision': 0.37226032503354706, 'recall': 0.48747986528042175, 'f1-score': 0.4221494240727043, 'support': 20487}, '1': {'precision': 0.3702368692070031, 'recall': 0.0715458480521419, 'f1-score': 0.11991827544510696, 'support': 20099}, '2': {'precision': 0.37035317526115075, 'recall': 0.5506631822888418, 'f1-score': 0.44285827583472126, 'support': 20281}, 'accuracy': 0.37118635713933656, 'macro avg': {'precision': 0.37095012316723364, 'recall': 0.3698962985404685, 'f1-score': 0.32830865845084417, 'support': 60867}, 'weighted avg': {'precision': 0.37095669017078603, 'recall': 0.37118635713933656, 'f1-score': 0.3292493693027861, 'support': 60867}}
[[ 9987  1297  9203]
 [ 8877  1438  9784]
 [ 7964  1149 11168]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
7167/7167 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0126842
{'0': {'precision': 0.5383744665493329, 'recall': 0.35559373718142206, 'f1-score': 0.42829842888011793, 'support': 646035}, '1': {'precision': 0.3828227066474442, 'recall': 0.596905646310629, 'f1-score': 0.46647427206499537, 'support': 531161}, '2': {'precision': 0.5284058171028344, 'recall': 0.46594561703745957, 'f1-score': 0.4952139978739658, 'support': 657375}, 'accuracy': 0.4650024447132327, 'macro avg': {'precision': 0.48320099676653716, 'recall': 0.4728150001765035, 'f1-score': 0.46332889960635965, 'support': 1834571}, 'weighted avg': {'precision': 0.4897657349869463, 'recall': 0.4650024447132327, 'f1-score': 0.4633290388751813, 'support': 1834571}}
[[229726 266278 150031]
 [ 90770 317053 123338]
 [106207 244867 306301]]
Evaluating performance on  train set...
1570/1570 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9871999
{'0': {'precision': 0.5689951124913191, 'recall': 0.32889245707447495, 'f1-score': 0.41684105438977104, 'support': 132031}, '1': {'precision': 0.45015079862410345, 'recall': 0.7105791264001367, 'f1-score': 0.5511493317068727, 'support': 140522}, '2': {'precision': 0.5352780433166285, 'recall': 0.4292428724079724, 'f1-score': 0.4764319386014293, 'support': 129146}, 'accuracy': 0.4946763621517604, 'macro avg': {'precision': 0.518141318144017, 'recall': 0.48957148529419464, 'f1-score': 0.48147410823269104, 'support': 401699}, 'weighted avg': {'precision': 0.5165810778811173, 'recall': 0.4946763621517604, 'f1-score': 0.48298309626080527, 'support': 401699}}
[[43424 64754 23853]
 [16395 99852 24275]
 [16498 57213 55435]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98153687
{'0': {'precision': 0.5450268817204301, 'recall': 0.3576086704263269, 'f1-score': 0.431860540070907, 'support': 43089}, '1': {'precision': 0.46671130339239114, 'recall': 0.6641502980553112, 'f1-score': 0.5481952006452914, 'support': 40932}, '2': {'precision': 0.5072138669385674, 'recall': 0.4768386493805267, 'f1-score': 0.4915574550080905, 'support': 41729}, 'accuracy': 0.49695427435387673, 'macro avg': {'precision': 0.5063173506837962, 'recall': 0.49953253928738833, 'f1-score': 0.4905377319080963, 'support': 125750}, 'weighted avg': {'precision': 0.5069870205199877, 'recall': 0.49695427435387673, 'f1-score': 0.48953770023030607, 'support': 125750}}
[[15409 16788 10892]
 [ 5307 27185  8440]
 [ 7556 14275 19898]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
6357/6357 - 108s - 108s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0402634
{'0': {'precision': 0.5003104984475077, 'recall': 0.2953157399848775, 'f1-score': 0.3714044558468514, 'support': 564721}, '1': {'precision': 0.4172097898910715, 'recall': 0.47097422745694023, 'f1-score': 0.4424647474925869, 'support': 505344}, '2': {'precision': 0.43074894106457573, 'recall': 0.5593031103707746, 'f1-score': 0.48667991178253023, 'support': 557104}, 'accuracy': 0.4402523646898386, 'macro avg': {'precision': 0.4494230764677183, 'recall': 0.44186435927086415, 'f1-score': 0.4335163717073229, 'support': 1627169}, 'weighted avg': {'precision': 0.4506859872080454, 'recall': 0.4402523646898386, 'f1-score': 0.43294097087695155, 'support': 1627169}}
[[166771 175674 222276]
 [ 77838 238004 189502]
 [ 88726 156788 311590]]
Evaluating performance on  train set...
1701/1701 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0199684
{'0': {'precision': 0.5242952842077336, 'recall': 0.2714299449228783, 'f1-score': 0.3576848764021557, 'support': 145614}, '1': {'precision': 0.4534805075345616, 'recall': 0.5781555038941508, 'f1-score': 0.5082844112367182, 'support': 144961}, '2': {'precision': 0.44948007624787406, 'recall': 0.5437404638125418, 'f1-score': 0.49213743630120504, 'support': 144843}, 'accuracy': 0.46413101892893727, 'macro avg': {'precision': 0.4757519559967231, 'recall': 0.46444197087652367, 'f1-score': 0.4527022413133596, 'support': 435418}, 'weighted avg': {'precision': 0.47583187661353765, 'recall': 0.46413101892893727, 'f1-score': 0.452549055886263, 'support': 435418}}
[[39524 53776 52314]
 [17004 83810 44147]
 [18857 47229 78757]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0335969
{'0': {'precision': 0.5208829601397491, 'recall': 0.26826425665037723, 'f1-score': 0.3541399554625818, 'support': 48907}, '1': {'precision': 0.44038047973531846, 'recall': 0.5638728262481202, 'f1-score': 0.4945337680311348, 'support': 47211}, '2': {'precision': 0.4410913883706202, 'recall': 0.537514862017897, 'f1-score': 0.48455275380305, 'support': 47941}, 'accuracy': 0.4547442367363372, 'macro avg': {'precision': 0.46745160941522923, 'recall': 0.4565506483054648, 'f1-score': 0.4444088257655889, 'support': 144059}, 'weighted avg': {'precision': 0.4679470773100933, 'recall': 0.4547442367363372, 'f1-score': 0.44354951856113406, 'support': 144059}}
[[13120 17873 17914]
 [ 5852 26621 14738]
 [ 6216 15956 25769]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
7459/7459 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0481309
{'0': {'precision': 0.476910537413399, 'recall': 0.36339358525007154, 'f1-score': 0.4124845406800415, 'support': 740668}, '1': {'precision': 0.30390157012504376, 'recall': 0.3328905179718731, 'f1-score': 0.31773620615711645, 'support': 409501}, '2': {'precision': 0.458631869492747, 'recall': 0.5415488708729755, 'f1-score': 0.4966533768273529, 'support': 759082}, 'accuracy': 0.4276823738733147, 'macro avg': {'precision': 0.41314799234372995, 'recall': 0.4126109913649734, 'f1-score': 0.40895804122150364, 'support': 1909251}, 'weighted avg': {'precision': 0.43253588320811476, 'recall': 0.4276823738733147, 'f1-score': 0.4256266109185283, 'support': 1909251}}
[[269154 155988 315526]
 [103470 136319 169712]
 [191746 156256 411080]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.015278
{'0': {'precision': 0.5303554177047847, 'recall': 0.2905067609909621, 'f1-score': 0.37539026299452055, 'support': 143618}, '1': {'precision': 0.4487963288400897, 'recall': 0.6461729257392929, 'f1-score': 0.5296953054249073, 'support': 140303}, '2': {'precision': 0.47593056549749463, 'recall': 0.4868067191394095, 'f1-score': 0.481307207740229, 'support': 142042}, 'accuracy': 0.47311386200209876, 'macro avg': {'precision': 0.48502743734745635, 'recall': 0.47449546862322145, 'f1-score': 0.46213092538655226, 'support': 425963}, 'weighted avg': {'precision': 0.48534305817540957, 'recall': 0.47311386200209876, 'f1-score': 0.46153416524349633, 'support': 425963}}
[[41722 59420 42476]
 [15978 90660 33665]
 [20968 51927 69147]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0253637
{'0': {'precision': 0.4939163376031333, 'recall': 0.32330258263811545, 'f1-score': 0.3907996342206868, 'support': 47587}, '1': {'precision': 0.40794753086419755, 'recall': 0.5841827573823928, 'f1-score': 0.48041253506888837, 'support': 36201}, '2': {'precision': 0.47715859881676054, 'recall': 0.4850376126312309, 'f1-score': 0.48106584678452474, 'support': 48388}, 'accuracy': 0.45396289795424283, 'macro avg': {'precision': 0.4596741557613638, 'recall': 0.46417431755057975, 'f1-score': 0.45075933869136664, 'support': 132176}, 'weighted avg': {'precision': 0.46423598536709026, 'recall': 0.45396289795424283, 'f1-score': 0.44838859225501027, 'support': 132176}}
[[15385 15868 16334]
 [ 5670 21148  9383]
 [10094 14824 23470]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
8238/8238 - 114s - 114s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913677
{'0': {'precision': 0.4416677022814594, 'recall': 0.43337592789240764, 'f1-score': 0.4374825293186883, 'support': 787268}, '1': {'precision': 0.3448149160501683, 'recall': 0.1447298634176801, 'f1-score': 0.20388335366814905, 'support': 531694}, '2': {'precision': 0.4312124176928944, 'recall': 0.6077401513386481, 'f1-score': 0.5044794301477448, 'support': 789752}, 'accuracy': 0.42589891279708864, 'macro avg': {'precision': 0.4058983453415073, 'recall': 0.395281980882912, 'f1-score': 0.3819484377115274, 'support': 2108714}, 'weighted avg': {'precision': 0.4133314142704496, 'recall': 0.42589891279708864, 'f1-score': 0.40367408318763937, 'support': 2108714}}
[[341183  75028 371057]
 [192706  76952 262036]
 [238599  71189 479964]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0934039
{'0': {'precision': 0.44683454627423197, 'recall': 0.35862710637857953, 'f1-score': 0.3979009548934706, 'support': 154768}, '1': {'precision': 0.41803748533646157, 'recall': 0.4081116078109851, 'f1-score': 0.413014918689684, 'support': 153681}, '2': {'precision': 0.4225527499135247, 'recall': 0.5165697334009914, 'f1-score': 0.4648551498848165, 'support': 153714}, 'accuracy': 0.4276132014029682, 'macro avg': {'precision': 0.42914159384140604, 'recall': 0.4277694825301854, 'f1-score': 0.425257007822657, 'support': 462163}, 'weighted avg': {'precision': 0.42918273691743086, 'recall': 0.4276132014029682, 'f1-score': 0.42519549426392134, 'support': 462163}}
[[55504 45387 53877]
 [36328 62719 54634]
 [32384 41926 79404]]
Evaluating performance on  val set...
642/642 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0839411
{'0': {'precision': 0.442511428385727, 'recall': 0.3756114605171209, 'f1-score': 0.40632615507037356, 'support': 54378}, '1': {'precision': 0.4595955543072664, 'recall': 0.41546217877804176, 'f1-score': 0.43641593721127375, 'support': 55141}, '2': {'precision': 0.4241133506052489, 'recall': 0.5287119318285496, 'f1-score': 0.4706713666119784, 'support': 54803}, 'accuracy': 0.4400445466827327, 'macro avg': {'precision': 0.44207344443274743, 'recall': 0.4399285237079041, 'f1-score': 0.4378044862978752, 'support': 164322}, 'weighted avg': {'precision': 0.44210835351344, 'recall': 0.4400445466827327, 'f1-score': 0.43788304523204363, 'support': 164322}}
[[20425 13660 20293]
 [13181 22909 19051]
 [12551 13277 28975]]
testing model on single stock: results/universal/W5/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
31315/31315 - 424s - 424s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0350496
{'0': {'precision': 0.4649734702607328, 'recall': 0.4198426296639197, 'f1-score': 0.44125708041444595, 'support': 3319177}, '1': {'precision': 0.22716671138723193, 'recall': 0.03449237663945344, 'f1-score': 0.05989105769806331, 'support': 1276340}, '2': {'precision': 0.45975693353635844, 'recall': 0.648540808174526, 'f1-score': 0.5380704516806532, 'support': 3420969}, 'accuracy': 0.4560843741260198, 'macro avg': {'precision': 0.38396570506144106, 'recall': 0.3676252714926331, 'f1-score': 0.34640619659772076, 'support': 8016486}, 'weighted avg': {'precision': 0.42488509624722487, 'recall': 0.4560843741260198, 'f1-score': 0.42185242261966627, 'support': 8016486}}
[[1393532   78597 1847048]
 [ 472326   44024  759990]
 [1131156   71175 2218638]]
Evaluating performance on  train set...
5759/5759 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1849501
{'0': {'precision': 0.41329400971117475, 'recall': 0.38840299736662837, 'f1-score': 0.4004620966482268, 'support': 491765}, '1': {'precision': 0.38736509197146546, 'recall': 0.11228340630202874, 'f1-score': 0.17410108169782576, 'support': 486510}, '2': {'precision': 0.3780863878613367, 'recall': 0.6640774193027987, 'f1-score': 0.48184101385691264, 'support': 495897}, 'accuracy': 0.3900114776294761, 'macro avg': {'precision': 0.39291516318132563, 'recall': 0.388254607657152, 'f1-score': 0.3521347307343217, 'support': 1474172}, 'weighted avg': {'precision': 0.3928933835820561, 'recall': 0.3900114776294761, 'f1-score': 0.35313292713714944, 'support': 1474172}}
[[191003  46734 254028]
 [144223  54627 287660]
 [126922  39661 329314]]
Evaluating performance on  val set...
2129/2129 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1645275
{'0': {'precision': 0.40244161879981016, 'recall': 0.3929501621846188, 'f1-score': 0.39763925943891987, 'support': 187749}, '1': {'precision': 0.3887165519154624, 'recall': 0.09339627214775674, 'f1-score': 0.1506065595395717, 'support': 165028}, '2': {'precision': 0.3913556626745515, 'recall': 0.6557141593334825, 'f1-score': 0.4901630129286116, 'support': 192163}, 'accuracy': 0.39489301574485264, 'macro avg': {'precision': 0.39417127779660804, 'recall': 0.38068686455528605, 'f1-score': 0.34613627730236773, 'support': 544940}, 'weighted avg': {'precision': 0.39437590344639833, 'recall': 0.39489301574485264, 'f1-score': 0.35545540368021245, 'support': 544940}}
[[ 73776  12625 101348]
 [ 54999  15413  94616]
 [ 54546  11613 126004]]
training model: results/universal/W5/deepVOL_L3/h200
Epoch 1/50
9913/9913 - 539s - loss: 3.2447 - accuracy200: 0.3888 - val_loss: 3.3130 - val_accuracy200: 0.3645 - 539s/epoch - 54ms/step
Epoch 2/50
9913/9913 - 530s - loss: 3.2294 - accuracy200: 0.3986 - val_loss: 3.3186 - val_accuracy200: 0.3640 - 530s/epoch - 53ms/step
Epoch 3/50
9913/9913 - 526s - loss: 3.2187 - accuracy200: 0.4038 - val_loss: 3.3272 - val_accuracy200: 0.3468 - 526s/epoch - 53ms/step
Epoch 4/50
9913/9913 - 523s - loss: 3.2063 - accuracy200: 0.4115 - val_loss: 3.5516 - val_accuracy200: 0.3239 - 523s/epoch - 53ms/step
Epoch 5/50
9913/9913 - 519s - loss: 3.1956 - accuracy200: 0.4158 - val_loss: 3.5255 - val_accuracy200: 0.3292 - 519s/epoch - 52ms/step
Epoch 6/50
9913/9913 - 521s - loss: 3.1909 - accuracy200: 0.4188 - val_loss: 3.4582 - val_accuracy200: 0.3362 - 521s/epoch - 53ms/step
Epoch 7/50
9913/9913 - 512s - loss: 3.1840 - accuracy200: 0.4216 - val_loss: 3.4030 - val_accuracy200: 0.3450 - 512s/epoch - 52ms/step
Epoch 8/50
9913/9913 - 518s - loss: 3.1791 - accuracy200: 0.4239 - val_loss: 3.4064 - val_accuracy200: 0.3452 - 518s/epoch - 52ms/step
Epoch 9/50
9913/9913 - 517s - loss: 3.1760 - accuracy200: 0.4254 - val_loss: 3.4076 - val_accuracy200: 0.3451 - 517s/epoch - 52ms/step
Epoch 10/50
9913/9913 - 524s - loss: 3.1730 - accuracy200: 0.4266 - val_loss: 3.3839 - val_accuracy200: 0.3480 - 524s/epoch - 53ms/step
Epoch 11/50
9913/9913 - 521s - loss: 3.1703 - accuracy200: 0.4277 - val_loss: 3.3758 - val_accuracy200: 0.3497 - 521s/epoch - 53ms/step
testing model in sample: results/universal/W5/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
50153/50153 - 1389s - 1389s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.111333
{'0': {'precision': 0.4712453173268033, 'recall': 0.059194046522483924, 'f1-score': 0.10517664841054755, 'support': 4798540}, '1': {'precision': 0.25576586970676596, 'recall': 0.09338187595324458, 'f1-score': 0.1368125500732194, 'support': 3116986}, '2': {'precision': 0.39503256739022224, 'recall': 0.8905210685241216, 'f1-score': 0.5472892210583847, 'support': 4922865}, 'accuracy': 0.38626569326327576, 'macro avg': {'precision': 0.37401458480793054, 'recall': 0.34769899699995005, 'f1-score': 0.2630928065140506, 'support': 12838391}, 'weighted avg': {'precision': 0.38970616645221656, 'recall': 0.38626569326327576, 'f1-score': 0.2823849272772622, 'support': 12838391}}
[[ 284045  467267 4047228]
 [ 159455  291070 2666461]
 [ 159254  379696 4383915]]
Evaluating performance on  train set...
9913/9913 - 284s - 284s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988145
{'0': {'precision': 0.4450566495506466, 'recall': 0.11467299430822438, 'f1-score': 0.18235939154091618, 'support': 838227}, '1': {'precision': 0.3502740664611168, 'recall': 0.11986630589735894, 'f1-score': 0.17861073358884505, 'support': 852992}, '2': {'precision': 0.3555611298490604, 'recall': 0.8530114185861194, 'f1-score': 0.5019106286326466, 'support': 845814}, 'accuracy': 0.36257155504086863, 'macro avg': {'precision': 0.38363061528694126, 'recall': 0.36251690626390093, 'f1-score': 0.2876269179208026, 'support': 2537033}, 'weighted avg': {'precision': 0.3833525453408939, 'recall': 0.36257155504086863, 'f1-score': 0.28763328226510143, 'support': 2537033}}
[[ 96122 110467 631638]
 [ 74718 102245 676029]
 [ 45137  79188 721489]]
Evaluating performance on  val set...
3496/3496 - 95s - 95s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1032026
{'0': {'precision': 0.4313963120915534, 'recall': 0.09183866753755715, 'f1-score': 0.15143812636986856, 'support': 306200}, '1': {'precision': 0.3330804912915366, 'recall': 0.12261006840905105, 'f1-score': 0.17924014862106863, 'support': 279349}, '2': {'precision': 0.36305600920955877, 'recall': 0.8541549227330159, 'f1-score': 0.5095354787838496, 'support': 308670}, 'accuracy': 0.36459077697968845, 'macro avg': {'precision': 0.37584427086421623, 'recall': 0.3562012195598747, 'f1-score': 0.28007125125826227, 'support': 894219}, 'weighted avg': {'precision': 0.3770930289861294, 'recall': 0.36459077697968845, 'f1-score': 0.28373276211734655, 'support': 894219}}
[[ 28121  38523 239556]
 [ 22104  34251 222994]
 [ 14961  30057 263652]]
testing model out of sample: results/universal/W5/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
20896/20896 - 582s - 582s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088912
{'0': {'precision': 0.43752234682268815, 'recall': 0.05579490761298439, 'f1-score': 0.09896884286974077, 'support': 1929979}, '1': {'precision': 0.2820935520286022, 'recall': 0.12035205891843255, 'f1-score': 0.16872113334452257, 'support': 1465891}, '2': {'precision': 0.37752578664280717, 'recall': 0.865502049694466, 'f1-score': 0.5257313353732614, 'support': 1952974}, 'accuracy': 0.3691281704981488, 'macro avg': {'precision': 0.3657138951646992, 'recall': 0.34721633874196095, 'f1-score': 0.2644737705291749, 'support': 5348844}, 'weighted avg': {'precision': 0.373019924701153, 'recall': 0.3691281704981488, 'f1-score': 0.27390483032253227, 'support': 5348844}}
[[ 107683  252888 1569408]
 [  71861  176423 1217607]
 [  66576  196095 1690303]]
Evaluating performance on  train set...
4957/4957 - 146s - 146s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043906
{'0': {'precision': 0.4129683762955089, 'recall': 0.08016921172100702, 'f1-score': 0.13427225990409122, 'support': 426448}, '1': {'precision': 0.33991544861174167, 'recall': 0.13717078416956355, 'f1-score': 0.19546348409846068, 'support': 420279}, '2': {'precision': 0.34917422686196364, 'recall': 0.8413939665620693, 'f1-score': 0.49353424588925504, 'support': 421617}, 'accuracy': 0.3521000611821399, 'macro avg': {'precision': 0.3673526839230714, 'recall': 0.35291132081754667, 'f1-score': 0.27442332996393565, 'support': 1268344}, 'weighted avg': {'precision': 0.3675553737538254, 'recall': 0.3521000611821399, 'f1-score': 0.2739728042818722, 'support': 1268344}}
[[ 34188  64533 327727]
 [ 29145  57650 333484]
 [ 19453  47418 354746]]
Evaluating performance on  val set...
1701/1701 - 47s - 47s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049953
{'0': {'precision': 0.40146683673469385, 'recall': 0.0846984425981365, 'f1-score': 0.1398850031943557, 'support': 148645}, '1': {'precision': 0.33373764437524894, 'recall': 0.13264880267096477, 'f1-score': 0.18984213290493993, 'support': 138976}, '2': {'precision': 0.3571112909427963, 'recall': 0.8439685047914223, 'f1-score': 0.5018662096083077, 'support': 147451}, 'accuracy': 0.35734085392762577, 'macro avg': {'precision': 0.364105257350913, 'recall': 0.35377191668684116, 'f1-score': 0.27719778190253447, 'support': 435072}, 'weighted avg': {'precision': 0.36479933843577483, 'recall': 0.35734085392762577, 'f1-score': 0.278522591744301, 'support': 435072}}
[[ 12590  21029 115026]
 [ 11537  18435 109004]
 [  7233  15774 124444]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1031654
{'0': {'precision': 0.3732533289495315, 'recall': 0.049827179459044274, 'f1-score': 0.08791783235399463, 'support': 91135}, '1': {'precision': 0.3169354289991155, 'recall': 0.11542416770948198, 'f1-score': 0.1692202897234458, 'support': 80711}, '2': {'precision': 0.3719185236768802, 'recall': 0.859038542734785, 'f1-score': 0.5190958406482927, 'support': 99474}, 'accuracy': 0.36602167182662537, 'macro avg': {'precision': 0.35403576054184244, 'recall': 0.34142996330110376, 'f1-score': 0.258744654241911, 'support': 271320}, 'weighted avg': {'precision': 0.35601076503021206, 'recall': 0.36602167182662537, 'f1-score': 0.2701860169102853, 'support': 271320}}
[[ 4541 10019 76575]
 [ 3662  9316 67733]
 [ 3963 10059 85452]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1056837
{'0': {'precision': 0.45759368836291914, 'recall': 0.0667433831990794, 'f1-score': 0.11649510419281948, 'support': 24332}, '1': {'precision': 0.3349539406345957, 'recall': 0.11828491392942665, 'f1-score': 0.17483054526027583, 'support': 22133}, '2': {'precision': 0.3456538144895719, 'recall': 0.8685140493018445, 'f1-score': 0.4945036070079011, 'support': 23204}, 'accuracy': 0.3501557364107422, 'macro avg': {'precision': 0.3794004811623622, 'recall': 0.3511807821434502, 'f1-score': 0.2619430854869988, 'support': 69669}, 'weighted avg': {'precision': 0.38134975820993666, 'recall': 0.3501557364107422, 'f1-score': 0.26092731387671286, 'support': 69669}}
[[ 1624  3045 19663]
 [ 1027  2618 18488]
 [  898  2153 20153]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1084778
{'0': {'precision': 0.4432930339666091, 'recall': 0.08579387186629527, 'f1-score': 0.143764002987304, 'support': 8975}, '1': {'precision': 0.2921168467386955, 'recall': 0.10345804988662131, 'f1-score': 0.15279958137100993, 'support': 7056}, '2': {'precision': 0.3618060695780903, 'recall': 0.8656434474616292, 'f1-score': 0.5103184270053941, 'support': 8470}, 'accuracy': 0.36047508264968775, 'macro avg': {'precision': 0.365738650094465, 'recall': 0.35163178973818193, 'f1-score': 0.26896067045456934, 'support': 24501}, 'weighted avg': {'precision': 0.3715860111736246, 'recall': 0.36047508264968775, 'f1-score': 0.27308407206647023, 'support': 24501}}
[[ 770 1034 7171]
 [ 564  730 5762]
 [ 403  735 7332]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028136
{'0': {'precision': 0.5213327480433828, 'recall': 0.22207172077877657, 'f1-score': 0.311467754934947, 'support': 219267}, '1': {'precision': 0.2106462781304097, 'recall': 0.1177922622696912, 'f1-score': 0.1510937273649138, 'support': 123964}, '2': {'precision': 0.4243918433232026, 'recall': 0.7790948026391944, 'f1-score': 0.5494726186199915, 'support': 215975}, 'accuracy': 0.41408711637571843, 'macro avg': {'precision': 0.3854569564989984, 'recall': 0.3729862618958874, 'f1-score': 0.33734470030661745, 'support': 559206}, 'weighted avg': {'precision': 0.41501995910114564, 'recall': 0.41408711637571843, 'f1-score': 0.36783784839010647, 'support': 559206}}
[[ 48693  31733 138841]
 [ 19983  14602  89379]
 [ 24725  22985 168265]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0749582
{'0': {'precision': 0.454131632357205, 'recall': 0.3370706722906086, 'f1-score': 0.3869413770103016, 'support': 46468}, '1': {'precision': 0.3582464081873647, 'recall': 0.1321775437959517, 'f1-score': 0.19310692357676137, 'support': 55085}, '2': {'precision': 0.38016416867444747, 'recall': 0.7417680817290081, 'f1-score': 0.5026928248801849, 'support': 49138}, 'accuracy': 0.39413767245555476, 'macro avg': {'precision': 0.3975140697396724, 'recall': 0.40367209927185616, 'f1-score': 0.3609137084890826, 'support': 150691}, 'weighted avg': {'precision': 0.39496120543164875, 'recall': 0.39413767245555476, 'f1-score': 0.35383006829275215, 'support': 150691}}
[[15663  7405 23400]
 [11776  7281 36028]
 [ 7051  5638 36449]]
Evaluating performance on  val set...
222/222 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0815531
{'0': {'precision': 0.4511751720555772, 'recall': 0.3539448887077879, 'f1-score': 0.39668902526045385, 'support': 19633}, '1': {'precision': 0.2815850815850816, 'recall': 0.14616734224695987, 'f1-score': 0.19244095742562425, 'support': 16529}, '2': {'precision': 0.42720259597134635, 'recall': 0.6811969149663185, 'f1-score': 0.5250978326309452, 'support': 20486}, 'accuracy': 0.4116650190651038, 'macro avg': {'precision': 0.3866542832040017, 'recall': 0.3937697153070221, 'f1-score': 0.3714092717723411, 'support': 56648}, 'weighted avg': {'precision': 0.3930220722277214, 'recall': 0.4116650190651038, 'f1-score': 0.3835299819500102, 'support': 56648}}
[[ 6949  3381  9303]
 [ 4705  2416  9408]
 [ 3748  2783 13955]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
2341/2341 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1071067
{'0': {'precision': 0.4287957367845078, 'recall': 0.08293493215293084, 'f1-score': 0.13898774295287267, 'support': 217327}, '1': {'precision': 0.25294088263942655, 'recall': 0.13286061933841906, 'f1-score': 0.1742133306956922, 'support': 152453}, '2': {'precision': 0.39324896106427254, 'recall': 0.8176232990418426, 'f1-score': 0.5310709039811852, 'support': 229503}, 'accuracy': 0.3769938409732964, 'macro avg': {'precision': 0.35832852682940225, 'recall': 0.34447295017773083, 'f1-score': 0.28142399254325, 'support': 599283}, 'weighted avg': {'precision': 0.3704465232291404, 'recall': 0.3769938409732964, 'f1-score': 0.2981020649570625, 'support': 599283}}
[[ 18024  31541 167762]
 [ 10436  20255 121762]
 [ 13574  28282 187647]]
Evaluating performance on  train set...
483/483 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1101307
{'0': {'precision': 0.4020544242205803, 'recall': 0.05391232903194626, 'f1-score': 0.09507574950459186, 'support': 41382}, '1': {'precision': 0.33398189029409564, 'recall': 0.10956449157951588, 'f1-score': 0.1649999075734329, 'support': 40734}, '2': {'precision': 0.34293363931918147, 'recall': 0.8667826759474091, 'f1-score': 0.4914357751651182, 'support': 41376}, 'accuracy': 0.34462151394422313, 'macro avg': {'precision': 0.3596566512779525, 'recall': 0.3434198321862904, 'f1-score': 0.25050381074771433, 'support': 123492}, 'weighted avg': {'precision': 0.3597921870469844, 'recall': 0.34462151394422313, 'f1-score': 0.25094076972052576, 'support': 123492}}
[[ 2231  4856 34295]
 [ 1850  4463 34421]
 [ 1468  4044 35864]]
Evaluating performance on  val set...
162/162 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1178316
{'0': {'precision': 0.39598997493734334, 'recall': 0.041779599391815955, 'f1-score': 0.07558452430783949, 'support': 15127}, '1': {'precision': 0.2797270955165692, 'recall': 0.10103854955113536, 'f1-score': 0.14845467477046423, 'support': 11362}, '2': {'precision': 0.364034472110715, 'recall': 0.8742079007685047, 'f1-score': 0.5140218403789365, 'support': 14834}, 'accuracy': 0.3568956755317862, 'macro avg': {'precision': 0.34658384752154253, 'recall': 0.339008683237152, 'f1-score': 0.24602034648574675, 'support': 41323}, 'weighted avg': {'precision': 0.35255153230469227, 'recall': 0.3568956755317862, 'f1-score': 0.25300944012118787, 'support': 41323}}
[[  632  1585 12910]
 [  469  1148  9745]
 [  495  1371 12968]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109662
{'0': {'precision': 0.25507246376811593, 'recall': 0.00106370762545404, 'f1-score': 0.00211858031044424, 'support': 165459}, '1': {'precision': 0.38104756047560473, 'recall': 0.03824332734950852, 'f1-score': 0.06951034240972302, 'support': 194413}, '2': {'precision': 0.3059828545645962, 'recall': 0.9596302003081664, 'f1-score': 0.4640128938085391, 'support': 159005}, 'accuracy': 0.3087379089842101, 'macro avg': {'precision': 0.3140342929361056, 'recall': 0.33297907842770963, 'f1-score': 0.17854727217623545, 'support': 518877}, 'weighted avg': {'precision': 0.3178738659593624, 'recall': 0.3087379089842101, 'f1-score': 0.1689121363223154, 'support': 518877}}
[[   176   5879 159404]
 [   293   7435 186685]
 [   221   6198 152586]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090623
{'0': {'precision': 0.23837209302325582, 'recall': 0.0014737598849748383, 'f1-score': 0.002929408402400686, 'support': 27820}, '1': {'precision': 0.3369656328583403, 'recall': 0.043252160814833414, 'f1-score': 0.07666391202085056, 'support': 27883}, '2': {'precision': 0.34063920155528316, 'recall': 0.9550078111438987, 'f1-score': 0.5021631587594239, 'support': 28805}, 'accuracy': 0.3402754768779287, 'macro avg': {'precision': 0.30532564247895977, 'recall': 0.33324457728123563, 'f1-score': 0.19391882639422506, 'support': 84508}, 'weighted avg': {'precision': 0.3057608341186161, 'recall': 0.3402754768779287, 'f1-score': 0.19742421769178503, 'support': 84508}}
[[   41  1150 26629]
 [   58  1206 26619]
 [   73  1223 27509]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.113194
{'0': {'precision': 0.46153846153846156, 'recall': 0.00298804780876494, 'f1-score': 0.005937654626422563, 'support': 12048}, '1': {'precision': 0.2837559972583962, 'recall': 0.03811101905550953, 'f1-score': 0.06719688362278851, 'support': 10863}, '2': {'precision': 0.34008683068017365, 'recall': 0.9564185178904527, 'f1-score': 0.5017570392776122, 'support': 11794}, 'accuracy': 0.33799164385535224, 'macro avg': {'precision': 0.36179376315901046, 'recall': 0.3325058615849091, 'f1-score': 0.19163052584227444, 'support': 34705}, 'weighted avg': {'precision': 0.36461722702421295, 'recall': 0.33799164385535224, 'f1-score': 0.19360954130452815, 'support': 34705}}
[[   36   554 11458]
 [   19   414 10430]
 [   23   491 11280]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
2900/2900 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134882
{'0': {'precision': 0.3570124481327801, 'recall': 0.01633573698779946, 'f1-score': 0.031241943507420145, 'support': 263349}, '1': {'precision': 0.320286527688493, 'recall': 0.07941126913215933, 'f1-score': 0.12726795019632456, 'support': 219591}, '2': {'precision': 0.3534059417367129, 'recall': 0.9207302500212013, 'f1-score': 0.5107641446795134, 'support': 259418}, 'accuracy': 0.3510354842272866, 'macro avg': {'precision': 0.343568305852662, 'recall': 0.3388257520470534, 'f1-score': 0.2230913461277527, 'support': 742358}, 'weighted avg': {'precision': 0.3448885479760681, 'recall': 0.3510354842272866, 'f1-score': 0.22721630792254774, 'support': 742358}}
[[  4302  19824 239223]
 [  4367  17438 197786]
 [  3381  17183 238854]]
Evaluating performance on  train set...
694/694 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.108314
{'0': {'precision': 0.36872909698996653, 'recall': 0.04417067307692308, 'f1-score': 0.07889087656529517, 'support': 59904}, '1': {'precision': 0.3489174272978136, 'recall': 0.11214204089986526, 'f1-score': 0.1697321716682801, 'support': 58631}, '2': {'precision': 0.34229657874945574, 'recall': 0.878426193983104, 'f1-score': 0.4926299199141701, 'support': 59067}, 'accuracy': 0.34406707131676445, 'macro avg': {'precision': 0.3533143676790786, 'recall': 0.3449129693199641, 'f1-score': 0.2470843227159151, 'support': 177602}, 'weighted avg': {'precision': 0.3533978081495657, 'recall': 0.34406707131676445, 'f1-score': 0.2464815571132119, 'support': 177602}}
[[ 2646  6772 50486]
 [ 2846  6575 49210]
 [ 1684  5497 51886]]
Evaluating performance on  val set...
238/238 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.106617
{'0': {'precision': 0.3405954974582426, 'recall': 0.04719971821063755, 'f1-score': 0.08290979802890351, 'support': 19873}, '1': {'precision': 0.37928863707900534, 'recall': 0.11472912501190136, 'f1-score': 0.17616959064327484, 'support': 21006}, '2': {'precision': 0.3388203017832647, 'recall': 0.8773764258555133, 'f1-score': 0.4888566769342272, 'support': 19988}, 'accuracy': 0.34312517456092795, 'macro avg': {'precision': 0.35290147877350425, 'recall': 0.34643508969268405, 'f1-score': 0.24931202186880186, 'support': 60867}, 'weighted avg': {'precision': 0.35336605424143025, 'recall': 0.34312517456092795, 'f1-score': 0.2484031099913313, 'support': 60867}}
[[  938  2078 16857]
 [ 1231  2410 17365]
 [  585  1866 17537]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
7167/7167 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0932418
{'0': {'precision': 0.46360154519565444, 'recall': 0.21567551073294375, 'f1-score': 0.2943938681985007, 'support': 652151}, '1': {'precision': 0.28363431620395035, 'recall': 0.15087660758292695, 'f1-score': 0.19697448823608912, 'support': 497486}, '2': {'precision': 0.4155632720801297, 'recall': 0.7684390028820295, 'f1-score': 0.539416237932236, 'support': 684934}, 'accuracy': 0.4044771229895163, 'macro avg': {'precision': 0.3875997111599115, 'recall': 0.3783303737326334, 'f1-score': 0.34359486478894197, 'support': 1834571}, 'weighted avg': {'precision': 0.39686429521172056, 'recall': 0.4044771229895163, 'f1-score': 0.3594550591424468, 'support': 1834571}}
[[140653 108565 402933]
 [ 85144  75059 337283]
 [ 77595  81009 526330]]
Evaluating performance on  train set...
1570/1570 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876938
{'0': {'precision': 0.4475502746774715, 'recall': 0.26617928607860675, 'f1-score': 0.3338200325393183, 'support': 135281}, '1': {'precision': 0.3419530394304491, 'recall': 0.14701424451115427, 'f1-score': 0.20562507718272752, 'support': 135912}, '2': {'precision': 0.3765700565810151, 'recall': 0.7583252877262349, 'f1-score': 0.5032404052731272, 'support': 130506}, 'accuracy': 0.38575152041702865, 'macro avg': {'precision': 0.3886911235629786, 'recall': 0.3905062727719986, 'f1-score': 0.3475618383317243, 'support': 401699}, 'weighted avg': {'precision': 0.38876178931955563, 'recall': 0.38575152041702865, 'f1-score': 0.3454883274356797, 'support': 401699}}
[[36009 23124 76148]
 [28236 19981 87695]
 [16213 15327 98966]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955149
{'0': {'precision': 0.4714543269230769, 'recall': 0.20898173019290964, 'f1-score': 0.2895947089133277, 'support': 45047}, '1': {'precision': 0.31491060384572134, 'recall': 0.14717010878133374, 'f1-score': 0.2005945132870138, 'support': 38058}, '2': {'precision': 0.38456293467884906, 'recall': 0.7935279634189236, 'f1-score': 0.5180609456449353, 'support': 42645}, 'accuracy': 0.3885089463220676, 'macro avg': {'precision': 0.39030928848254914, 'recall': 0.3832266007977223, 'f1-score': 0.33608338928175896, 'support': 125750}, 'weighted avg': {'precision': 0.39460959980472227, 'recall': 0.3885089463220676, 'f1-score': 0.3401376371063548, 'support': 125750}}
[[ 9414  7460 28173]
 [ 6474  5601 25983]
 [ 4080  4725 33840]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
6357/6357 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089226
{'0': {'precision': 0.47859573360580676, 'recall': 0.08177510446296074, 'f1-score': 0.13968327204899747, 'support': 607153}, '1': {'precision': 0.2578627825175872, 'recall': 0.13148461294454078, 'f1-score': 0.17416316917638253, 'support': 419281}, '2': {'precision': 0.38941660125408895, 'recall': 0.8489500362056481, 'f1-score': 0.5339214215458673, 'support': 600735}, 'accuracy': 0.3778175469173761, 'macro avg': {'precision': 0.3752917057924943, 'recall': 0.35406991787104986, 'f1-score': 0.28258928759041574, 'support': 1627169}, 'weighted avg': {'precision': 0.38879426950556334, 'recall': 0.3778175469173761, 'f1-score': 0.2941167823269521, 'support': 1627169}}
[[ 49650  93827 463676]
 [ 28186  55129 335966]
 [ 25905  64836 509994]]
Evaluating performance on  train set...
1701/1701 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016922
{'0': {'precision': 0.43456478767636836, 'recall': 0.087770863735235, 'f1-score': 0.14604450858445295, 'support': 145276}, '1': {'precision': 0.34359115932379547, 'recall': 0.14442025077984752, 'f1-score': 0.2033621360809681, 'support': 146503}, '2': {'precision': 0.351291883528739, 'recall': 0.8425218777630031, 'f1-score': 0.4958413229100087, 'support': 143639}, 'accuracy': 0.35581441281710907, 'macro avg': {'precision': 0.37648261017630097, 'recall': 0.3582376640926952, 'f1-score': 0.28174932252514323, 'support': 435418}, 'weighted avg': {'precision': 0.3764846298661761, 'recall': 0.35581441281710907, 'f1-score': 0.2807235273526951, 'support': 435418}}
[[ 12751  24124 108401]
 [ 10268  21158 115077]
 [  6323  16297 121019]]
Evaluating performance on  val set...
563/563 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052494
{'0': {'precision': 0.4204502459326523, 'recall': 0.08901215531569778, 'f1-score': 0.14692029284899769, 'support': 49937}, '1': {'precision': 0.3262349180158812, 'recall': 0.13878956720117577, 'f1-score': 0.19473384527785048, 'support': 45587}, '2': {'precision': 0.3574277124801697, 'recall': 0.8402183990934378, 'f1-score': 0.5015126546474162, 'support': 48535}, 'accuracy': 0.3578533795181141, 'macro avg': {'precision': 0.36803762547623436, 'recall': 0.35600670720343713, 'f1-score': 0.28105559759142146, 'support': 144059}, 'weighted avg': {'precision': 0.36940315540128604, 'recall': 0.3578533795181141, 'f1-score': 0.28151665055285763, 'support': 144059}}
[[ 4445  7715 37777]
 [ 3724  6327 35536]
 [ 2403  5352 40780]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
7459/7459 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131823
{'0': {'precision': 0.46457773954450265, 'recall': 0.0711161774838454, 'f1-score': 0.12335026376169281, 'support': 751798}, '1': {'precision': 0.22625654232782255, 'recall': 0.13700583800969396, 'f1-score': 0.17066709279390638, 'support': 397567}, '2': {'precision': 0.4143616569290627, 'recall': 0.8470757455723622, 'f1-score': 0.5565011926612643, 'support': 759886}, 'accuracy': 0.3936700831896906, 'macro avg': {'precision': 0.3683986462671293, 'recall': 0.3517325870219672, 'f1-score': 0.2835061830722878, 'support': 1909251}, 'weighted avg': {'precision': 0.3949655504880821, 'recall': 0.3936700831896906, 'f1-score': 0.30559813820336124, 'support': 1909251}}
[[ 53465 103523 594810]
 [ 28161  54469 314937]
 [ 33457  82748 643681]]
Evaluating performance on  train set...
1664/1664 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960817
{'0': {'precision': 0.4264017288990275, 'recall': 0.15148219236510982, 'f1-score': 0.22354755460439352, 'support': 140670}, '1': {'precision': 0.35057658479379766, 'recall': 0.1462188527485666, 'f1-score': 0.20636625119846594, 'support': 147204}, '2': {'precision': 0.35215659598274596, 'recall': 0.8022796891859598, 'f1-score': 0.48946501075810395, 'support': 138089}, 'accuracy': 0.36063930435272545, 'macro avg': {'precision': 0.3763783032251904, 'recall': 0.3666602447665454, 'f1-score': 0.3064596055203211, 'support': 425963}, 'weighted avg': {'precision': 0.3761292858179555, 'recall': 0.36063930435272545, 'f1-score': 0.3038153689832094, 'support': 425963}}
[[ 21309  23762  95599]
 [ 17472  21524 108208]
 [ 11193  16110 110786]]
Evaluating performance on  val set...
517/517 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1006192
{'0': {'precision': 0.40731219651528133, 'recall': 0.1269897811519024, 'f1-score': 0.19361517964732436, 'support': 44917}, '1': {'precision': 0.32981411804346605, 'recall': 0.14040833891173377, 'f1-score': 0.1969648696235432, 'support': 41828}, '2': {'precision': 0.3674687391022767, 'recall': 0.8118025137020977, 'f1-score': 0.5059260885072293, 'support': 45431}, 'accuracy': 0.3666172376225639, 'macro avg': {'precision': 0.36819835122034134, 'recall': 0.3597335445885779, 'f1-score': 0.2988353792593656, 'support': 132176}, 'weighted avg': {'precision': 0.36909256708142574, 'recall': 0.3666172376225639, 'f1-score': 0.3020214541051656, 'support': 132176}}
[[ 5704  6734 32479]
 [ 4950  5873 31005]
 [ 3350  5200 36881]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
8238/8238 - 117s - 117s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1085335
{'0': {'precision': 0.4068806859772038, 'recall': 0.04144790716563584, 'f1-score': 0.07523210947422354, 'support': 751015}, '1': {'precision': 0.2998698905787849, 'recall': 0.12496821614703926, 'f1-score': 0.1764164029006144, 'support': 593855}, '2': {'precision': 0.37439640594690726, 'recall': 0.8747794052188667, 'f1-score': 0.5243685674711702, 'support': 763844}, 'accuracy': 0.3668283133701393, 'macro avg': {'precision': 0.36038232750096527, 'recall': 0.3470651761771806, 'f1-score': 0.2586723599486694, 'support': 2108714}, 'weighted avg': {'precision': 0.3649775078806056, 'recall': 0.3668283133701393, 'f1-score': 0.266419244000266, 'support': 2108714}}
[[ 31128  97549 622338]
 [ 25449  74213 494193]
 [ 19927  75722 668195]]
Evaluating performance on  train set...
1806/1806 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1034687
{'0': {'precision': 0.40648197955890264, 'recall': 0.0971559715597156, 'f1-score': 0.15682754469891147, 'support': 155554}, '1': {'precision': 0.3366831226286568, 'recall': 0.15092790816795598, 'f1-score': 0.20842383048956883, 'support': 152278}, '2': {'precision': 0.352685579726396, 'recall': 0.8151959100893534, 'f1-score': 0.4923579055710682, 'support': 154331}, 'accuracy': 0.35464976642440005, 'macro avg': {'precision': 0.36528356063798517, 'recall': 0.354426596605675, 'f1-score': 0.28586976025318284, 'support': 462163}, 'weighted avg': {'precision': 0.3655196296560013, 'recall': 0.35464976642440005, 'f1-score': 0.28587230884357584, 'support': 462163}}
[[ 15113  25826 114615]
 [ 13000  22983 116295]
 [  9067  19454 125810]]
Evaluating performance on  val set...
642/642 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100249
{'0': {'precision': 0.39817463560822774, 'recall': 0.10680942027661557, 'f1-score': 0.16843621695598934, 'support': 54733}, '1': {'precision': 0.3413970365890535, 'recall': 0.14644677105531362, 'f1-score': 0.20496926628109033, 'support': 53965}, '2': {'precision': 0.36134586650433625, 'recall': 0.8217136487846972, 'f1-score': 0.5019575542926172, 'support': 55624}, 'accuracy': 0.36182617056754424, 'macro avg': {'precision': 0.36697251290053917, 'recall': 0.3583232800388754, 'f1-score': 0.2917876791765656, 'support': 164322}, 'weighted avg': {'precision': 0.3670615370352759, 'recall': 0.36182617056754424, 'f1-score': 0.2933330468073888, 'support': 164322}}
[[ 5846  8575 40312]
 [ 5590  7903 40472]
 [ 3246  6671 45707]]
testing model on single stock: results/universal/W5/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
31315/31315 - 437s - 437s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157147
{'0': {'precision': 0.45677687613171486, 'recall': 0.013577353137100833, 'f1-score': 0.026370852290381372, 'support': 3009865}, '1': {'precision': 0.25682660487917813, 'recall': 0.07342731183112028, 'f1-score': 0.11420356428071561, 'support': 1903556}, '2': {'precision': 0.391920993543226, 'recall': 0.9324554915865443, 'f1-score': 0.5518806575029558, 'support': 3103065}, 'accuracy': 0.38347338222757454, 'macro avg': {'precision': 0.36850815818470634, 'recall': 0.3398200521849218, 'f1-score': 0.23081835802468423, 'support': 8016486}, 'weighted avg': {'precision': 0.3841928838626779, 'recall': 0.38347338222757454, 'f1-score': 0.2506443768268715, 'support': 8016486}}
[[  40866  217718 2751281]
 [  25745  139773 1738038]
 [  22855  186740 2893470]]
Evaluating performance on  train set...
5759/5759 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044554
{'0': {'precision': 0.4506320197237115, 'recall': 0.04719378345369148, 'f1-score': 0.0854396450340757, 'support': 487988}, '1': {'precision': 0.35098569771936605, 'recall': 0.10629523441800094, 'f1-score': 0.16317368337255878, 'support': 486908}, '2': {'precision': 0.35131745122126173, 'recall': 0.8975857040995361, 'f1-score': 0.5049831453678918, 'support': 499276}, 'accuracy': 0.3547272638470952, 'macro avg': {'precision': 0.38431172288811305, 'recall': 0.35035824065707616, 'f1-score': 0.2511988245915087, 'support': 1474172}, 'weighted avg': {'precision': 0.3840834949531142, 'recall': 0.3547272638470952, 'f1-score': 0.25320658526356077, 'support': 1474172}}
[[ 23030  55266 409692]
 [ 17380  51756 417772]
 [ 10696  40437 448143]]
Evaluating performance on  val set...
2129/2129 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073592
{'0': {'precision': 0.3819024327455271, 'recall': 0.03215301671588416, 'f1-score': 0.05931241972482795, 'support': 184555}, '1': {'precision': 0.3484693079290023, 'recall': 0.11649261060841165, 'f1-score': 0.1746125769837191, 'support': 172071}, '2': {'precision': 0.3553008292380038, 'recall': 0.8903161740497254, 'f1-score': 0.5079090508381641, 'support': 188314}, 'accuracy': 0.35533820237090324, 'macro avg': {'precision': 0.361890856637511, 'recall': 0.34632060045800706, 'f1-score': 0.24727801584890372, 'support': 544940}, 'weighted avg': {'precision': 0.3621528720907395, 'recall': 0.35533820237090324, 'f1-score': 0.25074053906121624, 'support': 544940}}
[[  5934  20605 158016]
 [  5822  20045 146204]
 [  3782  16873 167659]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        87 (peak)  21.80 (ave)

============================================
