This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W9/deepLOB_L1/h300
Epoch 1/50
6697/6697 - 120s - loss: 3.2380 - accuracy300: 0.4023 - val_loss: 3.3672 - val_accuracy300: 0.3349 - 120s/epoch - 18ms/step
Epoch 2/50
6697/6697 - 106s - loss: 3.2195 - accuracy300: 0.4128 - val_loss: 3.4465 - val_accuracy300: 0.3350 - 106s/epoch - 16ms/step
Epoch 3/50
6697/6697 - 104s - loss: 3.2109 - accuracy300: 0.4169 - val_loss: 3.3235 - val_accuracy300: 0.3335 - 104s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 104s - loss: 3.2034 - accuracy300: 0.4214 - val_loss: 3.3369 - val_accuracy300: 0.3367 - 104s/epoch - 15ms/step
Epoch 5/50
6697/6697 - 104s - loss: 3.1980 - accuracy300: 0.4236 - val_loss: 3.3304 - val_accuracy300: 0.3366 - 104s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 103s - loss: 3.1924 - accuracy300: 0.4260 - val_loss: 3.3168 - val_accuracy300: 0.3361 - 103s/epoch - 15ms/step
Epoch 7/50
6697/6697 - 105s - loss: 3.1863 - accuracy300: 0.4287 - val_loss: 3.3364 - val_accuracy300: 0.3353 - 105s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 104s - loss: 3.1825 - accuracy300: 0.4304 - val_loss: 3.3210 - val_accuracy300: 0.3371 - 104s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 106s - loss: 3.1781 - accuracy300: 0.4325 - val_loss: 3.3467 - val_accuracy300: 0.3362 - 106s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 105s - loss: 3.1740 - accuracy300: 0.4343 - val_loss: 3.3519 - val_accuracy300: 0.3356 - 105s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 107s - loss: 3.1716 - accuracy300: 0.4352 - val_loss: 3.3408 - val_accuracy300: 0.3350 - 107s/epoch - 16ms/step
Epoch 12/50
6697/6697 - 105s - loss: 3.1686 - accuracy300: 0.4362 - val_loss: 3.3397 - val_accuracy300: 0.3369 - 105s/epoch - 16ms/step
Epoch 13/50
6697/6697 - 107s - loss: 3.1656 - accuracy300: 0.4374 - val_loss: 3.3404 - val_accuracy300: 0.3352 - 107s/epoch - 16ms/step
Epoch 14/50
6697/6697 - 105s - loss: 3.1645 - accuracy300: 0.4380 - val_loss: 3.3393 - val_accuracy300: 0.3364 - 105s/epoch - 16ms/step
Epoch 15/50
6697/6697 - 105s - loss: 3.1615 - accuracy300: 0.4392 - val_loss: 3.3599 - val_accuracy300: 0.3352 - 105s/epoch - 16ms/step
Epoch 16/50
6697/6697 - 108s - loss: 3.1592 - accuracy300: 0.4404 - val_loss: 3.3533 - val_accuracy300: 0.3349 - 108s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 107s - 107s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005335
{'0': {'precision': 0.31334741143970873, 'recall': 0.6426941130234248, 'f1-score': 0.42129244705457464, 'support': 1348570}, '1': {'precision': 0.373291336258078, 'recall': 0.21436558442772644, 'f1-score': 0.2723385453042375, 'support': 1604390}, '2': {'precision': 0.3166780846759569, 'recall': 0.1450142315550779, 'f1-score': 0.19893261154746011, 'support': 1354736}, 'accuracy': 0.3266479343017706, 'macro avg': {'precision': 0.3344389441245812, 'recall': 0.3340246430020764, 'f1-score': 0.29752120130209075, 'support': 4307696}, 'weighted avg': {'precision': 0.33672083808744, 'recall': 0.3266479343017706, 'f1-score': 0.29588456670628877, 'support': 4307696}}
[[ 866718  287050  194802]
 [1031357  343926  229107]
 [ 867922  290358  196456]]
Evaluating performance on  train set...
6697/6697 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071471
{'0': {'precision': 0.33384792674767483, 'recall': 0.6153804497828647, 'f1-score': 0.43286419243378205, 'support': 572454}, '1': {'precision': 0.3234842177065608, 'recall': 0.23556853476544615, 'f1-score': 0.2726136410130518, 'support': 565691}, '2': {'precision': 0.34140423084090193, 'recall': 0.14634980724481644, 'f1-score': 0.20487557036831755, 'support': 575860}, 'accuracy': 0.33244535459348135, 'macro avg': {'precision': 0.33291212509837914, 'recall': 0.3324329305977091, 'f1-score': 0.3034511346050505, 'support': 1714005}, 'weighted avg': {'precision': 0.3329662002322614, 'recall': 0.33244535459348135, 'f1-score': 0.3033769257184792, 'support': 1714005}}
[[352277 137426  82751]
 [352606 133259  79826]
 [350319 141264  84277]]
Evaluating performance on  val set...
2631/2631 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056541
{'0': {'precision': 0.3373120705944944, 'recall': 0.6511937807410162, 'f1-score': 0.44441926619502764, 'support': 225879}, '1': {'precision': 0.33841437926710327, 'recall': 0.21256317689530685, 'f1-score': 0.2611156652735409, 'support': 228525}, '2': {'precision': 0.3318035599399528, 'recall': 0.1416434744397246, 'f1-score': 0.19853460112150492, 'support': 218464}, 'accuracy': 0.33678373767217346, 'macro avg': {'precision': 0.33584333660051685, 'recall': 0.33513347735868254, 'f1-score': 0.30135651086335785, 'support': 672868}, 'weighted avg': {'precision': 0.33589796532834143, 'recall': 0.33678373767217346, 'f1-score': 0.3023313635585449, 'support': 672868}}
[[147091  47440  31348]
 [148981  48576  30968]
 [139996  47524  30944]]
testing model out of sample: results/universal/W9/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 57s - 57s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102708
{'0': {'precision': 0.33844070443919655, 'recall': 0.6553385563295314, 'f1-score': 0.44636319433506144, 'support': 745932}, '1': {'precision': 0.34849376454719916, 'recall': 0.22436752038828883, 'f1-score': 0.2729829502478618, 'support': 768088}, '2': {'precision': 0.3150393220886601, 'recall': 0.1230652286156847, 'f1-score': 0.1769914790131249, 'support': 697240}, 'accuracy': 0.33780649946184527, 'macro avg': {'precision': 0.33399126369168525, 'recall': 0.3342571017778349, 'f1-score': 0.29877920786534934, 'support': 2211260}, 'weighted avg': {'precision': 0.33455389556197157, 'recall': 0.33780649946184527, 'f1-score': 0.3012025077981929, 'support': 2211260}}
[[488838 164486  92608]
 [501802 172334  93952]
 [453743 157691  85806]]
Evaluating performance on  train set...
3947/3947 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066675
{'0': {'precision': 0.32773291949930283, 'recall': 0.6333639840210454, 'f1-score': 0.431952754875424, 'support': 328432}, '1': {'precision': 0.3439157301682047, 'recall': 0.2328227520226055, 'f1-score': 0.27766972114454513, 'support': 343987}, '2': {'precision': 0.33768099611245705, 'recall': 0.1422118347723181, 'f1-score': 0.20013732622910105, 'support': 337159}, 'accuracy': 0.33286482074688634, 'macro avg': {'precision': 0.33644321525998827, 'recall': 0.33613285693865635, 'f1-score': 0.3032532674163568, 'support': 1009578}, 'weighted avg': {'precision': 0.33656904712527924, 'recall': 0.33286482074688634, 'f1-score': 0.3019677353613801, 'support': 1009578}}
[[208017  74060  46355]
 [216210  80088  47689]
 [210488  78723  47948]]
Evaluating performance on  val set...
1402/1402 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024425
{'0': {'precision': 0.3262889488158492, 'recall': 0.6268048111199446, 'f1-score': 0.42916970298246687, 'support': 116979}, '1': {'precision': 0.3505365481045252, 'recall': 0.22823314241709583, 'f1-score': 0.27646250042511017, 'support': 124662}, '2': {'precision': 0.3245029317951754, 'recall': 0.1457105856725071, 'f1-score': 0.20111507001740078, 'support': 116601}, 'accuracy': 0.33152170878903087, 'macro avg': {'precision': 0.33377614290518326, 'recall': 0.3335828464031825, 'f1-score': 0.30224909114165927, 'support': 358242}, 'weighted avg': {'precision': 0.3341453778551504, 'recall': 0.33152170878903087, 'f1-score': 0.30180277352259094, 'support': 358242}}
[[73323 26351 17305]
 [78148 28452 18062]
 [73247 26364 16990]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989033
{'0': {'precision': 0.35113718225789853, 'recall': 0.6444058321371912, 'f1-score': 0.4545757337561119, 'support': 26474}, '1': {'precision': 0.3402804092459265, 'recall': 0.20839296074260297, 'f1-score': 0.2584854517978364, 'support': 25855}, '2': {'precision': 0.312186216339571, 'recall': 0.14840529399001953, 'f1-score': 0.2011764705882353, 'support': 23045}, 'accuracy': 0.3431952662721893, 'macro avg': {'precision': 0.3345346026144653, 'recall': 0.3337346956232712, 'f1-score': 0.30474588538072783, 'support': 75374}, 'weighted avg': {'precision': 0.3355041141467143, 'recall': 0.3431952662721893, 'f1-score': 0.30983749166023095, 'support': 75374}}
[[17060  5569  3845]
 [16777  5388  3690]
 [14748  4877  3420]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1200382
{'0': {'precision': 0.3308268281025968, 'recall': 0.6118444313494402, 'f1-score': 0.42944886774894014, 'support': 16970}, '1': {'precision': 0.3298166042200749, 'recall': 0.1983279971540377, 'f1-score': 0.2477043838862559, 'support': 16866}, '2': {'precision': 0.333263903353468, 'recall': 0.1850459723587579, 'f1-score': 0.23796244655140364, 'support': 17293}, 'accuracy': 0.3310841205578048, 'macro avg': {'precision': 0.33130244522537994, 'recall': 0.3317394669540786, 'f1-score': 0.30503856606219987, 'support': 51129}, 'weighted avg': {'precision': 0.3313178587566425, 'recall': 0.3310841205578048, 'f1-score': 0.3047314442398351, 'support': 51129}}
[[10383  3182  3405]
 [10524  3345  2997]
 [10478  3615  3200]]
Evaluating performance on  val set...
53/53 - 1s - 520ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098396
{'0': {'precision': 0.31314977721923914, 'recall': 0.6535526943252266, 'f1-score': 0.42341855256043875, 'support': 4194}, '1': {'precision': 0.4179913294797688, 'recall': 0.21425925925925926, 'f1-score': 0.2833006856023506, 'support': 5400}, '2': {'precision': 0.26952526799387444, 'recall': 0.13587236232629954, 'f1-score': 0.18066723695466214, 'support': 3886}, 'accuracy': 0.3283382789317507, 'macro avg': {'precision': 0.3335554582309608, 'recall': 0.33456143863692844, 'f1-score': 0.29579549170581715, 'support': 13480}, 'weighted avg': {'precision': 0.3425725917116051, 'recall': 0.3283382789317507, 'f1-score': 0.2973081598291536, 'support': 13480}}
[[2741  823  630]
 [3442 1157  801]
 [2570  788  528]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001754
{'0': {'precision': 0.30377575612827584, 'recall': 0.6451850912486599, 'f1-score': 0.4130657012425775, 'support': 86741}, '1': {'precision': 0.38764394137660296, 'recall': 0.21356992231854802, 'f1-score': 0.2754064450151654, 'support': 110966}, '2': {'precision': 0.310445419557277, 'recall': 0.1431769361221029, 'f1-score': 0.1959719288472103, 'support': 88450}, 'accuracy': 0.3226445622507924, 'macro avg': {'precision': 0.3339550390207186, 'recall': 0.33397731656310353, 'f1-score': 0.2948146917016511, 'support': 286157}, 'weighted avg': {'precision': 0.338359738957845, 'recall': 0.3226445622507924, 'f1-score': 0.2925813475664443, 'support': 286157}}
[[55964 18446 12331]
 [71469 23699 15798]
 [56795 18991 12664]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135631
{'0': {'precision': 0.33777295957875175, 'recall': 0.6053989035645717, 'f1-score': 0.43361636913391044, 'support': 43231}, '1': {'precision': 0.3694340806862164, 'recall': 0.22602666666666665, 'f1-score': 0.2804616565635175, 'support': 46875}, '2': {'precision': 0.31946733755530493, 'recall': 0.18831019406305133, 'f1-score': 0.236950052280222, 'support': 39111}, 'accuracy': 0.341534008683068, 'macro avg': {'precision': 0.3422247926067577, 'recall': 0.3399119214314299, 'f1-score': 0.3170093593258833, 'support': 129217}, 'weighted avg': {'precision': 0.3437177181550488, 'recall': 0.341534008683068, 'f1-score': 0.3185313302442769, 'support': 129217}}
[[26172  9065  7994]
 [28585 10595  7695]
 [22727  9019  7365]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074985
{'0': {'precision': 0.3252809639670953, 'recall': 0.7248902659437129, 'f1-score': 0.4490563019833653, 'support': 15492}, '1': {'precision': 0.34990419416648927, 'recall': 0.18950706255405017, 'f1-score': 0.24585810987695877, 'support': 17345}, '2': {'precision': 0.40025673940949935, 'recall': 0.10409989316239317, 'f1-score': 0.16522706798791797, 'support': 14976}, 'accuracy': 0.3362265492648443, 'macro avg': {'precision': 0.3584806325143613, 'recall': 0.33949907388671874, 'f1-score': 0.2867138266160807, 'support': 47813}, 'weighted avg': {'precision': 0.35769740177342274, 'recall': 0.3362265492648443, 'f1-score': 0.2864415476194593, 'support': 47813}}
[[11230  2960  1302]
 [13024  3287  1034]
 [10270  3147  1559]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1251181
{'0': {'precision': 0.3053083137466446, 'recall': 0.5847292942710255, 'f1-score': 0.401157688672877, 'support': 40653}, '1': {'precision': 0.37139252483835355, 'recall': 0.2545065490857217, 'f1-score': 0.3020353721255338, 'support': 46266}, '2': {'precision': 0.3446169007144617, 'recall': 0.16287843502561714, 'f1-score': 0.22120661026330354, 'support': 42940}, 'accuracy': 0.32758607412655266, 'macro avg': {'precision': 0.3404392464331533, 'recall': 0.3340380927941214, 'f1-score': 0.3081332236872381, 'support': 129859}, 'weighted avg': {'precision': 0.34185073926021753, 'recall': 0.32758607412655266, 'f1-score': 0.30633875117692777, 'support': 129859}}
[[23771  9593  7289]
 [28479 11775  6012]
 [25609 10337  6994]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1116166
{'0': {'precision': 0.33499319916084563, 'recall': 0.6507680594742263, 'f1-score': 0.44230359480108367, 'support': 22329}, '1': {'precision': 0.32933777284498705, 'recall': 0.20123881001898905, 'f1-score': 0.24982460079140117, 'support': 22118}, '2': {'precision': 0.3503496503496504, 'recall': 0.15617902471609887, 'f1-score': 0.21604805174803635, 'support': 22455}, 'accuracy': 0.33614839616154973, 'macro avg': {'precision': 0.33822687411849434, 'recall': 0.33606196473643807, 'f1-score': 0.3027254157801737, 'support': 66902}, 'weighted avg': {'precision': 0.3382777406123785, 'recall': 0.33614839616154973, 'f1-score': 0.30272901394008794, 'support': 66902}}
[[14531  4386  3412]
 [14576  4451  3091]
 [14270  4678  3507]]
Evaluating performance on  val set...
73/73 - 1s - 603ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1083822
{'0': {'precision': 0.34981458590852904, 'recall': 0.7007118539151965, 'f1-score': 0.4666597959394002, 'support': 6462}, '1': {'precision': 0.3188837713356814, 'recall': 0.1911645281793081, 'f1-score': 0.23903330625507715, 'support': 6157}, '2': {'precision': 0.3328380386329866, 'recall': 0.11135045567522783, 'f1-score': 0.16687360317854483, 'support': 6035}, 'accuracy': 0.3418569743754691, 'macro avg': {'precision': 0.333845465292399, 'recall': 0.33440894592324416, 'f1-score': 0.2908555684576741, 'support': 18654}, 'weighted avg': {'precision': 0.33411315521629564, 'recall': 0.3418569743754691, 'f1-score': 0.2945408954195043, 'support': 18654}}
[[4528 1268  666]
 [4299 1177  681]
 [4117 1246  672]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011167
{'0': {'precision': 0.3008107917083169, 'recall': 0.6409776458185417, 'f1-score': 0.40946137247625725, 'support': 46479}, '1': {'precision': 0.37589304878422714, 'recall': 0.20812182741116753, 'f1-score': 0.26790943660125005, 'support': 58903}, '2': {'precision': 0.3163884007029877, 'recall': 0.14686926371609219, 'f1-score': 0.20061289873241397, 'support': 49030}, 'accuracy': 0.31896484729166125, 'macro avg': {'precision': 0.33103074706517727, 'recall': 0.3319895789819338, 'f1-score': 0.2926612359366404, 'support': 154412}, 'weighted avg': {'precision': 0.33439846855694944, 'recall': 0.31896484729166125, 'f1-score': 0.28914899813678757, 'support': 154412}}
[[29792  9812  6875]
 [37960 12259  8684]
 [31287 10542  7201]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103774
{'0': {'precision': 0.3514383460859329, 'recall': 0.6638293437098287, 'f1-score': 0.45957354692066243, 'support': 28783}, '1': {'precision': 0.33055379837828514, 'recall': 0.21121481590357905, 'f1-score': 0.257740510727978, 'support': 27214}, '2': {'precision': 0.3393086964515536, 'recall': 0.13856145356257976, 'f1-score': 0.19676937839854994, 'support': 26638}, 'accuracy': 0.34544684455739094, 'macro avg': {'precision': 0.3404336136385906, 'recall': 0.33786853772532915, 'f1-score': 0.3046944786823968, 'support': 82635}, 'weighted avg': {'precision': 0.34065040286240145, 'recall': 0.34544684455739094, 'f1-score': 0.3083874673171077, 'support': 82635}}
[[19107  6040  3636]
 [17915  5748  3551]
 [17346  5601  3691]]
Evaluating performance on  val set...
112/112 - 1s - 823ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1147995
{'0': {'precision': 0.3564344815445103, 'recall': 0.6127925746569814, 'f1-score': 0.4507104960486773, 'support': 9912}, '1': {'precision': 0.2989259056981613, 'recall': 0.18895281933256616, 'f1-score': 0.2315448071635056, 'support': 8690}, '2': {'precision': 0.34649271433412404, 'recall': 0.20795200325401667, 'f1-score': 0.25991357397051346, 'support': 9834}, 'accuracy': 0.3432620621747081, 'macro avg': {'precision': 0.33395103385893193, 'recall': 0.3365657990811881, 'f1-score': 0.3140562923942321, 'support': 28436}, 'weighted avg': {'precision': 0.33542179119243154, 'recall': 0.3432620621747081, 'f1-score': 0.31775062939623655, 'support': 28436}}
[[6074 1885 1953]
 [5144 1642 1904]
 [5823 1966 2045]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1082915
{'0': {'precision': 0.3684122469466287, 'recall': 0.7007570682031354, 'f1-score': 0.4829309678126822, 'support': 59704}, '1': {'precision': 0.3060188906752412, 'recall': 0.2545234215034892, 'f1-score': 0.2779057830500742, 'support': 47862}, '2': {'precision': 0.3178782915459242, 'recall': 0.046946522273082505, 'f1-score': 0.08181066489404822, 'support': 53742}, 'accuracy': 0.3505281821112406, 'macro avg': {'precision': 0.330769809722598, 'recall': 0.3340756706599024, 'f1-score': 0.28088247191893484, 'support': 161308}, 'weighted avg': {'precision': 0.33306330796650496, 'recall': 0.3505281821112406, 'f1-score': 0.2884587611486533, 'support': 161308}}
[[41838 14549  3317]
 [33583 12182  2097]
 [38142 13077  2523]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1092776
{'0': {'precision': 0.3250865717583686, 'recall': 0.636060225846926, 'f1-score': 0.43026650823289764, 'support': 39850}, '1': {'precision': 0.3159954862825305, 'recall': 0.22234628554414174, 'f1-score': 0.26102534226623947, 'support': 40302}, '2': {'precision': 0.35627763891559316, 'recall': 0.13305727757964528, 'f1-score': 0.1937541389285839, 'support': 41779}, 'accuracy': 0.3269636105666319, 'macro avg': {'precision': 0.3324532323188308, 'recall': 0.3304879296569043, 'f1-score': 0.29501532980924033, 'support': 121931}, 'weighted avg': {'precision': 0.3327691354043197, 'recall': 0.3269636105666319, 'f1-score': 0.29328733355251957, 'support': 121931}}
[[25347  9318  5185]
 [26482  8961  4859]
 [26141 10079  5559]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032424
{'0': {'precision': 0.32945357965863376, 'recall': 0.5439128191900955, 'f1-score': 0.4103524604120552, 'support': 15508}, '1': {'precision': 0.352907761130441, 'recall': 0.30066545674531153, 'f1-score': 0.32469865743311666, 'support': 16530}, '2': {'precision': 0.31603839198775907, 'recall': 0.1531306867965222, 'f1-score': 0.20630164351221283, 'support': 14837}, 'accuracy': 0.33444266666666667, 'macro avg': {'precision': 0.3327999109256113, 'recall': 0.3325696542439764, 'f1-score': 0.3137842537857949, 'support': 46875}, 'weighted avg': {'precision': 0.3334782512374328, 'recall': 0.33444266666666667, 'f1-score': 0.31556079462891246, 'support': 46875}}
[[8435 4653 2420]
 [9063 4970 2497]
 [8105 4460 2272]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014658
{'0': {'precision': 0.3278407757879096, 'recall': 0.6389097744360902, 'f1-score': 0.43332931346369197, 'support': 196840}, '1': {'precision': 0.3473221608405676, 'recall': 0.21396568160152526, 'f1-score': 0.26480182630085597, 'support': 209800}, '2': {'precision': 0.3294238545227085, 'recall': 0.15066771566654066, 'f1-score': 0.2067669700071512, 'support': 195742}, 'accuracy': 0.33225594390270624, 'macro avg': {'precision': 0.3348622637170619, 'recall': 0.33451439056805204, 'f1-score': 0.30163270325723307, 'support': 602382}, 'weighted avg': {'precision': 0.3351402461933245, 'recall': 0.33225594390270624, 'f1-score': 0.3010132199555307, 'support': 602382}}
[[125763  42005  29072]
 [133948  44890  30962]
 [123899  42351  29492]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1061041
{'0': {'precision': 0.3379927439857413, 'recall': 0.7023368614991258, 'f1-score': 0.4563645247984364, 'support': 106382}, '1': {'precision': 0.32597474421605677, 'recall': 0.20177248652092467, 'f1-score': 0.24925847395408116, 'support': 105163}, '2': {'precision': 0.35331062064879276, 'recall': 0.1100570310625496, 'f1-score': 0.16783354559975233, 'support': 108362}, 'accuracy': 0.337163613175079, 'macro avg': {'precision': 0.33909270295019694, 'recall': 0.3380554596942, 'f1-score': 0.29115218145075666, 'support': 319907}, 'weighted avg': {'precision': 0.3392306876418109, 'recall': 0.337163613175079, 'f1-score': 0.29054856080617386, 'support': 319907}}
[[74716 20637 11029]
 [73144 21219 10800]
 [73198 23238 11926]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1072519
{'0': {'precision': 0.34338576194809134, 'recall': 0.7415551604753439, 'f1-score': 0.46940709589527924, 'support': 42748}, '1': {'precision': 0.33040091036414565, 'recall': 0.17764860921541864, 'f1-score': 0.23106118576107254, 'support': 42494}, '2': {'precision': 0.34596246180707113, 'recall': 0.0957778475964908, 'f1-score': 0.15002271350696547, 'support': 41377}, 'accuracy': 0.34127579589161183, 'macro avg': {'precision': 0.3399163780397694, 'recall': 0.33832720576241776, 'f1-score': 0.2834969983877724, 'support': 126619}, 'weighted avg': {'precision': 0.33987000070259754, 'recall': 0.34127579589161183, 'f1-score': 0.28504741294624125, 'support': 126619}}
[[31700  7347  3701]
 [31154  7549  3791]
 [29462  7952  3963]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
3870/3870 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009442
{'0': {'precision': 0.35226724105915996, 'recall': 0.6568829999653744, 'f1-score': 0.45860041981764926, 'support': 346564}, '1': {'precision': 0.3223922609772481, 'recall': 0.21986350462775406, 'f1-score': 0.26143490529506475, 'support': 320890}, '2': {'precision': 0.32891227679104534, 'recall': 0.12781366398138866, 'f1-score': 0.1840906306045382, 'support': 323244}, 'accuracy': 0.3427068592043186, 'macro avg': {'precision': 0.3345239262758178, 'recall': 0.33485338952483906, 'f1-score': 0.30137531857241745, 'support': 990698}, 'weighted avg': {'precision': 0.3349704115224423, 'recall': 0.3427068592043186, 'f1-score': 0.3051711363634029, 'support': 990698}}
[[227652  75546  43366]
 [209408  70552  40930]
 [209188  72741  41315]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062441
{'0': {'precision': 0.32414080720393884, 'recall': 0.619203786923666, 'f1-score': 0.4255268256512067, 'support': 129287}, '1': {'precision': 0.36932068921556127, 'recall': 0.2547624201753437, 'f1-score': 0.30152725234692446, 'support': 147824}, '2': {'precision': 0.31821930612319704, 'recall': 0.13736659309013521, 'f1-score': 0.19189664128380546, 'support': 126399}, 'accuracy': 0.33475750291194767, 'macro avg': {'precision': 0.33722693418089905, 'recall': 0.3371109333963816, 'f1-score': 0.3063169064273122, 'support': 403510}, 'weighted avg': {'precision': 0.3388373427628628, 'recall': 0.33475750291194767, 'f1-score': 0.3069158008984438, 'support': 403510}}
[[80055 31675 17557]
 [90521 37660 19643]
 [76400 32636 17363]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101579
{'0': {'precision': 0.3115638970724572, 'recall': 0.6358342618091615, 'f1-score': 0.4182043180985433, 'support': 47569}, '1': {'precision': 0.37630360077693115, 'recall': 0.22103452512593685, 'f1-score': 0.2784891306751587, 'support': 56973}, '2': {'precision': 0.3216047496398481, 'recall': 0.15062975382350535, 'f1-score': 0.20516605166051663, 'support': 48908}, 'accuracy': 0.32718149234278265, 'macro avg': {'precision': 0.3364907491630788, 'recall': 0.3358328469195346, 'f1-score': 0.30061983347807286, 'support': 153450}, 'weighted avg': {'precision': 0.3388007374538254, 'recall': 0.32718149234278265, 'f1-score': 0.2984306530087844, 'support': 153450}}
[[30246 10212  7111]
 [35951 12593  8429]
 [30881 10660  7367]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
2451/2451 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1013038
{'0': {'precision': 0.3373837184539722, 'recall': 0.6379744076862217, 'f1-score': 0.44136030074497967, 'support': 211079}, '1': {'precision': 0.33960487071961964, 'recall': 0.21280323008248514, 'f1-score': 0.26165080973991567, 'support': 213493}, '2': {'precision': 0.32247439712781845, 'recall': 0.1501659523891719, 'f1-score': 0.2049113031306361, 'support': 202769}, 'accuracy': 0.33561332672342475, 'macro avg': {'precision': 0.33315432876713674, 'recall': 0.3336478633859596, 'f1-score': 0.30264080453851044, 'support': 627341}, 'weighted avg': {'precision': 0.3333206208478329, 'recall': 0.33561332672342475, 'f1-score': 0.30377763810949593, 'support': 627341}}
[[134663  44796  31620]
 [135707  45432  32354]
 [128769  43551  30449]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1150179
{'0': {'precision': 0.344289169141874, 'recall': 0.5994574023135762, 'f1-score': 0.43737735790699994, 'support': 106156}, '1': {'precision': 0.3170031128508637, 'recall': 0.24435656615587412, 'f1-score': 0.27597918059957544, 'support': 97104}, '2': {'precision': 0.35401198110023624, 'recall': 0.16163610447646198, 'f1-score': 0.22193864057127743, 'support': 103832}, 'accuracy': 0.33913941099084316, 'macro avg': {'precision': 0.3384347543643247, 'recall': 0.3351500243153041, 'f1-score': 0.31176505969261764, 'support': 307092}, 'weighted avg': {'precision': 0.3389485995444192, 'recall': 0.33913941099084316, 'f1-score': 0.313499687672468, 'support': 307092}}
[[63636 25689 16831]
 [59582 23728 13794]
 [61615 25434 16783]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113877
{'0': {'precision': 0.34672220094472106, 'recall': 0.5556635380169305, 'f1-score': 0.4270033901636122, 'support': 39101}, '1': {'precision': 0.3335758698240508, 'recall': 0.27050367430134636, 'f1-score': 0.2987470750273985, 'support': 37286}, '2': {'precision': 0.3286780276293234, 'recall': 0.17935455470877926, 'f1-score': 0.23207134084476957, 'support': 36347}, 'accuracy': 0.34002164386964, 'macro avg': {'precision': 0.33632536613269837, 'recall': 0.335173922342352, 'f1-score': 0.3192739353452601, 'support': 112734}, 'weighted avg': {'precision': 0.3365564508634672, 'recall': 0.34002164386964, 'f1-score': 0.3217347031414109, 'support': 112734}}
[[21727 10203  7171]
 [21056 10086  6144]
 [19881  9947  6519]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004274
{'0': {'precision': 0.32024698613838676, 'recall': 0.6557861868296782, 'f1-score': 0.43034100827689986, 'support': 272537}, '1': {'precision': 0.38601810795741176, 'recall': 0.22215668597099766, 'f1-score': 0.28201268597365814, 'support': 327215}, '2': {'precision': 0.2942630414986341, 'recall': 0.12454526505393894, 'f1-score': 0.17501595802004494, 'support': 254269}, 'accuracy': 0.3314754555215855, 'macro avg': {'precision': 0.33350937853147755, 'recall': 0.33416271261820496, 'f1-score': 0.29578988409020096, 'support': 854021}, 'weighted avg': {'precision': 0.33771070893490696, 'recall': 0.3314754555215855, 'f1-score': 0.2974912338729736, 'support': 854021}}
[[178726  58937  34874]
 [213446  72693  41076]
 [165916  56685  31668]]
Evaluating performance on  train set...
1431/1431 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037868
{'0': {'precision': 0.3278245102993193, 'recall': 0.6433797793259776, 'f1-score': 0.4343384051060909, 'support': 119996}, '1': {'precision': 0.3173622107575216, 'recall': 0.21263379450191228, 'f1-score': 0.2546507159873965, 'support': 116877}, '2': {'precision': 0.35143507275751956, 'recall': 0.14221599746194857, 'f1-score': 0.20248994656530603, 'support': 129233}, 'accuracy': 0.32895937242219464, 'macro avg': {'precision': 0.33220726460478683, 'recall': 0.3327431904299461, 'f1-score': 0.29715968921959784, 'support': 366106}, 'weighted avg': {'precision': 0.33281886066400584, 'recall': 0.32895937242219464, 'f1-score': 0.29513328450242177, 'support': 366106}}
[[77203 25692 17101]
 [75208 24852 16817]
 [83090 27764 18379]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023585
{'0': {'precision': 0.3446589800665283, 'recall': 0.6373074966470887, 'f1-score': 0.44737525565691655, 'support': 43246}, '1': {'precision': 0.3166747654468658, 'recall': 0.21392858946517854, 'f1-score': 0.25535377891643435, 'support': 39602}, '2': {'precision': 0.3454678976080571, 'recall': 0.1533946663561197, 'f1-score': 0.21245503959741285, 'support': 42935}, 'accuracy': 0.33882957156372484, 'macro avg': {'precision': 0.33560054770715037, 'recall': 0.33487691748946236, 'f1-score': 0.30506135805692125, 'support': 125783}, 'weighted avg': {'precision': 0.3361244404807151, 'recall': 0.33882957156372484, 'f1-score': 0.3067303831511617, 'support': 125783}}
[[27561  9124  6561]
 [25213  8472  5917]
 [27192  9157  6586]]
testing model on single stock: results/universal/W9/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
10303/10303 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001723
{'0': {'precision': 0.30588842355933615, 'recall': 0.6446148339610444, 'f1-score': 0.41489645364856453, 'support': 807431}, '1': {'precision': 0.38437268891691007, 'recall': 0.21432555269434786, 'f1-score': 0.2752000365694085, 'support': 1011228}, '2': {'precision': 0.31156737983295835, 'recall': 0.14156300191146207, 'f1-score': 0.19467427197022374, 'support': 818745}, 'accuracy': 0.32346883526376696, 'macro avg': {'precision': 0.3339428307697349, 'recall': 0.3335011295222847, 'f1-score': 0.2949235873960656, 'support': 2637404}, 'weighted avg': {'precision': 0.33774365079917334, 'recall': 0.32346883526376696, 'f1-score': 0.29296946082215114, 'support': 2637404}}
[[520482 172249 114700]
 [653097 216732 141399]
 [527963 174878 115904]]
Evaluating performance on  train set...
3419/3419 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042155
{'0': {'precision': 0.32571535642743865, 'recall': 0.5856715132232496, 'f1-score': 0.418619604980753, 'support': 287902}, '1': {'precision': 0.317943922748645, 'recall': 0.24796516149100523, 'f1-score': 0.2786278515227539, 'support': 289335}, '2': {'precision': 0.3391846580995585, 'recall': 0.15008206983824354, 'f1-score': 0.2080890959396285, 'support': 297917}, 'accuracy': 0.32574038397813415, 'macro avg': {'precision': 0.3276146457585474, 'recall': 0.32790624818416614, 'f1-score': 0.30177885081437844, 'support': 875154}, 'weighted avg': {'precision': 0.32773121441677444, 'recall': 0.32574038397813415, 'f1-score': 0.3006687852978459, 'support': 875154}}
[[168616  75773  43513]
 [173993  71745  43597]
 [175070  78135  44712]]
Evaluating performance on  val set...
1396/1396 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011147
{'0': {'precision': 0.3324866450193778, 'recall': 0.642203226948561, 'f1-score': 0.4381373039562449, 'support': 118626}, '1': {'precision': 0.34512575512299126, 'recall': 0.21369896503952407, 'f1-score': 0.2639576025084176, 'support': 122710}, '2': {'precision': 0.3291025173993903, 'recall': 0.14806348658673338, 'f1-score': 0.20423947122621025, 'support': 115930}, 'accuracy': 0.33468060212838613, 'macro avg': {'precision': 0.33557163918058647, 'recall': 0.3346552261916062, 'f1-score': 0.30211145923029087, 'support': 357266}, 'weighted avg': {'precision': 0.33572967202398857, 'recall': 0.33468060212838613, 'f1-score': 0.30241387403832437, 'support': 357266}}
[[76182 25318 17126]
 [78621 26223 17866]
 [74325 24440 17165]]
training model: results/universal/W9/deepLOB_L1/h500
Epoch 1/50
6697/6697 - 107s - loss: 3.2248 - accuracy500: 0.4117 - val_loss: 3.3574 - val_accuracy500: 0.3368 - 107s/epoch - 16ms/step
Epoch 2/50
6697/6697 - 105s - loss: 3.1997 - accuracy500: 0.4252 - val_loss: 3.3576 - val_accuracy500: 0.3378 - 105s/epoch - 16ms/step
Epoch 3/50
6697/6697 - 105s - loss: 3.1861 - accuracy500: 0.4319 - val_loss: 3.3307 - val_accuracy500: 0.3365 - 105s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 108s - loss: 3.1733 - accuracy500: 0.4375 - val_loss: 3.3535 - val_accuracy500: 0.3362 - 108s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 108s - loss: 3.1672 - accuracy500: 0.4407 - val_loss: 3.3440 - val_accuracy500: 0.3357 - 108s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 107s - loss: 3.1626 - accuracy500: 0.4423 - val_loss: 3.3810 - val_accuracy500: 0.3361 - 107s/epoch - 16ms/step
Epoch 7/50
6697/6697 - 108s - loss: 3.1572 - accuracy500: 0.4441 - val_loss: 3.3945 - val_accuracy500: 0.3364 - 108s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 109s - loss: 3.1522 - accuracy500: 0.4451 - val_loss: 3.4622 - val_accuracy500: 0.3332 - 109s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 108s - loss: 3.1473 - accuracy500: 0.4469 - val_loss: 3.4005 - val_accuracy500: 0.3350 - 108s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 110s - loss: 3.1446 - accuracy500: 0.4479 - val_loss: 3.4056 - val_accuracy500: 0.3354 - 110s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 108s - loss: 3.1410 - accuracy500: 0.4494 - val_loss: 3.5039 - val_accuracy500: 0.3324 - 108s/epoch - 16ms/step
Epoch 12/50
6697/6697 - 108s - loss: 3.1370 - accuracy500: 0.4507 - val_loss: 3.5473 - val_accuracy500: 0.3345 - 108s/epoch - 16ms/step
Epoch 13/50
6697/6697 - 111s - loss: 3.1351 - accuracy500: 0.4513 - val_loss: 3.6931 - val_accuracy500: 0.3314 - 111s/epoch - 17ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 110s - 110s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097878
{'0': {'precision': 0.314892004547177, 'recall': 0.01355424031530179, 'f1-score': 0.02598977439846581, 'support': 1348803}, '1': {'precision': 0.3695355255686374, 'recall': 0.9846355297327287, 'f1-score': 0.5373882517262375, 'support': 1591529}, '2': {'precision': 0.32025852462669935, 'recall': 0.0021018543708917303, 'f1-score': 0.004176299717075311, 'support': 1367364}, 'accuracy': 0.36869639826023004, 'macro avg': {'precision': 0.3348953515808379, 'recall': 0.33343054147297413, 'f1-score': 0.18918477528059288, 'support': 4307696}, 'weighted avg': {'precision': 0.33678415634474573, 'recall': 0.36869639826023004, 'f1-score': 0.20800785256107207, 'support': 4307696}}
[[  18282 1327758    2763]
 [  21116 1567076    3337]
 [  18660 1345830    2874]]
Evaluating performance on  train set...
6697/6697 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095154
{'0': {'precision': 0.3503253578936831, 'recall': 0.12169265250269073, 'f1-score': 0.18063726850268616, 'support': 575121}, '1': {'precision': 0.33150428136866467, 'recall': 0.8578635373390527, 'f1-score': 0.4782127630911627, 'support': 562762}, '2': {'precision': 0.36182336182336183, 'recall': 0.036372504434824565, 'f1-score': 0.06610024336119186, 'support': 576122}, 'accuracy': 0.3347224774723528, 'macro avg': {'precision': 0.3478843336952366, 'recall': 0.3386428980921894, 'f1-score': 0.24165009165168025, 'support': 1714005}, 'weighted avg': {'precision': 0.3480105842218455, 'recall': 0.3347224774723528, 'f1-score': 0.23984181019715745, 'support': 1714005}}
[[ 69988 484568  20565]
 [ 63594 482773  16395]
 [ 66198 488969  20955]]
Evaluating performance on  val set...
2631/2631 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105858
{'0': {'precision': 0.3366966440008774, 'recall': 0.13510777815918953, 'f1-score': 0.19283556214392944, 'support': 227226}, '1': {'precision': 0.33556947298066686, 'recall': 0.8418045766448288, 'f1-score': 0.4798541605826497, 'support': 225449}, '2': {'precision': 0.35988840669559824, 'recall': 0.026363235888515985, 'f1-score': 0.04912767695061421, 'support': 220193}, 'accuracy': 0.3363051891307062, 'macro avg': {'precision': 0.34405150789238087, 'recall': 0.33442519689751143, 'f1-score': 0.24060579989239775, 'support': 672868}, 'weighted avg': {'precision': 0.34390837679795383, 'recall': 0.3363051891307062, 'f1-score': 0.24197534236091017, 'support': 672868}}
[[ 30700 190529   5997]
 [ 31337 189784   4328]
 [ 29143 185245   5805]]
testing model out of sample: results/universal/W9/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0934583
{'0': {'precision': 0.31161367708238435, 'recall': 0.06024036267202045, 'f1-score': 0.1009628451712005, 'support': 681387}, '1': {'precision': 0.4109358629120275, 'recall': 0.9429584459895859, 'f1-score': 0.5724160891218785, 'support': 898012}, '2': {'precision': 0.37226895201819815, 'recall': 0.01113694309349683, 'f1-score': 0.021626887781131105, 'support': 631861}, 'accuracy': 0.4046887295026365, 'macro avg': {'precision': 0.36493949733753667, 'recall': 0.3381119172517011, 'f1-score': 0.23166860735807002, 'support': 2211260}, 'weighted avg': {'precision': 0.36928134954852027, 'recall': 0.4046887295026365, 'f1-score': 0.2697541103929245, 'support': 2211260}}
[[ 41047 633437   6903]
 [ 46261 846788   4963]
 [ 44416 580408   7037]]
Evaluating performance on  train set...
3947/3947 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104918
{'0': {'precision': 0.34319896073554146, 'recall': 0.10215214915172952, 'f1-score': 0.15744211992488238, 'support': 333620}, '1': {'precision': 0.329296153124074, 'recall': 0.8785874429313305, 'f1-score': 0.47904527569581046, 'support': 331399}, '2': {'precision': 0.3377813566471107, 'recall': 0.02556601336781219, 'f1-score': 0.04753425174968568, 'support': 344559}, 'accuracy': 0.33088280449851326, 'macro avg': {'precision': 0.33675882350224207, 'recall': 0.33543520181695746, 'f1-score': 0.2280072157901262, 'support': 1009578}, 'weighted avg': {'precision': 0.33678632021966415, 'recall': 0.33088280449851326, 'f1-score': 0.22549948554571822, 'support': 1009578}}
[[ 34080 290045   9495]
 [ 32461 291163   7775]
 [ 32760 302990   8809]]
Evaluating performance on  val set...
1402/1402 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027924
{'0': {'precision': 0.32094097878596933, 'recall': 0.026118765170421523, 'f1-score': 0.04830627697074119, 'support': 117004}, '1': {'precision': 0.34526215635676905, 'recall': 0.9665829896116686, 'f1-score': 0.5087864651048172, 'support': 123889}, '2': {'precision': 0.31140583554376655, 'recall': 0.00500217300530895, 'f1-score': 0.009846184813056677, 'support': 117349}, 'accuracy': 0.34443755896851846, 'macro avg': {'precision': 0.3258696568955017, 'recall': 0.332567975929133, 'f1-score': 0.188979642296205, 'support': 358242}, 'weighted avg': {'precision': 0.3262284292907665, 'recall': 0.34443755896851846, 'f1-score': 0.19495345031482259, 'support': 358242}}
[[  3056 113330    618]
 [  3460 119749    680]
 [  3006 113756    587]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108071
{'0': {'precision': 0.3733459357277883, 'recall': 0.01354223806911684, 'f1-score': 0.0261364388274995, 'support': 29168}, '1': {'precision': 0.2882247427407717, 'recall': 0.9836148570902563, 'f1-score': 0.4458142979327034, 'support': 21727}, '2': {'precision': 0.2958579881656805, 'recall': 0.00204256709832918, 'f1-score': 0.004057124310288867, 'support': 24479}, 'accuracy': 0.28943667577679305, 'macro avg': {'precision': 0.3191428888780801, 'recall': 0.33306655408590075, 'f1-score': 0.15866928702349725, 'support': 75374}, 'weighted avg': {'precision': 0.3236437091191202, 'recall': 0.28943667577679305, 'f1-score': 0.1399404203690386, 'support': 75374}}
[[  395 28703    70]
 [  307 21371    49]
 [  356 24073    50]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.117462
{'0': {'precision': 0.35250030716304215, 'recall': 0.1722812706419264, 'f1-score': 0.23144562762181353, 'support': 16653}, '1': {'precision': 0.3458062183658713, 'recall': 0.7835576360444705, 'f1-score': 0.4798437667968611, 'support': 17090}, '2': {'precision': 0.32536333802156586, 'recall': 0.07983434947659036, 'f1-score': 0.12820986513947905, 'support': 17386}, 'accuracy': 0.3451661483698097, 'macro avg': {'precision': 0.34122328785015976, 'recall': 0.3452244187209957, 'f1-score': 0.2798330865193846, 'support': 51129}, 'weighted avg': {'precision': 0.34103508540949024, 'recall': 0.3451661483698097, 'f1-score': 0.2793688655490895, 'support': 51129}}
[[ 2869 12070  1714]
 [ 2535 13391  1164]
 [ 2735 13263  1388]]
Evaluating performance on  val set...
53/53 - 1s - 511ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100347
{'0': {'precision': 0.32954545454545453, 'recall': 0.013134057971014492, 'f1-score': 0.025261324041811847, 'support': 4416}, '1': {'precision': 0.3475444410967159, 'recall': 0.9840051183621241, 'f1-score': 0.5136654606178681, 'support': 4689}, '2': {'precision': 0.32142857142857145, 'recall': 0.002057142857142857, 'f1-score': 0.004088121735180559, 'support': 4375}, 'accuracy': 0.3472551928783383, 'macro avg': {'precision': 0.3328394890235806, 'recall': 0.33306543973009384, 'f1-score': 0.18100496879828684, 'support': 13480}, 'weighted avg': {'precision': 0.3331720038260555, 'recall': 0.3472551928783383, 'f1-score': 0.18828018430246588, 'support': 13480}}
[[  58 4349    9]
 [  65 4614   10]
 [  53 4313    9]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017323
{'0': {'precision': 0.3262202599950944, 'recall': 0.014806238658755163, 'f1-score': 0.0283268018401772, 'support': 89827}, '1': {'precision': 0.34997832929524025, 'recall': 0.9847559451813792, 'f1-score': 0.5164222528012581, 'support': 100039}, '2': {'precision': 0.3282828282828283, 'recall': 0.002025111381125962, 'f1-score': 0.00402539092738814, 'support': 96291}, 'accuracy': 0.34959480285297934, 'macro avg': {'precision': 0.3348271391910543, 'recall': 0.33386243174042013, 'f1-score': 0.18292481518960782, 'support': 286157}, 'weighted avg': {'precision': 0.33522000579097383, 'recall': 0.34959480285297934, 'f1-score': 0.19078508054904053, 'support': 286157}}
[[ 1330 88309   188]
 [ 1314 98514   211]
 [ 1433 94663   195]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.114104
{'0': {'precision': 0.392876304023845, 'recall': 0.2814648729446936, 'f1-score': 0.3279671560089575, 'support': 46830}, '1': {'precision': 0.32968698030230237, 'recall': 0.6566640494651095, 'f1-score': 0.4389787834302445, 'support': 40756}, '2': {'precision': 0.3294685990338164, 'recall': 0.11467416108188609, 'f1-score': 0.17013239250904294, 'support': 41631}, 'accuracy': 0.34606901568679044, 'macro avg': {'precision': 0.35067729445332124, 'recall': 0.35093436116389637, 'f1-score': 0.31235944398274834, 'support': 129217}, 'weighted avg': {'precision': 0.35251729364568213, 'recall': 0.34606901568679044, 'f1-score': 0.3121300049213841, 'support': 129217}}
[[13181 28156  5493]
 [ 9770 26763  4223]
 [10599 26258  4774]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217257
{'0': {'precision': 0.3167232117613797, 'recall': 0.2717404487568223, 'f1-score': 0.2925125660943926, 'support': 16490}, '1': {'precision': 0.3099214145383104, 'recall': 0.6666226477385275, 'f1-score': 0.423126087047631, 'support': 15145}, '2': {'precision': 0.5500459136822773, 'recall': 0.03702559030782544, 'f1-score': 0.06938089998262581, 'support': 16178}, 'accuracy': 0.31740321669838745, 'macro avg': {'precision': 0.3922301799939891, 'recall': 0.3251295622677251, 'f1-score': 0.2616731843748831, 'support': 47813}, 'weighted avg': {'precision': 0.3935157462756937, 'recall': 0.31740321669838745, 'f1-score': 0.2583862339353695, 'support': 47813}}
[[ 4481 11733   276]
 [ 4835 10096   214]
 [ 4832 10747   599]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1184564
{'0': {'precision': 0.32740319928240397, 'recall': 0.21294698203563703, 'f1-score': 0.25805311298661127, 'support': 41137}, '1': {'precision': 0.38923622938390706, 'recall': 0.8023919543354172, 'f1-score': 0.5241903859955458, 'support': 44148}, '2': {'precision': 0.4221928228873822, 'recall': 0.11455108359133127, 'f1-score': 0.1802075245288346, 'support': 44574}, 'accuracy': 0.37956552876581523, 'macro avg': {'precision': 0.3796107505178978, 'recall': 0.37663000665412855, 'f1-score': 0.32081700783699724, 'support': 129859}, 'weighted avg': {'precision': 0.380960960357797, 'recall': 0.37956552876581523, 'f1-score': 0.3218110278703044, 'support': 129859}}
[[ 8760 27612  4765]
 [ 6501 35424  2223]
 [11495 27973  5106]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125005
{'0': {'precision': 0.3552709946396665, 'recall': 0.15819483734087694, 'f1-score': 0.21891247171080802, 'support': 22624}, '1': {'precision': 0.33887487012023154, 'recall': 0.8261636585696838, 'f1-score': 0.48061260739707634, 'support': 22107}, '2': {'precision': 0.3693724420190996, 'recall': 0.048847593703486535, 'f1-score': 0.08628450782774967, 'support': 22171}, 'accuracy': 0.34268033840542883, 'macro avg': {'precision': 0.35450610225966583, 'recall': 0.34440202987134905, 'f1-score': 0.2619365289785447, 'support': 66902}, 'weighted avg': {'precision': 0.35452623461901334, 'recall': 0.34268033840542883, 'f1-score': 0.26143601827690544, 'support': 66902}}
[[ 3579 18000  1045]
 [ 3039 18264   804]
 [ 3456 17632  1083]]
Evaluating performance on  val set...
73/73 - 1s - 649ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1224172
{'0': {'precision': 0.31283627978478096, 'recall': 0.19273875295974743, 'f1-score': 0.23852314905254932, 'support': 6335}, '1': {'precision': 0.32764365861951716, 'recall': 0.7599369085173502, 'f1-score': 0.45787598004276553, 'support': 6340}, '2': {'precision': 0.2391304347826087, 'recall': 0.0018397725372135808, 'f1-score': 0.0036514522821576765, 'support': 5979}, 'accuracy': 0.32432722204352954, 'macro avg': {'precision': 0.2932034577289689, 'recall': 0.31817181133810374, 'f1-score': 0.23335019379249086, 'support': 18654}, 'weighted avg': {'precision': 0.29424463909346754, 'recall': 0.32432722204352954, 'f1-score': 0.23779403323223192, 'support': 18654}}
[[1221 5096   18]
 [1505 4818   17]
 [1177 4791   11]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097306
{'0': {'precision': 0.3023255813953488, 'recall': 0.01331967213114754, 'f1-score': 0.025515210991167808, 'support': 45872}, '1': {'precision': 0.37818093346835174, 'recall': 0.985300919977386, 'f1-score': 0.5465742293857418, 'support': 58371}, '2': {'precision': 0.3354632587859425, 'recall': 0.002092925910422771, 'f1-score': 0.004159898577710867, 'support': 50169}, 'accuracy': 0.3771015206072067, 'macro avg': {'precision': 0.33865659121654773, 'recall': 0.33357117267298547, 'f1-score': 0.1920831129848735, 'support': 154412}, 'weighted avg': {'precision': 0.3417670554573514, 'recall': 0.3771015206072067, 'f1-score': 0.2155481183703803, 'support': 154412}}
[[  611 45157   104]
 [  754 57513   104]
 [  656 49408   105]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068746
{'0': {'precision': 0.3799667344298651, 'recall': 0.14503386004514673, 'f1-score': 0.20993516107622406, 'support': 28352}, '1': {'precision': 0.33590360751192655, 'recall': 0.8550150414557194, 'f1-score': 0.48232116803427116, 'support': 27258}, '2': {'precision': 0.4736625514403292, 'recall': 0.04259019426456984, 'f1-score': 0.07815311492106602, 'support': 27025}, 'accuracy': 0.34572517698311855, 'macro avg': {'precision': 0.396510964460707, 'recall': 0.3475463652551453, 'f1-score': 0.25680314801052045, 'support': 82635}, 'weighted avg': {'precision': 0.3960743975408789, 'recall': 0.34572517698311855, 'f1-score': 0.2566863921565085, 'support': 82635}}
[[ 4112 23607   633]
 [ 3306 23306   646]
 [ 3404 22470  1151]]
Evaluating performance on  val set...
112/112 - 1s - 958ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1141924
{'0': {'precision': 0.4131467133216696, 'recall': 0.17104718543046357, 'f1-score': 0.24193194291986828, 'support': 9664}, '1': {'precision': 0.32652686642499884, 'recall': 0.7755858310626703, 'f1-score': 0.45957117024024796, 'support': 9175}, '2': {'precision': 0.33989401968205907, 'recall': 0.09357090757528394, 'f1-score': 0.146744015033908, 'support': 9597}, 'accuracy': 0.3399563933042622, 'macro avg': {'precision': 0.3598558664762425, 'recall': 0.34673464135613924, 'f1-score': 0.28274904273134144, 'support': 28436}, 'weighted avg': {'precision': 0.3604760424770959, 'recall': 0.3399563933042622, 'f1-score': 0.28002876971487894, 'support': 28436}}
[[1653 7123  888]
 [1203 7116  856]
 [1145 7554  898]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172265
{'0': {'precision': 0.31607467174799775, 'recall': 0.1753927999074793, 'f1-score': 0.2255987419512506, 'support': 60527}, '1': {'precision': 0.29540121823080023, 'recall': 0.766696056921405, 'f1-score': 0.42648249746216055, 'support': 48769}, '2': {'precision': 0.31905594405594406, 'recall': 0.007017611320464508, 'f1-score': 0.013733162766197607, 'support': 52012}, 'accuracy': 0.2998735338606889, 'macro avg': {'precision': 0.3101772780115807, 'recall': 0.3163688227164496, 'f1-score': 0.2219381340598696, 'support': 161308}, 'weighted avg': {'precision': 0.310785648765261, 'recall': 0.2998735338606889, 'f1-score': 0.21801912635833887, 'support': 161308}}
[[10616 49504   407]
 [11006 37391   372]
 [11965 39682   365]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1167479
{'0': {'precision': 0.29760403530895335, 'recall': 0.11879892275553094, 'f1-score': 0.1698116601608174, 'support': 39731}, '1': {'precision': 0.32182692307692307, 'recall': 0.8315321358475566, 'f1-score': 0.46405224227215064, 'support': 40251}, '2': {'precision': 0.35248672139063253, 'recall': 0.017402083482323773, 'f1-score': 0.033166742389822805, 'support': 41949}, 'accuracy': 0.3191969228498085, 'macro avg': {'precision': 0.32397255992550295, 'recall': 0.3225777140284704, 'f1-score': 0.22234354827426359, 'support': 121931}, 'weighted avg': {'precision': 0.3244820995747177, 'recall': 0.3191969228498085, 'f1-score': 0.21993312242216045, 'support': 121931}}
[[ 4720 34280   731]
 [ 6171 33470   610]
 [ 4969 36250   730]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036735
{'0': {'precision': 0.32718327183271834, 'recall': 0.016876030960538004, 'f1-score': 0.03209653092006033, 'support': 15762}, '1': {'precision': 0.3404972326370291, 'recall': 0.9540991807891939, 'f1-score': 0.5018832546587937, 'support': 15991}, '2': {'precision': 0.28149920255183414, 'recall': 0.023343473085570693, 'f1-score': 0.043111871030776745, 'support': 15122}, 'accuracy': 0.338688, 'macro avg': {'precision': 0.3163932356738605, 'recall': 0.3314395616117675, 'f1-score': 0.1923638855365436, 'support': 46875}, 'weighted avg': {'precision': 0.31698741159925065, 'recall': 0.338688, 'f1-score': 0.19591377833254756, 'support': 46875}}
[[  266 15056   440]
 [  273 15257   461]
 [  274 14495   353]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
2354/2354 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018946
{'0': {'precision': 0.31769478830750025, 'recall': 0.015577658760520275, 'f1-score': 0.02969907081001444, 'support': 196050}, '1': {'precision': 0.34614825483116285, 'recall': 0.9816068261348928, 'f1-score': 0.5118135033604687, 'support': 208610}, '2': {'precision': 0.30595138306789604, 'recall': 0.0018460262388606224, 'f1-score': 0.0036699092577231482, 'support': 197722}, 'accuracy': 0.3456145767967834, 'macro avg': {'precision': 0.3232648087355197, 'recall': 0.3330101703780913, 'f1-score': 0.18172749447606876, 'support': 602382}, 'weighted avg': {'precision': 0.323693885360062, 'recall': 0.3456145767967834, 'f1-score': 0.18811574643097942, 'support': 602382}}
[[  3054 192601    395]
 [  3404 204773    433]
 [  3155 194202    365]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1150287
{'0': {'precision': 0.3426177782613426, 'recall': 0.20868717278726084, 'f1-score': 0.2593843402132216, 'support': 105627}, '1': {'precision': 0.3278794982260517, 'recall': 0.7847381489414128, 'f1-score': 0.46251207891370777, 'support': 105518}, '2': {'precision': 0.32881692002643753, 'recall': 0.009148415806991413, 'f1-score': 0.01780155293949261, 'support': 108762}, 'accuracy': 0.3308524039799067, 'macro avg': {'precision': 0.3331047321712773, 'recall': 0.3341912458452217, 'f1-score': 0.24656599068880733, 'support': 319907}, 'weighted avg': {'precision': 0.3330644931625215, 'recall': 0.3308524039799067, 'f1-score': 0.24425058453651738, 'support': 319907}}
[[22043 82527  1057]
 [21740 82804   974]
 [20554 87213   995]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.125866
{'0': {'precision': 0.33119833337027105, 'recall': 0.34928129017178916, 'f1-score': 0.33999954496848905, 'support': 42785}, '1': {'precision': 0.32750043313615324, 'recall': 0.6187803965581743, 'f1-score': 0.42831016233188207, 'support': 42768}, '2': {'precision': 0.36416184971098264, 'recall': 0.006136463254273608, 'f1-score': 0.01206954356051535, 'support': 41066}, 'accuracy': 0.3290185517181466, 'macro avg': {'precision': 0.34095353873913564, 'recall': 0.32473271666141235, 'f1-score': 0.2601264169536288, 'support': 126619}, 'weighted avg': {'precision': 0.3406402651880465, 'recall': 0.3290185517181466, 'f1-score': 0.26347149661538044, 'support': 126619}}
[[14944 27613   228]
 [16092 26464   212]
 [14085 26729   252]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
3870/3870 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023135
{'0': {'precision': 0.33818633760930356, 'recall': 0.04505817821606517, 'f1-score': 0.07952134807419836, 'support': 338185}, '1': {'precision': 0.34035659153240994, 'recall': 0.9525758012168578, 'f1-score': 0.5015195762695965, 'support': 336769}, '2': {'precision': 0.31272141706924317, 'recall': 0.00307527617310226, 'f1-score': 0.006090657333094976, 'support': 315744}, 'accuracy': 0.34017127318314966, 'macro avg': {'precision': 0.3304214487369856, 'recall': 0.3335697518686751, 'f1-score': 0.19571052722562995, 'support': 990698}, 'weighted avg': {'precision': 0.33080818440058585, 'recall': 0.34017127318314966, 'f1-score': 0.19956864936457858, 'support': 990698}}
[[ 15238 321882   1065]
 [ 14902 320798   1069]
 [ 14918 299855    971]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1113169
{'0': {'precision': 0.3550117615203669, 'recall': 0.1529700010208695, 'f1-score': 0.2138114142150243, 'support': 137138}, '1': {'precision': 0.33119317749181454, 'recall': 0.821552154006558, 'f1-score': 0.47207732866200836, 'support': 132358}, '2': {'precision': 0.3362122530135454, 'recall': 0.04037637858731177, 'f1-score': 0.07209475844058943, 'support': 134014}, 'accuracy': 0.3348814155783004, 'macro avg': {'precision': 0.3408057306752423, 'recall': 0.33829951120491303, 'f1-score': 0.252661167105874, 'support': 403510}, 'weighted avg': {'precision': 0.34095516446481855, 'recall': 0.3348814155783004, 'f1-score': 0.2514599086697313, 'support': 403510}}
[[ 20978 110337   5823]
 [ 18759 108739   4860]
 [ 19354 109249   5411]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033328
{'0': {'precision': 0.33370125091979397, 'recall': 0.018108129691742532, 'f1-score': 0.03435215695186153, 'support': 50088}, '1': {'precision': 0.3367377471025912, 'recall': 0.978968123562274, 'f1-score': 0.5011082305911223, 'support': 51731}, '2': {'precision': 0.26843657817109146, 'recall': 0.0017625070209757703, 'f1-score': 0.0035020203963825286, 'support': 51631}, 'accuracy': 0.3365330726621049, 'macro avg': {'precision': 0.31295852539782554, 'recall': 0.33294625342499745, 'f1-score': 0.17965413597978877, 'support': 153450}, 'weighted avg': {'precision': 0.3127654455456918, 'recall': 0.3365330726621049, 'f1-score': 0.18132468901400986, 'support': 153450}}
[[  907 49066   115]
 [  955 50643   133]
 [  856 50684    91]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1086131
{'0': {'precision': 0.35651573443819673, 'recall': 0.016268140732471462, 'f1-score': 0.031116411022476313, 'support': 222152}, '1': {'precision': 0.30265445919595, 'recall': 0.9817818882791021, 'f1-score': 0.4626786948681576, 'support': 189866}, '2': {'precision': 0.3346183500385505, 'recall': 0.002015576598877036, 'f1-score': 0.00400701689594682, 'support': 215323}, 'accuracy': 0.3035908700371887, 'macro avg': {'precision': 0.33126284789089905, 'recall': 0.3333552018701502, 'f1-score': 0.16593404092886024, 'support': 627341}, 'weighted avg': {'precision': 0.332698647102554, 'recall': 0.3035908700371887, 'f1-score': 0.15242480392703286, 'support': 627341}}
[[  3614 218104    434]
 [  3030 186407    429]
 [  3493 211396    434]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157278
{'0': {'precision': 0.3338254439061053, 'recall': 0.2369534152615033, 'f1-score': 0.2771689166977752, 'support': 104970}, '1': {'precision': 0.33682435044849984, 'recall': 0.6942225321247136, 'f1-score': 0.4535798660600972, 'support': 100390}, '2': {'precision': 0.37205406879358033, 'recall': 0.09388393032674085, 'f1-score': 0.1499336750312002, 'support': 101732}, 'accuracy': 0.33904172039649355, 'macro avg': {'precision': 0.34756795438272853, 'recall': 0.34168662590431925, 'f1-score': 0.2935608192630242, 'support': 307092}, 'weighted avg': {'precision': 0.3474700021975737, 'recall': 0.33904172039649355, 'f1-score': 0.29268869448833795, 'support': 307092}}
[[24873 71119  8978]
 [23555 69693  7142]
 [26081 66100  9551]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1177261
{'0': {'precision': 0.3384139703000479, 'recall': 0.19458146580864863, 'f1-score': 0.24709062003179652, 'support': 39937}, '1': {'precision': 0.3232993931391717, 'recall': 0.7129258937820208, 'f1-score': 0.44486177228457874, 'support': 35719}, '2': {'precision': 0.3474784189004998, 'recall': 0.10313393386914073, 'f1-score': 0.15905829503150803, 'support': 37078}, 'accuracy': 0.3287384462540139, 'macro avg': {'precision': 0.33639726077990645, 'recall': 0.33688043115327004, 'f1-score': 0.2836702291159611, 'support': 112734}, 'weighted avg': {'precision': 0.3366062995316747, 'recall': 0.3287384462540139, 'f1-score': 0.2807993968068283, 'support': 112734}}
[[ 7771 27716  4450]
 [ 7523 25465  2731]
 [ 7669 25585  3824]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
3337/3337 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0737273
{'0': {'precision': 0.22855658982861252, 'recall': 0.02693883316852663, 'f1-score': 0.048196932616122096, 'support': 212370}, '1': {'precision': 0.5223515091972283, 'recall': 0.9666904762437891, 'f1-score': 0.6782243000931585, 'support': 446599}, '2': {'precision': 0.21397029305499798, 'recall': 0.0027326046387629965, 'f1-score': 0.00539629346522023, 'support': 195052}, 'accuracy': 0.5128410191318481, 'macro avg': {'precision': 0.32162613069361295, 'recall': 0.33212063801702624, 'f1-score': 0.24393917539150026, 'support': 854021}, 'weighted avg': {'precision': 0.3788613608316878, 'recall': 0.5128410191318481, 'f1-score': 0.36788607611518737, 'support': 854021}}
[[  5721 206065    584]
 [ 13502 431723   1374]
 [  5808 188711    533]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060526
{'0': {'precision': 0.3314163654288531, 'recall': 0.017169756712123535, 'f1-score': 0.03264810618323082, 'support': 117474}, '1': {'precision': 0.3270129118110499, 'recall': 0.982206316423202, 'f1-score': 0.49066518518209096, 'support': 119593}, '2': {'precision': 0.3808353808353808, 'recall': 0.0024023744759336324, 'f1-score': 0.004774629773667147, 'support': 129039}, 'accuracy': 0.3272057819320088, 'macro avg': {'precision': 0.3464215526917613, 'recall': 0.3339261492037531, 'f1-score': 0.17602930704632966, 'support': 366106}, 'weighted avg': {'precision': 0.3473963223280271, 'recall': 0.3272057819320088, 'f1-score': 0.17244060072387477, 'support': 366106}}
[[  2017 115195    262]
 [  1886 117465    242]
 [  2183 126546    310]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992856
{'0': {'precision': 0.3352754237288136, 'recall': 0.015667153429200803, 'f1-score': 0.02993544725828191, 'support': 40403}, '1': {'precision': 0.3589266651570537, 'recall': 0.983251362488369, 'f1-score': 0.525884234848036, 'support': 45138}, '2': {'precision': 0.2880658436213992, 'recall': 0.0017394761691764823, 'f1-score': 0.0034580708904532543, 'support': 40242}, 'accuracy': 0.35843476463433055, 'macro avg': {'precision': 0.32742264416908884, 'recall': 0.3335526640289154, 'f1-score': 0.18642591766559038, 'support': 125783}, 'weighted avg': {'precision': 0.3286589637374422, 'recall': 0.35843476463433055, 'f1-score': 0.19943874893205468, 'support': 125783}}
[[  633 39689    81]
 [  664 44382    92]
 [  591 39581    70]]
testing model on single stock: results/universal/W9/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093979
{'0': {'precision': 0.30179317275382345, 'recall': 0.012089540597457296, 'f1-score': 0.02324779708374408, 'support': 794902}, '1': {'precision': 0.3923204411177023, 'recall': 0.9858569574239617, 'f1-score': 0.561280190525243, 'support': 1034643}, '2': {'precision': 0.3064056939501779, 'recall': 0.0021315600865992705, 'f1-score': 0.004233667986512252, 'support': 807859}, 'accuracy': 0.39104437545404497, 'macro avg': {'precision': 0.33350643594056795, 'recall': 0.33335935270267275, 'f1-score': 0.19625388519849976, 'support': 2637404}, 'weighted avg': {'precision': 0.33871951065388517, 'recall': 0.39104437545404497, 'f1-score': 0.22849155736056637, 'support': 2637404}}
[[   9610  783617    1675]
 [  12410 1020010    2223]
 [   9823  796314    1722]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048158
{'0': {'precision': 0.34310291858678954, 'recall': 0.019298961091027227, 'f1-score': 0.03654246982334098, 'support': 289342}, '1': {'precision': 0.3310800753238714, 'recall': 0.970267276000554, 'f1-score': 0.4936978009685392, 'support': 288840}, '2': {'precision': 0.359325860817676, 'recall': 0.015004781595571299, 'f1-score': 0.028806650871278358, 'support': 296972}, 'accuracy': 0.3317039058268602, 'macro avg': {'precision': 0.34450295157611227, 'recall': 0.33485700622905085, 'f1-score': 0.1863489738877195, 'support': 875154}, 'weighted avg': {'precision': 0.34463988414042873, 'recall': 0.3317039058268602, 'f1-score': 0.18479914718772156, 'support': 875154}}
[[  5584 279346   4412]
 [  5055 280252   3533]
 [  5636 286880   4456]]
Evaluating performance on  val set...
1396/1396 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014915
{'0': {'precision': 0.33287238245752665, 'recall': 0.014237431347697508, 'f1-score': 0.027306906945839954, 'support': 118350}, '1': {'precision': 0.3432513094516662, 'recall': 0.983733141990509, 'f1-score': 0.5089248615871342, 'support': 122642}, '2': {'precision': 0.33703190013869627, 'recall': 0.0020898911192527994, 'f1-score': 0.00415402367622548, 'support': 116274}, 'accuracy': 0.3430917019811569, 'macro avg': {'precision': 0.33771853068262975, 'recall': 0.33335348815248644, 'f1-score': 0.18012859740306655, 'support': 357266}, 'weighted avg': {'precision': 0.3377889883569841, 'recall': 0.3430917019811569, 'f1-score': 0.1851011298604931, 'support': 357266}}
[[  1685 116443    222]
 [  1739 120647    256]
 [  1638 114393    243]]
training model: results/universal/W9/deepLOB_L1/h1000
Epoch 1/50
6697/6697 - 112s - loss: 3.1808 - accuracy1000: 0.4345 - val_loss: 3.3466 - val_accuracy1000: 0.3503 - 112s/epoch - 17ms/step
Epoch 2/50
6697/6697 - 108s - loss: 3.1489 - accuracy1000: 0.4484 - val_loss: 3.3593 - val_accuracy1000: 0.3505 - 108s/epoch - 16ms/step
Epoch 3/50
6697/6697 - 108s - loss: 3.1267 - accuracy1000: 0.4564 - val_loss: 3.3719 - val_accuracy1000: 0.3483 - 108s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 109s - loss: 3.1168 - accuracy1000: 0.4612 - val_loss: 3.5103 - val_accuracy1000: 0.3421 - 109s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 112s - loss: 3.1107 - accuracy1000: 0.4626 - val_loss: 3.5026 - val_accuracy1000: 0.3485 - 112s/epoch - 17ms/step
Epoch 6/50
6697/6697 - 110s - loss: 3.1033 - accuracy1000: 0.4655 - val_loss: 3.4362 - val_accuracy1000: 0.3532 - 110s/epoch - 16ms/step
Epoch 7/50
6697/6697 - 109s - loss: 3.0927 - accuracy1000: 0.4697 - val_loss: 3.4542 - val_accuracy1000: 0.3534 - 109s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 107s - loss: 3.0835 - accuracy1000: 0.4726 - val_loss: 3.4350 - val_accuracy1000: 0.3511 - 107s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 105s - loss: 3.0830 - accuracy1000: 0.4723 - val_loss: 3.4497 - val_accuracy1000: 0.3542 - 105s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 105s - loss: 3.0728 - accuracy1000: 0.4760 - val_loss: 3.4096 - val_accuracy1000: 0.3529 - 105s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 105s - loss: 3.0741 - accuracy1000: 0.4752 - val_loss: 3.4259 - val_accuracy1000: 0.3535 - 105s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 115s - 115s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0882771
{'0': {'precision': 0.29657428249859313, 'recall': 0.03350740984169396, 'f1-score': 0.0602119794147323, 'support': 1258259}, '1': {'precision': 0.40921729482567326, 'recall': 0.9673390397622056, 'f1-score': 0.5751335489648035, 'support': 1761522}, '2': {'precision': 0.300131926121372, 'recall': 0.0003532841841270581, 'f1-score': 0.0007057376470706848, 'support': 1287915}, 'accuracy': 0.4054615274615479, 'macro avg': {'precision': 0.33530783448187945, 'recall': 0.3337332445960089, 'f1-score': 0.2120170886755355, 'support': 4307696}, 'weighted avg': {'precision': 0.34370042300313525, 'recall': 0.4054615274615479, 'f1-score': 0.2529847961758925, 'support': 4307696}}
[[  42161 1215668     430]
 [  56902 1703989     631]
 [  43097 1244363     455]]
Evaluating performance on  train set...
6697/6697 - 43s - 43s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.122746
{'0': {'precision': 0.3552245361051129, 'recall': 0.0844859793559574, 'f1-score': 0.13650568621328854, 'support': 574403}, '1': {'precision': 0.33522870811625144, 'recall': 0.896976045837971, 'f1-score': 0.48805544710413856, 'support': 565121}, '2': {'precision': 0.3650287954907487, 'recall': 0.04148440070254717, 'f1-score': 0.07450189052611177, 'support': 574481}, 'accuracy': 0.33795759055545344, 'macro avg': {'precision': 0.3518273465707043, 'recall': 0.34098214196549187, 'f1-score': 0.2330210079478463, 'support': 1714005}, 'weighted avg': {'precision': 0.3519178353820847, 'recall': 0.33795759055545344, 'f1-score': 0.23163268401914855, 'support': 1714005}}
[[ 48529 502252  23622]
 [ 40387 506900  17834]
 [ 47699 502950  23832]]
Evaluating performance on  val set...
2631/2631 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1163002
{'0': {'precision': 0.3390543798954636, 'recall': 0.10231299034672259, 'f1-score': 0.15719180816753056, 'support': 221272}, '1': {'precision': 0.352112341436511, 'recall': 0.8830005447179382, 'f1-score': 0.5034606840810959, 'support': 234984}, '2': {'precision': 0.3408037094281298, 'recall': 0.026466677746385243, 'f1-score': 0.04911880874251395, 'support': 216612}, 'accuracy': 0.3505338342735871, 'macro avg': {'precision': 0.34399014358670144, 'recall': 0.3372600709370153, 'f1-score': 0.23659043366371346, 'support': 672868}, 'weighted avg': {'precision': 0.34417772920541945, 'recall': 0.3505338342735871, 'f1-score': 0.24332718239579157, 'support': 672868}}
[[ 22639 192933   5700]
 [ 22104 207491   5389]
 [ 22028 188851   5733]]
testing model out of sample: results/universal/W9/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 53s - 53s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0911316
{'0': {'precision': 0.3057242870379903, 'recall': 0.04380013157001974, 'f1-score': 0.07662276672825044, 'support': 677966}, '1': {'precision': 0.4245899516738959, 'recall': 0.9590178740387758, 'f1-score': 0.5885907050038406, 'support': 930064}, '2': {'precision': 0.40829726906431874, 'recall': 0.009071166884936093, 'f1-score': 0.017748024753823997, 'support': 603230}, 'accuracy': 0.41927000895417094, 'macro avg': {'precision': 0.379537169258735, 'recall': 0.3372963908312439, 'f1-score': 0.22765383216197166, 'support': 2211260}, 'weighted avg': {'precision': 0.3837014473274502, 'recall': 0.41927000895417094, 'f1-score': 0.2758973603731023, 'support': 2211260}}
[[ 29695 643463   4808]
 [ 34994 891948   3122]
 [ 32441 565317   5472]]
Evaluating performance on  train set...
3947/3947 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1174346
{'0': {'precision': 0.3606664726426077, 'recall': 0.09076288798220264, 'f1-score': 0.14502880632349394, 'support': 327689}, '1': {'precision': 0.34558774253789687, 'recall': 0.9016292169210103, 'f1-score': 0.4996596675804101, 'support': 343171}, '2': {'precision': 0.37785467128027683, 'recall': 0.03546312862026819, 'f1-score': 0.06484070519394992, 'support': 338718}, 'accuracy': 0.3478354322301001, 'macro avg': {'precision': 0.3613696288202604, 'recall': 0.3426184111744937, 'f1-score': 0.23650972636595133, 'support': 1009578}, 'weighted avg': {'precision': 0.3613077003411018, 'recall': 0.3478354322301001, 'f1-score': 0.23866978705999994, 'support': 1009578}}
[[ 29742 286351  11596]
 [ 25576 309413   8182]
 [ 27146 299560  12012]]
Evaluating performance on  val set...
1402/1402 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1120254
{'0': {'precision': 0.32664890073284475, 'recall': 0.04095765564828041, 'f1-score': 0.07278854504561347, 'support': 119709}, '1': {'precision': 0.3260132260695572, 'recall': 0.9497593955400566, 'f1-score': 0.485406442002538, 'support': 116997}, '2': {'precision': 0.28661087866108786, 'recall': 0.005636190100052659, 'f1-score': 0.011054984426189822, 'support': 121536}, 'accuracy': 0.32577698873945543, 'macro avg': {'precision': 0.3130910018211633, 'recall': 0.3321177470961299, 'f1-score': 0.1897499904914471, 'support': 358242}, 'weighted avg': {'precision': 0.31285813058558765, 'recall': 0.32577698873945543, 'f1-score': 0.18660045450019175, 'support': 358242}}
[[  4903 113974    832]
 [  5005 111119    873]
 [  5102 115749    685]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1142504
{'0': {'precision': 0.383547379382159, 'recall': 0.03731091301998919, 'f1-score': 0.0680062775025387, 'support': 29616}, '1': {'precision': 0.3046639988960949, 'recall': 0.9602905358385525, 'f1-score': 0.46257149441662654, 'support': 22992}, '2': {'precision': 0.5217391304347826, 'recall': 0.0005271018185012738, 'f1-score': 0.001053139672649085, 'support': 22766}, 'accuracy': 0.30774537638973654, 'macro avg': {'precision': 0.4033168362376789, 'recall': 0.3327095168923477, 'f1-score': 0.1772103038639381, 'support': 75374}, 'weighted avg': {'precision': 0.40122438631198154, 'recall': 0.30774537638973654, 'f1-score': 0.16814144787234048, 'support': 75374}}
[[ 1105 28505     6]
 [  908 22079     5]
 [  868 21886    12]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1287447
{'0': {'precision': 0.3859159839637441, 'recall': 0.13489307256443064, 'f1-score': 0.19990970654627538, 'support': 16413}, '1': {'precision': 0.32676773802304426, 'recall': 0.81980282375852, 'f1-score': 0.4672806424198276, 'support': 16432}, '2': {'precision': 0.3578113750899928, 'recall': 0.08154670750382849, 'f1-score': 0.13282259142131755, 'support': 18284}, 'accuracy': 0.33593459680416204, 'macro avg': {'precision': 0.3568316990255937, 'recall': 0.345414201275593, 'f1-score': 0.2666709801291402, 'support': 51129}, 'weighted avg': {'precision': 0.35685637697074113, 'recall': 0.33593459680416204, 'f1-score': 0.26184751885102375, 'support': 51129}}
[[ 2214 12709  1490]
 [ 1775 13471  1186]
 [ 1748 15045  1491]]
Evaluating performance on  val set...
53/53 - 0s - 485ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074269
{'0': {'precision': 0.30303030303030304, 'recall': 0.037461952704284714, 'f1-score': 0.06668055844967702, 'support': 4271}, '1': {'precision': 0.34, 'recall': 0.9617737003058104, 'f1-score': 0.5023961661341853, 'support': 4578}, '2': {'precision': 0.5, 'recall': 0.00021593608291945585, 'f1-score': 0.0004316857327865314, 'support': 4631}, 'accuracy': 0.33857566765578634, 'macro avg': {'precision': 0.381010101010101, 'recall': 0.33315052969767156, 'f1-score': 0.18983613677221625, 'support': 13480}, 'weighted avg': {'precision': 0.3832538890387555, 'recall': 0.33857566765578634, 'f1-score': 0.19189625002443655, 'support': 13480}}
[[ 160 4111    0]
 [ 174 4403    1]
 [ 194 4436    1]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1100132
{'0': {'precision': 0.3119495596477182, 'recall': 0.034090536239650894, 'f1-score': 0.06146413606112891, 'support': 91433}, '1': {'precision': 0.3320027095460786, 'recall': 0.9635918247192902, 'f1-score': 0.4938506426852957, 'support': 95116}, '2': {'precision': 0.36538461538461536, 'recall': 0.00038149546221187054, 'f1-score': 0.0007621951219512194, 'support': 99608}, 'accuracy': 0.3313146279839389, 'macro avg': {'precision': 0.33644562819280405, 'recall': 0.3326879521403843, 'f1-score': 0.18535899128945862, 'support': 286157}, 'weighted avg': {'precision': 0.3372151810987863, 'recall': 0.3313146279839389, 'f1-score': 0.18405584631457245, 'support': 286157}}
[[ 3117 88281    35]
 [ 3432 91653    31]
 [ 3443 96127    38]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1391237
{'0': {'precision': 0.39856194690265484, 'recall': 0.15622764227642277, 'f1-score': 0.2244684993380578, 'support': 46125}, '1': {'precision': 0.347578877724021, 'recall': 0.7926538887710116, 'f1-score': 0.48325176609246207, 'support': 42417}, '2': {'precision': 0.3479347448802499, 'recall': 0.12322065150583897, 'f1-score': 0.18198983297022514, 'support': 40675}, 'accuracy': 0.35475208370415656, 'macro avg': {'precision': 0.36469185650230856, 'recall': 0.3573673941844244, 'f1-score': 0.29657003280024835, 'support': 129217}, 'weighted avg': {'precision': 0.36588969566936946, 'recall': 0.35475208370415656, 'f1-score': 0.29604569174625467, 'support': 129217}}
[[ 7206 33063  5856]
 [ 5258 33622  3537]
 [ 5616 30047  5012]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1376876
{'0': {'precision': 0.33824814329401487, 'recall': 0.18871488635671196, 'f1-score': 0.2422654202683146, 'support': 16411}, '1': {'precision': 0.3392673199334407, 'recall': 0.8208192216755065, 'f1-score': 0.48009717809755187, 'support': 15649}, '2': {'precision': 0.7123115577889447, 'recall': 0.03599314416301657, 'f1-score': 0.06852377787177473, 'support': 15753}, 'accuracy': 0.3452826637107063, 'macro avg': {'precision': 0.46327567367213346, 'recall': 0.34850908406507836, 'f1-score': 0.26362879207921375, 'support': 47813}, 'weighted avg': {'precision': 0.4618247869634981, 'recall': 0.3452826637107063, 'f1-score': 0.26286394128973223, 'support': 47813}}
[[ 3097 13178   136]
 [ 2711 12845    93]
 [ 3348 11838   567]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1642028
{'0': {'precision': 0.28704708179648514, 'recall': 0.09494079655543596, 'f1-score': 0.1426876617773943, 'support': 41805}, '1': {'precision': 0.3268564572003638, 'recall': 0.8604982931675753, 'f1-score': 0.4737580296782518, 'support': 39254}, '2': {'precision': 0.4202521670606777, 'recall': 0.1092827868852459, 'f1-score': 0.1734590990404944, 'support': 48800}, 'accuracy': 0.33174443049769364, 'macro avg': {'precision': 0.3447185686858423, 'recall': 0.35490729220275236, 'f1-score': 0.26330159683204685, 'support': 129859}, 'weighted avg': {'precision': 0.3491381604509985, 'recall': 0.33174443049769364, 'f1-score': 0.2543278435131196, 'support': 129859}}
[[ 3969 33337  4499]
 [ 2618 33778  2858]
 [ 7240 36227  5333]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250129
{'0': {'precision': 0.378459773411731, 'recall': 0.1128067025733094, 'f1-score': 0.1738070932261995, 'support': 23394}, '1': {'precision': 0.3288241051454139, 'recall': 0.8825819768260074, 'f1-score': 0.4791361593215592, 'support': 21317}, '2': {'precision': 0.401400663472171, 'recall': 0.04907394889820197, 'f1-score': 0.08745583038869256, 'support': 22191}, 'accuracy': 0.33694059968311857, 'macro avg': {'precision': 0.36956151400977194, 'recall': 0.34815420943250625, 'f1-score': 0.2467996943121504, 'support': 66902}, 'weighted avg': {'precision': 0.37025370708932126, 'recall': 0.33694059968311857, 'f1-score': 0.24245195927396587, 'support': 66902}}
[[ 2639 19709  1046]
 [ 1925 18814   578]
 [ 2409 18693  1089]]
Evaluating performance on  val set...
73/73 - 1s - 571ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1296234
{'0': {'precision': 0.28454485920104783, 'recall': 0.1338570548367221, 'f1-score': 0.1820657867169495, 'support': 6492}, '1': {'precision': 0.30441195331537774, 'recall': 0.7987548376240956, 'f1-score': 0.44082277011654364, 'support': 5943}, '2': {'precision': 0.16666666666666666, 'recall': 0.00016079755587715066, 'f1-score': 0.00032128514056224905, 'support': 6219}, 'accuracy': 0.3011150423501662, 'macro avg': {'precision': 0.2518744930610307, 'recall': 0.31092423000556496, 'f1-score': 0.20773661399135182, 'support': 18654}, 'weighted avg': {'precision': 0.25157529025873765, 'recall': 0.3011150423501662, 'f1-score': 0.2039122377215724, 'support': 18654}}
[[ 869 5621    2]
 [1193 4747    3]
 [ 992 5226    1]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956389
{'0': {'precision': 0.3047822983583155, 'recall': 0.03707160375925162, 'f1-score': 0.06610290845056795, 'support': 46073}, '1': {'precision': 0.38349488458384307, 'recall': 0.964041298433566, 'f1-score': 0.5487123999134387, 'support': 59179}, '2': {'precision': 0.40476190476190477, 'recall': 0.00034580960130187145, 'f1-score': 0.000691028819966668, 'support': 49160}, 'accuracy': 0.3806439913996322, 'macro avg': {'precision': 0.36434636256802105, 'recall': 0.3338195705980398, 'f1-score': 0.20516877906132444, 'support': 154412}, 'weighted avg': {'precision': 0.3667796145710512, 'recall': 0.3806439913996322, 'f1-score': 0.2302397572229488, 'support': 154412}}
[[ 1708 44351    14]
 [ 2117 57051    11]
 [ 1779 47364    17]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1145506
{'0': {'precision': 0.37051561365286856, 'recall': 0.09090909090909091, 'f1-score': 0.14599668059291476, 'support': 28061}, '1': {'precision': 0.33738113248325047, 'recall': 0.9151430769794453, 'f1-score': 0.49300764865531704, 'support': 27293}, '2': {'precision': 0.5681024447031432, 'recall': 0.03577581466955024, 'f1-score': 0.06731266595399842, 'support': 27281}, 'accuracy': 0.3449385853451927, 'macro avg': {'precision': 0.4253330636130874, 'recall': 0.3472759941860288, 'f1-score': 0.23543899840074342, 'support': 82635}, 'weighted avg': {'precision': 0.42480286413172325, 'recall': 0.3449385853451927, 'f1-score': 0.2346321467750757, 'support': 82635}}
[[ 2551 25235   275]
 [ 1849 24977   467]
 [ 2485 23820   976]]
Evaluating performance on  val set...
112/112 - 1s - 778ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1177493
{'0': {'precision': 0.43010291595197253, 'recall': 0.1042294502753819, 'f1-score': 0.16779590129652863, 'support': 9623}, '1': {'precision': 0.34284389750505734, 'recall': 0.8557752998106459, 'f1-score': 0.48955888547872667, 'support': 9506}, '2': {'precision': 0.3228114478114478, 'recall': 0.0824110884280649, 'f1-score': 0.1313018916374219, 'support': 9307}, 'accuracy': 0.3483260655507104, 'macro avg': {'precision': 0.36525275375615923, 'recall': 0.34747194617136423, 'f1-score': 0.26288555947089237, 'support': 28436}, 'weighted avg': {'precision': 0.3658165914569578, 'recall': 0.3483260655507104, 'f1-score': 0.2634151578635095, 'support': 28436}}
[[1003 7826  794]
 [ 556 8135  815]
 [ 773 7767  767]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1480275
{'0': {'precision': 0.3045491019072897, 'recall': 0.0805840465146665, 'f1-score': 0.1274457890454481, 'support': 61228}, '1': {'precision': 0.2991630933833363, 'recall': 0.8959266676301175, 'f1-score': 0.44854905811519674, 'support': 48437}, '2': {'precision': 0.2857142857142857, 'recall': 0.0002710919195244273, 'f1-score': 0.0005416698908922077, 'support': 51643}, 'accuracy': 0.29969995288516377, 'macro avg': {'precision': 0.2964754936683039, 'recall': 0.3255939353547695, 'f1-score': 0.19217883901717903, 'support': 161308}, 'weighted avg': {'precision': 0.29690181530321524, 'recall': 0.29969995288516377, 'f1-score': 0.18323700596235665, 'support': 161308}}
[[ 4934 56267    27]
 [ 5033 43396     8]
 [ 6234 45395    14]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1243203
{'0': {'precision': 0.290000697788012, 'recall': 0.10423093321295111, 'f1-score': 0.1533466164858682, 'support': 39873}, '1': {'precision': 0.32161737664725715, 'recall': 0.8421184613069863, 'f1-score': 0.46546633955673833, 'support': 39878}, '2': {'precision': 0.4016959798994975, 'recall': 0.030322427690848742, 'f1-score': 0.056388325544484606, 'support': 42180}, 'accuracy': 0.3199924547489974, 'macro avg': {'precision': 0.33777135144492226, 'recall': 0.325557274070262, 'f1-score': 0.2250670938623637, 'support': 121931}, 'weighted avg': {'precision': 0.33898017732161245, 'recall': 0.3199924547489974, 'f1-score': 0.2218854589845978, 'support': 121931}}
[[ 4156 34710  1007]
 [ 5398 33582   898]
 [ 4777 36124  1279]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126988
{'0': {'precision': 0.3388484447385837, 'recall': 0.0332402778679478, 'f1-score': 0.060541563202081115, 'support': 15403}, '1': {'precision': 0.343223587908641, 'recall': 0.9169459962756052, 'f1-score': 0.4994843530744391, 'support': 16110}, '2': {'precision': 0.2929032258064516, 'recall': 0.04433016534305429, 'f1-score': 0.07700571040877481, 'support': 15362}, 'accuracy': 0.34058666666666665, 'macro avg': {'precision': 0.3249917528178921, 'recall': 0.33150547982886913, 'f1-score': 0.212343875561765, 'support': 46875}, 'weighted avg': {'precision': 0.3252948042742469, 'recall': 0.34058666666666665, 'f1-score': 0.21679309545238332, 'support': 46875}}
[[  512 14106   785]
 [  479 14772   859]
 [  520 14161   681]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0604281
{'0': {'precision': 0.24168826035399008, 'recall': 0.0379067588791227, 'f1-score': 0.06553492000166726, 'support': 145172}, '1': {'precision': 0.5183001876366925, 'recall': 0.9615916733386709, 'f1-score': 0.6735534640927542, 'support': 312250}, '2': {'precision': 0.2052980132450331, 'recall': 0.0004277041942604857, 'f1-score': 0.0008536299927028403, 'support': 144960}, 'accuracy': 0.5076878127168475, 'macro avg': {'precision': 0.3217621537452386, 'recall': 0.33330871213735136, 'f1-score': 0.24664733802904146, 'support': 602382}, 'weighted avg': {'precision': 0.3763153642068765, 'recall': 0.5076878127168475, 'f1-score': 0.3651414663339654, 'support': 602382}}
[[  5503 139590     79]
 [ 11832 300257    161]
 [  5434 139464     62]]
Evaluating performance on  train set...
1250/1250 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1301668
{'0': {'precision': 0.3747406872914224, 'recall': 0.15514666069194719, 'f1-score': 0.2194419869805765, 'support': 107118}, '1': {'precision': 0.3369927808638145, 'recall': 0.8836127698667892, 'f1-score': 0.4879072102301249, 'support': 104496}, '2': {'precision': 0.3571884984025559, 'recall': 0.005161921823201869, 'f1-score': 0.010176773653261483, 'support': 108293}, 'accuracy': 0.3423244880543408, 'macro avg': {'precision': 0.356307322185931, 'recall': 0.3479737841273128, 'f1-score': 0.23917532362132096, 'support': 319907}, 'weighted avg': {'precision': 0.3564688632256741, 'recall': 0.3423244880543408, 'f1-score': 0.23629558575093754, 'support': 319907}}
[[16619 89862   637]
 [11793 92334   369]
 [15936 91798   559]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1222347
{'0': {'precision': 0.37534995553506145, 'recall': 0.281160564492253, 'f1-score': 0.3214985964763799, 'support': 40532}, '1': {'precision': 0.4173326803446946, 'recall': 0.8206499467256783, 'f1-score': 0.5532937771545798, 'support': 48804}, '2': {'precision': 0.5051903114186851, 'recall': 0.00391599388461229, 'f1-score': 0.0077717449164271275, 'support': 37283}, 'accuracy': 0.40746649397009926, 'macro avg': {'precision': 0.43262431576614707, 'recall': 0.36857550170084785, 'f1-score': 0.29418803951579564, 'support': 126619}, 'weighted avg': {'precision': 0.42976329705583227, 'recall': 0.40746649397009926, 'f1-score': 0.3184647215532574, 'support': 126619}}
[[11396 29095    41]
 [ 8651 40051   102]
 [10314 26823   146]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.071579
{'0': {'precision': 0.2925933872082767, 'recall': 0.04464652710837896, 'f1-score': 0.0774717228842658, 'support': 274915}, '1': {'precision': 0.48321173270354045, 'recall': 0.9620718971398583, 'f1-score': 0.6433123835391467, 'support': 476375}, '2': {'precision': 0.21107266435986158, 'recall': 0.00025479516139811535, 'f1-score': 0.0005089759154265594, 'support': 239408}, 'accuracy': 0.47506101758558106, 'macro avg': {'precision': 0.3289592614238929, 'recall': 0.33565773980321173, 'f1-score': 0.24043102744627967, 'support': 990698}, 'weighted avg': {'precision': 0.3645518459107399, 'recall': 0.47506101758558106, 'f1-score': 0.3309564855396391, 'support': 990698}}
[[ 12274 262556     85]
 [ 17925 458307    143]
 [ 11750 227597     61]]
Evaluating performance on  train set...
1577/1577 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1232802
{'0': {'precision': 0.3933819248771627, 'recall': 0.12509348874062337, 'f1-score': 0.18982391873518145, 'support': 135043}, '1': {'precision': 0.3568529475963212, 'recall': 0.874614133381529, 'f1-score': 0.5068891183981464, 'support': 138325}, '2': {'precision': 0.3799025295892318, 'recall': 0.06289284012847506, 'f1-score': 0.1079195975924107, 'support': 130142}, 'accuracy': 0.36197120269633964, 'macro avg': {'precision': 0.3767124673542386, 'recall': 0.35420015408354244, 'f1-score': 0.26821087824191286, 'support': 403510}, 'weighted avg': {'precision': 0.37651219118051504, 'recall': 0.36197120269633964, 'f1-score': 0.27209908312074105, 'support': 403510}}
[[ 16893 110164   7986]
 [ 11970 120981   5374]
 [ 14080 107877   8185]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1090263
{'0': {'precision': 0.3252143413873733, 'recall': 0.032990057520112276, 'f1-score': 0.05990345099868996, 'support': 50591}, '1': {'precision': 0.3306036547113938, 'recall': 0.9655817802119863, 'f1-score': 0.49256048842993894, 'support': 50758}, '2': {'precision': 0.2535211267605634, 'recall': 0.00034548281223009154, 'f1-score': 0.0006900253009277008, 'support': 52101}, 'accuracy': 0.3303877484522646, 'macro avg': {'precision': 0.30311304095311015, 'recall': 0.3329724401814429, 'f1-score': 0.1843846549098522, 'support': 153450}, 'weighted avg': {'precision': 0.30265495781245777, 'recall': 0.3303877484522646, 'f1-score': 0.18291242599807886, 'support': 153450}}
[[ 1669 48895    27]
 [ 1721 49011    26]
 [ 1742 50341    18]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1029462
{'0': {'precision': 0.3233336215094666, 'recall': 0.03657129446736941, 'f1-score': 0.06571029490569519, 'support': 204532}, '1': {'precision': 0.3539191887747837, 'recall': 0.9629664670820549, 'f1-score': 0.5176034978150764, 'support': 221961}, '2': {'precision': 0.3487544483985765, 'recall': 0.0004879311718314347, 'f1-score': 0.0009744989534080118, 'support': 200848}, 'accuracy': 0.3527889935457749, 'macro avg': {'precision': 0.3420024195609423, 'recall': 0.3333418975737519, 'f1-score': 0.19476276389139324, 'support': 627341}, 'weighted avg': {'precision': 0.34229384463341517, 'recall': 0.3527889935457749, 'f1-score': 0.20487003747878416, 'support': 627341}}
[[  7480 196968     84]
 [  8121 213741     99]
 [  7533 193217     98]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1396416
{'0': {'precision': 0.3285288650080216, 'recall': 0.12283625007141089, 'f1-score': 0.17881423472746802, 'support': 105026}, '1': {'precision': 0.3406707108466911, 'recall': 0.8029698102074934, 'f1-score': 0.4783816085489314, 'support': 101690}, '2': {'precision': 0.36286739879873475, 'recall': 0.10171754204192238, 'f1-score': 0.15889443091360408, 'support': 100376}, 'accuracy': 0.3411518372344444, 'macro avg': {'precision': 0.3440223248844825, 'recall': 0.3425078674402755, 'f1-score': 0.27203009139666784, 'support': 307092}, 'weighted avg': {'precision': 0.34377338121525247, 'recall': 0.3411518372344444, 'f1-score': 0.2715015597515136, 'support': 307092}}
[[12901 82094 10031]
 [12140 81654  7896]
 [14228 75938 10210]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1298873
{'0': {'precision': 0.24033446477357398, 'recall': 0.07643496577145867, 'f1-score': 0.115983139894924, 'support': 37980}, '1': {'precision': 0.3319138706686356, 'recall': 0.73540974459127, 'f1-score': 0.45739209994952046, 'support': 39427}, '2': {'precision': 0.3201233268160626, 'recall': 0.12050273162170577, 'f1-score': 0.17509511568123393, 'support': 35327}, 'accuracy': 0.3207106995227704, 'macro avg': {'precision': 0.2974572207527574, 'recall': 0.3107824806614781, 'f1-score': 0.24949011850855948, 'support': 112734}, 'weighted avg': {'precision': 0.2973660822589785, 'recall': 0.3207106995227704, 'f1-score': 0.25390940736237433, 'support': 112734}}
[[ 2903 30396  4681]
 [ 6072 28995  4360]
 [ 3104 27966  4257]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0899175
{'0': {'precision': 0.33473408341240796, 'recall': 0.02739624706917848, 'f1-score': 0.050647277401182085, 'support': 270402}, '1': {'precision': 0.40206419867100524, 'recall': 0.9747905284455666, 'f1-score': 0.5693096954568827, 'support': 343006}, '2': {'precision': 0.25704225352112675, 'recall': 0.0003033917535627751, 'f1-score': 0.000606068153609219, 'support': 240613}, 'accuracy': 0.40027118771084086, 'macro avg': {'precision': 0.33128017853484665, 'recall': 0.334163389089436, 'f1-score': 0.20685434700389135, 'support': 854021}, 'weighted avg': {'precision': 0.3398873164696274, 'recall': 0.40027118771084086, 'f1-score': 0.24486235628908695, 'support': 854021}}
[[  7408 262891    103]
 [  8539 334359    108]
 [  6184 234356     73]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056818
{'0': {'precision': 0.3071921982933767, 'recall': 0.03346139546412195, 'f1-score': 0.06034916301458438, 'support': 112966}, '1': {'precision': 0.3471107328562421, 'recall': 0.9649737853622493, 'f1-score': 0.5105658258645428, 'support': 127219}, '2': {'precision': 0.3923076923076923, 'recall': 0.00040501584326681016, 'f1-score': 0.0008091962776971227, 'support': 125921}, 'accuracy': 0.34578510049002203, 'macro avg': {'precision': 0.3488702078191037, 'recall': 0.3329467322232127, 'f1-score': 0.1905747283856081, 'support': 366106}, 'weighted avg': {'precision': 0.3503387847200668, 'recall': 0.34578510049002203, 'f1-score': 0.1963173839113555, 'support': 366106}}
[[  3780 109142     44]
 [  4421 122763     35]
 [  4104 121766     51]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1133318
{'0': {'precision': 0.34356223175965667, 'recall': 0.03727416651145465, 'f1-score': 0.06725195328908679, 'support': 42952}, '1': {'precision': 0.31508874517868796, 'recall': 0.963189254696021, 'f1-score': 0.4748420823350033, 'support': 39608}, '2': {'precision': 0.45652173913043476, 'recall': 0.00048585243967332205, 'f1-score': 0.0009706718435831658, 'support': 43223}, 'accuracy': 0.3161953523131107, 'macro avg': {'precision': 0.37172423868959314, 'recall': 0.333649757882383, 'f1-score': 0.18102156915589107, 'support': 125783}, 'weighted avg': {'precision': 0.3734126163950059, 'recall': 0.3161953523131107, 'f1-score': 0.17282229270960991, 'support': 125783}}
[[ 1601 41331    20]
 [ 1453 38150     5]
 [ 1606 41596    21]]
testing model on single stock: results/universal/W9/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
10303/10303 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0883609
{'0': {'precision': 0.29947813121272365, 'recall': 0.03125871377824237, 'f1-score': 0.05660875906751267, 'support': 771049}, '1': {'precision': 0.4073010268132563, 'recall': 0.9702809650555071, 'f1-score': 0.5737537739272569, 'support': 1073016}, '2': {'precision': 0.32634338138925295, 'recall': 0.00031386330433774213, 'f1-score': 0.0006271234677661056, 'support': 793339}, 'accuracy': 0.4039874057975191, 'macro avg': {'precision': 0.3443741798050776, 'recall': 0.33395118071269575, 'f1-score': 0.21032988548751186, 'support': 2637404}, 'weighted avg': {'precision': 0.35142654065454554, 'recall': 0.4039874057975191, 'f1-score': 0.25016744801303487, 'support': 2637404}}
[[  24102  746738     209]
 [  31584 1041127     305]
 [  24794  768296     249]]
Evaluating performance on  train set...
3419/3419 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1123575
{'0': {'precision': 0.3290423178735903, 'recall': 0.03149896033297116, 'f1-score': 0.05749405987644543, 'support': 288073}, '1': {'precision': 0.3315522359937871, 'recall': 0.9491226553721152, 'f1-score': 0.49143422853454993, 'support': 289225}, '2': {'precision': 0.3673750191102278, 'recall': 0.024202970562956595, 'f1-score': 0.045414027384488416, 'support': 297856}, 'accuracy': 0.33227637650059305, 'macro avg': {'precision': 0.3426565243258684, 'recall': 0.3349415287560143, 'f1-score': 0.19811410526516127, 'support': 875154}, 'weighted avg': {'precision': 0.34291822557423934, 'recall': 0.33227637650059305, 'f1-score': 0.1967932405031876, 'support': 875154}}
[[  9074 272054   6945]
 [  9246 274510   5469]
 [  9257 281390   7209]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069607
{'0': {'precision': 0.325814923528503, 'recall': 0.036135908023919264, 'f1-score': 0.06505645012030353, 'support': 116726}, '1': {'precision': 0.34010267316290865, 'recall': 0.9627049787003076, 'f1-score': 0.5026352681532942, 'support': 121598}, '2': {'precision': 0.38016528925619836, 'recall': 0.0003867431184947285, 'f1-score': 0.0007727001671384056, 'support': 118942}, 'accuracy': 0.33959850643498124, 'macro avg': {'precision': 0.34869429531587004, 'recall': 0.33307587661424054, 'f1-score': 0.18948813948024534, 'support': 357266}, 'weighted avg': {'precision': 0.34877233615782677, 'recall': 0.33959850643498124, 'f1-score': 0.1925879569758292, 'support': 357266}}
[[  4218 112468     40]
 [  4500 117063     35]
 [  4228 114668     46]]
training model: results/universal/W9/deepOF_L1/h300
Epoch 1/50
6697/6697 - 102s - loss: 3.2611 - accuracy300: 0.3887 - val_loss: 3.2873 - val_accuracy300: 0.3549 - 102s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 95s - loss: 3.2594 - accuracy300: 0.3874 - val_loss: 3.2859 - val_accuracy300: 0.3595 - 95s/epoch - 14ms/step
Epoch 3/50
6697/6697 - 96s - loss: 3.2591 - accuracy300: 0.3877 - val_loss: 3.2867 - val_accuracy300: 0.3616 - 96s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 100s - loss: 3.2566 - accuracy300: 0.3891 - val_loss: 3.2858 - val_accuracy300: 0.3628 - 100s/epoch - 15ms/step
Epoch 5/50
6697/6697 - 99s - loss: 3.2545 - accuracy300: 0.3902 - val_loss: 3.2868 - val_accuracy300: 0.3620 - 99s/epoch - 15ms/step
Epoch 6/50
6697/6697 - 96s - loss: 3.2523 - accuracy300: 0.3911 - val_loss: 3.2854 - val_accuracy300: 0.3646 - 96s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 97s - loss: 3.2504 - accuracy300: 0.3924 - val_loss: 3.2858 - val_accuracy300: 0.3642 - 97s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 99s - loss: 3.2484 - accuracy300: 0.3931 - val_loss: 3.2853 - val_accuracy300: 0.3638 - 99s/epoch - 15ms/step
Epoch 9/50
6697/6697 - 97s - loss: 3.2466 - accuracy300: 0.3942 - val_loss: 3.2853 - val_accuracy300: 0.3648 - 97s/epoch - 14ms/step
Epoch 10/50
6697/6697 - 98s - loss: 3.2458 - accuracy300: 0.3947 - val_loss: 3.2848 - val_accuracy300: 0.3661 - 98s/epoch - 15ms/step
Epoch 11/50
6697/6697 - 95s - loss: 3.2440 - accuracy300: 0.3956 - val_loss: 3.2848 - val_accuracy300: 0.3662 - 95s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 97s - loss: 3.2430 - accuracy300: 0.3963 - val_loss: 3.2846 - val_accuracy300: 0.3667 - 97s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 96s - loss: 3.2416 - accuracy300: 0.3969 - val_loss: 3.2832 - val_accuracy300: 0.3676 - 96s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 97s - loss: 3.2407 - accuracy300: 0.3973 - val_loss: 3.2844 - val_accuracy300: 0.3674 - 97s/epoch - 15ms/step
Epoch 15/50
6697/6697 - 97s - loss: 3.2398 - accuracy300: 0.3978 - val_loss: 3.2840 - val_accuracy300: 0.3671 - 97s/epoch - 15ms/step
Epoch 16/50
6697/6697 - 98s - loss: 3.2387 - accuracy300: 0.3981 - val_loss: 3.2827 - val_accuracy300: 0.3676 - 98s/epoch - 15ms/step
Epoch 17/50
6697/6697 - 99s - loss: 3.2378 - accuracy300: 0.3990 - val_loss: 3.2825 - val_accuracy300: 0.3678 - 99s/epoch - 15ms/step
Epoch 18/50
6697/6697 - 98s - loss: 3.2365 - accuracy300: 0.3998 - val_loss: 3.2824 - val_accuracy300: 0.3677 - 98s/epoch - 15ms/step
Epoch 19/50
6697/6697 - 100s - loss: 3.2352 - accuracy300: 0.4003 - val_loss: 3.2825 - val_accuracy300: 0.3670 - 100s/epoch - 15ms/step
Epoch 20/50
6697/6697 - 101s - loss: 3.2344 - accuracy300: 0.4009 - val_loss: 3.2830 - val_accuracy300: 0.3671 - 101s/epoch - 15ms/step
Epoch 21/50
6697/6697 - 99s - loss: 3.2335 - accuracy300: 0.4015 - val_loss: 3.2831 - val_accuracy300: 0.3672 - 99s/epoch - 15ms/step
Epoch 22/50
6697/6697 - 98s - loss: 3.2320 - accuracy300: 0.4022 - val_loss: 3.2825 - val_accuracy300: 0.3674 - 98s/epoch - 15ms/step
Epoch 23/50
6697/6697 - 100s - loss: 3.2314 - accuracy300: 0.4025 - val_loss: 3.2831 - val_accuracy300: 0.3668 - 100s/epoch - 15ms/step
Epoch 24/50
6697/6697 - 99s - loss: 3.2296 - accuracy300: 0.4032 - val_loss: 3.2831 - val_accuracy300: 0.3667 - 99s/epoch - 15ms/step
Epoch 25/50
6697/6697 - 99s - loss: 3.2288 - accuracy300: 0.4042 - val_loss: 3.2834 - val_accuracy300: 0.3667 - 99s/epoch - 15ms/step
Epoch 26/50
6697/6697 - 101s - loss: 3.2281 - accuracy300: 0.4042 - val_loss: 3.2850 - val_accuracy300: 0.3650 - 101s/epoch - 15ms/step
Epoch 27/50
6697/6697 - 98s - loss: 3.2262 - accuracy300: 0.4052 - val_loss: 3.2848 - val_accuracy300: 0.3658 - 98s/epoch - 15ms/step
Epoch 28/50
6697/6697 - 101s - loss: 3.2254 - accuracy300: 0.4056 - val_loss: 3.2851 - val_accuracy300: 0.3657 - 101s/epoch - 15ms/step
testing model in sample: results/universal/W9/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 115s - 115s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981777
{'0': {'precision': 0.3465846229529184, 'recall': 0.5098905499199146, 'f1-score': 0.4126686437354296, 'support': 1348560}, '1': {'precision': 0.37789178661346257, 'recall': 0.00495827383508613, 'f1-score': 0.00978811890934147, 'support': 1604389}, '2': {'precision': 0.3421113659874179, 'recall': 0.5814898499845357, 'f1-score': 0.4307796123388152, 'support': 1354727}, 'accuracy': 0.3443464643116149, 'macro avg': {'precision': 0.355529258517933, 'recall': 0.3654462245798455, 'f1-score': 0.2844121249945288, 'support': 4307676}, 'weighted avg': {'precision': 0.35683813946833765, 'recall': 0.3443464643116149, 'f1-score': 0.26831199662871963, 'support': 4307676}}
[[687618   6238 654704]
 [736256   7955 860178]
 [560109   6858 787760]]
Evaluating performance on  train set...
6697/6697 - 42s - 42s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923963
{'0': {'precision': 0.37882334324539946, 'recall': 0.5016747230332919, 'f1-score': 0.4316786216337445, 'support': 572632}, '1': {'precision': 0.35051080372479887, 'recall': 0.006857953510256859, 'f1-score': 0.013452696958656465, 'support': 565329}, '2': {'precision': 0.37320016980678655, 'recall': 0.6119839316156226, 'f1-score': 0.46365447202857213, 'support': 576038}, 'accuracy': 0.3755416426730704, 'macro avg': {'precision': 0.3675114389256617, 'recall': 0.3735055360530571, 'f1-score': 0.3029285968736577, 'support': 1713999}, 'weighted avg': {'precision': 0.367595179614106, 'recall': 0.3755416426730704, 'f1-score': 0.30448138356014753, 'support': 1713999}}
[[287275   3408 281949]
 [251324   3877 310128]
 [219736   3776 352526]]
Evaluating performance on  val set...
2631/2631 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936344
{'0': {'precision': 0.37530710507769016, 'recall': 0.5046363539747768, 'f1-score': 0.43046767875557634, 'support': 225824}, '1': {'precision': 0.34184966216216217, 'recall': 0.0070863935990475605, 'f1-score': 0.013884958104990523, 'support': 228466}, '2': {'precision': 0.3616617327915673, 'recall': 0.6030927599222234, 'f1-score': 0.45216803701836167, 'support': 218575}, 'accuracy': 0.3676799952442169, 'macro avg': {'precision': 0.3596061666771399, 'recall': 0.3716051691653493, 'f1-score': 0.2988402246263095, 'support': 672865}, 'weighted avg': {'precision': 0.3595143005766709, 'recall': 0.3676799952442169, 'f1-score': 0.2960694977699872, 'support': 672865}}
[[113959   1463 110402]
 [104583   1619 122264]
 [ 85100   1654 131821]]
testing model out of sample: results/universal/W9/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 56s - 56s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936308
{'0': {'precision': 0.3852998591265848, 'recall': 0.5133391963234761, 'f1-score': 0.4401979166786417, 'support': 745922}, '1': {'precision': 0.38010381548670197, 'recall': 0.009247662371140731, 'f1-score': 0.018056033951343017, 'support': 768086}, '2': {'precision': 0.35000621479153754, 'recall': 0.6017667003235652, 'f1-score': 0.442588944532789, 'support': 697232}, 'accuracy': 0.36612262802771295, 'macro avg': {'precision': 0.37180329646827476, 'recall': 0.37478451967272736, 'f1-score': 0.30028096505425794, 'support': 2211240}, 'weighted avg': {'precision': 0.37236645225885595, 'recall': 0.36612262802771295, 'f1-score': 0.2943186050690122, 'support': 2211240}}
[[382911   5598 357413]
 [339214   7103 421769]
 [271675   5986 419571]]
Evaluating performance on  train set...
3947/3947 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929949
{'0': {'precision': 0.37113436188971305, 'recall': 0.5121590220400357, 'f1-score': 0.4303888499316684, 'support': 328357}, '1': {'precision': 0.3596259402317544, 'recall': 0.010281775277241764, 'f1-score': 0.019991976086477445, 'support': 344104}, '2': {'precision': 0.3700341560420703, 'recall': 0.5999887278153023, 'f1-score': 0.4577548142968038, 'support': 337113}, 'accuracy': 0.3704265363410706, 'macro avg': {'precision': 0.3669314860545126, 'recall': 0.37414317504419325, 'f1-score': 0.30271188010498323, 'support': 1009574}, 'weighted avg': {'precision': 0.36684444592505216, 'recall': 0.3704265363410706, 'f1-score': 0.29964679087249924, 'support': 1009574}}
[[168171   2984 157202]
 [153423   3538 187143]
 [131533   3316 202264]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929533
{'0': {'precision': 0.3740580407247074, 'recall': 0.5186040149105707, 'f1-score': 0.43462808910671163, 'support': 116964}, '1': {'precision': 0.3657086223984143, 'recall': 0.008877875084207487, 'f1-score': 0.017334930589810442, 'support': 124692}, '2': {'precision': 0.36287632347761223, 'recall': 0.6008834755757602, 'f1-score': 0.45249114285437464, 'support': 116585}, 'accuracy': 0.36796179108477256, 'macro avg': {'precision': 0.36754766220024465, 'recall': 0.3761217885235128, 'f1-score': 0.3014847208502989, 'support': 358241}, 'weighted avg': {'precision': 0.36751293233344356, 'recall': 0.36796179108477256, 'f1-score': 0.2951952648330574, 'support': 358241}}
[[60658   932 55374]
 [55961  1107 67624]
 [45543   988 70054]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957445
{'0': {'precision': 0.38589777817329657, 'recall': 0.491424901783016, 'f1-score': 0.4323147732748451, 'support': 26472}, '1': {'precision': 0.3392226148409894, 'recall': 0.007426029781473603, 'f1-score': 0.014533893493811739, 'support': 25855}, '2': {'precision': 0.3375757428272455, 'recall': 0.6020049472724905, 'f1-score': 0.4325807658725208, 'support': 23043}, 'accuracy': 0.35920127371633276, 'macro avg': {'precision': 0.3542320452805105, 'recall': 0.36695195961232674, 'f1-score': 0.29314314421372584, 'support': 75370}, 'weighted avg': {'precision': 0.35511270442464515, 'recall': 0.35920127371633276, 'f1-score': 0.2890801258115258, 'support': 75370}}
[[13009   215 13248]
 [11690   192 13973]
 [ 9012   159 13872]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096941
{'0': {'precision': 0.35422061108234076, 'recall': 0.4830792772644341, 'f1-score': 0.4087344072902921, 'support': 16991}, '1': {'precision': 0.2927461139896373, 'recall': 0.00671021377672209, 'f1-score': 0.013119702774875187, 'support': 16840}, '2': {'precision': 0.3655094859796133, 'recall': 0.5826298138082572, 'f1-score': 0.44920978132453576, 'support': 17294}, 'accuracy': 0.35984352078239606, 'macro avg': {'precision': 0.3374920703505304, 'recall': 0.3574731016164711, 'f1-score': 0.29035463046323434, 'support': 51125}, 'weighted avg': {'precision': 0.3377902789832172, 'recall': 0.35984352078239606, 'f1-score': 0.2921149353002401, 'support': 51125}}
[[ 8208   136  8647]
 [ 7883   113  8844]
 [ 7081   137 10076]]
Evaluating performance on  val set...
53/53 - 0s - 463ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986449
{'0': {'precision': 0.33796377703534375, 'recall': 0.4590398853594459, 'f1-score': 0.38930524610087097, 'support': 4187}, '1': {'precision': 0.5157894736842106, 'recall': 0.00906567992599445, 'f1-score': 0.017818181818181816, 'support': 5405}, '2': {'precision': 0.31969342686412056, 'recall': 0.6329732510288066, 'f1-score': 0.42482306231658906, 'support': 3888}, 'accuracy': 0.3287833827893175, 'macro avg': {'precision': 0.39114889252789165, 'recall': 0.36702627210474903, 'f1-score': 0.27731549674521394, 'support': 13480}, 'weighted avg': {'precision': 0.4039958815547362, 'recall': 0.3287833827893175, 'f1-score': 0.25059646917199685, 'support': 13480}}
[[1922   29 2236]
 [2355   49 3001]
 [1410   17 2461]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943129
{'0': {'precision': 0.35342176429035227, 'recall': 0.5710349439121963, 'f1-score': 0.4366157453522915, 'support': 86739}, '1': {'precision': 0.36938902743142144, 'recall': 0.01067894670439594, 'f1-score': 0.020757790740448787, 'support': 110966}, '2': {'precision': 0.37172789534867434, 'recall': 0.6001492402315485, 'f1-score': 0.459095508679069, 'support': 88448}, 'accuracy': 0.3627360188430665, 'macro avg': {'precision': 0.3648462290234827, 'recall': 0.39395437694938024, 'f1-score': 0.30548968159060313, 'support': 286153}, 'weighted avg': {'precision': 0.3652719423473999, 'recall': 0.3627360188430665, 'f1-score': 0.28230038369356025, 'support': 286153}}
[[49531  1043 36165]
 [56230  1185 53551]
 [34386   980 53082]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0884416
{'0': {'precision': 0.40050776536225297, 'recall': 0.5912592832519723, 'f1-score': 0.47753942746094624, 'support': 43223}, '1': {'precision': 0.39282051282051283, 'recall': 0.00817363097016518, 'f1-score': 0.0160140488783894, 'support': 46858}, '2': {'precision': 0.3707572206788447, 'recall': 0.6104098528209322, 'f1-score': 0.461315644642702, 'support': 39136}, 'accuracy': 0.3856148958728341, 'macro avg': {'precision': 0.3880284996205368, 'recall': 0.40328092234768986, 'f1-score': 0.31828970699401254, 'support': 129217}, 'weighted avg': {'precision': 0.3887095762978828, 'recall': 0.3856148958728341, 'f1-score': 0.3052626360635584, 'support': 129217}}
[[25556   266 17401]
 [23332   383 23143]
 [14921   326 23889]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0887598
{'0': {'precision': 0.38419653032797263, 'recall': 0.5875669743722162, 'f1-score': 0.4646010923383186, 'support': 15491}, '1': {'precision': 0.3597285067873303, 'recall': 0.00916373696040574, 'f1-score': 0.01787219693137751, 'support': 17351}, '2': {'precision': 0.37904383816200693, 'recall': 0.5995724497294408, 'f1-score': 0.4644603720858022, 'support': 14969}, 'accuracy': 0.38141850201836397, 'macro avg': {'precision': 0.37432295842576996, 'recall': 0.3987677203540209, 'f1-score': 0.31564455378516615, 'support': 47811}, 'weighted avg': {'precision': 0.37370364531226435, 'recall': 0.38141850201836397, 'f1-score': 0.3024354922532806, 'support': 47811}}
[[9102  134 6255]
 [8744  159 8448]
 [5845  149 8975]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948914
{'0': {'precision': 0.37847629842529246, 'recall': 0.46, 'f1-score': 0.41527494003731014, 'support': 40650}, '1': {'precision': 0.32689747003994674, 'recall': 0.01061277423538312, 'f1-score': 0.02055812590281994, 'support': 46265}, '2': {'precision': 0.3491962962493825, 'recall': 0.6420121099208197, 'f1-score': 0.4523534093053401, 'support': 42940}, 'accuracy': 0.3600785491509761, 'macro avg': {'precision': 0.3515233549048739, 'recall': 0.37087496138540094, 'f1-score': 0.29606215841515676, 'support': 129855}, 'weighted avg': {'precision': 0.35041748060016753, 'recall': 0.3600785491509761, 'f1-score': 0.28690542068447056, 'support': 129855}}
[[18699   515 21436]
 [15831   491 29943]
 [14876   496 27568]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096445
{'0': {'precision': 0.36160269406549606, 'recall': 0.4717141832526448, 'f1-score': 0.4093835709700636, 'support': 22308}, '1': {'precision': 0.3213728549141966, 'recall': 0.009293931874577036, 'f1-score': 0.01806542138033851, 'support': 22165}, '2': {'precision': 0.3613832077502691, 'recall': 0.5987337821570289, 'f1-score': 0.4507207706120257, 'support': 22429}, 'accuracy': 0.3610953334728409, 'macro avg': {'precision': 0.3481195855766539, 'recall': 0.35991396576141693, 'f1-score': 0.2927232543208093, 'support': 66902}, 'weighted avg': {'precision': 0.34820074429788406, 'recall': 0.3610953334728409, 'f1-score': 0.2935960797906267, 'support': 66902}}
[[10523   197 11588]
 [ 9816   206 12143]
 [ 8762   238 13429]]
Evaluating performance on  val set...
73/73 - 1s - 577ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987965
{'0': {'precision': 0.36231149410721075, 'recall': 0.4434620753838995, 'f1-score': 0.3988003905705119, 'support': 6447}, '1': {'precision': 0.4186046511627907, 'recall': 0.01167125952342357, 'f1-score': 0.022709351837249647, 'support': 6169}, '2': {'precision': 0.3365439093484419, 'recall': 0.5903594500579759, 'f1-score': 0.4287003067300174, 'support': 6037}, 'accuracy': 0.3482013617112529, 'macro avg': {'precision': 0.3724866848728145, 'recall': 0.34849759498843297, 'f1-score': 0.283403349712593, 'support': 18653}, 'weighted avg': {'precision': 0.3725893891743412, 'recall': 0.3482013617112529, 'f1-score': 0.28409499068360045, 'support': 18653}}
[[2859   54 3534]
 [2605   72 3492]
 [2427   46 3564]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979389
{'0': {'precision': 0.3507613111297175, 'recall': 0.48672490210422137, 'f1-score': 0.4077064484734888, 'support': 46478}, '1': {'precision': 0.3443496801705757, 'recall': 0.005483591667656995, 'f1-score': 0.010795274143146003, 'support': 58903}, '2': {'precision': 0.33776524006473657, 'recall': 0.6129887612947967, 'f1-score': 0.4355412563494997, 'support': 49027}, 'accuracy': 0.3432335112170354, 'macro avg': {'precision': 0.3442920771216766, 'recall': 0.368399085022225, 'f1-score': 0.2846809929887115, 'support': 154408}, 'weighted avg': {'precision': 0.3441889659501339, 'recall': 0.3432335112170354, 'f1-score': 0.265132218020125, 'support': 154408}}
[[22622   276 23580]
 [23237   323 35343]
 [18635   339 30053]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932806
{'0': {'precision': 0.39484056867915296, 'recall': 0.5047433714424714, 'f1-score': 0.44307851869928616, 'support': 28777}, '1': {'precision': 0.3234323432343234, 'recall': 0.007224474751197936, 'f1-score': 0.01413325641765215, 'support': 27130}, '2': {'precision': 0.3594668670704213, 'recall': 0.6084630350194552, 'f1-score': 0.45193830762817844, 'support': 26728}, 'accuracy': 0.37495008168451627, 'macro avg': {'precision': 0.3592465929946325, 'recall': 0.37347696040437484, 'f1-score': 0.30305002758170557, 'support': 82635}, 'weighted avg': {'precision': 0.35995494572379017, 'recall': 0.37495008168451627, 'f1-score': 0.30511663176022524, 'support': 82635}}
[[14525   196 14056]
 [12011   196 14923]
 [10251   214 16263]]
Evaluating performance on  val set...
112/112 - 1s - 757ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947708
{'0': {'precision': 0.3863859764089122, 'recall': 0.4757918095622352, 'f1-score': 0.42645330440285684, 'support': 9914}, '1': {'precision': 0.329073482428115, 'recall': 0.011854068362297158, 'f1-score': 0.02288380359920018, 'support': 8689}, '2': {'precision': 0.3751413849440744, 'recall': 0.6072009764035802, 'f1-score': 0.4637613609881147, 'support': 9832}, 'accuracy': 0.3794619307191841, 'macro avg': {'precision': 0.36353361459370054, 'recall': 0.3649489514427042, 'f1-score': 0.30436615633005726, 'support': 28435}, 'weighted avg': {'precision': 0.3649847074276767, 'recall': 0.3794619307191841, 'f1-score': 0.31603295693893146, 'support': 28435}}
[[4717  104 5093]
 [3735  103 4851]
 [3756  106 5970]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985625
{'0': {'precision': 0.3784548597154112, 'recall': 0.39424494171244806, 'f1-score': 0.38618856594393725, 'support': 59704}, '1': {'precision': 0.34445446348061315, 'recall': 0.007981446271494537, 'f1-score': 0.01560138860526853, 'support': 47861}, '2': {'precision': 0.3382551020408163, 'recall': 0.6168518208377528, 'f1-score': 0.4369212924824864, 'support': 53739}, 'accuracy': 0.3537977979467341, 'macro avg': {'precision': 0.35372147507894686, 'recall': 0.33969273627389845, 'f1-score': 0.27957041567723073, 'support': 161304}, 'weighted avg': {'precision': 0.3549738069091031, 'recall': 0.3537977979467341, 'f1-score': 0.293132306315218, 'support': 161304}}
[[23538   351 35815]
 [18443   382 29036]
 [20214   376 33149]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096425
{'0': {'precision': 0.3508852063654468, 'recall': 0.4815214120950757, 'f1-score': 0.4059524186985425, 'support': 39884}, '1': {'precision': 0.3436754176610978, 'recall': 0.010727056019070322, 'f1-score': 0.02080473885718414, 'support': 40272}, '2': {'precision': 0.3671615535099559, 'recall': 0.5795571514063435, 'f1-score': 0.4495339596717294, 'support': 41775}, 'accuracy': 0.35961322387251804, 'macro avg': {'precision': 0.3539073925121668, 'recall': 0.35726853984016316, 'f1-score': 0.2920970390758187, 'support': 121931}, 'weighted avg': {'precision': 0.35408038881503157, 'recall': 0.35961322387251804, 'f1-score': 0.29367540556475125, 'support': 121931}}
[[19205   390 20289]
 [18399   432 21441]
 [17129   435 24211]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978411
{'0': {'precision': 0.35096309298350964, 'recall': 0.4902251758177947, 'f1-score': 0.40906643695488315, 'support': 15499}, '1': {'precision': 0.34317343173431736, 'recall': 0.011239349809656173, 'f1-score': 0.021765841671054942, 'support': 16549}, '2': {'precision': 0.34759358288770054, 'recall': 0.5786740406016052, 'f1-score': 0.4343094328161778, 'support': 14827}, 'accuracy': 0.34909866666666667, 'macro avg': {'precision': 0.34724336920184257, 'recall': 0.36004618874301864, 'f1-score': 0.28838057048070526, 'support': 46875}, 'weighted avg': {'precision': 0.34714718193916944, 'recall': 0.34909866666666667, 'f1-score': 0.2803163643849278, 'support': 46875}}
[[7598  180 7721]
 [7980  186 8383]
 [6071  176 8580]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/EXC
Evaluating performance on  test set...
2354/2354 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0884311
{'0': {'precision': 0.3924095341436239, 'recall': 0.5475037721566576, 'f1-score': 0.4571606737211833, 'support': 196837}, '1': {'precision': 0.38262411347517733, 'recall': 0.010285986653956148, 'f1-score': 0.020033419977720013, 'support': 209800}, '2': {'precision': 0.3823299307056106, 'recall': 0.6291477002774074, 'f1-score': 0.47562494568838165, 'support': 195741}, 'accuracy': 0.3869281414659898, 'macro avg': {'precision': 0.3857878594414706, 'recall': 0.3956458196960071, 'f1-score': 0.3176063464624283, 'support': 602378}, 'weighted avg': {'precision': 0.38572606809273846, 'recall': 0.3869281414659898, 'f1-score': 0.3109151554979958, 'support': 602378}}
[[107769   1587  87481]
 [ 96169   2158 111473]
 [ 70696   1895 123150]]
Evaluating performance on  train set...
1250/1250 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0819762
{'0': {'precision': 0.41621399234347, 'recall': 0.5608456659619451, 'f1-score': 0.4778250984661693, 'support': 106425}, '1': {'precision': 0.3592137592137592, 'recall': 0.013914930472936318, 'f1-score': 0.0267920137075419, 'support': 105067}, '2': {'precision': 0.4103254092988998, 'recall': 0.6526094415850351, 'f1-score': 0.503854466730522, 'support': 108414}, 'accuracy': 0.4123148674923259, 'macro avg': {'precision': 0.39525105361870966, 'recall': 0.40912334600663885, 'f1-score': 0.3361571929680777, 'support': 319906}, 'weighted avg': {'precision': 0.3954977558976598, 'recall': 0.4123148674923259, 'f1-score': 0.33851309686156306, 'support': 319906}}
[[59688  1267 45470]
 [47398  1462 56207]
 [36321  1341 70752]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0830841
{'0': {'precision': 0.4150239298503966, 'recall': 0.5806021163030246, 'f1-score': 0.48404473329820247, 'support': 42716}, '1': {'precision': 0.363573883161512, 'recall': 0.012435354960037611, 'f1-score': 0.02404818729401068, 'support': 42540}, '2': {'precision': 0.40159924165978655, 'recall': 0.6350361434131954, 'f1-score': 0.49203420468488046, 'support': 41363}, 'accuracy': 0.4074980848055979, 'macro avg': {'precision': 0.39339901822389844, 'recall': 0.40935787155875253, 'f1-score': 0.33337570842569786, 'support': 126619}, 'weighted avg': {'precision': 0.39335285075663223, 'recall': 0.4074980848055979, 'f1-score': 0.33211031143378117, 'support': 126619}}
[[24801   402 17513]
 [20385   529 21626]
 [14572   524 26267]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/AAL
Evaluating performance on  test set...
3870/3870 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0883605
{'0': {'precision': 0.4162033626578835, 'recall': 0.536358678558753, 'f1-score': 0.4687028790728871, 'support': 346561}, '1': {'precision': 0.36681734471789723, 'recall': 0.006827884944996728, 'f1-score': 0.01340622829748243, 'support': 320890}, '2': {'precision': 0.3729534853468622, 'recall': 0.6208641795800682, 'f1-score': 0.46598781219778657, 'support': 323243}, 'accuracy': 0.3924138028493157, 'macro avg': {'precision': 0.3853247309075476, 'recall': 0.38801691436127267, 'f1-score': 0.3160323065227187, 'support': 990694}, 'weighted avg': {'precision': 0.38609547930701166, 'recall': 0.3924138028493157, 'f1-score': 0.3203444872493495, 'support': 990694}}
[[185881   1854 158826]
 [140105   2191 178594]
 [120625   1928 200690]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0906075
{'0': {'precision': 0.3859095982142857, 'recall': 0.5350690548957406, 'f1-score': 0.44841057562936665, 'support': 129245}, '1': {'precision': 0.3690506490201069, 'recall': 0.009805048585706268, 'f1-score': 0.01910257423655574, 'support': 147883}, '2': {'precision': 0.36153298151837043, 'recall': 0.6304299662926682, 'f1-score': 0.45953576361953263, 'support': 126382}, 'accuracy': 0.37243190998983916, 'macro avg': {'precision': 0.3721644095842544, 'recall': 0.39176802325803833, 'f1-score': 0.30901630449515166, 'support': 403510}, 'weighted avg': {'precision': 0.3720960184890102, 'recall': 0.37243190998983916, 'f1-score': 0.29455730889149173, 'support': 403510}}
[[69155  1160 58930]
 [64657  1450 81776]
 [45388  1319 79675]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899632
{'0': {'precision': 0.38219826260199524, 'recall': 0.5483050669356703, 'f1-score': 0.4504255649741899, 'support': 47583}, '1': {'precision': 0.37072743207712533, 'recall': 0.007425612218028614, 'f1-score': 0.014559597976112622, 'support': 56965}, '2': {'precision': 0.37054708136020753, 'recall': 0.6368451188090467, 'f1-score': 0.46849896200018054, 'support': 48902}, 'accuracy': 0.3757315086347344, 'macro avg': {'precision': 0.3744909253464426, 'recall': 0.39752526598758187, 'f1-score': 0.31116137498349433, 'support': 153450}, 'weighted avg': {'precision': 0.37422692388622386, 'recall': 0.3757315086347344, 'f1-score': 0.2943794291079111, 'support': 153450}}
[[26090   355 21138]
 [24777   423 31765]
 [17396   363 31143]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976771
{'0': {'precision': 0.3604455064138296, 'recall': 0.48096912041993956, 'f1-score': 0.41207545638121906, 'support': 211078}, '1': {'precision': 0.37081991577904383, 'recall': 0.007011972345567984, 'f1-score': 0.013763682083768143, 'support': 213492}, '2': {'precision': 0.3431827960766063, 'recall': 0.5782301853851958, 'f1-score': 0.4307268419022428, 'support': 202767}, 'accuracy': 0.3511111252803517, 'macro avg': {'precision': 0.35814940608982654, 'recall': 0.3554037593835678, 'f1-score': 0.28552199345574336, 'support': 627337}, 'weighted avg': {'precision': 0.35839644094702394, 'recall': 0.3511111252803517, 'f1-score': 0.2825525813868062, 'support': 627337}}
[[101522   1266 108290]
 [ 95888   1497 116107]
 [ 84247   1274 117246]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093542
{'0': {'precision': 0.3765943567750621, 'recall': 0.5109548155052773, 'f1-score': 0.4336045958827219, 'support': 106209}, '1': {'precision': 0.32751091703056767, 'recall': 0.010815376375097854, 'f1-score': 0.020939276099311996, 'support': 97084}, '2': {'precision': 0.3679496808111153, 'recall': 0.5664145671756828, 'f1-score': 0.44610452432893866, 'support': 103795}, 'accuracy': 0.37158404105663523, 'macro avg': {'precision': 0.357351651538915, 'recall': 0.362728253018686, 'f1-score': 0.30021613210365755, 'support': 307088}, 'weighted avg': {'precision': 0.3581550468514169, 'recall': 0.37158404105663523, 'f1-score': 0.3073679150851085, 'support': 307088}}
[[54268  1083 50858]
 [45903  1050 50131]
 [43931  1073 58791]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946277
{'0': {'precision': 0.3768224742186574, 'recall': 0.48835065799580113, 'f1-score': 0.42539809982604043, 'support': 39058}, '1': {'precision': 0.3589263420724095, 'recall': 0.015432927156583821, 'f1-score': 0.02959341224909933, 'support': 37258}, '2': {'precision': 0.3530587963115973, 'recall': 0.5866604426382558, 'f1-score': 0.44082449552263436, 'support': 36418}, 'accuracy': 0.36381215959692725, 'macro avg': {'precision': 0.36293587086755474, 'recall': 0.3634813425968802, 'f1-score': 0.2986053358659247, 'support': 112734}, 'weighted avg': {'precision': 0.3632311910784848, 'recall': 0.36381215959692725, 'f1-score': 0.2995701102996942, 'support': 112734}}
[[19074   485 19499]
 [17033   575 19650]
 [14511   542 21365]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
3337/3337 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983655
{'0': {'precision': 0.3530992680695334, 'recall': 0.5211257269708478, 'f1-score': 0.4209651149521533, 'support': 272535}, '1': {'precision': 0.40308855972265994, 'recall': 0.01172623504423697, 'f1-score': 0.022789501505639465, 'support': 327215}, '2': {'precision': 0.32628415868895755, 'recall': 0.5675412066843122, 'f1-score': 0.41435321108161616, 'support': 254267}, 'accuracy': 0.339769583041087, 'macro avg': {'precision': 0.36082399549371696, 'recall': 0.366797722899799, 'f1-score': 0.2860359425131363, 'support': 854017}, 'weighted avg': {'precision': 0.36426889191941797, 'recall': 0.339769583041087, 'f1-score': 0.2664363148049069, 'support': 854017}}
[[142025   2720 127790]
 [153201   3837 170177]
 [106998   2962 144307]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932902
{'0': {'precision': 0.36525417635357, 'recall': 0.5082840680736103, 'f1-score': 0.42505953190317314, 'support': 119929}, '1': {'precision': 0.3455901945110578, 'recall': 0.011090778492269804, 'f1-score': 0.021491834925474535, 'support': 116944}, '2': {'precision': 0.3830431646210753, 'recall': 0.5793411899437451, 'f1-score': 0.4611726733478291, 'support': 129233}, 'accuracy': 0.37454999371766645, 'macro avg': {'precision': 0.3646291784952344, 'recall': 0.3662386788365417, 'f1-score': 0.3025746800588256, 'support': 366106}, 'weighted avg': {'precision': 0.36525237258139404, 'recall': 0.37454999371766645, 'f1-score': 0.30889696929277405, 'support': 366106}}
[[60958  1158 57813]
 [52869  1297 62778]
 [53065  1298 74870]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932131
{'0': {'precision': 0.37890186200088505, 'recall': 0.5147521272660007, 'f1-score': 0.436501245073626, 'support': 43248}, '1': {'precision': 0.34377967711301044, 'recall': 0.00914049085950914, 'f1-score': 0.017807511621614973, 'support': 39604}, '2': {'precision': 0.3685127925306172, 'recall': 0.5663273625119377, 'f1-score': 0.4464910428163479, 'support': 42931}, 'accuracy': 0.3731585349371537, 'macro avg': {'precision': 0.3637314438815042, 'recall': 0.3634066602124825, 'f1-score': 0.3002665998371963, 'support': 125783}, 'weighted avg': {'precision': 0.3642974070926108, 'recall': 0.3731585349371537, 'f1-score': 0.3080810721349884, 'support': 125783}}
[[22262   316 20670]
 [18249   362 20993]
 [18243   375 24313]]
testing model on single stock: results/universal/W9/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
10303/10303 - 71s - 71s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009326
{'0': {'precision': 0.3320462025140373, 'recall': 0.5025748425865836, 'f1-score': 0.3998894323107957, 'support': 807428}, '1': {'precision': 0.39175675675675675, 'recall': 0.0028668114411388927, 'f1-score': 0.005691969983153811, 'support': 1011228}, '2': {'precision': 0.33017141818109497, 'recall': 0.5677586644909765, 'f1-score': 0.4175329172216868, 'support': 818744}, 'accuracy': 0.3312129369833927, 'macro avg': {'precision': 0.35132479248396303, 'recall': 0.357733439506233, 'f1-score': 0.27437143983854545, 'support': 2637400}, 'weighted avg': {'precision': 0.35435833412921364, 'recall': 0.3312129369833927, 'f1-score': 0.2542239989200419, 'support': 2637400}}
[[405793   2159 399476]
 [464752   2899 543577]
 [351553   2342 464849]]
Evaluating performance on  train set...
3419/3419 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962926
{'0': {'precision': 0.359181898712298, 'recall': 0.4617914013291759, 'f1-score': 0.40407431601014787, 'support': 287998}, '1': {'precision': 0.3383838383838384, 'recall': 0.0025484975275770253, 'f1-score': 0.005058894593778314, 'support': 289190}, '2': {'precision': 0.3645134403415138, 'recall': 0.6149782692598124, 'f1-score': 0.4577228014607802, 'support': 297965}, 'accuracy': 0.36219266802490535, 'macro avg': {'precision': 0.3540263924792167, 'recall': 0.3597727227055218, 'f1-score': 0.2889520040215688, 'support': 875153}, 'weighted avg': {'precision': 0.35412452215661233, 'recall': 0.36219266802490535, 'f1-score': 0.29048743605646865, 'support': 875153}}
[[132995    664 154339]
 [123331    737 165122]
 [113946    777 183242]]
Evaluating performance on  val set...
1396/1396 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977005
{'0': {'precision': 0.35667476809141463, 'recall': 0.4725020017699861, 'f1-score': 0.4064984645727814, 'support': 118645}, '1': {'precision': 0.34401508011310084, 'recall': 0.002976481717062987, 'f1-score': 0.00590189911794905, 'support': 122628}, '2': {'precision': 0.34730770583476944, 'recall': 0.5959411343787987, 'f1-score': 0.43885545228300066, 'support': 115993}, 'accuracy': 0.3514188307871446, 'macro avg': {'precision': 0.3493325180130949, 'recall': 0.35713987262194924, 'f1-score': 0.2837519386579104, 'support': 357266}, 'weighted avg': {'precision': 0.3492882665218846, 'recall': 0.3514188307871446, 'f1-score': 0.27950297226978105, 'support': 357266}}
[[56060   336 62249]
 [54606   365 67657]
 [46508   360 69125]]
training model: results/universal/W9/deepOF_L1/h500
Epoch 1/50
6697/6697 - 102s - loss: 3.2712 - accuracy500: 0.3770 - val_loss: 3.3049 - val_accuracy500: 0.3534 - 102s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 97s - loss: 3.2708 - accuracy500: 0.3771 - val_loss: 3.3037 - val_accuracy500: 0.3563 - 97s/epoch - 14ms/step
Epoch 3/50
6697/6697 - 101s - loss: 3.2708 - accuracy500: 0.3771 - val_loss: 3.3038 - val_accuracy500: 0.3580 - 101s/epoch - 15ms/step
Epoch 4/50
6697/6697 - 100s - loss: 3.2706 - accuracy500: 0.3776 - val_loss: 3.3057 - val_accuracy500: 0.3582 - 100s/epoch - 15ms/step
Epoch 5/50
6697/6697 - 102s - loss: 3.2693 - accuracy500: 0.3788 - val_loss: 3.3055 - val_accuracy500: 0.3589 - 102s/epoch - 15ms/step
Epoch 6/50
6697/6697 - 101s - loss: 3.2681 - accuracy500: 0.3801 - val_loss: 3.3051 - val_accuracy500: 0.3589 - 101s/epoch - 15ms/step
Epoch 7/50
6697/6697 - 98s - loss: 3.2678 - accuracy500: 0.3802 - val_loss: 3.3087 - val_accuracy500: 0.3590 - 98s/epoch - 15ms/step
Epoch 8/50
6697/6697 - 97s - loss: 3.2675 - accuracy500: 0.3807 - val_loss: 3.3075 - val_accuracy500: 0.3593 - 97s/epoch - 15ms/step
Epoch 9/50
6697/6697 - 101s - loss: 3.2659 - accuracy500: 0.3814 - val_loss: 3.3106 - val_accuracy500: 0.3589 - 101s/epoch - 15ms/step
Epoch 10/50
6697/6697 - 100s - loss: 3.2648 - accuracy500: 0.3819 - val_loss: 3.3107 - val_accuracy500: 0.3578 - 100s/epoch - 15ms/step
Epoch 11/50
6697/6697 - 101s - loss: 3.2636 - accuracy500: 0.3827 - val_loss: 3.3135 - val_accuracy500: 0.3575 - 101s/epoch - 15ms/step
Epoch 12/50
6697/6697 - 103s - loss: 3.2624 - accuracy500: 0.3828 - val_loss: 3.3146 - val_accuracy500: 0.3585 - 103s/epoch - 15ms/step
testing model in sample: results/universal/W9/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 104s - 104s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066139
{'0': {'precision': 0.3332200417629524, 'recall': 0.5102743636166828, 'f1-score': 0.4031648429923781, 'support': 1348794}, '1': {'precision': 0.26, 'recall': 1.633651204158019e-05, 'f1-score': 3.267097127656165e-05, 'support': 1591527}, '2': {'precision': 0.3367231477149416, 'recall': 0.5521389836582307, 'f1-score': 0.4183280398419266, 'support': 1367355}, 'accuracy': 0.3350416790863565, 'macro avg': {'precision': 0.309981063159298, 'recall': 0.35414322792898495, 'f1-score': 0.27384185126852706, 'support': 4307676}, 'weighted avg': {'precision': 0.30727990978276537, 'recall': 0.3350416790863565, 'f1-score': 0.259035557662652, 'support': 4307676}}
[[688255     36 660503]
 [764865     26 826636]
 [612347     38 754970]]
Evaluating performance on  train set...
6697/6697 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988282
{'0': {'precision': 0.36341944996474135, 'recall': 0.4927396910218322, 'f1-score': 0.41831285543620467, 'support': 575251}, '1': {'precision': 0.4186046511627907, 'recall': 3.200739726514572e-05, 'f1-score': 6.400990019789727e-05, 'support': 562370}, '2': {'precision': 0.3603402975998013, 'recall': 0.5839223565090964, 'f1-score': 0.44566150065149, 'support': 576378}, 'accuracy': 0.36174291816973053, 'macro avg': {'precision': 0.3807881329091111, 'recall': 0.35889801830939794, 'f1-score': 0.28801278866263086, 'support': 1713999}, 'weighted avg': {'precision': 0.3804904902138591, 'recall': 0.36174291816973053, 'f1-score': 0.2902804319445992, 'support': 1713999}}
[[283449      8 291794]
 [256700     18 305652]
 [239801     17 336560]]
Evaluating performance on  val set...
2631/2631 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000937
{'0': {'precision': 0.3632623339983739, 'recall': 0.4897470438557102, 'f1-score': 0.41712707700210533, 'support': 227154}, '1': {'precision': 0.41353383458646614, 'recall': 0.000243797568230074, 'f1-score': 0.00048730784565631513, 'support': 225597}, '2': {'precision': 0.3499433810387874, 'recall': 0.5826480823573239, 'f1-score': 0.4372629343043545, 'support': 220114}, 'accuracy': 0.35601792335758287, 'macro avg': {'precision': 0.37557984987454246, 'recall': 0.357546307927088, 'f1-score': 0.2849591063840387, 'support': 672865}, 'weighted avg': {'precision': 0.3757602521638684, 'recall': 0.35601792335758287, 'f1-score': 0.28402385732481467, 'support': 672865}}
[[111248     34 115872]
 [103178     55 122364]
 [ 91821     44 128249]]
testing model out of sample: results/universal/W9/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123015
{'0': {'precision': 0.3368175196659221, 'recall': 0.5089994100191083, 'f1-score': 0.40538303923023966, 'support': 681378}, '1': {'precision': 0.26732673267326734, 'recall': 3.0066513809995222e-05, 'f1-score': 6.0126265156829334e-05, 'support': 898009}, '2': {'precision': 0.3088123889595654, 'recall': 0.5774175322424678, 'f1-score': 0.40240954021746084, 'support': 631853}, 'accuracy': 0.321851540312223, 'macro avg': {'precision': 0.30431888043291827, 'recall': 0.3621490029251287, 'f1-score': 0.2692842352376191, 'support': 2211240}, 'weighted avg': {'precision': 0.300594188870219, 'recall': 0.321851540312223, 'f1-score': 0.2399272596583332, 'support': 2211240}}
[[346821     46 334511]
 [415897     27 482085]
 [266982     28 364843]]
Evaluating performance on  train set...
3947/3947 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986909
{'0': {'precision': 0.35951146344908963, 'recall': 0.5187486698021865, 'f1-score': 0.42469443023094583, 'support': 333597}, '1': {'precision': 0.23529411764705882, 'recall': 3.62219317759915e-05, 'f1-score': 7.243271302762704e-05, 'support': 331291}, '2': {'precision': 0.36820551075701435, 'recall': 0.5642062630916255, 'f1-score': 0.44560538830708035, 'support': 344686}, 'accuracy': 0.36405355129985517, 'macro avg': {'precision': 0.3210036972843876, 'recall': 0.3609970516085293, 'f1-score': 0.2901240837503513, 'support': 1009574}, 'weighted avg': {'precision': 0.32171792645455405, 'recall': 0.36405355129985517, 'f1-score': 0.29249438181024745, 'support': 1009574}}
[[173053     27 160517]
 [158103     12 173176]
 [150200     12 194474]]
Evaluating performance on  val set...
1402/1402 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012932
{'0': {'precision': 0.35682814221097287, 'recall': 0.520494325174347, 'f1-score': 0.4233951140835083, 'support': 117008}, '1': {'precision': 0.15384615384615385, 'recall': 1.6149218781541444e-05, 'f1-score': 3.2295047554457525e-05, 'support': 123845}, '2': {'precision': 0.3569889950520389, 'recall': 0.57036494360582, 'f1-score': 0.43912900898537416, 'support': 117388}, 'accuracy': 0.3569049885412334, 'macro avg': {'precision': 0.2892210970363885, 'recall': 0.36362513933298285, 'f1-score': 0.2875188060388123, 'support': 358241}, 'weighted avg': {'precision': 0.28670936140214875, 'recall': 0.3569049885412334, 'f1-score': 0.28219296840848096, 'support': 358241}}
[[60902     8 56098]
 [59343     2 64500]
 [50431     3 66954]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0924569
{'0': {'precision': 0.4110400179603749, 'recall': 0.5021771179757946, 'f1-score': 0.45206092498572553, 'support': 29167}, '1': {'precision': 0.3, 'recall': 0.00013808340237503452, 'f1-score': 0.00027603974972396027, 'support': 21726}, '2': {'precision': 0.35042541408649247, 'recall': 0.5687379989377783, 'f1-score': 0.4336557481737614, 'support': 24477}, 'accuracy': 0.37907655565875015, 'macro avg': {'precision': 0.3538218106822891, 'recall': 0.3570177334386493, 'f1-score': 0.2953309043030703, 'support': 75370}, 'weighted avg': {'precision': 0.3593467833945248, 'recall': 0.37907655565875015, 'f1-score': 0.3158531244090529, 'support': 75370}}
[[14647     4 14516]
 [10434     3 11289]
 [10553     3 13921]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101204
{'0': {'precision': 0.33571517079013674, 'recall': 0.48764098872090234, 'f1-score': 0.39766139093422054, 'support': 16668}, '1': {'precision': 0.2, 'recall': 5.8657907085875174e-05, 'f1-score': 0.00011728141675951445, 'support': 17048}, '2': {'precision': 0.35828161581626966, 'recall': 0.5537940145901545, 'f1-score': 0.4350828105961461, 'support': 17409}, 'accuracy': 0.3475794621026895, 'macro avg': {'precision': 0.29799892886880214, 'recall': 0.3471645537393809, 'f1-score': 0.27762049431570873, 'support': 51125}, 'weighted avg': {'precision': 0.2981442565569768, 'recall': 0.3475794621026895, 'f1-score': 0.27784011985042173, 'support': 51125}}
[[8128    2 8538]
 [8317    1 8730]
 [7766    2 9641]]
Evaluating performance on  val set...
53/53 - 1s - 556ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022114
{'0': {'precision': 0.351750456280073, 'recall': 0.47931268369884694, 'f1-score': 0.4057416267942584, 'support': 4423}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4694}, '2': {'precision': 0.3489869851066685, 'recall': 0.5961494384597754, 'f1-score': 0.44025050778605285, 'support': 4363}, 'accuracy': 0.3502225519287834, 'macro avg': {'precision': 0.23357914712891384, 'recall': 0.35848737405287406, 'f1-score': 0.28199737819343706, 'support': 13480}, 'weighted avg': {'precision': 0.2283696204856942, 'recall': 0.3502225519287834, 'f1-score': 0.27562375228349806, 'support': 13480}}
[[2120    0 2303]
 [2145    0 2549]
 [1762    0 2601]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020162
{'0': {'precision': 0.3453957996768982, 'recall': 0.5355353683788658, 'f1-score': 0.41994578810219074, 'support': 89826}, '1': {'precision': 0.23076923076923078, 'recall': 8.99658129910634e-05, 'f1-score': 0.0001798615066398873, 'support': 100038}, '2': {'precision': 0.3777811071990411, 'recall': 0.5761094205984069, 'f1-score': 0.45632753117699315, 'support': 96289}, 'accuracy': 0.36199865107128004, 'macro avg': {'precision': 0.31798204588172335, 'recall': 0.3705782515967546, 'f1-score': 0.29215106026194126, 'support': 286153}, 'weighted avg': {'precision': 0.31622027530921515, 'recall': 0.36199865107128004, 'f1-score': 0.28543948515993234, 'support': 286153}}
[[48105    15 41706]
 [50369     9 49660]
 [40801    15 55473]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943885
{'0': {'precision': 0.41022845613121584, 'recall': 0.5381676130299279, 'f1-score': 0.4655685028900666, 'support': 46846}, '1': {'precision': 0.7, 'recall': 0.0001719437007197072, 'f1-score': 0.00034380295179391466, 'support': 40711}, '2': {'precision': 0.3663414562146684, 'recall': 0.5957753240518483, 'f1-score': 0.453702095767336, 'support': 41660}, 'accuracy': 0.38724006903116465, 'macro avg': {'precision': 0.4921899707819614, 'recall': 0.3780382935941653, 'f1-score': 0.30653813386973217, 'support': 129217}, 'weighted avg': {'precision': 0.4873743185635483, 'recall': 0.38724006903116465, 'f1-score': 0.31516942784638063, 'support': 129217}}
[[25211     2 21633]
 [19406     7 21298]
 [16839     1 24820]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953416
{'0': {'precision': 0.38206500456859416, 'recall': 0.532085075440829, 'f1-score': 0.4447652332472269, 'support': 16503}, '1': {'precision': 0.25, 'recall': 6.601967386281111e-05, 'f1-score': 0.00013200448815259717, 'support': 15147}, '2': {'precision': 0.37455688043828556, 'recall': 0.5753356846729781, 'f1-score': 0.45372697328290834, 'support': 16161}, 'accuracy': 0.3781556545564828, 'macro avg': {'precision': 0.3355406283356266, 'recall': 0.36916225992922325, 'f1-score': 0.2995414036727626, 'support': 47811}, 'weighted avg': {'precision': 0.3376876140461116, 'recall': 0.3781556545564828, 'f1-score': 0.306930240561505, 'support': 47811}}
[[8781    2 7720]
 [7340    1 7806]
 [6862    1 9298]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100234
{'0': {'precision': 0.36664836818898194, 'recall': 0.5033548888996937, 'f1-score': 0.4242610522001946, 'support': 41134}, '1': {'precision': 0.5, 'recall': 2.26510827217541e-05, 'f1-score': 4.530011325028313e-05, 'support': 44148}, '2': {'precision': 0.3554277615764084, 'recall': 0.5851524465483589, 'f1-score': 0.44223644610232715, 'support': 44573}, 'accuracy': 0.36030957606561165, 'macro avg': {'precision': 0.4073587099217968, 'recall': 0.36284332884359144, 'f1-score': 0.288847599471924, 'support': 129855}, 'weighted avg': {'precision': 0.40813365364314685, 'recall': 0.36030957606561165, 'f1-score': 0.28620660846884294, 'support': 129855}}
[[20705     0 20429]
 [17276     1 26871]
 [18490     1 26082]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100012
{'0': {'precision': 0.36026738956318155, 'recall': 0.517294762915782, 'f1-score': 0.4247321590702742, 'support': 22608}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22152}, '2': {'precision': 0.3531461424547751, 'recall': 0.5492728750790353, 'f1-score': 0.42989696187766213, 'support': 22142}, 'accuracy': 0.35659621535978, 'macro avg': {'precision': 0.2378045106726522, 'recall': 0.3555225459982725, 'f1-score': 0.2848763736493121, 'support': 66902}, 'weighted avg': {'precision': 0.23862196988846432, 'recall': 0.35659621535978, 'f1-score': 0.2858079456840746, 'support': 66902}}
[[11695     0 10913]
 [10788     0 11364]
 [ 9979     1 12162]]
Evaluating performance on  val set...
73/73 - 1s - 582ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029012
{'0': {'precision': 0.3548847420417124, 'recall': 0.5116315872764678, 'f1-score': 0.4190809514550522, 'support': 6319}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6350}, '2': {'precision': 0.33029445666981033, 'recall': 0.5267379679144385, 'f1-score': 0.4060024473497778, 'support': 5984}, 'accuracy': 0.34230418699404924, 'macro avg': {'precision': 0.22839306623717426, 'recall': 0.3461231850636355, 'f1-score': 0.27502779960161, 'support': 18653}, 'weighted avg': {'precision': 0.22618338678355898, 'recall': 0.34230418699404924, 'f1-score': 0.27221847301697016, 'support': 18653}}
[[3233    0 3086]
 [3045    0 3305]
 [2832    0 3152]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091554
{'0': {'precision': 0.32292877522984254, 'recall': 0.532962720732505, 'f1-score': 0.40217480711336306, 'support': 45870}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 58371}, '2': {'precision': 0.33293098190689163, 'recall': 0.5223154663424163, 'f1-score': 0.40665471673223613, 'support': 50167}, 'accuracy': 0.32802704523081705, 'macro avg': {'precision': 0.21861991904557806, 'recall': 0.35175939569164044, 'f1-score': 0.2696098412818664, 'support': 154408}, 'weighted avg': {'precision': 0.2041014163069006, 'recall': 0.32802704523081705, 'f1-score': 0.2515958083557591, 'support': 154408}}
[[24447     0 21423]
 [27293     0 31078]
 [23964     0 26203]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986351
{'0': {'precision': 0.3713966320997051, 'recall': 0.5506382678609211, 'f1-score': 0.4435953524047612, 'support': 28358}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 27246}, '2': {'precision': 0.3615265219640789, 'recall': 0.5428581998446228, 'f1-score': 0.4340136054421768, 'support': 27031}, 'accuracy': 0.3665396018636171, 'macro avg': {'precision': 0.2443077180212613, 'recall': 0.3644988225685146, 'f1-score': 0.29253631928231266, 'support': 82635}, 'weighted avg': {'precision': 0.24571294376831188, 'recall': 0.3665396018636171, 'f1-score': 0.29420098955892415, 'support': 82635}}
[[15615     2 12741]
 [14072     0 13174]
 [12357     0 14674]]
Evaluating performance on  val set...
112/112 - 1s - 909ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995939
{'0': {'precision': 0.3521260055431623, 'recall': 0.5392897815508851, 'f1-score': 0.4260592180598724, 'support': 9659}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9188}, '2': {'precision': 0.3603577188095587, 'recall': 0.5127242386316229, 'f1-score': 0.42324580284115365, 'support': 9588}, 'accuracy': 0.3560752593634605, 'macro avg': {'precision': 0.23749457478424033, 'recall': 0.35067134006083595, 'f1-score': 0.28310167363367533, 'support': 28435}, 'weighted avg': {'precision': 0.24112167735141388, 'recall': 0.3560752593634605, 'f1-score': 0.2874410671665655, 'support': 28435}}
[[5209    0 4450]
 [4912    0 4276]
 [4672    0 4916]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968647
{'0': {'precision': 0.38396247487156576, 'recall': 0.42601526616660607, 'f1-score': 0.40389721258448785, 'support': 60526}, '1': {'precision': 0.3333333333333333, 'recall': 2.050524934383202e-05, 'f1-score': 4.1007976051341986e-05, 'support': 48768}, '2': {'precision': 0.32758693943449535, 'recall': 0.5929821188233032, 'f1-score': 0.4220285174744793, 'support': 52010}, 'accuracy': 0.35105763031294945, 'macro avg': {'precision': 0.3482942492131314, 'recall': 0.339672630079751, 'f1-score': 0.2753222460116728, 'support': 161304}, 'weighted avg': {'precision': 0.35047803820156037, 'recall': 0.35105763031294945, 'f1-score': 0.28764311957367733, 'support': 161304}}
[[25785     1 34740]
 [20202     1 28565]
 [21168     1 30841]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007355
{'0': {'precision': 0.3411684352562928, 'recall': 0.5156092648539778, 'f1-score': 0.41063068301436606, 'support': 39720}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 40254}, '2': {'precision': 0.36351006429517624, 'recall': 0.5363109850561288, 'f1-score': 0.4333182487795954, 'support': 41957}, 'accuracy': 0.35251084629831625, 'macro avg': {'precision': 0.234892833183823, 'recall': 0.35064008330336893, 'f1-score': 0.2813163105979872, 'support': 121931}, 'weighted avg': {'precision': 0.23622378243443143, 'recall': 0.35251084629831625, 'f1-score': 0.28287297318463805, 'support': 121931}}
[[20480     0 19240]
 [20094     0 20160]
 [19455     0 22502]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016759
{'0': {'precision': 0.3537826216526885, 'recall': 0.5271839116919368, 'f1-score': 0.42341791501070003, 'support': 15763}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15999}, '2': {'precision': 0.349354314547165, 'recall': 0.5405941904320783, 'f1-score': 0.42442660848333724, 'support': 15113}, 'accuracy': 0.35157333333333335, 'macro avg': {'precision': 0.23437897873328448, 'recall': 0.3559260340413384, 'f1-score': 0.2826148411646791, 'support': 46875}, 'weighted avg': {'precision': 0.2316046340450695, 'recall': 0.35157333333333335, 'f1-score': 0.2792255131375433, 'support': 46875}}
[[8310    0 7453]
 [8236    0 7763]
 [6943    0 8170]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/EXC
Evaluating performance on  test set...
2354/2354 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003505
{'0': {'precision': 0.36762844145184403, 'recall': 0.5391666284105342, 'f1-score': 0.43717261787824335, 'support': 196047}, '1': {'precision': 0.35714285714285715, 'recall': 2.396828516506958e-05, 'f1-score': 4.793335346534179e-05, 'support': 208609}, '2': {'precision': 0.36821877779189427, 'recall': 0.5863282790989369, 'f1-score': 0.45235503217171774, 'support': 197722}, 'accuracy': 0.36793674403779686, 'macro avg': {'precision': 0.36433002546219856, 'recall': 0.37517295859821204, 'f1-score': 0.29652519446780884, 'support': 602378}, 'weighted avg': {'precision': 0.3641909573882062, 'recall': 0.36793674403779686, 'f1-score': 0.29077576076344985, 'support': 602378}}
[[105702      4  90341]
 [100035      5 108569]
 [ 81787      5 115930]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963874
{'0': {'precision': 0.3793659287877206, 'recall': 0.550503806962385, 'f1-score': 0.4491863322360796, 'support': 105596}, '1': {'precision': 0.2, 'recall': 1.8952854773750296e-05, 'f1-score': 3.7902117780831004e-05, 'support': 105525}, '2': {'precision': 0.3865621849949599, 'recall': 0.5922323849795468, 'f1-score': 0.4677889554872227, 'support': 108785}, 'accuracy': 0.38310941339018334, 'macro avg': {'precision': 0.3219760379275602, 'recall': 0.38091838159890185, 'f1-score': 0.30567106328036103, 'support': 319906}, 'weighted avg': {'precision': 0.3226469397602572, 'recall': 0.38310941339018334, 'f1-score': 0.30735497640699894, 'support': 319906}}
[[58131     4 47461]
 [50746     2 54777]
 [44355     4 64426]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097789
{'0': {'precision': 0.385795418491021, 'recall': 0.5683602879311956, 'f1-score': 0.45961218627154526, 'support': 42788}, '1': {'precision': 0.3333333333333333, 'recall': 4.674316965433426e-05, 'f1-score': 9.34732316032996e-05, 'support': 42787}, '2': {'precision': 0.37068436698806173, 'recall': 0.5741886755676835, 'f1-score': 0.4505214058363044, 'support': 41044}, 'accuracy': 0.37820548258950076, 'macro avg': {'precision': 0.3632710396041387, 'recall': 0.38086523555617785, 'f1-score': 0.30340902177981766, 'support': 126619}, 'weighted avg': {'precision': 0.3631691678056622, 'recall': 0.37820548258950076, 'f1-score': 0.3013851495154184, 'support': 126619}}
[[24319     4 18465]
 [21240     2 21545]
 [17477     0 23567]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/AAL
Evaluating performance on  test set...
3870/3870 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000208
{'0': {'precision': 0.3808823434546733, 'recall': 0.5237755889562752, 'f1-score': 0.44104377272048206, 'support': 338183}, '1': {'precision': 0.2028985507246377, 'recall': 4.1571522319453394e-05, 'f1-score': 8.312601309828464e-05, 'support': 336769}, '2': {'precision': 0.349947104846566, 'recall': 0.58250406977849, 'f1-score': 0.43722527962344443, 'support': 315742}, 'accuracy': 0.36445865221753637, 'macro avg': {'precision': 0.311242666341959, 'recall': 0.3687737434190282, 'f1-score': 0.2927840594523416, 'support': 990694}, 'weighted avg': {'precision': 0.31052057887095486, 'recall': 0.36445865221753637, 'f1-score': 0.28992997302204465, 'support': 990694}}
[[177132     35 161016]
 [156124     14 180631]
 [131801     20 183921]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971887
{'0': {'precision': 0.382123003434895, 'recall': 0.5378893402273871, 'f1-score': 0.44681985327525736, 'support': 137123}, '1': {'precision': 0.21875, 'recall': 5.289645895990448e-05, 'f1-score': 0.00010576734206669386, 'support': 132334}, '2': {'precision': 0.3683852911968602, 'recall': 0.5783533378589065, 'f1-score': 0.4500859186327327, 'support': 134053}, 'accuracy': 0.374944858863473, 'macro avg': {'precision': 0.32308609821058504, 'recall': 0.3720985248484179, 'f1-score': 0.2990038464166856, 'support': 403510}, 'weighted avg': {'precision': 0.3239797490540899, 'recall': 0.374944858863473, 'f1-score': 0.301401806662987, 'support': 403510}}
[[73757    15 63351]
 [62749     7 69578]
 [56513    10 77530]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098539
{'0': {'precision': 0.3692504963600265, 'recall': 0.5346042519213494, 'f1-score': 0.43680223122905165, 'support': 50095}, '1': {'precision': 0.3, 'recall': 5.800576190568263e-05, 'f1-score': 0.00011598909702487967, 'support': 51719}, '2': {'precision': 0.3766190429108167, 'recall': 0.59015028274847, 'f1-score': 0.4598032410900202, 'support': 51636}, 'accuracy': 0.37313131313131315, 'macro avg': {'precision': 0.34862317975694773, 'recall': 0.3749375134772417, 'f1-score': 0.2989071538053656, 'support': 153450}, 'weighted avg': {'precision': 0.3483897329090809, 'recall': 0.37313131313131315, 'f1-score': 0.297360747933872, 'support': 153450}}
[[26781     7 23307]
 [24584     3 27132]
 [21163     0 30473]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096038
{'0': {'precision': 0.3658521424427439, 'recall': 0.47689399054692777, 'f1-score': 0.4140575229712776, 'support': 222150}, '1': {'precision': 0.1, 'recall': 5.266872425816102e-06, 'f1-score': 1.0533190081948217e-05, 'support': 189866}, '2': {'precision': 0.358030028038407, 'recall': 0.561603373567836, 'f1-score': 0.43728483814042296, 'support': 215321}, 'accuracy': 0.3616365685429044, 'macro avg': {'precision': 0.2746273901603836, 'recall': 0.3461675436623965, 'f1-score': 0.2837842981005942, 'support': 627337}, 'weighted avg': {'precision': 0.28270616448721086, 'recall': 0.3616365685429044, 'f1-score': 0.2967168957928058, 'support': 627337}}
[[105942      3 116205]
 [ 89244      1 100621]
 [ 94390      6 120925]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994216
{'0': {'precision': 0.35962866080578176, 'recall': 0.508096317604252, 'f1-score': 0.42116108860939383, 'support': 104986}, '1': {'precision': 0.6666666666666666, 'recall': 7.97257434425576e-05, 'f1-score': 0.0001594324205827255, 'support': 100344}, '2': {'precision': 0.34724846927205383, 'recall': 0.5417264490261208, 'f1-score': 0.42321482038801417, 'support': 101758}, 'accuracy': 0.35324076486218936, 'macro avg': {'precision': 0.45784793224816744, 'recall': 0.3499674974579385, 'f1-score': 0.2815117804726636, 'support': 307088}, 'weighted avg': {'precision': 0.4558539712380212, 'recall': 0.35324076486218936, 'f1-score': 0.28427522348186945, 'support': 307088}}
[[53343     1 51642]
 [48355     8 51981]
 [46630     3 55125]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972755
{'0': {'precision': 0.3738050432818969, 'recall': 0.4975453361386635, 'f1-score': 0.4268890226080977, 'support': 39924}, '1': {'precision': 0.5714285714285714, 'recall': 0.0008956560680698612, 'f1-score': 0.001788508830762352, 'support': 35728}, '2': {'precision': 0.3488528334844973, 'recall': 0.5601100264279165, 'f1-score': 0.4299316911612503, 'support': 37082}, 'accuracy': 0.3607252470417088, 'macro avg': {'precision': 0.4313621493983219, 'recall': 0.35285033954488326, 'f1-score': 0.28620307420003677, 'support': 112734}, 'weighted avg': {'precision': 0.4282288690125302, 'recall': 0.3607252470417088, 'f1-score': 0.29316571889361376, 'support': 112734}}
[[19864     8 20052]
 [16980    32 18716]
 [16296    16 20770]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
3337/3337 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1330664
{'0': {'precision': 0.268195839399847, 'recall': 0.5117578919611241, 'f1-score': 0.3519473832492981, 'support': 212368}, '1': {'precision': 0.1875, 'recall': 6.717450593150887e-06, 'f1-score': 1.3434419879358908e-05, 'support': 446598}, '2': {'precision': 0.2455818223548313, 'recall': 0.5650317096554235, 'f1-score': 0.3423617086710302, 'support': 195051}, 'accuracy': 0.25631105703984813, 'macro avg': {'precision': 0.23375922058489276, 'recall': 0.35893210635571354, 'f1-score': 0.23144084211340255, 'support': 854017}, 'weighted avg': {'precision': 0.22083204321904473, 'recall': 0.25631105703984813, 'f1-score': 0.1657184286834212, 'support': 854017}}
[[108681      9 103678]
 [211712      3 234883]
 [ 84837      4 110210]]
Evaluating performance on  train set...
1431/1431 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990934
{'0': {'precision': 0.3436641683348075, 'recall': 0.502715402032721, 'f1-score': 0.4082453702743618, 'support': 117478}, '1': {'precision': 0.2857142857142857, 'recall': 5.020794457042919e-05, 'f1-score': 0.0001003982463772966, 'support': 119503}, '2': {'precision': 0.3739297868068391, 'recall': 0.56248596321394, 'f1-score': 0.4492240894106296, 'support': 129125}, 'accuracy': 0.35971822368385115, 'macro avg': {'precision': 0.33443608028531074, 'recall': 0.35508385773041046, 'f1-score': 0.2858566193104562, 'support': 366106}, 'weighted avg': {'precision': 0.3354230118457056, 'recall': 0.35971822368385115, 'f1-score': 0.28947328928199983, 'support': 366106}}
[[59058     7 58413]
 [56304     6 63193]
 [56486     8 72631]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042144
{'0': {'precision': 0.344558709109976, 'recall': 0.5041328449811918, 'f1-score': 0.40934391640711343, 'support': 40408}, '1': {'precision': 0.4, 'recall': 4.436262005634053e-05, 'f1-score': 8.871540099361248e-05, 'support': 45083}, '2': {'precision': 0.3412596015362458, 'recall': 0.5645537575697409, 'f1-score': 0.4253842989116206, 'support': 40292}, 'accuracy': 0.3428126217374367, 'macro avg': {'precision': 0.3619394368820739, 'recall': 0.35624365505699634, 'f1-score': 0.2782723102399092, 'support': 125783}, 'weighted avg': {'precision': 0.36337311228714797, 'recall': 0.3428126217374367, 'f1-score': 0.2677973390867498, 'support': 125783}}
[[20371     3 20034]
 [21206     2 23875]
 [17545     0 22747]]
testing model on single stock: results/universal/W9/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
10303/10303 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1109098
{'0': {'precision': 0.31711677010333184, 'recall': 0.507495902005407, 'f1-score': 0.39032982811937594, 'support': 794901}, '1': {'precision': 0.30612244897959184, 'recall': 1.449775429785926e-05, 'f1-score': 2.8994135452869065e-05, 'support': 1034643}, '2': {'precision': 0.32000987375076545, 'recall': 0.5408005882236439, 'f1-score': 0.4020897412534767, 'support': 807856}, 'accuracy': 0.31861416546598925, 'macro avg': {'precision': 0.3144163642778964, 'recall': 0.3494369959944496, 'f1-score': 0.2641495211694352, 'support': 2637400}, 'weighted avg': {'precision': 0.3136899155305599, 'recall': 0.31861416546598925, 'f1-score': 0.24081829805538643, 'support': 2637400}}
[[403409     16 391476]
 [497757     15 536871]
 [370949     18 436889]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001625
{'0': {'precision': 0.35038541836089876, 'recall': 0.4539788920940355, 'f1-score': 0.3955112924973514, 'support': 289465}, '1': {'precision': 0.4117647058823529, 'recall': 2.4259731618054787e-05, 'f1-score': 4.8516604807995536e-05, 'support': 288544}, '2': {'precision': 0.3554427311938475, 'recall': 0.5982049107503433, 'f1-score': 0.445924842549167, 'support': 297144}, 'accuracy': 0.35327651279262023, 'macro avg': {'precision': 0.37253095181236634, 'recall': 0.3507360208586656, 'f1-score': 0.28049488388377547, 'support': 875153}, 'weighted avg': {'precision': 0.37233972269742527, 'recall': 0.35327651279262023, 'f1-score': 0.2822415816118932, 'support': 875153}}
[[131411      7 158047]
 [124248      7 164289]
 [119388      3 177753]]
Evaluating performance on  val set...
1396/1396 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025652
{'0': {'precision': 0.3496840933643238, 'recall': 0.45154717619208656, 'f1-score': 0.39414054572625135, 'support': 118280}, '1': {'precision': 0.21621621621621623, 'recall': 6.517470895419033e-05, 'f1-score': 0.00013031013812874641, 'support': 122747}, '2': {'precision': 0.3404060754838773, 'recall': 0.5988609674893969, 'f1-score': 0.4340744482170529, 'support': 116239}, 'accuracy': 0.34435966478758123, 'macro avg': {'precision': 0.30210212835480577, 'recall': 0.35015777279681254, 'f1-score': 0.2761151013604777, 'support': 357266}, 'weighted avg': {'precision': 0.30080944803926074, 'recall': 0.34435966478758123, 'f1-score': 0.27176198886355796, 'support': 357266}}
[[53409    21 64850]
 [52706     8 70033]
 [46620     8 69611]]
training model: results/universal/W9/deepOF_L1/h1000
Epoch 1/50
6697/6697 - 98s - loss: 3.2794 - accuracy1000: 0.3675 - val_loss: 3.2951 - val_accuracy1000: 0.3411 - 98s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 97s - loss: 3.2825 - accuracy1000: 0.3628 - val_loss: 3.2949 - val_accuracy1000: 0.3429 - 97s/epoch - 15ms/step
Epoch 3/50
6697/6697 - 95s - loss: 3.2808 - accuracy1000: 0.3669 - val_loss: 3.2950 - val_accuracy1000: 0.3425 - 95s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 99s - loss: 3.2804 - accuracy1000: 0.3668 - val_loss: 3.2950 - val_accuracy1000: 0.3413 - 99s/epoch - 15ms/step
Epoch 5/50
6697/6697 - 98s - loss: 3.2790 - accuracy1000: 0.3688 - val_loss: 3.2946 - val_accuracy1000: 0.3433 - 98s/epoch - 15ms/step
Epoch 6/50
6697/6697 - 94s - loss: 3.2778 - accuracy1000: 0.3702 - val_loss: 3.2943 - val_accuracy1000: 0.3450 - 94s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 97s - loss: 3.2763 - accuracy1000: 0.3717 - val_loss: 3.2944 - val_accuracy1000: 0.3446 - 97s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 96s - loss: 3.2753 - accuracy1000: 0.3731 - val_loss: 3.2942 - val_accuracy1000: 0.3450 - 96s/epoch - 14ms/step
Epoch 9/50
6697/6697 - 94s - loss: 3.2738 - accuracy1000: 0.3744 - val_loss: 3.2943 - val_accuracy1000: 0.3445 - 94s/epoch - 14ms/step
Epoch 10/50
6697/6697 - 95s - loss: 3.2735 - accuracy1000: 0.3745 - val_loss: 3.2946 - val_accuracy1000: 0.3449 - 95s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 94s - loss: 3.2725 - accuracy1000: 0.3759 - val_loss: 3.2948 - val_accuracy1000: 0.3439 - 94s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 96s - loss: 3.2721 - accuracy1000: 0.3767 - val_loss: 3.2948 - val_accuracy1000: 0.3442 - 96s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 95s - loss: 3.2714 - accuracy1000: 0.3773 - val_loss: 3.2949 - val_accuracy1000: 0.3434 - 95s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 96s - loss: 3.2707 - accuracy1000: 0.3777 - val_loss: 3.2952 - val_accuracy1000: 0.3431 - 96s/epoch - 14ms/step
Epoch 15/50
6697/6697 - 95s - loss: 3.2699 - accuracy1000: 0.3783 - val_loss: 3.2952 - val_accuracy1000: 0.3432 - 95s/epoch - 14ms/step
Epoch 16/50
6697/6697 - 96s - loss: 3.2695 - accuracy1000: 0.3788 - val_loss: 3.2950 - val_accuracy1000: 0.3436 - 96s/epoch - 14ms/step
Epoch 17/50
6697/6697 - 92s - loss: 3.2691 - accuracy1000: 0.3790 - val_loss: 3.2948 - val_accuracy1000: 0.3439 - 92s/epoch - 14ms/step
Epoch 18/50
6697/6697 - 93s - loss: 3.2685 - accuracy1000: 0.3797 - val_loss: 3.2950 - val_accuracy1000: 0.3434 - 93s/epoch - 14ms/step
testing model in sample: results/universal/W9/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 95s - 95s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989786
{'0': {'precision': 0.3071762734608352, 'recall': 0.4792016855142575, 'f1-score': 0.3743731276097046, 'support': 1258251}, '1': {'precision': 0.40680531251209245, 'recall': 0.10742564927028764, 'f1-score': 0.16996769183924781, 'support': 1761516}, '2': {'precision': 0.31259233958515886, 'recall': 0.45620614499937495, 'f1-score': 0.3709855028539678, 'support': 1287909}, 'accuracy': 0.3202979982709935, 'macro avg': {'precision': 0.3421913085193622, 'recall': 0.34761115992797337, 'f1-score': 0.3051087741009734, 'support': 4307676}, 'weighted avg': {'precision': 0.34953636429856905, 'recall': 0.3202979982709935, 'f1-score': 0.2897738220890089, 'support': 4307676}}
[[602956 134945 520350]
 [800575 189232 771709]
 [559368 140989 587552]]
Evaluating performance on  train set...
6697/6697 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973866
{'0': {'precision': 0.35409470737149235, 'recall': 0.45973743813292434, 'f1-score': 0.4000593845368423, 'support': 574417}, '1': {'precision': 0.3314198628397257, 'recall': 0.1039118246687054, 'f1-score': 0.15821702700408638, 'support': 565056}, '2': {'precision': 0.3541657712232726, 'recall': 0.48763676491577407, 'f1-score': 0.4103201012326006, 'support': 574526}, 'accuracy': 0.3517837524992722, 'macro avg': {'precision': 0.3465601138114969, 'recall': 0.3504286759058013, 'f1-score': 0.32286550425784305, 'support': 1713999}, 'weighted avg': {'precision': 0.3466432859172009, 'recall': 0.3517837524992722, 'f1-score': 0.3237702929692966, 'support': 1713999}}
[[264081  58871 251465]
 [246923  58716 259417]
 [234788  59578 280160]]
Evaluating performance on  val set...
2631/2631 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977087
{'0': {'precision': 0.347180723553614, 'recall': 0.45705889001921557, 'f1-score': 0.39461382768386394, 'support': 221175}, '1': {'precision': 0.3482730834421629, 'recall': 0.10666553198731996, 'f1-score': 0.1633131700071337, 'support': 235015}, '2': {'precision': 0.3405572255604382, 'recall': 0.4867889696550133, 'f1-score': 0.40075001709765423, 'support': 216675}, 'accuracy': 0.34424884635105113, 'macro avg': {'precision': 0.34533701085207175, 'recall': 0.3501711305538496, 'f1-score': 0.31955900492955064, 'support': 672865}, 'weighted avg': {'precision': 0.3454293685738423, 'recall': 0.34424884635105113, 'f1-score': 0.3158022306730761, 'support': 672865}}
[[101090  23669  96416]
 [102125  25068 107822]
 [ 87959  23241 105475]]
testing model out of sample: results/universal/W9/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 59s - 59s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983282
{'0': {'precision': 0.3268260675467971, 'recall': 0.4826979922000838, 'f1-score': 0.38975564642961996, 'support': 677956}, '1': {'precision': 0.4271376677615122, 'recall': 0.10556726924363026, 'f1-score': 0.16929355838217267, 'support': 930061}, '2': {'precision': 0.29088016945486306, 'recall': 0.47260631640371803, 'f1-score': 0.36011588403259764, 'support': 603223}, 'accuracy': 0.32132152095656735, 'macro avg': {'precision': 0.34828130158772413, 'recall': 0.35362385928247736, 'f1-score': 0.3063883629481301, 'support': 2211240}, 'weighted avg': {'precision': 0.3592117492107447, 'recall': 0.32132152095656735, 'f1-score': 0.2889422673012052, 'support': 2211240}}
[[327248  69660 281048]
 [417928  98184 413949]
 [256115  62021 285087]]
Evaluating performance on  train set...
3947/3947 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975131
{'0': {'precision': 0.3443719202520228, 'recall': 0.47310751500131243, 'f1-score': 0.39860316088850484, 'support': 327638}, '1': {'precision': 0.3449067431850789, 'recall': 0.09806298221486678, 'f1-score': 0.15270833144277973, 'support': 343208}, '2': {'precision': 0.3534693294304099, 'recall': 0.48197668926099996, 'f1-score': 0.4078395811162571, 'support': 338728}, 'accuracy': 0.3485856410723731, 'macro avg': {'precision': 0.34758266428917056, 'recall': 0.3510490621590597, 'f1-score': 0.3197170244825139, 'support': 1009574}, 'weighted avg': {'precision': 0.34760605932987637, 'recall': 0.3485856410723731, 'f1-score': 0.3181093699692633, 'support': 1009574}}
[[155008  30944 141686]
 [152621  33656 156931]
 [142489  32980 163259]]
Evaluating performance on  val set...
1402/1402 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970516
{'0': {'precision': 0.35705050103190195, 'recall': 0.4797774770711171, 'f1-score': 0.40941458233839184, 'support': 119718}, '1': {'precision': 0.3208359494125034, 'recall': 0.09172030052052617, 'f1-score': 0.14265773310999444, 'support': 116997}, '2': {'precision': 0.3600771079633493, 'recall': 0.48570676233892335, 'f1-score': 0.41356164959432756, 'support': 121526}, 'accuracy': 0.3550542791026153, 'macro avg': {'precision': 0.34598785280258487, 'recall': 0.35240151331018893, 'f1-score': 0.3218779883475713, 'support': 358241}, 'weighted avg': {'precision': 0.34624999952073016, 'recall': 0.3550542791026153, 'f1-score': 0.3237019626387205, 'support': 358241}}
[[57438 11242 51038]
 [52404 10731 53862]
 [51026 11474 59026]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981193
{'0': {'precision': 0.4050820817324485, 'recall': 0.4699625164623645, 'f1-score': 0.4351170098016226, 'support': 29613}, '1': {'precision': 0.2925194494314782, 'recall': 0.10629784272790536, 'f1-score': 0.15593198711200434, 'support': 22992}, '2': {'precision': 0.3102360758137114, 'recall': 0.4450691851526466, 'f1-score': 0.3656177829099307, 'support': 22765}, 'accuracy': 0.3515059042059175, 'macro avg': {'precision': 0.335945868992546, 'recall': 0.3404431814476388, 'f1-score': 0.31888892660785256, 'support': 75370}, 'weighted avg': {'precision': 0.342096684802583, 'recall': 0.3515059042059175, 'f1-score': 0.32895843288946836, 'support': 75370}}
[[13917  3277 12419]
 [10440  2444 10108]
 [ 9999  2634 10132]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983671
{'0': {'precision': 0.33189583678885387, 'recall': 0.48671328671328673, 'f1-score': 0.39466482581790385, 'support': 16445}, '1': {'precision': 0.3153259949195597, 'recall': 0.11366827422013308, 'f1-score': 0.16710042178946422, 'support': 16381}, '2': {'precision': 0.3752843062926459, 'recall': 0.4328105360948686, 'f1-score': 0.4019998477273304, 'support': 18299}, 'accuracy': 0.3478924205378973, 'macro avg': {'precision': 0.34083537933368646, 'recall': 0.34439736567609613, 'f1-score': 0.3212550317782328, 'support': 51125}, 'weighted avg': {'precision': 0.34211657075049656, 'recall': 0.3478924205378973, 'f1-score': 0.3243761424639816, 'support': 51125}}
[[8004 1958 6483]
 [7818 1862 6701]
 [8294 2085 7920]]
Evaluating performance on  val set...
53/53 - 0s - 489ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972178
{'0': {'precision': 0.32744248082694233, 'recall': 0.4600609041930194, 'f1-score': 0.38258498100711014, 'support': 4269}, '1': {'precision': 0.33375235700817096, 'recall': 0.1157619359058208, 'f1-score': 0.17190029135642604, 'support': 4587}, '2': {'precision': 0.350874214904091, 'recall': 0.44701557093425603, 'f1-score': 0.39315263908701853, 'support': 4624}, 'accuracy': 0.3384272997032641, 'macro avg': {'precision': 0.33735635091306815, 'recall': 0.34094613701103205, 'f1-score': 0.31587930381685153, 'support': 13480}, 'weighted avg': {'precision': 0.33762732803881407, 'recall': 0.3384272997032641, 'f1-score': 0.31451778364314936, 'support': 13480}}
[[1964  490 1815]
 [2047  531 2009]
 [1987  570 2067]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971497
{'0': {'precision': 0.3407709429518552, 'recall': 0.5475435296176393, 'f1-score': 0.4200920522104698, 'support': 91432}, '1': {'precision': 0.325081103467317, 'recall': 0.1485464963465279, 'f1-score': 0.20391404118979922, 'support': 95115}, '2': {'precision': 0.3798640620595329, 'recall': 0.3652691604923398, 'f1-score': 0.37242367633134577, 'support': 99606}, 'accuracy': 0.35147281349487863, 'macro avg': {'precision': 0.34857203615956833, 'recall': 0.35378639548550234, 'f1-score': 0.33214325657720495, 'support': 286153}, 'weighted avg': {'precision': 0.34916355158872947, 'recall': 0.35147281349487863, 'f1-score': 0.33164346783062015, 'support': 286153}}
[[50063 13541 27828]
 [49418 14129 31568]
 [47430 15793 36383]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961552
{'0': {'precision': 0.3807551207581779, 'recall': 0.5404074371379602, 'f1-score': 0.44674611928654057, 'support': 46093}, '1': {'precision': 0.3272996849323531, 'recall': 0.12482917864379624, 'f1-score': 0.1807296730287059, 'support': 42442}, '2': {'precision': 0.34959042218021424, 'recall': 0.40912442849417435, 'f1-score': 0.3770217007203371, 'support': 40682}, 'accuracy': 0.36257613162354796, 'macro avg': {'precision': 0.35254840929024844, 'recall': 0.35812034809197696, 'f1-score': 0.3348324976785279, 'support': 129217}, 'weighted avg': {'precision': 0.35338567343415417, 'recall': 0.36257613162354796, 'f1-score': 0.3374199562570219, 'support': 129217}}
[[24909  5700 15484]
 [21662  5298 15482]
 [18849  5189 16644]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957378
{'0': {'precision': 0.3705890012587352, 'recall': 0.5201023391812866, 'f1-score': 0.43279685717906474, 'support': 16416}, '1': {'precision': 0.32410936205468105, 'recall': 0.125071935545751, 'f1-score': 0.18049275629786843, 'support': 15639}, '2': {'precision': 0.36836206436462615, 'recall': 0.43805534399593804, 'f1-score': 0.40019714144898966, 'support': 15756}, 'accuracy': 0.36384932337746545, 'macro avg': {'precision': 0.3543534758926808, 'recall': 0.36107653957432523, 'f1-score': 0.337828918308641, 'support': 47811}, 'weighted avg': {'precision': 0.3546516082902596, 'recall': 0.36384932337746545, 'f1-score': 0.33952491233950705, 'support': 47811}}
[[8538 2117 5761]
 [7609 1956 6074]
 [6892 1962 6902]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096351
{'0': {'precision': 0.3603826043655075, 'recall': 0.4155064350987991, 'f1-score': 0.38598635525233893, 'support': 41802}, '1': {'precision': 0.27875477880939376, 'recall': 0.06501248280430019, 'f1-score': 0.10543493978392446, 'support': 39254}, '2': {'precision': 0.38320644378241203, 'recall': 0.5693559294247833, 'f1-score': 0.45809254511430064, 'support': 48799}, 'accuracy': 0.3673712987563051, 'macro avg': {'precision': 0.34078127565243777, 'recall': 0.3499582824426275, 'f1-score': 0.31650461338352137, 'support': 129855}, 'weighted avg': {'precision': 0.34428435535950724, 'recall': 0.3673712987563051, 'f1-score': 0.3282754060880921, 'support': 129855}}
[[17369  2984 21449]
 [13431  2552 23271]
 [17396  3619 27784]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975013
{'0': {'precision': 0.36652572233967584, 'recall': 0.4447009533581292, 'f1-score': 0.4018465936528172, 'support': 23391}, '1': {'precision': 0.3160134775669445, 'recall': 0.08365019011406843, 'f1-score': 0.13228416598619255, 'support': 21303}, '2': {'precision': 0.3487516345832193, 'recall': 0.5163904899135446, 'f1-score': 0.4163293459911782, 'support': 22208}, 'accuracy': 0.35353203192729665, 'macro avg': {'precision': 0.3437636114966132, 'recall': 0.34824721112858076, 'f1-score': 0.3168200352100627, 'support': 66902}, 'weighted avg': {'precision': 0.3445414873199622, 'recall': 0.35353203192729665, 'f1-score': 0.3208197867912617, 'support': 66902}}
[[10402  1966 11023]
 [ 9129  1782 10392]
 [ 8849  1891 11468]]
Evaluating performance on  val set...
73/73 - 1s - 572ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982807
{'0': {'precision': 0.3675488180883864, 'recall': 0.44028931979070485, 'f1-score': 0.40064416748354564, 'support': 6498}, '1': {'precision': 0.3088344469190794, 'recall': 0.0701636026311351, 'f1-score': 0.11434854315557998, 'support': 5929}, '2': {'precision': 0.33973955051459775, 'recall': 0.5195952457436557, 'f1-score': 0.4108458216916434, 'support': 6226}, 'accuracy': 0.3491127432584571, 'macro avg': {'precision': 0.3387076051740212, 'recall': 0.3433493893884985, 'f1-score': 0.30861284411025636, 'support': 18653}, 'weighted avg': {'precision': 0.3396038222926844, 'recall': 0.3491127432584571, 'f1-score': 0.3130480029233735, 'support': 18653}}
[[2861  488 3149]
 [2375  416 3138]
 [2548  443 3235]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001065
{'0': {'precision': 0.3042340557641702, 'recall': 0.4466801241561937, 'f1-score': 0.36194630341297834, 'support': 46071}, '1': {'precision': 0.38094017094017096, 'recall': 0.07531515090067255, 'f1-score': 0.1257653997008945, 'support': 59178}, '2': {'precision': 0.32408813577385237, 'recall': 0.4948839480054517, 'f1-score': 0.39167639364057155, 'support': 49159}, 'accuracy': 0.3196984612196259, 'macro avg': {'precision': 0.3364207874927312, 'recall': 0.3389597410207727, 'f1-score': 0.2931293655848148, 'support': 154408}, 'weighted avg': {'precision': 0.33995319727938533, 'recall': 0.3196984612196259, 'f1-score': 0.2808934304117385, 'support': 154408}}
[[20579  3612 21880]
 [25863  4457 28858]
 [21200  3631 24328]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972326
{'0': {'precision': 0.35733014280986686, 'recall': 0.5001781641961232, 'f1-score': 0.4168559846763776, 'support': 28064}, '1': {'precision': 0.3471194503171247, 'recall': 0.09614962301442061, 'f1-score': 0.15058756090570363, 'support': 27322}, '2': {'precision': 0.3497932036664431, 'recall': 0.45935630665345517, 'f1-score': 0.39715704472260566, 'support': 27249}, 'accuracy': 0.35313123978943545, 'macro avg': {'precision': 0.3514142655978116, 'recall': 0.3518946979546664, 'f1-score': 0.32153353010156227, 'support': 82635}, 'weighted avg': {'precision': 0.35146881776592837, 'recall': 0.35313123978943545, 'f1-score': 0.3223226478449782, 'support': 82635}}
[[14037  2426 11601]
 [13029  2627 11666]
 [12217  2515 12517]]
Evaluating performance on  val set...
112/112 - 1s - 732ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970261
{'0': {'precision': 0.3550908008335814, 'recall': 0.4972381448671183, 'f1-score': 0.41431114584690204, 'support': 9595}, '1': {'precision': 0.3327915481511581, 'recall': 0.08613798906184265, 'f1-score': 0.13685353830729383, 'support': 9508}, '2': {'precision': 0.3565161907800287, 'recall': 0.4789969995713673, 'f1-score': 0.40877914951989025, 'support': 9332}, 'accuracy': 0.35378934411816426, 'macro avg': {'precision': 0.34813284658825605, 'recall': 0.3541243778334427, 'f1-score': 0.31998127789136205, 'support': 28435}, 'weighted avg': {'precision': 0.34810224604109913, 'recall': 0.35378934411816426, 'f1-score': 0.3197202711428307, 'support': 28435}}
[[4771  884 3940]
 [4561  819 4128]
 [4104  758 4470]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098245
{'0': {'precision': 0.3904931511409217, 'recall': 0.3832032143207134, 'f1-score': 0.38681383903914796, 'support': 61226}, '1': {'precision': 0.2984462667242123, 'recall': 0.08565942687257412, 'f1-score': 0.13311302897109306, 'support': 48436}, '2': {'precision': 0.3297106013582382, 'recall': 0.5574919639053484, 'f1-score': 0.41436086383949455, 'support': 51642}, 'accuracy': 0.34965654912463423, 'macro avg': {'precision': 0.33955000640779076, 'recall': 0.34211820169954527, 'f1-score': 0.31142924394991184, 'support': 161304}, 'weighted avg': {'precision': 0.3433937901239284, 'recall': 0.34965654912463423, 'f1-score': 0.3194524036022288, 'support': 161304}}
[[23462  5405 32359]
 [18117  4149 26170]
 [18504  4348 28790]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983348
{'0': {'precision': 0.3346834403464238, 'recall': 0.44988333291517174, 'f1-score': 0.3838258431175281, 'support': 39857}, '1': {'precision': 0.3242619482642562, 'recall': 0.08454518102497242, 'f1-score': 0.13412087584273014, 'support': 39884}, '2': {'precision': 0.35663261784802264, 'recall': 0.48990282057359563, 'f1-score': 0.4127773450761888, 'support': 42190}, 'accuracy': 0.3442274729150093, 'macro avg': {'precision': 0.33852600215290085, 'recall': 0.34144377817124655, 'f1-score': 0.3102413546788157, 'support': 121931}, 'weighted avg': {'precision': 0.3388692914309493, 'recall': 0.3442274729150093, 'f1-score': 0.3121642554396435, 'support': 121931}}
[[17931  3448 18478]
 [17703  3372 18809]
 [17942  3579 20669]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975224
{'0': {'precision': 0.34899779418816534, 'recall': 0.4724133454498247, 'f1-score': 0.40143408714837286, 'support': 15406}, '1': {'precision': 0.3508397760597174, 'recall': 0.08160228188751782, 'f1-score': 0.13240768689002916, 'support': 16127}, '2': {'precision': 0.3459811405478222, 'recall': 0.5022161387042107, 'f1-score': 0.40970966712751244, 'support': 15342}, 'accuracy': 0.347712, 'macro avg': {'precision': 0.3486062369319016, 'recall': 0.3520772553471844, 'f1-score': 0.3145171470553048, 'support': 46875}, 'weighted avg': {'precision': 0.348644175873336, 'recall': 0.347712, 'f1-score': 0.31158609122461073, 'support': 46875}}
[[7278 1225 6903]
 [7149 1316 7662]
 [6427 1210 7705]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
2354/2354 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985361
{'0': {'precision': 0.27012752070659596, 'recall': 0.5245780808707033, 'f1-score': 0.3566175351510823, 'support': 145170}, '1': {'precision': 0.5345867277418607, 'recall': 0.11810804232533115, 'f1-score': 0.1934717260265349, 'support': 312248}, '2': {'precision': 0.2688754836426393, 'recall': 0.4664459161147903, 'f1-score': 0.34111851315593655, 'support': 144960}, 'accuracy': 0.29989143029791926, 'macro avg': {'precision': 0.3578632440303653, 'recall': 0.36971067977027494, 'f1-score': 0.29706925811118456, 'support': 602378}, 'weighted avg': {'precision': 0.40691100746334363, 'recall': 0.29989143029791926, 'f1-score': 0.26831967095959786, 'support': 602378}}
[[ 76153  15846  53171]
 [144679  36879 130690]
 [ 61083  16261  67616]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0955876
{'0': {'precision': 0.37026714459138155, 'recall': 0.48128851540616246, 'f1-score': 0.4185406373191833, 'support': 107100}, '1': {'precision': 0.32910715876362123, 'recall': 0.10601828825037303, 'f1-score': 0.16037387775181403, 'support': 104548}, '2': {'precision': 0.371025888690873, 'recall': 0.5038519093277172, 'f1-score': 0.4273559183929299, 'support': 108258}, 'accuracy': 0.36628259551243175, 'macro avg': {'precision': 0.35680006401529196, 'recall': 0.3637195709947509, 'f1-score': 0.33542347782130905, 'support': 319906}, 'weighted avg': {'precision': 0.3570724746583452, 'recall': 0.36628259551243175, 'f1-score': 0.33715268685633587, 'support': 319906}}
[[51546 11262 44292]
 [45288 11084 48176]
 [42379 11333 54546]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966741
{'0': {'precision': 0.3520582890690523, 'recall': 0.49721152897048665, 'f1-score': 0.41223045132779573, 'support': 40524}, '1': {'precision': 0.37143701078127306, 'recall': 0.10300411606905166, 'f1-score': 0.1612825651302605, 'support': 48833}, '2': {'precision': 0.32249977616617426, 'recall': 0.483334227899737, 'f1-score': 0.38686672323241, 'support': 37262}, 'accuracy': 0.34109414858749476, 'macro avg': {'precision': 0.3486650253388332, 'recall': 0.3611832909797584, 'f1-score': 0.3201265798968221, 'support': 126619}, 'weighted avg': {'precision': 0.35083344769126407, 'recall': 0.34109414858749476, 'f1-score': 0.30798352659316264, 'support': 126619}}
[[20149  4393 15982]
 [21950  5030 21853]
 [15133  4119 18010]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
3870/3870 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986458
{'0': {'precision': 0.30292240142780497, 'recall': 0.5031682635296857, 'f1-score': 0.3781731890387515, 'support': 274914}, '1': {'precision': 0.4829524727099255, 'recall': 0.10838332906497836, 'f1-score': 0.17703645412759886, 'support': 476374}, '2': {'precision': 0.2591573762355376, 'recall': 0.46238189519059675, 'f1-score': 0.33215012272184447, 'support': 239406}, 'accuracy': 0.3034801866166546, 'macro avg': {'precision': 0.34834408345775597, 'recall': 0.35797782926175364, 'f1-score': 0.2957865886293983, 'support': 990694}, 'weighted avg': {'precision': 0.37891361118154215, 'recall': 0.3034801866166546, 'f1-score': 0.27033513897361444, 'support': 990694}}
[[138328  29312 107274]
 [215572  51631 209171]
 [102745  25964 110697]]
Evaluating performance on  train set...
1577/1577 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968224
{'0': {'precision': 0.36263754743739945, 'recall': 0.4792106491255361, 'f1-score': 0.4128529946711765, 'support': 134997}, '1': {'precision': 0.35253595561749007, 'recall': 0.09686391515738219, 'f1-score': 0.1519716186654879, 'support': 138421}, '2': {'precision': 0.3448985482457078, 'recall': 0.4959951418995788, 'f1-score': 0.40687189446868616, 'support': 130092}, 'accuracy': 0.35346088077123244, 'macro avg': {'precision': 0.3533573504335325, 'recall': 0.35735656872749905, 'f1-score': 0.32389883593511687, 'support': 403510}, 'weighted avg': {'precision': 0.3534532042385959, 'recall': 0.35346088077123244, 'f1-score': 0.3214313341531576, 'support': 403510}}
[[64692 12465 57840]
 [60294 13408 64719]
 [53407 12160 64525]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964205
{'0': {'precision': 0.36291497975708503, 'recall': 0.4872509487666034, 'f1-score': 0.4159909548841095, 'support': 50592}, '1': {'precision': 0.316995991843049, 'recall': 0.0888065876049013, 'f1-score': 0.13874397919455858, 'support': 50762}, '2': {'precision': 0.36558958824189386, 'recall': 0.5003839066339066, 'f1-score': 0.42249594813614266, 'support': 52096}, 'accuracy': 0.3599022482893451, 'macro avg': {'precision': 0.34850018661400933, 'recall': 0.35881381433513715, 'f1-score': 0.3257436274049369, 'support': 153450}, 'weighted avg': {'precision': 0.34863278190196806, 'recall': 0.3599022482893451, 'f1-score': 0.3264847518766474, 'support': 153450}}
[[24651  4722 21219]
 [22237  4508 24017]
 [21037  4991 26068]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986513
{'0': {'precision': 0.33446923972610054, 'recall': 0.45924803207353443, 'f1-score': 0.3870505168296718, 'support': 204530}, '1': {'precision': 0.35310319238508414, 'recall': 0.11147453831979492, 'f1-score': 0.16945287192587166, 'support': 221961}, '2': {'precision': 0.33133765749861627, 'recall': 0.4560309889168816, 'f1-score': 0.3838106592188603, 'support': 200846}, 'accuracy': 0.3351707296078503, 'macro avg': {'precision': 0.3396366965366003, 'recall': 0.342251186436737, 'f1-score': 0.313438015991468, 'support': 627337}, 'weighted avg': {'precision': 0.34005960822354186, 'recall': 0.3351707296078503, 'f1-score': 0.30902402819247454, 'support': 627337}}
[[ 93930  22826  87774]
 [100153  24743  97065]
 [ 86750  22504  91592]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979152
{'0': {'precision': 0.35356331480898956, 'recall': 0.4812830662657481, 'f1-score': 0.40765352794915916, 'support': 105092}, '1': {'precision': 0.3309515879984256, 'recall': 0.10759387765145922, 'f1-score': 0.16239303541716185, 'support': 101595}, '2': {'precision': 0.34129492229244907, 'recall': 0.4453242497584685, 'f1-score': 0.3864307167088005, 'support': 100401}, 'accuracy': 0.3458975928724014, 'macro avg': {'precision': 0.3419366083666214, 'recall': 0.34473373122522527, 'f1-score': 0.31882576002504054, 'support': 307088}, 'weighted avg': {'precision': 0.34207150378943674, 'recall': 0.3458975928724014, 'f1-score': 0.31957443918590067, 'support': 307088}}
[[50579 11227 43286]
 [47657 10931 43007]
 [44819 10871 44711]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978382
{'0': {'precision': 0.3515835891940901, 'recall': 0.4498523518245096, 'f1-score': 0.3946933157523393, 'support': 37928}, '1': {'precision': 0.3557185012966109, 'recall': 0.10077519379844961, 'f1-score': 0.1570562804745642, 'support': 39474}, '2': {'precision': 0.3293538531175738, 'recall': 0.49425450016981776, 'f1-score': 0.3952961948525251, 'support': 35332}, 'accuracy': 0.34153848883211807, 'macro avg': {'precision': 0.34555198120275826, 'recall': 0.348294015264259, 'f1-score': 0.3156819303598095, 'support': 112734}, 'weighted avg': {'precision': 0.34606440674052186, 'recall': 0.34153848883211807, 'f1-score': 0.31167325608811086, 'support': 112734}}
[[17062  3787 17079]
 [17016  3978 18480]
 [14451  3418 17463]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983204
{'0': {'precision': 0.3329149444371261, 'recall': 0.49535319765829267, 'f1-score': 0.39820554212784176, 'support': 270401}, '1': {'precision': 0.4042050684916459, 'recall': 0.10727540414862757, 'f1-score': 0.16955197471189157, 'support': 343005}, '2': {'precision': 0.2984053659118196, 'recall': 0.447273815411598, 'f1-score': 0.35797943644824687, 'support': 240611}, 'accuracy': 0.32594081850829665, 'macro avg': {'precision': 0.3451751262801972, 'recall': 0.34996747240617276, 'f1-score': 0.30857898442932674, 'support': 854017}, 'weighted avg': {'precision': 0.3518249717583246, 'recall': 0.32594081850829665, 'f1-score': 0.29503644782974114, 'support': 854017}}
[[133944  28868 107589]
 [160770  36796 145439]
 [107623  25369 107619]]
Evaluating performance on  train set...
1431/1431 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978456
{'0': {'precision': 0.32564433300383344, 'recall': 0.478335163083897, 'f1-score': 0.38749031758326874, 'support': 112948}, '1': {'precision': 0.3502918441394542, 'recall': 0.1047249231639928, 'f1-score': 0.16124366879875102, 'support': 127219}, '2': {'precision': 0.36022791741693594, 'recall': 0.46384360682552667, 'f1-score': 0.40552163635921884, 'support': 125939}, 'accuracy': 0.3435234604185673, 'macro avg': {'precision': 0.3453880315200745, 'recall': 0.34896789769113884, 'f1-score': 0.31808520758041287, 'support': 366106}, 'weighted avg': {'precision': 0.3461057670053638, 'recall': 0.3435234604185673, 'f1-score': 0.31507406066206783, 'support': 366106}}
[[54027 11412 47509]
 [57657 13323 56239]
 [54224 13299 58416]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974836
{'0': {'precision': 0.35519471630962973, 'recall': 0.48329569529485716, 'f1-score': 0.4094598459520498, 'support': 42953}, '1': {'precision': 0.3148456716654765, 'recall': 0.10022226712467165, 'f1-score': 0.15204521505891372, 'support': 39592}, '2': {'precision': 0.36122478807366265, 'recall': 0.4572829455571488, 'f1-score': 0.4036172862187927, 'support': 43238}, 'accuracy': 0.35377594746507873, 'macro avg': {'precision': 0.34375505868292294, 'recall': 0.3469336359922259, 'f1-score': 0.32170744907658544, 'support': 125783}, 'weighted avg': {'precision': 0.3445671185212318, 'recall': 0.35377594746507873, 'f1-score': 0.32642652138459943, 'support': 125783}}
[[20759  4239 17955]
 [18615  3968 17009]
 [19070  4396 19772]]
testing model on single stock: results/universal/W9/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
10303/10303 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993015
{'0': {'precision': 0.3052456693710257, 'recall': 0.4694156524626223, 'f1-score': 0.369934811538092, 'support': 771048}, '1': {'precision': 0.40417744520063803, 'recall': 0.10178245577410919, 'f1-score': 0.16261436078935282, 'support': 1073014}, '2': {'precision': 0.311503605324657, 'recall': 0.46389433003335273, 'f1-score': 0.37272411933450983, 'support': 793338}, 'accuracy': 0.31818495487980586, 'macro avg': {'precision': 0.34030890663210694, 'recall': 0.3450308127566947, 'f1-score': 0.3017577638873182, 'support': 2637400}, 'weighted avg': {'precision': 0.34737801141380176, 'recall': 0.31818495487980586, 'f1-score': 0.28642647671170496, 'support': 2637400}}
[[361942  78701 330405]
 [480783 109214 483017]
 [343015  82298 368025]]
Evaluating performance on  train set...
3419/3419 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981072
{'0': {'precision': 0.3419674833880104, 'recall': 0.42626393768138077, 'f1-score': 0.3794908722297595, 'support': 288068}, '1': {'precision': 0.33030991927252484, 'recall': 0.09848901431441921, 'f1-score': 0.15173497795479068, 'support': 289149}, '2': {'precision': 0.352708678892381, 'recall': 0.5088844584071747, 'f1-score': 0.4166420489286131, 'support': 297936}, 'accuracy': 0.34609491140406307, 'macro avg': {'precision': 0.3416620271843054, 'recall': 0.34454580346765823, 'f1-score': 0.31595596637105444, 'support': 875153}, 'weighted avg': {'precision': 0.34177256411945006, 'recall': 0.34609491140406307, 'f1-score': 0.31688842889383617, 'support': 875153}}
[[122793  28397 136878]
 [119305  28478 141366]
 [116980  29341 151615]]
Evaluating performance on  val set...
1396/1396 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983272
{'0': {'precision': 0.3393173283261803, 'recall': 0.43353725409555144, 'f1-score': 0.3806840410484818, 'support': 116712}, '1': {'precision': 0.33655253897721726, 'recall': 0.10778950485764349, 'f1-score': 0.1632833626179172, 'support': 121561}, '2': {'precision': 0.34648638107001234, 'recall': 0.4927180590454901, 'f1-score': 0.40686175860322127, 'support': 118993}, 'accuracy': 0.342411536502214, 'macro avg': {'precision': 0.34078541612446994, 'recall': 0.34468160599956166, 'f1-score': 0.31694305408987344, 'support': 357266}, 'weighted avg': {'precision': 0.34076436368666096, 'recall': 0.342411536502214, 'f1-score': 0.31543159965829426, 'support': 357266}}
[[50599 12784 53329]
 [51204 13103 57254]
 [47317 13046 58630]]
training model: results/universal/W9/deepLOB_L2/h300
Epoch 1/50
6697/6697 - 277s - loss: 3.2414 - accuracy300: 0.4000 - val_loss: 3.3382 - val_accuracy300: 0.3359 - 277s/epoch - 41ms/step
Epoch 2/50
6697/6697 - 273s - loss: 3.2158 - accuracy300: 0.4147 - val_loss: 3.3440 - val_accuracy300: 0.3369 - 273s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 273s - loss: 3.2038 - accuracy300: 0.4211 - val_loss: 3.4063 - val_accuracy300: 0.3357 - 273s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 273s - loss: 3.1948 - accuracy300: 0.4254 - val_loss: 3.3510 - val_accuracy300: 0.3415 - 273s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 274s - loss: 3.1870 - accuracy300: 0.4290 - val_loss: 3.3586 - val_accuracy300: 0.3412 - 274s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 272s - loss: 3.1814 - accuracy300: 0.4311 - val_loss: 3.3355 - val_accuracy300: 0.3384 - 272s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 272s - loss: 3.1766 - accuracy300: 0.4329 - val_loss: 3.3430 - val_accuracy300: 0.3383 - 272s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 272s - loss: 3.1706 - accuracy300: 0.4359 - val_loss: 3.3401 - val_accuracy300: 0.3420 - 272s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 272s - loss: 3.1663 - accuracy300: 0.4376 - val_loss: 3.3444 - val_accuracy300: 0.3398 - 272s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 273s - loss: 3.1606 - accuracy300: 0.4397 - val_loss: 3.3525 - val_accuracy300: 0.3394 - 273s/epoch - 41ms/step
Epoch 11/50
6697/6697 - 273s - loss: 3.1564 - accuracy300: 0.4413 - val_loss: 3.3651 - val_accuracy300: 0.3407 - 273s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 273s - loss: 3.1526 - accuracy300: 0.4425 - val_loss: 3.3796 - val_accuracy300: 0.3387 - 273s/epoch - 41ms/step
Epoch 13/50
6697/6697 - 275s - loss: 3.1483 - accuracy300: 0.4444 - val_loss: 3.3765 - val_accuracy300: 0.3388 - 275s/epoch - 41ms/step
Epoch 14/50
6697/6697 - 273s - loss: 3.1439 - accuracy300: 0.4457 - val_loss: 3.3811 - val_accuracy300: 0.3380 - 273s/epoch - 41ms/step
Epoch 15/50
6697/6697 - 273s - loss: 3.1397 - accuracy300: 0.4473 - val_loss: 3.4103 - val_accuracy300: 0.3391 - 273s/epoch - 41ms/step
Epoch 16/50
6697/6697 - 274s - loss: 3.1352 - accuracy300: 0.4485 - val_loss: 3.3924 - val_accuracy300: 0.3395 - 274s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 229s - 229s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984876
{'0': {'precision': 0.3171024013493719, 'recall': 0.010594926477676353, 'f1-score': 0.020504754496895868, 'support': 1348570}, '1': {'precision': 0.37238649337605656, 'recall': 0.9835451480001746, 'f1-score': 0.540232143810845, 'support': 1604390}, '2': {'precision': 0.30920738500716216, 'recall': 0.005736172951778059, 'f1-score': 0.011263396208912736, 'support': 1354736}, 'accuracy': 0.3714396280517474, 'macro avg': {'precision': 0.33289875991086354, 'recall': 0.333292082476543, 'f1-score': 0.19066676483888448, 'support': 4307696}, 'weighted avg': {'precision': 0.3352098958307171, 'recall': 0.3714396280517474, 'f1-score': 0.21116951481883542, 'support': 4307696}}
[[  14288 1326772    7510]
 [  16549 1577990    9851]
 [  14221 1332744    7771]]
Evaluating performance on  train set...
6697/6697 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1157397
{'0': {'precision': 0.3507007192694807, 'recall': 0.10237853172481981, 'f1-score': 0.15848982108474138, 'support': 572454}, '1': {'precision': 0.33542766867856466, 'recall': 0.8343601011859831, 'f1-score': 0.47849271601058385, 'support': 565691}, '2': {'precision': 0.36313160945035133, 'recall': 0.08813253221269059, 'f1-score': 0.14184024526915048, 'support': 575860}, 'accuracy': 0.3391757900356183, 'macro avg': {'precision': 0.3497533324661322, 'recall': 0.34162372170783123, 'f1-score': 0.2596075941214919, 'support': 1714005}, 'weighted avg': {'precision': 0.3498364424194892, 'recall': 0.3391757900356183, 'f1-score': 0.25850991023519815, 'support': 1714005}}
[[ 58607 463438  50409]
 [ 55100 471990  38601]
 [ 53407 471701  50752]]
Evaluating performance on  val set...
2631/2631 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123846
{'0': {'precision': 0.3417904126631197, 'recall': 0.11433112418595796, 'f1-score': 0.17134591971124977, 'support': 225879}, '1': {'precision': 0.33802715333243044, 'recall': 0.8409801991029427, 'f1-score': 0.48222624248187745, 'support': 228525}, '2': {'precision': 0.3427905844720281, 'recall': 0.045128716859528344, 'f1-score': 0.07975730609768429, 'support': 218464}, 'accuracy': 0.33865334657020396, 'macro avg': {'precision': 0.3408693834891927, 'recall': 0.3334800133828097, 'f1-score': 0.24444315609693715, 'support': 672868}, 'weighted avg': {'precision': 0.34083703502518126, 'recall': 0.33865334657020396, 'f1-score': 0.24719305596484442, 'support': 672868}}
[[ 25825 190332   9722]
 [ 27160 192185   9180]
 [ 22573 186032   9859]]
testing model out of sample: results/universal/W9/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 124s - 124s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1069502
{'0': {'precision': 0.34411570636551864, 'recall': 0.06082591978893519, 'f1-score': 0.10337862546893709, 'support': 745932}, '1': {'precision': 0.35084808124815725, 'recall': 0.9373079647123768, 'f1-score': 0.5105789814660827, 'support': 768088}, '2': {'precision': 0.3631855309218203, 'recall': 0.014284894727783833, 'f1-score': 0.027488601613989378, 'support': 697240}, 'accuracy': 0.35059965811347377, 'macro avg': {'precision': 0.35271643951183207, 'recall': 0.33747292640969856, 'f1-score': 0.2138154028496697, 'support': 2211260}, 'weighted avg': {'precision': 0.3524671896069701, 'recall': 0.35059965811347377, 'f1-score': 0.2208917839417136, 'support': 2211260}}
[[ 45372 690200  10360]
 [ 41049 719935   7104]
 [ 45430 641850   9960]]
Evaluating performance on  train set...
3947/3947 - 58s - 58s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1132993
{'0': {'precision': 0.3342052217316184, 'recall': 0.08480903200662541, 'f1-score': 0.13528714640969847, 'support': 328432}, '1': {'precision': 0.3390394867362388, 'recall': 0.8495379185841325, 'f1-score': 0.48465821172513646, 'support': 343987}, '2': {'precision': 0.33638159224871306, 'recall': 0.06415074193481414, 'f1-score': 0.1077522430739953, 'support': 337159}, 'accuracy': 0.3384711235783664, 'macro avg': {'precision': 0.3365421002388567, 'recall': 0.3328325641751907, 'f1-score': 0.24256586706961006, 'support': 1009578}, 'weighted avg': {'precision': 0.3365791910765501, 'recall': 0.3384711235783664, 'f1-score': 0.2451305306463788, 'support': 1009578}}
[[ 27854 280155  20423]
 [ 29510 292230  22247]
 [ 25980 289550  21629]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1070733
{'0': {'precision': 0.3287707641196013, 'recall': 0.021149095136733943, 'f1-score': 0.0397416950459423, 'support': 116979}, '1': {'precision': 0.3481677910043274, 'recall': 0.958423577353163, 'f1-score': 0.5107828321152905, 'support': 124662}, '2': {'precision': 0.3105137711864407, 'recall': 0.020111319800001717, 'f1-score': 0.03777596997253389, 'support': 116601}, 'accuracy': 0.34696657566672806, 'macro avg': {'precision': 0.3291507754367898, 'recall': 0.33322799742996617, 'f1-score': 0.19610016571125555, 'support': 358242}, 'weighted avg': {'precision': 0.329578286778877, 'recall': 0.34696657566672806, 'f1-score': 0.20301603116525435, 'support': 358242}}
[[  2474 111911   2594]
 [  2570 119479   2613]
 [  2481 111775   2345]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1060847
{'0': {'precision': 0.38071065989847713, 'recall': 0.01133187278084158, 'f1-score': 0.022008656738317072, 'support': 26474}, '1': {'precision': 0.34347060326167334, 'recall': 0.988087410558886, 'f1-score': 0.5097471915717222, 'support': 25855}, '2': {'precision': 0.30917874396135264, 'recall': 0.002777175092210892, 'f1-score': 0.005504902804059866, 'support': 23045}, 'accuracy': 0.3437657547695492, 'macro avg': {'precision': 0.34445333570716774, 'recall': 0.3340654861439795, 'f1-score': 0.17908691703803306, 'support': 75374}, 'weighted avg': {'precision': 0.34606615825181386, 'recall': 0.3437657547695492, 'f1-score': 0.18426819993229288, 'support': 75374}}
[[  300 26102    72]
 [  237 25547    71]
 [  251 22730    64]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1217232
{'0': {'precision': 0.3695406929895246, 'recall': 0.13512080141426047, 'f1-score': 0.1978856526429342, 'support': 16970}, '1': {'precision': 0.34251869698338605, 'recall': 0.8092019447408989, 'f1-score': 0.4813090703907463, 'support': 16866}, '2': {'precision': 0.3779046868846002, 'recall': 0.11096975654889261, 'f1-score': 0.17156139645076215, 'support': 17293}, 'accuracy': 0.3493125232255667, 'macro avg': {'precision': 0.36332135895250356, 'recall': 0.35176416756801726, 'f1-score': 0.28358537316148086, 'support': 51129}, 'weighted avg': {'precision': 0.3634558010845002, 'recall': 0.3493125232255667, 'f1-score': 0.2824754940519852, 'support': 51129}}
[[ 2293 12916  1761]
 [ 1820 13648  1398]
 [ 2092 13282  1919]]
Evaluating performance on  val set...
53/53 - 1s - 905ms/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0896248
{'0': {'precision': 0.38461538461538464, 'recall': 0.013113972341440152, 'f1-score': 0.02536315425409269, 'support': 4194}, '1': {'precision': 0.40102401927565695, 'recall': 0.9862962962962963, 'f1-score': 0.5702050211444784, 'support': 5400}, '2': {'precision': 0.25, 'recall': 0.003602676273803397, 'f1-score': 0.007102993404363268, 'support': 3886}, 'accuracy': 0.40022255192878337, 'macro avg': {'precision': 0.34521313463034725, 'recall': 0.33433764830384666, 'f1-score': 0.20089038960097813, 'support': 13480}, 'weighted avg': {'precision': 0.35238179726746816, 'recall': 0.40022255192878337, 'f1-score': 0.23835922963584594, 'support': 13480}}
[[  55 4121   18]
 [  50 5326   24]
 [  38 3834   14]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938482
{'0': {'precision': 0.30914368650217705, 'recall': 0.009822344681292583, 'f1-score': 0.01903974434897259, 'support': 86741}, '1': {'precision': 0.38802900172056104, 'recall': 0.9877349818863436, 'f1-score': 0.5571737936924297, 'support': 110966}, '2': {'precision': 0.32620320855614976, 'recall': 0.0034482758620689655, 'f1-score': 0.0068244112546847905, 'support': 88450}, 'accuracy': 0.387067239312685, 'macro avg': {'precision': 0.3411252989262959, 'recall': 0.33366853414323505, 'f1-score': 0.1943459830986957, 'support': 286157}, 'weighted avg': {'precision': 0.34500687564029736, 'recall': 0.387067239312685, 'f1-score': 0.223941727201939, 'support': 286157}}
[[   852  85611    278]
 [  1009 109605    352]
 [   895  87250    305]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1113896
{'0': {'precision': 0.3647429627214433, 'recall': 0.23288843653859498, 'f1-score': 0.284270265691617, 'support': 43231}, '1': {'precision': 0.38084843192898205, 'recall': 0.669952, 'f1-score': 0.48563011760339586, 'support': 46875}, '2': {'precision': 0.3275736061808311, 'recall': 0.16044079670680883, 'f1-score': 0.215387783822747, 'support': 39111}, 'accuracy': 0.3695102037657584, 'macro avg': {'precision': 0.3577216669437521, 'recall': 0.35442707774846793, 'f1-score': 0.3284293890392533, 'support': 129217}, 'weighted avg': {'precision': 0.35933510745041464, 'recall': 0.3695102037657584, 'f1-score': 0.3364668056978953, 'support': 129217}}
[[10068 26063  7100]
 [ 9690 31404  5781]
 [ 7845 24991  6275]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1091415
{'0': {'precision': 0.3123736981190735, 'recall': 0.259424218951717, 'f1-score': 0.28344735171732843, 'support': 15492}, '1': {'precision': 0.3543125609431788, 'recall': 0.6913231478812338, 'f1-score': 0.4685082441197156, 'support': 17345}, '2': {'precision': 0.595108695652174, 'recall': 0.043870192307692304, 'f1-score': 0.08171641791044776, 'support': 14976}, 'accuracy': 0.3485872043168176, 'macro avg': {'precision': 0.4205983182381421, 'recall': 0.3315391863802144, 'f1-score': 0.27789067124916395, 'support': 47813}, 'weighted avg': {'precision': 0.4161460800808792, 'recall': 0.3485872043168176, 'f1-score': 0.28739520510505895, 'support': 47813}}
[[ 4019 11157   316]
 [ 5223 11991   131]
 [ 3624 10695   657]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1178968
{'0': {'precision': 0.35622282719109344, 'recall': 0.21565444124664845, 'f1-score': 0.2686626624172591, 'support': 40653}, '1': {'precision': 0.4183339871845168, 'recall': 0.7605801236329054, 'f1-score': 0.5397789589133553, 'support': 46266}, '2': {'precision': 0.37258056883252094, 'recall': 0.18334885887284583, 'f1-score': 0.24575861154032247, 'support': 42940}, 'accuracy': 0.3991175043701245, 'macro avg': {'precision': 0.38237912773604377, 'recall': 0.38652780791746655, 'f1-score': 0.3514000776236456, 'support': 129859}, 'weighted avg': {'precision': 0.38376066711238205, 'recall': 0.3991175043701245, 'f1-score': 0.35768203442099183, 'support': 129859}}
[[ 8767 23600  8286]
 [ 6105 35189  4972]
 [ 9739 25328  7873]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1162808
{'0': {'precision': 0.3493129455522265, 'recall': 0.15141743920462178, 'f1-score': 0.21125968507873027, 'support': 22329}, '1': {'precision': 0.3420638783839443, 'recall': 0.8260692648521566, 'f1-score': 0.4837949478366786, 'support': 22118}, '2': {'precision': 0.42819637700183777, 'recall': 0.07263415720329548, 'f1-score': 0.12420042643923242, 'support': 22455}, 'accuracy': 0.34801650174882665, 'macro avg': {'precision': 0.3731910669793362, 'recall': 0.35004028708669127, 'f1-score': 0.2730850197848804, 'support': 66902}, 'weighted avg': {'precision': 0.373392832335476, 'recall': 0.34801650174882665, 'f1-score': 0.27214006666568397, 'support': 66902}}
[[ 3381 17582  1366]
 [ 3035 18271   812]
 [ 3263 17561  1631]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182365
{'0': {'precision': 0.3374904555866633, 'recall': 0.2051996285979573, 'f1-score': 0.255220864209412, 'support': 6462}, '1': {'precision': 0.32569057014559805, 'recall': 0.7774890368686048, 'f1-score': 0.45907456245504674, 'support': 6157}, '2': {'precision': 0.3333333333333333, 'recall': 0.001491300745650373, 'f1-score': 0.0029693170570768727, 'support': 6035}, 'accuracy': 0.328186984024874, 'macro avg': {'precision': 0.3321714530218649, 'recall': 0.32805998873740416, 'f1-score': 0.23908824790717856, 'support': 18654}, 'weighted avg': {'precision': 0.3322508218641649, 'recall': 0.328186984024874, 'f1-score': 0.24089627608000438, 'support': 18654}}
[[1326 5125   11]
 [1363 4787    7]
 [1240 4786    9]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962926
{'0': {'precision': 0.2887175893482831, 'recall': 0.008864218249101745, 'f1-score': 0.017200350686761574, 'support': 46479}, '1': {'precision': 0.38133013135965776, 'recall': 0.9866560277065685, 'f1-score': 0.5500664903056661, 'support': 58903}, '2': {'precision': 0.3143350604490501, 'recall': 0.003712013053232715, 'f1-score': 0.007337378298292649, 'support': 49030}, 'accuracy': 0.38022303966013005, 'macro avg': {'precision': 0.32812759371899697, 'recall': 0.33307741966963433, 'f1-score': 0.19153473976357346, 'support': 154412}, 'weighted avg': {'precision': 0.33218041069744386, 'recall': 0.38022303966013005, 'f1-score': 0.2173391526306889, 'support': 154412}}
[[  412 45901   166]
 [  555 58117   231]
 [  460 48388   182]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118969
{'0': {'precision': 0.38088978766430737, 'recall': 0.13087586422541084, 'f1-score': 0.19481291857368188, 'support': 28783}, '1': {'precision': 0.3315866991446213, 'recall': 0.8603659880943632, 'f1-score': 0.47868664772146463, 'support': 27214}, '2': {'precision': 0.4120956399437412, 'recall': 0.03299797282078234, 'f1-score': 0.061103194188592676, 'support': 26638}, 'accuracy': 0.33956555938766864, 'macro avg': {'precision': 0.3748573755842233, 'recall': 0.34141327504685215, 'f1-score': 0.24486758682791307, 'support': 82635}, 'weighted avg': {'precision': 0.3747123476212847, 'recall': 0.33956555938766864, 'f1-score': 0.24519810677308593, 'support': 82635}}
[[ 3767 24496   520]
 [ 3066 23414   734]
 [ 3057 22702   879]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1259891
{'0': {'precision': 0.4110861903236142, 'recall': 0.12943906376109765, 'f1-score': 0.1968848308140873, 'support': 9912}, '1': {'precision': 0.3011065812463599, 'recall': 0.7734177215189874, 'f1-score': 0.433459095159782, 'support': 8690}, '2': {'precision': 0.3289913159652639, 'recall': 0.10016270083384177, 'f1-score': 0.1535703149360773, 'support': 9834}, 'accuracy': 0.31611337740891826, 'macro avg': {'precision': 0.347061362511746, 'recall': 0.33433982870464224, 'f1-score': 0.2613047469699822, 'support': 28436}, 'weighted avg': {'precision': 0.3490857754508699, 'recall': 0.31611337740891826, 'f1-score': 0.2542021542076637, 'support': 28436}}
[[1283 7701  928]
 [ 888 6721 1081]
 [ 950 7899  985]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1265771
{'0': {'precision': 0.3386389905605856, 'recall': 0.23554535709500202, 'f1-score': 0.27783704757388966, 'support': 59704}, '1': {'precision': 0.294881008088776, 'recall': 0.7373072583678074, 'f1-score': 0.4212756813542326, 'support': 47862}, '2': {'precision': 0.3333333333333333, 'recall': 0.000669867143016635, 'f1-score': 0.0013370473537604457, 'support': 53742}, 'accuracy': 0.30617204354402755, 'macro avg': {'precision': 0.3222844439942316, 'recall': 0.324507494201942, 'f1-score': 0.2334832587606276, 'support': 161308}, 'weighted avg': {'precision': 0.32388782392425797, 'recall': 0.30617204354402755, 'f1-score': 0.2282771799799984, 'support': 161308}}
[[14063 45600    41]
 [12542 35289    31]
 [14923 38783    36]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1201994
{'0': {'precision': 0.3005726556907659, 'recall': 0.10537013801756587, 'f1-score': 0.15603864734299516, 'support': 39850}, '1': {'precision': 0.3286426825848323, 'recall': 0.8141779564289613, 'f1-score': 0.4682688053886661, 'support': 40302}, '2': {'precision': 0.38314648269064927, 'recall': 0.07443931161588357, 'f1-score': 0.12465929132595799, 'support': 41779}, 'accuracy': 0.3290549573119223, 'macro avg': {'precision': 0.3374539403220825, 'recall': 0.33132913535413694, 'f1-score': 0.24965558135253973, 'support': 121931}, 'weighted avg': {'precision': 0.3381441522102137, 'recall': 0.3290549573119223, 'f1-score': 0.24848848958590988, 'support': 121931}}
[[ 4199 32777  2874]
 [ 5356 32813  2133]
 [ 4415 34254  3110]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1111155
{'0': {'precision': 0.34096109839816935, 'recall': 0.009607944286819705, 'f1-score': 0.018689244277202883, 'support': 15508}, '1': {'precision': 0.3525168931743983, 'recall': 0.8426497277676951, 'f1-score': 0.4970825972913656, 'support': 16530}, '2': {'precision': 0.30772563176895307, 'recall': 0.14362741794163242, 'f1-score': 0.19584597003951845, 'support': 14837}, 'accuracy': 0.345792, 'macro avg': {'precision': 0.3337345411138403, 'recall': 0.3319616966653824, 'f1-score': 0.23720593720269564, 'support': 46875}, 'weighted avg': {'precision': 0.33451635534266816, 'recall': 0.345792, 'f1-score': 0.2434639955403407, 'support': 46875}}
[[  149 13000  2359]
 [  166 13929  2435]
 [  122 12584  2131]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052305
{'0': {'precision': 0.34903940541298556, 'recall': 0.012644787644787644, 'f1-score': 0.024405430183702583, 'support': 196840}, '1': {'precision': 0.3485110919779909, 'recall': 0.9878312678741659, 'f1-score': 0.5152424471449313, 'support': 209800}, '2': {'precision': 0.41737649063032367, 'recall': 0.0012516475769124664, 'f1-score': 0.0024958106036296218, 'support': 195742}, 'accuracy': 0.34858445305470614, 'macro avg': {'precision': 0.3716423293404334, 'recall': 0.3339092343652887, 'f1-score': 0.1807145626440878, 'support': 602382}, 'weighted avg': {'precision': 0.37106130775394247, 'recall': 0.34858445305470614, 'f1-score': 0.18823664260808304, 'support': 602382}}
[[  2489 194183    168]
 [  2379 207247    174]
 [  2263 193234    245]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123824
{'0': {'precision': 0.35523662673466966, 'recall': 0.19707281306988025, 'f1-score': 0.25350818324173663, 'support': 106382}, '1': {'precision': 0.32661881638259593, 'recall': 0.8026872569249641, 'f1-score': 0.46430771600184817, 'support': 105163}, '2': {'precision': 0.41840490797546015, 'recall': 0.009440578800686588, 'f1-score': 0.01846453743897046, 'support': 108362}, 'accuracy': 0.33259978681304253, 'macro avg': {'precision': 0.36675345036424195, 'recall': 0.33640021626517697, 'f1-score': 0.24542681222751841, 'support': 319907}, 'weighted avg': {'precision': 0.3672260689843216, 'recall': 0.33259978681304253, 'f1-score': 0.2431880330642546, 'support': 319907}}
[[20965 84702   715]
 [20043 84413   707]
 [18009 89330  1023]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.115465
{'0': {'precision': 0.34675308488096723, 'recall': 0.3253953401328717, 'f1-score': 0.33573488770621385, 'support': 42748}, '1': {'precision': 0.3307730859334025, 'recall': 0.6678589918576741, 'f1-score': 0.44242476206807857, 'support': 42494}, '2': {'precision': 0.4666666666666667, 'recall': 0.007951277279648113, 'f1-score': 0.015636138966779144, 'support': 41377}, 'accuracy': 0.33659245452894115, 'macro avg': {'precision': 0.3813976124936788, 'recall': 0.33373520309006466, 'f1-score': 0.26459859624702387, 'support': 126619}, 'weighted avg': {'precision': 0.38057589345052684, 'recall': 0.33659245452894115, 'f1-score': 0.2669375792022886, 'support': 126619}}
[[13910 28624   214]
 [13952 28380   162]
 [12253 28795   329]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1121571
{'0': {'precision': 0.3700090232348297, 'recall': 0.037863136390392536, 'f1-score': 0.06869653533248872, 'support': 346564}, '1': {'precision': 0.3241410597692511, 'recall': 0.9596621895353548, 'f1-score': 0.4846006104205828, 'support': 320890}, '2': {'precision': 0.3326919376563402, 'recall': 0.00534890052096868, 'f1-score': 0.010528527193620772, 'support': 323244}, 'accuracy': 0.32582785066690356, 'macro avg': {'precision': 0.34228067355347364, 'recall': 0.33429140881557196, 'f1-score': 0.18794189098223077, 'support': 990698}, 'weighted avg': {'precision': 0.3429764716326232, 'recall': 0.32582785066690356, 'f1-score': 0.18443008787037443, 'support': 990698}}
[[ 13122 331750   1692]
 [ 11168 307946   1776]
 [ 11174 310341   1729]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1079772
{'0': {'precision': 0.33439293233703504, 'recall': 0.12530262129989866, 'f1-score': 0.182295915783788, 'support': 129287}, '1': {'precision': 0.36360930665907504, 'recall': 0.7603366165169391, 'f1-score': 0.4919551096871334, 'support': 147824}, '2': {'precision': 0.3151767061281337, 'recall': 0.11458160270255302, 'f1-score': 0.16806400891204576, 'support': 126399}, 'accuracy': 0.35458600778171545, 'macro avg': {'precision': 0.33772631504141454, 'recall': 0.3334069468397969, 'f1-score': 0.28077167812765574, 'support': 403510}, 'weighted avg': {'precision': 0.33907675564055245, 'recall': 0.35458600778171545, 'f1-score': 0.29127998528116544, 'support': 403510}}
[[ 16200  99100  13987]
 [ 17946 112396  17482]
 [ 14300  97616  14483]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990045
{'0': {'precision': 0.31953867028493893, 'recall': 0.009901406378103387, 'f1-score': 0.01920763411699937, 'support': 47569}, '1': {'precision': 0.3714581301563035, 'recall': 0.9894335913502887, 'f1-score': 0.5401357741377575, 'support': 56973}, '2': {'precision': 0.30454545454545456, 'recall': 0.0013699190316512637, 'f1-score': 0.0027275687998697283, 'support': 48908}, 'accuracy': 0.37086347344411863, 'macro avg': {'precision': 0.331847418328899, 'recall': 0.33356830558668116, 'f1-score': 0.18735699235154216, 'support': 153450}, 'weighted avg': {'precision': 0.3340366774003808, 'recall': 0.37086347344411863, 'f1-score': 0.2073655480099448, 'support': 153450}}
[[  471 47010    88]
 [  537 56371    65]
 [  466 48375    67]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
2451/2451 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076766
{'0': {'precision': 0.33582564428889594, 'recall': 0.010000994888169832, 'f1-score': 0.019423550249580198, 'support': 211079}, '1': {'precision': 0.3404257376438907, 'recall': 0.9894563287789295, 'f1-score': 0.5065658212792081, 'support': 213493}, '2': {'precision': 0.3157894736842105, 'recall': 0.0008285290157765733, 'f1-score': 0.0016527218262576179, 'support': 202769}, 'accuracy': 0.34035875225754414, 'macro avg': {'precision': 0.3306802852056657, 'recall': 0.33342861756095865, 'f1-score': 0.17588069778501533, 'support': 627341}, 'weighted avg': {'precision': 0.33091503499235136, 'recall': 0.34035875225754414, 'f1-score': 0.17946106056750882, 'support': 627341}}
[[  2111 208741    227]
 [  2114 211242    137]
 [  2061 200540    168]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1268921
{'0': {'precision': 0.34477307911676036, 'recall': 0.1993010286747805, 'f1-score': 0.2525892276192238, 'support': 106156}, '1': {'precision': 0.32628780393395196, 'recall': 0.6597462514417531, 'f1-score': 0.436632293505449, 'support': 97104}, '2': {'precision': 0.36264047787789816, 'recall': 0.17248054549657138, 'f1-score': 0.23377301474379475, 'support': 103832}, 'accuracy': 0.3358276998423925, 'macro avg': {'precision': 0.34456712030953685, 'recall': 0.3438426085377017, 'f1-score': 0.3076648452894892, 'support': 307092}, 'weighted avg': {'precision': 0.3449691558195564, 'recall': 0.3358276998423925, 'f1-score': 0.30442253117169166, 'support': 307092}}
[[21157 67364 17635]
 [19199 64064 13841]
 [21009 64914 17909]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1265792
{'0': {'precision': 0.3257667230137648, 'recall': 0.13800158563719597, 'f1-score': 0.19387406808587082, 'support': 39101}, '1': {'precision': 0.3225784419522723, 'recall': 0.6333476371828568, 'f1-score': 0.4274478926266822, 'support': 37286}, '2': {'precision': 0.3290510821756739, 'recall': 0.20788510743665226, 'f1-score': 0.25479683021412913, 'support': 36347}, 'accuracy': 0.324365320134121, 'macro avg': {'precision': 0.325798749047237, 'recall': 0.32641144341890166, 'f1-score': 0.29203959697556076, 'support': 112734}, 'weighted avg': {'precision': 0.32577114363930015, 'recall': 0.324365320134121, 'f1-score': 0.2907693548396851, 'support': 112734}}
[[ 5396 25783  7922]
 [ 6186 23615  7485]
 [ 4982 23809  7556]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
3337/3337 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957376
{'0': {'precision': 0.3036746490503716, 'recall': 0.0323845936515042, 'f1-score': 0.05852765740166644, 'support': 272537}, '1': {'precision': 0.3832419315700073, 'recall': 0.9653224943844262, 'f1-score': 0.5486605611356461, 'support': 327215}, '2': {'precision': 0.31175693527080584, 'recall': 0.0009281508953116581, 'f1-score': 0.0018507916839851622, 'support': 254269}, 'accuracy': 0.38047073783899926, 'macro avg': {'precision': 0.33289117196372825, 'recall': 0.3328784129770807, 'f1-score': 0.20301300340709924, 'support': 854021}, 'weighted avg': {'precision': 0.3365669118690215, 'recall': 0.38047073783899926, 'f1-score': 0.22944578251351386, 'support': 854021}}
[[  8826 263457    254]
 [ 11080 315868    267]
 [  9158 244875    236]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1148338
{'0': {'precision': 0.3574660633484163, 'recall': 0.015142171405713523, 'f1-score': 0.02905363810072034, 'support': 119996}, '1': {'precision': 0.31991891846801507, 'recall': 0.9844109619514533, 'f1-score': 0.48290190235354613, 'support': 116877}, '2': {'precision': 0.3725631768953069, 'recall': 0.00399278821972716, 'f1-score': 0.007900901866511507, 'support': 129233}, 'accuracy': 0.32063937766657746, 'macro avg': {'precision': 0.3499827195705794, 'recall': 0.334515307192298, 'f1-score': 0.17328548077359265, 'support': 366106}, 'weighted avg': {'precision': 0.35080855875362316, 'recall': 0.32063937766657746, 'f1-score': 0.16647501884652077, 'support': 366106}}
[[  1817 117702    477]
 [  1430 115055    392]
 [  1836 126881    516]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1157137
{'0': {'precision': 0.35871056241426613, 'recall': 0.012093604032742913, 'f1-score': 0.023398353614889053, 'support': 43246}, '1': {'precision': 0.31541643484361015, 'recall': 0.9877531437806172, 'f1-score': 0.47814740341891837, 'support': 39602}, '2': {'precision': 0.3474025974025974, 'recall': 0.0024921392803074413, 'f1-score': 0.004948777836875332, 'support': 42935}, 'accuracy': 0.3159965973144225, 'macro avg': {'precision': 0.34050986488682455, 'recall': 0.33411296236455584, 'f1-score': 0.16883151162356091, 'support': 125783}, 'weighted avg': {'precision': 0.34121979245466016, 'recall': 0.3159965973144225, 'f1-score': 0.16027566878713134, 'support': 125783}}
[[  523 42606   117]
 [  401 39117    84]
 [  534 42294   107]]
testing model on single stock: results/universal/W9/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
10303/10303 - 139s - 139s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954108
{'0': {'precision': 0.3034197422378442, 'recall': 0.0102634156974404, 'f1-score': 0.01985521292182145, 'support': 807431}, '1': {'precision': 0.38329648026821717, 'recall': 0.980863860573481, 'f1-score': 0.5511986445055852, 'support': 1011228}, '2': {'precision': 0.30705524218819946, 'recall': 0.008377455740187726, 'f1-score': 0.01630992422864331, 'support': 818745}, 'accuracy': 0.3818235659004081, 'macro avg': {'precision': 0.33125715489808694, 'recall': 0.33316824400370304, 'f1-score': 0.19578792721868332, 'support': 2637404}, 'weighted avg': {'precision': 0.3351745061844491, 'recall': 0.3818235659004081, 'f1-score': 0.222481230112396, 'support': 2637404}}
[[  8287 792546   6598]
 [ 10470 991877   8881]
 [  8555 803331   6859]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1137191
{'0': {'precision': 0.3396654074473826, 'recall': 0.010930802842633952, 'f1-score': 0.02118000989342693, 'support': 287902}, '1': {'precision': 0.33659681416549175, 'recall': 0.9299220626609294, 'f1-score': 0.49428209786843963, 'support': 289335}, '2': {'precision': 0.3707054615407737, 'recall': 0.08279487239734556, 'f1-score': 0.13535827468411737, 'support': 297917}, 'accuracy': 0.33922258253975873, 'macro avg': {'precision': 0.3489892277178827, 'recall': 0.34121591263363626, 'f1-score': 0.21694012748199465, 'support': 875154}, 'weighted avg': {'precision': 0.34921745012572825, 'recall': 0.33922258253975873, 'f1-score': 0.216460656197847, 'support': 875154}}
[[  3147 260304  24451]
 [  2855 269059  17421]
 [  3263 269988  24666]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106795
{'0': {'precision': 0.3323690131790421, 'recall': 0.008716470251041088, 'f1-score': 0.01698744013734526, 'support': 118626}, '1': {'precision': 0.3435166384898351, 'recall': 0.988550240404205, 'f1-score': 0.5098594686836039, 'support': 122710}, '2': {'precision': 0.33852140077821014, 'recall': 0.003001811437936686, 'f1-score': 0.00595085415277279, 'support': 115930}, 'accuracy': 0.34340519388914703, 'macro avg': {'precision': 0.3381356841490291, 'recall': 0.3334228406977276, 'f1-score': 0.17759925432457394, 'support': 357266}, 'weighted avg': {'precision': 0.3381942845350036, 'recall': 0.34340519388914703, 'f1-score': 0.18269269955111514, 'support': 357266}}
[[  1034 117237    355]
 [  1080 121305    325]
 [   997 114585    348]]
training model: results/universal/W9/deepLOB_L2/h500
Epoch 1/50
6697/6697 - 275s - loss: 3.2217 - accuracy500: 0.4148 - val_loss: 3.4079 - val_accuracy500: 0.3344 - 275s/epoch - 41ms/step
Epoch 2/50
6697/6697 - 270s - loss: 3.1904 - accuracy500: 0.4297 - val_loss: 3.4567 - val_accuracy500: 0.3355 - 270s/epoch - 40ms/step
Epoch 3/50
6697/6697 - 273s - loss: 3.1746 - accuracy500: 0.4363 - val_loss: 3.4128 - val_accuracy500: 0.3366 - 273s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 273s - loss: 3.1644 - accuracy500: 0.4403 - val_loss: 3.6596 - val_accuracy500: 0.3379 - 273s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 272s - loss: 3.1563 - accuracy500: 0.4438 - val_loss: 3.6224 - val_accuracy500: 0.3357 - 272s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 274s - loss: 3.1513 - accuracy500: 0.4456 - val_loss: 3.6140 - val_accuracy500: 0.3364 - 274s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 282s - loss: 3.1433 - accuracy500: 0.4492 - val_loss: 3.6805 - val_accuracy500: 0.3359 - 282s/epoch - 42ms/step
Epoch 8/50
6697/6697 - 284s - loss: 3.1397 - accuracy500: 0.4500 - val_loss: 3.5823 - val_accuracy500: 0.3338 - 284s/epoch - 42ms/step
Epoch 9/50
6697/6697 - 284s - loss: 3.1358 - accuracy500: 0.4516 - val_loss: 3.5864 - val_accuracy500: 0.3373 - 284s/epoch - 42ms/step
Epoch 10/50
6697/6697 - 281s - loss: 3.1304 - accuracy500: 0.4533 - val_loss: 3.6467 - val_accuracy500: 0.3373 - 281s/epoch - 42ms/step
Epoch 11/50
6697/6697 - 280s - loss: 3.1256 - accuracy500: 0.4550 - val_loss: 3.7191 - val_accuracy500: 0.3380 - 280s/epoch - 42ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 233s - 233s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.124974
{'0': {'precision': 0.3138238356445455, 'recall': 0.5329607066413702, 'f1-score': 0.3950373792948821, 'support': 1348803}, '1': {'precision': 0.3705714856629034, 'recall': 0.3262692668496773, 'f1-score': 0.34701210142111594, 'support': 1591529}, '2': {'precision': 0.3146018697902373, 'recall': 0.1416806351490898, 'f1-score': 0.1953745420806745, 'support': 1367364}, 'accuracy': 0.33239462580460644, 'macro avg': {'precision': 0.33299906369922877, 'recall': 0.3336368695467124, 'f1-score': 0.31247467426555753, 'support': 4307696}, 'weighted avg': {'precision': 0.33503688934370557, 'recall': 0.33239462580460644, 'f1-score': 0.3139161956705676, 'support': 4307696}}
[[718859 438657 191287]
 [841487 519267 230775]
 [730299 443336 193729]]
Evaluating performance on  train set...
6697/6697 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1373367
{'0': {'precision': 0.33469550712981855, 'recall': 0.6063767450675597, 'f1-score': 0.4313198518567074, 'support': 575121}, '1': {'precision': 0.3270974050891446, 'recall': 0.2817354405592417, 'f1-score': 0.3027265437048917, 'support': 562762}, '2': {'precision': 0.3402909382089951, 'recall': 0.11064496755895453, 'f1-score': 0.16699260066514116, 'support': 576122}, 'accuracy': 0.3331583046723901, 'macro avg': {'precision': 0.3340279501426528, 'recall': 0.33291905106191866, 'f1-score': 0.3003463320755801, 'support': 1714005}, 'weighted avg': {'precision': 0.3340815811748672, 'recall': 0.3331583046723901, 'f1-score': 0.30025128910857096, 'support': 1714005}}
[[348740 162882  63499]
 [344131 158550  60081]
 [349091 163286  63745]]
Evaluating performance on  val set...
2631/2631 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1364616
{'0': {'precision': 0.33659287395315346, 'recall': 0.613059244980768, 'f1-score': 0.434583083757612, 'support': 227226}, '1': {'precision': 0.3297479513423005, 'recall': 0.26380245643138805, 'f1-score': 0.2931118180630885, 'support': 225449}, '2': {'precision': 0.33477442652967804, 'recall': 0.1195678336731867, 'f1-score': 0.1762030806091615, 'support': 220193}, 'accuracy': 0.33454555722667745, 'macro avg': {'precision': 0.3337050839417106, 'recall': 0.3321431783617809, 'f1-score': 0.3012993274766207, 'support': 672868}, 'weighted avg': {'precision': 0.3337043574072462, 'recall': 0.33454555722667745, 'f1-score': 0.30262849026701444, 'support': 672868}}
[[139303  60976  26947]
 [140606  59474  25369]
 [133953  59912  26328]]
testing model out of sample: results/universal/W9/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 119s - 119s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1233138
{'0': {'precision': 0.30583667216917876, 'recall': 0.6493035529001874, 'f1-score': 0.415815045025867, 'support': 681387}, '1': {'precision': 0.40492329582388376, 'recall': 0.24972160728364431, 'f1-score': 0.30892502417641754, 'support': 898012}, '2': {'precision': 0.2939591712832966, 'recall': 0.09808486360133004, 'f1-score': 0.1470903401357315, 'support': 631861}, 'accuracy': 0.3295207257400758, 'macro avg': {'precision': 0.33490637975878634, 'recall': 0.3323700079283873, 'f1-score': 0.29061013644600536, 'support': 2211260}, 'weighted avg': {'precision': 0.3426826547737366, 'recall': 0.3295207257400758, 'f1-score': 0.2956187849028414, 'support': 2211260}}
[[442427 172239  66721]
 [591624 224253  82135]
 [412561 157324  61976]]
Evaluating performance on  train set...
3947/3947 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1398776
{'0': {'precision': 0.3324668611921634, 'recall': 0.5976769977819075, 'f1-score': 0.4272625004017699, 'support': 333620}, '1': {'precision': 0.33076695190844113, 'recall': 0.2931089110105945, 'f1-score': 0.3108013848093327, 'support': 331399}, '2': {'precision': 0.33863067002987285, 'recall': 0.11416041955078811, 'f1-score': 0.17075521251611617, 'support': 344559}, 'accuracy': 0.33268157586635205, 'macro avg': {'precision': 0.33395482771015916, 'recall': 0.3349821094477634, 'f1-score': 0.3029396992424062, 'support': 1009578}, 'weighted avg': {'precision': 0.3340125045922732, 'recall': 0.33268157586635205, 'f1-score': 0.30149015606303525, 'support': 1009578}}
[[199397  95806  38417]
 [195856  97136  38407]
 [204497 100727  39335]]
Evaluating performance on  val set...
1402/1402 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1298608
{'0': {'precision': 0.3259346144247567, 'recall': 0.558109124474377, 'f1-score': 0.4115341227777183, 'support': 117004}, '1': {'precision': 0.34380482840901117, 'recall': 0.31633962660123177, 'f1-score': 0.3295008848962297, 'support': 123889}, '2': {'precision': 0.3275398633257403, 'recall': 0.12253193465645212, 'f1-score': 0.17834529206382674, 'support': 117349}, 'accuracy': 0.3318175981599031, 'macro avg': {'precision': 0.33242643538650274, 'recall': 0.3323268952440203, 'f1-score': 0.3064600999125916, 'support': 358242}, 'weighted avg': {'precision': 0.3326404090931005, 'recall': 0.3318175981599031, 'f1-score': 0.3067795381579802, 'support': 358242}}
[[65301 37407 14296]
 [69473 39191 15225]
 [65576 37394 14379]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1228348
{'0': {'precision': 0.389344873899418, 'recall': 0.536684037301152, 'f1-score': 0.4512929916106899, 'support': 29168}, '1': {'precision': 0.2898304398850714, 'recall': 0.3296359368527638, 'f1-score': 0.3084542831301951, 'support': 21727}, '2': {'precision': 0.3282012049344936, 'recall': 0.14020180562931492, 'f1-score': 0.19647355163727961, 'support': 24479}, 'accuracy': 0.3482367925279274, 'macro avg': {'precision': 0.3357921729063276, 'recall': 0.33550725992774355, 'f1-score': 0.3187402754593882, 'support': 75374}, 'weighted avg': {'precision': 0.34080179564402363, 'recall': 0.3482367925279274, 'f1-score': 0.3273619054236118, 'support': 75374}}
[[15654  9534  3980]
 [11520  7162  3045]
 [13032  8015  3432]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.142608
{'0': {'precision': 0.32939519098389525, 'recall': 0.6177865849996997, 'f1-score': 0.42968717370421416, 'support': 16653}, '1': {'precision': 0.34268365688873687, 'recall': 0.2344645991808075, 'f1-score': 0.2784282388910121, 'support': 17090}, '2': {'precision': 0.3393880287699622, 'recall': 0.1601288392959853, 'f1-score': 0.21759349720583063, 'support': 17386}, 'accuracy': 0.3340374347239336, 'macro avg': {'precision': 0.3371556255475314, 'recall': 0.3374600078254975, 'f1-score': 0.3085696366003523, 'support': 51129}, 'weighted avg': {'precision': 0.33723487805116237, 'recall': 0.3340374347239336, 'f1-score': 0.307007757804069, 'support': 51129}}
[[10288  3561  2804]
 [10468  4007  2615]
 [10477  4125  2784]]
Evaluating performance on  val set...
53/53 - 1s - 959ms/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.124706
{'0': {'precision': 0.33189354883656125, 'recall': 0.5394021739130435, 'f1-score': 0.4109376347796083, 'support': 4416}, '1': {'precision': 0.35907951697425383, 'recall': 0.33610577948389847, 'f1-score': 0.34721304252037893, 'support': 4689}, '2': {'precision': 0.3463949843260188, 'recall': 0.15154285714285715, 'f1-score': 0.21084433137223724, 'support': 4375}, 'accuracy': 0.34280415430267064, 'macro avg': {'precision': 0.3457893500456113, 'recall': 0.342350270179933, 'f1-score': 0.32299833622407487, 'support': 13480}, 'weighted avg': {'precision': 0.3460566634407168, 'recall': 0.34280415430267064, 'f1-score': 0.3238298591482452, 'support': 13480}}
[[2382 1404  630]
 [2492 1576  621]
 [2303 1409  663]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1313692
{'0': {'precision': 0.31313740363980574, 'recall': 0.5376779810079375, 'f1-score': 0.3957781911450181, 'support': 89827}, '1': {'precision': 0.3517796435282234, 'recall': 0.3237537360429433, 'f1-score': 0.33718533325004685, 'support': 100039}, '2': {'precision': 0.3298451654997616, 'recall': 0.13650289227445972, 'f1-score': 0.19309534302923462, 'support': 96291}, 'accuracy': 0.327896923716701, 'macro avg': {'precision': 0.3315874042225969, 'recall': 0.3326448697751135, 'f1-score': 0.3086862891414332, 'support': 286157}, 'weighted avg': {'precision': 0.3322686432511185, 'recall': 0.327896923716701, 'f1-score': 0.3070922423865675, 'support': 286157}}
[[48298 28831 12698]
 [53644 32388 14007]
 [52297 30850 13144]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1379632
{'0': {'precision': 0.35696231486246927, 'recall': 0.6664744821695494, 'f1-score': 0.46491639667821105, 'support': 46830}, '1': {'precision': 0.30478039310846883, 'recall': 0.18490529001864756, 'f1-score': 0.23017012308726065, 'support': 40756}, '2': {'precision': 0.33595215759849906, 'recall': 0.1376378179721842, 'f1-score': 0.1952732291648917, 'support': 41631}, 'accuracy': 0.3442039360146111, 'macro avg': {'precision': 0.3325649551898124, 'recall': 0.32967253005346037, 'f1-score': 0.2967865829767878, 'support': 129217}, 'weighted avg': {'precision': 0.3337347189574228, 'recall': 0.3442039360146111, 'f1-score': 0.3040023231954667, 'support': 129217}}
[[31211  9059  6560]
 [28454  7536  4766]
 [27770  8131  5730]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1632066
{'0': {'precision': 0.3398866542956016, 'recall': 0.8219526986052152, 'f1-score': 0.48091115526539885, 'support': 16490}, '1': {'precision': 0.2821765498652291, 'recall': 0.11059755694948828, 'f1-score': 0.15891086760590106, 'support': 15145}, '2': {'precision': 0.4432216108054027, 'recall': 0.0547657312399555, 'f1-score': 0.09748583374594269, 'support': 16178}, 'accuracy': 0.33704222700939074, 'macro avg': {'precision': 0.3550949383220778, 'recall': 0.32910532893155303, 'f1-score': 0.24576928553908084, 'support': 47813}, 'weighted avg': {'precision': 0.35657109984006796, 'recall': 0.33704222700939074, 'f1-score': 0.24918026182334638, 'support': 47813}}
[[13554  2258   678]
 [13035  1675   435]
 [13289  2003   886]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1615714
{'0': {'precision': 0.3005945922486003, 'recall': 0.6734569851958091, 'f1-score': 0.41566079774345277, 'support': 41137}, '1': {'precision': 0.31107459216802275, 'recall': 0.17579505300353357, 'f1-score': 0.224640722462625, 'support': 44148}, '2': {'precision': 0.3940059626549506, 'recall': 0.11266657692825414, 'f1-score': 0.1752267969295185, 'support': 44574}, 'accuracy': 0.31177661925627026, 'macro avg': {'precision': 0.3352250490238579, 'recall': 0.3206395383758656, 'f1-score': 0.2718427723785321, 'support': 129859}, 'weighted avg': {'precision': 0.33622084426760024, 'recall': 0.31177661925627026, 'f1-score': 0.2681911619401716, 'support': 129859}}
[[27704  8676  4757]
 [33420  7761  2967]
 [31040  8512  5022]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1390616
{'0': {'precision': 0.3397426867633939, 'recall': 0.6396304809052333, 'f1-score': 0.44377319145021316, 'support': 22624}, '1': {'precision': 0.33410687405920725, 'recall': 0.24096440041615777, 'f1-score': 0.2799926414548895, 'support': 22107}, '2': {'precision': 0.3354854136776662, 'recall': 0.1265617247756078, 'f1-score': 0.18378909448174227, 'support': 22171}, 'accuracy': 0.3378673283309916, 'macro avg': {'precision': 0.3364449915000891, 'recall': 0.33571886869899964, 'f1-score': 0.30251830912894834, 'support': 66902}, 'weighted avg': {'precision': 0.3364695572151723, 'recall': 0.3378673283309916, 'f1-score': 0.3034963083580098, 'support': 66902}}
[[14471  5329  2824]
 [14046  5327  2734]
 [14077  5288  2806]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1457164
{'0': {'precision': 0.33749411210551106, 'recall': 0.6786108918705603, 'f1-score': 0.45079431657316615, 'support': 6335}, '1': {'precision': 0.3206214689265537, 'recall': 0.21482649842271292, 'f1-score': 0.2572723838307518, 'support': 6340}, '2': {'precision': 0.32434052757793763, 'recall': 0.09048335842114066, 'f1-score': 0.14149339610304695, 'support': 5979}, 'accuracy': 0.3324756084485901, 'macro avg': {'precision': 0.32748536953666746, 'recall': 0.32797358290480466, 'f1-score': 0.283186698835655, 'support': 18654}, 'weighted avg': {'precision': 0.3275435470982766, 'recall': 0.3324756084485901, 'f1-score': 0.28588388143444254, 'support': 18654}}
[[4299 1466  570]
 [4421 1362  557]
 [4018 1420  541]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1272078
{'0': {'precision': 0.29571374321659133, 'recall': 0.5262469480292989, 'f1-score': 0.3786518175757813, 'support': 45872}, '1': {'precision': 0.37468090955504063, 'recall': 0.32689177845162837, 'f1-score': 0.34915871432884704, 'support': 58371}, '2': {'precision': 0.32512698485333824, 'recall': 0.1416213199386075, 'f1-score': 0.19730082474799365, 'support': 50169}, 'accuracy': 0.3259202652643577, 'macro avg': {'precision': 0.33184054587499007, 'recall': 0.33158668213984493, 'f1-score': 0.3083704522175407, 'support': 154412}, 'weighted avg': {'precision': 0.3351214666190185, 'recall': 0.3259202652643577, 'f1-score': 0.308581227927282, 'support': 154412}}
[[24140 15295  6437]
 [30979 19081  8311]
 [26514 16550  7105]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1359669
{'0': {'precision': 0.34620696982575433, 'recall': 0.6895809819413092, 'f1-score': 0.4609780250872394, 'support': 28352}, '1': {'precision': 0.3361969271435652, 'recall': 0.22397094430992737, 'f1-score': 0.26884206354448775, 'support': 27258}, '2': {'precision': 0.35844577711144426, 'recall': 0.10616096207215542, 'f1-score': 0.1638071312341203, 'support': 27025}, 'accuracy': 0.34519271495129183, 'macro avg': {'precision': 0.3469498913602546, 'recall': 0.3399042961077973, 'f1-score': 0.2978757399552825, 'support': 82635}, 'weighted avg': {'precision': 0.34690764173795446, 'recall': 0.34519271495129183, 'f1-score': 0.3004130653714668, 'support': 82635}}
[[19551  6231  2570]
 [18588  6105  2565]
 [18333  5823  2869]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1351551
{'0': {'precision': 0.34855845057094187, 'recall': 0.5717094370860927, 'f1-score': 0.4330785812267293, 'support': 9664}, '1': {'precision': 0.32739264664608475, 'recall': 0.25427792915531333, 'f1-score': 0.28624010796883625, 'support': 9175}, '2': {'precision': 0.3379739879098736, 'recall': 0.19224757736792747, 'f1-score': 0.24508501594048884, 'support': 9597}, 'accuracy': 0.3412223941482628, 'macro avg': {'precision': 0.33797502837563337, 'recall': 0.3394116478697778, 'f1-score': 0.32146790171201817, 'support': 28436}, 'weighted avg': {'precision': 0.338157010875878, 'recall': 0.3412223941482628, 'f1-score': 0.32225366780032555, 'support': 28436}}
[[5525 2324 1815]
 [5043 2333 1799]
 [5283 2469 1845]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1542239
{'0': {'precision': 0.3683383953341958, 'recall': 0.8796074479158061, 'f1-score': 0.5192423976437084, 'support': 60527}, '1': {'precision': 0.2720627325890484, 'recall': 0.08394676946420881, 'f1-score': 0.12830437030885186, 'support': 48769}, '2': {'precision': 0.24083769633507854, 'recall': 0.007959701607321387, 'f1-score': 0.015410098453406787, 'support': 52012}, 'accuracy': 0.35799836337937363, 'macro avg': {'precision': 0.29374627475277426, 'recall': 0.32383797299577877, 'f1-score': 0.22098562213532236, 'support': 161308}, 'weighted avg': {'precision': 0.2981197195539482, 'recall': 0.35799836337937363, 'f1-score': 0.2385930671667352, 'support': 161308}}
[[53240  6333   954]
 [44324  4094   351]
 [46977  4621   414]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1480169
{'0': {'precision': 0.32454986985805134, 'recall': 0.608844479122096, 'f1-score': 0.42340174156565874, 'support': 39731}, '1': {'precision': 0.31710947593102284, 'recall': 0.2805147698193834, 'f1-score': 0.2976917094005827, 'support': 40251}, '2': {'precision': 0.35425324399966074, 'recall': 0.09957329137762522, 'f1-score': 0.15545217714923706, 'support': 41949}, 'accuracy': 0.32524952637147236, 'macro avg': {'precision': 0.33197086326291164, 'recall': 0.32964418010636826, 'f1-score': 0.2921818760384928, 'support': 121931}, 'weighted avg': {'precision': 0.33231281403065344, 'recall': 0.32524952637147236, 'f1-score': 0.289718176415033, 'support': 121931}}
[[24190 11795  3746]
 [25092 11291  3868]
 [25252 12520  4177]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1247063
{'0': {'precision': 0.3289674743505785, 'recall': 0.4780484710062175, 'f1-score': 0.3897380194998319, 'support': 15762}, '1': {'precision': 0.34106478235072013, 'recall': 0.3954099180789194, 'f1-score': 0.3662322618013322, 'support': 15991}, '2': {'precision': 0.3286687534524029, 'recall': 0.11803994180663933, 'f1-score': 0.17369727047146402, 'support': 15122}, 'accuracy': 0.3337173333333333, 'macro avg': {'precision': 0.3329003367179005, 'recall': 0.3304994436305921, 'f1-score': 0.3098891839242094, 'support': 46875}, 'weighted avg': {'precision': 0.33299799797315033, 'recall': 0.3337173333333333, 'f1-score': 0.31202391223233983, 'support': 46875}}
[[7535 6371 1856]
 [7878 6323 1790]
 [7492 5845 1785]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
2354/2354 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1302829
{'0': {'precision': 0.3248197228283646, 'recall': 0.5732517214996175, 'f1-score': 0.4146740584268834, 'support': 196050}, '1': {'precision': 0.3463247955230306, 'recall': 0.3085230813479699, 'f1-score': 0.3263328685511472, 'support': 208610}, '2': {'precision': 0.3279941032219655, 'recall': 0.11702794833149574, 'f1-score': 0.17250595484383213, 'support': 197722}, 'accuracy': 0.331825984176154, 'macro avg': {'precision': 0.3330462071911202, 'recall': 0.3329342503930277, 'f1-score': 0.3045042939406209, 'support': 602382}, 'weighted avg': {'precision': 0.33330905029003816, 'recall': 0.331825984176154, 'f1-score': 0.30459305103186596, 'support': 602382}}
[[112386  60490  23174]
 [120015  64361  24234]
 [113594  60989  23139]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1495947
{'0': {'precision': 0.33292501182953094, 'recall': 0.7127344334308463, 'f1-score': 0.4538516258937292, 'support': 105627}, '1': {'precision': 0.3285245028409091, 'recall': 0.21041907541841204, 'f1-score': 0.2565308315328535, 'support': 105518}, '2': {'precision': 0.34969840421470566, 'recall': 0.08422059175079531, 'f1-score': 0.1357479474791784, 'support': 108762}, 'accuracy': 0.333368760295961, 'macro avg': {'precision': 0.33704930629504853, 'recall': 0.33579136686668454, 'f1-score': 0.28204346830192034, 'support': 319907}, 'weighted avg': {'precision': 0.3371761685567516, 'recall': 0.333368760295961, 'f1-score': 0.2806185054834404, 'support': 319907}}
[[75284 21876  8467]
 [74748 22203  8567]
 [76097 23505  9160]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1492633
{'0': {'precision': 0.3384384192351963, 'recall': 0.7421993689377118, 'f1-score': 0.4648898713885208, 'support': 42785}, '1': {'precision': 0.3267897382561969, 'recall': 0.17632341937897494, 'f1-score': 0.22905655792479193, 'support': 42768}, '2': {'precision': 0.3456510550694802, 'recall': 0.08177080796766181, 'f1-score': 0.13225418955908705, 'support': 41066}, 'accuracy': 0.3368688743395541, 'macro avg': {'precision': 0.3369597375202911, 'recall': 0.3334311987614495, 'f1-score': 0.2754002062907999, 'support': 126619}, 'weighted avg': {'precision': 0.3368431082239014, 'recall': 0.3368688743395541, 'f1-score': 0.2773498018869114, 'support': 126619}}
[[31755  7816  3214]
 [32084  7541  3143]
 [29989  7719  3358]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
3870/3870 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269561
{'0': {'precision': 0.3458946317285857, 'recall': 0.616600381448024, 'f1-score': 0.4431789441916513, 'support': 338185}, '1': {'precision': 0.3472518139419099, 'recall': 0.2816648800810051, 'f1-score': 0.31103846172763805, 'support': 336769}, '2': {'precision': 0.3172594808116569, 'recall': 0.11522942637073072, 'f1-score': 0.16905695095289983, 'support': 315744}, 'accuracy': 0.34295415959252973, 'macro avg': {'precision': 0.33680197549405083, 'recall': 0.33783156263325326, 'f1-score': 0.3077581189573964, 'support': 990698}, 'weighted avg': {'precision': 0.3372297104364101, 'recall': 0.34295415959252973, 'f1-score': 0.3108952484820611, 'support': 990698}}
[[208525  91709  37951]
 [201568  94856  40345]
 [192764  86597  36383]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1398115
{'0': {'precision': 0.34176595069729715, 'recall': 0.6206230220653648, 'f1-score': 0.4407943631189291, 'support': 137138}, '1': {'precision': 0.33022461235411527, 'recall': 0.28624639236011423, 'f1-score': 0.3066668285516555, 'support': 132358}, '2': {'precision': 0.33044834700347203, 'recall': 0.09800468607757398, 'f1-score': 0.15117403314917127, 'support': 134014}, 'accuracy': 0.33736958191866373, 'macro avg': {'precision': 0.33414630335162815, 'recall': 0.33495803350101766, 'f1-score': 0.29954507493991867, 'support': 403510}, 'weighted avg': {'precision': 0.3342213897152864, 'recall': 0.33736958191866373, 'f1-score': 0.3006094082954493, 'support': 403510}}
[[85111 38468 13559]
 [81418 37887 13053]
 [82504 38376 13134]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1322386
{'0': {'precision': 0.3261002583510855, 'recall': 0.5745687589841878, 'f1-score': 0.4160618765360705, 'support': 50088}, '1': {'precision': 0.3322645461929802, 'recall': 0.30047746998898145, 'f1-score': 0.31557256402708267, 'support': 51731}, '2': {'precision': 0.3448088618592528, 'recall': 0.12298812728786969, 'f1-score': 0.181306836838123, 'support': 51631}, 'accuracy': 0.33022482893450633, 'macro avg': {'precision': 0.33439122213443956, 'recall': 0.33267811875367964, 'f1-score': 0.30431375913375874, 'support': 153450}, 'weighted avg': {'precision': 0.3344732051225371, 'recall': 0.33022482893450633, 'f1-score': 0.3031974250531954, 'support': 153450}}
[[28779 15406  5903]
 [30024 15544  6163]
 [29449 15832  6350]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
2451/2451 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1328716
{'0': {'precision': 0.3525802949147717, 'recall': 0.5686196838200871, 'f1-score': 0.435267261058707, 'support': 222152}, '1': {'precision': 0.30245234425907347, 'recall': 0.3080277669514289, 'f1-score': 0.30521459585838345, 'support': 189866}, '2': {'precision': 0.3424480198673747, 'recall': 0.12039587039006516, 'f1-score': 0.1781565157632506, 'support': 215323}, 'accuracy': 0.33590662813366257, 'macro avg': {'precision': 0.33249355301374, 'recall': 0.3323477737205271, 'f1-score': 0.30621279089344705, 'support': 627341}, 'weighted avg': {'precision': 0.3339312582039151, 'recall': 0.33590662813366257, 'f1-score': 0.30765813565453576, 'support': 627341}}
[[126320  68888  26944]
 [108548  58484  22834]
 [123405  65994  25924]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436573
{'0': {'precision': 0.33772924064795445, 'recall': 0.6613984948080404, 'f1-score': 0.44713724479938166, 'support': 104970}, '1': {'precision': 0.3372633747800083, 'recall': 0.2347943022213368, 'f1-score': 0.2768515201522208, 'support': 100390}, '2': {'precision': 0.35557803559573864, 'recall': 0.11056501395824322, 'f1-score': 0.16867993851460275, 'support': 101732}, 'accuracy': 0.3394617899521967, 'macro avg': {'precision': 0.3435235503412338, 'recall': 0.3355859369958734, 'f1-score': 0.2975562344887351, 'support': 307092}, 'weighted avg': {'precision': 0.3434898118551004, 'recall': 0.3394617899521967, 'f1-score': 0.2992239074923479, 'support': 307092}}
[[69427 23967 11576]
 [68010 23571  8809]
 [68133 22351 11248]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1418562
{'0': {'precision': 0.34167233945995007, 'recall': 0.6032501189373263, 'f1-score': 0.4362556474028737, 'support': 39937}, '1': {'precision': 0.29003577258361407, 'recall': 0.23379713877768135, 'f1-score': 0.2588975694444444, 'support': 35719}, '2': {'precision': 0.3420209993298086, 'recall': 0.12387399536113058, 'f1-score': 0.18187577959490764, 'support': 37078}, 'accuracy': 0.3285255557329643, 'macro avg': {'precision': 0.3245763704577909, 'recall': 0.32030708435871275, 'f1-score': 0.29234299881407527, 'support': 112734}, 'weighted avg': {'precision': 0.32542631854699366, 'recall': 0.3285255557329643, 'f1-score': 0.2963958896972933, 'support': 112734}}
[[24092 10572  5273]
 [23805  8351  3563]
 [22615  9870  4593]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
3337/3337 - 45s - 45s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107559
{'0': {'precision': 0.24259150885518235, 'recall': 0.646089372321891, 'f1-score': 0.352738084067401, 'support': 212370}, '1': {'precision': 0.5120043124300266, 'recall': 0.24883396514546607, 'f1-score': 0.33490445207233976, 'support': 446599}, '2': {'precision': 0.23225869726647333, 'recall': 0.08498759305210918, 'f1-score': 0.12444027399831095, 'support': 195052}, 'accuracy': 0.31019846116196204, 'macro avg': {'precision': 0.32895150618389407, 'recall': 0.32663697683982207, 'f1-score': 0.2706942700460172, 'support': 854021}, 'weighted avg': {'precision': 0.3811174386598605, 'recall': 0.31019846116196204, 'f1-score': 0.29127071187753856, 'support': 854021}}
[[137210  55895  19265]
 [299939 111129  35531]
 [128452  50023  16577]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1361301
{'0': {'precision': 0.32434656221516023, 'recall': 0.5603878304986636, 'f1-score': 0.41088007389862036, 'support': 117474}, '1': {'precision': 0.3347233443665459, 'recall': 0.32216768539964713, 'f1-score': 0.3283255219429058, 'support': 119593}, '2': {'precision': 0.3461922804680018, 'recall': 0.12886801664613023, 'f1-score': 0.1878208422515008, 'support': 129039}, 'accuracy': 0.33047532681791614, 'macro avg': {'precision': 0.3350873956832359, 'recall': 0.33714117751481365, 'f1-score': 0.3090088126976757, 'support': 366106}, 'weighted avg': {'precision': 0.33543608313385337, 'recall': 0.33047532681791614, 'f1-score': 0.3052923842006847, 'support': 366106}}
[[65831 36580 15063]
 [64722 38529 16342]
 [72412 39998 16629]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1274703
{'0': {'precision': 0.3210925776289969, 'recall': 0.5507759324802614, 'f1-score': 0.40568058555971814, 'support': 40403}, '1': {'precision': 0.35575482066140474, 'recall': 0.3155434445478311, 'f1-score': 0.3344447836194144, 'support': 45138}, '2': {'precision': 0.3108313568083683, 'recall': 0.12700661000944288, 'f1-score': 0.1803298932698245, 'support': 40242}, 'accuracy': 0.3307839692168258, 'macro avg': {'precision': 0.32922625169959, 'recall': 0.33110866234584513, 'f1-score': 0.306818420816319, 'support': 125783}, 'weighted avg': {'precision': 0.3302484435070018, 'recall': 0.3307839692168258, 'f1-score': 0.30802029611590354, 'support': 125783}}
[[22253 12893  5257]
 [24820 14243  6075]
 [22231 12900  5111]]
testing model on single stock: results/universal/W9/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
10303/10303 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1211368
{'0': {'precision': 0.3017690129512662, 'recall': 0.5133450412755283, 'f1-score': 0.3800980380741689, 'support': 794902}, '1': {'precision': 0.39221279586784674, 'recall': 0.3327563227122785, 'f1-score': 0.3600464746120405, 'support': 1034643}, '2': {'precision': 0.30517303169997695, 'recall': 0.15389071607792945, 'f1-score': 0.20460468335087445, 'support': 807859}, 'accuracy': 0.33239693274143817, 'macro avg': {'precision': 0.3330516135063633, 'recall': 0.3333306933552454, 'f1-score': 0.31491639867902793, 'support': 2637404}, 'weighted avg': {'precision': 0.3382924253941359, 'recall': 0.33239693274143817, 'f1-score': 0.3184768014989029, 'support': 2637404}}
[[408059 264911 121932]
 [529231 344284 161128]
 [414933 268604 124322]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1308156
{'0': {'precision': 0.3290726520968695, 'recall': 0.5295048765820378, 'f1-score': 0.40589362804122836, 'support': 289342}, '1': {'precision': 0.3245249639627834, 'recall': 0.3429511148040438, 'f1-score': 0.33348370589819554, 'support': 288840}, '2': {'precision': 0.3324547868007169, 'recall': 0.11680562477270584, 'f1-score': 0.17287340740722282, 'support': 296972}, 'accuracy': 0.327889719980712, 'macro avg': {'precision': 0.3286841342867899, 'recall': 0.32975387205292916, 'f1-score': 0.30408358044888223, 'support': 875154}, 'weighted avg': {'precision': 0.32871939434637254, 'recall': 0.327889719980712, 'f1-score': 0.3029227647715461, 'support': 875154}}
[[153208 101988  34146]
 [154277  99058  35505]
 [158090 104194  34688]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1271541
{'0': {'precision': 0.3322553772759964, 'recall': 0.5425771018166455, 'f1-score': 0.41213412618695383, 'support': 118350}, '1': {'precision': 0.3414234998701186, 'recall': 0.3215130216402211, 'f1-score': 0.33116926746510333, 'support': 122642}, '2': {'precision': 0.3253829186336556, 'recall': 0.13574831862669212, 'f1-score': 0.19157315985265472, 'support': 116274}, 'accuracy': 0.3342859382085057, 'macro avg': {'precision': 0.3330205985932569, 'recall': 0.33327948069451957, 'f1-score': 0.31162551783490394, 'support': 357266}, 'weighted avg': {'precision': 0.333165927496305, 'recall': 0.3342859382085057, 'f1-score': 0.31255790565961716, 'support': 357266}}
[[64214 38230 15906]
 [66392 39431 16819]
 [62661 37829 15784]]
training model: results/universal/W9/deepLOB_L2/h1000
Epoch 1/50
6697/6697 - 282s - loss: 3.1832 - accuracy1000: 0.4334 - val_loss: 3.3571 - val_accuracy1000: 0.3439 - 282s/epoch - 42ms/step
Epoch 2/50
6697/6697 - 275s - loss: 3.1474 - accuracy1000: 0.4479 - val_loss: 3.3497 - val_accuracy1000: 0.3516 - 275s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 272s - loss: 3.1366 - accuracy1000: 0.4519 - val_loss: 3.5484 - val_accuracy1000: 0.3294 - 272s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 274s - loss: 3.1397 - accuracy1000: 0.4514 - val_loss: 3.6356 - val_accuracy1000: 0.3341 - 274s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 272s - loss: 3.1152 - accuracy1000: 0.4609 - val_loss: 3.5267 - val_accuracy1000: 0.3301 - 272s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 272s - loss: 3.1068 - accuracy1000: 0.4640 - val_loss: 3.5558 - val_accuracy1000: 0.3308 - 272s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 273s - loss: 3.0953 - accuracy1000: 0.4672 - val_loss: 3.5155 - val_accuracy1000: 0.3322 - 273s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 273s - loss: 3.0877 - accuracy1000: 0.4704 - val_loss: 3.5660 - val_accuracy1000: 0.3301 - 273s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 273s - loss: 3.0798 - accuracy1000: 0.4720 - val_loss: 3.5723 - val_accuracy1000: 0.3303 - 273s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 275s - loss: 3.0738 - accuracy1000: 0.4754 - val_loss: 3.5985 - val_accuracy1000: 0.3325 - 275s/epoch - 41ms/step
Epoch 11/50
6697/6697 - 272s - loss: 3.0684 - accuracy1000: 0.4768 - val_loss: 3.6539 - val_accuracy1000: 0.3312 - 272s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 273s - loss: 3.0640 - accuracy1000: 0.4785 - val_loss: 3.6540 - val_accuracy1000: 0.3315 - 273s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 225s - 225s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.09668
{'0': {'precision': 0.2911106343837335, 'recall': 0.07872782948502653, 'f1-score': 0.1239379384464093, 'support': 1258259}, '1': {'precision': 0.40881967656727114, 'recall': 0.9056787255566493, 'f1-score': 0.5633468752151782, 'support': 1761522}, '2': {'precision': 0.30069973087274127, 'recall': 0.015181902532387619, 'f1-score': 0.028904459916921667, 'support': 1287915}, 'accuracy': 0.39788926609491476, 'macro avg': {'precision': 0.33354334727458196, 'recall': 0.3331961525246878, 'f1-score': 0.2387297578595031, 'support': 4307696}, 'weighted avg': {'precision': 0.3421116819529839, 'recall': 0.39788926609491476, 'f1-score': 0.2752098635345516, 'support': 4307696}}
[[  99060 1140155   19044]
 [ 139721 1595373   26428]
 [ 101502 1166860   19553]]
Evaluating performance on  train set...
6697/6697 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.119381
{'0': {'precision': 0.3526650799800742, 'recall': 0.1663884067457865, 'f1-score': 0.22610147999545782, 'support': 574403}, '1': {'precision': 0.3395358725072983, 'recall': 0.7913367225779966, 'f1-score': 0.4751856322547466, 'support': 565121}, '2': {'precision': 0.3586672491163973, 'recall': 0.07860660317747671, 'f1-score': 0.12895174946386706, 'support': 574481}, 'accuracy': 0.3430170857144524, 'macro avg': {'precision': 0.35028940053458996, 'recall': 0.34544391083375325, 'f1-score': 0.2767462872380238, 'support': 1714005}, 'weighted avg': {'precision': 0.3503480163025362, 'recall': 0.3430170857144524, 'f1-score': 0.2756649356816447, 'support': 1714005}}
[[ 95574 433794  45035]
 [ 82208 447201  35712]
 [ 93223 436100  45158]]
Evaluating performance on  val set...
2631/2631 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11691
{'0': {'precision': 0.34314474711368587, 'recall': 0.18872247731299036, 'f1-score': 0.24351614003679659, 'support': 221272}, '1': {'precision': 0.3544373047539513, 'recall': 0.7802616348347121, 'f1-score': 0.4874488222470357, 'support': 234984}, '2': {'precision': 0.3316999734333028, 'recall': 0.05187616567872509, 'f1-score': 0.08972050668891648, 'support': 216612}, 'accuracy': 0.3512501709101934, 'macro avg': {'precision': 0.3430940084336467, 'recall': 0.34028675927547586, 'f1-score': 0.27356182299091625, 'support': 672868}, 'weighted avg': {'precision': 0.34340407739553164, 'recall': 0.3512501709101934, 'f1-score': 0.2791937137447747, 'support': 672868}}
[[ 41759 168297  11216]
 [ 40211 183349  11424]
 [ 39725 165650  11237]]
testing model out of sample: results/universal/W9/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 119s - 119s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0930473
{'0': {'precision': 0.31005361274973114, 'recall': 0.11225784183867628, 'f1-score': 0.16483545044020664, 'support': 677966}, '1': {'precision': 0.4280909496951378, 'recall': 0.8862529890416143, 'f1-score': 0.5773175081000895, 'support': 930064}, '2': {'precision': 0.3403163427211424, 'recall': 0.022755831109195497, 'f1-score': 0.04265918336270095, 'support': 603230}, 'accuracy': 0.41338693776398977, 'macro avg': {'precision': 0.3594869683886704, 'recall': 0.340422220663162, 'f1-score': 0.261604047300999, 'support': 2211260}, 'weighted avg': {'precision': 0.3679561951459428, 'recall': 0.41338693776398977, 'f1-score': 0.3049973142129957, 'support': 2211260}}
[[ 76107 589062  12797]
 [ 91980 824272  13812]
 [ 77377 512126  13727]]
Evaluating performance on  train set...
3947/3947 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1161803
{'0': {'precision': 0.348889511713276, 'recall': 0.15575133739612865, 'f1-score': 0.21536111533073404, 'support': 327689}, '1': {'precision': 0.3496563959196081, 'recall': 0.8178371715558715, 'f1-score': 0.489873359171751, 'support': 343171}, '2': {'precision': 0.37414842551506855, 'recall': 0.0669642593543892, 'f1-score': 0.11359715130677792, 'support': 338718}, 'accuracy': 0.3510159690484539, 'macro avg': {'precision': 0.3575647777159842, 'recall': 0.3468509227687964, 'f1-score': 0.27294387526975433, 'support': 1009578}, 'weighted avg': {'precision': 0.35762466757551425, 'recall': 0.3510159690484539, 'f1-score': 0.2745297529841885, 'support': 1009578}}
[[ 51038 255269  21382]
 [ 45954 280658  16559]
 [ 49295 266741  22682]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1119254
{'0': {'precision': 0.330545149205529, 'recall': 0.08549900174590047, 'f1-score': 0.13585712105022135, 'support': 119709}, '1': {'precision': 0.325526350531537, 'recall': 0.8851594485328683, 'f1-score': 0.47599918185557905, 'support': 116997}, '2': {'precision': 0.3121172353455818, 'recall': 0.023482754081095313, 'f1-score': 0.043679216406489134, 'support': 121536}, 'accuracy': 0.32561787841738266, 'macro avg': {'precision': 0.3227295783608826, 'recall': 0.331380401453288, 'f1-score': 0.21851183977076316, 'support': 358242}, 'weighted avg': {'precision': 0.32265428401567525, 'recall': 0.32561787841738266, 'f1-score': 0.21567095323423047, 'support': 358242}}
[[ 10235 106360   3114]
 [ 10260 103561   3176]
 [ 10469 108213   2854]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033478
{'0': {'precision': 0.3943733153638814, 'recall': 0.07904511075094543, 'f1-score': 0.13169441944194418, 'support': 29616}, '1': {'precision': 0.30559013488378906, 'recall': 0.9075330549756437, 'f1-score': 0.45722174136929866, 'support': 22992}, '2': {'precision': 0.29732065687121867, 'recall': 0.01511025213036985, 'f1-score': 0.028758934916189437, 'support': 22766}, 'accuracy': 0.31245522328654446, 'macro avg': {'precision': 0.33242803570629637, 'recall': 0.333896139285653, 'f1-score': 0.20589169857581077, 'support': 75374}, 'weighted avg': {'precision': 0.33797716140041595, 'recall': 0.31245522328654446, 'f1-score': 0.19990222246474254, 'support': 75374}}
[[ 2341 26813   462]
 [ 1775 20866   351]
 [ 1820 20602   344]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1264141
{'0': {'precision': 0.38074820452352875, 'recall': 0.2164138183147505, 'f1-score': 0.27596923315981664, 'support': 16413}, '1': {'precision': 0.3317455102934735, 'recall': 0.7374634858812074, 'f1-score': 0.4576283987915407, 'support': 16432}, '2': {'precision': 0.37898330804248864, 'recall': 0.1092758696127762, 'f1-score': 0.16963830871115643, 'support': 18284}, 'accuracy': 0.34555731580903204, 'macro avg': {'precision': 0.363825674286497, 'recall': 0.35438439126957805, 'f1-score': 0.3010786468875046, 'support': 51129}, 'weighted avg': {'precision': 0.3643684271203406, 'recall': 0.34555731580903204, 'f1-score': 0.29632693205948585, 'support': 51129}}
[[ 3552 11202  1659]
 [ 2699 12118  1615]
 [ 3078 13208  1998]]
Evaluating performance on  val set...
53/53 - 1s - 957ms/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110931
{'0': {'precision': 0.3049579045837231, 'recall': 0.0763287286349801, 'f1-score': 0.12209737827715356, 'support': 4271}, '1': {'precision': 0.3372693726937269, 'recall': 0.898427260812582, 'f1-score': 0.4904310499016276, 'support': 4578}, '2': {'precision': 0.32407407407407407, 'recall': 0.015115525804361908, 'f1-score': 0.028883845677738804, 'support': 4631}, 'accuracy': 0.3344955489614243, 'macro avg': {'precision': 0.322100450450508, 'recall': 0.3299571717506413, 'f1-score': 0.21380409128550668, 'support': 13480}, 'weighted avg': {'precision': 0.3224986228268546, 'recall': 0.3344955489614243, 'f1-score': 0.215165603739242, 'support': 13480}}
[[ 326 3874   71]
 [ 390 4113   75]
 [ 353 4208   70]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.111004
{'0': {'precision': 0.3223056085971846, 'recall': 0.07938053000557785, 'f1-score': 0.1273869699522606, 'support': 91433}, '1': {'precision': 0.3324226532004177, 'recall': 0.9069767441860465, 'f1-score': 0.486525354666426, 'support': 95116}, '2': {'precision': 0.3461818181818182, 'recall': 0.014336197895751345, 'f1-score': 0.027532222147243404, 'support': 99608}, 'accuracy': 0.33182483741442637, 'macro avg': {'precision': 0.33363669332647344, 'recall': 0.3335644906957919, 'f1-score': 0.21381484892197666, 'support': 286157}, 'weighted avg': {'precision': 0.3339794600101757, 'recall': 0.33182483741442637, 'f1-score': 0.21200301946742325, 'support': 286157}}
[[ 7258 82890  1285]
 [ 7436 86268  1412]
 [ 7825 90355  1428]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1324117
{'0': {'precision': 0.3887066089497918, 'recall': 0.30564769647696477, 'f1-score': 0.3422093841784596, 'support': 46125}, '1': {'precision': 0.36939923375811756, 'recall': 0.6410165735436264, 'f1-score': 0.4687001715177163, 'support': 42417}, '2': {'precision': 0.3487229862475442, 'recall': 0.16582667486170866, 'f1-score': 0.2247696485995635, 'support': 40675}, 'accuracy': 0.37172353482900855, 'macro avg': {'precision': 0.3689429429851512, 'recall': 0.37083031496076657, 'f1-score': 0.34522640143191313, 'support': 129217}, 'weighted avg': {'precision': 0.3697826687026171, 'recall': 0.37172353482900855, 'f1-score': 0.34676372673321365, 'support': 129217}}
[[14098 24014  8013]
 [10643 27190  4584]
 [11528 22402  6745]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1274494
{'0': {'precision': 0.333181522446324, 'recall': 0.3120467978794711, 'f1-score': 0.32226802177401587, 'support': 16411}, '1': {'precision': 0.3409061779031018, 'recall': 0.6798517477155089, 'f1-score': 0.4541050430031799, 'support': 15649}, '2': {'precision': 0.6299595141700405, 'recall': 0.04938741826953596, 'f1-score': 0.09159406639981162, 'support': 15753}, 'accuracy': 0.34588919331562545, 'macro avg': {'precision': 0.4346824048398221, 'recall': 0.347095321288172, 'f1-score': 0.2893223770590025, 'support': 47813}, 'weighted avg': {'precision': 0.4334895314996531, 'recall': 0.34588919331562545, 'f1-score': 0.2894173478193455, 'support': 47813}}
[[ 5121 11015   275]
 [ 4828 10639   182]
 [ 5421  9554   778]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1465032
{'0': {'precision': 0.2992149988567945, 'recall': 0.18782442291591914, 'f1-score': 0.23078166561347305, 'support': 41805}, '1': {'precision': 0.34863401131303406, 'recall': 0.7379630101390942, 'f1-score': 0.4735499901915909, 'support': 39254}, '2': {'precision': 0.42836264432211235, 'recall': 0.1801844262295082, 'f1-score': 0.25366740231078805, 'support': 48800}, 'accuracy': 0.3512502021423236, 'macro avg': {'precision': 0.3587372181639803, 'recall': 0.36865728642817386, 'f1-score': 0.31933301937195063, 'support': 129859}, 'weighted avg': {'precision': 0.3626861407388723, 'recall': 0.3512502021423236, 'f1-score': 0.31276637028406507, 'support': 129859}}
[[ 7852 26909  7044]
 [ 5596 28968  4690]
 [12794 27213  8793]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.120015
{'0': {'precision': 0.36988774629091764, 'recall': 0.20141916730785672, 'f1-score': 0.26081421415326705, 'support': 23394}, '1': {'precision': 0.3331727584753417, 'recall': 0.7786742975090304, 'f1-score': 0.4666704152492339, 'support': 21317}, '2': {'precision': 0.4138645785352372, 'recall': 0.08097877517912667, 'f1-score': 0.13545396298948478, 'support': 22191}, 'accuracy': 0.3454007354040238, 'macro avg': {'precision': 0.37230836110049886, 'recall': 0.3536907466653379, 'f1-score': 0.2876461974639953, 'support': 66902}, 'weighted avg': {'precision': 0.37277609774631604, 'recall': 0.3454007354040238, 'f1-score': 0.2848249657778408, 'support': 66902}}
[[ 4712 17142  1540]
 [ 3713 16599  1005]
 [ 4314 16080  1797]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1315135
{'0': {'precision': 0.31737373737373736, 'recall': 0.2419901417128774, 'f1-score': 0.27460234224785873, 'support': 6492}, '1': {'precision': 0.2989006124105364, 'recall': 0.6816422682147064, 'f1-score': 0.41557242511284365, 'support': 5943}, '2': {'precision': 0.33112582781456956, 'recall': 0.008039877793857533, 'f1-score': 0.015698587127158554, 'support': 6219}, 'accuracy': 0.304063471641471, 'macro avg': {'precision': 0.31580005919961446, 'recall': 0.3105574292404804, 'f1-score': 0.2352911181626203, 'support': 18654}, 'weighted avg': {'precision': 0.31607312993271836, 'recall': 0.304063471641471, 'f1-score': 0.23319903729294134, 'support': 18654}}
[[1571 4872   49]
 [1840 4051   52]
 [1539 4630   50]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018816
{'0': {'precision': 0.3012586949320967, 'recall': 0.0789616478197643, 'f1-score': 0.12512682935218147, 'support': 46073}, '1': {'precision': 0.3830993964070145, 'recall': 0.9062674259450143, 'f1-score': 0.5385441874943516, 'support': 59179}, '2': {'precision': 0.3267834258863733, 'recall': 0.015561432058584216, 'f1-score': 0.029708161006582398, 'support': 49160}, 'accuracy': 0.3758451415693081, 'macro avg': {'precision': 0.33704717240849486, 'recall': 0.3335968352744543, 'f1-score': 0.23112639261770515, 'support': 154412}, 'weighted avg': {'precision': 0.34075074636784264, 'recall': 0.3758451415693081, 'f1-score': 0.25319229124391157, 'support': 154412}}
[[ 3638 41727   708]
 [ 4679 53632   868]
 [ 3759 44636   765]]
Evaluating performance on  train set...
323/323 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108236
{'0': {'precision': 0.38852959988629093, 'recall': 0.19482555860446885, 'f1-score': 0.2595177062565271, 'support': 28061}, '1': {'precision': 0.342103263265089, 'recall': 0.8246803209614186, 'f1-score': 0.48359581462303675, 'support': 27293}, '2': {'precision': 0.4893540238181162, 'recall': 0.049704922840071844, 'f1-score': 0.09024357779848262, 'support': 27281}, 'accuracy': 0.354946451261572, 'macro avg': {'precision': 0.4066622956564987, 'recall': 0.35640360080198646, 'f1-score': 0.2777856995593488, 'support': 82635}, 'weighted avg': {'precision': 0.4064817642704098, 'recall': 0.354946451261572, 'f1-score': 0.2776431532606202, 'support': 82635}}
[[ 5467 22025   569]
 [ 3939 22508   846]
 [ 4665 21260  1356]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1216099
{'0': {'precision': 0.42246801127738015, 'recall': 0.20243167411410162, 'f1-score': 0.2737108332162428, 'support': 9623}, '1': {'precision': 0.34263884807522776, 'recall': 0.7359562381653693, 'f1-score': 0.46758454752038503, 'support': 9506}, '2': {'precision': 0.31670090989140004, 'recall': 0.11593424304287096, 'f1-score': 0.16973415132924335, 'support': 9307}, 'accuracy': 0.35247573498382334, 'macro avg': {'precision': 0.3606025897480027, 'recall': 0.3514407184407806, 'f1-score': 0.3036765106886237, 'support': 28436}, 'weighted avg': {'precision': 0.3611643666719863, 'recall': 0.35247573498382334, 'f1-score': 0.3044905684058922, 'support': 28436}}
[[1948 6575 1100]
 [1282 6996 1228]
 [1381 6847 1079]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233788
{'0': {'precision': 0.3348784308676152, 'recall': 0.25486705428888745, 'f1-score': 0.2894451296984985, 'support': 61228}, '1': {'precision': 0.29694085417252036, 'recall': 0.6981852715899003, 'f1-score': 0.41667026028030185, 'support': 48437}, '2': {'precision': 0.31425091352009743, 'recall': 0.004995836802664446, 'f1-score': 0.009835315645013722, 'support': 51643}, 'accuracy': 0.3079884444664865, 'macro avg': {'precision': 0.31535673285341104, 'recall': 0.3193493875604841, 'f1-score': 0.23865023520793804, 'support': 161308}, 'weighted avg': {'precision': 0.31688273765489067, 'recall': 0.3079884444664865, 'f1-score': 0.23813034074089373, 'support': 161308}}
[[15605 45303   320]
 [14376 33818   243]
 [16618 34767   258]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1253405
{'0': {'precision': 0.30284963147270083, 'recall': 0.1617886790560028, 'f1-score': 0.21090659430477002, 'support': 39873}, '1': {'precision': 0.32083422919802196, 'recall': 0.748382566828828, 'f1-score': 0.44912639768845286, 'support': 39878}, '2': {'precision': 0.40013140604467806, 'recall': 0.07219061166429587, 'f1-score': 0.1223137176139787, 'support': 42180}, 'accuracy': 0.32264149395969854, 'macro avg': {'precision': 0.3412717555718003, 'recall': 0.32745395251637555, 'f1-score': 0.26078223653573385, 'support': 121931}, 'weighted avg': {'precision': 0.34238457369031866, 'recall': 0.32264149395969854, 'f1-score': 0.25817006118781805, 'support': 121931}}
[[ 6451 31001  2421]
 [ 7890 29844  2144]
 [ 6960 32175  3045]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.115956
{'0': {'precision': 0.32011095700416087, 'recall': 0.07492047003830422, 'f1-score': 0.12142255892255892, 'support': 15403}, '1': {'precision': 0.33843842260649515, 'recall': 0.7969584109248914, 'f1-score': 0.47511379195500125, 'support': 16110}, '2': {'precision': 0.2926509186351706, 'recall': 0.1016143731284989, 'f1-score': 0.1508504058755315, 'support': 15362}, 'accuracy': 0.33181866666666665, 'macro avg': {'precision': 0.31706676608194223, 'recall': 0.3244977513638982, 'f1-score': 0.2491289189176972, 'support': 46875}, 'weighted avg': {'precision': 0.31741046338131657, 'recall': 0.33181866666666665, 'f1-score': 0.25262333436883544, 'support': 46875}}
[[ 1154 12437  1812]
 [ 1310 12839  1961]
 [ 1141 12660  1561]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0780846
{'0': {'precision': 0.23975537712692932, 'recall': 0.07939547571156973, 'f1-score': 0.1192883681939083, 'support': 145172}, '1': {'precision': 0.5179496080831704, 'recall': 0.9078590872698159, 'f1-score': 0.6595909535110988, 'support': 312250}, '2': {'precision': 0.23635324378393827, 'recall': 0.011410044150110375, 'f1-score': 0.021769173060977375, 'support': 144960}, 'accuracy': 0.4924765348234177, 'macro avg': {'precision': 0.33135274299801265, 'recall': 0.3328882023771653, 'f1-score': 0.2668828315886615, 'support': 602382}, 'weighted avg': {'precision': 0.3831410947723541, 'recall': 0.4924765348234177, 'f1-score': 0.37589148671143213, 'support': 602382}}
[[ 11526 132015   1631]
 [ 25058 283479   3713]
 [ 11490 131816   1654]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1214164
{'0': {'precision': 0.3741011692615519, 'recall': 0.2792714576448403, 'f1-score': 0.3198045787163986, 'support': 107118}, '1': {'precision': 0.34582115398525287, 'recall': 0.7778096769254326, 'f1-score': 0.4787747588542817, 'support': 104496}, '2': {'precision': 0.3515163851007531, 'recall': 0.01594747582946266, 'f1-score': 0.030510750313587617, 'support': 108293}, 'accuracy': 0.3529775841103821, 'macro avg': {'precision': 0.35714623611585267, 'recall': 0.3576762034665785, 'f1-score': 0.2763633626280893, 'support': 319907}, 'weighted avg': {'precision': 0.35721837986514127, 'recall': 0.3529775841103821, 'f1-score': 0.27380136961019785, 'support': 319907}}
[[29915 75593  1610]
 [21642 81278  1576]
 [28408 78158  1727]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1226774
{'0': {'precision': 0.3774217216284281, 'recall': 0.46957959143392874, 'f1-score': 0.4184870438979343, 'support': 40532}, '1': {'precision': 0.4534256501086869, 'recall': 0.6924022621096632, 'f1-score': 0.5479931890051083, 'support': 48804}, '2': {'precision': 0.33353365384615385, 'recall': 0.014886141136711101, 'f1-score': 0.02850026959714484, 'support': 37283}, 'accuracy': 0.4215796997291086, 'macro avg': {'precision': 0.38812700852775633, 'recall': 0.39228933156010104, 'f1-score': 0.3316601675000625, 'support': 126619}, 'weighted avg': {'precision': 0.3937938055528314, 'recall': 0.4215796997291086, 'f1-score': 0.3535721496052467, 'support': 126619}}
[[19033 21048   451]
 [14354 33792   658]
 [17042 19686   555]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
3870/3870 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0810778
{'0': {'precision': 0.29446723784240375, 'recall': 0.10651655966389612, 'f1-score': 0.15644341394223193, 'support': 274915}, '1': {'precision': 0.4856540204333415, 'recall': 0.8965751771188665, 'f1-score': 0.6300334852709061, 'support': 476375}, '2': {'precision': 0.22948598526547548, 'recall': 0.011319588317850699, 'f1-score': 0.02157497303128371, 'support': 239408}, 'accuracy': 0.46340963643814764, 'macro avg': {'precision': 0.33653574784707363, 'recall': 0.3381371083668711, 'f1-score': 0.2693506240814739, 'support': 990698}, 'weighted avg': {'precision': 0.37069588859149255, 'recall': 0.46340963643814764, 'f1-score': 0.3515764277643946, 'support': 990698}}
[[ 29283 242629   3003]
 [ 43173 427106   6096]
 [ 26988 209710   2710]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1179475
{'0': {'precision': 0.3730581744161131, 'recall': 0.2062824433698896, 'f1-score': 0.2656653076794697, 'support': 135043}, '1': {'precision': 0.36617083723750204, 'recall': 0.768443882161576, 'f1-score': 0.49599522179681904, 'support': 138325}, '2': {'precision': 0.3659403372243839, 'recall': 0.108396981758387, 'f1-score': 0.16725155905437128, 'support': 130142}, 'accuracy': 0.36742336001586084, 'macro avg': {'precision': 0.368389782959333, 'recall': 0.36104110242995086, 'f1-score': 0.30963736284355337, 'support': 403510}, 'weighted avg': {'precision': 0.36840148565242103, 'recall': 0.36742336001586084, 'f1-score': 0.3128825347536805, 'support': 403510}}
[[ 27857  92845  14341]
 [ 21928 106295  10102]
 [ 24887  91148  14107]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1087569
{'0': {'precision': 0.3279583875162549, 'recall': 0.07477614595481409, 'f1-score': 0.12178476000386311, 'support': 50591}, '1': {'precision': 0.33059871703492516, 'recall': 0.9138066905709444, 'f1-score': 0.4855384228872908, 'support': 50758}, '2': {'precision': 0.3318885448916409, 'recall': 0.010287710408629393, 'f1-score': 0.019956809889046093, 'support': 52101}, 'accuracy': 0.3304138155751059, 'macro avg': {'precision': 0.3301485498142736, 'recall': 0.3329568489781293, 'f1-score': 0.20909333092673335, 'support': 153450}, 'weighted avg': {'precision': 0.3301661618735286, 'recall': 0.3304138155751059, 'f1-score': 0.2075330193176783, 'support': 153450}}
[[ 3783 46281   527]
 [ 3823 46383   552]
 [ 3929 47636   536]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
2451/2451 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037208
{'0': {'precision': 0.32535992040124273, 'recall': 0.07833981968591712, 'f1-score': 0.12627522371827457, 'support': 204532}, '1': {'precision': 0.3533844204682656, 'recall': 0.9085469969949675, 'f1-score': 0.5088491332542706, 'support': 221961}, '2': {'precision': 0.31647612642905176, 'recall': 0.011715327013462918, 'f1-score': 0.02259425877291954, 'support': 200848}, 'accuracy': 0.3507470418799345, 'macro avg': {'precision': 0.3317401557661867, 'recall': 0.33286738123144916, 'f1-score': 0.21923953858182157, 'support': 627341}, 'weighted avg': {'precision': 0.3324311206059955, 'recall': 0.3507470418799345, 'f1-score': 0.2284403509571679, 'support': 627341}}
[[ 16023 186099   2410]
 [ 17627 201662   2672]
 [ 15597 182898   2353]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1344129
{'0': {'precision': 0.32672090684706095, 'recall': 0.23820768190733724, 'f1-score': 0.27553015159775107, 'support': 105026}, '1': {'precision': 0.3460287362897821, 'recall': 0.6245156849247714, 'f1-score': 0.4453178412529232, 'support': 101690}, '2': {'precision': 0.3556652762407423, 'recall': 0.16649398262532877, 'f1-score': 0.22681251866127414, 'support': 100376}, 'accuracy': 0.3426888359188777, 'macro avg': {'precision': 0.3428049731258618, 'recall': 0.34307244981914575, 'f1-score': 0.31588683717064947, 'support': 307092}, 'weighted avg': {'precision': 0.3425752215094113, 'recall': 0.3426888359188777, 'f1-score': 0.31582957013487556, 'support': 307092}}
[[25018 63281 16727]
 [24634 63507 13549]
 [26921 56743 16712]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336046
{'0': {'precision': 0.28069940076916194, 'recall': 0.1652711953659821, 'f1-score': 0.20804746279539957, 'support': 37980}, '1': {'precision': 0.3248683165111968, 'recall': 0.5600223197301342, 'f1-score': 0.4111999851014499, 'support': 39427}, '2': {'precision': 0.3204498794965634, 'recall': 0.20324397769411498, 'f1-score': 0.2487312282403478, 'support': 35327}, 'accuracy': 0.3152287686057445, 'macro avg': {'precision': 0.30867253225897406, 'recall': 0.30951249759674376, 'f1-score': 0.28932622537906577, 'support': 112734}, 'weighted avg': {'precision': 0.308603254113886, 'recall': 0.3152287686057445, 'f1-score': 0.29184587213804986, 'support': 112734}}
[[ 6277 23981  7722]
 [ 9843 22080  7504]
 [ 6242 21905  7180]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
3337/3337 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0922549
{'0': {'precision': 0.313046592842432, 'recall': 0.07757339072935851, 'f1-score': 0.12433611532625191, 'support': 270402}, '1': {'precision': 0.4014134474747242, 'recall': 0.9137391182661527, 'f1-score': 0.5577864942978772, 'support': 343006}, '2': {'precision': 0.26922459463798365, 'recall': 0.006969698229106491, 'f1-score': 0.013587639056562498, 'support': 240613}, 'accuracy': 0.3935160844990931, 'macro avg': {'precision': 0.32789487831837993, 'recall': 0.33276073574153925, 'f1-score': 0.23190341622689717, 'support': 854021}, 'weighted avg': {'precision': 0.3361914790759521, 'recall': 0.3935160844990931, 'f1-score': 0.26722318434312914, 'support': 854021}}
[[ 20976 247308   2118]
 [ 27154 313418   2434]
 [ 18876 220060   1677]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1092579
{'0': {'precision': 0.30620655932380986, 'recall': 0.07760742170210506, 'f1-score': 0.12383030713927556, 'support': 112966}, '1': {'precision': 0.34746279782031747, 'recall': 0.9087007443856656, 'f1-score': 0.5027047711815762, 'support': 127219}, '2': {'precision': 0.33655056651279897, 'recall': 0.012738145345097323, 'f1-score': 0.02454720056317767, 'support': 125921}, 'accuracy': 0.3440943333351543, 'macro avg': {'precision': 0.3300733078856421, 'recall': 0.33301543714428933, 'f1-score': 0.2170274262946765, 'support': 366106}, 'weighted avg': {'precision': 0.3309795079630889, 'recall': 0.3440943333351543, 'f1-score': 0.2213381392366152, 'support': 366106}}
[[  8767 102736   1463]
 [  9916 115604   1699]
 [  9948 114369   1604]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108956
{'0': {'precision': 0.3445572419338627, 'recall': 0.07981002048798659, 'f1-score': 0.12960057465832406, 'support': 42952}, '1': {'precision': 0.3142346822631201, 'recall': 0.9061300747323773, 'f1-score': 0.4666432629922898, 'support': 39608}, '2': {'precision': 0.33024691358024694, 'recall': 0.012377669296439396, 'f1-score': 0.02386102624712887, 'support': 43223}, 'accuracy': 0.3168393185088605, 'macro avg': {'precision': 0.3296796125924099, 'recall': 0.33277258817226774, 'f1-score': 0.20670162129924755, 'support': 125783}, 'weighted avg': {'precision': 0.33009144555544034, 'recall': 0.3168393185088605, 'f1-score': 0.19939702011243648, 'support': 125783}}
[[ 3428 38972   552]
 [ 3185 35890   533]
 [ 3336 39352   535]]
testing model on single stock: results/universal/W9/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
10303/10303 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973101
{'0': {'precision': 0.29169077095144436, 'recall': 0.07847231498906036, 'f1-score': 0.12367332630883993, 'support': 771049}, '1': {'precision': 0.4068599612483188, 'recall': 0.9046948041781296, 'f1-score': 0.5612942786263105, 'support': 1073016}, '2': {'precision': 0.30262888823248735, 'recall': 0.016788535544073845, 'f1-score': 0.03181226488326268, 'support': 793339}, 'accuracy': 0.3960625675853984, 'macro avg': {'precision': 0.3337265401440835, 'recall': 0.3333185515704213, 'f1-score': 0.23892662327280442, 'support': 2637404}, 'weighted avg': {'precision': 0.34183705833146516, 'recall': 0.3960625675853984, 'f1-score': 0.2740853682870795, 'support': 2637404}}
[[ 60506 697680  12863]
 [ 84435 970752  17829]
 [ 62491 717529  13319]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1124653
{'0': {'precision': 0.32933141404551164, 'recall': 0.07465468822138834, 'f1-score': 0.12171772196674921, 'support': 288073}, '1': {'precision': 0.33290430572111623, 'recall': 0.8719301581813467, 'f1-score': 0.48184097092721107, 'support': 289225}, '2': {'precision': 0.35986622073578595, 'recall': 0.06321846798452943, 'f1-score': 0.10754438418989037, 'support': 297856}, 'accuracy': 0.33424974347372005, 'macro avg': {'precision': 0.340700646834138, 'recall': 0.33660110479575484, 'f1-score': 0.23703435902795023, 'support': 875154}, 'weighted avg': {'precision': 0.3409046285613741, 'recall': 0.33424974347372005, 'f1-score': 0.23590909055299294, 'support': 875154}}
[[ 21506 248535  18032]
 [ 21578 252184  15463]
 [ 22218 256808  18830]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107391
{'0': {'precision': 0.33215485858302995, 'recall': 0.08129294244641297, 'f1-score': 0.1306179195286798, 'support': 116726}, '1': {'precision': 0.340555744444101, 'recall': 0.9061004292833764, 'f1-score': 0.4950486152297766, 'support': 121598}, '2': {'precision': 0.33475232198142413, 'recall': 0.014544904239040876, 'f1-score': 0.027878494883571026, 'support': 118942}, 'accuracy': 0.3398000369472606, 'macro avg': {'precision': 0.33582097500285174, 'recall': 0.3339794253229434, 'f1-score': 0.21784834321400917, 'support': 357266}, 'weighted avg': {'precision': 0.33587891407800097, 'recall': 0.3398000369472606, 'f1-score': 0.22045017641773007, 'support': 357266}}
[[  9489 105574   1663]
 [  9643 110180   1775]
 [  9436 107776   1730]]
training model: results/universal/W9/deepOF_L2/h300
Epoch 1/50
6697/6697 - 157s - loss: 3.2540 - accuracy300: 0.3910 - val_loss: 3.2788 - val_accuracy300: 0.3612 - 157s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 152s - loss: 3.2349 - accuracy300: 0.3982 - val_loss: 3.2808 - val_accuracy300: 0.3581 - 152s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 151s - loss: 3.2211 - accuracy300: 0.4047 - val_loss: 3.2850 - val_accuracy300: 0.3560 - 151s/epoch - 22ms/step
Epoch 4/50
6697/6697 - 151s - loss: 3.2097 - accuracy300: 0.4104 - val_loss: 3.2837 - val_accuracy300: 0.3590 - 151s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 150s - loss: 3.2031 - accuracy300: 0.4132 - val_loss: 3.2827 - val_accuracy300: 0.3604 - 150s/epoch - 22ms/step
Epoch 6/50
6697/6697 - 151s - loss: 3.1990 - accuracy300: 0.4152 - val_loss: 3.2801 - val_accuracy300: 0.3643 - 151s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 150s - loss: 3.1965 - accuracy300: 0.4165 - val_loss: 3.2868 - val_accuracy300: 0.3614 - 150s/epoch - 22ms/step
Epoch 8/50
6697/6697 - 150s - loss: 3.1940 - accuracy300: 0.4174 - val_loss: 3.2834 - val_accuracy300: 0.3652 - 150s/epoch - 22ms/step
Epoch 9/50
6697/6697 - 152s - loss: 3.1926 - accuracy300: 0.4183 - val_loss: 3.2823 - val_accuracy300: 0.3671 - 152s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 151s - loss: 3.1905 - accuracy300: 0.4194 - val_loss: 3.2830 - val_accuracy300: 0.3662 - 151s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 151s - loss: 3.1889 - accuracy300: 0.4200 - val_loss: 3.2826 - val_accuracy300: 0.3674 - 151s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 129s - 129s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923654
{'0': {'precision': 0.3691580723076333, 'recall': 0.19992065610725515, 'f1-score': 0.25937474144781525, 'support': 1348560}, '1': {'precision': 0.3706934123496857, 'recall': 0.505747670920207, 'f1-score': 0.4278150203134313, 'support': 1604389}, '2': {'precision': 0.35234486523705055, 'recall': 0.3611126079276489, 'f1-score': 0.3566748627953477, 'support': 1354727}, 'accuracy': 0.3645190585364359, 'macro avg': {'precision': 0.3640654499647898, 'recall': 0.35559364498503704, 'f1-score': 0.3479548748521981, 'support': 4307676}, 'weighted avg': {'precision': 0.3644422991389036, 'recall': 0.3645190585364359, 'f1-score': 0.35271018080344585, 'support': 4307676}}
[[269605 697302 381653]
 [275397 811416 517576]
 [185322 680196 489209]]
Evaluating performance on  train set...
6697/6697 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934863
{'0': {'precision': 0.40203460231972826, 'recall': 0.19945095628606155, 'f1-score': 0.26662713591536064, 'support': 572632}, '1': {'precision': 0.3293699493598766, 'recall': 0.4847071351372387, 'f1-score': 0.3922182987207986, 'support': 565329}, '2': {'precision': 0.3812079302300302, 'recall': 0.3957186852256275, 'f1-score': 0.3883277981402092, 'support': 576038}, 'accuracy': 0.35949845945067643, 'macro avg': {'precision': 0.3708708273032117, 'recall': 0.35995892554964254, 'f1-score': 0.34905774425878944, 'support': 1713999}, 'weighted avg': {'precision': 0.3710681956121715, 'recall': 0.35949845945067643, 'f1-score': 0.3489518820466669, 'support': 1713999}}
[[114212 283072 175348]
 [ 96642 274019 194668]
 [ 73231 274858 227949]]
Evaluating performance on  val set...
2631/2631 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0928512
{'0': {'precision': 0.39925094902386116, 'recall': 0.20864921354683294, 'f1-score': 0.27406933457422056, 'support': 225824}, '1': {'precision': 0.3398808619274838, 'recall': 0.4894864006022778, 'f1-score': 0.4011903224417753, 'support': 228466}, '2': {'precision': 0.3731306931657655, 'recall': 0.38549696900377445, 'f1-score': 0.37921304068011713, 'support': 218575}, 'accuracy': 0.36145289173905615, 'macro avg': {'precision': 0.3707541680390369, 'recall': 0.36121086105096173, 'f1-score': 0.35149089923203763, 'support': 672865}, 'weighted avg': {'precision': 0.3706073411043763, 'recall': 0.36145289173905615, 'f1-score': 0.35138738377613343, 'support': 672865}}
[[ 47118 112035  66671]
 [ 41747 111831  74888]
 [ 29151 105164  84260]]
testing model out of sample: results/universal/W9/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 72s - 72s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904747
{'0': {'precision': 0.41281278079513817, 'recall': 0.2629953265891072, 'f1-score': 0.3212978090055563, 'support': 745922}, '1': {'precision': 0.3407286092835589, 'recall': 0.42471546154987855, 'f1-score': 0.37811438893908367, 'support': 768086}, '2': {'precision': 0.3649356420511319, 'recall': 0.4075314959726461, 'f1-score': 0.3850591457374279, 'support': 697232}, 'accuracy': 0.3647437636801071, 'macro avg': {'precision': 0.37282567737660965, 'recall': 0.36508076137054396, 'f1-score': 0.3614904478940226, 'support': 2211240}, 'weighted avg': {'precision': 0.37267769090873787, 'recall': 0.3647437636801071, 'f1-score': 0.3611381085420425, 'support': 2211240}}
[[196174 332556 217192]
 [164590 326218 277278]
 [114449 298639 284144]]
Evaluating performance on  train set...
3947/3947 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913845
{'0': {'precision': 0.3877412278713935, 'recall': 0.2605456865545732, 'f1-score': 0.31166541286960453, 'support': 328357}, '1': {'precision': 0.3315788646048851, 'recall': 0.428945900076721, 'f1-score': 0.3740296204132262, 'support': 344104}, '2': {'precision': 0.38194733305602663, 'recall': 0.3895044095006719, 'f1-score': 0.3856888570354357, 'support': 337113}, 'accuracy': 0.3610047406133676, 'macro avg': {'precision': 0.36708914184410174, 'recall': 0.3596653320439887, 'f1-score': 0.35712796343942216, 'support': 1009574}, 'weighted avg': {'precision': 0.3666641289045507, 'recall': 0.3610047406133676, 'f1-score': 0.35763929750378315, 'support': 1009574}}
[[ 85552 148807  93998]
 [ 78024 147602 118478]
 [ 57066 148740 131307]]
Evaluating performance on  val set...
1402/1402 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904789
{'0': {'precision': 0.3908317580340265, 'recall': 0.2545398584179748, 'f1-score': 0.3082945013979497, 'support': 116964}, '1': {'precision': 0.34073811617768945, 'recall': 0.4318961922176242, 'f1-score': 0.3809395811744234, 'support': 124692}, '2': {'precision': 0.3763204154369668, 'recall': 0.400300210147103, 'f1-score': 0.3879400995016605, 'support': 116585}, 'accuracy': 0.3637076716512069, 'macro avg': {'precision': 0.36929676321622756, 'recall': 0.3622454202609007, 'f1-score': 0.3590580606913445, 'support': 358241}, 'weighted avg': {'precision': 0.3686732634255685, 'recall': 0.3637076716512069, 'f1-score': 0.35949953472023605, 'support': 358241}}
[[29772 53170 34022]
 [27515 53854 43323]
 [18889 51027 46669]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953972
{'0': {'precision': 0.40621712099473933, 'recall': 0.16043366576004836, 'f1-score': 0.2300213935602676, 'support': 26472}, '1': {'precision': 0.34202822563027047, 'recall': 0.60553084509766, 'f1-score': 0.4371413812841168, 'support': 25855}, '2': {'precision': 0.3438169374640823, 'recall': 0.2855964935121295, 'f1-score': 0.31201403375687464, 'support': 23043}, 'accuracy': 0.3513864932997214, 'macro avg': {'precision': 0.3640207613630307, 'recall': 0.35052033478994593, 'f1-score': 0.326392269533753, 'support': 75370}, 'weighted avg': {'precision': 0.36511998262741446, 'recall': 0.3513864932997214, 'f1-score': 0.32613979200328913, 'support': 75370}}
[[ 4247 16011  6214]
 [ 3853 15656  6346]
 [ 2355 14107  6581]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005656
{'0': {'precision': 0.3319126953377244, 'recall': 0.15125654758401508, 'f1-score': 0.20781111021266271, 'support': 16991}, '1': {'precision': 0.3181650018497965, 'recall': 0.5617577197149644, 'f1-score': 0.4062439610933373, 'support': 16840}, '2': {'precision': 0.3621510733387061, 'recall': 0.28582167225627386, 'f1-score': 0.3194906764050028, 'support': 17294}, 'accuracy': 0.3319902200488998, 'macro avg': {'precision': 0.337409590175409, 'recall': 0.3329453131850844, 'f1-score': 0.31118191590366756, 'support': 51125}, 'weighted avg': {'precision': 0.3376130640577688, 'recall': 0.3319902200488998, 'f1-score': 0.31095038897179994, 'support': 51125}}
[[ 2570 10061  4360]
 [ 3034  9460  4346]
 [ 2139 10212  4943]]
Evaluating performance on  val set...
53/53 - 1s - 621ms/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929585
{'0': {'precision': 0.31314699792960665, 'recall': 0.14449486505851444, 'f1-score': 0.1977447295309691, 'support': 4187}, '1': {'precision': 0.3920647350561211, 'recall': 0.555781683626272, 'f1-score': 0.45978418917884745, 'support': 5405}, '2': {'precision': 0.32321152856407614, 'recall': 0.3230452674897119, 'f1-score': 0.32312837664008226, 'support': 3888}, 'accuracy': 0.36090504451038574, 'macro avg': {'precision': 0.3428077538499346, 'recall': 0.3411072720581661, 'f1-score': 0.326885765116633, 'support': 13480}, 'weighted avg': {'precision': 0.34769308578388175, 'recall': 0.36090504451038574, 'f1-score': 0.33897728883045086, 'support': 13480}}
[[ 605 2446 1136]
 [ 907 3004 1494]
 [ 420 2212 1256]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0846668
{'0': {'precision': 0.3853107524148449, 'recall': 0.27960894176783224, 'f1-score': 0.32405817627920336, 'support': 86739}, '1': {'precision': 0.37802585008216405, 'recall': 0.43120415262332606, 'f1-score': 0.40286770339561, 'support': 110966}, '2': {'precision': 0.387693645028096, 'recall': 0.42357091172214184, 'f1-score': 0.4048389624002464, 'support': 88448}, 'accuracy': 0.382893067694555, 'macro avg': {'precision': 0.38367674917503497, 'recall': 0.3781280020377667, 'f1-score': 0.3772549473583533, 'support': 286153}, 'weighted avg': {'precision': 0.3832223088675418, 'recall': 0.382893067694555, 'f1-score': 0.3795881793084681, 'support': 286153}}
[[24253 40671 21815]
 [25763 47849 37354]
 [12928 38056 37464]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0856451
{'0': {'precision': 0.437679138585483, 'recall': 0.2614348842051685, 'f1-score': 0.3273417244825538, 'support': 43223}, '1': {'precision': 0.3596812216318919, 'recall': 0.4363182380810107, 'f1-score': 0.3943105110896818, 'support': 46858}, '2': {'precision': 0.3761625534291299, 'recall': 0.44749080130825836, 'f1-score': 0.4087381699788781, 'support': 39136}, 'accuracy': 0.38120371158593686, 'macro avg': {'precision': 0.39117430454883495, 'recall': 0.3817479745314792, 'f1-score': 0.3767968018503712, 'support': 129217}, 'weighted avg': {'precision': 0.3907631796227273, 'recall': 0.38120371158593686, 'f1-score': 0.37627920711859203, 'support': 129217}}
[[11300 19931 11992]
 [ 9361 20445 17052]
 [ 5157 16466 17513]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0836565
{'0': {'precision': 0.4189708844533968, 'recall': 0.29539732748047254, 'f1-score': 0.3464960436148866, 'support': 15491}, '1': {'precision': 0.3742636135443881, 'recall': 0.4210708316523543, 'f1-score': 0.39628986765024954, 'support': 17351}, '2': {'precision': 0.39538231229848, 'recall': 0.45874807936401896, 'f1-score': 0.42471472307264124, 'support': 14969}, 'accuracy': 0.392148250402627, 'macro avg': {'precision': 0.39620560343208827, 'recall': 0.3917387461656152, 'f1-score': 0.3891668781125925, 'support': 47811}, 'weighted avg': {'precision': 0.3953609789059462, 'recall': 0.392148250402627, 'f1-score': 0.38905587406479797, 'support': 47811}}
[[4576 6469 4446]
 [3990 7306 6055]
 [2356 5746 6867]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956819
{'0': {'precision': 0.37580054894785, 'recall': 0.16167281672816727, 'f1-score': 0.22608276858509066, 'support': 40650}, '1': {'precision': 0.3060731594184354, 'recall': 0.413617205230736, 'f1-score': 0.3518099755483242, 'support': 46265}, '2': {'precision': 0.3231954419612406, 'recall': 0.37517466231951563, 'f1-score': 0.347250662815511, 'support': 42940}, 'accuracy': 0.3220361172076547, 'macro avg': {'precision': 0.3350230501091753, 'recall': 0.3168215614261396, 'f1-score': 0.3083811356496419, 'support': 129855}, 'weighted avg': {'precision': 0.3335626607603842, 'recall': 0.3220361172076547, 'f1-score': 0.3109444882601763, 'support': 129855}}
[[ 6572 20959 13119]
 [ 6512 19136 20617]
 [ 4404 22426 16110]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982556
{'0': {'precision': 0.36447431589054247, 'recall': 0.17016317016317017, 'f1-score': 0.23200806771995233, 'support': 22308}, '1': {'precision': 0.3191797280323303, 'recall': 0.5273629596210241, 'f1-score': 0.397672954904996, 'support': 22165}, '2': {'precision': 0.35308331235841933, 'recall': 0.3127201391056222, 'f1-score': 0.3316782522343595, 'support': 22429}, 'accuracy': 0.33629786852410987, 'macro avg': {'precision': 0.3455791187604307, 'recall': 0.33674875629660544, 'f1-score': 0.32045309161976926, 'support': 66902}, 'weighted avg': {'precision': 0.34564911846596225, 'recall': 0.33629786852410987, 'f1-score': 0.3203083396539772, 'support': 66902}}
[[ 3796 12324  6188]
 [ 3813 11689  6663]
 [ 2806 12609  7014]]
Evaluating performance on  val set...
73/73 - 1s - 804ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015207
{'0': {'precision': 0.3524163568773234, 'recall': 0.1470451372731503, 'f1-score': 0.20750793477071247, 'support': 6447}, '1': {'precision': 0.3184855233853007, 'recall': 0.5331496190630572, 'f1-score': 0.3987633365664403, 'support': 6169}, '2': {'precision': 0.33197303051809796, 'recall': 0.3099221467616366, 'f1-score': 0.3205688340615095, 'support': 6037}, 'accuracy': 0.32745402884254543, 'macro avg': {'precision': 0.33429163692690733, 'recall': 0.33003896769928137, 'f1-score': 0.3089467017995541, 'support': 18653}, 'weighted avg': {'precision': 0.33457817143568225, 'recall': 0.32745402884254543, 'f1-score': 0.3073526365718376, 'support': 18653}}
[[ 948 3660 1839]
 [ 954 3289 1926]
 [ 788 3378 1871]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957321
{'0': {'precision': 0.3600202258553851, 'recall': 0.0919144541503507, 'f1-score': 0.146441793500617, 'support': 46478}, '1': {'precision': 0.37672853980846355, 'recall': 0.5836884369217188, 'f1-score': 0.45790963273732227, 'support': 58903}, '2': {'precision': 0.3134555382215289, 'recall': 0.32786015868806984, 'f1-score': 0.3204960770434765, 'support': 49027}, 'accuracy': 0.35443111755867573, 'macro avg': {'precision': 0.3500681012951259, 'recall': 0.3344876832533798, 'f1-score': 0.30828250109380523, 'support': 154408}, 'weighted avg': {'precision': 0.3516090222658892, 'recall': 0.35443111755867573, 'f1-score': 0.32052441547496696, 'support': 154408}}
[[ 4272 27422 14784]
 [ 4100 34381 20422]
 [ 3494 29459 16074]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020495
{'0': {'precision': 0.3633559531153609, 'recall': 0.08187093859679605, 'f1-score': 0.13363205808116616, 'support': 28777}, '1': {'precision': 0.3294891363747715, 'recall': 0.6444894950239587, 'f1-score': 0.4360512238612417, 'support': 27130}, '2': {'precision': 0.33183157165136024, 'recall': 0.2865908410655492, 'f1-score': 0.30755641210953183, 'support': 26728}, 'accuracy': 0.33280087130150665, 'macro avg': {'precision': 0.3415588870471642, 'recall': 0.3376504248954347, 'f1-score': 0.2924132313506465, 'support': 82635}, 'weighted avg': {'precision': 0.3420406459701803, 'recall': 0.33280087130150665, 'f1-score': 0.2891748922565592, 'support': 82635}}
[[ 2356 18411  8010]
 [ 2231 17485  7414]
 [ 1897 17171  7660]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038435
{'0': {'precision': 0.36584344914190037, 'recall': 0.08815816017752673, 'f1-score': 0.142079167682679, 'support': 9914}, '1': {'precision': 0.302812295618051, 'recall': 0.639429163309932, 'f1-score': 0.41099234382512856, 'support': 8689}, '2': {'precision': 0.34203689269940246, 'recall': 0.2677990235964198, 'f1-score': 0.3003993154592128, 'support': 9832}, 'accuracy': 0.3187269210480042, 'macro avg': {'precision': 0.33689754581978465, 'recall': 0.33179544902795954, 'f1-score': 0.2844902756556735, 'support': 28435}, 'weighted avg': {'precision': 0.33835114191800847, 'recall': 0.3187269210480042, 'f1-score': 0.2789945986811184, 'support': 28435}}
[[ 874 6385 2655]
 [ 723 5556 2410]
 [ 792 6407 2633]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1043847
{'0': {'precision': 0.4039331980646168, 'recall': 0.08669435883692884, 'f1-score': 0.1427507653272291, 'support': 59704}, '1': {'precision': 0.2871049265233534, 'recall': 0.576795303065126, 'f1-score': 0.38337939367005985, 'support': 47861}, '2': {'precision': 0.3409442650514932, 'recall': 0.3320493496343438, 'f1-score': 0.33643802556657487, 'support': 53739}, 'accuracy': 0.31385458513118086, 'macro avg': {'precision': 0.3439941298798212, 'recall': 0.3318463371787996, 'f1-score': 0.2875227281879546, 'support': 161304}, 'weighted avg': {'precision': 0.34828374005099866, 'recall': 0.31385458513118086, 'f1-score': 0.2786760149125985, 'support': 161304}}
[[ 5176 36401 18127]
 [ 3889 27606 16366]
 [ 3749 32146 17844]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099477
{'0': {'precision': 0.33459822914586246, 'recall': 0.12601544478989068, 'f1-score': 0.18307986522174666, 'support': 39884}, '1': {'precision': 0.3102966144012783, 'recall': 0.5400526420341677, 'f1-score': 0.3941357157743084, 'support': 40272}, '2': {'precision': 0.35750563567723187, 'recall': 0.3150927588270497, 'f1-score': 0.334961956383439, 'support': 41775}, 'accuracy': 0.3275459071113991, 'macro avg': {'precision': 0.33413349307479084, 'recall': 0.327053615217036, 'f1-score': 0.304059179126498, 'support': 121931}, 'weighted avg': {'precision': 0.33442011430102453, 'recall': 0.3275459071113991, 'f1-score': 0.30482507826627564, 'support': 121931}}
[[ 5026 23731 11127]
 [ 5994 21749 12529]
 [ 4001 24611 13163]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982287
{'0': {'precision': 0.3259566620562471, 'recall': 0.13684753855087425, 'f1-score': 0.1927656093792602, 'support': 15499}, '1': {'precision': 0.33879739267944614, 'recall': 0.5307873587527947, 'f1-score': 0.4135982672568038, 'support': 16549}, '2': {'precision': 0.34069662765736447, 'recall': 0.33182707223308827, 'f1-score': 0.3362033620336204, 'support': 14827}, 'accuracy': 0.3376, 'macro avg': {'precision': 0.3351502274643526, 'recall': 0.33315398984558575, 'f1-score': 0.31418907955656145, 'support': 46875}, 'weighted avg': {'precision': 0.3351524107720037, 'recall': 0.3376, 'f1-score': 0.3161002486074558, 'support': 46875}}
[[2121 8815 4563]
 [2807 8784 4958]
 [1579 8328 4920]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0857846
{'0': {'precision': 0.4071393993499349, 'recall': 0.329003185376733, 'f1-score': 0.3639244952205407, 'support': 196837}, '1': {'precision': 0.34565784058169846, 'recall': 0.36027168732125836, 'f1-score': 0.3528134991948095, 'support': 209800}, '2': {'precision': 0.40432767853565815, 'recall': 0.4640366606893804, 'f1-score': 0.4321293662045539, 'support': 195741}, 'accuracy': 0.3837723157220217, 'macro avg': {'precision': 0.38570830615576385, 'recall': 0.3844371777957906, 'f1-score': 0.3829557868733014, 'support': 602378}, 'weighted avg': {'precision': 0.3848125546220674, 'recall': 0.3837723157220217, 'f1-score': 0.38221766443502614, 'support': 602378}}
[[64760 75687 56390]
 [56789 75585 77426]
 [37512 67398 90831]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0825381
{'0': {'precision': 0.43084237931338804, 'recall': 0.3669720460418135, 'f1-score': 0.3963505908977892, 'support': 106425}, '1': {'precision': 0.3296581626007183, 'recall': 0.33722291490191975, 'f1-score': 0.33339763344232987, 'support': 105067}, '2': {'precision': 0.4259812777139103, 'recall': 0.47849908683380377, 'f1-score': 0.4507154834617757, 'support': 108414}, 'accuracy': 0.3949972804511325, 'macro avg': {'precision': 0.39549393987600556, 'recall': 0.39423134925917896, 'f1-score': 0.39348790260063155, 'support': 319906}, 'weighted avg': {'precision': 0.39596296609151704, 'recall': 0.3949972804511325, 'f1-score': 0.3940987953123962, 'support': 319906}}
[[39055 37062 30308]
 [30040 35431 39596]
 [21553 34985 51876]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0810835
{'0': {'precision': 0.42900167609469936, 'recall': 0.3834862814870306, 'f1-score': 0.40496909765142153, 'support': 42716}, '1': {'precision': 0.32801561979141863, 'recall': 0.323836389280677, 'f1-score': 0.32591260734817473, 'support': 42540}, '2': {'precision': 0.4202683205202748, 'recall': 0.47182264342528346, 'f1-score': 0.44455580865603644, 'support': 41363}, 'accuracy': 0.39230289293076076, 'macro avg': {'precision': 0.3924285388021309, 'recall': 0.3930484380643304, 'f1-score': 0.3918125045518776, 'support': 126619}, 'weighted avg': {'precision': 0.39222058777646523, 'recall': 0.39230289293076076, 'f1-score': 0.3913405113396024, 'support': 126619}}
[[16381 14773 11562]
 [13405 13776 15359]
 [ 8398 13449 19516]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0893743
{'0': {'precision': 0.44332757247666005, 'recall': 0.3019930113313385, 'f1-score': 0.35925971059167194, 'support': 346561}, '1': {'precision': 0.31626562971063, 'recall': 0.3857614758951666, 'f1-score': 0.34757374784498496, 'support': 320890}, '2': {'precision': 0.389300030835646, 'recall': 0.43744180075051897, 'f1-score': 0.4119692508948095, 'support': 323243}, 'accuracy': 0.3733201170088847, 'macro avg': {'precision': 0.38296441100764533, 'recall': 0.3750654293256747, 'f1-score': 0.3729342364438222, 'support': 990694}, 'weighted avg': {'precision': 0.3845435973472481, 'recall': 0.3733201170088847, 'f1-score': 0.3726726124063824, 'support': 990694}}
[[104659 142238  99664]
 [ 74951 123787 122152]
 [ 56466 125377 141400]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0855106
{'0': {'precision': 0.4006811758307403, 'recall': 0.34771171031761383, 'f1-score': 0.3723219167867972, 'support': 129245}, '1': {'precision': 0.36184773906081386, 'recall': 0.35145351392655005, 'f1-score': 0.35657489417463073, 'support': 147883}, '2': {'precision': 0.37903138454872864, 'recall': 0.4430140368090393, 'f1-score': 0.40853271457653834, 'support': 126382}, 'accuracy': 0.37893236846670464, 'macro avg': {'precision': 0.38052009981342766, 'recall': 0.3807264203510677, 'f1-score': 0.3791431751793221, 'support': 403510}, 'weighted avg': {'precision': 0.37966819213355746, 'recall': 0.37893236846670464, 'f1-score': 0.37789222756300617, 'support': 403510}}
[[44940 47784 36521]
 [40703 51974 55206]
 [26516 43877 55989]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0834723
{'0': {'precision': 0.39684161860963085, 'recall': 0.3427484605846626, 'f1-score': 0.3678168696436626, 'support': 47583}, '1': {'precision': 0.3694746376811594, 'recall': 0.35802685859738437, 'f1-score': 0.3636606784647617, 'support': 56965}, '2': {'precision': 0.3899532832922156, 'recall': 0.45574823115618995, 'f1-score': 0.4202913582575079, 'support': 48902}, 'accuracy': 0.3844314108830238, 'macro avg': {'precision': 0.38542317986100194, 'recall': 0.38550785011274563, 'f1-score': 0.38392296878864407, 'support': 153450}, 'weighted avg': {'precision': 0.3844870181385809, 'recall': 0.3844314108830238, 'f1-score': 0.38299673286743696, 'support': 153450}}
[[16309 17787 13487]
 [15191 20395 21379]
 [ 9597 17018 22287]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/WBA
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952084
{'0': {'precision': 0.3834916180118776, 'recall': 0.21751200977837576, 'f1-score': 0.2775824594391156, 'support': 211078}, '1': {'precision': 0.3427442335058987, 'recall': 0.47043448934854704, 'f1-score': 0.39656401215349407, 'support': 213492}, '2': {'precision': 0.36032937689608413, 'recall': 0.38133424077882494, 'f1-score': 0.37053436650900673, 'support': 202767}, 'accuracy': 0.35653564192770393, 'macro avg': {'precision': 0.36218840947128683, 'recall': 0.35642691330191595, 'f1-score': 0.3482269460338721, 'support': 627337}, 'weighted avg': {'precision': 0.3621382166386499, 'recall': 0.35653564192770393, 'f1-score': 0.3481174175125892, 'support': 627337}}
[[ 45912 100536  64630]
 [ 40423 100434  72635]
 [ 33386  92059  77322]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940703
{'0': {'precision': 0.4084371686108165, 'recall': 0.23208955926522234, 'f1-score': 0.2959876561740143, 'support': 106209}, '1': {'precision': 0.31849144257762957, 'recall': 0.46041572246714185, 'f1-score': 0.37652360695784015, 'support': 97084}, '2': {'precision': 0.38247955634928094, 'recall': 0.392042005876969, 'f1-score': 0.38720175083854697, 'support': 103795}, 'accuracy': 0.358337023914969, 'macro avg': {'precision': 0.3698027225125757, 'recall': 0.36151576253644446, 'f1-score': 0.3532376713234671, 'support': 307088}, 'weighted avg': {'precision': 0.3712277653423983, 'recall': 0.358337023914969, 'f1-score': 0.35227874928609326, 'support': 307088}}
[[24650 48876 32683]
 [19370 44699 33015]
 [16332 46771 40692]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092312
{'0': {'precision': 0.4106116793675374, 'recall': 0.25797531875672075, 'f1-score': 0.3168702926238659, 'support': 39058}, '1': {'precision': 0.32781217335370266, 'recall': 0.43770465403403297, 'f1-score': 0.3748706985725122, 'support': 37258}, '2': {'precision': 0.36361744739511537, 'recall': 0.38387610522269205, 'f1-score': 0.3734722500500901, 'support': 36418}, 'accuracy': 0.3580463746518353, 'macro avg': {'precision': 0.3673471000387852, 'recall': 0.3598520260044819, 'f1-score': 0.35507108041548935, 'support': 112734}, 'weighted avg': {'precision': 0.3680656867208193, 'recall': 0.3580463746518353, 'f1-score': 0.35432402628347964, 'support': 112734}}
[[10076 17204 11778]
 [ 8261 16308 12689]
 [ 6202 16236 13980]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
3337/3337 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0879769
{'0': {'precision': 0.38204929766258466, 'recall': 0.27713871612820373, 'f1-score': 0.3212456829820174, 'support': 272535}, '1': {'precision': 0.3872785030029285, 'recall': 0.42921320844093336, 'f1-score': 0.4071689804177943, 'support': 327215}, '2': {'precision': 0.3475077807364629, 'recall': 0.4013654937526301, 'f1-score': 0.3724999589371849, 'support': 254267}, 'accuracy': 0.37239188447068383, 'macro avg': {'precision': 0.37227852713399195, 'recall': 0.369239139440589, 'f1-score': 0.36697154077899885, 'support': 854017}, 'weighted avg': {'precision': 0.37376879099958665, 'recall': 0.37239188447068383, 'f1-score': 0.3694269987576288, 'support': 854017}}
[[ 75530 117059  79946]
 [ 75096 140445 111674]
 [ 47071 105142 102054]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092654
{'0': {'precision': 0.3878766737327931, 'recall': 0.24105929341527071, 'f1-score': 0.2973316260676838, 'support': 119929}, '1': {'precision': 0.31999542218313676, 'recall': 0.45427726091120535, 'f1-score': 0.3754921155490843, 'support': 116944}, '2': {'precision': 0.39901556302467467, 'recall': 0.38765640355017683, 'f1-score': 0.3932539729264052, 'support': 129233}, 'accuracy': 0.36091459850425833, 'macro avg': {'precision': 0.3689625529802016, 'recall': 0.36099765262555095, 'f1-score': 0.3553592381810578, 'support': 366106}, 'weighted avg': {'precision': 0.3701255497376516, 'recall': 0.36091459850425833, 'f1-score': 0.3561581214911569, 'support': 366106}}
[[28910 55452 35567]
 [23930 53125 39889]
 [21694 57441 50098]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942017
{'0': {'precision': 0.40746950580542396, 'recall': 0.22477339992600814, 'f1-score': 0.28972505774532453, 'support': 43248}, '1': {'precision': 0.3170888975616378, 'recall': 0.4718462781537218, 'f1-score': 0.3792889980413449, 'support': 39604}, '2': {'precision': 0.3853883190286791, 'recall': 0.38594488830914725, 'f1-score': 0.38566640286765047, 'support': 42931}, 'accuracy': 0.35757614303999746, 'macro avg': {'precision': 0.3699822407985803, 'recall': 0.3608548554629591, 'f1-score': 0.3515601528847733, 'support': 125783}, 'weighted avg': {'precision': 0.3714757623075002, 'recall': 0.35757614303999746, 'f1-score': 0.35067087855521273, 'support': 125783}}
[[ 9721 20488 13039]
 [ 7532 18687 13385]
 [ 6604 19758 16569]]
testing model on single stock: results/universal/W9/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
10303/10303 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938514
{'0': {'precision': 0.34545145491825047, 'recall': 0.16108928597967867, 'f1-score': 0.2197198516146034, 'support': 807428}, '1': {'precision': 0.3789479383778575, 'recall': 0.5467540455762696, 'f1-score': 0.44764151306204353, 'support': 1011228}, '2': {'precision': 0.3336542526591201, 'recall': 0.32677491377036044, 'f1-score': 0.3301787540100715, 'support': 818744}, 'accuracy': 0.360395086069614, 'macro avg': {'precision': 0.3526845486517427, 'recall': 0.34487274844210286, 'f1-score': 0.33251337289557287, 'support': 2637400}, 'weighted avg': {'precision': 0.354632350273313, 'recall': 0.360395086069614, 'f1-score': 0.3413996610652166, 'support': 2637400}}
[[130068 453320 224040]
 [148057 552893 310278]
 [ 98391 452808 267545]]
Evaluating performance on  train set...
3419/3419 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977029
{'0': {'precision': 0.36617139426684675, 'recall': 0.12707379912360503, 'f1-score': 0.1886720471821891, 'support': 287998}, '1': {'precision': 0.3294310510277951, 'recall': 0.5413153981811266, 'f1-score': 0.4095936325031202, 'support': 289190}, '2': {'precision': 0.36632712921977495, 'recall': 0.36884869028241574, 'f1-score': 0.36758358543164416, 'support': 297965}, 'accuracy': 0.34627545126395043, 'macro avg': {'precision': 0.35397652483813896, 'recall': 0.34574596252904916, 'f1-score': 0.3219497550389845, 'support': 875153}, 'weighted avg': {'precision': 0.3540837521105014, 'recall': 0.34627545126395043, 'f1-score': 0.32258884773415997, 'support': 875153}}
[[ 36597 158834  92567]
 [ 35102 156543  97545]
 [ 28246 159815 109904]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976688
{'0': {'precision': 0.36289996911893957, 'recall': 0.1287622740107042, 'f1-score': 0.19008099936544273, 'support': 118645}, '1': {'precision': 0.34452470529219964, 'recall': 0.5600760022180905, 'f1-score': 0.42661921000813713, 'support': 122628}, '2': {'precision': 0.3553130315405935, 'recall': 0.3547800298293863, 'f1-score': 0.3550463306472486, 'support': 115993}, 'accuracy': 0.3501872554343262, 'macro avg': {'precision': 0.35424590198391087, 'recall': 0.3478727686860603, 'f1-score': 0.3239155133402762, 'support': 357266}, 'weighted avg': {'precision': 0.3541296033324652, 'recall': 0.3501872554343262, 'f1-score': 0.32482942593293823, 'support': 357266}}
[[15277 67153 36215]
 [15495 68681 38452]
 [11325 63516 41152]]
training model: results/universal/W9/deepOF_L2/h500
Epoch 1/50
6697/6697 - 153s - loss: 3.2682 - accuracy500: 0.3766 - val_loss: 3.3045 - val_accuracy500: 0.3552 - 153s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 151s - loss: 3.2621 - accuracy500: 0.3820 - val_loss: 3.2946 - val_accuracy500: 0.3581 - 151s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 150s - loss: 3.2532 - accuracy500: 0.3883 - val_loss: 3.2926 - val_accuracy500: 0.3592 - 150s/epoch - 22ms/step
Epoch 4/50
6697/6697 - 151s - loss: 3.2480 - accuracy500: 0.3914 - val_loss: 3.2875 - val_accuracy500: 0.3599 - 151s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 152s - loss: 3.2424 - accuracy500: 0.3954 - val_loss: 3.2891 - val_accuracy500: 0.3579 - 152s/epoch - 23ms/step
Epoch 6/50
6697/6697 - 152s - loss: 3.2382 - accuracy500: 0.3983 - val_loss: 3.2886 - val_accuracy500: 0.3600 - 152s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 150s - loss: 3.2346 - accuracy500: 0.4006 - val_loss: 3.2890 - val_accuracy500: 0.3591 - 150s/epoch - 22ms/step
Epoch 8/50
6697/6697 - 150s - loss: 3.2318 - accuracy500: 0.4023 - val_loss: 3.2895 - val_accuracy500: 0.3593 - 150s/epoch - 22ms/step
Epoch 9/50
6697/6697 - 151s - loss: 3.2297 - accuracy500: 0.4039 - val_loss: 3.2947 - val_accuracy500: 0.3592 - 151s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 156s - loss: 3.2276 - accuracy500: 0.4050 - val_loss: 3.2930 - val_accuracy500: 0.3594 - 156s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 155s - loss: 3.2259 - accuracy500: 0.4058 - val_loss: 3.2961 - val_accuracy500: 0.3597 - 155s/epoch - 23ms/step
Epoch 12/50
6697/6697 - 158s - loss: 3.2240 - accuracy500: 0.4072 - val_loss: 3.2989 - val_accuracy500: 0.3595 - 158s/epoch - 24ms/step
Epoch 13/50
6697/6697 - 156s - loss: 3.2226 - accuracy500: 0.4080 - val_loss: 3.3002 - val_accuracy500: 0.3600 - 156s/epoch - 23ms/step
Epoch 14/50
6697/6697 - 155s - loss: 3.2204 - accuracy500: 0.4095 - val_loss: 3.3013 - val_accuracy500: 0.3601 - 155s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 135s - 135s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009091
{'0': {'precision': 0.34117544913518844, 'recall': 0.3583438241866438, 'f1-score': 0.34954895404419006, 'support': 1348794}, '1': {'precision': 0.3667008322741995, 'recall': 0.08429828711671244, 'f1-score': 0.13708342529242992, 'support': 1591527}, '2': {'precision': 0.33636576765523074, 'recall': 0.6211788452888972, 'f1-score': 0.4364147556621081, 'support': 1367355}, 'accuracy': 0.34052398555508817, 'macro avg': {'precision': 0.34808068302153955, 'recall': 0.35460698553075115, 'f1-score': 0.30768237833290935, 'support': 4307676}, 'weighted avg': {'precision': 0.34907943133604413, 'recall': 0.34052398555508817, 'f1-score': 0.2986239918589109, 'support': 4307676}}
[[483332 115646 749816]
 [531408 134163 925956]
 [401927 116056 849372]]
Evaluating performance on  train set...
6697/6697 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094792
{'0': {'precision': 0.37060192963087407, 'recall': 0.375802910381729, 'f1-score': 0.3731842996784844, 'support': 575251}, '1': {'precision': 0.3337289798949658, 'recall': 0.0894944609420844, 'f1-score': 0.14114008003612002, 'support': 562370}, '2': {'precision': 0.36239612110623176, 'recall': 0.61608874731513, 'f1-score': 0.45635487985503564, 'support': 576378}, 'accuracy': 0.36266648930366935, 'macro avg': {'precision': 0.35557567687735725, 'recall': 0.36046203954631445, 'f1-score': 0.32355975318988, 'support': 1713999}, 'weighted avg': {'precision': 0.35574434322108095, 'recall': 0.36266648930366935, 'f1-score': 0.3250179850311152, 'support': 1713999}}
[[216181  50502 308568]
 [195842  50329 316199]
 [171301  49977 355100]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952846
{'0': {'precision': 0.3712769291030161, 'recall': 0.4172807874833813, 'f1-score': 0.39293694321116623, 'support': 227154}, '1': {'precision': 0.3391740304163383, 'recall': 0.08966431291196249, 'f1-score': 0.14183342916041455, 'support': 225597}, '2': {'precision': 0.3550510440705621, 'recall': 0.5773462841981882, 'f1-score': 0.4396996747629922, 'support': 220114}, 'accuracy': 0.3598002571095242, 'macro avg': {'precision': 0.3551673345299722, 'recall': 0.36143046153117736, 'f1-score': 0.32482334904485766, 'support': 672865}, 'weighted avg': {'precision': 0.35520555952211647, 'recall': 0.3598002571095242, 'f1-score': 0.32404486594974113, 'support': 672865}}
[[ 94787  20049 112318]
 [ 86843  20228 118526]
 [ 73670  19362 127082]]
testing model out of sample: results/universal/W9/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972236
{'0': {'precision': 0.34101954077013164, 'recall': 0.448293017972403, 'f1-score': 0.38736664563643913, 'support': 681378}, '1': {'precision': 0.4071375807940905, 'recall': 0.09820168840178661, 'f1-score': 0.15823665518580957, 'support': 898009}, '2': {'precision': 0.3230553915060473, 'recall': 0.5618601161979131, 'f1-score': 0.4102356399672748, 'support': 631853}, 'accuracy': 0.3385684050577956, 'macro avg': {'precision': 0.3570708376900898, 'recall': 0.3694516075240342, 'f1-score': 0.31861298026317453, 'support': 2211240}, 'weighted avg': {'precision': 0.36273762356481504, 'recall': 0.3385684050577956, 'f1-score': 0.3008491482505118, 'support': 2211240}}
[[305457  66986 308935]
 [374848  88186 434975]
 [215412  61428 355013]]
Evaluating performance on  train set...
3947/3947 - 35s - 35s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943491
{'0': {'precision': 0.3640217616289024, 'recall': 0.42702122621006783, 'f1-score': 0.3930128233424561, 'support': 333597}, '1': {'precision': 0.3204527559055118, 'recall': 0.09827613789689427, 'f1-score': 0.15042123767876903, 'support': 331291}, '2': {'precision': 0.3733371012478636, 'recall': 0.5595875666548685, 'f1-score': 0.44787067427196814, 'support': 344686}, 'accuracy': 0.36440419424430504, 'macro avg': {'precision': 0.35260387292742595, 'recall': 0.3616283102539435, 'f1-score': 0.33043491176439777, 'support': 1009574}, 'weighted avg': {'precision': 0.35290504079099794, 'recall': 0.36440419424430504, 'f1-score': 0.332135982416859, 'support': 1009574}}
[[142453  33746 157398]
 [132370  32558 166363]
 [116508  35296 192882]]
Evaluating performance on  val set...
1402/1402 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0949355
{'0': {'precision': 0.35770768352150417, 'recall': 0.4175355531245727, 'f1-score': 0.3853130693334806, 'support': 117008}, '1': {'precision': 0.33931646382395003, 'recall': 0.0938754087771004, 'f1-score': 0.14706403218053482, 'support': 123845}, '2': {'precision': 0.3594023479188901, 'recall': 0.5737554094115241, 'f1-score': 0.4419596572043519, 'support': 117388}, 'accuracy': 0.3568352031174544, 'macro avg': {'precision': 0.35214216508811474, 'recall': 0.3617221237710657, 'f1-score': 0.3247789195727891, 'support': 358241}, 'weighted avg': {'precision': 0.3519050887901271, 'recall': 0.3568352031174544, 'f1-score': 0.3215115436867212, 'support': 358241}}
[[48855 11168 56985]
 [49156 11626 63063]
 [38567 11469 67352]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962903
{'0': {'precision': 0.4152073732718894, 'recall': 0.339801830836219, 'f1-score': 0.3737390878066255, 'support': 29167}, '1': {'precision': 0.2694610778443114, 'recall': 0.11806130903065451, 'f1-score': 0.1641862698031685, 'support': 21726}, '2': {'precision': 0.3417498392129773, 'recall': 0.5861420925767047, 'f1-score': 0.4317614132233892, 'support': 24477}, 'accuracy': 0.35588430409977445, 'macro avg': {'precision': 0.34213943010972603, 'recall': 0.3480017441478594, 'f1-score': 0.32322892361106104, 'support': 75370}, 'weighted avg': {'precision': 0.34933893655144954, 'recall': 0.35588430409977445, 'f1-score': 0.3321770330803818, 'support': 75370}}
[[ 9911  3639 15617]
 [ 7144  2565 12017]
 [ 6815  3315 14347]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000981
{'0': {'precision': 0.3307802155004544, 'recall': 0.3057355411567075, 'f1-score': 0.31776516804888694, 'support': 16668}, '1': {'precision': 0.3139228743998761, 'recall': 0.11889957766306898, 'f1-score': 0.17247394171452884, 'support': 17048}, '2': {'precision': 0.3570500991046408, 'recall': 0.6001493480383709, 'f1-score': 0.44772985365644613, 'support': 17409}, 'accuracy': 0.3436870415647922, 'macro avg': {'precision': 0.3339177296683238, 'recall': 0.34159482228604915, 'f1-score': 0.31265632113995395, 'support': 51125}, 'weighted avg': {'precision': 0.33410439061209496, 'recall': 0.3436870415647922, 'f1-score': 0.31357211934852236, 'support': 51125}}
[[ 5096  2162  9410]
 [ 5617  2027  9404]
 [ 4693  2268 10448]]
Evaluating performance on  val set...
53/53 - 1s - 640ms/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992137
{'0': {'precision': 0.3409757398027193, 'recall': 0.2891702464390685, 'f1-score': 0.3129434793246881, 'support': 4423}, '1': {'precision': 0.33766233766233766, 'recall': 0.11077971878994461, 'f1-score': 0.16682707731793392, 'support': 4694}, '2': {'precision': 0.34179997557699354, 'recall': 0.6415310566124226, 'f1-score': 0.44598470363288717, 'support': 4363}, 'accuracy': 0.3410979228486647, 'macro avg': {'precision': 0.3401460176806835, 'recall': 0.34716034061381196, 'f1-score': 0.3085850867585031, 'support': 13480}, 'weighted avg': {'precision': 0.34008872430095427, 'recall': 0.3410979228486647, 'f1-score': 0.3051236329327718, 'support': 13480}}
[[1279  505 2639]
 [1423  520 2751]
 [1049  515 2799]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942851
{'0': {'precision': 0.3508246940193729, 'recall': 0.5507759446040122, 'f1-score': 0.4286283615192681, 'support': 89826}, '1': {'precision': 0.26327405458172404, 'recall': 0.06200643755372958, 'f1-score': 0.1003729803639188, 'support': 100038}, '2': {'precision': 0.40353705683968083, 'recall': 0.509487064981462, 'f1-score': 0.45036468541579644, 'support': 96289}, 'accuracy': 0.3660104908912365, 'macro avg': {'precision': 0.3392119351469259, 'recall': 0.37408981571306793, 'f1-score': 0.32645534243299446, 'support': 286153}, 'weighted avg': {'precision': 0.3379547602271048, 'recall': 0.3660104908912365, 'f1-score': 0.3211856894929534, 'support': 286153}}
[[49474  8692 31660]
 [52983  6203 40852]
 [38565  8666 49058]]
Evaluating performance on  train set...
505/505 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0887321
{'0': {'precision': 0.42380742859238074, 'recall': 0.4934679588438714, 'f1-score': 0.45599258324128134, 'support': 46846}, '1': {'precision': 0.2872597314787984, 'recall': 0.07305150942005846, 'f1-score': 0.11648127839573869, 'support': 40711}, '2': {'precision': 0.3742653689480394, 'recall': 0.5778204512722036, 'f1-score': 0.4542829643888354, 'support': 41660}, 'accuracy': 0.3882074340063614, 'macro avg': {'precision': 0.3617775096730728, 'recall': 0.3814466398453778, 'f1-score': 0.34225227534195185, 'support': 129217}, 'weighted avg': {'precision': 0.36481429686842565, 'recall': 0.3882074340063614, 'f1-score': 0.3484752484249663, 'support': 129217}}
[[23117  3678 20051]
 [17542  2974 20195]
 [13887  3701 24072]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.089387
{'0': {'precision': 0.39399046564260604, 'recall': 0.4957886444888808, 'f1-score': 0.4390662731419372, 'support': 16503}, '1': {'precision': 0.28190610993158766, 'recall': 0.07889351026605929, 'f1-score': 0.1232848447333127, 'support': 15147}, '2': {'precision': 0.38794124095593074, 'recall': 0.5474289957304622, 'f1-score': 0.45408817943848484, 'support': 16161}, 'accuracy': 0.3811675137520654, 'macro avg': {'precision': 0.3546126055100414, 'recall': 0.3740370501618007, 'f1-score': 0.3388130991045783, 'support': 47811}, 'weighted avg': {'precision': 0.35643627819377305, 'recall': 0.3811675137520654, 'f1-score': 0.34410125947464454, 'support': 47811}}
[[8182 1479 6842]
 [6836 1195 7116]
 [5749 1565 8847]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953689
{'0': {'precision': 0.3612150365223588, 'recall': 0.29574074974473674, 'f1-score': 0.32521520611666577, 'support': 41134}, '1': {'precision': 0.30109873570138473, 'recall': 0.09062698196973816, 'f1-score': 0.13932028692805906, 'support': 44148}, '2': {'precision': 0.3557890673068803, 'recall': 0.6616337244520225, 'f1-score': 0.46274183678272746, 'support': 44573}, 'accuracy': 0.35159986138385124, 'macro avg': {'precision': 0.33936761317687464, 'recall': 0.3493338187221658, 'f1-score': 0.3090924432758175, 'support': 129855}, 'weighted avg': {'precision': 0.3389142689393941, 'recall': 0.35159986138385124, 'f1-score': 0.30922110204935804, 'support': 129855}}
[[12165  4594 24375]
 [11124  4001 29023]
 [10389  4693 29491]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993586
{'0': {'precision': 0.35080114936930795, 'recall': 0.31860403397027603, 'f1-score': 0.33392828168099953, 'support': 22608}, '1': {'precision': 0.31946508172362553, 'recall': 0.10676236908631274, 'f1-score': 0.1600406022669599, 'support': 22152}, '2': {'precision': 0.3465585382128009, 'recall': 0.6098816728389486, 'f1-score': 0.44197159128101066, 'support': 22142}, 'accuracy': 0.3448626348988072, 'macro avg': {'precision': 0.33894158976857813, 'recall': 0.3450826919651791, 'f1-score': 0.3119801584096567, 'support': 66902}, 'weighted avg': {'precision': 0.3390212852887941, 'recall': 0.3448626348988072, 'f1-score': 0.3121103253685371, 'support': 66902}}
[[ 7203  2493 12912]
 [ 7237  2365 12550]
 [ 6093  2545 13504]]
Evaluating performance on  val set...
73/73 - 1s - 818ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101254
{'0': {'precision': 0.3563615428900403, 'recall': 0.29387561322994143, 'f1-score': 0.3221162185602775, 'support': 6319}, '1': {'precision': 0.3469795307039441, 'recall': 0.1094488188976378, 'f1-score': 0.16640727882198011, 'support': 6350}, '2': {'precision': 0.33027362531689836, 'recall': 0.6313502673796791, 'f1-score': 0.43367961889456474, 'support': 5984}, 'accuracy': 0.33935559963544737, 'macro avg': {'precision': 0.34453823297029423, 'recall': 0.3448915665024195, 'f1-score': 0.3074010387589408, 'support': 18653}, 'weighted avg': {'precision': 0.34479847656615714, 'recall': 0.33935559963544737, 'f1-score': 0.30489880689792753, 'support': 18653}}
[[1857  639 3823]
 [1817  695 3838]
 [1537  669 3778]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057857
{'0': {'precision': 0.31734739249190114, 'recall': 0.10891650316110747, 'f1-score': 0.16217356726664828, 'support': 45870}, '1': {'precision': 0.35952390367353393, 'recall': 0.15576227921399324, 'f1-score': 0.21735596461869472, 'support': 58371}, '2': {'precision': 0.3245748659328253, 'recall': 0.7335300097673769, 'f1-score': 0.45002231828937955, 'support': 50167}, 'accuracy': 0.3295619397958655, 'macro avg': {'precision': 0.3338153873660868, 'recall': 0.3327362640474925, 'f1-score': 0.27651728339157416, 'support': 154408}, 'weighted avg': {'precision': 0.33563961695108674, 'recall': 0.3295619397958655, 'f1-score': 0.27655598273989873, 'support': 154408}}
[[ 4996  7756 33118]
 [ 5820  9092 43459]
 [ 4927  8441 36799]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015191
{'0': {'precision': 0.3422154991854782, 'recall': 0.10370971154524297, 'f1-score': 0.15917947607707295, 'support': 28358}, '1': {'precision': 0.3309839497557572, 'recall': 0.17408059898700726, 'f1-score': 0.22816047719838367, 'support': 27246}, '2': {'precision': 0.3336236204384452, 'recall': 0.7369686656061559, 'f1-score': 0.45931613289986395, 'support': 27031}, 'accuracy': 0.33405941792218796, 'macro avg': {'precision': 0.3356076897932268, 'recall': 0.3382529920461354, 'f1-score': 0.2822186953917735, 'support': 82635}, 'weighted avg': {'precision': 0.3357017717071309, 'recall': 0.33405941792218796, 'f1-score': 0.28010221253412015, 'support': 82635}}
[[ 2941  5120 20297]
 [ 3010  4743 19493]
 [ 2643  4467 19921]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027131
{'0': {'precision': 0.3425463099088503, 'recall': 0.12061289988611658, 'f1-score': 0.1784073506891271, 'support': 9659}, '1': {'precision': 0.32183685332299944, 'recall': 0.18077927731824117, 'f1-score': 0.23151439124677675, 'support': 9188}, '2': {'precision': 0.33693956624565996, 'recall': 0.6983729662077597, 'f1-score': 0.4545670547503479, 'support': 9588}, 'accuracy': 0.3348689994724811, 'macro avg': {'precision': 0.3337742431591699, 'recall': 0.33325504780403914, 'f1-score': 0.2881629322287506, 'support': 28435}, 'weighted avg': {'precision': 0.3339640716337152, 'recall': 0.3348689994724811, 'f1-score': 0.28868576571225596, 'support': 28435}}
[[1165 1843 6651]
 [1001 1661 6526]
 [1235 1657 6696]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009731
{'0': {'precision': 0.36500759353858897, 'recall': 0.17471830287810197, 'f1-score': 0.23631813001407853, 'support': 60526}, '1': {'precision': 0.2968505477308294, 'recall': 0.12446686351706036, 'f1-score': 0.1753929727230698, 'support': 48768}, '2': {'precision': 0.3264899360051482, 'recall': 0.7023457027494713, 'f1-score': 0.44576372533466757, 'support': 52010}, 'accuracy': 0.32965084560829244, 'macro avg': {'precision': 0.32944935909152223, 'recall': 0.3338436230482112, 'f1-score': 0.28582494269060527, 'support': 161304}, 'weighted avg': {'precision': 0.3319818398172487, 'recall': 0.32965084560829244, 'f1-score': 0.2854307827806306, 'support': 161304}}
[[10575  7714 42237]
 [ 9580  6070 33118]
 [ 8817  6664 36529]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987926
{'0': {'precision': 0.3248542320753508, 'recall': 0.2552870090634441, 'f1-score': 0.2858995686130769, 'support': 39720}, '1': {'precision': 0.31949701674472314, 'recall': 0.12371441347443732, 'f1-score': 0.1783635679876793, 'support': 40254}, '2': {'precision': 0.3606415546386264, 'recall': 0.6457802035417213, 'f1-score': 0.46281824626132706, 'support': 41957}, 'accuracy': 0.34622040334287424, 'macro avg': {'precision': 0.3349976011529001, 'recall': 0.34159387535986757, 'f1-score': 0.30902712762069445, 'support': 121931}, 'weighted avg': {'precision': 0.33540019123970005, 'recall': 0.34622040334287424, 'f1-score': 0.3112764029612974, 'support': 121931}}
[[10140  5291 24289]
 [11528  4980 23746]
 [ 9546  5316 27095]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006349
{'0': {'precision': 0.3190909090909091, 'recall': 0.26720801877815137, 'f1-score': 0.2908538480129821, 'support': 15763}, '1': {'precision': 0.32873021219265747, 'recall': 0.12200762547659229, 'f1-score': 0.17796417012353558, 'support': 15999}, '2': {'precision': 0.3366982730648592, 'recall': 0.6179448157215642, 'f1-score': 0.4358926487747958, 'support': 15113}, 'accuracy': 0.3307306666666667, 'macro avg': {'precision': 0.32817313144947524, 'recall': 0.335720153325436, 'f1-score': 0.3015702223037711, 'support': 46875}, 'weighted avg': {'precision': 0.32805772086825696, 'recall': 0.3307306666666667, 'f1-score': 0.29908530271932954, 'support': 46875}}
[[4212 2072 9479]
 [5128 1952 8919]
 [3860 1914 9339]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/EXC
Evaluating performance on  test set...
2354/2354 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.08821
{'0': {'precision': 0.38202328882970377, 'recall': 0.5092299295577081, 'f1-score': 0.4365486450913257, 'support': 196047}, '1': {'precision': 0.38504981406725397, 'recall': 0.09281958113024845, 'f1-score': 0.14958129905444656, 'support': 208609}, '2': {'precision': 0.38049758567085334, 'recall': 0.5595482546201233, 'f1-score': 0.45297101656956396, 'support': 197722}, 'accuracy': 0.38153949845445884, 'macro avg': {'precision': 0.3825235628559371, 'recall': 0.38719925510269326, 'f1-score': 0.34636698690511203, 'support': 602378}, 'weighted avg': {'precision': 0.3825706118117946, 'recall': 0.38153949845445884, 'f1-score': 0.34255964324200994, 'support': 602378}}
[[ 99833  15516  80698]
 [ 89815  19363  99431]
 [ 71679  15408 110635]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0839849
{'0': {'precision': 0.3946507141773414, 'recall': 0.5172923216788514, 'f1-score': 0.44772486035236686, 'support': 105596}, '1': {'precision': 0.37638918012161876, 'recall': 0.10206112295664535, 'f1-score': 0.16057969717979112, 'support': 105525}, '2': {'precision': 0.4004814201895592, 'recall': 0.5628165647837478, 'f1-score': 0.46797061903342424, 'support': 108785}, 'accuracy': 0.395803767356661, 'macro avg': {'precision': 0.3905071048295064, 'recall': 0.3940566698064149, 'f1-score': 0.3587583921885274, 'support': 319906}, 'weighted avg': {'precision': 0.390609667658392, 'recall': 0.395803767356661, 'f1-score': 0.3598910639069509, 'support': 319906}}
[[54624  8885 42087]
 [45187 10770 49568]
 [38600  8959 61226]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0841311
{'0': {'precision': 0.3977424548662259, 'recall': 0.5426988875385622, 'f1-score': 0.4590491252347534, 'support': 42788}, '1': {'precision': 0.3791685292802861, 'recall': 0.0991188912520158, 'f1-score': 0.1571555621433336, 'support': 42787}, '2': {'precision': 0.38873308560611375, 'recall': 0.5403469447422279, 'f1-score': 0.45216930353939, 'support': 41044}, 'accuracy': 0.39204226853789714, 'macro avg': {'precision': 0.3885480232508753, 'recall': 0.3940549078442686, 'f1-score': 0.356124663639159, 'support': 126619}, 'weighted avg': {'precision': 0.3885455483517404, 'recall': 0.39204226853789714, 'f1-score': 0.35480335417624653, 'support': 126619}}
[[23221  3625 15942]
 [19614  4241 18932]
 [15547  3319 22178]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/AAL
Evaluating performance on  test set...
3870/3870 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895473
{'0': {'precision': 0.3962840766046086, 'recall': 0.49616627683827985, 'f1-score': 0.4406358159883614, 'support': 338183}, '1': {'precision': 0.3735900449208668, 'recall': 0.1010039522640148, 'f1-score': 0.1590162171764629, 'support': 336769}, '2': {'precision': 0.36644940196210185, 'recall': 0.5527044232316258, 'f1-score': 0.44070578787473197, 'support': 315742}, 'accuracy': 0.37985694876520903, 'macro avg': {'precision': 0.3787745078291924, 'recall': 0.3832915507779735, 'f1-score': 0.3467859403465188, 'support': 990694}, 'weighted avg': {'precision': 0.37906109332513344, 'recall': 0.37985694876520903, 'f1-score': 0.34492648736727577, 'support': 990694}}
[[167795  29878 140510]
 [141552  34015 161202]
 [114074  27156 174512]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0907338
{'0': {'precision': 0.3916047569277704, 'recall': 0.5055023591957586, 'f1-score': 0.4413232822289003, 'support': 137123}, '1': {'precision': 0.30797475616752723, 'recall': 0.08112805477050493, 'f1-score': 0.12842566120793805, 'support': 132334}, '2': {'precision': 0.3792533068955621, 'recall': 0.5421885373695479, 'f1-score': 0.44631529822105137, 'support': 134053}, 'accuracy': 0.37851354365443235, 'macro avg': {'precision': 0.3596109399969532, 'recall': 0.3762729837786038, 'f1-score': 0.33868808055262994, 'support': 403510}, 'weighted avg': {'precision': 0.360074332770318, 'recall': 0.37851354365443235, 'f1-score': 0.3403646961705816, 'support': 403510}}
[[69316 12169 55638]
 [58273 10736 63325]
 [49416 11955 72682]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894451
{'0': {'precision': 0.3799025224977464, 'recall': 0.4963569218484879, 'f1-score': 0.4303913592854794, 'support': 50095}, '1': {'precision': 0.348835315197915, 'recall': 0.08281289274734624, 'f1-score': 0.13385002421988532, 'support': 51719}, '2': {'precision': 0.38792408975053155, 'recall': 0.5688666821597336, 'f1-score': 0.46128599134715803, 'support': 51636}, 'accuracy': 0.38137504072987943, 'macro avg': {'precision': 0.3722206424820644, 'recall': 0.3826788322518559, 'f1-score': 0.3418424582841742, 'support': 153450}, 'weighted avg': {'precision': 0.3721308493294494, 'recall': 0.38137504072987943, 'f1-score': 0.3408407168148334, 'support': 153450}}
[[24865  3889 21341]
 [22430  4283 25006]
 [18156  4106 29374]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/WBA
Evaluating performance on  test set...
2451/2451 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953315
{'0': {'precision': 0.37686171193503315, 'recall': 0.4140355615575062, 'f1-score': 0.3945750118508064, 'support': 222150}, '1': {'precision': 0.3102973297388772, 'recall': 0.08305331128269411, 'f1-score': 0.1310343394893741, 'support': 189866}, '2': {'precision': 0.3645365538193139, 'recall': 0.5628433826705245, 'f1-score': 0.44248744012150953, 'support': 215321}, 'accuracy': 0.3649378244866794, 'macro avg': {'precision': 0.3505651984977414, 'recall': 0.3533107518369083, 'f1-score': 0.32269893048723003, 'support': 627337}, 'weighted avg': {'precision': 0.3524853745586467, 'recall': 0.3649378244866794, 'f1-score': 0.3312583872440964, 'support': 627337}}
[[ 91978  17792 112380]
 [ 75214  15769  98883]
 [ 76871  17258 121192]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953991
{'0': {'precision': 0.36926120587910644, 'recall': 0.41423618387213534, 'f1-score': 0.39045784906558206, 'support': 104986}, '1': {'precision': 0.3254317759581642, 'recall': 0.09426572590289405, 'f1-score': 0.14618653890734873, 'support': 100344}, '2': {'precision': 0.3600896105435915, 'recall': 0.5670708936889483, 'f1-score': 0.44047678115470196, 'support': 101758}, 'accuracy': 0.3603266816026676, 'macro avg': {'precision': 0.3515941974602874, 'recall': 0.3585242678213259, 'f1-score': 0.32570705637587755, 'support': 307088}, 'weighted avg': {'precision': 0.351900372781954, 'recall': 0.3603266816026676, 'f1-score': 0.3272143037137835, 'support': 307088}}
[[43489  9953 51544]
 [39884  9459 51001]
 [34400  9654 57704]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0928538
{'0': {'precision': 0.3858218318695107, 'recall': 0.44672377517282835, 'f1-score': 0.41404526987811957, 'support': 39924}, '1': {'precision': 0.32725810774591263, 'recall': 0.10252463054187193, 'f1-score': 0.15613477973615225, 'support': 35728}, '2': {'precision': 0.3589080719515502, 'recall': 0.5353810474084462, 'f1-score': 0.42973256707468854, 'support': 37082}, 'accuracy': 0.36680149732999806, 'macro avg': {'precision': 0.3573293371889912, 'recall': 0.3615431510410488, 'f1-score': 0.3333042055629868, 'support': 112734}, 'weighted avg': {'precision': 0.35840879959206356, 'recall': 0.36680149732999806, 'f1-score': 0.3374675769270219, 'support': 112734}}
[[17835  3687 18402]
 [15005  3663 17060]
 [13386  3843 19853]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
3337/3337 - 29s - 29s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057471
{'0': {'precision': 0.272005376944017, 'recall': 0.49356306034807507, 'f1-score': 0.35072450674817685, 'support': 212368}, '1': {'precision': 0.5048147701218776, 'recall': 0.0936726093712914, 'f1-score': 0.1580227700257617, 'support': 446598}, '2': {'precision': 0.2597395528229799, 'recall': 0.5137476865025045, 'f1-score': 0.3450363175283077, 'support': 195051}, 'accuracy': 0.28905513590478876, 'macro avg': {'precision': 0.3455198999629581, 'recall': 0.366994452073957, 'f1-score': 0.2845945314340821, 'support': 854017}, 'weighted avg': {'precision': 0.39094885009948555, 'recall': 0.28905513590478876, 'f1-score': 0.24865429361157435, 'support': 854017}}
[[104817  21310  86241]
 [205414  41834 199350]
 [ 75118  19726 100207]]
Evaluating performance on  train set...
1431/1431 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0949768
{'0': {'precision': 0.3453674948240166, 'recall': 0.43166380088186723, 'f1-score': 0.3837236578260376, 'support': 117478}, '1': {'precision': 0.33287116040955633, 'recall': 0.10446599666953968, 'f1-score': 0.1590247568579745, 'support': 119503}, '2': {'precision': 0.38141607525994387, 'recall': 0.5369215876089061, 'f1-score': 0.44600266971163893, 'support': 129125}, 'accuracy': 0.36198532665402916, 'macro avg': {'precision': 0.35321824349783887, 'recall': 0.35768379505343767, 'f1-score': 0.3295836947985504, 'support': 366106}, 'weighted avg': {'precision': 0.3540027630175394, 'recall': 0.36198532665402916, 'f1-score': 0.33234396081845463, 'support': 366106}}
[[50711 11873 54894]
 [49473 12484 57546]
 [46648 13147 69330]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097893
{'0': {'precision': 0.3416714508324448, 'recall': 0.412393585428628, 'f1-score': 0.37371607983852884, 'support': 40408}, '1': {'precision': 0.33466819221967964, 'recall': 0.09083246456535723, 'f1-score': 0.14288455834888955, 'support': 45083}, '2': {'precision': 0.3466460825935932, 'recall': 0.5572818425493895, 'f1-score': 0.4274225018321643, 'support': 40292}, 'accuracy': 0.34355199033255684, 'macro avg': {'precision': 0.34099524188190583, 'recall': 0.35350263084779154, 'f1-score': 0.31467438000652753, 'support': 125783}, 'weighted avg': {'precision': 0.3407548719217883, 'recall': 0.34355199033255684, 'f1-score': 0.308185457032984, 'support': 125783}}
[[16664  4038 19706]
 [18373  4095 22615]
 [13735  4103 22454]]
testing model on single stock: results/universal/W9/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
10303/10303 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055741
{'0': {'precision': 0.31387150292821214, 'recall': 0.2982107205802987, 'f1-score': 0.3058407627698143, 'support': 794901}, '1': {'precision': 0.3874075992931751, 'recall': 0.08094482831276102, 'f1-score': 0.1339104476180045, 'support': 1034643}, '2': {'precision': 0.31888620712216154, 'recall': 0.6576159612604227, 'f1-score': 0.4295016773524874, 'support': 807856}, 'accuracy': 0.3230666565556988, 'macro avg': {'precision': 0.34005510311451626, 'recall': 0.34559050338449415, 'f1-score': 0.2897509625801021, 'support': 2637400}, 'weighted avg': {'precision': 0.34425550468093896, 'recall': 0.3230666565556988, 'f1-score': 0.2762713818459825, 'support': 2637400}}
[[237048  66077 491776]
 [307946  83749 642948]
 [210245  66352 531259]]
Evaluating performance on  train set...
3419/3419 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988082
{'0': {'precision': 0.34756495477447946, 'recall': 0.3164700395557321, 'f1-score': 0.3312894528897914, 'support': 289465}, '1': {'precision': 0.3287524592061104, 'recall': 0.07876095153598758, 'f1-score': 0.12707732223937016, 'support': 288544}, '2': {'precision': 0.3540262177462914, 'recall': 0.6462994373098565, 'f1-score': 0.4574649148821881, 'support': 297144}, 'accuracy': 0.3500839281817008, 'macro avg': {'precision': 0.34344787724229375, 'recall': 0.3471768094671921, 'f1-score': 0.3052772300037832, 'support': 875153}, 'weighted avg': {'precision': 0.34355616180138404, 'recall': 0.3500839281817008, 'f1-score': 0.3068001309676516, 'support': 875153}}
[[ 91607  23137 174721]
 [ 90126  22726 175692]
 [ 81835  23265 192044]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100272
{'0': {'precision': 0.3489812256687178, 'recall': 0.3759130875887724, 'f1-score': 0.3619468594314741, 'support': 118280}, '1': {'precision': 0.34129507841295076, 'recall': 0.07694689075904096, 'f1-score': 0.12558086969239668, 'support': 122747}, '2': {'precision': 0.34193605824397577, 'recall': 0.5947573533839762, 'f1-score': 0.43422742703887596, 'support': 116239}, 'accuracy': 0.34439885127608, 'macro avg': {'precision': 0.3440707874418815, 'recall': 0.3492057772439298, 'f1-score': 0.30725171872091556, 'support': 357266}, 'weighted avg': {'precision': 0.3440482772955498, 'recall': 0.34439885127608, 'f1-score': 0.3042548449537859, 'support': 357266}}
[[44463  9434 64383]
 [44635  9445 68667]
 [38310  8795 69134]]
training model: results/universal/W9/deepOF_L2/h1000
Epoch 1/50
6697/6697 - 154s - loss: 3.2765 - accuracy1000: 0.3682 - val_loss: 3.2912 - val_accuracy1000: 0.3557 - 154s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 151s - loss: 3.2775 - accuracy1000: 0.3655 - val_loss: 3.2882 - val_accuracy1000: 0.3572 - 151s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 151s - loss: 3.2728 - accuracy1000: 0.3711 - val_loss: 3.3022 - val_accuracy1000: 0.3547 - 151s/epoch - 23ms/step
Epoch 4/50
6697/6697 - 151s - loss: 3.2627 - accuracy1000: 0.3810 - val_loss: 3.3169 - val_accuracy1000: 0.3502 - 151s/epoch - 22ms/step
Epoch 5/50
6697/6697 - 152s - loss: 3.2595 - accuracy1000: 0.3838 - val_loss: 3.3196 - val_accuracy1000: 0.3492 - 152s/epoch - 23ms/step
Epoch 6/50
6697/6697 - 151s - loss: 3.2560 - accuracy1000: 0.3867 - val_loss: 3.3220 - val_accuracy1000: 0.3492 - 151s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 151s - loss: 3.2535 - accuracy1000: 0.3885 - val_loss: 3.3291 - val_accuracy1000: 0.3492 - 151s/epoch - 23ms/step
Epoch 8/50
6697/6697 - 152s - loss: 3.2510 - accuracy1000: 0.3902 - val_loss: 3.3397 - val_accuracy1000: 0.3491 - 152s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 152s - loss: 3.2495 - accuracy1000: 0.3911 - val_loss: 3.3520 - val_accuracy1000: 0.3492 - 152s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 152s - loss: 3.2475 - accuracy1000: 0.3920 - val_loss: 3.3548 - val_accuracy1000: 0.3492 - 152s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 150s - loss: 3.2457 - accuracy1000: 0.3932 - val_loss: 3.3595 - val_accuracy1000: 0.3492 - 150s/epoch - 22ms/step
Epoch 12/50
6697/6697 - 150s - loss: 3.2440 - accuracy1000: 0.3944 - val_loss: 3.3620 - val_accuracy1000: 0.3493 - 150s/epoch - 22ms/step
testing model in sample: results/universal/W9/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 129s - 129s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0947037
{'0': {'precision': 0.31141939168472, 'recall': 0.23271827322211547, 'f1-score': 0.2663773811473173, 'support': 1258251}, '1': {'precision': 0.4283342988602378, 'recall': 0.5888955876642619, 'f1-score': 0.49594331032857264, 'support': 1761516}, '2': {'precision': 0.3205514887064741, 'recall': 0.23534970250227308, 'f1-score': 0.27142124786489336, 'support': 1287909}, 'accuracy': 0.3791547925145717, 'macro avg': {'precision': 0.35343505975047734, 'recall': 0.35232118779621685, 'f1-score': 0.3445806464469278, 'support': 4307676}, 'weighted avg': {'precision': 0.3619591234499177, 'recall': 0.3791547925145717, 'f1-score': 0.36176062228430506, 'support': 4307676}}
[[ 292818  684084  281349]
 [ 363039 1037349  361128]
 [ 284412  700388  303109]]
Evaluating performance on  train set...
6697/6697 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974733
{'0': {'precision': 0.34247850627471893, 'recall': 0.19341175487494278, 'f1-score': 0.247212437723489, 'support': 574417}, '1': {'precision': 0.3443460962448278, 'recall': 0.5936809802922188, 'f1-score': 0.4358759636942191, 'support': 565056}, '2': {'precision': 0.3636022234044858, 'recall': 0.26289497777298154, 'f1-score': 0.3051544308912291, 'support': 574526}, 'accuracy': 0.34865947996469077, 'macro avg': {'precision': 0.35014227530801084, 'recall': 0.34999590431338107, 'f1-score': 0.3294142774363124, 'support': 1713999}, 'weighted avg': {'precision': 0.35017478709276273, 'recall': 0.34865947996469077, 'f1-score': 0.3288312945008885, 'support': 1713999}}
[[111099 325183 138135]
 [103369 335463 126224]
 [109929 313557 151040]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095843
{'0': {'precision': 0.33558767882630197, 'recall': 0.18284616254097436, 'f1-score': 0.23671648867517556, 'support': 221175}, '1': {'precision': 0.36591937069813174, 'recall': 0.6333893581260771, 'f1-score': 0.46385952338290626, 'support': 235015}, '2': {'precision': 0.3526590957494315, 'recall': 0.23690781123802931, 'f1-score': 0.2834205702422757, 'support': 216675}, 'accuracy': 0.3576185416093867, 'macro avg': {'precision': 0.35138871509128844, 'recall': 0.3510477773016936, 'f1-score': 0.32799886076678586, 'support': 672865}, 'weighted avg': {'precision': 0.3516790966100731, 'recall': 0.3576185416093867, 'f1-score': 0.33109147797524136, 'support': 672865}}
[[ 40441 133074  47660]
 [ 39594 148856  46565]
 [ 40473 124870  51332]]
testing model out of sample: results/universal/W9/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.086401
{'0': {'precision': 0.3501844223466413, 'recall': 0.19899669005068177, 'f1-score': 0.25377981646198833, 'support': 677956}, '1': {'precision': 0.44883915953898207, 'recall': 0.7475369895092903, 'f1-score': 0.5609003060827699, 'support': 930061}, '2': {'precision': 0.31907457685864477, 'recall': 0.14650635005628102, 'f1-score': 0.20080913520692478, 'support': 603223}, 'accuracy': 0.4153967909408296, 'macro avg': {'precision': 0.3726993862480894, 'recall': 0.364346676538751, 'f1-score': 0.338496419250561, 'support': 2211240}, 'weighted avg': {'precision': 0.3831924853352992, 'recall': 0.4153967909408296, 'f1-score': 0.3685062398436522, 'support': 2211240}}
[[134911 458455  84590]
 [130796 695255 104010]
 [119550 395297  88376]]
Evaluating performance on  train set...
3947/3947 - 34s - 34s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969117
{'0': {'precision': 0.34461737746091703, 'recall': 0.21274394301027352, 'f1-score': 0.2630798263823363, 'support': 327638}, '1': {'precision': 0.35498905551947113, 'recall': 0.6799754084986364, 'f1-score': 0.4664581952935039, 'support': 343208}, '2': {'precision': 0.36420218407903776, 'recall': 0.1611765192130559, 'f1-score': 0.22346105752602677, 'support': 338728}, 'accuracy': 0.3542791315941179, 'macro avg': {'precision': 0.354602872353142, 'recall': 0.3512986235739886, 'f1-score': 0.3176663597339557, 'support': 1009574}, 'weighted avg': {'precision': 0.35471427502292147, 'recall': 0.3542791315941179, 'f1-score': 0.3189262496263026, 'support': 1009574}}
[[ 69703 211432  46503]
 [ 61030 233373  48805]
 [ 71529 212604  54595]]
Evaluating performance on  val set...
1402/1402 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977186
{'0': {'precision': 0.3497521373661901, 'recall': 0.20331946741509213, 'f1-score': 0.2571508559898158, 'support': 119718}, '1': {'precision': 0.34000520540354473, 'recall': 0.6922741608759199, 'f1-score': 0.45603317464830767, 'support': 116997}, '2': {'precision': 0.3645304568527919, 'recall': 0.15127627009857972, 'f1-score': 0.21381965363635305, 'support': 121526}, 'accuracy': 0.3453513137803881, 'macro avg': {'precision': 0.3514292665408422, 'recall': 0.34895663279653055, 'f1-score': 0.30900122809149216, 'support': 358241}, 'weighted avg': {'precision': 0.35158215753444316, 'recall': 0.3453513137803881, 'f1-score': 0.3074040847907645, 'support': 358241}}
[[24341 78722 16655]
 [20610 80994 15393]
 [24644 78498 18384]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960281
{'0': {'precision': 0.3878196273444455, 'recall': 0.42663694998818086, 'f1-score': 0.4063032641903843, 'support': 29613}, '1': {'precision': 0.31179391235518455, 'recall': 0.37691370911621436, 'f1-score': 0.3412751545701571, 'support': 22992}, '2': {'precision': 0.3095539702646843, 'recall': 0.2039534372940918, 'f1-score': 0.24589556191081452, 'support': 22765}, 'accuracy': 0.3442085710494892, 'macro avg': {'precision': 0.33638916998810475, 'recall': 0.33583469879949573, 'f1-score': 0.33115799355711867, 'support': 75370}, 'weighted avg': {'precision': 0.34098798448317635, 'recall': 0.3442085710494892, 'f1-score': 0.33801604594993495, 'support': 75370}}
[[12634 11201  5778]
 [ 9748  8666  4578]
 [10195  7927  4643]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969133
{'0': {'precision': 0.3345575462802124, 'recall': 0.40991182730313164, 'f1-score': 0.3684210526315789, 'support': 16445}, '1': {'precision': 0.35938292905714, 'recall': 0.43233013857517855, 'f1-score': 0.3924959126555269, 'support': 16381}, '2': {'precision': 0.37604259094942327, 'recall': 0.23159735504672385, 'f1-score': 0.28665156075619735, 'support': 18299}, 'accuracy': 0.3532713936430318, 'macro avg': {'precision': 0.3566610220955919, 'recall': 0.3579464403083447, 'f1-score': 0.34918950868110105, 'support': 51125}, 'weighted avg': {'precision': 0.35736046907083807, 'recall': 0.3532713936430318, 'f1-score': 0.3468674164501547, 'support': 51125}}
[[6741 6049 3655]
 [5922 7082 3377]
 [7486 6575 4238]]
Evaluating performance on  val set...
53/53 - 1s - 621ms/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962936
{'0': {'precision': 0.31237239689669255, 'recall': 0.3583977512297962, 'f1-score': 0.3338060434166031, 'support': 4269}, '1': {'precision': 0.3755798849508258, 'recall': 0.4412470023980815, 'f1-score': 0.4057738572574178, 'support': 4587}, '2': {'precision': 0.3595364860632634, 'recall': 0.24826989619377163, 'f1-score': 0.2937188179608546, 'support': 4624}, 'accuracy': 0.34881305637982196, 'macro avg': {'precision': 0.3491629226369272, 'recall': 0.34930488327388315, 'f1-score': 0.34443290621162514, 'support': 13480}, 'weighted avg': {'precision': 0.3500593031289279, 'recall': 0.34881305637982196, 'f1-score': 0.34454439887509236, 'support': 13480}}
[[1530 1653 1086]
 [1604 2024  959]
 [1764 1712 1148]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006087
{'0': {'precision': 0.34774952089915573, 'recall': 0.07343162131420072, 'f1-score': 0.12125809335464471, 'support': 91432}, '1': {'precision': 0.33204420803586937, 'recall': 0.8439993691846712, 'f1-score': 0.4765896562881254, 'support': 95115}, '2': {'precision': 0.37468102073365234, 'recall': 0.09434170632291228, 'f1-score': 0.1507306353560143, 'support': 99606}, 'accuracy': 0.336840780980804, 'macro avg': {'precision': 0.3514915832228925, 'recall': 0.33725756560726144, 'f1-score': 0.24952612833292812, 'support': 286153}, 'weighted avg': {'precision': 0.3519036906598201, 'recall': 0.336840780980804, 'f1-score': 0.24962649636634274, 'support': 286153}}
[[ 6714 77525  7193]
 [ 6348 80277  8490]
 [ 6245 83964  9397]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990579
{'0': {'precision': 0.33167240442109075, 'recall': 0.07942637710715293, 'f1-score': 0.1281615935306576, 'support': 46093}, '1': {'precision': 0.32188972757576917, 'recall': 0.7917628763960228, 'f1-score': 0.45770168484997065, 'support': 42442}, '2': {'precision': 0.3552927519407966, 'recall': 0.12037264637923406, 'f1-score': 0.1798219039750298, 'support': 40682}, 'accuracy': 0.32628833667396706, 'macro avg': {'precision': 0.3362849613125522, 'recall': 0.3305206332941366, 'f1-score': 0.2552283941185527, 'support': 129217}, 'weighted avg': {'precision': 0.3358957388672359, 'recall': 0.32628833667396706, 'f1-score': 0.25266522157706195, 'support': 129217}}
[[ 3661 38523  3909]
 [ 3861 33604  4977]
 [ 3516 32269  4897]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981412
{'0': {'precision': 0.33366683341670833, 'recall': 0.08126218323586745, 'f1-score': 0.13069462133829726, 'support': 16416}, '1': {'precision': 0.33011131391552484, 'recall': 0.8210883048788286, 'f1-score': 0.47090102313982907, 'support': 15639}, '2': {'precision': 0.3951973951973952, 'recall': 0.12325463315562325, 'f1-score': 0.18790517658442185, 'support': 15756}, 'accuracy': 0.33709815732781157, 'macro avg': {'precision': 0.3529918475098761, 'recall': 0.3418683737567731, 'f1-score': 0.2631669403541827, 'support': 47811}, 'weighted avg': {'precision': 0.3527810699300106, 'recall': 0.33709815732781157, 'f1-score': 0.26082989201308115, 'support': 47811}}
[[ 1334 13606  1476]
 [ 1302 12841  1496]
 [ 1362 12452  1942]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939876
{'0': {'precision': 0.34919587265967045, 'recall': 0.3796947514472992, 'f1-score': 0.36380723167726775, 'support': 41802}, '1': {'precision': 0.3633474200078128, 'recall': 0.521297192642788, 'f1-score': 0.4282216548779978, 'support': 39254}, '2': {'precision': 0.4289275032046717, 'recall': 0.24684932068280088, 'f1-score': 0.3133592601745509, 'support': 48799}, 'accuracy': 0.3725771052327596, 'macro avg': {'precision': 0.38049026529071833, 'recall': 0.382613754924296, 'f1-score': 0.36846271557660554, 'support': 129855}, 'weighted avg': {'precision': 0.3834365925285203, 'recall': 0.3725771052327596, 'f1-score': 0.3643209832229177, 'support': 129855}}
[[15872 17283  8647]
 [11400 20463  7391]
 [18181 18572 12046]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0939698
{'0': {'precision': 0.3618051282051282, 'recall': 0.3770253516309692, 'f1-score': 0.36925846836662063, 'support': 23391}, '1': {'precision': 0.36116440377804016, 'recall': 0.45951274468384734, 'f1-score': 0.404445638027558, 'support': 21303}, '2': {'precision': 0.35641574272190885, 'recall': 0.24752341498559077, 'f1-score': 0.29215274640588873, 'support': 22208}, 'accuracy': 0.360303129951272, 'macro avg': {'precision': 0.35979509156835904, 'recall': 0.36135383710013574, 'f1-score': 0.3552856176000225, 'support': 66902}, 'weighted avg': {'precision': 0.3598121111760171, 'recall': 0.360303129951272, 'f1-score': 0.3548676938304784, 'support': 66902}}
[[8819 9181 5391]
 [6979 9789 4535]
 [8577 8134 5497]]
Evaluating performance on  val set...
73/73 - 1s - 785ms/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973009
{'0': {'precision': 0.353126228863547, 'recall': 0.41458910433979684, 'f1-score': 0.38139732427266937, 'support': 6498}, '1': {'precision': 0.3490117971502988, 'recall': 0.3842131894079946, 'f1-score': 0.3657675016056519, 'support': 5929}, '2': {'precision': 0.33778074271736713, 'recall': 0.24397687118535175, 'f1-score': 0.2833162361279493, 'support': 6226}, 'accuracy': 0.34798691899426365, 'macro avg': {'precision': 0.34663958957707103, 'recall': 0.3475930549777144, 'f1-score': 0.3434936873354235, 'support': 18653}, 'weighted avg': {'precision': 0.3466964072598391, 'recall': 0.34798691899426365, 'f1-score': 0.34369175018904885, 'support': 18653}}
[[2694 2164 1640]
 [2313 2278 1338]
 [2622 2085 1519]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066933
{'0': {'precision': 0.310699423815621, 'recall': 0.5056326105359119, 'f1-score': 0.38489181888026963, 'support': 46071}, '1': {'precision': 0.43247085584304806, 'recall': 0.07710635709216263, 'f1-score': 0.13087811384072623, 'support': 59178}, '2': {'precision': 0.3111453085756595, 'recall': 0.43597306698671656, 'f1-score': 0.3631311419857675, 'support': 49159}, 'accuracy': 0.3192192114398218, 'macro avg': {'precision': 0.3514385294114428, 'recall': 0.33957067820493037, 'f1-score': 0.29296702490225446, 'support': 154408}, 'weighted avg': {'precision': 0.3575111761434655, 'recall': 0.3192192114398218, 'f1-score': 0.2806112365769762, 'support': 154408}}
[[23295  2807 19969]
 [27135  4563 27480]
 [24546  3181 21432]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997974
{'0': {'precision': 0.33959698631358387, 'recall': 0.5428663055872291, 'f1-score': 0.4178208046512903, 'support': 28064}, '1': {'precision': 0.3885300450185946, 'recall': 0.07265207525071371, 'f1-score': 0.12241373994018069, 'support': 27322}, '2': {'precision': 0.33149644868968897, 'recall': 0.3973723806378216, 'f1-score': 0.36145744663094825, 'support': 27249}, 'accuracy': 0.3394203424698977, 'macro avg': {'precision': 0.3532078266739558, 'recall': 0.33763025382525486, 'f1-score': 0.3005639970741398, 'support': 82635}, 'weighted avg': {'precision': 0.35310479148360613, 'recall': 0.3394203424698977, 'f1-score': 0.30156308135325394, 'support': 82635}}
[[15235  1582 11247]
 [14748  1985 10589]
 [14879  1542 10828]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014452
{'0': {'precision': 0.3462026924053848, 'recall': 0.5682126107347577, 'f1-score': 0.43025687566586435, 'support': 9595}, '1': {'precision': 0.3520686963309914, 'recall': 0.047433740008413966, 'f1-score': 0.08360367040504216, 'support': 9508}, '2': {'precision': 0.31895493599859726, 'recall': 0.3898414059151307, 'f1-score': 0.35085350564181694, 'support': 9332}, 'accuracy': 0.33553719008264465, 'macro avg': {'precision': 0.33907544157832453, 'recall': 0.3351625855527674, 'f1-score': 0.2882380172375745, 'support': 28435}, 'weighted avg': {'precision': 0.3392217851620764, 'recall': 0.33553719008264465, 'f1-score': 0.2882849774881148, 'support': 28435}}
[[5452  370 3773]
 [5062  451 3995]
 [5234  460 3638]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962679
{'0': {'precision': 0.3900084198708953, 'recall': 0.453924803188188, 'f1-score': 0.41954621620397625, 'support': 61226}, '1': {'precision': 0.33271679399544296, 'recall': 0.25625567759517714, 'f1-score': 0.28952309863425896, 'support': 48436}, '2': {'precision': 0.3196116725762718, 'recall': 0.3264009914410751, 'f1-score': 0.32297065557908045, 'support': 51642}, 'accuracy': 0.3537420026781729, 'macro avg': {'precision': 0.3474456288142034, 'recall': 0.3455271574081467, 'f1-score': 0.3440133234724385, 'support': 161304}, 'weighted avg': {'precision': 0.3502672726290888, 'recall': 0.3537420026781729, 'f1-score': 0.34958418907261124, 'support': 161304}}
[[27792 12703 20731]
 [20872 12412 15152]
 [22596 12190 16856]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0947293
{'0': {'precision': 0.34251497005988024, 'recall': 0.4305391775597762, 'f1-score': 0.3815156130151073, 'support': 39857}, '1': {'precision': 0.3851033701500991, 'recall': 0.3409387222946545, 'f1-score': 0.36167779344096607, 'support': 39884}, '2': {'precision': 0.36584430875386764, 'recall': 0.3166864185826025, 'f1-score': 0.3394951150410997, 'support': 42190}, 'accuracy': 0.3618357923743757, 'macro avg': {'precision': 0.36448754965461566, 'recall': 0.36272143947901103, 'f1-score': 0.36089617383239103, 'support': 121931}, 'weighted avg': {'precision': 0.3645180746739457, 'recall': 0.3618357923743757, 'f1-score': 0.3604868639240769, 'support': 121931}}
[[17160 10586 12111]
 [15237 13598 11049]
 [17703 11126 13361]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0946699
{'0': {'precision': 0.34049861495844874, 'recall': 0.3989354796832403, 'f1-score': 0.36740793878527017, 'support': 15406}, '1': {'precision': 0.40492354546031345, 'recall': 0.3957338624666708, 'f1-score': 0.40027596588058206, 'support': 16127}, '2': {'precision': 0.3414727495407226, 'recall': 0.29077043410246384, 'f1-score': 0.31408857283672464, 'support': 15342}, 'accuracy': 0.362432, 'macro avg': {'precision': 0.3622983033198282, 'recall': 0.3618132587507916, 'f1-score': 0.36059082583419233, 'support': 46875}, 'weighted avg': {'precision': 0.36298237020036483, 'recall': 0.362432, 'f1-score': 0.3612647272777184, 'support': 46875}}
[[6146 4720 4540]
 [5682 6382 4063]
 [6222 4659 4461]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0753127
{'0': {'precision': 0.29922850397916717, 'recall': 0.08469380726045327, 'f1-score': 0.13202046612512683, 'support': 145170}, '1': {'precision': 0.5253181525527547, 'recall': 0.8596884527683124, 'f1-score': 0.6521412216290411, 'support': 312248}, '2': {'precision': 0.2915970730931361, 'recall': 0.10116583885209714, 'f1-score': 0.1502161309487227, 'support': 144960}, 'accuracy': 0.4903831149211957, 'macro avg': {'precision': 0.37204790987501934, 'recall': 0.3485160329602876, 'f1-score': 0.31145927290096354, 'support': 602378}, 'weighted avg': {'precision': 0.41458761132798555, 'recall': 0.4903831149211957, 'f1-score': 0.40600840930601106, 'support': 602378}}
[[ 12295 122995   9880]
 [ 18065 268436  25747]
 [ 10729 119566  14665]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993263
{'0': {'precision': 0.3499407849062768, 'recall': 0.0800093370681606, 'f1-score': 0.13024082926124922, 'support': 107100}, '1': {'precision': 0.3284974133152676, 'recall': 0.816285342617745, 'f1-score': 0.4684690124608882, 'support': 104548}, '2': {'precision': 0.39282005220759536, 'recall': 0.12927451089065012, 'f1-score': 0.19453035410223443, 'support': 108258}, 'accuracy': 0.33730220752346, 'macro avg': {'precision': 0.3570860834763799, 'recall': 0.34185639685885194, 'f1-score': 0.2644133986081239, 'support': 319906}, 'weighted avg': {'precision': 0.35744349541001635, 'recall': 0.33730220752346, 'f1-score': 0.2625326133396699, 'support': 319906}}
[[ 8569 88391 10140]
 [ 7715 85341 11492]
 [ 8203 86060 13995]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0904483
{'0': {'precision': 0.3425803610744166, 'recall': 0.07679399861810285, 'f1-score': 0.12546363489759715, 'support': 40524}, '1': {'precision': 0.3891411704603508, 'recall': 0.8423197427968792, 'f1-score': 0.5323454233668747, 'support': 48833}, '2': {'precision': 0.3392208231217781, 'recall': 0.10772368632923622, 'f1-score': 0.16351970669110905, 'support': 37262}, 'accuracy': 0.38113553258199795, 'macro avg': {'precision': 0.35698078488551516, 'recall': 0.34227914258140607, 'f1-score': 0.27377625498519365, 'support': 126619}, 'weighted avg': {'precision': 0.35954875366598743, 'recall': 0.38113553258199795, 'f1-score': 0.29358456243209097, 'support': 126619}}
[[ 3112 34168  3244]
 [ 3125 41133  4575]
 [ 2847 30401  4014]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0806022
{'0': {'precision': 0.31969635510227734, 'recall': 0.10034047011065278, 'f1-score': 0.15274128665915462, 'support': 274914}, '1': {'precision': 0.48728457716499796, 'recall': 0.8453253116248998, 'f1-score': 0.618206409103051, 'support': 476374}, '2': {'precision': 0.278127443565651, 'recall': 0.0906284721352013, 'f1-score': 0.13670975404593957, 'support': 239406}, 'accuracy': 0.4562185700125367, 'macro avg': {'precision': 0.36170279194430877, 'recall': 0.34543141795691795, 'f1-score': 0.3025524832693817, 'support': 990694}, 'weighted avg': {'precision': 0.39023561834760734, 'recall': 0.4562185700125367, 'f1-score': 0.37268552488234896, 'support': 990694}}
[[ 27585 228192  19137]
 [ 36506 402691  37177]
 [ 22194 195515  21697]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988022
{'0': {'precision': 0.34264566207054664, 'recall': 0.07749801847448462, 'f1-score': 0.12640608953059868, 'support': 134997}, '1': {'precision': 0.3409708043338947, 'recall': 0.8264208465478504, 'f1-score': 0.48276065800690415, 'support': 138421}, '2': {'precision': 0.3479536844351956, 'recall': 0.10025212926236816, 'f1-score': 0.15565660543998472, 'support': 130092}, 'accuracy': 0.341746177294243, 'macro avg': {'precision': 0.3438567169465456, 'recall': 0.33472366476156773, 'f1-score': 0.25494111765916255, 'support': 403510}, 'weighted avg': {'precision': 0.34378242637055606, 'recall': 0.341746177294243, 'f1-score': 0.2580811752502649, 'support': 403510}}
[[ 10462 113974  10561]
 [ 10148 114394  13879]
 [  9923 107127  13042]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998745
{'0': {'precision': 0.3281081081081081, 'recall': 0.0719876660341556, 'f1-score': 0.11807041431628088, 'support': 50592}, '1': {'precision': 0.32876765391736845, 'recall': 0.8359993696071865, 'f1-score': 0.4719391017621121, 'support': 50762}, '2': {'precision': 0.38203601838595436, 'recall': 0.09732033169533169, 'f1-score': 0.1551241452108862, 'support': 52096}, 'accuracy': 0.33332681655262303, 'macro avg': {'precision': 0.34630392680381034, 'recall': 0.33510245577889125, 'f1-score': 0.2483778870964264, 'support': 153450}, 'weighted avg': {'precision': 0.34663471793674516, 'recall': 0.33332681655262303, 'f1-score': 0.2477115578601756, 'support': 153450}}
[[ 3642 43367  3583]
 [ 3707 42437  4618]
 [ 3751 43275  5070]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957569
{'0': {'precision': 0.3529506688828285, 'recall': 0.2138757150540263, 'f1-score': 0.26635166896014223, 'support': 204530}, '1': {'precision': 0.3690359501166947, 'recall': 0.7344623605047733, 'f1-score': 0.49124318981727016, 'support': 221961}, '2': {'precision': 0.34271995847391645, 'recall': 0.10519502504406361, 'f1-score': 0.16097891761335495, 'support': 200846}, 'accuracy': 0.36327205313890304, 'macro avg': {'precision': 0.3549021924911466, 'recall': 0.3511777002009544, 'f1-score': 0.30619125879692244, 'support': 627337}, 'weighted avg': {'precision': 0.3553664483524945, 'recall': 0.36327205313890304, 'f1-score': 0.3121858079380316, 'support': 627337}}
[[ 43744 139247  21539]
 [ 39958 163022  18981]
 [ 40236 139482  21128]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0951718
{'0': {'precision': 0.3718629947452862, 'recall': 0.24039888859285197, 'f1-score': 0.29201703740948154, 'support': 105092}, '1': {'precision': 0.3549080367852859, 'recall': 0.6989517200649639, 'f1-score': 0.47077152564846275, 'support': 101595}, '2': {'precision': 0.3650976477514142, 'recall': 0.14207029810460056, 'f1-score': 0.20454578045457805, 'support': 100401}, 'accuracy': 0.3599554525087271, 'macro avg': {'precision': 0.3639562264273288, 'recall': 0.3604736355874721, 'f1-score': 0.3224447811708408, 'support': 307088}, 'weighted avg': {'precision': 0.3640418276613299, 'recall': 0.3599554525087271, 'f1-score': 0.32255668911553986, 'support': 307088}}
[[25264 66665 13163]
 [18943 71010 11642]
 [23732 62405 14264]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0931798
{'0': {'precision': 0.3483222824994977, 'recall': 0.228538283062645, 'f1-score': 0.2759938229347428, 'support': 37928}, '1': {'precision': 0.373165559565773, 'recall': 0.6731519481177484, 'f1-score': 0.4801546787614857, 'support': 39474}, '2': {'precision': 0.3557264751832712, 'recall': 0.16755349258462585, 'f1-score': 0.22780621079770655, 'support': 35332}, 'accuracy': 0.3651072435999787, 'macro avg': {'precision': 0.35907143908284733, 'recall': 0.35641457458833975, 'f1-score': 0.32798490416464504, 'support': 112734}, 'weighted avg': {'precision': 0.35934174827572524, 'recall': 0.3651072435999787, 'f1-score': 0.33237859514968315, 'support': 112734}}
[[ 8668 23983  5277]
 [ 7457 26572  5445]
 [ 8760 20652  5920]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
3337/3337 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0893075
{'0': {'precision': 0.340103857665669, 'recall': 0.1886827341614861, 'f1-score': 0.24271313514773535, 'support': 270401}, '1': {'precision': 0.4176462561487822, 'recall': 0.7317007040713692, 'f1-score': 0.531766420852239, 'support': 343005}, '2': {'precision': 0.32050411362930764, 'recall': 0.13729629983666583, 'f1-score': 0.19224110590282326, 'support': 240611}, 'accuracy': 0.3923013242125157, 'macro avg': {'precision': 0.35941807581458624, 'recall': 0.3525599126898404, 'f1-score': 0.3222402206342659, 'support': 854017}, 'weighted avg': {'precision': 0.3657257321475204, 'recall': 0.3923013242125157, 'f1-score': 0.3445876842895273, 'support': 854017}}
[[ 51020 188685  30696]
 [ 52687 250977  39341]
 [ 46306 161270  33035]]
Evaluating performance on  train set...
1431/1431 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0960684
{'0': {'precision': 0.34468911917098444, 'recall': 0.23559514112689026, 'f1-score': 0.27988724572438306, 'support': 112948}, '1': {'precision': 0.3689886026202697, 'recall': 0.6944795981732288, 'f1-score': 0.48192330769650354, 'support': 127219}, '2': {'precision': 0.3754573941170525, 'recall': 0.14746821874081897, 'f1-score': 0.21176255957674855, 'support': 125939}, 'accuracy': 0.36473862761058273, 'macro avg': {'precision': 0.3630450386361022, 'recall': 0.35918098601364606, 'f1-score': 0.32452437099921166, 'support': 366106}, 'weighted avg': {'precision': 0.3637171650466803, 'recall': 0.36473862761058273, 'f1-score': 0.32665859314639817, 'support': 366106}}
[[26610 71553 14785]
 [22760 88351 16108]
 [27830 79537 18572]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964155
{'0': {'precision': 0.3683058933247247, 'recall': 0.23905198705561892, 'f1-score': 0.28992545742037495, 'support': 42953}, '1': {'precision': 0.3430407588994974, 'recall': 0.7051171953930087, 'f1-score': 0.4615410050176485, 'support': 39592}, '2': {'precision': 0.38413121103915754, 'recall': 0.14679217355104307, 'f1-score': 0.21241277756396315, 'support': 43238}, 'accuracy': 0.3540383040633472, 'macro avg': {'precision': 0.3651592877544599, 'recall': 0.36365378533322357, 'f1-score': 0.3212930800006622, 'support': 125783}, 'weighted avg': {'precision': 0.36579329532001065, 'recall': 0.3540383040633472, 'f1-score': 0.317298866456888, 'support': 125783}}
[[10268 26928  5757]
 [ 7256 27917  4419]
 [10355 26536  6347]]
testing model on single stock: results/universal/W9/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
10303/10303 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975577
{'0': {'precision': 0.3037211166727112, 'recall': 0.26827382990423426, 'f1-score': 0.2848991155610434, 'support': 771048}, '1': {'precision': 0.42836163475754024, 'recall': 0.48577930949642784, 'f1-score': 0.45526725491352077, 'support': 1073014}, '2': {'precision': 0.3195835023664638, 'recall': 0.2978957266637927, 'f1-score': 0.30835874371590477, 'support': 793338}, 'accuracy': 0.36567528626677787, 'macro avg': {'precision': 0.3505554179322384, 'recall': 0.3506496220214849, 'f1-score': 0.349508371396823, 'support': 2637400}, 'weighted avg': {'precision': 0.3592019895830718, 'recall': 0.36567528626677787, 'f1-score': 0.3612693336395603, 'support': 2637400}}
[[206852 341323 222873]
 [271471 521248 280295]
 [202736 354270 236332]]
Evaluating performance on  train set...
3419/3419 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0971786
{'0': {'precision': 0.33124457726790707, 'recall': 0.20277156782426373, 'f1-score': 0.25155412578136943, 'support': 288068}, '1': {'precision': 0.35423372228676003, 'recall': 0.4967093090413593, 'f1-score': 0.41354398816002397, 'support': 289149}, '2': {'precision': 0.3644708809844392, 'recall': 0.35887908812630903, 'f1-score': 0.36165337112570417, 'support': 297936}, 'accuracy': 0.35303312677897464, 'macro avg': {'precision': 0.3499830601797021, 'recall': 0.35278665499731066, 'f1-score': 0.3422504950223659, 'support': 875153}, 'weighted avg': {'precision': 0.35015167158986565, 'recall': 0.35303312677897464, 'f1-score': 0.34255733947981454, 'support': 875153}}
[[ 58412 130549  99107]
 [ 58191 143623  87335]
 [ 59738 131275 106923]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980008
{'0': {'precision': 0.32499476345791317, 'recall': 0.18611625197066284, 'f1-score': 0.2366875510760011, 'support': 116712}, '1': {'precision': 0.3561793946067273, 'recall': 0.5534916626220581, 'f1-score': 0.43343651256349386, 'support': 121561}, '2': {'precision': 0.3547662667691035, 'recall': 0.3026900742060457, 'f1-score': 0.32666572948362727, 'support': 118993}, 'accuracy': 0.34994373939865536, 'macro avg': {'precision': 0.34531347494458126, 'recall': 0.34743266293292224, 'f1-score': 0.3322632643743741, 'support': 357266}, 'weighted avg': {'precision': 0.3455213051399917, 'recall': 0.34994373939865536, 'f1-score': 0.3336007023152451, 'support': 357266}}
[[21722 60967 34023]
 [22793 67283 31485]
 [22323 60652 36018]]
training model: results/universal/W9/deepVOL_L2/h300
Epoch 1/50
6697/6697 - 228s - loss: 3.2649 - accuracy300: 0.3769 - val_loss: 3.2827 - val_accuracy300: 0.3584 - 228s/epoch - 34ms/step
Epoch 2/50
6697/6697 - 226s - loss: 3.2557 - accuracy300: 0.3863 - val_loss: 3.2838 - val_accuracy300: 0.3564 - 226s/epoch - 34ms/step
Epoch 3/50
6697/6697 - 224s - loss: 3.2438 - accuracy300: 0.3944 - val_loss: 3.3006 - val_accuracy300: 0.3483 - 224s/epoch - 33ms/step
Epoch 4/50
6697/6697 - 224s - loss: 3.2322 - accuracy300: 0.3996 - val_loss: 3.2962 - val_accuracy300: 0.3507 - 224s/epoch - 33ms/step
Epoch 5/50
6697/6697 - 225s - loss: 3.2250 - accuracy300: 0.4025 - val_loss: 3.3083 - val_accuracy300: 0.3479 - 225s/epoch - 34ms/step
Epoch 6/50
6697/6697 - 225s - loss: 3.2198 - accuracy300: 0.4045 - val_loss: 3.3029 - val_accuracy300: 0.3536 - 225s/epoch - 34ms/step
Epoch 7/50
6697/6697 - 226s - loss: 3.2131 - accuracy300: 0.4075 - val_loss: 3.2970 - val_accuracy300: 0.3557 - 226s/epoch - 34ms/step
Epoch 8/50
6697/6697 - 227s - loss: 3.2081 - accuracy300: 0.4090 - val_loss: 3.3040 - val_accuracy300: 0.3507 - 227s/epoch - 34ms/step
Epoch 9/50
6697/6697 - 227s - loss: 3.2047 - accuracy300: 0.4107 - val_loss: 3.3060 - val_accuracy300: 0.3526 - 227s/epoch - 34ms/step
Epoch 10/50
6697/6697 - 233s - loss: 3.2008 - accuracy300: 0.4121 - val_loss: 3.3195 - val_accuracy300: 0.3470 - 233s/epoch - 35ms/step
Epoch 11/50
6697/6697 - 228s - loss: 3.1962 - accuracy300: 0.4139 - val_loss: 3.3137 - val_accuracy300: 0.3548 - 228s/epoch - 34ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 269s - 269s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956424
{'0': {'precision': 0.3348913047754043, 'recall': 0.3787723292079759, 'f1-score': 0.3554827610684505, 'support': 1348570}, '1': {'precision': 0.37052292895802524, 'recall': 0.4121460492772954, 'f1-score': 0.39022770949991015, 'support': 1604390}, '2': {'precision': 0.3456961859128223, 'recall': 0.25461492128355634, 'f1-score': 0.2932459723268964, 'support': 1354736}, 'accuracy': 0.35215576958076894, 'macro avg': {'precision': 0.35037013988208393, 'recall': 0.3485110999229426, 'f1-score': 0.34631881429841904, 'support': 4307696}, 'weighted avg': {'precision': 0.35156025796405466, 'recall': 0.35215576958076894, 'f1-score': 0.34885045219181937, 'support': 4307696}}
[[510801 555829 281940]
 [572222 661243 370925]
 [442251 567549 344936]]
Evaluating performance on  train set...
6697/6697 - 113s - 113s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943469
{'0': {'precision': 0.36908442492953636, 'recall': 0.37766527965565794, 'f1-score': 0.3733255512568025, 'support': 572454}, '1': {'precision': 0.3337843158609019, 'recall': 0.42259997065535776, 'f1-score': 0.372977716757482, 'support': 565691}, '2': {'precision': 0.37651810071160213, 'recall': 0.26939881221130135, 'f1-score': 0.31407608959720135, 'support': 575860}, 'accuracy': 0.3561208981304022, 'macro avg': {'precision': 0.3597956138340135, 'recall': 0.356554687507439, 'f1-score': 0.3534597858704953, 'support': 1714005}, 'weighted avg': {'precision': 0.35993147761416416, 'recall': 0.3561208981304022, 'f1-score': 0.3533045117399673, 'support': 1714005}}
[[216196 234465 121793]
 [191531 239061 135099]
 [178036 242688 155136]]
Evaluating performance on  val set...
2631/2631 - 45s - 45s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940319
{'0': {'precision': 0.3692384398748846, 'recall': 0.4196583126364115, 'f1-score': 0.39283716188494866, 'support': 225879}, '1': {'precision': 0.3446259459301219, 'recall': 0.4121124603435073, 'f1-score': 0.37535995344768147, 'support': 228525}, '2': {'precision': 0.36896037628876804, 'recall': 0.2412891826570968, 'f1-score': 0.2917696418539132, 'support': 218464}, 'accuracy': 0.3591833762342688, 'macro avg': {'precision': 0.36094158736459153, 'recall': 0.3576866518790052, 'f1-score': 0.35332225239551446, 'support': 672868}, 'weighted avg': {'precision': 0.3607890604096637, 'recall': 0.3591833762342688, 'f1-score': 0.35408722318346986, 'support': 672868}}
[[94792 88317 42770]
 [86961 94178 47386]
 [74970 90781 52713]]
testing model out of sample: results/universal/W9/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 142s - 142s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913258
{'0': {'precision': 0.3919373085503498, 'recall': 0.38131357818138917, 'f1-score': 0.3865524633998009, 'support': 745932}, '1': {'precision': 0.3608315950883834, 'recall': 0.4353446480090823, 'f1-score': 0.3946013338533587, 'support': 768088}, '2': {'precision': 0.3692430472795725, 'recall': 0.29595261316046123, 'f1-score': 0.32856030558417176, 'support': 697240}, 'accuracy': 0.37316597776833116, 'macro avg': {'precision': 0.37400398363943527, 'recall': 0.37087027978364423, 'f1-score': 0.36990470094577715, 'support': 2211260}, 'weighted avg': {'precision': 0.37397683715846847, 'recall': 0.37316597776833116, 'f1-score': 0.37106255660166915, 'support': 2211260}}
[[284434 302939 158559]
 [239768 334383 193937]
 [201511 289379 206350]]
Evaluating performance on  train set...
3947/3947 - 67s - 67s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934366
{'0': {'precision': 0.3666741383174992, 'recall': 0.38850051152141085, 'f1-score': 0.37727190744130074, 'support': 328432}, '1': {'precision': 0.34587862477135833, 'recall': 0.4315250285621259, 'f1-score': 0.38398400314556513, 'support': 343987}, '2': {'precision': 0.3780950045389815, 'recall': 0.26065150270347226, 'f1-score': 0.30857634438806864, 'support': 337159}, 'accuracy': 0.3604634807810788, 'macro avg': {'precision': 0.36354925587594633, 'recall': 0.36022568092900303, 'f1-score': 0.3566107516583115, 'support': 1009578}, 'weighted avg': {'precision': 0.36340273335044604, 'recall': 0.3604634807810788, 'f1-score': 0.35661728374858764, 'support': 1009578}}
[[127596 135312  65524]
 [116522 148439  79026]
 [103864 145414  87881]]
Evaluating performance on  val set...
1402/1402 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938473
{'0': {'precision': 0.36157679724713104, 'recall': 0.36468938869369716, 'f1-score': 0.3631264230842892, 'support': 116979}, '1': {'precision': 0.3531744750117884, 'recall': 0.43859395806260126, 'f1-score': 0.3912765005814473, 'support': 124662}, '2': {'precision': 0.3745420923890781, 'recall': 0.2744573374156311, 'f1-score': 0.3167824830234998, 'support': 116601}, 'accuracy': 0.36103806923811277, 'macro avg': {'precision': 0.3630977882159992, 'recall': 0.3592468947239765, 'f1-score': 0.35706180222974543, 'support': 358242}, 'weighted avg': {'precision': 0.3628728934177193, 'recall': 0.36103806923811277, 'f1-score': 0.3578380850500068, 'support': 358242}}
[[42661 49580 24738]
 [41283 54676 28703]
 [34042 50557 32002]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950078
{'0': {'precision': 0.3648941446732973, 'recall': 0.5279897257686788, 'f1-score': 0.43154628671987155, 'support': 26474}, '1': {'precision': 0.3348245434024215, 'recall': 0.3155289112357378, 'f1-score': 0.3248904818797292, 'support': 25855}, '2': {'precision': 0.35435364509526057, 'recall': 0.19531351703189412, 'f1-score': 0.25182532799955243, 'support': 23045}, 'accuracy': 0.3533977233528803, 'macro avg': {'precision': 0.35135744439032646, 'recall': 0.3462773846787702, 'f1-score': 0.336087365533051, 'support': 75374}, 'weighted avg': {'precision': 0.3513569122903224, 'recall': 0.3533977233528803, 'f1-score': 0.3400126633503856, 'support': 75374}}
[[13978  8371  4125]
 [13621  8158  4076]
 [10708  7836  4501]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100791
{'0': {'precision': 0.3442443483496634, 'recall': 0.37059516794342956, 'f1-score': 0.3569340787196005, 'support': 16970}, '1': {'precision': 0.33128800133876274, 'recall': 0.3521285426301435, 'f1-score': 0.3413905095852614, 'support': 16866}, '2': {'precision': 0.3308779213821737, 'recall': 0.2857225466951946, 'f1-score': 0.30664680692608454, 'support': 17293}, 'accuracy': 0.3357976882004342, 'macro avg': {'precision': 0.3354700903568666, 'recall': 0.3361487524229226, 'f1-score': 0.33499046507698216, 'support': 51129}, 'weighted avg': {'precision': 0.3354495866638364, 'recall': 0.3357976882004342, 'f1-score': 0.3347983900078119, 'support': 51129}}
[[6289 5921 4760]
 [5695 5939 5232]
 [6285 6067 4941]]
Evaluating performance on  val set...
53/53 - 1s - 565ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096619
{'0': {'precision': 0.3153861665658399, 'recall': 0.37291368621840726, 'f1-score': 0.34174587566917947, 'support': 4194}, '1': {'precision': 0.3862549800796813, 'recall': 0.3590740740740741, 'f1-score': 0.372168905950096, 'support': 5400}, '2': {'precision': 0.28963153384747214, 'recall': 0.2609366958311889, 'f1-score': 0.274536347637742, 'support': 3886}, 'accuracy': 0.33508902077151337, 'macro avg': {'precision': 0.3304242268309978, 'recall': 0.3309748187078901, 'f1-score': 0.32948370975233915, 'support': 13480}, 'weighted avg': {'precision': 0.3363512326067276, 'recall': 0.33508902077151337, 'f1-score': 0.33455805204802097, 'support': 13480}}
[[1564 1651  979]
 [1953 1939 1508]
 [1442 1430 1014]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092931
{'0': {'precision': 0.3262914547517969, 'recall': 0.447470054530153, 'f1-score': 0.37739187927815804, 'support': 86741}, '1': {'precision': 0.3678226421684421, 'recall': 0.3606329866806049, 'f1-score': 0.3641923344694057, 'support': 110966}, '2': {'precision': 0.39238078931598325, 'recall': 0.25909553420011305, 'f1-score': 0.31210377583330495, 'support': 88450}, 'accuracy': 0.35557054344293515, 'macro avg': {'precision': 0.36216496207874077, 'recall': 0.35573285847029035, 'f1-score': 0.35122932986028954, 'support': 286157}, 'weighted avg': {'precision': 0.36282437683679825, 'recall': 0.35557054344293515, 'f1-score': 0.3520930627580475, 'support': 286157}}
[[38814 31849 16078]
 [51538 40018 19410]
 [28603 36930 22917]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0871856
{'0': {'precision': 0.39618638841609316, 'recall': 0.3715158104138234, 'f1-score': 0.38345469738569893, 'support': 43231}, '1': {'precision': 0.37779601086170855, 'recall': 0.41256533333333334, 'f1-score': 0.3944158916625877, 'support': 46875}, '2': {'precision': 0.3921416948971698, 'recall': 0.37587890874689983, 'f1-score': 0.38383812010443863, 'support': 39111}, 'accuracy': 0.3877276209786638, 'macro avg': {'precision': 0.38870803139165716, 'recall': 0.38665335083135216, 'f1-score': 0.3872362363842418, 'support': 129217}, 'weighted avg': {'precision': 0.38829082547870575, 'recall': 0.3877276209786638, 'f1-score': 0.3875470538688381, 'support': 129217}}
[[16061 17053 10117]
 [14865 19339 12671]
 [ 9613 14797 14701]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0880414
{'0': {'precision': 0.37120905782450464, 'recall': 0.4740511231603408, 'f1-score': 0.4163737385191065, 'support': 15492}, '1': {'precision': 0.3542051068388786, 'recall': 0.34309599308157973, 'f1-score': 0.34856205704914195, 'support': 17345}, '2': {'precision': 0.4071962949768436, 'recall': 0.30528846153846156, 'f1-score': 0.34895435811326514, 'support': 14976}, 'accuracy': 0.37368498107209336, 'macro avg': {'precision': 0.37753681988007565, 'recall': 0.3741451925934607, 'f1-score': 0.37129671789383784, 'support': 47813}, 'weighted avg': {'precision': 0.3763125094746363, 'recall': 0.37368498107209336, 'f1-score': 0.3706567524263196, 'support': 47813}}
[[7344 5459 2689]
 [7427 5951 3967]
 [5013 5391 4572]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932075
{'0': {'precision': 0.3429269388442747, 'recall': 0.3004206331636042, 'f1-score': 0.32026957924134947, 'support': 40653}, '1': {'precision': 0.3625880029307763, 'recall': 0.4920243807547659, 'f1-score': 0.4175042183258748, 'support': 46266}, '2': {'precision': 0.33423386199663097, 'recall': 0.24489986027014438, 'f1-score': 0.28267677378600325, 'support': 42940}, 'accuracy': 0.3503261229487367, 'macro avg': {'precision': 0.34658293459056067, 'recall': 0.34578162472950486, 'f1-score': 0.3401501904510758, 'support': 129859}, 'weighted avg': {'precision': 0.347057249960087, 'recall': 0.3503261229487367, 'f1-score': 0.34248153794757763, 'support': 129859}}
[[12213 19349  9091]
 [11646 22764 11856]
 [11755 20669 10516]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971519
{'0': {'precision': 0.35512470771628996, 'recall': 0.3264812575574365, 'f1-score': 0.34020113400378, 'support': 22329}, '1': {'precision': 0.3370704440068602, 'recall': 0.4798354281580613, 'f1-score': 0.3959779120961122, 'support': 22118}, '2': {'precision': 0.3619693713057496, 'recall': 0.23999109329770651, 'f1-score': 0.2886216961679565, 'support': 22455}, 'accuracy': 0.3481510268751308, 'macro avg': {'precision': 0.3513881743429666, 'recall': 0.3487692596710681, 'f1-score': 0.3416002474226163, 'support': 66902}, 'weighted avg': {'precision': 0.35145325867405125, 'recall': 0.3481510268751308, 'f1-score': 0.3413289702604358, 'support': 66902}}
[[ 7290 10318  4721]
 [ 6727 10613  4778]
 [ 6511 10555  5389]]
Evaluating performance on  val set...
73/73 - 1s - 777ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975939
{'0': {'precision': 0.3710063897763578, 'recall': 0.28752708139894767, 'f1-score': 0.3239755884917175, 'support': 6462}, '1': {'precision': 0.3364545648010215, 'recall': 0.5135617995777164, 'f1-score': 0.4065573770491803, 'support': 6157}, '2': {'precision': 0.3401600753295669, 'recall': 0.23943661971830985, 'f1-score': 0.28104638724107756, 'support': 6035}, 'accuracy': 0.3465744612415568, 'macro avg': {'precision': 0.3492070099689821, 'recall': 0.34684183356499126, 'f1-score': 0.3371931175939918, 'support': 18654}, 'weighted avg': {'precision': 0.3496226064559156, 'recall': 0.3465744612415568, 'f1-score': 0.3373442141270067, 'support': 18654}}
[[1858 3175 1429]
 [1621 3162 1374]
 [1529 3061 1445]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979692
{'0': {'precision': 0.30609413157699994, 'recall': 0.35596721099851547, 'f1-score': 0.32915220180839744, 'support': 46479}, '1': {'precision': 0.375687224610961, 'recall': 0.4791266998285317, 'f1-score': 0.42114845102369725, 'support': 58903}, '2': {'precision': 0.327350528943302, 'recall': 0.16850907607587193, 'f1-score': 0.22248852145578912, 'support': 49030}, 'accuracy': 0.34342538144703777, 'macro avg': {'precision': 0.3363772950437543, 'recall': 0.3345343289676397, 'f1-score': 0.3242630580959613, 'support': 154412}, 'weighted avg': {'precision': 0.3393910458184397, 'recall': 0.34342538144703777, 'f1-score': 0.3303770730608935, 'support': 154412}}
[[16545 22792  7142]
 [20846 28222  9835]
 [16661 24107  8262]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995839
{'0': {'precision': 0.3527111299017017, 'recall': 0.34780947086822084, 'f1-score': 0.350243151523633, 'support': 28783}, '1': {'precision': 0.3308045079767771, 'recall': 0.49830969354008964, 'f1-score': 0.39763664086324185, 'support': 27214}, '2': {'precision': 0.3154321918841454, 'recall': 0.1569937683009235, 'f1-score': 0.20964507720072184, 'support': 26638}, 'accuracy': 0.3358625279845102, 'macro avg': {'precision': 0.33298260992087475, 'recall': 0.3343709775697447, 'f1-score': 0.31917495652919886, 'support': 82635}, 'weighted avg': {'precision': 0.3334795311847347, 'recall': 0.3358625279845102, 'f1-score': 0.3205283202181863, 'support': 82635}}
[[10011 14134  4638]
 [ 9215 13561  4438]
 [ 9157 13299  4182]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008996
{'0': {'precision': 0.3528205128205128, 'recall': 0.3470540758676352, 'f1-score': 0.3499135388058183, 'support': 9912}, '1': {'precision': 0.30576936657015746, 'recall': 0.4982738780207135, 'f1-score': 0.3789768500284451, 'support': 8690}, '2': {'precision': 0.33569060773480663, 'recall': 0.15446410412853365, 'f1-score': 0.21157462218817466, 'support': 9834}, 'accuracy': 0.3266633844422563, 'macro avg': {'precision': 0.33142682904182563, 'recall': 0.33326401933896077, 'f1-score': 0.3134883370074794, 'support': 28436}, 'weighted avg': {'precision': 0.3325177294639077, 'recall': 0.3266633844422563, 'f1-score': 0.31095360310834746, 'support': 28436}}
[[3440 4877 1595]
 [2949 4330 1411]
 [3361 4954 1519]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099518
{'0': {'precision': 0.3939476864837746, 'recall': 0.28934409754790297, 'f1-score': 0.33363912896528414, 'support': 59704}, '1': {'precision': 0.29244928886231875, 'recall': 0.43949270820274955, 'f1-score': 0.35120086151483026, 'support': 47862}, '2': {'precision': 0.3312321546233253, 'recall': 0.280618510662052, 'f1-score': 0.30383189620436785, 'support': 53742}, 'accuracy': 0.3309879237235599, 'macro avg': {'precision': 0.3392097099898062, 'recall': 0.3364851054709015, 'f1-score': 0.32955729556149405, 'support': 161308}, 'weighted avg': {'precision': 0.3429373558107616, 'recall': 0.3309879237235599, 'f1-score': 0.32891921017792836, 'support': 161308}}
[[17275 26803 15626]
 [12004 21035 14823]
 [14572 24089 15081]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995054
{'0': {'precision': 0.3310079064513986, 'recall': 0.3750564617314931, 'f1-score': 0.35165817677023165, 'support': 39850}, '1': {'precision': 0.3215578043544925, 'recall': 0.39027839809438736, 'f1-score': 0.35260096170012445, 'support': 40302}, '2': {'precision': 0.3558123676560313, 'recall': 0.23729624931185525, 'f1-score': 0.2847132477527929, 'support': 41779}, 'accuracy': 0.3328849923317286, 'macro avg': {'precision': 0.3361260261539741, 'recall': 0.3342103697125786, 'f1-score': 0.329657462074383, 'support': 121931}, 'weighted avg': {'precision': 0.33638346779313155, 'recall': 0.3328849923317286, 'f1-score': 0.32903147747985406, 'support': 121931}}
[[14946 15939  8965]
 [15589 15729  8984]
 [14618 17247  9914]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974618
{'0': {'precision': 0.3358479532163743, 'recall': 0.3703249935517152, 'f1-score': 0.3522448478900883, 'support': 15508}, '1': {'precision': 0.34696462957332525, 'recall': 0.41421657592256506, 'f1-score': 0.37761967791749396, 'support': 16530}, '2': {'precision': 0.33014639976098, 'recall': 0.22342791669474962, 'f1-score': 0.2665005225500442, 'support': 14837}, 'accuracy': 0.33930666666666665, 'macro avg': {'precision': 0.3376529941835598, 'recall': 0.33598982872301003, 'f1-score': 0.33212168278587545, 'support': 46875}, 'weighted avg': {'precision': 0.33796346706304553, 'recall': 0.33930666666666665, 'f1-score': 0.33405300544278765, 'support': 46875}}
[[5743 6546 3219]
 [6176 6847 3507]
 [5181 6341 3315]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
2354/2354 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.084273
{'0': {'precision': 0.4179739049291303, 'recall': 0.3845661450924609, 'f1-score': 0.40057468375195465, 'support': 196840}, '1': {'precision': 0.3549437203420601, 'recall': 0.405371782650143, 'f1-score': 0.37848542635072446, 'support': 209800}, '2': {'precision': 0.4147731025827333, 'recall': 0.3849505982364541, 'f1-score': 0.3993057947590154, 'support': 195742}, 'accuracy': 0.3919373420852549, 'macro avg': {'precision': 0.3958969092846412, 'recall': 0.391629508659686, 'f1-score': 0.3927886349538981, 'support': 602382}, 'weighted avg': {'precision': 0.394981411495967, 'recall': 0.3919373420852549, 'f1-score': 0.3924690280848962, 'support': 602382}}
[[75698 76985 44157]
 [62593 85047 62160]
 [42816 77575 75351]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0816841
{'0': {'precision': 0.436350406646342, 'recall': 0.44532909702769263, 'f1-score': 0.4407940340446516, 'support': 106382}, '1': {'precision': 0.34668633769460727, 'recall': 0.42455996881032304, 'f1-score': 0.38169165797527654, 'support': 105163}, '2': {'precision': 0.4502307664352945, 'recall': 0.3429892397703992, 'f1-score': 0.38936059880678625, 'support': 108362}, 'accuracy': 0.40383611487088433, 'macro avg': {'precision': 0.41108917025874797, 'recall': 0.4042927685361383, 'f1-score': 0.4039487636089048, 'support': 319907}, 'weighted avg': {'precision': 0.41157683515299925, 'recall': 0.40383611487088433, 'f1-score': 0.40394328340828145, 'support': 319907}}
[[47375 39920 19087]
 [34218 44648 26297]
 [26978 44217 37167]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.082335
{'0': {'precision': 0.42871131167780663, 'recall': 0.47113315242818377, 'f1-score': 0.4489222744800838, 'support': 42748}, '1': {'precision': 0.3536025979297747, 'recall': 0.40998729232362213, 'f1-score': 0.37971317728085086, 'support': 42494}, '2': {'precision': 0.4412762174442725, 'recall': 0.3238997510694347, 'f1-score': 0.3735853264202486, 'support': 41377}, 'accuracy': 0.402498835087941, 'macro avg': {'precision': 0.4078633756839512, 'recall': 0.40167339860708023, 'f1-score': 0.40074025939372776, 'support': 126619}, 'weighted avg': {'precision': 0.40761043759011195, 'recall': 0.402498835087941, 'f1-score': 0.4010764671663631, 'support': 126619}}
[[20140 14980  7628]
 [15731 17422  9341]
 [11107 16868 13402]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
3870/3870 - 34s - 34s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0898278
{'0': {'precision': 0.4273714839961203, 'recall': 0.3814187278540183, 'f1-score': 0.40308966493053433, 'support': 346564}, '1': {'precision': 0.342639356770982, 'recall': 0.4114213593443236, 'f1-score': 0.37389336671405665, 'support': 320890}, '2': {'precision': 0.3894363913918647, 'recall': 0.35672433208350346, 'f1-score': 0.37236330521720035, 'support': 323244}, 'accuracy': 0.3830794046217919, 'macro avg': {'precision': 0.3864824107196556, 'recall': 0.3831881397606151, 'f1-score': 0.38311544562059713, 'support': 990698}, 'weighted avg': {'precision': 0.3875490725457645, 'recall': 0.3830794046217919, 'f1-score': 0.3836075305627831, 'support': 990698}}
[[132186 130299  84079]
 [ 92165 132021  96704]
 [ 84949 122986 115309]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0881888
{'0': {'precision': 0.3803081776267896, 'recall': 0.43640118496059155, 'f1-score': 0.40642839905922357, 'support': 129287}, '1': {'precision': 0.3781641337386018, 'recall': 0.4208247645849118, 'f1-score': 0.3983555538479272, 'support': 147824}, '2': {'precision': 0.38833366426191895, 'recall': 0.2785148616682094, 'f1-score': 0.32438160265004395, 'support': 126399}, 'accuracy': 0.3812371440608659, 'macro avg': {'precision': 0.3822686585424368, 'recall': 0.37858027040457093, 'f1-score': 0.3763885185190649, 'support': 403510}, 'weighted avg': {'precision': 0.38203669077755725, 'recall': 0.3812371440608659, 'f1-score': 0.3777698942146384, 'support': 403510}}
[[56421 49725 23141]
 [53307 62208 32309]
 [38628 52567 35204]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0884619
{'0': {'precision': 0.3648201850791481, 'recall': 0.41520738295949045, 'f1-score': 0.38838636095489043, 'support': 47569}, '1': {'precision': 0.3843195830420136, 'recall': 0.424516876415144, 'f1-score': 0.40341937367082276, 'support': 56973}, '2': {'precision': 0.4129030484620248, 'recall': 0.30712766827512883, 'f1-score': 0.3522459460410145, 'support': 48908}, 'accuracy': 0.3842163571195829, 'macro avg': {'precision': 0.3873476055277288, 'recall': 0.3822839758832544, 'f1-score': 0.3813505602222426, 'support': 153450}, 'weighted avg': {'precision': 0.3873850327980667, 'recall': 0.3842163571195829, 'f1-score': 0.38244905512795635, 'support': 153450}}
[[19751 18721  9097]
 [20526 24186 12261]
 [13862 20025 15021]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963756
{'0': {'precision': 0.3664358003567658, 'recall': 0.3814922375034939, 'f1-score': 0.3738124693905499, 'support': 211079}, '1': {'precision': 0.34294219506975115, 'recall': 0.41280510368021434, 'f1-score': 0.3746445104765791, 'support': 213493}, '2': {'precision': 0.3514382088125149, 'recall': 0.26102609373227664, 'f1-score': 0.29955882311325427, 'support': 202769}, 'accuracy': 0.3532114113376935, 'macro avg': {'precision': 0.3536054014130106, 'recall': 0.35177447830532826, 'f1-score': 0.3493386009934611, 'support': 627341}, 'weighted avg': {'precision': 0.35359307699996817, 'recall': 0.3532114113376935, 'f1-score': 0.35009537987396905, 'support': 627341}}
[[80525 86065 44489]
 [72175 88131 53187]
 [67052 82789 52928]]
Evaluating performance on  train set...
1200/1200 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949705
{'0': {'precision': 0.3859070659170688, 'recall': 0.39249783337729377, 'f1-score': 0.38917454757734965, 'support': 106156}, '1': {'precision': 0.32180248025211805, 'recall': 0.4048545888943813, 'f1-score': 0.3585823805462697, 'support': 97104}, '2': {'precision': 0.37706281348267884, 'recall': 0.279470683411665, 'f1-score': 0.32101333038331764, 'support': 103832}, 'accuracy': 0.35818907688901047, 'macro avg': {'precision': 0.3615907865506219, 'recall': 0.35894103522778, 'f1-score': 0.3562567528356457, 'support': 307092}, 'weighted avg': {'precision': 0.3626465182467388, 'recall': 0.35818907688901047, 'f1-score': 0.3564549153789312, 'support': 307092}}
[[41666 41218 23272]
 [33123 39313 24668]
 [33180 41634 29018]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954956
{'0': {'precision': 0.3787557399594415, 'recall': 0.41556481931408407, 'f1-score': 0.39630740713641127, 'support': 39101}, '1': {'precision': 0.3348024520112757, 'recall': 0.40135707772354234, 'f1-score': 0.36507123341139736, 'support': 37286}, '2': {'precision': 0.3670181022478615, 'recall': 0.2538036151539329, 'f1-score': 0.3000878305845613, 'support': 36347}, 'accuracy': 0.35871165753011514, 'macro avg': {'precision': 0.3601920980728596, 'recall': 0.3569085040638531, 'f1-score': 0.35382215704412334, 'support': 112734}, 'weighted avg': {'precision': 0.36043411372123374, 'recall': 0.35871165753011514, 'f1-score': 0.354953734575862, 'support': 112734}}
[[16249 15180  7672]
 [14083 14965  8238]
 [12569 14553  9225]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
3337/3337 - 29s - 29s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0909314
{'0': {'precision': 0.36325901089689855, 'recall': 0.3975313443679207, 'f1-score': 0.3796232219724696, 'support': 272537}, '1': {'precision': 0.3929720910621738, 'recall': 0.4585853338019345, 'f1-score': 0.4232509336251735, 'support': 327215}, '2': {'precision': 0.3518761283793885, 'recall': 0.2406860450939753, 'f1-score': 0.2858490720262687, 'support': 254269}, 'accuracy': 0.3742261607150175, 'macro avg': {'precision': 0.369369076779487, 'recall': 0.3656009077546101, 'f1-score': 0.3629077425413039, 'support': 854021}, 'weighted avg': {'precision': 0.37125442479355425, 'recall': 0.3742261607150175, 'f1-score': 0.36841949552519127, 'support': 854021}}
[[108342 118132  46063]
 [110499 150056  66660]
 [ 79409 113661  61199]]
Evaluating performance on  train set...
1431/1431 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955635
{'0': {'precision': 0.3672271889361039, 'recall': 0.35361178705956864, 'f1-score': 0.3602909022980942, 'support': 119996}, '1': {'precision': 0.32134951438838133, 'recall': 0.4583279858312585, 'f1-score': 0.37780614583847605, 'support': 116877}, '2': {'precision': 0.3862655314683647, 'recall': 0.2506557922512052, 'f1-score': 0.3040240268424881, 'support': 129233}, 'accuracy': 0.3506989778916489, 'macro avg': {'precision': 0.35828074493094997, 'recall': 0.35419852171401073, 'f1-score': 0.3473736916596861, 'support': 366106}, 'weighted avg': {'precision': 0.35930144380315737, 'recall': 0.3506989778916489, 'f1-score': 0.34602069641104194, 'support': 366106}}
[[42432 53826 23738]
 [35578 53568 27731]
 [37537 59303 32393]]
Evaluating performance on  val set...
492/492 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985587
{'0': {'precision': 0.3688114121755136, 'recall': 0.3150580400499468, 'f1-score': 0.3398221701230842, 'support': 43246}, '1': {'precision': 0.31547320114295613, 'recall': 0.46000202009999497, 'f1-score': 0.3742693662876103, 'support': 39602}, '2': {'precision': 0.35568419360025727, 'recall': 0.2575986957028066, 'f1-score': 0.2987977846818857, 'support': 42935}, 'accuracy': 0.34107947814887546, 'macro avg': {'precision': 0.34665626897290897, 'recall': 0.3442195852842495, 'f1-score': 0.3376297736975267, 'support': 125783}, 'weighted avg': {'precision': 0.34753733727795216, 'recall': 0.34107947814887546, 'f1-score': 0.3366643178981389, 'support': 125783}}
[[13625 19807  9814]
 [11164 18217 10221]
 [12154 19721 11060]]
testing model on single stock: results/universal/W9/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
10303/10303 - 92s - 92s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981975
{'0': {'precision': 0.31407262285639814, 'recall': 0.3700873511173091, 'f1-score': 0.3397869196477051, 'support': 807431}, '1': {'precision': 0.38043160254523223, 'recall': 0.41534253402793436, 'f1-score': 0.3971212899828059, 'support': 1011228}, '2': {'precision': 0.3193989789377997, 'recall': 0.2270206230267055, 'f1-score': 0.2654010029357002, 'support': 818745}, 'accuracy': 0.3430259452097593, 'macro avg': {'precision': 0.33796773477981, 'recall': 0.33748350272398303, 'f1-score': 0.33410307085540375, 'support': 2637404}, 'weighted avg': {'precision': 0.3411693383094146, 'recall': 0.3430259452097593, 'f1-score': 0.33867788336310584, 'support': 2637404}}
[[298820 338466 170145]
 [365296 420006 225926]
 [287320 345553 185872]]
Evaluating performance on  train set...
3419/3419 - 35s - 35s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0993625
{'0': {'precision': 0.33622630450131213, 'recall': 0.3506679356169808, 'f1-score': 0.34329530577894146, 'support': 287902}, '1': {'precision': 0.3272622801860067, 'recall': 0.42322912886446507, 'f1-score': 0.3691099673707452, 'support': 289335}, '2': {'precision': 0.3478869590346078, 'recall': 0.2343706468580175, 'f1-score': 0.2800632943125367, 'support': 297917}, 'accuracy': 0.3350678851950628, 'macro avg': {'precision': 0.3371251812406422, 'recall': 0.33608923711315447, 'f1-score': 0.3308228558207411, 'support': 875154}, 'weighted avg': {'precision': 0.33723218602768, 'recall': 0.3350678851950628, 'f1-score': 0.3303046709325345, 'support': 875154}}
[[100958 122330  64614]
 [100611 122455  66269]
 [ 98699 129395  69823]]
Evaluating performance on  val set...
1396/1396 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981531
{'0': {'precision': 0.346378993142666, 'recall': 0.4015392915549711, 'f1-score': 0.3719250574874191, 'support': 118626}, '1': {'precision': 0.34480171924418135, 'recall': 0.4157851845815337, 'f1-score': 0.3769811069816242, 'support': 122710}, '2': {'precision': 0.33528846287808073, 'recall': 0.2075907875442077, 'f1-score': 0.2564209113139094, 'support': 115930}, 'accuracy': 0.3434975620406084, 'macro avg': {'precision': 0.3421563917549761, 'recall': 0.3416384212269042, 'f1-score': 0.33510902526098424, 'support': 357266}, 'weighted avg': {'precision': 0.3422384579289697, 'recall': 0.3434975620406084, 'f1-score': 0.3361814719448232, 'support': 357266}}
[[47633 47944 23049]
 [47027 51021 24662]
 [42857 49007 24066]]
training model: results/universal/W9/deepVOL_L2/h500
Epoch 1/50
6697/6697 - 225s - loss: 3.2710 - accuracy500: 0.3745 - val_loss: 3.3222 - val_accuracy500: 0.3503 - 225s/epoch - 34ms/step
Epoch 2/50
6697/6697 - 229s - loss: 3.2671 - accuracy500: 0.3785 - val_loss: 3.3226 - val_accuracy500: 0.3532 - 229s/epoch - 34ms/step
Epoch 3/50
6697/6697 - 237s - loss: 3.2617 - accuracy500: 0.3825 - val_loss: 3.3153 - val_accuracy500: 0.3473 - 237s/epoch - 35ms/step
Epoch 4/50
6697/6697 - 236s - loss: 3.2601 - accuracy500: 0.3836 - val_loss: 3.3127 - val_accuracy500: 0.3514 - 236s/epoch - 35ms/step
Epoch 5/50
6697/6697 - 235s - loss: 3.2561 - accuracy500: 0.3872 - val_loss: 3.3129 - val_accuracy500: 0.3456 - 235s/epoch - 35ms/step
Epoch 6/50
6697/6697 - 230s - loss: 3.2537 - accuracy500: 0.3884 - val_loss: 3.3137 - val_accuracy500: 0.3471 - 230s/epoch - 34ms/step
Epoch 7/50
6697/6697 - 244s - loss: 3.2496 - accuracy500: 0.3903 - val_loss: 3.3207 - val_accuracy500: 0.3488 - 244s/epoch - 36ms/step
Epoch 8/50
6697/6697 - 229s - loss: 3.2461 - accuracy500: 0.3927 - val_loss: 3.3112 - val_accuracy500: 0.3495 - 229s/epoch - 34ms/step
Epoch 9/50
6697/6697 - 231s - loss: 3.2420 - accuracy500: 0.3953 - val_loss: 3.3219 - val_accuracy500: 0.3481 - 231s/epoch - 34ms/step
Epoch 10/50
6697/6697 - 234s - loss: 3.2404 - accuracy500: 0.3962 - val_loss: 3.3313 - val_accuracy500: 0.3490 - 234s/epoch - 35ms/step
Epoch 11/50
6697/6697 - 233s - loss: 3.2359 - accuracy500: 0.3996 - val_loss: 3.3393 - val_accuracy500: 0.3468 - 233s/epoch - 35ms/step
Epoch 12/50
6697/6697 - 226s - loss: 3.2334 - accuracy500: 0.4008 - val_loss: 3.3464 - val_accuracy500: 0.3479 - 226s/epoch - 34ms/step
Epoch 13/50
6697/6697 - 224s - loss: 3.2300 - accuracy500: 0.4028 - val_loss: 3.3507 - val_accuracy500: 0.3483 - 224s/epoch - 33ms/step
Epoch 14/50
6697/6697 - 225s - loss: 3.2262 - accuracy500: 0.4041 - val_loss: 3.3636 - val_accuracy500: 0.3495 - 225s/epoch - 34ms/step
Epoch 15/50
6697/6697 - 223s - loss: 3.2233 - accuracy500: 0.4056 - val_loss: 3.3522 - val_accuracy500: 0.3492 - 223s/epoch - 33ms/step
Epoch 16/50
6697/6697 - 233s - loss: 3.2198 - accuracy500: 0.4074 - val_loss: 3.3542 - val_accuracy500: 0.3479 - 233s/epoch - 35ms/step
Epoch 17/50
6697/6697 - 237s - loss: 3.2168 - accuracy500: 0.4087 - val_loss: 3.3370 - val_accuracy500: 0.3471 - 237s/epoch - 35ms/step
Epoch 18/50
6697/6697 - 236s - loss: 3.2130 - accuracy500: 0.4110 - val_loss: 3.3315 - val_accuracy500: 0.3465 - 236s/epoch - 35ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 280s - 280s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091626
{'0': {'precision': 0.3346629666327886, 'recall': 0.3115087970593185, 'f1-score': 0.32267104201649044, 'support': 1348803}, '1': {'precision': 0.36942550339157426, 'recall': 0.15635153365097337, 'f1-score': 0.21971383288228827, 'support': 1591529}, '2': {'precision': 0.3260577197556073, 'recall': 0.5672015644700313, 'f1-score': 0.4140801042179715, 'support': 1367364}, 'accuracy': 0.33534701613112905, 'macro avg': {'precision': 0.34338206325999004, 'recall': 0.3450206317267744, 'f1-score': 0.3188216597055834, 'support': 4307696}, 'weighted avg': {'precision': 0.34477488738443945, 'recall': 0.33534701613112905, 'f1-score': 0.31364767472964344, 'support': 4307696}}
[[420164 203361 725278]
 [464909 248838 877782]
 [370411 221382 775571]]
Evaluating performance on  train set...
6697/6697 - 112s - 112s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004319
{'0': {'precision': 0.363332080588195, 'recall': 0.30425597396026227, 'f1-score': 0.33118015008564156, 'support': 575121}, '1': {'precision': 0.3457142596250719, 'recall': 0.20182954783727403, 'f1-score': 0.2548667403414095, 'support': 562762}, '2': {'precision': 0.35765771646495614, 'recall': 0.5611137918704718, 'f1-score': 0.43685873072180276, 'support': 576122}, 'accuracy': 0.3569627859895391, 'macro avg': {'precision': 0.35556801889274103, 'recall': 0.35573310455600266, 'f1-score': 0.34096854038295127, 'support': 1714005}, 'weighted avg': {'precision': 0.355640290792799, 'recall': 0.3569627859895391, 'f1-score': 0.34164538684911827, 'support': 1714005}}
[[174984 106189 293948]
 [162545 113582 286635]
 [144080 108772 323270]]
Evaluating performance on  val set...
2631/2631 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030982
{'0': {'precision': 0.36501809525186374, 'recall': 0.33335093695263746, 'f1-score': 0.34846655119508485, 'support': 227226}, '1': {'precision': 0.3387109662160003, 'recall': 0.18802035050055665, 'f1-score': 0.24181039769307777, 'support': 225449}, '2': {'precision': 0.3452339311066498, 'recall': 0.5334002443311096, 'f1-score': 0.4191684511063526, 'support': 220193}, 'accuracy': 0.35012216363387766, 'macro avg': {'precision': 0.3496543308581712, 'recall': 0.3515905105947679, 'f1-score': 0.33648179999817174, 'support': 672868}, 'weighted avg': {'precision': 0.3497294347870572, 'recall': 0.35012216363387766, 'f1-score': 0.335867557479063, 'support': 672868}}
[[ 75746  41564 109916]
 [ 70220  42389 112840]
 [ 61547  41195 117451]]
testing model out of sample: results/universal/W9/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 150s - 150s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023293
{'0': {'precision': 0.31617778427942256, 'recall': 0.38698272787710947, 'f1-score': 0.3480153943211004, 'support': 681387}, '1': {'precision': 0.4010776879704469, 'recall': 0.17687959626374702, 'f1-score': 0.24549378112816786, 'support': 898012}, '2': {'precision': 0.3157452229299363, 'recall': 0.49033727354592227, 'f1-score': 0.3841335159204791, 'support': 631861}, 'accuracy': 0.33119126651773195, 'macro avg': {'precision': 0.34433356505993523, 'recall': 0.35139986589559297, 'f1-score': 0.32588089712324914, 'support': 2211260}, 'weighted avg': {'precision': 0.35053277359164114, 'recall': 0.33119126651773195, 'f1-score': 0.3167011180827988, 'support': 2211260}}
[[263685 122339 295363]
 [363110 158840 376062]
 [207182 114854 309825]]
Evaluating performance on  train set...
3947/3947 - 68s - 68s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984603
{'0': {'precision': 0.3499386421677556, 'recall': 0.41113542353575927, 'f1-score': 0.3780766638689164, 'support': 333620}, '1': {'precision': 0.3551525294442452, 'recall': 0.18826248721329877, 'f1-score': 0.24608042282130674, 'support': 331399}, '2': {'precision': 0.3719566279890665, 'recall': 0.47708520166357576, 'f1-score': 0.41801239156112563, 'support': 344559}, 'accuracy': 0.36048428155130163, 'macro avg': {'precision': 0.35901593320035574, 'recall': 0.35882770413754456, 'f1-score': 0.34738982608378294, 'support': 1009578}, 'weighted avg': {'precision': 0.3591646476929814, 'recall': 0.36048428155130163, 'f1-score': 0.34837791063832213, 'support': 1009578}}
[[137163  55138 141319]
 [132768  62390 136241]
 [122032  58143 164384]]
Evaluating performance on  val set...
1402/1402 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994909
{'0': {'precision': 0.3419964433398325, 'recall': 0.4092680592116509, 'f1-score': 0.37262034915163234, 'support': 117004}, '1': {'precision': 0.3857283788227557, 'recall': 0.17989490592385118, 'f1-score': 0.24535966708501222, 'support': 123889}, '2': {'precision': 0.3555757772182194, 'recall': 0.48615667794357004, 'f1-score': 0.4107374915854611, 'support': 117349}, 'accuracy': 0.3551314474573054, 'macro avg': {'precision': 0.3611001997936025, 'recall': 0.3584398810263574, 'f1-score': 0.34290583594070184, 'support': 358242}, 'weighted avg': {'precision': 0.36156820490419034, 'recall': 0.3551314474573054, 'f1-score': 0.3410964348895298, 'support': 358242}}
[[47886 16625 52493]
 [50701 22287 50901]
 [41432 18867 57050]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09717
{'0': {'precision': 0.42627986348122865, 'recall': 0.2997462973121229, 'f1-score': 0.35198679495953944, 'support': 29168}, '1': {'precision': 0.30950330175136376, 'recall': 0.19846274221015325, 'f1-score': 0.24184637819344343, 'support': 21727}, '2': {'precision': 0.3448646535717776, 'recall': 0.5766575432002942, 'f1-score': 0.4316093623396677, 'support': 24479}, 'accuracy': 0.360482394459628, 'macro avg': {'precision': 0.36021593960145665, 'recall': 0.35828886090752343, 'f1-score': 0.3418141784975502, 'support': 75374}, 'weighted avg': {'precision': 0.3661773443091239, 'recall': 0.360482394459628, 'f1-score': 0.346096965466892, 'support': 75374}}
[[ 8743  5022 15403]
 [ 6002  4312 11413]
 [ 5765  4598 14116]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023587
{'0': {'precision': 0.3296049711495783, 'recall': 0.22296282952020657, 'f1-score': 0.26599326599326595, 'support': 16653}, '1': {'precision': 0.37673743699404305, 'recall': 0.28864833235810416, 'f1-score': 0.3268619135966075, 'support': 17090}, '2': {'precision': 0.35685468808367576, 'recall': 0.5494650868514898, 'f1-score': 0.43269317872995744, 'support': 17386}, 'accuracy': 0.3559428113203857, 'macro avg': {'precision': 0.35439903207576573, 'recall': 0.35369208290993354, 'f1-score': 0.34184945277327694, 'support': 51129}, 'weighted avg': {'precision': 0.35462516360196583, 'recall': 0.3559428113203857, 'f1-score': 0.3430237158432772, 'support': 51129}}
[[3713 3983 8957]
 [3897 4933 8260]
 [3655 4178 9553]]
Evaluating performance on  val set...
53/53 - 1s - 596ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106009
{'0': {'precision': 0.3192710091123861, 'recall': 0.21422101449275363, 'f1-score': 0.25640330668112216, 'support': 4416}, '1': {'precision': 0.3917841814837523, 'recall': 0.272552783109405, 'f1-score': 0.32146899761036346, 'support': 4689}, '2': {'precision': 0.33714679531357683, 'recall': 0.5590857142857143, 'f1-score': 0.42063628546861564, 'support': 4375}, 'accuracy': 0.3464391691394659, 'macro avg': {'precision': 0.3494006619699051, 'recall': 0.3486198372959577, 'f1-score': 0.33283619658670044, 'support': 13480}, 'weighted avg': {'precision': 0.3502962932280794, 'recall': 0.3464391691394659, 'f1-score': 0.33233893776142603, 'support': 13480}}
[[ 946 1032 2438]
 [1040 1278 2371]
 [ 977  952 2446]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0898299
{'0': {'precision': 0.3576885723535125, 'recall': 0.49201242388146105, 'f1-score': 0.41423329443686824, 'support': 89827}, '1': {'precision': 0.3680867841691354, 'recall': 0.3452853387179, 'f1-score': 0.35632166122518455, 'support': 100039}, '2': {'precision': 0.40733037597265653, 'recall': 0.29084753507596767, 'f1-score': 0.33937205385165353, 'support': 96291}, 'accuracy': 0.3730259962188589, 'macro avg': {'precision': 0.37770191083176813, 'recall': 0.37604843255844295, 'f1-score': 0.36997566983790214, 'support': 286157}, 'weighted avg': {'precision': 0.3780280560079892, 'recall': 0.3730259962188589, 'f1-score': 0.36879709825066787, 'support': 286157}}
[[44196 25728 19903]
 [44651 34542 20846]
 [34713 33572 28006]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094839
{'0': {'precision': 0.4120323199772528, 'recall': 0.3713218022635063, 'f1-score': 0.3906192086080442, 'support': 46830}, '1': {'precision': 0.33438368284618847, 'recall': 0.5285602119933261, 'f1-score': 0.40962549558371913, 'support': 40756}, '2': {'precision': 0.3947147093975477, 'recall': 0.2141913477937114, 'f1-score': 0.2776930023979322, 'support': 41631}, 'accuracy': 0.37029183466571736, 'macro avg': {'precision': 0.3803769040736629, 'recall': 0.37135778735018127, 'f1-score': 0.3593125688632319, 'support': 129217}, 'weighted avg': {'precision': 0.38196199408393106, 'recall': 0.37029183466571736, 'f1-score': 0.3602314836279521, 'support': 129217}}
[[17389 21973  7468]
 [13008 21542  6206]
 [11806 20908  8917]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011187
{'0': {'precision': 0.3909675602084409, 'recall': 0.5050333535476046, 'f1-score': 0.44073985869651505, 'support': 16490}, '1': {'precision': 0.3318394582212927, 'recall': 0.4400132056784417, 'f1-score': 0.37834615493797374, 'support': 15145}, '2': {'precision': 0.40948678071539657, 'recall': 0.16275188527630116, 'f1-score': 0.23292639773531498, 'support': 16178}, 'accuracy': 0.36862359609311274, 'macro avg': {'precision': 0.3774312663817101, 'recall': 0.3692661481674491, 'f1-score': 0.35067080378993465, 'support': 47813}, 'weighted avg': {'precision': 0.37850460755468923, 'recall': 0.36862359609311274, 'f1-score': 0.3506606163387169, 'support': 47813}}
[[8328 6101 2061]
 [6745 6664 1736]
 [6228 7317 2633]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995303
{'0': {'precision': 0.3139071038251366, 'recall': 0.2792862872839536, 'f1-score': 0.29558640029844213, 'support': 41137}, '1': {'precision': 0.3791587516960651, 'recall': 0.15824046389417415, 'f1-score': 0.2232911958832084, 'support': 44148}, '2': {'precision': 0.36021059946013845, 'recall': 0.6047471620227038, 'f1-score': 0.45149403725043546, 'support': 44574}, 'accuracy': 0.34984868203205016, 'macro avg': {'precision': 0.35109215166044666, 'recall': 0.34742463773361054, 'f1-score': 0.32345721114402864, 'support': 129859}, 'weighted avg': {'precision': 0.35198426262537624, 'recall': 0.34984868203205016, 'f1-score': 0.3245234653072164, 'support': 129859}}
[[11489  5646 24002]
 [13286  6986 23876]
 [11825  5793 26956]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038517
{'0': {'precision': 0.33639188270705894, 'recall': 0.3062676803394625, 'f1-score': 0.32062375642034147, 'support': 22624}, '1': {'precision': 0.3665578453376862, 'recall': 0.16252770615642104, 'f1-score': 0.22520292080604215, 'support': 22107}, '2': {'precision': 0.3552682044819462, 'recall': 0.5849082134319606, 'f1-score': 0.44204318851942115, 'support': 22171}, 'accuracy': 0.35111057965382203, 'macro avg': {'precision': 0.3527393108422305, 'recall': 0.3512345333092814, 'f1-score': 0.32928995524860155, 'support': 66902}, 'weighted avg': {'precision': 0.35261540167429906, 'recall': 0.35111057965382203, 'f1-score': 0.32933084763052023, 'support': 66902}}
[[ 6929  3399 12296]
 [ 7276  3593 11238]
 [ 6393  2810 12968]]
Evaluating performance on  val set...
73/73 - 1s - 707ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046828
{'0': {'precision': 0.36003156441112644, 'recall': 0.2880820836621942, 'f1-score': 0.320063135741845, 'support': 6335}, '1': {'precision': 0.36955457660303476, 'recall': 0.11908517350157728, 'f1-score': 0.18012644637957773, 'support': 6340}, '2': {'precision': 0.3310518107780281, 'recall': 0.639070078608463, 'f1-score': 0.43616231950231155, 'support': 5979}, 'accuracy': 0.3431435617025839, 'macro avg': {'precision': 0.3535459839307298, 'recall': 0.34874577859074485, 'f1-score': 0.31211730054124476, 'support': 18654}, 'weighted avg': {'precision': 0.3539795621769892, 'recall': 0.3431435617025839, 'f1-score': 0.30971459972528315, 'support': 18654}}
[[1825  601 3909]
 [1773  755 3812]
 [1471  687 3821]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013123
{'0': {'precision': 0.29159916685952325, 'recall': 0.10987094523892571, 'f1-score': 0.15960478814364432, 'support': 45872}, '1': {'precision': 0.36003568005112363, 'recall': 0.46329512943071044, 'f1-score': 0.4051901740296517, 'support': 58371}, '2': {'precision': 0.32952786377708976, 'recall': 0.40734318005142617, 'f1-score': 0.3643267816553014, 'support': 50169}, 'accuracy': 0.34012252933709813, 'macro avg': {'precision': 0.32705423689591223, 'recall': 0.3268364182403541, 'f1-score': 0.3097072479428658, 'support': 154412}, 'weighted avg': {'precision': 0.3297927820394594, 'recall': 0.34012252933709813, 'f1-score': 0.31895614847858245, 'support': 154412}}
[[ 5040 23873 16959]
 [ 6707 27043 24621]
 [ 5537 24196 20436]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041739
{'0': {'precision': 0.3512171490856243, 'recall': 0.10228555304740407, 'f1-score': 0.15843098691578575, 'support': 28352}, '1': {'precision': 0.32215172786177104, 'recall': 0.525313669381466, 'f1-score': 0.3993808049535603, 'support': 27258}, '2': {'precision': 0.32004677581022384, 'recall': 0.3544495837187789, 'f1-score': 0.33637081906768496, 'support': 27025}, 'accuracy': 0.32429358020209353, 'macro avg': {'precision': 0.3311385509192064, 'recall': 0.3273496020492163, 'f1-score': 0.2980608703123437, 'support': 82635}, 'weighted avg': {'precision': 0.33143564500760053, 'recall': 0.32429358020209353, 'f1-score': 0.2961042985147297, 'support': 82635}}
[[ 2900 15270 10182]
 [ 2770 14319 10169]
 [ 2587 14859  9579]]
Evaluating performance on  val set...
112/112 - 1s - 982ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1059656
{'0': {'precision': 0.33827893175074186, 'recall': 0.09437086092715231, 'f1-score': 0.14757281553398058, 'support': 9664}, '1': {'precision': 0.3098528470889315, 'recall': 0.5278474114441417, 'f1-score': 0.39048578915541216, 'support': 9175}, '2': {'precision': 0.32047477744807124, 'recall': 0.33760550171928727, 'f1-score': 0.32881717156340384, 'support': 9597}, 'accuracy': 0.31632437754958503, 'macro avg': {'precision': 0.32286885209591487, 'recall': 0.31994125803019374, 'f1-score': 0.2889585920842655, 'support': 28436}, 'weighted avg': {'precision': 0.32309832281788076, 'recall': 0.31632437754958503, 'f1-score': 0.2871187649569307, 'support': 28436}}
[[ 912 5322 3430]
 [ 892 4843 3440]
 [ 892 5465 3240]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108647
{'0': {'precision': 0.37683412086545637, 'recall': 0.20027425776926, 'f1-score': 0.26154593020119743, 'support': 60527}, '1': {'precision': 0.2872542802790108, 'recall': 0.06502081240132052, 'f1-score': 0.10603932584269664, 'support': 48769}, '2': {'precision': 0.32524703431808366, 'recall': 0.7385218795662539, 'f1-score': 0.45160569738938233, 'support': 52012}, 'accuracy': 0.3329345103776626, 'macro avg': {'precision': 0.32977847848751696, 'recall': 0.3346056499122782, 'f1-score': 0.2730636511444255, 'support': 161308}, 'weighted avg': {'precision': 0.3331173381202589, 'recall': 0.3329345103776626, 'f1-score': 0.27581358600892025, 'support': 161308}}
[[12122  4640 43765]
 [ 9674  3171 35924]
 [10372  3228 38412]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077722
{'0': {'precision': 0.3133694958519464, 'recall': 0.24718733482670963, 'f1-score': 0.2763715158081355, 'support': 39731}, '1': {'precision': 0.314187874542766, 'recall': 0.1002956448286999, 'f1-score': 0.1520527306967985, 'support': 40251}, '2': {'precision': 0.35354120038074655, 'recall': 0.655200362344752, 'f1-score': 0.4592659431369108, 'support': 41949}, 'accuracy': 0.3390688176099597, 'macro avg': {'precision': 0.327032856925153, 'recall': 0.3342277806667205, 'f1-score': 0.29589672988061494, 'support': 121931}, 'weighted avg': {'precision': 0.3274602799344423, 'recall': 0.3390688176099597, 'f1-score': 0.2982550639829095, 'support': 121931}}
[[ 9821  4264 25646]
 [11603  4037 24611]
 [ 9916  4548 27485]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068588
{'0': {'precision': 0.31740417238143365, 'recall': 0.27896206065220147, 'f1-score': 0.29694411615735267, 'support': 15762}, '1': {'precision': 0.3649805447470817, 'recall': 0.0879869926833844, 'f1-score': 0.1417917968356344, 'support': 15991}, '2': {'precision': 0.3386704151952549, 'recall': 0.6532204734823436, 'f1-score': 0.4460701302806566, 'support': 15122}, 'accuracy': 0.3345493333333333, 'macro avg': {'precision': 0.3403517107745901, 'recall': 0.3400565089393098, 'f1-score': 0.29493534775788127, 'support': 46875}, 'weighted avg': {'precision': 0.3404949861271335, 'recall': 0.3345493333333333, 'f1-score': 0.29212369689973144, 'support': 46875}}
[[ 4397  1282 10083]
 [ 5378  1407  9206]
 [ 4078  1166  9878]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
2354/2354 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0876907
{'0': {'precision': 0.3874764846112249, 'recall': 0.5189951542973731, 'f1-score': 0.44369489189872746, 'support': 196050}, '1': {'precision': 0.3617430859554295, 'recall': 0.2531230525861656, 'f1-score': 0.2978388576940107, 'support': 208610}, '2': {'precision': 0.3922566131969848, 'recall': 0.3845095639331991, 'f1-score': 0.38834445610782065, 'support': 197722}, 'accuracy': 0.38277870188684254, 'macro avg': {'precision': 0.38049206125454643, 'recall': 0.38554259027224597, 'f1-score': 0.37662606856685293, 'support': 602382}, 'weighted avg': {'precision': 0.38013378893082295, 'recall': 0.38277870188684254, 'f1-score': 0.3750158374766238, 'support': 602382}}
[[101749  42610  51691]
 [ 89706  52804  66100]
 [ 71139  50557  76026]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860167
{'0': {'precision': 0.3929651756991268, 'recall': 0.5423802626222463, 'f1-score': 0.4557386960257104, 'support': 105627}, '1': {'precision': 0.34362142522565864, 'recall': 0.25723573229212077, 'f1-score': 0.2942187101984185, 'support': 105518}, '2': {'precision': 0.41780987521944346, 'recall': 0.36543094095364187, 'f1-score': 0.3898689973465954, 'support': 108762}, 'accuracy': 0.38816906163353726, 'macro avg': {'precision': 0.38479882538140964, 'recall': 0.38834897862266965, 'f1-score': 0.3799421345235747, 'support': 319907}, 'weighted avg': {'precision': 0.3851363546566653, 'recall': 0.38816906163353726, 'f1-score': 0.38006862305993566, 'support': 319907}}
[[57290 23901 24436]
 [47429 27143 30946]
 [41070 27947 39745]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0866517
{'0': {'precision': 0.3892749244712991, 'recall': 0.5420825055510109, 'f1-score': 0.45314316416744, 'support': 42785}, '1': {'precision': 0.36024699599465954, 'recall': 0.25236157875046766, 'f1-score': 0.2968045319546805, 'support': 42768}, '2': {'precision': 0.40332802934275463, 'recall': 0.3641698728875469, 'f1-score': 0.3827500159959051, 'support': 41066}, 'accuracy': 0.386521770034513, 'macro avg': {'precision': 0.38428331660290443, 'recall': 0.38620465239634183, 'f1-score': 0.3775659040393419, 'support': 126619}, 'weighted avg': {'precision': 0.3840279896476334, 'recall': 0.386521770034513, 'f1-score': 0.3775063668045833, 'support': 126619}}
[[23193  9314 10278]
 [20129 10793 11846]
 [16258  9853 14955]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
3870/3870 - 33s - 33s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975348
{'0': {'precision': 0.3757862125459539, 'recall': 0.3920250750328962, 'f1-score': 0.3837339214800921, 'support': 338185}, '1': {'precision': 0.3474927821314128, 'recall': 0.26018131122520183, 'f1-score': 0.29756452902851144, 'support': 336769}, '2': {'precision': 0.3481997267639152, 'recall': 0.4253984240397284, 'f1-score': 0.3829471796502022, 'support': 315744}, 'accuracy': 0.3578436617415196, 'macro avg': {'precision': 0.3571595738137607, 'recall': 0.3592016034326088, 'f1-score': 0.35474854338626854, 'support': 990698}, 'weighted avg': {'precision': 0.35737634633643434, 'recall': 0.3578436617415196, 'f1-score': 0.3541915290064391, 'support': 990698}}
[[132577  85370 120238]
 [117956  87621 131192]
 [102266  79161 134317]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955601
{'0': {'precision': 0.37097375948265143, 'recall': 0.5002916769968936, 'f1-score': 0.42603568667509106, 'support': 137138}, '1': {'precision': 0.3487377569319906, 'recall': 0.2673960017528219, 'f1-score': 0.30269752484562357, 'support': 132358}, '2': {'precision': 0.3793356735934951, 'recall': 0.33140567403405613, 'f1-score': 0.35375455504888587, 'support': 134014}, 'accuracy': 0.3678074892815544, 'macro avg': {'precision': 0.3663490633360457, 'recall': 0.36636445092792386, 'f1-score': 0.36082925552320017, 'support': 403510}, 'weighted avg': {'precision': 0.3664571446082995, 'recall': 0.3678074892815544, 'f1-score': 0.36157265974346875, 'support': 403510}}
[[68609 32152 36377]
 [60675 35392 36291]
 [55659 33942 44413]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945208
{'0': {'precision': 0.3621470795518288, 'recall': 0.5026952563488261, 'f1-score': 0.4210007106132174, 'support': 50088}, '1': {'precision': 0.36884509649146685, 'recall': 0.26195124780112505, 'f1-score': 0.3063411325873177, 'support': 51731}, '2': {'precision': 0.38667768735164465, 'recall': 0.3533729736011311, 'f1-score': 0.3692759196478268, 'support': 51631}, 'accuracy': 0.37129358097100035, 'macro avg': {'precision': 0.3725566211316467, 'recall': 0.3726731592503607, 'f1-score': 0.36553925428278733, 'support': 153450}, 'weighted avg': {'precision': 0.37265887444017487, 'recall': 0.37129358097100035, 'f1-score': 0.3649429894454631, 'support': 153450}}
[[25179 10477 14432]
 [23673 13551 14507]
 [20675 12711 18245]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039201
{'0': {'precision': 0.36311520573030615, 'recall': 0.40344898988080236, 'f1-score': 0.38222099023412515, 'support': 222152}, '1': {'precision': 0.31783082486709274, 'recall': 0.20876302234207283, 'f1-score': 0.2520018946076795, 'support': 189866}, '2': {'precision': 0.3476673364555398, 'recall': 0.4130260120841712, 'f1-score': 0.37753886972671796, 'support': 215323}, 'accuracy': 0.3478140277775564, 'macro avg': {'precision': 0.34287112235097955, 'recall': 0.34174600810234884, 'f1-score': 0.33725391818950756, 'support': 627341}, 'weighted avg': {'precision': 0.34410760729050166, 'recall': 0.3478140277775564, 'f1-score': 0.34120287242542596, 'support': 627341}}
[[89627 41760 90765]
 [74126 39637 76103]
 [83075 43314 88934]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0948141
{'0': {'precision': 0.36155902161107106, 'recall': 0.3917595503477184, 'f1-score': 0.3760539166377087, 'support': 104970}, '1': {'precision': 0.37179586824392596, 'recall': 0.2382508217949995, 'f1-score': 0.2904062020021734, 'support': 100390}, '2': {'precision': 0.3686552010106725, 'recall': 0.4675519993708961, 'f1-score': 0.4122554224177158, 'support': 101732}, 'accuracy': 0.3666849022442786, 'macro avg': {'precision': 0.3673366969552232, 'recall': 0.36585412383787136, 'f1-score': 0.3595718470191993, 'support': 307092}, 'weighted avg': {'precision': 0.3672562900392703, 'recall': 0.3666849022442786, 'f1-score': 0.3600478908009897, 'support': 307092}}
[[41123 19872 43975]
 [38989 23918 37483]
 [33626 20541 47565]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951473
{'0': {'precision': 0.37098117963726474, 'recall': 0.4348348649122368, 'f1-score': 0.40037810669986623, 'support': 39937}, '1': {'precision': 0.35117832622007794, 'recall': 0.2119320249727036, 'f1-score': 0.26433871671759057, 'support': 35719}, '2': {'precision': 0.37313769242905764, 'recall': 0.446491180754086, 'f1-score': 0.406532015470563, 'support': 37078}, 'accuracy': 0.3680433587027871, 'macro avg': {'precision': 0.3650990660954668, 'recall': 0.3644193568796754, 'f1-score': 0.35708294629600656, 'support': 112734}, 'weighted avg': {'precision': 0.365416053411686, 'recall': 0.3680433587027871, 'f1-score': 0.3592989616205023, 'support': 112734}}
[[17366  7304 15267]
 [15604  7570 12545]
 [13841  6682 16555]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
3337/3337 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1076232
{'0': {'precision': 0.25142029177414876, 'recall': 0.4649102980646984, 'f1-score': 0.3263517835097038, 'support': 212370}, '1': {'precision': 0.562761965590196, 'recall': 0.12626763606725497, 'f1-score': 0.20625709807736972, 'support': 446599}, '2': {'precision': 0.26511702610795423, 'recall': 0.490833213707114, 'f1-score': 0.3442772687389422, 'support': 195052}, 'accuracy': 0.29374219135126656, 'macro avg': {'precision': 0.3597664278240997, 'recall': 0.3606703826130225, 'f1-score': 0.29229538344200523, 'support': 854021}, 'weighted avg': {'precision': 0.41736053868827655, 'recall': 0.29374219135126656, 'f1-score': 0.26764390082946343, 'support': 854021}}
[[ 98733  21848  91789]
 [216619  56391 173589]
 [ 77349  21965  95738]]
Evaluating performance on  train set...
1431/1431 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974967
{'0': {'precision': 0.33068577532984644, 'recall': 0.4058004324361135, 'f1-score': 0.3644126100782779, 'support': 117474}, '1': {'precision': 0.375399110180581, 'recall': 0.11994013027518333, 'f1-score': 0.18179629031133757, 'support': 119593}, '2': {'precision': 0.37828320761083717, 'recall': 0.5386356062895714, 'f1-score': 0.4444380501123804, 'support': 129039}, 'accuracy': 0.35924022004556055, 'macro avg': {'precision': 0.3614560310404215, 'recall': 0.3547920563336227, 'f1-score': 0.33021565016733195, 'support': 366106}, 'weighted avg': {'precision': 0.3620682900084113, 'recall': 0.35924022004556055, 'f1-score': 0.3329648032318259, 'support': 366106}}
[[47671 11163 58640]
 [49656 14344 55593]
 [46831 12703 69505]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013784
{'0': {'precision': 0.320110893400592, 'recall': 0.3800955374600896, 'f1-score': 0.34753386061984454, 'support': 40403}, '1': {'precision': 0.4339114329011618, 'recall': 0.11418317160707164, 'f1-score': 0.1807913568121229, 'support': 45138}, '2': {'precision': 0.3465592816732645, 'recall': 0.5677898712787635, 'f1-score': 0.43041074472794405, 'support': 40242}, 'accuracy': 0.34472066972484355, 'macro avg': {'precision': 0.3668605359916728, 'recall': 0.3540228601153082, 'f1-score': 0.3195786540533038, 'support': 125783}, 'weighted avg': {'precision': 0.3694105983912951, 'recall': 0.34472066972484355, 'f1-score': 0.3142122546270252, 'support': 125783}}
[[15357  3233 21813]
 [18715  5154 21269]
 [13902  3491 22849]]
testing model on single stock: results/universal/W9/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
10303/10303 - 88s - 88s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179332
{'0': {'precision': 0.29692234119833266, 'recall': 0.22573474466034807, 'f1-score': 0.2564805517339956, 'support': 794902}, '1': {'precision': 0.4061942216870351, 'recall': 0.09193992517225748, 'f1-score': 0.14994140266340067, 'support': 1034643}, '2': {'precision': 0.31248961167828027, 'recall': 0.695834297816822, 'f1-score': 0.43129194392719844, 'support': 807859}, 'accuracy': 0.31724301623869533, 'macro avg': {'precision': 0.338535391521216, 'recall': 0.33783632254980916, 'f1-score': 0.27923796610819823, 'support': 2637404}, 'weighted avg': {'precision': 0.34455764690315926, 'recall': 0.31724301623869533, 'f1-score': 0.268231869193877, 'support': 2637404}}
[[179437  69101 546364]
 [249123  95125 690395]
 [175763  69960 562136]]
Evaluating performance on  train set...
3419/3419 - 32s - 32s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081878
{'0': {'precision': 0.3274363550744438, 'recall': 0.19465545962908945, 'f1-score': 0.24416117012860056, 'support': 289342}, '1': {'precision': 0.3477477714375871, 'recall': 0.09156972718460048, 'f1-score': 0.1449665385943469, 'support': 288840}, '2': {'precision': 0.34703956548293935, 'recall': 0.7328098271890953, 'f1-score': 0.4710175432521083, 'support': 296972}, 'accuracy': 0.343248159752455, 'macro avg': {'precision': 0.34074123066499, 'recall': 0.33967833800092845, 'f1-score': 0.28671508399168527, 'support': 875154}, 'weighted avg': {'precision': 0.3407921234349404, 'recall': 0.343248159752455, 'f1-score': 0.2884032274886543, 'support': 875154}}
[[ 56322  25162 207858]
 [ 60786  26449 201605]
 [ 54901  24447 217624]]
Evaluating performance on  val set...
1396/1396 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1114688
{'0': {'precision': 0.3365279867199253, 'recall': 0.21925644275454162, 'f1-score': 0.2655199582519006, 'support': 118350}, '1': {'precision': 0.3308090768057637, 'recall': 0.10258312812902595, 'f1-score': 0.15660378532796426, 'support': 122642}, '2': {'precision': 0.3304216382311762, 'recall': 0.688064399607823, 'f1-score': 0.44644964718290403, 'support': 116274}, 'accuracy': 0.33178080197947746, 'macro avg': {'precision': 0.3325862339189551, 'recall': 0.3366346568304635, 'f1-score': 0.2895244635875896, 'support': 357266}, 'weighted avg': {'precision': 0.3325774621419542, 'recall': 0.33178080197947746, 'f1-score': 0.2870157663361462, 'support': 357266}}
[[25949 13508 78893]
 [26831 12581 83230]
 [24328 11942 80004]]
training model: results/universal/W9/deepVOL_L2/h1000
Epoch 1/50
6697/6697 - 224s - loss: 3.2756 - accuracy1000: 0.3683 - val_loss: 3.3077 - val_accuracy1000: 0.3490 - 224s/epoch - 33ms/step
Epoch 2/50
6697/6697 - 223s - loss: 3.2766 - accuracy1000: 0.3672 - val_loss: 3.2992 - val_accuracy1000: 0.3494 - 223s/epoch - 33ms/step
Epoch 3/50
6697/6697 - 222s - loss: 3.2758 - accuracy1000: 0.3662 - val_loss: 3.3016 - val_accuracy1000: 0.3525 - 222s/epoch - 33ms/step
Epoch 4/50
6697/6697 - 220s - loss: 3.2752 - accuracy1000: 0.3667 - val_loss: 3.3089 - val_accuracy1000: 0.3524 - 220s/epoch - 33ms/step
Epoch 5/50
6697/6697 - 222s - loss: 3.2717 - accuracy1000: 0.3707 - val_loss: 3.3185 - val_accuracy1000: 0.3517 - 222s/epoch - 33ms/step
Epoch 6/50
6697/6697 - 221s - loss: 3.2661 - accuracy1000: 0.3785 - val_loss: 3.3136 - val_accuracy1000: 0.3564 - 221s/epoch - 33ms/step
Epoch 7/50
6697/6697 - 221s - loss: 3.2619 - accuracy1000: 0.3830 - val_loss: 3.3189 - val_accuracy1000: 0.3556 - 221s/epoch - 33ms/step
Epoch 8/50
6697/6697 - 221s - loss: 3.2606 - accuracy1000: 0.3831 - val_loss: 3.3358 - val_accuracy1000: 0.3552 - 221s/epoch - 33ms/step
Epoch 9/50
6697/6697 - 225s - loss: 3.2570 - accuracy1000: 0.3863 - val_loss: 3.3145 - val_accuracy1000: 0.3537 - 225s/epoch - 34ms/step
Epoch 10/50
6697/6697 - 222s - loss: 3.2583 - accuracy1000: 0.3861 - val_loss: 3.3146 - val_accuracy1000: 0.3517 - 222s/epoch - 33ms/step
Epoch 11/50
6697/6697 - 220s - loss: 3.2534 - accuracy1000: 0.3887 - val_loss: 3.3318 - val_accuracy1000: 0.3551 - 220s/epoch - 33ms/step
Epoch 12/50
6697/6697 - 222s - loss: 3.2499 - accuracy1000: 0.3921 - val_loss: 3.3405 - val_accuracy1000: 0.3528 - 222s/epoch - 33ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 268s - 268s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0932451
{'0': {'precision': 0.30369013139955636, 'recall': 0.2620040865990229, 'f1-score': 0.2813111852830634, 'support': 1258259}, '1': {'precision': 0.4181287874052178, 'recall': 0.6341328691892579, 'f1-score': 0.5039605995072005, 'support': 1761522}, '2': {'precision': 0.30582438756848934, 'recall': 0.13075164121855867, 'f1-score': 0.1831847740717131, 'support': 1287915}, 'accuracy': 0.3749347679130561, 'macro avg': {'precision': 0.34254776879108784, 'recall': 0.34229619900227987, 'f1-score': 0.3228188529539923, 'support': 4307696}, 'weighted avg': {'precision': 0.35112499001962055, 'recall': 0.3749347679130561, 'f1-score': 0.34302012773110624, 'support': 4307696}}
[[ 329669  763946  164644]
 [ 426891 1117039  217592]
 [ 328984  790534  168397]]
Evaluating performance on  train set...
6697/6697 - 111s - 111s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053509
{'0': {'precision': 0.3390939753071139, 'recall': 0.22893682658342662, 'f1-score': 0.2733341162556498, 'support': 574403}, '1': {'precision': 0.3364085268223549, 'recall': 0.6636454847722877, 'f1-score': 0.4464878842064911, 'support': 565121}, '2': {'precision': 0.34374497317449354, 'recall': 0.12647241597198167, 'f1-score': 0.184911312252894, 'support': 574481}, 'accuracy': 0.3379208345366554, 'macro avg': {'precision': 0.3397491584346541, 'recall': 0.339684909109232, 'f1-score': 0.30157777090501164, 'support': 1714005}, 'weighted avg': {'precision': 0.33976743108623625, 'recall': 0.3379208345366554, 'f1-score': 0.3007877174014109, 'support': 1714005}}
[[131502 371359  71542]
 [122913 375040  67168]
 [133389 368436  72656]]
Evaluating performance on  val set...
2631/2631 - 42s - 42s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999624
{'0': {'precision': 0.326607460035524, 'recall': 0.22852868867276474, 'f1-score': 0.2689040327362356, 'support': 221272}, '1': {'precision': 0.3584124193959707, 'recall': 0.6698711401627345, 'f1-score': 0.46697262403436535, 'support': 234984}, '2': {'precision': 0.3391876640586363, 'recall': 0.12348346352002659, 'f1-score': 0.1810533013392177, 'support': 216612}, 'accuracy': 0.3488410802713162, 'macro avg': {'precision': 0.34140251449671033, 'recall': 0.34062776411850865, 'f1-score': 0.30564331936993955, 'support': 672868}, 'weighted avg': {'precision': 0.3417644889389785, 'recall': 0.3488410802713162, 'f1-score': 0.3097938168071513, 'support': 672868}}
[[ 50567 144867  25838]
 [ 51302 157409  26273]
 [ 52956 136908  26748]]
testing model out of sample: results/universal/W9/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 138s - 138s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0861675
{'0': {'precision': 0.328564237452764, 'recall': 0.20506780576017086, 'f1-score': 0.252525867150059, 'support': 677966}, '1': {'precision': 0.4354905348072747, 'recall': 0.72531997798001, 'f1-score': 0.544223164138069, 'support': 930064}, '2': {'precision': 0.2874495451218237, 'recall': 0.11392337914228404, 'f1-score': 0.1631760466814277, 'support': 603230}, 'accuracy': 0.3990236335844722, 'macro avg': {'precision': 0.35050143912728743, 'recall': 0.3481037209608216, 'f1-score': 0.3199750259898519, 'support': 2211260}, 'weighted avg': {'precision': 0.3623217711520723, 'recall': 0.3990236335844722, 'f1-score': 0.35084025018261245, 'support': 2211260}}
[[139029 465857  73080]
 [158197 674594  97273]
 [125915 408593  68722]]
Evaluating performance on  train set...
3947/3947 - 66s - 66s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010867
{'0': {'precision': 0.33623801381847995, 'recall': 0.2052403345855369, 'f1-score': 0.2548933033421702, 'support': 327689}, '1': {'precision': 0.35296768342435725, 'recall': 0.7235605572731961, 'f1-score': 0.47447616154030625, 'support': 343171}, '2': {'precision': 0.35644525726352305, 'recall': 0.11162973328845825, 'f1-score': 0.17001501812066655, 'support': 338718}, 'accuracy': 0.350018522590627, 'macro avg': {'precision': 0.3485503181687868, 'recall': 0.3468102083823971, 'f1-score': 0.2997948276677143, 'support': 1009578}, 'weighted avg': {'precision': 0.34870430620355236, 'recall': 0.350018522590627, 'f1-score': 0.3010558247293788, 'support': 1009578}}
[[ 67255 226110  34324]
 [ 60923 248305  33943]
 [ 71844 229063  37811]]
Evaluating performance on  val set...
1402/1402 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016052
{'0': {'precision': 0.36513005267611015, 'recall': 0.22350867520403644, 'f1-score': 0.27728292579292907, 'support': 119709}, '1': {'precision': 0.3409087224383917, 'recall': 0.7188987751822696, 'f1-score': 0.462496941303266, 'support': 116997}, '2': {'precision': 0.34334797615312207, 'recall': 0.1080420616113744, 'f1-score': 0.16436349981224183, 'support': 121536}, 'accuracy': 0.3461235701006582, 'macro avg': {'precision': 0.3497955837558746, 'recall': 0.35014983733256017, 'f1-score': 0.3013811223028123, 'support': 358242}, 'weighted avg': {'precision': 0.34982997779343245, 'recall': 0.3461235701006582, 'f1-score': 0.2994626501599047, 'support': 358242}}
[[26756 79319 13634]
 [21409 84109 11479]
 [25113 83292 13131]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1114513
{'0': {'precision': 0.4144432586268232, 'recall': 0.15734737979470556, 'f1-score': 0.22809593734703867, 'support': 29616}, '1': {'precision': 0.3105433127520372, 'recall': 0.8071938065414057, 'f1-score': 0.4485287898012205, 'support': 22992}, '2': {'precision': 0.28280283947790247, 'recall': 0.054247562154089435, 'f1-score': 0.0910330593741938, 'support': 22766}, 'accuracy': 0.3244354817311009, 'macro avg': {'precision': 0.33592980361892094, 'recall': 0.33959624949673356, 'f1-score': 0.2558859288408177, 'support': 75374}, 'weighted avg': {'precision': 0.34298899936106303, 'recall': 0.3244354817311009, 'f1-score': 0.2539379871745225, 'support': 75374}}
[[ 4660 23076  1880]
 [ 3181 18559  1252]
 [ 3403 18128  1235]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1098125
{'0': {'precision': 0.32113037893384716, 'recall': 0.12185462742947663, 'f1-score': 0.17667064175610617, 'support': 16413}, '1': {'precision': 0.3292460646230323, 'recall': 0.8464581304771178, 'f1-score': 0.47408695059392947, 'support': 16432}, '2': {'precision': 0.3870481927710843, 'recall': 0.05622402100196894, 'f1-score': 0.09818529130850048, 'support': 18284}, 'accuracy': 0.33126014590545483, 'macro avg': {'precision': 0.3458082121093213, 'recall': 0.34151225963618775, 'f1-score': 0.2496476278861787, 'support': 51129}, 'weighted avg': {'precision': 0.34731118152033885, 'recall': 0.33126014590545483, 'f1-score': 0.24418846215625264, 'support': 51129}}
[[ 2000 13511   902]
 [ 1797 13909   726]
 [ 2431 14825  1028]]
Evaluating performance on  val set...
53/53 - 1s - 528ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014367
{'0': {'precision': 0.3161397670549085, 'recall': 0.13345820650901427, 'f1-score': 0.18768521567336188, 'support': 4271}, '1': {'precision': 0.34942084942084944, 'recall': 0.8302752293577982, 'f1-score': 0.4918478260869565, 'support': 4578}, '2': {'precision': 0.3704630788485607, 'recall': 0.06391708054415893, 'f1-score': 0.10902394106813995, 'support': 4631}, 'accuracy': 0.3462166172106825, 'macro avg': {'precision': 0.3453412317747729, 'recall': 0.3425501721369905, 'f1-score': 0.2628523276094861, 'support': 13480}, 'weighted avg': {'precision': 0.3461050528106712, 'recall': 0.3462166172106825, 'f1-score': 0.2639594046775647, 'support': 13480}}
[[ 570 3449  252]
 [ 526 3801  251]
 [ 707 3628  296]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095324
{'0': {'precision': 0.37834676371198334, 'recall': 0.06367504074021414, 'f1-score': 0.10900478370357888, 'support': 91433}, '1': {'precision': 0.34114700726270974, 'recall': 0.9308949072711216, 'f1-score': 0.49931060928605064, 'support': 95116}, '2': {'precision': 0.40172843905915895, 'recall': 0.04526744839771906, 'f1-score': 0.08136639237765267, 'support': 99608}, 'accuracy': 0.3455236111645006, 'macro avg': {'precision': 0.37374073667795066, 'recall': 0.34661246546968494, 'f1-score': 0.22989392845576073, 'support': 286157}, 'weighted avg': {'precision': 0.3741207964407035, 'recall': 0.3455236111645006, 'f1-score': 0.22911830188733645, 'support': 286157}}
[[ 5822 81630  3981]
 [ 3839 88543  2734]
 [ 5727 89372  4509]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233965
{'0': {'precision': 0.3792255685310387, 'recall': 0.04013008130081301, 'f1-score': 0.07257969650629338, 'support': 46125}, '1': {'precision': 0.3304681994723128, 'recall': 0.9508216045453474, 'f1-score': 0.4904687490499152, 'support': 42417}, '2': {'precision': 0.33129904097646035, 'recall': 0.018684695759065766, 'f1-score': 0.035374339640205726, 'support': 40675}, 'accuracy': 0.33232469411919485, 'macro avg': {'precision': 0.3469976029932706, 'recall': 0.33654546053507534, 'f1-score': 0.19947426173213811, 'support': 129217}, 'weighted avg': {'precision': 0.3481340493683399, 'recall': 0.33232469411919485, 'f1-score': 0.19804516971194505, 'support': 129217}}
[[ 1851 43367   907]
 [ 1459 40331   627]
 [ 1571 38344   760]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1259521
{'0': {'precision': 0.3333333333333333, 'recall': 0.03345317165315947, 'f1-score': 0.06080407575589766, 'support': 16411}, '1': {'precision': 0.3289108299907436, 'recall': 0.9536711610965557, 'f1-score': 0.4891270504563853, 'support': 15649}, '2': {'precision': 0.398989898989899, 'recall': 0.020059671173744683, 'f1-score': 0.03819885161680266, 'support': 15753}, 'accuracy': 0.33022399765754085, 'macro avg': {'precision': 0.353744687437992, 'recall': 0.33572800130781993, 'f1-score': 0.19604332594302856, 'support': 47813}, 'weighted avg': {'precision': 0.35351780458549686, 'recall': 0.33022399765754085, 'f1-score': 0.1935446721465188, 'support': 47813}}
[[  549 15597   265]
 [  514 14924   211]
 [  584 14853   316]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030018
{'0': {'precision': 0.3200152602920265, 'recall': 0.22071522545150102, 'f1-score': 0.26124748718819896, 'support': 41805}, '1': {'precision': 0.31677003929738173, 'recall': 0.6817649156773832, 'f1-score': 0.43255911684365356, 'support': 39254}, '2': {'precision': 0.39590134203844757, 'recall': 0.13420081967213116, 'f1-score': 0.20045300113250283, 'support': 48800}, 'accuracy': 0.3275706728066595, 'macro avg': {'precision': 0.3442288805426186, 'recall': 0.34556032026700506, 'f1-score': 0.2980865350547851, 'support': 129859}, 'weighted avg': {'precision': 0.34755168737294934, 'recall': 0.3275706728066595, 'f1-score': 0.2901857647891141, 'support': 129859}}
[[ 9227 27593  4985]
 [ 7484 26762  5008]
 [12122 30129  6549]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999641
{'0': {'precision': 0.3537611783271962, 'recall': 0.22997349747798582, 'f1-score': 0.2787420340914979, 'support': 23394}, '1': {'precision': 0.33460833715071003, 'recall': 0.6853215743303467, 'f1-score': 0.4496668051772165, 'support': 21317}, '2': {'precision': 0.3673139158576052, 'recall': 0.1329818394844757, 'f1-score': 0.1952688172043011, 'support': 22191}, 'accuracy': 0.3428895997130131, 'macro avg': {'precision': 0.35189447711183713, 'recall': 0.3494256370976027, 'f1-score': 0.30789255215767186, 'support': 66902}, 'weighted avg': {'precision': 0.35215386738250326, 'recall': 0.3428895997130131, 'f1-score': 0.3055162589172203, 'support': 66902}}
[[ 5380 15304  2710]
 [ 4335 14609  2373]
 [ 5493 13747  2951]]
Evaluating performance on  val set...
73/73 - 1s - 726ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007026
{'0': {'precision': 0.38018242122719736, 'recall': 0.2825015403573629, 'f1-score': 0.32414280664545775, 'support': 6492}, '1': {'precision': 0.3305314771035811, 'recall': 0.63520107689719, 'f1-score': 0.43480764800737154, 'support': 5943}, '2': {'precision': 0.33997509339975096, 'recall': 0.1316931982633864, 'f1-score': 0.18984700973574412, 'support': 6219}, 'accuracy': 0.34459097244558806, 'macro avg': {'precision': 0.35022966391017646, 'recall': 0.34979860517264644, 'f1-score': 0.3162658214628578, 'support': 18654}, 'weighted avg': {'precision': 0.3509594699735498, 'recall': 0.34459097244558806, 'f1-score': 0.31462718486097957, 'support': 18654}}
[[1834 3767  891]
 [1469 3775  699]
 [1521 3879  819]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006188
{'0': {'precision': 0.2767385729370946, 'recall': 0.159268986174115, 'f1-score': 0.20217939357202883, 'support': 46073}, '1': {'precision': 0.3708538572472047, 'recall': 0.6691900843204515, 'f1-score': 0.4772331515681017, 'support': 59179}, '2': {'precision': 0.31264803410705827, 'recall': 0.13425549227013833, 'f1-score': 0.18784687633413974, 'support': 49160}, 'accuracy': 0.3467347097375852, 'macro avg': {'precision': 0.3200801547637859, 'recall': 0.3209048542549016, 'f1-score': 0.2890864738247568, 'support': 154412}, 'weighted avg': {'precision': 0.3242410825950449, 'recall': 0.3467347097375852, 'f1-score': 0.3030317871491794, 'support': 154412}}
[[ 7338 32847  5888]
 [10955 39602  8622]
 [ 8223 34337  6600]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103512
{'0': {'precision': 0.3319966709540743, 'recall': 0.15637361462528063, 'f1-score': 0.21260719996123845, 'support': 28061}, '1': {'precision': 0.3268206948331172, 'recall': 0.7017550287619536, 'f1-score': 0.44595271080480114, 'support': 27293}, '2': {'precision': 0.3240244127982245, 'recall': 0.1284410395513361, 'f1-score': 0.183961149757186, 'support': 27281}, 'accuracy': 0.32728262842621164, 'macro avg': {'precision': 0.3276139261951387, 'recall': 0.3288565609795235, 'f1-score': 0.2808403535077419, 'support': 82635}, 'weighted avg': {'precision': 0.3276551801690677, 'recall': 0.32728262842621164, 'f1-score': 0.2802202710792465, 'support': 82635}}
[[ 4388 20078  3595]
 [ 4425 19153  3715]
 [ 4404 19373  3504]]
Evaluating performance on  val set...
112/112 - 1s - 945ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1047617
{'0': {'precision': 0.3421241908415248, 'recall': 0.14829055388132598, 'f1-score': 0.20690155139915903, 'support': 9623}, '1': {'precision': 0.3255134772825202, 'recall': 0.7152324847464759, 'f1-score': 0.44740565261737897, 'support': 9506}, '2': {'precision': 0.30550621669627, 'recall': 0.11088428064897389, 'f1-score': 0.16271186440677968, 'support': 9307}, 'accuracy': 0.32557321704881137, 'macro avg': {'precision': 0.324381294940105, 'recall': 0.32480243975892525, 'f1-score': 0.2723396894744392, 'support': 28436}, 'weighted avg': {'precision': 0.32458638916541765, 'recall': 0.32557321704881137, 'f1-score': 0.27283763837842206, 'support': 28436}}
[[1427 7085 1111]
 [1472 6799 1235]
 [1272 7003 1032]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030192
{'0': {'precision': 0.3847654876590957, 'recall': 0.35746717188214544, 'f1-score': 0.3706143321593064, 'support': 61228}, '1': {'precision': 0.2970223032241992, 'recall': 0.46767966637074965, 'f1-score': 0.3633083140877599, 'support': 48437}, '2': {'precision': 0.3100472351457897, 'recall': 0.1690451755320179, 'f1-score': 0.218796992481203, 'support': 51643}, 'accuracy': 0.33023780593646934, 'macro avg': {'precision': 0.3306116753430282, 'recall': 0.33139733792830434, 'f1-score': 0.3175732129094231, 'support': 161308}, 'weighted avg': {'precision': 0.33449711077129257, 'recall': 0.33023780593646934, 'f1-score': 0.3198159559453071, 'support': 161308}}
[[21887 28459 10882]
 [17239 22653  8545]
 [17758 25155  8730]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000723
{'0': {'precision': 0.33668198219245643, 'recall': 0.3252827728036516, 'f1-score': 0.330884228787183, 'support': 39873}, '1': {'precision': 0.3387275825945557, 'recall': 0.5432569336476253, 'f1-score': 0.41727741127750756, 'support': 39878}, '2': {'precision': 0.3430157832502185, 'recall': 0.15817923186344238, 'f1-score': 0.21651441644626893, 'support': 42180}, 'accuracy': 0.33876536729789797, 'macro avg': {'precision': 0.33947511601241026, 'recall': 0.3422396461049064, 'f1-score': 0.32155868550365313, 'support': 121931}, 'weighted avg': {'precision': 0.3395420766840239, 'recall': 0.33876536729789797, 'f1-score': 0.31957511664022614, 'support': 121931}}
[[12970 20199  6704]
 [12139 21664  6075]
 [13414 22094  6672]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995072
{'0': {'precision': 0.3244466100515105, 'recall': 0.3026033889502045, 'f1-score': 0.31314454634015254, 'support': 15403}, '1': {'precision': 0.35184374875691155, 'recall': 0.5490378646803228, 'f1-score': 0.4288588814274285, 'support': 16110}, '2': {'precision': 0.33921302578018997, 'recall': 0.1627392266631949, 'f1-score': 0.21995424951610068, 'support': 15362}, 'accuracy': 0.34146133333333334, 'macro avg': {'precision': 0.338501128196204, 'recall': 0.33812682676457406, 'f1-score': 0.3206525590945606, 'support': 46875}, 'weighted avg': {'precision': 0.33870174782149415, 'recall': 0.34146133333333334, 'f1-score': 0.32237267644031103, 'support': 46875}}
[[4661 8376 2366]
 [4761 8845 2504]
 [4944 7918 2500]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
2354/2354 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0496682
{'0': {'precision': 0.2948779649364043, 'recall': 0.059088529468492544, 'f1-score': 0.09844946115619012, 'support': 145172}, '1': {'precision': 0.5214138519670717, 'recall': 0.9253931144915932, 'f1-score': 0.6670036841084734, 'support': 312250}, '2': {'precision': 0.21341144471178994, 'recall': 0.028145695364238412, 'f1-score': 0.04973244432525994, 'support': 144960}, 'accuracy': 0.5006988920651679, 'macro avg': {'precision': 0.34323442053842196, 'recall': 0.3375424464414414, 'f1-score': 0.2717285298633078, 'support': 602382}, 'weighted avg': {'precision': 0.39270034999034975, 'recall': 0.5006988920651679, 'f1-score': 0.3814410468228249, 'support': 602382}}
[[  8578 131207   5387]
 [ 13645 288954   9651]
 [  6867 134013   4080]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173844
{'0': {'precision': 0.3710876089752751, 'recall': 0.048479247185347, 'f1-score': 0.0857553339058062, 'support': 107118}, '1': {'precision': 0.33065940386372095, 'recall': 0.9352798193232277, 'f1-score': 0.48858438357670986, 'support': 104496}, '2': {'precision': 0.3675916078507203, 'recall': 0.03510845576353042, 'f1-score': 0.06409521561751913, 'support': 108293}, 'accuracy': 0.3336219588818, 'macro avg': {'precision': 0.3564462068965721, 'recall': 0.33962250742403505, 'f1-score': 0.2128116443666784, 'support': 319907}, 'weighted avg': {'precision': 0.35669849535438414, 'recall': 0.3336219588818, 'f1-score': 0.210005147709872, 'support': 319907}}
[[ 5193 98288  3637]
 [ 3859 97733  2904]
 [ 4942 99549  3802]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0881488
{'0': {'precision': 0.32992919389978215, 'recall': 0.05977992697128195, 'f1-score': 0.10121981786281226, 'support': 40532}, '1': {'precision': 0.39540083319504976, 'recall': 0.927649373002213, 'f1-score': 0.5544662376073924, 'support': 48804}, '2': {'precision': 0.37751256281407036, 'recall': 0.04835984228736958, 'f1-score': 0.0857367032026439, 'support': 37283}, 'accuracy': 0.39092869158657073, 'macro avg': {'precision': 0.36761419663630074, 'recall': 0.3452630474202882, 'f1-score': 0.2471409195576162, 'support': 126619}, 'weighted avg': {'precision': 0.36917550470146, 'recall': 0.39092869158657073, 'f1-score': 0.27136001250452824, 'support': 126619}}
[[ 2423 36540  1569]
 [ 2127 45273  1404]
 [ 2794 32686  1803]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
3870/3870 - 38s - 38s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0789548
{'0': {'precision': 0.2871751343923043, 'recall': 0.15506611134350617, 'f1-score': 0.20138841319819256, 'support': 274915}, '1': {'precision': 0.4825385921932816, 'recall': 0.7550018367882445, 'f1-score': 0.5887767621894472, 'support': 476375}, '2': {'precision': 0.24637232439573142, 'recall': 0.0997126244737018, 'f1-score': 0.14196763623172032, 'support': 239408}, 'accuracy': 0.43016741731587227, 'macro avg': {'precision': 0.3386953503271058, 'recall': 0.3365935242018175, 'f1-score': 0.3107109372064534, 'support': 990698}, 'weighted avg': {'precision': 0.3712549933142775, 'recall': 0.43016741731587227, 'f1-score': 0.37330388630777767, 'support': 990698}}
[[ 42630 207781  24504]
 [ 68193 359664  48518]
 [ 37623 177913  23872]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081637
{'0': {'precision': 0.33437519933660775, 'recall': 0.11645179683508215, 'f1-score': 0.17274295066840956, 'support': 135043}, '1': {'precision': 0.3452837540027517, 'recall': 0.820054220133743, 'f1-score': 0.4859558443950827, 'support': 138325}, '2': {'precision': 0.3355750313003041, 'recall': 0.07208280186258087, 'f1-score': 0.11867397863337066, 'support': 130142}, 'accuracy': 0.34333969418353943, 'macro avg': {'precision': 0.3384113282132211, 'recall': 0.33619627294380194, 'f1-score': 0.2591242578989543, 'support': 403510}, 'weighted avg': {'precision': 0.3385016753982016, 'recall': 0.34333969418353943, 'f1-score': 0.2626751193040271, 'support': 403510}}
[[ 15726 110214   9103]
 [ 15420 113434   9471]
 [ 15885 104876   9381]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056026
{'0': {'precision': 0.3827484421121679, 'recall': 0.13840406396394617, 'f1-score': 0.20329534731799379, 'support': 50591}, '1': {'precision': 0.34194460510249985, 'recall': 0.8386461247488081, 'f1-score': 0.485808520593908, 'support': 50758}, '2': {'precision': 0.34045744281964757, 'recall': 0.06971075411220513, 'f1-score': 0.11572591565900364, 'support': 52101}, 'accuracy': 0.3467057673509286, 'macro avg': {'precision': 0.3550501633447718, 'recall': 0.34892031427498643, 'f1-score': 0.26827659452363517, 'support': 153450}, 'weighted avg': {'precision': 0.3548923032195232, 'recall': 0.3467057673509286, 'f1-score': 0.26701218466093163, 'support': 153450}}
[[ 7002 39488  4101]
 [ 5255 42568  2935]
 [ 6037 42432  3632]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977864
{'0': {'precision': 0.3572569311358119, 'recall': 0.21874327733557586, 'f1-score': 0.27134556834584733, 'support': 204532}, '1': {'precision': 0.3710015983547006, 'recall': 0.7477079306725055, 'f1-score': 0.49593005187540345, 'support': 221961}, '2': {'precision': 0.3409829481140687, 'recall': 0.09299071934995619, 'f1-score': 0.14612983233055057, 'support': 200848}, 'accuracy': 0.36563687053771393, 'macro avg': {'precision': 0.3564138258681937, 'recall': 0.35314730911934583, 'f1-score': 0.30446848418393374, 'support': 627341}, 'weighted avg': {'precision': 0.35690972465420245, 'recall': 0.36563687053771393, 'f1-score': 0.3107175628456545, 'support': 627341}}
[[ 44740 140423  19369]
 [ 39271 165962  16728]
 [ 41221 140950  18677]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972844
{'0': {'precision': 0.38100117368705405, 'recall': 0.19472321139527354, 'f1-score': 0.2577266970378632, 'support': 105026}, '1': {'precision': 0.35226782997211936, 'recall': 0.7877372406332973, 'f1-score': 0.4868302703228316, 'support': 101690}, '2': {'precision': 0.35703578429488414, 'recall': 0.09254204192237188, 'f1-score': 0.1469859881480778, 'support': 100376}, 'accuracy': 0.3576941112109726, 'macro avg': {'precision': 0.3634349293180192, 'recall': 0.35833416465031426, 'f1-score': 0.2971809851695909, 'support': 307092}, 'weighted avg': {'precision': 0.3636531358091537, 'recall': 0.3576941112109726, 'f1-score': 0.2973950471473657, 'support': 307092}}
[[20451 75048  9527]
 [14384 80105  7201]
 [18842 72245  9289]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.094852
{'0': {'precision': 0.3422158501013497, 'recall': 0.1822538177988415, 'f1-score': 0.23784080952462763, 'support': 37980}, '1': {'precision': 0.3726790291332234, 'recall': 0.7855023207446674, 'f1-score': 0.5055171062940715, 'support': 39427}, '2': {'precision': 0.3714650223261748, 'recall': 0.09890452062162086, 'f1-score': 0.15621576911899493, 'support': 35327}, 'accuracy': 0.3671119626731953, 'macro avg': {'precision': 0.36211996718691597, 'recall': 0.35555355305504327, 'f1-score': 0.2998578949792314, 'support': 112734}, 'weighted avg': {'precision': 0.3620355785495205, 'recall': 0.3671119626731953, 'f1-score': 0.30587800815431415, 'support': 112734}}
[[ 6922 27814  3244]
 [ 5789 30970  2668]
 [ 7516 24317  3494]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
3337/3337 - 30s - 30s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0865889
{'0': {'precision': 0.34162311729484185, 'recall': 0.22555676363340507, 'f1-score': 0.2717141679753194, 'support': 270402}, '1': {'precision': 0.42344829478326623, 'recall': 0.7199495052564678, 'f1-score': 0.533255163374135, 'support': 343006}, '2': {'precision': 0.3034547759108193, 'recall': 0.1164151562883136, 'f1-score': 0.16827466057911808, 'support': 240613}, 'accuracy': 0.39337323086903014, 'macro avg': {'precision': 0.35617539599630915, 'recall': 0.35397380839272885, 'f1-score': 0.32441466397619084, 'support': 854021}, 'weighted avg': {'precision': 0.36373349596721716, 'recall': 0.39337323086903014, 'f1-score': 0.3476153934424261, 'support': 854021}}
[[ 60991 179008  30403]
 [ 62166 246947  33893]
 [ 55376 157226  28011]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0930654
{'0': {'precision': 0.33541474109580205, 'recall': 0.27626896588354016, 'f1-score': 0.30298235054268685, 'support': 112966}, '1': {'precision': 0.3753957766090481, 'recall': 0.6654194735063159, 'f1-score': 0.48000000000000004, 'support': 127219}, '2': {'precision': 0.3664675947344072, 'recall': 0.13839629609040588, 'f1-score': 0.20091655858192822, 'support': 125921}, 'accuracy': 0.36407488541569927, 'macro avg': {'precision': 0.35909270414641914, 'recall': 0.36002824516008736, 'f1-score': 0.3279663030415384, 'support': 366106}, 'weighted avg': {'precision': 0.3599883720660305, 'recall': 0.36407488541569927, 'f1-score': 0.3293894068510217, 'support': 366106}}
[[31209 66655 15102]
 [27540 84654 15025]
 [34297 74197 17427]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975449
{'0': {'precision': 0.37178091061600493, 'recall': 0.2940957347737009, 'f1-score': 0.3284067126831234, 'support': 42952}, '1': {'precision': 0.33976203541362743, 'recall': 0.6409311250252474, 'f1-score': 0.44410233982068664, 'support': 39608}, '2': {'precision': 0.3503423254725262, 'recall': 0.13851421696781807, 'f1-score': 0.19853428836715745, 'support': 43223}, 'accuracy': 0.3498485486909996, 'macro avg': {'precision': 0.35396175716738615, 'recall': 0.3578470255889221, 'f1-score': 0.32368111362365587, 'support': 125783}, 'weighted avg': {'precision': 0.35433146534381116, 'recall': 0.3498485486909996, 'f1-score': 0.3202100295340143, 'support': 125783}}
[[12632 24199  6121]
 [ 9241 25386  4981]
 [12104 25132  5987]]
testing model on single stock: results/universal/W9/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
10303/10303 - 84s - 84s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999225
{'0': {'precision': 0.29618678916464436, 'recall': 0.3414309596406973, 'f1-score': 0.3172036532761405, 'support': 771049}, '1': {'precision': 0.4094391295214116, 'recall': 0.4976896896225219, 'f1-score': 0.4492716557790107, 'support': 1073016}, '2': {'precision': 0.3024450851829594, 'recall': 0.16937273977454784, 'f1-score': 0.21714293101748683, 'support': 793339}, 'accuracy': 0.353248497386066, 'macro avg': {'precision': 0.3360236679563384, 'recall': 0.33616446301258907, 'f1-score': 0.32787274669087935, 'support': 2637404}, 'weighted avg': {'precision': 0.3441455105228932, 'recall': 0.353248497386066, 'f1-score': 0.34083636424407016, 'support': 2637404}}
[[263260 377784 130005]
 [359083 534029 179904]
 [266488 392481 134370]]
Evaluating performance on  train set...
3419/3419 - 30s - 30s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013895
{'0': {'precision': 0.3296384951811497, 'recall': 0.3456241994216744, 'f1-score': 0.337442130021894, 'support': 288073}, '1': {'precision': 0.33438123098866235, 'recall': 0.4766185495721324, 'f1-score': 0.39302673351590006, 'support': 289225}, '2': {'precision': 0.3392143332276494, 'recall': 0.18319254941985388, 'f1-score': 0.23790474654086544, 'support': 297856}, 'accuracy': 0.3336327092146068, 'macro avg': {'precision': 0.3344113531324871, 'recall': 0.33514509947122023, 'f1-score': 0.3227912033595532, 'support': 875154}, 'weighted avg': {'precision': 0.334465004093988, 'recall': 0.3336327092146068, 'f1-score': 0.32193474509470255, 'support': 875154}}
[[ 99565 135059  53449]
 [ 98532 137850  52843]
 [103946 139345  54565]]
Evaluating performance on  val set...
1396/1396 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020911
{'0': {'precision': 0.322530393570987, 'recall': 0.3352380789198636, 'f1-score': 0.32876148388370563, 'support': 116726}, '1': {'precision': 0.3387360221133308, 'recall': 0.4877711804470468, 'f1-score': 0.3998166473427346, 'support': 121598}, '2': {'precision': 0.33272521078842265, 'recall': 0.17020060197407139, 'f1-score': 0.2252023249993047, 'support': 118942}, 'accuracy': 0.33220905431807113, 'macro avg': {'precision': 0.3313305421575801, 'recall': 0.3310699537803273, 'f1-score': 0.317926818741915, 'support': 357266}, 'weighted avg': {'precision': 0.3314401805895338, 'recall': 0.33220905431807113, 'f1-score': 0.31846840335060866, 'support': 357266}}
[[39131 57968 19627]
 [41314 59312 20972]
 [40880 57818 20244]]
training model: results/universal/W9/deepVOL_L3/h300
Epoch 1/50
6697/6697 - 393s - loss: 3.2743 - accuracy300: 0.3692 - val_loss: 3.2979 - val_accuracy300: 0.3354 - 393s/epoch - 59ms/step
Epoch 2/50
6697/6697 - 387s - loss: 3.2797 - accuracy300: 0.3632 - val_loss: 3.2960 - val_accuracy300: 0.3392 - 387s/epoch - 58ms/step
Epoch 3/50
6697/6697 - 391s - loss: 3.2747 - accuracy300: 0.3678 - val_loss: 3.2911 - val_accuracy300: 0.3510 - 391s/epoch - 58ms/step
Epoch 4/50
6697/6697 - 390s - loss: 3.2573 - accuracy300: 0.3825 - val_loss: 3.2838 - val_accuracy300: 0.3541 - 390s/epoch - 58ms/step
Epoch 5/50
6697/6697 - 403s - loss: 3.2519 - accuracy300: 0.3842 - val_loss: 3.2921 - val_accuracy300: 0.3547 - 403s/epoch - 60ms/step
Epoch 6/50
6697/6697 - 411s - loss: 3.2470 - accuracy300: 0.3883 - val_loss: 3.2846 - val_accuracy300: 0.3542 - 411s/epoch - 61ms/step
Epoch 7/50
6697/6697 - 420s - loss: 3.2418 - accuracy300: 0.3915 - val_loss: 3.2970 - val_accuracy300: 0.3522 - 420s/epoch - 63ms/step
Epoch 8/50
6697/6697 - 412s - loss: 3.2365 - accuracy300: 0.3946 - val_loss: 3.2946 - val_accuracy300: 0.3499 - 412s/epoch - 61ms/step
Epoch 9/50
6697/6697 - 432s - loss: 3.2311 - accuracy300: 0.3977 - val_loss: 3.2988 - val_accuracy300: 0.3509 - 432s/epoch - 64ms/step
Epoch 10/50
6697/6697 - 406s - loss: 3.2247 - accuracy300: 0.4012 - val_loss: 3.2958 - val_accuracy300: 0.3530 - 406s/epoch - 61ms/step
Epoch 11/50
6697/6697 - 394s - loss: 3.2194 - accuracy300: 0.4045 - val_loss: 3.3052 - val_accuracy300: 0.3534 - 394s/epoch - 59ms/step
Epoch 12/50
6697/6697 - 382s - loss: 3.2142 - accuracy300: 0.4056 - val_loss: 3.3052 - val_accuracy300: 0.3537 - 382s/epoch - 57ms/step
Epoch 13/50
6697/6697 - 392s - loss: 3.2098 - accuracy300: 0.4076 - val_loss: 3.3087 - val_accuracy300: 0.3543 - 392s/epoch - 59ms/step
Epoch 14/50
6697/6697 - 388s - loss: 3.2066 - accuracy300: 0.4081 - val_loss: 3.3079 - val_accuracy300: 0.3576 - 388s/epoch - 58ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 523s - 523s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951506
{'0': {'precision': 0.3356150098793621, 'recall': 0.412874378044892, 'f1-score': 0.37025732282124124, 'support': 1348570}, '1': {'precision': 0.3730805043754403, 'recall': 0.46175929792631465, 'f1-score': 0.41271005837388197, 'support': 1604390}, '2': {'precision': 0.35807668578858687, 'recall': 0.17522454559412315, 'f1-score': 0.23530350527215732, 'support': 1354736}, 'accuracy': 0.3563424624207465, 'macro avg': {'precision': 0.3555907333477964, 'recall': 0.3499527405217766, 'f1-score': 0.3394236288224268, 'support': 4307696}, 'weighted avg': {'precision': 0.3566329521132436, 'recall': 0.3563424624207465, 'f1-score': 0.3436268339060823, 'support': 4307696}}
[[556790 608373 183407]
 [621399 740842 242149]
 [480825 636528 237383]]
Evaluating performance on  train set...
6697/6697 - 219s - 219s/epoch - 33ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952319
{'0': {'precision': 0.36460114515189995, 'recall': 0.41680030185831524, 'f1-score': 0.38895722023205487, 'support': 572454}, '1': {'precision': 0.3286248889931017, 'recall': 0.4310887039037213, 'f1-score': 0.3729470652916968, 'support': 565691}, '2': {'precision': 0.383376952220784, 'recall': 0.2113899211613934, 'f1-score': 0.27251693842394586, 'support': 575860}, 'accuracy': 0.35250363913757543, 'macro avg': {'precision': 0.3588676621219285, 'recall': 0.35309297564114334, 'f1-score': 0.3448070746492325, 'support': 1714005}, 'weighted avg': {'precision': 0.35903569577220784, 'recall': 0.35250363913757543, 'f1-score': 0.3445523898841949, 'support': 1714005}}
[[238599 246522  87333]
 [213369 243863 108459]
 [202443 251686 121731]]
Evaluating performance on  val set...
2631/2631 - 82s - 82s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947286
{'0': {'precision': 0.36150930026572187, 'recall': 0.4517285803461145, 'f1-score': 0.4016145506357638, 'support': 225879}, '1': {'precision': 0.33597332957030973, 'recall': 0.41673777486051855, 'f1-score': 0.3720226178501323, 'support': 228525}, '2': {'precision': 0.37986897851770285, 'recall': 0.18632818221766514, 'f1-score': 0.2500199617961931, 'support': 218464}, 'accuracy': 0.35367560948061133, 'macro avg': {'precision': 0.35911720278457815, 'recall': 0.3515981791414327, 'f1-score': 0.34121904342736303, 'support': 672868}, 'weighted avg': {'precision': 0.35879750693697343, 'recall': 0.35367560948061133, 'f1-score': 0.342345189191789, 'support': 672868}}
[[102036  94092  29751]
 [ 96589  95235  36701]
 [ 83625  94133  40706]]
testing model out of sample: results/universal/W9/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 274s - 274s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941982
{'0': {'precision': 0.36838541564282173, 'recall': 0.45221012102979896, 'f1-score': 0.4060163770057499, 'support': 745932}, '1': {'precision': 0.32635015552933605, 'recall': 0.31689728260303507, 'f1-score': 0.3215542614972442, 'support': 768088}, '2': {'precision': 0.3641865270648326, 'recall': 0.287150765876886, 'f1-score': 0.32111301257263464, 'support': 697240}, 'accuracy': 0.3531633548293733, 'macro avg': {'precision': 0.35297403274566347, 'recall': 0.35208605650324, 'f1-score': 0.3495612170252096, 'support': 2211260}, 'weighted avg': {'precision': 0.3524603720286994, 'recall': 0.3531633548293733, 'f1-score': 0.3499070279495365, 'support': 2211260}}
[[337318 258447 150167]
 [325309 243405 199374]
 [253039 243988 200213]]
Evaluating performance on  train set...
3947/3947 - 135s - 135s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941511
{'0': {'precision': 0.3559549709363948, 'recall': 0.48571089297023434, 'f1-score': 0.4108309822338, 'support': 328432}, '1': {'precision': 0.33020244754251965, 'recall': 0.3380767296438528, 'f1-score': 0.33409319756326333, 'support': 343987}, '2': {'precision': 0.3904594399545005, 'recall': 0.24231000803775074, 'f1-score': 0.2990417136414882, 'support': 337159}, 'accuracy': 0.3541222174017263, 'macro avg': {'precision': 0.3588722861444717, 'recall': 0.355365876883946, 'f1-score': 0.3479886311461839, 'support': 1009578}, 'weighted avg': {'precision': 0.35870360353832015, 'recall': 0.3541222174017263, 'f1-score': 0.3473514310304466, 'support': 1009578}}
[[159523 113784  55125]
 [155282 116294  72411]
 [133350 122112  81697]]
Evaluating performance on  val set...
1402/1402 - 48s - 48s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950962
{'0': {'precision': 0.3510250969855997, 'recall': 0.47802597047333284, 'f1-score': 0.40479801361657153, 'support': 116979}, '1': {'precision': 0.33775860069898794, 'recall': 0.3271486098410101, 'f1-score': 0.3323689529273699, 'support': 124662}, '2': {'precision': 0.3839297132772335, 'recall': 0.2574677747189132, 'f1-score': 0.30823173079391153, 'support': 116601}, 'accuracy': 0.35373574287771953, 'macro avg': {'precision': 0.35757113698727366, 'recall': 0.3542141183444187, 'f1-score': 0.34846623244595093, 'support': 358242}, 'weighted avg': {'precision': 0.357118417155036, 'recall': 0.35373574287771953, 'f1-score': 0.3481634573472278, 'support': 358242}}
[[55919 39585 21475]
 [57181 40783 26698]
 [46202 40378 30021]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
295/295 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929621
{'0': {'precision': 0.38052398447962094, 'recall': 0.41859938052428797, 'f1-score': 0.3986546036656654, 'support': 26474}, '1': {'precision': 0.33993020937188434, 'recall': 0.5274801779152969, 'f1-score': 0.41342932929139825, 'support': 25855}, '2': {'precision': 0.38280867721415757, 'recall': 0.10184421783467129, 'f1-score': 0.1608856594461201, 'support': 23045}, 'accuracy': 0.3591026083264786, 'macro avg': {'precision': 0.3677542903552209, 'recall': 0.34930792542475203, 'f1-score': 0.3243231974677279, 'support': 75374}, 'weighted avg': {'precision': 0.3672979209651049, 'recall': 0.3591026083264786, 'f1-score': 0.33102671091105373, 'support': 75374}}
[[11082 13726  1666]
 [10099 13638  2118]
 [ 7942 12756  2347]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003281
{'0': {'precision': 0.3453167298321603, 'recall': 0.3758397171479081, 'f1-score': 0.3599322799097065, 'support': 16970}, '1': {'precision': 0.3229350598391211, 'recall': 0.487963951144314, 'f1-score': 0.38865670232107863, 'support': 16866}, '2': {'precision': 0.3544744912182883, 'recall': 0.1470537211588504, 'f1-score': 0.20787182735930027, 'support': 17293}, 'accuracy': 0.33544563750513406, 'macro avg': {'precision': 0.34090876029652323, 'recall': 0.3369524631503575, 'f1-score': 0.3188202698633618, 'support': 51129}, 'weighted avg': {'precision': 0.3410310196001532, 'recall': 0.33544563750513406, 'f1-score': 0.3179773170204661, 'support': 51129}}
[[6378 8562 2030]
 [6035 8230 2601]
 [6057 8693 2543]]
Evaluating performance on  val set...
53/53 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942897
{'0': {'precision': 0.33096302316131654, 'recall': 0.388412017167382, 'f1-score': 0.3573935936814393, 'support': 4194}, '1': {'precision': 0.3920198048638416, 'recall': 0.4985185185185185, 'f1-score': 0.4389011168174778, 'support': 5400}, '2': {'precision': 0.33175635718509755, 'recall': 0.14436438497169327, 'f1-score': 0.20118343195266272, 'support': 3886}, 'accuracy': 0.36216617210682495, 'macro avg': {'precision': 0.35157972840341856, 'recall': 0.34376497355253127, 'f1-score': 0.3324927141505266, 'support': 13480}, 'weighted avg': {'precision': 0.35565067280597884, 'recall': 0.36216617210682495, 'f1-score': 0.34501287680136383, 'support': 13480}}
[[1629 2154  411]
 [1989 2692  719]
 [1304 2021  561]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
1118/1118 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0830032
{'0': {'precision': 0.3390219252857912, 'recall': 0.6458422199421265, 'f1-score': 0.44463934218045587, 'support': 86741}, '1': {'precision': 0.36584054138842825, 'recall': 0.22068922012147865, 'f1-score': 0.2753042354065372, 'support': 110966}, '2': {'precision': 0.45756368689207966, 'recall': 0.2792198982475975, 'f1-score': 0.34680709145164124, 'support': 88450}, 'accuracy': 0.36765481885817924, 'macro avg': {'precision': 0.38747538452209973, 'recall': 0.3819171127704009, 'f1-score': 0.35558355634621147, 'support': 286157}, 'weighted avg': {'precision': 0.38606244279373764, 'recall': 0.36765481885817924, 'f1-score': 0.3487349888526033, 'support': 286157}}
[[56021 18663 12057]
 [69256 24489 17221]
 [39966 23787 24697]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0827144
{'0': {'precision': 0.3912085642490792, 'recall': 0.5257801114940668, 'f1-score': 0.4486198967759762, 'support': 43231}, '1': {'precision': 0.3349381732534377, 'recall': 0.20629333333333333, 'f1-score': 0.25532701396773433, 'support': 46875}, '2': {'precision': 0.38788940441246095, 'recall': 0.418961417504027, 'f1-score': 0.40282711572736773, 'support': 39111}, 'accuracy': 0.37755094143959383, 'macro avg': {'precision': 0.37134538063832595, 'recall': 0.383678287443809, 'f1-score': 0.36892467549035945, 'support': 129217}, 'weighted avg': {'precision': 0.36979117924330857, 'recall': 0.37755094143959383, 'f1-score': 0.364640193321876, 'support': 129217}}
[[22730  9867 10634]
 [21981  9670 15224]
 [13391  9334 16386]]
Evaluating performance on  val set...
187/187 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0859369
{'0': {'precision': 0.36884646472422156, 'recall': 0.61857733023496, 'f1-score': 0.46213198948713624, 'support': 15492}, '1': {'precision': 0.3395789261609751, 'recall': 0.19434995675987315, 'f1-score': 0.24721325902024052, 'support': 17345}, '2': {'precision': 0.4294834103317934, 'recall': 0.34141292735042733, 'f1-score': 0.380417395186191, 'support': 14976}, 'accuracy': 0.37786794386463934, 'macro avg': {'precision': 0.37930293373899665, 'recall': 0.3847800714484202, 'f1-score': 0.36325421456452256, 'support': 47813}, 'weighted avg': {'precision': 0.3772218739442974, 'recall': 0.37786794386463934, 'f1-score': 0.35857180409405776, 'support': 47813}}
[[9583 3230 2679]
 [9861 3371 4113]
 [6537 3326 5113]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
508/508 - 17s - 17s/epoch - 34ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074831
{'0': {'precision': 0.3200861132808779, 'recall': 0.41327823284874426, 'f1-score': 0.36076098859805455, 'support': 40653}, '1': {'precision': 0.29160506743694137, 'recall': 0.27711494401936626, 'f1-score': 0.28417541254308293, 'support': 46266}, '2': {'precision': 0.2938957578660599, 'recall': 0.22862133209129018, 'f1-score': 0.2571814049749158, 'support': 42940}, 'accuracy': 0.30370632763227806, 'macro avg': {'precision': 0.30186231286129306, 'recall': 0.3063381696531336, 'f1-score': 0.3007059353720178, 'support': 129859}, 'weighted avg': {'precision': 0.3012786534319044, 'recall': 0.30370632763227806, 'f1-score': 0.2992248949692965, 'support': 129859}}
[[16801 15298  8554]
 [18413 12821 15032]
 [17275 15848  9817]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033363
{'0': {'precision': 0.33056478405315615, 'recall': 0.44560884947825696, 'f1-score': 0.37956093001964564, 'support': 22329}, '1': {'precision': 0.30513655926953864, 'recall': 0.3429785694909124, 'f1-score': 0.32295280870176035, 'support': 22118}, '2': {'precision': 0.3270245373084331, 'recall': 0.1739033622801158, 'f1-score': 0.22706128619606933, 'support': 22455}, 'accuracy': 0.32048369256524467, 'macro avg': {'precision': 0.32090862687704264, 'recall': 0.32083026041642837, 'f1-score': 0.30985834163915843, 'support': 66902}, 'weighted avg': {'precision': 0.3209698882889517, 'recall': 0.32048369256524467, 'f1-score': 0.30966110745279574, 'support': 66902}}
[[ 9950  8568  3811]
 [10307  7586  4225]
 [ 9843  8707  3905]]
Evaluating performance on  val set...
73/73 - 7s - 7s/epoch - 100ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003157
{'0': {'precision': 0.37368278843555797, 'recall': 0.42804085422469823, 'f1-score': 0.3990190421234853, 'support': 6462}, '1': {'precision': 0.31473739221322183, 'recall': 0.391261978236154, 'f1-score': 0.3488523640576352, 'support': 6157}, '2': {'precision': 0.32490272373540857, 'recall': 0.19370339685169843, 'f1-score': 0.242707360116267, 'support': 6035}, 'accuracy': 0.3400879168006862, 'macro avg': {'precision': 0.3377743014613961, 'recall': 0.33766874310418354, 'f1-score': 0.33019292209912915, 'support': 18654}, 'weighted avg': {'precision': 0.3384456009687238, 'recall': 0.3400879168006862, 'f1-score': 0.3318904242525192, 'support': 18654}}
[[2766 2580 1116]
 [2435 2409 1313]
 [2201 2665 1169]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984137
{'0': {'precision': 0.26985205314009664, 'recall': 0.153832913789023, 'f1-score': 0.19595751969852693, 'support': 46479}, '1': {'precision': 0.3749605671686397, 'recall': 0.766803049080692, 'f1-score': 0.5036434899448599, 'support': 58903}, '2': {'precision': 0.3016894609814964, 'recall': 0.04589027126249235, 'f1-score': 0.07966293726101119, 'support': 49030}, 'accuracy': 0.3533857472217185, 'macro avg': {'precision': 0.3155006937634109, 'recall': 0.3221754113774024, 'f1-score': 0.25975464896813266, 'support': 154412}, 'weighted avg': {'precision': 0.3200566674724484, 'recall': 0.3533857472217185, 'f1-score': 0.27640271390952315, 'support': 154412}}
[[ 7150 36970  2359]
 [10887 45167  2849]
 [ 8459 38321  2250]]
Evaluating performance on  train set...
323/323 - 9s - 9s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017704
{'0': {'precision': 0.3370674857710724, 'recall': 0.12962512594239656, 'f1-score': 0.18724279835390947, 'support': 28783}, '1': {'precision': 0.32784652732547814, 'recall': 0.8138458146542221, 'f1-score': 0.4674052970349267, 'support': 27214}, '2': {'precision': 0.3069825436408978, 'recall': 0.04621217809144831, 'f1-score': 0.08033150613416863, 'support': 26638}, 'accuracy': 0.32806922006413747, 'macro avg': {'precision': 0.32396551891248276, 'recall': 0.3298943728960223, 'f1-score': 0.24499320050766826, 'support': 82635}, 'weighted avg': {'precision': 0.324332665760157, 'recall': 0.32806922006413747, 'f1-score': 0.2450444470131428, 'support': 82635}}
[[ 3731 23666  1386]
 [ 3673 22148  1393]
 [ 3665 21742  1231]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029993
{'0': {'precision': 0.33501594048884165, 'recall': 0.12721953188054883, 'f1-score': 0.18441064638783272, 'support': 9912}, '1': {'precision': 0.302130930520562, 'recall': 0.8141542002301496, 'f1-score': 0.4407138630205252, 'support': 8690}, '2': {'precision': 0.3458167330677291, 'recall': 0.044132601179581045, 'f1-score': 0.07827576877987194, 'support': 9834}, 'accuracy': 0.3084118722745815, 'macro avg': {'precision': 0.3276545346923776, 'recall': 0.3285021110967598, 'f1-score': 0.23446675939607664, 'support': 28436}, 'weighted avg': {'precision': 0.32870155933806194, 'recall': 0.3084118722745815, 'f1-score': 0.22603199137803567, 'support': 28436}}
[[1261 8206  445]
 [1239 7075  376]
 [1264 8136  434]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023278
{'0': {'precision': 0.38074206306458813, 'recall': 0.41439434543749165, 'f1-score': 0.3968560773148334, 'support': 59704}, '1': {'precision': 0.2970445338856108, 'recall': 0.47647402950148343, 'f1-score': 0.36594856982388574, 'support': 47862}, '2': {'precision': 0.31359312672598955, 'recall': 0.11410070336050017, 'f1-score': 0.1673215455140799, 'support': 53742}, 'accuracy': 0.332767128722692, 'macro avg': {'precision': 0.33045990789206287, 'recall': 0.33498969276649176, 'f1-score': 0.31004206421759967, 'support': 161308}, 'weighted avg': {'precision': 0.3335364112787301, 'recall': 0.332767128722692, 'f1-score': 0.3112128362383349, 'support': 161308}}
[[24741 28573  6390]
 [18025 22805  7032]
 [22215 25395  6132]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026008
{'0': {'precision': 0.32377232977053594, 'recall': 0.4348055207026349, 'f1-score': 0.3711629501103185, 'support': 39850}, '1': {'precision': 0.3074195516242184, 'recall': 0.40012902585479626, 'f1-score': 0.3477004678841717, 'support': 40302}, '2': {'precision': 0.34018422206905197, 'recall': 0.1299456664831614, 'f1-score': 0.1880563926703384, 'support': 41779}, 'accuracy': 0.3188852711779613, 'macro avg': {'precision': 0.3237920344879354, 'recall': 0.3216267376801975, 'f1-score': 0.3023066035549429, 'support': 121931}, 'weighted avg': {'precision': 0.3239906727964015, 'recall': 0.3188852711779613, 'f1-score': 0.30066739260678704, 'support': 121931}}
[[17327 17869  4654]
 [18300 16126  5876]
 [17889 18461  5429]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024705
{'0': {'precision': 0.326759322697465, 'recall': 0.43055197317513544, 'f1-score': 0.37154304156696893, 'support': 15508}, '1': {'precision': 0.3230180983940862, 'recall': 0.38330308529945556, 'f1-score': 0.350587909807719, 'support': 16530}, '2': {'precision': 0.3041312628186346, 'recall': 0.13992046909752645, 'f1-score': 0.19166320454230715, 'support': 14837}, 'accuracy': 0.32189866666666667, 'macro avg': {'precision': 0.31796956130339527, 'recall': 0.31792517585737246, 'f1-score': 0.30459805197233164, 'support': 46875}, 'weighted avg': {'precision': 0.3182777235047811, 'recall': 0.32189866666666667, 'f1-score': 0.3072173782087757, 'support': 46875}}
[[6677 6803 2028]
 [7472 6336 2722]
 [6285 6476 2076]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0872982
{'0': {'precision': 0.3839443083865245, 'recall': 0.5057457833773623, 'f1-score': 0.43650753631131817, 'support': 196840}, '1': {'precision': 0.34018049474143636, 'recall': 0.23033365109628218, 'f1-score': 0.27468211246710283, 'support': 209800}, '2': {'precision': 0.40574404480633497, 'recall': 0.41673222915879066, 'f1-score': 0.4111647365701828, 'support': 195742}, 'accuracy': 0.3808994956688613, 'macro avg': {'precision': 0.3766229493114319, 'recall': 0.3842705545441451, 'f1-score': 0.37411812844953457, 'support': 602382}, 'weighted avg': {'precision': 0.37578582407515243, 'recall': 0.3808994956688613, 'f1-score': 0.3719112764140342, 'support': 602382}}
[[99551 46069 51220]
 [93225 48324 68251]
 [66509 47661 81572]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0799835
{'0': {'precision': 0.41124779107905357, 'recall': 0.5622097723299054, 'f1-score': 0.475023330619701, 'support': 106382}, '1': {'precision': 0.3286224360219311, 'recall': 0.20917052575525613, 'f1-score': 0.25563044741429397, 'support': 105163}, '2': {'precision': 0.43282777090675767, 'recall': 0.42953249294032964, 'f1-score': 0.43117383591401537, 'support': 108362}, 'accuracy': 0.401213477666947, 'macro avg': {'precision': 0.3908993326692474, 'recall': 0.40030426367516375, 'f1-score': 0.38727587131600344, 'support': 319907}, 'weighted avg': {'precision': 0.39139614532018463, 'recall': 0.401213477666947, 'f1-score': 0.3880492015077162, 'support': 319907}}
[[59809 21657 24916]
 [47090 21997 36076]
 [38534 23283 46545]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0806668
{'0': {'precision': 0.3967686377429673, 'recall': 0.5658510339665014, 'f1-score': 0.46646032802059534, 'support': 42748}, '1': {'precision': 0.3238673790529166, 'recall': 0.20826469619240362, 'f1-score': 0.2535090232025208, 'support': 42494}, '2': {'precision': 0.43072949279899814, 'recall': 0.3989897769292119, 'f1-score': 0.41425255630136126, 'support': 41377}, 'accuracy': 0.39131567932142886, 'macro avg': {'precision': 0.383788503198294, 'recall': 0.3910351690293723, 'f1-score': 0.37807396917482583, 'support': 126619}, 'weighted avg': {'precision': 0.3834004403387734, 'recall': 0.39131567932142886, 'f1-score': 0.3779321156878016, 'support': 126619}}
[[24189  9093  9466]
 [21291  8850 12353]
 [15485  9383 16509]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
3870/3870 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0912066
{'0': {'precision': 0.39927495620767983, 'recall': 0.4255346775775903, 'f1-score': 0.41198679742597294, 'support': 346564}, '1': {'precision': 0.3029505589398506, 'recall': 0.31104428308766247, 'f1-score': 0.30694407498696863, 'support': 320890}, '2': {'precision': 0.3893578824029218, 'recall': 0.3515765180482855, 'f1-score': 0.3695039358046046, 'support': 323244}, 'accuracy': 0.3643199037446326, 'macro avg': {'precision': 0.36386113251681745, 'recall': 0.3627184929045127, 'f1-score': 0.36281160273918206, 'support': 990698}, 'weighted avg': {'precision': 0.3648394668413756, 'recall': 0.3643199037446326, 'f1-score': 0.3641018826230868, 'support': 990698}}
[[147475 119053  80036]
 [122882  99811  98197]
 [ 99000 110599 113645]]
Evaluating performance on  train set...
1577/1577 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0841742
{'0': {'precision': 0.37365862508737946, 'recall': 0.5416167132039571, 'f1-score': 0.4422270499671601, 'support': 129287}, '1': {'precision': 0.36390829129478725, 'recall': 0.30451076956380563, 'f1-score': 0.331570418385386, 'support': 147824}, '2': {'precision': 0.40577624360209064, 'recall': 0.29667165088331393, 'f1-score': 0.3427508546149206, 'support': 126399}, 'accuracy': 0.3780253277490025, 'macro avg': {'precision': 0.3811143866614191, 'recall': 0.38093304455035887, 'f1-score': 0.372182774322489, 'support': 403510}, 'weighted avg': {'precision': 0.3801474395407631, 'recall': 0.3780253277490025, 'f1-score': 0.3705277177987581, 'support': 403510}}
[[70024 37384 21879]
 [69775 45014 33035]
 [47602 41298 37499]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0868284
{'0': {'precision': 0.35263273185290656, 'recall': 0.5414660808509744, 'f1-score': 0.42710863851555825, 'support': 47569}, '1': {'precision': 0.37032139230642075, 'recall': 0.2752531901075948, 'f1-score': 0.3157873540072493, 'support': 56973}, '2': {'precision': 0.4198523422926355, 'recall': 0.32673591232518195, 'f1-score': 0.3674872655773896, 'support': 48908}, 'accuracy': 0.37418703160638644, 'macro avg': {'precision': 0.3809354888173209, 'recall': 0.3811517277612504, 'f1-score': 0.3701277527000657, 'support': 153450}, 'weighted avg': {'precision': 0.38062460385945157, 'recall': 0.37418703160638644, 'f1-score': 0.36677452544972683, 'support': 153450}}
[[25757 12486  9326]
 [28536 15682 12755]
 [18749 14179 15980]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
2451/2451 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988386
{'0': {'precision': 0.3616472015302552, 'recall': 0.44068808360850675, 'f1-score': 0.3972743443713418, 'support': 211079}, '1': {'precision': 0.33936206717071044, 'recall': 0.4122851803103615, 'f1-score': 0.3722862061235625, 'support': 213493}, '2': {'precision': 0.34557602022390754, 'recall': 0.18876652742776262, 'f1-score': 0.24416242197691446, 'support': 202769}, 'accuracy': 0.3495961526506318, 'macro avg': {'precision': 0.34886176297495775, 'recall': 0.3472465971155436, 'f1-score': 0.3379076574906063, 'support': 627341}, 'weighted avg': {'precision': 0.3488687324805213, 'recall': 0.3495961526506318, 'f1-score': 0.33928173111805726, 'support': 627341}}
[[93020 84970 33089]
 [86078 88020 39395]
 [78114 86379 38276]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949544
{'0': {'precision': 0.388646548639392, 'recall': 0.42971664343042315, 'f1-score': 0.4081510311814969, 'support': 106156}, '1': {'precision': 0.31684837769701735, 'recall': 0.39864475201845445, 'f1-score': 0.3530710155238147, 'support': 97104}, '2': {'precision': 0.38741006129156424, 'recall': 0.2520224978811927, 'f1-score': 0.30538342144265884, 'support': 103832}, 'accuracy': 0.3598107407552134, 'macro avg': {'precision': 0.3643016625426579, 'recall': 0.36012796444335676, 'f1-score': 0.35553515604932356, 'support': 307092}, 'weighted avg': {'precision': 0.3655255407802228, 'recall': 0.3598107407552134, 'f1-score': 0.3559873268361326, 'support': 307092}}
[[45617 41061 19478]
 [36494 38710 21900]
 [35263 42401 26168]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945985
{'0': {'precision': 0.3818598480279822, 'recall': 0.4858187770133756, 'f1-score': 0.4276115119249947, 'support': 39101}, '1': {'precision': 0.3276092113065823, 'recall': 0.3556026390602371, 'f1-score': 0.34103243396177885, 'support': 37286}, '2': {'precision': 0.36334162373423345, 'recall': 0.22508047431700004, 'f1-score': 0.2779674838183579, 'support': 36347}, 'accuracy': 0.3586850462149839, 'macro avg': {'precision': 0.35760356102293267, 'recall': 0.3555006301302042, 'f1-score': 0.34887047656837716, 'support': 112734}, 'weighted avg': {'precision': 0.35794628921521054, 'recall': 0.3586850462149839, 'f1-score': 0.3507287703339184, 'support': 112734}}
[[18996 13458  6647]
 [16339 13259  7688]
 [14411 13755  8181]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
3337/3337 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941875
{'0': {'precision': 0.3446858499734493, 'recall': 0.5049259366618111, 'f1-score': 0.40969494159485426, 'support': 272537}, '1': {'precision': 0.37090061529812285, 'recall': 0.2903320446801033, 'f1-score': 0.3257078499908289, 'support': 327215}, '2': {'precision': 0.34271504009584747, 'recall': 0.2677479362407529, 'f1-score': 0.3006283698152867, 'support': 254269}, 'accuracy': 0.3520897027122284, 'macro avg': {'precision': 0.3527671684558065, 'recall': 0.35433530586088907, 'f1-score': 0.34534372046698997, 'support': 854021}, 'weighted avg': {'precision': 0.3541431684456474, 'recall': 0.3520897027122284, 'f1-score': 0.34504303687701937, 'support': 854021}}
[[137611  81297  53629]
 [155274  95001  76940]
 [106351  79838  68080]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998555
{'0': {'precision': 0.3511260381353262, 'recall': 0.46437381246041537, 'f1-score': 0.3998866139924075, 'support': 119996}, '1': {'precision': 0.3138471821067959, 'recall': 0.33748299494340206, 'f1-score': 0.325236234106763, 'support': 116877}, '2': {'precision': 0.3960405731135827, 'recall': 0.25046234320955174, 'f1-score': 0.30686095126136465, 'support': 129233}, 'accuracy': 0.3483553943393443, 'macro avg': {'precision': 0.3536712644519016, 'recall': 0.35077305020445637, 'f1-score': 0.34399459978684505, 'support': 366106}, 'weighted avg': {'precision': 0.3550795358731357, 'recall': 0.3483553943393443, 'f1-score': 0.34321751290798025, 'support': 366106}}
[[55723 41653 22620]
 [50692 39444 26741]
 [52283 44582 32368]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017176
{'0': {'precision': 0.35631366087477534, 'recall': 0.4400406974055404, 'f1-score': 0.39377573613094136, 'support': 43246}, '1': {'precision': 0.3117816417673596, 'recall': 0.3472804403817989, 'f1-score': 0.32857501224421537, 'support': 39602}, '2': {'precision': 0.3666501556750637, 'recall': 0.24136485384884127, 'f1-score': 0.2910995940954227, 'support': 42935}, 'accuracy': 0.34301932693607246, 'macro avg': {'precision': 0.34491515277239954, 'recall': 0.3428953305453935, 'f1-score': 0.33781678082352645, 'support': 125783}, 'weighted avg': {'precision': 0.34582130804139166, 'recall': 0.34301932693607246, 'f1-score': 0.3382000285579218, 'support': 125783}}
[[19030 15565  8651]
 [16599 13753  9250]
 [17779 14793 10363]]
testing model on single stock: results/universal/W9/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
10303/10303 - 150s - 150s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971934
{'0': {'precision': 0.31665652031740726, 'recall': 0.3729928625480072, 'f1-score': 0.34252367911052073, 'support': 807431}, '1': {'precision': 0.3824389265686436, 'recall': 0.528058954063772, 'f1-score': 0.44360410683622586, 'support': 1011228}, '2': {'precision': 0.3127462911950575, 'recall': 0.11079518042858277, 'f1-score': 0.16362403251088115, 'support': 818745}, 'accuracy': 0.3510523984948836, 'macro avg': {'precision': 0.3372805793603694, 'recall': 0.3372823323467873, 'f1-score': 0.3165839394858759, 'support': 2637404}, 'weighted avg': {'precision': 0.3406647991271182, 'recall': 0.3510523984948836, 'f1-score': 0.32574284750982074, 'support': 2637404}}
[[301166 421831  84434]
 [362334 533988 114906]
 [287581 440451  90713]]
Evaluating performance on  train set...
3419/3419 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022416
{'0': {'precision': 0.3293394567250626, 'recall': 0.3681461052719328, 'f1-score': 0.3476632203211924, 'support': 287902}, '1': {'precision': 0.33068508847893213, 'recall': 0.5226363903433736, 'f1-score': 0.40507139518281743, 'support': 289335}, '2': {'precision': 0.3266940152430136, 'recall': 0.10532128075940614, 'f1-score': 0.15928987894740848, 'support': 297917}, 'accuracy': 0.3297522493184057, 'macro avg': {'precision': 0.32890618681566947, 'recall': 0.3320345921249042, 'f1-score': 0.3040081648171394, 'support': 875154}, 'weighted avg': {'precision': 0.3288837842074237, 'recall': 0.3297522493184057, 'f1-score': 0.30251753571200896, 'support': 875154}}
[[105990 151208  30704]
 [104155 151217  33963]
 [111681 154859  31377]]
Evaluating performance on  val set...
1396/1396 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001679
{'0': {'precision': 0.33839464080246784, 'recall': 0.40411039738337295, 'f1-score': 0.368344417167072, 'support': 118626}, '1': {'precision': 0.34386415243360646, 'recall': 0.5109119061201206, 'f1-score': 0.4110650685829683, 'support': 122710}, '2': {'precision': 0.3175084883266729, 'recall': 0.09114983179504874, 'f1-score': 0.14163835105990843, 'support': 115930}, 'accuracy': 0.3392402299687068, 'macro avg': {'precision': 0.3332557605209157, 'recall': 0.33539071176618074, 'f1-score': 0.30701594560331624, 'support': 357266}, 'weighted avg': {'precision': 0.33349585982621516, 'recall': 0.3392402299687068, 'f1-score': 0.30945333010992454, 'support': 357266}}
[[47938 60156 10532]
 [47834 62694 12182]
 [45891 59472 10567]]
training model: results/universal/W9/deepVOL_L3/h500
Epoch 1/50
6697/6697 - 387s - loss: 3.2770 - accuracy500: 0.3708 - val_loss: 3.3284 - val_accuracy500: 0.3378 - 387s/epoch - 58ms/step
Epoch 2/50
6697/6697 - 389s - loss: 3.2684 - accuracy500: 0.3771 - val_loss: 3.3365 - val_accuracy500: 0.3438 - 389s/epoch - 58ms/step
Epoch 3/50
6697/6697 - 385s - loss: 3.2662 - accuracy500: 0.3778 - val_loss: 3.3339 - val_accuracy500: 0.3449 - 385s/epoch - 58ms/step
Epoch 4/50
6697/6697 - 382s - loss: 3.2653 - accuracy500: 0.3782 - val_loss: 3.3323 - val_accuracy500: 0.3472 - 382s/epoch - 57ms/step
Epoch 5/50
6697/6697 - 390s - loss: 3.2663 - accuracy500: 0.3776 - val_loss: 3.3245 - val_accuracy500: 0.3480 - 390s/epoch - 58ms/step
Epoch 6/50
6697/6697 - 384s - loss: 3.2656 - accuracy500: 0.3780 - val_loss: 3.3198 - val_accuracy500: 0.3484 - 384s/epoch - 57ms/step
Epoch 7/50
6697/6697 - 386s - loss: 3.2603 - accuracy500: 0.3813 - val_loss: 3.3523 - val_accuracy500: 0.3463 - 386s/epoch - 58ms/step
Epoch 8/50
6697/6697 - 387s - loss: 3.2513 - accuracy500: 0.3897 - val_loss: 3.3550 - val_accuracy500: 0.3450 - 387s/epoch - 58ms/step
Epoch 9/50
6697/6697 - 388s - loss: 3.2440 - accuracy500: 0.3927 - val_loss: 3.3747 - val_accuracy500: 0.3441 - 388s/epoch - 58ms/step
Epoch 10/50
6697/6697 - 382s - loss: 3.2397 - accuracy500: 0.3958 - val_loss: 3.3464 - val_accuracy500: 0.3472 - 382s/epoch - 57ms/step
Epoch 11/50
6697/6697 - 389s - loss: 3.2384 - accuracy500: 0.3967 - val_loss: 3.3506 - val_accuracy500: 0.3467 - 389s/epoch - 58ms/step
Epoch 12/50
6697/6697 - 388s - loss: 3.2334 - accuracy500: 0.3994 - val_loss: 3.3575 - val_accuracy500: 0.3449 - 388s/epoch - 58ms/step
Epoch 13/50
6697/6697 - 382s - loss: 3.2282 - accuracy500: 0.4025 - val_loss: 3.3727 - val_accuracy500: 0.3455 - 382s/epoch - 57ms/step
Epoch 14/50
6697/6697 - 385s - loss: 3.2226 - accuracy500: 0.4052 - val_loss: 3.3577 - val_accuracy500: 0.3468 - 385s/epoch - 57ms/step
Epoch 15/50
6697/6697 - 387s - loss: 3.2176 - accuracy500: 0.4085 - val_loss: 3.3786 - val_accuracy500: 0.3444 - 387s/epoch - 58ms/step
Epoch 16/50
6697/6697 - 387s - loss: 3.2122 - accuracy500: 0.4111 - val_loss: 3.3855 - val_accuracy500: 0.3470 - 387s/epoch - 58ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 529s - 529s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1142223
{'0': {'precision': 0.31437838929779605, 'recall': 0.6092097956484379, 'f1-score': 0.41473547934471405, 'support': 1348803}, '1': {'precision': 0.3409090909090909, 'recall': 9.424898949375098e-06, 'f1-score': 1.8849276784665234e-05, 'support': 1591529}, '2': {'precision': 0.33237303044435657, 'recall': 0.41174844445224534, 'f1-score': 0.3678272510072604, 'support': 1367364}, 'accuracy': 0.3214546708959964, 'macro avg': {'precision': 0.32922017021708117, 'recall': 0.34032255499987757, 'f1-score': 0.2608605265429197, 'support': 4307696}, 'weighted avg': {'precision': 0.329892391562916, 'recall': 0.3214546708959964, 'f1-score': 0.24662376341401804, 'support': 4307696}}
[[821704     14 527085]
 [987699     15 603815]
 [804339     15 563010]]
Evaluating performance on  train set...
6697/6697 - 205s - 205s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027106
{'0': {'precision': 0.3488808535609909, 'recall': 0.6264351327807539, 'f1-score': 0.44816495758445013, 'support': 575121}, '1': {'precision': 0.4074074074074074, 'recall': 1.9546451252927524e-05, 'f1-score': 3.90910270101228e-05, 'support': 562762}, '2': {'precision': 0.36142113204445514, 'recall': 0.427412943786212, 'f1-score': 0.3916566860552966, 'support': 576122}, 'accuracy': 0.3538665289774534, 'macro avg': {'precision': 0.37256979767095116, 'recall': 0.3512892076727396, 'f1-score': 0.27995357822225225, 'support': 1714005}, 'weighted avg': {'precision': 0.3723120867348541, 'recall': 0.3538665289774534, 'f1-score': 0.2820371648851773, 'support': 1714005}}
[[360276      9 214836]
 [342513     11 220238]
 [329873      7 246242]]
Evaluating performance on  val set...
2631/2631 - 85s - 85s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056006
{'0': {'precision': 0.3481426909838609, 'recall': 0.646783378662653, 'f1-score': 0.45264248832327997, 'support': 227226}, '1': {'precision': 0.15, 'recall': 1.3306778916739484e-05, 'f1-score': 2.6611197104701758e-05, 'support': 225449}, '2': {'precision': 0.34869667537544125, 'recall': 0.39701534562860763, 'f1-score': 0.3712905979638903, 'support': 220193}, 'accuracy': 0.3483432114471189, 'macro avg': {'precision': 0.28227978878643406, 'recall': 0.3479373436900592, 'f1-score': 0.2746532324947583, 'support': 672868}, 'weighted avg': {'precision': 0.2819349235547586, 'recall': 0.3483432114471189, 'f1-score': 0.27436842316321264, 'support': 672868}}
[[146966      9  80251]
 [142412      3  83034]
 [132765      8  87420]]
testing model out of sample: results/universal/W9/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 271s - 271s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173071
{'0': {'precision': 0.3143703272162346, 'recall': 0.5701957918187461, 'f1-score': 0.4052894041362001, 'support': 681387}, '1': {'precision': 0.2413793103448276, 'recall': 7.794996057959137e-06, 'f1-score': 1.558948867590678e-05, 'support': 898012}, '2': {'precision': 0.3108439935982021, 'recall': 0.47982388531654907, 'f1-score': 0.37727692426388054, 'support': 631861}, 'accuracy': 0.31281396127094957, 'macro avg': {'precision': 0.2888645437197548, 'recall': 0.35000915737711774, 'f1-score': 0.2608606392962522, 'support': 2211260}, 'weighted avg': {'precision': 0.2837203983390562, 'recall': 0.31281396127094957, 'f1-score': 0.23269968497886165, 'support': 2211260}}
[[388524      7 292856]
 [518692      7 379313]
 [328664     15 303182]]
Evaluating performance on  train set...
3947/3947 - 129s - 129s/epoch - 33ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10594
{'0': {'precision': 0.341119556997786, 'recall': 0.5989898687129069, 'f1-score': 0.43468803327239053, 'support': 333620}, '1': {'precision': 0.36363636363636365, 'recall': 1.207004245637434e-05, 'f1-score': 2.413928366675719e-05, 'support': 331399}, '2': {'precision': 0.3657379656681125, 'recall': 0.44979234325616224, 'f1-score': 0.40343353225607026, 'support': 344559}, 'accuracy': 0.35145278522313284, 'macro avg': {'precision': 0.35683129543408737, 'recall': 0.3495980940038419, 'f1-score': 0.27938190160404247, 'support': 1009578}, 'weighted avg': {'precision': 0.3569128305004346, 'recall': 0.35145278522313284, 'f1-score': 0.28134059561066316, 'support': 1009578}}
[[199835      4 133781]
 [196410      4 134985]
 [189576      3 154980]]
Evaluating performance on  val set...
1402/1402 - 47s - 47s/epoch - 34ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095595
{'0': {'precision': 0.3348959208069472, 'recall': 0.579441728487915, 'f1-score': 0.42446610694765313, 'support': 117004}, '1': {'precision': 0.5, 'recall': 2.421522491908079e-05, 'f1-score': 4.842810444327858e-05, 'support': 123889}, '2': {'precision': 0.3502573911703917, 'recall': 0.4650060929364545, 'f1-score': 0.39955627638270064, 'support': 117349}, 'accuracy': 0.34157915598952665, 'macro avg': {'precision': 0.39505110399244625, 'recall': 0.34815734554976285, 'f1-score': 0.27469027047826566, 'support': 358242}, 'weighted avg': {'precision': 0.39702496333358556, 'recall': 0.34157915598952665, 'f1-score': 0.2695322200187809, 'support': 358242}}
[[67797     0 49207]
 [71867     3 52019]
 [62778     3 54568]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
295/295 - 8s - 8s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0888785
{'0': {'precision': 0.4127770129235689, 'recall': 0.6373080087767417, 'f1-score': 0.5010377078784939, 'support': 29168}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21727}, '2': {'precision': 0.3719512195121951, 'recall': 0.46100739409289593, 'f1-score': 0.4117185647312064, 'support': 24479}, 'accuracy': 0.3963435667471542, 'macro avg': {'precision': 0.261576077478588, 'recall': 0.3661051342898792, 'f1-score': 0.30425209086990007, 'support': 75374}, 'weighted avg': {'precision': 0.280532727669935, 'recall': 0.3963435667471542, 'f1-score': 0.32760270928244634, 'support': 75374}}
[[18589     0 10579]
 [13251     0  8476]
 [13194     0 11285]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10933
{'0': {'precision': 0.32976641414141417, 'recall': 0.6273344142196601, 'f1-score': 0.4322926365009414, 'support': 16653}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 17090}, '2': {'precision': 0.337189572728675, 'recall': 0.3772000460140343, 'f1-score': 0.35607438577439937, 'support': 17386}, 'accuracy': 0.3325901151988109, 'macro avg': {'precision': 0.22231866229002972, 'recall': 0.3348448200778981, 'f1-score': 0.2627890074251136, 'support': 51129}, 'weighted avg': {'precision': 0.22206532508278498, 'recall': 0.3325901151988109, 'f1-score': 0.26188031345662705, 'support': 51129}}
[[10447     0  6206]
 [10405     0  6685]
 [10828     0  6558]]
Evaluating performance on  val set...
53/53 - 1s - 917ms/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108204
{'0': {'precision': 0.32839366515837104, 'recall': 0.6573822463768116, 'f1-score': 0.437990343995172, 'support': 4416}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4689}, '2': {'precision': 0.3288793103448276, 'recall': 0.3488, 'f1-score': 0.338546866333888, 'support': 4375}, 'accuracy': 0.3285608308605341, 'macro avg': {'precision': 0.21909099183439953, 'recall': 0.3353940821256039, 'f1-score': 0.2588457367763533, 'support': 13480}, 'weighted avg': {'precision': 0.21431998576394565, 'recall': 0.3285608308605341, 'f1-score': 0.2533611201256261, 'support': 13480}}
[[2903    0 1513]
 [3088    0 1601]
 [2849    0 1526]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109759
{'0': {'precision': 0.3191487431213055, 'recall': 0.7831609649659902, 'f1-score': 0.45349294449064315, 'support': 89827}, '1': {'precision': 0.8571428571428571, 'recall': 5.997660912244225e-05, 'f1-score': 0.00011994482538032504, 'support': 100039}, '2': {'precision': 0.41362993168297246, 'recall': 0.28232129690209884, 'f1-score': 0.33558828249410544, 'support': 96291}, 'accuracy': 0.34086183458730696, 'macro avg': {'precision': 0.5299738439823783, 'recall': 0.3551807461590705, 'f1-score': 0.2630670572700429, 'support': 286157}, 'weighted avg': {'precision': 0.5390213350914249, 'recall': 0.34086183458730696, 'f1-score': 0.25532152348112097, 'support': 286157}}
[[70349     0 19478]
 [80973     6 19060]
 [69105     1 27185]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0848529
{'0': {'precision': 0.3924031182454235, 'recall': 0.8179799273969678, 'f1-score': 0.5303740420494429, 'support': 46830}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 40756}, '2': {'precision': 0.42400455782743557, 'recall': 0.3217794432033821, 'f1-score': 0.3658859679071355, 'support': 41631}, 'accuracy': 0.4001176315809839, 'macro avg': {'precision': 0.2721358920242864, 'recall': 0.3799197902001166, 'f1-score': 0.29875333665219284, 'support': 129217}, 'weighted avg': {'precision': 0.2788175841750478, 'recall': 0.4001176315809839, 'f1-score': 0.31009553788679023, 'support': 129217}}
[[38306     2  8522]
 [31080     0  9676]
 [28233     2 13396]]
Evaluating performance on  val set...
187/187 - 5s - 5s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014746
{'0': {'precision': 0.3588441817584805, 'recall': 0.86155245603396, 'f1-score': 0.5066600096289297, 'support': 16490}, '1': {'precision': 1.0, 'recall': 6.602839220864973e-05, 'f1-score': 0.0001320480654958405, 'support': 15145}, '2': {'precision': 0.4410655638000243, 'recall': 0.22413153665471627, 'f1-score': 0.2972252961186934, 'support': 16178}, 'accuracy': 0.37299479221132326, 'macro avg': {'precision': 0.5999699151861683, 'recall': 0.3619166736936283, 'f1-score': 0.26800578460437297, 'support': 47813}, 'weighted avg': {'precision': 0.5897538169191253, 'recall': 0.37299479221132326, 'f1-score': 0.275350516958593, 'support': 47813}}
[[14207     0  2283]
 [12832     1  2312]
 [12552     0  3626]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
508/508 - 16s - 16s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1093012
{'0': {'precision': 0.32102403976358507, 'recall': 0.4898509857306075, 'f1-score': 0.3878623397620972, 'support': 41137}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 44148}, '2': {'precision': 0.35511566897209634, 'recall': 0.5344819850136852, 'f1-score': 0.4267163403843743, 'support': 44574}, 'accuracy': 0.33863652114986253, 'macro avg': {'precision': 0.2253799029118938, 'recall': 0.3414443235814309, 'f1-score': 0.2715262267154905, 'support': 129859}, 'weighted avg': {'precision': 0.22358782797123666, 'recall': 0.33863652114986253, 'f1-score': 0.269337875904531, 'support': 129859}}
[[20151     0 20986]
 [21870     0 22278]
 [20750     0 23824]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1107873
{'0': {'precision': 0.33083246346555323, 'recall': 0.4482850070721358, 'f1-score': 0.38070570570570567, 'support': 22624}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 22107}, '2': {'precision': 0.3355680626827788, 'recall': 0.5485995218979748, 'f1-score': 0.41641987777530515, 'support': 22171}, 'accuracy': 0.33339810469044273, 'macro avg': {'precision': 0.22213350871611068, 'recall': 0.33229484299003686, 'f1-score': 0.2657085278270036, 'support': 66902}, 'weighted avg': {'precision': 0.22308201804407288, 'recall': 0.33339810469044273, 'f1-score': 0.26674136791190356, 'support': 66902}}
[[10142     0 12482]
 [10506     0 11601]
 [10008     0 12163]]
Evaluating performance on  val set...
73/73 - 11s - 11s/epoch - 151ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1115404
{'0': {'precision': 0.33350515463917524, 'recall': 0.4085240726124704, 'f1-score': 0.3672224192976233, 'support': 6335}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6340}, '2': {'precision': 0.32632641821185976, 'recall': 0.5945810336176618, 'f1-score': 0.4213832750548213, 'support': 5979}, 'accuracy': 0.3293127479360995, 'macro avg': {'precision': 0.21994385761701166, 'recall': 0.3343683687433774, 'f1-score': 0.2628685647841482, 'support': 18654}, 'weighted avg': {'precision': 0.21785465900760612, 'recall': 0.3293127479360995, 'f1-score': 0.259772950991917, 'support': 18654}}
[[2588    0 3747]
 [2748    0 3592]
 [2424    0 3555]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
604/604 - 17s - 17s/epoch - 28ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1181294
{'0': {'precision': 0.30075322940825894, 'recall': 0.9130842343913499, 'f1-score': 0.45247084622904954, 'support': 45872}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 58371}, '2': {'precision': 0.3289534499834929, 'recall': 0.0993043512926309, 'f1-score': 0.15255534801114615, 'support': 50169}, 'accuracy': 0.30351915654223766, 'macro avg': {'precision': 0.2099022264639173, 'recall': 0.33746286189466024, 'f1-score': 0.2016753980800652, 'support': 154412}, 'weighted avg': {'precision': 0.19622450179803066, 'recall': 0.30351915654223766, 'f1-score': 0.183983705363509, 'support': 154412}}
[[41885     0  3987]
 [52195     0  6176]
 [45187     0  4982]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097156
{'0': {'precision': 0.34091207090971076, 'recall': 0.9170428893905191, 'f1-score': 0.4970463973694776, 'support': 28352}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 27258}, '2': {'precision': 0.29517977704506204, 'recall': 0.06956521739130435, 'f1-score': 0.11259507695993294, 'support': 27025}, 'accuracy': 0.33738730562110486, 'macro avg': {'precision': 0.21203061598492426, 'recall': 0.32886936892727453, 'f1-score': 0.20321382477647018, 'support': 82635}, 'weighted avg': {'precision': 0.21350242039178222, 'recall': 0.33738730562110486, 'f1-score': 0.20735936846447167, 'support': 82635}}
[[26000     0  2352]
 [25121     0  2137]
 [25145     0  1880]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1110932
{'0': {'precision': 0.33925198337740836, 'recall': 0.9292218543046358, 'f1-score': 0.4970388000221398, 'support': 9664}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9175}, '2': {'precision': 0.28891149542217703, 'recall': 0.05918516202980098, 'f1-score': 0.0982444002421517, 'support': 9597}, 'accuracy': 0.3357715571810381, 'macro avg': {'precision': 0.20938782626652844, 'recall': 0.3294690054448122, 'f1-score': 0.1984277334214305, 'support': 28436}, 'weighted avg': {'precision': 0.2128011952780246, 'recall': 0.3357715571810381, 'f1-score': 0.20207604700161377, 'support': 28436}}
[[8980    0  684]
 [8461    0  714]
 [9029    0  568]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
631/631 - 19s - 19s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033819
{'0': {'precision': 0.40078611862328456, 'recall': 0.3942042394303369, 'f1-score': 0.3974679327003165, 'support': 60527}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 48769}, '2': {'precision': 0.3297175141242938, 'recall': 0.6451780358378836, 'f1-score': 0.43640879918328596, 'support': 52012}, 'accuracy': 0.35594638827584496, 'macro avg': {'precision': 0.24350121091585944, 'recall': 0.34646075842274016, 'f1-score': 0.2779589106278675, 'support': 161308}, 'weighted avg': {'precision': 0.2566992879866114, 'recall': 0.35594638827584496, 'f1-score': 0.2898556551793657, 'support': 161308}}
[[23860     0 36667]
 [17218     0 31551]
 [18455     0 33557]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107526
{'0': {'precision': 0.32778315585672796, 'recall': 0.4261156275955803, 'f1-score': 0.3705365447959641, 'support': 39731}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 40251}, '2': {'precision': 0.34999501999117827, 'recall': 0.58637869794274, 'f1-score': 0.4383498173393924, 'support': 41949}, 'accuracy': 0.34058606917026846, 'macro avg': {'precision': 0.22592605861596873, 'recall': 0.33749810851277345, 'f1-score': 0.26962878737845214, 'support': 121931}, 'weighted avg': {'precision': 0.22721944098673508, 'recall': 0.34058606917026846, 'f1-score': 0.27154803904551444, 'support': 121931}}
[[16930     0 22801]
 [17369     0 22882]
 [17351     0 24598]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1110969
{'0': {'precision': 0.3365746549560853, 'recall': 0.4084507042253521, 'f1-score': 0.36904557179707653, 'support': 15762}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15991}, '2': {'precision': 0.32929686092190147, 'recall': 0.6042190186483269, 'f1-score': 0.4262753971401246, 'support': 15122}, 'accuracy': 0.33226666666666665, 'macro avg': {'precision': 0.22195717195932893, 'recall': 0.3375565742912263, 'f1-score': 0.2651069896457337, 'support': 46875}, 'weighted avg': {'precision': 0.21940729263528125, 'recall': 0.33226666666666665, 'f1-score': 0.26161136764199433, 'support': 46875}}
[[6438    0 9324]
 [6705    0 9286]
 [5985    0 9137]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007652
{'0': {'precision': 0.34946065322556413, 'recall': 0.5932364192807957, 'f1-score': 0.439829066293537, 'support': 196050}, '1': {'precision': 0.19047619047619047, 'recall': 1.917453621590528e-05, 'f1-score': 3.83452123605792e-05, 'support': 208610}, '2': {'precision': 0.3686908970844107, 'recall': 0.5026299551896096, 'f1-score': 0.42536589959188736, 'support': 197722}, 'accuracy': 0.3580601678004987, 'macro avg': {'precision': 0.30287591359538846, 'recall': 0.3652951830022071, 'f1-score': 0.28841110369926165, 'support': 602382}, 'weighted avg': {'precision': 0.300714995988316, 'recall': 0.3580601678004987, 'f1-score': 0.2827785093855819, 'support': 602382}}
[[116304      5  79741]
 [118177      4  90429]
 [ 98329     12  99381]]
Evaluating performance on  train set...
1250/1250 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933325
{'0': {'precision': 0.37355426266722025, 'recall': 0.6558834388934648, 'f1-score': 0.4760036552771346, 'support': 105627}, '1': {'precision': 0.29411764705882354, 'recall': 4.738528023654732e-05, 'f1-score': 9.47552944520775e-05, 'support': 105518}, '2': {'precision': 0.3910928282910936, 'recall': 0.48339493573122966, 'f1-score': 0.43237264230467165, 'support': 108762}, 'accuracy': 0.3809200798982204, 'macro avg': {'precision': 0.3529215793390457, 'recall': 0.37977525330164363, 'f1-score': 0.3028236842920861, 'support': 319907}, 'weighted avg': {'precision': 0.35331568291940885, 'recall': 0.3809200798982204, 'f1-score': 0.3041963752198564, 'support': 319907}}
[[69279     4 36344]
 [60001     5 45512]
 [56179     8 52575]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000233
{'0': {'precision': 0.3655742757345387, 'recall': 0.6653733785205095, 'f1-score': 0.47188310665771566, 'support': 42785}, '1': {'precision': 0.5, 'recall': 2.338196782641227e-05, 'f1-score': 4.676174888940847e-05, 'support': 42768}, '2': {'precision': 0.3669504564570725, 'recall': 0.43556713583012713, 'f1-score': 0.39832537217044683, 'support': 41066}, 'accuracy': 0.3661061925935286, 'macro avg': {'precision': 0.4108415773972038, 'recall': 0.36698796543948764, 'f1-score': 0.29008508019235063, 'support': 126619}, 'weighted avg': {'precision': 0.4114254798424279, 'recall': 0.3661061925935286, 'f1-score': 0.28865453335106456, 'support': 126619}}
[[28468     1 14316]
 [26225     1 16542]
 [23179     0 17887]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
3870/3870 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050746
{'0': {'precision': 0.3500979493415293, 'recall': 0.6019042831586262, 'f1-score': 0.44269949804699393, 'support': 338185}, '1': {'precision': 0.2631578947368421, 'recall': 1.4846972256947641e-05, 'f1-score': 2.9692269320759646e-05, 'support': 336769}, '2': {'precision': 0.34946097308286256, 'recall': 0.45295872605655213, 'f1-score': 0.3945351724137931, 'support': 315744}, 'accuracy': 0.349833147942158, 'macro avg': {'precision': 0.3209056057204113, 'recall': 0.35162595206247843, 'f1-score': 0.27908812091003593, 'support': 990698}, 'weighted avg': {'precision': 0.32034131646149683, 'recall': 0.349833147942158, 'f1-score': 0.2768719051229438, 'support': 990698}}
[[203555      4 134626]
 [205153      5 131611]
 [172715     10 143019]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990703
{'0': {'precision': 0.3608938460094484, 'recall': 0.6729134156834721, 'f1-score': 0.4698173820518172, 'support': 137138}, '1': {'precision': 0.35714285714285715, 'recall': 3.7776333882349386e-05, 'f1-score': 7.554467712204998e-05, 'support': 132358}, '2': {'precision': 0.3735858503843239, 'recall': 0.4119942692554509, 'f1-score': 0.39185113162956076, 'support': 134014}, 'accuracy': 0.365542365740626, 'macro avg': {'precision': 0.3638741845122098, 'recall': 0.3616484870909351, 'f1-score': 0.28724801945283335, 'support': 403510}, 'weighted avg': {'precision': 0.36387873582603353, 'recall': 0.365542365740626, 'f1-score': 0.2898400352814071, 'support': 403510}}
[[92282     6 44850]
 [84624     5 47729]
 [78798     3 55213]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057361
{'0': {'precision': 0.34026466957116186, 'recall': 0.665808177607411, 'f1-score': 0.45036698920302237, 'support': 50088}, '1': {'precision': 0.3333333333333333, 'recall': 1.9330768784674565e-05, 'f1-score': 3.865929562763366e-05, 'support': 51731}, '2': {'precision': 0.37808001731664204, 'recall': 0.4059576610950785, 'f1-score': 0.39152322334195705, 'support': 51631}, 'accuracy': 0.35392636037797326, 'macro avg': {'precision': 0.3505593400737124, 'recall': 0.35726172315709137, 'f1-score': 0.28064295728020233, 'support': 153450}, 'weighted avg': {'precision': 0.35065163121683, 'recall': 0.35392636037797326, 'f1-score': 0.2787534518318128, 'support': 153450}}
[[33349     0 16739]
 [33991     1 17739]
 [30669     2 20960]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
2451/2451 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068153
{'0': {'precision': 0.3478718517951466, 'recall': 0.6545788469156253, 'f1-score': 0.4543057447420052, 'support': 222152}, '1': {'precision': 0.375, 'recall': 1.5800617277448307e-05, 'f1-score': 3.159990309363052e-05, 'support': 189866}, '2': {'precision': 0.3506786357534266, 'recall': 0.3408971637957859, 'f1-score': 0.34571872645064056, 'support': 215323}, 'accuracy': 0.3488087021253194, 'macro avg': {'precision': 0.3578501625161911, 'recall': 0.3318306037762295, 'f1-score': 0.26668535703191315, 'support': 627341}, 'weighted avg': {'precision': 0.35704561555251535, 'recall': 0.3488087021253194, 'f1-score': 0.27954832043283956, 'support': 627341}}
[[145416      2  76734]
 [130683      3  59180]
 [141917      3  73403]]
Evaluating performance on  train set...
1200/1200 - 31s - 31s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099669
{'0': {'precision': 0.3592483027220295, 'recall': 0.6432313994474612, 'f1-score': 0.4610163936664869, 'support': 104970}, '1': {'precision': 0.3333333333333333, 'recall': 9.961151509114453e-06, 'f1-score': 1.992170768878308e-05, 'support': 100390}, '2': {'precision': 0.36724553260422527, 'recall': 0.430090826878465, 'f1-score': 0.3961914765498725, 'support': 101732}, 'accuracy': 0.3623506962083024, 'macro avg': {'precision': 0.35327572288652936, 'recall': 0.35777739582581175, 'f1-score': 0.28574259730801604, 'support': 307092}, 'weighted avg': {'precision': 0.3534258469545212, 'recall': 0.3623506962083024, 'f1-score': 0.2888393122444663, 'support': 307092}}
[[67520     2 37448]
 [62450     1 37939]
 [57978     0 43754]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983719
{'0': {'precision': 0.3668639053254438, 'recall': 0.6240829306157197, 'f1-score': 0.46209038238702205, 'support': 39937}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 35719}, '2': {'precision': 0.36821073780555863, 'recall': 0.4448460003236421, 'f1-score': 0.40291671246931227, 'support': 37078}, 'accuracy': 0.36739581670126137, 'macro avg': {'precision': 0.2450248810436675, 'recall': 0.3563096436464539, 'f1-score': 0.28833569828544475, 'support': 112734}, 'weighted avg': {'precision': 0.251068546519566, 'recall': 0.36739581670126137, 'f1-score': 0.2962180838640309, 'support': 112734}}
[[24924     1 15012]
 [22430     0 13289]
 [20584     0 16494]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
3337/3337 - 49s - 49s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1377828
{'0': {'precision': 0.2511029049324702, 'recall': 0.5756980741159298, 'f1-score': 0.3496838113107173, 'support': 212370}, '1': {'precision': 0.3333333333333333, 'recall': 4.478290367869162e-06, 'f1-score': 8.956460406847213e-06, 'support': 446599}, '2': {'precision': 0.24942048763479963, 'recall': 0.4694491725283514, 'f1-score': 0.32576209018252456, 'support': 195052}, 'accuracy': 0.2503802599701881, 'macro avg': {'precision': 0.2779522419668677, 'recall': 0.34838390831154964, 'f1-score': 0.22515161931788288, 'support': 854021}, 'weighted avg': {'precision': 0.2937199696588081, 'recall': 0.2503802599701881, 'f1-score': 0.161362423369683, 'support': 854021}}
[[122261      1  90108]
 [261153      2 185444]
 [103482      3  91567]]
Evaluating performance on  train set...
1431/1431 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117203
{'0': {'precision': 0.3245454882067612, 'recall': 0.5968980370124453, 'f1-score': 0.4204719215662759, 'support': 117474}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 119593}, '2': {'precision': 0.37667279803796117, 'recall': 0.43799936453320315, 'f1-score': 0.4050278228652714, 'support': 129039}, 'accuracy': 0.3459080157112967, 'macro avg': {'precision': 0.2337394287482408, 'recall': 0.34496580051521614, 'f1-score': 0.2751665814771824, 'support': 366106}, 'weighted avg': {'precision': 0.23690171116458494, 'recall': 0.3459080157112967, 'f1-score': 0.27767614775171245, 'support': 366106}}
[[70120     1 47353]
 [73417     0 46176]
 [72519     1 56519]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1136312
{'0': {'precision': 0.3264907989750757, 'recall': 0.555057792738163, 'f1-score': 0.41114299071417443, 'support': 40403}, '1': {'precision': 0.6, 'recall': 6.646284726837697e-05, 'f1-score': 0.00013291097180072214, 'support': 45138}, '2': {'precision': 0.33867577509196006, 'recall': 0.48046816758610406, 'f1-score': 0.3972999630131919, 'support': 40242}, 'accuracy': 0.3320321506085878, 'macro avg': {'precision': 0.42172219135567857, 'recall': 0.3451974743905118, 'f1-score': 0.2695252882330557, 'support': 125783}, 'weighted avg': {'precision': 0.4285396141946101, 'recall': 0.3320321506085878, 'f1-score': 0.25922067927181575, 'support': 125783}}
[[22426     2 17975]
 [25355     3 19780]
 [20907     0 19335]]
testing model on single stock: results/universal/W9/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
10303/10303 - 149s - 149s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1192975
{'0': {'precision': 0.29778948124577637, 'recall': 0.5632279199196882, 'f1-score': 0.3895934039637131, 'support': 794902}, '1': {'precision': 0.4, 'recall': 1.933033906381235e-06, 'f1-score': 3.866049129752341e-06, 'support': 1034643}, '2': {'precision': 0.3155877105800868, 'recall': 0.4429745784846118, 'f1-score': 0.36858497999289325, 'support': 807859}, 'accuracy': 0.3054420179843513, 'macro avg': {'precision': 0.3377923972752877, 'recall': 0.33540147714606877, 'f1-score': 0.25272741666857873, 'support': 2637404}, 'weighted avg': {'precision': 0.3433380045312544, 'recall': 0.3054420179843513, 'f1-score': 0.23032393570735163, 'support': 2637404}}
[[447711      2 347189]
 [605740      2 428901]
 [449997      1 357861]]
Evaluating performance on  train set...
3419/3419 - 54s - 54s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091411
{'0': {'precision': 0.3281656512432076, 'recall': 0.5510295774550532, 'f1-score': 0.4113511407643624, 'support': 289342}, '1': {'precision': 0.5, 'recall': 3.4621243595069935e-06, 'f1-score': 6.9242007741256465e-06, 'support': 288840}, '2': {'precision': 0.3455300632911392, 'recall': 0.45296863003919563, 'f1-score': 0.3920213789043603, 'support': 296972}, 'accuracy': 0.3358905975405472, 'macro avg': {'precision': 0.39123190484478226, 'recall': 0.33466722320620274, 'f1-score': 0.26779314795649894, 'support': 875154}, 'weighted avg': {'precision': 0.3907710640843879, 'recall': 0.3358905975405472, 'f1-score': 0.26902983325583774, 'support': 875154}}
[[159436      1 129905]
 [163951      1 124888]
 [162453      0 134519]]
Evaluating performance on  val set...
1396/1396 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098309
{'0': {'precision': 0.3351522577458635, 'recall': 0.596290663286861, 'f1-score': 0.42911520944684634, 'support': 118350}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 122642}, '2': {'precision': 0.3323063080257938, 'recall': 0.4192682800970122, 'f1-score': 0.37075626673156487, 'support': 116274}, 'accuracy': 0.33398364244008666, 'macro avg': {'precision': 0.22248618859055244, 'recall': 0.3385196477946244, 'f1-score': 0.2666238253928037, 'support': 357266}, 'weighted avg': {'precision': 0.219175217803021, 'recall': 0.33398364244008666, 'f1-score': 0.26281565890955266, 'support': 357266}}
[[70571     0 47779]
 [72469     0 50173]
 [67524     0 48750]]
training model: results/universal/W9/deepVOL_L3/h1000
Epoch 1/50
6697/6697 - 395s - loss: 3.2786 - accuracy1000: 0.3723 - val_loss: 3.3049 - val_accuracy1000: 0.3304 - 395s/epoch - 59ms/step
Epoch 2/50
6697/6697 - 393s - loss: 3.2817 - accuracy1000: 0.3669 - val_loss: 3.3077 - val_accuracy1000: 0.3319 - 393s/epoch - 59ms/step
Epoch 3/50
6697/6697 - 396s - loss: 3.2795 - accuracy1000: 0.3691 - val_loss: 3.3156 - val_accuracy1000: 0.3316 - 396s/epoch - 59ms/step
Epoch 4/50
6697/6697 - 396s - loss: 3.2761 - accuracy1000: 0.3715 - val_loss: 3.3125 - val_accuracy1000: 0.3323 - 396s/epoch - 59ms/step
Epoch 5/50
6697/6697 - 388s - loss: 3.2743 - accuracy1000: 0.3722 - val_loss: 3.3158 - val_accuracy1000: 0.3321 - 388s/epoch - 58ms/step
Epoch 6/50
6697/6697 - 393s - loss: 3.2706 - accuracy1000: 0.3765 - val_loss: 3.3187 - val_accuracy1000: 0.3338 - 393s/epoch - 59ms/step
Epoch 7/50
6697/6697 - 386s - loss: 3.2664 - accuracy1000: 0.3790 - val_loss: 3.3310 - val_accuracy1000: 0.3305 - 386s/epoch - 58ms/step
Epoch 8/50
6697/6697 - 386s - loss: 3.2608 - accuracy1000: 0.3835 - val_loss: 3.3349 - val_accuracy1000: 0.3310 - 386s/epoch - 58ms/step
Epoch 9/50
6697/6697 - 393s - loss: 3.2583 - accuracy1000: 0.3832 - val_loss: 3.3496 - val_accuracy1000: 0.3300 - 393s/epoch - 59ms/step
Epoch 10/50
6697/6697 - 398s - loss: 3.2521 - accuracy1000: 0.3879 - val_loss: 3.3551 - val_accuracy1000: 0.3314 - 398s/epoch - 59ms/step
Epoch 11/50
6697/6697 - 391s - loss: 3.2530 - accuracy1000: 0.3882 - val_loss: 3.3720 - val_accuracy1000: 0.3319 - 391s/epoch - 58ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 527s - 527s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022727
{'0': {'precision': 0.2881728049241595, 'recall': 0.5384797565525062, 'f1-score': 0.3754303296742267, 'support': 1258259}, '1': {'precision': 0.40475700400228704, 'recall': 0.020093986904506443, 'f1-score': 0.038287221223469045, 'support': 1761522}, '2': {'precision': 0.3069061877529008, 'recall': 0.44539197074341086, 'f1-score': 0.36340259577355305, 'support': 1287915}, 'accuracy': 0.2986677797133317, 'macro avg': {'precision': 0.3332786655597824, 'recall': 0.3346552380668079, 'f1-score': 0.25904004889041626, 'support': 4307696}, 'weighted avg': {'precision': 0.34144783553782854, 'recall': 0.2986677797133317, 'f1-score': 0.23396823448666437, 'support': 4307696}}
[[677547  25226 555486]
 [986176  35396 739950]
 [687460  26828 573627]]
Evaluating performance on  train set...
6697/6697 - 198s - 198s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100549
{'0': {'precision': 0.3383535241996432, 'recall': 0.5510521358697639, 'f1-score': 0.4192697226026762, 'support': 574403}, '1': {'precision': 0.3226873113764598, 'recall': 0.02175817214366481, 'f1-score': 0.04076747355054325, 'support': 565121}, '2': {'precision': 0.34837407872114273, 'recall': 0.4489965725585354, 'f1-score': 0.3923364048149962, 'support': 574481}, 'accuracy': 0.342333890507904, 'macro avg': {'precision': 0.3364716380990819, 'recall': 0.340602293523988, 'f1-score': 0.2841245336560719, 'support': 1714005}, 'weighted avg': {'precision': 0.3365468272093866, 'recall': 0.342333890507904, 'f1-score': 0.28544733070616796, 'support': 1714005}}
[[316526  12953 244924]
 [315278  12296 237547]
 [303685  12856 257940]]
Evaluating performance on  val set...
2631/2631 - 84s - 84s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012527
{'0': {'precision': 0.32897280226511666, 'recall': 0.546092591923063, 'f1-score': 0.41059699413165884, 'support': 221272}, '1': {'precision': 0.33387025918875385, 'recall': 0.019405576549892757, 'f1-score': 0.03667924164059169, 'support': 234984}, '2': {'precision': 0.33291880781089417, 'recall': 0.4486316547559692, 'f1-score': 0.38220926939777233, 'support': 216612}, 'accuracy': 0.33078404679669715, 'macro avg': {'precision': 0.33192062308825493, 'recall': 0.3380432744096417, 'f1-score': 0.2764951683900076, 'support': 672868}, 'weighted avg': {'precision': 0.33195344062364457, 'recall': 0.33078404679669715, 'f1-score': 0.27087596269396597, 'support': 672868}}
[[120835   4558  95879]
 [131582   4560  98842]
 [114893   4540  97179]]
testing model out of sample: results/universal/W9/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 278s - 278s/epoch - 32ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040739
{'0': {'precision': 0.28669509164022877, 'recall': 0.5231707784756168, 'f1-score': 0.3704082362604111, 'support': 677966}, '1': {'precision': 0.42981924056775445, 'recall': 0.019047076330231037, 'f1-score': 0.03647767531265475, 'support': 930064}, '2': {'precision': 0.28620922529398524, 'recall': 0.44261061286739717, 'f1-score': 0.34762840960874947, 'support': 603230}, 'accuracy': 0.2891577652560079, 'macro avg': {'precision': 0.3342411858339895, 'recall': 0.32827615589108167, 'f1-score': 0.25150477372727176, 'support': 2211260}, 'weighted avg': {'precision': 0.34676108536873007, 'recall': 0.2891577652560079, 'f1-score': 0.2237415086623919, 'support': 2211260}}
[[354692  12629 310645]
 [557120  17715 355229]
 [325363  10871 266996]]
Evaluating performance on  train set...
3947/3947 - 135s - 135s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022019
{'0': {'precision': 0.32251279522241993, 'recall': 0.5647824614192115, 'f1-score': 0.41057262272388456, 'support': 327689}, '1': {'precision': 0.33716026241799435, 'recall': 0.016772979068744153, 'f1-score': 0.03195620733782475, 'support': 343171}, '2': {'precision': 0.34765286306994475, 'recall': 0.4297025844507821, 'f1-score': 0.3843475574251661, 'support': 338718}, 'accuracy': 0.3331857469160382, 'macro avg': {'precision': 0.33577530690345303, 'recall': 0.3370860083129126, 'f1-score': 0.27562546249562514, 'support': 1009578}, 'weighted avg': {'precision': 0.33592630013848424, 'recall': 0.3331857469160382, 'f1-score': 0.27307648517700767, 'support': 1009578}}
[[185073   5479 137137]
 [201441   5756 135974]
 [187333   5837 145548]]
Evaluating performance on  val set...
1402/1402 - 48s - 48s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021099
{'0': {'precision': 0.3322177360509802, 'recall': 0.5705001294806573, 'f1-score': 0.4199102923951439, 'support': 119709}, '1': {'precision': 0.3391226499552372, 'recall': 0.016188449276477175, 'f1-score': 0.030901763717348388, 'support': 116997}, '2': {'precision': 0.3526144390734735, 'recall': 0.42674598472880465, 'f1-score': 0.3861545735100866, 'support': 121536}, 'accuracy': 0.3406998621043875, 'macro avg': {'precision': 0.3413182750265637, 'recall': 0.3378115211619797, 'f1-score': 0.27898887654085963, 'support': 358242}, 'weighted avg': {'precision': 0.34139250592887865, 'recall': 0.3406998621043875, 'f1-score': 0.2814135056416913, 'support': 358242}}
[[68294  1852 49563]
 [69444  1894 45659]
 [67832  1839 51865]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0919405
{'0': {'precision': 0.4358763651786661, 'recall': 0.5552066450567261, 'f1-score': 0.4883575883575884, 'support': 29616}, '1': {'precision': 0.34314269850083284, 'recall': 0.02687891440501044, 'f1-score': 0.04985278102690276, 'support': 22992}, '2': {'precision': 0.3460905464587576, 'recall': 0.5449793551787754, 'f1-score': 0.42333873581847653, 'support': 22766}, 'accuracy': 0.3909570939581288, 'macro avg': {'precision': 0.37503653671275217, 'recall': 0.3756883048801707, 'f1-score': 0.32051636840098924, 'support': 75374}, 'weighted avg': {'precision': 0.3804700392143524, 'recall': 0.3909570939581288, 'f1-score': 0.334958250030678, 'support': 75374}}
[[16443   739 12434]
 [11366   618 11008]
 [ 9915   444 12407]]
Evaluating performance on  train set...
200/200 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008835
{'0': {'precision': 0.3208397113492237, 'recall': 0.4469627734113203, 'f1-score': 0.3735424410611538, 'support': 16413}, '1': {'precision': 0.30493273542600896, 'recall': 0.024829600778967866, 'f1-score': 0.045920090039392236, 'support': 16432}, '2': {'precision': 0.3572383569783852, 'recall': 0.5260883832859331, 'f1-score': 0.42552532625525324, 'support': 18284}, 'accuracy': 0.3395920123608911, 'macro avg': {'precision': 0.3276702679178726, 'recall': 0.3326269191587404, 'f1-score': 0.28166261911859974, 'support': 51129}, 'weighted avg': {'precision': 0.3287438246374422, 'recall': 0.3395920123608911, 'f1-score': 0.28683948580873986, 'support': 51129}}
[[7336  425 8652]
 [7369  408 8655]
 [8160  505 9619]]
Evaluating performance on  val set...
53/53 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985405
{'0': {'precision': 0.34344993141289437, 'recall': 0.46897682041676425, 'f1-score': 0.39651588637038504, 'support': 4271}, '1': {'precision': 0.3401826484018265, 'recall': 0.03254696373962429, 'f1-score': 0.05940988835725678, 'support': 4578}, '2': {'precision': 0.3597780859916782, 'recall': 0.5601381990930685, 'f1-score': 0.4381386707203784, 'support': 4631}, 'accuracy': 0.3520771513353116, 'macro avg': {'precision': 0.3478035552687997, 'recall': 0.35388732774981896, 'f1-score': 0.29802148181600674, 'support': 13480}, 'weighted avg': {'precision': 0.3479497876613869, 'recall': 0.3520771513353116, 'f1-score': 0.296329228760646, 'support': 13480}}
[[2003  153 2115]
 [1928  149 2501]
 [1901  136 2594]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
1118/1118 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100877
{'0': {'precision': 0.3228358776066695, 'recall': 0.7898679907691971, 'f1-score': 0.45833888645609233, 'support': 91433}, '1': {'precision': 0.28333759918095724, 'recall': 0.01163842045502334, 'f1-score': 0.022358441978126295, 'support': 95116}, '2': {'precision': 0.3927064651123068, 'recall': 0.23081479399245042, 'f1-score': 0.2907437734345855, 'support': 99608}, 'accuracy': 0.33659145154582976, 'macro avg': {'precision': 0.33295998063331117, 'recall': 0.34410706840555694, 'f1-score': 0.25714703395626803, 'support': 286157}, 'weighted avg': {'precision': 0.334028164461513, 'recall': 0.33659145154582976, 'f1-score': 0.2550849734824014, 'support': 286157}}
[[72220  1164 18049]
 [76504  1107 17505]
 [74981  1636 22991]]
Evaluating performance on  train set...
505/505 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966467
{'0': {'precision': 0.36853641024349076, 'recall': 0.6342981029810298, 'f1-score': 0.4662024348269488, 'support': 46125}, '1': {'precision': 0.32562547384382107, 'recall': 0.020251314331518024, 'f1-score': 0.03813117301076462, 'support': 42417}, '2': {'precision': 0.34808865909476183, 'recall': 0.403859864781807, 'f1-score': 0.37390601704849374, 'support': 40675}, 'accuracy': 0.3601925443246632, 'macro avg': {'precision': 0.34741684772735787, 'recall': 0.35280309403145166, 'f1-score': 0.29274654162873576, 'support': 129217}, 'weighted avg': {'precision': 0.3480138360679617, 'recall': 0.3601925443246632, 'f1-score': 0.2966298901494238, 'support': 129217}}
[[29257   925 15943]
 [26736   859 14822]
 [23394   854 16427]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999717
{'0': {'precision': 0.34517336139858507, 'recall': 0.7194564621290598, 'f1-score': 0.46652310488571036, 'support': 16411}, '1': {'precision': 0.31852654387865653, 'recall': 0.01878714294843121, 'f1-score': 0.03548153511947864, 'support': 15649}, '2': {'precision': 0.3566698202459792, 'recall': 0.2871833936393068, 'f1-score': 0.3181770228927102, 'support': 15753}, 'accuracy': 0.347708782130383, 'macro avg': {'precision': 0.3401232418410736, 'recall': 0.3418089995722659, 'f1-score': 0.27339388763263306, 'support': 47813}, 'weighted avg': {'precision': 0.34023971717742424, 'recall': 0.347708782130383, 'f1-score': 0.27656921462767403, 'support': 47813}}
[[11807   344  4260]
 [11455   294  3900]
 [10944   285  4524]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054523
{'0': {'precision': 0.30677296174716956, 'recall': 0.5476856835306781, 'f1-score': 0.39326691858467877, 'support': 41805}, '1': {'precision': 0.22127659574468084, 'recall': 0.010597646099760534, 'f1-score': 0.020226576554674965, 'support': 39254}, '2': {'precision': 0.38821610677864427, 'recall': 0.42436475409836066, 'f1-score': 0.40548637218045114, 'support': 48800}, 'accuracy': 0.3389907515074042, 'macro avg': {'precision': 0.3054218880901649, 'recall': 0.32754936124293316, 'f1-score': 0.27299328910660164, 'support': 129859}, 'weighted avg': {'precision': 0.3115346734997187, 'recall': 0.3389907515074042, 'f1-score': 0.2850956231752572, 'support': 129859}}
[[22896   677 18232]
 [24435   416 14403]
 [27304   787 20709]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060272
{'0': {'precision': 0.32875136426654084, 'recall': 0.4764042062067197, 'f1-score': 0.38903918317479713, 'support': 23394}, '1': {'precision': 0.30781627719580984, 'recall': 0.01791996997701365, 'f1-score': 0.03386825073144782, 'support': 21317}, '2': {'precision': 0.3246851385390428, 'recall': 0.4646928935153891, 'f1-score': 0.38227280309910844, 'support': 22191}, 'accuracy': 0.3264326925951392, 'macro avg': {'precision': 0.3204175933337978, 'recall': 0.31967235656637416, 'f1-score': 0.26839341233511776, 'support': 66902}, 'weighted avg': {'precision': 0.3207320693843896, 'recall': 0.3264326925951392, 'f1-score': 0.2736266169263369, 'support': 66902}}
[[11145   435 11814]
 [11301   382  9634]
 [11455   424 10312]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041286
{'0': {'precision': 0.3413964833824576, 'recall': 0.5174060382008626, 'f1-score': 0.41136488886167416, 'support': 6492}, '1': {'precision': 0.2962962962962963, 'recall': 0.016153457849570924, 'f1-score': 0.030636668262326475, 'support': 5943}, '2': {'precision': 0.32646331409727947, 'recall': 0.44573082489146165, 'f1-score': 0.37688647178789936, 'support': 6219}, 'accuracy': 0.3338158035810014, 'macro avg': {'precision': 0.3213853645920111, 'recall': 0.32643010698063174, 'f1-score': 0.2729626763039667, 'support': 18654}, 'weighted avg': {'precision': 0.32204943762082044, 'recall': 0.3338158035810014, 'f1-score': 0.27857357917990466, 'support': 18654}}
[[3359  115 3018]
 [3146   96 2701]
 [3334  113 2772]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
604/604 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000973
{'0': {'precision': 0.2959901244157177, 'recall': 0.46317800013022814, 'f1-score': 0.3611745789963612, 'support': 46073}, '1': {'precision': 0.3685800604229607, 'recall': 0.053600094628162016, 'f1-score': 0.09359002729217378, 'support': 59179}, '2': {'precision': 0.318061566430151, 'recall': 0.47689178193653375, 'f1-score': 0.3816096818562859, 'support': 49160}, 'accuracy': 0.31057171722404997, 'macro avg': {'precision': 0.3275439170896098, 'recall': 0.3312232922316413, 'f1-score': 0.27879142938160695, 'support': 154412}, 'weighted avg': {'precision': 0.33083736370024336, 'recall': 0.31057171722404997, 'f1-score': 0.265127662120029, 'support': 154412}}
[[21340  2715 22018]
 [27760  3172 28247]
 [22997  2719 23444]]
Evaluating performance on  train set...
323/323 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991094
{'0': {'precision': 0.34535281317998134, 'recall': 0.4751078008624069, 'f1-score': 0.3999699992499812, 'support': 28061}, '1': {'precision': 0.3369016360331246, 'recall': 0.06111457150185029, 'f1-score': 0.10346110904354297, 'support': 27293}, '2': {'precision': 0.3350818833162743, 'recall': 0.4800043986657381, 'f1-score': 0.394659513871099, 'support': 27281}, 'accuracy': 0.33998910873116717, 'macro avg': {'precision': 0.33911211084312676, 'recall': 0.33874225700999844, 'f1-score': 0.2993635407215411, 'support': 82635}, 'weighted avg': {'precision': 0.3391706964560635, 'recall': 0.33998910873116717, 'f1-score': 0.3002847267622266, 'support': 82635}}
[[13332  1671 13058]
 [12698  1668 12927]
 [12574  1612 13095]]
Evaluating performance on  val set...
112/112 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003563
{'0': {'precision': 0.3352596702111265, 'recall': 0.4521459004468461, 'f1-score': 0.3850272111853458, 'support': 9623}, '1': {'precision': 0.3357185450208706, 'recall': 0.05922575215653272, 'f1-score': 0.10068854511311813, 'support': 9506}, '2': {'precision': 0.3205863144909658, 'recall': 0.4746964650263243, 'f1-score': 0.38270963270963265, 'support': 9307}, 'accuracy': 0.32817555211703475, 'macro avg': {'precision': 0.33052150990765433, 'recall': 0.3286893725432343, 'f1-score': 0.28947512966936556, 'support': 28436}, 'weighted avg': {'precision': 0.3306105332809638, 'recall': 0.32817555211703475, 'f1-score': 0.28921580794452223, 'support': 28436}}
[[4351  529 4743]
 [4323  563 4620]
 [4304  585 4418]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060681
{'0': {'precision': 0.3600839461634522, 'recall': 0.33907689292480564, 'f1-score': 0.3492648295817772, 'support': 61228}, '1': {'precision': 0.26804123711340205, 'recall': 0.01878729070751698, 'f1-score': 0.03511344343262849, 'support': 48437}, '2': {'precision': 0.31678586033892897, 'recall': 0.6149913831497008, 'f1-score': 0.41816984858459516, 'support': 51643}, 'accuracy': 0.3312358965457386, 'macro avg': {'precision': 0.31497034787192774, 'recall': 0.32428518892734115, 'f1-score': 0.2675160405330003, 'support': 161308}, 'weighted avg': {'precision': 0.31858373697052234, 'recall': 0.3312358965457386, 'f1-score': 0.27699260009195775, 'support': 161308}}
[[20761  1314 39153]
 [18183   910 29344]
 [18712  1171 31760]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013187
{'0': {'precision': 0.3216788429998509, 'recall': 0.432874376144258, 'f1-score': 0.36908338590169887, 'support': 39873}, '1': {'precision': 0.30509745127436283, 'recall': 0.020412257385024325, 'f1-score': 0.038264466694871435, 'support': 39878}, '2': {'precision': 0.35924520249363634, 'recall': 0.5587719298245614, 'f1-score': 0.4373254659652834, 'support': 42180}, 'accuracy': 0.34152922554559545, 'macro avg': {'precision': 0.32867383225595, 'recall': 0.3373528544512812, 'f1-score': 0.2815577728539512, 'support': 121931}, 'weighted avg': {'precision': 0.329251292206524, 'recall': 0.34152922554559545, 'f1-score': 0.28449500457908306, 'support': 121931}}
[[17260   894 21719]
 [18745   814 20319]
 [17651   960 23569]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101081
{'0': {'precision': 0.3309835515273582, 'recall': 0.448094527040187, 'f1-score': 0.3807369814651368, 'support': 15403}, '1': {'precision': 0.2933832709113608, 'recall': 0.014587212911235258, 'f1-score': 0.027792561054934654, 'support': 16110}, '2': {'precision': 0.33864636612346855, 'recall': 0.555982293972139, 'f1-score': 0.42091516152083386, 'support': 15362}, 'accuracy': 0.334464, 'macro avg': {'precision': 0.32100439618739585, 'recall': 0.33955467797452044, 'f1-score': 0.2764815680136351, 'support': 46875}, 'weighted avg': {'precision': 0.3205723651188617, 'recall': 0.334464, 'f1-score': 0.27260434336822503, 'support': 46875}}
[[6902  300 8201]
 [7396  235 8479]
 [6555  266 8541]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018177
{'0': {'precision': 0.24326284290108277, 'recall': 0.6030915052489461, 'f1-score': 0.3466863599555713, 'support': 145172}, '1': {'precision': 0.4848946433104849, 'recall': 0.012233787029623699, 'f1-score': 0.02386545381847261, 'support': 312250}, '2': {'precision': 0.259649526635038, 'recall': 0.4202055739514349, 'f1-score': 0.3209689190292894, 'support': 144960}, 'accuracy': 0.25280469867957545, 'macro avg': {'precision': 0.3292690042822019, 'recall': 0.34517695541000154, 'f1-score': 0.23050691093444442, 'support': 602382}, 'weighted avg': {'precision': 0.37245817634715184, 'recall': 0.25280469867957545, 'f1-score': 0.1731605438156752, 'support': 602382}}
[[ 87552   2083  55537]
 [190283   3820 118147]
 [ 82072   1975  60913]]
Evaluating performance on  train set...
1250/1250 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033874
{'0': {'precision': 0.33235546517918774, 'recall': 0.6652570062921265, 'f1-score': 0.44326190402139776, 'support': 107118}, '1': {'precision': 0.3027426160337553, 'recall': 0.010986066452304395, 'f1-score': 0.02120271867612293, 'support': 104496}, '2': {'precision': 0.3491047461726793, 'recall': 0.3278605265344944, 'f1-score': 0.3381492980818682, 'support': 108293}, 'accuracy': 0.33732928632383785, 'macro avg': {'precision': 0.32806760912854077, 'recall': 0.3347011997596418, 'f1-score': 0.26753797359312964, 'support': 319907}, 'weighted avg': {'precision': 0.32835244430851923, 'recall': 0.33732928632383785, 'f1-score': 0.26981632118998333, 'support': 319907}}
[[71261  1366 34491]
 [71641  1148 31707]
 [71510  1278 35505]]
Evaluating performance on  val set...
495/495 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053869
{'0': {'precision': 0.30122830728014255, 'recall': 0.6213855718938123, 'f1-score': 0.4057578759978412, 'support': 40532}, '1': {'precision': 0.3501639344262295, 'recall': 0.010941726088025572, 'f1-score': 0.02122036996562618, 'support': 48804}, '2': {'precision': 0.31101897162693154, 'recall': 0.3460558431456696, 'f1-score': 0.327603280603306, 'support': 37283}, 'accuracy': 0.3050253121569433, 'macro avg': {'precision': 0.3208037377777679, 'recall': 0.32612771370916915, 'f1-score': 0.2515271755222578, 'support': 126619}, 'weighted avg': {'precision': 0.32297290869129697, 'recall': 0.3050253121569433, 'f1-score': 0.2345291802689958, 'support': 126619}}
[[25186   543 14803]
 [34492   534 13778]
 [23933   448 12902]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
3870/3870 - 57s - 57s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1039009
{'0': {'precision': 0.25775598498133123, 'recall': 0.5378789807758761, 'f1-score': 0.3485053635336277, 'support': 274915}, '1': {'precision': 0.5063864853728883, 'recall': 0.023219102597743374, 'f1-score': 0.04440224961763726, 'support': 476375}, '2': {'precision': 0.25499722903365396, 'recall': 0.4209007217803916, 'f1-score': 0.31758793653094897, 'support': 239408}, 'accuracy': 0.2621374021144688, 'macro avg': {'precision': 0.33971323312929114, 'recall': 0.32733293505133704, 'f1-score': 0.23683184989407133, 'support': 990698}, 'weighted avg': {'precision': 0.37664275610644354, 'recall': 0.2621374021144688, 'f1-score': 0.1948066579184077, 'support': 990698}}
[[147871   5857 121187]
 [292099  11061 173215]
 [133716   4925 100767]]
Evaluating performance on  train set...
1577/1577 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001104
{'0': {'precision': 0.33871651247194073, 'recall': 0.5977947764786031, 'f1-score': 0.43241969264391583, 'support': 135043}, '1': {'precision': 0.35075057736720555, 'recall': 0.017567323332730887, 'f1-score': 0.033458861434875704, 'support': 138325}, '2': {'precision': 0.332360171124887, 'recall': 0.4041354827803476, 'f1-score': 0.364750389231212, 'support': 130142}, 'accuracy': 0.3364303239077098, 'macro avg': {'precision': 0.3406090869880111, 'recall': 0.33983252753056054, 'f1-score': 0.2768763144366679, 'support': 403510}, 'weighted avg': {'precision': 0.3407917647607297, 'recall': 0.3364303239077098, 'f1-score': 0.2738291361230698, 'support': 403510}}
[[80728  2284 52031]
 [82274  2430 53621]
 [75333  2214 52595]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046867
{'0': {'precision': 0.3203090815068221, 'recall': 0.6366547409618312, 'f1-score': 0.42619436707311426, 'support': 50591}, '1': {'precision': 0.3487886382623225, 'recall': 0.016450608771031168, 'f1-score': 0.031419325707405174, 'support': 50758}, '2': {'precision': 0.34370297029702973, 'recall': 0.33314139843764995, 'f1-score': 0.3383397822633308, 'support': 52101}, 'accuracy': 0.32845226458129684, 'macro avg': {'precision': 0.33760023002205813, 'recall': 0.3287489160568375, 'f1-score': 0.2653178250146167, 'support': 153450}, 'weighted avg': {'precision': 0.33767245942571616, 'recall': 0.32845226458129684, 'f1-score': 0.26578183352593154, 'support': 153450}}
[[32209   797 17585]
 [34365   835 15558]
 [33982   762 17357]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
2451/2451 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023645
{'0': {'precision': 0.3163480690063549, 'recall': 0.5459096865038233, 'f1-score': 0.4005704189350386, 'support': 204532}, '1': {'precision': 0.33267502715512987, 'recall': 0.015178342141186966, 'f1-score': 0.029032091275723006, 'support': 221961}, '2': {'precision': 0.34493928351137704, 'recall': 0.45384569425635307, 'f1-score': 0.39196833430443195, 'support': 200848}, 'accuracy': 0.328655388377294, 'macro avg': {'precision': 0.33132079322428726, 'recall': 0.3383112409671211, 'f1-score': 0.2738569481717312, 'support': 627341}, 'weighted avg': {'precision': 0.33127844372849946, 'recall': 0.328655388377294, 'f1-score': 0.2663615433163919, 'support': 627341}}
[[111656   3233  89643]
 [135128   3369  83464]
 [106169   3525  91154]]
Evaluating performance on  train set...
1200/1200 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978035
{'0': {'precision': 0.3584480869109449, 'recall': 0.5730200140917487, 'f1-score': 0.4410197785447857, 'support': 105026}, '1': {'precision': 0.3230820658532509, 'recall': 0.019008752089684333, 'f1-score': 0.03590500868369972, 'support': 101690}, '2': {'precision': 0.3448387169420402, 'recall': 0.45764923886187936, 'f1-score': 0.3933147536913126, 'support': 100376}, 'accuracy': 0.35185547002201295, 'macro avg': {'precision': 0.3421229565687453, 'recall': 0.34989266834777083, 'f1-score': 0.290079846973266, 'support': 307092}, 'weighted avg': {'precision': 0.34228867930229445, 'recall': 0.35185547002201295, 'f1-score': 0.29127781026861427, 'support': 307092}}
[[60182  2030 42814]
 [55295  1933 44462]
 [52419  2020 45937]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100334
{'0': {'precision': 0.3462318039432467, 'recall': 0.5442074776197999, 'f1-score': 0.42321119608505586, 'support': 37980}, '1': {'precision': 0.3412280701754386, 'recall': 0.019732670504983896, 'f1-score': 0.03730788596638454, 'support': 39427}, '2': {'precision': 0.31897078235514315, 'recall': 0.4582896934356158, 'f1-score': 0.37614423121602153, 'support': 35327}, 'accuracy': 0.33385668919758016, 'macro avg': {'precision': 0.33547688549127613, 'recall': 0.3407432805201332, 'f1-score': 0.27888777108915397, 'support': 112734}, 'weighted avg': {'precision': 0.335939147593731, 'recall': 0.33385668919758016, 'f1-score': 0.27349820376705747, 'support': 112734}}
[[20669   818 16493]
 [20575   778 18074]
 [18453   684 16190]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
3337/3337 - 87s - 87s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104704
{'0': {'precision': 0.2975350829601678, 'recall': 0.5435388791503022, 'f1-score': 0.3845604376914966, 'support': 270402}, '1': {'precision': 0.39459413658701914, 'recall': 0.01357702197629196, 'f1-score': 0.026250817343464634, 'support': 343006}, '2': {'precision': 0.29158040126691687, 'recall': 0.4220137731544015, 'f1-score': 0.34487654111333765, 'support': 240613}, 'accuracy': 0.2964482138027051, 'macro avg': {'precision': 0.3279032069380346, 'recall': 0.3263765580936652, 'f1-score': 0.25189593204943295, 'support': 854021}, 'weighted avg': {'precision': 0.33483986108866065, 'recall': 0.2964482138027051, 'f1-score': 0.22946962488424993, 'support': 854021}}
[[146974   3804 119624]
 [211268   4657 127081]
 [135730   3341 101542]]
Evaluating performance on  train set...
1431/1431 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042036
{'0': {'precision': 0.30408412272334007, 'recall': 0.6066958199812333, 'f1-score': 0.40511776232374075, 'support': 112966}, '1': {'precision': 0.3386130136986301, 'recall': 0.01243524945173284, 'f1-score': 0.023989506486416814, 'support': 127219}, '2': {'precision': 0.3624576439371109, 'recall': 0.391610613003391, 'f1-score': 0.37647058823529406, 'support': 125921}, 'accuracy': 0.3262169972630877, 'macro avg': {'precision': 0.335051593453027, 'recall': 0.33691389414545236, 'f1-score': 0.26852595234848387, 'support': 366106}, 'weighted avg': {'precision': 0.3361600328306441, 'recall': 0.3262169972630877, 'f1-score': 0.2628255398860866, 'support': 366106}}
[[68536  1460 42970]
 [81870  1582 43767]
 [74979  1630 49312]]
Evaluating performance on  val set...
492/492 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995247
{'0': {'precision': 0.3480080789157861, 'recall': 0.5535947103743714, 'f1-score': 0.42736210212261183, 'support': 42952}, '1': {'precision': 0.3246392896781354, 'recall': 0.014769743486164411, 'f1-score': 0.02825404491668679, 'support': 39608}, '2': {'precision': 0.37099991016081213, 'recall': 0.47770862735117875, 'f1-score': 0.4176459879851938, 'support': 43223}, 'accuracy': 0.35784644983821345, 'macro avg': {'precision': 0.34788242625157784, 'recall': 0.3486910270705715, 'f1-score': 0.2910873783414975, 'support': 125783}, 'weighted avg': {'precision': 0.34855016264553407, 'recall': 0.35784644983821345, 'f1-score': 0.29834759673496886, 'support': 125783}}
[[23778   591 18583]
 [22599   585 16424]
 [21949   626 20648]]
testing model on single stock: results/universal/W9/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
10303/10303 - 171s - 171s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1026368
{'0': {'precision': 0.2864775840569929, 'recall': 0.49878931170392543, 'f1-score': 0.36393220634095264, 'support': 771049}, '1': {'precision': 0.4178939423195071, 'recall': 0.022186994415740305, 'f1-score': 0.04213684252445829, 'support': 1073016}, '2': {'precision': 0.30288387362040403, 'recall': 0.4726302375151102, 'f1-score': 0.36917981265125843, 'support': 793339}, 'accuracy': 0.29701706678233597, 'macro avg': {'precision': 0.33575179999896804, 'recall': 0.33120218121159195, 'f1-score': 0.25841628717222315, 'support': 2637404}, 'weighted avg': {'precision': 0.3448788014788809, 'recall': 0.29701706678233597, 'f1-score': 0.234589700089234, 'support': 2637404}}
[[384591  16038 370420]
 [556632  23807 492577]
 [401259  17124 374956]]
Evaluating performance on  train set...
3419/3419 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011328
{'0': {'precision': 0.32797181759517186, 'recall': 0.49575975533979233, 'f1-score': 0.39477721479098077, 'support': 288073}, '1': {'precision': 0.325003646263795, 'recall': 0.023113492955311607, 'f1-score': 0.043157711253284436, 'support': 289225}, '2': {'precision': 0.3509123530309971, 'recall': 0.49379565964761496, 'f1-score': 0.41026957065071856, 'support': 297856}, 'accuracy': 0.3388889269774234, 'macro avg': {'precision': 0.3346292722966546, 'recall': 0.33755630264757297, 'f1-score': 0.28273483223166124, 'support': 875154}, 'weighted avg': {'precision': 0.33479862381379816, 'recall': 0.3388889269774234, 'f1-score': 0.28384512767976133, 'support': 875154}}
[[142815   6770 138488]
 [148972   6685 133568]
 [143662   7114 147080]]
Evaluating performance on  val set...
1396/1396 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100312
{'0': {'precision': 0.33279284063751774, 'recall': 0.5046347857375392, 'f1-score': 0.40108264533151755, 'support': 116726}, '1': {'precision': 0.3279889426399447, 'recall': 0.019515123604006646, 'f1-score': 0.03683838768017511, 'support': 121598}, '2': {'precision': 0.3414512922465209, 'recall': 0.49672949841099023, 'f1-score': 0.4047072684554104, 'support': 118942}, 'accuracy': 0.33688904065878084, 'macro avg': {'precision': 0.3340776918413278, 'recall': 0.34029313591751204, 'f1-score': 0.28087610048903433, 'support': 357266}, 'weighted avg': {'precision': 0.33404039613557573, 'recall': 0.33688904065878084, 'f1-score': 0.2783162658879492, 'support': 357266}}
[[58904  2277 55545]
 [60820  2373 58405]
 [57275  2585 59082]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        58 (peak)  16.80 (ave)

============================================
