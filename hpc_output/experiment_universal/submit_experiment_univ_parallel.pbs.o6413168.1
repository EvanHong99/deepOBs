This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W0/deepLOB_L1/h50
Epoch 1/50
8838/8838 - 232s - loss: 3.1444 - accuracy50: 0.4405 - val_loss: 3.2551 - val_accuracy50: 0.3811 - 232s/epoch - 26ms/step
Epoch 2/50
8838/8838 - 195s - loss: 3.1244 - accuracy50: 0.4481 - val_loss: 3.2602 - val_accuracy50: 0.3780 - 195s/epoch - 22ms/step
Epoch 3/50
8838/8838 - 190s - loss: 3.0907 - accuracy50: 0.4602 - val_loss: 3.2381 - val_accuracy50: 0.3892 - 190s/epoch - 21ms/step
Epoch 4/50
8838/8838 - 193s - loss: 3.0659 - accuracy50: 0.4669 - val_loss: 3.2531 - val_accuracy50: 0.3841 - 193s/epoch - 22ms/step
Epoch 5/50
8838/8838 - 190s - loss: 3.0502 - accuracy50: 0.4720 - val_loss: 3.2498 - val_accuracy50: 0.3937 - 190s/epoch - 21ms/step
Epoch 6/50
8838/8838 - 191s - loss: 3.0406 - accuracy50: 0.4748 - val_loss: 3.2463 - val_accuracy50: 0.3991 - 191s/epoch - 22ms/step
Epoch 7/50
8838/8838 - 193s - loss: 3.0318 - accuracy50: 0.4772 - val_loss: 3.2442 - val_accuracy50: 0.3993 - 193s/epoch - 22ms/step
Epoch 8/50
8838/8838 - 192s - loss: 3.0261 - accuracy50: 0.4789 - val_loss: 3.2516 - val_accuracy50: 0.4049 - 192s/epoch - 22ms/step
Epoch 9/50
8838/8838 - 192s - loss: 3.0218 - accuracy50: 0.4796 - val_loss: 3.2527 - val_accuracy50: 0.4020 - 192s/epoch - 22ms/step
Epoch 10/50
8838/8838 - 193s - loss: 3.0181 - accuracy50: 0.4805 - val_loss: 3.2402 - val_accuracy50: 0.4063 - 193s/epoch - 22ms/step
Epoch 11/50
8838/8838 - 191s - loss: 3.0145 - accuracy50: 0.4815 - val_loss: 3.2342 - val_accuracy50: 0.4106 - 191s/epoch - 22ms/step
Epoch 12/50
8838/8838 - 191s - loss: 3.0119 - accuracy50: 0.4820 - val_loss: 3.2384 - val_accuracy50: 0.4118 - 191s/epoch - 22ms/step
Epoch 13/50
8838/8838 - 193s - loss: 3.0094 - accuracy50: 0.4824 - val_loss: 3.2196 - val_accuracy50: 0.4148 - 193s/epoch - 22ms/step
Epoch 14/50
8838/8838 - 194s - loss: 3.0069 - accuracy50: 0.4832 - val_loss: 3.2336 - val_accuracy50: 0.4127 - 194s/epoch - 22ms/step
Epoch 15/50
8838/8838 - 192s - loss: 3.0050 - accuracy50: 0.4836 - val_loss: 3.2197 - val_accuracy50: 0.4151 - 192s/epoch - 22ms/step
Epoch 16/50
8838/8838 - 193s - loss: 3.0029 - accuracy50: 0.4844 - val_loss: 3.2207 - val_accuracy50: 0.4099 - 193s/epoch - 22ms/step
Epoch 17/50
8838/8838 - 192s - loss: 3.0018 - accuracy50: 0.4844 - val_loss: 3.2234 - val_accuracy50: 0.4124 - 192s/epoch - 22ms/step
Epoch 18/50
8838/8838 - 193s - loss: 2.9994 - accuracy50: 0.4853 - val_loss: 3.2317 - val_accuracy50: 0.4102 - 193s/epoch - 22ms/step
Epoch 19/50
8838/8838 - 193s - loss: 2.9982 - accuracy50: 0.4855 - val_loss: 3.2313 - val_accuracy50: 0.4102 - 193s/epoch - 22ms/step
Epoch 20/50
8838/8838 - 195s - loss: 2.9964 - accuracy50: 0.4861 - val_loss: 3.2322 - val_accuracy50: 0.4104 - 195s/epoch - 22ms/step
Epoch 21/50
8838/8838 - 194s - loss: 2.9946 - accuracy50: 0.4867 - val_loss: 3.2184 - val_accuracy50: 0.4171 - 194s/epoch - 22ms/step
Epoch 22/50
8838/8838 - 196s - loss: 2.9936 - accuracy50: 0.4869 - val_loss: 3.2303 - val_accuracy50: 0.4151 - 196s/epoch - 22ms/step
Epoch 23/50
8838/8838 - 194s - loss: 2.9923 - accuracy50: 0.4871 - val_loss: 3.2315 - val_accuracy50: 0.4154 - 194s/epoch - 22ms/step
Epoch 24/50
8838/8838 - 194s - loss: 2.9909 - accuracy50: 0.4876 - val_loss: 3.2284 - val_accuracy50: 0.4126 - 194s/epoch - 22ms/step
Epoch 25/50
8838/8838 - 197s - loss: 2.9901 - accuracy50: 0.4879 - val_loss: 3.2318 - val_accuracy50: 0.4150 - 197s/epoch - 22ms/step
Epoch 26/50
8838/8838 - 198s - loss: 2.9886 - accuracy50: 0.4879 - val_loss: 3.2381 - val_accuracy50: 0.4087 - 198s/epoch - 22ms/step
Epoch 27/50
8838/8838 - 193s - loss: 2.9871 - accuracy50: 0.4887 - val_loss: 3.2306 - val_accuracy50: 0.4129 - 193s/epoch - 22ms/step
Epoch 28/50
8838/8838 - 198s - loss: 2.9861 - accuracy50: 0.4889 - val_loss: 3.2387 - val_accuracy50: 0.4089 - 198s/epoch - 22ms/step
Epoch 29/50
8838/8838 - 204s - loss: 2.9846 - accuracy50: 0.4893 - val_loss: 3.2355 - val_accuracy50: 0.4129 - 204s/epoch - 23ms/step
Epoch 30/50
8838/8838 - 200s - loss: 2.9837 - accuracy50: 0.4897 - val_loss: 3.2445 - val_accuracy50: 0.4111 - 200s/epoch - 23ms/step
Epoch 31/50
8838/8838 - 201s - loss: 2.9824 - accuracy50: 0.4899 - val_loss: 3.2457 - val_accuracy50: 0.4120 - 201s/epoch - 23ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 440s - 440s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0417053
{'0': {'precision': 0.3689696503973713, 'recall': 0.3728089173956487, 'f1-score': 0.37087934833640884, 'support': 2024627}, '1': {'precision': 0.5918957305259444, 'recall': 0.4641173357023908, 'f1-score': 0.5202758909915285, 'support': 4394434}, '2': {'precision': 0.31384639624881366, 'recall': 0.45725991739771266, 'f1-score': 0.37221683880567147, 'support': 2029968}, 'accuracy': 0.44058968196227044, 'macro avg': {'precision': 0.42490392572404306, 'recall': 0.4313953901652507, 'f1-score': 0.4211240260445363, 'support': 8449029}, 'weighted avg': {'precision': 0.4716720442495272, 'recall': 0.44058968196227044, 'f1-score': 0.44890349873037905, 'support': 8449029}}
[[ 754799  678115  591713]
 [ 917266 2039533 1437635]
 [ 373629  728116  928223]]
Evaluating performance on  train set...
8838/8838 - 114s - 114s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0896534
{'0': {'precision': 0.4293758261871674, 'recall': 0.28528318458266533, 'f1-score': 0.3428032144883685, 'support': 710473}, '1': {'precision': 0.3971753957917353, 'recall': 0.5876244097480661, 'f1-score': 0.47398457271352573, 'support': 823589}, '2': {'precision': 0.4025479557038548, 'recall': 0.3160162635128638, 'f1-score': 0.3540719046237592, 'support': 728010}, 'accuracy': 0.40525235271025856, 'macro avg': {'precision': 0.4096997258942525, 'recall': 0.3963079526145317, 'f1-score': 0.3902865639418845, 'support': 2262072}, 'weighted avg': {'precision': 0.4090179957292951, 'recall': 0.40525235271025856, 'f1-score': 0.3941911644496274, 'support': 2262072}}
[[202686 353227 154560]
 [152734 483961 186894]
 [116628 381319 230063]]
Evaluating performance on  val set...
3279/3279 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0708773
{'0': {'precision': 0.42134117921230485, 'recall': 0.2852426686650758, 'f1-score': 0.3401846298582936, 'support': 253535}, '1': {'precision': 0.4370449485915765, 'recall': 0.5214197985752886, 'f1-score': 0.4755185618178891, 'support': 325680}, '2': {'precision': 0.38732677388564746, 'recall': 0.415698099837481, 'f1-score': 0.40101124931270715, 'support': 259662}, 'accuracy': 0.4173150533391665, 'macro avg': {'precision': 0.4152376338965096, 'recall': 0.40745352235928184, 'f1-score': 0.40557148032963, 'support': 838877}, 'weighted avg': {'precision': 0.41690924830409143, 'recall': 0.4173150533391665, 'f1-score': 0.41155375384354176, 'support': 838877}}
[[ 72319 106284  74932]
 [ 60055 169816  95809]
 [ 39266 112455 107941]]
testing model out of sample: results/universal/W0/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 302s - 302s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0981137
{'0': {'precision': 0.4543990484789554, 'recall': 0.27402951316626484, 'f1-score': 0.341883217090405, 'support': 1909995}, '1': {'precision': 0.34897636237760854, 'recall': 0.4805836041790361, 'f1-score': 0.4043404329185855, 'support': 1982371}, '2': {'precision': 0.39279185179224796, 'recall': 0.39492846788900526, 'f1-score': 0.39385726215712724, 'support': 1940597}, 'accuracy': 0.3844507499876135, 'macro avg': {'precision': 0.39872242088293736, 'recall': 0.3831805284114354, 'f1-score': 0.3800269707220392, 'support': 5832963}, 'weighted avg': {'precision': 0.3980740526341253, 'recall': 0.3844507499876135, 'f1-score': 0.3804012137471422, 'support': 5832963}}
[[523395 877828 508772]
 [353692 952695 675984]
 [274753 899447 766397]]
Evaluating performance on  train set...
6334/6334 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0838479
{'0': {'precision': 0.43900589385735, 'recall': 0.30960307154170075, 'f1-score': 0.3631203457219984, 'support': 532892}, '1': {'precision': 0.3932254801372047, 'recall': 0.49356457163557327, 'f1-score': 0.4377184098358417, 'support': 552100}, '2': {'precision': 0.41172347339097926, 'recall': 0.4241679542010942, 'f1-score': 0.4178530790964087, 'support': 535908}, 'accuracy': 0.4101406625948547, 'macro avg': {'precision': 0.414651615795178, 'recall': 0.4091118657927894, 'f1-score': 0.40623061155141627, 'support': 1620900}, 'weighted avg': {'precision': 0.41439226328039647, 'recall': 0.4101406625948547, 'f1-score': 0.40662537433231755, 'support': 1620900}}
[[164985 206018 161889]
 [116701 272497 162902]
 [ 94129 214464 227315]]
Evaluating performance on  val set...
2156/2156 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0781336
{'0': {'precision': 0.42808438416531436, 'recall': 0.32624210036647494, 'f1-score': 0.3702883339986865, 'support': 176274}, '1': {'precision': 0.42058261766351723, 'recall': 0.46162319105412497, 'f1-score': 0.44014829226741004, 'support': 197007}, '2': {'precision': 0.40174635511877305, 'recall': 0.45299327713157617, 'f1-score': 0.4258335313217708, 'support': 178049}, 'accuracy': 0.4155514845918053, 'macro avg': {'precision': 0.4168044523158682, 'recall': 0.41361952285072534, 'f1-score': 0.41209005252928915, 'support': 551330}, 'weighted avg': {'precision': 0.41689805248206263, 'recall': 0.4155514845918053, 'f1-score': 0.41318944156915116, 'support': 551330}}
[[57508 61072 57694]
 [43652 90943 62412]
 [33178 64216 80655]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082195
{'0': {'precision': 0.37086612242896716, 'recall': 0.2478577865159335, 'f1-score': 0.29713432718559113, 'support': 61035}, '1': {'precision': 0.46904357580195366, 'recall': 0.5997012100990986, 'f1-score': 0.5263857259626101, 'support': 100405}, '2': {'precision': 0.3363520640116385, 'recall': 0.2949214701427091, 'f1-score': 0.3142772184699036, 'support': 62715}, 'accuracy': 0.41862550467310566, 'macro avg': {'precision': 0.3920872540808531, 'recall': 0.3808268222525804, 'f1-score': 0.37926575720603495, 'support': 224155}, 'weighted avg': {'precision': 0.4051859369870718, 'recall': 0.41862550467310566, 'f1-score': 0.4046184480889939, 'support': 224155}}
[[15128 33284 12623]
 [16321 60213 23871]
 [ 9342 34877 18496]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1169722
{'0': {'precision': 0.42432486231835975, 'recall': 0.23108332731083328, 'f1-score': 0.2992162826061528, 'support': 27674}, '1': {'precision': 0.343834098464461, 'recall': 0.48659547457247404, 'f1-score': 0.4029435409065611, 'support': 26782}, '2': {'precision': 0.37104937179260306, 'recall': 0.3916031674884207, 'f1-score': 0.38104930306940227, 'support': 26772}, 'accuracy': 0.36823509134781107, 'macro avg': {'precision': 0.37973611085847464, 'recall': 0.36976065645724265, 'f1-score': 0.3610697088607054, 'support': 81228}, 'weighted avg': {'precision': 0.3802268287598495, 'recall': 0.36823509134781107, 'f1-score': 0.360388009789435, 'support': 81228}}
[[ 6395 12423  8856]
 [ 4835 13032  8915]
 [ 3841 12447 10484]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1063515
{'0': {'precision': 0.39892357373519916, 'recall': 0.22512452921880696, 'f1-score': 0.2878223050636844, 'support': 8231}, '1': {'precision': 0.3875186120282256, 'recall': 0.6071609696723805, 'f1-score': 0.4730893859163835, 'support': 9859}, '2': {'precision': 0.36416184971098264, 'recall': 0.2774009282399143, 'f1-score': 0.3149148878681437, 'support': 8403}, 'accuracy': 0.38387498584531765, 'macro avg': {'precision': 0.3835346784914691, 'recall': 0.36989547571036724, 'f1-score': 0.3586088596160706, 'support': 26493}, 'weighted avg': {'precision': 0.3836537181339255, 'recall': 0.38387498584531765, 'f1-score': 0.3653600366694909, 'support': 26493}}
[[1853 4644 1734]
 [1537 5986 2336]
 [1255 4817 2331]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
2359/2359 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9726562
{'0': {'precision': 0.4236965961539556, 'recall': 0.5219619583125925, 'f1-score': 0.46772379737769604, 'support': 142633}, '1': {'precision': 0.6580581313377799, 'recall': 0.6285679137841171, 'f1-score': 0.6429750560886158, 'support': 308899}, '2': {'precision': 0.3712928228298213, 'recall': 0.3243813051702396, 'f1-score': 0.34625536762772763, 'support': 152256}, 'accuracy': 0.5266782380570664, 'macro avg': {'precision': 0.4843491834405189, 'recall': 0.4916370590889831, 'f1-score': 0.48565140703134646, 'support': 603788}, 'weighted avg': {'precision': 0.5303818150478533, 'recall': 0.5266782380570664, 'f1-score': 0.5267522002683352, 'support': 603788}}
[[ 74449  43232  24952]
 [ 56057 194164  58678]
 [ 45207  57660  49389]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0200129
{'0': {'precision': 0.43755617901015986, 'recall': 0.3931280896676619, 'f1-score': 0.41415404447309057, 'support': 40862}, '1': {'precision': 0.5628311827135986, 'recall': 0.5287720758073541, 'f1-score': 0.5452702902624493, 'support': 69703}, '2': {'precision': 0.37808976024079, 'recall': 0.4569008470353762, 'f1-score': 0.41377598790709225, 'support': 40140}, 'accuracy': 0.47285093394379746, 'macro avg': {'precision': 0.4594923739881828, 'recall': 0.4596003375034641, 'f1-score': 0.45773344088087736, 'support': 150705}, 'weighted avg': {'precision': 0.47965870735187566, 'recall': 0.47285093394379746, 'f1-score': 0.4746962991407957, 'support': 150705}}
[[16064 14041 10757]
 [13436 36857 19410]
 [ 7213 14587 18340]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0169278
{'0': {'precision': 0.4378361858190709, 'recall': 0.43396340724585, 'f1-score': 0.4358911945475567, 'support': 16506}, '1': {'precision': 0.5433660517854121, 'recall': 0.5027007984969469, 'f1-score': 0.5222430058555628, 'support': 25548}, '2': {'precision': 0.4030492987675308, 'recall': 0.4525229631396875, 'f1-score': 0.426355717898286, 'support': 16766}, 'accuracy': 0.46910914654879293, 'macro avg': {'precision': 0.4614171787906713, 'recall': 0.4630623896274948, 'f1-score': 0.4614966394338018, 'support': 58820}, 'weighted avg': {'precision': 0.47375662219108666, 'recall': 0.46910914654879293, 'f1-score': 0.47067943449647315, 'support': 58820}}
[[ 7163  5168  4175]
 [ 5643 12843  7062]
 [ 3554  5625  7587]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
1625/1625 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0681056
{'0': {'precision': 0.4365030428138656, 'recall': 0.47871691400765914, 'f1-score': 0.4566364359809431, 'support': 136047}, '1': {'precision': 0.40611536294060974, 'recall': 0.47642404725853577, 'f1-score': 0.4384690873405299, 'support': 140673}, '2': {'precision': 0.4488880141704389, 'recall': 0.32786366805384853, 'f1-score': 0.37894754331238495, 'support': 139131}, 'accuracy': 0.42747041608653097, 'macro avg': {'precision': 0.4305021399749714, 'recall': 0.4276682097733478, 'f1-score': 0.42468435554461936, 'support': 415851}, 'weighted avg': {'precision': 0.43036720896712927, 'recall': 0.42747041608653097, 'f1-score': 0.4244985097497641, 'support': 415851}}
[[65128 45093 25826]
 [43475 67020 30178]
 [40601 52914 45616]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0952603
{'0': {'precision': 0.4212287186682136, 'recall': 0.4077091820745848, 'f1-score': 0.41435870214318893, 'support': 38292}, '1': {'precision': 0.36627467450650986, 'recall': 0.45989558614143333, 'f1-score': 0.4077806092628527, 'support': 37926}, '2': {'precision': 0.42363571358923524, 'recall': 0.332228792822186, 'f1-score': 0.3724053200760011, 'support': 39232}, 'accuracy': 0.3992031182330013, 'macro avg': {'precision': 0.40371303558798627, 'recall': 0.3999445203460681, 'f1-score': 0.39818154382734755, 'support': 115450}, 'weighted avg': {'precision': 0.40399393431017766, 'recall': 0.3992031182330013, 'f1-score': 0.39794124146029985, 'support': 115450}}
[[15612 14491  8189]
 [10940 17442  9544]
 [10511 15687 13034]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.104344
{'0': {'precision': 0.44209606986899563, 'recall': 0.33197796432318993, 'f1-score': 0.3792044347891228, 'support': 15248}, '1': {'precision': 0.35079504890825647, 'recall': 0.508842714007128, 'f1-score': 0.41529004994237423, 'support': 14871}, '2': {'precision': 0.40489175342918526, 'recall': 0.32657957877899224, 'f1-score': 0.3615435696893676, 'support': 15004}, 'accuracy': 0.38847151120271256, 'macro avg': {'precision': 0.3992609574021458, 'recall': 0.38913341903643667, 'f1-score': 0.3853460181402882, 'support': 45123}, 'weighted avg': {'precision': 0.39963543900291704, 'recall': 0.38847151120271256, 'f1-score': 0.38522454787972576, 'support': 45123}}
[[5062 6816 3370]
 [3472 7567 3832]
 [2916 7188 4900]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1269/1269 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1343415
{'0': {'precision': 0.38196663496168687, 'recall': 0.3313432282347706, 'f1-score': 0.3548585669039605, 'support': 107867}, '1': {'precision': 0.3426572541875411, 'recall': 0.2471304220879943, 'f1-score': 0.2871576849270046, 'support': 109598}, '2': {'precision': 0.35843811001058173, 'recall': 0.5082619595709187, 'f1-score': 0.42040023434368357, 'support': 107299}, 'accuracy': 0.36137626091561875, 'macro avg': {'precision': 0.3610206663866033, 'recall': 0.3622452032978945, 'f1-score': 0.35413882872488295, 'support': 324764}, 'weighted avg': {'precision': 0.3609273057478163, 'recall': 0.36137626091561875, 'f1-score': 0.3536659289013014, 'support': 324764}}
[[35741 25167 46959]
 [31859 27085 50654]
 [25971 26792 54536]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1313115
{'0': {'precision': 0.38173794802062755, 'recall': 0.3605107578988176, 'f1-score': 0.3708208201971364, 'support': 41272}, '1': {'precision': 0.3236952513294674, 'recall': 0.29469868379437025, 'f1-score': 0.30851714125617646, 'support': 41103}, '2': {'precision': 0.36784587416678854, 'recall': 0.4203438395415473, 'f1-score': 0.39234652373045675, 'support': 41880}, 'accuracy': 0.35890708623395434, 'macro avg': {'precision': 0.3577596911722945, 'recall': 0.3585177604115784, 'f1-score': 0.35722816172792315, 'support': 124255}, 'weighted avg': {'precision': 0.35785537576924503, 'recall': 0.35890708623395434, 'f1-score': 0.35746625376894586, 'support': 124255}}
[[14879 12366 14027]
 [12764 12113 16226]
 [11334 12942 17604]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1359957
{'0': {'precision': 0.3662899018755434, 'recall': 0.3943567798876705, 'f1-score': 0.37980552514650007, 'support': 14956}, '1': {'precision': 0.3285624607658506, 'recall': 0.34625562318073566, 'f1-score': 0.33717709205694774, 'support': 15116}, '2': {'precision': 0.366770462633452, 'recall': 0.3202356292076644, 'f1-score': 0.3419270113353608, 'support': 15448}, 'accuracy': 0.3532293497363796, 'macro avg': {'precision': 0.35387427509161534, 'recall': 0.35361601075869015, 'f1-score': 0.3529698761796029, 'support': 45520}, 'weighted avg': {'precision': 0.3539246932370121, 'recall': 0.3532293497363796, 'f1-score': 0.35279500941855296, 'support': 45520}}
[[5898 5124 3934]
 [5275 5234 4607]
 [4929 5572 4947]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1147012
{'0': {'precision': 0.3455736780920844, 'recall': 0.3682716781667881, 'f1-score': 0.356561816212444, 'support': 133187}, '1': {'precision': 0.4058425776263738, 'recall': 0.5911568815947777, 'f1-score': 0.48127735755326234, 'support': 173717}, '2': {'precision': 0.3785693683299683, 'recall': 0.13450895994378073, 'f1-score': 0.19849200090739202, 'support': 136608}, 'accuracy': 0.38357023034326015, 'macro avg': {'precision': 0.3766618746828088, 'recall': 0.3646458399017822, 'f1-score': 0.34544372489103276, 'support': 443512}, 'weighted avg': {'precision': 0.3793432439040918, 'recall': 0.38357023034326015, 'f1-score': 0.35672327377370594, 'support': 443512}}
[[ 49049  72515  11623]
 [ 52483 102694  18540]
 [ 40403  77830  18375]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1251436
{'0': {'precision': 0.38095573724274034, 'recall': 0.334044065387349, 'f1-score': 0.3559609463753561, 'support': 64722}, '1': {'precision': 0.3499458043537169, 'recall': 0.4792343136345363, 'f1-score': 0.4045105127837016, 'support': 64674}, '2': {'precision': 0.38944175719609864, 'recall': 0.29600108486017357, 'f1-score': 0.3363524295449098, 'support': 66368}, 'accuracy': 0.36911280930099505, 'macro avg': {'precision': 0.3734477662641853, 'recall': 0.36975982129401963, 'f1-score': 0.36560796290132247, 'support': 195764}, 'weighted avg': {'precision': 0.3735880075917309, 'recall': 0.36911280930099505, 'f1-score': 0.3653524413023614, 'support': 195764}}
[[21620 27963 15139]
 [18020 30994 15660]
 [17112 29611 19645]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1019531
{'0': {'precision': 0.37275832621690863, 'recall': 0.45218251165418843, 'f1-score': 0.4086469924892019, 'support': 21237}, '1': {'precision': 0.38849893412364167, 'recall': 0.3377633125395534, 'f1-score': 0.3613589650586387, 'support': 22122}, '2': {'precision': 0.40546569994422754, 'recall': 0.3744089142750129, 'f1-score': 0.38931892312935107, 'support': 21359}, 'accuracy': 0.3874038134676597, 'macro avg': {'precision': 0.38890765342825934, 'recall': 0.38811824615625157, 'f1-score': 0.3864416268923972, 'support': 64718}, 'weighted avg': {'precision': 0.3889332779081623, 'recall': 0.3874038134676597, 'f1-score': 0.38610405271547626, 'support': 64718}}
[[9603 5620 6014]
 [8938 7472 5712]
 [7221 6141 7997]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
4693/4693 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9391294
{'0': {'precision': 0.4712435478886642, 'recall': 0.5383346324174499, 'f1-score': 0.5025598355440262, 'support': 286099}, '1': {'precision': 0.6593734646532678, 'recall': 0.6459599710572703, 'f1-score': 0.6525977999046797, 'support': 627446}, '2': {'precision': 0.45959434532634524, 'recall': 0.41490785580937745, 'f1-score': 0.43610937539967043, 'support': 287647}, 'accuracy': 0.5649962703714311, 'macro avg': {'precision': 0.5300704526227591, 'recall': 0.5330674864280326, 'f1-score': 0.5304223369494587, 'support': 1201192}, 'weighted avg': {'precision': 0.5667241251692656, 'recall': 0.5649962703714311, 'f1-score': 0.5650198295142584, 'support': 1201192}}
[[154017  88202  43880]
 [125689 405305  96452]
 [ 47125 121175 119347]]
Evaluating performance on  train set...
1497/1497 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97249705
{'0': {'precision': 0.472962226640159, 'recall': 0.5052896674488228, 'f1-score': 0.48859179861321655, 'support': 98872}, '1': {'precision': 0.6050595883592764, 'recall': 0.5921829671196939, 'f1-score': 0.5985520322161829, 'support': 183727}, '2': {'precision': 0.43451515833862153, 'recall': 0.4222078567876678, 'f1-score': 0.4282731069547848, 'support': 100550}, 'accuracy': 0.5251533998522768, 'macro avg': {'precision': 0.5041789911126856, 'recall': 0.5065601637853948, 'f1-score': 0.5051389792613947, 'support': 383149}, 'weighted avg': {'precision': 0.5262156587484216, 'recall': 0.5251533998522768, 'f1-score': 0.525490288216261, 'support': 383149}}
[[ 49959  31341  17572]
 [ 37250 108800  37677]
 [ 18421  39676  42453]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99572796
{'0': {'precision': 0.44943038990212336, 'recall': 0.4839880198133856, 'f1-score': 0.4660694972129011, 'support': 34724}, '1': {'precision': 0.5906061203047018, 'recall': 0.5175216503150445, 'f1-score': 0.5516538113566314, 'support': 69514}, '2': {'precision': 0.38440051051123364, 'recall': 0.44846186262115467, 'f1-score': 0.4139674800964705, 'support': 35595}, 'accuracy': 0.49161499789034063, 'macro avg': {'precision': 0.4748123402393529, 'recall': 0.4833238442498616, 'f1-score': 0.4772302628886677, 'support': 139833}, 'weighted avg': {'precision': 0.5030582972364874, 'recall': 0.49161499789034063, 'f1-score': 0.49535254709474524, 'support': 139833}}
[[16806 10918  7000]
 [14975 35975 18564]
 [ 5613 14019 15963]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
6677/6677 - 87s - 87s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0488169
{'0': {'precision': 0.4068538679185587, 'recall': 0.35537231410614084, 'f1-score': 0.3793745320088393, 'support': 379948}, '1': {'precision': 0.7185638205083477, 'recall': 0.3650658436643068, 'f1-score': 0.48415637931213296, 'support': 959090}, '2': {'precision': 0.3049025445149694, 'recall': 0.7330464985631252, 'f1-score': 0.4306718988763866, 'support': 370248}, 'accuracy': 0.4426193159014934, 'macro avg': {'precision': 0.4767734109806252, 'recall': 0.4844948854445243, 'f1-score': 0.43140093673245294, 'support': 1709286}, 'weighted avg': {'precision': 0.5596724277393309, 'recall': 0.4426193159014934, 'f1-score': 0.4492797260010042, 'support': 1709286}}
[[135023  72124 172801]
 [163019 350131 445940]
 [ 33829  65010 271409]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0723342
{'0': {'precision': 0.45066398390342055, 'recall': 0.30337425639580873, 'f1-score': 0.36263373312954955, 'support': 184574}, '1': {'precision': 0.40483466590163525, 'recall': 0.6203867860061263, 'f1-score': 0.4899508818806409, 'support': 209263}, '2': {'precision': 0.4275087939417023, 'recall': 0.3094283119635019, 'f1-score': 0.3590084510575581, 'support': 184996}, 'accuracy': 0.4199173163935021, 'macro avg': {'precision': 0.4276691479155861, 'recall': 0.4110631181218123, 'f1-score': 0.4038643553559162, 'support': 578833}, 'weighted avg': {'precision': 0.42669507042549926, 'recall': 0.4199173163935021, 'f1-score': 0.4075035069968126, 'support': 578833}}
[[ 55995  91896  36683]
 [ 39466 129824  39973]
 [ 28789  98964  57243]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.064609
{'0': {'precision': 0.457593839249286, 'recall': 0.2798222360829565, 'f1-score': 0.3472800108373812, 'support': 64130}, '1': {'precision': 0.4462179845978653, 'recall': 0.5537286085529861, 'f1-score': 0.4941937207748831, 'support': 83503}, '2': {'precision': 0.39223874516194746, 'recall': 0.4216577247344794, 'f1-score': 0.4064165479394228, 'support': 63931}, 'accuracy': 0.43079162806526633, 'macro avg': {'precision': 0.4320168563363662, 'recall': 0.41840285645680736, 'f1-score': 0.415963426517229, 'support': 211564}, 'weighted avg': {'precision': 0.43335467516156206, 'recall': 0.43079162806526633, 'f1-score': 0.42313598574039796, 'support': 211564}}
[[17945 28239 17946]
 [13442 46238 23823]
 [ 7829 29145 26957]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
5633/5633 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99999046
{'0': {'precision': 0.3890232544350924, 'recall': 0.4442732843552155, 'f1-score': 0.4148166490390884, 'support': 354444}, '1': {'precision': 0.5834046107876398, 'recall': 0.6503584985238297, 'f1-score': 0.6150648270160617, 'support': 718413}, '2': {'precision': 0.3996443541216817, 'recall': 0.2558208235201652, 'f1-score': 0.3119535599264335, 'support': 368977}, 'accuracy': 0.49873147671645973, 'macro avg': {'precision': 0.457357406448138, 'recall': 0.45015086879973687, 'f1-score': 0.4472783453271945, 'support': 1441834}, 'weighted avg': {'precision': 0.4885943804179457, 'recall': 0.49873147671645973, 'f1-score': 0.48826947388123476, 'support': 1441834}}
[[157470 148340  48634]
 [158023 467226  93164]
 [ 89290 185295  94392]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0729948
{'0': {'precision': 0.44526994998597286, 'recall': 0.3726239435251449, 'f1-score': 0.40572070781639086, 'support': 123524}, '1': {'precision': 0.4146166004701305, 'recall': 0.33388816814758604, 'f1-score': 0.3698989853336648, 'support': 122559}, '2': {'precision': 0.4054508669160374, 'recall': 0.5470748817572929, 'f1-score': 0.4657343602215917, 'support': 126012}, 'accuracy': 0.41894408685953854, 'macro avg': {'precision': 0.42177913912404685, 'recall': 0.4178623311433413, 'f1-score': 0.4137846844572158, 'support': 372095}, 'weighted avg': {'precision': 0.42168853620959634, 'recall': 0.41894408685953854, 'f1-score': 0.4142458583320488, 'support': 372095}}
[[46028 28171 49325]
 [29873 40921 51765]
 [27470 29604 68938]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0708352
{'0': {'precision': 0.43349566069048073, 'recall': 0.3478735481617326, 'f1-score': 0.38599338670800987, 'support': 45804}, '1': {'precision': 0.41680876979293546, 'recall': 0.35613187911081506, 'f1-score': 0.3840887152894696, 'support': 48044}, '2': {'precision': 0.4208253358925144, 'recall': 0.5598294998249697, 'f1-score': 0.48047575706698953, 'support': 48563}, 'accuracy': 0.42293783485826236, 'macro avg': {'precision': 0.4237099221253102, 'recall': 0.4212783090325058, 'f1-score': 0.41685261968815635, 'support': 142411}, 'weighted avg': {'precision': 0.4235454885166648, 'recall': 0.42293783485826236, 'f1-score': 0.4175698753086853, 'support': 142411}}
[[15934 11857 18013]
 [11530 17110 19404]
 [ 9293 12083 27187]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
11876/11876 - 156s - 156s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1285884
{'0': {'precision': 0.5314189861191713, 'recall': 0.215995792554956, 'f1-score': 0.3071501082415912, 'support': 1199778}, '1': {'precision': 0.219481275971169, 'recall': 0.6111808652951752, 'f1-score': 0.3229778979926728, 'support': 608486}, '2': {'precision': 0.48121913898571345, 'recall': 0.3351949638564975, 'f1-score': 0.39514807825544407, 'support': 1231895}, 'accuracy': 0.3433922370507595, 'macro avg': {'precision': 0.41070646702535124, 'recall': 0.3874572072355429, 'f1-score': 0.3417586948299027, 'support': 3040159}, 'weighted avg': {'precision': 0.4486434897778324, 'recall': 0.3433922370507595, 'f1-score': 0.3459754616999767, 'support': 3040159}}
[[259147 653995 286636]
 [ 78071 371895 158520]
 [150433 668537 412925]]
Evaluating performance on  train set...
2538/2538 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0756444
{'0': {'precision': 0.45659823021230456, 'recall': 0.2999264807241649, 'f1-score': 0.3620394636493476, 'support': 217630}, '1': {'precision': 0.40885402242710184, 'recall': 0.38039867887845213, 'f1-score': 0.3941133929048135, 'support': 213455}, '2': {'precision': 0.4105806778307598, 'recall': 0.5787864921753455, 'f1-score': 0.4803849520803781, 'support': 218540}, 'accuracy': 0.4201793342312873, 'macro avg': {'precision': 0.425344310156722, 'recall': 0.4197038839259875, 'f1-score': 0.41217926954484635, 'support': 649625}, 'weighted avg': {'precision': 0.4254296086687167, 'recall': 0.4201793342312873, 'f1-score': 0.41239091812068546, 'support': 649625}}
[[ 65273  59418  92939]
 [ 43613  81198  88644]
 [ 34069  57983 126488]]
Evaluating performance on  val set...
795/795 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0748196
{'0': {'precision': 0.43542726300182055, 'recall': 0.34407071246366494, 'f1-score': 0.38439552974508945, 'support': 67428}, '1': {'precision': 0.4225434655206095, 'recall': 0.35697353417751904, 'f1-score': 0.38700075633737524, 'support': 66652}, '2': {'precision': 0.41031734191513397, 'recall': 0.5552110970123428, 'f1-score': 0.4718923489834186, 'support': 69352}, 'accuracy': 0.4202780290219828, 'macro avg': {'precision': 0.4227626901458547, 'recall': 0.4187517812178423, 'f1-score': 0.41442954502196105, 'support': 203432}, 'weighted avg': {'precision': 0.42264582194573513, 'recall': 0.4202780290219828, 'f1-score': 0.415077639593322, 'support': 203432}}
[[23200 15592 28636]
 [16158 23793 26701]
 [13923 16924 38505]]
testing model on single stock: results/universal/W0/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
19053/19053 - 245s - 245s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.081624
{'0': {'precision': 0.3189804693332925, 'recall': 0.2939738034411213, 'f1-score': 0.30596703851627416, 'support': 1133584}, '1': {'precision': 0.5712623962699458, 'recall': 0.3596326800954192, 'f1-score': 0.44139158499030995, 'support': 2630078}, '2': {'precision': 0.2805661014379914, 'recall': 0.5483902247194038, 'f1-score': 0.37121306047434294, 'support': 1113789}, 'accuracy': 0.3874763682915523, 'macro avg': {'precision': 0.3902696556804099, 'recall': 0.4006655694186481, 'f1-score': 0.37285722799364235, 'support': 4877451}, 'weighted avg': {'precision': 0.4462468725078113, 'recall': 0.3874763682915523, 'f1-score': 0.3938915347115193, 'support': 4877451}}
[[ 333244  372897  427443]
 [ 545455  945862 1138761]
 [ 166017  336981  610791]]
Evaluating performance on  train set...
4812/4812 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1349759
{'0': {'precision': 0.40386406208188386, 'recall': 0.1858930933653247, 'f1-score': 0.2545981480887933, 'support': 405943}, '1': {'precision': 0.34051172784286277, 'recall': 0.7013680297763575, 'f1-score': 0.458448372619551, 'support': 406497}, '2': {'precision': 0.39782513466546643, 'recall': 0.19703739378391524, 'f1-score': 0.26354468122423924, 'support': 419428}, 'accuracy': 0.35978611344722, 'macro avg': {'precision': 0.38073364153007105, 'recall': 0.3614328389751991, 'f1-score': 0.32553040064419453, 'support': 1231868}, 'weighted avg': {'precision': 0.38090264977182103, 'recall': 0.35978611344722, 'f1-score': 0.3249116323427988, 'support': 1231868}}
[[ 75462 267489  62992]
 [ 59291 285104  62102]
 [ 52097 284688  82643]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0946395
{'0': {'precision': 0.406134435501414, 'recall': 0.18466212158677453, 'f1-score': 0.2538865388071082, 'support': 141545}, '1': {'precision': 0.3982310526124658, 'recall': 0.5893656916958282, 'f1-score': 0.47530274098278547, 'support': 167458}, '2': {'precision': 0.37200222691714724, 'recall': 0.36373089538697745, 'f1-score': 0.3678200667621756, 'support': 143290}, 'accuracy': 0.3912309056297577, 'macro avg': {'precision': 0.392122571677009, 'recall': 0.3792529028898601, 'f1-score': 0.3656697821840231, 'support': 452293}, 'weighted avg': {'precision': 0.3923949151907811, 'recall': 0.3912309056297577, 'f1-score': 0.3719592253280496, 'support': 452293}}
[[26138 73691 41716]
 [22495 98694 46269]
 [15725 75446 52119]]
training model: results/universal/W0/deepLOB_L1/h100
Epoch 1/50
8838/8838 - 201s - loss: 3.2280 - accuracy100: 0.4046 - val_loss: 3.3169 - val_accuracy100: 0.3561 - 201s/epoch - 23ms/step
Epoch 2/50
8838/8838 - 202s - loss: 3.2079 - accuracy100: 0.4148 - val_loss: 3.3380 - val_accuracy100: 0.3479 - 202s/epoch - 23ms/step
Epoch 3/50
8838/8838 - 200s - loss: 3.1969 - accuracy100: 0.4197 - val_loss: 3.3675 - val_accuracy100: 0.3505 - 200s/epoch - 23ms/step
Epoch 4/50
8838/8838 - 200s - loss: 3.1899 - accuracy100: 0.4225 - val_loss: 3.3950 - val_accuracy100: 0.3500 - 200s/epoch - 23ms/step
Epoch 5/50
8838/8838 - 198s - loss: 3.1847 - accuracy100: 0.4245 - val_loss: 3.4147 - val_accuracy100: 0.3491 - 198s/epoch - 22ms/step
Epoch 6/50
8838/8838 - 201s - loss: 3.1797 - accuracy100: 0.4265 - val_loss: 3.4155 - val_accuracy100: 0.3473 - 201s/epoch - 23ms/step
Epoch 7/50
8838/8838 - 201s - loss: 3.1748 - accuracy100: 0.4279 - val_loss: 3.4079 - val_accuracy100: 0.3490 - 201s/epoch - 23ms/step
Epoch 8/50
8838/8838 - 200s - loss: 3.1698 - accuracy100: 0.4299 - val_loss: 3.4352 - val_accuracy100: 0.3494 - 200s/epoch - 23ms/step
Epoch 9/50
8838/8838 - 209s - loss: 3.1658 - accuracy100: 0.4313 - val_loss: 3.4425 - val_accuracy100: 0.3493 - 209s/epoch - 24ms/step
Epoch 10/50
8838/8838 - 207s - loss: 3.1624 - accuracy100: 0.4325 - val_loss: 3.4552 - val_accuracy100: 0.3486 - 207s/epoch - 23ms/step
Epoch 11/50
8838/8838 - 204s - loss: 3.1593 - accuracy100: 0.4337 - val_loss: 3.4686 - val_accuracy100: 0.3490 - 204s/epoch - 23ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 436s - 436s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0854791
{'0': {'precision': 0.3363325406391504, 'recall': 0.19378492450238646, 'f1-score': 0.2458933360290331, 'support': 2397493}, '1': {'precision': 0.4444190705274093, 'recall': 0.46917914669039107, 'f1-score': 0.4564635883768974, 'support': 3641820}, '2': {'precision': 0.32407617130414224, 'recall': 0.4334452690690521, 'f1-score': 0.3708654984091004, 'support': 2409716}, 'accuracy': 0.3808418695213379, 'macro avg': {'precision': 0.368275927490234, 'recall': 0.3654697800872766, 'f1-score': 0.3577408076050103, 'support': 8449029}, 'weighted avg': {'precision': 0.37942593243472605, 'recall': 0.3808418695213379, 'f1-score': 0.37229914853687807, 'support': 8449029}}
[[ 464598 1117192  815703]
 [ 570391 1708666 1362763]
 [ 346376 1018860 1044480]]
Evaluating performance on  train set...
8838/8838 - 118s - 118s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1090436
{'0': {'precision': 0.3628119863373008, 'recall': 0.3319069462385372, 'f1-score': 0.3466720505153526, 'support': 750147}, '1': {'precision': 0.3398354976314487, 'recall': 0.4821337577488147, 'f1-score': 0.3986673818199915, 'support': 747695}, '2': {'precision': 0.38220635318193025, 'recall': 0.2575860670217081, 'f1-score': 0.3077592925390005, 'support': 764230}, 'accuracy': 0.3564532870748588, 'macro avg': {'precision': 0.36161794571689326, 'recall': 0.35720892366968665, 'f1-score': 0.35103290829144823, 'support': 2262072}, 'weighted avg': {'precision': 0.36176973447739047, 'recall': 0.3564532870748588, 'f1-score': 0.3507118654335136, 'support': 2262072}}
[[248979 348592 152576]
 [221588 360489 165618]
 [215681 351694 196855]]
Evaluating performance on  val set...
3279/3279 - 45s - 45s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062983
{'0': {'precision': 0.36219276754767255, 'recall': 0.2317846343921709, 'f1-score': 0.28267310483986446, 'support': 276813}, '1': {'precision': 0.33869604565410877, 'recall': 0.4846232052082404, 'f1-score': 0.39872737838773864, 'support': 280325}, '2': {'precision': 0.3800128919379345, 'recall': 0.35153812571209525, 'f1-score': 0.3652213353688554, 'support': 281739}, 'accuracy': 0.35649445627904924, 'macro avg': {'precision': 0.36030056837990526, 'recall': 0.3559819884375022, 'f1-score': 0.3488739395321528, 'support': 838877}, 'weighted avg': {'precision': 0.36032587342705025, 'recall': 0.35649445627904924, 'f1-score': 0.34917864755150785, 'support': 838877}}
[[ 64161 135581  77071]
 [ 59958 135852  84515]
 [ 53027 129670  99042]]
testing model out of sample: results/universal/W0/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 305s - 305s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1085565
{'0': {'precision': 0.38113038619966894, 'recall': 0.282009882614425, 'f1-score': 0.3241622942463504, 'support': 1947258}, '1': {'precision': 0.32801916701376255, 'recall': 0.46641124201537754, 'f1-score': 0.38516105464469136, 'support': 1921506}, '2': {'precision': 0.35877149332443337, 'recall': 0.30319585744621597, 'f1-score': 0.3286507421223227, 'support': 1964199}, 'accuracy': 0.34988992729767016, 'macro avg': {'precision': 0.35597368217928826, 'recall': 0.35053899402533945, 'f1-score': 0.34599136367112154, 'support': 5832963}, 'weighted avg': {'precision': 0.3561052246548967, 'recall': 0.34988992729767016, 'f1-score': 0.3457680697205839, 'support': 5832963}}
[[549146 975736 422376]
 [383273 896212 642021]
 [508416 860246 595537]]
Evaluating performance on  train set...
6334/6334 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034049
{'0': {'precision': 0.37416806583909057, 'recall': 0.24787389227234602, 'f1-score': 0.29820012503701754, 'support': 548420}, '1': {'precision': 0.3349894313980857, 'recall': 0.5137578482141164, 'f1-score': 0.40554698338046163, 'support': 527190}, '2': {'precision': 0.3842489806552755, 'recall': 0.31644079297254674, 'f1-score': 0.347063869672038, 'support': 545290}, 'accuracy': 0.35741810105496946, 'macro avg': {'precision': 0.3644688259641506, 'recall': 0.359357511153003, 'f1-score': 0.35027032602983904, 'support': 1620900}, 'weighted avg': {'precision': 0.36481674111157136, 'recall': 0.35741810105496946, 'f1-score': 0.34955252281733135, 'support': 1620900}}
[[135939 278020 134461]
 [114292 270848 142050]
 [113079 259659 172552]]
Evaluating performance on  val set...
2156/2156 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028093
{'0': {'precision': 0.35231537338603774, 'recall': 0.29259948183086426, 'f1-score': 0.31969273109434304, 'support': 180636}, '1': {'precision': 0.3471898188311196, 'recall': 0.43579591707280974, 'f1-score': 0.386479340702613, 'support': 189178}, '2': {'precision': 0.3834900795224988, 'recall': 0.34617334009123163, 'f1-score': 0.3638774759749717, 'support': 181516}, 'accuracy': 0.3593727894364537, 'macro avg': {'precision': 0.3609984239132187, 'recall': 0.35818957966496856, 'f1-score': 0.3566831825906425, 'support': 551330}, 'weighted avg': {'precision': 0.3608203809123388, 'recall': 0.3593727894364537, 'f1-score': 0.35715631077298465, 'support': 551330}}
[[52854 81467 46315]
 [52033 82443 54702]
 [45132 73548 62836]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0861204
{'0': {'precision': 0.31361986332338615, 'recall': 0.4251217034987567, 'f1-score': 0.36095602720886144, 'support': 57106}, '1': {'precision': 0.5177939093484419, 'recall': 0.48225475466305107, 'f1-score': 0.4993928469784651, 'support': 109156}, '2': {'precision': 0.27048489419280425, 'recall': 0.21062995526229422, 'f1-score': 0.23683418305413934, 'support': 57893}, 'accuracy': 0.39754634070174655, 'macro avg': {'precision': 0.3672995556215441, 'recall': 0.37266880447470063, 'f1-score': 0.36572768574715525, 'support': 224155}, 'weighted avg': {'precision': 0.40190524352920004, 'recall': 0.39754634070174655, 'f1-score': 0.39631291675012315, 'support': 224155}}
[[24277 23108  9721]
 [33348 52641 23167]
 [19784 25915 12194]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1132334
{'0': {'precision': 0.35824602250679083, 'recall': 0.1596734580926355, 'f1-score': 0.22089295114131216, 'support': 28909}, '1': {'precision': 0.29881999074502547, 'recall': 0.5196137598068798, 'f1-score': 0.37943444730077125, 'support': 24855}, '2': {'precision': 0.3731242287943319, 'recall': 0.3413195455869502, 'f1-score': 0.3565139673303288, 'support': 27464}, 'accuracy': 0.33122814792928545, 'macro avg': {'precision': 0.34339674734871606, 'recall': 0.3402022544954885, 'f1-score': 0.3189471219241374, 'support': 81228}, 'weighted avg': {'precision': 0.34509268914935676, 'recall': 0.33122814792928545, 'f1-score': 0.31525997329695443, 'support': 81228}}
[[ 4616 16116  8177]
 [ 4368 12915  7572]
 [ 3901 14189  9374]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026411
{'0': {'precision': 0.30094760919289837, 'recall': 0.36032863849765256, 'f1-score': 0.32797198646803966, 'support': 7668}, '1': {'precision': 0.4116697603099023, 'recall': 0.45806393678160917, 'f1-score': 0.43362944701831935, 'support': 11136}, '2': {'precision': 0.3285917496443812, 'recall': 0.21030042918454936, 'f1-score': 0.2564631245043616, 'support': 7689}, 'accuracy': 0.3578681161061412, 'macro avg': {'precision': 0.3470697063823939, 'recall': 0.3428976681546037, 'f1-score': 0.3393548526635735, 'support': 26493}, 'weighted avg': {'precision': 0.35551136832815705, 'recall': 0.3578681161061412, 'f1-score': 0.3516299278506386, 'support': 26493}}
[[2763 3626 1279]
 [4010 5101 2025]
 [2408 3664 1617]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09432
{'0': {'precision': 0.34438594415522955, 'recall': 0.5349629263753999, 'f1-score': 0.41902302638238154, 'support': 174113}, '1': {'precision': 0.4297025802639354, 'recall': 0.4170734505040721, 'f1-score': 0.42329383763646705, 'support': 235383}, '2': {'precision': 0.3948158956312763, 'recall': 0.21308134148601074, 'f1-score': 0.27678329672974517, 'support': 194292}, 'accuracy': 0.3854266729381836, 'macro avg': {'precision': 0.38963480668348033, 'recall': 0.3883725727884942, 'f1-score': 0.3730333869161979, 'support': 603788}, 'weighted avg': {'precision': 0.39387388013500985, 'recall': 0.3854266729381836, 'f1-score': 0.37491687457371753, 'support': 603788}}
[[93144 58499 22470]
 [96222 98172 40989]
 [81098 71794 41400]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922296
{'0': {'precision': 0.38348936170212766, 'recall': 0.3160141065202581, 'f1-score': 0.3464973470575958, 'support': 49906}, '1': {'precision': 0.3513184231137412, 'recall': 0.4690822472258264, 'f1-score': 0.40174817345728664, 'support': 51637}, '2': {'precision': 0.3956784958409214, 'recall': 0.32704121069118425, 'f1-score': 0.3581005835449241, 'support': 49162}, 'accuracy': 0.37205799409442286, 'macro avg': {'precision': 0.37682876021893, 'recall': 0.37071252147908956, 'f1-score': 0.36878203468660214, 'support': 150705}, 'weighted avg': {'precision': 0.37644269076647763, 'recall': 0.37205799409442286, 'f1-score': 0.3692134164314777, 'support': 150705}}
[[15771 23226 10909]
 [13768 24222 13647]
 [11586 21498 16078]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0979705
{'0': {'precision': 0.42125669271955196, 'recall': 0.34659982783938426, 'f1-score': 0.38029890549474965, 'support': 19749}, '1': {'precision': 0.32310914939777063, 'recall': 0.4710951134380454, 'f1-score': 0.3833148435766585, 'support': 18336}, '2': {'precision': 0.4132727157921324, 'recall': 0.3156498673740053, 'f1-score': 0.3579240949360166, 'support': 20735}, 'accuracy': 0.37449846990819446, 'macro avg': {'precision': 0.3858795193031517, 'recall': 0.3777816028838117, 'f1-score': 0.37384594800247495, 'support': 58820}, 'weighted avg': {'precision': 0.38784660914358754, 'recall': 0.37449846990819446, 'f1-score': 0.3733515838989413, 'support': 58820}}
[[6845 8787 4117]
 [4523 8638 5175]
 [4881 9309 6545]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
1625/1625 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1139933
{'0': {'precision': 0.3715018725487305, 'recall': 0.3686239511934632, 'f1-score': 0.37005731658509183, 'support': 136703}, '1': {'precision': 0.3372060252468105, 'recall': 0.5819473986047491, 'f1-score': 0.42699328337141734, 'support': 137753}, '2': {'precision': 0.4101097141780854, 'recall': 0.12319388945860886, 'f1-score': 0.18947185224262925, 'support': 141395}, 'accuracy': 0.35583899040762196, 'macro avg': {'precision': 0.3729392039912088, 'recall': 0.35792174641894037, 'f1-score': 0.3288408173997128, 'support': 415851}, 'weighted avg': {'precision': 0.3732683704381218, 'recall': 0.35583899040762196, 'f1-score': 0.32751616242654513, 'support': 415851}}
[[50392 75149 11162]
 [43695 80165 13893]
 [41557 82419 17419]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1146247
{'0': {'precision': 0.3603897555088723, 'recall': 0.42367715832063474, 'f1-score': 0.3894792773645058, 'support': 38062}, '1': {'precision': 0.3457296353247148, 'recall': 0.47800524934383204, 'f1-score': 0.40124701190830275, 'support': 38100}, '2': {'precision': 0.3879181228157763, 'recall': 0.17799328039095907, 'f1-score': 0.24401989008113062, 'support': 39288}, 'accuracy': 0.3579991338241663, 'macro avg': {'precision': 0.3646791712164545, 'recall': 0.3598918960184753, 'f1-score': 0.34491539311797975, 'support': 115450}, 'weighted avg': {'precision': 0.36491971580109617, 'recall': 0.3579991338241663, 'f1-score': 0.3438624932894034, 'support': 115450}}
[[16126 16941  4995]
 [13849 18212  6039]
 [14771 17524  6993]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1113819
{'0': {'precision': 0.3671108876037214, 'recall': 0.3835292572404282, 'f1-score': 0.37514051710293883, 'support': 15227}, '1': {'precision': 0.35884973673552045, 'recall': 0.4740502942750134, 'f1-score': 0.40848317196864914, 'support': 14952}, '2': {'precision': 0.37303180809468456, 'recall': 0.2362152034261242, 'f1-score': 0.28926127750235586, 'support': 14944}, 'accuracy': 0.3647363872082973, 'macro avg': {'precision': 0.3663308108113088, 'recall': 0.3645982516471886, 'f1-score': 0.3576283221913146, 'support': 45123}, 'weighted avg': {'precision': 0.36633437691151594, 'recall': 0.3647363872082973, 'f1-score': 0.35774717044959103, 'support': 45123}}
[[5840 6395 2992]
 [4923 7088 2941]
 [5145 6269 3530]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1102043
{'0': {'precision': 0.3315271343481138, 'recall': 0.15587168541729465, 'f1-score': 0.2120468540210195, 'support': 102841}, '1': {'precision': 0.36347858176639164, 'recall': 0.53637554882407, 'f1-score': 0.43331695027685074, 'support': 117524}, '2': {'precision': 0.32557168519687335, 'recall': 0.32116208009655267, 'f1-score': 0.32335184970875286, 'support': 104399}, 'accuracy': 0.34670098902587726, 'macro avg': {'precision': 0.340192467103793, 'recall': 0.33780310477930575, 'f1-score': 0.3229052180022077, 'support': 324764}, 'weighted avg': {'precision': 0.34117512171877473, 'recall': 0.34670098902587726, 'f1-score': 0.32789921769794794, 'support': 324764}}
[[16030 55722 31089]
 [16120 63037 38367]
 [16202 54668 33529]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111408
{'0': {'precision': 0.3898413510747185, 'recall': 0.1484965154247283, 'f1-score': 0.2150697017822481, 'support': 41038}, '1': {'precision': 0.33378205469957883, 'recall': 0.6096153846153847, 'f1-score': 0.4313742377786199, 'support': 41080}, '2': {'precision': 0.37187081410924244, 'recall': 0.29648527422455323, 'f1-score': 0.3299265832144932, 'support': 42137}, 'accuracy': 0.35113275119713494, 'macro avg': {'precision': 0.36516473996117993, 'recall': 0.3515323914215554, 'f1-score': 0.3254568409251204, 'support': 124255}, 'weighted avg': {'precision': 0.36521344546766044, 'recall': 0.35113275119713494, 'f1-score': 0.32553217614256735, 'support': 124255}}
[[ 6094 24844 10100]
 [ 5035 25043 11002]
 [ 4503 25141 12493]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1283629
{'0': {'precision': 0.34195222331573766, 'recall': 0.2602301354939743, 'f1-score': 0.2955459325703681, 'support': 14687}, '1': {'precision': 0.32857142857142857, 'recall': 0.5952941176470589, 'f1-score': 0.42343096234309624, 'support': 15300}, '2': {'precision': 0.3190397101011626, 'recall': 0.13603296208073135, 'f1-score': 0.1907384004332912, 'support': 15533}, 'accuracy': 0.3304701230228471, 'macro avg': {'precision': 0.32985445399610963, 'recall': 0.3305190717405882, 'f1-score': 0.30323843178225185, 'support': 45520}, 'weighted avg': {'precision': 0.3296361814143773, 'recall': 0.3304701230228471, 'f1-score': 0.30276617771179, 'support': 45520}}
[[3822 8886 1979]
 [3661 9108 2531]
 [3694 9726 2113]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1276867
{'0': {'precision': 0.3402303297716459, 'recall': 0.5760147730044249, 'f1-score': 0.42778443361684626, 'support': 143505}, '1': {'precision': 0.343718684006409, 'recall': 0.4018055105133924, 'f1-score': 0.37049920663981445, 'support': 151093}, '2': {'precision': 0.3805006477495925, 'recall': 0.06114267295217374, 'f1-score': 0.10535572745208079, 'support': 148914}, 'accuracy': 0.34379227619545805, 'macro avg': {'precision': 0.3548165538425491, 'recall': 0.34632098548999707, 'f1-score': 0.3012131225695805, 'support': 443512}, 'weighted avg': {'precision': 0.3549399205781201, 'recall': 0.34379227619545805, 'f1-score': 0.30000988602972223, 'support': 443512}}
[[82661 54421  6423]
 [81982 60710  8401]
 [78313 61496  9105]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1166074
{'0': {'precision': 0.35747333001950066, 'recall': 0.4362643687100437, 'f1-score': 0.39295822008014125, 'support': 64289}, '1': {'precision': 0.35011964839955456, 'recall': 0.45759982659049037, 'f1-score': 0.3967087469211616, 'support': 64587}, '2': {'precision': 0.36478063908059954, 'recall': 0.1793744767372324, 'f1-score': 0.24049148618446767, 'support': 66888}, 'accuracy': 0.3555301281134427, 'macro avg': {'precision': 0.3574578724998849, 'recall': 0.3577462240125888, 'f1-score': 0.34338615106192344, 'support': 195764}, 'weighted avg': {'precision': 0.35754392039204785, 'recall': 0.3555301281134427, 'f1-score': 0.34210127181726946, 'support': 195764}}
[[28047 26212 10030]
 [24169 29555 10863]
 [26243 28647 11998]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1119086
{'0': {'precision': 0.3570656977315133, 'recall': 0.3400673400673401, 'f1-score': 0.34835928143712575, 'support': 21384}, '1': {'precision': 0.34288318395868145, 'recall': 0.5160257875725847, 'f1-score': 0.41200306647683715, 'support': 21871}, '2': {'precision': 0.3773716883798199, 'recall': 0.20109024833434283, 'f1-score': 0.262370820668693, 'support': 21463}, 'accuracy': 0.35344108285175685, 'macro avg': {'precision': 0.35910685669000486, 'recall': 0.35239445865808916, 'f1-score': 0.34091105619421863, 'support': 64718}, 'weighted avg': {'precision': 0.3590070698159257, 'recall': 0.35344108285175685, 'f1-score': 0.3413501477978083, 'support': 64718}}
[[ 7272 10556  3556]
 [ 7020 11286  3565]
 [ 6074 11073  4316]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
4693/4693 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0729132
{'0': {'precision': 0.41051009845694614, 'recall': 0.4040654815813307, 'f1-score': 0.407262296321751, 'support': 379832}, '1': {'precision': 0.40291082590524097, 'recall': 0.5954291310338545, 'f1-score': 0.48060751507620136, 'support': 439085}, '2': {'precision': 0.44865637346933057, 'recall': 0.20941992021450526, 'f1-score': 0.28555224625920705, 'support': 382275}, 'accuracy': 0.4120715089677587, 'macro avg': {'precision': 0.4206924326105059, 'recall': 0.40297151094323014, 'f1-score': 0.3911406858857198, 'support': 1201192}, 'weighted avg': {'precision': 0.4198721660464687, 'recall': 0.4120715089677587, 'f1-score': 0.3953392032518162, 'support': 1201192}}
[[153477 179863  46492]
 [125754 261444  51887]
 [ 94638 207581  80056]]
Evaluating performance on  train set...
1497/1497 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0876515
{'0': {'precision': 0.4185025323719468, 'recall': 0.3941352005451256, 'f1-score': 0.4059535333978702, 'support': 127677}, '1': {'precision': 0.348093086728628, 'recall': 0.5340121488953387, 'f1-score': 0.4214597754384208, 'support': 126102}, '2': {'precision': 0.43856188446697, 'recall': 0.2354409832264049, 'f1-score': 0.30639466457434283, 'support': 129370}, 'accuracy': 0.3865885073430963, 'macro avg': {'precision': 0.40171916785584827, 'recall': 0.387862777555623, 'f1-score': 0.377935991136878, 'support': 383149}, 'weighted avg': {'precision': 0.4021024020467192, 'recall': 0.3865885073430963, 'f1-score': 0.37744096328571486, 'support': 383149}}
[[50322 59577 17778]
 [37547 67340 21215]
 [32374 66537 30459]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.084872
{'0': {'precision': 0.40510724223694256, 'recall': 0.35669217926757874, 'f1-score': 0.3793612360198316, 'support': 46121}, '1': {'precision': 0.34829251758325563, 'recall': 0.4362436052558959, 'f1-score': 0.38733814576775916, 'support': 47109}, '2': {'precision': 0.4135607548671026, 'recall': 0.3569083535394717, 'f1-score': 0.38315173573518235, 'support': 46603}, 'accuracy': 0.38356468072629496, 'macro avg': {'precision': 0.38898683822910024, 'recall': 0.38328137935431544, 'f1-score': 0.3832837058409244, 'support': 139833}, 'weighted avg': {'precision': 0.3887840151402831, 'recall': 0.38356468072629496, 'f1-score': 0.3833118978775448, 'support': 139833}}
[[16451 19632 10038]
 [13010 20551 13548]
 [11148 18822 16633]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
6677/6677 - 88s - 88s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0697236
{'0': {'precision': 0.4724174832658371, 'recall': 0.05010281380464487, 'f1-score': 0.09059722783911085, 'support': 449356}, '1': {'precision': 0.48854501555146895, 'recall': 0.45122676041024895, 'f1-score': 0.46914493565476895, 'support': 827790}, '2': {'precision': 0.30894767526762096, 'recall': 0.6413384551302819, 'f1-score': 0.4170112946702969, 'support': 432140}, 'accuracy': 0.39383871394254677, 'macro avg': {'precision': 0.42330339136164236, 'recall': 0.38088934311505857, 'f1-score': 0.3255844860547256, 'support': 1709286}, 'weighted avg': {'precision': 0.43889960920753096, 'recall': 0.39383871394254677, 'f1-score': 0.35644775366869835, 'support': 1709286}}
[[ 22514 244403 182439]
 [ 16785 373521 437484]
 [  8358 146634 277148]]
Evaluating performance on  train set...
2262/2262 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025277
{'0': {'precision': 0.3815909693772289, 'recall': 0.3324722148037061, 'f1-score': 0.3553422093409413, 'support': 194708}, '1': {'precision': 0.3456429312932682, 'recall': 0.547552334015932, 'f1-score': 0.4237765270737782, 'support': 190937}, '2': {'precision': 0.3933973049459302, 'recall': 0.21730645795805123, 'f1-score': 0.2799647884975759, 'support': 193188}, 'accuracy': 0.3649826461172739, 'macro avg': {'precision': 0.3735437352054758, 'recall': 0.36577700225922977, 'f1-score': 0.3530278416374318, 'support': 578833}, 'weighted avg': {'precision': 0.37367336932368855, 'recall': 0.3649826461172739, 'f1-score': 0.3527587874335286, 'support': 578833}}
[[ 64735  98329  31644]
 [ 53300 104548  33089]
 [ 51610  99597  41981]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0982699
{'0': {'precision': 0.3411778080945885, 'recall': 0.3550848961722771, 'f1-score': 0.3479924626757501, 'support': 67612}, '1': {'precision': 0.35929222805447375, 'recall': 0.3918147166277582, 'f1-score': 0.3748493700355202, 'support': 75819}, '2': {'precision': 0.3892572717640223, 'recall': 0.3343020269179399, 'f1-score': 0.35969268912804886, 'support': 68133}, 'accuracy': 0.3615548959180201, 'macro avg': {'precision': 0.3632424359710282, 'recall': 0.36040054657265846, 'f1-score': 0.3608448406131064, 'support': 211564}, 'weighted avg': {'precision': 0.36315326377290835, 'recall': 0.3615548959180201, 'f1-score': 0.36138526763304385, 'support': 211564}}
[[24008 27765 15839]
 [26214 29707 19898]
 [20146 25210 22777]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
5633/5633 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0767745
{'0': {'precision': 0.28900230359837953, 'recall': 0.5240024816782349, 'f1-score': 0.3725388264344662, 'support': 361046}, '1': {'precision': 0.5036880310297843, 'recall': 0.4545078075355034, 'f1-score': 0.47783581070024334, 'support': 700285}, '2': {'precision': 0.3634133305859096, 'recall': 0.14832208944476127, 'f1-score': 0.21066442702500932, 'support': 380503}, 'accuracy': 0.39110674321731903, 'macro avg': {'precision': 0.38536788840469116, 'recall': 0.3756107928861665, 'f1-score': 0.3536796880532396, 'support': 1441834}, 'weighted avg': {'precision': 0.4129103357547425, 'recall': 0.39110674321731903, 'f1-score': 0.3809615741488793, 'support': 1441834}}
[[189189 136552  35305]
 [318445 318285  63555]
 [146994 177072  56437]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974058
{'0': {'precision': 0.35546002545690336, 'recall': 0.12004347226615408, 'f1-score': 0.1794756754134937, 'support': 123297}, '1': {'precision': 0.3412720148310441, 'recall': 0.5274176088035879, 'f1-score': 0.41440087487329363, 'support': 122859}, '2': {'precision': 0.39218545495931256, 'recall': 0.43779131166675933, 'f1-score': 0.4137353999467213, 'support': 125939}, 'accuracy': 0.3620957013665865, 'macro avg': {'precision': 0.36297249841575335, 'recall': 0.3617507975788337, 'f1-score': 0.3358706500778362, 'support': 372095}, 'weighted avg': {'precision': 0.36320546430617967, 'recall': 0.3620957013665865, 'f1-score': 0.3363310766643079, 'support': 372095}}
[[14801 65854 42642]
 [15254 64798 42807]
 [11584 59220 55135]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0963991
{'0': {'precision': 0.408406026962728, 'recall': 0.0419534845831127, 'f1-score': 0.07609056994053115, 'support': 49102}, '1': {'precision': 0.30515806988352745, 'recall': 0.5872349509036573, 'f1-score': 0.40161561108542787, 'support': 42162}, '2': {'precision': 0.41414141414141414, 'recall': 0.4553150722427513, 'f1-score': 0.43375334096983587, 'support': 51147}, 'accuracy': 0.3518478207441841, 'macro avg': {'precision': 0.3759018369958899, 'recall': 0.36150116924317377, 'f1-score': 0.30381984066526496, 'support': 142411}, 'weighted avg': {'precision': 0.3798984501719955, 'recall': 0.3518478207441841, 'f1-score': 0.30091986356663436, 'support': 142411}}
[[ 2060 29974 17068]
 [ 1527 24759 15876]
 [ 1457 26402 23288]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
11876/11876 - 157s - 157s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.128544
{'0': {'precision': 0.39419061432608693, 'recall': 0.31800432194715095, 'f1-score': 0.35202249452277834, 'support': 1160588}, '1': {'precision': 0.22711215961064127, 'recall': 0.4740741166628816, 'f1-score': 0.3071024065759506, 'support': 695714}, '2': {'precision': 0.42948866487530823, 'recall': 0.23640946499450524, 'f1-score': 0.3049571125968671, 'support': 1183857}, 'accuracy': 0.32194599032484816, 'macro avg': {'precision': 0.35026381293734543, 'recall': 0.3428293012015126, 'f1-score': 0.32136067123186535, 'support': 3040159}, 'weighted avg': {'precision': 0.3697014426035381, 'recall': 0.32194599032484816, 'f1-score': 0.3234153670940804, 'support': 3040159}}
[[369072 579045 212471]
 [206593 329820 159301]
 [360613 543369 279875]]
Evaluating performance on  train set...
2538/2538 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968546
{'0': {'precision': 0.3895580935189364, 'recall': 0.100893675939079, 'f1-score': 0.16027650625209772, 'support': 222452}, '1': {'precision': 0.3245767623276309, 'recall': 0.5071606192294609, 'f1-score': 0.3958281914933399, 'support': 208711}, '2': {'precision': 0.3848074796723506, 'recall': 0.4683560527689026, 'f1-score': 0.42249089512672494, 'support': 218462}, 'accuracy': 0.35499249567057917, 'macro avg': {'precision': 0.3663141118396393, 'recall': 0.3588034493124808, 'f1-score': 0.32619853095738754, 'support': 649625}, 'weighted avg': {'precision': 0.3670833623795538, 'recall': 0.35499249567057917, 'f1-score': 0.3241342820469235, 'support': 649625}}
[[ 22444 120724  79284]
 [ 18569 105850  84292]
 [ 16601  99543 102318]]
Evaluating performance on  val set...
795/795 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032542
{'0': {'precision': 0.37829340009898393, 'recall': 0.18901738308240598, 'f1-score': 0.25208062544861964, 'support': 68745}, '1': {'precision': 0.3274317525129132, 'recall': 0.4487767584097859, 'f1-score': 0.37861929732902466, 'support': 65400}, '2': {'precision': 0.38287641920298066, 'recall': 0.4390145337509201, 'f1-score': 0.4090282586917497, 'support': 69287}, 'accuracy': 0.3576723426009674, 'macro avg': {'precision': 0.36286719060495926, 'recall': 0.35893622508103734, 'f1-score': 0.346576060489798, 'support': 203432}, 'weighted avg': {'precision': 0.3635031600803516, 'recall': 0.3576723426009674, 'f1-score': 0.3462155688473732, 'support': 203432}}
[[12994 32936 22815]
 [ 9837 29350 26213]
 [11518 27351 30418]]
testing model on single stock: results/universal/W0/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
19053/19053 - 247s - 247s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883806
{'0': {'precision': 0.37907279285672046, 'recall': 0.009292862522025339, 'f1-score': 0.018141003464491615, 'support': 1379661}, '1': {'precision': 0.4475939094931035, 'recall': 0.4503766614578075, 'f1-score': 0.4489809736924486, 'support': 2149543}, '2': {'precision': 0.3106372089310268, 'recall': 0.6176405361925522, 'f1-score': 0.4133722547877633, 'support': 1348247}, 'accuracy': 0.3718452527765015, 'macro avg': {'precision': 0.37910130376028356, 'recall': 0.359103353390795, 'f1-score': 0.2934980773149012, 'support': 4877451}, 'weighted avg': {'precision': 0.3903534835078118, 'recall': 0.3718452527765015, 'f1-score': 0.31726823017093325, 'support': 4877451}}
[[  12821  686553  680287]
 [  13736  968104 1167703]
 [   7265  508250  832732]]
Evaluating performance on  train set...
4812/4812 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1211624
{'0': {'precision': 0.34653901318644204, 'recall': 0.3971324918121936, 'f1-score': 0.37011476409096195, 'support': 408229}, '1': {'precision': 0.3359420893696007, 'recall': 0.44086085065403663, 'f1-score': 0.38131605239668603, 'support': 406017}, '2': {'precision': 0.3592064631646325, 'recall': 0.19887601706806635, 'f1-score': 0.25601072683558346, 'support': 417622}, 'accuracy': 0.34433315907223827, 'macro avg': {'precision': 0.3472291885735584, 'recall': 0.3456231198447655, 'f1-score': 0.3358138477744104, 'support': 1231868}, 'weighted avg': {'precision': 0.34734078300061805, 'recall': 0.34433315907223827, 'f1-score': 0.33512364266184735, 'support': 1231868}}
[[162121 174729  71379]
 [150236 178997  76784]
 [155472 179095  83055]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1151341
{'0': {'precision': 0.33681860001533387, 'recall': 0.2388314282996045, 'f1-score': 0.27948532393895775, 'support': 147154}, '1': {'precision': 0.35178748276598637, 'recall': 0.4603285520080296, 'f1-score': 0.39880464274117655, 'support': 157418}, '2': {'precision': 0.3537450426525595, 'recall': 0.3399516656399564, 'f1-score': 0.34671122127022047, 'support': 147721}, 'accuracy': 0.34894857979230276, 'macro avg': {'precision': 0.34745037514462657, 'recall': 0.3463705486491968, 'f1-score': 0.3416670626501183, 'support': 452293}, 'weighted avg': {'precision': 0.3475566893018269, 'recall': 0.34894857979230276, 'f1-score': 0.34297002369526425, 'support': 452293}}
[[35145 67900 44109]
 [37320 72464 47634]
 [31879 65624 50218]]
training model: results/universal/W0/deepLOB_L1/h200
Epoch 1/50
8838/8838 - 199s - loss: 3.2463 - accuracy200: 0.3963 - val_loss: 3.3640 - val_accuracy200: 0.3354 - 199s/epoch - 23ms/step
Epoch 2/50
8838/8838 - 199s - loss: 3.2283 - accuracy200: 0.4089 - val_loss: 3.4253 - val_accuracy200: 0.3324 - 199s/epoch - 23ms/step
Epoch 3/50
8838/8838 - 198s - loss: 3.2189 - accuracy200: 0.4141 - val_loss: 3.4263 - val_accuracy200: 0.3327 - 198s/epoch - 22ms/step
Epoch 4/50
8838/8838 - 198s - loss: 3.2130 - accuracy200: 0.4167 - val_loss: 3.4520 - val_accuracy200: 0.3358 - 198s/epoch - 22ms/step
Epoch 5/50
8838/8838 - 202s - loss: 3.2078 - accuracy200: 0.4191 - val_loss: 3.4798 - val_accuracy200: 0.3343 - 202s/epoch - 23ms/step
Epoch 6/50
8838/8838 - 203s - loss: 3.2039 - accuracy200: 0.4208 - val_loss: 3.5361 - val_accuracy200: 0.3347 - 203s/epoch - 23ms/step
Epoch 7/50
8838/8838 - 201s - loss: 3.2007 - accuracy200: 0.4224 - val_loss: 3.5209 - val_accuracy200: 0.3337 - 201s/epoch - 23ms/step
Epoch 8/50
8838/8838 - 202s - loss: 3.1984 - accuracy200: 0.4233 - val_loss: 3.5786 - val_accuracy200: 0.3338 - 202s/epoch - 23ms/step
Epoch 9/50
8838/8838 - 200s - loss: 3.1955 - accuracy200: 0.4243 - val_loss: 3.6082 - val_accuracy200: 0.3338 - 200s/epoch - 23ms/step
Epoch 10/50
8838/8838 - 198s - loss: 3.1933 - accuracy200: 0.4251 - val_loss: 3.6155 - val_accuracy200: 0.3338 - 198s/epoch - 22ms/step
Epoch 11/50
8838/8838 - 199s - loss: 3.1912 - accuracy200: 0.4262 - val_loss: 3.5704 - val_accuracy200: 0.3350 - 199s/epoch - 23ms/step
testing model in sample: results/universal/W0/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 430s - 430s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1163759
{'0': {'precision': 0.2998758454617082, 'recall': 0.3075074707455006, 'f1-score': 0.3036437133355163, 'support': 2287255}, '1': {'precision': 0.45703347362634644, 'recall': 0.09174044452625763, 'f1-score': 0.15280775068541474, 'support': 3824431}, '2': {'precision': 0.26452907727039143, 'recall': 0.6038895446667434, 'f1-score': 0.3679017008354631, 'support': 2337343}, 'accuracy': 0.291832351386177, 'macro avg': {'precision': 0.3404794654528154, 'recall': 0.3343791533128339, 'f1-score': 0.27478438828546475, 'support': 8449029}, 'weighted avg': {'precision': 0.36123449198010915, 'recall': 0.291832351386177, 'f1-score': 0.2531445643567636, 'support': 8449029}}
[[ 703348  201068 1382839]
 [ 932026  350855 2541550]
 [ 710090  215756 1411497]]
Evaluating performance on  train set...
8838/8838 - 119s - 119s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.124813
{'0': {'precision': 0.3312013055134631, 'recall': 0.47350205840319104, 'f1-score': 0.3897697137567621, 'support': 750096}, '1': {'precision': 0.3218196180672403, 'recall': 0.1214056056382447, 'f1-score': 0.17630181473464007, 'support': 748318}, '2': {'precision': 0.34532001463528605, 'recall': 0.41031718387026656, 'f1-score': 0.37502318895738856, 'support': 763658}, 'accuracy': 0.3356940008982915, 'macro avg': {'precision': 0.33278031273866315, 'recall': 0.33507494930390075, 'f1-score': 0.3136982391495969, 'support': 2262072}, 'weighted avg': {'precision': 0.3328641082819738, 'recall': 0.3356940008982915, 'f1-score': 0.31417390031860615, 'support': 2262072}}
[[355172  92432 302492]
 [365906  90850 291562]
 [351297  99019 313342]]
Evaluating performance on  val set...
3279/3279 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211733
{'0': {'precision': 0.32423004991725307, 'recall': 0.3508150660751266, 'f1-score': 0.33699906477524016, 'support': 274763}, '1': {'precision': 0.34053237346131626, 'recall': 0.0803844916569926, 'f1-score': 0.13006616746393887, 'support': 285988}, '2': {'precision': 0.3406289286949772, 'recall': 0.5806145416106369, 'f1-score': 0.42936338908963284, 'support': 278126}, 'accuracy': 0.3348095131944254, 'macro avg': {'precision': 0.33513045069118225, 'recall': 0.3372713664475853, 'f1-score': 0.29880954044293734, 'support': 838877}, 'weighted avg': {'precision': 0.33522477675402756, 'recall': 0.3348095131944254, 'f1-score': 0.29707496938104094, 'support': 838877}}
[[ 96391  22027 156345]
 [106752  22989 156247]
 [ 94149  22493 161484]]
testing model out of sample: results/universal/W0/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 302s - 302s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1251838
{'0': {'precision': 0.34763418985291245, 'recall': 0.37333546950977325, 'f1-score': 0.36002672734137464, 'support': 1941163}, '1': {'precision': 0.3180454665590507, 'recall': 0.13906087735190048, 'f1-score': 0.19351156336658545, 'support': 1929716}, '2': {'precision': 0.32204734304340266, 'recall': 0.47673850864692846, 'f1-score': 0.38441434512472594, 'support': 1962084}, 'accuracy': 0.3306131034947419, 'macro avg': {'precision': 0.3292423331517886, 'recall': 0.3297116185028674, 'f1-score': 0.31265087861089536, 'support': 5832963}, 'weighted avg': {'precision': 0.32923850047598213, 'recall': 0.3306131034947419, 'f1-score': 0.31314207857642534, 'support': 5832963}}
[[ 724705  288127  928331]
 [ 620555  268348 1040813]
 [ 739417  287266  935401]]
Evaluating performance on  train set...
6334/6334 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205351
{'0': {'precision': 0.33427629979290513, 'recall': 0.37079874331993445, 'f1-score': 0.3515916017609211, 'support': 537607}, '1': {'precision': 0.3397892077671858, 'recall': 0.13568828263777716, 'f1-score': 0.1939331093108632, 'support': 547188}, '2': {'precision': 0.3369162553998159, 'recall': 0.5065612146874213, 'f1-score': 0.4046787582023186, 'support': 536105}, 'accuracy': 0.33633228453328395, 'macro avg': {'precision': 0.33699392098663566, 'recall': 0.337682746881711, 'f1-score': 0.31673448975803425, 'support': 1620900}, 'weighted avg': {'precision': 0.33701051565401535, 'recall': 0.33633228453328395, 'f1-score': 0.3159271282198347, 'support': 1620900}}
[[199344  71906 266357]
 [204822  74247 268119]
 [192179  72356 271570]]
Evaluating performance on  val set...
2156/2156 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201422
{'0': {'precision': 0.324171147308707, 'recall': 0.34557464268001264, 'f1-score': 0.3345308923860887, 'support': 177432}, '1': {'precision': 0.3657276368491322, 'recall': 0.1406745889095447, 'f1-score': 0.20319257044943737, 'support': 194726}, '2': {'precision': 0.32854711208111864, 'recall': 0.5267899002076217, 'f1-score': 0.40469498665466125, 'support': 179172}, 'accuracy': 0.33209692924382855, 'macro avg': {'precision': 0.339481965412986, 'recall': 0.33767971059905966, 'f1-score': 0.31413948316339574, 'support': 551330}, 'weighted avg': {'precision': 0.3402707235016429, 'recall': 0.33209692924382855, 'f1-score': 0.3109451180238234, 'support': 551330}}
[[ 61316  23469  92647]
 [ 67083  27393 100250]
 [ 60748  24038  94386]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1195627
{'0': {'precision': 0.3375344658125234, 'recall': 0.5448673846197049, 'f1-score': 0.4168430098286697, 'support': 71221}, '1': {'precision': 0.3262216104611149, 'recall': 0.08398405366069733, 'f1-score': 0.13357891240677555, 'support': 79015}, '2': {'precision': 0.3392350637071721, 'recall': 0.40773008292861107, 'f1-score': 0.37034215392933284, 'support': 73919}, 'accuracy': 0.33718186076598783, 'macro avg': {'precision': 0.3343303799936035, 'recall': 0.34552717373633773, 'f1-score': 0.30692135872159265, 'support': 224155}, 'weighted avg': {'precision': 0.33410746766473726, 'recall': 0.33718186076598783, 'f1-score': 0.3016574934448547, 'support': 224155}}
[[38806  7125 25290]
 [38964  6636 33415]
 [37199  6581 30139]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1253759
{'0': {'precision': 0.3301479915433404, 'recall': 0.2834016914086603, 'f1-score': 0.30499404308509603, 'support': 27551}, '1': {'precision': 0.32711315610088615, 'recall': 0.14334254349936523, 'f1-score': 0.1993353756685186, 'support': 26782}, '2': {'precision': 0.3315082238994808, 'recall': 0.5650492656627626, 'f1-score': 0.41786161100952746, 'support': 26895}, 'accuracy': 0.33047717535825083, 'macro avg': {'precision': 0.3295897905145691, 'recall': 0.330597833523596, 'f1-score': 0.3073970099210474, 'support': 81228}, 'weighted avg': {'precision': 0.3295977439242754, 'recall': 0.33047717535825083, 'f1-score': 0.3075279329823828, 'support': 81228}}
[[ 7808  3873 15870]
 [ 8168  3839 14775]
 [ 7674  4024 15197]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147653
{'0': {'precision': 0.35294117647058826, 'recall': 0.5880467139912984, 'f1-score': 0.44112342179850556, 'support': 8734}, '1': {'precision': 0.3793584379358438, 'recall': 0.11863482717260931, 'f1-score': 0.18074590912866517, 'support': 9171}, '2': {'precision': 0.3471839523862008, 'recall': 0.36679087098276664, 'f1-score': 0.356718192627824, 'support': 8588}, 'accuracy': 0.35382931340354057, 'macro avg': {'precision': 0.35982785559754427, 'recall': 0.3578241373822248, 'f1-score': 0.3261958411849983, 'support': 26493}, 'weighted avg': {'precision': 0.3602196902085998, 'recall': 0.35382931340354057, 'f1-score': 0.32362845041689836, 'support': 26493}}
[[5136  909 2689]
 [4849 1088 3234]
 [4567  871 3150]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1203734
{'0': {'precision': 0.2935642349752313, 'recall': 0.5757304966976565, 'f1-score': 0.38885288649961985, 'support': 174573}, '1': {'precision': 0.4443793625225753, 'recall': 0.1230503068148028, 'f1-score': 0.19273231505297808, 'support': 221958}, '2': {'precision': 0.38284848393920756, 'recall': 0.36936750025330867, 'f1-score': 0.3759871910730423, 'support': 207257}, 'accuracy': 0.33848469992778923, 'macro avg': {'precision': 0.37359736047900477, 'recall': 0.35604943458858934, 'f1-score': 0.3191907975418801, 'support': 603788}, 'weighted avg': {'precision': 0.3796530768662265, 'recall': 0.33848469992778923, 'f1-score': 0.31234087361731694, 'support': 603788}}
[[100507  15261  58805]
 [130046  27312  64600]
 [111815  18888  76554]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1188089
{'0': {'precision': 0.3319304893389033, 'recall': 0.42106299988180135, 'f1-score': 0.37122139724718856, 'support': 50762}, '1': {'precision': 0.32581412063913306, 'recall': 0.11796853104856468, 'f1-score': 0.17321908849076292, 'support': 49954}, '2': {'precision': 0.3490216196408941, 'recall': 0.4763447958550881, 'f1-score': 0.4028626051059942, 'support': 49989}, 'accuracy': 0.3389336783782887, 'macro avg': {'precision': 0.3355887432063102, 'recall': 0.33845877559515136, 'f1-score': 0.3157676969479819, 'support': 150705}, 'weighted avg': {'precision': 0.3355722492714729, 'recall': 0.3389336783782887, 'f1-score': 0.3160852372527315, 'support': 150705}}
[[21374  6124 23264]
 [22912  5893 21149]
 [20107  6070 23812]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1166004
{'0': {'precision': 0.34015961451588617, 'recall': 0.4590763603109282, 'f1-score': 0.3907712932730772, 'support': 19683}, '1': {'precision': 0.320148045338885, 'recall': 0.07948997760036758, 'f1-score': 0.1273580565013343, 'support': 17411}, '2': {'precision': 0.4036444348977911, 'recall': 0.5189634539261714, 'f1-score': 0.45409694113856497, 'support': 21726}, 'accuracy': 0.36883713022781367, 'macro avg': {'precision': 0.3546506982508541, 'recall': 0.35250993061248903, 'f1-score': 0.32407543030432545, 'support': 58820}, 'weighted avg': {'precision': 0.3576851122492507, 'recall': 0.36883713022781367, 'f1-score': 0.33618994611382474, 'support': 58820}}
[[ 9036  1426  9221]
 [ 8590  1384  7437]
 [ 8938  1513 11275]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.11698
{'0': {'precision': 0.265860492019594, 'recall': 0.6975603741012654, 'f1-score': 0.384990092686387, 'support': 105426}, '1': {'precision': 0.49376754632229086, 'recall': 0.11259058202954958, 'f1-score': 0.18336878101672296, 'support': 195265}, '2': {'precision': 0.2851833472352736, 'recall': 0.23454324418200764, 'f1-score': 0.25739621005284197, 'support': 115160}, 'accuracy': 0.29466323274442047, 'macro avg': {'precision': 0.3482704618590528, 'recall': 0.34823140010427417, 'f1-score': 0.27525169458531734, 'support': 415851}, 'weighted avg': {'precision': 0.37822643791140076, 'recall': 0.29466323274442047, 'f1-score': 0.2549836794584376, 'support': 415851}}
[[ 73541   9860  22025]
 [127604  21985  45676]
 [ 75470  12680  27010]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1259328
{'0': {'precision': 0.33382085186401217, 'recall': 0.5911361293903116, 'f1-score': 0.4266870141637656, 'support': 37839}, '1': {'precision': 0.34463894967177244, 'recall': 0.12417544873984915, 'f1-score': 0.1825698885261104, 'support': 38051}, '2': {'precision': 0.34882247941498246, 'recall': 0.30626895854398384, 'f1-score': 0.3261636202115918, 'support': 39560}, 'accuracy': 0.3396188826331745, 'macro avg': {'precision': 0.342427426983589, 'recall': 0.34052684555804813, 'f1-score': 0.31180684096715594, 'support': 115450}, 'weighted avg': {'precision': 0.3425268183048911, 'recall': 0.3396188826331745, 'f1-score': 0.3117835389590327, 'support': 115450}}
[[22368  4181 11290]
 [21998  4725 11328]
 [22640  4804 12116]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.127752
{'0': {'precision': 0.3321013727560718, 'recall': 0.5113821138211382, 'f1-score': 0.4026888604353393, 'support': 14760}, '1': {'precision': 0.3379798903107861, 'recall': 0.09271564694082247, 'f1-score': 0.14551357733175918, 'support': 15952}, '2': {'precision': 0.2999056551417948, 'recall': 0.3749913260703629, 'f1-score': 0.33327166204131975, 'support': 14411}, 'accuracy': 0.3198147286306318, 'macro avg': {'precision': 0.3233289727362176, 'recall': 0.32636302894410785, 'f1-score': 0.2938246999361394, 'support': 45123}, 'weighted avg': {'precision': 0.323897167040438, 'recall': 0.3198147286306318, 'f1-score': 0.2896017128138486, 'support': 45123}}
[[7548 1480 5732]
 [7590 1479 6883]
 [7590 1417 5404]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1269/1269 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1266111
{'0': {'precision': 0.3206656508619402, 'recall': 0.21031283372686568, 'f1-score': 0.2540219751610861, 'support': 102067}, '1': {'precision': 0.33391371067697573, 'recall': 0.09716366259349266, 'f1-score': 0.15052647682903306, 'support': 116453}, '2': {'precision': 0.31078522434981426, 'recall': 0.655058167990663, 'f1-score': 0.42156399539645045, 'support': 106244}, 'accuracy': 0.31523506299959353, 'macro avg': {'precision': 0.3217881952962434, 'recall': 0.3208448881036738, 'f1-score': 0.2753708157955232, 'support': 324764}, 'weighted avg': {'precision': 0.32218380027285404, 'recall': 0.31523506299959353, 'f1-score': 0.27172089847347136, 'support': 324764}}
[[21466 10288 70313]
 [21111 11315 84027]
 [24365 12283 69596]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1204143
{'0': {'precision': 0.35798327499027616, 'recall': 0.35816611942113585, 'f1-score': 0.35807467386414754, 'support': 41115}, '1': {'precision': 0.3041813773448467, 'recall': 0.1746659827556728, 'f1-score': 0.22190845616757177, 'support': 40941}, '2': {'precision': 0.3400268411340379, 'recall': 0.4803194388492618, 'f1-score': 0.3981769784596647, 'support': 42199}, 'accuracy': 0.3391895698362239, 'macro avg': {'precision': 0.3340638311563869, 'recall': 0.3377171803420235, 'f1-score': 0.326053369497128, 'support': 124255}, 'weighted avg': {'precision': 0.3341576982022119, 'recall': 0.3391895698362239, 'f1-score': 0.32682841442115307, 'support': 124255}}
[[14726  7760 18629]
 [13078  7151 20712]
 [13332  8598 20269]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1290178
{'0': {'precision': 0.33008526187576126, 'recall': 0.574231032125769, 'f1-score': 0.4192011177365834, 'support': 14630}, '1': {'precision': 0.31658410002359044, 'recall': 0.17957982068780945, 'f1-score': 0.22916666666666663, 'support': 14946}, '2': {'precision': 0.3117936329911138, 'recall': 0.22666833918715504, 'f1-score': 0.2625022698383875, 'support': 15944}, 'accuracy': 0.32291300527240774, 'macro avg': {'precision': 0.3194876649634885, 'recall': 0.3268263973335778, 'f1-score': 0.30362335141387914, 'support': 45520}, 'weighted avg': {'precision': 0.3192454091521373, 'recall': 0.32291300527240774, 'f1-score': 0.3019194539277123, 'support': 45520}}
[[8401 2684 3545]
 [7830 2684 4432]
 [9220 3110 3614]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
1733/1733 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1323837
{'0': {'precision': 0.31616662729348766, 'recall': 0.7634307946583978, 'f1-score': 0.4471506408059762, 'support': 136738}, '1': {'precision': 0.40481530247565584, 'recall': 0.17201246841396609, 'f1-score': 0.24143525310229372, 'support': 162651}, '2': {'precision': 0.2989711701526286, 'recall': 0.09174108227000548, 'f1-score': 0.1403996856881942, 'support': 144123}, 'accuracy': 0.32826620249282995, 'macro avg': {'precision': 0.3399843666405907, 'recall': 0.3423947817807898, 'f1-score': 0.27632852653215473, 'support': 443512}, 'weighted avg': {'precision': 0.343089314385478, 'recall': 0.32826620249282995, 'f1-score': 0.2720264470303134, 'support': 443512}}
[[104390  20605  11743]
 [115413  27978  19260]
 [110371  20530  13222]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1303749
{'0': {'precision': 0.3303496677888812, 'recall': 0.5815368213104216, 'f1-score': 0.42134738922747494, 'support': 63781}, '1': {'precision': 0.3317661399155457, 'recall': 0.11812939827014292, 'f1-score': 0.17422415271189348, 'support': 64514}, '2': {'precision': 0.3554160125588697, 'recall': 0.3187834412841453, 'f1-score': 0.336104513064133, 'support': 67469}, 'accuracy': 0.33826444085735885, 'macro avg': {'precision': 0.3391772734210989, 'recall': 0.3394832202882366, 'f1-score': 0.3105586850011672, 'support': 195764}, 'weighted avg': {'precision': 0.3394554456544029, 'recall': 0.33826444085735885, 'f1-score': 0.3105294651330003, 'support': 195764}}
[[37091  7193 19497]
 [37383  7621 19510]
 [37804  8157 21508]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221617
{'0': {'precision': 0.3238383195416932, 'recall': 0.5794969150450878, 'f1-score': 0.41548984244734066, 'support': 21070}, '1': {'precision': 0.325666569000879, 'recall': 0.09976662777129522, 'f1-score': 0.15274151436031333, 'support': 22282}, '2': {'precision': 0.3605111947691698, 'recall': 0.34063465318730696, 'f1-score': 0.3502911873706503, 'support': 21366}, 'accuracy': 0.3354708118297846, 'macro avg': {'precision': 0.33667202777058064, 'recall': 0.3399660653345633, 'f1-score': 0.3061741813927681, 'support': 64718}, 'weighted avg': {'precision': 0.3365749570545929, 'recall': 0.3354708118297846, 'f1-score': 0.3035025636253173, 'support': 64718}}
[[12210  2222  6638]
 [13787  2223  6272]
 [11707  2381  7278]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
4693/4693 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119095
{'0': {'precision': 0.305638048541825, 'recall': 0.6633147039178859, 'f1-score': 0.41846046911970725, 'support': 350342}, '1': {'precision': 0.4191974838735526, 'recall': 0.0844860303617571, 'f1-score': 0.14062930530447115, 'support': 495360}, '2': {'precision': 0.3181143738527133, 'recall': 0.3051675152606262, 'f1-score': 0.3115064779932004, 'support': 355490}, 'accuracy': 0.318618505617753, 'macro avg': {'precision': 0.3476499687560303, 'recall': 0.3509894165134231, 'f1-score': 0.29019875080579294, 'support': 1201192}, 'weighted avg': {'precision': 0.3561612045158011, 'recall': 0.318618505617753, 'f1-score': 0.27223278893779024, 'support': 1201192}}
[[232387  25320  92635]
 [313606  41851 139903]
 [214341  32665 108484]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1173912
{'0': {'precision': 0.3465059649652673, 'recall': 0.5766364314603212, 'f1-score': 0.43288654901116913, 'support': 127335}, '1': {'precision': 0.3600504681585763, 'recall': 0.12794173168890008, 'f1-score': 0.18879597012413457, 'support': 127136}, '2': {'precision': 0.35733889646857253, 'recall': 0.3500909246335815, 'f1-score': 0.3536777810053936, 'support': 128678}, 'accuracy': 0.3516673670034373, 'macro avg': {'precision': 0.35463177653080535, 'recall': 0.35155636259426765, 'f1-score': 0.3251201000468991, 'support': 383149}, 'weighted avg': {'precision': 0.3546384510684983, 'recall': 0.3516673670034373, 'f1-score': 0.3252910034484006, 'support': 383149}}
[[73426 12886 41023]
 [70874 16266 39996]
 [67604 16025 45049]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1169018
{'0': {'precision': 0.3242852037169407, 'recall': 0.39346501593634137, 'f1-score': 0.3555411878802128, 'support': 46121}, '1': {'precision': 0.3629027770048417, 'recall': 0.1357099748184221, 'f1-score': 0.19754619812178126, 'support': 48051}, '2': {'precision': 0.34726268511774705, 'recall': 0.501215479293051, 'f1-score': 0.4102720387218214, 'support': 45661}, 'accuracy': 0.34007709195969477, 'macro avg': {'precision': 0.34481688861317644, 'recall': 0.3434634900159382, 'f1-score': 0.3211198082412718, 'support': 139833}, 'weighted avg': {'precision': 0.34505846748371355, 'recall': 0.34007709195969477, 'f1-score': 0.3191209446428961, 'support': 139833}}
[[18147  5636 22338]
 [20850  6521 20680]
 [16963  5812 22886]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
6677/6677 - 89s - 89s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1159712
{'0': {'precision': 0.3439500137899552, 'recall': 0.07236702564040996, 'f1-score': 0.11957540580618177, 'support': 499758}, '1': {'precision': 0.426483953513855, 'recall': 0.08852337508913748, 'f1-score': 0.1466146087233986, 'support': 747441}, '2': {'precision': 0.2723068556529565, 'recall': 0.8538889862731477, 'f1-score': 0.4129296455775553, 'support': 462087}, 'accuracy': 0.2907079330199861, 'macro avg': {'precision': 0.34758027431892224, 'recall': 0.33825979566756503, 'f1-score': 0.2263732200357119, 'support': 1709286}, 'weighted avg': {'precision': 0.3606727146294402, 'recall': 0.2907079330199861, 'f1-score': 0.21070432715748408, 'support': 1709286}}
[[ 36166  49379 414213]
 [ 41065  66166 640210]
 [ 27918  39598 394571]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232797
{'0': {'precision': 0.3328562268867833, 'recall': 0.5344328267413989, 'f1-score': 0.41021916162646144, 'support': 192331}, '1': {'precision': 0.32172566925193896, 'recall': 0.10446336547200179, 'f1-score': 0.1577166160108236, 'support': 196959}, '2': {'precision': 0.3358388936066966, 'recall': 0.36513086740211986, 'f1-score': 0.34987285715007915, 'support': 189543}, 'accuracy': 0.3326883574364281, 'macro avg': {'precision': 0.33014026324847295, 'recall': 0.3346756865385068, 'f1-score': 0.30593621159578804, 'support': 578833}, 'weighted avg': {'precision': 0.33004553726972835, 'recall': 0.3326883574364281, 'f1-score': 0.30453951227807025, 'support': 578833}}
[[102788  21093  68450]
 [107967  20575  68417]
 [ 98051  22284  69208]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1181185
{'0': {'precision': 0.31182140123753066, 'recall': 0.36189816627021165, 'f1-score': 0.3349987109002098, 'support': 66422}, '1': {'precision': 0.38234735241955914, 'recall': 0.15575451859688053, 'f1-score': 0.22134220682195271, 'support': 77513}, '2': {'precision': 0.32696138932351143, 'recall': 0.49747889219121977, 'f1-score': 0.394586226308876, 'support': 67629}, 'accuracy': 0.3297111039685391, 'macro avg': {'precision': 0.34037671432686706, 'recall': 0.3383771923527707, 'f1-score': 0.31697571467701285, 'support': 211564}, 'weighted avg': {'precision': 0.34250044071607794, 'recall': 0.3297111039685391, 'f1-score': 0.3124050157486469, 'support': 211564}}
[[24038  9367 33017]
 [29202 12073 36238]
 [23849 10136 33644]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
5633/5633 - 75s - 75s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.125757
{'0': {'precision': 0.29311903425042113, 'recall': 0.750582298136646, 'f1-score': 0.421595626120524, 'support': 417312}, '1': {'precision': 0.39863345379823684, 'recall': 0.0974635892697477, 'f1-score': 0.1566316419461022, 'support': 569269}, '2': {'precision': 0.33599941893006224, 'recall': 0.17274131087549122, 'f1-score': 0.22817508675417522, 'support': 455253}, 'accuracy': 0.3102652593849223, 'macro avg': {'precision': 0.3425839689929067, 'recall': 0.340262399427295, 'f1-score': 0.2688007849402671, 'support': 1441834}, 'weighted avg': {'precision': 0.3483178379047434, 'recall': 0.3102652593849223, 'f1-score': 0.2559100734735915, 'support': 1441834}}
[[313227  37630  66455]
 [424831  55483  88955]
 [330542  46070  78641]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1164256
{'0': {'precision': 0.34550565260808996, 'recall': 0.22804761943510915, 'f1-score': 0.27474951471539777, 'support': 122891}, '1': {'precision': 0.3431547619047619, 'recall': 0.1219113460756405, 'f1-score': 0.17990757966752685, 'support': 122950}, '2': {'precision': 0.3430704159287026, 'recall': 0.6719945506677016, 'f1-score': 0.45423979269507114, 'support': 126254}, 'accuracy': 0.3436111745656351, 'macro avg': {'precision': 0.3439102768138515, 'recall': 0.3406511720594838, 'f1-score': 0.3029656290259986, 'support': 372095}, 'weighted avg': {'precision': 0.3439025663433093, 'recall': 0.3436111745656351, 'f1-score': 0.3043133348202364, 'support': 372095}}
[[28025 14154 80712]
 [26213 14989 81748]
 [26875 14537 84842]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1114776
{'0': {'precision': 0.37107438016528926, 'recall': 0.0760855750900233, 'f1-score': 0.12627878361750747, 'support': 47210}, '1': {'precision': 0.34356558649963764, 'recall': 0.14181926964251373, 'f1-score': 0.20076530998079162, 'support': 46799}, '2': {'precision': 0.3469619884845653, 'recall': 0.8129829345894798, 'f1-score': 0.48635787782344037, 'support': 48402}, 'accuracy': 0.3481402419756901, 'macro avg': {'precision': 0.35386731838316404, 'recall': 0.3436292597740056, 'f1-score': 0.2711339904739132, 'support': 142411}, 'weighted avg': {'precision': 0.3538392507378628, 'recall': 0.3481402419756901, 'f1-score': 0.27313852945898676, 'support': 142411}}
[[ 3592  6533 37085]
 [ 3184  6637 36978]
 [ 2904  6148 39350]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
11876/11876 - 157s - 157s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1309587
{'0': {'precision': 0.3752382921698605, 'recall': 0.4182718391517881, 'f1-score': 0.39558817056223156, 'support': 1128020}, '1': {'precision': 0.26184066802076283, 'recall': 0.1945772690194058, 'f1-score': 0.22325258482211238, 'support': 745344}, '2': {'precision': 0.38280851396249815, 'recall': 0.40318393548138276, 'f1-score': 0.3927321268909969, 'support': 1166795}, 'accuracy': 0.35763886033592324, 'macro avg': {'precision': 0.3399624913843738, 'recall': 0.3386776812175256, 'f1-score': 0.33719096075844696, 'support': 3040159}, 'weighted avg': {'precision': 0.35034244236817436, 'recall': 0.35763886033592324, 'f1-score': 0.3522411902584837, 'support': 3040159}}
[[471819 200722 455479]
 [297330 145027 302987]
 [488236 208126 470433]]
Evaluating performance on  train set...
2538/2538 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134809
{'0': {'precision': 0.3479003153676523, 'recall': 0.1357858448439416, 'f1-score': 0.1953330160325644, 'support': 216105}, '1': {'precision': 0.35374251637263077, 'recall': 0.17093289629757064, 'f1-score': 0.23049005692657543, 'support': 220882}, '2': {'precision': 0.3345225996955594, 'recall': 0.7213856413246926, 'f1-score': 0.45708479343965286, 'support': 212638}, 'accuracy': 0.33941735616701946, 'macro avg': {'precision': 0.34538847714528087, 'recall': 0.34270146082206826, 'f1-score': 0.29430262213293085, 'support': 649625}, 'weighted avg': {'precision': 0.3455078987231254, 'recall': 0.33941735616701946, 'f1-score': 0.292964621883693, 'support': 649625}}
[[ 29344  35622 151139]
 [ 29113  37756 154013]
 [ 25889  33355 153394]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201522
{'0': {'precision': 0.3340328786288912, 'recall': 0.18684345182554254, 'f1-score': 0.23964174379662784, 'support': 66446}, '1': {'precision': 0.35355463158612227, 'recall': 0.14860760944304377, 'f1-score': 0.20925869894099847, 'support': 69808}, '2': {'precision': 0.32738108279836114, 'recall': 0.6672720235791479, 'f1-score': 0.439253114879398, 'support': 67178}, 'accuracy': 0.33237150497463525, 'macro avg': {'precision': 0.3383228643377916, 'recall': 0.33424102828257807, 'f1-score': 0.2960511858723414, 'support': 203432}, 'weighted avg': {'precision': 0.3385352194117328, 'recall': 0.33237150497463525, 'f1-score': 0.2951320948294868, 'support': 203432}}
[[12415  9576 44455]
 [11792 10374 47642]
 [12960  9392 44826]]
testing model on single stock: results/universal/W0/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
19053/19053 - 252s - 252s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1135767
{'0': {'precision': 0.33384944541410955, 'recall': 0.028622780602126696, 'f1-score': 0.052725139993494013, 'support': 1242961}, '1': {'precision': 0.49485612597016715, 'recall': 0.08865854378743458, 'f1-score': 0.15037573444736776, 'support': 2421391}, '2': {'precision': 0.24861565463119323, 'recall': 0.8888499619569384, 'f1-score': 0.3885515516920482, 'support': 1213099}, 'accuracy': 0.2723793637291282, 'macro avg': {'precision': 0.35910707533848996, 'recall': 0.33537709544883326, 'f1-score': 0.19721747537763665, 'support': 4877451}, 'weighted avg': {'precision': 0.39258157842238534, 'recall': 0.2723793637291282, 'f1-score': 0.1847287120971121, 'support': 4877451}}
[[  35577  112894 1094490]
 [  42399  214677 2164315]
 [  28590  106246 1078263]]
Evaluating performance on  train set...
4812/4812 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.130894
{'0': {'precision': 0.3226198586676285, 'recall': 0.5327517874081173, 'f1-score': 0.4018751548454134, 'support': 407993}, '1': {'precision': 0.3089047944845008, 'recall': 0.11527555807599113, 'f1-score': 0.1678963788002038, 'support': 407337}, '2': {'precision': 0.3436642052155842, 'recall': 0.33507627155265546, 'f1-score': 0.33931590789468885, 'support': 416538}, 'accuracy': 0.32786548558774153, 'macro avg': {'precision': 0.32506295278923786, 'recall': 0.3277012056789213, 'f1-score': 0.30302914718010204, 'support': 1231868}, 'weighted avg': {'precision': 0.3252005872223354, 'recall': 0.32786548558774153, 'f1-score': 0.3033528161660351, 'support': 1231868}}
[[217359  51563 139071]
 [232895  46956 127486]
 [223477  53489 139572]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1252288
{'0': {'precision': 0.31916137329020694, 'recall': 0.3896845410857877, 'f1-score': 0.3509147778396675, 'support': 147119}, '1': {'precision': 0.3444703739541237, 'recall': 0.03811539164005769, 'f1-score': 0.06863623476041963, 'support': 158781}, '2': {'precision': 0.33126222574158065, 'recall': 0.5772407150615125, 'f1-score': 0.42095195397145635, 'support': 146393}, 'accuracy': 0.3269694644843055, 'macro avg': {'precision': 0.3316313243286371, 'recall': 0.33501354926245264, 'f1-score': 0.28016765552384787, 'support': 452293}, 'weighted avg': {'precision': 0.33196296103826256, 'recall': 0.3269694644843055, 'f1-score': 0.27448751271903754, 'support': 452293}}
[[57330  5763 84026]
 [66162  6052 86567]
 [56135  5754 84504]]
training model: results/universal/W0/deepOF_L1/h50
Epoch 1/50
8838/8838 - 189s - loss: 3.1936 - accuracy50: 0.4290 - val_loss: 3.2808 - val_accuracy50: 0.3617 - 189s/epoch - 21ms/step
Epoch 2/50
8838/8838 - 183s - loss: 3.1864 - accuracy50: 0.4334 - val_loss: 3.2774 - val_accuracy50: 0.3670 - 183s/epoch - 21ms/step
Epoch 3/50
8838/8838 - 187s - loss: 3.1787 - accuracy50: 0.4367 - val_loss: 3.2779 - val_accuracy50: 0.3663 - 187s/epoch - 21ms/step
Epoch 4/50
8838/8838 - 188s - loss: 3.1726 - accuracy50: 0.4389 - val_loss: 3.2766 - val_accuracy50: 0.3683 - 188s/epoch - 21ms/step
Epoch 5/50
8838/8838 - 197s - loss: 3.1676 - accuracy50: 0.4407 - val_loss: 3.2808 - val_accuracy50: 0.3683 - 197s/epoch - 22ms/step
Epoch 6/50
8838/8838 - 196s - loss: 3.1629 - accuracy50: 0.4422 - val_loss: 3.2870 - val_accuracy50: 0.3649 - 196s/epoch - 22ms/step
Epoch 7/50
8838/8838 - 194s - loss: 3.1585 - accuracy50: 0.4433 - val_loss: 3.2886 - val_accuracy50: 0.3673 - 194s/epoch - 22ms/step
Epoch 8/50
8838/8838 - 197s - loss: 3.1544 - accuracy50: 0.4442 - val_loss: 3.2947 - val_accuracy50: 0.3662 - 197s/epoch - 22ms/step
Epoch 9/50
8838/8838 - 195s - loss: 3.1494 - accuracy50: 0.4456 - val_loss: 3.2909 - val_accuracy50: 0.3696 - 195s/epoch - 22ms/step
Epoch 10/50
8838/8838 - 186s - loss: 3.1443 - accuracy50: 0.4473 - val_loss: 3.2967 - val_accuracy50: 0.3696 - 186s/epoch - 21ms/step
Epoch 11/50
8838/8838 - 184s - loss: 3.1398 - accuracy50: 0.4480 - val_loss: 3.2998 - val_accuracy50: 0.3713 - 184s/epoch - 21ms/step
Epoch 12/50
8838/8838 - 192s - loss: 3.1359 - accuracy50: 0.4492 - val_loss: 3.2934 - val_accuracy50: 0.3730 - 192s/epoch - 22ms/step
Epoch 13/50
8838/8838 - 188s - loss: 3.1319 - accuracy50: 0.4506 - val_loss: 3.2774 - val_accuracy50: 0.3807 - 188s/epoch - 21ms/step
Epoch 14/50
8838/8838 - 195s - loss: 3.1286 - accuracy50: 0.4512 - val_loss: 3.2883 - val_accuracy50: 0.3779 - 195s/epoch - 22ms/step
testing model in sample: results/universal/W0/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 443s - 443s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1368797
{'0': {'precision': 0.3169629914345474, 'recall': 0.5237951295455533, 'f1-score': 0.39493801372043924, 'support': 2024616}, '1': {'precision': 0.6666666666666666, 'recall': 0.014800092480666443, 'f1-score': 0.028957328257037136, 'support': 4394432}, '2': {'precision': 0.28929889859142044, 'recall': 0.713383935415349, 'f1-score': 0.411657963593062, 'support': 2029956}, 'accuracy': 0.3046110523796651, 'macro avg': {'precision': 0.4243095188975448, 'recall': 0.4173263858138562, 'f1-score': 0.2785177685235128, 'support': 8449004}, 'weighted avg': {'precision': 0.4922016502996834, 'recall': 0.3046110523796651, 'f1-score': 0.20860404192699716, 'support': 8449004}}
[[1060484   15925  948207]
 [1720058   65038 2609336]
 [ 565224   16594 1448138]]
Evaluating performance on  train set...
8838/8838 - 118s - 118s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997003
{'0': {'precision': 0.38177858017444455, 'recall': 0.4901073416752506, 'f1-score': 0.4292132269801805, 'support': 710628}, '1': {'precision': 0.542043936470239, 'recall': 0.017739449781945766, 'f1-score': 0.03435457867015066, 'support': 823419}, '2': {'precision': 0.37274114771807254, 'recall': 0.6772913893730795, 'f1-score': 0.48085056585741653, 'support': 728019}, 'accuracy': 0.3784027521743397, 'macro avg': {'precision': 0.4321878881209187, 'recall': 0.39504606027675865, 'f1-score': 0.3148061238359159, 'support': 2262066}, 'weighted avg': {'precision': 0.4372084910949355, 'recall': 0.3784027521743397, 'f1-score': 0.30209883265184084, 'support': 2262066}}
[[348284   5993 356351]
 [335393  14607 473419]
 [228590   6348 493081]]
Evaluating performance on  val set...
3279/3279 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1051003
{'0': {'precision': 0.3714294258373206, 'recall': 0.4897056388339103, 'f1-score': 0.42244496066553977, 'support': 253634}, '1': {'precision': 0.5655471289274107, 'recall': 0.01923720667405772, 'f1-score': 0.03720874975868368, 'support': 325619}, '2': {'precision': 0.36132696119562707, 'recall': 0.6866855916894242, 'f1-score': 0.47350199662956716, 'support': 259621}, 'accuracy': 0.3680505057970565, 'macro avg': {'precision': 0.4327678386534528, 'recall': 0.39854281239913075, 'f1-score': 0.3110519023512635, 'support': 838874}, 'weighted avg': {'precision': 0.44365195316532324, 'recall': 0.3680505057970565, 'f1-score': 0.28871242034927913, 'support': 838874}}
[[124206   2257 127171]
 [131406   6264 187949]
 [ 78788   2555 178278]]
testing model out of sample: results/universal/W0/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 304s - 304s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0909252
{'0': {'precision': 0.4010619165801474, 'recall': 0.44858985655893274, 'f1-score': 0.42349657428535487, 'support': 1909983}, '1': {'precision': 0.4848489893776431, 'recall': 0.014690029333649454, 'f1-score': 0.028516074258712797, 'support': 1982365}, '2': {'precision': 0.3844360726512766, 'recall': 0.7204102875929486, 'f1-score': 0.5013397547847105, 'support': 1940590}, 'accuracy': 0.39155927938887747, 'macro avg': {'precision': 0.423448992869689, 'recall': 0.3945633911618436, 'f1-score': 0.317784134442926, 'support': 5832938}, 'weighted avg': {'precision': 0.42400620539245437, 'recall': 0.39155927938887747, 'f1-score': 0.3151577197852608, 'support': 5832938}}
[[ 856799   14947 1038237]
 [ 752952   29121 1200292]
 [ 526575   15994 1398021]]
Evaluating performance on  train set...
6334/6334 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0939456
{'0': {'precision': 0.39629443406160764, 'recall': 0.47037958719470313, 'f1-score': 0.4301705317790501, 'support': 532842}, '1': {'precision': 0.4595477715331329, 'recall': 0.012735046914304653, 'f1-score': 0.02478329594575306, 'support': 552177}, '2': {'precision': 0.37602863320234786, 'recall': 0.682861424255374, 'f1-score': 0.4849898178208347, 'support': 535873}, 'accuracy': 0.38472458374771423, 'macro avg': {'precision': 0.4106236129323628, 'recall': 0.38865868612146065, 'f1-score': 0.3133145485152126, 'support': 1620892}, 'weighted avg': {'precision': 0.4111425193264867, 'recall': 0.38472458374771423, 'f1-score': 0.3101937952342012, 'support': 1620892}}
[[250638   4105 278099]
 [216035   7032 329110]
 [165781   4165 365927]]
Evaluating performance on  val set...
2156/2156 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967894
{'0': {'precision': 0.3882890589824403, 'recall': 0.4893770357844083, 'f1-score': 0.43301148317190613, 'support': 176222}, '1': {'precision': 0.49545607539548975, 'recall': 0.014941356191984247, 'f1-score': 0.029007926928401463, 'support': 197037}, '2': {'precision': 0.37196246071614164, 'recall': 0.6752980552700889, 'f1-score': 0.4797001749245551, 'support': 178071}, 'accuracy': 0.3798704949848548, 'macro avg': {'precision': 0.4185691983646906, 'recall': 0.3932054824154938, 'f1-score': 0.3139065283416209, 'support': 551330}, 'weighted avg': {'precision': 0.4213156922748422, 'recall': 0.3798704949848548, 'f1-score': 0.30370644502331, 'support': 551330}}
[[ 86239   1412  88571]
 [ 79627   2944 114466]
 [ 56234   1586 120251]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1239057
{'0': {'precision': 0.3152132231404959, 'recall': 0.3905691909427532, 'f1-score': 0.3488683511514061, 'support': 61034}, '1': {'precision': 0.5366614664586583, 'recall': 0.017130962222244354, 'f1-score': 0.03320206933827504, 'support': 100403}, '2': {'precision': 0.2900633085604184, 'recall': 0.6721413423054231, 'f1-score': 0.40524339888383093, 'support': 62713}, 'accuracy': 0.30207450368057104, 'macro avg': {'precision': 0.38064599938652427, 'recall': 0.3599471651568069, 'f1-score': 0.2624379397911707, 'support': 224150}, 'weighted avg': {'precision': 0.40736955319096685, 'recall': 0.30207450368057104, 'f1-score': 0.2232453606341621, 'support': 224150}}
[[23838   765 36431]
 [31946  1720 66737]
 [19841   720 42152]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1071143
{'0': {'precision': 0.3724481721791423, 'recall': 0.3398678652658941, 'f1-score': 0.35541293062765456, 'support': 27699}, '1': {'precision': 0.3745980707395498, 'recall': 0.008685927306616962, 'f1-score': 0.016978176121251867, 'support': 26825}, '2': {'precision': 0.33576734686500265, 'recall': 0.6957417325193813, 'f1-score': 0.45294289754717904, 'support': 26701}, 'accuracy': 0.3474792243767313, 'macro avg': {'precision': 0.3609378632612316, 'recall': 0.3480985083639641, 'f1-score': 0.2751113347653618, 'support': 81225}, 'weighted avg': {'precision': 0.361100142781421, 'recall': 0.3474792243767313, 'f1-score': 0.2757039168644532, 'support': 81225}}
[[ 9414   203 18082]
 [ 7924   233 18668]
 [ 7938   186 18577]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109016
{'0': {'precision': 0.3631534468187855, 'recall': 0.3659367396593674, 'f1-score': 0.36453978064594317, 'support': 8220}, '1': {'precision': 0.3972602739726027, 'recall': 0.008830694275274055, 'f1-score': 0.017277330950253203, 'support': 9852}, '2': {'precision': 0.33127674948585406, 'recall': 0.7077544234651466, 'f1-score': 0.4513100106012419, 'support': 8421}, 'accuracy': 0.34178839693503943, 'macro avg': {'precision': 0.3638968234257474, 'recall': 0.3608406191332627, 'f1-score': 0.27770904073247943, 'support': 26493}, 'weighted avg': {'precision': 0.36570456571354226, 'recall': 0.34178839693503943, 'f1-score': 0.26298323559825637, 'support': 26493}}
[[3008   67 5145]
 [2879   87 6886]
 [2396   65 5960]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
2359/2359 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1257691
{'0': {'precision': 0.3304403488207763, 'recall': 0.5573683140411271, 'f1-score': 0.4149024171935712, 'support': 142631}, '1': {'precision': 0.6928833231521075, 'recall': 0.014687648713657214, 'f1-score': 0.02876552955013045, 'support': 308899}, '2': {'precision': 0.3002918803430786, 'recall': 0.703434415085417, 'f1-score': 0.4209028779381654, 'support': 152253}, 'accuracy': 0.31656240735496033, 'macro avg': {'precision': 0.4412051841053208, 'recall': 0.4251634592800671, 'f1-score': 0.2881902748939557, 'support': 603783}, 'weighted avg': {'precision': 0.5082659543062553, 'recall': 0.31656240735496033, 'f1-score': 0.218865578948002, 'support': 603783}}
[[ 79498   1116  62017]
 [116826   4537 187536]
 [ 44258    895 107100]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1200622
{'0': {'precision': 0.3375179845967219, 'recall': 0.5850223710911714, 'f1-score': 0.4280692338655575, 'support': 40901}, '1': {'precision': 0.6095475596722479, 'recall': 0.024568507509836017, 'f1-score': 0.047233226131485596, 'support': 69642}, '2': {'precision': 0.31310468423308185, 'recall': 0.6003336570304524, 'f1-score': 0.4115598648048889, 'support': 40161}, 'accuracy': 0.3301106805393354, 'macro avg': {'precision': 0.4200567428340172, 'recall': 0.4033081785438199, 'f1-score': 0.29562077493397737, 'support': 150704}, 'weighted avg': {'precision': 0.45672000386300304, 'recall': 0.3301106805393354, 'f1-score': 0.24768109538574445, 'support': 150704}}
[[23928   513 16460]
 [31498  1711 36433]
 [15468   583 24110]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1084374
{'0': {'precision': 0.3599394168875426, 'recall': 0.5765754837144417, 'f1-score': 0.4432011562580134, 'support': 16487}, '1': {'precision': 0.632164242942686, 'recall': 0.028945203869805335, 'f1-score': 0.05535580524344569, 'support': 25531}, '2': {'precision': 0.34199743918053777, 'recall': 0.6359145288970894, 'f1-score': 0.4447867446556067, 'support': 16801}, 'accuracy': 0.35582039817065914, 'macro avg': {'precision': 0.44470036633692217, 'recall': 0.41381173882711214, 'f1-score': 0.31444790205235523, 'support': 58819}, 'weighted avg': {'precision': 0.47297651147532, 'recall': 0.35582039817065914, 'f1-score': 0.27530574514791356, 'support': 58819}}
[[ 9506   174  6807]
 [11043   739 13749]
 [ 5861   256 10684]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
1625/1625 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0988692
{'0': {'precision': 0.3839893035128236, 'recall': 0.5805211510897129, 'f1-score': 0.4622322369191151, 'support': 136045}, '1': {'precision': 0.4694229112833764, 'recall': 0.011622864698480853, 'f1-score': 0.02268407397644186, 'support': 140671}, '2': {'precision': 0.3988427001083759, 'recall': 0.59251060159563, 'f1-score': 0.4767594515033919, 'support': 139130}, 'accuracy': 0.39208745545225876, 'macro avg': {'precision': 0.41741830496819193, 'recall': 0.39488487246127457, 'f1-score': 0.32055858746631627, 'support': 415846}, 'weighted avg': {'precision': 0.4178590151537451, 'recall': 0.39208745545225876, 'f1-score': 0.3184037324626616, 'support': 415846}}
[[78977   684 56384]
 [71168  1635 67868]
 [55530  1164 82436]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0979176
{'0': {'precision': 0.38134541067025723, 'recall': 0.569845832244578, 'f1-score': 0.45691777449532245, 'support': 38270}, '1': {'precision': 0.48093023255813955, 'recall': 0.013617447189590686, 'f1-score': 0.02648497733152327, 'support': 37966}, '2': {'precision': 0.39810443115447836, 'recall': 0.5805875752320718, 'f1-score': 0.472333450901471, 'support': 39212}, 'accuracy': 0.390574111288199, 'macro avg': {'precision': 0.4201266914609583, 'recall': 0.3880169515554135, 'f1-score': 0.3185787342427722, 'support': 115448}, 'weighted avg': {'precision': 0.41978689132841174, 'recall': 0.390574111288199, 'f1-score': 0.3206024457422656, 'support': 115448}}
[[21808   240 16222]
 [19251   517 18198]
 [16128   318 22766]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997958
{'0': {'precision': 0.3882332965446982, 'recall': 0.6001312335958006, 'f1-score': 0.47146760142275373, 'support': 15240}, '1': {'precision': 0.4607329842931937, 'recall': 0.011786766675596035, 'f1-score': 0.022985503460885463, 'support': 14932}, '2': {'precision': 0.392390124156163, 'recall': 0.5559494348204134, 'f1-score': 0.4600653124481098, 'support': 14951}, 'accuracy': 0.3907984841433415, 'macro avg': {'precision': 0.4137854683313516, 'recall': 0.3892891450306033, 'f1-score': 0.31817280577724966, 'support': 45123}, 'weighted avg': {'precision': 0.41360204567661635, 'recall': 0.3907984841433415, 'f1-score': 0.31927891030677036, 'support': 45123}}
[[9146   94 6000]
 [7885  176 6871]
 [6527  112 8312]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1269/1269 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0912757
{'0': {'precision': 0.3845651700877638, 'recall': 0.5898593586308558, 'f1-score': 0.46558631868192174, 'support': 107863}, '1': {'precision': 0.3933658933658934, 'recall': 0.017637183160276647, 'f1-score': 0.03376065390526757, 'support': 109598}, '2': {'precision': 0.3870246954359104, 'recall': 0.556925571772074, 'f1-score': 0.45668497013744797, 'support': 107298}, 'accuracy': 0.38586767418300955, 'macro avg': {'precision': 0.38831858629652255, 'recall': 0.3881407045210688, 'f1-score': 0.3186773142415458, 'support': 324759}, 'weighted avg': {'precision': 0.38834780219539405, 'recall': 0.38586767418300955, 'f1-score': 0.3169150698348792, 'support': 324759}}
[[63624  1297 42942]
 [55963  1933 51702]
 [45857  1684 59757]]
Evaluating performance on  train set...
486/486 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0948515
{'0': {'precision': 0.3771219897354915, 'recall': 0.5547060246794097, 'f1-score': 0.4489923816611504, 'support': 41330}, '1': {'precision': 0.37938039614017266, 'recall': 0.01822395706269822, 'f1-score': 0.034777345841383644, 'support': 40990}, '2': {'precision': 0.3801083050103264, 'recall': 0.5573997233748271, 'f1-score': 0.45199029267019253, 'support': 41934}, 'accuracy': 0.3786356978447374, 'macro avg': {'precision': 0.3788702302953302, 'recall': 0.37677656837231166, 'f1-score': 0.3119200067242422, 'support': 124254}, 'weighted avg': {'precision': 0.3788748526072124, 'recall': 0.3786356978447374, 'f1-score': 0.3133592437501047, 'support': 124254}}
[[22926   522 17882]
 [20006   747 20237]
 [17860   700 23374]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953509
{'0': {'precision': 0.37578988941548186, 'recall': 0.5104271441024609, 'f1-score': 0.4328812306292473, 'support': 14913}, '1': {'precision': 0.37411764705882355, 'recall': 0.021060997417047488, 'f1-score': 0.03987710828265096, 'support': 15099}, '2': {'precision': 0.37897841314053987, 'recall': 0.5966337782936738, 'f1-score': 0.46352705410821643, 'support': 15507}, 'accuracy': 0.3774687493134735, 'macro avg': {'precision': 0.3762953165382818, 'recall': 0.3760406399377274, 'f1-score': 0.3120951310067049, 'support': 45519}, 'weighted avg': {'precision': 0.3763214311905932, 'recall': 0.3774687493134735, 'f1-score': 0.3129589024009716, 'support': 45519}}
[[7612  241 7060]
 [6680  318 8101]
 [5964  291 9252]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
1733/1733 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.126565
{'0': {'precision': 0.3424663623970126, 'recall': 0.5205805502162422, 'f1-score': 0.413144001239438, 'support': 133184}, '1': {'precision': 0.4174202760590195, 'recall': 0.0050484699164152986, 'f1-score': 0.009976282157015534, 'support': 173716}, '2': {'precision': 0.3510550147727178, 'recall': 0.614068093143104, 'f1-score': 0.44672370134279116, 'support': 136607}, 'accuracy': 0.34744885650057383, 'macro avg': {'precision': 0.3703138844095833, 'recall': 0.37989903775858713, 'f1-score': 0.2899479949130816, 'support': 443507}, 'weighted avg': {'precision': 0.37447028589945375, 'recall': 0.34744885650057383, 'f1-score': 0.26557144568540314, 'support': 443507}}
[[69333   615 63236]
 [81007   877 91832]
 [52112   609 83886]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1092889
{'0': {'precision': 0.3641435847576538, 'recall': 0.5095623135078308, 'f1-score': 0.4247512758389608, 'support': 64681}, '1': {'precision': 0.45302257829570286, 'recall': 0.00962594982744479, 'f1-score': 0.018851341112289737, 'support': 64617}, '2': {'precision': 0.37985175202156335, 'recall': 0.5936719525772576, 'f1-score': 0.46328061709696733, 'support': 66466}, 'accuracy': 0.37310230685927953, 'macro avg': {'precision': 0.39900597169164004, 'recall': 0.3709534053041777, 'f1-score': 0.30229441134940593, 'support': 195764}, 'weighted avg': {'precision': 0.3988136618444069, 'recall': 0.37310230685927953, 'f1-score': 0.303854967599557, 'support': 195764}}
[[32959   356 31366]
 [30940   622 33055]
 [26612   395 39459]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1140863
{'0': {'precision': 0.35684817075249753, 'recall': 0.4939122227465786, 'f1-score': 0.4143391595241394, 'support': 21190}, '1': {'precision': 0.41825095057034223, 'recall': 0.004975799520513864, 'f1-score': 0.009834599910594547, 'support': 22107}, '2': {'precision': 0.3613562603199909, 'recall': 0.5925493674431632, 'f1-score': 0.4489362830919412, 'support': 21421}, 'accuracy': 0.35954448530547917, 'macro avg': {'precision': 0.3788184605476102, 'recall': 0.36381246323675187, 'f1-score': 0.29103668084222506, 'support': 64718}, 'weighted avg': {'precision': 0.37931485761022443, 'recall': 0.35954448530547917, 'f1-score': 0.2876158782819695, 'support': 64718}}
[[10466    84 10640]
 [10204   110 11793]
 [ 8659    69 12693]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/EXC
Evaluating performance on  test set...
4693/4693 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1176429
{'0': {'precision': 0.33244387471115083, 'recall': 0.6889132007675718, 'f1-score': 0.4484718994000912, 'support': 286097}, '1': {'precision': 0.7569645531702446, 'recall': 0.048329258613490245, 'f1-score': 0.09085761026867174, 'support': 627446}, '2': {'precision': 0.33898570541145995, 'recall': 0.6696854445077943, 'f1-score': 0.45012448869670674, 'support': 287644}, 'accuracy': 0.3496965917879564, 'macro avg': {'precision': 0.4761313777642851, 'recall': 0.4689759679629521, 'f1-score': 0.32981799945515655, 'support': 1201187}, 'weighted avg': {'precision': 0.555760910248835, 'recall': 0.3496965917879564, 'f1-score': 0.2620660376460788, 'support': 1201187}}
[[197096   4313  84688]
 [306184  30324 290938]
 [ 89590   5423 192631]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1120489
{'0': {'precision': 0.3477884924631064, 'recall': 0.6671386382944294, 'f1-score': 0.4572212807103274, 'support': 98876}, '1': {'precision': 0.7235899320227815, 'recall': 0.04287572734150895, 'f1-score': 0.08095455876836431, 'support': 183717}, '2': {'precision': 0.35433609901695007, 'recall': 0.6434289692208244, 'f1-score': 0.45700158926364115, 'support': 100555}, 'accuracy': 0.3615861233779114, 'macro avg': {'precision': 0.475238174500946, 'recall': 0.45114777828558755, 'f1-score': 0.33172580958077763, 'support': 383148}, 'weighted avg': {'precision': 0.5297012458863438, 'recall': 0.3615861233779114, 'f1-score': 0.2767461524872043, 'support': 383148}}
[[65964  1300 31612]
 [89557  7877 86283]
 [34146  1709 64700]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1129318
{'0': {'precision': 0.3422974674688681, 'recall': 0.7045474181378337, 'f1-score': 0.46074600020716994, 'support': 34723}, '1': {'precision': 0.7134264232008592, 'recall': 0.0477491337292059, 'f1-score': 0.08950758698757513, 'support': 69551}, '2': {'precision': 0.36110064670057135, 'recall': 0.6469529514328299, 'f1-score': 0.46349743620740025, 'support': 35559}, 'accuracy': 0.363218982643582, 'macro avg': {'precision': 0.47227484579009954, 'recall': 0.4664165010999565, 'f1-score': 0.33791700780071504, 'support': 139833}, 'weighted avg': {'precision': 0.5316734534694249, 'recall': 0.363218982643582, 'f1-score': 0.27679682822985524, 'support': 139833}}
[[24464   532  9727]
 [35254  3321 30976]
 [11752   802 23005]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/AAL
Evaluating performance on  test set...
6677/6677 - 88s - 88s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1388247
{'0': {'precision': 0.3051819396753698, 'recall': 0.5331073363056855, 'f1-score': 0.3881589222492107, 'support': 379946}, '1': {'precision': 0.6878849286764414, 'recall': 0.018050443649709622, 'f1-score': 0.03517780417106508, 'support': 959090}, '2': {'precision': 0.2734982678446303, 'recall': 0.7537684506205351, 'f1-score': 0.4013648293963255, 'support': 370245}, 'accuracy': 0.29190226767863214, 'macro avg': {'precision': 0.42218837873214715, 'recall': 0.4349754101919768, 'f1-score': 0.2749005186055338, 'support': 1709281}, 'weighted avg': {'precision': 0.5130564135881235, 'recall': 0.29190226767863214, 'f1-score': 0.19295916314237854, 'support': 1709281}}
[[202552   3508 173886]
 [374338  17312 567440]
 [ 86819   4347 279079]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934842
{'0': {'precision': 0.39694407757542055, 'recall': 0.4948278850111566, 'f1-score': 0.440513957861241, 'support': 184644}, '1': {'precision': 0.5138309380312162, 'recall': 0.01589464123524069, 'f1-score': 0.03083543153374973, 'support': 209190}, '2': {'precision': 0.373740443737872, 'recall': 0.6912976967194062, 'f1-score': 0.4851768178291706, 'support': 184997}, 'accuracy': 0.3845336549009987, 'macro avg': {'precision': 0.4281718197815029, 'recall': 0.4006734076552678, 'f1-score': 0.31884206907472046, 'support': 578831}, 'weighted avg': {'precision': 0.4317710990889589, 'recall': 0.3845336549009987, 'f1-score': 0.30673025274358, 'support': 578831}}
[[ 91367   1504  91773]
 [ 83342   3325 122523]
 [ 55467   1642 127888]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0998802
{'0': {'precision': 0.38292957746478873, 'recall': 0.5294438386041439, 'f1-score': 0.4444226494049954, 'support': 64190}, '1': {'precision': 0.534965034965035, 'recall': 0.02016196660037856, 'f1-score': 0.03885938582313553, 'support': 83474}, '2': {'precision': 0.3620266069458836, 'recall': 0.677981220657277, 'f1-score': 0.47201037217815744, 'support': 63900}, 'accuracy': 0.37336692442948705, 'macro avg': {'precision': 0.4266404064585691, 'recall': 0.4091956752872665, 'f1-score': 0.31843080246876276, 'support': 211564}, 'weighted avg': {'precision': 0.43660273529512617, 'recall': 0.37336692442948705, 'f1-score': 0.29273742706552786, 'support': 211564}}
[[33985   609 29596]
 [35042  1683 46749]
 [19723   854 43323]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/WBA
Evaluating performance on  test set...
5633/5633 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1256076
{'0': {'precision': 0.3219917611944506, 'recall': 0.5155963458055196, 'f1-score': 0.39641865509761387, 'support': 354442}, '1': {'precision': 0.6741296751650058, 'recall': 0.014501407964499528, 'f1-score': 0.02839206559226672, 'support': 718413}, '2': {'precision': 0.3015787996744359, 'recall': 0.7019491888317334, 'f1-score': 0.4218975379360168, 'support': 368974}, 'accuracy': 0.31360723081585956, 'macro avg': {'precision': 0.43256674534463074, 'recall': 0.4106823142005842, 'f1-score': 0.28223608620863244, 'support': 1441829}, 'weighted avg': {'precision': 0.4922259589567668, 'recall': 0.31360723081585956, 'f1-score': 0.21956408986838902, 'support': 1441829}}
[[182749   2308 169385]
 [277564  10418 430431]
 [107245   2728 259001]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0898384
{'0': {'precision': 0.39836200963523744, 'recall': 0.46868395695511705, 'f1-score': 0.4306712450567152, 'support': 123499}, '1': {'precision': 0.4868421052631579, 'recall': 0.013277114918812236, 'f1-score': 0.02584927080604314, 'support': 122617}, '2': {'precision': 0.37910664178403125, 'recall': 0.6724322693825063, 'f1-score': 0.4848580243027136, 'support': 125977}, 'accuracy': 0.3875939617246226, 'macro avg': {'precision': 0.4214369188941422, 'recall': 0.38479778041881185, 'f1-score': 0.313792846721824, 'support': 372093}, 'weighted avg': {'precision': 0.42099998027649466, 'recall': 0.3875939617246226, 'f1-score': 0.3156146110226928, 'support': 372093}}
[[57882   869 64748]
 [46999  1628 73990]
 [40419   847 84711]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0874939
{'0': {'precision': 0.40164759725400456, 'recall': 0.47892427582894936, 'f1-score': 0.4368951372018002, 'support': 45811}, '1': {'precision': 0.5266084193804607, 'recall': 0.013784930139720559, 'f1-score': 0.02686657886738932, 'support': 48096}, '2': {'precision': 0.3894436354390588, 'recall': 0.6947405315135147, 'f1-score': 0.4991075991083397, 'support': 48503}, 'accuracy': 0.3953374060810336, 'macro avg': {'precision': 0.4392332173578413, 'recall': 0.3958165791607282, 'f1-score': 0.3209564383925097, 'support': 142410}, 'weighted avg': {'precision': 0.43969399105418516, 'recall': 0.3953374060810336, 'f1-score': 0.3196053225694082, 'support': 142410}}
[[21940   316 23555]
 [18159   663 29274]
 [14526   280 33697]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
11876/11876 - 156s - 156s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0552653
{'0': {'precision': 0.4875694114957273, 'recall': 0.4017064880552504, 'f1-score': 0.440492756126663, 'support': 1199774}, '1': {'precision': 0.28885442915293663, 'recall': 0.012245166273613975, 'f1-score': 0.02349435580500725, 'support': 608485}, '2': {'precision': 0.4495244018619161, 'recall': 0.7392496925468486, 'f1-score': 0.5590814561516867, 'support': 1231895}, 'accuracy': 0.4605312757182695, 'macro avg': {'precision': 0.4086494141701933, 'recall': 0.384400448958571, 'f1-score': 0.34102285602778565, 'support': 3040154}, 'weighted avg': {'precision': 0.4323805812017038, 'recall': 0.4605312757182695, 'f1-score': 0.40508387716776945, 'support': 3040154}}
[[481957   9323 708494]
 [194336   7451 406698]
 [312196   9021 910678]]
Evaluating performance on  train set...
2538/2538 - 33s - 33s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0875552
{'0': {'precision': 0.41496188804777745, 'recall': 0.43692426498979536, 'f1-score': 0.42565997178746556, 'support': 217548}, '1': {'precision': 0.4135351130760075, 'recall': 0.011386887287607865, 'f1-score': 0.022163492208147274, 'support': 213579}, '2': {'precision': 0.37931325524921566, 'recall': 0.7198908909504478, 'f1-score': 0.49683975122319474, 'support': 218497}, 'accuracy': 0.39219302242527987, 'macro avg': {'precision': 0.40260341879100014, 'recall': 0.38940068107595033, 'f1-score': 0.3148877384062692, 'support': 649624}, 'weighted avg': {'precision': 0.4025026062289361, 'recall': 0.39219302242527987, 'f1-score': 0.31694199593573796, 'support': 649624}}
[[ 95052   1818 120678]
 [ 74438   2432 136709]
 [ 59572   1631 157294]]
Evaluating performance on  val set...
795/795 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0862195
{'0': {'precision': 0.409484673478454, 'recall': 0.43774301742305066, 'f1-score': 0.42314258252399334, 'support': 67382}, '1': {'precision': 0.4143236074270557, 'recall': 0.011714062874970002, 'f1-score': 0.02278396079174993, 'support': 66672}, '2': {'precision': 0.3861019959078099, 'recall': 0.7207760385136499, 'f1-score': 0.5028432373185582, 'support': 69378}, 'accuracy': 0.3946429273663927, 'macro avg': {'precision': 0.4033034256044399, 'recall': 0.3900777062705569, 'f1-score': 0.31625659354476715, 'support': 203432}, 'weighted avg': {'precision': 0.40309618985603973, 'recall': 0.3946429273663927, 'f1-score': 0.3191115647893458, 'support': 203432}}
[[29496   593 37293]
 [23675   781 42216]
 [18861   511 50006]]
testing model on single stock: results/universal/W0/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
19053/19053 - 239s - 239s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1493497
{'0': {'precision': 0.30223611715360754, 'recall': 0.4743349185723498, 'f1-score': 0.36921578947549116, 'support': 1133583}, '1': {'precision': 0.5840627041149575, 'recall': 0.0067998035037770774, 'f1-score': 0.013443099098882399, 'support': 2630076}, '2': {'precision': 0.2704826974730748, 'recall': 0.7450042063697996, 'f1-score': 0.39687512779361317, 'support': 1113787}, 'accuracy': 0.2840334880181144, 'macro avg': {'precision': 0.38559383958054666, 'recall': 0.40871297614864216, 'f1-score': 0.2598446721226622, 'support': 4877446}, 'weighted avg': {'precision': 0.44695505335161734, 'recall': 0.2840334880181144, 'f1-score': 0.18368783017719784, 'support': 4877446}}
[[ 537698    6975  588910]
 [ 963118   17884 1649074]
 [ 278250    5761  829776]]
Evaluating performance on  train set...
4812/4812 - 61s - 61s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967776
{'0': {'precision': 0.39960149797271066, 'recall': 0.43862155252671037, 'f1-score': 0.41820331552170914, 'support': 406022}, '1': {'precision': 0.3349591513230094, 'recall': 0.006758468998875639, 'f1-score': 0.013249600872052363, 'support': 406453}, '2': {'precision': 0.38047704554130674, 'recall': 0.7058074546009462, 'f1-score': 0.4944257881106307, 'support': 419392}, 'accuracy': 0.3870929248043823, 'macro avg': {'precision': 0.3716792316123423, 'recall': 0.38372915870884405, 'f1-score': 0.3086262348347974, 'support': 1231867}, 'weighted avg': {'precision': 0.3717618707427237, 'recall': 0.3870929248043823, 'f1-score': 0.3105394549292232, 'support': 1231867}}
[[178090   2833 225099]
 [146818   2747 256888]
 [120761   2621 296010]]
Evaluating performance on  val set...
1767/1767 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1088641
{'0': {'precision': 0.37429183939504396, 'recall': 0.4275511644318984, 'f1-score': 0.3991527294169579, 'support': 141700}, '1': {'precision': 0.383289124668435, 'recall': 0.006908008748550872, 'f1-score': 0.013571420185726529, 'support': 167342}, '2': {'precision': 0.3533056844830106, 'recall': 0.7088606711296954, 'f1-score': 0.4715730324033763, 'support': 143251}, 'accuracy': 0.3610159785802566, 'macro avg': {'precision': 0.37029554951549654, 'recall': 0.3811066147700482, 'f1-score': 0.2947657273353536, 'support': 452293}, 'weighted avg': {'precision': 0.3709739371390199, 'recall': 0.3610159785802566, 'f1-score': 0.27943018976618883, 'support': 452293}}
[[ 60584    961  80155]
 [ 60472   1156 105714]
 [ 40807    899 101545]]
training model: results/universal/W0/deepOF_L1/h100
Epoch 1/50
8838/8838 - 184s - loss: 3.2599 - accuracy100: 0.3904 - val_loss: 3.2671 - val_accuracy100: 0.3835 - 184s/epoch - 21ms/step
Epoch 2/50
8838/8838 - 180s - loss: 3.2538 - accuracy100: 0.3935 - val_loss: 3.2667 - val_accuracy100: 0.3804 - 180s/epoch - 20ms/step
Epoch 3/50
8838/8838 - 180s - loss: 3.2496 - accuracy100: 0.3960 - val_loss: 3.2663 - val_accuracy100: 0.3755 - 180s/epoch - 20ms/step
Epoch 4/50
8838/8838 - 178s - loss: 3.2457 - accuracy100: 0.3987 - val_loss: 3.2669 - val_accuracy100: 0.3746 - 178s/epoch - 20ms/step
Epoch 5/50
8838/8838 - 180s - loss: 3.2426 - accuracy100: 0.4004 - val_loss: 3.2662 - val_accuracy100: 0.3733 - 180s/epoch - 20ms/step
Epoch 6/50
8838/8838 - 181s - loss: 3.2405 - accuracy100: 0.4012 - val_loss: 3.2697 - val_accuracy100: 0.3714 - 181s/epoch - 20ms/step
Epoch 7/50
8838/8838 - 181s - loss: 3.2381 - accuracy100: 0.4026 - val_loss: 3.2657 - val_accuracy100: 0.3758 - 181s/epoch - 20ms/step
Epoch 8/50
8838/8838 - 179s - loss: 3.2360 - accuracy100: 0.4037 - val_loss: 3.2655 - val_accuracy100: 0.3770 - 179s/epoch - 20ms/step
Epoch 9/50
8838/8838 - 178s - loss: 3.2337 - accuracy100: 0.4051 - val_loss: 3.2651 - val_accuracy100: 0.3788 - 178s/epoch - 20ms/step
Epoch 10/50
8838/8838 - 178s - loss: 3.2310 - accuracy100: 0.4064 - val_loss: 3.2637 - val_accuracy100: 0.3808 - 178s/epoch - 20ms/step
Epoch 11/50
8838/8838 - 178s - loss: 3.2283 - accuracy100: 0.4077 - val_loss: 3.2617 - val_accuracy100: 0.3833 - 178s/epoch - 20ms/step
Epoch 12/50
8838/8838 - 180s - loss: 3.2262 - accuracy100: 0.4090 - val_loss: 3.2665 - val_accuracy100: 0.3812 - 180s/epoch - 20ms/step
Epoch 13/50
8838/8838 - 179s - loss: 3.2242 - accuracy100: 0.4098 - val_loss: 3.2652 - val_accuracy100: 0.3813 - 179s/epoch - 20ms/step
Epoch 14/50
8838/8838 - 179s - loss: 3.2218 - accuracy100: 0.4115 - val_loss: 3.2644 - val_accuracy100: 0.3823 - 179s/epoch - 20ms/step
Epoch 15/50
8838/8838 - 178s - loss: 3.2197 - accuracy100: 0.4123 - val_loss: 3.2654 - val_accuracy100: 0.3816 - 178s/epoch - 20ms/step
Epoch 16/50
8838/8838 - 178s - loss: 3.2176 - accuracy100: 0.4136 - val_loss: 3.2655 - val_accuracy100: 0.3824 - 178s/epoch - 20ms/step
Epoch 17/50
8838/8838 - 180s - loss: 3.2154 - accuracy100: 0.4144 - val_loss: 3.2645 - val_accuracy100: 0.3836 - 180s/epoch - 20ms/step
Epoch 18/50
8838/8838 - 182s - loss: 3.2133 - accuracy100: 0.4153 - val_loss: 3.2660 - val_accuracy100: 0.3832 - 182s/epoch - 21ms/step
Epoch 19/50
8838/8838 - 179s - loss: 3.2113 - accuracy100: 0.4164 - val_loss: 3.2653 - val_accuracy100: 0.3836 - 179s/epoch - 20ms/step
Epoch 20/50
8838/8838 - 181s - loss: 3.2094 - accuracy100: 0.4174 - val_loss: 3.2658 - val_accuracy100: 0.3830 - 181s/epoch - 20ms/step
Epoch 21/50
8838/8838 - 178s - loss: 3.2073 - accuracy100: 0.4184 - val_loss: 3.2670 - val_accuracy100: 0.3820 - 178s/epoch - 20ms/step
testing model in sample: results/universal/W0/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 407s - 407s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0742301
{'0': {'precision': 0.4066701173098014, 'recall': 0.23431573863088914, 'f1-score': 0.2973207849546478, 'support': 2397483}, '1': {'precision': 0.4498721441160139, 'recall': 0.49119738372212757, 'f1-score': 0.4696274051225183, 'support': 3641815}, '2': {'precision': 0.3600552783049798, 'recall': 0.46189327660718776, 'f1-score': 0.40466550190302697, 'support': 2409706}, 'accuracy': 0.4099471369643096, 'macro avg': {'precision': 0.40553251324359835, 'recall': 0.3958021329867348, 'f1-score': 0.39053789732673105, 'support': 8449004}, 'weighted avg': {'precision': 0.41199686730474927, 'recall': 0.4099471369643096, 'f1-score': 0.40220628890581933, 'support': 8449004}}
[[ 561768 1159219  676496]
 [ 551221 1788850 1301744]
 [ 268396 1028283 1113027]]
Evaluating performance on  train set...
8838/8838 - 111s - 111s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0882683
{'0': {'precision': 0.43513200071674596, 'recall': 0.23301122256827694, 'f1-score': 0.30349971662389263, 'support': 750363}, '1': {'precision': 0.343649947638776, 'recall': 0.4904537687843792, 'f1-score': 0.40413298404844117, 'support': 747363}, '2': {'precision': 0.4030412501685313, 'recall': 0.4184813041316692, 'f1-score': 0.4106161835886778, 'support': 764340}, 'accuracy': 0.3807369015758161, 'macro avg': {'precision': 0.39394106617468444, 'recall': 0.3806487651614418, 'f1-score': 0.3727496280870038, 'support': 2262066}, 'weighted avg': {'precision': 0.39406399213143795, 'recall': 0.3807369015758161, 'f1-score': 0.37294197914058175, 'support': 2262066}}
[[174843 358632 216888]
 [123945 366547 256871]
 [103028 341450 319862]]
Evaluating performance on  val set...
3279/3279 - 41s - 41s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.087127
{'0': {'precision': 0.4399644421868055, 'recall': 0.2251754867410018, 'f1-score': 0.29788982170366746, 'support': 276944}, '1': {'precision': 0.3476252579865024, 'recall': 0.4899754069981189, 'f1-score': 0.4067041357181585, 'support': 280161}, '2': {'precision': 0.4032152404647839, 'recall': 0.4325209657556367, 'f1-score': 0.41735428934431706, 'support': 281769}, 'accuracy': 0.38325660349468454, 'macro avg': {'precision': 0.3969349802126973, 'recall': 0.3825572864982525, 'f1-score': 0.3739827489220477, 'support': 838874}, 'weighted avg': {'precision': 0.3967820047709917, 'recall': 0.38325660349468454, 'f1-score': 0.37435769484224607, 'support': 838874}}
[[ 62361 132978  81605]
 [ 44117 137272  98772]
 [ 35263 124635 121871]]
testing model out of sample: results/universal/W0/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 282s - 282s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.087641
{'0': {'precision': 0.43888843868475175, 'recall': 0.20581754054052667, 'f1-score': 0.2802236738375376, 'support': 1947249}, '1': {'precision': 0.35357295658846993, 'recall': 0.4877147933539353, 'f1-score': 0.40994953621966096, 'support': 1921498}, '2': {'precision': 0.4074696885969899, 'recall': 0.4707597173594625, 'f1-score': 0.4368341896444736, 'support': 1964191}, 'accuracy': 0.38789765980711605, 'macro avg': {'precision': 0.3999770279567372, 'recall': 0.38809735041797483, 'f1-score': 0.3756691332338907, 'support': 5832938}, 'weighted avg': {'precision': 0.40020365335518504, 'recall': 0.38789765980711605, 'f1-score': 0.3756954499422839, 'support': 5832938}}
[[400778 896746 649725]
 [289464 937143 694891]
 [222924 816605 924662]]
Evaluating performance on  train set...
6334/6334 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920693
{'0': {'precision': 0.4176108796684736, 'recall': 0.20877192982456141, 'f1-score': 0.2783774648435315, 'support': 548340}, '1': {'precision': 0.33920060266272617, 'recall': 0.48858654515585015, 'f1-score': 0.40041416687007064, 'support': 527141}, '2': {'precision': 0.39673242332786923, 'recall': 0.42732544814827716, 'f1-score': 0.4114610550102394, 'support': 545411}, 'accuracy': 0.37331296594714514, 'macro avg': {'precision': 0.3845146352196897, 'recall': 0.3748946410428962, 'f1-score': 0.3634175622412805, 'support': 1620892}, 'weighted avg': {'precision': 0.38508520147259623, 'recall': 0.37331296594714514, 'f1-score': 0.3628468823860859, 'support': 1620892}}
[[114478 262233 171629]
 [ 86815 257554 182772]
 [ 72833 239510 233068]]
Evaluating performance on  val set...
2156/2156 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0884049
{'0': {'precision': 0.41629739044805514, 'recall': 0.22475120865245635, 'f1-score': 0.2919071714479916, 'support': 180573}, '1': {'precision': 0.3587240227374765, 'recall': 0.49849313185360644, 'f1-score': 0.41721391273564035, 'support': 189134}, '2': {'precision': 0.39468421493487454, 'recall': 0.41509610566943617, 'f1-score': 0.4046329020848596, 'support': 181623}, 'accuracy': 0.38136324887091216, 'macro avg': {'precision': 0.3899018760401354, 'recall': 0.37944681539183295, 'f1-score': 0.37125132875616385, 'support': 551330}, 'weighted avg': {'precision': 0.38942685718339876, 'recall': 0.38136324887091216, 'f1-score': 0.3720286061280526, 'support': 551330}}
[[40584 87076 52913]
 [32140 94282 62712]
 [24764 81468 75391]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0761864
{'0': {'precision': 0.3378165213781652, 'recall': 0.1425119080975063, 'f1-score': 0.20045816193314775, 'support': 57104}, '1': {'precision': 0.4962560629428463, 'recall': 0.610202099785624, 'f1-score': 0.5473618467278354, 'support': 109154}, '2': {'precision': 0.304891939917683, 'recall': 0.3467663925931044, 'f1-score': 0.3244837758112094, 'support': 57892}, 'accuracy': 0.42301583760874417, 'macro avg': {'precision': 0.3796548414128982, 'recall': 0.36649346682541156, 'f1-score': 0.3574345948240642, 'support': 224150}, 'weighted avg': {'precision': 0.40646804870379966, 'recall': 0.42301583760874417, 'f1-score': 0.40142187216606356, 'support': 224150}}
[[ 8138 34610 14356]
 [11136 66606 31412]
 [ 4816 33001 20075]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1052097
{'0': {'precision': 0.4235754463193935, 'recall': 0.11972901977049634, 'f1-score': 0.18668822419832928, 'support': 28932}, '1': {'precision': 0.3138285063812088, 'recall': 0.5774358561243808, 'f1-score': 0.40664889090599643, 'support': 24827}, '2': {'precision': 0.36888840166630127, 'recall': 0.36754532877011575, 'f1-score': 0.36821564050189676, 'support': 27466}, 'accuracy': 0.3434287473068636, 'macro avg': {'precision': 0.36876411812230114, 'recall': 0.3549034015549976, 'f1-score': 0.32051758520207413, 'support': 81225}, 'weighted avg': {'precision': 0.37153824538018587, 'recall': 0.3434287473068636, 'f1-score': 0.31530374267841593, 'support': 81225}}
[[ 3464 16383  9085]
 [ 2305 14336  8186]
 [ 2409 14962 10095]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0866894
{'0': {'precision': 0.351288056206089, 'recall': 0.11773940345368916, 'f1-score': 0.1763668430335097, 'support': 7644}, '1': {'precision': 0.41368676596023884, 'recall': 0.5633991600393173, 'f1-score': 0.47707324455205813, 'support': 11191}, '2': {'precision': 0.3277330264672037, 'recall': 0.3718986680595456, 'f1-score': 0.3484218252997308, 'support': 7658}, 'accuracy': 0.3794587249462122, 'macro avg': {'precision': 0.3642359495445105, 'recall': 0.35101241051751736, 'f1-score': 0.3339539709617662, 'support': 26493}, 'weighted avg': {'precision': 0.3708373538740884, 'recall': 0.3794587249462122, 'f1-score': 0.353123057640719, 'support': 26493}}
[[ 900 4639 2105]
 [1149 6305 3737]
 [ 513 4297 2848]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
2359/2359 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0683126
{'0': {'precision': 0.4967747559274756, 'recall': 0.22912263370703914, 'f1-score': 0.31360449028362997, 'support': 174112}, '1': {'precision': 0.4219386176707998, 'recall': 0.5041082155814803, 'f1-score': 0.45937789753447034, 'support': 235382}, '2': {'precision': 0.39845949359773464, 'recall': 0.49683718584171005, 'f1-score': 0.44224333233305924, 'support': 194289}, 'accuracy': 0.42247131833787965, 'macro avg': {'precision': 0.43905762239867, 'recall': 0.41002267837674317, 'f1-score': 0.40507524005038653, 'support': 603783}, 'weighted avg': {'precision': 0.43596374618073563, 'recall': 0.42247131833787965, 'f1-score': 0.41182777270207976, 'support': 603783}}
[[ 39893  82153  52066]
 [ 23062 118658  93662]
 [ 17349  80410  96530]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0813483
{'0': {'precision': 0.4621075852706601, 'recall': 0.2725107575302712, 'f1-score': 0.3428427546267154, 'support': 49965}, '1': {'precision': 0.37202577767404466, 'recall': 0.5557471041723163, 'f1-score': 0.4456958220385718, 'support': 51626}, '2': {'precision': 0.39648216147604154, 'recall': 0.3561582473072303, 'f1-score': 0.37523999528053975, 'support': 49113}, 'accuracy': 0.3967976961460877, 'macro avg': {'precision': 0.4102051748069154, 'recall': 0.39480536966993923, 'f1-score': 0.38792619064860895, 'support': 150704}, 'weighted avg': {'precision': 0.4098619591571663, 'recall': 0.39679769614608773, 'f1-score': 0.3886346257013768, 'support': 150704}}
[[13616 24509 11840]
 [ 8149 28691 14786]
 [ 7700 23921 17492]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0803503
{'0': {'precision': 0.48380005734492976, 'recall': 0.25644662850195044, 'f1-score': 0.33520958876895574, 'support': 19739}, '1': {'precision': 0.34132765255634967, 'recall': 0.5424858016601136, 'f1-score': 0.4190146785895057, 'support': 18312}, '2': {'precision': 0.4362663619364222, 'recall': 0.40442026194144837, 'f1-score': 0.4197401299350325, 'support': 20768}, 'accuracy': 0.3977456264132338, 'macro avg': {'precision': 0.42046469061256725, 'recall': 0.40111756403450416, 'f1-score': 0.39132146576449794, 'support': 58819}, 'weighted avg': {'precision': 0.4226610637759748, 'recall': 0.3977456264132338, 'f1-score': 0.39114677035536477, 'support': 58819}}
[[5062 9556 5121]
 [2646 9934 5732]
 [2755 9614 8399]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
1625/1625 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922903
{'0': {'precision': 0.3836014676827547, 'recall': 0.2982597309495768, 'f1-score': 0.33558991411275224, 'support': 136703}, '1': {'precision': 0.3332564522453122, 'recall': 0.41956864196993127, 'f1-score': 0.37146465539127, 'support': 137751}, '2': {'precision': 0.39141837094499293, 'recall': 0.37684593187733395, 'f1-score': 0.38399394638224277, 'support': 141392}, 'accuracy': 0.36516402706771256, 'macro avg': {'precision': 0.36942543029102, 'recall': 0.36489143493228066, 'f1-score': 0.363682838628755, 'support': 415846}, 'weighted avg': {'precision': 0.36958226673945177, 'recall': 0.36516402706771256, 'f1-score': 0.3639314742492088, 'support': 415846}}
[[40773 57636 38294]
 [35404 57796 44551]
 [30113 57996 53283]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0934498
{'0': {'precision': 0.37616139302189594, 'recall': 0.30429412383054766, 'f1-score': 0.3364325769241945, 'support': 38052}, '1': {'precision': 0.33171129025521073, 'recall': 0.41670164760205686, 'f1-score': 0.36938068327170404, 'support': 38116}, '2': {'precision': 0.3915561113527621, 'recall': 0.36667515274949086, 'f1-score': 0.3787074042911233, 'support': 39280}, 'accuracy': 0.362630794816714, 'macro avg': {'precision': 0.36647626487662294, 'recall': 0.36255697472736514, 'f1-score': 0.3615068881623406, 'support': 115448}, 'weighted avg': {'precision': 0.3667237623914948, 'recall': 0.362630794816714, 'f1-score': 0.3616942119504802, 'support': 115448}}
[[11579 15857 10616]
 [10468 15883 11765]
 [ 8735 16142 14403]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922999
{'0': {'precision': 0.3989168278529981, 'recall': 0.33860904971432326, 'f1-score': 0.3662972435350952, 'support': 15227}, '1': {'precision': 0.33417057988424154, 'recall': 0.40857200080112155, 'f1-score': 0.3676448502688252, 'support': 14979}, '2': {'precision': 0.3860558916738692, 'recall': 0.3593215794060468, 'f1-score': 0.37220929828825394, 'support': 14917}, 'accuracy': 0.36868116038383975, 'macro avg': {'precision': 0.3730477664703696, 'recall': 0.3688342099738306, 'f1-score': 0.3687171306973915, 'support': 45123}, 'weighted avg': {'precision': 0.3731720716686116, 'recall': 0.36868116038383975, 'f1-score': 0.3686990324679545, 'support': 45123}}
[[5156 6156 3915]
 [4250 6120 4609]
 [3519 6038 5360]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1269/1269 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0895494
{'0': {'precision': 0.3939446845038046, 'recall': 0.2633001740618649, 'f1-score': 0.3156379320394008, 'support': 102837}, '1': {'precision': 0.3776107888796823, 'recall': 0.56226813246656, 'f1-score': 0.45179971215544973, 'support': 117524}, '2': {'precision': 0.3881477459243993, 'recall': 0.30127013927469876, 'f1-score': 0.3392349632473885, 'support': 104398}, 'accuracy': 0.3836968336520312, 'macro avg': {'precision': 0.3865677397692954, 'recall': 0.3756128152677079, 'f1-score': 0.36889086914741304, 'support': 324759}, 'weighted avg': {'precision': 0.38617026241498764, 'recall': 0.3836968336520312, 'f1-score': 0.37249781863349063, 'support': 324759}}
[[27077 54038 21722]
 [23587 66080 27857]
 [18069 54877 31452]]
Evaluating performance on  train set...
486/486 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944425
{'0': {'precision': 0.40410376785786556, 'recall': 0.24303273700864061, 'f1-score': 0.30352311760950845, 'support': 41085}, '1': {'precision': 0.3381709352864211, 'recall': 0.5480513782934022, 'f1-score': 0.4182585889399379, 'support': 41029}, '2': {'precision': 0.3952257049497761, 'recall': 0.3099905078310394, 'f1-score': 0.34745717629535056, 'support': 42140}, 'accuracy': 0.36645902747597664, 'macro avg': {'precision': 0.3791668026980209, 'recall': 0.36702487437769404, 'f1-score': 0.3564129609482656, 'support': 124254}, 'weighted avg': {'precision': 0.3793216299909101, 'recall': 0.36645902747597664, 'f1-score': 0.3563090471267681, 'support': 124254}}
[[ 9985 21741  9359]
 [ 7913 22486 10630]
 [ 6811 22266 13063]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0951283
{'0': {'precision': 0.3942657154394939, 'recall': 0.1988863991308481, 'f1-score': 0.2643979057591623, 'support': 14727}, '1': {'precision': 0.34719138087013734, 'recall': 0.5535667453448728, 'f1-score': 0.42673742734394743, 'support': 15252}, '2': {'precision': 0.3979814115596863, 'recall': 0.3527027027027027, 'f1-score': 0.3739765283842794, 'support': 15540}, 'accuracy': 0.370240998264461, 'macro avg': {'precision': 0.37981283595643917, 'recall': 0.36838528239280793, 'f1-score': 0.355037287162463, 'support': 45519}, 'weighted avg': {'precision': 0.37976109466258673, 'recall': 0.370240998264461, 'f1-score': 0.3562025187516591, 'support': 45519}}
[[2929 7954 3844]
 [2362 8443 4447]
 [2138 7921 5481]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
1733/1733 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0949993
{'0': {'precision': 0.37071345502351216, 'recall': 0.25545288567406726, 'f1-score': 0.30247496771691545, 'support': 143502}, '1': {'precision': 0.34457535939700323, 'recall': 0.4502157625817383, 'f1-score': 0.390374914635616, 'support': 151092}, '2': {'precision': 0.38493831856964295, 'recall': 0.38053091402362454, 'f1-score': 0.38272192786057047, 'support': 148913}, 'accuracy': 0.36380034587954646, 'macro avg': {'precision': 0.3667423776633861, 'recall': 0.36206652075981, 'f1-score': 0.35852393673770067, 'support': 443507}, 'weighted avg': {'precision': 0.36658501953285355, 'recall': 0.36380034587954646, 'f1-score': 0.35936424873325207, 'support': 443507}}
[[36658 65319 41525]
 [34051 68024 49017]
 [28176 64071 56666]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0980155
{'0': {'precision': 0.3604913960929983, 'recall': 0.2507353971144418, 'f1-score': 0.295759133467964, 'support': 64251}, '1': {'precision': 0.3347964226876912, 'recall': 0.4403634224863794, 'f1-score': 0.3803914752520255, 'support': 64608}, '2': {'precision': 0.3821015205386187, 'recall': 0.3774755249981317, 'f1-score': 0.3797744360902256, 'support': 66905}, 'accuracy': 0.3566334974765534, 'macro avg': {'precision': 0.35912977977310273, 'recall': 0.35619144819965093, 'f1-score': 0.3519750149367384, 'support': 195764}, 'weighted avg': {'precision': 0.35939683598115, 'recall': 0.3566334974765534, 'f1-score': 0.3524037165370015, 'support': 195764}}
[[16110 28322 19819]
 [15136 28451 21021]
 [13443 28207 25255]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0993232
{'0': {'precision': 0.36109554497058, 'recall': 0.24084283311530555, 'f1-score': 0.288957399103139, 'support': 21404}, '1': {'precision': 0.34089844735040886, 'recall': 0.43253496663314744, 'f1-score': 0.38128815198339944, 'support': 21878}, '2': {'precision': 0.36401710532116566, 'recall': 0.3851931330472103, 'f1-score': 0.37430585462045834, 'support': 21436}, 'accuracy': 0.3534565345035384, 'macro avg': {'precision': 0.3553370325473848, 'recall': 0.35285697759855444, 'f1-score': 0.3481838019023322, 'support': 64718}, 'weighted avg': {'precision': 0.3552355750385835, 'recall': 0.3534565345035384, 'f1-score': 0.3484391770317461, 'support': 64718}}
[[5155 9355 6894]
 [4883 9463 7532]
 [4238 8941 8257]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/EXC
Evaluating performance on  test set...
4693/4693 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0625197
{'0': {'precision': 0.5021606611177524, 'recall': 0.3561145775741779, 'f1-score': 0.4167118510394459, 'support': 379830}, '1': {'precision': 0.4100469426324453, 'recall': 0.5208194313173987, 'f1-score': 0.45884226018196467, 'support': 439085}, '2': {'precision': 0.44922124541928726, 'recall': 0.43964506947932364, 'f1-score': 0.44438157311986465, 'support': 382272}, 'accuracy': 0.442904393737195, 'macro avg': {'precision': 0.45380961638982825, 'recall': 0.4388596927903001, 'f1-score': 0.43997856144709174, 'support': 1201187}, 'weighted avg': {'precision': 0.4516414593623182, 'recall': 0.442904393737195, 'f1-score': 0.4409180659730646, 'support': 1201187}}
[[135263 166395  78172]
 [ 82514 228684 127887]
 [ 51585 162623 168064]]
Evaluating performance on  train set...
1497/1497 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0705886
{'0': {'precision': 0.5067663737207149, 'recall': 0.35115651050839497, 'f1-score': 0.41484920080820786, 'support': 127755}, '1': {'precision': 0.367504394074277, 'recall': 0.511001610765947, 'f1-score': 0.42753341764504765, 'support': 126027}, '2': {'precision': 0.4468949458060409, 'recall': 0.4124190281836031, 'f1-score': 0.42896539525310345, 'support': 129366}, 'accuracy': 0.42441824047104515, 'macro avg': {'precision': 0.4403885712003443, 'recall': 0.424859049819315, 'f1-score': 0.42378267123545293, 'support': 383148}, 'weighted avg': {'precision': 0.44074463629154564, 'recall': 0.42441824047104515, 'f1-score': 0.4237875468412154, 'support': 383148}}
[[44862 54585 28308]
 [23902 64400 37725]
 [19762 56251 53353]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.065355
{'0': {'precision': 0.5085609878289571, 'recall': 0.37398955421190644, 'f1-score': 0.4310155352415206, 'support': 46143}, '1': {'precision': 0.3747692500234661, 'recall': 0.5077252400228895, 'f1-score': 0.43123171774447594, 'support': 47183}, '2': {'precision': 0.46045547667826003, 'recall': 0.41561485367794093, 'f1-score': 0.43688760806916427, 'support': 46507}, 'accuracy': 0.4329593157552223, 'macro avg': {'precision': 0.44792857151022775, 'recall': 0.43244321597091234, 'f1-score': 0.43304495368505364, 'support': 139833}, 'weighted avg': {'precision': 0.44741706206063386, 'recall': 0.4329593157552223, 'f1-score': 0.43304147067902227, 'support': 139833}}
[[17257 19651  9235]
 [ 9813 23956 13414]
 [ 6863 20315 19329]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/AAL
Evaluating performance on  test set...
6677/6677 - 82s - 82s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0651349
{'0': {'precision': 0.41111804002255425, 'recall': 0.24501172794723092, 'f1-score': 0.30703908371017063, 'support': 449354}, '1': {'precision': 0.5208537550164032, 'recall': 0.5257112621694658, 'f1-score': 0.5232712358218432, 'support': 827789}, '2': {'precision': 0.3374622301653704, 'recall': 0.473212260898139, 'f1-score': 0.3939713575908549, 'support': 432138}, 'accuracy': 0.4386452549346772, 'macro avg': {'precision': 0.4231446750681093, 'recall': 0.41464508367161196, 'f1-score': 0.4080938923742896, 'support': 1709281}, 'weighted avg': {'precision': 0.44564047572445437, 'recall': 0.4386452549346772, 'f1-score': 0.4337364119637583, 'support': 1709281}}
[[110097 213539 125718]
 [116849 435178 275762]
 [ 40853 186792 204493]]
Evaluating performance on  train set...
2262/2262 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.087931
{'0': {'precision': 0.43902491710499314, 'recall': 0.20878426618863932, 'f1-score': 0.2829891811359111, 'support': 194689}, '1': {'precision': 0.34788135144391524, 'recall': 0.5161641826230453, 'f1-score': 0.4156352561019852, 'support': 190885}, '2': {'precision': 0.4075883775570015, 'recall': 0.4281811266862261, 'f1-score': 0.4176310569852477, 'support': 193257}, 'accuracy': 0.3834020638148268, 'macro avg': {'precision': 0.39816488203530326, 'recall': 0.38437652516597026, 'f1-score': 0.37208516474104797, 'support': 578831}, 'weighted avg': {'precision': 0.39847202540665444, 'recall': 0.3834020638148268, 'f1-score': 0.3716862810163845, 'support': 578831}}
[[40648 97042 56999]
 [29084 98528 63273]
 [22855 87653 82749]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.082568
{'0': {'precision': 0.4307446837776127, 'recall': 0.23164777938870315, 'f1-score': 0.3012747125883881, 'support': 67594}, '1': {'precision': 0.37763544928361326, 'recall': 0.5252814549869996, 'f1-score': 0.4393868302080516, 'support': 75767}, '2': {'precision': 0.40167280122595705, 'recall': 0.4112135829802208, 'f1-score': 0.4063872024111399, 'support': 68203}, 'accuracy': 0.39469380423890643, 'macro avg': {'precision': 0.4033509780957276, 'recall': 0.3893809391186412, 'f1-score': 0.3823495817358598, 'support': 211564}, 'weighted avg': {'precision': 0.40235272212261736, 'recall': 0.39469380423890643, 'f1-score': 0.38462220062543684, 'support': 211564}}
[[15658 33912 18024]
 [12215 39799 23753]
 [ 8478 31679 28046]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/WBA
Evaluating performance on  test set...
5633/5633 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0699844
{'0': {'precision': 0.35325910871550176, 'recall': 0.19931365706118923, 'f1-score': 0.25484196547144755, 'support': 361044}, '1': {'precision': 0.49974126535985564, 'recall': 0.5323219327043496, 'f1-score': 0.5155173379448923, 'support': 700283}, '2': {'precision': 0.3303554557737436, 'recall': 0.4273196987138044, 'f1-score': 0.3726330287949746, 'support': 380502}, 'accuracy': 0.4212240147756773, 'macro avg': {'precision': 0.3944519432830336, 'recall': 0.3863184294931144, 'f1-score': 0.3809974440704382, 'support': 1441829}, 'weighted avg': {'precision': 0.41835980952657803, 'recall': 0.4212240147756773, 'f1-score': 0.41253491452334623, 'support': 1441829}}
[[ 71961 192847  96236]
 [ 94154 372776 233353]
 [ 37591 180315 162596]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0915325
{'0': {'precision': 0.40995029973868935, 'recall': 0.19472838785046728, 'f1-score': 0.2640376206583615, 'support': 123264}, '1': {'precision': 0.33842463676215156, 'recall': 0.49956860063814545, 'f1-score': 0.40350283191600567, 'support': 122856}, '2': {'precision': 0.3911655457798422, 'recall': 0.41046097179554347, 'f1-score': 0.40058103501704373, 'support': 125973}, 'accuracy': 0.3684159605259975, 'macro avg': {'precision': 0.3798468274268944, 'recall': 0.3682526534280521, 'f1-score': 0.35604049586380365, 'support': 372093}, 'weighted avg': {'precision': 0.37997465208849607, 'recall': 0.3684159605259975, 'f1-score': 0.35631272804085834, 'support': 372093}}
[[24003 61473 37788]
 [18789 61375 42692]
 [15759 58507 51707]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0923991
{'0': {'precision': 0.4426229508196721, 'recall': 0.19060115959719257, 'f1-score': 0.2664599982935639, 'support': 49155}, '1': {'precision': 0.3095714002349746, 'recall': 0.4815236739053044, 'f1-score': 0.3768597804483906, 'support': 42135}, '2': {'precision': 0.4209931064196467, 'recall': 0.45874413145539905, 'f1-score': 0.43905863850820037, 'support': 51120}, 'accuracy': 0.3729302717505793, 'macro avg': {'precision': 0.3910624858247645, 'recall': 0.376956321652632, 'f1-score': 0.36079280575005157, 'support': 142410}, 'weighted avg': {'precision': 0.3954925194622146, 'recall': 0.3729302717505793, 'f1-score': 0.36108072232183325, 'support': 142410}}
[[ 9369 23416 16370]
 [ 5963 20289 15883]
 [ 5835 21834 23451]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
11876/11876 - 157s - 157s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994389
{'0': {'precision': 0.4925778508455674, 'recall': 0.17658148555988096, 'f1-score': 0.25996836306114657, 'support': 1160586}, '1': {'precision': 0.2357164709858605, 'recall': 0.44409037072811736, 'f1-score': 0.30796811259771684, 'support': 695712}, '2': {'precision': 0.448950379136563, 'recall': 0.4980690219080699, 'f1-score': 0.47223589289754464, 'support': 1183856}, 'accuracy': 0.36298786179910625, 'macro avg': {'precision': 0.3924149003226636, 'recall': 0.37291362606535605, 'f1-score': 0.34672412285213605, 'support': 3040154}, 'weighted avg': {'precision': 0.4168086008495173, 'recall': 0.36298786179910625, 'f1-score': 0.35361105042224256, 'support': 3040154}}
[[204938 526354 429294]
 [ 92310 308959 294443]
 [118804 475410 589642]]
Evaluating performance on  train set...
2538/2538 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922823
{'0': {'precision': 0.4362627856088749, 'recall': 0.19272444428458385, 'f1-score': 0.267345659570089, 'support': 222416}, '1': {'precision': 0.336474167202291, 'recall': 0.47908291607771736, 'f1-score': 0.3953102204931741, 'support': 208705}, '2': {'precision': 0.3955382993454179, 'recall': 0.46017217154913204, 'f1-score': 0.42541425945239264, 'support': 218503}, 'accuracy': 0.37467981478516804, 'macro avg': {'precision': 0.3894250840521946, 'recall': 0.3773265106371444, 'f1-score': 0.3626900465052186, 'support': 649624}, 'weighted avg': {'precision': 0.39050584616918327, 'recall': 0.37467981478516804, 'f1-score': 0.36162374499725214, 'support': 649624}}
[[ 42865 104608  74943]
 [ 30002  99987  78716]
 [ 25388  92566 100549]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903844
{'0': {'precision': 0.4404796255330063, 'recall': 0.19997380065207265, 'f1-score': 0.27506882226337653, 'support': 68704}, '1': {'precision': 0.33881074768791253, 'recall': 0.4974815903489031, 'f1-score': 0.403093755427097, 'support': 65319}, '2': {'precision': 0.4067101608761725, 'recall': 0.4472762898183233, 'f1-score': 0.4260297376853459, 'support': 69409}, 'accuracy': 0.37987632230917456, 'macro avg': {'precision': 0.3953335113656971, 'recall': 0.38157722693976637, 'f1-score': 0.36806410512527316, 'support': 203432}, 'weighted avg': {'precision': 0.3963134461495766, 'recall': 0.37987632230917456, 'f1-score': 0.36768211214817603, 'support': 203432}}
[[13739 32972 21993]
 [ 9530 32495 23294]
 [ 7922 30442 31045]]
testing model on single stock: results/universal/W0/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
19053/19053 - 251s - 251s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0780619
{'0': {'precision': 0.37896658870082955, 'recall': 0.20880216865024717, 'f1-score': 0.269252302294303, 'support': 1379660}, '1': {'precision': 0.4526488438712834, 'recall': 0.4665651876377329, 'f1-score': 0.45950167324602403, 'support': 2149541}, '2': {'precision': 0.3441577529491386, 'recall': 0.4854236433289202, 'f1-score': 0.402762914081717, 'support': 1348245}, 'accuracy': 0.39886592286208805, 'macro avg': {'precision': 0.39192439517375055, 'recall': 0.38693033320563347, 'f1-score': 0.37717229654068135, 'support': 4877446}, 'weighted avg': {'precision': 0.4018171112290777, 'recall': 0.39886592286208805, 'f1-score': 0.3900027601926078, 'support': 4877446}}
[[ 288076  663064  428520]
 [ 327973 1002901  818667]
 [ 144113  549662  654470]]
Evaluating performance on  train set...
4812/4812 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092943
{'0': {'precision': 0.4105470601441864, 'recall': 0.20154104640283718, 'f1-score': 0.27036004527466245, 'support': 408294}, '1': {'precision': 0.3353668645523586, 'recall': 0.46855417975728453, 'f1-score': 0.3909278087701823, 'support': 405825}, '2': {'precision': 0.39591075665643205, 'recall': 0.44016009651751775, 'f1-score': 0.4168644707578674, 'support': 417748}, 'accuracy': 0.3704255410689628, 'macro avg': {'precision': 0.38060822711765896, 'recall': 0.37008510755921314, 'f1-score': 0.3593841082675708, 'support': 1231867}, 'weighted avg': {'precision': 0.3808163429600619, 'recall': 0.3704255410689628, 'f1-score': 0.3597620207779653, 'support': 1231867}}
[[ 82288 196092 129914]
 [ 65026 190151 150648]
 [ 53121 180751 183876]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922631
{'0': {'precision': 0.4026410286111433, 'recall': 0.18893871449925262, 'f1-score': 0.2571909509628013, 'support': 147180}, '1': {'precision': 0.35227588676880156, 'recall': 0.4752954939947482, 'f1-score': 0.4046421747202841, 'support': 157279}, '2': {'precision': 0.3799948545835136, 'recall': 0.43960793863387315, 'f1-score': 0.4076334441447657, 'support': 147834}, 'accuracy': 0.3704479176109292, 'macro avg': {'precision': 0.37830392332115287, 'recall': 0.36794738237595803, 'f1-score': 0.3564888566092837, 'support': 452293}, 'weighted avg': {'precision': 0.37772520273052546, 'recall': 0.3704479176109292, 'f1-score': 0.3576379986916312, 'support': 452293}}
[[27808 72405 46967]
 [23455 74754 59070]
 [17801 65044 64989]]
training model: results/universal/W0/deepOF_L1/h200
Epoch 1/50
8838/8838 - 185s - loss: 3.2673 - accuracy200: 0.3818 - val_loss: 3.2822 - val_accuracy200: 0.3640 - 185s/epoch - 21ms/step
Epoch 2/50
8838/8838 - 187s - loss: 3.2681 - accuracy200: 0.3819 - val_loss: 3.2820 - val_accuracy200: 0.3645 - 187s/epoch - 21ms/step
Epoch 3/50
8838/8838 - 183s - loss: 3.2671 - accuracy200: 0.3828 - val_loss: 3.2809 - val_accuracy200: 0.3653 - 183s/epoch - 21ms/step
Epoch 4/50
8838/8838 - 187s - loss: 3.2646 - accuracy200: 0.3846 - val_loss: 3.2795 - val_accuracy200: 0.3675 - 187s/epoch - 21ms/step
Epoch 5/50
8838/8838 - 185s - loss: 3.2620 - accuracy200: 0.3858 - val_loss: 3.2789 - val_accuracy200: 0.3681 - 185s/epoch - 21ms/step
Epoch 6/50
8838/8838 - 185s - loss: 3.2599 - accuracy200: 0.3877 - val_loss: 3.2793 - val_accuracy200: 0.3669 - 185s/epoch - 21ms/step
Epoch 7/50
8838/8838 - 183s - loss: 3.2579 - accuracy200: 0.3888 - val_loss: 3.2793 - val_accuracy200: 0.3668 - 183s/epoch - 21ms/step
Epoch 8/50
8838/8838 - 185s - loss: 3.2560 - accuracy200: 0.3902 - val_loss: 3.2795 - val_accuracy200: 0.3672 - 185s/epoch - 21ms/step
Epoch 9/50
8838/8838 - 183s - loss: 3.2547 - accuracy200: 0.3912 - val_loss: 3.2793 - val_accuracy200: 0.3653 - 183s/epoch - 21ms/step
Epoch 10/50
8838/8838 - 183s - loss: 3.2533 - accuracy200: 0.3921 - val_loss: 3.2793 - val_accuracy200: 0.3657 - 183s/epoch - 21ms/step
Epoch 11/50
8838/8838 - 194s - loss: 3.2517 - accuracy200: 0.3931 - val_loss: 3.2800 - val_accuracy200: 0.3641 - 194s/epoch - 22ms/step
Epoch 12/50
8838/8838 - 185s - loss: 3.2502 - accuracy200: 0.3944 - val_loss: 3.2799 - val_accuracy200: 0.3627 - 185s/epoch - 21ms/step
Epoch 13/50
8838/8838 - 184s - loss: 3.2488 - accuracy200: 0.3953 - val_loss: 3.2796 - val_accuracy200: 0.3639 - 184s/epoch - 21ms/step
Epoch 14/50
8838/8838 - 184s - loss: 3.2478 - accuracy200: 0.3961 - val_loss: 3.2801 - val_accuracy200: 0.3631 - 184s/epoch - 21ms/step
Epoch 15/50
8838/8838 - 185s - loss: 3.2465 - accuracy200: 0.3968 - val_loss: 3.2811 - val_accuracy200: 0.3619 - 185s/epoch - 21ms/step
testing model in sample: results/universal/W0/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 429s - 429s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0872356
{'0': {'precision': 0.3307256106125747, 'recall': 0.3994171161150868, 'f1-score': 0.3618401301025279, 'support': 2287248}, '1': {'precision': 0.4600738852839839, 'recall': 0.20791899021735805, 'f1-score': 0.2864045446048485, 'support': 3824427}, '2': {'precision': 0.31733370116419984, 'recall': 0.5374147156861528, 'f1-score': 0.39904092812996866, 'support': 2337329}, 'accuracy': 0.3509114210385035, 'macro avg': {'precision': 0.3693777323535861, 'recall': 0.3815836073395326, 'f1-score': 0.3490952009457817, 'support': 8449004}, 'weighted avg': {'precision': 0.3855701503639694, 'recall': 0.3509114210385035, 'f1-score': 0.33798555672494945, 'support': 8449004}}
[[ 913566  464961  908721]
 [1235751  795171 1793505]
 [ 612991  468223 1256115]]
Evaluating performance on  train set...
8838/8838 - 122s - 122s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937033
{'0': {'precision': 0.3806113939720408, 'recall': 0.3918461698434663, 'f1-score': 0.3861470815045251, 'support': 750126}, '1': {'precision': 0.33478146006399156, 'recall': 0.2133521827610581, 'f1-score': 0.26061657111378617, 'support': 748387}, '2': {'precision': 0.37367257074028, 'recall': 0.4956800641212856, 'f1-score': 0.42611487306161344, 'support': 763553}, 'accuracy': 0.3678416102801598, 'macro avg': {'precision': 0.3630218082587708, 'recall': 0.3669594722419367, 'f1-score': 0.3576261752266416, 'support': 2262066}, 'weighted avg': {'precision': 0.36310673847448943, 'recall': 0.3678416102801598, 'f1-score': 0.3581072829606256, 'support': 2262066}}
[[293934 155916 300276]
 [254611 159670 334106]
 [223723 161352 378478]]
Evaluating performance on  val set...
3279/3279 - 45s - 45s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092734
{'0': {'precision': 0.37988042095354363, 'recall': 0.375764277114788, 'f1-score': 0.3778111383155936, 'support': 274933}, '1': {'precision': 0.3467339777134766, 'recall': 0.2168375293569986, 'f1-score': 0.26681596968000343, 'support': 285707}, '2': {'precision': 0.37001187388440865, 'recall': 0.5163136065326308, 'f1-score': 0.4310880580241597, 'support': 278234}, 'accuracy': 0.3682531584004272, 'macro avg': {'precision': 0.3655420908504763, 'recall': 0.36963847100147246, 'f1-score': 0.3585717220065856, 'support': 838874}, 'weighted avg': {'precision': 0.3653181193635271, 'recall': 0.3682531584004272, 'f1-score': 0.35767862000274164, 'support': 838874}}
[[103310  57659 113964]
 [ 93128  61952 130627]
 [ 75516  59062 143656]]
testing model out of sample: results/universal/W0/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 305s - 305s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928215
{'0': {'precision': 0.38270979236605535, 'recall': 0.3660552609142495, 'f1-score': 0.3741973060448108, 'support': 1941155}, '1': {'precision': 0.3385035691491294, 'recall': 0.2028339994952612, 'f1-score': 0.2536680871637121, 'support': 1929711}, '2': {'precision': 0.3810122771288519, 'recall': 0.547604267325562, 'f1-score': 0.4493651337684762, 'support': 1962072}, 'accuracy': 0.3731258587010525, 'macro avg': {'precision': 0.36740854621467883, 'recall': 0.37216450924502426, 'f1-score': 0.35907684232566633, 'support': 5832938}, 'weighted avg': {'precision': 0.36751403984363046, 'recall': 0.3731258587010525, 'f1-score': 0.3596074253673826, 'support': 5832938}}
[[ 710570  384277  846308]
 [ 639088  391411  899212]
 [ 507023  380610 1074439]]
Evaluating performance on  train set...
6334/6334 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946097
{'0': {'precision': 0.3719971696771178, 'recall': 0.37443283249033027, 'f1-score': 0.37321102719915183, 'support': 537760}, '1': {'precision': 0.336543861881076, 'recall': 0.19827535776180413, 'f1-score': 0.24953611301241826, 'support': 547012}, '2': {'precision': 0.3654458115134854, 'recall': 0.5162389017384168, 'f1-score': 0.4279474091930314, 'support': 536120}, 'accuracy': 0.36188715842881575, 'macro avg': {'precision': 0.35799561435722643, 'recall': 0.3629823639968504, 'f1-score': 0.35023151646820044, 'support': 1620892}, 'weighted avg': {'precision': 0.3578656304118151, 'recall': 0.36188715842881575, 'f1-score': 0.3495781182548454, 'support': 1620892}}
[[201355 107532 228873]
 [186854 108459 251699]
 [153072 106282 276766]]
Evaluating performance on  val set...
2156/2156 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926579
{'0': {'precision': 0.3656949651916378, 'recall': 0.4032295362124297, 'f1-score': 0.3835461373390558, 'support': 177301}, '1': {'precision': 0.35474981477800466, 'recall': 0.20153164667416065, 'f1-score': 0.2570400751552368, 'support': 194823}, '2': {'precision': 0.36598369181694695, 'recall': 0.5006640402665089, 'f1-score': 0.42285894725927814, 'support': 179206}, 'accuracy': 0.36362614042406544, 'macro avg': {'precision': 0.36214282392886316, 'recall': 0.3684750743843664, 'f1-score': 0.35448171991785693, 'support': 551330}, 'weighted avg': {'precision': 0.3619211355516398, 'recall': 0.36362614042406544, 'f1-score': 0.35162115749345546, 'support': 551330}}
[[71493 35722 70086]
 [70215 39263 85345]
 [53791 35693 89722]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934114
{'0': {'precision': 0.3862110377203996, 'recall': 0.19868572551882951, 'f1-score': 0.2623868862186619, 'support': 71218}, '1': {'precision': 0.3437275263930041, 'recall': 0.1512263649479839, 'f1-score': 0.2100424514620705, 'support': 79014}, '2': {'precision': 0.34783861105473685, 'recall': 0.7187965042344219, 'f1-score': 0.4688110752778305, 'support': 73918}, 'accuracy': 0.3534731206781173, 'macro avg': {'precision': 0.3592590583893802, 'recall': 0.35623619823374514, 'f1-score': 0.313746804319521, 'support': 224150}, 'weighted avg': {'precision': 0.3585813022829903, 'recall': 0.3534731206781173, 'f1-score': 0.3120077652684871, 'support': 224150}}
[[14150 11742 45326]
 [12774 11949 54291]
 [ 9714 11072 53132]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976453
{'0': {'precision': 0.38793928620265283, 'recall': 0.2058706142737927, 'f1-score': 0.26899281769265415, 'support': 27561}, '1': {'precision': 0.32551566080977845, 'recall': 0.1589273059565104, 'f1-score': 0.21357860705245482, 'support': 26811}, '2': {'precision': 0.3451755779401596, 'recall': 0.6878188656760883, 'f1-score': 0.45966999328040614, 'support': 26853}, 'accuracy': 0.3497076023391813, 'macro avg': {'precision': 0.35287684165086364, 'recall': 0.35087226196879717, 'f1-score': 0.3140804726751717, 'support': 81225}, 'weighted avg': {'precision': 0.35319661241525874, 'recall': 0.3497076023391813, 'f1-score': 0.313739432584418, 'support': 81225}}
[[ 5674  4659 17228]
 [ 4739  4261 17811]
 [ 4213  4170 18470]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939934
{'0': {'precision': 0.40011997600479904, 'recall': 0.22936726272352131, 'f1-score': 0.2915846994535519, 'support': 8724}, '1': {'precision': 0.3391445839144584, 'recall': 0.15898441756565326, 'f1-score': 0.2164849024408339, 'support': 9177}, '2': {'precision': 0.3484002326934264, 'recall': 0.6970437616387337, 'f1-score': 0.4645876968427585, 'support': 8592}, 'accuracy': 0.3566602498773261, 'macro avg': {'precision': 0.36255493087089463, 'recall': 0.36179848064263603, 'f1-score': 0.3242190995790481, 'support': 26493}, 'weighted avg': {'precision': 0.3622251657626834, 'recall': 0.3566602498773261, 'f1-score': 0.321677588759495, 'support': 26493}}
[[2001 1465 5258]
 [1775 1459 5943]
 [1225 1378 5989]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0842756
{'0': {'precision': 0.38531712318734435, 'recall': 0.37671346657272314, 'f1-score': 0.38096672536843085, 'support': 174573}, '1': {'precision': 0.3762508391580776, 'recall': 0.21463069589742204, 'f1-score': 0.2733372923318788, 'support': 221958}, '2': {'precision': 0.39655391803401707, 'recall': 0.5864406616100206, 'f1-score': 0.47315691636901575, 'support': 207252}, 'accuracy': 0.3891199321610579, 'macro avg': {'precision': 0.3860406267931464, 'recall': 0.3925949413600553, 'f1-score': 0.3758203113564418, 'support': 603783}, 'weighted avg': {'precision': 0.38584134121765423, 'recall': 0.3891199321610579, 'f1-score': 0.3730456473773748, 'support': 603783}}
[[ 65764  36193  72616]
 [ 61983  47639 112336]
 [ 42928  42783 121541]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921868
{'0': {'precision': 0.39517553967888147, 'recall': 0.4052547613889272, 'f1-score': 0.4001516904736438, 'support': 50773}, '1': {'precision': 0.33536422425311313, 'recall': 0.2511909050878668, 'f1-score': 0.2872379382953401, 'support': 49962}, '2': {'precision': 0.3716796811186983, 'recall': 0.45532229982589206, 'f1-score': 0.40927120153260843, 'support': 49969}, 'accuracy': 0.37077980677354283, 'macro avg': {'precision': 0.3674064816835643, 'recall': 0.37058932210089535, 'f1-score': 0.3655536101005308, 'support': 150704}, 'weighted avg': {'precision': 0.36755611685204187, 'recall': 0.37077980677354283, 'f1-score': 0.3657418271772018, 'support': 150704}}
[[20576 12037 18160]
 [17110 12550 20302]
 [14382 12835 22752]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903966
{'0': {'precision': 0.4123962134433339, 'recall': 0.3955765231065794, 'f1-score': 0.4038112992594894, 'support': 19713}, '1': {'precision': 0.31259678179492356, 'recall': 0.26686975514426947, 'f1-score': 0.2879290564633655, 'support': 17398}, '2': {'precision': 0.4207207566747815, 'recall': 0.48562741846323937, 'f1-score': 0.4508499946541217, 'support': 21708}, 'accuracy': 0.3907410870637039, 'macro avg': {'precision': 0.38190458397101296, 'recall': 0.3826912322380294, 'f1-score': 0.38086345012565886, 'support': 58819}, 'weighted avg': {'precision': 0.3859489544394274, 'recall': 0.3907410870637039, 'f1-score': 0.38689494127073937, 'support': 58819}}
[[ 7798  4641  7274]
 [ 5514  4643  7241]
 [ 5597  5569 10542]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
1625/1625 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925652
{'0': {'precision': 0.26715824937227856, 'recall': 0.3986530709034859, 'f1-score': 0.3199208342848443, 'support': 105425}, '1': {'precision': 0.47150306842746936, 'recall': 0.23569116683054736, 'f1-score': 0.31428171447497366, 'support': 195264}, '2': {'precision': 0.2947478312743904, 'recall': 0.41188985472007783, 'f1-score': 0.34360930306685356, 'support': 115157}, 'accuracy': 0.32579849271124406, 'macro avg': {'precision': 0.3444697163580461, 'recall': 0.3487446974847037, 'f1-score': 0.3259372839422238, 'support': 415846}, 'weighted avg': {'precision': 0.37075025273673146, 'recall': 0.32579849271124406, 'f1-score': 0.3238328014769665, 'support': 415846}}
[[42028 24727 38670]
 [74420 46022 74822]
 [40867 26858 47432]]
Evaluating performance on  train set...
451/451 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954964
{'0': {'precision': 0.3587353238643859, 'recall': 0.4316858926870568, 'f1-score': 0.39184418453853354, 'support': 37796}, '1': {'precision': 0.3300363043639327, 'recall': 0.2338504344174082, 'f1-score': 0.27373984114547323, 'support': 38097}, '2': {'precision': 0.377268919296286, 'recall': 0.4098596890405764, 'f1-score': 0.39288959976734883, 'support': 39555}, 'accuracy': 0.3589234980250849, 'macro avg': {'precision': 0.3553468491748682, 'recall': 0.3584653387150138, 'f1-score': 0.35282454181711853, 'support': 115448}, 'weighted avg': {'precision': 0.3556148698192751, 'recall': 0.3589234980250849, 'f1-score': 0.3532287925796462, 'support': 115448}}
[[16316  8612 12868]
 [15296  8909 13892]
 [13870  9473 16212]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933177
{'0': {'precision': 0.36831565273868805, 'recall': 0.4614184974233794, 'f1-score': 0.409643631110041, 'support': 14748}, '1': {'precision': 0.35983183642270206, 'recall': 0.23558113349180532, 'f1-score': 0.2847421745047633, 'support': 15986}, '2': {'precision': 0.356714665348248, 'recall': 0.40113975953853637, 'f1-score': 0.3776251226692836, 'support': 14389}, 'accuracy': 0.3621877977971323, 'macro avg': {'precision': 0.3616207181698794, 'recall': 0.3660464634845737, 'f1-score': 0.357336976094696, 'support': 45123}, 'weighted avg': {'precision': 0.3616106709070635, 'recall': 0.3621877977971323, 'f1-score': 0.35518384334668246, 'support': 45123}}
[[6805 3327 4616]
 [6427 3766 5793]
 [5244 3373 5772]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951692
{'0': {'precision': 0.3452590978893611, 'recall': 0.47360479699012387, 'f1-score': 0.39937373228294415, 'support': 102064}, '1': {'precision': 0.3645187938868236, 'recall': 0.1667210524507952, 'f1-score': 0.22879668147589477, 'support': 116452}, '2': {'precision': 0.358440057189791, 'recall': 0.4436245211449225, 'f1-score': 0.39650871768986473, 'support': 106243}, 'accuracy': 0.3537546303566645, 'macro avg': {'precision': 0.35607264965532526, 'recall': 0.3613167901952805, 'f1-score': 0.3415597104829012, 'support': 324759}, 'weighted avg': {'precision': 0.35647730824612434, 'recall': 0.3537546303566645, 'f1-score': 0.3372709838879957, 'support': 324759}}
[[48338 15952 37774]
 [50451 19415 46586]
 [41216 17895 47132]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094429
{'0': {'precision': 0.3742408547112709, 'recall': 0.4482314017418382, 'f1-score': 0.40790799101163394, 'support': 41106}, '1': {'precision': 0.32504023313470487, 'recall': 0.1823572474377745, 'f1-score': 0.2336371168185584, 'support': 40980}, '2': {'precision': 0.3731885450701518, 'recall': 0.4604676531967369, 'f1-score': 0.41225928363659525, 'support': 42168}, 'accuracy': 0.36469650876430537, 'macro avg': {'precision': 0.3574898776387092, 'recall': 0.36368543412544985, 'f1-score': 0.3512681304889292, 'support': 124254}, 'weighted avg': {'precision': 0.357656959905837, 'recall': 0.36469650876430537, 'f1-score': 0.3519087063445579, 'support': 124254}}
[[18425  7437 15244]
 [16138  7473 17369]
 [14670  8081 19417]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955395
{'0': {'precision': 0.35749916860658465, 'recall': 0.36744599398414, 'f1-score': 0.362404342109699, 'support': 14628}, '1': {'precision': 0.3287447503499767, 'recall': 0.18841936346616742, 'f1-score': 0.23954437266235973, 'support': 14956}, '2': {'precision': 0.38485761226725085, 'recall': 0.5292124254785064, 'f1-score': 0.4456363780484583, 'support': 15935}, 'accuracy': 0.3652540697291241, 'macro avg': {'precision': 0.35703384374127073, 'recall': 0.3616925943096046, 'f1-score': 0.34919503094017235, 'support': 45519}, 'weighted avg': {'precision': 0.3576289104789212, 'recall': 0.3652540697291241, 'f1-score': 0.35117406002155394, 'support': 45519}}
[[5375 2763 6490]
 [5149 2818 6989]
 [4511 2991 8433]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
1733/1733 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950174
{'0': {'precision': 0.3360276334152148, 'recall': 0.3891631379948368, 'f1-score': 0.3606487380377911, 'support': 136737}, '1': {'precision': 0.36573027884316367, 'recall': 0.21691976636950508, 'f1-score': 0.27232170422970053, 'support': 162650}, '2': {'precision': 0.35175272156796233, 'recall': 0.46050513461004716, 'f1-score': 0.3988485507725407, 'support': 144120}, 'accuracy': 0.3491782542327404, 'macro avg': {'precision': 0.35117021127544695, 'recall': 0.3555293463247963, 'f1-score': 0.34393966434667744, 'support': 443507}, 'weighted avg': {'precision': 0.3520306164198345, 'recall': 0.3491782542327404, 'f1-score': 0.34066926750507387, 'support': 443507}}
[[53213 30040 53484]
 [58542 35282 68826]
 [46604 31148 66368]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984607
{'0': {'precision': 0.34355537016526905, 'recall': 0.3746020294537413, 'f1-score': 0.358407610816002, 'support': 63761}, '1': {'precision': 0.3371688814573616, 'recall': 0.23737608426270138, 'f1-score': 0.27860597025779005, 'support': 64560}, '2': {'precision': 0.3712139028828182, 'recall': 0.44467179692481057, 'f1-score': 0.40463597603756274, 'support': 67443}, 'accuracy': 0.3534868515150896, 'macro avg': {'precision': 0.3506460515018162, 'recall': 0.35221663688041777, 'f1-score': 0.3472165190371183, 'support': 195764}, 'weighted avg': {'precision': 0.35097789274902885, 'recall': 0.3534868515150896, 'f1-score': 0.34801645473623016, 'support': 195764}}
[[23885 14652 25224]
 [23660 15325 25575]
 [21978 15475 29990]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981083
{'0': {'precision': 0.3437580548157058, 'recall': 0.38021476765181034, 'f1-score': 0.3610684956231387, 'support': 21046}, '1': {'precision': 0.34953799475934355, 'recall': 0.2268414928846326, 'f1-score': 0.27513026487190617, 'support': 22346}, '2': {'precision': 0.34687059172915585, 'recall': 0.4381506142736566, 'f1-score': 0.3872037129123156, 'support': 21326}, 'accuracy': 0.3463487746840137, 'macro avg': {'precision': 0.3467222137680684, 'recall': 0.3484022916033665, 'f1-score': 0.34113415780245343, 'support': 64718}, 'weighted avg': {'precision': 0.34677941672733414, 'recall': 0.3463487746840137, 'f1-score': 0.34000764608424605, 'support': 64718}}
[[8002 4768 8276]
 [7959 5069 9318]
 [7317 4665 9344]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/EXC
Evaluating performance on  test set...
4693/4693 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0826038
{'0': {'precision': 0.36454054865901664, 'recall': 0.49881686699529887, 'f1-score': 0.4212368390605114, 'support': 350341}, '1': {'precision': 0.41428091219503566, 'recall': 0.23635787378446743, 'f1-score': 0.3009920640021389, 'support': 495359}, '2': {'precision': 0.3700012523196375, 'recall': 0.45711657528967303, 'f1-score': 0.40897124851511063, 'support': 355487}, 'accuracy': 0.3782400242426866, 'macro avg': {'precision': 0.3829409043912299, 'recall': 0.3974304386898131, 'f1-score': 0.377066717192587, 'support': 1201187}, 'weighted avg': {'precision': 0.38666911473827154, 'recall': 0.3782400242426866, 'f1-score': 0.36801898912178144, 'support': 1201187}}
[[174756  77767  97818]
 [199409 117082 178868]
 [105222  87766 162499]]
Evaluating performance on  train set...
1497/1497 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0884808
{'0': {'precision': 0.39791289149349063, 'recall': 0.4862046764341012, 'f1-score': 0.4376501851694795, 'support': 127362}, '1': {'precision': 0.3407256755879617, 'recall': 0.24781267703153523, 'f1-score': 0.2869350533402571, 'support': 127096}, '2': {'precision': 0.39651930593390977, 'recall': 0.41623280752195196, 'f1-score': 0.40613697882310124, 'support': 128690}, 'accuracy': 0.38362460459143727, 'macro avg': {'precision': 0.3783859576717874, 'recall': 0.3834167203291961, 'f1-score': 0.37690740577761267, 'support': 383148}, 'weighted avg': {'precision': 0.3784749538861129, 'recall': 0.38362460459143727, 'f1-score': 0.37707117935532347, 'support': 383148}}
[[61924 28397 37041]
 [51118 31496 44482]
 [42580 32545 53565]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0844262
{'0': {'precision': 0.4067079568145666, 'recall': 0.5211527202550036, 'f1-score': 0.456872380264421, 'support': 46117}, '1': {'precision': 0.34457706279190453, 'recall': 0.24884965333444378, 'f1-score': 0.28899232303693406, 'support': 48029}, '2': {'precision': 0.4066836036740277, 'recall': 0.4099415588679493, 'f1-score': 0.40830608240680183, 'support': 45687}, 'accuracy': 0.3912881794712264, 'macro avg': {'precision': 0.38598954109349964, 'recall': 0.39331464415246553, 'f1-score': 0.3847235952360523, 'support': 139833}, 'weighted avg': {'precision': 0.3853596532599962, 'recall': 0.3912881794712264, 'f1-score': 0.383342099724062, 'support': 139833}}
[[24034 10468 11615]
 [20368 11952 15709]
 [14692 12266 18729]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/AAL
Evaluating performance on  test set...
6677/6677 - 89s - 89s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.087815
{'0': {'precision': 0.35088017359563317, 'recall': 0.417388850981577, 'f1-score': 0.3812557002929882, 'support': 499757}, '1': {'precision': 0.43736666499562743, 'recall': 0.2101038210424917, 'f1-score': 0.2838504904663181, 'support': 747440}, '2': {'precision': 0.32210766164993687, 'recall': 0.5268068143454436, 'f1-score': 0.39977763581213016, 'support': 462084}, 'accuracy': 0.35632643199099506, 'macro avg': {'precision': 0.3701181667470658, 'recall': 0.38476649545650415, 'f1-score': 0.3549612755238121, 'support': 1709281}, 'weighted avg': {'precision': 0.38092096017320387, 'recall': 0.35632643199099506, 'f1-score': 0.3436692180349984, 'support': 1709281}}
[[208593 105364 185800]
 [263891 157040 326509]
 [122001  96654 243429]]
Evaluating performance on  train set...
2262/2262 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933007
{'0': {'precision': 0.376765916780493, 'recall': 0.40574775973553445, 'f1-score': 0.3907201401489082, 'support': 192388}, '1': {'precision': 0.3371281674623577, 'recall': 0.19586387673925965, 'f1-score': 0.2477756677816443, 'support': 196851}, '2': {'precision': 0.3703814550797192, 'recall': 0.5026108696569476, 'f1-score': 0.42648197462349224, 'support': 189592}, 'accuracy': 0.3660964944863008, 'macro avg': {'precision': 0.36142517977419003, 'recall': 0.3680741687105806, 'f1-score': 0.3549925941846816, 'support': 578831}, 'weighted avg': {'precision': 0.36119457824852536, 'recall': 0.3660964944863008, 'f1-score': 0.3538205881064935, 'support': 578831}}
[[78061 38293 76034]
 [72342 38556 85953]
 [56784 37517 95291]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903611
{'0': {'precision': 0.3657969356282957, 'recall': 0.44333408696962845, 'f1-score': 0.4008504085095364, 'support': 66345}, '1': {'precision': 0.3703075971690983, 'recall': 0.2084848484848485, 'f1-score': 0.26677446766382584, 'support': 77550}, '2': {'precision': 0.37200982913309333, 'recall': 0.48100311811907964, 'f1-score': 0.41954319300868753, 'support': 67669}, 'accuracy': 0.3692972339339396, 'macro avg': {'precision': 0.36937145397682913, 'recall': 0.37760735119118555, 'f1-score': 0.3623893563940166, 'support': 211564}, 'weighted avg': {'precision': 0.3694375460018252, 'recall': 0.3692972339339396, 'f1-score': 0.3576830115123545, 'support': 211564}}
[[29413 13456 23476]
 [29912 16168 31470]
 [21083 14037 32549]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/WBA
Evaluating performance on  test set...
5633/5633 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891885
{'0': {'precision': 0.35099933693284074, 'recall': 0.3729385828281134, 'f1-score': 0.3616365208015764, 'support': 417310}, '1': {'precision': 0.40265128550768325, 'recall': 0.20883661122704947, 'f1-score': 0.27502859965229304, 'support': 569268}, '2': {'precision': 0.3527891783350541, 'recall': 0.5449191764543077, 'f1-score': 0.4282940834731055, 'support': 455251}, 'accuracy': 0.36244936119331767, 'macro avg': {'precision': 0.3688132669251927, 'recall': 0.3755647901698235, 'f1-score': 0.3549864013089916, 'support': 1441829}, 'weighted avg': {'precision': 0.37195787539302044, 'recall': 0.36244936119331767, 'f1-score': 0.34848850117301156, 'support': 1441829}}
[[155631  86351 175328]
 [170605 118884 279779]
 [117158  90018 248075]]
Evaluating performance on  train set...
1454/1454 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951198
{'0': {'precision': 0.37097570204155494, 'recall': 0.3670059972821001, 'f1-score': 0.3689801728686959, 'support': 122889}, '1': {'precision': 0.3336124805835078, 'recall': 0.20093556784900748, 'f1-score': 0.2508085603310401, 'support': 122920}, '2': {'precision': 0.367234423517146, 'recall': 0.5132162427544266, 'f1-score': 0.42812318342757494, 'support': 126284}, 'accuracy': 0.3617670851104428, 'macro avg': {'precision': 0.3572742020474029, 'recall': 0.3603859359618447, 'f1-score': 0.34930397220910364, 'support': 372093}, 'weighted avg': {'precision': 0.3573631084189939, 'recall': 0.3617670851104428, 'f1-score': 0.3500149177638937, 'support': 372093}}
[[45101 24614 53174]
 [39722 24699 58499]
 [36751 24722 64811]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956722
{'0': {'precision': 0.36871733011660635, 'recall': 0.34966634890371784, 'f1-score': 0.3589392308445053, 'support': 47205}, '1': {'precision': 0.33328461819510413, 'recall': 0.19505623743745457, 'f1-score': 0.24608827020610768, 'support': 46766}, '2': {'precision': 0.3662094088852207, 'recall': 0.5312867730547699, 'f1-score': 0.43356666919376985, 'support': 48439}, 'accuracy': 0.36066989677691175, 'macro avg': {'precision': 0.35607045239897706, 'recall': 0.3586697864653141, 'f1-score': 0.3461980567481276, 'support': 142410}, 'weighted avg': {'precision': 0.3562285484141412, 'recall': 0.36066989677691175, 'f1-score': 0.3472637197215836, 'support': 142410}}
[[16506  9137 21562]
 [14667  9122 22977]
 [13593  9111 25735]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
11876/11876 - 159s - 159s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952988
{'0': {'precision': 0.43143762356217313, 'recall': 0.3480387724309364, 'f1-score': 0.3852766335375384, 'support': 1128018}, '1': {'precision': 0.24732143328157613, 'recall': 0.18870104099723214, 'f1-score': 0.21407067146414374, 'support': 745343}, '2': {'precision': 0.42487957138813426, 'recall': 0.5686115703470968, 'f1-score': 0.486348453743523, 'support': 1166793}, 'accuracy': 0.39362907273776265, 'macro avg': {'precision': 0.3678795427439612, 'recall': 0.3684504612584218, 'f1-score': 0.3618985862484017, 'support': 3040154}, 'weighted avg': {'precision': 0.3837816156814492, 'recall': 0.39362907273776265, 'f1-score': 0.38209348127746584, 'support': 3040154}}
[[392594 212835 522589]
 [229231 140647 375465]
 [288142 215199 663452]]
Evaluating performance on  train set...
2538/2538 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940847
{'0': {'precision': 0.3772704982346018, 'recall': 0.3557529571707344, 'f1-score': 0.3661959093137605, 'support': 216254}, '1': {'precision': 0.336591644062136, 'recall': 0.18723294350070008, 'f1-score': 0.2406188856796795, 'support': 220693}, '2': {'precision': 0.36249036201659124, 'recall': 0.5504262332081044, 'f1-score': 0.4371137639138341, 'support': 212677}, 'accuracy': 0.3622356932625642, 'macro avg': {'precision': 0.35878416810444297, 'recall': 0.3644707112931796, 'f1-score': 0.3479761863024247, 'support': 649624}, 'weighted avg': {'precision': 0.35861211524025144, 'recall': 0.3622356932625642, 'f1-score': 0.3467517793030214, 'support': 649624}}
[[ 76933  41948  97373]
 [ 70867  41321 108505]
 [ 56120  39494 117063]]
Evaluating performance on  val set...
795/795 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931766
{'0': {'precision': 0.3715338146456461, 'recall': 0.3795418284716578, 'f1-score': 0.37549513059534806, 'support': 66438}, '1': {'precision': 0.344428743392474, 'recall': 0.1886646407889456, 'f1-score': 0.24379040174850433, 'support': 69764}, '2': {'precision': 0.3707420799605539, 'recall': 0.5368287966681541, 'f1-score': 0.43858838969971686, 'support': 67230}, 'accuracy': 0.3660633528648394, 'macro avg': {'precision': 0.36223487933289134, 'recall': 0.36834508864291915, 'f1-score': 0.35262464068118976, 'support': 203432}, 'weighted avg': {'precision': 0.3619768790908413, 'recall': 0.3660633528648394, 'f1-score': 0.35117993488530985, 'support': 203432}}
[[25216 12713 28509]
 [23854 13162 32748]
 [18800 12339 36091]]
testing model on single stock: results/universal/W0/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
19053/19053 - 250s - 250s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876317
{'0': {'precision': 0.30679410379826305, 'recall': 0.37742566132458005, 'f1-score': 0.33846425788577533, 'support': 1242960}, '1': {'precision': 0.5071403458667857, 'recall': 0.20313993202251598, 'f1-score': 0.2900839530315946, 'support': 2421390}, '2': {'precision': 0.28477662645080865, 'recall': 0.5583375099744785, 'f1-score': 0.37717662565978494, 'support': 1213096}, 'accuracy': 0.3358977218814929, 'macro avg': {'precision': 0.36623702537195246, 'recall': 0.3796343677738581, 'f1-score': 0.33524161219238496, 'support': 4877446}, 'weighted avg': {'precision': 0.40077916757590665, 'recall': 0.3358977218814929, 'f1-score': 0.3240743973165994, 'support': 4877446}}
[[ 469125  248814  525021]
 [ 753432  491881 1176077]
 [ 306563  229216  677317]]
Evaluating performance on  train set...
4812/4812 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949414
{'0': {'precision': 0.3756168751096455, 'recall': 0.36209913822684536, 'f1-score': 0.36873415873277354, 'support': 407996}, '1': {'precision': 0.33532330779156644, 'recall': 0.20665441095258316, 'f1-score': 0.2557154593399451, 'support': 407429}, '2': {'precision': 0.37092611947666404, 'recall': 0.5232541386315501, 'f1-score': 0.4341152142037486, 'support': 416442}, 'accuracy': 0.3651668564869422, 'macro avg': {'precision': 0.3606221007926253, 'recall': 0.36400256260365954, 'f1-score': 0.35285494409215573, 'support': 1231867}, 'weighted avg': {'precision': 0.3607043922716868, 'recall': 0.3651668564869422, 'f1-score': 0.35345679666976115, 'support': 1231867}}
[[147735  83739 176522]
 [130197  84197 193035]
 [115381  83156 217905]]
Evaluating performance on  val set...
1767/1767 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944856
{'0': {'precision': 0.3689184642416539, 'recall': 0.3350376858830719, 'f1-score': 0.35116274931943137, 'support': 147270}, '1': {'precision': 0.3588596801698896, 'recall': 0.21102057291338186, 'f1-score': 0.2657638158025378, 'support': 158558}, '2': {'precision': 0.35678684129935956, 'recall': 0.5488546751783703, 'f1-score': 0.43245395076605264, 'support': 146465}, 'accuracy': 0.3608015158315517, 'macro avg': {'precision': 0.36152166190363433, 'recall': 0.364970977991608, 'f1-score': 0.3497935052960073, 'support': 452293}, 'weighted avg': {'precision': 0.36146365322513596, 'recall': 0.3608015158315517, 'f1-score': 0.3475492326815611, 'support': 452293}}
[[49341 30702 67227]
 [47403 33459 77696]
 [37001 29076 80388]]
training model: results/universal/W0/deepLOB_L2/h50
Epoch 1/50
8838/8838 - 421s - loss: 3.1416 - accuracy50: 0.4410 - val_loss: 3.2935 - val_accuracy50: 0.3726 - 421s/epoch - 48ms/step
Epoch 2/50
8838/8838 - 414s - loss: 3.1023 - accuracy50: 0.4560 - val_loss: 3.2940 - val_accuracy50: 0.3723 - 414s/epoch - 47ms/step
Epoch 3/50
8838/8838 - 415s - loss: 3.0720 - accuracy50: 0.4663 - val_loss: 3.2493 - val_accuracy50: 0.3903 - 415s/epoch - 47ms/step
Epoch 4/50
8838/8838 - 415s - loss: 3.0429 - accuracy50: 0.4752 - val_loss: 3.2683 - val_accuracy50: 0.3792 - 415s/epoch - 47ms/step
Epoch 5/50
8838/8838 - 418s - loss: 3.0190 - accuracy50: 0.4816 - val_loss: 3.2477 - val_accuracy50: 0.3984 - 418s/epoch - 47ms/step
Epoch 6/50
8838/8838 - 417s - loss: 3.0049 - accuracy50: 0.4852 - val_loss: 3.2543 - val_accuracy50: 0.4036 - 417s/epoch - 47ms/step
Epoch 7/50
8838/8838 - 421s - loss: 2.9944 - accuracy50: 0.4880 - val_loss: 3.2568 - val_accuracy50: 0.4058 - 421s/epoch - 48ms/step
Epoch 8/50
8838/8838 - 417s - loss: 2.9861 - accuracy50: 0.4904 - val_loss: 3.2524 - val_accuracy50: 0.4128 - 417s/epoch - 47ms/step
Epoch 9/50
8838/8838 - 420s - loss: 2.9803 - accuracy50: 0.4916 - val_loss: 3.2582 - val_accuracy50: 0.4134 - 420s/epoch - 47ms/step
Epoch 10/50
8838/8838 - 414s - loss: 2.9754 - accuracy50: 0.4932 - val_loss: 3.2349 - val_accuracy50: 0.4214 - 414s/epoch - 47ms/step
Epoch 11/50
8838/8838 - 409s - loss: 2.9710 - accuracy50: 0.4940 - val_loss: 3.2308 - val_accuracy50: 0.4280 - 409s/epoch - 46ms/step
Epoch 12/50
8838/8838 - 411s - loss: 2.9672 - accuracy50: 0.4950 - val_loss: 3.2363 - val_accuracy50: 0.4286 - 411s/epoch - 47ms/step
Epoch 13/50
8838/8838 - 419s - loss: 2.9642 - accuracy50: 0.4962 - val_loss: 3.2221 - val_accuracy50: 0.4302 - 419s/epoch - 47ms/step
Epoch 14/50
8838/8838 - 420s - loss: 2.9610 - accuracy50: 0.4969 - val_loss: 3.2191 - val_accuracy50: 0.4322 - 420s/epoch - 48ms/step
Epoch 15/50
8838/8838 - 417s - loss: 2.9584 - accuracy50: 0.4978 - val_loss: 3.2159 - val_accuracy50: 0.4329 - 417s/epoch - 47ms/step
Epoch 16/50
8838/8838 - 414s - loss: 2.9559 - accuracy50: 0.4985 - val_loss: 3.2172 - val_accuracy50: 0.4351 - 414s/epoch - 47ms/step
Epoch 17/50
8838/8838 - 421s - loss: 2.9533 - accuracy50: 0.4989 - val_loss: 3.2174 - val_accuracy50: 0.4372 - 421s/epoch - 48ms/step
Epoch 18/50
8838/8838 - 418s - loss: 2.9513 - accuracy50: 0.4996 - val_loss: 3.2091 - val_accuracy50: 0.4371 - 418s/epoch - 47ms/step
Epoch 19/50
8838/8838 - 413s - loss: 2.9489 - accuracy50: 0.5001 - val_loss: 3.2159 - val_accuracy50: 0.4366 - 413s/epoch - 47ms/step
Epoch 20/50
8838/8838 - 412s - loss: 2.9469 - accuracy50: 0.5008 - val_loss: 3.2203 - val_accuracy50: 0.4368 - 412s/epoch - 47ms/step
Epoch 21/50
8838/8838 - 412s - loss: 2.9446 - accuracy50: 0.5016 - val_loss: 3.2303 - val_accuracy50: 0.4366 - 412s/epoch - 47ms/step
Epoch 22/50
8838/8838 - 415s - loss: 2.9432 - accuracy50: 0.5020 - val_loss: 3.2225 - val_accuracy50: 0.4372 - 415s/epoch - 47ms/step
Epoch 23/50
8838/8838 - 420s - loss: 2.9412 - accuracy50: 0.5025 - val_loss: 3.2407 - val_accuracy50: 0.4336 - 420s/epoch - 48ms/step
Epoch 24/50
8838/8838 - 420s - loss: 2.9394 - accuracy50: 0.5027 - val_loss: 3.2308 - val_accuracy50: 0.4362 - 420s/epoch - 48ms/step
Epoch 25/50
8838/8838 - 418s - loss: 2.9375 - accuracy50: 0.5035 - val_loss: 3.2089 - val_accuracy50: 0.4376 - 418s/epoch - 47ms/step
Epoch 26/50
8838/8838 - 417s - loss: 2.9362 - accuracy50: 0.5035 - val_loss: 3.2217 - val_accuracy50: 0.4349 - 417s/epoch - 47ms/step
Epoch 27/50
8838/8838 - 420s - loss: 2.9344 - accuracy50: 0.5040 - val_loss: 3.2090 - val_accuracy50: 0.4372 - 420s/epoch - 47ms/step
Epoch 28/50
8838/8838 - 422s - loss: 2.9328 - accuracy50: 0.5046 - val_loss: 3.2092 - val_accuracy50: 0.4367 - 422s/epoch - 48ms/step
Epoch 29/50
8838/8838 - 424s - loss: 2.9308 - accuracy50: 0.5049 - val_loss: 3.2095 - val_accuracy50: 0.4365 - 424s/epoch - 48ms/step
Epoch 30/50
8838/8838 - 424s - loss: 2.9291 - accuracy50: 0.5056 - val_loss: 3.2049 - val_accuracy50: 0.4376 - 424s/epoch - 48ms/step
Epoch 31/50
8838/8838 - 423s - loss: 2.9275 - accuracy50: 0.5060 - val_loss: 3.2059 - val_accuracy50: 0.4353 - 423s/epoch - 48ms/step
Epoch 32/50
8838/8838 - 422s - loss: 2.9261 - accuracy50: 0.5068 - val_loss: 3.2145 - val_accuracy50: 0.4352 - 422s/epoch - 48ms/step
Epoch 33/50
8838/8838 - 422s - loss: 2.9243 - accuracy50: 0.5071 - val_loss: 3.2168 - val_accuracy50: 0.4358 - 422s/epoch - 48ms/step
Epoch 34/50
8838/8838 - 419s - loss: 2.9227 - accuracy50: 0.5074 - val_loss: 3.2066 - val_accuracy50: 0.4359 - 419s/epoch - 47ms/step
Epoch 35/50
8838/8838 - 422s - loss: 2.9209 - accuracy50: 0.5082 - val_loss: 3.2036 - val_accuracy50: 0.4344 - 422s/epoch - 48ms/step
Epoch 36/50
8838/8838 - 420s - loss: 2.9194 - accuracy50: 0.5084 - val_loss: 3.1982 - val_accuracy50: 0.4368 - 420s/epoch - 47ms/step
Epoch 37/50
8838/8838 - 425s - loss: 2.9178 - accuracy50: 0.5090 - val_loss: 3.1934 - val_accuracy50: 0.4368 - 425s/epoch - 48ms/step
Epoch 38/50
8838/8838 - 426s - loss: 2.9162 - accuracy50: 0.5095 - val_loss: 3.1922 - val_accuracy50: 0.4369 - 426s/epoch - 48ms/step
Epoch 39/50
8838/8838 - 424s - loss: 2.9147 - accuracy50: 0.5099 - val_loss: 3.2110 - val_accuracy50: 0.4334 - 424s/epoch - 48ms/step
Epoch 40/50
8838/8838 - 426s - loss: 2.9133 - accuracy50: 0.5104 - val_loss: 3.1933 - val_accuracy50: 0.4364 - 426s/epoch - 48ms/step
Epoch 41/50
8838/8838 - 424s - loss: 2.9116 - accuracy50: 0.5108 - val_loss: 3.2013 - val_accuracy50: 0.4369 - 424s/epoch - 48ms/step
Epoch 42/50
8838/8838 - 420s - loss: 2.9108 - accuracy50: 0.5112 - val_loss: 3.2043 - val_accuracy50: 0.4353 - 420s/epoch - 48ms/step
Epoch 43/50
8838/8838 - 416s - loss: 2.9089 - accuracy50: 0.5116 - val_loss: 3.2041 - val_accuracy50: 0.4369 - 416s/epoch - 47ms/step
Epoch 44/50
8838/8838 - 413s - loss: 2.9075 - accuracy50: 0.5123 - val_loss: 3.1971 - val_accuracy50: 0.4385 - 413s/epoch - 47ms/step
Epoch 45/50
8838/8838 - 412s - loss: 2.9058 - accuracy50: 0.5125 - val_loss: 3.2066 - val_accuracy50: 0.4360 - 412s/epoch - 47ms/step
Epoch 46/50
8838/8838 - 408s - loss: 2.9045 - accuracy50: 0.5134 - val_loss: 3.2119 - val_accuracy50: 0.4313 - 408s/epoch - 46ms/step
Epoch 47/50
8838/8838 - 410s - loss: 2.9029 - accuracy50: 0.5137 - val_loss: 3.2149 - val_accuracy50: 0.4344 - 410s/epoch - 46ms/step
Epoch 48/50
8838/8838 - 419s - loss: 2.9018 - accuracy50: 0.5140 - val_loss: 3.2253 - val_accuracy50: 0.4329 - 419s/epoch - 47ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 559s - 559s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0005924
{'0': {'precision': 0.38422848039228363, 'recall': 0.3668957294355948, 'f1-score': 0.3753621218407032, 'support': 2024627}, '1': {'precision': 0.6102499876443921, 'recall': 0.6181635678223862, 'f1-score': 0.6141812876405149, 'support': 4394434}, '2': {'precision': 0.3652835760451172, 'recall': 0.3714639836687081, 'f1-score': 0.36834785684034466, 'support': 2029968}, 'accuracy': 0.49868049926210456, 'macro avg': {'precision': 0.45325401469393095, 'recall': 0.45217442697556304, 'f1-score': 0.45263042210718757, 'support': 8449029}, 'weighted avg': {'precision': 0.4972330690393462, 'recall': 0.49868049926210456, 'f1-score': 0.497889376575902, 'support': 8449029}}
[[ 742827  840726  441074]
 [ 808775 2716479  869180]
 [ 381693  894215  754060]]
Evaluating performance on  train set...
8838/8838 - 156s - 156s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0629792
{'0': {'precision': 0.42792599174335766, 'recall': 0.37553995718345384, 'f1-score': 0.4000251879538611, 'support': 710473}, '1': {'precision': 0.4315875235817202, 'recall': 0.6013824856815717, 'f1-score': 0.5025299387071998, 'support': 823589}, '2': {'precision': 0.43424941289572255, 'recall': 0.2928572409719647, 'f1-score': 0.34980586211903575, 'support': 728010}, 'accuracy': 0.43115603747360826, 'macro avg': {'precision': 0.4312543094069335, 'recall': 0.4232598946123301, 'f1-score': 0.4174536629266989, 'support': 2262072}, 'weighted avg': {'precision': 0.43129419186181467, 'recall': 0.43115603747360826, 'f1-score': 0.4211834949251601, 'support': 2262072}}
[[266811 309856 133806]
 [184337 495292 143960]
 [172350 342457 213203]]
Evaluating performance on  val set...
3279/3279 - 56s - 56s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0598903
{'0': {'precision': 0.4109436438217787, 'recall': 0.34337665411087226, 'f1-score': 0.374134048441717, 'support': 253535}, '1': {'precision': 0.4517490222253716, 'recall': 0.606816507000737, 'f1-score': 0.5179249770360598, 'support': 325680}, '2': {'precision': 0.4319537864999604, 'recall': 0.3153291586755089, 'f1-score': 0.3645409679509012, 'support': 259662}, 'accuracy': 0.4369710934976165, 'macro avg': {'precision': 0.43154881751570356, 'recall': 0.42184077326237274, 'f1-score': 0.418866664476226, 'support': 838877}, 'weighted avg': {'precision': 0.43328903093643817, 'recall': 0.4369710934976165, 'f1-score': 0.42698908101287975, 'support': 838877}}
[[ 87058 116590  49887]
 [ 70263 197628  57789]
 [ 54528 123255  81879]]
testing model out of sample: results/universal/W0/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 390s - 390s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0503405
{'0': {'precision': 0.46267365861893267, 'recall': 0.3142557964811426, 'f1-score': 0.37428849722632396, 'support': 1909995}, '1': {'precision': 0.43017925296192455, 'recall': 0.5998488678456253, 'f1-score': 0.5010397923069906, 'support': 1982371}, '2': {'precision': 0.44197961851901196, 'recall': 0.4034469804910551, 'f1-score': 0.4218351841280557, 'support': 1940597}, 'accuracy': 0.44098993941843967, 'macro avg': {'precision': 0.4449441766999564, 'recall': 0.439183881605941, 'f1-score': 0.43238782455379005, 'support': 5832963}, 'weighted avg': {'precision': 0.44474541879082563, 'recall': 0.44098993941843967, 'f1-score': 0.4331843019042888, 'support': 5832963}}
[[ 600227  775371  534397]
 [ 339161 1189123  454087]
 [ 357913  799756  782928]]
Evaluating performance on  train set...
6334/6334 - 114s - 114s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0532718
{'0': {'precision': 0.45693701369485407, 'recall': 0.342176275868281, 'f1-score': 0.39131624437870394, 'support': 532892}, '1': {'precision': 0.4379265674510257, 'recall': 0.6521028799130593, 'f1-score': 0.5239733229516488, 'support': 552100}, '2': {'precision': 0.4594526305256048, 'recall': 0.3427024787836718, 'f1-score': 0.3925813188433988, 'support': 535908}, 'accuracy': 0.44791535566660495, 'macro avg': {'precision': 0.4514387372238282, 'recall': 0.445660544855004, 'f1-score': 0.4359569620579172, 'support': 1620900}, 'weighted avg': {'precision': 0.4512935266279877, 'recall': 0.44791535566660495, 'f1-score': 0.4369192652969275, 'support': 1620900}}
[[182343 227051 123498]
 [ 99499 360026  92575]
 [117213 235038 183657]]
Evaluating performance on  val set...
2156/2156 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0445787
{'0': {'precision': 0.4591929705355488, 'recall': 0.33737817261762937, 'f1-score': 0.388971372136069, 'support': 176274}, '1': {'precision': 0.4552678970937908, 'recall': 0.6249219570878192, 'f1-score': 0.5267720376186279, 'support': 197007}, '2': {'precision': 0.44942105854145065, 'recall': 0.3821476110508905, 'f1-score': 0.4130631423662755, 'support': 178049}, 'accuracy': 0.4545843687083961, 'macro avg': {'precision': 0.45462730872359675, 'recall': 0.4481492469187797, 'f1-score': 0.4429355173736575, 'support': 551330}, 'weighted avg': {'precision': 0.4546346368657365, 'recall': 0.4545843687083961, 'f1-score': 0.4459920517697558, 'support': 551330}}
[[ 59471  71773  45030]
 [ 35567 123114  38326]
 [ 34474  75534  68041]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1198827
{'0': {'precision': 0.3232942490228922, 'recall': 0.4743343982960596, 'f1-score': 0.3845137297871634, 'support': 61035}, '1': {'precision': 0.50728264059435, 'recall': 0.3271052238434341, 'f1-score': 0.3977402087824255, 'support': 100405}, '2': {'precision': 0.3365348830551659, 'recall': 0.37488639081559433, 'f1-score': 0.35467690474214986, 'support': 62715}, 'accuracy': 0.38056255715910864, 'macro avg': {'precision': 0.3890372575574694, 'recall': 0.3921086709850294, 'f1-score': 0.37897694777057955, 'support': 224155}, 'weighted avg': {'precision': 0.40941207293521303, 'recall': 0.38056255715910864, 'f1-score': 0.3820903537340808, 'support': 224155}}
[[28951 15559 16525]
 [37736 32843 29826]
 [22863 16341 23511]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1409372
{'0': {'precision': 0.3878147288820143, 'recall': 0.32615451326154515, 'f1-score': 0.35432205385883647, 'support': 27674}, '1': {'precision': 0.35162343551605296, 'recall': 0.28952281383018447, 'f1-score': 0.31756563050333786, 'support': 26782}, '2': {'precision': 0.36931090189961563, 'recall': 0.4952562378604512, 'f1-score': 0.42311006158853753, 'support': 26772}, 'accuracy': 0.36981090264440836, 'macro avg': {'precision': 0.3695830220992276, 'recall': 0.37031118831739357, 'f1-score': 0.3649992486502373, 'support': 81228}, 'weighted avg': {'precision': 0.36978326590250044, 'recall': 0.36981090264440836, 'f1-score': 0.36487484369279266, 'support': 81228}}
[[ 9026  7433 11215]
 [ 7600  7754 11428]
 [ 6648  6865 13259]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1222616
{'0': {'precision': 0.36145241151659635, 'recall': 0.47892115174340905, 'f1-score': 0.41197679887129646, 'support': 8231}, '1': {'precision': 0.4444645114683041, 'recall': 0.24961963688000813, 'f1-score': 0.31969342686412056, 'support': 9859}, '2': {'precision': 0.3582089552238806, 'recall': 0.42841842199214564, 'f1-score': 0.3901804584620387, 'support': 8403}, 'accuracy': 0.37757143396368853, 'macro avg': {'precision': 0.388041959402927, 'recall': 0.38565307020518763, 'f1-score': 0.3739502280658186, 'support': 26493}, 'weighted avg': {'precision': 0.3913154519497748, 'recall': 0.37757143396368853, 'f1-score': 0.3707215083010424, 'support': 26493}}
[[3942 1515 2774]
 [3722 2461 3676]
 [3242 1561 3600]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
2359/2359 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91283923
{'0': {'precision': 0.45314014403317426, 'recall': 0.5179025891623958, 'f1-score': 0.48336174264111686, 'support': 142633}, '1': {'precision': 0.6957142298517968, 'recall': 0.6911579513044717, 'f1-score': 0.693428606227924, 'support': 308899}, '2': {'precision': 0.46070025542593396, 'recall': 0.4051400273224044, 'f1-score': 0.431137515289184, 'support': 152256}, 'accuracy': 0.5781052289876579, 'macro avg': {'precision': 0.5365182097703016, 'recall': 0.5380668559297573, 'f1-score': 0.5359759547194082, 'support': 603788}, 'weighted avg': {'precision': 0.5791478898901682, 'recall': 0.5781052289876579, 'f1-score': 0.5776630406718913, 'support': 603788}}
[[ 73870  41496  27267]
 [ 50459 213498  44942]
 [ 38689  51882  61685]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9403147
{'0': {'precision': 0.485573051181649, 'recall': 0.42790367578679456, 'f1-score': 0.45491797947210255, 'support': 40862}, '1': {'precision': 0.622458484138812, 'recall': 0.6711188901482003, 'f1-score': 0.6458734596665632, 'support': 69703}, '2': {'precision': 0.459665183087194, 'recall': 0.45284005979073244, 'f1-score': 0.45622709703328146, 'support': 40140}, 'accuracy': 0.547035599349723, 'macro avg': {'precision': 0.5225655728025517, 'recall': 0.5172875419085757, 'f1-score': 0.5190061787239824, 'support': 150705}, 'weighted avg': {'precision': 0.5419838106660836, 'recall': 0.547035599349723, 'f1-score': 0.5435860250903648, 'support': 150705}}
[[17485 14582  8795]
 [10352 46779 12572]
 [ 8172 13791 18177]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9587626
{'0': {'precision': 0.48320552147239265, 'recall': 0.3817399733430268, 'f1-score': 0.4265213565288026, 'support': 16506}, '1': {'precision': 0.5932800669899864, 'recall': 0.665570690465007, 'f1-score': 0.6273497020789907, 'support': 25548}, '2': {'precision': 0.4476897015012559, 'recall': 0.45711559107718003, 'f1-score': 0.4523535487678914, 'support': 16766}, 'accuracy': 0.5265045902754165, 'macro avg': {'precision': 0.5080584299878783, 'recall': 0.5014754182950713, 'f1-score': 0.5020748691252283, 'support': 58820}, 'weighted avg': {'precision': 0.5208921289400466, 'recall': 0.5265045902754165, 'f1-score': 0.5211127388340859, 'support': 58820}}
[[ 6301  5702  4503]
 [ 3592 17004  4952]
 [ 3147  5955  7664]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
1625/1625 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0757505
{'0': {'precision': 0.4252110498989338, 'recall': 0.47315266047762905, 'f1-score': 0.4479026416590996, 'support': 136047}, '1': {'precision': 0.41709440337454673, 'recall': 0.5510794537686692, 'f1-score': 0.47481586966175143, 'support': 140673}, '2': {'precision': 0.4842436039336921, 'recall': 0.2735767010946518, 'f1-score': 0.3496284457181699, 'support': 139131}, 'accuracy': 0.4327415348285804, 'macro avg': {'precision': 0.4421830190690576, 'recall': 0.4326029384469834, 'f1-score': 0.4241156523463403, 'support': 415851}, 'weighted avg': {'precision': 0.44221585512697187, 'recall': 0.4327415348285804, 'f1-score': 0.42412724462352575, 'support': 415851}}
[[64371 51937 19739]
 [42350 77522 20801]
 [44665 56403 38063]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0846299
{'0': {'precision': 0.40973841522872767, 'recall': 0.5047790661234722, 'f1-score': 0.45232022090655927, 'support': 38292}, '1': {'precision': 0.4115322230598771, 'recall': 0.4749775879343986, 'f1-score': 0.4409845897746606, 'support': 37926}, '2': {'precision': 0.45520956617557035, 'recall': 0.2843087275693312, 'f1-score': 0.3500117674747, 'support': 39232}, 'accuracy': 0.4200692940666955, 'macro avg': {'precision': 0.4254934014880584, 'recall': 0.42135512720906737, 'f1-score': 0.41443885938530656, 'support': 115450}, 'weighted avg': {'precision': 0.4257796118484826, 'recall': 0.4200692940666955, 'f1-score': 0.4138301352301011, 'support': 115450}}
[[19329 12213  6750]
 [13313 18014  6599]
 [14532 13546 11154]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1013601
{'0': {'precision': 0.4181111184340605, 'recall': 0.4160545645330535, 'f1-score': 0.4170803063673121, 'support': 15248}, '1': {'precision': 0.3798399407873433, 'recall': 0.5521484769013516, 'f1-score': 0.45006577504933126, 'support': 14871}, '2': {'precision': 0.4359774390975639, 'recall': 0.24213543055185283, 'f1-score': 0.311351073402751, 'support': 15004}, 'accuracy': 0.4030760366110409, 'macro avg': {'precision': 0.41130949943965595, 'recall': 0.40344615732875266, 'f1-score': 0.3928323849397981, 'support': 45123}, 'weighted avg': {'precision': 0.4114390352935529, 'recall': 0.4030760366110409, 'f1-score': 0.39279480880221296, 'support': 45123}}
[[6344 6552 2352]
 [4312 8211 2348]
 [4517 6854 3633]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1481622
{'0': {'precision': 0.34559156524200396, 'recall': 0.45277054150018076, 'f1-score': 0.3919867408813461, 'support': 107867}, '1': {'precision': 0.3785620431961895, 'recall': 0.16824212120659135, 'f1-score': 0.23295389941000338, 'support': 109598}, '2': {'precision': 0.35074516090725566, 'recall': 0.44043280925264916, 'f1-score': 0.39050550540211126, 'support': 107299}, 'accuracy': 0.35267455752484883, 'macro avg': {'precision': 0.35829958978181636, 'recall': 0.3538151573198071, 'f1-score': 0.3384820485644869, 'support': 324764}, 'weighted avg': {'precision': 0.358420801561635, 'recall': 0.35267455752484883, 'f1-score': 0.33782859390303993, 'support': 324764}}
[[48839 15000 44028]
 [47709 18439 43450]
 [44772 15269 47258]]
Evaluating performance on  train set...
486/486 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1500821
{'0': {'precision': 0.3613887660327289, 'recall': 0.39595851909284746, 'f1-score': 0.3778846598529344, 'support': 41272}, '1': {'precision': 0.3635151996370236, 'recall': 0.3118750456171082, 'f1-score': 0.33572092657823405, 'support': 41103}, '2': {'precision': 0.3571542802312033, 'recall': 0.3732808022922636, 'f1-score': 0.3650395208462249, 'support': 41880}, 'accuracy': 0.36050058347752606, 'macro avg': {'precision': 0.36068608196698526, 'recall': 0.3603714556674064, 'f1-score': 0.3595483690924644, 'support': 124255}, 'weighted avg': {'precision': 0.36066495238393764, 'recall': 0.36050058347752606, 'f1-score': 0.35960764604752615, 'support': 124255}}
[[16342 11047 13883]
 [14029 12819 14255]
 [14849 11398 15633]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1723605
{'0': {'precision': 0.35057079183153683, 'recall': 0.5153784434340732, 'f1-score': 0.417291503126438, 'support': 14956}, '1': {'precision': 0.35833333333333334, 'recall': 0.41247684572638266, 'f1-score': 0.38350350596629357, 'support': 15116}, '2': {'precision': 0.3203978477091146, 'recall': 0.12720093215950284, 'f1-score': 0.18210462907186875, 'support': 15448}, 'accuracy': 0.34947275922671356, 'macro avg': {'precision': 0.3431006576246616, 'recall': 0.3516854071066529, 'f1-score': 0.32763321272153345, 'support': 45520}, 'weighted avg': {'precision': 0.3429088176781532, 'recall': 0.34947275922671356, 'f1-score': 0.32625665700456347, 'support': 45520}}
[[7708 5297 1951]
 [6664 6235 2217]
 [7615 5868 1965]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
1733/1733 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1413134
{'0': {'precision': 0.3330898975518293, 'recall': 0.6095564882458498, 'f1-score': 0.43078106760055185, 'support': 133187}, '1': {'precision': 0.4397848768023025, 'recall': 0.2744348566922063, 'f1-score': 0.337969658301432, 'support': 173717}, '2': {'precision': 0.3829014183155314, 'recall': 0.25611970016397284, 'f1-score': 0.3069338199171872, 'support': 136608}, 'accuracy': 0.36943081585165677, 'macro avg': {'precision': 0.38525873088988777, 'recall': 0.3800370150340096, 'f1-score': 0.358561515273057, 'support': 443512}, 'weighted avg': {'precision': 0.3902233774552869, 'recall': 0.36943081585165677, 'f1-score': 0.3562815176430664, 'support': 443512}}
[[81185 28424 23578]
 [93233 47674 32810]
 [69315 32305 34988]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1313207
{'0': {'precision': 0.37098646034816246, 'recall': 0.4889682024659312, 'f1-score': 0.42188406086904356, 'support': 64722}, '1': {'precision': 0.38105949188222743, 'recall': 0.40863407242477656, 'f1-score': 0.39436535649267324, 'support': 64674}, '2': {'precision': 0.4070307748449094, 'recall': 0.25209438283510127, 'f1-score': 0.3113526187972793, 'support': 66368}, 'accuracy': 0.3821233730410086, 'macro avg': {'precision': 0.3863589090250998, 'recall': 0.38323221924193634, 'f1-score': 0.375867345386332, 'support': 195764}, 'weighted avg': {'precision': 0.3865340191738619, 'recall': 0.3821233730410086, 'f1-score': 0.3753203646110174, 'support': 195764}}
[[31647 20476 12599]
 [26471 26428 11775]
 [27187 22450 16731]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1336962
{'0': {'precision': 0.3626192480359147, 'recall': 0.4868390073927579, 'f1-score': 0.4156465456592092, 'support': 21237}, '1': {'precision': 0.40078663854528873, 'recall': 0.31782840611156316, 'f1-score': 0.35451909744106896, 'support': 22122}, '2': {'precision': 0.4020789797996035, 'recall': 0.3513273093309612, 'f1-score': 0.3749937534356104, 'support': 21359}, 'accuracy': 0.38434438641490776, 'macro avg': {'precision': 0.38849495546026896, 'recall': 0.3853315742784274, 'f1-score': 0.3817197988452962, 'support': 64718}, 'weighted avg': {'precision': 0.38868864794921554, 'recall': 0.38434438641490776, 'f1-score': 0.38133515781370186, 'support': 64718}}
[[10339  4883  6015]
 [ 9947  7031  5144]
 [ 8226  5629  7504]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
4693/4693 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83499587
{'0': {'precision': 0.5352816406750103, 'recall': 0.5407149273503228, 'f1-score': 0.5379845662160799, 'support': 286099}, '1': {'precision': 0.6899305891114156, 'recall': 0.7737080163073794, 'f1-score': 0.7294216284195864, 'support': 627446}, '2': {'precision': 0.5767742492316101, 'recall': 0.41817922662151874, 'f1-score': 0.4848367593712213, 'support': 287647}, 'accuracy': 0.6330761443632659, 'macro avg': {'precision': 0.6006621596726787, 'recall': 0.5775340567597403, 'f1-score': 0.5840809846689625, 'support': 1201192}, 'weighted avg': {'precision': 0.6259991017254578, 'recall': 0.6330761443632659, 'f1-score': 0.6252550539781015, 'support': 1201192}}
[[154698  95356  36045]
 [ 89766 485460  52220]
 [ 44539 122820 120288]]
Evaluating performance on  train set...
1497/1497 - 28s - 28s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88795376
{'0': {'precision': 0.530094498686429, 'recall': 0.5469293632170887, 'f1-score': 0.5383803588140419, 'support': 98872}, '1': {'precision': 0.6518671146568371, 'recall': 0.6853320415616648, 'f1-score': 0.6681808292162617, 'support': 183727}, '2': {'precision': 0.5074677760349178, 'recall': 0.44401790154152165, 'f1-score': 0.4736272596113044, 'support': 100550}, 'accuracy': 0.5862888850029623, 'macro avg': {'precision': 0.563143129792728, 'recall': 0.558759768773425, 'f1-score': 0.560062815880536, 'support': 383149}, 'weighted avg': {'precision': 0.5825487670044611, 'recall': 0.5862888850029623, 'f1-score': 0.583628883280381, 'support': 383149}}
[[ 54076  29515  15281]
 [ 29762 125914  28051]
 [ 18174  37730  44646]]
Evaluating performance on  val set...
547/547 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88241065
{'0': {'precision': 0.539563503509278, 'recall': 0.48485197557885035, 'f1-score': 0.5107467350251035, 'support': 34724}, '1': {'precision': 0.6507990747555462, 'recall': 0.7123457145323244, 'f1-score': 0.680182964519718, 'support': 69514}, '2': {'precision': 0.5176080142584967, 'recall': 0.47321252984969797, 'f1-score': 0.4944156625621908, 'support': 35595}, 'accuracy': 0.5949811560933399, 'macro avg': {'precision': 0.569323530841107, 'recall': 0.5568034066536242, 'f1-score': 0.5617817873690041, 'support': 139833}, 'weighted avg': {'precision': 0.5892722550896025, 'recall': 0.5949811560933399, 'f1-score': 0.5908200048024184, 'support': 139833}}
[[16836 12862  5026]
 [ 9324 49518 10672]
 [ 5043 13708 16844]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
6677/6677 - 122s - 122s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9272831
{'0': {'precision': 0.48066369577655466, 'recall': 0.31397454388495266, 'f1-score': 0.3798361496113886, 'support': 379948}, '1': {'precision': 0.7063912701170406, 'recall': 0.6698140946105162, 'f1-score': 0.6876166031047066, 'support': 959090}, '2': {'precision': 0.37695043431604286, 'recall': 0.5616586720252371, 'f1-score': 0.45113024991322453, 'support': 370248}, 'accuracy': 0.5672889147866419, 'macro avg': {'precision': 0.5213351334032127, 'recall': 0.5151491035069019, 'f1-score': 0.5061943342097733, 'support': 1709286}, 'weighted avg': {'precision': 0.5848554060257377, 'recall': 0.5672889147866419, 'f1-score': 0.5679764919469957, 'support': 1709286}}
[[119294 136245 124409]
 [ 97368 642412 219310]
 [ 31524 130771 207953]]
Evaluating performance on  train set...
2262/2262 - 43s - 43s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0017
{'0': {'precision': 0.49628208203406093, 'recall': 0.38112626913866526, 'f1-score': 0.43114734003432215, 'support': 184574}, '1': {'precision': 0.48167679547918013, 'recall': 0.7559864859052962, 'f1-score': 0.5884333056226625, 'support': 209263}, '2': {'precision': 0.5084076538642074, 'recall': 0.29859564531125, 'f1-score': 0.37622723882757186, 'support': 184996}, 'accuracy': 0.4902709417051205, 'macro avg': {'precision': 0.49545551045914954, 'recall': 0.47856946678507045, 'f1-score': 0.4652692948281855, 'support': 578833}, 'weighted avg': {'precision': 0.49487724887139695, 'recall': 0.4902709417051205, 'f1-score': 0.47045770066349996, 'support': 578833}}
[[ 70346  81889  32339]
 [ 29990 158200  21073]
 [ 41410  88347  55239]]
Evaluating performance on  val set...
827/827 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99424404
{'0': {'precision': 0.538640817839928, 'recall': 0.3171370653360362, 'f1-score': 0.399222675879397, 'support': 64130}, '1': {'precision': 0.4832137432566909, 'recall': 0.7734093385866376, 'f1-score': 0.5948036877054993, 'support': 83503}, '2': {'precision': 0.4960278919188146, 'recall': 0.3115546448514805, 'f1-score': 0.38272197990123547, 'support': 63931}, 'accuracy': 0.4955379932313626, 'macro avg': {'precision': 0.5059608176718112, 'recall': 0.46736701625805144, 'f1-score': 0.4589161144953772, 'support': 211564}, 'weighted avg': {'precision': 0.5038872020263362, 'recall': 0.4955379932313626, 'f1-score': 0.4714310631094322, 'support': 211564}}
[[20338 33326 10466]
 [ 9150 64582  9771]
 [ 8270 35743 19918]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
5633/5633 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93322474
{'0': {'precision': 0.42270279227773633, 'recall': 0.5037636410829355, 'f1-score': 0.45968702171179066, 'support': 354444}, '1': {'precision': 0.6373206508350693, 'recall': 0.7418281684769067, 'f1-score': 0.6856147857594503, 'support': 718413}, '2': {'precision': 0.5133760186898543, 'recall': 0.25489664667445394, 'f1-score': 0.34065464397350126, 'support': 368977}, 'accuracy': 0.5586953837959154, 'macro avg': {'precision': 0.5244664872675533, 'recall': 0.5001628187447654, 'f1-score': 0.4953188171482474, 'support': 1441834}, 'weighted avg': {'precision': 0.5528430127758057, 'recall': 0.5586953837959154, 'f1-score': 0.5417971905051682, 'support': 1441834}}
[[178556 134831  41057]
 [137381 532939  48093]
 [106478 168448  94051]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0649374
{'0': {'precision': 0.46328086436680743, 'recall': 0.34191736018911306, 'f1-score': 0.39345285506011024, 'support': 123524}, '1': {'precision': 0.4189772990815, 'recall': 0.6338416599352149, 'f1-score': 0.5044842030067864, 'support': 122559}, '2': {'precision': 0.45982474690899194, 'recall': 0.3485541059581627, 'f1-score': 0.3965314109537717, 'support': 126012}, 'accuracy': 0.44031766081242696, 'macro avg': {'precision': 0.44736097011909975, 'recall': 0.4414377086941636, 'f1-score': 0.4314894896735561, 'support': 372095}, 'weighted avg': {'precision': 0.4475179196056678, 'recall': 0.44031766081242696, 'f1-score': 0.4310664375008008, 'support': 372095}}
[[42235 52847 28442]
 [21721 77683 23155]
 [27209 54881 43922]]
Evaluating performance on  val set...
557/557 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0753837
{'0': {'precision': 0.4733609417895863, 'recall': 0.22209850668063924, 'f1-score': 0.302340441340367, 'support': 45804}, '1': {'precision': 0.40945945945945944, 'recall': 0.7126592290400466, 'f1-score': 0.5200966095515859, 'support': 48044}, '2': {'precision': 0.4671581769436997, 'recall': 0.35881226448118936, 'f1-score': 0.4058791330375132, 'support': 48563}, 'accuracy': 0.4342150536124316, 'macro avg': {'precision': 0.44999285939758177, 'recall': 0.43119000006729175, 'f1-score': 0.4094387279764888, 'support': 142411}, 'weighted avg': {'precision': 0.4496878569416503, 'recall': 0.4342150536124316, 'f1-score': 0.4111103174765384, 'support': 142411}}
[[10173 24235 11396]
 [ 5326 34239  8479]
 [ 5992 25146 17425]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
11876/11876 - 211s - 211s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0976193
{'0': {'precision': 0.5430939863289389, 'recall': 0.25528556116214834, 'f1-score': 0.34731363923201963, 'support': 1199778}, '1': {'precision': 0.2598439613190855, 'recall': 0.639077973856424, 'f1-score': 0.3694660143902391, 'support': 608486}, '2': {'precision': 0.488362075125403, 'recall': 0.38836102102857795, 'f1-score': 0.43265837288727255, 'support': 1231895}, 'accuracy': 0.38602454674245656, 'macro avg': {'precision': 0.43043334092447577, 'recall': 0.42757485201571677, 'f1-score': 0.3831460088365104, 'support': 3040159}, 'weighted avg': {'precision': 0.4642238869459048, 'recall': 0.38602454674245656, 'f1-score': 0.38632974359260147, 'support': 3040159}}
[[306286 543327 350165]
 [ 68559 388870 151057]
 [189120 564355 478420]]
Evaluating performance on  train set...
2538/2538 - 45s - 45s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.058574
{'0': {'precision': 0.5122897800776197, 'recall': 0.23836787207646004, 'f1-score': 0.3253505094185197, 'support': 217630}, '1': {'precision': 0.4174973734153404, 'recall': 0.701838795062191, 'f1-score': 0.5235529088602552, 'support': 213455}, '2': {'precision': 0.46140209253367526, 'recall': 0.40015557792623774, 'f1-score': 0.42860188545620737, 'support': 218540}, 'accuracy': 0.4450829324610352, 'macro avg': {'precision': 0.4637297486755451, 'recall': 0.4467874150216296, 'f1-score': 0.4258351012449941, 'support': 649625}, 'weighted avg': {'precision': 0.46402361359703415, 'recall': 0.4450829324610352, 'f1-score': 0.4252109656696059, 'support': 649625}}
[[ 51876 105188  60566]
 [ 22129 149811  41515]
 [ 27258 103832  87450]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0451964
{'0': {'precision': 0.5011812627291242, 'recall': 0.2737141840185086, 'f1-score': 0.3540617536186009, 'support': 67428}, '1': {'precision': 0.444346873949762, 'recall': 0.6149402868631099, 'f1-score': 0.5159069310794057, 'support': 66652}, '2': {'precision': 0.45027297420864376, 'recall': 0.48282673895489675, 'f1-score': 0.46598199251311595, 'support': 69352}, 'accuracy': 0.45680128986590113, 'macro avg': {'precision': 0.46526703696251, 'recall': 0.4571604032788384, 'f1-score': 0.4453168924037075, 'support': 203432}, 'weighted avg': {'precision': 0.46520502837860706, 'recall': 0.45680128986590113, 'f1-score': 0.44524306814104564, 'support': 203432}}
[[18456 25409 23563]
 [ 8347 40987 17318]
 [10022 25845 33485]]
testing model on single stock: results/universal/W0/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
19053/19053 - 342s - 342s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0623038
{'0': {'precision': 0.3127972427006085, 'recall': 0.2529093565187935, 'f1-score': 0.27968331810667896, 'support': 1133584}, '1': {'precision': 0.5737163467066528, 'recall': 0.5577496180721636, 'f1-score': 0.5656203248145348, 'support': 2630078}, '2': {'precision': 0.3069849432344269, 'recall': 0.3869790418113305, 'f1-score': 0.34237148250721167, 'support': 1113789}, 'accuracy': 0.4479044484506354, 'macro avg': {'precision': 0.3978328442138961, 'recall': 0.3992126721340959, 'f1-score': 0.3958917084761418, 'support': 4877451}, 'weighted avg': {'precision': 0.45216592523906357, 'recall': 0.4479044484506354, 'f1-score': 0.44818486095512367, 'support': 4877451}}
[[ 286694  554071  292819]
 [ 482965 1466925  680188]
 [ 146890  535886  431013]]
Evaluating performance on  train set...
4812/4812 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1231611
{'0': {'precision': 0.39180109643158756, 'recall': 0.33714585545261283, 'f1-score': 0.36242449600004234, 'support': 405943}, '1': {'precision': 0.3521459054796538, 'recall': 0.5706044571054645, 'f1-score': 0.43551545762648214, 'support': 406497}, '2': {'precision': 0.4049624798999464, 'recall': 0.21615867324069923, 'f1-score': 0.2818649853569363, 'support': 419428}, 'accuracy': 0.3729896385002289, 'macro avg': {'precision': 0.38296982727039586, 'recall': 0.37463632859959217, 'f1-score': 0.35993497966115356, 'support': 1231868}, 'weighted avg': {'precision': 0.38319671397257293, 'recall': 0.3729896385002289, 'f1-score': 0.3591143541652404, 'support': 1231868}}
[[136862 201892  67189]
 [108520 231949  66028]
 [103933 224832  90663]]
Evaluating performance on  val set...
1767/1767 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1117766
{'0': {'precision': 0.37105839533610335, 'recall': 0.3255572432795224, 'f1-score': 0.3468218098617786, 'support': 141545}, '1': {'precision': 0.38986905582356995, 'recall': 0.5405056790359374, 'f1-score': 0.45299260794058327, 'support': 167458}, '2': {'precision': 0.39460107353171087, 'recall': 0.26421941517202874, 'f1-score': 0.31650887202959427, 'support': 143290}, 'accuracy': 0.38570793711156265, 'macro avg': {'precision': 0.3851761748971281, 'recall': 0.3767607791624961, 'f1-score': 0.3721077632773187, 'support': 452293}, 'weighted avg': {'precision': 0.38548140418779636, 'recall': 0.38570793711156265, 'f1-score': 0.37652735171784707, 'support': 452293}}
[[46081 68798 26666]
 [45527 90512 31419]
 [32580 72850 37860]]
training model: results/universal/W0/deepLOB_L2/h100
Epoch 1/50
8838/8838 - 414s - loss: 3.2252 - accuracy100: 0.4053 - val_loss: 3.3832 - val_accuracy100: 0.3518 - 414s/epoch - 47ms/step
Epoch 2/50
8838/8838 - 413s - loss: 3.1993 - accuracy100: 0.4193 - val_loss: 3.3920 - val_accuracy100: 0.3581 - 413s/epoch - 47ms/step
Epoch 3/50
8838/8838 - 412s - loss: 3.1885 - accuracy100: 0.4242 - val_loss: 3.3591 - val_accuracy100: 0.3624 - 412s/epoch - 47ms/step
Epoch 4/50
8838/8838 - 421s - loss: 3.1799 - accuracy100: 0.4274 - val_loss: 3.3650 - val_accuracy100: 0.3624 - 421s/epoch - 48ms/step
Epoch 5/50
8838/8838 - 424s - loss: 3.1732 - accuracy100: 0.4303 - val_loss: 3.3715 - val_accuracy100: 0.3629 - 424s/epoch - 48ms/step
Epoch 6/50
8838/8838 - 419s - loss: 3.1654 - accuracy100: 0.4334 - val_loss: 3.3694 - val_accuracy100: 0.3520 - 419s/epoch - 47ms/step
Epoch 7/50
8838/8838 - 424s - loss: 3.1591 - accuracy100: 0.4354 - val_loss: 3.3647 - val_accuracy100: 0.3555 - 424s/epoch - 48ms/step
Epoch 8/50
8838/8838 - 420s - loss: 3.1530 - accuracy100: 0.4374 - val_loss: 3.3694 - val_accuracy100: 0.3577 - 420s/epoch - 48ms/step
Epoch 9/50
8838/8838 - 421s - loss: 3.1482 - accuracy100: 0.4394 - val_loss: 3.3709 - val_accuracy100: 0.3589 - 421s/epoch - 48ms/step
Epoch 10/50
8838/8838 - 421s - loss: 3.1430 - accuracy100: 0.4411 - val_loss: 3.3743 - val_accuracy100: 0.3607 - 421s/epoch - 48ms/step
Epoch 11/50
8838/8838 - 419s - loss: 3.1382 - accuracy100: 0.4426 - val_loss: 3.3924 - val_accuracy100: 0.3584 - 419s/epoch - 47ms/step
Epoch 12/50
8838/8838 - 420s - loss: 3.1340 - accuracy100: 0.4441 - val_loss: 3.3812 - val_accuracy100: 0.3597 - 420s/epoch - 48ms/step
Epoch 13/50
8838/8838 - 423s - loss: 3.1302 - accuracy100: 0.4453 - val_loss: 3.3993 - val_accuracy100: 0.3588 - 423s/epoch - 48ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 599s - 599s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0743451
{'0': {'precision': 0.37559263329152703, 'recall': 0.16138357859647556, 'f1-score': 0.22576226623499954, 'support': 2397493}, '1': {'precision': 0.46798722590966546, 'recall': 0.7365720985661016, 'f1-score': 0.5723360005376726, 'support': 3641820}, '2': {'precision': 0.3473241310139031, 'recall': 0.24315064513826526, 'f1-score': 0.28604807500313667, 'support': 2409716}, 'accuracy': 0.43262995073161664, 'macro avg': {'precision': 0.3969679967383652, 'recall': 0.3803687741002808, 'f1-score': 0.3613821139252696, 'support': 8449029}, 'weighted avg': {'precision': 0.40735550368221485, 'recall': 0.43262995073161664, 'f1-score': 0.3923412701678398, 'support': 8449029}}
[[ 386916 1509826  500751]
 [ 359066 2682463  600291]
 [ 284166 1539626  585924]]
Evaluating performance on  train set...
8838/8838 - 157s - 157s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.121969
{'0': {'precision': 0.3914774541288711, 'recall': 0.25009098216749515, 'f1-score': 0.305205105053808, 'support': 750147}, '1': {'precision': 0.35411877659918206, 'recall': 0.718232701836979, 'f1-score': 0.4743588101523327, 'support': 747695}, '2': {'precision': 0.4046591954346643, 'recall': 0.14103476702039963, 'f1-score': 0.20916857901095012, 'support': 764230}, 'accuracy': 0.3679843081917817, 'macro avg': {'precision': 0.38341847538757245, 'recall': 0.3697861503416246, 'f1-score': 0.3295774980723636, 'support': 2262072}, 'weighted avg': {'precision': 0.3835824736696132, 'recall': 0.3679843081917817, 'f1-score': 0.32867092985333174, 'support': 2262072}}
[[187605 476450  86092]
 [138196 537019  72480]
 [153422 503025 107783]]
Evaluating performance on  val set...
3279/3279 - 56s - 56s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1205987
{'0': {'precision': 0.38628541577038905, 'recall': 0.18164609321094025, 'f1-score': 0.24709753035153978, 'support': 276813}, '1': {'precision': 0.3527040862146385, 'recall': 0.7005012039596896, 'f1-score': 0.46917659707911474, 'support': 280325}, '2': {'precision': 0.37966161925256153, 'recall': 0.20477463184010733, 'f1-score': 0.2660514920520731, 'support': 281739}, 'accuracy': 0.36279812177470594, 'macro avg': {'precision': 0.3728837070791964, 'recall': 0.36230730967024577, 'f1-score': 0.3274418731609092, 'support': 838877}, 'weighted avg': {'precision': 0.37283902492303955, 'recall': 0.36279812177470594, 'f1-score': 0.32767475990480444, 'support': 838877}}
[[ 50282 176943  49588]
 [ 39279 196368  44678]
 [ 40607 183439  57693]]
testing model out of sample: results/universal/W0/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 387s - 387s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1213874
{'0': {'precision': 0.39299290402196185, 'recall': 0.20753593001030166, 'f1-score': 0.27162774941549345, 'support': 1947258}, '1': {'precision': 0.33789839777682484, 'recall': 0.6315260009596639, 'f1-score': 0.440243971900857, 'support': 1921506}, '2': {'precision': 0.34385935416450325, 'recall': 0.21241737726167256, 'f1-score': 0.26260923037802747, 'support': 1964199}, 'accuracy': 0.3488513470769487, 'macro avg': {'precision': 0.35825021865443, 'recall': 0.3504931027438794, 'f1-score': 0.324826983898126, 'support': 5832963}, 'weighted avg': {'precision': 0.3582982738976942, 'recall': 0.3488513470769487, 'f1-score': 0.32413672592161724, 'support': 5832963}}
[[ 404126 1194552  348580]
 [ 260461 1213481  447564]
 [ 363742 1183227  417230]]
Evaluating performance on  train set...
6334/6334 - 112s - 112s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198484
{'0': {'precision': 0.3937753575617998, 'recall': 0.20015681412056452, 'f1-score': 0.26540680840878017, 'support': 548420}, '1': {'precision': 0.35312217161341725, 'recall': 0.7297027637094785, 'f1-score': 0.47592960994487166, 'support': 527190}, '2': {'precision': 0.3979425089520644, 'recall': 0.18444130646078233, 'f1-score': 0.25205726637636666, 'support': 545290}, 'accuracy': 0.36710222715775187, 'macro avg': {'precision': 0.3816133460424272, 'recall': 0.37143362809694175, 'f1-score': 0.33113122824333946, 'support': 1620900}, 'weighted avg': {'precision': 0.38195498177147935, 'recall': 0.36710222715775187, 'f1-score': 0.3293874018858345, 'support': 1620900}}
[[109770 351891  86759]
 [ 77096 384692  65402]
 [ 91897 352819 100574]]
Evaluating performance on  val set...
2156/2156 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1104981
{'0': {'precision': 0.38361688869031524, 'recall': 0.18062291016187249, 'f1-score': 0.2456047905994648, 'support': 180636}, '1': {'precision': 0.37240998952701415, 'recall': 0.6710399729355422, 'f1-score': 0.47899180273745173, 'support': 189178}, '2': {'precision': 0.38248193808711184, 'recall': 0.26424116882258314, 'f1-score': 0.3125525384630422, 'support': 181516}, 'accuracy': 0.3764297244844286, 'macro avg': {'precision': 0.37950293876814706, 'recall': 0.37196801730666595, 'f1-score': 0.34571637726665294, 'support': 551330}, 'weighted avg': {'precision': 0.37939779946316265, 'recall': 0.3764297244844286, 'f1-score': 0.3477283383538863, 'support': 551330}}
[[ 32627 105690  42319]
 [ 27113 126946  35119]
 [ 25311 108241  47964]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
876/876 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0820954
{'0': {'precision': 0.3183957946491618, 'recall': 0.42638251672328653, 'f1-score': 0.36456056295852673, 'support': 57106}, '1': {'precision': 0.5205011270115847, 'recall': 0.45483528161530284, 'f1-score': 0.4854576833006585, 'support': 109156}, '2': {'precision': 0.2811687318341747, 'recall': 0.2539858013922236, 'f1-score': 0.26688689433609525, 'support': 57893}, 'accuracy': 0.3957127880261426, 'macro avg': {'precision': 0.3733552178316404, 'recall': 0.378401199910271, 'f1-score': 0.3723017135317601, 'support': 224155}, 'weighted avg': {'precision': 0.40719962820988803, 'recall': 0.3957127880261426, 'f1-score': 0.3982070324573436, 'support': 224155}}
[[24349 21384 11373]
 [33289 49648 26219]
 [18836 24353 14704]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1455343
{'0': {'precision': 0.35611322238238763, 'recall': 0.1880037358608046, 'f1-score': 0.24608906295986058, 'support': 28909}, '1': {'precision': 0.2903756892926568, 'recall': 0.5889760611546973, 'f1-score': 0.38897819819580437, 'support': 24855}, '2': {'precision': 0.3549382716049383, 'recall': 0.200990387416254, 'f1-score': 0.2566486888599591, 'support': 27464}, 'accuracy': 0.3150883931649185, 'macro avg': {'precision': 0.3338090610933276, 'recall': 0.32599006147725196, 'f1-score': 0.297238650005208, 'support': 81228}, 'weighted avg': {'precision': 0.33560089617594246, 'recall': 0.3150883931649185, 'f1-score': 0.2933821025768607, 'support': 81228}}
[[ 5435 18359  5115]
 [ 5299 14639  4917]
 [ 4528 17416  5520]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1009803
{'0': {'precision': 0.3106909657928077, 'recall': 0.4157537819509651, 'f1-score': 0.3556249651402755, 'support': 7668}, '1': {'precision': 0.42315562735595047, 'recall': 0.35281968390804597, 'f1-score': 0.38479996082464124, 'support': 11136}, '2': {'precision': 0.3307902691809414, 'recall': 0.29886851346078813, 'f1-score': 0.31402022410494673, 'support': 7689}, 'accuracy': 0.35537689200920997, 'macro avg': {'precision': 0.35487895410989984, 'recall': 0.3558139931065997, 'f1-score': 0.3514817166899545, 'support': 26493}, 'weighted avg': {'precision': 0.3637974473131534, 'recall': 0.35537689200920997, 'f1-score': 0.355813463918083, 'support': 26493}}
[[3188 2688 1792]
 [4350 3929 2857]
 [2723 2668 2298]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
2359/2359 - 43s - 43s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0866679
{'0': {'precision': 0.3671579968194351, 'recall': 0.5131667365446578, 'f1-score': 0.42805402116579555, 'support': 174113}, '1': {'precision': 0.4701555547825427, 'recall': 0.6316259033150228, 'f1-score': 0.5390586759389854, 'support': 235383}, '2': {'precision': 0.4620465032117977, 'recall': 0.10514071603565767, 'f1-score': 0.17130111025391606, 'support': 194292}, 'accuracy': 0.42804924907417835, 'macro avg': {'precision': 0.4331200182712585, 'recall': 0.41664445196511274, 'f1-score': 0.3794712691195657, 'support': 603788}, 'weighted avg': {'precision': 0.43784497945243717, 'recall': 0.42804924907417835, 'f1-score': 0.3887083768131202, 'support': 603788}}
[[ 89349  73207  11557]
 [ 74482 148674  12227]
 [ 79522  94342  20428]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987152
{'0': {'precision': 0.4062227852109888, 'recall': 0.30843986694986575, 'f1-score': 0.3506418068542922, 'support': 49906}, '1': {'precision': 0.3797355636462008, 'recall': 0.6524197765168387, 'f1-score': 0.480057568719096, 'support': 51637}, '2': {'precision': 0.39962647852251504, 'recall': 0.19586265815060414, 'f1-score': 0.2628827279304367, 'support': 49162}, 'accuracy': 0.38957566105968616, 'macro avg': {'precision': 0.39519494245990155, 'recall': 0.3855741005391029, 'f1-score': 0.3645273678346083, 'support': 150705}, 'weighted avg': {'precision': 0.394995498197554, 'recall': 0.38957566105968616, 'f1-score': 0.3663561484976238, 'support': 150705}}
[[15393 26728  7785]
 [11267 33689  6681]
 [11233 28300  9629]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1206019
{'0': {'precision': 0.4264886930603253, 'recall': 0.3332826978581194, 'f1-score': 0.3741686089477574, 'support': 19749}, '1': {'precision': 0.33878448938482336, 'recall': 0.6970986038394416, 'f1-score': 0.45597074823865164, 'support': 18336}, '2': {'precision': 0.41127606928243193, 'recall': 0.1122257053291536, 'f1-score': 0.17633463418330617, 'support': 20735}, 'accuracy': 0.36876912614756885, 'macro avg': {'precision': 0.39218308390919354, 'recall': 0.38086900234223814, 'f1-score': 0.3354913304565717, 'support': 58820}, 'weighted avg': {'precision': 0.3937859043383154, 'recall': 0.36876912614756885, 'f1-score': 0.3299291760898339, 'support': 58820}}
[[ 6582 11480  1687]
 [ 3910 12782  1644]
 [ 4941 13467  2327]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
1625/1625 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1199384
{'0': {'precision': 0.3757472377176402, 'recall': 0.357724409852015, 'f1-score': 0.3665143957818841, 'support': 136703}, '1': {'precision': 0.3514573448242471, 'recall': 0.632349204736013, 'f1-score': 0.4518038075627397, 'support': 137753}, '2': {'precision': 0.41873365559870035, 'recall': 0.11211146080130131, 'f1-score': 0.17686831946087073, 'support': 141395}, 'accuracy': 0.3651836835789742, 'macro avg': {'precision': 0.38197941271352925, 'recall': 0.36739502512977645, 'f1-score': 0.33172884093516486, 'support': 415851}, 'weighted avg': {'precision': 0.3823170402203369, 'recall': 0.3651836835789742, 'f1-score': 0.33028474953752857, 'support': 415851}}
[[48902 76866 10935]
 [39575 87108 11070]
 [41669 83874 15852]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1182424
{'0': {'precision': 0.3676696789079023, 'recall': 0.40192317797278126, 'f1-score': 0.3840341408309276, 'support': 38062}, '1': {'precision': 0.3675124471743631, 'recall': 0.5637795275590551, 'f1-score': 0.44496462862647207, 'support': 38100}, '2': {'precision': 0.4052614485222475, 'recall': 0.1588016697210344, 'f1-score': 0.22818791946308722, 'support': 39288}, 'accuracy': 0.3726028583802512, 'macro avg': {'precision': 0.3801478582015043, 'recall': 0.3748347917509569, 'f1-score': 0.3523955629734956, 'support': 115450}, 'weighted avg': {'precision': 0.3804103884406918, 'recall': 0.3726028583802512, 'f1-score': 0.35110703160538, 'support': 115450}}
[[15298 17751  5013]
 [12477 21480  4143]
 [13833 19216  6239]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1258503
{'0': {'precision': 0.37422729434141705, 'recall': 0.31010704669337363, 'f1-score': 0.33916322499551094, 'support': 15227}, '1': {'precision': 0.36393219312850006, 'recall': 0.6432584269662921, 'f1-score': 0.46486225229579503, 'support': 14952}, '2': {'precision': 0.3926279414184631, 'recall': 0.1596627408993576, 'f1-score': 0.22701108415394136, 'support': 14944}, 'accuracy': 0.37067570861866456, 'macro avg': {'precision': 0.3769291429627934, 'recall': 0.37100940485300776, 'f1-score': 0.3436788538150825, 'support': 45123}, 'weighted avg': {'precision': 0.3769098933836758, 'recall': 0.37067570861866456, 'f1-score': 0.3436720179272183, 'support': 45123}}
[[4722 8474 2031]
 [3674 9618 1660]
 [4222 8336 2386]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1277478
{'0': {'precision': 0.3578994996273821, 'recall': 0.13075524353127643, 'f1-score': 0.19153497183309237, 'support': 102841}, '1': {'precision': 0.35431651929567354, 'recall': 0.5922449882577175, 'f1-score': 0.4433778072217781, 'support': 117524}, '2': {'precision': 0.3127637770113169, 'recall': 0.271870420214753, 'f1-score': 0.29088691659663435, 'support': 104399}, 'accuracy': 0.3431199270855144, 'macro avg': {'precision': 0.34165993197812417, 'recall': 0.33162355066791566, 'f1-score': 0.30859989855050163, 'support': 324764}, 'weighted avg': {'precision': 0.3420935282577158, 'recall': 0.3431199270855144, 'f1-score': 0.3146084069046795, 'support': 324764}}
[[13447 63040 26354]
 [11909 69603 36012]
 [12216 63800 28383]]
Evaluating performance on  train set...
486/486 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1349276
{'0': {'precision': 0.3859280941072513, 'recall': 0.1702812027876602, 'f1-score': 0.23630061712739878, 'support': 41038}, '1': {'precision': 0.3461064839691922, 'recall': 0.7526046738072054, 'f1-score': 0.474158027114901, 'support': 41080}, '2': {'precision': 0.3829964328180737, 'recall': 0.1528822649927617, 'f1-score': 0.21853215055040112, 'support': 42137}, 'accuracy': 0.3569031427306748, 'macro avg': {'precision': 0.37167700363150574, 'recall': 0.35858938052920913, 'f1-score': 0.3096635982642336, 'support': 124255}, 'weighted avg': {'precision': 0.37176847754281894, 'recall': 0.3569031427306748, 'f1-score': 0.3089131681404899, 'support': 124255}}
[[ 6988 29025  5025]
 [ 4810 30917  5353]
 [ 6309 29386  6442]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1315768
{'0': {'precision': 0.35502299010728716, 'recall': 0.17348675699598284, 'f1-score': 0.23307720453713865, 'support': 14687}, '1': {'precision': 0.33790373472548907, 'recall': 0.7699346405228759, 'f1-score': 0.4696782424943184, 'support': 15300}, '2': {'precision': 0.34386670496983623, 'recall': 0.07706173952230734, 'f1-score': 0.1259072262543389, 'support': 15533}, 'accuracy': 0.34105887521968364, 'macro avg': {'precision': 0.34559780993420414, 'recall': 0.3401610456803887, 'f1-score': 0.2762208910952653, 'support': 45520}, 'weighted avg': {'precision': 0.34546202384231495, 'recall': 0.34105887521968364, 'f1-score': 0.276032490303354, 'support': 45520}}
[[ 2548 11071  1068]
 [ 2304 11780  1216]
 [ 2325 12011  1197]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
1733/1733 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.127041
{'0': {'precision': 0.3588406840081505, 'recall': 0.5976377129716735, 'f1-score': 0.4484298367615841, 'support': 143505}, '1': {'precision': 0.38602674346364435, 'recall': 0.4400270032364173, 'f1-score': 0.4112618380438077, 'support': 151093}, '2': {'precision': 0.3837360594795539, 'recall': 0.08318223941335268, 'f1-score': 0.13672638166826717, 'support': 148914}, 'accuracy': 0.3712097981565324, 'macro avg': {'precision': 0.3762011623171162, 'recall': 0.3736156518738145, 'f1-score': 0.3321393521578863, 'support': 443512}, 'weighted avg': {'precision': 0.37646116152455933, 'recall': 0.3712097981565324, 'f1-score': 0.33110982570882525, 'support': 443512}}
[[85764 48514  9227]
 [73942 66485 10666]
 [79297 57230 12387]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1200085
{'0': {'precision': 0.3710700171061169, 'recall': 0.39140443932865654, 'f1-score': 0.38096607898501905, 'support': 64289}, '1': {'precision': 0.3779921435067825, 'recall': 0.6048740458606221, 'f1-score': 0.46524672355172353, 'support': 64587}, '2': {'precision': 0.3873079112122937, 'recall': 0.14243212534385838, 'f1-score': 0.20827230395907567, 'support': 66888}, 'accuracy': 0.3767648801618275, 'macro avg': {'precision': 0.37879002394173106, 'recall': 0.3795702035110457, 'f1-score': 0.3514950354986061, 'support': 195764}, 'weighted avg': {'precision': 0.37890189446259587, 'recall': 0.3767648801618275, 'f1-score': 0.3497667408365057, 'support': 195764}}
[[25163 30879  8247]
 [18696 39067  6824]
 [23953 33408  9527]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1083103
{'0': {'precision': 0.3791908086960828, 'recall': 0.3580714552936775, 'f1-score': 0.36832864324025294, 'support': 21384}, '1': {'precision': 0.3838383838383838, 'recall': 0.5716245256275433, 'f1-score': 0.4592777634914221, 'support': 21871}, '2': {'precision': 0.4048017400033462, 'recall': 0.2254577645249965, 'f1-score': 0.2896130711913098, 'support': 21463}, 'accuracy': 0.3862603912358231, 'macro avg': {'precision': 0.3892769775126042, 'recall': 0.38505124848207245, 'f1-score': 0.37240649264099496, 'support': 64718}, 'weighted avg': {'precision': 0.38925500311780564, 'recall': 0.3862603912358231, 'f1-score': 0.3729591306800201, 'support': 64718}}
[[ 7657  9605  4122]
 [ 6376 12502  2993]
 [ 6160 10464  4839]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
4693/4693 - 80s - 80s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0653325
{'0': {'precision': 0.43837615283267456, 'recall': 0.3503943848859496, 'f1-score': 0.38947839726556555, 'support': 379832}, '1': {'precision': 0.4287337769722307, 'recall': 0.7380507191090563, 'f1-score': 0.5423919729194824, 'support': 439085}, '2': {'precision': 0.47409012009426904, 'recall': 0.17576090510757963, 'f1-score': 0.25644803309942615, 'support': 382275}, 'accuracy': 0.43652222126021484, 'macro avg': {'precision': 0.44706668329972477, 'recall': 0.42140200303419517, 'f1-score': 0.396106134428158, 'support': 1201192}, 'weighted avg': {'precision': 0.4462173091426092, 'recall': 0.43652222126021484, 'f1-score': 0.403038156991229, 'support': 1201192}}
[[133091 202973  43768]
 [ 84253 324067  30765]
 [ 86256 228830  67189]]
Evaluating performance on  train set...
1497/1497 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0832903
{'0': {'precision': 0.46512764747548313, 'recall': 0.3651636551610705, 'f1-score': 0.40912800442272085, 'support': 127677}, '1': {'precision': 0.38933347198653806, 'recall': 0.6531775863983125, 'f1-score': 0.4878680096309613, 'support': 126102}, '2': {'precision': 0.44916121256289154, 'recall': 0.24773131328747006, 'f1-score': 0.3193356017994949, 'support': 129370}, 'accuracy': 0.4203038504602648, 'macro avg': {'precision': 0.4345407773416376, 'recall': 0.42202418494895105, 'f1-score': 0.40544387195105897, 'support': 383149}, 'weighted avg': {'precision': 0.43479121229713497, 'recall': 0.4203038504602648, 'f1-score': 0.4047245713181135, 'support': 383149}}
[[46623 60005 21049]
 [25480 82367 18255]
 [28134 69187 32049]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0952458
{'0': {'precision': 0.41082851440560875, 'recall': 0.3481277509160686, 'f1-score': 0.3768881377416288, 'support': 46121}, '1': {'precision': 0.3836429826763746, 'recall': 0.6487295421257084, 'f1-score': 0.4821525767340596, 'support': 47109}, '2': {'precision': 0.429235218813712, 'recall': 0.19425788039396605, 'f1-score': 0.2674683132921677, 'support': 46603}, 'accuracy': 0.3981177547503093, 'macro avg': {'precision': 0.40790223863189845, 'recall': 0.3970383911452477, 'f1-score': 0.375503009255952, 'support': 139833}, 'weighted avg': {'precision': 0.4078043672536371, 'recall': 0.3981177547503093, 'f1-score': 0.37588415711957385, 'support': 139833}}
[[16056 23290  6775]
 [11285 30561  5263]
 [11741 25809  9053]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
6677/6677 - 114s - 114s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0553662
{'0': {'precision': 0.4741416998842741, 'recall': 0.04102982935578917, 'f1-score': 0.07552417760900867, 'support': 449356}, '1': {'precision': 0.5367946069740456, 'recall': 0.5716775993911499, 'f1-score': 0.553687229177014, 'support': 827790}, '2': {'precision': 0.30522376517777233, 'recall': 0.557148146434026, 'f1-score': 0.3943886685700901, 'support': 432140}, 'accuracy': 0.4285017252817843, 'macro avg': {'precision': 0.43872002401203064, 'recall': 0.38995185839365504, 'f1-score': 0.34120002511870423, 'support': 1709286}, 'weighted avg': {'precision': 0.4617782063880273, 'recall': 0.4285017252817843, 'f1-score': 0.3877087351268265, 'support': 1709286}}
[[ 18437 225737 205182]
 [ 11691 473229 342870]
 [  8757 182617 240766]]
Evaluating performance on  train set...
2262/2262 - 41s - 41s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1125897
{'0': {'precision': 0.4087884237443754, 'recall': 0.2766861145921072, 'f1-score': 0.3300081165102069, 'support': 194708}, '1': {'precision': 0.3666689222953277, 'recall': 0.7378507046826964, 'f1-score': 0.48989065670307963, 'support': 190937}, '2': {'precision': 0.4149024227181561, 'recall': 0.13492038842992318, 'f1-score': 0.20362485840396857, 'support': 193188}, 'accuracy': 0.38149345320671074, 'macro avg': {'precision': 0.3967865895859531, 'recall': 0.3831524025682423, 'f1-score': 0.34117454387241836, 'support': 578833}, 'weighted avg': {'precision': 0.3969352294475228, 'recall': 0.38149345320671074, 'f1-score': 0.34056688511838673, 'support': 578833}}
[[ 53873 119496  21339]
 [ 34636 140883  15418]
 [ 43278 123845  26065]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1061288
{'0': {'precision': 0.39414579622061546, 'recall': 0.16689345086671006, 'f1-score': 0.2344946540455731, 'support': 67612}, '1': {'precision': 0.38056488248074266, 'recall': 0.7623946504174416, 'f1-score': 0.5077006178938909, 'support': 75819}, '2': {'precision': 0.3967144467708166, 'recall': 0.18076409375779726, 'f1-score': 0.24836153179132472, 'support': 68133}, 'accuracy': 0.38477245656160786, 'macro avg': {'precision': 0.3904750418240582, 'recall': 0.3700173983473163, 'f1-score': 0.33018560124359625, 'support': 211564}, 'weighted avg': {'precision': 0.39010597171877887, 'recall': 0.38477245656160786, 'f1-score': 0.3368702706649738, 'support': 211564}}
[[11284 46299 10029]
 [ 9315 57804  8700]
 [ 8030 47787 12316]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
5633/5633 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0542084
{'0': {'precision': 0.33300521162652563, 'recall': 0.38510051350797403, 'f1-score': 0.3571632240480674, 'support': 361046}, '1': {'precision': 0.5255640254447724, 'recall': 0.7268811983692354, 'f1-score': 0.6100428208296431, 'support': 700285}, '2': {'precision': 0.4371515140649372, 'recall': 0.0640809665101195, 'f1-score': 0.11177684056110757, 'support': 380503}, 'accuracy': 0.46638239908338963, 'macro avg': {'precision': 0.43190691704541173, 'recall': 0.39202089279577623, 'f1-score': 0.35966096181293933, 'support': 1441834}, 'weighted avg': {'precision': 0.45401361443255867, 'recall': 0.46638239908338963, 'f1-score': 0.4152264500201606, 'support': 1441834}}
[[139039 203481  18526]
 [178393 509024  12868]
 [100096 256024  24383]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.119363
{'0': {'precision': 0.35460822444609535, 'recall': 0.13162526257735388, 'f1-score': 0.19198760225478076, 'support': 123297}, '1': {'precision': 0.3401146230400722, 'recall': 0.7240657990053638, 'f1-score': 0.462826342569951, 'support': 122859}, '2': {'precision': 0.3999011979745585, 'recall': 0.20568688015626613, 'f1-score': 0.27165141703589124, 'support': 125939}, 'accuracy': 0.35230519087867346, 'macro avg': {'precision': 0.36487468182024196, 'recall': 0.353792647246328, 'f1-score': 0.3088217872868743, 'support': 372095}, 'weighted avg': {'precision': 0.365152527428018, 'recall': 0.35230519087867346, 'f1-score': 0.30837658347221114, 'support': 372095}}
[[16229 85904 21164]
 [16193 88958 17708]
 [13344 86691 25904]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1450772
{'0': {'precision': 0.40289648622981955, 'recall': 0.034560710358030225, 'f1-score': 0.0636605769591477, 'support': 49102}, '1': {'precision': 0.3008548167100147, 'recall': 0.8422750343911579, 'f1-score': 0.443348585197161, 'support': 42162}, '2': {'precision': 0.4015474655292134, 'recall': 0.15828885369620896, 'f1-score': 0.2270681120195207, 'support': 51147}, 'accuracy': 0.3181285153534488, 'macro avg': {'precision': 0.3684329228230159, 'recall': 0.3450415328151324, 'f1-score': 0.2446924247252765, 'support': 142411}, 'weighted avg': {'precision': 0.37220167169956614, 'recall': 0.3181285153534488, 'f1-score': 0.23475839243031227, 'support': 142411}}
[[ 1697 40530  6875]
 [ 1459 35512  5191]
 [ 1056 41995  8096]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
11876/11876 - 202s - 202s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1607887
{'0': {'precision': 0.4164732029883262, 'recall': 0.19568701382402712, 'f1-score': 0.2662649260511985, 'support': 1160588}, '1': {'precision': 0.24478264815236223, 'recall': 0.7715325550441704, 'f1-score': 0.371651986244959, 'support': 695714}, '2': {'precision': 0.4412138670904937, 'recall': 0.11255666858412798, 'f1-score': 0.17935791023018885, 'support': 1183857}, 'accuracy': 0.2950927895547568, 'macro avg': {'precision': 0.3674899060770607, 'recall': 0.3599254124841085, 'f1-score': 0.27242494084211544, 'support': 3040159}, 'weighted avg': {'precision': 0.3868174796247955, 'recall': 0.2950927895547568, 'f1-score': 0.2565397025240175, 'support': 3040159}}
[[227112 821501 111975]
 [102164 536766  56784]
 [216046 834560 133251]]
Evaluating performance on  train set...
2538/2538 - 45s - 45s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1232517
{'0': {'precision': 0.4480335180429788, 'recall': 0.044706273712980776, 'f1-score': 0.08130014837583639, 'support': 222452}, '1': {'precision': 0.3417644493575246, 'recall': 0.8073125038929428, 'f1-score': 0.48023017531059126, 'support': 208711}, '2': {'precision': 0.39653902524309403, 'recall': 0.24397835779220184, 'f1-score': 0.30208997520368397, 'support': 218462}, 'accuracy': 0.356728882047335, 'macro avg': {'precision': 0.3954456642145325, 'recall': 0.36533237846604183, 'f1-score': 0.28787343296337053, 'support': 649625}, 'weighted avg': {'precision': 0.3965744247499894, 'recall': 0.356728882047335, 'f1-score': 0.28371734598991355, 'support': 649625}}
[[  9945 165404  47103]
 [  6206 168495  34010]
 [  6046 159116  53300]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.113936
{'0': {'precision': 0.4277400581959263, 'recall': 0.08339515601134628, 'f1-score': 0.1395773482008083, 'support': 68745}, '1': {'precision': 0.35632728754501075, 'recall': 0.6551681957186545, 'f1-score': 0.46160227095217327, 'support': 65400}, '2': {'precision': 0.37560905703640013, 'recall': 0.378281640134513, 'f1-score': 0.3769406113599919, 'support': 69287}, 'accuracy': 0.3676461913563255, 'macro avg': {'precision': 0.38655880092577904, 'recall': 0.3722816639548379, 'f1-score': 0.32604007683765784, 'support': 203432}, 'weighted avg': {'precision': 0.3870267196950515, 'recall': 0.3676461913563255, 'f1-score': 0.32394666257833804, 'support': 203432}}
[[ 5733 38475 24537]
 [ 3519 42848 19033]
 [ 4151 38926 26210]]
testing model on single stock: results/universal/W0/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
19053/19053 - 343s - 343s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0774368
{'0': {'precision': 0.44159396205511703, 'recall': 0.009245024683599811, 'f1-score': 0.018110887476083474, 'support': 1379661}, '1': {'precision': 0.466776300443868, 'recall': 0.7587394157734924, 'f1-score': 0.5779796583740876, 'support': 2149543}, '2': {'precision': 0.3288768632199098, 'recall': 0.3304045920369191, 'f1-score': 0.3296389575533427, 'support': 1348247}, 'accuracy': 0.42833131486097964, 'macro avg': {'precision': 0.41241570857296495, 'recall': 0.3661296774980037, 'f1-score': 0.3085765011345046, 'support': 4877451}, 'weighted avg': {'precision': 0.4215343097600759, 'recall': 0.42833131486097964, 'f1-score': 0.35096482763865267, 'support': 4877451}}
[[  12755  966305  400601]
 [  10158 1630943  508442]
 [   5971  896809  445467]]
Evaluating performance on  train set...
4812/4812 - 89s - 89s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1364183
{'0': {'precision': 0.36905496886000544, 'recall': 0.25039622368817505, 'f1-score': 0.2983607801472263, 'support': 408229}, '1': {'precision': 0.34767741577860617, 'recall': 0.7415083604873688, 'f1-score': 0.4733916218338943, 'support': 406017}, '2': {'precision': 0.3795258596463619, 'recall': 0.0808458366656929, 'f1-score': 0.13329701154598556, 'support': 417622}, 'accuracy': 0.35478395412495495, 'macro avg': {'precision': 0.3654194147616578, 'recall': 0.35758347361374554, 'f1-score': 0.3016831378423687, 'support': 1231868}, 'weighted avg': {'precision': 0.36555883484445284, 'recall': 0.35478395412495495, 'f1-score': 0.30009086492766424, 'support': 1231868}}
[[102219 274961  31049]
 [ 80803 301065  24149]
 [ 93953 289906  33763]]
Evaluating performance on  val set...
1767/1767 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198251
{'0': {'precision': 0.36040711992269087, 'recall': 0.15713470242059338, 'f1-score': 0.21885174528659043, 'support': 147154}, '1': {'precision': 0.3680831592698415, 'recall': 0.6694278926171086, 'f1-score': 0.47499278811481316, 'support': 157418}, '2': {'precision': 0.365019982129005, 'recall': 0.2516500700645135, 'f1-score': 0.29791394523204656, 'support': 147721}, 'accuracy': 0.3663045857441968, 'macro avg': {'precision': 0.3645034204405124, 'recall': 0.3594042217007385, 'f1-score': 0.3305861595444834, 'support': 452293}, 'weighted avg': {'precision': 0.36458530393157157, 'recall': 0.3663045857441968, 'f1-score': 0.33382225758299094, 'support': 452293}}
[[ 23123  90894  33137]
 [ 20508 105380  31530]
 [ 20527  90020  37174]]
training model: results/universal/W0/deepLOB_L2/h200
Epoch 1/50
8838/8838 - 414s - loss: 3.2434 - accuracy200: 0.3993 - val_loss: 3.3538 - val_accuracy200: 0.3295 - 414s/epoch - 47ms/step
Epoch 2/50
8838/8838 - 409s - loss: 3.2235 - accuracy200: 0.4108 - val_loss: 3.4312 - val_accuracy200: 0.3337 - 409s/epoch - 46ms/step
Epoch 3/50
8838/8838 - 417s - loss: 3.2140 - accuracy200: 0.4157 - val_loss: 3.4626 - val_accuracy200: 0.3301 - 417s/epoch - 47ms/step
Epoch 4/50
8838/8838 - 424s - loss: 3.2074 - accuracy200: 0.4191 - val_loss: 3.4276 - val_accuracy200: 0.3337 - 424s/epoch - 48ms/step
Epoch 5/50
8838/8838 - 422s - loss: 3.2021 - accuracy200: 0.4218 - val_loss: 3.5550 - val_accuracy200: 0.3262 - 422s/epoch - 48ms/step
Epoch 6/50
8838/8838 - 422s - loss: 3.1976 - accuracy200: 0.4236 - val_loss: 3.5355 - val_accuracy200: 0.3297 - 422s/epoch - 48ms/step
Epoch 7/50
8838/8838 - 423s - loss: 3.1937 - accuracy200: 0.4257 - val_loss: 3.5263 - val_accuracy200: 0.3304 - 423s/epoch - 48ms/step
Epoch 8/50
8838/8838 - 424s - loss: 3.1903 - accuracy200: 0.4269 - val_loss: 3.4986 - val_accuracy200: 0.3287 - 424s/epoch - 48ms/step
Epoch 9/50
8838/8838 - 423s - loss: 3.1878 - accuracy200: 0.4278 - val_loss: 3.5112 - val_accuracy200: 0.3300 - 423s/epoch - 48ms/step
Epoch 10/50
8838/8838 - 423s - loss: 3.1853 - accuracy200: 0.4289 - val_loss: 3.5360 - val_accuracy200: 0.3305 - 423s/epoch - 48ms/step
Epoch 11/50
8838/8838 - 422s - loss: 3.1831 - accuracy200: 0.4302 - val_loss: 3.5684 - val_accuracy200: 0.3292 - 422s/epoch - 48ms/step
testing model in sample: results/universal/W0/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 575s - 575s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903213
{'0': {'precision': 0.29621823214917475, 'recall': 0.24196777359760935, 'f1-score': 0.26635871377851744, 'support': 2287255}, '1': {'precision': 0.47528537883514516, 'recall': 0.6824152403324835, 'f1-score': 0.5603210029506568, 'support': 3824431}, '2': {'precision': 0.2860672499054654, 'recall': 0.13334970519945083, 'f1-score': 0.1819048227679258, 'support': 2337343}, 'accuracy': 0.4112870248166979, 'macro avg': {'precision': 0.3525236202965951, 'recall': 0.3525775730431812, 'f1-score': 0.33619484649903336, 'support': 8449029}, 'weighted avg': {'precision': 0.37446433824928566, 'recall': 0.4112870248166979, 'f1-score': 0.37605661877618346, 'support': 8449029}}
[[ 553442 1429784  304029]
 [ 740746 2609850  473835]
 [ 574171 1451488  311684]]
Evaluating performance on  train set...
8838/8838 - 165s - 165s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.122924
{'0': {'precision': 0.3296929155554032, 'recall': 0.3333959919796933, 'f1-score': 0.33153411369486085, 'support': 750096}, '1': {'precision': 0.3261023755308019, 'recall': 0.5664797586052989, 'f1-score': 0.4139235772405355, 'support': 748318}, '2': {'precision': 0.3539932525008471, 'recall': 0.09439303981625283, 'f1-score': 0.14904335725930928, 'support': 763658}, 'accuracy': 0.32981708805024773, 'macro avg': {'precision': 0.3365961811956841, 'recall': 0.3314229301337483, 'f1-score': 0.29816701606490187, 'support': 2262072}, 'weighted avg': {'precision': 0.33670873157759623, 'recall': 0.32981708805024773, 'f1-score': 0.2971819765849509, 'support': 2262072}}
[[250079 433784  66233]
 [259097 423907  65314]
 [249345 442229  72084]]
Evaluating performance on  val set...
3279/3279 - 61s - 61s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.118544
{'0': {'precision': 0.3228568159342231, 'recall': 0.287538715183631, 'f1-score': 0.3041759951026914, 'support': 274763}, '1': {'precision': 0.3320821622134462, 'recall': 0.5874687049806285, 'f1-score': 0.42431122571390323, 'support': 285988}, '2': {'precision': 0.33497648591988216, 'recall': 0.10628276392714094, 'f1-score': 0.16136648370094794, 'support': 278126}, 'accuracy': 0.32969553343338776, 'macro avg': {'precision': 0.3299718213558505, 'recall': 0.3270967280304668, 'f1-score': 0.29661790150584755, 'support': 838877}, 'weighted avg': {'precision': 0.33002012314867035, 'recall': 0.32969553343338776, 'f1-score': 0.2977843502774285, 'support': 838877}}
[[ 79005 167846  27912]
 [ 87206 168009  30773]
 [ 78495 170071  29560]]
testing model out of sample: results/universal/W0/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 397s - 397s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1190691
{'0': {'precision': 0.3482336071005966, 'recall': 0.2612166005636827, 'f1-score': 0.29851298073215343, 'support': 1941163}, '1': {'precision': 0.33902857621780336, 'recall': 0.6980446863683568, 'f1-score': 0.45639417135432236, 'support': 1929716}, '2': {'precision': 0.306197527132916, 'recall': 0.06299424489471399, 'f1-score': 0.10449139700179012, 'support': 1962084}, 'accuracy': 0.3390544393989813, 'macro avg': {'precision': 0.3311532368171053, 'recall': 0.34075184394225116, 'f1-score': 0.286466183029422, 'support': 5832963}, 'weighted avg': {'precision': 0.3310482734541587, 'recall': 0.3390544393989813, 'f1-score': 0.2854800186767869, 'support': 5832963}}
[[ 507064 1320969  113130]
 [ 415757 1347028  166931]
 [ 533282 1305202  123600]]
Evaluating performance on  train set...
6334/6334 - 116s - 116s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175036
{'0': {'precision': 0.3340714731394595, 'recall': 0.2539587468169127, 'f1-score': 0.28855786585958665, 'support': 537607}, '1': {'precision': 0.3378142848120536, 'recall': 0.6549376082808833, 'f1-score': 0.44572522354729244, 'support': 547188}, '2': {'precision': 0.356977681462003, 'recall': 0.10078249596627527, 'f1-score': 0.15718755591242534, 'support': 536105}, 'accuracy': 0.3386600037016472, 'macro avg': {'precision': 0.3429544798045054, 'recall': 0.3365596170213571, 'f1-score': 0.29715688177310146, 'support': 1620900}, 'weighted avg': {'precision': 0.3429111020161703, 'recall': 0.3386600037016472, 'f1-score': 0.2981647583910182, 'support': 1620900}}
[[136530 350921  50156]
 [141646 358374  47168]
 [130509 351566  54030]]
Evaluating performance on  val set...
2156/2156 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144643
{'0': {'precision': 0.32201752511220344, 'recall': 0.21229541458136075, 'f1-score': 0.2558906547738335, 'support': 177432}, '1': {'precision': 0.3539612463262891, 'recall': 0.7143627456015119, 'f1-score': 0.47337086815002355, 'support': 194726}, '2': {'precision': 0.3142166344294004, 'recall': 0.07253365481213582, 'f1-score': 0.1178604465565088, 'support': 179172}, 'accuracy': 0.3442022019480166, 'macro avg': {'precision': 0.33006513528929765, 'recall': 0.33306393833166953, 'f1-score': 0.28237398982678863, 'support': 551330}, 'weighted avg': {'precision': 0.3307646853823045, 'recall': 0.3442022019480166, 'f1-score': 0.2878459330339998, 'support': 551330}}
[[ 37668 126541  13223]
 [ 40480 139105  15141]
 [ 38827 127349  12996]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1168215
{'0': {'precision': 0.32764239685949187, 'recall': 0.3726569410707516, 'f1-score': 0.34870292392282576, 'support': 71221}, '1': {'precision': 0.3443459318989567, 'recall': 0.45614123900525216, 'f1-score': 0.39243697021498997, 'support': 79015}, '2': {'precision': 0.3402978093084899, 'recall': 0.17715337058131198, 'f1-score': 0.23300711743772246, 'support': 73919}, 'accuracy': 0.33761459704222524, 'macro avg': {'precision': 0.33742871268897945, 'recall': 0.3353171835524386, 'f1-score': 0.3247156705251794, 'support': 224155}, 'weighted avg': {'precision': 0.33770376178091144, 'recall': 0.33761459704222524, 'f1-score': 0.3259665466312329, 'support': 224155}}
[[26541 34124 10556]
 [28143 36042 14830]
 [26322 34502 13095]]
Evaluating performance on  train set...
318/318 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1193141
{'0': {'precision': 0.3360524039055741, 'recall': 0.19737940546622626, 'f1-score': 0.24869091990030412, 'support': 27551}, '1': {'precision': 0.32614388897229313, 'recall': 0.7300425659024719, 'f1-score': 0.4508653192053591, 'support': 26782}, '2': {'precision': 0.37414165195212873, 'recall': 0.07090537274586355, 'f1-score': 0.11921730432608152, 'support': 26895}, 'accuracy': 0.33112965972324815, 'macro avg': {'precision': 0.3454459816099987, 'recall': 0.33277578137152053, 'f1-score': 0.27292451447724825, 'support': 81228}, 'weighted avg': {'precision': 0.3453969707946882, 'recall': 0.33112965972324815, 'f1-score': 0.27248126154751035, 'support': 81228}}
[[ 5438 20493  1620]
 [ 5660 19552  1570]
 [ 5084 19904  1907]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176515
{'0': {'precision': 0.34922749067661163, 'recall': 0.4503091367071216, 'f1-score': 0.39337867573514707, 'support': 8734}, '1': {'precision': 0.3461254612546125, 'recall': 0.40911569076436594, 'f1-score': 0.37499375343561037, 'support': 9171}, '2': {'precision': 0.3208836255978137, 'recall': 0.16406613879832324, 'f1-score': 0.21711996301718162, 'support': 8588}, 'accuracy': 0.3432604839014079, 'macro avg': {'precision': 0.3387455258430126, 'recall': 0.34116365542327026, 'f1-score': 0.32849746406264635, 'support': 26493}, 'weighted avg': {'precision': 0.3389656922722833, 'recall': 0.3432604839014079, 'f1-score': 0.32987820590421296, 'support': 26493}}
[[3933 3594 1207]
 [3644 3752 1775]
 [3685 3494 1409]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
2359/2359 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1191447
{'0': {'precision': 0.2892771329668092, 'recall': 0.4068899543457465, 'f1-score': 0.33814858981774387, 'support': 174573}, '1': {'precision': 0.37765750468711307, 'recall': 0.48099189936834896, 'f1-score': 0.42310679919468624, 'support': 221958}, '2': {'precision': 0.38019537247842433, 'recall': 0.1385863927394491, 'f1-score': 0.2031293647566344, 'support': 207257}, 'accuracy': 0.34203230272877233, 'macro avg': {'precision': 0.3490433367107822, 'recall': 0.34215608215118154, 'f1-score': 0.32146158458968815, 'support': 603788}, 'weighted avg': {'precision': 0.35297527223548303, 'recall': 0.34203230272877233, 'f1-score': 0.3230331431848148, 'support': 603788}}
[[ 71032  82499  21042]
 [ 89415 106760  25783]
 [ 85103  93431  28723]]
Evaluating performance on  train set...
589/589 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1200618
{'0': {'precision': 0.3278051473711034, 'recall': 0.30410543319806155, 'f1-score': 0.31551086312261123, 'support': 50762}, '1': {'precision': 0.3185103932430209, 'recall': 0.5812747727909677, 'f1-score': 0.4115250249789185, 'support': 49954}, '2': {'precision': 0.3602185089974293, 'recall': 0.08969973394146712, 'f1-score': 0.14363278184409886, 'support': 49989}, 'accuracy': 0.32485982548687836, 'macro avg': {'precision': 0.33551134987051784, 'recall': 0.3250266466434988, 'f1-score': 0.29022288998187623, 'support': 150705}, 'weighted avg': {'precision': 0.33547577134923395, 'recall': 0.32485982548687836, 'f1-score': 0.29032442628467237, 'support': 150705}}
[[15437 31443  3882]
 [16835 29037  4082]
 [14820 30685  4484]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1320268
{'0': {'precision': 0.33633594989919785, 'recall': 0.3983640705177056, 'f1-score': 0.3647316029398084, 'support': 19683}, '1': {'precision': 0.27247788428936903, 'recall': 0.5077250014358738, 'f1-score': 0.35463553576443213, 'support': 17411}, '2': {'precision': 0.3668407310704961, 'recall': 0.05173524808984627, 'f1-score': 0.09068172650262203, 'support': 21726}, 'accuracy': 0.30270316218973137, 'macro avg': {'precision': 0.3252181884196877, 'recall': 0.31927477334780857, 'f1-score': 0.27001628840228753, 'support': 58820}, 'weighted avg': {'precision': 0.32870103142580265, 'recall': 0.30270316218973137, 'f1-score': 0.26051891608049543, 'support': 58820}}
[[ 7841 10927   915]
 [ 7546  8840  1025]
 [ 7926 12676  1124]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102542
{'0': {'precision': 0.26737620813216323, 'recall': 0.5704664883425341, 'f1-score': 0.3640997699479356, 'support': 105426}, '1': {'precision': 0.47073945163117137, 'recall': 0.37886974112104066, 'f1-score': 0.41983758108177127, 'support': 195265}, '2': {'precision': 0.23770734597156398, 'recall': 0.06968565474122959, 'f1-score': 0.10777598710717162, 'support': 115160}, 'accuracy': 0.3418219506505936, 'macro avg': {'precision': 0.3252743352449662, 'recall': 0.3396739614016015, 'f1-score': 0.2972377793789595, 'support': 415851}, 'weighted avg': {'precision': 0.35465039425993305, 'recall': 0.3418219506505936, 'f1-score': 0.31928900084820044, 'support': 415851}}
[[ 60142  38840   6444]
 [101994  73980  19291]
 [ 62798  44337   8025]]
Evaluating performance on  train set...
451/451 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232054
{'0': {'precision': 0.33439698903616427, 'recall': 0.4320410158830836, 'f1-score': 0.376999089095668, 'support': 37839}, '1': {'precision': 0.34309351348422173, 'recall': 0.49917216367506767, 'f1-score': 0.40667151971909393, 'support': 38051}, '2': {'precision': 0.37407374341576644, 'recall': 0.10591506572295248, 'f1-score': 0.16508737022517286, 'support': 39560}, 'accuracy': 0.3424166305760069, 'macro avg': {'precision': 0.35052141531205083, 'recall': 0.34570941509370123, 'f1-score': 0.31625265967997823, 'support': 115450}, 'weighted avg': {'precision': 0.3508588673820291, 'recall': 0.3424166305760069, 'f1-score': 0.31416529142685196, 'support': 115450}}
[[16348 17731  3760]
 [15806 18994  3251]
 [16734 18636  4190]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1218961
{'0': {'precision': 0.3287114069144019, 'recall': 0.3613821138211382, 'f1-score': 0.3442734049762804, 'support': 14760}, '1': {'precision': 0.3608948503892693, 'recall': 0.4823846539618857, 'f1-score': 0.41288834039813277, 'support': 15952}, '2': {'precision': 0.28703459202534987, 'recall': 0.15085698424814378, 'f1-score': 0.1977712076415738, 'support': 14411}, 'accuracy': 0.336923520156018, 'macro avg': {'precision': 0.32554694977634036, 'recall': 0.33154125067705587, 'f1-score': 0.3183109843386623, 'support': 45123}, 'weighted avg': {'precision': 0.3267785946223326, 'recall': 0.336923520156018, 'f1-score': 0.321741709035384, 'support': 45123}}
[[5334 6932 2494]
 [5351 7695 2906]
 [5542 6695 2174]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1263709
{'0': {'precision': 0.34705945829286716, 'recall': 0.1575533718047949, 'f1-score': 0.21672214660179784, 'support': 102067}, '1': {'precision': 0.3376765708718948, 'recall': 0.5476801799867758, 'f1-score': 0.4177723046287774, 'support': 116453}, '2': {'precision': 0.25915379719272386, 'recall': 0.218440570761643, 'f1-score': 0.23706185488030973, 'support': 106244}, 'accuracy': 0.31736276188247464, 'macro avg': {'precision': 0.3146299421191619, 'recall': 0.30789137418440454, 'f1-score': 0.2905187687036283, 'support': 324764}, 'weighted avg': {'precision': 0.314937318995537, 'recall': 0.31736276188247464, 'f1-score': 0.2954681468329136, 'support': 324764}}
[[16081 58371 27615]
 [13944 63779 38730]
 [16310 66726 23208]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1165911
{'0': {'precision': 0.35576653696498056, 'recall': 0.2779764076371154, 'f1-score': 0.3120972146368105, 'support': 41115}, '1': {'precision': 0.3330478614074582, 'recall': 0.6649080383967172, 'f1-score': 0.4437995712317713, 'support': 40941}, '2': {'precision': 0.37704444872041565, 'recall': 0.09286949927723406, 'f1-score': 0.14903123989884587, 'support': 42199}, 'accuracy': 0.34260190736791274, 'macro avg': {'precision': 0.35528628236428483, 'recall': 0.3452513151036889, 'f1-score': 0.30164267525580923, 'support': 124255}, 'weighted avg': {'precision': 0.35550724198423195, 'recall': 0.34260190736791274, 'f1-score': 0.30011222500570445, 'support': 124255}}
[[11429 26466  3220]
 [10464 27222  3255]
 [10232 28048  3919]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1248786
{'0': {'precision': 0.3296950391155666, 'recall': 0.4810663021189337, 'f1-score': 0.3912499652555799, 'support': 14630}, '1': {'precision': 0.3473282442748092, 'recall': 0.5053526027030644, 'f1-score': 0.4116973727242996, 'support': 14946}, '2': {'precision': 0.3724763081994232, 'recall': 0.05669844455594581, 'f1-score': 0.0984159817103043, 'support': 15944}, 'accuracy': 0.3403998242530756, 'macro avg': {'precision': 0.3498331971965996, 'recall': 0.34770578312598127, 'f1-score': 0.30045443989672793, 'support': 45520}, 'weighted avg': {'precision': 0.3504694336362838, 'recall': 0.3403998242530756, 'f1-score': 0.29539455924463115, 'support': 45520}}
[[7038 6920  672]
 [6542 7553  851]
 [7767 7273  904]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
1733/1733 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1226469
{'0': {'precision': 0.3227285957469328, 'recall': 0.5351840746537173, 'f1-score': 0.40264985199124054, 'support': 136738}, '1': {'precision': 0.3965202572700786, 'recall': 0.4434709900338762, 'f1-score': 0.4186834842016363, 'support': 162651}, '2': {'precision': 0.3044364095500459, 'recall': 0.07361073527473061, 'f1-score': 0.11855552016807193, 'support': 144123}, 'accuracy': 0.35155756777719654, 'macro avg': {'precision': 0.3412284208556858, 'recall': 0.35075526665410806, 'f1-score': 0.31329628545364957, 'support': 443512}, 'weighted avg': {'precision': 0.34384631699719714, 'recall': 0.35155756777719654, 'f1-score': 0.31621106099415935, 'support': 443512}}
[[73180 54240  9318]
 [75599 72131 14921]
 [77975 55539 10609]]
Evaluating performance on  train set...
765/765 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1278083
{'0': {'precision': 0.32643154892496706, 'recall': 0.3732459509885389, 'f1-score': 0.3482726082408619, 'support': 63781}, '1': {'precision': 0.32039629549860005, 'recall': 0.46117121865021543, 'f1-score': 0.378105659130479, 'support': 64514}, '2': {'precision': 0.335968775020016, 'recall': 0.14926855296506544, 'f1-score': 0.20670121607060393, 'support': 67469}, 'accuracy': 0.3250291166915265, 'macro avg': {'precision': 0.327598873147861, 'recall': 0.3278952408679399, 'f1-score': 0.3110264944806483, 'support': 195764}, 'weighted avg': {'precision': 0.32772958517196965, 'recall': 0.3250291166915265, 'f1-score': 0.3093122743018211, 'support': 195764}}
[[23806 30098  9877]
 [24734 29752 10028]
 [24388 33010 10071]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1228596
{'0': {'precision': 0.32323292573814494, 'recall': 0.5143806359753204, 'f1-score': 0.396996336996337, 'support': 21070}, '1': {'precision': 0.31198818066694806, 'recall': 0.3317027196840499, 'f1-score': 0.32154354824675885, 'support': 22282}, '2': {'precision': 0.33889037076553746, 'recall': 0.11892726762145464, 'f1-score': 0.1760670731707317, 'support': 21366}, 'accuracy': 0.3209308075033221, 'macro avg': {'precision': 0.3247038257235435, 'recall': 0.321670207760275, 'f1-score': 0.29820231947127585, 'support': 64718}, 'weighted avg': {'precision': 0.3245305795713731, 'recall': 0.3209308075033221, 'f1-score': 0.2980808314211341, 'support': 64718}}
[[10838  7999  2233]
 [12167  7391  2724]
 [10525  8300  2541]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
4693/4693 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088051
{'0': {'precision': 0.3026697066718411, 'recall': 0.5342693710716957, 'f1-score': 0.38642514879815676, 'support': 350342}, '1': {'precision': 0.40358317132141147, 'recall': 0.29586159560723513, 'f1-score': 0.3414272768147308, 'support': 495360}, '2': {'precision': 0.3133087465282521, 'recall': 0.19356943936538298, 'f1-score': 0.23929614689108358, 'support': 355490}, 'accuracy': 0.3351229445417552, 'macro avg': {'precision': 0.33985387484050156, 'recall': 0.34123346868143795, 'f1-score': 0.3223828575013237, 'support': 1201192}, 'weighted avg': {'precision': 0.34743404586771215, 'recall': 0.3351229445417552, 'f1-score': 0.32432597168604194, 'support': 1201192}}
[[187177 106403  56762]
 [254746 146558  94056]
 [176497 110181  68812]]
Evaluating performance on  train set...
1497/1497 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1206748
{'0': {'precision': 0.3480233272319284, 'recall': 0.44944437900027484, 'f1-score': 0.3922845450993564, 'support': 127335}, '1': {'precision': 0.3362215033887862, 'recall': 0.4120469418575384, 'f1-score': 0.3702923546708889, 'support': 127136}, '2': {'precision': 0.34978854653566094, 'recall': 0.17097716781423397, 'f1-score': 0.22968430283542823, 'support': 128678}, 'accuracy': 0.34351388102278746, 'macro avg': {'precision': 0.3446777923854585, 'recall': 0.3441561628906824, 'f1-score': 0.3307537342018912, 'support': 383149}, 'weighted avg': {'precision': 0.3447000984448089, 'recall': 0.34351388102278746, 'f1-score': 0.3303789337148783, 'support': 383149}}
[[57230 50781 19324]
 [53177 52386 21573]
 [54036 52641 22001]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1190147
{'0': {'precision': 0.3143519983127702, 'recall': 0.2585373257301446, 'f1-score': 0.28372574447075055, 'support': 46121}, '1': {'precision': 0.3283623308478321, 'recall': 0.5938690141724418, 'f1-score': 0.4228965210625764, 'support': 48051}, '2': {'precision': 0.3353337334133493, 'recall': 0.11013775431987911, 'f1-score': 0.16581489663358503, 'support': 45661}, 'accuracy': 0.32530947630387674, 'macro avg': {'precision': 0.32601602085798387, 'recall': 0.32084803140748847, 'f1-score': 0.2908123873889707, 'support': 139833}, 'weighted avg': {'precision': 0.32601775314224396, 'recall': 0.32530947630387674, 'f1-score': 0.2930466326939955, 'support': 139833}}
[[11924 29635  4562]
 [14109 28536  5406]
 [11899 28733  5029]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
6677/6677 - 114s - 114s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0884234
{'0': {'precision': 0.3610683912351959, 'recall': 0.05496460286778801, 'f1-score': 0.09540580200925614, 'support': 499758}, '1': {'precision': 0.4334643082431283, 'recall': 0.839363909659759, 'f1-score': 0.5716942653335715, 'support': 747441}, '2': {'precision': 0.24192663216003615, 'recall': 0.09730635140135949, 'f1-score': 0.1387895577556737, 'support': 462087}, 'accuracy': 0.4094153933279744, 'macro avg': {'precision': 0.34548644387945343, 'recall': 0.33054495464296885, 'f1-score': 0.26862987503283375, 'support': 1709286}, 'weighted avg': {'precision': 0.36051717779201714, 'recall': 0.4094153933279744, 'f1-score': 0.31540678186703563, 'support': 1709286}}
[[ 27469 423411  48878]
 [ 28050 627375  92016]
 [ 20558 396565  44964]]
Evaluating performance on  train set...
2262/2262 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205153
{'0': {'precision': 0.3327603926710848, 'recall': 0.39055586462920694, 'f1-score': 0.35934909954624494, 'support': 192331}, '1': {'precision': 0.33816010116282263, 'recall': 0.49964713468285277, 'f1-score': 0.4033403350581484, 'support': 196959}, '2': {'precision': 0.3549717304811456, 'recall': 0.1162638556950138, 'f1-score': 0.17515817251136617, 'support': 189543}, 'accuracy': 0.33785737855305414, 'macro avg': {'precision': 0.34196407477168433, 'recall': 0.3354889516690245, 'f1-score': 0.3126158690385865, 'support': 578833}, 'weighted avg': {'precision': 0.34187100797352354, 'recall': 0.33785737855305414, 'f1-score': 0.3140033242919263, 'support': 578833}}
[[75116 96252 20963]
 [79468 98410 19081]
 [71152 96354 22037]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1112462
{'0': {'precision': 0.2983824985745581, 'recall': 0.1496943783686128, 'f1-score': 0.19936838939295204, 'support': 66422}, '1': {'precision': 0.3665726943213854, 'recall': 0.7632655167520287, 'f1-score': 0.4952785172535034, 'support': 77513}, '2': {'precision': 0.3288614507895049, 'recall': 0.08191752059027932, 'f1-score': 0.13116306599585675, 'support': 67629}, 'accuracy': 0.352829403868333, 'macro avg': {'precision': 0.33127221456181616, 'recall': 0.3316258052369736, 'f1-score': 0.27526999088077075, 'support': 211564}, 'weighted avg': {'precision': 0.33310904799822405, 'recall': 0.352829403868333, 'f1-score': 0.2859815368321797, 'support': 211564}}
[[ 9943 51019  5460]
 [12504 59163  5846]
 [10876 51213  5540]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
5633/5633 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1194057
{'0': {'precision': 0.2856208698855656, 'recall': 0.5945096234951307, 'f1-score': 0.3858617718510777, 'support': 417312}, '1': {'precision': 0.39288054447312837, 'recall': 0.3675907172180463, 'f1-score': 0.3798151183326164, 'support': 569269}, '2': {'precision': 0.36977998965236886, 'recall': 0.032968481262067466, 'f1-score': 0.06053944603321219, 'support': 455253}, 'accuracy': 0.32761261005081027, 'macro avg': {'precision': 0.3494271346703543, 'recall': 0.33168960732508146, 'f1-score': 0.27540544540563544, 'support': 1441834}, 'weighted avg': {'precision': 0.3545423264776447, 'recall': 0.32761261005081027, 'f1-score': 0.28075526361409503, 'support': 1441834}}
[[248096 155759  13457]
 [347888 209258  12123]
 [272636 167608  15009]]
Evaluating performance on  train set...
1454/1454 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155182
{'0': {'precision': 0.34605509240181315, 'recall': 0.1776696422032533, 'f1-score': 0.23479312847810307, 'support': 122891}, '1': {'precision': 0.3345646998971119, 'recall': 0.7167303782025214, 'f1-score': 0.45618530683874176, 'support': 122950}, '2': {'precision': 0.35219698298544116, 'recall': 0.12722765219319784, 'f1-score': 0.186929047724337, 'support': 126254}, 'accuracy': 0.33867426329297623, 'macro avg': {'precision': 0.3442722584281221, 'recall': 0.34054255753299084, 'f1-score': 0.292635827680394, 'support': 372095}, 'weighted avg': {'precision': 0.3443423429568928, 'recall': 0.33867426329297623, 'f1-score': 0.2917063809484522, 'support': 372095}}
[[21834 86403 14654]
 [19937 88122 14891]
 [21323 88868 16063]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1122758
{'0': {'precision': 0.35988983967738764, 'recall': 0.07750476593941961, 'f1-score': 0.1275423950363386, 'support': 47210}, '1': {'precision': 0.32815660685154974, 'recall': 0.8596764888138635, 'f1-score': 0.4749969008081511, 'support': 46799}, '2': {'precision': 0.35120282040647033, 'recall': 0.06997644725424569, 'f1-score': 0.1167005478413672, 'support': 48402}, 'accuracy': 0.3319827822289009, 'macro avg': {'precision': 0.34641642231180253, 'recall': 0.33571923400250964, 'f1-score': 0.23974661456195231, 'support': 142411}, 'weighted avg': {'precision': 0.34650918319883384, 'recall': 0.3319827822289009, 'f1-score': 0.23803776637481697, 'support': 142411}}
[[ 3659 40527  3024]
 [ 3334 40232  3233]
 [ 3174 41841  3387]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
11876/11876 - 211s - 211s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1380951
{'0': {'precision': 0.37836050837133106, 'recall': 0.2835791918583004, 'f1-score': 0.3241841127154523, 'support': 1128020}, '1': {'precision': 0.25845995858736365, 'recall': 0.722627404258973, 'f1-score': 0.38074132039986586, 'support': 745344}, '2': {'precision': 0.4256423214720826, 'recall': 0.0404226963605432, 'f1-score': 0.07383351961953784, 'support': 1166795}, 'accuracy': 0.2978969192071862, 'macro avg': {'precision': 0.35415426281025914, 'recall': 0.3488764308259389, 'f1-score': 0.2595863175782853, 'support': 3040159}, 'weighted avg': {'precision': 0.3671114347994257, 'recall': 0.2978969192071862, 'f1-score': 0.2419669507620755, 'support': 3040159}}
[[319883 770240  37897]
 [180991 538606  25747]
 [344571 775059  47165]]
Evaluating performance on  train set...
2538/2538 - 47s - 47s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1102557
{'0': {'precision': 0.3500361358708745, 'recall': 0.07395941787556974, 'f1-score': 0.12211669964777702, 'support': 216105}, '1': {'precision': 0.3414962397035257, 'recall': 0.8673273512554215, 'f1-score': 0.4900450839328537, 'support': 220882}, '2': {'precision': 0.36215121826348, 'recall': 0.07318541370780388, 'f1-score': 0.12176410063808395, 'support': 212638}, 'accuracy': 0.3434627669809506, 'macro avg': {'precision': 0.3512278646126268, 'recall': 0.33815739427959834, 'f1-score': 0.2446419614062382, 'support': 649625}, 'weighted avg': {'precision': 0.35109800624926596, 'recall': 0.3434627669809506, 'f1-score': 0.24710231662593085, 'support': 649625}}
[[ 15983 186049  14073]
 [ 15969 191577  13336]
 [ 13709 183367  15562]]
Evaluating performance on  val set...
795/795 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1131611
{'0': {'precision': 0.3301965612769887, 'recall': 0.11300905998856214, 'f1-score': 0.1683877695179791, 'support': 66446}, '1': {'precision': 0.347972164960195, 'recall': 0.87534380013752, 'f1-score': 0.49798300015484037, 'support': 69808}, '2': {'precision': 0.29006882989183874, 'recall': 0.02195659293220995, 'f1-score': 0.040823104493309156, 'support': 67178}, 'accuracy': 0.34453773251012626, 'macro avg': {'precision': 0.3227458520430075, 'recall': 0.3367698176860974, 'f1-score': 0.23573129138870955, 'support': 203432}, 'weighted avg': {'precision': 0.32304517212938977, 'recall': 0.34453773251012626, 'f1-score': 0.23936404067134107, 'support': 203432}}
[[ 7509 57060  1877]
 [ 6969 61106  1733]
 [ 8263 57440  1475]]
testing model on single stock: results/universal/W0/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
19053/19053 - 341s - 341s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.071198
{'0': {'precision': 0.3453960595094491, 'recall': 0.024879300315939115, 'f1-score': 0.046415253213337705, 'support': 1242961}, '1': {'precision': 0.5053254719108699, 'recall': 0.8605978960027522, 'f1-score': 0.6367590571165825, 'support': 2421391}, '2': {'precision': 0.2643999198979753, 'recall': 0.14475487985729113, 'f1-score': 0.18708409952419813, 'support': 1213099}, 'accuracy': 0.4695833950971522, 'macro avg': {'precision': 0.37170715043943137, 'recall': 0.3434106920586608, 'f1-score': 0.29008613661803945, 'support': 4877451}, 'weighted avg': {'precision': 0.4046473577505897, 'recall': 0.4695833950971522, 'f1-score': 0.37447562951807983, 'support': 4877451}}
[[  30924 1026721  185316]
 [  34312 2083844  303235]
 [  24296 1013201  175602]]
Evaluating performance on  train set...
4812/4812 - 84s - 84s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1271452
{'0': {'precision': 0.3183319625374758, 'recall': 0.3528957604664786, 'f1-score': 0.3347239577581848, 'support': 407993}, '1': {'precision': 0.3210624904645394, 'recall': 0.557953242646752, 'f1-score': 0.4075873750583965, 'support': 407337}, '2': {'precision': 0.35349829827595824, 'recall': 0.06084198800589622, 'f1-score': 0.10381582450894046, 'support': 416538}, 'accuracy': 0.32194764374105017, 'macro avg': {'precision': 0.33096425042599115, 'recall': 0.3238969970397089, 'f1-score': 0.28204238577517393, 'support': 1231868}, 'weighted avg': {'precision': 0.3311258334798676, 'recall': 0.32194764374105017, 'f1-score': 0.2807392400818125, 'support': 1231868}}
[[143979 239100  24914]
 [158627 227275  21435]
 [149686 241509  25343]]
Evaluating performance on  val set...
1767/1767 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1180346
{'0': {'precision': 0.31912245113019655, 'recall': 0.3293456317674808, 'f1-score': 0.32415345658653094, 'support': 147119}, '1': {'precision': 0.34249523864608167, 'recall': 0.5221153664481266, 'f1-score': 0.4136475448689483, 'support': 158781}, '2': {'precision': 0.32803725517052457, 'recall': 0.13088057489087593, 'f1-score': 0.18710846138446588, 'support': 146393}, 'accuracy': 0.3327820682610609, 'macro avg': {'precision': 0.32988498164893426, 'recall': 0.3274471910354944, 'f1-score': 0.30830315427998173, 'support': 452293}, 'weighted avg': {'precision': 0.33021309255607645, 'recall': 0.3327820682610609, 'f1-score': 0.3112139082162369, 'support': 452293}}
[[48453 79746 18920]
 [55551 82902 20328]
 [47828 79405 19160]]
training model: results/universal/W0/deepOF_L2/h50
Epoch 1/50
8838/8838 - 254s - loss: 3.0789 - accuracy50: 0.4643 - val_loss: 3.1818 - val_accuracy50: 0.4196 - 254s/epoch - 29ms/step
Epoch 2/50
8838/8838 - 252s - loss: 3.0194 - accuracy50: 0.4809 - val_loss: 3.1653 - val_accuracy50: 0.4331 - 252s/epoch - 29ms/step
Epoch 3/50
8838/8838 - 251s - loss: 3.0036 - accuracy50: 0.4855 - val_loss: 3.1461 - val_accuracy50: 0.4376 - 251s/epoch - 28ms/step
Epoch 4/50
8838/8838 - 249s - loss: 2.9940 - accuracy50: 0.4884 - val_loss: 3.1400 - val_accuracy50: 0.4384 - 249s/epoch - 28ms/step
Epoch 5/50
8838/8838 - 253s - loss: 2.9876 - accuracy50: 0.4900 - val_loss: 3.1373 - val_accuracy50: 0.4371 - 253s/epoch - 29ms/step
Epoch 6/50
8838/8838 - 248s - loss: 2.9829 - accuracy50: 0.4913 - val_loss: 3.1402 - val_accuracy50: 0.4371 - 248s/epoch - 28ms/step
Epoch 7/50
8838/8838 - 255s - loss: 2.9792 - accuracy50: 0.4921 - val_loss: 3.1419 - val_accuracy50: 0.4385 - 255s/epoch - 29ms/step
Epoch 8/50
8838/8838 - 253s - loss: 2.9757 - accuracy50: 0.4934 - val_loss: 3.1480 - val_accuracy50: 0.4363 - 253s/epoch - 29ms/step
Epoch 9/50
8838/8838 - 251s - loss: 2.9727 - accuracy50: 0.4944 - val_loss: 3.1430 - val_accuracy50: 0.4384 - 251s/epoch - 28ms/step
Epoch 10/50
8838/8838 - 252s - loss: 2.9703 - accuracy50: 0.4948 - val_loss: 3.1479 - val_accuracy50: 0.4377 - 252s/epoch - 28ms/step
Epoch 11/50
8838/8838 - 250s - loss: 2.9677 - accuracy50: 0.4955 - val_loss: 3.1506 - val_accuracy50: 0.4362 - 250s/epoch - 28ms/step
Epoch 12/50
8838/8838 - 248s - loss: 2.9655 - accuracy50: 0.4961 - val_loss: 3.1473 - val_accuracy50: 0.4374 - 248s/epoch - 28ms/step
Epoch 13/50
8838/8838 - 264s - loss: 2.9634 - accuracy50: 0.4965 - val_loss: 3.1492 - val_accuracy50: 0.4371 - 264s/epoch - 30ms/step
Epoch 14/50
8838/8838 - 249s - loss: 2.9614 - accuracy50: 0.4971 - val_loss: 3.1516 - val_accuracy50: 0.4384 - 249s/epoch - 28ms/step
Epoch 15/50
8838/8838 - 250s - loss: 2.9599 - accuracy50: 0.4975 - val_loss: 3.1545 - val_accuracy50: 0.4381 - 250s/epoch - 28ms/step
testing model in sample: results/universal/W0/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 420s - 420s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0416728
{'0': {'precision': 0.3642122239183117, 'recall': 0.4588983787542922, 'f1-score': 0.4061092118991639, 'support': 2024616}, '1': {'precision': 0.6476787682182936, 'recall': 0.36083480185835165, 'f1-score': 0.4634643438266241, 'support': 4394432}, '2': {'precision': 0.3339680539113436, 'recall': 0.5675625481537531, 'f1-score': 0.42050210884840383, 'support': 2029956}, 'accuracy': 0.43400192496062256, 'macro avg': {'precision': 0.44861968201598296, 'recall': 0.462431909588799, 'f1-score': 0.4300252215247306, 'support': 8449004}, 'weighted avg': {'precision': 0.5043802388500828, 'recall': 0.43400192496062256, 'f1-score': 0.43939836345190836, 'support': 8449004}}
[[ 929093  438707  656816]
 [1167899 1585664 1640869]
 [ 453974  423855 1152127]]
Evaluating performance on  train set...
8838/8838 - 114s - 114s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0515608
{'0': {'precision': 0.4211947756723685, 'recall': 0.4630636563715474, 'f1-score': 0.44113798817075717, 'support': 710628}, '1': {'precision': 0.5631026262745624, 'recall': 0.30093427525961874, 'f1-score': 0.39224454518976287, 'support': 823419}, '2': {'precision': 0.40280087821704647, 'recall': 0.575827004514992, 'f1-score': 0.4740180148397412, 'support': 728019}, 'accuracy': 0.4403381687360139, 'macro avg': {'precision': 0.46236609338799245, 'recall': 0.44660831204871937, 'f1-score': 0.4358001827334204, 'support': 2262066}, 'weighted avg': {'precision': 0.4669310687794139, 'recall': 0.4403381687360139, 'f1-score': 0.4339222368220165, 'support': 2262066}}
[[329066  94034 287528]
 [241620 247795 334004]
 [210582  98224 419213]]
Evaluating performance on  val set...
3279/3279 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0552213
{'0': {'precision': 0.416865040064824, 'recall': 0.4563780881112154, 'f1-score': 0.4357276086044092, 'support': 253634}, '1': {'precision': 0.5712950333929075, 'recall': 0.2984316025784736, 'f1-score': 0.39205995380410114, 'support': 325619}, '2': {'precision': 0.3937556091362122, 'recall': 0.5931685033182986, 'f1-score': 0.4733158758552013, 'support': 259621}, 'accuracy': 0.4374041870412005, 'macro avg': {'precision': 0.46063856086464794, 'recall': 0.4493260646693293, 'f1-score': 0.43370114608790383, 'support': 838874}, 'weighted avg': {'precision': 0.4696568138358314, 'recall': 0.4374041870412005, 'f1-score': 0.430410582976599, 'support': 838874}}
[[115753  36042 101839]
 [ 93179  97175 135265]
 [ 68743  36879 153999]]
testing model out of sample: results/universal/W0/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 289s - 289s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.00024
{'0': {'precision': 0.48700606519583284, 'recall': 0.41884194780791245, 'f1-score': 0.4503593671625054, 'support': 1909983}, '1': {'precision': 0.5887374712741453, 'recall': 0.44688944770514005, 'f1-score': 0.5080991205603957, 'support': 1982365}, '2': {'precision': 0.4573935644347795, 'recall': 0.6329781149031996, 'f1-score': 0.531048488641166, 'support': 1940590}, 'accuracy': 0.4996161454141978, 'macro avg': {'precision': 0.5110457003015859, 'recall': 0.4995698368054174, 'f1-score': 0.49650232545468914, 'support': 5832938}, 'weighted avg': {'precision': 0.5117282645332064, 'recall': 0.4996161454141978, 'f1-score': 0.49682750525944436, 'support': 5832938}}
[[ 799981  323864  786138]
 [ 425411  885898  671056]
 [ 417259  294980 1228351]]
Evaluating performance on  train set...
6334/6334 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0264432
{'0': {'precision': 0.4688290331270682, 'recall': 0.4376606949151906, 'f1-score': 0.45270902490633436, 'support': 532842}, '1': {'precision': 0.4949959221717348, 'recall': 0.4616508836840361, 'f1-score': 0.47774226285354454, 'support': 552177}, '2': {'precision': 0.4522739747639254, 'recall': 0.5135657142643872, 'f1-score': 0.4809750718082573, 'support': 535873}, 'accuracy': 0.4709277360860563, 'macro avg': {'precision': 0.47203297668757616, 'recall': 0.47095909762120464, 'f1-score': 0.4704754531893787, 'support': 1620892}, 'weighted avg': {'precision': 0.47226994436716596, 'recall': 0.4709277360860563, 'f1-score': 0.4705817700253496, 'support': 1620892}}
[[233204 133493 166145]
 [130121 254913 167143]
 [134093 126574 275206]]
Evaluating performance on  val set...
2156/2156 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0204121
{'0': {'precision': 0.469568980337062, 'recall': 0.44950687201371, 'f1-score': 0.45931896264297, 'support': 176222}, '1': {'precision': 0.5058696389218511, 'recall': 0.4846399407217934, 'f1-score': 0.4950272806210391, 'support': 197037}, '2': {'precision': 0.4554260866874023, 'recall': 0.49583031487440404, 'f1-score': 0.47477012421358283, 'support': 178071}, 'accuracy': 0.4770246494839751, 'macro avg': {'precision': 0.4769549019821051, 'recall': 0.47665904253663577, 'f1-score': 0.47637212249253064, 'support': 551330}, 'weighted avg': {'precision': 0.47797435216606193, 'recall': 0.4770246494839751, 'f1-score': 0.4770710596474599, 'support': 551330}}
[[79213 46868 50141]
 [46110 95492 55435]
 [43370 46408 88293]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
876/876 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1644467
{'0': {'precision': 0.3189241343164465, 'recall': 0.4386735262312809, 'f1-score': 0.3693347587681484, 'support': 61034}, '1': {'precision': 0.5589166930630345, 'recall': 0.07029670428174457, 'f1-score': 0.12488609319567198, 'support': 100403}, '2': {'precision': 0.29992709941914697, 'recall': 0.6101127357964059, 'f1-score': 0.4021567761871729, 'support': 62713}, 'accuracy': 0.3216328351550301, 'macro avg': {'precision': 0.39258930893287597, 'recall': 0.3730276554364771, 'f1-score': 0.29879254271699773, 'support': 224150}, 'weighted avg': {'precision': 0.4211084386944047, 'recall': 0.3216328351550301, 'f1-score': 0.26902241350348605, 'support': 224150}}
[[26774  3136 31124]
 [35160  7058 58185]
 [22017  2434 38262]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1229486
{'0': {'precision': 0.3877469224162611, 'recall': 0.48897072096465577, 'f1-score': 0.43251528844465026, 'support': 27699}, '1': {'precision': 0.40650697175545225, 'recall': 0.04238583410997204, 'f1-score': 0.07676726757139964, 'support': 26825}, '2': {'precision': 0.3623384983217619, 'recall': 0.5902775176959665, 'f1-score': 0.4490377355802789, 'support': 26701}, 'accuracy': 0.37478608802708524, 'macro avg': {'precision': 0.3855307974978251, 'recall': 0.3738780242568647, 'f1-score': 0.31944009719877625, 'support': 81225}, 'weighted avg': {'precision': 0.38559004943105435, 'recall': 0.37478608802708524, 'f1-score': 0.32045896589670897, 'support': 81225}}
[[13544   861 13294]
 [11245  1137 14443]
 [10141   799 15761]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1352175
{'0': {'precision': 0.36300534659037614, 'recall': 0.4708029197080292, 'f1-score': 0.40993591441131294, 'support': 8220}, '1': {'precision': 0.5427461139896373, 'recall': 0.04252943564758425, 'f1-score': 0.07887801204819277, 'support': 9852}, '2': {'precision': 0.34601593625498006, 'recall': 0.6188101175632348, 'f1-score': 0.4438482177079341, 'support': 8421}, 'accuracy': 0.35858528667950024, 'macro avg': {'precision': 0.4172557989449978, 'recall': 0.37738082430628267, 'f1-score': 0.3108873813891466, 'support': 26493}, 'weighted avg': {'precision': 0.42444565972906, 'recall': 0.35858528667950024, 'f1-score': 0.2976040928727702, 'support': 26493}}
[[3870  186 4164]
 [3748  419 5685]
 [3043  167 5211]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
2359/2359 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.909752
{'0': {'precision': 0.4902050248002002, 'recall': 0.4670232978805449, 'f1-score': 0.4783334589989121, 'support': 142631}, '1': {'precision': 0.6776935388225392, 'recall': 0.6881343092726101, 'f1-score': 0.6828740179614076, 'support': 308899}, '2': {'precision': 0.4878143660163772, 'recall': 0.4941774546314358, 'f1-score': 0.49097529462432954, 'support': 152253}, 'accuracy': 0.5869923465880954, 'macro avg': {'precision': 0.5519043098797055, 'recall': 0.549778353928197, 'f1-score': 0.5507275905282164, 'support': 603783}, 'weighted avg': {'precision': 0.5855224310888388, 'recall': 0.5869923465880954, 'f1-score': 0.5861654640776118, 'support': 603783}}
[[ 66612  50405  25614]
 [ 42950 212564  53385]
 [ 26324  50689  75240]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93932724
{'0': {'precision': 0.5008934671782205, 'recall': 0.46602772548348453, 'f1-score': 0.48283199290735235, 'support': 40901}, '1': {'precision': 0.6176106818453846, 'recall': 0.6668389764797105, 'f1-score': 0.6412814582110677, 'support': 69642}, '2': {'precision': 0.4997997704033959, 'recall': 0.46614875127611366, 'f1-score': 0.4823881058517354, 'support': 40161}, 'accuracy': 0.5588570973564072, 'macro avg': {'precision': 0.5394346398090003, 'recall': 0.5330051510797696, 'f1-score': 0.5355005189900518, 'support': 150704}, 'weighted avg': {'precision': 0.5545383359784972, 'recall': 0.5588570973564072, 'f1-score': 0.5559349677098838, 'support': 150704}}
[[19061 14943  6897]
 [11363 46440 11839]
 [ 7630 13810 18721]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94355446
{'0': {'precision': 0.511318242343542, 'recall': 0.44253047855886457, 'f1-score': 0.4744440109246976, 'support': 16487}, '1': {'precision': 0.5888427589575411, 'recall': 0.6610786886530101, 'f1-score': 0.6228733808170647, 'support': 25531}, '2': {'precision': 0.5141939950903254, 'recall': 0.48622105827034107, 'f1-score': 0.49981644640234946, 'support': 16801}, 'accuracy': 0.549873340247199, 'macro avg': {'precision': 0.5381183321304696, 'recall': 0.5299434084940718, 'f1-score': 0.5323779460480372, 'support': 58819}, 'weighted avg': {'precision': 0.5457899939131151, 'recall': 0.549873340247199, 'f1-score': 0.546118682904535, 'support': 58819}}
[[ 7296  6190  3001]
 [ 3936 16878  4717]
 [ 3037  5595  8169]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
1625/1625 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0532736
{'0': {'precision': 0.43263074748482583, 'recall': 0.45895843287147636, 'f1-score': 0.4454058758279268, 'support': 136045}, '1': {'precision': 0.44122153409457454, 'recall': 0.3889572122185809, 'f1-score': 0.4134442097786375, 'support': 140671}, '2': {'precision': 0.4451441897040281, 'recall': 0.47196866240207, 'f1-score': 0.45816413390826255, 'support': 139130}, 'accuracy': 0.43963149819885244, 'macro avg': {'precision': 0.43966549042780945, 'recall': 0.4399614358307091, 'f1-score': 0.43900473983827565, 'support': 415846}, 'weighted avg': {'precision': 0.4397234446831578, 'recall': 0.43963149819885244, 'f1-score': 0.4388625326718006, 'support': 415846}}
[[62439 34718 38888]
 [42995 54715 42961]
 [38890 34575 65665]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0632373
{'0': {'precision': 0.42162886828287344, 'recall': 0.49307551607002875, 'f1-score': 0.4545618789521229, 'support': 38270}, '1': {'precision': 0.44527457684352706, 'recall': 0.2778538692514355, 'f1-score': 0.342183369284915, 'support': 37966}, '2': {'precision': 0.4306412493085401, 'recall': 0.5161940222380904, 'f1-score': 0.4695525088732689, 'support': 39212}, 'accuracy': 0.43015037072967915, 'macro avg': {'precision': 0.4325148981449802, 'recall': 0.42904113585318493, 'f1-score': 0.4220992523701022, 'support': 115448}, 'weighted avg': {'precision': 0.43246601103105636, 'recall': 0.43015037072967915, 'f1-score': 0.42269688417042695, 'support': 115448}}
[[18870  6543 12857]
 [13513 10549 13904]
 [12372  6599 20241]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0657512
{'0': {'precision': 0.42867985904039035, 'recall': 0.5188320209973754, 'f1-score': 0.4694671218643313, 'support': 15240}, '1': {'precision': 0.4301255230125523, 'recall': 0.2753817305116528, 'f1-score': 0.3357831128531766, 'support': 14932}, '2': {'precision': 0.42528332749152936, 'recall': 0.48692395157514545, 'f1-score': 0.4540210171817019, 'support': 14951}, 'accuracy': 0.42769762648760057, 'macro avg': {'precision': 0.4280295698481573, 'recall': 0.4270459010280579, 'f1-score': 0.41975708396640327, 'support': 45123}, 'weighted avg': {'precision': 0.42803285222003934, 'recall': 0.42769762648760057, 'f1-score': 0.42011082167009434, 'support': 45123}}
[[7907 2691 4642]
 [5624 4112 5196]
 [4914 2757 7280]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1571397
{'0': {'precision': 0.3243079238321784, 'recall': 0.49548037788676375, 'f1-score': 0.39202367810105737, 'support': 107863}, '1': {'precision': 0.5284609978917779, 'recall': 0.006861439077355426, 'f1-score': 0.013546986606137576, 'support': 109598}, '2': {'precision': 0.3291556811444286, 'recall': 0.48635575686406085, 'f1-score': 0.39260457417995787, 'support': 107298}, 'accuracy': 0.3275690589021397, 'macro avg': {'precision': 0.393974867622795, 'recall': 0.3295658579427267, 'f1-score': 0.26605841296238425, 'support': 324759}, 'weighted avg': {'precision': 0.39480611872400223, 'recall': 0.3275690589021397, 'f1-score': 0.26448923118199935, 'support': 324759}}
[[53444   360 54059]
 [56548   752 52298]
 [54802   311 52185]]
Evaluating performance on  train set...
486/486 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1453463
{'0': {'precision': 0.3496526069847516, 'recall': 0.5503750302443745, 'f1-score': 0.4276314552666704, 'support': 41330}, '1': {'precision': 0.4365079365079365, 'recall': 0.008050744083922909, 'f1-score': 0.015809897954295025, 'support': 40990}, '2': {'precision': 0.34858492180281303, 'recall': 0.4858110363905184, 'f1-score': 0.4059137642464334, 'support': 41934}, 'accuracy': 0.3496788835771887, 'macro avg': {'precision': 0.37824848843183373, 'recall': 0.34807893690627195, 'f1-score': 0.2831183724891329, 'support': 124254}, 'weighted avg': {'precision': 0.3779448764226444, 'recall': 0.3496788835771887, 'f1-score': 0.2844467264895132, 'support': 124254}}
[[22747   201 18382]
 [20972   330 19688]
 [21337   225 20372]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.14507
{'0': {'precision': 0.3474246439218284, 'recall': 0.5626634479983906, 'f1-score': 0.42959170613080766, 'support': 14913}, '1': {'precision': 0.5245398773006135, 'recall': 0.01132525332803497, 'f1-score': 0.02217179902755267, 'support': 15099}, '2': {'precision': 0.36438382206168907, 'recall': 0.4944218739923905, 'f1-score': 0.4195578417423662, 'support': 15507}, 'accuracy': 0.35653243700432785, 'macro avg': {'precision': 0.41211611442804363, 'recall': 0.3561368584396054, 'f1-score': 0.29044044896690885, 'support': 45519}, 'weighted avg': {'precision': 0.41195261870600847, 'recall': 0.35653243700432785, 'f1-score': 0.2910291649408956, 'support': 45519}}
[[8391   62 6460]
 [8014  171 6914]
 [7747   93 7667]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
1733/1733 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1243974
{'0': {'precision': 0.33857127561399664, 'recall': 0.4985959274387314, 'f1-score': 0.4032892319558359, 'support': 133184}, '1': {'precision': 0.429236193677996, 'recall': 0.12053581708075249, 'f1-score': 0.18821742217907575, 'support': 173716}, '2': {'precision': 0.3562379149210442, 'recall': 0.5178797572598769, 'f1-score': 0.42211343112598787, 'support': 136607}, 'accuracy': 0.3564543513405651, 'macro avg': {'precision': 0.3746817947376789, 'recall': 0.3790038339264536, 'f1-score': 0.3378733617536332, 'support': 443507}, 'weighted avg': {'precision': 0.3795251579703598, 'recall': 0.3564543513405651, 'f1-score': 0.32484650809546234, 'support': 443507}}
[[66405 14329 52450]
 [77381 20939 75396]
 [52347 13514 70746]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1021743
{'0': {'precision': 0.37500916892833563, 'recall': 0.47425055271254307, 'f1-score': 0.4188313683190082, 'support': 64681}, '1': {'precision': 0.40220259667147534, 'recall': 0.17690391073556494, 'f1-score': 0.24572755218297898, 'support': 64617}, '2': {'precision': 0.3876322403413408, 'recall': 0.49890169409923874, 'f1-score': 0.4362842162738223, 'support': 66466}, 'accuracy': 0.3844731411291146, 'macro avg': {'precision': 0.3882813353137173, 'recall': 0.38335205251578225, 'f1-score': 0.3669477122586032, 'support': 195764}, 'weighted avg': {'precision': 0.38827086558867796, 'recall': 0.3844731411291146, 'f1-score': 0.36761956075941027, 'support': 195764}}
[[30675  8336 25670]
 [26471 11431 26715]
 [24652  8654 33160]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1041895
{'0': {'precision': 0.37577125127807354, 'recall': 0.5029731005191128, 'f1-score': 0.43016568118983717, 'support': 21190}, '1': {'precision': 0.4128772076206369, 'recall': 0.13430135251277875, 'f1-score': 0.2026759505768312, 'support': 22107}, '2': {'precision': 0.3816348923330133, 'recall': 0.5195835862004575, 'f1-score': 0.44005139863595927, 'support': 21421}, 'accuracy': 0.3825365431564634, 'macro avg': {'precision': 0.39009445041057456, 'recall': 0.38561934641078305, 'f1-score': 0.3576310101342092, 'support': 64718}, 'weighted avg': {'precision': 0.3903870680817899, 'recall': 0.3825365431564634, 'f1-score': 0.3557296120707615, 'support': 64718}}
[[10658  2105  8427]
 [ 9531  2969  9607]
 [ 8174  2117 11130]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/EXC
Evaluating performance on  test set...
4693/4693 - 57s - 57s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8680716
{'0': {'precision': 0.5430307530565582, 'recall': 0.5163458547275924, 'f1-score': 0.5293522176534351, 'support': 286097}, '1': {'precision': 0.6714401964423379, 'recall': 0.7495736684909936, 'f1-score': 0.7083588747998728, 'support': 627446}, '2': {'precision': 0.5716803169369755, 'recall': 0.45450974120788196, 'f1-score': 0.5064057497777597, 'support': 287644}, 'accuracy': 0.623365887243202, 'macro avg': {'precision': 0.5953837554786239, 'recall': 0.5734764214754894, 'f1-score': 0.5813722807436892, 'support': 1201187}, 'weighted avg': {'precision': 0.6169666737478849, 'recall': 0.623365887243202, 'f1-score': 0.6173623253171653, 'support': 1201187}}
[[147725 110066  28306]
 [ 87483 470317  69646]
 [ 36830 120077 130737]]
Evaluating performance on  train set...
1497/1497 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8971066
{'0': {'precision': 0.5608303650934996, 'recall': 0.5095776528176706, 'f1-score': 0.5339769812840459, 'support': 98876}, '1': {'precision': 0.6271508203128635, 'recall': 0.7336610112292276, 'f1-score': 0.6762376610182247, 'support': 183717}, '2': {'precision': 0.5499043245311902, 'recall': 0.4286907662473273, 'f1-score': 0.48179049428595383, 'support': 100555}, 'accuracy': 0.5957958804430664, 'macro avg': {'precision': 0.5792951699791845, 'recall': 0.5573098100980752, 'f1-score': 0.5640017121960749, 'support': 383148}, 'weighted avg': {'precision': 0.5897631197021439, 'recall': 0.5957958804430664, 'f1-score': 0.5884940167341356, 'support': 383148}}
[[ 50385  36974  11517]
 [ 25165 134786  23766]
 [ 14290  43158  43107]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87956434
{'0': {'precision': 0.5710454897906436, 'recall': 0.5090285977594102, 'f1-score': 0.5382565664255806, 'support': 34723}, '1': {'precision': 0.6393191885079411, 'recall': 0.7512329082256186, 'f1-score': 0.6907725563039986, 'support': 69551}, '2': {'precision': 0.5780150985085619, 'recall': 0.4414072386737535, 'f1-score': 0.5005580891029116, 'support': 35559}, 'accuracy': 0.6123018171676213, 'macro avg': {'precision': 0.5961265922690488, 'recall': 0.5672229148862608, 'f1-score': 0.5765290706108303, 'support': 139833}, 'weighted avg': {'precision': 0.6067762281420143, 'recall': 0.6123018171676213, 'f1-score': 0.6045293307724591, 'support': 139833}}
[[17675 13693  3355]
 [ 9198 52249  8104]
 [ 4079 15784 15696]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/AAL
Evaluating performance on  test set...
6677/6677 - 81s - 81s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8989236
{'0': {'precision': 0.495676775116974, 'recall': 0.4675848673232512, 'f1-score': 0.48122119456795415, 'support': 379946}, '1': {'precision': 0.7075142041665555, 'recall': 0.6913845415967219, 'f1-score': 0.6993563833012976, 'support': 959090}, '2': {'precision': 0.45414040609897904, 'recall': 0.507372145471242, 'f1-score': 0.4792827546792399, 'support': 370245}, 'accuracy': 0.6017787596071097, 'macro avg': {'precision': 0.5524437951275029, 'recall': 0.5554471847970718, 'f1-score': 0.553286777516164, 'support': 1709281}, 'weighted avg': {'precision': 0.6055431615567084, 'recall': 0.6017787596071097, 'f1-score': 0.6031985525832047, 'support': 1709281}}
[[177657 142070  60219]
 [130418 663100 165572]
 [ 50338 132055 187852]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98673654
{'0': {'precision': 0.5112370054595767, 'recall': 0.44425489049197375, 'f1-score': 0.47539815007997777, 'support': 184644}, '1': {'precision': 0.5394390722833537, 'recall': 0.5568143792724317, 'f1-score': 0.5479890289284387, 'support': 209190}, '2': {'precision': 0.4827637304829317, 'recall': 0.5283112699124851, 'f1-score': 0.5045115731659475, 'support': 184997}, 'accuracy': 0.5117987806458189, 'macro avg': {'precision': 0.5111466027419541, 'recall': 0.5097935132256302, 'f1-score': 0.5092995840581214, 'support': 578831}, 'weighted avg': {'precision': 0.5123290684417106, 'recall': 0.5117987806458189, 'f1-score': 0.5109373348799361, 'support': 578831}}
[[ 82029  50998  51617]
 [ 39612 116480  53098]
 [ 38811  48450  97736]]
Evaluating performance on  val set...
827/827 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97275984
{'0': {'precision': 0.5226522113727743, 'recall': 0.45362205951082724, 'f1-score': 0.4856966522660172, 'support': 64190}, '1': {'precision': 0.5453885868708005, 'recall': 0.6213551525025757, 'f1-score': 0.5808987820243595, 'support': 83474}, '2': {'precision': 0.49707823739526924, 'recall': 0.47258215962441313, 'f1-score': 0.48452078202340937, 'support': 63900}, 'accuracy': 0.5255289179633587, 'macro avg': {'precision': 0.521706345212948, 'recall': 0.515853123879272, 'f1-score': 0.517038738771262, 'support': 211564}, 'weighted avg': {'precision': 0.5238987338017304, 'recall': 0.5255289179633587, 'f1-score': 0.5229041378067767, 'support': 211564}}
[[29118 21642 13430]
 [14484 51867 17123]
 [12110 21592 30198]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/WBA
Evaluating performance on  test set...
5633/5633 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95878404
{'0': {'precision': 0.4468395442886407, 'recall': 0.42956816630083344, 'f1-score': 0.43803367166102797, 'support': 354442}, '1': {'precision': 0.6504297784802261, 'recall': 0.6192343401358271, 'f1-score': 0.6344488259161277, 'support': 718413}, '2': {'precision': 0.43846043199961643, 'recall': 0.49568533284188043, 'f1-score': 0.46532011031619225, 'support': 368974}, 'accuracy': 0.5409920316486907, 'macro avg': {'precision': 0.5119099182561611, 'recall': 0.5148292797595136, 'f1-score': 0.5126008692977826, 'support': 1441829}, 'weighted avg': {'precision': 0.5461371699700142, 'recall': 0.5409920316486907, 'f1-score': 0.5428832666062119, 'support': 1441829}}
[[152257 121447  80738]
 [120050 444866 153497]
 [ 68435 117644 182895]]
Evaluating performance on  train set...
1454/1454 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0400858
{'0': {'precision': 0.4539738782909645, 'recall': 0.44609268091239607, 'f1-score': 0.44999877478007305, 'support': 123499}, '1': {'precision': 0.4737455188134521, 'recall': 0.3847508909857524, 'f1-score': 0.4246354635463547, 'support': 122617}, '2': {'precision': 0.43974066355727565, 'recall': 0.5276280590901514, 'f1-score': 0.47969198793354795, 'support': 125977}, 'accuracy': 0.4534834033427127, 'macro avg': {'precision': 0.45582002022056406, 'recall': 0.45282387699609994, 'f1-score': 0.4514420754199919, 'support': 372093}, 'weighted avg': {'precision': 0.4556704475718699, 'recall': 0.4534834033427127, 'f1-score': 0.4516937509819647, 'support': 372093}}
[[55092 26472 41935]
 [32689 47177 42751]
 [33574 25934 66469]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0305885
{'0': {'precision': 0.4490474080638015, 'recall': 0.4424701490908297, 'f1-score': 0.44573451638794515, 'support': 45811}, '1': {'precision': 0.4852736871353154, 'recall': 0.43575349301397204, 'f1-score': 0.4591823320625739, 'support': 48096}, '2': {'precision': 0.46396213157797417, 'recall': 0.5173288250211328, 'f1-score': 0.4891943266559438, 'support': 48503}, 'accuracy': 0.46569763359314653, 'macro avg': {'precision': 0.46609440892569703, 'recall': 0.46518415570864485, 'f1-score': 0.46470372503548757, 'support': 142410}, 'weighted avg': {'precision': 0.46636183789900587, 'recall': 0.46569763359314653, 'f1-score': 0.4650780829922263, 'support': 142410}}
[[20270 11312 14229]
 [12377 20958 14761]
 [12493 10918 25092]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
11876/11876 - 142s - 142s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0197227
{'0': {'precision': 0.5436674783565553, 'recall': 0.3887415463245578, 'f1-score': 0.4533335277293813, 'support': 1199774}, '1': {'precision': 0.3667911966356037, 'recall': 0.23105581896020444, 'f1-score': 0.2835148060129482, 'support': 608485}, '2': {'precision': 0.4815958064776135, 'recall': 0.7032855884633025, 'f1-score': 0.5717017612162885, 'support': 1231895}, 'accuracy': 0.48463663353895886, 'macro avg': {'precision': 0.4640181604899242, 'recall': 0.44102765124935495, 'f1-score': 0.43618336498620597, 'support': 3040154}, 'weighted avg': {'precision': 0.48311385294406556, 'recall': 0.48463663353895886, 'f1-score': 0.4673081783910681, 'support': 3040154}}
[[466402 129798 603574]
 [138874 140594 329017]
 [252605 112916 866374]]
Evaluating performance on  train set...
2538/2538 - 29s - 29s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0204029
{'0': {'precision': 0.5019076557538096, 'recall': 0.4039384411716035, 'f1-score': 0.44762525723833, 'support': 217548}, '1': {'precision': 0.47355668708336407, 'recall': 0.5408256429705167, 'f1-score': 0.5049606882668083, 'support': 213579}, '2': {'precision': 0.47131670005463483, 'recall': 0.4974713611628535, 'f1-score': 0.4840409780036026, 'support': 218497}, 'accuracy': 0.48040250975949167, 'macro avg': {'precision': 0.4822603476306028, 'recall': 0.4807451484349912, 'f1-score': 0.4788756411695803, 'support': 649624}, 'weighted avg': {'precision': 0.4822975373082662, 'recall': 0.48040250975949167, 'f1-score': 0.47872381542534453, 'support': 649624}}
[[ 87876  66705  62967]
 [ 39111 115509  58959]
 [ 48097  61704 108696]]
Evaluating performance on  val set...
795/795 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0188271
{'0': {'precision': 0.4993843925402861, 'recall': 0.4093229645899498, 'f1-score': 0.44989071216520404, 'support': 67382}, '1': {'precision': 0.473907448261372, 'recall': 0.5412916966642669, 'f1-score': 0.5053632442726712, 'support': 66672}, '2': {'precision': 0.47877862595419846, 'recall': 0.49721813831473954, 'f1-score': 0.4878241932290635, 'support': 69378}, 'accuracy': 0.4825494514137402, 'macro avg': {'precision': 0.48402348891861885, 'recall': 0.48261093318965215, 'f1-score': 0.48102604988897957, 'support': 203432}, 'weighted avg': {'precision': 0.48400733434308335, 'recall': 0.4825494514137402, 'f1-score': 0.4810078112937458, 'support': 203432}}
[[27581 20200 19601]
 [12630 36089 17953]
 [15019 19863 34496]]
testing model on single stock: results/universal/W0/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
19053/19053 - 224s - 224s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1175989
{'0': {'precision': 0.3109992701153462, 'recall': 0.44917928374014077, 'f1-score': 0.36753057208892065, 'support': 1133583}, '1': {'precision': 0.6097756207150947, 'recall': 0.17378775366187138, 'f1-score': 0.27048618867902197, 'support': 2630076}, '2': {'precision': 0.2854849109981362, 'recall': 0.6383940555959083, 'f1-score': 0.39453624713510593, 'support': 1113787}, 'accuracy': 0.3438873541603536, 'macro avg': {'precision': 0.40208660060952567, 'recall': 0.42045369766597346, 'f1-score': 0.34418433596768283, 'support': 4877446}, 'weighted avg': {'precision': 0.4662827827532932, 'recall': 0.3438873541603536, 'f1-score': 0.3213679833183823, 'support': 4877446}}
[[ 509182  157033  467368]
 [ 860782  457075 1312219]
 [ 267281  135471  711035]]
Evaluating performance on  train set...
4812/4812 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1072526
{'0': {'precision': 0.3890320978350233, 'recall': 0.44752747388072567, 'f1-score': 0.41623467805299313, 'support': 406022}, '1': {'precision': 0.38839122114092595, 'recall': 0.04693531601439773, 'f1-score': 0.08374984360286322, 'support': 406453}, '2': {'precision': 0.37853389168577445, 'recall': 0.6459541431405463, 'f1-score': 0.4773419060867665, 'support': 419392}, 'accuracy': 0.38290740802375584, 'macro avg': {'precision': 0.3853190702205745, 'recall': 0.3801389776785566, 'f1-score': 0.32577547591420764, 'support': 1231867}, 'weighted avg': {'precision': 0.3852465025326962, 'recall': 0.38290740802375584, 'f1-score': 0.32733581491499336, 'support': 1231867}}
[[181706  15238 209078]
 [151685  19077 235691]
 [133681  14803 270908]]
Evaluating performance on  val set...
1767/1767 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1230453
{'0': {'precision': 0.37994974597876124, 'recall': 0.43858856739590685, 'f1-score': 0.40716875935650193, 'support': 141700}, '1': {'precision': 0.4316318926974665, 'recall': 0.04153768928302518, 'f1-score': 0.07578251910644004, 'support': 167342}, '2': {'precision': 0.35707211503191255, 'recall': 0.67954150407327, 'f1-score': 0.46814997920028084, 'support': 143251}, 'accuracy': 0.3680003891282863, 'macro avg': {'precision': 0.3895512512360468, 'recall': 0.386555920250734, 'f1-score': 0.3170337525544076, 'support': 452293}, 'weighted avg': {'precision': 0.39182556604547586, 'recall': 0.3680003891282863, 'f1-score': 0.30387462150319733, 'support': 452293}}
[[ 62148   4759  74793]
 [ 59909   6951 100482]
 [ 41512   4394  97345]]
training model: results/universal/W0/deepOF_L2/h100
Epoch 1/50
8838/8838 - 253s - loss: 3.2104 - accuracy100: 0.4118 - val_loss: 3.2529 - val_accuracy100: 0.3798 - 253s/epoch - 29ms/step
Epoch 2/50
8838/8838 - 254s - loss: 3.1669 - accuracy100: 0.4289 - val_loss: 3.2637 - val_accuracy100: 0.3665 - 254s/epoch - 29ms/step
Epoch 3/50
8838/8838 - 252s - loss: 3.1529 - accuracy100: 0.4345 - val_loss: 3.2637 - val_accuracy100: 0.3696 - 252s/epoch - 29ms/step
Epoch 4/50
8838/8838 - 253s - loss: 3.1453 - accuracy100: 0.4374 - val_loss: 3.2704 - val_accuracy100: 0.3664 - 253s/epoch - 29ms/step
Epoch 5/50
8838/8838 - 253s - loss: 3.1402 - accuracy100: 0.4394 - val_loss: 3.2736 - val_accuracy100: 0.3663 - 253s/epoch - 29ms/step
Epoch 6/50
8838/8838 - 253s - loss: 3.1358 - accuracy100: 0.4408 - val_loss: 3.2749 - val_accuracy100: 0.3687 - 253s/epoch - 29ms/step
Epoch 7/50
8838/8838 - 254s - loss: 3.1330 - accuracy100: 0.4423 - val_loss: 3.2811 - val_accuracy100: 0.3684 - 254s/epoch - 29ms/step
Epoch 8/50
8838/8838 - 257s - loss: 3.1302 - accuracy100: 0.4432 - val_loss: 3.2706 - val_accuracy100: 0.3724 - 257s/epoch - 29ms/step
Epoch 9/50
8838/8838 - 254s - loss: 3.1278 - accuracy100: 0.4441 - val_loss: 3.2735 - val_accuracy100: 0.3729 - 254s/epoch - 29ms/step
Epoch 10/50
8838/8838 - 252s - loss: 3.1254 - accuracy100: 0.4456 - val_loss: 3.2723 - val_accuracy100: 0.3759 - 252s/epoch - 28ms/step
Epoch 11/50
8838/8838 - 253s - loss: 3.1231 - accuracy100: 0.4462 - val_loss: 3.2755 - val_accuracy100: 0.3749 - 253s/epoch - 29ms/step
testing model in sample: results/universal/W0/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 412s - 412s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0667148
{'0': {'precision': 0.39294764471211396, 'recall': 0.24933774295792713, 'f1-score': 0.30508767820041127, 'support': 2397483}, '1': {'precision': 0.4519983478440452, 'recall': 0.5709282322138823, 'f1-score': 0.5045496377336927, 'support': 3641815}, '2': {'precision': 0.3657061230627128, 'recall': 0.3532567873425223, 'f1-score': 0.3593736708109397, 'support': 2409706}, 'accuracy': 0.4175927718817508, 'macro avg': {'precision': 0.4035507052062906, 'recall': 0.39117425417144397, 'f1-score': 0.3896703289150145, 'support': 8449004}, 'weighted avg': {'precision': 0.41063111110161055, 'recall': 0.4175927718817508, 'f1-score': 0.4065454166826327, 'support': 8449004}}
[[ 597783 1256266  543434]
 [ 629604 2079215  932996]
 [ 293892 1264569  851245]]
Evaluating performance on  train set...
8838/8838 - 110s - 110s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0859351
{'0': {'precision': 0.42573697932456195, 'recall': 0.23394277169849792, 'f1-score': 0.3019589090108438, 'support': 750363}, '1': {'precision': 0.3472950160253755, 'recall': 0.5048443661246276, 'f1-score': 0.41150529102693095, 'support': 747363}, '2': {'precision': 0.3958490264482753, 'recall': 0.395330612031295, 'f1-score': 0.395589649396241, 'support': 764340}, 'accuracy': 0.37797791930032104, 'macro avg': {'precision': 0.38962700726607086, 'recall': 0.3780392499514735, 'f1-score': 0.36968461647800527, 'support': 2262066}, 'weighted avg': {'precision': 0.3897215938678021, 'recall': 0.37797791930032104, 'f1-score': 0.36978921670693377, 'support': 2262066}}
[[175542 354116 220705]
 [129594 377302 240467]
 [107189 354984 302167]]
Evaluating performance on  val set...
3279/3279 - 41s - 41s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0842385
{'0': {'precision': 0.4334004024144869, 'recall': 0.23722124328384078, 'f1-score': 0.30661635501914686, 'support': 276944}, '1': {'precision': 0.34931341905147306, 'recall': 0.5022147979197675, 'f1-score': 0.41203653540355567, 'support': 280161}, '2': {'precision': 0.39518306057027164, 'recall': 0.3990076977950023, 'f1-score': 0.39708616990278406, 'support': 281769}, 'accuracy': 0.38006422895452713, 'macro avg': {'precision': 0.3926322940120772, 'recall': 0.3794812463328702, 'f1-score': 0.37191302010849553, 'support': 838874}, 'weighted avg': {'precision': 0.3924808417414084, 'recall': 0.38006422895452713, 'f1-score': 0.37221167973611735, 'support': 838874}}
[[ 65697 130677  80570]
 [ 47962 140701  91498]
 [ 37926 131415 112428]]
testing model out of sample: results/universal/W0/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 282s - 282s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0812101
{'0': {'precision': 0.4524702357307426, 'recall': 0.20473344703219773, 'f1-score': 0.28190892251600674, 'support': 1947249}, '1': {'precision': 0.35351548853007214, 'recall': 0.5950726984883669, 'f1-score': 0.44353792002879777, 'support': 1921498}, '2': {'precision': 0.41971479978339227, 'recall': 0.36697754953566125, 'f1-score': 0.391578509341503, 'support': 1964191}, 'accuracy': 0.3879540636296837, 'macro avg': {'precision': 0.408566841348069, 'recall': 0.38892789835207525, 'f1-score': 0.37234178396210255, 'support': 5832938}, 'weighted avg': {'precision': 0.40884225934466484, 'recall': 0.3879540636296837, 'f1-score': 0.3720833442018178, 'support': 5832938}}
[[ 398667 1052740  495842]
 [ 277333 1143431  500734]
 [ 205090 1038287  720814]]
Evaluating performance on  train set...
6334/6334 - 79s - 79s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0850252
{'0': {'precision': 0.4467506506242221, 'recall': 0.21601013969435023, 'f1-score': 0.29121418122364684, 'support': 548340}, '1': {'precision': 0.34343316790044826, 'recall': 0.615797291426772, 'f1-score': 0.4409476628328549, 'support': 527141}, '2': {'precision': 0.4114646889043148, 'recall': 0.3097352271956378, 'f1-score': 0.3534251905905587, 'support': 545411}, 'accuracy': 0.3775649457212448, 'macro avg': {'precision': 0.40054950247632837, 'recall': 0.38051421943892, 'f1-score': 0.36186234488235347, 'support': 1620892}, 'weighted avg': {'precision': 0.4012767801701084, 'recall': 0.3775649457212448, 'f1-score': 0.3608432657393187, 'support': 1620892}}
[[118447 310360 119533]
 [ 80430 324612 122099]
 [ 66253 310225 168933]]
Evaluating performance on  val set...
2156/2156 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0819691
{'0': {'precision': 0.4413331748278955, 'recall': 0.226152304054316, 'f1-score': 0.2990582342257894, 'support': 180573}, '1': {'precision': 0.3569725372860916, 'recall': 0.6181913352437954, 'f1-score': 0.45259537537572414, 'support': 189134}, '2': {'precision': 0.4047872988785958, 'recall': 0.29255105355599237, 'f1-score': 0.3396369935471912, 'support': 181623}, 'accuracy': 0.38251500915966846, 'macro avg': {'precision': 0.40103100366419436, 'recall': 0.3789648976180346, 'f1-score': 0.3637635343829016, 'support': 551330}, 'weighted avg': {'precision': 0.4003540217827661, 'recall': 0.38251500915966846, 'f1-score': 0.3650969581451892, 'support': 551330}}
[[ 40837 104080  35656]
 [ 29739 116921  42474]
 [ 21955 106534  53134]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
876/876 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987358
{'0': {'precision': 0.29330527044170224, 'recall': 0.17814864107593165, 'f1-score': 0.22166296247875542, 'support': 57104}, '1': {'precision': 0.5013354734347374, 'recall': 0.3662715063121828, 'f1-score': 0.4232905066675137, 'support': 109154}, '2': {'precision': 0.2753215031124965, 'recall': 0.5217992123264009, 'f1-score': 0.3604536695085645, 'support': 57892}, 'accuracy': 0.35851438768681687, 'macro avg': {'precision': 0.35665408232964535, 'recall': 0.35540645323817177, 'f1-score': 0.3351357128849446, 'support': 224150}, 'weighted avg': {'precision': 0.38996470617348616, 'recall': 0.35851438768681687, 'f1-score': 0.3556951934390473, 'support': 224150}}
[[10173 19925 27006]
 [16669 39980 52505]
 [ 7842 19842 30208]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028981
{'0': {'precision': 0.396197099733649, 'recall': 0.18508917461634178, 'f1-score': 0.2523087071240106, 'support': 28932}, '1': {'precision': 0.3126446454870608, 'recall': 0.2992709550086599, 'f1-score': 0.3058116562397102, 'support': 24827}, '2': {'precision': 0.3575004551247042, 'recall': 0.5719799024248161, 'f1-score': 0.4399943985436213, 'support': 27466}, 'accuracy': 0.35081563558017853, 'macro avg': {'precision': 0.35544740011513803, 'recall': 0.35211334401660593, 'f1-score': 0.3327049206357807, 'support': 81225}, 'weighted avg': {'precision': 0.3575735377464613, 'recall': 0.35081563558017853, 'f1-score': 0.33212764117419835, 'support': 81225}}
[[ 5355  8688 14889]
 [ 4052  7430 13345]
 [ 4109  7647 15710]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1022973
{'0': {'precision': 0.34977578475336324, 'recall': 0.1836734693877551, 'f1-score': 0.24086464230571283, 'support': 7644}, '1': {'precision': 0.43570252122133535, 'recall': 0.3073005093378608, 'f1-score': 0.3604066233494026, 'support': 11191}, '2': {'precision': 0.30844645550527905, 'recall': 0.587490206320188, 'f1-score': 0.40451357669483906, 'support': 7658}, 'accuracy': 0.3526214471747254, 'macro avg': {'precision': 0.36464158715999256, 'recall': 0.35948806168193465, 'f1-score': 0.3352616141166515, 'support': 26493}, 'weighted avg': {'precision': 0.37412584342664473, 'recall': 0.3526214471747254, 'f1-score': 0.3386647347607712, 'support': 26493}}
[[1404 2292 3948]
 [1613 3439 6139]
 [ 997 2162 4499]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
2359/2359 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0565579
{'0': {'precision': 0.45069736996693577, 'recall': 0.3084566256202904, 'f1-score': 0.36625135538779435, 'support': 174112}, '1': {'precision': 0.41614391686343927, 'recall': 0.5712798769659532, 'f1-score': 0.48152504955121905, 'support': 235382}, '2': {'precision': 0.43117840113938943, 'recall': 0.3583887919542537, 'f1-score': 0.3914283867232186, 'support': 194289}, 'accuracy': 0.42698452920999763, 'macro avg': {'precision': 0.43267322932325475, 'recall': 0.41270843151349906, 'f1-score': 0.41306826388741064, 'support': 603783}, 'weighted avg': {'precision': 0.4309459330550944, 'recall': 0.42698452920999763, 'f1-score': 0.41929188968687775, 'support': 603783}}
[[ 53706  88752  31654]
 [ 40708 134469  60205]
 [ 24748  99910  69631]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0685133
{'0': {'precision': 0.4711489001180066, 'recall': 0.3116381467026919, 'f1-score': 0.3751415423904402, 'support': 49965}, '1': {'precision': 0.37319405143291656, 'recall': 0.5799015999690079, 'f1-score': 0.4541324413903995, 'support': 51626}, '2': {'precision': 0.44005449591280654, 'recall': 0.3354101765316719, 'f1-score': 0.38067177371832644, 'support': 49113}, 'accuracy': 0.411283044909226, 'macro avg': {'precision': 0.42813248248790986, 'recall': 0.4089833077344573, 'f1-score': 0.40331525249972205, 'support': 150704}, 'weighted avg': {'precision': 0.4274595720846004, 'recall': 0.41128304490922607, 'f1-score': 0.4040033536428182, 'support': 150704}}
[[15571 25404  8990]
 [ 9717 29938 11971]
 [ 7761 24879 16473]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0720149
{'0': {'precision': 0.48582375478927203, 'recall': 0.28907239475150714, 'f1-score': 0.3624698259433363, 'support': 19739}, '1': {'precision': 0.3387245108299242, 'recall': 0.5832787243337703, 'f1-score': 0.4285685625438861, 'support': 18312}, '2': {'precision': 0.4637410720030886, 'recall': 0.3470242681047766, 'f1-score': 0.3969814646506376, 'support': 20768}, 'accuracy': 0.40112888692429316, 'macro avg': {'precision': 0.42942977920742825, 'recall': 0.4064584623966847, 'f1-score': 0.39600661771262, 'support': 58819}, 'weighted avg': {'precision': 0.4322306214227232, 'recall': 0.40112888692429316, 'f1-score': 0.3952336909750863, 'support': 58819}}
[[ 5706 10189  3844]
 [ 3141 10681  4490]
 [ 2898 10663  7207]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
1625/1625 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883981
{'0': {'precision': 0.40337496647191223, 'recall': 0.25302297681835806, 'f1-score': 0.310979447251542, 'support': 136703}, '1': {'precision': 0.3437755795724136, 'recall': 0.539647625062613, 'f1-score': 0.41999728804366254, 'support': 137751}, '2': {'precision': 0.40804496750395225, 'recall': 0.32859001923729775, 'f1-score': 0.3640324071897576, 'support': 141392}, 'accuracy': 0.37366236539488173, 'macro avg': {'precision': 0.38506517118275935, 'recall': 0.37375354037275627, 'f1-score': 0.3650030474949874, 'support': 415846}, 'weighted avg': {'precision': 0.3852202304425393, 'recall': 0.37366236539488173, 'f1-score': 0.3651306972299945, 'support': 415846}}
[[34589 69689 32425]
 [28439 74337 34975]
 [22721 72211 46460]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898402
{'0': {'precision': 0.3929790955276089, 'recall': 0.24800273310207085, 'f1-score': 0.30409564012502815, 'support': 38052}, '1': {'precision': 0.34154505047596767, 'recall': 0.4979536152796726, 'f1-score': 0.4051789469189962, 'support': 38116}, '2': {'precision': 0.39734545353149486, 'recall': 0.36278004073319753, 'f1-score': 0.3792768454812823, 'support': 39280}, 'accuracy': 0.3695776453468228, 'macro avg': {'precision': 0.37728986651169044, 'recall': 0.369578796371647, 'f1-score': 0.3628504775084356, 'support': 115448}, 'weighted avg': {'precision': 0.3774833786785018, 'recall': 0.3695776453468228, 'f1-score': 0.36304866718615136, 'support': 115448}}
[[ 9437 18013 10602]
 [ 8125 18980 11011]
 [ 6452 18578 14250]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0880784
{'0': {'precision': 0.41088762133493445, 'recall': 0.2696525907926709, 'f1-score': 0.325614591593973, 'support': 15227}, '1': {'precision': 0.34374863435738323, 'recall': 0.5251351892649709, 'f1-score': 0.41550895356822143, 'support': 14979}, '2': {'precision': 0.3891565281293378, 'recall': 0.3195012401957498, 'f1-score': 0.3509056103666618, 'support': 14917}, 'accuracy': 0.37094164838330784, 'macro avg': {'precision': 0.3812642612738852, 'recall': 0.37142967341779726, 'f1-score': 0.3640097185096187, 'support': 45123}, 'weighted avg': {'precision': 0.3814162297323232, 'recall': 0.37094164838330784, 'f1-score': 0.36381670082971673, 'support': 45123}}
[[4106 7457 3664]
 [3296 7866 3817]
 [2591 7560 4766]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1269/1269 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1186025
{'0': {'precision': 0.31732560108364377, 'recall': 0.14579382906930385, 'f1-score': 0.19979345037811905, 'support': 102837}, '1': {'precision': 0.36636642826225857, 'recall': 0.1512457030053436, 'f1-score': 0.21410374546045854, 'support': 117524}, '2': {'precision': 0.32552381285099175, 'recall': 0.7140270886415448, 'f1-score': 0.4471792964438259, 'support': 104398}, 'accuracy': 0.330432720879175, 'macro avg': {'precision': 0.3364052807322981, 'recall': 0.3370222069053974, 'f1-score': 0.2870254974274678, 'support': 324759}, 'weighted avg': {'precision': 0.33770794948792854, 'recall': 0.330432720879175, 'f1-score': 0.28449746374441387, 'support': 324759}}
[[14993 15582 72262]
 [17560 17775 82189]
 [14695 15160 74543]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1092871
{'0': {'precision': 0.3515532316885628, 'recall': 0.19474260679079955, 'f1-score': 0.2506421903389512, 'support': 41085}, '1': {'precision': 0.32076862817381685, 'recall': 0.16966048404786857, 'f1-score': 0.22193527817631117, 'support': 41029}, '2': {'precision': 0.3480963480963481, 'recall': 0.6591362126245848, 'f1-score': 0.4555907294109928, 'support': 42140}, 'accuracy': 0.3439567337872423, 'macro avg': {'precision': 0.34013940265290926, 'recall': 0.34117976782108433, 'f1-score': 0.30938939930875176, 'support': 124254}, 'weighted avg': {'precision': 0.34021569267828994, 'recall': 0.3439567337872423, 'f1-score': 0.3106701615702586, 'support': 124254}}
[[ 8001  7613 25471]
 [ 7521  6961 26547]
 [ 7237  7127 27776]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1079699
{'0': {'precision': 0.3554277984443693, 'recall': 0.21409655734365451, 'f1-score': 0.2672260361047546, 'support': 14727}, '1': {'precision': 0.33910208176573864, 'recall': 0.17728822449514817, 'f1-score': 0.2328425040902437, 'support': 15252}, '2': {'precision': 0.35436283741368485, 'recall': 0.6538610038610039, 'f1-score': 0.4596281720721943, 'support': 15540}, 'accuracy': 0.3518970100397636, 'macro avg': {'precision': 0.3496309058745976, 'recall': 0.3484152618999355, 'f1-score': 0.3198989040890642, 'support': 45519}, 'weighted avg': {'precision': 0.349593985636546, 'recall': 0.3518970100397636, 'f1-score': 0.3213904852940754, 'support': 45519}}
[[ 3153  2663  8911]
 [ 2946  2704  9602]
 [ 2772  2607 10161]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
1733/1733 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.091441
{'0': {'precision': 0.3650492486794795, 'recall': 0.21720254769968364, 'f1-score': 0.27235511282958696, 'support': 143502}, '1': {'precision': 0.3669383003492433, 'recall': 0.4380906997061393, 'f1-score': 0.39937010154397523, 'support': 151092}, '2': {'precision': 0.3820990919013807, 'recall': 0.45605152001504234, 'f1-score': 0.41581278872911737, 'support': 148913}, 'accuracy': 0.372650262566318, 'macro avg': {'precision': 0.37136221364336786, 'recall': 0.3704482558069551, 'f1-score': 0.3625126677008932, 'support': 443507}, 'weighted avg': {'precision': 0.3714174996847419, 'recall': 0.372650262566318, 'f1-score': 0.36379371823166884, 'support': 443507}}
[[31169 58023 54310]
 [29388 66192 55512]
 [24826 56175 67912]]
Evaluating performance on  train set...
765/765 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918937
{'0': {'precision': 0.3674457780585386, 'recall': 0.2172728829123282, 'f1-score': 0.2730749293350156, 'support': 64251}, '1': {'precision': 0.3591420064410281, 'recall': 0.45740465577018324, 'f1-score': 0.402360902153268, 'support': 64608}, '2': {'precision': 0.3869540450673626, 'recall': 0.4365891936327629, 'f1-score': 0.4102758581942806, 'support': 66905}, 'accuracy': 0.3714779019635888, 'macro avg': {'precision': 0.3711806098556431, 'recall': 0.37042224410509145, 'f1-score': 0.36190389656085475, 'support': 195764}, 'weighted avg': {'precision': 0.3713724986382225, 'recall': 0.3714779019635888, 'f1-score': 0.36263346040901684, 'support': 195764}}
[[13960 26150 24141]
 [12920 29552 22136]
 [11112 26583 29210]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925813
{'0': {'precision': 0.38264747300891877, 'recall': 0.2285086899644926, 'f1-score': 0.286140525361259, 'support': 21404}, '1': {'precision': 0.36307968038234634, 'recall': 0.44446475911874944, 'f1-score': 0.39967118783394984, 'support': 21878}, '2': {'precision': 0.37250536693965175, 'recall': 0.43711513342041425, 'f1-score': 0.4022322386778278, 'support': 21436}, 'accuracy': 0.3706078679810872, 'macro avg': {'precision': 0.37274417344363897, 'recall': 0.3700295275012188, 'f1-score': 0.3626813172910122, 'support': 64718}, 'weighted avg': {'precision': 0.3726732718162837, 'recall': 0.3706078679810872, 'f1-score': 0.3629717902370509, 'support': 64718}}
[[4891 8525 7988]
 [4358 9724 7796]
 [3533 8533 9370]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/EXC
Evaluating performance on  test set...
4693/4693 - 56s - 56s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0448393
{'0': {'precision': 0.5111101645582201, 'recall': 0.3790959113287523, 'f1-score': 0.43531442633556744, 'support': 379830}, '1': {'precision': 0.39628454957870296, 'recall': 0.5884760353917806, 'f1-score': 0.4736256998549196, 'support': 439085}, '2': {'precision': 0.4883763540977231, 'recall': 0.34165724928846475, 'f1-score': 0.40204955818137883, 'support': 382272}, 'accuracy': 0.4437185883630109, 'macro avg': {'precision': 0.46525702274488207, 'recall': 0.4364097320029992, 'f1-score': 0.4369965614572886, 'support': 1201187}, 'weighted avg': {'precision': 0.46190158642206286, 'recall': 0.4437185883630109, 'f1-score': 0.43873244355870317, 'support': 1201187}}
[[143992 189028  46810]
 [ 90681 258391  90013]
 [ 47051 204615 130606]]
Evaluating performance on  train set...
1497/1497 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0569164
{'0': {'precision': 0.5261040068201194, 'recall': 0.3622871903252319, 'f1-score': 0.4290919204561257, 'support': 127755}, '1': {'precision': 0.36119208658232455, 'recall': 0.5987367786268022, 'f1-score': 0.45057294185789615, 'support': 126027}, '2': {'precision': 0.4885117432936867, 'recall': 0.32574246710882304, 'f1-score': 0.39085833008700177, 'support': 129366}, 'accuracy': 0.42772244667856807, 'macro avg': {'precision': 0.4586026122320435, 'recall': 0.4289221453536191, 'f1-score': 0.4235077308003412, 'support': 383148}, 'weighted avg': {'precision': 0.45916769151854125, 'recall': 0.42772244667856807, 'f1-score': 0.4232483874936904, 'support': 383148}}
[[46284 63713 17758]
 [24206 75457 26364]
 [17485 69741 42140]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.05023
{'0': {'precision': 0.5364717729246649, 'recall': 0.36946015647010383, 'f1-score': 0.4375713864041786, 'support': 46143}, '1': {'precision': 0.36797362504105297, 'recall': 0.6174045736811987, 'f1-score': 0.461119597305875, 'support': 47183}, '2': {'precision': 0.5089826577590086, 'recall': 0.31616745866213686, 'f1-score': 0.39004721735901116, 'support': 46507}, 'accuracy': 0.43539793897005713, 'macro avg': {'precision': 0.4711426852415755, 'recall': 0.4343440629378131, 'f1-score': 0.42957940035635495, 'support': 139833}, 'weighted avg': {'precision': 0.4704738726393128, 'recall': 0.43539793897005713, 'f1-score': 0.4297110723523535, 'support': 139833}}
[[17048 23882  5213]
 [ 9080 29131  8972]
 [ 5650 26153 14704]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/AAL
Evaluating performance on  test set...
6677/6677 - 80s - 80s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0379179
{'0': {'precision': 0.43895312088015287, 'recall': 0.2704526943122794, 'f1-score': 0.33469151697500055, 'support': 449354}, '1': {'precision': 0.5069015614453092, 'recall': 0.6849293720984454, 'f1-score': 0.5826191591858209, 'support': 827789}, '2': {'precision': 0.39206447810643347, 'recall': 0.2847955977025857, 'f1-score': 0.32993004424677935, 'support': 432138}, 'accuracy': 0.47480607343087533, 'macro avg': {'precision': 0.44597305347729854, 'recall': 0.41339255470443687, 'f1-score': 0.4157469068025336, 'support': 1709281}, 'weighted avg': {'precision': 0.46000560280444774, 'recall': 0.47480607343087533, 'f1-score': 0.45355679525061743, 'support': 1709281}}
[[121529 277684  50141]
 [120119 566977 140693]
 [ 35213 273854 123071]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0771194
{'0': {'precision': 0.4712119982140683, 'recall': 0.23851886855446378, 'f1-score': 0.3167199227928263, 'support': 194689}, '1': {'precision': 0.3509628620291709, 'recall': 0.66117295753988, 'f1-score': 0.45852967356355245, 'support': 190885}, '2': {'precision': 0.4425164487313346, 'recall': 0.27632634264218114, 'f1-score': 0.34021055313998116, 'support': 193257}, 'accuracy': 0.3905233133678051, 'macro avg': {'precision': 0.42156376965819126, 'recall': 0.3920060562455083, 'f1-score': 0.37182004983211997, 'support': 578831}, 'weighted avg': {'precision': 0.4219759134725137, 'recall': 0.3905233133678051, 'f1-score': 0.3713284061409368, 'support': 578831}}
[[ 46437 115848  32404]
 [ 29805 126208  34872]
 [ 22306 117549  53402]]
Evaluating performance on  val set...
827/827 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0701907
{'0': {'precision': 0.4688568331526724, 'recall': 0.24956357073112997, 'f1-score': 0.3257412646152955, 'support': 67594}, '1': {'precision': 0.37451162247230396, 'recall': 0.676851399685879, 'f1-score': 0.4822096850023507, 'support': 75767}, '2': {'precision': 0.4415036738073062, 'recall': 0.2502089350908318, 'f1-score': 0.3194048008984137, 'support': 68203}, 'accuracy': 0.40279537161331797, 'macro avg': {'precision': 0.42829070981076084, 'recall': 0.39220796850261364, 'f1-score': 0.37578525017202, 'support': 211564}, 'weighted avg': {'precision': 0.42625118614065016, 'recall': 0.40279537161331797, 'f1-score': 0.37973427369332163, 'support': 211564}}
[[16869 41971  8754]
 [11651 51283 12833]
 [ 7459 43679 17065]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/WBA
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0521121
{'0': {'precision': 0.3651765375854214, 'recall': 0.2628626981752917, 'f1-score': 0.305685646737485, 'support': 361044}, '1': {'precision': 0.5076358795574402, 'recall': 0.6229538629382693, 'f1-score': 0.5594137647813897, 'support': 700283}, '2': {'precision': 0.3666566432200684, 'recall': 0.310839364839081, 'f1-score': 0.3364486778868377, 'support': 380502}, 'accuracy': 0.45041679699881193, 'macro avg': {'precision': 0.41315635345430995, 'recall': 0.3988853086508806, 'f1-score': 0.40051602980190415, 'support': 1441829}, 'weighted avg': {'precision': 0.4347583246963656, 'recall': 0.45041679699881193, 'f1-score': 0.43703748011476534, 'support': 1441829}}
[[ 94905 205765  60374]
 [120111 436244 143928]
 [ 44872 217355 118275]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0864232
{'0': {'precision': 0.42468966135368896, 'recall': 0.23064317237798546, 'f1-score': 0.2989374733842603, 'support': 123264}, '1': {'precision': 0.3451474785918173, 'recall': 0.5432864491762714, 'f1-score': 0.4221224386541867, 'support': 122856}, '2': {'precision': 0.4035484852280658, 'recall': 0.3580370396831067, 'f1-score': 0.37943290751622577, 'support': 125973}, 'accuracy': 0.37699983606248977, 'macro avg': {'precision': 0.39112854172452405, 'recall': 0.3773222204124545, 'f1-score': 0.3668309398515576, 'support': 372093}, 'weighted avg': {'precision': 0.39126938259148264, 'recall': 0.37699983606248977, 'f1-score': 0.3668620605630252, 'support': 372093}}
[[28430 62884 31950]
 [21397 66746 34713]
 [17116 63754 45103]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0887502
{'0': {'precision': 0.45118557711150303, 'recall': 0.23419794527515003, 'f1-score': 0.3083433775277889, 'support': 49155}, '1': {'precision': 0.3130238092125047, 'recall': 0.5681974605434912, 'f1-score': 0.4036655482304541, 'support': 42135}, '2': {'precision': 0.4265812135009403, 'recall': 0.3372261345852895, 'f1-score': 0.37667700913341784, 'support': 51120}, 'accuracy': 0.3700021065936381, 'macro avg': {'precision': 0.3969301999416494, 'recall': 0.37987384680131026, 'f1-score': 0.3628953116305536, 'support': 142410}, 'weighted avg': {'precision': 0.4014754362632743, 'recall': 0.3700021065936381, 'f1-score': 0.3610757341757529, 'support': 142410}}
[[11512 25578 12065]
 [ 7086 23941 11108]
 [ 6917 26964 17239]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
11876/11876 - 139s - 139s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017597
{'0': {'precision': 0.5045648785883062, 'recall': 0.17295228444940747, 'f1-score': 0.25760424433684165, 'support': 1160586}, '1': {'precision': 0.24151805218807107, 'recall': 0.5697127547030956, 'f1-score': 0.33922753833743796, 'support': 695712}, '2': {'precision': 0.4526697635211055, 'recall': 0.3828396359016637, 'f1-score': 0.41483657172460414, 'support': 1183856}, 'accuracy': 0.345478880346193, 'macro avg': {'precision': 0.3995842314324943, 'recall': 0.3751682250180555, 'f1-score': 0.3372227847996279, 'support': 3040154}, 'weighted avg': {'precision': 0.4241606697779774, 'recall': 0.345478880346193, 'f1-score': 0.3375103080716754, 'support': 3040154}}
[[200726 628624 331236]
 [ 82588 396356 216768]
 [114506 616123 453227]]
Evaluating performance on  train set...
2538/2538 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0872313
{'0': {'precision': 0.4732794146814466, 'recall': 0.19311560319401483, 'f1-score': 0.2743046907430469, 'support': 222416}, '1': {'precision': 0.3362342051650435, 'recall': 0.6840276945928464, 'f1-score': 0.4508519003931848, 'support': 208705}, '2': {'precision': 0.4175671147186953, 'recall': 0.25662347885383724, 'f1-score': 0.3178849620735399, 'support': 218503}, 'accuracy': 0.3721922219622428, 'macro avg': {'precision': 0.40902691152172843, 'recall': 0.37792225888023284, 'f1-score': 0.3476805177365905, 'support': 649624}, 'weighted avg': {'precision': 0.41051183661954926, 'recall': 0.3721922219622428, 'f1-score': 0.3456824499030514, 'support': 649624}}
[[ 42952 141805  37659]
 [ 25392 142760  40553]
 [ 22410 140020  56073]]
Evaluating performance on  val set...
795/795 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0866205
{'0': {'precision': 0.461145812344684, 'recall': 0.1998719142990219, 'f1-score': 0.2788732966430414, 'support': 68704}, '1': {'precision': 0.3342431854823591, 'recall': 0.6823895038197155, 'f1-score': 0.44870491357701564, 'support': 65319}, '2': {'precision': 0.4284721705253232, 'recall': 0.24877177311299686, 'f1-score': 0.3147810551646188, 'support': 69409}, 'accuracy': 0.3714853120453026, 'macro avg': {'precision': 0.4079537227841221, 'recall': 0.3770110637439114, 'f1-score': 0.3474530884615586, 'support': 203432}, 'weighted avg': {'precision': 0.40925133414528464, 'recall': 0.3714853120453026, 'f1-score': 0.34565508612421664, 'support': 203432}}
[[13732 43856 11116]
 [ 8830 44573 11916]
 [ 7216 44926 17267]]
testing model on single stock: results/universal/W0/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
19053/19053 - 226s - 226s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0742171
{'0': {'precision': 0.35715417563884133, 'recall': 0.21074467622457707, 'f1-score': 0.2650765743240687, 'support': 1379660}, '1': {'precision': 0.4536175637800617, 'recall': 0.5730609464997412, 'f1-score': 0.5063912565538438, 'support': 2149541}, '2': {'precision': 0.3401141999032506, 'recall': 0.3400049694232131, 'f1-score': 0.340059575891756, 'support': 1348245}, 'accuracy': 0.4061519081912952, 'macro avg': {'precision': 0.38362864644071787, 'recall': 0.37460353071584374, 'f1-score': 0.3705091355898895, 'support': 4877446}, 'weighted avg': {'precision': 0.3949563257237086, 'recall': 0.4061519081912952, 'f1-score': 0.39215358559256847, 'support': 4877446}}
[[ 290756  756680  332224]
 [ 360545 1231818  557178]
 [ 162790  727045  458410]]
Evaluating performance on  train set...
4812/4812 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944412
{'0': {'precision': 0.3844185216045709, 'recall': 0.1898337962350659, 'f1-score': 0.2541587557671687, 'support': 408294}, '1': {'precision': 0.3409653125171788, 'recall': 0.4890778044723711, 'f1-score': 0.40180699781463797, 'support': 405825}, '2': {'precision': 0.38083729980742237, 'recall': 0.4085357679749514, 'f1-score': 0.3942005753690758, 'support': 417748}, 'accuracy': 0.3625821618729944, 'macro avg': {'precision': 0.3687403779763907, 'recall': 0.3624824562274627, 'f1-score': 0.3500554429836275, 'support': 1231867}, 'weighted avg': {'precision': 0.3688888850275654, 'recall': 0.3625821618729944, 'f1-score': 0.3502905117797672, 'support': 1231867}}
[[ 77508 193778 137008]
 [ 66887 198480 140458]
 [ 57229 189854 170665]]
Evaluating performance on  val set...
1767/1767 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926468
{'0': {'precision': 0.3813935847420893, 'recall': 0.19130316619105855, 'f1-score': 0.25480081808474053, 'support': 147180}, '1': {'precision': 0.35631973130525424, 'recall': 0.4694714488266075, 'f1-score': 0.4051434418921106, 'support': 157279}, '2': {'precision': 0.36833192209991533, 'recall': 0.4266609846178822, 'f1-score': 0.3953566358174621, 'support': 147834}, 'accuracy': 0.36496032439148957, 'macro avg': {'precision': 0.36868174604908627, 'recall': 0.3624785332118494, 'f1-score': 0.3517669652647711, 'support': 452293}, 'weighted avg': {'precision': 0.3684052156323858, 'recall': 0.36496032439148957, 'f1-score': 0.3530218082139234, 'support': 452293}}
[[28156 68424 50600]
 [25871 73838 57570]
 [19797 64962 63075]]
training model: results/universal/W0/deepOF_L2/h200
Epoch 1/50
8838/8838 - 245s - loss: 3.2571 - accuracy200: 0.3882 - val_loss: 3.2729 - val_accuracy200: 0.3647 - 245s/epoch - 28ms/step
Epoch 2/50
8838/8838 - 244s - loss: 3.2380 - accuracy200: 0.4002 - val_loss: 3.2756 - val_accuracy200: 0.3584 - 244s/epoch - 28ms/step
Epoch 3/50
8838/8838 - 245s - loss: 3.2291 - accuracy200: 0.4048 - val_loss: 3.2761 - val_accuracy200: 0.3565 - 245s/epoch - 28ms/step
Epoch 4/50
8838/8838 - 246s - loss: 3.2243 - accuracy200: 0.4077 - val_loss: 3.2755 - val_accuracy200: 0.3572 - 246s/epoch - 28ms/step
Epoch 5/50
8838/8838 - 243s - loss: 3.2212 - accuracy200: 0.4096 - val_loss: 3.2753 - val_accuracy200: 0.3558 - 243s/epoch - 28ms/step
Epoch 6/50
8838/8838 - 252s - loss: 3.2190 - accuracy200: 0.4106 - val_loss: 3.2769 - val_accuracy200: 0.3548 - 252s/epoch - 28ms/step
Epoch 7/50
8838/8838 - 251s - loss: 3.2171 - accuracy200: 0.4118 - val_loss: 3.2778 - val_accuracy200: 0.3538 - 251s/epoch - 28ms/step
Epoch 8/50
8838/8838 - 250s - loss: 3.2151 - accuracy200: 0.4129 - val_loss: 3.2802 - val_accuracy200: 0.3547 - 250s/epoch - 28ms/step
Epoch 9/50
8838/8838 - 251s - loss: 3.2134 - accuracy200: 0.4139 - val_loss: 3.2825 - val_accuracy200: 0.3555 - 251s/epoch - 28ms/step
Epoch 10/50
8838/8838 - 249s - loss: 3.2120 - accuracy200: 0.4148 - val_loss: 3.2849 - val_accuracy200: 0.3562 - 249s/epoch - 28ms/step
Epoch 11/50
8838/8838 - 251s - loss: 3.2104 - accuracy200: 0.4157 - val_loss: 3.2869 - val_accuracy200: 0.3563 - 251s/epoch - 28ms/step
testing model in sample: results/universal/W0/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 394s - 394s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0791472
{'0': {'precision': 0.33884398558836704, 'recall': 0.3247509671010752, 'f1-score': 0.3316478269469385, 'support': 2287248}, '1': {'precision': 0.4678255914997545, 'recall': 0.5126822920139409, 'f1-score': 0.48922787984809035, 'support': 3824427}, '2': {'precision': 0.3339114902021532, 'recall': 0.29511506510208874, 'f1-score': 0.31331685550757654, 'support': 2337329}, 'accuracy': 0.4016192914573126, 'macro avg': {'precision': 0.38019368909675827, 'recall': 0.3775161080723683, 'f1-score': 0.37806418743420184, 'support': 8449004}, 'weighted avg': {'precision': 0.39586276219710176, 'recall': 0.4016192914573126, 'f1-score': 0.3979050920438897, 'support': 8449004}}
[[ 742786 1075173  469289]
 [ 957021 1960716  906690]
 [ 492311 1155237  689781]]
Evaluating performance on  train set...
8838/8838 - 108s - 108s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923893
{'0': {'precision': 0.38000865878418727, 'recall': 0.33933632483076176, 'f1-score': 0.3585226688526345, 'support': 750126}, '1': {'precision': 0.33874272264123645, 'recall': 0.46305721505050196, 'f1-score': 0.3912628434879755, 'support': 748387}, '2': {'precision': 0.3811451360705564, 'recall': 0.284124350241568, 'f1-score': 0.325560141752761, 'support': 763553}, 'accuracy': 0.3616318003099821, 'macro avg': {'precision': 0.36663217249866004, 'recall': 0.36217263004094385, 'f1-score': 0.358448551364457, 'support': 2262066}, 'weighted avg': {'precision': 0.3667397579162305, 'recall': 0.3616318003099821, 'f1-score': 0.358228108313786, 'support': 2262066}}
[[254545 327956 167625]
 [217220 346546 184621]
 [198075 348534 216944]]
Evaluating performance on  val set...
3279/3279 - 39s - 39s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0909293
{'0': {'precision': 0.37879969456223295, 'recall': 0.3392171910974674, 'f1-score': 0.3579173998391978, 'support': 274933}, '1': {'precision': 0.34730841579257266, 'recall': 0.4665828978638955, 'f1-score': 0.3982059136741579, 'support': 285707}, '2': {'precision': 0.3828934515715079, 'recall': 0.28740197100282494, 'f1-score': 0.3283457680289399, 'support': 278234}, 'accuracy': 0.36541006158254996, 'macro avg': {'precision': 0.3696671873087712, 'recall': 0.3644006866547293, 'f1-score': 0.36148969384743185, 'support': 838874}, 'weighted avg': {'precision': 0.3694320703472439, 'recall': 0.36541006158254996, 'f1-score': 0.36183083262785215, 'support': 838874}}
[[ 93262 121984  59687]
 [ 83209 133306  69192]
 [ 69733 128536  79965]]
testing model out of sample: results/universal/W0/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 271s - 271s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904192
{'0': {'precision': 0.3898288054519398, 'recall': 0.27381790737988465, 'f1-score': 0.32168352733873934, 'support': 1941155}, '1': {'precision': 0.33358242097677654, 'recall': 0.5126337570755414, 'f1-score': 0.40416530478836415, 'support': 1929711}, '2': {'precision': 0.3950169251933714, 'recall': 0.3027890923472737, 'f1-score': 0.34280821097718633, 'support': 1962072}, 'accuracy': 0.36257062907234744, 'macro avg': {'precision': 0.37280938387402923, 'recall': 0.3630802522675666, 'f1-score': 0.3562190143680966, 'support': 5832938}, 'weighted avg': {'precision': 0.3729659822306675, 'recall': 0.36257062907234744, 'f1-score': 0.35607685425562896, 'support': 5832938}}
[[ 531523  970121  439511]
 [ 470110  989235  470366]
 [ 361845 1006133  594094]]
Evaluating performance on  train set...
6334/6334 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0915613
{'0': {'precision': 0.3820520437699939, 'recall': 0.2893744421303184, 'f1-score': 0.3293170566020966, 'support': 537760}, '1': {'precision': 0.34253309258749953, 'recall': 0.5236758974208975, 'f1-score': 0.41416407986108594, 'support': 547012}, '2': {'precision': 0.3821665504875547, 'recall': 0.2689472506155338, 'f1-score': 0.3157132988326175, 'support': 536120}, 'accuracy': 0.3616891193244214, 'macro avg': {'precision': 0.3689172289483494, 'recall': 0.36066586338891654, 'f1-score': 0.35306481176526666, 'support': 1620892}, 'weighted avg': {'precision': 0.3687532236247776, 'recall': 0.3616891193244214, 'f1-score': 0.3534513562788012, 'support': 1620892}}
[[155614 270749 111397]
 [138849 286457 121706]
 [112848 279084 144188]]
Evaluating performance on  val set...
2156/2156 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0890012
{'0': {'precision': 0.3767030674088666, 'recall': 0.3095470414718473, 'f1-score': 0.33983913013864037, 'support': 177301}, '1': {'precision': 0.3580524581855043, 'recall': 0.5221508754099875, 'f1-score': 0.4248050361740111, 'support': 194823}, '2': {'precision': 0.3818555852705205, 'recall': 0.2589478030869502, 'f1-score': 0.30861467557385175, 'support': 179206}, 'accuracy': 0.3682277401918996, 'macro avg': {'precision': 0.3722037036216305, 'recall': 0.3635485733229283, 'f1-score': 0.35775294729550106, 'support': 551330}, 'weighted avg': {'precision': 0.3717873081996679, 'recall': 0.3682277401918996, 'f1-score': 0.3597141652479062, 'support': 551330}}
[[ 54883  88396  34022]
 [ 51998 101727  41098]
 [ 38812  93989  46405]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970902
{'0': {'precision': 0.33772322678161565, 'recall': 0.33883287932825973, 'f1-score': 0.33827714305740525, 'support': 71218}, '1': {'precision': 0.3588407879767679, 'recall': 0.3792365909838763, 'f1-score': 0.3687568838105083, 'support': 79014}, '2': {'precision': 0.34676918185365574, 'recall': 0.32460293839119025, 'f1-score': 0.3353201361181182, 'support': 73918}, 'accuracy': 0.34838277938880213, 'macro avg': {'precision': 0.34777773220401315, 'recall': 0.34755746956777545, 'f1-score': 0.3474513876620106, 'support': 224150}, 'weighted avg': {'precision': 0.34815035989465964, 'recall': 0.34838277938880213, 'f1-score': 0.3480462717521519, 'support': 224150}}
[[24131 26157 20930]
 [24780 29965 24269]
 [22541 27383 23994]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976126
{'0': {'precision': 0.35852660300136424, 'recall': 0.38140851202786547, 'f1-score': 0.36961375503243615, 'support': 27561}, '1': {'precision': 0.3414490621552041, 'recall': 0.3462757823281489, 'f1-score': 0.34384548434288253, 'support': 26811}, '2': {'precision': 0.34978757839368807, 'recall': 0.3219379585148773, 'f1-score': 0.33528544834005586, 'support': 26853}, 'accuracy': 0.3501508156355802, 'macro avg': {'precision': 0.3499210811834188, 'recall': 0.3498740842902972, 'f1-score': 0.3495815625717915, 'support': 81225}, 'weighted avg': {'precision': 0.3500004721867588, 'recall': 0.3501508156355802, 'f1-score': 0.3497591397653619, 'support': 81225}}
[[10512  9090  7959]
 [ 9416  9284  8111]
 [ 9392  8816  8645]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976881
{'0': {'precision': 0.35007593838142764, 'recall': 0.36989912883998166, 'f1-score': 0.3597146360494927, 'support': 8724}, '1': {'precision': 0.35098958929184304, 'recall': 0.3343140459845265, 'f1-score': 0.3424489340328162, 'support': 9177}, '2': {'precision': 0.34485587063510664, 'recall': 0.34252793296089384, 'f1-score': 0.3436879598271634, 'support': 8592}, 'accuracy': 0.34869588193107615, 'macro avg': {'precision': 0.3486404661027924, 'recall': 0.34891370259513405, 'f1-score': 0.3486171766364907, 'support': 26493}, 'weighted avg': {'precision': 0.3486994899734894, 'recall': 0.34869588193107615, 'f1-score': 0.34853626630996554, 'support': 26493}}
[[3227 2867 2630]
 [3148 3068 2961]
 [2843 2806 2943]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
2359/2359 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0797979
{'0': {'precision': 0.3732471165585994, 'recall': 0.36073734197155344, 'f1-score': 0.36688562315209955, 'support': 174573}, '1': {'precision': 0.3726676548368232, 'recall': 0.45649176871299973, 'f1-score': 0.4103426001486308, 'support': 221958}, '2': {'precision': 0.4216561056024709, 'recall': 0.33198714608302937, 'f1-score': 0.3714871905623195, 'support': 207252}, 'accuracy': 0.3860691672339234, 'macro avg': {'precision': 0.38919029233263114, 'recall': 0.3830720855891942, 'f1-score': 0.38290513795434994, 'support': 603783}, 'weighted avg': {'precision': 0.38965076428051015, 'recall': 0.3860691672339234, 'f1-score': 0.3844404528659189, 'support': 603783}}
[[ 62975  74206  37392]
 [ 63655 101322  56981]
 [ 42092  96355  68805]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0883315
{'0': {'precision': 0.40102184345523745, 'recall': 0.38183680302522993, 'f1-score': 0.39119424518498336, 'support': 50773}, '1': {'precision': 0.33158108168997164, 'recall': 0.4418758256274769, 'f1-score': 0.37886445346352854, 'support': 49962}, '2': {'precision': 0.3928281953100981, 'recall': 0.28127439012187555, 'f1-score': 0.3278210570508933, 'support': 49969}, 'accuracy': 0.36839765367873445, 'macro avg': {'precision': 0.37514370681843573, 'recall': 0.3683290062581941, 'f1-score': 0.36595991856646837, 'support': 150704}, 'weighted avg': {'precision': 0.3752837891004713, 'recall': 0.36839765367873445, 'f1-score': 0.3660939433226593, 'support': 150704}}
[[19387 21463  9923]
 [16084 22077 11801]
 [12873 23041 14055]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0890163
{'0': {'precision': 0.41426066627703095, 'recall': 0.359559681428499, 'f1-score': 0.3849767808163377, 'support': 19713}, '1': {'precision': 0.29820137214908216, 'recall': 0.4621795608690654, 'f1-score': 0.3625092982891148, 'support': 17398}, '2': {'precision': 0.44133206728160607, 'recall': 0.2997512437810945, 'f1-score': 0.3570174476023263, 'support': 21708}, 'accuracy': 0.36784032370492525, 'macro avg': {'precision': 0.3845980352359064, 'recall': 0.37383016202621966, 'f1-score': 0.36816784223592625, 'support': 58819}, 'weighted avg': {'precision': 0.38992272060929206, 'recall': 0.36784032370492525, 'f1-score': 0.36801235662656256, 'support': 58819}}
[[ 7088  8676  3949]
 [ 5069  8041  4288]
 [ 4953 10248  6507]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
1625/1625 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0831797
{'0': {'precision': 0.28029430942740075, 'recall': 0.33027270571496326, 'f1-score': 0.3032379990245942, 'support': 105425}, '1': {'precision': 0.4770636695127624, 'recall': 0.4884464110127827, 'f1-score': 0.48268794267017895, 'support': 195264}, '2': {'precision': 0.3158124318429662, 'recall': 0.2514827583212484, 'f1-score': 0.2800001933702993, 'support': 115157}, 'accuracy': 0.38272581676870765, 'macro avg': {'precision': 0.3577234702610432, 'recall': 0.35673395834966476, 'f1-score': 0.3553087116883575, 'support': 415846}, 'weighted avg': {'precision': 0.3825247811662592, 'recall': 0.38272581676870765, 'f1-score': 0.381065170165545, 'support': 415846}}
[[34819 48832 21774]
 [58922 95376 40966]
 [30482 55715 28960]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940248
{'0': {'precision': 0.3667130653129179, 'recall': 0.35548735315906443, 'f1-score': 0.3610129643312957, 'support': 37796}, '1': {'precision': 0.33826013513513514, 'recall': 0.4625561067800614, 'f1-score': 0.3907620325302408, 'support': 38097}, '2': {'precision': 0.383970351514244, 'recall': 0.25930982176715967, 'f1-score': 0.3095611758314722, 'support': 39555}, 'accuracy': 0.35786674520130274, 'macro avg': {'precision': 0.3629811839874324, 'recall': 0.3591177605687618, 'f1-score': 0.3537787242310029, 'support': 115448}, 'weighted avg': {'precision': 0.36323652760512276, 'recall': 0.35786674520130274, 'f1-score': 0.3532014366917064, 'support': 115448}}
[[13436 16313  8047]
 [12066 17622  8409]
 [11137 18161 10257]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904183
{'0': {'precision': 0.3744614179396788, 'recall': 0.3889340927583401, 'f1-score': 0.3815605667531431, 'support': 14748}, '1': {'precision': 0.36582518604990516, 'recall': 0.4704741648942825, 'f1-score': 0.41160213435490495, 'support': 15986}, '2': {'precision': 0.37043045641358424, 'recall': 0.23802904996872612, 'f1-score': 0.28982441294690076, 'support': 14389}, 'accuracy': 0.36970059614830575, 'macro avg': {'precision': 0.3702390201343894, 'recall': 0.3658124358737829, 'f1-score': 0.36099570468498293, 'support': 45123}, 'weighted avg': {'precision': 0.37011639858394235, 'recall': 0.36970059614830575, 'f1-score': 0.3629503897383999, 'support': 45123}}
[[5736 6348 2664]
 [5308 7521 3157]
 [4274 6690 3425]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1269/1269 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103651
{'0': {'precision': 0.31993114271595285, 'recall': 0.5772358520144223, 'f1-score': 0.4116864013863801, 'support': 102064}, '1': {'precision': 0.36515140770158144, 'recall': 0.1326469274894377, 'f1-score': 0.1946017448269346, 'support': 116452}, '2': {'precision': 0.3356017374144262, 'recall': 0.3105333998475194, 'f1-score': 0.3225812759716451, 'support': 106243}, 'accuracy': 0.33056512675553257, 'macro avg': {'precision': 0.3402280959439869, 'recall': 0.34013872645045984, 'f1-score': 0.3096231407283199, 'support': 324759}, 'weighted avg': {'precision': 0.341272756930359, 'recall': 0.33056512675553257, 'f1-score': 0.3046940216059945, 'support': 324759}}
[[58915 12501 30648]
 [66338 15447 34667]
 [58896 14355 32992]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003577
{'0': {'precision': 0.34047345946020646, 'recall': 0.5993528925217729, 'f1-score': 0.434258418747301, 'support': 41106}, '1': {'precision': 0.32990416373382425, 'recall': 0.14868228404099562, 'f1-score': 0.20498242190785382, 'support': 40980}, '2': {'precision': 0.3580361416945907, 'recall': 0.2837933978372225, 'f1-score': 0.3166208064345433, 'support': 42168}, 'accuracy': 0.34362676453071933, 'macro avg': {'precision': 0.34280458829620714, 'recall': 0.34394285813333036, 'f1-score': 0.3186205490298994, 'support': 124254}, 'weighted avg': {'precision': 0.34294785421282914, 'recall': 0.3436267645307193, 'f1-score': 0.3187186921671916, 'support': 124254}}
[[24637  6114 10355]
 [23785  6093 11102]
 [23939  6262 11967]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008178
{'0': {'precision': 0.33283096692313796, 'recall': 0.5736942849330052, 'f1-score': 0.42126399277144727, 'support': 14628}, '1': {'precision': 0.31686252300722073, 'recall': 0.14963894089328697, 'f1-score': 0.2032789863299877, 'support': 14956}, '2': {'precision': 0.38158888385440265, 'recall': 0.31710072168183245, 'f1-score': 0.3463687150837989, 'support': 15935}, 'accuracy': 0.34453744590171137, 'macro avg': {'precision': 0.34376079126158715, 'recall': 0.3468113158360415, 'f1-score': 0.32363723139507794, 'support': 45519}, 'weighted avg': {'precision': 0.3446531369860401, 'recall': 0.34453744590171137, 'f1-score': 0.32342265165474554, 'support': 45519}}
[[8392 2266 3970]
 [8499 2238 4219]
 [8323 2559 5053]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
1733/1733 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912753
{'0': {'precision': 0.3432157599758365, 'recall': 0.3739587675610844, 'f1-score': 0.35792833593492973, 'support': 136737}, '1': {'precision': 0.3922115895800106, 'recall': 0.43543805717798956, 'f1-score': 0.41269600787819105, 'support': 162650}, '2': {'precision': 0.3620311375563864, 'recall': 0.2862336941437691, 'f1-score': 0.31970116171832014, 'support': 144120}, 'accuracy': 0.367998701260634, 'macro avg': {'precision': 0.36581949570407785, 'recall': 0.36521017296094765, 'f1-score': 0.36344183517714695, 'support': 443507}, 'weighted avg': {'precision': 0.36729845518025894, 'recall': 0.367998701260634, 'f1-score': 0.36559148779831335, 'support': 443507}}
[[51134 52548 33055]
 [52187 70824 39639]
 [45664 57204 41252]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944424
{'0': {'precision': 0.3494700525285177, 'recall': 0.3526764009347407, 'f1-score': 0.3510659058443332, 'support': 63761}, '1': {'precision': 0.351535373931887, 'recall': 0.4422397769516729, 'f1-score': 0.3917051955713482, 'support': 64560}, '2': {'precision': 0.37850597609561754, 'recall': 0.2817342051806711, 'f1-score': 0.3230281444709843, 'support': 67443}, 'accuracy': 0.3577726241801353, 'macro avg': {'precision': 0.35983713418534075, 'recall': 0.3588834610223615, 'f1-score': 0.3552664152955553, 'support': 195764}, 'weighted avg': {'precision': 0.36015438132716016, 'recall': 0.3577726241801353, 'f1-score': 0.35480878913479175, 'support': 195764}}
[[22487 25322 15952]
 [20762 28551 15247]
 [21097 27345 19001]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939499
{'0': {'precision': 0.35612961704056195, 'recall': 0.3733726123728975, 'f1-score': 0.36454733130755496, 'support': 21046}, '1': {'precision': 0.36878373722292407, 'recall': 0.43108386288373757, 'f1-score': 0.3975075824788, 'support': 22346}, '2': {'precision': 0.3612992983305105, 'recall': 0.280080652724374, 'f1-score': 0.31554757250779225, 'support': 21326}, 'accuracy': 0.36255755740288637, 'macro avg': {'precision': 0.3620708841979989, 'recall': 0.36151237599366964, 'f1-score': 0.35920082876471576, 'support': 64718}, 'weighted avg': {'precision': 0.3622023880283012, 'recall': 0.36255755740288637, 'f1-score': 0.3597814379936222, 'support': 64718}}
[[7858 8046 5142]
 [7296 9633 5417]
 [6911 8442 5973]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/EXC
Evaluating performance on  test set...
4693/4693 - 57s - 57s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0702453
{'0': {'precision': 0.38311998169184847, 'recall': 0.4491766593119275, 'f1-score': 0.41352696866455474, 'support': 350341}, '1': {'precision': 0.4183523169819469, 'recall': 0.43805805486525934, 'f1-score': 0.4279784744554268, 'support': 495359}, '2': {'precision': 0.3929140493617272, 'recall': 0.3003597881216472, 'f1-score': 0.3404587746876773, 'support': 355487}, 'accuracy': 0.4005496229979179, 'macro avg': {'precision': 0.39812878267850754, 'recall': 0.3958648340996113, 'f1-score': 0.3939880726025529, 'support': 1201187}, 'weighted avg': {'precision': 0.40054800756186715, 'recall': 0.4005496229979179, 'f1-score': 0.3978623722152112, 'support': 1201187}}
[[157365 136971  56005]
 [169393 216996 108970]
 [ 83988 164725 106774]]
Evaluating performance on  train set...
1497/1497 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0829568
{'0': {'precision': 0.41682987776051866, 'recall': 0.4361426485136854, 'f1-score': 0.4262676258992805, 'support': 127362}, '1': {'precision': 0.3362124837214937, 'recall': 0.436732863347391, 'f1-score': 0.3799364114568895, 'support': 127096}, '2': {'precision': 0.42129968156622244, 'recall': 0.2775817856865335, 'f1-score': 0.3346636687277497, 'support': 128690}, 'accuracy': 0.3830817334293798, 'macro avg': {'precision': 0.3914473476827449, 'recall': 0.3834857658492033, 'f1-score': 0.3802892353613066, 'support': 383148}, 'weighted avg': {'precision': 0.39158916330806715, 'recall': 0.3830817334293798, 'f1-score': 0.38013134101935314, 'support': 383148}}
[[55548 50664 21150]
 [43671 55507 27918]
 [34044 58924 35722]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0773219
{'0': {'precision': 0.4286037891268534, 'recall': 0.4513086280547304, 'f1-score': 0.43966327619168327, 'support': 46117}, '1': {'precision': 0.3476924554579071, 'recall': 0.4522267796539591, 'f1-score': 0.39312928740791686, 'support': 48029}, '2': {'precision': 0.432231634495209, 'recall': 0.27250640225884826, 'f1-score': 0.3342685693573721, 'support': 45687}, 'accuracy': 0.39320475138200567, 'macro avg': {'precision': 0.40284262635998985, 'recall': 0.3920139366558459, 'f1-score': 0.38902037765232406, 'support': 139833}, 'weighted avg': {'precision': 0.4019981590292244, 'recall': 0.39320475138200567, 'f1-score': 0.389244927744359, 'support': 139833}}
[[20813 18719  6585]
 [16540 21720  9769]
 [11207 22030 12450]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/AAL
Evaluating performance on  test set...
6677/6677 - 81s - 81s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0747873
{'0': {'precision': 0.3801182937725807, 'recall': 0.31326024447881673, 'f1-score': 0.3434659224912326, 'support': 499757}, '1': {'precision': 0.4388484738823622, 'recall': 0.5386532698276785, 'f1-score': 0.48365574166329306, 'support': 747440}, '2': {'precision': 0.3474745986173648, 'recall': 0.2857489114533288, 'f1-score': 0.31360329088700284, 'support': 462084}, 'accuracy': 0.4043834805394783, 'macro avg': {'precision': 0.3888137887574359, 'recall': 0.379220808586608, 'f1-score': 0.38024165168050944, 'support': 1709281}, 'weighted avg': {'precision': 0.396975180726307, 'recall': 0.4043834805394783, 'f1-score': 0.3966955752983228, 'support': 1709281}}
[[156554 259472  83731]
 [180601 402611 164228]
 [ 74701 255343 132040]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0890707
{'0': {'precision': 0.3983543389832932, 'recall': 0.2896386469010541, 'f1-score': 0.3354069419239115, 'support': 192388}, '1': {'precision': 0.34249966460746295, 'recall': 0.5447013223199273, 'f1-score': 0.4205586399355189, 'support': 196851}, '2': {'precision': 0.39090576889467915, 'recall': 0.2595468163213638, 'f1-score': 0.311962317021371, 'support': 189592}, 'accuracy': 0.3665249442410652, 'macro avg': {'precision': 0.3772532574951451, 'recall': 0.3646289285141151, 'f1-score': 0.35597596629360045, 'support': 578831}, 'weighted avg': {'precision': 0.37691934706717767, 'recall': 0.3665249442410652, 'f1-score': 0.3566865271236684, 'support': 578831}}
[[ 55723 100887  35778]
 [ 48730 107225  40896]
 [ 35430 104954  49208]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0849571
{'0': {'precision': 0.38456988651066504, 'recall': 0.31360313512698773, 'f1-score': 0.345479754580853, 'support': 66345}, '1': {'precision': 0.3671169412560839, 'recall': 0.5456479690522243, 'f1-score': 0.43892268674830015, 'support': 77550}, '2': {'precision': 0.3963601033199839, 'recall': 0.24717374277734266, 'f1-score': 0.30447446026140457, 'support': 67669}, 'accuracy': 0.3774129814146074, 'macro avg': {'precision': 0.3826823103622443, 'recall': 0.3688082823188516, 'f1-score': 0.36295896719685256, 'support': 211564}, 'weighted avg': {'precision': 0.381943524165356, 'recall': 0.3774129814146074, 'f1-score': 0.3666162056230094, 'support': 211564}}
[[20806 35021 10518]
 [20280 42315 14955]
 [13016 37927 16726]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/WBA
Evaluating performance on  test set...
5633/5633 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.08262
{'0': {'precision': 0.36182239512232334, 'recall': 0.32963025089262177, 'f1-score': 0.34497693390897205, 'support': 417310}, '1': {'precision': 0.40279567732828986, 'recall': 0.5073006035821441, 'f1-score': 0.44904807219848364, 'support': 569268}, '2': {'precision': 0.3811723201541122, 'recall': 0.2885968399849753, 'f1-score': 0.3284866895435254, 'support': 455251}, 'accuracy': 0.38682257049899815, 'macro avg': {'precision': 0.38193013086824185, 'recall': 0.3751758981532471, 'f1-score': 0.3741705652169937, 'support': 1441829}, 'weighted avg': {'precision': 0.38410926210549057, 'recall': 0.38682257049899815, 'f1-score': 0.3808599467448769, 'support': 1441829}}
[[137558 198825  80927]
 [148105 288790 132373]
 [ 94518 229349 131384]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092675
{'0': {'precision': 0.38383576143069686, 'recall': 0.31280261048588565, 'f1-score': 0.3446977169604907, 'support': 122889}, '1': {'precision': 0.3399340868422841, 'recall': 0.488374552554507, 'f1-score': 0.400853376781207, 'support': 122920}, '2': {'precision': 0.3822863135815417, 'recall': 0.2886430585030566, 'f1-score': 0.3289296768546342, 'support': 126284}, 'accuracy': 0.3626028976626811, 'macro avg': {'precision': 0.36868538728484085, 'recall': 0.3632734071811498, 'f1-score': 0.358160256865444, 'support': 372093}, 'weighted avg': {'precision': 0.36880708765131803, 'recall': 0.3626028976626811, 'f1-score': 0.3578971120806206, 'support': 372093}}
[[38440 56068 28381]
 [32371 60031 30518]
 [29336 60497 36451]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927427
{'0': {'precision': 0.38273109025869667, 'recall': 0.3127846626416693, 'f1-score': 0.3442407003718686, 'support': 47205}, '1': {'precision': 0.3365238927738928, 'recall': 0.49392721207715007, 'f1-score': 0.40030847616241794, 'support': 46766}, '2': {'precision': 0.38557058422368723, 'recall': 0.28012551869361463, 'f1-score': 0.32449689708361734, 'support': 48439}, 'accuracy': 0.3611614352924654, 'macro avg': {'precision': 0.3682751890854255, 'recall': 0.362279131137478, 'f1-score': 0.35634869120596796, 'support': 142410}, 'weighted avg': {'precision': 0.3685229338834129, 'recall': 0.3611614352924654, 'f1-score': 0.355937178955825, 'support': 142410}}
[[14765 21954 10486]
 [12530 23099 11137]
 [11283 23587 13569]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
11876/11876 - 142s - 142s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995853
{'0': {'precision': 0.43495769780940396, 'recall': 0.23344131033370036, 'f1-score': 0.3038218000904568, 'support': 1128018}, '1': {'precision': 0.24624906321205348, 'recall': 0.52372531841045, 'f1-score': 0.3349900259466983, 'support': 745343}, '2': {'precision': 0.43234488148936373, 'recall': 0.31479105548284914, 'f1-score': 0.3643200516580314, 'support': 1166793}, 'accuracy': 0.3358306848929363, 'macro avg': {'precision': 0.37118388083694037, 'recall': 0.35731922807566646, 'f1-score': 0.33437729256506216, 'support': 3040154}, 'weighted avg': {'precision': 0.3876899358377401, 'recall': 0.3358306848929363, 'f1-score': 0.3346820642105158, 'support': 3040154}}
[[263326 583738 280954]
 [153694 390355 201294]
 [188386 611111 367296]]
Evaluating performance on  train set...
2538/2538 - 30s - 30s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916181
{'0': {'precision': 0.3898842810880356, 'recall': 0.24663127618448677, 'f1-score': 0.3021376515007747, 'support': 216254}, '1': {'precision': 0.34132665859891226, 'recall': 0.5610508715727277, 'f1-score': 0.4244379162710342, 'support': 220693}, '2': {'precision': 0.38160542694547733, 'recall': 0.2692627787678028, 'f1-score': 0.31573869102918595, 'support': 212677}, 'accuracy': 0.36085643387559574, 'macro avg': {'precision': 0.37093878887747506, 'recall': 0.3589816421750058, 'f1-score': 0.3474380862669983, 'support': 649624}, 'weighted avg': {'precision': 0.3706777104526081, 'recall': 0.36085643387559574, 'f1-score': 0.3481387854132022, 'support': 649624}}
[[ 53335 119190  43729]
 [ 47802 123820  49071]
 [ 35660 119751  57266]]
Evaluating performance on  val set...
795/795 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0902759
{'0': {'precision': 0.3891229243285412, 'recall': 0.262771305578133, 'f1-score': 0.31370223623801696, 'support': 66438}, '1': {'precision': 0.34537696841734844, 'recall': 0.5627400951780288, 'f1-score': 0.428044964401365, 'support': 69764}, '2': {'precision': 0.38940240996057646, 'recall': 0.2600475977986018, 'f1-score': 0.31184282108680333, 'support': 67230}, 'accuracy': 0.3647410436902749, 'macro avg': {'precision': 0.3746341009021554, 'recall': 0.3618529995182545, 'f1-score': 0.35119667390872844, 'support': 203432}, 'weighted avg': {'precision': 0.37421325894086016, 'recall': 0.3647410436902749, 'f1-score': 0.3522998885590467, 'support': 203432}}
[[17458 36203 12777]
 [15868 39259 14637]
 [11539 38208 17483]]
testing model on single stock: results/universal/W0/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
19053/19053 - 229s - 229s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0785971
{'0': {'precision': 0.31101341997780496, 'recall': 0.2624517281328442, 'f1-score': 0.2846764439464466, 'support': 1242960}, '1': {'precision': 0.5065085853341543, 'recall': 0.5523769405176365, 'f1-score': 0.528449309924663, 'support': 2421390}, '2': {'precision': 0.29424966495383437, 'recall': 0.2881371301199575, 'f1-score': 0.2911613199877384, 'support': 1213096}, 'accuracy': 0.41277238128315513, 'macro avg': {'precision': 0.37059055675526453, 'recall': 0.3676552662568127, 'f1-score': 0.3680956912862827, 'support': 4877446}, 'weighted avg': {'precision': 0.4038968664121995, 'recall': 0.41277238128315513, 'f1-score': 0.4073094689224649, 'support': 4877446}}
[[ 326217  652300  264443]
 [ 509955 1337520  573915]
 [ 212712  650846  349538]]
Evaluating performance on  train set...
4812/4812 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949836
{'0': {'precision': 0.36834970443130804, 'recall': 0.2843777880175296, 'f1-score': 0.32096234761031395, 'support': 407996}, '1': {'precision': 0.3404433207587554, 'recall': 0.4997091517785921, 'f1-score': 0.404980402024544, 'support': 407429}, '2': {'precision': 0.3731672359016337, 'recall': 0.28571565788273035, 'f1-score': 0.3236378522244934, 'support': 416442}, 'accuracy': 0.3560489890548249, 'macro avg': {'precision': 0.3606534203638991, 'recall': 0.35660086589295065, 'f1-score': 0.3498602006197838, 'support': 1231867}, 'weighted avg': {'precision': 0.36074852057561657, 'recall': 0.3560489890548249, 'f1-score': 0.34965504283185445, 'support': 1231867}}
[[116025 194297  97674]
 [101642 203596 102191]
 [ 97319 200139 118984]]
Evaluating performance on  val set...
1767/1767 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937874
{'0': {'precision': 0.36329303199897467, 'recall': 0.2887078155768317, 'f1-score': 0.32173435992508653, 'support': 147270}, '1': {'precision': 0.3577339594833347, 'recall': 0.4929237250722133, 'f1-score': 0.4145864055421763, 'support': 158558}, '2': {'precision': 0.36152594622366846, 'recall': 0.2882531662854607, 'f1-score': 0.32075822902619233, 'support': 146465}, 'accuracy': 0.3601514947169202, 'macro avg': {'precision': 0.3608509792353259, 'recall': 0.3566282356448352, 'f1-score': 0.3523596648311517, 'support': 452293}, 'weighted avg': {'precision': 0.3607719856020261, 'recall': 0.3601514947169202, 'f1-score': 0.3539689194624837, 'support': 452293}}
[[42518 69948 34804]
 [40644 78157 39757]
 [33873 70373 42219]]
training model: results/universal/W0/deepVOL_L2/h50
Epoch 1/50
8838/8838 - 575s - loss: 3.1057 - accuracy50: 0.4524 - val_loss: 3.2287 - val_accuracy50: 0.4186 - 575s/epoch - 65ms/step
Epoch 2/50
8838/8838 - 579s - loss: 3.0575 - accuracy50: 0.4672 - val_loss: 3.2084 - val_accuracy50: 0.4280 - 579s/epoch - 65ms/step
Epoch 3/50
8838/8838 - 564s - loss: 3.0401 - accuracy50: 0.4723 - val_loss: 3.1784 - val_accuracy50: 0.4349 - 564s/epoch - 64ms/step
Epoch 4/50
8838/8838 - 570s - loss: 3.0306 - accuracy50: 0.4742 - val_loss: 3.1781 - val_accuracy50: 0.4336 - 570s/epoch - 64ms/step
Epoch 5/50
8838/8838 - 573s - loss: 3.0224 - accuracy50: 0.4769 - val_loss: 3.1742 - val_accuracy50: 0.4340 - 573s/epoch - 65ms/step
Epoch 6/50
8838/8838 - 575s - loss: 3.0165 - accuracy50: 0.4786 - val_loss: 3.1737 - val_accuracy50: 0.4330 - 575s/epoch - 65ms/step
Epoch 7/50
8838/8838 - 577s - loss: 3.0104 - accuracy50: 0.4805 - val_loss: 3.1701 - val_accuracy50: 0.4339 - 577s/epoch - 65ms/step
Epoch 8/50
8838/8838 - 568s - loss: 3.0048 - accuracy50: 0.4822 - val_loss: 3.1671 - val_accuracy50: 0.4374 - 568s/epoch - 64ms/step
Epoch 9/50
8838/8838 - 571s - loss: 2.9999 - accuracy50: 0.4836 - val_loss: 3.1570 - val_accuracy50: 0.4395 - 571s/epoch - 65ms/step
Epoch 10/50
8838/8838 - 564s - loss: 2.9955 - accuracy50: 0.4851 - val_loss: 3.1558 - val_accuracy50: 0.4383 - 564s/epoch - 64ms/step
Epoch 11/50
8838/8838 - 578s - loss: 2.9917 - accuracy50: 0.4859 - val_loss: 3.1518 - val_accuracy50: 0.4393 - 578s/epoch - 65ms/step
Epoch 12/50
8838/8838 - 582s - loss: 2.9882 - accuracy50: 0.4868 - val_loss: 3.1553 - val_accuracy50: 0.4389 - 582s/epoch - 66ms/step
Epoch 13/50
8838/8838 - 580s - loss: 2.9849 - accuracy50: 0.4881 - val_loss: 3.1492 - val_accuracy50: 0.4402 - 580s/epoch - 66ms/step
Epoch 14/50
8838/8838 - 580s - loss: 2.9826 - accuracy50: 0.4890 - val_loss: 3.1435 - val_accuracy50: 0.4397 - 580s/epoch - 66ms/step
Epoch 15/50
8838/8838 - 575s - loss: 2.9800 - accuracy50: 0.4896 - val_loss: 3.1442 - val_accuracy50: 0.4415 - 575s/epoch - 65ms/step
Epoch 16/50
8838/8838 - 572s - loss: 2.9774 - accuracy50: 0.4906 - val_loss: 3.1368 - val_accuracy50: 0.4411 - 572s/epoch - 65ms/step
Epoch 17/50
8838/8838 - 559s - loss: 2.9750 - accuracy50: 0.4910 - val_loss: 3.1331 - val_accuracy50: 0.4414 - 559s/epoch - 63ms/step
Epoch 18/50
8838/8838 - 555s - loss: 2.9731 - accuracy50: 0.4918 - val_loss: 3.1364 - val_accuracy50: 0.4398 - 555s/epoch - 63ms/step
Epoch 19/50
8838/8838 - 563s - loss: 2.9712 - accuracy50: 0.4924 - val_loss: 3.1395 - val_accuracy50: 0.4395 - 563s/epoch - 64ms/step
Epoch 20/50
8838/8838 - 572s - loss: 2.9696 - accuracy50: 0.4926 - val_loss: 3.1350 - val_accuracy50: 0.4410 - 572s/epoch - 65ms/step
Epoch 21/50
8838/8838 - 574s - loss: 2.9675 - accuracy50: 0.4935 - val_loss: 3.1378 - val_accuracy50: 0.4404 - 574s/epoch - 65ms/step
Epoch 22/50
8838/8838 - 578s - loss: 2.9655 - accuracy50: 0.4941 - val_loss: 3.1410 - val_accuracy50: 0.4396 - 578s/epoch - 65ms/step
Epoch 23/50
8838/8838 - 574s - loss: 2.9639 - accuracy50: 0.4944 - val_loss: 3.1485 - val_accuracy50: 0.4389 - 574s/epoch - 65ms/step
Epoch 24/50
8838/8838 - 582s - loss: 2.9624 - accuracy50: 0.4951 - val_loss: 3.1446 - val_accuracy50: 0.4398 - 582s/epoch - 66ms/step
Epoch 25/50
8838/8838 - 568s - loss: 2.9604 - accuracy50: 0.4958 - val_loss: 3.1409 - val_accuracy50: 0.4397 - 568s/epoch - 64ms/step
Epoch 26/50
8838/8838 - 574s - loss: 2.9589 - accuracy50: 0.4960 - val_loss: 3.1488 - val_accuracy50: 0.4391 - 574s/epoch - 65ms/step
Epoch 27/50
8838/8838 - 574s - loss: 2.9573 - accuracy50: 0.4964 - val_loss: 3.1576 - val_accuracy50: 0.4379 - 574s/epoch - 65ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1255s - 1255s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0180893
{'0': {'precision': 0.35630526345474023, 'recall': 0.45556045632109027, 'f1-score': 0.39986560450875197, 'support': 2024627}, '1': {'precision': 0.5983058818079792, 'recall': 0.5408202740102593, 'f1-score': 0.5681125822432114, 'support': 4394434}, '2': {'precision': 0.3770887706334949, 'recall': 0.3507523271302799, 'f1-score': 0.36344406558180364, 'support': 2029968}, 'accuracy': 0.4747237818688988, 'macro avg': {'precision': 0.4438999719654048, 'recall': 0.44904435248720986, 'f1-score': 0.443807417444589, 'support': 8449029}, 'weighted avg': {'precision': 0.48716593393097357, 'recall': 0.4747237818688988, 'f1-score': 0.4786220723609858, 'support': 8449029}}
[[ 922340  770768  331519]
 [1173178 2376599  844657]
 [ 493105  824847  712016]]
Evaluating performance on  train set...
8838/8838 - 318s - 318s/epoch - 36ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0481654
{'0': {'precision': 0.40921920173167503, 'recall': 0.5034462956368504, 'f1-score': 0.45146856500940336, 'support': 710473}, '1': {'precision': 0.48694802518347036, 'recall': 0.4489885124740617, 'f1-score': 0.4671984919543947, 'support': 823589}, '2': {'precision': 0.4414636551928198, 'recall': 0.38119256603618085, 'f1-score': 0.40912025993861245, 'support': 728010}, 'accuracy': 0.44427365707192346, 'macro avg': {'precision': 0.4458769607026551, 'recall': 0.444542458049031, 'f1-score': 0.44259577230080344, 'support': 2262072}, 'weighted avg': {'precision': 0.44789652435539723, 'recall': 0.44427365707192346, 'f1-score': 0.4435665199940864, 'support': 2262072}}
[[357685 186657 166131]
 [268832 369782 184975]
 [247550 202948 277512]]
Evaluating performance on  val set...
3279/3279 - 119s - 119s/epoch - 36ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0491458
{'0': {'precision': 0.39861325409070997, 'recall': 0.49522156704202575, 'f1-score': 0.44169655436864685, 'support': 253535}, '1': {'precision': 0.49405316729428433, 'recall': 0.44755895357406045, 'f1-score': 0.4696581823102861, 'support': 325680}, '2': {'precision': 0.4308628705257271, 'recall': 0.3797590714082153, 'f1-score': 0.4037001101271989, 'support': 259662}, 'accuracy': 0.44097764034536646, 'macro avg': {'precision': 0.4411764306369071, 'recall': 0.44084653067476715, 'f1-score': 0.43835161560204394, 'support': 838877}, 'weighted avg': {'precision': 0.44564860114980154, 'recall': 0.44097764034536646, 'f1-score': 0.44079095114363326, 'support': 838877}}
[[125556  71771  56208]
 [105872 145761  74047]
 [ 83554  77499  98609]]
testing model out of sample: results/universal/W0/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 850s - 850s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99721366
{'0': {'precision': 0.4979139811538403, 'recall': 0.46169963795716745, 'f1-score': 0.4791234727275098, 'support': 1909995}, '1': {'precision': 0.4914823248732463, 'recall': 0.6551034089986183, 'f1-score': 0.5616182671308408, 'support': 1982371}, '2': {'precision': 0.5172444642941425, 'recall': 0.3783670695152059, 'f1-score': 0.43703830241113945, 'support': 1940597}, 'accuracy': 0.49970486697755495, 'macro avg': {'precision': 0.5022135901070763, 'recall': 0.4983900388236639, 'f1-score': 0.4925933474231634, 'support': 5832963}, 'weighted avg': {'precision': 0.502159293304458, 'recall': 0.49970486697755495, 'f1-score': 0.49315835222454896, 'support': 5832963}}
[[ 881844  644374  383777]
 [ 382191 1298658  301522]
 [ 507042  699297  734258]]
Evaluating performance on  train set...
6334/6334 - 240s - 240s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0235637
{'0': {'precision': 0.485026455138839, 'recall': 0.4285089661695053, 'f1-score': 0.45501943331051753, 'support': 532892}, '1': {'precision': 0.45213696420044164, 'recall': 0.6568302843687738, 'f1-score': 0.5355924643447656, 'support': 552100}, '2': {'precision': 0.5054330649841692, 'recall': 0.3282615672839368, 'f1-score': 0.39802163441414906, 'support': 535908}, 'accuracy': 0.4731340613239558, 'macro avg': {'precision': 0.48086549477448326, 'recall': 0.4712002726074053, 'f1-score': 0.462877844023144, 'support': 1620900}, 'weighted avg': {'precision': 0.48057076849678954, 'recall': 0.4731340613239558, 'f1-score': 0.4636188496983597, 'support': 1620900}}
[[228349 211757  92786]
 [110114 362636  79350]
 [132334 227656 175918]]
Evaluating performance on  val set...
2156/2156 - 81s - 81s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.019841
{'0': {'precision': 0.47965658360762425, 'recall': 0.4348457515005049, 'f1-score': 0.4561532968340871, 'support': 176274}, '1': {'precision': 0.4599910052041319, 'recall': 0.6541493449471338, 'f1-score': 0.5401524407495039, 'support': 197007}, '2': {'precision': 0.5017061475189023, 'recall': 0.3137956405259226, 'f1-score': 0.38610142669076153, 'support': 178049}, 'accuracy': 0.4741171349282644, 'macro avg': {'precision': 0.48045124544355283, 'recall': 0.46759691232452044, 'f1-score': 0.46080238809145085, 'support': 551330}, 'weighted avg': {'precision': 0.47975025926522014, 'recall': 0.4741171349282644, 'f1-score': 0.46354588188876494, 'support': 551330}}
[[ 76652  71419  28203]
 [ 40847 128872  27288]
 [ 42307  79871  55871]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
876/876 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1489621
{'0': {'precision': 0.33864639529180973, 'recall': 0.5882854100106496, 'f1-score': 0.4298498171348533, 'support': 61035}, '1': {'precision': 0.5576670420420421, 'recall': 0.1183705990737513, 'f1-score': 0.19528907219205205, 'support': 100405}, '2': {'precision': 0.34049475804369156, 'recall': 0.5256318265167823, 'f1-score': 0.41327649971792135, 'support': 62715}, 'accuracy': 0.36026856416319064, 'macro avg': {'precision': 0.41226939845918115, 'recall': 0.4107626118670611, 'f1-score': 0.3461384630149422, 'support': 224155}, 'weighted avg': {'precision': 0.43726872406851036, 'recall': 0.36026856416319064, 'f1-score': 0.3201468562471424, 'support': 224155}}
[[35906  4187 20942]
 [45612 11885 42908]
 [24510  5240 32965]]
Evaluating performance on  train set...
318/318 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1201075
{'0': {'precision': 0.40049962292609353, 'recall': 0.614078196140782, 'f1-score': 0.4848087182266853, 'support': 27674}, '1': {'precision': 0.4073985680190931, 'recall': 0.06373683817489359, 'f1-score': 0.11022859356838437, 'support': 26782}, '2': {'precision': 0.3958562099057967, 'recall': 0.5116913192888092, 'f1-score': 0.4463814396037668, 'support': 26772}, 'accuracy': 0.39887723445117446, 'macro avg': {'precision': 0.40125146695032776, 'recall': 0.3965021178681616, 'f1-score': 0.34713958379961213, 'support': 81228}, 'weighted avg': {'precision': 0.40124387483554996, 'recall': 0.39887723445117446, 'f1-score': 0.34863917075670714, 'support': 81228}}
[[16994  1209  9471]
 [13639  1707 11436]
 [11799  1274 13699]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1230325
{'0': {'precision': 0.3693893735130849, 'recall': 0.5659093670270927, 'f1-score': 0.44700350271100237, 'support': 8231}, '1': {'precision': 0.49509043927648577, 'recall': 0.09717009838726037, 'f1-score': 0.16245548584025776, 'support': 9859}, '2': {'precision': 0.3845831938399732, 'recall': 0.546828513626086, 'f1-score': 0.4515748611861825, 'support': 8403}, 'accuracy': 0.38542256445098705, 'macro avg': {'precision': 0.4163543355431813, 'recall': 0.40330265968014634, 'f1-score': 0.3536779499124809, 'support': 26493}, 'weighted avg': {'precision': 0.42098641724419167, 'recall': 0.38542256445098705, 'f1-score': 0.34256286657837365, 'support': 26493}}
[[4658  478 3095]
 [4643  958 4258]
 [3309  499 4595]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
2359/2359 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87348646
{'0': {'precision': 0.5230742954739539, 'recall': 0.4294377878891982, 'f1-score': 0.47165358271763697, 'support': 142633}, '1': {'precision': 0.6591755218538105, 'recall': 0.8179372545718827, 'f1-score': 0.730024443943623, 'support': 308899}, '2': {'precision': 0.5670416187095588, 'recall': 0.3850554329550231, 'f1-score': 0.45865588096085613, 'support': 152256}, 'accuracy': 0.6170029878036661, 'macro avg': {'precision': 0.5830971453457744, 'recall': 0.5441434918053679, 'f1-score': 0.5534446358740387, 'support': 603788}, 'weighted avg': {'precision': 0.6037910727104534, 'recall': 0.6170029878036661, 'f1-score': 0.6005589643800175, 'support': 603788}}
[[ 61252  62925  18456]
 [ 29931 252660  26308]
 [ 25917  67712  58627]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92301744
{'0': {'precision': 0.49992122262486216, 'recall': 0.46590964710488963, 'f1-score': 0.48231657884069723, 'support': 40862}, '1': {'precision': 0.5990320014144271, 'recall': 0.7777283617634823, 'f1-score': 0.6767832508317779, 'support': 69703}, '2': {'precision': 0.5684457902110543, 'recall': 0.31335326357747884, 'f1-score': 0.4040021199029984, 'support': 40140}, 'accuracy': 0.5694966988487442, 'macro avg': {'precision': 0.5557996714167812, 'recall': 0.5189970908152836, 'f1-score': 0.5210339831918245, 'support': 150705}, 'weighted avg': {'precision': 0.5640126247474115, 'recall': 0.5694966988487442, 'f1-score': 0.5514010024234255, 'support': 150705}}
[[19038 17561  4263]
 [10207 54210  5286]
 [ 8837 18725 12578]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9310986
{'0': {'precision': 0.5319862693087846, 'recall': 0.41312250090876046, 'f1-score': 0.4650797981175829, 'support': 16506}, '1': {'precision': 0.5643376280145358, 'recall': 0.8023720056364491, 'f1-score': 0.6626260667183864, 'support': 25548}, '2': {'precision': 0.5913411861954949, 'recall': 0.34134558034116663, 'f1-score': 0.4328392073816366, 'support': 16766}, 'accuracy': 0.5617307038422306, 'macro avg': {'precision': 0.5625550278396051, 'recall': 0.518946695628792, 'f1-score': 0.520181690739202, 'support': 58820}, 'weighted avg': {'precision': 0.5629562973389974, 'recall': 0.5617307038422306, 'f1-score': 0.5416926224279273, 'support': 58820}}
[[ 6819  7922  1765]
 [ 2859 20499  2190]
 [ 3140  7903  5723]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0583037
{'0': {'precision': 0.44157615274124046, 'recall': 0.4022212911714334, 'f1-score': 0.4209809631148329, 'support': 136047}, '1': {'precision': 0.4112146271677309, 'recall': 0.5864309426826754, 'f1-score': 0.48343617962647156, 'support': 140673}, '2': {'precision': 0.48511761356169786, 'recall': 0.3183977690090634, 'f1-score': 0.384461503078799, 'support': 139131}, 'accuracy': 0.43649047375141575, 'macro avg': {'precision': 0.44596946449022307, 'recall': 0.43568333428772404, 'f1-score': 0.42962621527336786, 'support': 415851}, 'weighted avg': {'precision': 0.4458731728239353, 'recall': 0.43649047375141575, 'f1-score': 0.42988985999873675, 'support': 415851}}
[[54721 58670 22656]
 [33817 82495 24361]
 [35384 59448 44299]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.075499
{'0': {'precision': 0.418923781877504, 'recall': 0.4560221456178836, 'f1-score': 0.4366864645201625, 'support': 38292}, '1': {'precision': 0.39067594433399605, 'recall': 0.518140589569161, 'f1-score': 0.4454695894634234, 'support': 37926}, '2': {'precision': 0.47837388673456344, 'recall': 0.28614396411092985, 'f1-score': 0.3580918355954641, 'support': 39232}, 'accuracy': 0.41870073624945864, 'macro avg': {'precision': 0.42932453764868783, 'recall': 0.42010223309932476, 'f1-score': 0.4134159631930167, 'support': 115450}, 'weighted avg': {'precision': 0.4298464239483319, 'recall': 0.41870073624945864, 'f1-score': 0.41286389470313645, 'support': 115450}}
[[17462 14933  5897]
 [11931 19651  6344]
 [12290 15716 11226]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772978
{'0': {'precision': 0.43168019646633465, 'recall': 0.41500524658971666, 'f1-score': 0.42317852007891127, 'support': 15248}, '1': {'precision': 0.37783755722308743, 'recall': 0.5383632573465134, 'f1-score': 0.4440377149195785, 'support': 14871}, '2': {'precision': 0.4647978436657682, 'recall': 0.2873233804318848, 'f1-score': 0.35512171011985666, 'support': 15004}, 'accuracy': 0.41320390931454026, 'macro avg': {'precision': 0.42477186578506343, 'recall': 0.4135639614560383, 'f1-score': 0.4074459817061155, 'support': 45123}, 'weighted avg': {'precision': 0.4249475610119981, 'recall': 0.41320390931454026, 'f1-score': 0.40742320039382623, 'support': 45123}}
[[6328 6614 2306]
 [4207 8006 2658]
 [4124 6569 4311]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2184192
{'0': {'precision': 0.33576620646364247, 'recall': 0.8380505622664949, 'f1-score': 0.479442900481575, 'support': 107867}, '1': {'precision': 0.29765395894428154, 'recall': 0.0018522235807222759, 'f1-score': 0.003681537903518317, 'support': 109598}, '2': {'precision': 0.3763148779465116, 'recall': 0.19237830734675998, 'f1-score': 0.2546006216389561, 'support': 107299}, 'accuracy': 0.3425348868716976, 'macro avg': {'precision': 0.3365783477848119, 'recall': 0.34409369773132575, 'f1-score': 0.24590835334134983, 'support': 324764}, 'weighted avg': {'precision': 0.3363013821537234, 'recall': 0.3425348868716976, 'f1-score': 0.2446020760879722, 'support': 324764}}
[[90398   231 17238]
 [92422   203 16973]
 [86409   248 20642]]
Evaluating performance on  train set...
486/486 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2121997
{'0': {'precision': 0.33249372707971436, 'recall': 0.834779026943206, 'f1-score': 0.4755680092758745, 'support': 41272}, '1': {'precision': 0.34516129032258064, 'recall': 0.0026032163102449944, 'f1-score': 0.005167459493395794, 'support': 41103}, '2': {'precision': 0.36974169741697416, 'recall': 0.17944126074498568, 'f1-score': 0.24162044851700024, 'support': 41880}, 'accuracy': 0.33861816425898356, 'macro avg': {'precision': 0.3491322382730897, 'recall': 0.33894116799947893, 'f1-score': 0.2407853057620902, 'support': 124255}, 'weighted avg': {'precision': 0.3492384846322955, 'recall': 0.33861816425898356, 'f1-score': 0.24110985755328082, 'support': 124255}}
[[34453    83  6736]
 [34922   107  6074]
 [34245   120  7515]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2084583
{'0': {'precision': 0.33028087726048483, 'recall': 0.8609253811179459, 'f1-score': 0.47741050406926083, 'support': 14956}, '1': {'precision': 0.31958762886597936, 'recall': 0.0020508070918232335, 'f1-score': 0.004075461776112534, 'support': 15116}, '2': {'precision': 0.37418452935694313, 'recall': 0.15594251683065768, 'f1-score': 0.22014072923329978, 'support': 15448}, 'accuracy': 0.33646748681898064, 'macro avg': {'precision': 0.3413510118278024, 'recall': 0.339639568346809, 'f1-score': 0.2338755650262244, 'support': 45520}, 'weighted avg': {'precision': 0.3416293938434098, 'recall': 0.33646748681898064, 'f1-score': 0.232919379707021, 'support': 45520}}
[[12876    28  2052]
 [13108    31  1977]
 [13001    38  2409]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.130979
{'0': {'precision': 0.34150862536337023, 'recall': 0.49660252126709065, 'f1-score': 0.40470537844948906, 'support': 133187}, '1': {'precision': 0.40681128815511614, 'recall': 0.3049615178710201, 'f1-score': 0.34859940383362614, 'support': 173717}, '2': {'precision': 0.39801361044693767, 'recall': 0.3485008198641368, 'f1-score': 0.37161523990914125, 'support': 136608}, 'accuracy': 0.37592218474359207, 'macro avg': {'precision': 0.38211117465514133, 'recall': 0.3833549530007492, 'f1-score': 0.3749733407307521, 'support': 443512}, 'weighted avg': {'precision': 0.38449103773212173, 'recall': 0.37592218474359207, 'f1-score': 0.3725372764859262, 'support': 443512}}
[[66141 38782 28264]
 [76998 52977 43742]
 [50534 38466 47608]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.108063
{'0': {'precision': 0.38548673483935353, 'recall': 0.45955007570841444, 'f1-score': 0.4192727605917719, 'support': 64722}, '1': {'precision': 0.3659227717616064, 'recall': 0.36939109997835295, 'f1-score': 0.3676487561653111, 'support': 64674}, '2': {'precision': 0.4172543135783946, 'recall': 0.335221793635487, 'f1-score': 0.37176659314216964, 'support': 66368}, 'accuracy': 0.3876146788990826, 'macro avg': {'precision': 0.38955460672645154, 'recall': 0.3880543231074181, 'f1-score': 0.3862293699664175, 'support': 195764}, 'weighted avg': {'precision': 0.38979330253138306, 'recall': 0.3876146788990826, 'f1-score': 0.3861123215755476, 'support': 195764}}
[[29743 20323 14656]
 [24368 23890 16416]
 [23046 21074 22248]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.11077
{'0': {'precision': 0.3873362777947, 'recall': 0.47902246079954797, 'f1-score': 0.4283278246773752, 'support': 21237}, '1': {'precision': 0.37043229042273706, 'recall': 0.35055600759425004, 'f1-score': 0.3602201732587036, 'support': 22122}, '2': {'precision': 0.4077287516410754, 'recall': 0.33442576899667587, 'f1-score': 0.3674571737229281, 'support': 21359}, 'accuracy': 0.3873883618158781, 'macro avg': {'precision': 0.3884991066195042, 'recall': 0.38800141246349124, 'f1-score': 0.385335057219669, 'support': 64718}, 'weighted avg': {'precision': 0.3882882979473958, 'recall': 0.3873883618158781, 'f1-score': 0.3849579167936351, 'support': 64718}}
[[10173  6319  4745]
 [ 8736  7755  5631]
 [ 7355  6861  7143]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
4693/4693 - 70s - 70s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84777075
{'0': {'precision': 0.5932496495240906, 'recall': 0.4496520435233958, 'f1-score': 0.5115648368515967, 'support': 286099}, '1': {'precision': 0.6422866040983645, 'recall': 0.8729994294329712, 'f1-score': 0.740079201553226, 'support': 627446}, '2': {'precision': 0.683703883938076, 'recall': 0.31259842793423886, 'f1-score': 0.4290359597578985, 'support': 287647}, 'accuracy': 0.6379687843408881, 'macro avg': {'precision': 0.6397467125201771, 'recall': 0.5450833002968686, 'f1-score': 0.5602266660542404, 'support': 1201192}, 'weighted avg': {'precision': 0.6405251310177149, 'recall': 0.6379687843408881, 'f1-score': 0.6111669322411827, 'support': 1201192}}
[[128645 140486  16968]
 [ 55056 547760  24630]
 [ 33147 164582  89918]]
Evaluating performance on  train set...
1497/1497 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8805888
{'0': {'precision': 0.6265022232904699, 'recall': 0.42180799417428594, 'f1-score': 0.5041706963249516, 'support': 98872}, '1': {'precision': 0.5934078417002565, 'recall': 0.8814218922640658, 'f1-score': 0.7092922669925343, 'support': 183727}, '2': {'precision': 0.6518852590371099, 'recall': 0.28319244157135753, 'f1-score': 0.39485270156901087, 'support': 100550}, 'accuracy': 0.6058243659777267, 'macro avg': {'precision': 0.6239317746759454, 'recall': 0.5288074426699031, 'f1-score': 0.5361052216288323, 'support': 383149}, 'weighted avg': {'precision': 0.6172941418336464, 'recall': 0.6058243659777267, 'f1-score': 0.5738418854480686, 'support': 383149}}
[[ 41705  50668   6499]
 [ 13079 161941   8707]
 [ 11784  60291  28475]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86166674
{'0': {'precision': 0.6393414136148399, 'recall': 0.42382790001151943, 'f1-score': 0.509741440520929, 'support': 34724}, '1': {'precision': 0.6087599940408204, 'recall': 0.8817360531691458, 'f1-score': 0.7202510002996492, 'support': 69514}, '2': {'precision': 0.6716473432946866, 'recall': 0.3043404972608512, 'f1-score': 0.41887711700564534, 'support': 35595}, 'accuracy': 0.6210479643574836, 'macro avg': {'precision': 0.6399162503167822, 'recall': 0.5366348168138388, 'f1-score': 0.5496231859420745, 'support': 139833}, 'weighted avg': {'precision': 0.6323623226040324, 'recall': 0.6210479643574836, 'f1-score': 0.5912604377743058, 'support': 139833}}
[[14717 17953  2054]
 [ 4979 61293  3242]
 [ 3323 21439 10833]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
6677/6677 - 92s - 92s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8643665
{'0': {'precision': 0.5437913650076674, 'recall': 0.4283902007643151, 'f1-score': 0.47924153312771894, 'support': 379948}, '1': {'precision': 0.675768375313803, 'recall': 0.846772461395698, 'f1-score': 0.7516672613320782, 'support': 959090}, '2': {'precision': 0.5682678451340186, 'recall': 0.3195209697283983, 'f1-score': 0.4090465883394303, 'support': 370248}, 'accuracy': 0.639564707135026, 'macro avg': {'precision': 0.595942528485163, 'recall': 0.5315612106294704, 'f1-score': 0.5466517942664092, 'support': 1709286}, 'weighted avg': {'precision': 0.6231462527375925, 'recall': 0.639564707135026, 'f1-score': 0.6168962344155927, 'support': 1709286}}
[[162766 186908  30274]
 [ 87355 812131  59604]
 [ 49196 202750 118302]]
Evaluating performance on  train set...
2262/2262 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98433876
{'0': {'precision': 0.5303188744330065, 'recall': 0.42313110188867337, 'f1-score': 0.4706999114036198, 'support': 184574}, '1': {'precision': 0.48997683618275195, 'recall': 0.7540702369745249, 'f1-score': 0.5939919106672664, 'support': 209263}, '2': {'precision': 0.5514971098793728, 'recall': 0.326466518194988, 'f1-score': 0.41014305262693246, 'support': 184996}, 'accuracy': 0.5118799377367911, 'macro avg': {'precision': 0.5239309401650437, 'recall': 0.5012226190193955, 'f1-score': 0.49161162489927296, 'support': 578833}, 'weighted avg': {'precision': 0.5225027908549675, 'recall': 0.5118799377367911, 'f1-score': 0.4959190626884575, 'support': 578833}}
[[ 78099  78795  27680]
 [ 30028 157799  21436]
 [ 39141  85460  60395]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9661106
{'0': {'precision': 0.5377554955649827, 'recall': 0.4348666770622174, 'f1-score': 0.4808690404345202, 'support': 64130}, '1': {'precision': 0.5139946841269327, 'recall': 0.7596014514448582, 'f1-score': 0.6131160376400991, 'support': 83503}, '2': {'precision': 0.5631955922865014, 'recall': 0.31978226525472775, 'f1-score': 0.4079376639961689, 'support': 63931}, 'accuracy': 0.5282609517687319, 'macro avg': {'precision': 0.5383152573261389, 'recall': 0.5047501312539345, 'f1-score': 0.5006409140235961, 'support': 211564}, 'weighted avg': {'precision': 0.5360648099379002, 'recall': 0.5282609517687319, 'f1-score': 0.5110275039754687, 'support': 211564}}
[[27888 28425  7817]
 [12035 63429  8039]
 [11937 31550 20444]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
5633/5633 - 106s - 106s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9309189
{'0': {'precision': 0.4863644234608956, 'recall': 0.38829264989673967, 'f1-score': 0.4318303402639088, 'support': 354444}, '1': {'precision': 0.6189009318603015, 'recall': 0.7911674760896588, 'f1-score': 0.6945113945519006, 'support': 718413}, '2': {'precision': 0.5072125680401526, 'recall': 0.33057887076972275, 'f1-score': 0.40027565385751324, 'support': 368977}, 'accuracy': 0.5742609759514619, 'macro avg': {'precision': 0.5374926411204499, 'recall': 0.5033463322520404, 'f1-score': 0.5088724628911075, 'support': 1441834}, 'weighted avg': {'precision': 0.5577377136254796, 'recall': 0.5742609759514619, 'f1-score': 0.5546395753964043, 'support': 1441834}}
[[137628 169113  47703]
 [ 79224 568385  70804]
 [ 66121 180880 121976]]
Evaluating performance on  train set...
1454/1454 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0304424
{'0': {'precision': 0.475733517431826, 'recall': 0.44629383763479163, 'f1-score': 0.4605436834806436, 'support': 123524}, '1': {'precision': 0.44056148996997574, 'recall': 0.6010248125392668, 'f1-score': 0.5084329282812841, 'support': 122559}, '2': {'precision': 0.4919397418470629, 'recall': 0.3475145224264356, 'f1-score': 0.40730320096359096, 'support': 126012}, 'accuracy': 0.46380628602910545, 'macro avg': {'precision': 0.46941158308295483, 'recall': 0.4649443908668313, 'f1-score': 0.4587599375751729, 'support': 372095}, 'weighted avg': {'precision': 0.4696370373321631, 'recall': 0.46380628602910545, 'f1-score': 0.458287050821196, 'support': 372095}}
[[55128 44855 23541]
 [27213 73661 21685]
 [33539 48682 43791]]
Evaluating performance on  val set...
557/557 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0209717
{'0': {'precision': 0.47642397226349675, 'recall': 0.420006986289407, 'f1-score': 0.4464401745103499, 'support': 45804}, '1': {'precision': 0.4509642707747342, 'recall': 0.6507368245774706, 'f1-score': 0.5327380698809757, 'support': 48044}, '2': {'precision': 0.5201810176125244, 'recall': 0.3503078475382493, 'f1-score': 0.4186693245720895, 'support': 48563}, 'accuracy': 0.47407854730322796, 'macro avg': {'precision': 0.4825230868835851, 'recall': 0.4736838861350423, 'f1-score': 0.4659491896544717, 'support': 142411}, 'weighted avg': {'precision': 0.48275626046425885, 'recall': 0.47407854730322796, 'f1-score': 0.46608374347366455, 'support': 142411}}
[[19238 18311  8255]
 [ 9343 31264  7437]
 [11799 19752 17012]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
11876/11876 - 164s - 164s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0329002
{'0': {'precision': 0.5363200018317656, 'recall': 0.4685483481110672, 'f1-score': 0.500148802440627, 'support': 1199778}, '1': {'precision': 0.3114940056294319, 'recall': 0.5568903803867303, 'f1-score': 0.39951896435856027, 'support': 608486}, '2': {'precision': 0.5433474610014423, 'recall': 0.3987839872716425, 'f1-score': 0.4599745977469429, 'support': 1231895}, 'accuracy': 0.4579609158599928, 'macro avg': {'precision': 0.46372048948754657, 'recall': 0.47474090525648, 'f1-score': 0.4532141215153767, 'support': 3040159}, 'weighted avg': {'precision': 0.4941687922038006, 'recall': 0.4579609158599928, 'f1-score': 0.4637289146826741, 'support': 3040159}}
[[562154 356067 281557]
 [138307 338860 131319]
 [347708 392927 491260]]
Evaluating performance on  train set...
2538/2538 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0116718
{'0': {'precision': 0.5308445464472783, 'recall': 0.3953636906676469, 'f1-score': 0.4531954060524022, 'support': 217630}, '1': {'precision': 0.4437151004745364, 'recall': 0.7486355437914315, 'f1-score': 0.5571865912593532, 'support': 213455}, '2': {'precision': 0.538521315258601, 'recall': 0.3139288002196394, 'f1-score': 0.3966386943287361, 'support': 218540}, 'accuracy': 0.4840469501635559, 'macro avg': {'precision': 0.5043603207268053, 'recall': 0.4859760115595726, 'f1-score': 0.46900689721349714, 'support': 649625}, 'weighted avg': {'precision': 0.5047979274992926, 'recall': 0.4840469501635559, 'f1-score': 0.46833881133738925, 'support': 649625}}
[[ 86043  96638  34949]
 [ 29813 159800  23842]
 [ 46231 103703  68606]]
Evaluating performance on  val set...
795/795 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0202023
{'0': {'precision': 0.508435243848534, 'recall': 0.4094144865634455, 'f1-score': 0.45358351680851766, 'support': 67428}, '1': {'precision': 0.4320664006611629, 'recall': 0.7294604813058873, 'f1-score': 0.5426914684034579, 'support': 66652}, '2': {'precision': 0.5321113448247603, 'recall': 0.28087149613565576, 'f1-score': 0.36767051406676166, 'support': 69352}, 'accuracy': 0.47045204294309645, 'macro avg': {'precision': 0.4908709964448191, 'recall': 0.47324882133499613, 'f1-score': 0.45464849975957905, 'support': 203432}, 'weighted avg': {'precision': 0.49148534815256967, 'recall': 0.47045204294309645, 'f1-score': 0.4534900439210648, 'support': 203432}}
[[27606 29593 10229]
 [11133 48620  6899]
 [15557 34316 19479]]
testing model on single stock: results/universal/W0/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
19053/19053 - 261s - 261s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0904053
{'0': {'precision': 0.29643600278690624, 'recall': 0.4451430154271761, 'f1-score': 0.3558795837550206, 'support': 1133584}, '1': {'precision': 0.5545984755899691, 'recall': 0.38338824932188326, 'f1-score': 0.4533679059327948, 'support': 2630078}, '2': {'precision': 0.3101840082118758, 'recall': 0.37793334285039626, 'f1-score': 0.3407235086901339, 'support': 1113789}, 'accuracy': 0.3964952185065519, 'macro avg': {'precision': 0.38707282886291705, 'recall': 0.4021548691998185, 'f1-score': 0.3833236661259831, 'support': 4877451}, 'weighted avg': {'precision': 0.43878490949231563, 'recall': 0.3964952185065519, 'f1-score': 0.4049874521326283, 'support': 4877451}}
[[ 504607  398197  230780]
 [ 916396 1008341  705341]
 [ 281243  411608  420938]]
Evaluating performance on  train set...
4812/4812 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043912
{'0': {'precision': 0.3768365207873881, 'recall': 0.5105839982460592, 'f1-score': 0.43363139197710376, 'support': 405943}, '1': {'precision': 0.3485746011899818, 'recall': 0.19614904907047284, 'f1-score': 0.251035828978024, 'support': 406497}, '2': {'precision': 0.40955718775380484, 'recall': 0.4424406572760998, 'f1-score': 0.42536434193817535, 'support': 419428}, 'accuracy': 0.3836238947679459, 'macro avg': {'precision': 0.37832276991039154, 'recall': 0.38305790153087727, 'f1-score': 0.3700105209644344, 'support': 1231868}, 'weighted avg': {'precision': 0.37865130806476144, 'recall': 0.3836238947679459, 'f1-score': 0.3705629618886815, 'support': 1231868}}
[[207268  73978 124697]
 [183928  79734 142835]
 [158825  75031 185572]]
Evaluating performance on  val set...
1767/1767 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1154828
{'0': {'precision': 0.36025788209814963, 'recall': 0.5076901338796849, 'f1-score': 0.421452365871396, 'support': 141545}, '1': {'precision': 0.3695044415385309, 'recall': 0.19573863297065533, 'f1-score': 0.25591218194452037, 'support': 167458}, '2': {'precision': 0.38154575478021374, 'recall': 0.4369949054365273, 'f1-score': 0.4073922265162457, 'support': 143290}, 'accuracy': 0.36979568554012554, 'macro avg': {'precision': 0.37043602613896476, 'recall': 0.3801412240956225, 'f1-score': 0.361585591444054, 'support': 452293}, 'weighted avg': {'precision': 0.37042551597128126, 'recall': 0.36979568554012554, 'f1-score': 0.3557080242870111, 'support': 452293}}
[[71861 27458 42226]
 [75409 32778 59271]
 [52201 28472 62617]]
training model: results/universal/W0/deepVOL_L2/h100
Epoch 1/50
8838/8838 - 556s - loss: 3.2295 - accuracy100: 0.3982 - val_loss: 3.2837 - val_accuracy100: 0.3603 - 556s/epoch - 63ms/step
Epoch 2/50
8838/8838 - 574s - loss: 3.1863 - accuracy100: 0.4170 - val_loss: 3.2911 - val_accuracy100: 0.3520 - 574s/epoch - 65ms/step
Epoch 3/50
8838/8838 - 575s - loss: 3.1754 - accuracy100: 0.4216 - val_loss: 3.2925 - val_accuracy100: 0.3529 - 575s/epoch - 65ms/step
Epoch 4/50
8838/8838 - 572s - loss: 3.1684 - accuracy100: 0.4237 - val_loss: 3.2950 - val_accuracy100: 0.3534 - 572s/epoch - 65ms/step
Epoch 5/50
8838/8838 - 578s - loss: 3.1643 - accuracy100: 0.4256 - val_loss: 3.3329 - val_accuracy100: 0.3485 - 578s/epoch - 65ms/step
Epoch 6/50
8838/8838 - 578s - loss: 3.1608 - accuracy100: 0.4270 - val_loss: 3.3268 - val_accuracy100: 0.3497 - 578s/epoch - 65ms/step
Epoch 7/50
8838/8838 - 556s - loss: 3.1585 - accuracy100: 0.4280 - val_loss: 3.3255 - val_accuracy100: 0.3524 - 556s/epoch - 63ms/step
Epoch 8/50
8838/8838 - 566s - loss: 3.1560 - accuracy100: 0.4291 - val_loss: 3.3239 - val_accuracy100: 0.3524 - 566s/epoch - 64ms/step
Epoch 9/50
8838/8838 - 569s - loss: 3.1535 - accuracy100: 0.4302 - val_loss: 3.3169 - val_accuracy100: 0.3545 - 569s/epoch - 64ms/step
Epoch 10/50
8838/8838 - 551s - loss: 3.1516 - accuracy100: 0.4311 - val_loss: 3.3213 - val_accuracy100: 0.3542 - 551s/epoch - 62ms/step
Epoch 11/50
8838/8838 - 554s - loss: 3.1487 - accuracy100: 0.4324 - val_loss: 3.3176 - val_accuracy100: 0.3560 - 554s/epoch - 63ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1257s - 1257s/epoch - 38ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0708835
{'0': {'precision': 0.3807325058947198, 'recall': 0.3001802299318496, 'f1-score': 0.33569168308555736, 'support': 2397493}, '1': {'precision': 0.44091845808688557, 'recall': 0.7420133339923445, 'f1-score': 0.5531466434404543, 'support': 3641820}, '2': {'precision': 0.3566279405061996, 'recall': 0.06364235453472525, 'f1-score': 0.10800973608888689, 'support': 2409716}, 'accuracy': 0.42316330077692954, 'macro avg': {'precision': 0.39275963482926834, 'recall': 0.3686119728196398, 'f1-score': 0.3322826875382995, 'support': 8449029}, 'weighted avg': {'precision': 0.399799933349722, 'recall': 0.42316330077692954, 'f1-score': 0.3644858786233691, 'support': 8449029}}
[[ 719680 1568952  108861]
 [ 771734 2702279  167807]
 [ 398837 1857519  153360]]
Evaluating performance on  train set...
8838/8838 - 325s - 325s/epoch - 37ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959857
{'0': {'precision': 0.40613721473278314, 'recall': 0.28727169474782943, 'f1-score': 0.3365163740507485, 'support': 750147}, '1': {'precision': 0.3393562534443755, 'recall': 0.7066236901410334, 'f1-score': 0.45851198113670116, 'support': 747695}, '2': {'precision': 0.39040134717934327, 'recall': 0.08918650144589979, 'f1-score': 0.14520188705573078, 'support': 764230}, 'accuracy': 0.35896028066303814, 'macro avg': {'precision': 0.3786316051188339, 'recall': 0.3610272954449209, 'f1-score': 0.31341008074772686, 'support': 2262072}, 'weighted avg': {'precision': 0.3787474530846564, 'recall': 0.35896028066303814, 'f1-score': 0.31220558069135457, 'support': 2262072}}
[[215496 480877  53774]
 [166702 528339  52654]
 [148401 547670  68159]]
Evaluating performance on  val set...
3279/3279 - 122s - 122s/epoch - 37ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0954956
{'0': {'precision': 0.41215505844879097, 'recall': 0.28607399218967317, 'f1-score': 0.3377311295306293, 'support': 276813}, '1': {'precision': 0.340935100570175, 'recall': 0.7162793186479979, 'f1-score': 0.4619777352643089, 'support': 280325}, '2': {'precision': 0.3819138077195896, 'recall': 0.07835265973116963, 'f1-score': 0.13002886257878307, 'support': 281739}, 'accuracy': 0.36007066590215253, 'macro avg': {'precision': 0.37833465557951856, 'recall': 0.3602353235229469, 'f1-score': 0.30991257579124043, 'support': 838877}, 'weighted avg': {'precision': 0.37819909776383065, 'recall': 0.36007066590215253, 'f1-score': 0.3094929024288582, 'support': 838877}}
[[ 79189 180089  17535]
 [ 61343 200791  18191]
 [ 51602 208062  22075]]
testing model out of sample: results/universal/W0/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 800s - 800s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0911381
{'0': {'precision': 0.4305104929779678, 'recall': 0.3241491368888971, 'f1-score': 0.3698345563947573, 'support': 1947258}, '1': {'precision': 0.3442995565265636, 'recall': 0.717296745365354, 'f1-score': 0.4652709337572326, 'support': 1921506}, '2': {'precision': 0.4074764658806835, 'recall': 0.07543380278678484, 'f1-score': 0.12730107998041085, 'support': 1964199}, 'accuracy': 0.36990788386622714, 'macro avg': {'precision': 0.39409550512840497, 'recall': 0.372293228347012, 'f1-score': 0.3208021900441336, 'support': 5832963}, 'weighted avg': {'precision': 0.39435421277398724, 'recall': 0.36990788386622714, 'f1-score': 0.3196023776342676, 'support': 5832963}}
[[ 631202 1205320  110736]
 [ 438498 1378290  104718]
 [ 396471 1419561  148167]]
Evaluating performance on  train set...
6334/6334 - 238s - 238s/epoch - 38ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0979589
{'0': {'precision': 0.4122496319311305, 'recall': 0.30072754458261913, 'f1-score': 0.3477665867845534, 'support': 548420}, '1': {'precision': 0.32839724805933584, 'recall': 0.702792162218555, 'f1-score': 0.4476287474054797, 'support': 527190}, '2': {'precision': 0.39139682779619295, 'recall': 0.06647838764694015, 'f1-score': 0.1136529305996015, 'support': 545290}, 'accuracy': 0.3526929483620211, 'macro avg': {'precision': 0.3773479025955531, 'recall': 0.35666603148270476, 'f1-score': 0.3030160882632115, 'support': 1620900}, 'weighted avg': {'precision': 0.3779619128737478, 'recall': 0.3526929483620211, 'f1-score': 0.3014876657386244, 'support': 1620900}}
[[164925 354312  29183]
 [129501 370505  27184]
 [105635 403405  36250]]
Evaluating performance on  val set...
2156/2156 - 82s - 82s/epoch - 38ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944299
{'0': {'precision': 0.40047311682606196, 'recall': 0.3280187780951748, 'f1-score': 0.3606428660553697, 'support': 180636}, '1': {'precision': 0.3422265590911615, 'recall': 0.6840858873653385, 'f1-score': 0.4562204427397762, 'support': 189178}, '2': {'precision': 0.38993735627626674, 'recall': 0.05418255140042751, 'f1-score': 0.09514457912913932, 'support': 181516}, 'accuracy': 0.36004026626521324, 'macro avg': {'precision': 0.37754567739783007, 'recall': 0.35542907228698023, 'f1-score': 0.3040026293080951, 'support': 551330}, 'weighted avg': {'precision': 0.37701824150433155, 'recall': 0.36004026626521324, 'f1-score': 0.306027640604734, 'support': 551330}}
[[ 59252 114021   7363]
 [ 51740 129414   8024]
 [ 36963 134718   9835]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0815015
{'0': {'precision': 0.29944380980917246, 'recall': 0.28000560361433124, 'f1-score': 0.28939866974345047, 'support': 57106}, '1': {'precision': 0.4994856283011915, 'recall': 0.5960368646707465, 'f1-score': 0.5435065911483133, 'support': 109156}, '2': {'precision': 0.2621728395061728, 'recall': 0.18340732040143023, 'f1-score': 0.2158283617737034, 'support': 57893}, 'accuracy': 0.40895362583926304, 'macro avg': {'precision': 0.3537007592055123, 'recall': 0.35314992956216934, 'f1-score': 0.34957787422182235, 'support': 224155}, 'weighted avg': {'precision': 0.3872314409374688, 'recall': 0.40895362583926304, 'f1-score': 0.39413957862157784, 'support': 224155}}
[[15990 30812 10304]
 [24517 65061 19578]
 [12892 34383 10618]]
Evaluating performance on  train set...
318/318 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0993811
{'0': {'precision': 0.3916633724250011, 'recall': 0.308450655505206, 'f1-score': 0.3451118507624429, 'support': 28909}, '1': {'precision': 0.31276036500694304, 'recall': 0.5074632870649769, 'f1-score': 0.3870027461147845, 'support': 24855}, '2': {'precision': 0.3633155021232008, 'recall': 0.23987765802505098, 'f1-score': 0.28896637936706365, 'support': 27464}, 'accuracy': 0.3461614221696952, 'macro avg': {'precision': 0.355913079851715, 'recall': 0.35193053353174464, 'f1-score': 0.34036032541476363, 'support': 81228}, 'weighted avg': {'precision': 0.35793509942376417, 'recall': 0.3461614221696952, 'f1-score': 0.3389467226979794, 'support': 81228}}
[[ 8917 13931  6061]
 [ 6758 12613  5484]
 [ 7092 13784  6588]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898033
{'0': {'precision': 0.3408119658119658, 'recall': 0.24960876369327073, 'f1-score': 0.2881662149954833, 'support': 7668}, '1': {'precision': 0.4221303776066128, 'recall': 0.6053340517241379, 'f1-score': 0.497399003873824, 'support': 11136}, '2': {'precision': 0.2988997555012225, 'recall': 0.1907920405774483, 'f1-score': 0.23291259823767563, 'support': 7689}, 'accuracy': 0.3820631865020949, 'macro avg': {'precision': 0.3539473663066004, 'recall': 0.348578285331619, 'f1-score': 0.3394926057023276, 'support': 26493}, 'weighted avg': {'precision': 0.3628290589560372, 'recall': 0.3820631865020949, 'f1-score': 0.36007846644675034, 'support': 26493}}
[[1914 4349 1405]
 [2359 6741 2036]
 [1343 4879 1467]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
2359/2359 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0686197
{'0': {'precision': 0.459723673347118, 'recall': 0.3613802530540511, 'f1-score': 0.40466267927197896, 'support': 174113}, '1': {'precision': 0.4202153965716708, 'recall': 0.8085928040682632, 'f1-score': 0.5530287731634499, 'support': 235383}, '2': {'precision': 0.46415040388876977, 'recall': 0.033418771745619996, 'f1-score': 0.06234846193363773, 'support': 194292}, 'accuracy': 0.43018907298588244, 'macro avg': {'precision': 0.44802982460251956, 'recall': 0.40113060962264474, 'f1-score': 0.3400133047896889, 'support': 603788}, 'weighted avg': {'precision': 0.44574608786705466, 'recall': 0.43018907298588244, 'f1-score': 0.3523495202879566, 'support': 603788}}
[[ 62921 106823   4369]
 [ 41927 190329   3127]
 [ 32019 155780   6493]]
Evaluating performance on  train set...
589/589 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0863569
{'0': {'precision': 0.43234268636891915, 'recall': 0.4174247585460666, 'f1-score': 0.42475277806096445, 'support': 49906}, '1': {'precision': 0.35224238516025674, 'recall': 0.6770145438348472, 'f1-score': 0.46338909360833486, 'support': 51637}, '2': {'precision': 0.4499083689676237, 'recall': 0.02996216590049225, 'f1-score': 0.05618277519261576, 'support': 49162}, 'accuracy': 0.37997412162834676, 'macro avg': {'precision': 0.41149781349893316, 'recall': 0.37480048942713534, 'f1-score': 0.314774882287305, 'support': 150705}, 'weighted avg': {'precision': 0.41062757960010465, 'recall': 0.37997412162834676, 'f1-score': 0.31775848420811154, 'support': 150705}}
[[20832 28110   964]
 [15841 34959   837]
 [11511 36178  1473]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913142
{'0': {'precision': 0.4664872645347018, 'recall': 0.3774368322446706, 'f1-score': 0.41726377071204657, 'support': 19749}, '1': {'precision': 0.3259308892505025, 'recall': 0.7428010471204188, 'f1-score': 0.4530636684186015, 'support': 18336}, '2': {'precision': 0.4700854700854701, 'recall': 0.023872679045092837, 'f1-score': 0.045437855700385534, 'support': 20735}, 'accuracy': 0.366695001700102, 'macro avg': {'precision': 0.4208345412902248, 'recall': 0.3813701861367275, 'f1-score': 0.3052550982770112, 'support': 58820}, 'weighted avg': {'precision': 0.423939952308998, 'recall': 0.366695001700102, 'f1-score': 0.2973490576311319, 'support': 58820}}
[[ 7454 11963   332]
 [ 4490 13620   226]
 [ 4035 16205   495]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
1625/1625 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0960788
{'0': {'precision': 0.40490470629584696, 'recall': 0.26124518115915524, 'f1-score': 0.31758439156262225, 'support': 136703}, '1': {'precision': 0.3355660386385601, 'recall': 0.7637365429428035, 'f1-score': 0.46626661407481934, 'support': 137753}, '2': {'precision': 0.40795526930426784, 'recall': 0.040765232151066165, 'f1-score': 0.07412360793189476, 'support': 141395}, 'accuracy': 0.35273210837535557, 'macro avg': {'precision': 0.3828086714128916, 'recall': 0.35524898541767497, 'f1-score': 0.28599153785644543, 'support': 415851}, 'weighted avg': {'precision': 0.3829731126980955, 'recall': 0.35273210837535557, 'f1-score': 0.2840562401243811, 'support': 415851}}
[[ 35713  96548   4442]
 [ 28623 105207   3923]
 [ 23865 111766   5764]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004031
{'0': {'precision': 0.3805166846071044, 'recall': 0.27862434974515266, 'f1-score': 0.32169507977916645, 'support': 38062}, '1': {'precision': 0.3323594037650692, 'recall': 0.7344619422572178, 'f1-score': 0.4576311378224784, 'support': 38100}, '2': {'precision': 0.40827178729689806, 'recall': 0.03517613520667889, 'f1-score': 0.06477163546036135, 'support': 39288}, 'accuracy': 0.3462104807275877, 'macro avg': {'precision': 0.3737159585563572, 'recall': 0.3494208090696831, 'f1-score': 0.28136595102066875, 'support': 115450}, 'weighted avg': {'precision': 0.37406930543339345, 'recall': 0.3462104807275877, 'f1-score': 0.2791238847254892, 'support': 115450}}
[[10605 26360  1097]
 [ 9211 27983   906]
 [ 8054 29852  1382]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967752
{'0': {'precision': 0.40626797009775734, 'recall': 0.27838707558941356, 'f1-score': 0.33038463037293947, 'support': 15227}, '1': {'precision': 0.334124206655199, 'recall': 0.7534777956126271, 'f1-score': 0.46295459215122253, 'support': 14952}, '2': {'precision': 0.41709577754891863, 'recall': 0.02710117773019272, 'f1-score': 0.05089538171536287, 'support': 14944}, 'accuracy': 0.35259180462291956, 'macro avg': {'precision': 0.385829318100625, 'recall': 0.35298868297741115, 'f1-score': 0.2814115347465083, 'support': 45123}, 'weighted avg': {'precision': 0.385948337173462, 'recall': 0.35259180462291956, 'f1-score': 0.2817508679141061, 'support': 45123}}
[[ 4239 10676   312]
 [ 3432 11266   254]
 [ 2763 11776   405]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1269/1269 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007549
{'0': {'precision': 0.3147431556544452, 'recall': 0.12654486051283048, 'f1-score': 0.1805130765869796, 'support': 102841}, '1': {'precision': 0.3620985236199743, 'recall': 0.7314591062251115, 'f1-score': 0.48440110557322735, 'support': 117524}, '2': {'precision': 0.32779118036991156, 'recall': 0.14446498529679402, 'f1-score': 0.20054517651751877, 'support': 104399}, 'accuracy': 0.35120887783128674, 'macro avg': {'precision': 0.33487761988144366, 'recall': 0.334156317344912, 'f1-score': 0.28848645289257524, 'support': 324764}, 'weighted avg': {'precision': 0.3360743161188157, 'recall': 0.35120887783128674, 'f1-score': 0.2969221241391348, 'support': 324764}}
[[13014 76228 13599]
 [14230 85964 17330]
 [14104 75213 15082]]
Evaluating performance on  train set...
486/486 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048669
{'0': {'precision': 0.32259071888076946, 'recall': 0.12585895998830351, 'f1-score': 0.1810724114357833, 'support': 41038}, '1': {'precision': 0.32775230133065925, 'recall': 0.7081061343719571, 'f1-score': 0.4480987114215954, 'support': 41080}, '2': {'precision': 0.33518033964393823, 'recall': 0.15504188717753992, 'f1-score': 0.21201401960147984, 'support': 42137}, 'accuracy': 0.32825238420989095, 'macro avg': {'precision': 0.32850778661845564, 'recall': 0.32966899384593357, 'f1-score': 0.28039504748628613, 'support': 124255}, 'weighted avg': {'precision': 0.32856654807990926, 'recall': 0.32825238420989095, 'f1-score': 0.2798469230988561, 'support': 124255}}
[[ 5165 29590  6283]
 [ 5316 29089  6675]
 [ 5530 30074  6533]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1014475
{'0': {'precision': 0.33655172413793105, 'recall': 0.11629332062368081, 'f1-score': 0.17285699827952639, 'support': 14687}, '1': {'precision': 0.3388359973214546, 'recall': 0.7606535947712418, 'f1-score': 0.4688299393719661, 'support': 15300}, '2': {'precision': 0.34650705149229255, 'recall': 0.13603296208073135, 'f1-score': 0.1953677592344321, 'support': 15533}, 'accuracy': 0.33960896309314587, 'macro avg': {'precision': 0.3406315909838928, 'recall': 0.33765995915855135, 'f1-score': 0.27901823229530814, 'support': 45520}, 'weighted avg': {'precision': 0.3407166072553126, 'recall': 0.33960896309314587, 'f1-score': 0.28001968827572316, 'support': 45520}}
[[ 1708 11050  1929]
 [ 1606 11638  2056]
 [ 1761 11659  2113]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978624
{'0': {'precision': 0.367159616588483, 'recall': 0.31469983624263964, 'f1-score': 0.33891169429581325, 'support': 143505}, '1': {'precision': 0.34499949878036557, 'recall': 0.6833407239249998, 'f1-score': 0.4585101351576395, 'support': 151093}, '2': {'precision': 0.42347347111717903, 'recall': 0.060403991565601625, 'f1-score': 0.1057271311451324, 'support': 148914}, 'accuracy': 0.35490358772705133, 'macro avg': {'precision': 0.3785441954953425, 'recall': 0.35281485057774703, 'f1-score': 0.3010496535328617, 'support': 443512}, 'weighted avg': {'precision': 0.37851823293551384, 'recall': 0.35490358772705133, 'f1-score': 0.3013615066754454, 'support': 443512}}
[[ 45161  91454   6890]
 [ 42489 103248   5356]
 [ 35351 104568   8995]]
Evaluating performance on  train set...
765/765 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1012415
{'0': {'precision': 0.3767816909759279, 'recall': 0.24711848061099098, 'f1-score': 0.2984763371972871, 'support': 64289}, '1': {'precision': 0.3354533199682002, 'recall': 0.7513121835663523, 'f1-score': 0.46381701570430417, 'support': 64587}, '2': {'precision': 0.40082737030411447, 'recall': 0.05359705776820954, 'f1-score': 0.09455111298660196, 'support': 66888}, 'accuracy': 0.3473416971455426, 'macro avg': {'precision': 0.37102079374941416, 'recall': 0.3506759073151842, 'f1-score': 0.2856148219627311, 'support': 195764}, 'weighted avg': {'precision': 0.3713623692448008, 'recall': 0.3473416971455426, 'f1-score': 0.2833494906153231, 'support': 195764}}
[[15887 45273  3129]
 [13832 48525  2230]
 [12446 50857  3585]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987184
{'0': {'precision': 0.3674520892240025, 'recall': 0.2734754956977179, 'f1-score': 0.3135740904581892, 'support': 21384}, '1': {'precision': 0.34234037916757465, 'recall': 0.7183027753646382, 'f1-score': 0.4636885524121545, 'support': 21871}, '2': {'precision': 0.4043940954342602, 'recall': 0.05488515119042072, 'f1-score': 0.0966524450278963, 'support': 21463}, 'accuracy': 0.35130875490589947, 'macro avg': {'precision': 0.3713955212752791, 'recall': 0.3488878074175923, 'f1-score': 0.2913050292994133, 'support': 64718}, 'weighted avg': {'precision': 0.37121716337101923, 'recall': 0.35130875490589947, 'f1-score': 0.2923645988410935, 'support': 64718}}
[[ 5848 14581   955]
 [ 5381 15710   780]
 [ 4686 15599  1178]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
4693/4693 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0709574
{'0': {'precision': 0.47351231170502467, 'recall': 0.43398397186124393, 'f1-score': 0.4528872624169593, 'support': 379832}, '1': {'precision': 0.37411157888596125, 'recall': 0.7010533268046051, 'f1-score': 0.48787337753676424, 'support': 439085}, '2': {'precision': 0.47594183740912094, 'recall': 0.0376744490223007, 'f1-score': 0.06982195450083023, 'support': 382275}, 'accuracy': 0.4054847185129438, 'macro avg': {'precision': 0.4411885760000356, 'recall': 0.3909039158960499, 'f1-score': 0.3368608648181846, 'support': 1201192}, 'weighted avg': {'precision': 0.4379504499615856, 'recall': 0.4054847185129438, 'f1-score': 0.3437669783772232, 'support': 1201192}}
[[164841 208484   6507]
 [121912 307822   9351]
 [ 61371 306502  14402]]
Evaluating performance on  train set...
1497/1497 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0802892
{'0': {'precision': 0.4985130328299026, 'recall': 0.4017481613759722, 'f1-score': 0.4449301950375373, 'support': 127677}, '1': {'precision': 0.3425795901947711, 'recall': 0.729346084915386, 'f1-score': 0.46618732750252806, 'support': 126102}, '2': {'precision': 0.459867639572374, 'recall': 0.041895338950297595, 'f1-score': 0.07679446853127035, 'support': 129370}, 'accuracy': 0.388063129487484, 'macro avg': {'precision': 0.43365342086568254, 'recall': 0.39099652841388527, 'f1-score': 0.3293039970237786, 'support': 383149}, 'weighted avg': {'precision': 0.43414362690974667, 'recall': 0.388063129487484, 'f1-score': 0.32762556414977434, 'support': 383149}}
[[ 51294  73842   2541]
 [ 30305  91972   3825]
 [ 21295 102655   5420]]
Evaluating performance on  val set...
547/547 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0744525
{'0': {'precision': 0.5144034044410497, 'recall': 0.4088593048719672, 'f1-score': 0.4555986421676995, 'support': 46121}, '1': {'precision': 0.3521152241866262, 'recall': 0.7436583243117026, 'f1-score': 0.4779334524767739, 'support': 47109}, '2': {'precision': 0.4668658337859859, 'recall': 0.03688603737956784, 'f1-score': 0.068370289350701, 'support': 46603}, 'accuracy': 0.3976815200989752, 'macro avg': {'precision': 0.44446148747122055, 'recall': 0.3964678888544126, 'f1-score': 0.3339674613317248, 'support': 139833}, 'weighted avg': {'precision': 0.44388623546917916, 'recall': 0.3976815200989752, 'f1-score': 0.3340691580868288, 'support': 139833}}
[[18857 26523   741]
 [10854 35033  1222]
 [ 6947 37937  1719]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
6677/6677 - 86s - 86s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0524697
{'0': {'precision': 0.42279238959393456, 'recall': 0.36832266621565085, 'f1-score': 0.3936823576984373, 'support': 449356}, '1': {'precision': 0.5062775864247994, 'recall': 0.7646009253554645, 'f1-score': 0.6091853902303808, 'support': 827790}, '2': {'precision': 0.34460537984037837, 'recall': 0.05395473689082242, 'f1-score': 0.09330132052821129, 'support': 432140}, 'accuracy': 0.4807580475122361, 'macro avg': {'precision': 0.42455845195303743, 'recall': 0.3956261094873126, 'f1-score': 0.3653896894856765, 'support': 1709286}, 'weighted avg': {'precision': 0.4434562671952955, 'recall': 0.4807580475122361, 'f1-score': 0.42210626914267546, 'support': 1709286}}
[[165508 271083  12765]
 [163282 632929  31579]
 [ 62674 346150  23316]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0938159
{'0': {'precision': 0.42188202355419135, 'recall': 0.337418082461943, 'f1-score': 0.37495220212650593, 'support': 194708}, '1': {'precision': 0.3324440760139166, 'recall': 0.6931134353215982, 'f1-score': 0.4493584280383415, 'support': 190937}, '2': {'precision': 0.4072016625369675, 'recall': 0.052741371099654225, 'f1-score': 0.09338710416571194, 'support': 193188}, 'accuracy': 0.3597376099842269, 'macro avg': {'precision': 0.3871759207016918, 'recall': 0.3610909629610652, 'f1-score': 0.3058992447768531, 'support': 578833}, 'weighted avg': {'precision': 0.387479902435159, 'recall': 0.3597376099842269, 'f1-score': 0.3055226834433595, 'support': 578833}}
[[ 65698 121355   7655]
 [ 51418 132341   7178]
 [ 38610 144389  10189]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865697
{'0': {'precision': 0.41210114882249793, 'recall': 0.3719162278885405, 'f1-score': 0.39097884646780323, 'support': 67612}, '1': {'precision': 0.3603865745586491, 'recall': 0.6811880926944434, 'f1-score': 0.47138443565205884, 'support': 75819}, '2': {'precision': 0.4183828610919143, 'recall': 0.04442781031218352, 'f1-score': 0.08032586774227789, 'support': 68133}, 'accuracy': 0.377285360458301, 'macro avg': {'precision': 0.39695686149102044, 'recall': 0.3658440436317225, 'f1-score': 0.31422971662071336, 'support': 211564}, 'weighted avg': {'precision': 0.39559098922985164, 'recall': 0.377285360458301, 'f1-score': 0.31975005502339326, 'support': 211564}}
[[25146 40488  1978]
 [21942 51647  2230]
 [13931 51175  3027]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
5633/5633 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0558811
{'0': {'precision': 0.3559865421251952, 'recall': 0.29862676778028285, 'f1-score': 0.324793611249599, 'support': 361046}, '1': {'precision': 0.49615958389513143, 'recall': 0.7603675646343988, 'f1-score': 0.6004862766679674, 'support': 700285}, '2': {'precision': 0.3476403332725172, 'recall': 0.06009151044801224, 'f1-score': 0.10247044983474315, 'support': 380503}, 'accuracy': 0.4599399098647972, 'macro avg': {'precision': 0.39992881976428124, 'recall': 0.3730286142875647, 'f1-score': 0.34258344591743645, 'support': 1441834}, 'weighted avg': {'precision': 0.4218646675188184, 'recall': 0.4599399098647972, 'f1-score': 0.4000233591364329, 'support': 1441834}}
[[107818 239611  13617]
 [138521 532474  29290]
 [ 56532 301106  22865]]
Evaluating performance on  train set...
1454/1454 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968947
{'0': {'precision': 0.4064746488931207, 'recall': 0.27698970777877807, 'f1-score': 0.32946646922345973, 'support': 123297}, '1': {'precision': 0.3360264549485189, 'recall': 0.7427213309566251, 'f1-score': 0.4627105967065147, 'support': 122859}, '2': {'precision': 0.4119498759004782, 'recall': 0.054034095871810954, 'f1-score': 0.0955369301829311, 'support': 125939}, 'accuracy': 0.3553044249452425, 'macro avg': {'precision': 0.3848169932473726, 'recall': 0.35791504486907133, 'f1-score': 0.29590466537096854, 'support': 372095}, 'weighted avg': {'precision': 0.38506707812285984, 'recall': 0.3553044249452425, 'f1-score': 0.29428563648240036, 'support': 372095}}
[[34152 84180  4965]
 [26860 91250  4749]
 [23008 96126  6805]]
Evaluating performance on  val set...
557/557 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1067286
{'0': {'precision': 0.4111958036226539, 'recall': 0.3065251924565191, 'f1-score': 0.35122804970538474, 'support': 49102}, '1': {'precision': 0.29709862671660425, 'recall': 0.7055405341302595, 'f1-score': 0.41812674383464415, 'support': 42162}, '2': {'precision': 0.43058243885271863, 'recall': 0.04784249320585763, 'f1-score': 0.08611648777054373, 'support': 51147}, 'accuracy': 0.33175105855587, 'macro avg': {'precision': 0.3796256230639923, 'recall': 0.35330273993087874, 'f1-score': 0.2851570937701909, 'support': 142411}, 'weighted avg': {'precision': 0.3843790763993302, 'recall': 0.33175105855587006, 'f1-score': 0.27581899902528645, 'support': 142411}}
[[15051 32289  1762]
 [10941 29747  1474]
 [10611 38089  2447]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
11876/11876 - 150s - 150s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1119312
{'0': {'precision': 0.4545093340605292, 'recall': 0.31737619206815854, 'f1-score': 0.37376122966585107, 'support': 1160588}, '1': {'precision': 0.2348273018544547, 'recall': 0.6786524347648603, 'f1-score': 0.3489209749579874, 'support': 695714}, '2': {'precision': 0.45219558054417175, 'recall': 0.0836976087483539, 'f1-score': 0.1412508669053493, 'support': 1183857}, 'accuracy': 0.3090552171777858, 'macro avg': {'precision': 0.3805107388197186, 'recall': 0.35990874519379085, 'f1-score': 0.28797769050972927, 'support': 3040159}, 'weighted avg': {'precision': 0.40333601758240045, 'recall': 0.3090552171777858, 'f1-score': 0.2775357580736133, 'support': 3040159}}
[[368343 716069  76176]
 [179706 472148  43860]
 [262370 822401  99086]]
Evaluating performance on  train set...
2538/2538 - 31s - 31s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0999513
{'0': {'precision': 0.4211319271583912, 'recall': 0.28900616762267817, 'f1-score': 0.3427776237497068, 'support': 222452}, '1': {'precision': 0.3234667982977835, 'recall': 0.7127223768752007, 'f1-score': 0.44498057082003406, 'support': 208711}, '2': {'precision': 0.3930285221329595, 'recall': 0.06673471816608838, 'f1-score': 0.11409632331074206, 'support': 218462}, 'accuracy': 0.35038984029247644, 'macro avg': {'precision': 0.3792090825297114, 'recall': 0.35615442088798904, 'f1-score': 0.3006181726268276, 'support': 649625}, 'weighted avg': {'precision': 0.380303275585111, 'recall': 0.35038984029247644, 'f1-score': 0.29871020797829706, 'support': 649625}}
[[ 64290 147019  11143]
 [ 48586 148753  11372]
 [ 39784 164099  14579]]
Evaluating performance on  val set...
795/795 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1019256
{'0': {'precision': 0.4036428480448351, 'recall': 0.3226852862026329, 'f1-score': 0.3586522449111575, 'support': 68745}, '1': {'precision': 0.3184471436542341, 'recall': 0.6806880733944954, 'f1-score': 0.4339015760694757, 'support': 65400}, '2': {'precision': 0.40202741619629073, 'recall': 0.050370199315888986, 'f1-score': 0.08952390724399753, 'support': 69287}, 'accuracy': 0.345029297259035, 'macro avg': {'precision': 0.37470580263178666, 'recall': 0.35124785297100575, 'f1-score': 0.2940259094082102, 'support': 203432}, 'weighted avg': {'precision': 0.37570364726209005, 'recall': 0.345029297259035, 'f1-score': 0.29118110529600105, 'support': 203432}}
[[22183 43960  2602]
 [18294 44517  2589]
 [14480 51317  3490]]
testing model on single stock: results/universal/W0/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
19053/19053 - 234s - 234s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0735894
{'0': {'precision': 0.34977597497782376, 'recall': 0.26894215318110753, 'f1-score': 0.3040787058283616, 'support': 1379661}, '1': {'precision': 0.44762416293776597, 'recall': 0.7378093855298545, 'f1-score': 0.5571991935479621, 'support': 2149543}, '2': {'precision': 0.3437493146579138, 'recall': 0.06975353922537933, 'f1-score': 0.11597371615943197, 'support': 1348247}, 'accuracy': 0.4205161671537038, 'macro avg': {'precision': 0.38038315085783453, 'recall': 0.3588350259787805, 'f1-score': 0.32575053851191854, 'support': 4877451}, 'weighted avg': {'precision': 0.3912327647632343, 'recall': 0.4205161671537038, 'f1-score': 0.36363468794444803, 'support': 4877451}}
[[ 371049  937812   70800]
 [ 454849 1585953  108741]
 [ 234921 1019281   94045]]
Evaluating performance on  train set...
4812/4812 - 61s - 61s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008302
{'0': {'precision': 0.37119570270869545, 'recall': 0.2542519027310652, 'f1-score': 0.3017909506038407, 'support': 408229}, '1': {'precision': 0.33854351430205537, 'recall': 0.6910351044414397, 'f1-score': 0.45444893377681356, 'support': 406017}, '2': {'precision': 0.3897301762114537, 'recall': 0.11524057640641537, 'f1-score': 0.1778825007854226, 'support': 417622}, 'accuracy': 0.35108631768988235, 'macro avg': {'precision': 0.36648979774073487, 'recall': 0.3535091945263067, 'f1-score': 0.3113741283886923, 'support': 1231868}, 'weighted avg': {'precision': 0.3667171874074376, 'recall': 0.35108631768988235, 'f1-score': 0.31009934218790125, 'support': 1231868}}
[[103793 265735  38701]
 [ 88785 280572  36660]
 [ 87040 282455  48127]]
Evaluating performance on  val set...
1767/1767 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0981133
{'0': {'precision': 0.36819964349376116, 'recall': 0.24564741699172296, 'f1-score': 0.29468998773076155, 'support': 147154}, '1': {'precision': 0.3542239892363757, 'recall': 0.7057769759493832, 'f1-score': 0.47170360054939103, 'support': 157418}, '2': {'precision': 0.37334750055598115, 'recall': 0.10228065068609067, 'f1-score': 0.16057176258037092, 'support': 147721}, 'accuracy': 0.3589686331647848, 'macro avg': {'precision': 0.365257044428706, 'recall': 0.35123501454239897, 'f1-score': 0.3089884502868412, 'support': 452293}, 'weighted avg': {'precision': 0.36501681079725495, 'recall': 0.3589686331647848, 'f1-score': 0.31249492958314967, 'support': 452293}}
[[ 36148  98705  12301]
 [ 33257 111102  13059]
 [ 28770 103842  15109]]
training model: results/universal/W0/deepVOL_L2/h200
Epoch 1/50
8838/8838 - 572s - loss: 3.2644 - accuracy200: 0.3803 - val_loss: 3.2847 - val_accuracy200: 0.3549 - 572s/epoch - 65ms/step
Epoch 2/50
8838/8838 - 573s - loss: 3.2580 - accuracy200: 0.3850 - val_loss: 3.2837 - val_accuracy200: 0.3587 - 573s/epoch - 65ms/step
Epoch 3/50
8838/8838 - 567s - loss: 3.2493 - accuracy200: 0.3911 - val_loss: 3.2835 - val_accuracy200: 0.3547 - 567s/epoch - 64ms/step
Epoch 4/50
8838/8838 - 559s - loss: 3.2430 - accuracy200: 0.3950 - val_loss: 3.2818 - val_accuracy200: 0.3581 - 559s/epoch - 63ms/step
Epoch 5/50
8838/8838 - 570s - loss: 3.2367 - accuracy200: 0.3984 - val_loss: 3.2858 - val_accuracy200: 0.3570 - 570s/epoch - 65ms/step
Epoch 6/50
8838/8838 - 570s - loss: 3.2326 - accuracy200: 0.4006 - val_loss: 3.2942 - val_accuracy200: 0.3551 - 570s/epoch - 64ms/step
Epoch 7/50
8838/8838 - 574s - loss: 3.2293 - accuracy200: 0.4022 - val_loss: 3.2984 - val_accuracy200: 0.3538 - 574s/epoch - 65ms/step
Epoch 8/50
8838/8838 - 576s - loss: 3.2268 - accuracy200: 0.4034 - val_loss: 3.2981 - val_accuracy200: 0.3558 - 576s/epoch - 65ms/step
Epoch 9/50
8838/8838 - 575s - loss: 3.2242 - accuracy200: 0.4045 - val_loss: 3.3046 - val_accuracy200: 0.3552 - 575s/epoch - 65ms/step
Epoch 10/50
8838/8838 - 572s - loss: 3.2221 - accuracy200: 0.4053 - val_loss: 3.3013 - val_accuracy200: 0.3556 - 572s/epoch - 65ms/step
Epoch 11/50
8838/8838 - 560s - loss: 3.2209 - accuracy200: 0.4060 - val_loss: 3.2979 - val_accuracy200: 0.3570 - 560s/epoch - 63ms/step
Epoch 12/50
8838/8838 - 567s - loss: 3.2192 - accuracy200: 0.4070 - val_loss: 3.3002 - val_accuracy200: 0.3555 - 567s/epoch - 64ms/step
Epoch 13/50
8838/8838 - 572s - loss: 3.2177 - accuracy200: 0.4074 - val_loss: 3.2966 - val_accuracy200: 0.3560 - 572s/epoch - 65ms/step
Epoch 14/50
8838/8838 - 566s - loss: 3.2163 - accuracy200: 0.4082 - val_loss: 3.3026 - val_accuracy200: 0.3544 - 566s/epoch - 64ms/step
testing model in sample: results/universal/W0/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1214s - 1214s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0778211
{'0': {'precision': 0.3335686145764938, 'recall': 0.24876456713396627, 'f1-score': 0.2849916666979714, 'support': 2287255}, '1': {'precision': 0.4607399451401561, 'recall': 0.5998623063143249, 'f1-score': 0.5211765781637534, 'support': 3824431}, '2': {'precision': 0.32423052830584426, 'recall': 0.24470263885103727, 'f1-score': 0.27890821085010936, 'support': 2337343}, 'accuracy': 0.4065643519509757, 'macro avg': {'precision': 0.3728463626741647, 'recall': 0.36444317076644284, 'f1-score': 0.3616921519039447, 'support': 8449029}, 'weighted avg': {'precision': 0.3885490943855723, 'recall': 0.4065643519509757, 'f1-score': 0.3902172226997537, 'support': 8449029}}
[[ 568988 1279239  439028]
 [ 777246 2294132  753053]
 [ 359526 1405863  571954]]
Evaluating performance on  train set...
8838/8838 - 319s - 319s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962236
{'0': {'precision': 0.38611058602237114, 'recall': 0.2205691004884708, 'f1-score': 0.2807546273316958, 'support': 750096}, '1': {'precision': 0.33505344230507206, 'recall': 0.5684922720020098, 'f1-score': 0.4216173894514632, 'support': 748318}, '2': {'precision': 0.37257176095877537, 'recall': 0.27510744338434223, 'f1-score': 0.31650627022531835, 'support': 763658}, 'accuracy': 0.3540775890422586, 'macro avg': {'precision': 0.3645785964287395, 'recall': 0.3547229386249409, 'f1-score': 0.3396260956694925, 'support': 2262072}, 'weighted avg': {'precision': 0.36464972547387525, 'recall': 0.3540775890422586, 'f1-score': 0.33942303776814436, 'support': 2262072}}
[[165448 408954 175694]
 [144801 425413 178104]
 [118250 435320 210088]]
Evaluating performance on  val set...
3279/3279 - 121s - 121s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941485
{'0': {'precision': 0.39262241621513144, 'recall': 0.22785455101305488, 'f1-score': 0.2883614028865618, 'support': 274763}, '1': {'precision': 0.3441216015279773, 'recall': 0.5745555757584234, 'f1-score': 0.4304384386272368, 'support': 285988}, '2': {'precision': 0.3631708488711267, 'recall': 0.2636718609551067, 'f1-score': 0.3055245983256016, 'support': 278126}, 'accuracy': 0.35792613219816494, 'macro avg': {'precision': 0.36663828887141187, 'recall': 0.35536066257552834, 'f1-score': 0.34144147994646673, 'support': 838877}, 'weighted avg': {'precision': 0.3663230927030212, 'recall': 0.35792613219816494, 'f1-score': 0.3424883585571578, 'support': 838877}}
[[ 62606 150807  61350]
 [ 54429 164316  67243]
 [ 42421 162371  73334]]
testing model out of sample: results/universal/W0/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 844s - 844s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920491
{'0': {'precision': 0.40277625737172446, 'recall': 0.2824203840687258, 'f1-score': 0.33202797101150844, 'support': 1941163}, '1': {'precision': 0.34579228054815264, 'recall': 0.6058186800544744, 'f1-score': 0.44027955046260947, 'support': 1929716}, '2': {'precision': 0.3982392946179792, 'recall': 0.22144566695411613, 'f1-score': 0.28462322526042183, 'support': 1962084}, 'accuracy': 0.3688994769896535, 'macro avg': {'precision': 0.3822692775126188, 'recall': 0.36989491035910543, 'f1-score': 0.3523102489115133, 'support': 5832963}, 'weighted avg': {'precision': 0.3823981418500255, 'recall': 0.3688994769896535, 'f1-score': 0.3518948399989829, 'support': 5832963}}
[[ 548224 1060997  331942]
 [ 436055 1169058  324603]
 [ 376834 1150755  434495]]
Evaluating performance on  train set...
6334/6334 - 241s - 241s/epoch - 38ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941037
{'0': {'precision': 0.39358185933775364, 'recall': 0.2558300022135128, 'f1-score': 0.3100961159072615, 'support': 537607}, '1': {'precision': 0.34388677641328447, 'recall': 0.6017767202497131, 'f1-score': 0.43766743070337677, 'support': 547188}, '2': {'precision': 0.37361825213274974, 'recall': 0.21877057665942307, 'f1-score': 0.27595618450881687, 'support': 536105}, 'accuracy': 0.3603584428403973, 'macro avg': {'precision': 0.37036229596126263, 'recall': 0.358792433040883, 'f1-score': 0.34123991037315166, 'support': 1620900}, 'weighted avg': {'precision': 0.37020278433256326, 'recall': 0.3603584428403973, 'f1-score': 0.3418703800064, 'support': 1620900}}
[[137536 303827  96244]
 [117517 329285 100386]
 [ 94394 324427 117284]]
Evaluating performance on  val set...
2156/2156 - 86s - 86s/epoch - 40ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0907563
{'0': {'precision': 0.3830559315213813, 'recall': 0.2950876955678795, 'f1-score': 0.33336622978062314, 'support': 177432}, '1': {'precision': 0.35951726320885286, 'recall': 0.5949539352731531, 'f1-score': 0.44819835503663635, 'support': 194726}, '2': {'precision': 0.3802313877855821, 'recall': 0.19608532583216126, 'f1-score': 0.2587389669736459, 'support': 179172}, 'accuracy': 0.36882447898717646, 'macro avg': {'precision': 0.37426819417193874, 'recall': 0.36204231889106464, 'f1-score': 0.34676785059696846, 'support': 551330}, 'weighted avg': {'precision': 0.37382431003142785, 'recall': 0.36882447898717646, 'f1-score': 0.34967168112727703, 'support': 551330}}
[[ 52358  98258  26816]
 [ 48423 115853  30450]
 [ 35904 108135  35133]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
876/876 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014823
{'0': {'precision': 0.3486783486783487, 'recall': 0.16483902219850888, 'f1-score': 0.22385142671916564, 'support': 71221}, '1': {'precision': 0.3523601481622186, 'recall': 0.6103904321964184, 'f1-score': 0.4467974728104793, 'support': 79015}, '2': {'precision': 0.33056633338307717, 'recall': 0.23973538603065517, 'f1-score': 0.2779176174457174, 'support': 73919}, 'accuracy': 0.3465949900738328, 'macro avg': {'precision': 0.34386827674121484, 'recall': 0.3383216134751941, 'f1-score': 0.31618883899178746, 'support': 224155}, 'weighted avg': {'precision': 0.34400343769089275, 'recall': 0.3465949900738328, 'f1-score': 0.32026953286991466, 'support': 224155}}
[[11740 43184 16297]
 [11195 48230 19590]
 [10735 45463 17721]]
Evaluating performance on  train set...
318/318 - 8s - 8s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001974
{'0': {'precision': 0.39422054701845943, 'recall': 0.14805270226126094, 'f1-score': 0.21526201910391046, 'support': 27551}, '1': {'precision': 0.3273545443021929, 'recall': 0.5785602270181465, 'f1-score': 0.4181283393599222, 'support': 26782}, '2': {'precision': 0.3529111988788381, 'recall': 0.3089793641940881, 'f1-score': 0.32948733198525043, 'support': 26895}, 'accuracy': 0.3432806421431034, 'macro avg': {'precision': 0.3581620967331635, 'recall': 0.34519743115783186, 'f1-score': 0.3209592301496944, 'support': 81228}, 'weighted avg': {'precision': 0.3584961637643825, 'recall': 0.3432806421431034, 'f1-score': 0.3199704395874894, 'support': 81228}}
[[ 4079 15889  7583]
 [ 3633 15495  7654]
 [ 2635 15950  8310]]
Evaluating performance on  val set...
104/104 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1020039
{'0': {'precision': 0.391304347826087, 'recall': 0.11850240439661094, 'f1-score': 0.18191405220142368, 'support': 8734}, '1': {'precision': 0.3448214812629094, 'recall': 0.6371169992367245, 'f1-score': 0.4474651554602543, 'support': 9171}, '2': {'precision': 0.33376792698826596, 'recall': 0.26828132277596645, 'f1-score': 0.297463043057259, 'support': 8588}, 'accuracy': 0.3465821160306496, 'macro avg': {'precision': 0.35663125202575413, 'recall': 0.34130024213643395, 'f1-score': 0.30894741690631233, 'support': 26493}, 'weighted avg': {'precision': 0.3565624480259092, 'recall': 0.3465821160306496, 'f1-score': 0.31129554548103144, 'support': 26493}}
[[1035 5448 2251]
 [ 980 5843 2348]
 [ 630 5654 2304]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
2359/2359 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0816027
{'0': {'precision': 0.3817233108797714, 'recall': 0.3427906950101104, 'f1-score': 0.36121095789534047, 'support': 174573}, '1': {'precision': 0.37796640121306785, 'recall': 0.5974463637264708, 'f1-score': 0.4630135264418545, 'support': 221958}, '2': {'precision': 0.42889970262233035, 'recall': 0.19902343467289405, 'f1-score': 0.2718838879349836, 'support': 207257}, 'accuracy': 0.38705472781837336, 'macro avg': {'precision': 0.3961964715717232, 'recall': 0.3797534978031584, 'f1-score': 0.3653694574240595, 'support': 603788}, 'weighted avg': {'precision': 0.3965360618247808, 'recall': 0.38705472781837336, 'f1-score': 0.367971996489472, 'support': 603788}}
[[ 59842  91902  22829]
 [ 57254 132608  32096]
 [ 39672 126336  41249]]
Evaluating performance on  train set...
589/589 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879183
{'0': {'precision': 0.39964605855422614, 'recall': 0.40928253417911037, 'f1-score': 0.404406898431113, 'support': 50762}, '1': {'precision': 0.3210106645600869, 'recall': 0.5206189694518958, 'f1-score': 0.3971443842101245, 'support': 49954}, '2': {'precision': 0.41580523075184994, 'recall': 0.14725239552701594, 'f1-score': 0.21748507947763399, 'support': 49989}, 'accuracy': 0.3592714243057629, 'macro avg': {'precision': 0.37882065128872106, 'recall': 0.3590512997193407, 'f1-score': 0.33967878737295715, 'support': 150705}, 'weighted avg': {'precision': 0.3789408954037254, 'recall': 0.3592714243057629, 'f1-score': 0.3399974465677991, 'support': 150705}}
[[20776 25436  4550]
 [18155 26007  5792]
 [13055 29573  7361]]
Evaluating performance on  val set...
230/230 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911883
{'0': {'precision': 0.42909749471777847, 'recall': 0.36112381242696745, 'f1-score': 0.3921871551533878, 'support': 19683}, '1': {'precision': 0.2944165418392223, 'recall': 0.5757279880535294, 'f1-score': 0.38959928485366707, 'support': 17411}, '2': {'precision': 0.449317738791423, 'recall': 0.1697505293197091, 'f1-score': 0.2464087659517605, 'support': 21726}, 'accuracy': 0.35396123767426046, 'macro avg': {'precision': 0.39094392511614123, 'recall': 0.3688674432667353, 'f1-score': 0.3427317353196051, 'support': 58820}, 'weighted avg': {'precision': 0.3966999250505813, 'recall': 0.35396123767426046, 'f1-score': 0.33757582068240866, 'support': 58820}}
[[ 7108 10502  2073]
 [ 4940 10024  2447]
 [ 4517 13521  3688]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
1625/1625 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0773085
{'0': {'precision': 0.28855805833717235, 'recall': 0.22576973422115987, 'f1-score': 0.25333134658776446, 'support': 105426}, '1': {'precision': 0.47132266874756146, 'recall': 0.6495787775587023, 'f1-score': 0.5462767561049141, 'support': 195265}, '2': {'precision': 0.32, 'recall': 0.178534213268496, 'f1-score': 0.22919569700685583, 'support': 115160}, 'accuracy': 0.41169072576475707, 'macro avg': {'precision': 0.359960242361578, 'recall': 0.35129424168278606, 'f1-score': 0.3429345998998448, 'support': 415851}, 'weighted avg': {'precision': 0.3830832263749452, 'recall': 0.41169072576475707, 'f1-score': 0.38420159574823004, 'support': 415851}}
[[ 23802  66669  14955]
 [ 39690 126840  28735]
 [ 18994  75606  20560]]
Evaluating performance on  train set...
451/451 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1007764
{'0': {'precision': 0.36815880414690993, 'recall': 0.24213113454372473, 'f1-score': 0.29213232363491437, 'support': 37839}, '1': {'precision': 0.33012464046021095, 'recall': 0.6786681033349977, 'f1-score': 0.44418452647149886, 'support': 38051}, '2': {'precision': 0.3822027716994894, 'recall': 0.119211324570273, 'f1-score': 0.18173760573421455, 'support': 39560}, 'accuracy': 0.34388912949328715, 'macro avg': {'precision': 0.3601620721022034, 'recall': 0.3466701874829985, 'f1-score': 0.3060181519468759, 'support': 115450}, 'weighted avg': {'precision': 0.3604354727821413, 'recall': 0.34388912949328715, 'f1-score': 0.30441922991454357, 'support': 115450}}
[[ 9162 24912  3765]
 [ 8369 25824  3858]
 [ 7355 27489  4716]]
Evaluating performance on  val set...
177/177 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094153
{'0': {'precision': 0.38026914704136155, 'recall': 0.2603658536585366, 'f1-score': 0.3090967586262366, 'support': 14760}, '1': {'precision': 0.35726965200790434, 'recall': 0.6686935807422267, 'f1-score': 0.4657163439498788, 'support': 15952}, '2': {'precision': 0.35872093023255813, 'recall': 0.12844355006592187, 'f1-score': 0.1891574268049665, 'support': 14411}, 'accuracy': 0.36258670744409727, 'macro avg': {'precision': 0.36541990976060806, 'recall': 0.3525009948222284, 'f1-score': 0.32132350979369395, 'support': 45123}, 'weighted avg': {'precision': 0.36525641966939215, 'recall': 0.36258670744409727, 'f1-score': 0.3261601168738358, 'support': 45123}}
[[ 3843  9324  1593]
 [ 3569 10667  1716]
 [ 2694  9866  1851]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1269/1269 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0999055
{'0': {'precision': 0.35263672228455606, 'recall': 0.0954569057579825, 'f1-score': 0.15024364668147053, 'support': 102067}, '1': {'precision': 0.36357277235559843, 'recall': 0.8480159377602982, 'f1-score': 0.5089441704417199, 'support': 116453}, '2': {'precision': 0.3268009720153641, 'recall': 0.07847972591393396, 'f1-score': 0.12656536984471528, 'support': 106244}, 'accuracy': 0.35975354411203214, 'macro avg': {'precision': 0.34767015555183955, 'recall': 0.3406508564774049, 'f1-score': 0.26191772898930193, 'support': 324764}, 'weighted avg': {'precision': 0.34810617821970613, 'recall': 0.35975354411203214, 'f1-score': 0.27111935103665796, 'support': 324764}}
[[ 9743 84363  7961]
 [ 8484 98754  9215]
 [ 9402 88504  8338]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1056108
{'0': {'precision': 0.3291202229299363, 'recall': 0.08043293201994406, 'f1-score': 0.1292731075191056, 'support': 41115}, '1': {'precision': 0.32572680477330673, 'recall': 0.82071761803571, 'f1-score': 0.4663631695096393, 'support': 40941}, '2': {'precision': 0.3242533936651584, 'recall': 0.08490722528969881, 'f1-score': 0.1345752971886796, 'support': 42199}, 'accuracy': 0.32587018631041004, 'macro avg': {'precision': 0.3263668071228005, 'recall': 0.3286859251151176, 'f1-score': 0.2434038580724748, 'support': 124255}, 'weighted avg': {'precision': 0.32634926593911145, 'recall': 0.32587018631041004, 'f1-score': 0.24214221805647468, 'support': 124255}}
[[ 3307 34284  3524]
 [ 3397 33601  3943]
 [ 3344 35272  3583]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1051993
{'0': {'precision': 0.3475177304964539, 'recall': 0.07033492822966507, 'f1-score': 0.116991643454039, 'support': 14630}, '1': {'precision': 0.3293837662666464, 'recall': 0.8704670145858424, 'f1-score': 0.4779222687532143, 'support': 14946}, '2': {'precision': 0.3302842208428618, 'recall': 0.06340943301555443, 'f1-score': 0.10639305445935279, 'support': 15944}, 'accuracy': 0.33062390158172233, 'macro avg': {'precision': 0.3357285725353207, 'recall': 0.3347371252770206, 'f1-score': 0.23376898888886868, 'support': 45520}, 'weighted avg': {'precision': 0.3355273678581504, 'recall': 0.33062390158172233, 'f1-score': 0.23178701302324367, 'support': 45520}}
[[ 1029 12596  1005]
 [  891 13010  1045]
 [ 1041 13892  1011]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
1733/1733 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939567
{'0': {'precision': 0.33589784421840474, 'recall': 0.24681507700858576, 'f1-score': 0.2845471561303813, 'support': 136738}, '1': {'precision': 0.36294991449821784, 'recall': 0.649851522585167, 'f1-score': 0.4657646522265039, 'support': 162651}, '2': {'precision': 0.3830091091554732, 'recall': 0.137701824136328, 'f1-score': 0.2025732498379598, 'support': 144123}, 'accuracy': 0.3591650282292249, 'macro avg': {'precision': 0.3606189559573653, 'recall': 0.34478947457669357, 'f1-score': 0.317628352731615, 'support': 443512}, 'weighted avg': {'precision': 0.3611279690393949, 'recall': 0.3591650282292249, 'f1-score': 0.3243676833335862, 'support': 443512}}
[[ 33749  87857  15132]
 [ 40114 105699  16838]
 [ 26611  97666  19846]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10206
{'0': {'precision': 0.3540684503765383, 'recall': 0.18133927031561123, 'f1-score': 0.23984157101827946, 'support': 63781}, '1': {'precision': 0.32635961603881025, 'recall': 0.6840530737514338, 'f1-score': 0.4418932991548844, 'support': 64514}, '2': {'precision': 0.37376237623762376, 'recall': 0.1544264773451511, 'f1-score': 0.21855367350149454, 'support': 67469}, 'accuracy': 0.33773318894178705, 'macro avg': {'precision': 0.3513968142176574, 'recall': 0.33993960713739874, 'f1-score': 0.3000961812248861, 'support': 195764}, 'weighted avg': {'precision': 0.3517244123790382, 'recall': 0.33773318894178705, 'f1-score': 0.2990909326549694, 'support': 195764}}
[[11566 43602  8613]
 [11539 44131  8844]
 [ 9561 47489 10419]]
Evaluating performance on  val set...
253/253 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996066
{'0': {'precision': 0.3590166509582155, 'recall': 0.21694352159468439, 'f1-score': 0.27045736938642684, 'support': 21070}, '1': {'precision': 0.34304602202054635, 'recall': 0.6683870388654519, 'f1-score': 0.4533913784705309, 'support': 22282}, '2': {'precision': 0.3595426971535231, 'recall': 0.14424787044837592, 'f1-score': 0.20589217716614336, 'support': 21366}, 'accuracy': 0.34837294106740013, 'macro avg': {'precision': 0.35386845671076167, 'recall': 0.3431928103028374, 'f1-score': 0.309913641674367, 'support': 64718}, 'weighted avg': {'precision': 0.35369173283682426, 'recall': 0.34837294106740013, 'f1-score': 0.31212484510312744, 'support': 64718}}
[[ 4571 13828  2671]
 [ 4570 14893  2819]
 [ 3591 14693  3082]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
4693/4693 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0677261
{'0': {'precision': 0.3869263624393847, 'recall': 0.4126881732706898, 'f1-score': 0.3993922735873814, 'support': 350342}, '1': {'precision': 0.42439066168966033, 'recall': 0.600187742248062, 'f1-score': 0.4972075774616089, 'support': 495360}, '2': {'precision': 0.42426891603462263, 'recall': 0.1515345016737461, 'f1-score': 0.22331016728882663, 'support': 355490}, 'accuracy': 0.4127233614609488, 'macro avg': {'precision': 0.41186198005455593, 'recall': 0.3881368057308327, 'f1-score': 0.373303339445939, 'support': 1201192}, 'weighted avg': {'precision': 0.41342772080190104, 'recall': 0.4127233614609488, 'f1-score': 0.38761926890458637, 'support': 1201192}}
[[144582 179119  26641]
 [151592 297309  46459]
 [ 77494 224127  53869]]
Evaluating performance on  train set...
1497/1497 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.083014
{'0': {'precision': 0.42490191097185764, 'recall': 0.3546471904818, 'f1-score': 0.3866087939182248, 'support': 127335}, '1': {'precision': 0.33344009155585164, 'recall': 0.614169078781777, 'f1-score': 0.43222163792864854, 'support': 127136}, '2': {'precision': 0.43654846114208085, 'recall': 0.14484216416170598, 'f1-score': 0.21751511332072918, 'support': 128678}, 'accuracy': 0.37029980503668286, 'macro avg': {'precision': 0.3982968212232634, 'recall': 0.3712194778084276, 'f1-score': 0.3454485150558675, 'support': 383149}, 'weighted avg': {'precision': 0.3984645847868242, 'recall': 0.37029980503668286, 'f1-score': 0.34495501928794964, 'support': 383149}}
[[45159 71988 10188]
 [35185 78083 13868]
 [25937 84103 18638]]
Evaluating performance on  val set...
547/547 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0760229
{'0': {'precision': 0.43820676483892046, 'recall': 0.37809240909780795, 'f1-score': 0.4059360996333586, 'support': 46121}, '1': {'precision': 0.3447424220519493, 'recall': 0.595513100663878, 'f1-score': 0.4366868871847697, 'support': 48051}, '2': {'precision': 0.42641620193718816, 'recall': 0.1590854339589584, 'f1-score': 0.23172132193441367, 'support': 45661}, 'accuracy': 0.38129053942917623, 'macro avg': {'precision': 0.40312179627601935, 'recall': 0.3775636479068814, 'f1-score': 0.35811476958418065, 'support': 139833}, 'weighted avg': {'precision': 0.4022394035728907, 'recall': 0.38129053942917623, 'f1-score': 0.35961502469483436, 'support': 139833}}
[[17438 24646  4037]
 [13702 28615  5734]
 [ 8654 29743  7264]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0693084
{'0': {'precision': 0.40196878957866183, 'recall': 0.3181699942772302, 'f1-score': 0.3551937774968141, 'support': 499758}, '1': {'precision': 0.45349645794764626, 'recall': 0.6613659138313258, 'f1-score': 0.5380522420022563, 'support': 747441}, '2': {'precision': 0.35465222853617206, 'recall': 0.1716646432381781, 'f1-score': 0.23134826774615969, 'support': 462087}, 'accuracy': 0.428637454469293, 'macro avg': {'precision': 0.40337249202082665, 'recall': 0.383733517115578, 'f1-score': 0.37486476241507666, 'support': 1709286}, 'weighted avg': {'precision': 0.41170942059707605, 'recall': 0.428637454469293, 'f1-score': 0.4016743041636572, 'support': 1709286}}
[[159008 290027  50723]
 [159489 494332  93620]
 [ 77076 305687  79324]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0909083
{'0': {'precision': 0.4005536817085821, 'recall': 0.30317005578923834, 'f1-score': 0.34512373410041963, 'support': 192331}, '1': {'precision': 0.3500644301266385, 'recall': 0.5999878147228611, 'f1-score': 0.4421533522657118, 'support': 196959}, '2': {'precision': 0.3829673832391025, 'recall': 0.19333343885028728, 'f1-score': 0.25695053115029975, 'support': 189543}, 'accuracy': 0.3682011910170982, 'macro avg': {'precision': 0.37786183169144105, 'recall': 0.3654971031207956, 'f1-score': 0.34807587250547706, 'support': 578833}, 'weighted avg': {'precision': 0.37761498907507884, 'recall': 0.3682011910170982, 'f1-score': 0.34926697257756795, 'support': 578833}}
[[ 58309 104679  29343]
 [ 49087 118173  29699]
 [ 38175 114723  36645]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0841917
{'0': {'precision': 0.38418966930855425, 'recall': 0.33862274547589655, 'f1-score': 0.35996991181601395, 'support': 66422}, '1': {'precision': 0.3768880423981451, 'recall': 0.5871660237637557, 'f1-score': 0.45909427910002876, 'support': 77513}, '2': {'precision': 0.3941103533787973, 'recall': 0.18799627378787206, 'f1-score': 0.25456256444653563, 'support': 67629}, 'accuracy': 0.38153466563309446, 'macro avg': {'precision': 0.3850626883618322, 'recall': 0.3712616810091747, 'f1-score': 0.3578755851208595, 'support': 211564}, 'weighted avg': {'precision': 0.3846857600247438, 'recall': 0.38153466563309446, 'f1-score': 0.362592444884189, 'support': 211564}}
[[22492 35146  8784]
 [21238 45513 10762]
 [14814 40101 12714]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
5633/5633 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0811008
{'0': {'precision': 0.3786945139248445, 'recall': 0.24887853692201517, 'f1-score': 0.30036005032028573, 'support': 417312}, '1': {'precision': 0.4074123121053848, 'recall': 0.6377090619724595, 'f1-score': 0.4971872738092222, 'support': 569269}, '2': {'precision': 0.3660051063583564, 'recall': 0.22230935326071438, 'f1-score': 0.27660839251623803, 'support': 455253}, 'accuracy': 0.394008602932099, 'macro avg': {'precision': 0.38403731079619524, 'recall': 0.369632317385063, 'f1-score': 0.358051905548582, 'support': 1441834}, 'weighted avg': {'precision': 0.3860263297854578, 'recall': 0.394008602932099, 'f1-score': 0.3705724487087668, 'support': 1441834}}
[[103860 242496  70956]
 [101886 363028 104355]
 [ 68512 285534 101207]]
Evaluating performance on  train set...
1454/1454 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962096
{'0': {'precision': 0.38664127767422524, 'recall': 0.23462255169214996, 'f1-score': 0.2920329781631082, 'support': 122891}, '1': {'precision': 0.338271072383746, 'recall': 0.6378039853599023, 'f1-score': 0.44207796600614474, 'support': 122950}, '2': {'precision': 0.384432741773462, 'recall': 0.20005702789614588, 'f1-score': 0.2631644751922316, 'support': 126254}, 'accuracy': 0.35611604563350757, 'macro avg': {'precision': 0.36978169727714444, 'recall': 0.3574945216493994, 'f1-score': 0.33242513978716154, 'support': 372095}, 'weighted avg': {'precision': 0.3699091172526141, 'recall': 0.35611604563350757, 'f1-score': 0.3318165476311642, 'support': 372095}}
[[28833 74141 19917]
 [24005 78418 20527]
 [21735 79261 25258]]
Evaluating performance on  val set...
557/557 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967817
{'0': {'precision': 0.384315723232747, 'recall': 0.2716585469180258, 'f1-score': 0.31831325002171723, 'support': 47210}, '1': {'precision': 0.3347566281835586, 'recall': 0.6164875317848671, 'f1-score': 0.43390182277567224, 'support': 46799}, '2': {'precision': 0.3880113760665062, 'recall': 0.18321556960456178, 'f1-score': 0.24890186227318017, 'support': 48402}, 'accuracy': 0.3549164039294717, 'macro avg': {'precision': 0.36902790916093725, 'recall': 0.3571205494358183, 'f1-score': 0.33370564502352323, 'support': 142411}, 'weighted avg': {'precision': 0.3692857107986839, 'recall': 0.3549164039294717, 'f1-score': 0.3327066580204508, 'support': 142411}}
[[12825 27649  6736]
 [10697 28851  7251]
 [ 9849 29685  8868]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
11876/11876 - 152s - 152s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058874
{'0': {'precision': 0.42778401333534416, 'recall': 0.28415542277619193, 'f1-score': 0.341481707573668, 'support': 1128020}, '1': {'precision': 0.24736168179166376, 'recall': 0.528478125536665, 'f1-score': 0.33699028249921614, 'support': 745344}, '2': {'precision': 0.42509896560363647, 'recall': 0.2544757219562991, 'f1-score': 0.31836785023079767, 'support': 1166795}, 'accuracy': 0.3326641797353362, 'macro avg': {'precision': 0.36674822024354814, 'recall': 0.3557030900897186, 'f1-score': 0.3322799467678939, 'support': 3040159}, 'weighted avg': {'precision': 0.3825200641306444, 'recall': 0.3326641797353362, 'f1-score': 0.331509600881529, 'support': 3040159}}
[[320533 572342 235145]
 [185037 393898 166409]
 [243717 626157 296921]]
Evaluating performance on  train set...
2538/2538 - 32s - 32s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926176
{'0': {'precision': 0.4, 'recall': 0.25366372828023415, 'f1-score': 0.31045164944074755, 'support': 216105}, '1': {'precision': 0.3509100866775829, 'recall': 0.568552439764218, 'f1-score': 0.4339726311424425, 'support': 220882}, '2': {'precision': 0.3714108414887978, 'recall': 0.27021510736556964, 'f1-score': 0.31283279795285024, 'support': 212638}, 'accuracy': 0.3661481624013854, 'macro avg': {'precision': 0.3741069760554602, 'recall': 0.3641437584700073, 'f1-score': 0.3524190261786801, 'support': 649625}, 'weighted avg': {'precision': 0.3739507874204547, 'recall': 0.3661481624013854, 'f1-score': 0.35322999716066333, 'support': 649625}}
[[ 54818 113914  47373]
 [ 45428 125583  49871]
 [ 36799 118381  57458]]
Evaluating performance on  val set...
795/795 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926532
{'0': {'precision': 0.38792432781161645, 'recall': 0.3076784155554887, 'f1-score': 0.34317271941383337, 'support': 66446}, '1': {'precision': 0.3505964660507669, 'recall': 0.5599358239743296, 'f1-score': 0.4312016679720681, 'support': 69808}, '2': {'precision': 0.37850717361942865, 'recall': 0.221099169370925, 'f1-score': 0.2791418825585657, 'support': 67178}, 'accuracy': 0.365650438475756, 'macro avg': {'precision': 0.37234265582727066, 'recall': 0.3629044696335811, 'f1-score': 0.351172089981489, 'support': 203432}, 'weighted avg': {'precision': 0.3720054509479756, 'recall': 0.365650438475756, 'f1-score': 0.35223550836881623, 'support': 203432}}
[[20444 34382 11620]
 [17952 39088 12768]
 [14305 38020 14853]]
testing model on single stock: results/universal/W0/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
19053/19053 - 239s - 239s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0773919
{'0': {'precision': 0.2873312229767929, 'recall': 0.20199024748161848, 'f1-score': 0.23721871343150597, 'support': 1242961}, '1': {'precision': 0.5071848247704285, 'recall': 0.5790977169734256, 'f1-score': 0.5407609214387594, 'support': 2421391}, '2': {'precision': 0.2964641805272049, 'recall': 0.30278155369017695, 'f1-score': 0.2995895675777962, 'support': 1213099}, 'accuracy': 0.41427212697780047, 'macro avg': {'precision': 0.36366007609147544, 'recall': 0.36128983938174036, 'f1-score': 0.3591897341493539, 'support': 4877451}, 'weighted avg': {'precision': 0.39874817301322385, 'recall': 0.41427212697780047, 'f1-score': 0.40342364124788016, 'support': 4877451}}
[[ 251066  681501  310394]
 [ 457918 1402222  561251]
 [ 164802  680993  367304]]
Evaluating performance on  train set...
4812/4812 - 61s - 61s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003839
{'0': {'precision': 0.3620365532435213, 'recall': 0.16473566948452548, 'f1-score': 0.22643689778316825, 'support': 407993}, '1': {'precision': 0.3377412085793877, 'recall': 0.5140289244532169, 'f1-score': 0.40764225806200405, 'support': 407337}, '2': {'precision': 0.36376005817908835, 'recall': 0.37225895356486083, 'f1-score': 0.3679604370153107, 'support': 416538}, 'accuracy': 0.3504060499988635, 'macro avg': {'precision': 0.3545126066673325, 'recall': 0.3503411825008677, 'f1-score': 0.334013197620161, 'support': 1231868}, 'weighted avg': {'precision': 0.3545856839047586, 'recall': 0.3504060499988635, 'f1-score': 0.33420946742908675, 'support': 1231868}}
[[ 67211 203536 137246]
 [ 63990 209383 133964]
 [ 54446 207032 155060]]
Evaluating performance on  val set...
1767/1767 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09818
{'0': {'precision': 0.36039943969996835, 'recall': 0.16264384613816027, 'f1-score': 0.22413728502379254, 'support': 147119}, '1': {'precision': 0.35760447716830995, 'recall': 0.5304035117551849, 'f1-score': 0.42719136060788204, 'support': 158781}, '2': {'precision': 0.34954851922284136, 'recall': 0.35910186962491375, 'f1-score': 0.3542607998328768, 'support': 146393}, 'accuracy': 0.3553360321738342, 'macro avg': {'precision': 0.3558508120303732, 'recall': 0.350716409172753, 'f1-score': 0.3351964818215171, 'support': 452293}, 'weighted avg': {'precision': 0.35590614498360684, 'recall': 0.3553360321738342, 'f1-score': 0.3375378923265003, 'support': 452293}}
[[23928 75984 47207]
 [23946 84218 50617]
 [18519 75304 52570]]
training model: results/universal/W0/deepVOL_L3/h50
Epoch 1/50
8838/8838 - 777s - loss: 3.1286 - accuracy50: 0.4437 - val_loss: 3.2098 - val_accuracy50: 0.4209 - 777s/epoch - 88ms/step
Epoch 2/50
8838/8838 - 779s - loss: 3.0474 - accuracy50: 0.4726 - val_loss: 3.1798 - val_accuracy50: 0.4326 - 779s/epoch - 88ms/step
Epoch 3/50
8838/8838 - 778s - loss: 3.0292 - accuracy50: 0.4778 - val_loss: 3.1655 - val_accuracy50: 0.4341 - 778s/epoch - 88ms/step
Epoch 4/50
8838/8838 - 778s - loss: 3.0175 - accuracy50: 0.4807 - val_loss: 3.1436 - val_accuracy50: 0.4378 - 778s/epoch - 88ms/step
Epoch 5/50
8838/8838 - 765s - loss: 3.0093 - accuracy50: 0.4824 - val_loss: 3.1450 - val_accuracy50: 0.4336 - 765s/epoch - 87ms/step
Epoch 6/50
8838/8838 - 765s - loss: 3.0019 - accuracy50: 0.4842 - val_loss: 3.1468 - val_accuracy50: 0.4371 - 765s/epoch - 87ms/step
Epoch 7/50
8838/8838 - 758s - loss: 2.9951 - accuracy50: 0.4858 - val_loss: 3.1427 - val_accuracy50: 0.4374 - 758s/epoch - 86ms/step
Epoch 8/50
8838/8838 - 773s - loss: 2.9911 - accuracy50: 0.4865 - val_loss: 3.1349 - val_accuracy50: 0.4385 - 773s/epoch - 87ms/step
Epoch 9/50
8838/8838 - 779s - loss: 2.9873 - accuracy50: 0.4877 - val_loss: 3.1370 - val_accuracy50: 0.4367 - 779s/epoch - 88ms/step
Epoch 10/50
8838/8838 - 782s - loss: 2.9843 - accuracy50: 0.4882 - val_loss: 3.1342 - val_accuracy50: 0.4374 - 782s/epoch - 88ms/step
Epoch 11/50
8838/8838 - 776s - loss: 2.9815 - accuracy50: 0.4890 - val_loss: 3.1455 - val_accuracy50: 0.4354 - 776s/epoch - 88ms/step
Epoch 12/50
8838/8838 - 770s - loss: 2.9794 - accuracy50: 0.4897 - val_loss: 3.1344 - val_accuracy50: 0.4371 - 770s/epoch - 87ms/step
Epoch 13/50
8838/8838 - 782s - loss: 2.9773 - accuracy50: 0.4900 - val_loss: 3.1438 - val_accuracy50: 0.4366 - 782s/epoch - 89ms/step
Epoch 14/50
8838/8838 - 780s - loss: 2.9747 - accuracy50: 0.4909 - val_loss: 3.1340 - val_accuracy50: 0.4369 - 780s/epoch - 88ms/step
Epoch 15/50
8838/8838 - 775s - loss: 2.9729 - accuracy50: 0.4917 - val_loss: 3.1288 - val_accuracy50: 0.4364 - 775s/epoch - 88ms/step
Epoch 16/50
8838/8838 - 772s - loss: 2.9707 - accuracy50: 0.4923 - val_loss: 3.1324 - val_accuracy50: 0.4361 - 772s/epoch - 87ms/step
Epoch 17/50
8838/8838 - 769s - loss: 2.9698 - accuracy50: 0.4923 - val_loss: 3.1290 - val_accuracy50: 0.4386 - 769s/epoch - 87ms/step
Epoch 18/50
8838/8838 - 765s - loss: 2.9675 - accuracy50: 0.4930 - val_loss: 3.1290 - val_accuracy50: 0.4394 - 765s/epoch - 87ms/step
Epoch 19/50
8838/8838 - 765s - loss: 2.9658 - accuracy50: 0.4933 - val_loss: 3.1319 - val_accuracy50: 0.4390 - 765s/epoch - 87ms/step
Epoch 20/50
8838/8838 - 766s - loss: 2.9639 - accuracy50: 0.4940 - val_loss: 3.1287 - val_accuracy50: 0.4389 - 766s/epoch - 87ms/step
Epoch 21/50
8838/8838 - 756s - loss: 2.9617 - accuracy50: 0.4947 - val_loss: 3.1267 - val_accuracy50: 0.4393 - 756s/epoch - 86ms/step
Epoch 22/50
8838/8838 - 762s - loss: 2.9597 - accuracy50: 0.4952 - val_loss: 3.1326 - val_accuracy50: 0.4398 - 762s/epoch - 86ms/step
Epoch 23/50
8838/8838 - 776s - loss: 2.9583 - accuracy50: 0.4957 - val_loss: 3.1347 - val_accuracy50: 0.4403 - 776s/epoch - 88ms/step
Epoch 24/50
8838/8838 - 769s - loss: 2.9571 - accuracy50: 0.4959 - val_loss: 3.1261 - val_accuracy50: 0.4413 - 769s/epoch - 87ms/step
Epoch 25/50
8838/8838 - 766s - loss: 2.9560 - accuracy50: 0.4962 - val_loss: 3.1291 - val_accuracy50: 0.4403 - 766s/epoch - 87ms/step
Epoch 26/50
8838/8838 - 766s - loss: 2.9549 - accuracy50: 0.4965 - val_loss: 3.1293 - val_accuracy50: 0.4401 - 766s/epoch - 87ms/step
Epoch 27/50
8838/8838 - 769s - loss: 2.9536 - accuracy50: 0.4969 - val_loss: 3.1297 - val_accuracy50: 0.4415 - 769s/epoch - 87ms/step
Epoch 28/50
8838/8838 - 779s - loss: 2.9520 - accuracy50: 0.4974 - val_loss: 3.1283 - val_accuracy50: 0.4404 - 779s/epoch - 88ms/step
Epoch 29/50
8838/8838 - 783s - loss: 2.9512 - accuracy50: 0.4976 - val_loss: 3.1432 - val_accuracy50: 0.4394 - 783s/epoch - 89ms/step
Epoch 30/50
8838/8838 - 776s - loss: 2.9500 - accuracy50: 0.4980 - val_loss: 3.1411 - val_accuracy50: 0.4389 - 776s/epoch - 88ms/step
Epoch 31/50
8838/8838 - 775s - loss: 2.9484 - accuracy50: 0.4984 - val_loss: 3.1426 - val_accuracy50: 0.4387 - 775s/epoch - 88ms/step
Epoch 32/50
8838/8838 - 761s - loss: 2.9469 - accuracy50: 0.4990 - val_loss: 3.1435 - val_accuracy50: 0.4394 - 761s/epoch - 86ms/step
Epoch 33/50
8838/8838 - 779s - loss: 2.9457 - accuracy50: 0.4993 - val_loss: 3.1364 - val_accuracy50: 0.4395 - 779s/epoch - 88ms/step
Epoch 34/50
8838/8838 - 768s - loss: 2.9441 - accuracy50: 0.4997 - val_loss: 3.1379 - val_accuracy50: 0.4375 - 768s/epoch - 87ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1584s - 1584s/epoch - 48ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0091872
{'0': {'precision': 0.35551241094354197, 'recall': 0.4346647555327475, 'f1-score': 0.39112422314285944, 'support': 2024627}, '1': {'precision': 0.6192549800216405, 'recall': 0.5320127688799058, 'f1-score': 0.5723282996128776, 'support': 4394434}, '2': {'precision': 0.3660390902416324, 'recall': 0.3963919628289707, 'f1-score': 0.3806113428057743, 'support': 2029968}, 'accuracy': 0.476101099901539, 'macro avg': {'precision': 0.4469354937356049, 'recall': 0.454356495747208, 'f1-score': 0.44802128852050377, 'support': 8449029}, 'weighted avg': {'precision': 0.495217001249189, 'recall': 0.476101099901539, 'f1-score': 0.4828446497038685, 'support': 8449029}}
[[ 880034  700445  444148]
 [1107052 2337895  949487]
 [ 488310  736995  804663]]
Evaluating performance on  train set...
8838/8838 - 450s - 450s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0451405
{'0': {'precision': 0.40781372722896453, 'recall': 0.4984172516056205, 'f1-score': 0.44858629166241765, 'support': 710473}, '1': {'precision': 0.5453389786536326, 'recall': 0.382840227346407, 'f1-score': 0.44986506316670316, 'support': 823589}, '2': {'precision': 0.41974015910227863, 'recall': 0.4702270573206412, 'f1-score': 0.44355157406195705, 'support': 728010}, 'accuracy': 0.44726472013269253, 'macro avg': {'precision': 0.4576309549949586, 'recall': 0.45049484542422286, 'f1-score': 0.4473343096303593, 'support': 2262072}, 'weighted avg': {'precision': 0.4617230837674312, 'recall': 0.44726472013269253, 'f1-score': 0.4474315350428811, 'support': 2262072}}
[[354112 127033 229328]
 [264368 315303 243918]
 [249838 135842 342330]]
Evaluating performance on  val set...
3279/3279 - 167s - 167s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0493085
{'0': {'precision': 0.39567790233513156, 'recall': 0.4894866586467352, 'f1-score': 0.43761140662824255, 'support': 253535}, '1': {'precision': 0.5433949411729201, 'recall': 0.3870087202161631, 'f1-score': 0.45205879873966837, 'support': 325680}, '2': {'precision': 0.4101717800615108, 'recall': 0.46327918601874746, 'f1-score': 0.43511096964611246, 'support': 259662}, 'accuracy': 0.44158917219091715, 'macro avg': {'precision': 0.44974820785652075, 'recall': 0.4465915216272152, 'f1-score': 0.4415937250046744, 'support': 838877}, 'weighted avg': {'precision': 0.45751294428630923, 'recall': 0.44158917219091715, 'f1-score': 0.4424463922044299, 'support': 838877}}
[[124102  51718  77715]
 [104368 126041  95271]
 [ 85174  54192 120296]]
testing model out of sample: results/universal/W0/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 1151s - 1151s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9844423
{'0': {'precision': 0.5005218028909998, 'recall': 0.4331550606153419, 'f1-score': 0.4644081059401311, 'support': 1909995}, '1': {'precision': 0.5112372345456366, 'recall': 0.6669543692880898, 'f1-score': 0.5788055291066092, 'support': 1982371}, '2': {'precision': 0.5008956238969395, 'recall': 0.41139814191199925, 'f1-score': 0.4517569596243611, 'support': 1940597}, 'accuracy': 0.5053748840854982, 'macro avg': {'precision': 0.5042182204445254, 'recall': 0.5038358572718104, 'f1-score': 0.4983235315570338, 'support': 5832963}, 'weighted avg': {'precision': 0.504287881449581, 'recall': 0.5053748840854982, 'f1-score': 0.49907785398636595, 'support': 5832963}}
[[ 827324  619978  462693]
 [ 327410 1322151  332810]
 [ 498189  644050  798358]]
Evaluating performance on  train set...
6334/6334 - 312s - 312s/epoch - 49ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0133238
{'0': {'precision': 0.48671342016125185, 'recall': 0.4211810273000908, 'f1-score': 0.4515821390415218, 'support': 532892}, '1': {'precision': 0.4808045599308967, 'recall': 0.6281017931534142, 'f1-score': 0.5446703509434644, 'support': 552100}, '2': {'precision': 0.48212050105012555, 'recall': 0.39450614657739763, 'f1-score': 0.43393502027345304, 'support': 535908}, 'accuracy': 0.48284163119254736, 'macro avg': {'precision': 0.4832128270474247, 'recall': 0.48126298901030085, 'f1-score': 0.4767291700861464, 'support': 1620900}, 'weighted avg': {'precision': 0.48318225609919707, 'recall': 0.48284163119254736, 'f1-score': 0.477454660274358, 'support': 1620900}}
[[224444 182687 125761]
 [103986 346775 101339]
 [132712 191777 211419]]
Evaluating performance on  val set...
2156/2156 - 109s - 109s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.012558
{'0': {'precision': 0.4814587371343402, 'recall': 0.4269773194004788, 'f1-score': 0.4525843277681065, 'support': 176274}, '1': {'precision': 0.48759422110552764, 'recall': 0.6304344515677108, 'f1-score': 0.549889645737359, 'support': 197007}, '2': {'precision': 0.4767363115986969, 'recall': 0.37561570129571076, 'f1-score': 0.4201776761368634, 'support': 178049}, 'accuracy': 0.4830917962019117, 'macro avg': {'precision': 0.4819297566128549, 'recall': 0.4776758240879668, 'f1-score': 0.474217216547443, 'support': 551330}, 'weighted avg': {'precision': 0.48212605098723404, 'recall': 0.4830917962019117, 'f1-score': 0.4768889309293299, 'support': 551330}}
[[ 75265  62506  38503]
 [ 37905 124200  34902]
 [ 43157  68014  66878]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2229575
{'0': {'precision': 0.3225991570708211, 'recall': 0.5618251822724666, 'f1-score': 0.4098583047970788, 'support': 61035}, '1': {'precision': 0.6203495414431562, 'recall': 0.03570539315771127, 'f1-score': 0.06752429744594289, 'support': 100405}, '2': {'precision': 0.30834225553176303, 'recall': 0.5510483935262697, 'f1-score': 0.3954232100460539, 'support': 62715}, 'accuracy': 0.32314692957997815, 'macro avg': {'precision': 0.4170969846819135, 'recall': 0.38285965631881586, 'f1-score': 0.2909352707630252, 'support': 224155}, 'weighted avg': {'precision': 0.4519806375770882, 'recall': 0.32314692957997815, 'f1-score': 0.2524790673256803, 'support': 224155}}
[[34291   936 25808]
 [45107  3585 51713]
 [26898  1258 34559]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1621858
{'0': {'precision': 0.385103712999188, 'recall': 0.5655488906554889, 'f1-score': 0.45820098075093313, 'support': 27674}, '1': {'precision': 0.42877906976744184, 'recall': 0.011014860727354194, 'f1-score': 0.021477975973789587, 'support': 26782}, '2': {'precision': 0.37557332263966514, 'recall': 0.5597265800089646, 'f1-score': 0.4495207811492253, 'support': 26772}, 'accuracy': 0.3807923376175703, 'macro avg': {'precision': 0.39648536846876503, 'recall': 0.3787634437972692, 'f1-score': 0.3097332459579827, 'support': 81228}, 'weighted avg': {'precision': 0.3963629560466867, 'recall': 0.3807923376175703, 'f1-score': 0.3113464254537649, 'support': 81228}}
[[15651   175 11848]
 [13421   295 13066]
 [11569   218 14985]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1957846
{'0': {'precision': 0.35019245573518093, 'recall': 0.5526667476612805, 'f1-score': 0.4287262617218793, 'support': 8231}, '1': {'precision': 0.5058823529411764, 'recall': 0.013084491327720865, 'f1-score': 0.025509195175004946, 'support': 9859}, '2': {'precision': 0.35107185990338163, 'recall': 0.5534928001904081, 'f1-score': 0.42963373516234815, 'support': 8403}, 'accuracy': 0.35213075151926926, 'macro avg': {'precision': 0.402382222859913, 'recall': 0.37308134639313656, 'f1-score': 0.2946230640197441, 'support': 26493}, 'weighted avg': {'precision': 0.40840920467940395, 'recall': 0.35213075151926926, 'f1-score': 0.2789624916782687, 'support': 26493}}
[[4549   53 3629]
 [4762  129 4968]
 [3679   73 4651]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
2359/2359 - 43s - 43s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8506107
{'0': {'precision': 0.5487487754920296, 'recall': 0.4320108249844005, 'f1-score': 0.4834322520918081, 'support': 142633}, '1': {'precision': 0.6759662367297509, 'recall': 0.7806111382684955, 'f1-score': 0.7245296851948114, 'support': 308899}, '2': {'precision': 0.5265360330615304, 'recall': 0.4660965741908365, 'f1-score': 0.49447628338007565, 'support': 152256}, 'accuracy': 0.6189506913022451, 'macro avg': {'precision': 0.5837503484277703, 'recall': 0.5595728458145776, 'f1-score': 0.5674794068888983, 'support': 603788}, 'weighted avg': {'precision': 0.6082321094558922, 'recall': 0.6189506913022451, 'f1-score': 0.6095630728698148, 'support': 603788}}
[[ 61619  58039  22975]
 [ 26931 241130  40838]
 [ 23740  57550  70966]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.907478
{'0': {'precision': 0.5168457982959291, 'recall': 0.45426068229651023, 'f1-score': 0.48353652182973844, 'support': 40862}, '1': {'precision': 0.6113624175157973, 'recall': 0.7523205600906704, 'f1-score': 0.6745563652501657, 'support': 69703}, '2': {'precision': 0.5428541889237344, 'recall': 0.3924265072247135, 'f1-score': 0.455543184348656, 'support': 40140}, 'accuracy': 0.5756477887263196, 'macro avg': {'precision': 0.557020801578487, 'recall': 0.5330025832039648, 'f1-score': 0.5378786904761866, 'support': 150705}, 'weighted avg': {'precision': 0.5674882368963909, 'recall': 0.5756477887263196, 'f1-score': 0.5644296811770951, 'support': 150705}}
[[18562 16615  5685]
 [ 9684 52439  7580]
 [ 7668 16720 15752]]
Evaluating performance on  val set...
230/230 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91291624
{'0': {'precision': 0.5491816829227971, 'recall': 0.40252029565006664, 'f1-score': 0.4645504125297161, 'support': 16506}, '1': {'precision': 0.5745621690812823, 'recall': 0.7730546422420542, 'f1-score': 0.659190280698241, 'support': 25548}, '2': {'precision': 0.5593618399740848, 'recall': 0.4119646904449481, 'f1-score': 0.4744796317922649, 'support': 16766}, 'accuracy': 0.5661509690581434, 'macro avg': {'precision': 0.5610352306593881, 'recall': 0.5291798761123564, 'f1-score': 0.5327401083400739, 'support': 58820}, 'weighted avg': {'precision': 0.563107238405607, 'recall': 0.5661509690581434, 'f1-score': 0.5519209096756761, 'support': 58820}}
[[ 6644  7561  2301]
 [ 2658 19750  3140]
 [ 2796  7063  6907]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
1625/1625 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0551705
{'0': {'precision': 0.4432644455124727, 'recall': 0.4203106279447544, 'f1-score': 0.43148248059792715, 'support': 136047}, '1': {'precision': 0.4358127308894572, 'recall': 0.5232987140389413, 'f1-score': 0.4755656766316197, 'support': 140673}, '2': {'precision': 0.4699542976334823, 'recall': 0.39836556913987536, 'f1-score': 0.4312088630245694, 'support': 139131}, 'accuracy': 0.4478070270361259, 'macro avg': {'precision': 0.449677158011804, 'recall': 0.4473249703745237, 'f1-score': 0.44608567341803873, 'support': 415851}, 'weighted avg': {'precision': 0.4496733053307363, 'recall': 0.4478070270361259, 'f1-score': 0.44630328600430774, 'support': 415851}}
[[57182 47737 31128]
 [35675 73614 31384]
 [36145 47561 55425]]
Evaluating performance on  train set...
451/451 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0690649
{'0': {'precision': 0.41865957398023523, 'recall': 0.4768358926146454, 'f1-score': 0.44585800622672606, 'support': 38292}, '1': {'precision': 0.4290512407705546, 'recall': 0.4075568211780836, 'f1-score': 0.4180279099956729, 'support': 37926}, '2': {'precision': 0.4465946217642624, 'recall': 0.4076519168026101, 'f1-score': 0.42623562490838585, 'support': 39232}, 'accuracy': 0.4305673451710697, 'macro avg': {'precision': 0.43143514550501744, 'recall': 0.4306815435317797, 'f1-score': 0.4300405137102616, 'support': 115450}, 'weighted avg': {'precision': 0.43156613222495244, 'recall': 0.4305673451710697, 'f1-score': 0.43004761650355544, 'support': 115450}}
[[18259 10144  9889]
 [12540 15457  9929]
 [12814 10425 15993]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0776004
{'0': {'precision': 0.42626223596084495, 'recall': 0.4340897166841553, 'f1-score': 0.43014036911879383, 'support': 15248}, '1': {'precision': 0.4095299420476497, 'recall': 0.4276780310671777, 'f1-score': 0.4184072892339068, 'support': 14871}, '2': {'precision': 0.42893707785282614, 'recall': 0.4020927752599307, 'f1-score': 0.4150813581478551, 'support': 15004}, 'accuracy': 0.42133723378321475, 'macro avg': {'precision': 0.42157641862044026, 'recall': 0.42128684100375463, 'f1-score': 0.4212096721668519, 'support': 45123}, 'weighted avg': {'precision': 0.42163726388372597, 'recall': 0.42133723378321475, 'f1-score': 0.42126622441263245, 'support': 45123}}
[[6619 4590 4039]
 [4518 6360 3993]
 [4391 4580 6033]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2226448
{'0': {'precision': 0.32608437627757925, 'recall': 0.6876801987632918, 'f1-score': 0.44239416963870365, 'support': 107867}, '1': {'precision': 0.3272640153330139, 'recall': 0.006231865544991697, 'f1-score': 0.012230827774544479, 'support': 109598}, '2': {'precision': 0.31564351443337957, 'recall': 0.2800398885357739, 'f1-score': 0.29677769821477074, 'support': 107299}, 'accuracy': 0.32303149363845746, 'macro avg': {'precision': 0.32299730201465754, 'recall': 0.3246506509480191, 'f1-score': 0.2504675652093396, 'support': 324764}, 'weighted avg': {'precision': 0.32303290519758504, 'recall': 0.32303149363845746, 'f1-score': 0.2491167629404714, 'support': 324764}}
[[74178   620 33069]
 [76836   683 32079]
 [76467   784 30048]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2180656
{'0': {'precision': 0.32551720856085753, 'recall': 0.6629676293855399, 'f1-score': 0.4366427562655092, 'support': 41272}, '1': {'precision': 0.2914572864321608, 'recall': 0.005644356859596623, 'f1-score': 0.01107424998209981, 'support': 41103}, '2': {'precision': 0.32097355464189636, 'recall': 0.301981852913085, 'f1-score': 0.3111882089515514, 'support': 41880}, 'accuracy': 0.3238581948412539, 'macro avg': {'precision': 0.3126493498783049, 'recall': 0.32353127971940715, 'f1-score': 0.2529684050663868, 'support': 124255}, 'weighted avg': {'precision': 0.3127189050287509, 'recall': 0.3238581948412539, 'f1-score': 0.2535822858194465, 'support': 124255}}
[[27362   285 13625]
 [27741   232 13130]
 [28954   279 12647]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2125278
{'0': {'precision': 0.3230431334268806, 'recall': 0.7080770259427654, 'f1-score': 0.44367170807323314, 'support': 14956}, '1': {'precision': 0.3540856031128405, 'recall': 0.006020111140513363, 'f1-score': 0.01183893839849086, 'support': 15116}, '2': {'precision': 0.3279384664690329, 'recall': 0.26495339202485757, 'f1-score': 0.2931003616312793, 'support': 15448}, 'accuracy': 0.32456063268892793, 'macro avg': {'precision': 0.3350224010029181, 'recall': 0.3263501763693788, 'f1-score': 0.2495370027010011, 'support': 45520}, 'weighted avg': {'precision': 0.33501284073373777, 'recall': 0.32456063268892793, 'f1-score': 0.24917236039663587, 'support': 45520}}
[[10590    87  4279]
 [10916    91  4109]
 [11276    79  4093]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1558386
{'0': {'precision': 0.3391590828507269, 'recall': 0.5171000172689527, 'f1-score': 0.4096404174262679, 'support': 133187}, '1': {'precision': 0.43107402441606096, 'recall': 0.14065980876943535, 'f1-score': 0.21210845439038892, 'support': 173717}, '2': {'precision': 0.3673243943318604, 'recall': 0.49412186694776294, 'f1-score': 0.421391382517823, 'support': 136608}, 'accuracy': 0.36257643536138817, 'macro avg': {'precision': 0.3791858338662161, 'recall': 0.383960564328717, 'f1-score': 0.3477134181114933, 'support': 443512}, 'weighted avg': {'precision': 0.38383610348313324, 'recall': 0.36257643536138817, 'f1-score': 0.3358895737433988, 'support': 443512}}
[[68871 16431 47885]
 [80904 24435 68378]
 [53289 15818 67501]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1110071
{'0': {'precision': 0.38422703190705854, 'recall': 0.4997527888507772, 'f1-score': 0.43444098210927845, 'support': 64722}, '1': {'precision': 0.4027713891444342, 'recall': 0.21662491882363855, 'f1-score': 0.2817269601238714, 'support': 64674}, '2': {'precision': 0.39567436651996146, 'recall': 0.4578561957569913, 'f1-score': 0.4245002305016554, 'support': 66368}, 'accuracy': 0.39201283177703766, 'macro avg': {'precision': 0.3942242625238181, 'recall': 0.39141130114380235, 'f1-score': 0.38022272424493514, 'support': 195764}, 'weighted avg': {'precision': 0.3942343594216127, 'recall': 0.39201283177703766, 'f1-score': 0.38061916369231236, 'support': 195764}}
[[32345 10144 22233]
 [26486 14010 24178]
 [25351 10630 30387]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.119588
{'0': {'precision': 0.38696981410549247, 'recall': 0.518528982436314, 'f1-score': 0.44319233710307077, 'support': 21237}, '1': {'precision': 0.4203185177474758, 'recall': 0.18253322484404666, 'f1-score': 0.2545305556431025, 'support': 22122}, '2': {'precision': 0.3894349816162677, 'recall': 0.4859778079498104, 'f1-score': 0.432382896298919, 'support': 21359}, 'accuracy': 0.3929355048054637, 'macro avg': {'precision': 0.39890777115641196, 'recall': 0.3956800050767237, 'f1-score': 0.3767019296816974, 'support': 64718}, 'weighted avg': {'precision': 0.3991826997761035, 'recall': 0.3929355048054637, 'f1-score': 0.3751362356229061, 'support': 64718}}
[[11012  2639  7586]
 [ 9396  4038  8688]
 [ 8049  2930 10380]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
4693/4693 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8036198
{'0': {'precision': 0.6431862200167322, 'recall': 0.3923292286935641, 'f1-score': 0.48737226261525407, 'support': 286099}, '1': {'precision': 0.6463089105830901, 'recall': 0.900662367757544, 'f1-score': 0.7525752053172746, 'support': 627446}, '2': {'precision': 0.6751126052185789, 'recall': 0.3574554923221866, 'f1-score': 0.467422360319037, 'support': 287647}, 'accuracy': 0.6495073227260921, 'macro avg': {'precision': 0.6548692452728004, 'recall': 0.5501490295910983, 'f1-score': 0.5691232760838553, 'support': 1201192}, 'weighted avg': {'precision': 0.6524627125585194, 'recall': 0.6495073227260921, 'f1-score': 0.6211243988605937, 'support': 1201192}}
[[112245 150787  23067]
 [ 35915 565117  26414]
 [ 26354 158472 102821]]
Evaluating performance on  train set...
1497/1497 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8499497
{'0': {'precision': 0.6491246085126046, 'recall': 0.3836172020389999, 'f1-score': 0.4822412795687304, 'support': 98872}, '1': {'precision': 0.5995083463361498, 'recall': 0.8866851360986682, 'f1-score': 0.7153511920836599, 'support': 183727}, '2': {'precision': 0.6305915216488619, 'recall': 0.3322725012431626, 'f1-score': 0.4352187166193367, 'support': 100550}, 'accuracy': 0.6113731211617413, 'macro avg': {'precision': 0.6264081588325388, 'recall': 0.5341916131269436, 'f1-score': 0.5442703960905756, 'support': 383149}, 'weighted avg': {'precision': 0.6204690492261576, 'recall': 0.6113731211617413, 'f1-score': 0.5816816179020392, 'support': 383149}}
[[ 37929  52155   8788]
 [ 10035 162908  10784]
 [ 10467  56673  33410]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8294209
{'0': {'precision': 0.6770806393213676, 'recall': 0.37697269899781133, 'f1-score': 0.48430360545350276, 'support': 34724}, '1': {'precision': 0.6103812127090498, 'recall': 0.8962367292919412, 'f1-score': 0.7261908231001907, 'support': 69514}, '2': {'precision': 0.6655634528783029, 'recall': 0.34462705436156765, 'f1-score': 0.45411468552178585, 'support': 35595}, 'accuracy': 0.6268763453548161, 'macro avg': {'precision': 0.6510084349695734, 'recall': 0.5392788275504401, 'f1-score': 0.5548697046918264, 'support': 139833}, 'weighted avg': {'precision': 0.6409911740809053, 'recall': 0.6268763453548161, 'f1-score': 0.5968662583503326, 'support': 139833}}
[[13090 19049  2585]
 [ 3634 62301  3579]
 [ 2609 20719 12267]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
6677/6677 - 119s - 119s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81095505
{'0': {'precision': 0.6012216726950617, 'recall': 0.34298377672734165, 'f1-score': 0.43678900620077094, 'support': 379948}, '1': {'precision': 0.6678041660851952, 'recall': 0.9030852161945178, 'f1-score': 0.7678249996564848, 'support': 959090}, '2': {'precision': 0.5963884073091026, 'recall': 0.3149672651844169, 'f1-score': 0.41222725947135397, 'support': 370248}, 'accuracy': 0.6511911991322693, 'macro avg': {'precision': 0.6218047486964532, 'recall': 0.5203454193687588, 'f1-score': 0.5389470884428699, 'support': 1709286}, 'weighted avg': {'precision': 0.6375345523084924, 'recall': 0.6511911991322693, 'f1-score': 0.6172148526421315, 'support': 1709286}}
[[130316 215994  33638]
 [ 47667 866140  45283]
 [ 38769 214863 116616]]
Evaluating performance on  train set...
2262/2262 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9589766
{'0': {'precision': 0.5408619405123503, 'recall': 0.40905002871477025, 'f1-score': 0.4658107266030367, 'support': 184574}, '1': {'precision': 0.5190127768977069, 'recall': 0.7640385543550461, 'f1-score': 0.6181292394054732, 'support': 209263}, '2': {'precision': 0.5364180355985821, 'recall': 0.3803866029535774, 'f1-score': 0.4451247861193431, 'support': 184996}, 'accuracy': 0.5282266214953191, 'macro avg': {'precision': 0.5320975843362131, 'recall': 0.5178250620077979, 'f1-score': 0.5096882507092843, 'support': 578833}, 'weighted avg': {'precision': 0.5315426270680259, 'recall': 0.5282266214953191, 'f1-score': 0.5142665207593043, 'support': 578833}}
[[ 75500  72128  36946]
 [ 25509 159885  23869]
 [ 38583  76043  70370]]
Evaluating performance on  val set...
827/827 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9432056
{'0': {'precision': 0.5520036112194021, 'recall': 0.4195072508966162, 'f1-score': 0.47672038771297187, 'support': 64130}, '1': {'precision': 0.5355441703632168, 'recall': 0.7836365160533154, 'f1-score': 0.6362615404810174, 'support': 83503}, '2': {'precision': 0.553185207056913, 'recall': 0.35166038385133974, 'f1-score': 0.4299812569330223, 'support': 63931}, 'accuracy': 0.5427246601501201, 'macro avg': {'precision': 0.5469109962131773, 'recall': 0.5182680502670904, 'f1-score': 0.5143210617090038, 'support': 211564}, 'weighted avg': {'precision': 0.5458642298202693, 'recall': 0.5427246601501201, 'f1-score': 0.5255665312425759, 'support': 211564}}
[[26903 27338  9889]
 [ 9797 65436  8270]
 [12037 29412 22482]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
5633/5633 - 100s - 100s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9083735
{'0': {'precision': 0.4933695558677639, 'recall': 0.38837728950130346, 'f1-score': 0.43462254917437565, 'support': 354444}, '1': {'precision': 0.6389502034029844, 'recall': 0.7724122475511996, 'f1-score': 0.699370969307184, 'support': 718413}, '2': {'precision': 0.4918717831116547, 'recall': 0.392382181003152, 'f1-score': 0.43653007136805355, 'support': 368977}, 'accuracy': 0.5807527080093825, 'macro avg': {'precision': 0.5413971807941343, 'recall': 0.5177239060185518, 'f1-score': 0.5235078632832044, 'support': 1441834}, 'weighted avg': {'precision': 0.5655237608868503, 'recall': 0.5807527080093825, 'f1-score': 0.5670251271197757, 'support': 1441834}}
[[137658 154371  62415]
 [ 76352 554911  87150]
 [ 65006 159191 144780]]
Evaluating performance on  train set...
1454/1454 - 27s - 27s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0178934
{'0': {'precision': 0.47739444090812644, 'recall': 0.45536899711796897, 'f1-score': 0.46612167442168806, 'support': 123524}, '1': {'precision': 0.49590611812572505, 'recall': 0.4813355200352483, 'f1-score': 0.488512195828865, 'support': 122559}, '2': {'precision': 0.458488530211659, 'recall': 0.4923261276703806, 'f1-score': 0.4748052226355023, 'support': 126012}, 'accuracy': 0.47643746892594635, 'macro avg': {'precision': 0.4772630297485035, 'recall': 0.4763435482745326, 'f1-score': 0.4764796976286851, 'support': 372095}, 'weighted avg': {'precision': 0.47708914529659824, 'recall': 0.47643746892594635, 'f1-score': 0.47643729594485107, 'support': 372095}}
[[56249 29437 37838]
 [28132 58992 35435]
 [33444 30529 62039]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0110505
{'0': {'precision': 0.46960300795937304, 'recall': 0.41991965767181905, 'f1-score': 0.44337382725156177, 'support': 45804}, '1': {'precision': 0.4871018853144861, 'recall': 0.5694987927732912, 'f1-score': 0.5250875593724512, 'support': 48044}, '2': {'precision': 0.48624177377324324, 'recall': 0.4533904412824578, 'f1-score': 0.4692418349405935, 'support': 48563}, 'accuracy': 0.4817956478081047, 'macro avg': {'precision': 0.4809822223490341, 'recall': 0.4809362972425227, 'f1-score': 0.4792344071882022, 'support': 142411}, 'weighted avg': {'precision': 0.48118037521238044, 'recall': 0.4817956478081047, 'f1-score': 0.47976204588227467, 'support': 142411}}
[[19234 14273 12297]
 [ 9716 27361 10967]
 [12008 14537 22018]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
11876/11876 - 209s - 209s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0296774
{'0': {'precision': 0.5377971558813892, 'recall': 0.447314419834336, 'f1-score': 0.4884003572831014, 'support': 1199778}, '1': {'precision': 0.3349642617644861, 'recall': 0.5820150340352942, 'f1-score': 0.42520967944304006, 'support': 608486}, '2': {'precision': 0.5322908639764297, 'recall': 0.42559633735018, 'f1-score': 0.473001501219741, 'support': 1231895}, 'accuracy': 0.465474338677681, 'macro avg': {'precision': 0.46835076054076835, 'recall': 0.48497526373993677, 'f1-score': 0.46220384598196085, 'support': 3040159}, 'weighted avg': {'precision': 0.49496908344311275, 'recall': 0.465474338677681, 'f1-score': 0.46951305020924083, 'support': 3040159}}
[[536678 338819 324281]
 [117940 354148 136398]
 [343301 364304 524290]]
Evaluating performance on  train set...
2538/2538 - 52s - 52s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.003681
{'0': {'precision': 0.5398998002554111, 'recall': 0.3788080687405229, 'f1-score': 0.4452305407412408, 'support': 217630}, '1': {'precision': 0.45984998187622045, 'recall': 0.7369750064416387, 'f1-score': 0.5663283214561504, 'support': 213455}, '2': {'precision': 0.5144021493431845, 'recall': 0.36445959549739176, 'f1-score': 0.42664002699677006, 'support': 218540}, 'accuracy': 0.4916682701558592, 'macro avg': {'precision': 0.5047173104916053, 'recall': 0.4934142235598511, 'f1-score': 0.4793996297313871, 'support': 649625}, 'weighted avg': {'precision': 0.5050192297532166, 'recall': 0.4916682701558592, 'f1-score': 0.4787670516649035, 'support': 649625}}
[[ 82440  90269  44921]
 [ 25876 157311  30268]
 [ 44379  94512  79649]]
Evaluating performance on  val set...
795/795 - 17s - 17s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0127928
{'0': {'precision': 0.5199613206243956, 'recall': 0.3907575487927864, 'f1-score': 0.4461943590655456, 'support': 67428}, '1': {'precision': 0.4509833260078741, 'recall': 0.7235341775190542, 'f1-score': 0.5556355675893655, 'support': 66652}, '2': {'precision': 0.512023741980535, 'recall': 0.33833198754181565, 'f1-score': 0.40743892062720305, 'support': 69352}, 'accuracy': 0.481915332887648, 'macro avg': {'precision': 0.4943227962042682, 'recall': 0.4842079046178854, 'f1-score': 0.4697562824273714, 'support': 203432}, 'weighted avg': {'precision': 0.49465552679014435, 'recall': 0.481915332887648, 'f1-score': 0.4688393129762071, 'support': 203432}}
[[26348 27724 13356]
 [ 9421 48225  9006]
 [14904 30984 23464]]
testing model on single stock: results/universal/W0/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
19053/19053 - 338s - 338s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950698
{'0': {'precision': 0.293971239431112, 'recall': 0.4363602520854211, 'f1-score': 0.3512853153234727, 'support': 1133584}, '1': {'precision': 0.5831422772293797, 'recall': 0.37097302817635064, 'f1-score': 0.45346732248350896, 'support': 2630078}, '2': {'precision': 0.2996213306134681, 'recall': 0.4093387526721848, 'f1-score': 0.3459902035073554, 'support': 1113789}, 'accuracy': 0.394930876804298, 'macro avg': {'precision': 0.39224494909131996, 'recall': 0.4055573443113188, 'f1-score': 0.383580947104779, 'support': 4877451}, 'weighted avg': {'precision': 0.45119176182247944, 'recall': 0.394930876804298, 'f1-score': 0.4051759667585958, 'support': 4877451}}
[[494651 336501 302432]
 [891095 975688 763295]
 [296905 360967 455917]]
Evaluating performance on  train set...
4812/4812 - 87s - 87s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1134
{'0': {'precision': 0.3738244267606077, 'recall': 0.5269951692725333, 'f1-score': 0.43738761440457485, 'support': 405943}, '1': {'precision': 0.40072798154188877, 'recall': 0.09912496279185332, 'f1-score': 0.15893532972158508, 'support': 406497}, '2': {'precision': 0.39060571477634953, 'recall': 0.5206257092993315, 'f1-score': 0.4463396936032786, 'support': 419428}, 'accuracy': 0.3836360713972601, 'macro avg': {'precision': 0.388386041026282, 'recall': 0.38224861378790603, 'f1-score': 0.3475542125764795, 'support': 1231868}, 'weighted avg': {'precision': 0.3884158897889459, 'recall': 0.3836360713972601, 'f1-score': 0.3485507701220484, 'support': 1231868}}
[[213930  28586 163427]
 [188953  40294 177250]
 [169391  31672 218365]]
Evaluating performance on  val set...
1767/1767 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1308746
{'0': {'precision': 0.35710274048223656, 'recall': 0.5255713730615705, 'f1-score': 0.42525995666912475, 'support': 141545}, '1': {'precision': 0.42102838422359296, 'recall': 0.09823358692925988, 'f1-score': 0.15929966251712838, 'support': 167458}, '2': {'precision': 0.36590841430739723, 'recall': 0.5232395840602972, 'f1-score': 0.4306544396609907, 'support': 143290}, 'accuracy': 0.36661411960830703, 'macro avg': {'precision': 0.3813465130044089, 'recall': 0.3823481813503759, 'f1-score': 0.3384046862824146, 'support': 452293}, 'weighted avg': {'precision': 0.38356042488603526, 'recall': 0.36661411960830703, 'f1-score': 0.3284992208845769, 'support': 452293}}
[[74392 10829 56324]
 [77406 16450 73602]
 [56523 11792 74975]]
training model: results/universal/W0/deepVOL_L3/h100
Epoch 1/50
8838/8838 - 756s - loss: 3.2440 - accuracy100: 0.3963 - val_loss: 3.2709 - val_accuracy100: 0.3621 - 756s/epoch - 86ms/step
Epoch 2/50
8838/8838 - 772s - loss: 3.2037 - accuracy100: 0.4149 - val_loss: 3.2643 - val_accuracy100: 0.3733 - 772s/epoch - 87ms/step
Epoch 3/50
8838/8838 - 775s - loss: 3.1806 - accuracy100: 0.4229 - val_loss: 3.2652 - val_accuracy100: 0.3651 - 775s/epoch - 88ms/step
Epoch 4/50
8838/8838 - 745s - loss: 3.1697 - accuracy100: 0.4263 - val_loss: 3.2867 - val_accuracy100: 0.3572 - 745s/epoch - 84ms/step
Epoch 5/50
8838/8838 - 735s - loss: 3.1613 - accuracy100: 0.4292 - val_loss: 3.3006 - val_accuracy100: 0.3538 - 735s/epoch - 83ms/step
Epoch 6/50
8838/8838 - 773s - loss: 3.1553 - accuracy100: 0.4315 - val_loss: 3.3132 - val_accuracy100: 0.3512 - 773s/epoch - 87ms/step
Epoch 7/50
8838/8838 - 774s - loss: 3.1510 - accuracy100: 0.4331 - val_loss: 3.3132 - val_accuracy100: 0.3520 - 774s/epoch - 88ms/step
Epoch 8/50
8838/8838 - 758s - loss: 3.1473 - accuracy100: 0.4345 - val_loss: 3.3115 - val_accuracy100: 0.3536 - 758s/epoch - 86ms/step
Epoch 9/50
8838/8838 - 740s - loss: 3.1443 - accuracy100: 0.4355 - val_loss: 3.3014 - val_accuracy100: 0.3543 - 740s/epoch - 84ms/step
Epoch 10/50
8838/8838 - 740s - loss: 3.1423 - accuracy100: 0.4362 - val_loss: 3.2998 - val_accuracy100: 0.3554 - 740s/epoch - 84ms/step
Epoch 11/50
8838/8838 - 768s - loss: 3.1392 - accuracy100: 0.4374 - val_loss: 3.2887 - val_accuracy100: 0.3622 - 768s/epoch - 87ms/step
Epoch 12/50
8838/8838 - 757s - loss: 3.1371 - accuracy100: 0.4380 - val_loss: 3.3038 - val_accuracy100: 0.3603 - 757s/epoch - 86ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1555s - 1555s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0761807
{'0': {'precision': 0.39228403608750784, 'recall': 0.26943144359545573, 'f1-score': 0.31945347324547485, 'support': 2397493}, '1': {'precision': 0.44847439269238715, 'recall': 0.46547083601056616, 'f1-score': 0.4568145747466975, 'support': 3641820}, '2': {'precision': 0.33793390032046045, 'recall': 0.42387318671577895, 'f1-score': 0.3760561477194867, 'support': 2409716}, 'accuracy': 0.3979788683409656, 'macro avg': {'precision': 0.3928974430334518, 'recall': 0.3862584887739336, 'f1-score': 0.3841080652372197, 'support': 8449029}, 'weighted avg': {'precision': 0.40100299926431254, 'recall': 0.3979788683409656, 'f1-score': 0.39480423568125306, 'support': 8449029}}
[[ 645960  999543  751990]
 [ 697537 1695161 1249122]
 [ 303167 1085135 1021414]]
Evaluating performance on  train set...
8838/8838 - 437s - 437s/epoch - 49ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889944
{'0': {'precision': 0.4272868147191284, 'recall': 0.2275300707727952, 'f1-score': 0.29693980514961726, 'support': 750147}, '1': {'precision': 0.3455156143788236, 'recall': 0.4276035014277212, 'f1-score': 0.38220161288394455, 'support': 747695}, '2': {'precision': 0.3773031924087205, 'recall': 0.4627415830312864, 'f1-score': 0.41567754872713514, 'support': 764230}, 'accuracy': 0.3731264964156755, 'macro avg': {'precision': 0.3833685405022242, 'recall': 0.37262505174393423, 'f1-score': 0.36493965558689895, 'support': 2262072}, 'weighted avg': {'precision': 0.38337181054741004, 'recall': 0.3731264964156755, 'f1-score': 0.3652368235947261, 'support': 2262072}}
[[170681 292695 286771]
 [131104 319717 296874]
 [ 97668 312921 353641]]
Evaluating performance on  val set...
3279/3279 - 161s - 161s/epoch - 49ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0880187
{'0': {'precision': 0.43452506875396657, 'recall': 0.23002532395516107, 'f1-score': 0.3008102043226645, 'support': 276813}, '1': {'precision': 0.34554377330223046, 'recall': 0.4327762418621243, 'f1-score': 0.38427159187733007, 'support': 280325}, '2': {'precision': 0.374415013172277, 'recall': 0.45349774081685534, 'f1-score': 0.41017936197603155, 'support': 281739}, 'accuracy': 0.37283177390725936, 'macro avg': {'precision': 0.38482795174282464, 'recall': 0.37209976887804697, 'f1-score': 0.36508705272534203, 'support': 838877}, 'weighted avg': {'precision': 0.3846023403956524, 'recall': 0.37283177390725936, 'f1-score': 0.3654321579277384, 'support': 838877}}
[[ 63674 111242 101897]
 [ 47425 121318 111582]
 [ 35438 118533 127768]]
testing model out of sample: results/universal/W0/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 1126s - 1126s/epoch - 49ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0847684
{'0': {'precision': 0.44853349320528446, 'recall': 0.2435886770011986, 'f1-score': 0.3157179032944607, 'support': 1947258}, '1': {'precision': 0.36176604388241385, 'recall': 0.4498632843196951, 'f1-score': 0.40103346441852433, 'support': 1921506}, '2': {'precision': 0.39751653276859905, 'recall': 0.48288488080892006, 'f1-score': 0.43606182494762324, 'support': 1964199}, 'accuracy': 0.39212095122153184, 'macro avg': {'precision': 0.4026053566187658, 'recall': 0.3921122807099379, 'f1-score': 0.3842710642202028, 'support': 5832963}, 'weighted avg': {'precision': 0.4027708787070665, 'recall': 0.39212095122153184, 'f1-score': 0.38434747854814827, 'support': 5832963}}
[[474330 748614 724314]
 [343868 864415 713223]
 [239315 776402 948482]]
Evaluating performance on  train set...
6334/6334 - 325s - 325s/epoch - 51ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883731
{'0': {'precision': 0.4253798668358579, 'recall': 0.26222967798402685, 'f1-score': 0.3244493225598675, 'support': 548420}, '1': {'precision': 0.33941850196137496, 'recall': 0.47022136231719114, 'f1-score': 0.3942538835588389, 'support': 527190}, '2': {'precision': 0.3915607476297184, 'recall': 0.39671367529204643, 'f1-score': 0.3941203691895102, 'support': 545290}, 'accuracy': 0.37511999506447036, 'macro avg': {'precision': 0.3854530388089838, 'recall': 0.37638823853108816, 'f1-score': 0.3709411917694056, 'support': 1620900}, 'weighted avg': {'precision': 0.38604418945903357, 'recall': 0.37511999506447036, 'f1-score': 0.37059109042323085, 'support': 1620900}}
[[143812 235370 169238]
 [112390 247896 166904]
 [ 81877 247089 216324]]
Evaluating performance on  val set...
2156/2156 - 108s - 108s/epoch - 50ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0857751
{'0': {'precision': 0.4130296335317289, 'recall': 0.29081689142806527, 'f1-score': 0.34131302729165786, 'support': 180636}, '1': {'precision': 0.35371101332988225, 'recall': 0.4623159141126347, 'f1-score': 0.40078635878306856, 'support': 189178}, '2': {'precision': 0.38901169726197005, 'recall': 0.37907402102294013, 'f1-score': 0.3839785711296196, 'support': 181516}, 'accuracy': 0.37872054849182885, 'macro avg': {'precision': 0.3852507813745271, 'recall': 0.37740227552121336, 'f1-score': 0.3753593190681153, 'support': 551330}, 'weighted avg': {'precision': 0.38476812472124067, 'recall': 0.37872054849182885, 'f1-score': 0.37576702899694064, 'support': 551330}}
[[52532 76684 51420]
 [45067 87460 56651]
 [29588 83120 68808]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0894986
{'0': {'precision': 0.30914975389387095, 'recall': 0.1605785731797009, 'f1-score': 0.21136824635810436, 'support': 57106}, '1': {'precision': 0.500261120668469, 'recall': 0.2983711385539961, 'f1-score': 0.3737977734419832, 'support': 109156}, '2': {'precision': 0.2651384584470086, 'recall': 0.5925759590969547, 'f1-score': 0.36635661729370683, 'support': 57893}, 'accuracy': 0.3392518569739689, 'macro avg': {'precision': 0.3581831110031162, 'recall': 0.3505085569435506, 'f1-score': 0.31717421236459814, 'support': 224155}, 'weighted avg': {'precision': 0.3908477147885323, 'recall': 0.3392518569739689, 'f1-score': 0.33049518627442437, 'support': 224155}}
[[ 9170 15613 32323]
 [13827 32569 62760]
 [ 6665 16922 34306]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989825
{'0': {'precision': 0.4006072623621267, 'recall': 0.22363277871942994, 'f1-score': 0.2870335427442449, 'support': 28909}, '1': {'precision': 0.3132397335761177, 'recall': 0.26300543150271577, 'f1-score': 0.2859329892397866, 'support': 24855}, '2': {'precision': 0.352683114357432, 'recall': 0.5678706670550538, 'f1-score': 0.43512589802608637, 'support': 27464}, 'accuracy': 0.3520707145319348, 'macro avg': {'precision': 0.35551003676522547, 'recall': 0.35150295909239987, 'f1-score': 0.33603081000337265, 'support': 81228}, 'weighted avg': {'precision': 0.35766999037737773, 'recall': 0.3520707145319348, 'f1-score': 0.33676829169912725, 'support': 81228}}
[[ 6465  7428 15016]
 [ 4709  6537 13609]
 [ 4964  6904 15596]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0937781
{'0': {'precision': 0.3701092703560099, 'recall': 0.13693270735524257, 'f1-score': 0.19990480723465015, 'support': 7668}, '1': {'precision': 0.4168599099713545, 'recall': 0.2744252873563218, 'f1-score': 0.33096875507662316, 'support': 11136}, '2': {'precision': 0.3003981623277182, 'recall': 0.637794251528157, 'f1-score': 0.4084284167568918, 'support': 7689}, 'accuracy': 0.3400898350507681, 'macro avg': {'precision': 0.3624557808850275, 'recall': 0.3497174154132405, 'f1-score': 0.3131006596893883, 'support': 26493}, 'weighted avg': {'precision': 0.36952822680212555, 'recall': 0.3400898350507681, 'f1-score': 0.31551520080218604, 'support': 26493}}
[[1050 2105 4513]
 [1172 3056 6908]
 [ 615 2170 4904]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
2359/2359 - 43s - 43s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0616022
{'0': {'precision': 0.4522376521907181, 'recall': 0.37631882742816447, 'f1-score': 0.41080010156835334, 'support': 174113}, '1': {'precision': 0.4305066854327938, 'recall': 0.47820785698202506, 'f1-score': 0.45310528190771, 'support': 235383}, '2': {'precision': 0.412697528363047, 'recall': 0.4193842258044593, 'f1-score': 0.41601400957797674, 'support': 194292}, 'accuracy': 0.42989757994527883, 'macro avg': {'precision': 0.43181395532885297, 'recall': 0.4246369700715496, 'f1-score': 0.42663979768468, 'support': 603788}, 'weighted avg': {'precision': 0.43104241497648665, 'recall': 0.42989757994527883, 'f1-score': 0.4289702885856914, 'support': 603788}}
[[ 65522  65937  42654]
 [ 49518 112562  73303]
 [ 29844  82965  81483]]
Evaluating performance on  train set...
589/589 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0735943
{'0': {'precision': 0.4258497550760947, 'recall': 0.4563980282931912, 'f1-score': 0.4405950170225936, 'support': 49906}, '1': {'precision': 0.3545793388564267, 'recall': 0.4218874063171757, 'f1-score': 0.3853160706073791, 'support': 51637}, '2': {'precision': 0.4328395751816657, 'recall': 0.3150197306863024, 'f1-score': 0.36464881919427367, 'support': 49162}, 'accuracy': 0.3984539331807173, 'macro avg': {'precision': 0.404422889704729, 'recall': 0.3977683884322231, 'f1-score': 0.39685330227474874, 'support': 150705}, 'weighted avg': {'precision': 0.40371009848669875, 'recall': 0.3984539331807173, 'f1-score': 0.3968797724475742, 'support': 150705}}
[[22777 18223  8906]
 [18465 21785 11387]
 [12244 21431 15487]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0734681
{'0': {'precision': 0.4667356678741878, 'recall': 0.41100815231150944, 'f1-score': 0.4371028540656974, 'support': 19749}, '1': {'precision': 0.3278211296648203, 'recall': 0.4421902268760908, 'f1-score': 0.37651210847709493, 'support': 18336}, '2': {'precision': 0.4453162434115956, 'recall': 0.3585724620207379, 'f1-score': 0.3972642996446795, 'support': 20735}, 'accuracy': 0.4022441346480789, 'macro avg': {'precision': 0.4132910136502012, 'recall': 0.4039236137361127, 'f1-score': 0.4036264207291573, 'support': 58820}, 'weighted avg': {'precision': 0.41588104803673775, 'recall': 0.4022441346480789, 'f1-score': 0.40417112443236825, 'support': 58820}}
[[8117 7540 4092]
 [5059 8108 5169]
 [4215 9085 7435]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
1625/1625 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0893921
{'0': {'precision': 0.4129052693499853, 'recall': 0.2670021872233967, 'f1-score': 0.3242988702848943, 'support': 136703}, '1': {'precision': 0.34110794313316284, 'recall': 0.5054626759489812, 'f1-score': 0.4073312487751515, 'support': 137753}, '2': {'precision': 0.3974150023920147, 'recall': 0.3466317762297111, 'f1-score': 0.37029034232137864, 'support': 141395}, 'accuracy': 0.3730687193249505, 'macro avg': {'precision': 0.3838094049583876, 'recall': 0.3730322131340296, 'f1-score': 0.3673068204604748, 'support': 415851}, 'weighted avg': {'precision': 0.38385509663218925, 'recall': 0.3730687193249505, 'f1-score': 0.36744154259484935, 'support': 415851}}
[[36500 64861 35342]
 [29151 69629 38973]
 [22747 69636 49012]]
Evaluating performance on  train set...
451/451 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0936555
{'0': {'precision': 0.38594169200500805, 'recall': 0.2834585676002312, 'f1-score': 0.32685520396261564, 'support': 38062}, '1': {'precision': 0.33908640496542714, 'recall': 0.4903937007874016, 'f1-score': 0.40093990407828245, 'support': 38100}, '2': {'precision': 0.3891152682595542, 'recall': 0.32083587863978824, 'f1-score': 0.3516921960882788, 'support': 39288}, 'accuracy': 0.3644694673018623, 'macro avg': {'precision': 0.3713811217433298, 'recall': 0.36489604900914036, 'f1-score': 0.3598291013763923, 'support': 115450}, 'weighted avg': {'precision': 0.37155881654100265, 'recall': 0.3644694673018623, 'f1-score': 0.3597562244999908, 'support': 115450}}
[[10789 17423  9850]
 [ 9477 18684  9939]
 [ 7689 18994 12605]]
Evaluating performance on  val set...
177/177 - 4s - 4s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922719
{'0': {'precision': 0.4014474624731951, 'recall': 0.29506797136665136, 'f1-score': 0.34013399447367426, 'support': 15227}, '1': {'precision': 0.3408709076874177, 'recall': 0.5020733012306046, 'f1-score': 0.4060581473968898, 'support': 14952}, '2': {'precision': 0.388646288209607, 'recall': 0.3096895074946467, 'f1-score': 0.34470430507969607, 'support': 14944}, 'accuracy': 0.36850386720741085, 'macro avg': {'precision': 0.37698821945673994, 'recall': 0.36894359336396754, 'f1-score': 0.36363214898342006, 'support': 45123}, 'weighted avg': {'precision': 0.3771352182662053, 'recall': 0.36850386720741085, 'f1-score': 0.3634922963641582, 'support': 45123}}
[[4493 7091 3643]
 [3808 7507 3637]
 [2891 7425 4628]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032503
{'0': {'precision': 0.2680321872713972, 'recall': 0.017813906904833674, 'f1-score': 0.033407491155767896, 'support': 102841}, '1': {'precision': 0.3571788737380781, 'recall': 0.2832868180116402, 'f1-score': 0.3159702944456308, 'support': 117524}, '2': {'precision': 0.31932021466905186, 'recall': 0.6873341698675275, 'f1-score': 0.4360576937684774, 'support': 104399}, 'accuracy': 0.32910667438509195, 'macro avg': {'precision': 0.314843758559509, 'recall': 0.3294782982613338, 'f1-score': 0.2618118264566254, 'support': 324764}, 'weighted avg': {'precision': 0.3167792588452107, 'recall': 0.32910667438509195, 'f1-score': 0.2650963156449419, 'support': 324764}}
[[ 1832 29700 71309]
 [ 2579 33293 81652]
 [ 2424 30218 71757]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105395
{'0': {'precision': 0.2921135646687697, 'recall': 0.02256445245869682, 'f1-score': 0.04189287006876583, 'support': 41038}, '1': {'precision': 0.32553055037313433, 'recall': 0.2718354430379747, 'f1-score': 0.2962697654674732, 'support': 41080}, '2': {'precision': 0.3360067295836646, 'recall': 0.6920046514939364, 'f1-score': 0.4523650692688375, 'support': 42137}, 'accuracy': 0.33199468834252144, 'macro avg': {'precision': 0.31788361487518957, 'recall': 0.328801515663536, 'f1-score': 0.2635092349350255, 'support': 124255}, 'weighted avg': {'precision': 0.3180464934261978, 'recall': 0.33199468834252144, 'f1-score': 0.26519068440760385, 'support': 124255}}
[[  926 11330 28782]
 [ 1073 11167 28840]
 [ 1171 11807 29159]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102886
{'0': {'precision': 0.3297137216189536, 'recall': 0.022741199700415334, 'f1-score': 0.04254777070063694, 'support': 14687}, '1': {'precision': 0.3344336084021005, 'recall': 0.29137254901960785, 'f1-score': 0.3114215857492141, 'support': 15300}, '2': {'precision': 0.33778105654809637, 'recall': 0.6779759222300907, 'f1-score': 0.45090986940697925, 'support': 15533}, 'accuracy': 0.33662126537785586, 'macro avg': {'precision': 0.33397612885638345, 'recall': 0.3306965569833713, 'f1-score': 0.2682930752856101, 'support': 45520}, 'weighted avg': {'precision': 0.33405300503803365, 'recall': 0.33662126537785586, 'f1-score': 0.2722678464793901, 'support': 45520}}
[[  334  4239 10114]
 [  310  4458 10532]
 [  369  4633 10531]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0942609
{'0': {'precision': 0.3686842379414522, 'recall': 0.27127277795198773, 'f1-score': 0.3125647345981838, 'support': 143505}, '1': {'precision': 0.3553062325513181, 'recall': 0.448955279198904, 'f1-score': 0.396678459694161, 'support': 151093}, '2': {'precision': 0.3839843271703196, 'recall': 0.37906442644747973, 'f1-score': 0.38150851581508516, 'support': 148914}, 'accuracy': 0.367996807301719, 'macro avg': {'precision': 0.36932493255436327, 'recall': 0.36643082786612374, 'f1-score': 0.36358390336914326, 'support': 443512}, 'weighted avg': {'precision': 0.3692638716808235, 'recall': 0.367996807301719, 'f1-score': 0.3643687202898001, 'support': 443512}}
[[38929 59233 45343]
 [38044 67834 45215]
 [28616 63850 56448]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0948665
{'0': {'precision': 0.37824585453299236, 'recall': 0.22317970414845464, 'f1-score': 0.2807223493964117, 'support': 64289}, '1': {'precision': 0.3439738500043152, 'recall': 0.49367519779522195, 'f1-score': 0.40544750545195607, 'support': 64587}, '2': {'precision': 0.38435556920242575, 'recall': 0.37428238249013274, 'f1-score': 0.37925210001287657, 'support': 66888}, 'accuracy': 0.3640505915285752, 'macro avg': {'precision': 0.36885842457991114, 'recall': 0.36371242814460314, 'f1-score': 0.3551406516204148, 'support': 195764}, 'weighted avg': {'precision': 0.3690262872903705, 'recall': 0.3640505915285752, 'f1-score': 0.355537338941954, 'support': 195764}}
[[14348 29344 20597]
 [13199 31885 19503]
 [10386 31467 25035]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945706
{'0': {'precision': 0.3757700205338809, 'recall': 0.23961840628507294, 'f1-score': 0.2926327812678469, 'support': 21384}, '1': {'precision': 0.3500343170899108, 'recall': 0.46637099355310685, 'f1-score': 0.39991374409441105, 'support': 21871}, '2': {'precision': 0.37052228602679793, 'recall': 0.3787914084703909, 'f1-score': 0.3746112199055408, 'support': 21463}, 'accuracy': 0.36240304088507064, 'macro avg': {'precision': 0.36544220788352993, 'recall': 0.3615936027695235, 'f1-score': 0.35571924842259967, 'support': 64718}, 'weighted avg': {'precision': 0.36533246535991704, 'recall': 0.36240304088507064, 'f1-score': 0.35607487104906094, 'support': 64718}}
[[ 5124  9297  6963]
 [ 4822 10200  6849]
 [ 3690  9643  8130]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
4693/4693 - 84s - 84s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0591822
{'0': {'precision': 0.4661849965346153, 'recall': 0.4462578192464037, 'f1-score': 0.45600380938033, 'support': 379832}, '1': {'precision': 0.38719495933976456, 'recall': 0.49599508067913956, 'f1-score': 0.4348934802121909, 'support': 439085}, '2': {'precision': 0.4684512775778723, 'recall': 0.33715257340919497, 'f1-score': 0.39210228093793015, 'support': 382275}, 'accuracy': 0.42971648162824927, 'macro avg': {'precision': 0.4406104111507507, 'recall': 0.4264684911115794, 'f1-score': 0.4276665235101504, 'support': 1201192}, 'weighted avg': {'precision': 0.4380321301353302, 'recall': 0.42971648162824927, 'f1-score': 0.42795068742471365, 'support': 1201192}}
[[169503 152922  57407]
 [132463 217784  88838]
 [ 61630 191760 128885]]
Evaluating performance on  train set...
1497/1497 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0643289
{'0': {'precision': 0.4916531893314328, 'recall': 0.421438473648347, 'f1-score': 0.45384615384615384, 'support': 127677}, '1': {'precision': 0.35306438344302044, 'recall': 0.5173193129371462, 'f1-score': 0.41969311931032266, 'support': 126102}, '2': {'precision': 0.47068744518653444, 'recall': 0.3235835201360439, 'f1-score': 0.3835132015317808, 'support': 129370}, 'accuracy': 0.4199541170667286, 'macro avg': {'precision': 0.43846833932032925, 'recall': 0.42078043557384576, 'f1-score': 0.4190174915627525, 'support': 383149}, 'weighted avg': {'precision': 0.43896177184067575, 'recall': 0.4199541170667286, 'f1-score': 0.41885783337044374, 'support': 383149}}
[[53808 54468 19401]
 [33192 65235 27675]
 [22443 65065 41862]]
Evaluating performance on  val set...
547/547 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0607227
{'0': {'precision': 0.5059792855851435, 'recall': 0.42475228204071896, 'f1-score': 0.4618213536386996, 'support': 46121}, '1': {'precision': 0.36698188118097164, 'recall': 0.5395784245048717, 'f1-score': 0.43685015553302287, 'support': 47109}, '2': {'precision': 0.480393080280054, 'recall': 0.3283265025856705, 'f1-score': 0.3900629668340683, 'support': 46603}, 'accuracy': 0.4313001938026074, 'macro avg': {'precision': 0.4511180823487231, 'recall': 0.43088573637708705, 'f1-score': 0.42957815866859694, 'support': 139833}, 'weighted avg': {'precision': 0.45062452204642783, 'recall': 0.4313001938026074, 'f1-score': 0.4294933318425817, 'support': 139833}}
[[19590 19971  6560]
 [11700 25419  9990]
 [ 7427 23875 15301]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
6677/6677 - 120s - 120s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0583404
{'0': {'precision': 0.43817789342953456, 'recall': 0.3297674894738248, 'f1-score': 0.3763205745515126, 'support': 449356}, '1': {'precision': 0.5225155326127818, 'recall': 0.5255535824303266, 'f1-score': 0.5240301543068419, 'support': 827790}, '2': {'precision': 0.34030636783824786, 'recall': 0.4240662748183459, 'f1-score': 0.377597118611065, 'support': 432140}, 'accuracy': 0.4484252489050984, 'macro avg': {'precision': 0.4336665979601881, 'recall': 0.42646244890749907, 'f1-score': 0.42598261582313984, 'support': 1709286}, 'weighted avg': {'precision': 0.4542779804076538, 'recall': 0.4484252489050984, 'f1-score': 0.4481775714353336, 'support': 1709286}}
[[148183 194377 106796]
 [144291 435048 248451]
 [ 45706 203178 183256]]
Evaluating performance on  train set...
2262/2262 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.084197
{'0': {'precision': 0.43878515037748406, 'recall': 0.2743184666269491, 'f1-score': 0.337585918119045, 'support': 194708}, '1': {'precision': 0.3477707493263516, 'recall': 0.4765393820998549, 'f1-score': 0.4020973458366846, 'support': 190937}, '2': {'precision': 0.40282701781849994, 'recall': 0.407587427790546, 'f1-score': 0.40519324137611634, 'support': 193188}, 'accuracy': 0.38550324532291697, 'macro avg': {'precision': 0.3964609725074452, 'recall': 0.3861484255057834, 'f1-score': 0.381625501777282, 'support': 578833}, 'weighted avg': {'precision': 0.39676146408747454, 'recall': 0.38550324532291697, 'f1-score': 0.381430242888901, 'support': 578833}}
[[53412 82841 58455]
 [41673 90989 58275]
 [26642 87805 78741]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.077111
{'0': {'precision': 0.4310310390284824, 'recall': 0.31917411110453764, 'f1-score': 0.3667635411886674, 'support': 67612}, '1': {'precision': 0.3758406702493685, 'recall': 0.4768857410411638, 'f1-score': 0.4203764634756019, 'support': 75819}, '2': {'precision': 0.4079025959108661, 'recall': 0.39091189291532735, 'f1-score': 0.3992265491501034, 'support': 68133}, 'accuracy': 0.39879658164905185, 'macro avg': {'precision': 0.404924768396239, 'recall': 0.3956572483536762, 'f1-score': 0.3954555179381243, 'support': 211564}, 'weighted avg': {'precision': 0.40380387001392326, 'recall': 0.39879658164905185, 'f1-score': 0.39643153894022065, 'support': 211564}}
[[21580 28533 17499]
 [18500 36157 21162]
 [ 9986 31513 26634]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
5633/5633 - 101s - 101s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0649314
{'0': {'precision': 0.35787985646155995, 'recall': 0.3190424488846297, 'f1-score': 0.33734703350802664, 'support': 361046}, '1': {'precision': 0.50532553495173, 'recall': 0.4964650106742255, 'f1-score': 0.50085608852899, 'support': 700285}, '2': {'precision': 0.3371654516706292, 'recall': 0.38276439344762064, 'f1-score': 0.3585208488724452, 'support': 380503}, 'accuracy': 0.4220312463154566, 'macro avg': {'precision': 0.40012361436130645, 'recall': 0.3994239510021586, 'f1-score': 0.3989079903031539, 'support': 1441834}, 'weighted avg': {'precision': 0.42402623932902267, 'recall': 0.4220312463154566, 'f1-score': 0.42234963357361155, 'support': 1441834}}
[[115189 159477  86380]
 [152678 347667 199940]
 [ 53998 180862 145643]]
Evaluating performance on  train set...
1454/1454 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886431
{'0': {'precision': 0.4162682542370673, 'recall': 0.25916283445663724, 'f1-score': 0.319444166749975, 'support': 123297}, '1': {'precision': 0.3427512002491582, 'recall': 0.47474747474747475, 'f1-score': 0.39809304103306126, 'support': 122859}, '2': {'precision': 0.389744245319953, 'recall': 0.3873303742287933, 'f1-score': 0.3885335606018367, 'support': 125939}, 'accuracy': 0.3737244520888483, 'macro avg': {'precision': 0.3829212332687262, 'recall': 0.37374689447763504, 'f1-score': 0.368690256128291, 'support': 372095}, 'weighted avg': {'precision': 0.3830169638544688, 'recall': 0.3737244520888483, 'f1-score': 0.3687965397134798, 'support': 372095}}
[[31954 54089 37254]
 [25407 58327 39125]
 [19402 57757 48780]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.091112
{'0': {'precision': 0.4280682741804389, 'recall': 0.28960123823876827, 'f1-score': 0.3454768528079105, 'support': 49102}, '1': {'precision': 0.3024933256311377, 'recall': 0.45953702386034817, 'f1-score': 0.36483293005564293, 'support': 42162}, '2': {'precision': 0.41722602512128665, 'recall': 0.3682327409232213, 'f1-score': 0.3912013958125623, 'support': 51147}, 'accuracy': 0.36815274101017476, 'macro avg': {'precision': 0.3825958749776211, 'recall': 0.37245700100744594, 'f1-score': 0.3671703928920385, 'support': 142411}, 'weighted avg': {'precision': 0.3869967312984699, 'recall': 0.36815274101017476, 'f1-score': 0.3676293840728958, 'support': 142411}}
[[14220 21325 13557]
 [10037 19375 12750]
 [ 8962 23351 18834]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
11876/11876 - 211s - 211s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973233
{'0': {'precision': 0.48794555614774615, 'recall': 0.2082539195649102, 'f1-score': 0.29191798657426304, 'support': 1160588}, '1': {'precision': 0.23659365490096032, 'recall': 0.37324389044923634, 'f1-score': 0.28960872246764824, 'support': 695714}, '2': {'precision': 0.4319493837763589, 'recall': 0.5280646226697988, 'f1-score': 0.4751955426165084, 'support': 1183857}, 'accuracy': 0.37054673785154, 'macro avg': {'precision': 0.3854961982750218, 'recall': 0.36985414422798185, 'f1-score': 0.3522407505528065, 'support': 3040159}, 'weighted avg': {'precision': 0.4086205941115238, 'recall': 0.37054673785154, 'f1-score': 0.3627589624228404, 'support': 3040159}}
[[241697 414611 504280]
 [118193 259671 317850]
 [135446 423258 625153]]
Evaluating performance on  train set...
2538/2538 - 46s - 46s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879494
{'0': {'precision': 0.4372041255472286, 'recall': 0.2648751191268229, 'f1-score': 0.3298900963546478, 'support': 222452}, '1': {'precision': 0.3314361252891712, 'recall': 0.47571043212863723, 'f1-score': 0.39067904319323826, 'support': 208711}, '2': {'precision': 0.39240194712297716, 'recall': 0.38670798582819893, 'f1-score': 0.3895341599155281, 'support': 218462}, 'accuracy': 0.37358322108908987, 'macro avg': {'precision': 0.387014065986459, 'recall': 0.37576451236121966, 'f1-score': 0.3700344331544714, 'support': 649625}, 'weighted avg': {'precision': 0.388156569488305, 'recall': 0.37358322108908987, 'f1-score': 0.36947798674874605, 'support': 649625}}
[[ 58922  98522  65008]
 [ 43622  99286  65803]
 [ 32226 101755  84481]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897496
{'0': {'precision': 0.4108837755246595, 'recall': 0.29533784275220015, 'f1-score': 0.34365849117283637, 'support': 68745}, '1': {'precision': 0.33021394688437833, 'recall': 0.46940366972477066, 'f1-score': 0.38769440603155964, 'support': 65400}, '2': {'precision': 0.4007075935268296, 'recall': 0.35308210775470145, 'f1-score': 0.37539032829774666, 'support': 69287}, 'accuracy': 0.37096425341145933, 'macro avg': {'precision': 0.3806017719786225, 'recall': 0.3726078734105574, 'f1-score': 0.36891440850071416, 'support': 203432}, 'weighted avg': {'precision': 0.38148385852459055, 'recall': 0.37096425341145933, 'f1-score': 0.36862286565981073, 'support': 203432}}
[[20303 29879 18563]
 [16676 30699 18025]
 [12434 32389 24464]]
testing model on single stock: results/universal/W0/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
19053/19053 - 343s - 343s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0836834
{'0': {'precision': 0.36338057060381984, 'recall': 0.21314293873639975, 'f1-score': 0.2686863638460987, 'support': 1379661}, '1': {'precision': 0.452477075517995, 'recall': 0.45810435055265236, 'f1-score': 0.45527332512063035, 'support': 2149543}, '2': {'precision': 0.31334771373314085, 'recall': 0.4397050392101744, 'f1-score': 0.36592541017858915, 'support': 1348247}, 'accuracy': 0.38372727885938784, 'macro avg': {'precision': 0.3764017866183185, 'recall': 0.3703174428330755, 'f1-score': 0.3632950330484394, 'support': 4877451}, 'weighted avg': {'precision': 0.3888160120434998, 'recall': 0.38372727885938784, 'f1-score': 0.3777964192827564, 'support': 4877451}}
[[294065 591323 494273]
 [360005 984715 804823]
 [155178 600238 592831]]
Evaluating performance on  train set...
4812/4812 - 100s - 100s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0970439
{'0': {'precision': 0.38875057453654055, 'recall': 0.1491736255875991, 'f1-score': 0.21561154021140885, 'support': 408229}, '1': {'precision': 0.3425180845089312, 'recall': 0.40257181349549404, 'f1-score': 0.37012480455061647, 'support': 406017}, '2': {'precision': 0.363060520119863, 'recall': 0.5198864044518727, 'f1-score': 0.4275460351030584, 'support': 417622}, 'accuracy': 0.35836956557033706, 'macro avg': {'precision': 0.36477639305511156, 'recall': 0.3572106145116553, 'f1-score': 0.3377607932883612, 'support': 1231868}, 'weighted avg': {'precision': 0.3648032775784723, 'recall': 0.35836956557033706, 'f1-score': 0.33838729189328753, 'support': 1231868}}
[[ 60897 155672 191660]
 [ 53326 163451 189240]
 [ 42425 158081 217116]]
Evaluating performance on  val set...
1767/1767 - 38s - 38s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959156
{'0': {'precision': 0.38401469912723935, 'recall': 0.14770920260407464, 'f1-score': 0.21335322640805668, 'support': 147154}, '1': {'precision': 0.35619141312793107, 'recall': 0.40480122984665035, 'f1-score': 0.3789438003799963, 'support': 157418}, '2': {'precision': 0.3487614742377416, 'recall': 0.5118297330778968, 'f1-score': 0.41484619119861954, 'support': 147721}, 'accuracy': 0.356112077790282, 'macro avg': {'precision': 0.36298919549763736, 'recall': 0.35478005517620725, 'f1-score': 0.33571440599555746, 'support': 452293}, 'weighted avg': {'precision': 0.362817095650421, 'recall': 0.356112077790282, 'f1-score': 0.33679462219649814, 'support': 452293}}
[[21736 57450 67968]
 [20481 63723 73214]
 [14385 57728 75608]]
training model: results/universal/W0/deepVOL_L3/h200
Epoch 1/50
8838/8838 - 740s - loss: 3.2725 - accuracy200: 0.3733 - val_loss: 3.2959 - val_accuracy200: 0.3425 - 740s/epoch - 84ms/step
Epoch 2/50
8838/8838 - 742s - loss: 3.2552 - accuracy200: 0.3883 - val_loss: 3.2814 - val_accuracy200: 0.3567 - 742s/epoch - 84ms/step
Epoch 3/50
8838/8838 - 722s - loss: 3.2532 - accuracy200: 0.3886 - val_loss: 3.2765 - val_accuracy200: 0.3579 - 722s/epoch - 82ms/step
Epoch 4/50
8838/8838 - 733s - loss: 3.2471 - accuracy200: 0.3936 - val_loss: 3.2814 - val_accuracy200: 0.3532 - 733s/epoch - 83ms/step
Epoch 5/50
8838/8838 - 752s - loss: 3.2379 - accuracy200: 0.4006 - val_loss: 3.2958 - val_accuracy200: 0.3531 - 752s/epoch - 85ms/step
Epoch 6/50
8838/8838 - 763s - loss: 3.2302 - accuracy200: 0.4051 - val_loss: 3.3063 - val_accuracy200: 0.3541 - 763s/epoch - 86ms/step
Epoch 7/50
8838/8838 - 751s - loss: 3.2264 - accuracy200: 0.4067 - val_loss: 3.3051 - val_accuracy200: 0.3564 - 751s/epoch - 85ms/step
Epoch 8/50
8838/8838 - 755s - loss: 3.2225 - accuracy200: 0.4092 - val_loss: 3.3035 - val_accuracy200: 0.3588 - 755s/epoch - 85ms/step
Epoch 9/50
8838/8838 - 772s - loss: 3.2196 - accuracy200: 0.4108 - val_loss: 3.3049 - val_accuracy200: 0.3591 - 772s/epoch - 87ms/step
Epoch 10/50
8838/8838 - 761s - loss: 3.2175 - accuracy200: 0.4120 - val_loss: 3.3089 - val_accuracy200: 0.3596 - 761s/epoch - 86ms/step
Epoch 11/50
8838/8838 - 751s - loss: 3.2154 - accuracy200: 0.4131 - val_loss: 3.3080 - val_accuracy200: 0.3554 - 751s/epoch - 85ms/step
Epoch 12/50
8838/8838 - 728s - loss: 3.2136 - accuracy200: 0.4145 - val_loss: 3.3127 - val_accuracy200: 0.3548 - 728s/epoch - 82ms/step
Epoch 13/50
8838/8838 - 759s - loss: 3.2117 - accuracy200: 0.4151 - val_loss: 3.3096 - val_accuracy200: 0.3566 - 759s/epoch - 86ms/step
testing model in sample: results/universal/W0/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
33007/33007 - 1584s - 1584s/epoch - 48ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0846331
{'0': {'precision': 0.30824806003346844, 'recall': 0.5397399940102875, 'f1-score': 0.3923965798404093, 'support': 2287255}, '1': {'precision': 0.4510826040954235, 'recall': 0.24212621433096845, 'f1-score': 0.31511117682579587, 'support': 3824431}, '2': {'precision': 0.3252469957992418, 'recall': 0.33274619942387573, 'f1-score': 0.32895386308526586, 'support': 2337343}, 'accuracy': 0.3477630388059977, 'macro avg': {'precision': 0.3615258866427113, 'recall': 0.3715374692550439, 'f1-score': 0.3454872065838237, 'support': 8449029}, 'weighted avg': {'precision': 0.3776043377431304, 'recall': 0.3477630388059977, 'f1-score': 0.3398627228675905, 'support': 8449029}}
[[1234523  512710  540022]
 [1824965  925995 1073471]
 [ 945478  614123  777742]]
Evaluating performance on  train set...
8838/8838 - 450s - 450s/epoch - 51ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937576
{'0': {'precision': 0.3615199732046568, 'recall': 0.5237782897122502, 'f1-score': 0.42777970135862875, 'support': 750096}, '1': {'precision': 0.32686633516363744, 'recall': 0.25448004725263856, 'f1-score': 0.2861666054306917, 'support': 748318}, '2': {'precision': 0.3723682634376945, 'recall': 0.2890155017036422, 'f1-score': 0.32543949866371763, 'support': 763658}, 'accuracy': 0.35543740429128695, 'macro avg': {'precision': 0.3535848572686629, 'recall': 0.3557579462228437, 'f1-score': 0.3464619351510127, 'support': 2262072}, 'weighted avg': {'precision': 0.35371847197534206, 'recall': 0.35543740429128695, 'f1-score': 0.34638328991452244, 'support': 2262072}}
[[392884 184028 173184]
 [359062 190432 198824]
 [334810 208139 220709]]
Evaluating performance on  val set...
3279/3279 - 166s - 166s/epoch - 51ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923738
{'0': {'precision': 0.36133763846903216, 'recall': 0.5237786747123885, 'f1-score': 0.4276521550500931, 'support': 274763}, '1': {'precision': 0.3423705570586709, 'recall': 0.2584024504524665, 'f1-score': 0.2945185279653113, 'support': 285988}, '2': {'precision': 0.37019733475716926, 'recall': 0.29914499183823157, 'f1-score': 0.33089997235871627, 'support': 278126}, 'accuracy': 0.3588309132328101, 'macro avg': {'precision': 0.35796851009495745, 'recall': 0.36044203900102884, 'f1-score': 0.35102355179137357, 'support': 838877}, 'weighted avg': {'precision': 0.35780881864377534, 'recall': 0.3588309132328101, 'f1-score': 0.35018678491127125, 'support': 838877}}
[[143915  66398  64450]
 [134993  73900  77095]
 [119376  75550  83200]]
testing model out of sample: results/universal/W0/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
22787/22787 - 1116s - 1116s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903751
{'0': {'precision': 0.3770996246409589, 'recall': 0.5312588381295131, 'f1-score': 0.44109790717379715, 'support': 1941163}, '1': {'precision': 0.3228608685731872, 'recall': 0.2522479991874452, 'f1-score': 0.2832194482781092, 'support': 1929716}, '2': {'precision': 0.3738749387016057, 'recall': 0.3030848832160091, 'f1-score': 0.33477863372387595, 'support': 1962084}, 'accuracy': 0.36220099458885646, 'macro avg': {'precision': 0.3579451439719173, 'recall': 0.3621972401776558, 'f1-score': 0.35303199639192745, 'support': 5832963}, 'weighted avg': {'precision': 0.358071130873605, 'recall': 0.36220099458885646, 'f1-score': 0.3531035321856365, 'support': 5832963}}
[[1031260  469431  440472]
 [ 887519  486767  555430]
 [ 815936  551470  594678]]
Evaluating performance on  train set...
6334/6334 - 327s - 327s/epoch - 52ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930921
{'0': {'precision': 0.3667340062137792, 'recall': 0.529807089565426, 'f1-score': 0.4334397550575681, 'support': 537607}, '1': {'precision': 0.3326794401177518, 'recall': 0.23833490500522672, 'f1-score': 0.2777132428803693, 'support': 547188}, '2': {'precision': 0.3689709615503684, 'recall': 0.31124313334141634, 'f1-score': 0.33765744946288345, 'support': 536105}, 'accuracy': 0.35912209266456907, 'macro avg': {'precision': 0.35612813596063314, 'recall': 0.35979504263735634, 'f1-score': 0.3496034824669403, 'support': 1620900}, 'weighted avg': {'precision': 0.3559776319943759, 'recall': 0.35912209266456907, 'f1-score': 0.34918961520559977, 'support': 1620900}}
[[284828 122294 130485]
 [261890 130414 154884]
 [229943 139303 166859]]
Evaluating performance on  val set...
2156/2156 - 109s - 109s/epoch - 51ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914592
{'0': {'precision': 0.35574413956023987, 'recall': 0.551664863158844, 'f1-score': 0.4325536587844855, 'support': 177432}, '1': {'precision': 0.3484106160169039, 'recall': 0.2311709787085443, 'f1-score': 0.2779329910751497, 'support': 194726}, '2': {'precision': 0.3703250124167398, 'recall': 0.3037863058960105, 'f1-score': 0.3337717805556322, 'support': 179172}, 'accuracy': 0.35791268387354214, 'macro avg': {'precision': 0.35815992266462787, 'recall': 0.3622073825877996, 'f1-score': 0.34808614347175576, 'support': 551330}, 'weighted avg': {'precision': 0.35789250160465097, 'recall': 0.35791268387354214, 'f1-score': 0.3458404183905504, 'support': 551330}}
[[97883 38561 40988]
 [98150 45015 51561]
 [79117 45625 54430]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
876/876 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977213
{'0': {'precision': 0.34129272888068596, 'recall': 0.4985046545260527, 'f1-score': 0.4051834817887691, 'support': 71221}, '1': {'precision': 0.35379512427302884, 'recall': 0.30103144972473583, 'f1-score': 0.3252875292315688, 'support': 79015}, '2': {'precision': 0.3533726557773745, 'recall': 0.2528713862471083, 'f1-score': 0.29479162559634114, 'support': 73919}, 'accuracy': 0.3478931989025451, 'macro avg': {'precision': 0.3494868363103631, 'recall': 0.35080249683263226, 'f1-score': 0.3417542122055597, 'support': 224155}, 'weighted avg': {'precision': 0.34968340893779953, 'recall': 0.3478931989025451, 'f1-score': 0.3406163995947727, 'support': 224155}}
[[35504 20411 15306]
 [36331 23786 18898]
 [32193 23034 18692]]
Evaluating performance on  train set...
318/318 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962542
{'0': {'precision': 0.3574588163514338, 'recall': 0.5103626002685928, 'f1-score': 0.4204404443314844, 'support': 27551}, '1': {'precision': 0.3269647922576339, 'recall': 0.2926592487491599, 'f1-score': 0.3088623556763999, 'support': 26782}, '2': {'precision': 0.3595424107142857, 'recall': 0.23956125673917084, 'f1-score': 0.28753765480307936, 'support': 26895}, 'accuracy': 0.3489190919387403, 'macro avg': {'precision': 0.3479886731077844, 'recall': 0.3475277019189746, 'f1-score': 0.33894681827032125, 'support': 81228}, 'weighted avg': {'precision': 0.348094401582004, 'recall': 0.3489190919387403, 'f1-score': 0.3396468153522294, 'support': 81228}}
[[14061  7797  5693]
 [13160  7838  5784]
 [12115  8337  6443]]
Evaluating performance on  val set...
104/104 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980847
{'0': {'precision': 0.33944522802068644, 'recall': 0.41332722692924206, 'f1-score': 0.3727605968299861, 'support': 8734}, '1': {'precision': 0.3551736071057792, 'recall': 0.3357321993239559, 'f1-score': 0.34517937219730943, 'support': 9171}, '2': {'precision': 0.32466267909305885, 'recall': 0.2717745691662785, 'f1-score': 0.2958737402548013, 'support': 8588}, 'accuracy': 0.3405805307062243, 'macro avg': {'precision': 0.33976050473984154, 'recall': 0.3402779984731588, 'f1-score': 0.3379379030940323, 'support': 26493}, 'weighted avg': {'precision': 0.34009794513082575, 'recall': 0.3405805307062243, 'f1-score': 0.3382891615310783, 'support': 26493}}
[[3610 2777 2347]
 [3584 3079 2508]
 [3441 2813 2334]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
2359/2359 - 43s - 43s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.079336
{'0': {'precision': 0.36603300335065203, 'recall': 0.5500506951246756, 'f1-score': 0.43955963470737686, 'support': 174573}, '1': {'precision': 0.3887788351916686, 'recall': 0.21663107434739906, 'f1-score': 0.2782299246314754, 'support': 221958}, '2': {'precision': 0.40381312737057684, 'recall': 0.42430412483052443, 'f1-score': 0.41380511068604403, 'support': 207257}, 'accuracy': 0.3843186681417981, 'macro avg': {'precision': 0.3862083219709658, 'recall': 0.39699529810086637, 'f1-score': 0.37719822334163206, 'support': 603788}, 'weighted avg': {'precision': 0.38736303062473815, 'recall': 0.3843186681417981, 'f1-score': 0.3714128262677982, 'support': 603788}}
[[96024 30914 47635]
 [91676 48083 82199]
 [74637 44680 87940]]
Evaluating performance on  train set...
589/589 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847322
{'0': {'precision': 0.383414175133585, 'recall': 0.6742642133879674, 'f1-score': 0.488848897744071, 'support': 50762}, '1': {'precision': 0.32518639607671146, 'recall': 0.16327020859190455, 'f1-score': 0.2173918837875658, 'support': 49954}, '2': {'precision': 0.412267913629487, 'recall': 0.29982596171157655, 'f1-score': 0.34716946168813123, 'support': 49989}, 'accuracy': 0.38068411797883284, 'macro avg': {'precision': 0.3736228282799279, 'recall': 0.3791201278971495, 'f1-score': 0.3511367477399226, 'support': 150705}, 'weighted avg': {'precision': 0.373684299274553, 'recall': 0.38068411797883284, 'f1-score': 0.35187416562381196, 'support': 150705}}
[[34227  7303  9232]
 [29663  8156 12135]
 [25379  9622 14988]]
Evaluating performance on  val set...
230/230 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847411
{'0': {'precision': 0.40668003125955626, 'recall': 0.6080881979373063, 'f1-score': 0.48739666897422323, 'support': 19683}, '1': {'precision': 0.3046179525222552, 'recall': 0.1886738268910459, 'f1-score': 0.23302003901400958, 'support': 17411}, '2': {'precision': 0.45095404461166355, 'recall': 0.3861732486421799, 'f1-score': 0.41605712727182564, 'support': 21726}, 'accuracy': 0.4019721183270996, 'macro avg': {'precision': 0.38741734279782497, 'recall': 0.3943117578235107, 'f1-score': 0.37882461175335286, 'support': 58820}, 'weighted avg': {'precision': 0.3928224039421937, 'recall': 0.4019721183270996, 'f1-score': 0.3857497055729385, 'support': 58820}}
[[11969  3075  4639]
 [ 8550  3285  5576]
 [ 8912  4424  8390]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
1625/1625 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0853046
{'0': {'precision': 0.2948691300385335, 'recall': 0.5247851573615616, 'f1-score': 0.3775810001535548, 'support': 105426}, '1': {'precision': 0.46914731480367383, 'recall': 0.23961795508667708, 'f1-score': 0.3172167852554433, 'support': 195265}, '2': {'precision': 0.2955249435753755, 'recall': 0.3297325460229246, 'f1-score': 0.31169300225733637, 'support': 115160}, 'accuracy': 0.3368682532926457, 'macro avg': {'precision': 0.35318046280586096, 'recall': 0.3647118861570544, 'f1-score': 0.3354969292221115, 'support': 415851}, 'weighted avg': {'precision': 0.37688397005350965, 'recall': 0.3368682532926457, 'f1-score': 0.33099056208845873, 'support': 415851}}
[[55326 23803 26297]
 [84255 46789 64221]
 [48048 29140 37972]]
Evaluating performance on  train set...
451/451 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998964
{'0': {'precision': 0.34757983991095254, 'recall': 0.5611670498691826, 'f1-score': 0.42927322349135755, 'support': 37839}, '1': {'precision': 0.32388560589479826, 'recall': 0.2333447215579091, 'f1-score': 0.27125945161536696, 'support': 38051}, '2': {'precision': 0.36674707737984785, 'recall': 0.24979777553083923, 'f1-score': 0.297180663108037, 'support': 39560}, 'accuracy': 0.3464270246860113, 'macro avg': {'precision': 0.3460708410618662, 'recall': 0.3481031823193103, 'f1-score': 0.3325711127382538, 'support': 115450}, 'weighted avg': {'precision': 0.3463383207747101, 'recall': 0.3464270246860113, 'f1-score': 0.3319309651767843, 'support': 115450}}
[[21234  8575  8030]
 [20139  8879  9033]
 [19718  9960  9882]]
Evaluating performance on  val set...
177/177 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964135
{'0': {'precision': 0.3515459363957597, 'recall': 0.5392276422764227, 'f1-score': 0.425614973262032, 'support': 14760}, '1': {'precision': 0.3561774224252808, 'recall': 0.23457873620862588, 'f1-score': 0.28286340615314837, 'support': 15952}, '2': {'precision': 0.34349169241045335, 'recall': 0.2854763722156686, 'f1-score': 0.311808397756556, 'support': 14411}, 'accuracy': 0.3504864481528267, 'macro avg': {'precision': 0.35040501707716465, 'recall': 0.3530942502335724, 'f1-score': 0.3400955923905788, 'support': 45123}, 'weighted avg': {'precision': 0.35061097540182473, 'recall': 0.3504864481528267, 'f1-score': 0.3388024927503123, 'support': 45123}}
[[7959 3250 3551]
 [7898 3742 4312]
 [6783 3514 4114]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990448
{'0': {'precision': 0.3157851150168496, 'recall': 0.48567117677603927, 'f1-score': 0.38272262627198467, 'support': 102067}, '1': {'precision': 0.35702833916676074, 'recall': 0.40731453891269437, 'f1-score': 0.38051727180836553, 'support': 116453}, '2': {'precision': 0.32451620290850797, 'recall': 0.10669778999284665, 'f1-score': 0.16059386864622882, 'support': 106244}, 'accuracy': 0.33359608823638087, 'macro avg': {'precision': 0.3324432190307061, 'recall': 0.3332278352271934, 'f1-score': 0.3079445889088597, 'support': 324764}, 'weighted avg': {'precision': 0.33343030624460557, 'recall': 0.33359608823638087, 'f1-score': 0.3092641522153077, 'support': 324764}}
[[49571 41747 10749]
 [56173 47433 12847]
 [51233 43675 11336]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004177
{'0': {'precision': 0.3287405848656412, 'recall': 0.478754712392071, 'f1-score': 0.3898130544993662, 'support': 41115}, '1': {'precision': 0.32838405349999006, 'recall': 0.4029945531374417, 'f1-score': 0.36188366380066683, 'support': 40941}, '2': {'precision': 0.31786345949770073, 'recall': 0.10647171733927344, 'f1-score': 0.15951290517271982, 'support': 42199}, 'accuracy': 0.32735905999758563, 'macro avg': {'precision': 0.3249960326211107, 'recall': 0.32940699428959536, 'f1-score': 0.3037365411575843, 'support': 124255}, 'weighted avg': {'precision': 0.3249290636870742, 'recall': 0.32735905999758563, 'f1-score': 0.3023969087826498, 'support': 124255}}
[[19684 16682  4749]
 [19549 16499  4893]
 [20644 17062  4493]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100871
{'0': {'precision': 0.3197946273035665, 'recall': 0.47682843472317155, 'f1-score': 0.3828339369992317, 'support': 14630}, '1': {'precision': 0.3365817488480483, 'recall': 0.4251973772246755, 'f1-score': 0.3757353593283472, 'support': 14946}, '2': {'precision': 0.3398963730569948, 'recall': 0.10286001003512293, 'f1-score': 0.15792768067793347, 'support': 15944}, 'accuracy': 0.3288884007029877, 'macro avg': {'precision': 0.33209091640286986, 'recall': 0.33496194066099, 'f1-score': 0.3054989923351708, 'support': 45520}, 'weighted avg': {'precision': 0.3323474074638584, 'recall': 0.3288884007029877, 'f1-score': 0.3017267161588139, 'support': 45520}}
[[6976 6067 1587]
 [6993 6355 1598]
 [7845 6459 1640]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
1733/1733 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959573
{'0': {'precision': 0.3270406023892155, 'recall': 0.5361640509587678, 'f1-score': 0.40627078068892136, 'support': 136738}, '1': {'precision': 0.34774131238952566, 'recall': 0.23464964863419221, 'f1-score': 0.28021512086782546, 'support': 162651}, '2': {'precision': 0.3479978829026135, 'recall': 0.2646003760676644, 'f1-score': 0.30062237147575743, 'support': 144123}, 'accuracy': 0.3373414924511625, 'macro avg': {'precision': 0.3409265992271182, 'recall': 0.34513802522020814, 'f1-score': 0.32903609101083475, 'support': 443512}, 'weighted avg': {'precision': 0.34144250655797054, 'recall': 0.3373414924511625, 'f1-score': 0.3257105144354944, 'support': 443512}}
[[73314 32719 30705]
 [83741 38166 40744]
 [67119 38869 38135]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979148
{'0': {'precision': 0.3501419321914968, 'recall': 0.5163606716733824, 'f1-score': 0.4173086670045616, 'support': 63781}, '1': {'precision': 0.32079307607411855, 'recall': 0.2568124748116688, 'f1-score': 0.2852592522447293, 'support': 64514}, '2': {'precision': 0.3614207519277638, 'recall': 0.2681527812773274, 'f1-score': 0.30787818969258135, 'support': 67469}, 'accuracy': 0.34528309597270185, 'macro avg': {'precision': 0.34411858673112644, 'recall': 0.3471086425874595, 'f1-score': 0.3368153696472907, 'support': 195764}, 'weighted avg': {'precision': 0.34435720458698144, 'recall': 0.34528309597270185, 'f1-score': 0.3360771800223902, 'support': 195764}}
[[32934 16269 14578]
 [30558 16568 17388]
 [30567 18810 18092]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096578
{'0': {'precision': 0.34964875764277353, 'recall': 0.5102515424774561, 'f1-score': 0.4149523331660812, 'support': 21070}, '1': {'precision': 0.33627336448598133, 'recall': 0.2583699847410466, 'f1-score': 0.29221866910309124, 'support': 22282}, '2': {'precision': 0.35074183976261125, 'recall': 0.2766076944678461, 'f1-score': 0.30929453631986603, 'support': 21366}, 'accuracy': 0.3463951296393584, 'macro avg': {'precision': 0.34555465396378865, 'recall': 0.34840974056211627, 'f1-score': 0.33882184619634614, 'support': 64718}, 'weighted avg': {'precision': 0.3454045640992896, 'recall': 0.3463951296393584, 'f1-score': 0.3378140410361054, 'support': 64718}}
[[10751  5412  4907]
 [10492  5757  6033]
 [ 9505  5951  5910]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
4693/4693 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0723733
{'0': {'precision': 0.3570592923175008, 'recall': 0.6394294717732958, 'f1-score': 0.45823744914302544, 'support': 350342}, '1': {'precision': 0.4204671952141807, 'recall': 0.1997779392764858, 'f1-score': 0.27086087458705227, 'support': 495360}, '2': {'precision': 0.3922908725585793, 'recall': 0.3734647950715913, 'f1-score': 0.38264641457228493, 'support': 355490}, 'accuracy': 0.3794097862789629, 'macro avg': {'precision': 0.38993912003008696, 'recall': 0.4042240687071243, 'f1-score': 0.3705815794341209, 'support': 1201192}, 'weighted avg': {'precision': 0.39363480500722936, 'recall': 0.3794097862789629, 'f1-score': 0.35859416409650546, 'support': 1201192}}
[[224019  58520  67803]
 [258534  98962 137864]
 [144847  77880 132763]]
Evaluating performance on  train set...
1497/1497 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0806683
{'0': {'precision': 0.4027278551804272, 'recall': 0.5824949935210272, 'f1-score': 0.4762109601969766, 'support': 127335}, '1': {'precision': 0.33690075721169455, 'recall': 0.20402561036999747, 'f1-score': 0.2541432133601791, 'support': 127136}, '2': {'precision': 0.41433982062927316, 'recall': 0.3927788743996643, 'f1-score': 0.4032713636000957, 'support': 128678}, 'accuracy': 0.3931969025105116, 'macro avg': {'precision': 0.38465614434046497, 'recall': 0.3930998260968963, 'f1-score': 0.37787517905241713, 'support': 383149}, 'weighted avg': {'precision': 0.38478499368965935, 'recall': 0.3931969025105116, 'f1-score': 0.3780284607705484, 'support': 383149}}
[[74172 22888 30275]
 [60032 25939 41165]
 [49970 28166 50542]]
Evaluating performance on  val set...
547/547 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0756435
{'0': {'precision': 0.40928516525749425, 'recall': 0.5772641529888771, 'f1-score': 0.478973833103957, 'support': 46121}, '1': {'precision': 0.3473259476869713, 'recall': 0.20422051570206656, 'f1-score': 0.25720801006500316, 'support': 48051}, '2': {'precision': 0.4125510423382764, 'recall': 0.420402531701014, 'f1-score': 0.41643978262520204, 'support': 45661}, 'accuracy': 0.3978531534044181, 'macro avg': {'precision': 0.3897207184275806, 'recall': 0.4006290667973192, 'f1-score': 0.3842072085980541, 'support': 139833}, 'weighted avg': {'precision': 0.38906047473311445, 'recall': 0.3978531534044181, 'f1-score': 0.38234830950255244, 'support': 139833}}
[[26624  8190 11307]
 [22211  9813 16027]
 [16215 10250 19196]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
6677/6677 - 119s - 119s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0764114
{'0': {'precision': 0.35866639423632146, 'recall': 0.5655097066980419, 'f1-score': 0.43894086246541386, 'support': 499758}, '1': {'precision': 0.440980312597945, 'recall': 0.24282853094759319, 'f1-score': 0.3131945498971549, 'support': 747441}, '2': {'precision': 0.3207123715506519, 'recall': 0.3537818635884584, 'f1-score': 0.33643644251359045, 'support': 462087}, 'accuracy': 0.36716851363668807, 'macro avg': {'precision': 0.37345302612830616, 'recall': 0.3873733670780311, 'f1-score': 0.3628572849587197, 'support': 1709286}, 'weighted avg': {'precision': 0.38440037729906074, 'recall': 0.36716851363668807, 'f1-score': 0.3562432275964626, 'support': 1709286}}
[[282618 105764 111376]
 [331061 181500 234880]
 [174290 124319 163478]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0900261
{'0': {'precision': 0.3736257564482386, 'recall': 0.5534209253838435, 'f1-score': 0.44608824114916756, 'support': 192331}, '1': {'precision': 0.3350695329744378, 'recall': 0.23353083636695962, 'f1-score': 0.27523396921898563, 'support': 196959}, '2': {'precision': 0.37904337613929384, 'recall': 0.3133167671715653, 'f1-score': 0.34306031731360787, 'support': 189543}, 'accuracy': 0.36594838234862215, 'macro avg': {'precision': 0.36257955518732343, 'recall': 0.3667561763074561, 'f1-score': 0.35479417589392037, 'support': 578833}, 'weighted avg': {'precision': 0.36228030218064394, 'recall': 0.36594838234862215, 'f1-score': 0.3542145775663031, 'support': 578833}}
[[106440  42348  43543]
 [ 97217  45996  53746]
 [ 81227  48929  59387]]
Evaluating performance on  val set...
827/827 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.085859
{'0': {'precision': 0.3603688859199881, 'recall': 0.5847761283911956, 'f1-score': 0.4459318278360102, 'support': 66422}, '1': {'precision': 0.3629904559915164, 'recall': 0.22080167197760375, 'f1-score': 0.27458026840361616, 'support': 77513}, '2': {'precision': 0.38643828359526755, 'recall': 0.3235889928876665, 'f1-score': 0.35223203148262905, 'support': 67629}, 'accuracy': 0.367931217031253, 'macro avg': {'precision': 0.3699325418355907, 'recall': 0.37638893108548865, 'f1-score': 0.35758137590741845, 'support': 211564}, 'weighted avg': {'precision': 0.3696627783418361, 'recall': 0.367931217031253, 'f1-score': 0.3531996193607215, 'support': 211564}}
[[38842 13169 14411]
 [40063 17115 20335]
 [28879 16866 21884]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
5633/5633 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0846006
{'0': {'precision': 0.3438961788956976, 'recall': 0.5137115635304041, 'f1-score': 0.41199125197464764, 'support': 417312}, '1': {'precision': 0.3986070307423373, 'recall': 0.22952066597689316, 'f1-score': 0.29130557890348224, 'support': 569269}, '2': {'precision': 0.3602539410799629, 'recall': 0.3882764089418411, 'f1-score': 0.37374064136637636, 'support': 455253}, 'accuracy': 0.361900884567849, 'macro avg': {'precision': 0.3675857169059992, 'recall': 0.3771695461497128, 'f1-score': 0.3590124907481687, 'support': 1441834}, 'weighted avg': {'precision': 0.3706621673711796, 'recall': 0.361900884567849, 'f1-score': 0.3522643224842926, 'support': 1441834}}
[[214378  86795 116139]
 [240848 130659 197762]
 [168154 110335 176764]]
Evaluating performance on  train set...
1454/1454 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093823
{'0': {'precision': 0.36892890472305534, 'recall': 0.5114857882188281, 'f1-score': 0.42866593013898546, 'support': 122891}, '1': {'precision': 0.3285785949529979, 'recall': 0.2450589670597804, 'f1-score': 0.28073869777496185, 'support': 122950}, '2': {'precision': 0.3748318487547719, 'recall': 0.32663519571657135, 'f1-score': 0.3490777656449715, 'support': 126254}, 'accuracy': 0.3607304586194386, 'macro avg': {'precision': 0.35744644947694176, 'recall': 0.3610599836650599, 'f1-score': 0.35282746451963964, 'support': 372095}, 'weighted avg': {'precision': 0.3575990016325859, 'recall': 0.3607304586194386, 'f1-score': 0.35278214417254156, 'support': 372095}}
[[62857 28542 31492]
 [55531 30130 37289]
 [51989 33026 41239]]
Evaluating performance on  val set...
557/557 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945902
{'0': {'precision': 0.3690673552324643, 'recall': 0.5328532090658759, 'f1-score': 0.43608879181076704, 'support': 47210}, '1': {'precision': 0.3283542435424354, 'recall': 0.23767601871834867, 'f1-score': 0.27575179115948134, 'support': 46799}, '2': {'precision': 0.3753560371517028, 'recall': 0.3131068964092393, 'f1-score': 0.34141725897473446, 'support': 48402}, 'accuracy': 0.3611659211718196, 'macro avg': {'precision': 0.3575925453088675, 'recall': 0.36121204139782126, 'f1-score': 0.35108594731499426, 'support': 142411}, 'weighted avg': {'precision': 0.35782561034108173, 'recall': 0.3611659211718196, 'f1-score': 0.35122243439589623, 'support': 142411}}
[[25156 10590 11464]
 [21920 11123 13756]
 [21085 12162 15155]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
11876/11876 - 209s - 209s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975597
{'0': {'precision': 0.4088326289184172, 'recall': 0.518376447226113, 'f1-score': 0.4571335875400903, 'support': 1128020}, '1': {'precision': 0.23949615259127285, 'recall': 0.2629524085522926, 'f1-score': 0.25067676587450044, 'support': 745344}, '2': {'precision': 0.42580958144200437, 'recall': 0.2888682244953055, 'f1-score': 0.34421905015763304, 'support': 1166795}, 'accuracy': 0.3676712303534124, 'macro avg': {'precision': 0.35804612098389815, 'recall': 0.35673236009123704, 'f1-score': 0.3506764678574079, 'support': 3040159}, 'weighted avg': {'precision': 0.3738327150021318, 'recall': 0.3676712303534124, 'f1-score': 0.36318143867791514, 'support': 3040159}}
[[584739 285943 257338]
 [352191 195990 197163]
 [493335 336410 337050]]
Evaluating performance on  train set...
2538/2538 - 47s - 47s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092714
{'0': {'precision': 0.37002478152246643, 'recall': 0.5092200550658245, 'f1-score': 0.4286042562472736, 'support': 216105}, '1': {'precision': 0.33926344556767224, 'recall': 0.23155349915339413, 'f1-score': 0.27524634187031466, 'support': 220882}, '2': {'precision': 0.36640690921725316, 'recall': 0.34716278369811604, 'f1-score': 0.35652535087465104, 'support': 212638}, 'accuracy': 0.3617640946700019, 'macro avg': {'precision': 0.3585650454357972, 'recall': 0.36264544597244486, 'f1-score': 0.35345864966407975, 'support': 649625}, 'weighted avg': {'precision': 0.3583812601992372, 'recall': 0.3617640946700019, 'f1-score': 0.3528671508033095, 'support': 649625}}
[[110045  47091  58969]
 [101055  51146  68681]
 [ 86299  52519  73820]]
Evaluating performance on  val set...
795/795 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939859
{'0': {'precision': 0.354983960112859, 'recall': 0.5529000993287783, 'f1-score': 0.43236945238851815, 'support': 66446}, '1': {'precision': 0.335042735042735, 'recall': 0.21900068760027505, 'f1-score': 0.2648694537327396, 'support': 69808}, '2': {'precision': 0.37072362364205486, 'recall': 0.299711214981095, 'f1-score': 0.33145660476754907, 'support': 67178}, 'accuracy': 0.35471312281253686, 'macro avg': {'precision': 0.3535834395992163, 'recall': 0.3572040006367161, 'f1-score': 0.34289850362960234, 'support': 203432}, 'weighted avg': {'precision': 0.3533387031074179, 'recall': 0.35471312281253686, 'f1-score': 0.34156779294632594, 'support': 203432}}
[[36738 13900 15808]
 [36152 15288 18368]
 [30602 16442 20134]]
testing model on single stock: results/universal/W0/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
19053/19053 - 341s - 341s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0873663
{'0': {'precision': 0.27851322848041465, 'recall': 0.5234122390002582, 'f1-score': 0.36356803324403136, 'support': 1242961}, '1': {'precision': 0.48768201725540633, 'recall': 0.24805411434997487, 'f1-score': 0.3288448825008452, 'support': 2421391}, '2': {'precision': 0.2818662065911919, 'recall': 0.3043651012819234, 'f1-score': 0.2926839128682231, 'support': 1213099}, 'accuracy': 0.33223132328751226, 'macro avg': {'precision': 0.3493538174423376, 'recall': 0.35861048487738545, 'f1-score': 0.3283656095376999, 'support': 4877451}, 'weighted avg': {'precision': 0.3831881738594398, 'recall': 0.33223132328751226, 'f1-score': 0.32869986537418155, 'support': 4877451}}
[[ 650581  294010  298370]
 [1178420  600636  642335]
 [ 506906  336968  369225]]
Evaluating performance on  train set...
4812/4812 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981559
{'0': {'precision': 0.34688528409587327, 'recall': 0.4963001816207631, 'f1-score': 0.4083543573703114, 'support': 407993}, '1': {'precision': 0.3255874396021123, 'recall': 0.27063586170664583, 'f1-score': 0.2955793142742233, 'support': 407337}, '2': {'precision': 0.35378984399985786, 'recall': 0.262919589569259, 'f1-score': 0.30165998934014976, 'support': 416538}, 'accuracy': 0.34276643276714713, 'macro avg': {'precision': 0.3420875225659478, 'recall': 0.343285210965556, 'f1-score': 0.33519788699489483, 'support': 1231868}, 'weighted avg': {'precision': 0.34217748382078766, 'recall': 0.34276643276714713, 'f1-score': 0.3349863452130196, 'support': 1231868}}
[[202487 108224  97282]
 [194344 110240 102753]
 [186898 120124 109516]]
Evaluating performance on  val set...
1767/1767 - 38s - 38s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969266
{'0': {'precision': 0.3412794713360339, 'recall': 0.4970670001835249, 'f1-score': 0.40469846013364885, 'support': 147119}, '1': {'precision': 0.34661853305551515, 'recall': 0.27030312191005224, 'f1-score': 0.3037405830794436, 'support': 158781}, '2': {'precision': 0.34072419983361796, 'recall': 0.2657845662019359, 'f1-score': 0.29862464887101475, 'support': 146393}, 'accuracy': 0.3426009246218712, 'macro avg': {'precision': 0.34287406807505566, 'recall': 0.34438489609850437, 'f1-score': 0.33568789736136906, 'support': 452293}, 'weighted avg': {'precision': 0.34297406686996385, 'recall': 0.3426009246218712, 'f1-score': 0.3349236545790315, 'support': 452293}}
[[73128 38748 35243]
 [75819 42919 40043]
 [65329 42155 38909]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128           256
 Used       :        79 (peak)  18.05 (ave)

============================================
