This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W9/deepLOB_L1/h50
Epoch 1/50
6697/6697 - 124s - loss: 3.0017 - accuracy50: 0.4803 - val_loss: 3.3692 - val_accuracy50: 0.3357 - 124s/epoch - 18ms/step
Epoch 2/50
6697/6697 - 108s - loss: 2.9762 - accuracy50: 0.4866 - val_loss: 3.2613 - val_accuracy50: 0.3373 - 108s/epoch - 16ms/step
Epoch 3/50
6697/6697 - 107s - loss: 2.9419 - accuracy50: 0.4957 - val_loss: 3.2756 - val_accuracy50: 0.3527 - 107s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 111s - loss: 2.9132 - accuracy50: 0.5036 - val_loss: 3.2948 - val_accuracy50: 0.3788 - 111s/epoch - 17ms/step
Epoch 5/50
6697/6697 - 109s - loss: 2.8884 - accuracy50: 0.5099 - val_loss: 3.3584 - val_accuracy50: 0.3922 - 109s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 109s - loss: 2.8715 - accuracy50: 0.5135 - val_loss: 3.4236 - val_accuracy50: 0.4019 - 109s/epoch - 16ms/step
Epoch 7/50
6697/6697 - 109s - loss: 2.8608 - accuracy50: 0.5161 - val_loss: 3.4040 - val_accuracy50: 0.3987 - 109s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 111s - loss: 2.8516 - accuracy50: 0.5180 - val_loss: 3.4727 - val_accuracy50: 0.3839 - 111s/epoch - 17ms/step
Epoch 9/50
6697/6697 - 110s - loss: 2.8456 - accuracy50: 0.5188 - val_loss: 3.4584 - val_accuracy50: 0.3859 - 110s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 108s - loss: 2.8414 - accuracy50: 0.5201 - val_loss: 3.4812 - val_accuracy50: 0.3854 - 108s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 109s - loss: 2.8364 - accuracy50: 0.5209 - val_loss: 3.5375 - val_accuracy50: 0.3745 - 109s/epoch - 16ms/step
Epoch 12/50
6697/6697 - 109s - loss: 2.8325 - accuracy50: 0.5217 - val_loss: 3.5198 - val_accuracy50: 0.3689 - 109s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 96s - 96s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1238194
{'0': {'precision': 0.304144573599514, 'recall': 0.48666839649257204, 'f1-score': 0.3743427524168115, 'support': 1213995}, '1': {'precision': 0.4460474485090211, 'recall': 0.07702641732155537, 'f1-score': 0.13136743836175216, 'support': 1877291}, '2': {'precision': 0.31233387212863667, 'recall': 0.5240543895561529, 'f1-score': 0.3913970202460073, 'support': 1216410}, 'accuracy': 0.3187037803967597, 'macro avg': {'precision': 0.3541752980790573, 'recall': 0.3625830677900934, 'f1-score': 0.2990357370081903, 'support': 4307696}, 'weighted avg': {'precision': 0.36829824984908077, 'recall': 0.3187037803967597, 'f1-score': 0.2732700703223405, 'support': 4307696}}
[[590813  92578 530604]
 [859786 144601 872904]
 [491941  87004 637465]]
Evaluating performance on  train set...
6697/6697 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1106995
{'0': {'precision': 0.3234031821319222, 'recall': 0.5952792522055336, 'f1-score': 0.4191115389274218, 'support': 491151}, '1': {'precision': 0.3807259478607126, 'recall': 0.10445098180567955, 'f1-score': 0.16392864796886916, 'support': 721324}, '2': {'precision': 0.3423792283159931, 'recall': 0.4178374175024425, 'f1-score': 0.37636337839463935, 'support': 501530}, 'accuracy': 0.33679773396226964, 'macro avg': {'precision': 0.3488361194362093, 'recall': 0.3725225505045519, 'f1-score': 0.3198011884303101, 'support': 1714005}, 'weighted avg': {'precision': 0.35307949177468934, 'recall': 0.33679773396226964, 'f1-score': 0.29921163864137046, 'support': 1714005}}
[[292372  60564 138215]
 [381690  75343 264291]
 [229986  61986 209558]]
Evaluating performance on  val set...
2631/2631 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1101223
{'0': {'precision': 0.31542895733339765, 'recall': 0.6099339292654489, 'f1-score': 0.4158170294847065, 'support': 192975}, '1': {'precision': 0.45456324358171574, 'recall': 0.08018612293364538, 'f1-score': 0.13632429101685717, 'support': 289701}, '2': {'precision': 0.34525672224121634, 'recall': 0.451312358038193, 'f1-score': 0.391224387942763, 'support': 190192}, 'accuracy': 0.3370170672405286, 'macro avg': {'precision': 0.37174964105210995, 'recall': 0.38047747007909577, 'f1-score': 0.31445523614810894, 'support': 672868}, 'weighted avg': {'precision': 0.3837638226023239, 'recall': 0.3370170672405286, 'f1-score': 0.28853106922649874, 'support': 672868}}
[[117702  14108  61165]
 [164857  23230 101614]
 [ 90590  13766  85836]]
testing model out of sample: results/universal/W9/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.113662
{'0': {'precision': 0.31583112158408777, 'recall': 0.6699998408001033, 'f1-score': 0.42929631804076157, 'support': 565327}, '1': {'precision': 0.5638832396219644, 'recall': 0.07739412504127723, 'f1-score': 0.13610725205902263, 'support': 1096246}, '2': {'precision': 0.3150404923385501, 'recall': 0.49376099489345754, 'f1-score': 0.38465484889541446, 'support': 549687}, 'accuracy': 0.33240143628519486, 'macro avg': {'precision': 0.39825161784820073, 'recall': 0.413718320244946, 'f1-score': 0.3166861396650662, 'support': 2211260}, 'weighted avg': {'precision': 0.43860797440666777, 'recall': 0.33240143628519486, 'f1-score': 0.2728487831166388, 'support': 2211260}}
[[378769  33328 153230]
 [574526  84843 436877]
 [245982  32291 271414]]
Evaluating performance on  train set...
3947/3947 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1081398
{'0': {'precision': 0.29928411071165045, 'recall': 0.5879010527695433, 'f1-score': 0.3966464972749864, 'support': 259411}, '1': {'precision': 0.5803547203939105, 'recall': 0.11805588204632377, 'f1-score': 0.19620059654439095, 'support': 489209}, '2': {'precision': 0.3332667477346331, 'recall': 0.5114577824784065, 'f1-score': 0.403567945936548, 'support': 260958}, 'accuracy': 0.34046997854549127, 'macro avg': {'precision': 0.40430185961339804, 'recall': 0.40580490576475786, 'f1-score': 0.33213834658530844, 'support': 1009578}, 'weighted avg': {'precision': 0.4442657890805256, 'recall': 0.34046997854549127, 'f1-score': 0.301305937901971, 'support': 1009578}}
[[152508  22455  84448]
 [248885  57754 182570]
 [108183  19306 133469]]
Evaluating performance on  val set...
1402/1402 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1215062
{'0': {'precision': 0.28632356497460815, 'recall': 0.5618212602586086, 'f1-score': 0.37932829707836535, 'support': 92727}, '1': {'precision': 0.4906984906984907, 'recall': 0.08091401583553272, 'f1-score': 0.13892063239692745, 'support': 172776}, '2': {'precision': 0.3311886011204027, 'recall': 0.5278361854236082, 'f1-score': 0.40700415310360316, 'support': 92739}, 'accuracy': 0.32108742135204693, 'macro avg': {'precision': 0.3694035522645005, 'recall': 0.3901904871725832, 'f1-score': 0.30841769419296533, 'support': 358242}, 'weighted avg': {'precision': 0.39650556695649297, 'recall': 0.32108742135204693, 'f1-score': 0.2705469608277985, 'support': 358242}}
[[52096  7784 32847]
 [92790 13980 66006]
 [37062  6726 48951]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1016192
{'0': {'precision': 0.34776839565741857, 'recall': 0.46941018439369886, 'f1-score': 0.3995357458381693, 'support': 24567}, '1': {'precision': 0.30969875091844234, 'recall': 0.07163189871266516, 'f1-score': 0.11635209275042269, 'support': 23537}, '2': {'precision': 0.39896654881697036, 'recall': 0.5379537953795379, 'f1-score': 0.45815115552779506, 'support': 27270}, 'accuracy': 0.36999495847374425, 'macro avg': {'precision': 0.3521445651309438, 'recall': 0.35966529282863396, 'f1-score': 0.32467966470546233, 'support': 75374}, 'weighted avg': {'precision': 0.3544036864531796, 'recall': 0.36999495847374425, 'f1-score': 0.332312944600472, 'support': 75374}}
[[11532  1880 11155]
 [10906  1686 10945]
 [10722  1878 14670]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.110328
{'0': {'precision': 0.37212594207888594, 'recall': 0.5604401935929938, 'f1-score': 0.4472698011265663, 'support': 17356}, '1': {'precision': 0.3430951101558302, 'recall': 0.07610250297973778, 'f1-score': 0.12457321236952491, 'support': 16780}, '2': {'precision': 0.3804777129960504, 'recall': 0.4761960807391279, 'f1-score': 0.4229894670813622, 'support': 16993}, 'accuracy': 0.3734866709695085, 'macro avg': {'precision': 0.36523292174358885, 'recall': 0.37091292577061985, 'f1-score': 0.33161082685915116, 'support': 51129}, 'weighted avg': {'precision': 0.36537408468927335, 'recall': 0.3734866709695085, 'f1-score': 0.3332944744866299, 'support': 51129}}
[[9727 1297 6332]
 [8659 1277 6844]
 [7753 1148 8092]]
Evaluating performance on  val set...
53/53 - 0s - 491ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.114587
{'0': {'precision': 0.34193332216451666, 'recall': 0.4666209419295839, 'f1-score': 0.39466305714009475, 'support': 4374}, '1': {'precision': 0.36663124335812963, 'recall': 0.07120743034055728, 'f1-score': 0.11925337020394056, 'support': 4845}, '2': {'precision': 0.3410958904109589, 'recall': 0.5259328796057263, 'f1-score': 0.4138122057058443, 'support': 4261}, 'accuracy': 0.3432492581602374, 'macro avg': {'precision': 0.349886818644535, 'recall': 0.35458708395862254, 'f1-score': 0.3092428776832932, 'support': 13480}, 'weighted avg': {'precision': 0.35054557227439387, 'recall': 0.3432492581602374, 'f1-score': 0.3017279376173197, 'support': 13480}}
[[2041  330 2003]
 [2174  345 2326]
 [1754  266 2241]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1639998
{'0': {'precision': 0.17471719672443345, 'recall': 0.5768756759475842, 'f1-score': 0.2682039828338225, 'support': 39759}, '1': {'precision': 0.7447734207255057, 'recall': 0.06434872606023326, 'f1-score': 0.11846226436290921, 'support': 204837}, '2': {'precision': 0.19166958245859575, 'recall': 0.6326604268424725, 'f1-score': 0.2942068309603066, 'support': 41561}, 'accuracy': 0.2181005531928277, 'macro avg': {'precision': 0.37038673330284494, 'recall': 0.42462827628343, 'f1-score': 0.22695769271901275, 'support': 286157}, 'weighted avg': {'precision': 0.5852371730283685, 'recall': 0.2181005531928277, 'f1-score': 0.16479242898246937, 'support': 286157}}
[[22936  2605 14218]
 [94984 13181 96672]
 [13355  1912 26294]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1106524
{'0': {'precision': 0.21351897273120762, 'recall': 0.7241278074081323, 'f1-score': 0.32979375355165075, 'support': 20437}, '1': {'precision': 0.7963063922584163, 'recall': 0.13157598414557248, 'f1-score': 0.22583637734098685, 'support': 88808}, '2': {'precision': 0.2614020737072491, 'recall': 0.5920288403765271, 'f1-score': 0.3626715742657772, 'support': 19972}, 'accuracy': 0.29646253975870046, 'macro avg': {'precision': 0.42374247956562433, 'recall': 0.48257754397674396, 'f1-score': 0.30610056838613825, 'support': 129217}, 'weighted avg': {'precision': 0.6214568326572688, 'recall': 0.29646253975870046, 'f1-score': 0.2634277890793746, 'support': 129217}}
[[14799  1494  4144]
 [47858 11685 29265]
 [ 6653  1495 11824]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1539422
{'0': {'precision': 0.1903710384723043, 'recall': 0.8209495708154506, 'f1-score': 0.30907117069352924, 'support': 7456}, '1': {'precision': 0.7657923900997414, 'recall': 0.06317425489120497, 'f1-score': 0.1167196869457504, 'support': 32814}, '2': {'precision': 0.3238631977148151, 'recall': 0.556144769985417, 'f1-score': 0.40934816549570646, 'support': 7543}, 'accuracy': 0.25911363018425954, 'macro avg': {'precision': 0.4266755420956203, 'recall': 0.48008953189735754, 'f1-score': 0.2783796743783287, 'support': 47813}, 'weighted avg': {'precision': 0.6063417491465766, 'recall': 0.25911363018425954, 'f1-score': 0.19288033941528293, 'support': 47813}}
[[ 6121   226  1109]
 [23092  2073  7649]
 [ 2940   408  4195]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.103126
{'0': {'precision': 0.4027327935222672, 'recall': 0.6469768414206406, 'f1-score': 0.4964397429841994, 'support': 43051}, '1': {'precision': 0.4644519485260564, 'recall': 0.12205593130906126, 'f1-score': 0.19331066836337393, 'support': 41694}, '2': {'precision': 0.42175626231353786, 'recall': 0.465021944407501, 'f1-score': 0.442333642574007, 'support': 45114}, 'accuracy': 0.4152272849783226, 'macro avg': {'precision': 0.4296470014539538, 'recall': 0.41135157237906766, 'f1-score': 0.37736135130719345, 'support': 129859}, 'weighted avg': {'precision': 0.4291579409496875, 'recall': 0.4152272849783226, 'f1-score': 0.3803168231161416, 'support': 129859}}
[[27853  2880 12318]
 [20160  5089 16445]
 [21147  2988 20979]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109102
{'0': {'precision': 0.38048374601899404, 'recall': 0.5837478540300216, 'f1-score': 0.4606913322911238, 'support': 22717}, '1': {'precision': 0.3468244084682441, 'recall': 0.07624566526738456, 'f1-score': 0.12500935138774594, 'support': 21916}, '2': {'precision': 0.3793837905328486, 'recall': 0.46391845165925727, 'f1-score': 0.4174141414141414, 'support': 22269}, 'accuracy': 0.37761202953573886, 'macro avg': {'precision': 0.3688973150066956, 'recall': 0.37463732365222113, 'f1-score': 0.33437160836433705, 'support': 66902}, 'weighted avg': {'precision': 0.3690913668601765, 'recall': 0.37761202953573886, 'f1-score': 0.3363221645963172, 'support': 66902}}
[[13261  1623  7833]
 [11178  1671  9067]
 [10414  1524 10331]]
Evaluating performance on  val set...
73/73 - 1s - 581ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1082042
{'0': {'precision': 0.37943611987381703, 'recall': 0.60140625, 'f1-score': 0.46530464216634426, 'support': 6400}, '1': {'precision': 0.350635593220339, 'recall': 0.05576145552560647, 'f1-score': 0.09622093023255814, 'support': 5936}, '2': {'precision': 0.38620142743854086, 'recall': 0.4624881291547958, 'f1-score': 0.42091616248919617, 'support': 6318}, 'accuracy': 0.3807226332153962, 'macro avg': {'precision': 0.3720910468442323, 'recall': 0.37321861156013414, 'f1-score': 0.3274805782960329, 'support': 18654}, 'weighted avg': {'precision': 0.3725627032864298, 'recall': 0.3807226332153962, 'f1-score': 0.3328222079088566, 'support': 18654}}
[[3849  309 2242]
 [3203  331 2402]
 [3092  304 2922]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1249553
{'0': {'precision': 0.3388380867118557, 'recall': 0.4348941234405778, 'f1-score': 0.3809036014664654, 'support': 48736}, '1': {'precision': 0.38358020231213874, 'recall': 0.07075974675108297, 'f1-score': 0.11947898497721263, 'support': 60020}, '2': {'precision': 0.30805317621428924, 'recall': 0.5450981251095146, 'f1-score': 0.39364461738002593, 'support': 45656}, 'accuracy': 0.3259396938061809, 'macro avg': {'precision': 0.34349048841276125, 'recall': 0.35025066510039177, 'f1-score': 0.29800906794123466, 'support': 154412}, 'weighted avg': {'precision': 0.34712698851127605, 'recall': 0.3259396938061809, 'f1-score': 0.28305497791949086, 'support': 154412}}
[[21195  3650 23891]
 [23763  4247 32010]
 [17594  3175 24887]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1309435
{'0': {'precision': 0.3816871518259793, 'recall': 0.5880389619235747, 'f1-score': 0.46290785275744656, 'support': 29362}, '1': {'precision': 0.3298674291655836, 'recall': 0.04661157024793389, 'f1-score': 0.08168125643666324, 'support': 27225}, '2': {'precision': 0.34707319980925133, 'recall': 0.4470592751842752, 'f1-score': 0.3907718120805369, 'support': 26048}, 'accuracy': 0.36522054819386457, 'macro avg': {'precision': 0.35287592693360476, 'recall': 0.36056993578526125, 'f1-score': 0.31178697375821557, 'support': 82635}, 'weighted avg': {'precision': 0.3537036560728359, 'recall': 0.36522054819386457, 'f1-score': 0.31457005796848947, 'support': 82635}}
[[17266  1378 10718]
 [14767  1269 11189]
 [13203  1200 11645]]
Evaluating performance on  val set...
112/112 - 1s - 788ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1174171
{'0': {'precision': 0.39936986090832244, 'recall': 0.4953297750667175, 'f1-score': 0.44220378642841945, 'support': 10492}, '1': {'precision': 0.2661756970015781, 'recall': 0.0628727634194831, 'f1-score': 0.10171876570509597, 'support': 8048}, '2': {'precision': 0.3791598875905931, 'recall': 0.518088116410671, 'f1-score': 0.43786830643095054, 'support': 9896}, 'accuracy': 0.3808552539035026, 'macro avg': {'precision': 0.3482351485001645, 'recall': 0.3587635516322905, 'f1-score': 0.32726361952148864, 'support': 28436}, 'weighted avg': {'precision': 0.35463978188617695, 'recall': 0.3808552539035026, 'f1-score': 0.34433040913075946, 'support': 28436}}
[[5197  727 4568]
 [3715  506 3827]
 [4101  668 5127]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0807681
{'0': {'precision': 0.4467477382499326, 'recall': 0.5740411120737182, 'f1-score': 0.50245762069227, 'support': 63485}, '1': {'precision': 0.2404040404040404, 'recall': 0.00908443177769861, 'f1-score': 0.017507294706127552, 'support': 39298}, '2': {'precision': 0.41151963603368735, 'recall': 0.550209312259718, 'f1-score': 0.47086434556275314, 'support': 58525}, 'accuracy': 0.4277593175787934, 'macro avg': {'precision': 0.36622380489588674, 'recall': 0.37777828537037833, 'f1-score': 0.33027642032038357, 'support': 161308}, 'weighted avg': {'precision': 0.3836968088468427, 'recall': 0.4277593175787934, 'f1-score': 0.37285106467794704, 'support': 161308}}
[[36443   533 26509]
 [19402   357 19539]
 [25729   595 32201]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1167169
{'0': {'precision': 0.36297036297036295, 'recall': 0.5383779512002371, 'f1-score': 0.4336064921632588, 'support': 40492}, '1': {'precision': 0.29492236676458244, 'recall': 0.08723066229768643, 'f1-score': 0.13463859460909214, 'support': 40284}, '2': {'precision': 0.3819561213868204, 'recall': 0.4636374681083708, 'f1-score': 0.41885173030698825, 'support': 41155}, 'accuracy': 0.36409936767516055, 'macro avg': {'precision': 0.3466162837072553, 'recall': 0.3630820272020981, 'f1-score': 0.3290322723597798, 'support': 121931}, 'weighted avg': {'precision': 0.3468966278945877, 'recall': 0.36409936767516055, 'f1-score': 0.3298522786386682, 'support': 121931}}
[[21800  4284 14408]
 [20303  3514 16467]
 [17957  4117 19081]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1128702
{'0': {'precision': 0.3405508982035928, 'recall': 0.4701719576719577, 'f1-score': 0.39499930545909157, 'support': 15120}, '1': {'precision': 0.34155098133078027, 'recall': 0.16807019610152524, 'f1-score': 0.22528318269724118, 'support': 16981}, '2': {'precision': 0.378428927680798, 'recall': 0.4519426018681467, 'f1-score': 0.4119316429144303, 'support': 14774}, 'accuracy': 0.3549866666666667, 'macro avg': {'precision': 0.3535102690717237, 'recall': 0.36339491854720984, 'f1-score': 0.34407137702358764, 'support': 46875}, 'weighted avg': {'precision': 0.3528515364772781, 'recall': 0.3549866666666667, 'f1-score': 0.3388544280819437, 'support': 46875}}
[[7109 2989 5022]
 [8182 2854 5945]
 [5584 2513 6677]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1371156
{'0': {'precision': 0.22843818871697, 'recall': 0.7996619774320227, 'f1-score': 0.35536096525429156, 'support': 100585}, '1': {'precision': 0.711249046397115, 'recall': 0.050829816392126345, 'f1-score': 0.09487904783271386, 'support': 403523}, '2': {'precision': 0.26021044075144506, 'recall': 0.5863300567800231, 'f1-score': 0.3604534052309251, 'support': 98274}, 'accuracy': 0.2632316370675087, 'macro avg': {'precision': 0.3999658919551767, 'recall': 0.4789406168680574, 'f1-score': 0.2702311394393102, 'support': 602382}, 'weighted avg': {'precision': 0.557046400815109, 'recall': 0.2632316370675087, 'f1-score': 0.18170041378123358, 'support': 602382}}
[[ 80434   4188  15963]
 [235156  20511 147856]
 [ 36514   4139  57621]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1232901
{'0': {'precision': 0.227941870897672, 'recall': 0.743206312548114, 'f1-score': 0.3488815409077768, 'support': 51960}, '1': {'precision': 0.7384017488462473, 'recall': 0.07096204930928716, 'f1-score': 0.12948071418836038, 'support': 214199}, '2': {'precision': 0.27977922497806107, 'recall': 0.6762112078588971, 'f1-score': 0.3957986213205266, 'support': 53748}, 'accuracy': 0.28183815921502187, 'macro avg': {'precision': 0.41537428157399353, 'recall': 0.49679318990543275, 'f1-score': 0.2913869588055546, 'support': 319907}, 'weighted avg': {'precision': 0.5784379510203941, 'recall': 0.28183815921502187, 'f1-score': 0.2098607053385401, 'support': 319907}}
[[ 38617   2707  10636]
 [116074  15200  82925]
 [ 14725   2678  36345]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1156548
{'0': {'precision': 0.22297999385326875, 'recall': 0.7422057677318784, 'f1-score': 0.34293302722351643, 'support': 20528}, '1': {'precision': 0.7461636828644501, 'recall': 0.06834473388305846, 'f1-score': 0.12521996652216832, 'support': 85376}, '2': {'precision': 0.28389142064592826, 'recall': 0.6916727009413468, 'f1-score': 0.4025567184097773, 'support': 20715}, 'accuracy': 0.2795709964539287, 'macro avg': {'precision': 0.41767836578788237, 'recall': 0.5007410675187612, 'f1-score': 0.29023657071848735, 'support': 126619}, 'weighted avg': {'precision': 0.585714740131699, 'recall': 0.2795709964539287, 'f1-score': 0.20588909615855067, 'support': 126619}}
[[15236  1098  4194]
 [47593  5835 31948]
 [ 5500   887 14328]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
3870/3870 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1524242
{'0': {'precision': 0.2339851968941247, 'recall': 0.6190917568598638, 'f1-score': 0.339613691325107, 'support': 176935}, '1': {'precision': 0.6887709027496652, 'recall': 0.06834893073948237, 'f1-score': 0.12435747326934185, 'support': 647223}, '2': {'precision': 0.21724663831718402, 'recall': 0.5978743845322445, 'f1-score': 0.3186918176187893, 'support': 166540}, 'accuracy': 0.255724751639753, 'macro avg': {'precision': 0.38000091265365793, 'recall': 0.4284383573771969, 'f1-score': 0.26088766073774605, 'support': 990698}, 'weighted avg': {'precision': 0.5282828833288776, 'recall': 0.255724751639753, 'f1-score': 0.1954697604140154, 'support': 990698}}
[[109539  11679  55717]
 [299946  44237 303040]
 [ 58660   8310  99570]]
Evaluating performance on  train set...
1577/1577 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1175023
{'0': {'precision': 0.20391287297445157, 'recall': 0.6659919988614981, 'f1-score': 0.31222802920790244, 'support': 63241}, '1': {'precision': 0.7656520847700882, 'recall': 0.14730742059607185, 'f1-score': 0.24707828335989898, 'support': 278859}, '2': {'precision': 0.24601214151140882, 'recall': 0.5741084513922814, 'f1-score': 0.34443141852286047, 'support': 61410}, 'accuracy': 0.2935540630963297, 'macro avg': {'precision': 0.4051923664186495, 'recall': 0.4624692902832838, 'f1-score': 0.3012459103635539, 'support': 403510}, 'weighted avg': {'precision': 0.5985284982203538, 'recall': 0.2935540630963297, 'f1-score': 0.27210515037070676, 'support': 403510}}
[[ 42118   7116  14007]
 [143734  41078  94047]
 [ 20697   5457  35256]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1582445
{'0': {'precision': 0.1772526899559179, 'recall': 0.652134106465536, 'f1-score': 0.27874213836477985, 'support': 22937}, '1': {'precision': 0.7538882081251768, 'recall': 0.07452270249620305, 'f1-score': 0.13563748600888648, 'support': 107323}, '2': {'precision': 0.230954784185585, 'recall': 0.5821474773609314, 'f1-score': 0.33070808275051133, 'support': 23190}, 'accuracy': 0.23757575757575758, 'macro avg': {'precision': 0.38736522742222657, 'recall': 0.4362680954408902, 'f1-score': 0.24836256904139256, 'support': 153450}, 'weighted avg': {'precision': 0.5886675174675853, 'recall': 0.23757575757575758, 'f1-score': 0.1865079881237474, 'support': 153450}}
[[14958  1448  6531]
 [60903  7998 38422]
 [ 8527  1163 13500]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
2451/2451 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0886127
{'0': {'precision': 0.3851274465179791, 'recall': 0.6562712083508386, 'f1-score': 0.4854011545218774, 'support': 216601}, '1': {'precision': 0.34141201264488935, 'recall': 0.05451387342448671, 'f1-score': 0.09401603632282594, 'support': 202077}, '2': {'precision': 0.4002141791936419, 'recall': 0.43342614646583244, 'f1-score': 0.416158585686611, 'support': 208663}, 'accuracy': 0.3883135328314266, 'macro avg': {'precision': 0.37558454611883674, 'recall': 0.38140374274705263, 'f1-score': 0.3318585921771048, 'support': 627341}, 'weighted avg': {'precision': 0.3760640490507794, 'recall': 0.3883135328314266, 'f1-score': 0.3362983656539684, 'support': 627341}}
[[142149  11924  62528]
 [118050  11016  73011]
 [108897   9326  90440]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0657905
{'0': {'precision': 0.40042185318320905, 'recall': 0.6535395655546936, 'f1-score': 0.4965865340333425, 'support': 103120}, '1': {'precision': 0.427638306996998, 'recall': 0.12808149472872965, 'f1-score': 0.19712291479752436, 'support': 101209}, '2': {'precision': 0.4510113022475432, 'recall': 0.47607601957903134, 'f1-score': 0.4632048362739482, 'support': 102763}, 'accuracy': 0.42097807823062794, 'macro avg': {'precision': 0.42635715414258346, 'recall': 0.4192323599541516, 'f1-score': 0.38563809503493834, 'support': 307092}, 'weighted avg': {'precision': 0.4263205207754548, 'recall': 0.42097807823062794, 'f1-score': 0.38672103168848637, 'support': 307092}}
[[67393  8872 26855]
 [55550 12963 32696]
 [45362  8478 48923]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0634465
{'0': {'precision': 0.4015453787517866, 'recall': 0.7019128171763175, 'f1-score': 0.5108482569867321, 'support': 38425}, '1': {'precision': 0.44742144936189265, 'recall': 0.1586566453183719, 'f1-score': 0.23424831493601642, 'support': 37786}, '2': {'precision': 0.45913513849597415, 'recall': 0.40437532513758456, 'f1-score': 0.43001892560780325, 'support': 36523}, 'accuracy': 0.4234303759291784, 'macro avg': {'precision': 0.4360339888698845, 'recall': 0.4216482625440913, 'f1-score': 0.3917051658435173, 'support': 112734}, 'weighted avg': {'precision': 0.43557968960042526, 'recall': 0.4234303759291784, 'f1-score': 0.39195125093460087, 'support': 112734}}
[[26971  3703  7751]
 [22144  5995  9647]
 [18053  3701 14769]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772363
{'0': {'precision': 0.3538561267997845, 'recall': 0.7531763891965844, 'f1-score': 0.4814963897212655, 'support': 257289}, '1': {'precision': 0.49175820157669187, 'recall': 0.09759821651465628, 'f1-score': 0.16287164085112565, 'support': 344494}, '2': {'precision': 0.4378211457261097, 'recall': 0.4131336277642544, 'f1-score': 0.4251192751497696, 'support': 252238}, 'accuracy': 0.38829724327621923, 'macro avg': {'precision': 0.427811824700862, 'recall': 0.42130274449183164, 'f1-score': 0.3564957685740536, 'support': 854021}, 'weighted avg': {'precision': 0.43428225893486594, 'recall': 0.38829724327621923, 'f1-score': 0.33631873617111285, 'support': 854021}}
[[193784  16233  47272]
 [224337  33622  86535]
 [129514  18516 104208]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950028
{'0': {'precision': 0.3611569108605145, 'recall': 0.5665325894208728, 'f1-score': 0.4411112981983499, 'support': 115605}, '1': {'precision': 0.39749676305567544, 'recall': 0.07711806348481388, 'f1-score': 0.12917498103368036, 'support': 131370}, '2': {'precision': 0.38209626178786243, 'recall': 0.510849401079484, 'f1-score': 0.43719042402255703, 'support': 119131}, 'accuracy': 0.3727964032274806, 'macro avg': {'precision': 0.3802499785680175, 'recall': 0.3848333513283902, 'f1-score': 0.3358255677515291, 'support': 366106}, 'weighted avg': {'precision': 0.381010429235532, 'recall': 0.3727964032274806, 'f1-score': 0.32790317910890854, 'support': 366106}}
[[65494  8236 41875]
 [64698 10131 56541]
 [51153  7120 60858]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082968
{'0': {'precision': 0.39518677444034195, 'recall': 0.5413021687625296, 'f1-score': 0.4568456672626944, 'support': 43896}, '1': {'precision': 0.32226258432797095, 'recall': 0.06590432729298772, 'f1-score': 0.10942972312165467, 'support': 37691}, '2': {'precision': 0.41443338107646377, 'recall': 0.5433975925423116, 'f1-score': 0.4702334916050712, 'support': 44196}, 'accuracy': 0.399584999562739, 'macro avg': {'precision': 0.37729424661492555, 'recall': 0.38353469619927627, 'f1-score': 0.34550296066314007, 'support': 125783}, 'weighted avg': {'precision': 0.38009759209745514, 'recall': 0.399584999562739, 'f1-score': 0.35744617714094307, 'support': 125783}}
[[23761  2885 17250]
 [18524  2484 16683]
 [17841  2339 24016]]
testing model on single stock: results/universal/W9/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
10303/10303 - 57s - 57s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1247802
{'0': {'precision': 0.31523200601300544, 'recall': 0.4005584463463456, 'f1-score': 0.35280951890601664, 'support': 808314}, '1': {'precision': 0.4080978810359759, 'recall': 0.0950116901097897, 'f1-score': 0.15413767350578977, 'support': 1006834}, '2': {'precision': 0.31833286091184615, 'recall': 0.5326698741024694, 'f1-score': 0.39850947116342594, 'support': 822256}, 'accuracy': 0.32510339712838837, 'macro avg': {'precision': 0.34722091598694244, 'recall': 0.3427466701862016, 'f1-score': 0.30181888785841077, 'support': 2637404}, 'weighted avg': {'precision': 0.3516504754468042, 'recall': 0.32510339712838837, 'f1-score': 0.291213908658848, 'support': 2637404}}
[[323777  70166 414371]
 [387645  95661 523528]
 [315685  68580 437991]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1199725
{'0': {'precision': 0.340424495938738, 'recall': 0.5373001900290633, 'f1-score': 0.4167825043151218, 'support': 286272}, '1': {'precision': 0.2680977409802006, 'recall': 0.11929985545892653, 'f1-score': 0.16512245838277106, 'support': 289883}, '2': {'precision': 0.34285665749328986, 'recall': 0.3375028010127124, 'f1-score': 0.34015866408013096, 'support': 298999}, 'accuracy': 0.33058181760010236, 'macro avg': {'precision': 0.3171262981374095, 'recall': 0.3313676155002341, 'f1-score': 0.3073545422593413, 'support': 875154}, 'weighted avg': {'precision': 0.31729818578647195, 'recall': 0.33058181760010236, 'f1-score': 0.3072447307330669, 'support': 875154}}
[[153814  46410  86048]
 [147931  34583 107369]
 [150085  48001 100913]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1162783
{'0': {'precision': 0.3327261593390626, 'recall': 0.5523631476471906, 'f1-score': 0.415292936489944, 'support': 116074}, '1': {'precision': 0.3533159227603672, 'recall': 0.07104720831974029, 'f1-score': 0.11830485793214929, 'support': 125677}, '2': {'precision': 0.34129707533489356, 'recall': 0.41156559754144484, 'f1-score': 0.3731520762284499, 'support': 115515}, 'accuracy': 0.3375244215794394, 'macro avg': {'precision': 0.3424463858114411, 'recall': 0.34499198450279195, 'f1-score': 0.3022499568835144, 'support': 357266}, 'weighted avg': {'precision': 0.3427403478113989, 'recall': 0.3375244215794394, 'f1-score': 0.2971947345283399, 'support': 357266}}
[[64115  8452 43507]
 [68499  8929 48249]
 [60082  7891 47542]]
training model: results/universal/W9/deepLOB_L1/h100
Epoch 1/50
6697/6697 - 106s - loss: 3.1507 - accuracy100: 0.4279 - val_loss: 3.4300 - val_accuracy100: 0.3263 - 106s/epoch - 16ms/step
Epoch 2/50
6697/6697 - 104s - loss: 3.1336 - accuracy100: 0.4352 - val_loss: 3.3181 - val_accuracy100: 0.3363 - 104s/epoch - 15ms/step
Epoch 3/50
6697/6697 - 104s - loss: 3.1199 - accuracy100: 0.4397 - val_loss: 3.3159 - val_accuracy100: 0.3318 - 104s/epoch - 15ms/step
Epoch 4/50
6697/6697 - 105s - loss: 3.1055 - accuracy100: 0.4459 - val_loss: 3.3286 - val_accuracy100: 0.3401 - 105s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 102s - loss: 3.0936 - accuracy100: 0.4499 - val_loss: 3.3252 - val_accuracy100: 0.3267 - 102s/epoch - 15ms/step
Epoch 6/50
6697/6697 - 102s - loss: 3.0832 - accuracy100: 0.4533 - val_loss: 3.3408 - val_accuracy100: 0.3424 - 102s/epoch - 15ms/step
Epoch 7/50
6697/6697 - 104s - loss: 3.0757 - accuracy100: 0.4559 - val_loss: 3.3711 - val_accuracy100: 0.3442 - 104s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 104s - loss: 3.0680 - accuracy100: 0.4580 - val_loss: 3.3898 - val_accuracy100: 0.3368 - 104s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 108s - loss: 3.0620 - accuracy100: 0.4602 - val_loss: 3.3982 - val_accuracy100: 0.3357 - 108s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 104s - loss: 3.0561 - accuracy100: 0.4620 - val_loss: 3.4414 - val_accuracy100: 0.3323 - 104s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 106s - loss: 3.0523 - accuracy100: 0.4628 - val_loss: 3.4637 - val_accuracy100: 0.3359 - 106s/epoch - 16ms/step
Epoch 12/50
6697/6697 - 108s - loss: 3.0480 - accuracy100: 0.4640 - val_loss: 3.4448 - val_accuracy100: 0.3323 - 108s/epoch - 16ms/step
Epoch 13/50
6697/6697 - 107s - loss: 3.0441 - accuracy100: 0.4652 - val_loss: 3.3687 - val_accuracy100: 0.3262 - 107s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 88s - 88s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1196744
{'0': {'precision': 0.30232631837642765, 'recall': 0.7316679201221473, 'f1-score': 0.42786015691125495, 'support': 1277801}, '1': {'precision': 0.40888467528949685, 'recall': 0.11033285556843554, 'f1-score': 0.17377461715639408, 'support': 1751210}, '2': {'precision': 0.3211177414664096, 'recall': 0.1865181807872932, 'f1-score': 0.23597343817171987, 'support': 1278685}, 'accuracy': 0.317255442352478, 'macro avg': {'precision': 0.34410957837744477, 'recall': 0.342839652159292, 'f1-score': 0.279202737413123, 'support': 4307696}, 'weighted avg': {'precision': 0.35122354117106064, 'recall': 0.317255442352478, 'f1-score': 0.26760748192546846, 'support': 4307696}}
[[ 934926  136009  206866]
 [1260646  193216  297348]
 [ 896868  143319  238498]]
Evaluating performance on  train set...
6697/6697 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1178622
{'0': {'precision': 0.32090960316605444, 'recall': 0.8344619441575812, 'f1-score': 0.4635510576266127, 'support': 524834}, '1': {'precision': 0.41623427752316733, 'recall': 0.06300443428487607, 'f1-score': 0.10944276636744402, 'support': 654446}, '2': {'precision': 0.36480480864533044, 'recall': 0.17070456776847912, 'f1-score': 0.23257798993809725, 'support': 534725}, 'accuracy': 0.3328269170743376, 'macro avg': {'precision': 0.36731622977818407, 'recall': 0.3560569820703121, 'f1-score': 0.26852393797738466, 'support': 1714005}, 'weighted avg': {'precision': 0.3710008897050207, 'recall': 0.3328269170743376, 'f1-score': 0.2562868848843282, 'support': 1714005}}
[[437954  26216  60664]
 [514941  41233  98272]
 [411832  31613  91280]]
Evaluating performance on  val set...
2631/2631 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1182488
{'0': {'precision': 0.3194733086038286, 'recall': 0.783976752242023, 'f1-score': 0.45395737567906397, 'support': 207848}, '1': {'precision': 0.37799202867894277, 'recall': 0.06521129519865705, 'f1-score': 0.11123269360556164, 'support': 260323}, '2': {'precision': 0.36943301810779866, 'recall': 0.21279256657400938, 'f1-score': 0.27004172323792164, 'support': 204697}, 'accuracy': 0.33213349423661104, 'macro avg': {'precision': 0.35563278513019, 'recall': 0.35399353800489647, 'f1-score': 0.27841059750751573, 'support': 672868}, 'weighted avg': {'precision': 0.35731189124180235, 'recall': 0.33213349423661104, 'f1-score': 0.2654120744919591, 'support': 672868}}
[[162948  13091  31809]
 [200809  16976  42538]
 [146295  14844  43558]]
testing model out of sample: results/universal/W9/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 53s - 53s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1321504
{'0': {'precision': 0.303165689115172, 'recall': 0.8907609087178909, 'f1-score': 0.45236976078503427, 'support': 638526}, '1': {'precision': 0.5338107726447449, 'recall': 0.055093338663402, 'f1-score': 0.09987845937825554, 'support': 960588}, '2': {'precision': 0.3316214979407129, 'recall': 0.12785185233588064, 'f1-score': 0.184552260802924, 'support': 612146}, 'accuracy': 0.31654350913054097, 'macro avg': {'precision': 0.38953265323354325, 'recall': 0.3579020332390579, 'f1-score': 0.24560016032207124, 'support': 2211260}, 'weighted avg': {'precision': 0.41123710950301645, 'recall': 0.31654350913054097, 'f1-score': 0.22510461531151071, 'support': 2211260}}
[[568774  20351  49401]
 [799327  52922 108339]
 [508015  25867  78264]]
Evaluating performance on  train set...
3947/3947 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1226405
{'0': {'precision': 0.3024252464281407, 'recall': 0.8256694092285938, 'f1-score': 0.44269915348329864, 'support': 288538}, '1': {'precision': 0.46508278330909497, 'recall': 0.07776190487324147, 'f1-score': 0.13324519495608103, 'support': 427703}, '2': {'precision': 0.3470537751728084, 'recall': 0.17783641340846876, 'f1-score': 0.23516842181188694, 'support': 293337}, 'accuracy': 0.32059137580256303, 'macro avg': {'precision': 0.3715206016366814, 'recall': 0.360422575836768, 'f1-score': 0.27037092341708885, 'support': 1009578}, 'weighted avg': {'precision': 0.38430135231888846, 'recall': 0.32059137580256303, 'f1-score': 0.2513015312487973, 'support': 1009578}}
[[238237  16347  33954]
 [330253  33259  64191]
 [219265  21906  52166]]
Evaluating performance on  val set...
1402/1402 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1278851
{'0': {'precision': 0.29541455265013794, 'recall': 0.8362001298537691, 'f1-score': 0.43658975286561036, 'support': 103193}, '1': {'precision': 0.4412413660782809, 'recall': 0.06043107808938202, 'f1-score': 0.106303193487066, 'support': 152223}, '2': {'precision': 0.3442688096079124, 'recall': 0.15165425087040244, 'f1-score': 0.21055616316279827, 'support': 102826}, 'accuracy': 0.31007810362827365, 'macro avg': {'precision': 0.3603082427787771, 'recall': 0.3494284862711845, 'f1-score': 0.2511497031718249, 'support': 358242}, 'weighted avg': {'precision': 0.3714014074756813, 'recall': 0.31007810362827365, 'f1-score': 0.23136719151584814, 'support': 358242}}
[[ 86290   5502  11401]
 [124723   9199  18301]
 [ 81085   6147  15594]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1172291
{'0': {'precision': 0.31487254395496733, 'recall': 0.7542242703533026, 'f1-score': 0.44427129805335985, 'support': 23436}, '1': {'precision': 0.35910918651407364, 'recall': 0.08370583994232156, 'f1-score': 0.13576565514821962, 'support': 27740}, '2': {'precision': 0.3425730169916216, 'recall': 0.18080006612116703, 'f1-score': 0.23668478995915498, 'support': 24198}, 'accuracy': 0.3233608406081673, 'macro avg': {'precision': 0.33885158248688757, 'recall': 0.33957672547226375, 'f1-score': 0.2722405810535781, 'support': 75374}, 'weighted avg': {'precision': 0.34004595270507443, 'recall': 0.3233608406081673, 'f1-score': 0.26408814660787255, 'support': 75374}}
[[17676  1943  3817]
 [20839  2322  4579]
 [17622  2201  4375]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1141113
{'0': {'precision': 0.3539457558480311, 'recall': 0.7559893017697604, 'f1-score': 0.48215290253506815, 'support': 17573}, '1': {'precision': 0.36722960833632773, 'recall': 0.06223358908780904, 'f1-score': 0.10643061702681594, 'support': 16422}, '2': {'precision': 0.36838697743248244, 'recall': 0.23246177191548967, 'f1-score': 0.28504973878193657, 'support': 17134}, 'accuracy': 0.3577226231688474, 'macro avg': {'precision': 0.36318744720561374, 'recall': 0.350228220924353, 'f1-score': 0.2912110861146069, 'support': 51129}, 'weighted avg': {'precision': 0.3630518075249815, 'recall': 0.3577226231688474, 'f1-score': 0.29542370813731594, 'support': 51129}}
[[13285   789  3499]
 [12070  1022  3330]
 [12179   972  3983]]
Evaluating performance on  val set...
53/53 - 0s - 494ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1080856
{'0': {'precision': 0.33449367088607596, 'recall': 0.7156398104265402, 'f1-score': 0.455898210049601, 'support': 4431}, '1': {'precision': 0.39452054794520547, 'recall': 0.11837237977805179, 'f1-score': 0.182105595953209, 'support': 4866}, '2': {'precision': 0.32637795275590553, 'recall': 0.19818312216112838, 'f1-score': 0.24661609400565224, 'support': 4183}, 'accuracy': 0.3394658753709199, 'macro avg': {'precision': 0.35179739052906234, 'recall': 0.3440651041219068, 'f1-score': 0.29487330000282075, 'support': 13480}, 'weighted avg': {'precision': 0.3536437253987778, 'recall': 0.3394658753709199, 'f1-score': 0.29212210088009943, 'support': 13480}}
[[3171  469  791]
 [3370  576  920]
 [2939  415  829]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1519761
{'0': {'precision': 0.2255342440759915, 'recall': 0.8255693581780539, 'f1-score': 0.3542831757587048, 'support': 59892}, '1': {'precision': 0.6085254027261462, 'recall': 0.07498457798652636, 'f1-score': 0.13351676436362847, 'support': 163727}, '2': {'precision': 0.27143987849487666, 'recall': 0.20290063641306086, 'f1-score': 0.23221851123209955, 'support': 62538}, 'accuracy': 0.2600355748767285, 'macro avg': {'precision': 0.36849984176567147, 'recall': 0.3678181908592137, 'f1-score': 0.24000615045147763, 'support': 286157}, 'weighted avg': {'precision': 0.4546980946810863, 'recall': 0.2600355748767285, 'f1-score': 0.20129337565370475, 'support': 286157}}
[[ 49445   3217   7230]
 [124622  12277  26828]
 [ 45168   4681  12689]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1330677
{'0': {'precision': 0.2527831939115668, 'recall': 0.8212096444626072, 'f1-score': 0.38657240417448174, 'support': 29364}, '1': {'precision': 0.6323368289247143, 'recall': 0.056352959227797074, 'f1-score': 0.10348360655737705, 'support': 71691}, '2': {'precision': 0.309943865276664, 'recall': 0.30193168098856615, 'f1-score': 0.3058853154903231, 'support': 28162}, 'accuracy': 0.28368558316630166, 'macro avg': {'precision': 0.3983546293709817, 'recall': 0.3931647615596568, 'f1-score': 0.265313775407394, 'support': 129217}, 'weighted avg': {'precision': 0.4758214820215788, 'recall': 0.28368558316630166, 'f1-score': 0.2119264304907472, 'support': 129217}}
[[24114   889  4361]
 [53081  4040 14570]
 [18199  1460  8503]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1508337
{'0': {'precision': 0.24400771642150954, 'recall': 0.9395543175487465, 'f1-score': 0.3874042879019908, 'support': 10770}, '1': {'precision': 0.5729571984435797, 'recall': 0.022361427486712226, 'f1-score': 0.043042969891844494, 'support': 26340}, '2': {'precision': 0.5049858889934149, 'recall': 0.25077081192189105, 'f1-score': 0.33512298664003, 'support': 10703}, 'accuracy': 0.2800911885888775, 'macro avg': {'precision': 0.44065026795283474, 'recall': 0.4042288523191166, 'f1-score': 0.2551900814779551, 'support': 47813}, 'weighted avg': {'precision': 0.48364502714241037, 'recall': 0.2800911885888775, 'f1-score': 0.1859937116195149, 'support': 47813}}
[[10119   131   520]
 [23640   589  2111]
 [ 7711   308  2684]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1380491
{'0': {'precision': 0.33310845668478906, 'recall': 0.8089237959862192, 'f1-score': 0.47189447868281065, 'support': 41507}, '1': {'precision': 0.41537351136773726, 'recall': 0.025105241346216764, 'f1-score': 0.0473487185815953, 'support': 45847}, '2': {'precision': 0.3842233378974593, 'recall': 0.23766615692271498, 'f1-score': 0.293675596319607, 'support': 42505}, 'accuracy': 0.34521288474422257, 'macro avg': {'precision': 0.3775684353166619, 'recall': 0.35723173141838366, 'f1-score': 0.270972931194671, 'support': 129859}, 'weighted avg': {'precision': 0.3788830582756967, 'recall': 0.34521288474422257, 'f1-score': 0.26367369261323986, 'support': 129859}}
[[33576   677  7254]
 [35760  1151  8936]
 [31460   943 10102]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1200515
{'0': {'precision': 0.3475514332608115, 'recall': 0.8116865751470851, 'f1-score': 0.486703904642275, 'support': 22436}, '1': {'precision': 0.38006134969325156, 'recall': 0.05581583926479863, 'f1-score': 0.09733679000707048, 'support': 22198}, '2': {'precision': 0.384204909284952, 'recall': 0.19400035925992457, 'f1-score': 0.25781809501074243, 'support': 22268}, 'accuracy': 0.35529580580550657, 'macro avg': {'precision': 0.37060589741300504, 'recall': 0.3538342578906028, 'f1-score': 0.28061959655336266, 'support': 66902}, 'weighted avg': {'precision': 0.3705381112236955, 'recall': 0.35529580580550657, 'f1-score': 0.28132887221353986, 'support': 66902}}
[[18211   961  3264]
 [17299  1239  3660]
 [16888  1060  4320]]
Evaluating performance on  val set...
73/73 - 1s - 592ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1185217
{'0': {'precision': 0.35551181102362206, 'recall': 0.84, 'f1-score': 0.4995850622406639, 'support': 6450}, '1': {'precision': 0.32805071315372425, 'recall': 0.03478991596638655, 'f1-score': 0.06290837258775261, 'support': 5950}, '2': {'precision': 0.37369744879626304, 'recall': 0.16629357211384713, 'f1-score': 0.23016487772490868, 'support': 6254}, 'accuracy': 0.357296022300847, 'macro avg': {'precision': 0.35241999099120314, 'recall': 0.3470278293600779, 'f1-score': 0.26421943751777505, 'support': 18654}, 'weighted avg': {'precision': 0.3528496177301839, 'recall': 0.357296022300847, 'f1-score': 0.26997317538549315, 'support': 18654}}
[[5418  209  823]
 [4823  207  920]
 [4999  215 1040]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.116925
{'0': {'precision': 0.3162629077786115, 'recall': 0.7357800453043496, 'f1-score': 0.44237725452466775, 'support': 48119}, '1': {'precision': 0.38027868619365846, 'recall': 0.08865500953012348, 'f1-score': 0.1437883899409954, 'support': 60335}, '2': {'precision': 0.3169941545179238, 'recall': 0.19587449410331173, 'f1-score': 0.2421324439184464, 'support': 45958}, 'accuracy': 0.32222884231795457, 'macro avg': {'precision': 0.3378452494967312, 'recall': 0.3401031829792616, 'f1-score': 0.2760993627947032, 'support': 154412}, 'weighted avg': {'precision': 0.3414940985430416, 'recall': 0.32222884231795457, 'f1-score': 0.26610720977104374, 'support': 154412}}
[[35405  4244  8470]
 [44060  5349 10926]
 [32483  4473  9002]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1258384
{'0': {'precision': 0.35712895512428405, 'recall': 0.8775963377972124, 'f1-score': 0.5076676811193233, 'support': 29272}, '1': {'precision': 0.3144560357675112, 'recall': 0.015505584950029395, 'f1-score': 0.029553890328454374, 'support': 27216}, '2': {'precision': 0.3523127870953958, 'recall': 0.12613301717214212, 'f1-score': 0.1857609552776839, 'support': 26147}, 'accuracy': 0.35589036122708295, 'macro avg': {'precision': 0.34129925932906363, 'recall': 0.33974497997312797, 'f1-score': 0.24099417557515382, 'support': 82635}, 'weighted avg': {'precision': 0.3415506345740902, 'recall': 0.35589036122708295, 'f1-score': 0.24834366477339684, 'support': 82635}}
[[25689   510  3073]
 [23804   422  2990]
 [22439   410  3298]]
Evaluating performance on  val set...
112/112 - 1s - 773ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1132324
{'0': {'precision': 0.3675670227776658, 'recall': 0.7130009775171066, 'f1-score': 0.4850701602713307, 'support': 10230}, '1': {'precision': 0.27614571092831963, 'recall': 0.05665380906460945, 'f1-score': 0.09401880376075215, 'support': 8296}, '2': {'precision': 0.3568940493468795, 'recall': 0.24813319878910192, 'f1-score': 0.29273809523809524, 'support': 9910}, 'accuracy': 0.3595090730060487, 'macro avg': {'precision': 0.333535594350955, 'recall': 0.3392626617902727, 'f1-score': 0.29060901975672604, 'support': 28436}, 'weighted avg': {'precision': 0.3371759561789435, 'recall': 0.3595090730060487, 'f1-score': 0.30395562875877186, 'support': 28436}}
[[7294  578 2358]
 [5753  470 2073]
 [6797  654 2459]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
631/631 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1182554
{'0': {'precision': 0.3819885098392355, 'recall': 0.9134782318376068, 'f1-score': 0.5387065176193782, 'support': 59904}, '1': {'precision': 0.32489040428641014, 'recall': 0.014323447935233106, 'f1-score': 0.027437268613739203, 'support': 46567}, '2': {'precision': 0.40244969378827644, 'recall': 0.11743895544978755, 'f1-score': 0.18182074845777044, 'support': 54837}, 'accuracy': 0.3832915912415999, 'macro avg': {'precision': 0.369776202637974, 'recall': 0.3484135450742092, 'f1-score': 0.24932151156362925, 'support': 161308}, 'weighted avg': {'precision': 0.3724610373204214, 'recall': 0.3832915912415999, 'f1-score': 0.2697873069047163, 'support': 161308}}
[[54721   630  4553]
 [40891   667  5009]
 [47641   756  6440]]
Evaluating performance on  train set...
477/477 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1201763
{'0': {'precision': 0.3408433083472047, 'recall': 0.7981132075471699, 'f1-score': 0.47768556972934423, 'support': 40280}, '1': {'precision': 0.3217265143271672, 'recall': 0.06604944400317712, 'f1-score': 0.1095986325912807, 'support': 40288}, '2': {'precision': 0.37495475931958017, 'recall': 0.17532577424268064, 'f1-score': 0.23892988929889297, 'support': 41363}, 'accuracy': 0.34495739393591457, 'macro avg': {'precision': 0.34584152733131734, 'recall': 0.34649614193100925, 'f1-score': 0.275404697206506, 'support': 121931}, 'weighted avg': {'precision': 0.34609853096566184, 'recall': 0.34495739393591457, 'f1-score': 0.2750698466313375, 'support': 121931}}
[[32148  2681  5451]
 [30989  2661  6638]
 [31182  2929  7252]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1147373
{'0': {'precision': 0.343356680183264, 'recall': 0.8283572608308982, 'f1-score': 0.4854802680565897, 'support': 15742}, '1': {'precision': 0.31982881597717544, 'recall': 0.07067650211209886, 'f1-score': 0.1157699060208613, 'support': 15861}, '2': {'precision': 0.37833827893175076, 'recall': 0.13357778941854373, 'f1-score': 0.19744483159117304, 'support': 15272}, 'accuracy': 0.34562133333333334, 'macro avg': {'precision': 0.34717459169739673, 'recall': 0.3442038507871803, 'f1-score': 0.26623166855620806, 'support': 46875}, 'weighted avg': {'precision': 0.3467927019840985, 'recall': 0.34562133333333334, 'f1-score': 0.2665393989803544, 'support': 46875}}
[[13040  1074  1628]
 [13016  1121  1724]
 [11922  1310  2040]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1515619
{'0': {'precision': 0.25828811351346287, 'recall': 0.9452332935479003, 'f1-score': 0.4057136379762899, 'support': 145782}, '1': {'precision': 0.6025707384403036, 'recall': 0.022321785231510627, 'f1-score': 0.043048857525846265, 'support': 312923}, '2': {'precision': 0.33933839574059527, 'recall': 0.13529653319598822, 'f1-score': 0.19345945999741243, 'support': 143677}, 'accuracy': 0.2726210278527579, 'macro avg': {'precision': 0.40006574923145394, 'recall': 0.3676172039917997, 'f1-score': 0.21407398516651618, 'support': 602382}, 'weighted avg': {'precision': 0.45646636790939343, 'recall': 0.2726210278527579, 'f1-score': 0.16669222860090127, 'support': 602382}}
[[137798    998   6986]
 [275078   6985  30860]
 [120629   3609  19439]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1193616
{'0': {'precision': 0.2753791787349155, 'recall': 0.8948281442164542, 'f1-score': 0.42115108089005876, 'support': 77245}, '1': {'precision': 0.5747020083818647, 'recall': 0.06473267654505661, 'f1-score': 0.11635902804562234, 'support': 163117}, '2': {'precision': 0.41420118343195267, 'recall': 0.26312150355144887, 'f1-score': 0.32181186383345123, 'support': 79545}, 'accuracy': 0.3144976508797869, 'macro avg': {'precision': 0.42142745684957755, 'recall': 0.40756077477098657, 'f1-score': 0.28644065758971077, 'support': 319907}, 'weighted avg': {'precision': 0.4625186860515645, 'recall': 0.3144976508797869, 'f1-score': 0.24104028836412536, 'support': 319907}}
[[ 69121   2679   5445]
 [128402  10559  24156]
 [ 53480   5135  20930]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1176342
{'0': {'precision': 0.27412935323383086, 'recall': 0.8771557442292385, 'f1-score': 0.4177143218143914, 'support': 30152}, '1': {'precision': 0.6149333333333333, 'recall': 0.06947457218606894, 'f1-score': 0.12484435060364898, 'support': 66384}, '2': {'precision': 0.4059366579795927, 'recall': 0.30548814945317954, 'f1-score': 0.3486210690034521, 'support': 30083}, 'accuracy': 0.31788278220488236, 'macro avg': {'precision': 0.4316664481822523, 'recall': 0.4173728219561623, 'f1-score': 0.2970599138071641, 'support': 126619}, 'weighted avg': {'precision': 0.4841222497469302, 'recall': 0.31788278220488236, 'f1-score': 0.24775236908087261, 'support': 126619}}
[[26448   822  2882]
 [51205  4612 10567]
 [18827  2066  9190]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
3870/3870 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1386173
{'0': {'precision': 0.2597858151851094, 'recall': 0.8638442131819615, 'f1-score': 0.39944548908246674, 'support': 240996}, '1': {'precision': 0.6093507896569861, 'recall': 0.08194938049510686, 'f1-score': 0.1444695716062323, 'support': 523079}, '2': {'precision': 0.26015447065645825, 'recall': 0.13659249061216205, 'f1-score': 0.17913254824802524, 'support': 226623}, 'accuracy': 0.28465183133507893, 'macro avg': {'precision': 0.3764303584995179, 'recall': 0.36079536142974344, 'f1-score': 0.24101586964557478, 'support': 990698}, 'weighted avg': {'precision': 0.44443708438183566, 'recall': 0.28465183133507893, 'f1-score': 0.2144238906455315, 'support': 990698}}
[[208183  12395  20418]
 [412599  42866  67614]
 [180582  15086  30955]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1389251
{'0': {'precision': 0.24075348330349497, 'recall': 0.8745475931958017, 'f1-score': 0.3775668898974831, 'support': 88416}, '1': {'precision': 0.6185347881536063, 'recall': 0.07653564430651079, 'f1-score': 0.13621629212387412, 'support': 228129}, '2': {'precision': 0.2919030809322269, 'recall': 0.18161329270396137, 'f1-score': 0.22391402971532268, 'support': 86965}, 'accuracy': 0.27404029639909794, 'macro avg': {'precision': 0.38373045079644275, 'recall': 0.377565510068758, 'f1-score': 0.2458990705788933, 'support': 403510}, 'weighted avg': {'precision': 0.46536029862884926, 'recall': 0.27404029639909794, 'f1-score': 0.20800110093255725, 'support': 403510}}
[[ 77324   3817   7275]
 [179631  17460  31038]
 [ 64220   6951  15794]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1569494
{'0': {'precision': 0.2175490386482812, 'recall': 0.8636279528773206, 'f1-score': 0.34754981352892633, 'support': 32426}, '1': {'precision': 0.6005454114299265, 'recall': 0.05743086185978479, 'f1-score': 0.10483612240885053, 'support': 88193}, '2': {'precision': 0.27665582223313484, 'recall': 0.13727879138618987, 'f1-score': 0.18350230039493504, 'support': 32831}, 'accuracy': 0.24487455197132615, 'macro avg': {'precision': 0.36491675743711416, 'recall': 0.3527792020410984, 'f1-score': 0.2119627454442373, 'support': 153450}, 'weighted avg': {'precision': 0.4503162847649705, 'recall': 0.24487455197132615, 'f1-score': 0.17295553223433582, 'support': 153450}}
[[28004  1650  2772]
 [74116  5065  9012]
 [26605  1719  4507]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1080745
{'0': {'precision': 0.3552066341641227, 'recall': 0.8873211862940603, 'f1-score': 0.5073244507150043, 'support': 219642}, '1': {'precision': 0.34701667447934104, 'recall': 0.026223501966003572, 'f1-score': 0.04876212701489587, 'support': 197609}, '2': {'precision': 0.3585583606608821, 'recall': 0.1087724308629635, 'f1-score': 0.16691074161045638, 'support': 210090}, 'accuracy': 0.3553521928265489, 'macro avg': {'precision': 0.35359388976811523, 'recall': 0.3407723730410091, 'f1-score': 0.24099910644678554, 'support': 627341}, 'weighted avg': {'precision': 0.3537492999174437, 'recall': 0.3553521928265489, 'f1-score': 0.24887879138486457, 'support': 627341}}
[[194893   4520  20229]
 [171775   5182  20652]
 [182007   5231  22852]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.113439
{'0': {'precision': 0.3522954383300441, 'recall': 0.8229371747139432, 'f1-score': 0.49337809292582235, 'support': 102602}, '1': {'precision': 0.3754095376774663, 'recall': 0.04015497386276247, 'f1-score': 0.0725497955414853, 'support': 102727}, '2': {'precision': 0.39678911275317635, 'recall': 0.22004068276289024, 'f1-score': 0.28309186072972764, 'support': 101763}, 'accuracy': 0.36129889414247196, 'macro avg': {'precision': 0.37483136292022895, 'recall': 0.3610442771131986, 'f1-score': 0.28300658306567844, 'support': 307092}, 'weighted avg': {'precision': 0.37477160792737596, 'recall': 0.36129889414247196, 'f1-score': 0.2829206848775112, 'support': 307092}}
[[84435  2835 15332]
 [79893  4125 18709]
 [75343  4028 22392]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1164695
{'0': {'precision': 0.35657709591030823, 'recall': 0.8312962962962963, 'f1-score': 0.499078809440615, 'support': 37800}, '1': {'precision': 0.38229997427321843, 'recall': 0.03817990288019321, 'f1-score': 0.06942627546253037, 'support': 38921}, '2': {'precision': 0.38281136901027846, 'recall': 0.22028156499042012, 'f1-score': 0.27964608009024255, 'support': 36013}, 'accuracy': 0.36228644419607214, 'macro avg': {'precision': 0.37389614639793506, 'recall': 0.36325258805563654, 'f1-score': 0.282717054997796, 'support': 112734}, 'weighted avg': {'precision': 0.3738383926434327, 'recall': 0.36228644419607214, 'f1-score': 0.2806448218498616, 'support': 112734}}
[[31423  1038  5339]
 [29984  1486  7451]
 [26717  1363  7933]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
3337/3337 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1274813
{'0': {'precision': 0.3288591643456915, 'recall': 0.9344403574846983, 'f1-score': 0.4865026381836389, 'support': 272683}, '1': {'precision': 0.3469480630297514, 'recall': 0.01921822564635818, 'f1-score': 0.036419115407811696, 'support': 317355}, '2': {'precision': 0.42601908347397116, 'recall': 0.09944958576878056, 'f1-score': 0.16125574695875702, 'support': 263983}, 'accuracy': 0.33624231722639136, 'macro avg': {'precision': 0.36727543694980475, 'recall': 0.3510360562999457, 'f1-score': 0.22805916685006922, 'support': 854021}, 'weighted avg': {'precision': 0.36561372819496507, 'recall': 0.33624231722639136, 'f1-score': 0.21871542164359992, 'support': 854021}}
[[254806   4632  13245]
 [289130   6099  22126]
 [230882   6848  26253]]
Evaluating performance on  train set...
1431/1431 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1073089
{'0': {'precision': 0.3444442478189315, 'recall': 0.8121385594952977, 'f1-score': 0.4837292297292596, 'support': 119833}, '1': {'precision': 0.3767698584113271, 'recall': 0.09107785125884674, 'f1-score': 0.14669469750058398, 'support': 120666}, '2': {'precision': 0.382188557140756, 'recall': 0.16550033039559897, 'f1-score': 0.2309790609947833, 'support': 125607}, 'accuracy': 0.352627381140981, 'macro avg': {'precision': 0.3678008877903382, 'recall': 0.3562389137165811, 'f1-score': 0.28713432940820893, 'support': 366106}, 'weighted avg': {'precision': 0.3680482083897182, 'recall': 0.352627381140981, 'f1-score': 0.28592914092946736, 'support': 366106}}
[[97321  8211 14301]
 [90373 10990 19303]
 [94851  9968 20788]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1000563
{'0': {'precision': 0.3631256737644767, 'recall': 0.8317325117796303, 'f1-score': 0.5055385356786342, 'support': 44144}, '1': {'precision': 0.32674632352941174, 'recall': 0.05710384708055578, 'f1-score': 0.09721747453339714, 'support': 37353}, '2': {'precision': 0.39103835978835977, 'recall': 0.1602086438152012, 'f1-score': 0.22729456991830851, 'support': 44286}, 'accuracy': 0.36526398638925767, 'macro avg': {'precision': 0.3603034523607494, 'recall': 0.3496816675584624, 'f1-score': 0.27668352671011326, 'support': 125783}, 'weighted avg': {'precision': 0.3621498928077759, 'recall': 0.36526398638925767, 'f1-score': 0.28631710778599506, 'support': 125783}}
[[36716  2058  5370]
 [29541  2133  5679]
 [34854  2337  7095]]
testing model on single stock: results/universal/W9/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
10303/10303 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.111706
{'0': {'precision': 0.3083294515137905, 'recall': 0.6435043251455184, 'f1-score': 0.41690333014918257, 'support': 804366}, '1': {'precision': 0.39711235137102646, 'recall': 0.1609752354871456, 'f1-score': 0.2290868164141789, 'support': 1016616}, '2': {'precision': 0.3194562866625925, 'recall': 0.21385386479051274, 'f1-score': 0.25619974173856896, 'support': 816422}, 'accuracy': 0.32450773563701274, 'macro avg': {'precision': 0.34163269651580314, 'recall': 0.33944447514105897, 'f1-score': 0.3007299627673102, 'support': 2637404}, 'weighted avg': {'precision': 0.34599615313671933, 'recall': 0.32450773563701274, 'f1-score': 0.29476079226549295, 'support': 2637404}}
[[517613 122788 163965]
 [644988 163650 207978]
 [516165 125662 174595]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.116229
{'0': {'precision': 0.33185199661813375, 'recall': 0.8183208719368886, 'f1-score': 0.4722097393372092, 'support': 286351}, '1': {'precision': 0.36168760023500646, 'recall': 0.07862752204905159, 'f1-score': 0.1291738499228745, 'support': 289695}, '2': {'precision': 0.33622169001866903, 'recall': 0.11921780761464086, 'f1-score': 0.1760216800027643, 'support': 299108}, 'accuracy': 0.3345285515463564, 'macro avg': {'precision': 0.34325376229060306, 'recall': 0.33872206720019366, 'f1-score': 0.2591350897542827, 'support': 875154}, 'weighted avg': {'precision': 0.34322169320117774, 'recall': 0.3345285515463564, 'f1-score': 0.25742696963577055, 'support': 875154}}
[[234327  19136  32888]
 [229406  22778  37511]
 [242386  21063  35659]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1147374
{'0': {'precision': 0.33301643094684374, 'recall': 0.7394781994348002, 'f1-score': 0.4592254054477553, 'support': 118896}, '1': {'precision': 0.3139781438590768, 'recall': 0.07995381369307704, 'f1-score': 0.12745221369598178, 'support': 120382}, '2': {'precision': 0.3382430467913798, 'recall': 0.1794504525883988, 'f1-score': 0.23449345183708503, 'support': 117988}, 'accuracy': 0.33229862343463973, 'macro avg': {'precision': 0.3284125405324334, 'recall': 0.33296082190542536, 'f1-score': 0.2737236903269407, 'support': 357266}, 'weighted avg': {'precision': 0.3283275181313661, 'recall': 0.33229862343463973, 'f1-score': 0.2732149983223144, 'support': 357266}}
[[87921 10349 20626]
 [89959  9625 20798]
 [86134 10681 21173]]
training model: results/universal/W9/deepLOB_L1/h200
Epoch 1/50
6697/6697 - 108s - loss: 3.2267 - accuracy200: 0.4051 - val_loss: 3.3115 - val_accuracy200: 0.3390 - 108s/epoch - 16ms/step
Epoch 2/50
6697/6697 - 107s - loss: 3.2061 - accuracy200: 0.4160 - val_loss: 3.3369 - val_accuracy200: 0.3442 - 107s/epoch - 16ms/step
Epoch 3/50
6697/6697 - 106s - loss: 3.1978 - accuracy200: 0.4205 - val_loss: 3.3980 - val_accuracy200: 0.3407 - 106s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 106s - loss: 3.1907 - accuracy200: 0.4235 - val_loss: 3.4018 - val_accuracy200: 0.3412 - 106s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 108s - loss: 3.1861 - accuracy200: 0.4256 - val_loss: 3.4030 - val_accuracy200: 0.3394 - 108s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 106s - loss: 3.1810 - accuracy200: 0.4280 - val_loss: 3.4046 - val_accuracy200: 0.3424 - 106s/epoch - 16ms/step
Epoch 7/50
6697/6697 - 105s - loss: 3.1774 - accuracy200: 0.4299 - val_loss: 3.4560 - val_accuracy200: 0.3413 - 105s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 105s - loss: 3.1744 - accuracy200: 0.4308 - val_loss: 3.4467 - val_accuracy200: 0.3419 - 105s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 105s - loss: 3.1726 - accuracy200: 0.4321 - val_loss: 3.4681 - val_accuracy200: 0.3415 - 105s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 107s - loss: 3.1686 - accuracy200: 0.4333 - val_loss: 3.4716 - val_accuracy200: 0.3431 - 107s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 105s - loss: 3.1656 - accuracy200: 0.4346 - val_loss: 3.4900 - val_accuracy200: 0.3419 - 105s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 89s - 89s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098012
{'0': {'precision': 0.3092068005310712, 'recall': 0.19710804246111488, 'f1-score': 0.24074801681958374, 'support': 1335151}, '1': {'precision': 0.3781964121698588, 'recall': 0.7650792852891107, 'f1-score': 0.5061775411913815, 'support': 1631261}, '2': {'precision': 0.31099574065914415, 'recall': 0.03630923801372416, 'f1-score': 0.06502652747447894, 'support': 1341284}, 'accuracy': 0.36212258246635787, 'macro avg': {'precision': 0.3327996511200247, 'recall': 0.3328321885879833, 'f1-score': 0.2706506951618147, 'support': 4307696}, 'weighted avg': {'precision': 0.335889170791703, 'recall': 0.36212258246635787, 'f1-score': 0.28654800113637485, 'support': 4307696}}
[[ 263169 1023929   48053]
 [ 323374 1248044   59843]
 [ 264567 1028016   48701]]
Evaluating performance on  train set...
6697/6697 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044985
{'0': {'precision': 0.3289690298401291, 'recall': 0.2882959263461439, 'f1-score': 0.30729245276750206, 'support': 561437}, '1': {'precision': 0.3386531530368726, 'recall': 0.650476257238751, 'f1-score': 0.44541357925682057, 'support': 584873}, '2': {'precision': 0.35568202568628643, 'recall': 0.061760276204652145, 'f1-score': 0.10524577910723747, 'support': 567695}, 'accuracy': 0.3368525762760319, 'macro avg': {'precision': 0.3411014028544294, 'recall': 0.33351081992984905, 'f1-score': 0.28598393704385333, 'support': 1714005}, 'weighted avg': {'precision': 0.3411211626304846, 'recall': 0.3368525762760319, 'f1-score': 0.2875039639414037, 'support': 1714005}}
[[161860 367339  32238]
 [173152 380446  31275]
 [157010 375624  35061]]
Evaluating performance on  val set...
2631/2631 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.103604
{'0': {'precision': 0.32736971109414553, 'recall': 0.2940316686967113, 'f1-score': 0.3098064007072815, 'support': 221670}, '1': {'precision': 0.34343200003639157, 'recall': 0.6438097999420122, 'f1-score': 0.4479244846438858, 'support': 234532}, '2': {'precision': 0.3554969217238347, 'recall': 0.055966326050234, 'f1-score': 0.09670781893004116, 'support': 216666}, 'accuracy': 0.3392909159002955, 'macro avg': {'precision': 0.34209954428479056, 'recall': 0.3312692648963192, 'f1-score': 0.2848129014270695, 'support': 672868}, 'weighted avg': {'precision': 0.34202538050998205, 'recall': 0.3392909159002955, 'f1-score': 0.2893297145555729, 'support': 672868}}
[[ 65178 145251  11241]
 [ 72795 150994  10743]
 [ 61123 143417  12126]]
testing model out of sample: results/universal/W9/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099292
{'0': {'precision': 0.32539180708731164, 'recall': 0.3184870336300902, 'f1-score': 0.3219023979458799, 'support': 709335}, '1': {'precision': 0.38546925963031164, 'recall': 0.6735037437813028, 'f1-score': 0.4903146513409495, 'support': 835786}, '2': {'precision': 0.31848021741432253, 'recall': 0.02709194327310066, 'f1-score': 0.04993601317091055, 'support': 666139}, 'accuracy': 0.3648897008945126, 'macro avg': {'precision': 0.34311376137731525, 'recall': 0.3396942402281646, 'f1-score': 0.28738435415257996, 'support': 2211260}, 'weighted avg': {'precision': 0.3460170679421765, 'recall': 0.3648897008945126, 'f1-score': 0.30362738190454525, 'support': 2211260}}
[[225914 464837  18584]
 [252846 562905  20035]
 [215523 432569  18047]]
Evaluating performance on  train set...
3947/3947 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1006827
{'0': {'precision': 0.31180719846679816, 'recall': 0.2840515201514396, 'f1-score': 0.29728291607125523, 'support': 312732}, '1': {'precision': 0.37269847336660517, 'recall': 0.6724576945520132, 'f1-score': 0.4795914024260481, 'support': 377020}, '2': {'precision': 0.33750478291206193, 'recall': 0.04688486864732699, 'f1-score': 0.08233243195014481, 'support': 319826}, 'accuracy': 0.3539667068814891, 'macro avg': {'precision': 0.34067015158182173, 'recall': 0.3344646944502599, 'f1-score': 0.2864022501491494, 'support': 1009578}, 'weighted avg': {'precision': 0.3426874118881645, 'recall': 0.3539667068814891, 'f1-score': 0.2972702295734965, 'support': 1009578}}
[[ 88832 210675  13225]
 [107281 253530  16209]
 [ 88781 216050  14995]]
Evaluating performance on  val set...
1402/1402 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980891
{'0': {'precision': 0.31369640658233516, 'recall': 0.20088713652045342, 'f1-score': 0.24492649910684533, 'support': 111595}, '1': {'precision': 0.37923828223693234, 'recall': 0.7761362713016243, 'f1-score': 0.5095154387964165, 'support': 135377}, '2': {'precision': 0.32006172839506175, 'recall': 0.027959018603397143, 'f1-score': 0.05142573766426977, 'support': 111270}, 'accuracy': 0.36455803618782834, 'macro avg': {'precision': 0.33766547240477646, 'recall': 0.334994142141825, 'f1-score': 0.26862255852251055, 'support': 358242}, 'weighted avg': {'precision': 0.3404412658076479, 'recall': 0.36455803618782834, 'f1-score': 0.28481134555879595, 'support': 358242}}
[[ 22418  86058   3119]
 [ 26816 105071   3490]
 [ 22230  85929   3111]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062866
{'0': {'precision': 0.37332682654768545, 'recall': 0.19161269545926218, 'f1-score': 0.2532453713556076, 'support': 27947}, '1': {'precision': 0.28790343292526327, 'recall': 0.7762082814014679, 'f1-score': 0.42001798471299395, 'support': 21663}, '2': {'precision': 0.33790476190476193, 'recall': 0.03442788386896445, 'f1-score': 0.06248899221529466, 'support': 25764}, 'accuracy': 0.30590123915408496, 'macro avg': {'precision': 0.3330450071259035, 'recall': 0.3340829535765648, 'f1-score': 0.24525078276129875, 'support': 75374}, 'weighted avg': {'precision': 0.3366677524703801, 'recall': 0.30590123915408496, 'f1-score': 0.23597347084601591, 'support': 75374}}
[[ 5355 21618   974]
 [ 4084 16815   764]
 [ 4905 19972   887]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082221
{'0': {'precision': 0.334696300204445, 'recall': 0.2971659444899871, 'f1-score': 0.3148165379485747, 'support': 17078}, '1': {'precision': 0.33671564801303155, 'recall': 0.58922738879981, 'f1-score': 0.42854057789487326, 'support': 16839}, '2': {'precision': 0.3532851207878135, 'recall': 0.13339530560074367, 'f1-score': 0.19366538737294928, 'support': 17212}, 'accuracy': 0.33822292632361284, 'macro avg': {'precision': 0.34156568966843004, 'recall': 0.33992954629684696, 'f1-score': 0.31234083440546573, 'support': 51129}, 'weighted avg': {'precision': 0.34161907549106757, 'recall': 0.33822292632361284, 'f1-score': 0.3114866372062965, 'support': 51129}}
[[5075 9697 2306]
 [5020 9922 1897]
 [5068 9848 2296]]
Evaluating performance on  val set...
53/53 - 0s - 486ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978462
{'0': {'precision': 0.3335974643423138, 'recall': 0.19158134243458474, 'f1-score': 0.2433877727995375, 'support': 4395}, '1': {'precision': 0.36569795140543115, 'recall': 0.7748839087421765, 'f1-score': 0.4968928016571724, 'support': 4953}, '2': {'precision': 0.3275488069414317, 'recall': 0.03654404646660213, 'f1-score': 0.06575223165686915, 'support': 4132}, 'accuracy': 0.35838278931750744, 'macro avg': {'precision': 0.34228140756305886, 'recall': 0.3343364325477878, 'f1-score': 0.2686776020378597, 'support': 13480}, 'weighted avg': {'precision': 0.3435381661259321, 'recall': 0.35838278931750744, 'f1-score': 0.2820836446044604, 'support': 13480}}
[[ 842 3419  134]
 [ 939 3838  176]
 [ 743 3238  151]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091226
{'0': {'precision': 0.27711262098806194, 'recall': 0.20289320338939923, 'f1-score': 0.2342649381174483, 'support': 78598}, '1': {'precision': 0.4439162587420563, 'recall': 0.768251762606684, 'f1-score': 0.562693359702537, 'support': 126659}, '2': {'precision': 0.28211667197959833, 'recall': 0.03281829419035847, 'f1-score': 0.05879682430711652, 'support': 80900}, 'accuracy': 0.4050503744447978, 'macro avg': {'precision': 0.3343818505699055, 'recall': 0.33465442006214724, 'f1-score': 0.2852517073757006, 'support': 286157}, 'weighted avg': {'precision': 0.3523580620553728, 'recall': 0.4050503744447978, 'f1-score': 0.3300272121218931, 'support': 286157}}
[[15947 60183  2468]
 [25065 97306  4288]
 [16535 61710  2655]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982487
{'0': {'precision': 0.3058082181504473, 'recall': 0.42036607373034285, 'f1-score': 0.35405109053207545, 'support': 38790}, '1': {'precision': 0.43015369516832863, 'recall': 0.4517096691081748, 'f1-score': 0.4406682286196465, 'support': 54338}, '2': {'precision': 0.3180249535439342, 'recall': 0.16597855302169637, 'f1-score': 0.21811958342436824, 'support': 36089}, 'accuracy': 0.36249874242553226, 'macro avg': {'precision': 0.3513289556209034, 'recall': 0.3460180986200713, 'f1-score': 0.3376129675253634, 'support': 129217}, 'weighted avg': {'precision': 0.3615096683761388, 'recall': 0.36249874242553226, 'f1-score': 0.35251081246798477, 'support': 129217}}
[[16306 16430  6054]
 [23002 24545  6791]
 [14013 16086  5990]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974313
{'0': {'precision': 0.285334813463902, 'recall': 0.5111868740677605, 'f1-score': 0.3662409037708005, 'support': 14079}, '1': {'precision': 0.3951111325394147, 'recall': 0.4064375340971086, 'f1-score': 0.4006943086250734, 'support': 20163}, '2': {'precision': 0.5089237425635479, 'recall': 0.06933903175889765, 'f1-score': 0.12204928664072633, 'support': 13571}, 'accuracy': 0.34160165645326585, 'macro avg': {'precision': 0.39645656285562153, 'recall': 0.32898781330792226, 'f1-score': 0.29632816634553344, 'support': 47813}, 'weighted avg': {'precision': 0.3950904296839856, 'recall': 0.34160165645326585, 'f1-score': 0.31145997737012426, 'support': 47813}}
[[ 7197  6391   491]
 [11551  8195   417]
 [ 6475  6155   941]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1151588
{'0': {'precision': 0.3169377955487393, 'recall': 0.40227567667779013, 'f1-score': 0.35454387631097906, 'support': 43152}, '1': {'precision': 0.3705457752229154, 'recall': 0.5254260837347166, 'f1-score': 0.43459939857112756, 'support': 43184}, '2': {'precision': 0.3988739714161975, 'recall': 0.12696735059623648, 'f1-score': 0.19262073653205988, 'support': 43523}, 'accuracy': 0.35095757706435443, 'macro avg': {'precision': 0.36211918072928406, 'recall': 0.3515563703362477, 'f1-score': 0.32725467047138884, 'support': 129859}, 'weighted avg': {'precision': 0.3622262636297271, 'recall': 0.35095757706435443, 'f1-score': 0.32689648075644956, 'support': 129859}}
[[17359 20013  5780]
 [17946 22690  2548]
 [19466 18531  5526]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1077745
{'0': {'precision': 0.3540106014807027, 'recall': 0.35893221995202984, 'f1-score': 0.3564544231490263, 'support': 22514}, '1': {'precision': 0.3546075865748622, 'recall': 0.6359411309062742, 'f1-score': 0.45532248067073366, 'support': 21947}, '2': {'precision': 0.4064885496183206, 'recall': 0.0854240007129807, 'f1-score': 0.14117906985307654, 'support': 22441}, 'accuracy': 0.3580610445128696, 'macro avg': {'precision': 0.37170224589129514, 'recall': 0.36009911719042825, 'f1-score': 0.31765199122427884, 'support': 66902}, 'weighted avg': {'precision': 0.3718091675328058, 'recall': 0.3580610445128696, 'f1-score': 0.3166777805242094, 'support': 66902}}
[[ 8081 12694  1739]
 [ 6930 13957  1060]
 [ 7816 12708  1917]]
Evaluating performance on  val set...
73/73 - 1s - 593ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090451
{'0': {'precision': 0.36233818230348325, 'recall': 0.41255128399939217, 'f1-score': 0.38581782009379, 'support': 6581}, '1': {'precision': 0.3335485656304769, 'recall': 0.6037735849056604, 'f1-score': 0.42970885323826497, 'support': 5989}, '2': {'precision': 0.365625, 'recall': 0.019230769230769232, 'f1-score': 0.03653966271080575, 'support': 6084}, 'accuracy': 0.3456631285515171, 'macro avg': {'precision': 0.35383724931132, 'recall': 0.3451852127119406, 'f1-score': 0.2840221120142869, 'support': 18654}, 'weighted avg': {'precision': 0.35416706536400505, 'recall': 0.3456631285515171, 'f1-score': 0.285992318216669, 'support': 18654}}
[[2715 3771   95]
 [2265 3616  108]
 [2513 3454  117]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962677
{'0': {'precision': 0.3037646902596109, 'recall': 0.193790240596408, 'f1-score': 0.23662365202099875, 'support': 47216}, '1': {'precision': 0.38956675508399646, 'recall': 0.7659817540606322, 'f1-score': 0.5164664642314906, 'support': 60397}, '2': {'precision': 0.3056910569105691, 'recall': 0.03615461868843351, 'f1-score': 0.06466159666755837, 'support': 46799}, 'accuracy': 0.36982229360412405, 'macro avg': {'precision': 0.3330075007513921, 'recall': 0.3319755377818246, 'f1-score': 0.27258390430668256, 'support': 154412}, 'weighted avg': {'precision': 0.3379093120642414, 'recall': 0.36982229360412405, 'f1-score': 0.2939638464397707, 'support': 154412}}
[[ 9150 36382  1684]
 [11975 46263  2159]
 [ 8997 36110  1692]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.104867
{'0': {'precision': 0.3549241339822502, 'recall': 0.34076619137605224, 'f1-score': 0.3477010990551982, 'support': 29105}, '1': {'precision': 0.3289798799858807, 'recall': 0.6194291622050733, 'f1-score': 0.429729625882142, 'support': 27083}, '2': {'precision': 0.33784149310251554, 'recall': 0.047226528528755626, 'f1-score': 0.08286889596602973, 'support': 26447}, 'accuracy': 0.3381496944394022, 'macro avg': {'precision': 0.3405818356902155, 'recall': 0.335807294036627, 'f1-score': 0.2867665403011233, 'support': 82635}, 'weighted avg': {'precision': 0.3409538691510041, 'recall': 0.3381496944394022, 'f1-score': 0.2898268486401789, 'support': 82635}}
[[ 9918 17962  1225]
 [ 9084 16776  1223]
 [ 8942 16256  1249]]
Evaluating performance on  val set...
112/112 - 1s - 792ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1094921
{'0': {'precision': 0.3687089715536105, 'recall': 0.2673542245140817, 'f1-score': 0.3099563117958151, 'support': 10084}, '1': {'precision': 0.2930809769365898, 'recall': 0.6112030252895296, 'f1-score': 0.3961852234861542, 'support': 8462}, '2': {'precision': 0.3189531205061835, 'recall': 0.1121334681496461, 'f1-score': 0.16593102416398595, 'support': 9890}, 'accuracy': 0.31569137712758477, 'macro avg': {'precision': 0.32691435633212795, 'recall': 0.33023023931775247, 'f1-score': 0.2906908531486518, 'support': 28436}, 'weighted avg': {'precision': 0.3288985390979809, 'recall': 0.31569137712758477, 'f1-score': 0.28552456879556404, 'support': 28436}}
[[2696 6172 1216]
 [2138 5172 1152]
 [2478 6303 1109]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221238
{'0': {'precision': 0.38978938674375385, 'recall': 0.7034437785299507, 'f1-score': 0.5016220285875618, 'support': 64406}, '1': {'precision': 0.22240527182866557, 'recall': 0.2576070139247035, 'f1-score': 0.23871538149059715, 'support': 38780}, '2': {'precision': 0.34177215189873417, 'recall': 0.0009290802105915144, 'f1-score': 0.0018531228551818806, 'support': 58122}, 'accuracy': 0.3431323926897612, 'macro avg': {'precision': 0.31798893682371787, 'recall': 0.32065995755508186, 'f1-score': 0.2473968443111136, 'support': 161308}, 'weighted avg': {'precision': 0.3322472084260675, 'recall': 0.3431323926897612, 'f1-score': 0.25834154582540697, 'support': 161308}}
[[45306 19032    68]
 [28754  9990    36]
 [42172 15896    54]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1084856
{'0': {'precision': 0.32612133031149526, 'recall': 0.30809639994024796, 'f1-score': 0.3168527242933224, 'support': 40166}, '1': {'precision': 0.32537198499639813, 'recall': 0.6517639448673932, 'f1-score': 0.4340557378135666, 'support': 40194}, '2': {'precision': 0.34197637568424083, 'recall': 0.02855355897139833, 'f1-score': 0.05270636295013542, 'support': 41571}, 'accuracy': 0.3260778637098031, 'macro avg': {'precision': 0.3311565636640448, 'recall': 0.3294713012596798, 'f1-score': 0.2678716083523415, 'support': 121931}, 'weighted avg': {'precision': 0.33127991103006066, 'recall': 0.3260778637098031, 'f1-score': 0.26543044069058863, 'support': 121931}}
[[12375 26615  1176]
 [12889 26197  1108]
 [12682 27702  1187]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017495
{'0': {'precision': 0.3216692586832556, 'recall': 0.1593374847531617, 'f1-score': 0.21311123513501912, 'support': 15577}, '1': {'precision': 0.3483064904489272, 'recall': 0.795199120449548, 'f1-score': 0.4844279069767442, 'support': 16372}, '2': {'precision': 0.3312745648512072, 'recall': 0.03952833980972799, 'f1-score': 0.07062907763213024, 'support': 14926}, 'accuracy': 0.3432746666666667, 'macro avg': {'precision': 0.33375010466113, 'recall': 0.33135498167081257, 'f1-score': 0.25605607324796453, 'support': 46875}, 'weighted avg': {'precision': 0.3340313612609712, 'recall': 0.3432746666666667, 'f1-score': 0.2625044696631173, 'support': 46875}}
[[ 2482 12446   649]
 [ 2811 13019   542]
 [ 2423 11913   590]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983323
{'0': {'precision': 0.3129471732301466, 'recall': 0.19484627388132092, 'f1-score': 0.2401629677281012, 'support': 189688}, '1': {'precision': 0.3732433177183797, 'recall': 0.7836936880802542, 'f1-score': 0.5056600847720458, 'support': 224686}, '2': {'precision': 0.30402110480454075, 'recall': 0.0202278626441428, 'f1-score': 0.03793194591979732, 'support': 188008}, 'accuracy': 0.35998419607491594, 'macro avg': {'precision': 0.33007053191768904, 'recall': 0.33292260820190595, 'f1-score': 0.26125166613998146, 'support': 602382}, 'weighted avg': {'precision': 0.33265149249586473, 'recall': 0.35998419607491594, 'f1-score': 0.27607445793199203, 'support': 602382}}
[[ 36960 148741   3987]
 [ 43882 176085   4719]
 [ 37261 146944   3803]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028924
{'0': {'precision': 0.32860304164438897, 'recall': 0.4344466698083569, 'f1-score': 0.37418400135295105, 'support': 101856}, '1': {'precision': 0.35287199590932333, 'recall': 0.5432955151812034, 'f1-score': 0.4278525397049554, 'support': 114319}, '2': {'precision': 0.40116971731831474, 'recall': 0.03570739983804419, 'f1-score': 0.06557783384234055, 'support': 103732}, 'accuracy': 0.34404998952820665, 'macro avg': {'precision': 0.36088158495734235, 'recall': 0.3378165282758682, 'f1-score': 0.28920479163341567, 'support': 319907}, 'weighted avg': {'precision': 0.36080580364591036, 'recall': 0.34404998952820665, 'f1-score': 0.29329486378375796, 'support': 319907}}
[[44251 55318  2287]
 [48968 62109  3242]
 [41445 58583  3704]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10466
{'0': {'precision': 0.3211780516585814, 'recall': 0.4885326818567084, 'f1-score': 0.38756056560862256, 'support': 40114}, '1': {'precision': 0.36748931431472415, 'recall': 0.4772234273318872, 'f1-score': 0.41522875514641255, 'support': 47022}, '2': {'precision': 0.4281938325991189, 'recall': 0.04923638021426943, 'f1-score': 0.0883174704131931, 'support': 39483}, 'accuracy': 0.3473491340162219, 'macro avg': {'precision': 0.37228706619080815, 'recall': 0.338330829800955, 'f1-score': 0.2970355970560761, 'support': 126619}, 'weighted avg': {'precision': 0.37174670463714216, 'recall': 0.3473491340162219, 'f1-score': 0.30452404250264964, 'support': 126619}}
[[19597 19262  1255]
 [23241 22440  1341]
 [18178 19361  1944]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961672
{'0': {'precision': 0.3157767241041498, 'recall': 0.2867021586270692, 'f1-score': 0.30053789780789264, 'support': 309178}, '1': {'precision': 0.3942802084830424, 'recall': 0.6874560513039498, 'f1-score': 0.5011393725202921, 'support': 391081}, '2': {'precision': 0.28823508484826926, 'recall': 0.027895702712101338, 'f1-score': 0.05086831497921821, 'support': 290439}, 'accuracy': 0.36902769562470095, 'macro avg': {'precision': 0.3327640058118205, 'recall': 0.3340179708810402, 'f1-score': 0.2841818617691343, 'support': 990698}, 'weighted avg': {'precision': 0.33869193641965156, 'recall': 0.36902769562470095, 'f1-score': 0.306531289704134, 'support': 990698}}
[[ 88642 212690   7846]
 [110069 268851  12161]
 [ 82000 200337   8102]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934646
{'0': {'precision': 0.2939502957867325, 'recall': 0.3413687614718993, 'f1-score': 0.3158899367508371, 'support': 114410}, '1': {'precision': 0.4383163255157049, 'recall': 0.626029195338292, 'f1-score': 0.5156198080226142, 'support': 175987}, '2': {'precision': 0.30810306392244285, 'recall': 0.052540379974008296, 'f1-score': 0.08977205782389995, 'support': 113113}, 'accuracy': 0.3845555252657927, 'macro avg': {'precision': 0.3467898950749601, 'recall': 0.3399794455947332, 'f1-score': 0.30709393419911707, 'support': 403510}, 'weighted avg': {'precision': 0.36088149088982113, 'recall': 0.3845555252657927, 'f1-score': 0.33961422912635086, 'support': 403510}}
[[ 39056  70628   4726]
 [ 57194 110173   8620]
 [ 36616  70554   5943]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904298
{'0': {'precision': 0.2742312834224599, 'recall': 0.1946019021416882, 'f1-score': 0.22765423192708406, 'support': 42163}, '1': {'precision': 0.44183856315372755, 'recall': 0.7803980451039274, 'f1-score': 0.5642278239861215, 'support': 67932}, '2': {'precision': 0.2874471086036671, 'recall': 0.02350363279898512, 'f1-score': 0.04345415778251599, 'support': 43355}, 'accuracy': 0.40559139784946235, 'macro avg': {'precision': 0.3345056517266182, 'recall': 0.3328345266815336, 'f1-score': 0.27844540456524053, 'support': 153450}, 'weighted avg': {'precision': 0.35216461563122964, 'recall': 0.40559139784946235, 'f1-score': 0.32461169716798854, 'support': 153450}}
[[ 8205 32923  1035]
 [13427 53014  1491]
 [ 8288 34048  1019]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1006124
{'0': {'precision': 0.33206392863124673, 'recall': 0.18127962655501817, 'f1-score': 0.23452685581227392, 'support': 207795}, '1': {'precision': 0.34734585954088376, 'recall': 0.7967267497691173, 'f1-score': 0.4837800249141049, 'support': 217643}, '2': {'precision': 0.3161694592017436, 'recall': 0.02299123836693858, 'f1-score': 0.04286538772306485, 'support': 201903}, 'accuracy': 0.3438528647099424, 'macro avg': {'precision': 0.3318597491246247, 'recall': 0.3336658715636913, 'f1-score': 0.2537240894831479, 'support': 627341}, 'weighted avg': {'precision': 0.33225021364647955, 'recall': 0.3438528647099424, 'f1-score': 0.2593158973243291, 'support': 627341}}
[[ 37669 165190   4936]
 [ 39137 173402   5104]
 [ 36633 160628   4642]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1103063
{'0': {'precision': 0.3348285091197462, 'recall': 0.38982659626648203, 'f1-score': 0.3602404980602845, 'support': 103977}, '1': {'precision': 0.3313554218905405, 'recall': 0.4866255961844197, 'f1-score': 0.3942537202291105, 'support': 100640}, '2': {'precision': 0.3762062923346497, 'recall': 0.14037570139058306, 'f1-score': 0.2044601739723691, 'support': 102475}, 'accuracy': 0.33830904093887176, 'macro avg': {'precision': 0.3474634077816455, 'recall': 0.3389426312804949, 'f1-score': 0.3196514640872547, 'support': 307092}, 'weighted avg': {'precision': 0.34749786174436675, 'recall': 0.33830904093887176, 'f1-score': 0.31940420785461815, 'support': 307092}}
[[40533 50373 13071]
 [40885 48974 10781]
 [39638 48452 14385]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097945
{'0': {'precision': 0.33145665110995876, 'recall': 0.34897566555740434, 'f1-score': 0.33999062828484944, 'support': 38464}, '1': {'precision': 0.32422989281795933, 'recall': 0.5085917021896265, 'f1-score': 0.39600470035252644, 'support': 37769}, '2': {'precision': 0.333128078817734, 'recall': 0.1185720939152352, 'f1-score': 0.1748934192714121, 'support': 36501}, 'accuracy': 0.3278514024163074, 'macro avg': {'precision': 0.32960487424855067, 'recall': 0.32537982055408865, 'f1-score': 0.30362958263626266, 'support': 112734}, 'weighted avg': {'precision': 0.3295766623650458, 'recall': 0.3278514024163074, 'f1-score': 0.3053017346212219, 'support': 112734}}
[[13423 20614  4427]
 [14323 19209  4237]
 [12751 19422  4328]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
3337/3337 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954933
{'0': {'precision': 0.30374801022623127, 'recall': 0.2617286096458746, 'f1-score': 0.2811771224677436, 'support': 264652}, '1': {'precision': 0.39823189114315977, 'recall': 0.7164783421973859, 'f1-score': 0.5119259097879186, 'support': 341078}, '2': {'precision': 0.2833738848337389, 'recall': 0.014072197542399845, 'f1-score': 0.026812881540627963, 'support': 248291}, 'accuracy': 0.3713444985544852, 'macro avg': {'precision': 0.32845126206770997, 'recall': 0.3307597164618868, 'f1-score': 0.2733053045987634, 'support': 854021}, 'weighted avg': {'precision': 0.3355594775877561, 'recall': 0.3713444985544852, 'f1-score': 0.2993815731048547, 'support': 854021}}
[[ 69267 191460   3925]
 [ 91792 244375   4911]
 [ 66982 177815   3494]]
Evaluating performance on  train set...
1431/1431 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038275
{'0': {'precision': 0.32289935364727607, 'recall': 0.20646233257987248, 'f1-score': 0.2518752508051489, 'support': 118564}, '1': {'precision': 0.3332772272618208, 'recall': 0.7624720408347193, 'f1-score': 0.46381882248570844, 'support': 122053}, '2': {'precision': 0.33300189821928955, 'recall': 0.029357154810381786, 'f1-score': 0.05395746675259242, 'support': 125489}, 'accuracy': 0.331119948867268, 'macro avg': {'precision': 0.3297261597094621, 'recall': 0.3327638427416579, 'f1-score': 0.2565505133478166, 'support': 366106}, 'weighted avg': {'precision': 0.32982196301197764, 'recall': 0.331119948867268, 'f1-score': 0.25469368030741346, 'support': 366106}}
[[24479 90581  3504]
 [25116 93062  3875]
 [26215 95590  3684]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041842
{'0': {'precision': 0.3402268178785857, 'recall': 0.1903029454977961, 'f1-score': 0.24408118092218414, 'support': 42879}, '1': {'precision': 0.3189594705864414, 'recall': 0.7818643941092921, 'f1-score': 0.45308438745451396, 'support': 40131}, '2': {'precision': 0.3426736719206071, 'recall': 0.027447221377972085, 'f1-score': 0.05082361090066885, 'support': 42773}, 'accuracy': 0.3236605900638401, 'macro avg': {'precision': 0.33395332012854473, 'recall': 0.3332048536616868, 'f1-score': 0.249329726425789, 'support': 125783}, 'weighted avg': {'precision': 0.3342735441751309, 'recall': 0.3236605900638401, 'f1-score': 0.24504555320475535, 'support': 125783}}
[[ 8160 33566  1153]
 [ 7655 31377  1099]
 [ 8169 33430  1174]]
testing model on single stock: results/universal/W9/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
10303/10303 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981354
{'0': {'precision': 0.307224157694393, 'recall': 0.2017111451073715, 'f1-score': 0.24353011595787, 'support': 811854}, '1': {'precision': 0.3790290957571955, 'recall': 0.7525362420099893, 'f1-score': 0.504139039635818, 'support': 1001876}, '2': {'precision': 0.3137471032920489, 'recall': 0.04388750889308149, 'f1-score': 0.07700361383802806, 'support': 823674}, 'accuracy': 0.36166510705223776, 'macro avg': {'precision': 0.3333334522478791, 'recall': 0.33271163200348075, 'f1-score': 0.27489092314390534, 'support': 2637404}, 'weighted avg': {'precision': 0.3365379923662188, 'recall': 0.36166510705223776, 'f1-score': 0.29052112526539703, 'support': 2637404}}
[[163760 613050  35044]
 [203904 753948  44024]
 [165367 622158  36149]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039923
{'0': {'precision': 0.32331840879472523, 'recall': 0.17418641752604194, 'f1-score': 0.22640051862275842, 'support': 287709}, '1': {'precision': 0.32889665323987166, 'recall': 0.7876690248983511, 'f1-score': 0.4640330814784562, 'support': 288493}, '2': {'precision': 0.3476833646777227, 'recall': 0.03401214910754904, 'f1-score': 0.06196278454708606, 'support': 298952}, 'accuracy': 0.32853646329674546, 'macro avg': {'precision': 0.3332994755707732, 'recall': 0.3319558638439807, 'f1-score': 0.25079879488276685, 'support': 875154}, 'weighted avg': {'precision': 0.3334803194594168, 'recall': 0.32853646329674546, 'f1-score': 0.248563865277791, 'support': 875154}}
[[ 50115 228005   9589]
 [ 51768 227237   9488]
 [ 53119 235665  10168]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017576
{'0': {'precision': 0.3331956997140279, 'recall': 0.18320174221594396, 'f1-score': 0.23641493055555554, 'support': 118929}, '1': {'precision': 0.3400160613902026, 'recall': 0.7865517355262723, 'f1-score': 0.47478762294693877, 'support': 121116}, '2': {'precision': 0.3294017094017094, 'recall': 0.03287806792298308, 'f1-score': 0.05978855267954794, 'support': 117221}, 'accuracy': 0.33842011274512546, 'macro avg': {'precision': 0.3342044901686467, 'recall': 0.3342105152217331, 'f1-score': 0.2569970353940141, 'support': 357266}, 'weighted avg': {'precision': 0.3342630265415773, 'recall': 0.33842011274512546, 'f1-score': 0.25927304291629316, 'support': 357266}}
[[21788 93191  3950]
 [21956 95264  3896]
 [21647 91720  3854]]
training model: results/universal/W9/deepOF_L1/h50
Epoch 1/50
6697/6697 - 101s - loss: 3.0406 - accuracy50: 0.4779 - val_loss: 3.3425 - val_accuracy50: 0.3443 - 101s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 98s - loss: 3.0305 - accuracy50: 0.4760 - val_loss: 3.3647 - val_accuracy50: 0.3452 - 98s/epoch - 15ms/step
Epoch 3/50
6697/6697 - 95s - loss: 3.0212 - accuracy50: 0.4777 - val_loss: 3.3404 - val_accuracy50: 0.3482 - 95s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 95s - loss: 3.0133 - accuracy50: 0.4796 - val_loss: 3.3545 - val_accuracy50: 0.3485 - 95s/epoch - 14ms/step
Epoch 5/50
6697/6697 - 94s - loss: 3.0070 - accuracy50: 0.4810 - val_loss: 3.3539 - val_accuracy50: 0.3481 - 94s/epoch - 14ms/step
Epoch 6/50
6697/6697 - 94s - loss: 3.0005 - accuracy50: 0.4827 - val_loss: 3.3568 - val_accuracy50: 0.3476 - 94s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 93s - loss: 2.9954 - accuracy50: 0.4849 - val_loss: 3.3452 - val_accuracy50: 0.3487 - 93s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 95s - loss: 2.9910 - accuracy50: 0.4856 - val_loss: 3.3439 - val_accuracy50: 0.3494 - 95s/epoch - 14ms/step
Epoch 9/50
6697/6697 - 96s - loss: 2.9865 - accuracy50: 0.4870 - val_loss: 3.3490 - val_accuracy50: 0.3502 - 96s/epoch - 14ms/step
Epoch 10/50
6697/6697 - 97s - loss: 2.9833 - accuracy50: 0.4870 - val_loss: 3.3446 - val_accuracy50: 0.3505 - 97s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 95s - loss: 2.9792 - accuracy50: 0.4874 - val_loss: 3.3450 - val_accuracy50: 0.3505 - 95s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 95s - loss: 2.9760 - accuracy50: 0.4884 - val_loss: 3.3401 - val_accuracy50: 0.3510 - 95s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 95s - loss: 2.9733 - accuracy50: 0.4891 - val_loss: 3.3284 - val_accuracy50: 0.3512 - 95s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 97s - loss: 2.9721 - accuracy50: 0.4898 - val_loss: 3.3157 - val_accuracy50: 0.3517 - 97s/epoch - 14ms/step
Epoch 15/50
6697/6697 - 97s - loss: 2.9701 - accuracy50: 0.4905 - val_loss: 3.3042 - val_accuracy50: 0.3523 - 97s/epoch - 14ms/step
Epoch 16/50
6697/6697 - 96s - loss: 2.9651 - accuracy50: 0.4925 - val_loss: 3.3083 - val_accuracy50: 0.3525 - 96s/epoch - 14ms/step
Epoch 17/50
6697/6697 - 97s - loss: 2.9607 - accuracy50: 0.4936 - val_loss: 3.3034 - val_accuracy50: 0.3530 - 97s/epoch - 15ms/step
Epoch 18/50
6697/6697 - 95s - loss: 2.9562 - accuracy50: 0.4950 - val_loss: 3.3027 - val_accuracy50: 0.3534 - 95s/epoch - 14ms/step
Epoch 19/50
6697/6697 - 96s - loss: 2.9528 - accuracy50: 0.4958 - val_loss: 3.2978 - val_accuracy50: 0.3541 - 96s/epoch - 14ms/step
Epoch 20/50
6697/6697 - 96s - loss: 2.9491 - accuracy50: 0.4966 - val_loss: 3.2926 - val_accuracy50: 0.3554 - 96s/epoch - 14ms/step
Epoch 21/50
6697/6697 - 96s - loss: 2.9458 - accuracy50: 0.4978 - val_loss: 3.2926 - val_accuracy50: 0.3553 - 96s/epoch - 14ms/step
Epoch 22/50
6697/6697 - 98s - loss: 2.9416 - accuracy50: 0.4988 - val_loss: 3.2880 - val_accuracy50: 0.3566 - 98s/epoch - 15ms/step
Epoch 23/50
6697/6697 - 97s - loss: 2.9395 - accuracy50: 0.4993 - val_loss: 3.2847 - val_accuracy50: 0.3582 - 97s/epoch - 14ms/step
Epoch 24/50
6697/6697 - 98s - loss: 2.9361 - accuracy50: 0.5000 - val_loss: 3.2816 - val_accuracy50: 0.3581 - 98s/epoch - 15ms/step
Epoch 25/50
6697/6697 - 96s - loss: 2.9337 - accuracy50: 0.5008 - val_loss: 3.2790 - val_accuracy50: 0.3592 - 96s/epoch - 14ms/step
Epoch 26/50
6697/6697 - 97s - loss: 2.9303 - accuracy50: 0.5014 - val_loss: 3.2779 - val_accuracy50: 0.3596 - 97s/epoch - 15ms/step
Epoch 27/50
6697/6697 - 100s - loss: 2.9284 - accuracy50: 0.5021 - val_loss: 3.2732 - val_accuracy50: 0.3612 - 100s/epoch - 15ms/step
Epoch 28/50
6697/6697 - 95s - loss: 2.9257 - accuracy50: 0.5026 - val_loss: 3.2693 - val_accuracy50: 0.3623 - 95s/epoch - 14ms/step
Epoch 29/50
6697/6697 - 95s - loss: 2.9225 - accuracy50: 0.5037 - val_loss: 3.2752 - val_accuracy50: 0.3619 - 95s/epoch - 14ms/step
Epoch 30/50
6697/6697 - 95s - loss: 2.9200 - accuracy50: 0.5040 - val_loss: 3.2691 - val_accuracy50: 0.3637 - 95s/epoch - 14ms/step
Epoch 31/50
6697/6697 - 94s - loss: 2.9181 - accuracy50: 0.5047 - val_loss: 3.2578 - val_accuracy50: 0.3672 - 94s/epoch - 14ms/step
Epoch 32/50
6697/6697 - 95s - loss: 2.9155 - accuracy50: 0.5053 - val_loss: 3.2631 - val_accuracy50: 0.3668 - 95s/epoch - 14ms/step
Epoch 33/50
6697/6697 - 96s - loss: 2.9132 - accuracy50: 0.5061 - val_loss: 3.2673 - val_accuracy50: 0.3664 - 96s/epoch - 14ms/step
Epoch 34/50
6697/6697 - 98s - loss: 2.9109 - accuracy50: 0.5070 - val_loss: 3.2575 - val_accuracy50: 0.3687 - 98s/epoch - 15ms/step
Epoch 35/50
6697/6697 - 97s - loss: 2.9087 - accuracy50: 0.5069 - val_loss: 3.2637 - val_accuracy50: 0.3676 - 97s/epoch - 14ms/step
Epoch 36/50
6697/6697 - 96s - loss: 2.9065 - accuracy50: 0.5078 - val_loss: 3.2608 - val_accuracy50: 0.3691 - 96s/epoch - 14ms/step
Epoch 37/50
6697/6697 - 98s - loss: 2.9052 - accuracy50: 0.5078 - val_loss: 3.2583 - val_accuracy50: 0.3700 - 98s/epoch - 15ms/step
Epoch 38/50
6697/6697 - 96s - loss: 2.9026 - accuracy50: 0.5083 - val_loss: 3.2573 - val_accuracy50: 0.3706 - 96s/epoch - 14ms/step
Epoch 39/50
6697/6697 - 104s - loss: 2.9011 - accuracy50: 0.5090 - val_loss: 3.2568 - val_accuracy50: 0.3718 - 104s/epoch - 16ms/step
Epoch 40/50
6697/6697 - 96s - loss: 2.8989 - accuracy50: 0.5096 - val_loss: 3.2528 - val_accuracy50: 0.3726 - 96s/epoch - 14ms/step
Epoch 41/50
6697/6697 - 96s - loss: 2.8970 - accuracy50: 0.5102 - val_loss: 3.2550 - val_accuracy50: 0.3736 - 96s/epoch - 14ms/step
Epoch 42/50
6697/6697 - 98s - loss: 2.8953 - accuracy50: 0.5108 - val_loss: 3.2534 - val_accuracy50: 0.3749 - 98s/epoch - 15ms/step
Epoch 43/50
6697/6697 - 97s - loss: 2.8933 - accuracy50: 0.5112 - val_loss: 3.2509 - val_accuracy50: 0.3748 - 97s/epoch - 14ms/step
Epoch 44/50
6697/6697 - 99s - loss: 2.8913 - accuracy50: 0.5113 - val_loss: 3.2575 - val_accuracy50: 0.3750 - 99s/epoch - 15ms/step
Epoch 45/50
6697/6697 - 94s - loss: 2.8893 - accuracy50: 0.5118 - val_loss: 3.2600 - val_accuracy50: 0.3734 - 94s/epoch - 14ms/step
Epoch 46/50
6697/6697 - 101s - loss: 2.8874 - accuracy50: 0.5125 - val_loss: 3.2620 - val_accuracy50: 0.3742 - 101s/epoch - 15ms/step
Epoch 47/50
6697/6697 - 99s - loss: 2.8858 - accuracy50: 0.5128 - val_loss: 3.2611 - val_accuracy50: 0.3732 - 99s/epoch - 15ms/step
Epoch 48/50
6697/6697 - 94s - loss: 2.8842 - accuracy50: 0.5130 - val_loss: 3.2640 - val_accuracy50: 0.3739 - 94s/epoch - 14ms/step
Epoch 49/50
6697/6697 - 100s - loss: 2.8820 - accuracy50: 0.5134 - val_loss: 3.2603 - val_accuracy50: 0.3744 - 100s/epoch - 15ms/step
Epoch 50/50
6697/6697 - 99s - loss: 2.8803 - accuracy50: 0.5138 - val_loss: 3.2666 - val_accuracy50: 0.3732 - 99s/epoch - 15ms/step
testing model in sample: results/universal/W9/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 91s - 91s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.147531
{'0': {'precision': 0.3473526584146479, 'recall': 0.5529708695637848, 'f1-score': 0.4266819550970156, 'support': 1213988}, '1': {'precision': 0.5809652249301609, 'recall': 0.07389014039941681, 'f1-score': 0.1311055976938163, 'support': 1877287}, '2': {'precision': 0.34347456694885303, 'recall': 0.6032245945210503, 'f1-score': 0.4377151999465505, 'support': 1216401}, 'accuracy': 0.3583779281450137, 'macro avg': {'precision': 0.42393081676455396, 'recall': 0.41002853482808393, 'f1-score': 0.3318342509124608, 'support': 4307676}, 'weighted avg': {'precision': 0.4480660175018038, 'recall': 0.3583779281450137, 'f1-score': 0.3009852213612006, 'support': 4307676}}
[[671300  48171 494517]
 [830559 138713 908015]
 [430759  51879 733763]]
Evaluating performance on  train set...
6697/6697 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.118913
{'0': {'precision': 0.3640229535920401, 'recall': 0.5416930503777876, 'f1-score': 0.43543164363776216, 'support': 491149}, '1': {'precision': 0.602393649303673, 'recall': 0.10317671517671517, 'f1-score': 0.17617802874767624, 'support': 721500}, '2': {'precision': 0.36627398331231475, 'recall': 0.627970479704797, 'f1-score': 0.46268147836808715, 'support': 501350}, 'accuracy': 0.3823380293687453, 'macro avg': {'precision': 0.44423019540267594, 'recall': 0.4242800817531, 'f1-score': 0.35809705025117516, 'support': 1713999}, 'weighted avg': {'precision': 0.4650224353339797, 'recall': 0.3823380293687453, 'f1-score': 0.33427068700876256, 'support': 1713999}}
[[266052  24317 200780]
 [303115  74442 343943]
 [161699  24818 314833]]
Evaluating performance on  val set...
2631/2631 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1270524
{'0': {'precision': 0.3565427923339174, 'recall': 0.5443944979338736, 'f1-score': 0.43088445005283516, 'support': 192873}, '1': {'precision': 0.5941240043229395, 'recall': 0.10247930460718453, 'f1-score': 0.1748065621650905, 'support': 289678}, '2': {'precision': 0.358478960558088, 'recall': 0.6185934823502213, 'f1-score': 0.45391260427088936, 'support': 190314}, 'accuracy': 0.3751302267170978, 'macro avg': {'precision': 0.4363819190716483, 'recall': 0.4218224282970932, 'f1-score': 0.35320120549627165, 'support': 672865}, 'weighted avg': {'precision': 0.45937252823334856, 'recall': 0.3751302267170978, 'f1-score': 0.32715257179242435, 'support': 672865}}
[[104999  10243  77631]
 [126943  29686 133049]
 [ 62550  10037 117727]]
testing model out of sample: results/universal/W9/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 44s - 44s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.146457
{'0': {'precision': 0.33860948731404306, 'recall': 0.5889630456432563, 'f1-score': 0.43000082008974494, 'support': 565319}, '1': {'precision': 0.6694443930050679, 'recall': 0.09893053006447469, 'f1-score': 0.17238586700385533, 'support': 1096244}, '2': {'precision': 0.32086177054163206, 'recall': 0.6222217775166143, 'f1-score': 0.42339235291423366, 'support': 549677}, 'accuracy': 0.35429216186393153, 'macro avg': {'precision': 0.44297188362024764, 'recall': 0.4367051177414485, 'f1-score': 0.34192634666927796, 'support': 2211240}, 'weighted avg': {'precision': 0.4982123656275881, 'recall': 0.35429216186393153, 'f1-score': 0.3006429172649401, 'support': 2211240}}
[[332952  27285 205082]
 [468950 108452 518842]
 [181390  26266 342021]]
Evaluating performance on  train set...
3947/3947 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1455698
{'0': {'precision': 0.3333143735957944, 'recall': 0.5874906494127445, 'f1-score': 0.42532148046412105, 'support': 259342}, '1': {'precision': 0.6479680972274972, 'recall': 0.10461629653854408, 'f1-score': 0.18014729821288727, 'support': 489245}, '2': {'precision': 0.3286192512804266, 'recall': 0.5961714568158567, 'f1-score': 0.42369244426532615, 'support': 260987}, 'accuracy': 0.35573122921152883, 'macro avg': {'precision': 0.436633907367906, 'recall': 0.42942613425571513, 'f1-score': 0.3430537409807782, 'support': 1009574}, 'weighted avg': {'precision': 0.4845835179383305, 'recall': 0.35573122921152883, 'f1-score': 0.3060876253272814, 'support': 1009574}}
[[152361  13463  93518]
 [213698  51183 224364]
 [ 91050  14344 155593]]
Evaluating performance on  val set...
1402/1402 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.149595
{'0': {'precision': 0.3378516957843119, 'recall': 0.5865406402744958, 'f1-score': 0.4287438184700565, 'support': 92679}, '1': {'precision': 0.6598656279625736, 'recall': 0.09268490374873353, 'f1-score': 0.16253946981003728, 'support': 172725}, '2': {'precision': 0.3273149565810228, 'recall': 0.6102308346887556, 'f1-score': 0.42608623711068827, 'support': 92837}, 'accuracy': 0.3545685725531137, 'macro avg': {'precision': 0.4416774267759694, 'recall': 0.42981879290399494, 'f1-score': 0.33912317513026063, 'support': 358241}, 'weighted avg': {'precision': 0.4903793438705848, 'recall': 0.3545685725531137, 'f1-score': 0.29970535552761973, 'support': 358241}}
[[54360  4061 34258]
 [74545 16009 82171]
 [31994  4191 56652]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1140118
{'0': {'precision': 0.3683597917811762, 'recall': 0.4637899450437615, 'f1-score': 0.4106029480664576, 'support': 24565}, '1': {'precision': 0.5008690614136733, 'recall': 0.0734588095339253, 'f1-score': 0.12812627366704957, 'support': 23537}, '2': {'precision': 0.4119641855131865, 'recall': 0.6192606718497873, 'f1-score': 0.49477709245938145, 'support': 27268}, 'accuracy': 0.39814249701472737, 'macro avg': {'precision': 0.42706434623601197, 'recall': 0.3855031421424913, 'f1-score': 0.3445021047309629, 'support': 75370}, 'weighted avg': {'precision': 0.42551615754506816, 'recall': 0.39814249701472737, 'f1-score': 0.35284265994077607, 'support': 75370}}
[[11393   992 12180]
 [ 9885  1729 11923]
 [ 9651   731 16886]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1295469
{'0': {'precision': 0.3706919117005497, 'recall': 0.4888952819332566, 'f1-score': 0.42166641854002285, 'support': 17380}, '1': {'precision': 0.3568953568953569, 'recall': 0.06138259833134684, 'f1-score': 0.10474931353605207, 'support': 16780}, '2': {'precision': 0.3729114824031283, 'recall': 0.556498673740053, 'f1-score': 0.4465730097914006, 'support': 16965}, 'accuracy': 0.3710122249388753, 'macro avg': {'precision': 0.3668329169996783, 'recall': 0.3689255180015521, 'f1-score': 0.32432958062249184, 'support': 51125}, 'weighted avg': {'precision': 0.366900201721833, 'recall': 0.3710122249388753, 'f1-score': 0.3259142679016462, 'support': 51125}}
[[8497  954 7929]
 [7803 1030 7947]
 [6622  902 9441]]
Evaluating performance on  val set...
53/53 - 1s - 501ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1349703
{'0': {'precision': 0.36284525160802117, 'recall': 0.43740022805017104, 'f1-score': 0.39664977768586496, 'support': 4385}, '1': {'precision': 0.47503045066991473, 'recall': 0.08123307644240783, 'f1-score': 0.13874066168623267, 'support': 4801}, '2': {'precision': 0.3474840634748406, 'recall': 0.5966464834653005, 'f1-score': 0.43918745178709184, 'support': 4294}, 'accuracy': 0.3612759643916914, 'macro avg': {'precision': 0.3951199219175922, 'recall': 0.3717599293192931, 'f1-score': 0.32485929705306316, 'support': 13480}, 'weighted avg': {'precision': 0.3979075808997328, 'recall': 0.3612759643916914, 'f1-score': 0.3183437766974698, 'support': 13480}}
[[1918  206 2261]
 [1861  390 2550]
 [1507  225 2562]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.178599
{'0': {'precision': 0.21848075985230256, 'recall': 0.7098770089790991, 'f1-score': 0.3341265049543631, 'support': 39759}, '1': {'precision': 0.8047687728235186, 'recall': 0.12803050274856714, 'f1-score': 0.22091558876426265, 'support': 204834}, '2': {'precision': 0.2296616097055064, 'recall': 0.6873435996150145, 'f1-score': 0.3442868936924125, 'support': 41560}, 'accuracy': 0.29010704063909865, 'macro avg': {'precision': 0.4176370474604425, 'recall': 0.5084170371142269, 'f1-score': 0.29977632913701274, 'support': 286153}, 'weighted avg': {'precision': 0.6397812353631139, 'recall': 0.29010704063909865, 'f1-score': 0.25456354719774443, 'support': 286153}}
[[28224  2706  8829]
 [91621 26225 86988]
 [ 9338  3656 28566]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1662409
{'0': {'precision': 0.2508084038662025, 'recall': 0.695852534562212, 'f1-score': 0.3687184216336974, 'support': 20398}, '1': {'precision': 0.8350573783740101, 'recall': 0.11630367493950138, 'f1-score': 0.20417115363716298, 'support': 88845}, '2': {'precision': 0.24287136929460582, 'recall': 0.7326023830980274, 'f1-score': 0.36480355005983245, 'support': 19974}, 'accuracy': 0.3030560994296416, 'macro avg': {'precision': 0.44291238384493953, 'recall': 0.5149195308665803, 'f1-score': 0.31256437511023094, 'support': 129217}, 'weighted avg': {'precision': 0.6512902739886561, 'recall': 0.3030560994296416, 'f1-score': 0.2549764397739694, 'support': 129217}}
[[14194   899  5305]
 [38200 10333 40312]
 [ 4199  1142 14633]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1534729
{'0': {'precision': 0.24589086127547666, 'recall': 0.7005619480867006, 'f1-score': 0.36401557285873193, 'support': 7474}, '1': {'precision': 0.8233221772062709, 'recall': 0.14256084914292685, 'f1-score': 0.24303876452694795, 'support': 32786}, '2': {'precision': 0.25734165067178505, 'recall': 0.7102370546947424, 'f1-score': 0.37779578035292877, 'support': 7551}, 'accuracy': 0.3194453159314802, 'macro avg': {'precision': 0.4421848963845109, 'recall': 0.5177866173081233, 'f1-score': 0.3282833725795362, 'support': 47811}, 'weighted avg': {'precision': 0.6436681099178089, 'recall': 0.3194453159314802, 'f1-score': 0.2832330899326858, 'support': 47811}}
[[ 5236   441  1797]
 [14432  4674 13680]
 [ 1626   562  5363]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995537
{'0': {'precision': 0.40365486523124594, 'recall': 0.5326147556216316, 'f1-score': 0.4592534727438432, 'support': 43048}, '1': {'precision': 0.5346329323931979, 'recall': 0.06183143857629395, 'f1-score': 0.1108435807034139, 'support': 41694}, '2': {'precision': 0.3889963653417751, 'recall': 0.5883448230000222, 'f1-score': 0.46834002382107726, 'support': 45113}, 'accuracy': 0.40081629509837896, 'macro avg': {'precision': 0.44242805432207294, 'recall': 0.394263672399316, 'f1-score': 0.34614569242277815, 'support': 129855}, 'weighted avg': {'precision': 0.440616943139195, 'recall': 0.40081629509837896, 'f1-score': 0.350542368358287, 'support': 129855}}
[[22928  1198 18922]
 [16348  2578 22768]
 [17525  1046 26542]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1274062
{'0': {'precision': 0.3849768179979463, 'recall': 0.5461528274400742, 'f1-score': 0.4516152582588064, 'support': 22653}, '1': {'precision': 0.3855211513301352, 'recall': 0.040266010749749476, 'f1-score': 0.07291623706025488, 'support': 21954}, '2': {'precision': 0.38534737620103476, 'recall': 0.5612469163489572, 'f1-score': 0.4569540051490862, 'support': 22295}, 'accuracy': 0.38517533108128305, 'macro avg': {'precision': 0.38528178184303874, 'recall': 0.3825552515129269, 'f1-score': 0.3271618334893825, 'support': 66902}, 'weighted avg': {'precision': 0.3852789298796947, 'recall': 0.38517533108128305, 'f1-score': 0.32912368925527563, 'support': 66902}}
[[12372   702  9579]
 [10690   884 10380]
 [ 9075   707 12513]]
Evaluating performance on  val set...
73/73 - 1s - 561ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1346138
{'0': {'precision': 0.38731049971925885, 'recall': 0.539411948701908, 'f1-score': 0.4508791424276096, 'support': 6394}, '1': {'precision': 0.29846938775510207, 'recall': 0.01975350329225055, 'f1-score': 0.03705463182897862, 'support': 5923}, '2': {'precision': 0.3896964514749893, 'recall': 0.5754419191919192, 'f1-score': 0.4646953861840429, 'support': 6336}, 'accuracy': 0.38664021873157134, 'macro avg': {'precision': 0.35849211298311673, 'recall': 0.37820245706202593, 'f1-score': 0.3175430534802104, 'support': 18653}, 'weighted avg': {'precision': 0.3599106972296115, 'recall': 0.38664021873157134, 'f1-score': 0.32416800449618144, 'support': 18653}}
[[3449  167 2778]
 [2874  117 2932]
 [2582  108 3646]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1430337
{'0': {'precision': 0.3686829540522106, 'recall': 0.4880265938891511, 'f1-score': 0.4200422108600242, 'support': 48733}, '1': {'precision': 0.4781894233642068, 'recall': 0.10666444518493835, 'f1-score': 0.17442240627724498, 'support': 60020}, '2': {'precision': 0.3301181514010874, 'recall': 0.5532362282334903, 'f1-score': 0.4134995538893481, 'support': 45655}, 'accuracy': 0.3590681829956997, 'macro avg': {'precision': 0.39233017627250155, 'recall': 0.38264242243585994, 'f1-score': 0.3359880570088724, 'support': 154408}, 'weighted avg': {'precision': 0.39984650919876374, 'recall': 0.3590681829956997, 'f1-score': 0.32263271345668615, 'support': 154408}}
[[23783  3463 21487]
 [23851  6402 29767]
 [16874  3523 25258]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1060894
{'0': {'precision': 0.4149021340032576, 'recall': 0.5113122171945701, 'f1-score': 0.4580894903682029, 'support': 29393}, '1': {'precision': 0.4163929939792009, 'recall': 0.11205214125271569, 'f1-score': 0.17658494124474103, 'support': 27157}, '2': {'precision': 0.3752813011456628, 'recall': 0.5625838604562009, 'f1-score': 0.45022933316970654, 'support': 26085}, 'accuracy': 0.39628486718702727, 'macro avg': {'precision': 0.4021921430427071, 'recall': 0.3953160729678289, 'f1-score': 0.3616345882608835, 'support': 82635}, 'weighted avg': {'precision': 0.40288516612374325, 'recall': 0.39628486718702727, 'f1-score': 0.36309522351918455, 'support': 82635}}
[[15029  2305 12059]
 [11744  3043 12370]
 [ 9450  1960 14675]]
Evaluating performance on  val set...
112/112 - 1s - 792ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0986294
{'0': {'precision': 0.4281024819855885, 'recall': 0.5126558005752636, 'f1-score': 0.46657940663176267, 'support': 10430}, '1': {'precision': 0.32587589700295483, 'recall': 0.09561555610601932, 'f1-score': 0.1478502346069137, 'support': 8074}, '2': {'precision': 0.3954773129051267, 'recall': 0.5406303494109355, 'f1-score': 0.45680010209724764, 'support': 9931}, 'accuracy': 0.4040091436609812, 'macro avg': {'precision': 0.38315189729789, 'recall': 0.3829672353640728, 'f1-score': 0.3570765811119747, 'support': 28435}, 'weighted avg': {'precision': 0.38768124051247965, 'recall': 0.4040091436609812, 'f1-score': 0.3726621353723676, 'support': 28435}}
[[5347  751 4332]
 [3427  772 3875]
 [3716  846 5369]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0958664
{'0': {'precision': 0.44093062954351475, 'recall': 0.47197719110327013, 'f1-score': 0.45592598791825806, 'support': 63484}, '1': {'precision': 0.25388106042512537, 'recall': 0.05409944526439005, 'f1-score': 0.08919281758684344, 'support': 39298}, '2': {'precision': 0.4056321784974581, 'recall': 0.5889921738833259, 'f1-score': 0.48041087680664535, 'support': 58522}, 'accuracy': 0.41262460943312007, 'macro avg': {'precision': 0.36681462282203275, 'recall': 0.3716896034169954, 'f1-score': 0.34184322743724893, 'support': 161304}, 'weighted avg': {'precision': 0.38255383839554696, 'recall': 0.41262460943312007, 'f1-score': 0.37546316331280666, 'support': 161304}}
[[29963  3314 30207]
 [16872  2126 20300]
 [21119  2934 34469]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1236576
{'0': {'precision': 0.37618109241574454, 'recall': 0.5508965789408776, 'f1-score': 0.44707554345650347, 'support': 40543}, '1': {'precision': 0.3466787989080983, 'recall': 0.06625263942367408, 'f1-score': 0.11124551597564028, 'support': 40255}, '2': {'precision': 0.3913970655244692, 'recall': 0.5220625774925243, 'f1-score': 0.4473843205066772, 'support': 41133}, 'accuracy': 0.381166397388687, 'macro avg': {'precision': 0.37141898561610404, 'recall': 0.379737265285692, 'f1-score': 0.33523512664627364, 'support': 121931}, 'weighted avg': {'precision': 0.37157409170822037, 'recall': 0.381166397388687, 'f1-score': 0.3363068560034575, 'support': 121931}}
[[22335  2466 15742]
 [19939  2667 17649]
 [17099  2560 21474]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.139261
{'0': {'precision': 0.3687655060313115, 'recall': 0.5715706424451369, 'f1-score': 0.4482982761758665, 'support': 15083}, '1': {'precision': 0.43345625209520616, 'recall': 0.07624719896214176, 'f1-score': 0.12968256356250937, 'support': 16958}, '2': {'precision': 0.37715706346885053, 'recall': 0.521572064176891, 'f1-score': 0.4377616838293539, 'support': 14834}, 'accuracy': 0.37655466666666665, 'macro avg': {'precision': 0.3931262738651227, 'recall': 0.38979663519472324, 'f1-score': 0.33858084118924325, 'support': 46875}, 'weighted avg': {'precision': 0.394824301439951, 'recall': 0.37655466666666665, 'f1-score': 0.3296980614480696, 'support': 46875}}
[[8621  808 5654]
 [8542 1293 7123]
 [6215  882 7737]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/EXC
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.186285
{'0': {'precision': 0.2712626693189353, 'recall': 0.7117803207301433, 'f1-score': 0.3928199106741141, 'support': 100583}, '1': {'precision': 0.8210742332676211, 'recall': 0.12592342939559828, 'f1-score': 0.21835847609307085, 'support': 403523}, '2': {'precision': 0.2566864448759252, 'recall': 0.7223929501790948, 'f1-score': 0.37878129010054984, 'support': 98272}, 'accuracy': 0.321055881854915, 'macro avg': {'precision': 0.4496744491541605, 'recall': 0.5200322334349455, 'f1-score': 0.3299865589559116, 'support': 602378}, 'weighted avg': {'precision': 0.6371943218540579, 'recall': 0.321055881854915, 'f1-score': 0.27366083649236833, 'support': 602378}}
[[ 71593   4809  24181]
 [171315  50813 181395]
 [ 21017   6264  70991]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1534522
{'0': {'precision': 0.27436009987982757, 'recall': 0.734397873487942, 'f1-score': 0.3994803099280711, 'support': 51916}, '1': {'precision': 0.8321072304359213, 'recall': 0.16314327724228067, 'f1-score': 0.2728010677573194, 'support': 214235}, '2': {'precision': 0.28976651119940117, 'recall': 0.7489349827922984, 'f1-score': 0.41786072001287033, 'support': 53755}, 'accuracy': 0.35428219539489725, 'macro avg': {'precision': 0.46541128050505004, 'recall': 0.5488253778408404, 'f1-score': 0.36338069923275357, 'support': 319906}, 'weighted avg': {'precision': 0.6504616051819113, 'recall': 0.35428219539489725, 'f1-score': 0.3177341454224269, 'support': 319906}}
[[38127  3177 10612]
 [91219 34951 88065]
 [ 9621  3875 40259]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1690845
{'0': {'precision': 0.2524129610479145, 'recall': 0.714181215254072, 'f1-score': 0.3729974785421389, 'support': 20506}, '1': {'precision': 0.8322475570032574, 'recall': 0.15550639652609524, 'f1-score': 0.26204869774459816, 'support': 85437}, '2': {'precision': 0.28522846015009024, 'recall': 0.7261075643257884, 'f1-score': 0.4095701872843093, 'support': 20676}, 'accuracy': 0.3391592099132042, 'macro avg': {'precision': 0.4566296594004207, 'recall': 0.5319317253686519, 'f1-score': 0.34820545452368207, 'support': 126619}, 'weighted avg': {'precision': 0.6490186966331997, 'recall': 0.3391592099132042, 'f1-score': 0.30410613001588005, 'support': 126619}}
[[14645  1227  4634]
 [39163 13286 32988]
 [ 4212  1451 15013]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/AAL
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1994717
{'0': {'precision': 0.275438174692857, 'recall': 0.6474936840498946, 'f1-score': 0.386473772186829, 'support': 176933}, '1': {'precision': 0.8024943694426725, 'recall': 0.09524103822341982, 'f1-score': 0.17027377167370594, 'support': 647221}, '2': {'precision': 0.2404915343075925, 'recall': 0.7190644890116489, 'f1-score': 0.3604352805380359, 'support': 166540}, 'accuracy': 0.29873805635241557, 'macro avg': {'precision': 0.439474692814374, 'recall': 0.4872664037616545, 'f1-score': 0.305727608132857, 'support': 990694}, 'weighted avg': {'precision': 0.6138896278483302, 'recall': 0.29873805635241557, 'f1-score': 0.24085299429648746, 'support': 990694}}
[[114563   7912  54458]
 [261839  61642 323740]
 [ 39528   7259 119753]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.214334
{'0': {'precision': 0.24168693769713334, 'recall': 0.6568346802891079, 'f1-score': 0.35335457550400523, 'support': 63229}, '1': {'precision': 0.8281453197199856, 'recall': 0.1073333070349398, 'f1-score': 0.19003657235739319, 'support': 278851}, '2': {'precision': 0.22592325513601424, 'recall': 0.7191111834608498, 'f1-score': 0.3438264950712365, 'support': 61430}, 'accuracy': 0.2865753017273426, 'macro avg': {'precision': 0.43191850418437777, 'recall': 0.49442639026163243, 'f1-score': 0.2957392143108783, 'support': 403510}, 'weighted avg': {'precision': 0.6445670231119306, 'recall': 0.2865753017273426, 'f1-score': 0.2390409315387481, 'support': 403510}}
[[ 41531   3102  18596]
 [116161  29930 132760]
 [ 14146   3109  44175]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2200611
{'0': {'precision': 0.2448055826234558, 'recall': 0.6786632390745502, 'f1-score': 0.3598184275269413, 'support': 22951}, '1': {'precision': 0.8378652914517893, 'recall': 0.09992638082546665, 'f1-score': 0.17855745293779715, 'support': 107309}, '2': {'precision': 0.2254563394178589, 'recall': 0.7488572660629582, 'f1-score': 0.3465714057635507, 'support': 23190}, 'accuracy': 0.28455522971652003, 'macro avg': {'precision': 0.4360424044977013, 'recall': 0.5091489619876584, 'f1-score': 0.2949824287427631, 'support': 153450}, 'weighted avg': {'precision': 0.6566135679263028, 'recall': 0.28455522971652003, 'f1-score': 0.23105901171149984, 'support': 153450}}
[[15576   968  6407]
 [43333 10723 53253]
 [ 4717  1107 17366]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/WBA
Evaluating performance on  test set...
2451/2451 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0974679
{'0': {'precision': 0.4123093273744235, 'recall': 0.5588155179338969, 'f1-score': 0.47451128748037413, 'support': 216601}, '1': {'precision': 0.4728808831148129, 'recall': 0.05872019081835142, 'f1-score': 0.10446801954483427, 'support': 202077}, '2': {'precision': 0.3989205579924711, 'recall': 0.5901398933187642, 'f1-score': 0.476045595037664, 'support': 208659}, 'accuracy': 0.4081442669569944, 'macro avg': {'precision': 0.4280369228272358, 'recall': 0.40255853402367087, 'f1-score': 0.35167496735429077, 'support': 627337}, 'weighted avg': {'precision': 0.4273673122197011, 'recall': 0.4081442669569944, 'f1-score': 0.35582374573803544, 'support': 627337}}
[[121040   6893  88668]
 [ 93339  11866  96872]
 [ 79187   6334 123138]]
Evaluating performance on  train set...
1200/1200 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0674549
{'0': {'precision': 0.41999420497819967, 'recall': 0.5900614495900129, 'f1-score': 0.49071036489525477, 'support': 103174}, '1': {'precision': 0.5230020001739282, 'recall': 0.11890427750921834, 'f1-score': 0.19375780274656676, 'support': 101157}, '2': {'precision': 0.4257930975003234, 'recall': 0.5765446636238893, 'f1-score': 0.4898323652824572, 'support': 102757}, 'accuracy': 0.43033592976606055, 'macro avg': {'precision': 0.45626310088415045, 'recall': 0.4285034635743736, 'f1-score': 0.39143351097475954, 'support': 307088}, 'weighted avg': {'precision': 0.45586612552706574, 'recall': 0.43033592976606055, 'f1-score': 0.3925982571753599, 'support': 307088}}
[[60879  5484 36811]
 [46046 12028 43083]
 [38027  5486 59244]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0754298
{'0': {'precision': 0.42185102792267565, 'recall': 0.5726744942854911, 'f1-score': 0.48582629341284295, 'support': 38411}, '1': {'precision': 0.5246081332894881, 'recall': 0.12693613409717802, 'f1-score': 0.20441198453883447, 'support': 37704}, '2': {'precision': 0.4076787067441273, 'recall': 0.5729812392473852, 'f1-score': 0.4763980655268714, 'support': 36619}, 'accuracy': 0.42369648908049035, 'macro avg': {'precision': 0.45137928931876364, 'recall': 0.4241972892100181, 'f1-score': 0.38887878115951624, 'support': 112734}, 'weighted avg': {'precision': 0.4516146987896106, 'recall': 0.42369648908049035, 'f1-score': 0.38864445493694383, 'support': 112734}}
[[21997  2171 14243]
 [16676  4786 16242]
 [13471  2166 20982]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
3337/3337 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1044594
{'0': {'precision': 0.37465313267022904, 'recall': 0.5997924512901834, 'f1-score': 0.4612143038598904, 'support': 257289}, '1': {'precision': 0.5923533595575748, 'recall': 0.11846069888009661, 'f1-score': 0.19743726822565782, 'support': 344494}, '2': {'precision': 0.3863695431417678, 'recall': 0.5716992950989954, 'f1-score': 0.4611092369259598, 'support': 252234}, 'accuracy': 0.3973351818523519, 'macro avg': {'precision': 0.4511253451231905, 'recall': 0.4299841484230918, 'f1-score': 0.373253603003836, 'support': 854017}, 'weighted avg': {'precision': 0.46592965180299506, 'recall': 0.3973351818523519, 'f1-score': 0.3547806994154913, 'support': 854017}}
[[154320  13789  89180]
 [163844  40809 139841]
 [ 93737  14295 144202]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.082076
{'0': {'precision': 0.3966967354455771, 'recall': 0.5854055410820777, 'f1-score': 0.47292114601359975, 'support': 115537}, '1': {'precision': 0.5514556646148727, 'recall': 0.12612914272668468, 'f1-score': 0.20530162269292707, 'support': 131405}, '2': {'precision': 0.41148755987508534, 'recall': 0.5716743311738445, 'f1-score': 0.4785313135499461, 'support': 119164}, 'accuracy': 0.41608987560979604, 'macro avg': {'precision': 0.4532133199785117, 'recall': 0.42773633832753566, 'f1-score': 0.38558469408549095, 'support': 366106}, 'weighted avg': {'precision': 0.45705802668311274, 'recall': 0.41608987560979604, 'f1-score': 0.3786915691761488, 'support': 366106}}
[[67636  6360 41541]
 [58942 16574 55889]
 [43920  7121 68123]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0709962
{'0': {'precision': 0.4169213554453296, 'recall': 0.5690967947841152, 'f1-score': 0.4812662059126881, 'support': 43866}, '1': {'precision': 0.4889012983386849, 'recall': 0.09280754756983092, 'f1-score': 0.15600151457781145, 'support': 37734}, '2': {'precision': 0.43120031322881025, 'recall': 0.5732974220854175, 'f1-score': 0.4921982783747547, 'support': 44183}, 'accuracy': 0.4276889563772529, 'macro avg': {'precision': 0.44567432233760823, 'recall': 0.4117339214797879, 'f1-score': 0.3764886662884181, 'support': 125783}, 'weighted avg': {'precision': 0.44353050260261945, 'recall': 0.4276889563772529, 'f1-score': 0.3875291658894835, 'support': 125783}}
[[24964  1776 17126]
 [17945  3502 16287]
 [16968  1885 25330]]
testing model on single stock: results/universal/W9/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1474909
{'0': {'precision': 0.36130977493802874, 'recall': 0.5276242342065935, 'f1-score': 0.42890876342209827, 'support': 808312}, '1': {'precision': 0.4131027352194755, 'recall': 0.04365172774432304, 'f1-score': 0.07895992087838645, 'support': 1006833}, '2': {'precision': 0.35991215912052504, 'recall': 0.5911864324327611, 'f1-score': 0.4474303447177685, 'support': 822255}, 'accuracy': 0.36268332448623647, 'macro avg': {'precision': 0.37810822309267644, 'recall': 0.38748746479455926, 'f1-score': 0.31843300967275107, 'support': 2637400}, 'weighted avg': {'precision': 0.380646115646692, 'recall': 0.36268332448623647, 'f1-score': 0.3010894792192691, 'support': 2637400}}
[[426485  30262 351565]
 [449930  43950 512953]
 [303971  32178 486106]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1183839
{'0': {'precision': 0.3892345793232616, 'recall': 0.4820413039529392, 'f1-score': 0.4306951397645414, 'support': 286268}, '1': {'precision': 0.35816177037551084, 'recall': 0.04803416682178238, 'f1-score': 0.08470789907997556, 'support': 290106}, '2': {'precision': 0.3860712195000436, 'recall': 0.6224634261444077, 'f1-score': 0.4765631306045733, 'support': 298779}, 'accuracy': 0.386111914145298, 'macro avg': {'precision': 0.377822523066272, 'recall': 0.3841796323063765, 'f1-score': 0.3306553898163634, 'support': 875153}, 'weighted avg': {'precision': 0.37785422206319685, 'recall': 0.386111914145298, 'f1-score': 0.3316626482906588, 'support': 875153}}
[[137993  12560 135715]
 [116143  13935 160028]
 [100388  12412 185979]]
Evaluating performance on  val set...
1396/1396 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.126744
{'0': {'precision': 0.38267844316156324, 'recall': 0.4957949884534519, 'f1-score': 0.4319539953755142, 'support': 116052}, '1': {'precision': 0.37631275420384874, 'recall': 0.04932485657678016, 'f1-score': 0.08721772775237426, 'support': 125677}, '2': {'precision': 0.37315227608080365, 'recall': 0.6150583795667189, 'f1-score': 0.4644969834038187, 'support': 115537}, 'accuracy': 0.3773071045103648, 'macro avg': {'precision': 0.3773811578154052, 'recall': 0.3867260748656503, 'f1-score': 0.32788956884390236, 'support': 357266}, 'weighted avg': {'precision': 0.377358470208222, 'recall': 0.3773071045103648, 'f1-score': 0.3212087783712453, 'support': 357266}}
[[57538  5499 53015]
 [53118  6199 66360]
 [39700  4775 71062]]
training model: results/universal/W9/deepOF_L1/h100
Epoch 1/50
6697/6697 - 95s - loss: 3.1772 - accuracy100: 0.4291 - val_loss: 3.3029 - val_accuracy100: 0.3584 - 95s/epoch - 14ms/step
Epoch 2/50
6697/6697 - 93s - loss: 3.1647 - accuracy100: 0.4318 - val_loss: 3.3015 - val_accuracy100: 0.3605 - 93s/epoch - 14ms/step
Epoch 3/50
6697/6697 - 94s - loss: 3.1570 - accuracy100: 0.4332 - val_loss: 3.2956 - val_accuracy100: 0.3607 - 94s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 94s - loss: 3.1495 - accuracy100: 0.4348 - val_loss: 3.2906 - val_accuracy100: 0.3646 - 94s/epoch - 14ms/step
Epoch 5/50
6697/6697 - 94s - loss: 3.1442 - accuracy100: 0.4362 - val_loss: 3.2893 - val_accuracy100: 0.3664 - 94s/epoch - 14ms/step
Epoch 6/50
6697/6697 - 95s - loss: 3.1403 - accuracy100: 0.4372 - val_loss: 3.2905 - val_accuracy100: 0.3657 - 95s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 94s - loss: 3.1362 - accuracy100: 0.4382 - val_loss: 3.2941 - val_accuracy100: 0.3659 - 94s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 95s - loss: 3.1318 - accuracy100: 0.4394 - val_loss: 3.2954 - val_accuracy100: 0.3662 - 95s/epoch - 14ms/step
Epoch 9/50
6697/6697 - 95s - loss: 3.1292 - accuracy100: 0.4401 - val_loss: 3.2968 - val_accuracy100: 0.3656 - 95s/epoch - 14ms/step
Epoch 10/50
6697/6697 - 94s - loss: 3.1266 - accuracy100: 0.4406 - val_loss: 3.2966 - val_accuracy100: 0.3662 - 94s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 95s - loss: 3.1238 - accuracy100: 0.4414 - val_loss: 3.2971 - val_accuracy100: 0.3666 - 95s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 95s - loss: 3.1212 - accuracy100: 0.4416 - val_loss: 3.2967 - val_accuracy100: 0.3658 - 95s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 95s - loss: 3.1188 - accuracy100: 0.4426 - val_loss: 3.2967 - val_accuracy100: 0.3666 - 95s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 94s - loss: 3.1169 - accuracy100: 0.4429 - val_loss: 3.2985 - val_accuracy100: 0.3671 - 94s/epoch - 14ms/step
Epoch 15/50
6697/6697 - 94s - loss: 3.1149 - accuracy100: 0.4431 - val_loss: 3.2966 - val_accuracy100: 0.3666 - 94s/epoch - 14ms/step
testing model in sample: results/universal/W9/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 83s - 83s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1262653
{'0': {'precision': 0.3581122561589061, 'recall': 0.5345764141766312, 'f1-score': 0.42890286867464056, 'support': 1277793}, '1': {'precision': 0.5163043478260869, 'recall': 0.0001084965349632939, 'f1-score': 0.0002169474804404719, 'support': 1751208}, '2': {'precision': 0.3425156477421457, 'recall': 0.6428466967759595, 'f1-score': 0.4469118471394373, 'support': 1278675}, 'accuracy': 0.3494366800102886, 'macro avg': {'precision': 0.4056440839090462, 'recall': 0.39251053582918466, 'f1-score': 0.29201055443150614, 'support': 4307676}, 'weighted avg': {'precision': 0.4177927574772502, 'recall': 0.3494366800102886, 'f1-score': 0.2599740578392437, 'support': 4307676}}
[[683078     78 594637]
 [767780    190 983238]
 [456583    100 821992]]
Evaluating performance on  train set...
6697/6697 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1139948
{'0': {'precision': 0.37700170381562453, 'recall': 0.5139164631148947, 'f1-score': 0.4349386720460147, 'support': 524846}, '1': {'precision': 0.6018518518518519, 'recall': 0.0001985784835630479, 'f1-score': 0.00039702597007951207, 'support': 654653}, '2': {'precision': 0.36473811264812234, 'recall': 0.6812516370439663, 'f1-score': 0.4751068285458922, 'support': 534500}, 'accuracy': 0.36988703027247977, 'macro avg': {'precision': 0.44786388943853295, 'recall': 0.39845555954747464, 'f1-score': 0.3034808421873288, 'support': 1713999}, 'weighted avg': {'precision': 0.45905772280007584, 'recall': 0.36988703027247977, 'f1-score': 0.28149394274374284, 'support': 1713999}}
[[269727     37 255082]
 [275404    130 379119]
 [170322     49 364129]]
Evaluating performance on  val set...
2631/2631 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1161479
{'0': {'precision': 0.37602214291735747, 'recall': 0.5148215831489853, 'f1-score': 0.4346089201763574, 'support': 207940}, '1': {'precision': 0.5, 'recall': 0.0002882331691044788, 'f1-score': 0.0005761342162270124, 'support': 260206}, '2': {'precision': 0.35891283674253066, 'recall': 0.6802739364690136, 'f1-score': 0.46990407228826225, 'support': 204719}, 'accuracy': 0.36618340974786917, 'macro avg': {'precision': 0.4116449932199627, 'recall': 0.39846125092903445, 'f1-score': 0.3016963755602822, 'support': 672865}, 'weighted avg': {'precision': 0.4187605558668224, 'recall': 0.36618340974786917, 'f1-score': 0.27750110975622166, 'support': 672865}}
[[107052     44 100844]
 [112221     75 147910]
 [ 65423     31 139265]]
testing model out of sample: results/universal/W9/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 44s - 44s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.13147
{'0': {'precision': 0.36839358652624504, 'recall': 0.5494716663769328, 'f1-score': 0.4410709245848385, 'support': 638517}, '1': {'precision': 0.47752808988764045, 'recall': 8.84876523288909e-05, 'f1-score': 0.00017694251658055465, 'support': 960586}, '2': {'precision': 0.32722143304319085, 'recall': 0.6728412103826431, 'f1-score': 0.4403085477079947, 'support': 612137}, 'accuracy': 0.34496617282610664, 'macro avg': {'precision': 0.39104770315235876, 'recall': 0.4074671214706349, 'f1-score': 0.29385213826980455, 'support': 2211240}, 'weighted avg': {'precision': 0.4044050902658902, 'recall': 0.34496617282610664, 'f1-score': 0.24933087567414577, 'support': 2211240}}
[[350847     41 287629]
 [401309     85 559192]
 [200214     52 411871]]
Evaluating performance on  train set...
3947/3947 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1279193
{'0': {'precision': 0.3558366087416801, 'recall': 0.5473295084466249, 'f1-score': 0.43128251258188294, 'support': 288636}, '1': {'precision': 0.5714285714285714, 'recall': 0.00018711611958591203, 'f1-score': 0.00037410973573823544, 'support': 427542}, '2': {'precision': 0.3422734049081382, 'recall': 0.6596715701645558, 'f1-score': 0.450699469648897, 'support': 293396}, 'accuracy': 0.34826966621565136, 'macro avg': {'precision': 0.4231795283594632, 'recall': 0.40239606491025554, 'f1-score': 0.2941186973221727, 'support': 1009574}, 'weighted avg': {'precision': 0.4431954642184783, 'recall': 0.34826966621565136, 'f1-score': 0.25444101029080496, 'support': 1009574}}
[[157979     21 130636]
 [186174     80 241288]
 [ 99812     39 193545]]
Evaluating performance on  val set...
1402/1402 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1275164
{'0': {'precision': 0.36112780128606675, 'recall': 0.5478390722119328, 'f1-score': 0.43530721608179584, 'support': 103127}, '1': {'precision': 0.5151515151515151, 'recall': 0.0001116767942190836, 'f1-score': 0.00022330517936660144, 'support': 152225}, '2': {'precision': 0.33968735440766845, 'recall': 0.6661159113219101, 'f1-score': 0.4499312327876816, 'support': 102889}, 'accuracy': 0.34906668974238014, 'macro avg': {'precision': 0.40532222361508347, 'recall': 0.4046888867760206, 'f1-score': 0.2951539180162814, 'support': 358241}, 'weighted avg': {'precision': 0.4204182613514874, 'recall': 0.34906668974238014, 'f1-score': 0.254629968412572, 'support': 358241}}
[[56497     8 46622]
 [65604    17 86604]
 [34345     8 68536]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1155951
{'0': {'precision': 0.35303325559850496, 'recall': 0.47155963302752296, 'f1-score': 0.4037779970039096, 'support': 23435}, '1': {'precision': 0.25, 'recall': 0.00010815097876635784, 'f1-score': 0.00021620842492162443, 'support': 27739}, '2': {'precision': 0.3675178753830439, 'recall': 0.6691601917672343, 'f1-score': 0.47445458674598173, 'support': 24196}, 'accuracy': 0.36148334881252486, 'macro avg': {'precision': 0.3235170436605163, 'recall': 0.38027599192450784, 'f1-score': 0.292816264058271, 'support': 75370}, 'weighted avg': {'precision': 0.3197631266779765, 'recall': 0.36148334881252486, 'f1-score': 0.277941328727495, 'support': 75370}}
[[11051     5 12379]
 [12251     3 15485]
 [ 8001     4 16191]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1033934
{'0': {'precision': 0.3851711369999097, 'recall': 0.4862338254574474, 'f1-score': 0.42984202171886415, 'support': 17543}, '1': {'precision': 0.2857142857142857, 'recall': 0.00036489691662105453, 'f1-score': 0.0007288629737609329, 'support': 16443}, '2': {'precision': 0.3762345465847089, 'recall': 0.6356846957232044, 'f1-score': 0.4726988741132829, 'support': 17139}, 'accuracy': 0.3800684596577017, 'macro avg': {'precision': 0.3490399897663014, 'recall': 0.37409447269909096, 'f1-score': 0.30108991960196935, 'support': 51125}, 'weighted avg': {'precision': 0.350187601961951, 'recall': 0.3800684596577017, 'f1-score': 0.3061963674194453, 'support': 51125}}
[[ 8530     6  9007]
 [ 7381     6  9056]
 [ 6235     9 10895]]
Evaluating performance on  val set...
53/53 - 0s - 457ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1194566
{'0': {'precision': 0.36795475966069746, 'recall': 0.44283121597096187, 'f1-score': 0.4019355502934212, 'support': 4408}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4885}, '2': {'precision': 0.3380643582527836, 'recall': 0.659899689515166, 'f1-score': 0.4470873786407767, 'support': 4187}, 'accuracy': 0.34977744807121663, 'macro avg': {'precision': 0.23533970597116036, 'recall': 0.36757696849537597, 'f1-score': 0.28300764297806597, 'support': 13480}, 'weighted avg': {'precision': 0.22532789677958154, 'recall': 0.34977744807121663, 'f1-score': 0.270303172111449, 'support': 13480}}
[[1952    1 2455]
 [1930    0 2955]
 [1423    1 2763]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1736691
{'0': {'precision': 0.29611452867740184, 'recall': 0.6558304948908035, 'f1-score': 0.4080087254596447, 'support': 59892}, '1': {'precision': 0.6229508196721312, 'recall': 0.00023209508569194874, 'f1-score': 0.00046401729074957107, 'support': 163726}, '2': {'precision': 0.28955840567242774, 'recall': 0.7104981210522108, 'f1-score': 0.4114381490793087, 'support': 62535}, 'accuracy': 0.2926686073534088, 'macro avg': {'precision': 0.4028745846739869, 'recall': 0.4555202370095688, 'f1-score': 0.273303630609901, 'support': 286153}, 'weighted avg': {'precision': 0.4816852248689043, 'recall': 0.2926686073534088, 'f1-score': 0.17557640469556102, 'support': 286153}}
[[39279     8 20605]
 [75280    38 88408]
 [18089    15 44431]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1660367
{'0': {'precision': 0.31960461285008235, 'recall': 0.6079019073569483, 'f1-score': 0.41894746725505844, 'support': 29360}, '1': {'precision': 0.5, 'recall': 0.00025105652956190636, 'f1-score': 0.00050186106812764, 'support': 71697}, '2': {'precision': 0.28369036093649863, 'recall': 0.7388139204545454, 'f1-score': 0.4099628560450062, 'support': 28160}, 'accuracy': 0.2992717676466719, 'macro avg': {'precision': 0.36776499126219364, 'recall': 0.44898896144701855, 'f1-score': 0.27647072812273077, 'support': 129217}, 'weighted avg': {'precision': 0.41187159582137195, 'recall': 0.2992717676466719, 'f1-score': 0.1848118560084001, 'support': 129217}}
[[17848     8 11504]
 [30651    18 41028]
 [ 7345    10 20805]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1609282
{'0': {'precision': 0.3170516745523704, 'recall': 0.6325775104118464, 'f1-score': 0.422395945987702, 'support': 10805}, '1': {'precision': 0.5555555555555556, 'recall': 0.00019004180919802356, 'f1-score': 0.00037995364565523006, 'support': 26310}, '2': {'precision': 0.29698216735253774, 'recall': 0.7286836200448766, 'f1-score': 0.42198159177043854, 'support': 10696}, 'accuracy': 0.3060801907510824, 'macro avg': {'precision': 0.3898631324868212, 'recall': 0.4538170574219737, 'f1-score': 0.28158583046793195, 'support': 47811}, 'weighted avg': {'precision': 0.44380856439329386, 'recall': 0.3060801907510824, 'f1-score': 0.19007132003913157, 'support': 47811}}
[[ 6835     2  3968]
 [11823     5 14482]
 [ 2900     2  7794]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1090362
{'0': {'precision': 0.40732674044423517, 'recall': 0.5001686584425598, 'f1-score': 0.44899857247912794, 'support': 41504}, '1': {'precision': 0.2727272727272727, 'recall': 6.543503391715924e-05, 'f1-score': 0.00013083867591259974, 'support': 45847}, '2': {'precision': 0.36135902636916833, 'recall': 0.6706192358366272, 'f1-score': 0.46965003624859947, 'support': 42504}, 'accuracy': 0.3793923992145085, 'macro avg': {'precision': 0.3471376798468921, 'recall': 0.390284443104368, 'f1-score': 0.30625981580121336, 'support': 129855}, 'weighted avg': {'precision': 0.344758541179931, 'recall': 0.3793923992145085, 'f1-score': 0.29727958456477427, 'support': 129855}}
[[20759     5 20740]
 [16208     3 29636]
 [13997     3 28504]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1042963
{'0': {'precision': 0.3868573922971022, 'recall': 0.5130705856156758, 'f1-score': 0.44111340837736424, 'support': 22455}, '1': {'precision': 0.5, 'recall': 4.5059252917586624e-05, 'f1-score': 9.011038522189682e-05, 'support': 22193}, '2': {'precision': 0.37767720035561303, 'recall': 0.6299541655432731, 'f1-score': 0.4722348542266686, 'support': 22254}, 'accuracy': 0.38176736121491134, 'macro avg': {'precision': 0.4215115308842384, 'recall': 0.3810232701372888, 'f1-score': 0.30447945766308493, 'support': 66902}, 'weighted avg': {'precision': 0.42133585185413347, 'recall': 0.38176736121491134, 'f1-score': 0.3051674965001529, 'support': 66902}}
[[11521     1 10933]
 [10025     1 12167]
 [ 8235     0 14019]]
Evaluating performance on  val set...
73/73 - 1s - 564ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1042931
{'0': {'precision': 0.3829787234042553, 'recall': 0.485273492286115, 'f1-score': 0.4281000824855651, 'support': 6417}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5999}, '2': {'precision': 0.36717042106263664, 'recall': 0.6193682860349528, 'f1-score': 0.46103353622150617, 'support': 6237}, 'accuracy': 0.3740417091084544, 'macro avg': {'precision': 0.2500497148222973, 'recall': 0.3682139261070226, 'f1-score': 0.2963778729023571, 'support': 18653}, 'weighted avg': {'precision': 0.2545229391654303, 'recall': 0.3740417091084544, 'f1-score': 0.3014305685264249, 'support': 18653}}
[[3114    1 3302]
 [2643    0 3356]
 [2374    0 3863]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.122918
{'0': {'precision': 0.3751597784405624, 'recall': 0.5489629660418138, 'f1-score': 0.4457174676025918, 'support': 48118}, '1': {'precision': 0.5, 'recall': 6.629760997116054e-05, 'f1-score': 0.0001325776407808823, 'support': 60334}, '2': {'precision': 0.3293249196332897, 'recall': 0.6018800591870485, 'f1-score': 0.4257152971234205, 'support': 45956}, 'accuracy': 0.3502344438112015, 'macro avg': {'precision': 0.40149489935795074, 'recall': 0.3836364409462778, 'f1-score': 0.29052178078893104, 'support': 154408}, 'weighted avg': {'precision': 0.41029865179051894, 'recall': 0.3502344438112015, 'f1-score': 0.265654656754082, 'support': 154408}}
[[26415     3 21700]
 [25700     4 34630]
 [18295     1 27660]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0986556
{'0': {'precision': 0.41420816035766045, 'recall': 0.5762225335748214, 'f1-score': 0.48196421425713143, 'support': 29263}, '1': {'precision': 0.6, 'recall': 0.00011006750807161726, 'f1-score': 0.00022009464069549904, 'support': 27256}, '2': {'precision': 0.37549199685122014, 'recall': 0.6027339561954358, 'f1-score': 0.4627188147625557, 'support': 26116}, 'accuracy': 0.394578568403219, 'macro avg': {'precision': 0.4632333857362935, 'recall': 0.393022185759443, 'f1-score': 0.31496770788679423, 'support': 82635}, 'weighted avg': {'precision': 0.4632531298640126, 'recall': 0.394578568403219, 'f1-score': 0.3169853242291055, 'support': 82635}}
[[16862     1 12400]
 [13473     3 13780]
 [10374     1 15741]]
Evaluating performance on  val set...
112/112 - 1s - 717ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0838423
{'0': {'precision': 0.42263295800580697, 'recall': 0.5834962847086429, 'f1-score': 0.49020493654770214, 'support': 10228}, '1': {'precision': 0.4, 'recall': 0.000242306760358614, 'f1-score': 0.00048432013560963794, 'support': 8254}, '2': {'precision': 0.4093228038297575, 'recall': 0.5884657892092836, 'f1-score': 0.4828126288022422, 'support': 9953}, 'accuracy': 0.4159310708633726, 'macro avg': {'precision': 0.41065192061185485, 'recall': 0.39073479355942836, 'f1-score': 0.32450062849518463, 'support': 28435}, 'weighted avg': {'precision': 0.4114042469140486, 'recall': 0.4159310708633726, 'f1-score': 0.345463258796481, 'support': 28435}}
[[5968    1 4259]
 [4059    2 4193]
 [4094    2 5857]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
631/631 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957158
{'0': {'precision': 0.40736830317864053, 'recall': 0.4251039180007679, 'f1-score': 0.4160471841456042, 'support': 59903}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 46567}, '2': {'precision': 0.366808381415123, 'recall': 0.6608491082175293, 'f1-score': 0.4717622246523981, 'support': 54834}, 'accuracy': 0.38251996230719637, 'macro avg': {'precision': 0.25805889486458783, 'recall': 0.36198434207276575, 'f1-score': 0.2959364695993341, 'support': 161304}, 'weighted avg': {'precision': 0.2759767535326276, 'recall': 0.38251996230719637, 'f1-score': 0.3148780209942948, 'support': 161304}}
[[25465     3 34435]
 [18449     0 28118]
 [18597     0 36237]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1053107
{'0': {'precision': 0.37105836083994664, 'recall': 0.5244819456508252, 'f1-score': 0.43462792156378854, 'support': 40295}, '1': {'precision': 0.18181818181818182, 'recall': 4.9738870927629945e-05, 'f1-score': 9.945053578976158e-05, 'support': 40210}, '2': {'precision': 0.3799950741949387, 'recall': 0.5959059527832762, 'f1-score': 0.4640661716326722, 'support': 41426}, 'accuracy': 0.3758027080890012, 'macro avg': {'precision': 0.3109572056176891, 'recall': 0.3734792124350097, 'f1-score': 0.29959784791075017, 'support': 121931}, 'weighted avg': {'precision': 0.31168760761868824, 'recall': 0.3758027080890012, 'f1-score': 0.3013321979768233, 'support': 121931}}
[[21134     4 19157]
 [19087     2 21121]
 [16735     5 24686]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1055871
{'0': {'precision': 0.37882269754286724, 'recall': 0.5448420517383843, 'f1-score': 0.44691222856547014, 'support': 15733}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15850}, '2': {'precision': 0.3760465212191199, 'recall': 0.5962594820821344, 'f1-score': 0.4612155087382079, 'support': 15292}, 'accuracy': 0.37738666666666665, 'macro avg': {'precision': 0.2516230729206624, 'recall': 0.38036717794017294, 'f1-score': 0.30270924576789265, 'support': 46875}, 'weighted avg': {'precision': 0.24982444592906053, 'recall': 0.37738666666666665, 'f1-score': 0.3004624565684313, 'support': 46875}}
[[8572    0 7161]
 [7882    0 7968]
 [6174    0 9118]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/EXC
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1483483
{'0': {'precision': 0.3516321796346427, 'recall': 0.6228289202908492, 'f1-score': 0.44949293675880525, 'support': 145780}, '1': {'precision': 0.7107438016528925, 'recall': 0.0002748279928289068, 'f1-score': 0.00054944352870523, 'support': 312923}, '2': {'precision': 0.31292799758170464, 'recall': 0.7493370454149991, 'f1-score': 0.44148782393140307, 'support': 143675}, 'accuracy': 0.32959869052322627, 'macro avg': {'precision': 0.45843465962308, 'recall': 0.4574802645662257, 'f1-score': 0.29717673473963785, 'support': 602378}, 'weighted avg': {'precision': 0.5289518406122363, 'recall': 0.32959869052322627, 'f1-score': 0.21436668826115163, 'support': 602378}}
[[ 90796      7  54977]
 [131431     86 181406]
 [ 35986     28 107661]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1382459
{'0': {'precision': 0.3568171696392594, 'recall': 0.6536519036519036, 'f1-score': 0.4616355479950064, 'support': 77220}, '1': {'precision': 0.7159090909090909, 'recall': 0.0003861855897605649, 'f1-score': 0.0007719547610003553, 'support': 163134}, '2': {'precision': 0.34192835797464666, 'recall': 0.7666180611423974, 'f1-score': 0.4729228299684775, 'support': 79552}, 'accuracy': 0.34861490562852837, 'macro avg': {'precision': 0.47155153950766565, 'recall': 0.47355205012802054, 'f1-score': 0.3117767775748281, 'support': 319906}, 'weighted avg': {'precision': 0.5362313311082204, 'recall': 0.34861490562852837, 'f1-score': 0.22942797588606573, 'support': 319906}}
[[50475    14 26731]
 [72429    63 90642]
 [18555    11 60986]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1460832
{'0': {'precision': 0.338166470958629, 'recall': 0.6592899800928999, 'f1-score': 0.44703659126444023, 'support': 30140}, '1': {'precision': 0.7555555555555555, 'recall': 0.0005119248373885811, 'f1-score': 0.0010231564376100269, 'support': 66416}, '2': {'precision': 0.3351569758011001, 'recall': 0.7560123740145694, 'f1-score': 0.4644243736973313, 'support': 30063}, 'accuracy': 0.33670302245318634, 'macro avg': {'precision': 0.47629300077176157, 'recall': 0.4719380929816193, 'f1-score': 0.30416137379979385, 'support': 126619}, 'weighted avg': {'precision': 0.5563867932615115, 'recall': 0.33670302245318634, 'f1-score': 0.2172156371882056, 'support': 126619}}
[[19871     8 10261]
 [31558    34 34824]
 [ 7332     3 22728]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/AAL
Evaluating performance on  test set...
3870/3870 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1573857
{'0': {'precision': 0.3469753107130703, 'recall': 0.6007659941741288, 'f1-score': 0.4398900130647464, 'support': 240994}, '1': {'precision': 0.5789473684210527, 'recall': 0.00010514684234473635, 'f1-score': 0.00021025549865914334, 'support': 523078}, '2': {'precision': 0.2843216769312075, 'recall': 0.7193079224435404, 'f1-score': 0.40755042471138997, 'support': 226622}, 'accuracy': 0.3107387346647905, 'macro avg': {'precision': 0.40341478535511016, 'recall': 0.44005968782000465, 'f1-score': 0.28255023109159855, 'support': 990694}, 'weighted avg': {'precision': 0.4551225168199637, 'recall': 0.3107387346647905, 'f1-score': 0.20034513803777731, 'support': 990694}}
[[144781     15  96198]
 [208899     55 314124]
 [ 63586     25 163011]]
Evaluating performance on  train set...
1577/1577 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1704197
{'0': {'precision': 0.3052047619868029, 'recall': 0.6012966147719044, 'f1-score': 0.4048942338093733, 'support': 88384}, '1': {'precision': 0.6266666666666667, 'recall': 0.00020597141817894972, 'f1-score': 0.00041180748438198215, 'support': 228187}, '2': {'precision': 0.2736343575833166, 'recall': 0.7217244274721356, 'f1-score': 0.3968189220382931, 'support': 86939}, 'accuracy': 0.2873237342321132, 'macro avg': {'precision': 0.4018352620789287, 'recall': 0.4410756712207397, 'f1-score': 0.26737498777734947, 'support': 403510}, 'weighted avg': {'precision': 0.4801910777032644, 'recall': 0.2873237342321132, 'f1-score': 0.1744174403076342, 'support': 403510}}
[[ 53145     13  35226]
 [ 96806     47 131334]
 [ 24178     15  62746]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1714976
{'0': {'precision': 0.3080827560670812, 'recall': 0.6152637416810451, 'f1-score': 0.4105764189446198, 'support': 32456}, '1': {'precision': 0.5, 'recall': 0.0001134738896579897, 'f1-score': 0.00022689628570780296, 'support': 88126}, '2': {'precision': 0.2750612212655028, 'recall': 0.7415723500060849, 'f1-score': 0.4012808587351108, 'support': 32868}, 'accuracy': 0.28903877484522644, 'macro avg': {'precision': 0.36104799244419467, 'recall': 0.45231652185892934, 'f1-score': 0.27069472465514616, 'support': 153450}, 'weighted avg': {'precision': 0.41122741056674966, 'recall': 0.28903877484522644, 'f1-score': 0.17292253489896703, 'support': 153450}}
[[19969     5 12482]
 [36359    10 51757]
 [ 8489     5 24374]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/WBA
Evaluating performance on  test set...
2451/2451 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977092
{'0': {'precision': 0.39876463621235064, 'recall': 0.4843926425059188, 'f1-score': 0.4374275353380862, 'support': 219640}, '1': {'precision': 0.3055555555555556, 'recall': 5.5665480823241855e-05, 'f1-score': 0.00011131068329580814, 'support': 197609}, '2': {'precision': 0.3746133809712702, 'recall': 0.6428115837172994, 'f1-score': 0.47336330257542697, 'support': 210088}, 'accuracy': 0.38488085351254586, 'macro avg': {'precision': 0.35964452424639215, 'recall': 0.3757532972346805, 'f1-score': 0.30363404953226963, 'support': 627337}, 'weighted avg': {'precision': 0.36131611630901844, 'recall': 0.38488085351254586, 'f1-score': 0.31170890504774784, 'support': 627337}}
[[106392     18 113230]
 [ 85378     11 112220]
 [ 75034      7 135047]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008924
{'0': {'precision': 0.39296113340383304, 'recall': 0.5286477111063473, 'f1-score': 0.45081599415010304, 'support': 102626}, '1': {'precision': 0.2727272727272727, 'recall': 2.92201151272536e-05, 'f1-score': 5.8433969614335804e-05, 'support': 102669}, '2': {'precision': 0.37989527556725733, 'recall': 0.6307702887231932, 'f1-score': 0.47419574015538685, 'support': 101793}, 'accuracy': 0.38576564372427447, 'macro avg': {'precision': 0.3485278938994543, 'recall': 0.38648240664822264, 'f1-score': 0.30835672275836806, 'support': 307088}, 'weighted avg': {'precision': 0.3484321934629681, 'recall': 0.38576564372427447, 'f1-score': 0.3078637021000889, 'support': 307088}}
[[54253     2 48371]
 [46230     3 56436]
 [37579     6 64208]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054978
{'0': {'precision': 0.3935545705043728, 'recall': 0.521538950042337, 'f1-score': 0.4485968545872499, 'support': 37792}, '1': {'precision': 0.3888888888888889, 'recall': 0.00017988384643059053, 'f1-score': 0.00035960135621082915, 'support': 38914}, '2': {'precision': 0.3688252386882524, 'recall': 0.6411957366492728, 'f1-score': 0.46828566215969675, 'support': 36028}, 'accuracy': 0.3798144304291518, 'macro avg': {'precision': 0.383756232693838, 'recall': 0.3876381901793468, 'f1-score': 0.3057473727010525, 'support': 112734}, 'weighted avg': {'precision': 0.3840409481627889, 'recall': 0.3798144304291518, 'f1-score': 0.30016465034529505, 'support': 112734}}
[[19710     4 18078]
 [17452     7 21455]
 [12920     7 23101]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
3337/3337 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1129835
{'0': {'precision': 0.38094274783748766, 'recall': 0.5455642307311473, 'f1-score': 0.448628541357873, 'support': 272681}, '1': {'precision': 0.4339622641509434, 'recall': 7.247404326385278e-05, 'f1-score': 0.00014492388345599356, 'support': 317355}, '2': {'precision': 0.36185661328396407, 'recall': 0.6352767812835015, 'f1-score': 0.46107994341700265, 'support': 263981}, 'accuracy': 0.3705886416780931, 'macro avg': {'precision': 0.3922538750907984, 'recall': 0.3936378286859709, 'f1-score': 0.3032844695527772, 'support': 854017}, 'weighted avg': {'precision': 0.3947453205193934, 'recall': 0.3705886416780931, 'f1-score': 0.2858196220311822, 'support': 854017}}
[[148765     16 123900]
 [145487     23 171845]
 [ 96266     14 167701]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959725
{'0': {'precision': 0.3964615978194581, 'recall': 0.5310897890112455, 'f1-score': 0.45400548007682084, 'support': 119959}, '1': {'precision': 0.5161290322580645, 'recall': 0.00013277016654357767, 'f1-score': 0.0002654720424755268, 'support': 120509}, '2': {'precision': 0.3957814987754466, 'recall': 0.646985784555628, 'f1-score': 0.4911258870336748, 'support': 125638}, 'accuracy': 0.3960902033837195, 'macro avg': {'precision': 0.4361240429509898, 'recall': 0.39273611457780566, 'f1-score': 0.31513227971765706, 'support': 366106}, 'weighted avg': {'precision': 0.4356184446700164, 'recall': 0.3960902033837195, 'f1-score': 0.3173892516102956, 'support': 366106}}
[[63709     5 56245]
 [52643    16 67850]
 [44342    10 81286]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865291
{'0': {'precision': 0.41124073639986297, 'recall': 0.5170131253825403, 'f1-score': 0.45810067087132933, 'support': 44113}, '1': {'precision': 0.5555555555555556, 'recall': 0.00013381506757660912, 'f1-score': 0.00026756568737625085, 'support': 37365}, '2': {'precision': 0.4034843205574913, 'recall': 0.640356618891773, 'f1-score': 0.4950444948525563, 'support': 44305}, 'accuracy': 0.40691508391436043, 'macro avg': {'precision': 0.45676020417096996, 'recall': 0.38583451978062994, 'f1-score': 0.317804243803754, 'support': 125783}, 'weighted avg': {'precision': 0.45137871382015166, 'recall': 0.40691508391436043, 'f1-score': 0.3351099817185014, 'support': 125783}}
[[22807     4 21302]
 [16718     5 20642]
 [15934     0 28371]]
testing model on single stock: results/universal/W9/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
10303/10303 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1230714
{'0': {'precision': 0.3559171452162841, 'recall': 0.5219558831025296, 'f1-score': 0.4232344356187017, 'support': 804363}, '1': {'precision': 0.3088235294117647, 'recall': 4.1313534313841214e-05, 'f1-score': 8.261601649173053e-05, 'support': 1016616}, '2': {'precision': 0.3477797947117911, 'recall': 0.6209345423500865, 'f1-score': 0.44584554890133543, 'support': 816421}, 'accuracy': 0.35141730492151363, 'macro avg': {'precision': 0.33750682311328, 'recall': 0.3809772463289766, 'f1-score': 0.28972086684550963, 'support': 2637400}, 'weighted avg': {'precision': 0.335245412767298, 'recall': 0.35141730492151363, 'f1-score': 0.2671251148788067, 'support': 2637400}}
[[419842     49 384472]
 [450332     42 566242]
 [309432     45 506944]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036069
{'0': {'precision': 0.38381746400644856, 'recall': 0.45558127922284264, 'f1-score': 0.41663167273139506, 'support': 286377}, '1': {'precision': 0.3157894736842105, 'recall': 4.1394012356112685e-05, 'f1-score': 8.277717419421595e-05, 'support': 289897}, '2': {'precision': 0.3778113689827782, 'recall': 0.6765346511464506, 'f1-score': 0.4848550245062777, 'support': 298879}, 'accuracy': 0.3801415295382636, 'macro avg': {'precision': 0.3591394355578124, 'recall': 0.37738577479388313, 'f1-score': 0.30052315813728897, 'support': 875153}, 'weighted avg': {'precision': 0.35923181328591686, 'recall': 0.3801415295382636, 'f1-score': 0.30194801396518994, 'support': 875153}}
[[130468     10 155899]
 [112793     12 177092]
 [ 96661     16 202202]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10536
{'0': {'precision': 0.39026795988821306, 'recall': 0.4589367514183652, 'f1-score': 0.4218259915637892, 'support': 118975}, '1': {'precision': 0.4157303370786517, 'recall': 0.0003075337455947869, 'f1-score': 0.0006146128354415661, 'support': 120312}, '2': {'precision': 0.3678176261575566, 'recall': 0.6773663109536443, 'f1-score': 0.47675296124946687, 'support': 117979}, 'accuracy': 0.3766213409616364, 'macro avg': {'precision': 0.39127197437480715, 'recall': 0.3788701987058681, 'f1-score': 0.2997311885495659, 'support': 357266}, 'weighted avg': {'precision': 0.39142889208250786, 'recall': 0.3766213409616364, 'f1-score': 0.2981182935432152, 'support': 357266}}
[[54602    36 64337]
 [47259    37 73016]
 [38048    16 79915]]
training model: results/universal/W9/deepOF_L1/h200
Epoch 1/50
6697/6697 - 97s - loss: 3.2480 - accuracy200: 0.3949 - val_loss: 3.2797 - val_accuracy200: 0.3630 - 97s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 96s - loss: 3.2453 - accuracy200: 0.3959 - val_loss: 3.2770 - val_accuracy200: 0.3680 - 96s/epoch - 14ms/step
Epoch 3/50
6697/6697 - 95s - loss: 3.2420 - accuracy200: 0.3970 - val_loss: 3.2779 - val_accuracy200: 0.3673 - 95s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 96s - loss: 3.2381 - accuracy200: 0.3986 - val_loss: 3.2758 - val_accuracy200: 0.3686 - 96s/epoch - 14ms/step
Epoch 5/50
6697/6697 - 96s - loss: 3.2353 - accuracy200: 0.3998 - val_loss: 3.2762 - val_accuracy200: 0.3695 - 96s/epoch - 14ms/step
Epoch 6/50
6697/6697 - 95s - loss: 3.2321 - accuracy200: 0.4016 - val_loss: 3.2773 - val_accuracy200: 0.3691 - 95s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 96s - loss: 3.2293 - accuracy200: 0.4029 - val_loss: 3.2770 - val_accuracy200: 0.3704 - 96s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 97s - loss: 3.2263 - accuracy200: 0.4044 - val_loss: 3.2767 - val_accuracy200: 0.3712 - 97s/epoch - 15ms/step
Epoch 9/50
6697/6697 - 97s - loss: 3.2243 - accuracy200: 0.4055 - val_loss: 3.2770 - val_accuracy200: 0.3703 - 97s/epoch - 15ms/step
Epoch 10/50
6697/6697 - 96s - loss: 3.2215 - accuracy200: 0.4066 - val_loss: 3.2779 - val_accuracy200: 0.3706 - 96s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 97s - loss: 3.2198 - accuracy200: 0.4074 - val_loss: 3.2774 - val_accuracy200: 0.3716 - 97s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 96s - loss: 3.2170 - accuracy200: 0.4085 - val_loss: 3.2776 - val_accuracy200: 0.3708 - 96s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 95s - loss: 3.2146 - accuracy200: 0.4095 - val_loss: 3.2783 - val_accuracy200: 0.3706 - 95s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 97s - loss: 3.2125 - accuracy200: 0.4104 - val_loss: 3.2776 - val_accuracy200: 0.3702 - 97s/epoch - 14ms/step
testing model in sample: results/universal/W9/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 84s - 84s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097725
{'0': {'precision': 0.35107711960449683, 'recall': 0.49443766613413864, 'f1-score': 0.4106037045790986, 'support': 1335141}, '1': {'precision': 0.4050815233047186, 'recall': 0.004310165148412883, 'f1-score': 0.008529573575912415, 'support': 1631260}, '2': {'precision': 0.3431090714445763, 'recall': 0.6164925164489012, 'f1-score': 0.44085832608020514, 'support': 1341275}, 'accuracy': 0.3468369023111302, 'macro avg': {'precision': 0.3664225714512639, 'recall': 0.37174678257715094, 'f1-score': 0.28666386807840544, 'support': 4307676}, 'weighted avg': {'precision': 0.3690468740113571, 'recall': 0.3468369023111302, 'f1-score': 0.2677638810904331, 'support': 4307676}}
[[660144   4858 670139]
 [711274   7031 912955]
 [508921   5468 826886]]
Evaluating performance on  train set...
6697/6697 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918537
{'0': {'precision': 0.3800666067528213, 'recall': 0.476043323460106, 'f1-score': 0.42267508933068604, 'support': 561451}, '1': {'precision': 0.3676516009471842, 'recall': 0.006104784845226353, 'f1-score': 0.01201014354324459, 'support': 584951}, '2': {'precision': 0.37061736929276545, 'recall': 0.6536468656458719, 'f1-score': 0.4730280986656687, 'support': 567597}, 'accuracy': 0.3744774646893026, 'macro avg': {'precision': 0.372778525664257, 'recall': 0.37859832465040144, 'f1-score': 0.3025711105131998, 'support': 1713999}, 'weighted avg': {'precision': 0.3727004829128257, 'recall': 0.3744774646893026, 'f1-score': 0.29919855657669875, 'support': 1713999}}
[[267275   3040 291136]
 [242470   3571 338910]
 [193487   3102 371008]]
Evaluating performance on  val set...
2631/2631 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928359
{'0': {'precision': 0.37867436185183206, 'recall': 0.47928503147376583, 'f1-score': 0.42308052071081287, 'support': 221772}, '1': {'precision': 0.3758565094719871, 'recall': 0.007956348867766761, 'f1-score': 0.015582831312717763, 'support': 234404}, '2': {'precision': 0.36180812379909505, 'recall': 0.6465256658159851, 'f1-score': 0.4639698491630196, 'support': 216689}, 'accuracy': 0.3689477086785611, 'macro avg': {'precision': 0.3721129983743048, 'recall': 0.3779223487191726, 'f1-score': 0.30087773372885007, 'support': 672865}, 'weighted avg': {'precision': 0.3722611227523772, 'recall': 0.3689477086785611, 'f1-score': 0.29428972212165927, 'support': 672865}}
[[106292   1638 113842]
 [ 99268   1865 133271]
 [ 75135   1459 140095]]
testing model out of sample: results/universal/W9/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09506
{'0': {'precision': 0.3767954766280744, 'recall': 0.49914566785934816, 'f1-score': 0.42942572343249974, 'support': 709326}, '1': {'precision': 0.3956543002864529, 'recall': 0.006775682204591383, 'f1-score': 0.013323201144341342, 'support': 835783}, '2': {'precision': 0.3384473074286114, 'recall': 0.6387947715989798, 'f1-score': 0.44246635523979605, 'support': 666131}, 'accuracy': 0.3551134205242307, 'macro avg': {'precision': 0.3702990281143796, 'recall': 0.38157204055430644, 'f1-score': 0.295071759938879, 'support': 2211240}, 'weighted avg': {'precision': 0.3723712530777873, 'recall': 0.3551134205242307, 'f1-score': 0.27607979749088424, 'support': 2211240}}
[[354057   4530 350739]
 [349106   5663 481014]
 [236490   4120 425521]]
Evaluating performance on  train set...
3947/3947 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944399
{'0': {'precision': 0.36464709883325486, 'recall': 0.4902574563871694, 'f1-score': 0.4182243691679919, 'support': 312752}, '1': {'precision': 0.4219986324118394, 'recall': 0.011455786498082748, 'f1-score': 0.022306041994222117, 'support': 377102}, '2': {'precision': 0.35260714760793366, 'recall': 0.6383929688477418, 'f1-score': 0.45429242653056906, 'support': 319720}, 'accuracy': 0.35832539269038227, 'macro avg': {'precision': 0.379750959617676, 'recall': 0.38003540391099794, 'f1-score': 0.2982742792309277, 'support': 1009574}, 'weighted avg': {'precision': 0.38225647150904857, 'recall': 0.35832539269038227, 'f1-score': 0.2817609561701139, 'support': 1009574}}
[[153329   2954 156469]
 [154507   4320 218275]
 [112650   2963 204107]]
Evaluating performance on  val set...
1402/1402 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944165
{'0': {'precision': 0.37214853391922315, 'recall': 0.4916461366181411, 'f1-score': 0.42363166893740856, 'support': 111625}, '1': {'precision': 0.4097094520044134, 'recall': 0.008233615917338635, 'f1-score': 0.016142821950760045, 'support': 135299}, '2': {'precision': 0.34708296884462686, 'recall': 0.6487059478785809, 'f1-score': 0.45221388291360204, 'support': 111317}, 'accuracy': 0.3578764016402366, 'macro avg': {'precision': 0.37631365158942115, 'recall': 0.38286190013802024, 'f1-score': 0.29732945793392357, 'support': 358241}, 'weighted avg': {'precision': 0.37854571109492136, 'recall': 0.3578764016402366, 'f1-score': 0.27861435602442924, 'support': 358241}}
[[54880   815 55930]
 [54273  1114 79912]
 [38315   790 72212]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895542
{'0': {'precision': 0.40672910385528255, 'recall': 0.4537679811064195, 'f1-score': 0.4289628577227522, 'support': 27946}, '1': {'precision': 0.2983425414364641, 'recall': 0.009971378450743237, 'f1-score': 0.01929777539533637, 'support': 21662}, '2': {'precision': 0.38317843010950586, 'recall': 0.6465336542193929, 'f1-score': 0.4811786797631085, 'support': 25762}, 'accuracy': 0.3921056123125912, 'macro avg': {'precision': 0.3627500251337508, 'recall': 0.37009100459218525, 'f1-score': 0.3098131042937324, 'support': 75370}, 'weighted avg': {'precision': 0.3675280666766287, 'recall': 0.3921056123125912, 'f1-score': 0.32906925276092625, 'support': 75370}}
[[12681   285 14980]
 [ 9614   216 11832]
 [ 8883   223 16656]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960113
{'0': {'precision': 0.36497746209534215, 'recall': 0.46901878181499035, 'f1-score': 0.4105085266554002, 'support': 17091}, '1': {'precision': 0.3699421965317919, 'recall': 0.011399394407172119, 'f1-score': 0.02211726759589909, 'support': 16843}, '2': {'precision': 0.36602311210417904, 'recall': 0.6098539933686231, 'f1-score': 0.4574769821529868, 'support': 17191}, 'accuracy': 0.36561369193154036, 'macro avg': {'precision': 0.3669809235771044, 'recall': 0.36342405653026183, 'f1-score': 0.2967009254680954, 'support': 51125}, 'weighted avg': {'precision': 0.3669646853993037, 'recall': 0.36561369193154036, 'f1-score': 0.2983473675770596, 'support': 51125}}
[[ 8016   170  8905]
 [ 7397   192  9254]
 [ 6550   157 10484]]
Evaluating performance on  val set...
53/53 - 0s - 460ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998411
{'0': {'precision': 0.35719769673704416, 'recall': 0.4222827320172453, 'f1-score': 0.3870229801393366, 'support': 4407}, '1': {'precision': 0.3977272727272727, 'recall': 0.007100831811726517, 'f1-score': 0.013952561291608531, 'support': 4929}, '2': {'precision': 0.33585920312881934, 'recall': 0.6631274131274131, 'f1-score': 0.4458867434690897, 'support': 4144}, 'accuracy': 0.3445103857566766, 'macro avg': {'precision': 0.36359472419771205, 'recall': 0.3641703256521283, 'f1-score': 0.28228742830001163, 'support': 13480}, 'weighted avg': {'precision': 0.3654576049375896, 'recall': 0.3445103857566766, 'f1-score': 0.2687045336065506, 'support': 13480}}
[[1861   25 2521]
 [1981   35 2913]
 [1368   28 2748]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096819
{'0': {'precision': 0.3295638244716809, 'recall': 0.5706451900199753, 'f1-score': 0.41782299046527765, 'support': 78597}, '1': {'precision': 0.4264629725530813, 'recall': 0.013003418627969587, 'f1-score': 0.025237318132714272, 'support': 126659}, '2': {'precision': 0.3410283244071437, 'recall': 0.6163145728518981, 'f1-score': 0.4390918378130835, 'support': 80897}, 'accuracy': 0.3367289526931397, 'macro avg': {'precision': 0.365685040477302, 'recall': 0.39998772716661435, 'f1-score': 0.2940507154703585, 'support': 286153}, 'weighted avg': {'precision': 0.37569506492039617, 'recall': 0.3367289526931397, 'f1-score': 0.250066850469979, 'support': 286153}}
[[44851  1120 32626]
 [61297  1647 63715]
 [29944  1095 49858]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923213
{'0': {'precision': 0.3722011916685057, 'recall': 0.5655257795775193, 'f1-score': 0.44893529893529893, 'support': 38771}, '1': {'precision': 0.4543589743589744, 'recall': 0.008151323900123282, 'f1-score': 0.016015328440764975, 'support': 54347}, '2': {'precision': 0.3393045158870956, 'recall': 0.6516801019418821, 'f1-score': 0.44625920024281057, 'support': 36099}, 'accuracy': 0.3551699853734416, 'macro avg': {'precision': 0.3886215606381919, 'recall': 0.40845240180650827, 'f1-score': 0.3037366092062915, 'support': 129217}, 'weighted avg': {'precision': 0.3975654387632825, 'recall': 0.3551699853734416, 'f1-score': 0.2661071406963166, 'support': 129217}}
[[21926   254 16591]
 [24687   443 29217]
 [12296   278 23525]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912718
{'0': {'precision': 0.36044421916040736, 'recall': 0.5540444822212778, 'f1-score': 0.4367514447639521, 'support': 14118}, '1': {'precision': 0.42548596112311016, 'recall': 0.009775219570287302, 'f1-score': 0.01911136980985642, 'support': 20153}, '2': {'precision': 0.3463952898974539, 'recall': 0.6561299852289513, 'f1-score': 0.453415673565213, 'support': 13540}, 'accuracy': 0.3535378887703666, 'macro avg': {'precision': 0.3774418233936571, 'recall': 0.4066498956735054, 'f1-score': 0.3030928293796738, 'support': 47811}, 'weighted avg': {'precision': 0.38388158134806205, 'recall': 0.3535378887703666, 'f1-score': 0.2654296407318085, 'support': 47811}}
[[ 7822   140  6156]
 [ 9349   197 10607]
 [ 4530   126  8884]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
508/508 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957782
{'0': {'precision': 0.40414889240163704, 'recall': 0.43255770835264673, 'f1-score': 0.4178710161313795, 'support': 43148}, '1': {'precision': 0.29826989619377164, 'recall': 0.0099805483512412, 'f1-score': 0.01931479531246499, 'support': 43184}, '2': {'precision': 0.3523331184861788, 'recall': 0.6656710245157733, 'f1-score': 0.46077994783383164, 'support': 43523}, 'accuracy': 0.3701590235262408, 'macro avg': {'precision': 0.35158396902719585, 'recall': 0.3694030937398871, 'f1-score': 0.2993219197592254, 'support': 129855}, 'weighted avg': {'precision': 0.3515713520653932, 'recall': 0.3701590235262408, 'f1-score': 0.2997105571166463, 'support': 129855}}
[[18664   508 23976]
 [13472   431 29281]
 [14045   506 28972]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952345
{'0': {'precision': 0.37050201539025285, 'recall': 0.44995772328779315, 'f1-score': 0.4063825083901047, 'support': 22471}, '1': {'precision': 0.38055555555555554, 'recall': 0.012452847338999228, 'f1-score': 0.024116533908374777, 'support': 22003}, '2': {'precision': 0.36454797901882136, 'recall': 0.6321562332798288, 'f1-score': 0.462426614481409, 'support': 22428}, 'accuracy': 0.3671489641565275, 'macro avg': {'precision': 0.3718685166548766, 'recall': 0.36485560130220707, 'f1-score': 0.29764188559329613, 'support': 66902}, 'weighted avg': {'precision': 0.37181245329223916, 'recall': 0.3671489641565275, 'f1-score': 0.2994493670026166, 'support': 66902}}
[[10111   242 12118]
 [ 9133   274 12596]
 [ 8046   204 14178]]
Evaluating performance on  val set...
73/73 - 1s - 551ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974463
{'0': {'precision': 0.385989010989011, 'recall': 0.4266626176738536, 'f1-score': 0.4053079474974758, 'support': 6586}, '1': {'precision': 0.3430232558139535, 'recall': 0.009844818955448023, 'f1-score': 0.019140308191403083, 'support': 5993}, '2': {'precision': 0.3416659226854745, 'recall': 0.6300625617385578, 'f1-score': 0.44306801736613605, 'support': 6074}, 'accuracy': 0.3589771082399614, 'macro avg': {'precision': 0.35689272982947967, 'recall': 0.35552333278928644, 'f1-score': 0.28917209101833835, 'support': 18653}, 'weighted avg': {'precision': 0.3577516116902494, 'recall': 0.3589771082399614, 'f1-score': 0.29353246913050796, 'support': 18653}}
[[2810   55 3721]
 [2281   59 3653]
 [2189   58 3827]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981975
{'0': {'precision': 0.37137662690726203, 'recall': 0.4629347227517262, 'f1-score': 0.4121318399517291, 'support': 47214}, '1': {'precision': 0.3819124423963134, 'recall': 0.010977366425484709, 'f1-score': 0.021341316208777942, 'support': 60397}, '2': {'precision': 0.32839114029290756, 'recall': 0.6583541680022224, 'f1-score': 0.43820360558973087, 'support': 46797}, 'accuracy': 0.34537718252940264, 'macro avg': {'precision': 0.3605600698654943, 'recall': 0.3774220857264778, 'f1-score': 0.29055892058341265, 'support': 154408}, 'weighted avg': {'precision': 0.3624699629455521, 'recall': 0.34537718252940264, 'f1-score': 0.2671750058113902, 'support': 154408}}
[[21857   490 24867]
 [21592   663 38142]
 [15405   583 30809]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093487
{'0': {'precision': 0.40340236686390535, 'recall': 0.46821881116719893, 'f1-score': 0.4334006134676817, 'support': 29121}, '1': {'precision': 0.3298076923076923, 'recall': 0.01268491124260355, 'f1-score': 0.024430199430199428, 'support': 27040}, '2': {'precision': 0.3584893817344911, 'recall': 0.6472010274231321, 'f1-score': 0.46140381585856816, 'support': 26474}, 'accuracy': 0.3764990621407394, 'macro avg': {'precision': 0.3638998136353629, 'recall': 0.3760349166109782, 'f1-score': 0.3064115429188164, 'support': 82635}, 'weighted avg': {'precision': 0.36493166597062626, 'recall': 0.3764990621407394, 'f1-score': 0.30854790922036285, 'support': 82635}}
[[13635   400 15086]
 [11122   343 15575]
 [ 9043   297 17134]]
Evaluating performance on  val set...
112/112 - 1s - 736ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939357
{'0': {'precision': 0.391741935483871, 'recall': 0.451830538743923, 'f1-score': 0.41964614817545154, 'support': 10079}, '1': {'precision': 0.31869918699186994, 'recall': 0.02315963606286187, 'f1-score': 0.04318131747080855, 'support': 8463}, '2': {'precision': 0.3743130595862921, 'recall': 0.6127564944910543, 'f1-score': 0.46473474394357556, 'support': 9893}, 'accuracy': 0.3802356251098998, 'macro avg': {'precision': 0.361584727354011, 'recall': 0.3625822230992797, 'f1-score': 0.3091874031966119, 'support': 28435}, 'weighted avg': {'precision': 0.363938712352429, 'recall': 0.3802356251098998, 'f1-score': 0.32328742180585973, 'support': 28435}}
[[4554  224 5301]
 [3435  196 4832]
 [3636  195 6062]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931461
{'0': {'precision': 0.4218510017774863, 'recall': 0.3795453839704375, 'f1-score': 0.3995815386627218, 'support': 64406}, '1': {'precision': 0.2631077216396568, 'recall': 0.0071172541839655485, 'f1-score': 0.01385959626393492, 'support': 38779}, '2': {'precision': 0.37444774602181646, 'recall': 0.6591476109361827, 'f1-score': 0.47758793719261716, 'support': 58119}, 'accuracy': 0.39075286415711946, 'macro avg': {'precision': 0.35313548981298654, 'recall': 0.3486034163635286, 'f1-score': 0.29700969070642463, 'support': 161304}, 'weighted avg': {'precision': 0.36660788640695197, 'recall': 0.39075286415711946, 'f1-score': 0.3349566234211682, 'support': 161304}}
[[24445   471 39490]
 [13994   276 24509]
 [19508   302 38309]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963773
{'0': {'precision': 0.3593496245629454, 'recall': 0.46842000398485756, 'f1-score': 0.406699030175909, 'support': 40152}, '1': {'precision': 0.39730423620025673, 'recall': 0.01537849991304564, 'f1-score': 0.02961084933865914, 'support': 40251}, '2': {'precision': 0.366302143046124, 'recall': 0.6001011365825467, 'f1-score': 0.4549205016337781, 'support': 41528}, 'accuracy': 0.36371390376524426, 'macro avg': {'precision': 0.37431866793644203, 'recall': 0.36129988016014997, 'f1-score': 0.29707679371611545, 'support': 121931}, 'weighted avg': {'precision': 0.37424686366196747, 'recall': 0.36371390376524426, 'f1-score': 0.2986409063175157, 'support': 121931}}
[[18808   480 20864]
 [17383   619 22249]
 [16148   459 24921]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964465
{'0': {'precision': 0.36158388329281, 'recall': 0.4693417493237151, 'f1-score': 0.4084755738669806, 'support': 15526}, '1': {'precision': 0.37357954545454547, 'recall': 0.01603072046812142, 'f1-score': 0.030742255990648743, 'support': 16406}, '2': {'precision': 0.3494888154354677, 'recall': 0.6085123469182895, 'f1-score': 0.4439833011889358, 'support': 14943}, 'accuracy': 0.3550506666666667, 'macro avg': {'precision': 0.361550748060941, 'recall': 0.3646282722367087, 'f1-score': 0.2944003770155217, 'support': 46875}, 'weighted avg': {'precision': 0.36192658696071756, 'recall': 0.3550506666666667, 'f1-score': 0.287590222534562, 'support': 46875}}
[[7287  210 8029]
 [7247  263 8896]
 [5619  231 9093]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/EXC
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0882659
{'0': {'precision': 0.38773345613213955, 'recall': 0.5415451933468646, 'f1-score': 0.4519100693550835, 'support': 189685}, '1': {'precision': 0.4381491973559962, 'recall': 0.0061953125695414935, 'f1-score': 0.012217867753869651, 'support': 224686}, '2': {'precision': 0.37042621361837325, 'recall': 0.658603137117235, 'f1-score': 0.4741630861843164, 'support': 188007}, 'accuracy': 0.3783952933208052, 'macro avg': {'precision': 0.39876962236883634, 'recall': 0.4021145476778803, 'f1-score': 0.3127636744310898, 'support': 602378}, 'weighted avg': {'precision': 0.4011367153636151, 'recall': 0.3783952933208052, 'f1-score': 0.2948509485472905, 'support': 602378}}
[[102723    733  86229]
 [ 99076   1392 124218]
 [ 63133   1052 123822]]
Evaluating performance on  train set...
1250/1250 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0805637
{'0': {'precision': 0.4143350540349835, 'recall': 0.5478634073521179, 'f1-score': 0.47183408329668103, 'support': 101821}, '1': {'precision': 0.4207295052365475, 'recall': 0.010189801451937375, 'f1-score': 0.019897693404725917, 'support': 114330}, '2': {'precision': 0.39719016777898325, 'recall': 0.6986458483928485, 'f1-score': 0.5064539906447704, 'support': 103755}, 'accuracy': 0.40460947903446637, 'macro avg': {'precision': 0.41075157568350473, 'recall': 0.4188996857323013, 'f1-score': 0.33272858911539244, 'support': 319906}, 'weighted avg': {'precision': 0.4110597479525203, 'recall': 0.40460947903446637, 'f1-score': 0.3215465020401675, 'support': 319906}}
[[55784   717 45320]
 [48471  1165 64694]
 [30380   887 72488]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0819362
{'0': {'precision': 0.40758226037195994, 'recall': 0.5681381957773513, 'f1-score': 0.47465039516019875, 'support': 40117}, '1': {'precision': 0.467365028203062, 'recall': 0.01233753802301589, 'f1-score': 0.024040454281687804, 'support': 47011}, '2': {'precision': 0.3886233407238907, 'recall': 0.6835228279861234, 'f1-score': 0.49551625072281535, 'support': 39491}, 'accuracy': 0.39776810747202235, 'macro avg': {'precision': 0.4211902097663042, 'recall': 0.4213328539288302, 'f1-score': 0.3314023667215673, 'support': 126619}, 'weighted avg': {'precision': 0.4238652905861145, 'recall': 0.39776810747202235, 'f1-score': 0.3138561191935872, 'support': 126619}}
[[22792   314 17011]
 [20977   580 25454]
 [12151   347 26993]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/AAL
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0922736
{'0': {'precision': 0.39212803545956243, 'recall': 0.52192124201504, 'f1-score': 0.44780944822016794, 'support': 309175}, '1': {'precision': 0.43251633986928106, 'recall': 0.00676841881860791, 'f1-score': 0.013328264531056065, 'support': 391081}, '2': {'precision': 0.33771854054440786, 'recall': 0.6663521990924053, 'f1-score': 0.4482542579568524, 'support': 290438}, 'accuracy': 0.36090457800289494, 'macro avg': {'precision': 0.38745430529108377, 'recall': 0.39834728664201774, 'f1-score': 0.30313065690269214, 'support': 990694}, 'weighted avg': {'precision': 0.3921204787293203, 'recall': 0.36090457800289494, 'f1-score': 0.2764264115327363, 'support': 990694}}
[[161365   1717 146093]
 [154998   2647 233436]
 [ 95148   1756 193534]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952134
{'0': {'precision': 0.363126783530371, 'recall': 0.49830425509597565, 'f1-score': 0.4201093604916801, 'support': 114404}, '1': {'precision': 0.486391365556077, 'recall': 0.011777873733012137, 'f1-score': 0.022998835080712265, 'support': 176008}, '2': {'precision': 0.3242602866389274, 'recall': 0.6945657748147624, 'f1-score': 0.44211687500351765, 'support': 113098}, 'accuracy': 0.34109439666922753, 'macro avg': {'precision': 0.3912594785751251, 'recall': 0.4015493012145834, 'f1-score': 0.2950750235253033, 'support': 403510}, 'weighted avg': {'precision': 0.4060001435158781, 'recall': 0.34109439666922753, 'f1-score': 0.2530611498394687, 'support': 403510}}
[[ 57008   1115  56281]
 [ 66514   2073 107421]
 [ 33470   1074  78554]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944992
{'0': {'precision': 0.3670212765957447, 'recall': 0.510275190215459, 'f1-score': 0.42695225345827753, 'support': 42189}, '1': {'precision': 0.4793467819404419, 'recall': 0.007347311384651629, 'f1-score': 0.014472787389242571, 'support': 67916}, '2': {'precision': 0.32905613687028684, 'recall': 0.7117314569154458, 'f1-score': 0.4500430349093349, 'support': 43345}, 'accuracy': 0.3445878136200717, 'macro avg': {'precision': 0.39180806513549116, 'recall': 0.4097846528385188, 'f1-score': 0.29715602525228496, 'support': 153450}, 'weighted avg': {'precision': 0.4060118275217172, 'recall': 0.3445878136200717, 'f1-score': 0.25091389897441635, 'support': 153450}}
[[21528   268 20393]
 [24907   499 42510]
 [12221   274 30850]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/WBA
Evaluating performance on  test set...
2451/2451 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975147
{'0': {'precision': 0.3632366827025353, 'recall': 0.46837733524548353, 'f1-score': 0.4091605620776273, 'support': 207794}, '1': {'precision': 0.3894736842105263, 'recall': 0.0037400869317503055, 'f1-score': 0.0074090255402035204, 'support': 217642}, '2': {'precision': 0.3476096119292707, 'recall': 0.6151678297779605, 'f1-score': 0.4442111776140141, 'support': 201901}, 'accuracy': 0.3544235395010975, 'macro avg': {'precision': 0.36677332628077747, 'recall': 0.3624284173183981, 'f1-score': 0.2869269217439483, 'support': 627337}, 'weighted avg': {'precision': 0.367309696514903, 'recall': 0.3544235395010975, 'f1-score': 0.2810615441850656, 'support': 627337}}
[[ 97326    632 109836]
 [ 93561    814 123267]
 [ 77054    644 124203]]
Evaluating performance on  train set...
1200/1200 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09302
{'0': {'precision': 0.3767545662770893, 'recall': 0.49364190762009197, 'f1-score': 0.42734971562757623, 'support': 103962}, '1': {'precision': 0.3464566929133858, 'recall': 0.008301804351496012, 'f1-score': 0.016215062940046935, 'support': 100701}, '2': {'precision': 0.3678936714571498, 'recall': 0.6050768855259946, 'f1-score': 0.45757593656325213, 'support': 102425}, 'accuracy': 0.3716556817589746, 'macro avg': {'precision': 0.36370164354920825, 'recall': 0.36900686583252745, 'f1-score': 0.30038023837695843, 'support': 307088}, 'weighted avg': {'precision': 0.36386378807171943, 'recall': 0.3716556817589746, 'f1-score': 0.3026110414333704, 'support': 307088}}
[[51320   792 51850]
 [45231   836 54634]
 [39665   785 61975]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936344
{'0': {'precision': 0.3826189784656238, 'recall': 0.4801239163824747, 'f1-score': 0.42586157132136465, 'support': 38413}, '1': {'precision': 0.39880444064901793, 'recall': 0.012334918119387216, 'f1-score': 0.02392969690758628, 'support': 37860}, '2': {'precision': 0.35932198039803664, 'recall': 0.624420613806533, 'f1-score': 0.4561519504718399, 'support': 36461}, 'accuracy': 0.3696932602409211, 'macro avg': {'precision': 0.3802484665042261, 'recall': 0.3722931494361316, 'f1-score': 0.3019810729002636, 'support': 112734}, 'weighted avg': {'precision': 0.380519787021348, 'recall': 0.3696932602409211, 'f1-score': 0.3006755293899138, 'support': 112734}}
[[18443   379 19591]
 [16390   467 21003]
 [13369   325 22767]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
3337/3337 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990316
{'0': {'precision': 0.34958014849431246, 'recall': 0.5189551522571235, 'f1-score': 0.41775255198257716, 'support': 264651}, '1': {'precision': 0.4222958972233734, 'recall': 0.0059751903529115125, 'f1-score': 0.011783650329716712, 'support': 341077}, '2': {'precision': 0.3246317228925696, 'recall': 0.5966192622307069, 'f1-score': 0.42047507603572504, 'support': 248289}, 'accuracy': 0.33666074562918535, 'macro avg': {'precision': 0.3655025895367518, 'recall': 0.3738498682802473, 'f1-score': 0.283337092782673, 'support': 854017}, 'weighted avg': {'precision': 0.3713680634714508, 'recall': 0.33666074562918535, 'f1-score': 0.25640836059713557, 'support': 854017}}
[[137342   1492 125817]
 [156676   2038 182363]
 [ 98859   1296 148134]]
Evaluating performance on  train set...
1431/1431 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926672
{'0': {'precision': 0.36825683198536907, 'recall': 0.5024023467134211, 'f1-score': 0.4249954542699558, 'support': 118634}, '1': {'precision': 0.39393028846153844, 'recall': 0.010746165889325147, 'f1-score': 0.02092160383004189, 'support': 121997}, '2': {'precision': 0.37848195133604406, 'recall': 0.6060808926080893, 'f1-score': 0.4659746816828225, 'support': 125475}, 'accuracy': 0.3741020360223542, 'macro avg': {'precision': 0.3802230239276505, 'recall': 0.37307646840361186, 'f1-score': 0.30396391326094, 'support': 366106}, 'weighted avg': {'precision': 0.3803164035855318, 'recall': 0.3741020360223542, 'f1-score': 0.30439123316325795, 'support': 366106}}
[[59602   986 58046]
 [53851  1311 66835]
 [48396  1031 76048]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926086
{'0': {'precision': 0.37969669937555756, 'recall': 0.4958874105832188, 'f1-score': 0.4300827548576798, 'support': 42917}, '1': {'precision': 0.3772455089820359, 'recall': 0.006291349394582449, 'f1-score': 0.01237629840630602, 'support': 40055}, '2': {'precision': 0.37301093173097805, 'recall': 0.6017612295905258, 'f1-score': 0.46054560406163964, 'support': 42811}, 'accuracy': 0.37601265671831646, 'macro avg': {'precision': 0.3766510466961905, 'recall': 0.3679799965227757, 'f1-score': 0.30100155244187515, 'support': 125783}, 'weighted avg': {'precision': 0.37664058821709734, 'recall': 0.37601265671831646, 'f1-score': 0.30743432799642634, 'support': 125783}}
[[21282   216 21419]
 [17919   252 21884]
 [16849   200 25762]]
testing model on single stock: results/universal/W9/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
10303/10303 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000073
{'0': {'precision': 0.34138093514972756, 'recall': 0.4845778350953562, 'f1-score': 0.40056632475395115, 'support': 811851}, '1': {'precision': 0.38335358444714457, 'recall': 0.002519273842271898, 'f1-score': 0.005005652182535747, 'support': 1001876}, '2': {'precision': 0.3370862060452252, 'recall': 0.6050410781948662, 'f1-score': 0.4329584865270606, 'support': 823673}, 'accuracy': 0.33907825889133236, 'macro avg': {'precision': 0.35394024188069917, 'recall': 0.3640460623774981, 'f1-score': 0.27951015448784916, 'support': 2637400}, 'weighted avg': {'precision': 0.35598392960707426, 'recall': 0.33907825889133236, 'f1-score': 0.26041989443279506, 'support': 2637400}}
[[393405   1993 416453]
 [435738   2524 563614]
 [323250   2067 498356]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953095
{'0': {'precision': 0.36815252100345247, 'recall': 0.4342822195040587, 'f1-score': 0.39849245269783373, 'support': 287776}, '1': {'precision': 0.3453628249902988, 'recall': 0.0030845691827277987, 'f1-score': 0.006114527154683795, 'support': 288533}, '2': {'precision': 0.36796108855991655, 'recall': 0.6564060178554697, 'f1-score': 0.4715728792045694, 'support': 298844}, 'accuracy': 0.3679688008839597, 'macro avg': {'precision': 0.3604921448512226, 'recall': 0.36459093551408545, 'f1-score': 0.292059953019029, 'support': 875153}, 'weighted avg': {'precision': 0.3605735173356146, 'recall': 0.3679688008839597, 'f1-score': 0.29408290029755313, 'support': 875153}}
[[124976    828 161972]
 [112670    890 174973]
 [101822    859 196163]]
Evaluating performance on  val set...
1396/1396 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965484
{'0': {'precision': 0.366610158849752, 'recall': 0.44143811163845603, 'f1-score': 0.4005594768053417, 'support': 119045}, '1': {'precision': 0.31093007467752887, 'recall': 0.0037877221565205885, 'f1-score': 0.007484271590816243, 'support': 120917}, '2': {'precision': 0.3538008943280772, 'recall': 0.6407709882015958, 'f1-score': 0.4558852963117961, 'support': 117304}, 'accuracy': 0.35876349834577037, 'macro avg': {'precision': 0.34378037595178607, 'recall': 0.3619989406655241, 'f1-score': 0.28797634823598467, 'support': 357266}, 'weighted avg': {'precision': 0.3435594159766456, 'recall': 0.35876349834577037, 'f1-score': 0.28568838731588664, 'support': 357266}}
[[52551   569 65925]
 [49099   458 71360]
 [41693   446 75165]]
training model: results/universal/W9/deepLOB_L2/h50
Epoch 1/50
6697/6697 - 283s - loss: 2.9951 - accuracy50: 0.4765 - val_loss: 3.2333 - val_accuracy50: 0.3580 - 283s/epoch - 42ms/step
Epoch 2/50
6697/6697 - 276s - loss: 2.9461 - accuracy50: 0.4940 - val_loss: 3.2495 - val_accuracy50: 0.3635 - 276s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 276s - loss: 2.9253 - accuracy50: 0.4995 - val_loss: 3.2269 - val_accuracy50: 0.3779 - 276s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 276s - loss: 2.8972 - accuracy50: 0.5071 - val_loss: 3.1923 - val_accuracy50: 0.4045 - 276s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 277s - loss: 2.8673 - accuracy50: 0.5147 - val_loss: 3.1915 - val_accuracy50: 0.3980 - 277s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 278s - loss: 2.8476 - accuracy50: 0.5196 - val_loss: 3.1831 - val_accuracy50: 0.4104 - 278s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 277s - loss: 2.8324 - accuracy50: 0.5233 - val_loss: 3.2151 - val_accuracy50: 0.4029 - 277s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 277s - loss: 2.8223 - accuracy50: 0.5255 - val_loss: 3.1797 - val_accuracy50: 0.4143 - 277s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 278s - loss: 2.8130 - accuracy50: 0.5280 - val_loss: 3.1928 - val_accuracy50: 0.4033 - 278s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 279s - loss: 2.8056 - accuracy50: 0.5294 - val_loss: 3.1860 - val_accuracy50: 0.4135 - 279s/epoch - 42ms/step
Epoch 11/50
6697/6697 - 279s - loss: 2.7990 - accuracy50: 0.5308 - val_loss: 3.1911 - val_accuracy50: 0.4173 - 279s/epoch - 42ms/step
Epoch 12/50
6697/6697 - 282s - loss: 2.7938 - accuracy50: 0.5320 - val_loss: 3.1875 - val_accuracy50: 0.4124 - 282s/epoch - 42ms/step
Epoch 13/50
6697/6697 - 279s - loss: 2.7880 - accuracy50: 0.5333 - val_loss: 3.2034 - val_accuracy50: 0.4116 - 279s/epoch - 42ms/step
Epoch 14/50
6697/6697 - 281s - loss: 2.7832 - accuracy50: 0.5344 - val_loss: 3.2481 - val_accuracy50: 0.4080 - 281s/epoch - 42ms/step
Epoch 15/50
6697/6697 - 278s - loss: 2.7791 - accuracy50: 0.5354 - val_loss: 3.2439 - val_accuracy50: 0.4022 - 278s/epoch - 42ms/step
Epoch 16/50
6697/6697 - 279s - loss: 2.7752 - accuracy50: 0.5362 - val_loss: 3.2665 - val_accuracy50: 0.3981 - 279s/epoch - 42ms/step
Epoch 17/50
6697/6697 - 278s - loss: 2.7722 - accuracy50: 0.5368 - val_loss: 3.3147 - val_accuracy50: 0.3941 - 278s/epoch - 42ms/step
Epoch 18/50
6697/6697 - 277s - loss: 2.7688 - accuracy50: 0.5375 - val_loss: 3.3468 - val_accuracy50: 0.3978 - 277s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 225s - 225s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0941674
{'0': {'precision': 0.34182913679975424, 'recall': 0.5755559125037583, 'f1-score': 0.42891865504135435, 'support': 1213995}, '1': {'precision': 0.5876889321466437, 'recall': 0.18719420697164157, 'f1-score': 0.2839446570598527, 'support': 1877291}, '2': {'precision': 0.36577348825872236, 'recall': 0.5008631957974696, 'f1-score': 0.42278957638809855, 'support': 1216410}, 'accuracy': 0.38521636624311467, 'macro avg': {'precision': 0.43176385240170684, 'recall': 0.42120443842428984, 'f1-score': 0.3785509628297685, 'support': 4307696}, 'weighted avg': {'precision': 0.45573609068525606, 'recall': 0.38521636624311467, 'f1-score': 0.3640083516658845, 'support': 4307696}}
[[698722 111950 403323]
 [872789 351418 653084]
 [472557 134598 609255]]
Evaluating performance on  train set...
6697/6697 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0613819
{'0': {'precision': 0.3633986349231222, 'recall': 0.6516101972713076, 'f1-score': 0.4665856072965097, 'support': 491151}, '1': {'precision': 0.5637454936316335, 'recall': 0.3286512025109382, 'f1-score': 0.4152315560849155, 'support': 721324}, '2': {'precision': 0.40445390813118026, 'recall': 0.3329033158534883, 'f1-score': 0.36520710110943894, 'support': 501530}, 'accuracy': 0.42243984119066164, 'macro avg': {'precision': 0.4438660122286453, 'recall': 0.4377215718785781, 'f1-score': 0.4156747548302881, 'support': 1714005}, 'weighted avg': {'precision': 0.4597259202478999, 'recall': 0.42243984119066164, 'f1-score': 0.4153096356137238, 'support': 1714005}}
[[320039  79156  91956]
 [330371 237064 153889]
 [230273 104296 166961]]
Evaluating performance on  val set...
2631/2631 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0650764
{'0': {'precision': 0.35739151650758133, 'recall': 0.6224381396553957, 'f1-score': 0.454066906965711, 'support': 192975}, '1': {'precision': 0.5116586856606589, 'recall': 0.3669818191859883, 'f1-score': 0.427409012514925, 'support': 289701}, '2': {'precision': 0.4032947013450134, 'recall': 0.2735288550517372, 'f1-score': 0.32597192241538653, 'support': 190192}, 'accuracy': 0.41383005284840413, 'macro avg': {'precision': 0.4241149678377512, 'recall': 0.42098293796437375, 'f1-score': 0.40248261396534085, 'support': 672868}, 'weighted avg': {'precision': 0.43678564983152685, 'recall': 0.41383005284840413, 'f1-score': 0.4063822793985174, 'support': 672868}}
[[120115  46012  26848]
 [133262 106315  50124]
 [ 82711  55458  52023]]
testing model out of sample: results/universal/W9/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 119s - 119s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0947193
{'0': {'precision': 0.36048727496354016, 'recall': 0.6615374818467895, 'f1-score': 0.46667332181161364, 'support': 565327}, '1': {'precision': 0.602618345679473, 'recall': 0.23568523853222725, 'f1-score': 0.33884681211024337, 'support': 1096246}, '2': {'precision': 0.3565449291545929, 'recall': 0.48327866585893425, 'f1-score': 0.41034940838456546, 'support': 549687}, 'accuracy': 0.40610602100160087, 'macro avg': {'precision': 0.43988351659920205, 'recall': 0.46016712874598364, 'f1-score': 0.4052898474354742, 'support': 2211260}, 'weighted avg': {'precision': 0.4795452606854254, 'recall': 0.40610602100160087, 'f1-score': 0.38930122492836056, 'support': 2211260}}
[[373985  66915 124427]
 [482883 258369 354994]
 [180575 103460 265652]]
Evaluating performance on  train set...
3947/3947 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0415362
{'0': {'precision': 0.35269504011290875, 'recall': 0.6011156041956587, 'f1-score': 0.4445546784350955, 'support': 259411}, '1': {'precision': 0.6233331128327451, 'recall': 0.3274490044132467, 'f1-score': 0.42935138032699005, 'support': 489209}, '2': {'precision': 0.3909231462990401, 'recall': 0.46507867166363936, 'f1-score': 0.42478885859388393, 'support': 260958}, 'accuracy': 0.4333424460517167, 'macro avg': {'precision': 0.45565043308156467, 'recall': 0.46454776009084825, 'f1-score': 0.4328983057853231, 'support': 1009578}, 'weighted avg': {'precision': 0.4937188253492341, 'recall': 0.4333424460517167, 'f1-score': 0.4320785358504799, 'support': 1009578}}
[[155936  42084  61391]
 [201315 160191 127703]
 [ 84876  54716 121366]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0536543
{'0': {'precision': 0.33583664711438665, 'recall': 0.6211567288923399, 'f1-score': 0.4359637138434639, 'support': 92727}, '1': {'precision': 0.6156221544795915, 'recall': 0.2700027781636338, 'f1-score': 0.37537265693835925, 'support': 172776}, '2': {'precision': 0.3980929893023549, 'recall': 0.47630446737618476, 'f1-score': 0.43370087089711234, 'support': 92739}, 'accuracy': 0.41430094740426865, 'macro avg': {'precision': 0.4498505969654443, 'recall': 0.45582132481071946, 'f1-score': 0.4150124138929785, 'support': 358242}, 'weighted avg': {'precision': 0.4868904368394904, 'recall': 0.41430094740426865, 'f1-score': 0.40615555555985094, 'support': 358242}}
[[57598 12856 22273]
 [81612 46650 44514]
 [32296 16271 44172]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1095477
{'0': {'precision': 0.37415357622611506, 'recall': 0.5555419872186266, 'f1-score': 0.4471528733372649, 'support': 24567}, '1': {'precision': 0.3382480485689506, 'recall': 0.19883587543017378, 'f1-score': 0.25044818451823514, 'support': 23537}, '2': {'precision': 0.4318662463588843, 'recall': 0.3968830216354969, 'f1-score': 0.4136362767766716, 'support': 27270}, 'accuracy': 0.3867513996868947, 'macro avg': {'precision': 0.38142262371798336, 'recall': 0.38375362809476576, 'f1-score': 0.3704124448773906, 'support': 75374}, 'weighted avg': {'precision': 0.38382157991510507, 'recall': 0.3867513996868947, 'f1-score': 0.37360183652164036, 'support': 75374}}
[[13648  4061  6858]
 [11477  4680  7380]
 [11352  5095 10823]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.105069
{'0': {'precision': 0.4019312586643721, 'recall': 0.48444342014289005, 'f1-score': 0.4393468321358589, 'support': 17356}, '1': {'precision': 0.388966237382527, 'recall': 0.266388557806913, 'f1-score': 0.316213921901528, 'support': 16780}, '2': {'precision': 0.4064002564376536, 'recall': 0.4476549167304184, 'f1-score': 0.426031194869928, 'support': 16993}, 'accuracy': 0.40065324962350135, 'macro avg': {'precision': 0.39909925082818426, 'recall': 0.3994956315600738, 'f1-score': 0.393863982969105, 'support': 51129}, 'weighted avg': {'precision': 0.3991615706605389, 'recall': 0.40065324962350135, 'f1-score': 0.394510382023554, 'support': 51129}}
[[8408 3495 5453]
 [6652 4470 5658]
 [5859 3527 7607]]
Evaluating performance on  val set...
53/53 - 1s - 899ms/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1082627
{'0': {'precision': 0.36486893642663454, 'recall': 0.5537265660722451, 'f1-score': 0.4398837631674537, 'support': 4374}, '1': {'precision': 0.41447721179624664, 'recall': 0.15954592363261094, 'f1-score': 0.2304023845007451, 'support': 4845}, '2': {'precision': 0.39140044203335345, 'recall': 0.45716967847923023, 'f1-score': 0.4217363065598614, 'support': 4261}, 'accuracy': 0.38152818991097925, 'macro avg': {'precision': 0.3902488634187449, 'recall': 0.39014738939469545, 'f1-score': 0.3640074847426867, 'support': 13480}, 'weighted avg': {'precision': 0.3910857642868719, 'recall': 0.38152818991097925, 'f1-score': 0.3588553067694452, 'support': 13480}}
[[2422  540 1412]
 [2455  773 1617]
 [1761  552 1948]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.968515
{'0': {'precision': 0.23455652553884734, 'recall': 0.6210417767046454, 'f1-score': 0.3405088602358133, 'support': 39759}, '1': {'precision': 0.7877760048120703, 'recall': 0.4603465194276425, 'f1-score': 0.5811127270934503, 'support': 204837}, '2': {'precision': 0.331148773432265, 'recall': 0.48752436178147784, 'f1-score': 0.3944018375053529, 'support': 41561}, 'accuracy': 0.4866209807902655, 'macro avg': {'precision': 0.4511604345943942, 'recall': 0.5229708859712553, 'f1-score': 0.43867447494487216, 'support': 286157}, 'weighted avg': {'precision': 0.6445911879465029, 'recall': 0.4866209807902655, 'f1-score': 0.5205653337933958, 'support': 286157}}
[[24692 11776  3291]
 [72907 94296 37634]
 [ 7672 13627 20262]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9782569
{'0': {'precision': 0.2833364157573516, 'recall': 0.6746587072466604, 'f1-score': 0.39907380607814763, 'support': 20437}, '1': {'precision': 0.8414338919925513, 'recall': 0.4070354022160166, 'f1-score': 0.5486612834679134, 'support': 88808}, '2': {'precision': 0.31611427355429056, 'recall': 0.5950330462647707, 'f1-score': 0.4128826043150471, 'support': 19972}, 'accuracy': 0.47842002213331064, 'macro avg': {'precision': 0.4802948604347311, 'recall': 0.5589090519091493, 'f1-score': 0.45353923128703605, 'support': 129217}, 'weighted avg': {'precision': 0.6719707289314392, 'recall': 0.47842002213331064, 'f1-score': 0.5040162982457237, 'support': 129217}}
[[13788  2932  3717]
 [30667 36148 21993]
 [ 4208  3880 11884]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9626366
{'0': {'precision': 0.25752031554436156, 'recall': 0.7267972103004292, 'f1-score': 0.3802940454051019, 'support': 7456}, '1': {'precision': 0.8440548294548932, 'recall': 0.4034558420186506, 'f1-score': 0.5459494010185777, 'support': 32814}, '2': {'precision': 0.37744700045106, 'recall': 0.55468646427151, 'f1-score': 0.44921623362679836, 'support': 7543}, 'accuracy': 0.4777361805366741, 'macro avg': {'precision': 0.49300738181677156, 'recall': 0.5616465055301966, 'f1-score': 0.458486560016826, 'support': 47813}, 'weighted avg': {'precision': 0.6789778798827509, 'recall': 0.4777361805366741, 'f1-score': 0.5048562963589607, 'support': 47813}}
[[ 5419   940  1097]
 [13771 13239  5804]
 [ 1853  1506  4184]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0780538
{'0': {'precision': 0.4483348134991119, 'recall': 0.46904833801769996, 'f1-score': 0.45845773120977173, 'support': 43051}, '1': {'precision': 0.45123802413836006, 'recall': 0.43490670120401015, 'f1-score': 0.4429218725192052, 'support': 41694}, '2': {'precision': 0.45339875431285565, 'recall': 0.4485747218158443, 'f1-score': 0.45097383785711104, 'support': 45114}, 'accuracy': 0.4509737484502422, 'macro avg': {'precision': 0.4509905306501092, 'recall': 0.4508432536791848, 'f1-score': 0.450784480528696, 'support': 129859}, 'weighted avg': {'precision': 0.4510262025461864, 'recall': 0.4509737484502422, 'f1-score': 0.45086965139276697, 'support': 129859}}
[[20193  9939 12919]
 [12083 18133 11478]
 [12764 12113 20237]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1099031
{'0': {'precision': 0.4085523481258078, 'recall': 0.5009024078883655, 'f1-score': 0.45003856117384167, 'support': 22717}, '1': {'precision': 0.4194272217301447, 'recall': 0.3241011133418507, 'f1-score': 0.365653393735039, 'support': 21916}, '2': {'precision': 0.42690481573592587, 'recall': 0.42395257981948, 'f1-score': 0.4254235760634463, 'support': 22269}, 'accuracy': 0.41737167797674213, 'macro avg': {'precision': 0.4182947951972928, 'recall': 0.41631870034989876, 'f1-score': 0.41370517699077564, 'support': 66902}, 'weighted avg': {'precision': 0.41822358114010283, 'recall': 0.41737167797674213, 'f1-score': 0.4142020176772019, 'support': 66902}}
[[11379  4546  6792]
 [ 8931  7103  5882]
 [ 7542  5286  9441]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1369871
{'0': {'precision': 0.39956104886219246, 'recall': 0.54046875, 'f1-score': 0.45945407451683606, 'support': 6400}, '1': {'precision': 0.390251474697299, 'recall': 0.21175876010781672, 'f1-score': 0.27454406464999453, 'support': 5936}, '2': {'precision': 0.4132231404958678, 'recall': 0.44317822095599874, 'f1-score': 0.4276767985336795, 'support': 6318}, 'accuracy': 0.40291626460812696, 'macro avg': {'precision': 0.40101188801845306, 'recall': 0.39846857702127186, 'f1-score': 0.3872249792335034, 'support': 18654}, 'weighted avg': {'precision': 0.4012258640599384, 'recall': 0.40291626460812696, 'f1-score': 0.38984998701650614, 'support': 18654}}
[[3459  952 1989]
 [2692 1257 1987]
 [2506 1012 2800]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1631044
{'0': {'precision': 0.3556789136127707, 'recall': 0.46540544977019044, 'f1-score': 0.4032104669042815, 'support': 48736}, '1': {'precision': 0.39033557046979867, 'recall': 0.16957680773075642, 'f1-score': 0.2364364945699518, 'support': 60020}, '2': {'precision': 0.3228324505157513, 'recall': 0.4565445943578062, 'f1-score': 0.37821850447279126, 'support': 45656}, 'accuracy': 0.34779680335725205, 'macro avg': {'precision': 0.35628231153277357, 'recall': 0.3638422839529177, 'f1-score': 0.3392884886490082, 'support': 154412}, 'weighted avg': {'precision': 0.35943804130622264, 'recall': 0.34779680335725205, 'f1-score': 0.33099582778116554, 'support': 154412}}
[[22682  7793 18261]
 [24381 10178 25461]
 [16708  8104 20844]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1683489
{'0': {'precision': 0.3922121059343397, 'recall': 0.45041209726857845, 'f1-score': 0.41930216705505624, 'support': 29362}, '1': {'precision': 0.3295655245496291, 'recall': 0.13707988980716254, 'f1-score': 0.1936236997068666, 'support': 27225}, '2': {'precision': 0.33842306873802935, 'recall': 0.48840601965601965, 'f1-score': 0.399811439346323, 'support': 26048}, 'accuracy': 0.35915774187692867, 'macro avg': {'precision': 0.35340023307399937, 'recall': 0.3586326689105869, 'f1-score': 0.33757910203608194, 'support': 82635}, 'weighted avg': {'precision': 0.35461726090392603, 'recall': 0.35915774187692867, 'f1-score': 0.33880612120388487, 'support': 82635}}
[[13225  3706 12431]
 [11054  3732 12439]
 [ 9440  3886 12722]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1542863
{'0': {'precision': 0.40971652538510617, 'recall': 0.42842165459397635, 'f1-score': 0.41886036434794754, 'support': 10492}, '1': {'precision': 0.27560718057022177, 'recall': 0.16215208747514911, 'f1-score': 0.20417742314010795, 'support': 8048}, '2': {'precision': 0.36692851531814613, 'recall': 0.4720088924818108, 'f1-score': 0.41288782816229114, 'support': 9896}, 'accuracy': 0.3682304121536081, 'macro avg': {'precision': 0.35075074042449134, 'recall': 0.3541942115169788, 'f1-score': 0.34530853855011556, 'support': 28436}, 'weighted avg': {'precision': 0.35687005771409663, 'recall': 0.3682304121536081, 'f1-score': 0.35602197185484197, 'support': 28436}}
[[4495 1587 4410]
 [3094 1305 3649]
 [3382 1843 4671]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0983444
{'0': {'precision': 0.4694299446999845, 'recall': 0.42921950066944947, 'f1-score': 0.4484251061448836, 'support': 63485}, '1': {'precision': 0.3230851063829787, 'recall': 0.0772812865794697, 'f1-score': 0.12472791490410284, 'support': 39298}, '2': {'precision': 0.40571696444742755, 'recall': 0.6506791969243912, 'f1-score': 0.4997965692386439, 'support': 58525}, 'accuracy': 0.42382894834726115, 'macro avg': {'precision': 0.39941067184346357, 'recall': 0.38572666139110345, 'f1-score': 0.35764986342921007, 'support': 161308}, 'weighted avg': {'precision': 0.41066124367174905, 'recall': 0.42382894834726115, 'f1-score': 0.3882040548404357, 'support': 161308}}
[[27249  3243 32993]
 [13474  3037 22787]
 [17324  3120 38081]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077394
{'0': {'precision': 0.3986144204393008, 'recall': 0.491652672132767, 'f1-score': 0.4402720185768784, 'support': 40492}, '1': {'precision': 0.40612428101206904, 'recall': 0.3032221229272168, 'f1-score': 0.3472093915663507, 'support': 40284}, '2': {'precision': 0.4185774617642146, 'recall': 0.42626655327420726, 'f1-score': 0.4223870175523078, 'support': 41155}, 'accuracy': 0.4073287351042803, 'macro avg': {'precision': 0.4077720544051948, 'recall': 0.40704711611139704, 'f1-score': 0.40328947589851233, 'support': 121931}, 'weighted avg': {'precision': 0.40783361973267346, 'recall': 0.4073287351042803, 'f1-score': 0.4034889848638908, 'support': 121931}}
[[19908  8465 12119]
 [15820 12215 12249]
 [14215  9397 17543]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1227561
{'0': {'precision': 0.386872938232283, 'recall': 0.44986772486772486, 'f1-score': 0.41599902146657697, 'support': 15120}, '1': {'precision': 0.436717761215019, 'recall': 0.36576173370237325, 'f1-score': 0.3981027465307823, 'support': 16981}, '2': {'precision': 0.3930727887996815, 'recall': 0.4009746852578855, 'f1-score': 0.3969844195007539, 'support': 14774}, 'accuracy': 0.4039893333333333, 'macro avg': {'precision': 0.40555449608232785, 'recall': 0.40553471460932783, 'f1-score': 0.40369539583270436, 'support': 46875}, 'weighted avg': {'precision': 0.4068838509011382, 'recall': 0.4039893333333333, 'f1-score': 0.4035228961518506, 'support': 46875}}
[[6802 3714 4604]
 [6227 6211 4543]
 [4553 4297 5924]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.076246
{'0': {'precision': 0.2722733780775559, 'recall': 0.8110652681811403, 'f1-score': 0.4076868875151794, 'support': 100585}, '1': {'precision': 0.8378679849727385, 'recall': 0.232685621389611, 'f1-score': 0.3642224575531531, 'support': 403523}, '2': {'precision': 0.3241229220200325, 'recall': 0.6289252498117508, 'f1-score': 0.42778339170277263, 'support': 98274}, 'accuracy': 0.393906192416108, 'macro avg': {'precision': 0.4780880950234423, 'recall': 0.5575587131275007, 'f1-score': 0.39989757892370176, 'support': 602382}, 'weighted avg': {'precision': 0.6596121342813729, 'recall': 0.393906192416108, 'f1-score': 0.38184957278958137, 'support': 602382}}
[[ 81581   5705  13299]
 [194045  93894 115584]
 [ 24003  12464  61807]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97914064
{'0': {'precision': 0.30677230597093913, 'recall': 0.7809468822170901, 'f1-score': 0.44050500993301994, 'support': 51960}, '1': {'precision': 0.8480284868622492, 'recall': 0.34911460837819036, 'f1-score': 0.49460943184073014, 'support': 214199}, '2': {'precision': 0.3623858745927684, 'recall': 0.6705365781052318, 'f1-score': 0.47049608355091393, 'support': 53748}, 'accuracy': 0.473256290109313, 'macro avg': {'precision': 0.5057288891419855, 'recall': 0.6001993562335041, 'f1-score': 0.468536841774888, 'support': 319907}, 'weighted avg': {'precision': 0.6785230046959554, 'recall': 0.473256290109313, 'f1-score': 0.481770356715129, 'support': 319907}}
[[40578  4697  6685]
 [82692 74780 56727]
 [ 9004  8704 36040]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0196255
{'0': {'precision': 0.2771937276556582, 'recall': 0.7629579111457522, 'f1-score': 0.406646761002207, 'support': 20528}, '1': {'precision': 0.8516133452079194, 'recall': 0.29120595952023987, 'f1-score': 0.4340054115387972, 'support': 85376}, '2': {'precision': 0.3535664540722821, 'recall': 0.6984793627805937, 'f1-score': 0.46948311106784774, 'support': 20715}, 'accuracy': 0.43431870414392787, 'macro avg': {'precision': 0.49412450897861987, 'recall': 0.584214411148862, 'f1-score': 0.4367117612029506, 'support': 126619}, 'weighted avg': {'precision': 0.6770050537272763, 'recall': 0.43431870414392787, 'f1-score': 0.4353741016052892, 'support': 126619}}
[[15662  1425  3441]
 [37501 24862 23013]
 [ 3339  2907 14469]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.173959
{'0': {'precision': 0.28300661877669353, 'recall': 0.7194223867521972, 'f1-score': 0.4062158936424154, 'support': 176935}, '1': {'precision': 0.8167820196590951, 'recall': 0.13711657342214353, 'f1-score': 0.2348139573342153, 'support': 647223}, '2': {'precision': 0.27134049714873976, 'recall': 0.7042812537528522, 'f1-score': 0.3917502358864739, 'support': 166540}, 'accuracy': 0.3364567204132844, 'macro avg': {'precision': 0.4570430451948428, 'recall': 0.5202734046423977, 'f1-score': 0.3442600289543682, 'support': 990698}, 'weighted avg': {'precision': 0.6297609681237107, 'recall': 0.3364567204132844, 'f1-score': 0.29180727863978423, 'support': 990698}}
[[127291   9456  40188]
 [283692  88745 274786]
 [ 38798  10451 117291]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.02695
{'0': {'precision': 0.25753124143064204, 'recall': 0.7276608529276893, 'f1-score': 0.38042408961269786, 'support': 63241}, '1': {'precision': 0.8498014840217603, 'recall': 0.2985774172610531, 'f1-score': 0.4418951480219511, 'support': 278859}, '2': {'precision': 0.2953628078584718, 'recall': 0.6100797915648917, 'f1-score': 0.39802607115917854, 'support': 61410}, 'accuracy': 0.41323387276647416, 'macro avg': {'precision': 0.4675651777702914, 'recall': 0.545439353917878, 'f1-score': 0.4067817695979425, 'support': 403510}, 'weighted avg': {'precision': 0.672596850890258, 'recall': 0.41323387276647416, 'f1-score': 0.42558454552138747, 'support': 403510}}
[[ 46018   5740  11483]
 [117702  83261  77896]
 [ 14969   8976  37465]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0436064
{'0': {'precision': 0.22656720324564847, 'recall': 0.7547630466059205, 'f1-score': 0.34851580822772704, 'support': 22937}, '1': {'precision': 0.8660072535443455, 'recall': 0.2447378474325168, 'f1-score': 0.3816262631399243, 'support': 107323}, '2': {'precision': 0.3095910939841576, 'recall': 0.6235877533419577, 'f1-score': 0.41376251788268953, 'support': 23190}, 'accuracy': 0.3782274356467905, 'macro avg': {'precision': 0.46738851692471717, 'recall': 0.5410295491267983, 'f1-score': 0.38130152975011367, 'support': 153450}, 'weighted avg': {'precision': 0.6863387805961411, 'recall': 0.3782274356467905, 'f1-score': 0.3815336286867712, 'support': 153450}}
[[17312  1409  4216]
 [53024 26266 28033]
 [ 6074  2655 14461]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
2451/2451 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0438508
{'0': {'precision': 0.44078215444494995, 'recall': 0.6127718708593219, 'f1-score': 0.5127385951425293, 'support': 216601}, '1': {'precision': 0.44188544510786404, 'recall': 0.3644056473522469, 'f1-score': 0.39942287143159344, 'support': 202077}, '2': {'precision': 0.4693349375544401, 'recall': 0.3589328246981976, 'f1-score': 0.40677597884000194, 'support': 208663}, 'accuracy': 0.44833830404835645, 'macro avg': {'precision': 0.45066751236908464, 'recall': 0.4453701143032555, 'f1-score': 0.4396458151380416, 'support': 627341}, 'weighted avg': {'precision': 0.45063462550815997, 'recall': 0.44833830404835645, 'f1-score': 0.4409929593465761, 'support': 627341}}
[[132727  40708  43166]
 [ 86922  73638  41517]
 [ 81468  52299  74896]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0015855
{'0': {'precision': 0.47212214206390246, 'recall': 0.5400698215671063, 'f1-score': 0.5038153436975586, 'support': 103120}, '1': {'precision': 0.5249230083192821, 'recall': 0.37219022023733067, 'f1-score': 0.43555529860669473, 'support': 101209}, '2': {'precision': 0.47323847661242224, 'recall': 0.5405058240806516, 'f1-score': 0.5046403764996615, 'support': 102763}, 'accuracy': 0.4848872650541206, 'macro avg': {'precision': 0.49009454233186894, 'recall': 0.4842552886283628, 'f1-score': 0.48133700626797166, 'support': 307092}, 'weighted avg': {'precision': 0.48989740407024013, 'recall': 0.4848872650541206, 'f1-score': 0.48159481024908474, 'support': 307092}}
[[55692 15275 32153]
 [33867 37669 29673]
 [28402 18817 55544]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0024921
{'0': {'precision': 0.4670874092773746, 'recall': 0.5778269355888094, 'f1-score': 0.5165891112145184, 'support': 38425}, '1': {'precision': 0.5118006705673526, 'recall': 0.4120573757476314, 'f1-score': 0.45654468684025334, 'support': 37786}, '2': {'precision': 0.47554418149926675, 'recall': 0.452810557730745, 'f1-score': 0.4638990182328191, 'support': 36523}, 'accuracy': 0.4817623786967552, 'macro avg': {'precision': 0.4848107537813313, 'recall': 0.48089828968906195, 'f1-score': 0.4790109387625303, 'support': 112734}, 'weighted avg': {'precision': 0.484814110919854, 'recall': 0.4817623786967552, 'f1-score': 0.47939324408147443, 'support': 112734}}
[[22203  6761  9461]
 [13438 15570  8778]
 [11894  8091 16538]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
3337/3337 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0033929
{'0': {'precision': 0.41425827918090263, 'recall': 0.7210141125349315, 'f1-score': 0.5261927757662399, 'support': 257289}, '1': {'precision': 0.5610054511944701, 'recall': 0.41793761284666786, 'f1-score': 0.4790171924775633, 'support': 344494}, '2': {'precision': 0.5304405963762787, 'recall': 0.31453627129932843, 'f1-score': 0.39490502926771, 'support': 252238}, 'accuracy': 0.4787048562037702, 'macro avg': {'precision': 0.5019014422505504, 'recall': 0.4844959988936426, 'f1-score': 0.4667049991705044, 'support': 854021}, 'weighted avg': {'precision': 0.5077678247311517, 'recall': 0.4787048562037702, 'f1-score': 0.46838686233935045, 'support': 854021}}
[[185509  40098  31682]
 [161967 143977  38550]
 [100334  72566  79338]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.014025
{'0': {'precision': 0.42690207808947095, 'recall': 0.6073785735911077, 'f1-score': 0.5013942295676639, 'support': 115605}, '1': {'precision': 0.531023184232736, 'recall': 0.40710969018801857, 'f1-score': 0.46088286619126617, 'support': 131370}, '2': {'precision': 0.4887972808260581, 'recall': 0.41404840050028957, 'f1-score': 0.4483285161149588, 'support': 119131}, 'accuracy': 0.472606294351909, 'macro avg': {'precision': 0.4822408477160884, 'recall': 0.4761788880931386, 'f1-score': 0.4702018706246296, 'support': 366106}, 'weighted avg': {'precision': 0.48440462410415824, 'recall': 0.472606294351909, 'f1-score': 0.4695899179308932, 'support': 366106}}
[[70216 19723 25666]
 [51967 53482 25921]
 [42295 27510 49326]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0217847
{'0': {'precision': 0.4446067415730337, 'recall': 0.6310142154182613, 'f1-score': 0.5216580662171834, 'support': 43896}, '1': {'precision': 0.4650940510781465, 'recall': 0.32275609561964397, 'f1-score': 0.38106723886791866, 'support': 37691}, '2': {'precision': 0.5066305891177968, 'recall': 0.427889401755815, 'f1-score': 0.46394269101971225, 'support': 44196}, 'accuracy': 0.4672730019159982, 'macro avg': {'precision': 0.47211046058965894, 'recall': 0.46055323759790673, 'f1-score': 0.45555599870160474, 'support': 125783}, 'weighted avg': {'precision': 0.47253891959904326, 'recall': 0.4672730019159982, 'f1-score': 0.45925060578255733, 'support': 125783}}
[[27699  6180 10017]
 [17127 12165  8399]
 [17474  7811 18911]]
testing model on single stock: results/universal/W9/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
10303/10303 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1198397
{'0': {'precision': 0.34293561749322765, 'recall': 0.5404793186806117, 'f1-score': 0.4196207270319035, 'support': 808314}, '1': {'precision': 0.45825504286944907, 'recall': 0.07872499339513762, 'f1-score': 0.13436672794818788, 'support': 1006834}, '2': {'precision': 0.3625876099534315, 'recall': 0.5249727578758927, 'f1-score': 0.42892545559331463, 'support': 822256}, 'accuracy': 0.35936928889165254, 'macro avg': {'precision': 0.3879260901053694, 'recall': 0.3813923566505473, 'f1-score': 0.327637636857802, 'support': 2637404}, 'weighted avg': {'precision': 0.3930858739733118, 'recall': 0.35936928889165254, 'f1-score': 0.31362537856596423, 'support': 2637404}}
[[436877  45770 325667]
 [494396  79263 433175]
 [342660  47934 431662]]
Evaluating performance on  train set...
3419/3419 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.114595
{'0': {'precision': 0.35906605656143326, 'recall': 0.6863786887994634, 'f1-score': 0.4714841031793642, 'support': 286272}, '1': {'precision': 0.4117905617543351, 'recall': 0.2940945139935767, 'f1-score': 0.34313048763063153, 'support': 289883}, '2': {'precision': 0.4185415563790365, 'recall': 0.16923133522185693, 'f1-score': 0.24101263411090867, 'support': 298999}, 'accuracy': 0.3797548774272871, 'macro avg': {'precision': 0.3964660582316016, 'recall': 0.38323484600496566, 'f1-score': 0.3518757416403015, 'support': 875154}, 'weighted avg': {'precision': 0.3968503239118625, 'recall': 0.3797548774272871, 'f1-score': 0.3502274215940519, 'support': 875154}}
[[196491  52834  36947]
 [171281  85253  33349]
 [179456  68943  50600]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077954
{'0': {'precision': 0.3617911133070815, 'recall': 0.6245240105449972, 'f1-score': 0.45816439715460394, 'support': 116074}, '1': {'precision': 0.40067491032659996, 'recall': 0.4053008903777143, 'f1-score': 0.4029746247107454, 'support': 125677}, '2': {'precision': 0.412045278962749, 'recall': 0.1061940007791196, 'f1-score': 0.16886692454882096, 'support': 115515}, 'accuracy': 0.3798150397742858, 'macro avg': {'precision': 0.3915037675321435, 'recall': 0.37867296723394367, 'f1-score': 0.3433353154713901, 'support': 357266}, 'weighted avg': {'precision': 0.39171813939894706, 'recall': 0.3798150397742858, 'f1-score': 0.3452113521419696, 'support': 357266}}
[[72491 35111  8472]
 [65708 50937  9032]
 [62168 41080 12267]]
training model: results/universal/W9/deepLOB_L2/h100
Epoch 1/50
6697/6697 - 279s - loss: 3.1446 - accuracy100: 0.4309 - val_loss: 3.3293 - val_accuracy100: 0.3659 - 279s/epoch - 42ms/step
Epoch 2/50
6697/6697 - 276s - loss: 3.1093 - accuracy100: 0.4454 - val_loss: 3.3076 - val_accuracy100: 0.3564 - 276s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 276s - loss: 3.0910 - accuracy100: 0.4511 - val_loss: 3.4536 - val_accuracy100: 0.3775 - 276s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 277s - loss: 3.0751 - accuracy100: 0.4563 - val_loss: 3.5556 - val_accuracy100: 0.3532 - 277s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 276s - loss: 3.0635 - accuracy100: 0.4601 - val_loss: 3.5606 - val_accuracy100: 0.3804 - 276s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 276s - loss: 3.0533 - accuracy100: 0.4633 - val_loss: 3.5092 - val_accuracy100: 0.3807 - 276s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 276s - loss: 3.0443 - accuracy100: 0.4663 - val_loss: 3.5664 - val_accuracy100: 0.3835 - 276s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 277s - loss: 3.0368 - accuracy100: 0.4682 - val_loss: 3.4490 - val_accuracy100: 0.3839 - 277s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 276s - loss: 3.0310 - accuracy100: 0.4694 - val_loss: 3.3822 - val_accuracy100: 0.3776 - 276s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 279s - loss: 3.0251 - accuracy100: 0.4713 - val_loss: 3.3779 - val_accuracy100: 0.3763 - 279s/epoch - 42ms/step
Epoch 11/50
6697/6697 - 276s - loss: 3.0195 - accuracy100: 0.4728 - val_loss: 3.3677 - val_accuracy100: 0.3640 - 276s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 277s - loss: 3.0148 - accuracy100: 0.4740 - val_loss: 3.3734 - val_accuracy100: 0.3645 - 277s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 229s - 229s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1149092
{'0': {'precision': 0.3091084436383571, 'recall': 0.7439804789634693, 'f1-score': 0.4367544715626442, 'support': 1277801}, '1': {'precision': 0.4283707959353963, 'recall': 0.25533830894067533, 'f1-score': 0.3199590991362949, 'support': 1751210}, '2': {'precision': 0.3619988533084176, 'recall': 0.05332744186410258, 'f1-score': 0.09296051335568654, 'support': 1278685}, 'accuracy': 0.3403209047249388, 'macro avg': {'precision': 0.36649269762739034, 'recall': 0.3508820765894158, 'f1-score': 0.2832246946848752, 'support': 4307696}, 'weighted avg': {'precision': 0.3732920808901639, 'recall': 0.3403209047249388, 'f1-score': 0.2872227029335184, 'support': 4307696}}
[[ 950659  280487   46655]
 [1230535  447151   73524]
 [ 894293  316203   68189]]
Evaluating performance on  train set...
6697/6697 - 96s - 96s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1020061
{'0': {'precision': 0.3312044988476465, 'recall': 0.6757774839282517, 'f1-score': 0.4445373337862211, 'support': 524834}, '1': {'precision': 0.42977266876467773, 'recall': 0.24999006793532239, 'f1-score': 0.31610705577302817, 'support': 654446}, '2': {'precision': 0.38792646918754164, 'recall': 0.19041750432465285, 'f1-score': 0.25544656297039636, 'support': 534725}, 'accuracy': 0.36178249188304584, 'macro avg': {'precision': 0.38296787893328865, 'recall': 0.37206168539607565, 'f1-score': 0.33869698417654853, 'support': 1714005}, 'weighted avg': {'precision': 0.38653584275826625, 'recall': 0.36178249188304584, 'f1-score': 0.33650833495067867, 'support': 1714005}}
[[354671 100020  70143]
 [400330 163605  90511]
 [315851 117053 101821]]
Evaluating performance on  val set...
2631/2631 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048299
{'0': {'precision': 0.3313209968034156, 'recall': 0.7205842731226666, 'f1-score': 0.45392813683430494, 'support': 207848}, '1': {'precision': 0.4087852810454206, 'recall': 0.24802264878631547, 'f1-score': 0.3087295496438895, 'support': 260323}, '2': {'precision': 0.40313628194729395, 'recall': 0.12383180994347744, 'f1-score': 0.18946534416647356, 'support': 204697}, 'accuracy': 0.356215483571815, 'macro avg': {'precision': 0.3810808532653767, 'recall': 0.36414624395081985, 'f1-score': 0.31737434354822264, 'support': 672868}, 'weighted avg': {'precision': 0.3831381560230961, 'recall': 0.356215483571815, 'f1-score': 0.3172991515297614, 'support': 672868}}
[[149772  43780  14296]
 [172524  64566  23233]
 [129749  49600  25348]]
testing model out of sample: results/universal/W9/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 123s - 123s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0986072
{'0': {'precision': 0.3159597234558667, 'recall': 0.7621083558069679, 'f1-score': 0.44671677044519664, 'support': 638526}, '1': {'precision': 0.48858407022261224, 'recall': 0.23531420338376077, 'f1-score': 0.3176434464960361, 'support': 960588}, '2': {'precision': 0.3800829875518672, 'recall': 0.12943644163320514, 'f1-score': 0.1931097682092977, 'support': 612146}, 'accuracy': 0.3581216139214746, 'macro avg': {'precision': 0.3948755937434487, 'recall': 0.37561966694131127, 'f1-score': 0.3191566617168435, 'support': 2211260}, 'weighted avg': {'precision': 0.4087003670867762, 'recall': 0.3581216139214746, 'f1-score': 0.32043998793369965, 'support': 2211260}}
[[486626 105418  46482]
 [651799 226040  82749]
 [401727 131185  79234]]
Evaluating performance on  train set...
3947/3947 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0980432
{'0': {'precision': 0.32044161205215704, 'recall': 0.7000221807872793, 'f1-score': 0.439635855103851, 'support': 288538}, '1': {'precision': 0.4776871599372101, 'recall': 0.2838862481675368, 'f1-score': 0.3561280217749647, 'support': 427703}, '2': {'precision': 0.33599584232829616, 'recall': 0.1432584365422705, 'f1-score': 0.20087140033508044, 'support': 293337}, 'accuracy': 0.3619581646985176, 'macro avg': {'precision': 0.37804153810588775, 'recall': 0.37572228849902883, 'f1-score': 0.33221175907129874, 'support': 1009578}, 'weighted avg': {'precision': 0.39157729826322013, 'recall': 0.3619581646985176, 'f1-score': 0.33488416706511454, 'support': 1009578}}
[[201983  58858  27697]
 [250934 121419  55350]
 [177410  73904  42023]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1039653
{'0': {'precision': 0.3083882375738785, 'recall': 0.7402536993788338, 'f1-score': 0.43539272208083857, 'support': 103193}, '1': {'precision': 0.4754944411936805, 'recall': 0.266917614289562, 'f1-score': 0.34190673740811955, 'support': 152223}, '2': {'precision': 0.3671875, 'recall': 0.08958823643825492, 'f1-score': 0.14403427302719016, 'support': 102826}, 'accuracy': 0.3523651609805662, 'macro avg': {'precision': 0.38369005958918634, 'recall': 0.3655865167022169, 'f1-score': 0.30711124417204944, 'support': 358242}, 'weighted avg': {'precision': 0.3962715694887447, 'recall': 0.3523651609805662, 'f1-score': 0.31204051623332274, 'support': 358242}}
[[ 76389  19808   6996]
 [102712  40631   8880]
 [ 68603  25011   9212]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.122345
{'0': {'precision': 0.314812318889413, 'recall': 0.7973203618364909, 'f1-score': 0.45139627017103096, 'support': 23436}, '1': {'precision': 0.37934105075690117, 'recall': 0.16892573900504687, 'f1-score': 0.23375651610006734, 'support': 27740}, '2': {'precision': 0.3620736698499318, 'recall': 0.054839242912637406, 'f1-score': 0.09525176757707353, 'support': 24198}, 'accuracy': 0.32768593944861624, 'macro avg': {'precision': 0.35207567983208204, 'recall': 0.3403617812513917, 'f1-score': 0.26013485128272396, 'support': 75374}, 'weighted avg': {'precision': 0.3537336603672005, 'recall': 0.32768593944861624, 'f1-score': 0.2569616978822164, 'support': 75374}}
[[18686  3681  1069]
 [21785  4686  1269]
 [18885  3986  1327]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1172265
{'0': {'precision': 0.35091216624380817, 'recall': 0.6611278666135549, 'f1-score': 0.45847556283419827, 'support': 17573}, '1': {'precision': 0.3289501367557332, 'recall': 0.19041529655340397, 'f1-score': 0.24120641777229251, 'support': 16422}, '2': {'precision': 0.3790957134468585, 'recall': 0.18839733862495622, 'f1-score': 0.25170571952122894, 'support': 17134}, 'accuracy': 0.35152261925717304, 'macro avg': {'precision': 0.35298600548213327, 'recall': 0.3466468339306384, 'f1-score': 0.3171292333759066, 'support': 51129}, 'weighted avg': {'precision': 0.35330291219080295, 'recall': 0.35152261925717304, 'f1-score': 0.3194001184576012, 'support': 51129}}
[[11618  3115  2840]
 [10848  3127  2447]
 [10642  3264  3228]]
Evaluating performance on  val set...
53/53 - 1s - 929ms/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.117948
{'0': {'precision': 0.334274421230943, 'recall': 0.8016249153689912, 'f1-score': 0.47180713289499904, 'support': 4431}, '1': {'precision': 0.3790322580645161, 'recall': 0.17385943279901356, 'f1-score': 0.23837700760777678, 'support': 4866}, '2': {'precision': 0.3408360128617363, 'recall': 0.05068132918957686, 'f1-score': 0.0882414151925078, 'support': 4183}, 'accuracy': 0.34198813056379823, 'macro avg': {'precision': 0.3513808973857318, 'recall': 0.3420552257858605, 'f1-score': 0.2661418518984279, 'support': 13480}, 'weighted avg': {'precision': 0.352467208458226, 'recall': 0.34198813056379823, 'f1-score': 0.2685188252690981, 'support': 13480}}
[[3552  699  180]
 [3790  846  230]
 [3284  687  212]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0809568
{'0': {'precision': 0.24349895190074217, 'recall': 0.7176250584385226, 'f1-score': 0.36361790509386555, 'support': 59892}, '1': {'precision': 0.58355307033294, 'recall': 0.3473831438919665, 'f1-score': 0.4355110416858097, 'support': 163727}, '2': {'precision': 0.40223280249548515, 'recall': 0.07835236176404746, 'f1-score': 0.1311563169164882, 'support': 62538}, 'accuracy': 0.36607876095989267, 'macro avg': {'precision': 0.40976160824305574, 'recall': 0.3811201880315122, 'f1-score': 0.31009508789872114, 'support': 286157}, 'weighted avg': {'precision': 0.47275400488579056, 'recall': 0.36607876095989267, 'f1-score': 0.35394896382509494, 'support': 286157}}
[[ 42980  15604   1308]
 [100877  56876   5974]
 [ 32653  24985   4900]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786983
{'0': {'precision': 0.2769405099150142, 'recall': 0.6658493393270671, 'f1-score': 0.39118082509703495, 'support': 29364}, '1': {'precision': 0.6509526689853319, 'recall': 0.24018356558005888, 'f1-score': 0.3508961413447724, 'support': 71691}, '2': {'precision': 0.3138193688792165, 'recall': 0.35842624813578583, 'f1-score': 0.3346428630629734, 'support': 28162}, 'accuracy': 0.36268447650077, 'macro avg': {'precision': 0.4139041825931875, 'recall': 0.4214863843476373, 'f1-score': 0.35890660983492695, 'support': 129217}, 'weighted avg': {'precision': 0.49248403841405086, 'recall': 0.36268447650077, 'f1-score': 0.35650836443251954, 'support': 129217}}
[[19552  4258  5554]
 [37955 17219 16517]
 [13093  4975 10094]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0724609
{'0': {'precision': 0.26118265754325154, 'recall': 0.8116063138347261, 'f1-score': 0.3951895472116102, 'support': 10770}, '1': {'precision': 0.6096944912196295, 'recall': 0.19244495064540623, 'f1-score': 0.2925492006694754, 'support': 26340}, '2': {'precision': 0.4713196286472148, 'recall': 0.2656264598710642, 'f1-score': 0.33976695548252167, 'support': 10703}, 'accuracy': 0.3482943969213394, 'macro avg': {'precision': 0.44739892580336527, 'recall': 0.42322590811706556, 'f1-score': 0.34250190112120243, 'support': 47813}, 'weighted avg': {'precision': 0.5002159267537489, 'recall': 0.3482943969213394, 'f1-score': 0.3262389537078295, 'support': 47813}}
[[ 8741  1321   708]
 [18790  5069  2481]
 [ 5936  1924  2843]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0948495
{'0': {'precision': 0.3583912081202778, 'recall': 0.5656877153251259, 'f1-score': 0.4387882865205285, 'support': 41507}, '1': {'precision': 0.4653971499776344, 'recall': 0.3177089013457805, 'f1-score': 0.37762654741072005, 'support': 45847}, '2': {'precision': 0.3823458209768202, 'recall': 0.29725914598282555, 'f1-score': 0.3344760492912072, 'support': 42505}, 'accuracy': 0.3902771467514766, 'macro avg': {'precision': 0.4020447263582441, 'recall': 0.3935519208845773, 'f1-score': 0.3836302944074852, 'support': 129859}, 'weighted avg': {'precision': 0.4040106279202267, 'recall': 0.3902771467514766, 'f1-score': 0.3830518809082899, 'support': 129859}}
[[23480  7833 10194]
 [21064 14566 10217]
 [20971  8899 12635]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1033868
{'0': {'precision': 0.3594104037970759, 'recall': 0.6716437867712605, 'f1-score': 0.46825039230613863, 'support': 22436}, '1': {'precision': 0.3966156126482213, 'recall': 0.2893053428236778, 'f1-score': 0.3345662933055483, 'support': 22198}, '2': {'precision': 0.4071501764772857, 'recall': 0.1605891862762709, 'f1-score': 0.23033074619174906, 'support': 22268}, 'accuracy': 0.37468237122955966, 'macro avg': {'precision': 0.38772539764086095, 'recall': 0.373846105290403, 'f1-score': 0.34438247726781196, 'support': 66902}, 'weighted avg': {'precision': 0.38764499295914334, 'recall': 0.37468237122955966, 'f1-score': 0.34470379714769295, 'support': 66902}}
[[15069  4628  2739]
 [13308  6422  2468]
 [13550  5142  3576]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1061541
{'0': {'precision': 0.3625676720804331, 'recall': 0.7268217054263566, 'f1-score': 0.4837977296181631, 'support': 6450}, '1': {'precision': 0.3526717557251908, 'recall': 0.19411764705882353, 'f1-score': 0.25040650406504067, 'support': 5950}, '2': {'precision': 0.3854634544712127, 'recall': 0.1509433962264151, 'f1-score': 0.21693668849821898, 'support': 6254}, 'accuracy': 0.36383617454701406, 'macro avg': {'precision': 0.36690096075894557, 'recall': 0.35729424957053174, 'f1-score': 0.3170469740604743, 'support': 18654}, 'weighted avg': {'precision': 0.3670873204538782, 'recall': 0.36383617454701406, 'f1-score': 0.3198850704991962, 'support': 18654}}
[[4688 1007  755]
 [4045 1155  750]
 [4197 1113  944]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1162976
{'0': {'precision': 0.3192280591873483, 'recall': 0.6779026995573474, 'f1-score': 0.43405653912430225, 'support': 48119}, '1': {'precision': 0.40552831482939966, 'recall': 0.2645562277285158, 'f1-score': 0.32021344888460923, 'support': 60335}, '2': {'precision': 0.3147586850081604, 'recall': 0.08812393924887942, 'f1-score': 0.13769655758606036, 'support': 45958}, 'accuracy': 0.34085433774577106, 'macro avg': {'precision': 0.34650501967496944, 'recall': 0.34352762217824756, 'f1-score': 0.2973221818649906, 'support': 154412}, 'weighted avg': {'precision': 0.35161882172935316, 'recall': 0.34085433774577106, 'f1-score': 0.30136714399214676, 'support': 154412}}
[[32620 11941  3558]
 [39114 15962  5259]
 [30450 11458  4050]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1145418
{'0': {'precision': 0.3615313526834611, 'recall': 0.7216794206067232, 'f1-score': 0.48173401441211344, 'support': 29272}, '1': {'precision': 0.3295888736053798, 'recall': 0.1584729570840682, 'f1-score': 0.21403404297553474, 'support': 27216}, '2': {'precision': 0.3444274534496717, 'recall': 0.14644127433357557, 'f1-score': 0.20550665521683129, 'support': 26147}, 'accuracy': 0.3541719610334604, 'macro avg': {'precision': 0.3451825599128375, 'recall': 0.34219788400812234, 'f1-score': 0.30042490420149315, 'support': 82635}, 'weighted avg': {'precision': 0.3455990943927253, 'recall': 0.3541719610334604, 'f1-score': 0.3061638663695531, 'support': 82635}}
[[21125  4609  3538]
 [19153  4313  3750]
 [18154  4164  3829]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1248032
{'0': {'precision': 0.3666592895872524, 'recall': 0.647800586510264, 'f1-score': 0.46827303561334094, 'support': 10230}, '1': {'precision': 0.27586903799514956, 'recall': 0.16453712632594023, 'f1-score': 0.20613107822410145, 'support': 8296}, '2': {'precision': 0.3572220169929812, 'recall': 0.1951564076690212, 'f1-score': 0.2524145131819368, 'support': 9910}, 'accuracy': 0.34906456604304403, 'macro avg': {'precision': 0.33325011485846107, 'recall': 0.33583137350174175, 'f1-score': 0.3089395423397931, 'support': 28436}, 'weighted avg': {'precision': 0.33688297440166676, 'recall': 0.34906456604304403, 'f1-score': 0.31656788595106966, 'support': 28436}}
[[6627 1776 1827]
 [5278 1365 1653]
 [6169 1807 1934]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0993686
{'0': {'precision': 0.39538937468274415, 'recall': 0.6891526442307693, 'f1-score': 0.5024860785686031, 'support': 59904}, '1': {'precision': 0.3608074949810395, 'recall': 0.06946979620761483, 'f1-score': 0.11650730196459762, 'support': 46567}, '2': {'precision': 0.37320314618931383, 'recall': 0.3262031110381677, 'f1-score': 0.34812392962789973, 'support': 54837}, 'accuracy': 0.38687479852208195, 'macro avg': {'precision': 0.3764666719510325, 'recall': 0.3616085171588506, 'f1-score': 0.3223724367203668, 'support': 161308}, 'weighted avg': {'precision': 0.3778638917311018, 'recall': 0.38687479852208195, 'f1-score': 0.33858453089843127, 'support': 161308}}
[[41283  2862 15759]
 [29048  3235 14284]
 [34080  2869 17888]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1094863
{'0': {'precision': 0.3490268993784099, 'recall': 0.6384558093346574, 'f1-score': 0.4513258805566768, 'support': 40280}, '1': {'precision': 0.3686064629767631, 'recall': 0.27010524225575855, 'f1-score': 0.31176049276607937, 'support': 40288}, '2': {'precision': 0.39392321247396805, 'recall': 0.17834779875734352, 'f1-score': 0.24553170244633046, 'support': 41363}, 'accuracy': 0.36066299792505596, 'macro avg': {'precision': 0.3705188582763803, 'recall': 0.36230295011591984, 'f1-score': 0.3362060252563622, 'support': 121931}, 'weighted avg': {'precision': 0.3707266119766993, 'recall': 0.36066299792505596, 'f1-score': 0.33539904544103066, 'support': 121931}}
[[25717  8808  5755]
 [23811 10882  5595]
 [24154  9832  7377]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1211512
{'0': {'precision': 0.35443037974683544, 'recall': 0.5585059077626731, 'f1-score': 0.4336588734339548, 'support': 15742}, '1': {'precision': 0.3855911530330135, 'recall': 0.2989723220477902, 'f1-score': 0.33680173301608723, 'support': 15861}, '2': {'precision': 0.3403950465663699, 'recall': 0.2177841801990571, 'f1-score': 0.26562312821946255, 'support': 15272}, 'accuracy': 0.35968, 'macro avg': {'precision': 0.36013885978207294, 'recall': 0.35842080333650683, 'f1-score': 0.3453612448898349, 'support': 46875}, 'weighted avg': {'precision': 0.3604014393043822, 'recall': 0.35968, 'f1-score': 0.3461390226588396, 'support': 46875}}
[[8792 3687 3263]
 [7937 4742 3182]
 [8077 3869 3326]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1019962
{'0': {'precision': 0.2689007953675663, 'recall': 0.8313989381405111, 'f1-score': 0.4063689718817736, 'support': 145782}, '1': {'precision': 0.5744172825469016, 'recall': 0.20987910763989864, 'f1-score': 0.3074301709973833, 'support': 312923}, '2': {'precision': 0.4506861063464837, 'recall': 0.11704030568566993, 'f1-score': 0.18582344783384622, 'support': 143677}, 'accuracy': 0.33814921428595146, 'macro avg': {'precision': 0.43133472808698387, 'recall': 0.3861061171553599, 'f1-score': 0.29987419690433437, 'support': 602382}, 'weighted avg': {'precision': 0.4709677625796296, 'recall': 0.33814921428595146, 'f1-score': 0.30236927460034735, 'support': 602382}}
[[121203  21014   3565]
 [230316  65676  16931]
 [ 99216  27645  16816]]
Evaluating performance on  train set...
1250/1250 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0629393
{'0': {'precision': 0.3067026509293717, 'recall': 0.7959220661531491, 'f1-score': 0.44278239702127814, 'support': 77245}, '1': {'precision': 0.5976486486486486, 'recall': 0.2711305382026398, 'f1-score': 0.37303103531168164, 'support': 163117}, '2': {'precision': 0.464938722524148, 'recall': 0.2656483751335722, 'f1-score': 0.3381122293870106, 'support': 79545}, 'accuracy': 0.3964839781561516, 'macro avg': {'precision': 0.4564300073673894, 'recall': 0.4442336598297871, 'f1-score': 0.38464188723999015, 'support': 319907}, 'weighted avg': {'precision': 0.494398220657392, 'recall': 0.3964839781561516, 'f1-score': 0.3811906802021649, 'support': 319907}}
[[61481 11059  4705]
 [99278 44226 19613]
 [39699 18715 21131]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0758207
{'0': {'precision': 0.29336484275586255, 'recall': 0.8028323162642611, 'f1-score': 0.429708787843823, 'support': 30152}, '1': {'precision': 0.6063319060594266, 'recall': 0.21118040491684742, 'f1-score': 0.31325624266800733, 'support': 66384}, '2': {'precision': 0.4395939570128199, 'recall': 0.30661835588205966, 'f1-score': 0.3612579798691889, 'support': 30083}, 'accuracy': 0.3747462861024017, 'macro avg': {'precision': 0.4464302352760363, 'recall': 0.44021035902105604, 'f1-score': 0.368074336793673, 'support': 126619}, 'weighted avg': {'precision': 0.4921897898375473, 'recall': 0.3747462861024017, 'f1-score': 0.35239186530255934, 'support': 126619}}
[[24207  3227  2718]
 [43324 14019  9041]
 [14984  5875  9224]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
3870/3870 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034002
{'0': {'precision': 0.26996623880564297, 'recall': 0.8175654367707348, 'f1-score': 0.40590094228843837, 'support': 240996}, '1': {'precision': 0.601236136509369, 'recall': 0.19359408425878308, 'f1-score': 0.2928820677158727, 'support': 523079}, '2': {'precision': 0.35695276834202383, 'recall': 0.14559863738455497, 'f1-score': 0.20683192242235812, 'support': 226623}, 'accuracy': 0.3344016037177828, 'macro avg': {'precision': 0.4093850478856786, 'recall': 0.385586052804691, 'f1-score': 0.30187164414222306, 'support': 990698}, 'weighted avg': {'precision': 0.4647717951952699, 'recall': 0.3344016037177828, 'f1-score': 0.3006908597187211, 'support': 990698}}
[[197030  30602  13364]
 [375736 101265  46078]
 [157066  36561  32996]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0892074
{'0': {'precision': 0.26183953356721085, 'recall': 0.7166915490408976, 'f1-score': 0.3835507818765643, 'support': 88416}, '1': {'precision': 0.6340914306947465, 'recall': 0.2543297870941441, 'f1-score': 0.363044770515909, 'support': 228129}, '2': {'precision': 0.28389188880317706, 'recall': 0.2285172195710918, 'f1-score': 0.2532124586696567, 'support': 86965}, 'accuracy': 0.35007806497980226, 'macro avg': {'precision': 0.39327428435504475, 'recall': 0.39984618523537785, 'f1-score': 0.33326933702071, 'support': 403510}, 'weighted avg': {'precision': 0.4770491593829363, 'recall': 0.35007806497980226, 'f1-score': 0.34386678855946273, 'support': 403510}}
[[ 63367  13852  11197]
 [131177  58020  38932]
 [ 47463  19629  19873]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985152
{'0': {'precision': 0.23482385692438715, 'recall': 0.7908160118423487, 'f1-score': 0.362120217190225, 'support': 32426}, '1': {'precision': 0.6201015015957725, 'recall': 0.2687741657501162, 'f1-score': 0.37500692142794995, 'support': 88193}, '2': {'precision': 0.35381039349161547, 'recall': 0.06490816606256282, 'f1-score': 0.10969269573274308, 'support': 32831}, 'accuracy': 0.3354708374063213, 'macro avg': {'precision': 0.40291191733725834, 'recall': 0.37483278121834257, 'f1-score': 0.2822732781169727, 'support': 153450}, 'weighted avg': {'precision': 0.48171364707454783, 'recall': 0.3354708374063213, 'f1-score': 0.3155191689651816, 'support': 153450}}
[[25643  5867   916]
 [61513 23704  2976]
 [22045  8655  2131]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081152
{'0': {'precision': 0.36608927601501495, 'recall': 0.7579515757459867, 'f1-score': 0.49371505169864865, 'support': 219642}, '1': {'precision': 0.34550193824355035, 'recall': 0.2615973968796968, 'f1-score': 0.2977516278882236, 'support': 197609}, '2': {'precision': 0.38412988595803954, 'recall': 0.0420058070350802, 'f1-score': 0.07573027151340403, 'support': 210090}, 'accuracy': 0.36183989249865706, 'macro avg': {'precision': 0.36524036673886834, 'recall': 0.35385159322025456, 'f1-score': 0.2890656503667588, 'support': 627341}, 'weighted avg': {'precision': 0.36564599000827963, 'recall': 0.36183989249865706, 'f1-score': 0.2920088684827066, 'support': 627341}}
[[166478  45837   7327]
 [139093  51694   6822]
 [149176  52089   8825]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0896803
{'0': {'precision': 0.37373214357629003, 'recall': 0.6331358063195649, 'f1-score': 0.4700183417203592, 'support': 102602}, '1': {'precision': 0.3951206576504906, 'recall': 0.23207141257897146, 'f1-score': 0.29240232302852276, 'support': 102727}, '2': {'precision': 0.40160956415634985, 'recall': 0.2878551143342865, 'f1-score': 0.33534819292280565, 'support': 101763}, 'accuracy': 0.38455576830396104, 'macro avg': {'precision': 0.39015412179437686, 'recall': 0.38435411107760764, 'f1-score': 0.36592295255722923, 'support': 307092}, 'weighted avg': {'precision': 0.3901248462054338, 'recall': 0.38455576830396104, 'f1-score': 0.36597655911370797, 'support': 307092}}
[[64961 16955 20686]
 [55927 23840 22960]
 [52929 19541 29293]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089489
{'0': {'precision': 0.3760512204412928, 'recall': 0.679021164021164, 'f1-score': 0.48403643426933446, 'support': 37800}, '1': {'precision': 0.4111582520152737, 'recall': 0.24899154697977954, 'f1-score': 0.31015666255940855, 'support': 38921}, '2': {'precision': 0.3853658536585366, 'recall': 0.22375253380723628, 'f1-score': 0.28311930151256964, 'support': 36013}, 'accuracy': 0.38511895257863643, 'macro avg': {'precision': 0.39085844203836767, 'recall': 0.3839217482693933, 'f1-score': 0.35910413278043757, 'support': 112734}, 'weighted avg': {'precision': 0.3911473641241526, 'recall': 0.38511895257863643, 'f1-score': 0.35982188234452567, 'support': 112734}}
[[25667  6389  5744]
 [22122  9691  7108]
 [20465  7490  8058]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
3337/3337 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912147
{'0': {'precision': 0.3547768905266559, 'recall': 0.7569852172669363, 'f1-score': 0.4831264884348248, 'support': 272683}, '1': {'precision': 0.4244514965980743, 'recall': 0.32198957003986073, 'f1-score': 0.366188198910233, 'support': 317355}, '2': {'precision': 0.4566178107016819, 'recall': 0.05440501850497949, 'f1-score': 0.09722579509606141, 'support': 263983}, 'accuracy': 0.3781686867184765, 'macro avg': {'precision': 0.41194873260880405, 'recall': 0.3777932686039256, 'f1-score': 0.3155134941470398, 'support': 854021}, 'weighted avg': {'precision': 0.41214767677237923, 'recall': 0.3781686867184765, 'f1-score': 0.320387898163949, 'support': 854021}}
[[206417  60115   6151]
 [204230 102185  10940]
 [171175  78446  14362]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0997003
{'0': {'precision': 0.35977367934279963, 'recall': 0.717406724358065, 'f1-score': 0.47922159727525604, 'support': 119833}, '1': {'precision': 0.399323556319481, 'recall': 0.3581124757595346, 'f1-score': 0.3775968961765824, 'support': 120666}, '2': {'precision': 0.4222280887011616, 'recall': 0.06366683385480108, 'f1-score': 0.11064913142438099, 'support': 125607}, 'accuracy': 0.37469476053383444, 'macro avg': {'precision': 0.3937751081211474, 'recall': 0.3797286779908002, 'f1-score': 0.3224892082920731, 'support': 366106}, 'weighted avg': {'precision': 0.3942364755044141, 'recall': 0.37469476053383444, 'f1-score': 0.31927358249018445, 'support': 366106}}
[[85969 28574  5290]
 [71801 43212  5653]
 [81183 36427  7997]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1013372
{'0': {'precision': 0.37461564931677155, 'recall': 0.7644980065241029, 'f1-score': 0.5028346656137553, 'support': 44144}, '1': {'precision': 0.3508677155783645, 'recall': 0.27821058549514094, 'f1-score': 0.31034328291349983, 'support': 37353}, '2': {'precision': 0.41938137545245147, 'recall': 0.057557693176173055, 'f1-score': 0.10122309586212375, 'support': 44286}, 'accuracy': 0.3711868853501666, 'macro avg': {'precision': 0.38162158011586245, 'recall': 0.36675542839847225, 'f1-score': 0.304800348129793, 'support': 125783}, 'weighted avg': {'precision': 0.3833246034577445, 'recall': 0.3711868853501666, 'f1-score': 0.3042712620057686, 'support': 125783}}
[[33748  8600  1796]
 [25228 10392  1733]
 [31111 10626  2549]]
testing model on single stock: results/universal/W9/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
10303/10303 - 142s - 142s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1230334
{'0': {'precision': 0.3101873870446114, 'recall': 0.7297424306845391, 'f1-score': 0.4353311039468151, 'support': 804366}, '1': {'precision': 0.399493812835349, 'recall': 0.252304705021365, 'f1-score': 0.3092801405462566, 'support': 1016616}, '2': {'precision': 0.3246318282868487, 'recall': 0.040959209820411506, 'f1-score': 0.07274064067885465, 'support': 816422}, 'accuracy': 0.3324924812429192, 'macro avg': {'precision': 0.3447710093889364, 'recall': 0.34100211517543855, 'f1-score': 0.2724506283906421, 'support': 2637404}, 'weighted avg': {'precision': 0.34908286948474815, 'recall': 0.3324924812429192, 'f1-score': 0.27450164535398025, 'support': 2637404}}
[[586980 186082  31304]
 [721854 256497  38265]
 [583506 199476  33440]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1231513
{'0': {'precision': 0.330101947291981, 'recall': 0.6540364797049775, 'f1-score': 0.4387568041813137, 'support': 286351}, '1': {'precision': 0.35682768342489696, 'recall': 0.2551442033863201, 'f1-score': 0.29753822682288156, 'support': 289695}, '2': {'precision': 0.3717266044108881, 'recall': 0.12509862658304025, 'f1-score': 0.18719857517360067, 'support': 299108}, 'accuracy': 0.34121537466548746, 'macro avg': {'precision': 0.3528854117092554, 'recall': 0.34475976989144597, 'f1-score': 0.3078312020592653, 'support': 875154}, 'weighted avg': {'precision': 0.3531751207797868, 'recall': 0.34121537466548746, 'f1-score': 0.30603342689012836, 'support': 875154}}
[[187284  63303  35764]
 [188303  73914  27478]
 [191765  69925  37418]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1231772
{'0': {'precision': 0.33757681298664904, 'recall': 0.7092332795047773, 'f1-score': 0.4574291208627279, 'support': 118896}, '1': {'precision': 0.350813244708549, 'recall': 0.28541642438238274, 'f1-score': 0.31475382804377, 'support': 120382}, '2': {'precision': 0.3492130115424974, 'recall': 0.028206258263552227, 'f1-score': 0.05219655264354836, 'support': 117988}, 'accuracy': 0.34151584533652796, 'macro avg': {'precision': 0.3458676897458985, 'recall': 0.34095198738357074, 'f1-score': 0.2747931671833488, 'support': 357266}, 'weighted avg': {'precision': 0.3458797579037506, 'recall': 0.34151584533652796, 'f1-score': 0.2755251127590283, 'support': 357266}}
[[84325 31297  3274]
 [83095 34359  2928]
 [82375 32285  3328]]
training model: results/universal/W9/deepLOB_L2/h200
Epoch 1/50
6697/6697 - 282s - loss: 3.2289 - accuracy200: 0.4040 - val_loss: 3.3359 - val_accuracy200: 0.3408 - 282s/epoch - 42ms/step
Epoch 2/50
6697/6697 - 278s - loss: 3.2040 - accuracy200: 0.4179 - val_loss: 3.3334 - val_accuracy200: 0.3448 - 278s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 277s - loss: 3.1902 - accuracy200: 0.4240 - val_loss: 3.3517 - val_accuracy200: 0.3424 - 277s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 280s - loss: 3.1802 - accuracy200: 0.4299 - val_loss: 3.3717 - val_accuracy200: 0.3461 - 280s/epoch - 42ms/step
Epoch 5/50
6697/6697 - 278s - loss: 3.1736 - accuracy200: 0.4326 - val_loss: 3.3875 - val_accuracy200: 0.3518 - 278s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 277s - loss: 3.1674 - accuracy200: 0.4350 - val_loss: 3.4516 - val_accuracy200: 0.3508 - 277s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 278s - loss: 3.1605 - accuracy200: 0.4377 - val_loss: 3.3899 - val_accuracy200: 0.3499 - 278s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 278s - loss: 3.1555 - accuracy200: 0.4394 - val_loss: 3.4014 - val_accuracy200: 0.3523 - 278s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 278s - loss: 3.1514 - accuracy200: 0.4405 - val_loss: 3.4034 - val_accuracy200: 0.3528 - 278s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 278s - loss: 3.1470 - accuracy200: 0.4420 - val_loss: 3.4065 - val_accuracy200: 0.3520 - 278s/epoch - 42ms/step
Epoch 11/50
6697/6697 - 278s - loss: 3.1422 - accuracy200: 0.4438 - val_loss: 3.4314 - val_accuracy200: 0.3527 - 278s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 278s - loss: 3.1380 - accuracy200: 0.4451 - val_loss: 3.4191 - val_accuracy200: 0.3560 - 278s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 226s - 226s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1040915
{'0': {'precision': 0.30833854527628934, 'recall': 0.1639455012953591, 'f1-score': 0.21406912954589571, 'support': 1335151}, '1': {'precision': 0.3773225006655411, 'recall': 0.8262945046807347, 'f1-score': 0.5180709601267752, 'support': 1631261}, '2': {'precision': 0.31677578703885206, 'recall': 0.006024078420379279, 'f1-score': 0.011823314610646398, 'support': 1341284}, 'accuracy': 0.3655954366324829, 'macro avg': {'precision': 0.3341456109935608, 'recall': 0.3320880281321577, 'f1-score': 0.24798780142777246, 'support': 4307696}, 'weighted avg': {'precision': 0.3370888501799974, 'recall': 0.3655954366324829, 'f1-score': 0.2662170189316799, 'support': 4307696}}
[[ 218892 1108675    7584]
 [ 273516 1347902    9843]
 [ 217500 1115704    8080]]
Evaluating performance on  train set...
6697/6697 - 96s - 96s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.108149
{'0': {'precision': 0.3346586611022391, 'recall': 0.16311180061164476, 'f1-score': 0.21932509460171482, 'support': 561437}, '1': {'precision': 0.3415317684694412, 'recall': 0.7819902782313425, 'f1-score': 0.47542373277769434, 'support': 584873}, '2': {'precision': 0.3647780720129639, 'recall': 0.0650296373933186, 'f1-score': 0.11038138792254136, 'support': 567695}, 'accuracy': 0.34180705423846486, 'macro avg': {'precision': 0.3469895005282147, 'recall': 0.33671057207876864, 'f1-score': 0.2683767384339835, 'support': 1714005}, 'weighted avg': {'precision': 0.3469798234688259, 'recall': 0.34180705423846486, 'f1-score': 0.2706308849831118, 'support': 1714005}}
[[ 91577 437614  32246]
 [ 95467 457365  32041]
 [ 86599 444179  36917]]
Evaluating performance on  val set...
2631/2631 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097958
{'0': {'precision': 0.32738818667963054, 'recall': 0.1944331664185501, 'f1-score': 0.24397285165205282, 'support': 221670}, '1': {'precision': 0.34819609938657325, 'recall': 0.7529377654222025, 'f1-score': 0.47618187284864294, 'support': 234532}, '2': {'precision': 0.3574217030144706, 'recall': 0.0562017113898812, 'f1-score': 0.09713043651664108, 'support': 216666}, 'accuracy': 0.34459210424630093, 'macro avg': {'precision': 0.3443353296935581, 'recall': 0.33452421441021124, 'f1-score': 0.2724283870057789, 'support': 672868}, 'weighted avg': {'precision': 0.34431180800385636, 'recall': 0.34459210424630093, 'f1-score': 0.27762683347545586, 'support': 672868}}
[[ 43100 167699  10871]
 [ 46923 176588  11021]
 [ 41625 162864  12177]]
testing model out of sample: results/universal/W9/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 119s - 119s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961272
{'0': {'precision': 0.3454617928428015, 'recall': 0.16494463123911832, 'f1-score': 0.22328115532697526, 'support': 709335}, '1': {'precision': 0.3903280150299557, 'recall': 0.8421904650233433, 'f1-score': 0.53342897134573, 'support': 835786}, '2': {'precision': 0.3593027957486137, 'recall': 0.03735106336665471, 'f1-score': 0.06766777220701481, 'support': 666139}, 'accuracy': 0.3824846467624793, 'macro avg': {'precision': 0.3650308678737903, 'recall': 0.34816205320970545, 'f1-score': 0.2747926329599067, 'support': 2211260}, 'weighted avg': {'precision': 0.3665893817340163, 'recall': 0.3824846467624793, 'f1-score': 0.2936288571534921, 'support': 2211260}}
[[117001 568834  23500]
 [111028 703891  20867]
 [110651 530607  24881]]
Evaluating performance on  train set...
3947/3947 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024623
{'0': {'precision': 0.31893505710920594, 'recall': 0.1861657905171201, 'f1-score': 0.23510076179592432, 'support': 312732}, '1': {'precision': 0.37701352969653734, 'recall': 0.7849265290965997, 'f1-score': 0.5093686529656787, 'support': 377020}, '2': {'precision': 0.35927588910270114, 'recall': 0.04728508626565695, 'f1-score': 0.08357118581782111, 'support': 319826}, 'accuracy': 0.3657726297522331, 'macro avg': {'precision': 0.3517414919694815, 'recall': 0.33945913529312555, 'f1-score': 0.2760135335264747, 'support': 1009578}, 'weighted avg': {'precision': 0.3534037090291441, 'recall': 0.3657726297522331, 'f1-score': 0.28952090779954953, 'support': 1009578}}
[[ 58220 241831  12681]
 [ 66798 295933  14289]
 [ 57527 247176  15123]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005776
{'0': {'precision': 0.3303992715432797, 'recall': 0.10729871410009409, 'f1-score': 0.16199031359073568, 'support': 111595}, '1': {'precision': 0.38127858172022805, 'recall': 0.8991704647022759, 'f1-score': 0.5354909521222426, 'support': 135377}, '2': {'precision': 0.3239693542502736, 'recall': 0.00798058775950391, 'f1-score': 0.01557744428169212, 'support': 111270}, 'accuracy': 0.3756929673237644, 'macro avg': {'precision': 0.3452157358379271, 'recall': 0.3381499221872913, 'f1-score': 0.23768623666489017, 'support': 358242}, 'weighted avg': {'precision': 0.34762905330151, 'recall': 0.3756929673237644, 'f1-score': 0.25765758871331357, 'support': 358242}}
[[ 11974  98685    936]
 [ 12733 121727    917]
 [ 11534  98848    888]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1239641
{'0': {'precision': 0.3783883052964078, 'recall': 0.18431316420367125, 'f1-score': 0.2478825794032724, 'support': 27947}, '1': {'precision': 0.2886569400117241, 'recall': 0.818307713613073, 'f1-score': 0.4267709900692146, 'support': 21663}, '2': {'precision': 0.3209169054441261, 'recall': 0.004347151063499456, 'f1-score': 0.008578102860644123, 'support': 25764}, 'accuracy': 0.3050123384721522, 'macro avg': {'precision': 0.3293207169174193, 'recall': 0.33565600962674785, 'f1-score': 0.22774389077771037, 'support': 75374}, 'weighted avg': {'precision': 0.33295428677601235, 'recall': 0.3050123384721522, 'f1-score': 0.21749835018115377, 'support': 75374}}
[[ 5151 22663   133]
 [ 3832 17727   104]
 [ 4630 21022   112]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154245
{'0': {'precision': 0.3400371287128713, 'recall': 0.19305539290315024, 'f1-score': 0.2462837080749981, 'support': 17078}, '1': {'precision': 0.33335200851588326, 'recall': 0.7066927964843518, 'f1-score': 0.45301406627709995, 'support': 16839}, '2': {'precision': 0.3469921534437663, 'recall': 0.11561701138740414, 'f1-score': 0.17344315161023227, 'support': 17212}, 'accuracy': 0.3361497388957343, 'macro avg': {'precision': 0.3401270968908403, 'recall': 0.3384550669249687, 'f1-score': 0.29091364198744346, 'support': 51129}, 'weighted avg': {'precision': 0.3401767587989493, 'recall': 0.3361497388957343, 'f1-score': 0.289848042286378, 'support': 51129}}
[[ 3297 11765  2016]
 [ 3210 11900  1729]
 [ 3189 12033  1990]]
Evaluating performance on  val set...
53/53 - 1s - 972ms/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105076
{'0': {'precision': 0.3245649534601376, 'recall': 0.18248009101251422, 'f1-score': 0.23361491406932713, 'support': 4395}, '1': {'precision': 0.3668249908659116, 'recall': 0.8108217242075509, 'f1-score': 0.5051254638073077, 'support': 4953}, '2': {'precision': 0.2786885245901639, 'recall': 0.004114230396902226, 'f1-score': 0.008108752683043166, 'support': 4132}, 'accuracy': 0.3586795252225519, 'macro avg': {'precision': 0.3233594896387377, 'recall': 0.3324720152056558, 'f1-score': 0.24894971018655931, 'support': 13480}, 'weighted avg': {'precision': 0.3260302769898162, 'recall': 0.3586795252225519, 'f1-score': 0.26425291807556545, 'support': 13480}}
[[ 802 3566   27]
 [ 920 4016   17]
 [ 749 3366   17]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
1118/1118 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0845838
{'0': {'precision': 0.2785089563535447, 'recall': 0.16854118425405226, 'f1-score': 0.20999984147366085, 'support': 78598}, '1': {'precision': 0.4397744313261664, 'recall': 0.821970803496001, 'f1-score': 0.5729868957660281, 'support': 126659}, '2': {'precision': 0.35468245425188377, 'recall': 0.008145859085290481, 'f1-score': 0.015925952777979167, 'support': 80900}, 'accuracy': 0.412416959920603, 'macro avg': {'precision': 0.3576552806438649, 'recall': 0.33288594894511464, 'f1-score': 0.2663042300058894, 'support': 286157}, 'weighted avg': {'precision': 0.37142354441021613, 'recall': 0.412416959920603, 'f1-score': 0.3157984055980272, 'support': 286157}}
[[ 13247  64855    496]
 [ 21846 104110    703]
 [ 12471  67770    659]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0909073
{'0': {'precision': 0.3213273069256899, 'recall': 0.29507605052848673, 'f1-score': 0.3076426872371021, 'support': 38790}, '1': {'precision': 0.4484331869734979, 'recall': 0.5770179248408113, 'f1-score': 0.5046637211585665, 'support': 54338}, '2': {'precision': 0.31887485745660343, 'recall': 0.20920502092050208, 'f1-score': 0.2526520095037312, 'support': 36089}, 'accuracy': 0.3896546120092558, 'macro avg': {'precision': 0.3628784504519304, 'recall': 0.3604329987632667, 'f1-score': 0.35498613929979994, 'support': 129217}, 'weighted avg': {'precision': 0.3740925998913827, 'recall': 0.3896546120092558, 'f1-score': 0.37513512532578164, 'support': 129217}}
[[11446 19810  7534]
 [14391 31354  8593]
 [ 9784 18755  7550]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924128
{'0': {'precision': 0.2895151015513753, 'recall': 0.274380282690532, 'f1-score': 0.2817445846400701, 'support': 14079}, '1': {'precision': 0.42937442137283427, 'recall': 0.6440509844765164, 'f1-score': 0.5152458983871288, 'support': 20163}, '2': {'precision': 0.40108849976336963, 'recall': 0.1248986810109793, 'f1-score': 0.1904815418328932, 'support': 13571}, 'accuracy': 0.3878443101248614, 'macro avg': {'precision': 0.37332600756252643, 'recall': 0.34777664939267594, 'f1-score': 0.3291573416200307, 'support': 47813}, 'weighted avg': {'precision': 0.380162959930792, 'recall': 0.3878443101248614, 'f1-score': 0.3543097078313726, 'support': 47813}}
[[ 3863  9032  1184]
 [ 5830 12986  1347]
 [ 3650  8226  1695]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982628
{'0': {'precision': 0.3809743611262641, 'recall': 0.2103958101594364, 'f1-score': 0.27108370780645835, 'support': 43152}, '1': {'precision': 0.4035001232437762, 'recall': 0.7960587254538718, 'f1-score': 0.5355465372601864, 'support': 43184}, '2': {'precision': 0.38337093754500506, 'recall': 0.18348918962387703, 'f1-score': 0.24818970071790408, 'support': 43523}, 'accuracy': 0.3961373489708068, 'macro avg': {'precision': 0.3892818073050151, 'recall': 0.39664790841239506, 'f1-score': 0.35160664859484964, 'support': 129859}, 'weighted avg': {'precision': 0.3892684239694671, 'recall': 0.3961373489708068, 'f1-score': 0.3513565187522892, 'support': 129859}}
[[ 9079 25846  8227]
 [ 4189 34377  4618]
 [10563 24974  7986]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073408
{'0': {'precision': 0.3536308170833832, 'recall': 0.26259216487518877, 'f1-score': 0.30138662316476345, 'support': 22514}, '1': {'precision': 0.3575055503044424, 'recall': 0.7410580033717592, 'f1-score': 0.48232502965599044, 'support': 21947}, '2': {'precision': 0.4451076529524622, 'recall': 0.0930439819972372, 'f1-score': 0.1539141972578505, 'support': 22441}, 'accuracy': 0.3626797405159786, 'macro avg': {'precision': 0.38541467344676256, 'recall': 0.36556471674806174, 'f1-score': 0.3125419500262015, 'support': 66902}, 'weighted avg': {'precision': 0.3855860716907281, 'recall': 0.3626797405159786, 'f1-score': 0.3112761107359261, 'support': 66902}}
[[ 5912 14840  1762]
 [ 4842 16264   841]
 [ 5964 14389  2088]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089909
{'0': {'precision': 0.3767342582710779, 'recall': 0.3218355872967634, 'f1-score': 0.3471277554699665, 'support': 6581}, '1': {'precision': 0.33380381086803107, 'recall': 0.7108031390883286, 'f1-score': 0.4542738234980258, 'support': 5989}, '2': {'precision': 0.3046594982078853, 'recall': 0.013971071663379356, 'f1-score': 0.026716957410026717, 'support': 6084}, 'accuracy': 0.3463064222150745, 'macro avg': {'precision': 0.3383991891156648, 'recall': 0.3488699326828238, 'f1-score': 0.2760395121260063, 'support': 18654}, 'weighted avg': {'precision': 0.339443956474074, 'recall': 0.3463064222150745, 'f1-score': 0.27702582055109515, 'support': 18654}}
[[2118 4351  112]
 [1650 4257   82]
 [1854 4145   85]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995895
{'0': {'precision': 0.31643778897246566, 'recall': 0.19423500508302272, 'f1-score': 0.24071497939578465, 'support': 47216}, '1': {'precision': 0.39169956034787073, 'recall': 0.8083679652962895, 'f1-score': 0.527699266649013, 'support': 60397}, '2': {'precision': 0.3193384223918575, 'recall': 0.005363362465009936, 'f1-score': 0.01054954292319008, 'support': 46799}, 'accuracy': 0.3772051394969303, 'macro avg': {'precision': 0.3424919239040647, 'recall': 0.3359887776147741, 'f1-score': 0.2596545963226626, 'support': 154412}, 'weighted avg': {'precision': 0.34675494015990227, 'recall': 0.3772051394969303, 'f1-score': 0.2832082942660815, 'support': 154412}}
[[ 9171 37826   219]
 [11258 48823   316]
 [ 8553 37995   251]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1094862
{'0': {'precision': 0.3860556787386056, 'recall': 0.16151863940903624, 'f1-score': 0.22775059347899812, 'support': 29105}, '1': {'precision': 0.3310907637307106, 'recall': 0.8104345899641842, 'f1-score': 0.47012080191912264, 'support': 27083}, '2': {'precision': 0.35486194477791116, 'recall': 0.055885355616894165, 'f1-score': 0.09656343917418006, 'support': 26447}, 'accuracy': 0.3403884552550372, 'macro avg': {'precision': 0.3573361290824091, 'recall': 0.3426128616633715, 'f1-score': 0.2648116115241003, 'support': 82635}, 'weighted avg': {'precision': 0.35805791174862184, 'recall': 0.3403884552550372, 'f1-score': 0.2651996850901117, 'support': 82635}}
[[ 4701 23145  1259]
 [ 3706 21949  1428]
 [ 3770 21199  1478]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1235075
{'0': {'precision': 0.37734806629834255, 'recall': 0.20319317731059103, 'f1-score': 0.26414851102230247, 'support': 10084}, '1': {'precision': 0.29158981006032203, 'recall': 0.6912077523044198, 'f1-score': 0.4101539216717506, 'support': 8462}, '2': {'precision': 0.30810994231421784, 'recall': 0.09180990899898887, 'f1-score': 0.14146607462802835, 'support': 9890}, 'accuracy': 0.3096778731185821, 'macro avg': {'precision': 0.3256826062242942, 'recall': 0.3287369462046666, 'f1-score': 0.2719228357740271, 'support': 28436}, 'weighted avg': {'precision': 0.3277471586288699, 'recall': 0.3096778731185821, 'f1-score': 0.2649281034043625, 'support': 28436}}
[[2049 7022 1013]
 [1587 5849 1026]
 [1794 7188  908]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083632
{'0': {'precision': 0.39782501954936444, 'recall': 0.6793155917150576, 'f1-score': 0.5017891549683456, 'support': 64406}, '1': {'precision': 0.25190612194213335, 'recall': 0.2615523465703971, 'f1-score': 0.25663862356885314, 'support': 38780}, '2': {'precision': 0.35481247175779485, 'recall': 0.0675475723478201, 'f1-score': 0.11348952837960889, 'support': 58122}, 'accuracy': 0.3584509137798497, 'macro avg': {'precision': 0.33484787108309755, 'recall': 0.3361385035444249, 'f1-score': 0.2906391023056026, 'support': 161308}, 'weighted avg': {'precision': 0.34724656000644016, 'recall': 0.3584509137798497, 'f1-score': 0.30294167992518056, 'support': 161308}}
[[43752 16391  4263]
 [25761 10143  2876]
 [40465 13731  3926]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154361
{'0': {'precision': 0.320287881735071, 'recall': 0.20497435642085346, 'f1-score': 0.24997343292192317, 'support': 40166}, '1': {'precision': 0.3282829939111709, 'recall': 0.7471513161168334, 'f1-score': 0.45614514744860385, 'support': 40194}, '2': {'precision': 0.3549610280176954, 'recall': 0.040533063914748264, 'f1-score': 0.07275789110065202, 'support': 41571}, 'accuracy': 0.327636122069039, 'macro avg': {'precision': 0.33451063455464575, 'recall': 0.3308862454841451, 'f1-score': 0.259625490490393, 'support': 121931}, 'weighted avg': {'precision': 0.334744852504778, 'recall': 0.327636122069039, 'f1-score': 0.2575173602630697, 'support': 121931}}
[[ 8233 30205  1728]
 [ 8829 30031  1334]
 [ 8643 31243  1685]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076025
{'0': {'precision': 0.37419841569219164, 'recall': 0.06368363613019196, 'f1-score': 0.10884353741496598, 'support': 15577}, '1': {'precision': 0.35561134013495777, 'recall': 0.9431346200830687, 'f1-score': 0.5164818624253675, 'support': 16372}, '2': {'precision': 0.31880448318804483, 'recall': 0.017151279646254857, 'f1-score': 0.03255133829232628, 'support': 14926}, 'accuracy': 0.356032, 'macro avg': {'precision': 0.3495380796717314, 'recall': 0.3413231786198385, 'f1-score': 0.21929224604421993, 'support': 46875}, 'weighted avg': {'precision': 0.3500679103571532, 'recall': 0.356032, 'f1-score': 0.2269260396649025, 'support': 46875}}
[[  992 14265   320]
 [  704 15441   227]
 [  955 13715   256]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980759
{'0': {'precision': 0.3510657460222156, 'recall': 0.03082430095736156, 'f1-score': 0.05667262761518442, 'support': 189688}, '1': {'precision': 0.37385097869579326, 'recall': 0.9693127297650944, 'f1-score': 0.5395894936741791, 'support': 224686}, '2': {'precision': 0.3310170562223626, 'recall': 0.005574230883792179, 'f1-score': 0.010963833994162385, 'support': 188008}, 'accuracy': 0.37299587305065557, 'macro avg': {'precision': 0.3519779269801238, 'recall': 0.33523708720208273, 'f1-score': 0.20240865176117528, 'support': 602382}, 'weighted avg': {'precision': 0.3533071953294736, 'recall': 0.37299587305065557, 'f1-score': 0.2225325638288, 'support': 602382}}
[[  5847 182836   1005]
 [  5782 217791   1113]
 [  5026 181934   1048]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010568
{'0': {'precision': 0.340976137593257, 'recall': 0.2939051209550738, 'f1-score': 0.31569567257752396, 'support': 101856}, '1': {'precision': 0.3591879038582363, 'recall': 0.6851179593943264, 'f1-score': 0.471291203831851, 'support': 114319}, '2': {'precision': 0.406430044811153, 'recall': 0.055084255581691284, 'f1-score': 0.09701929689025478, 'support': 103732}, 'accuracy': 0.35626603981782207, 'macro avg': {'precision': 0.3688646954208821, 'recall': 0.3447024453103638, 'f1-score': 0.29466872443320996, 'support': 319907}, 'weighted avg': {'precision': 0.36870799594950726, 'recall': 0.35626603981782207, 'f1-score': 0.30039056120037877, 'support': 319907}}
[[29936 68417  3503]
 [31155 78322  4842]
 [26704 71314  5714]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028304
{'0': {'precision': 0.3212904627416902, 'recall': 0.36867427830682553, 'f1-score': 0.3433553120356612, 'support': 40114}, '1': {'precision': 0.37096561195922034, 'recall': 0.5974012164518736, 'f1-score': 0.4577094161927883, 'support': 47022}, '2': {'precision': 0.43329907502569376, 'recall': 0.05339006661094648, 'f1-score': 0.09506629385767115, 'support': 39483}, 'accuracy': 0.35530212685299994, 'macro avg': {'precision': 0.3751850499088681, 'recall': 0.3398218537898819, 'f1-score': 0.29871034069537356, 'support': 126619}, 'weighted avg': {'precision': 0.3746652398708416, 'recall': 0.35530212685299994, 'f1-score': 0.30839976334987823, 'support': 126619}}
[[14789 24107  1218]
 [17392 28091  1539]
 [13849 23526  2108]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094262
{'0': {'precision': 0.30629722253547287, 'recall': 0.1493443906099399, 'f1-score': 0.20078838598299295, 'support': 309178}, '1': {'precision': 0.39116259074223997, 'recall': 0.816631337242157, 'f1-score': 0.5289571708478876, 'support': 391081}, '2': {'precision': 0.33962023160762944, 'recall': 0.027465319740117546, 'f1-score': 0.05082073220844335, 'support': 290439}, 'accuracy': 0.3770271061413266, 'macro avg': {'precision': 0.34569334829511406, 'recall': 0.33114701586407147, 'f1-score': 0.26018876301310795, 'support': 990698}, 'weighted avg': {'precision': 0.3495672548718446, 'recall': 0.3770271061413266, 'f1-score': 0.2863685740515279, 'support': 990698}}
[[ 46174 255951   7053]
 [ 63254 319369   8458]
 [ 41321 241141   7977]]
Evaluating performance on  train set...
1577/1577 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850066
{'0': {'precision': 0.30538499628620946, 'recall': 0.21561926405034526, 'f1-score': 0.2527690967774988, 'support': 114410}, '1': {'precision': 0.4456924203857873, 'recall': 0.7571581991851671, 'f1-score': 0.5610998820953343, 'support': 175987}, '2': {'precision': 0.3418781832722987, 'recall': 0.07180430189279746, 'f1-score': 0.11868196098487616, 'support': 113113}, 'accuracy': 0.41149166067755444, 'macro avg': {'precision': 0.36431853331476516, 'recall': 0.3481939217094366, 'f1-score': 0.3108503132859031, 'support': 403510}, 'weighted avg': {'precision': 0.37680859546484174, 'recall': 0.41149166067755444, 'f1-score': 0.3496569353064547, 'support': 403510}}
[[ 24669  83655   6086]
 [ 33188 133250   9549]
 [ 22923  82068   8122]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0838557
{'0': {'precision': 0.2890792291220557, 'recall': 0.08965206460640847, 'f1-score': 0.13685982729593224, 'support': 42163}, '1': {'precision': 0.4446992553946265, 'recall': 0.9134428546193252, 'f1-score': 0.5981809330550588, 'support': 67932}, '2': {'precision': 0.2962962962962963, 'recall': 0.005720216814669588, 'f1-score': 0.011223750905141201, 'support': 43355}, 'accuracy': 0.43062886933854677, 'macro avg': {'precision': 0.3433582602709928, 'recall': 0.3362717120134677, 'f1-score': 0.2487548370853774, 'support': 153450}, 'weighted avg': {'precision': 0.3600109695722837, 'recall': 0.43062886933854677, 'f1-score': 0.30558914149929645, 'support': 153450}}
[[ 3780 38158   225]
 [ 5516 62052   364]
 [ 3780 39327   248]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
2451/2451 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1059525
{'0': {'precision': 0.3605194979980485, 'recall': 0.05156524459202579, 'f1-score': 0.09022550059785446, 'support': 207795}, '1': {'precision': 0.34768445919115915, 'recall': 0.9494447328882619, 'f1-score': 0.5089811878444533, 'support': 217643}, '2': {'precision': 0.3290754257907543, 'recall': 0.005359009029088225, 'f1-score': 0.010546271522630135, 'support': 201903}, 'accuracy': 0.34819500080498483, 'macro avg': {'precision': 0.34575979432665394, 'recall': 0.33545632883645865, 'f1-score': 0.20325098665497932, 'support': 627341}, 'weighted avg': {'precision': 0.34594670766246205, 'recall': 0.34819500080498483, 'f1-score': 0.20986022661040027, 'support': 627341}}
[[ 10715 196016   1064]
 [  9861 206640   1142]
 [  9145 191676   1082]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1063617
{'0': {'precision': 0.34502338009352035, 'recall': 0.22850245727420487, 'f1-score': 0.27492637657010277, 'support': 103977}, '1': {'precision': 0.3451893809057463, 'recall': 0.647933227344992, 'f1-score': 0.45041703362171687, 'support': 100640}, '2': {'precision': 0.37540800810947794, 'recall': 0.18069773115393997, 'f1-score': 0.243965744400527, 'support': 102475}, 'accuracy': 0.350005861435661, 'macro avg': {'precision': 0.35520692303624823, 'recall': 0.3523778052577123, 'f1-score': 0.3231030515307822, 'support': 307092}, 'weighted avg': {'precision': 0.35521697379728884, 'recall': 0.350005861435661, 'f1-score': 0.32210666437993557, 'support': 307092}}
[[23759 63687 16531]
 [21155 65208 14277]
 [23948 60010 18517]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086384
{'0': {'precision': 0.3283791485817002, 'recall': 0.194727537437604, 'f1-score': 0.24447962397793477, 'support': 38464}, '1': {'precision': 0.3322756184760291, 'recall': 0.6127247213323096, 'f1-score': 0.4308855291576674, 'support': 37769}, '2': {'precision': 0.34737153565440376, 'recall': 0.19298101421878852, 'f1-score': 0.24811990348544358, 'support': 36501}, 'accuracy': 0.33420263629428565, 'macro avg': {'precision': 0.336008767570711, 'recall': 0.33347775766290066, 'f1-score': 0.30782835220701527, 'support': 112734}, 'weighted avg': {'precision': 0.3358339261286662, 'recall': 0.33420263629428565, 'f1-score': 0.3081093938347384, 'support': 112734}}
[[ 7490 24173  6801]
 [ 8194 23142  6433]
 [ 7125 22332  7044]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
3337/3337 - 49s - 49s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093047
{'0': {'precision': 0.3235373614762759, 'recall': 0.04975212732191708, 'f1-score': 0.08624229979466119, 'support': 264652}, '1': {'precision': 0.40278410142744925, 'recall': 0.9441036947560382, 'f1-score': 0.5646646430744574, 'support': 341078}, '2': {'precision': 0.36532909930715934, 'recall': 0.020387368047975963, 'f1-score': 0.038619553151476076, 'support': 248291}, 'accuracy': 0.3984000393432948, 'macro avg': {'precision': 0.3638835207369615, 'recall': 0.3380810633753104, 'f1-score': 0.2298421653401982, 'support': 854021}, 'weighted avg': {'precision': 0.3673370244199672, 'recall': 0.3984000393432948, 'f1-score': 0.2634686638002339, 'support': 854021}}
[[ 13167 247700   3785]
 [ 14056 322013   5009]
 [ 13474 229755   5062]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144409
{'0': {'precision': 0.32235612950910547, 'recall': 0.13242636888094195, 'f1-score': 0.18773128635567435, 'support': 118564}, '1': {'precision': 0.3328410794364117, 'recall': 0.8568326874390634, 'f1-score': 0.47944087618680864, 'support': 122053}, '2': {'precision': 0.37492182614133834, 'recall': 0.009554622317493964, 'f1-score': 0.018634360891154507, 'support': 125489}, 'accuracy': 0.33181373700512967, 'macro avg': {'precision': 0.34337301169561846, 'recall': 0.3329378928791664, 'f1-score': 0.2286021744778792, 'support': 366106}, 'weighted avg': {'precision': 0.34386939697306335, 'recall': 0.33181373700512967, 'f1-score': 0.22702107261441445, 'support': 366106}}
[[ 15701 101775   1088]
 [ 16563 104579    911]
 [ 16443 107847   1199]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116806
{'0': {'precision': 0.34204145482987874, 'recall': 0.1019846544928753, 'f1-score': 0.1571212992239149, 'support': 42879}, '1': {'precision': 0.3184413270986417, 'recall': 0.8909072786623807, 'f1-score': 0.46918100337257057, 'support': 40131}, '2': {'precision': 0.37344398340248963, 'recall': 0.006312393332242303, 'f1-score': 0.012414934706639692, 'support': 42773}, 'accuracy': 0.3211562770803686, 'macro avg': {'precision': 0.3446422551103367, 'recall': 0.3330681088291661, 'f1-score': 0.21290574576770838, 'support': 125783}, 'weighted avg': {'precision': 0.34519039887362085, 'recall': 0.3211562770803686, 'f1-score': 0.20747581976876028, 'support': 125783}}
[[ 4373 38266   240]
 [ 4165 35753   213]
 [ 4247 38256   270]]
testing model on single stock: results/universal/W9/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
10303/10303 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073744
{'0': {'precision': 0.3070342318651504, 'recall': 0.2220510091715998, 'f1-score': 0.25771749331842747, 'support': 811854}, '1': {'precision': 0.3788764535548386, 'recall': 0.7690861942994941, 'f1-score': 0.5076622489744191, 'support': 1001876}, '2': {'precision': 0.30792019347037486, 'recall': 0.0061832715370401395, 'f1-score': 0.012123101971640559, 'support': 823674}, 'accuracy': 0.36243783659992934, 'macro avg': {'precision': 0.33127695963012127, 'recall': 0.3324401583360447, 'f1-score': 0.259167614754829, 'support': 2637404}, 'weighted avg': {'precision': 0.3346017722331789, 'recall': 0.36243783659992934, 'f1-score': 0.27596420004952704, 'support': 2637404}}
[[180273 626699   4882]
 [224782 770529   6565]
 [182088 636493   5093]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140832
{'0': {'precision': 0.31153337549588916, 'recall': 0.0753330622260687, 'f1-score': 0.1213274705343973, 'support': 287709}, '1': {'precision': 0.32736663222647067, 'recall': 0.9027844696405112, 'f1-score': 0.48049627562668634, 'support': 288493}, '2': {'precision': 0.3559, 'recall': 0.011904921191361825, 'f1-score': 0.023039177606877445, 'support': 298952}, 'accuracy': 0.32643397619161885, 'macro avg': {'precision': 0.33160000257412, 'recall': 0.3300074843526472, 'f1-score': 0.208287641255987, 'support': 875154}, 'weighted avg': {'precision': 0.3319083893365716, 'recall': 0.32643397619161885, 'f1-score': 0.20615163215649104, 'support': 875154}}
[[ 21674 262552   3483]
 [ 25088 260447   2958]
 [ 22810 272583   3559]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134608
{'0': {'precision': 0.3447993447993448, 'recall': 0.12743737860404106, 'f1-score': 0.18609448383829083, 'support': 118929}, '1': {'precision': 0.34226179966807163, 'recall': 0.8803048317315632, 'f1-score': 0.49288882622293, 'support': 121116}, '2': {'precision': 0.3494713411240957, 'recall': 0.005357401830729989, 'f1-score': 0.010553025592767482, 'support': 117221}, 'accuracy': 0.34261026797960065, 'macro avg': {'precision': 0.345510828530504, 'recall': 0.33769987072211144, 'f1-score': 0.2298454452179961, 'support': 357266}, 'weighted avg': {'precision': 0.3454720054081471, 'recall': 0.34261026797960065, 'f1-score': 0.2325040450483121, 'support': 357266}}
[[ 15156 103196    577]
 [ 13905 106619    592]
 [ 14895 101698    628]]
training model: results/universal/W9/deepOF_L2/h50
Epoch 1/50
6697/6697 - 164s - loss: 2.9428 - accuracy50: 0.5016 - val_loss: 3.1694 - val_accuracy50: 0.3914 - 164s/epoch - 25ms/step
Epoch 2/50
6697/6697 - 166s - loss: 2.8641 - accuracy50: 0.5192 - val_loss: 3.1354 - val_accuracy50: 0.4307 - 166s/epoch - 25ms/step
Epoch 3/50
6697/6697 - 160s - loss: 2.8363 - accuracy50: 0.5248 - val_loss: 3.1319 - val_accuracy50: 0.4373 - 160s/epoch - 24ms/step
Epoch 4/50
6697/6697 - 157s - loss: 2.8211 - accuracy50: 0.5278 - val_loss: 3.1337 - val_accuracy50: 0.4421 - 157s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 160s - loss: 2.8116 - accuracy50: 0.5300 - val_loss: 3.1313 - val_accuracy50: 0.4495 - 160s/epoch - 24ms/step
Epoch 6/50
6697/6697 - 161s - loss: 2.8045 - accuracy50: 0.5316 - val_loss: 3.1435 - val_accuracy50: 0.4500 - 161s/epoch - 24ms/step
Epoch 7/50
6697/6697 - 153s - loss: 2.7981 - accuracy50: 0.5334 - val_loss: 3.1368 - val_accuracy50: 0.4516 - 153s/epoch - 23ms/step
Epoch 8/50
6697/6697 - 156s - loss: 2.7928 - accuracy50: 0.5346 - val_loss: 3.1413 - val_accuracy50: 0.4518 - 156s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 157s - loss: 2.7887 - accuracy50: 0.5357 - val_loss: 3.1401 - val_accuracy50: 0.4521 - 157s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 158s - loss: 2.7849 - accuracy50: 0.5365 - val_loss: 3.1393 - val_accuracy50: 0.4523 - 158s/epoch - 24ms/step
Epoch 11/50
6697/6697 - 163s - loss: 2.7816 - accuracy50: 0.5375 - val_loss: 3.1428 - val_accuracy50: 0.4532 - 163s/epoch - 24ms/step
Epoch 12/50
6697/6697 - 158s - loss: 2.7780 - accuracy50: 0.5382 - val_loss: 3.1406 - val_accuracy50: 0.4546 - 158s/epoch - 24ms/step
Epoch 13/50
6697/6697 - 155s - loss: 2.7749 - accuracy50: 0.5390 - val_loss: 3.1472 - val_accuracy50: 0.4558 - 155s/epoch - 23ms/step
Epoch 14/50
6697/6697 - 152s - loss: 2.7718 - accuracy50: 0.5396 - val_loss: 3.1542 - val_accuracy50: 0.4542 - 152s/epoch - 23ms/step
Epoch 15/50
6697/6697 - 152s - loss: 2.7695 - accuracy50: 0.5403 - val_loss: 3.1479 - val_accuracy50: 0.4544 - 152s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 128s - 128s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1483926
{'0': {'precision': 0.3666079262243482, 'recall': 0.5497476087078291, 'f1-score': 0.43987693224352814, 'support': 1213988}, '1': {'precision': 0.7153824148646174, 'recall': 0.2517681100439091, 'f1-score': 0.37245593919549874, 'support': 1877287}, '2': {'precision': 0.37470210313951674, 'recall': 0.5626549139634052, 'f1-score': 0.4498349631082408, 'support': 1216401}, 'accuracy': 0.4235327819455317, 'macro avg': {'precision': 0.4855641480761608, 'recall': 0.4547235442383812, 'f1-score': 0.42072261151575585, 'support': 4307676}, 'weighted avg': {'precision': 0.5208896266934209, 'recall': 0.4235327819455317, 'f1-score': 0.4133067828000025, 'support': 4307676}}
[[667387  94324 452277]
 [714782 472641 689864]
 [438269  93718 684414]]
Evaluating performance on  train set...
6697/6697 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0837064
{'0': {'precision': 0.38778724389298286, 'recall': 0.5559616328242549, 'f1-score': 0.4568902482895479, 'support': 491149}, '1': {'precision': 0.7235951488366216, 'recall': 0.30952321552321554, 'f1-score': 0.43357954892940387, 'support': 721500}, '2': {'precision': 0.40450042283267945, 'recall': 0.5657624414081979, 'f1-score': 0.47173019849938425, 'support': 501350}, 'accuracy': 0.45509128068336097, 'macro avg': {'precision': 0.5052942718540946, 'recall': 0.4770824299185561, 'f1-score': 0.45406666523944533, 'support': 1713999}, 'weighted avg': {'precision': 0.5340326942568699, 'recall': 0.45509128068336097, 'f1-score': 0.4514184478097096, 'support': 1713999}}
[[273060  42470 175619]
 [256220 223321 241959]
 [174869  42836 283645]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960658
{'0': {'precision': 0.3800533801817629, 'recall': 0.5832438962426052, 'f1-score': 0.46021891613805904, 'support': 192873}, '1': {'precision': 0.7123811551595653, 'recall': 0.30030240473905506, 'f1-score': 0.42250073459594795, 'support': 289678}, '2': {'precision': 0.40371797991851216, 'recall': 0.5404331788517923, 'f1-score': 0.4621772461332447, 'support': 190314}, 'accuracy': 0.44932490172620065, 'macro avg': {'precision': 0.4987175050866135, 'recall': 0.47465982661115086, 'f1-score': 0.4482989656224172, 'support': 672865}, 'weighted avg': {'precision': 0.5298185631446448, 'recall': 0.44932490172620065, 'f1-score': 0.4445345964334349, 'support': 672865}}
[[112492  17948  62433]
 [113210  86991  89477]
 [ 70288  17174 102852]]
testing model out of sample: results/universal/W9/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95099807
{'0': {'precision': 0.4363250089629829, 'recall': 0.551117156861878, 'f1-score': 0.4870486732892126, 'support': 565319}, '1': {'precision': 0.7116290074842503, 'recall': 0.49109778479973437, 'f1-score': 0.5811451635014891, 'support': 1096244}, '2': {'precision': 0.4149580784964964, 'recall': 0.559141095588864, 'f1-score': 0.4763788345305565, 'support': 549677}, 'accuracy': 0.5233565782095114, 'macro avg': {'precision': 0.5209706983145765, 'recall': 0.5337853457501588, 'f1-score': 0.514857557107086, 'support': 2211240}, 'weighted avg': {'precision': 0.5674982178036883, 'recall': 0.5233565782095114, 'f1-score': 0.5310455926000631, 'support': 2211240}}
[[311557 114136 139626]
 [264184 538363 293697]
 [138307 104023 307347]]
Evaluating performance on  train set...
3947/3947 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9765573
{'0': {'precision': 0.41086622539377143, 'recall': 0.5516962158076979, 'f1-score': 0.47097898702551283, 'support': 259342}, '1': {'precision': 0.7188951713116423, 'recall': 0.48363294463918893, 'f1-score': 0.5782507435403027, 'support': 489245}, '2': {'precision': 0.4162196494903703, 'recall': 0.5297926716656385, 'f1-score': 0.46618868522511375, 'support': 260987}, 'accuracy': 0.5130500587376458, 'macro avg': {'precision': 0.5153270153985946, 'recall': 0.5217072773708418, 'f1-score': 0.5051394719303098, 'support': 1009574}, 'weighted avg': {'precision': 0.5615226366526666, 'recall': 0.5130500587376458, 'f1-score': 0.5217251076864031, 'support': 1009574}}
[[143078  45043  71221]
 [129918 236615 122712]
 [ 75239  47479 138269]]
Evaluating performance on  val set...
1402/1402 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97453034
{'0': {'precision': 0.4197481874622819, 'recall': 0.5478479482946514, 'f1-score': 0.47531852351129456, 'support': 92679}, '1': {'precision': 0.7348991512114207, 'recall': 0.4822231871471993, 'f1-score': 0.5823332622534196, 'support': 172725}, '2': {'precision': 0.41783927706954976, 'recall': 0.5578271594299686, 'f1-score': 0.4777905405093713, 'support': 92837}, 'accuracy': 0.5187932146236751, 'macro avg': {'precision': 0.5241622052477508, 'recall': 0.5292994316239398, 'f1-score': 0.5118141087580285, 'support': 358241}, 'weighted avg': {'precision': 0.571202746542454, 'recall': 0.5187932146236751, 'f1-score': 0.5275560267319868, 'support': 358241}}
[[50774 15085 26820]
 [44100 83292 45333]
 [26089 14961 51787]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.14641
{'0': {'precision': 0.34843215117075177, 'recall': 0.5179320170974965, 'f1-score': 0.4166011787819254, 'support': 24565}, '1': {'precision': 0.4841417910447761, 'recall': 0.11025194374814122, 'f1-score': 0.17960341904003876, 'support': 23537}, '2': {'precision': 0.41370353784146885, 'recall': 0.5081780842012615, 'f1-score': 0.4560999292332505, 'support': 27268}, 'accuracy': 0.38709035425235505, 'macro avg': {'precision': 0.4154258266856656, 'recall': 0.3787873483489664, 'f1-score': 0.3507681756850715, 'support': 75370}, 'weighted avg': {'precision': 0.41442681702523004, 'recall': 0.38709035425235505, 'f1-score': 0.35688027731266636, 'support': 75370}}
[[12723  1634 10208]
 [11512  2595  9430]
 [12280  1131 13857]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1265354
{'0': {'precision': 0.4052795776337893, 'recall': 0.48584579976985043, 'f1-score': 0.441920711762397, 'support': 17380}, '1': {'precision': 0.5489005235602095, 'recall': 0.15619785458879618, 'f1-score': 0.24319183484110415, 'support': 16780}, '2': {'precision': 0.398079561042524, 'recall': 0.598703212496316, 'f1-score': 0.47820150659133714, 'support': 16965}, 'accuracy': 0.4151002444987775, 'macro avg': {'precision': 0.4507532207455076, 'recall': 0.4135822889516542, 'f1-score': 0.3877713510649461, 'support': 51125}, 'weighted avg': {'precision': 0.450028940786347, 'recall': 0.4151002444987775, 'f1-score': 0.38873407370926594, 'support': 51125}}
[[ 8444  1136  7800]
 [ 6601  2621  7558]
 [ 5790  1018 10157]]
Evaluating performance on  val set...
53/53 - 1s - 644ms/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1455595
{'0': {'precision': 0.3877515912609668, 'recall': 0.5140250855188141, 'f1-score': 0.44204746028633063, 'support': 4385}, '1': {'precision': 0.5862457722660653, 'recall': 0.10831076858987711, 'f1-score': 0.1828410689170183, 'support': 4801}, '2': {'precision': 0.39410029498525073, 'recall': 0.6222636236609222, 'f1-score': 0.48257178977785803, 'support': 4294}, 'accuracy': 0.40400593471810087, 'macro avg': {'precision': 0.4560325528374276, 'recall': 0.4148664925898711, 'f1-score': 0.3691534396604023, 'support': 13480}, 'weighted avg': {'precision': 0.46046909102339656, 'recall': 0.40400593471810087, 'f1-score': 0.3626380823837008, 'support': 13480}}
[[2254  182 1949]
 [2122  520 2159]
 [1437  185 2672]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8126041
{'0': {'precision': 0.3677778355608716, 'recall': 0.5336150305591187, 'f1-score': 0.4354411674157996, 'support': 39759}, '1': {'precision': 0.8154656240811126, 'recall': 0.7311139752189578, 'f1-score': 0.7709894975288303, 'support': 204834}, '2': {'precision': 0.46657742079428827, 'recall': 0.5031761308950914, 'f1-score': 0.48418615420236166, 'support': 41560}, 'accuracy': 0.6705678430769554, 'macro avg': {'precision': 0.5499402934787575, 'recall': 0.5893017122243894, 'f1-score': 0.5635389397156638, 'support': 286153}, 'weighted avg': {'precision': 0.7025909992741853, 'recall': 0.6705678430769554, 'f1-score': 0.6827129007235826, 'support': 286153}}
[[ 21216  16356   2187]
 [ 33356 149757  21721]
 [  3115  17533  20912]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8481245
{'0': {'precision': 0.4033838929676145, 'recall': 0.5306402588489068, 'f1-score': 0.4583430374118693, 'support': 20398}, '1': {'precision': 0.8129476809107498, 'recall': 0.6719342675446002, 'f1-score': 0.7357452288959139, 'support': 88845}, '2': {'precision': 0.3994818652849741, 'recall': 0.579002703514569, 'f1-score': 0.47277409860191316, 'support': 19974}, 'accuracy': 0.6352647097518128, 'macro avg': {'precision': 0.5386044797211128, 'recall': 0.5938590766360252, 'f1-score': 0.5556207883032321, 'support': 129217}, 'weighted avg': {'precision': 0.6843821798716193, 'recall': 0.6352647097518128, 'f1-score': 0.6513056020791335, 'support': 129217}}
[[10824  7138  2436]
 [14198 59698 14949]
 [ 1811  6598 11565]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8464478
{'0': {'precision': 0.38866281820762755, 'recall': 0.5495049504950495, 'f1-score': 0.4552962696081149, 'support': 7474}, '1': {'precision': 0.8136268741696716, 'recall': 0.6537851521991094, 'f1-score': 0.7250004227900763, 'support': 32786}, '2': {'precision': 0.4223323240664281, 'recall': 0.6095881340219839, 'f1-score': 0.498970189701897, 'support': 7551}, 'accuracy': 0.6305034406308172, 'macro avg': {'precision': 0.5415406721479091, 'recall': 0.6042927455720476, 'f1-score': 0.559755627366696, 'support': 47811}, 'weighted avg': {'precision': 0.6853959962944984, 'recall': 0.6305034406308172, 'f1-score': 0.647141287216028, 'support': 47811}}
[[ 4107  2634   733]
 [ 5788 21435  5563]
 [  672  2276  4603]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1368011
{'0': {'precision': 0.39170231626006863, 'recall': 0.47219383014309607, 'f1-score': 0.42819826841650693, 'support': 43048}, '1': {'precision': 0.44340390879478825, 'recall': 0.13059433011944166, 'f1-score': 0.20176381220587689, 'support': 41694}, '2': {'precision': 0.37409600950046434, 'recall': 0.5446545341697515, 'f1-score': 0.4435438742170153, 'support': 45113}, 'accuracy': 0.3876862654499249, 'macro avg': {'precision': 0.40306741151844044, 'recall': 0.3824808981440964, 'f1-score': 0.3578353182797997, 'support': 129855}, 'weighted avg': {'precision': 0.4021861088155849, 'recall': 0.3876862654499249, 'f1-score': 0.3608256458546674, 'support': 129855}}
[[20327  3736 18985]
 [14124  5445 22125]
 [17443  3099 24571]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1904268
{'0': {'precision': 0.36380299888818773, 'recall': 0.5344545976250387, 'f1-score': 0.43291854394622037, 'support': 22653}, '1': {'precision': 0.45964992043646286, 'recall': 0.09210166712216453, 'f1-score': 0.15345501460934238, 'support': 21954}, '2': {'precision': 0.3671297563646318, 'recall': 0.4812289751065261, 'f1-score': 0.41650653157087675, 'support': 22295}, 'accuracy': 0.3715583988520523, 'macro avg': {'precision': 0.3968608918964274, 'recall': 0.3692617466179098, 'f1-score': 0.3342933633754798, 'support': 66902}, 'weighted avg': {'precision': 0.39636395930204915, 'recall': 0.3715583988520523, 'f1-score': 0.33574285205404814, 'support': 66902}}
[[12107  1176  9370]
 [10807  2022  9125]
 [10365  1201 10729]]
Evaluating performance on  val set...
73/73 - 1s - 803ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2244731
{'0': {'precision': 0.365938957185248, 'recall': 0.5400375351892399, 'f1-score': 0.4362602653190145, 'support': 6394}, '1': {'precision': 0.41688311688311686, 'recall': 0.05419550903258484, 'f1-score': 0.09592111160914389, 'support': 5923}, '2': {'precision': 0.3684148218302356, 'recall': 0.4911616161616162, 'f1-score': 0.4210241493607523, 'support': 6336}, 'accuracy': 0.36916313729694955, 'macro avg': {'precision': 0.3837456319662002, 'recall': 0.36179822012781365, 'f1-score': 0.31773517542963686, 'support': 18653}, 'weighted avg': {'precision': 0.38295655951630025, 'recall': 0.36916313729694955, 'f1-score': 0.3230149515284654, 'support': 18653}}
[[3453  232 2709]
 [2976  321 2626]
 [3007  217 3112]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3397518
{'0': {'precision': 0.3268412680797544, 'recall': 0.36260849937414075, 'f1-score': 0.34379711864901413, 'support': 48733}, '1': {'precision': 0.6194690265486725, 'recall': 0.012829056981006332, 'f1-score': 0.025137521832100943, 'support': 60020}, '2': {'precision': 0.28928647110465294, 'recall': 0.627926842624028, 'f1-score': 0.3960926813766805, 'support': 45655}, 'accuracy': 0.30509429563235063, 'macro avg': {'precision': 0.41186558857769334, 'recall': 0.33445479965972497, 'f1-score': 0.2550091072859319, 'support': 154408}, 'weighted avg': {'precision': 0.42948461432739843, 'recall': 0.30509429563235063, 'f1-score': 0.23539344083038088, 'support': 154408}}
[[17671   225 30837]
 [19656   770 39594]
 [16739   248 28668]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2587073
{'0': {'precision': 0.3535032911223228, 'recall': 0.35994964787534445, 'f1-score': 0.35669734668419806, 'support': 29393}, '1': {'precision': 0.4643423137876387, 'recall': 0.010789115145266414, 'f1-score': 0.02108823952785375, 'support': 27157}, '2': {'precision': 0.30870859337494, 'recall': 0.6162928886333142, 'f1-score': 0.41136131013306043, 'support': 26085}, 'accuracy': 0.3261208930840443, 'macro avg': {'precision': 0.37551806609496713, 'recall': 0.32901055055130835, 'f1-score': 0.26304896544837075, 'support': 82635}, 'weighted avg': {'precision': 0.3757890737541556, 'recall': 0.3261208930840443, 'f1-score': 0.2636589605707925, 'support': 82635}}
[[10580   194 18619]
 [ 9484   293 17380]
 [ 9865   144 16076]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2128484
{'0': {'precision': 0.37145505097312326, 'recall': 0.38427612655800575, 'f1-score': 0.3777568331762488, 'support': 10430}, '1': {'precision': 0.37168141592920356, 'recall': 0.010403765172157542, 'f1-score': 0.02024096385542169, 'support': 8074}, '2': {'precision': 0.34496813823985306, 'recall': 0.605075017621589, 'f1-score': 0.4394149908592322, 'support': 9931}, 'accuracy': 0.3552312291190434, 'macro avg': {'precision': 0.3627015350473933, 'recall': 0.3332516364505841, 'f1-score': 0.27913759596363424, 'support': 28435}, 'weighted avg': {'precision': 0.3622687010628467, 'recall': 0.3552312291190434, 'f1-score': 0.29777596576120924, 'support': 28435}}
[[4008   63 6359]
 [2939   84 5051]
 [3843   79 6009]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.142229
{'0': {'precision': 0.4237710566054333, 'recall': 0.4553115745699704, 'f1-score': 0.43897549604003255, 'support': 63484}, '1': {'precision': 0.2890792291220557, 'recall': 0.017176446638505777, 'f1-score': 0.032426200369898885, 'support': 39298}, '2': {'precision': 0.3857536359629793, 'recall': 0.5982536482006766, 'f1-score': 0.46905856030867754, 'support': 58522}, 'accuracy': 0.4004302435153499, 'macro avg': {'precision': 0.36620130723015604, 'recall': 0.3569138898030509, 'f1-score': 0.3134867522395363, 'support': 161304}, 'weighted avg': {'precision': 0.37716356437164206, 'recall': 0.4004302435153499, 'f1-score': 0.3508434402068526, 'support': 161304}}
[[28905   873 33706]
 [16580   675 22043]
 [22724   787 35011]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1949717
{'0': {'precision': 0.3616178319811207, 'recall': 0.5177959203808302, 'f1-score': 0.42583877642095014, 'support': 40543}, '1': {'precision': 0.47678142514011207, 'recall': 0.05917277356850081, 'f1-score': 0.10527944133831298, 'support': 40255}, '2': {'precision': 0.3771441187459665, 'recall': 0.539882819147643, 'f1-score': 0.4440733889916512, 'support': 41133}, 'accuracy': 0.37383438174049255, 'macro avg': {'precision': 0.4051811252890664, 'recall': 0.37228383769899137, 'f1-score': 0.3250638689169714, 'support': 121931}, 'weighted avg': {'precision': 0.40487634044995635, 'recall': 0.37383438174049255, 'f1-score': 0.326158861429021, 'support': 121931}}
[[20993  1283 18267]
 [19465  2382 18408]
 [17595  1331 22207]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.211741
{'0': {'precision': 0.35508382010732775, 'recall': 0.49572366240137905, 'f1-score': 0.4137797454344217, 'support': 15083}, '1': {'precision': 0.5565428109854604, 'recall': 0.12188937374690412, 'f1-score': 0.19998065015479877, 'support': 16958}, '2': {'precision': 0.3604325009048136, 'recall': 0.5370769853040313, 'f1-score': 0.43137148735719316, 'support': 14834}, 'accuracy': 0.373568, 'macro avg': {'precision': 0.42401971066586724, 'recall': 0.3848966738174382, 'f1-score': 0.3483772943154712, 'support': 46875}, 'weighted avg': {'precision': 0.42965840993690174, 'recall': 0.373568, 'f1-score': 0.34200056339560664, 'support': 46875}}
[[7477  768 6838]
 [7592 2067 7299]
 [5988  879 7967]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8560697
{'0': {'precision': 0.39675605481800874, 'recall': 0.6257419245797003, 'f1-score': 0.4856085827704201, 'support': 100583}, '1': {'precision': 0.8067756617893443, 'recall': 0.5728000634412412, 'f1-score': 0.6699467695817072, 'support': 403523}, '2': {'precision': 0.38886981074481075, 'recall': 0.6222423477694562, 'f1-score': 0.47862398246712595, 'support': 98272}, 'accuracy': 0.5897061313660193, 'macro avg': {'precision': 0.530800509117388, 'recall': 0.6069281119301326, 'f1-score': 0.5447264449397511, 'support': 602378}, 'weighted avg': {'precision': 0.6701348051812905, 'recall': 0.5897061313660193, 'f1-score': 0.6079541988381478, 'support': 602378}}
[[ 62939  28044   9600]
 [ 85886 231138  86499]
 [  9809  27314  61149]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85376096
{'0': {'precision': 0.3838751655175563, 'recall': 0.6477579166345635, 'f1-score': 0.4820670871559633, 'support': 51916}, '1': {'precision': 0.8057796664682173, 'recall': 0.5496347468900973, 'f1-score': 0.6535041957110509, 'support': 214235}, '2': {'precision': 0.4071301744246771, 'recall': 0.6526276625430193, 'f1-score': 0.5014436408335955, 'support': 53755}, 'accuracy': 0.582864966583934, 'macro avg': {'precision': 0.5322616688034836, 'recall': 0.61667344202256, 'f1-score': 0.5456716412335365, 'support': 319906}, 'weighted avg': {'precision': 0.670324259204349, 'recall': 0.582864966583934, 'f1-score': 0.6001311922188265, 'support': 319906}}
[[ 33629  13733   4554]
 [ 49951 117751  46533]
 [  4024  14649  35082]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86707973
{'0': {'precision': 0.3458560367077717, 'recall': 0.6469326050911928, 'f1-score': 0.4507415524183273, 'support': 20506}, '1': {'precision': 0.8117302371005372, 'recall': 0.5253344569682924, 'f1-score': 0.6378597314005543, 'support': 85437}, '2': {'precision': 0.4068063938851649, 'recall': 0.648674792029406, 'f1-score': 0.5000279615994034, 'support': 20676}, 'accuracy': 0.5651679447792195, 'macro avg': {'precision': 0.5214642225644913, 'recall': 0.6069806180296304, 'f1-score': 0.529543081806095, 'support': 126619}, 'weighted avg': {'precision': 0.6701604747775439, 'recall': 0.5651679447792195, 'f1-score': 0.5850488969237526, 'support': 126619}}
[[13266  5030  2210]
 [23207 44883 17347]
 [ 1884  5380 13412]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8702903
{'0': {'precision': 0.4229355445375278, 'recall': 0.5592512419955576, 'f1-score': 0.48163390469051554, 'support': 176933}, '1': {'precision': 0.7897173083058051, 'recall': 0.5928361409781203, 'f1-score': 0.6772583899192118, 'support': 647221}, '2': {'precision': 0.3646485939697787, 'recall': 0.5930827428845923, 'f1-score': 0.4516230804578781, 'support': 166540}, 'accuracy': 0.5868795006328896, 'macro avg': {'precision': 0.5257671489377039, 'recall': 0.5817233752860901, 'f1-score': 0.5368384583558684, 'support': 990694}, 'weighted avg': {'precision': 0.6527560049221828, 'recall': 0.5868795006328896, 'f1-score': 0.6043905503212538, 'support': 990694}}
[[ 98950  55560  22423]
 [113851 383696 149674]
 [ 21159  46609  98772]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85841376
{'0': {'precision': 0.3779456129617519, 'recall': 0.5666703569564598, 'f1-score': 0.4534553347128096, 'support': 63229}, '1': {'precision': 0.8142384657482095, 'recall': 0.6135893362405012, 'f1-score': 0.6998155366411307, 'support': 278851}, '2': {'precision': 0.36042323962951317, 'recall': 0.5783493407130067, 'f1-score': 0.44409167328112603, 'support': 61430}, 'accuracy': 0.6008723451711234, 'macro avg': {'precision': 0.5175357727798248, 'recall': 0.5862030113033226, 'f1-score': 0.5324541815450221, 'support': 403510}, 'weighted avg': {'precision': 0.6767840528977065, 'recall': 0.6008723451711234, 'f1-score': 0.6222803426337186, 'support': 403510}}
[[ 35830  20066   7333]
 [ 52039 171100  55712]
 [  6933  18969  35528]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84736776
{'0': {'precision': 0.3862624668958134, 'recall': 0.5973595921746329, 'f1-score': 0.46915903841218237, 'support': 22951}, '1': {'precision': 0.8367138795752113, 'recall': 0.6116076004808544, 'f1-score': 0.7066670973577105, 'support': 107309}, '2': {'precision': 0.366778854670142, 'recall': 0.6250107805088401, 'f1-score': 0.46227693877876475, 'support': 23190}, 'accuracy': 0.6115021179537309, 'macro avg': {'precision': 0.5299184003803888, 'recall': 0.6113259910547758, 'f1-score': 0.5460343581828858, 'support': 153450}, 'weighted avg': {'precision': 0.6983228492724844, 'recall': 0.6115021179537309, 'f1-score': 0.6342105627320698, 'support': 153450}}
[[13710  6574  2667]
 [19322 65631 22356]
 [ 2462  6234 14494]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0130808
{'0': {'precision': 0.4806293299201579, 'recall': 0.5755698265474305, 'f1-score': 0.5238325335932839, 'support': 216601}, '1': {'precision': 0.49188337273443655, 'recall': 0.30889215497063, 'f1-score': 0.37947941649416217, 'support': 202077}, '2': {'precision': 0.465164903546982, 'recall': 0.5373743763748509, 'f1-score': 0.498669139376797, 'support': 208659}, 'accuracy': 0.47696373719388463, 'macro avg': {'precision': 0.4792258687338588, 'recall': 0.4739454526309705, 'f1-score': 0.46732702982141433, 'support': 627337}, 'weighted avg': {'precision': 0.4791108342267434, 'recall': 0.47696373719388463, 'f1-score': 0.4689640761009677, 'support': 627337}}
[[124669  31475  60457]
 [ 71192  62420  68465]
 [ 63526  33005 112128]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9919721
{'0': {'precision': 0.474554397584494, 'recall': 0.5666834667648826, 'f1-score': 0.5165431269823039, 'support': 103174}, '1': {'precision': 0.5295172392833807, 'recall': 0.3444843164585743, 'f1-score': 0.41741432387432176, 'support': 101157}, '2': {'precision': 0.48003387677323733, 'recall': 0.5515925922321594, 'f1-score': 0.5133314012461963, 'support': 102757}, 'accuracy': 0.4884397957588704, 'macro avg': {'precision': 0.49470183788037064, 'recall': 0.48758679181853876, 'f1-score': 0.4824296173676073, 'support': 307088}, 'weighted avg': {'precision': 0.4944930829799897, 'recall': 0.4884397957588704, 'f1-score': 0.4828146855014926, 'support': 307088}}
[[58467 15325 29382]
 [34297 34847 32013]
 [30440 15637 56680]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97876936
{'0': {'precision': 0.4773741375182291, 'recall': 0.5709822707037047, 'f1-score': 0.5199990516158096, 'support': 38411}, '1': {'precision': 0.5553323881537492, 'recall': 0.3739921493740717, 'f1-score': 0.44696969696969696, 'support': 37704}, '2': {'precision': 0.4814850600256045, 'recall': 0.5443349081078129, 'f1-score': 0.510984644569202, 'support': 36619}, 'accuracy': 0.4964429542107971, 'macro avg': {'precision': 0.5047305285658609, 'recall': 0.49643644272852977, 'f1-score': 0.49265113105156955, 'support': 112734}, 'weighted avg': {'precision': 0.5047826899803011, 'recall': 0.4964429542107971, 'f1-score': 0.4926461912611983, 'support': 112734}}
[[21932  5923 10556]
 [12693 14101 10910]
 [11318  5368 19933]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
3337/3337 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9630383
{'0': {'precision': 0.4659720484131619, 'recall': 0.586122997873986, 'f1-score': 0.5191868071335124, 'support': 257289}, '1': {'precision': 0.5832657707131018, 'recall': 0.4239290089232323, 'f1-score': 0.49099396684031543, 'support': 344494}, '2': {'precision': 0.48277684722554565, 'recall': 0.5359229921422172, 'f1-score': 0.5079635875130346, 'support': 252234}, 'accuracy': 0.5058704920393856, 'macro avg': {'precision': 0.510671555450603, 'recall': 0.5153249996464785, 'f1-score': 0.5060481204956208, 'support': 854017}, 'weighted avg': {'precision': 0.518249374501095, 'recall': 0.5058704920393856, 'f1-score': 0.5044995797109714, 'support': 854017}}
[[150803  52113  54373]
 [108003 146041  90450]
 [ 64825  52231 135178]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97361445
{'0': {'precision': 0.46628934916272347, 'recall': 0.5697482191851961, 'f1-score': 0.5128530748824545, 'support': 115537}, '1': {'precision': 0.5598113871222276, 'recall': 0.44812602260187967, 'f1-score': 0.4977810088167916, 'support': 131405}, '2': {'precision': 0.4990354503319554, 'recall': 0.5014685643315095, 'f1-score': 0.5002490488010078, 'support': 119164}, 'accuracy': 0.5038704637454726, 'macro avg': {'precision': 0.5083787288723022, 'recall': 0.5064476020395284, 'f1-score': 0.503627710833418, 'support': 366106}, 'weighted avg': {'precision': 0.5105153924337952, 'recall': 0.5038704637454726, 'f1-score': 0.5033408270489638, 'support': 366106}}
[[65827 21373 28337]
 [40868 58886 31651]
 [34477 24930 59757]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98578155
{'0': {'precision': 0.4864897785176313, 'recall': 0.5463000957461359, 'f1-score': 0.5146630872483221, 'support': 43866}, '1': {'precision': 0.5009992209463808, 'recall': 0.39198070705464566, 'f1-score': 0.43983525878347235, 'support': 37734}, '2': {'precision': 0.501840386374758, 'recall': 0.5338478600366657, 'f1-score': 0.5173495350061416, 'support': 44183}, 'accuracy': 0.495631365128833, 'macro avg': {'precision': 0.4964431286129234, 'recall': 0.4907095542791491, 'f1-score': 0.4906159603459786, 'support': 125783}, 'weighted avg': {'precision': 0.49623461850044187, 'recall': 0.495631365128833, 'f1-score': 0.49315892565248715, 'support': 125783}}
[[23964  7218 12684]
 [12213 14791 10730]
 [13082  7514 23587]]
testing model on single stock: results/universal/W9/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
10303/10303 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.272567
{'0': {'precision': 0.3417441016572908, 'recall': 0.5458535812903929, 'f1-score': 0.4203306190593004, 'support': 808312}, '1': {'precision': 0.45899222943202755, 'recall': 0.028453576710338258, 'f1-score': 0.05358532351708864, 'support': 1006833}, '2': {'precision': 0.35957105760408503, 'recall': 0.5614486990045667, 'f1-score': 0.4383851726153368, 'support': 822255}, 'accuracy': 0.35319708804125277, 'macro avg': {'precision': 0.38676912956446774, 'recall': 0.37858528566843264, 'f1-score': 0.3041003717305753, 'support': 2637400}, 'weighted avg': {'precision': 0.3920616825679804, 'recall': 0.35319708804125277, 'f1-score': 0.2859536496149867, 'support': 2637400}}
[[441220  18128 348964]
 [504901  28648 473284]
 [344962  15639 461654]]
Evaluating performance on  train set...
3419/3419 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2184652
{'0': {'precision': 0.36560483031438684, 'recall': 0.5582042002598964, 'f1-score': 0.4418275750994345, 'support': 286268}, '1': {'precision': 0.470364571684187, 'recall': 0.036245372381129654, 'f1-score': 0.06730439958906871, 'support': 290106}, '2': {'precision': 0.3945661194299116, 'recall': 0.5490044481037823, 'f1-score': 0.45914648483423465, 'support': 298779}, 'accuracy': 0.3820383407244219, 'macro avg': {'precision': 0.4101785071428285, 'recall': 0.3811513402482694, 'f1-score': 0.3227594865075793, 'support': 875153}, 'weighted avg': {'precision': 0.41021926291128663, 'recall': 0.3820383407244219, 'f1-score': 0.32358894274262795, 'support': 875153}}
[[159796   6020 120452]
 [148349  10515 131242]
 [128928   5820 164031]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2383149
{'0': {'precision': 0.36352991829962406, 'recall': 0.5965860131665116, 'f1-score': 0.45177224440790337, 'support': 116052}, '1': {'precision': 0.43760307861462344, 'recall': 0.0506695735894396, 'f1-score': 0.09082286830826719, 'support': 125677}, '2': {'precision': 0.38689233032536025, 'recall': 0.5098712966409029, 'f1-score': 0.4399493650088313, 'support': 115537}, 'accuracy': 0.3765037814961401, 'macro avg': {'precision': 0.3960084424132026, 'recall': 0.38570896113228476, 'f1-score': 0.327514825908334, 'support': 357266}, 'weighted avg': {'precision': 0.39714217238236815, 'recall': 0.3765037814961401, 'f1-score': 0.3209761015977715, 'support': 357266}}
[[69235  4246 42571]
 [68527  6368 50782]
 [52690  3938 58909]]
training model: results/universal/W9/deepOF_L2/h100
Epoch 1/50
6697/6697 - 155s - loss: 3.1359 - accuracy100: 0.4389 - val_loss: 3.2204 - val_accuracy100: 0.3674 - 155s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 153s - loss: 3.0849 - accuracy100: 0.4530 - val_loss: 3.1904 - val_accuracy100: 0.3853 - 153s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 154s - loss: 3.0605 - accuracy100: 0.4605 - val_loss: 3.1819 - val_accuracy100: 0.3915 - 154s/epoch - 23ms/step
Epoch 4/50
6697/6697 - 153s - loss: 3.0460 - accuracy100: 0.4642 - val_loss: 3.1796 - val_accuracy100: 0.3930 - 153s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 157s - loss: 3.0375 - accuracy100: 0.4664 - val_loss: 3.1805 - val_accuracy100: 0.3930 - 157s/epoch - 23ms/step
Epoch 6/50
6697/6697 - 154s - loss: 3.0312 - accuracy100: 0.4683 - val_loss: 3.1804 - val_accuracy100: 0.3958 - 154s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 151s - loss: 3.0258 - accuracy100: 0.4700 - val_loss: 3.1816 - val_accuracy100: 0.3951 - 151s/epoch - 23ms/step
Epoch 8/50
6697/6697 - 154s - loss: 3.0211 - accuracy100: 0.4717 - val_loss: 3.1855 - val_accuracy100: 0.3950 - 154s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 153s - loss: 3.0177 - accuracy100: 0.4725 - val_loss: 3.1882 - val_accuracy100: 0.3951 - 153s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 153s - loss: 3.0145 - accuracy100: 0.4737 - val_loss: 3.1904 - val_accuracy100: 0.3968 - 153s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 153s - loss: 3.0106 - accuracy100: 0.4749 - val_loss: 3.1883 - val_accuracy100: 0.3979 - 153s/epoch - 23ms/step
Epoch 12/50
6697/6697 - 152s - loss: 3.0073 - accuracy100: 0.4759 - val_loss: 3.1832 - val_accuracy100: 0.4008 - 152s/epoch - 23ms/step
Epoch 13/50
6697/6697 - 152s - loss: 3.0041 - accuracy100: 0.4770 - val_loss: 3.1847 - val_accuracy100: 0.4012 - 152s/epoch - 23ms/step
Epoch 14/50
6697/6697 - 152s - loss: 3.0011 - accuracy100: 0.4777 - val_loss: 3.1853 - val_accuracy100: 0.4001 - 152s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 132s - 132s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879487
{'0': {'precision': 0.3580011451497395, 'recall': 0.4878505360414402, 'f1-score': 0.41295904340769446, 'support': 1277793}, '1': {'precision': 0.5091754042123388, 'recall': 0.11111644076546019, 'f1-score': 0.18242302909339256, 'support': 1751208}, '2': {'precision': 0.35658778091945265, 'recall': 0.6091297632314701, 'f1-score': 0.4498380129433708, 'support': 1278675}, 'accuracy': 0.3706961712069339, 'macro avg': {'precision': 0.40792144342717696, 'recall': 0.40269891334612345, 'f1-score': 0.3484066951481526, 'support': 4307676}, 'weighted avg': {'precision': 0.41903877619658103, 'recall': 0.3706961712069339, 'f1-score': 0.33018580415193594, 'support': 4307676}}
[[623372  94079 560342]
 [711585 194588 845035]
 [406300  93496 778879]]
Evaluating performance on  train set...
6697/6697 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0686148
{'0': {'precision': 0.3795808989639324, 'recall': 0.4642009275101649, 'f1-score': 0.4176477848556951, 'support': 524846}, '1': {'precision': 0.5189997633327369, 'recall': 0.13734146181259385, 'f1-score': 0.2172046595449648, 'support': 654653}, '2': {'precision': 0.38092690035709914, 'recall': 0.6406342376052385, 'f1-score': 0.4777683984345023, 'support': 534500}, 'accuracy': 0.39437829310285477, 'macro avg': {'precision': 0.42650252088458945, 'recall': 0.41405887564266575, 'f1-score': 0.37087361427838744, 'support': 1713999}, 'weighted avg': {'precision': 0.43325095102363526, 'recall': 0.39437829310285477, 'f1-score': 0.3598378180143066, 'support': 1713999}}
[[243634  41928 239284]
 [247535  89911 317207]
 [150681  41400 342419]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0685182
{'0': {'precision': 0.37868563802146615, 'recall': 0.4871357122246802, 'f1-score': 0.426118616581586, 'support': 207940}, '1': {'precision': 0.5118744935877735, 'recall': 0.14081535398876274, 'f1-score': 0.22086995310258356, 'support': 260206}, '2': {'precision': 0.3798353465631291, 'recall': 0.6193172104201369, 'f1-score': 0.4708761752313323, 'support': 204719}, 'accuracy': 0.39342512985517153, 'macro avg': {'precision': 0.4234651593907896, 'recall': 0.4157560922111933, 'f1-score': 0.37262158163850057, 'support': 672865}, 'weighted avg': {'precision': 0.43054136916282026, 'recall': 0.39342512985517153, 'f1-score': 0.3603636567010752, 'support': 672865}}
[[101295  17979  88666]
 [105225  36641 118340]
 [ 60971  16962 126786]]
testing model out of sample: results/universal/W9/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0461293
{'0': {'precision': 0.39230046631454013, 'recall': 0.546124848672784, 'f1-score': 0.4566053992334697, 'support': 638517}, '1': {'precision': 0.5357985860297924, 'recall': 0.19613548396499636, 'f1-score': 0.2871545929798357, 'support': 960586}, '2': {'precision': 0.3706389374495864, 'recall': 0.5877556821430496, 'f1-score': 0.45460426645978347, 'support': 612137}, 'accuracy': 0.4056104267288942, 'macro avg': {'precision': 0.4329126632646396, 'recall': 0.44333867159361, 'f1-score': 0.39945475289102966, 'support': 2211240}, 'weighted avg': {'precision': 0.44864100896481285, 'recall': 0.4056104267288942, 'f1-score': 0.38244020703875575, 'support': 2211240}}
[[348710  84087 205720]
 [366967 188405 405214]
 [173208  79142 359787]]
Evaluating performance on  train set...
3947/3947 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0521115
{'0': {'precision': 0.36789093202658774, 'recall': 0.5254091658698152, 'f1-score': 0.4327622221968564, 'support': 288636}, '1': {'precision': 0.5343084240015636, 'recall': 0.19181975104200288, 'f1-score': 0.2822942626223685, 'support': 427542}, '2': {'precision': 0.38251581565524573, 'recall': 0.5786888710139197, 'f1-score': 0.46058378319724386, 'support': 293396}, 'accuracy': 0.3996220187920846, 'macro avg': {'precision': 0.4282383905611324, 'recall': 0.4319725959752459, 'f1-score': 0.39188008933882296, 'support': 1009574}, 'weighted avg': {'precision': 0.4426168557439961, 'recall': 0.3996220187920846, 'f1-score': 0.3771262433967625, 'support': 1009574}}
[[151652  35504 101480]
 [172932  82011 172599]
 [ 87636  35975 169785]]
Evaluating performance on  val set...
1402/1402 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0508609
{'0': {'precision': 0.37076599703662866, 'recall': 0.5216868521337767, 'f1-score': 0.43346546778819817, 'support': 103127}, '1': {'precision': 0.5448782183684738, 'recall': 0.1750303826572508, 'f1-score': 0.26495097551759117, 'support': 152225}, '2': {'precision': 0.3810408129714985, 'recall': 0.6082380040626306, 'f1-score': 0.46855042189828017, 'support': 102889}, 'accuracy': 0.39924240943945555, 'macro avg': {'precision': 0.4322283427922004, 'recall': 0.4349850796178861, 'f1-score': 0.38898895506802317, 'support': 358241}, 'weighted avg': {'precision': 0.4477013518088712, 'recall': 0.39924240943945555, 'f1-score': 0.3719363219270016, 'support': 358241}}
[[53800 11053 38274]
 [62199 26644 63382]
 [29106 11202 62581]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11893
{'0': {'precision': 0.32558785410109237, 'recall': 0.45022402389588223, 'f1-score': 0.3778943786823301, 'support': 23435}, '1': {'precision': 0.37616727568006497, 'recall': 0.06680125455135369, 'f1-score': 0.11345476810041327, 'support': 27739}, '2': {'precision': 0.3429991061570009, 'recall': 0.5392213589022979, 'f1-score': 0.419288491821191, 'support': 24196}, 'accuracy': 0.3376807748441024, 'macro avg': {'precision': 0.348251411979386, 'recall': 0.3520822124498446, 'f1-score': 0.3035458795346448, 'support': 75370}, 'weighted avg': {'precision': 0.3497925141770362, 'recall': 0.3376807748441024, 'f1-score': 0.2938593727592319, 'support': 75370}}
[[10551  1636 11248]
 [12143  1853 13743]
 [ 9712  1437 13047]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1013262
{'0': {'precision': 0.3796151846073843, 'recall': 0.41612038989910505, 'f1-score': 0.3970304299350067, 'support': 17543}, '1': {'precision': 0.35860815372630483, 'recall': 0.08398710697561272, 'f1-score': 0.13609933970631713, 'support': 16443}, '2': {'precision': 0.37458993010982744, 'recall': 0.6129295758212264, 'f1-score': 0.46499789743930237, 'support': 17139}, 'accuracy': 0.3752762836185819, 'macro avg': {'precision': 0.37093775614783886, 'recall': 0.37101235756531475, 'f1-score': 0.3327092223602088, 'support': 51125}, 'weighted avg': {'precision': 0.37117417833626026, 'recall': 0.3752762836185819, 'f1-score': 0.3358940878113056, 'support': 51125}}
[[ 7300  1329  8914]
 [ 6437  1381  8625]
 [ 5493  1141 10505]]
Evaluating performance on  val set...
53/53 - 1s - 644ms/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1089185
{'0': {'precision': 0.3619595398651329, 'recall': 0.41401996370235933, 'f1-score': 0.3862433862433863, 'support': 4408}, '1': {'precision': 0.3696682464454976, 'recall': 0.0638689866939611, 'f1-score': 0.10891953220457322, 'support': 4885}, '2': {'precision': 0.35014485119831446, 'recall': 0.6350609027943636, 'f1-score': 0.45140480434598085, 'support': 4187}, 'accuracy': 0.35578635014836796, 'macro avg': {'precision': 0.3605908791696483, 'recall': 0.3709832843968946, 'f1-score': 0.3155225742646468, 'support': 13480}, 'weighted avg': {'precision': 0.36108334774325695, 'recall': 0.35578635014836796, 'f1-score': 0.30598402649679585, 'support': 13480}}
[[1825  264 2319]
 [1957  312 2616]
 [1260  268 2659]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.019072
{'0': {'precision': 0.2976327091565023, 'recall': 0.7231850664529487, 'f1-score': 0.42170803779628757, 'support': 59892}, '1': {'precision': 0.6395052629892497, 'recall': 0.24379756422315332, 'f1-score': 0.3530155697943337, 'support': 163726}, '2': {'precision': 0.40104333150068405, 'recall': 0.501575117933957, 'f1-score': 0.44571071291546477, 'support': 62535}, 'accuracy': 0.4004675820277963, 'macro avg': {'precision': 0.446060434548812, 'recall': 0.4895192495366863, 'f1-score': 0.4068114401686953, 'support': 286153}, 'weighted avg': {'precision': 0.5158383858997614, 'recall': 0.4004675820277963, 'f1-score': 0.38765025847015727, 'support': 286153}}
[[43313  9354  7225]
 [84190 39916 39620]
 [18022 13147 31366]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0205208
{'0': {'precision': 0.3456074169997936, 'recall': 0.6272138964577657, 'f1-score': 0.445651779340053, 'support': 29360}, '1': {'precision': 0.6504222514914387, 'recall': 0.23417995174135597, 'f1-score': 0.344371404251828, 'support': 71697}, '2': {'precision': 0.33984437350359137, 'recall': 0.6048650568181818, 'f1-score': 0.4351814001021973, 'support': 28160}, 'accuracy': 0.40426569259462763, 'macro avg': {'precision': 0.44529134733160786, 'recall': 0.4887529683391012, 'f1-score': 0.40840152789802603, 'support': 129217}, 'weighted avg': {'precision': 0.513480234691695, 'recall': 0.40426569259462763, 'f1-score': 0.38717383191797633, 'support': 129217}}
[[18415  4393  6552]
 [28372 16790 26535]
 [ 6496  4631 17033]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0175248
{'0': {'precision': 0.337618976428963, 'recall': 0.6270245256825544, 'f1-score': 0.43890904379372897, 'support': 10805}, '1': {'precision': 0.6361530715005035, 'recall': 0.24009882174078298, 'f1-score': 0.3486203090507726, 'support': 26310}, '2': {'precision': 0.3600538901987201, 'recall': 0.5996634255796559, 'f1-score': 0.4499473868817958, 'support': 10696}, 'accuracy': 0.4079814268682939, 'macro avg': {'precision': 0.4446086460427288, 'recall': 0.4889289243343311, 'f1-score': 0.41249224657543243, 'support': 47811}, 'weighted avg': {'precision': 0.5069188421296082, 'recall': 0.4079814268682939, 'f1-score': 0.3916933299743732, 'support': 47811}}
[[ 6775  1709  2321]
 [10914  6317  9079]
 [ 2378  1904  6414]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1107057
{'0': {'precision': 0.36635064701653486, 'recall': 0.3929018889745567, 'f1-score': 0.3791620163690476, 'support': 41504}, '1': {'precision': 0.3612137716397588, 'recall': 0.08100857198944315, 'f1-score': 0.13233800709080867, 'support': 45847}, '2': {'precision': 0.33928404897350156, 'recall': 0.5991671372106154, 'f1-score': 0.4332411857270446, 'support': 42504}, 'accuracy': 0.3502984097647376, 'macro avg': {'precision': 0.35561615587659845, 'recall': 0.3576925327248717, 'f1-score': 0.31491373639563364, 'support': 129855}, 'weighted avg': {'precision': 0.35567759623974426, 'recall': 0.3502984097647376, 'f1-score': 0.30971871931474, 'support': 129855}}
[[16307  3681 21516]
 [14055  3714 28078]
 [14150  2887 25467]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.106034
{'0': {'precision': 0.3571962337468241, 'recall': 0.42574036962814515, 'f1-score': 0.38846786809971756, 'support': 22455}, '1': {'precision': 0.36248147363963584, 'recall': 0.0771414409949083, 'f1-score': 0.12721058106702332, 'support': 22193}, '2': {'precision': 0.3636877029507271, 'recall': 0.5787723555315898, 'f1-score': 0.4466871282664864, 'support': 22254}, 'accuracy': 0.36100565005530477, 'macro avg': {'precision': 0.36112180344572903, 'recall': 0.3605513887182144, 'f1-score': 0.32078852581107575, 'support': 66902}, 'weighted avg': {'precision': 0.3611087697637568, 'recall': 0.36100565005530477, 'f1-score': 0.3211683620256792, 'support': 66902}}
[[ 9560  1646 11249]
 [ 9195  1712 11286]
 [ 8009  1365 12880]]
Evaluating performance on  val set...
73/73 - 1s - 806ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.107039
{'0': {'precision': 0.37549986670221275, 'recall': 0.43899018232819076, 'f1-score': 0.40477045764781955, 'support': 6417}, '1': {'precision': 0.357429718875502, 'recall': 0.059343223870645105, 'f1-score': 0.10178699070764832, 'support': 5999}, '2': {'precision': 0.36090595765632694, 'recall': 0.587622254288921, 'f1-score': 0.44716935090287946, 'support': 6237}, 'accuracy': 0.3665898246930789, 'macro avg': {'precision': 0.36461184774468053, 'recall': 0.36198522016258566, 'f1-score': 0.3179089330861158, 'support': 18653}, 'weighted avg': {'precision': 0.3648085555173295, 'recall': 0.3665898246930789, 'f1-score': 0.32150471374912876, 'support': 18653}}
[[2817  322 3278]
 [2431  356 3212]
 [2254  318 3665]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1502659
{'0': {'precision': 0.3091722696710885, 'recall': 0.28286711833409534, 'f1-score': 0.29543530637494303, 'support': 48118}, '1': {'precision': 0.3862962962962963, 'recall': 0.01728710179998011, 'f1-score': 0.033093251261224095, 'support': 60334}, '2': {'precision': 0.2924761338731845, 'recall': 0.6853294455566193, 'f1-score': 0.40998437906795104, 'support': 45956}, 'accuracy': 0.2988770011916481, 'macro avg': {'precision': 0.3293148999468564, 'recall': 0.3284945552302316, 'f1-score': 0.2461709789013727, 'support': 154408}, 'weighted avg': {'precision': 0.33433879864417804, 'recall': 0.2988770011916481, 'f1-score': 0.22701962604392883, 'support': 154408}}
[[13611   926 33581]
 [16683  1043 42608]
 [13730   731 31495]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1351494
{'0': {'precision': 0.3312542430414121, 'recall': 0.26678741072343914, 'f1-score': 0.29554617554087564, 'support': 29263}, '1': {'precision': 0.36319218241042345, 'recall': 0.016363369533313767, 'f1-score': 0.03131582642887235, 'support': 27256}, '2': {'precision': 0.3110703850343194, 'recall': 0.6889263286873947, 'f1-score': 0.42861056518372936, 'support': 26116}, 'accuracy': 0.31760150057481695, 'macro avg': {'precision': 0.33517227016205164, 'recall': 0.3240257029813825, 'f1-score': 0.25182418905115916, 'support': 82635}, 'weighted avg': {'precision': 0.33540961110250656, 'recall': 0.31760150057481695, 'f1-score': 0.25044721268634673, 'support': 82635}}
[[ 7807   446 21010]
 [ 7973   446 18837]
 [ 7788   336 17992]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1214
{'0': {'precision': 0.34740417273168367, 'recall': 0.2800156433320297, 'f1-score': 0.3100909484625379, 'support': 10228}, '1': {'precision': 0.25, 'recall': 0.013205718439544463, 'f1-score': 0.025086306098964326, 'support': 8254}, '2': {'precision': 0.3390027841052898, 'recall': 0.6728624535315985, 'f1-score': 0.4508549885552713, 'support': 9953}, 'accuracy': 0.3400738526463865, 'macro avg': {'precision': 0.31213565227899115, 'recall': 0.32202793843439087, 'f1-score': 0.26201074770559113, 'support': 28435}, 'weighted avg': {'precision': 0.31618936482854265, 'recall': 0.3400738526463865, 'f1-score': 0.2766320482682013, 'support': 28435}}
[[2864  166 7198]
 [2285  109 5860]
 [3095  161 6697]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1068902
{'0': {'precision': 0.3929379289192194, 'recall': 0.34218653489808526, 'f1-score': 0.3658103489814311, 'support': 59903}, '1': {'precision': 0.31840796019900497, 'recall': 0.03161036785706616, 'f1-score': 0.05751123266262941, 'support': 46567}, '2': {'precision': 0.3523704731378271, 'recall': 0.6716270926797243, 'f1-score': 0.4622307011653666, 'support': 54834}, 'accuracy': 0.3645166889847741, 'macro avg': {'precision': 0.35457212075201716, 'recall': 0.3484746651449586, 'f1-score': 0.295184094269809, 'support': 161304}, 'weighted avg': {'precision': 0.35763122280088944, 'recall': 0.3645166889847741, 'f1-score': 0.3095845185124798, 'support': 161304}}
[[20498  1757 37648]
 [15056  1472 30039]
 [16612  1394 36828]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1053766
{'0': {'precision': 0.35075005282062116, 'recall': 0.41198659883360217, 'f1-score': 0.37891012838801713, 'support': 40295}, '1': {'precision': 0.35949248120300753, 'recall': 0.05707535438945536, 'f1-score': 0.0985105378374898, 'support': 40210}, '2': {'precision': 0.3675476787311081, 'recall': 0.6052479119393618, 'f1-score': 0.4573570588181644, 'support': 41426}, 'accuracy': 0.3606055884065578, 'macro avg': {'precision': 0.35926340425157893, 'recall': 0.35810328838747313, 'f1-score': 0.3115925750145571, 'support': 121931}, 'weighted avg': {'precision': 0.35934008731737416, 'recall': 0.3606055884065578, 'f1-score': 0.3130931909722868, 'support': 121931}}
[[16601  2179 21515]
 [16286  2295 21629]
 [14443  1910 25073]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1078644
{'0': {'precision': 0.3529379371110744, 'recall': 0.4073603254306235, 'f1-score': 0.3782013454502538, 'support': 15733}, '1': {'precision': 0.3623536475532873, 'recall': 0.07615141955835962, 'f1-score': 0.12585370939992702, 'support': 15850}, '2': {'precision': 0.36135513098286387, 'recall': 0.5998561339262359, 'f1-score': 0.45101654497627647, 'support': 15292}, 'accuracy': 0.35816533333333334, 'macro avg': {'precision': 0.35888223854907525, 'recall': 0.361122626305073, 'f1-score': 0.3183571999421524, 'support': 46875}, 'weighted avg': {'precision': 0.3588676382139326, 'recall': 0.35816533333333334, 'f1-score': 0.316628652111678, 'support': 46875}}
[[6409 1119 8205]
 [6636 1207 8007]
 [5114 1005 9173]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/EXC
Evaluating performance on  test set...
2354/2354 - 21s - 21s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0025686
{'0': {'precision': 0.3766849774420148, 'recall': 0.6580669501989299, 'f1-score': 0.4791176081327084, 'support': 145780}, '1': {'precision': 0.6225066555806944, 'recall': 0.24883118211189334, 'f1-score': 0.35554307475240066, 'support': 312923}, '2': {'precision': 0.3934003539695802, 'recall': 0.6095562902383852, 'f1-score': 0.4781854963103308, 'support': 143675}, 'accuracy': 0.4339069487929506, 'macro avg': {'precision': 0.46419732899742977, 'recall': 0.5054848075164028, 'f1-score': 0.4376153930651466, 'support': 602378}, 'weighted avg': {'precision': 0.5083711258584376, 'recall': 0.4339069487929506, 'f1-score': 0.41470085507226107, 'support': 602378}}
[[ 95933  23258  26589]
 [126607  77865 108451]
 [ 32137  23960  87578]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9890082
{'0': {'precision': 0.3873622479052728, 'recall': 0.6723258223258223, 'f1-score': 0.4915288737828229, 'support': 77220}, '1': {'precision': 0.6165367254821502, 'recall': 0.2578861549401106, 'f1-score': 0.3636599386264425, 'support': 163134}, '2': {'precision': 0.42251557678739915, 'recall': 0.6248240144810941, 'f1-score': 0.5041304292705191, 'support': 79552}, 'accuracy': 0.4491725694422737, 'macro avg': {'precision': 0.47547151672494076, 'recall': 0.5183453305823423, 'f1-score': 0.4531064138932615, 'support': 319906}, 'weighted avg': {'precision': 0.5129699790646047, 'recall': 0.4491725694422737, 'f1-score': 0.42945660278558073, 'support': 319906}}
[[51917 12292 13011]
 [66138 42070 54926]
 [15972 13874 49706]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99462104
{'0': {'precision': 0.35840136766450353, 'recall': 0.6816522893165229, 'f1-score': 0.4697932863806824, 'support': 30140}, '1': {'precision': 0.6287761425251743, 'recall': 0.24444410985304746, 'f1-score': 0.3520317446550154, 'support': 66416}, '2': {'precision': 0.42208165612420934, 'recall': 0.6103848584638925, 'f1-score': 0.49906170959231966, 'support': 30063}, 'accuracy': 0.43540069025975564, 'macro avg': {'precision': 0.46975305543796236, 'recall': 0.5121604192111543, 'f1-score': 0.4402955802093391, 'support': 126619}, 'weighted avg': {'precision': 0.5153417285827737, 'recall': 0.43540069025975564, 'f1-score': 0.41497249370153905, 'support': 126619}}
[[20545  4460  5135]
 [30191 16235 19990]
 [ 6588  5125 18350]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0213882
{'0': {'precision': 0.37532467532467534, 'recall': 0.6091935898819058, 'f1-score': 0.46448175602780334, 'support': 240994}, '1': {'precision': 0.6133127657631143, 'recall': 0.2310707007367926, 'f1-score': 0.3356735800219954, 'support': 523078}, '2': {'precision': 0.34151468468916163, 'recall': 0.6064989277298762, 'f1-score': 0.4369732403724792, 'support': 226622}, 'accuracy': 0.4089315166943577, 'macro avg': {'precision': 0.44338404192565045, 'recall': 0.4822544061161915, 'f1-score': 0.4123761921407593, 'support': 990694}, 'weighted avg': {'precision': 0.49324630064243885, 'recall': 0.4089315166943577, 'f1-score': 0.3901795416976399, 'support': 990694}}
[[146812  39366  54816]
 [192012 120868 210198]
 [ 52336  36840 137446]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0194881
{'0': {'precision': 0.33074961632399574, 'recall': 0.6266631969587255, 'f1-score': 0.4329764738531052, 'support': 88384}, '1': {'precision': 0.6469014657478519, 'recall': 0.22996927958209715, 'f1-score': 0.33931446528680337, 'support': 228187}, '2': {'precision': 0.3352115766917099, 'recall': 0.5973728706334326, 'f1-score': 0.4294437944193392, 'support': 86939}, 'accuracy': 0.3960199251567495, 'macro avg': {'precision': 0.43762088625451917, 'recall': 0.48466844905808504, 'f1-score': 0.40057824451974927, 'support': 403510}, 'weighted avg': {'precision': 0.5104964886118948, 'recall': 0.3960199251567495, 'f1-score': 0.3792489816818805, 'support': 403510}}
[[55387 14073 18924]
 [91638 52476 84073]
 [20434 14570 51935]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0145372
{'0': {'precision': 0.32659632669011335, 'recall': 0.6437638649248213, 'f1-score': 0.43334612313467663, 'support': 32456}, '1': {'precision': 0.6753124774221516, 'recall': 0.21212808932664595, 'f1-score': 0.32284470848300634, 'support': 88126}, '2': {'precision': 0.3421099477287071, 'recall': 0.6431787757088961, 'f1-score': 0.44664645418915916, 'support': 32868}, 'accuracy': 0.3957510589768654, 'macro avg': {'precision': 0.44800625061365734, 'recall': 0.49969024332012113, 'f1-score': 0.40094576193561404, 'support': 153450}, 'weighted avg': {'precision': 0.5301861683043727, 'recall': 0.3957510589768654, 'f1-score': 0.37273424704152336, 'support': 153450}}
[[20894  4210  7352]
 [36131 18694 33301]
 [ 6950  4778 21140]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0694933
{'0': {'precision': 0.4412923592878483, 'recall': 0.5104215989801494, 'f1-score': 0.47334632362720536, 'support': 219640}, '1': {'precision': 0.36372265949452204, 'recall': 0.13960902590469057, 'f1-score': 0.20177138719657134, 'support': 197609}, '2': {'precision': 0.407677488981008, 'recall': 0.5771867027150528, 'f1-score': 0.47784461577565024, 'support': 210088}, 'accuracy': 0.41597578335089436, 'macro avg': {'precision': 0.40423083592112613, 'recall': 0.4090724425332976, 'f1-score': 0.3843207755331423, 'support': 627337}, 'weighted avg': {'precision': 0.4056009339781936, 'recall': 0.41597578335089436, 'f1-score': 0.3893075782443591, 'support': 627337}}
[[112109  24084  83447]
 [ 77287  27588  92734]
 [ 64651  24177 121260]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0622914
{'0': {'precision': 0.4265079312732909, 'recall': 0.5040827860386257, 'f1-score': 0.4620620048410579, 'support': 102626}, '1': {'precision': 0.4034140435835351, 'recall': 0.16227877937839075, 'f1-score': 0.23145260438010962, 'support': 102669}, '2': {'precision': 0.413935333850072, 'recall': 0.5875846079789376, 'f1-score': 0.48570581714977124, 'support': 101793}, 'accuracy': 0.41748619288282185, 'macro avg': {'precision': 0.41461910290229936, 'recall': 0.41798205779865133, 'f1-score': 0.39307347545697957, 'support': 307088}, 'weighted avg': {'precision': 0.41461938869031384, 'recall': 0.41748619288282185, 'f1-score': 0.3927995720869801, 'support': 307088}}
[[51732 12623 38271]
 [39595 16661 46413]
 [29965 12016 59812]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0614818
{'0': {'precision': 0.42230592717668963, 'recall': 0.5161939034716342, 'f1-score': 0.46455361607887025, 'support': 37792}, '1': {'precision': 0.4302341048151104, 'recall': 0.16623837179421289, 'f1-score': 0.2398146431881372, 'support': 38914}, '2': {'precision': 0.4091332712022367, 'recall': 0.5848784278894194, 'f1-score': 0.4814696339624366, 'support': 36028}, 'accuracy': 0.4173452552025121, 'macro avg': {'precision': 0.4205577677313455, 'recall': 0.42243690105175546, 'f1-score': 0.395279297743148, 'support': 112734}, 'weighted avg': {'precision': 0.4208328370279671, 'recall': 0.4173452552025121, 'f1-score': 0.39238335600860874, 'support': 112734}}
[[19508  4504 13780]
 [15793  6469 16652]
 [10893  4063 21072]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
3337/3337 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0473968
{'0': {'precision': 0.4193955820571893, 'recall': 0.5674616126536136, 'f1-score': 0.4823208354957912, 'support': 272681}, '1': {'precision': 0.4498337585445133, 'recall': 0.19056577019426194, 'f1-score': 0.26771698856568643, 'support': 317355}, '2': {'precision': 0.4198400565848316, 'recall': 0.5576386179308359, 'f1-score': 0.47902636652809527, 'support': 263981}, 'accuracy': 0.4243697724986739, 'macro avg': {'precision': 0.42968979906217813, 'recall': 0.43855533359290383, 'f1-score': 0.4096880635298576, 'support': 854017}, 'weighted avg': {'precision': 0.43084387913958494, 'recall': 0.4243697724986739, 'f1-score': 0.40155513521691527, 'support': 854017}}
[[154736  37474  80471]
 [133931  60477 122947]
 [ 80283  36492 147206]]
Evaluating performance on  train set...
1431/1431 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0536577
{'0': {'precision': 0.41650040299671, 'recall': 0.5255462282946674, 'f1-score': 0.46471206118124025, 'support': 119959}, '1': {'precision': 0.4213389488461876, 'recall': 0.19923823116945621, 'f1-score': 0.2705443564289497, 'support': 120509}, '2': {'precision': 0.44011917213400525, 'recall': 0.5526273898024483, 'f1-score': 0.4899979886588589, 'support': 125638}, 'accuracy': 0.42743085335940956, 'macro avg': {'precision': 0.42598617465896765, 'recall': 0.42580394975552394, 'f1-score': 0.40841813542301625, 'support': 366106}, 'weighted avg': {'precision': 0.4261984228014829, 'recall': 0.42743085335940956, 'f1-score': 0.40947646663878334, 'support': 366106}}
[[63044 16045 40870]
 [49045 24010 47454]
 [39277 16930 69431]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.059668
{'0': {'precision': 0.4348697394789579, 'recall': 0.4968376669009136, 'f1-score': 0.4637929575080413, 'support': 44113}, '1': {'precision': 0.3692597239648683, 'recall': 0.15752709755118427, 'f1-score': 0.22084232248381958, 'support': 37365}, '2': {'precision': 0.436747190633201, 'recall': 0.5859835233043674, 'f1-score': 0.5004771130324148, 'support': 44305}, 'accuracy': 0.4274425001788795, 'macro avg': {'precision': 0.4136255513590091, 'recall': 0.4134494292521551, 'f1-score': 0.3950374643414252, 'support': 125783}, 'weighted avg': {'precision': 0.41604098077312945, 'recall': 0.4274425001788795, 'f1-score': 0.4045436235982707, 'support': 125783}}
[[21917  5155 17041]
 [15038  5886 16441]
 [13444  4899 25962]]
testing model on single stock: results/universal/W9/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
10303/10303 - 81s - 81s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1156547
{'0': {'precision': 0.3436420149847946, 'recall': 0.44533251778115107, 'f1-score': 0.38793384930199115, 'support': 804363}, '1': {'precision': 0.41357196891548037, 'recall': 0.04732366990092621, 'f1-score': 0.08492917566975948, 'support': 1016616}, '2': {'precision': 0.34315356513435613, 'recall': 0.6215114505873808, 'f1-score': 0.4421718763820186, 'support': 816421}, 'accuracy': 0.34645256692196863, 'macro avg': {'precision': 0.3667891830115437, 'recall': 0.371389212756486, 'f1-score': 0.3050116337845898, 'support': 2637400}, 'weighted avg': {'precision': 0.3704461134643021, 'recall': 0.34645256692196863, 'f1-score': 0.2879268973862401, 'support': 2637400}}
[[358209  37020 409134]
 [406373  48110 562133]
 [277808  31198 507415]]
Evaluating performance on  train set...
3419/3419 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100891
{'0': {'precision': 0.3666055781270706, 'recall': 0.39606183457470395, 'f1-score': 0.38076486662503944, 'support': 286377}, '1': {'precision': 0.3676904821039269, 'recall': 0.045961151719403785, 'f1-score': 0.08170874548498469, 'support': 289897}, '2': {'precision': 0.3733487684338346, 'recall': 0.6614683534139234, 'f1-score': 0.477298625797916, 'support': 298879}, 'accuracy': 0.3707306036772999, 'macro avg': {'precision': 0.3692149428882774, 'recall': 0.36783044656934366, 'f1-score': 0.31325741263598, 'support': 875153}, 'weighted avg': {'precision': 0.3692678650458997, 'recall': 0.3707306036772999, 'f1-score': 0.31466949936661914, 'support': 875153}}
[[113423  12258 160696]
 [105439  13324 171134]
 [ 90525  10655 197699]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998865
{'0': {'precision': 0.3788846411655949, 'recall': 0.43233452405967643, 'f1-score': 0.4038487206262218, 'support': 118975}, '1': {'precision': 0.3702225326813691, 'recall': 0.06167298357603564, 'f1-score': 0.10573264744859427, 'support': 120312}, '2': {'precision': 0.36799444072171344, 'recall': 0.628399969486095, 'f1-score': 0.46416899362642594, 'support': 117979}, 'accuracy': 0.3722576455638096, 'macro avg': {'precision': 0.3723672048562258, 'recall': 0.37413582570726905, 'f1-score': 0.324583453900414, 'support': 357266}, 'weighted avg': {'precision': 0.3723713693901591, 'recall': 0.3722576455638096, 'f1-score': 0.3233753044381277, 'support': 357266}}
[[51437  7009 60529]
 [46094  7420 66798]
 [38228  5613 74138]]
training model: results/universal/W9/deepOF_L2/h200
Epoch 1/50
6697/6697 - 159s - loss: 3.2354 - accuracy200: 0.3992 - val_loss: 3.2660 - val_accuracy200: 0.3643 - 159s/epoch - 24ms/step
Epoch 2/50
6697/6697 - 156s - loss: 3.2087 - accuracy200: 0.4082 - val_loss: 3.2692 - val_accuracy200: 0.3687 - 156s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 155s - loss: 3.1918 - accuracy200: 0.4162 - val_loss: 3.2713 - val_accuracy200: 0.3658 - 155s/epoch - 23ms/step
Epoch 4/50
6697/6697 - 155s - loss: 3.1747 - accuracy200: 0.4229 - val_loss: 3.2741 - val_accuracy200: 0.3674 - 155s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 154s - loss: 3.1656 - accuracy200: 0.4263 - val_loss: 3.2726 - val_accuracy200: 0.3699 - 154s/epoch - 23ms/step
Epoch 6/50
6697/6697 - 154s - loss: 3.1597 - accuracy200: 0.4287 - val_loss: 3.2748 - val_accuracy200: 0.3718 - 154s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 155s - loss: 3.1552 - accuracy200: 0.4311 - val_loss: 3.2732 - val_accuracy200: 0.3719 - 155s/epoch - 23ms/step
Epoch 8/50
6697/6697 - 154s - loss: 3.1516 - accuracy200: 0.4324 - val_loss: 3.2812 - val_accuracy200: 0.3694 - 154s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 154s - loss: 3.1479 - accuracy200: 0.4337 - val_loss: 3.2889 - val_accuracy200: 0.3668 - 154s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 154s - loss: 3.1450 - accuracy200: 0.4353 - val_loss: 3.2832 - val_accuracy200: 0.3686 - 154s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 154s - loss: 3.1425 - accuracy200: 0.4362 - val_loss: 3.2824 - val_accuracy200: 0.3705 - 154s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 130s - 130s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926033
{'0': {'precision': 0.3544237582958504, 'recall': 0.40090597172882864, 'f1-score': 0.3762346312483657, 'support': 1335141}, '1': {'precision': 0.36204381341709707, 'recall': 0.21846915880975443, 'f1-score': 0.2725017739607037, 'support': 1631260}, '2': {'precision': 0.35037563214358797, 'recall': 0.4736224860673613, 'f1-score': 0.40278193429268516, 'support': 1341275}, 'accuracy': 0.35446119903168205, 'macro avg': {'precision': 0.3556144012855118, 'recall': 0.3643325388686481, 'f1-score': 0.3505061131672515, 'support': 4307676}, 'weighted avg': {'precision': 0.35604891318498527, 'recall': 0.35446119903168205, 'f1-score': 0.3452183647305724, 'support': 4307676}}
[[535266 310658 489217]
 [586278 356380 688602]
 [388699 317318 635258]]
Evaluating performance on  train set...
6697/6697 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891362
{'0': {'precision': 0.3831374598722467, 'recall': 0.3955981911155203, 'f1-score': 0.3892681319567248, 'support': 561451}, '1': {'precision': 0.3227929972402301, 'recall': 0.22055009735858216, 'f1-score': 0.26205183308924646, 'support': 584951}, '2': {'precision': 0.37544870320180446, 'recall': 0.4859275154731262, 'f1-score': 0.423603186573021, 'support': 567597}, 'accuracy': 0.3657709251872376, 'macro avg': {'precision': 0.36045972010476035, 'recall': 0.3673586013157429, 'f1-score': 0.35830771720633076, 'support': 1713999}, 'weighted avg': {'precision': 0.3599970327302625, 'recall': 0.3657709251872376, 'f1-score': 0.3572221230361919, 'support': 1713999}}
[[222109 133704 205638]
 [202772 129011 253168]
 [154830 136956 275811]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891844
{'0': {'precision': 0.3803596641153303, 'recall': 0.4154401818083437, 'f1-score': 0.3971267117530679, 'support': 221772}, '1': {'precision': 0.32847070905224907, 'recall': 0.21286752785788637, 'f1-score': 0.25832554599791363, 'support': 234404}, '2': {'precision': 0.36869466010361207, 'recall': 0.4742603454720821, 'f1-score': 0.4148673552392813, 'support': 216689}, 'accuracy': 0.36381294910568984, 'macro avg': {'precision': 0.3591750110903971, 'recall': 0.367522685046104, 'f1-score': 0.3567732043300877, 'support': 672865}, 'weighted avg': {'precision': 0.35852667135021143, 'recall': 0.36381294910568984, 'f1-score': 0.35448614319728466, 'support': 672865}}
[[ 92133  51269  78370]
 [ 86912  49897  97595]
 [ 63181  50741 102767]]
testing model out of sample: results/universal/W9/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0859667
{'0': {'precision': 0.38613852922751535, 'recall': 0.44578938316091615, 'f1-score': 0.4138254149083678, 'support': 709326}, '1': {'precision': 0.34463979236269165, 'recall': 0.166501352623827, 'f1-score': 0.22452894727500963, 'support': 835783}, '2': {'precision': 0.3526709665410963, 'recall': 0.5233730302297896, 'f1-score': 0.4213908733192441, 'support': 666131}, 'accuracy': 0.3635987047991172, 'macro avg': {'precision': 0.3611497627104345, 'recall': 0.3785545886715109, 'f1-score': 0.35324841183420713, 'support': 2211240}, 'weighted avg': {'precision': 0.3603712132450983, 'recall': 0.3635987047991172, 'f1-score': 0.34455605326905425, 'support': 2211240}}
[[316210 136998 256118]
 [312821 139159 383803]
 [189872 127624 348635]]
Evaluating performance on  train set...
3947/3947 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0885503
{'0': {'precision': 0.36290143604899777, 'recall': 0.4287326699749322, 'f1-score': 0.39307983431002075, 'support': 312752}, '1': {'precision': 0.3386757094413707, 'recall': 0.1761221101983018, 'f1-score': 0.23173478342030018, 'support': 377102}, '2': {'precision': 0.3656896773074645, 'recall': 0.5078193419241837, 'f1-score': 0.42519146841114935, 'support': 319720}, 'accuracy': 0.3594218947793822, 'macro avg': {'precision': 0.35575560759927766, 'recall': 0.3708913740324726, 'f1-score': 0.3500020287138234, 'support': 1009574}, 'weighted avg': {'precision': 0.35473550322977665, 'recall': 0.3594218947793822, 'f1-score': 0.3429826549791321, 'support': 1009574}}
[[134087  64818 113847]
 [142910  66416 167776]
 [ 92489  64871 162360]]
Evaluating performance on  val set...
1402/1402 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0873641
{'0': {'precision': 0.3655250758603864, 'recall': 0.42950055991041436, 'f1-score': 0.3949387734928147, 'support': 111625}, '1': {'precision': 0.34099525714030837, 'recall': 0.16951344799296372, 'f1-score': 0.22645365771778947, 'support': 135299}, '2': {'precision': 0.36238268051558004, 'recall': 0.5202799213058203, 'f1-score': 0.42720838542876854, 'support': 111317}, 'accuracy': 0.35951775480751785, 'macro avg': {'precision': 0.35630100450542496, 'recall': 0.37309797640306613, 'f1-score': 0.34953360554645757, 'support': 358241}, 'weighted avg': {'precision': 0.35528431066152405, 'recall': 0.35951775480751785, 'f1-score': 0.34133320828009317, 'support': 358241}}
[[47943 22596 41086]
 [51546 22935 60818]
 [31673 21728 57916]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954076
{'0': {'precision': 0.4040339508989687, 'recall': 0.31682530594718383, 'f1-score': 0.3551544324107501, 'support': 27946}, '1': {'precision': 0.28533948523092234, 'recall': 0.2912011817930016, 'f1-score': 0.2882405355388517, 'support': 21662}, '2': {'precision': 0.37104851829404445, 'recall': 0.4515177393059545, 'f1-score': 0.40734709600602337, 'support': 25762}, 'accuracy': 0.3554995356242537, 'macro avg': {'precision': 0.3534739848079785, 'recall': 0.35318140901538, 'f1-score': 0.3502473546518751, 'support': 75370}, 'weighted avg': {'precision': 0.35864546436494615, 'recall': 0.3554995356242537, 'f1-score': 0.35376261292690203, 'support': 75370}}
[[ 8854  8117 10975]
 [ 6612  6308  8742]
 [ 6448  7682 11632]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996692
{'0': {'precision': 0.3557002780623445, 'recall': 0.2844186999005324, 'f1-score': 0.31609064603179765, 'support': 17091}, '1': {'precision': 0.32378315735256247, 'recall': 0.29858101288369054, 'f1-score': 0.31067181467181465, 'support': 16843}, '2': {'precision': 0.36735531536461896, 'recall': 0.468559129777209, 'f1-score': 0.411830870698911, 'support': 17191}, 'accuracy': 0.35100244498777505, 'macro avg': {'precision': 0.34894625025984194, 'recall': 0.350519614187144, 'f1-score': 0.34619777713417443, 'support': 51125}, 'weighted avg': {'precision': 0.3491043207449565, 'recall': 0.35100244498777505, 'f1-score': 0.3464984861424315, 'support': 51125}}
[[4861 5226 7004]
 [4946 5029 6868]
 [3859 5277 8055]]
Evaluating performance on  val set...
53/53 - 1s - 620ms/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948902
{'0': {'precision': 0.34342291371994343, 'recall': 0.27547084184252324, 'f1-score': 0.3057164442205993, 'support': 4407}, '1': {'precision': 0.37086776859504134, 'recall': 0.29133698518969364, 'f1-score': 0.32632655380070447, 'support': 4929}, '2': {'precision': 0.3424995883418409, 'recall': 0.5019305019305019, 'f1-score': 0.40716452970539296, 'support': 4144}, 'accuracy': 0.3508902077151335, 'macro avg': {'precision': 0.35226342355227525, 'recall': 0.3562461096542396, 'f1-score': 0.34640250924223226, 'support': 13480}, 'weighted avg': {'precision': 0.3531743550636008, 'recall': 0.3508902077151335, 'f1-score': 0.3444395967702523, 'support': 13480}}
[[1214 1288 1905]
 [1405 1436 2088]
 [ 916 1148 2080]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850843
{'0': {'precision': 0.33690495107943064, 'recall': 0.5664720027481965, 'f1-score': 0.4225195729537366, 'support': 78597}, '1': {'precision': 0.3440737857100078, 'recall': 0.09071601702208291, 'f1-score': 0.14357743997300892, 'support': 126659}, '2': {'precision': 0.3631328457953999, 'recall': 0.5413797792254348, 'f1-score': 0.43469328000079405, 'support': 80897}, 'accuracy': 0.3487959238589146, 'macro avg': {'precision': 0.3480371941949461, 'recall': 0.39952259966523807, 'f1-score': 0.3335967643091799, 'support': 286153}, 'weighted avg': {'precision': 0.3474928373651311, 'recall': 0.3487959238589146, 'f1-score': 0.30249386907427284, 'support': 286153}}
[[44523 10524 23550]
 [61909 11490 53260]
 [25721 11380 43796]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0789237
{'0': {'precision': 0.3927856555909062, 'recall': 0.48082329576229654, 'f1-score': 0.43236849429446145, 'support': 38771}, '1': {'precision': 0.37873669123669124, 'recall': 0.13614366938377465, 'f1-score': 0.20028964714481, 'support': 54347}, '2': {'precision': 0.34144969463195113, 'recall': 0.5885204576304053, 'f1-score': 0.4321646884122092, 'support': 36099}, 'accuracy': 0.3659425617372327, 'macro avg': {'precision': 0.3709906804865162, 'recall': 0.40182914092549216, 'f1-score': 0.35494094328382686, 'support': 129217}, 'weighted avg': {'precision': 0.37253525571770185, 'recall': 0.3659425617372327, 'f1-score': 0.3347021942365316, 'support': 129217}}
[[18642  6156 13973]
 [19946  7399 27002]
 [ 8873  5981 21245]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0780737
{'0': {'precision': 0.37545205479452054, 'recall': 0.48533786655333616, 'f1-score': 0.42338111715274346, 'support': 14118}, '1': {'precision': 0.3745664739884393, 'recall': 0.12861608693494764, 'f1-score': 0.1914822886270454, 'support': 20153}, '2': {'precision': 0.3524579303034318, 'recall': 0.5893648449039882, 'f1-score': 0.44111550261186816, 'support': 13540}, 'accuracy': 0.3644349626654954, 'macro avg': {'precision': 0.3674921530287972, 'recall': 0.4011062661307574, 'f1-score': 0.3519929694638857, 'support': 47811}, 'weighted avg': {'precision': 0.3685668703057147, 'recall': 0.3644349626654954, 'f1-score': 0.3306548928076797, 'support': 47811}}
[[6852 2139 5127]
 [8027 2592 9534]
 [3371 2189 7980]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003468
{'0': {'precision': 0.37519735009132277, 'recall': 0.2808936683044405, 'f1-score': 0.32126810777855824, 'support': 43148}, '1': {'precision': 0.2735926473001805, 'recall': 0.23161356057799184, 'f1-score': 0.2508590203405984, 'support': 43184}, '2': {'precision': 0.3336885595304456, 'recall': 0.46763780070307653, 'f1-score': 0.3894677420898036, 'support': 43523}, 'accuracy': 0.32709560663817333, 'macro avg': {'precision': 0.3274928523073163, 'recall': 0.3267150098618363, 'f1-score': 0.32053162340298674, 'support': 129855}, 'weighted avg': {'precision': 0.32749580161868985, 'recall': 0.32709560663817333, 'f1-score': 0.32071138414225214, 'support': 129855}}
[[12120 13329 17699]
 [10240 10002 22942]
 [ 9943 13227 20353]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977299
{'0': {'precision': 0.35319819133262204, 'recall': 0.30937652974945484, 'f1-score': 0.3298382122692982, 'support': 22471}, '1': {'precision': 0.3089898691846169, 'recall': 0.28555197018588374, 'f1-score': 0.29680893780853623, 'support': 22003}, '2': {'precision': 0.3633252743165334, 'recall': 0.43552701979668274, 'f1-score': 0.39616328351550306, 'support': 22428}, 'accuracy': 0.3438312755971421, 'macro avg': {'precision': 0.3418377782779241, 'recall': 0.3434851732440071, 'f1-score': 0.34093681119777913, 'support': 66902}, 'weighted avg': {'precision': 0.34205374878891043, 'recall': 0.3438312755971421, 'f1-score': 0.34121000342576197, 'support': 66902}}
[[6952 7061 8458]
 [7061 6283 8659]
 [5670 6990 9768]]
Evaluating performance on  val set...
73/73 - 1s - 805ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996635
{'0': {'precision': 0.3647151898734177, 'recall': 0.2799878530215609, 'f1-score': 0.3167840577220409, 'support': 6586}, '1': {'precision': 0.30264672036823936, 'recall': 0.3071917236776239, 'f1-score': 0.30490228552500825, 'support': 5993}, '2': {'precision': 0.34535533670481766, 'recall': 0.4272308198880474, 'f1-score': 0.38195466588166027, 'support': 6074}, 'accuracy': 0.3366750656730821, 'macro avg': {'precision': 0.3375724156488249, 'recall': 0.3381367988624107, 'f1-score': 0.33454700304290313, 'support': 18653}, 'weighted avg': {'precision': 0.33846911225101867, 'recall': 0.3366750656730821, 'f1-score': 0.3341881650069126, 'support': 18653}}
[[1844 2237 2505]
 [1738 1841 2414]
 [1474 2005 2595]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994804
{'0': {'precision': 0.33436099659437174, 'recall': 0.19754733765408566, 'f1-score': 0.24835905151180285, 'support': 47214}, '1': {'precision': 0.38135703165542295, 'recall': 0.38935708727254664, 'f1-score': 0.38531553895183557, 'support': 60397}, '2': {'precision': 0.30298077071350366, 'recall': 0.41985597367352606, 'f1-score': 0.35196961825770734, 'support': 46797}, 'accuracy': 0.33995000259053937, 'macro avg': {'precision': 0.33956626632109943, 'recall': 0.3355867995333861, 'f1-score': 0.3285480695737819, 'support': 154408}, 'weighted avg': {'precision': 0.3432330699262932, 'recall': 0.33995000259053937, 'f1-score': 0.33333149247291727, 'support': 154408}}
[[ 9327 18778 19109]
 [10789 23516 26092]
 [ 7779 19370 19648]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023862
{'0': {'precision': 0.3535326451266926, 'recall': 0.18110641804883074, 'f1-score': 0.23951497536274663, 'support': 29121}, '1': {'precision': 0.3250126748382094, 'recall': 0.40303254437869823, 'f1-score': 0.35984216869458985, 'support': 27040}, '2': {'precision': 0.3222079213713216, 'recall': 0.41606859560323334, 'f1-score': 0.3631717771183646, 'support': 26474}, 'accuracy': 0.3290010286198342, 'macro avg': {'precision': 0.33358441377874115, 'recall': 0.33340251934358744, 'f1-score': 0.3208429737252337, 'support': 82635}, 'weighted avg': {'precision': 0.3341646928873233, 'recall': 0.3290010286198342, 'f1-score': 0.3185049611722858, 'support': 82635}}
[[ 5274 11862 11985]
 [ 4956 10898 11186]
 [ 4688 10771 11015]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038661
{'0': {'precision': 0.3558271647443622, 'recall': 0.20507986903462644, 'f1-score': 0.26019637462235645, 'support': 10079}, '1': {'precision': 0.29652996845425866, 'recall': 0.4109653787073142, 'f1-score': 0.34449286846275756, 'support': 8463}, '2': {'precision': 0.34890336789942183, 'recall': 0.3843121398968968, 'f1-score': 0.3657527657527657, 'support': 9893}, 'accuracy': 0.3287146122736065, 'macro avg': {'precision': 0.3337535003660142, 'recall': 0.33345246254627914, 'f1-score': 0.3234806696126266, 'support': 28435}, 'weighted avg': {'precision': 0.3357698658384315, 'recall': 0.3287146122736065, 'f1-score': 0.3220100058804698, 'support': 28435}}
[[2067 4157 3855]
 [1745 3478 3240]
 [1997 4094 3802]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033078
{'0': {'precision': 0.4078593588417787, 'recall': 0.18370959227401173, 'f1-score': 0.2533184893380149, 'support': 64406}, '1': {'precision': 0.2352069731787566, 'recall': 0.352097784883571, 'f1-score': 0.28202003511308477, 'support': 38779}, '2': {'precision': 0.3709979391996552, 'recall': 0.47392419002391645, 'f1-score': 0.4161919584170684, 'support': 58119}, 'accuracy': 0.3287581213113128, 'macro avg': {'precision': 0.33802142374006355, 'recall': 0.33657718906049977, 'f1-score': 0.3171768276227227, 'support': 161304}, 'weighted avg': {'precision': 0.35307066350994, 'recall': 0.3287581213113128, 'f1-score': 0.3189031021995493, 'support': 161304}}
[[11832 23704 28870]
 [ 7296 13654 17829]
 [ 9882 20693 27544]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994949
{'0': {'precision': 0.3434249133102161, 'recall': 0.256525204223949, 'f1-score': 0.29368156934306566, 'support': 40152}, '1': {'precision': 0.3099027727763774, 'recall': 0.32071252888127005, 'f1-score': 0.3152150025639147, 'support': 40251}, '2': {'precision': 0.3586826823641715, 'recall': 0.43430938162203814, 'f1-score': 0.39288981832440206, 'support': 41528}, 'accuracy': 0.3382650843509854, 'macro avg': {'precision': 0.33733678948358836, 'recall': 0.3371823715757524, 'f1-score': 0.3339287967437941, 'support': 121931}, 'weighted avg': {'precision': 0.33755540477379076, 'recall': 0.3382650843509854, 'f1-score': 0.33457898168504047, 'support': 121931}}
[[10300 14185 15667]
 [10761 12909 16581]
 [ 8931 14561 18036]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991145
{'0': {'precision': 0.33278795811518325, 'recall': 0.26201210872085534, 'f1-score': 0.2931891891891892, 'support': 15526}, '1': {'precision': 0.3268558103381267, 'recall': 0.3075704010727783, 'f1-score': 0.3169199849265168, 'support': 16406}, '2': {'precision': 0.34278873679279653, 'recall': 0.4407414843070334, 'f1-score': 0.38564234687902565, 'support': 14943}, 'accuracy': 0.33493333333333336, 'macro avg': {'precision': 0.3341441684153688, 'recall': 0.3367746647002223, 'f1-score': 0.3319171736649105, 'support': 46875}, 'weighted avg': {'precision': 0.3338998262612992, 'recall': 0.33493333333333336, 'f1-score': 0.3309674285540068, 'support': 46875}}
[[4068 5362 6096]
 [4829 5046 6531]
 [3327 5030 6586]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0804183
{'0': {'precision': 0.3927526606258994, 'recall': 0.5237419933046894, 'f1-score': 0.4488865493535277, 'support': 189685}, '1': {'precision': 0.3066270768841999, 'recall': 0.10800850965347196, 'f1-score': 0.15974670129117832, 'support': 224686}, '2': {'precision': 0.3896627633793958, 'recall': 0.5601919077481158, 'f1-score': 0.4596196311521912, 'support': 188007}, 'accuracy': 0.38005040024702097, 'macro avg': {'precision': 0.363014166963165, 'recall': 0.39731413690209233, 'f1-score': 0.356084293932299, 'support': 602378}, 'weighted avg': {'precision': 0.3596635783217467, 'recall': 0.38005040024702097, 'f1-score': 0.34438774396552263, 'support': 602378}}
[[ 99346  27445  62894]
 [ 98347  24268 102071]
 [ 55255  27432 105320]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0706409
{'0': {'precision': 0.41567628959343195, 'recall': 0.5499553137368519, 'f1-score': 0.4734794997759307, 'support': 101821}, '1': {'precision': 0.31442729926649166, 'recall': 0.11210530919268784, 'f1-score': 0.165281476275525, 'support': 114330}, '2': {'precision': 0.4175032887904175, 'recall': 0.5811768107561082, 'f1-score': 0.48592783609001344, 'support': 103755}, 'accuracy': 0.4035998074434365, 'macro avg': {'precision': 0.3825356258834471, 'recall': 0.414412477895216, 'f1-score': 0.37489627071382303, 'support': 319906}, 'weighted avg': {'precision': 0.38008384443017823, 'recall': 0.4035998074434365, 'f1-score': 0.367371133904288, 'support': 319906}}
[[55997 13723 32101]
 [49484 12817 52029]
 [29232 14223 60300]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0704195
{'0': {'precision': 0.40539268658277267, 'recall': 0.579779145997956, 'f1-score': 0.4771517370834231, 'support': 40117}, '1': {'precision': 0.3106481481481482, 'recall': 0.09991278636914765, 'f1-score': 0.15119666511081425, 'support': 47011}, '2': {'precision': 0.41393071593533487, 'recall': 0.5673191360056722, 'f1-score': 0.4786361305759699, 'support': 39491}, 'accuracy': 0.3977286189276491, 'macro avg': {'precision': 0.3766571835554186, 'recall': 0.4156703561242587, 'f1-score': 0.36899484425673573, 'support': 126619}, 'weighted avg': {'precision': 0.3728789234098831, 'recall': 0.3977286189276491, 'f1-score': 0.3565943665064153, 'support': 126619}}
[[23259  5078 11780]
 [22373  4697 19941]
 [11742  5345 22404]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0817116
{'0': {'precision': 0.3995120075251662, 'recall': 0.4972879437211935, 'f1-score': 0.4430698383468993, 'support': 309175}, '1': {'precision': 0.33276588314891203, 'recall': 0.11696042507818073, 'f1-score': 0.1730850005108431, 'support': 391081}, '2': {'precision': 0.3525528667043841, 'recall': 0.5685688511833851, 'f1-score': 0.4352314672661837, 'support': 290438}, 'accuracy': 0.3680490645951222, 'macro avg': {'precision': 0.36161025245948747, 'recall': 0.3942724066609198, 'f1-score': 0.35046210204130873, 'support': 990694}, 'weighted avg': {'precision': 0.3593968357275211, 'recall': 0.3680490645951222, 'f1-score': 0.33419413991155644, 'support': 990694}}
[[153749  47768 107658]
 [149737  45741 195603]
 [ 81356  43948 165134]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0840983
{'0': {'precision': 0.35526471914378605, 'recall': 0.5234257543442536, 'f1-score': 0.4232541702007351, 'support': 114404}, '1': {'precision': 0.35923769190047644, 'recall': 0.09638766419708195, 'f1-score': 0.15199365685180952, 'support': 176008}, '2': {'precision': 0.3403363358884349, 'recall': 0.5649171514969319, 'f1-score': 0.4247690533097096, 'support': 113098}, 'accuracy': 0.3487844167430795, 'macro avg': {'precision': 0.35161291564423247, 'recall': 0.3949101900127558, 'f1-score': 0.3333389601207514, 'support': 403510}, 'weighted avg': {'precision': 0.35281349042466104, 'recall': 0.3487844167430795, 'f1-score': 0.30535699247612136, 'support': 403510}}
[[59882 15349 39173]
 [74378 16965 84665]
 [34296 14911 63891]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0804752
{'0': {'precision': 0.3538981883093497, 'recall': 0.5357083599990519, 'f1-score': 0.42622487081808924, 'support': 42189}, '1': {'precision': 0.3694349315068493, 'recall': 0.0889481123741092, 'f1-score': 0.14337589595101344, 'support': 67916}, '2': {'precision': 0.3494230900525705, 'recall': 0.5903795132079824, 'f1-score': 0.4390118373648997, 'support': 43345}, 'accuracy': 0.3534180514825676, 'macro avg': {'precision': 0.3575854032895898, 'recall': 0.4050119951937145, 'f1-score': 0.3362042013780007, 'support': 153450}, 'weighted avg': {'precision': 0.35951057225891825, 'recall': 0.3534180514825676, 'f1-score': 0.3046496351576082, 'support': 153450}}
[[22601  5115 14473]
 [28703  6041 33172]
 [12559  5196 25590]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910724
{'0': {'precision': 0.3747818215679396, 'recall': 0.41643647073543993, 'f1-score': 0.39451266632169474, 'support': 207794}, '1': {'precision': 0.3664466483133769, 'recall': 0.20304904384264066, 'f1-score': 0.26130712693428887, 'support': 217642}, '2': {'precision': 0.37027101489204356, 'recall': 0.5058915012803304, 'f1-score': 0.4275849654528595, 'support': 201901}, 'accuracy': 0.37119602382770345, 'macro avg': {'precision': 0.3704998282577867, 'recall': 0.3751256719528037, 'f1-score': 0.36113491956961435, 'support': 627337}, 'weighted avg': {'precision': 0.37043835042541234, 'recall': 0.37119602382770345, 'f1-score': 0.3589436025864575, 'support': 627337}}
[[ 86533  40025  81236]
 [ 80974  44192  92476]
 [ 63382  36379 102140]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0868726
{'0': {'precision': 0.39639794824682284, 'recall': 0.3984340432080953, 'f1-score': 0.39741338782872326, 'support': 103962}, '1': {'precision': 0.3447976963535392, 'recall': 0.23305627550868413, 'f1-score': 0.27812309278472686, 'support': 100701}, '2': {'precision': 0.38548682039159715, 'recall': 0.5063021723212107, 'f1-score': 0.43771075032390666, 'support': 102425}, 'accuracy': 0.3801809253373626, 'macro avg': {'precision': 0.37556082166398636, 'recall': 0.37926416367932997, 'f1-score': 0.3710824103124522, 'support': 307088}, 'weighted avg': {'precision': 0.37583781813272843, 'recall': 0.3801809253373626, 'f1-score': 0.3717360749814081, 'support': 307088}}
[[41422 22662 39878]
 [34442 23469 42790]
 [28632 21935 51858]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0870526
{'0': {'precision': 0.40036997885835096, 'recall': 0.433837502928696, 'f1-score': 0.41643240001499304, 'support': 38413}, '1': {'precision': 0.3478279296461115, 'recall': 0.21677231907025885, 'f1-score': 0.2670897404604995, 'support': 37860}, '2': {'precision': 0.3753551510049458, 'recall': 0.48915279339568307, 'f1-score': 0.42476421834809946, 'support': 36461}, 'accuracy': 0.37882981176929764, 'macro avg': {'precision': 0.3745176865031361, 'recall': 0.3799208717982127, 'f1-score': 0.3694287862745307, 'support': 112734}, 'weighted avg': {'precision': 0.3746341083885868, 'recall': 0.37882981176929764, 'f1-score': 0.3689726570582122, 'support': 112734}}
[[16665  7762 13986]
 [13959  8207 15694]
 [11000  7626 17835]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
3337/3337 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0846214
{'0': {'precision': 0.36975043998893253, 'recall': 0.4897997740420403, 'f1-score': 0.4213917441988987, 'support': 264651}, '1': {'precision': 0.42534656111166785, 'recall': 0.18666752668752218, 'f1-score': 0.2594658918172149, 'support': 341077}, '2': {'precision': 0.3500586564147503, 'recall': 0.49875346874005694, 'f1-score': 0.41138189235338274, 'support': 248289}, 'accuracy': 0.3713380412802087, 'macro avg': {'precision': 0.38171855250511694, 'recall': 0.39174025648987315, 'f1-score': 0.36407984278983213, 'support': 854017}, 'weighted avg': {'precision': 0.3862293917572569, 'recall': 0.3713380412802087, 'f1-score': 0.3538116842496718, 'support': 854017}}
[[129626  43939  91086]
 [138575  63668 138834]
 [ 82376  42078 123835]]
Evaluating performance on  train set...
1431/1431 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0864905
{'0': {'precision': 0.3798903001469454, 'recall': 0.440194210765885, 'f1-score': 0.40782506833268256, 'support': 118634}, '1': {'precision': 0.34938943568628555, 'recall': 0.2031033550005328, 'f1-score': 0.2568799730451235, 'support': 121997}, '2': {'precision': 0.39840986038726367, 'recall': 0.5008009563658099, 'f1-score': 0.4437758874564349, 'support': 125475}, 'accuracy': 0.38196041583585083, 'macro avg': {'precision': 0.3758965320734982, 'recall': 0.3813661740440759, 'f1-score': 0.369493642944747, 'support': 366106}, 'weighted avg': {'precision': 0.37607372205083883, 'recall': 0.38196041583585083, 'f1-score': 0.3698472155789896, 'support': 366106}}
[[52222 22796 43616]
 [45951 24778 51268]
 [39293 23344 62838]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0886067
{'0': {'precision': 0.3936177098841349, 'recall': 0.42507631008691193, 'f1-score': 0.4087426062018283, 'support': 42917}, '1': {'precision': 0.32901452689438554, 'recall': 0.20921233304206716, 'f1-score': 0.25578023655093474, 'support': 40055}, '2': {'precision': 0.3924693325427121, 'recall': 0.49473266216626566, 'f1-score': 0.43770730648811185, 'support': 42811}, 'accuracy': 0.3800434080917135, 'macro avg': {'precision': 0.3717005231070775, 'recall': 0.37634043509841497, 'f1-score': 0.3674100497469583, 'support': 125783}, 'weighted avg': {'precision': 0.37265427542146456, 'recall': 0.3800434080917135, 'f1-score': 0.36989077461560077, 'support': 125783}}
[[18243  8607 16067]
 [14956  8380 16719]
 [13148  8483 21180]]
testing model on single stock: results/universal/W9/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
10303/10303 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961392
{'0': {'precision': 0.3409312780840855, 'recall': 0.36392022674111385, 'f1-score': 0.35205085659643304, 'support': 811851}, '1': {'precision': 0.3666748789890148, 'recall': 0.2525392363925276, 'f1-score': 0.2990881236198915, 'support': 1001876}, '2': {'precision': 0.337153701102716, 'recall': 0.44239765052393365, 'f1-score': 0.38267140432007196, 'support': 823673}, 'accuracy': 0.3461185258208842, 'macro avg': {'precision': 0.3482532860586054, 'recall': 0.3529523712191917, 'f1-score': 0.3446034615121321, 'support': 2637400}, 'weighted avg': {'precision': 0.34953081085698734, 'recall': 0.3461185258208842, 'f1-score': 0.3414947131754758, 'support': 2637400}}
[[295449 214152 302250]
 [334718 253013 414145]
 [236427 222855 364391]]
Evaluating performance on  train set...
3419/3419 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968741
{'0': {'precision': 0.3618341714874025, 'recall': 0.34928208050706105, 'f1-score': 0.35544734594717886, 'support': 287776}, '1': {'precision': 0.31308621044194235, 'recall': 0.2585666110982106, 'f1-score': 0.28322659266317657, 'support': 288533}, '2': {'precision': 0.36569647785535453, 'recall': 0.43939647441474483, 'f1-score': 0.39917314546711957, 'support': 298844}, 'accuracy': 0.350145631678118, 'macro avg': {'precision': 0.3468722865948998, 'recall': 0.3490817220066722, 'f1-score': 0.345949028025825, 'support': 875153}, 'weighted avg': {'precision': 0.3470811301790764, 'recall': 0.350145631678118, 'f1-score': 0.34656789541046595, 'support': 875153}}
[[100515  79614 107647]
 [ 93815  74605 120113]
 [ 83463  84070 131311]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967369
{'0': {'precision': 0.36346353555994776, 'recall': 0.36455962031164685, 'f1-score': 0.3640107528234549, 'support': 119045}, '1': {'precision': 0.32706441393875396, 'recall': 0.2561509134364895, 'f1-score': 0.28729645621634664, 'support': 120917}, '2': {'precision': 0.35504533325882565, 'recall': 0.4333100320534679, 'f1-score': 0.3902927829352007, 'support': 117304}, 'accuracy': 0.3504419676095682, 'macro avg': {'precision': 0.3485244275858425, 'recall': 0.35134018860053473, 'f1-score': 0.3471999973250008, 'support': 357266}, 'weighted avg': {'precision': 0.3483802043954913, 'recall': 0.3504419676095682, 'f1-score': 0.3466761188459326, 'support': 357266}}
[[43399 32192 43454]
 [41065 30973 48879]
 [34940 31535 50829]]
training model: results/universal/W9/deepVOL_L2/h50
Epoch 1/50
6697/6697 - 228s - loss: 2.9504 - accuracy50: 0.4929 - val_loss: 3.2603 - val_accuracy50: 0.4183 - 228s/epoch - 34ms/step
Epoch 2/50
6697/6697 - 229s - loss: 2.8885 - accuracy50: 0.5097 - val_loss: 3.2441 - val_accuracy50: 0.4444 - 229s/epoch - 34ms/step
Epoch 3/50
6697/6697 - 228s - loss: 2.8672 - accuracy50: 0.5150 - val_loss: 3.2715 - val_accuracy50: 0.4599 - 228s/epoch - 34ms/step
Epoch 4/50
6697/6697 - 227s - loss: 2.8554 - accuracy50: 0.5181 - val_loss: 3.2742 - val_accuracy50: 0.4589 - 227s/epoch - 34ms/step
Epoch 5/50
6697/6697 - 230s - loss: 2.8483 - accuracy50: 0.5203 - val_loss: 3.2571 - val_accuracy50: 0.4587 - 230s/epoch - 34ms/step
Epoch 6/50
6697/6697 - 228s - loss: 2.8427 - accuracy50: 0.5216 - val_loss: 3.2381 - val_accuracy50: 0.4620 - 228s/epoch - 34ms/step
Epoch 7/50
6697/6697 - 225s - loss: 2.8367 - accuracy50: 0.5232 - val_loss: 3.2664 - val_accuracy50: 0.4611 - 225s/epoch - 34ms/step
Epoch 8/50
6697/6697 - 226s - loss: 2.8319 - accuracy50: 0.5241 - val_loss: 3.2459 - val_accuracy50: 0.4634 - 226s/epoch - 34ms/step
Epoch 9/50
6697/6697 - 231s - loss: 2.8263 - accuracy50: 0.5250 - val_loss: 3.2344 - val_accuracy50: 0.4660 - 231s/epoch - 35ms/step
Epoch 10/50
6697/6697 - 231s - loss: 2.8207 - accuracy50: 0.5261 - val_loss: 3.2189 - val_accuracy50: 0.4656 - 231s/epoch - 35ms/step
Epoch 11/50
6697/6697 - 227s - loss: 2.8192 - accuracy50: 0.5261 - val_loss: 3.2233 - val_accuracy50: 0.4620 - 227s/epoch - 34ms/step
Epoch 12/50
6697/6697 - 227s - loss: 2.8150 - accuracy50: 0.5270 - val_loss: 3.1976 - val_accuracy50: 0.4630 - 227s/epoch - 34ms/step
Epoch 13/50
6697/6697 - 227s - loss: 2.8096 - accuracy50: 0.5285 - val_loss: 3.2178 - val_accuracy50: 0.4629 - 227s/epoch - 34ms/step
Epoch 14/50
6697/6697 - 227s - loss: 2.8060 - accuracy50: 0.5290 - val_loss: 3.2176 - val_accuracy50: 0.4650 - 227s/epoch - 34ms/step
Epoch 15/50
6697/6697 - 224s - loss: 2.8024 - accuracy50: 0.5296 - val_loss: 3.2035 - val_accuracy50: 0.4644 - 224s/epoch - 33ms/step
Epoch 16/50
6697/6697 - 223s - loss: 2.7988 - accuracy50: 0.5308 - val_loss: 3.2120 - val_accuracy50: 0.4654 - 223s/epoch - 33ms/step
Epoch 17/50
6697/6697 - 223s - loss: 2.7963 - accuracy50: 0.5311 - val_loss: 3.2377 - val_accuracy50: 0.4637 - 223s/epoch - 33ms/step
Epoch 18/50
6697/6697 - 225s - loss: 2.7934 - accuracy50: 0.5319 - val_loss: 3.2164 - val_accuracy50: 0.4643 - 225s/epoch - 34ms/step
Epoch 19/50
6697/6697 - 223s - loss: 2.7911 - accuracy50: 0.5327 - val_loss: 3.2069 - val_accuracy50: 0.4652 - 223s/epoch - 33ms/step
Epoch 20/50
6697/6697 - 223s - loss: 2.7887 - accuracy50: 0.5333 - val_loss: 3.2233 - val_accuracy50: 0.4657 - 223s/epoch - 33ms/step
Epoch 21/50
6697/6697 - 225s - loss: 2.7858 - accuracy50: 0.5339 - val_loss: 3.2262 - val_accuracy50: 0.4645 - 225s/epoch - 34ms/step
Epoch 22/50
6697/6697 - 227s - loss: 2.7837 - accuracy50: 0.5342 - val_loss: 3.2387 - val_accuracy50: 0.4642 - 227s/epoch - 34ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 272s - 272s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1728747
{'0': {'precision': 0.38471854093680496, 'recall': 0.5024007512386789, 'f1-score': 0.4357539863846527, 'support': 1213995}, '1': {'precision': 0.6382329146859211, 'recall': 0.2916452483924975, 'f1-score': 0.4003483560031633, 'support': 1877291}, '2': {'precision': 0.3835194056555402, 'recall': 0.5878568903576918, 'f1-score': 0.46419606104414335, 'support': 1216410}, 'accuracy': 0.434684805984452, 'macro avg': {'precision': 0.46882362042608877, 'recall': 0.460634296662956, 'f1-score': 0.43343280114398647, 'support': 4307696}, 'weighted avg': {'precision': 0.49486132075747213, 'recall': 0.434684805984452, 'f1-score': 0.4283557281909581, 'support': 4307696}}
[[609912 148519 455564]
 [635919 547503 693869]
 [339515 161820 715075]]
Evaluating performance on  train set...
6697/6697 - 108s - 108s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0954143
{'0': {'precision': 0.41156723853693, 'recall': 0.46254817764801454, 'f1-score': 0.43557103018671495, 'support': 491151}, '1': {'precision': 0.6720786365748099, 'recall': 0.38104929268955423, 'f1-score': 0.4863513386782555, 'support': 721324}, '2': {'precision': 0.41361273230683426, 'recall': 0.6210376248679043, 'f1-score': 0.49653308889464565, 'support': 501530}, 'accuracy': 0.4746252198797553, 'macro avg': {'precision': 0.499086202472858, 'recall': 0.4882116984018244, 'f1-score': 0.4728184859198721, 'support': 1714005}, 'weighted avg': {'precision': 0.5217997058685281, 'recall': 0.4746252198797553, 'f1-score': 0.47477940854391953, 'support': 1714005}}
[[227181  63650 200320]
 [205208 274860 241256]
 [119601  70460 311469]]
Evaluating performance on  val set...
2631/2631 - 43s - 43s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1190546
{'0': {'precision': 0.3961860284101965, 'recall': 0.48532711491125796, 'f1-score': 0.4362494730639613, 'support': 192975}, '1': {'precision': 0.6758225133851639, 'recall': 0.3546691243730605, 'f1-score': 0.4652019876170102, 'support': 289701}, '2': {'precision': 0.40508367318239347, 'recall': 0.6058193825187179, 'f1-score': 0.48552141448532754, 'support': 190192}, 'accuracy': 0.46313095584869546, 'macro avg': {'precision': 0.4923640716592513, 'recall': 0.4819385406010121, 'f1-score': 0.4623242917220997, 'support': 672868}, 'weighted avg': {'precision': 0.519097550712114, 'recall': 0.46313095584869546, 'f1-score': 0.4626420218273819, 'support': 672868}}
[[ 93656  23448  75871]
 [ 93606 102748  93347]
 [ 49132  25838 115222]]
testing model out of sample: results/universal/W9/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 149s - 149s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9603801
{'0': {'precision': 0.43948095318710545, 'recall': 0.5372660424851458, 'f1-score': 0.4834787176466843, 'support': 565327}, '1': {'precision': 0.7018041882670836, 'recall': 0.5060652444797974, 'f1-score': 0.5880746684757836, 'support': 1096246}, '2': {'precision': 0.4360689259140989, 'recall': 0.5788366834216563, 'f1-score': 0.4974111651320212, 'support': 549687}, 'accuracy': 0.5321319066957301, 'macro avg': {'precision': 0.5257846891227627, 'recall': 0.5407226567955331, 'f1-score': 0.5229881837514964, 'support': 2211260}, 'weighted avg': {'precision': 0.5686811603666629, 'recall': 0.5321319066957301, 'f1-score': 0.5387962189687673, 'support': 2211260}}
[[303731 117956 143640]
 [273640 554772 267834]
 [113742 117766 318179]]
Evaluating performance on  train set...
3947/3947 - 66s - 66s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98939496
{'0': {'precision': 0.41171249462651577, 'recall': 0.5131856397762624, 'f1-score': 0.45688261679805336, 'support': 259411}, '1': {'precision': 0.6951900888386732, 'recall': 0.5043488570324749, 'f1-score': 0.5845884836552063, 'support': 489209}, '2': {'precision': 0.4438454898315214, 'recall': 0.5635159680868186, 'f1-score': 0.4965725438815687, 'support': 260958}, 'accuracy': 0.5219131161732922, 'macro avg': {'precision': 0.5169160244322367, 'recall': 0.5270168216318519, 'f1-score': 0.5126812147782761, 'support': 1009578}, 'weighted avg': {'precision': 0.557382420624946, 'recall': 0.5219131161732922, 'f1-score': 0.5290239108943796, 'support': 1009578}}
[[133126  51374  74911]
 [133124 246732 109353]
 [ 57097  56807 147054]]
Evaluating performance on  val set...
1402/1402 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9847671
{'0': {'precision': 0.4228949167996353, 'recall': 0.5001887260452726, 'f1-score': 0.4583057479669173, 'support': 92727}, '1': {'precision': 0.704361106132976, 'recall': 0.5232034541834514, 'f1-score': 0.6004151237899141, 'support': 172776}, '2': {'precision': 0.44987856406161625, 'recall': 0.5832281995708386, 'f1-score': 0.5079472406523076, 'support': 92739}, 'accuracy': 0.532785100574472, 'macro avg': {'precision': 0.5257115289980759, 'recall': 0.5355401265998542, 'f1-score': 0.5222227041363797, 'support': 358242}, 'weighted avg': {'precision': 0.5656281496190314, 'recall': 0.532785100574472, 'f1-score': 0.5396942839491431, 'support': 358242}}
[[46381 18447 27899]
 [44138 90397 38241]
 [19156 19495 54088]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1900989
{'0': {'precision': 0.39070919789408487, 'recall': 0.5135344160866203, 'f1-score': 0.44378000949751134, 'support': 24567}, '1': {'precision': 0.4273659474471267, 'recall': 0.16998767897353104, 'f1-score': 0.24322927748563788, 'support': 23537}, '2': {'precision': 0.4431231836783109, 'recall': 0.547964796479648, 'f1-score': 0.4899986883525709, 'support': 27270}, 'accuracy': 0.4187120227134025, 'macro avg': {'precision': 0.4203994430065075, 'recall': 0.4104956305132665, 'f1-score': 0.39233599177857337, 'support': 75374}, 'weighted avg': {'precision': 0.42111914438180986, 'recall': 0.4187120227134025, 'f1-score': 0.3978758620861229, 'support': 75374}}
[[12616  2273  9678]
 [10435  4001  9101]
 [ 9239  3088 14943]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1381469
{'0': {'precision': 0.4388776244358689, 'recall': 0.3866098179303987, 'f1-score': 0.4110889875938122, 'support': 17356}, '1': {'precision': 0.5118672547784079, 'recall': 0.2904648390941597, 'f1-score': 0.37061820393886397, 'support': 16780}, '2': {'precision': 0.4078197431415761, 'recall': 0.6316130171246984, 'f1-score': 0.4956246680981736, 'support': 16993}, 'accuracy': 0.43648418705626946, 'macro avg': {'precision': 0.45285487411861763, 'recall': 0.43622922471641895, 'f1-score': 0.42577728654361663, 'support': 51129}, 'weighted avg': {'precision': 0.4525097983550515, 'recall': 0.43648418705626946, 'f1-score': 0.42590279324384606, 'support': 51129}}
[[ 6710  2437  8209]
 [ 4530  4874  7376]
 [ 4049  2211 10733]]
Evaluating performance on  val set...
53/53 - 1s - 609ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1247008
{'0': {'precision': 0.42654786383367604, 'recall': 0.42684042066758116, 'f1-score': 0.4266940921037595, 'support': 4374}, '1': {'precision': 0.5692704495210023, 'recall': 0.3188854489164087, 'f1-score': 0.40878423071834896, 'support': 4845}, '2': {'precision': 0.4146188761934575, 'recall': 0.621685050457639, 'f1-score': 0.49746478873239436, 'support': 4261}, 'accuracy': 0.44962908011869435, 'macro avg': {'precision': 0.4701457298493786, 'recall': 0.4558036400138763, 'f1-score': 0.44431437051816763, 'support': 13480}, 'weighted avg': {'precision': 0.4740746821808663, 'recall': 0.44962908011869435, 'f1-score': 0.4426273754807847, 'support': 13480}}
[[1867  625 1882]
 [1442 1545 1858]
 [1068  544 2649]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8648289
{'0': {'precision': 0.2839063310159466, 'recall': 0.6748157649840287, 'f1-score': 0.39966632405297103, 'support': 39759}, '1': {'precision': 0.8176063855102221, 'recall': 0.5870814354828473, 'f1-score': 0.6834280518299612, 'support': 204837}, '2': {'precision': 0.4607255838998452, 'recall': 0.4940930198984625, 'f1-score': 0.47682626666047456, 'support': 41561}, 'accuracy': 0.5857658558064279, 'macro avg': {'precision': 0.5207461001420046, 'recall': 0.5853300734551129, 'f1-score': 0.519973547514469, 'support': 286157}, 'weighted avg': {'precision': 0.6916206383072294, 'recall': 0.5857658558064279, 'f1-score': 0.6139953301837516, 'support': 286157}}
[[ 26830  10883   2046]
 [ 62591 120256  21990]
 [  5082  15944  20535]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80495346
{'0': {'precision': 0.39239964317573595, 'recall': 0.5380926750501541, 'f1-score': 0.45384012215756675, 'support': 20437}, '1': {'precision': 0.7987992703816, 'recall': 0.7446063417710116, 'f1-score': 0.7707513797343684, 'support': 88808}, '2': {'precision': 0.504916073659623, 'recall': 0.4654015621870619, 'f1-score': 0.4843542377738985, 'support': 19972}, 'accuracy': 0.6687897103322318, 'macro avg': {'precision': 0.565371662405653, 'recall': 0.5827001930027426, 'f1-score': 0.5696485798886112, 'support': 129217}, 'weighted avg': {'precision': 0.6890998934719244, 'recall': 0.6687897103322318, 'f1-score': 0.6763625679655485, 'support': 129217}}
[[10997  7822  1618]
 [15185 66127  7496]
 [ 1843  8834  9295]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8269357
{'0': {'precision': 0.32667997338656024, 'recall': 0.5926770386266095, 'f1-score': 0.42119811275794694, 'support': 7456}, '1': {'precision': 0.7919732208235991, 'recall': 0.6921740720424209, 'f1-score': 0.7387182280910022, 'support': 32814}, '2': {'precision': 0.5988942393436776, 'recall': 0.4451809624817712, 'f1-score': 0.5107224334600762, 'support': 7543}, 'accuracy': 0.6376926777236317, 'macro avg': {'precision': 0.5725158111846124, 'recall': 0.5766773577169338, 'f1-score': 0.5568795914363417, 'support': 47813}, 'weighted avg': {'precision': 0.6889547695615238, 'recall': 0.6376926777236317, 'f1-score': 0.6532351532196422, 'support': 47813}}
[[ 4419  2671   366]
 [ 8218 22713  1883]
 [  890  3295  3358]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1306274
{'0': {'precision': 0.4512158131540367, 'recall': 0.4146477433741377, 'f1-score': 0.43215958747412636, 'support': 43051}, '1': {'precision': 0.4583385112464272, 'recall': 0.35383988103803904, 'f1-score': 0.3993665574835548, 'support': 41694}, '2': {'precision': 0.4313617511917259, 'recall': 0.5556146650707098, 'f1-score': 0.48566695407031374, 'support': 45114}, 'accuracy': 0.44409705911796643, 'macro avg': {'precision': 0.4469720251973966, 'recall': 0.44136742982762883, 'f1-score': 0.439064366342665, 'support': 129859}, 'weighted avg': {'precision': 0.4466052557255677, 'recall': 0.44409705911796643, 'f1-score': 0.44021955054325146, 'support': 129859}}
[[17851  8732 16468]
 [10366 14753 16575]
 [11345  8703 25066]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2310792
{'0': {'precision': 0.42150353394731205, 'recall': 0.43315578641545976, 'f1-score': 0.4272502279536277, 'support': 22717}, '1': {'precision': 0.4065029106914667, 'recall': 0.261270304800146, 'f1-score': 0.3180934392533748, 'support': 21916}, '2': {'precision': 0.412066098876862, 'recall': 0.545332075980062, 'f1-score': 0.46942404329339, 'support': 22269}, 'accuracy': 0.4141879166542106, 'macro avg': {'precision': 0.4133575145052136, 'recall': 0.41325272239855587, 'f1-score': 0.4049225701667975, 'support': 66902}, 'weighted avg': {'precision': 0.4134482306550494, 'recall': 0.4141879166542106, 'f1-score': 0.4055302272458226, 'support': 66902}}
[[ 9840  4189  8688]
 [ 7551  5726  8639]
 [ 5954  4171 12144]]
Evaluating performance on  val set...
73/73 - 1s - 742ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2875135
{'0': {'precision': 0.41695652173913045, 'recall': 0.44953125, 'f1-score': 0.4326315789473685, 'support': 6400}, '1': {'precision': 0.34971956450016495, 'recall': 0.17857142857142858, 'f1-score': 0.23642243782759004, 'support': 5936}, '2': {'precision': 0.3982574802246933, 'recall': 0.5498575498575499, 'f1-score': 0.4619373711854265, 'support': 6318}, 'accuracy': 0.3972874450519996, 'macro avg': {'precision': 0.38831118882132953, 'recall': 0.39265340947632615, 'f1-score': 0.37699712932012835, 'support': 18654}, 'weighted avg': {'precision': 0.3892273954145506, 'recall': 0.3972874450519996, 'f1-score': 0.3801204035251023, 'support': 18654}}
[[2877  986 2537]
 [2164 1060 2712]
 [1859  985 3474]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2092127
{'0': {'precision': 0.33017541715054094, 'recall': 0.11084208798424162, 'f1-score': 0.16596770972548658, 'support': 48736}, '1': {'precision': 0.345615141955836, 'recall': 0.04563478840386538, 'f1-score': 0.08062403414526456, 'support': 60020}, '2': {'precision': 0.2965279805726757, 'recall': 0.8451463115472228, 'f1-score': 0.4390210601768098, 'support': 45656}, 'accuracy': 0.30261249125715617, 'macro avg': {'precision': 0.32410617989301754, 'recall': 0.3338743959784432, 'f1-score': 0.228537601349187, 'support': 154412}, 'weighted avg': {'precision': 0.32622808739906306, 'recall': 0.30261249125715617, 'f1-score': 0.21353005177066883, 'support': 154412}}
[[ 5402  2873 40461]
 [ 6202  2739 51079]
 [ 4757  2313 38586]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1683756
{'0': {'precision': 0.3435040561811357, 'recall': 0.09662148355016688, 'f1-score': 0.15082002073310122, 'support': 29362}, '1': {'precision': 0.32804799657167344, 'recall': 0.05623507805325987, 'f1-score': 0.09601153894393577, 'support': 27225}, '2': {'precision': 0.3144500710094823, 'recall': 0.8415233415233415, 'f1-score': 0.45782553755861194, 'support': 26048}, 'accuracy': 0.31812186119682945, 'macro avg': {'precision': 0.3286673745874305, 'recall': 0.3314599677089228, 'f1-score': 0.23488569907854964, 'support': 82635}, 'weighted avg': {'precision': 0.32925356391249844, 'recall': 0.31812186119682945, 'f1-score': 0.22953628848358074, 'support': 82635}}
[[ 2837  1692 24833]
 [ 2738  1531 22956]
 [ 2684  1444 21920]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1489966
{'0': {'precision': 0.37808807733619765, 'recall': 0.10064811284788411, 'f1-score': 0.15897628904779826, 'support': 10492}, '1': {'precision': 0.2744186046511628, 'recall': 0.05864811133200795, 'f1-score': 0.09664209664209665, 'support': 8048}, '2': {'precision': 0.3449818166617899, 'recall': 0.8339733225545675, 'f1-score': 0.488068837044265, 'support': 9896}, 'accuracy': 0.34396539597693065, 'macro avg': {'precision': 0.33249616621638345, 'recall': 0.3310898489114865, 'f1-score': 0.24789574091138666, 'support': 28436}, 'weighted avg': {'precision': 0.3372260900031304, 'recall': 0.34396539597693065, 'f1-score': 0.25586172562438947, 'support': 28436}}
[[1056  662 8774]
 [ 680  472 6896]
 [1057  586 8253]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
631/631 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.187936
{'0': {'precision': 0.4756590651787158, 'recall': 0.3242813262975506, 'f1-score': 0.3856471161231103, 'support': 63485}, '1': {'precision': 0.282817006233138, 'recall': 0.0773576263423075, 'f1-score': 0.12148580334485586, 'support': 39298}, '2': {'precision': 0.4017692350714965, 'recall': 0.7364545066211021, 'f1-score': 0.5199061536884133, 'support': 58525}, 'accuracy': 0.4136682619584893, 'macro avg': {'precision': 0.3867484354944501, 'recall': 0.37936448642032006, 'f1-score': 0.3423463577187931, 'support': 161308}, 'weighted avg': {'precision': 0.4018703532768367, 'recall': 0.4136682619584893, 'f1-score': 0.37000312390914397, 'support': 161308}}
[[20587  4183 38715]
 [10796  3040 25462]
 [11898  3526 43101]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2427521
{'0': {'precision': 0.405320994794679, 'recall': 0.4326780598636768, 'f1-score': 0.4185529820705472, 'support': 40492}, '1': {'precision': 0.42173707971160973, 'recall': 0.1553718597954523, 'f1-score': 0.2270839002267574, 'support': 40284}, '2': {'precision': 0.40355437250450166, 'recall': 0.6262422548900498, 'f1-score': 0.49082079603884965, 'support': 41155}, 'accuracy': 0.4063937800887387, 'macro avg': {'precision': 0.4102041490035968, 'recall': 0.40476405818305966, 'f1-score': 0.3788192261120515, 'support': 121931}, 'weighted avg': {'precision': 0.41014831700512094, 'recall': 0.4063937800887387, 'f1-score': 0.37968707750870695, 'support': 121931}}
[[17520  4203 18769]
 [14702  6259 19323]
 [11003  4379 25773]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2732571
{'0': {'precision': 0.3939777175549533, 'recall': 0.43267195767195765, 'f1-score': 0.4124192277383766, 'support': 15120}, '1': {'precision': 0.4739733950260266, 'recall': 0.19303927919439373, 'f1-score': 0.2743440599238398, 'support': 16981}, '2': {'precision': 0.38772801233193455, 'recall': 0.6129010423717342, 'f1-score': 0.4749790180444817, 'support': 14774}, 'accuracy': 0.4026666666666667, 'macro avg': {'precision': 0.41855970830430483, 'recall': 0.41287075974602844, 'f1-score': 0.387247435235566, 'support': 46875}, 'weighted avg': {'precision': 0.42098728457727685, 'recall': 0.4026666666666667, 'f1-score': 0.3821174446412832, 'support': 46875}}
[[6542 1783 6795]
 [6199 3278 7504]
 [3864 1855 9055]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8230999
{'0': {'precision': 0.422733306783486, 'recall': 0.6331858627031863, 'f1-score': 0.5069872037254471, 'support': 100585}, '1': {'precision': 0.8107642048697122, 'recall': 0.6513209903772523, 'f1-score': 0.7223488023746375, 'support': 403523}, '2': {'precision': 0.44513347183567875, 'recall': 0.5777621751429676, 'f1-score': 0.5028495011712402, 'support': 98274}, 'accuracy': 0.6362922530885717, 'macro avg': {'precision': 0.5595436611629591, 'recall': 0.6207563427411354, 'f1-score': 0.5773951690904416, 'support': 602382}, 'weighted avg': {'precision': 0.6863214384155525, 'recall': 0.6362922530885717, 'f1-score': 0.6505783631407436, 'support': 602382}}
[[ 63689  29676   7220]
 [ 77144 262823  63556]
 [  9827  31668  56779]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8089467
{'0': {'precision': 0.41097688759349144, 'recall': 0.6567167051578137, 'f1-score': 0.505567120283875, 'support': 51960}, '1': {'precision': 0.8082666589642125, 'recall': 0.6532009953361126, 'f1-score': 0.7225073843802284, 'support': 214199}, '2': {'precision': 0.48928229815125523, 'recall': 0.5805425318151373, 'f1-score': 0.5310199879170531, 'support': 53748}, 'accuracy': 0.641564579705977, 'macro avg': {'precision': 0.5695086149029863, 'recall': 0.6301534107696879, 'f1-score': 0.5863648308603855, 'support': 319907}, 'weighted avg': {'precision': 0.6901449925255366, 'recall': 0.641564579705977, 'f1-score': 0.6550994167285381, 'support': 319907}}
[[ 34123  14688   3149]
 [ 44863 139915  29421]
 [  4043  18502  31203]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8211635
{'0': {'precision': 0.37977351279961785, 'recall': 0.6583690568978956, 'f1-score': 0.4816893878642074, 'support': 20528}, '1': {'precision': 0.8173136399981896, 'recall': 0.6345342953523239, 'f1-score': 0.7144185310466243, 'support': 85376}, '2': {'precision': 0.4900804072891834, 'recall': 0.5855177407675597, 'f1-score': 0.5335650184761569, 'support': 20715}, 'accuracy': 0.6303793269572497, 'macro avg': {'precision': 0.5623891866956636, 'recall': 0.6261403643392597, 'f1-score': 0.5765576457956628, 'support': 126619}, 'weighted avg': {'precision': 0.6928421140289486, 'recall': 0.6303793269572497, 'f1-score': 0.6470996897657274, 'support': 126619}}
[[13515  5314  1699]
 [20281 54174 10921]
 [ 1791  6795 12129]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8801824
{'0': {'precision': 0.40268422909922214, 'recall': 0.5933421878090824, 'f1-score': 0.4797654709432117, 'support': 176935}, '1': {'precision': 0.7976664047661765, 'recall': 0.5976332732304013, 'f1-score': 0.6833112512586783, 'support': 647223}, '2': {'precision': 0.385399452408058, 'recall': 0.5671370241383451, 'f1-score': 0.45893108332341304, 'support': 166540}, 'accuracy': 0.5917403689116159, 'macro avg': {'precision': 0.5285833620911522, 'recall': 0.5860374950592763, 'f1-score': 0.5406692685084343, 'support': 990698}, 'weighted avg': {'precision': 0.6578204481806644, 'recall': 0.5917403689116159, 'f1-score': 0.6092395908656462, 'support': 990698}}
[[104983  49624  22328]
 [132127 386802 128294]
 [ 23598  48491  94451]]
Evaluating performance on  train set...
1577/1577 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8673066
{'0': {'precision': 0.33969112762387427, 'recall': 0.6274410588067867, 'f1-score': 0.4407591098176648, 'support': 63241}, '1': {'precision': 0.8159455572579356, 'recall': 0.62257987011357, 'f1-score': 0.7062666663954618, 'support': 278859}, '2': {'precision': 0.42439532492830473, 'recall': 0.5108777072138089, 'f1-score': 0.4636381101570928, 'support': 61410}, 'accuracy': 0.606341850263934, 'macro avg': {'precision': 0.5266773366033716, 'recall': 0.5869662120447219, 'f1-score': 0.5368879621234065, 'support': 403510}, 'weighted avg': {'precision': 0.6817136766308128, 'recall': 0.606341850263934, 'f1-score': 0.627728877928919, 'support': 403510}}
[[ 39680  17578   5983]
 [ 68679 173612  36568]
 [  8453  21584  31373]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84579843
{'0': {'precision': 0.35558104348674896, 'recall': 0.6352618040720234, 'f1-score': 0.45594930767425484, 'support': 22937}, '1': {'precision': 0.8314762897467232, 'recall': 0.6466461056809817, 'f1-score': 0.7275052544958042, 'support': 107323}, '2': {'precision': 0.4408053506171137, 'recall': 0.5513583441138422, 'f1-score': 0.4899225994329067, 'support': 23190}, 'accuracy': 0.6305441511893125, 'macro avg': {'precision': 0.5426208946168619, 'recall': 0.611088751288949, 'f1-score': 0.5577923872009886, 'support': 153450}, 'weighted avg': {'precision': 0.7013018463327078, 'recall': 0.6305441511893125, 'f1-score': 0.6510098454169221, 'support': 153450}}
[[14571  6341  2025]
 [23728 69400 14195]
 [ 2679  7725 12786]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
2451/2451 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0201179
{'0': {'precision': 0.49604155892999857, 'recall': 0.4871307150013158, 'f1-score': 0.49154575587394683, 'support': 216601}, '1': {'precision': 0.4598579830963639, 'recall': 0.41437669799135973, 'f1-score': 0.4359342787530455, 'support': 202077}, '2': {'precision': 0.4683151285800292, 'recall': 0.5219037395225795, 'f1-score': 0.4936593812825389, 'support': 208663}, 'accuracy': 0.4752614606729036, 'macro avg': {'precision': 0.47473822353546397, 'recall': 0.47447038417175164, 'f1-score': 0.4737131386365104, 'support': 627341}, 'weighted avg': {'precision': 0.4751640001703303, 'recall': 0.4752614606729036, 'f1-score': 0.47433539493224636, 'support': 627341}}
[[105513  48044  63044]
 [ 57747  83736  60594]
 [ 49450  50311 108902]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9927709
{'0': {'precision': 0.5014088759182852, 'recall': 0.48317494181536075, 'f1-score': 0.4921230678058176, 'support': 103120}, '1': {'precision': 0.48650611034412233, 'recall': 0.4700471301959312, 'f1-score': 0.4781350191463059, 'support': 101209}, '2': {'precision': 0.4920272519715837, 'recall': 0.5263762249058513, 'f1-score': 0.5086224729666196, 'support': 102763}, 'accuracy': 0.49330493793390906, 'macro avg': {'precision': 0.4933140794113304, 'recall': 0.49319943230571445, 'f1-score': 0.492960186639581, 'support': 307092}, 'weighted avg': {'precision': 0.49335794061996957, 'recall': 0.49330493793390906, 'f1-score': 0.493034234347958, 'support': 307092}}
[[49825 24337 28958]
 [26749 47573 26887]
 [22796 25875 54092]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9850393
{'0': {'precision': 0.48546706780377435, 'recall': 0.5081327260897853, 'f1-score': 0.4965413763287727, 'support': 38425}, '1': {'precision': 0.5057219043386478, 'recall': 0.4818451278251204, 'f1-score': 0.4934948772158074, 'support': 37786}, '2': {'precision': 0.4981787308629803, 'recall': 0.4980423294910057, 'f1-score': 0.49811052083903823, 'support': 36523}, 'accuracy': 0.49605265492220624, 'macro avg': {'precision': 0.4964559010018008, 'recall': 0.49600672780197047, 'f1-score': 0.49604892479453944, 'support': 112734}, 'weighted avg': {'precision': 0.49637431249675174, 'recall': 0.49605265492220624, 'f1-score': 0.49602861930308323, 'support': 112734}}
[[19525  8851 10049]
 [11305 18207  8274]
 [ 9389  8944 18190]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
3337/3337 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9643352
{'0': {'precision': 0.4686920141719346, 'recall': 0.5743152641582034, 'f1-score': 0.5161555120860696, 'support': 257289}, '1': {'precision': 0.5772519842051751, 'recall': 0.42520334171277296, 'f1-score': 0.48969658068225885, 'support': 344494}, '2': {'precision': 0.4934525396847675, 'recall': 0.5575369294079401, 'f1-score': 0.5235409523596795, 'support': 252238}, 'accuracy': 0.5092111318105761, 'macro avg': {'precision': 0.513132179353959, 'recall': 0.5190185117596388, 'f1-score': 0.509797681709336, 'support': 854021}, 'weighted avg': {'precision': 0.5197959141356792, 'recall': 0.5092111318105761, 'f1-score': 0.5076638538817754, 'support': 854021}}
[[147765  53160  56364]
 [110014 146480  88000]
 [ 57492  54114 140632]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.974462
{'0': {'precision': 0.4761506478048624, 'recall': 0.5121404783530125, 'f1-score': 0.4934902562221815, 'support': 115605}, '1': {'precision': 0.5417341352455857, 'recall': 0.4278450178884068, 'f1-score': 0.4781007306844957, 'support': 131370}, '2': {'precision': 0.4862293585293926, 'recall': 0.5632874734535931, 'f1-score': 0.5219295175428362, 'support': 119131}, 'accuracy': 0.4985359431421501, 'macro avg': {'precision': 0.5013713805266136, 'recall': 0.5010909898983374, 'f1-score': 0.49784016814983784, 'support': 366106}, 'weighted avg': {'precision': 0.5029636190001223, 'recall': 0.4985359431421501, 'f1-score': 0.4972221690302347, 'support': 366106}}
[[59206 23074 33325]
 [37583 56206 37581]
 [27554 24472 67105]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9863076
{'0': {'precision': 0.5014651299081851, 'recall': 0.4678330599599052, 'f1-score': 0.4840656232321327, 'support': 43896}, '1': {'precision': 0.4702130294773347, 'recall': 0.40290785598684037, 'f1-score': 0.43396630802863395, 'support': 37691}, '2': {'precision': 0.4963928809365185, 'recall': 0.5900533984976016, 'f1-score': 0.5391859900135427, 'support': 44196}, 'accuracy': 0.4913223567572724, 'macro avg': {'precision': 0.48935701344067944, 'recall': 0.4869314381481158, 'f1-score': 0.4857393070914364, 'support': 125783}, 'weighted avg': {'precision': 0.49031818610106515, 'recall': 0.4913223567572724, 'f1-score': 0.48842079397011895, 'support': 125783}}
[[20536  8745 14615]
 [10663 15186 11842]
 [ 9753  8365 26078]]
testing model on single stock: results/universal/W9/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
10303/10303 - 88s - 88s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3203549
{'0': {'precision': 0.367734110484979, 'recall': 0.5056240520391828, 'f1-score': 0.4257937212816641, 'support': 808314}, '1': {'precision': 0.3986467896919612, 'recall': 0.07771290997324286, 'f1-score': 0.13006978592113091, 'support': 1006834}, '2': {'precision': 0.36869313186751207, 'recall': 0.5962364519079216, 'f1-score': 0.4556359106068513, 'support': 822256}, 'accuracy': 0.37051813070731676, 'macro avg': {'precision': 0.3783580106814841, 'recall': 0.3931911379734491, 'f1-score': 0.3371664726032155, 'support': 2637404}, 'weighted avg': {'precision': 0.37983407603542135, 'recall': 0.37051813070731676, 'f1-score': 0.32220436086929805, 'support': 2637404}}
[[408703  56572 343039]
 [432167  78244 496423]
 [270539  61458 490259]]
Evaluating performance on  train set...
3419/3419 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2722341
{'0': {'precision': 0.38768097467629264, 'recall': 0.4515076570534317, 'f1-score': 0.4171670633799976, 'support': 286272}, '1': {'precision': 0.3914864197530864, 'recall': 0.06836896265044863, 'f1-score': 0.11640842505902944, 'support': 289883}, '2': {'precision': 0.3965377520229025, 'recall': 0.6513399710366924, 'f1-score': 0.49295997468754943, 'support': 298999}, 'accuracy': 0.3928714260575853, 'macro avg': {'precision': 0.39190171548409386, 'recall': 0.3904055302468576, 'f1-score': 0.3421784877088588, 'support': 875154}, 'weighted avg': {'precision': 0.39196742186736444, 'recall': 0.3928714260575853, 'f1-score': 0.34343968321107815, 'support': 875154}}
[[129254  15083 141935]
 [115623  19819 154441]
 [ 88526  15723 194750]]
Evaluating performance on  val set...
1396/1396 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3033606
{'0': {'precision': 0.3829918572875196, 'recall': 0.4757223839964161, 'f1-score': 0.42435024514701136, 'support': 116074}, '1': {'precision': 0.38379102478231747, 'recall': 0.059270988327219776, 'f1-score': 0.10268392539597203, 'support': 125677}, '2': {'precision': 0.37834251519266415, 'recall': 0.6343505172488422, 'f1-score': 0.4739872054438313, 'support': 115515}, 'accuracy': 0.38051479849747805, 'macro avg': {'precision': 0.3817084657541671, 'recall': 0.3897812965241593, 'f1-score': 0.33367379199560493, 'support': 357266}, 'weighted avg': {'precision': 0.3817697097032448, 'recall': 0.38051479849747805, 'f1-score': 0.3272454420068743, 'support': 357266}}
[[55219  5864 54991]
 [52817  7449 65411]
 [36142  6096 73277]]
training model: results/universal/W9/deepVOL_L2/h100
Epoch 1/50
6697/6697 - 244s - loss: 3.1472 - accuracy100: 0.4283 - val_loss: 3.2177 - val_accuracy100: 0.3868 - 244s/epoch - 36ms/step
Epoch 2/50
6697/6697 - 249s - loss: 3.0996 - accuracy100: 0.4448 - val_loss: 3.2118 - val_accuracy100: 0.3924 - 249s/epoch - 37ms/step
Epoch 3/50
6697/6697 - 234s - loss: 3.0809 - accuracy100: 0.4500 - val_loss: 3.2445 - val_accuracy100: 0.3932 - 234s/epoch - 35ms/step
Epoch 4/50
6697/6697 - 238s - loss: 3.0678 - accuracy100: 0.4552 - val_loss: 3.2222 - val_accuracy100: 0.4055 - 238s/epoch - 36ms/step
Epoch 5/50
6697/6697 - 251s - loss: 3.0608 - accuracy100: 0.4572 - val_loss: 3.2594 - val_accuracy100: 0.4004 - 251s/epoch - 37ms/step
Epoch 6/50
6697/6697 - 233s - loss: 3.0560 - accuracy100: 0.4586 - val_loss: 3.2718 - val_accuracy100: 0.3978 - 233s/epoch - 35ms/step
Epoch 7/50
6697/6697 - 228s - loss: 3.0528 - accuracy100: 0.4600 - val_loss: 3.2666 - val_accuracy100: 0.4056 - 228s/epoch - 34ms/step
Epoch 8/50
6697/6697 - 224s - loss: 3.0496 - accuracy100: 0.4610 - val_loss: 3.2964 - val_accuracy100: 0.4056 - 224s/epoch - 33ms/step
Epoch 9/50
6697/6697 - 227s - loss: 3.0473 - accuracy100: 0.4614 - val_loss: 3.2621 - val_accuracy100: 0.4081 - 227s/epoch - 34ms/step
Epoch 10/50
6697/6697 - 227s - loss: 3.0445 - accuracy100: 0.4623 - val_loss: 3.2727 - val_accuracy100: 0.4079 - 227s/epoch - 34ms/step
Epoch 11/50
6697/6697 - 230s - loss: 3.0419 - accuracy100: 0.4634 - val_loss: 3.2783 - val_accuracy100: 0.4082 - 230s/epoch - 34ms/step
Epoch 12/50
6697/6697 - 233s - loss: 3.0395 - accuracy100: 0.4637 - val_loss: 3.2720 - val_accuracy100: 0.4065 - 233s/epoch - 35ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 270s - 270s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.103482
{'0': {'precision': 0.34484160295680055, 'recall': 0.5809237901676395, 'f1-score': 0.43278068608948583, 'support': 1277801}, '1': {'precision': 0.5541211079128945, 'recall': 0.09992633664723248, 'f1-score': 0.16931888606301562, 'support': 1751210}, '2': {'precision': 0.3587792733966981, 'recall': 0.5160786276526275, 'f1-score': 0.4232877472391607, 'support': 1278685}, 'accuracy': 0.36613516831271287, 'macro avg': {'precision': 0.41924732808879767, 'recall': 0.39897625148916643, 'f1-score': 0.34179577313055404, 'support': 4307696}, 'weighted avg': {'precision': 0.43405733498631277, 'recall': 0.36613516831271287, 'f1-score': 0.32285755842723135, 'support': 4307696}}
[[742305  65939 469557]
 [866379 174992 709839]
 [543913  74870 659902]]
Evaluating performance on  train set...
6697/6697 - 112s - 112s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0795205
{'0': {'precision': 0.3664351023840453, 'recall': 0.5562882740066383, 'f1-score': 0.4418302513111111, 'support': 524834}, '1': {'precision': 0.5720958212970267, 'recall': 0.15403104305015233, 'f1-score': 0.24271382978851475, 'support': 654446}, '2': {'precision': 0.3888822166475271, 'recall': 0.5389312263312918, 'f1-score': 0.4517735143897185, 'support': 534725}, 'accuracy': 0.3972823883244215, 'macro avg': {'precision': 0.4424710467761997, 'recall': 0.4164168477960275, 'f1-score': 0.37877253182978143, 'support': 1714005}, 'weighted avg': {'precision': 0.4519639474132403, 'recall': 0.3972823883244215, 'f1-score': 0.3689051231755055, 'support': 1714005}}
[[291959  34549 198326]
 [299100 100805 254541]
 [205696  40849 288180]]
Evaluating performance on  val set...
2631/2631 - 44s - 44s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0820972
{'0': {'precision': 0.3619233115877411, 'recall': 0.593626111389092, 'f1-score': 0.44968292149573585, 'support': 207848}, '1': {'precision': 0.5677398691414889, 'recall': 0.14299543259719655, 'f1-score': 0.22845131792936263, 'support': 260323}, '2': {'precision': 0.3871255945252995, 'recall': 0.5037982969950707, 'f1-score': 0.4378223933634198, 'support': 204697}, 'accuracy': 0.39195652044680385, 'macro avg': {'precision': 0.43892959175150975, 'recall': 0.4134732803271198, 'f1-score': 0.3719855442628394, 'support': 672868}, 'weighted avg': {'precision': 0.44921772211481875, 'recall': 0.39195652044680385, 'f1-score': 0.3604834213526028, 'support': 672868}}
[[123384  12839  71625]
 [131460  37225  91638]
 [ 86068  15503 103126]]
testing model out of sample: results/universal/W9/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 142s - 142s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0574279
{'0': {'precision': 0.3727876063287162, 'recall': 0.602061623175877, 'f1-score': 0.4604632276935276, 'support': 638526}, '1': {'precision': 0.6113102167574659, 'recall': 0.1809433388716078, 'f1-score': 0.2792351285027492, 'support': 960588}, '2': {'precision': 0.3787463841008734, 'recall': 0.554184785982429, 'f1-score': 0.44996992392444035, 'support': 612146}, 'accuracy': 0.4058708609571014, 'macro avg': {'precision': 0.45428140239568515, 'recall': 0.4457299160099713, 'f1-score': 0.39655609337357234, 'support': 2211260}, 'weighted avg': {'precision': 0.4780532011862394, 'recall': 0.4058708609571014, 'f1-score': 0.37883150131376986, 'support': 2211260}}
[[384432  53082 201012]
 [431333 173812 355443]
 [215471  57433 339242]]
Evaluating performance on  train set...
3947/3947 - 66s - 66s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0651493
{'0': {'precision': 0.3455112569783493, 'recall': 0.5881443691992042, 'f1-score': 0.43530075670129537, 'support': 288538}, '1': {'precision': 0.5978319651952119, 'recall': 0.17317156999132577, 'f1-score': 0.2685525948433087, 'support': 427703}, '2': {'precision': 0.39593181674165134, 'recall': 0.5325103890746821, 'f1-score': 0.4541754014613396, 'support': 293337}, 'accuracy': 0.3961784032536367, 'macro avg': {'precision': 0.44642501297173753, 'recall': 0.4312754427550707, 'f1-score': 0.38600958433531457, 'support': 1009578}, 'weighted avg': {'precision': 0.46705564444099656, 'recall': 0.3961784032536367, 'f1-score': 0.3701427823781927, 'support': 1009578}}
[[169702  22193  96643]
 [211960  74066 141677]
 [109500  27632 156205]]
Evaluating performance on  val set...
1402/1402 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0619572
{'0': {'precision': 0.35127369076929593, 'recall': 0.5627125870940859, 'f1-score': 0.43253631284916205, 'support': 103193}, '1': {'precision': 0.6161642243883545, 'recall': 0.18811217752901993, 'f1-score': 0.2882292547409107, 'support': 152223}, '2': {'precision': 0.39532438448198165, 'recall': 0.5630871569447417, 'f1-score': 0.4645229613940502, 'support': 102826}, 'accuracy': 0.40364613864371013, 'macro avg': {'precision': 0.45425409987987736, 'recall': 0.4379706405226158, 'f1-score': 0.395096176328041, 'support': 358242}, 'weighted avg': {'precision': 0.4764739418029396, 'recall': 0.40364613864371013, 'f1-score': 0.3803989470932326, 'support': 358242}}
[[58068  8214 36911]
 [71937 28635 51651]
 [35302  9624 57900]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1248429
{'0': {'precision': 0.33036478849118, 'recall': 0.65847414234511, 'f1-score': 0.4399840337571991, 'support': 23436}, '1': {'precision': 0.3179645768906382, 'recall': 0.04077144917087239, 'f1-score': 0.07227529795188037, 'support': 27740}, '2': {'precision': 0.3837482573192591, 'recall': 0.3981320770311596, 'f1-score': 0.3908078615905726, 'support': 24198}, 'accuracy': 0.34756016663570993, 'macro avg': {'precision': 0.3440258742336924, 'recall': 0.36579255618238066, 'f1-score': 0.3010223977665507, 'support': 75374}, 'weighted avg': {'precision': 0.34293930104063775, 'recall': 0.34756016663570993, 'f1-score': 0.2888681934763653, 'support': 75374}}
[[15432  1160  6844]
 [17982  1131  8627]
 [13298  1266  9634]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0999906
{'0': {'precision': 0.38201854798028795, 'recall': 0.5602344505775906, 'f1-score': 0.4542727943890735, 'support': 17573}, '1': {'precision': 0.45263157894736844, 'recall': 0.11259286323224942, 'f1-score': 0.18032866825961866, 'support': 16422}, '2': {'precision': 0.37940111878907534, 'recall': 0.4710517100501926, 'f1-score': 0.42028796833910487, 'support': 17134}, 'accuracy': 0.3865712218114964, 'macro avg': {'precision': 0.40468374857224393, 'recall': 0.38129300795334414, 'f1-score': 0.35162981032926566, 'support': 51129}, 'weighted avg': {'precision': 0.40382144189135916, 'recall': 0.3865712218114964, 'f1-score': 0.35489658032585947, 'support': 51129}}
[[9845 1151 6577]
 [7948 1849 6625]
 [7978 1085 8071]]
Evaluating performance on  val set...
53/53 - 1s - 537ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0981312
{'0': {'precision': 0.36847077878256174, 'recall': 0.6161137440758294, 'f1-score': 0.4611486486486487, 'support': 4431}, '1': {'precision': 0.4626334519572954, 'recall': 0.10686395396629675, 'f1-score': 0.17362270450751252, 'support': 4866}, '2': {'precision': 0.37638973115019203, 'recall': 0.44513507052354767, 'f1-score': 0.40788608981380065, 'support': 4183}, 'accuracy': 0.3792284866468843, 'macro avg': {'precision': 0.402497987296683, 'recall': 0.3893709228552246, 'f1-score': 0.34755248098998726, 'support': 13480}, 'weighted avg': {'precision': 0.4049188904607554, 'recall': 0.3792284866468843, 'f1-score': 0.34082976676460286, 'support': 13480}}
[[2730  321 1380]
 [2641  520 1705]
 [2038  283 1862]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0371574
{'0': {'precision': 0.2805297647970373, 'recall': 0.713334001202164, 'f1-score': 0.4026938629315789, 'support': 59892}, '1': {'precision': 0.6524939303604905, 'recall': 0.25935245866595, 'f1-score': 0.37117195865474967, 'support': 163727}, '2': {'precision': 0.402660463763902, 'recall': 0.4428827273018005, 'f1-score': 0.4218149143714353, 'support': 62538}, 'accuracy': 0.39447925439531445, 'macro avg': {'precision': 0.44522805297380996, 'recall': 0.47185639572330484, 'f1-score': 0.39856024531925466, 'support': 286157}, 'weighted avg': {'precision': 0.5200429921065118, 'recall': 0.39447925439531445, 'f1-score': 0.38883715313036255, 'support': 286157}}
[[42723  9244  7925]
 [88101 42463 33163]
 [21470 13371 27697]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0175683
{'0': {'precision': 0.3389520323637064, 'recall': 0.5992031058438905, 'f1-score': 0.4329797967369638, 'support': 29364}, '1': {'precision': 0.6631703452431431, 'recall': 0.41450112287455887, 'f1-score': 0.5101459227467812, 'support': 71691}, '2': {'precision': 0.38746999815373256, 'recall': 0.44712733470634186, 'f1-score': 0.4151665018133861, 'support': 28162}, 'accuracy': 0.46358451287369307, 'macro avg': {'precision': 0.46319745858686073, 'recall': 0.4869438544749303, 'f1-score': 0.4527640737657104, 'support': 129217}, 'weighted avg': {'precision': 0.5294060594748329, 'recall': 0.46358451287369307, 'f1-score': 0.47191011339910593, 'support': 129217}}
[[17595  7297  4472]
 [26541 29716 15434]
 [ 7774  7796 12592]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0265863
{'0': {'precision': 0.300067975189056, 'recall': 0.655803156917363, 'f1-score': 0.41174070187711315, 'support': 10770}, '1': {'precision': 0.6227303295225286, 'recall': 0.35155656795747914, 'f1-score': 0.4494054841057996, 'support': 26340}, '2': {'precision': 0.4501860712387028, 'recall': 0.39559002148930206, 'f1-score': 0.4211259200318281, 'support': 10703}, 'accuracy': 0.42994583063183656, 'macro avg': {'precision': 0.45766145865009583, 'recall': 0.4676499154547147, 'f1-score': 0.42742403533824697, 'support': 47813}, 'weighted avg': {'precision': 0.5114255640281382, 'recall': 0.42994583063183656, 'f1-score': 0.43459098012389785, 'support': 47813}}
[[ 7063  2529  1178]
 [13087  9260  3993]
 [ 3388  3081  4234]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0934533
{'0': {'precision': 0.3821770222079662, 'recall': 0.48798997759414076, 'f1-score': 0.42865003280215014, 'support': 41507}, '1': {'precision': 0.4536466445452699, 'recall': 0.1461164307370166, 'f1-score': 0.2210380440162339, 'support': 45847}, '2': {'precision': 0.36131286940556906, 'recall': 0.5278202564404187, 'f1-score': 0.42897569743207326, 'support': 42505}, 'accuracy': 0.3803278941005244, 'macro avg': {'precision': 0.39904551205293504, 'recall': 0.38730888825719206, 'f1-score': 0.35955459141681906, 'support': 129859}, 'weighted avg': {'precision': 0.40058034396797104, 'recall': 0.3803278941005244, 'f1-score': 0.3554587678549919, 'support': 129859}}
[[20255  4171 17081]
 [16571  6699 22577]
 [16173  3897 22435]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.102981
{'0': {'precision': 0.37540923972353585, 'recall': 0.5059725441255126, 'f1-score': 0.4310204081632653, 'support': 22436}, '1': {'precision': 0.38694158075601376, 'recall': 0.10145058113343544, 'f1-score': 0.16075380112784635, 'support': 22198}, '2': {'precision': 0.3817073566125215, 'recall': 0.5286958864738638, 'f1-score': 0.4433356555139236, 'support': 22268}, 'accuracy': 0.3793160144689247, 'macro avg': {'precision': 0.381352725697357, 'recall': 0.37870633724427066, 'f1-score': 0.3450366216016785, 'support': 66902}, 'weighted avg': {'precision': 0.3813319531420118, 'recall': 0.3793160144689247, 'f1-score': 0.3454453548768498, 'support': 66902}}
[[11352  1828  9256]
 [10132  2252  9814]
 [ 8755  1740 11773]]
Evaluating performance on  val set...
73/73 - 1s - 705ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1110572
{'0': {'precision': 0.37968826108134435, 'recall': 0.4834108527131783, 'f1-score': 0.42531714636475243, 'support': 6450}, '1': {'precision': 0.3620253164556962, 'recall': 0.07210084033613445, 'f1-score': 0.12025227750525579, 'support': 5950}, '2': {'precision': 0.3683698822512693, 'recall': 0.5452510393348257, 'f1-score': 0.43968796338082655, 'support': 6254}, 'accuracy': 0.37294950144741074, 'macro avg': {'precision': 0.3700278199294366, 'recall': 0.36692091079471273, 'f1-score': 0.3284191290836116, 'support': 18654}, 'weighted avg': {'precision': 0.37025973841993687, 'recall': 0.37294950144741074, 'f1-score': 0.3328296970190101, 'support': 18654}}
[[3118  376 2956]
 [2630  429 2891]
 [2464  380 3410]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1299605
{'0': {'precision': 0.3079707063548311, 'recall': 0.6773000270163553, 'f1-score': 0.4234137088811516, 'support': 48119}, '1': {'precision': 0.3753869969040248, 'recall': 0.040192259882323694, 'f1-score': 0.0726102253162662, 'support': 60335}, '2': {'precision': 0.29403945213283644, 'recall': 0.2695287001174986, 'f1-score': 0.28125106431287955, 'support': 45958}, 'accuracy': 0.3069903893479781, 'macro avg': {'precision': 0.32579905179723073, 'recall': 0.32900699567205915, 'f1-score': 0.2590916661700991, 'support': 154412}, 'weighted avg': {'precision': 0.33016658043684005, 'recall': 0.3069903893479781, 'f1-score': 0.24402843442090233, 'support': 154412}}
[[32591  2001 13527]
 [41697  2425 16213]
 [31537  2034 12387]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143872
{'0': {'precision': 0.3505806314144678, 'recall': 0.6745012298442198, 'f1-score': 0.46136230868092065, 'support': 29272}, '1': {'precision': 0.3237160992498557, 'recall': 0.04122574955908289, 'f1-score': 0.07313734437129261, 'support': 27216}, '2': {'precision': 0.3123276880661678, 'recall': 0.27295674455960534, 'f1-score': 0.29131801298012167, 'support': 26147}, 'accuracy': 0.3388757790282568, 'macro avg': {'precision': 0.32887480624349713, 'recall': 0.32956124132096937, 'f1-score': 0.2752725553441116, 'support': 82635}, 'weighted avg': {'precision': 0.3296289182527315, 'recall': 0.3388757790282568, 'f1-score': 0.27969499061545655, 'support': 82635}}
[[19744  1263  8265]
 [18645  1122  7449]
 [17929  1081  7137]]
Evaluating performance on  val set...
112/112 - 1s - 956ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063044
{'0': {'precision': 0.3569450143619204, 'recall': 0.6802541544477029, 'f1-score': 0.4682096481194913, 'support': 10230}, '1': {'precision': 0.2542372881355932, 'recall': 0.03977820636451302, 'f1-score': 0.06879299562226392, 'support': 8296}, '2': {'precision': 0.3449358806595132, 'recall': 0.26599394550958627, 'f1-score': 0.3003646308113036, 'support': 9910}, 'accuracy': 0.3490293993529329, 'macro avg': {'precision': 0.3187060610523423, 'recall': 0.32867543544060074, 'f1-score': 0.2791224248510196, 'support': 28436}, 'weighted avg': {'precision': 0.3227955625485688, 'recall': 0.3490293993529329, 'f1-score': 0.2931883838544351, 'support': 28436}}
[[6959  509 2762]
 [5722  330 2244]
 [6815  459 2636]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.113783
{'0': {'precision': 0.4005030306817472, 'recall': 0.42796808226495725, 'f1-score': 0.4137803027857581, 'support': 59904}, '1': {'precision': 0.3037059355227478, 'recall': 0.02164623016299096, 'f1-score': 0.04041213967846691, 'support': 46567}, '2': {'precision': 0.3511816721112613, 'recall': 0.6018381749548662, 'f1-score': 0.4435469781068985, 'support': 54837}, 'accuracy': 0.36977707243286134, 'macro avg': {'precision': 0.35179687943858545, 'recall': 0.3504841624609381, 'f1-score': 0.29924647352370787, 'support': 161308}, 'weighted avg': {'precision': 0.3557923798138494, 'recall': 0.36977707243286134, 'f1-score': 0.3161142225117986, 'support': 161308}}
[[25637  1164 33103]
 [17688  1008 27871]
 [20687  1147 33003]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1132091
{'0': {'precision': 0.36339312432889154, 'recall': 0.5125124131082422, 'f1-score': 0.4252592981697205, 'support': 40280}, '1': {'precision': 0.35178916827852996, 'recall': 0.03611497220015886, 'f1-score': 0.06550513236088601, 'support': 40288}, '2': {'precision': 0.37188863017741774, 'recall': 0.5483161279404298, 'f1-score': 0.4431894791351161, 'support': 41363}, 'accuracy': 0.36724868983277426, 'macro avg': {'precision': 0.36235697426161306, 'recall': 0.36564783774961035, 'f1-score': 0.3113179698885742, 'support': 121931}, 'weighted avg': {'precision': 0.3624409417588775, 'recall': 0.36724868983277426, 'f1-score': 0.31247313421769296, 'support': 121931}}
[[20644  1292 18344]
 [18871  1455 19962]
 [17294  1389 22680]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143701
{'0': {'precision': 0.3644188069404386, 'recall': 0.5056536653538305, 'f1-score': 0.42357323400292674, 'support': 15742}, '1': {'precision': 0.357042583060365, 'recall': 0.048105415799760416, 'f1-score': 0.08478719857761972, 'support': 15861}, '2': {'precision': 0.3605590740336318, 'recall': 0.5405316919853327, 'f1-score': 0.4325726412869757, 'support': 15272}, 'accuracy': 0.3621973333333333, 'macro avg': {'precision': 0.3606734880114784, 'recall': 0.36476359104630784, 'f1-score': 0.3136443579558407, 'support': 46875}, 'weighted avg': {'precision': 0.36066541754492715, 'recall': 0.3621973333333333, 'f1-score': 0.311870911659699, 'support': 46875}}
[[7960  691 7091]
 [7549  763 7549]
 [6334  683 8255]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0117931
{'0': {'precision': 0.3724880016638739, 'recall': 0.6511091904350331, 'f1-score': 0.473878519953371, 'support': 145782}, '1': {'precision': 0.6430069295795088, 'recall': 0.2831878768898419, 'f1-score': 0.3932040342726817, 'support': 312923}, '2': {'precision': 0.3961142366739773, 'recall': 0.5782484322473326, 'f1-score': 0.4701584813407392, 'support': 143677}, 'accuracy': 0.4426045266956848, 'macro avg': {'precision': 0.47053638930578673, 'recall': 0.5041818331907358, 'f1-score': 0.4457470118555973, 'support': 602382}, 'weighted avg': {'precision': 0.5186513017752498, 'recall': 0.4426045266956848, 'f1-score': 0.4310827756077473, 'support': 602382}}
[[ 94920  23787  27075]
 [124723  88616  99584]
 [ 35184  25412  83081]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9975739
{'0': {'precision': 0.3793960973817699, 'recall': 0.6952165188685352, 'f1-score': 0.4908977060299555, 'support': 77245}, '1': {'precision': 0.6393316713253254, 'recall': 0.31129189477491614, 'f1-score': 0.4187120421870297, 'support': 163117}, '2': {'precision': 0.44975186731218225, 'recall': 0.5594066251807153, 'f1-score': 0.49862172519665626, 'support': 79545}, 'accuracy': 0.46568846571034705, 'macro avg': {'precision': 0.48949321200642587, 'recall': 0.5219716796080555, 'f1-score': 0.46941049113788047, 'support': 319907}, 'weighted avg': {'precision': 0.5294283277926881, 'recall': 0.46568846571034705, 'f1-score': 0.4560116240609729, 'support': 319907}}
[[53702 12381 11162]
 [69061 50777 43279]
 [18783 16264 44498]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0021495
{'0': {'precision': 0.3539411126866294, 'recall': 0.703668081719289, 'f1-score': 0.47098127573615106, 'support': 30152}, '1': {'precision': 0.6691536245965923, 'recall': 0.2904766208724994, 'f1-score': 0.4051007867564417, 'support': 66384}, '2': {'precision': 0.4528620862720237, 'recall': 0.5698899710800119, 'f1-score': 0.5046806005298793, 'support': 30083}, 'accuracy': 0.4552555303706395, 'macro avg': {'precision': 0.49198560785174844, 'recall': 0.5213448912239335, 'f1-score': 0.46025422100749064, 'support': 126619}, 'weighted avg': {'precision': 0.5427035183208581, 'recall': 0.4552555303706395, 'f1-score': 0.4444478676958151, 'support': 126619}}
[[21217  4018  4917]
 [31305 19283 15796]
 [ 7423  5516 17144]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
3870/3870 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0385565
{'0': {'precision': 0.3488763570218235, 'recall': 0.6510025062656641, 'f1-score': 0.4542937972531975, 'support': 240996}, '1': {'precision': 0.6868772110231204, 'recall': 0.23496450822915851, 'f1-score': 0.35015070967447853, 'support': 523079}, '2': {'precision': 0.35360030049686936, 'recall': 0.5649338328413268, 'f1-score': 0.4349555793371723, 'support': 226623}, 'accuracy': 0.41165016988022585, 'macro avg': {'precision': 0.4631179561806044, 'recall': 0.4836336157787165, 'f1-score': 0.41313336208828283, 'support': 990698}, 'weighted avg': {'precision': 0.5284181578049983, 'recall': 0.41165016988022585, 'f1-score': 0.39488361668720046, 'support': 990698}}
[[156889  26152  57955]
 [224089 122905 176085]
 [ 68720  29876 128027]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0403386
{'0': {'precision': 0.2956126283314443, 'recall': 0.7109233622873689, 'f1-score': 0.417586505851207, 'support': 88416}, '1': {'precision': 0.684822285066464, 'recall': 0.24096015850680974, 'f1-score': 0.3564873961569141, 'support': 228129}, '2': {'precision': 0.3785802111962968, 'recall': 0.4815040533547979, 'f1-score': 0.4238838302804533, 'support': 86965}, 'accuracy': 0.3957795345840252, 'macro avg': {'precision': 0.4530050415314017, 'recall': 0.47779585804965885, 'f1-score': 0.39931924409619146, 'support': 403510}, 'weighted avg': {'precision': 0.5335380468468348, 'recall': 0.3957795345840252, 'f1-score': 0.38440063195350943, 'support': 403510}}
[[ 62857  10444  15115]
 [119540  54970  53619]
 [ 30236  14855  41874]]
Evaluating performance on  val set...
600/600 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0303286
{'0': {'precision': 0.2948495447627693, 'recall': 0.6811200888176155, 'f1-score': 0.41154548503708116, 'support': 32426}, '1': {'precision': 0.7024339657170744, 'recall': 0.2611318358599889, 'f1-score': 0.38072723365212147, 'support': 88193}, '2': {'precision': 0.38622754491017963, 'recall': 0.5383022143705644, 'f1-score': 0.4497575996640751, 'support': 32831}, 'accuracy': 0.4091821440208537, 'macro avg': {'precision': 0.46117035179667437, 'recall': 0.49351804634938956, 'f1-score': 0.41401010611775924, 'support': 153450}, 'weighted avg': {'precision': 0.5486528941277914, 'recall': 0.4091821440208537, 'f1-score': 0.40200874923339974, 'support': 153450}}
[[22086  4148  6192]
 [43270 23030 21893]
 [ 9550  5608 17673]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0781251
{'0': {'precision': 0.4102096657545934, 'recall': 0.5603800730279273, 'f1-score': 0.47367762766720994, 'support': 219642}, '1': {'precision': 0.3923835484646837, 'recall': 0.1238354528386865, 'f1-score': 0.18825728726718827, 'support': 197609}, '2': {'precision': 0.3997856013165891, 'recall': 0.5041363225284402, 'f1-score': 0.44593772433407647, 'support': 210090}, 'accuracy': 0.4040354448378155, 'macro avg': {'precision': 0.40079293851195535, 'recall': 0.3961172827983513, 'f1-score': 0.36929087975615826, 'support': 627341}, 'weighted avg': {'precision': 0.4011036246871005, 'recall': 0.4040354448378155, 'f1-score': 0.37448196799031036, 'support': 627341}}
[[123083  17777  78782]
 [ 92907  24471  80231]
 [ 84059  20117 105914]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0721045
{'0': {'precision': 0.40352775295957116, 'recall': 0.5634490555739654, 'f1-score': 0.4702642903044748, 'support': 102602}, '1': {'precision': 0.42509954284028906, 'recall': 0.14030391231127162, 'f1-score': 0.21097546694771357, 'support': 102727}, '2': {'precision': 0.4101275370796549, 'recall': 0.5236186040112811, 'f1-score': 0.4599760020027106, 'support': 101763}, 'accuracy': 0.4087016268740312, 'macro avg': {'precision': 0.412918277626505, 'recall': 0.4091238572988394, 'f1-score': 0.38040525308496637, 'support': 307092}, 'weighted avg': {'precision': 0.4129308604664049, 'recall': 0.4087016268740312, 'f1-score': 0.3801188940081778, 'support': 307092}}
[[57811  9056 35735]
 [47411 14413 40903]
 [38042 10436 53285]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0722059
{'0': {'precision': 0.39569486804294557, 'recall': 0.5937830687830687, 'f1-score': 0.47491086825428735, 'support': 37800}, '1': {'precision': 0.4593182183630809, 'recall': 0.14678451221705505, 'f1-score': 0.2224731789949181, 'support': 38921}, '2': {'precision': 0.4094737566841852, 'recall': 0.49543220503707, 'f1-score': 0.4483703163873043, 'support': 36013}, 'accuracy': 0.40804016534497134, 'macro avg': {'precision': 0.4214956143634039, 'recall': 0.41199992867906454, 'f1-score': 0.3819181212121699, 'support': 112734}, 'weighted avg': {'precision': 0.42206227747086394, 'recall': 0.40804016534497134, 'f1-score': 0.37927927354417706, 'support': 112734}}
[[22445  3173 12182]
 [19659  5713 13549]
 [14619  3552 17842]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
3337/3337 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0570577
{'0': {'precision': 0.39765146024250864, 'recall': 0.6096346306883818, 'f1-score': 0.48133713607342954, 'support': 272683}, '1': {'precision': 0.5029728216187878, 'recall': 0.13301507775204424, 'f1-score': 0.21039069781350772, 'support': 317355}, '2': {'precision': 0.4142429846014879, 'recall': 0.5524333006292071, 'f1-score': 0.4734607080823986, 'support': 263983}, 'accuracy': 0.4148410870458689, 'macro avg': {'precision': 0.4382890888209281, 'recall': 0.43169433635654436, 'f1-score': 0.38839618065644527, 'support': 854021}, 'weighted avg': {'precision': 0.44191751577794103, 'recall': 0.4148410870458689, 'f1-score': 0.37821853594025506, 'support': 854021}}
[[166237  20385  86061]
 [154989  42213 120153]
 [ 96821  21329 145833]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0645442
{'0': {'precision': 0.3933890760346487, 'recall': 0.5457344804853421, 'f1-score': 0.4572049791486788, 'support': 119833}, '1': {'precision': 0.4604336135597835, 'recall': 0.11211111663600351, 'f1-score': 0.1803168340586616, 'support': 120666}, '2': {'precision': 0.421679326626976, 'recall': 0.5723407134952669, 'f1-score': 0.48559231590181423, 'support': 125607}, 'accuracy': 0.41194353547879575, 'macro avg': {'precision': 0.42516733874046936, 'recall': 0.4100621035388709, 'f1-score': 0.37437137636971823, 'support': 366106}, 'weighted avg': {'precision': 0.42519256920645787, 'recall': 0.41194353547879575, 'f1-score': 0.37568395324940124, 'support': 366106}}
[[65397  7394 47042]
 [55585 13528 51553]
 [45258  8459 71890]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0703523
{'0': {'precision': 0.4197762609025408, 'recall': 0.501517760057992, 'f1-score': 0.4570207671029272, 'support': 44144}, '1': {'precision': 0.4197119518486672, 'recall': 0.10454314245174418, 'f1-score': 0.16739181687635296, 'support': 37353}, '2': {'precision': 0.42106088893769905, 'recall': 0.6060154450616447, 'f1-score': 0.49688498032862755, 'support': 44286}, 'accuracy': 0.4204224736252117, 'macro avg': {'precision': 0.42018303389630235, 'recall': 0.40402544919046024, 'f1-score': 0.3737658547693026, 'support': 125783}, 'weighted avg': {'precision': 0.4202094585610135, 'recall': 0.4204224736252117, 'f1-score': 0.3850469420955744, 'support': 125783}}
[[22139  2716 19289]
 [15836  3905 17612]
 [14765  2683 26838]]
testing model on single stock: results/universal/W9/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
10303/10303 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1362017
{'0': {'precision': 0.33487808153763504, 'recall': 0.5579760954590324, 'f1-score': 0.4185542705746417, 'support': 804366}, '1': {'precision': 0.38470817481673936, 'recall': 0.016312944120493875, 'f1-score': 0.03129871551460569, 'support': 1016616}, '2': {'precision': 0.34359151425454687, 'recall': 0.5277699523040781, 'f1-score': 0.41621596558862256, 'support': 816422}, 'accuracy': 0.3398356869103103, 'macro avg': {'precision': 0.3543925902029738, 'recall': 0.3673529972945348, 'f1-score': 0.28868965055928997, 'support': 2637404}, 'weighted avg': {'precision': 0.35678291988421995, 'recall': 0.33983568691031035, 'f1-score': 0.2685585789793422, 'support': 2637404}}
[[448817  12835 342714]
 [519573  16584 480459]
 [371850  13689 430883]]
Evaluating performance on  train set...
3419/3419 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1176354
{'0': {'precision': 0.354160057106599, 'recall': 0.49899598744198553, 'f1-score': 0.4142839953784174, 'support': 286351}, '1': {'precision': 0.32921356072636887, 'recall': 0.016458689311172094, 'f1-score': 0.03135006476471013, 'support': 289695}, '2': {'precision': 0.3736535328018547, 'recall': 0.5711649303930353, 'f1-score': 0.451764656105923, 'support': 299108}, 'accuracy': 0.3639313766491383, 'macro avg': {'precision': 0.35234238354494085, 'recall': 0.3622065357153976, 'f1-score': 0.2991329054163502, 'support': 875154}, 'weighted avg': {'precision': 0.3525646570505926, 'recall': 0.3639313766491383, 'f1-score': 0.30033458811951763, 'support': 875154}}
[[142888   4608 138855]
 [137407   4768 147520]
 [123161   5107 170840]]
Evaluating performance on  val set...
1396/1396 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1188463
{'0': {'precision': 0.3633962493038439, 'recall': 0.55429114520253, 'f1-score': 0.4389889724861698, 'support': 118896}, '1': {'precision': 0.3314012096774194, 'recall': 0.0218471200013291, 'f1-score': 0.04099191072180052, 'support': 120382}, '2': {'precision': 0.36502616429630247, 'recall': 0.5196799674543174, 'f1-score': 0.4288356966761666, 'support': 117988}, 'accuracy': 0.3634518817911584, 'macro avg': {'precision': 0.35327454109252193, 'recall': 0.3652727442193922, 'f1-score': 0.302938859961379, 'support': 357266}, 'weighted avg': {'precision': 0.3531536948761121, 'recall': 0.3634518817911584, 'f1-score': 0.30152935697394934, 'support': 357266}}
[[65903  2609 50384]
 [61475  2630 56277]
 [53975  2697 61316]]
training model: results/universal/W9/deepVOL_L2/h200
Epoch 1/50
6697/6697 - 233s - loss: 3.2300 - accuracy200: 0.3980 - val_loss: 3.2944 - val_accuracy200: 0.3558 - 233s/epoch - 35ms/step
Epoch 2/50
6697/6697 - 230s - loss: 3.2086 - accuracy200: 0.4066 - val_loss: 3.2847 - val_accuracy200: 0.3699 - 230s/epoch - 34ms/step
Epoch 3/50
6697/6697 - 226s - loss: 3.1950 - accuracy200: 0.4108 - val_loss: 3.2998 - val_accuracy200: 0.3676 - 226s/epoch - 34ms/step
Epoch 4/50
6697/6697 - 231s - loss: 3.1880 - accuracy200: 0.4143 - val_loss: 3.3052 - val_accuracy200: 0.3621 - 231s/epoch - 34ms/step
Epoch 5/50
6697/6697 - 232s - loss: 3.1805 - accuracy200: 0.4178 - val_loss: 3.2962 - val_accuracy200: 0.3683 - 232s/epoch - 35ms/step
Epoch 6/50
6697/6697 - 229s - loss: 3.1750 - accuracy200: 0.4199 - val_loss: 3.3066 - val_accuracy200: 0.3689 - 229s/epoch - 34ms/step
Epoch 7/50
6697/6697 - 231s - loss: 3.1714 - accuracy200: 0.4219 - val_loss: 3.3119 - val_accuracy200: 0.3647 - 231s/epoch - 34ms/step
Epoch 8/50
6697/6697 - 228s - loss: 3.1684 - accuracy200: 0.4237 - val_loss: 3.3277 - val_accuracy200: 0.3634 - 228s/epoch - 34ms/step
Epoch 9/50
6697/6697 - 229s - loss: 3.1654 - accuracy200: 0.4247 - val_loss: 3.3313 - val_accuracy200: 0.3619 - 229s/epoch - 34ms/step
Epoch 10/50
6697/6697 - 229s - loss: 3.1625 - accuracy200: 0.4256 - val_loss: 3.3217 - val_accuracy200: 0.3648 - 229s/epoch - 34ms/step
Epoch 11/50
6697/6697 - 225s - loss: 3.1608 - accuracy200: 0.4259 - val_loss: 3.3351 - val_accuracy200: 0.3629 - 225s/epoch - 34ms/step
Epoch 12/50
6697/6697 - 228s - loss: 3.1582 - accuracy200: 0.4272 - val_loss: 3.3369 - val_accuracy200: 0.3636 - 228s/epoch - 34ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 272s - 272s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991676
{'0': {'precision': 0.33537555467202684, 'recall': 0.40876350315432486, 'f1-score': 0.36845072210160196, 'support': 1335151}, '1': {'precision': 0.37519835113849115, 'recall': 0.3239591947579204, 'f1-score': 0.34770119101978186, 'support': 1631261}, '2': {'precision': 0.3526632680659425, 'recall': 0.3344191088539042, 'f1-score': 0.343298969072165, 'support': 1341284}, 'accuracy': 0.3535008041421679, 'macro avg': {'precision': 0.3544123912921535, 'recall': 0.35571393558871645, 'f1-score': 0.3531502940645163, 'support': 4307696}, 'weighted avg': {'precision': 0.3558387229546833, 'recall': 0.3535008041421679, 'f1-score': 0.352761698379316, 'support': 4307696}}
[[545761 443315 346075]
 [625529 528462 477270]
 [456023 436710 448551]]
Evaluating performance on  train set...
6697/6697 - 111s - 111s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951933
{'0': {'precision': 0.37150667847379476, 'recall': 0.41172918778064144, 'f1-score': 0.39058513424463104, 'support': 561437}, '1': {'precision': 0.35401115810246236, 'recall': 0.3300306220324754, 'f1-score': 0.34160054577936816, 'support': 584873}, '2': {'precision': 0.3815284852743135, 'recall': 0.36730286509481325, 'f1-score': 0.3742805524567344, 'support': 567695}, 'accuracy': 0.36913661278701054, 'macro avg': {'precision': 0.36901544061685687, 'recall': 0.3696875583026434, 'f1-score': 0.3688220774935778, 'support': 1714005}, 'weighted avg': {'precision': 0.3688559698267827, 'recall': 0.36913661278701054, 'f1-score': 0.3684698004109936, 'support': 1714005}}
[[231160 175213 155064]
 [208899 193026 182948]
 [182164 177015 208516]]
Evaluating performance on  val set...
2631/2631 - 43s - 43s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948329
{'0': {'precision': 0.3716666300261613, 'recall': 0.4575991338476113, 'f1-score': 0.41018051242236025, 'support': 221670}, '1': {'precision': 0.3612822063626467, 'recall': 0.3183702010813023, 'f1-score': 0.33847151110476487, 'support': 234532}, '2': {'precision': 0.3748881104769986, 'recall': 0.33440872125760385, 'f1-score': 0.353493341659816, 'support': 216666}, 'accuracy': 0.36940231962286807, 'macro avg': {'precision': 0.3692789822886022, 'recall': 0.37012601872883916, 'f1-score': 0.367381788395647, 'support': 672868}, 'weighted avg': {'precision': 0.36908440830170675, 'recall': 0.36940231962286807, 'f1-score': 0.3669324488534943, 'support': 672868}}
[[101436  65528  54706]
 [ 93754  74668  66110]
 [ 77732  66479  72455]]
testing model out of sample: results/universal/W9/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 141s - 141s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.086736
{'0': {'precision': 0.391518921310328, 'recall': 0.41794638640416726, 'f1-score': 0.4043012512358938, 'support': 709335}, '1': {'precision': 0.3821597044009754, 'recall': 0.30058292433709105, 'f1-score': 0.3364977567753822, 'support': 835786}, '2': {'precision': 0.3524065231689989, 'recall': 0.42146008565779813, 'f1-score': 0.38385241525368696, 'support': 666139}, 'accuracy': 0.3746452248944041, 'macro avg': {'precision': 0.3753617162934341, 'recall': 0.37999646546635213, 'f1-score': 0.37488380775498764, 'support': 2211260}, 'weighted avg': {'precision': 0.37619887923057843, 'recall': 0.3746452248944041, 'f1-score': 0.372513501910385, 'support': 2211260}}
[[296464 209400 203471]
 [272117 251223 312446]
 [188634 196754 280751]]
Evaluating performance on  train set...
3947/3947 - 64s - 64s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091704
{'0': {'precision': 0.355931975388026, 'recall': 0.42303314019671795, 'f1-score': 0.386592462826243, 'support': 312732}, '1': {'precision': 0.3711083518923642, 'recall': 0.2996604954644316, 'f1-score': 0.33157924085851725, 'support': 377020}, '2': {'precision': 0.3733547255251833, 'recall': 0.3892647877283273, 'f1-score': 0.3811437957020027, 'support': 319826}, 'accuracy': 0.3662629336217707, 'macro avg': {'precision': 0.36679835093519114, 'recall': 0.3706528077964923, 'f1-score': 0.3664384997955876, 'support': 1009578}, 'weighted avg': {'precision': 0.36711887323547515, 'recall': 0.3662629336217707, 'f1-score': 0.36432205840187043, 'support': 1009578}}
[[132296  94603  85833]
 [140917 112978 123125]
 [ 98476  96853 124497]]
Evaluating performance on  val set...
1402/1402 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916938
{'0': {'precision': 0.35892777511685137, 'recall': 0.38947981540391596, 'f1-score': 0.37358018642909635, 'support': 111595}, '1': {'precision': 0.37749653259362, 'recall': 0.3216794581058821, 'f1-score': 0.3473599827707917, 'support': 135377}, '2': {'precision': 0.36789338851118336, 'recall': 0.4026691830682125, 'f1-score': 0.38449656308730024, 'support': 111270}, 'accuracy': 0.36795518113454034, 'macro avg': {'precision': 0.3681058987405515, 'recall': 0.3712761521926702, 'f1-score': 0.3684789107623961, 'support': 358242}, 'weighted avg': {'precision': 0.36872949150778217, 'recall': 0.36795518113454034, 'f1-score': 0.3670623932058228, 'support': 358242}}
[[43464 36493 31638]
 [46484 43548 45345]
 [31146 35319 44805]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.107552
{'0': {'precision': 0.39906936876262783, 'recall': 0.4664543600386446, 'f1-score': 0.4301387491132265, 'support': 27947}, '1': {'precision': 0.2781154441466269, 'recall': 0.3400729354198403, 'f1-score': 0.3059893670044858, 'support': 21663}, '2': {'precision': 0.4093347308712004, 'recall': 0.25768514205868653, 'f1-score': 0.3162708715432437, 'support': 25764}, 'accuracy': 0.3587709289675485, 'macro avg': {'precision': 0.3621731812601518, 'recall': 0.35473747917239046, 'f1-score': 0.350799662553652, 'support': 75374}, 'weighted avg': {'precision': 0.3678152482490401, 'recall': 0.3587709289675485, 'f1-score': 0.35553556947124537, 'support': 75374}}
[[13036  9606  5305]
 [10021  7367  4275]
 [ 9609  9516  6639]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1060627
{'0': {'precision': 0.36300127986348124, 'recall': 0.39858297224499356, 'f1-score': 0.3799609265978231, 'support': 17078}, '1': {'precision': 0.3690254665319794, 'recall': 0.4121978739830156, 'f1-score': 0.3894187612208258, 'support': 16839}, '2': {'precision': 0.36283903301886794, 'recall': 0.28602138043225656, 'f1-score': 0.31988304093567255, 'support': 17212}, 'accuracy': 0.3651743628860334, 'macro avg': {'precision': 0.3649552598047762, 'recall': 0.3656007422200886, 'f1-score': 0.3630875762514405, 'support': 51129}, 'weighted avg': {'precision': 0.36493068756989744, 'recall': 0.3651743628860334, 'f1-score': 0.36285126103033316, 'support': 51129}}
[[6807 5877 4394]
 [5647 6941 4251]
 [6298 5991 4923]]
Evaluating performance on  val set...
53/53 - 1s - 592ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949386
{'0': {'precision': 0.3621973929236499, 'recall': 0.44254835039817975, 'f1-score': 0.39836149513568864, 'support': 4395}, '1': {'precision': 0.4036363636363636, 'recall': 0.4033918837068443, 'f1-score': 0.40351408664041194, 'support': 4953}, '2': {'precision': 0.36740506329113926, 'recall': 0.2809777347531462, 'f1-score': 0.3184311574328031, 'support': 4132}, 'accuracy': 0.37863501483679524, 'macro avg': {'precision': 0.37774627328371757, 'recall': 0.37563932295272345, 'f1-score': 0.3734355797363012, 'support': 13480}, 'weighted avg': {'precision': 0.37901974573511404, 'recall': 0.37863501483679524, 'f1-score': 0.3757538267628823, 'support': 13480}}
[[1945 1572  878]
 [1834 1998 1121]
 [1591 1380 1161]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0776528
{'0': {'precision': 0.3140094137783483, 'recall': 0.466831217079315, 'f1-score': 0.37546559698743404, 'support': 78598}, '1': {'precision': 0.4138716743535835, 'recall': 0.29685217789497786, 'f1-score': 0.34572839369948416, 'support': 126659}, '2': {'precision': 0.3790976293652817, 'recall': 0.367663782447466, 'f1-score': 0.37329317269076306, 'support': 80900}, 'accuracy': 0.36355916507371827, 'macro avg': {'precision': 0.36899290583240446, 'recall': 0.377115725807253, 'f1-score': 0.36482905445922714, 'support': 286157}, 'weighted avg': {'precision': 0.37661172895212225, 'recall': 0.36355916507371827, 'f1-score': 0.3616891261799782, 'support': 286157}}
[[36692 25646 16260]
 [56604 37599 32456]
 [23554 27602 29744]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0750906
{'0': {'precision': 0.3728128565994675, 'recall': 0.4042794534673885, 'f1-score': 0.38790907067059144, 'support': 38790}, '1': {'precision': 0.4338144726712856, 'recall': 0.41482940115572897, 'f1-score': 0.4241095787314907, 'support': 54338}, '2': {'precision': 0.37302872730372516, 'recall': 0.3637673529330267, 'f1-score': 0.3683398333380095, 'support': 36089}, 'accuracy': 0.3974012707306314, 'macro avg': {'precision': 0.3932186855248261, 'recall': 0.39429206918538146, 'f1-score': 0.3934528275800306, 'support': 129217}, 'weighted avg': {'precision': 0.39852538956305905, 'recall': 0.3974012707306314, 'f1-score': 0.3976665251921915, 'support': 129217}}
[[15682 15550  7558]
 [17290 22541 14507]
 [ 9092 13869 13128]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0800875
{'0': {'precision': 0.34890770356433576, 'recall': 0.47418140492932737, 'f1-score': 0.40201126065094994, 'support': 14079}, '1': {'precision': 0.4097700184656706, 'recall': 0.36319000148787384, 'f1-score': 0.38507651049061364, 'support': 20163}, '2': {'precision': 0.39470762398223536, 'recall': 0.31434676884533197, 'f1-score': 0.3499733377086837, 'support': 13571}, 'accuracy': 0.38200907702925985, 'macro avg': {'precision': 0.38446178200408054, 'recall': 0.3839060584208444, 'f1-score': 0.3790203696167491, 'support': 47813}, 'weighted avg': {'precision': 0.3875732877223457, 'recall': 0.38200907702925985, 'f1-score': 0.38009960441242996, 'support': 47813}}
[[6676 5325 2078]
 [8376 7323 4464]
 [4082 5223 4266]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136463
{'0': {'precision': 0.38337687785760943, 'recall': 0.27203837597330366, 'f1-score': 0.31825082687198397, 'support': 43152}, '1': {'precision': 0.30478227204011654, 'recall': 0.38282697295294554, 'f1-score': 0.33937552604027676, 'support': 43184}, '2': {'precision': 0.3286885792386159, 'recall': 0.33982032488569264, 'f1-score': 0.3341617713511071, 'support': 43523}, 'accuracy': 0.3315981179587091, 'macro avg': {'precision': 0.33894924304544727, 'recall': 0.3315618912706473, 'f1-score': 0.33059604142112264, 'support': 129859}, 'weighted avg': {'precision': 0.33891150943172393, 'recall': 0.3315981179587091, 'f1-score': 0.33060839196526537, 'support': 129859}}
[[11739 18661 12752]
 [ 9197 16532 17455]
 [ 9684 19049 14790]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1156867
{'0': {'precision': 0.359336646111477, 'recall': 0.26658967753397883, 'f1-score': 0.3060917459265115, 'support': 22514}, '1': {'precision': 0.3246283255086072, 'recall': 0.45368387478926503, 'f1-score': 0.378456451091811, 'support': 21947}, '2': {'precision': 0.3603728171250064, 'recall': 0.31357782630007575, 'f1-score': 0.3353507434235608, 'support': 22441}, 'accuracy': 0.34372664494335, 'macro avg': {'precision': 0.34811259624836355, 'recall': 0.34461712620777324, 'f1-score': 0.3399663134806277, 'support': 66902}, 'weighted avg': {'precision': 0.34829824967255785, 'recall': 0.34372664494335, 'f1-score': 0.3396451426425157, 'support': 66902}}
[[ 6002 10359  6153]
 [ 5653  9957  6337]
 [ 5048 10356  7037]]
Evaluating performance on  val set...
73/73 - 1s - 684ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223813
{'0': {'precision': 0.38695978016487637, 'recall': 0.23537456313630148, 'f1-score': 0.29270597127739983, 'support': 6581}, '1': {'precision': 0.3200294086755593, 'recall': 0.5087660711304057, 'f1-score': 0.39290780141843973, 'support': 5989}, '2': {'precision': 0.3483430799220273, 'recall': 0.29372123602892836, 'f1-score': 0.31870875691100414, 'support': 6084}, 'accuracy': 0.3421786212072478, 'macro avg': {'precision': 0.351777422920821, 'recall': 0.34595395676521185, 'f1-score': 0.33477417653561453, 'support': 18654}, 'weighted avg': {'precision': 0.35287647368224456, 'recall': 0.3421786212072478, 'f1-score': 0.3333572904855877, 'support': 18654}}
[[1549 3386 1646]
 [1245 3047 1697]
 [1209 3088 1787]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10906
{'0': {'precision': 0.302634412461417, 'recall': 0.8036258895289732, 'f1-score': 0.4396882876097221, 'support': 47216}, '1': {'precision': 0.38214764154269193, 'recall': 0.0897395566004934, 'f1-score': 0.1453472780906409, 'support': 60397}, '2': {'precision': 0.30983164983164985, 'recall': 0.09831406653988332, 'f1-score': 0.14926438385050853, 'support': 46799}, 'accuracy': 0.31063000284951947, 'macro avg': {'precision': 0.33153790127858623, 'recall': 0.33055983755644996, 'f1-score': 0.2447666498502905, 'support': 154412}, 'weighted avg': {'precision': 0.3359166962768671, 'recall': 0.31063000284951947, 'f1-score': 0.2365378703885775, 'support': 154412}}
[[37944  4479  4793]
 [49521  5420  5456]
 [37914  4284  4601]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105752
{'0': {'precision': 0.35208918671214146, 'recall': 0.8051537536505755, 'f1-score': 0.4899333068512053, 'support': 29105}, '1': {'precision': 0.3282442748091603, 'recall': 0.09685042277443415, 'f1-score': 0.14956948166733194, 'support': 27083}, '2': {'precision': 0.3151972301224187, 'recall': 0.0963814421295421, 'f1-score': 0.14762263276770718, 'support': 26447}, 'accuracy': 0.34617292914624553, 'macro avg': {'precision': 0.3318435638812401, 'recall': 0.3327952061848506, 'f1-score': 0.26237514042874815, 'support': 82635}, 'weighted avg': {'precision': 0.332467073503491, 'recall': 0.34617292914624553, 'f1-score': 0.26882646501734414, 'support': 82635}}
[[23434  2861  2810]
 [21732  2623  2728]
 [21391  2507  2549]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080225
{'0': {'precision': 0.354499849933542, 'recall': 0.8199127330424435, 'f1-score': 0.49498608076151707, 'support': 10084}, '1': {'precision': 0.29054310672236994, 'recall': 0.09040415977310329, 'f1-score': 0.13789995493465526, 'support': 8462}, '2': {'precision': 0.3419354838709677, 'recall': 0.08574317492416582, 'f1-score': 0.13710590137429263, 'support': 9890}, 'accuracy': 0.34748206498804335, 'macro avg': {'precision': 0.32899281350895987, 'recall': 0.3320200225799042, 'f1-score': 0.2566639790234883, 'support': 28436}, 'weighted avg': {'precision': 0.3310976997924604, 'recall': 0.34748206498804335, 'f1-score': 0.26425398866394517, 'support': 28436}}
[[8268  941  875]
 [6940  765  757]
 [8115  927  848]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196126
{'0': {'precision': 0.42780297634666564, 'recall': 0.35439244790857993, 'f1-score': 0.38765285326086957, 'support': 64406}, '1': {'precision': 0.26332536420082214, 'recall': 0.3947911294481692, 'f1-score': 0.31592740479359477, 'support': 38780}, '2': {'precision': 0.3609098026619557, 'recall': 0.30931488937063417, 'f1-score': 0.33312641867790804, 'support': 58122}, 'accuracy': 0.3478624742728197, 'macro avg': {'precision': 0.3506793810698145, 'recall': 0.3528328222424611, 'f1-score': 0.3455688922441242, 'support': 161308}, 'weighted avg': {'precision': 0.3641582294034358, 'recall': 0.3478624742728197, 'f1-score': 0.3507625668374324, 'support': 161308}}
[[22825 22296 19285]
 [10920 15310 12550]
 [19609 20535 17978]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1116351
{'0': {'precision': 0.3556220393916729, 'recall': 0.3551262261614301, 'f1-score': 0.35537395983855696, 'support': 40166}, '1': {'precision': 0.3264458219467218, 'recall': 0.3655520724486242, 'f1-score': 0.3448939591328944, 'support': 40194}, '2': {'precision': 0.3580897533413018, 'recall': 0.3170960525366241, 'f1-score': 0.3363484429021599, 'support': 41571}, 'accuracy': 0.34559709999917987, 'macro avg': {'precision': 0.34671920489323216, 'recall': 0.34592478371555946, 'f1-score': 0.34553878729120374, 'support': 121931}, 'weighted avg': {'precision': 0.34684557116470566, 'recall': 0.34559709999917987, 'f1-score': 0.34543273969826155, 'support': 121931}}
[[14264 14722 11180]
 [13051 14693 12450]
 [12795 15594 13182]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1087174
{'0': {'precision': 0.34171060740943643, 'recall': 0.3203440970661873, 'f1-score': 0.3306825712392313, 'support': 15577}, '1': {'precision': 0.34582755752703076, 'recall': 0.38095528951869045, 'f1-score': 0.3625425058854303, 'support': 16372}, '2': {'precision': 0.32907213598370444, 'recall': 0.3138818169636875, 'f1-score': 0.32129753454720017, 'support': 14926}, 'accuracy': 0.339456, 'macro avg': {'precision': 0.3388701003067238, 'recall': 0.3383937345161884, 'f1-score': 0.3381742038906206, 'support': 46875}, 'weighted avg': {'precision': 0.3391241729096984, 'recall': 0.339456, 'f1-score': 0.33882187347629394, 'support': 46875}}
[[4990 6124 4463]
 [5046 6237 5089]
 [4567 5674 4685]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
2354/2354 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0781754
{'0': {'precision': 0.41517154028305525, 'recall': 0.39744738728860024, 'f1-score': 0.4061161717096084, 'support': 189688}, '1': {'precision': 0.3585364520712646, 'recall': 0.29198525942871384, 'f1-score': 0.32185661791760906, 'support': 224686}, '2': {'precision': 0.3885001597900863, 'recall': 0.49141525892515214, 'f1-score': 0.4339392231459302, 'support': 188008}, 'accuracy': 0.387438535680017, 'macro avg': {'precision': 0.3874027173814687, 'recall': 0.39361596854748876, 'f1-score': 0.3873040042577159, 'support': 602382}, 'weighted avg': {'precision': 0.38572254556927477, 'recall': 0.387438535680017, 'f1-score': 0.3833714916745655, 'support': 602382}}
[[75391 60000 54297]
 [67956 65605 91125]
 [38243 57375 92390]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0670369
{'0': {'precision': 0.44404066246087354, 'recall': 0.4498605874960729, 'f1-score': 0.44693167907845516, 'support': 101856}, '1': {'precision': 0.36204108038169175, 'recall': 0.31329875173855615, 'f1-score': 0.3359109389581096, 'support': 114319}, '2': {'precision': 0.4269704893537542, 'recall': 0.48482628311417886, 'f1-score': 0.45406283856988083, 'support': 103732}, 'accuracy': 0.4123979781624034, 'macro avg': {'precision': 0.4110174107321065, 'recall': 0.41599520744960267, 'f1-score': 0.41230181886881523, 'support': 319907}, 'weighted avg': {'precision': 0.4092029333069079, 'recall': 0.4123979781624034, 'f1-score': 0.4095706630536316, 'support': 319907}}
[[45821 31649 24386]
 [35393 35816 43110]
 [21977 31463 50292]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0666544
{'0': {'precision': 0.42650477329662145, 'recall': 0.4711073440694022, 'f1-score': 0.4476979022304348, 'support': 40114}, '1': {'precision': 0.3815642754739022, 'recall': 0.30564416656033344, 'f1-score': 0.3394105422255809, 'support': 47022}, '2': {'precision': 0.4233267628348714, 'recall': 0.4786617025048755, 'f1-score': 0.4492968963590761, 'support': 39483}, 'accuracy': 0.41201557428190083, 'macro avg': {'precision': 0.4104652705351317, 'recall': 0.4184710710448704, 'f1-score': 0.4121351136050306, 'support': 126619}, 'weighted avg': {'precision': 0.40882441351111387, 'recall': 0.41201557428190083, 'f1-score': 0.4079822579987864, 'support': 126619}}
[[18898 11673  9543]
 [16448 14372 16202]
 [ 8963 11621 18899]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0852879
{'0': {'precision': 0.3949588162650261, 'recall': 0.4510055696071519, 'f1-score': 0.4211255908068194, 'support': 309178}, '1': {'precision': 0.3714265375258051, 'recall': 0.22680723430695943, 'f1-score': 0.2816364762101319, 'support': 391081}, '2': {'precision': 0.3472621647439932, 'recall': 0.47686777602181524, 'f1-score': 0.4018738502428635, 'support': 290439}, 'accuracy': 0.37008452626330124, 'macro avg': {'precision': 0.3712158395116081, 'recall': 0.38489352664530885, 'f1-score': 0.36821197241993825, 'support': 990698}, 'weighted avg': {'precision': 0.3716863408257595, 'recall': 0.37008452626330124, 'f1-score': 0.3604178890619466, 'support': 990698}}
[[139441  78613  91124]
 [133169  88700 169212]
 [ 80442  71496 138501]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0802602
{'0': {'precision': 0.3394225402141371, 'recall': 0.5261865221571541, 'f1-score': 0.4126564144043486, 'support': 114410}, '1': {'precision': 0.4175515206443042, 'recall': 0.2303749708785308, 'f1-score': 0.29692695287896764, 'support': 175987}, '2': {'precision': 0.3567686943045331, 'recall': 0.4070354424336725, 'f1-score': 0.38024801476691317, 'support': 113113}, 'accuracy': 0.3637704146117816, 'macro avg': {'precision': 0.3712475850543248, 'recall': 0.38786564515645244, 'f1-score': 0.3632771273500765, 'support': 403510}, 'weighted avg': {'precision': 0.37836026271566314, 'recall': 0.3637704146117816, 'f1-score': 0.353097315364284, 'support': 403510}}
[[60201 28042 26167]
 [78602 40543 56842]
 [38560 28512 46041]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0781
{'0': {'precision': 0.34229313321822286, 'recall': 0.48898323174347175, 'f1-score': 0.4026954441134821, 'support': 42163}, '1': {'precision': 0.4290644171779141, 'recall': 0.24708532061473237, 'f1-score': 0.31358592086089004, 'support': 67932}, '2': {'precision': 0.35969906466043106, 'recall': 0.4488294314381271, 'f1-score': 0.39935148225298345, 'support': 43355}, 'accuracy': 0.3705506679700228, 'macro avg': {'precision': 0.37701887168552267, 'recall': 0.39496599459877707, 'f1-score': 0.3718776157424519, 'support': 153450}, 'weighted avg': {'precision': 0.38562438782641234, 'recall': 0.3705506679700228, 'f1-score': 0.3623020547354631, 'support': 153450}}
[[20617 10910 10636]
 [27144 16785 24003]
 [12471 11425 19459]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
2451/2451 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955931
{'0': {'precision': 0.3747399491456107, 'recall': 0.40568829856348804, 'f1-score': 0.3896004861918286, 'support': 207795}, '1': {'precision': 0.3779508396203456, 'recall': 0.3639124621513212, 'f1-score': 0.3707988258481936, 'support': 217643}, '2': {'precision': 0.3738344414135023, 'recall': 0.3570278797244221, 'f1-score': 0.3652379227267315, 'support': 201903}, 'accuracy': 0.3755341991038367, 'macro avg': {'precision': 0.37550841005981955, 'recall': 0.37554288014641046, 'f1-score': 0.37521241158891794, 'support': 627341}, 'weighted avg': {'precision': 0.37556247327197395, 'recall': 0.3755341991038367, 'f1-score': 0.37523680772435514, 'support': 627341}}
[[84300 67422 56073]
 [73772 79203 64668]
 [66884 62934 72085]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895425
{'0': {'precision': 0.39777416889568207, 'recall': 0.4004635640574358, 'f1-score': 0.3991143359676407, 'support': 103977}, '1': {'precision': 0.36828369665336197, 'recall': 0.3575616057233704, 'f1-score': 0.3628434585328964, 'support': 100640}, '2': {'precision': 0.3962388493056484, 'recall': 0.4048499634057087, 'f1-score': 0.40049812479184466, 'support': 102475}, 'accuracy': 0.3878674794524117, 'macro avg': {'precision': 0.3874322382848974, 'recall': 0.387625044395505, 'f1-score': 0.38748530643079393, 'support': 307092}, 'weighted avg': {'precision': 0.387597241455515, 'recall': 0.3878674794524117, 'f1-score': 0.3876894296031884, 'support': 307092}}
[[41639 31527 30811]
 [32251 35985 32404]
 [30790 30198 41487]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946934
{'0': {'precision': 0.3939126283122464, 'recall': 0.42899854409317806, 'f1-score': 0.4107076187868681, 'support': 38464}, '1': {'precision': 0.36063745886704196, 'recall': 0.3511080515766899, 'f1-score': 0.3558089616313389, 'support': 37769}, '2': {'precision': 0.3803011181874211, 'recall': 0.35500397249390425, 'f1-score': 0.3672173888400827, 'support': 36501}, 'accuracy': 0.37894512746819947, 'macro avg': {'precision': 0.3782837351222365, 'recall': 0.37837018938792405, 'f1-score': 0.3779113230860966, 'support': 112734}, 'weighted avg': {'precision': 0.37835739558882514, 'recall': 0.37894512746819947, 'f1-score': 0.37823379309635063, 'support': 112734}}
[[16501 11731 10232]
 [13625 13261 10883]
 [11764 11779 12958]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
3337/3337 - 29s - 29s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.075866
{'0': {'precision': 0.38089026180487434, 'recall': 0.4137244381300727, 'f1-score': 0.3966289814858418, 'support': 264652}, '1': {'precision': 0.4411541571240815, 'recall': 0.3631368777816218, 'f1-score': 0.39836162852966295, 'support': 341078}, '2': {'precision': 0.3600435275511204, 'recall': 0.41442903689622257, 'f1-score': 0.38532673515738075, 'support': 248291}, 'accuracy': 0.39372568121861173, 'macro avg': {'precision': 0.39402931549335873, 'recall': 0.39709678426930567, 'f1-score': 0.39343911505762846, 'support': 854021}, 'weighted avg': {'precision': 0.39889758527008856, 'recall': 0.39372568121861173, 'f1-score': 0.39403504263102734, 'support': 854021}}
[[109493  80946  74213]
 [108536 123858 108684]
 [ 69437  75955 102899]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913104
{'0': {'precision': 0.38108783652996475, 'recall': 0.3819203130798556, 'f1-score': 0.3815036206700451, 'support': 118564}, '1': {'precision': 0.36258950518328525, 'recall': 0.33356820397696085, 'f1-score': 0.3474739371076697, 'support': 122053}, '2': {'precision': 0.3963140467707168, 'recall': 0.4263481261305772, 'f1-score': 0.41078283836491514, 'support': 125489}, 'accuracy': 0.38102899160352466, 'macro avg': {'precision': 0.37999712949465564, 'recall': 0.3806122143957979, 'f1-score': 0.3799201320475434, 'support': 366106}, 'weighted avg': {'precision': 0.3801398735384963, 'recall': 0.38102899160352466, 'f1-score': 0.3801946958817951, 'support': 366106}}
[[45282 35242 38040]
 [37883 40713 43457]
 [35658 36329 53502]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962956
{'0': {'precision': 0.3924026693323967, 'recall': 0.3387205858345577, 'f1-score': 0.36359084764431987, 'support': 42879}, '1': {'precision': 0.3571869922420303, 'recall': 0.3889262664772869, 'f1-score': 0.37238154315980343, 'support': 40131}, '2': {'precision': 0.39183102966299116, 'recall': 0.4129006616323382, 'f1-score': 0.40209002117341713, 'support': 42773}, 'accuracy': 0.37996390609223823, 'macro avg': {'precision': 0.3804735637458061, 'recall': 0.38018250464806097, 'f1-score': 0.37935413732584683, 'support': 125783}, 'weighted avg': {'precision': 0.38097273777651885, 'recall': 0.37996390609223823, 'f1-score': 0.3794873086214944, 'support': 125783}}
[[14524 14442 13913]
 [11024 15608 13499]
 [11465 13647 17661]]
testing model on single stock: results/universal/W9/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
10303/10303 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1065792
{'0': {'precision': 0.3185911888492113, 'recall': 0.383964358123505, 'f1-score': 0.34823626930965607, 'support': 811854}, '1': {'precision': 0.3741590947245298, 'recall': 0.3403584874774922, 'f1-score': 0.35645931388818475, 'support': 1001876}, '2': {'precision': 0.33383003853701143, 'recall': 0.30299487418566085, 'f1-score': 0.3176659345610899, 'support': 823674}, 'accuracy': 0.34211254703488736, 'macro avg': {'precision': 0.3421934407035842, 'recall': 0.342439239928886, 'f1-score': 0.34078717258631025, 'support': 2637404}, 'weighted avg': {'precision': 0.3444590481322372, 'recall': 0.34211254703488736, 'f1-score': 0.3418127108053342, 'support': 2637404}}
[[311723 285541 214590]
 [377445 340997 283434]
 [289274 284831 249569]]
Evaluating performance on  train set...
3419/3419 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1094122
{'0': {'precision': 0.34096866767338024, 'recall': 0.3625816363061288, 'f1-score': 0.3514431782769454, 'support': 287709}, '1': {'precision': 0.33189555199379656, 'recall': 0.3323304204954713, 'f1-score': 0.3321128438905093, 'support': 288493}, '2': {'precision': 0.36074438978800516, 'recall': 0.3382817308464235, 'f1-score': 0.3491521503083953, 'support': 298952}, 'accuracy': 0.34430854455330145, 'macro avg': {'precision': 0.34453620315172734, 'recall': 0.3443979292160078, 'f1-score': 0.34423605749195, 'support': 875154}, 'weighted avg': {'precision': 0.34473310377932415, 'recall': 0.34430854455330145, 'f1-score': 0.3442883534673689, 'support': 875154}}
[[104318  94245  89146]
 [102557  95875  90061]
 [ 99071  98751 101130]]
Evaluating performance on  val set...
1396/1396 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058601
{'0': {'precision': 0.35383879753019687, 'recall': 0.4293317861917615, 'f1-score': 0.387946754194019, 'support': 118929}, '1': {'precision': 0.3481958624154451, 'recall': 0.32045311932362364, 'f1-score': 0.3337489573569752, 'support': 121116}, '2': {'precision': 0.3502073952924717, 'recall': 0.3032306497982443, 'f1-score': 0.32503040444773634, 'support': 117221}, 'accuracy': 0.3510465591464063, 'macro avg': {'precision': 0.35074735174603794, 'recall': 0.3510051851045432, 'f1-score': 0.34890870533291013, 'support': 357266}, 'weighted avg': {'precision': 0.3507343142290525, 'recall': 0.3510465591464063, 'f1-score': 0.3489300613228127, 'support': 357266}}
[[51060 35801 32068]
 [48420 38812 33884]
 [44823 36853 35545]]
training model: results/universal/W9/deepVOL_L3/h50
Epoch 1/50
6697/6697 - 392s - loss: 2.9878 - accuracy50: 0.4847 - val_loss: 3.1715 - val_accuracy50: 0.3966 - 392s/epoch - 59ms/step
Epoch 2/50
6697/6697 - 388s - loss: 2.8979 - accuracy50: 0.5085 - val_loss: 3.2019 - val_accuracy50: 0.4317 - 388s/epoch - 58ms/step
Epoch 3/50
6697/6697 - 384s - loss: 2.8689 - accuracy50: 0.5141 - val_loss: 3.2082 - val_accuracy50: 0.4479 - 384s/epoch - 57ms/step
Epoch 4/50
6697/6697 - 384s - loss: 2.8529 - accuracy50: 0.5185 - val_loss: 3.3037 - val_accuracy50: 0.4434 - 384s/epoch - 57ms/step
Epoch 5/50
6697/6697 - 390s - loss: 2.8416 - accuracy50: 0.5216 - val_loss: 3.2270 - val_accuracy50: 0.4523 - 390s/epoch - 58ms/step
Epoch 6/50
6697/6697 - 399s - loss: 2.8374 - accuracy50: 0.5228 - val_loss: 3.2549 - val_accuracy50: 0.4531 - 399s/epoch - 60ms/step
Epoch 7/50
6697/6697 - 401s - loss: 2.8286 - accuracy50: 0.5247 - val_loss: 3.2228 - val_accuracy50: 0.4620 - 401s/epoch - 60ms/step
Epoch 8/50
6697/6697 - 419s - loss: 2.8227 - accuracy50: 0.5260 - val_loss: 3.2410 - val_accuracy50: 0.4585 - 419s/epoch - 63ms/step
Epoch 9/50
6697/6697 - 424s - loss: 2.8171 - accuracy50: 0.5272 - val_loss: 3.2567 - val_accuracy50: 0.4545 - 424s/epoch - 63ms/step
Epoch 10/50
6697/6697 - 425s - loss: 2.8109 - accuracy50: 0.5285 - val_loss: 3.2413 - val_accuracy50: 0.4578 - 425s/epoch - 64ms/step
Epoch 11/50
6697/6697 - 446s - loss: 2.8066 - accuracy50: 0.5287 - val_loss: 3.2987 - val_accuracy50: 0.4512 - 446s/epoch - 67ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 541s - 541s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.143984
{'0': {'precision': 0.3407062772111994, 'recall': 0.5438556171977644, 'f1-score': 0.4189532102774057, 'support': 1213995}, '1': {'precision': 0.7455159810226294, 'recall': 0.13233696853604476, 'f1-score': 0.22477414918594182, 'support': 1877291}, '2': {'precision': 0.3550274328957098, 'recall': 0.5944138900535182, 'f1-score': 0.44454192663054837, 'support': 1216410}, 'accuracy': 0.3787927467490742, 'macro avg': {'precision': 0.48041656370984614, 'recall': 0.42353549192910905, 'f1-score': 0.36275642869796526, 'support': 4307696}, 'weighted avg': {'precision': 0.5211660892926597, 'recall': 0.3787927467490742, 'f1-score': 0.3415558653124107, 'support': 4307696}}
[[660238  33470 520287]
 [835588 248435 793268]
 [442025  51334 723051]]
Evaluating performance on  train set...
6697/6697 - 212s - 212s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920651
{'0': {'precision': 0.353092381885416, 'recall': 0.5305476319909763, 'f1-score': 0.42400145792756255, 'support': 491151}, '1': {'precision': 0.7437112972888589, 'recall': 0.19813426421413954, 'f1-score': 0.3129062697729815, 'support': 721324}, '2': {'precision': 0.3771043728088752, 'recall': 0.5893785017845393, 'f1-score': 0.45992995034908124, 'support': 501530}, 'accuracy': 0.4078687051671378, 'macro avg': {'precision': 0.4913026839943833, 'recall': 0.4393534659965517, 'f1-score': 0.3989458926832084, 'support': 1714005}, 'weighted avg': {'precision': 0.5245070115640432, 'recall': 0.4078687051671378, 'f1-score': 0.3877609518052054, 'support': 1714005}}
[[260579  19548 211024]
 [301176 142919 277229]
 [176236  29703 295591]]
Evaluating performance on  val set...
2631/2631 - 79s - 79s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.108177
{'0': {'precision': 0.34273545584653625, 'recall': 0.5658815908796476, 'f1-score': 0.42690743191338393, 'support': 192975}, '1': {'precision': 0.7460092440821631, 'recall': 0.1743832434130362, 'f1-score': 0.28268703486094793, 'support': 289701}, '2': {'precision': 0.3736218864842793, 'recall': 0.5628785648187095, 'f1-score': 0.4491268551051445, 'support': 190192}, 'accuracy': 0.39647449425444514, 'macro avg': {'precision': 0.48745552880432624, 'recall': 0.43438113303713105, 'f1-score': 0.3862404406264921, 'support': 672868}, 'weighted avg': {'precision': 0.5250939150710839, 'recall': 0.39647449425444514, 'f1-score': 0.37109435013389613, 'support': 672868}}
[[109201   6698  77076]
 [136780  50519 102402]
 [ 72635  10502 107055]]
testing model out of sample: results/universal/W9/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 273s - 273s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0492047
{'0': {'precision': 0.36894585851697914, 'recall': 0.6240016839811295, 'f1-score': 0.463716011488889, 'support': 565327}, '1': {'precision': 0.7302184357332085, 'recall': 0.23056868622553697, 'f1-score': 0.3504741092728799, 'support': 1096246}, '2': {'precision': 0.3665451377047088, 'recall': 0.6061267594103553, 'f1-score': 0.45682992826983104, 'support': 549687}, 'accuracy': 0.4245113645613813, 'macro avg': {'precision': 0.48856981065163224, 'recall': 0.4868990432056739, 'f1-score': 0.42367334967720005, 'support': 2211260}, 'weighted avg': {'precision': 0.5474522180865676, 'recall': 0.4245113645613813, 'f1-score': 0.40586384902806333, 'support': 2211260}}
[[352765  39033 173529]
 [441221 252760 402265]
 [162157  54350 333180]]
Evaluating performance on  train set...
3947/3947 - 125s - 125s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.064782
{'0': {'precision': 0.33771769682644964, 'recall': 0.6025766062348936, 'f1-score': 0.43284487198657556, 'support': 259411}, '1': {'precision': 0.7284557060462705, 'recall': 0.22977500413933513, 'f1-score': 0.34935409832499115, 'support': 489209}, '2': {'precision': 0.3843572173053253, 'recall': 0.5779704013672698, 'f1-score': 0.4616870405544187, 'support': 260958}, 'accuracy': 0.41556868315276285, 'macro avg': {'precision': 0.48351020672601513, 'recall': 0.47010733724716625, 'f1-score': 0.41462867028866185, 'support': 1009578}, 'weighted avg': {'precision': 0.5391122465665844, 'recall': 0.41556868315276285, 'f1-score': 0.39984311950476353, 'support': 1009578}}
[[156315  16652  86444]
 [221660 112408 155141]
 [ 84882  25250 150826]]
Evaluating performance on  val set...
1402/1402 - 44s - 44s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0533247
{'0': {'precision': 0.3384456477511033, 'recall': 0.5830556364381464, 'f1-score': 0.42828511676542347, 'support': 92727}, '1': {'precision': 0.742089784927187, 'recall': 0.24244107977959903, 'f1-score': 0.36547975325230564, 'support': 172776}, '2': {'precision': 0.3920422946688161, 'recall': 0.6005024854699749, 'f1-score': 0.47438136206823117, 'support': 92739}, 'accuracy': 0.42329765912427914, 'macro avg': {'precision': 0.49085924244903545, 'recall': 0.4753330672292401, 'f1-score': 0.4227154106953201, 'support': 358242}, 'weighted avg': {'precision': 0.5469932744482432, 'recall': 0.42329765912427914, 'f1-score': 0.4099278616328445, 'support': 358242}}
[[54065  5946 32716]
 [77243 41888 53645]
 [28437  8612 55690]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1129023
{'0': {'precision': 0.36795839132664276, 'recall': 0.613383807546709, 'f1-score': 0.459981684981685, 'support': 24567}, '1': {'precision': 0.4877543980682994, 'recall': 0.060075625610740535, 'f1-score': 0.10697533666212741, 'support': 23537}, '2': {'precision': 0.4156462153416661, 'recall': 0.48045471213788044, 'f1-score': 0.4457068988978092, 'support': 27270}, 'accuracy': 0.3925093533579218, 'macro avg': {'precision': 0.4237863349122028, 'recall': 0.3846380484317766, 'f1-score': 0.33755464018054054, 'support': 75374}, 'weighted avg': {'precision': 0.4226202849712425, 'recall': 0.3925093533579218, 'f1-score': 0.3445840168613156, 'support': 75374}}
[[15069   553  8945]
 [12648  1414  9475]
 [13236   932 13102]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1084224
{'0': {'precision': 0.4030645613379426, 'recall': 0.49711915187831296, 'f1-score': 0.4451782673752644, 'support': 17356}, '1': {'precision': 0.5921501706484642, 'recall': 0.08271752085816449, 'f1-score': 0.1451579167538172, 'support': 16780}, '2': {'precision': 0.3725848277877205, 'recall': 0.600306008356382, 'f1-score': 0.459794464977914, 'support': 16993}, 'accuracy': 0.39541160593792174, 'macro avg': {'precision': 0.45593318659137577, 'recall': 0.3933808936976198, 'f1-score': 0.3500435497023318, 'support': 51129}, 'weighted avg': {'precision': 0.45499036493299877, 'recall': 0.39541160593792174, 'f1-score': 0.3515725164791769, 'support': 51129}}
[[ 8628   457  8271]
 [ 6485  1388  8907]
 [ 6293   499 10201]]
Evaluating performance on  val set...
53/53 - 1s - 928ms/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1171309
{'0': {'precision': 0.37933378653976885, 'recall': 0.5102880658436214, 'f1-score': 0.43517254825502044, 'support': 4374}, '1': {'precision': 0.6500777604976672, 'recall': 0.08627450980392157, 'f1-score': 0.152332361516035, 'support': 4845}, '2': {'precision': 0.36962462246512295, 'recall': 0.6031448016897442, 'f1-score': 0.45835562689495274, 'support': 4261}, 'accuracy': 0.38724035608308605, 'macro avg': {'precision': 0.46634538983418633, 'recall': 0.3999024591124291, 'f1-score': 0.34862017888866936, 'support': 13480}, 'weighted avg': {'precision': 0.4735759086246317, 'recall': 0.38724035608308605, 'f1-score': 0.3408418652679557, 'support': 13480}}
[[2232  109 2033]
 [2077  418 2350]
 [1575  116 2570]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0346034
{'0': {'precision': 0.21335684518502374, 'recall': 0.8125204356246385, 'f1-score': 0.3379679032494299, 'support': 39759}, '1': {'precision': 0.825713154230381, 'recall': 0.3155484604832135, 'f1-score': 0.45660436005029736, 'support': 204837}, '2': {'precision': 0.37566634198175863, 'recall': 0.5103823295878348, 'f1-score': 0.43278313916715977, 'support': 41561}, 'accuracy': 0.41289571808482756, 'macro avg': {'precision': 0.47157878046572116, 'recall': 0.546150408565229, 'f1-score': 0.4091184674889623, 'support': 286157}, 'weighted avg': {'precision': 0.675267524540388, 'recall': 0.4128957180848276, 'f1-score': 0.43666110985173584, 'support': 286157}}
[[ 32305   3790   3664]
 [108612  64636  31589]
 [ 10496   9853  21212]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9655926
{'0': {'precision': 0.2754884582445378, 'recall': 0.6768116651171894, 'f1-score': 0.3915862186111032, 'support': 20437}, '1': {'precision': 0.8148086626108262, 'recall': 0.4418746058913611, 'f1-score': 0.5730055706035672, 'support': 88808}, '2': {'precision': 0.35523713813336794, 'recall': 0.5486681353895454, 'f1-score': 0.43125602628938, 'support': 19972}, 'accuracy': 0.49553851273439253, 'macro avg': {'precision': 0.48184475299624396, 'recall': 0.5557848021326987, 'f1-score': 0.4652826051680168, 'support': 129217}, 'weighted avg': {'precision': 0.6584774561635504, 'recall': 0.49553851273439253, 'f1-score': 0.5224031793105257, 'support': 129217}}
[[13832  3614  2991]
 [32668 39242 16898]
 [ 3709  5305 10958]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0068345
{'0': {'precision': 0.2398807174494584, 'recall': 0.733637339055794, 'f1-score': 0.3615453253577448, 'support': 7456}, '1': {'precision': 0.7775389225457625, 'recall': 0.3637471810812458, 'f1-score': 0.4956296065607807, 'support': 32814}, '2': {'precision': 0.38233771611968115, 'recall': 0.48959300013257323, 'f1-score': 0.4293686780606906, 'support': 7543}, 'accuracy': 0.4412816597996361, 'macro avg': {'precision': 0.46658578537163403, 'recall': 0.5289925067565376, 'f1-score': 0.42884786999307206, 'support': 47813}, 'weighted avg': {'precision': 0.6313489265766751, 'recall': 0.4412816597996361, 'f1-score': 0.4642670360396669, 'support': 47813}}
[[ 5470  1272   714]
 [15626 11936  5252]
 [ 1707  2143  3693]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
508/508 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778484
{'0': {'precision': 0.41821775977139725, 'recall': 0.49634154839608835, 'f1-score': 0.453942895989123, 'support': 43051}, '1': {'precision': 0.50355218614409, 'recall': 0.2532978366191778, 'f1-score': 0.3370513986627731, 'support': 41694}, '2': {'precision': 0.40489332618137147, 'recall': 0.5186859954781221, 'f1-score': 0.45477955824190774, 'support': 45114}, 'accuracy': 0.4260698141830755, 'macro avg': {'precision': 0.44222109069895293, 'recall': 0.42277512683112944, 'f1-score': 0.4152579509646013, 'support': 129859}, 'weighted avg': {'precision': 0.440987187198088, 'recall': 0.4260698141830755, 'f1-score': 0.416703051937862, 'support': 129859}}
[[21368  5051 16632]
 [13372 10561 17761]
 [16353  5361 23400]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1290607
{'0': {'precision': 0.3875438140984032, 'recall': 0.5256415899986794, 'f1-score': 0.4461506846755964, 'support': 22717}, '1': {'precision': 0.44077879935100056, 'recall': 0.14874977185617813, 'f1-score': 0.22243449781659388, 'support': 21916}, '2': {'precision': 0.39471666550498363, 'recall': 0.5085993982666487, 'f1-score': 0.44447932814002317, 'support': 22269}, 'accuracy': 0.3965053361633434, 'macro avg': {'precision': 0.40767975965146247, 'recall': 0.39433025337383537, 'f1-score': 0.37102150354407115, 'support': 66902}, 'weighted avg': {'precision': 0.40737027914831303, 'recall': 0.3965053361633434, 'f1-score': 0.3723085963988247, 'support': 66902}}
[[11941  1944  8832]
 [10120  3260  8536]
 [ 8751  2192 11326]]
Evaluating performance on  val set...
73/73 - 6s - 6s/epoch - 87ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.152291
{'0': {'precision': 0.3855721393034826, 'recall': 0.50859375, 'f1-score': 0.4386201320576742, 'support': 6400}, '1': {'precision': 0.36717557251908395, 'recall': 0.08103099730458221, 'f1-score': 0.13276290367099092, 'support': 5936}, '2': {'precision': 0.380588631768142, 'recall': 0.5362456473567585, 'f1-score': 0.44520367936925104, 'support': 6318}, 'accuracy': 0.38190200493191806, 'macro avg': {'precision': 0.37777878119690284, 'recall': 0.3752901315537802, 'f1-score': 0.33886223836597207, 'support': 18654}, 'weighted avg': {'precision': 0.378030173985563, 'recall': 0.38190200493191806, 'f1-score': 0.34352129771711404, 'support': 18654}}
[[3255  373 2772]
 [2713  481 2742]
 [2474  456 3388]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
604/604 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2286644
{'0': {'precision': 0.29853797271474913, 'recall': 0.27568942875902824, 'f1-score': 0.2866591282456103, 'support': 48736}, '1': {'precision': 0.2917547568710359, 'recall': 0.0045984671776074645, 'f1-score': 0.009054226946166716, 'support': 60020}, '2': {'precision': 0.29475382629540847, 'recall': 0.7002146486770633, 'f1-score': 0.4148693192140985, 'support': 45656}, 'accuracy': 0.29583840634147607, 'macro avg': {'precision': 0.2950155186270645, 'recall': 0.32683418153789967, 'f1-score': 0.23686089146862513, 'support': 154412}, 'weighted avg': {'precision': 0.29478245109815787, 'recall': 0.29583840634147607, 'f1-score': 0.21666274391579587, 'support': 154412}}
[[13436   464 34836]
 [18089   276 41655]
 [13481   206 31969]]
Evaluating performance on  train set...
323/323 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.175762
{'0': {'precision': 0.3461485207919878, 'recall': 0.25543219126762484, 'f1-score': 0.29395049873601287, 'support': 29362}, '1': {'precision': 0.3228511530398323, 'recall': 0.0056565656565656566, 'f1-score': 0.01111833080643997, 'support': 27225}, '2': {'precision': 0.3116827296622638, 'recall': 0.7238175675675675, 'f1-score': 0.4357341776540057, 'support': 26048}, 'accuracy': 0.320784171355963, 'macro avg': {'precision': 0.326894134498028, 'recall': 0.3283021081639193, 'f1-score': 0.24693433573215284, 'support': 82635}, 'weighted avg': {'precision': 0.32760872815691205, 'recall': 0.320784171355963, 'f1-score': 0.24546106322531225, 'support': 82635}}
[[ 7500   173 21689]
 [ 7123   154 19948]
 [ 7044   150 18854]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.136332
{'0': {'precision': 0.35970169130376883, 'recall': 0.2574342356080824, 'f1-score': 0.30009443919782236, 'support': 10492}, '1': {'precision': 0.23214285714285715, 'recall': 0.004845924453280318, 'f1-score': 0.00949367088607595, 'support': 8048}, '2': {'precision': 0.3411050628642998, 'recall': 0.7155416329830234, 'f1-score': 0.4619801011254281, 'support': 9896}, 'accuracy': 0.34537206358137573, 'macro avg': {'precision': 0.3109832037703086, 'recall': 0.32594059768146205, 'f1-score': 0.2571894037364421, 'support': 28436}, 'weighted avg': {'precision': 0.31712799133316805, 'recall': 0.34537206358137573, 'f1-score': 0.27418592629385036, 'support': 28436}}
[[2701   65 7726]
 [2057   39 5952]
 [2751   64 7081]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102449
{'0': {'precision': 0.44037605923876305, 'recall': 0.4412223359848783, 'f1-score': 0.440798791426683, 'support': 63485}, '1': {'precision': 0.2822283609576427, 'recall': 0.015598758206524505, 'f1-score': 0.029563539908367492, 'support': 39298}, '2': {'precision': 0.3898083304546263, 'recall': 0.6362750961127723, 'f1-score': 0.4834408713827619, 'support': 58525}, 'accuracy': 0.4082996503583207, 'macro avg': {'precision': 0.37080425021701063, 'recall': 0.3643653967680584, 'f1-score': 0.31793440090593744, 'support': 161308}, 'weighted avg': {'precision': 0.3835012323601019, 'recall': 0.4082996503583207, 'f1-score': 0.35608448596919023, 'support': 161308}}
[[28011   829 34645]
 [15039   613 23646]
 [20557   730 37238]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1512113
{'0': {'precision': 0.37040074158585284, 'recall': 0.5131383977081893, 'f1-score': 0.4302397813392968, 'support': 40492}, '1': {'precision': 0.43507715468573577, 'recall': 0.05739251315658822, 'f1-score': 0.10140795648931969, 'support': 40284}, '2': {'precision': 0.3844285454635581, 'recall': 0.5653262058073139, 'f1-score': 0.4576497895275188, 'support': 41155}, 'accuracy': 0.38018223421443276, 'macro avg': {'precision': 0.39663548057838227, 'recall': 0.3786190388906971, 'f1-score': 0.3297658424520451, 'support': 121931}, 'weighted avg': {'precision': 0.39650352835790137, 'recall': 0.38018223421443276, 'f1-score': 0.33085076340890834, 'support': 121931}}
[[20778  1358 18356]
 [19073  2312 18899]
 [16245  1644 23266]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1634405
{'0': {'precision': 0.36548223350253806, 'recall': 0.5238095238095238, 'f1-score': 0.43055178037510194, 'support': 15120}, '1': {'precision': 0.49117952265652026, 'recall': 0.08362287262234262, 'f1-score': 0.142914653784219, 'support': 16981}, '2': {'precision': 0.36896119028412655, 'recall': 0.5572627589007716, 'f1-score': 0.44397109577221744, 'support': 14774}, 'accuracy': 0.37489066666666665, 'macro avg': {'precision': 0.4085409821477283, 'recall': 0.3882317184442126, 'f1-score': 0.3391458433105128, 'support': 46875}, 'weighted avg': {'precision': 0.4121139940276572, 'recall': 0.37489066666666665, 'f1-score': 0.33058145331456223, 'support': 46875}}
[[7920  664 6536]
 [8016 1420 7545]
 [5734  807 8233]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97373176
{'0': {'precision': 0.2975779643489665, 'recall': 0.7466918526619277, 'f1-score': 0.4255586782104166, 'support': 100585}, '1': {'precision': 0.8078724746799568, 'recall': 0.3743950158974829, 'f1-score': 0.5116666581996819, 'support': 403523}, '2': {'precision': 0.3561002546246587, 'recall': 0.5905834707043572, 'f1-score': 0.4443023972379899, 'support': 98274}, 'accuracy': 0.47183016756808804, 'macro avg': {'precision': 0.487183564551194, 'recall': 0.5705567797545893, 'f1-score': 0.4605092445493628, 'support': 602382}, 'weighted avg': {'precision': 0.6489609592705371, 'recall': 0.47183016756808804, 'f1-score': 0.48629849223693805, 'support': 602382}}
[[ 75106  14141  11338]
 [158838 151077  93608]
 [ 18447  21788  58039]]
Evaluating performance on  train set...
1250/1250 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96211284
{'0': {'precision': 0.29522304696112295, 'recall': 0.7731139337952271, 'f1-score': 0.42728288039142687, 'support': 51960}, '1': {'precision': 0.7988145048814504, 'recall': 0.3850438143968926, 'f1-score': 0.5196205980840896, 'support': 214199}, '2': {'precision': 0.39196416384370075, 'recall': 0.5877055890451738, 'f1-score': 0.47027996754431023, 'support': 53748}, 'accuracy': 0.48212449243061267, 'macro avg': {'precision': 0.49533390522875803, 'recall': 0.5819544457457645, 'f1-score': 0.47239448200660883, 'support': 319907}, 'weighted avg': {'precision': 0.6486646041801929, 'recall': 0.48212449243061267, 'f1-score': 0.496333117592688, 'support': 319907}}
[[40171  7153  4636]
 [87358 82476 44365]
 [ 8541 13619 31588]]
Evaluating performance on  val set...
495/495 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98193747
{'0': {'precision': 0.26971422707916476, 'recall': 0.76826773187841, 'f1-score': 0.39926076885102724, 'support': 20528}, '1': {'precision': 0.8183074456912277, 'recall': 0.34679535232383807, 'f1-score': 0.48714194047286075, 'support': 85376}, '2': {'precision': 0.4010762107370792, 'recall': 0.6188752111996139, 'f1-score': 0.4867214639609712, 'support': 20715}, 'accuracy': 0.45963875879607324, 'macro avg': {'precision': 0.49636596116915727, 'recall': 0.5779794318006206, 'f1-score': 0.4577080577616197, 'support': 126619}, 'weighted avg': {'precision': 0.6611077629916045, 'recall': 0.45963875879607324, 'f1-score': 0.4728254882658714, 'support': 126619}}
[[15771  2069  2688]
 [39312 29608 16456]
 [ 3390  4505 12820]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
3870/3870 - 56s - 56s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0609909
{'0': {'precision': 0.3054445610756346, 'recall': 0.6890892135529997, 'f1-score': 0.4232707983280797, 'support': 176935}, '1': {'precision': 0.8333846912362874, 'recall': 0.2507172952753533, 'f1-score': 0.3854691870512569, 'support': 647223}, '2': {'precision': 0.2842569748775884, 'recall': 0.6773027500900685, 'f1-score': 0.40044944857346226, 'support': 166540}, 'accuracy': 0.4007194927212935, 'macro avg': {'precision': 0.4743620757298368, 'recall': 0.5390364196394738, 'f1-score': 0.40306314465093296, 'support': 990698}, 'weighted avg': {'precision': 0.6467861346505743, 'recall': 0.4007194927212935, 'f1-score': 0.3947386524636961, 'support': 990698}}
[[121924  12731  42280]
 [243214 162270 241739]
 [ 34031  19711 112798]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0554492
{'0': {'precision': 0.2451843254412308, 'recall': 0.7448965070128556, 'f1-score': 0.3689334074729612, 'support': 63241}, '1': {'precision': 0.8223074997914407, 'recall': 0.2827809036107854, 'f1-score': 0.4208402823177809, 'support': 278859}, '2': {'precision': 0.3089599154839324, 'recall': 0.5809965803615046, 'f1-score': 0.40340096443572593, 'support': 61410}, 'accuracy': 0.40059230254516615, 'macro avg': {'precision': 0.45881724690553466, 'recall': 0.5362246636617152, 'f1-score': 0.397724884742156, 'support': 403510}, 'weighted avg': {'precision': 0.6537304587728644, 'recall': 0.40059230254516615, 'f1-score': 0.4100509804833822, 'support': 403510}}
[[ 47108   5942  10191]
 [130392  78856  69611]
 [ 14633  11098  35679]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0240195
{'0': {'precision': 0.24015162150779165, 'recall': 0.7457819244016218, 'f1-score': 0.36331198827614763, 'support': 22937}, '1': {'precision': 0.8356726028775531, 'recall': 0.3095608583435051, 'f1-score': 0.45177081704390154, 'support': 107323}, '2': {'precision': 0.33635550113036927, 'recall': 0.6159120310478654, 'f1-score': 0.43509915618241085, 'support': 23190}, 'accuracy': 0.4210622352557836, 'macro avg': {'precision': 0.4707265751719046, 'recall': 0.5570849379309974, 'f1-score': 0.41672732050082, 'support': 153450}, 'weighted avg': {'precision': 0.6711979965615191, 'recall': 0.4210622352557836, 'f1-score': 0.43602890781728737, 'support': 153450}}
[[17106  2247  3584]
 [49503 33223 24597]
 [ 4621  4286 14283]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0509287
{'0': {'precision': 0.44282858374818707, 'recall': 0.5737138794373063, 'f1-score': 0.49984513959559307, 'support': 216601}, '1': {'precision': 0.5178908810487758, 'recall': 0.13293447547222098, 'f1-score': 0.2115638302480439, 'support': 202077}, '2': {'precision': 0.4239477700525691, 'recall': 0.5990568524367041, 'f1-score': 0.4965154822219089, 'support': 208663}, 'accuracy': 0.44016093320857397, 'macro avg': {'precision': 0.46155574494984397, 'recall': 0.4352350691154105, 'f1-score': 0.40264148402184863, 'support': 627341}, 'weighted avg': {'precision': 0.4607273606867936, 'recall': 0.44016093320857397, 'f1-score': 0.4058774275449065, 'support': 627341}}
[[124267  10563  81771]
 [ 87136  26863  88078]
 [ 69218  14444 125001]]
Evaluating performance on  train set...
1200/1200 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0301634
{'0': {'precision': 0.44050244727778115, 'recall': 0.565544996121024, 'f1-score': 0.4952528958184721, 'support': 103120}, '1': {'precision': 0.5452582381825711, 'recall': 0.1821280716141845, 'f1-score': 0.27305114246565193, 'support': 101209}, '2': {'precision': 0.4369384075972007, 'recall': 0.5990677578505883, 'f1-score': 0.5053169003968694, 'support': 102763}, 'accuracy': 0.45039922889557527, 'macro avg': {'precision': 0.4742330310191843, 'recall': 0.44891360852859896, 'f1-score': 0.42454031289366445, 'support': 307092}, 'weighted avg': {'precision': 0.4738344045804377, 'recall': 0.45039922889557527, 'f1-score': 0.42538910922489187, 'support': 307092}}
[[58319  6638 38163]
 [41607 18433 41169]
 [32466  8735 61562]]
Evaluating performance on  val set...
441/441 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0202127
{'0': {'precision': 0.4354908084453836, 'recall': 0.6060377358490566, 'f1-score': 0.5068010185205337, 'support': 38425}, '1': {'precision': 0.571643609777077, 'recall': 0.21105700524003598, 'f1-score': 0.30829000521870226, 'support': 37786}, '2': {'precision': 0.44581770028691237, 'recall': 0.5530761437997974, 'f1-score': 0.49368836532939037, 'support': 36523}, 'accuracy': 0.45649049976049816, 'macro avg': {'precision': 0.48431737283645765, 'recall': 0.4567236282962967, 'f1-score': 0.43625979635620876, 'support': 112734}, 'weighted avg': {'precision': 0.48447193944266503, 'recall': 0.45649049976049816, 'f1-score': 0.43601624568249786, 'support': 112734}}
[[23287  2571 12567]
 [17268  7975 12543]
 [12918  3405 20200]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
3337/3337 - 50s - 50s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0156866
{'0': {'precision': 0.41443825637527415, 'recall': 0.6470039527535184, 'f1-score': 0.505243126269049, 'support': 257289}, '1': {'precision': 0.6204909540129114, 'recall': 0.22599232497518099, 'f1-score': 0.3313147390012852, 'support': 344494}, '2': {'precision': 0.4465250457351583, 'recall': 0.5786638016476502, 'f1-score': 0.5040786020168532, 'support': 252238}, 'accuracy': 0.45699227536559406, 'macro avg': {'precision': 0.4938180853744479, 'recall': 0.4838866931254498, 'f1-score': 0.4468788224290625, 'support': 854021}, 'weighted avg': {'precision': 0.5070324965573524, 'recall': 0.45699227536559406, 'f1-score': 0.4347401490451325, 'support': 854021}}
[[166467  19819  71003]
 [156723  77853 109918]
 [ 78479  27798 145961]]
Evaluating performance on  train set...
1431/1431 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0287228
{'0': {'precision': 0.41856738751286493, 'recall': 0.5875005406340557, 'f1-score': 0.488850821253257, 'support': 115605}, '1': {'precision': 0.6124979904921571, 'recall': 0.20301438684631196, 'f1-score': 0.30495160451195735, 'support': 131370}, '2': {'precision': 0.4378228321896444, 'recall': 0.5891245771461668, 'f1-score': 0.502327945002523, 'support': 119131}, 'accuracy': 0.45006364277012667, 'macro avg': {'precision': 0.4896294033982222, 'recall': 0.4598798348755115, 'f1-score': 0.43204345692257906, 'support': 366106}, 'weighted avg': {'precision': 0.4944213306145323, 'recall': 0.45006364277012667, 'f1-score': 0.42724763290362405, 'support': 366106}}
[[67918  7001 40686]
 [55269 26670 49431]
 [39076  9872 70183]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.026261
{'0': {'precision': 0.44917413874469087, 'recall': 0.5420767268088208, 'f1-score': 0.49127189767835566, 'support': 43896}, '1': {'precision': 0.5306002188736426, 'recall': 0.16722825077604733, 'f1-score': 0.254307040548719, 'support': 37691}, '2': {'precision': 0.4442219632687226, 'recall': 0.61240836274776, 'f1-score': 0.5149298454221165, 'support': 44196}, 'accuracy': 0.4544652298005295, 'macro avg': {'precision': 0.47466544029568536, 'recall': 0.4405711134442094, 'f1-score': 0.42016959454973035, 'support': 125783}, 'weighted avg': {'precision': 0.4718335127364419, 'recall': 0.4544652298005295, 'f1-score': 0.42857776753684307, 'support': 125783}}
[[23795  2567 17534]
 [15059  6303 16329]
 [14121  3009 27066]]
testing model on single stock: results/universal/W9/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
10303/10303 - 148s - 148s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2118738
{'0': {'precision': 0.34326664685907615, 'recall': 0.5131248499964123, 'f1-score': 0.4113507603125054, 'support': 808314}, '1': {'precision': 0.38529751959902325, 'recall': 0.00595530146975569, 'f1-score': 0.011729310365064027, 'support': 1006834}, '2': {'precision': 0.34429461689037044, 'recall': 0.5918813605495126, 'f1-score': 0.4353488471947713, 'support': 822256}, 'accuracy': 0.3440656039044454, 'macro avg': {'precision': 0.35761959444948993, 'recall': 0.37032050400522687, 'f1-score': 0.2861429726241136, 'support': 2637404}, 'weighted avg': {'precision': 0.35963249989118795, 'recall': 0.3440656039044454, 'f1-score': 0.2662763265098275, 'support': 2637404}}
[[414766   4486 389062]
 [463027   5996 537811]
 [330498   5080 486678]]
Evaluating performance on  train set...
3419/3419 - 50s - 50s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1720574
{'0': {'precision': 0.35420039620687227, 'recall': 0.4921578079588643, 'f1-score': 0.41193548952991327, 'support': 286272}, '1': {'precision': 0.40255292652552926, 'recall': 0.008920840477020039, 'f1-score': 0.01745486944284138, 'support': 289883}, '2': {'precision': 0.3668671091689705, 'recall': 0.5778581199268225, 'f1-score': 0.44880168632793777, 'support': 298999}, 'accuracy': 0.3613718271298537, 'macro avg': {'precision': 0.37454014396712393, 'recall': 0.35964558945423564, 'f1-score': 0.2927306817668975, 'support': 875154}, 'weighted avg': {'precision': 0.37454414262786523, 'recall': 0.3613718271298537, 'f1-score': 0.293864533313878, 'support': 875154}}
[[140891   1901 143480]
 [132598   2586 154699]
 [124283   1937 172779]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1920806
{'0': {'precision': 0.3509937143890748, 'recall': 0.5349604562606614, 'f1-score': 0.42387690879427686, 'support': 116074}, '1': {'precision': 0.3893585280954749, 'recall': 0.006230256928475377, 'f1-score': 0.012264269156067915, 'support': 125677}, '2': {'precision': 0.3528930207521461, 'recall': 0.5448296757996797, 'f1-score': 0.42834294114844584, 'support': 115515}, 'accuracy': 0.3521577759988356, 'macro avg': {'precision': 0.36441508774556525, 'recall': 0.3620067963296054, 'f1-score': 0.2881613730329302, 'support': 357266}, 'weighted avg': {'precision': 0.3651035738963031, 'recall': 0.3521577759988356, 'f1-score': 0.28052616177547474, 'support': 357266}}
[[62095   704 53275]
 [62762   783 62132]
 [52055   524 62936]]
training model: results/universal/W9/deepVOL_L3/h100
Epoch 1/50
6697/6697 - 397s - loss: 3.1704 - accuracy100: 0.4205 - val_loss: 3.2466 - val_accuracy100: 0.3515 - 397s/epoch - 59ms/step
Epoch 2/50
6697/6697 - 398s - loss: 3.1163 - accuracy100: 0.4407 - val_loss: 3.1882 - val_accuracy100: 0.3954 - 398s/epoch - 59ms/step
Epoch 3/50
6697/6697 - 389s - loss: 3.0852 - accuracy100: 0.4495 - val_loss: 3.2203 - val_accuracy100: 0.3926 - 389s/epoch - 58ms/step
Epoch 4/50
6697/6697 - 394s - loss: 3.0657 - accuracy100: 0.4543 - val_loss: 3.2412 - val_accuracy100: 0.3998 - 394s/epoch - 59ms/step
Epoch 5/50
6697/6697 - 393s - loss: 3.0556 - accuracy100: 0.4575 - val_loss: 3.2151 - val_accuracy100: 0.3918 - 393s/epoch - 59ms/step
Epoch 6/50
6697/6697 - 415s - loss: 3.0462 - accuracy100: 0.4608 - val_loss: 3.2219 - val_accuracy100: 0.4025 - 415s/epoch - 62ms/step
Epoch 7/50
6697/6697 - 382s - loss: 3.0414 - accuracy100: 0.4621 - val_loss: 3.2251 - val_accuracy100: 0.4019 - 382s/epoch - 57ms/step
Epoch 8/50
6697/6697 - 392s - loss: 3.0368 - accuracy100: 0.4634 - val_loss: 3.2296 - val_accuracy100: 0.4035 - 392s/epoch - 59ms/step
Epoch 9/50
6697/6697 - 404s - loss: 3.0335 - accuracy100: 0.4645 - val_loss: 3.2025 - val_accuracy100: 0.4088 - 404s/epoch - 60ms/step
Epoch 10/50
6697/6697 - 386s - loss: 3.0300 - accuracy100: 0.4653 - val_loss: 3.1957 - val_accuracy100: 0.4096 - 386s/epoch - 58ms/step
Epoch 11/50
6697/6697 - 386s - loss: 3.0265 - accuracy100: 0.4665 - val_loss: 3.1976 - val_accuracy100: 0.4115 - 386s/epoch - 58ms/step
Epoch 12/50
6697/6697 - 393s - loss: 3.0237 - accuracy100: 0.4672 - val_loss: 3.2065 - val_accuracy100: 0.4111 - 393s/epoch - 59ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 513s - 513s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062571
{'0': {'precision': 0.3543954774912282, 'recall': 0.4262901656830759, 'f1-score': 0.38703236863121815, 'support': 1277801}, '1': {'precision': 0.6370899850938777, 'recall': 0.09420743371725836, 'f1-score': 0.16414282615746775, 'support': 1751210}, '2': {'precision': 0.34413523168793964, 'recall': 0.6759843120080395, 'f1-score': 0.45608383697357857, 'support': 1278685}, 'accuracy': 0.36540693679405417, 'macro avg': {'precision': 0.44520689809101516, 'recall': 0.39882730380279124, 'f1-score': 0.3357530105874215, 'support': 4307696}, 'weighted avg': {'precision': 0.46627380554730685, 'recall': 0.36540693679405417, 'f1-score': 0.31691801541824643, 'support': 4307696}}
[[544714  40448 692639]
 [631524 164977 954709]
 [360785  53529 864371]]
Evaluating performance on  train set...
6697/6697 - 216s - 216s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0739439
{'0': {'precision': 0.3795246215771045, 'recall': 0.3977562429263348, 'f1-score': 0.38842661506400716, 'support': 524834}, '1': {'precision': 0.6422181605409677, 'recall': 0.16267957936942085, 'f1-score': 0.2596001331345256, 'support': 654446}, '2': {'precision': 0.37292097032404914, 'recall': 0.6961391369395483, 'f1-score': 0.48566938503118584, 'support': 534725}, 'accuracy': 0.40108634455558767, 'macro avg': {'precision': 0.4648879174807072, 'recall': 0.4188583197451014, 'f1-score': 0.37789871107657286, 'support': 1714005}, 'weighted avg': {'precision': 0.4777668077926957, 'recall': 0.40108634455558767, 'f1-score': 0.36957495732548135, 'support': 1714005}}
[[208756  25951 290127]
 [212169 106465 335812]
 [129121  33361 372243]]
Evaluating performance on  val set...
2631/2631 - 82s - 82s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0774703
{'0': {'precision': 0.3732226474148154, 'recall': 0.44061525730341405, 'f1-score': 0.40412861546200907, 'support': 207848}, '1': {'precision': 0.6511671271888932, 'recall': 0.14755899401896874, 'f1-score': 0.2405970298828113, 'support': 260323}, '2': {'precision': 0.36947011924080997, 'recall': 0.6651245499445522, 'f1-score': 0.47505299243712873, 'support': 204697}, 'accuracy': 0.39553523127864604, 'macro avg': {'precision': 0.4646199646148396, 'recall': 0.41776626708897835, 'f1-score': 0.3732595459273164, 'support': 672868}, 'weighted avg': {'precision': 0.47961381113279994, 'recall': 0.39553523127864604, 'f1-score': 0.36243689322368383, 'support': 672868}}
[[ 91581   8443 107824]
 [ 97385  38413 124525]
 [ 56413  12135 136149]]
testing model out of sample: results/universal/W9/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 274s - 274s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.062488
{'0': {'precision': 0.3801383555753374, 'recall': 0.5524129009625294, 'f1-score': 0.45036308792313706, 'support': 638526}, '1': {'precision': 0.6519974709973386, 'recall': 0.1384870516808455, 'f1-score': 0.22845028554353736, 'support': 960588}, '2': {'precision': 0.35970993062349904, 'recall': 0.6342359502471633, 'f1-score': 0.459061150215729, 'support': 612146}, 'accuracy': 0.395251576024529, 'macro avg': {'precision': 0.4639485857320584, 'recall': 0.44171196763017945, 'f1-score': 0.3792915078941344, 'support': 2211260}, 'weighted avg': {'precision': 0.49258077543750706, 'recall': 0.395251576024529, 'f1-score': 0.3563703910118494, 'support': 2211260}}
[[352730  32500 253296]
 [389772 133029 437787]
 [185397  38504 388245]]
Evaluating performance on  train set...
3947/3947 - 127s - 127s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0665994
{'0': {'precision': 0.34846693465752343, 'recall': 0.5362725186977105, 'f1-score': 0.4224367750821409, 'support': 288538}, '1': {'precision': 0.6507628734901462, 'recall': 0.14360198548993108, 'f1-score': 0.23528442795494203, 'support': 427703}, '2': {'precision': 0.3834932601511611, 'recall': 0.615960482312153, 'f1-score': 0.47269159832044894, 'support': 293337}, 'accuracy': 0.3930731454132321, 'macro avg': {'precision': 0.4609076894329436, 'recall': 0.4319449954999315, 'f1-score': 0.3768042671191773, 'support': 1009578}, 'weighted avg': {'precision': 0.4867102374710321, 'recall': 0.3930731454132321, 'f1-score': 0.3577523017288301, 'support': 1009578}}
[[154735  14459 119344]
 [195159  61419 171125]
 [ 94151  18502 180684]]
Evaluating performance on  val set...
1402/1402 - 42s - 42s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0583388
{'0': {'precision': 0.35539631274391065, 'recall': 0.5118467337900826, 'f1-score': 0.41950971554288297, 'support': 103193}, '1': {'precision': 0.6830688789376957, 'recall': 0.17335750839229289, 'f1-score': 0.276533093012533, 'support': 152223}, '2': {'precision': 0.38340478042447174, 'recall': 0.637562484196604, 'f1-score': 0.4788488578054526, 'support': 102826}, 'accuracy': 0.4041011383366551, 'macro avg': {'precision': 0.4739566573686927, 'recall': 0.4409222421263265, 'f1-score': 0.39163055545362285, 'support': 358242}, 'weighted avg': {'precision': 0.5026691052736473, 'recall': 0.4041011383366551, 'f1-score': 0.3757886449561107, 'support': 358242}}
[[52819  5344 45030]
 [65433 26389 60401]
 [30368  6900 65558]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1250671
{'0': {'precision': 0.3354860639021074, 'recall': 0.5053763440860215, 'f1-score': 0.40326864147088864, 'support': 23436}, '1': {'precision': 0.3242034656232532, 'recall': 0.02090843547224225, 'f1-score': 0.039283416302617766, 'support': 27740}, '2': {'precision': 0.3597345941851049, 'recall': 0.5690966195553352, 'f1-score': 0.4408201155588278, 'support': 24198}, 'accuracy': 0.3475336322869955, 'macro avg': {'precision': 0.33980804123682185, 'recall': 0.36512713303786626, 'f1-score': 0.29445739111077807, 'support': 75374}, 'weighted avg': {'precision': 0.33911843925080265, 'recall': 0.3475336322869955, 'f1-score': 0.2813661342908546, 'support': 75374}}
[[11844   582 11010]
 [13660   580 13500]
 [ 9800   627 13771]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.096734
{'0': {'precision': 0.3806226572261558, 'recall': 0.41603596426335854, 'f1-score': 0.39754220929284134, 'support': 17573}, '1': {'precision': 0.4511326860841424, 'recall': 0.042443064182194616, 'f1-score': 0.07758668670340069, 'support': 16422}, '2': {'precision': 0.3706215433236766, 'recall': 0.6570561456752656, 'f1-score': 0.47392127973058307, 'support': 17134}, 'accuracy': 0.37681159420289856, 'macro avg': {'precision': 0.4007922955446583, 'recall': 0.37184505804027296, 'f1-score': 0.31635005857560833, 'support': 51129}, 'weighted avg': {'precision': 0.3999180983320013, 'recall': 0.37681159420289856, 'f1-score': 0.320372098414797, 'support': 51129}}
[[ 7311   413  9849]
 [ 6456   697  9269]
 [ 5441   435 11258]]
Evaluating performance on  val set...
53/53 - 1s - 912ms/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072533
{'0': {'precision': 0.36363636363636365, 'recall': 0.43962988038817424, 'f1-score': 0.3980384143849612, 'support': 4431}, '1': {'precision': 0.4296875, 'recall': 0.03390875462392109, 'f1-score': 0.06285714285714286, 'support': 4866}, '2': {'precision': 0.35237110737821425, 'recall': 0.6519244561319627, 'f1-score': 0.45747357825868146, 'support': 4183}, 'accuracy': 0.3590504451038576, 'macro avg': {'precision': 0.38189832367152593, 'recall': 0.37515436371468597, 'f1-score': 0.3061230451669285, 'support': 13480}, 'weighted avg': {'precision': 0.38398371249523716, 'recall': 0.3590504451038576, 'f1-score': 0.29548835676103, 'support': 13480}}
[[1948  108 2375]
 [2064  165 2637]
 [1345  111 2727]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.025421
{'0': {'precision': 0.29651634534786253, 'recall': 0.7382955987444066, 'f1-score': 0.4231043407952463, 'support': 59892}, '1': {'precision': 0.6789684879690489, 'recall': 0.2883336285401919, 'f1-score': 0.40477415371951847, 'support': 163727}, '2': {'precision': 0.4279809786231723, 'recall': 0.4619591288496594, 'f1-score': 0.4443214063256973, 'support': 62538}, 'accuracy': 0.4204545057433507, 'macro avg': {'precision': 0.46782193731336125, 'recall': 0.4961961187114193, 'f1-score': 0.42406663361348734, 'support': 286157}, 'weighted avg': {'precision': 0.5440702307698871, 'recall': 0.4204545057433507, 'f1-score': 0.41725344881914805, 'support': 286157}}
[[44218  8150  7524]
 [85430 47208 31089]
 [19477 14171 28890]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9847894
{'0': {'precision': 0.3662962171404146, 'recall': 0.5836738863914998, 'f1-score': 0.4501142421934501, 'support': 29364}, '1': {'precision': 0.6944734533606249, 'recall': 0.4637960134465972, 'f1-score': 0.5561642231682125, 'support': 71691}, '2': {'precision': 0.39604619525890766, 'recall': 0.48586748100276966, 'f1-score': 0.43638277176252976, 'support': 28162}, 'accuracy': 0.4958480695264555, 'macro avg': {'precision': 0.4856052885866491, 'recall': 0.5111124602802889, 'f1-score': 0.48088707904139744, 'support': 129217}, 'weighted avg': {'precision': 0.5548563379111808, 'recall': 0.4958480695264555, 'f1-score': 0.5059592433603717, 'support': 129217}}
[[17139  6872  5353]
 [22928 33250 15513]
 [ 6723  7756 13683]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0084368
{'0': {'precision': 0.3290541816122333, 'recall': 0.6473537604456825, 'f1-score': 0.4363226735089805, 'support': 10770}, '1': {'precision': 0.6490806315379117, 'recall': 0.3792710706150342, 'f1-score': 0.47878076250269586, 'support': 26340}, '2': {'precision': 0.41249777461278264, 'recall': 0.4329627207325049, 'f1-score': 0.4224825637051557, 'support': 10703}, 'accuracy': 0.4516763223391128, 'macro avg': {'precision': 0.4635441959209759, 'recall': 0.48652918393107386, 'f1-score': 0.44586199990561065, 'support': 47813}, 'weighted avg': {'precision': 0.524034489623177, 'recall': 0.4516763223391128, 'f1-score': 0.456614547452555, 'support': 47813}}
[[ 6972  2226  1572]
 [11322  9990  5028]
 [ 2894  3175  4634]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0981301
{'0': {'precision': 0.37584215591915304, 'recall': 0.3951381694653914, 'f1-score': 0.3852486934053673, 'support': 41507}, '1': {'precision': 0.4698001816530427, 'recall': 0.1353850851746025, 'f1-score': 0.21019658307793904, 'support': 45847}, '2': {'precision': 0.36077743839800575, 'recall': 0.6196918009645924, 'f1-score': 0.45604861748359504, 'support': 42505}, 'accuracy': 0.3769319030640926, 'macro avg': {'precision': 0.40213992532340054, 'recall': 0.3834050185348621, 'f1-score': 0.3504979646556338, 'support': 129859}, 'weighted avg': {'precision': 0.40408330815030585, 'recall': 0.3769319030640926, 'f1-score': 0.3466201553045307, 'support': 129859}}
[[16401  3690 21416]
 [14387  6207 25253]
 [12850  3315 26340]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036121
{'0': {'precision': 0.36869075070458623, 'recall': 0.44896594758423963, 'f1-score': 0.4048877544868059, 'support': 22436}, '1': {'precision': 0.4062730627306273, 'recall': 0.09919812595729345, 'f1-score': 0.15946122094286336, 'support': 22198}, '2': {'precision': 0.381897485436609, 'recall': 0.5858631219687443, 'f1-score': 0.46238636162257, 'support': 22268}, 'accuracy': 0.37847896923858776, 'macro avg': {'precision': 0.38562043295727416, 'recall': 0.3780090651700925, 'f1-score': 0.34224511235074645, 'support': 66902}, 'weighted avg': {'precision': 0.38555631124637485, 'recall': 0.37847896923858776, 'f1-score': 0.3425936645058002, 'support': 66902}}
[[10073  1612 10751]
 [ 9632  2202 10364]
 [ 7616  1606 13046]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1094775
{'0': {'precision': 0.37581610446137104, 'recall': 0.4283720930232558, 'f1-score': 0.40037675699174036, 'support': 6450}, '1': {'precision': 0.3487241798298906, 'recall': 0.04823529411764706, 'f1-score': 0.08474826517053005, 'support': 5950}, '2': {'precision': 0.36959633552819926, 'recall': 0.6192836584585865, 'f1-score': 0.46291758799976096, 'support': 6254}, 'accuracy': 0.3711268360673314, 'macro avg': {'precision': 0.36471220660648695, 'recall': 0.36529701519982977, 'f1-score': 0.3160142033873438, 'support': 18654}, 'weighted avg': {'precision': 0.36508942994301763, 'recall': 0.3711268360673314, 'f1-score': 0.32066950014537815, 'support': 18654}}
[[2763  262 3425]
 [2482  287 3181]
 [2107  274 3873]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1436731
{'0': {'precision': 0.3024570360578019, 'recall': 0.13788732101664622, 'f1-score': 0.18941989265730272, 'support': 48119}, '1': {'precision': 0.3274336283185841, 'recall': 0.002452970912405735, 'f1-score': 0.004869462220540576, 'support': 60335}, '2': {'precision': 0.29751634184952624, 'recall': 0.8546716567300578, 'f1-score': 0.44138419269472595, 'support': 45958}, 'accuracy': 0.2983058311530192, 'macro avg': {'precision': 0.30913566874197074, 'recall': 0.3316706495530366, 'f1-score': 0.21189118252418973, 'support': 154412}, 'weighted avg': {'precision': 0.3107458884114426, 'recall': 0.2983058311530192, 'f1-score': 0.19230130783693808, 'support': 154412}}
[[ 6635   195 41289]
 [ 8732   148 51455]
 [ 6570   109 39279]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1206077
{'0': {'precision': 0.35018669896054094, 'recall': 0.11854331784640612, 'f1-score': 0.17712666853832215, 'support': 29272}, '1': {'precision': 0.33175355450236965, 'recall': 0.00257201646090535, 'f1-score': 0.0051044591096364895, 'support': 27216}, '2': {'precision': 0.3145969799351858, 'recall': 0.8724901518338624, 'f1-score': 0.4624475481948471, 'support': 26147}, 'accuracy': 0.3189084528347553, 'macro avg': {'precision': 0.33217907779936545, 'recall': 0.3312018287137246, 'f1-score': 0.21489289194760194, 'support': 82635}, 'weighted avg': {'precision': 0.3328545655675531, 'recall': 0.3189084528347553, 'f1-score': 0.2107507816691753, 'support': 82635}}
[[ 3470    72 25730]
 [ 3174    70 23972]
 [ 3265    69 22813]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1043587
{'0': {'precision': 0.3654229564226716, 'recall': 0.1254154447702835, 'f1-score': 0.18674041190597485, 'support': 10230}, '1': {'precision': 0.2597402597402597, 'recall': 0.0024108003857280617, 'f1-score': 0.004777260241251642, 'support': 8296}, '2': {'precision': 0.3480763039278815, 'recall': 0.8727547931382442, 'f1-score': 0.49766960124287934, 'support': 9910}, 'accuracy': 0.34997889998593334, 'macro avg': {'precision': 0.32441317336360426, 'recall': 0.3335270127647519, 'f1-score': 0.22972909113003528, 'support': 28436}, 'weighted avg': {'precision': 0.32854544278148934, 'recall': 0.34997889998593334, 'f1-score': 0.2420133743521058, 'support': 28436}}
[[1283   22 8925]
 [1002   20 7274]
 [1226   35 8649]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1068871
{'0': {'precision': 0.3929315494866839, 'recall': 0.261318108974359, 'f1-score': 0.3138866887901908, 'support': 59904}, '1': {'precision': 0.3684210526315789, 'recall': 0.005561878583546288, 'f1-score': 0.010958324518722234, 'support': 46567}, '2': {'precision': 0.3510093900601163, 'recall': 0.7730182176267848, 'f1-score': 0.48279357414167184, 'support': 54837}, 'accuracy': 0.3614389862871029, 'macro avg': {'precision': 0.3707873307261264, 'recall': 0.3466327350615634, 'f1-score': 0.2692128624835283, 'support': 161308}, 'weighted avg': {'precision': 0.37160423922602503, 'recall': 0.3614389862871029, 'f1-score': 0.2838564468492436, 'support': 161308}}
[[15654   243 44007]
 [11939   259 34369]
 [12246   201 42390]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1129478
{'0': {'precision': 0.35674413432669855, 'recall': 0.3982373386295929, 'f1-score': 0.3763505190920289, 'support': 40280}, '1': {'precision': 0.40297424737033005, 'recall': 0.027576449563145353, 'f1-score': 0.05162039725868277, 'support': 40288}, '2': {'precision': 0.3719899203600641, 'recall': 0.6673838938181467, 'f1-score': 0.4777108642231683, 'support': 41363}, 'accuracy': 0.3670682599174943, 'macro avg': {'precision': 0.3772361006856975, 'recall': 0.3643992273369616, 'f1-score': 0.30189392685795996, 'support': 121931}, 'weighted avg': {'precision': 0.37719119243333205, 'recall': 0.3670682599174943, 'f1-score': 0.3034391250022361, 'support': 121931}}
[[16041   758 23481]
 [16054  1111 23123]
 [12870   888 27605]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1113578
{'0': {'precision': 0.36473152822395594, 'recall': 0.4038876889848812, 'f1-score': 0.38331223247121243, 'support': 15742}, '1': {'precision': 0.38954703832752613, 'recall': 0.035243679465355275, 'f1-score': 0.06463922294172063, 'support': 15861}, '2': {'precision': 0.36089688660382746, 'recall': 0.6618648507071765, 'f1-score': 0.46709796672828097, 'support': 15272}, 'accuracy': 0.3632, 'macro avg': {'precision': 0.37172515105176984, 'recall': 0.36699873971913766, 'f1-score': 0.30501647404707133, 'support': 46875}, 'weighted avg': {'precision': 0.371878966281132, 'recall': 0.3632, 'f1-score': 0.30278109923231494, 'support': 46875}}
[[ 6358   413  8971]
 [ 6373   559  8929]
 [ 4701   463 10108]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
2354/2354 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0024204
{'0': {'precision': 0.3855473474393065, 'recall': 0.6275809084797849, 'f1-score': 0.4776535510766653, 'support': 145782}, '1': {'precision': 0.6540871258750253, 'recall': 0.3412980190014796, 'f1-score': 0.44854726125778027, 'support': 312923}, '2': {'precision': 0.39139354416705485, 'recall': 0.5497330818433013, 'f1-score': 0.457243421452534, 'support': 143677}, 'accuracy': 0.4602959583785704, 'macro avg': {'precision': 0.4770093391604622, 'recall': 0.5062040031081886, 'f1-score': 0.4611480779289932, 'support': 602382}, 'weighted avg': {'precision': 0.5264417252505511, 'recall': 0.4602959583785704, 'f1-score': 0.45766541444077435, 'support': 602382}}
[[ 91490  25108  29184]
 [112489 106800  93634]
 [ 33320  31373  78984]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9757449
{'0': {'precision': 0.4109285053348728, 'recall': 0.6496601721794291, 'f1-score': 0.5034258599761243, 'support': 77245}, '1': {'precision': 0.6513660552367928, 'recall': 0.4029622908709699, 'f1-score': 0.4979017376944868, 'support': 163117}, '2': {'precision': 0.4414761290322581, 'recall': 0.5376579294738827, 'f1-score': 0.48484298832331935, 'support': 79545}, 'accuracy': 0.49602228147555383, 'macro avg': {'precision': 0.5012568965346412, 'recall': 0.5300934641747604, 'f1-score': 0.4953901953313102, 'support': 319907}, 'weighted avg': {'precision': 0.5411206003948746, 'recall': 0.49602228147555383, 'f1-score': 0.4959885335661482, 'support': 319907}}
[[50183 14681 12381]
 [55661 65730 41726]
 [16277 20500 42768]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97739404
{'0': {'precision': 0.38562793821356617, 'recall': 0.6665229503847174, 'f1-score': 0.48857986799081043, 'support': 30152}, '1': {'precision': 0.6851377763096319, 'recall': 0.37492468064593876, 'f1-score': 0.4846413723943881, 'support': 66384}, '2': {'precision': 0.442255808471069, 'recall': 0.5612472160356348, 'f1-score': 0.4946967477292704, 'support': 30083}, 'accuracy': 0.48863124807493347, 'macro avg': {'precision': 0.5043405076647557, 'recall': 0.5342316156887637, 'f1-score': 0.4893059960381563, 'support': 126619}, 'weighted avg': {'precision': 0.5561094403035027, 'recall': 0.48863124807493347, 'f1-score': 0.48796827732510617, 'support': 126619}}
[[20097  4478  5577]
 [25779 24889 15716]
 [ 6239  6960 16884]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0439813
{'0': {'precision': 0.36594539559527106, 'recall': 0.61445833125861, 'f1-score': 0.4587053087421707, 'support': 240996}, '1': {'precision': 0.7281942899517982, 'recall': 0.18772881342971137, 'f1-score': 0.2985033339463681, 'support': 523079}, '2': {'precision': 0.3289353534637139, 'recall': 0.6548893978104605, 'f1-score': 0.43791595051747156, 'support': 226623}, 'accuracy': 0.39839789724012764, 'macro avg': {'precision': 0.4743583463369277, 'recall': 0.4856921808329273, 'f1-score': 0.3983748644020035, 'support': 990698}, 'weighted avg': {'precision': 0.5487432438125259, 'recall': 0.39839789724012764, 'f1-score': 0.36936462621008764, 'support': 990698}}
[[148082  15779  77135]
 [199238  98197 225644]
 [ 57336  20874 148413]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0423696
{'0': {'precision': 0.3072335180506886, 'recall': 0.6822407709011944, 'f1-score': 0.4236739338090689, 'support': 88416}, '1': {'precision': 0.7121490460416877, 'recall': 0.21581210630827294, 'f1-score': 0.3312431457771258, 'support': 228129}, '2': {'precision': 0.35375721705869995, 'recall': 0.5615247513367446, 'f1-score': 0.4340595361901461, 'support': 86965}, 'accuracy': 0.3925231097122748, 'macro avg': {'precision': 0.45771326038369214, 'recall': 0.4865258761820706, 'f1-score': 0.3963255385921136, 'support': 403510}, 'weighted avg': {'precision': 0.5461839975166012, 'recall': 0.3925231097122748, 'f1-score': 0.37365544769504755, 'support': 403510}}
[[ 60321   8443  19652]
 [109340  49233  69556]
 [ 26675  11457  48833]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0233322
{'0': {'precision': 0.30779150070206607, 'recall': 0.6624930611237896, 'f1-score': 0.42030913715515555, 'support': 32426}, '1': {'precision': 0.7387476791087778, 'recall': 0.26166475797398886, 'f1-score': 0.3864490793847493, 'support': 88193}, '2': {'precision': 0.3685184478614216, 'recall': 0.588376838963175, 'f1-score': 0.453190066745651, 'support': 32831}, 'accuracy': 0.4162658846529814, 'macro avg': {'precision': 0.47168587589075517, 'recall': 0.5041782193536511, 'f1-score': 0.41998276109518534, 'support': 153450}, 'weighted avg': {'precision': 0.5684695368337829, 'recall': 0.4162658846529814, 'f1-score': 0.4078835504783235, 'support': 153450}}
[[21482  3410  7534]
 [39549 23077 25567]
 [ 8763  4751 19317]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
2451/2451 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0799896
{'0': {'precision': 0.40910549089823933, 'recall': 0.49932617623223247, 'f1-score': 0.4497357100971456, 'support': 219642}, '1': {'precision': 0.4171128061780452, 'recall': 0.04455262665162012, 'f1-score': 0.08050622725360741, 'support': 197609}, '2': {'precision': 0.3871460932001396, 'recall': 0.623137702889238, 'f1-score': 0.47757932599353575, 'support': 210090}, 'accuracy': 0.3975381809892865, 'macro avg': {'precision': 0.4044547967588081, 'recall': 0.3890055019243635, 'f1-score': 0.3359404211147629, 'support': 627341}, 'weighted avg': {'precision': 0.40427377689059973, 'recall': 0.3975381809892865, 'f1-score': 0.34275497137361866, 'support': 627341}}
[[109673   5749 104220]
 [ 85786   8804 103019]
 [ 72621   6554 130915]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0745772
{'0': {'precision': 0.4034144478988912, 'recall': 0.5046003001890801, 'f1-score': 0.4483694828504497, 'support': 102602}, '1': {'precision': 0.45704032087819296, 'recall': 0.06322583157300418, 'f1-score': 0.11108450631958817, 'support': 102727}, '2': {'precision': 0.3964046091015169, 'recall': 0.640959877362106, 'f1-score': 0.48985569286575265, 'support': 101763}, 'accuracy': 0.4021400752868847, 'macro avg': {'precision': 0.41895312595953366, 'recall': 0.4029286697080634, 'f1-score': 0.3497698940119302, 'support': 307092}, 'weighted avg': {'precision': 0.4190302334875992, 'recall': 0.40214007528688467, 'f1-score': 0.3492900128730535, 'support': 307092}}
[[51773  3502 47327]
 [44241  6495 51991]
 [32323  4214 65226]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0724068
{'0': {'precision': 0.39644665202025026, 'recall': 0.548994708994709, 'f1-score': 0.4604137778024295, 'support': 37800}, '1': {'precision': 0.5108966376089664, 'recall': 0.08432465763983453, 'f1-score': 0.14475686404234203, 'support': 38921}, '2': {'precision': 0.3951820624478829, 'recall': 0.5921750478993697, 'f1-score': 0.4740269843739581, 'support': 36013}, 'accuracy': 0.40236308478365, 'macro avg': {'precision': 0.4341751173590332, 'recall': 0.4084981381779711, 'f1-score': 0.3597325420729099, 'support': 112734}, 'weighted avg': {'precision': 0.4355561152241529, 'recall': 0.40236308478365, 'f1-score': 0.35578313990972715, 'support': 112734}}
[[20752  1408 15640]
 [18640  3282 16999]
 [12953  1734 21326]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
3337/3337 - 49s - 49s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0644995
{'0': {'precision': 0.3979715092396124, 'recall': 0.5908399130125457, 'f1-score': 0.47559614828284497, 'support': 272683}, '1': {'precision': 0.5230312867297252, 'recall': 0.08833955664791794, 'f1-score': 0.1511500016174425, 'support': 317355}, '2': {'precision': 0.3973613895299896, 'recall': 0.5954587984832357, 'f1-score': 0.47664690631775253, 'support': 263983}, 'accuracy': 0.40553803712086706, 'macro avg': {'precision': 0.4394547284997758, 'recall': 0.4248794227145664, 'f1-score': 0.3677976854060134, 'support': 854021}, 'weighted avg': {'precision': 0.4442552475248177, 'recall': 0.40553803712086706, 'f1-score': 0.35535645322069803, 'support': 854021}}
[[161112  12063  99508]
 [150432  28035 138888]
 [ 93289  13503 157191]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0669494
{'0': {'precision': 0.3922168528178705, 'recall': 0.511361644955897, 'f1-score': 0.44393410319196713, 'support': 119833}, '1': {'precision': 0.5155243863563914, 'recall': 0.06701141995259642, 'f1-score': 0.11860565745759108, 'support': 120666}, '2': {'precision': 0.410436385733266, 'recall': 0.6345267381594974, 'f1-score': 0.4984536872289262, 'support': 125607}, 'accuracy': 0.4071634990958903, 'macro avg': {'precision': 0.4393925416358426, 'recall': 0.404299934355997, 'f1-score': 0.35366448262616146, 'support': 366106}, 'weighted avg': {'precision': 0.43910908543045607, 'recall': 0.4071634990958903, 'f1-score': 0.3554131807245563, 'support': 366106}}
[[61278  3345 55210]
 [53305  8086 59275]
 [41652  4254 79701]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0686492
{'0': {'precision': 0.41709638627886597, 'recall': 0.4635737586081914, 'f1-score': 0.43910865063782767, 'support': 44144}, '1': {'precision': 0.5026213813540005, 'recall': 0.0590314031001526, 'f1-score': 0.10565404887398179, 'support': 37353}, '2': {'precision': 0.408568703081581, 'recall': 0.6673215011516055, 'f1-score': 0.5068299333727779, 'support': 44286}, 'accuracy': 0.41517534165984277, 'macro avg': {'precision': 0.44276215690481585, 'recall': 0.39664222095331647, 'f1-score': 0.35053087762819574, 'support': 125783}, 'weighted avg': {'precision': 0.43949176691827296, 'recall': 0.41517534165984277, 'f1-score': 0.3639281809997611, 'support': 125783}}
[[20464  1012 22668]
 [15036  2205 20112]
 [13563  1170 29553]]
testing model on single stock: results/universal/W9/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
10303/10303 - 149s - 149s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1427822
{'0': {'precision': 0.3402629140512644, 'recall': 0.36385177891656284, 'f1-score': 0.35166221586727503, 'support': 804366}, '1': {'precision': 0.3932926829268293, 'recall': 0.002157156684529852, 'f1-score': 0.004290779031727894, 'support': 1016616}, '2': {'precision': 0.330815787557593, 'recall': 0.7178958920754218, 'f1-score': 0.45292009144858375, 'support': 816422}, 'accuracy': 0.33402884048101844, 'macro avg': {'precision': 0.3547904615118956, 'recall': 0.3613016092255048, 'f1-score': 0.2696243621158622, 'support': 2637404}, 'weighted avg': {'precision': 0.357779407394334, 'recall': 0.33402884048101844, 'f1-score': 0.24910902214641795, 'support': 2637404}}
[[292670   1720 509976]
 [338806   2193 675617]
 [228653   1663 586106]]
Evaluating performance on  train set...
3419/3419 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.118128
{'0': {'precision': 0.3563132940146371, 'recall': 0.3012805961913875, 'f1-score': 0.3264941577179621, 'support': 286351}, '1': {'precision': 0.3542835765057987, 'recall': 0.003268955280553686, 'f1-score': 0.006478137142231708, 'support': 289695}, '2': {'precision': 0.3612397419240208, 'recall': 0.7612969228506091, 'f1-score': 0.4899807954038075, 'support': 299108}, 'accuracy': 0.35985552257088466, 'macro avg': {'precision': 0.3572788708148189, 'recall': 0.35528215810751673, 'f1-score': 0.2743176967546671, 'support': 875154}, 'weighted avg': {'precision': 0.35732516274580556, 'recall': 0.35985552257088466, 'f1-score': 0.27643796205897136, 'support': 875154}}
[[ 86272    893 199186]
 [ 85287    947 203461]
 [ 70565    833 227710]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1215391
{'0': {'precision': 0.3660513477042317, 'recall': 0.35591609473825864, 'f1-score': 0.3609125799573561, 'support': 118896}, '1': {'precision': 0.32996632996632996, 'recall': 0.0024422255818976257, 'f1-score': 0.0048485648083250186, 'support': 120382}, '2': {'precision': 0.3525922972451001, 'recall': 0.7195138488659863, 'f1-score': 0.4732647822075543, 'support': 117988}, 'accuracy': 0.3568909440025079, 'macro avg': {'precision': 0.3495366583052206, 'recall': 0.3592907230620475, 'f1-score': 0.27967530899107845, 'support': 357266}, 'weighted avg': {'precision': 0.3494474921711104, 'recall': 0.3568909440025079, 'f1-score': 0.27804019178558975, 'support': 357266}}
[[42317   332 76247]
 [40458   294 79630]
 [32829   265 84894]]
training model: results/universal/W9/deepVOL_L3/h200
Epoch 1/50
6697/6697 - 414s - loss: 3.2575 - accuracy200: 0.3823 - val_loss: 3.2748 - val_accuracy200: 0.3570 - 414s/epoch - 62ms/step
Epoch 2/50
6697/6697 - 386s - loss: 3.2376 - accuracy200: 0.3900 - val_loss: 3.2692 - val_accuracy200: 0.3618 - 386s/epoch - 58ms/step
Epoch 3/50
6697/6697 - 386s - loss: 3.2281 - accuracy200: 0.3946 - val_loss: 3.2643 - val_accuracy200: 0.3649 - 386s/epoch - 58ms/step
Epoch 4/50
6697/6697 - 383s - loss: 3.2130 - accuracy200: 0.4051 - val_loss: 3.2639 - val_accuracy200: 0.3681 - 383s/epoch - 57ms/step
Epoch 5/50
6697/6697 - 389s - loss: 3.2037 - accuracy200: 0.4093 - val_loss: 3.2570 - val_accuracy200: 0.3725 - 389s/epoch - 58ms/step
Epoch 6/50
6697/6697 - 389s - loss: 3.1947 - accuracy200: 0.4130 - val_loss: 3.2666 - val_accuracy200: 0.3726 - 389s/epoch - 58ms/step
Epoch 7/50
6697/6697 - 399s - loss: 3.1831 - accuracy200: 0.4155 - val_loss: 3.2628 - val_accuracy200: 0.3761 - 399s/epoch - 60ms/step
Epoch 8/50
6697/6697 - 385s - loss: 3.1745 - accuracy200: 0.4193 - val_loss: 3.2683 - val_accuracy200: 0.3771 - 385s/epoch - 58ms/step
Epoch 9/50
6697/6697 - 388s - loss: 3.1701 - accuracy200: 0.4207 - val_loss: 3.2707 - val_accuracy200: 0.3767 - 388s/epoch - 58ms/step
Epoch 10/50
6697/6697 - 386s - loss: 3.1654 - accuracy200: 0.4231 - val_loss: 3.2754 - val_accuracy200: 0.3734 - 386s/epoch - 58ms/step
Epoch 11/50
6697/6697 - 392s - loss: 3.1617 - accuracy200: 0.4247 - val_loss: 3.2879 - val_accuracy200: 0.3708 - 392s/epoch - 59ms/step
Epoch 12/50
6697/6697 - 391s - loss: 3.1595 - accuracy200: 0.4253 - val_loss: 3.2851 - val_accuracy200: 0.3727 - 391s/epoch - 58ms/step
Epoch 13/50
6697/6697 - 389s - loss: 3.1564 - accuracy200: 0.4264 - val_loss: 3.2924 - val_accuracy200: 0.3703 - 389s/epoch - 58ms/step
Epoch 14/50
6697/6697 - 389s - loss: 3.1540 - accuracy200: 0.4278 - val_loss: 3.2887 - val_accuracy200: 0.3722 - 389s/epoch - 58ms/step
Epoch 15/50
6697/6697 - 397s - loss: 3.1518 - accuracy200: 0.4286 - val_loss: 3.2988 - val_accuracy200: 0.3694 - 397s/epoch - 59ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 519s - 519s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.088664
{'0': {'precision': 0.3700107252487148, 'recall': 0.18733311812671377, 'f1-score': 0.24873429113839715, 'support': 1335151}, '1': {'precision': 0.3879394711987068, 'recall': 0.5846618045794021, 'f1-score': 0.4664057038526044, 'support': 1631261}, '2': {'precision': 0.34728426471653645, 'recall': 0.30377831987856413, 'f1-score': 0.32407769376414525, 'support': 1341284}, 'accuracy': 0.3740530900973513, 'macro avg': {'precision': 0.36841148705465265, 'recall': 0.35859108086156, 'f1-score': 0.3464058962517156, 'support': 4307696}, 'weighted avg': {'precision': 0.36972375656724044, 'recall': 0.3740530900973513, 'f1-score': 0.3546228651749736, 'support': 4307696}}
[[250118 740852 344181]
 [255904 953736 421621]
 [169953 763878 407453]]
Evaluating performance on  train set...
6697/6697 - 213s - 213s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0860769
{'0': {'precision': 0.40955013861601425, 'recall': 0.18787147979203367, 'f1-score': 0.25758288023072523, 'support': 561437}, '1': {'precision': 0.3572938173659996, 'recall': 0.6012245393444389, 'f1-score': 0.4482205463309304, 'support': 584873}, '2': {'precision': 0.38020635932269425, 'recall': 0.3163054104756956, 'f1-score': 0.3453246126360366, 'support': 567695}, 'accuracy': 0.3714592431177272, 'macro avg': {'precision': 0.38235010510156936, 'recall': 0.36846714320405605, 'f1-score': 0.35037601306589744, 'support': 1714005}, 'weighted avg': {'precision': 0.3819996774654452, 'recall': 0.3714592431177272, 'f1-score': 0.3516954215960413, 'support': 1714005}}
[[105478 312336 143623]
 [ 84138 351640 149095]
 [ 67930 320200 179565]]
Evaluating performance on  val set...
2631/2631 - 84s - 84s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847694
{'0': {'precision': 0.40091366834505987, 'recall': 0.2169531285243831, 'f1-score': 0.28154765737970766, 'support': 221670}, '1': {'precision': 0.36142857512490845, 'recall': 0.5955946310098409, 'f1-score': 0.44986352986642836, 'support': 234532}, '2': {'precision': 0.37707370710633364, 'recall': 0.2896439681352866, 'f1-score': 0.32762630679074384, 'support': 216666}, 'accuracy': 0.37233751642224033, 'macro avg': {'precision': 0.37980531685876734, 'recall': 0.3673972425565035, 'f1-score': 0.3530124980122933, 'support': 672868}, 'weighted avg': {'precision': 0.3794743564371398, 'recall': 0.37233751642224033, 'f1-score': 0.35505261653863207, 'support': 672868}}
[[ 48092 123421  50157]
 [ 41330 139686  53516]
 [ 30534 123376  62756]]
testing model out of sample: results/universal/W9/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 264s - 264s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0727243
{'0': {'precision': 0.4231576978773627, 'recall': 0.23604925740306062, 'f1-score': 0.30304917006177257, 'support': 709335}, '1': {'precision': 0.40245672915262287, 'recall': 0.6043221590215677, 'f1-score': 0.48315180687855486, 'support': 835786}, '2': {'precision': 0.3826776625976014, 'recall': 0.3220318882395416, 'f1-score': 0.3497452535644121, 'support': 666139}, 'accuracy': 0.40114685744778994, 'macro avg': {'precision': 0.4027640298758623, 'recall': 0.38746776822139, 'f1-score': 0.3786487435015798, 'support': 2211260}, 'weighted avg': {'precision': 0.4031388352977473, 'recall': 0.40114685744778994, 'f1-score': 0.38518937283436194, 'support': 2211260}}
[[167438 383872 158025]
 [142674 505084 188028]
 [ 85575 366046 214518]]
Evaluating performance on  train set...
3947/3947 - 132s - 132s/epoch - 34ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0771506
{'0': {'precision': 0.39216499119079695, 'recall': 0.24199634191576175, 'f1-score': 0.29930078780017083, 'support': 312732}, '1': {'precision': 0.3981507316194519, 'recall': 0.5980160203702721, 'f1-score': 0.47803345284311005, 'support': 377020}, '2': {'precision': 0.3941594758708853, 'recall': 0.30849899632925404, 'f1-score': 0.3461078390447359, 'support': 319826}, 'accuracy': 0.396016949656193, 'macro avg': {'precision': 0.3948250662270447, 'recall': 0.38283711953842925, 'f1-score': 0.3744806932293389, 'support': 1009578}, 'weighted avg': {'precision': 0.3950321613487297, 'recall': 0.396016949656193, 'f1-score': 0.3808753678185876, 'support': 1009578}}
[[ 75680 165690  71362]
 [ 71264 225464  80292]
 [ 46036 175124  98666]]
Evaluating performance on  val set...
1402/1402 - 48s - 48s/epoch - 34ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0736529
{'0': {'precision': 0.3947206875383671, 'recall': 0.23047627581880908, 'f1-score': 0.2910242991711691, 'support': 111595}, '1': {'precision': 0.40970930607426803, 'recall': 0.6101922778610842, 'f1-score': 0.4902462329153289, 'support': 135377}, '2': {'precision': 0.3882091820557396, 'recall': 0.3190976903028669, 'f1-score': 0.35027696800193364, 'support': 111270}, 'accuracy': 0.4014939621819887, 'macro avg': {'precision': 0.39754639188945823, 'recall': 0.38658874799425336, 'f1-score': 0.37718250002947723, 'support': 358242}, 'weighted avg': {'precision': 0.3983623012980119, 'recall': 0.4014939621819887, 'f1-score': 0.3847126779354745, 'support': 358242}}
[[25720 58770 27105]
 [23921 82606 28850]
 [15519 60245 35506]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100525
{'0': {'precision': 0.42213012847078324, 'recall': 0.18223780727806205, 'f1-score': 0.2545736279116265, 'support': 27947}, '1': {'precision': 0.28354824249136407, 'recall': 0.49637630983704933, 'f1-score': 0.3609237069110193, 'support': 21663}, '2': {'precision': 0.3979358701646577, 'recall': 0.3920975003881385, 'f1-score': 0.3949951124144673, 'support': 25764}, 'accuracy': 0.3442566402207658, 'macro avg': {'precision': 0.367871413708935, 'recall': 0.35690387250108335, 'f1-score': 0.33683081574570434, 'support': 75374}, 'weighted avg': {'precision': 0.37403078032724335, 'recall': 0.3442566402207658, 'f1-score': 0.33313760074171433, 'support': 75374}}
[[ 5093 14704  8150]
 [ 3776 10753  7134]
 [ 3196 12466 10102]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021736
{'0': {'precision': 0.3623461259956553, 'recall': 0.1465042745052114, 'f1-score': 0.20864779218613183, 'support': 17078}, '1': {'precision': 0.3353502016868353, 'recall': 0.5430845062058317, 'f1-score': 0.41465460563603795, 'support': 16839}, '2': {'precision': 0.36764185442963315, 'recall': 0.3621310713455729, 'f1-score': 0.36486565591523734, 'support': 17212}, 'accuracy': 0.34970369066478907, 'macro avg': {'precision': 0.3551127273707079, 'recall': 0.350573284018872, 'f1-score': 0.3293893512458024, 'support': 51129}, 'weighted avg': {'precision': 0.3552379429365188, 'recall': 0.34970369066478907, 'f1-score': 0.32908376007496853, 'support': 51129}}
[[2502 9271 5305]
 [2278 9145 5416]
 [2125 8854 6233]]
Evaluating performance on  val set...
53/53 - 1s - 1s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943335
{'0': {'precision': 0.37287287287287285, 'recall': 0.1695108077360637, 'f1-score': 0.23306741748787732, 'support': 4395}, '1': {'precision': 0.36887138394676083, 'recall': 0.5483545326065011, 'f1-score': 0.44105228970444954, 'support': 4953}, '2': {'precision': 0.34571497936392326, 'recall': 0.34462729912875123, 'f1-score': 0.34517028239001335, 'support': 4132}, 'accuracy': 0.3623887240356083, 'macro avg': {'precision': 0.3624864120611857, 'recall': 0.3541642131571054, 'f1-score': 0.33976332986078006, 'support': 13480}, 'weighted avg': {'precision': 0.3630779329151567, 'recall': 0.3623887240356083, 'f1-score': 0.34385066005941356, 'support': 13480}}
[[ 745 2423 1227]
 [ 769 2716 1468]
 [ 484 2224 1424]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0398409
{'0': {'precision': 0.3934398296059638, 'recall': 0.35252805414896055, 'f1-score': 0.37186206156096707, 'support': 78598}, '1': {'precision': 0.4544359885713682, 'recall': 0.6793595401826953, 'f1-score': 0.5445874787980051, 'support': 126659}, '2': {'precision': 0.532918925065383, 'recall': 0.17379480840543882, 'f1-score': 0.2621104928087395, 'support': 80900}, 'accuracy': 0.44666039971064836, 'macro avg': {'precision': 0.46026491441423834, 'recall': 0.40189413424569825, 'f1-score': 0.3928533443892372, 'support': 286157}, 'weighted avg': {'precision': 0.45987039506851113, 'recall': 0.44666039971064836, 'f1-score': 0.4172858209300224, 'support': 286157}}
[[27708 46842  4048]
 [32337 86047  8275]
 [10380 56460 14060]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0314367
{'0': {'precision': 0.46731234866828086, 'recall': 0.27862851250322246, 'f1-score': 0.34910688329726414, 'support': 38790}, '1': {'precision': 0.46112276835429683, 'recall': 0.7239316868489823, 'f1-score': 0.5633857280962441, 'support': 54338}, '2': {'precision': 0.4743046867481474, 'recall': 0.27313031671700516, 'f1-score': 0.34664415958924577, 'support': 36089}, 'accuracy': 0.46435066593404895, 'macro avg': {'precision': 0.46757993459024166, 'recall': 0.42523017202307, 'f1-score': 0.4197122569942513, 'support': 129217}, 'weighted avg': {'precision': 0.46666241153820537, 'recall': 0.46435066593404895, 'f1-score': 0.43852705736714886, 'support': 129217}}
[[10808 23744  4238]
 [ 8314 39337  6687]
 [ 4006 22226  9857]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0394939
{'0': {'precision': 0.42664274117747586, 'recall': 0.3546416648909724, 'f1-score': 0.38732448995423163, 'support': 14079}, '1': {'precision': 0.4553410469041922, 'recall': 0.6889847740911571, 'f1-score': 0.5483107041364067, 'support': 20163}, '2': {'precision': 0.5084806284592037, 'recall': 0.20985925871343306, 'f1-score': 0.2970999374087211, 'support': 13571}, 'accuracy': 0.4545416518520068, 'macro avg': {'precision': 0.4634881388469572, 'recall': 0.41782856589852085, 'f1-score': 0.4109117104997864, 'support': 47813}, 'weighted avg': {'precision': 0.46197342334902153, 'recall': 0.4545416518520068, 'f1-score': 0.4296043643390239, 'support': 47813}}
[[ 4993  8080  1006]
 [ 4524 13892  1747]
 [ 2186  8537  2848]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035243
{'0': {'precision': 0.35017440016911533, 'recall': 0.153550241008528, 'f1-score': 0.21348712826626287, 'support': 43152}, '1': {'precision': 0.33193457789525854, 'recall': 0.4652649129307151, 'f1-score': 0.38745010316832834, 'support': 43184}, '2': {'precision': 0.35981113734203585, 'recall': 0.4167221928635434, 'f1-score': 0.3861811987650378, 'support': 43523}, 'accuracy': 0.3454131019028331, 'macro avg': {'precision': 0.3473067051354699, 'recall': 0.3451791156009288, 'f1-score': 0.32903947673320966, 'support': 129859}, 'weighted avg': {'precision': 0.34733864159175665, 'recall': 0.3454131019028331, 'f1-score': 0.3292171210930132, 'support': 129859}}
[[ 6626 20663 15863]
 [ 6685 20092 16407]
 [ 5611 19775 18137]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1052486
{'0': {'precision': 0.3416184971098266, 'recall': 0.1837523318823843, 'f1-score': 0.23896719038817008, 'support': 22514}, '1': {'precision': 0.34181173436492585, 'recall': 0.483118421652162, 'f1-score': 0.4003624898521721, 'support': 21947}, '2': {'precision': 0.37716641426888775, 'recall': 0.3995365625417762, 'f1-score': 0.3880293423928332, 'support': 22441}, 'accuracy': 0.35433918268512155, 'macro avg': {'precision': 0.3535322152478801, 'recall': 0.3554691053587742, 'f1-score': 0.34245300754439184, 'support': 66902}, 'weighted avg': {'precision': 0.35360575888083723, 'recall': 0.35433918268512155, 'f1-score': 0.3419124893399667, 'support': 66902}}
[[ 4137 10335  8042]
 [ 4580 10603  6764]
 [ 3393 10082  8966]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017966
{'0': {'precision': 0.38505050505050503, 'recall': 0.14481081902446435, 'f1-score': 0.21046819787985863, 'support': 6581}, '1': {'precision': 0.33220851757039793, 'recall': 0.47670729671063616, 'f1-score': 0.39155180689844343, 'support': 5989}, '2': {'precision': 0.36189848384970336, 'recall': 0.4511834319526627, 'f1-score': 0.40163874460457966, 'support': 6084}, 'accuracy': 0.35129194810764447, 'macro avg': {'precision': 0.35971916882353544, 'recall': 0.35756718256258774, 'f1-score': 0.3345529164609606, 'support': 18654}, 'weighted avg': {'precision': 0.36053417825710743, 'recall': 0.35129194810764447, 'f1-score': 0.3309566368573169, 'support': 18654}}
[[ 953 3061 2567]
 [ 861 2855 2273]
 [ 661 2678 2745]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970066
{'0': {'precision': 0.2657370517928287, 'recall': 0.05650626906133514, 'f1-score': 0.09319547296353221, 'support': 47216}, '1': {'precision': 0.3883579144834724, 'recall': 0.7952216169677302, 'f1-score': 0.521858650832025, 'support': 60397}, '2': {'precision': 0.3045893719806763, 'recall': 0.1347251009636958, 'f1-score': 0.18681758248270344, 'support': 46799}, 'accuracy': 0.36915524700152835, 'macro avg': {'precision': 0.3195614460856591, 'recall': 0.3288176623309204, 'f1-score': 0.2672905687594202, 'support': 154412}, 'weighted avg': {'precision': 0.3254745202305013, 'recall': 0.36915524700152835, 'f1-score': 0.28923846869644837, 'support': 154412}}
[[ 2668 38314  6234]
 [ 4207 48029  8161]
 [ 3165 37329  6305]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105031
{'0': {'precision': 0.3385176184690158, 'recall': 0.04786119223501117, 'f1-score': 0.08386514148103551, 'support': 29105}, '1': {'precision': 0.32608319640231775, 'recall': 0.835321050105232, 'f1-score': 0.46906003462539264, 'support': 27083}, '2': {'precision': 0.28779260555677094, 'recall': 0.0994819828335917, 'f1-score': 0.14785467419708334, 'support': 26447}, 'accuracy': 0.3224662673201428, 'macro avg': {'precision': 0.31746447347603485, 'recall': 0.32755474172461163, 'f1-score': 0.2335932834345038, 'support': 82635}, 'weighted avg': {'precision': 0.3182079933788903, 'recall': 0.3224662673201428, 'f1-score': 0.23058946486422593, 'support': 82635}}
[[ 1393 24322  3390]
 [ 1339 22623  3121]
 [ 1383 22433  2631]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093824
{'0': {'precision': 0.3452461227242077, 'recall': 0.05077350257834193, 'f1-score': 0.08852770813521224, 'support': 10084}, '1': {'precision': 0.2936429512516469, 'recall': 0.8428267549042779, 'f1-score': 0.43554198473282446, 'support': 8462}, '2': {'precision': 0.3227016885553471, 'recall': 0.08695652173913043, 'f1-score': 0.13699721226602946, 'support': 9890}, 'accuracy': 0.2990575327050218, 'macro avg': {'precision': 0.3205302541770672, 'recall': 0.3268522597405834, 'f1-score': 0.22035563504468872, 'support': 28436}, 'weighted avg': {'precision': 0.3220491016617924, 'recall': 0.2990575327050218, 'f1-score': 0.20865002507229122, 'support': 28436}}
[[ 512 8641  931]
 [ 456 7132  874]
 [ 515 8515  860]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1179794
{'0': {'precision': 0.41213124330639667, 'recall': 0.13144738067881875, 'f1-score': 0.19932193812685411, 'support': 64406}, '1': {'precision': 0.2333911267018803, 'recall': 0.4477823620422898, 'f1-score': 0.3068482015850437, 'support': 38780}, '2': {'precision': 0.3611199011497371, 'recall': 0.4123223564226971, 'f1-score': 0.38502630839056917, 'support': 58122}, 'accuracy': 0.3087013663302502, 'macro avg': {'precision': 0.33554742371933804, 'recall': 0.33051736638126855, 'f1-score': 0.29706548270082234, 'support': 161308}, 'weighted avg': {'precision': 0.3507801450920953, 'recall': 0.3087013663302502, 'f1-score': 0.29208471433991384, 'support': 161308}}
[[ 8466 30057 25883]
 [ 4900 17365 16515]
 [ 7176 26981 23965]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039035
{'0': {'precision': 0.3367330506200011, 'recall': 0.15617686600607478, 'f1-score': 0.21338549196360232, 'support': 40166}, '1': {'precision': 0.32347891404657153, 'recall': 0.44999253619943275, 'f1-score': 0.376389062304907, 'support': 40194}, '2': {'precision': 0.3561661180045581, 'recall': 0.40600418561016094, 'f1-score': 0.37945570431322295, 'support': 41571}, 'accuracy': 0.3382076748324872, 'macro avg': {'precision': 0.3387926942237103, 'recall': 0.3373911959385561, 'f1-score': 0.3230767528605774, 'support': 121931}, 'weighted avg': {'precision': 0.33898937000400514, 'recall': 0.3382076748324872, 'f1-score': 0.32373864500822985, 'support': 121931}}
[[ 6273 18511 15382]
 [ 6979 18087 15128]
 [ 5377 19316 16878]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000048
{'0': {'precision': 0.32624593716143013, 'recall': 0.1546510881427746, 'f1-score': 0.20983406646052, 'support': 15577}, '1': {'precision': 0.3499952709732337, 'recall': 0.45205228438797945, 'f1-score': 0.394530625299856, 'support': 16372}, '2': {'precision': 0.3404197328972472, 'recall': 0.41839742730805307, 'f1-score': 0.37540200174325994, 'support': 14926}, 'accuracy': 0.3425066666666667, 'macro avg': {'precision': 0.3388869803439703, 'recall': 0.3417002666129357, 'f1-score': 0.3265888978345453, 'support': 46875}, 'weighted avg': {'precision': 0.33905409008558274, 'recall': 0.3425066666666667, 'f1-score': 0.3270632731452727, 'support': 46875}}
[[2409 7135 6033]
 [2904 7401 6067]
 [2071 6610 6245]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
2354/2354 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0613215
{'0': {'precision': 0.45079600260042635, 'recall': 0.31437940196533254, 'f1-score': 0.37042742581699145, 'support': 189688}, '1': {'precision': 0.40110004685083833, 'recall': 0.6591821475303312, 'f1-score': 0.4987313597432751, 'support': 224686}, '2': {'precision': 0.46242029373555865, 'recall': 0.24802136079315773, 'f1-score': 0.32286989305757025, 'support': 188008}, 'accuracy': 0.42227855414006393, 'macro avg': {'precision': 0.43810544772894106, 'recall': 0.4071943034296071, 'f1-score': 0.3973428928726122, 'support': 602382}, 'weighted avg': {'precision': 0.4358876458005586, 'recall': 0.42227855414006393, 'f1-score': 0.40344119628013225, 'support': 602382}}
[[ 59634 105712  24342]
 [ 46710 148109  29867]
 [ 25942 115436  46630]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.046603
{'0': {'precision': 0.5123662441062706, 'recall': 0.35633639648130694, 'f1-score': 0.4203388652761532, 'support': 101856}, '1': {'precision': 0.3929297653922848, 'recall': 0.6980991786142287, 'f1-score': 0.5028353243611069, 'support': 114319}, '2': {'precision': 0.5223000609172396, 'recall': 0.23143292330235607, 'f1-score': 0.3207433732364258, 'support': 103732}, 'accuracy': 0.4379647835152091, 'macro avg': {'precision': 0.4758653568052649, 'recall': 0.4286228327992972, 'f1-score': 0.4146391876245619, 'support': 319907}, 'weighted avg': {'precision': 0.47290663826873436, 'recall': 0.4379647835152091, 'f1-score': 0.41752452587710237, 'support': 319907}}
[[36295 56890  8671]
 [21227 79806 13286]
 [13316 66409 24007]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0412064
{'0': {'precision': 0.4927796586747737, 'recall': 0.35558657825198187, 'f1-score': 0.41309006660874603, 'support': 40114}, '1': {'precision': 0.40829150542166365, 'recall': 0.6798519841776189, 'f1-score': 0.5101860053144376, 'support': 47022}, '2': {'precision': 0.5070706028075971, 'recall': 0.24884127345946358, 'f1-score': 0.3338486892403881, 'support': 39483}, 'accuracy': 0.44272186638656125, 'macro avg': {'precision': 0.46938058896801144, 'recall': 0.4280932786296881, 'f1-score': 0.4190415870545239, 'support': 126619}, 'weighted avg': {'precision': 0.46585990259494775, 'recall': 0.44272186638656125, 'f1-score': 0.4244387419827748, 'support': 126619}}
[[14264 21557  4293]
 [ 9796 31968  5258]
 [ 4886 24772  9825]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
3870/3870 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0547416
{'0': {'precision': 0.4821927131804481, 'recall': 0.2245599622224091, 'f1-score': 0.3064188682243073, 'support': 309178}, '1': {'precision': 0.42827732027598486, 'recall': 0.6888470674872981, 'f1-score': 0.5281731906938627, 'support': 391081}, '2': {'precision': 0.40753449828197635, 'recall': 0.3054582890038872, 'f1-score': 0.34918948066541894, 'support': 290439}, 'accuracy': 0.4315553276578735, 'macro avg': {'precision': 0.4393348439128031, 'recall': 0.40628843957119815, 'f1-score': 0.39459384652786295, 'support': 990698}, 'weighted avg': {'precision': 0.4390221979988614, 'recall': 0.4315553276578735, 'f1-score': 0.4064959412500934, 'support': 990698}}
[[ 69429 184930  54819]
 [ 47530 269395  74156]
 [ 27027 174695  88717]]
Evaluating performance on  train set...
1577/1577 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0450947
{'0': {'precision': 0.4206726430419349, 'recall': 0.30556769513154447, 'f1-score': 0.3539984304989494, 'support': 114410}, '1': {'precision': 0.4663376873956786, 'recall': 0.6921704444078256, 'f1-score': 0.5572428116258271, 'support': 175987}, '2': {'precision': 0.43118274120250705, 'recall': 0.225641615022146, 'f1-score': 0.2962520167608789, 'support': 113113}, 'accuracy': 0.451775668508835, 'macro avg': {'precision': 0.4393976905467069, 'recall': 0.4077932515205054, 'f1-score': 0.40249775296188517, 'support': 403510}, 'weighted avg': {'precision': 0.4435352310668143, 'recall': 0.451775668508835, 'f1-score': 0.4264538809319534, 'support': 403510}}
[[ 34960  67277  12173]
 [ 32677 121813  21497]
 [ 15468  72122  25523]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0372056
{'0': {'precision': 0.4234228254737331, 'recall': 0.3026112942627422, 'f1-score': 0.3529655859245325, 'support': 42163}, '1': {'precision': 0.4815765316698088, 'recall': 0.7182034976152624, 'f1-score': 0.5765556034813848, 'support': 67932}, '2': {'precision': 0.4576479142052168, 'recall': 0.2322915465344251, 'f1-score': 0.30816541974572, 'support': 43355}, 'accuracy': 0.46672531769305964, 'macro avg': {'precision': 0.4542157571162529, 'recall': 0.4177021128041432, 'f1-score': 0.41256220305054575, 'support': 153450}, 'weighted avg': {'precision': 0.45883713822228506, 'recall': 0.46672531769305964, 'f1-score': 0.4392908115223799, 'support': 153450}}
[[12759 24701  4703]
 [11911 48789  7232]
 [ 5463 27821 10071]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
2451/2451 - 37s - 37s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973257
{'0': {'precision': 0.39207040625833406, 'recall': 0.21224764792223105, 'f1-score': 0.2754047176733222, 'support': 207795}, '1': {'precision': 0.3521327804582984, 'recall': 0.5724052691793442, 'f1-score': 0.43602890992772525, 'support': 217643}, '2': {'precision': 0.3621728008741867, 'recall': 0.28891596459686086, 'f1-score': 0.3214231596811831, 'support': 201903}, 'accuracy': 0.36187177308672636, 'macro avg': {'precision': 0.3687919958636064, 'recall': 0.3578562938994787, 'f1-score': 0.3442855957607435, 'support': 627341}, 'weighted avg': {'precision': 0.3685926470940634, 'recall': 0.36187177308672636, 'f1-score': 0.3459405069355228, 'support': 627341}}
[[ 44104 115284  48407]
 [ 38739 124580  54324]
 [ 29647 113923  58333]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914531
{'0': {'precision': 0.41869556802786917, 'recall': 0.20806524519845734, 'f1-score': 0.2779880113333376, 'support': 103977}, '1': {'precision': 0.3370634545167825, 'recall': 0.5521959459459459, 'f1-score': 0.4186069284482174, 'support': 100640}, '2': {'precision': 0.3998542209656757, 'recall': 0.35331544279092464, 'f1-score': 0.3751470032068718, 'support': 102475}, 'accuracy': 0.3693127792322822, 'macro avg': {'precision': 0.3852044145034424, 'recall': 0.371192211311776, 'f1-score': 0.3572473143294756, 'support': 307092}, 'weighted avg': {'precision': 0.38565588303459664, 'recall': 0.3693127792322822, 'f1-score': 0.35649300498566955, 'support': 307092}}
[[21634 56069 26274]
 [16999 55573 28068]
 [13037 53232 36206]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904578
{'0': {'precision': 0.4135042305436877, 'recall': 0.2566555740432612, 'f1-score': 0.31672495107318166, 'support': 38464}, '1': {'precision': 0.34393073301950233, 'recall': 0.5416346739389446, 'f1-score': 0.4207138376744234, 'support': 37769}, '2': {'precision': 0.39676650782845474, 'recall': 0.3193611133941536, 'f1-score': 0.35388048147417317, 'support': 36501}, 'accuracy': 0.3724342256994341, 'macro avg': {'precision': 0.38473382379721494, 'recall': 0.3725504537921198, 'f1-score': 0.36377309007392605, 'support': 112734}, 'weighted avg': {'precision': 0.3847758518396616, 'recall': 0.3724342256994341, 'f1-score': 0.36359430968024686, 'support': 112734}}
[[ 9872 20007  8585]
 [ 8174 20457  9138]
 [ 5828 19016 11657]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
3337/3337 - 49s - 49s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.077866
{'0': {'precision': 0.3884873373716355, 'recall': 0.2934646252437163, 'f1-score': 0.3343557820010289, 'support': 264652}, '1': {'precision': 0.41363036179954105, 'recall': 0.5501468872222776, 'f1-score': 0.47222002020819726, 'support': 341078}, '2': {'precision': 0.36749262919487363, 'recall': 0.2966881602635617, 'f1-score': 0.3283163674611806, 'support': 248291}, 'accuracy': 0.39691529833575523, 'macro avg': {'precision': 0.38987010945535006, 'recall': 0.38009989090985186, 'f1-score': 0.3782973898901356, 'support': 854021}, 'weighted avg': {'precision': 0.3924251040048972, 'recall': 0.39691529833575523, 'f1-score': 0.3876600056251682, 'support': 854021}}
[[ 77666 134017  52969]
 [ 79616 187643  73819]
 [ 42637 131989  73665]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947733
{'0': {'precision': 0.3852740199739951, 'recall': 0.23491953712762728, 'f1-score': 0.2918714436911211, 'support': 118564}, '1': {'precision': 0.34528675638284495, 'recall': 0.539839250161815, 'f1-score': 0.4211814866545, 'support': 122053}, '2': {'precision': 0.399949508680623, 'recall': 0.32823594099881265, 'f1-score': 0.3605614569519032, 'support': 125489}, 'accuracy': 0.36855992526754544, 'macro avg': {'precision': 0.37683676167915436, 'recall': 0.36766490942941826, 'f1-score': 0.3578714624325081, 'support': 366106}, 'weighted avg': {'precision': 0.37697327352137044, 'recall': 0.36855992526754544, 'f1-score': 0.358525690679402, 'support': 366106}}
[[27853 60338 30373]
 [24739 65889 31425]
 [19702 64597 41190]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013585
{'0': {'precision': 0.3834130509053639, 'recall': 0.20937988292637422, 'f1-score': 0.2708499886869296, 'support': 42879}, '1': {'precision': 0.32876951389770276, 'recall': 0.5163838429144552, 'f1-score': 0.4017525663270747, 'support': 40131}, '2': {'precision': 0.3841362654124825, 'recall': 0.3532602342599303, 'f1-score': 0.3680518341696302, 'support': 42773}, 'accuracy': 0.3562564098487077, 'macro avg': {'precision': 0.3654396100718497, 'recall': 0.3596746533669199, 'f1-score': 0.3468847963945448, 'support': 125783}, 'weighted avg': {'precision': 0.3662249910758046, 'recall': 0.3562564098487077, 'f1-score': 0.3456682541131654, 'support': 125783}}
[[ 8978 21497 12404]
 [ 7587 20723 11821]
 [ 6851 20812 15110]]
testing model on single stock: results/universal/W9/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
10303/10303 - 155s - 155s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976858
{'0': {'precision': 0.3297890550556605, 'recall': 0.14238643894099184, 'f1-score': 0.19889845935724537, 'support': 811854}, '1': {'precision': 0.3845216609988125, 'recall': 0.5458998918029776, 'f1-score': 0.45121554311171613, 'support': 1001876}, '2': {'precision': 0.3265933094824166, 'recall': 0.3427958148490786, 'f1-score': 0.33449847205118316, 'support': 823674}, 'accuracy': 0.358258727142296, 'macro avg': {'precision': 0.3469680085122966, 'recall': 0.34369404853101604, 'f1-score': 0.3282041581733816, 'support': 2637404}, 'weighted avg': {'precision': 0.3495823941772381, 'recall': 0.358258727142296, 'f1-score': 0.33709519958333917, 'support': 2637404}}
[[115597 434878 261379]
 [134146 546924 320806]
 [100775 440547 282352]]
Evaluating performance on  train set...
3419/3419 - 51s - 51s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1050265
{'0': {'precision': 0.33059643399933275, 'recall': 0.1239933404933457, 'f1-score': 0.18034614286039274, 'support': 287709}, '1': {'precision': 0.33501742273607427, 'recall': 0.5355519891297189, 'f1-score': 0.4121882636673105, 'support': 288493}, '2': {'precision': 0.3491882496316166, 'recall': 0.3574988626936766, 'f1-score': 0.353294689918829, 'support': 298952}, 'accuracy': 0.3394282606261298, 'macro avg': {'precision': 0.33826736878900787, 'recall': 0.3390147307722471, 'f1-score': 0.31527636548217736, 'support': 875154}, 'weighted avg': {'precision': 0.33840475661515956, 'recall': 0.3394282606261298, 'f1-score': 0.3158516001835196, 'support': 875154}}
[[ 35674 150910 101125]
 [ 35923 154503  98067]
 [ 36311 155766 106875]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023843
{'0': {'precision': 0.3465108027861291, 'recall': 0.15602586417106004, 'f1-score': 0.2151669758812616, 'support': 118929}, '1': {'precision': 0.3429106551135077, 'recall': 0.550249347732752, 'f1-score': 0.4225141379048005, 'support': 121116}, '2': {'precision': 0.34527782603527574, 'recall': 0.3221436432038628, 'f1-score': 0.33330979575264363, 'support': 117221}, 'accuracy': 0.34417492848465847, 'macro avg': {'precision': 0.3448997613116375, 'recall': 0.34280628503589156, 'f1-score': 0.3236636365129019, 'support': 357266}, 'weighted avg': {'precision': 0.344885777585777, 'recall': 0.34417492848465847, 'f1-score': 0.32422263290931974, 'support': 357266}}
[[18556 65150 35223]
 [18090 66644 36382]
 [16905 62554 37762]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        57 (peak)  15.85 (ave)

============================================
