This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W2/deepLOB_L1/h300
Epoch 1/50
9940/9940 - 233s - loss: 3.2243 - accuracy300: 0.4093 - val_loss: 3.3656 - val_accuracy300: 0.3489 - 233s/epoch - 23ms/step
Epoch 2/50
9940/9940 - 218s - loss: 3.2017 - accuracy300: 0.4216 - val_loss: 3.3820 - val_accuracy300: 0.3583 - 218s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 217s - loss: 3.1911 - accuracy300: 0.4280 - val_loss: 3.4173 - val_accuracy300: 0.3504 - 217s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 219s - loss: 3.1843 - accuracy300: 0.4302 - val_loss: 3.4027 - val_accuracy300: 0.3530 - 219s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 219s - loss: 3.1776 - accuracy300: 0.4336 - val_loss: 3.4228 - val_accuracy300: 0.3347 - 219s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 218s - loss: 3.1735 - accuracy300: 0.4358 - val_loss: 3.4305 - val_accuracy300: 0.3386 - 218s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 218s - loss: 3.1685 - accuracy300: 0.4375 - val_loss: 3.4620 - val_accuracy300: 0.3345 - 218s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 218s - loss: 3.1664 - accuracy300: 0.4383 - val_loss: 3.4707 - val_accuracy300: 0.3375 - 218s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 217s - loss: 3.1632 - accuracy300: 0.4394 - val_loss: 3.4936 - val_accuracy300: 0.3412 - 217s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 218s - loss: 3.1601 - accuracy300: 0.4405 - val_loss: 3.5050 - val_accuracy300: 0.3361 - 218s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 216s - loss: 3.1584 - accuracy300: 0.4411 - val_loss: 3.5773 - val_accuracy300: 0.3337 - 216s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 315s - 315s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1255549
{'0': {'precision': 0.3311959892898082, 'recall': 0.4206495487479344, 'f1-score': 0.3706012376039127, 'support': 2202760}, '1': {'precision': 0.34777435136752805, 'recall': 0.467694464032925, 'f1-score': 0.39891688264586894, 'support': 2285924}, '2': {'precision': 0.34759100011779953, 'recall': 0.1321947864888658, 'f1-score': 0.1915426397726701, 'support': 2232085}, 'accuracy': 0.34084998308973274, 'macro avg': {'precision': 0.3421871135917119, 'recall': 0.3401795997565751, 'f1-score': 0.32035358667415054, 'support': 6720769}, 'weighted avg': {'precision': 0.3422798300672768, 'recall': 0.34084998308973274, 'f1-score': 0.32076369702436586, 'support': 6720769}}
[[ 926590  984487  291683]
 [ 954663 1069114  262147]
 [ 916456 1020559  295070]]
Evaluating performance on  train set...
9940/9940 - 122s - 122s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1222403
{'0': {'precision': 0.33724103339360467, 'recall': 0.45350818543190047, 'f1-score': 0.3868269875363918, 'support': 848031}, '1': {'precision': 0.3418532169850995, 'recall': 0.38645546498645833, 'f1-score': 0.36278860103511035, 'support': 839261}, '2': {'precision': 0.37367234000418076, 'recall': 0.1983121032496742, 'f1-score': 0.2591110599124044, 'support': 856332}, 'accuracy': 0.3454704783411385, 'macro avg': {'precision': 0.350922196794295, 'recall': 0.3460919178893443, 'f1-score': 0.3362422161613022, 'support': 2543624}, 'weighted avg': {'precision': 0.3510277092016759, 'recall': 0.3454704783411385, 'f1-score': 0.33589897458024875, 'support': 2543624}}
[[384589 307612 155830]
 [386110 324337 128814]
 [369699 316812 169821]]
Evaluating performance on  val set...
3393/3393 - 41s - 41s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.122553
{'0': {'precision': 0.3465695366738877, 'recall': 0.5007893938205638, 'f1-score': 0.4096454098532129, 'support': 293263}, '1': {'precision': 0.34083799948890636, 'recall': 0.37859581042722146, 'f1-score': 0.3587260894951239, 'support': 278310}, '2': {'precision': 0.3759394602911587, 'recall': 0.17139494256594967, 'f1-score': 0.2354470023025356, 'support': 296514}, 'accuracy': 0.34910210612530773, 'macro avg': {'precision': 0.35444899881798425, 'recall': 0.3502600489379117, 'f1-score': 0.3346061672169575, 'support': 868087}, 'weighted avg': {'precision': 0.3547639335690138, 'recall': 0.34910210612530773, 'f1-score': 0.3338193432661758, 'support': 868087}}
[[146863 100519  45881]
 [134461 105367  38482]
 [142438 103255  50821]]
testing model out of sample: results/universal/W2/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 174s - 174s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1328892
{'0': {'precision': 0.3432356584835537, 'recall': 0.4241110084916081, 'f1-score': 0.3794113600403586, 'support': 1248409}, '1': {'precision': 0.301863263584493, 'recall': 0.41141108386253483, 'f1-score': 0.34822475501630573, 'support': 1118509}, '2': {'precision': 0.36570269981858927, 'recall': 0.1687378588491439, 'f1-score': 0.23092517789655387, 'support': 1299815}, 'accuracy': 0.3297101261531723, 'macro avg': {'precision': 0.336933873962212, 'recall': 0.3347533170677623, 'f1-score': 0.3195204309844061, 'support': 3666733}, 'weighted avg': {'precision': 0.3385796339752914, 'recall': 0.3297101261531723, 'f1-score': 0.3172614665951315, 'support': 3666733}}
[[529464 514137 204808]
 [482734 460167 175608]
 [530369 550118 219328]]
Evaluating performance on  train set...
5373/5373 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1278138
{'0': {'precision': 0.3419625672052952, 'recall': 0.44857481673134975, 'f1-score': 0.3880798024989811, 'support': 463800}, '1': {'precision': 0.32802023912171563, 'recall': 0.44895133491720246, 'f1-score': 0.37907467700015957, 'support': 449953}, '2': {'precision': 0.35070822657940504, 'recall': 0.11457933508117943, 'f1-score': 0.17272722814920635, 'support': 461139}, 'accuracy': 0.3366758989069687, 'macro avg': {'precision': 0.3402303443021386, 'recall': 0.3373684955765772, 'f1-score': 0.31329390254944905, 'support': 1374892}, 'weighted avg': {'precision': 0.34033303722761465, 'recall': 0.3366758989069687, 'f1-score': 0.31290345845402917, 'support': 1374892}}
[[208049 205967  49784]
 [199909 202007  48037]
 [200439 207863  52837]]
Evaluating performance on  val set...
1685/1685 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.124374
{'0': {'precision': 0.34306956447075343, 'recall': 0.4664853579473655, 'f1-score': 0.3953701574810025, 'support': 145608}, '1': {'precision': 0.32580521494332454, 'recall': 0.4066503835111625, 'f1-score': 0.361766135411339, 'support': 140022}, '2': {'precision': 0.3717625526624767, 'recall': 0.14844665683043531, 'f1-score': 0.2121719764680377, 'support': 145042}, 'accuracy': 0.3399222610246313, 'macro avg': {'precision': 0.34687911069218486, 'recall': 0.3405274660963211, 'f1-score': 0.3231027564534597, 'support': 430672}, 'weighted avg': {'precision': 0.34711974568470344, 'recall': 0.3399222610246313, 'f1-score': 0.3227470639232118, 'support': 430672}}
[[67924 58793 18891]
 [65588 56940 17494]
 [64477 59034 21531]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1150641
{'0': {'precision': 0.3183482326056695, 'recall': 0.4937106918238994, 'f1-score': 0.3870948805126826, 'support': 80136}, '1': {'precision': 0.3396611450525918, 'recall': 0.30624900620130385, 'f1-score': 0.32209089117308026, 'support': 88046}, '2': {'precision': 0.40240830619893103, 'recall': 0.23306014493613084, 'f1-score': 0.2951691401790542, 'support': 84313}, 'accuracy': 0.34130576843105803, 'macro avg': {'precision': 0.3534725612857308, 'recall': 0.34433994765377807, 'f1-score': 0.33478497062160567, 'support': 252495}, 'weighted avg': {'precision': 0.3538494253982808, 'recall': 0.34130576843105803, 'f1-score': 0.3337319379191903, 'support': 252495}}
[[39564 24888 15684]
 [47585 26964 13497]
 [37130 27533 19650]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.125238
{'0': {'precision': 0.3350218340611354, 'recall': 0.38342745764406017, 'f1-score': 0.3575939779533432, 'support': 20009}, '1': {'precision': 0.33131082786985383, 'recall': 0.4046352016710598, 'f1-score': 0.3643202579258463, 'support': 20107}, '2': {'precision': 0.32632624980889774, 'recall': 0.20902903589090732, 'f1-score': 0.25482763766602, 'support': 20423}, 'accuracy': 0.3316374568460001, 'macro avg': {'precision': 0.33088630391329565, 'recall': 0.33236389840200914, 'f1-score': 0.3255806245150698, 'support': 60539}, 'weighted avg': {'precision': 0.3308558068939944, 'recall': 0.3316374568460001, 'f1-score': 0.32515948686031426, 'support': 60539}}
[[7672 8036 4301]
 [7459 8136 4512]
 [7769 8385 4269]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1103907
{'0': {'precision': 0.37227773507558287, 'recall': 0.40143666252244786, 'f1-score': 0.38630774343635754, 'support': 7239}, '1': {'precision': 0.32973046928444383, 'recall': 0.326602520666757, 'f1-score': 0.3281590413943355, 'support': 7379}, '2': {'precision': 0.3295296838858905, 'recall': 0.3060727585219135, 'f1-score': 0.31736838197074335, 'support': 6982}, 'accuracy': 0.3450462962962963, 'macro avg': {'precision': 0.34384596274863904, 'recall': 0.3447039805703727, 'f1-score': 0.3439450556004788, 'support': 21600}, 'weighted avg': {'precision': 0.34392481064598807, 'recall': 0.3450462962962963, 'f1-score': 0.34415895204186686, 'support': 21600}}
[[2906 2367 1966]
 [2587 2410 2382]
 [2313 2532 2137]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1278162
{'0': {'precision': 0.31784208108898077, 'recall': 0.46328004544347967, 'f1-score': 0.37702143818258366, 'support': 98584}, '1': {'precision': 0.3598826938025581, 'recall': 0.4634741220047142, 'f1-score': 0.4051616804101976, 'support': 109881}, '2': {'precision': 0.3879429360331339, 'recall': 0.11565478259278907, 'f1-score': 0.17818768539199176, 'support': 109334}, 'accuracy': 0.34375186831928356, 'macro avg': {'precision': 0.3552225703082243, 'recall': 0.347469650013661, 'f1-score': 0.3201236013282576, 'support': 317799}, 'weighted avg': {'precision': 0.35649503921674275, 'recall': 0.34375186831928356, 'f1-score': 0.3183453203490029, 'support': 317799}}
[[45672 42030 10882]
 [49886 50927  9068]
 [48136 48553 12645]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1249669
{'0': {'precision': 0.34284467854776945, 'recall': 0.47237310774710595, 'f1-score': 0.3973186282311747, 'support': 44920}, '1': {'precision': 0.33705747745322384, 'recall': 0.45117117117117117, 'f1-score': 0.3858540719624008, 'support': 44400}, '2': {'precision': 0.37752924729600473, 'recall': 0.1125367372899943, 'f1-score': 0.1733885274985216, 'support': 45594}, 'accuracy': 0.34378937693641876, 'macro avg': {'precision': 0.3524771344323327, 'recall': 0.34536033873609046, 'f1-score': 0.31885374256403237, 'support': 134914}, 'weighted avg': {'precision': 0.35266172124837286, 'recall': 0.34378937693641876, 'f1-score': 0.3178687912154599, 'support': 134914}}
[[21219 19515  4186]
 [20094 20032  4274]
 [20578 19885  5131]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073465
{'0': {'precision': 0.38726663475347056, 'recall': 0.38237677245104656, 'f1-score': 0.3848061699452995, 'support': 14810}, '1': {'precision': 0.35103887399463807, 'recall': 0.4597995464189041, 'f1-score': 0.3981249802046052, 'support': 13669}, '2': {'precision': 0.3389935547843332, 'recall': 0.22573456586332122, 'f1-score': 0.27100673801030517, 'support': 12116}, 'accuracy': 0.3616947899987683, 'macro avg': {'precision': 0.35909968784414725, 'recall': 0.3559702949110906, 'f1-score': 0.3513126293867366, 'support': 40595}, 'weighted avg': {'precision': 0.3606605527552307, 'recall': 0.3616947899987683, 'f1-score': 0.35532620689837396, 'support': 40595}}
[[5663 6359 2788]
 [4839 6285 2545]
 [4121 5260 2735]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1504543
{'0': {'precision': 0.3368570158452694, 'recall': 0.49687149223707755, 'f1-score': 0.4015087561742255, 'support': 89979}, '1': {'precision': 0.29531580299108995, 'recall': 0.3799598383365954, 'f1-score': 0.33233286644878723, 'support': 78682}, '2': {'precision': 0.35416563167569176, 'recall': 0.13508033954827953, 'f1-score': 0.19556957684658116, 'support': 105552}, 'accuracy': 0.3240619518403577, 'macro avg': {'precision': 0.32877948350401703, 'recall': 0.33730389004065087, 'f1-score': 0.30980373315653126, 'support': 274213}, 'weighted avg': {'precision': 0.33159983733199755, 'recall': 0.3240619518403577, 'f1-score': 0.3023880375658136, 'support': 274213}}
[[44708 31637 13634]
 [36420 29896 12366]
 [51593 39701 14258]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1278495
{'0': {'precision': 0.3378346710410686, 'recall': 0.4661304664133861, 'f1-score': 0.39174592391304347, 'support': 24742}, '1': {'precision': 0.3304389773275446, 'recall': 0.45028759244042726, 'f1-score': 0.3811643597412534, 'support': 24340}, '2': {'precision': 0.35706806282722514, 'recall': 0.085413709610086, 'f1-score': 0.13785204150384045, 'support': 23954}, 'accuracy': 0.3359849937017361, 'macro avg': {'precision': 0.34178057039861276, 'recall': 0.33394392282129975, 'f1-score': 0.3035874417193791, 'support': 73036}, 'weighted avg': {'precision': 0.34167805624642517, 'recall': 0.3359849937017361, 'f1-score': 0.3049486002483929, 'support': 73036}}
[[11533 11386  1823]
 [11519 10960  1861]
 [11086 10822  2046]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.116615
{'0': {'precision': 0.3324950884086444, 'recall': 0.4368611254517295, 'f1-score': 0.377599286033021, 'support': 9685}, '1': {'precision': 0.30782076259393265, 'recall': 0.3431585479367049, 'f1-score': 0.3245305164319249, 'support': 9669}, '2': {'precision': 0.3770023790642347, 'recall': 0.22735533237685318, 'f1-score': 0.2836515513126492, 'support': 10455}, 'accuracy': 0.3329866818746016, 'macro avg': {'precision': 0.3391060766889373, 'recall': 0.3357916685884292, 'f1-score': 0.3285937845925317, 'support': 29809}, 'weighted avg': {'precision': 0.34010177321865975, 'recall': 0.3329866818746016, 'f1-score': 0.3274350571164359, 'support': 29809}}
[[4231 3568 1886]
 [4309 3318 2042]
 [4185 3893 2377]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1560416
{'0': {'precision': 0.33841861000306844, 'recall': 0.48443462266999754, 'f1-score': 0.39847128292556255, 'support': 72854}, '1': {'precision': 0.28120550302707464, 'recall': 0.46022431974784983, 'f1-score': 0.3491027939923442, 'support': 59647}, '2': {'precision': 0.4270111437600488, 'recall': 0.08808023512459545, 'f1-score': 0.14603716344330678, 'support': 87443}, 'accuracy': 0.3202906194304005, 'macro avg': {'precision': 0.348878418930064, 'recall': 0.3442463925141476, 'f1-score': 0.2978704134537378, 'support': 219944}, 'weighted avg': {'precision': 0.35812456578051416, 'recall': 0.3202906194304005, 'f1-score': 0.28472287892596915, 'support': 219944}}
[[35293 31548  6013]
 [27874 27451  4322]
 [41121 38620  7702]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1250174
{'0': {'precision': 0.343014980004067, 'recall': 0.3686127399206031, 'f1-score': 0.35535347506276005, 'support': 27457}, '1': {'precision': 0.3174868478737396, 'recall': 0.4301678051678052, 'f1-score': 0.36533610795812843, 'support': 26936}, '2': {'precision': 0.3195790816326531, 'recall': 0.183627102495511, 'f1-score': 0.23323791570667224, 'support': 27289}, 'accuracy': 0.32711001199774736, 'macro avg': {'precision': 0.32669363650348654, 'recall': 0.3274692158613064, 'f1-score': 0.3179758329091869, 'support': 81682}, 'weighted avg': {'precision': 0.32676699393957287, 'recall': 0.32711001199774736, 'f1-score': 0.3178480356807831, 'support': 81682}}
[[10121 12199  5137]
 [ 9817 11587  5532]
 [ 9568 12710  5011]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.132606
{'0': {'precision': 0.3456622773044152, 'recall': 0.41271676300578036, 'f1-score': 0.37622510275055326, 'support': 8650}, '1': {'precision': 0.30955455132343446, 'recall': 0.49097657749904006, 'f1-score': 0.379707993071022, 'support': 7813}, '2': {'precision': 0.2815707273538599, 'recall': 0.07425276535655448, 'f1-score': 0.11751559735543347, 'support': 8498}, 'accuracy': 0.3219822923761067, 'macro avg': {'precision': 0.31226251866056987, 'recall': 0.32598203528712494, 'f1-score': 0.29114956439233625, 'support': 24961}, 'weighted avg': {'precision': 0.3125402207133643, 'recall': 0.3219822923761067, 'f1-score': 0.2892373396491588, 'support': 24961}}
[[3570 4229  851]
 [3218 3836  759]
 [3540 4327  631]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228191
{'0': {'precision': 0.29683514815579776, 'recall': 0.4151233634940787, 'f1-score': 0.3461527689868987, 'support': 148869}, '1': {'precision': 0.3632744429201735, 'recall': 0.43827826641243994, 'f1-score': 0.3972671821109903, 'support': 178843}, '2': {'precision': 0.3620940598562722, 'recall': 0.14723778875141025, 'f1-score': 0.20934849779764644, 'support': 162207}, 'accuracy': 0.33488188863873414, 'macro avg': {'precision': 0.3407345503107478, 'recall': 0.3335464728859763, 'f1-score': 0.31758948296517847, 'support': 489919}, 'weighted avg': {'precision': 0.34269508639812785, 'recall': 0.33488188863873414, 'f1-score': 0.3195174365534901, 'support': 489919}}
[[61799 65945 21125]
 [79510 78383 20950]
 [66884 71440 23883]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279142
{'0': {'precision': 0.3427325160730159, 'recall': 0.5361901681759379, 'f1-score': 0.41817058252304745, 'support': 61840}, '1': {'precision': 0.34472305286549065, 'recall': 0.413985668396343, 'f1-score': 0.3761928641463396, 'support': 60705}, '2': {'precision': 0.3863044287309267, 'recall': 0.08573127622319865, 'f1-score': 0.1403214686439647, 'support': 60538}, 'accuracy': 0.3467225247565312, 'macro avg': {'precision': 0.3579199992231444, 'recall': 0.34530237093182653, 'f1-score': 0.3115616384377839, 'support': 183083}, 'weighted avg': {'precision': 0.35779995534630604, 'recall': 0.3467225247565312, 'f1-score': 0.3123787446677034, 'support': 183083}}
[[33158 24283  4399]
 [31728 25131  3846]
 [31860 23488  5190]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1259176
{'0': {'precision': 0.33783783783783783, 'recall': 0.421518014059754, 'f1-score': 0.3750671944485168, 'support': 18208}, '1': {'precision': 0.34778167606697163, 'recall': 0.43707093821510296, 'f1-score': 0.3873472819904041, 'support': 17917}, '2': {'precision': 0.3647945641787876, 'recall': 0.1854390415025096, 'f1-score': 0.24588521540002864, 'support': 18529}, 'accuracy': 0.3465803051926666, 'macro avg': {'precision': 0.3501380260278657, 'recall': 0.34800933125912215, 'f1-score': 0.33609989727964984, 'support': 54654}, 'weighted avg': {'precision': 0.35023665461104464, 'recall': 0.3465803051926666, 'f1-score': 0.3352971764937204, 'support': 54654}}
[[7675 7128 3405]
 [7508 7831 2578]
 [7535 7558 3436]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
4918/4918 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1358192
{'0': {'precision': 0.340484277551914, 'recall': 0.5337082936129647, 'f1-score': 0.41574199728586253, 'support': 419600}, '1': {'precision': 0.3279485128638035, 'recall': 0.45329195561209856, 'f1-score': 0.38056508523200855, 'support': 407949}, '2': {'precision': 0.3481260738831615, 'recall': 0.03006561710218183, 'f1-score': 0.05535090003372193, 'support': 431290}, 'accuracy': 0.33509527429639535, 'macro avg': {'precision': 0.338852954766293, 'recall': 0.33902195544241503, 'f1-score': 0.28388599418386434, 'support': 1258839}, 'weighted avg': {'precision': 0.3390399925170158, 'recall': 0.33509527429639535, 'f1-score': 0.28086894169310334, 'support': 1258839}}
[[223944 183769  11887]
 [210635 184920  12394]
 [223143 195180  12967]]
Evaluating performance on  train set...
1403/1403 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1129625
{'0': {'precision': 0.35730562672447774, 'recall': 0.4802486713796129, 'f1-score': 0.40975385810643783, 'support': 120802}, '1': {'precision': 0.3291154303847679, 'recall': 0.3524579021596914, 'f1-score': 0.34038695067117397, 'support': 117702}, '2': {'precision': 0.3844703948300785, 'recall': 0.225181778943524, 'f1-score': 0.2840167924706079, 'support': 120476}, 'accuracy': 0.3527466711237395, 'macro avg': {'precision': 0.35696381731310806, 'recall': 0.3526294508276095, 'f1-score': 0.34471920041607323, 'support': 358980}, 'weighted avg': {'precision': 0.35717932473749747, 'recall': 0.3527466711237395, 'f1-score': 0.34481173749111754, 'support': 358980}}
[[58015 41204 21583]
 [54367 41485 21850]
 [49986 43361 27129]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1110178
{'0': {'precision': 0.38409086697919176, 'recall': 0.47996017504457156, 'f1-score': 0.4267070133185122, 'support': 43189}, '1': {'precision': 0.3012931349389962, 'recall': 0.34407764830213866, 'f1-score': 0.32126720332381203, 'support': 35957}, '2': {'precision': 0.4052736138703269, 'recall': 0.2575107296137339, 'f1-score': 0.3149208487706298, 'support': 43571}, 'accuracy': 0.3611643048640368, 'macro avg': {'precision': 0.3635525385961716, 'recall': 0.3605161843201481, 'f1-score': 0.35429835513765134, 'support': 122717}, 'weighted avg': {'precision': 0.36735150253762566, 'recall': 0.3611643048640368, 'f1-score': 0.3561223818208777, 'support': 122717}}
[[20729 13801  8659]
 [15779 12372  7806]
 [17461 14890 11220]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
4856/4856 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1219012
{'0': {'precision': 0.3661988449764341, 'recall': 0.37681530896508, 'f1-score': 0.37143123096767333, 'support': 444759}, '1': {'precision': 0.2767120831839369, 'recall': 0.3490588673313201, 'f1-score': 0.30870338820791937, 'support': 362595}, '2': {'precision': 0.35509186960128836, 'recall': 0.26729131605713224, 'f1-score': 0.3049985132439184, 'support': 435551}, 'accuracy': 0.33033739505432835, 'macro avg': {'precision': 0.3326675992538865, 'recall': 0.3310551641178441, 'f1-score': 0.32837771080650374, 'support': 1242905}, 'weighted avg': {'precision': 0.33620048900894617, 'recall': 0.33033739505432835, 'f1-score': 0.32985151346490993, 'support': 1242905}}
[[167592 164004 113163]
 [137754 126567  98274]
 [152307 166825 116419]]
Evaluating performance on  train set...
2076/2076 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1301504
{'0': {'precision': 0.33838738535370005, 'recall': 0.45470478202009873, 'f1-score': 0.38801634570445914, 'support': 178021}, '1': {'precision': 0.3308392349207144, 'recall': 0.45264112937739304, 'f1-score': 0.3822723625524983, 'support': 175247}, '2': {'precision': 0.3581728018310128, 'recall': 0.10541590416633921, 'f1-score': 0.16289055045712403, 'support': 178142}, 'accuracy': 0.3369338175796466, 'macro avg': {'precision': 0.3424664740351424, 'recall': 0.3375872718546103, 'f1-score': 0.31105975290469384, 'support': 531410}, 'weighted avg': {'precision': 0.3425307453641854, 'recall': 0.3369338175796466, 'f1-score': 0.3106542801949986, 'support': 531410}}
[[80947 79828 17246]
 [79518 79324 16405]
 [78749 80614 18779]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1247178
{'0': {'precision': 0.34855648884685986, 'recall': 0.49200086371042145, 'f1-score': 0.40803900660149284, 'support': 50943}, '1': {'precision': 0.3296526015725339, 'recall': 0.428472547382993, 'f1-score': 0.3726220931776536, 'support': 49121}, '2': {'precision': 0.3619126133553174, 'recall': 0.1048441666998368, 'f1-score': 0.16258757445757846, 'support': 50246}, 'accuracy': 0.3418202381744395, 'macro avg': {'precision': 0.34670723459157043, 'recall': 0.34177252593108376, 'f1-score': 0.31441622474557496, 'support': 150310}, 'weighted avg': {'precision': 0.34684345568372893, 'recall': 0.3418202381744395, 'f1-score': 0.31441471770657214, 'support': 150310}}
[[25064 21397  4482]
 [23268 21047  4806]
 [23576 21402  5268]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
4353/4353 - 53s - 53s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139326
{'0': {'precision': 0.378473893730056, 'recall': 0.32278652171561467, 'f1-score': 0.3484191294033041, 'support': 406758}, '1': {'precision': 0.31584851764543087, 'recall': 0.5545663586272723, 'f1-score': 0.40247235446736696, 'support': 345735}, '2': {'precision': 0.3243335952799711, 'recall': 0.14373609364419077, 'f1-score': 0.19919445811699316, 'support': 361795}, 'accuracy': 0.33656648909438136, 'macro avg': {'precision': 0.33955200221848597, 'recall': 0.34036299132902587, 'f1-score': 0.3166953139958881, 'support': 1114288}, 'weighted avg': {'precision': 0.3414641855770773, 'recall': 0.33656648909438136, 'f1-score': 0.31673912550798516, 'support': 1114288}}
[[131296 213980  61482]
 [107149 191733  46853]
 [108464 201328  52003]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1150885
{'0': {'precision': 0.35070182375327436, 'recall': 0.4203394348676026, 'f1-score': 0.38237592283235433, 'support': 135048}, '1': {'precision': 0.33354174482097454, 'recall': 0.36767419955124325, 'f1-score': 0.3497772548619636, 'support': 130583}, '2': {'precision': 0.35272047142068436, 'recall': 0.24280240747060466, 'f1-score': 0.2876174288536188, 'support': 128932}, 'accuracy': 0.3448954919746656, 'macro avg': {'precision': 0.3456546799983111, 'recall': 0.3436053472964835, 'f1-score': 0.3399235355159789, 'support': 394563}, 'weighted avg': {'precision': 0.34568222914819985, 'recall': 0.3448954919746656, 'f1-score': 0.34062280861423483, 'support': 394563}}
[[56766 48600 29682]
 [54805 48012 27766]
 [50293 47334 31305]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1357515
{'0': {'precision': 0.34340142219743447, 'recall': 0.45561336570701816, 'f1-score': 0.39162799018097616, 'support': 43245}, '1': {'precision': 0.3037808379154299, 'recall': 0.502481689158372, 'f1-score': 0.378646665184077, 'support': 37273}, '2': {'precision': 0.358093903293623, 'recall': 0.0358244531688166, 'f1-score': 0.0651328787202855, 'support': 42792}, 'accuracy': 0.3241018571081015, 'macro avg': {'precision': 0.3350920544688291, 'recall': 0.3313065026780689, 'f1-score': 0.27846917802844623, 'support': 123310}, 'weighted avg': {'precision': 0.3365239800850749, 'recall': 0.3241018571081015, 'f1-score': 0.2744012305002098, 'support': 123310}}
[[19703 21997  1545]
 [17341 18729  1203]
 [20332 20927  1533]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
5497/5497 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1460012
{'0': {'precision': 0.3487628196136663, 'recall': 0.44632179686629553, 'f1-score': 0.391556936466146, 'support': 484666}, '1': {'precision': 0.2961910684963378, 'recall': 0.4839780378853788, 'f1-score': 0.36748435947396757, 'support': 410343}, '2': {'precision': 0.3827593017165134, 'recall': 0.08702791140822191, 'f1-score': 0.14181204455904647, 'support': 512192}, 'accuracy': 0.32652691406558126, 'macro avg': {'precision': 0.34257106327550585, 'recall': 0.3391092487199654, 'f1-score': 0.3002844468330534, 'support': 1407201}, 'weighted avg': {'precision': 0.34580679278628595, 'recall': 0.32652691406558126, 'f1-score': 0.2936353537381756, 'support': 1407201}}
[[216317 227319  41030]
 [180894 198597  30852]
 [223030 244587  44575]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1255255
{'0': {'precision': 0.34644427809488165, 'recall': 0.41324753889769406, 'f1-score': 0.3769087466406059, 'support': 179188}, '1': {'precision': 0.3198620009857072, 'recall': 0.466978071882704, 'f1-score': 0.3796668360937155, 'support': 169554}, '2': {'precision': 0.3429652457815885, 'recall': 0.12623398209813458, 'f1-score': 0.1845436485133072, 'support': 178082}, 'accuracy': 0.33352125187918547, 'macro avg': {'precision': 0.33642384162072575, 'recall': 0.3354865309595109, 'f1-score': 0.3137064104158762, 'support': 526824}, 'weighted avg': {'precision': 0.3367129741956955, 'recall': 0.33352125187918547, 'f1-score': 0.3127713567237208, 'support': 526824}}
[[74049 83297 21842]
 [69152 79178 21224]
 [70539 85063 22480]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1269333
{'0': {'precision': 0.3391983654828436, 'recall': 0.4740732030974418, 'f1-score': 0.39545180680687697, 'support': 59533}, '1': {'precision': 0.31516835426721856, 'recall': 0.39341390160183065, 'f1-score': 0.3499709762323174, 'support': 55936}, '2': {'precision': 0.3927883033237742, 'recall': 0.14201937786843447, 'f1-score': 0.20861162781987738, 'support': 58830}, 'accuracy': 0.336112083259227, 'macro avg': {'precision': 0.3490516743579455, 'recall': 0.3365021608559023, 'f1-score': 0.3180114702863573, 'support': 174299}, 'weighted avg': {'precision': 0.34957451988318294, 'recall': 0.336112083259227, 'f1-score': 0.3177931658001945, 'support': 174299}}
[[28223 24278  7032]
 [28046 22006  5884]
 [26936 23539  8355]]
testing model on single stock: results/universal/W2/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
14883/14883 - 177s - 177s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1236272
{'0': {'precision': 0.31738346832660796, 'recall': 0.40672418429098295, 'f1-score': 0.3565423781835245, 'support': 1204964}, '1': {'precision': 0.36921693444398285, 'recall': 0.45133968145873815, 'f1-score': 0.4061688135870807, 'support': 1362712}, '2': {'precision': 0.3495139481544698, 'recall': 0.1687989998575135, 'f1-score': 0.2276524447672541, 'support': 1242223}, 'accuracy': 0.34510626134708555, 'macro avg': {'precision': 0.34537145030835353, 'recall': 0.3422876218690782, 'f1-score': 0.3301212121792864, 'support': 3809899}, 'weighted avg': {'precision': 0.3463992788042469, 'recall': 0.34510626134708555, 'f1-score': 0.3322678499830371, 'support': 3809899}}
[[490088 513549 201327]
 [558743 615046 188923]
 [495320 537217 209686]]
Evaluating performance on  train set...
6147/6147 - 73s - 73s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1260173
{'0': {'precision': 0.3291428272205135, 'recall': 0.4595097382859693, 'f1-score': 0.3835512391890112, 'support': 519804}, '1': {'precision': 0.34912071407114964, 'recall': 0.39140366407512894, 'f1-score': 0.36905503917112364, 'support': 519640}, '2': {'precision': 0.3794217674250251, 'recall': 0.1884330978333124, 'f1-score': 0.2518094794829737, 'support': 534041}, 'accuracy': 0.34501441068710537, 'macro avg': {'precision': 0.3525617695722294, 'recall': 0.34644883339813687, 'f1-score': 0.3348052526143695, 'support': 1573485}, 'weighted avg': {'precision': 0.35280515932334394, 'recall': 0.34501441068710537, 'f1-score': 0.3340507314164763, 'support': 1573485}}
[[238855 185742  95207]
 [246867 203389  69384]
 [239966 193444 100631]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1235211
{'0': {'precision': 0.3382596020393218, 'recall': 0.5289879968806068, 'f1-score': 0.41265094197149305, 'support': 183369}, '1': {'precision': 0.36224382896070584, 'recall': 0.3484188280918093, 'f1-score': 0.35519685498446646, 'support': 183598}, '2': {'precision': 0.37157947848117573, 'recall': 0.18261869714092763, 'f1-score': 0.24488482001358386, 'support': 189537}, 'accuracy': 0.3514476086425255, 'macro avg': {'precision': 0.35736096982706783, 'recall': 0.3533418407044479, 'f1-score': 0.3375775389898478, 'support': 556504}, 'weighted avg': {'precision': 0.35752056964327783, 'recall': 0.3514476086425255, 'f1-score': 0.3365574315561495, 'support': 556504}}
[[97000 54240 32129]
 [93220 63969 26409]
 [96542 58382 34613]]
training model: results/universal/W2/deepLOB_L1/h500
Epoch 1/50
9940/9940 - 221s - loss: 3.2159 - accuracy500: 0.4166 - val_loss: 3.3704 - val_accuracy500: 0.3529 - 221s/epoch - 22ms/step
Epoch 2/50
9940/9940 - 218s - loss: 3.1901 - accuracy500: 0.4302 - val_loss: 3.3946 - val_accuracy500: 0.3480 - 218s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 217s - loss: 3.1801 - accuracy500: 0.4352 - val_loss: 3.3916 - val_accuracy500: 0.3505 - 217s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 217s - loss: 3.1669 - accuracy500: 0.4399 - val_loss: 3.4442 - val_accuracy500: 0.3499 - 217s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 216s - loss: 3.1599 - accuracy500: 0.4428 - val_loss: 3.4791 - val_accuracy500: 0.3577 - 216s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 216s - loss: 3.1520 - accuracy500: 0.4451 - val_loss: 3.4949 - val_accuracy500: 0.3573 - 216s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 216s - loss: 3.1458 - accuracy500: 0.4469 - val_loss: 3.5504 - val_accuracy500: 0.3436 - 216s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 215s - loss: 3.1404 - accuracy500: 0.4492 - val_loss: 3.5423 - val_accuracy500: 0.3397 - 215s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 216s - loss: 3.1364 - accuracy500: 0.4508 - val_loss: 3.5198 - val_accuracy500: 0.3468 - 216s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 216s - loss: 3.1329 - accuracy500: 0.4520 - val_loss: 3.5227 - val_accuracy500: 0.3530 - 216s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 217s - loss: 3.1287 - accuracy500: 0.4537 - val_loss: 3.5487 - val_accuracy500: 0.3424 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 312s - 312s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1181011
{'0': {'precision': 0.3473690286258921, 'recall': 0.21451436525414008, 'f1-score': 0.2652352694393396, 'support': 2188301}, '1': {'precision': 0.3583226458276631, 'recall': 0.7371881968528885, 'f1-score': 0.48224301372118333, 'support': 2332361}, '2': {'precision': 0.33196139181423795, 'recall': 0.08614990089118393, 'f1-score': 0.13679822336032887, 'support': 2200107}, 'accuracy': 0.3538806347904533, 'macro avg': {'precision': 0.3458843554225977, 'recall': 0.34595082099940416, 'f1-score': 0.2947588355069506, 'support': 6720769}, 'weighted avg': {'precision': 0.34612651306964576, 'recall': 0.3538806347904533, 'f1-score': 0.29850008709981735, 'support': 6720769}}
[[ 469422 1523920  194959]
 [ 426503 1719389  186469]
 [ 455439 1555129  189539]]
Evaluating performance on  train set...
9940/9940 - 121s - 121s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1249433
{'0': {'precision': 0.3454528402163379, 'recall': 0.2840507435445934, 'f1-score': 0.31175719616016706, 'support': 855833}, '1': {'precision': 0.3386286687821778, 'recall': 0.6232126133258667, 'f1-score': 0.4388201287353235, 'support': 828584}, '2': {'precision': 0.34635520012191134, 'recall': 0.12697289477390197, 'f1-score': 0.18582341869714442, 'support': 859207}, 'accuracy': 0.3414734253175784, 'macro avg': {'precision': 0.3434789030401424, 'recall': 0.3447454172147874, 'f1-score': 0.312133581197545, 'support': 2543624}, 'weighted avg': {'precision': 0.34353467726606923, 'recall': 0.3414734253175784, 'f1-score': 0.3106088856363562, 'support': 2543624}}
[[243100 500800 111933]
 [218246 516384  93954]
 [242368 507743 109096]]
Evaluating performance on  val set...
3393/3393 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1258944
{'0': {'precision': 0.3538820343063497, 'recall': 0.32018896308548944, 'f1-score': 0.3361934338001694, 'support': 293814}, '1': {'precision': 0.34729006096515536, 'recall': 0.6297834802948631, 'f1-score': 0.4476992447966528, 'support': 276603}, '2': {'precision': 0.3748472414032926, 'recall': 0.12674438136191085, 'f1-score': 0.18943610523223847, 'support': 297670}, 'accuracy': 0.35250383890093967, 'macro avg': {'precision': 0.35867311222493253, 'recall': 0.3589056082474211, 'f1-score': 0.32444292794302027, 'support': 868087}, 'weighted avg': {'precision': 0.35897064131745876, 'recall': 0.35250383890093967, 'f1-score': 0.3213995108918023, 'support': 868087}}
[[ 94076 163031  36707]
 [ 76189 174200  26214]
 [ 95575 164367  37728]]
testing model out of sample: results/universal/W2/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 174s - 174s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.129657
{'0': {'precision': 0.35232310435296543, 'recall': 0.28868167218169605, 'f1-score': 0.31734310456377846, 'support': 1236923}, '1': {'precision': 0.3202697513679562, 'recall': 0.6531967684347484, 'f1-score': 0.42980248907450536, 'support': 1123666}, '2': {'precision': 0.36424619640387274, 'recall': 0.10081200847686013, 'f1-score': 0.1579173972382595, 'support': 1306144}, 'accuracy': 0.3334649673155913, 'macro avg': {'precision': 0.34561301737493144, 'recall': 0.34756348303110157, 'f1-score': 0.3016876636255144, 'support': 3666733}, 'weighted avg': {'precision': 0.34674757218536195, 'recall': 0.3334649673155913, 'f1-score': 0.29501637820727744, 'support': 3666733}}
[[357077 753884 125962]
 [285828 733975 103863]
 [370588 803881 131675]]
Evaluating performance on  train set...
5373/5373 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1195823
{'0': {'precision': 0.34958726529976036, 'recall': 0.23463078354834, 'f1-score': 0.28079904117146104, 'support': 458823}, '1': {'precision': 0.3491628691242564, 'recall': 0.7206561887491402, 'f1-score': 0.4704092354009628, 'support': 463769}, '2': {'precision': 0.33409264861318655, 'recall': 0.08106566438204732, 'f1-score': 0.1304728421771806, 'support': 452300}, 'accuracy': 0.34805497449981526, 'macro avg': {'precision': 0.34428092767906776, 'recall': 0.34545087889317583, 'f1-score': 0.29389370624986816, 'support': 1374892}, 'weighted avg': {'precision': 0.3443468268382269, 'recall': 0.34805497449981526, 'f1-score': 0.2953040280086153, 'support': 1374892}}
[[107654 313050  38119]
 [ 94588 334218  34963]
 [105704 309930  36666]]
Evaluating performance on  val set...
1685/1685 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137254
{'0': {'precision': 0.33425399320008403, 'recall': 0.3041579055426941, 'f1-score': 0.3184965527466825, 'support': 141249}, '1': {'precision': 0.3657018435638859, 'recall': 0.63074483879853, 'f1-score': 0.4629741951072779, 'support': 148851}, '2': {'precision': 0.3527196652719665, 'recall': 0.11394160999345532, 'f1-score': 0.17224247507823337, 'support': 140572}, 'accuracy': 0.3549476167477802, 'macro avg': {'precision': 0.3508918340119789, 'recall': 0.3496147847782265, 'f1-score': 0.31790440764406463, 'support': 430672}, 'weighted avg': {'precision': 0.3511503793802651, 'recall': 0.3549476167477802, 'f1-score': 0.32069407972082464, 'support': 430672}}
[[42962 82212 16075]
 [41646 93887 13318]
 [43923 80632 16017]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096064
{'0': {'precision': 0.3327752632551266, 'recall': 0.3738035329822832, 'f1-score': 0.35209822246655675, 'support': 77102}, '1': {'precision': 0.4205005094636737, 'recall': 0.5682470140301465, 'f1-score': 0.4833350339155239, 'support': 95865}, '2': {'precision': 0.36690607886843335, 'recall': 0.16765164470375213, 'f1-score': 0.23014318140626752, 'support': 79528}, 'accuracy': 0.38269668706311016, 'macro avg': {'precision': 0.3733939505290778, 'recall': 0.3699007305720606, 'f1-score': 0.35519214592944937, 'support': 252495}, 'weighted avg': {'precision': 0.3768321207448884, 'recall': 0.38269668706311016, 'f1-score': 0.36351300859742086, 'support': 252495}}
[[28821 37591 10690]
 [29074 54475 12316]
 [28713 37482 13333]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1221784
{'0': {'precision': 0.34004751064040384, 'recall': 0.34141614906832296, 'f1-score': 0.3407304554808956, 'support': 20125}, '1': {'precision': 0.33634535138542826, 'recall': 0.5534479351906738, 'f1-score': 0.41841097936700594, 'support': 20244}, '2': {'precision': 0.3380803189974366, 'recall': 0.11769955379276152, 'f1-score': 0.17461017946454838, 'support': 20170}, 'accuracy': 0.3377822560663374, 'macro avg': {'precision': 0.33815772700775626, 'recall': 0.3375212126839194, 'f1-score': 0.31125053810415, 'support': 60539}, 'weighted avg': {'precision': 0.338154106927155, 'recall': 0.3377822560663374, 'f1-score': 0.311359612855492, 'support': 60539}}
[[ 6871 10895  2359]
 [ 6751 11204  2289]
 [ 6584 11212  2374]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113376
{'0': {'precision': 0.3069574013712487, 'recall': 0.3878159613746095, 'f1-score': 0.34268147311625574, 'support': 7042}, '1': {'precision': 0.3653824553521285, 'recall': 0.40115920582069303, 'f1-score': 0.38243592758053135, 'support': 8109}, '2': {'precision': 0.2939473684210526, 'recall': 0.17320514808497442, 'f1-score': 0.21797248512049955, 'support': 6449}, 'accuracy': 0.32875, 'macro avg': {'precision': 0.3220957417148099, 'recall': 0.3207267717600923, 'f1-score': 0.3143632952724289, 'support': 21600}, 'weighted avg': {'precision': 0.3250068023080607, 'recall': 0.32875, 'f1-score': 0.32037224198968994, 'support': 21600}}
[[2731 3052 1259]
 [3432 3253 1424]
 [2734 2598 1117]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0748205
{'0': {'precision': 0.3322775413243591, 'recall': 0.24472983973852716, 'f1-score': 0.2818620076825659, 'support': 82303}, '1': {'precision': 0.4827961174907549, 'recall': 0.8039130036565518, 'f1-score': 0.6032848770352042, 'support': 141937}, '2': {'precision': 0.3871586928355487, 'recall': 0.08623435479216324, 'f1-score': 0.1410514169828144, 'support': 93559}, 'accuracy': 0.4478144991016334, 'macro avg': {'precision': 0.4007441172168876, 'recall': 0.3782923993957474, 'f1-score': 0.3420661005668615, 'support': 317799}, 'weighted avg': {'precision': 0.4156597445394891, 'recall': 0.4478144991016334, 'f1-score': 0.3839633351002965, 'support': 317799}}
[[ 20142  56306   5855]
 [ 20916 114105   6916]
 [ 19560  65931   8068]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200619
{'0': {'precision': 0.36070766378244745, 'recall': 0.3057629338572364, 'f1-score': 0.33097044020698946, 'support': 45810}, '1': {'precision': 0.34738021070316055, 'recall': 0.6757063429025304, 'f1-score': 0.45886051564980196, 'support': 44065}, '2': {'precision': 0.35779728035490405, 'recall': 0.08237305446390905, 'f1-score': 0.13391568004620272, 'support': 45039}, 'accuracy': 0.3520168403575611, 'macro avg': {'precision': 0.35529505161350405, 'recall': 0.3546141104078919, 'f1-score': 0.307915545300998, 'support': 134914}, 'weighted avg': {'precision': 0.35538312385974186, 'recall': 0.3520168403575611, 'f1-score': 0.3069575640896544, 'support': 134914}}
[[14007 28162  3641]
 [11272 29775  3018]
 [13553 27776  3710]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0814087
{'0': {'precision': 0.39124169401969416, 'recall': 0.35472163751179503, 'f1-score': 0.37208771128369117, 'support': 13777}, '1': {'precision': 0.4475574712643678, 'recall': 0.5835154542616298, 'f1-score': 0.5065727063287708, 'support': 16015}, '2': {'precision': 0.32004429678848284, 'recall': 0.21401462556697215, 'f1-score': 0.2565041326898541, 'support': 10803}, 'accuracy': 0.40753787412242887, 'macro avg': {'precision': 0.38628115402418156, 'recall': 0.38408390578013235, 'f1-score': 0.37838818343410535, 'support': 40595}, 'weighted avg': {'precision': 0.3945118428135031, 'recall': 0.40753787412242887, 'f1-score': 0.39438424524348253, 'support': 40595}}
[[4887 6451 2439]
 [4197 9345 2473]
 [3407 5084 2312]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1543312
{'0': {'precision': 0.3362354959299597, 'recall': 0.2367155812787677, 'f1-score': 0.2778323805703206, 'support': 87772}, '1': {'precision': 0.28295449209885176, 'recall': 0.6890650607920112, 'f1-score': 0.4011731116305216, 'support': 78711}, '2': {'precision': 0.30864554703698344, 'recall': 0.059417061171447134, 'f1-score': 0.09965049934225377, 'support': 107730}, 'accuracy': 0.2969042313821737, 'macro avg': {'precision': 0.30927851168859827, 'recall': 0.32839923441407537, 'f1-score': 0.259551997181032, 'support': 274213}, 'weighted avg': {'precision': 0.310102284569482, 'recall': 0.2969042313821737, 'f1-score': 0.24323423320961868, 'support': 274213}}
[[20777 58799  8196]
 [18332 54237  6142]
 [22684 78645  6401]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1222835
{'0': {'precision': 0.3476505834121728, 'recall': 0.22620757581975623, 'f1-score': 0.2740788623141564, 'support': 24367}, '1': {'precision': 0.34934046206681235, 'recall': 0.7137218944346994, 'f1-score': 0.4690824293874128, 'support': 25084}, '2': {'precision': 0.34400809034215407, 'recall': 0.08653805384778461, 'f1-score': 0.13828850193102513, 'support': 23585}, 'accuracy': 0.34854044580754695, 'macro avg': {'precision': 0.34699971194037976, 'recall': 0.34215584136741345, 'f1-score': 0.29381659787753145, 'support': 73036}, 'weighted avg': {'precision': 0.34705472270124377, 'recall': 0.34854044580754695, 'f1-score': 0.29720244283375513, 'support': 73036}}
[[ 5512 16990  1865]
 [ 5154 17903  2027]
 [ 5189 16355  2041]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1140474
{'0': {'precision': 0.340311004784689, 'recall': 0.41377519218782466, 'f1-score': 0.3734646038443507, 'support': 9626}, '1': {'precision': 0.3309373842163764, 'recall': 0.45955958016052684, 'f1-score': 0.38478438805841547, 'support': 9718}, '2': {'precision': 0.3683297180043384, 'recall': 0.16225513616817966, 'f1-score': 0.22527363184079605, 'support': 10465}, 'accuracy': 0.3404005501694119, 'macro avg': {'precision': 0.3465260356684679, 'recall': 0.34519663617217705, 'f1-score': 0.32784087458118744, 'support': 29809}, 'weighted avg': {'precision': 0.34709160759460445, 'recall': 0.3404005501694119, 'f1-score': 0.32512977681141036, 'support': 29809}}
[[3983 4320 1323]
 [3663 4466 1589]
 [4058 4709 1698]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1531938
{'0': {'precision': 0.3537511981857714, 'recall': 0.2123321311797477, 'f1-score': 0.2653769928267008, 'support': 71261}, '1': {'precision': 0.2796690959722031, 'recall': 0.7345039450493337, 'f1-score': 0.4050946850116511, 'support': 60709}, '2': {'precision': 0.45236617970556714, 'recall': 0.09116329824720941, 'f1-score': 0.1517459296330284, 'support': 87974}, 'accuracy': 0.30799658094787763, 'macro avg': {'precision': 0.36192882462118053, 'recall': 0.3459997914920969, 'f1-score': 0.27407253582379343, 'support': 219944}, 'weighted avg': {'precision': 0.3727474155908335, 'recall': 0.30799658094787763, 'f1-score': 0.25849134112197597, 'support': 219944}}
[[15131 51225  4905]
 [11314 44591  4804]
 [16328 63626  8020]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217434
{'0': {'precision': 0.34381396005363823, 'recall': 0.35607777209268326, 'f1-score': 0.3498384201077199, 'support': 27362}, '1': {'precision': 0.3214361891219339, 'recall': 0.5030599755201959, 'f1-score': 0.392243623112962, 'support': 26961}, '2': {'precision': 0.3165306305498251, 'recall': 0.12898863262546145, 'f1-score': 0.1832865897995222, 'support': 27359}, 'accuracy': 0.32853015352219583, 'macro avg': {'precision': 0.32726025990846574, 'recall': 0.3293754600794469, 'f1-score': 0.3084562110067347, 'support': 81682}, 'weighted avg': {'precision': 0.3272892459919784, 'recall': 0.32853015352219583, 'f1-score': 0.3080494721488349, 'support': 81682}}
[[ 9743 13768  3851]
 [ 9629 13563  3769]
 [ 8966 14864  3529]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.13663
{'0': {'precision': 0.367816091954023, 'recall': 0.23050537388520467, 'f1-score': 0.28340479370211574, 'support': 8746}, '1': {'precision': 0.3005338578252318, 'recall': 0.7163139566032681, 'f1-score': 0.42341950041566045, 'support': 7466}, '2': {'precision': 0.3359050445103858, 'recall': 0.06469310778374672, 'f1-score': 0.10849147019359787, 'support': 8749}, 'accuracy': 0.3176956051440247, 'macro avg': {'precision': 0.33475166476321355, 'recall': 0.3371708127574065, 'f1-score': 0.2717719214371247, 'support': 24961}, 'weighted avg': {'precision': 0.33650649241514485, 'recall': 0.3176956051440247, 'f1-score': 0.2639758098051285, 'support': 24961}}
[[2016 6101  629]
 [1628 5348  490]
 [1837 6346  566]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
1914/1914 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1224664
{'0': {'precision': 0.333954020292065, 'recall': 0.27840829223275454, 'f1-score': 0.30366195493132375, 'support': 163623}, '1': {'precision': 0.31965388743426487, 'recall': 0.6754417067508713, 'f1-score': 0.433943368978441, 'support': 149477}, '2': {'precision': 0.40042485395645244, 'recall': 0.08528495240896057, 'f1-score': 0.14061982758218752, 'support': 176819}, 'accuracy': 0.32984432120411744, 'macro avg': {'precision': 0.3513442538942608, 'recall': 0.34637831713086215, 'f1-score': 0.29274171716398406, 'support': 489919}, 'weighted avg': {'precision': 0.35358127577413023, 'recall': 0.32984432120411744, 'f1-score': 0.2845672250102021, 'support': 489919}}
[[ 45554 106063  12006]
 [ 37940 100963  10574]
 [ 52914 108825  15080]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1262585
{'0': {'precision': 0.33355433478562857, 'recall': 0.17430254235889991, 'f1-score': 0.22895965845677074, 'support': 60613}, '1': {'precision': 0.362009817993914, 'recall': 0.7938838786848608, 'f1-score': 0.4972667629502201, 'support': 63537}, '2': {'precision': 0.3388552969435931, 'recall': 0.0694178134491711, 'f1-score': 0.11522969889868463, 'support': 58933}, 'accuracy': 0.35556004653627044, 'macro avg': {'precision': 0.3448064832410453, 'recall': 0.34586807816431064, 'f1-score': 0.28048537343522517, 'support': 183083}, 'weighted avg': {'precision': 0.34513584502666766, 'recall': 0.35556004653627044, 'f1-score': 0.28546398049411775, 'support': 183083}}
[[10565 45565  4483]
 [ 9597 50441  3499]
 [11512 43330  4091]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1434121
{'0': {'precision': 0.3625217463341894, 'recall': 0.22707695501011882, 'f1-score': 0.27924191181162655, 'support': 19271}, '1': {'precision': 0.2919849381387843, 'recall': 0.7034277198211625, 'f1-score': 0.4126736738068538, 'support': 15433}, '2': {'precision': 0.34851008698871, 'recall': 0.0943859649122807, 'f1-score': 0.14854257878752022, 'support': 19950}, 'accuracy': 0.3131518278625535, 'macro avg': {'precision': 0.3343389238205612, 'recall': 0.341630213247854, 'f1-score': 0.2801527214686669, 'support': 54654}, 'weighted avg': {'precision': 0.33748922968724676, 'recall': 0.3131518278625535, 'f1-score': 0.26921155152768433, 'support': 54654}}
[[ 4376 12772  2123]
 [ 3180 10856  1397]
 [ 4515 13552  1883]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
4918/4918 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1429121
{'0': {'precision': 0.32490483092556904, 'recall': 0.09575366965371238, 'f1-score': 0.14791489917118059, 'support': 426062}, '1': {'precision': 0.31229547793003876, 'recall': 0.8751443583605479, 'f1-score': 0.4603241651480225, 'support': 392253}, '2': {'precision': 0.3506634570220761, 'recall': 0.027115435254378876, 'f1-score': 0.05033839877957302, 'support': 440524}, 'accuracy': 0.31459146086195294, 'macro avg': {'precision': 0.32928792195922796, 'recall': 0.3326711544228797, 'f1-score': 0.21952582103292537, 'support': 1258839}, 'weighted avg': {'precision': 0.32998986281763937, 'recall': 0.31459146086195294, 'f1-score': 0.21111494425137087, 'support': 1258839}}
[[ 40797 373382  11883]
 [ 38739 343278  10236]
 [ 46030 382549  11945]]
Evaluating performance on  train set...
1403/1403 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218868
{'0': {'precision': 0.3369469773725093, 'recall': 0.32774068507888016, 'f1-score': 0.3322800751018913, 'support': 121767}, '1': {'precision': 0.3283121723438094, 'recall': 0.5203700560176541, 'f1-score': 0.402609640698312, 'support': 117820}, '2': {'precision': 0.3207242039518932, 'recall': 0.14451433501126532, 'f1-score': 0.19924937929441655, 'support': 119393}, 'accuracy': 0.3300239567663937, 'macro avg': {'precision': 0.32866111788940394, 'recall': 0.33087502536926655, 'f1-score': 0.3113796983648733, 'support': 358980}, 'weighted avg': {'precision': 0.3287174428149043, 'recall': 0.3300239567663937, 'f1-score': 0.31111815954678645, 'support': 358980}}
[[39908 63263 18596]
 [38563 61310 17947]
 [39969 62170 17254]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1261678
{'0': {'precision': 0.3463996409258982, 'recall': 0.3851564913614867, 'f1-score': 0.3647514234915491, 'support': 42079}, '1': {'precision': 0.31083506601979705, 'recall': 0.4593345413482497, 'f1-score': 0.37076841547429784, 'support': 38079}, '2': {'precision': 0.3580548349356529, 'recall': 0.16539392372941095, 'f1-score': 0.22626892539136587, 'support': 42559}, 'accuracy': 0.33195889730029254, 'macro avg': {'precision': 0.3384298472937827, 'recall': 0.33662831881304905, 'f1-score': 0.3205962547857376, 'support': 122717}, 'weighted avg': {'precision': 0.33940606997820333, 'recall': 0.33195889730029254, 'f1-score': 0.31859192155673477, 'support': 122717}}
[[16207 19400  6472]
 [14440 17491  6148]
 [16140 19380  7039]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
4856/4856 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162983
{'0': {'precision': 0.3640653718146143, 'recall': 0.3792155495315119, 'f1-score': 0.37148605883234453, 'support': 444515}, '1': {'precision': 0.3036920982545241, 'recall': 0.4965005855483341, 'f1-score': 0.3768674911977116, 'support': 360346}, '2': {'precision': 0.36059317813690905, 'recall': 0.15703901891134223, 'f1-score': 0.21879318652763222, 'support': 438044}, 'accuracy': 0.33491618426187036, 'macro avg': {'precision': 0.3427835494020159, 'recall': 0.3442517179970627, 'f1-score': 0.3223822455192295, 'support': 1242905}, 'weighted avg': {'precision': 0.3453380827284484, 'recall': 0.33491618426187036, 'f1-score': 0.31923184879319044, 'support': 1242905}}
[[168567 207980  67968]
 [127423 178912  54011]
 [167023 202231  68790]]
Evaluating performance on  train set...
2076/2076 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273218
{'0': {'precision': 0.34214587948720643, 'recall': 0.18357838994986198, 'f1-score': 0.23894879249724107, 'support': 177510}, '1': {'precision': 0.3368433075030353, 'recall': 0.7730961227234392, 'f1-score': 0.4692368752821055, 'support': 175484}, '2': {'precision': 0.34759054175396586, 'recall': 0.0650894538606403, 'f1-score': 0.10964659673505613, 'support': 178416}, 'accuracy': 0.3384693551118722, 'macro avg': {'precision': 0.34219324291473585, 'recall': 0.3405879888446472, 'f1-score': 0.27261075483813424, 'support': 531410}, 'weighted avg': {'precision': 0.34222284138275955, 'recall': 0.3384693551118722, 'f1-score': 0.2715832806708042, 'support': 531410}}
[[ 32587 133428  11495]
 [ 29516 135666  10302]
 [ 33140 133663  11613]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137458
{'0': {'precision': 0.3254198031268095, 'recall': 0.33927307548191016, 'f1-score': 0.33220207702734383, 'support': 48038}, '1': {'precision': 0.385566653195543, 'recall': 0.6093764257167363, 'f1-score': 0.4722988359429146, 'support': 54797}, '2': {'precision': 0.33467919541917485, 'recall': 0.09602948920484465, 'f1-score': 0.14923809679689673, 'support': 47475}, 'accuracy': 0.3609141108376023, 'macro avg': {'precision': 0.34855521724717575, 'recall': 0.348226330134497, 'f1-score': 0.3179130032557184, 'support': 150310}, 'weighted avg': {'precision': 0.350271486928928, 'recall': 0.3609141108376023, 'f1-score': 0.3254870689563975, 'support': 150310}}
[[16298 27142  4598]
 [16940 33392  4465]
 [16845 26071  4559]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
4353/4353 - 53s - 53s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162183
{'0': {'precision': 0.4002308892212757, 'recall': 0.39092284011383366, 'f1-score': 0.3955221093305234, 'support': 446968}, '1': {'precision': 0.2540499640278846, 'recall': 0.5076807036926869, 'f1-score': 0.338640073129079, 'support': 282396}, '2': {'precision': 0.3467002972069601, 'recall': 0.10212925148860555, 'f1-score': 0.15778035090394993, 'support': 384924}, 'accuracy': 0.3207510087158796, 'macro avg': {'precision': 0.33366038348537347, 'recall': 0.3335775984317087, 'f1-score': 0.2973141777878508, 'support': 1114288}, 'weighted avg': {'precision': 0.34469217916478107, 'recall': 0.3207510087158796, 'f1-score': 0.29897995136441996, 'support': 1114288}}
[[174730 226675  45563]
 [110515 143367  28514]
 [151328 194284  39312]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198906
{'0': {'precision': 0.36544083593840454, 'recall': 0.3564617111235027, 'f1-score': 0.36089543172601074, 'support': 141673}, '1': {'precision': 0.31981970136065513, 'recall': 0.5051212400628006, 'f1-score': 0.3916588837718592, 'support': 120381}, '2': {'precision': 0.35066876000120767, 'recall': 0.17530130028903698, 'f1-score': 0.23374976729676833, 'support': 132509}, 'accuracy': 0.3409772330400975, 'macro avg': {'precision': 0.3453097657667558, 'recall': 0.3456280838251134, 'f1-score': 0.3287680275982128, 'support': 394563}, 'weighted avg': {'precision': 0.3465608324612258, 'recall': 0.3409772330400975, 'f1-score': 0.3275810821110615, 'support': 394563}}
[[50501 67426 23746]
 [40307 60807 19267]
 [47384 61896 23229]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1538706
{'0': {'precision': 0.352162157190943, 'recall': 0.4267278846368155, 'f1-score': 0.38587580869460064, 'support': 44867}, '1': {'precision': 0.2728614526227009, 'recall': 0.4948814496675884, 'f1-score': 0.3517689862830378, 'support': 33994}, '2': {'precision': 0.33543695980244204, 'recall': 0.05500686179666584, 'f1-score': 0.09451467006842165, 'support': 44449}, 'accuracy': 0.3115238018003406, 'macro avg': {'precision': 0.320153523205362, 'recall': 0.3255387320336899, 'f1-score': 0.2773864883486867, 'support': 123310}, 'weighted avg': {'precision': 0.3242717472500274, 'recall': 0.3115238018003406, 'f1-score': 0.2714476311594965, 'support': 123310}}
[[19146 23098  2623]
 [14950 16823  2221]
 [20271 21733  2445]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
5497/5497 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.144958
{'0': {'precision': 0.34977791937630015, 'recall': 0.20115711849902243, 'f1-score': 0.25542146909974733, 'support': 463911}, '1': {'precision': 0.3239269818938613, 'recall': 0.7851944261690498, 'f1-score': 0.45864349713173286, 'support': 439267}, '2': {'precision': 0.3627444498803369, 'recall': 0.054430055771264405, 'f1-score': 0.09465679407644587, 'support': 504023}, 'accuracy': 0.3309143469909416, 'macro avg': {'precision': 0.34548311705016616, 'recall': 0.34692720014644557, 'f1-score': 0.26957392010264203, 'support': 1407201}, 'weighted avg': {'precision': 0.3463526559271821, 'recall': 0.3309143469909416, 'f1-score': 0.26127680660182184, 'support': 1407201}}
[[ 93319 343215  27377]
 [ 73539 344910  20818]
 [ 99937 376652  27434]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1088954
{'0': {'precision': 0.3561249220968077, 'recall': 0.2918596204485608, 'f1-score': 0.32080544448533765, 'support': 176208}, '1': {'precision': 0.3585447380032761, 'recall': 0.6612194850072456, 'f1-score': 0.4649638841313575, 'support': 179420}, '2': {'precision': 0.32383761546223705, 'recall': 0.09747891305871632, 'f1-score': 0.14985093926223914, 'support': 171196}, 'accuracy': 0.35448650782804125, 'macro avg': {'precision': 0.34616909185410694, 'recall': 0.3501860061715076, 'f1-score': 0.3118734226263114, 'support': 526824}, 'weighted avg': {'precision': 0.34645699812851205, 'recall': 0.35448650782804125, 'f1-score': 0.3143482211339248, 'support': 526824}}
[[ 51428 106799  17981]
 [ 43921 118636  16863]
 [ 49061 105447  16688]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1040938
{'0': {'precision': 0.34082954147707384, 'recall': 0.2720352004469898, 'f1-score': 0.30257127320748856, 'support': 57272}, '1': {'precision': 0.3798962245323754, 'recall': 0.6888673224331349, 'f1-score': 0.48972122175967064, 'support': 60794}, '2': {'precision': 0.3778952531473105, 'recall': 0.12330837764302101, 'f1-score': 0.18594298892494168, 'support': 56233}, 'accuracy': 0.36943987056724364, 'macro avg': {'precision': 0.3662070063855866, 'recall': 0.36140363350771526, 'f1-score': 0.3260784946307003, 'support': 174299}, 'weighted avg': {'precision': 0.36641394582831177, 'recall': 0.36943987056724364, 'f1-score': 0.3302205176794643, 'support': 174299}}
[[15580 34751  6941]
 [14441 41879  4474]
 [15691 33608  6934]]
testing model on single stock: results/universal/W2/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
14883/14883 - 178s - 178s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1121145
{'0': {'precision': 0.3198096114745789, 'recall': 0.18901495816070663, 'f1-score': 0.2376017352133281, 'support': 1161707}, '1': {'precision': 0.39236922492637083, 'recall': 0.7384256109344868, 'f1-score': 0.5124457159508957, 'support': 1455066}, '2': {'precision': 0.31813788910884916, 'recall': 0.10263542995458988, 'f1-score': 0.15520099566298529, 'support': 1193126}, 'accuracy': 0.37179332050534675, 'macro avg': {'precision': 0.3434389085032663, 'recall': 0.3433586663499278, 'f1-score': 0.3017494822757364, 'support': 3809899}, 'weighted avg': {'precision': 0.34699785218319384, 'recall': 0.37179332050534675, 'f1-score': 0.3167643762437458, 'support': 3809899}}
[[ 219580  815429  126698]
 [ 244845 1074458  135763]
 [ 222171  848498  122457]]
Evaluating performance on  train set...
6147/6147 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127337
{'0': {'precision': 0.3391203977587943, 'recall': 0.2484067478010327, 'f1-score': 0.2867605207925723, 'support': 519221}, '1': {'precision': 0.3439126089127217, 'recall': 0.6751078737746867, 'f1-score': 0.4556887994146338, 'support': 519357}, '2': {'precision': 0.3543839442540816, 'recall': 0.11504242793607113, 'f1-score': 0.17369790784586028, 'support': 534907}, 'accuracy': 0.3439098561473417, 'macro avg': {'precision': 0.34580565030853255, 'recall': 0.3461856831705969, 'f1-score': 0.3053824093510221, 'support': 1573485}, 'weighted avg': {'precision': 0.3458910033085294, 'recall': 0.3439098561473417, 'f1-score': 0.3040826439121642, 'support': 1573485}}
[[128978 327877  62366]
 [118993 350622  49742]
 [132360 341010  61537]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1219915
{'0': {'precision': 0.3549237983587339, 'recall': 0.2824757926713499, 'f1-score': 0.3145825089636049, 'support': 184345}, '1': {'precision': 0.36407028844677825, 'recall': 0.6942871819231258, 'f1-score': 0.47766343917676213, 'support': 181049}, '2': {'precision': 0.39163115071677645, 'recall': 0.13222751295065668, 'f1-score': 0.19770375731022746, 'support': 191110}, 'accuracy': 0.36485452036283655, 'macro avg': {'precision': 0.3702084125074296, 'recall': 0.3696634958483775, 'f1-score': 0.3299832351501982, 'support': 556504}, 'weighted avg': {'precision': 0.3705051867999596, 'recall': 0.36485452036283655, 'f1-score': 0.32750054927541744, 'support': 556504}}
[[ 52073 107798  24474]
 [ 40568 125700  14781]
 [ 54075 111765  25270]]
training model: results/universal/W2/deepLOB_L1/h1000
Epoch 1/50
9940/9940 - 219s - loss: 3.1631 - accuracy1000: 0.4425 - val_loss: 3.5281 - val_accuracy1000: 0.3558 - 219s/epoch - 22ms/step
Epoch 2/50
9940/9940 - 218s - loss: 3.1109 - accuracy1000: 0.4625 - val_loss: 3.5361 - val_accuracy1000: 0.3558 - 218s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 217s - loss: 3.0874 - accuracy1000: 0.4708 - val_loss: 3.7727 - val_accuracy1000: 0.3337 - 217s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 215s - loss: 3.0733 - accuracy1000: 0.4756 - val_loss: 3.7276 - val_accuracy1000: 0.3291 - 215s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 217s - loss: 3.0597 - accuracy1000: 0.4795 - val_loss: 3.6583 - val_accuracy1000: 0.3443 - 217s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 218s - loss: 3.0543 - accuracy1000: 0.4811 - val_loss: 3.7978 - val_accuracy1000: 0.3281 - 218s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 217s - loss: 3.0434 - accuracy1000: 0.4840 - val_loss: 3.7959 - val_accuracy1000: 0.3278 - 217s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 215s - loss: 3.0384 - accuracy1000: 0.4852 - val_loss: 3.9125 - val_accuracy1000: 0.3289 - 215s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 216s - loss: 3.0329 - accuracy1000: 0.4874 - val_loss: 3.8309 - val_accuracy1000: 0.3317 - 216s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 215s - loss: 3.0294 - accuracy1000: 0.4881 - val_loss: 3.8907 - val_accuracy1000: 0.3276 - 215s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 216s - loss: 3.0260 - accuracy1000: 0.4888 - val_loss: 3.8906 - val_accuracy1000: 0.3279 - 216s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 315s - 315s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1423583
{'0': {'precision': 0.32149131140113707, 'recall': 0.1531516059843869, 'f1-score': 0.20746927362709844, 'support': 2154473}, '1': {'precision': 0.3652211434629129, 'recall': 0.6246459432115089, 'f1-score': 0.46093846074955475, 'support': 2367205}, '2': {'precision': 0.32514674249881514, 'recall': 0.24333099448817716, 'f1-score': 0.2783513761723207, 'support': 2199091}, 'accuracy': 0.3487298849283467, 'macro avg': {'precision': 0.337286399120955, 'recall': 0.3403761812280243, 'f1-score': 0.3155863701829913, 'support': 6720769}, 'weighted avg': {'precision': 0.33809002246140707, 'recall': 0.3487298849283467, 'f1-score': 0.3199399925091921, 'support': 6720769}}
[[ 329961 1257526  566986]
 [ 344893 1478665  543647]
 [ 351491 1312493  535107]]
Evaluating performance on  train set...
9940/9940 - 122s - 122s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1638186
{'0': {'precision': 0.3278275344649723, 'recall': 0.19817708733185538, 'f1-score': 0.24702408775619417, 'support': 846667}, '1': {'precision': 0.3571096680066922, 'recall': 0.5330921822789485, 'f1-score': 0.42770608074901934, 'support': 844837}, '2': {'precision': 0.3557803355695989, 'recall': 0.3217563254001784, 'f1-score': 0.3379140348174396, 'support': 852120}, 'accuracy': 0.3508148216874821, 'macro avg': {'precision': 0.34690584601375446, 'recall': 0.35100853167032736, 'f1-score': 0.3375480677742177, 'support': 2543624}, 'weighted avg': {'precision': 0.3469175299722723, 'recall': 0.3508148216874821, 'f1-score': 0.33748398851350264, 'support': 2543624}}
[[167790 399251 279626]
 [177632 450376 216829]
 [166402 411543 274175]]
Evaluating performance on  val set...
3393/3393 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1764477
{'0': {'precision': 0.3374576204281598, 'recall': 0.26513389365008805, 'f1-score': 0.29695556859233646, 'support': 290193}, '1': {'precision': 0.35942735459373476, 'recall': 0.4931828022854246, 'f1-score': 0.4158134606451766, 'support': 284061}, '2': {'precision': 0.3665617334750198, 'recall': 0.31227602073286526, 'f1-score': 0.3372483005636303, 'support': 293833}, 'accuracy': 0.35571434660350865, 'macro avg': {'precision': 0.3544822361656381, 'recall': 0.35686423888945934, 'f1-score': 0.35000577660038107, 'support': 868087}, 'weighted avg': {'precision': 0.3544979556776283, 'recall': 0.35571434660350865, 'f1-score': 0.3494874300160682, 'support': 868087}}
[[ 76940 123625  89628]
 [ 75034 140094  68933]
 [ 76025 126051  91757]]
testing model out of sample: results/universal/W2/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 172s - 172s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1597733
{'0': {'precision': 0.31883671173978523, 'recall': 0.18244293833287042, 'f1-score': 0.2320840534011932, 'support': 1191737}, '1': {'precision': 0.3277279728419869, 'recall': 0.4953721435488484, 'f1-score': 0.3944776708804787, 'support': 1195802}, '2': {'precision': 0.35508295195479855, 'recall': 0.32680109506454846, 'f1-score': 0.3403555136531539, 'support': 1279194}, 'accuracy': 0.3348574875781793, 'macro avg': {'precision': 0.33388254551219027, 'recall': 0.3348720589820891, 'f1-score': 0.32230574597827527, 'support': 3666733}, 'weighted avg': {'precision': 0.33438138347185264, 'recall': 0.3348574875781793, 'f1-score': 0.32281627058049456, 'support': 3666733}}
[[217424 584442 389871]
 [234040 592367 369395]
 [230465 630687 418042]]
Evaluating performance on  train set...
5373/5373 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.147785
{'0': {'precision': 0.3408846792305439, 'recall': 0.18002539745294918, 'f1-score': 0.23561801781533637, 'support': 465401}, '1': {'precision': 0.33564121018944554, 'recall': 0.5723964246730873, 'f1-score': 0.42315388990341074, 'support': 456238}, '2': {'precision': 0.33278924819397915, 'recall': 0.2577478803229102, 'f1-score': 0.29050069563509184, 'support': 453253}, 'accuracy': 0.3358503795207187, 'macro avg': {'precision': 0.3364383792046562, 'recall': 0.3367232341496489, 'f1-score': 0.3164242011179463, 'support': 1374892}, 'weighted avg': {'precision': 0.33647593422949024, 'recall': 0.3358503795207187, 'f1-score': 0.3159419484073803, 'support': 1374892}}
[[ 83784 262165 119452]
 [ 80318 261149 114771]
 [ 81682 254746 116825]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1621035
{'0': {'precision': 0.308174769609635, 'recall': 0.22449422927338597, 'f1-score': 0.2597615311951414, 'support': 142703}, '1': {'precision': 0.3632471046417179, 'recall': 0.4654663762441755, 'f1-score': 0.4080525232871166, 'support': 145076}, '2': {'precision': 0.37101344297918576, 'recall': 0.36562322856962903, 'f1-score': 0.36829861478270065, 'support': 142893}, 'accuracy': 0.35249331277631235, 'macro avg': {'precision': 0.3474784390768462, 'recall': 0.3518612780290635, 'f1-score': 0.34537088975498625, 'support': 430672}, 'weighted avg': {'precision': 0.34757570728589365, 'recall': 0.35249331277631235, 'f1-score': 0.3457263802074117, 'support': 430672}}
[[32036 59850 50817]
 [39793 67528 37755]
 [32125 58523 52245]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1521975
{'0': {'precision': 0.3373188915459277, 'recall': 0.23816558864790377, 'f1-score': 0.2792004133283851, 'support': 80549}, '1': {'precision': 0.40547210899547714, 'recall': 0.4115293504256067, 'f1-score': 0.40847827554395516, 'support': 88227}, '2': {'precision': 0.38608382510982486, 'recall': 0.4891960009077987, 'f1-score': 0.4315663577401118, 'support': 83719}, 'accuracy': 0.38197588071050914, 'macro avg': {'precision': 0.37629160855040994, 'recall': 0.37963031332710306, 'f1-score': 0.3730816822041507, 'support': 252495}, 'weighted avg': {'precision': 0.3773018828485567, 'recall': 0.38197588071050914, 'f1-score': 0.3748922981177807, 'support': 252495}}
[[19184 27736 33629]
 [20425 36308 31494]
 [17263 25501 40955]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1684552
{'0': {'precision': 0.3801304565980933, 'recall': 0.18123534759102436, 'f1-score': 0.2454480658329554, 'support': 20901}, '1': {'precision': 0.3102601272449062, 'recall': 0.3975132848372285, 'f1-score': 0.348508492208879, 'support': 19383}, '2': {'precision': 0.32556332556332557, 'recall': 0.41372500617131575, 'f1-score': 0.36438743341667573, 'support': 20255}, 'accuracy': 0.328267728241299, 'macro avg': {'precision': 0.3386513031354417, 'recall': 0.3308245461998562, 'f1-score': 0.3194479971528367, 'support': 60539}, 'weighted avg': {'precision': 0.33950286392292445, 'recall': 0.328267728241299, 'f1-score': 0.3182397725815436, 'support': 60539}}
[[3788 8388 8725]
 [3043 7705 8635]
 [3134 8741 8380]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1379164
{'0': {'precision': 0.5091633466135458, 'recall': 0.16844602609727166, 'f1-score': 0.25314449836585123, 'support': 7587}, '1': {'precision': 0.28807339449541286, 'recall': 0.19035430418968072, 'f1-score': 0.22923426346528228, 'support': 7423}, '2': {'precision': 0.33436728939020094, 'recall': 0.7197268588770865, 'f1-score': 0.4566064981949459, 'support': 6590}, 'accuracy': 0.3441666666666667, 'macro avg': {'precision': 0.3772013434997199, 'recall': 0.3595090630546796, 'f1-score': 0.3129950866753598, 'support': 21600}, 'weighted avg': {'precision': 0.37985516459156693, 'recall': 0.3441666666666667, 'f1-score': 0.30700231805135175, 'support': 21600}}
[[1278 2193 4116]
 [ 684 1413 5326]
 [ 548 1299 4743]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1396685
{'0': {'precision': 0.26503196259898865, 'recall': 0.1573913536177687, 'f1-score': 0.19749733380732315, 'support': 88245}, '1': {'precision': 0.40473550954411885, 'recall': 0.6729260067127599, 'f1-score': 0.5054593601122102, 'support': 124241}, '2': {'precision': 0.31725228211535517, 'recall': 0.17721458889215957, 'f1-score': 0.22740343609114172, 'support': 105313}, 'accuracy': 0.36550461140532226, 'macro avg': {'precision': 0.3290065847528209, 'recall': 0.3358439830742294, 'f1-score': 0.31012004333689164, 'support': 317799}, 'weighted avg': {'precision': 0.33695285248610923, 'recall': 0.36550461140532226, 'f1-score': 0.32780300330269996, 'support': 317799}}
[[13889 55716 18640]
 [19112 83605 21524]
 [19404 67246 18663]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1814862
{'0': {'precision': 0.3483504909455373, 'recall': 0.2200686842670101, 'f1-score': 0.26973415939912926, 'support': 46590}, '1': {'precision': 0.3882536796950996, 'recall': 0.5460192868356134, 'f1-score': 0.453815972189862, 'support': 44590}, '2': {'precision': 0.32144861124099877, 'recall': 0.314377829606256, 'f1-score': 0.317873904700252, 'support': 43734}, 'accuracy': 0.3583690350890197, 'macro avg': {'precision': 0.352684260627212, 'recall': 0.3601552669029598, 'f1-score': 0.3471413454297478, 'support': 134914}, 'weighted avg': {'precision': 0.3528181991103289, 'recall': 0.3583690350890197, 'f1-score': 0.3461795368494908, 'support': 134914}}
[[10253 18766 17571]
 [ 8791 24347 11452]
 [10389 19596 13749]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1377751
{'0': {'precision': 0.42813533452047825, 'recall': 0.11756077116512992, 'f1-score': 0.18446867978297798, 'support': 14316}, '1': {'precision': 0.4054037032371835, 'recall': 0.40859464263044304, 'f1-score': 0.40699291856347997, 'support': 15754}, '2': {'precision': 0.28793418647166363, 'recall': 0.568646080760095, 'f1-score': 0.3822937625754527, 'support': 10525}, 'accuracy': 0.34745658332306933, 'macro avg': {'precision': 0.37382440807644174, 'recall': 0.36493383151855596, 'f1-score': 0.3245851203073036, 'support': 40595}, 'weighted avg': {'precision': 0.38296397838177154, 'recall': 0.34745658332306933, 'f1-score': 0.32211508584625737, 'support': 40595}}
[[1683 5726 6907]
 [1423 6437 7894]
 [ 825 3715 5985]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1861513
{'0': {'precision': 0.33304181305508224, 'recall': 0.265325244759445, 'f1-score': 0.2953518226311145, 'support': 83245}, '1': {'precision': 0.2823903992162626, 'recall': 0.5748401490695616, 'f1-score': 0.3787297116415042, 'support': 80231}, '2': {'precision': 0.30414591465876967, 'recall': 0.12242520566748241, 'f1-score': 0.17457874844666507, 'support': 110737}, 'accuracy': 0.29817696462239207, 'macro avg': {'precision': 0.30652604231003816, 'recall': 0.3208635331654963, 'f1-score': 0.28288676090642795, 'support': 274213}, 'weighted avg': {'precision': 0.30655270172770244, 'recall': 0.29817696462239207, 'f1-score': 0.27097458120648915, 'support': 274213}}
[[22087 48010 13148]
 [16242 46120 17869]
 [27990 69190 13557]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1417794
{'0': {'precision': 0.3358172574691831, 'recall': 0.19837090669738358, 'f1-score': 0.24941164300307755, 'support': 24308}, '1': {'precision': 0.3664683918027093, 'recall': 0.6646062992125984, 'f1-score': 0.4724336728982425, 'support': 25400}, '2': {'precision': 0.3448029810512963, 'recall': 0.18642832647462276, 'f1-score': 0.24200773489886201, 'support': 23328}, 'accuracy': 0.35670080508242513, 'macro avg': {'precision': 0.3490295434410629, 'recall': 0.3498018441282016, 'f1-score': 0.32128435026672736, 'support': 73036}, 'weighted avg': {'precision': 0.3493469931035977, 'recall': 0.35670080508242513, 'f1-score': 0.32460800084143193, 'support': 73036}}
[[ 4822 14589  4897]
 [ 5152 16881  3367]
 [ 4385 14594  4349]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1398236
{'0': {'precision': 0.3679591836734694, 'recall': 0.18173571212579376, 'f1-score': 0.24330342082180695, 'support': 9921}, '1': {'precision': 0.36694594055455815, 'recall': 0.41467538322813347, 'f1-score': 0.389353370727061, 'support': 8872}, '2': {'precision': 0.4312302627158503, 'recall': 0.5826071169208424, 'f1-score': 0.49561759141279577, 'support': 11016}, 'accuracy': 0.39920829279747727, 'macro avg': {'precision': 0.3887117956479593, 'recall': 0.39300607075825655, 'f1-score': 0.37609146098722124, 'support': 29809}, 'weighted avg': {'precision': 0.39103961957470357, 'recall': 0.39920829279747727, 'f1-score': 0.3800154225256463, 'support': 29809}}
[[1803 3103 5015]
 [1743 3679 3450]
 [1354 3244 6418]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
860/860 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1489159
{'0': {'precision': 0.3594805566828197, 'recall': 0.22059620596205962, 'f1-score': 0.27341225171574857, 'support': 68265}, '1': {'precision': 0.2951733947186196, 'recall': 0.7838187058940463, 'f1-score': 0.4288491604921487, 'support': 60366}, '2': {'precision': 0.5712515489467163, 'recall': 0.11106852255429128, 'f1-score': 0.185977426719356, 'support': 91313}, 'accuracy': 0.3297066526024806, 'macro avg': {'precision': 0.40863516678271855, 'recall': 0.3718278114701324, 'f1-score': 0.2960796129757511, 'support': 219944}, 'weighted avg': {'precision': 0.429750618505203, 'recall': 0.3297066526024806, 'f1-score': 0.2797737267289363, 'support': 219944}}
[[15059 48700  4506]
 [ 9944 47316  3106]
 [16888 64283 10142]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1671677
{'0': {'precision': 0.3304410701373825, 'recall': 0.049291723592435464, 'f1-score': 0.0857866908613084, 'support': 27814}, '1': {'precision': 0.3142328386853559, 'recall': 0.33974358974358976, 'f1-score': 0.3264906439724393, 'support': 26988}, '2': {'precision': 0.3128386483021053, 'recall': 0.5627604166666667, 'f1-score': 0.40213201478055133, 'support': 26880}, 'accuracy': 0.3142307974829216, 'macro avg': {'precision': 0.3191708523749479, 'recall': 0.3172652433342306, 'f1-score': 0.27146978320476634, 'support': 81682}, 'weighted avg': {'precision': 0.3192931936240803, 'recall': 0.3142307974829216, 'f1-score': 0.2694193222061879, 'support': 81682}}
[[ 1371  9715 16728]
 [ 1320  9169 16499]
 [ 1458 10295 15127]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1578321
{'0': {'precision': 0.32351885098743266, 'recall': 0.100659144229695, 'f1-score': 0.15354464894342196, 'support': 8951}, '1': {'precision': 0.3192944072200191, 'recall': 0.6201035719028017, 'f1-score': 0.4215372117163876, 'support': 7531}, '2': {'precision': 0.3266225165562914, 'recall': 0.29083618351220664, 'f1-score': 0.3076923076923077, 'support': 8479}, 'accuracy': 0.3219822923761067, 'macro avg': {'precision': 0.323145258254581, 'recall': 0.33719963321490115, 'f1-score': 0.29425805611737244, 'support': 24961}, 'weighted avg': {'precision': 0.323298575130935, 'recall': 0.3219822923761067, 'f1-score': 0.2867632695425569, 'support': 24961}}
[[ 901 4965 3085]
 [ 862 4670 1999]
 [1022 4991 2466]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1635696
{'0': {'precision': 0.2983370181678362, 'recall': 0.1915589625844042, 'f1-score': 0.23331128217464517, 'support': 162018}, '1': {'precision': 0.33743486076393725, 'recall': 0.36151422012994594, 'f1-score': 0.3490597637748442, 'support': 154218}, '2': {'precision': 0.38107365883280614, 'recall': 0.4841579198885326, 'f1-score': 0.42647502592880926, 'support': 173683}, 'accuracy': 0.34878826908121546, 'macro avg': {'precision': 0.3389485125881932, 'recall': 0.34574370086762757, 'f1-score': 0.33628202395943285, 'support': 489919}, 'weighted avg': {'precision': 0.33997561362973805, 'recall': 0.34878826908121546, 'f1-score': 0.3382260902181666, 'support': 489919}}
[[31036 57161 73821]
 [35711 55752 62755]
 [37283 52310 84090]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1450481
{'0': {'precision': 0.32404118965893536, 'recall': 0.26149609324964773, 'f1-score': 0.2894282144660943, 'support': 62456}, '1': {'precision': 0.3433514258347477, 'recall': 0.6545521527421835, 'f1-score': 0.45042711490768805, 'support': 62432}, '2': {'precision': 0.3996633489461358, 'recall': 0.09383967694819143, 'f1-score': 0.15199209563172322, 'support': 58195}, 'accuracy': 0.34223821982379576, 'macro avg': {'precision': 0.35568532147993964, 'recall': 0.3366293076466742, 'f1-score': 0.2972824750018352, 'support': 183083}, 'weighted avg': {'precision': 0.35466341140889, 'recall': 0.34223821982379576, 'f1-score': 0.3006438293336864, 'support': 183083}}
[[16332 41473  4651]
 [18015 40865  3552]
 [16054 36680  5461]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1558611
{'0': {'precision': 0.32174031642116746, 'recall': 0.12663052230393473, 'f1-score': 0.18173413967104504, 'support': 18629}, '1': {'precision': 0.3183120380450352, 'recall': 0.6704278042599409, 'f1-score': 0.4316711668835836, 'support': 16573}, '2': {'precision': 0.3621939432989691, 'recall': 0.2311844540407156, 'f1-score': 0.28222668507593823, 'support': 19452}, 'accuracy': 0.32874080579646503, 'macro avg': {'precision': 0.3340820992550573, 'recall': 0.34274759353486367, 'f1-score': 0.2985439972101889, 'support': 54654}, 'weighted avg': {'precision': 0.335098663339954, 'recall': 0.32874080579646503, 'f1-score': 0.29329024435156953, 'support': 54654}}
[[ 2359 11439  4831]
 [ 2374 11111  3088]
 [ 2599 12356  4497]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
4918/4918 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1473148
{'0': {'precision': 0.3359547128544089, 'recall': 0.30272291216833075, 'f1-score': 0.318474250693661, 'support': 414042}, '1': {'precision': 0.34115606035449625, 'recall': 0.7336771178453796, 'f1-score': 0.4657437082758637, 'support': 411692}, '2': {'precision': 0.3359375, 'recall': 0.00029784925133628104, 'f1-score': 0.0005951708117160989, 'support': 433105}, 'accuracy': 0.3396129290560588, 'macro avg': {'precision': 0.33768275773630174, 'recall': 0.3455659597550156, 'f1-score': 0.2616043765937469, 'support': 1258839}, 'weighted avg': {'precision': 0.33764984478287413, 'recall': 0.3396129290560588, 'f1-score': 0.25727074384223875, 'support': 1258839}}
[[125340 288558    144]
 [109532 302049    111]
 [138214 294762    129]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1642641
{'0': {'precision': 0.3175284806757284, 'recall': 0.14876830089540327, 'f1-score': 0.20260990177484645, 'support': 120281}, '1': {'precision': 0.42018698332522864, 'recall': 0.44394447897244665, 'f1-score': 0.4317391497060519, 'support': 120675}, '2': {'precision': 0.37694714722945505, 'recall': 0.5593269165593439, 'f1-score': 0.45037386748171593, 'support': 118024}, 'accuracy': 0.3829767675079392, 'macro avg': {'precision': 0.3715542037434707, 'recall': 0.38401323214239796, 'f1-score': 0.3615743063208714, 'support': 358980}, 'weighted avg': {'precision': 0.3715736740251224, 'recall': 0.3829767675079392, 'f1-score': 0.36109301025633783, 'support': 358980}}
[[17894 38724 63663]
 [21651 53573 45451]
 [16809 35201 66014]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1777517
{'0': {'precision': 0.37947976878612716, 'recall': 0.1826782608695652, 'f1-score': 0.2466306644752289, 'support': 43125}, '1': {'precision': 0.35557979412366214, 'recall': 0.4329588844004206, 'f1-score': 0.3904727445133439, 'support': 36142}, '2': {'precision': 0.3895772217428818, 'recall': 0.5195857307249713, 'f1-score': 0.44528599605522684, 'support': 43450}, 'accuracy': 0.37567737151331926, 'macro avg': {'precision': 0.37487892821755703, 'recall': 0.3784076253316524, 'f1-score': 0.3607964683479332, 'support': 122717}, 'weighted avg': {'precision': 0.3760160387953368, 'recall': 0.37567737151331926, 'f1-score': 0.35933155036625025, 'support': 122717}}
[[ 7878 14513 20734]
 [ 5854 15648 14640]
 [ 7028 13846 22576]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
4856/4856 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1689192
{'0': {'precision': 0.31887916085547774, 'recall': 0.14603191564284204, 'f1-score': 0.2003244795501261, 'support': 411773}, '1': {'precision': 0.3674891317503361, 'recall': 0.2638173962051475, 'f1-score': 0.3071408945700003, 'support': 425840}, '2': {'precision': 0.3423730171981967, 'recall': 0.632405771641187, 'f1-score': 0.4442416568955999, 'support': 405292}, 'accuracy': 0.34498614133823585, 'macro avg': {'precision': 0.3429137699346702, 'recall': 0.34741836116305885, 'f1-score': 0.31723567700524213, 'support': 1242905}, 'weighted avg': {'precision': 0.3431947296485228, 'recall': 0.34498614133823585, 'f1-score': 0.31645916628222953, 'support': 1242905}}
[[ 60132 104348 247293]
 [ 68473 112344 245023]
 [ 59968  89015 256309]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1408255
{'0': {'precision': 0.3329531115933983, 'recall': 0.1872771456473848, 'f1-score': 0.23971888411237366, 'support': 176124}, '1': {'precision': 0.3405914031301654, 'recall': 0.6917648936412758, 'f1-score': 0.4564493411786386, 'support': 175444}, '2': {'precision': 0.36151093334736734, 'recall': 0.1527841104969918, 'f1-score': 0.2147915950095369, 'support': 179842}, 'accuracy': 0.3421595378333114, 'macro avg': {'precision': 0.3450184826903104, 'recall': 0.3439420499285508, 'f1-score': 0.3036532734335164, 'support': 531410}, 'weighted avg': {'precision': 0.3451395367646481, 'recall': 0.3421595378333114, 'f1-score': 0.3028360343028131, 'support': 531410}}
[[ 32984 116553  26587]
 [ 32136 121366  21942]
 [ 33945 118420  27477]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1620966
{'0': {'precision': 0.28606658446362515, 'recall': 0.2557720440138232, 'f1-score': 0.2700724207792789, 'support': 47167}, '1': {'precision': 0.4227420487773004, 'recall': 0.4642056359755332, 'f1-score': 0.4425046594736932, 'support': 55749}, '2': {'precision': 0.3709426482811534, 'recall': 0.36724057897624174, 'f1-score': 0.3690823304882574, 'support': 47394}, 'accuracy': 0.36822566695495973, 'macro avg': {'precision': 0.359917093840693, 'recall': 0.3624060863218661, 'f1-score': 0.36055313691374313, 'support': 150310}, 'weighted avg': {'precision': 0.3635207566982803, 'recall': 0.36822566695495973, 'f1-score': 0.3652450675474396, 'support': 150310}}
[[12064 17666 17437]
 [17791 25879 12079]
 [12317 17672 17405]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
4353/4353 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1768273
{'0': {'precision': 0.34272145411475297, 'recall': 0.07651741875443382, 'f1-score': 0.12510367104631367, 'support': 393283}, '1': {'precision': 0.3305916836626656, 'recall': 0.15358050770672507, 'f1-score': 0.20972885070880615, 'support': 386286}, '2': {'precision': 0.30078226457684987, 'recall': 0.7611489040060468, 'f1-score': 0.4311768931928746, 'support': 334719}, 'accuracy': 0.30888782792240427, 'macro avg': {'precision': 0.32469846745142283, 'recall': 0.33041561015573523, 'f1-score': 0.25533647164933143, 'support': 1114288}, 'weighted avg': {'precision': 0.3259184336283146, 'recall': 0.30888782792240427, 'f1-score': 0.24638115495961102, 'support': 1114288}}
[[ 30093  65724 297466]
 [ 32169  59326 294791]
 [ 25544  54404 254771]]
Evaluating performance on  train set...
1542/1542 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1781362
{'0': {'precision': 0.3373466312692832, 'recall': 0.17175045480116605, 'f1-score': 0.22761645639481407, 'support': 136873}, '1': {'precision': 0.32886821403346406, 'recall': 0.3096355520225028, 'f1-score': 0.3189622251530481, 'support': 130828}, '2': {'precision': 0.32430677091338167, 'recall': 0.5156232756853905, 'f1-score': 0.3981763010442442, 'support': 126862}, 'accuracy': 0.3280337994185973, 'macro avg': {'precision': 0.33017387207204296, 'recall': 0.3323364275030198, 'f1-score': 0.3149183275307021, 'support': 394563}, 'weighted avg': {'precision': 0.33034273801371156, 'recall': 0.3280337994185973, 'f1-score': 0.31274391955536956, 'support': 394563}}
[[23508 42302 71063]
 [25094 40509 65225]
 [21083 40366 65413]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2076676
{'0': {'precision': 0.2922318503322208, 'recall': 0.22873576992210903, 'f1-score': 0.25661432566143255, 'support': 41725}, '1': {'precision': 0.3014792402084384, 'recall': 0.2709350924014301, 'f1-score': 0.28539224526600543, 'support': 39718}, '2': {'precision': 0.32600032752879526, 'recall': 0.4279265292473786, 'f1-score': 0.37007353548706934, 'support': 41867}, 'accuracy': 0.30995864082393965, 'macro avg': {'precision': 0.3065704726898182, 'recall': 0.30919913052363923, 'f1-score': 0.3040267021381691, 'support': 123310}, 'weighted avg': {'precision': 0.3066757126782803, 'recall': 0.30995864082393965, 'f1-score': 0.30440605503151086, 'support': 123310}}
[[ 9544 11958 20223]
 [12139 10761 16818]
 [10976 12975 17916]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
5497/5497 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1464725
{'0': {'precision': 0.31929499351960694, 'recall': 0.18660272331730346, 'f1-score': 0.235546883685767, 'support': 454152}, '1': {'precision': 0.3149828514530167, 'recall': 0.7638133096050401, 'f1-score': 0.4460306829442154, 'support': 447286}, '2': {'precision': 0.40488231691311577, 'recall': 0.04574672326761744, 'f1-score': 0.08220526267169768, 'support': 505763}, 'accuracy': 0.3194469020417126, 'macro avg': {'precision': 0.3463867206285798, 'recall': 0.33205425206332034, 'f1-score': 0.2545942764338934, 'support': 1407201}, 'weighted avg': {'precision': 0.3486853511622425, 'recall': 0.3194469020417126, 'f1-score': 0.24733762172971072, 'support': 1407201}}
[[ 84746 347637  21769]
 [ 93404 341643  12239]
 [ 87266 395360  23137]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1542565
{'0': {'precision': 0.3612204035340736, 'recall': 0.14205008479615885, 'f1-score': 0.2039117736561923, 'support': 181612}, '1': {'precision': 0.321324023212164, 'recall': 0.4300116949631004, 'f1-score': 0.36780651980555396, 'support': 173579}, '2': {'precision': 0.3189056666352924, 'recall': 0.4145589717595101, 'f1-score': 0.3604951031802729, 'support': 171633}, 'accuracy': 0.3257083959728486, 'macro avg': {'precision': 0.3338166977938433, 'recall': 0.32887358383958976, 'f1-score': 0.31073779888067304, 'support': 526824}, 'weighted avg': {'precision': 0.33428962771891474, 'recall': 0.3257083959728486, 'f1-score': 0.3089251229684229, 'support': 526824}}
[[25798 81180 74634]
 [21611 74641 77327]
 [24010 76471 71152]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1701987
{'0': {'precision': 0.30732216236932314, 'recall': 0.24300072391791108, 'f1-score': 0.2714025158415283, 'support': 59399}, '1': {'precision': 0.33788688443355164, 'recall': 0.4468552400857259, 'f1-score': 0.3848054542958681, 'support': 56459}, '2': {'precision': 0.364891294028292, 'recall': 0.32882736435037047, 'f1-score': 0.34592191240797077, 'support': 58441}, 'accuracy': 0.33781031445963544, 'macro avg': {'precision': 0.33670011361038893, 'recall': 0.33956110945133583, 'f1-score': 0.334043294181789, 'support': 174299}, 'weighted avg': {'precision': 0.33652514842378173, 'recall': 0.33781031445963544, 'f1-score': 0.33312177158558326, 'support': 174299}}
[[14434 25425 19540]
 [17322 25229 13908]
 [15211 24013 19217]]
testing model on single stock: results/universal/W2/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
14883/14883 - 174s - 174s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1304054
{'0': {'precision': 0.3089799995749113, 'recall': 0.12209588472734786, 'f1-score': 0.17502805322648224, 'support': 1190638}, '1': {'precision': 0.3769540015851644, 'recall': 0.7127406797532897, 'f1-score': 0.49311143006686825, 'support': 1384620}, '2': {'precision': 0.3483706320073636, 'recall': 0.20354823790883342, 'f1-score': 0.2569588834498537, 'support': 1234641}, 'accuracy': 0.3631476844924236, 'macro avg': {'precision': 0.34476821105581307, 'recall': 0.346128267463157, 'f1-score': 0.30836612224773474, 'support': 3809899}, 'weighted avg': {'precision': 0.3464485656656323, 'recall': 0.3631476844924236, 'f1-score': 0.31717874210263064, 'support': 3809899}}
[[145372 799220 246046]
 [173716 986875 224029]
 [151402 831930 251309]]
Evaluating performance on  train set...
6147/6147 - 73s - 73s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1583468
{'0': {'precision': 0.3262614110820183, 'recall': 0.22375846665463037, 'f1-score': 0.2654585989608284, 'support': 515109}, '1': {'precision': 0.3512831634654786, 'recall': 0.6177772752014351, 'f1-score': 0.44788693643995964, 'support': 521756}, '2': {'precision': 0.3762564682091239, 'recall': 0.21219484924154897, 'f1-score': 0.27135527504188245, 'support': 536620}, 'accuracy': 0.350468545934661, 'macro avg': {'precision': 0.3512670142522069, 'recall': 0.35124353036587147, 'f1-score': 0.32823360348089015, 'support': 1573485}, 'weighted avg': {'precision': 0.3516087114961513, 'recall': 0.350468545934661, 'f1-score': 0.32796148520910967, 'support': 1573485}}
[[115260 289381 110468]
 [121129 322329  78298]
 [116886 305866 113868]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1726896
{'0': {'precision': 0.3392565675820575, 'recall': 0.3127869680792636, 'f1-score': 0.32548450332336987, 'support': 182076}, '1': {'precision': 0.3663391480701202, 'recall': 0.5538731099526272, 'f1-score': 0.4409969579735324, 'support': 184916}, '2': {'precision': 0.3921710665065058, 'recall': 0.22567964033939802, 'f1-score': 0.28649323941869387, 'support': 189512}, 'accuracy': 0.3632318905165102, 'macro avg': {'precision': 0.3659222607195612, 'recall': 0.3641132394570962, 'f1-score': 0.35099156690519867, 'support': 556504}, 'weighted avg': {'precision': 0.3662751244544261, 'recall': 0.3632318905165102, 'f1-score': 0.35058906440287063, 'support': 556504}}
[[ 56951  86439  38686]
 [ 54894 102420  27602]
 [ 56025  90718  42769]]
training model: results/universal/W2/deepOF_L1/h300
Epoch 1/50
9940/9940 - 204s - loss: 3.2555 - accuracy300: 0.3904 - val_loss: 3.2855 - val_accuracy300: 0.3712 - 204s/epoch - 20ms/step
Epoch 2/50
9940/9940 - 200s - loss: 3.2593 - accuracy300: 0.3869 - val_loss: 3.2840 - val_accuracy300: 0.3726 - 200s/epoch - 20ms/step
Epoch 3/50
9940/9940 - 201s - loss: 3.2583 - accuracy300: 0.3877 - val_loss: 3.2832 - val_accuracy300: 0.3729 - 201s/epoch - 20ms/step
Epoch 4/50
9940/9940 - 199s - loss: 3.2552 - accuracy300: 0.3898 - val_loss: 3.2823 - val_accuracy300: 0.3732 - 199s/epoch - 20ms/step
Epoch 5/50
9940/9940 - 200s - loss: 3.2523 - accuracy300: 0.3917 - val_loss: 3.2828 - val_accuracy300: 0.3716 - 200s/epoch - 20ms/step
Epoch 6/50
9940/9940 - 200s - loss: 3.2510 - accuracy300: 0.3925 - val_loss: 3.2837 - val_accuracy300: 0.3690 - 200s/epoch - 20ms/step
Epoch 7/50
9940/9940 - 201s - loss: 3.2491 - accuracy300: 0.3940 - val_loss: 3.2846 - val_accuracy300: 0.3681 - 201s/epoch - 20ms/step
Epoch 8/50
9940/9940 - 200s - loss: 3.2474 - accuracy300: 0.3952 - val_loss: 3.2845 - val_accuracy300: 0.3684 - 200s/epoch - 20ms/step
Epoch 9/50
9940/9940 - 199s - loss: 3.2449 - accuracy300: 0.3967 - val_loss: 3.2853 - val_accuracy300: 0.3676 - 199s/epoch - 20ms/step
Epoch 10/50
9940/9940 - 200s - loss: 3.2432 - accuracy300: 0.3981 - val_loss: 3.2855 - val_accuracy300: 0.3657 - 200s/epoch - 20ms/step
Epoch 11/50
9940/9940 - 199s - loss: 3.2416 - accuracy300: 0.3991 - val_loss: 3.2855 - val_accuracy300: 0.3664 - 199s/epoch - 20ms/step
Epoch 12/50
9940/9940 - 200s - loss: 3.2405 - accuracy300: 0.4000 - val_loss: 3.2850 - val_accuracy300: 0.3681 - 200s/epoch - 20ms/step
Epoch 13/50
9940/9940 - 201s - loss: 3.2388 - accuracy300: 0.4014 - val_loss: 3.2838 - val_accuracy300: 0.3694 - 201s/epoch - 20ms/step
Epoch 14/50
9940/9940 - 200s - loss: 3.2378 - accuracy300: 0.4021 - val_loss: 3.2835 - val_accuracy300: 0.3695 - 200s/epoch - 20ms/step
testing model in sample: results/universal/W2/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 315s - 315s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951644
{'0': {'precision': 0.35992908425320885, 'recall': 0.5572332052056723, 'f1-score': 0.4373586650264253, 'support': 2202751}, '1': {'precision': 0.3465288602191794, 'recall': 0.03160784279414853, 'f1-score': 0.05793158743999118, 'support': 2285920}, '2': {'precision': 0.3679290263201585, 'recall': 0.5113246744170106, 'f1-score': 0.4279338021187582, 'support': 2232073}, 'accuracy': 0.36320577007545596, 'macro avg': {'precision': 0.3581289902641822, 'recall': 0.3667219074722771, 'f1-score': 0.30774135152839155, 'support': 6720744}, 'weighted avg': {'precision': 0.358028195685713, 'recall': 0.36320577007545596, 'f1-score': 0.3051743522150332, 'support': 6720744}}
[[1227446   68189  907116]
 [1160102   72253 1053565]
 [1022696   68063 1141314]]
Evaluating performance on  train set...
9940/9940 - 126s - 126s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956794
{'0': {'precision': 0.36253922425718765, 'recall': 0.5609200119341171, 'f1-score': 0.4404211859651592, 'support': 847989}, '1': {'precision': 0.34043388632570926, 'recall': 0.03306190885333187, 'f1-score': 0.060270526552464614, 'support': 839153}, '2': {'precision': 0.36858021277853714, 'recall': 0.49494615733989356, 'f1-score': 0.42251717214203377, 'support': 856477}, 'accuracy': 0.36456246002251125, 'macro avg': {'precision': 0.35718444112047804, 'recall': 0.3629760260424475, 'f1-score': 0.3077362948865525, 'support': 2543619}, 'weighted avg': {'precision': 0.3572806564782026, 'recall': 0.36456246002251125, 'f1-score': 0.3089789604017671, 'support': 2543619}}
[[475654  27063 345272]
 [430475  27744 380934]
 [405878  26689 423910]]
Evaluating performance on  val set...
3393/3393 - 42s - 42s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941366
{'0': {'precision': 0.37079505930616247, 'recall': 0.5669244902898556, 'f1-score': 0.4483489761724716, 'support': 293353}, '1': {'precision': 0.32091587711742753, 'recall': 0.032133334291607675, 'f1-score': 0.05841733574615701, 'support': 278278}, '2': {'precision': 0.3796537647530374, 'recall': 0.5016326420466045, 'f1-score': 0.43220165341618333, 'support': 296452}, 'accuracy': 0.373191273184707, 'macro avg': {'precision': 0.3571215670588758, 'recall': 0.366896822209356, 'f1-score': 0.31298932177827066, 'support': 868083}, 'weighted avg': {'precision': 0.35783074815851895, 'recall': 0.373191273184707, 'f1-score': 0.3178357612376081, 'support': 868083}}
[[166309   9520 117524]
 [143871   8942 125465]
 [138340   9402 148710]]
testing model out of sample: results/universal/W2/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 173s - 173s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093898
{'0': {'precision': 0.37086042943405295, 'recall': 0.5612846482388714, 'f1-score': 0.4466220348451999, 'support': 1248404}, '1': {'precision': 0.335990648940017, 'recall': 0.0357219171015493, 'f1-score': 0.06457801648270833, 'support': 1118501}, '2': {'precision': 0.3901122424736519, 'recall': 0.49773080997658875, 'f1-score': 0.4373991143870025, 'support': 1299803}, 'accuracy': 0.37843673398590777, 'macro avg': {'precision': 0.36565444028257393, 'recall': 0.3649124584390031, 'f1-score': 0.31619972190497025, 'support': 3666708}, 'weighted avg': {'precision': 0.36704820331513377, 'recall': 0.37843673398590777, 'f1-score': 0.32681304098400576, 'support': 3666708}}
[[700710  39201 508493]
 [575617  39955 502929]
 [613090  39761 646952]]
Evaluating performance on  train set...
5373/5373 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952629
{'0': {'precision': 0.363545820638599, 'recall': 0.599630057604084, 'f1-score': 0.45265461126160245, 'support': 463856}, '1': {'precision': 0.3537354352296093, 'recall': 0.03440490819358122, 'f1-score': 0.06271048799800726, 'support': 450023}, '2': {'precision': 0.36981504742622834, 'recall': 0.45406705725918584, 'f1-score': 0.4076331537243707, 'support': 461009}, 'accuracy': 0.3658145245285434, 'macro avg': {'precision': 0.3623654344314789, 'recall': 0.36270067435228376, 'f1-score': 0.30766608432799347, 'support': 1374888}, 'weighted avg': {'precision': 0.3624368364153229, 'recall': 0.3658145245285434, 'f1-score': 0.3099236242275789, 'support': 1374888}}
[[278142  14888 170826]
 [248658  15483 185882]
 [238281  13399 209329]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953064
{'0': {'precision': 0.3637803567864589, 'recall': 0.5883156839314901, 'f1-score': 0.44957164036158015, 'support': 145614}, '1': {'precision': 0.35259193619849355, 'recall': 0.02842630165171172, 'f1-score': 0.0526110497748924, 'support': 139976}, '2': {'precision': 0.3699270771590001, 'recall': 0.46889625652230854, 'f1-score': 0.41357319163941, 'support': 145079}, 'accuracy': 0.36611179351195466, 'macro avg': {'precision': 0.36209979004798426, 'recall': 0.36187941403517015, 'f1-score': 0.30525196059196086, 'support': 430669}, 'weighted avg': {'precision': 0.36221453636452666, 'recall': 0.36611179351195466, 'f1-score': 0.308424786118238, 'support': 430669}}
[[85667  3630 56317]
 [76448  3979 59549]
 [73376  3676 68027]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008632
{'0': {'precision': 0.31638042651723264, 'recall': 0.5763221603813612, 'f1-score': 0.40850570747477966, 'support': 80134}, '1': {'precision': 0.2817246447819696, 'recall': 0.013061502640695099, 'f1-score': 0.024965536704766242, 'support': 88045}, '2': {'precision': 0.377068384829404, 'recall': 0.45812527428212213, 'f1-score': 0.413663478735823, 'support': 84311}, 'accuracy': 0.3404412055923007, 'macro avg': {'precision': 0.32505781870953543, 'recall': 0.3491696457680595, 'f1-score': 0.28237824097178965, 'support': 252490}, 'weighted avg': {'precision': 0.3245605292950704, 'recall': 0.3404412055923007, 'f1-score': 0.2764848849366356, 'support': 252490}}
[[46183  1397 32554]
 [55639  1150 31256]
 [44151  1535 38625]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097115
{'0': {'precision': 0.3486146982859826, 'recall': 0.5923598643526831, 'f1-score': 0.4389180400561673, 'support': 20052}, '1': {'precision': 0.32565284178187404, 'recall': 0.02112711146544422, 'f1-score': 0.03967994010575079, 'support': 20069}, '2': {'precision': 0.36544269591479894, 'recall': 0.4504089729147279, 'f1-score': 0.4035014589412256, 'support': 20417}, 'accuracy': 0.3551157950378275, 'macro avg': {'precision': 0.3465700786608852, 'recall': 0.3546319829109517, 'f1-score': 0.29403314636771455, 'support': 60538}, 'weighted avg': {'precision': 0.346677992901044, 'recall': 0.3551157950378275, 'f1-score': 0.2946217341899564, 'support': 60538}}
[[11878   469  7705]
 [11382   424  8263]
 [10812   409  9196]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999124
{'0': {'precision': 0.3408106435643564, 'recall': 0.6088999447208402, 'f1-score': 0.43701646498710567, 'support': 7236}, '1': {'precision': 0.40476190476190477, 'recall': 0.020762654362871488, 'f1-score': 0.03949916096553504, 'support': 7369}, '2': {'precision': 0.3505005427572066, 'recall': 0.4156178489702517, 'f1-score': 0.38029182752077473, 'support': 6992}, 'accuracy': 0.345649858776682, 'macro avg': {'precision': 0.36535769702782256, 'recall': 0.3484268160179878, 'f1-score': 0.28560248449113845, 'support': 21597}, 'weighted avg': {'precision': 0.3657682126212227, 'recall': 0.345649858776682, 'f1-score': 0.28301712811163504, 'support': 21597}}
[[4406  113 2717]
 [4548  153 2668]
 [3974  112 2906]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953239
{'0': {'precision': 0.3414553522048961, 'recall': 0.5448717298465221, 'f1-score': 0.4198210168431748, 'support': 98581}, '1': {'precision': 0.34832443783358125, 'recall': 0.03623043319985439, 'f1-score': 0.06563404199193794, 'support': 109880}, '2': {'precision': 0.3773548196650923, 'recall': 0.5144558367555999, 'f1-score': 0.4353668306313349, 'support': 109333}, 'accuracy': 0.3585404381454653, 'macro avg': {'precision': 0.35571153656785653, 'recall': 0.36518599993399214, 'f1-score': 0.30694062982214926, 'support': 317794}, 'weighted avg': {'precision': 0.35618115446895887, 'recall': 0.3585404381454653, 'f1-score': 0.30270617409047024, 'support': 317794}}
[[53714  3603 41264]
 [54354  3981 51545]
 [49241  3845 56247]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0844058
{'0': {'precision': 0.39109347442680775, 'recall': 0.5725382834757835, 'f1-score': 0.46473351400180674, 'support': 44928}, '1': {'precision': 0.3612153708668454, 'recall': 0.0455026455026455, 'f1-score': 0.08082383523295342, 'support': 44415}, '2': {'precision': 0.4019607843137255, 'recall': 0.5605222734254992, 'f1-score': 0.46818065178342316, 'support': 45570}, 'accuracy': 0.39497305671062094, 'macro avg': {'precision': 0.38475654320245956, 'recall': 0.39285440080130946, 'f1-score': 0.3379126670060611, 'support': 134913}, 'weighted avg': {'precision': 0.38492792582831176, 'recall': 0.39497305671062094, 'f1-score': 0.33951013068210917, 'support': 134913}}
[[25723  1775 17430]
 [21821  2021 20573]
 [18228  1799 25543]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0872681
{'0': {'precision': 0.406122357376902, 'recall': 0.6098267843903754, 'f1-score': 0.4875525379890074, 'support': 14837}, '1': {'precision': 0.33672670321064996, 'recall': 0.03148107474924958, 'f1-score': 0.05757900374933046, 'support': 13659}, '2': {'precision': 0.35585162577767343, 'recall': 0.5011572160687717, 'f1-score': 0.4161861614497529, 'support': 12098}, 'accuracy': 0.38283982854609055, 'macro avg': {'precision': 0.3662335621217418, 'recall': 0.38082169173613223, 'f1-score': 0.3204392343960303, 'support': 40594}, 'weighted avg': {'precision': 0.3677903242896402, 'recall': 0.38283982854609055, 'f1-score': 0.3216068581458866, 'support': 40594}}
[[9048  397 5392]
 [7646  430 5583]
 [5585  450 6063]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971057
{'0': {'precision': 0.35286421094777787, 'recall': 0.5485007446264643, 'f1-score': 0.4294515362727439, 'support': 89978}, '1': {'precision': 0.3031829170024174, 'recall': 0.038255741538617966, 'f1-score': 0.06793892268279746, 'support': 78681}, '2': {'precision': 0.411522633744856, 'recall': 0.48508275777127213, 'f1-score': 0.44528515208836134, 'support': 105549}, 'accuracy': 0.377680446959972, 'macro avg': {'precision': 0.35585658723168373, 'recall': 0.3572797479787848, 'f1-score': 0.3142252036813009, 'support': 274208}, 'weighted avg': {'precision': 0.36118768793930944, 'recall': 0.377680446959972, 'f1-score': 0.33181415284794236, 'support': 274208}}
[[49353  3088 37537]
 [39992  3010 35679]
 [50519  3830 51200]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968723
{'0': {'precision': 0.36123149377489416, 'recall': 0.5826027231222981, 'f1-score': 0.4459563940003093, 'support': 24751}, '1': {'precision': 0.3732933732933733, 'recall': 0.0460256199704385, 'f1-score': 0.08194743959940055, 'support': 24356}, '2': {'precision': 0.35296071203214774, 'recall': 0.44420295912396557, 'f1-score': 0.3933601051131632, 'support': 23926}, 'accuracy': 0.3583174729231991, 'macro avg': {'precision': 0.3624951930334717, 'recall': 0.3576104340722341, 'f1-score': 0.3070879795709577, 'support': 73033}, 'weighted avg': {'precision': 0.36254449493293406, 'recall': 0.3583174729231991, 'f1-score': 0.3073311026758068, 'support': 73033}}
[[14420   954  9377]
 [13129  1121 10106]
 [12370   928 10628]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953681
{'0': {'precision': 0.3544891640866873, 'recall': 0.5914867238351069, 'f1-score': 0.4433001664795385, 'support': 9679}, '1': {'precision': 0.3494718309859155, 'recall': 0.04101239669421487, 'f1-score': 0.07340976331360946, 'support': 9680}, '2': {'precision': 0.38640900742633555, 'recall': 0.4630622009569378, 'f1-score': 0.4212771514386453, 'support': 10450}, 'accuracy': 0.3677077392733738, 'macro avg': {'precision': 0.36345666749964617, 'recall': 0.3651871071620865, 'f1-score': 0.31266236041059775, 'support': 29809}, 'weighted avg': {'precision': 0.3640498530894668, 'recall': 0.3677077392733738, 'f1-score': 0.31546362014039503, 'support': 29809}}
[[5725  308 3646]
 [5245  397 4038]
 [5180  431 4839]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0918111
{'0': {'precision': 0.3606639678694377, 'recall': 0.6212543410522848, 'f1-score': 0.45638023787555654, 'support': 72851}, '1': {'precision': 0.3330602883355177, 'recall': 0.034083860043254484, 'f1-score': 0.06183936365986829, 'support': 59647}, '2': {'precision': 0.46438475556611997, 'recall': 0.4691963724111115, 'f1-score': 0.46677816460736793, 'support': 87441}, 'accuracy': 0.401561342008466, 'macro avg': {'precision': 0.3860363372570252, 'recall': 0.37484485783555027, 'f1-score': 0.32833258871426424, 'support': 219939}, 'weighted avg': {'precision': 0.39441411097196105, 'recall': 0.401561342008466, 'f1-score': 0.35351546894877756, 'support': 219939}}
[[45259  1936 25656]
 [35950  2033 21664]
 [44279  2135 41027]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983918
{'0': {'precision': 0.3601890245314925, 'recall': 0.5662418062636563, 'f1-score': 0.4403007263305441, 'support': 27460}, '1': {'precision': 0.31724461105904406, 'recall': 0.02514298447597118, 'f1-score': 0.04659325533379215, 'support': 26926}, '2': {'precision': 0.35513222277200507, 'recall': 0.47331013006045064, 'f1-score': 0.40579209398018, 'support': 27295}, 'accuracy': 0.3568149263598634, 'macro avg': {'precision': 0.34418861945418056, 'recall': 0.3548983069333594, 'f1-score': 0.29756202521483877, 'support': 81681}, 'weighted avg': {'precision': 0.3443426626947819, 'recall': 0.3568149263598634, 'f1-score': 0.2989841351519134, 'support': 81681}}
[[15549   757 11154]
 [13944   677 12305]
 [13676   700 12919]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983104
{'0': {'precision': 0.3641527511634273, 'recall': 0.6134424717546691, 'f1-score': 0.45701279738898914, 'support': 8674}, '1': {'precision': 0.31917808219178084, 'recall': 0.029829727307643068, 'f1-score': 0.05456035593021895, 'support': 7811}, '2': {'precision': 0.3669820147624493, 'recall': 0.41647003303445024, 'f1-score': 0.39016302846090073, 'support': 8476}, 'accuracy': 0.36392772725451705, 'macro avg': {'precision': 0.3501042827058858, 'recall': 0.3532474106989208, 'f1-score': 0.30057872726003626, 'support': 24961}, 'weighted avg': {'precision': 0.35103964267129073, 'recall': 0.36392772725451705, 'f1-score': 0.3083739342958065, 'support': 24961}}
[[5321  244 3109]
 [4598  233 2980]
 [4693  253 3530]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017985
{'0': {'precision': 0.31390541184426923, 'recall': 0.5487509152341992, 'f1-score': 0.39936154558764936, 'support': 148869}, '1': {'precision': 0.38786602683380667, 'recall': 0.044291234014952, 'f1-score': 0.07950376641691048, 'support': 178839}, '2': {'precision': 0.34799376816026917, 'recall': 0.44891680948916807, 'f1-score': 0.3920646971091979, 'support': 162206}, 'accuracy': 0.33154798597304835, 'macro avg': {'precision': 0.34992173561278167, 'recall': 0.34731965291277306, 'f1-score': 0.29031000303791926, 'support': 489914}, 'weighted avg': {'precision': 0.35219045442053154, 'recall': 0.33154798597304835, 'f1-score': 0.28018422472437243, 'support': 489914}}
[[81692  6245 60932]
 [95419  7921 75499]
 [83133  6256 72817]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008031
{'0': {'precision': 0.3505803154535286, 'recall': 0.5528977649743482, 'f1-score': 0.42908638750031397, 'support': 61789}, '1': {'precision': 0.3553951062976334, 'recall': 0.04373796712247618, 'f1-score': 0.07789010989010989, 'support': 60771}, '2': {'precision': 0.34888749568176874, 'recall': 0.45053946433587233, 'f1-score': 0.39325064897605994, 'support': 60523}, 'accuracy': 0.3500543469355429, 'macro avg': {'precision': 0.35162097247764357, 'recall': 0.34905839881089884, 'f1-score': 0.30007571545549455, 'support': 183083}, 'weighted avg': {'precision': 0.3516188887964434, 'recall': 0.3500543469355429, 'f1-score': 0.3006668434172853, 'support': 183083}}
[[34163  2505 25121]
 [32345  2658 25768]
 [30939  2316 27268]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003146
{'0': {'precision': 0.34818589064049515, 'recall': 0.5584073708456729, 'f1-score': 0.4289234787370727, 'support': 18234}, '1': {'precision': 0.32074468085106383, 'recall': 0.033670221676252166, 'f1-score': 0.06094294810248118, 'support': 17909}, '2': {'precision': 0.35574348731460625, 'recall': 0.4522176003457404, 'f1-score': 0.39822082679225534, 'support': 18511}, 'accuracy': 0.3504958465986021, 'macro avg': {'precision': 0.3415580196020551, 'recall': 0.3480983976225551, 'f1-score': 0.2960290845439364, 'support': 54654}, 'weighted avg': {'precision': 0.3417536815783139, 'recall': 0.3504958465986021, 'f1-score': 0.2979449572512636, 'support': 54654}}
[[10182   644  7408]
 [ 9554   603  7752]
 [ 9507   633  8371]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/EXC
Evaluating performance on  test set...
4918/4918 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931591
{'0': {'precision': 0.3706350000161323, 'recall': 0.5475394364619554, 'f1-score': 0.4420451517259226, 'support': 419599}, '1': {'precision': 0.3328485008760041, 'recall': 0.07404620196691736, 'f1-score': 0.12114272880944695, 'support': 407948}, '2': {'precision': 0.38752150191442286, 'recall': 0.4925768687672014, 'f1-score': 0.4337790736849843, 'support': 431287}, 'accuracy': 0.37526472910645886, 'macro avg': {'precision': 0.3636683342688531, 'recall': 0.3713875023986914, 'f1-score': 0.3323223180734513, 'support': 1258834}, 'weighted avg': {'precision': 0.3641750553315996, 'recall': 0.37526472910645886, 'f1-score': 0.33521887151425644, 'support': 1258834}}
[[229747  30157 159695]
 [201671  30207 176070]
 [188456  30389 212442]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935516
{'0': {'precision': 0.3721646737501249, 'recall': 0.5550257059831607, 'f1-score': 0.44556320968208235, 'support': 120789}, '1': {'precision': 0.3362969895492123, 'recall': 0.07325857968059803, 'f1-score': 0.12030914316006808, 'support': 117720}, '2': {'precision': 0.3796590033812452, 'recall': 0.48279668965975214, 'f1-score': 0.42506093127098793, 'support': 120471}, 'accuracy': 0.3728007131316508, 'macro avg': {'precision': 0.3627068888935275, 'recall': 0.37036032510783695, 'f1-score': 0.33031109470437947, 'support': 358980}, 'weighted avg': {'precision': 0.3629176560913675, 'recall': 0.3728007131316508, 'f1-score': 0.3320225146755793, 'support': 358980}}
[[67041  8737 45011]
 [59072  8624 50024]
 [54025  8283 58163]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0919759
{'0': {'precision': 0.3949599544251198, 'recall': 0.5455344951283297, 'f1-score': 0.45819362237707867, 'support': 43209}, '1': {'precision': 0.30115303983228514, 'recall': 0.07987211565193217, 'f1-score': 0.12625796528235553, 'support': 35970}, '2': {'precision': 0.4070736905073466, 'recall': 0.5001722672669224, 'f1-score': 0.4488462450144799, 'support': 43537}, 'accuracy': 0.39294794484826756, 'macro avg': {'precision': 0.36772889492158384, 'recall': 0.37519295934906144, 'f1-score': 0.34443261089130467, 'support': 122716}, 'weighted avg': {'precision': 0.37176135774585745, 'recall': 0.39294794484826756, 'f1-score': 0.357581784035439, 'support': 122716}}
[[23572  3368 16269]
 [17648  2873 15449]
 [18462  3299 21776]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/AAL
Evaluating performance on  test set...
4856/4856 - 60s - 60s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092065
{'0': {'precision': 0.39697708498562306, 'recall': 0.5469536242181141, 'f1-score': 0.46005083476432185, 'support': 444758}, '1': {'precision': 0.3233259578432514, 'recall': 0.03828524465380012, 'f1-score': 0.0684636610452027, 'support': 362594}, '2': {'precision': 0.3850921099017506, 'recall': 0.5191574751806919, 'f1-score': 0.4421864290274922, 'support': 435548}, 'accuracy': 0.3888180867326414, 'macro avg': {'precision': 0.36846505091020837, 'recall': 0.36813211468420204, 'f1-score': 0.32356697494567227, 'support': 1242900}, 'weighted avg': {'precision': 0.37132583876879827, 'recall': 0.3888180867326414, 'f1-score': 0.3395520288608904, 'support': 1242900}}
[[243262  15060 186436]
 [174087  13882 174625]
 [195437  13993 226118]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0942538
{'0': {'precision': 0.36410717116736246, 'recall': 0.6191241056285031, 'f1-score': 0.4585442550943585, 'support': 178058}, '1': {'precision': 0.3650363434766539, 'recall': 0.03381397180076803, 'f1-score': 0.06189454114378522, 'support': 175253}, '2': {'precision': 0.372514217920229, 'recall': 0.4442753749319199, 'f1-score': 0.40524241562891317, 'support': 178099}, 'accuracy': 0.3674959071150336, 'macro avg': {'precision': 0.3672192441880818, 'recall': 0.3657378174537303, 'f1-score': 0.3085604039556856, 'support': 531410}, 'weighted avg': {'precision': 0.36723117495795543, 'recall': 0.3674959071150336, 'f1-score': 0.30986986690833235, 'support': 531410}}
[[110240   5400  62418]
 [ 98462   5926  70865]
 [ 94066   4908  79125]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941955
{'0': {'precision': 0.3706066779714777, 'recall': 0.596169319229939, 'f1-score': 0.4570745064997593, 'support': 50957}, '1': {'precision': 0.3603707995365006, 'recall': 0.03166554666340848, 'f1-score': 0.058215716371532326, 'support': 49107}, '2': {'precision': 0.3687054854429589, 'recall': 0.4698085419734904, 'f1-score': 0.4131618097488404, 'support': 50246}, 'accuracy': 0.3695030270773734, 'macro avg': {'precision': 0.3665609876503124, 'recall': 0.3658811359556126, 'f1-score': 0.30948401087337735, 'support': 150310}, 'weighted avg': {'precision': 0.3666270318927446, 'recall': 0.3695030270773734, 'f1-score': 0.3120861759311111, 'support': 150310}}
[[30379  1376 19202]
 [26336  1555 21216]
 [25256  1384 23606]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/WBA
Evaluating performance on  test set...
4353/4353 - 53s - 53s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0872079
{'0': {'precision': 0.41277594206653445, 'recall': 0.5561857418907556, 'f1-score': 0.4738682599611451, 'support': 406758}, '1': {'precision': 0.36238723108952114, 'recall': 0.030208107365467772, 'f1-score': 0.05576751077945829, 'support': 345735}, '2': {'precision': 0.3754805670411957, 'recall': 0.5577213300533459, 'f1-score': 0.44880646280594677, 'support': 361790}, 'accuracy': 0.39348621490231833, 'macro avg': {'precision': 0.38354791339908373, 'recall': 0.38137172643652306, 'f1-score': 0.3261474111821834, 'support': 1114283}, 'weighted avg': {'precision': 0.3850323305064057, 'recall': 0.39348621490231833, 'f1-score': 0.33600456634730586, 'support': 1114283}}
[[226233   9963 170562]
 [170245  10444 165046]
 [151599   8413 201778]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923587
{'0': {'precision': 0.3787647133770447, 'recall': 0.5724644121524537, 'f1-score': 0.45589293508393197, 'support': 135018}, '1': {'precision': 0.350458087164997, 'recall': 0.03135365358540864, 'f1-score': 0.057557902434222555, 'support': 130543}, '2': {'precision': 0.36795159296934854, 'recall': 0.5100425578096294, 'f1-score': 0.4274993665087811, 'support': 129001}, 'accuracy': 0.37302629244580066, 'macro avg': {'precision': 0.3657247978371301, 'recall': 0.3712868745158306, 'f1-score': 0.3136500680089786, 'support': 394562}, 'weighted avg': {'precision': 0.3658639899132733, 'recall': 0.37302629244580066, 'f1-score': 0.314818404574268, 'support': 394562}}
[[77293  3759 53966]
 [67395  4093 59055]
 [59378  3827 65796]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.091072
{'0': {'precision': 0.386081363665167, 'recall': 0.5640129599629715, 'f1-score': 0.45838584084112327, 'support': 43210}, '1': {'precision': 0.33819628647214856, 'recall': 0.02736198293899887, 'f1-score': 0.050627885044919836, 'support': 37278}, '2': {'precision': 0.38886459444804, 'recall': 0.5191611592442961, 'f1-score': 0.44466446644664465, 'support': 42821}, 'accuracy': 0.38620052064326205, 'macro avg': {'precision': 0.3710474148617852, 'recall': 0.3701787007154221, 'f1-score': 0.3178927307775626, 'support': 123309}, 'weighted avg': {'precision': 0.3725715697146205, 'recall': 0.38620052064326205, 'f1-score': 0.3303500604105234, 'support': 123309}}
[[24371  1022 17817]
 [19137  1020 17121]
 [19616   974 22231]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
5497/5497 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0908735
{'0': {'precision': 0.3835661102396723, 'recall': 0.5776897444626701, 'f1-score': 0.46102649388286043, 'support': 484665}, '1': {'precision': 0.3327494781294239, 'recall': 0.03379619926792773, 'f1-score': 0.0613602525557554, 'support': 410342}, '2': {'precision': 0.40673008540445965, 'recall': 0.5047023657282761, 'f1-score': 0.45045057603857275, 'support': 512189}, 'accuracy': 0.3925231453187758, 'macro avg': {'precision': 0.37434855792451865, 'recall': 0.3720627698196246, 'f1-score': 0.3242791074923962, 'support': 1407196}, 'weighted avg': {'precision': 0.3771790361023764, 'recall': 0.3925231453187758, 'f1-score': 0.3406333762337236, 'support': 1407196}}
[[279986  13554 191125]
 [210538  13868 185936]
 [239431  14255 258503]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0936937
{'0': {'precision': 0.37082680196903445, 'recall': 0.6019608718458087, 'f1-score': 0.45893514283891007, 'support': 179206}, '1': {'precision': 0.3489500223399502, 'recall': 0.032239612204701194, 'f1-score': 0.059025809620980245, 'support': 169574}, '2': {'precision': 0.377820052394292, 'recall': 0.4673900833501831, 'f1-score': 0.41785903484083486, 'support': 178044}, 'accuracy': 0.37309993470305075, 'macro avg': {'precision': 0.36586562556775887, 'recall': 0.367196855800231, 'f1-score': 0.3119399957669084, 'support': 526824}, 'weighted avg': {'precision': 0.3661485284847061, 'recall': 0.37309993470305075, 'f1-score': 0.31633044023707996, 'support': 526824}}
[[107875   5205  66126]
 [ 93196   5467  70911]
 [ 89833   4995  83216]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943182
{'0': {'precision': 0.36894628705606103, 'recall': 0.5914498890905424, 'f1-score': 0.4544233848060734, 'support': 59508}, '1': {'precision': 0.34197038724373574, 'recall': 0.021480567330221245, 'f1-score': 0.04042205879878162, 'support': 55911}, '2': {'precision': 0.3766099401785359, 'recall': 0.4822180706521739, 'f1-score': 0.4229208094078394, 'support': 58880}, 'accuracy': 0.37171756579211584, 'macro avg': {'precision': 0.36250887149277755, 'recall': 0.3650495090243125, 'f1-score': 0.3059220843375648, 'support': 174299}, 'weighted avg': {'precision': 0.36288191698764066, 'recall': 0.37171756579211584, 'f1-score': 0.3109796485950699, 'support': 174299}}
[[35196  1147 23165]
 [30877  1201 23833]
 [29323  1164 28393]]
testing model on single stock: results/universal/W2/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
14883/14883 - 176s - 176s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983452
{'0': {'precision': 0.342999161777888, 'recall': 0.5579536948053133, 'f1-score': 0.424833881663651, 'support': 1204962}, '1': {'precision': 0.35621090007326833, 'recall': 0.018552002994033947, 'f1-score': 0.03526723499353413, 'support': 1362710}, '2': {'precision': 0.3540547362550813, 'recall': 0.5069947239704337, 'f1-score': 0.4169420958258456, 'support': 1242222}, 'accuracy': 0.3484070685431143, 'macro avg': {'precision': 0.3510882660354125, 'recall': 0.3611668072565936, 'f1-score': 0.29234773749434356, 'support': 3809894}, 'weighted avg': {'precision': 0.3513293792933112, 'recall': 0.3484070685431143, 'f1-score': 0.28292187175711675, 'support': 3809894}}
[[672313  22485 510164]
 [698572  25281 638857]
 [589216  23206 629800]]
Evaluating performance on  train set...
6147/6147 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977905
{'0': {'precision': 0.35406812453081227, 'recall': 0.5580383767415553, 'f1-score': 0.4332467780757549, 'support': 519794}, '1': {'precision': 0.33483016061048515, 'recall': 0.023393366169504704, 'f1-score': 0.04373137980167239, 'support': 519549}, '2': {'precision': 0.36426682118089165, 'recall': 0.4896188265248811, 'f1-score': 0.41774186978721156, 'support': 534140}, 'accuracy': 0.35827778247365877, 'macro avg': {'precision': 0.35105503544072975, 'recall': 0.35701685647864706, 'f1-score': 0.2982400092215463, 'support': 1573483}, 'weighted avg': {'precision': 0.3511780182581874, 'recall': 0.35827778247365877, 'f1-score': 0.2993691782725515, 'support': 1573483}}
[[290065  12027 217702]
 [268673  12154 238722]
 [260497  12118 261525]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955825
{'0': {'precision': 0.360437157713744, 'recall': 0.5679985607039466, 'f1-score': 0.44101661050813595, 'support': 183423}, '1': {'precision': 0.33149920856259896, 'recall': 0.023959468293745914, 'f1-score': 0.04468899083967139, 'support': 183560}, '2': {'precision': 0.3743110387234595, 'recall': 0.5020314478682989, 'f1-score': 0.4288640927458886, 'support': 189520}, 'accuracy': 0.36608427986911124, 'macro avg': {'precision': 0.35541580166660075, 'recall': 0.36466315895533047, 'f1-score': 0.3048565646978986, 'support': 556503}, 'weighted avg': {'precision': 0.3556169285016411, 'recall': 0.36608427986911124, 'f1-score': 0.30615113263534016, 'support': 556503}}
[[104184   4427  74812]
 [ 94932   4398  84230]
 [ 89933   4442  95145]]
training model: results/universal/W2/deepOF_L1/h500
Epoch 1/50
9940/9940 - 202s - loss: 3.2677 - accuracy500: 0.3801 - val_loss: 3.3016 - val_accuracy500: 0.3633 - 202s/epoch - 20ms/step
Epoch 2/50
9940/9940 - 201s - loss: 3.2698 - accuracy500: 0.3781 - val_loss: 3.2964 - val_accuracy500: 0.3625 - 201s/epoch - 20ms/step
Epoch 3/50
9940/9940 - 199s - loss: 3.2662 - accuracy500: 0.3812 - val_loss: 3.2949 - val_accuracy500: 0.3610 - 199s/epoch - 20ms/step
Epoch 4/50
9940/9940 - 203s - loss: 3.2637 - accuracy500: 0.3835 - val_loss: 3.2936 - val_accuracy500: 0.3580 - 203s/epoch - 20ms/step
Epoch 5/50
9940/9940 - 202s - loss: 3.2621 - accuracy500: 0.3853 - val_loss: 3.2938 - val_accuracy500: 0.3581 - 202s/epoch - 20ms/step
Epoch 6/50
9940/9940 - 199s - loss: 3.2601 - accuracy500: 0.3868 - val_loss: 3.2915 - val_accuracy500: 0.3561 - 199s/epoch - 20ms/step
Epoch 7/50
9940/9940 - 201s - loss: 3.2581 - accuracy500: 0.3889 - val_loss: 3.2922 - val_accuracy500: 0.3545 - 201s/epoch - 20ms/step
Epoch 8/50
9940/9940 - 200s - loss: 3.2582 - accuracy500: 0.3892 - val_loss: 3.2926 - val_accuracy500: 0.3558 - 200s/epoch - 20ms/step
Epoch 9/50
9940/9940 - 204s - loss: 3.2570 - accuracy500: 0.3903 - val_loss: 3.2923 - val_accuracy500: 0.3589 - 204s/epoch - 21ms/step
Epoch 10/50
9940/9940 - 199s - loss: 3.2553 - accuracy500: 0.3918 - val_loss: 3.2927 - val_accuracy500: 0.3557 - 199s/epoch - 20ms/step
Epoch 11/50
9940/9940 - 200s - loss: 3.2546 - accuracy500: 0.3922 - val_loss: 3.2919 - val_accuracy500: 0.3579 - 200s/epoch - 20ms/step
Epoch 12/50
9940/9940 - 201s - loss: 3.2531 - accuracy500: 0.3932 - val_loss: 3.2926 - val_accuracy500: 0.3566 - 201s/epoch - 20ms/step
Epoch 13/50
9940/9940 - 200s - loss: 3.2522 - accuracy500: 0.3941 - val_loss: 3.2919 - val_accuracy500: 0.3571 - 200s/epoch - 20ms/step
Epoch 14/50
9940/9940 - 199s - loss: 3.2508 - accuracy500: 0.3950 - val_loss: 3.2913 - val_accuracy500: 0.3571 - 199s/epoch - 20ms/step
Epoch 15/50
9940/9940 - 199s - loss: 3.2497 - accuracy500: 0.3956 - val_loss: 3.2907 - val_accuracy500: 0.3569 - 199s/epoch - 20ms/step
Epoch 16/50
9940/9940 - 200s - loss: 3.2489 - accuracy500: 0.3963 - val_loss: 3.2928 - val_accuracy500: 0.3506 - 200s/epoch - 20ms/step
Epoch 17/50
9940/9940 - 199s - loss: 3.2482 - accuracy500: 0.3968 - val_loss: 3.2934 - val_accuracy500: 0.3499 - 199s/epoch - 20ms/step
Epoch 18/50
9940/9940 - 199s - loss: 3.2473 - accuracy500: 0.3975 - val_loss: 3.2898 - val_accuracy500: 0.3599 - 199s/epoch - 20ms/step
Epoch 19/50
9940/9940 - 201s - loss: 3.2464 - accuracy500: 0.3985 - val_loss: 3.2893 - val_accuracy500: 0.3628 - 201s/epoch - 20ms/step
Epoch 20/50
9940/9940 - 200s - loss: 3.2457 - accuracy500: 0.3986 - val_loss: 3.2890 - val_accuracy500: 0.3637 - 200s/epoch - 20ms/step
Epoch 21/50
9940/9940 - 199s - loss: 3.2456 - accuracy500: 0.3989 - val_loss: 3.2878 - val_accuracy500: 0.3664 - 199s/epoch - 20ms/step
Epoch 22/50
9940/9940 - 200s - loss: 3.2451 - accuracy500: 0.3991 - val_loss: 3.2878 - val_accuracy500: 0.3651 - 200s/epoch - 20ms/step
Epoch 23/50
9940/9940 - 200s - loss: 3.2446 - accuracy500: 0.3995 - val_loss: 3.2869 - val_accuracy500: 0.3659 - 200s/epoch - 20ms/step
Epoch 24/50
9940/9940 - 200s - loss: 3.2434 - accuracy500: 0.4004 - val_loss: 3.2874 - val_accuracy500: 0.3652 - 200s/epoch - 20ms/step
Epoch 25/50
9940/9940 - 200s - loss: 3.2429 - accuracy500: 0.4004 - val_loss: 3.2878 - val_accuracy500: 0.3638 - 200s/epoch - 20ms/step
Epoch 26/50
9940/9940 - 200s - loss: 3.2421 - accuracy500: 0.4013 - val_loss: 3.2872 - val_accuracy500: 0.3649 - 200s/epoch - 20ms/step
Epoch 27/50
9940/9940 - 199s - loss: 3.2412 - accuracy500: 0.4017 - val_loss: 3.2882 - val_accuracy500: 0.3610 - 199s/epoch - 20ms/step
Epoch 28/50
9940/9940 - 205s - loss: 3.2408 - accuracy500: 0.4021 - val_loss: 3.2879 - val_accuracy500: 0.3633 - 205s/epoch - 21ms/step
Epoch 29/50
9940/9940 - 201s - loss: 3.2402 - accuracy500: 0.4026 - val_loss: 3.2870 - val_accuracy500: 0.3628 - 201s/epoch - 20ms/step
Epoch 30/50
9940/9940 - 201s - loss: 3.2396 - accuracy500: 0.4026 - val_loss: 3.2875 - val_accuracy500: 0.3635 - 201s/epoch - 20ms/step
Epoch 31/50
9940/9940 - 204s - loss: 3.2391 - accuracy500: 0.4031 - val_loss: 3.2876 - val_accuracy500: 0.3596 - 204s/epoch - 21ms/step
Epoch 32/50
9940/9940 - 198s - loss: 3.2387 - accuracy500: 0.4037 - val_loss: 3.2886 - val_accuracy500: 0.3620 - 198s/epoch - 20ms/step
Epoch 33/50
9940/9940 - 199s - loss: 3.2385 - accuracy500: 0.4034 - val_loss: 3.2877 - val_accuracy500: 0.3629 - 199s/epoch - 20ms/step
testing model in sample: results/universal/W2/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 311s - 311s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973957
{'0': {'precision': 0.3538025021843125, 'recall': 0.4494787706188582, 'f1-score': 0.39594278892805024, 'support': 2188288}, '1': {'precision': 0.3464864347968635, 'recall': 0.08699682424804736, 'f1-score': 0.1390744341028048, 'support': 2332361}, '2': {'precision': 0.351011616126843, 'recall': 0.5352818855549419, 'f1-score': 0.42399083232706386, 'support': 2200095}, 'accuracy': 0.3517717681256718, 'macro avg': {'precision': 0.350433517702673, 'recall': 0.35725249347394916, 'f1-score': 0.31966935178597294, 'support': 6720744}, 'weighted avg': {'precision': 0.350349919448165, 'recall': 0.3517717681256718, 'f1-score': 0.3159811994244757, 'support': 6720744}}
[[ 983589  190431 1014268]
 [ 966315  202908 1163138]
 [ 830147  192277 1177671]]
Evaluating performance on  train set...
9940/9940 - 120s - 120s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966485
{'0': {'precision': 0.36194996750602576, 'recall': 0.4627668712158307, 'f1-score': 0.4061962752185919, 'support': 855703}, '1': {'precision': 0.3396561944279787, 'recall': 0.08782075495606609, 'f1-score': 0.13955776311752072, 'support': 828631}, '2': {'precision': 0.3594013215998109, 'recall': 0.5166807287454104, 'f1-score': 0.4239231626377466, 'support': 859285}, 'accuracy': 0.35883440090673957, 'macro avg': {'precision': 0.3536691611779384, 'recall': 0.3557561183057691, 'f1-score': 0.3232257336579531, 'support': 2543619}, 'weighted avg': {'precision': 0.3538263748308031, 'recall': 0.35883440090673957, 'f1-score': 0.32532233597499666, 'support': 2543619}}
[[395991  70500 389212]
 [353727  72771 402133]
 [344331  70978 443976]]
Evaluating performance on  val set...
3393/3393 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955914
{'0': {'precision': 0.36846479035591645, 'recall': 0.46776861191652713, 'f1-score': 0.4122204711185354, 'support': 293844}, '1': {'precision': 0.32760744500846023, 'recall': 0.08751559420709107, 'f1-score': 0.13813138519490897, 'support': 276545}, '2': {'precision': 0.368978395948439, 'recall': 0.5220226138249343, 'f1-score': 0.4323565620805019, 'support': 297694}, 'accuracy': 0.36523696466812505, 'macro avg': {'precision': 0.3550168771042719, 'recall': 0.35910227331618416, 'f1-score': 0.3275694727979821, 'support': 868083}, 'weighted avg': {'precision': 0.3556250074482315, 'recall': 0.36523696466812505, 'f1-score': 0.3318092975280865, 'support': 868083}}
[[137451  24911 131482]
 [118057  24202 134286]
 [117529  24762 155403]]
testing model out of sample: results/universal/W2/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 175s - 175s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963178
{'0': {'precision': 0.3614710208583791, 'recall': 0.4567564574064627, 'f1-score': 0.4035655788351081, 'support': 1236913}, '1': {'precision': 0.3209641996793094, 'recall': 0.11276354701284462, 'f1-score': 0.16689299633701563, 'support': 1123661}, '2': {'precision': 0.3795283229742429, 'recall': 0.4965807489890011, 'f1-score': 0.430235149746277, 'support': 1306134}, 'accuracy': 0.3655259704345151, 'macro avg': {'precision': 0.35398784783731047, 'recall': 0.35536691780276947, 'f1-score': 0.33356457497280023, 'support': 3666708}, 'weighted avg': {'precision': 0.35548999402147446, 'recall': 0.3655259704345151, 'f1-score': 0.34053745731850515, 'support': 3666708}}
[[564968 129302 542643]
 [479231 126708 517722]
 [518770 138763 648601]]
Evaluating performance on  train set...
5373/5373 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972501
{'0': {'precision': 0.3565509547572226, 'recall': 0.47863277673627763, 'f1-score': 0.4086692953615045, 'support': 458740}, '1': {'precision': 0.3491357882374979, 'recall': 0.10445618505034306, 'f1-score': 0.1608026360761489, 'support': 463917}, '2': {'precision': 0.35206197201263945, 'recall': 0.48288816998392414, 'f1-score': 0.4072256601563993, 'support': 452231}, 'accuracy': 0.353777180395785, 'macro avg': {'precision': 0.3525829050024533, 'recall': 0.35532571059018164, 'f1-score': 0.3255658638646843, 'support': 1374888}, 'weighted avg': {'precision': 0.35257239144014024, 'recall': 0.353777180395785, 'f1-score': 0.3245588706810038, 'support': 1374888}}
[[219568  46222 192950]
 [206505  48459 208953]
 [189738  44116 218377]]
Evaluating performance on  val set...
1685/1685 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985156
{'0': {'precision': 0.3480032599837001, 'recall': 0.4718198624460799, 'f1-score': 0.4005616474189174, 'support': 141181}, '1': {'precision': 0.3405425915386075, 'recall': 0.0963965415391225, 'f1-score': 0.15025950108823036, 'support': 148968}, '2': {'precision': 0.34572705731928216, 'recall': 0.48490606319385143, 'f1-score': 0.403656300631796, 'support': 140520}, 'accuracy': 0.34623109627115023, 'macro avg': {'precision': 0.34475763628052986, 'recall': 0.3510408223930179, 'f1-score': 0.31815914971298126, 'support': 430669}, 'weighted avg': {'precision': 0.3446799354459865, 'recall': 0.34623109627115023, 'f1-score': 0.3149921045330443, 'support': 430669}}
[[66612 13783 60786]
 [66444 14360 68164]
 [58356 14025 68139]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013387
{'0': {'precision': 0.3035369458128079, 'recall': 0.39959792477302203, 'f1-score': 0.34500559910414336, 'support': 77100}, '1': {'precision': 0.3606406268003226, 'recall': 0.09795126429107903, 'f1-score': 0.15405944167808303, 'support': 95864}, '2': {'precision': 0.34085616191688073, 'recall': 0.5355606971304983, 'f1-score': 0.4165806757662156, 'support': 79526}, 'accuracy': 0.32789417402669413, 'macro avg': {'precision': 0.33501124484333705, 'recall': 0.3443699620648664, 'f1-score': 0.30521523884948065, 'support': 252490}, 'weighted avg': {'precision': 0.33697207296271325, 'recall': 0.32789417402669413, 'f1-score': 0.2950520053425532, 'support': 252490}}
[[30809  8255 38036]
 [42148  9390 44326]
 [28543  8392 42591]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983925
{'0': {'precision': 0.3503410059676044, 'recall': 0.40748636588993553, 'f1-score': 0.3767591107036443, 'support': 20170}, '1': {'precision': 0.3540088383838384, 'recall': 0.11095172140878512, 'f1-score': 0.16895149141307625, 'support': 20216}, '2': {'precision': 0.3433738858890118, 'recall': 0.5238189757840412, 'f1-score': 0.4148229653790231, 'support': 20152}, 'accuracy': 0.3471868908784565, 'macro avg': {'precision': 0.3492412434134849, 'recall': 0.3474190210275873, 'f1-score': 0.32017785583191455, 'support': 60538}, 'weighted avg': {'precision': 0.3492466106506595, 'recall': 0.3471868908784565, 'f1-score': 0.320034804777451, 'support': 60538}}
[[ 8219  2038  9913]
 [ 7700  2243 10273]
 [ 7541  2055 10556]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015005
{'0': {'precision': 0.3271571099660125, 'recall': 0.42302239863907004, 'f1-score': 0.36896445131375577, 'support': 7054}, '1': {'precision': 0.39467645709040844, 'recall': 0.10622529644268774, 'f1-score': 0.16739659367396595, 'support': 8096}, '2': {'precision': 0.31009031756822375, 'recall': 0.4952691174189546, 'f1-score': 0.3813903487816531, 'support': 6447}, 'accuracy': 0.32583229152197063, 'macro avg': {'precision': 0.34397462820821484, 'recall': 0.34150560416690406, 'f1-score': 0.3059171312564583, 'support': 21597}, 'weighted avg': {'precision': 0.34737320589278775, 'recall': 0.32583229152197063, 'f1-score': 0.29711263789169695, 'support': 21597}}
[[2984  667 3403]
 [3535  860 3701]
 [2602  652 3193]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
1242/1242 - 15s - 15s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002913
{'0': {'precision': 0.28578897001488623, 'recall': 0.39190502806872585, 'f1-score': 0.3305389589759882, 'support': 82298}, '1': {'precision': 0.45103621978262654, 'recall': 0.11607262376970064, 'f1-score': 0.18463107405415097, 'support': 141937}, '2': {'precision': 0.3098075541383876, 'recall': 0.5576694919783238, 'f1-score': 0.3983280528304768, 'support': 93559}, 'accuracy': 0.31751071448800167, 'macro avg': {'precision': 0.34887758131196683, 'recall': 0.35521571460558343, 'f1-score': 0.30449936195353866, 'support': 317794}, 'weighted avg': {'precision': 0.3666648002769253, 'recall': 0.31751071448800167, 'f1-score': 0.2853290191085939, 'support': 317794}}
[[32253  9346 40699]
 [49925 16475 75537]
 [30678 10706 52175]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0912381
{'0': {'precision': 0.39203106183298037, 'recall': 0.41231192540344597, 'f1-score': 0.4019158107604705, 'support': 45793}, '1': {'precision': 0.34225829126461754, 'recall': 0.12148430411903466, 'f1-score': 0.1793193498166965, 'support': 44088}, '2': {'precision': 0.3763325926134286, 'recall': 0.5941996802273939, 'f1-score': 0.4608125096870856, 'support': 45032}, 'accuracy': 0.3779843306427105, 'macro avg': {'precision': 0.37020731523700884, 'recall': 0.37599863658329147, 'f1-score': 0.34734922342141755, 'support': 134913}, 'weighted avg': {'precision': 0.3705259780033061, 'recall': 0.3779843306427105, 'f1-score': 0.3488327377873265, 'support': 134913}}
[[18881  5141 21771]
 [16159  5356 22573]
 [13122  5152 26758]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097061
{'0': {'precision': 0.36904981833856765, 'recall': 0.43484254825134233, 'f1-score': 0.39925385563438925, 'support': 13782}, '1': {'precision': 0.37220843672456577, 'recall': 0.1124859392575928, 'f1-score': 0.17276130146847107, 'support': 16002}, '2': {'precision': 0.28736103283979714, 'recall': 0.5188714153561517, 'f1-score': 0.3698770153978041, 'support': 10810}, 'accuracy': 0.3301473124107011, 'macro avg': {'precision': 0.34287309596764354, 'recall': 0.3553999676216956, 'f1-score': 0.31396405750022144, 'support': 40594}, 'weighted avg': {'precision': 0.34854157673072, 'recall': 0.3301473124107011, 'f1-score': 0.30214843378090084, 'support': 40594}}
[[5993 1686 6103]
 [6395 1800 7807]
 [3851 1350 5609]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981294
{'0': {'precision': 0.3363580775345481, 'recall': 0.47004671299988604, 'f1-score': 0.3921207080907687, 'support': 87770}, '1': {'precision': 0.3007460938806919, 'recall': 0.11420258921878772, 'f1-score': 0.16554327808471456, 'support': 78711}, '2': {'precision': 0.4092089689637033, 'recall': 0.4621496932059744, 'f1-score': 0.434071083869899, 'support': 107727}, 'accuracy': 0.3647997140856576, 'macro avg': {'precision': 0.34877104679298104, 'recall': 0.3487996651415494, 'f1-score': 0.3305783566817941, 'support': 274208}, 'weighted avg': {'precision': 0.35475634868495187, 'recall': 0.3647997140856576, 'f1-score': 0.34356286892616317, 'support': 274208}}
[[41256  9340 37174]
 [35018  8989 34704]
 [46381 11560 49786]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981382
{'0': {'precision': 0.3507924019332359, 'recall': 0.5125636393496469, 'f1-score': 0.41652208728146267, 'support': 24356}, '1': {'precision': 0.35756056808688386, 'recall': 0.11924852730456934, 'f1-score': 0.17884965525475327, 'support': 25124}, '2': {'precision': 0.3389183238147664, 'recall': 0.41824820617331127, 'f1-score': 0.37442748816967253, 'support': 23553}, 'accuracy': 0.3468432078649378, 'macro avg': {'precision': 0.34909043127829537, 'recall': 0.3500201242758425, 'f1-score': 0.3232664102352962, 'support': 73033}, 'weighted avg': {'precision': 0.3492913441171793, 'recall': 0.3468432078649378, 'f1-score': 0.32118523578804137, 'support': 73033}}
[[12484  2749  9123]
 [12036  2996 10092]
 [11068  2634  9851]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985365
{'0': {'precision': 0.34568249049161853, 'recall': 0.5111967503385064, 'f1-score': 0.4124543048027229, 'support': 9601}, '1': {'precision': 0.3269924565431289, 'recall': 0.10229837882208086, 'f1-score': 0.1558421258304025, 'support': 9746}, '2': {'precision': 0.3678554370323197, 'recall': 0.4416937488051998, 'f1-score': 0.40140722724113975, 'support': 10462}, 'accuracy': 0.35311483109128117, 'macro avg': {'precision': 0.34684346135568905, 'recall': 0.35172962598859564, 'f1-score': 0.32323455262475503, 'support': 29809}, 'weighted avg': {'precision': 0.3473538077396589, 'recall': 0.35311483109128117, 'f1-score': 0.32467823644371996, 'support': 29809}}
[[4908  946 3747]
 [4555  997 4194]
 [4735 1106 4621]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
860/860 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935535
{'0': {'precision': 0.3453761333006616, 'recall': 0.49449886328552584, 'f1-score': 0.4066988683252252, 'support': 71258}, '1': {'precision': 0.29741019214703424, 'recall': 0.08209655899454776, 'f1-score': 0.1286741451198575, 'support': 60709}, '2': {'precision': 0.4390149867531338, 'recall': 0.5048083481107625, 'f1-score': 0.46961845945602976, 'support': 87972}, 'accuracy': 0.3847885095412819, 'macro avg': {'precision': 0.36060043740027653, 'recall': 0.36046792346361195, 'f1-score': 0.33499715763370413, 'support': 219939}, 'weighted avg': {'precision': 0.369590269467623, 'recall': 0.3847885095412819, 'f1-score': 0.355123474010822, 'support': 219939}}
[[35237  5309 30712]
 [29690  4984 26035]
 [37098  6465 44409]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982306
{'0': {'precision': 0.35716027555934887, 'recall': 0.42886424362212217, 'f1-score': 0.3897417133733597, 'support': 27321}, '1': {'precision': 0.3341818696082591, 'recall': 0.08763536567274885, 'f1-score': 0.13885705890994565, 'support': 26964}, '2': {'precision': 0.34896182183523106, 'recall': 0.5324864943787414, 'f1-score': 0.4216184971098266, 'support': 27396}, 'accuracy': 0.3509751349763103, 'macro avg': {'precision': 0.3467679890009463, 'recall': 0.34966203455787087, 'f1-score': 0.31673908979771065, 'support': 81681}, 'weighted avg': {'precision': 0.3468250130589985, 'recall': 0.3509751349763103, 'f1-score': 0.31761285285858576, 'support': 81681}}
[[11717  2344 13260]
 [10645  2363 13956]
 [10444  2364 14588]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976846
{'0': {'precision': 0.36440446988280184, 'recall': 0.4588719826106853, 'f1-score': 0.40621835122544053, 'support': 8741}, '1': {'precision': 0.30804179918218993, 'recall': 0.09078735940010713, 'f1-score': 0.1402420105491778, 'support': 7468}, '2': {'precision': 0.3622053943673956, 'recall': 0.48640310786106034, 'f1-score': 0.41521580102414046, 'support': 8752}, 'accuracy': 0.3583991026000561, 'macro avg': {'precision': 0.34488388781079576, 'recall': 0.3453541499572843, 'f1-score': 0.3205587209329196, 'support': 24961}, 'weighted avg': {'precision': 0.3467704514659513, 'recall': 0.3583991026000561, 'f1-score': 0.32979650788855064, 'support': 24961}}
[[4011  787 3943]
 [3237  678 3553]
 [3759  736 4257]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
1914/1914 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991644
{'0': {'precision': 0.3440375902590967, 'recall': 0.4752353013079086, 'f1-score': 0.3991314970895913, 'support': 163620}, '1': {'precision': 0.31688088839965034, 'recall': 0.13095747812357836, 'f1-score': 0.1853254437869822, 'support': 149476}, '2': {'precision': 0.3757544873444024, 'recall': 0.4295320612154871, 'f1-score': 0.4008476231191053, 'support': 176818}, 'accuracy': 0.35369881244463314, 'macro avg': {'precision': 0.3455576553343831, 'recall': 0.34524161354899136, 'f1-score': 0.32843485466522626, 'support': 489914}, 'weighted avg': {'precision': 0.3471990494982427, 'recall': 0.35369881244463314, 'f1-score': 0.3345172348901559, 'support': 489914}}
[[77758 20227 65635]
 [69361 19575 60540]
 [78897 21972 75949]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996981
{'0': {'precision': 0.3435958787050149, 'recall': 0.4646624733792284, 'f1-score': 0.39506207496719054, 'support': 60573}, '1': {'precision': 0.3626520457058607, 'recall': 0.12377537701876051, 'f1-score': 0.1845594700744475, 'support': 63591}, '2': {'precision': 0.33480991153115286, 'recall': 0.451552130891563, 'f1-score': 0.3845153271379226, 'support': 58919}, 'accuracy': 0.3420415876951984, 'macro avg': {'precision': 0.3470192786473428, 'recall': 0.3466633270965173, 'f1-score': 0.32137895739318684, 'support': 183083}, 'weighted avg': {'precision': 0.3473872755896738, 'recall': 0.3420415876951984, 'f1-score': 0.31855319657276254, 'support': 183083}}
[[28146  6965 25462]
 [28324  7871 27396]
 [25446  6868 26605]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000249
{'0': {'precision': 0.35973180832183, 'recall': 0.4730809128630705, 'f1-score': 0.40869272992046596, 'support': 19280}, '1': {'precision': 0.2784687449523502, 'recall': 0.11173763691749303, 'f1-score': 0.15948196114708602, 'support': 15429}, '2': {'precision': 0.3722520339276441, 'recall': 0.4312860366006518, 'f1-score': 0.399600492416324, 'support': 19945}, 'accuracy': 0.3558202510337761, 'macro avg': {'precision': 0.33681752906727475, 'recall': 0.3387015287937385, 'f1-score': 0.3225917278279587, 'support': 54654}, 'weighted avg': {'precision': 0.3413600165953371, 'recall': 0.3558202510337761, 'f1-score': 0.3350216787910959, 'support': 54654}}
[[9121 2162 7997]
 [7196 1724 6509]
 [9038 2305 8602]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/EXC
Evaluating performance on  test set...
4918/4918 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0940635
{'0': {'precision': 0.37982828274650454, 'recall': 0.4404557093937253, 'f1-score': 0.4079015007678271, 'support': 426061}, '1': {'precision': 0.328813931252841, 'recall': 0.16044236755359423, 'f1-score': 0.215656643536366, 'support': 392253}, '2': {'precision': 0.3835087003308515, 'recall': 0.49916462362662306, 'f1-score': 0.43375951410854635, 'support': 440520}, 'accuracy': 0.37374824639309073, 'macro avg': {'precision': 0.36405030477673234, 'recall': 0.36668756685798093, 'f1-score': 0.35243921947091317, 'support': 1258834}, 'weighted avg': {'precision': 0.3652201335686245, 'recall': 0.37374824639309073, 'f1-score': 0.35704678128395656, 'support': 1258834}}
[[187661  61836 176564]
 [152406  62934 176913]
 [154001  66627 219892]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0946994
{'0': {'precision': 0.3721602588756415, 'recall': 0.4609736264999877, 'f1-score': 0.41183312114530174, 'support': 121751}, '1': {'precision': 0.3514379508954021, 'recall': 0.15173221530052788, 'f1-score': 0.21195397665637203, 'support': 117826}, '2': {'precision': 0.363807428974654, 'recall': 0.479284440089445, 'f1-score': 0.41363757923572314, 'support': 119403}, 'accuracy': 0.36556354114435347, 'macro avg': {'precision': 0.3624685462485659, 'recall': 0.3639967606299868, 'f1-score': 0.34580822567913233, 'support': 358980}, 'weighted avg': {'precision': 0.36258039479199533, 'recall': 0.36556354114435347, 'f1-score': 0.3468281003386216, 'support': 358980}}
[[56124 16318 49309]
 [49182 17878 50766]
 [45500 16675 57228]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0931007
{'0': {'precision': 0.38846504097945966, 'recall': 0.4560269872190811, 'f1-score': 0.41954343288638274, 'support': 42094}, '1': {'precision': 0.3337854050388608, 'recall': 0.16806744760203812, 'f1-score': 0.2235653768888112, 'support': 38074}, '2': {'precision': 0.38503602438573803, 'recall': 0.4898467613048792, 'f1-score': 0.43116324293013925, 'support': 42548}, 'accuracy': 0.3784103132435868, 'macro avg': {'precision': 0.3690954901346862, 'recall': 0.37131373204199947, 'f1-score': 0.35809068423511103, 'support': 122716}, 'weighted avg': {'precision': 0.37031117142021697, 'recall': 0.3784103132435868, 'f1-score': 0.3627678793619052, 'support': 122716}}
[[19196  6166 16732]
 [15119  6399 16556]
 [15100  6606 20842]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/AAL
Evaluating performance on  test set...
4856/4856 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947866
{'0': {'precision': 0.39138661792178053, 'recall': 0.43833040129219775, 'f1-score': 0.4135305153956517, 'support': 444514}, '1': {'precision': 0.3050669523299411, 'recall': 0.11854472796902968, 'f1-score': 0.17074165117812817, 'support': 360345}, '2': {'precision': 0.37661165698419125, 'recall': 0.5201955981289422, 'f1-score': 0.43690932483035916, 'support': 438041}, 'accuracy': 0.3744693861131225, 'macro avg': {'precision': 0.35768840907863764, 'recall': 0.3590235757967232, 'f1-score': 0.34039383046804633, 'support': 1242900}, 'weighted avg': {'precision': 0.3611533742483121, 'recall': 0.3744693861131225, 'f1-score': 0.35137999949503634, 'support': 1242900}}
[[194844  48705 200965]
 [141415  42717 176213]
 [161571  48603 227867]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968707
{'0': {'precision': 0.359860769519363, 'recall': 0.4862835447601451, 'f1-score': 0.4136277173262037, 'support': 177524}, '1': {'precision': 0.34289167215996486, 'recall': 0.10671666457708834, 'f1-score': 0.1627739193171249, 'support': 175474}, '2': {'precision': 0.3597725699427626, 'recall': 0.47773131852117573, 'f1-score': 0.410444958104594, 'support': 178412}, 'accuracy': 0.35807756722681167, 'macro avg': {'precision': 0.3541750038740301, 'recall': 0.35691050928613643, 'f1-score': 0.3289488649159742, 'support': 531410}, 'weighted avg': {'precision': 0.35422788482975714, 'recall': 0.35807756722681167, 'f1-score': 0.32972609373972445, 'support': 531410}}
[[86327 18085 73112]
 [78185 18726 78563]
 [75378 17801 85233]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983084
{'0': {'precision': 0.3463519110537174, 'recall': 0.4579680569727006, 'f1-score': 0.3944154516597622, 'support': 48023}, '1': {'precision': 0.37387331769354243, 'recall': 0.1104102096627165, 'f1-score': 0.17047629771422138, 'support': 54850}, '2': {'precision': 0.33522155976944756, 'recall': 0.4989986719227607, 'f1-score': 0.40103346039813637, 'support': 47437}, 'accuracy': 0.34408888297518464, 'macro avg': {'precision': 0.3518155961722358, 'recall': 0.3557923128527259, 'f1-score': 0.32197506992403996, 'support': 150310}, 'weighted avg': {'precision': 0.3528821397831598, 'recall': 0.34408888297518464, 'f1-score': 0.3147858587292143, 'support': 150310}}
[[21993  5018 21012]
 [22864  6056 25930]
 [18642  5124 23671]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/WBA
Evaluating performance on  test set...
4353/4353 - 52s - 52s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0915874
{'0': {'precision': 0.4417943544638042, 'recall': 0.4252372099058767, 'f1-score': 0.4333576916105305, 'support': 446967}, '1': {'precision': 0.26573774055632043, 'recall': 0.09090072097338489, 'f1-score': 0.13546352854259291, 'support': 282396}, '2': {'precision': 0.37705202666357995, 'recall': 0.5754598358100385, 'f1-score': 0.45559180080379436, 'support': 384920}, 'accuracy': 0.3923985199451127, 'macro avg': {'precision': 0.3615280405612349, 'recall': 0.3638659222297667, 'f1-score': 0.34147100698563926, 'support': 1114283}, 'weighted avg': {'precision': 0.37481110123470524, 'recall': 0.3923985199451127, 'f1-score': 0.36554209470825144, 'support': 1114283}}
[[190067  38506 218394]
 [109158  25670 147568]
 [130991  32423 221506]]
Evaluating performance on  train set...
1542/1542 - 18s - 18s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094435
{'0': {'precision': 0.3895809470679351, 'recall': 0.463414117597227, 'f1-score': 0.4233021228300962, 'support': 141653}, '1': {'precision': 0.32378239193557223, 'recall': 0.09819314641744548, 'f1-score': 0.1506874637464065, 'support': 120375}, '2': {'precision': 0.3646660371286737, 'recall': 0.5215642778456849, 'f1-score': 0.42922652293916935, 'support': 132534}, 'accuracy': 0.3715233600802916, 'macro avg': {'precision': 0.3593431253773937, 'recall': 0.3610571806201192, 'f1-score': 0.3344053698385574, 'support': 394562}, 'weighted avg': {'precision': 0.36113782850114906, 'recall': 0.3715233600802916, 'f1-score': 0.34212145884536566, 'support': 394562}}
[[65644 12547 63462]
 [51585 11820 56970]
 [51270 12139 69125]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.093657
{'0': {'precision': 0.3955172967332852, 'recall': 0.4393990057736463, 'f1-score': 0.4163049791435662, 'support': 44859}, '1': {'precision': 0.28770606804629956, 'recall': 0.0965766932564095, 'f1-score': 0.14461070586420433, 'support': 33973}, '2': {'precision': 0.39127422706987386, 'recall': 0.5460350293410077, 'f1-score': 0.4558782122275824, 'support': 44477}, 'accuracy': 0.38341078104599013, 'macro avg': {'precision': 0.35816586394981953, 'recall': 0.3606702427903545, 'f1-score': 0.338931299078451, 'support': 123309}, 'weighted avg': {'precision': 0.36428364889247467, 'recall': 0.38341078104599013, 'f1-score': 0.3557240737900075, 'support': 123309}}
[[19711  4177 20971]
 [13880  3281 16812]
 [16245  3946 24286]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
5497/5497 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954974
{'0': {'precision': 0.35843249597198357, 'recall': 0.4752225113114857, 'f1-score': 0.4086467168871227, 'support': 463909}, '1': {'precision': 0.3347567429468229, 'recall': 0.1044016709731028, 'f1-score': 0.15916426612987192, 'support': 439265}, '2': {'precision': 0.3853165917201672, 'recall': 0.5008392490803972, 'f1-score': 0.4355479331513618, 'support': 504022}, 'accuracy': 0.36864374259165034, 'macro avg': {'precision': 0.35950194354632453, 'recall': 0.3601544771216619, 'f1-score': 0.33445297205611885, 'support': 1407196}, 'weighted avg': {'precision': 0.3606711649666324, 'recall': 0.36864374259165034, 'f1-score': 0.34040455026076116, 'support': 1407196}}
[[220460  43073 200376]
 [191081  45860 202324]
 [203526  48062 252434]]
Evaluating performance on  train set...
2058/2058 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964557
{'0': {'precision': 0.36209066666666667, 'recall': 0.4818671678486461, 'f1-score': 0.41347943443477586, 'support': 176117}, '1': {'precision': 0.35416363900595843, 'recall': 0.09502985872810732, 'f1-score': 0.14985132577005347, 'support': 179512}, '2': {'precision': 0.35260887007638714, 'recall': 0.5031455357925173, 'f1-score': 0.41463667062195986, 'support': 171195}, 'accuracy': 0.35696931043384506, 'macro avg': {'precision': 0.3562877252496708, 'recall': 0.3600141874564236, 'f1-score': 0.3259891436089297, 'support': 526824}, 'weighted avg': {'precision': 0.35630840777811573, 'recall': 0.35696931043384506, 'f1-score': 0.32402584842966464, 'support': 526824}}
[[84865 15834 75418]
 [79725 17059 82728]
 [69785 15274 86136]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978738
{'0': {'precision': 0.34976344195131853, 'recall': 0.48188665396781016, 'f1-score': 0.4053299231232821, 'support': 57223}, '1': {'precision': 0.32748538011695905, 'recall': 0.07730865942445807, 'f1-score': 0.12508808551940542, 'support': 60847}, '2': {'precision': 0.3504488507447963, 'recall': 0.5054331394831848, 'f1-score': 0.4139086109594029, 'support': 56229}, 'accuracy': 0.34824640416755115, 'macro avg': {'precision': 0.34256589093769124, 'recall': 0.35487615095848435, 'f1-score': 0.31477553986736345, 'support': 174299}, 'weighted avg': {'precision': 0.34220738381336707, 'recall': 0.34824640416755115, 'f1-score': 0.31026624487873766, 'support': 174299}}
[[27575  4934 24714]
 [28181  4704 27962]
 [23083  4726 28420]]
testing model on single stock: results/universal/W2/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
14883/14883 - 182s - 182s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001742
{'0': {'precision': 0.32811458783829056, 'recall': 0.46368868489735765, 'f1-score': 0.38429500601766275, 'support': 1161704}, '1': {'precision': 0.3790523588876086, 'recall': 0.0637544963596153, 'f1-score': 0.10915048829274032, 'support': 1455066}, '2': {'precision': 0.3323975148821129, 'recall': 0.5358621568252755, 'f1-score': 0.4102902738712445, 'support': 1193124}, 'accuracy': 0.33354891238443907, 'macro avg': {'precision': 0.34652148720267073, 'recall': 0.35443511269408284, 'f1-score': 0.3012452560605492, 'support': 3809894}, 'weighted avg': {'precision': 0.34890988603185724, 'recall': 0.33354891238443907, 'f1-score': 0.2873532394316645, 'support': 3809894}}
[[538669  75771 547264]
 [625463  92767 736836]
 [477578  76196 639350]]
Evaluating performance on  train set...
6147/6147 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098
{'0': {'precision': 0.3515215412862032, 'recall': 0.4694376763581382, 'f1-score': 0.40201133499597536, 'support': 519185}, '1': {'precision': 0.3405792934230452, 'recall': 0.06841645198679959, 'f1-score': 0.1139436150017957, 'support': 519378}, '2': {'precision': 0.35653243207709145, 'recall': 0.5170866671651836, 'f1-score': 0.4220561734489131, 'support': 534920}, 'accuracy': 0.3532666066300049, 'macro avg': {'precision': 0.3495444222621133, 'recall': 0.3516469318367072, 'f1-score': 0.31267037448222806, 'support': 1573483}, 'weighted avg': {'precision': 0.3496132034720614, 'recall': 0.3532666066300049, 'f1-score': 0.3137398688982218, 'support': 1573483}}
[[243725  34190 241270]
 [225908  35534 257936]
 [223710  34610 276600]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962875
{'0': {'precision': 0.3595092124108885, 'recall': 0.48058773756834156, 'f1-score': 0.4113232860369195, 'support': 184368}, '1': {'precision': 0.33365450791465934, 'recall': 0.06695096891088671, 'f1-score': 0.11152365046721231, 'support': 181028}, '2': {'precision': 0.36831106580884637, 'recall': 0.5275212315613766, 'f1-score': 0.4337684801129029, 'support': 191107}, 'accuracy': 0.36215078804606626, 'macro avg': {'precision': 0.35382492871146476, 'recall': 0.35835331268020165, 'f1-score': 0.31887180553901157, 'support': 556503}, 'weighted avg': {'precision': 0.3541214074067469, 'recall': 0.36215078804606626, 'f1-score': 0.3215076071930786, 'support': 556503}}
[[ 88605  12225  83538]
 [ 79542  12120  89366]
 [ 78314  11980 100813]]
training model: results/universal/W2/deepOF_L1/h1000
Epoch 1/50
9940/9940 - 211s - loss: 3.2672 - accuracy1000: 0.3775 - val_loss: 3.3085 - val_accuracy1000: 0.3332 - 211s/epoch - 21ms/step
Epoch 2/50
9940/9940 - 201s - loss: 3.2719 - accuracy1000: 0.3725 - val_loss: 3.3086 - val_accuracy1000: 0.3305 - 201s/epoch - 20ms/step
Epoch 3/50
9940/9940 - 208s - loss: 3.2661 - accuracy1000: 0.3779 - val_loss: 3.3088 - val_accuracy1000: 0.3291 - 208s/epoch - 21ms/step
Epoch 4/50
9940/9940 - 206s - loss: 3.2633 - accuracy1000: 0.3809 - val_loss: 3.3096 - val_accuracy1000: 0.3276 - 206s/epoch - 21ms/step
Epoch 5/50
9940/9940 - 199s - loss: 3.2609 - accuracy1000: 0.3822 - val_loss: 3.3119 - val_accuracy1000: 0.3273 - 199s/epoch - 20ms/step
Epoch 6/50
9940/9940 - 199s - loss: 3.2580 - accuracy1000: 0.3849 - val_loss: 3.3114 - val_accuracy1000: 0.3272 - 199s/epoch - 20ms/step
Epoch 7/50
9940/9940 - 199s - loss: 3.2574 - accuracy1000: 0.3855 - val_loss: 3.3130 - val_accuracy1000: 0.3276 - 199s/epoch - 20ms/step
Epoch 8/50
9940/9940 - 206s - loss: 3.2560 - accuracy1000: 0.3868 - val_loss: 3.3161 - val_accuracy1000: 0.3272 - 206s/epoch - 21ms/step
Epoch 9/50
9940/9940 - 199s - loss: 3.2551 - accuracy1000: 0.3877 - val_loss: 3.3158 - val_accuracy1000: 0.3272 - 199s/epoch - 20ms/step
Epoch 10/50
9940/9940 - 200s - loss: 3.2541 - accuracy1000: 0.3886 - val_loss: 3.3152 - val_accuracy1000: 0.3272 - 200s/epoch - 20ms/step
Epoch 11/50
9940/9940 - 199s - loss: 3.2532 - accuracy1000: 0.3887 - val_loss: 3.3115 - val_accuracy1000: 0.3285 - 199s/epoch - 20ms/step
testing model in sample: results/universal/W2/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 314s - 314s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001145
{'0': {'precision': 0.34733614974740223, 'recall': 0.1668028953823803, 'f1-score': 0.22537356770563863, 'support': 2154465}, '1': {'precision': 0.3530242583011837, 'recall': 0.847871747211896, 'f1-score': 0.4984932805503419, 'support': 2367200}, '2': {'precision': 0.35805991440798857, 'recall': 0.00011413869169775164, 'f1-score': 0.00022820463864568275, 'support': 2199079}, 'accuracy': 0.35214910730121546, 'macro avg': {'precision': 0.35280677415219147, 'recall': 0.33826292709532474, 'f1-score': 0.24136501763154208, 'support': 6720744}, 'weighted avg': {'precision': 0.3528485299592581, 'recall': 0.35214910730121546, 'f1-score': 0.24790329720850052, 'support': 6720744}}
[[ 359371 1794899     195]
 [ 359863 2007082     255]
 [ 315415 1883413     251]]
Evaluating performance on  train set...
9940/9940 - 121s - 121s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1026667
{'0': {'precision': 0.359100408412101, 'recall': 0.1641898404059302, 'f1-score': 0.22534583390408322, 'support': 846648}, '1': {'precision': 0.3326263885945218, 'recall': 0.849151520963642, 'f1-score': 0.4780089414487066, 'support': 844629}, '2': {'precision': 0.33568904593639576, 'recall': 0.00011145760739233782, 'f1-score': 0.0002228412256267409, 'support': 852342}, 'accuracy': 0.33665576487673665, 'macro avg': {'precision': 0.3424719476476728, 'recall': 0.33781760632565483, 'f1-score': 0.23452587219280552, 'support': 2543619}, 'weighted avg': {'precision': 0.34246457875374037, 'recall': 0.33665576487673665, 'f1-score': 0.2338081099119157, 'support': 2543619}}
[[139011 707538     99]
 [127322 717218     89]
 [120776 731471     95]]
Evaluating performance on  val set...
3393/3393 - 41s - 41s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032312
{'0': {'precision': 0.3618350536655557, 'recall': 0.1698269238058156, 'f1-score': 0.23115940839475366, 'support': 290219}, '1': {'precision': 0.32761104080857334, 'recall': 0.8440108576639124, 'f1-score': 0.4720076944507613, 'support': 284039}, '2': {'precision': 0.5045045045045045, 'recall': 0.00019058963668850507, 'f1-score': 0.0003810353274182135, 'support': 293825}, 'accuracy': 0.3330038717495908, 'macro avg': {'precision': 0.3979835329928778, 'recall': 0.33800945703547214, 'f1-score': 0.2345160460576444, 'support': 868083}, 'weighted avg': {'precision': 0.39892701031586414, 'recall': 0.3330038717495908, 'f1-score': 0.23185271866180476, 'support': 868083}}
[[ 49287 240908     24]
 [ 44276 239732     31]
 [ 42651 251118     56]]
testing model out of sample: results/universal/W2/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 171s - 171s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1055554
{'0': {'precision': 0.34339745763436325, 'recall': 0.2022436365406142, 'f1-score': 0.2545627569191251, 'support': 1191726}, '1': {'precision': 0.3248162181417792, 'recall': 0.8052189372963182, 'f1-score': 0.4629027136546638, 'support': 1195799}, '2': {'precision': 0.3799126637554585, 'recall': 0.0001360243217741324, 'f1-score': 0.0002719512738338331, 'support': 1279183}, 'accuracy': 0.32837984371812534, 'macro avg': {'precision': 0.34937544651053365, 'recall': 0.3358661993862355, 'f1-score': 0.23924580728254088, 'support': 3666708}, 'weighted avg': {'precision': 0.3500765286996372, 'recall': 0.32837984371812534, 'f1-score': 0.23379432820504148, 'support': 3666708}}
[[ 241019  950570     137]
 [ 232772  962880     147]
 [ 228075 1050934     174]]
Evaluating performance on  train set...
5373/5373 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102069
{'0': {'precision': 0.36101139961738454, 'recall': 0.1869146428717226, 'f1-score': 0.24630447030977046, 'support': 465421}, '1': {'precision': 0.3320911352925663, 'recall': 0.8254628766868005, 'f1-score': 0.47363475228605323, 'support': 456115}, '2': {'precision': 0.313953488372093, 'recall': 0.00011911274241648873, 'f1-score': 0.00023813513728049673, 'support': 453352}, 'accuracy': 0.33715764484088884, 'macro avg': {'precision': 0.3356853410940146, 'recall': 0.33749887743364654, 'f1-score': 0.24005911924436807, 'support': 1374888}, 'weighted avg': {'precision': 0.3359004345486736, 'recall': 0.33715764484088884, 'f1-score': 0.24058333984713898, 'support': 1374888}}
[[ 86994 378372     55]
 [ 79546 376506     63]
 [ 74433 378865     54]]
Evaluating performance on  val set...
1685/1685 - 20s - 20s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023301
{'0': {'precision': 0.35063485056993743, 'recall': 0.1892283870606122, 'f1-score': 0.2458032427316123, 'support': 142727}, '1': {'precision': 0.3376792330099833, 'recall': 0.8230169014861176, 'f1-score': 0.47887764555834966, 'support': 145076}, '2': {'precision': 0.32075471698113206, 'recall': 0.00011899262245740764, 'f1-score': 0.00023789699060306887, 'support': 142866}, 'accuracy': 0.3399942879566442, 'macro avg': {'precision': 0.3363562668536843, 'recall': 0.3374547603897291, 'f1-score': 0.2416395950935217, 'support': 430669}, 'weighted avg': {'precision': 0.3363584472568915, 'recall': 0.3399942879566442, 'f1-score': 0.24285565045043284, 'support': 430669}}
[[ 27008 115704     15]
 [ 25655 119400     21]
 [ 24363 118486     17]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023852
{'0': {'precision': 0.2856244101918842, 'recall': 0.10145629259935193, 'f1-score': 0.14972791733084154, 'support': 80547}, '1': {'precision': 0.33907550448756035, 'recall': 0.8602792827511164, 'f1-score': 0.4864275940743494, 'support': 88226}, '2': {'precision': 0.3684210526315789, 'recall': 0.00016723007274508164, 'f1-score': 0.0003343083994985374, 'support': 83717}, 'accuracy': 0.3330230900233673, 'macro avg': {'precision': 0.3310403224370078, 'recall': 0.3206342684744045, 'f1-score': 0.2121632732682298, 'support': 252490}, 'weighted avg': {'precision': 0.33175401041547425, 'recall': 0.3330230900233673, 'f1-score': 0.21784499492388476, 'support': 252490}}
[[ 8172 72364    11]
 [12314 75899    13]
 [ 8125 75578    14]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041168
{'0': {'precision': 0.3643883326077492, 'recall': 0.12002294345394579, 'f1-score': 0.18056953832877895, 'support': 20921}, '1': {'precision': 0.3194540267392642, 'recall': 0.8845975112304435, 'f1-score': 0.46939558331963394, 'support': 19367}, '2': {'precision': 0.05555555555555555, 'recall': 4.938271604938271e-05, 'f1-score': 9.867771857114663e-05, 'support': 20250}, 'accuracy': 0.3244904027222571, 'macro avg': {'precision': 0.24646597163418968, 'recall': 0.33488994580014625, 'f1-score': 0.21668793312232804, 'support': 60538}, 'weighted avg': {'precision': 0.24670842185645467, 'recall': 0.3244904027222571, 'f1-score': 0.2126016352923585, 'support': 60538}}
[[ 2511 18399    11]
 [ 2229 17132     6]
 [ 2151 18098     1]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976427
{'0': {'precision': 0.36287878787878786, 'recall': 0.12573828586428665, 'f1-score': 0.18676284238229846, 'support': 7619}, '1': {'precision': 0.3420580474934037, 'recall': 0.8768939393939394, 'f1-score': 0.4921418267405664, 'support': 7392}, '2': {'precision': 0.42857142857142855, 'recall': 0.00045551169146674765, 'f1-score': 0.0009100561201274079, 'support': 6586}, 'accuracy': 0.344631198777608, 'macro avg': {'precision': 0.37783608798120666, 'recall': 0.33436257898323096, 'f1-score': 0.22660490841433076, 'support': 21597}, 'weighted avg': {'precision': 0.375785433184755, 'recall': 0.344631198777608, 'f1-score': 0.2346090711202555, 'support': 21597}}
[[ 958 6659    2]
 [ 908 6482    2]
 [ 774 5809    3]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993446
{'0': {'precision': 0.29782453487883753, 'recall': 0.16073027277569385, 'f1-score': 0.20878384843555642, 'support': 88241}, '1': {'precision': 0.3918448643525649, 'recall': 0.8519087901739362, 'f1-score': 0.536788106087693, 'support': 124241}, '2': {'precision': 0.35, 'recall': 0.00019940747493163173, 'f1-score': 0.00039858786015260225, 'support': 105312}, 'accuracy': 0.3777478492356684, 'macro avg': {'precision': 0.3465564664104675, 'recall': 0.3376128234748539, 'f1-score': 0.248656847461134, 'support': 317794}, 'weighted avg': {'precision': 0.351871755207054, 'recall': 0.3777478492356684, 'f1-score': 0.26796088894998454, 'support': 317794}}
[[ 14183  74044     14]
 [ 18374 105842     25]
 [ 15065  90226     21]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000552
{'0': {'precision': 0.38315696649029984, 'recall': 0.1678866587957497, 'f1-score': 0.23347314058838456, 'support': 46585}, '1': {'precision': 0.33078246892225976, 'recall': 0.848914895525065, 'f1-score': 0.4760647493320761, 'support': 44604}, '2': {'precision': 0.4, 'recall': 0.0002744488152959473, 'f1-score': 0.0005485212780545779, 'support': 43724}, 'accuracy': 0.3387219912091496, 'macro avg': {'precision': 0.37131314513751984, 'recall': 0.3390253343787035, 'f1-score': 0.2366954703995051, 'support': 134913}, 'weighted avg': {'precision': 0.37129993794340865, 'recall': 0.3387219912091496, 'f1-score': 0.23818847611334323, 'support': 134913}}
[[ 7821 38757     7]
 [ 6728 37865    11]
 [ 5863 37849    12]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0862626
{'0': {'precision': 0.3732989543045409, 'recall': 0.18205952214615062, 'f1-score': 0.24475228926978163, 'support': 14314}, '1': {'precision': 0.3895122168983066, 'recall': 0.8308786185881158, 'f1-score': 0.5303831580653658, 'support': 15752}, '2': {'precision': 0.4166666666666667, 'recall': 0.0004749240121580547, 'f1-score': 0.0009487666034155599, 'support': 10528}, 'accuracy': 0.3867320293639454, 'macro avg': {'precision': 0.3931592792898381, 'recall': 0.33780435491547484, 'f1-score': 0.25869473797952103, 'support': 40594}, 'weighted avg': {'precision': 0.3908376690930677, 'recall': 0.3867320293639454, 'f1-score': 0.2923576979172798, 'support': 40594}}
[[ 2606 11703     5]
 [ 2662 13088     2]
 [ 1713  8810     5]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173368
{'0': {'precision': 0.3193383996423782, 'recall': 0.2145431392806516, 'f1-score': 0.2566556726810235, 'support': 83242}, '1': {'precision': 0.295107355919467, 'recall': 0.8027570390497438, 'f1-score': 0.4315642411308074, 'support': 80231}, '2': {'precision': 0.4864864864864865, 'recall': 0.00016255023253713822, 'f1-score': 0.00032499187520311994, 'support': 110735}, 'accuracy': 0.30007512545221143, 'macro avg': {'precision': 0.3669774140161106, 'recall': 0.33915424285431084, 'f1-score': 0.22951496856234466, 'support': 274208}, 'weighted avg': {'precision': 0.3797489731039455, 'recall': 0.30007512545221143, 'f1-score': 0.20431697875620036, 'support': 274208}}
[[17859 65374     9]
 [15815 64406    10]
 [22251 88466    18]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993872
{'0': {'precision': 0.3552128240937519, 'recall': 0.24068131325598618, 'f1-score': 0.2869405272838749, 'support': 24306}, '1': {'precision': 0.3476269627953034, 'recall': 0.7733978520004721, 'f1-score': 0.47965743982628, 'support': 25419}, '2': {'precision': 0.5833333333333334, 'recall': 0.00030032606830272866, 'f1-score': 0.0006003430531732418, 'support': 23308}, 'accuracy': 0.3493763093396136, 'macro avg': {'precision': 0.4287243734074629, 'recall': 0.33812649710825365, 'f1-score': 0.2557327700544427, 'support': 73033}, 'weighted avg': {'precision': 0.42537573429887704, 'recall': 0.3493763093396136, 'f1-score': 0.2626317105279728, 'support': 73033}}
[[ 5850 18453     3]
 [ 5758 19659     2]
 [ 4861 18440     7]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108711
{'0': {'precision': 0.3517375771354336, 'recall': 0.21817082997582596, 'f1-score': 0.26930249906751214, 'support': 9928}, '1': {'precision': 0.2977463955012473, 'recall': 0.7950773399570961, 'f1-score': 0.4332472006890612, 'support': 8857}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11024}, 'accuracy': 0.3088999966453085, 'macro avg': {'precision': 0.2164946575455603, 'recall': 0.3377493899776407, 'f1-score': 0.23418323325219112, 'support': 29809}, 'weighted avg': {'precision': 0.20561543462562087, 'recall': 0.3088999966453085, 'f1-score': 0.21842080134339545, 'support': 29809}}
[[2166 7762    0]
 [1815 7042    0]
 [2177 8847    0]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1206982
{'0': {'precision': 0.31917338593836786, 'recall': 0.24412217095143923, 'f1-score': 0.27664801872541045, 'support': 68265}, '1': {'precision': 0.2648279316019174, 'recall': 0.7358481188807713, 'f1-score': 0.38948296044930225, 'support': 60363}, '2': {'precision': 1.0, 'recall': 2.190316610266014e-05, 'f1-score': 4.380537272896521e-05, 'support': 91311}, 'accuracy': 0.2777360995548766, 'macro avg': {'precision': 0.5280004391800951, 'recall': 0.326664064332771, 'f1-score': 0.2220582615158139, 'support': 219939}, 'weighted avg': {'precision': 0.5869135516046232, 'recall': 0.2777360995548766, 'f1-score': 0.19277952910707347, 'support': 219939}}
[[16665 51600     0]
 [15945 44418     0]
 [19603 71706     2]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021918
{'0': {'precision': 0.36682464454976305, 'recall': 0.20874537020389083, 'f1-score': 0.26607691249942705, 'support': 27809}, '1': {'precision': 0.33328271631184136, 'recall': 0.8137327598991547, 'f1-score': 0.4728847521168638, 'support': 26972}, '2': {'precision': 0.5, 'recall': 3.717472118959108e-05, 'f1-score': 7.43439149505613e-05, 'support': 26900}, 'accuracy': 0.3397852621784748, 'macro avg': {'precision': 0.40003578695386816, 'recall': 0.34083843494141175, 'f1-score': 0.24634533617708046, 'support': 81681}, 'weighted avg': {'precision': 0.3996073501138251, 'recall': 0.3397852621784748, 'f1-score': 0.2467646116612773, 'support': 81681}}
[[ 5805 22004     0]
 [ 5023 21948     1]
 [ 4997 21902     1]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1064308
{'0': {'precision': 0.36115975870791983, 'recall': 0.20718910471087296, 'f1-score': 0.26331843654678305, 'support': 8958}, '1': {'precision': 0.2996821552898441, 'recall': 0.7911561001598295, 'f1-score': 0.4347030626806689, 'support': 7508}, '2': {'precision': 1.0, 'recall': 0.00011771630370806356, 'f1-score': 0.00023540489642184556, 'support': 8495}, 'accuracy': 0.3123672929770442, 'macro avg': {'precision': 0.5536139713325879, 'recall': 0.3328209737248035, 'f1-score': 0.23275230137462458, 'support': 24961}, 'weighted avg': {'precision': 0.560085042282829, 'recall': 0.3123672929770442, 'f1-score': 0.22533379727525532, 'support': 24961}}
[[1856 7102    0]
 [1568 5940    0]
 [1715 6779    1]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
1914/1914 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075146
{'0': {'precision': 0.3482172312026891, 'recall': 0.24105643887023503, 'f1-score': 0.2848931149310836, 'support': 162016}, '1': {'precision': 0.3126289062396577, 'recall': 0.7656678576291849, 'f1-score': 0.44397778588268033, 'support': 154217}, '2': {'precision': 0.3, 'recall': 0.0001036382793742551, 'f1-score': 0.00020720497752401562, 'support': 173681}, 'accuracy': 0.3207746665741334, 'macro avg': {'precision': 0.3202820458141156, 'recall': 0.33560931159293134, 'f1-score': 0.24302603526376265, 'support': 489914}, 'weighted avg': {'precision': 0.31992095544135535, 'recall': 0.3207746665741334, 'f1-score': 0.23404547059656408, 'support': 489914}}
[[ 39055 122939     22]
 [ 36118 118079     20]
 [ 36984 136679     18]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004906
{'0': {'precision': 0.34633784440635473, 'recall': 0.2167536584584841, 'f1-score': 0.2666351541650664, 'support': 62458}, '1': {'precision': 0.33957323256880095, 'recall': 0.7830063265796429, 'f1-score': 0.4737089452085988, 'support': 62435}, '2': {'precision': 0.39285714285714285, 'recall': 0.0001890359168241966, 'f1-score': 0.0003778899996564637, 'support': 58190}, 'accuracy': 0.34102565503077836, 'macro avg': {'precision': 0.35958940661076616, 'recall': 0.33331634031831703, 'f1-score': 0.24690732979110722, 'support': 183083}, 'weighted avg': {'precision': 0.35881638931098103, 'recall': 0.34102565503077836, 'f1-score': 0.25262589029030874, 'support': 183083}}
[[13538 48914     6]
 [13537 48887    11]
 [12014 46165    11]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093177
{'0': {'precision': 0.35361057652079325, 'recall': 0.22676540030049366, 'f1-score': 0.27632654395658285, 'support': 18636}, '1': {'precision': 0.3044150368895655, 'recall': 0.784700839219948, 'f1-score': 0.43865807148401903, 'support': 16563}, '2': {'precision': 0.75, 'recall': 0.00030840400925212025, 'f1-score': 0.0006165544880028771, 'support': 19455}, 'accuracy': 0.31523767702272476, 'macro avg': {'precision': 0.46934187113678627, 'recall': 0.3372582145098979, 'f1-score': 0.23853372330953493, 'support': 54654}, 'weighted avg': {'precision': 0.4798031792740399, 'recall': 0.31523767702272476, 'f1-score': 0.22737787131278187, 'support': 54654}}
[[ 4226 14410     0]
 [ 3564 12997     2]
 [ 4161 15288     6]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
4918/4918 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038003
{'0': {'precision': 0.3560060487191388, 'recall': 0.2297158259307027, 'f1-score': 0.27924592560840633, 'support': 414042}, '1': {'precision': 0.3256352040893517, 'recall': 0.7842076115154047, 'f1-score': 0.4601833737781912, 'support': 411692}, '2': {'precision': 0.34101382488479265, 'recall': 0.0001708612329716001, 'f1-score': 0.00034155133539648803, 'support': 433100}, 'accuracy': 0.3320834994923874, 'macro avg': {'precision': 0.3408850258977611, 'recall': 0.33803143289302634, 'f1-score': 0.246590283573998, 'support': 1258834}, 'weighted avg': {'precision': 0.34091544431062937, 'recall': 0.3320834994923874, 'f1-score': 0.24246348679143323, 'support': 1258834}}
[[ 95112 318873     57]
 [ 88754 322852     86]
 [ 83298 349728     74]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007657
{'0': {'precision': 0.3669112114371708, 'recall': 0.2270833506582066, 'f1-score': 0.2805393604725825, 'support': 120251}, '1': {'precision': 0.3374025462751411, 'recall': 0.7954801604402161, 'f1-score': 0.47383022099802047, 'support': 120668}, '2': {'precision': 0.3709677419354839, 'recall': 0.0001948145450233354, 'f1-score': 0.00038942458285008, 'support': 118061}, 'accuracy': 0.34352610173268705, 'macro avg': {'precision': 0.3584271665492653, 'recall': 0.3409194418811486, 'f1-score': 0.251586335351151, 'support': 358980}, 'weighted avg': {'precision': 0.3583262385679011, 'recall': 0.34352610173268705, 'f1-score': 0.2533769558171863, 'support': 358980}}
[[27307 92928    16]
 [24656 95989    23]
 [22461 95577    23]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1070884
{'0': {'precision': 0.38136344367798375, 'recall': 0.22942458385496362, 'f1-score': 0.2864959541421189, 'support': 43134}, '1': {'precision': 0.2950187610473109, 'recall': 0.7891229816412298, 'f1-score': 0.4294753632129771, 'support': 36168}, '2': {'precision': 0.4166666666666667, 'recall': 0.00023034044317501266, 'f1-score': 0.000460426354804549, 'support': 43414}, 'accuracy': 0.31330062909482054, 'macro avg': {'precision': 0.36434962379732044, 'recall': 0.33959263531312284, 'f1-score': 0.23881058123663354, 'support': 122716}, 'weighted avg': {'precision': 0.36840457638638774, 'recall': 0.31330062909482054, 'f1-score': 0.22744361267007235, 'support': 122716}}
[[ 9896 33232     6]
 [ 7619 28541     8]
 [ 8434 34970    10]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
4856/4856 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005056
{'0': {'precision': 0.35484126289830076, 'recall': 0.2068620498722594, 'f1-score': 0.2613592953915403, 'support': 411772}, '1': {'precision': 0.3418492466922174, 'recall': 0.8049408228442607, 'f1-score': 0.4798932624736533, 'support': 425840}, '2': {'precision': 0.35507246376811596, 'recall': 0.00012090167979313476, 'f1-score': 0.00024172105390379503, 'support': 405288}, 'accuracy': 0.3443599645989219, 'macro avg': {'precision': 0.3505876577862114, 'recall': 0.3373079247987711, 'f1-score': 0.2471647596396991, 'support': 1242900}, 'weighted avg': {'precision': 0.35046535394096484, 'recall': 0.3443599645989219, 'f1-score': 0.2510870973660314, 'support': 1242900}}
[[ 85180 326550     42]
 [ 83017 342776     47]
 [ 71854 333385     49]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037743
{'0': {'precision': 0.3544982032854209, 'recall': 0.18823469283450883, 'f1-score': 0.24589945029265792, 'support': 176094}, '1': {'precision': 0.3316630085488045, 'recall': 0.82778493495833, 'f1-score': 0.47357993689514327, 'support': 175426}, '2': {'precision': 0.26865671641791045, 'recall': 0.00010006114847962644, 'f1-score': 0.0002000477891940853, 'support': 179890}, 'accuracy': 0.3356730208313731, 'macro avg': {'precision': 0.31827264275071193, 'recall': 0.3387065629804395, 'f1-score': 0.23989314499233175, 'support': 531410}, 'weighted avg': {'precision': 0.3179013911357396, 'recall': 0.3356730208313731, 'f1-score': 0.2378872027368714, 'support': 531410}}
[[ 33147 142918     29]
 [ 30191 145215     20]
 [ 30166 149706     18]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977367
{'0': {'precision': 0.33578818795803994, 'recall': 0.198143005532826, 'f1-score': 0.24922342652215068, 'support': 47173}, '1': {'precision': 0.3723051545044751, 'recall': 0.8177611163925311, 'f1-score': 0.5116634026721735, 'support': 55751}, '2': {'precision': 0.2777777777777778, 'recall': 0.00010551639724813236, 'f1-score': 0.00021095266222259724, 'support': 47386}, 'accuracy': 0.3655312354467434, 'macro avg': {'precision': 0.3286237067467643, 'recall': 0.3386698794408684, 'f1-score': 0.2536992606188489, 'support': 150310}, 'weighted avg': {'precision': 0.3310444989495136, 'recall': 0.3655312354467434, 'f1-score': 0.26806173417974744, 'support': 150310}}
[[ 9347 37819     7]
 [10154 45591     6]
 [ 8335 39046     5]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
4353/4353 - 53s - 53s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095261
{'0': {'precision': 0.39176448069549324, 'recall': 0.16133248237265466, 'f1-score': 0.22854703748662733, 'support': 393281}, '1': {'precision': 0.34756650829857216, 'recall': 0.8567667479535888, 'f1-score': 0.4945199768695956, 'support': 386286}, '2': {'precision': 0.3508771929824561, 'recall': 0.00011950429617944765, 'f1-score': 0.00023892721679658334, 'support': 334716}, 'accuracy': 0.35399086228543375, 'macro avg': {'precision': 0.36340272732550716, 'recall': 0.339406244874141, 'f1-score': 0.24110198052433984, 'support': 1114283}, 'weighted avg': {'precision': 0.36416046326053825, 'recall': 0.35399086228543375, 'f1-score': 0.25217052041278937, 'support': 1114283}}
[[ 63449 329806     26]
 [ 55281 330957     48]
 [ 43227 291449     40]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000923
{'0': {'precision': 0.38126259775860677, 'recall': 0.17274912507580242, 'f1-score': 0.23776673840027354, 'support': 136869}, '1': {'precision': 0.33374940596858704, 'recall': 0.848055699917459, 'f1-score': 0.4789928299785461, 'support': 130844}, '2': {'precision': 0.3835616438356164, 'recall': 0.0002207348895143044, 'f1-score': 0.00044121586486188367, 'support': 126849}, 'accuracy': 0.3412264739128451, 'macro avg': {'precision': 0.3661912158542701, 'recall': 0.34034185329425853, 'f1-score': 0.23906692808122718, 'support': 394562}, 'weighted avg': {'precision': 0.36624547910361527, 'recall': 0.3412264739128451, 'f1-score': 0.24146319553089704, 'support': 394562}}
[[ 23644 113208     17]
 [ 19853 110963     28]
 [ 18518 108303     28]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034839
{'0': {'precision': 0.373985025835706, 'recall': 0.1700469888761028, 'f1-score': 0.23379148950196119, 'support': 41712}, '1': {'precision': 0.32448363444673406, 'recall': 0.8509916295905287, 'f1-score': 0.4698233392081488, 'support': 39783}, '2': {'precision': 0.375, 'recall': 7.174630506528914e-05, 'f1-score': 0.00014346516187652432, 'support': 41814}, 'accuracy': 0.3321006576973295, 'macro avg': {'precision': 0.3578228867608133, 'recall': 0.3403701215905656, 'f1-score': 0.23458609795732885, 'support': 123309}, 'weighted avg': {'precision': 0.35835864232824355, 'recall': 0.3321006576973295, 'f1-score': 0.23071220564680836, 'support': 123309}}
[[ 7093 34616     3]
 [ 5926 33855     2]
 [ 5947 35864     3]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
5497/5497 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076221
{'0': {'precision': 0.34192309140898647, 'recall': 0.19989915204040964, 'f1-score': 0.2522972685674743, 'support': 454149}, '1': {'precision': 0.3164569714533008, 'recall': 0.8076170674178655, 'f1-score': 0.4547317034484885, 'support': 447285}, '2': {'precision': 0.3882978723404255, 'recall': 0.00014433666428082775, 'f1-score': 0.0002885660638403004, 'support': 505762}, 'accuracy': 0.3212715215222329, 'macro avg': {'precision': 0.34889264506757095, 'recall': 0.335886852040852, 'f1-score': 0.2357725126932677, 'support': 1407196}, 'weighted avg': {'precision': 0.35049616046906595, 'recall': 0.3212715215222329, 'f1-score': 0.22606741914359268, 'support': 1407196}}
[[ 90784 363314     51]
 [ 85986 361235     64]
 [ 88740 416949     73]]
Evaluating performance on  train set...
2058/2058 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010436
{'0': {'precision': 0.3719997184486521, 'recall': 0.17457416236333007, 'f1-score': 0.23763133046567045, 'support': 181642}, '1': {'precision': 0.3293870904178095, 'recall': 0.8383678834136555, 'f1-score': 0.47295462490955065, 'support': 173468}, '2': {'precision': 0.35384615384615387, 'recall': 0.00013394365048860314, 'f1-score': 0.00026778593425273175, 'support': 171714}, 'accuracy': 0.33628498322020256, 'macro avg': {'precision': 0.3517443209042052, 'recall': 0.3376919964758247, 'f1-score': 0.23695124710315793, 'support': 526824}, 'weighted avg': {'precision': 0.3520515981059805, 'recall': 0.33628498322020256, 'f1-score': 0.23774980941674925, 'support': 526824}}
[[ 31710 149914     18]
 [ 28014 145430     24]
 [ 25518 146173     23]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103206
{'0': {'precision': 0.3610039306191627, 'recall': 0.16861767529601995, 'f1-score': 0.22986843011641528, 'support': 59371}, '1': {'precision': 0.3238326589378442, 'recall': 0.8397713800364518, 'f1-score': 0.46741913879368074, 'support': 56513}, '2': {'precision': 0.29411764705882354, 'recall': 8.559445347941454e-05, 'f1-score': 0.00017113910186199345, 'support': 58415}, 'accuracy': 0.3297437162576951, 'macro avg': {'precision': 0.3263180788719435, 'recall': 0.336158216595317, 'f1-score': 0.232486236003986, 'support': 174299}, 'weighted avg': {'precision': 0.3265354464012179, 'recall': 0.3297437162576951, 'f1-score': 0.22990822348793877, 'support': 174299}}
[[10011 49353     7]
 [ 9050 47458     5]
 [ 8670 49740     5]]
testing model on single stock: results/universal/W2/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
14883/14883 - 192s - 192s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991961
{'0': {'precision': 0.336952785120734, 'recall': 0.1432427710904088, 'f1-score': 0.20102664442859752, 'support': 1190636}, '1': {'precision': 0.3641696100666094, 'recall': 0.8688396366362419, 'f1-score': 0.5132240370951359, 'support': 1384618}, '2': {'precision': 0.3651315789473684, 'recall': 8.990474956262555e-05, 'f1-score': 0.00017976523631840798, 'support': 1234640}, 'accuracy': 0.36055386317834565, 'macro avg': {'precision': 0.3554179913782373, 'recall': 0.3373907708254044, 'f1-score': 0.2381434822533506, 'support': 3809894}, 'weighted avg': {'precision': 0.35597577414169473, 'recall': 0.36055386317834565, 'f1-score': 0.24940083502634158, 'support': 3809894}}
[[ 170550 1019998      88]
 [ 181502 1203011     105]
 [ 154102 1080427     111]]
Evaluating performance on  train set...
6147/6147 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104006
{'0': {'precision': 0.3460630196325019, 'recall': 0.1442304332464951, 'f1-score': 0.2036038578899989, 'support': 515134}, '1': {'precision': 0.33144203409490697, 'recall': 0.8634469773229717, 'f1-score': 0.47901122156514747, 'support': 521541}, '2': {'precision': 0.3, 'recall': 6.147449367371575e-05, 'f1-score': 0.00012292379841987046, 'support': 536808}, 'accuracy': 0.3334348067313088, 'macro avg': {'precision': 0.32583501790913627, 'recall': 0.3359129616877135, 'f1-score': 0.2275793344178554, 'support': 1573483}, 'weighted avg': {'precision': 0.3255019834718653, 'recall': 0.3334348067313088, 'f1-score': 0.22547002269169572, 'support': 1573483}}
[[ 74298 440800     36]
 [ 71177 450323     41]
 [ 69220 467555     33]]
Evaluating performance on  val set...
2174/2174 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034293
{'0': {'precision': 0.351981528445437, 'recall': 0.15319520485884208, 'f1-score': 0.21347729933654222, 'support': 182101}, '1': {'precision': 0.3317686701340721, 'recall': 0.8565909927067328, 'f1-score': 0.47828963467133107, 'support': 184828}, '2': {'precision': 0.3, 'recall': 6.329981959551416e-05, 'f1-score': 0.00012657293237841087, 'support': 189574}, 'accuracy': 0.3346450962528504, 'macro avg': {'precision': 0.3279167328598364, 'recall': 0.33661649912839015, 'f1-score': 0.23063116898008387, 'support': 556503}, 'weighted avg': {'precision': 0.32756072846863865, 'recall': 0.3346450962528504, 'f1-score': 0.22874942492780662, 'support': 556503}}
[[ 27897 154187     17]
 [ 26495 158322     11]
 [ 24865 164697     12]]
training model: results/universal/W2/deepLOB_L2/h300
Epoch 1/50
9940/9940 - 458s - loss: 3.2204 - accuracy300: 0.4111 - val_loss: 3.3458 - val_accuracy300: 0.3412 - 458s/epoch - 46ms/step
Epoch 2/50
9940/9940 - 453s - loss: 3.1889 - accuracy300: 0.4285 - val_loss: 3.4008 - val_accuracy300: 0.3547 - 453s/epoch - 46ms/step
Epoch 3/50
9940/9940 - 453s - loss: 3.1776 - accuracy300: 0.4341 - val_loss: 3.4268 - val_accuracy300: 0.3541 - 453s/epoch - 46ms/step
Epoch 4/50
9940/9940 - 454s - loss: 3.1692 - accuracy300: 0.4376 - val_loss: 3.4742 - val_accuracy300: 0.3547 - 454s/epoch - 46ms/step
Epoch 5/50
9940/9940 - 453s - loss: 3.1622 - accuracy300: 0.4405 - val_loss: 3.4609 - val_accuracy300: 0.3552 - 453s/epoch - 46ms/step
Epoch 6/50
9940/9940 - 451s - loss: 3.1576 - accuracy300: 0.4423 - val_loss: 3.4594 - val_accuracy300: 0.3575 - 451s/epoch - 45ms/step
Epoch 7/50
9940/9940 - 450s - loss: 3.1537 - accuracy300: 0.4440 - val_loss: 3.4709 - val_accuracy300: 0.3570 - 450s/epoch - 45ms/step
Epoch 8/50
9940/9940 - 452s - loss: 3.1483 - accuracy300: 0.4460 - val_loss: 3.5016 - val_accuracy300: 0.3553 - 452s/epoch - 45ms/step
Epoch 9/50
9940/9940 - 452s - loss: 3.1445 - accuracy300: 0.4472 - val_loss: 3.5021 - val_accuracy300: 0.3568 - 452s/epoch - 46ms/step
Epoch 10/50
9940/9940 - 452s - loss: 3.1408 - accuracy300: 0.4489 - val_loss: 3.5811 - val_accuracy300: 0.3571 - 452s/epoch - 45ms/step
Epoch 11/50
9940/9940 - 451s - loss: 3.1365 - accuracy300: 0.4500 - val_loss: 3.6014 - val_accuracy300: 0.3578 - 451s/epoch - 45ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 455s - 455s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1127342
{'0': {'precision': 0.3191339883533446, 'recall': 0.33551953004412643, 'f1-score': 0.3271216995993022, 'support': 2202760}, '1': {'precision': 0.3395872915782854, 'recall': 0.4499777770389567, 'f1-score': 0.3870655900284086, 'support': 2285924}, '2': {'precision': 0.3348581578840261, 'recall': 0.20641239020915422, 'f1-score': 0.25539491477366427, 'support': 2232085}, 'accuracy': 0.3315712829885985, 'macro avg': {'precision': 0.33119314593855204, 'recall': 0.3306365657640791, 'f1-score': 0.3231940681337917, 'support': 6720769}, 'weighted avg': {'precision': 0.3313130082940777, 'recall': 0.3315712829885985, 'f1-score': 0.32368859503607894, 'support': 6720769}}
[[ 739069  998768  464923]
 [ 807066 1028615  450243]
 [ 769723 1001632  460730]]
Evaluating performance on  train set...
9940/9940 - 179s - 179s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113901
{'0': {'precision': 0.3237435549401498, 'recall': 0.33525779128357336, 'f1-score': 0.32940008330325804, 'support': 848031}, '1': {'precision': 0.32982163916323354, 'recall': 0.42421010865511444, 'f1-score': 0.3711081762566568, 'support': 839261}, '2': {'precision': 0.353686319414462, 'recall': 0.2420287925711056, 'f1-score': 0.2873933231321972, 'support': 856332}, 'accuracy': 0.33322102637811246, 'macro avg': {'precision': 0.3357505045059484, 'recall': 0.3338322308365978, 'f1-score': 0.3293005275640373, 'support': 2543624}, 'weighted avg': {'precision': 0.3358294789725406, 'recall': 0.33322102637811246, 'f1-score': 0.3290196193861687, 'support': 2543624}}
[[284309 360821 202901]
 [307405 356023 175833]
 [286478 362597 207257]]
Evaluating performance on  val set...
3393/3393 - 60s - 60s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158189
{'0': {'precision': 0.33508774519209483, 'recall': 0.3870791746657437, 'f1-score': 0.35921193364850923, 'support': 293263}, '1': {'precision': 0.33395329676154933, 'recall': 0.39613021450900077, 'f1-score': 0.3623941344790011, 'support': 278310}, '2': {'precision': 0.3642561309269811, 'recall': 0.24470345413707278, 'f1-score': 0.2927443318559881, 'support': 296514}, 'accuracy': 0.34134942695835785, 'macro avg': {'precision': 0.34443239096020845, 'recall': 0.3426376144372724, 'f1-score': 0.33811679999449945, 'support': 868087}, 'weighted avg': {'precision': 0.34468713601938405, 'recall': 0.34134942695835785, 'f1-score': 0.33752869664026763, 'support': 868087}}
[[113516 109489  70258]
 [111684 110247  56379]
 [113565 110391  72558]]
testing model out of sample: results/universal/W2/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 249s - 249s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158638
{'0': {'precision': 0.33934731145074815, 'recall': 0.3386133871191252, 'f1-score': 0.33897995203113884, 'support': 1248409}, '1': {'precision': 0.30523353940077824, 'recall': 0.4503030373470397, 'f1-score': 0.36384099492309513, 'support': 1118509}, '2': {'precision': 0.35491369369205766, 'recall': 0.21049841708243097, 'f1-score': 0.26426307218896505, 'support': 1299815}, 'accuracy': 0.3272681703303731, 'macro avg': {'precision': 0.3331648481811947, 'recall': 0.3331382805161986, 'f1-score': 0.3223613397143997, 'support': 3666733}, 'weighted avg': {'precision': 0.33445926971745255, 'recall': 0.3272681703303731, 'f1-score': 0.3200773428288828, 'support': 3666733}}
[[422728 559414 266267]
 [383800 503668 231041]
 [439181 587025 273609]]
Evaluating performance on  train set...
5373/5373 - 98s - 98s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1114132
{'0': {'precision': 0.3383323185746554, 'recall': 0.35104786545924965, 'f1-score': 0.34457282353700563, 'support': 463800}, '1': {'precision': 0.32925357584348103, 'recall': 0.44810457981166923, 'f1-score': 0.37959345812867235, 'support': 449953}, '2': {'precision': 0.3436442365120446, 'recall': 0.20961792431349333, 'f1-score': 0.26039731852424547, 'support': 461139}, 'accuracy': 0.33537543312492907, 'macro avg': {'precision': 0.3370767103100603, 'recall': 0.33625678986147073, 'f1-score': 0.32818786672997446, 'support': 1374892}, 'weighted avg': {'precision': 0.33714278877712195, 'recall': 0.33537543312492907, 'f1-score': 0.32780134722493526, 'support': 1374892}}
[[162816 206674  94310]
 [158012 201626  90315]
 [160403 204073  96663]]
Evaluating performance on  val set...
1685/1685 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1112663
{'0': {'precision': 0.3404429969151739, 'recall': 0.35319487940223065, 'f1-score': 0.3467017224525567, 'support': 145608}, '1': {'precision': 0.32269695989313185, 'recall': 0.44165202611018267, 'f1-score': 0.37291804860399197, 'support': 140022}, '2': {'precision': 0.351782385304415, 'recall': 0.21336578370403056, 'f1-score': 0.2656235247667522, 'support': 145042}, 'accuracy': 0.33486272615819, 'macro avg': {'precision': 0.3383074473709069, 'recall': 0.33607089640548127, 'f1-score': 0.32841443194110026, 'support': 430672}, 'weighted avg': {'precision': 0.3384922129655601, 'recall': 0.33486272615819, 'f1-score': 0.32791972239597494, 'support': 430672}}
[[51428 65064 29116]
 [50272 61841 27909]
 [49362 64733 30947]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
987/987 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056539
{'0': {'precision': 0.31839557050034134, 'recall': 0.31430318458620343, 'f1-score': 0.31633614247497516, 'support': 80136}, '1': {'precision': 0.34498655013449864, 'recall': 0.39182927106285353, 'f1-score': 0.3669189085707297, 'support': 88046}, '2': {'precision': 0.3565296778764921, 'recall': 0.31033174006380987, 'f1-score': 0.33183048934375814, 'support': 84313}, 'accuracy': 0.34001069328105504, 'macro avg': {'precision': 0.3399705995037774, 'recall': 0.3388213985709556, 'f1-score': 0.3383618467964877, 'support': 252495}, 'weighted avg': {'precision': 0.340401671167976, 'recall': 0.34001069328105504, 'f1-score': 0.33914841634659443, 'support': 252495}}
[[25187 32172 22777]
 [29101 34499 24446]
 [24818 33330 26165]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123703
{'0': {'precision': 0.3373297309467522, 'recall': 0.2995152181518317, 'f1-score': 0.3172998014559894, 'support': 20009}, '1': {'precision': 0.3353122680935828, 'recall': 0.4269657333267021, 'f1-score': 0.37562896521548894, 'support': 20107}, '2': {'precision': 0.34234129295282467, 'recall': 0.2878127601233903, 'f1-score': 0.31271779320618204, 'support': 20423}, 'accuracy': 0.33789788400865556, 'macro avg': {'precision': 0.33832776399771985, 'recall': 0.338097903867308, 'f1-score': 0.3352155199592201, 'support': 60539}, 'weighted avg': {'precision': 0.3383503293256706, 'recall': 0.33789788400865556, 'f1-score': 0.33512708867953855, 'support': 60539}}
[[5993 8448 5568]
 [5798 8585 5724]
 [5975 8570 5878]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990355
{'0': {'precision': 0.4127282491944146, 'recall': 0.2123221439425335, 'f1-score': 0.28039770135911696, 'support': 7239}, '1': {'precision': 0.3436332424517823, 'recall': 0.4611736007589104, 'f1-score': 0.3938201597037379, 'support': 7379}, '2': {'precision': 0.32685312931142607, 'recall': 0.3732454883987396, 'f1-score': 0.3485122032764962, 'support': 6982}, 'accuracy': 0.34935185185185186, 'macro avg': {'precision': 0.3610715403192077, 'recall': 0.34891374436672784, 'f1-score': 0.3409100214464504, 'support': 21600}, 'weighted avg': {'precision': 0.3613656500380762, 'recall': 0.34935185185185186, 'f1-score': 0.3411625056420845, 'support': 21600}}
[[1537 3196 2506]
 [1115 3403 2861]
 [1072 3304 2606]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
1242/1242 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1108023
{'0': {'precision': 0.30086281933188547, 'recall': 0.36113365251967866, 'f1-score': 0.3282545858554194, 'support': 98584}, '1': {'precision': 0.3487704283441956, 'recall': 0.4509787861413711, 'f1-score': 0.39334346709635937, 'support': 109881}, '2': {'precision': 0.36994632650216086, 'recall': 0.1941664989847623, 'f1-score': 0.2546695617749733, 'support': 109334}, 'accuracy': 0.3347556159711012, 'macro avg': {'precision': 0.33985985805941404, 'recall': 0.33542631254860406, 'f1-score': 0.32542253824225065, 'support': 317799}, 'weighted avg': {'precision': 0.3411943249654354, 'recall': 0.3347556159711012, 'f1-score': 0.325443646666889, 'support': 317799}}
[[35602 45189 17793]
 [41965 49554 18362]
 [40766 47339 21229]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1148043
{'0': {'precision': 0.3382240182364522, 'recall': 0.36333481745325025, 'f1-score': 0.35033002414810843, 'support': 44920}, '1': {'precision': 0.3395824456753302, 'recall': 0.44876126126126126, 'f1-score': 0.3866116905166141, 'support': 44400}, '2': {'precision': 0.33822898799313894, 'recall': 0.2075931043558363, 'f1-score': 0.25727799070374296, 'support': 45594}, 'accuracy': 0.3388158382376922, 'macro avg': {'precision': 0.3386784839683072, 'recall': 0.3398963943567826, 'f1-score': 0.3314065684561552, 'support': 134914}, 'weighted avg': {'precision': 0.3386727542414077, 'recall': 0.3388158382376922, 'f1-score': 0.3308234612554453, 'support': 134914}}
[[16321 19357  9242]
 [15198 19925  9277]
 [16736 19393  9465]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046921
{'0': {'precision': 0.37853356890459366, 'recall': 0.2314652261985145, 'f1-score': 0.2872705941506746, 'support': 14810}, '1': {'precision': 0.3450366532546988, 'recall': 0.4579705903870071, 'f1-score': 0.39356217779454294, 'support': 13669}, '2': {'precision': 0.3143475664377426, 'recall': 0.34755694948828, 'f1-score': 0.33011915961116334, 'support': 12116}, 'accuracy': 0.3423820667569898, 'macro avg': {'precision': 0.34597259619901166, 'recall': 0.3456642553579339, 'f1-score': 0.3369839771854603, 'support': 40595}, 'weighted avg': {'precision': 0.3480976298503559, 'recall': 0.3423820667569898, 'f1-score': 0.33584930768552657, 'support': 40595}}
[[3428 6505 4877]
 [3101 6260 4308]
 [2527 5378 4211]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
1072/1072 - 20s - 20s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1203724
{'0': {'precision': 0.33213115927762166, 'recall': 0.4124629080118694, 'f1-score': 0.36796367259730023, 'support': 89979}, '1': {'precision': 0.29940382481224354, 'recall': 0.442324801098091, 'f1-score': 0.35709485283932624, 'support': 78682}, '2': {'precision': 0.35130867402119836, 'recall': 0.15386728816128542, 'f1-score': 0.2140042956345284, 'support': 105552}, 'accuracy': 0.32149095775911424, 'macro avg': {'precision': 0.32761455270368783, 'recall': 0.33621833242374866, 'f1-score': 0.3130209403570516, 'support': 274213}, 'weighted avg': {'precision': 0.3301224029670497, 'recall': 0.32149095775911424, 'f1-score': 0.30558187219625654, 'support': 274213}}
[[37113 36636 16230]
 [30120 34803 13759]
 [44509 44802 16241]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1108913
{'0': {'precision': 0.34006896551724136, 'recall': 0.3985934847627516, 'f1-score': 0.36701276469055855, 'support': 24742}, '1': {'precision': 0.33164777680906715, 'recall': 0.4688578471651602, 'f1-score': 0.3884936170212766, 'support': 24340}, '2': {'precision': 0.3491585289840017, 'recall': 0.14031059530767304, 'f1-score': 0.2001786777843955, 'support': 23954}, 'accuracy': 0.33729941398762253, 'macro avg': {'precision': 0.34029175710343673, 'recall': 0.33592064241186165, 'f1-score': 0.31856168649874356, 'support': 73036}, 'weighted avg': {'precision': 0.34024366936364336, 'recall': 0.33729941398762253, 'f1-score': 0.3194540296554998, 'support': 73036}}
[[ 9862 11712  3168]
 [ 9831 11412  3097]
 [ 9307 11286  3361]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033355
{'0': {'precision': 0.34084469032519227, 'recall': 0.2608156943727414, 'f1-score': 0.2955077211043519, 'support': 9685}, '1': {'precision': 0.3237357259380098, 'recall': 0.410487123797704, 'f1-score': 0.3619864106890419, 'support': 9669}, '2': {'precision': 0.38508581574275, 'recall': 0.3734098517455763, 'f1-score': 0.37915796629922793, 'support': 10455}, 'accuracy': 0.3488543728404173, 'macro avg': {'precision': 0.349888744001984, 'recall': 0.34823755663867395, 'f1-score': 0.34555069936420724, 'support': 29809}, 'weighted avg': {'precision': 0.35081196160503725, 'recall': 0.3488543728404173, 'f1-score': 0.3464099909928687, 'support': 29809}}
[[2526 3984 3175]
 [2641 3969 3059]
 [2244 4307 3904]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1233488
{'0': {'precision': 0.34094631380389234, 'recall': 0.4143217942734785, 'f1-score': 0.37406978257232615, 'support': 72854}, '1': {'precision': 0.2654643065048188, 'recall': 0.41284557479839723, 'f1-score': 0.3231436463725896, 'support': 59647}, '2': {'precision': 0.399078889492613, 'recall': 0.17638919067278114, 'f1-score': 0.24464676585350376, 'support': 87443}, 'accuracy': 0.31932673771505476, 'macro avg': {'precision': 0.3351631699337747, 'recall': 0.334518853248219, 'f1-score': 0.3139533982661398, 'support': 219944}, 'weighted avg': {'precision': 0.34358794770425316, 'recall': 0.31932673771505476, 'f1-score': 0.30880440549066135, 'support': 219944}}
[[30185 30776 11893]
 [23690 24625 11332]
 [34658 37361 15424]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1108938
{'0': {'precision': 0.3304403048264183, 'recall': 0.17055759915504243, 'f1-score': 0.22498738859929376, 'support': 27457}, '1': {'precision': 0.3272443590974556, 'recall': 0.5061256311256311, 'f1-score': 0.3974867339203452, 'support': 26936}, '2': {'precision': 0.32541586073500967, 'recall': 0.3082560738759207, 'f1-score': 0.31660362445661383, 'support': 27289}, 'accuracy': 0.3272201953918856, 'macro avg': {'precision': 0.3277001748862945, 'recall': 0.32831310138553144, 'f1-score': 0.31302591565875093, 'support': 81682}, 'weighted avg': {'precision': 0.32770778053752, 'recall': 0.3272201953918856, 'f1-score': 0.3124798327837928, 'support': 81682}}
[[ 4683 14112  8662]
 [ 4527 13633  8776]
 [ 4962 13915  8412]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135594
{'0': {'precision': 0.34957764782326184, 'recall': 0.3109826589595376, 'f1-score': 0.3291526460691343, 'support': 8650}, '1': {'precision': 0.30916507117289604, 'recall': 0.47536157685908104, 'f1-score': 0.3746595379804298, 'support': 7813}, '2': {'precision': 0.3457072149248049, 'recall': 0.21369734055071782, 'f1-score': 0.26412624536397356, 'support': 8498}, 'accuracy': 0.3293137294178919, 'macro avg': {'precision': 0.3348166446403209, 'recall': 0.33334719212311215, 'f1-score': 0.3226461431378459, 'support': 24961}, 'weighted avg': {'precision': 0.33561048304058505, 'recall': 0.3293137294178919, 'f1-score': 0.32125837073202823, 'support': 24961}}
[[2690 4190 1770]
 [2432 3714 1667]
 [2573 4109 1816]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1092042
{'0': {'precision': 0.29407447568167994, 'recall': 0.29876602919345197, 'f1-score': 0.2964016886972573, 'support': 148869}, '1': {'precision': 0.3579253873007191, 'recall': 0.4976208182595908, 'f1-score': 0.41636821704519666, 'support': 178843}, '2': {'precision': 0.33480689984560874, 'recall': 0.18583045121357278, 'f1-score': 0.23900443232185475, 'support': 162207}, 'accuracy': 0.33396541060869245, 'macro avg': {'precision': 0.32893558760933594, 'recall': 0.3274057662222052, 'f1-score': 0.3172581126881029, 'support': 489919}, 'weighted avg': {'precision': 0.33086907420315437, 'recall': 0.33396541060869245, 'f1-score': 0.3211913724295592, 'support': 489919}}
[[44477 76873 27519]
 [57478 88996 32369]
 [49289 82775 30143]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1157981
{'0': {'precision': 0.3396287179959053, 'recall': 0.477490297542044, 'f1-score': 0.3969297361239935, 'support': 61840}, '1': {'precision': 0.3420633712157916, 'recall': 0.4070669631826044, 'f1-score': 0.37174491898966505, 'support': 60705}, '2': {'precision': 0.3481589958158996, 'recall': 0.13745085731276224, 'f1-score': 0.19709135697197944, 'support': 60538}, 'accuracy': 0.34170294347372504, 'macro avg': {'precision': 0.3432836950091988, 'recall': 0.34066937267913683, 'f1-score': 0.321922004028546, 'support': 183083}, 'weighted avg': {'precision': 0.34325658941149284, 'recall': 0.34170294347372504, 'f1-score': 0.32250086986528004, 'support': 183083}}
[[29528 23999  8313]
 [28728 24711  7266]
 [28686 23531  8321]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.115104
{'0': {'precision': 0.32018128499066917, 'recall': 0.3298000878734622, 'f1-score': 0.3249195141087033, 'support': 18208}, '1': {'precision': 0.32672491478274496, 'recall': 0.4654238990902495, 'f1-score': 0.38393186003683244, 'support': 17917}, '2': {'precision': 0.34232845026985353, 'recall': 0.1916994980840844, 'f1-score': 0.2457706279190451, 'support': 18529}, 'accuracy': 0.3274417243019724, 'macro avg': {'precision': 0.32974488334775587, 'recall': 0.328974495015932, 'f1-score': 0.31820733402152696, 'support': 54654}, 'weighted avg': {'precision': 0.32983487009775425, 'recall': 0.3274417243019724, 'f1-score': 0.3174319466806306, 'support': 54654}}
[[6005 8418 3785]
 [6539 8339 3039]
 [6211 8766 3552]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
4918/4918 - 87s - 87s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1173089
{'0': {'precision': 0.3317190615359388, 'recall': 0.5158508102955195, 'f1-score': 0.40378392949250685, 'support': 419600}, '1': {'precision': 0.3249940685417385, 'recall': 0.39957200532419496, 'f1-score': 0.3584449682906877, 'support': 407949}, '2': {'precision': 0.3346410469345093, 'recall': 0.08128637343782606, 'f1-score': 0.1308004992043697, 'support': 431290}, 'accuracy': 0.3292827756369162, 'macro avg': {'precision': 0.3304513923373955, 'recall': 0.3322363963525135, 'f1-score': 0.29767646566252143, 'support': 1258839}, 'weighted avg': {'precision': 0.33054080833243815, 'recall': 0.3292827756369162, 'f1-score': 0.2955643656465412, 'support': 1258839}}
[[216451 167760  35389]
 [210628 163005  34316]
 [225434 170798  35058]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076168
{'0': {'precision': 0.3382319348206807, 'recall': 0.25739640072184233, 'f1-score': 0.2923288817437821, 'support': 120802}, '1': {'precision': 0.33093696627874647, 'recall': 0.4247336493857369, 'f1-score': 0.37201410903245974, 'support': 117702}, '2': {'precision': 0.3568503366756619, 'recall': 0.3435539028520203, 'f1-score': 0.3500759103961296, 'support': 120476}, 'accuracy': 0.3411777814920051, 'macro avg': {'precision': 0.3420064125916964, 'recall': 0.3418946509865332, 'f1-score': 0.3381396337241238, 'support': 358980}, 'weighted avg': {'precision': 0.3420885234734134, 'recall': 0.3411777814920051, 'f1-score': 0.337836268356552, 'support': 358980}}
[[31094 51204 38504]
 [31617 49992 36093]
 [29220 49866 41390]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105455
{'0': {'precision': 0.3593055466082587, 'recall': 0.2582833591886823, 'f1-score': 0.30053209402572906, 'support': 43189}, '1': {'precision': 0.2986516808506337, 'recall': 0.41087966181828295, 'f1-score': 0.3458900100671926, 'support': 35957}, '2': {'precision': 0.37467418605753283, 'recall': 0.36290193018291983, 'f1-score': 0.3686941112004944, 'support': 43571}, 'accuracy': 0.3401403228566539, 'macro avg': {'precision': 0.3442104711721417, 'recall': 0.3440216503966284, 'f1-score': 0.33837207176447204, 'support': 122717}, 'weighted avg': {'precision': 0.34699018637615886, 'recall': 0.3401403228566539, 'f1-score': 0.3380234101223139, 'support': 122717}}
[[11155 17646 14388]
 [ 9181 14774 12002]
 [10710 17049 15812]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
4856/4856 - 86s - 86s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1108962
{'0': {'precision': 0.3594005479492141, 'recall': 0.22091514730449524, 'f1-score': 0.2736339052722163, 'support': 444759}, '1': {'precision': 0.2900825860969994, 'recall': 0.4631393152139439, 'f1-score': 0.35673059969878046, 'support': 362595}, '2': {'precision': 0.35476727485913095, 'recall': 0.31816251139361407, 'f1-score': 0.3354693147348825, 'support': 435551}, 'accuracy': 0.32565803500669804, 'macro avg': {'precision': 0.3347501363017815, 'recall': 0.3340723246373511, 'f1-score': 0.3219446065686264, 'support': 1242905}, 'weighted avg': {'precision': 0.33755465216034647, 'recall': 0.32565803500669804, 'f1-score': 0.3195448319661099, 'support': 1242905}}
[[ 98254 208523 137982]
 [ 80610 167932 114053]
 [ 94519 202456 138576]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126946
{'0': {'precision': 0.3347074321308769, 'recall': 0.3917852388201392, 'f1-score': 0.3610041407867495, 'support': 178021}, '1': {'precision': 0.33053535173936593, 'recall': 0.4561390494559108, 'f1-score': 0.3833099969311033, 'support': 175247}, '2': {'precision': 0.34512871043231924, 'recall': 0.1572958650963838, 'f1-score': 0.2161013681304274, 'support': 178142}, 'accuracy': 0.33440093336595095, 'macro avg': {'precision': 0.33679049810085404, 'recall': 0.335073384457478, 'f1-score': 0.3201385019494267, 'support': 531410}, 'weighted avg': {'precision': 0.33682504901201277, 'recall': 0.33440093336595095, 'f1-score': 0.31978505316172745, 'support': 531410}}
[[69746 81101 27174]
 [69315 79937 25995]
 [69318 80803 28021]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1153778
{'0': {'precision': 0.34821043924798817, 'recall': 0.3966590110515674, 'f1-score': 0.3708591040064602, 'support': 50943}, '1': {'precision': 0.328706335380948, 'recall': 0.36493556727265325, 'f1-score': 0.3458748167013969, 'support': 49121}, '2': {'precision': 0.33380139889783805, 'recall': 0.2507463280659157, 'f1-score': 0.28637345152858273, 'support': 50246}, 'accuracy': 0.33751580067859754, 'macro avg': {'precision': 0.3369060578422581, 'recall': 0.3374469687967121, 'f1-score': 0.3343691240788133, 'support': 150310}, 'weighted avg': {'precision': 0.33701984828606596, 'recall': 0.33751580067859754, 'f1-score': 0.33445221643334166, 'support': 150310}}
[[20207 18273 12463]
 [18513 17926 12682]
 [19311 18336 12599]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
4353/4353 - 78s - 78s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1088079
{'0': {'precision': 0.37749329503319506, 'recall': 0.12664778566125312, 'f1-score': 0.18966393237412188, 'support': 406758}, '1': {'precision': 0.3099984593428692, 'recall': 0.4423069692105225, 'f1-score': 0.3645181167322781, 'support': 345735}, '2': {'precision': 0.32750770856465905, 'recall': 0.4386074987216518, 'f1-score': 0.3750019200752433, 'support': 361795}, 'accuracy': 0.32587804948092414, 'macro avg': {'precision': 0.3383331543135744, 'recall': 0.33585408453114246, 'f1-score': 0.30972798972721444, 'support': 1114288}, 'weighted avg': {'precision': 0.3403217000112808, 'recall': 0.32587804948092414, 'f1-score': 0.30409356698330225, 'support': 1114288}}
[[ 51515 183471 171772]
 [ 38746 152921 154068]
 [ 46205 156904 158686]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1114012
{'0': {'precision': 0.3344159610254031, 'recall': 0.25617558201528345, 'f1-score': 0.29011320754716985, 'support': 135048}, '1': {'precision': 0.3282676569374143, 'recall': 0.4251242504767083, 'f1-score': 0.3704699778107743, 'support': 130583}, '2': {'precision': 0.3430765825949393, 'recall': 0.3246284863338814, 'f1-score': 0.3335976822313704, 'support': 128932}, 'accuracy': 0.33445862891350686, 'macro avg': {'precision': 0.33525340018591887, 'recall': 0.3353094396086244, 'f1-score': 0.3313936225297715, 'support': 394563}, 'weighted avg': {'precision': 0.3352111883211242, 'recall': 0.33445862891350686, 'f1-score': 0.33091725765150193, 'support': 394563}}
[[34596 58675 41777]
 [36702 55514 38367]
 [32154 54923 41855]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1229889
{'0': {'precision': 0.34975401486747143, 'recall': 0.3731760897213551, 'f1-score': 0.36108562862193183, 'support': 43245}, '1': {'precision': 0.3078465385568497, 'recall': 0.3666192686394978, 'f1-score': 0.334672185349367, 'support': 37273}, '2': {'precision': 0.3524405125076266, 'recall': 0.2699803701626472, 'f1-score': 0.3057481606944371, 'support': 42792}, 'accuracy': 0.335382369637499, 'macro avg': {'precision': 0.3366803553106492, 'recall': 0.33659190950783335, 'f1-score': 0.33383532488857864, 'support': 123310}, 'weighted avg': {'precision': 0.3380189020825531, 'recall': 0.335382369637499, 'f1-score': 0.3338979779962594, 'support': 123310}}
[[16138 15555 11552]
 [13933 13665  9675]
 [16070 15169 11553]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
5497/5497 - 96s - 96s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1233103
{'0': {'precision': 0.3468072902681498, 'recall': 0.450363755658536, 'f1-score': 0.39185927419970146, 'support': 484666}, '1': {'precision': 0.29294484589390757, 'recall': 0.43351293917527534, 'f1-score': 0.3496290734846259, 'support': 410343}, '2': {'precision': 0.3663246760860644, 'recall': 0.12199331500687242, 'f1-score': 0.18303303347286462, 'support': 512192}, 'accuracy': 0.32592998441587234, 'macro avg': {'precision': 0.3353589374160406, 'recall': 0.3352900032802279, 'f1-score': 0.308173793719064, 'support': 1407201}, 'weighted avg': {'precision': 0.33820480339171183, 'recall': 0.32592998441587234, 'f1-score': 0.30353642825062505, 'support': 1407201}}
[[218276 204968  61422]
 [185790 177889  46664]
 [225321 224387  62484]]
Evaluating performance on  train set...
2058/2058 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085511
{'0': {'precision': 0.3413417592146081, 'recall': 0.2646661606804027, 'f1-score': 0.29815324165029466, 'support': 179188}, '1': {'precision': 0.32175617043060833, 'recall': 0.45223940455548084, 'f1-score': 0.3759990977473104, 'support': 169554}, '2': {'precision': 0.3433841669285232, 'recall': 0.2884120798283937, 'f1-score': 0.3135065846698509, 'support': 178082}, 'accuracy': 0.33306189543376913, 'macro avg': {'precision': 0.3354940321912465, 'recall': 0.33510588168809247, 'f1-score': 0.3292196413558186, 'support': 526824}, 'weighted avg': {'precision': 0.33572869133961974, 'recall': 0.33306189543376913, 'f1-score': 0.32839717570850385, 'support': 526824}}
[[47425 82054 49709]
 [44372 76679 48503]
 [47140 79581 51361]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1092824
{'0': {'precision': 0.33252241938561344, 'recall': 0.3512841617254296, 'f1-score': 0.3416459056565244, 'support': 59533}, '1': {'precision': 0.31448486070956316, 'recall': 0.5017162471395881, 'f1-score': 0.3866257043272211, 'support': 55936}, '2': {'precision': 0.37092336145067434, 'recall': 0.13977562468128507, 'f1-score': 0.20303954369807034, 'support': 58830}, 'accuracy': 0.3281717049438035, 'macro avg': {'precision': 0.339310213848617, 'recall': 0.33092534451543426, 'f1-score': 0.31043705122727194, 'support': 174299}, 'weighted avg': {'precision': 0.33969502817616287, 'recall': 0.3281717049438035, 'f1-score': 0.3092979159631139, 'support': 174299}}
[[20913 31110  7510]
 [21436 28064  6436]
 [20543 30064  8223]]
testing model on single stock: results/universal/W2/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
14883/14883 - 257s - 257s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117324
{'0': {'precision': 0.30723401417964674, 'recall': 0.33650880856191556, 'f1-score': 0.32120576232907666, 'support': 1204964}, '1': {'precision': 0.3552805822937019, 'recall': 0.4687652269885346, 'f1-score': 0.40420855473699696, 'support': 1362712}, '2': {'precision': 0.3331888511790466, 'recall': 0.18564219145837743, 'f1-score': 0.2384356502184196, 'support': 1242223}, 'accuracy': 0.33462356876127164, 'macro avg': {'precision': 0.3319011492174651, 'recall': 0.33030540900294253, 'f1-score': 0.32128332242816443, 'support': 3809899}, 'weighted avg': {'precision': 0.33288176242959927, 'recall': 0.33462356876127164, 'f1-score': 0.32390661195037773, 'support': 3809899}}
[[405481 570713 228770]
 [491172 638792 232748]
 [423126 588488 230609]]
Evaluating performance on  train set...
6147/6147 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158007
{'0': {'precision': 0.3197648341932632, 'recall': 0.3812898707974544, 'f1-score': 0.3478276130155437, 'support': 519804}, '1': {'precision': 0.3292588987047331, 'recall': 0.41786429066276654, 'f1-score': 0.36830749763806503, 'support': 519640}, '2': {'precision': 0.36190340223461787, 'recall': 0.1993629702588378, 'f1-score': 0.2570976661072407, 'support': 534041}, 'accuracy': 0.33162248130741634, 'macro avg': {'precision': 0.3369757117108714, 'recall': 0.3328390439063529, 'f1-score': 0.3244109255869498, 'support': 1573485}, 'weighted avg': {'precision': 0.337202063463395, 'recall': 0.33162248130741634, 'f1-score': 0.3237972953883594, 'support': 1573485}}
[[198196 217160 104448]
 [219228 217139  83273]
 [202394 225179 106468]]
Evaluating performance on  val set...
2174/2174 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1164074
{'0': {'precision': 0.32649772600857246, 'recall': 0.43535166794823554, 'f1-score': 0.37314810703175944, 'support': 183369}, '1': {'precision': 0.34821450211099314, 'recall': 0.3912733254174882, 'f1-score': 0.3684903013344482, 'support': 183598}, '2': {'precision': 0.37006026547081805, 'recall': 0.20637131536322723, 'f1-score': 0.26497446110907885, 'support': 189537}, 'accuracy': 0.3428223337118871, 'macro avg': {'precision': 0.3482574978634612, 'recall': 0.3443321029096503, 'f1-score': 0.33553762315842883, 'support': 556504}, 'weighted avg': {'precision': 0.3484991306721649, 'recall': 0.3428223337118871, 'f1-score': 0.3347690978284796, 'support': 556504}}
[[79830 65640 37899]
 [83076 71837 28685]
 [81598 68824 39115]]
training model: results/universal/W2/deepLOB_L2/h500
Epoch 1/50
9940/9940 - 457s - loss: 3.2073 - accuracy500: 0.4222 - val_loss: 3.4606 - val_accuracy500: 0.3351 - 457s/epoch - 46ms/step
Epoch 2/50
9940/9940 - 452s - loss: 3.1817 - accuracy500: 0.4345 - val_loss: 3.3621 - val_accuracy500: 0.3480 - 452s/epoch - 46ms/step
Epoch 3/50
9940/9940 - 451s - loss: 3.1657 - accuracy500: 0.4403 - val_loss: 3.4886 - val_accuracy500: 0.3417 - 451s/epoch - 45ms/step
Epoch 4/50
9940/9940 - 451s - loss: 3.1527 - accuracy500: 0.4453 - val_loss: 3.5553 - val_accuracy500: 0.3359 - 451s/epoch - 45ms/step
Epoch 5/50
9940/9940 - 451s - loss: 3.1438 - accuracy500: 0.4482 - val_loss: 3.4968 - val_accuracy500: 0.3542 - 451s/epoch - 45ms/step
Epoch 6/50
9940/9940 - 452s - loss: 3.1375 - accuracy500: 0.4506 - val_loss: 3.5842 - val_accuracy500: 0.3462 - 452s/epoch - 45ms/step
Epoch 7/50
9940/9940 - 451s - loss: 3.1297 - accuracy500: 0.4536 - val_loss: 3.4967 - val_accuracy500: 0.3449 - 451s/epoch - 45ms/step
Epoch 8/50
9940/9940 - 450s - loss: 3.1242 - accuracy500: 0.4557 - val_loss: 3.8139 - val_accuracy500: 0.3432 - 450s/epoch - 45ms/step
Epoch 9/50
9940/9940 - 452s - loss: 3.1187 - accuracy500: 0.4576 - val_loss: 3.6172 - val_accuracy500: 0.3539 - 452s/epoch - 45ms/step
Epoch 10/50
9940/9940 - 450s - loss: 3.1139 - accuracy500: 0.4593 - val_loss: 3.6406 - val_accuracy500: 0.3496 - 450s/epoch - 45ms/step
Epoch 11/50
9940/9940 - 451s - loss: 3.1108 - accuracy500: 0.4606 - val_loss: 3.7391 - val_accuracy500: 0.3488 - 451s/epoch - 45ms/step
Epoch 12/50
9940/9940 - 451s - loss: 3.1053 - accuracy500: 0.4624 - val_loss: 3.7279 - val_accuracy500: 0.3458 - 451s/epoch - 45ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 454s - 454s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122886
{'0': {'precision': 0.3157134624994919, 'recall': 0.362028806823193, 'f1-score': 0.33728859272990386, 'support': 2188301}, '1': {'precision': 0.35374394980338664, 'recall': 0.3949187111257648, 'f1-score': 0.373199070864604, 'support': 2332361}, '2': {'precision': 0.3362268770504142, 'recall': 0.24567850563631677, 'f1-score': 0.28390772509138695, 'support': 2200107}, 'accuracy': 0.3353544810125151, 'macro avg': {'precision': 0.3352280964510976, 'recall': 0.3342086745284248, 'f1-score': 0.33146512956196494, 'support': 6720769}, 'weighted avg': {'precision': 0.33562673914179064, 'recall': 0.3353544810125151, 'f1-score': 0.3322761571195076, 'support': 6720769}}
[[792228 838000 558073]
 [902258 921093 509010]
 [814840 844748 540519]]
Evaluating performance on  train set...
9940/9940 - 178s - 178s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1204227
{'0': {'precision': 0.3313681439670011, 'recall': 0.3994973318392724, 'f1-score': 0.3622573339513939, 'support': 855833}, '1': {'precision': 0.33571862105547706, 'recall': 0.3177565581763587, 'f1-score': 0.32649072813354857, 'support': 828584}, '2': {'precision': 0.34853486901784, 'recall': 0.29514075187934924, 'f1-score': 0.3196232386577405, 'support': 859207}, 'accuracy': 0.3376198683453215, 'macro avg': {'precision': 0.338540544680106, 'recall': 0.3374648806316601, 'f1-score': 0.33612376691422763, 'support': 2543624}, 'weighted avg': {'precision': 0.33858403202224585, 'recall': 0.3376198683453215, 'f1-score': 0.3362050752724588, 'support': 2543624}}
[[341903 258314 255616]
 [346919 263288 218377]
 [342970 262650 253587]]
Evaluating performance on  val set...
3393/3393 - 59s - 59s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1211606
{'0': {'precision': 0.3407280242255209, 'recall': 0.4606996262941861, 'f1-score': 0.39173410931569524, 'support': 293814}, '1': {'precision': 0.3490384133820804, 'recall': 0.30235029988828754, 'f1-score': 0.3240211775508662, 'support': 276603}, '2': {'precision': 0.3599318386270846, 'recall': 0.2795780562367723, 'f1-score': 0.3147067610033164, 'support': 297670}, 'accuracy': 0.34813676509382124, 'macro avg': {'precision': 0.349899425411562, 'recall': 0.3475426608064153, 'f1-score': 0.3434873492899593, 'support': 868087}, 'weighted avg': {'precision': 0.34996105962955915, 'recall': 0.34813676509382124, 'f1-score': 0.3437454505325401, 'support': 868087}}
[[135360  77131  81323]
 [126301  83631  66671]
 [135606  78842  83222]]
testing model out of sample: results/universal/W2/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 249s - 249s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1202381
{'0': {'precision': 0.3321747409142278, 'recall': 0.3740305580864775, 'f1-score': 0.3518622811303929, 'support': 1236923}, '1': {'precision': 0.31321057587923146, 'recall': 0.348681903697362, 'f1-score': 0.3299957718981145, 'support': 1123666}, '2': {'precision': 0.3633885256429681, 'recall': 0.2846217568660117, 'f1-score': 0.319218022877648, 'support': 1306144}, 'accuracy': 0.3344137683327365, 'macro avg': {'precision': 0.33625794747880916, 'recall': 0.33577807288328376, 'f1-score': 0.33369202530205183, 'support': 3666733}, 'weighted avg': {'precision': 0.33748200222082453, 'recall': 0.3344137683327365, 'f1-score': 0.3335329522661777, 'support': 3666733}}
[[462647 414945 359331]
 [439923 391802 291941]
 [490212 444175 371757]]
Evaluating performance on  train set...
5373/5373 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1135181
{'0': {'precision': 0.32579891739440187, 'recall': 0.3867155744154064, 'f1-score': 0.35365320125369354, 'support': 458823}, '1': {'precision': 0.3373837001385028, 'recall': 0.36819839187181547, 'f1-score': 0.3521181652465831, 'support': 463769}, '2': {'precision': 0.34414921348869204, 'recall': 0.2466438204731373, 'f1-score': 0.2873502967983896, 'support': 452300}, 'accuracy': 0.3343899011704192, 'macro avg': {'precision': 0.3357772770071989, 'recall': 0.33385259558678637, 'f1-score': 0.33104055443288877, 'support': 1374892}, 'weighted avg': {'precision': 0.3357433363246861, 'recall': 0.3343899011704192, 'f1-score': 0.33132366133411034, 'support': 1374892}}
[[177434 169028 112361]
 [192775 170759 100235]
 [174403 166340 111557]]
Evaluating performance on  val set...
1685/1685 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1199315
{'0': {'precision': 0.31338702876388425, 'recall': 0.4156772791311797, 'f1-score': 0.3573563155428147, 'support': 141249}, '1': {'precision': 0.3414991990102622, 'recall': 0.28928928928928926, 'f1-score': 0.31323355580206946, 'support': 148851}, '2': {'precision': 0.35905310300703774, 'recall': 0.29941951455481886, 'f1-score': 0.32653599537620687, 'support': 140572}, 'accuracy': 0.3340477207712598, 'macro avg': {'precision': 0.33797977692706144, 'recall': 0.3347953609917626, 'f1-score': 0.33237528890703033, 'support': 430672}, 'weighted avg': {'precision': 0.3380087734834207, 'recall': 0.3340477207712598, 'f1-score': 0.3320465880550048, 'support': 430672}}
[[58714 41638 40897]
 [71552 43061 34238]
 [57087 41395 42090]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
987/987 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1121789
{'0': {'precision': 0.2997008871989861, 'recall': 0.3833622992918472, 'f1-score': 0.3364081785952074, 'support': 77102}, '1': {'precision': 0.3901397050005996, 'recall': 0.27149637511083297, 'f1-score': 0.3201805913505601, 'support': 95865}, '2': {'precision': 0.3607356754400055, 'recall': 0.39534503571069307, 'f1-score': 0.37724823920425227, 'support': 79528}, 'accuracy': 0.3446642507772431, 'macro avg': {'precision': 0.35019208921319706, 'recall': 0.3500679033711244, 'f1-score': 0.34461233638333993, 'support': 252495}, 'weighted avg': {'precision': 0.35326191576503085, 'recall': 0.3446642507772431, 'f1-score': 0.34311037344622625, 'support': 252495}}
[[29558 20332 27212]
 [41333 26027 28505]
 [27734 20353 31441]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1199423
{'0': {'precision': 0.33618532973081156, 'recall': 0.3338633540372671, 'f1-score': 0.3350203186158411, 'support': 20125}, '1': {'precision': 0.33657817109144544, 'recall': 0.3381742738589212, 'f1-score': 0.3373743347131875, 'support': 20244}, '2': {'precision': 0.328946717459061, 'recall': 0.3296479920674269, 'f1-score': 0.3292969814030656, 'support': 20170}, 'accuracy': 0.3339004608599415, 'macro avg': {'precision': 0.33390340609377267, 'recall': 0.3338952066545384, 'f1-score': 0.3338972115773647, 'support': 60539}, 'weighted avg': {'precision': 0.3339049793943915, 'recall': 0.3339004608599415, 'f1-score': 0.3339006270169214, 'support': 60539}}
[[6719 6712 6694]
 [6528 6846 6870]
 [6739 6782 6649]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058232
{'0': {'precision': 0.4143635263264071, 'recall': 0.29167850042601534, 'f1-score': 0.3423618634886241, 'support': 7042}, '1': {'precision': 0.37021409595249255, 'recall': 0.2921445307682822, 'f1-score': 0.3265784394816653, 'support': 8109}, '2': {'precision': 0.3163803201874268, 'recall': 0.502558536207164, 'f1-score': 0.38830647576828614, 'support': 6449}, 'accuracy': 0.3548148148148148, 'macro avg': {'precision': 0.3669859808221088, 'recall': 0.3621271891338205, 'f1-score': 0.3524155929128585, 'support': 21600}, 'weighted avg': {'precision': 0.3685347565443535, 'recall': 0.3548148148148148, 'f1-score': 0.3501539477163607, 'support': 21600}}
[[2054 2039 2949]
 [1686 2369 4054]
 [1217 1991 3241]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
1242/1242 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006024
{'0': {'precision': 0.24442000588590634, 'recall': 0.38346111320364995, 'f1-score': 0.29854558354026245, 'support': 82303}, '1': {'precision': 0.4807832466838346, 'recall': 0.4182841683282019, 'f1-score': 0.4473613816436405, 'support': 141937}, '2': {'precision': 0.34191836296421285, 'recall': 0.23824538526491304, 'f1-score': 0.2808188976377953, 'support': 93559}, 'accuracy': 0.3562629209028348, 'macro avg': {'precision': 0.3557072051779846, 'recall': 0.34666355559892165, 'f1-score': 0.3422419542738994, 'support': 317799}, 'weighted avg': {'precision': 0.3786889560683324, 'recall': 0.3562629209028348, 'f1-score': 0.3597917703723489, 'support': 317799}}
[[31560 30427 20316]
 [59982 59370 22585]
 [37580 33689 22290]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157324
{'0': {'precision': 0.33073937019300537, 'recall': 0.3980135341628465, 'f1-score': 0.3612712754364065, 'support': 45810}, '1': {'precision': 0.348513625984336, 'recall': 0.37061159650516284, 'f1-score': 0.35922308741366415, 'support': 44065}, '2': {'precision': 0.3362893673884654, 'recall': 0.24585359355225472, 'f1-score': 0.28404689223507684, 'support': 45039}, 'accuracy': 0.33826734067628267, 'macro avg': {'precision': 0.33851412118860225, 'recall': 0.33815957474008806, 'f1-score': 0.33484708502838245, 'support': 134914}, 'weighted avg': {'precision': 0.3383974998543549, 'recall': 0.33826734067628267, 'f1-score': 0.33482211226411285, 'support': 134914}}
[[18233 15704 11873]
 [17753 16331  9981]
 [19142 14824 11073]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102655
{'0': {'precision': 0.3350634905922699, 'recall': 0.2623938448138201, 'f1-score': 0.29430920784824555, 'support': 13777}, '1': {'precision': 0.4156229638746109, 'recall': 0.35847642834842336, 'f1-score': 0.3849403245272898, 'support': 16015}, '2': {'precision': 0.3081973363346464, 'recall': 0.45626214940294363, 'f1-score': 0.3678907299596955, 'support': 10803}, 'accuracy': 0.3518906269244981, 'macro avg': {'precision': 0.35296126360050906, 'recall': 0.35904414085506237, 'f1-score': 0.3490467541117437, 'support': 40595}, 'weighted avg': {'precision': 0.35969521617846484, 'recall': 0.3518906269244981, 'f1-score': 0.3496450501190889, 'support': 40595}}
[[3615 4411 5751]
 [4961 5741 5313]
 [2213 3661 4929]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
1072/1072 - 20s - 20s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1249528
{'0': {'precision': 0.3247655409602594, 'recall': 0.48843594768263227, 'f1-score': 0.39013004031340714, 'support': 87772}, '1': {'precision': 0.29767371064714987, 'recall': 0.2981540064285805, 'f1-score': 0.29791366495502986, 'support': 78711}, '2': {'precision': 0.33994539916994115, 'recall': 0.19996287013830874, 'f1-score': 0.2518074331235133, 'support': 107730}, 'accuracy': 0.3204844409273083, 'macro avg': {'precision': 0.3207948835924502, 'recall': 0.3288509414165071, 'f1-score': 0.31328371279731676, 'support': 274213}, 'weighted avg': {'precision': 0.32295272052196455, 'recall': 0.3204844409273083, 'f1-score': 0.30931717734410774, 'support': 274213}}
[[42871 23338 21563]
 [34979 23468 20264]
 [54156 32032 21542]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1113487
{'0': {'precision': 0.3241341329090687, 'recall': 0.43476833422251404, 'f1-score': 0.3713870046099104, 'support': 24367}, '1': {'precision': 0.34464179548156954, 'recall': 0.3697576144155637, 'f1-score': 0.3567582121701669, 'support': 25084}, '2': {'precision': 0.3445684523809524, 'recall': 0.19635361458554165, 'f1-score': 0.25015530047265366, 'support': 23585}, 'accuracy': 0.3354510104605948, 'macro avg': {'precision': 0.3377814602571969, 'recall': 0.3336265210745398, 'f1-score': 0.326100172417577, 'support': 73036}, 'weighted avg': {'precision': 0.3377761400386074, 'recall': 0.3354510104605948, 'f1-score': 0.32721429017270515, 'support': 73036}}
[[10594  9216  4557]
 [11557  9275  4252]
 [10533  8421  4631]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137388
{'0': {'precision': 0.33438735177865614, 'recall': 0.35154789112819446, 'f1-score': 0.3427529626253419, 'support': 9626}, '1': {'precision': 0.3069682151589242, 'recall': 0.25838649927968715, 'f1-score': 0.2805900100569896, 'support': 9718}, '2': {'precision': 0.3808323920410114, 'recall': 0.4188246536072623, 'f1-score': 0.3989260034586329, 'support': 10465}, 'accuracy': 0.34479519608172027, 'macro avg': {'precision': 0.3407293196595306, 'recall': 0.3429196813383813, 'f1-score': 0.3407563253803214, 'support': 29809}, 'weighted avg': {'precision': 0.3417538577558776, 'recall': 0.34479519608172027, 'f1-score': 0.34220786883692705, 'support': 29809}}
[[3384 2665 3577]
 [3658 2511 3549]
 [3078 3004 4383]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.109794
{'0': {'precision': 0.34315746285424015, 'recall': 0.49294845708031043, 'f1-score': 0.40463519708802725, 'support': 71261}, '1': {'precision': 0.28914773088918594, 'recall': 0.3741455138447347, 'f1-score': 0.3262005974264706, 'support': 60709}, '2': {'precision': 0.421480190661678, 'recall': 0.18695296337554276, 'f1-score': 0.2590160320010079, 'support': 87974}, 'accuracy': 0.3377632488269741, 'macro avg': {'precision': 0.3512617948017014, 'recall': 0.35134897810019594, 'f1-score': 0.32995060883850197, 'support': 219944}, 'weighted avg': {'precision': 0.3595774917628035, 'recall': 0.3377632488269741, 'f1-score': 0.32474037595074284, 'support': 219944}}
[[35128 24539 11594]
 [27014 22714 10981]
 [40225 31302 16447]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1197437
{'0': {'precision': 0.33531024807091386, 'recall': 0.19216431547401505, 'f1-score': 0.24431382570917454, 'support': 27362}, '1': {'precision': 0.3252654740265952, 'recall': 0.3783242461333037, 'f1-score': 0.3497942386831276, 'support': 26961}, '2': {'precision': 0.32480803648750073, 'recall': 0.4112723418253591, 'f1-score': 0.3629618877114885, 'support': 27359}, 'accuracy': 0.3269998286036091, 'macro avg': {'precision': 0.32846125286166994, 'recall': 0.3272536344775593, 'f1-score': 0.3190233173679302, 'support': 81682}, 'weighted avg': {'precision': 0.328477076016857, 'recall': 0.3269998286036091, 'f1-score': 0.3188706404604301, 'support': 81682}}
[[ 5258 10365 11739]
 [ 5110 10200 11651]
 [ 5313 10794 11252]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1168904
{'0': {'precision': 0.3459331337325349, 'recall': 0.3170592270752344, 'f1-score': 0.33086743825319176, 'support': 8746}, '1': {'precision': 0.30371255283955156, 'recall': 0.4426734529868738, 'f1-score': 0.36025724874645737, 'support': 7466}, '2': {'precision': 0.32673593930397493, 'recall': 0.2264258772431135, 'f1-score': 0.2674858223062382, 'support': 8749}, 'accuracy': 0.3228636673210208, 'macro avg': {'precision': 0.3254605419586872, 'recall': 0.3287195191017406, 'f1-score': 0.3195368364352958, 'support': 24961}, 'weighted avg': {'precision': 0.326575932057823, 'recall': 0.3228636673210208, 'f1-score': 0.31744243794161864, 'support': 24961}}
[[2773 3703 2270]
 [2349 3305 1812]
 [2894 3874 1981]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1169719
{'0': {'precision': 0.3206523603187488, 'recall': 0.3428185524040019, 'f1-score': 0.33136517632186013, 'support': 163623}, '1': {'precision': 0.3016978303841767, 'recall': 0.33797172809194725, 'f1-score': 0.3188062828546727, 'support': 149477}, '2': {'precision': 0.38042240537902616, 'recall': 0.317420639184703, 'f1-score': 0.34607760016031813, 'support': 176819}, 'accuracy': 0.3321732776234439, 'macro avg': {'precision': 0.3342575320273172, 'recall': 0.33273697322688406, 'f1-score': 0.33208301977895033, 'support': 489919}, 'weighted avg': {'precision': 0.3364411199432646, 'recall': 0.3321732776234439, 'f1-score': 0.33284331934529365, 'support': 489919}}
[[56093 57550 49980]
 [57528 50519 41430]
 [61313 59380 56126]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.115195
{'0': {'precision': 0.3265977100272417, 'recall': 0.5162423902463168, 'f1-score': 0.40008438710667293, 'support': 60613}, '1': {'precision': 0.345119139123751, 'recall': 0.3250704314021751, 'f1-score': 0.3347949069158636, 'support': 63537}, '2': {'precision': 0.35255942832142334, 'recall': 0.16408463848777424, 'f1-score': 0.22394367828070538, 'support': 58933}, 'accuracy': 0.336541350098043, 'macro avg': {'precision': 0.34142542582413865, 'recall': 0.3351324867120888, 'f1-score': 0.319607657434414, 'support': 183083}, 'weighted avg': {'precision': 0.3413822502889586, 'recall': 0.336541350098043, 'f1-score': 0.3207280400065915, 'support': 183083}}
[[31291 20082  9240]
 [34365 20654  8518]
 [30153 19110  9670]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1202712
{'0': {'precision': 0.35264408793820556, 'recall': 0.3695708577655545, 'f1-score': 0.3609091139432944, 'support': 19271}, '1': {'precision': 0.29263375295043276, 'recall': 0.3856022808267997, 'f1-score': 0.33274623277139426, 'support': 15433}, '2': {'precision': 0.3745928338762215, 'recall': 0.26516290726817043, 'f1-score': 0.3105189011505048, 'support': 19950}, 'accuracy': 0.33598638708969153, 'macro avg': {'precision': 0.3399568915882866, 'recall': 0.34011201528684154, 'f1-score': 0.3347247492883978, 'support': 54654}, 'weighted avg': {'precision': 0.343710395648476, 'recall': 0.33598638708969153, 'f1-score': 0.33456296379248956, 'support': 54654}}
[[7122 6871 5278]
 [5928 5951 3554]
 [7146 7514 5290]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
4918/4918 - 86s - 86s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110805
{'0': {'precision': 0.33073258508604747, 'recall': 0.5470025489248044, 'f1-score': 0.4122235969474614, 'support': 426062}, '1': {'precision': 0.3007092419476122, 'recall': 0.3445913734248049, 'f1-score': 0.3211582577662884, 'support': 392253}, '2': {'precision': 0.3507394245099163, 'recall': 0.08334165675422905, 'f1-score': 0.1346808510638298, 'support': 440524}, 'accuracy': 0.3216757663211896, 'macro avg': {'precision': 0.3273937505145253, 'recall': 0.3249785263679461, 'f1-score': 0.2893542352591932, 'support': 1258839}, 'weighted avg': {'precision': 0.32837862760163505, 'recall': 0.3216757663211896, 'f1-score': 0.28672312144783546, 'support': 1258839}}
[[233057 156194  36811]
 [225935 135167  31151]
 [245677 158133  36714]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.119022
{'0': {'precision': 0.35086863430631215, 'recall': 0.31895341102269087, 'f1-score': 0.33415068528508374, 'support': 121767}, '1': {'precision': 0.3296751949960436, 'recall': 0.29703785435409946, 'f1-score': 0.31250669714612284, 'support': 117820}, '2': {'precision': 0.33702236637515565, 'recall': 0.4012128014205188, 'f1-score': 0.3663268661624466, 'support': 119393}, 'accuracy': 0.33911917098445593, 'macro avg': {'precision': 0.3391887318925038, 'recall': 0.33906802226576965, 'f1-score': 0.33766141619788437, 'support': 358980}, 'weighted avg': {'precision': 0.3393076601945499, 'recall': 0.33911917098445593, 'f1-score': 0.3377484235461529, 'support': 358980}}
[[38838 35461 47468]
 [36060 34997 46763]
 [35793 35698 47902]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1196271
{'0': {'precision': 0.3594018985785254, 'recall': 0.3472991278309846, 'f1-score': 0.3532468788146143, 'support': 42079}, '1': {'precision': 0.3179868285904175, 'recall': 0.2764253262953334, 'f1-score': 0.2957530801758897, 'support': 38079}, '2': {'precision': 0.3569342021939411, 'recall': 0.4105594586338965, 'f1-score': 0.3818734155083487, 'support': 42559}, 'accuracy': 0.3472461028219399, 'macro avg': {'precision': 0.34477430978762796, 'recall': 0.34476130425340484, 'f1-score': 0.34362445816628423, 'support': 122717}, 'weighted avg': {'precision': 0.3456950190059423, 'recall': 0.3472461028219399, 'f1-score': 0.34533444954063147, 'support': 122717}}
[[14614 11155 16310]
 [12383 10526 15170]
 [13665 11421 17473]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
4856/4856 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.122598
{'0': {'precision': 0.3560292665790446, 'recall': 0.2644747646311148, 'f1-score': 0.303497646249424, 'support': 444515}, '1': {'precision': 0.2892731949252792, 'recall': 0.2958767406881164, 'f1-score': 0.2925377065733046, 'support': 360346}, '2': {'precision': 0.36257895675090557, 'recall': 0.4503862625672307, 'f1-score': 0.4017406337592944, 'support': 438044}, 'accuracy': 0.3391007357762661, 'macro avg': {'precision': 0.3359604727517431, 'recall': 0.33691258929548723, 'f1-score': 0.33259199552734103, 'support': 1242905}, 'weighted avg': {'precision': 0.33898353024802563, 'recall': 0.3391007357762661, 'f1-score': 0.33494444290584, 'support': 1242905}}
[[117563 130975 195977]
 [102867 106618 150861]
 [109776 130979 197289]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110721
{'0': {'precision': 0.3321894540969773, 'recall': 0.4324488761196552, 'f1-score': 0.37574615450507226, 'support': 177510}, '1': {'precision': 0.33504518706367314, 'recall': 0.38998997059560986, 'f1-score': 0.3604356596251178, 'support': 175484}, '2': {'precision': 0.35104046302947023, 'recall': 0.18900771231279706, 'f1-score': 0.24571643003654198, 'support': 178416}, 'accuracy': 0.33669483073333206, 'macro avg': {'precision': 0.3394250347300402, 'recall': 0.33714885300935404, 'f1-score': 0.32729941472224405, 'support': 531410}, 'weighted avg': {'precision': 0.33946153601795603, 'recall': 0.33669483073333206, 'f1-score': 0.3270339921364845, 'support': 531410}}
[[76764 68014 32732]
 [77438 68437 29609]
 [76883 67811 33722]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217963
{'0': {'precision': 0.3140597180467587, 'recall': 0.4479786835421958, 'f1-score': 0.369251887439945, 'support': 48038}, '1': {'precision': 0.3797879345185387, 'recall': 0.305253937259339, 'f1-score': 0.33846620801295024, 'support': 54797}, '2': {'precision': 0.3411047820903431, 'recall': 0.2711953659820958, 'f1-score': 0.3021591175780333, 'support': 47475}, 'accuracy': 0.34011043842725036, 'macro avg': {'precision': 0.3449841448852135, 'recall': 0.3414759955945435, 'f1-score': 0.3366257376769762, 'support': 150310}, 'weighted avg': {'precision': 0.34656369977434365, 'recall': 0.34011043842725036, 'f1-score': 0.3368375961435889, 'support': 150310}}
[[21520 13870 12648]
 [25848 16727 12222]
 [21154 13446 12875]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
4353/4353 - 76s - 76s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.125617
{'0': {'precision': 0.40748399312389444, 'recall': 0.1463728947038714, 'f1-score': 0.21537914551523887, 'support': 446968}, '1': {'precision': 0.25499407510770017, 'recall': 0.4076757461153841, 'f1-score': 0.31374568901497657, 'support': 282396}, '2': {'precision': 0.3442648736577819, 'recall': 0.4491951657989629, 'f1-score': 0.3897918214188696, 'support': 384924}, 'accuracy': 0.3172034518903551, 'macro avg': {'precision': 0.3355809806297922, 'recall': 0.3344146022060728, 'f1-score': 0.30630555198302833, 'support': 1114288}, 'weighted avg': {'precision': 0.34699954096298535, 'recall': 0.3172034518903551, 'f1-score': 0.3005581506536601, 'support': 1114288}}
[[ 65424 179915 201629]
 [ 39558 115126 127712]
 [ 55574 156444 172906]]
Evaluating performance on  train set...
1542/1542 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1261185
{'0': {'precision': 0.3520769888657091, 'recall': 0.31091315917641327, 'f1-score': 0.33021718106918757, 'support': 141673}, '1': {'precision': 0.30520925718301845, 'recall': 0.30302124089349647, 'f1-score': 0.30411131351110254, 'support': 120381}, '2': {'precision': 0.3449204994130829, 'recall': 0.390282924178735, 'f1-score': 0.36620226946839207, 'support': 132509}, 'accuracy': 0.33516067142636286, 'macro avg': {'precision': 0.33406891515393683, 'recall': 0.3347391080828816, 'f1-score': 0.333510254682894, 'support': 394563}, 'weighted avg': {'precision': 0.3353742476847772, 'recall': 0.33516067142636286, 'f1-score': 0.3343374296383143, 'support': 394563}}
[[44048 43294 54331]
 [40014 36478 43889]
 [41047 39746 51716]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1366158
{'0': {'precision': 0.36271000884247756, 'recall': 0.3839793166469789, 'f1-score': 0.3730417365885347, 'support': 44867}, '1': {'precision': 0.2950729424717864, 'recall': 0.37841972112725775, 'f1-score': 0.331589122309576, 'support': 33994}, '2': {'precision': 0.32629749192947605, 'recall': 0.23649575918468357, 'f1-score': 0.274232048522794, 'support': 44449}, 'accuracy': 0.32928391857919065, 'macro avg': {'precision': 0.32802681441458, 'recall': 0.3329649323196401, 'f1-score': 0.32628763580696823, 'support': 123310}, 'weighted avg': {'precision': 0.33093842179786415, 'recall': 0.32928391857919065, 'f1-score': 0.32599663080122604, 'support': 123310}}
[[17228 15889 11750]
 [11176 12864  9954]
 [19094 14843 10512]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
5497/5497 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198751
{'0': {'precision': 0.3293386501183507, 'recall': 0.4669775021501969, 'f1-score': 0.3862630181634695, 'support': 463911}, '1': {'precision': 0.3256178872956666, 'recall': 0.42091256570605123, 'f1-score': 0.3671830394334562, 'support': 439267}, '2': {'precision': 0.36297552701720376, 'recall': 0.13077181001660637, 'f1-score': 0.19227229434766943, 'support': 504023}, 'accuracy': 0.3321778480828254, 'macro avg': {'precision': 0.3393106881437404, 'recall': 0.3395539592909515, 'f1-score': 0.3152394506481984, 'support': 1407201}, 'weighted avg': {'precision': 0.3402250489216195, 'recall': 0.3321778480828254, 'f1-score': 0.3108246183850386, 'support': 1407201}}
[[216636 182133  65142]
 [203840 184893  50534]
 [237315 200796  65912]]
Evaluating performance on  train set...
2058/2058 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151398
{'0': {'precision': 0.31450162803129705, 'recall': 0.29381185871243076, 'f1-score': 0.30380489636880026, 'support': 176208}, '1': {'precision': 0.33729758510001073, 'recall': 0.36720543975030656, 'f1-score': 0.3516166820992184, 'support': 179420}, '2': {'precision': 0.3401626328058054, 'recall': 0.3315848501133204, 'f1-score': 0.33581897507949415, 'support': 171196}, 'accuracy': 0.33108210711736746, 'macro avg': {'precision': 0.33065394864570435, 'recall': 0.33086738285868594, 'f1-score': 0.33041351784917095, 'support': 526824}, 'weighted avg': {'precision': 0.3306039923705172, 'recall': 0.33108210711736746, 'f1-score': 0.3304913662614164, 'support': 526824}}
[[51772 65339 59097]
 [62520 65884 51016]
 [50324 64106 56766]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1208972
{'0': {'precision': 0.2923662278052905, 'recall': 0.4226323508869954, 'f1-score': 0.34563264839856633, 'support': 57272}, '1': {'precision': 0.3253049799465241, 'recall': 0.25616014738296544, 'f1-score': 0.28662139031527806, 'support': 60794}, '2': {'precision': 0.37805073676008893, 'recall': 0.2933686625291199, 'f1-score': 0.33036948032442176, 'support': 56233}, 'accuracy': 0.32286473244252695, 'macro avg': {'precision': 0.3319073148373011, 'recall': 0.32405372026636026, 'f1-score': 0.3208745063460887, 'support': 174299}, 'weighted avg': {'precision': 0.3314988418175874, 'recall': 0.32286473244252695, 'f1-score': 0.3201257656612655, 'support': 174299}}
[[24205 16818 16249]
 [34330 15573 10891]
 [24255 15481 16497]]
testing model on single stock: results/universal/W2/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
14883/14883 - 258s - 258s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098863
{'0': {'precision': 0.3021428804062311, 'recall': 0.3673439171839371, 'f1-score': 0.33156844806253055, 'support': 1161707}, '1': {'precision': 0.3926875565069714, 'recall': 0.4050627256770483, 'f1-score': 0.3987791556593449, 'support': 1455066}, '2': {'precision': 0.32574561109995764, 'recall': 0.24478303213575095, 'f1-score': 0.27951970277158605, 'support': 1193126}, 'accuracy': 0.34336763258028624, 'macro avg': {'precision': 0.34019201600438675, 'recall': 0.3390632249989121, 'f1-score': 0.3366224354978205, 'support': 3809899}, 'weighted avg': {'precision': 0.34411499340368407, 'recall': 0.34336763258028624, 'f1-score': 0.3409375426726667, 'support': 3809899}}
[[426746 446373 288588]
 [549738 589393 315935]
 [435914 465155 292057]]
Evaluating performance on  train set...
6147/6147 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1196901
{'0': {'precision': 0.3245344357482697, 'recall': 0.4529747448581625, 'f1-score': 0.37814576830102586, 'support': 519221}, '1': {'precision': 0.3433263382299057, 'recall': 0.3175311009575302, 'f1-score': 0.32992528706312835, 'support': 519357}, '2': {'precision': 0.35793907777991896, 'recall': 0.24654379172454277, 'f1-score': 0.2919773641049257, 'support': 534907}, 'accuracy': 0.3380928321528327, 'macro avg': {'precision': 0.3419332839193648, 'recall': 0.3390165458467451, 'f1-score': 0.33334947315636, 'support': 1573485}, 'weighted avg': {'precision': 0.342092965351271, 'recall': 0.3380928321528327, 'f1-score': 0.33293674053298605, 'support': 1573485}}
[[235194 153732 130295]
 [248181 164912 106264]
 [241337 161692 131878]]
Evaluating performance on  val set...
2174/2174 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1193262
{'0': {'precision': 0.3340041281447814, 'recall': 0.5258021644199734, 'f1-score': 0.40851083557406204, 'support': 184345}, '1': {'precision': 0.37229390135114554, 'recall': 0.28353097780158965, 'f1-score': 0.3219056099732858, 'support': 181049}, '2': {'precision': 0.37651263841517546, 'recall': 0.25300088954005545, 'f1-score': 0.3026401442127138, 'support': 191110}, 'accuracy': 0.35330024582033553, 'macro avg': {'precision': 0.36093688930370077, 'recall': 0.3541113439205395, 'f1-score': 0.3443521965866872, 'support': 556504}, 'weighted avg': {'precision': 0.3610589679069646, 'recall': 0.35330024582033553, 'f1-score': 0.3439780787279976, 'support': 556504}}
[[96929 41695 45721]
 [95370 51333 34346]
 [97904 44855 48351]]
training model: results/universal/W2/deepLOB_L2/h1000
Epoch 1/50
9940/9940 - 456s - loss: 3.1442 - accuracy1000: 0.4483 - val_loss: 3.4796 - val_accuracy1000: 0.3521 - 456s/epoch - 46ms/step
Epoch 2/50
9940/9940 - 451s - loss: 3.0964 - accuracy1000: 0.4667 - val_loss: 3.6499 - val_accuracy1000: 0.3420 - 451s/epoch - 45ms/step
Epoch 3/50
9940/9940 - 452s - loss: 3.0688 - accuracy1000: 0.4766 - val_loss: 3.6081 - val_accuracy1000: 0.3505 - 452s/epoch - 46ms/step
Epoch 4/50
9940/9940 - 452s - loss: 3.0544 - accuracy1000: 0.4813 - val_loss: 3.5987 - val_accuracy1000: 0.3559 - 452s/epoch - 45ms/step
Epoch 5/50
9940/9940 - 450s - loss: 3.0442 - accuracy1000: 0.4841 - val_loss: 3.6316 - val_accuracy1000: 0.3494 - 450s/epoch - 45ms/step
Epoch 6/50
9940/9940 - 452s - loss: 3.0340 - accuracy1000: 0.4872 - val_loss: 3.6531 - val_accuracy1000: 0.3510 - 452s/epoch - 46ms/step
Epoch 7/50
9940/9940 - 452s - loss: 3.0275 - accuracy1000: 0.4891 - val_loss: 3.6472 - val_accuracy1000: 0.3484 - 452s/epoch - 45ms/step
Epoch 8/50
9940/9940 - 454s - loss: 3.0215 - accuracy1000: 0.4910 - val_loss: 3.7188 - val_accuracy1000: 0.3288 - 454s/epoch - 46ms/step
Epoch 9/50
9940/9940 - 453s - loss: 3.0168 - accuracy1000: 0.4922 - val_loss: 3.7010 - val_accuracy1000: 0.3400 - 453s/epoch - 46ms/step
Epoch 10/50
9940/9940 - 453s - loss: 3.0121 - accuracy1000: 0.4939 - val_loss: 3.6964 - val_accuracy1000: 0.3491 - 453s/epoch - 46ms/step
Epoch 11/50
9940/9940 - 454s - loss: 3.0078 - accuracy1000: 0.4953 - val_loss: 3.6902 - val_accuracy1000: 0.3522 - 454s/epoch - 46ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 468s - 468s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1366929
{'0': {'precision': 0.315963443248714, 'recall': 0.038688811602651786, 'f1-score': 0.06893654255376337, 'support': 2154473}, '1': {'precision': 0.35988296972978817, 'recall': 0.7453972089447259, 'f1-score': 0.4854077117442275, 'support': 2367205}, '2': {'precision': 0.3256246158994308, 'recall': 0.23009779949988426, 'f1-score': 0.2696508382790938, 'support': 2199091}, 'accuracy': 0.3502378968835263, 'macro avg': {'precision': 0.3338236762926443, 'recall': 0.3380612733490873, 'f1-score': 0.2746650308590282, 'support': 6720769}, 'weighted avg': {'precision': 0.3345940970487879, 'recall': 0.3502378968835263, 'f1-score': 0.2813023648821941, 'support': 6720769}}
[[  83354 1536411  534708]
 [  89456 1764508  513241]
 [  90999 1602086  506006]]
Evaluating performance on  train set...
9940/9940 - 179s - 179s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.154064
{'0': {'precision': 0.3187566768805614, 'recall': 0.058853126435776996, 'f1-score': 0.09936091087647933, 'support': 846667}, '1': {'precision': 0.35295224236186673, 'recall': 0.6884452267123717, 'f1-score': 0.46665810841169486, 'support': 844837}, '2': {'precision': 0.35621799847988556, 'recall': 0.30910435149978877, 'f1-score': 0.33099303943732417, 'support': 852120}, 'accuracy': 0.35180003019314177, 'macro avg': {'precision': 0.3426423059074379, 'recall': 0.3521342348826459, 'f1-score': 0.29900401957516615, 'support': 2543624}, 'weighted avg': {'precision': 0.34266399192230723, 'recall': 0.35180003019314177, 'f1-score': 0.2989519793140023, 'support': 2543624}}
[[ 49829 528965 267873]
 [ 55062 581624 208151]
 [ 51432 537294 263394]]
Evaluating performance on  val set...
3393/3393 - 60s - 60s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1600971
{'0': {'precision': 0.3297228192916649, 'recall': 0.08087720930553115, 'f1-score': 0.12989313010897297, 'support': 290193}, '1': {'precision': 0.34860471832316625, 'recall': 0.6884225571268143, 'f1-score': 0.4628371062089434, 'support': 284061}, '2': {'precision': 0.368108534228461, 'recall': 0.29558626839054836, 'f1-score': 0.32788512902598643, 'support': 293833}, 'accuracy': 0.3523575402004638, 'macro avg': {'precision': 0.34881202394776406, 'recall': 0.3549620116076313, 'f1-score': 0.3068717884479676, 'support': 868087}, 'weighted avg': {'precision': 0.3488944010545653, 'recall': 0.3523575402004638, 'f1-score': 0.30585819099885675, 'support': 868087}}
[[ 23470 182252  84471]
 [ 23887 195554  64620]
 [ 23824 183156  86853]]
testing model out of sample: results/universal/W2/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 252s - 252s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.152313
{'0': {'precision': 0.31279601585526984, 'recall': 0.051648979598686626, 'f1-score': 0.08865861923188552, 'support': 1191737}, '1': {'precision': 0.32926831844334686, 'recall': 0.6517692728394835, 'f1-score': 0.4375101920412122, 'support': 1195802}, '2': {'precision': 0.3543347423127209, 'recall': 0.3055087813107316, 'f1-score': 0.3281152922606754, 'support': 1279194}, 'accuracy': 0.33592410464574324, 'macro avg': {'precision': 0.33213302553711255, 'recall': 0.3363090112496339, 'f1-score': 0.28476136784459105, 'support': 3666733}, 'weighted avg': {'precision': 0.3326593934263775, 'recall': 0.33592410464574324, 'f1-score': 0.28596476283899525, 'support': 3666733}}
[[ 61552 765225 364960]
 [ 69254 779387 347161]
 [ 65974 822415 390805]]
Evaluating performance on  train set...
5373/5373 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.144677
{'0': {'precision': 0.34572724415106204, 'recall': 0.04962817011566369, 'f1-score': 0.08679689144094038, 'support': 465401}, '1': {'precision': 0.333666391723567, 'recall': 0.7173076332966566, 'f1-score': 0.4554659659704937, 'support': 456238}, '2': {'precision': 0.332270010633227, 'recall': 0.23991898564377953, 'f1-score': 0.2786417929378665, 'support': 453253}, 'accuracy': 0.33392004608361964, 'macro avg': {'precision': 0.3372212155026187, 'recall': 0.3356182630186999, 'f1-score': 0.2736348834497669, 'support': 1374892}, 'weighted avg': {'precision': 0.3372886535901491, 'recall': 0.33392004608361964, 'f1-score': 0.27237882686815984, 'support': 1374892}}
[[ 23097 331322 110982]
 [ 21425 327263 107550]
 [ 22285 322224 108744]]
Evaluating performance on  val set...
1685/1685 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1503603
{'0': {'precision': 0.30603707811757247, 'recall': 0.06767201810753803, 'f1-score': 0.1108356574734015, 'support': 142703}, '1': {'precision': 0.36246257624046296, 'recall': 0.6726129752681353, 'f1-score': 0.47107098892080423, 'support': 145076}, '2': {'precision': 0.368482637044564, 'recall': 0.3349849187853849, 'f1-score': 0.3509362307365211, 'support': 142893}, 'accuracy': 0.3601441468217112, 'macro avg': {'precision': 0.34566076380086647, 'recall': 0.3584233040536861, 'f1-score': 0.3109476257102423, 'support': 430672}, 'weighted avg': {'precision': 0.34576341003009764, 'recall': 0.3601441468217112, 'f1-score': 0.31184754624339434, 'support': 430672}}
[[ 9657 86273 46773]
 [12233 97580 35263]
 [ 9665 85361 47867]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.147069
{'0': {'precision': 0.2963058507893922, 'recall': 0.07129821599274976, 'f1-score': 0.11493930812260458, 'support': 80549}, '1': {'precision': 0.39453702790651807, 'recall': 0.5895360830584742, 'f1-score': 0.4727165318549486, 'support': 88227}, '2': {'precision': 0.3883096366508689, 'recall': 0.46976194173365665, 'f1-score': 0.42516986578305827, 'support': 83719}, 'accuracy': 0.38449870294461275, 'macro avg': {'precision': 0.35971750511559303, 'recall': 0.37686541359496023, 'f1-score': 0.33760856858687055, 'support': 252495}, 'weighted avg': {'precision': 0.36113528112286264, 'recall': 0.38449870294461275, 'f1-score': 0.34281630836026883, 'support': 252495}}
[[ 5743 42634 32172]
 [ 6434 52013 29780]
 [ 7205 37186 39328]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.172441
{'0': {'precision': 0.3570422535211268, 'recall': 0.04851442514712215, 'f1-score': 0.08542184406722547, 'support': 20901}, '1': {'precision': 0.308586010207145, 'recall': 0.5303100655213331, 'f1-score': 0.39014669880249747, 'support': 19383}, '2': {'precision': 0.32346549674033376, 'recall': 0.3894840780054308, 'f1-score': 0.35341815249529607, 'support': 20255}, 'accuracy': 0.3168535985067477, 'macro avg': {'precision': 0.32969792015620186, 'recall': 0.3227695228912953, 'f1-score': 0.27632889845500636, 'support': 60539}, 'weighted avg': {'precision': 0.3302938009079374, 'recall': 0.3168535985067477, 'f1-score': 0.27265234154066154, 'support': 60539}}
[[ 1014 11577  8310]
 [  914 10279  8190]
 [  912 11454  7889]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1706434
{'0': {'precision': 0.5151057401812689, 'recall': 0.04494530117305918, 'f1-score': 0.08267668808340405, 'support': 7587}, '1': {'precision': 0.2911325492269063, 'recall': 0.2967802775158292, 'f1-score': 0.2939292861907939, 'support': 7423}, '2': {'precision': 0.3302669957370429, 'recall': 0.6701062215477998, 'f1-score': 0.44246280246480635, 'support': 6590}, 'accuracy': 0.32222222222222224, 'macro avg': {'precision': 0.37883509504840607, 'recall': 0.33727726674556274, 'f1-score': 0.2730229255796681, 'support': 21600}, 'weighted avg': {'precision': 0.38174276229507986, 'recall': 0.32222222222222224, 'f1-score': 0.2650432866725057, 'support': 21600}}
[[ 341 3335 3911]
 [ 176 2203 5044]
 [ 145 2029 4416]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
1242/1242 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1211244
{'0': {'precision': 0.2848328311091979, 'recall': 0.04498838461102612, 'f1-score': 0.07770372762592603, 'support': 88245}, '1': {'precision': 0.3983438815176535, 'recall': 0.7983998840962323, 'f1-score': 0.5315051023825408, 'support': 124241}, '2': {'precision': 0.3146686115416173, 'recall': 0.16387340594228633, 'f1-score': 0.21551218172055095, 'support': 105313}, 'accuracy': 0.3789250438170038, 'macro avg': {'precision': 0.3326151080561562, 'recall': 0.3357538915498483, 'f1-score': 0.2749070039096726, 'support': 317799}, 'weighted avg': {'precision': 0.33909612947853296, 'recall': 0.3789250438170038, 'f1-score': 0.30078107628719875, 'support': 317799}}
[[ 3970 66714 17561]
 [ 5021 99194 20026]
 [ 4947 83108 17258]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1710442
{'0': {'precision': 0.3404255319148936, 'recall': 0.0669671603348358, 'f1-score': 0.11191821361312886, 'support': 46590}, '1': {'precision': 0.36388584606514845, 'recall': 0.7077371607983853, 'f1-score': 0.48064577542550363, 'support': 44590}, '2': {'precision': 0.3221350963509635, 'recall': 0.287442264599625, 'f1-score': 0.30380144517750546, 'support': 43734}, 'accuracy': 0.3502156929599597, 'macro avg': {'precision': 0.34214882477700187, 'recall': 0.35404886191094875, 'f1-score': 0.298788478072046, 'support': 134914}, 'weighted avg': {'precision': 0.34225026099421035, 'recall': 0.3502156929599597, 'f1-score': 0.295986458794876, 'support': 134914}}
[[ 3120 27404 16066]
 [ 2645 31558 10387]
 [ 3400 27763 12571]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1528121
{'0': {'precision': 0.3854473942969518, 'recall': 0.02738195026543727, 'f1-score': 0.051131546337963865, 'support': 14316}, '1': {'precision': 0.39655422736291923, 'recall': 0.5201218738098261, 'f1-score': 0.4500096108960101, 'support': 15754}, '2': {'precision': 0.29024583663758924, 'recall': 0.5216152019002376, 'f1-score': 0.37296195652173914, 'support': 10525}, 'accuracy': 0.346742209631728, 'macro avg': {'precision': 0.3574158194324868, 'recall': 0.35637300865850036, 'f1-score': 0.2913677045852377, 'support': 40595}, 'weighted avg': {'precision': 0.3650749507387909, 'recall': 0.346742209631728, 'f1-score': 0.2893675383623929, 'support': 40595}}
[[ 392 7694 6230]
 [ 365 8194 7195]
 [ 260 4775 5490]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1656322
{'0': {'precision': 0.33645678845894567, 'recall': 0.05995555288605922, 'f1-score': 0.10177509966455611, 'support': 83245}, '1': {'precision': 0.27122972324353545, 'recall': 0.7254552479714823, 'f1-score': 0.39483895476623343, 'support': 80231}, '2': {'precision': 0.3022149778948779, 'recall': 0.12222653674923467, 'f1-score': 0.17405785639423108, 'support': 110737}, 'accuracy': 0.2798189728422795, 'macro avg': {'precision': 0.303300496532453, 'recall': 0.3025457792022587, 'f1-score': 0.22355730360834022, 'support': 274213}, 'weighted avg': {'precision': 0.303544169269736, 'recall': 0.2798189728422795, 'f1-score': 0.21671196185065483, 'support': 274213}}
[[ 4991 65058 13196]
 [ 3972 58204 18055]
 [ 5871 91331 13535]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1314281
{'0': {'precision': 0.3194029850746269, 'recall': 0.05722395919038999, 'f1-score': 0.0970589261417158, 'support': 24308}, '1': {'precision': 0.36244159389601527, 'recall': 0.8153937007874016, 'f1-score': 0.5018232921022983, 'support': 25400}, '2': {'precision': 0.3543075056335587, 'recall': 0.1752400548696845, 'f1-score': 0.2344977915447714, 'support': 23328}, 'accuracy': 0.35859028424338685, 'macro avg': {'precision': 0.3453840282014003, 'recall': 0.34928590494915873, 'f1-score': 0.2777933365962619, 'support': 73036}, 'weighted avg': {'precision': 0.34551932933857926, 'recall': 0.35859028424338685, 'f1-score': 0.28172386873880867, 'support': 73036}}
[[ 1391 18568  4349]
 [ 1588 20711  3101]
 [ 1376 17864  4088]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1348292
{'0': {'precision': 0.4108187134502924, 'recall': 0.05664751537143433, 'f1-score': 0.09956594915404376, 'support': 9921}, '1': {'precision': 0.3589387414918739, 'recall': 0.5825067628494139, 'f1-score': 0.44417705199828106, 'support': 8872}, '2': {'precision': 0.4321726126895962, 'recall': 0.5509259259259259, 'f1-score': 0.4843768705854184, 'support': 11016}, 'accuracy': 0.39582005434600287, 'macro avg': {'precision': 0.4006433558772542, 'recall': 0.39669340138225806, 'f1-score': 0.34270662391258105, 'support': 29809}, 'weighted avg': {'precision': 0.40326916273759095, 'recall': 0.39582005434600287, 'f1-score': 0.3443399038295477, 'support': 29809}}
[[ 562 4667 4692]
 [ 422 5168 3282]
 [ 384 4563 6069]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1314924
{'0': {'precision': 0.3629489603024575, 'recall': 0.05625137332454406, 'f1-score': 0.0974063035068806, 'support': 68265}, '1': {'precision': 0.28564117293782804, 'recall': 0.9060729549746546, 'f1-score': 0.4343520573672529, 'support': 60366}, '2': {'precision': 0.5639577157559148, 'recall': 0.11042239330653905, 'f1-score': 0.18468385962341566, 'support': 91313}, 'accuracy': 0.31198395955334085, 'macro avg': {'precision': 0.40418261633206676, 'recall': 0.35758224053524595, 'f1-score': 0.23881407349918304, 'support': 219944}, 'weighted avg': {'precision': 0.4251827588814973, 'recall': 0.31198395955334085, 'f1-score': 0.22611926161987483, 'support': 219944}}
[[ 3840 59837  4588]
 [ 2462 54696  3208]
 [ 4278 76952 10083]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1770351
{'0': {'precision': 0.333816075307748, 'recall': 0.016574386999352844, 'f1-score': 0.031580750128446654, 'support': 27814}, '1': {'precision': 0.3202651407852246, 'recall': 0.41892693048762414, 'f1-score': 0.363011719377107, 'support': 26988}, '2': {'precision': 0.3144958776861708, 'recall': 0.5264880952380953, 'f1-score': 0.3937728682925472, 'support': 26880}, 'accuracy': 0.31731593251879237, 'macro avg': {'precision': 0.32285903125971444, 'recall': 0.32066313757502407, 'f1-score': 0.2627884459327003, 'support': 81682}, 'weighted avg': {'precision': 0.32298089089794096, 'recall': 0.31731593251879237, 'f1-score': 0.2602771965221915, 'support': 81682}}
[[  461 11754 15599]
 [  434 11306 15248]
 [  486 12242 14152]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1627764
{'0': {'precision': 0.3315858453473132, 'recall': 0.028264998324209586, 'f1-score': 0.052089767346098416, 'support': 8951}, '1': {'precision': 0.31625369929785874, 'recall': 0.7236754747045545, 'f1-score': 0.44015506380229363, 'support': 7531}, '2': {'precision': 0.32275664034458007, 'recall': 0.2651256044344852, 'f1-score': 0.2911162911162911, 'support': 8479}, 'accuracy': 0.31853691759144265, 'macro avg': {'precision': 0.32353206166325066, 'recall': 0.33902202582108315, 'f1-score': 0.26112037408822775, 'support': 24961}, 'weighted avg': {'precision': 0.3239607814028953, 'recall': 0.31853691759144265, 'f1-score': 0.2503681072627312, 'support': 24961}}
[[ 253 5841 2857]
 [ 221 5450 1860]
 [ 289 5942 2248]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1525867
{'0': {'precision': 0.29699970125048014, 'recall': 0.04295201767704823, 'f1-score': 0.07505028336631635, 'support': 162018}, '1': {'precision': 0.33760409024558113, 'recall': 0.5788818425864685, 'f1-score': 0.42648309335677365, 'support': 154218}, '2': {'precision': 0.3803191226107872, 'recall': 0.4424439927914649, 'f1-score': 0.40903610770299437, 'support': 173683}, 'accuracy': 0.3532788073130456, 'macro avg': {'precision': 0.3383076380356162, 'recall': 0.35475928435166054, 'f1-score': 0.30352316147536146, 'support': 489919}, 'weighted avg': {'precision': 0.339319135120505, 'recall': 0.3532788073130456, 'f1-score': 0.3040777859113811, 'support': 489919}}
[[ 6959 87149 67910]
 [ 7645 89274 57299]
 [ 8827 88011 76845]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302605
{'0': {'precision': 0.3137950495847779, 'recall': 0.06231587037274241, 'f1-score': 0.10398215311452197, 'support': 62456}, '1': {'precision': 0.3475958968615573, 'recall': 0.8749359302921579, 'f1-score': 0.4975316513343656, 'support': 62432}, '2': {'precision': 0.395950339934969, 'recall': 0.09206976544376665, 'f1-score': 0.1493998076038312, 'support': 58195}, 'accuracy': 0.34888001616753056, 'macro avg': {'precision': 0.3524470954604347, 'recall': 0.343107188702889, 'f1-score': 0.25030453735090624, 'support': 183083}, 'weighted avg': {'precision': 0.3514352544050685, 'recall': 0.34888001616753056, 'f1-score': 0.25262054485961366, 'support': 183083}}
[[ 3892 53894  4670]
 [ 4304 54624  3504]
 [ 4207 48630  5358]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1530432
{'0': {'precision': 0.324, 'recall': 0.03913253529443341, 'f1-score': 0.06983093060012453, 'support': 18629}, '1': {'precision': 0.318492045764773, 'recall': 0.7743317444035479, 'f1-score': 0.4513417507825414, 'support': 16573}, '2': {'precision': 0.3572785071422674, 'recall': 0.22244499280279662, 'f1-score': 0.27418179513987895, 'support': 19452}, 'accuracy': 0.3273136458447689, 'macro avg': {'precision': 0.3332568509690135, 'recall': 0.3453030908335926, 'f1-score': 0.2651181588408483, 'support': 54654}, 'weighted avg': {'precision': 0.33417400730762564, 'recall': 0.3273136458447689, 'f1-score': 0.25824919531836105, 'support': 54654}}
[[  729 13154  4746]
 [  702 12833  3038]
 [  819 14306  4327]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
4918/4918 - 86s - 86s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1258843
{'0': {'precision': 0.3210570288917637, 'recall': 0.057542471536704005, 'f1-score': 0.09759344598054276, 'support': 414042}, '1': {'precision': 0.3288272836800457, 'recall': 0.9453620667877928, 'f1-score': 0.4879350787256955, 'support': 411692}, '2': {'precision': 0.33365477338476374, 'recall': 0.0007988824880802576, 'f1-score': 0.0015939485237549003, 'support': 433105}, 'accuracy': 0.3283732073760028, 'macro avg': {'precision': 0.32784636198552436, 'recall': 0.3345678069375257, 'f1-score': 0.1957074910766644, 'support': 1258839}, 'weighted avg': {'precision': 0.3279324894255875, 'recall': 0.3283732073760028, 'f1-score': 0.19222243755301177, 'support': 1258839}}
[[ 23825 389917    300]
 [ 22103 389198    391]
 [ 28280 404479    346]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1565993
{'0': {'precision': 0.3204058938003892, 'recall': 0.03832691780081642, 'f1-score': 0.0684641602744507, 'support': 120281}, '1': {'precision': 0.4026330961830181, 'recall': 0.5960638077480837, 'f1-score': 0.4806163221124935, 'support': 120675}, '2': {'precision': 0.3773404120692045, 'recall': 0.5305446349894937, 'f1-score': 0.4410160335531946, 'support': 118024}, 'accuracy': 0.3876455512841941, 'macro avg': {'precision': 0.36679313401753727, 'recall': 0.3883117868461312, 'f1-score': 0.33003217198004625, 'support': 358980}, 'weighted avg': {'precision': 0.36676615685594216, 'recall': 0.3876455512841941, 'f1-score': 0.32949966203403697, 'support': 358980}}
[[ 4610 55641 60030]
 [ 5449 71930 43296]
 [ 4329 51078 62617]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1717557
{'0': {'precision': 0.3557239402006963, 'recall': 0.040278260869565215, 'f1-score': 0.07236293951008166, 'support': 43125}, '1': {'precision': 0.3320094682828411, 'recall': 0.5782469149465995, 'f1-score': 0.421822805760478, 'support': 36142}, '2': {'precision': 0.38941825933281105, 'recall': 0.49192174913693903, 'f1-score': 0.43470921423268966, 'support': 43450}, 'accuracy': 0.3586300186608212, 'macro avg': {'precision': 0.3590505559387828, 'recall': 0.3701489749843679, 'f1-score': 0.30963165316774977, 'support': 122717}, 'weighted avg': {'precision': 0.3606697074720219, 'recall': 0.3586300186608212, 'f1-score': 0.3035788600648471, 'support': 122717}}
[[ 1737 21670 19718]
 [ 1448 20899 13795]
 [ 1698 20378 21374]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
4856/4856 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1710333
{'0': {'precision': 0.3131978890625354, 'recall': 0.03358160928472727, 'f1-score': 0.060659232679130745, 'support': 411773}, '1': {'precision': 0.36129391101869773, 'recall': 0.42558003005823786, 'f1-score': 0.39081094311181935, 'support': 425840}, '2': {'precision': 0.3408741104766167, 'recall': 0.5863377515470327, 'f1-score': 0.4311147596003393, 'support': 405292}, 'accuracy': 0.34813199721619914, 'macro avg': {'precision': 0.33845530351928327, 'recall': 0.3484997969633326, 'f1-score': 0.29419497846376313, 'support': 1242905}, 'weighted avg': {'precision': 0.33870117460661797, 'recall': 0.34813199721619914, 'f1-score': 0.2945745084142888, 'support': 1242905}}
[[ 13828 167963 229982]
 [ 15088 181229 229523]
 [ 15235 152419 237638]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.132853
{'0': {'precision': 0.3356629929726201, 'recall': 0.04962980627285322, 'f1-score': 0.08647391981797047, 'support': 176124}, '1': {'precision': 0.33678464810892866, 'recall': 0.8320717721894165, 'f1-score': 0.47949259486748286, 'support': 175444}, '2': {'precision': 0.35745574390566115, 'recall': 0.14293101722623192, 'f1-score': 0.20420809285291536, 'support': 179842}, 'accuracy': 0.33952691895146875, 'macro avg': {'precision': 0.34330112832906995, 'recall': 0.34154419856283386, 'f1-score': 0.2567248691794562, 'support': 531410}, 'weighted avg': {'precision': 0.3434084994121573, 'recall': 0.33952691895146875, 'f1-score': 0.2560723797120959, 'support': 531410}}
[[  8741 142328  25055]
 [  8311 145982  21151]
 [  8989 145148  25705]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1466974
{'0': {'precision': 0.27784730913642053, 'recall': 0.08942692984501877, 'f1-score': 0.13530506191056652, 'support': 47167}, '1': {'precision': 0.4134738394154253, 'recall': 0.6841019569857756, 'f1-score': 0.5154236520775474, 'support': 55749}, '2': {'precision': 0.3701475834091068, 'recall': 0.33497911127990887, 'f1-score': 0.35168632663233096, 'support': 47394}, 'accuracy': 0.38741268046038185, 'macro avg': {'precision': 0.35382291065365085, 'recall': 0.36950266603690113, 'f1-score': 0.3341383468734816, 'support': 150310}, 'weighted avg': {'precision': 0.35725335421262255, 'recall': 0.38741268046038185, 'f1-score': 0.3445153935148664, 'support': 150310}}
[[ 4218 27109 15840]
 [ 6436 38138 11175]
 [ 4527 26991 15876]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
4353/4353 - 76s - 76s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1942011
{'0': {'precision': 0.3073960810963869, 'recall': 0.020702649237317655, 'f1-score': 0.03879267217762108, 'support': 393283}, '1': {'precision': 0.34269671688561376, 'recall': 0.28424276313405095, 'f1-score': 0.3107447044856039, 'support': 386286}, '2': {'precision': 0.30030205732573717, 'recall': 0.6884969183105829, 'f1-score': 0.4181983317651478, 'support': 334719}, 'accuracy': 0.31266064069612165, 'macro avg': {'precision': 0.31679828510257924, 'recall': 0.3311474435606505, 'f1-score': 0.2559119028094576, 'support': 1114288}, 'weighted avg': {'precision': 0.31750265754160495, 'recall': 0.31266064069612165, 'f1-score': 0.24703824757967047, 'support': 1114288}}
[[  8142 114753 270388]
 [  9924 109799 266563]
 [  8421  95845 230453]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1806766
{'0': {'precision': 0.32568714221915473, 'recall': 0.05860907556640097, 'f1-score': 0.09934119278779473, 'support': 136873}, '1': {'precision': 0.3318198828864527, 'recall': 0.46085700308802396, 'f1-score': 0.3858356904253005, 'support': 130828}, '2': {'precision': 0.32308158191129904, 'recall': 0.4793634027525973, 'f1-score': 0.3860039988574693, 'support': 126862}, 'accuracy': 0.3272683956681189, 'macro avg': {'precision': 0.3268628690056355, 'recall': 0.3329431604690074, 'f1-score': 0.29039362735685487, 'support': 394563}, 'weighted avg': {'precision': 0.3268828640791519, 'recall': 0.3272683956681189, 'f1-score': 0.28650552152751607, 'support': 394563}}
[[ 8022 62678 66173]
 [ 9293 60293 61242]
 [ 7316 58733 60813]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1975237
{'0': {'precision': 0.2840002296343074, 'recall': 0.11856201318154584, 'f1-score': 0.167286622480725, 'support': 41725}, '1': {'precision': 0.3145707534786033, 'recall': 0.4525152323883378, 'f1-score': 0.3711397685151725, 'support': 39718}, '2': {'precision': 0.32627779145130853, 'recall': 0.379965127666181, 'f1-score': 0.3510808514394801, 'support': 41867}, 'accuracy': 0.3148811937393561, 'macro avg': {'precision': 0.30828292485473974, 'recall': 0.31701412441202154, 'f1-score': 0.29650241414512585, 'support': 123310}, 'weighted avg': {'precision': 0.308201306162084, 'recall': 0.3148811937393561, 'f1-score': 0.2953504635156158, 'support': 123310}}
[[ 4947 18883 17895]
 [ 6792 17973 14953]
 [ 5680 20279 15908]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
5497/5497 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.134126
{'0': {'precision': 0.31192322666863087, 'recall': 0.0652710986630027, 'f1-score': 0.10795269353678633, 'support': 454152}, '1': {'precision': 0.31764724645539943, 'recall': 0.8905621906341804, 'f1-score': 0.46827084604415675, 'support': 447286}, '2': {'precision': 0.40806218614569717, 'recall': 0.04691525477348086, 'f1-score': 0.084155123769531, 'support': 505763}, 'accuracy': 0.3209967872393496, 'macro avg': {'precision': 0.3458775530899092, 'recall': 0.33424951469022135, 'f1-score': 0.2201262211168247, 'support': 1407201}, 'weighted avg': {'precision': 0.3482959996245512, 'recall': 0.3209967872393496, 'f1-score': 0.21392855262458924, 'support': 1407201}}
[[ 29643 402625  21884]
 [ 36414 398336  12536]
 [ 28976 453059  23728]]
Evaluating performance on  train set...
2058/2058 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1601382
{'0': {'precision': 0.3702423806095512, 'recall': 0.042475166839195645, 'f1-score': 0.07620760001383077, 'support': 181612}, '1': {'precision': 0.31846290046661474, 'recall': 0.5512533198140328, 'f1-score': 0.40370347712539634, 'support': 173579}, '2': {'precision': 0.3188534839704759, 'recall': 0.38182051237232933, 'f1-score': 0.34750768904443735, 'support': 171633}, 'accuracy': 0.32066306774178854, 'macro avg': {'precision': 0.335852921682214, 'recall': 0.3251829996751859, 'f1-score': 0.27580625539455483, 'support': 526824}, 'weighted avg': {'precision': 0.3364400844336269, 'recall': 0.32066306774178854, 'f1-score': 0.27249792663854516, 'support': 526824}}
[[  7714 105312  68586]
 [  6485  95686  71408]
 [  6636  99464  65533]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1536925
{'0': {'precision': 0.30005823142833377, 'recall': 0.0607249280290914, 'f1-score': 0.10100812097451695, 'support': 59399}, '1': {'precision': 0.3422221448104088, 'recall': 0.6960094936148356, 'f1-score': 0.4588376098315673, 'support': 56459}, '2': {'precision': 0.3626612155441288, 'recall': 0.294467924915727, 'f1-score': 0.32502620569820473, 'support': 58441}, 'accuracy': 0.3448786281045789, 'macro avg': {'precision': 0.3349805305942904, 'recall': 0.3504007821865513, 'f1-score': 0.29495731216809634, 'support': 174299}, 'weighted avg': {'precision': 0.33470624077061195, 'recall': 0.3448786281045789, 'f1-score': 0.2920277825945907, 'support': 174299}}
[[ 3607 38184 17608]
 [ 4528 39296 12635]
 [ 3886 37346 17209]]
testing model on single stock: results/universal/W2/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
14883/14883 - 267s - 267s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1249768
{'0': {'precision': 0.3128356876466946, 'recall': 0.036493879751864126, 'f1-score': 0.06536284948387854, 'support': 1190638}, '1': {'precision': 0.3757002673287007, 'recall': 0.8026606577978074, 'f1-score': 0.5118292999684994, 'support': 1384620}, '2': {'precision': 0.3479109881615882, 'recall': 0.20087458621575016, 'f1-score': 0.25469501768943614, 'support': 1234641}, 'accuracy': 0.36820897351872056, 'macro avg': {'precision': 0.3454823143789945, 'recall': 0.34667637458847383, 'f1-score': 0.2772957223806047, 'support': 3809899}, 'weighted avg': {'precision': 0.34704891965686285, 'recall': 0.36820897351872056, 'f1-score': 0.28897603034654534, 'support': 3809899}}
[[  43451  905320  241867]
 [  50266 1111380  222974]
 [  45177  941456  248008]]
Evaluating performance on  train set...
6147/6147 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1440231
{'0': {'precision': 0.3183286688329984, 'recall': 0.06580160703851029, 'f1-score': 0.10905955240376648, 'support': 515109}, '1': {'precision': 0.34882451865325875, 'recall': 0.7791918061316018, 'f1-score': 0.4819100588180907, 'support': 521756}, '2': {'precision': 0.37583698972231344, 'recall': 0.21118296000894488, 'f1-score': 0.2704179577090892, 'support': 536620}, 'accuracy': 0.3519372602852903, 'macro avg': {'precision': 0.3476633924028569, 'recall': 0.35205879105968557, 'f1-score': 0.2871291896436488, 'support': 1573485}, 'weighted avg': {'precision': 0.3480534566603015, 'recall': 0.3519372602852903, 'f1-score': 0.28772356018245804, 'support': 1573485}}
[[ 33895 371218 109996]
 [ 37002 406548  78206]
 [ 35581 387714 113325]]
Evaluating performance on  val set...
2174/2174 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1494844
{'0': {'precision': 0.34306879205314883, 'recall': 0.08877062325622267, 'f1-score': 0.14104516359860203, 'support': 182076}, '1': {'precision': 0.3546054215895352, 'recall': 0.7724263990136062, 'f1-score': 0.486067179048277, 'support': 184916}, '2': {'precision': 0.3926487419554572, 'recall': 0.220851450040103, 'f1-score': 0.2826960615455276, 'support': 189512}, 'accuracy': 0.3609156448111784, 'macro avg': {'precision': 0.36344098519938034, 'recall': 0.36068282410331065, 'f1-score': 0.3032694680641355, 'support': 556504}, 'weighted avg': {'precision': 0.3637861684839322, 'recall': 0.3609156448111784, 'f1-score': 0.30392743574868514, 'support': 556504}}
[[ 16163 128219  37694]
 [ 15036 142834  27046]
 [ 15914 131744  41854]]
training model: results/universal/W2/deepOF_L2/h300
Epoch 1/50
9940/9940 - 276s - loss: 3.2439 - accuracy300: 0.3975 - val_loss: 3.2989 - val_accuracy300: 0.3591 - 276s/epoch - 28ms/step
Epoch 2/50
9940/9940 - 272s - loss: 3.2287 - accuracy300: 0.4046 - val_loss: 3.3096 - val_accuracy300: 0.3536 - 272s/epoch - 27ms/step
Epoch 3/50
9940/9940 - 271s - loss: 3.2210 - accuracy300: 0.4088 - val_loss: 3.3145 - val_accuracy300: 0.3548 - 271s/epoch - 27ms/step
Epoch 4/50
9940/9940 - 272s - loss: 3.2172 - accuracy300: 0.4110 - val_loss: 3.3190 - val_accuracy300: 0.3564 - 272s/epoch - 27ms/step
Epoch 5/50
9940/9940 - 271s - loss: 3.2148 - accuracy300: 0.4122 - val_loss: 3.3229 - val_accuracy300: 0.3545 - 271s/epoch - 27ms/step
Epoch 6/50
9940/9940 - 272s - loss: 3.2128 - accuracy300: 0.4137 - val_loss: 3.3172 - val_accuracy300: 0.3552 - 272s/epoch - 27ms/step
Epoch 7/50
9940/9940 - 272s - loss: 3.2113 - accuracy300: 0.4149 - val_loss: 3.3250 - val_accuracy300: 0.3529 - 272s/epoch - 27ms/step
Epoch 8/50
9940/9940 - 274s - loss: 3.2092 - accuracy300: 0.4160 - val_loss: 3.3264 - val_accuracy300: 0.3545 - 274s/epoch - 28ms/step
Epoch 9/50
9940/9940 - 278s - loss: 3.2077 - accuracy300: 0.4170 - val_loss: 3.3264 - val_accuracy300: 0.3563 - 278s/epoch - 28ms/step
Epoch 10/50
9940/9940 - 272s - loss: 3.2059 - accuracy300: 0.4180 - val_loss: 3.3351 - val_accuracy300: 0.3529 - 272s/epoch - 27ms/step
Epoch 11/50
9940/9940 - 272s - loss: 3.2043 - accuracy300: 0.4189 - val_loss: 3.3356 - val_accuracy300: 0.3544 - 272s/epoch - 27ms/step
testing model in sample: results/universal/W2/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 322s - 322s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099495
{'0': {'precision': 0.35085169508368147, 'recall': 0.625112870224551, 'f1-score': 0.4494464613428708, 'support': 2202751}, '1': {'precision': 0.34815620342873205, 'recall': 0.2102225799678029, 'f1-score': 0.26215285212442213, 'support': 2285920}, '2': {'precision': 0.38508909658905105, 'recall': 0.24426530852709566, 'f1-score': 0.2989218990892284, 'support': 2232073}, 'accuracy': 0.3575107160754821, 'macro avg': {'precision': 0.3613656650338215, 'recall': 0.35986691957314987, 'f1-score': 0.3368404041855071, 'support': 6720744}, 'weighted avg': {'precision': 0.3613057015458251, 'recall': 0.3575107160754821, 'f1-score': 0.3357507130108691, 'support': 6720744}}
[[1376968  443696  382087]
 [1316850  480552  488518]
 [1230826  456029  545218]]
Evaluating performance on  train set...
9940/9940 - 124s - 124s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009233
{'0': {'precision': 0.3543329434487594, 'recall': 0.6198170023431908, 'f1-score': 0.45089892739521664, 'support': 847989}, '1': {'precision': 0.3343068674099851, 'recall': 0.22438697114828882, 'f1-score': 0.2685338560588936, 'support': 839153}, '2': {'precision': 0.3838127773955102, 'recall': 0.22273569517920505, 'f1-score': 0.2818861464738742, 'support': 856477}, 'accuracy': 0.3556590039624645, 'macro avg': {'precision': 0.3574841960847515, 'recall': 0.35564655622356156, 'f1-score': 0.33377297664266153, 'support': 2543619}, 'weighted avg': {'precision': 0.3576525671632566, 'recall': 0.3556590039624645, 'f1-score': 0.33382645849470205, 'support': 2543619}}
[[525598 185397 136994]
 [481586 188295 169272]
 [476161 189548 190768]]
Evaluating performance on  val set...
3393/3393 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001471
{'0': {'precision': 0.3601392605779661, 'recall': 0.6371913701240485, 'f1-score': 0.46018365789408894, 'support': 293353}, '1': {'precision': 0.32313840310200204, 'recall': 0.2054384464456407, 'f1-score': 0.25118410530848245, 'support': 278278}, '2': {'precision': 0.39491570716518143, 'recall': 0.22931199654581516, 'f1-score': 0.29014703685524657, 'support': 296452}, 'accuracy': 0.3594944262242205, 'macro avg': {'precision': 0.3593977902817165, 'recall': 0.3573139377051681, 'f1-score': 0.33383826668593936, 'support': 868083}, 'weighted avg': {'precision': 0.3601542620547567, 'recall': 0.3594944262242205, 'f1-score': 0.3351176516773743, 'support': 868083}}
[[186922  59319  47112]
 [164063  57169  57046]
 [168042  60430  67980]]
testing model out of sample: results/universal/W2/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 180s - 180s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002662
{'0': {'precision': 0.36927336889865386, 'recall': 0.5896744963969996, 'f1-score': 0.4541458315275612, 'support': 1248404}, '1': {'precision': 0.3272146069716685, 'recall': 0.26714057475138603, 'f1-score': 0.29414162057121934, 'support': 1118501}, '2': {'precision': 0.41194410820483135, 'recall': 0.240878040749252, 'f1-score': 0.3039979260555295, 'support': 1299803}, 'accuracy': 0.3676439465591479, 'macro avg': {'precision': 0.3694773613583846, 'recall': 0.3658977039658793, 'f1-score': 0.3507617927181033, 'support': 3666708}, 'weighted avg': {'precision': 0.3715699214706864, 'recall': 0.3676439465591479, 'f1-score': 0.3521121904699306, 'support': 3666708}}
[[736152 294621 217631]
 [590389 298797 229315]
 [666974 319735 313094]]
Evaluating performance on  train set...
5373/5373 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950487
{'0': {'precision': 0.3671527003084192, 'recall': 0.6031009623676313, 'f1-score': 0.456437641845447, 'support': 463856}, '1': {'precision': 0.3571472542711158, 'recall': 0.24494525835346193, 'f1-score': 0.2905916437536412, 'support': 450023}, '2': {'precision': 0.393499728881513, 'recall': 0.2597346255713012, 'f1-score': 0.3129214011686859, 'support': 461009}, 'accuracy': 0.3707378346454402, 'macro avg': {'precision': 0.37259989448701597, 'recall': 0.3692602820974648, 'f1-score': 0.35331689558925805, 'support': 1374888}, 'weighted avg': {'precision': 0.3727120887483561, 'recall': 0.3707378346454402, 'f1-score': 0.3540316333579035, 'support': 1374888}}
[[279752  97586  86518]
 [241755 110231  98037]
 [240443 100826 119740]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09557
{'0': {'precision': 0.36823961523836585, 'recall': 0.6052027964344088, 'f1-score': 0.45787946411174985, 'support': 145614}, '1': {'precision': 0.357545817704998, 'recall': 0.2512930788135109, 'f1-score': 0.29514799353904886, 'support': 139976}, '2': {'precision': 0.39471674572187626, 'recall': 0.25295184003198257, 'f1-score': 0.30831919076504294, 'support': 145079}, 'accuracy': 0.37151269304268475, 'macro avg': {'precision': 0.3735007262217467, 'recall': 0.36981590509330076, 'f1-score': 0.3537822161386139, 'support': 430669}, 'weighted avg': {'precision': 0.3736832404119597, 'recall': 0.37151269304268475, 'f1-score': 0.3546062886063123, 'support': 430669}}
[[88126 30729 26759]
 [75285 35175 29516]
 [75906 32475 36698]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1106776
{'0': {'precision': 0.31336959963158045, 'recall': 0.6793246312426685, 'f1-score': 0.42889276695988554, 'support': 80134}, '1': {'precision': 0.33478210763734545, 'recall': 0.230961440172639, 'f1-score': 0.2733456104741037, 'support': 88045}, '2': {'precision': 0.3525008317622269, 'recall': 0.07539941407408286, 'f1-score': 0.12422687967169867, 'support': 84311}, 'accuracy': 0.3213156956711157, 'macro avg': {'precision': 0.33355084634371757, 'recall': 0.3285618284964635, 'f1-score': 0.2754884190352293, 'support': 252490}, 'weighted avg': {'precision': 0.33390291809779504, 'recall': 0.3213156956711157, 'f1-score': 0.2729189263485941, 'support': 252490}}
[[54437 19997  5700]
 [61733 20335  5977]
 [57545 20409  6357]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1085553
{'0': {'precision': 0.33390615660490136, 'recall': 0.6686116098144823, 'f1-score': 0.4453856886585609, 'support': 20052}, '1': {'precision': 0.33384662765629813, 'recall': 0.2700682644875181, 'f1-score': 0.29858968708682243, 'support': 20069}, '2': {'precision': 0.34304986750180677, 'recall': 0.06974580006857031, 'f1-score': 0.11592315206773038, 'support': 20417}, 'accuracy': 0.33451716277379495, 'macro avg': {'precision': 0.3369342172543354, 'recall': 0.33614189145685686, 'f1-score': 0.2866328426043712, 'support': 60538}, 'weighted avg': {'precision': 0.3369702231236598, 'recall': 0.33451716277379495, 'f1-score': 0.28560694530532477, 'support': 60538}}
[[13407  5342  1303]
 [13225  5420  1424]
 [13520  5473  1424]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046432
{'0': {'precision': 0.3397906780211922, 'recall': 0.7223604201216142, 'f1-score': 0.4621778151111897, 'support': 7236}, '1': {'precision': 0.34334857391682994, 'recall': 0.21400461392319176, 'f1-score': 0.2636682828958368, 'support': 7369}, '2': {'precision': 0.3096853793954349, 'recall': 0.07179633867276888, 'f1-score': 0.11656797863694415, 'support': 6992}, 'accuracy': 0.33828772514701116, 'macro avg': {'precision': 0.330941543777819, 'recall': 0.3360537909058583, 'f1-score': 0.28080469221465687, 'support': 21597}, 'weighted avg': {'precision': 0.3312580988140643, 'recall': 0.33828772514701116, 'f1-score': 0.28255468599497635, 'support': 21597}}
[[5227 1500  509]
 [5182 1577  610]
 [4974 1516  502]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096665
{'0': {'precision': 0.3380549151345597, 'recall': 0.6410667369980017, 'f1-score': 0.4426738207646292, 'support': 98581}, '1': {'precision': 0.36843950719602186, 'recall': 0.21038405533309065, 'f1-score': 0.26783221239348176, 'support': 109880}, '2': {'precision': 0.41409232395606976, 'recall': 0.25795505474102054, 'f1-score': 0.3178859451874144, 'support': 109333}, 'accuracy': 0.3603497863395785, 'macro avg': {'precision': 0.37352891542888383, 'recall': 0.3698019490240376, 'f1-score': 0.34279732611517516, 'support': 317794}, 'weighted avg': {'precision': 0.37472035562240913, 'recall': 0.3603497863395785, 'f1-score': 0.3392891479001154, 'support': 317794}}
[[63197 18286 17098]
 [63956 23117 22807]
 [59790 21340 28203]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0852284
{'0': {'precision': 0.3785636474745596, 'recall': 0.6342592592592593, 'f1-score': 0.47413520573700935, 'support': 44928}, '1': {'precision': 0.3669555668849759, 'recall': 0.21067207024653833, 'f1-score': 0.2676717109591784, 'support': 44415}, '2': {'precision': 0.41836555360281197, 'recall': 0.313429888084266, 'f1-score': 0.3583741061347384, 'support': 45570}, 'accuracy': 0.3864416327559242, 'macro avg': {'precision': 0.38796158932078245, 'recall': 0.3861204058633545, 'f1-score': 0.3667270076103087, 'support': 134913}, 'weighted avg': {'precision': 0.3881861446607322, 'recall': 0.3864416327559242, 'f1-score': 0.3670639121668356, 'support': 134913}}
[[28496  7613  8819]
 [24020  9357 11038]
 [22758  8529 14283]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.083784
{'0': {'precision': 0.40528251973711404, 'recall': 0.6608478802992519, 'f1-score': 0.5024340251088906, 'support': 14837}, '1': {'precision': 0.3540903540903541, 'recall': 0.1910828025477707, 'f1-score': 0.24821683309557777, 'support': 13659}, '2': {'precision': 0.3723145071982281, 'recall': 0.27789717308646056, 'f1-score': 0.3182506626277925, 'support': 12098}, 'accuracy': 0.38865349559048135, 'macro avg': {'precision': 0.3772291270085654, 'recall': 0.37660928531116106, 'f1-score': 0.35630050694408694, 'support': 40594}, 'weighted avg': {'precision': 0.37823219687500303, 'recall': 0.38865349559048135, 'f1-score': 0.36200433242016405, 'support': 40594}}
[[9805 2384 2648]
 [8029 2610 3020]
 [6359 2377 3362]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1183105
{'0': {'precision': 0.3361202684990269, 'recall': 0.564304607793016, 'f1-score': 0.4212993693992698, 'support': 89978}, '1': {'precision': 0.2760043147900096, 'recall': 0.29592913155653844, 'f1-score': 0.28561965628488367, 'support': 78681}, '2': {'precision': 0.4127884491427098, 'recall': 0.15168310452964973, 'f1-score': 0.221846550362354, 'support': 105549}, 'accuracy': 0.32846962889485354, 'macro avg': {'precision': 0.34163767747724877, 'recall': 0.33730561462640135, 'f1-score': 0.30958852534883585, 'support': 274208}, 'weighted avg': {'precision': 0.3483820057385709, 'recall': 0.32846962889485354, 'f1-score': 0.3055935508087092, 'support': 274208}}
[[50775 27987 11216]
 [43838 23284 11559]
 [56449 33090 16010]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050891
{'0': {'precision': 0.35205183585313177, 'recall': 0.5795321401155509, 'f1-score': 0.43801816932590276, 'support': 24751}, '1': {'precision': 0.32789536266349584, 'recall': 0.28305140417145674, 'f1-score': 0.3038275930455477, 'support': 24356}, '2': {'precision': 0.3505859375, 'recall': 0.16505057259884645, 'f1-score': 0.22443876101165103, 'support': 23926}, 'accuracy': 0.3448714964468117, 'macro avg': {'precision': 0.3435110453388759, 'recall': 0.342544705628618, 'f1-score': 0.32209484112770054, 'support': 73033}, 'weighted avg': {'precision': 0.34351558313170716, 'recall': 0.3448714964468117, 'f1-score': 0.32329678859101424, 'support': 73033}}
[[14344  7045  3362]
 [13509  6894  3953]
 [12891  7086  3949]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080385
{'0': {'precision': 0.34305357989568513, 'recall': 0.5979956607087509, 'f1-score': 0.4359911114458966, 'support': 9679}, '1': {'precision': 0.3295032497678737, 'recall': 0.2932851239669422, 'f1-score': 0.3103410581547879, 'support': 9680}, '2': {'precision': 0.38741032168479517, 'recall': 0.1601913875598086, 'f1-score': 0.22666034797914836, 'support': 10450}, 'accuracy': 0.3455667751350263, 'macro avg': {'precision': 0.35332238378278474, 'recall': 0.3504907240785005, 'f1-score': 0.3243308391932776, 'support': 29809}, 'weighted avg': {'precision': 0.35420325804855796, 'recall': 0.3455667751350263, 'f1-score': 0.32180415468500384, 'support': 29809}}
[[5788 2673 1218]
 [5412 2839 1429]
 [5672 3104 1674]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158917
{'0': {'precision': 0.3347792099401078, 'recall': 0.7818561172804765, 'f1-score': 0.4688176468167414, 'support': 72851}, '1': {'precision': 0.27111713203381754, 'recall': 0.18118262444045802, 'f1-score': 0.21720866663986815, 'support': 59647}, '2': {'precision': 0.40517154643324277, 'recall': 0.04605391063688659, 'f1-score': 0.082706921339084, 'support': 87441}, 'accuracy': 0.3264223261904437, 'macro avg': {'precision': 0.3370226294690561, 'recall': 0.3363642174526071, 'f1-score': 0.25624441159856454, 'support': 219939}, 'weighted avg': {'precision': 0.34550002041219197, 'recall': 0.3264223261904437, 'f1-score': 0.24707603306428363, 'support': 219939}}
[[56959 12558  3334]
 [46262 10807  2578]
 [66918 16496  4027]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1075433
{'0': {'precision': 0.33712390063261843, 'recall': 0.7956664238892935, 'f1-score': 0.4735883819226184, 'support': 27460}, '1': {'precision': 0.3354174609226077, 'recall': 0.1633736908564213, 'f1-score': 0.2197247820983492, 'support': 26926}, '2': {'precision': 0.34185303514376997, 'recall': 0.04704158270745558, 'f1-score': 0.08270265047824547, 'support': 27295}, 'accuracy': 0.3370673718490224, 'macro avg': {'precision': 0.33813146556633206, 'recall': 0.33536056581772344, 'f1-score': 0.2586719381664043, 'support': 81681}, 'weighted avg': {'precision': 0.33814169094921753, 'recall': 0.3370673718490224, 'f1-score': 0.259282027585105, 'support': 81681}}
[[21849  4373  1238]
 [21293  4399  1234]
 [21668  4343  1284]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066265
{'0': {'precision': 0.3474289751223697, 'recall': 0.7937514410883099, 'f1-score': 0.4833105191112983, 'support': 8674}, '1': {'precision': 0.2987964416535845, 'recall': 0.14620407118166687, 'f1-score': 0.19633800395426804, 'support': 7811}, '2': {'precision': 0.3388804841149773, 'recall': 0.052855120339782916, 'f1-score': 0.09144723412941418, 'support': 8476}, 'accuracy': 0.33952966627939585, 'macro avg': {'precision': 0.3283686336303105, 'recall': 0.33093687753658657, 'f1-score': 0.2570319190649935, 'support': 24961}, 'weighted avg': {'precision': 0.3293076767487733, 'recall': 0.33952966627939585, 'f1-score': 0.26044382629458374, 'support': 24961}}
[[6885 1359  430]
 [6225 1142  444]
 [6707 1321  448]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1060779
{'0': {'precision': 0.31678595742331966, 'recall': 0.5782600810108216, 'f1-score': 0.4093301697042895, 'support': 148869}, '1': {'precision': 0.36333361436641093, 'recall': 0.28916511499169645, 'f1-score': 0.3220340566240414, 'support': 178839}, '2': {'precision': 0.35523557102733494, 'recall': 0.16608510166085103, 'f1-score': 0.22634566023785618, 'support': 162206}, 'accuracy': 0.3362610580632519, 'macro avg': {'precision': 0.34511838093902186, 'recall': 0.3445034325544564, 'f1-score': 0.31923662885539567, 'support': 489914}, 'weighted avg': {'precision': 0.3465081014002185, 'recall': 0.3362610580632519, 'f1-score': 0.31687897437271956, 'support': 489914}}
[[86085 43060 19724]
 [97952 51714 29173]
 [87708 47558 26940]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022186
{'0': {'precision': 0.3546246494965723, 'recall': 0.5751509168298564, 'f1-score': 0.43873532425525613, 'support': 61789}, '1': {'precision': 0.3428822932812829, 'recall': 0.29484458047423934, 'f1-score': 0.3170541812648194, 'support': 60771}, '2': {'precision': 0.36275438539182703, 'recall': 0.1834839647737224, 'f1-score': 0.243701720505618, 'support': 60523}, 'accuracy': 0.35263241262159783, 'macro avg': {'precision': 0.3534204427232274, 'recall': 0.35115982069260604, 'f1-score': 0.3331637420085645, 'support': 183083}, 'weighted avg': {'precision': 0.3534144949548024, 'recall': 0.35263241262159783, 'f1-score': 0.33387193693687495, 'support': 183083}}
[[35538 17201  9050]
 [32395 17918 10458]
 [32280 17138 11105]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055981
{'0': {'precision': 0.3464699411117582, 'recall': 0.5872545793572447, 'f1-score': 0.4358160358160358, 'support': 18234}, '1': {'precision': 0.33128951906495496, 'recall': 0.28963091183203976, 'f1-score': 0.30906274206041834, 'support': 17909}, '2': {'precision': 0.36732171548634285, 'recall': 0.16055318459294474, 'f1-score': 0.22344184647770843, 'support': 18511}, 'accuracy': 0.3452080360083434, 'macro avg': {'precision': 0.34836039188768536, 'recall': 0.3458128919274097, 'f1-score': 0.3227735414513875, 'support': 54654}, 'weighted avg': {'precision': 0.3485580045108093, 'recall': 0.3452080360083434, 'f1-score': 0.3223516351004225, 'support': 54654}}
[[10708  5250  2276]
 [ 9879  5187  2843]
 [10319  5220  2972]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/EXC
Evaluating performance on  test set...
4918/4918 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949706
{'0': {'precision': 0.3728757468282501, 'recall': 0.5504755731067043, 'f1-score': 0.4445956506507855, 'support': 419599}, '1': {'precision': 0.33410759945293456, 'recall': 0.22036877249061154, 'f1-score': 0.26557265664234436, 'support': 407948}, '2': {'precision': 0.41352492107942285, 'recall': 0.35505823268496384, 'f1-score': 0.3820677747892954, 'support': 431287}, 'accuracy': 0.37654686797464954, 'macro avg': {'precision': 0.37350275578686915, 'recall': 0.3753008594274265, 'f1-score': 0.3640786940274751, 'support': 1258834}, 'weighted avg': {'precision': 0.3742389704381941, 'recall': 0.37654686797464954, 'f1-score': 0.3651574305547045, 'support': 1258834}}
[[230979  89748  98872]
 [199744  89899 118305]
 [188730  89425 153132]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960553
{'0': {'precision': 0.3735405070303638, 'recall': 0.58613781056222, 'f1-score': 0.4562908444077803, 'support': 120789}, '1': {'precision': 0.32094009436779547, 'recall': 0.1825857968059803, 'f1-score': 0.2327550733112425, 'support': 117720}, '2': {'precision': 0.4056287997814058, 'recall': 0.34502909413883837, 'f1-score': 0.3728828764173963, 'support': 120471}, 'accuracy': 0.37288706891748846, 'macro avg': {'precision': 0.3667031337265217, 'recall': 0.37125090050234627, 'f1-score': 0.35397626471213967, 'support': 358980}, 'weighted avg': {'precision': 0.36705989010845513, 'recall': 0.37288706891748846, 'f1-score': 0.3549958633914173, 'support': 358980}}
[[70799 22921 27069]
 [62388 21494 33838]
 [56348 22557 41566]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002097
{'0': {'precision': 0.39046947509961794, 'recall': 0.5510888935175542, 'f1-score': 0.4570792383292383, 'support': 43209}, '1': {'precision': 0.267997999153488, 'recall': 0.19363358354184043, 'f1-score': 0.2248260946755112, 'support': 35970}, '2': {'precision': 0.43025402864816475, 'recall': 0.35323977306658705, 'f1-score': 0.38796180673805836, 'support': 43537}, 'accuracy': 0.3761204732879168, 'macro avg': {'precision': 0.3629071676337569, 'recall': 0.36598741670866053, 'f1-score': 0.3566223799142693, 'support': 122716}, 'weighted avg': {'precision': 0.36868585371414897, 'recall': 0.3761204732879168, 'f1-score': 0.3644807899084149, 'support': 122716}}
[[23812  9521  9876]
 [18516  6965 10489]
 [18655  9503 15379]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/AAL
Evaluating performance on  test set...
4856/4856 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946957
{'0': {'precision': 0.3980711788620349, 'recall': 0.5908943740191295, 'f1-score': 0.47568496064089544, 'support': 444758}, '1': {'precision': 0.31953646983650735, 'recall': 0.25376867791524405, 'f1-score': 0.28288023512123434, 'support': 362594}, '2': {'precision': 0.4106873854922983, 'recall': 0.2779165556953539, 'f1-score': 0.33150209232521965, 'support': 435548}, 'accuracy': 0.38286748732802317, 'macro avg': {'precision': 0.3760983447302802, 'recall': 0.37419320254324245, 'f1-score': 0.3633557626957831, 'support': 1242900}, 'weighted avg': {'precision': 0.37958115495101696, 'recall': 0.38286748732802317, 'f1-score': 0.36891177166814465, 'support': 1242900}}
[[262805  96543  85410]
 [182295  92015  88284]
 [215096  99406 121046]]
Evaluating performance on  train set...
2076/2076 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0908037
{'0': {'precision': 0.3713964262078094, 'recall': 0.6303339361331701, 'f1-score': 0.46739877315942685, 'support': 178058}, '1': {'precision': 0.37544804745634813, 'recall': 0.20440734252766002, 'f1-score': 0.26470164445610284, 'support': 175253}, '2': {'precision': 0.3991748632246106, 'recall': 0.29987815765388914, 'f1-score': 0.34247423010949196, 'support': 178099}, 'accuracy': 0.37911781863344685, 'macro avg': {'precision': 0.38200644562958935, 'recall': 0.3782064787715731, 'f1-score': 0.3581915492416739, 'support': 531410}, 'weighted avg': {'precision': 0.3820423881447798, 'recall': 0.37911781863344685, 'f1-score': 0.3586838146729588, 'support': 531410}}
[[112236  28544  37278]
 [ 96320  35823  43110]
 [ 93644  31047  53408]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0894456
{'0': {'precision': 0.377655445828308, 'recall': 0.6206409325509743, 'f1-score': 0.46957683741648104, 'support': 50957}, '1': {'precision': 0.39450412921143024, 'recall': 0.21984645773514977, 'f1-score': 0.28234801825480893, 'support': 49107}, '2': {'precision': 0.3985612611923165, 'recall': 0.31095012538311506, 'f1-score': 0.34934654040940444, 'support': 50246}, 'accuracy': 0.38617523784179364, 'macro avg': {'precision': 0.3902402787440183, 'recall': 0.3838125052230797, 'f1-score': 0.36709046536023143, 'support': 150310}, 'weighted avg': {'precision': 0.39014843959901485, 'recall': 0.38617523784179364, 'f1-score': 0.36821739941508524, 'support': 150310}}
[[31626  8156 11175]
 [25909 10796 12402]
 [26208  8414 15624]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/WBA
Evaluating performance on  test set...
4353/4353 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.08567
{'0': {'precision': 0.4112131902129827, 'recall': 0.5894856401103359, 'f1-score': 0.4844699789969662, 'support': 406758}, '1': {'precision': 0.35899863983058145, 'recall': 0.24123678539922194, 'f1-score': 0.28856570004099924, 'support': 345735}, '2': {'precision': 0.3916114568694372, 'recall': 0.32349429226899584, 'f1-score': 0.3543086354347991, 'support': 361790}, 'accuracy': 0.3950692956816177, 'macro avg': {'precision': 0.38727442897100045, 'recall': 0.38473890592618454, 'f1-score': 0.3757814381575882, 'support': 1114283}, 'weighted avg': {'precision': 0.3886479095052802, 'recall': 0.3950692956816177, 'f1-score': 0.38142430893631046, 'support': 1114283}}
[[239778  75941  91039]
 [171547  83404  90784]
 [171774  72979 117037]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0927391
{'0': {'precision': 0.37612468868617166, 'recall': 0.5805225969870684, 'f1-score': 0.4564877449338835, 'support': 135018}, '1': {'precision': 0.3530604615332329, 'recall': 0.2387335973587247, 'f1-score': 0.28485380277313155, 'support': 130543}, '2': {'precision': 0.3855464759959142, 'recall': 0.2925946310493717, 'f1-score': 0.33270016438887445, 'support': 129001}, 'accuracy': 0.3733025481419904, 'macro avg': {'precision': 0.3715772087384395, 'recall': 0.3706169417983883, 'f1-score': 0.3580139040319632, 'support': 394562}, 'weighted avg': {'precision': 0.37157419112056217, 'recall': 0.3733025481419904, 'f1-score': 0.3592296932477663, 'support': 394562}}
[[78381 28227 28410]
 [67633 31165 31745]
 [62377 28879 37745]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0917639
{'0': {'precision': 0.3858813082729022, 'recall': 0.6034251330710484, 'f1-score': 0.4707347896732263, 'support': 43210}, '1': {'precision': 0.3506757857026543, 'recall': 0.23107462846719246, 'f1-score': 0.27858089971216976, 'support': 37278}, '2': {'precision': 0.41251002405773857, 'recall': 0.3003199364797646, 'f1-score': 0.34758635601924426, 'support': 42821}, 'accuracy': 0.3856004022415233, 'macro avg': {'precision': 0.383022372677765, 'recall': 0.3782732326726685, 'f1-score': 0.3656340151348801, 'support': 123309}, 'weighted avg': {'precision': 0.38448543910073124, 'recall': 0.3856004022415233, 'f1-score': 0.3698787954841125, 'support': 123309}}
[[26074  7603  9533]
 [19882  8614  8782]
 [21614  8347 12860]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
5497/5497 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977367
{'0': {'precision': 0.3825305861198276, 'recall': 0.5820267607522722, 'f1-score': 0.4616481096743205, 'support': 484665}, '1': {'precision': 0.3301790175347202, 'recall': 0.27184397405091365, 'f1-score': 0.2981852106294424, 'support': 410342}, '2': {'precision': 0.42877629351120433, 'recall': 0.27787008311385053, 'f1-score': 0.3372099773135177, 'support': 512189}, 'accuracy': 0.3808701843950665, 'macro avg': {'precision': 0.38049529905525065, 'recall': 0.3772469393056788, 'f1-score': 0.3656810992057602, 'support': 1407196}, 'weighted avg': {'precision': 0.38409717333776433, 'recall': 0.3808701843950665, 'f1-score': 0.36868910787526726, 'support': 1407196}}
[[282088 107060  95517]
 [204706 111549  94087]
 [250632 119235 142322]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941494
{'0': {'precision': 0.3736205707388568, 'recall': 0.580376773099115, 'f1-score': 0.4545939307053162, 'support': 179206}, '1': {'precision': 0.3564492082040537, 'recall': 0.2608300800830316, 'f1-score': 0.30123374390023805, 'support': 169574}, '2': {'precision': 0.40032807185416885, 'recall': 0.2796275078070589, 'f1-score': 0.3292648649006141, 'support': 178044}, 'accuracy': 0.37588074954823625, 'macro avg': {'precision': 0.3767992835990264, 'recall': 0.3736114536630685, 'f1-score': 0.3616975131687228, 'support': 526824}, 'weighted avg': {'precision': 0.37711945024718957, 'recall': 0.37588074954823625, 'f1-score': 0.36287451680348803, 'support': 526824}}
[[104007  39570  35629]
 [ 86396  44230  38948]
 [ 87973  40285  49786]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947115
{'0': {'precision': 0.3750176031544853, 'recall': 0.5817537137863816, 'f1-score': 0.4560502170318994, 'support': 59508}, '1': {'precision': 0.35414793431451425, 'recall': 0.2676932982776198, 'f1-score': 0.30491071883308035, 'support': 55911}, '2': {'precision': 0.4002618064646058, 'recall': 0.27004076086956524, 'f1-score': 0.3225021297310454, 'support': 58880}, 'accuracy': 0.37571070402010337, 'macro avg': {'precision': 0.3764757813112018, 'recall': 0.37316259097785554, 'f1-score': 0.36115435519867506, 'support': 174299}, 'weighted avg': {'precision': 0.3768508588609913, 'recall': 0.37571070402010337, 'f1-score': 0.36245431651572635, 'support': 174299}}
[[34619 13278 11611]
 [28731 14967 12213]
 [28963 14017 15900]]
testing model on single stock: results/universal/W2/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
14883/14883 - 174s - 174s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104288
{'0': {'precision': 0.3323900660935458, 'recall': 0.6523409036965481, 'f1-score': 0.4403875631969594, 'support': 1204962}, '1': {'precision': 0.3525033071296176, 'recall': 0.20082556083099118, 'f1-score': 0.25587558664705057, 'support': 1362710}, '2': {'precision': 0.3630731362277576, 'recall': 0.19544896161877667, 'f1-score': 0.2541072868593509, 'support': 1242222}, 'accuracy': 0.3418740783864328, 'macro avg': {'precision': 0.3493221698169737, 'recall': 0.3495384753821053, 'f1-score': 0.31679014556778695, 'support': 3809894}, 'weighted avg': {'precision': 0.34958836595189524, 'recall': 0.3418740783864328, 'f1-score': 0.31365496302567303, 'support': 3809894}}
[[786046 247216 171700]
 [834823 273667 254220]
 [743961 255470 242791]]
Evaluating performance on  train set...
6147/6147 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051311
{'0': {'precision': 0.345024858536173, 'recall': 0.628164234292816, 'f1-score': 0.4454062990869277, 'support': 519794}, '1': {'precision': 0.32888603074852524, 'recall': 0.2332927211870295, 'f1-score': 0.2729619958404976, 'support': 519549}, '2': {'precision': 0.37017286051278087, 'recall': 0.17920957052458156, 'f1-score': 0.24150215079535278, 'support': 534140}, 'accuracy': 0.3453777384312382, 'macro avg': {'precision': 0.3480279165991597, 'recall': 0.3468888420014757, 'f1-score': 0.319956815240926, 'support': 1573483}, 'weighted avg': {'precision': 0.34823280036810933, 'recall': 0.3453777384312382, 'f1-score': 0.3192488337213398, 'support': 1573483}}
[[326516 121724  71554]
 [307029 121207  91313]
 [312810 125607  95723]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028992
{'0': {'precision': 0.34664172965858814, 'recall': 0.6547815704682619, 'f1-score': 0.4533040445672359, 'support': 183423}, '1': {'precision': 0.32699580196370953, 'recall': 0.20538243626062322, 'f1-score': 0.2522987967288156, 'support': 183560}, '2': {'precision': 0.37751483037429545, 'recall': 0.1887135922330097, 'f1-score': 0.25163759683104786, 'support': 189520}, 'accuracy': 0.3478274151262437, 'macro avg': {'precision': 0.3503841206655311, 'recall': 0.3496258663206316, 'f1-score': 0.31908014604236645, 'support': 556503}, 'weighted avg': {'precision': 0.3506756046960433, 'recall': 0.3478274151262437, 'f1-score': 0.3183248109095866, 'support': 556503}}
[[120102  38578  24743]
 [111630  37700  34230]
 [114741  39014  35765]]
training model: results/universal/W2/deepOF_L2/h500
Epoch 1/50
9940/9940 - 278s - loss: 3.2612 - accuracy500: 0.3838 - val_loss: 3.2998 - val_accuracy500: 0.3614 - 278s/epoch - 28ms/step
Epoch 2/50
9940/9940 - 274s - loss: 3.2523 - accuracy500: 0.3899 - val_loss: 3.2989 - val_accuracy500: 0.3595 - 274s/epoch - 28ms/step
Epoch 3/50
9940/9940 - 272s - loss: 3.2439 - accuracy500: 0.3958 - val_loss: 3.3024 - val_accuracy500: 0.3580 - 272s/epoch - 27ms/step
Epoch 4/50
9940/9940 - 275s - loss: 3.2387 - accuracy500: 0.3996 - val_loss: 3.3096 - val_accuracy500: 0.3593 - 275s/epoch - 28ms/step
Epoch 5/50
9940/9940 - 275s - loss: 3.2354 - accuracy500: 0.4018 - val_loss: 3.3122 - val_accuracy500: 0.3579 - 275s/epoch - 28ms/step
Epoch 6/50
9940/9940 - 272s - loss: 3.2331 - accuracy500: 0.4039 - val_loss: 3.3215 - val_accuracy500: 0.3587 - 272s/epoch - 27ms/step
Epoch 7/50
9940/9940 - 272s - loss: 3.2311 - accuracy500: 0.4052 - val_loss: 3.3235 - val_accuracy500: 0.3584 - 272s/epoch - 27ms/step
Epoch 8/50
9940/9940 - 272s - loss: 3.2291 - accuracy500: 0.4067 - val_loss: 3.3254 - val_accuracy500: 0.3581 - 272s/epoch - 27ms/step
Epoch 9/50
9940/9940 - 276s - loss: 3.2266 - accuracy500: 0.4081 - val_loss: 3.3251 - val_accuracy500: 0.3570 - 276s/epoch - 28ms/step
Epoch 10/50
9940/9940 - 272s - loss: 3.2248 - accuracy500: 0.4095 - val_loss: 3.3249 - val_accuracy500: 0.3568 - 272s/epoch - 27ms/step
Epoch 11/50
9940/9940 - 272s - loss: 3.2230 - accuracy500: 0.4103 - val_loss: 3.3258 - val_accuracy500: 0.3553 - 272s/epoch - 27ms/step
Epoch 12/50
9940/9940 - 272s - loss: 3.2212 - accuracy500: 0.4120 - val_loss: 3.3301 - val_accuracy500: 0.3545 - 272s/epoch - 27ms/step
testing model in sample: results/universal/W2/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 328s - 328s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021461
{'0': {'precision': 0.3396845819460689, 'recall': 0.7096497353182031, 'f1-score': 0.4594476130317821, 'support': 2188288}, '1': {'precision': 0.3734342438121984, 'recall': 0.11493718167985145, 'f1-score': 0.17577391831750117, 'support': 2332361}, '2': {'precision': 0.3712819645718063, 'recall': 0.24153093389149105, 'f1-score': 0.29267033988667507, 'support': 2200095}, 'accuracy': 0.35001839082101627, 'macro avg': {'precision': 0.36146693011002445, 'recall': 0.3553726169631819, 'f1-score': 0.3092972904119861, 'support': 6720744}, 'weighted avg': {'precision': 0.36174071719355333, 'recall': 0.35001839082101627, 'f1-score': 0.3064057315023444, 'support': 6720744}}
[[1552918  224662  410708]
 [1575152  268075  489134]
 [1443577  225127  531391]]
Evaluating performance on  train set...
9940/9940 - 122s - 122s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100819
{'0': {'precision': 0.35037533897656337, 'recall': 0.7060335186390605, 'f1-score': 0.46833521252428767, 'support': 855703}, '1': {'precision': 0.3445034325249768, 'recall': 0.12396712167418308, 'f1-score': 0.18232564909017332, 'support': 828631}, '2': {'precision': 0.37445263598230016, 'recall': 0.22709578312201423, 'f1-score': 0.28272575210859896, 'support': 859285}, 'accuracy': 0.35461993325258223, 'macro avg': {'precision': 0.35644380249461344, 'recall': 0.35236547447841926, 'f1-score': 0.31112887124102, 'support': 2543619}, 'weighted avg': {'precision': 0.3565962456621518, 'recall': 0.35461993325258223, 'f1-score': 0.31245973913331654, 'support': 2543619}}
[[604155  97535 154013]
 [553927 102723 171981]
 [566226  97919 195140]]
Evaluating performance on  val set...
3393/3393 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994517
{'0': {'precision': 0.3544571795584866, 'recall': 0.7287165979227073, 'f1-score': 0.47692962175983467, 'support': 293844}, '1': {'precision': 0.34432182607055273, 'recall': 0.10560306640872191, 'f1-score': 0.16163338046994558, 'support': 276545}, '2': {'precision': 0.38264597042916226, 'recall': 0.23029016372516745, 'f1-score': 0.28753274042322957, 'support': 297694}, 'accuracy': 0.35928476885274796, 'macro avg': {'precision': 0.36047499201940053, 'recall': 0.35486994268553224, 'f1-score': 0.3086985808843366, 'support': 868083}, 'weighted avg': {'precision': 0.36089521898459476, 'recall': 0.35928476885274796, 'f1-score': 0.3115353976589922, 'support': 868083}}
[[214129  27831  51884]
 [188618  29204  58723]
 [201357  27781  68556]]
testing model out of sample: results/universal/W2/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 182s - 182s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018804
{'0': {'precision': 0.3534995796997561, 'recall': 0.6650112012728462, 'f1-score': 0.4616174605851417, 'support': 1236913}, '1': {'precision': 0.30999870958776293, 'recall': 0.138966289654976, 'f1-score': 0.191905251152776, 'support': 1123661}, '2': {'precision': 0.39157621533695736, 'recall': 0.2506565176314222, 'f1-score': 0.30565595767752973, 'support': 1306134}, 'accuracy': 0.3562058936790167, 'macro avg': {'precision': 0.3516915015414921, 'recall': 0.35154466951974817, 'f1-score': 0.3197262231384825, 'support': 3666708}, 'weighted avg': {'precision': 0.3537322017685021, 'recall': 0.3562058936790167, 'f1-score': 0.3234085515032861, 'support': 3666708}}
[[822561 167957 246395]
 [705211 156151 262299]
 [799136 179607 327391]]
Evaluating performance on  train set...
5373/5373 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1008708
{'0': {'precision': 0.3502390744866798, 'recall': 0.6805314557265554, 'f1-score': 0.4624670578493053, 'support': 458740}, '1': {'precision': 0.34803991170889753, 'recall': 0.11624062062825893, 'f1-score': 0.17427556196160998, 'support': 463917}, '2': {'precision': 0.3673461313726445, 'recall': 0.2669144751244386, 'f1-score': 0.30917890482221966, 'support': 452231}, 'accuracy': 0.3540797504960404, 'macro avg': {'precision': 0.3552083725227406, 'recall': 0.35456218382641763, 'f1-score': 0.31530717487771165, 'support': 1374888}, 'weighted avg': {'precision': 0.3551239177933464, 'recall': 0.3540797504960404, 'f1-score': 0.314805147257807, 'support': 1374888}}
[[312187  50955  95598]
 [297704  53926 112287]
 [281463  50061 120707]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029956
{'0': {'precision': 0.3439696763337765, 'recall': 0.6761887222784936, 'f1-score': 0.45598490638135264, 'support': 141181}, '1': {'precision': 0.34694983834433624, 'recall': 0.12030100424252188, 'f1-score': 0.17865527536997622, 'support': 148968}, '2': {'precision': 0.3618061235550913, 'recall': 0.26127953316253916, 'f1-score': 0.3034335136385989, 'support': 140520}, 'accuracy': 0.3485298454265341, 'macro avg': {'precision': 0.35090854607773464, 'recall': 0.3525897532278515, 'f1-score': 0.3126912317966426, 'support': 430669}, 'weighted avg': {'precision': 0.35082024216955343, 'recall': 0.3485298454265341, 'f1-score': 0.31028191364049024, 'support': 430669}}
[[95465 16801 28915]
 [95200 17921 35847]
 [86874 16931 36715]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112649
{'0': {'precision': 0.30113730983611375, 'recall': 0.797431906614786, 'f1-score': 0.4371804626225708, 'support': 77100}, '1': {'precision': 0.3519585626416316, 'recall': 0.11341066510890428, 'f1-score': 0.17154488221279013, 'support': 95864}, '2': {'precision': 0.3240220259263508, 'recall': 0.07103337273344566, 'f1-score': 0.11652227722772276, 'support': 79526}, 'accuracy': 0.30893500732702284, 'macro avg': {'precision': 0.32570596613469877, 'recall': 0.327291981485712, 'f1-score': 0.24174920735436123, 'support': 252490}, 'weighted avg': {'precision': 0.3276407694216037, 'recall': 0.30893500732702284, 'f1-score': 0.23532869767301282, 'support': 252490}}
[[61482 10084  5534]
 [78741 10872  6251]
 [63943  9934  5649]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064662
{'0': {'precision': 0.33410438051178254, 'recall': 0.8020327218641546, 'f1-score': 0.471708291416991, 'support': 20170}, '1': {'precision': 0.33576001004142086, 'recall': 0.1323209339137317, 'f1-score': 0.18983074903310507, 'support': 20216}, '2': {'precision': 0.3333333333333333, 'recall': 0.06867804684398571, 'f1-score': 0.11389071757735353, 'support': 20152}, 'accuracy': 0.3342693845188146, 'macro avg': {'precision': 0.3343992412955122, 'recall': 0.3343439008739573, 'f1-score': 0.25847658600914986, 'support': 60538}, 'weighted avg': {'precision': 0.3344005922107329, 'recall': 0.3342693845188146, 'f1-score': 0.2584674155233538, 'support': 60538}}
[[16177  2679  1314]
 [16087  2675  1454]
 [16155  2613  1384]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051186
{'0': {'precision': 0.3319596814612686, 'recall': 0.8450524525092147, 'f1-score': 0.47667026508336335, 'support': 7054}, '1': {'precision': 0.4091566265060241, 'recall': 0.10486660079051384, 'f1-score': 0.16694523645659226, 'support': 8096}, '2': {'precision': 0.2856230031948882, 'recall': 0.0693345742205677, 'f1-score': 0.11158262606090862, 'support': 6447}, 'accuracy': 0.3360188915127101, 'macro avg': {'precision': 0.3422464370540603, 'recall': 0.33975120917343204, 'f1-score': 0.25173270920028806, 'support': 21597}, 'weighted avg': {'precision': 0.3470661269073484, 'recall': 0.3360188915127101, 'f1-score': 0.25158095450596346, 'support': 21597}}
[[5961  614  479]
 [6608  849  639]
 [5388  612  447]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1175176
{'0': {'precision': 0.2676383456695098, 'recall': 0.7267126783153904, 'f1-score': 0.39120225013082155, 'support': 82298}, '1': {'precision': 0.4049677810210938, 'recall': 0.1036093478092393, 'f1-score': 0.16500328188902166, 'support': 141937}, '2': {'precision': 0.34909855562066944, 'recall': 0.21648371615771866, 'f1-score': 0.26724371111712203, 'support': 93559}, 'accuracy': 0.2982026092374305, 'macro avg': {'precision': 0.340568227437091, 'recall': 0.34893524742744947, 'f1-score': 0.2744830810456551, 'support': 317794}, 'weighted avg': {'precision': 0.3529560793218705, 'recall': 0.2982026092374305, 'f1-score': 0.2536809630488783, 'support': 317794}}
[[ 59807   9994  12497]
 [101964  14706  25267]
 [ 61691  11614  20254]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0931685
{'0': {'precision': 0.3629510021056766, 'recall': 0.7264647435197519, 'f1-score': 0.48405965805747536, 'support': 45793}, '1': {'precision': 0.36559459258709054, 'recall': 0.1116403556523317, 'f1-score': 0.17104828760577573, 'support': 44088}, '2': {'precision': 0.40083241029772093, 'recall': 0.26518919879197017, 'f1-score': 0.31919812896759103, 'support': 45032}, 'accuracy': 0.37158020353857674, 'macro avg': {'precision': 0.3764593349968293, 'recall': 0.3677647659880179, 'f1-score': 0.32476869154361404, 'support': 134913}, 'weighted avg': {'precision': 0.37645916062893764, 'recall': 0.37158020353857674, 'f1-score': 0.32674279698070585, 'support': 134913}}
[[33267  4204  8322]
 [29637  4922  9529]
 [28753  4337 11942]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013277
{'0': {'precision': 0.35696931833958073, 'recall': 0.7462632419097374, 'f1-score': 0.48293186833826357, 'support': 13782}, '1': {'precision': 0.36422845691382766, 'recall': 0.09086364204474441, 'f1-score': 0.14544363308992697, 'support': 16002}, '2': {'precision': 0.32028241335044927, 'recall': 0.23080481036077705, 'f1-score': 0.26827956989247315, 'support': 10810}, 'accuracy': 0.3506429521604178, 'macro avg': {'precision': 0.3471600628679526, 'recall': 0.3559772314384196, 'f1-score': 0.2988850237735546, 'support': 40594}, 'weighted avg': {'precision': 0.3500612849487493, 'recall': 0.3506429521604178, 'f1-score': 0.2927343493294722, 'support': 40594}}
[[10285  1390  2107]
 [11360  1454  3188]
 [ 7167  1148  2495]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097757
{'0': {'precision': 0.33044733044733043, 'recall': 0.6888002734419506, 'f1-score': 0.4466279061177148, 'support': 87770}, '1': {'precision': 0.2919004488618147, 'recall': 0.1850694312103772, 'f1-score': 0.22652101232360145, 'support': 78711}, '2': {'precision': 0.4155542658154382, 'recall': 0.1595143278843744, 'f1-score': 0.2305354878956795, 'support': 107727}, 'accuracy': 0.33626662971175164, 'macro avg': {'precision': 0.34596734837486115, 'recall': 0.3444613441789008, 'f1-score': 0.30122813544566523, 'support': 274208}, 'weighted avg': {'precision': 0.3528181264486237, 'recall': 0.33626662971175164, 'f1-score': 0.2985511845952441, 'support': 274208}}
[[60456 15654 11660]
 [51636 14567 12508]
 [70860 19683 17184]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035514
{'0': {'precision': 0.344243491796899, 'recall': 0.6900558383971095, 'f1-score': 0.45933942797797184, 'support': 24356}, '1': {'precision': 0.3581099017786037, 'recall': 0.16108103805126572, 'f1-score': 0.22221002059025394, 'support': 25124}, '2': {'precision': 0.34154465876520257, 'recall': 0.18719483717573132, 'f1-score': 0.24184082058033018, 'support': 23553}, 'accuracy': 0.3459121219174894, 'macro avg': {'precision': 0.3479660174469017, 'recall': 0.3461105712080355, 'f1-score': 0.307796756382852, 'support': 73033}, 'weighted avg': {'precision': 0.3481432914762878, 'recall': 0.3459121219174894, 'f1-score': 0.30762193134979443, 'support': 73033}}
[[16807  3639  3910]
 [16487  4047  4590]
 [15529  3615  4409]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046045
{'0': {'precision': 0.3363105633451425, 'recall': 0.702010207270076, 'f1-score': 0.4547601376425343, 'support': 9601}, '1': {'precision': 0.3507820646506778, 'recall': 0.17258362405089267, 'f1-score': 0.23134584966646032, 'support': 9746}, '2': {'precision': 0.3814598833701991, 'recall': 0.1813228828139935, 'f1-score': 0.24580498866213152, 'support': 10462}, 'accuracy': 0.34617061961152673, 'macro avg': {'precision': 0.35618417045533973, 'recall': 0.3519722380449874, 'f1-score': 0.31063699199037537, 'support': 29809}, 'weighted avg': {'precision': 0.35688795399313095, 'recall': 0.34617061961152673, 'f1-score': 0.3083786951504081, 'support': 29809}}
[[6740 1477 1384]
 [6372 1682 1692]
 [6929 1636 1897]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105006
{'0': {'precision': 0.32416593479274414, 'recall': 0.8391338516377108, 'f1-score': 0.4676672558619719, 'support': 71258}, '1': {'precision': 0.27536875777501335, 'recall': 0.10209359403053912, 'f1-score': 0.1489599480875302, 'support': 60709}, '2': {'precision': 0.4007554150928852, 'recall': 0.059098349474832904, 'f1-score': 0.10300658774580217, 'support': 87972}, 'accuracy': 0.32368975033986697, 'macro avg': {'precision': 0.3334300358868809, 'recall': 0.33344193171436093, 'f1-score': 0.23987793056510143, 'support': 219939}, 'weighted avg': {'precision': 0.34133115761086463, 'recall': 0.32368975033986697, 'f1-score': 0.23383728371881282, 'support': 219939}}
[[59795  7125  4338]
 [51075  6198  3436]
 [73588  9185  5199]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058111
{'0': {'precision': 0.3356832665952287, 'recall': 0.8714175908641704, 'f1-score': 0.4846658863046465, 'support': 27321}, '1': {'precision': 0.34357188093730207, 'recall': 0.08047767393561786, 'f1-score': 0.13040865384615383, 'support': 26964}, '2': {'precision': 0.33055618104030626, 'recall': 0.05358446488538473, 'f1-score': 0.09221974432264347, 'support': 27396}, 'accuracy': 0.33601449541509043, 'macro avg': {'precision': 0.33660377619094567, 'recall': 0.3351599098950577, 'f1-score': 0.23576476149114792, 'support': 81681}, 'weighted avg': {'precision': 0.3365677680246555, 'recall': 0.33601449541509043, 'f1-score': 0.23609343344841616, 'support': 81681}}
[[23808  2029  1484]
 [23305  2170  1489]
 [23811  2117  1468]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039351
{'0': {'precision': 0.35279954678500614, 'recall': 0.8549365061205811, 'f1-score': 0.4994820038097784, 'support': 8741}, '1': {'precision': 0.30197780993728895, 'recall': 0.0838243170862346, 'f1-score': 0.13122314222827797, 'support': 7468}, '2': {'precision': 0.34232121922626024, 'recall': 0.06672760511882998, 'f1-score': 0.11168483457640084, 'support': 8752}, 'accuracy': 0.3478626657585834, 'macro avg': {'precision': 0.3323661919828518, 'recall': 0.3351628094418819, 'f1-score': 0.24746332687148576, 'support': 24961}, 'weighted avg': {'precision': 0.33392037313119033, 'recall': 0.3478626657585834, 'f1-score': 0.25333168918211263, 'support': 24961}}
[[7473  694  574]
 [6294  626  548]
 [7415  753  584]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067884
{'0': {'precision': 0.34411973347520963, 'recall': 0.6641119667522308, 'f1-score': 0.4533363371632165, 'support': 163620}, '1': {'precision': 0.29902380751270013, 'recall': 0.16578581176911344, 'f1-score': 0.2133084282695428, 'support': 149476}, '2': {'precision': 0.37659548826049327, 'recall': 0.194397629200647, 'f1-score': 0.2564278547209716, 'support': 176818}, 'accuracy': 0.3425417522259009, 'macro avg': {'precision': 0.33991300974946775, 'recall': 0.3414318025739971, 'f1-score': 0.30769087338457696, 'support': 489914}, 'weighted avg': {'precision': 0.34208170104595104, 'recall': 0.3425417522259009, 'f1-score': 0.3090347337016628, 'support': 489914}}
[[108662  28110  26848]
 [ 94643  24781  30052]
 [112463  29982  34373]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067187
{'0': {'precision': 0.33837272772383675, 'recall': 0.675449457679164, 'f1-score': 0.45087526930303545, 'support': 60573}, '1': {'precision': 0.32393926788685523, 'recall': 0.14695475774873804, 'f1-score': 0.2021873884399442, 'support': 63591}, '2': {'precision': 0.33174274481558175, 'recall': 0.18761350328416979, 'f1-score': 0.2396790980052038, 'support': 58919}, 'accuracy': 0.3348918250192536, 'macro avg': {'precision': 0.33135158014209126, 'recall': 0.3366725729040239, 'f1-score': 0.2975805852493945, 'support': 183083}, 'weighted avg': {'precision': 0.3312258593228112, 'recall': 0.3348918250192536, 'f1-score': 0.2965311835678127, 'support': 183083}}
[[40914  9974  9685]
 [41664  9345 12582]
 [38336  9529 11054]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050212
{'0': {'precision': 0.3601834912486689, 'recall': 0.6841804979253112, 'f1-score': 0.47192458365382894, 'support': 19280}, '1': {'precision': 0.27538531278331824, 'recall': 0.1574956251215244, 'f1-score': 0.2003875809178246, 'support': 15429}, '2': {'precision': 0.38514173998044965, 'recall': 0.17778891952870393, 'f1-score': 0.24327661909989023, 'support': 19945}, 'accuracy': 0.3506971127456362, 'macro avg': {'precision': 0.34023684800414555, 'recall': 0.3398216808585132, 'f1-score': 0.3051962612238479, 'support': 54654}, 'weighted avg': {'precision': 0.34535275928785125, 'recall': 0.3506971127456362, 'f1-score': 0.3118278282792522, 'support': 54654}}
[[13191  3197  2892]
 [10230  2430  2769]
 [13202  3197  3546]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/EXC
Evaluating performance on  test set...
4918/4918 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0912507
{'0': {'precision': 0.3740209698812094, 'recall': 0.6347236663294693, 'f1-score': 0.47068396255149697, 'support': 426061}, '1': {'precision': 0.4164881088063217, 'recall': 0.1397414423853992, 'f1-score': 0.2092684537751282, 'support': 392253}, '2': {'precision': 0.4065172803677506, 'recall': 0.37298874057931536, 'f1-score': 0.3890319365176328, 'support': 440520}, 'accuracy': 0.3888948026507069, 'macro avg': {'precision': 0.39900878635176057, 'recall': 0.38248461643139464, 'f1-score': 0.35632811761475264, 'support': 1258834}, 'weighted avg': {'precision': 0.3986255939542192, 'recall': 0.3888948026507069, 'f1-score': 0.3606532769547504, 'support': 1258834}}
[[270431  37993 117637]
 [215198  54814 122241]
 [237408  38803 164309]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.091367
{'0': {'precision': 0.3718036218036218, 'recall': 0.6711649185632972, 'f1-score': 0.47852171545189165, 'support': 121751}, '1': {'precision': 0.43996703515303076, 'recall': 0.1313971449425424, 'f1-score': 0.2023592458255727, 'support': 117826}, '2': {'precision': 0.38879541586947536, 'recall': 0.33867658266542716, 'f1-score': 0.36200954282184644, 'support': 119403}, 'accuracy': 0.3834085464371274, 'macro avg': {'precision': 0.4001886909420426, 'recall': 0.3804128820570889, 'f1-score': 0.3476301680331036, 'support': 358980}, 'weighted avg': {'precision': 0.3998282848159138, 'recall': 0.3834085464371274, 'f1-score': 0.34912447300179433, 'support': 358980}}
[[81715  9983 30053]
 [68825 15482 33519]
 [69240  9724 40439]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.089353
{'0': {'precision': 0.38011835650328224, 'recall': 0.6424193471753694, 'f1-score': 0.47762617565240434, 'support': 42094}, '1': {'precision': 0.424738012067323, 'recall': 0.14051583757945055, 'f1-score': 0.21117031774225384, 'support': 38074}, '2': {'precision': 0.40537212345108903, 'recall': 0.37136880699445335, 'f1-score': 0.3876261851901824, 'support': 42548}, 'accuracy': 0.3927197757423645, 'macro avg': {'precision': 0.4034094973405647, 'recall': 0.38476799724975774, 'f1-score': 0.3588075595282802, 'support': 122716}, 'weighted avg': {'precision': 0.40271806674514615, 'recall': 0.3927197757423645, 'f1-score': 0.3637505609953287, 'support': 122716}}
[[27042  3569 11483]
 [21029  5350 11695]
 [23070  3677 15801]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/AAL
Evaluating performance on  test set...
4856/4856 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0948519
{'0': {'precision': 0.38216561334103155, 'recall': 0.6641253143882982, 'f1-score': 0.4851535101414312, 'support': 444514}, '1': {'precision': 0.3189723422756947, 'recall': 0.13640538927971804, 'f1-score': 0.1910921132175965, 'support': 360345}, '2': {'precision': 0.39268101464302874, 'recall': 0.28357162913973805, 'f1-score': 0.32932424317542214, 'support': 438041}, 'accuracy': 0.377006999758629, 'macro avg': {'precision': 0.36460632341991833, 'recall': 0.36136744426925144, 'f1-score': 0.3351899555114833, 'support': 1242900}, 'weighted avg': {'precision': 0.3675504372526008, 'recall': 0.377006999758629, 'f1-score': 0.3449787881158645, 'support': 1242900}}
[[295213  52341  96960]
 [216040  49153  95152]
 [261221  52604 124216]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972254
{'0': {'precision': 0.35610609741987737, 'recall': 0.6935005971023637, 'f1-score': 0.47057586900184234, 'support': 177524}, '1': {'precision': 0.3867977873386601, 'recall': 0.08966000661066596, 'f1-score': 0.145575505785361, 'support': 175474}, '2': {'precision': 0.38229838292590423, 'recall': 0.31073582494451046, 'f1-score': 0.3428223370343231, 'support': 178412}, 'accuracy': 0.365602830206432, 'macro avg': {'precision': 0.3750674225614805, 'recall': 0.3646321428858467, 'f1-score': 0.3196579039405088, 'support': 531410}, 'weighted avg': {'precision': 0.3750342539064127, 'recall': 0.365602830206432, 'f1-score': 0.32036816331237866, 'support': 531410}}
[[123113  12151  42260]
 [112425  15733  47316]
 [110182  12791  55439]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011357
{'0': {'precision': 0.3404958850097529, 'recall': 0.6797367927867897, 'f1-score': 0.4537152864648487, 'support': 48023}, '1': {'precision': 0.40835546969331077, 'recall': 0.09248860528714677, 'f1-score': 0.150818307493348, 'support': 54850}, '2': {'precision': 0.35815602836879434, 'recall': 0.3172418154605055, 'f1-score': 0.336459672461014, 'support': 47437}, 'accuracy': 0.35104118155811326, 'macro avg': {'precision': 0.3690024610239527, 'recall': 0.363155737844814, 'f1-score': 0.3136644221397369, 'support': 150310}, 'weighted avg': {'precision': 0.3708321396861949, 'recall': 0.35104118155811326, 'f1-score': 0.3061791687209413, 'support': 150310}}
[[32643  3640 11740]
 [34548  5073 15229]
 [28678  3710 15049]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/WBA
Evaluating performance on  test set...
4353/4353 - 52s - 52s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0832243
{'0': {'precision': 0.43093175181470805, 'recall': 0.6613150411551636, 'f1-score': 0.5218264791815622, 'support': 446967}, '1': {'precision': 0.32706275800804724, 'recall': 0.13298347002082184, 'f1-score': 0.1890850867785448, 'support': 282396}, '2': {'precision': 0.39353443601732485, 'recall': 0.32055492050296164, 'f1-score': 0.35331544631173234, 'support': 384920}, 'accuracy': 0.4097056133854685, 'macro avg': {'precision': 0.38384298194669336, 'recall': 0.37161781055964904, 'f1-score': 0.35474233742394645, 'support': 1114283}, 'weighted avg': {'precision': 0.3916893303008246, 'recall': 0.4097056133854685, 'f1-score': 0.3792880890048321, 'support': 1114283}}
[[295586  40238 111143]
 [165835  37554  79007]
 [224502  37030 123388]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953311
{'0': {'precision': 0.3794283868884224, 'recall': 0.6635369529766401, 'f1-score': 0.4827864284375136, 'support': 141653}, '1': {'precision': 0.31980650362805696, 'recall': 0.11862928348909657, 'f1-score': 0.1730625897580396, 'support': 120375}, '2': {'precision': 0.379900185928173, 'recall': 0.2929210617652829, 'f1-score': 0.33078850053680064, 'support': 132534}, 'accuracy': 0.3728032603241062, 'macro avg': {'precision': 0.35971169214821747, 'recall': 0.3583624327436732, 'f1-score': 0.3288791729107846, 'support': 394562}, 'weighted avg': {'precision': 0.3613971147853507, 'recall': 0.3728032603241062, 'f1-score': 0.337237945670712, 'support': 394562}}
[[93992 15326 32335]
 [75062 14280 31033]
 [78666 15046 38822]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0911239
{'0': {'precision': 0.38594154263903474, 'recall': 0.6717046746472279, 'f1-score': 0.4902182489648833, 'support': 44859}, '1': {'precision': 0.32429002062509915, 'recall': 0.12033085096988785, 'f1-score': 0.17552974516412975, 'support': 33973}, '2': {'precision': 0.41245517790922187, 'recall': 0.3025833576904917, 'f1-score': 0.3490778927709906, 'support': 44477}, 'accuracy': 0.3866546642986319, 'macro avg': {'precision': 0.3742289137244519, 'recall': 0.36487296110253586, 'f1-score': 0.3382752956333346, 'support': 123309}, 'weighted avg': {'precision': 0.378519211734824, 'recall': 0.3866546642986319, 'f1-score': 0.3526093788738213, 'support': 123309}}
[[30132  4115 10612]
 [21326  4088  8559]
 [26616  4403 13458]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
5497/5497 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029019
{'0': {'precision': 0.34842709577781483, 'recall': 0.6399983617476703, 'f1-score': 0.4512080679195792, 'support': 463909}, '1': {'precision': 0.3055077730234158, 'recall': 0.12938203590087988, 'f1-score': 0.18178038135721972, 'support': 439265}, '2': {'precision': 0.3947107438016529, 'recall': 0.28901119395581937, 'f1-score': 0.3336906921765902, 'support': 504022}, 'accuracy': 0.35489157160765095, 'macro avg': {'precision': 0.34954853753429455, 'recall': 0.3527971972014565, 'f1-score': 0.322226380484463, 'support': 1407196}, 'weighted avg': {'precision': 0.35160719331544277, 'recall': 0.35489157160765095, 'f1-score': 0.32501278631378466, 'support': 1407196}}
[[296901  61682 105326]
 [264376  56833 118056]
 [290841  67513 145668]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015742
{'0': {'precision': 0.35150883986843273, 'recall': 0.6535257811568446, 'f1-score': 0.4571386584159793, 'support': 176117}, '1': {'precision': 0.3365664111330331, 'recall': 0.12448749944293418, 'f1-score': 0.18175015961188892, 'support': 179512}, '2': {'precision': 0.36360628618693136, 'recall': 0.282461520488332, 'f1-score': 0.3179380968818317, 'support': 171195}, 'accuracy': 0.35267945272045315, 'macro avg': {'precision': 0.3505605123961324, 'recall': 0.35349160036270355, 'f1-score': 0.3189423049699, 'support': 526824}, 'weighted avg': {'precision': 0.35034844674918664, 'recall': 0.35267945272045315, 'f1-score': 0.3180675828211729, 'support': 526824}}
[[115097  22546  38474]
 [111005  22347  46160]
 [101335  21504  48356]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034393
{'0': {'precision': 0.346312221630858, 'recall': 0.6481484717683449, 'f1-score': 0.4514240506329114, 'support': 57223}, '1': {'precision': 0.33536040825005314, 'recall': 0.12960376025112166, 'f1-score': 0.1869562125127427, 'support': 60847}, '2': {'precision': 0.3614576418614233, 'recall': 0.28083373348272245, 'f1-score': 0.3160855118299372, 'support': 56229}, 'accuracy': 0.34863080109467065, 'macro avg': {'precision': 0.3477100905807782, 'recall': 0.35286198850072964, 'f1-score': 0.31815525832519714, 'support': 174299}, 'weighted avg': {'precision': 0.34737491760365546, 'recall': 0.34863080109467065, 'f1-score': 0.31543918987954883, 'support': 174299}}
[[37089  7828 12306]
 [37371  7886 15590]
 [32637  7801 15791]]
testing model on single stock: results/universal/W2/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
14883/14883 - 176s - 176s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095058
{'0': {'precision': 0.31502283095076805, 'recall': 0.7469716898624779, 'f1-score': 0.44315320233547084, 'support': 1161704}, '1': {'precision': 0.37495123470102326, 'recall': 0.10634500428159273, 'f1-score': 0.16569500208003504, 'support': 1455066}, '2': {'precision': 0.34043251806308344, 'recall': 0.1833547896111385, 'f1-score': 0.23834076088407194, 'support': 1193124}, 'accuracy': 0.3258001403713594, 'macro avg': {'precision': 0.3434688612382916, 'recall': 0.34555716125173636, 'f1-score': 0.28239632176652596, 'support': 3809894}, 'weighted avg': {'precision': 0.3458679647674735, 'recall': 0.3258001403713594, 'f1-score': 0.2730469912421609, 'support': 3809894}}
[[ 867760  129338  164606]
 [1041089  154739  259238]
 [ 845745  128614  218765]]
Evaluating performance on  train set...
6147/6147 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047355
{'0': {'precision': 0.3398991722618596, 'recall': 0.7161820930882056, 'f1-score': 0.4610056226094611, 'support': 519185}, '1': {'precision': 0.33218174309801274, 'recall': 0.12699806306774641, 'f1-score': 0.18374692176548588, 'support': 519378}, '2': {'precision': 0.3653104223908432, 'recall': 0.19188289837732744, 'f1-score': 0.25160683031577713, 'support': 534920}, 'accuracy': 0.343462878213492, 'macro avg': {'precision': 0.3457971125835719, 'recall': 0.3450210181777598, 'f1-score': 0.29878645823024136, 'support': 1573483}, 'weighted avg': {'precision': 0.34599057775828723, 'recall': 0.343462878213492, 'f1-score': 0.2983005463546305, 'support': 1573483}}
[[371831  65881  81473]
 [356561  65960  96857]
 [365553  66725 102642]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1031442
{'0': {'precision': 0.34322172052997146, 'recall': 0.7536774277531892, 'f1-score': 0.4716540511184278, 'support': 184368}, '1': {'precision': 0.33036730277762233, 'recall': 0.09783016991846565, 'f1-score': 0.15095787073539751, 'support': 181028}, '2': {'precision': 0.3689567949084085, 'recall': 0.18928663000308726, 'f1-score': 0.2502083686378397, 'support': 191107}, 'accuracy': 0.3465174491422328, 'macro avg': {'precision': 0.34751527273866745, 'recall': 0.34693140922491406, 'f1-score': 0.290940096830555, 'support': 556503}, 'weighted avg': {'precision': 0.3478778379675553, 'recall': 0.3465174491422328, 'f1-score': 0.29128699436545974, 'support': 556503}}
[[138954  18138  27276]
 [128724  17710  34594]
 [137174  17759  36174]]
training model: results/universal/W2/deepOF_L2/h1000
Epoch 1/50
9940/9940 - 281s - loss: 3.2637 - accuracy1000: 0.3808 - val_loss: 3.3109 - val_accuracy1000: 0.3408 - 281s/epoch - 28ms/step
Epoch 2/50
9940/9940 - 274s - loss: 3.2482 - accuracy1000: 0.3896 - val_loss: 3.3255 - val_accuracy1000: 0.3288 - 274s/epoch - 28ms/step
Epoch 3/50
9940/9940 - 275s - loss: 3.2426 - accuracy1000: 0.3932 - val_loss: 3.3251 - val_accuracy1000: 0.3285 - 275s/epoch - 28ms/step
Epoch 4/50
9940/9940 - 273s - loss: 3.2416 - accuracy1000: 0.3937 - val_loss: 3.3281 - val_accuracy1000: 0.3279 - 273s/epoch - 27ms/step
Epoch 5/50
9940/9940 - 272s - loss: 3.2399 - accuracy1000: 0.3949 - val_loss: 3.3268 - val_accuracy1000: 0.3300 - 272s/epoch - 27ms/step
Epoch 6/50
9940/9940 - 272s - loss: 3.2383 - accuracy1000: 0.3953 - val_loss: 3.3354 - val_accuracy1000: 0.3301 - 272s/epoch - 27ms/step
Epoch 7/50
9940/9940 - 272s - loss: 3.2372 - accuracy1000: 0.3962 - val_loss: 3.3411 - val_accuracy1000: 0.3306 - 272s/epoch - 27ms/step
Epoch 8/50
9940/9940 - 273s - loss: 3.2356 - accuracy1000: 0.3969 - val_loss: 3.3447 - val_accuracy1000: 0.3332 - 273s/epoch - 28ms/step
Epoch 9/50
9940/9940 - 273s - loss: 3.2341 - accuracy1000: 0.3979 - val_loss: 3.3427 - val_accuracy1000: 0.3319 - 273s/epoch - 27ms/step
Epoch 10/50
9940/9940 - 272s - loss: 3.2326 - accuracy1000: 0.3994 - val_loss: 3.3314 - val_accuracy1000: 0.3364 - 272s/epoch - 27ms/step
Epoch 11/50
9940/9940 - 271s - loss: 3.2313 - accuracy1000: 0.4000 - val_loss: 3.3383 - val_accuracy1000: 0.3341 - 271s/epoch - 27ms/step
testing model in sample: results/universal/W2/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 308s - 308s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009848
{'0': {'precision': 0.3335297660502576, 'recall': 0.0953601009995521, 'f1-score': 0.14831514857503397, 'support': 2154465}, '1': {'precision': 0.3568303375920861, 'recall': 0.9193667624197364, 'f1-score': 0.5141180029356573, 'support': 2367200}, '2': {'precision': 0.3784588441330998, 'recall': 0.000982684114577057, 'f1-score': 0.0019602782851329535, 'support': 2199079}, 'accuracy': 0.3547131091438686, 'macro avg': {'precision': 0.3562729825918145, 'recall': 0.3385698491779552, 'f1-score': 0.2214644765986081, 'support': 6720744}, 'weighted avg': {'precision': 0.3564379001876619, 'recall': 0.3547131091438686, 'f1-score': 0.22927085750253107, 'support': 6720744}}
[[ 205450 1947158    1857]
 [ 189183 2176325    1692]
 [ 221354 1975564    2161]]
Evaluating performance on  train set...
9940/9940 - 127s - 127s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038321
{'0': {'precision': 0.3623119971373025, 'recall': 0.11600216382723398, 'f1-score': 0.17573795249440602, 'support': 846648}, '1': {'precision': 0.33903338910448744, 'recall': 0.9109324922539955, 'f1-score': 0.494151935985038, 'support': 844629}, '2': {'precision': 0.3656834760545512, 'recall': 0.0013527433823512158, 'f1-score': 0.00269551546180866, 'support': 852342}, 'accuracy': 0.3415472207119069, 'macro avg': {'precision': 0.3556762874321137, 'recall': 0.3427624664878603, 'f1-score': 0.2241951346470842, 'support': 2543619}, 'weighted avg': {'precision': 0.35571189926853247, 'recall': 0.3415472207119069, 'f1-score': 0.22348501980144803, 'support': 2543619}}
[[ 98213 747334   1101]
 [ 74330 769400    899]
 [ 98530 752659   1153]]
Evaluating performance on  val set...
3393/3393 - 42s - 42s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040863
{'0': {'precision': 0.37435779022109333, 'recall': 0.13407116694634053, 'f1-score': 0.19743401740930644, 'support': 290219}, '1': {'precision': 0.3362937292994006, 'recall': 0.9033231352032643, 'f1-score': 0.49012225405921683, 'support': 284039}, '2': {'precision': 0.34290540540540543, 'recall': 0.0013817748659916617, 'f1-score': 0.00275245839957425, 'support': 293825}, 'accuracy': 0.34086026336191355, 'macro avg': {'precision': 0.3511856416419665, 'recall': 0.3462586923385322, 'f1-score': 0.23010290995603253, 'support': 868083}, 'weighted avg': {'precision': 0.35125726323392026, 'recall': 0.34086026336191355, 'f1-score': 0.22730738778261103, 'support': 868083}}
[[ 38910 250897    412]
 [ 27094 256579    366]
 [ 37934 255485    406]]
testing model out of sample: results/universal/W2/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 172s - 172s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074572
{'0': {'precision': 0.35093986457141807, 'recall': 0.09628387733421945, 'f1-score': 0.15110937862154702, 'support': 1191726}, '1': {'precision': 0.33169890053608836, 'recall': 0.9250568030245886, 'f1-score': 0.4883054417454975, 'support': 1195799}, '2': {'precision': 0.390470297029703, 'recall': 0.0014798508110254749, 'f1-score': 0.0029485269436641324, 'support': 1279183}, 'accuracy': 0.3334923315409899, 'macro avg': {'precision': 0.3577030207124032, 'recall': 0.34094017705661117, 'f1-score': 0.2141211157702362, 'support': 3666708}, 'weighted avg': {'precision': 0.35845568847416764, 'recall': 0.3334923315409899, 'f1-score': 0.20938886865884684, 'support': 3666708}}
[[ 114744 1075300    1682]
 [  88344 1106182    1273]
 [ 123874 1153416    1893]]
Evaluating performance on  train set...
5373/5373 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054592
{'0': {'precision': 0.37357158614604014, 'recall': 0.07276852570038739, 'f1-score': 0.12180959248742539, 'support': 465421}, '1': {'precision': 0.3353040501036029, 'recall': 0.9430121789460991, 'f1-score': 0.49470670200707684, 'support': 456115}, '2': {'precision': 0.355463347164592, 'recall': 0.0011337768444828742, 'f1-score': 0.0022603441527887106, 'support': 453352}, 'accuracy': 0.33784861021406837, 'macro avg': {'precision': 0.3547796611380784, 'recall': 0.33897149383032305, 'f1-score': 0.20625887954909697, 'support': 1374888}, 'weighted avg': {'precision': 0.35490548129916266, 'recall': 0.33784861021406837, 'f1-score': 0.20609723939215627, 'support': 1374888}}
[[ 33868 431014    539]
 [ 25600 430122    393]
 [ 31192 421646    514]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038398
{'0': {'precision': 0.37091183119819143, 'recall': 0.08621354053542778, 'f1-score': 0.13990744846562292, 'support': 142727}, '1': {'precision': 0.3420540878221792, 'recall': 0.9359921696214398, 'f1-score': 0.501014647824964, 'support': 145076}, '2': {'precision': 0.3784313725490196, 'recall': 0.0013509162431929221, 'f1-score': 0.0026922218502399287, 'support': 142866}, 'accuracy': 0.3443201159126847, 'macro avg': {'precision': 0.3637990971897967, 'recall': 0.34118554213335345, 'f1-score': 0.21453810604694223, 'support': 430669}, 'weighted avg': {'precision': 0.36368521590108177, 'recall': 0.3443201159126847, 'f1-score': 0.21603226239145099, 'support': 430669}}
[[ 12305 130232    190]
 [  9159 135790    127]
 [ 11711 130962    193]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007543
{'0': {'precision': 0.32590582633957393, 'recall': 0.4011198430729884, 'f1-score': 0.35962222358264284, 'support': 80547}, '1': {'precision': 0.35846712161255967, 'recall': 0.6180150975902795, 'f1-score': 0.45374731621257264, 'support': 88226}, '2': {'precision': 0.33253205128205127, 'recall': 0.004957177156372063, 'f1-score': 0.009768728299888188, 'support': 83717}, 'accuracy': 0.3455542793774011, 'macro avg': {'precision': 0.3389683330780617, 'recall': 0.34136403927321335, 'f1-score': 0.27437942269836785, 'support': 252490}, 'weighted avg': {'precision': 0.3394805441908307, 'recall': 0.3455542793774011, 'f1-score': 0.27651237906516424, 'support': 252490}}
[[32309 47841   397]
 [33265 54525   436]
 [33562 49740   415]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049339
{'0': {'precision': 0.3467695354402178, 'recall': 0.40174943836336696, 'f1-score': 0.3722403064726854, 'support': 20921}, '1': {'precision': 0.31851831236780587, 'recall': 0.5909536841018227, 'f1-score': 0.41393153583247444, 'support': 19367}, '2': {'precision': 0.33695652173913043, 'recall': 0.0061234567901234565, 'f1-score': 0.01202832476476865, 'support': 20250}, 'accuracy': 0.32994152433182466, 'macro avg': {'precision': 0.334081456515718, 'recall': 0.33294219308510437, 'f1-score': 0.2660667223566428, 'support': 60538}, 'weighted avg': {'precision': 0.33444909266559, 'recall': 0.32994152433182466, 'f1-score': 0.26508680634756926, 'support': 60538}}
[[ 8405 12403   113]
 [ 7791 11445   131]
 [ 8042 12084   124]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976005
{'0': {'precision': 0.34888283378746593, 'recall': 0.42013387583672396, 'f1-score': 0.38120757413361916, 'support': 7619}, '1': {'precision': 0.35375365615859605, 'recall': 0.5890151515151515, 'f1-score': 0.44203045685279196, 'support': 7392}, '2': {'precision': 0.2807017543859649, 'recall': 0.004858791375645309, 'f1-score': 0.00955223880597015, 'support': 6586}, 'accuracy': 0.35129879149881926, 'macro avg': {'precision': 0.3277794147773423, 'recall': 0.33800260624250694, 'f1-score': 0.2775967565974604, 'support': 21597}, 'weighted avg': {'precision': 0.329758165084827, 'recall': 0.35129879149881926, 'f1-score': 0.28868920170190315, 'support': 21597}}
[[3201 4379   39]
 [2995 4354   43]
 [2979 3575   32]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962352
{'0': {'precision': 0.29525215912650465, 'recall': 0.07477249804512641, 'f1-score': 0.11932578579954424, 'support': 88241}, '1': {'precision': 0.39384375740747013, 'recall': 0.9361321946861342, 'f1-score': 0.5544308081734998, 'support': 124241}, '2': {'precision': 0.35036496350364965, 'recall': 0.00045578851412944393, 'f1-score': 0.0009103927016851748, 'support': 105312}, 'accuracy': 0.38689213767409075, 'macro avg': {'precision': 0.3464869600125415, 'recall': 0.33712016041513, 'f1-score': 0.22488899555824304, 'support': 317794}, 'weighted avg': {'precision': 0.35205989752493677, 'recall': 0.38689213767409075, 'f1-score': 0.2501882980145038, 'support': 317794}}
[[  6598  81595     48]
 [  7894 116306     41]
 [  7855  97409     48]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043108
{'0': {'precision': 0.3804127883447997, 'recall': 0.06053450681549855, 'f1-score': 0.1044483129004778, 'support': 46585}, '1': {'precision': 0.3330901274085232, 'recall': 0.9518653035602188, 'f1-score': 0.49349094544017474, 'support': 44604}, '2': {'precision': 0.5, 'recall': 0.00041167322294392096, 'f1-score': 0.0008226691042047533, 'support': 43724}, 'accuracy': 0.3357348809973835, 'macro avg': {'precision': 0.4045009719177743, 'recall': 0.3376038278662205, 'f1-score': 0.19958730914828574, 'support': 134913}, 'weighted avg': {'precision': 0.4035243585716148, 'recall': 0.3357348809973835, 'f1-score': 0.199486818696453, 'support': 134913}}
[[ 2820 43754    11]
 [ 2140 42457     7]
 [ 2453 41253    18]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0867779
{'0': {'precision': 0.4022268615170494, 'recall': 0.08076009501187649, 'f1-score': 0.1345124505468932, 'support': 14314}, '1': {'precision': 0.3890406598944381, 'recall': 0.931183341797867, 'f1-score': 0.5487980544383126, 'support': 15752}, '2': {'precision': 0.23529411764705882, 'recall': 0.00037993920972644377, 'f1-score': 0.0007586533902323376, 'support': 10528}, 'accuracy': 0.3899098388924472, 'macro avg': {'precision': 0.34218721301951543, 'recall': 0.3374411253398233, 'f1-score': 0.2280230527918127, 'support': 40594}, 'weighted avg': {'precision': 0.3538163334729386, 'recall': 0.3899098388924472, 'f1-score': 0.26058198929725807, 'support': 40594}}
[[ 1156 13150     8]
 [ 1079 14668     5]
 [  639  9885     4]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1161115
{'0': {'precision': 0.3440864693754295, 'recall': 0.19848153576319646, 'f1-score': 0.25174654690345044, 'support': 83242}, '1': {'precision': 0.3042602289873081, 'recall': 0.8545574653188917, 'f1-score': 0.448746772435866, 'support': 80231}, '2': {'precision': 0.4406580493537015, 'recall': 0.003386463177857046, 'f1-score': 0.006721273278009785, 'support': 110735}, 'accuracy': 0.31165757381258025, 'macro avg': {'precision': 0.3630015825721464, 'recall': 0.3521418214199817, 'f1-score': 0.23573819753910874, 'support': 274208}, 'weighted avg': {'precision': 0.3714326985748496, 'recall': 0.31165757381258025, 'f1-score': 0.21043721756141107, 'support': 274208}}
[[16522 66459   261]
 [11454 68562   215]
 [20041 90319   375]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098095
{'0': {'precision': 0.3814395654142146, 'recall': 0.17333168764914014, 'f1-score': 0.23835252185228145, 'support': 24306}, '1': {'precision': 0.3593363411439383, 'recall': 0.8741885990794288, 'f1-score': 0.5093171972770405, 'support': 25419}, '2': {'precision': 0.3959731543624161, 'recall': 0.0025313197185515704, 'f1-score': 0.005030481306219891, 'support': 23308}, 'accuracy': 0.36275382361398273, 'macro avg': {'precision': 0.37891635364018966, 'recall': 0.35001720214904014, 'f1-score': 0.2509000668118473, 'support': 73033}, 'weighted avg': {'precision': 0.3783848782656452, 'recall': 0.36275382361398273, 'f1-score': 0.25819808431821256, 'support': 73033}}
[[ 4213 20044    49]
 [ 3157 22221    41]
 [ 3675 19574    59]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1128086
{'0': {'precision': 0.38519785051294575, 'recall': 0.1588436744560838, 'f1-score': 0.2249322493224932, 'support': 9928}, '1': {'precision': 0.30483054148811844, 'recall': 0.8834819916450265, 'f1-score': 0.4532684565702204, 'support': 8857}, '2': {'precision': 0.4444444444444444, 'recall': 0.00181422351233672, 'f1-score': 0.003613695907489385, 'support': 11024}, 'accuracy': 0.31607903653259084, 'macro avg': {'precision': 0.37815761214850285, 'recall': 0.3480466298711489, 'f1-score': 0.22727146726673433, 'support': 29809}, 'weighted avg': {'precision': 0.38322935762381644, 'recall': 0.31607903653259084, 'f1-score': 0.21092835971687468, 'support': 29809}}
[[1577 8335   16]
 [1023 7825    9]
 [1494 9510   20]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1142563
{'0': {'precision': 0.3196513277924184, 'recall': 0.5774701530799092, 'f1-score': 0.4115141708857456, 'support': 68265}, '1': {'precision': 0.28043604804995503, 'recall': 0.4389609529016119, 'f1-score': 0.34223238272370327, 'support': 60363}, '2': {'precision': 0.411930483795209, 'recall': 0.00960453833601647, 'f1-score': 0.018771404109589038, 'support': 91311}, 'accuracy': 0.3036978434929685, 'macro avg': {'precision': 0.3373392865458609, 'recall': 0.3420118814391792, 'f1-score': 0.25750598590634594, 'support': 219939}, 'weighted avg': {'precision': 0.3471996483843848, 'recall': 0.3036978434929685, 'f1-score': 0.22944645503761044, 'support': 219939}}
[[39421 28088   756]
 [33370 26497   496]
 [50534 39900   877]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100968
{'0': {'precision': 0.34140770697567213, 'recall': 0.5858894602466828, 'f1-score': 0.43141979558332894, 'support': 27809}, '1': {'precision': 0.33808823087780415, 'recall': 0.4173958178852143, 'f1-score': 0.3735793333443945, 'support': 26972}, '2': {'precision': 0.3262518968133536, 'recall': 0.007992565055762083, 'f1-score': 0.015602888348633841, 'support': 26900}, 'accuracy': 0.339932175169256, 'macro avg': {'precision': 0.3352492782222766, 'recall': 0.3370926143958864, 'f1-score': 0.2735340057587858, 'support': 81681}, 'weighted avg': {'precision': 0.33532031575031906, 'recall': 0.339932175169256, 'f1-score': 0.2753792506325835, 'support': 81681}}
[[16293 11282   234]
 [15504 11258   210]
 [15926 10759   215]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042804
{'0': {'precision': 0.3531869020347662, 'recall': 0.5851752623353427, 'f1-score': 0.4405042016806723, 'support': 8958}, '1': {'precision': 0.2957446808510638, 'recall': 0.38878529568460307, 'f1-score': 0.33594199562665433, 'support': 7508}, '2': {'precision': 0.42168674698795183, 'recall': 0.012360211889346674, 'f1-score': 0.02401646843549863, 'support': 8495}, 'accuracy': 0.3311566043027122, 'macro avg': {'precision': 0.3568727766245939, 'recall': 0.32877358996976414, 'f1-score': 0.2668208885809418, 'support': 24961}, 'weighted avg': {'precision': 0.3592215154809452, 'recall': 0.3311566043027122, 'f1-score': 0.2673093642554362, 'support': 24961}}
[[5242 3634   82]
 [4527 2919   62]
 [5073 3317  105]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079754
{'0': {'precision': 0.350597201974475, 'recall': 0.16921785502666403, 'f1-score': 0.22826313204059712, 'support': 162016}, '1': {'precision': 0.3225598262080924, 'recall': 0.8588223088245783, 'f1-score': 0.46897877742230754, 'support': 154217}, '2': {'precision': 0.35765765765765767, 'recall': 0.0022857998284210707, 'f1-score': 0.0045425679811889625, 'support': 173681}, 'accuracy': 0.32711455479941376, 'macro avg': {'precision': 0.343604895280075, 'recall': 0.34344198789322117, 'f1-score': 0.23392815914803122, 'support': 489914}, 'weighted avg': {'precision': 0.34427451477824594, 'recall': 0.32711455479941376, 'f1-score': 0.22472461996996668, 'support': 489914}}
[[ 27416 134217    383]
 [ 21442 132445    330]
 [ 29340 143944    397]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980173
{'0': {'precision': 0.3824312333629104, 'recall': 0.15871465624899933, 'f1-score': 0.22432930899874406, 'support': 62458}, '1': {'precision': 0.3520270485789927, 'recall': 0.8838311844318091, 'f1-score': 0.5035083717322871, 'support': 62435}, '2': {'precision': 0.36117936117936117, 'recall': 0.0025262072521051726, 'f1-score': 0.00501732170588938, 'support': 58190}, 'accuracy': 0.35635203705423224, 'macro avg': {'precision': 0.36521254770708805, 'recall': 0.3483573493109711, 'f1-score': 0.24428500081230686, 'support': 183083}, 'weighted avg': {'precision': 0.3653082251134026, 'recall': 0.35635203705423224, 'f1-score': 0.24983020335374997, 'support': 183083}}
[[ 9913 52384   161]
 [ 7154 55182    99]
 [ 8854 49189   147]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1092198
{'0': {'precision': 0.37103658536585366, 'recall': 0.1959111397295557, 'f1-score': 0.25642646439106614, 'support': 18636}, '1': {'precision': 0.3115958256819098, 'recall': 0.8400652055786995, 'f1-score': 0.45457961023898585, 'support': 16563}, '2': {'precision': 0.39375, 'recall': 0.003238242097147263, 'f1-score': 0.006423655365791487, 'support': 19455}, 'accuracy': 0.3225381490833242, 'macro avg': {'precision': 0.35879413701592117, 'recall': 0.34640486246846747, 'f1-score': 0.2391432433319478, 'support': 54654}, 'weighted avg': {'precision': 0.3611081662027943, 'recall': 0.3225381490833242, 'f1-score': 0.22748450049258437, 'support': 54654}}
[[ 3651 14934    51]
 [ 2603 13914    46]
 [ 3586 15806    63]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
4918/4918 - 60s - 60s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1103541
{'0': {'precision': 0.38194032799841926, 'recall': 0.009337216997309451, 'f1-score': 0.018228798294999102, 'support': 414042}, '1': {'precision': 0.3277099517275019, 'recall': 0.9938449131875285, 'f1-score': 0.49289345024090053, 'support': 411692}, '2': {'precision': 0.4514285714285714, 'recall': 0.00018240591087508658, 'f1-score': 0.00036466447406381626, 'support': 433100}, 'accuracy': 0.3281632049976407, 'macro avg': {'precision': 0.38702628371816417, 'recall': 0.3344548453652377, 'f1-score': 0.1704956376699878, 'support': 1258834}, 'weighted avg': {'precision': 0.38811202828763325, 'recall': 0.3281632049976407, 'f1-score': 0.16731810119837237, 'support': 1258834}}
[[  3866 410115     61]
 [  2499 409158     35]
 [  3757 429264     79]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057739
{'0': {'precision': 0.3700433188937021, 'recall': 0.018469700875668394, 'f1-score': 0.03518332237649799, 'support': 120251}, '1': {'precision': 0.33690718377940354, 'recall': 0.9853979514038519, 'f1-score': 0.5021347038230414, 'support': 120668}, '2': {'precision': 0.3181818181818182, 'recall': 0.00011858276653594328, 'f1-score': 0.00023707717708818424, 'support': 118061}, 'accuracy': 0.33745891135996436, 'macro avg': {'precision': 0.341710773618308, 'recall': 0.3346620783486854, 'f1-score': 0.17918503445887587, 'support': 358980}, 'weighted avg': {'precision': 0.34184873482908035, 'recall': 0.33745891135996436, 'f1-score': 0.180651873944563, 'support': 358980}}
[[  2221 118011     19]
 [  1751 118906     11]
 [  2030 116017     14]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1190231
{'0': {'precision': 0.35340314136125656, 'recall': 0.009389344832382808, 'f1-score': 0.01829268292682927, 'support': 43134}, '1': {'precision': 0.2947515630141494, 'recall': 0.9906547224065472, 'f1-score': 0.45432643538243056, 'support': 36168}, '2': {'precision': 0.1, 'recall': 2.3034044317501268e-05, 'f1-score': 4.605747973470892e-05, 'support': 43414}, 'accuracy': 0.29528341862511814, 'macro avg': {'precision': 0.24938490145846862, 'recall': 0.33335570042774915, 'f1-score': 0.1575550585963315, 'support': 122716}, 'weighted avg': {'precision': 0.24646880301323543, 'recall': 0.29528341862511814, 'f1-score': 0.14034938100738947, 'support': 122716}}
[[  405 42723     6]
 [  335 35830     3]
 [  406 43007     1]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
4856/4856 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010585
{'0': {'precision': 0.3774895312021244, 'recall': 0.053855045996328066, 'f1-score': 0.0942620686137406, 'support': 411772}, '1': {'precision': 0.3487339493579743, 'recall': 0.9690306218297953, 'f1-score': 0.5128896059102892, 'support': 425840}, '2': {'precision': 0.4216589861751152, 'recall': 0.0009030615266181086, 'f1-score': 0.0018022631698165236, 'support': 405288}, 'accuracy': 0.35014401802236705, 'macro avg': {'precision': 0.382627488911738, 'recall': 0.34126290978424717, 'f1-score': 0.20298464589794882, 'support': 1242900}, 'weighted avg': {'precision': 0.38204023769064366, 'recall': 0.35014401802236705, 'f1-score': 0.2075418987316947, 'support': 1242900}}
[[ 22176 389271    325]
 [ 13011 412652    177]
 [ 23559 381363    366]]
Evaluating performance on  train set...
2076/2076 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1083522
{'0': {'precision': 0.3605147633652054, 'recall': 0.03404431723965609, 'f1-score': 0.0622136434156795, 'support': 176094}, '1': {'precision': 0.33177844378879934, 'recall': 0.9730712665169359, 'f1-score': 0.4948371723590151, 'support': 175426}, '2': {'precision': 0.3890909090909091, 'recall': 0.0005948079381844461, 'f1-score': 0.0011878000721560792, 'support': 179890}, 'accuracy': 0.3327073257936433, 'macro avg': {'precision': 0.3604613720816379, 'recall': 0.33590346389825876, 'f1-score': 0.1860795386156169, 'support': 531410}, 'weighted avg': {'precision': 0.3607019357115787, 'recall': 0.3327073257936433, 'f1-score': 0.18437069019565572, 'support': 531410}}
[[  5995 170004     95]
 [  4651 170702     73]
 [  5983 173800    107]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0963476
{'0': {'precision': 0.3618469015795869, 'recall': 0.03156466622856295, 'f1-score': 0.058064264545312744, 'support': 47173}, '1': {'precision': 0.37296846023827607, 'recall': 0.9776147513049094, 'f1-score': 0.5399437300628084, 'support': 55751}, '2': {'precision': 0.3225806451612903, 'recall': 0.00042206558899252945, 'f1-score': 0.0008430281571404484, 'support': 47386}, 'accuracy': 0.3726432040449737, 'macro avg': {'precision': 0.35246533565971777, 'recall': 0.3365338277074883, 'f1-score': 0.19961700758842052, 'support': 150310}, 'weighted avg': {'precision': 0.35359307409068513, 'recall': 0.3726432040449737, 'f1-score': 0.21875734268100544, 'support': 150310}}
[[ 1489 45664    20]
 [ 1226 54503    22]
 [ 1400 45966    20]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
4353/4353 - 56s - 56s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987589
{'0': {'precision': 0.39023995561514635, 'recall': 0.04292350761923409, 'f1-score': 0.07734016891961544, 'support': 393281}, '1': {'precision': 0.35015215232236674, 'recall': 0.9701904806283427, 'f1-score': 0.5145850425135333, 'support': 386286}, '2': {'precision': 0.34217877094972066, 'recall': 0.0007319638140991169, 'f1-score': 0.0014608027856614755, 'support': 334716}, 'accuracy': 0.3517032926105846, 'macro avg': {'precision': 0.3608569596290779, 'recall': 0.3379486506872253, 'f1-score': 0.19779533807293678, 'support': 1114283}, 'weighted avg': {'precision': 0.3619058567648298, 'recall': 0.3517032926105846, 'f1-score': 0.20612570663867572, 'support': 1114283}}
[[ 16881 376134    266]
 [ 11310 374771    205]
 [ 15067 319404    245]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103477
{'0': {'precision': 0.38380722891566266, 'recall': 0.05818702554997845, 'f1-score': 0.10105380696489637, 'support': 136869}, '1': {'precision': 0.33640068111720356, 'recall': 0.960280945247776, 'f1-score': 0.4982551730154576, 'support': 130844}, '2': {'precision': 0.4025974025974026, 'recall': 0.0009775402249919195, 'f1-score': 0.0019503448492808103, 'support': 126849}, 'accuracy': 0.33894546357733385, 'macro avg': {'precision': 0.3742684375434229, 'recall': 0.3398151703409154, 'f1-score': 0.2004197749432116, 'support': 394562}, 'weighted avg': {'precision': 0.3741272607515046, 'recall': 0.33894546357733385, 'f1-score': 0.20091198001150481, 'support': 394562}}
[[  7964 128785    120]
 [  5133 125647     64]
 [  7653 119072    124]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107477
{'0': {'precision': 0.38657876943881003, 'recall': 0.054828346758726505, 'f1-score': 0.09603594524229445, 'support': 41712}, '1': {'precision': 0.3262954218058764, 'recall': 0.9622200437372748, 'f1-score': 0.487332908975175, 'support': 39783}, '2': {'precision': 0.40789473684210525, 'recall': 0.0007413784856746545, 'f1-score': 0.001480066841728336, 'support': 41814}, 'accuracy': 0.32923793072687313, 'macro avg': {'precision': 0.3735896426955972, 'recall': 0.3392632563272253, 'f1-score': 0.19494964035306592, 'support': 123309}, 'weighted avg': {'precision': 0.37435787268448056, 'recall': 0.32923793072687313, 'f1-score': 0.19021566942093443, 'support': 123309}}
[[ 2287 39409    16]
 [ 1474 38280    29]
 [ 2155 39628    31]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
5497/5497 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1124028
{'0': {'precision': 0.37940292342642096, 'recall': 0.03640655379622106, 'f1-score': 0.06643789378937894, 'support': 454149}, '1': {'precision': 0.32110383225764794, 'recall': 0.9783851459360363, 'f1-score': 0.4835180983538815, 'support': 447285}, '2': {'precision': 0.4366013071895425, 'recall': 0.0006603896694492667, 'f1-score': 0.0013187845860141711, 'support': 505762}, 'accuracy': 0.32297206643566356, 'macro avg': {'precision': 0.3790360209578705, 'recall': 0.3384840298005689, 'f1-score': 0.1837582589097582, 'support': 1407196}, 'weighted avg': {'precision': 0.3814299757882662, 'recall': 0.32297206643566356, 'f1-score': 0.17560459721215826, 'support': 1407196}}
[[ 16534 437340    275]
 [  9512 437617    156]
 [ 17533 487895    334]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063657
{'0': {'precision': 0.4006863305825639, 'recall': 0.026998161218220455, 'f1-score': 0.05058773164982644, 'support': 181642}, '1': {'precision': 0.33171576718712636, 'recall': 0.9835762215509489, 'f1-score': 0.4961145414286567, 'support': 173468}, '2': {'precision': 0.3146551724137931, 'recall': 0.00042512549937687085, 'f1-score': 0.0008491037883986834, 'support': 171714}, 'accuracy': 0.3333105553277755, 'macro avg': {'precision': 0.34901909006116116, 'recall': 0.3369998360895154, 'f1-score': 0.18251712562229394, 'support': 526824}, 'weighted avg': {'precision': 0.3499351499513245, 'recall': 0.3333105553277755, 'f1-score': 0.18107500234007007, 'support': 526824}}
[[  4904 176633    105]
 [  2795 170619     54]
 [  4540 167101     73]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078589
{'0': {'precision': 0.3948854201262039, 'recall': 0.040053224638291425, 'f1-score': 0.07272949704096769, 'support': 59371}, '1': {'precision': 0.328126207876694, 'recall': 0.9764125068568295, 'f1-score': 0.4911874666191917, 'support': 56513}, '2': {'precision': 0.34545454545454546, 'recall': 0.0006505178464435504, 'f1-score': 0.0012985903460059805, 'support': 58415}, 'accuracy': 0.3304436629011067, 'macro avg': {'precision': 0.3561553911524811, 'recall': 0.33903874978052145, 'f1-score': 0.1884051846687218, 'support': 174299}, 'weighted avg': {'precision': 0.3566736810697464, 'recall': 0.3304436629011067, 'f1-score': 0.18446667751927212, 'support': 174299}}
[[ 2378 56949    44]
 [ 1305 55180    28]
 [ 2339 56038    38]]
testing model on single stock: results/universal/W2/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
14883/14883 - 176s - 176s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981653
{'0': {'precision': 0.3327645255975481, 'recall': 0.1164503677026396, 'f1-score': 0.17252567509302885, 'support': 1190636}, '1': {'precision': 0.36856100331852015, 'recall': 0.9025362952092202, 'f1-score': 0.5233898032494808, 'support': 1384618}, '2': {'precision': 0.3485380116959064, 'recall': 0.0007240977126935787, 'f1-score': 0.0014451929955019579, 'support': 1234640}, 'accuracy': 0.36463271681574344, 'macro avg': {'precision': 0.34995451353732493, 'recall': 0.33990358687485117, 'f1-score': 0.23245355711267054, 'support': 3809894}, 'weighted avg': {'precision': 0.3508855085607313, 'recall': 0.36463271681574344, 'f1-score': 0.2445985414202389, 'support': 3809894}}
[[ 138650 1051168     818]
 [ 134097 1249668     853]
 [ 143914 1089832     894]]
Evaluating performance on  train set...
6147/6147 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036696
{'0': {'precision': 0.3622508110053291, 'recall': 0.1328819297503174, 'f1-score': 0.19443911847373302, 'support': 515134}, '1': {'precision': 0.3408408299792534, 'recall': 0.90343232842672, 'f1-score': 0.4949502005581067, 'support': 521541}, '2': {'precision': 0.3785310734463277, 'recall': 0.0014977422095050744, 'f1-score': 0.0029836788314666785, 'support': 536808}, 'accuracy': 0.343462878213492, 'macro avg': {'precision': 0.3605409048103034, 'recall': 0.34593733346218086, 'f1-score': 0.23079099928776878, 'support': 1573483}, 'weighted avg': {'precision': 0.36070849514052916, 'recall': 0.343462878213492, 'f1-score': 0.2287286777621909, 'support': 1573483}}
[[ 68452 445912    770]
 [ 49814 471177    550]
 [ 70697 465307    804]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013459
{'0': {'precision': 0.3742145070051551, 'recall': 0.16383765053459343, 'f1-score': 0.2278977038361061, 'support': 182101}, '1': {'precision': 0.3460120301952438, 'recall': 0.8910500573506178, 'f1-score': 0.4984617060912807, 'support': 184828}, '2': {'precision': 0.33705080545229243, 'recall': 0.0014347959108316542, 'f1-score': 0.0028574279996428217, 'support': 189574}, 'accuracy': 0.35003944273436083, 'macro avg': {'precision': 0.35242578088423043, 'recall': 0.3521075012653476, 'f1-score': 0.24307227930900988, 'support': 556503}, 'weighted avg': {'precision': 0.3521878891037158, 'recall': 0.35003944273436083, 'f1-score': 0.24109802469223396, 'support': 556503}}
[[ 29835 152000    266]
 [ 19868 164691    269]
 [ 30024 159278    272]]
training model: results/universal/W2/deepVOL_L2/h300
Epoch 1/50
9940/9940 - 632s - loss: 3.2518 - accuracy300: 0.3900 - val_loss: 3.2929 - val_accuracy300: 0.3485 - 632s/epoch - 64ms/step
Epoch 2/50
9940/9940 - 635s - loss: 3.2447 - accuracy300: 0.3954 - val_loss: 3.2951 - val_accuracy300: 0.3503 - 635s/epoch - 64ms/step
Epoch 3/50
9940/9940 - 635s - loss: 3.2329 - accuracy300: 0.4013 - val_loss: 3.3157 - val_accuracy300: 0.3432 - 635s/epoch - 64ms/step
Epoch 4/50
9940/9940 - 632s - loss: 3.2277 - accuracy300: 0.4045 - val_loss: 3.3219 - val_accuracy300: 0.3454 - 632s/epoch - 64ms/step
Epoch 5/50
9940/9940 - 624s - loss: 3.2229 - accuracy300: 0.4068 - val_loss: 3.3373 - val_accuracy300: 0.3433 - 624s/epoch - 63ms/step
Epoch 6/50
9940/9940 - 628s - loss: 3.2190 - accuracy300: 0.4085 - val_loss: 3.3364 - val_accuracy300: 0.3448 - 628s/epoch - 63ms/step
Epoch 7/50
9940/9940 - 624s - loss: 3.2166 - accuracy300: 0.4096 - val_loss: 3.3281 - val_accuracy300: 0.3460 - 624s/epoch - 63ms/step
Epoch 8/50
9940/9940 - 617s - loss: 3.2141 - accuracy300: 0.4109 - val_loss: 3.3252 - val_accuracy300: 0.3471 - 617s/epoch - 62ms/step
Epoch 9/50
9940/9940 - 619s - loss: 3.2111 - accuracy300: 0.4128 - val_loss: 3.3268 - val_accuracy300: 0.3489 - 619s/epoch - 62ms/step
Epoch 10/50
9940/9940 - 617s - loss: 3.2085 - accuracy300: 0.4144 - val_loss: 3.3258 - val_accuracy300: 0.3529 - 617s/epoch - 62ms/step
Epoch 11/50
9940/9940 - 619s - loss: 3.2058 - accuracy300: 0.4158 - val_loss: 3.3325 - val_accuracy300: 0.3529 - 619s/epoch - 62ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 952s - 952s/epoch - 36ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972773
{'0': {'precision': 0.34229802995165665, 'recall': 0.7112186529626469, 'f1-score': 0.46216400313764733, 'support': 2202760}, '1': {'precision': 0.33326686465059424, 'recall': 0.15719201513261158, 'f1-score': 0.2136239843573041, 'support': 2285924}, '2': {'precision': 0.3811761946093035, 'recall': 0.18199530931841754, 'f1-score': 0.24636288931139147, 'support': 2232085}, 'accuracy': 0.34701415864761903, 'macro avg': {'precision': 0.35224702973718475, 'recall': 0.3501353258045587, 'f1-score': 0.3073836256021143, 'support': 6720769}, 'weighted avg': {'precision': 0.3521383935544226, 'recall': 0.34701415864761903, 'f1-score': 0.3059571727815801, 'support': 6720769}}
[[1566644  337609  298507]
 [1565606  359329  360989]
 [1444592  381264  406229]]
Evaluating performance on  train set...
9940/9940 - 363s - 363s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983033
{'0': {'precision': 0.3436396443574185, 'recall': 0.711899682912535, 'f1-score': 0.4635297757913984, 'support': 848031}, '1': {'precision': 0.31958142976264575, 'recall': 0.16211524186159013, 'f1-score': 0.21511056161442405, 'support': 839261}, '2': {'precision': 0.38110167308741544, 'recall': 0.16069001275206346, 'f1-score': 0.22606191386404315, 'support': 856332}, 'accuracy': 0.3449306973043186, 'macro avg': {'precision': 0.34810758240249323, 'recall': 0.34490164584206284, 'f1-score': 0.3015674170899552, 'support': 2543624}, 'weighted avg': {'precision': 0.34831361061477106, 'recall': 0.3449306973043186, 'f1-score': 0.3016190974641937, 'support': 2543624}}
[[603713 136971 107347]
 [587086 136057 116118]
 [566021 152707 137604]]
Evaluating performance on  val set...
3393/3393 - 125s - 125s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978277
{'0': {'precision': 0.34996936788316674, 'recall': 0.6973467501866925, 'f1-score': 0.4660484015236715, 'support': 293263}, '1': {'precision': 0.30832506894537354, 'recall': 0.16309510976968128, 'f1-score': 0.21333966272489707, 'support': 278310}, '2': {'precision': 0.3892319525326887, 'recall': 0.17920233108723366, 'f1-score': 0.24541543407023553, 'support': 296514}, 'accuracy': 0.3490813708764214, 'macro avg': {'precision': 0.34917546312040965, 'recall': 0.34654806368120245, 'f1-score': 0.3082678327729347, 'support': 868087}, 'weighted avg': {'precision': 0.35002913284611525, 'recall': 0.3490813708764214, 'f1-score': 0.30966760926831577, 'support': 868087}}
[[204506  47947  40810]
 [190350  45391  42569]
 [189498  53880  53136]]
testing model out of sample: results/universal/W2/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 527s - 527s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986612
{'0': {'precision': 0.34865780281219205, 'recall': 0.6949389182551552, 'f1-score': 0.4643477148523691, 'support': 1248409}, '1': {'precision': 0.29349880550871277, 'recall': 0.14938011227446538, 'f1-score': 0.19799038860900267, 'support': 1118509}, '2': {'precision': 0.3945809290070509, 'recall': 0.1849163150140597, 'f1-score': 0.2518198390746794, 'support': 1299815}, 'accuracy': 0.3477231639173073, 'macro avg': {'precision': 0.34557917910931857, 'recall': 0.3430784485145601, 'f1-score': 0.30471931417868375, 'support': 3666733}, 'weighted avg': {'precision': 0.3481111945263019, 'recall': 0.3477231639173073, 'f1-score': 0.3077587329240097, 'support': 3666733}}
[[867568 191581 189260]
 [771898 167083 179528]
 [848842 210616 240357]]
Evaluating performance on  train set...
5373/5373 - 199s - 199s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978405
{'0': {'precision': 0.34954037095945995, 'recall': 0.7221151358344113, 'f1-score': 0.47106255854578594, 'support': 463800}, '1': {'precision': 0.3153864623350593, 'recall': 0.13428735890192975, 'f1-score': 0.18836949388733618, 'support': 449953}, '2': {'precision': 0.37239722133390185, 'recall': 0.18181719611657224, 'f1-score': 0.24433943431499835, 'support': 461139}, 'accuracy': 0.34852410225675906, 'macro avg': {'precision': 0.34577468487614044, 'recall': 0.3460732302843044, 'f1-score': 0.3012571622493735, 'support': 1374892}, 'weighted avg': {'precision': 0.3460292089754967, 'recall': 0.34852410225675906, 'f1-score': 0.3025042519246662, 'support': 1374892}}
[[334917  62195  66688]
 [314917  60423  74613]
 [308330  68966  83843]]
Evaluating performance on  val set...
1685/1685 - 63s - 63s/epoch - 37ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977664
{'0': {'precision': 0.3485347004361466, 'recall': 0.7195003021811989, 'f1-score': 0.46959289100057144, 'support': 145608}, '1': {'precision': 0.31503710713752053, 'recall': 0.13551441916270301, 'f1-score': 0.18951026950907104, 'support': 140022}, '2': {'precision': 0.38165316230996077, 'recall': 0.18380882778781318, 'f1-score': 0.2481200208472936, 'support': 145042}, 'accuracy': 0.349221681465245, 'macro avg': {'precision': 0.3484083232945427, 'recall': 0.34627451637723833, 'f1-score': 0.3024077271189787, 'support': 430672}, 'weighted avg': {'precision': 0.3487974710324276, 'recall': 0.349221681465245, 'f1-score': 0.30394340169257233, 'support': 430672}}
[[104765  19915  20928]
 [ 98781  18975  22266]
 [ 97041  21341  26660]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988225
{'0': {'precision': 0.3251233306127166, 'recall': 0.5617075970849555, 'f1-score': 0.411858087242949, 'support': 80136}, '1': {'precision': 0.37352309344790546, 'recall': 0.2527769574994889, 'f1-score': 0.30151053308948045, 'support': 88046}, '2': {'precision': 0.3638500238698542, 'recall': 0.23502899908673633, 'f1-score': 0.28558457935507114, 'support': 84313}, 'accuracy': 0.3448979187706687, 'macro avg': {'precision': 0.35416548264349207, 'recall': 0.34983785122372696, 'f1-score': 0.3329843998958335, 'support': 252495}, 'weighted avg': {'precision': 0.3549321157655952, 'recall': 0.3448979187706687, 'f1-score': 0.3312142763811619, 'support': 252495}}
[[45013 17472 17651]
 [48795 22256 16995]
 [44641 19856 19816]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008371
{'0': {'precision': 0.33591650521842387, 'recall': 0.5372582337947923, 'f1-score': 0.4133740939416662, 'support': 20009}, '1': {'precision': 0.33795737836751105, 'recall': 0.2508081762570249, 'f1-score': 0.2879328556339033, 'support': 20107}, '2': {'precision': 0.34395886889460153, 'recall': 0.22930029868285756, 'f1-score': 0.27516305305834654, 'support': 20423}, 'accuracy': 0.3382282495581361, 'macro avg': {'precision': 0.3392775841601788, 'recall': 0.3391222362448916, 'f1-score': 0.32549000087797203, 'support': 60539}, 'weighted avg': {'precision': 0.3393074603013832, 'recall': 0.3382282495581361, 'f1-score': 0.32508503950379597, 'support': 60539}}
[[10750  4791  4468]
 [10600  5043  4464]
 [10652  5088  4683]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017053
{'0': {'precision': 0.3266483776369312, 'recall': 0.4769995855781185, 'f1-score': 0.3877596855699045, 'support': 7239}, '1': {'precision': 0.32405325955386477, 'recall': 0.2539639517549804, 'f1-score': 0.28475915514359523, 'support': 7379}, '2': {'precision': 0.34693099504384295, 'recall': 0.26067029504439987, 'f1-score': 0.29767746156362446, 'support': 6982}, 'accuracy': 0.33087962962962963, 'macro avg': {'precision': 0.33254421074487966, 'recall': 0.3305446107924996, 'f1-score': 0.323398767425708, 'support': 21600}, 'weighted avg': {'precision': 0.3323180007110104, 'recall': 0.33087962962962963, 'f1-score': 0.3234543614019608, 'support': 21600}}
[[3453 2000 1786]
 [3865 1874 1640]
 [3253 1909 1820]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
1242/1242 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017907
{'0': {'precision': 0.32460499437195145, 'recall': 0.789813762882415, 'f1-score': 0.4601097933544883, 'support': 98584}, '1': {'precision': 0.32287865848924774, 'recall': 0.11355011330439294, 'f1-score': 0.16801325038377637, 'support': 109881}, '2': {'precision': 0.42386600824721277, 'recall': 0.1523039493661624, 'f1-score': 0.2240882788319203, 'support': 109334}, 'accuracy': 0.3366656282744754, 'macro avg': {'precision': 0.357116553702804, 'recall': 0.35188927518432345, 'f1-score': 0.28407044085672833, 'support': 317799}, 'weighted avg': {'precision': 0.35815737237789375, 'recall': 0.3366656282744754, 'f1-score': 0.27791590191060317, 'support': 317799}}
[[77863 10785  9936]
 [84706 12477 12698]
 [77301 15381 16652]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933567
{'0': {'precision': 0.3576234567901235, 'recall': 0.7738423864648264, 'f1-score': 0.48917815930199837, 'support': 44920}, '1': {'precision': 0.3168974375039158, 'recall': 0.11391891891891892, 'f1-score': 0.16759165686453173, 'support': 44400}, '2': {'precision': 0.43258401140072633, 'recall': 0.20638680528139666, 'f1-score': 0.27944823080463865, 'support': 45594}, 'accuracy': 0.3648917087922677, 'macro avg': {'precision': 0.36903496856492185, 'recall': 0.36471603688838067, 'f1-score': 0.3120726823237229, 'support': 134914}, 'weighted avg': {'precision': 0.3695533993506302, 'recall': 0.3648917087922677, 'f1-score': 0.31246657215661583, 'support': 134914}}
[[34761  4640  5519]
 [32518  5058  6824]
 [29921  6263  9410]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0914603
{'0': {'precision': 0.38473366282262494, 'recall': 0.7095881161377448, 'f1-score': 0.49894362017804156, 'support': 14810}, '1': {'precision': 0.33271870518336405, 'recall': 0.11880898383202868, 'f1-score': 0.17509433962264148, 'support': 13669}, '2': {'precision': 0.38397428265269673, 'recall': 0.2661769560911192, 'f1-score': 0.31440409456495244, 'support': 12116}, 'accuracy': 0.37832245350412613, 'macro avg': {'precision': 0.36714221688622856, 'recall': 0.36485801868696416, 'f1-score': 0.32948068478854514, 'support': 40595}, 'weighted avg': {'precision': 0.36699273152295975, 'recall': 0.37832245350412613, 'f1-score': 0.334820533388044, 'support': 40595}}
[[10509  1656  2645]
 [ 9516  1624  2529]
 [ 7290  1601  3225]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008954
{'0': {'precision': 0.3361241402775415, 'recall': 0.614832349770502, 'f1-score': 0.4346360683042185, 'support': 89979}, '1': {'precision': 0.2638715184721974, 'recall': 0.16893317404234767, 'f1-score': 0.20598969431637673, 'support': 78682}, '2': {'precision': 0.4041045028015932, 'recall': 0.22684553584962863, 'f1-score': 0.2905754714691391, 'support': 105552}, 'accuracy': 0.3375405250662806, 'macro avg': {'precision': 0.33470005385044405, 'recall': 0.33687035322082615, 'f1-score': 0.31040041136324475, 'support': 274213}, 'weighted avg': {'precision': 0.3415596317978218, 'recall': 0.3375405250662806, 'f1-score': 0.3135760233200359, 'support': 274213}}
[[55322 16657 18000]
 [48082 13292 17308]
 [61184 20424 23944]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003749
{'0': {'precision': 0.3379480295714543, 'recall': 0.6817557190202894, 'f1-score': 0.45189203670216327, 'support': 24742}, '1': {'precision': 0.3034011157099154, 'recall': 0.13853738701725554, 'f1-score': 0.19021831105093923, 'support': 24340}, '2': {'precision': 0.3546506786576734, 'recall': 0.17779911497035986, 'f1-score': 0.23685454494897534, 'support': 23954}, 'accuracy': 0.3354373185826168, 'macro avg': {'precision': 0.3319999413130144, 'recall': 0.3326974070026349, 'f1-score': 0.2929882975673593, 'support': 73036}, 'weighted avg': {'precision': 0.3319129697765783, 'recall': 0.3354373185826168, 'f1-score': 0.2941595957168046, 'support': 73036}}
[[16868  3879  3995]
 [17213  3372  3755]
 [15832  3863  4259]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1018442
{'0': {'precision': 0.33005988023952093, 'recall': 0.7114093959731543, 'f1-score': 0.45091623036649214, 'support': 9685}, '1': {'precision': 0.30180275715800636, 'recall': 0.14717137242734513, 'f1-score': 0.1978587319243604, 'support': 9669}, '2': {'precision': 0.39132495852097654, 'recall': 0.15791487326637973, 'f1-score': 0.2250238517105084, 'support': 10455}, 'accuracy': 0.3342614646583247, 'macro avg': {'precision': 0.34106253197283465, 'recall': 0.33883188055562635, 'f1-score': 0.29126627133378696, 'support': 29809}, 'weighted avg': {'precision': 0.34238193969664643, 'recall': 0.3342614646583247, 'f1-score': 0.2896052916806831, 'support': 29809}}
[[6890 1529 1266]
 [6944 1423 1302]
 [7041 1763 1651]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
860/860 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994929
{'0': {'precision': 0.33274825333049934, 'recall': 0.6661405001784391, 'f1-score': 0.443807355180313, 'support': 72854}, '1': {'precision': 0.2774246008279125, 'recall': 0.12584036078931043, 'f1-score': 0.17314279782706482, 'support': 59647}, '2': {'precision': 0.39462998788239545, 'recall': 0.21228686115526685, 'f1-score': 0.27606668550437974, 'support': 87443}, 'accuracy': 0.33917724511693886, 'macro avg': {'precision': 0.3349342806802691, 'recall': 0.33475590737433875, 'f1-score': 0.29767227950391917, 'support': 219944}, 'weighted avg': {'precision': 0.3423472176741489, 'recall': 0.33917724511693886, 'f1-score': 0.303716803808501, 'support': 219944}}
[[48531  8789 15534]
 [39199  7506 12942]
 [58119 10761 18563]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014278
{'0': {'precision': 0.3381848367459878, 'recall': 0.6676985832392468, 'f1-score': 0.4489695960424651, 'support': 27457}, '1': {'precision': 0.3303368566630446, 'recall': 0.12414612414612415, 'f1-score': 0.18046898189373703, 'support': 26936}, '2': {'precision': 0.33725286760043804, 'recall': 0.21440873612078126, 'f1-score': 0.2621533222814642, 'support': 27289}, 'accuracy': 0.33701427487084057, 'macro avg': {'precision': 0.3352581870031568, 'recall': 0.33541781450205077, 'f1-score': 0.29719730007255546, 'support': 81682}, 'weighted avg': {'precision': 0.335285474615689, 'recall': 0.33701427487084057, 'f1-score': 0.29801391624307116, 'support': 81682}}
[[18333  3390  5734]
 [17828  3344  5764]
 [18049  3389  5851]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006212
{'0': {'precision': 0.3444632290786137, 'recall': 0.6595375722543353, 'f1-score': 0.4525622719339997, 'support': 8650}, '1': {'precision': 0.30719794344473006, 'recall': 0.12236016894918725, 'f1-score': 0.17501144164759724, 'support': 7813}, '2': {'precision': 0.34651030830338564, 'recall': 0.21558013650270652, 'f1-score': 0.2657961552412042, 'support': 8498}, 'accuracy': 0.34025079123432556, 'macro avg': {'precision': 0.3327238269422432, 'recall': 0.33249262590207634, 'f1-score': 0.297789956274267, 'support': 24961}, 'weighted avg': {'precision': 0.3334958160180223, 'recall': 0.34025079123432556, 'f1-score': 0.3021018297769131, 'support': 24961}}
[[5705 1107 1838]
 [5240  956 1617]
 [5617 1049 1832]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011714
{'0': {'precision': 0.3093420089660056, 'recall': 0.7013011439587825, 'f1-score': 0.4293145491255556, 'support': 148869}, '1': {'precision': 0.33601842661169223, 'recall': 0.1476434638202222, 'f1-score': 0.20514713023210643, 'support': 178843}, '2': {'precision': 0.3611186348862405, 'recall': 0.16438871318747034, 'f1-score': 0.22592958182056963, 'support': 162207}, 'accuracy': 0.32142456201943587, 'macro avg': {'precision': 0.33549302348797944, 'recall': 0.33777777365549166, 'f1-score': 0.2867970870594106, 'support': 489919}, 'weighted avg': {'precision': 0.33622282338971865, 'recall': 0.32142456201943587, 'f1-score': 0.28014450450838213, 'support': 489919}}
[[104402  24020  20447]
 [125710  26405  26728]
 [107385  28157  26665]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995506
{'0': {'precision': 0.34924283161893527, 'recall': 0.6511481241914618, 'f1-score': 0.4546398852871772, 'support': 61840}, '1': {'precision': 0.30726546906187624, 'recall': 0.12679350959558522, 'f1-score': 0.17951139875225935, 'support': 60705}, '2': {'precision': 0.3402831402831403, 'recall': 0.24021275892827645, 'f1-score': 0.2816224957152402, 'support': 60538}, 'accuracy': 0.34140799528082894, 'macro avg': {'precision': 0.3322638136546506, 'recall': 0.33938479757177453, 'f1-score': 0.30525792658489226, 'support': 183083}, 'weighted avg': {'precision': 0.33236175807244206, 'recall': 0.34140799528082894, 'f1-score': 0.3062055603907744, 'support': 183083}}
[[40267  8568 13005]
 [37820  7697 15188]
 [37211  8785 14542]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017543
{'0': {'precision': 0.3376410531972058, 'recall': 0.6901911247803163, 'f1-score': 0.4534531283827668, 'support': 18208}, '1': {'precision': 0.3108966815721346, 'recall': 0.14745772171680527, 'f1-score': 0.2000378572780617, 'support': 17917}, '2': {'precision': 0.35418531781557744, 'recall': 0.17081331966107183, 'f1-score': 0.23047515019115233, 'support': 18529}, 'accuracy': 0.33618765323672556, 'macro avg': {'precision': 0.33424101752830593, 'recall': 0.33615405538606447, 'f1-score': 0.29465537861732694, 'support': 54654}, 'weighted avg': {'precision': 0.33448245131458804, 'recall': 0.33618765323672556, 'f1-score': 0.29478221005482325, 'support': 54654}}
[[12567  2808  2833]
 [12337  2642  2938]
 [12316  3048  3165]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
4918/4918 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926465
{'0': {'precision': 0.3565453977051721, 'recall': 0.8235748331744519, 'f1-score': 0.49764728838736116, 'support': 419600}, '1': {'precision': 0.3175430494161114, 'recall': 0.07078826029724304, 'f1-score': 0.11576877514326776, 'support': 407949}, '2': {'precision': 0.4369268248487472, 'recall': 0.20127060678429826, 'f1-score': 0.27559035119467146, 'support': 431290}, 'accuracy': 0.36641381463396033, 'macro avg': {'precision': 0.3703384239900102, 'recall': 0.3652112334186644, 'f1-score': 0.29633547157510015, 'support': 1258839}, 'weighted avg': {'precision': 0.37144542600948943, 'recall': 0.36641381463396033, 'f1-score': 0.2978140340623444, 'support': 1258839}}
[[345572  26762  47266]
 [314469  28878  64602]
 [309182  35302  86806]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093656
{'0': {'precision': 0.3552463217441543, 'recall': 0.8296716941772487, 'f1-score': 0.4974822116828357, 'support': 120802}, '1': {'precision': 0.3170832240416682, 'recall': 0.07189342577016533, 'f1-score': 0.11721114489330905, 'support': 117702}, '2': {'precision': 0.4265579522347594, 'recall': 0.17760383810883495, 'f1-score': 0.25078821833354825, 'support': 120476}, 'accuracy': 0.36237394840938214, 'macro avg': {'precision': 0.3662958326735273, 'recall': 0.3597229860187497, 'f1-score': 0.288493858303231, 'support': 358980}, 'weighted avg': {'precision': 0.36666608626922015, 'recall': 0.36237394840938214, 'f1-score': 0.29000722520445354, 'support': 358980}}
[[100226   7997  12579]
 [ 93054   8462  16186]
 [ 88851  10228  21397]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907161
{'0': {'precision': 0.376545097182791, 'recall': 0.7984440482530274, 'f1-score': 0.5117497347312809, 'support': 43189}, '1': {'precision': 0.2834686654174474, 'recall': 0.07572934338237339, 'f1-score': 0.11952680903364572, 'support': 35957}, '2': {'precision': 0.4514885513910176, 'recall': 0.2231071125289757, 'f1-score': 0.29863905870787383, 'support': 43571}, 'accuracy': 0.3824083052877759, 'macro avg': {'precision': 0.3705007713304187, 'recall': 0.36576016805479217, 'f1-score': 0.30997186749093353, 'support': 122717}, 'weighted avg': {'precision': 0.37588188007611617, 'recall': 0.3824083052877759, 'f1-score': 0.3211599631077427, 'support': 122717}}
[[34484  2989  5716]
 [27140  2723  6094]
 [29956  3894  9721]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967876
{'0': {'precision': 0.3676188089360817, 'recall': 0.6794061502971273, 'f1-score': 0.4770898297190404, 'support': 444759}, '1': {'precision': 0.27647073771949887, 'recall': 0.15002137370895904, 'f1-score': 0.19450075981049433, 'support': 362595}, '2': {'precision': 0.3957417956186797, 'recall': 0.20368912021783903, 'f1-score': 0.26894941870159006, 'support': 435551}, 'accuracy': 0.3582622967966176, 'macro avg': {'precision': 0.3466104474247534, 'recall': 0.34437221474130847, 'f1-score': 0.3135133360770416, 'support': 1242905}, 'weighted avg': {'precision': 0.35088314538159876, 'recall': 0.3582622967966176, 'f1-score': 0.32171098100369144, 'support': 1242905}}
[[302172  69658  72929]
 [245665  54397  62533]
 [274134  72700  88717]]
Evaluating performance on  train set...
2076/2076 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971117
{'0': {'precision': 0.3502635323881305, 'recall': 0.7466029288679426, 'f1-score': 0.4768270129385576, 'support': 178021}, '1': {'precision': 0.3201648118489316, 'recall': 0.13346305500236808, 'f1-score': 0.18839307289569068, 'support': 175247}, '2': {'precision': 0.3869221896903558, 'recall': 0.17136329445049456, 'f1-score': 0.2375281572057159, 'support': 178142}, 'accuracy': 0.351568468790576, 'macro avg': {'precision': 0.35245017797580597, 'recall': 0.3504764261069351, 'f1-score': 0.3009160810133214, 'support': 531410}, 'weighted avg': {'precision': 0.3526265591486356, 'recall': 0.351568468790576, 'f1-score': 0.30148902635822944, 'support': 531410}}
[[132911  22856  22254]
 [125742  23389  26116]
 [120807  26808  30527]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956707
{'0': {'precision': 0.3566005388194955, 'recall': 0.7145240759279979, 'f1-score': 0.4757610215791606, 'support': 50943}, '1': {'precision': 0.31926015279453157, 'recall': 0.12931332831172004, 'f1-score': 0.18407059130359188, 'support': 49121}, '2': {'precision': 0.3896397191150005, 'recall': 0.21975878676909605, 'f1-score': 0.28102055099573714, 'support': 50246}, 'accuracy': 0.35788703346417405, 'macro avg': {'precision': 0.3551668035763425, 'recall': 0.3545320636696047, 'f1-score': 0.31361738795949656, 'support': 150310}, 'weighted avg': {'precision': 0.35544219640179675, 'recall': 0.35788703346417405, 'f1-score': 0.31533885864588335, 'support': 150310}}
[[36400  6436  8107]
 [33579  6352  9190]
 [32096  7108 11042]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
4353/4353 - 58s - 58s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925316
{'0': {'precision': 0.3901850406789044, 'recall': 0.6896311811937319, 'f1-score': 0.49838808685586766, 'support': 406758}, '1': {'precision': 0.3025751911529093, 'recall': 0.13437459325784198, 'f1-score': 0.1861011021937722, 'support': 345735}, '2': {'precision': 0.37491884560194855, 'recall': 0.25059495017896877, 'f1-score': 0.300401909817136, 'support': 361795}, 'accuracy': 0.37479987220539035, 'macro avg': {'precision': 0.3558930258112541, 'recall': 0.3582002415435142, 'f1-score': 0.3282970329555919, 'support': 1114288}, 'weighted avg': {'precision': 0.3580452129380177, 'recall': 0.37479987220539035, 'f1-score': 0.337209872997442, 'support': 1114288}}
[[280513  53658  72587]
 [220705  46458  78572]
 [217705  53426  90664]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095722
{'0': {'precision': 0.35744588950587686, 'recall': 0.7230836443338665, 'f1-score': 0.4784011326698332, 'support': 135048}, '1': {'precision': 0.32157030581277724, 'recall': 0.12658615593147654, 'f1-score': 0.18166132745745578, 'support': 130583}, '2': {'precision': 0.3801737937342785, 'recall': 0.206310303105513, 'f1-score': 0.26747109100050276, 'support': 128932}, 'accuracy': 0.3568023357486637, 'macro avg': {'precision': 0.35306332968431087, 'recall': 0.35199336779028534, 'f1-score': 0.3091778503759306, 'support': 394563}, 'weighted avg': {'precision': 0.3529994837419818, 'recall': 0.3568023357486637, 'f1-score': 0.311267351457307, 'support': 394563}}
[[97651 16519 20878]
 [91563 16530 22490]
 [83977 18355 26600]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966033
{'0': {'precision': 0.3639506728982488, 'recall': 0.7473002659266967, 'f1-score': 0.4895031808542866, 'support': 43245}, '1': {'precision': 0.29114079911346424, 'recall': 0.1268746814047702, 'f1-score': 0.1767321922415726, 'support': 37273}, '2': {'precision': 0.4032946584938704, 'recall': 0.17220508506262852, 'f1-score': 0.2413533342067339, 'support': 42792}, 'accuracy': 0.36018976563133565, 'macro avg': {'precision': 0.3527953768351945, 'recall': 0.34879334413136515, 'f1-score': 0.30252956910086437, 'support': 123310}, 'weighted avg': {'precision': 0.3555958387893165, 'recall': 0.36018976563133565, 'f1-score': 0.3088467758887221, 'support': 123310}}
[[32317  5503  5425]
 [27066  4729  5478]
 [29412  6011  7369]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
5497/5497 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989999
{'0': {'precision': 0.35204241848562806, 'recall': 0.7448118910755035, 'f1-score': 0.4781042972899233, 'support': 484666}, '1': {'precision': 0.27508545385491834, 'recall': 0.12355760912212466, 'f1-score': 0.1705229772657331, 'support': 410343}, '2': {'precision': 0.4106861647990521, 'recall': 0.15835077470948394, 'f1-score': 0.22857030130438888, 'support': 512192}, 'accuracy': 0.35019304278493263, 'macro avg': {'precision': 0.34593801237986616, 'recall': 0.342240091635704, 'f1-score': 0.2923991919533484, 'support': 1407201}, 'weighted avg': {'precision': 0.3509467015086688, 'recall': 0.35019304278493263, 'f1-score': 0.29758768447163425, 'support': 1407201}}
[[360985  63019  60662]
 [303921  50701  55721]
 [360496  70590  81106]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097259
{'0': {'precision': 0.3515217283038057, 'recall': 0.748420653168739, 'f1-score': 0.47836345963491733, 'support': 179188}, '1': {'precision': 0.30920210708014645, 'recall': 0.12255092772803944, 'f1-score': 0.17553092635455914, 'support': 169554}, '2': {'precision': 0.3822185239710683, 'recall': 0.16765871901708201, 'f1-score': 0.2330784513479861, 'support': 178082}, 'accuracy': 0.3506749882313638, 'macro avg': {'precision': 0.34764745311834017, 'recall': 0.34621009997128677, 'f1-score': 0.29565761244582084, 'support': 526824}, 'weighted avg': {'precision': 0.3482779233690668, 'recall': 0.3506749882313638, 'f1-score': 0.2979857391939899, 'support': 526824}}
[[134108  22088  22992]
 [123509  20779  25266]
 [123890  24335  29857]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097376
{'0': {'precision': 0.35079795242396866, 'recall': 0.763190163438765, 'f1-score': 0.48066140532763474, 'support': 59533}, '1': {'precision': 0.3017974532248425, 'recall': 0.11736627574370709, 'f1-score': 0.16900719535584188, 'support': 55936}, '2': {'precision': 0.3917140747817779, 'recall': 0.15332313445520993, 'f1-score': 0.22038432876846206, 'support': 58830}, 'accuracy': 0.35008806705718337, 'macro avg': {'precision': 0.34810316014352977, 'recall': 0.344626524545894, 'f1-score': 0.2900176431506462, 'support': 174299}, 'weighted avg': {'precision': 0.3488828729060575, 'recall': 0.35008806705718337, 'f1-score': 0.2927957818704816, 'support': 174299}}
[[45435  7292  6806]
 [42170  6565  7201]
 [41914  7896  9020]]
testing model on single stock: results/universal/W2/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
14883/14883 - 199s - 199s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996912
{'0': {'precision': 0.3251781209780181, 'recall': 0.6753795134128489, 'f1-score': 0.43899248493034737, 'support': 1204964}, '1': {'precision': 0.3433709489349035, 'recall': 0.1938384632996554, 'f1-score': 0.24779348822810668, 'support': 1362712}, '2': {'precision': 0.3580811676422423, 'recall': 0.15507521596363938, 'f1-score': 0.21642336012439078, 'support': 1242223}, 'accuracy': 0.33349755465958547, 'macro avg': {'precision': 0.34221007918505464, 'recall': 0.3414310642253812, 'f1-score': 0.3010697777609483, 'support': 3809899}, 'weighted avg': {'precision': 0.3424133564283951, 'recall': 0.33349755465958547, 'f1-score': 0.2980360834304825, 'support': 3809899}}
[[813808 237540 153616]
 [906847 264146 191719]
 [781998 267587 192638]]
Evaluating performance on  train set...
6147/6147 - 77s - 77s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002154
{'0': {'precision': 0.3368347505585292, 'recall': 0.6807450500573293, 'f1-score': 0.45067441195518654, 'support': 519804}, '1': {'precision': 0.31950645092042673, 'recall': 0.19763297667616042, 'f1-score': 0.24420884424189754, 'support': 519640}, '2': {'precision': 0.36764071036217755, 'recall': 0.13873653895487426, 'f1-score': 0.20145138749163918, 'support': 534041}, 'accuracy': 0.3372405837996549, 'macro avg': {'precision': 0.3413273039470445, 'recall': 0.339038188562788, 'f1-score': 0.29877821456290776, 'support': 1573485}, 'weighted avg': {'precision': 0.3415676637769943, 'recall': 0.3372405837996549, 'f1-score': 0.2979032823835219, 'support': 1573485}}
[[353854 103640  62310]
 [351812 102698  65130]
 [344861 115089  74091]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001414
{'0': {'precision': 0.33698708465063604, 'recall': 0.6620857396833707, 'f1-score': 0.4466428027474164, 'support': 183369}, '1': {'precision': 0.3104315443592552, 'recall': 0.19296506497892135, 'f1-score': 0.23799303379315673, 'support': 183598}, '2': {'precision': 0.37407136767750576, 'recall': 0.16205279180318355, 'f1-score': 0.2261390701903573, 'support': 189537}, 'accuracy': 0.3370128516596467, 'macro avg': {'precision': 0.34049666556246566, 'recall': 0.3390345321551585, 'f1-score': 0.3035916355769768, 'support': 556504}, 'weighted avg': {'precision': 0.34085641832235597, 'recall': 0.3370128516596467, 'f1-score': 0.30270619809025046, 'support': 556504}}
[[121406  36886  25077]
 [121852  35428  26318]
 [117011  41811  30715]]
training model: results/universal/W2/deepVOL_L2/h500
Epoch 1/50
9940/9940 - 624s - loss: 3.2651 - accuracy500: 0.3806 - val_loss: 3.3044 - val_accuracy500: 0.3410 - 624s/epoch - 63ms/step
Epoch 2/50
9940/9940 - 621s - loss: 3.2581 - accuracy500: 0.3865 - val_loss: 3.3013 - val_accuracy500: 0.3430 - 621s/epoch - 62ms/step
Epoch 3/50
9940/9940 - 621s - loss: 3.2498 - accuracy500: 0.3941 - val_loss: 3.3159 - val_accuracy500: 0.3391 - 621s/epoch - 63ms/step
Epoch 4/50
9940/9940 - 628s - loss: 3.2408 - accuracy500: 0.3982 - val_loss: 3.3230 - val_accuracy500: 0.3395 - 628s/epoch - 63ms/step
Epoch 5/50
9940/9940 - 626s - loss: 3.2339 - accuracy500: 0.4011 - val_loss: 3.3206 - val_accuracy500: 0.3442 - 626s/epoch - 63ms/step
Epoch 6/50
9940/9940 - 630s - loss: 3.2289 - accuracy500: 0.4041 - val_loss: 3.3245 - val_accuracy500: 0.3431 - 630s/epoch - 63ms/step
Epoch 7/50
9940/9940 - 628s - loss: 3.2249 - accuracy500: 0.4061 - val_loss: 3.3197 - val_accuracy500: 0.3436 - 628s/epoch - 63ms/step
Epoch 8/50
9940/9940 - 637s - loss: 3.2208 - accuracy500: 0.4088 - val_loss: 3.3253 - val_accuracy500: 0.3431 - 637s/epoch - 64ms/step
Epoch 9/50
9940/9940 - 616s - loss: 3.2165 - accuracy500: 0.4111 - val_loss: 3.3288 - val_accuracy500: 0.3432 - 616s/epoch - 62ms/step
Epoch 10/50
9940/9940 - 617s - loss: 3.2136 - accuracy500: 0.4131 - val_loss: 3.3298 - val_accuracy500: 0.3445 - 617s/epoch - 62ms/step
Epoch 11/50
9940/9940 - 616s - loss: 3.2104 - accuracy500: 0.4150 - val_loss: 3.3361 - val_accuracy500: 0.3449 - 616s/epoch - 62ms/step
Epoch 12/50
9940/9940 - 616s - loss: 3.2079 - accuracy500: 0.4162 - val_loss: 3.3306 - val_accuracy500: 0.3487 - 616s/epoch - 62ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 957s - 957s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102235
{'0': {'precision': 0.33010083812984325, 'recall': 0.7446201413790882, 'f1-score': 0.45742055369554957, 'support': 2188301}, '1': {'precision': 0.3292362817154099, 'recall': 0.11078130701036418, 'f1-score': 0.16578076212492615, 'support': 2332361}, '2': {'precision': 0.3505509882980628, 'recall': 0.15929361617412244, 'f1-score': 0.2190492322154497, 'support': 2200107}, 'accuracy': 0.3330419480270784, 'macro avg': {'precision': 0.3366293693811053, 'recall': 0.33823168818785826, 'f1-score': 0.28075018267864177, 'support': 6720769}, 'weighted avg': {'precision': 0.3364953535302129, 'recall': 0.3330419480270784, 'f1-score': 0.27817742111725846, 'support': 6720769}}
[[1629453  254230  304618]
 [1729311  258382  344668]
 [1577464  272180  350463]]
Evaluating performance on  train set...
9940/9940 - 365s - 365s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1012025
{'0': {'precision': 0.33826614273065536, 'recall': 0.7387913296168762, 'f1-score': 0.4640571181548158, 'support': 855833}, '1': {'precision': 0.31028124325132483, 'recall': 0.11271035887731358, 'f1-score': 0.1653551044690497, 'support': 828584}, '2': {'precision': 0.3625988742924162, 'recall': 0.1576034645900231, 'f1-score': 0.21971004193367036, 'support': 859207}, 'accuracy': 0.33852723515739747, 'macro avg': {'precision': 0.3370487534247988, 'recall': 0.3363683843614043, 'f1-score': 0.28304075485251196, 'support': 2543624}, 'weighted avg': {'precision': 0.3373693959382066, 'recall': 0.33852723515739747, 'f1-score': 0.2842174769080951, 'support': 2543624}}
[[632282 103024 120527]
 [617681  93390 117513]
 [619222 104571 135414]]
Evaluating performance on  val set...
3393/3393 - 124s - 124s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004034
{'0': {'precision': 0.34144548136857117, 'recall': 0.7349513637879747, 'f1-score': 0.46627008118846086, 'support': 293814}, '1': {'precision': 0.3122087233618801, 'recall': 0.11334656529394113, 'f1-score': 0.16631346098248645, 'support': 276603}, '2': {'precision': 0.372557138737513, 'recall': 0.16926462189673128, 'f1-score': 0.23277301801063038, 'support': 297670}, 'accuracy': 0.342910330416191, 'macro avg': {'precision': 0.3420704478226548, 'recall': 0.33918751699288235, 'f1-score': 0.2884521867271926, 'support': 868087}, 'weighted avg': {'precision': 0.3427979173272806, 'recall': 0.342910330416191, 'f1-score': 0.2906264281732931, 'support': 868087}}
[[215939  33397  44478]
 [204873  31352  40378]
 [211614  35671  50385]]
testing model out of sample: results/universal/W2/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 524s - 524s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1030142
{'0': {'precision': 0.33631595303176365, 'recall': 0.7200771592087786, 'f1-score': 0.45849113033702205, 'support': 1236923}, '1': {'precision': 0.26807338067874303, 'recall': 0.10138332920992536, 'f1-score': 0.14712506812481757, 'support': 1123666}, '2': {'precision': 0.38187615009740017, 'recall': 0.17350001224979789, 'f1-score': 0.2385969049870182, 'support': 1306144}, 'accuracy': 0.33578037997312593, 'macro avg': {'precision': 0.32875516126930227, 'recall': 0.33165350022283396, 'f1-score': 0.2814043678162859, 'support': 3666733}, 'weighted avg': {'precision': 0.331632306780583, 'recall': 0.33578037997312593, 'f1-score': 0.2847438242917511, 'support': 3666733}}
[[890680 153633 192610]
 [835543 113921 174202]
 [922120 157408 226616]]
Evaluating performance on  train set...
5373/5373 - 199s - 199s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026394
{'0': {'precision': 0.33497160862637704, 'recall': 0.7363318752547279, 'f1-score': 0.46046760128771624, 'support': 458823}, '1': {'precision': 0.3155691723483214, 'recall': 0.09461175714633795, 'f1-score': 0.14557748422811054, 'support': 463769}, '2': {'precision': 0.3472303502048252, 'recall': 0.17447269511386249, 'f1-score': 0.23224788725762138, 'support': 452300}, 'accuracy': 0.3350357700823047, 'macro avg': {'precision': 0.3325903770598412, 'recall': 0.3351387758383095, 'f1-score': 0.2794309909244827, 'support': 1374892}, 'weighted avg': {'precision': 0.33245968794147557, 'recall': 0.3350357700823047, 'f1-score': 0.27917332409763285, 'support': 1374892}}
[[337846  47333  73644]
 [345182  43878  74709]
 [325553  47833  78914]]
Evaluating performance on  val set...
1685/1685 - 62s - 62s/epoch - 37ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032746
{'0': {'precision': 0.32930700662568047, 'recall': 0.7417468442254458, 'f1-score': 0.45611606316866377, 'support': 141249}, '1': {'precision': 0.3331063829787234, 'recall': 0.09203162894438062, 'f1-score': 0.14421821703794163, 'support': 148851}, '2': {'precision': 0.345309632866888, 'recall': 0.17536920581623652, 'f1-score': 0.23260663417671953, 'support': 140572}, 'accuracy': 0.3323225099379574, 'macro avg': {'precision': 0.33590767415709727, 'recall': 0.33638255966202096, 'f1-score': 0.27764697146110834, 'support': 430672}, 'weighted avg': {'precision': 0.33584344768873037, 'recall': 0.3323225099379574, 'f1-score': 0.27536255760837725, 'support': 430672}}
[[104771  13672  22806]
 [111219  13699  23933]
 [102166  13754  24652]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050379
{'0': {'precision': 0.29043242406598024, 'recall': 0.5110762366734974, 'f1-score': 0.37038429544268936, 'support': 77102}, '1': {'precision': 0.32309102738510675, 'recall': 0.22792468575601105, 'f1-score': 0.2672897310588221, 'support': 95865}, '2': {'precision': 0.33730433014840416, 'recall': 0.20863092244241022, 'f1-score': 0.2578038813530354, 'support': 79528}, 'accuracy': 0.3083110556644686, 'macro avg': {'precision': 0.3169425938664971, 'recall': 0.3158772816239729, 'f1-score': 0.29849263595151565, 'support': 252495}, 'weighted avg': {'precision': 0.31759512413572843, 'recall': 0.3083110556644686, 'f1-score': 0.2957829940847162, 'support': 252495}}
[[39405 21809 15888]
 [57305 21850 16710]
 [38967 23969 16592]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042063
{'0': {'precision': 0.3383525535420099, 'recall': 0.5102608695652174, 'f1-score': 0.40689450222882617, 'support': 20125}, '1': {'precision': 0.33114931473911996, 'recall': 0.2721300138312586, 'f1-score': 0.29875271149674615, 'support': 20244}, '2': {'precision': 0.3206670109938759, 'recall': 0.21546851760039662, 'f1-score': 0.25774693829137385, 'support': 20170}, 'accuracy': 0.33241381588727925, 'macro avg': {'precision': 0.33005629309166856, 'recall': 0.33261980033229094, 'f1-score': 0.3211313840056487, 'support': 60539}, 'weighted avg': {'precision': 0.3300514623525028, 'recall': 0.33241381588727925, 'f1-score': 0.32104027972434734, 'support': 60539}}
[[10269  5390  4466]
 [ 9994  5509  4741]
 [10087  5737  4346]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024877
{'0': {'precision': 0.3140354046242775, 'recall': 0.4937517750639023, 'f1-score': 0.38390195428949986, 'support': 7042}, '1': {'precision': 0.33025830258302585, 'recall': 0.2207423850043162, 'f1-score': 0.26461674920541056, 'support': 8109}, '2': {'precision': 0.29933437744714175, 'recall': 0.23709102186385486, 'f1-score': 0.26460154019209137, 'support': 6449}, 'accuracy': 0.31462962962962965, 'macro avg': {'precision': 0.31454269488481507, 'recall': 0.3171950606440244, 'f1-score': 0.30437341456233397, 'support': 21600}, 'weighted avg': {'precision': 0.31573654144289515, 'recall': 0.31462962962962965, 'f1-score': 0.30350139417185784, 'support': 21600}}
[[3477 1790 1775]
 [4515 1790 1804]
 [3080 1840 1529]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1116354
{'0': {'precision': 0.2571885536772254, 'recall': 0.8127893272420204, 'f1-score': 0.3907372577423161, 'support': 82303}, '1': {'precision': 0.4056462979852417, 'recall': 0.068939036333021, 'f1-score': 0.11784967993303586, 'support': 141937}, '2': {'precision': 0.37473195139385274, 'recall': 0.13448198463001956, 'f1-score': 0.1979313328351752, 'support': 93559}, 'accuracy': 0.2808756478151284, 'macro avg': {'precision': 0.3458556010187733, 'recall': 0.3387367827350203, 'f1-score': 0.23550609017017574, 'support': 317799}, 'weighted avg': {'precision': 0.3580979007828388, 'recall': 0.2808756478151284, 'f1-score': 0.21209738266434855, 'support': 317799}}
[[ 66895   7085   8323]
 [119481   9785  12671]
 [ 73725   7252  12582]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004846
{'0': {'precision': 0.34611580734852304, 'recall': 0.8097795241213709, 'f1-score': 0.48495306821450057, 'support': 45810}, '1': {'precision': 0.339909158701105, 'recall': 0.11378645183252015, 'f1-score': 0.17049782372143635, 'support': 44065}, '2': {'precision': 0.37735849056603776, 'recall': 0.10879460023535159, 'f1-score': 0.16889562939473324, 'support': 45039}, 'accuracy': 0.3484441940791912, 'macro avg': {'precision': 0.3544611522052219, 'recall': 0.3441201920630809, 'f1-score': 0.27478217377689007, 'support': 134914}, 'weighted avg': {'precision': 0.354518517495618, 'recall': 0.3484441940791912, 'f1-score': 0.2767361201172655, 'support': 134914}}
[[37096  4545  4169]
 [35135  5014  3916]
 [34947  5192  4900]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994179
{'0': {'precision': 0.3390573743054161, 'recall': 0.735210858677506, 'f1-score': 0.4640901697555612, 'support': 13777}, '1': {'precision': 0.38204334365325077, 'recall': 0.11557914455198251, 'f1-score': 0.17746883988494727, 'support': 16015}, '2': {'precision': 0.28369639210347175, 'recall': 0.1543089882440063, 'f1-score': 0.19989207986090293, 'support': 10803}, 'accuracy': 0.3361744057149895, 'macro avg': {'precision': 0.3349323700207128, 'recall': 0.3350329971578316, 'f1-score': 0.2804836965004705, 'support': 40595}, 'weighted avg': {'precision': 0.3412831560119801, 'recall': 0.3361744057149895, 'f1-score': 0.28070865570186315, 'support': 40595}}
[[10129  1532  2116]
 [12071  1851  2093]
 [ 7674  1462  1667]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043824
{'0': {'precision': 0.3247311304390167, 'recall': 0.6078589983138131, 'f1-score': 0.4233172399839728, 'support': 87772}, '1': {'precision': 0.26800157047506873, 'recall': 0.13008346990890726, 'f1-score': 0.17515139074207126, 'support': 78711}, '2': {'precision': 0.4123610704374625, 'recall': 0.274482502552678, 'f1-score': 0.3295827551424161, 'support': 107730}, 'accuracy': 0.3397431923358849, 'macro avg': {'precision': 0.3350312571171827, 'recall': 0.3374749902584661, 'f1-score': 0.3093504619561534, 'support': 274213}, 'weighted avg': {'precision': 0.3428744461888545, 'recall': 0.3397431923358849, 'f1-score': 0.3152574535710011, 'support': 274213}}
[[53353 12402 22017]
 [48350 10239 20122]
 [62596 15564 29570]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036725
{'0': {'precision': 0.32622960013459706, 'recall': 0.7161735133582304, 'f1-score': 0.448266118674544, 'support': 24367}, '1': {'precision': 0.32423444644589167, 'recall': 0.0932865571679158, 'f1-score': 0.14488715519643355, 'support': 25084}, '2': {'precision': 0.3378224890475418, 'recall': 0.17655289378842484, 'f1-score': 0.23190665812703629, 'support': 23585}, 'accuracy': 0.3279889369625938, 'macro avg': {'precision': 0.3294288452093435, 'recall': 0.328670988104857, 'f1-score': 0.2750199773326713, 'support': 73036}, 'weighted avg': {'precision': 0.32928798024692957, 'recall': 0.3279889369625938, 'f1-score': 0.27420406986439705, 'support': 73036}}
[[17451  2446  4470]
 [19052  2340  3692]
 [16990  2431  4164]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049589
{'0': {'precision': 0.32010415731345965, 'recall': 0.7407022646997714, 'f1-score': 0.44702194357366776, 'support': 9626}, '1': {'precision': 0.31630252100840334, 'recall': 0.09683062358509982, 'f1-score': 0.14827070038603957, 'support': 9718}, '2': {'precision': 0.374780701754386, 'recall': 0.16330625895843287, 'f1-score': 0.22748752079866888, 'support': 10465}, 'accuracy': 0.3280888322318763, 'macro avg': {'precision': 0.33706246002541634, 'recall': 0.3336130490811014, 'f1-score': 0.2742600549194587, 'support': 29809}, 'weighted avg': {'precision': 0.3380600007151758, 'recall': 0.3280888322318763, 'f1-score': 0.2725547586416763, 'support': 29809}}
[[7130  989 1507]
 [7433  941 1344]
 [7711 1045 1709]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138909
{'0': {'precision': 0.3213185572450695, 'recall': 0.36740994372798585, 'f1-score': 0.3428219766406536, 'support': 71261}, '1': {'precision': 0.280673666539726, 'recall': 0.5948706122650678, 'f1-score': 0.38139593828216584, 'support': 60709}, '2': {'precision': 0.3697916666666667, 'recall': 0.04115988814877123, 'f1-score': 0.07407483174109608, 'support': 87974}, 'accuracy': 0.2996990142945477, 'macro avg': {'precision': 0.32392796348382075, 'recall': 0.33448014804727494, 'f1-score': 0.26609758222130514, 'support': 219944}, 'weighted avg': {'precision': 0.32948819432734905, 'recall': 0.2996990142945477, 'f1-score': 0.24597471239112143, 'support': 219944}}
[[26182 41963  3116]
 [21540 36114  3055]
 [33761 50592  3621]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037084
{'0': {'precision': 0.339979224608786, 'recall': 0.3708062276149404, 'f1-score': 0.35472423739183634, 'support': 27362}, '1': {'precision': 0.32587228439763, 'recall': 0.5691554467564259, 'f1-score': 0.41444969615124916, 'support': 26961}, '2': {'precision': 0.32442105263157894, 'recall': 0.05632515808326328, 'f1-score': 0.09598554922295931, 'support': 27359}, 'accuracy': 0.3309419455938885, 'macro avg': {'precision': 0.3300908538793316, 'recall': 0.3320956108182099, 'f1-score': 0.2883864942553483, 'support': 81682}, 'weighted avg': {'precision': 0.33011177226729843, 'recall': 0.3309419455938885, 'f1-score': 0.28777468086775787, 'support': 81682}}
[[10146 15677  1539]
 [ 9946 15345  1670]
 [ 9751 16067  1541]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058398
{'0': {'precision': 0.3515649370905688, 'recall': 0.38657672078664534, 'f1-score': 0.3682404835811142, 'support': 8746}, '1': {'precision': 0.29440303754746167, 'recall': 0.5608090008036432, 'f1-score': 0.38611213574326814, 'support': 7466}, '2': {'precision': 0.34670231729055256, 'recall': 0.04446222425420048, 'f1-score': 0.07881673589301996, 'support': 8749}, 'accuracy': 0.31877729257641924, 'macro avg': {'precision': 0.3308900973095277, 'recall': 0.330615981948163, 'f1-score': 0.2777231184058008, 'support': 24961}, 'weighted avg': {'precision': 0.33276305404825557, 'recall': 0.31877729257641924, 'f1-score': 0.2721410238847681, 'support': 24961}}
[[3381 5017  348]
 [2894 4187  385]
 [3342 5018  389]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036848
{'0': {'precision': 0.3366024653312789, 'recall': 0.8010670871454502, 'f1-score': 0.47402368436755793, 'support': 163623}, '1': {'precision': 0.24601052601953224, 'recall': 0.05847722392073697, 'f1-score': 0.09449321110438468, 'support': 149477}, '2': {'precision': 0.41359943374161384, 'recall': 0.15201420661806705, 'f1-score': 0.22231779890573888, 'support': 176819}, 'accuracy': 0.34024604067202946, 'macro avg': {'precision': 0.33207080836414166, 'recall': 0.33718617256141803, 'f1-score': 0.2636115647925605, 'support': 489919}, 'weighted avg': {'precision': 0.33675170560333423, 'recall': 0.34024604067202946, 'f1-score': 0.2673824650773636, 'support': 489919}}
[[131073  12380  20170]
 [122797   8741  17939]
 [135530  14410  26879]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102809
{'0': {'precision': 0.3327643897657755, 'recall': 0.6497286060746045, 'f1-score': 0.440118238051866, 'support': 60613}, '1': {'precision': 0.3403239112500543, 'recall': 0.12336119111698696, 'f1-score': 0.18108307919785602, 'support': 63537}, '2': {'precision': 0.31886629579896414, 'recall': 0.225646072658782, 'f1-score': 0.2642765583234794, 'support': 58933}, 'accuracy': 0.33054953217939403, 'macro avg': {'precision': 0.33065153227159794, 'recall': 0.3329119566167911, 'f1-score': 0.2951592918577338, 'support': 183083}, 'weighted avg': {'precision': 0.3309141521402205, 'recall': 0.33054953217939403, 'f1-score': 0.2936207773398379, 'support': 183083}}
[[39382  7687 13544]
 [40837  7838 14862]
 [38129  7506 13298]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060164
{'0': {'precision': 0.34085847337517716, 'recall': 0.6988739556847076, 'f1-score': 0.45822771889832087, 'support': 19271}, '1': {'precision': 0.26843033509700176, 'recall': 0.09861984060130888, 'f1-score': 0.14424489409088753, 'support': 15433}, '2': {'precision': 0.3491342905405405, 'recall': 0.16576441102756892, 'f1-score': 0.22479777037590917, 'support': 19950}, 'accuracy': 0.3347787902074871, 'macro avg': {'precision': 0.31947436633757315, 'recall': 0.32108606910452847, 'f1-score': 0.2757567944550392, 'support': 54654}, 'weighted avg': {'precision': 0.3234273447185723, 'recall': 0.3347787902074871, 'f1-score': 0.28435893695600684, 'support': 54654}}
[[13468  2233  3570]
 [11316  1522  2595]
 [14728  1915  3307]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
4918/4918 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989884
{'0': {'precision': 0.3464649782089247, 'recall': 0.8987823368429947, 'f1-score': 0.5001361560629282, 'support': 426062}, '1': {'precision': 0.29783836895111765, 'recall': 0.03709340655138393, 'f1-score': 0.0659706872513347, 'support': 392253}, '2': {'precision': 0.4155064076854027, 'recall': 0.09877100907101542, 'f1-score': 0.15960252511728737, 'support': 440524}, 'accuracy': 0.3503212086692579, 'macro avg': {'precision': 0.35326991828181503, 'recall': 0.34488225082179796, 'f1-score': 0.24190312281051674, 'support': 1258839}, 'weighted avg': {'precision': 0.35547365470964754, 'recall': 0.3503212086692579, 'f1-score': 0.2456826915003817, 'support': 1258839}}
[[382937  14826  28299]
 [344795  14550  32908]
 [377537  19476  43511]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998442
{'0': {'precision': 0.34319201123500975, 'recall': 0.8709913194872174, 'f1-score': 0.49237583013967007, 'support': 121767}, '1': {'precision': 0.3251169841165228, 'recall': 0.04186895263961976, 'f1-score': 0.07418435556758626, 'support': 117820}, '2': {'precision': 0.3616023926609726, 'recall': 0.10531605705527125, 'f1-score': 0.16312286755834618, 'support': 119393}, 'accuracy': 0.3442113766783665, 'macro avg': {'precision': 0.3433037960041683, 'recall': 0.3393921097273695, 'f1-score': 0.24322768442186748, 'support': 358980}, 'weighted avg': {'precision': 0.3433827488094982, 'recall': 0.3442113766783665, 'f1-score': 0.24561607055541768, 'support': 358980}}
[[106058   5007  10702]
 [101390   4933  11497]
 [101586   5233  12574]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981096
{'0': {'precision': 0.3510030203752349, 'recall': 0.8478576011787352, 'f1-score': 0.4964723563546291, 'support': 42079}, '1': {'precision': 0.31546875, 'recall': 0.053021350350586936, 'f1-score': 0.09078441511724634, 'support': 38079}, '2': {'precision': 0.38557993730407525, 'recall': 0.13294485302756173, 'f1-score': 0.19771809969772683, 'support': 42559}, 'accuracy': 0.3532843860263859, 'macro avg': {'precision': 0.3506839025597701, 'recall': 0.34460793485229463, 'f1-score': 0.26165829038986743, 'support': 122717}, 'weighted avg': {'precision': 0.35196824545371586, 'recall': 0.3532843860263859, 'f1-score': 0.266977881070525, 'support': 122717}}
[[35677  1998  4404]
 [31448  2019  4612]
 [34518  2383  5658]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022314
{'0': {'precision': 0.35299559981472906, 'recall': 0.6857968797453404, 'f1-score': 0.4660859328117177, 'support': 444515}, '1': {'precision': 0.2497495508705556, 'recall': 0.12383930999650336, 'f1-score': 0.16557673577292334, 'support': 360346}, '2': {'precision': 0.37409906991117803, 'recall': 0.171338952251372, 'f1-score': 0.23503217624125136, 'support': 438044}, 'accuracy': 0.34155949167474586, 'macro avg': {'precision': 0.3256147401988209, 'recall': 0.3269917139977386, 'f1-score': 0.2888982816086308, 'support': 1242905}, 'weighted avg': {'precision': 0.3304998722266123, 'recall': 0.34155949167474586, 'f1-score': 0.2975300103081517, 'support': 1242905}}
[[304847  68615  71053]
 [261202  44625  54519]
 [297551  65439  75054]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028568
{'0': {'precision': 0.3365472740792344, 'recall': 0.7674722550842206, 'f1-score': 0.46790964934424856, 'support': 177510}, '1': {'precision': 0.3150749063670412, 'recall': 0.0997127943288277, 'f1-score': 0.15148471993766774, 'support': 175484}, '2': {'precision': 0.36323601829053814, 'recall': 0.14470114787911398, 'f1-score': 0.20695736519553812, 'support': 178416}, 'accuracy': 0.33787282888918163, 'macro avg': {'precision': 0.3382860662456046, 'recall': 0.3372953990973874, 'f1-score': 0.27545057815915147, 'support': 531410}, 'weighted avg': {'precision': 0.338417095895906, 'recall': 0.33787282888918163, 'f1-score': 0.2758064238862016, 'support': 531410}}
[[136234  18913  22363]
 [135091  17498  22895]
 [133474  19125  25817]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016225
{'0': {'precision': 0.324909543724449, 'recall': 0.7196802531329364, 'f1-score': 0.44769915114314013, 'support': 48038}, '1': {'precision': 0.37133149786187103, 'recall': 0.11568151541142763, 'f1-score': 0.1764067457004508, 'support': 54797}, '2': {'precision': 0.33576805545203847, 'recall': 0.18978409689310163, 'f1-score': 0.2425009083691074, 'support': 47475}, 'accuracy': 0.3321202847448606, 'macro avg': {'precision': 0.34400303234611956, 'recall': 0.3417152884791552, 'f1-score': 0.28886893507089945, 'support': 150310}, 'weighted avg': {'precision': 0.3452627581821406, 'recall': 0.3321202847448606, 'f1-score': 0.2839855158777536, 'support': 150310}}
[[34572  5413  8053]
 [38687  6339  9771]
 [33146  5319  9010]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
4353/4353 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0926968
{'0': {'precision': 0.41385366229633647, 'recall': 0.6727371981886846, 'f1-score': 0.512455540274078, 'support': 446968}, '1': {'precision': 0.25886680334608764, 'recall': 0.16722262354990863, 'f1-score': 0.20318920523731868, 'support': 282396}, '2': {'precision': 0.3768485143692158, 'recall': 0.20099292327836144, 'f1-score': 0.26216148445336007, 'support': 384924}, 'accuracy': 0.381662550435794, 'macro avg': {'precision': 0.3498563266705466, 'recall': 0.3469842483389849, 'f1-score': 0.32593540998825227, 'support': 1114288}, 'weighted avg': {'precision': 0.36179186267109287, 'recall': 0.381662550435794, 'f1-score': 0.3476150635824375, 'support': 1114288}}
[[300692  70598  75678]
 [182918  47223  52255]
 [242956  64601  77367]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004554
{'0': {'precision': 0.35858823529411765, 'recall': 0.709972965914465, 'f1-score': 0.47650607689264834, 'support': 141673}, '1': {'precision': 0.2597990939531219, 'recall': 0.13148254292620928, 'f1-score': 0.17460081078845038, 'support': 120381}, '2': {'precision': 0.37539283765219517, 'recall': 0.1505407179889668, 'f1-score': 0.21490131862449366, 'support': 132509}, 'accuracy': 0.3455975344875216, 'macro avg': {'precision': 0.33126005563314487, 'recall': 0.3306654089432137, 'f1-score': 0.28866940210186415, 'support': 394563}, 'weighted avg': {'precision': 0.33409132461089613, 'recall': 0.3455975344875216, 'f1-score': 0.2965382574259362, 'support': 394563}}
[[100584  22925  18164]
 [ 89526  15828  15027]
 [ 90390  22171  19948]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099798
{'0': {'precision': 0.368410377071459, 'recall': 0.8096373726792521, 'f1-score': 0.5063951097449624, 'support': 44867}, '1': {'precision': 0.2536671445902724, 'recall': 0.06765899864682003, 'f1-score': 0.10682520145839625, 'support': 33994}, '2': {'precision': 0.38104980499968033, 'recall': 0.13408625615874373, 'f1-score': 0.19836911299717092, 'support': 44449}, 'accuracy': 0.3615765144757116, 'macro avg': {'precision': 0.33437577555380393, 'recall': 0.33712754249493865, 'f1-score': 0.2705298080668432, 'support': 123310}, 'weighted avg': {'precision': 0.3413341341634714, 'recall': 0.3615765144757116, 'f1-score': 0.28520926113790607, 'support': 123310}}
[[36326  3099  5442]
 [27455  2300  4239]
 [34821  3668  5960]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
5497/5497 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1027411
{'0': {'precision': 0.33100548205780717, 'recall': 0.7817038181892647, 'f1-score': 0.4650778943048507, 'support': 463911}, '1': {'precision': 0.270367617631925, 'recall': 0.06459397132040422, 'f1-score': 0.10427534807143526, 'support': 439267}, '2': {'precision': 0.37839956261098023, 'recall': 0.15516752211704624, 'f1-score': 0.22008599923456176, 'support': 504023}, 'accuracy': 0.3334441916968507, 'macro avg': {'precision': 0.3265908874335708, 'recall': 0.3338217705422384, 'f1-score': 0.26314641387028254, 'support': 1407201}, 'weighted avg': {'precision': 0.3290523096751041, 'recall': 0.3334441916968507, 'f1-score': 0.26470125869606, 'support': 1407201}}
[[362641  38026  63244]
 [345664  28374  65229]
 [387269  38546  78208]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019447
{'0': {'precision': 0.3349780783605301, 'recall': 0.7640004994097884, 'f1-score': 0.46574778496230723, 'support': 176208}, '1': {'precision': 0.3003912276834913, 'recall': 0.060768030319919744, 'f1-score': 0.1010866138812142, 'support': 179420}, '2': {'precision': 0.35273346720516235, 'recall': 0.1826386130517068, 'f1-score': 0.24066533763344858, 'support': 171196}, 'accuracy': 0.33558266138216936, 'macro avg': {'precision': 0.3293675910830613, 'recall': 0.33580238092713827, 'f1-score': 0.26916657882565664, 'support': 526824}, 'weighted avg': {'precision': 0.3289686308034169, 'recall': 0.33558266138216936, 'f1-score': 0.2684129597298178, 'support': 526824}}
[[134623  13111  28474]
 [139616  10903  28901]
 [127647  12282  31267]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036371
{'0': {'precision': 0.328938904428399, 'recall': 0.7946465986869674, 'f1-score': 0.46527866522857037, 'support': 57272}, '1': {'precision': 0.30513281028452593, 'recall': 0.05309734513274336, 'f1-score': 0.090454373502585, 'support': 60794}, '2': {'precision': 0.35366478728857, 'recall': 0.15951487560685007, 'f1-score': 0.21986371880974556, 'support': 56233}, 'accuracy': 0.3310919741363978, 'macro avg': {'precision': 0.32924550066716496, 'recall': 0.3357529398088536, 'f1-score': 0.25853225251363365, 'support': 174299}, 'weighted avg': {'precision': 0.3286126999378017, 'recall': 0.3310919741363978, 'f1-score': 0.25536646450935035, 'support': 174299}}
[[45511  3741  8020]
 [49193  3228  8373]
 [43653  3610  8970]]
testing model on single stock: results/universal/W2/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
14883/14883 - 181s - 181s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046222
{'0': {'precision': 0.3085371495677269, 'recall': 0.7336574540740479, 'f1-score': 0.43439215449426244, 'support': 1161707}, '1': {'precision': 0.37595067930584214, 'recall': 0.10368326934998137, 'f1-score': 0.16253976872995402, 'support': 1455066}, '2': {'precision': 0.33081566555715974, 'recall': 0.1791797345795834, 'f1-score': 0.23245489325357366, 'support': 1193126}, 'accuracy': 0.31941660395721777, 'macro avg': {'precision': 0.33843449814357623, 'recall': 0.3388401526678709, 'f1-score': 0.2764622721592634, 'support': 3809899}, 'weighted avg': {'precision': 0.3412603823175527, 'recall': 0.31941660395721777, 'f1-score': 0.2673274212035408, 'support': 3809899}}
[[ 852295  120422  188990]
 [1060741  150866  243459]
 [ 849338  130004  213784]]
Evaluating performance on  train set...
6147/6147 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015754
{'0': {'precision': 0.33143443049989363, 'recall': 0.7290132718052621, 'f1-score': 0.4556945109927021, 'support': 519221}, '1': {'precision': 0.3238432851868008, 'recall': 0.10149280745229197, 'f1-score': 0.15454961268039244, 'support': 519357}, '2': {'precision': 0.3610504178221139, 'recall': 0.18133619488995284, 'f1-score': 0.24142007710668256, 'support': 534907}, 'accuracy': 0.3357057741255875, 'macro avg': {'precision': 0.33877604450293614, 'recall': 0.33728075804916896, 'f1-score': 0.28388806692659235, 'support': 1573485}, 'weighted avg': {'precision': 0.33899680603839255, 'recall': 0.3357057741255875, 'f1-score': 0.28345352645236316, 'support': 1573485}}
[[378519  54210  86492]
 [381481  52711  85165]
 [382063  55846  96998]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010163
{'0': {'precision': 0.3321842946023205, 'recall': 0.7072771162765467, 'f1-score': 0.45205401085556485, 'support': 184345}, '1': {'precision': 0.3183413745201428, 'recall': 0.11771398903059392, 'f1-score': 0.1718737398990306, 'support': 181049}, '2': {'precision': 0.3732316727628664, 'recall': 0.1895452880540003, 'f1-score': 0.25141151770686937, 'support': 191110}, 'accuracy': 0.3376777166022167, 'macro avg': {'precision': 0.3412524472951099, 'recall': 0.33817879778704696, 'f1-score': 0.2917797561538216, 'support': 556504}, 'weighted avg': {'precision': 0.3417768898079322, 'recall': 0.3376777166022167, 'f1-score': 0.2919991958999549, 'support': 556504}}
[[130383  21935  32027]
 [130933  21312  28804]
 [131186  23700  36224]]
training model: results/universal/W2/deepVOL_L2/h1000
Epoch 1/50
9940/9940 - 622s - loss: 3.2624 - accuracy1000: 0.3810 - val_loss: 3.3302 - val_accuracy1000: 0.3319 - 622s/epoch - 63ms/step
Epoch 2/50
9940/9940 - 624s - loss: 3.2603 - accuracy1000: 0.3838 - val_loss: 3.3168 - val_accuracy1000: 0.3303 - 624s/epoch - 63ms/step
Epoch 3/50
9940/9940 - 635s - loss: 3.2563 - accuracy1000: 0.3858 - val_loss: 3.3159 - val_accuracy1000: 0.3356 - 635s/epoch - 64ms/step
Epoch 4/50
9940/9940 - 639s - loss: 3.2567 - accuracy1000: 0.3863 - val_loss: 3.3179 - val_accuracy1000: 0.3313 - 639s/epoch - 64ms/step
Epoch 5/50
9940/9940 - 636s - loss: 3.2514 - accuracy1000: 0.3915 - val_loss: 3.3289 - val_accuracy1000: 0.3272 - 636s/epoch - 64ms/step
Epoch 6/50
9940/9940 - 627s - loss: 3.2443 - accuracy1000: 0.3955 - val_loss: 3.3216 - val_accuracy1000: 0.3320 - 627s/epoch - 63ms/step
Epoch 7/50
9940/9940 - 624s - loss: 3.2371 - accuracy1000: 0.3994 - val_loss: 3.3461 - val_accuracy1000: 0.3271 - 624s/epoch - 63ms/step
Epoch 8/50
9940/9940 - 620s - loss: 3.2321 - accuracy1000: 0.4017 - val_loss: 3.3406 - val_accuracy1000: 0.3285 - 620s/epoch - 62ms/step
Epoch 9/50
9940/9940 - 620s - loss: 3.2255 - accuracy1000: 0.4053 - val_loss: 3.3654 - val_accuracy1000: 0.3279 - 620s/epoch - 62ms/step
Epoch 10/50
9940/9940 - 619s - loss: 3.2214 - accuracy1000: 0.4088 - val_loss: 3.3532 - val_accuracy1000: 0.3267 - 619s/epoch - 62ms/step
Epoch 11/50
9940/9940 - 616s - loss: 3.2180 - accuracy1000: 0.4101 - val_loss: 3.3607 - val_accuracy1000: 0.3298 - 616s/epoch - 62ms/step
Epoch 12/50
9940/9940 - 617s - loss: 3.2139 - accuracy1000: 0.4122 - val_loss: 3.3736 - val_accuracy1000: 0.3285 - 617s/epoch - 62ms/step
Epoch 13/50
9940/9940 - 616s - loss: 3.2097 - accuracy1000: 0.4142 - val_loss: 3.3697 - val_accuracy1000: 0.3333 - 616s/epoch - 62ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 962s - 962s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030883
{'0': {'precision': 0.33536594194155545, 'recall': 0.25802876155793086, 'f1-score': 0.29165767121803576, 'support': 2154473}, '1': {'precision': 0.3506191150077973, 'recall': 0.6774833611791121, 'f1-score': 0.46209132266683417, 'support': 2367205}, '2': {'precision': 0.35078102637497444, 'recall': 0.07801723530313207, 'f1-score': 0.12764494784782776, 'support': 2199091}, 'accuracy': 0.3468687883782347, 'macro avg': {'precision': 0.34558869444144236, 'recall': 0.337843119346725, 'f1-score': 0.2937979805775659, 'support': 6720769}, 'weighted avg': {'precision': 0.3457823929444161, 'recall': 0.3468687883782347, 'f1-score': 0.2980218965066804, 'support': 6720769}}
[[ 555916 1443318  155239]
 [ 601169 1603742  162294]
 [ 500555 1526969  171567]]
Evaluating performance on  train set...
9940/9940 - 367s - 367s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042194
{'0': {'precision': 0.34191253732171817, 'recall': 0.20369283319179796, 'f1-score': 0.2552948969886719, 'support': 846667}, '1': {'precision': 0.32802919037500644, 'recall': 0.7100860876121666, 'f1-score': 0.4487535620660675, 'support': 844837}, '2': {'precision': 0.35637155187163744, 'recall': 0.08799464864103647, 'f1-score': 0.14113940014531437, 'support': 852120}, 'accuracy': 0.3331266728101323, 'macro avg': {'precision': 0.34210442652278733, 'recall': 0.3339245231483337, 'f1-score': 0.2817292864000179, 'support': 2543624}, 'weighted avg': {'precision': 0.3421451386393099, 'recall': 0.3331266728101323, 'f1-score': 0.28130772603016146, 'support': 2543624}}
[[172460 603679  70528]
 [180036 599907  64894]
 [151902 625236  74982]]
Evaluating performance on  val set...
3393/3393 - 125s - 125s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056459
{'0': {'precision': 0.34383563234406206, 'recall': 0.20408831363954333, 'f1-score': 0.2561407833647968, 'support': 290193}, '1': {'precision': 0.3297783723949001, 'recall': 0.7289032989393124, 'f1-score': 0.454105421990622, 'support': 284061}, '2': {'precision': 0.3706901623911509, 'recall': 0.0857664047264943, 'f1-score': 0.13930246505830296, 'support': 293833}, 'accuracy': 0.3357716450079312, 'macro avg': {'precision': 0.348101389043371, 'recall': 0.33958600576845005, 'f1-score': 0.28318289013790726, 'support': 868087}, 'weighted avg': {'precision': 0.34832553693761936, 'recall': 0.3357716450079312, 'f1-score': 0.28137221711479943, 'support': 868087}}
[[ 59225 207943  23025]
 [ 57250 207053  19758]
 [ 55773 212859  25201]]
testing model out of sample: results/universal/W2/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 519s - 519s/epoch - 36ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1103262
{'0': {'precision': 0.3092839712121992, 'recall': 0.24704863573087016, 'f1-score': 0.2746852590979573, 'support': 1191737}, '1': {'precision': 0.3146013999322966, 'recall': 0.6745907767339409, 'f1-score': 0.42909195553316737, 'support': 1195802}, '2': {'precision': 0.3813098129786697, 'recall': 0.04491500116479596, 'f1-score': 0.08036383676301095, 'support': 1279194}, 'accuracy': 0.3159621930475985, 'macro avg': {'precision': 0.3350650613743886, 'recall': 0.32218480454320236, 'f1-score': 0.2613803504647119, 'support': 3666733}, 'weighted avg': {'precision': 0.3361453806824192, 'recall': 0.3159621930475985, 'f1-score': 0.2572487669640298, 'support': 3666733}}
[[294417 846592  50728]
 [346630 806677  42495]
 [310884 910855  57455]]
Evaluating performance on  train set...
5373/5373 - 197s - 197s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069268
{'0': {'precision': 0.32411536069243707, 'recall': 0.26535826094056525, 'f1-score': 0.2918084382443008, 'support': 465401}, '1': {'precision': 0.32189578304942645, 'recall': 0.6597587224211925, 'f1-score': 0.43268491998749414, 'support': 456238}, '2': {'precision': 0.3655070293086428, 'recall': 0.04737971949441041, 'f1-score': 0.08388557187694701, 'support': 453253}, 'accuracy': 0.32437456905706047, 'macro avg': {'precision': 0.33717272435016876, 'recall': 0.3241655676187227, 'f1-score': 0.26945964336958067, 'support': 1374892}, 'weighted avg': {'precision': 0.3370241872116177, 'recall': 0.32437456905706047, 'f1-score': 0.27001148352200177, 'support': 1374892}}
[[123498 320898  21005]
 [138957 301007  16274]
 [118576 313202  21475]]
Evaluating performance on  val set...
1685/1685 - 62s - 62s/epoch - 37ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077616
{'0': {'precision': 0.31631961098890193, 'recall': 0.2680392143122429, 'f1-score': 0.2901849217638691, 'support': 142703}, '1': {'precision': 0.32961584851249354, 'recall': 0.6649549201797679, 'f1-score': 0.4407523066977044, 'support': 145076}, '2': {'precision': 0.3480297441302184, 'recall': 0.041597559012687815, 'f1-score': 0.07431300477583577, 'support': 142893}, 'accuracy': 0.32661282832410743, 'macro avg': {'precision': 0.3313217345438713, 'recall': 0.3248638978348995, 'f1-score': 0.26841674441246977, 'support': 430672}, 'weighted avg': {'precision': 0.33131970621202933, 'recall': 0.32661282832410743, 'f1-score': 0.2692806793299288, 'support': 430672}}
[[38250 98206  6247]
 [43719 96469  4888]
 [38953 97996  5944]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108165
{'0': {'precision': 0.2879958784131891, 'recall': 0.08327850128493215, 'f1-score': 0.12919752313633343, 'support': 80549}, '1': {'precision': 0.35240676447530517, 'recall': 0.8916318133904587, 'f1-score': 0.5051564928143021, 'support': 88227}, '2': {'precision': 0.31733021077283374, 'recall': 0.022659133530023055, 'f1-score': 0.04229795868312207, 'support': 83719}, 'accuracy': 0.34563456702112916, 'macro avg': {'precision': 0.319244284553776, 'recall': 0.33252314940180466, 'f1-score': 0.22555065821125253, 'support': 252495}, 'weighted avg': {'precision': 0.3202286759553955, 'recall': 0.34563456702112916, 'f1-score': 0.2317523752376413, 'support': 252495}}
[[ 6708 71810  2031]
 [ 7511 78666  2050]
 [ 9073 72749  1897]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080514
{'0': {'precision': 0.3592814371257485, 'recall': 0.09186163341466916, 'f1-score': 0.14631358353972185, 'support': 20901}, '1': {'precision': 0.32641894803905036, 'recall': 0.8987256874580818, 'f1-score': 0.47890034364261175, 'support': 19383}, '2': {'precision': 0.33150984682713347, 'recall': 0.029918538632436435, 'f1-score': 0.054883847303355514, 'support': 20255}, 'accuracy': 0.32947356249690285, 'macro avg': {'precision': 0.3390700773306441, 'recall': 0.34016861983506247, 'f1-score': 0.22669925816189637, 'support': 60539}, 'weighted avg': {'precision': 0.33946797493664865, 'recall': 0.32947356249690285, 'f1-score': 0.2222087893344445, 'support': 60539}}
[[ 1920 18374   607]
 [ 1348 17420   615]
 [ 2076 17573   606]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034017
{'0': {'precision': 0.39344262295081966, 'recall': 0.04112297350731514, 'f1-score': 0.07446300715990453, 'support': 7587}, '1': {'precision': 0.3490824292811518, 'recall': 0.9276572814226054, 'f1-score': 0.5072746694169215, 'support': 7423}, '2': {'precision': 0.23404255319148937, 'recall': 0.03839150227617603, 'f1-score': 0.06596271672532916, 'support': 6590}, 'accuracy': 0.3449537037037037, 'macro avg': {'precision': 0.32552253514115365, 'recall': 0.33572391906869886, 'f1-score': 0.21590013110071837, 'support': 21600}, 'weighted avg': {'precision': 0.3295661332598969, 'recall': 0.3449537037037037, 'f1-score': 0.22060856526036676, 'support': 21600}}
[[ 312 6819  456]
 [ 165 6886  372]
 [ 316 6021  253]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041971
{'0': {'precision': 0.3085697100396834, 'recall': 0.4767068955748201, 'f1-score': 0.37463820388825064, 'support': 88245}, '1': {'precision': 0.38797736026142143, 'recall': 0.5456652795775951, 'f1-score': 0.45350494016282134, 'support': 124241}, '2': {'precision': 0.38972226347839, 'recall': 0.02491620217826859, 'f1-score': 0.046837905860093176, 'support': 105313}, 'accuracy': 0.35395013829496, 'macro avg': {'precision': 0.36208977792649827, 'recall': 0.3490961257768946, 'f1-score': 0.2916603499703884, 'support': 317799}, 'weighted avg': {'precision': 0.36650603058030645, 'recall': 0.35395013829496, 'f1-score': 0.2968432750031679, 'support': 317799}}
[[42067 44729  1449]
 [53787 67794  2660]
 [40475 62214  2624]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066529
{'0': {'precision': 0.33249176728869373, 'recall': 0.39008370895041855, 'f1-score': 0.3589925925925926, 'support': 46590}, '1': {'precision': 0.30291797601487847, 'recall': 0.5296479031172908, 'f1-score': 0.38541063196116027, 'support': 44590}, '2': {'precision': 0.37134119702927043, 'recall': 0.01943567933415649, 'f1-score': 0.03693805271277405, 'support': 43734}, 'accuracy': 0.31606060156840654, 'macro avg': {'precision': 0.33558364677761415, 'recall': 0.31305576380062194, 'f1-score': 0.2604470924221756, 'support': 134914}, 'weighted avg': {'precision': 0.33531093807434204, 'recall': 0.31606060156840654, 'f1-score': 0.26332607264907637, 'support': 134914}}
[[18174 27533   883]
 [20417 23617   556]
 [16069 26815   850]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0926124
{'0': {'precision': 0.32965338596274824, 'recall': 0.3733584800223526, 'f1-score': 0.3501473960039306, 'support': 14316}, '1': {'precision': 0.39527128137158496, 'recall': 0.5868350895010791, 'f1-score': 0.4723705387936541, 'support': 15754}, '2': {'precision': 0.20262096774193547, 'recall': 0.019097387173396676, 'f1-score': 0.03490492315707215, 'support': 10525}, 'accuracy': 0.3643552161596256, 'macro avg': {'precision': 0.30918187835875627, 'recall': 0.3264303188989428, 'f1-score': 0.2858076193182189, 'support': 40595}, 'weighted avg': {'precision': 0.32218271525198977, 'recall': 0.3643552161596256, 'f1-score': 0.3158470231697421, 'support': 40595}}
[[5345 8484  487]
 [6205 9245  304]
 [4664 5660  201]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1260352
{'0': {'precision': 0.29294146688544587, 'recall': 0.24234488557871345, 'f1-score': 0.26525191963816136, 'support': 83245}, '1': {'precision': 0.2845708144716098, 'recall': 0.6996921389487853, 'f1-score': 0.40459099099099094, 'support': 80231}, '2': {'precision': 0.4177293549585242, 'recall': 0.03046858773490342, 'f1-score': 0.056794653828673394, 'support': 110737}, 'accuracy': 0.2905952671828104, 'macro avg': {'precision': 0.33174721210519326, 'recall': 0.32416853742080076, 'f1-score': 0.24221252148594194, 'support': 274213}, 'weighted avg': {'precision': 0.3408861323379736, 'recall': 0.2905952671828104, 'f1-score': 0.22183815293039624, 'support': 274213}}
[[20174 60581  2490]
 [21881 56137  2213]
 [26812 80551  3374]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075196
{'0': {'precision': 0.296636691359981, 'recall': 0.3080467335856508, 'f1-score': 0.3022340618756433, 'support': 24308}, '1': {'precision': 0.3215122637087955, 'recall': 0.5671653543307087, 'f1-score': 0.4103864287036905, 'support': 25400}, '2': {'precision': 0.3034159410582719, 'recall': 0.03883744855967078, 'f1-score': 0.06886068252641178, 'support': 23328}, 'accuracy': 0.31217481789802287, 'macro avg': {'precision': 0.30718829870901615, 'recall': 0.3046831788253434, 'f1-score': 0.26049372436858187, 'support': 73036}, 'weighted avg': {'precision': 0.30745308155963075, 'recall': 0.31217481789802287, 'f1-score': 0.2653061896478861, 'support': 73036}}
[[ 7488 15631  1189]
 [10103 14406   891]
 [ 7652 14770   906]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1229123
{'0': {'precision': 0.3107465747040731, 'recall': 0.3360548331821389, 'f1-score': 0.3229055690072639, 'support': 9921}, '1': {'precision': 0.27894912985274434, 'recall': 0.5636834986474302, 'f1-score': 0.3732089552238806, 'support': 8872}, '2': {'precision': 0.3576388888888889, 'recall': 0.0374001452432825, 'f1-score': 0.06771860618014465, 'support': 11016}, 'accuracy': 0.29343486866382634, 'macro avg': {'precision': 0.3157781978152354, 'recall': 0.3123794923576172, 'f1-score': 0.25461104347042973, 'support': 29809}, 'weighted avg': {'precision': 0.31861194430181006, 'recall': 0.29343486866382634, 'f1-score': 0.24357221532248002, 'support': 29809}}
[[3334 6139  448]
 [3579 5001  292]
 [3816 6788  412]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1260422
{'0': {'precision': 0.27023498694516973, 'recall': 0.003032300593276203, 'f1-score': 0.0059973055583723255, 'support': 68265}, '1': {'precision': 0.2745348646131936, 'recall': 0.9963224331577378, 'f1-score': 0.4304578409831021, 'support': 60366}, '2': {'precision': 0.4215686274509804, 'recall': 0.00047090775683637597, 'f1-score': 0.0009407646447519552, 'support': 91313}, 'accuracy': 0.27458807696504567, 'macro avg': {'precision': 0.3221128263364479, 'recall': 0.3332752138359501, 'f1-score': 0.14579863706207544, 'support': 219944}, 'weighted avg': {'precision': 0.3342435306236288, 'recall': 0.27458807696504567, 'f1-score': 0.12039577408219575, 'support': 219944}}
[[  207 68032    26]
 [  189 60144    33]
 [  370 90900    43]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050454
{'0': {'precision': 0.36220472440944884, 'recall': 0.0066153735528870355, 'f1-score': 0.012993432667184522, 'support': 27814}, '1': {'precision': 0.3302562332844448, 'recall': 0.9928857269897733, 'f1-score': 0.49564855491329485, 'support': 26988}, '2': {'precision': 0.24324324324324326, 'recall': 0.0003348214285714286, 'f1-score': 0.0006687223687632351, 'support': 26880}, 'accuracy': 0.33041551382189466, 'macro avg': {'precision': 0.31190140031237895, 'recall': 0.33327864065707724, 'f1-score': 0.16977023664974755, 'support': 81682}, 'weighted avg': {'precision': 0.31250086686152867, 'recall': 0.33041551382189466, 'f1-score': 0.16840843507109798, 'support': 81682}}
[[  184 27616    14]
 [  178 26796    14]
 [  146 26725     9]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088411
{'0': {'precision': 0.3888888888888889, 'recall': 0.003910177633783935, 'f1-score': 0.007742506359915939, 'support': 8951}, '1': {'precision': 0.3015285599356396, 'recall': 0.9953525428229982, 'f1-score': 0.46284461733197496, 'support': 7531}, '2': {'precision': 0.18181818181818182, 'recall': 0.00023587687227267368, 'f1-score': 0.00047114252061248533, 'support': 8479}, 'accuracy': 0.30179079363807537, 'macro avg': {'precision': 0.29074521021423677, 'recall': 0.333166199109685, 'f1-score': 0.15701942207083444, 'support': 24961}, 'weighted avg': {'precision': 0.29219151448083447, 'recall': 0.30179079363807537, 'f1-score': 0.14258165958843733, 'support': 24961}}
[[  35 8912    4]
 [  30 7496    5]
 [  25 8452    2]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107733
{'0': {'precision': 0.3384062765856886, 'recall': 0.3314446542976706, 'f1-score': 0.3348892900908317, 'support': 162018}, '1': {'precision': 0.3020351782532065, 'recall': 0.6011619914666252, 'f1-score': 0.4020651865151387, 'support': 154218}, '2': {'precision': 0.383601696660215, 'recall': 0.05363219198194412, 'f1-score': 0.0941070688906176, 'support': 173683}, 'accuracy': 0.31785866643261435, 'macro avg': {'precision': 0.3413477171663701, 'recall': 0.32874627924874666, 'f1-score': 0.27702051516552934, 'support': 489919}, 'weighted avg': {'precision': 0.342979681785661, 'recall': 0.31785866643261435, 'f1-score': 0.2706744992173342, 'support': 489919}}
[[ 53700 100859   7459]
 [ 53999  92710   7509]
 [ 50986 113382   9315]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045955
{'0': {'precision': 0.3332263190843861, 'recall': 0.3323779941078519, 'f1-score': 0.33280161599320257, 'support': 62456}, '1': {'precision': 0.3252715003540382, 'recall': 0.6107124551512045, 'f1-score': 0.4244674396468709, 'support': 62432}, '2': {'precision': 0.31931595178020744, 'recall': 0.01957212818970702, 'f1-score': 0.036883520611379166, 'support': 58195}, 'accuracy': 0.32786222642189605, 'macro avg': {'precision': 0.32593792373954394, 'recall': 0.32088752581625446, 'f1-score': 0.2647175254171508, 'support': 183083}, 'weighted avg': {'precision': 0.32609212820789973, 'recall': 0.32786222642189605, 'f1-score': 0.26999910096778024, 'support': 183083}}
[[20759 40350  1347]
 [23223 38128  1081]
 [18315 38741  1139]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1154042
{'0': {'precision': 0.3403793736441008, 'recall': 0.3284663696387353, 'f1-score': 0.3343167786701634, 'support': 18629}, '1': {'precision': 0.2965948810463412, 'recall': 0.6348880709587884, 'f1-score': 0.4043113220234779, 'support': 16573}, '2': {'precision': 0.3980016652789342, 'recall': 0.024573308657207485, 'f1-score': 0.04628867476879872, 'support': 19452}, 'accuracy': 0.3132250155523841, 'macro avg': {'precision': 0.3449919733231254, 'recall': 0.3293092497515771, 'f1-score': 0.26163892515414666, 'support': 54654}, 'weighted avg': {'precision': 0.34761083741725757, 'recall': 0.3132250155523841, 'f1-score': 0.25302898436242993, 'support': 54654}}
[[ 6119 12104   406]
 [ 5734 10522   317]
 [ 6124 12850   478]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
4918/4918 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1147621
{'0': {'precision': 0.34090993599107594, 'recall': 0.6200143946749364, 'f1-score': 0.4399286413232545, 'support': 414042}, '1': {'precision': 0.3105648646922307, 'recall': 0.35430127376776815, 'f1-score': 0.33099452892228165, 'support': 411692}, '2': {'precision': 0.38128302304351436, 'recall': 0.03182369171448032, 'f1-score': 0.0587443047901563, 'support': 433105}, 'accuracy': 0.3307476174475052, 'macro avg': {'precision': 0.34425260790894036, 'recall': 0.3353797867190616, 'f1-score': 0.2765558250118975, 'support': 1258839}, 'weighted avg': {'precision': 0.34487625954371626, 'recall': 0.3307476174475052, 'f1-score': 0.2731558096293295, 'support': 1258839}}
[[256712 146099  11231]
 [254694 145863  11135]
 [241614 177708  13783]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1085393
{'0': {'precision': 0.34253168771253956, 'recall': 0.5987562457911059, 'f1-score': 0.43577099014933324, 'support': 120281}, '1': {'precision': 0.31026602977084566, 'recall': 0.36116842759477935, 'f1-score': 0.33378773722180527, 'support': 120675}, '2': {'precision': 0.38499757634512843, 'recall': 0.026918253914458075, 'f1-score': 0.050318350280338306, 'support': 118024}, 'accuracy': 0.3308819432837484, 'macro avg': {'precision': 0.34593176460950453, 'recall': 0.3289476424334478, 'f1-score': 0.27329235921715894, 'support': 358980}, 'weighted avg': {'precision': 0.34564700268233944, 'recall': 0.3308819432837484, 'f1-score': 0.27476065137021544, 'support': 358980}}
[[72019 45477  2785]
 [74801 43584  2290]
 [63435 51412  3177]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1191785
{'0': {'precision': 0.3646948356807512, 'recall': 0.5854144927536232, 'f1-score': 0.4494170004450378, 'support': 43125}, '1': {'precision': 0.29350158473925625, 'recall': 0.41251175917215427, 'f1-score': 0.34297610968610176, 'support': 36142}, '2': {'precision': 0.38961038961038963, 'recall': 0.024165707710011506, 'f1-score': 0.045508722505146815, 'support': 43450}, 'accuracy': 0.33577254985046895, 'macro avg': {'precision': 0.349268936676799, 'recall': 0.3406973198785963, 'f1-score': 0.2793006108787621, 'support': 122717}, 'weighted avg': {'precision': 0.35254912109121, 'recall': 0.33577254985046895, 'f1-score': 0.27505809866046244, 'support': 122717}}
[[25246 16901   978]
 [20566 14909   667]
 [23413 18987  1050]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056329
{'0': {'precision': 0.32410622126301963, 'recall': 0.27680785287039217, 'f1-score': 0.298595593185706, 'support': 411773}, '1': {'precision': 0.3311199032602698, 'recall': 0.6623097877136953, 'f1-score': 0.4415087546277816, 'support': 425840}, '2': {'precision': 0.31183149997465404, 'recall': 0.03035589155473091, 'f1-score': 0.05532596133523404, 'support': 405292}, 'accuracy': 0.3285230970991347, 'macro avg': {'precision': 0.32235254149931447, 'recall': 0.32315784404627285, 'f1-score': 0.2651434363829072, 'support': 1242905}, 'weighted avg': {'precision': 0.3225066299839635, 'recall': 0.3285230970991347, 'f1-score': 0.26823358244196616, 'support': 1242905}}
[[113982 283341  14450]
 [131101 282038  12701]
 [106598 286391  12303]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1100894
{'0': {'precision': 0.3241852050047142, 'recall': 0.28893279734732347, 'f1-score': 0.3055455484304825, 'support': 176124}, '1': {'precision': 0.32417812229874804, 'recall': 0.6626615900230273, 'f1-score': 0.4353703793856282, 'support': 175444}, '2': {'precision': 0.38233805668016196, 'recall': 0.03360727749913813, 'f1-score': 0.061783797597751086, 'support': 179842}, 'accuracy': 0.32591031407011534, 'macro avg': {'precision': 0.34356712799454137, 'recall': 0.3284005549564963, 'f1-score': 0.26756657513795395, 'support': 531410}, 'weighted avg': {'precision': 0.3438631985177274, 'recall': 0.32591031407011534, 'f1-score': 0.26591209563289586, 'support': 531410}}
[[ 50888 119930   5306]
 [ 54726 116260   4458]
 [ 51358 122440   6044]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041889
{'0': {'precision': 0.3030001340200264, 'recall': 0.3355311976593805, 'f1-score': 0.3184369906839172, 'support': 47167}, '1': {'precision': 0.36350275436945556, 'recall': 0.616674738560333, 'f1-score': 0.4573926000824874, 'support': 55749}, '2': {'precision': 0.32981153626499143, 'recall': 0.02437017343967591, 'f1-score': 0.045386670858220686, 'support': 47394}, 'accuracy': 0.34169383274565895, 'macro avg': {'precision': 0.33210480821815774, 'recall': 0.32552536988646313, 'f1-score': 0.27373875387487506, 'support': 150310}, 'weighted avg': {'precision': 0.3338940211856055, 'recall': 0.34169383274565895, 'f1-score': 0.2838796718797247, 'support': 150310}}
[[15826 30113  1228]
 [20251 34379  1119]
 [16154 30085  1155]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
4353/4353 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992008
{'0': {'precision': 0.3530746516350934, 'recall': 0.3505465529911031, 'f1-score': 0.3518060606060606, 'support': 393283}, '1': {'precision': 0.3377101165271765, 'recall': 0.6076300979067323, 'f1-score': 0.4341354107999782, 'support': 386286}, '2': {'precision': 0.3385550538381382, 'recall': 0.02911994837460676, 'f1-score': 0.05362728295585529, 'support': 334719}, 'accuracy': 0.3431159628390506, 'macro avg': {'precision': 0.34311327400013597, 'recall': 0.3290988664241474, 'f1-score': 0.2798562514539647, 'support': 1114288}, 'weighted avg': {'precision': 0.34338677016845653, 'recall': 0.3431159628390506, 'f1-score': 0.29077746933765297, 'support': 1114288}}
[[137864 244205  11214]
 [143738 234719   7829]
 [108865 216107   9747]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033645
{'0': {'precision': 0.3582699076441744, 'recall': 0.3480379621985344, 'f1-score': 0.35307982226306994, 'support': 136873}, '1': {'precision': 0.32292761729261965, 'recall': 0.6081267007062708, 'f1-score': 0.42184629333587836, 'support': 130828}, '2': {'precision': 0.36459154189650644, 'recall': 0.04376409011366682, 'f1-score': 0.07814765289605179, 'support': 126862}, 'accuracy': 0.33644563732534477, 'macro avg': {'precision': 0.3485963556111002, 'recall': 0.3333095843394907, 'f1-score': 0.28435792283166667, 'support': 394563}, 'weighted avg': {'precision': 0.34858378401475687, 'recall': 0.33644563732534477, 'f1-score': 0.28748354234649065, 'support': 394563}}
[[47637 84344  4892]
 [46484 79560  4784]
 [38843 82467  5552]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112592
{'0': {'precision': 0.33568493489776724, 'recall': 0.32500898741761536, 'f1-score': 0.3302607065012238, 'support': 41725}, '1': {'precision': 0.324174274284542, 'recall': 0.6365627675109522, 'f1-score': 0.4295811740718715, 'support': 39718}, '2': {'precision': 0.3491869918699187, 'recall': 0.04103470513769795, 'f1-score': 0.07343920319746938, 'support': 41867}, 'accuracy': 0.3289433135998702, 'macro avg': {'precision': 0.336348733684076, 'recall': 0.33420215335542186, 'f1-score': 0.2777603612568549, 'support': 123310}, 'weighted avg': {'precision': 0.3365616699639985, 'recall': 0.3289433135998702, 'f1-score': 0.275054027822712, 'support': 123310}}
[[13561 26425  1739]
 [12972 25283  1463]
 [13865 26284  1718]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
5497/5497 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1116774
{'0': {'precision': 0.28638492277041805, 'recall': 0.2202962884672973, 'f1-score': 0.24903049159925322, 'support': 454152}, '1': {'precision': 0.30160614269874214, 'recall': 0.6640829357502805, 'f1-score': 0.414815694105982, 'support': 447286}, '2': {'precision': 0.42075634510813736, 'recall': 0.060737934566190095, 'f1-score': 0.10615233632587617, 'support': 505763}, 'accuracy': 0.3040091642913841, 'macro avg': {'precision': 0.3362491368590992, 'recall': 0.31503905292792267, 'f1-score': 0.25666617401037045, 'support': 1407201}, 'weighted avg': {'precision': 0.3395175827476724, 'recall': 0.3040091642913841, 'f1-score': 0.2503742339948994, 'support': 1407201}}
[[100048 329862  24242]
 [132203 297035  18048]
 [117097 357947  30719]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040155
{'0': {'precision': 0.3249994298789063, 'recall': 0.2354139594299936, 'f1-score': 0.2730463049593982, 'support': 181612}, '1': {'precision': 0.31785264265636465, 'recall': 0.6612263004165251, 'f1-score': 0.42932702918039783, 'support': 173579}, '2': {'precision': 0.3755047106325707, 'recall': 0.07477582982293615, 'f1-score': 0.12471636598626896, 'support': 171633}, 'accuracy': 0.32337744673743035, 'macro avg': {'precision': 0.33945226105594717, 'recall': 0.3238053632231516, 'f1-score': 0.2756965667086883, 'support': 526824}, 'weighted avg': {'precision': 0.3390987128885872, 'recall': 0.32337744673743035, 'f1-score': 0.276213851262873, 'support': 526824}}
[[ 42754 126521  12337]
 [ 49797 114775   9007]
 [ 39000 119799  12834]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065198
{'0': {'precision': 0.3229374479153514, 'recall': 0.21528981969393424, 'f1-score': 0.25834865350815167, 'support': 59399}, '1': {'precision': 0.3170624168283337, 'recall': 0.7005260454489098, 'f1-score': 0.4365428446862876, 'support': 56459}, '2': {'precision': 0.3594095199839325, 'recall': 0.061241251860851116, 'f1-score': 0.10465065278732145, 'support': 58441}, 'accuracy': 0.3208165279204126, 'macro avg': {'precision': 0.3331364615758725, 'recall': 0.3256857056678984, 'f1-score': 0.26651405032725356, 'support': 174299}, 'weighted avg': {'precision': 0.3332631869248581, 'recall': 0.3208165279204126, 'f1-score': 0.26453572847473406, 'support': 174299}}
[[12788 42995  3616]
 [14145 39551  2763]
 [12666 42196  3579]]
testing model on single stock: results/universal/W2/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
14883/14883 - 205s - 205s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989695
{'0': {'precision': 0.3154838077221653, 'recall': 0.10000856683559571, 'f1-score': 0.15187322512819892, 'support': 1190638}, '1': {'precision': 0.36310433346581056, 'recall': 0.7904876428189683, 'f1-score': 0.4976274012985755, 'support': 1384620}, '2': {'precision': 0.34794504821674577, 'recall': 0.11783182317774965, 'f1-score': 0.17604566441567496, 'support': 1234641}, 'accuracy': 0.3567231047332226, 'macro avg': {'precision': 0.34217772980157385, 'recall': 0.3361093442774379, 'f1-score': 0.27518209694748313, 'support': 3809899}, 'weighted avg': {'precision': 0.3433098237873249, 'recall': 0.3567231047332226, 'f1-score': 0.28536296646343, 'support': 3809899}}
[[ 119074  939967  131597]
 [ 149060 1094525  141035]
 [ 109299  979862  145480]]
Evaluating performance on  train set...
6147/6147 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032026
{'0': {'precision': 0.32661835155386315, 'recall': 0.06710618529282152, 'f1-score': 0.11133729076145597, 'support': 515109}, '1': {'precision': 0.3323438482682193, 'recall': 0.8173360728003128, 'f1-score': 0.4725430283420549, 'support': 521756}, '2': {'precision': 0.35570997273609295, 'recall': 0.12229510640676829, 'f1-score': 0.18201308255432921, 'support': 536620}, 'accuracy': 0.33469845597511255, 'macro avg': {'precision': 0.3382240575193918, 'recall': 0.33557912149996755, 'f1-score': 0.25529780055261336, 'support': 1573485}, 'weighted avg': {'precision': 0.3384382659620106, 'recall': 0.33469845597511255, 'f1-score': 0.2552136570496599, 'support': 1573485}}
[[ 34567 418967  61575]
 [ 38014 426450  57292]
 [ 33252 437742  65626]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017959
{'0': {'precision': 0.32229681287883727, 'recall': 0.0814769656626903, 'f1-score': 0.130071677516933, 'support': 182076}, '1': {'precision': 0.33288867517721693, 'recall': 0.812406714400052, 'f1-score': 0.4722641814903827, 'support': 184916}, '2': {'precision': 0.3752196242735505, 'recall': 0.11719574486048377, 'f1-score': 0.17860589294904786, 'support': 189512}, 'accuracy': 0.3365151014188577, 'macro avg': {'precision': 0.3434683707765349, 'recall': 0.3370264749744087, 'f1-score': 0.26031391731878784, 'support': 556504}, 'weighted avg': {'precision': 0.3438386394277966, 'recall': 0.3365151014188577, 'f1-score': 0.2603037788131059, 'support': 556504}}
[[ 14835 147331  19910]
 [ 17617 150227  17072]
 [ 13577 153725  22210]]
training model: results/universal/W2/deepVOL_L3/h300
Epoch 1/50
9940/9940 - 816s - loss: 3.2593 - accuracy300: 0.3804 - val_loss: 3.3013 - val_accuracy300: 0.3370 - 816s/epoch - 82ms/step
Epoch 2/50
9940/9940 - 810s - loss: 3.2596 - accuracy300: 0.3809 - val_loss: 3.3049 - val_accuracy300: 0.3386 - 810s/epoch - 81ms/step
Epoch 3/50
9940/9940 - 816s - loss: 3.2379 - accuracy300: 0.3969 - val_loss: 3.2978 - val_accuracy300: 0.3397 - 816s/epoch - 82ms/step
Epoch 4/50
9940/9940 - 811s - loss: 3.2184 - accuracy300: 0.4096 - val_loss: 3.3219 - val_accuracy300: 0.3394 - 811s/epoch - 82ms/step
Epoch 5/50
9940/9940 - 816s - loss: 3.2088 - accuracy300: 0.4146 - val_loss: 3.3403 - val_accuracy300: 0.3278 - 816s/epoch - 82ms/step
Epoch 6/50
9940/9940 - 815s - loss: 3.2041 - accuracy300: 0.4175 - val_loss: 3.3313 - val_accuracy300: 0.3293 - 815s/epoch - 82ms/step
Epoch 7/50
9940/9940 - 817s - loss: 3.1993 - accuracy300: 0.4201 - val_loss: 3.3438 - val_accuracy300: 0.3200 - 817s/epoch - 82ms/step
Epoch 8/50
9940/9940 - 823s - loss: 3.1962 - accuracy300: 0.4218 - val_loss: 3.3688 - val_accuracy300: 0.3160 - 823s/epoch - 83ms/step
Epoch 9/50
9940/9940 - 821s - loss: 3.1930 - accuracy300: 0.4236 - val_loss: 3.3567 - val_accuracy300: 0.3164 - 821s/epoch - 83ms/step
Epoch 10/50
9940/9940 - 820s - loss: 3.1901 - accuracy300: 0.4252 - val_loss: 3.3661 - val_accuracy300: 0.3227 - 820s/epoch - 83ms/step
Epoch 11/50
9940/9940 - 814s - loss: 3.1875 - accuracy300: 0.4266 - val_loss: 3.3640 - val_accuracy300: 0.3250 - 814s/epoch - 82ms/step
Epoch 12/50
9940/9940 - 821s - loss: 3.1851 - accuracy300: 0.4277 - val_loss: 3.3640 - val_accuracy300: 0.3315 - 821s/epoch - 83ms/step
Epoch 13/50
9940/9940 - 820s - loss: 3.1821 - accuracy300: 0.4293 - val_loss: 3.3613 - val_accuracy300: 0.3315 - 820s/epoch - 83ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1277s - 1277s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098658
{'0': {'precision': 0.33711742217306606, 'recall': 0.5485132288583413, 'f1-score': 0.4175857407943109, 'support': 2202760}, '1': {'precision': 0.3168368170446292, 'recall': 0.1373947690299415, 'f1-score': 0.19167192521429852, 'support': 2285924}, '2': {'precision': 0.3623249607191415, 'recall': 0.34826137893494197, 'f1-score': 0.3551540000164476, 'support': 2232085}, 'accuracy': 0.3421730459713762, 'macro avg': {'precision': 0.33875973331227893, 'recall': 0.3447231256077416, 'f1-score': 0.32147055534168567, 'support': 6720769}, 'weighted avg': {'precision': 0.33859127831631397, 'recall': 0.3421730459713762, 'f1-score': 0.3200113761523955, 'support': 6720769}}
[[1208243  322782  671735]
 [1275487  314074  696363]
 [1100312  354424  777349]]
Evaluating performance on  train set...
9940/9940 - 486s - 486s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984396
{'0': {'precision': 0.3373814412033743, 'recall': 0.48929461305070215, 'f1-score': 0.39937995270238397, 'support': 848031}, '1': {'precision': 0.2948509832563656, 'recall': 0.15344451845135185, 'f1-score': 0.20184573330909134, 'support': 839261}, '2': {'precision': 0.3687071401367867, 'recall': 0.37760004297398675, 'f1-score': 0.37310060819768787, 'support': 856332}, 'accuracy': 0.3408789978393033, 'macro avg': {'precision': 0.33364652153217556, 'recall': 0.3401130581586802, 'f1-score': 0.32477543140305437, 'support': 2543624}, 'weighted avg': {'precision': 0.33389470092728885, 'recall': 0.3408789978393033, 'f1-score': 0.32535697991213286, 'support': 2543624}}
[[414937 148276 284818]
 [441664 128780 268817]
 [373274 159707 323351]]
Evaluating performance on  val set...
3393/3393 - 166s - 166s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994433
{'0': {'precision': 0.335611349015467, 'recall': 0.4682077179869264, 'f1-score': 0.39097311896080666, 'support': 293263}, '1': {'precision': 0.2877469527600784, 'recall': 0.16778053249973052, 'f1-score': 0.21196673536274252, 'support': 278310}, '2': {'precision': 0.37433472315382516, 'recall': 0.3745455526551866, 'f1-score': 0.37444010822748, 'support': 296514}, 'accuracy': 0.33989795953631374, 'macro avg': {'precision': 0.3325643416431235, 'recall': 0.3368446010472812, 'f1-score': 0.325793320850343, 'support': 868087}, 'weighted avg': {'precision': 0.33349276232706365, 'recall': 0.33989795953631374, 'f1-score': 0.32793619321055484, 'support': 868087}}
[[137308  56294  99661]
 [145653  46695  85962]
 [126167  59289 111058]]
testing model out of sample: results/universal/W2/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 697s - 697s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992613
{'0': {'precision': 0.35033992545853176, 'recall': 0.5076373207818912, 'f1-score': 0.4145695515865942, 'support': 1248409}, '1': {'precision': 0.284969892324273, 'recall': 0.15460403090185237, 'f1-score': 0.2004554488385127, 'support': 1118509}, '2': {'precision': 0.382138075196745, 'recall': 0.36778233825582873, 'f1-score': 0.3748228006899797, 'support': 1299815}, 'accuracy': 0.3503702069389836, 'macro avg': {'precision': 0.33914929765984986, 'recall': 0.34334122997985744, 'f1-score': 0.3299492670383622, 'support': 3666733}, 'weighted avg': {'precision': 0.34167137544712084, 'recall': 0.3503702069389836, 'f1-score': 0.33516590426148574, 'support': 3666733}}
[[633739 207348 407322]
 [579969 172926 365614]
 [595218 226548 478049]]
Evaluating performance on  train set...
5373/5373 - 270s - 270s/epoch - 50ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098787
{'0': {'precision': 0.3483171369211179, 'recall': 0.5602889176369125, 'f1-score': 0.4295772203165682, 'support': 463800}, '1': {'precision': 0.31173668081447375, 'recall': 0.1385855856056077, 'f1-score': 0.19187241532099253, 'support': 449953}, '2': {'precision': 0.36270991182595597, 'recall': 0.33728225112167914, 'f1-score': 0.34953424349682566, 'support': 461139}, 'accuracy': 0.3474840205630697, 'macro avg': {'precision': 0.3409212431871826, 'recall': 0.3453855847880664, 'f1-score': 0.32366129304479546, 'support': 1374892}, 'weighted avg': {'precision': 0.34117300040733295, 'recall': 0.3474840205630697, 'f1-score': 0.3249385080323644, 'support': 1374892}}
[[259862  66800 137138]
 [251457  62357 136139]
 [234731  70874 155534]]
Evaluating performance on  val set...
1685/1685 - 83s - 83s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986385
{'0': {'precision': 0.3496745110918162, 'recall': 0.5338030877424317, 'f1-score': 0.4225513673961439, 'support': 145608}, '1': {'precision': 0.30536907475827374, 'recall': 0.13871391638456815, 'f1-score': 0.19077037917368522, 'support': 140022}, '2': {'precision': 0.36381970632519717, 'recall': 0.3631775623612471, 'f1-score': 0.36349835074595965, 'support': 145042}, 'accuracy': 0.34788655868038787, 'macro avg': {'precision': 0.3396210973917624, 'recall': 0.34523152216274894, 'f1-score': 0.3256066991052629, 'support': 430672}, 'weighted avg': {'precision': 0.3400335583499262, 'recall': 0.34788655868038787, 'f1-score': 0.3273057856683763, 'support': 430672}}
[[77726 21347 46535]
 [75024 19423 45575]
 [69531 22835 52676]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005472
{'0': {'precision': 0.2871701259127235, 'recall': 0.24931366676649697, 'f1-score': 0.26690624415528896, 'support': 80136}, '1': {'precision': 0.34636676692384816, 'recall': 0.2707448379256298, 'f1-score': 0.3039223810950538, 'support': 88046}, '2': {'precision': 0.35406660823838737, 'recall': 0.47915505319464374, 'f1-score': 0.4072213010236224, 'support': 84313}, 'accuracy': 0.3335353175310402, 'macro avg': {'precision': 0.32920116702498636, 'recall': 0.3330711859622568, 'f1-score': 0.3260166420913217, 'support': 252495}, 'weighted avg': {'precision': 0.33015026638595735, 'recall': 0.3335353175310402, 'f1-score': 0.32666784807908283, 'support': 252495}}
[[19979 22324 37833]
 [28340 23838 35868]
 [21253 22661 40399]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988286
{'0': {'precision': 0.3507513403307408, 'recall': 0.23214553450947073, 'f1-score': 0.27938169132683754, 'support': 20009}, '1': {'precision': 0.3379057529710873, 'recall': 0.28422937285522454, 'f1-score': 0.3087520259319287, 'support': 20107}, '2': {'precision': 0.33986110653984136, 'recall': 0.5056064241296577, 'f1-score': 0.40648742274534505, 'support': 20423}, 'accuracy': 0.3416970878276813, 'macro avg': {'precision': 0.3428393999472232, 'recall': 0.34066044383145105, 'f1-score': 0.33154038000137037, 'support': 60539}, 'weighted avg': {'precision': 0.342811046144314, 'recall': 0.3416970878276813, 'f1-score': 0.332016020778344, 'support': 60539}}
[[ 4645  5479  9885]
 [ 4220  5715 10172]
 [ 4378  5719 10326]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011006
{'0': {'precision': 0.29725520731944716, 'recall': 0.21094073767094904, 'f1-score': 0.24676793794440852, 'support': 7239}, '1': {'precision': 0.3240279162512463, 'recall': 0.2642634503320233, 'f1-score': 0.29110994998880346, 'support': 7379}, '2': {'precision': 0.34360938247965533, 'recall': 0.5140360928100831, 'f1-score': 0.4118895966029724, 'support': 6982}, 'accuracy': 0.3271296296296296, 'macro avg': {'precision': 0.3216308353501163, 'recall': 0.3297467602710185, 'f1-score': 0.31658916151206146, 'support': 21600}, 'weighted avg': {'precision': 0.3213848679757582, 'recall': 0.3271296296296296, 'f1-score': 0.3152901197791161, 'support': 21600}}
[[1527 2131 3581]
 [2154 1950 3275]
 [1456 1937 3589]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
1242/1242 - 29s - 29s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981629
{'0': {'precision': 0.3246988303524512, 'recall': 0.5077091617300982, 'f1-score': 0.3960859879794091, 'support': 98584}, '1': {'precision': 0.3391617382360504, 'recall': 0.18005842684358533, 'f1-score': 0.23523327150806106, 'support': 109881}, '2': {'precision': 0.38510183734510756, 'recall': 0.3709459088664093, 'f1-score': 0.37789134820101655, 'support': 109334}, 'accuracy': 0.34737050777378153, 'macro avg': {'precision': 0.34965413531120304, 'recall': 0.3529044991466976, 'f1-score': 0.3364035358961622, 'support': 317799}, 'weighted avg': {'precision': 0.3504802240877771, 'recall': 0.34737050777378153, 'f1-score': 0.3342105570179556, 'support': 317799}}
[[50052 18468 30064]
 [55402 19785 34694]
 [48695 20082 40557]]
Evaluating performance on  train set...
528/528 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0905701
{'0': {'precision': 0.3718799822273333, 'recall': 0.6335040071237756, 'f1-score': 0.4686517020470678, 'support': 44920}, '1': {'precision': 0.3174741561838336, 'recall': 0.11481981981981983, 'f1-score': 0.16864600218333392, 'support': 44400}, '2': {'precision': 0.4065762743893797, 'recall': 0.37750581216826773, 'f1-score': 0.3915021381130015, 'support': 45594}, 'accuracy': 0.3762915635145352, 'macro avg': {'precision': 0.3653101376001822, 'recall': 0.3752765463706211, 'f1-score': 0.34293328078113444, 'support': 134914}, 'weighted avg': {'precision': 0.3657006685052953, 'recall': 0.3762915635145352, 'f1-score': 0.3438476765792913, 'support': 134914}}
[[28457  4906 11557]
 [25737  5098 13565]
 [22328  6054 17212]]
Evaluating performance on  val set...
159/159 - 4s - 4s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945265
{'0': {'precision': 0.38584827870542154, 'recall': 0.5055367994598244, 'f1-score': 0.4376570994329807, 'support': 14810}, '1': {'precision': 0.31585760517799355, 'recall': 0.14280488697051724, 'f1-score': 0.19668497153508996, 'support': 13669}, '2': {'precision': 0.3399507028179335, 'recall': 0.4211786068009244, 'f1-score': 0.3762303240314078, 'support': 12116}, 'accuracy': 0.3582214558443158, 'macro avg': {'precision': 0.34721886223378284, 'recall': 0.35650676441042206, 'f1-score': 0.33685746499982616, 'support': 40595}, 'weighted avg': {'precision': 0.3485826660462463, 'recall': 0.3582214558443158, 'f1-score': 0.3381843853794833, 'support': 40595}}
[[7487 2280 5043]
 [6852 1952 4865]
 [5065 1948 5103]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011566
{'0': {'precision': 0.3076565186608678, 'recall': 0.16902832883228308, 'f1-score': 0.21818468733412713, 'support': 89979}, '1': {'precision': 0.26588952150473744, 'recall': 0.31279072723113294, 'f1-score': 0.2874394865775535, 'support': 78682}, '2': {'precision': 0.39178017955331007, 'recall': 0.4907533727451872, 'f1-score': 0.4357170194600642, 'support': 105552}, 'accuracy': 0.3341198265581865, 'macro avg': {'precision': 0.3217754065729717, 'recall': 0.3241908096028678, 'f1-score': 0.3137803977905816, 'support': 274213}, 'weighted avg': {'precision': 0.32805347206672536, 'recall': 0.3341198265581865, 'f1-score': 0.321790566102195, 'support': 274213}}
[[15209 30994 43776]
 [17430 24611 36641]
 [16796 36956 51800]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1019837
{'0': {'precision': 0.3263885508445699, 'recall': 0.27099668579742947, 'f1-score': 0.2961245445511759, 'support': 24742}, '1': {'precision': 0.3075494747129245, 'recall': 0.25858668857847167, 'f1-score': 0.28095078674255103, 'support': 24340}, '2': {'precision': 0.3443237167478456, 'recall': 0.4603823995992319, 'f1-score': 0.3939837805008753, 'support': 23954}, 'accuracy': 0.3289747521770086, 'macro avg': {'precision': 0.32608724743511336, 'recall': 0.3299885913250443, 'f1-score': 0.3236863705982007, 'support': 73036}, 'weighted avg': {'precision': 0.3259925249258835, 'recall': 0.3289747521770086, 'f1-score': 0.3231631402146456, 'support': 73036}}
[[ 6705  7343 10694]
 [ 7740  6294 10306]
 [ 6098  6828 11028]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022362
{'0': {'precision': 0.3243518623344277, 'recall': 0.2958182756840475, 'f1-score': 0.30942866400259206, 'support': 9685}, '1': {'precision': 0.3031189083820663, 'recall': 0.2573171992967215, 'f1-score': 0.27834647871566814, 'support': 9669}, '2': {'precision': 0.3611372180451128, 'recall': 0.4410329985652798, 'f1-score': 0.3971063170133058, 'support': 10455}, 'accuracy': 0.3342614646583247, 'macro avg': {'precision': 0.3295359962538689, 'recall': 0.33138949118201627, 'f1-score': 0.32829381991052203, 'support': 29809}, 'weighted avg': {'precision': 0.3303664707476529, 'recall': 0.3342614646583247, 'f1-score': 0.33009813338055655, 'support': 29809}}
[[2865 2790 4030]
 [3054 2488 4127]
 [2914 2930 4611]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022992
{'0': {'precision': 0.3321108465793712, 'recall': 0.5208087407692097, 'f1-score': 0.4055862577631452, 'support': 72854}, '1': {'precision': 0.2636981851258284, 'recall': 0.20413432360386943, 'f1-score': 0.23012445544835144, 'support': 59647}, '2': {'precision': 0.376029031282551, 'recall': 0.25596102603982024, 'f1-score': 0.3045895281189399, 'support': 87443}, 'accuracy': 0.3296339068126432, 'macro avg': {'precision': 0.32394602099591685, 'recall': 0.32696803013763315, 'f1-score': 0.31343341377681216, 'support': 219944}, 'weighted avg': {'precision': 0.3310184221771629, 'recall': 0.3296339068126432, 'f1-score': 0.3178492558310682, 'support': 219944}}
[[37943 15320 19591]
 [29922 12176 17549]
 [46383 18678 22382]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996431
{'0': {'precision': 0.34544737435203965, 'recall': 0.4465892122227483, 'f1-score': 0.38956046574428543, 'support': 27457}, '1': {'precision': 0.33259288054645414, 'recall': 0.22234184734184734, 'f1-score': 0.2665153639053913, 'support': 26936}, '2': {'precision': 0.32612938713226164, 'recall': 0.33676572978123054, 'f1-score': 0.33136222686954636, 'support': 27289}, 'accuracy': 0.33594916872750424, 'macro avg': {'precision': 0.33472321401025185, 'recall': 0.3352322631152754, 'f1-score': 0.32914601883974104, 'support': 81682}, 'weighted avg': {'precision': 0.33475447752791965, 'recall': 0.33594916872750424, 'f1-score': 0.32954094364902325, 'support': 81682}}
[[12262  5967  9228]
 [11186  5989  9761]
 [12048  6051  9190]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09999
{'0': {'precision': 0.3520778364116095, 'recall': 0.4936416184971098, 'f1-score': 0.4110116469342574, 'support': 8650}, '1': {'precision': 0.32350213318493787, 'recall': 0.22321771406629975, 'f1-score': 0.2641623750378673, 'support': 7813}, '2': {'precision': 0.33095941951088415, 'recall': 0.289832901859261, 'f1-score': 0.30903387703889584, 'support': 8498}, 'accuracy': 0.33960979127438806, 'macro avg': {'precision': 0.3355131297024772, 'recall': 0.33556407814089023, 'f1-score': 0.3280692996703402, 'support': 24961}, 'weighted avg': {'precision': 0.33594361598244604, 'recall': 0.33960979127438806, 'f1-score': 0.3303281627029654, 'support': 24961}}
[[4270 1867 2513]
 [3603 1744 2466]
 [4255 1780 2463]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
1914/1914 - 36s - 36s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005236
{'0': {'precision': 0.30509291211438544, 'recall': 0.31475995674048995, 'f1-score': 0.30985105222264464, 'support': 148869}, '1': {'precision': 0.3262967790300459, 'recall': 0.21417108860844428, 'f1-score': 0.2586031124464099, 'support': 178843}, '2': {'precision': 0.3470764480739543, 'recall': 0.46848163149555816, 'f1-score': 0.3987427620929128, 'support': 162207}, 'accuracy': 0.3289360077890427, 'macro avg': {'precision': 0.3261553797394619, 'recall': 0.33247089228149745, 'f1-score': 0.32239897558732244, 'support': 489919}, 'weighted avg': {'precision': 0.3267336049395081, 'recall': 0.3289360077890427, 'f1-score': 0.3205742989012291, 'support': 489919}}
[[46858 37499 64512]
 [62097 38303 78443]
 [44631 41585 75991]]
Evaluating performance on  train set...
716/716 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102158
{'0': {'precision': 0.33797629237672816, 'recall': 0.21070504527813713, 'f1-score': 0.25957985118484356, 'support': 61840}, '1': {'precision': 0.3116375470428886, 'recall': 0.2823655382587925, 'f1-score': 0.2962802917689356, 'support': 60705}, '2': {'precision': 0.3416064427491148, 'recall': 0.5051868248042551, 'f1-score': 0.4075967080931596, 'support': 60538}, 'accuracy': 0.33183856502242154, 'macro avg': {'precision': 0.3304067607229105, 'recall': 0.3327524694470616, 'f1-score': 0.3211522836823129, 'support': 183083}, 'weighted avg': {'precision': 0.33044347123960904, 'recall': 0.33183856502242154, 'f1-score': 0.3206917224627501, 'support': 183083}}
[[13030 19367 29443]
 [14063 17141 29501]
 [11460 18495 30583]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1013541
{'0': {'precision': 0.33716022286003716, 'recall': 0.21935413005272408, 'f1-score': 0.26578824782058963, 'support': 18208}, '1': {'precision': 0.3115848658779431, 'recall': 0.29692470837751855, 'f1-score': 0.3040781915349662, 'support': 17917}, '2': {'precision': 0.3476723400948162, 'recall': 0.4828646985806034, 'f1-score': 0.4042654135508212, 'support': 18529}, 'accuracy': 0.33412010099901196, 'macro avg': {'precision': 0.33213914294426544, 'recall': 0.33304784567028195, 'f1-score': 0.324710617635459, 'support': 54654}, 'weighted avg': {'precision': 0.33233981354315356, 'recall': 0.33412010099901196, 'f1-score': 0.3252877231626679, 'support': 54654}}
[[3994 5866 8348]
 [4158 5320 8439]
 [3694 5888 8947]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
4918/4918 - 105s - 105s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978867
{'0': {'precision': 0.35484544832126974, 'recall': 0.773219733079123, 'f1-score': 0.48644973244312634, 'support': 419600}, '1': {'precision': 0.31168025412897543, 'recall': 0.06157142191793582, 'f1-score': 0.10282925790828963, 'support': 407949}, '2': {'precision': 0.41246855202934135, 'recall': 0.25241021122678475, 'f1-score': 0.3131737095414675, 'support': 431290}, 'accuracy': 0.36416332827311515, 'macro avg': {'precision': 0.3596647514931955, 'recall': 0.36240045540794785, 'f1-score': 0.30081756663096115, 'support': 1258839}, 'weighted avg': {'precision': 0.3605992187340882, 'recall': 0.36416332827311515, 'f1-score': 0.30276476170161887, 'support': 1258839}}
[[324443  22846  72311]
 [300076  25118  82755]
 [289803  32625 108862]]
Evaluating performance on  train set...
1403/1403 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959778
{'0': {'precision': 0.3583443695518966, 'recall': 0.7503600933759375, 'f1-score': 0.48504777168053037, 'support': 120802}, '1': {'precision': 0.3138432364096081, 'recall': 0.05905592088494673, 'f1-score': 0.09940650697175546, 'support': 117702}, '2': {'precision': 0.4041274723702564, 'recall': 0.2813589428599887, 'f1-score': 0.33174947272611605, 'support': 120476}, 'accuracy': 0.36629617248871804, 'macro avg': {'precision': 0.3587716927772537, 'recall': 0.3635916523736243, 'f1-score': 0.30540125045946726, 'support': 358980}, 'weighted avg': {'precision': 0.35911848711285005, 'recall': 0.36629617248871804, 'f1-score': 0.30715620668085286, 'support': 358980}}
[[90645  6817 23340]
 [84111  6951 26640]
 [78199  8380 33897]]
Evaluating performance on  val set...
480/480 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094996
{'0': {'precision': 0.3761905329534753, 'recall': 0.7307184699807822, 'f1-score': 0.49667925716084355, 'support': 43189}, '1': {'precision': 0.27810148094197623, 'recall': 0.0637149929081959, 'f1-score': 0.10367688652562508, 'support': 35957}, '2': {'precision': 0.4238917222440173, 'recall': 0.2975832549172615, 'f1-score': 0.34968109062959324, 'support': 43571}, 'accuracy': 0.3814956363014089, 'macro avg': {'precision': 0.3593945787131563, 'recall': 0.3640055726020799, 'f1-score': 0.31667907810535395, 'support': 122717}, 'weighted avg': {'precision': 0.3643861413484062, 'recall': 0.3814956363014089, 'f1-score': 0.3293345261548406, 'support': 122717}}
[[31559  2679  8951]
 [24995  2291  8671]
 [27337  3268 12966]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
4856/4856 - 89s - 89s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967923
{'0': {'precision': 0.3678536208924885, 'recall': 0.5476718852232333, 'f1-score': 0.44010371026171485, 'support': 444759}, '1': {'precision': 0.25934636073419665, 'recall': 0.13868641321584688, 'f1-score': 0.18072791440698371, 'support': 362595}, '2': {'precision': 0.39088758773120325, 'recall': 0.3471671514931661, 'f1-score': 0.3677324273516329, 'support': 435551}, 'accuracy': 0.3580949469187106, 'macro avg': {'precision': 0.3393625231192961, 'recall': 0.34450848331074874, 'f1-score': 0.32952135067344385, 'support': 1242905}, 'weighted avg': {'precision': 0.34427038427623324, 'recall': 0.3580949469187106, 'f1-score': 0.3390744672055558, 'support': 1242905}}
[[243582  70439 130738]
 [207420  50287 104888]
 [211169  73173 151209]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962632
{'0': {'precision': 0.3508971882860223, 'recall': 0.702153116767123, 'f1-score': 0.46794261060000564, 'support': 178021}, '1': {'precision': 0.32409402077648525, 'recall': 0.11589356736491922, 'f1-score': 0.17073396269240146, 'support': 175247}, '2': {'precision': 0.39254703650050216, 'recall': 0.24794265249070965, 'f1-score': 0.30392106268126784, 'support': 178142}, 'accuracy': 0.35655520219792625, 'macro avg': {'precision': 0.3558460818543366, 'recall': 0.3553297788742506, 'f1-score': 0.31419921199122497, 'support': 531410}, 'weighted avg': {'precision': 0.3560201866565461, 'recall': 0.35655520219792625, 'f1-score': 0.3149457710425948, 'support': 531410}}
[[124998  19383  33640]
 [120227  20310  34710]
 [110999  22974  44169]]
Evaluating performance on  val set...
588/588 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948116
{'0': {'precision': 0.36024442471405443, 'recall': 0.6769919321594724, 'f1-score': 0.47025457123767717, 'support': 50943}, '1': {'precision': 0.3187971882322312, 'recall': 0.09971295372651208, 'f1-score': 0.15191129720089944, 'support': 49121}, '2': {'precision': 0.39259391497283924, 'recall': 0.3063726465788321, 'f1-score': 0.3441653531864471, 'support': 50246}, 'accuracy': 0.36444680992615264, 'macro avg': {'precision': 0.35721184263970834, 'recall': 0.3610258441549388, 'f1-score': 0.3221104072083412, 'support': 150310}, 'weighted avg': {'precision': 0.35751342068451053, 'recall': 0.36444680992615264, 'f1-score': 0.3240712247260501, 'support': 150310}}
[[34488  4853 11602]
 [32008  4898 12215]
 [29239  5613 15394]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
4353/4353 - 89s - 89s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943033
{'0': {'precision': 0.3841184356341021, 'recall': 0.6501875808220121, 'f1-score': 0.4829306461346868, 'support': 406758}, '1': {'precision': 0.29475908130579975, 'recall': 0.10007664829999856, 'f1-score': 0.14942163893081475, 'support': 345735}, '2': {'precision': 0.3628658052173349, 'recall': 0.3093077571552951, 'f1-score': 0.3339530580880049, 'support': 361795}, 'accuracy': 0.36882296138879717, 'macro avg': {'precision': 0.34724777405241225, 'recall': 0.3531906620924352, 'f1-score': 0.3221017810511688, 'support': 1114288}, 'weighted avg': {'precision': 0.3494920627481607, 'recall': 0.36882296138879717, 'f1-score': 0.3310802420443798, 'support': 1114288}}
[[264469  41159 101130]
 [215776  34600  95359]
 [208264  41625 111906]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960166
{'0': {'precision': 0.35819236304409646, 'recall': 0.6155589123867069, 'f1-score': 0.452864108081606, 'support': 135048}, '1': {'precision': 0.3023048294774414, 'recall': 0.10636912921283781, 'f1-score': 0.15736701977001075, 'support': 130583}, '2': {'precision': 0.3654555751969382, 'recall': 0.33031365370893184, 'f1-score': 0.3469971401334604, 'support': 128932}, 'accuracy': 0.35382942647942156, 'macro avg': {'precision': 0.3419842559061587, 'recall': 0.3507472317694922, 'f1-score': 0.319076089328359, 'support': 394563}, 'weighted avg': {'precision': 0.34206945915689896, 'recall': 0.35382942647942156, 'f1-score': 0.3204732447860528, 'support': 394563}}
[[83130 15010 36908]
 [79655 13890 37038]
 [69297 17047 42588]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989233
{'0': {'precision': 0.3581015161502966, 'recall': 0.628095733610822, 'f1-score': 0.4561400562576095, 'support': 43245}, '1': {'precision': 0.28664225001727595, 'recall': 0.11128699058299574, 'f1-score': 0.1603277674706246, 'support': 37273}, '2': {'precision': 0.3765800721452605, 'recall': 0.29031127313516547, 'f1-score': 0.32786582388725405, 'support': 42792}, 'accuracy': 0.35465898953856134, 'macro avg': {'precision': 0.34044127943761104, 'recall': 0.3432313324429945, 'f1-score': 0.3147778825384961, 'support': 123310}, 'weighted avg': {'precision': 0.3429140466957546, 'recall': 0.35465898953856134, 'f1-score': 0.3222099419801824, 'support': 123310}}
[[27162  5027 11056]
 [23615  4148  9510]
 [25073  5296 12423]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
5497/5497 - 100s - 100s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005024
{'0': {'precision': 0.3521636154141595, 'recall': 0.6356624974724862, 'f1-score': 0.4532320018124337, 'support': 484666}, '1': {'precision': 0.26669459384654515, 'recall': 0.0868834121698189, 'f1-score': 0.13106774701116128, 'support': 410343}, '2': {'precision': 0.397787242154266, 'recall': 0.3096358396851181, 'f1-score': 0.34821930440892324, 'support': 512192}, 'accuracy': 0.35697032620073466, 'macro avg': {'precision': 0.3388818171383236, 'recall': 0.34406058310914106, 'f1-score': 0.3108396844108394, 'support': 1407201}, 'weighted avg': {'precision': 0.3438467096630614, 'recall': 0.35697032620073466, 'f1-score': 0.32106572967617364, 'support': 1407201}}
[[308084  45952 130630]
 [265226  35652 109465]
 [301522  52077 158593]]
Evaluating performance on  train set...
2058/2058 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995682
{'0': {'precision': 0.348094793192263, 'recall': 0.6154541598767774, 'f1-score': 0.4446818977266312, 'support': 179188}, '1': {'precision': 0.2980028030833917, 'recall': 0.08025761704235819, 'f1-score': 0.12645782415968926, 'support': 169554}, '2': {'precision': 0.36233753590030665, 'recall': 0.3343852831841511, 'f1-score': 0.3478006927044091, 'support': 178082}, 'accuracy': 0.3481959819598196, 'macro avg': {'precision': 0.3361450440586538, 'recall': 0.34336568670109563, 'f1-score': 0.3063134715302432, 'support': 526824}, 'weighted avg': {'precision': 0.33678756120589615, 'recall': 0.3481959819598196, 'f1-score': 0.30951538419965324, 'support': 526824}}
[[110282  15182  53724]
 [104874  13608  51072]
 [101660  16874  59548]]
Evaluating performance on  val set...
681/681 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998367
{'0': {'precision': 0.3473441659052084, 'recall': 0.5874388994339274, 'f1-score': 0.436557918323274, 'support': 59533}, '1': {'precision': 0.277740702542013, 'recall': 0.08184353546910755, 'f1-score': 0.12643090901558984, 'support': 55936}, '2': {'precision': 0.35747041937968216, 'recall': 0.347152813190549, 'f1-score': 0.3522360773356789, 'support': 58830}, 'accuracy': 0.3440811479124952, 'macro avg': {'precision': 0.3275184292756345, 'recall': 0.33881174936452796, 'f1-score': 0.30507496822484764, 'support': 174299}, 'weighted avg': {'precision': 0.32842488447054496, 'recall': 0.3440811479124952, 'f1-score': 0.3085714221417994, 'support': 174299}}
[[34972  5639 18922]
 [33571  4578 17787]
 [32141  6266 20423]]
testing model on single stock: results/universal/W2/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
14883/14883 - 267s - 267s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000401
{'0': {'precision': 0.3101894071641003, 'recall': 0.4409243761639352, 'f1-score': 0.3641793663817242, 'support': 1204964}, '1': {'precision': 0.3229497350658998, 'recall': 0.1633404563840342, 'f1-score': 0.21695176272210687, 'support': 1362712}, '2': {'precision': 0.35031995527942195, 'recall': 0.39702935785281707, 'f1-score': 0.37221498553249033, 'support': 1242223}, 'accuracy': 0.3273270498771752, 'macro avg': {'precision': 0.32781969916980735, 'recall': 0.3337647301335955, 'f1-score': 0.3177820382121071, 'support': 3809899}, 'weighted avg': {'precision': 0.3278381012179784, 'recall': 0.3273270498771752, 'f1-score': 0.31413951196304213, 'support': 3809899}}
[[531298 225088 448578]
 [674050 222586 466076]
 [507470 241554 493199]]
Evaluating performance on  train set...
6147/6147 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002104
{'0': {'precision': 0.3173270540075712, 'recall': 0.38654569799385924, 'f1-score': 0.34853290523012714, 'support': 519804}, '1': {'precision': 0.28959907862976014, 'recall': 0.18678315757062583, 'f1-score': 0.22709591678921096, 'support': 519640}, '2': {'precision': 0.3639205939753083, 'recall': 0.4123728327974818, 'f1-score': 0.3866346437449964, 'support': 534041}, 'accuracy': 0.3293402860529335, 'macro avg': {'precision': 0.32361557553754655, 'recall': 0.328567229453989, 'f1-score': 0.3207544885881115, 'support': 1573485}, 'weighted avg': {'precision': 0.3239838035492475, 'recall': 0.3293402860529335, 'f1-score': 0.32136033851661006, 'support': 1573485}}
[[200928 115698 203178]
 [240839  97060 181741]
 [191422 122395 220224]]
Evaluating performance on  val set...
2174/2174 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008669
{'0': {'precision': 0.3077452699415226, 'recall': 0.3656343220500739, 'f1-score': 0.3342014948994469, 'support': 183369}, '1': {'precision': 0.28591383333203274, 'recall': 0.1995609973964858, 'f1-score': 0.2350574989173844, 'support': 183598}, '2': {'precision': 0.37283545927456707, 'recall': 0.4140616344038367, 'f1-score': 0.39236861051115907, 'support': 189537}, 'accuracy': 0.3273381682791139, 'macro avg': {'precision': 0.3221648541827075, 'recall': 0.3264189846167988, 'f1-score': 0.32054253477599676, 'support': 556504}, 'weighted avg': {'precision': 0.3227115435298313, 'recall': 0.3273381682791139, 'f1-score': 0.32130344064895167, 'support': 556504}}
[[67046 44665 71658]
 [86602 36639 60357]
 [64214 46843 78480]]
training model: results/universal/W2/deepVOL_L3/h500
Epoch 1/50
9940/9940 - 814s - loss: 3.2657 - accuracy500: 0.3814 - val_loss: 3.3327 - val_accuracy500: 0.3400 - 814s/epoch - 82ms/step
Epoch 2/50
9940/9940 - 795s - loss: 3.2575 - accuracy500: 0.3867 - val_loss: 3.3191 - val_accuracy500: 0.3418 - 795s/epoch - 80ms/step
Epoch 3/50
9940/9940 - 809s - loss: 3.2498 - accuracy500: 0.3939 - val_loss: 3.3255 - val_accuracy500: 0.3420 - 809s/epoch - 81ms/step
Epoch 4/50
9940/9940 - 808s - loss: 3.2320 - accuracy500: 0.4050 - val_loss: 3.3132 - val_accuracy500: 0.3446 - 808s/epoch - 81ms/step
Epoch 5/50
9940/9940 - 804s - loss: 3.2210 - accuracy500: 0.4114 - val_loss: 3.3540 - val_accuracy500: 0.3351 - 804s/epoch - 81ms/step
Epoch 6/50
9940/9940 - 803s - loss: 3.2109 - accuracy500: 0.4170 - val_loss: 3.3193 - val_accuracy500: 0.3460 - 803s/epoch - 81ms/step
Epoch 7/50
9940/9940 - 824s - loss: 3.2048 - accuracy500: 0.4201 - val_loss: 3.3223 - val_accuracy500: 0.3475 - 824s/epoch - 83ms/step
Epoch 8/50
9940/9940 - 833s - loss: 3.2005 - accuracy500: 0.4218 - val_loss: 3.3369 - val_accuracy500: 0.3431 - 833s/epoch - 84ms/step
Epoch 9/50
9940/9940 - 828s - loss: 3.1969 - accuracy500: 0.4236 - val_loss: 3.3440 - val_accuracy500: 0.3404 - 828s/epoch - 83ms/step
Epoch 10/50
9940/9940 - 825s - loss: 3.1942 - accuracy500: 0.4252 - val_loss: 3.3457 - val_accuracy500: 0.3418 - 825s/epoch - 83ms/step
Epoch 11/50
9940/9940 - 822s - loss: 3.1898 - accuracy500: 0.4273 - val_loss: 3.3521 - val_accuracy500: 0.3367 - 822s/epoch - 83ms/step
Epoch 12/50
9940/9940 - 825s - loss: 3.1867 - accuracy500: 0.4287 - val_loss: 3.3572 - val_accuracy500: 0.3325 - 825s/epoch - 83ms/step
Epoch 13/50
9940/9940 - 833s - loss: 3.1841 - accuracy500: 0.4301 - val_loss: 3.3715 - val_accuracy500: 0.3378 - 833s/epoch - 84ms/step
Epoch 14/50
9940/9940 - 832s - loss: 3.1807 - accuracy500: 0.4318 - val_loss: 3.3660 - val_accuracy500: 0.3390 - 832s/epoch - 84ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1307s - 1307s/epoch - 50ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084152
{'0': {'precision': 0.31781515382150294, 'recall': 0.34805906500065575, 'f1-score': 0.3322502723647146, 'support': 2188301}, '1': {'precision': 0.3574054317999671, 'recall': 0.14435672693892584, 'f1-score': 0.20565073482030022, 'support': 2332361}, '2': {'precision': 0.33488933173278773, 'recall': 0.5148185974591236, 'f1-score': 0.4058035711886544, 'support': 2200107}, 'accuracy': 0.3319569531403326, 'macro avg': {'precision': 0.3367033057847526, 'recall': 0.33574479646623506, 'f1-score': 0.31456819279122306, 'support': 6720769}, 'weighted avg': {'precision': 0.3371438703237353, 'recall': 0.3319569531403326, 'f1-score': 0.3123938100505083, 'support': 6720769}}
[[ 761658  301550 1125093]
 [ 871238  336692 1124431]
 [ 763648  303803 1132656]]
Evaluating performance on  train set...
9940/9940 - 498s - 498s/epoch - 50ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033314
{'0': {'precision': 0.33861066721900857, 'recall': 0.3419206784501182, 'f1-score': 0.34025762311398855, 'support': 855833}, '1': {'precision': 0.34319612047071907, 'recall': 0.1549366147548106, 'f1-score': 0.21349187211574436, 'support': 828584}, '2': {'precision': 0.3557657318791229, 'recall': 0.5405007175220873, 'f1-score': 0.4290947931363608, 'support': 859207}, 'accuracy': 0.3480887898525883, 'macro avg': {'precision': 0.34585750652295016, 'recall': 0.34578600357567196, 'f1-score': 0.3276147627886979, 'support': 2543624}, 'weighted avg': {'precision': 0.3458991598730086, 'recall': 0.3480887898525883, 'f1-score': 0.3289719320363305, 'support': 2543624}}
[[292627 120847 442359]
 [301608 128378 398598]
 [269964 124841 464402]]
Evaluating performance on  val set...
3393/3393 - 169s - 169s/epoch - 50ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1041749
{'0': {'precision': 0.3289975800446761, 'recall': 0.3368559701035349, 'f1-score': 0.3328804027942675, 'support': 293814}, '1': {'precision': 0.33712100518983884, 'recall': 0.1561696727801217, 'f1-score': 0.21345660649605425, 'support': 276603}, '2': {'precision': 0.3567179814173802, 'recall': 0.5262270299324756, 'f1-score': 0.42520121065703936, 'support': 297670}, 'accuracy': 0.3442189550125736, 'macro avg': {'precision': 0.34094552221729835, 'recall': 0.33975089093871075, 'f1-score': 0.323846073315787, 'support': 868087}, 'weighted avg': {'precision': 0.3410914089374487, 'recall': 0.3442189550125736, 'f1-score': 0.3264849085051428, 'support': 868087}}
[[ 98973  41282 153559]
 [104487  43197 128919]
 [ 97372  43656 156642]]
testing model out of sample: results/universal/W2/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 717s - 717s/epoch - 50ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029915
{'0': {'precision': 0.33792784474280474, 'recall': 0.3272410651269319, 'f1-score': 0.3324986066211065, 'support': 1236923}, '1': {'precision': 0.3152825379181633, 'recall': 0.16357084756502377, 'f1-score': 0.2153938283121376, 'support': 1123666}, '2': {'precision': 0.36534742765094297, 'recall': 0.5275306551191905, 'f1-score': 0.43170948324068287, 'support': 1306144}, 'accuracy': 0.3484306056644975, 'macro avg': {'precision': 0.33951927010397037, 'recall': 0.3394475226037154, 'f1-score': 0.32653397272464235, 'support': 3666733}, 'weighted avg': {'precision': 0.34075547423193026, 'recall': 0.3484306056644975, 'f1-score': 0.3319523528873533, 'support': 3666733}}
[[404772 192461 639690]
 [382627 183799 557240]
 [410407 206706 689031]]
Evaluating performance on  train set...
5373/5373 - 272s - 272s/epoch - 51ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1063198
{'0': {'precision': 0.3329987948215118, 'recall': 0.34566706551328075, 'f1-score': 0.3392146944554652, 'support': 458823}, '1': {'precision': 0.3566764747092616, 'recall': 0.16466818610127024, 'f1-score': 0.2253145472864626, 'support': 463769}, '2': {'precision': 0.33752907214567046, 'recall': 0.510811408357285, 'f1-score': 0.4064728836281364, 'support': 452300}, 'accuracy': 0.33894153140755784, 'macro avg': {'precision': 0.34240144722548127, 'recall': 0.34038221999061197, 'f1-score': 0.32366737512335475, 'support': 1374892}, 'weighted avg': {'precision': 0.34247591619364776, 'recall': 0.33894153140755784, 'f1-score': 0.3229207030804176, 'support': 1374892}}
[[158600  68425 231798]
 [165735  76368 221666]
 [151943  69317 231040]]
Evaluating performance on  val set...
1685/1685 - 85s - 85s/epoch - 50ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1072274
{'0': {'precision': 0.31964198136341343, 'recall': 0.3137650532039165, 'f1-score': 0.3166762533895913, 'support': 141249}, '1': {'precision': 0.37069690554218265, 'recall': 0.1717422120106684, 'f1-score': 0.23473346402648146, 'support': 148851}, '2': {'precision': 0.3365761371481857, 'recall': 0.5340750647355093, 'f1-score': 0.4129252261914584, 'support': 140572}, 'accuracy': 0.33658793699149236, 'macro avg': {'precision': 0.3423050080179273, 'recall': 0.3398607766500314, 'f1-score': 0.3214449812025104, 'support': 430672}, 'weighted avg': {'precision': 0.34281517271532624, 'recall': 0.33658793699149236, 'f1-score': 0.31977059076284936, 'support': 430672}}
[[44319 21410 75520]
 [50825 25564 72462]
 [43508 21988 75076]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1101505
{'0': {'precision': 0.2451283637488401, 'recall': 0.20557183990039168, 'f1-score': 0.22361422666158773, 'support': 77102}, '1': {'precision': 0.38318572372769333, 'recall': 0.15119178010744275, 'f1-score': 0.21682997980402424, 'support': 95865}, '2': {'precision': 0.3366642223851743, 'recall': 0.6350342017905644, 'f1-score': 0.44004042903571516, 'support': 79528}, 'accuracy': 0.3201924790589913, 'macro avg': {'precision': 0.32165943662056923, 'recall': 0.3305992739327996, 'f1-score': 0.29349487850044237, 'support': 252495}, 'weighted avg': {'precision': 0.326375646190089, 'recall': 0.3201924790589913, 'f1-score': 0.2892059064865716, 'support': 252495}}
[[15850 11452 49800]
 [31664 14494 49707]
 [17146 11879 50503]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057932
{'0': {'precision': 0.3387769592615603, 'recall': 0.18966459627329194, 'f1-score': 0.24318297655453616, 'support': 20125}, '1': {'precision': 0.34477362820780305, 'recall': 0.16325824935783442, 'f1-score': 0.22158900435802883, 'support': 20244}, '2': {'precision': 0.337574963463186, 'recall': 0.6642042637580565, 'f1-score': 0.4476410050788559, 'support': 20170}, 'accuracy': 0.33893853548951913, 'macro avg': {'precision': 0.3403751836441831, 'recall': 0.3390423697963943, 'f1-score': 0.3041376619971403, 'support': 60539}, 'weighted avg': {'precision': 0.3403817480901589, 'recall': 0.33893853548951913, 'f1-score': 0.30408206742470967, 'support': 60539}}
[[ 3817  3029 13279]
 [ 3929  3305 13010]
 [ 3521  3252 13397]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1107332
{'0': {'precision': 0.2995762711864407, 'recall': 0.20079522862823063, 'f1-score': 0.2404353001190274, 'support': 7042}, '1': {'precision': 0.3619672131147541, 'recall': 0.1361450240473548, 'f1-score': 0.19786719240075276, 'support': 8109}, '2': {'precision': 0.31070137382501806, 'recall': 0.6663048534656536, 'f1-score': 0.423788155234479, 'support': 6449}, 'accuracy': 0.31550925925925927, 'macro avg': {'precision': 0.3240816193754043, 'recall': 0.334415035380413, 'f1-score': 0.2873635492514197, 'support': 21600}, 'weighted avg': {'precision': 0.32632043484444434, 'recall': 0.31550925925925927, 'f1-score': 0.2791972342464375, 'support': 21600}}
[[1414 1003 4625]
 [2097 1104 4908]
 [1209  943 4297]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
1242/1242 - 28s - 28s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042887
{'0': {'precision': 0.26753527654753323, 'recall': 0.44184294618665176, 'f1-score': 0.3332737628821101, 'support': 82303}, '1': {'precision': 0.43419563050200227, 'recall': 0.18104511156358102, 'f1-score': 0.2555389817024662, 'support': 141937}, '2': {'precision': 0.3334990626782949, 'recall': 0.43733900533353287, 'f1-score': 0.37842487132888475, 'support': 93559}, 'accuracy': 0.3240381498997794, 'macro avg': {'precision': 0.3450766565759434, 'recall': 0.3534090210279219, 'f1-score': 0.3224125386378203, 'support': 317799}, 'weighted avg': {'precision': 0.3613894942318035, 'recall': 0.3240381498997794, 'f1-score': 0.31184780156340447, 'support': 317799}}
[[36365 15611 30327]
 [64794 25697 51446]
 [34767 17875 40917]]
Evaluating performance on  train set...
528/528 - 12s - 12s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09616
{'0': {'precision': 0.36894964430185523, 'recall': 0.5196463654223968, 'f1-score': 0.43151969981238275, 'support': 45810}, '1': {'precision': 0.34655263032156336, 'recall': 0.16459775331896062, 'f1-score': 0.223189832907653, 'support': 44065}, '2': {'precision': 0.36545770661491184, 'recall': 0.4013632629498879, 'f1-score': 0.38256986550691513, 'support': 45039}, 'accuracy': 0.36419496864669343, 'macro avg': {'precision': 0.3603199937461101, 'recall': 0.3618691272304151, 'f1-score': 0.3457597994089836, 'support': 134914}, 'weighted avg': {'precision': 0.3604687023497687, 'recall': 0.36419496864669343, 'f1-score': 0.3471347792523158, 'support': 134914}}
[[23805  6422 15583]
 [21008  7253 15804]
 [19708  7254 18077]]
Evaluating performance on  val set...
159/159 - 4s - 4s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051309
{'0': {'precision': 0.3463973470003015, 'recall': 0.4169993467373158, 'f1-score': 0.37843356827613467, 'support': 13777}, '1': {'precision': 0.39161243673174256, 'recall': 0.16909147674055572, 'f1-score': 0.236197121674662, 'support': 16015}, '2': {'precision': 0.2754606610119918, 'recall': 0.4358974358974359, 'f1-score': 0.33758692379382027, 'support': 10803}, 'accuracy': 0.3242271215666954, 'macro avg': {'precision': 0.3378234815813453, 'recall': 0.34066275312510247, 'f1-score': 0.3174058712482057, 'support': 40595}, 'weighted avg': {'precision': 0.34535757962297225, 'recall': 0.3242271215666954, 'f1-score': 0.3114503685553556, 'support': 40595}}
[[5745 2361 5671]
 [6592 2708 6715]
 [4248 1846 4709]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
1072/1072 - 26s - 26s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975873
{'0': {'precision': 0.29234300317069706, 'recall': 0.14076242993209678, 'f1-score': 0.19002722364919944, 'support': 87772}, '1': {'precision': 0.29269044926493265, 'recall': 0.14468117543926515, 'f1-score': 0.19364218366080307, 'support': 78711}, '2': {'precision': 0.39385007485378903, 'recall': 0.7057458460967233, 'f1-score': 0.5055639967683269, 'support': 107730}, 'accuracy': 0.36385218789772916, 'macro avg': {'precision': 0.3262945090964729, 'recall': 0.3303964838226951, 'f1-score': 0.29641113469277647, 'support': 274213}, 'weighted avg': {'precision': 0.33232179579520016, 'recall': 0.36385218789772916, 'f1-score': 0.3150297351479137, 'support': 274213}}
[[12355 12041 63376]
 [13686 11388 53637]
 [16221 15479 76030]]
Evaluating performance on  train set...
286/286 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1061437
{'0': {'precision': 0.32941353836876225, 'recall': 0.17934091188903026, 'f1-score': 0.23224297823718543, 'support': 24367}, '1': {'precision': 0.38756231960115456, 'recall': 0.17664646786796365, 'f1-score': 0.2426814908124983, 'support': 25084}, '2': {'precision': 0.3300163435877278, 'recall': 0.6763620945516218, 'f1-score': 0.4435916687522594, 'support': 23585}, 'accuracy': 0.33891505558902457, 'macro avg': {'precision': 0.3489974005192149, 'recall': 0.3441164914362052, 'f1-score': 0.306172045933981, 'support': 73036}, 'weighted avg': {'precision': 0.34957922637909455, 'recall': 0.33891505558902457, 'f1-score': 0.3040773957194841, 'support': 73036}}
[[ 4370  3516 16481]
 [ 4749  4431 15904]
 [ 4147  3486 15952]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1076986
{'0': {'precision': 0.28206958073148974, 'recall': 0.1642426760856015, 'f1-score': 0.20760291510734685, 'support': 9626}, '1': {'precision': 0.3530706141228246, 'recall': 0.18162173286684502, 'f1-score': 0.239858666847863, 'support': 9718}, '2': {'precision': 0.343348086435824, 'recall': 0.6301003344481605, 'f1-score': 0.44448938321536907, 'support': 10465}, 'accuracy': 0.33345633868965746, 'macro avg': {'precision': 0.3261627604300461, 'recall': 0.32532158113353565, 'f1-score': 0.297316988390193, 'support': 29809}, 'weighted avg': {'precision': 0.3267295023891384, 'recall': 0.33345633868965746, 'f1-score': 0.30128194775402367, 'support': 29809}}
[[1581 1523 6522]
 [1864 1765 6089]
 [2160 1711 6594]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
860/860 - 20s - 20s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1014104
{'0': {'precision': 0.3075936743125801, 'recall': 0.18178246165504272, 'f1-score': 0.22851598676956997, 'support': 71261}, '1': {'precision': 0.2652140340717147, 'recall': 0.18104399677148364, 'f1-score': 0.21519123650282426, 'support': 60709}, '2': {'precision': 0.38431533566002873, 'recall': 0.5958123991179212, 'f1-score': 0.4672448988687924, 'support': 87974}, 'accuracy': 0.3471838286109191, 'macro avg': {'precision': 0.3190410146814412, 'recall': 0.3195462858481492, 'f1-score': 0.3036507073803955, 'support': 219944}, 'weighted avg': {'precision': 0.3265834437811619, 'recall': 0.3471838286109191, 'f1-score': 0.32032574311242606, 'support': 219944}}
[[12954 13208 45099]
 [10845 10991 38873]
 [18315 17243 52416]]
Evaluating performance on  train set...
320/320 - 8s - 8s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057575
{'0': {'precision': 0.3453463960811756, 'recall': 0.18035962283458812, 'f1-score': 0.2369634111207145, 'support': 27362}, '1': {'precision': 0.30854960642194684, 'recall': 0.14684173435703424, 'f1-score': 0.19898472054684357, 'support': 26961}, '2': {'precision': 0.3318487564377486, 'recall': 0.6617931941956943, 'f1-score': 0.442041015625, 'support': 27359}, 'accuracy': 0.3305501824147303, 'macro avg': {'precision': 0.32858158631362366, 'recall': 0.3296648504624389, 'f1-score': 0.29266304909751933, 'support': 81682}, 'weighted avg': {'precision': 0.3286798089627531, 'recall': 0.3305501824147303, 'f1-score': 0.2931174561376168, 'support': 81682}}
[[ 4935  4386 18041]
 [ 4588  3959 18414]
 [ 4767  4486 18106]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046985
{'0': {'precision': 0.36151960784313725, 'recall': 0.20237823004802194, 'f1-score': 0.25949274299956016, 'support': 8746}, '1': {'precision': 0.27385707944962273, 'recall': 0.1652826145191535, 'f1-score': 0.2061476779151353, 'support': 7466}, '2': {'precision': 0.3464232919853461, 'recall': 0.6160704080466339, 'f1-score': 0.44347539904558175, 'support': 8749}, 'accuracy': 0.33628460398221227, 'macro avg': {'precision': 0.3272666597593687, 'recall': 0.3279104175379364, 'f1-score': 0.30303860665342575, 'support': 24961}, 'weighted avg': {'precision': 0.33000780525406653, 'recall': 0.33628460398221227, 'f1-score': 0.3080240519145206, 'support': 24961}}
[[1770 1646 5330]
 [1393 1234 4839]
 [1733 1626 5390]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
1914/1914 - 37s - 37s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026609
{'0': {'precision': 0.3163074606397139, 'recall': 0.14378174217561102, 'f1-score': 0.19769747899159665, 'support': 163623}, '1': {'precision': 0.3116464729438341, 'recall': 0.16243970644313172, 'f1-score': 0.2135635408924794, 'support': 149477}, '2': {'precision': 0.3632971003761514, 'recall': 0.6937037309338928, 'f1-score': 0.4768597081537722, 'support': 176819}, 'accuracy': 0.34794935489335993, 'macro avg': {'precision': 0.3304170113198998, 'recall': 0.33330839318421185, 'f1-score': 0.29604024267928275, 'support': 489919}, 'weighted avg': {'precision': 0.33184462219241984, 'recall': 0.34794935489335993, 'f1-score': 0.3032920722467775, 'support': 489919}}
[[ 23526  25482 114615]
 [ 24841  24281 100355]
 [ 26010  28149 122660]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023779
{'0': {'precision': 0.31115001186802754, 'recall': 0.17301568970352896, 'f1-score': 0.2223777261787377, 'support': 60613}, '1': {'precision': 0.38077000604716793, 'recall': 0.1783842485480901, 'f1-score': 0.24295038744734898, 'support': 63537}, '2': {'precision': 0.34317340088451925, 'recall': 0.6965197766955695, 'f1-score': 0.4598030759580164, 'support': 58933}, 'accuracy': 0.34339070257751947, 'macro avg': {'precision': 0.3450311395999049, 'recall': 0.34930657164906287, 'f1-score': 0.308377063194701, 'support': 183083}, 'weighted avg': {'precision': 0.34561896832531164, 'recall': 0.34339070257751947, 'f1-score': 0.3059426301707303, 'support': 183083}}
[[10487  9585 40541]
 [14179 11334 38024]
 [ 9038  8847 41048]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991867
{'0': {'precision': 0.3554855342308794, 'recall': 0.12879456177676302, 'f1-score': 0.18908315240163032, 'support': 19271}, '1': {'precision': 0.2980806389282494, 'recall': 0.14993844359489406, 'f1-score': 0.19951715813071216, 'support': 15433}, '2': {'precision': 0.37152020847427897, 'recall': 0.7432080200501253, 'f1-score': 0.4953975174994571, 'support': 19950}, 'accuracy': 0.3590405093863212, 'macro avg': {'precision': 0.34169546054446925, 'recall': 0.3406470084739275, 'f1-score': 0.2946659426772665, 'support': 54654}, 'weighted avg': {'precision': 0.34512878087248533, 'recall': 0.3590405093863212, 'f1-score': 0.30384144262958374, 'support': 54654}}
[[ 2482  2699 14090]
 [ 2127  2314 10992]
 [ 2373  2750 14827]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
4918/4918 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055328
{'0': {'precision': 0.3402192311388045, 'recall': 0.5401631687406997, 'f1-score': 0.41748653308747163, 'support': 426062}, '1': {'precision': 0.3266143159166415, 'recall': 0.13784725674500897, 'f1-score': 0.19387131299042853, 'support': 392253}, '2': {'precision': 0.37049281008746887, 'recall': 0.3505688679844912, 'f1-score': 0.3602555758504616, 'support': 440524}, 'accuracy': 0.3484544091817937, 'macro avg': {'precision': 0.34577545238097157, 'recall': 0.3428597644900666, 'f1-score': 0.3238711406427872, 'support': 1258839}, 'weighted avg': {'precision': 0.3465740305072244, 'recall': 0.3484544091817937, 'f1-score': 0.3277805809088356, 'support': 1258839}}
[[230143  53327 142592]
 [218374  54071 119808]
 [227938  58152 154434]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101273
{'0': {'precision': 0.3580258636549772, 'recall': 0.49542979625021555, 'f1-score': 0.41566700888150865, 'support': 121767}, '1': {'precision': 0.328789135392909, 'recall': 0.16150908164997455, 'f1-score': 0.21661278572079046, 'support': 117820}, '2': {'precision': 0.360929075072584, 'recall': 0.4008693977033829, 'f1-score': 0.3798522210493734, 'support': 119393}, 'accuracy': 0.35438464538414394, 'macro avg': {'precision': 0.3492480247068234, 'recall': 0.35260275853452433, 'f1-score': 0.33737733855055746, 'support': 358980}, 'weighted avg': {'precision': 0.3493957221344063, 'recall': 0.35438464538414394, 'f1-score': 0.3384242557018386, 'support': 358980}}
[[60327 19282 42158]
 [56205 19029 42586]
 [51967 19565 47861]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099919
{'0': {'precision': 0.35891153175849394, 'recall': 0.494308324817605, 'f1-score': 0.4158669225847729, 'support': 42079}, '1': {'precision': 0.3153039169170752, 'recall': 0.15706820032038657, 'f1-score': 0.20968307390267846, 'support': 38079}, '2': {'precision': 0.37573970957528113, 'recall': 0.4043093117789422, 'f1-score': 0.38950132421848477, 'support': 42559}, 'accuracy': 0.358450744395642, 'macro avg': {'precision': 0.34998505275028347, 'recall': 0.35189527897231127, 'f1-score': 0.3383504402353121, 'support': 122717}, 'weighted avg': {'precision': 0.35121623325998325, 'recall': 0.358450744395642, 'f1-score': 0.34274446787323065, 'support': 122717}}
[[20800  6146 15133]
 [18643  5981 13455]
 [18510  6842 17207]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
4856/4856 - 89s - 89s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017883
{'0': {'precision': 0.35775597535036613, 'recall': 0.38292521062281365, 'f1-score': 0.3699129525819214, 'support': 444515}, '1': {'precision': 0.28846241380095133, 'recall': 0.1406953317089686, 'f1-score': 0.1891393801925753, 'support': 360346}, '2': {'precision': 0.3626684884529078, 'recall': 0.4896037840947485, 'f1-score': 0.4166834239196429, 'support': 438044}, 'accuracy': 0.35029467256145885, 'macro avg': {'precision': 0.3362956258680751, 'recall': 0.33774144214217694, 'f1-score': 0.32524525223137984, 'support': 1242905}, 'weighted avg': {'precision': 0.33939756433697754, 'recall': 0.35029467256145885, 'f1-score': 0.3339862249804149, 'support': 1242905}}
[[170216  62972 211327]
 [144081  50699 165566]
 [161491  62085 214468]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017486
{'0': {'precision': 0.3490644786033336, 'recall': 0.4428877246352318, 'f1-score': 0.39041844204086096, 'support': 177510}, '1': {'precision': 0.3396679772826562, 'recall': 0.150640514234916, 'f1-score': 0.20871659231771347, 'support': 175484}, '2': {'precision': 0.35618010001664024, 'recall': 0.45588960631333514, 'f1-score': 0.3999134663133208, 'support': 178416}, 'accuracy': 0.3507461282249111, 'macro avg': {'precision': 0.34830418530087665, 'recall': 0.34980594839449436, 'f1-score': 0.33301616689063174, 'support': 531410}, 'weighted avg': {'precision': 0.3483505384673158, 'recall': 0.3507461282249111, 'f1-score': 0.33360411196385525, 'support': 531410}}
[[78617 25252 73641]
 [75666 26435 73383]
 [70939 26139 81338]]
Evaluating performance on  val set...
588/588 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1033517
{'0': {'precision': 0.3257026558794342, 'recall': 0.4030975477746784, 'f1-score': 0.3602906289828916, 'support': 48038}, '1': {'precision': 0.38638655462184873, 'recall': 0.16781940617187072, 'f1-score': 0.23400384238584168, 'support': 54797}, '2': {'precision': 0.3434093383241123, 'recall': 0.4850552922590837, 'f1-score': 0.40212342402123424, 'support': 47475}, 'accuracy': 0.3432106978910252, 'macro avg': {'precision': 0.35183284960846506, 'recall': 0.35199074873521097, 'f1-score': 0.3321392984633225, 'support': 150310}, 'weighted avg': {'precision': 0.35341817945370857, 'recall': 0.3432106978910252, 'f1-score': 0.32746430271908195, 'support': 150310}}
[[19364  7504 21170]
 [22742  9196 22859]
 [17347  7100 23028]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
4353/4353 - 81s - 81s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100991
{'0': {'precision': 0.4131459679798332, 'recall': 0.3446734441839237, 'f1-score': 0.37581629989583565, 'support': 446968}, '1': {'precision': 0.25774114054589775, 'recall': 0.1362944234337597, 'f1-score': 0.17830207908683246, 'support': 282396}, '2': {'precision': 0.3444801761965727, 'recall': 0.5298578420675251, 'f1-score': 0.4175170677284312, 'support': 384924}, 'accuracy': 0.3558343982884138, 'macro avg': {'precision': 0.33845576157410123, 'recall': 0.33694190322840284, 'f1-score': 0.32387848223703314, 'support': 1114288}, 'weighted avg': {'precision': 0.35004126534962143, 'recall': 0.3558343982884138, 'f1-score': 0.3401651939498098, 'support': 1114288}}
[[154058  58234 234676]
 [ 90472  38489 153435]
 [128360  52609 203955]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100605
{'0': {'precision': 0.36738105018626854, 'recall': 0.3661389255539164, 'f1-score': 0.3667589361784867, 'support': 141673}, '1': {'precision': 0.33018359001131126, 'recall': 0.15761623512016015, 'f1-score': 0.21337561710693523, 'support': 120381}, '2': {'precision': 0.3537395867363607, 'recall': 0.5229757978703333, 'f1-score': 0.422023488716951, 'support': 132509}, 'accuracy': 0.3551904258635503, 'macro avg': {'precision': 0.3504347423113135, 'recall': 0.3489103195148033, 'f1-score': 0.3340526806674577, 'support': 394563}, 'weighted avg': {'precision': 0.3514508080358252, 'recall': 0.3551904258635503, 'f1-score': 0.3385216540693354, 'support': 394563}}
[[51872 19754 70047]
 [44849 18974 56558]
 [44473 18737 69299]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032583
{'0': {'precision': 0.3738323551293709, 'recall': 0.4031693672409566, 'f1-score': 0.3879470269690633, 'support': 44867}, '1': {'precision': 0.2949622416534181, 'recall': 0.17464846737659587, 'f1-score': 0.21939322271904213, 'support': 33994}, '2': {'precision': 0.3566448881264372, 'recall': 0.43964993588157214, 'f1-score': 0.3938212266860131, 'support': 44449}, 'accuracy': 0.353320898548374, 'macro avg': {'precision': 0.3418131616364088, 'recall': 0.3391559234997082, 'f1-score': 0.33372049212470617, 'support': 123310}, 'weighted avg': {'precision': 0.34589401794410657, 'recall': 0.353320898548374, 'f1-score': 0.34359769829777537, 'support': 123310}}
[[18089  6942 19836]
 [12641  5937 15416]
 [17658  7249 19542]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
5497/5497 - 103s - 103s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039611
{'0': {'precision': 0.3384554010726792, 'recall': 0.3950240455604631, 'f1-score': 0.3645583318993514, 'support': 463911}, '1': {'precision': 0.329126859641618, 'recall': 0.18916513191293677, 'f1-score': 0.24024807187723624, 'support': 439267}, '2': {'precision': 0.3672550282495088, 'recall': 0.446868496080536, 'f1-score': 0.4031690455988859, 'support': 504023}, 'accuracy': 0.3493331798371377, 'macro avg': {'precision': 0.34494576298793533, 'recall': 0.34368589118464526, 'f1-score': 0.3359918164584912, 'support': 1407201}, 'weighted avg': {'precision': 0.3458587173578077, 'recall': 0.3493331798371377, 'f1-score': 0.33958342977936, 'support': 1407201}}
[[183256  80098 200557]
 [168677  83094 187496]
 [189515  89276 225232]]
Evaluating performance on  train set...
2058/2058 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1124036
{'0': {'precision': 0.3173381667529777, 'recall': 0.34775946608553526, 'f1-score': 0.3318530873958863, 'support': 176208}, '1': {'precision': 0.3597403208354895, 'recall': 0.17048266636941256, 'f1-score': 0.23133470474346565, 'support': 179420}, '2': {'precision': 0.31859780615691446, 'recall': 0.4628262342578098, 'f1-score': 0.3774018080839835, 'support': 171196}, 'accuracy': 0.3247763959121073, 'macro avg': {'precision': 0.33189209791512725, 'recall': 0.3270227889042525, 'f1-score': 0.31352986674111183, 'support': 526824}, 'weighted avg': {'precision': 0.3321883628580918, 'recall': 0.3247763959121073, 'f1-score': 0.31242107703079697, 'support': 526824}}
[[61278 26999 87931]
 [67301 30588 81531]
 [64521 27441 79234]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129678
{'0': {'precision': 0.31700241998814044, 'recall': 0.3453694650090795, 'f1-score': 0.33057851239669417, 'support': 57272}, '1': {'precision': 0.3835103060587133, 'recall': 0.18179425601210647, 'f1-score': 0.2466633932955408, 'support': 60794}, '2': {'precision': 0.3163184247267825, 'recall': 0.467359024060605, 'f1-score': 0.37728346145840064, 'support': 56233}, 'accuracy': 0.32767256266530503, 'macro avg': {'precision': 0.33894371692454545, 'recall': 0.3315075816939303, 'f1-score': 0.31817512238354523, 'support': 174299}, 'weighted avg': {'precision': 0.33997912851912726, 'recall': 0.32767256266530503, 'f1-score': 0.3163777633961344, 'support': 174299}}
[[19780  8333 29159]
 [22098 11052 27644]
 [20519  9433 26281]]
testing model on single stock: results/universal/W2/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
14883/14883 - 273s - 273s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112288
{'0': {'precision': 0.2807236474405555, 'recall': 0.28233108692639364, 'f1-score': 0.28152507268034466, 'support': 1161707}, '1': {'precision': 0.39409585833399746, 'recall': 0.14273098264958428, 'f1-score': 0.20956362396142988, 'support': 1455066}, '2': {'precision': 0.32183902610195814, 'recall': 0.5703890452475262, 'f1-score': 0.41149446137474, 'support': 1193126}, 'accuracy': 0.31922499782802644, 'macro avg': {'precision': 0.3322195106255037, 'recall': 0.3318170382745014, 'f1-score': 0.3008610526721715, 'support': 3809899}, 'weighted avg': {'precision': 0.3368983325691224, 'recall': 0.31922499782802644, 'f1-score': 0.2947435856944043, 'support': 3809899}}
[[327986 160844 672877]
 [486252 207683 761131]
 [354121 158459 680546]]
Evaluating performance on  train set...
6147/6147 - 113s - 113s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049489
{'0': {'precision': 0.318939476806314, 'recall': 0.29201438308542993, 'f1-score': 0.3048836276365889, 'support': 519221}, '1': {'precision': 0.35131994980066605, 'recall': 0.1525405453281654, 'f1-score': 0.21271973986988124, 'support': 519357}, '2': {'precision': 0.3563848562221234, 'recall': 0.5813720889799535, 'f1-score': 0.44188893380689065, 'support': 534907}, 'accuracy': 0.34434583106925076, 'macro avg': {'precision': 0.34221476094303455, 'recall': 0.34197567246451627, 'f1-score': 0.31983076710445363, 'support': 1573485}, 'weighted avg': {'precision': 0.3423568089576215, 'recall': 0.34434583106925076, 'f1-score': 0.3210383015284809, 'support': 1573485}}
[[151620  71277 296324]
 [174842  79223 265292]
 [148926  75001 310980]]
Evaluating performance on  val set...
2174/2174 - 40s - 40s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051676
{'0': {'precision': 0.30410332503853904, 'recall': 0.28571971032574794, 'f1-score': 0.2946250272692185, 'support': 184345}, '1': {'precision': 0.35428341635533417, 'recall': 0.15084866527846053, 'f1-score': 0.21160081662063165, 'support': 181049}, '2': {'precision': 0.35924432180004245, 'recall': 0.5756161373031239, 'f1-score': 0.4423907907304077, 'support': 191110}, 'accuracy': 0.3413955694837773, 'macro avg': {'precision': 0.33921035439797187, 'recall': 0.33739483763577743, 'f1-score': 0.3162055448734193, 'support': 556504}, 'weighted avg': {'precision': 0.33936461919618277, 'recall': 0.3413955694837773, 'f1-score': 0.3183590251225167, 'support': 556504}}
[[ 52671  24083 107591]
 [ 65120  27311  88618]
 [ 55410  25694 110006]]
training model: results/universal/W2/deepVOL_L3/h1000
Epoch 1/50
9940/9940 - 835s - loss: 3.2509 - accuracy1000: 0.3948 - val_loss: 3.3987 - val_accuracy1000: 0.3289 - 835s/epoch - 84ms/step
Epoch 2/50
9940/9940 - 836s - loss: 3.2416 - accuracy1000: 0.3989 - val_loss: 3.3992 - val_accuracy1000: 0.3360 - 836s/epoch - 84ms/step
Epoch 3/50
9940/9940 - 829s - loss: 3.2311 - accuracy1000: 0.4065 - val_loss: 3.4458 - val_accuracy1000: 0.3290 - 829s/epoch - 83ms/step
Epoch 4/50
9940/9940 - 830s - loss: 3.2116 - accuracy1000: 0.4166 - val_loss: 3.5019 - val_accuracy1000: 0.3319 - 830s/epoch - 84ms/step
Epoch 5/50
9940/9940 - 833s - loss: 3.1919 - accuracy1000: 0.4251 - val_loss: 3.5368 - val_accuracy1000: 0.3290 - 833s/epoch - 84ms/step
Epoch 6/50
9940/9940 - 824s - loss: 3.1812 - accuracy1000: 0.4298 - val_loss: 3.4961 - val_accuracy1000: 0.3401 - 824s/epoch - 83ms/step
Epoch 7/50
9940/9940 - 827s - loss: 3.1747 - accuracy1000: 0.4324 - val_loss: 3.5035 - val_accuracy1000: 0.3386 - 827s/epoch - 83ms/step
Epoch 8/50
9940/9940 - 829s - loss: 3.1696 - accuracy1000: 0.4346 - val_loss: 3.5116 - val_accuracy1000: 0.3437 - 829s/epoch - 83ms/step
Epoch 9/50
9940/9940 - 832s - loss: 3.1662 - accuracy1000: 0.4358 - val_loss: 3.5028 - val_accuracy1000: 0.3447 - 832s/epoch - 84ms/step
Epoch 10/50
9940/9940 - 831s - loss: 3.1633 - accuracy1000: 0.4373 - val_loss: 3.4997 - val_accuracy1000: 0.3441 - 831s/epoch - 84ms/step
Epoch 11/50
9940/9940 - 848s - loss: 3.1607 - accuracy1000: 0.4384 - val_loss: 3.5016 - val_accuracy1000: 0.3453 - 848s/epoch - 85ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1317s - 1317s/epoch - 50ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1247787
{'0': {'precision': 0.2999781037880447, 'recall': 0.0006358863629295888, 'f1-score': 0.0012690825552097228, 'support': 2154473}, '1': {'precision': 0.3526061235048473, 'recall': 0.9673589739798624, 'f1-score': 0.5168268441380011, 'support': 2367205}, '2': {'precision': 0.32515931891726235, 'recall': 0.03280764643209399, 'f1-score': 0.05960165602838198, 'support': 2199091}, 'accuracy': 0.3516642217579566, 'macro avg': {'precision': 0.3259145154033848, 'recall': 0.3336008355916286, 'f1-score': 0.1925658609071976, 'support': 6720769}, 'weighted avg': {'precision': 0.326754369267998, 'recall': 0.3516642217579566, 'f1-score': 0.2019469437254543, 'support': 6720769}}
[[   1370 2078704   74399]
 [   1932 2289937   75336]
 [   1265 2125679   72147]]
Evaluating performance on  train set...
9940/9940 - 516s - 516s/epoch - 52ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1286883
{'0': {'precision': 0.3210952084629745, 'recall': 0.0006094485789572524, 'f1-score': 0.001216588036412763, 'support': 846667}, '1': {'precision': 0.3330279843740871, 'recall': 0.9647742700662968, 'f1-score': 0.4951398865841917, 'support': 844837}, '2': {'precision': 0.3550410390929091, 'recall': 0.039392339107168, 'f1-score': 0.07091639694759704, 'support': 852120}, 'accuracy': 0.333838649108516, 'macro avg': {'precision': 0.33638807730999026, 'recall': 0.3349253525841407, 'f1-score': 0.1890909571894005, 'support': 2543624}, 'weighted avg': {'precision': 0.3364304827797747, 'recall': 0.333838649108516, 'f1-score': 0.18861742988434638, 'support': 2543624}}
[[   516 814314  31837]
 [   620 815077  29140]
 [   471 818082  33567]]
Evaluating performance on  val set...
3393/3393 - 170s - 170s/epoch - 50ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1334512
{'0': {'precision': 0.34967320261437906, 'recall': 0.0007374402552783837, 'f1-score': 0.0014717766200718694, 'support': 290193}, '1': {'precision': 0.32793284370165365, 'recall': 0.9685771718046476, 'f1-score': 0.489974257808361, 'support': 284061}, '2': {'precision': 0.3641886434666573, 'recall': 0.03529555904204089, 'f1-score': 0.06435419316806801, 'support': 293833}, 'accuracy': 0.3291375173225725, 'macro avg': {'precision': 0.34726489659423, 'recall': 0.3348700570339889, 'f1-score': 0.18526674253216693, 'support': 868087}, 'weighted avg': {'precision': 0.34747241794514633, 'recall': 0.3291375173225725, 'f1-score': 0.18260734530198272, 'support': 868087}}
[[   214 280539   9440]
 [   260 275135   8666]
 [   138 283324  10371]]
testing model out of sample: results/universal/W2/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 728s - 728s/epoch - 51ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1324574
{'0': {'precision': 0.23663412366341235, 'recall': 0.00042710765882069616, 'f1-score': 0.0008526762979441957, 'support': 1191737}, '1': {'precision': 0.32644461695279847, 'recall': 0.9660202943296633, 'f1-score': 0.48798558815521753, 'support': 1195802}, '2': {'precision': 0.39435467862956053, 'recall': 0.038826792495899765, 'f1-score': 0.07069336200902544, 'support': 1279194}, 'accuracy': 0.3287245076202712, 'macro avg': {'precision': 0.3191444730819238, 'recall': 0.3350913981614612, 'f1-score': 0.1865105421540624, 'support': 3666733}, 'weighted avg': {'precision': 0.32094644067307776, 'recall': 0.3287245076202712, 'f1-score': 0.18408235142898102, 'support': 3666733}}
[[    509 1154753   36475]
 [    830 1155169   39803]
 [    812 1228715   49667]]
Evaluating performance on  train set...
5373/5373 - 269s - 269s/epoch - 50ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1335006
{'0': {'precision': 0.3666369313113292, 'recall': 0.0008831094045779876, 'f1-score': 0.0017619747836114912, 'support': 465401}, '1': {'precision': 0.3324185323824437, 'recall': 0.9650511355915115, 'f1-score': 0.49450232261426624, 'support': 456238}, '2': {'precision': 0.32042146293927765, 'recall': 0.0348216117709094, 'f1-score': 0.06281666036496786, 'support': 453253}, 'accuracy': 0.33201662385118247, 'macro avg': {'precision': 0.33982564221101685, 'recall': 0.33358528558899964, 'f1-score': 0.18636031925428187, 'support': 1374892}, 'weighted avg': {'precision': 0.34004645469458084, 'recall': 0.33201662385118247, 'f1-score': 0.18539828237531233, 'support': 1374892}}
[[   411 447086  17904]
 [   375 440293  15570]
 [   335 437135  15783]]
Evaluating performance on  val set...
1685/1685 - 84s - 84s/epoch - 50ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1316518
{'0': {'precision': 0.2391304347826087, 'recall': 0.00038541586371695056, 'f1-score': 0.0007695913469947458, 'support': 142703}, '1': {'precision': 0.33755153514090314, 'recall': 0.9594005900355675, 'f1-score': 0.4993972185943712, 'support': 145076}, '2': {'precision': 0.312948845431444, 'recall': 0.039645049092677735, 'f1-score': 0.07037485636199882, 'support': 142893}, 'accuracy': 0.3364648735000186, 'macro avg': {'precision': 0.2965436051183186, 'recall': 0.3331436849973208, 'f1-score': 0.19018055543445492, 'support': 430672}, 'weighted avg': {'precision': 0.2967767960701406, 'recall': 0.3364648735000186, 'f1-score': 0.19183148249461837, 'support': 430672}}
[[    55 136015   6633]
 [    86 139186   5804]
 [    89 137139   5665]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1235019
{'0': {'precision': 0.18363273453093812, 'recall': 0.001142161913866094, 'f1-score': 0.002270203578038248, 'support': 80549}, '1': {'precision': 0.3489625147284964, 'recall': 0.9902637514593038, 'f1-score': 0.5160665343540307, 'support': 88227}, '2': {'precision': 0.24493554327808473, 'recall': 0.004765943214801897, 'f1-score': 0.009349955476402494, 'support': 83719}, 'accuracy': 0.3479633260064556, 'macro avg': {'precision': 0.25917693084583976, 'recall': 0.33205728552932395, 'f1-score': 0.17589556446949048, 'support': 252495}, 'weighted avg': {'precision': 0.2617283814268859, 'recall': 0.3479633260064556, 'f1-score': 0.18414873037877744, 'support': 252495}}
[[   92 79769   688]
 [  317 87368   542]
 [   92 83228   399]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1350387
{'0': {'precision': 0.2909090909090909, 'recall': 0.0007655136117889096, 'f1-score': 0.0015270089711777056, 'support': 20901}, '1': {'precision': 0.3199457122750578, 'recall': 0.9851416189444359, 'f1-score': 0.48302029975336747, 'support': 19383}, '2': {'precision': 0.32169576059850374, 'recall': 0.01273759565539373, 'f1-score': 0.024504915230089755, 'support': 20255}, 'accuracy': 0.3199425163943904, 'macro avg': {'precision': 0.31085018792755087, 'recall': 0.3328815760705395, 'f1-score': 0.16968407465154497, 'support': 60539}, 'weighted avg': {'precision': 0.3105063889565577, 'recall': 0.3199425163943904, 'f1-score': 0.16337642747008663, 'support': 60539}}
[[   16 20604   281]
 [   25 19095   263]
 [   14 19983   258]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1264582
{'0': {'precision': 0.25, 'recall': 0.00013180440226703572, 'f1-score': 0.0002634698985640891, 'support': 7587}, '1': {'precision': 0.34397793155040207, 'recall': 0.991108716152499, 'f1-score': 0.5107077158029919, 'support': 7423}, '2': {'precision': 0.25961538461538464, 'recall': 0.00819423368740516, 'f1-score': 0.01588702559576346, 'support': 6590}, 'accuracy': 0.34314814814814815, 'macro avg': {'precision': 0.28453110538859555, 'recall': 0.3331449180807237, 'f1-score': 0.17561940376577315, 'support': 21600}, 'weighted avg': {'precision': 0.2852297949312046, 'recall': 0.34314814814814815, 'f1-score': 0.18044804718528223, 'support': 21600}}
[[   1 7498   88]
 [   0 7357   66]
 [   3 6533   54]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
1242/1242 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0942556
{'0': {'precision': 0.26811594202898553, 'recall': 0.0004192872117400419, 'f1-score': 0.0008372650849145197, 'support': 88245}, '1': {'precision': 0.3913170144716425, 'recall': 0.9946314018721678, 'f1-score': 0.5616604284698123, 'support': 124241}, '2': {'precision': 0.40138963121325494, 'recall': 0.007131123413063914, 'f1-score': 0.014013285565009703, 'support': 105313}, 'accuracy': 0.39132281725241425, 'macro avg': {'precision': 0.353607529237961, 'recall': 0.33406060416565725, 'f1-score': 0.19217032637324552, 'support': 317799}, 'weighted avg': {'precision': 0.36044498167483435, 'recall': 0.39132281725241425, 'f1-score': 0.22445293689924803, 'support': 317799}}
[[    37  87704    504]
 [    51 123574    616]
 [    50 104512    751]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.128442
{'0': {'precision': 0.25675675675675674, 'recall': 0.000815625670744795, 'f1-score': 0.0016260858402156705, 'support': 46590}, '1': {'precision': 0.3306672624366994, 'recall': 0.995783808028706, 'f1-score': 0.4964722983172135, 'support': 44590}, '2': {'precision': 0.37037037037037035, 'recall': 0.004115790917821375, 'f1-score': 0.008141112618724558, 'support': 43734}, 'accuracy': 0.3307292052715063, 'macro avg': {'precision': 0.3192647965212755, 'recall': 0.3335717415390907, 'f1-score': 0.1687464989253846, 'support': 134914}, 'weighted avg': {'precision': 0.3180139074308634, 'recall': 0.3307292052715063, 'f1-score': 0.16728806899600854, 'support': 134914}}
[[   38 46392   160]
 [   42 44402   146]
 [   68 43486   180]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1150036
{'0': {'precision': 0.4, 'recall': 0.00041911148365465214, 'f1-score': 0.0008373456144023446, 'support': 14316}, '1': {'precision': 0.38833552745969846, 'recall': 0.9923828868858703, 'f1-score': 0.5582275543177476, 'support': 15754}, '2': {'precision': 0.2897196261682243, 'recall': 0.008836104513064134, 'f1-score': 0.017149179420984696, 'support': 10525}, 'accuracy': 0.387560044340436, 'macro avg': {'precision': 0.35935171787597425, 'recall': 0.33387936762752973, 'f1-score': 0.1920713597843782, 'support': 40595}, 'weighted avg': {'precision': 0.366881068235513, 'recall': 0.387560044340436, 'f1-score': 0.22137700317633813, 'support': 40595}}
[[    6 14196   114]
 [    6 15634   114]
 [    3 10429    93]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.141808
{'0': {'precision': 0.18181818181818182, 'recall': 2.4025466995014715e-05, 'f1-score': 4.804458537522821e-05, 'support': 83245}, '1': {'precision': 0.2915091617904883, 'recall': 0.9823260335780434, 'f1-score': 0.44959825210429183, 'support': 80231}, '2': {'precision': 0.4153645833333333, 'recall': 0.01440349657296116, 'f1-score': 0.027841538877785246, 'support': 110737}, 'accuracy': 0.2932391972663586, 'macro avg': {'precision': 0.29623064231400115, 'recall': 0.33225118520599983, 'f1-score': 0.15916261185581743, 'support': 274213}, 'weighted avg': {'precision': 0.3082266485164837, 'recall': 0.2932391972663586, 'f1-score': 0.14280433577838508, 'support': 274213}}
[[     2  82413    830]
 [     3  78813   1415]
 [     6 109136   1595]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1223526
{'0': {'precision': 0.6666666666666666, 'recall': 8.227743952608195e-05, 'f1-score': 0.0001645345728271153, 'support': 24308}, '1': {'precision': 0.34823348694316436, 'recall': 0.9817716535433071, 'f1-score': 0.5141119472219359, 'support': 25400}, '2': {'precision': 0.3288826423049895, 'recall': 0.020061728395061727, 'f1-score': 0.037816653872570806, 'support': 23328}, 'accuracy': 0.34786954378662577, 'macro avg': {'precision': 0.4479275986382735, 'recall': 0.33397188645929826, 'f1-score': 0.18403104522244462, 'support': 73036}, 'weighted avg': {'precision': 0.4480343690971644, 'recall': 0.34786954378662577, 'f1-score': 0.19092817059221184, 'support': 73036}}
[[    2 23813   493]
 [    1 24937   462]
 [    0 22860   468]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1464002
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9921}, '1': {'precision': 0.2965909870361479, 'recall': 0.9747520288548241, 'f1-score': 0.45479884301866946, 'support': 8872}, '2': {'precision': 0.3574730354391371, 'recall': 0.021060275962236745, 'f1-score': 0.0397771110158594, 'support': 11016}, 'accuracy': 0.297896608406857, 'macro avg': {'precision': 0.21802134082509497, 'recall': 0.3319374349390203, 'f1-score': 0.16485865134484295, 'support': 29809}, 'weighted avg': {'precision': 0.22037901960422146, 'recall': 0.297896608406857, 'f1-score': 0.15006071958845793, 'support': 29809}}
[[    0  9728   193]
 [    0  8648   224]
 [    2 10782   232]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1593399
{'0': {'precision': 0.022988505747126436, 'recall': 2.929759027320003e-05, 'f1-score': 5.852059925093633e-05, 'support': 68265}, '1': {'precision': 0.2744548499555677, 'recall': 0.9976642480866713, 'f1-score': 0.4304845229287958, 'support': 60366}, '2': {'precision': 0.523696682464455, 'recall': 0.0024202468432753276, 'f1-score': 0.004818226413037553, 'support': 91313}, 'accuracy': 0.2748335940057469, 'macro avg': {'precision': 0.27371334605571634, 'recall': 0.33337126417340657, 'f1-score': 0.14512042331369476, 'support': 219944}, 'weighted avg': {'precision': 0.29988254729895863, 'recall': 0.2748335940057469, 'f1-score': 0.12016963558124455, 'support': 219944}}
[[    2 68189    74]
 [   14 60225   127]
 [   71 91021   221]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1325296
{'0': {'precision': 0.5, 'recall': 0.00014381246854102252, 'f1-score': 0.00028754223276543746, 'support': 27814}, '1': {'precision': 0.33047368550428946, 'recall': 0.9962946494738403, 'f1-score': 0.496317489616982, 'support': 26988}, '2': {'precision': 0.3108974358974359, 'recall': 0.0036086309523809526, 'f1-score': 0.007134451309208592, 'support': 26880}, 'accuracy': 0.33041551382189466, 'macro avg': {'precision': 0.3804570404672418, 'recall': 0.33334903096492075, 'f1-score': 0.16791316105298537, 'support': 81682}, 'weighted avg': {'precision': 0.3817578769044936, 'recall': 0.33041551382189466, 'f1-score': 0.16643064764130133, 'support': 81682}}
[[    4 27693   117]
 [    2 26888    98]
 [    2 26781    97]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1459678
{'0': {'precision': 1.0, 'recall': 0.0005585968048262764, 'f1-score': 0.0011165698972755696, 'support': 8951}, '1': {'precision': 0.30145788987509536, 'recall': 0.9966803877307131, 'f1-score': 0.4629047178538391, 'support': 7531}, '2': {'precision': 0.2982456140350877, 'recall': 0.0020049534143177263, 'f1-score': 0.003983130271790066, 'support': 8479}, 'accuracy': 0.30159048115059495, 'macro avg': {'precision': 0.5332345013033944, 'recall': 0.3330813126499524, 'f1-score': 0.15600147267430156, 'support': 24961}, 'weighted avg': {'precision': 0.5508635042687733, 'recall': 0.30159048115059495, 'f1-score': 0.14141672244230133, 'support': 24961}}
[[   5 8931   15]
 [   0 7506   25]
 [   0 8462   17]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
1914/1914 - 37s - 37s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402913
{'0': {'precision': 0.3695652173913043, 'recall': 0.00010492661309237245, 'f1-score': 0.000209793661763254, 'support': 162018}, '1': {'precision': 0.3145647521256485, 'recall': 0.9797364769352475, 'f1-score': 0.4762269479404042, 'support': 154218}, '2': {'precision': 0.4221384438161064, 'recall': 0.02320894963813384, 'f1-score': 0.04399886482710443, 'support': 173683}, 'accuracy': 0.31666663264743766, 'macro avg': {'precision': 0.3687561377776864, 'recall': 0.33435011772882456, 'f1-score': 0.17347853547642397, 'support': 489919}, 'weighted avg': {'precision': 0.37088995460868107, 'recall': 0.31666663264743766, 'f1-score': 0.16557555972871188, 'support': 489919}}
[[    17 159602   2399]
 [     6 151093   3119]
 [    23 169629   4031]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1251734
{'0': {'precision': 0.15, 'recall': 4.8033815806327656e-05, 'f1-score': 9.603687816121391e-05, 'support': 62456}, '1': {'precision': 0.340953884745459, 'recall': 0.9753491799077396, 'f1-score': 0.5052773951574091, 'support': 62432}, '2': {'precision': 0.35012312513991495, 'recall': 0.026875161096314118, 'f1-score': 0.04991861096039067, 'support': 58195}, 'accuracy': 0.34115674311651, 'macro avg': {'precision': 0.28035900329512464, 'recall': 0.33409079160662003, 'f1-score': 0.1850973476653203, 'support': 183083}, 'weighted avg': {'precision': 0.27872739795582246, 'recall': 0.34115674311651, 'f1-score': 0.1882014713467102, 'support': 183083}}
[[    3 61081  1372]
 [    8 60893  1531]
 [    9 56622  1564]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.145813
{'0': {'precision': 0.14285714285714285, 'recall': 5.36797466315959e-05, 'f1-score': 0.0001073191672032625, 'support': 18629}, '1': {'precision': 0.3019847271233593, 'recall': 0.9759246967959935, 'f1-score': 0.46124451035190783, 'support': 16573}, '2': {'precision': 0.359375, 'recall': 0.020100760847213656, 'f1-score': 0.038072054527750726, 'support': 19452}, 'accuracy': 0.3031068174333077, 'macro avg': {'precision': 0.2680722899935007, 'recall': 0.33202637912994626, 'f1-score': 0.1664746280156206, 'support': 54654}, 'weighted avg': {'precision': 0.2681714256394984, 'recall': 0.3031068174333077, 'f1-score': 0.15345230218285588, 'support': 54654}}
[[    1 18329   299]
 [    1 16174   398]
 [    5 19056   391]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
4918/4918 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1439508
{'0': {'precision': 0.42362344582593253, 'recall': 0.0011520570376918283, 'f1-score': 0.002297864960690612, 'support': 414042}, '1': {'precision': 0.32876002760358447, 'recall': 0.9558310581696997, 'f1-score': 0.4892436955983882, 'support': 411692}, '2': {'precision': 0.3325982852535093, 'recall': 0.04666535828494245, 'f1-score': 0.08184711828166003, 'support': 433105}, 'accuracy': 0.3290301619190381, 'macro avg': {'precision': 0.3616605862276754, 'recall': 0.3345494911641113, 'f1-score': 0.1911295596135796, 'support': 1258839}, 'weighted avg': {'precision': 0.3612819052917464, 'recall': 0.3290301619190381, 'f1-score': 0.18891814147458436, 'support': 1258839}}
[[   477 390845  22720]
 [   348 393508  17836]
 [   301 412593  20211]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1279718
{'0': {'precision': 0.3684210526315789, 'recall': 0.0010475469941220975, 'f1-score': 0.002089153809804101, 'support': 120281}, '1': {'precision': 0.3358931271567424, 'recall': 0.9590636005800705, 'f1-score': 0.4975345739993208, 'support': 120675}, '2': {'precision': 0.3424248881312593, 'recall': 0.040847624212024675, 'f1-score': 0.07298850139663748, 'support': 118024}, 'accuracy': 0.33618028859546495, 'macro avg': {'precision': 0.34891302263986024, 'recall': 0.3336529239287391, 'f1-score': 0.19087074306858745, 'support': 358980}, 'weighted avg': {'precision': 0.348939525176953, 'recall': 0.33618028859546495, 'f1-score': 0.19194847934592962, 'support': 358980}}
[[   126 115709   4446]
 [   128 115735   4812]
 [    88 113115   4821]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1495636
{'0': {'precision': 0.45555555555555555, 'recall': 0.0009507246376811594, 'f1-score': 0.001897489297697559, 'support': 43125}, '1': {'precision': 0.29412316695529034, 'recall': 0.9539593824359471, 'f1-score': 0.44962018713526547, 'support': 36142}, '2': {'precision': 0.39045151739452255, 'recall': 0.04856156501726122, 'f1-score': 0.08637982560281655, 'support': 43450}, 'accuracy': 0.2984835026931884, 'macro avg': {'precision': 0.38004341330178953, 'recall': 0.33449055736362987, 'f1-score': 0.17929916734525986, 'support': 122717}, 'weighted avg': {'precision': 0.38496012177793987, 'recall': 0.2984835026931884, 'f1-score': 0.16367092947063858, 'support': 122717}}
[[   41 41422  1662]
 [   32 34478  1632]
 [   17 41323  2110]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
4856/4856 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1300474
{'0': {'precision': 0.2433234421364985, 'recall': 0.00039827769183506444, 'f1-score': 0.0007952536932017932, 'support': 411773}, '1': {'precision': 0.3424482708630943, 'recall': 0.9873919782077776, 'f1-score': 0.5085282624549641, 'support': 425840}, '2': {'precision': 0.3754602931980824, 'recall': 0.013333596518065987, 'f1-score': 0.025752647819197734, 'support': 405292}, 'accuracy': 0.34277680112317516, 'macro avg': {'precision': 0.3204106687325584, 'recall': 0.3337079508058929, 'f1-score': 0.17835872132245453, 'support': 1242905}, 'weighted avg': {'precision': 0.32037303619669216, 'recall': 0.34277680112317516, 'f1-score': 0.18289127602091146, 'support': 1242905}}
[[   164 407865   3744]
 [   124 420471   5245]
 [   386 399502   5404]]
Evaluating performance on  train set...
2076/2076 - 38s - 38s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1295978
{'0': {'precision': 0.3348694316436252, 'recall': 0.0012377643024232927, 'f1-score': 0.002466412105784189, 'support': 176124}, '1': {'precision': 0.33087786266848657, 'recall': 0.9851633569686054, 'f1-score': 0.4953777147238165, 'support': 175444}, '2': {'precision': 0.4084406294706724, 'recall': 0.01905005504832019, 'f1-score': 0.03640227381395102, 'support': 179842}, 'accuracy': 0.33210703599856983, 'macro avg': {'precision': 0.35806264126092807, 'recall': 0.3351503921064496, 'f1-score': 0.17808213354785055, 'support': 531410}, 'weighted avg': {'precision': 0.358449895941131, 'recall': 0.33210703599856983, 'f1-score': 0.17668485703124326, 'support': 531410}}
[[   218 173298   2608]
 [   249 172841   2354]
 [   184 176232   3426]]
Evaluating performance on  val set...
588/588 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10875
{'0': {'precision': 0.22972972972972974, 'recall': 0.0003604214811202748, 'f1-score': 0.0007197138079210856, 'support': 47167}, '1': {'precision': 0.3717953904869793, 'recall': 0.9890401621553749, 'f1-score': 0.5404335190712125, 'support': 55749}, '2': {'precision': 0.3940020682523268, 'recall': 0.016077984555006964, 'f1-score': 0.030895231916964, 'support': 47394}, 'accuracy': 0.3720111769010711, 'macro avg': {'precision': 0.33184239615634525, 'recall': 0.3351595227305007, 'f1-score': 0.1906828215986992, 'support': 150310}, 'weighted avg': {'precision': 0.3342174001009351, 'recall': 0.3720111769010711, 'f1-score': 0.21041064212196015, 'support': 150310}}
[[   17 46556   594]
 [   33 55138   578]
 [   24 46608   762]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
4353/4353 - 82s - 82s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1254532
{'0': {'precision': 0.23790322580645162, 'recall': 0.0007500959868593353, 'f1-score': 0.0014954768163072877, 'support': 393283}, '1': {'precision': 0.3468999752254939, 'recall': 0.9787100749185836, 'f1-score': 0.512238875535527, 'support': 386286}, '2': {'precision': 0.2994228615729176, 'recall': 0.020769660521213318, 'f1-score': 0.038844824647912904, 'support': 334719}, 'accuracy': 0.3457894188934997, 'macro avg': {'precision': 0.29474202086828766, 'recall': 0.3334099438088855, 'f1-score': 0.18419305899991575, 'support': 1114288}, 'weighted avg': {'precision': 0.2941684905407033, 'recall': 0.3457894188934997, 'f1-score': 0.18977226062309666, 'support': 1114288}}
[[   295 384252   8736]
 [   694 378062   7530]
 [   251 327516   6952]]
Evaluating performance on  train set...
1542/1542 - 29s - 29s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.126537
{'0': {'precision': 0.3357142857142857, 'recall': 0.0006867680258341674, 'f1-score': 0.0013707319562823999, 'support': 136873}, '1': {'precision': 0.33259554107072425, 'recall': 0.9797367536001468, 'f1-score': 0.4966060455781733, 'support': 130828}, '2': {'precision': 0.37802000224744353, 'recall': 0.026517002727373052, 'f1-score': 0.04955767856748256, 'support': 126862}, 'accuracy': 0.33362226057689137, 'macro avg': {'precision': 0.3487766096774845, 'recall': 0.335646841451118, 'f1-score': 0.18251148536731276, 'support': 394563}, 'weighted avg': {'precision': 0.3482825414468344, 'recall': 0.33362226057689137, 'f1-score': 0.18107267570548044, 'support': 394563}}
[[    94 133788   2991]
 [   107 128177   2544]
 [    79 123419   3364]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1371808
{'0': {'precision': 0.35911602209944754, 'recall': 0.0015578190533253446, 'f1-score': 0.0031021810719228746, 'support': 41725}, '1': {'precision': 0.32271675627090995, 'recall': 0.9763079711969385, 'f1-score': 0.4850884435437465, 'support': 39718}, '2': {'precision': 0.33961629081117467, 'recall': 0.024100126591348796, 'f1-score': 0.0450064677282662, 'support': 41867}, 'accuracy': 0.32317735787851753, 'macro avg': {'precision': 0.3404830230605107, 'recall': 0.3339886389472042, 'f1-score': 0.17773236411464519, 'support': 123310}, 'weighted avg': {'precision': 0.34077118964446435, 'recall': 0.32317735787851753, 'f1-score': 0.17257697745743109, 'support': 123310}}
[[   65 40562  1098]
 [   77 38777   864]
 [   39 40819  1009]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
5497/5497 - 103s - 103s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1316718
{'0': {'precision': 0.2619047619047619, 'recall': 0.0005328612446934066, 'f1-score': 0.0010635586143852894, 'support': 454152}, '1': {'precision': 0.31861458639554996, 'recall': 0.9328975197077485, 'f1-score': 0.4750010102844107, 'support': 447286}, '2': {'precision': 0.3972183127742363, 'recall': 0.07589325435035778, 'f1-score': 0.12743797674283486, 'support': 505763}, 'accuracy': 0.32397503981307574, 'macro avg': {'precision': 0.3259125536915161, 'recall': 0.3364412117675999, 'f1-score': 0.20116751521387696, 'support': 1407201}, 'weighted avg': {'precision': 0.32856339701487386, 'recall': 0.32397503981307574, 'f1-score': 0.1971272992197274, 'support': 1407201}}
[[   242 425257  28653]
 [   419 417272  29595]
 [   263 467116  38384]]
Evaluating performance on  train set...
2058/2058 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1417266
{'0': {'precision': 0.3590504451038576, 'recall': 0.0006662555337753012, 'f1-score': 0.0013300430340370106, 'support': 181612}, '1': {'precision': 0.3299203617370372, 'recall': 0.934853870571901, 'f1-score': 0.48771918224060307, 'support': 173579}, '2': {'precision': 0.2914429239563485, 'recall': 0.05881736029784482, 'f1-score': 0.09788094303125501, 'support': 171633}, 'accuracy': 0.32740915372116686, 'macro avg': {'precision': 0.32680457693241444, 'recall': 0.3314458288011737, 'f1-score': 0.19564338943529835, 'support': 526824}, 'weighted avg': {'precision': 0.3274268812232452, 'recall': 0.32740915372116686, 'f1-score': 0.19304162225889968, 'support': 526824}}
[[   121 168158  13333]
 [    98 162271  11210]
 [   118 161420  10095]]
Evaluating performance on  val set...
681/681 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1450611
{'0': {'precision': 0.23140495867768596, 'recall': 0.00047138840721224265, 'f1-score': 0.0009408602150537635, 'support': 59399}, '1': {'precision': 0.324378551025383, 'recall': 0.9191980020900122, 'f1-score': 0.47953319041986986, 'support': 56459}, '2': {'precision': 0.29431249559517936, 'recall': 0.07145668280830239, 'f1-score': 0.11499380421313507, 'support': 58441}, 'accuracy': 0.32186644788553004, 'macro avg': {'precision': 0.28336533509941614, 'recall': 0.33037535776850896, 'f1-score': 0.1984892849493529, 'support': 174299}, 'weighted avg': {'precision': 0.28261337304239176, 'recall': 0.32186644788553004, 'f1-score': 0.1942076745468949, 'support': 174299}}
[[   28 53873  5498]
 [   47 51897  4515]
 [   46 54219  4176]]
testing model on single stock: results/universal/W2/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
14883/14883 - 283s - 283s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1188182
{'0': {'precision': 0.30409356725146197, 'recall': 0.000524088765854945, 'f1-score': 0.0010463741626072155, 'support': 1190638}, '1': {'precision': 0.36344677354830573, 'recall': 0.9638673426644133, 'f1-score': 0.5278546676193382, 'support': 1384620}, '2': {'precision': 0.32668433841396066, 'recall': 0.03593514228022559, 'f1-score': 0.06474802820385406, 'support': 1234641}, 'accuracy': 0.3621043497478542, 'macro avg': {'precision': 0.3314082264045761, 'recall': 0.3334421912368313, 'f1-score': 0.19788302332859983, 'support': 3809899}, 'weighted avg': {'precision': 0.33298491812495606, 'recall': 0.3621043497478542, 'f1-score': 0.21314595295280558, 'support': 3809899}}
[[    624 1147786   42228]
 [    815 1334590   49215]
 [    613 1189661   44367]]
Evaluating performance on  train set...
6147/6147 - 114s - 114s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1291354
{'0': {'precision': 0.30920245398773005, 'recall': 0.0004892168453667088, 'f1-score': 0.000976888068785325, 'support': 515109}, '1': {'precision': 0.3327392729606442, 'recall': 0.9579286103082667, 'f1-score': 0.49391555097023093, 'support': 521756}, '2': {'precision': 0.3579727393805435, 'recall': 0.047081733815362826, 'f1-score': 0.08321832417102823, 'support': 536620}, 'accuracy': 0.33385891826105746, 'macro avg': {'precision': 0.33330482210963924, 'recall': 0.33516652032299876, 'f1-score': 0.1927035877366815, 'support': 1573485}, 'weighted avg': {'precision': 0.3336396663332709, 'recall': 0.33385891826105746, 'f1-score': 0.19247925665952006, 'support': 1573485}}
[[   252 491141  23716]
 [   354 499805  21597]
 [   209 511146  25265]]
Evaluating performance on  val set...
2174/2174 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297331
{'0': {'precision': 0.24277456647398843, 'recall': 0.00046134581163909577, 'f1-score': 0.0009209415531021478, 'support': 182076}, '1': {'precision': 0.33313214295693966, 'recall': 0.9670715351835428, 'f1-score': 0.4955571474295469, 'support': 184916}, '2': {'precision': 0.3600992094248954, 'recall': 0.03677339693528642, 'f1-score': 0.06673209968161252, 'support': 189512}, 'accuracy': 0.33401377168897256, 'macro avg': {'precision': 0.31200197295194115, 'recall': 0.3347687593101561, 'f1-score': 0.18773672955475385, 'support': 556504}, 'weighted avg': {'precision': 0.3127524810044028, 'recall': 0.33401377168897256, 'f1-score': 0.18769076323470538, 'support': 556504}}
[[    84 175521   6471]
 [   176 178827   5913]
 [    86 182457   6969]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        78 (peak)  15.77 (ave)

============================================
