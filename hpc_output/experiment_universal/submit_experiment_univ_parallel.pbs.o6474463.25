This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W8/deepLOB_L1/h50
Epoch 1/50
7696/7696 - 180s - loss: 3.1142 - accuracy50: 0.4388 - val_loss: 3.3667 - val_accuracy50: 0.4011 - 180s/epoch - 23ms/step
Epoch 2/50
7696/7696 - 167s - loss: 3.0757 - accuracy50: 0.4544 - val_loss: 3.3935 - val_accuracy50: 0.3999 - 167s/epoch - 22ms/step
Epoch 3/50
7696/7696 - 160s - loss: 3.0372 - accuracy50: 0.4674 - val_loss: 3.5315 - val_accuracy50: 0.3863 - 160s/epoch - 21ms/step
Epoch 4/50
7696/7696 - 161s - loss: 3.0143 - accuracy50: 0.4743 - val_loss: 3.4963 - val_accuracy50: 0.3792 - 161s/epoch - 21ms/step
Epoch 5/50
7696/7696 - 162s - loss: 3.0004 - accuracy50: 0.4776 - val_loss: 3.5339 - val_accuracy50: 0.3913 - 162s/epoch - 21ms/step
Epoch 6/50
7696/7696 - 161s - loss: 2.9928 - accuracy50: 0.4794 - val_loss: 3.5077 - val_accuracy50: 0.3976 - 161s/epoch - 21ms/step
Epoch 7/50
7696/7696 - 158s - loss: 2.9860 - accuracy50: 0.4812 - val_loss: 3.4942 - val_accuracy50: 0.3975 - 158s/epoch - 20ms/step
Epoch 8/50
7696/7696 - 158s - loss: 2.9796 - accuracy50: 0.4826 - val_loss: 3.5041 - val_accuracy50: 0.3990 - 158s/epoch - 21ms/step
Epoch 9/50
7696/7696 - 159s - loss: 2.9748 - accuracy50: 0.4841 - val_loss: 3.4827 - val_accuracy50: 0.4037 - 159s/epoch - 21ms/step
Epoch 10/50
7696/7696 - 162s - loss: 2.9704 - accuracy50: 0.4850 - val_loss: 3.5586 - val_accuracy50: 0.4014 - 162s/epoch - 21ms/step
Epoch 11/50
7696/7696 - 162s - loss: 2.9668 - accuracy50: 0.4857 - val_loss: 3.6245 - val_accuracy50: 0.3978 - 162s/epoch - 21ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 264s - 264s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1022469
{'0': {'precision': 0.3584918290429139, 'recall': 0.072093838580177, 'f1-score': 0.12004603960926757, 'support': 1708551}, '1': {'precision': 0.41705711040723287, 'recall': 0.8345833115012306, 'f1-score': 0.5561803505164491, 'support': 2538311}, '2': {'precision': 0.4025759626396181, 'recall': 0.126330576988821, 'f1-score': 0.1923124402198577, 'support': 1714106}, 'accuracy': 0.4123746344553435, 'macro avg': {'precision': 0.3927083006965883, 'recall': 0.3443359090234095, 'f1-score': 0.2895129434485248, 'support': 5960968}, 'weighted avg': {'precision': 0.396106823085502, 'recall': 0.4123746344553435, 'f1-score': 0.3265421640202919, 'support': 5960968}}
[[ 123176 1514818   70557]
 [ 169084 2118432  250795]
 [  51335 1446227  216544]]
Evaluating performance on  train set...
7696/7696 - 91s - 91s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1254492
{'0': {'precision': 0.388120318630365, 'recall': 0.1342139279100899, 'f1-score': 0.1994552446450109, 'support': 608074}, '1': {'precision': 0.37828623481627066, 'recall': 0.7885217096543112, 'f1-score': 0.5112870717577438, 'support': 755217}, '2': {'precision': 0.4016930919470017, 'recall': 0.12258223095437232, 'f1-score': 0.18784189611413896, 'support': 606189}, 'accuracy': 0.3815347198245222, 'macro avg': {'precision': 0.3893665484645458, 'recall': 0.3484392895062578, 'f1-score': 0.29952807083896454, 'support': 1969480}, 'weighted avg': {'precision': 0.3885269227127674, 'recall': 0.3815347198245222, 'f1-score': 0.31545581984456406, 'support': 1969480}}
[[ 81612 496120  30342]
 [ 79375 595505  80337]
 [ 49288 482593  74308]]
Evaluating performance on  val set...
2338/2338 - 26s - 26s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997503
{'0': {'precision': 0.3897509313136911, 'recall': 0.141769274271668, 'f1-score': 0.20791197060212274, 'support': 178593}, '1': {'precision': 0.40412302555758933, 'recall': 0.7851974117492097, 'f1-score': 0.5336095197601038, 'support': 242944}, '2': {'precision': 0.3916691343401441, 'recall': 0.13508621619014655, 'f1-score': 0.20088681131844624, 'support': 176243}, 'accuracy': 0.401294790725685, 'macro avg': {'precision': 0.3951810304038082, 'recall': 0.35401763407034137, 'f1-score': 0.3141361005602243, 'support': 597780}, 'weighted avg': {'precision': 0.396157441936296, 'recall': 0.401294790725685, 'f1-score': 0.33820761487761464, 'support': 597780}}
[[ 25319 145232   8042]
 [ 23249 190759  28936]
 [ 16394 136041  23808]]
testing model out of sample: results/universal/W8/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 162s - 162s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0434219
{'0': {'precision': 0.4145724216359938, 'recall': 0.1117104324716845, 'f1-score': 0.17599685853461178, 'support': 926789}, '1': {'precision': 0.4950060433197295, 'recall': 0.7765128806071808, 'f1-score': 0.6045974800423198, 'support': 1764746}, '2': {'precision': 0.3782063712837522, 'recall': 0.24465274616184018, 'f1-score': 0.29711125600905103, 'support': 924727}, 'accuracy': 0.4701310358596805, 'macro avg': {'precision': 0.42926161207982516, 'recall': 0.37762535308023515, 'f1-score': 0.3592351981953275, 'support': 3616262}, 'weighted avg': {'precision': 0.4445249647558807, 'recall': 0.4701310358596805, 'f1-score': 0.4161257501460569, 'support': 3616262}}
[[ 103532  745202   78055]
 [ 100506 1370348  293892]
 [  45694  652796  226237]]
Evaluating performance on  train set...
4550/4550 - 55s - 55s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0788243
{'0': {'precision': 0.4006519156929367, 'recall': 0.13221995332555425, 'f1-score': 0.19882519859901163, 'support': 329088}, '1': {'precision': 0.4396463502988589, 'recall': 0.7653391612456966, 'f1-score': 0.5584773688293742, 'support': 507443}, '2': {'precision': 0.40042279369061723, 'recall': 0.2104511324094988, 'f1-score': 0.27589794481080737, 'support': 327620}, 'accuracy': 0.430207077947792, 'macro avg': {'precision': 0.41357368656080423, 'recall': 0.3693367489935832, 'f1-score': 0.3444001707463977, 'support': 1164151}, 'weighted avg': {'precision': 0.41758476025462415, 'recall': 0.430207077947792, 'f1-score': 0.3772844786512681, 'support': 1164151}}
[[ 43512 256379  29197]
 [ 45034 388366  74043]
 [ 20057 238615  68948]]
Evaluating performance on  val set...
1570/1570 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0764159
{'0': {'precision': 0.39165385979430195, 'recall': 0.09060742253379887, 'f1-score': 0.1471681350410898, 'support': 109693}, '1': {'precision': 0.44762100017347695, 'recall': 0.7823805060918463, 'f1-score': 0.5694463671291142, 'support': 181390}, '2': {'precision': 0.3729675316920032, 'recall': 0.19881764438381083, 'f1-score': 0.25937197809695006, 'support': 109950}, 'accuracy': 0.4331688414669117, 'macro avg': {'precision': 0.40408079721992735, 'recall': 0.3572685243364853, 'f1-score': 0.325328826755718, 'support': 401033}, 'weighted avg': {'precision': 0.411845010693432, 'recall': 0.4331688414669117, 'f1-score': 0.36893008745507716, 'support': 401033}}
[[  9939  91282   8472]
 [ 11195 141916  28279]
 [  4243  83847  21860]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
645/645 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1683248
{'0': {'precision': 0.39157119476268415, 'recall': 0.017072518062617073, 'f1-score': 0.03271850800868391, 'support': 56055}, '1': {'precision': 0.33261129418912583, 'recall': 0.9211200117048904, 'f1-score': 0.488740957103556, 'support': 54678}, '2': {'precision': 0.3992945645292575, 'recall': 0.08147109298592017, 'f1-score': 0.13532981853849926, 'support': 54191}, 'accuracy': 0.33795566442725133, 'macro avg': {'precision': 0.3744923511603558, 'recall': 0.3398878742511426, 'f1-score': 0.21892976121691302, 'support': 164924}, 'weighted avg': {'precision': 0.3745617097117477, 'recall': 0.33795566442725133, 'f1-score': 0.21762188775044763, 'support': 164924}}
[[  957 51792  3306]
 [  977 50365  3336]
 [  510 49266  4415]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1748927
{'0': {'precision': 0.413329348475792, 'recall': 0.07347003824904377, 'f1-score': 0.12476319350473612, 'support': 18824}, '1': {'precision': 0.33892327144473283, 'recall': 0.8034812789230122, 'f1-score': 0.4767461815685602, 'support': 19016}, '2': {'precision': 0.4287842328406096, 'recall': 0.19374546960753858, 'f1-score': 0.26689490389073145, 'support': 19314}, 'accuracy': 0.35700038492493963, 'macro avg': {'precision': 0.39367895092037813, 'recall': 0.3568989289265316, 'f1-score': 0.28946809298800924, 'support': 57154}, 'weighted avg': {'precision': 0.39379597680975753, 'recall': 0.35700038492493963, 'f1-score': 0.28990369732628474, 'support': 57154}}
[[ 1383 15138  2303]
 [ 1055 15279  2682]
 [  908 14664  3742]]
Evaluating performance on  val set...
68/68 - 1s - 927ms/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1741676
{'0': {'precision': 0.3980482794042116, 'recall': 0.12732051913914902, 'f1-score': 0.19293004729897936, 'support': 6087}, '1': {'precision': 0.3050872306113473, 'recall': 0.7908037241117234, 'f1-score': 0.4403067971436128, 'support': 5263}, '2': {'precision': 0.4071601941747573, 'recall': 0.11397995583489044, 'f1-score': 0.1781021897810219, 'support': 5887}, 'accuracy': 0.3253466380460637, 'macro avg': {'precision': 0.37009856806343877, 'recall': 0.3440347330285876, 'f1-score': 0.2704463447412047, 'support': 17237}, 'weighted avg': {'precision': 0.37277635519798996, 'recall': 0.3253466380460637, 'f1-score': 0.26339777586103136, 'support': 17237}}
[[ 775 4845  467]
 [ 591 4162  510]
 [ 581 4635  671]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
2179/2179 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96504056
{'0': {'precision': 0.26778242677824265, 'recall': 0.003984524391870858, 'f1-score': 0.007852210186840536, 'support': 112435}, '1': {'precision': 0.6213572753069734, 'recall': 0.8368179591109527, 'f1-score': 0.7131693293483788, 'support': 336765}, '2': {'precision': 0.35684339839712964, 'recall': 0.33707865168539325, 'f1-score': 0.34667954874825946, 'support': 108580}, 'accuracy': 0.5716572842339274, 'macro avg': {'precision': 0.41532770016078197, 'recall': 0.39262704506273893, 'f1-score': 0.3559003627611596, 'support': 557780}, 'weighted avg': {'precision': 0.49859363220539443, 'recall': 0.5716572842339274, 'f1-score': 0.49965183020805726, 'support': 557780}}
[[   448  99991  11996]
 [   984 281811  53970]
 [   241  71739  36600]]
Evaluating performance on  train set...
614/614 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9950873
{'0': {'precision': 0.3879210220673635, 'recall': 0.1717781447094172, 'f1-score': 0.2381148924993433, 'support': 36943}, '1': {'precision': 0.5555927874731704, 'recall': 0.7348033872725749, 'f1-score': 0.6327536770014647, 'support': 83489}, '2': {'precision': 0.3768187667029595, 'recall': 0.311580957577411, 'f1-score': 0.34110865539692964, 'support': 36655}, 'accuracy': 0.5036381113650398, 'macro avg': {'precision': 0.4401108587478311, 'recall': 0.40605416318646775, 'f1-score': 0.4039924082992459, 'support': 157087}, 'weighted avg': {'precision': 0.4744450173794083, 'recall': 0.5036381113650398, 'f1-score': 0.4718912957555558, 'support': 157087}}
[[ 6346 26457  4140]
 [ 7393 61348 14748]
 [ 2620 22614 11421]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94561976
{'0': {'precision': 0.3378731343283582, 'recall': 0.1774272558048398, 'f1-score': 0.2326716772660114, 'support': 10207}, '1': {'precision': 0.6096941654440808, 'recall': 0.7644145737530952, 'f1-score': 0.6783438490755564, 'support': 28270}, '2': {'precision': 0.42367199587416193, 'recall': 0.3258950709114351, 'f1-score': 0.36840630080161446, 'support': 10083}, 'accuracy': 0.5499794069192752, 'macro avg': {'precision': 0.4570797652155337, 'recall': 0.4225789668231233, 'f1-score': 0.4264739423810608, 'support': 48560}, 'weighted avg': {'precision': 0.5139334817461468, 'recall': 0.5499794069192752, 'f1-score': 0.5203109792875378, 'support': 48560}}
[[ 1811  7574   822]
 [ 3012 21610  3648]
 [  537  6260  3286]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1005088
{'0': {'precision': 0.36515391206907916, 'recall': 0.28427561610796803, 'f1-score': 0.3196785758080688, 'support': 77949}, '1': {'precision': 0.4568492110004124, 'recall': 0.5985865422899721, 'f1-score': 0.5182007312299189, 'support': 140648}, '2': {'precision': 0.29549480902943137, 'recall': 0.19668805315345014, 'f1-score': 0.23617359794764045, 'support': 78866}, 'accuracy': 0.4096677569983494, 'macro avg': {'precision': 0.372499310699641, 'recall': 0.3598500705171301, 'f1-score': 0.3580176349952094, 'support': 297463}, 'weighted avg': {'precision': 0.3900411268950215, 'recall': 0.4096677569983494, 'f1-score': 0.3914052797404296, 'support': 297463}}
[[22159 49426  6364]
 [25839 84190 30619]
 [12686 50668 15512]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1607656
{'0': {'precision': 0.42208222811671087, 'recall': 0.13661729984975315, 'f1-score': 0.2064212745257013, 'support': 27954}, '1': {'precision': 0.3339344652761237, 'recall': 0.7059162021219205, 'f1-score': 0.4533915433745654, 'support': 27805}, '2': {'precision': 0.40708301599390706, 'recall': 0.2305286992775761, 'f1-score': 0.29436196333096215, 'support': 27823}, 'accuracy': 0.35726591849919836, 'macro avg': {'precision': 0.3876999031289139, 'recall': 0.35768740041641656, 'f1-score': 0.31805826041040963, 'support': 83582}, 'weighted avg': {'precision': 0.387765370124855, 'recall': 0.35726591849919836, 'f1-score': 0.31785414416236274, 'support': 83582}}
[[ 3819 20124  4011]
 [ 2846 19628  5331]
 [ 2383 19026  6414]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1446134
{'0': {'precision': 0.40810126582278483, 'recall': 0.1607338717718616, 'f1-score': 0.23063166177838185, 'support': 10029}, '1': {'precision': 0.36728878757657785, 'recall': 0.6692627206645898, 'f1-score': 0.47428939380001844, 'support': 11556}, '2': {'precision': 0.4135593220338983, 'recall': 0.2749093759184873, 'f1-score': 0.3302730696798494, 'support': 10207}, 'accuracy': 0.38223452440865624, 'macro avg': {'precision': 0.39631645847775365, 'recall': 0.3683019894516462, 'f1-score': 0.34506470841941655, 'support': 31792}, 'weighted avg': {'precision': 0.3950187727784236, 'recall': 0.38223452440865624, 'f1-score': 0.35118867617484356, 'support': 31792}}
[[1612 6814 1603]
 [1446 7734 2376]
 [ 892 6509 2806]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1752421
{'0': {'precision': 0.3586073212554984, 'recall': 0.09104330708661418, 'f1-score': 0.14521850705713638, 'support': 105664}, '1': {'precision': 0.3471163219831488, 'recall': 0.7298724354398872, 'f1-score': 0.47047962861373116, 'support': 109278}, '2': {'precision': 0.3631514593042831, 'recall': 0.20891824938067713, 'f1-score': 0.26524378405663923, 'support': 98091}, 'accuracy': 0.3509917484738031, 'macro avg': {'precision': 0.3562917008476434, 'recall': 0.3432779973023929, 'f1-score': 0.2936473065758356, 'support': 313033}, 'weighted avg': {'precision': 0.35601981650954356, 'recall': 0.3509917484738031, 'f1-score': 0.2963760025532016, 'support': 313033}}
[[ 9620 79296 16748]
 [10329 79759 19190]
 [ 6877 70721 20493]]
Evaluating performance on  train set...
358/358 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1757903
{'0': {'precision': 0.37778867369453295, 'recall': 0.14796914508849981, 'f1-score': 0.2126494940202392, 'support': 31243}, '1': {'precision': 0.3240223463687151, 'recall': 0.6595484446795147, 'f1-score': 0.4345562851884522, 'support': 30251}, '2': {'precision': 0.37010110189708056, 'recall': 0.21774436090225563, 'f1-score': 0.27417895689129207, 'support': 29925}, 'accuracy': 0.3400934160294906, 'macro avg': {'precision': 0.3573040406534429, 'recall': 0.3417539835567567, 'f1-score': 0.3071282453666611, 'support': 91419}, 'weighted avg': {'precision': 0.35748068789319976, 'recall': 0.3400934160294906, 'f1-score': 0.3062205406959398, 'support': 91419}}
[[ 4623 21730  4890]
 [ 4099 19952  6200]
 [ 3515 19894  6516]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1934223
{'0': {'precision': 0.3733105218135158, 'recall': 0.2552345303544274, 'f1-score': 0.30318188133944696, 'support': 8549}, '1': {'precision': 0.32483592400690847, 'recall': 0.5525913738394641, 'f1-score': 0.4091541942220675, 'support': 8509}, '2': {'precision': 0.37221547185095183, 'recall': 0.22414634146341464, 'f1-score': 0.2797990561729335, 'support': 8200}, 'accuracy': 0.3453163354184813, 'macro avg': {'precision': 0.3567873058904587, 'recall': 0.3439907485524354, 'f1-score': 0.33071171057814935, 'support': 25258}, 'weighted avg': {'precision': 0.3566247287012565, 'recall': 0.3453163354184813, 'f1-score': 0.33129096535056457, 'support': 25258}}
[[2182 5009 1358]
 [2065 4702 1742]
 [1598 4764 1838]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
1443/1443 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1748258
{'0': {'precision': 0.38347730485314907, 'recall': 0.10137850855339645, 'f1-score': 0.16036254966996158, 'support': 120420}, '1': {'precision': 0.3392544142530864, 'recall': 0.7142229570523726, 'f1-score': 0.4600066361950424, 'support': 125199}, '2': {'precision': 0.4146040610513189, 'recall': 0.24753172342354007, 'f1-score': 0.30998976396306915, 'support': 123568}, 'accuracy': 0.35812474437073893, 'macro avg': {'precision': 0.37911192671918476, 'recall': 0.3543777296764364, 'f1-score': 0.31011964994269103, 'support': 369187}, 'weighted avg': {'precision': 0.3788986206894548, 'recall': 0.35812474437073893, 'f1-score': 0.3120587784229359, 'support': 369187}}
[[12208 88819 19393]
 [11985 89420 23794]
 [ 7642 85339 30587]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.174916
{'0': {'precision': 0.3853571813382179, 'recall': 0.17179844365452973, 'f1-score': 0.23764909133193793, 'support': 41636}, '1': {'precision': 0.32823098368885995, 'recall': 0.731863001953032, 'f1-score': 0.45320531256683116, 'support': 41986}, '2': {'precision': 0.38836533692340397, 'recall': 0.1284509022732599, 'f1-score': 0.19305073701636052, 'support': 42670}, 'accuracy': 0.3433471637158331, 'macro avg': {'precision': 0.36731783398349394, 'recall': 0.3440374492936072, 'f1-score': 0.2946350469717099, 'support': 126292}, 'weighted avg': {'precision': 0.3673818342403332, 'recall': 0.3433471637158331, 'f1-score': 0.29424279264415515, 'support': 126292}}
[[ 7153 30716  3767]
 [ 6393 30728  4865]
 [ 5016 32173  5481]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1925689
{'0': {'precision': 0.39676840215439857, 'recall': 0.15822130299896586, 'f1-score': 0.22622838944494994, 'support': 12571}, '1': {'precision': 0.3421833773087071, 'recall': 0.7845583787053841, 'f1-score': 0.4765294874150285, 'support': 13224}, '2': {'precision': 0.3978685612788632, 'recall': 0.09066623492269084, 'f1-score': 0.14767932489451477, 'support': 12353}, 'accuracy': 0.3534654503512635, 'macro avg': {'precision': 0.3789401135806563, 'recall': 0.3444819722090136, 'f1-score': 0.28347906725149774, 'support': 38148}, 'weighted avg': {'precision': 0.37820276036728223, 'recall': 0.3534654503512635, 'f1-score': 0.2875596551774862, 'support': 38148}}
[[ 1989  9949   633]
 [ 1787 10375  1062]
 [ 1237  9996  1120]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
5521/5521 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9465746
{'0': {'precision': 0.36755918340019306, 'recall': 0.23266442047565566, 'f1-score': 0.2849536200978855, 'support': 283146}, '1': {'precision': 0.6254652109871026, 'recall': 0.6925184590422503, 'f1-score': 0.6572861469333344, 'support': 839426}, '2': {'precision': 0.4274802896324451, 'recall': 0.44795313994042746, 'f1-score': 0.4374773261672825, 'support': 290738}, 'accuracy': 0.5500796003707609, 'macro avg': {'precision': 0.47350156133991356, 'recall': 0.45771200648611116, 'f1-score': 0.4599056977328342, 'support': 1413310}, 'weighted avg': {'precision': 0.5330673646887438, 'recall': 0.5500796003707609, 'f1-score': 0.5374743274632745, 'support': 1413310}}
[[ 65878 195636  21632]
 [105315 581318 152793]
 [  8038 152463 130237]]
Evaluating performance on  train set...
1289/1289 - 16s - 16s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9575787
{'0': {'precision': 0.3849321504573971, 'recall': 0.19930740390944734, 'f1-score': 0.2626314052703531, 'support': 69882}, '1': {'precision': 0.5976701388268506, 'recall': 0.703705651565672, 'f1-score': 0.6463680323077741, 'support': 190142}, '2': {'precision': 0.3944969930100042, 'recall': 0.39429891257567495, 'f1-score': 0.39439792792211054, 'support': 69706}, 'accuracy': 0.5313953841021442, 'macro avg': {'precision': 0.45903309409808396, 'recall': 0.4324373226835981, 'f1-score': 0.4344657885000793, 'support': 329730}, 'weighted avg': {'precision': 0.5096316121367004, 'recall': 0.5313953841021442, 'f1-score': 0.5117727238222372, 'support': 329730}}
[[ 13928  50347   5607]
 [ 19759 133804  36579]
 [  2496  39725  27485]]
Evaluating performance on  val set...
438/438 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.924669
{'0': {'precision': 0.4460120391271633, 'recall': 0.10707672853723524, 'f1-score': 0.17269383444408026, 'support': 22143}, '1': {'precision': 0.6307554878289084, 'recall': 0.7044247527948123, 'f1-score': 0.6655577502858925, 'support': 68162}, '2': {'precision': 0.367522208017832, 'recall': 0.5180906612448593, 'f1-score': 0.43000690342870296, 'support': 21641}, 'accuracy': 0.5502474407303521, 'macro avg': {'precision': 0.4814299116579679, 'recall': 0.4431973808589689, 'f1-score': 0.4227528293862252, 'support': 111946}, 'weighted avg': {'precision': 0.5433257842843937, 'recall': 0.5502474407303521, 'f1-score': 0.5225330636930559, 'support': 111946}}
[[ 2371 17835  1937]
 [ 2789 48015 17358]
 [  156 10273 11212]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
5918/5918 - 68s - 68s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9309699
{'0': {'precision': 0.44782686781609193, 'recall': 0.03554982107469241, 'f1-score': 0.06587063625196476, 'support': 280564}, '1': {'precision': 0.6465459613514878, 'recall': 0.8085544284958363, 'f1-score': 0.7185313177349838, 'support': 958147}, '2': {'precision': 0.34408372127768666, 'recall': 0.3667538916455843, 'f1-score': 0.35505730573688066, 'support': 276297}, 'accuracy': 0.5848292550270362, 'macro avg': {'precision': 0.47948551681508883, 'recall': 0.403619380405371, 'f1-score': 0.37981975324127637, 'support': 1515008}, 'weighted avg': {'precision': 0.5545841807507677, 'recall': 0.5848292550270362, 'f1-score': 0.5313772759526026, 'support': 1515008}}
[[  9974 249740  20850]
 [ 11115 774714 172318]
 [  1183 173781 101333]]
Evaluating performance on  train set...
1814/1814 - 20s - 20s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9693622
{'0': {'precision': 0.3458923196968008, 'recall': 0.1645944282956016, 'f1-score': 0.2230496632331059, 'support': 94262}, '1': {'precision': 0.5985920665322011, 'recall': 0.7701768988365457, 'f1-score': 0.6736297989423371, 'support': 275129}, '2': {'precision': 0.3253247745682409, 'recall': 0.22432762836185818, 'f1-score': 0.26554722489053006, 'support': 94888}, 'accuracy': 0.5356671311862048, 'macro avg': {'precision': 0.4232697202657476, 'recall': 0.3863663184980019, 'f1-score': 0.38740889568865766, 'support': 464279}, 'weighted avg': {'precision': 0.49143716541439314, 'recall': 0.5356671311862048, 'f1-score': 0.49874632577458367, 'support': 464279}}
[[ 15515  74340   4407]
 [ 23494 211898  39737]
 [  5846  67756  21286]]
Evaluating performance on  val set...
636/636 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9292363
{'0': {'precision': 0.36145733461169705, 'recall': 0.10615980288630764, 'f1-score': 0.16411819121728247, 'support': 28410}, '1': {'precision': 0.6671771229608614, 'recall': 0.7777401958020933, 'f1-score': 0.7182285927481281, 'support': 106434}, '2': {'precision': 0.3066059526166436, 'recall': 0.3333094196140326, 'f1-score': 0.319400522480407, 'support': 27878}, 'accuracy': 0.5843463084278708, 'macro avg': {'precision': 0.44508013672973396, 'recall': 0.4057364727674779, 'f1-score': 0.40058243548193917, 'support': 162722}, 'weighted avg': {'precision': 0.5520267298126954, 'recall': 0.5843463084278708, 'f1-score': 0.5531568418452701, 'support': 162722}}
[[ 3016 23336  2058]
 [ 4700 82778 18956]
 [  628 17958  9292]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
3755/3755 - 43s - 43s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1300819
{'0': {'precision': 0.35311572700296734, 'recall': 0.0015308567330359526, 'f1-score': 0.003048497366187937, 'support': 310937}, '1': {'precision': 0.3710478286827618, 'recall': 0.9819783853083074, 'f1-score': 0.5385866791261694, 'support': 355684}, '2': {'precision': 0.40649835108395954, 'recall': 0.0255277685355569, 'f1-score': 0.04803874277645916, 'support': 294542}, 'accuracy': 0.37170490333065254, 'macro avg': {'precision': 0.37688730225656286, 'recall': 0.33634567019230005, 'f1-score': 0.19655797308960551, 'support': 961163}, 'weighted avg': {'precision': 0.37611035592224495, 'recall': 0.37170490333065254, 'f1-score': 0.21501450053604504, 'support': 961163}}
[[   476 305520   4941]
 [   373 349274   6037]
 [   499 286524   7519]]
Evaluating performance on  train set...
1532/1532 - 17s - 17s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1478854
{'0': {'precision': 0.4432259650848291, 'recall': 0.1367906630848852, 'f1-score': 0.2090601224717016, 'support': 131778}, '1': {'precision': 0.3332457082404988, 'recall': 0.8037158453045509, 'f1-score': 0.47114144758460186, 'support': 129338}, '2': {'precision': 0.46116333131190623, 'recall': 0.1392515164231488, 'f1-score': 0.21391107647048482, 'support': 131065}, 'accuracy': 0.3575593922194089, 'macro avg': {'precision': 0.41254500154574475, 'recall': 0.359919341604195, 'f1-score': 0.29803754884226275, 'support': 392181}, 'weighted avg': {'precision': 0.4129499814059152, 'recall': 0.3575593922194089, 'f1-score': 0.29711350780475654, 'support': 392181}}
[[ 18026 105532   8220]
 [ 12282 103951  13105]
 [ 10362 102452  18251]]
Evaluating performance on  val set...
467/467 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1623713
{'0': {'precision': 0.43606681136170616, 'recall': 0.11604138415950982, 'f1-score': 0.18330391320732267, 'support': 39822}, '1': {'precision': 0.33220231908866743, 'recall': 0.8261244140377549, 'f1-score': 0.47385670787096584, 'support': 39465}, '2': {'precision': 0.45020668921458096, 'recall': 0.11951316839584997, 'f1-score': 0.18888450926290892, 'support': 40096}, 'accuracy': 0.3519429064439661, 'macro avg': {'precision': 0.40615860655498487, 'recall': 0.3538929888643716, 'f1-score': 0.2820150434470658, 'support': 119383}, 'weighted avg': {'precision': 0.4064808598848074, 'recall': 0.3519429064439661, 'f1-score': 0.28122761776195326, 'support': 119383}}
[[ 4621 32836  2365]
 [ 3375 32603  3487]
 [ 2601 32703  4792]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
4960/4960 - 56s - 56s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1098659
{'0': {'precision': 0.4407097159172451, 'recall': 0.14891743512650554, 'f1-score': 0.22261308833404556, 'support': 391801}, '1': {'precision': 0.3825228893665163, 'recall': 0.7637787661960936, 'f1-score': 0.5097486496060721, 'support': 486074}, '2': {'precision': 0.4468938717009193, 'recall': 0.19019665394775462, 'f1-score': 0.26683089967702434, 'support': 391805}, 'accuracy': 0.39704413710541236, 'macro avg': {'precision': 0.4233754923282269, 'recall': 0.3676309517567846, 'f1-score': 0.33306421253904733, 'support': 1269680}, 'weighted avg': {'precision': 0.42034228446050287, 'recall': 0.39704413710541236, 'f1-score': 0.34618272035390474, 'support': 1269680}}
[[ 58346 305355  28100]
 [ 50690 371253  64131]
 [ 23355 293930  74520]]
Evaluating performance on  train set...
1691/1691 - 19s - 19s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1393075
{'0': {'precision': 0.4749585711655312, 'recall': 0.10570854847963282, 'f1-score': 0.17292930647269802, 'support': 146412}, '1': {'precision': 0.3332409045562364, 'recall': 0.7704502219403931, 'f1-score': 0.4652488775368509, 'support': 143507}, '2': {'precision': 0.4692351506477195, 'recall': 0.22479622179464753, 'f1-score': 0.303969800753089, 'support': 142925}, 'accuracy': 0.36542264649619727, 'macro avg': {'precision': 0.42581154212316236, 'recall': 0.36698499740489116, 'f1-score': 0.31404932825421267, 'support': 432844}, 'weighted avg': {'precision': 0.4260830015385794, 'recall': 0.36542264649619727, 'f1-score': 0.3131157647110663, 'support': 432844}}
[[ 15477 116267  14668]
 [ 11268 110565  21674]
 [  5841 104955  32129]]
Evaluating performance on  val set...
591/591 - 7s - 7s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1781445
{'0': {'precision': 0.42081076645330706, 'recall': 0.04874895429310214, 'f1-score': 0.08737582851982484, 'support': 52596}, '1': {'precision': 0.28784749925689523, 'recall': 0.8193396121390243, 'f1-score': 0.4260252959393361, 'support': 44913}, '2': {'precision': 0.46845746845746844, 'recall': 0.15024708624708624, 'f1-score': 0.22752174404156786, 'support': 53625}, 'accuracy': 0.3137612979210502, 'macro avg': {'precision': 0.3923719113892236, 'recall': 0.33944521755973756, 'f1-score': 0.24697428950024294, 'support': 151134}, 'weighted avg': {'precision': 0.39820351180101643, 'recall': 0.3137612979210502, 'f1-score': 0.23773966624043025, 'support': 151134}}
[[ 2564 46388  3644]
 [ 2616 36799  5498]
 [  913 44655  8057]]
testing model on single stock: results/universal/W8/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
10609/10609 - 127s - 127s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1930937
{'0': {'precision': 0.34937755003095466, 'recall': 0.05225526540966945, 'f1-score': 0.09091297276104483, 'support': 896369}, '1': {'precision': 0.32733657612884, 'recall': 0.921788581275539, 'f1-score': 0.483114308155296, 'support': 897158}, '2': {'precision': 0.38781389281443635, 'recall': 0.023211932918001853, 'f1-score': 0.04380216278934137, 'support': 922155}, 'accuracy': 0.3296538401771636, 'macro avg': {'precision': 0.3548426729914103, 'recall': 0.3324185932010701, 'f1-score': 0.20594314790189405, 'support': 2715682}, 'weighted avg': {'precision': 0.35514775052402714, 'recall': 0.3296538401771636, 'f1-score': 0.20448411131488853, 'support': 2715682}}
[[ 46840 834423  15106]
 [ 51485 826990  18683]
 [ 35742 865008  21405]]
Evaluating performance on  train set...
3903/3903 - 45s - 45s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1879274
{'0': {'precision': 0.3662488886339519, 'recall': 0.11326679044904621, 'f1-score': 0.17302389861549267, 'support': 338228}, '1': {'precision': 0.3191365092849953, 'recall': 0.8586477513765656, 'f1-score': 0.4653243471360493, 'support': 321997}, '2': {'precision': 0.37716053773383595, 'recall': 0.031298142475165124, 'f1-score': 0.057799845213050066, 'support': 338838}, 'accuracy': 0.32570218294541986, 'macro avg': {'precision': 0.35418197855092776, 'recall': 0.334404228100259, 'f1-score': 0.23204936365486398, 'support': 999063}, 'weighted avg': {'precision': 0.354765365116897, 'recall': 0.32570218294541986, 'f1-score': 0.22815313442494292, 'support': 999063}}
[[ 38310 292305   7613]
 [ 35615 276482   9900]
 [ 30676 297557  10605]]
Evaluating performance on  val set...
1144/1144 - 12s - 12s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1582328
{'0': {'precision': 0.37689679828394373, 'recall': 0.14541441883276116, 'f1-score': 0.20986043219570458, 'support': 97872}, '1': {'precision': 0.33793186955117854, 'recall': 0.8496823560453836, 'f1-score': 0.4835488509896101, 'support': 98538}, '2': {'precision': 0.375281214848144, 'recall': 0.0277376510813423, 'f1-score': 0.051657231334978466, 'support': 96223}, 'accuracy': 0.3438675747437917, 'macro avg': {'precision': 0.3633699608944221, 'recall': 0.34094480865316235, 'f1-score': 0.24835550484009772, 'support': 292633}, 'weighted avg': {'precision': 0.3632449461947666, 'recall': 0.3438675747437917, 'f1-score': 0.24999918214766564, 'support': 292633}}
[[14232 82020  1620]
 [11989 83726  2823]
 [11540 82014  2669]]
training model: results/universal/W8/deepLOB_L1/h100
Epoch 1/50
7696/7696 - 176s - loss: 3.2090 - accuracy100: 0.4056 - val_loss: 3.3008 - val_accuracy100: 0.3678 - 176s/epoch - 23ms/step
Epoch 2/50
7696/7696 - 175s - loss: 3.1886 - accuracy100: 0.4177 - val_loss: 3.3455 - val_accuracy100: 0.3692 - 175s/epoch - 23ms/step
Epoch 3/50
7696/7696 - 173s - loss: 3.1669 - accuracy100: 0.4280 - val_loss: 3.3302 - val_accuracy100: 0.3723 - 173s/epoch - 23ms/step
Epoch 4/50
7696/7696 - 176s - loss: 3.1565 - accuracy100: 0.4318 - val_loss: 3.3484 - val_accuracy100: 0.3711 - 176s/epoch - 23ms/step
Epoch 5/50
7696/7696 - 176s - loss: 3.1487 - accuracy100: 0.4349 - val_loss: 3.3932 - val_accuracy100: 0.3637 - 176s/epoch - 23ms/step
Epoch 6/50
7696/7696 - 172s - loss: 3.1438 - accuracy100: 0.4369 - val_loss: 3.4508 - val_accuracy100: 0.3609 - 172s/epoch - 22ms/step
Epoch 7/50
7696/7696 - 176s - loss: 3.1380 - accuracy100: 0.4388 - val_loss: 3.4728 - val_accuracy100: 0.3594 - 176s/epoch - 23ms/step
Epoch 8/50
7696/7696 - 174s - loss: 3.1333 - accuracy100: 0.4406 - val_loss: 3.4403 - val_accuracy100: 0.3451 - 174s/epoch - 23ms/step
Epoch 9/50
7696/7696 - 177s - loss: 3.1285 - accuracy100: 0.4422 - val_loss: 3.4380 - val_accuracy100: 0.3510 - 177s/epoch - 23ms/step
Epoch 10/50
7696/7696 - 176s - loss: 3.1253 - accuracy100: 0.4432 - val_loss: 3.4346 - val_accuracy100: 0.3519 - 176s/epoch - 23ms/step
Epoch 11/50
7696/7696 - 177s - loss: 3.1214 - accuracy100: 0.4448 - val_loss: 3.4498 - val_accuracy100: 0.3473 - 177s/epoch - 23ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 322s - 322s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099675
{'0': {'precision': 0.3661868982878226, 'recall': 0.3570657359259567, 'f1-score': 0.36156880220898546, 'support': 1974628}, '1': {'precision': 0.3626500914504541, 'recall': 0.35536551775938124, 'f1-score': 0.3589708520559898, 'support': 2023691}, '2': {'precision': 0.37352934298148, 'recall': 0.39062664796405266, 'f1-score': 0.3818867270399262, 'support': 1962649}, 'accuracy': 0.36753846019639763, 'macro avg': {'precision': 0.3674554442399189, 'recall': 0.36768596721646346, 'f1-score': 0.3674754604349671, 'support': 5960968}, 'weighted avg': {'precision': 0.3674036868312338, 'recall': 0.36753846019639763, 'f1-score': 0.3673765009767787, 'support': 5960968}}
[[705072 614548 655008]
 [673728 719150 630813]
 [546643 649343 766663]]
Evaluating performance on  train set...
7696/7696 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104926
{'0': {'precision': 0.3484036909909508, 'recall': 0.6103634032171658, 'f1-score': 0.4435964976505517, 'support': 640253}, '1': {'precision': 0.3748800023155332, 'recall': 0.3381517855977303, 'f1-score': 0.35556996004026475, 'support': 689433}, '2': {'precision': 0.373784538578314, 'recall': 0.1320018630996852, 'f1-score': 0.19510313178251595, 'support': 639794}, 'accuracy': 0.35967565042549304, 'macro avg': {'precision': 0.365689410628266, 'recall': 0.36017235063819375, 'f1-score': 0.3314231964911108, 'support': 1969480}, 'weighted avg': {'precision': 0.3659170228078518, 'recall': 0.35967565042549304, 'f1-score': 0.3320579370018286, 'support': 1969480}}
[[390787 184565  64901]
 [379712 233133  76588]
 [351151 204189  84454]]
Evaluating performance on  val set...
2338/2338 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985283
{'0': {'precision': 0.35566061181148617, 'recall': 0.6508625590457585, 'f1-score': 0.4599718767691156, 'support': 193494}, '1': {'precision': 0.38903746332656286, 'recall': 0.3226626111371081, 'f1-score': 0.35275489844989, 'support': 213700}, '2': {'precision': 0.376918909156583, 'recall': 0.1314052448763288, 'f1-score': 0.194872193907326, 'support': 190586}, 'accuracy': 0.3679196359864833, 'macro avg': {'precision': 0.37387232809821064, 'recall': 0.36831013835306514, 'f1-score': 0.33586632304211056, 'support': 597780}, 'weighted avg': {'precision': 0.37437011535222775, 'recall': 0.3679196359864833, 'f1-score': 0.3371230754965478, 'support': 597780}}
[[125938  51297  16259]
 [119606  68953  25141]
 [108552  56990  25044]]
testing model out of sample: results/universal/W8/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 184s - 184s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783281
{'0': {'precision': 0.35863535186547124, 'recall': 0.48772676025033745, 'f1-score': 0.41333622044898943, 'support': 1052819}, '1': {'precision': 0.45729959128156233, 'recall': 0.36346353209261967, 'f1-score': 0.40501752561300897, 'support': 1509615}, '2': {'precision': 0.32845299406579725, 'recall': 0.30688594343668985, 'f1-score': 0.3173034140004778, 'support': 1053828}, 'accuracy': 0.38315337771433594, 'macro avg': {'precision': 0.38146264573761024, 'recall': 0.38602541192654893, 'f1-score': 0.3785523866874921, 'support': 3616262}, 'weighted avg': {'precision': 0.3910273638465742, 'recall': 0.38315337771433594, 'f1-score': 0.38187829874452206, 'support': 3616262}}
[[513488 297337 241994]
 [541693 548690 419232]
 [376602 353821 323405]]
Evaluating performance on  train set...
4550/4550 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0869077
{'0': {'precision': 0.3528294538809502, 'recall': 0.4920058483603704, 'f1-score': 0.41095383756498677, 'support': 359075}, '1': {'precision': 0.41960331777669035, 'recall': 0.3841165130765202, 'f1-score': 0.40107648738396817, 'support': 448705}, '2': {'precision': 0.3545169958722332, 'recall': 0.25136444884684783, 'f1-score': 0.2941597569986044, 'support': 356371}, 'accuracy': 0.3767561080993789, 'macro avg': {'precision': 0.3756499225099579, 'recall': 0.3758289367612462, 'f1-score': 0.3687300273158531, 'support': 1164151}, 'weighted avg': {'precision': 0.37908305640013673, 'recall': 0.3767561080993789, 'f1-score': 0.37139364331312746, 'support': 1164151}}
[[176667 110770  71638]
 [184888 172355  91462]
 [139160 127632  89579]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0866786
{'0': {'precision': 0.34881809488433846, 'recall': 0.36579948449763383, 'f1-score': 0.3571070261173501, 'support': 120659}, '1': {'precision': 0.41733899404778696, 'recall': 0.371528126569563, 'f1-score': 0.39310340246316544, 'support': 159280}, '2': {'precision': 0.3500874125874126, 'recall': 0.38365236923381835, 'f1-score': 0.36610217574606574, 'support': 121094}, 'accuracy': 0.37346552528096194, 'macro avg': {'precision': 0.3720815005065126, 'recall': 0.37365999343367173, 'f1-score': 0.3721042014421938, 'support': 401033}, 'weighted avg': {'precision': 0.3764161119469995, 'recall': 0.37346552528096194, 'f1-score': 0.3741199938120315, 'support': 401033}}
[[44137 39034 37488]
 [51345 59177 48758]
 [31051 43585 46458]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1147693
{'0': {'precision': 0.34139300923147275, 'recall': 0.21159944022249386, 'f1-score': 0.2612642169728784, 'support': 56451}, '1': {'precision': 0.34024091248267774, 'recall': 0.29910973666947804, 'f1-score': 0.3183522840614403, 'support': 53355}, '2': {'precision': 0.3519691677706853, 'recall': 0.5302079175586922, 'f1-score': 0.42308249124127745, 'support': 55118}, 'accuracy': 0.3463898522956028, 'macro avg': {'precision': 0.34453436316161196, 'recall': 0.34697236481688803, 'f1-score': 0.3342329974251987, 'support': 164924}, 'weighted avg': {'precision': 0.34455486914471983, 'recall': 0.3463898522956028, 'f1-score': 0.33381298768324097, 'support': 164924}}
[[11945 15823 28683]
 [12273 15959 25123]
 [10771 15123 29224]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103028
{'0': {'precision': 0.36513982642237225, 'recall': 0.3966375111297334, 'f1-score': 0.3802374915271257, 'support': 19093}, '1': {'precision': 0.3464957618358487, 'recall': 0.3542217055901934, 'f1-score': 0.35031614150598317, 'support': 18926}, '2': {'precision': 0.3529239423414977, 'recall': 0.3147635223412595, 'f1-score': 0.33275323886080493, 'support': 19135}, 'accuracy': 0.35518073975574765, 'macro avg': {'precision': 0.35485317686657286, 'recall': 0.3552075796870621, 'f1-score': 0.35443562396463796, 'support': 57154}, 'weighted avg': {'precision': 0.3548761789392201, 'recall': 0.35518073975574765, 'f1-score': 0.3544317273589102, 'support': 57154}}
[[7573 6090 5430]
 [6609 6704 5613]
 [6558 6554 6023]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1218497
{'0': {'precision': 0.34328774769746023, 'recall': 0.40627580511973577, 'f1-score': 0.37213523939187654, 'support': 6055}, '1': {'precision': 0.29936642027455124, 'recall': 0.3171732239418236, 'f1-score': 0.30801267541874155, 'support': 5363}, '2': {'precision': 0.34791524265208473, 'recall': 0.2624162227186802, 'f1-score': 0.2991771159874608, 'support': 5819}, 'accuracy': 0.329987816905494, 'macro avg': {'precision': 0.3301898035413654, 'recall': 0.3286217505934132, 'f1-score': 0.32644167693269294, 'support': 17237}, 'weighted avg': {'precision': 0.3311845577091734, 'recall': 0.329987816905494, 'f1-score': 0.32755482338687464, 'support': 17237}}
[[2460 2000 1595]
 [2395 1701 1267]
 [2311 1981 1527]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0678451
{'0': {'precision': 0.4058594248573925, 'recall': 0.2598338089431405, 'f1-score': 0.3168306207773992, 'support': 159094}, '1': {'precision': 0.49340216293005995, 'recall': 0.3990985304589888, 'f1-score': 0.44126817964237947, 'support': 247152}, '2': {'precision': 0.32617093663212415, 'recall': 0.5510578484036586, 'f1-score': 0.40978831889328104, 'support': 151534}, 'accuracy': 0.40065975832765605, 'macro avg': {'precision': 0.4084775081398589, 'recall': 0.40333006260192933, 'f1-score': 0.3892957064376866, 'support': 557780}, 'weighted avg': {'precision': 0.4230003180866372, 'recall': 0.40065975832765605, 'f1-score': 0.39722296789434425, 'support': 557780}}
[[ 41338  48412  69344]
 [ 45349  98638 103165]
 [ 15166  52864  83504]]
Evaluating performance on  train set...
614/614 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0751319
{'0': {'precision': 0.37496278654361415, 'recall': 0.5183660870459924, 'f1-score': 0.43515439429928743, 'support': 48595}, '1': {'precision': 0.441295862607338, 'recall': 0.3699546800608629, 'f1-score': 0.40248840789953816, 'support': 61121}, '2': {'precision': 0.3499625003232731, 'recall': 0.2856600029553947, 'f1-score': 0.31455868337246334, 'support': 47371}, 'accuracy': 0.3904460585535404, 'macro avg': {'precision': 0.3887403831580751, 'recall': 0.3913269233540833, 'f1-score': 0.38406716185709633, 'support': 157087}, 'weighted avg': {'precision': 0.3932332696742812, 'recall': 0.3904460585535404, 'f1-score': 0.3860776586238104, 'support': 157087}}
[[25190 12903 10502]
 [23876 22612 14633]
 [18114 15725 13532]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0562764
{'0': {'precision': 0.35617238085128966, 'recall': 0.487116208173042, 'f1-score': 0.4114779729605445, 'support': 13777}, '1': {'precision': 0.48474381116868165, 'recall': 0.4741435945565462, 'f1-score': 0.47938511173316883, 'support': 21310}, '2': {'precision': 0.3733378408834798, 'recall': 0.2458992058190455, 'f1-score': 0.2965051237302546, 'support': 13473}, 'accuracy': 0.414497528830313, 'macro avg': {'precision': 0.40475134430115034, 'recall': 0.4023863361828779, 'f1-score': 0.39578940280798935, 'support': 48560}, 'weighted avg': {'precision': 0.41735704771861504, 'recall': 0.414497528830313, 'f1-score': 0.4093789599779442, 'support': 48560}}
[[ 6711  4897  2169]
 [ 7814 10104  3392]
 [ 4317  5843  3313]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0693017
{'0': {'precision': 0.2546634225466342, 'recall': 0.6748127225838143, 'f1-score': 0.36977843575982905, 'support': 65144}, '1': {'precision': 0.613390226556944, 'recall': 0.36863635808574813, 'f1-score': 0.46051286745076503, 'support': 163782}, '2': {'precision': 0.24983909438534055, 'recall': 0.09628375913740024, 'f1-score': 0.13899947340705635, 'support': 68537}, 'accuracy': 0.3729371384004061, 'macro avg': {'precision': 0.37263091449630625, 'recall': 0.3799109466023209, 'f1-score': 0.3230969255392168, 'support': 297463}, 'weighted avg': {'precision': 0.4510654908214313, 'recall': 0.3729371384004061, 'f1-score': 0.366563813936049, 'support': 297463}}
[[43960 17188  3996]
 [87588 60376 15818]
 [41072 20866  6599]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1073401
{'0': {'precision': 0.36707228624385524, 'recall': 0.4849528000567819, 'f1-score': 0.4178579619295161, 'support': 28178}, '1': {'precision': 0.35901158203679745, 'recall': 0.41244289754187513, 'f1-score': 0.3838769002345239, 'support': 27582}, '2': {'precision': 0.3602399781838015, 'recall': 0.18992164474157142, 'f1-score': 0.24871734525770764, 'support': 27822}, 'accuracy': 0.3628173530185925, 'macro avg': {'precision': 0.3621079488214847, 'recall': 0.3624391141134095, 'f1-score': 0.35015073580724926, 'support': 83582}, 'weighted avg': {'precision': 0.36213798438118283, 'recall': 0.3628173530185925, 'f1-score': 0.3503422781613084, 'support': 83582}}
[[13665  9919  4594]
 [11416 11376  4790]
 [12146 10392  5284]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0924801
{'0': {'precision': 0.32456805092452257, 'recall': 0.44984770507299654, 'f1-score': 0.37707443764581594, 'support': 9521}, '1': {'precision': 0.4375315042845827, 'recall': 0.47936883629191324, 'f1-score': 0.45749567050673895, 'support': 12675}, '2': {'precision': 0.36886812486727544, 'recall': 0.18101292205085454, 'f1-score': 0.24285214959804263, 'support': 9596}, 'accuracy': 0.3804730749874182, 'macro avg': {'precision': 0.37698922669212687, 'recall': 0.37007648780525476, 'f1-score': 0.35914075258353256, 'support': 31792}, 'weighted avg': {'precision': 0.38297630711769753, 'recall': 0.3804730749874182, 'f1-score': 0.3686239485418202, 'support': 31792}}
[[4283 3841 1397]
 [5024 6076 1575]
 [3889 3970 1737]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1186762
{'0': {'precision': 0.32969298915533835, 'recall': 0.4161565527546151, 'f1-score': 0.3679130712687759, 'support': 103735}, '1': {'precision': 0.35287150315592614, 'recall': 0.40033948052407303, 'f1-score': 0.3751097562995974, 'support': 113114}, '2': {'precision': 0.3193274184848316, 'recall': 0.1784912251517924, 'f1-score': 0.22898757561004887, 'support': 96184}, 'accuracy': 0.337414905137797, 'macro avg': {'precision': 0.33396397026536534, 'recall': 0.33166241947682684, 'f1-score': 0.32400346772614075, 'support': 313033}, 'weighted avg': {'precision': 0.33488353578553537, 'recall': 0.337414905137797, 'f1-score': 0.3278266776813182, 'support': 313033}}
[[43170 42850 17715]
 [48950 45284 18880]
 [38820 40196 17168]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1182871
{'0': {'precision': 0.34676395256236414, 'recall': 0.5213241004400725, 'f1-score': 0.4164932463000065, 'support': 30904}, '1': {'precision': 0.3340984442744198, 'recall': 0.3477106834771068, 'f1-score': 0.34076868049684594, 'support': 30140}, '2': {'precision': 0.35636497424576896, 'recall': 0.159440329218107, 'f1-score': 0.220311611509155, 'support': 30375}, 'accuracy': 0.34384537131230924, 'macro avg': {'precision': 0.3457424570275176, 'recall': 0.3428250377117621, 'f1-score': 0.32585784610200247, 'support': 91419}, 'weighted avg': {'precision': 0.3457782998406627, 'recall': 0.34384537131230924, 'f1-score': 0.3263439822511833, 'support': 91419}}
[[16111 10454  4339]
 [15252 10480  4408]
 [15098 10434  4843]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1378618
{'0': {'precision': 0.34411764705882353, 'recall': 0.6334000235377192, 'f1-score': 0.4459543439532668, 'support': 8497}, '1': {'precision': 0.33375699034062023, 'recall': 0.3029184450340293, 'f1-score': 0.31759085686642075, 'support': 8669}, '2': {'precision': 0.3251428571428571, 'recall': 0.07031636183885319, 'f1-score': 0.11562690510058932, 'support': 8092}, 'accuracy': 0.3395755800142529, 'macro avg': {'precision': 0.33433916484743365, 'recall': 0.33554494347020053, 'f1-score': 0.2930573686400923, 'support': 25258}, 'weighted avg': {'precision': 0.33448265881390693, 'recall': 0.3395755800142529, 'f1-score': 0.2960694478905645, 'support': 25258}}
[[5382 2597  518]
 [5380 2626  663]
 [4878 2645  569]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048095
{'0': {'precision': 0.3441665777967367, 'recall': 0.43813160239277077, 'f1-score': 0.38550582895026636, 'support': 117855}, '1': {'precision': 0.3708577521127164, 'recall': 0.39722090224872386, 'f1-score': 0.3835868893469468, 'support': 130474}, '2': {'precision': 0.37256630481323827, 'recall': 0.24478313392576412, 'f1-score': 0.2954500059920904, 'support': 120858}, 'accuracy': 0.36037834484962905, 'macro avg': {'precision': 0.36253021157423043, 'recall': 0.36004521285575297, 'f1-score': 0.3548475747631012, 'support': 369187}, 'weighted avg': {'precision': 0.3628964856360254, 'recall': 0.36037834484962905, 'f1-score': 0.35534675407254107, 'support': 369187}}
[[51636 41757 24462]
 [53287 51827 25360]
 [45109 46165 29584]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1208938
{'0': {'precision': 0.3390044289010879, 'recall': 0.56844837531244, 'f1-score': 0.4247196458873915, 'support': 41608}, '1': {'precision': 0.35463188688444663, 'recall': 0.3499566974595843, 'f1-score': 0.3522787814210297, 'support': 41568}, '2': {'precision': 0.3709604592659485, 'recall': 0.13338435847481214, 'f1-score': 0.19621624387997066, 'support': 43116}, 'accuracy': 0.3480030405726412, 'macro avg': {'precision': 0.3548655916838277, 'recall': 0.35059647708227887, 'f1-score': 0.3244048903961306, 'support': 126292}, 'weighted avg': {'precision': 0.35505784779273253, 'recall': 0.3480030405726412, 'f1-score': 0.32286541493776927, 'support': 126292}}
[[23652 12753  5203]
 [22472 14547  4549]
 [23645 13720  5751]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.110197
{'0': {'precision': 0.3375804967801288, 'recall': 0.5889575475483508, 'f1-score': 0.42916873775620595, 'support': 12461}, '1': {'precision': 0.3579114609662743, 'recall': 0.37711155075331, 'f1-score': 0.36726073585534846, 'support': 13142}, '2': {'precision': 0.34673955486138225, 'recall': 0.07078517337584696, 'f1-score': 0.11756917781014169, 'support': 12545}, 'accuracy': 0.34557512844710075, 'macro avg': {'precision': 0.34741050420259517, 'recall': 0.34561809055916926, 'f1-score': 0.30466621714056535, 'support': 38148}, 'weighted avg': {'precision': 0.34759648490437245, 'recall': 0.34557512844710075, 'f1-score': 0.30537164641447256, 'support': 38148}}
[[7339 4309  813]
 [7326 4956  860]
 [7075 4582  888]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
5521/5521 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.057683
{'0': {'precision': 0.3654966806946325, 'recall': 0.5249053728555277, 'f1-score': 0.43093155657612375, 'support': 406860}, '1': {'precision': 0.45412468337741413, 'recall': 0.3809914058938675, 'f1-score': 0.41435580943493205, 'support': 596688}, '2': {'precision': 0.42288942007582103, 'recall': 0.33892601070865525, 'f1-score': 0.3762807061274753, 'support': 409762}, 'accuracy': 0.41022493295879886, 'macro avg': {'precision': 0.4141702613826226, 'recall': 0.4149409298193502, 'f1-score': 0.4071893573795104, 'support': 1413310}, 'weighted avg': {'precision': 0.4195546222213309, 'recall': 0.41022493295879886, 'f1-score': 0.40808844983257664, 'support': 1413310}}
[[213563 118968  74329]
 [254158 227333 115197]
 [116588 154295 138879]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0621486
{'0': {'precision': 0.3707986486015813, 'recall': 0.5516691021774502, 'f1-score': 0.44350202462881805, 'support': 96489}, '1': {'precision': 0.4527360571368554, 'recall': 0.3751740745038877, 'f1-score': 0.41032190509431865, 'support': 137872}, '2': {'precision': 0.3892079028961528, 'recall': 0.29352305256425043, 'f1-score': 0.334660354350477, 'support': 95369}, 'accuracy': 0.4032056531101204, 'macro avg': {'precision': 0.4042475362115298, 'recall': 0.4067887430818628, 'f1-score': 0.39616142802453785, 'support': 329730}, 'weighted avg': {'precision': 0.41038420818789223, 'recall': 0.4032056531101204, 'f1-score': 0.39814755068578705, 'support': 329730}}
[[53230 26844 16415]
 [58631 51726 27515]
 [31694 35682 27993]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0503503
{'0': {'precision': 0.40578638796839156, 'recall': 0.5009598137017339, 'f1-score': 0.44837832889715096, 'support': 31777}, '1': {'precision': 0.4668214819560111, 'recall': 0.3553013834995835, 'f1-score': 0.4034976409380876, 'support': 49223}, '2': {'precision': 0.38922614319754906, 'recall': 0.44338525172881793, 'f1-score': 0.4145442460497296, 'support': 30946}, 'accuracy': 0.42099762385435835, 'macro avg': {'precision': 0.42061133770731723, 'recall': 0.4332154829767118, 'f1-score': 0.4221400719616561, 'support': 111946}, 'weighted avg': {'precision': 0.42804584428370523, 'recall': 0.42099762385435835, 'f1-score': 0.4192911651645899, 'support': 111946}}
[[15919  8517  7341]
 [17544 17489 14190]
 [ 5767 11458 13721]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
5918/5918 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0549965
{'0': {'precision': 0.3834296014631001, 'recall': 0.37840301457164155, 'f1-score': 0.3808997252567712, 'support': 385063}, '1': {'precision': 0.5375751808610573, 'recall': 0.3526890527618885, 'f1-score': 0.42593395121495414, 'support': 749632}, '2': {'precision': 0.30593194118589073, 'recall': 0.5173869943967206, 'f1-score': 0.38450520375342456, 'support': 380313}, 'accuracy': 0.40056884188070296, 'macro avg': {'precision': 0.4089789078366827, 'recall': 0.41615968724341695, 'f1-score': 0.39711296007505, 'support': 1515008}, 'weighted avg': {'precision': 0.4402471834839495, 'recall': 0.40056884188070296, 'f1-score': 0.40408792440620295, 'support': 1515008}}
[[145709 101860 137494]
 [176329 264387 308916]
 [ 57977 125567 196769]]
Evaluating performance on  train set...
1814/1814 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0591271
{'0': {'precision': 0.3350423335001481, 'recall': 0.5341268032172979, 'f1-score': 0.41178427299144554, 'support': 122836}, '1': {'precision': 0.5177058440147729, 'recall': 0.4058989798548963, 'f1-score': 0.4550350290941463, 'support': 217224}, '2': {'precision': 0.31670436714148886, 'recall': 0.25021937062768174, 'f1-score': 0.2795634126488008, 'support': 124219}, 'accuracy': 0.3981722197213314, 'macro avg': {'precision': 0.38981751488546995, 'recall': 0.3967483845666253, 'f1-score': 0.3821275715781309, 'support': 464279}, 'weighted avg': {'precision': 0.41559944369665186, 'recall': 0.3981722197213314, 'f1-score': 0.39664415076483195, 'support': 464279}}
[[65610 36523 20703]
 [82696 88171 46357]
 [47520 45617 31082]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0541261
{'0': {'precision': 0.34384758207443666, 'recall': 0.4158352683013957, 'f1-score': 0.3764306420132353, 'support': 39191}, '1': {'precision': 0.5423350761049945, 'recall': 0.35805756158476965, 'f1-score': 0.4313388776929409, 'support': 84883}, '2': {'precision': 0.285114278485283, 'recall': 0.4373576899192714, 'f1-score': 0.345195184462847, 'support': 38648}, 'accuracy': 0.39080763510772976, 'macro avg': {'precision': 0.3904323122215714, 'recall': 0.4037501732684789, 'f1-score': 0.38432156805634105, 'support': 162722}, 'weighted avg': {'precision': 0.43343773730041857, 'recall': 0.39080763510772976, 'f1-score': 0.39765449500049604, 'support': 162722}}
[[16297 11688 11206]
 [23314 30393 31176]
 [ 7785 13960 16903]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
3755/3755 - 51s - 51s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1025904
{'0': {'precision': 0.3937343041713392, 'recall': 0.15765906783921982, 'f1-score': 0.2251597009431896, 'support': 316233}, '1': {'precision': 0.3776898029023034, 'recall': 0.33554707820357205, 'f1-score': 0.35537340591432, 'support': 346020}, '2': {'precision': 0.33211983472642215, 'recall': 0.5856913452209696, 'f1-score': 0.42387740970127213, 'support': 298910}, 'accuracy': 0.35481182692217655, 'macro avg': {'precision': 0.3678479806000216, 'recall': 0.3596324970879205, 'f1-score': 0.3348035055195939, 'support': 961163}, 'weighted avg': {'precision': 0.36879691125162434, 'recall': 0.35481182692217655, 'f1-score': 0.33383560348936436, 'support': 961163}}
[[ 49857  98659 167717]
 [ 45574 116106 184340]
 [ 31195  92646 175069]]
Evaluating performance on  train set...
1532/1532 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1037346
{'0': {'precision': 0.3614464847237859, 'recall': 0.571196319018405, 'f1-score': 0.4427352053068309, 'support': 130400}, '1': {'precision': 0.36430259100556645, 'recall': 0.34785102477821966, 'f1-score': 0.35588678285703107, 'support': 130760}, '2': {'precision': 0.36591896039442323, 'recall': 0.17107181291548684, 'f1-score': 0.23314523468989728, 'support': 131021}, 'accuracy': 0.3630543040075883, 'macro avg': {'precision': 0.3638893453745919, 'recall': 0.36337305223737054, 'f1-score': 0.34392240761791976, 'support': 392181}, 'weighted avg': {'precision': 0.36389293850978827, 'recall': 0.3630543040075883, 'f1-score': 0.3437579798427287, 'support': 392181}}
[[74484 37883 18033]
 [64468 45485 20807]
 [67120 41487 22414]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100011
{'0': {'precision': 0.3489071127519848, 'recall': 0.5550992826697162, 'f1-score': 0.42848831377269536, 'support': 38476}, '1': {'precision': 0.38665138071976873, 'recall': 0.3718689326206285, 'f1-score': 0.3791161125569688, 'support': 41719}, '2': {'precision': 0.36381269049598225, 'recall': 0.16752577319587628, 'f1-score': 0.22941310083343522, 'support': 39188}, 'accuracy': 0.3638457736863708, 'macro avg': {'precision': 0.3664570613225786, 'recall': 0.36483132949540703, 'f1-score': 0.3456725090543665, 'support': 119383}, 'weighted avg': {'precision': 0.36698986235603015, 'recall': 0.3638457736863708, 'f1-score': 0.3458876226593658, 'support': 119383}}
[[21358 11737  5381]
 [20106 15514  6099]
 [19750 12873  6565]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
4960/4960 - 66s - 66s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957689
{'0': {'precision': 0.3749953257183292, 'recall': 0.6087516868780731, 'f1-score': 0.46410110359558565, 'support': 428306}, '1': {'precision': 0.3682312436764124, 'recall': 0.37685633360169946, 'f1-score': 0.3724938668724825, 'support': 412372}, '2': {'precision': 0.40343933576187196, 'recall': 0.14327672132064653, 'f1-score': 0.2114569877029089, 'support': 429002}, 'accuracy': 0.3761601348371243, 'macro avg': {'precision': 0.3822219683855379, 'recall': 0.37629491393347303, 'f1-score': 0.349350652723659, 'support': 1269680}, 'weighted avg': {'precision': 0.3824091773635553, 'recall': 0.3761601348371243, 'f1-score': 0.34898462509063194, 'support': 1269680}}
[[260732 120948  46626]
 [212704 155405  44263]
 [221858 145678  61466]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099746
{'0': {'precision': 0.37339256356552486, 'recall': 0.45004750271444083, 'f1-score': 0.40815208694902944, 'support': 147360}, '1': {'precision': 0.3468195586326266, 'recall': 0.35770021965761306, 'f1-score': 0.3521758682361341, 'support': 143405}, '2': {'precision': 0.38721489266547404, 'recall': 0.29250628171650983, 'f1-score': 0.3332624986467902, 'support': 142079}, 'accuracy': 0.36773987857057044, 'macro avg': {'precision': 0.3691423382878751, 'recall': 0.3667513346961879, 'f1-score': 0.36453015127731797, 'support': 432844}, 'weighted avg': {'precision': 0.36912580908536435, 'recall': 0.36773987857057044, 'f1-score': 0.3650245226050242, 'support': 432844}}
[[66319 45547 35494]
 [61834 51296 30275]
 [49459 51061 41559]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1097716
{'0': {'precision': 0.37731719180673406, 'recall': 0.26132769366098335, 'f1-score': 0.30878954410252446, 'support': 53431}, '1': {'precision': 0.3098281181137065, 'recall': 0.37413517828632253, 'f1-score': 0.33895853423336547, 'support': 43217}, '2': {'precision': 0.4095671687573659, 'recall': 0.4656058437029696, 'f1-score': 0.43579238492789474, 'support': 54486}, 'accuracy': 0.3672304048063308, 'macro avg': {'precision': 0.36557082622593545, 'recall': 0.36702290521675845, 'f1-score': 0.3611801544212616, 'support': 151134}, 'weighted avg': {'precision': 0.369645171919353, 'recall': 0.3672304048063308, 'f1-score': 0.36320278024856495, 'support': 151134}}
[[13963 16894 22574]
 [13050 16169 13998]
 [ 9993 19124 25369]]
testing model on single stock: results/universal/W8/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
10609/10609 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1249532
{'0': {'precision': 0.3633441431458184, 'recall': 0.36081504511958057, 'f1-score': 0.3620751777440587, 'support': 988706}, '1': {'precision': 0.27234369550696624, 'recall': 0.31963447511297777, 'f1-score': 0.294100149242108, 'support': 720717}, '2': {'precision': 0.3971450225395921, 'recall': 0.35046841817066976, 'f1-score': 0.37234961346220036, 'support': 1006259}, 'accuracy': 0.3460522992014529, 'macro avg': {'precision': 0.3442776203974589, 'recall': 0.343639312801076, 'f1-score': 0.34284164681612234, 'support': 2715682}, 'weighted avg': {'precision': 0.3517179179386582, 'recall': 0.3460522992014529, 'f1-score': 0.3478422833162358, 'support': 2715682}}
[[356740 306587 325379]
 [280399 230366 209952]
 [344685 308912 352662]]
Evaluating performance on  train set...
3903/3903 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1229023
{'0': {'precision': 0.3371762745265002, 'recall': 0.6641786350770521, 'f1-score': 0.4472845254916436, 'support': 333865}, '1': {'precision': 0.3431041262605056, 'recall': 0.31242944710809006, 'f1-score': 0.3270490996127811, 'support': 329540}, '2': {'precision': 0.3959447361416923, 'recall': 0.04875200352739991, 'f1-score': 0.08681466469666062, 'support': 335658}, 'accuracy': 0.341387880443976, 'macro avg': {'precision': 0.35874171230956603, 'recall': 0.341786695237514, 'f1-score': 0.28704942993369514, 'support': 999063}, 'weighted avg': {'precision': 0.3588761758833278, 'recall': 0.341387880443976, 'f1-score': 0.28651691145845176, 'support': 999063}}
[[221746  96449  15670]
 [217287 102958   9295]
 [218623 100671  16364]]
Evaluating performance on  val set...
1144/1144 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1202407
{'0': {'precision': 0.3499221400748003, 'recall': 0.7589311359156953, 'f1-score': 0.47899359274886705, 'support': 100967}, '1': {'precision': 0.32836261005097095, 'recall': 0.25205057178887463, 'f1-score': 0.2851898826800654, 'support': 92779}, '2': {'precision': 0.3399095766543362, 'recall': 0.008363081092560195, 'f1-score': 0.016324516383734704, 'support': 98887}, 'accuracy': 0.3445920316574002, 'macro avg': {'precision': 0.33939810892670247, 'recall': 0.33978159626571003, 'f1-score': 0.26016933060422237, 'support': 292633}, 'weighted avg': {'precision': 0.3397032515863513, 'recall': 0.3445920316574002, 'f1-score': 0.26120246402793607, 'support': 292633}}
[[76627 23513   827]
 [68615 23385   779]
 [73741 24319   827]]
training model: results/universal/W8/deepLOB_L1/h200
Epoch 1/50
7696/7696 - 172s - loss: 3.2265 - accuracy200: 0.4034 - val_loss: 3.4042 - val_accuracy200: 0.3375 - 172s/epoch - 22ms/step
Epoch 2/50
7696/7696 - 174s - loss: 3.2085 - accuracy200: 0.4153 - val_loss: 3.4109 - val_accuracy200: 0.3360 - 174s/epoch - 23ms/step
Epoch 3/50
7696/7696 - 173s - loss: 3.1996 - accuracy200: 0.4197 - val_loss: 3.4623 - val_accuracy200: 0.3321 - 173s/epoch - 23ms/step
Epoch 4/50
7696/7696 - 172s - loss: 3.1912 - accuracy200: 0.4245 - val_loss: 3.4050 - val_accuracy200: 0.3343 - 172s/epoch - 22ms/step
Epoch 5/50
7696/7696 - 176s - loss: 3.1857 - accuracy200: 0.4263 - val_loss: 3.5887 - val_accuracy200: 0.3300 - 176s/epoch - 23ms/step
Epoch 6/50
7696/7696 - 174s - loss: 3.1810 - accuracy200: 0.4292 - val_loss: 3.5371 - val_accuracy200: 0.3302 - 174s/epoch - 23ms/step
Epoch 7/50
7696/7696 - 174s - loss: 3.1775 - accuracy200: 0.4304 - val_loss: 3.6495 - val_accuracy200: 0.3339 - 174s/epoch - 23ms/step
Epoch 8/50
7696/7696 - 165s - loss: 3.1741 - accuracy200: 0.4324 - val_loss: 3.5736 - val_accuracy200: 0.3346 - 165s/epoch - 21ms/step
Epoch 9/50
7696/7696 - 167s - loss: 3.1711 - accuracy200: 0.4334 - val_loss: 3.5954 - val_accuracy200: 0.3315 - 167s/epoch - 22ms/step
Epoch 10/50
7696/7696 - 169s - loss: 3.1688 - accuracy200: 0.4346 - val_loss: 3.5824 - val_accuracy200: 0.3337 - 169s/epoch - 22ms/step
Epoch 11/50
7696/7696 - 170s - loss: 3.1671 - accuracy200: 0.4355 - val_loss: 3.5292 - val_accuracy200: 0.3363 - 170s/epoch - 22ms/step
testing model in sample: results/universal/W8/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 284s - 284s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1692086
{'0': {'precision': 0.3366731523406009, 'recall': 0.10700129937304528, 'f1-score': 0.16239143193989553, 'support': 2076386}, '1': {'precision': 0.3075795670252583, 'recall': 0.8667021341722735, 'f1-score': 0.45403052248317793, 'support': 1845821}, '2': {'precision': 0.3895625356710156, 'recall': 0.01908315884009945, 'f1-score': 0.03638400622453979, 'support': 2038761}, 'accuracy': 0.31217396234973915, 'macro avg': {'precision': 0.34460508501229165, 'recall': 0.3309288641284727, 'f1-score': 0.21760198688253773, 'support': 5960968}, 'weighted avg': {'precision': 0.34575343280977106, 'recall': 0.31217396234973915, 'f1-score': 0.20960096778823886, 'support': 5960968}}
[[ 222176 1821961   32249]
 [ 217328 1599777   28716]
 [ 220412 1779443   38906]]
Evaluating performance on  train set...
7696/7696 - 95s - 95s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1426371
{'0': {'precision': 0.3351575543084306, 'recall': 0.30966505292027485, 'f1-score': 0.3219073916704011, 'support': 659955}, '1': {'precision': 0.32726237477425707, 'recall': 0.6736530654585879, 'f1-score': 0.44051933482942207, 'support': 645874}, '2': {'precision': 0.3640273963537703, 'recall': 0.016577990540208632, 'f1-score': 0.03171180934867137, 'support': 663651}, 'accuracy': 0.33027093445985745, 'macro avg': {'precision': 0.3421491084788193, 'recall': 0.33329870297302383, 'f1-score': 0.2647128452828315, 'support': 1969480}, 'weighted avg': {'precision': 0.34229660032909437, 'recall': 0.33027093445985745, 'f1-score': 0.2630186402093511, 'support': 1969480}}
[[204365 446337   9253]
 [200811 435095   9968]
 [204582 448067  11002]]
Evaluating performance on  val set...
2338/2338 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1371932
{'0': {'precision': 0.33711327019225956, 'recall': 0.3028165496018464, 'f1-score': 0.319045852051276, 'support': 200174}, '1': {'precision': 0.33580498587744073, 'recall': 0.6845905415216684, 'f1-score': 0.45058785726644307, 'support': 199715}, '2': {'precision': 0.36170409389150726, 'recall': 0.019778564967583165, 'f1-score': 0.0375062286787535, 'support': 197891}, 'accuracy': 0.3366673358091606, 'macro avg': {'precision': 0.34487411665373585, 'recall': 0.33572855203036606, 'f1-score': 0.26904664599882416, 'support': 597780}, 'weighted avg': {'precision': 0.34481680442012563, 'recall': 0.3366673358091606, 'f1-score': 0.2697915343469956, 'support': 597780}}
[[ 60616 136415   3143]
 [ 59228 136723   3764]
 [ 59965 134012   3914]]
testing model out of sample: results/universal/W8/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 173s - 173s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1362288
{'0': {'precision': 0.31669312053905496, 'recall': 0.1641799872831857, 'f1-score': 0.2162511134725162, 'support': 1149659}, '1': {'precision': 0.36073325247457066, 'recall': 0.812069164856486, 'f1-score': 0.4995561856695897, 'support': 1306039}, '2': {'precision': 0.3501809107922645, 'recall': 0.02418393126100758, 'f1-score': 0.045243303452689336, 'support': 1160564}, 'accuracy': 0.35324099857808977, 'macro avg': {'precision': 0.34253576126863, 'recall': 0.33347769446689307, 'f1-score': 0.25368353419826506, 'support': 3616262}, 'weighted avg': {'precision': 0.34334573964695003, 'recall': 0.35324099857808977, 'f1-score': 0.2636873791964442, 'support': 3616262}}
[[ 188751  937796   23112]
 [ 216474 1060594   28971]
 [ 190781  941716   28067]]
Evaluating performance on  train set...
4550/4550 - 61s - 61s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1428785
{'0': {'precision': 0.33052399743048544, 'recall': 0.2333869002877064, 'f1-score': 0.27358921965559413, 'support': 385810}, '1': {'precision': 0.33971794318474247, 'recall': 0.7439369243015806, 'f1-score': 0.4664376627018771, 'support': 395715}, '2': {'precision': 0.35639629614910784, 'recall': 0.023438030870876522, 'f1-score': 0.043983530698473966, 'support': 382626}, 'accuracy': 0.3379269527750266, 'macro avg': {'precision': 0.34221274558811193, 'recall': 0.33358728515338787, 'f1-score': 0.2613368043519817, 'support': 1164151}, 'weighted avg': {'precision': 0.34215272636140376, 'recall': 0.3379269527750266, 'f1-score': 0.2636763434884584, 'support': 1164151}}
[[ 90043 287820   7947]
 [ 93080 294387   8248]
 [ 89302 284356   8968]]
Evaluating performance on  val set...
1570/1570 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1492002
{'0': {'precision': 0.3196206306915338, 'recall': 0.12273990593121983, 'f1-score': 0.17736756738864182, 'support': 130968}, '1': {'precision': 0.34415127400160617, 'recall': 0.8450043739513272, 'f1-score': 0.4891022169097734, 'support': 139462}, '2': {'precision': 0.36576858311282173, 'recall': 0.023284304342166717, 'f1-score': 0.043781538616583994, 'support': 130603}, 'accuracy': 0.34152301680909053, 'macro avg': {'precision': 0.34318016260198725, 'recall': 0.33034286140823793, 'f1-score': 0.2367504409716664, 'support': 401033}, 'weighted avg': {'precision': 0.34318017219407043, 'recall': 0.34152301680909053, 'f1-score': 0.2422709583210563, 'support': 401033}}
[[ 16075 112588   2305]
 [ 18648 117846   2968]
 [ 15571 111991   3041]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1567103
{'0': {'precision': 0.34057841914603004, 'recall': 0.10422535211267606, 'f1-score': 0.15960703551152178, 'support': 55025}, '1': {'precision': 0.3262241761876542, 'recall': 0.8670830433349207, 'f1-score': 0.47408319814136074, 'support': 54598}, '2': {'precision': 0.3562521065048871, 'recall': 0.0191135784163035, 'f1-score': 0.036280634310427676, 'support': 55301}, 'accuracy': 0.328229972593437, 'macro avg': {'precision': 0.34101823394619046, 'recall': 0.3301406579546334, 'f1-score': 0.22332362265443673, 'support': 164924}, 'weighted avg': {'precision': 0.3410820306737079, 'recall': 0.328229972593437, 'f1-score': 0.22236137214198332, 'support': 164924}}
[[ 5735 48265  1025]
 [ 6372 47341   885]
 [ 4732 49512  1057]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1487647
{'0': {'precision': 0.33403762954019517, 'recall': 0.17360384856724534, 'f1-score': 0.2284691876268795, 'support': 19124}, '1': {'precision': 0.33113496932515335, 'recall': 0.8021762208067941, 'f1-score': 0.46876550868486344, 'support': 18840}, '2': {'precision': 0.3504761904761905, 'recall': 0.02876498176133403, 'f1-score': 0.053166385745244404, 'support': 19190}, 'accuracy': 0.3321727263183679, 'macro avg': {'precision': 0.33854959644717963, 'recall': 0.33484835037845784, 'f1-score': 0.25013369401899577, 'support': 57154}, 'weighted avg': {'precision': 0.3386002124899513, 'recall': 0.3321727263183679, 'f1-score': 0.2488198528580766, 'support': 57154}}
[[ 3320 15253   551]
 [ 3255 15113   472]
 [ 3364 15274   552]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1666212
{'0': {'precision': 0.3644220381706878, 'recall': 0.16498206716661232, 'f1-score': 0.22713500168331277, 'support': 6134}, '1': {'precision': 0.30398367117117114, 'recall': 0.8229801829268293, 'f1-score': 0.44397615131578944, 'support': 5248}, '2': {'precision': 0.3611111111111111, 'recall': 0.015542271562766866, 'f1-score': 0.029801866710332404, 'support': 5855}, 'accuracy': 0.3145558971978883, 'macro avg': {'precision': 0.3431722734843234, 'recall': 0.3345015072187361, 'f1-score': 0.2336376732364782, 'support': 17237}, 'weighted avg': {'precision': 0.3448962489992957, 'recall': 0.3145558971978883, 'f1-score': 0.22612536241919706, 'support': 17237}}
[[1012 5040   82]
 [ 850 4319   79]
 [ 915 4849   91]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
2179/2179 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1682805
{'0': {'precision': 0.36911764705882355, 'recall': 0.0013094263043398875, 'f1-score': 0.0026095952008400613, 'support': 191687}, '1': {'precision': 0.3332884550656345, 'recall': 0.9846063713712907, 'f1-score': 0.49800322420162946, 'support': 186051}, '2': {'precision': 0.34387139986604154, 'recall': 0.014257784294775663, 'f1-score': 0.027380311135050957, 'support': 180042}, 'accuracy': 0.3334737710208326, 'macro avg': {'precision': 0.3487591673301666, 'recall': 0.33339119399013545, 'f1-score': 0.17599771017917346, 'support': 557780}, 'weighted avg': {'precision': 0.34901753261117807, 'recall': 0.3334737710208326, 'f1-score': 0.17584680217752097, 'support': 557780}}
[[   251 189172   2264]
 [   230 183187   2634]
 [   199 177276   2567]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1385652
{'0': {'precision': 0.3613794984881897, 'recall': 0.29131693728695524, 'f1-score': 0.32258784613355246, 'support': 54566}, '1': {'precision': 0.32723193846717336, 'recall': 0.7097011220335617, 'f1-score': 0.4479303105317583, 'support': 50355}, '2': {'precision': 0.37712082262210794, 'recall': 0.028121765134378713, 'f1-score': 0.05234051662623091, 'support': 52166}, 'accuracy': 0.33802924494070163, 'macro avg': {'precision': 0.3552440865258237, 'recall': 0.3430466081516319, 'f1-score': 0.2742862244305139, 'support': 157087}, 'weighted avg': {'precision': 0.35566076638376154, 'recall': 0.33802924494070163, 'f1-score': 0.2730223034959868, 'support': 157087}}
[[15896 37478  1192]
 [13387 35737  1231]
 [14704 35995  1467]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1415049
{'0': {'precision': 0.3465057179161372, 'recall': 0.1676709296606001, 'f1-score': 0.22598823236927157, 'support': 16264}, '1': {'precision': 0.3509781648365518, 'recall': 0.8299904489016237, 'f1-score': 0.49333830077882446, 'support': 16752}, '2': {'precision': 0.3395348837209302, 'recall': 0.023481729284611425, 'f1-score': 0.043925627294061007, 'support': 15544}, 'accuracy': 0.35, 'macro avg': {'precision': 0.3456729221578731, 'recall': 0.34038103594894503, 'f1-score': 0.25441738681405235, 'support': 48560}, 'weighted avg': {'precision': 0.34581724559489524, 'recall': 0.35, 'f1-score': 0.25993936936901946, 'support': 48560}}
[[ 2727 13191   346]
 [ 2484 13904   364]
 [ 2659 12520   365]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0913152
{'0': {'precision': 0.2755391869118176, 'recall': 0.3731488723346967, 'f1-score': 0.3170002450780165, 'support': 77993}, '1': {'precision': 0.4745963505371272, 'recall': 0.6482139065623101, 'f1-score': 0.5479820877600725, 'support': 136583}, '2': {'precision': 0.2900056678632156, 'recall': 0.018519188775079326, 'f1-score': 0.03481515082785212, 'support': 82887}, 'accuracy': 0.40063133902367687, 'macro avg': {'precision': 0.34671373510405346, 'recall': 0.346627322557362, 'f1-score': 0.29993249455531373, 'support': 297463}, 'weighted avg': {'precision': 0.37096923295470086, 'recall': 0.40063133902367687, 'f1-score': 0.34442791545023044, 'support': 297463}}
[[29103 47610  1280]
 [45570 88535  2478]
 [30949 50403  1535]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1488585
{'0': {'precision': 0.3590478628103404, 'recall': 0.24322075039877938, 'f1-score': 0.28999648564281727, 'support': 28838}, '1': {'precision': 0.32535869635785236, 'recall': 0.7425819596221522, 'f1-score': 0.4524698951550103, 'support': 26995}, '2': {'precision': 0.324435318275154, 'recall': 0.028469494396194457, 'f1-score': 0.05234561357010337, 'support': 27749}, 'accuracy': 0.3332057141489794, 'macro avg': {'precision': 0.3362806258144489, 'recall': 0.3380907348057087, 'f1-score': 0.264937331455977, 'support': 83582}, 'weighted avg': {'precision': 0.3366757905137717, 'recall': 0.3332057141489794, 'f1-score': 0.2635720837457092, 'support': 83582}}
[[ 7014 20999   825]
 [ 6129 20046   820]
 [ 6392 20567   790]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1303803
{'0': {'precision': 0.30669171845642434, 'recall': 0.2102447240661845, 'f1-score': 0.2494709616741124, 'support': 10093}, '1': {'precision': 0.3597306564216962, 'recall': 0.7535479404638283, 'f1-score': 0.48698375415932665, 'support': 11556}, '2': {'precision': 0.3123123123123123, 'recall': 0.020506753426008086, 'f1-score': 0.038486446479785365, 'support': 10143}, 'accuracy': 0.3471942627075994, 'macro avg': {'precision': 0.3262448957301443, 'recall': 0.3280998059853403, 'f1-score': 0.2583137207710748, 'support': 31792}, 'weighted avg': {'precision': 0.3277639268927276, 'recall': 0.3471942627075994, 'f1-score': 0.26849090041162743, 'support': 31792}}
[[2122 7772  199]
 [2589 8708  259]
 [2208 7727  208]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1413306
{'0': {'precision': 0.2976748076279692, 'recall': 0.17366227834759781, 'f1-score': 0.2193542024912326, 'support': 102469}, '1': {'precision': 0.34857133551019076, 'recall': 0.7552132952259977, 'f1-score': 0.4769874476987447, 'support': 113364}, '2': {'precision': 0.3479513025265087, 'recall': 0.027345679012345678, 'f1-score': 0.050706321120956896, 'support': 97200}, 'accuracy': 0.33883648049886117, 'macro avg': {'precision': 0.33139914855488956, 'recall': 0.31874041752864707, 'f1-score': 0.24901599043697806, 'support': 313033}, 'weighted avg': {'precision': 0.33171821292702136, 'recall': 0.33883648049886117, 'f1-score': 0.26028842073823405, 'support': 313033}}
[[17795 82233  2441]
 [25210 85614  2540]
 [16775 77767  2658]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1501367
{'0': {'precision': 0.32262030207235687, 'recall': 0.2432951460168201, 'f1-score': 0.27739816527615235, 'support': 30202}, '1': {'precision': 0.3246513038204973, 'recall': 0.7070827142149579, 'f1-score': 0.4449893500961089, 'support': 30285}, '2': {'precision': 0.3395452851285874, 'recall': 0.029451700504332084, 'f1-score': 0.05420199315781645, 'support': 30932}, 'accuracy': 0.3245824172218029, 'macro avg': {'precision': 0.32893896367381387, 'recall': 0.32660985357870337, 'f1-score': 0.2588631695100259, 'support': 91419}, 'weighted avg': {'precision': 0.32901976458931453, 'recall': 0.3245824172218029, 'f1-score': 0.25739789220718434, 'support': 91419}}
[[ 7348 22027   827]
 [ 7926 21414   945]
 [ 7502 22519   911]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1342782
{'0': {'precision': 0.34067155881698913, 'recall': 0.3614486256930518, 'f1-score': 0.35075267586285847, 'support': 8477}, '1': {'precision': 0.3545669241079977, 'recall': 0.6411588180978762, 'f1-score': 0.45661912786157577, 'support': 8664}, '2': {'precision': 0.2981574539363484, 'recall': 0.021929284218307258, 'f1-score': 0.04085379848519624, 'support': 8117}, 'accuracy': 0.34828569166204765, 'macro avg': {'precision': 0.33113197895377844, 'recall': 0.34151224266974506, 'f1-score': 0.2827418674032101, 'support': 25258}, 'weighted avg': {'precision': 0.33177546473056646, 'recall': 0.34828569166204765, 'f1-score': 0.2874767930709669, 'support': 25258}}
[[3064 5221  192]
 [2882 5555  227]
 [3048 4891  178]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.159829
{'0': {'precision': 0.30545180851214904, 'recall': 0.176918141738501, 'f1-score': 0.22406025219669468, 'support': 121576}, '1': {'precision': 0.3223038070213701, 'recall': 0.7625604062576787, 'f1-score': 0.4531002479614358, 'support': 122090}, '2': {'precision': 0.36481986073266726, 'recall': 0.028799961759386875, 'f1-score': 0.053385512811046296, 'support': 125521}, 'accuracy': 0.32023066901055564, 'macro avg': {'precision': 0.3308584920887288, 'recall': 0.3227595032518556, 'f1-score': 0.24351533765639224, 'support': 369187}, 'weighted avg': {'precision': 0.33120948085912355, 'recall': 0.32023066901055564, 'f1-score': 0.2417754727231251, 'support': 369187}}
[[21509 96837  3230]
 [25925 93101  3064]
 [22983 98923  3615]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1433072
{'0': {'precision': 0.32941929448834406, 'recall': 0.32298706313960224, 'f1-score': 0.3261714703552495, 'support': 41432}, '1': {'precision': 0.33365430337612934, 'recall': 0.6747848247343367, 'f1-score': 0.44652146936697584, 'support': 41594}, '2': {'precision': 0.32666236281471916, 'recall': 0.01169509545601627, 'f1-score': 0.0225817248689055, 'support': 43266}, 'accuracy': 0.3322063155227568, 'macro avg': {'precision': 0.32991198689306417, 'recall': 0.3364889944433184, 'f1-score': 0.2650915548637103, 'support': 126292}, 'weighted avg': {'precision': 0.32986959659685045, 'recall': 0.3322063155227568, 'f1-score': 0.26180257866521045, 'support': 126292}}
[[13382 27502   548]
 [13032 28067   495]
 [14209 28551   506]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.152159
{'0': {'precision': 0.3247553816046967, 'recall': 0.26070222292043044, 'f1-score': 0.28922487037601846, 'support': 12731}, '1': {'precision': 0.31379726909982797, 'recall': 0.6926308985132514, 'f1-score': 0.4319149472199128, 'support': 12376}, '2': {'precision': 0.3567921440261866, 'recall': 0.01671650947013266, 'f1-score': 0.03193671256958688, 'support': 13041}, 'accuracy': 0.31742162105483906, 'macro avg': {'precision': 0.3317815982435704, 'recall': 0.3233498769679382, 'f1-score': 0.2510255100551727, 'support': 38148}, 'weighted avg': {'precision': 0.3321521997440066, 'recall': 0.31742162105483906, 'f1-score': 0.2475618087493634, 'support': 38148}}
[[3319 9212  200]
 [3611 8572  193]
 [3290 9533  218]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
5521/5521 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1585897
{'0': {'precision': 0.30586987440638336, 'recall': 0.13218184848737394, 'f1-score': 0.18459210765593745, 'support': 479960}, '1': {'precision': 0.31567324584241735, 'recall': 0.8064335341041421, 'f1-score': 0.45373487767171367, 'support': 458566}, '2': {'precision': 0.45463525173585895, 'recall': 0.0329602513985307, 'f1-score': 0.06146443966575347, 'support': 474784}, 'accuracy': 0.3176189229539167, 'macro avg': {'precision': 0.3587261239948865, 'recall': 0.3238585446633489, 'f1-score': 0.23326380833113483, 'support': 1413310}, 'weighted avg': {'precision': 0.359026587184142, 'recall': 0.3176189229539167, 'f1-score': 0.23055560947507328, 'support': 1413310}}
[[ 63442 406790   9728]
 [ 79719 369803   9044]
 [ 64254 394881  15649]]
Evaluating performance on  train set...
1289/1289 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1481296
{'0': {'precision': 0.3383227543058764, 'recall': 0.16816583346140285, 'f1-score': 0.22466183574879228, 'support': 110617}, '1': {'precision': 0.33189535416338145, 'recall': 0.8101304104768277, 'f1-score': 0.47087995355068274, 'support': 109117}, '2': {'precision': 0.4079276276633734, 'recall': 0.03115567838830503, 'f1-score': 0.057889980320447315, 'support': 109996}, 'accuracy': 0.3349043156522003, 'macro avg': {'precision': 0.3593819120442104, 'recall': 0.33648397410884523, 'f1-score': 0.2511439232066408, 'support': 329730}, 'weighted avg': {'precision': 0.35941552423425, 'recall': 0.3349043156522003, 'f1-score': 0.2505082717736995, 'support': 329730}}
[[18602 89813  2202]
 [17946 88399  2772]
 [18435 88134  3427]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1469573
{'0': {'precision': 0.41035618078419633, 'recall': 0.036762931381224356, 'f1-score': 0.06748043510360782, 'support': 37293}, '1': {'precision': 0.3395605339236134, 'recall': 0.9327235559282944, 'f1-score': 0.4978701080684083, 'support': 38156}, '2': {'precision': 0.41543730242360377, 'recall': 0.04320903087925035, 'f1-score': 0.07827662373116918, 'support': 36497}, 'accuracy': 0.3442463330534365, 'macro avg': {'precision': 0.38845133904380447, 'recall': 0.3375651727295897, 'f1-score': 0.21454238896772845, 'support': 111946}, 'weighted avg': {'precision': 0.387882550595186, 'recall': 0.3442463330534365, 'f1-score': 0.217695510747088, 'support': 111946}}
[[ 1371 34996   926]
 [ 1274 35589  1293]
 [  696 34224  1577]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
5918/5918 - 71s - 71s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1362574
{'0': {'precision': 0.4945384707718161, 'recall': 0.008564171000719224, 'f1-score': 0.016836771181332432, 'support': 481074}, '1': {'precision': 0.3680706097802213, 'recall': 0.9728934280128795, 'f1-score': 0.5340836401387837, 'support': 556544}, '2': {'precision': 0.35575464809301804, 'recall': 0.02653386120362806, 'f1-score': 0.049384400658094796, 'support': 477390}, 'accuracy': 0.36847660210375127, 'macro avg': {'precision': 0.40612124288168516, 'recall': 0.33599715340574227, 'f1-score': 0.200101603992737, 'support': 1515008}, 'weighted avg': {'precision': 0.4043482286500995, 'recall': 0.36847660210375127, 'f1-score': 0.21710538644472865, 'support': 1515008}}
[[  4120 466975   9979]
 [  2126 541458  12960]
 [  2085 462638  12667]]
Evaluating performance on  train set...
1814/1814 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1318605
{'0': {'precision': 0.3263026195237767, 'recall': 0.22308583436607576, 'f1-score': 0.26499825985382774, 'support': 148472}, '1': {'precision': 0.35779722896210797, 'recall': 0.7614692735071092, 'f1-score': 0.48683954250319633, 'support': 165769}, '2': {'precision': 0.3591182364729459, 'recall': 0.023887281888588224, 'f1-score': 0.04479496056693622, 'support': 150038}, 'accuracy': 0.35093984436082615, 'macro avg': {'precision': 0.34773936165294356, 'recall': 0.33614746325392436, 'f1-score': 0.2655442543079867, 'support': 464279}, 'weighted avg': {'precision': 0.34815245431665376, 'recall': 0.35093984436082615, 'f1-score': 0.27304416536559234, 'support': 464279}}
[[ 33122 112505   2845]
 [ 35990 126228   3551]
 [ 32395 114059   3584]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152502
{'0': {'precision': 0.32659836843103773, 'recall': 0.06997398585480855, 'f1-score': 0.11525457771231547, 'support': 49204}, '1': {'precision': 0.40222611980572043, 'recall': 0.9154358706666257, 'f1-score': 0.5588872121251887, 'support': 65134}, '2': {'precision': 0.3571065989847716, 'recall': 0.029079861111111112, 'f1-score': 0.05378029202660348, 'support': 48384}, 'accuracy': 0.3962340679195192, 'macro avg': {'precision': 0.36197702907384327, 'recall': 0.33816323921084845, 'f1-score': 0.24264069395470256, 'support': 162722}, 'weighted avg': {'precision': 0.3659418387985998, 'recall': 0.3962340679195192, 'f1-score': 0.2745520062790157, 'support': 162722}}
[[ 3443 44825   936]
 [ 3911 59626  1597]
 [ 3188 43789  1407]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
3755/3755 - 46s - 46s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201828
{'0': {'precision': 0.308296943231441, 'recall': 0.0012141223408829044, 'f1-score': 0.0024187193805885777, 'support': 290745}, '1': {'precision': 0.4074848478780706, 'recall': 0.9871655433006536, 'f1-score': 0.5768542478984482, 'support': 391680}, '2': {'precision': 0.2880351853514047, 'recall': 0.011512603233143669, 'f1-score': 0.02214027232051994, 'support': 278738}, 'accuracy': 0.4059821279013029, 'macro avg': {'precision': 0.33460565882030546, 'recall': 0.33329742295822673, 'f1-score': 0.2004710798665189, 'support': 961163}, 'weighted avg': {'precision': 0.3428407163729647, 'recall': 0.4059821279013029, 'f1-score': 0.24222409477814946, 'support': 961163}}
[[   353 287060   3332]
 [   427 386653   4600]
 [   365 275164   3209]]
Evaluating performance on  train set...
1532/1532 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1417445
{'0': {'precision': 0.3319059912757055, 'recall': 0.2867195250436428, 'f1-score': 0.3076624732323003, 'support': 130033}, '1': {'precision': 0.33007537023977435, 'recall': 0.6901225655833384, 'f1-score': 0.4465652268977718, 'support': 130216}, '2': {'precision': 0.32587228439763, 'recall': 0.01875966406936907, 'f1-score': 0.03547700445075146, 'support': 131932}, 'accuracy': 0.3305183065982289, 'macro avg': {'precision': 0.32928454863770334, 'recall': 0.3318672515654501, 'f1-score': 0.2632349015269412, 'support': 392181}, 'weighted avg': {'precision': 0.329268394949894, 'recall': 0.3305183065982289, 'f1-score': 0.26221760900893337, 'support': 392181}}
[[37283 90490  2260]
 [37491 89865  2860]
 [37556 91901  2475]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1323788
{'0': {'precision': 0.3037961445951128, 'recall': 0.2338279090982265, 'f1-score': 0.26425907395615394, 'support': 37271}, '1': {'precision': 0.36148671759206474, 'recall': 0.7251395114811088, 'f1-score': 0.4824626808892675, 'support': 43724}, '2': {'precision': 0.31915606162089755, 'recall': 0.02482546629154944, 'f1-score': 0.04606757867259632, 'support': 38388}, 'accuracy': 0.3465652563597832, 'macro avg': {'precision': 0.328146307936025, 'recall': 0.3279309622902949, 'f1-score': 0.2642631111726726, 'support': 119383}, 'weighted avg': {'precision': 0.3298643377926749, 'recall': 0.3465652563597832, 'f1-score': 0.27401590188473884, 'support': 119383}}
[[ 8715 27626   930]
 [10915 31706  1103]
 [ 9057 28378   953]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
4960/4960 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1372423
{'0': {'precision': 0.3248516592654445, 'recall': 0.31011060626921844, 'f1-score': 0.31731002130509794, 'support': 413991}, '1': {'precision': 0.3421275321871214, 'recall': 0.6654539869424883, 'f1-score': 0.45191406554059316, 'support': 436224}, '2': {'precision': 0.34882110850417325, 'recall': 0.021620397410987806, 'f1-score': 0.04071709498410646, 'support': 419465}, 'accuracy': 0.3368872471803919, 'macro avg': {'precision': 0.33860009998557966, 'recall': 0.3323949968742315, 'f1-score': 0.26998039394326584, 'support': 1269680}, 'weighted avg': {'precision': 0.338705933897091, 'recall': 0.3368872471803919, 'f1-score': 0.27217775392540383, 'support': 1269680}}
[[128383 278088   7520]
 [136527 290287   9410]
 [130295 280101   9069]]
Evaluating performance on  train set...
1691/1691 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1527363
{'0': {'precision': 0.3321135671714317, 'recall': 0.22636943708430216, 'f1-score': 0.26923061463202874, 'support': 147944}, '1': {'precision': 0.3254388305298231, 'recall': 0.73605254110036, 'f1-score': 0.4513274145909119, 'support': 142517}, '2': {'precision': 0.35808086030400166, 'recall': 0.024321723801296505, 'f1-score': 0.04554960737632684, 'support': 142383}, 'accuracy': 0.32772315199009344, 'macro avg': {'precision': 0.3385444193350855, 'recall': 0.3289145673286529, 'f1-score': 0.25536921219975584, 'support': 432844}, 'weighted avg': {'precision': 0.3384577411836453, 'recall': 0.32772315199009344, 'f1-score': 0.25560796255333884, 'support': 432844}}
[[ 33490 111359   3095]
 [ 34504 104900   3113]
 [ 32845 106075   3463]]
Evaluating performance on  val set...
591/591 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1864414
{'0': {'precision': 0.306710077834868, 'recall': 0.1141726318978904, 'f1-score': 0.16640216386293696, 'support': 52806}, '1': {'precision': 0.28538743492167257, 'recall': 0.8122618942145832, 'f1-score': 0.42237412682050374, 'support': 45148}, '2': {'precision': 0.3851578240429819, 'recall': 0.02156825874388868, 'f1-score': 0.04084903308522383, 'support': 53180}, 'accuracy': 0.2901266425820795, 'macro avg': {'precision': 0.32575177893317414, 'recall': 0.31600092828545406, 'f1-score': 0.2098751079228882, 'support': 151134}, 'weighted avg': {'precision': 0.3279440586803597, 'recall': 0.2901266425820795, 'f1-score': 0.1986894499061135, 'support': 151134}}
[[ 6029 45838   939]
 [ 7584 36672   892]
 [ 6044 45989  1147]]
testing model on single stock: results/universal/W8/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
10609/10609 - 130s - 130s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1954709
{'0': {'precision': 0.35879409569955123, 'recall': 0.13879933763377078, 'f1-score': 0.20016495192228867, 'support': 1011525}, '1': {'precision': 0.2515250051847114, 'recall': 0.8257828660078143, 'f1-score': 0.38560015239495515, 'support': 696160}, '2': {'precision': 0.3727324263038549, 'recall': 0.01435024112174937, 'f1-score': 0.027636474797120763, 'support': 1007997}, 'accuracy': 0.2687137153761007, 'macro avg': {'precision': 0.32768384239603915, 'recall': 0.3263108149211114, 'f1-score': 0.20446719303812153, 'support': 2715682}, 'weighted avg': {'precision': 0.3364694440582086, 'recall': 0.2687137153761007, 'f1-score': 0.18366242394011462, 'support': 2715682}}
[[140399 856217  14909]
 [111849 574877   9434]
 [139060 854472  14465]]
Evaluating performance on  train set...
3903/3903 - 48s - 48s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1413095
{'0': {'precision': 0.3317479286381578, 'recall': 0.372586589824145, 'f1-score': 0.3509833074271812, 'support': 334537}, '1': {'precision': 0.3230688536942221, 'recall': 0.610461459154774, 'f1-score': 0.4225274340192458, 'support': 325901}, '2': {'precision': 0.3617049528615058, 'recall': 0.008044296788482836, 'f1-score': 0.01573856873779452, 'support': 338625}, 'accuracy': 0.3266240467317877, 'macro avg': {'precision': 0.33884057839796183, 'recall': 0.3303641152558006, 'f1-score': 0.26308310339474056, 'support': 999063}, 'weighted avg': {'precision': 0.3390704679818505, 'recall': 0.3266240467317877, 'f1-score': 0.26069275794410246, 'support': 999063}}
[[124644 207156   2737]
 [124881 198950   2070]
 [126194 209707   2724]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1348205
{'0': {'precision': 0.3416589742220459, 'recall': 0.44399171202252424, 'f1-score': 0.38616081051950846, 'support': 100869}, '1': {'precision': 0.31473235314437165, 'recall': 0.5422261656152956, 'f1-score': 0.3982832618025751, 'support': 92419}, '2': {'precision': 0.34277134277134275, 'recall': 0.00804267955105944, 'f1-score': 0.015716589952397816, 'support': 99345}, 'accuracy': 0.3270171170032088, 'macro avg': {'precision': 0.33305422337925344, 'recall': 0.33142018572962645, 'f1-score': 0.26672022075816043, 'support': 292633}, 'weighted avg': {'precision': 0.33353267561646244, 'recall': 0.3270171170032088, 'f1-score': 0.2642284369761628, 'support': 292633}}
[[44785 55285   799]
 [41574 50112   733]
 [44722 53824   799]]
training model: results/universal/W8/deepOF_L1/h50
Epoch 1/50
7695/7695 - 163s - loss: 3.1415 - accuracy50: 0.4409 - val_loss: 3.2230 - val_accuracy50: 0.3877 - 163s/epoch - 21ms/step
Epoch 2/50
7695/7695 - 159s - loss: 3.1323 - accuracy50: 0.4430 - val_loss: 3.2242 - val_accuracy50: 0.3964 - 159s/epoch - 21ms/step
Epoch 3/50
7695/7695 - 159s - loss: 3.1230 - accuracy50: 0.4458 - val_loss: 3.2232 - val_accuracy50: 0.4108 - 159s/epoch - 21ms/step
Epoch 4/50
7695/7695 - 159s - loss: 3.1152 - accuracy50: 0.4481 - val_loss: 3.2274 - val_accuracy50: 0.4148 - 159s/epoch - 21ms/step
Epoch 5/50
7695/7695 - 155s - loss: 3.1085 - accuracy50: 0.4497 - val_loss: 3.2326 - val_accuracy50: 0.4173 - 155s/epoch - 20ms/step
Epoch 6/50
7695/7695 - 163s - loss: 3.1033 - accuracy50: 0.4509 - val_loss: 3.2391 - val_accuracy50: 0.4187 - 163s/epoch - 21ms/step
Epoch 7/50
7695/7695 - 159s - loss: 3.0989 - accuracy50: 0.4518 - val_loss: 3.2336 - val_accuracy50: 0.4169 - 159s/epoch - 21ms/step
Epoch 8/50
7695/7695 - 159s - loss: 3.0955 - accuracy50: 0.4528 - val_loss: 3.2438 - val_accuracy50: 0.4180 - 159s/epoch - 21ms/step
Epoch 9/50
7695/7695 - 158s - loss: 3.0913 - accuracy50: 0.4535 - val_loss: 3.2443 - val_accuracy50: 0.4198 - 158s/epoch - 20ms/step
Epoch 10/50
7695/7695 - 159s - loss: 3.0871 - accuracy50: 0.4546 - val_loss: 3.2440 - val_accuracy50: 0.4161 - 159s/epoch - 21ms/step
Epoch 11/50
7695/7695 - 156s - loss: 3.0832 - accuracy50: 0.4559 - val_loss: 3.2366 - val_accuracy50: 0.4141 - 156s/epoch - 20ms/step
testing model in sample: results/universal/W8/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 284s - 284s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0628783
{'0': {'precision': 0.3903217671682095, 'recall': 0.46564376602245194, 'f1-score': 0.4246687292355257, 'support': 1708540}, '1': {'precision': 0.4426842337743213, 'recall': 0.2890160953864882, 'f1-score': 0.349713847693227, 'support': 2538305}, '2': {'precision': 0.3846191874592531, 'recall': 0.5083484141513496, 'f1-score': 0.4379118652108787, 'support': 1714098}, 'accuracy': 0.402711617943671, 'macro avg': {'precision': 0.40587506280059465, 'recall': 0.4210027585200966, 'f1-score': 0.4040981473798771, 'support': 5960943}, 'weighted avg': {'precision': 0.41097909107227365, 'recall': 0.402711617943671, 'f1-score': 0.3965593650453054, 'support': 5960943}}
[[795571 471185 441784]
 [852326 733611 952368]
 [390347 452392 871359]]
Evaluating performance on  train set...
7695/7695 - 96s - 96s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.081782
{'0': {'precision': 0.3839403468066919, 'recall': 0.41394150145069686, 'f1-score': 0.3983768874345777, 'support': 607639}, '1': {'precision': 0.39451358399630276, 'recall': 0.30048897328842805, 'f1-score': 0.3411411384341722, 'support': 755665}, '2': {'precision': 0.38142645597754143, 'recall': 0.46487507526828503, 'f1-score': 0.4190365865718129, 'support': 606165}, 'accuracy': 0.386087315921195, 'macro avg': {'precision': 0.3866267955935121, 'recall': 0.39310185000246994, 'f1-score': 0.38618487081352093, 'support': 1969469}, 'weighted avg': {'precision': 0.38722346151752784, 'recall': 0.386087315921195, 'f1-score': 0.3827747806022949, 'support': 1969469}}
[[251527 179507 176605]
 [248210 227069 280386]
 [155383 168991 281791]]
Evaluating performance on  val set...
2338/2338 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762501
{'0': {'precision': 0.3817242560818112, 'recall': 0.40553632830438047, 'f1-score': 0.39327017332344927, 'support': 178566}, '1': {'precision': 0.4174407125709542, 'recall': 0.3061188394113147, 'f1-score': 0.35321616888386864, 'support': 243118}, '2': {'precision': 0.37006832325166455, 'recall': 0.48290979300945513, 'f1-score': 0.41902509331460885, 'support': 176095}, 'accuracy': 0.387895861179466, 'macro avg': {'precision': 0.38974443063480996, 'recall': 0.39818832024171674, 'f1-score': 0.38850381184064225, 'support': 597779}, 'weighted avg': {'precision': 0.39281658615195886, 'recall': 0.387895861179466, 'f1-score': 0.38456706261614987, 'support': 597779}}
[[72415 54042 52109]
 [76052 74423 92643]
 [41238 49819 85038]]
testing model out of sample: results/universal/W8/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 170s - 170s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0640529
{'0': {'precision': 0.33575664071935607, 'recall': 0.46494313645093766, 'f1-score': 0.38992828541049246, 'support': 926780}, '1': {'precision': 0.5020534028996975, 'recall': 0.27612251535918564, 'f1-score': 0.35629025571357853, 'support': 1764742}, '2': {'precision': 0.3401921627150893, 'recall': 0.5011684681226107, 'f1-score': 0.40528063426378164, 'support': 924715}, 'accuracy': 0.38206096558383756, 'macro avg': {'precision': 0.39266740211138096, 'recall': 0.414078039977578, 'f1-score': 0.3838330584626175, 'support': 3616237}, 'weighted avg': {'precision': 0.41804452019350125, 'recall': 0.38206096558383756, 'f1-score': 0.3774385352825219, 'support': 3616237}}
[[430900 246299 249581]
 [628193 487285 649264]
 [224277 237000 463438]]
Evaluating performance on  train set...
4550/4550 - 57s - 57s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0715004
{'0': {'precision': 0.3638024008485245, 'recall': 0.44612158692051723, 'f1-score': 0.40077860846941465, 'support': 329065}, '1': {'precision': 0.45157745637937713, 'recall': 0.28025520390886927, 'f1-score': 0.34586303395752793, 'support': 507359}, '2': {'precision': 0.3639771618301944, 'recall': 0.4950613177752892, 'f1-score': 0.41951790904295483, 'support': 327719}, 'accuracy': 0.38761045679096123, 'macro avg': {'precision': 0.39311900635269864, 'recall': 0.4071460362015586, 'f1-score': 0.3887198504899658, 'support': 1164143}, 'weighted avg': {'precision': 0.40210588838676486, 'recall': 0.38761045679096123, 'f1-score': 0.38212051738943875, 'support': 1164143}}
[[146803  88930  93332]
 [174997 142190 190172]
 [ 81724  83754 162241]]
Evaluating performance on  val set...
1570/1570 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0688252
{'0': {'precision': 0.3471366666018927, 'recall': 0.4887105599124567, 'f1-score': 0.40593388198134395, 'support': 109660}, '1': {'precision': 0.46488341349534495, 'recall': 0.2730441582184728, 'f1-score': 0.3440275310834814, 'support': 181597}, '2': {'precision': 0.36516247937308466, 'recall': 0.4656743067448894, 'f1-score': 0.40933860241272585, 'support': 109772}, 'accuracy': 0.3847452428627356, 'macro avg': {'precision': 0.39239418649010743, 'recall': 0.4091430082919396, 'f1-score': 0.3864333384925171, 'support': 401029}, 'weighted avg': {'precision': 0.4053897742702397, 'recall': 0.3847452428627356, 'f1-score': 0.3788329375788057, 'support': 401029}}
[[53592 28384 27684]
 [70828 49584 61185]
 [29963 28691 51118]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077714
{'0': {'precision': 0.39272133542440973, 'recall': 0.3261141042566097, 'f1-score': 0.35633180963148503, 'support': 56054}, '1': {'precision': 0.3355896747710767, 'recall': 0.3110025970225685, 'f1-score': 0.32282866635026103, 'support': 54678}, '2': {'precision': 0.35955686853766616, 'recall': 0.4492221381512171, 'f1-score': 0.3994191341160255, 'support': 54187}, 'accuracy': 0.3615532473517302, 'macro avg': {'precision': 0.3626226262443842, 'recall': 0.3621129464767984, 'f1-score': 0.3595265366992571, 'support': 164919}, 'weighted avg': {'precision': 0.36288288195091717, 'recall': 0.3615532473517302, 'f1-score': 0.35938111252268023, 'support': 164919}}
[[18280 17158 20616]
 [14931 17005 22742]
 [13336 16509 24342]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1053144
{'0': {'precision': 0.3744735989633949, 'recall': 0.3066801082400382, 'f1-score': 0.33720319701300977, 'support': 18847}, '1': {'precision': 0.3421719839425312, 'recall': 0.34101916192882714, 'f1-score': 0.34159460029529637, 'support': 18996}, '2': {'precision': 0.37740817132575594, 'recall': 0.4453420330381648, 'f1-score': 0.4085704784075253, 'support': 19311}, 'accuracy': 0.36494383595198937, 'macro avg': {'precision': 0.364684584743894, 'recall': 0.36434710106901, 'f1-score': 0.3624560919052771, 'support': 57154}, 'weighted avg': {'precision': 0.36472918996233156, 'recall': 0.36494383595198937, 'f1-score': 0.3627760819862366, 'support': 57154}}
[[5780 6409 6658]
 [4989 6478 7529]
 [4666 6045 8600]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1105205
{'0': {'precision': 0.39086595492289444, 'recall': 0.3248972884141331, 'f1-score': 0.3548416045948129, 'support': 6085}, '1': {'precision': 0.30428441203281675, 'recall': 0.3173003802281369, 'f1-score': 0.3106561191251745, 'support': 5260}, '2': {'precision': 0.3749252839210998, 'recall': 0.4259762308998302, 'f1-score': 0.39882371642028297, 'support': 5890}, 'accuracy': 0.3571221351900203, 'macro avg': {'precision': 0.35669188362560367, 'recall': 0.3560579665140334, 'f1-score': 0.3547738133800901, 'support': 17235}, 'weighted avg': {'precision': 0.358994213245936, 'recall': 0.3571221351900203, 'f1-score': 0.3563872376137697, 'support': 17235}}
[[1977 1983 2125]
 [1533 1669 2058]
 [1548 1833 2509]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0318751
{'0': {'precision': 0.3439082392656129, 'recall': 0.4874857691760353, 'f1-score': 0.4032994484976251, 'support': 112432}, '1': {'precision': 0.6558119684175228, 'recall': 0.3194017175232507, 'f1-score': 0.42958271013760563, 'support': 336764}, '2': {'precision': 0.2958841925175669, 'recall': 0.6387238784663701, 'f1-score': 0.40442257003568843, 'support': 108579}, 'accuracy': 0.41544350320469725, 'macro avg': {'precision': 0.4318681334002343, 'recall': 0.4818704550552187, 'f1-score': 0.41243490955697304, 'support': 557775}, 'weighted avg': {'precision': 0.522875644531639, 'recall': 0.41544350320469725, 'f1-score': 0.4193869456719477, 'support': 557775}}
[[ 54809  32129  25494]
 [ 89658 107563 139543]
 [ 14904  24323  69352]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0440024
{'0': {'precision': 0.3681428376968102, 'recall': 0.43964886613021215, 'f1-score': 0.4007309815155519, 'support': 36909}, '1': {'precision': 0.5798934616729396, 'recall': 0.337680846986682, 'f1-score': 0.4268186531634839, 'support': 83496}, '2': {'precision': 0.33844839636561314, 'recall': 0.5941001663076965, 'f1-score': 0.4312316947676719, 'support': 36679}, 'accuracy': 0.4215133304474039, 'macro avg': {'precision': 0.4288282319117877, 'recall': 0.4571432931415302, 'f1-score': 0.41959377648223595, 'support': 157084}, 'weighted avg': {'precision': 0.47376255508320175, 'recall': 0.4215133304474039, 'f1-score': 0.4217194456066767, 'support': 157084}}
[[16227 11291  9391]
 [22098 28195 33203]
 [ 5753  9135 21791]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0351365
{'0': {'precision': 0.35307845425217926, 'recall': 0.50234375, 'f1-score': 0.4146882179854085, 'support': 10240}, '1': {'precision': 0.646444520783236, 'recall': 0.33347510189615454, 'f1-score': 0.4399812953004443, 'support': 28215}, '2': {'precision': 0.3126672154764355, 'recall': 0.6013854527461653, 'f1-score': 0.4114281845570563, 'support': 10105}, 'accuracy': 0.42483525535420097, 'macro avg': {'precision': 0.437396730170617, 'recall': 0.4790681015474399, 'f1-score': 0.42203256594763633, 'support': 48560}, 'weighted avg': {'precision': 0.5151247474841577, 'recall': 0.42483525535420097, 'f1-score': 0.4287059597203804, 'support': 48560}}
[[ 5144  2684  2412]
 [ 7859  9409 10947]
 [ 1566  2462  6077]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0670985
{'0': {'precision': 0.36342840596496306, 'recall': 0.4830651989839119, 'f1-score': 0.41479253763405327, 'support': 77946}, '1': {'precision': 0.4385664663674856, 'recall': 0.2459704081850306, 'f1-score': 0.31517476051000093, 'support': 140647}, '2': {'precision': 0.30852997712466623, 'recall': 0.4497812717935713, 'f1-score': 0.36600012381600944, 'support': 78865}, 'accuracy': 0.3621351585770092, 'macro avg': {'precision': 0.37017494981903826, 'recall': 0.39293895965417125, 'f1-score': 0.3653224739866879, 'support': 297458}, 'weighted avg': {'precision': 0.3844007052171048, 'recall': 0.3621351585770092, 'f1-score': 0.35475396003679044, 'support': 297458}}
[[37653 22101 18192]
 [44745 34595 61307]
 [21207 22186 35472]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0826523
{'0': {'precision': 0.41900527924423453, 'recall': 0.48591171100211233, 'f1-score': 0.4499850800702894, 'support': 27931}, '1': {'precision': 0.32979310344827584, 'recall': 0.2574936281724522, 'f1-score': 0.28919305743141094, 'support': 27857}, '2': {'precision': 0.41221425902652764, 'recall': 0.43664100165503344, 'f1-score': 0.4240761771643225, 'support': 27794}, 'accuracy': 0.3933981000693929, 'macro avg': {'precision': 0.38700421390634604, 'recall': 0.3933487802765327, 'f1-score': 0.3877514382220076, 'support': 83582}, 'weighted avg': {'precision': 0.3870135442166094, 'recall': 0.3933981000693929, 'f1-score': 0.3877791574790655, 'support': 83582}}
[[13572  7086  7273]
 [10652  7173 10032]
 [ 8167  7491 12136]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0740079
{'0': {'precision': 0.4038861901457321, 'recall': 0.5218690843877652, 'f1-score': 0.4553594714422325, 'support': 10037}, '1': {'precision': 0.36482486433152445, 'recall': 0.2568823273990447, 'f1-score': 0.3014829536768078, 'support': 11515}, '2': {'precision': 0.4209052729818012, 'recall': 0.4404296875, 'f1-score': 0.4304461942257218, 'support': 10240}, 'accuracy': 0.39966029189733265, 'macro avg': {'precision': 0.39653877581968594, 'recall': 0.40639369976226997, 'f1-score': 0.3957628731149207, 'support': 31792}, 'weighted avg': {'precision': 0.39521999240701633, 'recall': 0.39966029189733265, 'f1-score': 0.391601291372846, 'support': 31792}}
[[5238 2449 2350]
 [4702 2958 3855]
 [3029 2701 4510]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0940444
{'0': {'precision': 0.38953815386538343, 'recall': 0.4719198955158903, 'f1-score': 0.42678991740488725, 'support': 105662}, '1': {'precision': 0.34952340717661656, 'recall': 0.24227643764413045, 'f1-score': 0.28618218374031196, 'support': 109276}, '2': {'precision': 0.38317440562256344, 'recall': 0.4268630849220104, 'f1-score': 0.40384058949480145, 'support': 98090}, 'accuracy': 0.377633949678623, 'macro avg': {'precision': 0.3740786555548545, 'recall': 0.380353139360677, 'f1-score': 0.3722708968800002, 'support': 313028}, 'weighted avg': {'precision': 0.3735751361024361, 'recall': 0.377633949678623, 'f1-score': 0.3705133214497956, 'support': 313028}}
[[49864 25831 29967]
 [45365 26475 37436]
 [32779 23440 41871]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091667
{'0': {'precision': 0.4092691047741797, 'recall': 0.4890585894885452, 'f1-score': 0.44562039527540637, 'support': 31166}, '1': {'precision': 0.3204188481675393, 'recall': 0.20194020985943378, 'f1-score': 0.24774318908634585, 'support': 30306}, '2': {'precision': 0.3980327868852459, 'recall': 0.46622140591083655, 'f1-score': 0.42943709627806825, 'support': 29945}, 'accuracy': 0.3863942155179015, 'macro avg': {'precision': 0.375906913275655, 'recall': 0.3857400684196051, 'f1-score': 0.37426689354660686, 'support': 91417}, 'weighted avg': {'precision': 0.37613339242412486, 'recall': 0.3863942155179015, 'f1-score': 0.374720283707088, 'support': 91417}}
[[15242  6685  9239]
 [12311  6120 11875]
 [ 9689  6295 13961]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908489
{'0': {'precision': 0.4268097175977309, 'recall': 0.40593478770818675, 'f1-score': 0.4161106101593026, 'support': 8526}, '1': {'precision': 0.3238758029978587, 'recall': 0.21252927400468383, 'f1-score': 0.25664592760181, 'support': 8540}, '2': {'precision': 0.38366250866250867, 'recall': 0.5407154193627152, 'f1-score': 0.44884722574106917, 'support': 8191}, 'accuracy': 0.3842499109157857, 'macro avg': {'precision': 0.37811600975269943, 'recall': 0.3863931603585286, 'f1-score': 0.3738679211673939, 'support': 25257}, 'weighted avg': {'precision': 0.3780123774911737, 'recall': 0.3842499109157857, 'f1-score': 0.3728084455787611, 'support': 25257}}
[[3461 1995 3070]
 [2680 1815 4045]
 [1968 1794 4429]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934429
{'0': {'precision': 0.3917925944857992, 'recall': 0.4073643475227956, 'f1-score': 0.39942676144645023, 'support': 120418}, '1': {'precision': 0.3384512945047198, 'recall': 0.27607469767887666, 'f1-score': 0.304097271711493, 'support': 125198}, '2': {'precision': 0.39895949356380506, 'recall': 0.45800624767330816, 'f1-score': 0.4264486474267199, 'support': 123566}, 'accuracy': 0.37979099739423916, 'macro avg': {'precision': 0.376401127518108, 'recall': 0.3804817642916602, 'f1-score': 0.37665756019488766, 'support': 369182}, 'weighted avg': {'precision': 0.3761021246807754, 'recall': 0.37979099739423916, 'f1-score': 0.3761426492936389, 'support': 369182}}
[[49054 34269 37095]
 [42469 34564 48165]
 [33681 33291 56594]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935367
{'0': {'precision': 0.40201027178345494, 'recall': 0.4376769858411327, 'f1-score': 0.41908613578133436, 'support': 41670}, '1': {'precision': 0.3217452897010908, 'recall': 0.2709357255332347, 'f1-score': 0.2941625976246292, 'support': 41914}, '2': {'precision': 0.3916540644793653, 'recall': 0.4184521718768294, 'f1-score': 0.4046098809038627, 'support': 42705}, 'accuracy': 0.3758363752979278, 'macro avg': {'precision': 0.371803208654637, 'recall': 0.37568829441706564, 'f1-score': 0.37261953810327547, 'support': 126289}, 'weighted avg': {'precision': 0.3718691803826096, 'recall': 0.3758363752979278, 'f1-score': 0.3727301297725564, 'support': 126289}}
[[18238 11945 11487]
 [14288 11356 16270]
 [12841 11994 17870]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884123
{'0': {'precision': 0.3988263574660634, 'recall': 0.44991226670920403, 'f1-score': 0.42283187167378755, 'support': 12538}, '1': {'precision': 0.34651706404862087, 'recall': 0.27833270747277505, 'f1-score': 0.3087047063723449, 'support': 13315}, '2': {'precision': 0.3894357201893456, 'recall': 0.42155347702318013, 'f1-score': 0.4048586158412748, 'support': 12295}, 'accuracy': 0.3808849743105798, 'macro avg': {'precision': 0.3782597139013433, 'recall': 0.3832661504017197, 'f1-score': 0.3787983979624691, 'support': 38148}, 'weighted avg': {'precision': 0.37754198797957667, 'recall': 0.3808849743105798, 'f1-score': 0.37720472512745606, 'support': 38148}}
[[5641 3474 3423]
 [4906 3706 4703]
 [3597 3515 5183]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/EXC
Evaluating performance on  test set...
5521/5521 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0193162
{'0': {'precision': 0.33616646535066674, 'recall': 0.6457728521681394, 'f1-score': 0.44216006683859954, 'support': 283146}, '1': {'precision': 0.6643002732776713, 'recall': 0.26207582571403043, 'f1-score': 0.3758668705524565, 'support': 839425}, '2': {'precision': 0.35158736499454685, 'recall': 0.6508733068715733, 'f1-score': 0.45655423166331505, 'support': 290734}, 'accuracy': 0.418927266230573, 'macro avg': {'precision': 0.45068470120762827, 'recall': 0.5195739949179145, 'f1-score': 0.4248603896847904, 'support': 1413305}, 'weighted avg': {'precision': 0.5342320644649341, 'recall': 0.418927266230573, 'f1-score': 0.4057466294161417, 'support': 1413305}}
[[182848  54629  45669]
 [316113 219993 303319]
 [ 44960  56543 189231]]
Evaluating performance on  train set...
1288/1288 - 16s - 16s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0305271
{'0': {'precision': 0.33472038641667073, 'recall': 0.5865431357410426, 'f1-score': 0.42621452021776174, 'support': 69942}, '1': {'precision': 0.628897300527941, 'recall': 0.2656945365022252, 'f1-score': 0.3735660663437003, 'support': 190098}, '2': {'precision': 0.3408091191448437, 'recall': 0.620379405349558, 'f1-score': 0.43993650212168395, 'support': 69688}, 'accuracy': 0.40871566867236025, 'macro avg': {'precision': 0.43480893536315185, 'recall': 0.4908723591976086, 'f1-score': 0.41323902956104863, 'support': 329728}, 'weighted avg': {'precision': 0.5056089813345581, 'recall': 0.40871566867236025, 'f1-score': 0.39876126083538965, 'support': 329728}}
[[41024 15738 13180]
 [69149 50508 70441]
 [12389 14066 43233]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0255662
{'0': {'precision': 0.32445046308611225, 'recall': 0.6048870655065146, 'f1-score': 0.4223565335096169, 'support': 22181}, '1': {'precision': 0.678104752597097, 'recall': 0.27492185550973686, 'f1-score': 0.3912289861125613, 'support': 68143}, '2': {'precision': 0.32702602057440766, 'recall': 0.6498473776708907, 'f1-score': 0.43509630271877126, 'support': 21622}, 'accuracy': 0.41271684562199634, 'macro avg': {'precision': 0.4431937454192056, 'recall': 0.5098854328957141, 'f1-score': 0.41622727411364985, 'support': 111946}, 'weighted avg': {'precision': 0.540221932849739, 'recall': 0.41271684562199634, 'f1-score': 0.40586943104559653, 'support': 111946}}
[[13417  4688  4076]
 [24570 18734 24839]
 [ 3366  4205 14051]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/AAL
Evaluating performance on  test set...
5918/5918 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0404668
{'0': {'precision': 0.2780548309331222, 'recall': 0.5808870703297643, 'f1-score': 0.3760870342785738, 'support': 280564}, '1': {'precision': 0.6827769645281738, 'recall': 0.268714025538932, 'f1-score': 0.3856510436755233, 'support': 958145}, '2': {'precision': 0.2773212803514406, 'recall': 0.5538375788109767, 'f1-score': 0.36958264901941845, 'support': 276294}, 'accuracy': 0.3785240029227665, 'macro avg': {'precision': 0.41271769193757885, 'recall': 0.467812891559891, 'f1-score': 0.37710690899117183, 'support': 1515003}, 'weighted avg': {'precision': 0.533882583795008, 'recall': 0.3785240029227665, 'f1-score': 0.3809494571007379, 'support': 1515003}}
[[162976  59934  57654]
 [359568 257467 341110]
 [ 63585  59687 153022]]
Evaluating performance on  train set...
1814/1814 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0487162
{'0': {'precision': 0.2881742166681981, 'recall': 0.49908761060069173, 'f1-score': 0.3653782674376609, 'support': 94258}, '1': {'precision': 0.6291651082574907, 'recall': 0.2752494400325799, 'f1-score': 0.38296010178812184, 'support': 275016}, '2': {'precision': 0.2968398103111495, 'recall': 0.564655852973064, 'f1-score': 0.3891193964891919, 'support': 95003}, 'accuracy': 0.37991328452626344, 'macro avg': {'precision': 0.40472637841227943, 'recall': 0.44633096786877857, 'f1-score': 0.37915258857165823, 'support': 464277}, 'weighted avg': {'precision': 0.49193449002695205, 'recall': 0.37991328452626344, 'f1-score': 0.3806509693785474, 'support': 464277}}
[[ 47043  23064  24151]
 [ 96396  75698 102922]
 [ 19806  21553  53644]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0404193
{'0': {'precision': 0.25402195269681344, 'recall': 0.6054151116118583, 'f1-score': 0.35788246802576673, 'support': 28402}, '1': {'precision': 0.7026245663432048, 'recall': 0.26246889233225335, 'f1-score': 0.38217457593513054, 'support': 106485}, '2': {'precision': 0.27785419532324623, 'recall': 0.5515556513616441, 'f1-score': 0.3695448089930915, 'support': 27834}, 'accuracy': 0.37177745957805075, 'macro avg': {'precision': 0.41150023812108816, 'recall': 0.4731465517685853, 'f1-score': 0.36986728431799626, 'support': 162721}, 'weighted avg': {'precision': 0.5516651330816446, 'recall': 0.37177745957805075, 'f1-score': 0.3757741642986087, 'support': 162721}}
[[17195  5821  5386]
 [44022 27949 34514]
 [ 6474  6008 15352]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/WBA
Evaluating performance on  test set...
3755/3755 - 47s - 47s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0773336
{'0': {'precision': 0.41045454397378217, 'recall': 0.40521652435396466, 'f1-score': 0.40781871558920346, 'support': 310935}, '1': {'precision': 0.3752106394723844, 'recall': 0.29046932240225143, 'f1-score': 0.3274461796889237, 'support': 355683}, '2': {'precision': 0.3934336221983481, 'recall': 0.5060365315407075, 'f1-score': 0.44268680787491144, 'support': 294540}, 'accuracy': 0.3936491190834389, 'macro avg': {'precision': 0.39303293521483823, 'recall': 0.4005741260989746, 'f1-score': 0.39265056771767953, 'support': 961158}, 'weighted avg': {'precision': 0.39219635959149846, 'recall': 0.3936491190834389, 'f1-score': 0.38876139433215023, 'support': 961158}}
[[125996  92158  92781]
 [115358 103315 137010]
 [ 65613  79879 149048]]
Evaluating performance on  train set...
1532/1532 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0844841
{'0': {'precision': 0.4183198165180999, 'recall': 0.40287223706582465, 'f1-score': 0.4104507333067825, 'support': 131744}, '1': {'precision': 0.33772123308217605, 'recall': 0.2956560694534557, 'f1-score': 0.3152917919360817, 'support': 129468}, '2': {'precision': 0.4161769447935929, 'recall': 0.48288105309775053, 'f1-score': 0.44705449892726995, 'support': 130966}, 'accuracy': 0.39419600283544715, 'macro avg': {'precision': 0.390739331464623, 'recall': 0.39380311987234357, 'f1-score': 0.39093234139004474, 'support': 392178}, 'weighted avg': {'precision': 0.39099655835840214, 'recall': 0.39419600283544715, 'f1-score': 0.3912599856026045, 'support': 392178}}
[[53076 38872 39796]
 [42270 38278 48920]
 [31533 36192 63241]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0809853
{'0': {'precision': 0.43095474066732736, 'recall': 0.39300060253062863, 'f1-score': 0.411103524344766, 'support': 39832}, '1': {'precision': 0.33880502783676747, 'recall': 0.2993407707910751, 'f1-score': 0.31785262364375527, 'support': 39440}, '2': {'precision': 0.419015618194263, 'recall': 0.5036523646879908, 'f1-score': 0.45745210814727594, 'support': 40111}, 'accuracy': 0.399236072137574, 'macro avg': {'precision': 0.396258462232786, 'recall': 0.3986645793365648, 'f1-score': 0.39546941871193236, 'support': 119383}, 'weighted avg': {'precision': 0.3965002972745967, 'recall': 0.399236072137574, 'f1-score': 0.3958691318538302, 'support': 119383}}
[[15654 12058 12120]
 [11743 11806 15891]
 [ 8927 10982 20202]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
4960/4960 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0773143
{'0': {'precision': 0.38604293714554083, 'recall': 0.41540028279878916, 'f1-score': 0.40018392138590175, 'support': 391798}, '1': {'precision': 0.39709879632676426, 'recall': 0.295444726523122, 'f1-score': 0.33881118344919353, 'support': 486074}, '2': {'precision': 0.3988064279385493, 'recall': 0.4951340341957565, 'f1-score': 0.4417802837942161, 'support': 391803}, 'accuracy': 0.3940819501053419, 'macro avg': {'precision': 0.3939827204702848, 'recall': 0.40199301450588926, 'f1-score': 0.39359179620977053, 'support': 1269675}, 'weighted avg': {'precision': 0.39421411455615935, 'recall': 0.3940819501053419, 'f1-score': 0.38952441195302895, 'support': 1269675}}
[[162753 112655 116390]
 [166412 143608 176054]
 [ 92428 105380 193995]]
Evaluating performance on  train set...
1691/1691 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830809
{'0': {'precision': 0.42196790746925145, 'recall': 0.4247501007795899, 'f1-score': 0.4233544331813554, 'support': 146359}, '1': {'precision': 0.3501268852431189, 'recall': 0.28732517969577087, 'f1-score': 0.3156324239955012, 'support': 143576}, '2': {'precision': 0.4176237670995981, 'recall': 0.49006339831777534, 'f1-score': 0.450952994204765, 'support': 142906}, 'accuracy': 0.4007291361030956, 'macro avg': {'precision': 0.3965728532706561, 'recall': 0.40071289293104534, 'f1-score': 0.39664661712720717, 'support': 432841}, 'weighted avg': {'precision': 0.39670354866127144, 'recall': 0.4007291361030956, 'f1-score': 0.3967342765204641, 'support': 432841}}
[[62166 40146 44047]
 [48709 41253 53614]
 [36449 36424 70033]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0887884
{'0': {'precision': 0.4332114787059039, 'recall': 0.4506064869386669, 'f1-score': 0.44173780146866964, 'support': 52598}, '1': {'precision': 0.3100248550124275, 'recall': 0.290902225578606, 'f1-score': 0.3001592812861677, 'support': 45022}, '2': {'precision': 0.43440141754955885, 'recall': 0.4397996748453647, 'f1-score': 0.4370838788756721, 'support': 53513}, 'accuracy': 0.3992046740288355, 'macro avg': {'precision': 0.3925459170892968, 'recall': 0.3937694624542125, 'f1-score': 0.39299365387683655, 'support': 151133}, 'weighted avg': {'precision': 0.39693594011018235, 'recall': 0.3992046740288355, 'f1-score': 0.3979141924926308, 'support': 151133}}
[[23701 14483 14414]
 [15696 13097 16229]
 [15313 14665 23535]]
testing model on single stock: results/universal/W8/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
10609/10609 - 129s - 129s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0831842
{'0': {'precision': 0.4244711313113811, 'recall': 0.4263430633726216, 'f1-score': 0.42540503806180613, 'support': 896365}, '1': {'precision': 0.34070344938212194, 'recall': 0.30776998897628843, 'f1-score': 0.3234004375752522, 'support': 897157}, '2': {'precision': 0.4199511604857681, 'recall': 0.457644322266864, 'f1-score': 0.437988271368221, 'support': 922155}, 'accuracy': 0.3977998856270462, 'macro avg': {'precision': 0.39504191372642367, 'recall': 0.39725245820525806, 'f1-score': 0.39559791566842645, 'support': 2715677}, 'weighted avg': {'precision': 0.3952626223785066, 'recall': 0.3977998856270462, 'f1-score': 0.3959794289598995, 'support': 2715677}}
[[382159 266424 247782]
 [285916 276118 335123]
 [232243 267893 422019]]
Evaluating performance on  train set...
3903/3903 - 47s - 47s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026416
{'0': {'precision': 0.3881880610177645, 'recall': 0.3725871468399837, 'f1-score': 0.3802276430622024, 'support': 337878}, '1': {'precision': 0.33137943887124366, 'recall': 0.32274889310170435, 'f1-score': 0.32700723043068214, 'support': 322297}, '2': {'precision': 0.38714737017125755, 'recall': 0.4122495108989132, 'f1-score': 0.3993043199899392, 'support': 338887}, 'accuracy': 0.36996302531774805, 'macro avg': {'precision': 0.36890495668675527, 'recall': 0.3691951836135337, 'f1-score': 0.3688463978276079, 'support': 999062}, 'weighted avg': {'precision': 0.369508614606173, 'recall': 0.36996302531774805, 'f1-score': 0.3695296668446192, 'support': 999062}}
[[125889 106967 105022]
 [102144 104021 116132]
 [ 96266 102915 139706]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991874
{'0': {'precision': 0.389062272783203, 'recall': 0.35568122552077475, 'f1-score': 0.37162364304641415, 'support': 97787}, '1': {'precision': 0.3438554695255112, 'recall': 0.33314436120672203, 'f1-score': 0.3384151828180355, 'support': 98780}, '2': {'precision': 0.37599620581588905, 'recall': 0.42087731351362606, 'f1-score': 0.39717287413003005, 'support': 96066}, 'accuracy': 0.36947644318993417, 'macro avg': {'precision': 0.3696379827082011, 'recall': 0.369900966747041, 'f1-score': 0.36907056666482657, 'support': 292633}, 'weighted avg': {'precision': 0.36951310090212064, 'recall': 0.36947644318993417, 'f1-score': 0.36880127076413366, 'support': 292633}}
[[34781 32580 30426]
 [29197 32908 36675]
 [25419 30215 40432]]
training model: results/universal/W8/deepOF_L1/h100
Epoch 1/50
7695/7695 - 158s - loss: 3.2278 - accuracy100: 0.4043 - val_loss: 3.2611 - val_accuracy100: 0.3774 - 158s/epoch - 21ms/step
Epoch 2/50
7695/7695 - 158s - loss: 3.2213 - accuracy100: 0.4064 - val_loss: 3.2598 - val_accuracy100: 0.3810 - 158s/epoch - 20ms/step
Epoch 3/50
7695/7695 - 156s - loss: 3.2138 - accuracy100: 0.4102 - val_loss: 3.2578 - val_accuracy100: 0.3812 - 156s/epoch - 20ms/step
Epoch 4/50
7695/7695 - 157s - loss: 3.2095 - accuracy100: 0.4118 - val_loss: 3.2596 - val_accuracy100: 0.3771 - 157s/epoch - 20ms/step
Epoch 5/50
7695/7695 - 157s - loss: 3.2057 - accuracy100: 0.4129 - val_loss: 3.2654 - val_accuracy100: 0.3751 - 157s/epoch - 20ms/step
Epoch 6/50
7695/7695 - 157s - loss: 3.2022 - accuracy100: 0.4142 - val_loss: 3.2606 - val_accuracy100: 0.3786 - 157s/epoch - 20ms/step
Epoch 7/50
7695/7695 - 156s - loss: 3.1987 - accuracy100: 0.4154 - val_loss: 3.2621 - val_accuracy100: 0.3786 - 156s/epoch - 20ms/step
Epoch 8/50
7695/7695 - 156s - loss: 3.1966 - accuracy100: 0.4163 - val_loss: 3.2621 - val_accuracy100: 0.3795 - 156s/epoch - 20ms/step
Epoch 9/50
7695/7695 - 157s - loss: 3.1940 - accuracy100: 0.4173 - val_loss: 3.2634 - val_accuracy100: 0.3835 - 157s/epoch - 20ms/step
Epoch 10/50
7695/7695 - 155s - loss: 3.1917 - accuracy100: 0.4180 - val_loss: 3.2621 - val_accuracy100: 0.3829 - 155s/epoch - 20ms/step
Epoch 11/50
7695/7695 - 157s - loss: 3.1899 - accuracy100: 0.4188 - val_loss: 3.2607 - val_accuracy100: 0.3841 - 157s/epoch - 20ms/step
Epoch 12/50
7695/7695 - 157s - loss: 3.1875 - accuracy100: 0.4197 - val_loss: 3.2621 - val_accuracy100: 0.3839 - 157s/epoch - 20ms/step
Epoch 13/50
7695/7695 - 156s - loss: 3.1853 - accuracy100: 0.4203 - val_loss: 3.2613 - val_accuracy100: 0.3823 - 156s/epoch - 20ms/step
testing model in sample: results/universal/W8/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 283s - 283s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.077304
{'0': {'precision': 0.41214426700161494, 'recall': 0.5525213243884763, 'f1-score': 0.47211903954137274, 'support': 1974617}, '1': {'precision': 0.37533318699237983, 'recall': 0.15969036683080617, 'f1-score': 0.22405403981297112, 'support': 2023685}, '2': {'precision': 0.4167676071698675, 'recall': 0.5208456360587596, 'f1-score': 0.4630301267878877, 'support': 1962641}, 'accuracy': 0.40872962549717384, 'macro avg': {'precision': 0.40141502038795407, 'recall': 0.4110191090926807, 'f1-score': 0.38640106871407714, 'support': 5960943}, 'weighted avg': {'precision': 0.40116948105292694, 'recall': 0.40872962549717384, 'f1-score': 0.38491074182894985, 'support': 5960943}}
[[1091018  263182  620417]
 [ 890407  323163  810115]
 [ 665750  274658 1022233]]
Evaluating performance on  train set...
7695/7695 - 98s - 98s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0891647
{'0': {'precision': 0.3784574743008097, 'recall': 0.5145677917267248, 'f1-score': 0.4361400157908565, 'support': 640351}, '1': {'precision': 0.36954913702007747, 'recall': 0.15222501124475848, 'f1-score': 0.21562824346682288, 'support': 689210}, '2': {'precision': 0.3830343874667298, 'recall': 0.48779199509929555, 'f1-score': 0.42911218997172856, 'support': 639908}, 'accuracy': 0.3790671495717881, 'macro avg': {'precision': 0.377013666262539, 'recall': 0.38486159935692626, 'f1-score': 0.3602934830764693, 'support': 1969469}, 'weighted avg': {'precision': 0.376827130392337, 'recall': 0.3790671495717881, 'f1-score': 0.35668911782408796, 'support': 1969469}}
[[329504  87796 223051]
 [304569 104915 279726]
 [236577  91189 312142]]
Evaluating performance on  val set...
2338/2338 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0867877
{'0': {'precision': 0.38037980866781396, 'recall': 0.5228979638219403, 'f1-score': 0.4403957088042599, 'support': 193598}, '1': {'precision': 0.3840398705871158, 'recall': 0.15115990542849786, 'f1-score': 0.21693368764424678, 'support': 213595}, '2': {'precision': 0.38146728439692534, 'recall': 0.4955295771987449, 'f1-score': 0.4310809546306249, 'support': 190586}, 'accuracy': 0.3813449452055024, 'macro avg': {'precision': 0.3819623212172851, 'recall': 0.3898624821497277, 'f1-score': 0.36280345035971057, 'support': 597779}, 'weighted avg': {'precision': 0.38203431405351956, 'recall': 0.3813449452055024, 'f1-score': 0.35757976487078386, 'support': 597779}}
[[101232  25637  66729]
 [ 94905  32287  86403]
 [ 69997  26148  94441]]
testing model out of sample: results/universal/W8/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 172s - 172s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0799823
{'0': {'precision': 0.36583496706518237, 'recall': 0.5141848417669218, 'f1-score': 0.4275058192220899, 'support': 1052814}, '1': {'precision': 0.4607748901657625, 'recall': 0.18640120190460543, 'f1-score': 0.2654269661278585, 'support': 1509604}, '2': {'precision': 0.3573895188304126, 'recall': 0.5174569826507208, 'f1-score': 0.42277977160994906, 'support': 1053819}, 'accuracy': 0.3783045746172057, 'macro avg': {'precision': 0.39466645868711914, 'recall': 0.40601434210741605, 'f1-score': 0.3719041856532992, 'support': 3616237}, 'weighted avg': {'precision': 0.40300667728744133, 'recall': 0.3783045746172057, 'f1-score': 0.35846850675749126, 'support': 3616237}}
[[541341 161147 350326]
 [598041 281392 630171]
 [340359 168154 545306]]
Evaluating performance on  train set...
4550/4550 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0841224
{'0': {'precision': 0.37355972323752307, 'recall': 0.5082011053663754, 'f1-score': 0.4306008117195401, 'support': 358976}, '1': {'precision': 0.42588728719105395, 'recall': 0.17961153152992598, 'f1-score': 0.25266529197560655, 'support': 448891}, '2': {'precision': 0.37240399696589094, 'recall': 0.5084906084047199, 'f1-score': 0.4299355083684863, 'support': 356276}, 'accuracy': 0.38158628278484685, 'macro avg': {'precision': 0.3906170024648226, 'recall': 0.39876774843367374, 'f1-score': 0.371067204021211, 'support': 1164143}, 'weighted avg': {'precision': 0.39338341755816275, 'recall': 0.38158628278484685, 'f1-score': 0.36178565326385714, 'support': 1164143}}
[[182432  53769 122775]
 [185734  80626 182531]
 [120195  54918 181163]]
Evaluating performance on  val set...
1570/1570 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.082426
{'0': {'precision': 0.3696350162272861, 'recall': 0.529787816223477, 'f1-score': 0.4354528726231854, 'support': 120603}, '1': {'precision': 0.4345426934700567, 'recall': 0.18127704948880385, 'f1-score': 0.25583011343769774, 'support': 159430}, '2': {'precision': 0.37119810964784766, 'recall': 0.49595854408410195, 'f1-score': 0.4246034975005218, 'support': 120996}, 'accuracy': 0.38102980083734594, 'macro avg': {'precision': 0.39179193978173016, 'recall': 0.4023411365987943, 'f1-score': 0.37196216118713493, 'support': 401029}, 'weighted avg': {'precision': 0.3959108193096796, 'recall': 0.38102980083734594, 'f1-score': 0.3607700255241374, 'support': 401029}}
[[63894 18401 38308]
 [67183 28901 63346]
 [41780 19207 60009]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0962218
{'0': {'precision': 0.3874894128575722, 'recall': 0.5024711696869851, 'f1-score': 0.43755254409847827, 'support': 56451}, '1': {'precision': 0.319458079717259, 'recall': 0.12198230619283251, 'f1-score': 0.17655037708208998, 'support': 53352}, '2': {'precision': 0.35757235966080314, 'recall': 0.4628601495028667, 'f1-score': 0.4034603553664767, 'support': 55116}, 'accuracy': 0.3661433794771979, 'macro avg': {'precision': 0.3548399507452114, 'recall': 0.3624378751275614, 'f1-score': 0.3391877588490149, 'support': 164919}, 'weighted avg': {'precision': 0.3554826944703935, 'recall': 0.3661433794771979, 'f1-score': 0.34172360571774985, 'support': 164919}}
[[28365  6756 21330]
 [22340  6508 24504]
 [22497  7108 25511]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017644
{'0': {'precision': 0.3492162549098785, 'recall': 0.4978282484693077, 'f1-score': 0.4104854368932039, 'support': 19109}, '1': {'precision': 0.29956060997673817, 'recall': 0.12265199216889783, 'f1-score': 0.17404362353117842, 'support': 18899}, '2': {'precision': 0.3813303269447576, 'recall': 0.44165883213203805, 'f1-score': 0.40928341521260375, 'support': 19146}, 'accuracy': 0.35495328410959864, 'macro avg': {'precision': 0.3433690639437914, 'recall': 0.3540463575900812, 'f1-score': 0.33127082521232865, 'support': 57154}, 'weighted avg': {'precision': 0.34355460374965135, 'recall': 0.35495328410959864, 'f1-score': 0.3318990258314114, 'support': 57154}}
[[9513 2721 6875]
 [9737 2318 6844]
 [7991 2699 8456]]
Evaluating performance on  val set...
68/68 - 1s - 990ms/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964211
{'0': {'precision': 0.3849649920157229, 'recall': 0.5171617161716172, 'f1-score': 0.4413773677910006, 'support': 6060}, '1': {'precision': 0.3090828924162258, 'recall': 0.13066169617893755, 'f1-score': 0.18367614306301586, 'support': 5365}, '2': {'precision': 0.37635511280398476, 'recall': 0.44216867469879517, 'f1-score': 0.4066160177271288, 'support': 5810}, 'accuracy': 0.3715694807078619, 'macro avg': {'precision': 0.3568009990786445, 'recall': 0.36333069568311666, 'f1-score': 0.34388984286038177, 'support': 17235}, 'weighted avg': {'precision': 0.3584415883272111, 'recall': 0.3715694807078619, 'f1-score': 0.34944058133688205, 'support': 17235}}
[[3134  818 2108]
 [2515  701 2149]
 [2492  749 2569]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0705956
{'0': {'precision': 0.36705117386456104, 'recall': 0.6124356500367714, 'f1-score': 0.45900612193461615, 'support': 159091}, '1': {'precision': 0.46988897748880576, 'recall': 0.15497813077835007, 'f1-score': 0.23308160868480463, 'support': 247151}, '2': {'precision': 0.3874921731210747, 'recall': 0.5390772966944494, 'f1-score': 0.4508852060881205, 'support': 151533}, 'accuracy': 0.3898059253283134, 'macro avg': {'precision': 0.40814410815814717, 'recall': 0.4354970258365236, 'f1-score': 0.3809909789025137, 'support': 557775}, 'weighted avg': {'precision': 0.4181720594257156, 'recall': 0.3898059253283134, 'f1-score': 0.35669236438870394, 'support': 557775}}
[[ 97433  21150  40508]
 [120232  38303  88616]
 [ 47783  22062  81688]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0784141
{'0': {'precision': 0.37060588031136893, 'recall': 0.6154970459270849, 'f1-score': 0.46264303343055874, 'support': 48577}, '1': {'precision': 0.4221393614542065, 'recall': 0.14817420325894903, 'f1-score': 0.2193535886847746, 'support': 61124}, '2': {'precision': 0.4076210579950139, 'recall': 0.47274338897916973, 'f1-score': 0.4377736085053158, 'support': 47383}, 'accuracy': 0.3905935677726567, 'macro avg': {'precision': 0.40012209992019643, 'recall': 0.41213821272173456, 'f1-score': 0.3732567435402164, 'support': 157084}, 'weighted avg': {'precision': 0.40182371704559366, 'recall': 0.3905935677726567, 'f1-score': 0.3604734172896781, 'support': 157084}}
[[29899  5715 12963]
 [32477  9057 19590]
 [18300  6683 22400]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0689896
{'0': {'precision': 0.3694643794853842, 'recall': 0.6138577868256507, 'f1-score': 0.46129049882532913, 'support': 13754}, '1': {'precision': 0.4777388694347174, 'recall': 0.1791660803902256, 'f1-score': 0.26059965207899854, 'support': 21321}, '2': {'precision': 0.39080849141824753, 'recall': 0.5133110863922877, 'f1-score': 0.4437606180081418, 'support': 13485}, 'accuracy': 0.39507825370675453, 'macro avg': {'precision': 0.412670580112783, 'recall': 0.4354449845360547, 'f1-score': 0.3885502563041565, 'support': 48560}, 'weighted avg': {'precision': 0.4229311370970892, 'recall': 0.39507825370675453, 'f1-score': 0.3683061498488405, 'support': 48560}}
[[ 8443  1938  3373]
 [10084  3820  7417]
 [ 4325  2238  6922]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0647373
{'0': {'precision': 0.28915028685881117, 'recall': 0.5230112676921188, 'f1-score': 0.37241077772312403, 'support': 65142}, '1': {'precision': 0.6420354456749843, 'recall': 0.25591803588982714, 'f1-score': 0.3659620539417276, 'support': 163779}, '2': {'precision': 0.2877469457003682, 'recall': 0.4800764550534748, 'f1-score': 0.35982371339209557, 'support': 68537}, 'accuracy': 0.36605840152223174, 'macro avg': {'precision': 0.4063108927447212, 'recall': 0.41966858621180697, 'f1-score': 0.36606551501898243, 'support': 297458}, 'weighted avg': {'precision': 0.48312388189669153, 'recall': 0.36605840152223174, 'f1-score': 0.3659599673221631, 'support': 297458}}
[[34070 11109 19963]
 [60384 41914 61481]
 [23374 12260 32903]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912235
{'0': {'precision': 0.39560106640814346, 'recall': 0.4630824881197248, 'f1-score': 0.4266901937718524, 'support': 28198}, '1': {'precision': 0.3356108568921206, 'recall': 0.19440107476126503, 'f1-score': 0.24619487745436153, 'support': 27541}, '2': {'precision': 0.3842754397619942, 'recall': 0.47782207377078617, 'f1-score': 0.4259733606557377, 'support': 27843}, 'accuracy': 0.3794596922782417, 'macro avg': {'precision': 0.3718291210207528, 'recall': 0.3784352122172587, 'f1-score': 0.36628614396065057, 'support': 83582}, 'weighted avg': {'precision': 0.3720609527115399, 'recall': 0.3794596922782417, 'f1-score': 0.3669766155953073, 'support': 83582}}
[[13058  5307  9833]
 [10703  5354 11484]
 [ 9247  5292 13304]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.084644
{'0': {'precision': 0.36041313396022817, 'recall': 0.49215872013472267, 'f1-score': 0.41610678531701895, 'support': 9501}, '1': {'precision': 0.4080153800650695, 'recall': 0.21702194603948713, 'f1-score': 0.28333761232349164, 'support': 12713}, '2': {'precision': 0.3668712674187127, 'recall': 0.46178742952599705, 'f1-score': 0.4088934085236202, 'support': 9578}, 'accuracy': 0.3729869149471565, 'macro avg': {'precision': 0.37843326048133674, 'recall': 0.3903226985667356, 'f1-score': 0.36944593538804354, 'support': 31792}, 'weighted avg': {'precision': 0.3813939894268932, 'recall': 0.3729869149471565, 'f1-score': 0.3608418061023145, 'support': 31792}}
[[4676 1924 2901]
 [5222 2759 4732]
 [3076 2079 4423]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0937328
{'0': {'precision': 0.3724836162571019, 'recall': 0.5188852041800023, 'f1-score': 0.4336616512578806, 'support': 103732}, '1': {'precision': 0.362749289924564, 'recall': 0.21001308437654714, 'f1-score': 0.2660164167571865, 'support': 113112}, '2': {'precision': 0.3694232280980988, 'recall': 0.395751892206604, 'f1-score': 0.38213459289339086, 'support': 96184}, 'accuracy': 0.36943979452317366, 'macro avg': {'precision': 0.36821871142658824, 'recall': 0.3748833935877178, 'f1-score': 0.3606042203028193, 'support': 313028}, 'weighted avg': {'precision': 0.36802577384424556, 'recall': 0.36943979452317366, 'f1-score': 0.3572507028872154, 'support': 313028}}
[[53825 21426 28481]
 [52864 23755 36493]
 [37814 20305 38065]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092594
{'0': {'precision': 0.39366407332409675, 'recall': 0.47872857466869717, 'f1-score': 0.4320491263981285, 'support': 30863}, '1': {'precision': 0.33539094650205764, 'recall': 0.19966892898526734, 'f1-score': 0.2503164753979289, 'support': 30205}, '2': {'precision': 0.3845082583628109, 'recall': 0.4548749546937296, 'f1-score': 0.41674213608645777, 'support': 30349}, 'accuracy': 0.37860572978767626, 'macro avg': {'precision': 0.37118775939632176, 'recall': 0.37775748611589804, 'f1-score': 0.36636924596083836, 'support': 91417}, 'weighted avg': {'precision': 0.3713705215348261, 'recall': 0.37860572978767626, 'f1-score': 0.36692134302709334, 'support': 91417}}
[[14775  5906 10182]
 [12258  6031 11916]
 [10499  6045 13805]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.094532
{'0': {'precision': 0.401673640167364, 'recall': 0.4069233486400565, 'f1-score': 0.4042814528864713, 'support': 8493}, '1': {'precision': 0.34986595174262736, 'recall': 0.2108969179268152, 'f1-score': 0.26316168527187617, 'support': 8663}, '2': {'precision': 0.35779896771935965, 'recall': 0.504875941241822, 'f1-score': 0.41879991808314565, 'support': 8101}, 'accuracy': 0.3711050401868789, 'macro avg': {'precision': 0.36977951987645036, 'recall': 0.3742320692695646, 'f1-score': 0.36208101874716436, 'support': 25257}, 'weighted avg': {'precision': 0.3698314290447138, 'recall': 0.3711050401868789, 'f1-score': 0.36053490894669304, 'support': 25257}}
[[3456 1737 3300]
 [2795 1827 4041]
 [2353 1658 4090]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944009
{'0': {'precision': 0.3677807901945833, 'recall': 0.4419922786474906, 'f1-score': 0.4014859860264903, 'support': 117855}, '1': {'precision': 0.3694701694701695, 'recall': 0.2247472618436281, 'f1-score': 0.27948493108904093, 'support': 130471}, '2': {'precision': 0.3741370351124638, 'recall': 0.45872774210630834, 'f1-score': 0.41213662061352163, 'support': 120856}, 'accuracy': 0.37069521265933875, 'macro avg': {'precision': 0.3704626649257388, 'recall': 0.375155760865809, 'f1-score': 0.36436917924301765, 'support': 369182}, 'weighted avg': {'precision': 0.37045861668466235, 'recall': 0.37069521265933875, 'f1-score': 0.3618567339364814, 'support': 369182}}
[[52091 24895 40869]
 [49276 29323 51872]
 [40269 25147 55440]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0917047
{'0': {'precision': 0.3757337097852738, 'recall': 0.48577123508080977, 'f1-score': 0.42372508562271544, 'support': 41641}, '1': {'precision': 0.3780420353982301, 'recall': 0.19726304143918805, 'f1-score': 0.25924930857368633, 'support': 41579}, '2': {'precision': 0.3910790629863861, 'recall': 0.46088834196289674, 'f1-score': 0.4231236544241468, 'support': 43069}, 'accuracy': 0.3822977456468893, 'macro avg': {'precision': 0.3816182693899633, 'recall': 0.3813075394942982, 'f1-score': 0.36869934954018285, 'support': 126289}, 'weighted avg': {'precision': 0.3817270020568082, 'recall': 0.3822977456468893, 'f1-score': 0.3693684799467442, 'support': 126289}}
[[20228  6535 14878]
 [17348  8202 16029]
 [16260  6959 19850]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933484
{'0': {'precision': 0.3728945167841357, 'recall': 0.49987989430699015, 'f1-score': 0.4271492593479525, 'support': 12489}, '1': {'precision': 0.34664586583463336, 'recall': 0.1693468485633717, 'f1-score': 0.22753571245711943, 'support': 13121}, '2': {'precision': 0.37883435582822084, 'recall': 0.45310256819269423, 'f1-score': 0.4126534466477809, 'support': 12538}, 'accuracy': 0.37081891580161475, 'macro avg': {'precision': 0.36612491281566334, 'recall': 0.37410977035435206, 'f1-score': 0.35577947281761757, 'support': 38148}, 'weighted avg': {'precision': 0.36581852729127423, 'recall': 0.37081891580161475, 'f1-score': 0.35372790440432844, 'support': 38148}}
[[6243 2053 4193]
 [5777 2222 5122]
 [4722 2135 5681]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/EXC
Evaluating performance on  test set...
5521/5521 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0507634
{'0': {'precision': 0.4243616340120374, 'recall': 0.6108686034508185, 'f1-score': 0.5008145808460155, 'support': 406860}, '1': {'precision': 0.4835524759967838, 'recall': 0.20560996701793902, 'f1-score': 0.2885334499837724, 'support': 596688}, '2': {'precision': 0.43662987834414213, 'recall': 0.6115527007470282, 'f1-score': 0.509495552883027, 'support': 409757}, 'accuracy': 0.4399694333494893, 'macro avg': {'precision': 0.44818132945098776, 'recall': 0.4760104237385952, 'f1-score': 0.4329478612376049, 'support': 1413305}, 'weighted avg': {'precision': 0.4529085252456951, 'recall': 0.4399694333494893, 'f1-score': 0.4137077536905463, 'support': 1413305}}
[[248538  61892  96430]
 [247107 122685 226896]
 [ 90030  69139 250588]]
Evaluating performance on  train set...
1288/1288 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0623808
{'0': {'precision': 0.4012187079222885, 'recall': 0.6049428751955087, 'f1-score': 0.48245610411925305, 'support': 96543}, '1': {'precision': 0.46230034026137273, 'recall': 0.15477771247378772, 'f1-score': 0.2319116320029572, 'support': 137817}, '2': {'precision': 0.41061272396629545, 'recall': 0.5942664206022985, 'f1-score': 0.4856571161698609, 'support': 95368}, 'accuracy': 0.4136985636645963, 'macro avg': {'precision': 0.4247105907166522, 'recall': 0.45132900275719834, 'f1-score': 0.40000828409735706, 'support': 329728}, 'weighted avg': {'precision': 0.4294661599013756, 'recall': 0.4136985636645963, 'f1-score': 0.378661420633443, 'support': 329728}}
[[58403 12269 25871]
 [61008 21331 55478]
 [26153 12541 56674]]
Evaluating performance on  val set...
438/438 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.062424
{'0': {'precision': 0.3921220651530914, 'recall': 0.6043828208514117, 'f1-score': 0.47564611711143273, 'support': 31806}, '1': {'precision': 0.48054718875502006, 'recall': 0.15560612833746496, 'f1-score': 0.235088257866462, 'support': 49214}, '2': {'precision': 0.39832294038776683, 'recall': 0.6051865744034146, 'f1-score': 0.4804333038132276, 'support': 30926}, 'accuracy': 0.4073124542189984, 'macro avg': {'precision': 0.4236640647652927, 'recall': 0.45505850786409713, 'f1-score': 0.3970558929303741, 'support': 111946}, 'weighted avg': {'precision': 0.4327087971529207, 'recall': 0.4073124542189984, 'f1-score': 0.3712139270470956, 'support': 111946}}
[[19223  4213  8370]
 [21655  7658 19901]
 [ 8145  4065 18716]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/AAL
Evaluating performance on  test set...
5918/5918 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0706366
{'0': {'precision': 0.35041727739703415, 'recall': 0.5513227705596228, 'f1-score': 0.4284893959501259, 'support': 385063}, '1': {'precision': 0.5449921450985009, 'recall': 0.17909502020997026, 'f1-score': 0.2695956617297859, 'support': 749630}, '2': {'precision': 0.330218397532995, 'recall': 0.5755252294181062, 'f1-score': 0.41965300851852777, 'support': 380310}, 'accuracy': 0.37321840286784913, 'macro avg': {'precision': 0.40854260667617676, 'recall': 0.43531434006256636, 'f1-score': 0.37257935539947984, 'support': 1515003}, 'weighted avg': {'precision': 0.4416232499752784, 'recall': 0.37321840286784913, 'f1-score': 0.34764990158100284, 'support': 1515003}}
[[212294  54862 117907]
 [289332 134255 326043]
 [104206  57226 218878]]
Evaluating performance on  train set...
1814/1814 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0746527
{'0': {'precision': 0.34664521916664087, 'recall': 0.5474174428450466, 'f1-score': 0.4244884559292393, 'support': 122824}, '1': {'precision': 0.5393002571795971, 'recall': 0.18536747068383663, 'f1-score': 0.2759022397955163, 'support': 217201}, '2': {'precision': 0.34745143336110274, 'recall': 0.547130026076039, 'f1-score': 0.4250057047116229, 'support': 124252}, 'accuracy': 0.3779640171707838, 'macro avg': {'precision': 0.41113230323578026, 'recall': 0.4266383132016407, 'f1-score': 0.3751321334787929, 'support': 464277}, 'weighted avg': {'precision': 0.4369900793202612, 'recall': 0.3779640171707838, 'f1-score': 0.3551143419094795, 'support': 464277}}
[[67236 16496 39092]
 [88354 40262 88585]
 [38372 17898 67982]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0717187
{'0': {'precision': 0.3267743146826887, 'recall': 0.5546773412202647, 'f1-score': 0.4112631857537147, 'support': 39221}, '1': {'precision': 0.5656007685445688, 'recall': 0.1941718983733613, 'f1-score': 0.2890964093121136, 'support': 84899}, '2': {'precision': 0.32038805970149253, 'recall': 0.5560995829123598, 'f1-score': 0.4065491804054886, 'support': 38601}, 'accuracy': 0.3669225238291308, 'macro avg': {'precision': 0.40425438097625, 'recall': 0.43498294083532857, 'f1-score': 0.3689695918237723, 'support': 162721}, 'weighted avg': {'precision': 0.4498660562396518, 'recall': 0.3669225238291308, 'f1-score': 0.3464049162398697, 'support': 162721}}
[[21755  6236 11230]
 [34110 16485 34304]
 [10710  6425 21466]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/WBA
Evaluating performance on  test set...
3755/3755 - 47s - 47s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886781
{'0': {'precision': 0.3870526805663508, 'recall': 0.502330567431506, 'f1-score': 0.4372207214212088, 'support': 316232}, '1': {'precision': 0.36960482013113594, 'recall': 0.1506915825188285, 'f1-score': 0.21409463901144135, 'support': 346018}, '2': {'precision': 0.36715519471960084, 'recall': 0.5032016540206351, 'f1-score': 0.4245456367295441, 'support': 298908}, 'accuracy': 0.3760110200404096, 'macro avg': {'precision': 0.37460423180569585, 'recall': 0.38540793465698986, 'f1-score': 0.35862033238739804, 'support': 961158}, 'weighted avg': {'precision': 0.374583563655757, 'recall': 0.3760110200404096, 'f1-score': 0.3529532804819678, 'support': 961158}}
[[158853  45280 112099]
 [146720  52142 147156]
 [104844  43653 150411]]
Evaluating performance on  train set...
1532/1532 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897448
{'0': {'precision': 0.38816379165775156, 'recall': 0.514490254240536, 'f1-score': 0.44248732671048213, 'support': 130467}, '1': {'precision': 0.34533997761167085, 'recall': 0.14643800482333577, 'f1-score': 0.20566556093784444, 'support': 130615}, '2': {'precision': 0.3873249321087481, 'recall': 0.48414139256727895, 'f1-score': 0.43035519950095097, 'support': 131096}, 'accuracy': 0.38176542284370873, 'macro avg': {'precision': 0.37360956712605686, 'recall': 0.3816898838770502, 'f1-score': 0.35950269571642585, 'support': 392178}, 'weighted avg': {'precision': 0.37362089633199386, 'recall': 0.38176542284370873, 'f1-score': 0.3595582784592958, 'support': 392178}}
[[67124 17582 45761]
 [56853 19127 54635]
 [48950 18677 63469]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0874633
{'0': {'precision': 0.3796097452606635, 'recall': 0.5324867559987535, 'f1-score': 0.44323634948770047, 'support': 38508}, '1': {'precision': 0.36049601417183347, 'recall': 0.13681986265187532, 'f1-score': 0.1983568892292696, 'support': 41646}, '2': {'precision': 0.38903573374225703, 'recall': 0.49149863621300566, 'f1-score': 0.4343056650523708, 'support': 39229}, 'accuracy': 0.38099226858095375, 'macro avg': {'precision': 0.37638049772491794, 'recall': 0.3869350849545448, 'f1-score': 0.35863296792311355, 'support': 119383}, 'weighted avg': {'precision': 0.3760394015535947, 'recall': 0.38099226858095375, 'f1-score': 0.35487710385275945, 'support': 119383}}
[[20505  4971 13032]
 [18700  5698 17248]
 [14811  5137 19281]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
4960/4960 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0884427
{'0': {'precision': 0.39595329790143624, 'recall': 0.5002603297198479, 'f1-score': 0.4420368565195191, 'support': 428303}, '1': {'precision': 0.34796999117387467, 'recall': 0.16826554664235205, 'f1-score': 0.22683971362254407, 'support': 412372}, '2': {'precision': 0.40225084335755523, 'recall': 0.49614219114219116, 'f1-score': 0.44429020962599214, 'support': 429000}, 'accuracy': 0.39104180203595407, 'macro avg': {'precision': 0.38205804414428873, 'recall': 0.3882226891681304, 'f1-score': 0.37105559325601845, 'support': 1269675}, 'weighted avg': {'precision': 0.38249684238236015, 'recall': 0.39104180203595407, 'f1-score': 0.3729053167727064, 'support': 1269675}}
[[214263  63835 150205]
 [176899  69388 166085]
 [149970  66185 212845]]
Evaluating performance on  train set...
1691/1691 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0884866
{'0': {'precision': 0.4018636510213386, 'recall': 0.49101926578082117, 'f1-score': 0.4419903016516544, 'support': 147204}, '1': {'precision': 0.3506761698527197, 'recall': 0.17020136283592374, 'f1-score': 0.22917310990524922, 'support': 143671}, '2': {'precision': 0.3894831048633546, 'recall': 0.5027400926982517, 'f1-score': 0.438923293585147, 'support': 141966}, 'accuracy': 0.38837587012320923, 'macro avg': {'precision': 0.3806743085791376, 'recall': 0.38798690710499883, 'f1-score': 0.37002890171401687, 'support': 432841}, 'weighted avg': {'precision': 0.38081256477294484, 'recall': 0.38837587012320923, 'f1-score': 0.3703448946255927, 'support': 432841}}
[[72280 22830 52094]
 [59436 24453 59782]
 [48146 22448 71372]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0888088
{'0': {'precision': 0.41018856892267214, 'recall': 0.5261569039225981, 'f1-score': 0.4609912766341936, 'support': 53332}, '1': {'precision': 0.3061427730750079, 'recall': 0.15607403304717068, 'f1-score': 0.20674686272411844, 'support': 43332}, '2': {'precision': 0.42617759598891675, 'recall': 0.4743982815913639, 'f1-score': 0.4489969678803833, 'support': 54469}, 'accuracy': 0.40139479795941324, 'macro avg': {'precision': 0.3808363126621989, 'recall': 0.38554307285371087, 'f1-score': 0.37224503574623174, 'support': 151133}, 'weighted avg': {'precision': 0.3861196619969861, 'recall': 0.40139479795941324, 'f1-score': 0.3837729527270213, 'support': 151133}}
[[28061  7485 17786]
 [19563  6763 17006]
 [20786  7843 25840]]
testing model on single stock: results/universal/W8/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
10609/10609 - 145s - 145s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865933
{'0': {'precision': 0.4288040754296139, 'recall': 0.5382258759464429, 'f1-score': 0.477324303717989, 'support': 988702}, '1': {'precision': 0.2723583228003927, 'recall': 0.12048990170885619, 'f1-score': 0.1670692419944265, 'support': 720716}, '2': {'precision': 0.43405736790103805, 'recall': 0.49857939158805037, 'f1-score': 0.4640864864064841, 'support': 1006259}, 'accuracy': 0.41267205194137596, 'macro avg': {'precision': 0.3784065887103482, 'recall': 0.38576505641444986, 'f1-score': 0.36949334403963324, 'support': 2715677}, 'weighted avg': {'precision': 0.3892313338175153, 'recall': 0.41267205194137596, 'f1-score': 0.3900803274000334, 'support': 2715677}}
[[532145 112971 343586]
 [323325  86839 310552]
 [385528 119031 501700]]
Evaluating performance on  train set...
3903/3903 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991362
{'0': {'precision': 0.36724064821813757, 'recall': 0.4772552343359259, 'f1-score': 0.41508200393577216, 'support': 333901}, '1': {'precision': 0.3451545901490304, 'recall': 0.1498077092357239, 'f1-score': 0.20893235119803574, 'support': 329449}, '2': {'precision': 0.3691095197598918, 'recall': 0.4641389047755219, 'f1-score': 0.41120530972283614, 'support': 335712}, 'accuracy': 0.36486924735401804, 'macro avg': {'precision': 0.3605015860423532, 'recall': 0.36373394944905724, 'f1-score': 0.3450732216188814, 'support': 999062}, 'weighted avg': {'precision': 0.3605855786210716, 'recall': 0.36486924735401804, 'f1-score': 0.34579976748557417, 'support': 999062}}
[[159356  46345 128200]
 [141969  49354 138126]
 [132603  47292 155817]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0982819
{'0': {'precision': 0.37690924057193376, 'recall': 0.4894444609400517, 'f1-score': 0.42586795613177686, 'support': 101037}, '1': {'precision': 0.33851533217618796, 'recall': 0.14508738450259295, 'f1-score': 0.2031183964257683, 'support': 92751}, '2': {'precision': 0.3734918965120484, 'recall': 0.45976023066417115, 'f1-score': 0.4121602931240108, 'support': 98845}, 'accuracy': 0.370272662344985, 'macro avg': {'precision': 0.3629721564200567, 'recall': 0.3647640253689386, 'f1-score': 0.347048881893852, 'support': 292633}, 'weighted avg': {'precision': 0.36358586019031863, 'recall': 0.370272662344985, 'f1-score': 0.3506365968445651, 'support': 292633}}
[[49452 13154 38431]
 [41494 13457 37800]
 [40258 13142 45445]]
training model: results/universal/W8/deepOF_L1/h200
Epoch 1/50
7695/7695 - 165s - loss: 3.2500 - accuracy200: 0.3908 - val_loss: 3.2853 - val_accuracy200: 0.3722 - 165s/epoch - 22ms/step
Epoch 2/50
7695/7695 - 163s - loss: 3.2523 - accuracy200: 0.3896 - val_loss: 3.2916 - val_accuracy200: 0.3732 - 163s/epoch - 21ms/step
Epoch 3/50
7695/7695 - 162s - loss: 3.2494 - accuracy200: 0.3915 - val_loss: 3.2949 - val_accuracy200: 0.3733 - 162s/epoch - 21ms/step
Epoch 4/50
7695/7695 - 160s - loss: 3.2478 - accuracy200: 0.3924 - val_loss: 3.2966 - val_accuracy200: 0.3744 - 160s/epoch - 21ms/step
Epoch 5/50
7695/7695 - 162s - loss: 3.2448 - accuracy200: 0.3941 - val_loss: 3.2971 - val_accuracy200: 0.3742 - 162s/epoch - 21ms/step
Epoch 6/50
7695/7695 - 161s - loss: 3.2428 - accuracy200: 0.3953 - val_loss: 3.2940 - val_accuracy200: 0.3747 - 161s/epoch - 21ms/step
Epoch 7/50
7695/7695 - 154s - loss: 3.2402 - accuracy200: 0.3968 - val_loss: 3.2876 - val_accuracy200: 0.3750 - 154s/epoch - 20ms/step
Epoch 8/50
7695/7695 - 158s - loss: 3.2380 - accuracy200: 0.3980 - val_loss: 3.2902 - val_accuracy200: 0.3747 - 158s/epoch - 21ms/step
Epoch 9/50
7695/7695 - 163s - loss: 3.2366 - accuracy200: 0.3987 - val_loss: 3.2868 - val_accuracy200: 0.3749 - 163s/epoch - 21ms/step
Epoch 10/50
7695/7695 - 161s - loss: 3.2351 - accuracy200: 0.3999 - val_loss: 3.2890 - val_accuracy200: 0.3748 - 161s/epoch - 21ms/step
Epoch 11/50
7695/7695 - 163s - loss: 3.2332 - accuracy200: 0.4008 - val_loss: 3.2884 - val_accuracy200: 0.3746 - 163s/epoch - 21ms/step
testing model in sample: results/universal/W8/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 291s - 291s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0878248
{'0': {'precision': 0.4019447897155005, 'recall': 0.5591042649851448, 'f1-score': 0.46767445453342393, 'support': 2076373}, '1': {'precision': 0.3406998158379374, 'recall': 0.00020045313243234166, 'f1-score': 0.00040067052754230866, 'support': 1845818}, '2': {'precision': 0.39159963107499707, 'recall': 0.5899923090204203, 'f1-score': 0.4707470815765328, 'support': 2038752}, 'accuracy': 0.3966028529378657, 'macro avg': {'precision': 0.3780814122094783, 'recall': 0.38309900904599914, 'f1-score': 0.312940735545833, 'support': 5960943}, 'weighted avg': {'precision': 0.37944192598045395, 'recall': 0.3966028529378657, 'f1-score': 0.324033081529727, 'support': 5960943}}
[[1160909     297  915167]
 [ 891836     370  953612]
 [ 835485     419 1202848]]
Evaluating performance on  train set...
7695/7695 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946164
{'0': {'precision': 0.3729920071780916, 'recall': 0.5342894081520989, 'f1-score': 0.43930290071712574, 'support': 659781}, '1': {'precision': 0.3383233532934132, 'recall': 0.00017490987497813625, 'f1-score': 0.0003496389900074414, 'support': 646047}, '2': {'precision': 0.3714641170192093, 'recall': 0.5731909270222907, 'f1-score': 0.4507885982989646, 'support': 663641}, 'accuracy': 0.3721916922784771, 'macro avg': {'precision': 0.36092649249690467, 'recall': 0.3692184150164559, 'f1-score': 0.29681371266869927, 'support': 1969469}, 'weighted avg': {'precision': 0.3611047673235086, 'recall': 0.3721916922784771, 'f1-score': 0.2991828693532858, 'support': 1969469}}
[[352514    102 307165]
 [309455    113 336479]
 [283129    119 380393]]
Evaluating performance on  val set...
2338/2338 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940627
{'0': {'precision': 0.3785609605367706, 'recall': 0.5352777278446881, 'f1-score': 0.44348144455499405, 'support': 200268}, '1': {'precision': 0.3300970873786408, 'recall': 0.000170304845673756, 'f1-score': 0.00034043405341810807, 'support': 199642}, '2': {'precision': 0.36763953055793147, 'recall': 0.5843411550065952, 'f1-score': 0.45132619005796587, 'support': 197869}, 'accuracy': 0.3728066727001116, 'macro avg': {'precision': 0.3587658594911143, 'recall': 0.37326306256565234, 'f1-score': 0.2983826895554593, 'support': 597779}, 'weighted avg': {'precision': 0.3587602699914047, 'recall': 0.37280667270011153, 'f1-score': 0.29808101116635366, 'support': 597779}}
[[107199     32  93037]
 [ 93767     34 105841]
 [ 82209     37 115623]]
testing model out of sample: results/universal/W8/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 181s - 181s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957651
{'0': {'precision': 0.36546702840055834, 'recall': 0.5527113057985524, 'f1-score': 0.43999678705070644, 'support': 1149649}, '1': {'precision': 0.45, 'recall': 0.00031009912452508896, 'f1-score': 0.0006197711590638855, 'support': 1306034}, '2': {'precision': 0.36349946767525954, 'recall': 0.5877968625328938, 'f1-score': 0.44920565726379447, 'support': 1160554}, 'accuracy': 0.36446698598570837, 'macro avg': {'precision': 0.39298883202527257, 'recall': 0.3802727558186571, 'f1-score': 0.29660740515785494, 'support': 3616237}, 'weighted avg': {'precision': 0.39536536597077754, 'recall': 0.36446698598570837, 'f1-score': 0.2842675219578087, 'support': 3616237}}
[[635424    240 513985]
 [625110    405 680519]
 [478129    255 682170]]
Evaluating performance on  train set...
4550/4550 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947332
{'0': {'precision': 0.37363438510384855, 'recall': 0.540823575777061, 'f1-score': 0.44194548646166265, 'support': 385684}, '1': {'precision': 0.38188976377952755, 'recall': 0.00024511352293832994, 'f1-score': 0.0004899125985822839, 'support': 395735}, '2': {'precision': 0.36821361108542594, 'recall': 0.582662702103866, 'f1-score': 0.45125603532359043, 'support': 382724}, 'accuracy': 0.37081612825915716, 'macro avg': {'precision': 0.374579253322934, 'recall': 0.37457713046795504, 'f1-score': 0.29789714479461177, 'support': 1164143}, 'weighted avg': {'precision': 0.37465855650271707, 'recall': 0.37081612825915716, 'f1-score': 0.29493944766739627, 'support': 1164143}}
[[208587     62 177035]
 [190048     97 205590]
 [159630     95 222999]]
Evaluating performance on  val set...
1570/1570 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953001
{'0': {'precision': 0.3679467736412113, 'recall': 0.5740015721470492, 'f1-score': 0.4484365357842363, 'support': 131031}, '1': {'precision': 0.44155844155844154, 'recall': 0.00024404774722395687, 'f1-score': 0.00048782587485831524, 'support': 139317}, '2': {'precision': 0.3701855074233497, 'recall': 0.5567527031473588, 'f1-score': 0.44469367984524316, 'support': 130681}, 'accuracy': 0.36905809804278494, 'macro avg': {'precision': 0.3932302408743342, 'recall': 0.37699944101387733, 'f1-score': 0.29787268050144594, 'support': 401029}, 'weighted avg': {'precision': 0.3942489031844822, 'recall': 0.36905809804278494, 'f1-score': 0.29160002127927936, 'support': 401029}}
[[75212    16 55803]
 [71301    34 67982]
 [57897    27 72757]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991362
{'0': {'precision': 0.36360522782694465, 'recall': 0.48236192137833267, 'f1-score': 0.4146480545552543, 'support': 55023}, '1': {'precision': 0.3333333333333333, 'recall': 0.00016484120297446792, 'f1-score': 0.0003295194508009154, 'support': 54598}, '2': {'precision': 0.3496702866221245, 'recall': 0.5811060074505408, 'f1-score': 0.4366151254110166, 'support': 55298}, 'accuracy': 0.35583528883876325, 'macro avg': {'precision': 0.3488696159274675, 'recall': 0.35454425667728257, 'f1-score': 0.2838642331390239, 'support': 164919}, 'weighted avg': {'precision': 0.3489109883863324, 'recall': 0.35583528883876325, 'f1-score': 0.28484961838082323, 'support': 164919}}
[[26541     8 28474]
 [23299     9 31290]
 [23154    10 32134]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001089
{'0': {'precision': 0.3566906362357355, 'recall': 0.4774534421427077, 'f1-score': 0.40833035075161056, 'support': 19116}, '1': {'precision': 0.2, 'recall': 0.00010626992561105207, 'f1-score': 0.00021242697822623476, 'support': 18820}, '2': {'precision': 0.35048802129547474, 'recall': 0.5755021334165886, 'f1-score': 0.4356560444321897, 'support': 19218}, 'accuracy': 0.35323861846939847, 'macro avg': {'precision': 0.30239288584373675, 'recall': 0.3510206151616358, 'f1-score': 0.28139960738734215, 'support': 57154}, 'weighted avg': {'precision': 0.30300901066484853, 'recall': 0.35323861846939847, 'f1-score': 0.28313116706784874, 'support': 57154}}
[[ 9127     6  9983]
 [ 8305     2 10513]
 [ 8156     2 11060]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095628
{'0': {'precision': 0.3816841579210395, 'recall': 0.4974759811105683, 'f1-score': 0.431954754330152, 'support': 6141}, '1': {'precision': 0.5, 'recall': 0.00019109497420217848, 'f1-score': 0.000382043935052531, 'support': 5233}, '2': {'precision': 0.3594105536894571, 'recall': 0.5659443780924757, 'f1-score': 0.4396288933068257, 'support': 5861}, 'accuracy': 0.3697708152016246, 'macro avg': {'precision': 0.4136982372034989, 'recall': 0.3545371513924154, 'f1-score': 0.29065523052401004, 'support': 17235}, 'weighted avg': {'precision': 0.4100335172014512, 'recall': 0.3697708152016246, 'f1-score': 0.30352760811864804, 'support': 17235}}
[[3055    0 3086]
 [2406    1 2826]
 [2543    1 3317]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
2179/2179 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0849756
{'0': {'precision': 0.41636184475731197, 'recall': 0.5819504077043869, 'f1-score': 0.48542316236545335, 'support': 191683}, '1': {'precision': 0.3561643835616438, 'recall': 0.00013974662861258473, 'f1-score': 0.0002793836367153081, 'support': 186051}, '2': {'precision': 0.3928795732022941, 'recall': 0.632361517654312, 'f1-score': 0.4846507331421992, 'support': 180041}, 'accuracy': 0.4041540047510197, 'macro avg': {'precision': 0.38846860050708326, 'recall': 0.4048172239957705, 'f1-score': 0.32345109304812264, 'support': 557775}, 'weighted avg': {'precision': 0.3887027178585584, 'recall': 0.4041540047510197, 'f1-score': 0.3233496486618196, 'support': 557775}}
[[111550     14  80119]
 [ 90209     26  95816]
 [ 66157     33 113851]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0875728
{'0': {'precision': 0.4044232381198014, 'recall': 0.5752623083131557, 'f1-score': 0.47494718349853476, 'support': 54516}, '1': {'precision': 0.23076923076923078, 'recall': 0.00011911142874158776, 'f1-score': 0.0002380999623008393, 'support': 50373}, '2': {'precision': 0.3949291310854829, 'recall': 0.6016285084778236, 'f1-score': 0.47684271266741585, 'support': 52195}, 'accuracy': 0.39958875506098646, 'macro avg': {'precision': 0.34337386665817177, 'recall': 0.3923366427399069, 'f1-score': 0.3173426653760838, 'support': 157084}, 'weighted avg': {'precision': 0.3455819924873592, 'recall': 0.39958875506098646, 'f1-score': 0.32334941720788163, 'support': 157084}}
[[31361    11 23144]
 [25400     6 24967]
 [20784     9 31402]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0859329
{'0': {'precision': 0.4088694775743323, 'recall': 0.5990647304947083, 'f1-score': 0.4860223642172524, 'support': 16252}, '1': {'precision': 0.29411764705882354, 'recall': 0.0002984718242597899, 'f1-score': 0.0005963384817222256, 'support': 16752}, '2': {'precision': 0.39060288706481744, 'recall': 0.6209822576497814, 'f1-score': 0.479559163005436, 'support': 15556}, 'accuracy': 0.39952635914332785, 'macro avg': {'precision': 0.36453000389932444, 'recall': 0.4067818199895832, 'f1-score': 0.32205928856813687, 'support': 48560}, 'weighted avg': {'precision': 0.3634313032176228, 'recall': 0.39952635914332785, 'f1-score': 0.3164919206181458, 'support': 48560}}
[[9736    7 6509]
 [8185    5 8562]
 [5891    5 9660]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1061729
{'0': {'precision': 0.31715420203271283, 'recall': 0.5581541459912042, 'f1-score': 0.404476738243684, 'support': 77991}, '1': {'precision': 0.7453416149068323, 'recall': 0.0008785930796151762, 'f1-score': 0.001755117263772186, 'support': 136582}, '2': {'precision': 0.2943539820797041, 'recall': 0.5683658080472944, 'f1-score': 0.3878449081411288, 'support': 82885}, 'accuracy': 0.30511870583410095, 'macro avg': {'precision': 0.45228326633974975, 'recall': 0.3757995157060379, 'f1-score': 0.2646922545495283, 'support': 297458}, 'weighted avg': {'precision': 0.5074092867652393, 'recall': 0.30511870583410095, 'f1-score': 0.21492710880111193, 'support': 297458}}
[[43531    13 34447]
 [57976   120 78486]
 [35748    28 47109]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960934
{'0': {'precision': 0.3754186939194641, 'recall': 0.5326788316103518, 'f1-score': 0.44043197039884124, 'support': 28826}, '1': {'precision': 0.23529411764705882, 'recall': 0.00014814814814814815, 'f1-score': 0.0002961098567568568, 'support': 27000}, '2': {'precision': 0.36098349896868553, 'recall': 0.554871018878801, 'f1-score': 0.4374041465492758, 'support': 27756}, 'accuracy': 0.36802182288052454, 'macro avg': {'precision': 0.3238987701784028, 'recall': 0.3625659995457669, 'f1-score': 0.2927107422682913, 'support': 83582}, 'weighted avg': {'precision': 0.32535974784963145, 'recall': 0.36802182288052454, 'f1-score': 0.29724673298642207, 'support': 83582}}
[[15355     8 13463]
 [13196     4 13800]
 [12350     5 15401]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003556
{'0': {'precision': 0.34400692340977934, 'recall': 0.550990099009901, 'f1-score': 0.4235643338280626, 'support': 10100}, '1': {'precision': 0.2, 'recall': 0.00025996533795493934, 'f1-score': 0.0005192557334487235, 'support': 11540}, '2': {'precision': 0.35217948717948716, 'recall': 0.5411741528762806, 'f1-score': 0.4266853059956508, 'support': 10152}, 'accuracy': 0.3479491696024157, 'macro avg': {'precision': 0.2987288035297555, 'recall': 0.3641414057413788, 'f1-score': 0.2835896318523874, 'support': 31792}, 'weighted avg': {'precision': 0.2943443658871705, 'recall': 0.3479491696024157, 'f1-score': 0.2710021769405912, 'support': 31792}}
[[5565    9 4526]
 [5957    3 5580]
 [4655    3 5494]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1223/1223 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003164
{'0': {'precision': 0.3603575227760312, 'recall': 0.5917710092029629, 'f1-score': 0.4479419065067077, 'support': 102467}, '1': {'precision': 0.3026315789473684, 'recall': 0.00020288627783070465, 'f1-score': 0.0004055007052186178, 'support': 113364}, '2': {'precision': 0.3430326990731461, 'recall': 0.5106227558463738, 'f1-score': 0.41037704646932366, 'support': 97197}, 'accuracy': 0.35233589327472303, 'macro avg': {'precision': 0.33534060026551527, 'recall': 0.3675322171090558, 'f1-score': 0.28624148456041665, 'support': 313028}, 'weighted avg': {'precision': 0.33407244672647063, 'recall': 0.35233589327472303, 'f1-score': 0.27420119063357934, 'support': 313028}}
[[60637    27 41803]
 [60092    23 53249]
 [47540    26 49631]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972819
{'0': {'precision': 0.3617612142796574, 'recall': 0.5655718688894045, 'f1-score': 0.44126963604628616, 'support': 30173}, '1': {'precision': 0.34615384615384615, 'recall': 0.00029687293838237235, 'f1-score': 0.0005932370970931383, 'support': 30316}, '2': {'precision': 0.3697731744272824, 'recall': 0.5286795137092603, 'f1-score': 0.43517372616338645, 'support': 30928}, 'accuracy': 0.3656322128269359, 'macro avg': {'precision': 0.35922941162026206, 'recall': 0.36484941851234903, 'f1-score': 0.29234553310225525, 'support': 91417}, 'weighted avg': {'precision': 0.3592960374672882, 'recall': 0.3656322128269359, 'f1-score': 0.29306875424747353, 'support': 91417}}
[[17065     7 13101]
 [15540     9 14767]
 [14567    10 16351]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980856
{'0': {'precision': 0.37326030349286166, 'recall': 0.4907910271546635, 'f1-score': 0.4240322333860356, 'support': 8470}, '1': {'precision': 0.4444444444444444, 'recall': 0.00046072333563695, 'f1-score': 0.0009204924634679553, 'support': 8682}, '2': {'precision': 0.34703422861597333, 'recall': 0.6041949413942012, 'f1-score': 0.4408534389629096, 'support': 8105}, 'accuracy': 0.3586332501880667, 'macro avg': {'precision': 0.3882463255177598, 'recall': 0.36514889729483385, 'f1-score': 0.28860205493747104, 'support': 25257}, 'weighted avg': {'precision': 0.3893136104914942, 'recall': 0.3586332501880667, 'f1-score': 0.2839870869518127, 'support': 25257}}
[[4157    1 4312]
 [3776    4 4902]
 [3204    4 4897]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967451
{'0': {'precision': 0.36012339759328477, 'recall': 0.5127494365571587, 'f1-score': 0.42309271633302, 'support': 121574}, '1': {'precision': 0.3728813559322034, 'recall': 0.00036039282818271914, 'f1-score': 0.0007200896838969944, 'support': 122089}, '2': {'precision': 0.3710050264077769, 'recall': 0.5792270492913424, 'f1-score': 0.45230244740018166, 'support': 125519}, 'accuracy': 0.365903538092323, 'macro avg': {'precision': 0.368003259977755, 'recall': 0.36411229289222796, 'f1-score': 0.29203841780569956, 'support': 369182}, 'weighted avg': {'precision': 0.3680421410390824, 'recall': 0.365903538092323, 'f1-score': 0.29334458294313176, 'support': 369182}}
[[62337    36 59201]
 [57985    44 64060]
 [52777    38 72704]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971972
{'0': {'precision': 0.3587391353244542, 'recall': 0.5388662306634168, 'f1-score': 0.4307291666666667, 'support': 41437}, '1': {'precision': 0.39285714285714285, 'recall': 0.0002642579157257483, 'f1-score': 0.0005281605608104863, 'support': 41626}, '2': {'precision': 0.3634134149770377, 'recall': 0.5382177393235553, 'f1-score': 0.4338704263175563, 'support': 43226}, 'accuracy': 0.36111617005439905, 'macro avg': {'precision': 0.3716698977195449, 'recall': 0.35911607596756595, 'f1-score': 0.2883759178483445, 'support': 126289}, 'weighted avg': {'precision': 0.37158464517739687, 'recall': 0.36111617005439905, 'f1-score': 0.29000619799565797, 'support': 126289}}
[[22329    10 19098]
 [19960    11 21655]
 [19954     7 23265]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958434
{'0': {'precision': 0.36597236759472473, 'recall': 0.5509335854407942, 'f1-score': 0.43979749064494833, 'support': 12693}, '1': {'precision': 0.2, 'recall': 0.00016122531237404273, 'f1-score': 0.0003221908981071285, 'support': 12405}, '2': {'precision': 0.3677877036258539, 'recall': 0.5363218390804597, 'f1-score': 0.43634663341645885, 'support': 13050}, 'accuracy': 0.3668344343084827, 'macro avg': {'precision': 0.31125335707352625, 'recall': 0.3624722166112093, 'f1-score': 0.2921554383198381, 'support': 38148}, 'weighted avg': {'precision': 0.31262233391520483, 'recall': 0.3668344343084827, 'f1-score': 0.2957080290692077, 'support': 38148}}
[[6993    6 5694]
 [6066    2 6337]
 [6049    2 6999]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/EXC
Evaluating performance on  test set...
5521/5521 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0780989
{'0': {'precision': 0.42589477829187, 'recall': 0.6309713309442454, 'f1-score': 0.5085363089090956, 'support': 479960}, '1': {'precision': 0.4226579520697168, 'recall': 0.0004230579676644147, 'f1-score': 0.0008452698654757366, 'support': 458566}, '2': {'precision': 0.42500740977177903, 'recall': 0.6282080715448661, 'f1-score': 0.5070056223465965, 'support': 474779}, 'accuracy': 0.4254531046023328, 'macro avg': {'precision': 0.4245200467111219, 'recall': 0.41986748681892533, 'f1-score': 0.33879573370705596, 'support': 1413305}, 'weighted avg': {'precision': 0.42454644768242034, 'recall': 0.4254531046023328, 'f1-score': 0.3432948452154603, 'support': 1413305}}
[[302841     94 177025]
 [231881    194 226491]
 [176348    171 298260]]
Evaluating performance on  train set...
1288/1288 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0831319
{'0': {'precision': 0.4075620645254456, 'recall': 0.6120262028461713, 'f1-score': 0.4892929249150333, 'support': 110675}, '1': {'precision': 0.40625, 'recall': 0.00023844023403826048, 'f1-score': 0.00047660073689806246, 'support': 109042}, '2': {'precision': 0.41251391726719927, 'recall': 0.6129568861295689, 'f1-score': 0.4931456758703658, 'support': 110011}, 'accuracy': 0.41001674107142855, 'macro avg': {'precision': 0.40877532726421495, 'recall': 0.4084071764032595, 'f1-score': 0.32763840050743237, 'support': 329728}, 'weighted avg': {'precision': 0.4087803054148739, 'recall': 0.41001674107142855, 'f1-score': 0.32892539581321256, 'support': 329728}}
[[67736    18 42921]
 [55903    26 53113]
 [42559    20 67432]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0853055
{'0': {'precision': 0.4051143773571605, 'recall': 0.6162734584450402, 'f1-score': 0.48886667659131033, 'support': 37300}, '1': {'precision': 0.2857142857142857, 'recall': 0.00010477787091366304, 'f1-score': 0.0002094789211835559, 'support': 38176}, '2': {'precision': 0.39971009240804495, 'recall': 0.6048807238826432, 'f1-score': 0.4813440977525638, 'support': 36470}, 'accuracy': 0.40243510263877225, 'macro avg': {'precision': 0.36351291849316375, 'recall': 0.4070863200661991, 'f1-score': 0.3234734177550192, 'support': 111946}, 'weighted avg': {'precision': 0.36263575221063776, 'recall': 0.40243510263877225, 'f1-score': 0.3197733134653045, 'support': 111946}}
[[22987     6 14307]
 [19349     4 18823]
 [14406     4 22060]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/AAL
Evaluating performance on  test set...
5918/5918 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925504
{'0': {'precision': 0.3778960591747987, 'recall': 0.604053031562843, 'f1-score': 0.4649309466516486, 'support': 481072}, '1': {'precision': 0.4253968253968254, 'recall': 0.0002407720517552103, 'f1-score': 0.0004812717066110211, 'support': 556543}, '2': {'precision': 0.37497452099470036, 'recall': 0.5857352928854517, 'f1-score': 0.45723653012836235, 'support': 477388}, 'accuracy': 0.3764679013836936, 'macro avg': {'precision': 0.3927558018554415, 'recall': 0.39667636550001656, 'f1-score': 0.30754958282887396, 'support': 1515003}, 'weighted avg': {'precision': 0.3944250770492086, 'recall': 0.3764679013836936, 'f1-score': 0.2918887562677651, 'support': 1515003}}
[[290593     87 190392]
 [280712    134 275697]
 [197671     94 279623]]
Evaluating performance on  train set...
1814/1814 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931867
{'0': {'precision': 0.37315417795253947, 'recall': 0.567037393817322, 'f1-score': 0.45010480610869885, 'support': 148447}, '1': {'precision': 0.4634146341463415, 'recall': 0.0003439329029143788, 'f1-score': 0.0006873556703828089, 'support': 165730}, '2': {'precision': 0.37628941599567434, 'recall': 0.5980946035976016, 'f1-score': 0.46194655202134416, 'support': 150100}, 'accuracy': 0.37478918835091984, 'macro avg': {'precision': 0.4042860760315185, 'recall': 0.38849197677261266, 'f1-score': 0.30424623793347527, 'support': 464277}, 'weighted avg': {'precision': 0.40638749477692093, 'recall': 0.37478918835091984, 'f1-score': 0.29350754197617873, 'support': 464277}}
[[84175    37 64235]
 [81105    57 84568]
 [60297    29 89774]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098245
{'0': {'precision': 0.3537304353929298, 'recall': 0.6141644325290437, 'f1-score': 0.4489096064488353, 'support': 49236}, '1': {'precision': 0.45454545454545453, 'recall': 0.00030718191312895495, 'f1-score': 0.0006139489194499018, 'support': 65108}, '2': {'precision': 0.3575675920767965, 'recall': 0.5705397192880914, 'f1-score': 0.439618374108053, 'support': 48377}, 'accuracy': 0.3555779524462116, 'macro avg': {'precision': 0.38861449400506026, 'recall': 0.39500377791008806, 'f1-score': 0.2963806431587794, 'support': 162721}, 'weighted avg': {'precision': 0.3952093741646802, 'recall': 0.3555779524462116, 'f1-score': 0.2667750594796472, 'support': 162721}}
[[30239    13 18984]
 [34482    20 30606]
 [20765    11 27601]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/WBA
Evaluating performance on  test set...
3755/3755 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057354
{'0': {'precision': 0.3374098620695942, 'recall': 0.5092023484819822, 'f1-score': 0.40587624894964175, 'support': 290741}, '1': {'precision': 0.4107142857142857, 'recall': 0.00017616466545308787, 'f1-score': 0.0003521782736629348, 'support': 391679}, '2': {'precision': 0.31646936719913904, 'recall': 0.5929080355028736, 'f1-score': 0.41267185713072874, 'support': 278738}, 'accuracy': 0.32604524958435555, 'macro avg': {'precision': 0.3548645049943397, 'recall': 0.367428849550103, 'f1-score': 0.27296676145134446, 'support': 961158}, 'weighted avg': {'precision': 0.36120916633541544, 'recall': 0.32604524958435555, 'f1-score': 0.2425929300310905, 'support': 961158}}
[[148046     41 142654]
 [177312     69 214298]
 [113414     58 165266]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955718
{'0': {'precision': 0.3698975613690748, 'recall': 0.528914689938872, 'f1-score': 0.4353395354724384, 'support': 130055}, '1': {'precision': 0.3235294117647059, 'recall': 0.00016907340091145933, 'f1-score': 0.00033797018181259557, 'support': 130121}, '2': {'precision': 0.36869679109364767, 'recall': 0.5757867305040832, 'f1-score': 0.4495382185854081, 'support': 132002}, 'accuracy': 0.369258346975098, 'macro avg': {'precision': 0.3540412547424761, 'recall': 0.3682901646146222, 'f1-score': 0.29507190807988637, 'support': 392178}, 'weighted avg': {'precision': 0.35410887849403583, 'recall': 0.369258346975098, 'f1-score': 0.2957891677595547, 'support': 392178}}
[[68788    23 61244]
 [61203    22 68896]
 [55974    23 76005]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987525
{'0': {'precision': 0.3551386798537949, 'recall': 0.5311662557616036, 'f1-score': 0.42567219311055754, 'support': 37316}, '1': {'precision': 0.21052631578947367, 'recall': 9.159815887700658e-05, 'f1-score': 0.00018311664530305807, 'support': 43669}, '2': {'precision': 0.35564577039274925, 'recall': 0.588624407521225, 'f1-score': 0.44339382050024523, 'support': 38398}, 'accuracy': 0.3553856076660831, 'macro avg': {'precision': 0.3071035886786726, 'recall': 0.3732940871472352, 'f1-score': 0.2897497100853686, 'support': 119383}, 'weighted avg': {'precision': 0.3024041526278911, 'recall': 0.3553856076660831, 'f1-score': 0.27573285977455514, 'support': 119383}}
[[19821     4 17491]
 [20206     4 23459]
 [15785    11 22602]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
4960/4960 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964011
{'0': {'precision': 0.3629242508002157, 'recall': 0.5137986758102269, 'f1-score': 0.42537954425691515, 'support': 413989}, '1': {'precision': 0.3659574468085106, 'recall': 0.00019714732406893738, 'f1-score': 0.0003940823494639792, 'support': 436222}, '2': {'precision': 0.3672433372161768, 'recall': 0.5982754181526901, 'f1-score': 0.45511837013017636, 'support': 419464}, 'accuracy': 0.3652493748400181, 'macro avg': {'precision': 0.365375011608301, 'recall': 0.3707570804289953, 'f1-score': 0.2936306655788518, 'support': 1269675}, 'weighted avg': {'precision': 0.3653932669606624, 'recall': 0.3652493748400181, 'f1-score': 0.28919221969898457, 'support': 1269675}}
[[212707     63 201219]
 [204962     86 231174]
 [168423     86 250955]]
Evaluating performance on  train set...
1691/1691 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947975
{'0': {'precision': 0.3805983716508041, 'recall': 0.5238742577337716, 'f1-score': 0.4408882766942629, 'support': 147858}, '1': {'precision': 0.38666666666666666, 'recall': 0.0002034245470296509, 'f1-score': 0.00040663516412636536, 'support': 142559}, '2': {'precision': 0.3653264819168844, 'recall': 0.5880329158007077, 'f1-score': 0.45066739132189493, 'support': 142424}, 'accuracy': 0.3725109220244847, 'macro avg': {'precision': 0.3775305067447851, 'recall': 0.3707035326938363, 'f1-score': 0.29732076772676136, 'support': 432841}, 'weighted avg': {'precision': 0.3775718710321071, 'recall': 0.3725109220244847, 'f1-score': 0.2990305466890904, 'support': 432841}}
[[77459    26 70373]
 [67406    29 75124]
 [58654    20 83750]]
Evaluating performance on  val set...
591/591 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908892
{'0': {'precision': 0.38709549439940755, 'recall': 0.5537352679669322, 'f1-score': 0.455657777985336, 'support': 52861}, '1': {'precision': 0.5, 'recall': 0.0002886900135462237, 'f1-score': 0.0005770468517655413, 'support': 45031}, '2': {'precision': 0.3883958140151013, 'recall': 0.5507034052703743, 'f1-score': 0.4555235335700025, 'support': 53241}, 'accuracy': 0.38776441941865775, 'macro avg': {'precision': 0.425163769471503, 'recall': 0.3682424544169509, 'f1-score': 0.30391945280236804, 'support': 151133}, 'weighted avg': {'precision': 0.4211941565602819, 'recall': 0.38776441941865775, 'f1-score': 0.3200164044230261, 'support': 151133}}
[[29271     9 23581]
 [22429    13 22589]
 [23917     4 29320]]
testing model on single stock: results/universal/W8/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
10609/10609 - 145s - 145s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857062
{'0': {'precision': 0.41289099584310085, 'recall': 0.5314328309221154, 'f1-score': 0.4647215808051511, 'support': 1011522}, '1': {'precision': 0.2972972972972973, 'recall': 0.00011060707483071372, 'f1-score': 0.00022113187931943075, 'support': 696158}, '2': {'precision': 0.40710060092565475, 'recall': 0.5708657863069037, 'f1-score': 0.47527155879269034, 'support': 1007997}, 'accuracy': 0.4098661217810513, 'macro avg': {'precision': 0.372429631355351, 'recall': 0.3674697414346166, 'f1-score': 0.31340475715905364, 'support': 2715677}, 'weighted avg': {'precision': 0.38110953630360095, 'recall': 0.4098661217810513, 'f1-score': 0.3495637923929785, 'support': 2715677}}
[[537556     75 473891]
 [331917     77 364164]
 [432459    107 575431]]
Evaluating performance on  train set...
3903/3903 - 47s - 47s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988355
{'0': {'precision': 0.3577744585511576, 'recall': 0.5014654775363229, 'f1-score': 0.41760521636040304, 'support': 334362}, '1': {'precision': 0.2896551724137931, 'recall': 0.00012875733840187617, 'f1-score': 0.0002574002574002574, 'support': 326195}, '2': {'precision': 0.35669766362983174, 'recall': 0.5587657493980887, 'f1-score': 0.43543069988443456, 'support': 338505}, 'accuracy': 0.3571930470781593, 'macro avg': {'precision': 0.33470909819826083, 'recall': 0.3534533280909378, 'f1-score': 0.28443110550074596, 'support': 999062}, 'weighted avg': {'precision': 0.3351685832336888, 'recall': 0.3571930470781593, 'f1-score': 0.2873803098246558, 'support': 999062}}
[[167671     47 166644]
 [151675     42 174478]
 [149304     56 189145]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965781
{'0': {'precision': 0.37122335051584404, 'recall': 0.4987516100267512, 'f1-score': 0.4256403969002211, 'support': 100930}, '1': {'precision': 0.38636363636363635, 'recall': 0.00018405638621525936, 'f1-score': 0.00036793749391279883, 'support': 92363}, '2': {'precision': 0.3585351560011721, 'recall': 0.5665894906382122, 'f1-score': 0.43916731037819023, 'support': 99340}, 'accuracy': 0.36441891379304453, 'macro avg': {'precision': 0.37204071429355084, 'recall': 0.35517505235039293, 'f1-score': 0.2883918815907747, 'support': 292633}, 'weighted avg': {'precision': 0.37169478394499295, 'recall': 0.36441891379304453, 'f1-score': 0.29600472155518687, 'support': 292633}}
[[50339    13 50578]
 [42223    17 50123]
 [43041    14 56285]]
training model: results/universal/W8/deepLOB_L2/h50
Epoch 1/50
7696/7696 - 356s - loss: 3.1105 - accuracy50: 0.4389 - val_loss: 3.4022 - val_accuracy50: 0.3962 - 356s/epoch - 46ms/step
Epoch 2/50
7696/7696 - 350s - loss: 3.0572 - accuracy50: 0.4599 - val_loss: 3.4976 - val_accuracy50: 0.3833 - 350s/epoch - 46ms/step
Epoch 3/50
7696/7696 - 353s - loss: 3.0312 - accuracy50: 0.4691 - val_loss: 3.3632 - val_accuracy50: 0.3935 - 353s/epoch - 46ms/step
Epoch 4/50
7696/7696 - 351s - loss: 3.0066 - accuracy50: 0.4770 - val_loss: 3.3698 - val_accuracy50: 0.3964 - 351s/epoch - 46ms/step
Epoch 5/50
7696/7696 - 351s - loss: 2.9857 - accuracy50: 0.4828 - val_loss: 3.3652 - val_accuracy50: 0.3974 - 351s/epoch - 46ms/step
Epoch 6/50
7696/7696 - 350s - loss: 2.9686 - accuracy50: 0.4870 - val_loss: 3.3641 - val_accuracy50: 0.4060 - 350s/epoch - 45ms/step
Epoch 7/50
7696/7696 - 350s - loss: 2.9559 - accuracy50: 0.4899 - val_loss: 3.3187 - val_accuracy50: 0.4149 - 350s/epoch - 46ms/step
Epoch 8/50
7696/7696 - 352s - loss: 2.9466 - accuracy50: 0.4923 - val_loss: 3.2749 - val_accuracy50: 0.4202 - 352s/epoch - 46ms/step
Epoch 9/50
7696/7696 - 352s - loss: 2.9389 - accuracy50: 0.4942 - val_loss: 3.2786 - val_accuracy50: 0.4176 - 352s/epoch - 46ms/step
Epoch 10/50
7696/7696 - 350s - loss: 2.9332 - accuracy50: 0.4957 - val_loss: 3.2802 - val_accuracy50: 0.4183 - 350s/epoch - 45ms/step
Epoch 11/50
7696/7696 - 352s - loss: 2.9274 - accuracy50: 0.4972 - val_loss: 3.3314 - val_accuracy50: 0.4208 - 352s/epoch - 46ms/step
Epoch 12/50
7696/7696 - 351s - loss: 2.9237 - accuracy50: 0.4980 - val_loss: 3.3008 - val_accuracy50: 0.4187 - 351s/epoch - 46ms/step
Epoch 13/50
7696/7696 - 352s - loss: 2.9194 - accuracy50: 0.4991 - val_loss: 3.3156 - val_accuracy50: 0.4171 - 352s/epoch - 46ms/step
Epoch 14/50
7696/7696 - 351s - loss: 2.9162 - accuracy50: 0.4995 - val_loss: 3.2869 - val_accuracy50: 0.4205 - 351s/epoch - 46ms/step
Epoch 15/50
7696/7696 - 350s - loss: 2.9130 - accuracy50: 0.5004 - val_loss: 3.2313 - val_accuracy50: 0.4238 - 350s/epoch - 45ms/step
Epoch 16/50
7696/7696 - 351s - loss: 2.9097 - accuracy50: 0.5011 - val_loss: 3.2542 - val_accuracy50: 0.4223 - 351s/epoch - 46ms/step
Epoch 17/50
7696/7696 - 351s - loss: 2.9071 - accuracy50: 0.5019 - val_loss: 3.3096 - val_accuracy50: 0.4177 - 351s/epoch - 46ms/step
Epoch 18/50
7696/7696 - 353s - loss: 2.9045 - accuracy50: 0.5026 - val_loss: 3.3009 - val_accuracy50: 0.4166 - 353s/epoch - 46ms/step
Epoch 19/50
7696/7696 - 352s - loss: 2.9020 - accuracy50: 0.5031 - val_loss: 3.3678 - val_accuracy50: 0.4157 - 352s/epoch - 46ms/step
Epoch 20/50
7696/7696 - 352s - loss: 2.9001 - accuracy50: 0.5036 - val_loss: 3.3477 - val_accuracy50: 0.4170 - 352s/epoch - 46ms/step
Epoch 21/50
7696/7696 - 350s - loss: 2.8980 - accuracy50: 0.5040 - val_loss: 3.3830 - val_accuracy50: 0.4142 - 350s/epoch - 45ms/step
Epoch 22/50
7696/7696 - 352s - loss: 2.8959 - accuracy50: 0.5048 - val_loss: 3.3162 - val_accuracy50: 0.4222 - 352s/epoch - 46ms/step
Epoch 23/50
7696/7696 - 353s - loss: 2.8939 - accuracy50: 0.5051 - val_loss: 3.3791 - val_accuracy50: 0.4119 - 353s/epoch - 46ms/step
Epoch 24/50
7696/7696 - 353s - loss: 2.8918 - accuracy50: 0.5057 - val_loss: 3.3463 - val_accuracy50: 0.4180 - 353s/epoch - 46ms/step
Epoch 25/50
7696/7696 - 353s - loss: 2.8901 - accuracy50: 0.5059 - val_loss: 3.3767 - val_accuracy50: 0.4167 - 353s/epoch - 46ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 417s - 417s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0599042
{'0': {'precision': 0.3950488368521423, 'recall': 0.38240649532849763, 'f1-score': 0.388624876391295, 'support': 1708551}, '1': {'precision': 0.4858569679969501, 'recall': 0.4814867051358167, 'f1-score': 0.48366196458499466, 'support': 2538311}, '2': {'precision': 0.39167957401562276, 'recall': 0.4093906677883398, 'f1-score': 0.40033933105344094, 'support': 1714106}, 'accuracy': 0.43235645619973134, 'macro avg': {'precision': 0.4241951262882384, 'recall': 0.42442795608421807, 'f1-score': 0.42420872400991017, 'support': 5960968}, 'weighted avg': {'precision': 0.4327480837748994, 'recall': 0.43235645619973134, 'f1-score': 0.4324623040361256, 'support': 5960968}}
[[ 653361  683214  371976]
 [ 598248 1222163  717900]
 [ 402265  610102  701739]]
Evaluating performance on  train set...
7696/7696 - 141s - 141s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0888476
{'0': {'precision': 0.39156055031007186, 'recall': 0.5484644960975145, 'f1-score': 0.45691774009255987, 'support': 608074}, '1': {'precision': 0.4713850873547203, 'recall': 0.4174972226525621, 'f1-score': 0.44280769806031745, 'support': 755217}, '2': {'precision': 0.4094261016798111, 'recall': 0.30316452459546445, 'f1-score': 0.34837244526083627, 'support': 606189}, 'accuracy': 0.42274255133334687, 'macro avg': {'precision': 0.42412391311486775, 'recall': 0.4230420811151803, 'f1-score': 0.4160326278045712, 'support': 1969480}, 'weighted avg': {'precision': 0.4276689383680969, 'recall': 0.42274255133334687, 'f1-score': 0.4180977940447647, 'support': 1969480}}
[[333507 175524  99043]
 [273874 315301 166042]
 [244357 178057 183775]]
Evaluating performance on  val set...
2338/2338 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0826616
{'0': {'precision': 0.38604151883994686, 'recall': 0.5940322409052986, 'f1-score': 0.4679670407227045, 'support': 178593}, '1': {'precision': 0.499543834337605, 'recall': 0.38765312170706007, 'f1-score': 0.4365428115845293, 'support': 242944}, '2': {'precision': 0.3939837991029255, 'recall': 0.30052824793041427, 'f1-score': 0.34096819878975154, 'support': 176243}, 'accuracy': 0.4236240757469303, 'macro avg': {'precision': 0.4265230507601592, 'recall': 0.427404536847591, 'f1-score': 0.4151593503656618, 'support': 597780}, 'weighted avg': {'precision': 0.43451165473718534, 'recall': 0.4236240757469303, 'f1-score': 0.41775294051437656, 'support': 597780}}
[[106090  46253  26250]
 [ 93545  94178  55221]
 [ 75180  48097  52966]]
testing model out of sample: results/universal/W8/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 253s - 253s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0310465
{'0': {'precision': 0.4094813064836059, 'recall': 0.5258985594347797, 'f1-score': 0.4604452950968037, 'support': 926789}, '1': {'precision': 0.6764683260162454, 'recall': 0.3787610228327476, 'f1-score': 0.48561923596106427, 'support': 1764746}, '2': {'precision': 0.3556800439534455, 'recall': 0.5530572806893278, 'f1-score': 0.43293354981689763, 'support': 924727}, 'accuracy': 0.4610398804068953, 'macro avg': {'precision': 0.48054322548443235, 'recall': 0.48590562098561835, 'f1-score': 0.45966602695825515, 'support': 3616262}, 'weighted avg': {'precision': 0.5260140119890201, 'recall': 0.4610398804068953, 'f1-score': 0.46569512427593635, 'support': 3616262}}
[[487397 177107 262285]
 [432156 668417 664173]
 [270726 142574 511427]]
Evaluating performance on  train set...
4550/4550 - 85s - 85s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.03062
{'0': {'precision': 0.4106475463113422, 'recall': 0.4914673278879813, 'f1-score': 0.44743714589235134, 'support': 329088}, '1': {'precision': 0.5982162752799487, 'recall': 0.4391094172153326, 'f1-score': 0.5064607999345397, 'support': 507443}, '2': {'precision': 0.40415166810786896, 'recall': 0.4907453757401868, 'f1-score': 0.4432589504794358, 'support': 327620}, 'accuracy': 0.46844180866571433, 'macro avg': {'precision': 0.47100516323305325, 'recall': 0.47377404028116693, 'f1-score': 0.4657189654354423, 'support': 1164151}, 'weighted avg': {'precision': 0.4905789803924834, 'recall': 0.46844180866571433, 'f1-score': 0.4719891839844466, 'support': 1164151}}
[[161736  80284  87068]
 [134650 222823 149970]
 [ 97470  69372 160778]]
Evaluating performance on  val set...
1570/1570 - 29s - 29s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0566728
{'0': {'precision': 0.39968630184733356, 'recall': 0.4181488335627615, 'f1-score': 0.4087091729671691, 'support': 109693}, '1': {'precision': 0.5720396611328497, 'recall': 0.415066982744363, 'f1-score': 0.4810721873452501, 'support': 181390}, '2': {'precision': 0.37734873074784364, 'recall': 0.5307867212369258, 'f1-score': 0.44110533317208844, 'support': 109950}, 'accuracy': 0.44763647879351576, 'macro avg': {'precision': 0.44969156457600895, 'recall': 0.45466751251468346, 'f1-score': 0.4436288978281692, 'support': 401033}, 'weighted avg': {'precision': 0.4715186944394914, 'recall': 0.44763647879351576, 'f1-score': 0.45032142181594453, 'support': 401033}}
[[45868 30599 33226]
 [43029 75289 63072]
 [25863 25727 58360]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
645/645 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.138265
{'0': {'precision': 0.37680637890869145, 'recall': 0.3549192757113549, 'f1-score': 0.3655354879012255, 'support': 56055}, '1': {'precision': 0.3874162540052432, 'recall': 0.1459453527927137, 'f1-score': 0.21201976725649604, 'support': 54678}, '2': {'precision': 0.3719667420542572, 'recall': 0.6282408518019598, 'f1-score': 0.4672724028603193, 'support': 54191}, 'accuracy': 0.3754456598190682, 'macro avg': {'precision': 0.37872979165606396, 'recall': 0.3763684934353428, 'f1-score': 0.3482758860060136, 'support': 164924}, 'weighted avg': {'precision': 0.37873370294734326, 'recall': 0.3754456598190682, 'f1-score': 0.34806860973392256, 'support': 164924}}
[[19895  7298 28862]
 [18078  7980 28620]
 [14826  5320 34045]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1274707
{'0': {'precision': 0.3888334521263958, 'recall': 0.43471100722481937, 'f1-score': 0.41049436905866715, 'support': 18824}, '1': {'precision': 0.42107345377818806, 'recall': 0.16791123264619268, 'f1-score': 0.24008421369224406, 'support': 19016}, '2': {'precision': 0.37755030498492603, 'recall': 0.5576265921093507, 'f1-score': 0.45025083612040134, 'support': 19314}, 'accuracy': 0.3874794415089058, 'macro avg': {'precision': 0.39581907029650326, 'recall': 0.3867496106601209, 'f1-score': 0.36694313962377084, 'support': 57154}, 'weighted avg': {'precision': 0.3957472843607125, 'recall': 0.3874794415089058, 'f1-score': 0.3672312009581393, 'support': 57154}}
[[ 8183  2278  8363]
 [ 6430  3193  9393]
 [ 6432  2112 10770]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1772785
{'0': {'precision': 0.36955530216647664, 'recall': 0.5324461968128799, 'f1-score': 0.43629265666016015, 'support': 6087}, '1': {'precision': 0.31389521640091117, 'recall': 0.13091392741782254, 'f1-score': 0.18476803432555647, 'support': 5263}, '2': {'precision': 0.366390306122449, 'recall': 0.39035162221844744, 'f1-score': 0.37799161115223295, 'support': 5887}, 'accuracy': 0.3613157742066485, 'macro avg': {'precision': 0.34994694156327893, 'recall': 0.3512372488163833, 'f1-score': 0.3330174340459832, 'support': 17237}, 'weighted avg': {'precision': 0.3514795718714507, 'recall': 0.3613157742066485, 'f1-score': 0.33958253643899716, 'support': 17237}}
[[3241  790 2056]
 [2656  689 1918]
 [2873  716 2298]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
2179/2179 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99547535
{'0': {'precision': 0.46657316503038804, 'recall': 0.2840396673633655, 'f1-score': 0.3531122327692487, 'support': 112435}, '1': {'precision': 0.7328672270200611, 'recall': 0.4525707837809749, 'f1-score': 0.5595810026637098, 'support': 336765}, '2': {'precision': 0.3032718717124904, 'recall': 0.7858813777859642, 'f1-score': 0.4376532255582796, 'support': 108580}, 'accuracy': 0.4834827351285453, 'macro avg': {'precision': 0.5009040879209798, 'recall': 0.5074972763101014, 'f1-score': 0.4501154869970794, 'support': 557780}, 'weighted avg': {'precision': 0.5955617722904097, 'recall': 0.4834827351285453, 'f1-score': 0.4942268591282812, 'support': 557780}}
[[ 31936  38996  41503]
 [ 29821 152410 154534]
 [  6691  16558  85331]]
Evaluating performance on  train set...
614/614 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99569863
{'0': {'precision': 0.4004093037899957, 'recall': 0.5507944671520992, 'f1-score': 0.4637139503879856, 'support': 36943}, '1': {'precision': 0.7394160432683341, 'recall': 0.4273856436177221, 'f1-score': 0.5416786847418517, 'support': 83489}, '2': {'precision': 0.3591670688823002, 'recall': 0.5684354112672214, 'f1-score': 0.4401956331139679, 'support': 36655}, 'accuracy': 0.48932120417348346, 'macro avg': {'precision': 0.4996641386468766, 'recall': 0.515538507345681, 'f1-score': 0.48186275608126844, 'support': 157087}, 'weighted avg': {'precision': 0.5709619246419148, 'recall': 0.48932120417348346, 'f1-score': 0.4996630345693043, 'support': 157087}}
[[20348  7123  9472]
 [20103 35682 27704]
 [10367  5452 20836]]
Evaluating performance on  val set...
190/190 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99619734
{'0': {'precision': 0.35559860034991253, 'recall': 0.5575585382580582, 'f1-score': 0.4342451642440197, 'support': 10207}, '1': {'precision': 0.7668372203712518, 'recall': 0.4559250088432968, 'f1-score': 0.5718532321753405, 'support': 28270}, '2': {'precision': 0.38658877317754636, 'recall': 0.6037885549935536, 'f1-score': 0.4713716077581201, 'support': 10083}, 'accuracy': 0.507990115321252, 'macro avg': {'precision': 0.5030081979662369, 'recall': 0.5390907006983029, 'f1-score': 0.4924900013924934, 'support': 48560}, 'weighted avg': {'precision': 0.6014427045637571, 'recall': 0.507990115321252, 'f1-score': 0.5220648926289272, 'support': 48560}}
[[ 5691  2170  2346]
 [ 8067 12889  7314]
 [ 2246  1749  6088]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
1162/1162 - 21s - 21s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1710519
{'0': {'precision': 0.3420872090240439, 'recall': 0.5501289304545279, 'f1-score': 0.4218530961176175, 'support': 77949}, '1': {'precision': 0.4864292265757212, 'recall': 0.2677179910130254, 'f1-score': 0.3453592409324167, 'support': 140648}, '2': {'precision': 0.3110559662090813, 'recall': 0.37350696117465065, 'f1-score': 0.33943283822868536, 'support': 78866}, 'accuracy': 0.36977035799410346, 'macro avg': {'precision': 0.3798574672696155, 'recall': 0.3971179608807347, 'f1-score': 0.36888172509290656, 'support': 297463}, 'weighted avg': {'precision': 0.4021084758329024, 'recall': 0.36977035799410346, 'f1-score': 0.36383289258724016, 'support': 297463}}
[[42882 19335 15732]
 [53483 37654 49511]
 [28989 20420 29457]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1624742
{'0': {'precision': 0.3975808737833496, 'recall': 0.45152750947985976, 'f1-score': 0.42284048843402955, 'support': 27954}, '1': {'precision': 0.3863543324994314, 'recall': 0.3054846250674339, 'f1-score': 0.34119301064470775, 'support': 27805}, '2': {'precision': 0.40311557788944724, 'recall': 0.4324839161844517, 'f1-score': 0.4172836509285108, 'support': 27823}, 'accuracy': 0.3966045320762844, 'macro avg': {'precision': 0.39568359472407605, 'recall': 0.39649868357724843, 'f1-score': 0.3937723833357494, 'support': 83582}, 'weighted avg': {'precision': 0.39568857749879804, 'recall': 0.3966045320762844, 'f1-score': 0.3938292658041793, 'support': 83582}}
[[12622  7180  8152]
 [ 9646  8494  9665]
 [ 9479  6311 12033]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1609043
{'0': {'precision': 0.3819396847155586, 'recall': 0.4445109183368232, 'f1-score': 0.41085664255103455, 'support': 10029}, '1': {'precision': 0.4155581568585719, 'recall': 0.33791969539633093, 'f1-score': 0.3727389872571947, 'support': 11556}, '2': {'precision': 0.4092138394106127, 'recall': 0.42990104830018616, 'f1-score': 0.41930243669374107, 'support': 10207}, 'accuracy': 0.4010757423251132, 'macro avg': {'precision': 0.4022372269949144, 'recall': 0.40411055401111345, 'f1-score': 0.4009660221673234, 'support': 31792}, 'weighted avg': {'precision': 0.4029161052319488, 'recall': 0.4010757423251132, 'f1-score': 0.39971291445085183, 'support': 31792}}
[[4458 2757 2814]
 [4130 3905 3521]
 [3084 2735 4388]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1223/1223 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1832091
{'0': {'precision': 0.36142191809974383, 'recall': 0.4178906723198062, 'f1-score': 0.3876104407975878, 'support': 105664}, '1': {'precision': 0.3300665635055142, 'recall': 0.1229707717930416, 'f1-score': 0.17918408437839603, 'support': 109278}, '2': {'precision': 0.34049964368252444, 'recall': 0.521199702317236, 'f1-score': 0.4119030929994602, 'support': 98091}, 'accuracy': 0.347308430740529, 'macro avg': {'precision': 0.3439960417625942, 'recall': 0.35402038214336123, 'f1-score': 0.3262325393918147, 'support': 313033}, 'weighted avg': {'precision': 0.3439198104650609, 'recall': 0.347308430740529, 'f1-score': 0.32246227804911537, 'support': 313033}}
[[44156 14079 47429]
 [44247 13438 51593]
 [33770 13196 51125]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1916419
{'0': {'precision': 0.3724213351891435, 'recall': 0.47959542937618027, 'f1-score': 0.41926773647467014, 'support': 31243}, '1': {'precision': 0.31852986217457885, 'recall': 0.14439192092823377, 'f1-score': 0.19870803384587388, 'support': 30251}, '2': {'precision': 0.3496210503842869, 'recall': 0.43779448621553885, 'f1-score': 0.38877101354659704, 'support': 29925}, 'accuracy': 0.3549918507093711, 'macro avg': {'precision': 0.3468574159160031, 'recall': 0.35392727883998426, 'f1-score': 0.33558226128904706, 'support': 91419}, 'weighted avg': {'precision': 0.3471249583643157, 'recall': 0.3549918507093711, 'f1-score': 0.3363006727587434, 'support': 91419}}
[[14984  4643 11616]
 [13128  4368 12755]
 [12122  4702 13101]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1743435
{'0': {'precision': 0.3656585663137046, 'recall': 0.5614691776816002, 'f1-score': 0.44288614135449345, 'support': 8549}, '1': {'precision': 0.32527588018917497, 'recall': 0.07274650370196263, 'f1-score': 0.11890126776796005, 'support': 8509}, '2': {'precision': 0.3593077825576848, 'recall': 0.4481707317073171, 'f1-score': 0.3988495767310615, 'support': 8200}, 'accuracy': 0.36004434238657057, 'macro avg': {'precision': 0.35008074302018805, 'recall': 0.36079547103029336, 'f1-score': 0.3202123286178383, 'support': 25258}, 'weighted avg': {'precision': 0.3499925316699092, 'recall': 0.36004434238657057, 'f1-score': 0.31944457356369627, 'support': 25258}}
[[4800  624 3125]
 [4462  619 3428]
 [3865  660 3675]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1433287
{'0': {'precision': 0.3897584690393559, 'recall': 0.4607125062282013, 'f1-score': 0.42227567152023504, 'support': 120420}, '1': {'precision': 0.41958860404341625, 'recall': 0.20903521593622953, 'f1-score': 0.2790501780649564, 'support': 125199}, '2': {'precision': 0.39203025438980493, 'recall': 0.5218017609737149, 'f1-score': 0.4477017080960978, 'support': 123568}, 'accuracy': 0.39581025334044806, 'macro avg': {'precision': 0.40045910915752564, 'recall': 0.39718316104604856, 'f1-score': 0.38300918589376315, 'support': 369187}, 'weighted avg': {'precision': 0.40063486242416535, 'recall': 0.39581025334044806, 'f1-score': 0.3822150949899097, 'support': 369187}}
[[55479 17294 47647]
 [46681 26171 52347]
 [40182 18908 64478]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1339575
{'0': {'precision': 0.37860550016359285, 'recall': 0.5280526467480066, 'f1-score': 0.44101216564534085, 'support': 41636}, '1': {'precision': 0.41518792790275255, 'recall': 0.2830943647882628, 'f1-score': 0.3366471237998131, 'support': 41986}, '2': {'precision': 0.40618291112065263, 'recall': 0.37689243027888447, 'f1-score': 0.3909898739408969, 'support': 42670}, 'accuracy': 0.3955436607227695, 'macro avg': {'precision': 0.3999921130623327, 'recall': 0.39601314727171794, 'f1-score': 0.3895497211286836, 'support': 126292}, 'weighted avg': {'precision': 0.40008491245094363, 'recall': 0.3955436607227695, 'f1-score': 0.3894149003082257, 'support': 126292}}
[[21986  8334 11316]
 [17905 11886 12195]
 [18180  8408 16082]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1340215
{'0': {'precision': 0.38317483540599856, 'recall': 0.6250099435208019, 'f1-score': 0.47508767686540093, 'support': 12571}, '1': {'precision': 0.4384300194091007, 'recall': 0.3074712643678161, 'f1-score': 0.36145435149791094, 'support': 13224}, '2': {'precision': 0.3967021149480225, 'recall': 0.268760624949405, 'f1-score': 0.32043239069587875, 'support': 12353}, 'accuracy': 0.399575338156653, 'macro avg': {'precision': 0.4061023232543739, 'recall': 0.400413944279341, 'f1-score': 0.3856581396863969, 'support': 38148}, 'weighted avg': {'precision': 0.40670941224986046, 'recall': 0.399575338156653, 'f1-score': 0.3856165684269036, 'support': 38148}}
[[7857 2437 2277]
 [6386 4066 2772]
 [6262 2771 3320]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
5521/5521 - 103s - 103s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9544374
{'0': {'precision': 0.4030736562829625, 'recall': 0.6181157424085101, 'f1-score': 0.4879529157233826, 'support': 283146}, '1': {'precision': 0.7753907358804495, 'recall': 0.42304503315360736, 'f1-score': 0.5474222449684294, 'support': 839426}, '2': {'precision': 0.39265661399825763, 'recall': 0.703802048579821, 'f1-score': 0.504081984578622, 'support': 290738}, 'accuracy': 0.5198816961600781, 'macro avg': {'precision': 0.5237070020538899, 'recall': 0.5816542747139795, 'f1-score': 0.5131523817568113, 'support': 1413310}, 'weighted avg': {'precision': 0.6220659557915131, 'recall': 0.5198816961600781, 'f1-score': 0.5265923043866534, 'support': 1413310}}
[[175017  56584  51545]
 [219356 355115 264955]
 [ 39833  46283 204622]]
Evaluating performance on  train set...
1289/1289 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0050677
{'0': {'precision': 0.3756269770530768, 'recall': 0.6151226352995048, 'f1-score': 0.4664279513888889, 'support': 69882}, '1': {'precision': 0.7693957530908561, 'recall': 0.3603464778954676, 'f1-score': 0.4908182453124161, 'support': 190142}, '2': {'precision': 0.37938355024992276, 'recall': 0.6870714142254613, 'f1-score': 0.48884125647503124, 'support': 69706}, 'accuracy': 0.4834137021199163, 'macro avg': {'precision': 0.5081354267979519, 'recall': 0.5541801758068112, 'f1-score': 0.4820291510587787, 'support': 329730}, 'weighted avg': {'precision': 0.6034917097271882, 'recall': 0.4834137021199163, 'f1-score': 0.48523109672459364, 'support': 329730}}
[[42986 12278 14618]
 [57897 68517 63728]
 [13555  8258 47893]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9630816
{'0': {'precision': 0.41326031683942893, 'recall': 0.5725511448313236, 'f1-score': 0.4800363491793037, 'support': 22143}, '1': {'precision': 0.7710615471485037, 'recall': 0.40067779701299844, 'f1-score': 0.527331003456199, 'support': 68162}, '2': {'precision': 0.3576819054266271, 'recall': 0.7577745945196618, 'f1-score': 0.4859754923024493, 'support': 21641}, 'accuracy': 0.503707144516106, 'macro avg': {'precision': 0.51400125647152, 'recall': 0.5770011787879946, 'f1-score': 0.4977809483126507, 'support': 111946}, 'weighted avg': {'precision': 0.620375131651416, 'recall': 0.503707144516106, 'f1-score': 0.5099813871543071, 'support': 111946}}
[[12678  5191  4274]
 [15676 27311 25175]
 [ 2324  2918 16399]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
5918/5918 - 105s - 105s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9919285
{'0': {'precision': 0.4221684910534232, 'recall': 0.44620478749946535, 'f1-score': 0.43385398075210274, 'support': 280564}, '1': {'precision': 0.784375280477158, 'recall': 0.4013256838460069, 'f1-score': 0.5309769584426219, 'support': 958147}, '2': {'precision': 0.29425019979841643, 'recall': 0.7755531185644433, 'f1-score': 0.42663292621133647, 'support': 276297}, 'accuracy': 0.47788592535484964, 'macro avg': {'precision': 0.5002646571096658, 'recall': 0.5410278633033052, 'f1-score': 0.46382128846868703, 'support': 1515008}, 'weighted avg': {'precision': 0.6279125587726027, 'recall': 0.47788592535484964, 'f1-score': 0.49396121054810893, 'support': 1515008}}
[[125189  70199  85176]
 [144843 384529 428775]
 [ 26506  35508 214283]]
Evaluating performance on  train set...
1814/1814 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9809723
{'0': {'precision': 0.3638694045834226, 'recall': 0.5767435445884874, 'f1-score': 0.446218245988427, 'support': 94262}, '1': {'precision': 0.7414818386370942, 'recall': 0.4695179352231135, 'f1-score': 0.5749613326063493, 'support': 275129}, '2': {'precision': 0.3387508442643347, 'recall': 0.5021393643031785, 'f1-score': 0.40457156442772657, 'support': 94888}, 'accuracy': 0.49795489350153677, 'macro avg': {'precision': 0.48136736249495055, 'recall': 0.5161336147049265, 'f1-score': 0.475250381007501, 'support': 464279}, 'weighted avg': {'precision': 0.5825066494667687, 'recall': 0.49795489350153677, 'f1-score': 0.5139990122047982, 'support': 464279}}
[[ 54365  24192  15705]
 [ 68648 129178  77303]
 [ 26395  20846  47647]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0103164
{'0': {'precision': 0.35301495417269657, 'recall': 0.5151707145371348, 'f1-score': 0.4189494776012595, 'support': 28410}, '1': {'precision': 0.8023137506123525, 'recall': 0.40007892214893737, 'f1-score': 0.5339167941419866, 'support': 106434}, '2': {'precision': 0.282102422713674, 'recall': 0.6900064567042112, 'f1-score': 0.4004746736618575, 'support': 27878}, 'accuracy': 0.46984427428374775, 'macro avg': {'precision': 0.479143709166241, 'recall': 0.5350853644634278, 'f1-score': 0.45111364846836793, 'support': 162722}, 'weighted avg': {'precision': 0.634745565572776, 'recall': 0.46984427428374775, 'f1-score': 0.4909827047277273, 'support': 162722}}
[[14636  6581  7193]
 [22093 42582 41759]
 [ 4731  3911 19236]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
3755/3755 - 68s - 68s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0634906
{'0': {'precision': 0.5194726190058377, 'recall': 0.14280706381035388, 'f1-score': 0.22402728446884085, 'support': 310937}, '1': {'precision': 0.42125694473588216, 'recall': 0.7337496204496126, 'f1-score': 0.5352300716352653, 'support': 355684}, '2': {'precision': 0.44334569588131956, 'recall': 0.3855579170372986, 'f1-score': 0.4124374423452674, 'support': 294542}, 'accuracy': 0.4358782017202077, 'macro avg': {'precision': 0.4613584198743465, 'recall': 0.42070486709908833, 'f1-score': 0.3905649328164578, 'support': 961163}, 'weighted avg': {'precision': 0.45979874467029147, 'recall': 0.4358782017202077, 'f1-score': 0.39692673739382955, 'support': 961163}}
[[ 44404 200927  65606]
 [ 17720 260983  76981]
 [ 23355 157624 113563]]
Evaluating performance on  train set...
1532/1532 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.053954
{'0': {'precision': 0.43685185630759604, 'recall': 0.5511086827846833, 'f1-score': 0.4873734153854413, 'support': 131778}, '1': {'precision': 0.4779593506054733, 'recall': 0.41563964186859237, 'f1-score': 0.4446264039832597, 'support': 129338}, '2': {'precision': 0.4537073759727841, 'recall': 0.3927745774997139, 'f1-score': 0.4210478963554276, 'support': 131065}, 'accuracy': 0.45351763598950484, 'macro avg': {'precision': 0.45617286096195114, 'recall': 0.4531743007176632, 'f1-score': 0.4510159052413762, 'support': 392181}, 'weighted avg': {'precision': 0.4560417961119637, 'recall': 0.45351763598950484, 'f1-score': 0.45111014125333365, 'support': 392181}}
[[72624 30707 28447]
 [42043 53758 33537]
 [51577 28009 51479]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0745865
{'0': {'precision': 0.43568972926514826, 'recall': 0.5091908995027874, 'f1-score': 0.4695815289131794, 'support': 39822}, '1': {'precision': 0.4266384088686012, 'recall': 0.46418345369314584, 'f1-score': 0.44461973471839616, 'support': 39465}, '2': {'precision': 0.45263333890653734, 'recall': 0.3375897845171588, 'f1-score': 0.38673733232382396, 'support': 40096}, 'accuracy': 0.43667858907884705, 'macro avg': {'precision': 0.4383204923467623, 'recall': 0.436988045904364, 'f1-score': 0.4336461986517998, 'support': 119383}, 'weighted avg': {'precision': 0.43838827606604464, 'recall': 0.43667858907884705, 'f1-score': 0.43350572151728617, 'support': 119383}}
[[20277 11826  7719]
 [12496 18319  8650]
 [13767 12793 13536]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
4960/4960 - 90s - 90s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9984614
{'0': {'precision': 0.42556020675977596, 'recall': 0.6232475159583564, 'f1-score': 0.5057730525980031, 'support': 391801}, '1': {'precision': 0.6293894102790607, 'recall': 0.4368100330402367, 'f1-score': 0.5157076583031746, 'support': 486074}, '2': {'precision': 0.4716702740092824, 'recall': 0.4316101121731474, 'f1-score': 0.45075186617141993, 'support': 391805}, 'accuracy': 0.4927367525675761, 'macro avg': {'precision': 0.5088732970160397, 'recall': 0.4972225537239135, 'f1-score': 0.4907441923575326, 'support': 1269680}, 'weighted avg': {'precision': 0.5178214309817261, 'recall': 0.4927367525675761, 'f1-score': 0.49259758916286045, 'support': 1269680}}
[[244189  62873  84739]
 [169070 212322 104682]
 [160547  62151 169107]]
Evaluating performance on  train set...
1691/1691 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0152254
{'0': {'precision': 0.48321746280929956, 'recall': 0.4414938666229544, 'f1-score': 0.46141436637614125, 'support': 146412}, '1': {'precision': 0.5005961092271997, 'recall': 0.4886242482945083, 'f1-score': 0.49453773511717947, 'support': 143507}, '2': {'precision': 0.4671098560368304, 'recall': 0.5196431694944901, 'f1-score': 0.49197811369748673, 'support': 142925}, 'accuracy': 0.48292456404616907, 'macro avg': {'precision': 0.48364114269110986, 'recall': 0.4832537614706509, 'f1-score': 0.48264340506360254, 'support': 432844}, 'weighted avg': {'precision': 0.4836605270854324, 'recall': 0.48292456404616907, 'f1-score': 0.4824883765595409, 'support': 432844}}
[[64640 38234 43538]
 [32195 70121 41191]
 [36935 31720 74270]]
Evaluating performance on  val set...
591/591 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0510628
{'0': {'precision': 0.4865333953200062, 'recall': 0.29846376150277587, 'f1-score': 0.3699697151812965, 'support': 52596}, '1': {'precision': 0.41821834999047336, 'recall': 0.5375949057065883, 'f1-score': 0.4704518442024044, 'support': 44913}, '2': {'precision': 0.4764623135304894, 'recall': 0.5431981351981352, 'f1-score': 0.507646325842403, 'support': 53625}, 'accuracy': 0.45636322733468315, 'macro avg': {'precision': 0.460404686280323, 'recall': 0.4597522674691665, 'f1-score': 0.4493559617420346, 'support': 151134}, 'weighted avg': {'precision': 0.46265858626414746, 'recall': 0.45636322733468315, 'f1-score': 0.4486804097134789, 'support': 151134}}
[[15698 18016 18882]
 [ 7643 24145 13125]
 [ 8924 15572 29129]]
testing model on single stock: results/universal/W8/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
10609/10609 - 189s - 189s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1125317
{'0': {'precision': 0.37931900127531026, 'recall': 0.3995106925830768, 'f1-score': 0.38915310524093794, 'support': 896369}, '1': {'precision': 0.3703310234115961, 'recall': 0.49112642366227577, 'f1-score': 0.42225962922979104, 'support': 897158}, '2': {'precision': 0.4239923135494317, 'recall': 0.2675038361229945, 'f1-score': 0.3280410756151435, 'support': 922155}, 'accuracy': 0.3849519199965239, 'macro avg': {'precision': 0.39121411274544604, 'recall': 0.3860469841227823, 'f1-score': 0.3798179366952908, 'support': 2715682}, 'weighted avg': {'precision': 0.39151928173373224, 'recall': 0.3849519199965239, 'f1-score': 0.37933863475772855, 'support': 2715682}}
[[358109 372642 165618]
 [287035 440618 169505]
 [298940 376535 246680]]
Evaluating performance on  train set...
3903/3903 - 69s - 69s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1355798
{'0': {'precision': 0.3803504070605712, 'recall': 0.5404993081589934, 'f1-score': 0.4464987684232765, 'support': 338228}, '1': {'precision': 0.376554770929181, 'recall': 0.4732963350590223, 'f1-score': 0.4194193353964875, 'support': 321997}, '2': {'precision': 0.44086191732629726, 'recall': 0.14793500138709353, 'f1-score': 0.22153277735792354, 'support': 338838}, 'accuracy': 0.38569940033811684, 'macro avg': {'precision': 0.3992556984386832, 'recall': 0.3872435482017031, 'f1-score': 0.36248362705922926, 'support': 999063}, 'weighted avg': {'precision': 0.3996499063594331, 'recall': 0.38569940033811684, 'f1-score': 0.36147257620423817, 'support': 999063}}
[[182812 120445  34971]
 [140994 152400  28603]
 [156835 131877  50126]]
Evaluating performance on  val set...
1144/1144 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1375339
{'0': {'precision': 0.37244455531401827, 'recall': 0.640704185058035, 'f1-score': 0.4710597285135856, 'support': 97872}, '1': {'precision': 0.3839381903259155, 'recall': 0.3580547605999716, 'f1-score': 0.37054502108353066, 'support': 98538}, '2': {'precision': 0.4097368095885333, 'recall': 0.13784646082537438, 'f1-score': 0.206291068859598, 'support': 96223}, 'accuracy': 0.3801792689136222, 'macro avg': {'precision': 0.38870651840948894, 'recall': 0.3788684688277937, 'f1-score': 0.34929860615223807, 'support': 292633}, 'weighted avg': {'precision': 0.3885771595994508, 'recall': 0.3801792689136222, 'f1-score': 0.35015281446551716, 'support': 292633}}
[[62707 26477  8688]
 [52836 35282 10420]
 [52823 30136 13264]]
training model: results/universal/W8/deepLOB_L2/h100
Epoch 1/50
7696/7696 - 361s - loss: 3.2202 - accuracy100: 0.4023 - val_loss: 3.4085 - val_accuracy100: 0.3529 - 361s/epoch - 47ms/step
Epoch 2/50
7696/7696 - 352s - loss: 3.1705 - accuracy100: 0.4262 - val_loss: 3.4765 - val_accuracy100: 0.3487 - 352s/epoch - 46ms/step
Epoch 3/50
7696/7696 - 351s - loss: 3.1528 - accuracy100: 0.4331 - val_loss: 3.4249 - val_accuracy100: 0.3619 - 351s/epoch - 46ms/step
Epoch 4/50
7696/7696 - 358s - loss: 3.1420 - accuracy100: 0.4368 - val_loss: 3.4495 - val_accuracy100: 0.3571 - 358s/epoch - 46ms/step
Epoch 5/50
7696/7696 - 355s - loss: 3.1341 - accuracy100: 0.4399 - val_loss: 3.4446 - val_accuracy100: 0.3599 - 355s/epoch - 46ms/step
Epoch 6/50
7696/7696 - 356s - loss: 3.1262 - accuracy100: 0.4430 - val_loss: 3.4623 - val_accuracy100: 0.3618 - 356s/epoch - 46ms/step
Epoch 7/50
7696/7696 - 356s - loss: 3.1198 - accuracy100: 0.4454 - val_loss: 3.3871 - val_accuracy100: 0.3650 - 356s/epoch - 46ms/step
Epoch 8/50
7696/7696 - 351s - loss: 3.1131 - accuracy100: 0.4477 - val_loss: 3.3638 - val_accuracy100: 0.3654 - 351s/epoch - 46ms/step
Epoch 9/50
7696/7696 - 349s - loss: 3.1073 - accuracy100: 0.4499 - val_loss: 3.4172 - val_accuracy100: 0.3612 - 349s/epoch - 45ms/step
Epoch 10/50
7696/7696 - 350s - loss: 3.1014 - accuracy100: 0.4518 - val_loss: 3.4117 - val_accuracy100: 0.3695 - 350s/epoch - 45ms/step
Epoch 11/50
7696/7696 - 349s - loss: 3.0960 - accuracy100: 0.4530 - val_loss: 3.3743 - val_accuracy100: 0.3730 - 349s/epoch - 45ms/step
Epoch 12/50
7696/7696 - 348s - loss: 3.0909 - accuracy100: 0.4539 - val_loss: 3.4132 - val_accuracy100: 0.3736 - 348s/epoch - 45ms/step
Epoch 13/50
7696/7696 - 349s - loss: 3.0866 - accuracy100: 0.4552 - val_loss: 3.4179 - val_accuracy100: 0.3753 - 349s/epoch - 45ms/step
Epoch 14/50
7696/7696 - 350s - loss: 3.0820 - accuracy100: 0.4562 - val_loss: 3.4456 - val_accuracy100: 0.3749 - 350s/epoch - 45ms/step
Epoch 15/50
7696/7696 - 350s - loss: 3.0783 - accuracy100: 0.4574 - val_loss: 3.5097 - val_accuracy100: 0.3750 - 350s/epoch - 46ms/step
Epoch 16/50
7696/7696 - 349s - loss: 3.0750 - accuracy100: 0.4584 - val_loss: 3.4712 - val_accuracy100: 0.3735 - 349s/epoch - 45ms/step
Epoch 17/50
7696/7696 - 350s - loss: 3.0711 - accuracy100: 0.4595 - val_loss: 3.4468 - val_accuracy100: 0.3756 - 350s/epoch - 45ms/step
Epoch 18/50
7696/7696 - 348s - loss: 3.0681 - accuracy100: 0.4605 - val_loss: 3.4660 - val_accuracy100: 0.3742 - 348s/epoch - 45ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 407s - 407s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1330838
{'0': {'precision': 0.3352052552983227, 'recall': 0.20655130991761486, 'f1-score': 0.255602198546648, 'support': 1974628}, '1': {'precision': 0.40342402418562595, 'recall': 0.3800792709954237, 'f1-score': 0.39140386507010444, 'support': 2023691}, '2': {'precision': 0.36878970745989254, 'recall': 0.5332018104103179, 'f1-score': 0.43601150516938914, 'support': 1962649}, 'accuracy': 0.3730120678386463, 'macro avg': {'precision': 0.3691396623146137, 'recall': 0.3732774637744522, 'f1-score': 0.36100585626204723, 'support': 5960968}, 'weighted avg': {'precision': 0.36942255022068565, 'recall': 0.3730120678386463, 'f1-score': 0.3611053241400644, 'support': 5960968}}
[[ 407862  591154  975612]
 [ 439000  769163  815528]
 [ 369891  546270 1046488]]
Evaluating performance on  train set...
7696/7696 - 149s - 149s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1254643
{'0': {'precision': 0.33864102381276484, 'recall': 0.4895861479758783, 'f1-score': 0.4003586456528584, 'support': 640253}, '1': {'precision': 0.40233211018114895, 'recall': 0.31138921403530145, 'f1-score': 0.35106665674592624, 'support': 689433}, '2': {'precision': 0.36188872861824056, 'recall': 0.2886132098769291, 'f1-score': 0.32112392416972596, 'support': 639794}, 'accuracy': 0.3619198976379552, 'macro avg': {'precision': 0.3676206208707182, 'recall': 0.36319619062936964, 'f1-score': 0.3575164088561702, 'support': 1969480}, 'weighted avg': {'precision': 0.3684887393501294, 'recall': 0.3619198976379552, 'f1-score': 0.35736383322285037, 'support': 1969480}}
[[313459 161521 165273]
 [314429 214682 160322]
 [297750 157391 184653]]
Evaluating performance on  val set...
2338/2338 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1213038
{'0': {'precision': 0.35048576760167055, 'recall': 0.48922447207665354, 'f1-score': 0.40839376852423087, 'support': 193494}, '1': {'precision': 0.40698261514582956, 'recall': 0.3055264389330838, 'f1-score': 0.34903121132663506, 'support': 213700}, '2': {'precision': 0.3481421696110962, 'recall': 0.305541855120523, 'f1-score': 0.32545389002685476, 'support': 190586}, 'accuracy': 0.36499213757569676, 'macro avg': {'precision': 0.3685368507861988, 'recall': 0.3667642553767534, 'f1-score': 0.36095962329257353, 'support': 597780}, 'weighted avg': {'precision': 0.36993559756178157, 'recall': 0.36499213757569676, 'f1-score': 0.36072914582620286, 'support': 597780}}
[[94662 50825 48007]
 [87383 65291 61026]
 [88043 44311 58232]]
testing model out of sample: results/universal/W8/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 263s - 263s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1224262
{'0': {'precision': 0.34920279762204265, 'recall': 0.3098186867828183, 'f1-score': 0.32833391548031154, 'support': 1052819}, '1': {'precision': 0.5130328848401041, 'recall': 0.3076950083299384, 'f1-score': 0.38467720931157, 'support': 1509615}, '2': {'precision': 0.3202234828040147, 'recall': 0.539904993983838, 'f1-score': 0.4020103094422437, 'support': 1053828}, 'accuracy': 0.37598243711324014, 'macro avg': {'precision': 0.39415305508872045, 'recall': 0.3858062296988649, 'f1-score': 0.37167381141137507, 'support': 3616262}, 'weighted avg': {'precision': 0.409148991714075, 'recall': 0.37598243711324014, 'f1-score': 0.37332482831051866, 'support': 3616262}}
[[326183 236890 489746]
 [327046 464501 718068]
 [280850 204011 568967]]
Evaluating performance on  train set...
4550/4550 - 86s - 86s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.125915
{'0': {'precision': 0.3271509719109907, 'recall': 0.3496595418784377, 'f1-score': 0.3380309750893512, 'support': 359075}, '1': {'precision': 0.4278301361786356, 'recall': 0.3169654895755563, 'f1-score': 0.3641465762684091, 'support': 448705}, '2': {'precision': 0.3390989864714024, 'recall': 0.4262299682072896, 'f1-score': 0.3777046440991109, 'support': 356371}, 'accuracy': 0.3604979079174437, 'macro avg': {'precision': 0.36469336485367626, 'recall': 0.3642849998870945, 'f1-score': 0.35996073181895705, 'support': 1164151}, 'weighted avg': {'precision': 0.36961382277795046, 'recall': 0.3604979079174437, 'f1-score': 0.3602417930379904, 'support': 1164151}}
[[125554  99081 134440]
 [144877 142224 161604]
 [113349  91126 151896]]
Evaluating performance on  val set...
1570/1570 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1283994
{'0': {'precision': 0.32079329916501725, 'recall': 0.20282780397649575, 'f1-score': 0.24852245262708939, 'support': 120659}, '1': {'precision': 0.44014884417773364, 'recall': 0.3393771973882471, 'f1-score': 0.38324949573367645, 'support': 159280}, '2': {'precision': 0.336288138027346, 'recall': 0.5607792293590104, 'f1-score': 0.42044423806206954, 'support': 121094}, 'accuracy': 0.36514700785222165, 'macro avg': {'precision': 0.36574342712336566, 'recall': 0.36766141024125104, 'f1-score': 0.3507387288076118, 'support': 401033}, 'weighted avg': {'precision': 0.3728770010718935, 'recall': 0.36514700785222165, 'f1-score': 0.3539452485353579, 'support': 401033}}
[[24473 36109 60077]
 [31277 54056 73947]
 [20539 32648 67907]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
645/645 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1727468
{'0': {'precision': 0.3138295417839509, 'recall': 0.12047616516979327, 'f1-score': 0.17411228591177902, 'support': 56451}, '1': {'precision': 0.4054323318126999, 'recall': 0.14491612782307187, 'f1-score': 0.21351448374892992, 'support': 53355}, '2': {'precision': 0.3481583482308225, 'recall': 0.7844079973874234, 'f1-score': 0.4822643614054657, 'support': 55118}, 'accuracy': 0.35027042759089033, 'macro avg': {'precision': 0.3558067406091577, 'recall': 0.34993343012676287, 'f1-score': 0.28996371035539154, 'support': 164924}, 'weighted avg': {'precision': 0.3549369731809736, 'recall': 0.35027042759089033, 'f1-score': 0.28984456479576326, 'support': 164924}}
[[ 6801  5996 43654]
 [ 8330  7732 37293]
 [ 6540  5343 43235]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.151271
{'0': {'precision': 0.3468846949327818, 'recall': 0.2810977845283612, 'f1-score': 0.31054534934181977, 'support': 19093}, '1': {'precision': 0.34194884726224783, 'recall': 0.20062348092571067, 'f1-score': 0.2528804528804529, 'support': 18926}, '2': {'precision': 0.3462293151939303, 'recall': 0.5532793310687223, 'f1-score': 0.42592480840021724, 'support': 19135}, 'accuracy': 0.3455751128529937, 'macro avg': {'precision': 0.3450209524629866, 'recall': 0.3450001988409314, 'f1-score': 0.3297835368741633, 'support': 57154}, 'weighted avg': {'precision': 0.3450308169134752, 'recall': 0.3455751128529937, 'f1-score': 0.33007889237738347, 'support': 57154}}
[[ 5367  3791  9935]
 [ 5073  3797 10056]
 [ 5032  3516 10587]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1665746
{'0': {'precision': 0.3259949195596952, 'recall': 0.3179190751445087, 'f1-score': 0.3219063545150502, 'support': 6055}, '1': {'precision': 0.3133147113594041, 'recall': 0.25097892970352415, 'f1-score': 0.2787037995651724, 'support': 5363}, '2': {'precision': 0.3506253553155202, 'recall': 0.42395600618663, 'f1-score': 0.3838195254764683, 'support': 5819}, 'accuracy': 0.3328885536926379, 'macro avg': {'precision': 0.32997832874487315, 'recall': 0.33095133701155427, 'f1-score': 0.328143226518897, 'support': 17237}, 'weighted avg': {'precision': 0.3303646213108691, 'recall': 0.3328885536926379, 'f1-score': 0.3293657406975818, 'support': 17237}}
[[1925 1559 2571]
 [2019 1346 1998]
 [1961 1391 2467]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
2179/2179 - 41s - 41s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1181213
{'0': {'precision': 0.5234833659491194, 'recall': 0.010088375425848868, 'f1-score': 0.019795263936852492, 'support': 159094}, '1': {'precision': 0.5215954748490494, 'recall': 0.4701074642325371, 'f1-score': 0.49451487209171174, 'support': 247152}, '2': {'precision': 0.3181537479026024, 'recall': 0.696965697467235, 'f1-score': 0.4368791275158069, 'support': 151534}, 'accuracy': 0.40052888235505035, 'macro avg': {'precision': 0.45441086290025706, 'recall': 0.39238717904187365, 'f1-score': 0.3170630878481237, 'support': 557780}, 'weighted avg': {'precision': 0.46686424299342827, 'recall': 0.40052888235505035, 'f1-score': 0.34345385115450644, 'support': 557780}}
[[  1605  61113  96376]
 [   995 116188 129969]
 [   466  45454 105614]]
Evaluating performance on  train set...
614/614 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1170617
{'0': {'precision': 0.35699069402399375, 'recall': 0.39312686490379667, 'f1-score': 0.37418836733294814, 'support': 48595}, '1': {'precision': 0.46531661233134236, 'recall': 0.31992277613258946, 'f1-score': 0.37915923369270144, 'support': 61121}, '2': {'precision': 0.33116165718927704, 'recall': 0.4302843511853244, 'f1-score': 0.37427126082206374, 'support': 47371}, 'accuracy': 0.3758490517993214, 'macro avg': {'precision': 0.38448965451487105, 'recall': 0.3811113307405702, 'f1-score': 0.37587295394923775, 'support': 157087}, 'weighted avg': {'precision': 0.3913502600540668, 'recall': 0.3758490517993214, 'f1-score': 0.37614747960988626, 'support': 157087}}
[[19104 11669 17822]
 [18222 19554 23345]
 [16188 10800 20383]]
Evaluating performance on  val set...
190/190 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0955306
{'0': {'precision': 0.31863888665433193, 'recall': 0.2875081657835523, 'f1-score': 0.3022741147741148, 'support': 13777}, '1': {'precision': 0.5381986976984076, 'recall': 0.3917409666823088, 'f1-score': 0.45343689742266646, 'support': 21310}, '2': {'precision': 0.33941216412843145, 'recall': 0.5194091887478661, 'f1-score': 0.4105482385380305, 'support': 13473}, 'accuracy': 0.39759060955518943, 'macro avg': {'precision': 0.3987499161603903, 'recall': 0.39955277373790904, 'f1-score': 0.3887530835782706, 'support': 48560}, 'weighted avg': {'precision': 0.42075375363863576, 'recall': 0.39759060955518943, 'f1-score': 0.3986508892327613, 'support': 48560}}
[[3961 4186 5630]
 [4972 8348 7990]
 [3498 2977 6998]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.126074
{'0': {'precision': 0.24719928541719227, 'recall': 0.5565209382291538, 'f1-score': 0.34233698295113857, 'support': 65144}, '1': {'precision': 0.5709635832173902, 'recall': 0.27311304050506163, 'f1-score': 0.3694868353123387, 'support': 163782}, '2': {'precision': 0.22848152799436938, 'recall': 0.24156295139851466, 'f1-score': 0.23484021049943968, 'support': 68537}, 'accuracy': 0.3279096896084555, 'macro avg': {'precision': 0.34888146554298394, 'recall': 0.35706564337757674, 'f1-score': 0.31555467625430567, 'support': 297463}, 'weighted avg': {'precision': 0.42115001300961213, 'recall': 0.3279096896084555, 'f1-score': 0.33251778132236454, 'support': 297463}}
[[36254 15696 13194]
 [76340 44731 42711]
 [34065 17916 16556]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1271322
{'0': {'precision': 0.360826838359878, 'recall': 0.37788345517779826, 'f1-score': 0.3691582304812092, 'support': 28178}, '1': {'precision': 0.36899239788687027, 'recall': 0.4153070843303604, 'f1-score': 0.3907822467847031, 'support': 27582}, '2': {'precision': 0.3768890046899427, 'recall': 0.3119473797714039, 'f1-score': 0.34135693215339236, 'support': 27822}, 'accuracy': 0.3682850374482544, 'macro avg': {'precision': 0.36890274697889697, 'recall': 0.36837930642652084, 'f1-score': 0.36709913647310155, 'support': 83582}, 'weighted avg': {'precision': 0.3688680919133771, 'recall': 0.3682850374482544, 'f1-score': 0.3670399023197205, 'support': 83582}}
[[10648  9978  7552]
 [ 9330 11455  6797]
 [ 9532  9611  8679]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1114595
{'0': {'precision': 0.31380603679228436, 'recall': 0.36907887826908936, 'f1-score': 0.33920556011390507, 'support': 9521}, '1': {'precision': 0.45548446774069223, 'recall': 0.4661932938856016, 'f1-score': 0.46077666874610107, 'support': 12675}, '2': {'precision': 0.36163233171499803, 'recall': 0.28720300125052106, 'f1-score': 0.3201486902480107, 'support': 9596}, 'accuracy': 0.3830837946653246, 'macro avg': {'precision': 0.3769742787493249, 'recall': 0.3741583911350707, 'f1-score': 0.37337697303600564, 'support': 31792}, 'weighted avg': {'precision': 0.38472687342884165, 'recall': 0.3830837946653246, 'f1-score': 0.3819220950497368, 'support': 31792}}
[[3514 3546 2461]
 [4362 5909 2404]
 [3322 3518 2756]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1223/1223 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.171312
{'0': {'precision': 0.31939791811866275, 'recall': 0.2738998409408589, 'f1-score': 0.29490432968504304, 'support': 103735}, '1': {'precision': 0.33473272104991014, 'recall': 0.24036812419329173, 'f1-score': 0.27980858289595556, 'support': 113114}, '2': {'precision': 0.32173833908532784, 'recall': 0.47783415121018047, 'f1-score': 0.38454941367928275, 'support': 96184}, 'accuracy': 0.3244450265626947, 'macro avg': {'precision': 0.3252896594179669, 'recall': 0.33070070544811037, 'f1-score': 0.31975410875342714, 'support': 313033}, 'weighted avg': {'precision': 0.32565825472541937, 'recall': 0.3244450265626947, 'f1-score': 0.31699427693214194, 'support': 313033}}
[[28413 28780 46542]
 [35578 27189 50347]
 [24967 25257 45960]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1603214
{'0': {'precision': 0.34068542472329644, 'recall': 0.4133445508672017, 'f1-score': 0.37351423266422024, 'support': 30904}, '1': {'precision': 0.3268299246501615, 'recall': 0.2417717319177173, 'f1-score': 0.2779388206575635, 'support': 30140}, '2': {'precision': 0.34254458075123306, 'recall': 0.3566748971193416, 'f1-score': 0.3494669612760673, 'support': 30375}, 'accuracy': 0.3379494415821656, 'macro avg': {'precision': 0.336686643374897, 'recall': 0.3372637266347535, 'f1-score': 0.3336400048659503, 'support': 91419}, 'weighted avg': {'precision': 0.33673511999609845, 'recall': 0.3379494415821656, 'f1-score': 0.3340139232504684, 'support': 91419}}
[[12774  7715 10415]
 [12474  7287 10379]
 [12247  7294 10834]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1379102
{'0': {'precision': 0.3432133950837193, 'recall': 0.5669059668118159, 'f1-score': 0.4275696786792118, 'support': 8497}, '1': {'precision': 0.3467089053150299, 'recall': 0.22724651055485062, 'f1-score': 0.27454532785171765, 'support': 8669}, '2': {'precision': 0.3309871864284425, 'recall': 0.22664359861591696, 'f1-score': 0.2690530330814934, 'support': 8092}, 'accuracy': 0.34131760234381187, 'macro avg': {'precision': 0.3403031622757305, 'recall': 0.3402653586608612, 'f1-score': 0.3237226798708076, 'support': 25258}, 'weighted avg': {'precision': 0.3404961608512675, 'recall': 0.34131760234381187, 'f1-score': 0.3242643974415728, 'support': 25258}}
[[4817 1941 1739]
 [4731 1970 1968]
 [4487 1771 1834]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
1443/1443 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1212027
{'0': {'precision': 0.32105465501980385, 'recall': 0.30468796402358833, 'f1-score': 0.31265726898329144, 'support': 117855}, '1': {'precision': 0.4222981569668109, 'recall': 0.26711068871959165, 'f1-score': 0.327237900291548, 'support': 130474}, '2': {'precision': 0.36831928975533856, 'recall': 0.5327491767197868, 'f1-score': 0.43553138454566054, 'support': 120858}, 'accuracy': 0.36606651913528915, 'macro avg': {'precision': 0.37055736724731775, 'recall': 0.368182609820989, 'f1-score': 0.35847551794016663, 'support': 369187}, 'weighted avg': {'precision': 0.37230768911336903, 'recall': 0.36606651913528915, 'f1-score': 0.35803457952767753, 'support': 369187}}
[[35909 23905 58041]
 [43238 34851 52385]
 [32700 23771 64387]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1423907
{'0': {'precision': 0.3325081329842101, 'recall': 0.503581042107287, 'f1-score': 0.4005429016564236, 'support': 41608}, '1': {'precision': 0.36968960777419047, 'recall': 0.2782188221709007, 'f1-score': 0.31749735762034836, 'support': 41568}, '2': {'precision': 0.3636306807526411, 'recall': 0.26983022543835233, 'f1-score': 0.30978564771668216, 'support': 43116}, 'accuracy': 0.34960250847242896, 'macro avg': {'precision': 0.35527614050368056, 'recall': 0.3505433632388468, 'f1-score': 0.3426086356644847, 'support': 126292}, 'weighted avg': {'precision': 0.3553713334533893, 'recall': 0.34960250847242896, 'f1-score': 0.34222466348332103, 'support': 126292}}
[[20953  9593 11062]
 [20705 11565  9298]
 [21357 10125 11634]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1458727
{'0': {'precision': 0.32909620991253646, 'recall': 0.4529331514324693, 'f1-score': 0.3812096855898146, 'support': 12461}, '1': {'precision': 0.3554325728484301, 'recall': 0.23946126921320957, 'f1-score': 0.2861429350791053, 'support': 13142}, '2': {'precision': 0.3397562582345191, 'recall': 0.3288959744918294, 'f1-score': 0.33423791972133343, 'support': 12545}, 'accuracy': 0.3386022858341197, 'macro avg': {'precision': 0.34142834699849517, 'recall': 0.34043013171250275, 'f1-score': 0.3338635134634178, 'support': 38148}, 'weighted avg': {'precision': 0.34167466193892804, 'recall': 0.3386022858341197, 'f1-score': 0.3330124527589496, 'support': 38148}}
[[5644 2817 4000]
 [5977 3147 4018]
 [5529 2890 4126]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
5521/5521 - 102s - 102s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0970674
{'0': {'precision': 0.30359859283215007, 'recall': 0.3154131642333972, 'f1-score': 0.3093931309994659, 'support': 406860}, '1': {'precision': 0.4925023269485132, 'recall': 0.33697510256616525, 'f1-score': 0.400158018126311, 'support': 596688}, '2': {'precision': 0.373495982704767, 'recall': 0.5308154489679375, 'f1-score': 0.43847159463733687, 'support': 409762}, 'accuracy': 0.3869681810784612, 'macro avg': {'precision': 0.3898656341618101, 'recall': 0.39440123858916665, 'f1-score': 0.38267424792103794, 'support': 1413310}, 'weighted avg': {'precision': 0.4036176159561694, 'recall': 0.3869681810784612, 'f1-score': 0.3851371421414831, 'support': 1413310}}
[[128329 112321 166210]
 [196980 201069 198639]
 [ 97384  94870 217508]]
Evaluating performance on  train set...
1289/1289 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0771939
{'0': {'precision': 0.3422669369151763, 'recall': 0.3377690721222108, 'f1-score': 0.34000312972719204, 'support': 96489}, '1': {'precision': 0.5063782341114809, 'recall': 0.4183445514680283, 'f1-score': 0.45817098599940426, 'support': 137872}, '2': {'precision': 0.3705537037958311, 'recall': 0.4686113936394426, 'f1-score': 0.41385345526102557, 'support': 95369}, 'accuracy': 0.4093045825372274, 'macro avg': {'precision': 0.40639962494082943, 'recall': 0.40824167240989384, 'f1-score': 0.4040091903292073, 'support': 329730}, 'weighted avg': {'precision': 0.41906927045379905, 'recall': 0.4093045825372274, 'f1-score': 0.4107733671208129, 'support': 329730}}
[[32591 30412 33486]
 [37765 57678 42429]
 [24865 25813 44691]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0676932
{'0': {'precision': 0.5244039445762078, 'recall': 0.13220253642571672, 'f1-score': 0.2111691967427365, 'support': 31777}, '1': {'precision': 0.5209624122263528, 'recall': 0.4099709485403165, 'f1-score': 0.45885014609079233, 'support': 49223}, '2': {'precision': 0.356247795211583, 'recall': 0.7505655011956311, 'f1-score': 0.48316605127671747, 'support': 30946}, 'accuracy': 0.42527647258499635, 'macro avg': {'precision': 0.4672047173380478, 'recall': 0.43091299538722144, 'f1-score': 0.38439513137008213, 'support': 111946}, 'weighted avg': {'precision': 0.47640613540844307, 'recall': 0.42527647258499635, 'f1-score': 0.3952652254545076, 'support': 111946}}
[[ 4201 11761 15815]
 [ 2886 20180 26157]
 [  924  6795 23227]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
5918/5918 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1310952
{'0': {'precision': 0.48752441910328287, 'recall': 0.07971682555841511, 'f1-score': 0.1370277617816823, 'support': 385063}, '1': {'precision': 0.6045028383550384, 'recall': 0.3139393729189789, 'f1-score': 0.41325897192306543, 'support': 749632}, '2': {'precision': 0.2917999313093104, 'recall': 0.815396791590085, 'f1-score': 0.429793049157062, 'support': 380313}, 'accuracy': 0.38028908098175057, 'macro avg': {'precision': 0.46127572958921054, 'recall': 0.4030176633558263, 'f1-score': 0.3266932609539366, 'support': 1515008}, 'weighted avg': {'precision': 0.49627301927842576, 'recall': 0.38028908098175057, 'f1-score': 0.34720104090515763, 'support': 1515008}}
[[ 30696  92979 261388]
 [ 23052 235339 491241]
 [  9215  60992 310106]]
Evaluating performance on  train set...
1814/1814 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1289415
{'0': {'precision': 0.3007410752776466, 'recall': 0.35779413201341626, 'f1-score': 0.3267961706478297, 'support': 122836}, '1': {'precision': 0.5087971717503905, 'recall': 0.28489025153758335, 'f1-score': 0.36526055469317176, 'support': 217224}, '2': {'precision': 0.29339982698081524, 'recall': 0.4641479966832771, 'f1-score': 0.35953094356918147, 'support': 124219}, 'accuracy': 0.3521395540181658, 'macro avg': {'precision': 0.36764602466961743, 'recall': 0.3689441267447589, 'f1-score': 0.35052922297006095, 'support': 464279}, 'weighted avg': {'precision': 0.396120911492533, 'recall': 0.3521395540181658, 'f1-score': 0.3535509196616399, 'support': 464279}}
[[43950 32031 46855]
 [63340 61885 91999]
 [38849 27714 57656]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1299131
{'0': {'precision': 0.3267227197952842, 'recall': 0.18243984588298334, 'f1-score': 0.23413835448219403, 'support': 39191}, '1': {'precision': 0.5669966119710357, 'recall': 0.301650507168691, 'f1-score': 0.39379585057135386, 'support': 84883}, '2': {'precision': 0.26900364761337386, 'recall': 0.6659594286897123, 'f1-score': 0.3832140969425358, 'support': 38648}, 'accuracy': 0.3594658374405428, 'macro avg': {'precision': 0.3875743264598979, 'recall': 0.38334992724712885, 'f1-score': 0.3370494339986945, 'support': 162722}, 'weighted avg': {'precision': 0.4383513999237723, 'recall': 0.3594658374405428, 'f1-score': 0.3528296595002213, 'support': 162722}}
[[ 7150 11290 20751]
 [10088 25605 49190]
 [ 4646  8264 25738]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
3755/3755 - 67s - 67s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1276
{'0': {'precision': 0.3520042474117335, 'recall': 0.004193110775915227, 'f1-score': 0.0082875, 'support': 316233}, '1': {'precision': 0.3948525328005424, 'recall': 0.6328275822206809, 'f1-score': 0.4862866762012205, 'support': 346020}, '2': {'precision': 0.3327987846049966, 'recall': 0.44850289384764647, 'f1-score': 0.38208344377278264, 'support': 298910}, 'accuracy': 0.36867732112035106, 'macro avg': {'precision': 0.35988518827242416, 'recall': 0.36184119561474754, 'f1-score': 0.29221920665800105, 'support': 961163}, 'weighted avg': {'precision': 0.3614570237074023, 'recall': 0.36867732112035106, 'f1-score': 0.29661385099589643, 'support': 961163}}
[[  1326 172065 142842]
 [  1121 218971 125928]
 [  1320 163528 134062]]
Evaluating performance on  train set...
1532/1532 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1258514
{'0': {'precision': 0.3524936703531973, 'recall': 0.4494861963190184, 'f1-score': 0.3951247299287787, 'support': 130400}, '1': {'precision': 0.37791100276041323, 'recall': 0.30467268277760784, 'f1-score': 0.3373627629890888, 'support': 130760}, '2': {'precision': 0.3615756841327678, 'recall': 0.33248868501995865, 'f1-score': 0.3464226924636783, 'support': 131021}, 'accuracy': 0.3621159617625535, 'macro avg': {'precision': 0.3639934524154594, 'recall': 0.3622158547055283, 'f1-score': 0.35963672846051525, 'support': 392181}, 'weighted avg': {'precision': 0.36400239951901786, 'recall': 0.3621159617625535, 'f1-score': 0.35959535841983564, 'support': 392181}}
[[58613 33206 38581]
 [52584 39839 38337]
 [55084 32374 43563]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1392553
{'0': {'precision': 0.34313771888310457, 'recall': 0.3768842915063936, 'f1-score': 0.35922017439556087, 'support': 38476}, '1': {'precision': 0.38821700724115704, 'recall': 0.24545171264891297, 'f1-score': 0.3007518796992481, 'support': 41719}, '2': {'precision': 0.34203681078311593, 'recall': 0.4429161988363785, 'f1-score': 0.3859941735050148, 'support': 39188}, 'accuracy': 0.3526297714079894, 'macro avg': {'precision': 0.3577971789691259, 'recall': 0.35508406766389505, 'f1-score': 0.34865540919994126, 'support': 119383}, 'weighted avg': {'precision': 0.358529528809034, 'recall': 0.3526297714079894, 'f1-score': 0.34757681387241945, 'support': 119383}}
[[14501  8377 15598]
 [13688 10240 17791]
 [14071  7760 17357]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
4960/4960 - 89s - 89s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050109
{'0': {'precision': 0.3660462951208159, 'recall': 0.5048983670553296, 'f1-score': 0.4244039482631901, 'support': 428306}, '1': {'precision': 0.42164959183976924, 'recall': 0.3438303279563113, 'f1-score': 0.3787843774753319, 'support': 412372}, '2': {'precision': 0.392878823254728, 'recall': 0.3137887469056088, 'f1-score': 0.3489079132551105, 'support': 429002}, 'accuracy': 0.3880135152164325, 'macro avg': {'precision': 0.39352490340510443, 'recall': 0.38750581397241657, 'f1-score': 0.38403207966454417, 'support': 1269680}, 'weighted avg': {'precision': 0.39317159512482697, 'recall': 0.3880135152164325, 'f1-score': 0.38407868232573594, 'support': 1269680}}
[[216251  98525 113530]
 [176092 141786  94494]
 [198432  95954 134616]]
Evaluating performance on  train set...
1691/1691 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.113977
{'0': {'precision': 0.34550689732366857, 'recall': 0.3037323561346363, 'f1-score': 0.323275659707551, 'support': 147360}, '1': {'precision': 0.3912701648127657, 'recall': 0.3747986471880339, 'f1-score': 0.38285732602493827, 'support': 143405}, '2': {'precision': 0.38326915080182966, 'recall': 0.4476171707289606, 'f1-score': 0.4129514434502552, 'support': 142079}, 'accuracy': 0.37450675070002126, 'macro avg': {'precision': 0.37334873764608795, 'recall': 0.37538272468387696, 'f1-score': 0.3730281430609148, 'support': 432844}, 'weighted avg': {'precision': 0.37306394925507486, 'recall': 0.37450675070002126, 'f1-score': 0.37245123921569845, 'support': 432844}}
[[44758 43566 59036]
 [46357 53748 43300]
 [38428 40054 63597]]
Evaluating performance on  val set...
591/591 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1202904
{'0': {'precision': 0.31262356662712537, 'recall': 0.11837697216971421, 'f1-score': 0.171728004561313, 'support': 53431}, '1': {'precision': 0.3503016812137543, 'recall': 0.41511442256519426, 'f1-score': 0.3799639944932754, 'support': 43217}, '2': {'precision': 0.41360790071402576, 'recall': 0.6049260360459567, 'f1-score': 0.4912986771008011, 'support': 54486}, 'accuracy': 0.37863750049624834, 'macro avg': {'precision': 0.35884438285163517, 'recall': 0.37947247692695507, 'f1-score': 0.34766355871846316, 'support': 151134}, 'weighted avg': {'precision': 0.3598039992574349, 'recall': 0.37863750049624834, 'f1-score': 0.3464832710193977, 'support': 151134}}
[[ 6325 16709 30397]
 [ 8945 17940 16332]
 [ 4962 16564 32960]]
testing model on single stock: results/universal/W8/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
10609/10609 - 196s - 196s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1524777
{'0': {'precision': 0.35529326093313685, 'recall': 0.25068523909028567, 'f1-score': 0.2939601852565661, 'support': 988706}, '1': {'precision': 0.3228240244333226, 'recall': 0.2865715669257142, 'f1-score': 0.30361948079344414, 'support': 720717}, '2': {'precision': 0.39450524415655275, 'recall': 0.5403628688041549, 'f1-score': 0.4560557420566941, 'support': 1006259}, 'accuracy': 0.3675452427787937, 'macro avg': {'precision': 0.3575408431743374, 'recall': 0.35920655827338493, 'f1-score': 0.3512118027022348, 'support': 2715682}, 'weighted avg': {'precision': 0.3612056911455014, 'recall': 0.3675452427787937, 'f1-score': 0.3565859755337753, 'support': 2715682}}
[[247854 216575 524277]
 [203906 206537 310274]
 [245844 216670 543745]]
Evaluating performance on  train set...
3903/3903 - 68s - 68s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.13963
{'0': {'precision': 0.3315458547603836, 'recall': 0.5688946130921181, 'f1-score': 0.4189386361455722, 'support': 333865}, '1': {'precision': 0.3618549941226801, 'recall': 0.2746404078412332, 'f1-score': 0.3122724935910043, 'support': 329540}, '2': {'precision': 0.3682408064745137, 'recall': 0.19316685435770933, 'f1-score': 0.25340558455288203, 'support': 335658}, 'accuracy': 0.3456008279758133, 'macro avg': {'precision': 0.35388055178585914, 'recall': 0.3455672917636869, 'f1-score': 0.3282055714298195, 'support': 999063}, 'weighted avg': {'precision': 0.35387180206091684, 'recall': 0.3456008279758133, 'f1-score': 0.3281403044598512, 'support': 999063}}
[[189934  78694  65237]
 [193035  90505  46000]
 [189905  80915  64838]]
Evaluating performance on  val set...
1144/1144 - 20s - 20s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1375792
{'0': {'precision': 0.34713374153379517, 'recall': 0.6665048976398229, 'f1-score': 0.45650654962588105, 'support': 100967}, '1': {'precision': 0.3295541054921153, 'recall': 0.2612875758522942, 'f1-score': 0.29147704386824497, 'support': 92779}, '2': {'precision': 0.34873482985642895, 'recall': 0.08891967599381112, 'f1-score': 0.14170715787946914, 'support': 98887}, 'accuracy': 0.3428526516148213, 'macro avg': {'precision': 0.3418075589607798, 'recall': 0.3389040498286427, 'f1-score': 0.2965635837911984, 'support': 292633}, 'weighted avg': {'precision': 0.34210117777184507, 'recall': 0.3428526516148213, 'f1-score': 0.2978066081759586, 'support': 292633}}
[[67295 24634  9038]
 [61154 24242  7383]
 [65410 24684  8793]]
training model: results/universal/W8/deepLOB_L2/h200
Epoch 1/50
7696/7696 - 362s - loss: 3.2296 - accuracy200: 0.4026 - val_loss: 3.3896 - val_accuracy200: 0.3330 - 362s/epoch - 47ms/step
Epoch 2/50
7696/7696 - 348s - loss: 3.2043 - accuracy200: 0.4182 - val_loss: 3.4484 - val_accuracy200: 0.3341 - 348s/epoch - 45ms/step
Epoch 3/50
7696/7696 - 351s - loss: 3.1914 - accuracy200: 0.4238 - val_loss: 3.4015 - val_accuracy200: 0.3341 - 351s/epoch - 46ms/step
Epoch 4/50
7696/7696 - 348s - loss: 3.1826 - accuracy200: 0.4280 - val_loss: 3.4325 - val_accuracy200: 0.3357 - 348s/epoch - 45ms/step
Epoch 5/50
7696/7696 - 349s - loss: 3.1771 - accuracy200: 0.4308 - val_loss: 3.4928 - val_accuracy200: 0.3360 - 349s/epoch - 45ms/step
Epoch 6/50
7696/7696 - 349s - loss: 3.1696 - accuracy200: 0.4337 - val_loss: 3.4826 - val_accuracy200: 0.3358 - 349s/epoch - 45ms/step
Epoch 7/50
7696/7696 - 349s - loss: 3.1649 - accuracy200: 0.4354 - val_loss: 3.5002 - val_accuracy200: 0.3351 - 349s/epoch - 45ms/step
Epoch 8/50
7696/7696 - 349s - loss: 3.1607 - accuracy200: 0.4372 - val_loss: 3.5103 - val_accuracy200: 0.3357 - 349s/epoch - 45ms/step
Epoch 9/50
7696/7696 - 350s - loss: 3.1558 - accuracy200: 0.4394 - val_loss: 3.5228 - val_accuracy200: 0.3361 - 350s/epoch - 45ms/step
Epoch 10/50
7696/7696 - 349s - loss: 3.1525 - accuracy200: 0.4408 - val_loss: 3.5199 - val_accuracy200: 0.3366 - 349s/epoch - 45ms/step
Epoch 11/50
7696/7696 - 350s - loss: 3.1487 - accuracy200: 0.4421 - val_loss: 3.5411 - val_accuracy200: 0.3360 - 350s/epoch - 45ms/step
testing model in sample: results/universal/W8/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 408s - 408s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1591413
{'0': {'precision': 0.3508219854653214, 'recall': 0.01197320729382687, 'f1-score': 0.023156119149554476, 'support': 2076386}, '1': {'precision': 0.3109897568527941, 'recall': 0.949482642141356, 'f1-score': 0.4685217641435387, 'support': 1845821}, '2': {'precision': 0.36502662707950423, 'recall': 0.04558945359460967, 'f1-score': 0.08105559065644773, 'support': 2038761}, 'accuracy': 0.313771521672319, 'macro avg': {'precision': 0.34227945646587327, 'recall': 0.3356817676765975, 'f1-score': 0.19091115798318029, 'support': 5960968}, 'weighted avg': {'precision': 0.3433461367931207, 'recall': 0.313771521672319, 'f1-score': 0.18086682060564452, 'support': 5960968}}
[[  24861 1960673   90852]
 [  22416 1752575   70830]
 [  23588 1922227   92946]]
Evaluating performance on  train set...
7696/7696 - 139s - 139s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1309597
{'0': {'precision': 0.34119539811189026, 'recall': 0.05109439279950906, 'f1-score': 0.08887904858299596, 'support': 659955}, '1': {'precision': 0.3281668897845, 'recall': 0.8630816536971607, 'f1-score': 0.47552599073246304, 'support': 645874}, '2': {'precision': 0.3421978290319017, 'recall': 0.08868667417061075, 'f1-score': 0.14086553189859843, 'support': 663651}, 'accuracy': 0.3300460019903731, 'macro avg': {'precision': 0.337186705642764, 'recall': 0.33428757355576016, 'f1-score': 0.23509019040468582, 'support': 1969480}, 'weighted avg': {'precision': 0.33726059780675977, 'recall': 0.3300460019903731, 'f1-score': 0.2331943443731171, 'support': 1969480}}
[[ 33720 569593  56642]
 [ 31934 557442  56498]
 [ 33175 571619  58857]]
Evaluating performance on  val set...
2338/2338 - 42s - 42s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1321036
{'0': {'precision': 0.33933130699088143, 'recall': 0.055771478813432314, 'f1-score': 0.09579790109578933, 'support': 200174}, '1': {'precision': 0.33321809132189023, 'recall': 0.8638509876574119, 'f1-score': 0.4809259254097058, 'support': 199715}, '2': {'precision': 0.32565936047868616, 'recall': 0.07755784750190761, 'f1-score': 0.12527956901477427, 'support': 197891}, 'accuracy': 0.33295861353675266, 'macro avg': {'precision': 0.332736252930486, 'recall': 0.3323934379909173, 'f1-score': 0.23400113184008978, 'support': 597780}, 'weighted avg': {'precision': 0.33276291053302504, 'recall': 0.33295861353675266, 'f1-score': 0.23422675472423068, 'support': 597780}}
[[ 11164 173692  15318]
 [ 10728 172524  16463]
 [ 11008 171535  15348]]
testing model out of sample: results/universal/W8/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 254s - 254s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1281458
{'0': {'precision': 0.31785355588502556, 'recall': 0.034685067485228226, 'f1-score': 0.06254504502738188, 'support': 1149659}, '1': {'precision': 0.3617857161229295, 'recall': 0.9154320812778179, 'f1-score': 0.5186120202223942, 'support': 1306039}, '2': {'precision': 0.3306898348888065, 'recall': 0.05303197410914004, 'f1-score': 0.09140546276363891, 'support': 1160564}, 'accuracy': 0.358661236381656, 'macro avg': {'precision': 0.33677636896558716, 'recall': 0.3343830409573954, 'f1-score': 0.22418750933780499, 'support': 3616262}, 'weighted avg': {'precision': 0.3378395076580707, 'recall': 0.358661236381656, 'f1-score': 0.23651905964976822, 'support': 3616262}}
[[  39876 1049507   60276]
 [  46155 1195590   64294]
 [  39423 1059594   61547]]
Evaluating performance on  train set...
4550/4550 - 83s - 83s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1344174
{'0': {'precision': 0.3254161769607241, 'recall': 0.04808325341489334, 'f1-score': 0.08378630450050473, 'support': 385810}, '1': {'precision': 0.3401066179581523, 'recall': 0.8836738561843751, 'f1-score': 0.4911719592772384, 'support': 395715}, '2': {'precision': 0.34329699824021676, 'recall': 0.07086815846283316, 'f1-score': 0.11748369305023906, 'support': 382626}, 'accuracy': 0.33960371120241273, 'macro avg': {'precision': 0.3362732643863644, 'recall': 0.3342084226873672, 'f1-score': 0.2308139856093274, 'support': 1164151}, 'weighted avg': {'precision': 0.3362866696907776, 'recall': 0.33960371120241273, 'f1-score': 0.2333391643710935, 'support': 1164151}}
[[ 18551 340805  26454]
 [ 20615 349683  25417]
 [ 17841 337669  27116]]
Evaluating performance on  val set...
1570/1570 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1415652
{'0': {'precision': 0.31494787976925415, 'recall': 0.023761529533931954, 'f1-score': 0.04418916712223729, 'support': 130968}, '1': {'precision': 0.34578567112137887, 'recall': 0.92727051096356, 'f1-score': 0.503727738738879, 'support': 139462}, '2': {'precision': 0.3349644646394035, 'recall': 0.04402655375450794, 'f1-score': 0.07782417151093937, 'support': 130603}, 'accuracy': 0.34456266691269793, 'macro avg': {'precision': 0.3318993385100122, 'recall': 0.33168619808399996, 'f1-score': 0.20858035912401854, 'support': 401033}, 'weighted avg': {'precision': 0.3321906655034609, 'recall': 0.34456266691269793, 'f1-score': 0.21495067740437804, 'support': 401033}}
[[  3112 122806   5050]
 [  3777 129319   6366]
 [  2992 121861   5750]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
645/645 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1549649
{'0': {'precision': 0.3251057827926657, 'recall': 0.025134029986369832, 'f1-score': 0.046660706152263025, 'support': 55025}, '1': {'precision': 0.32966439985957063, 'recall': 0.9287336532473717, 'f1-score': 0.4866034585340575, 'support': 54598}, '2': {'precision': 0.3130105017502917, 'recall': 0.03880580821323303, 'f1-score': 0.0690509516225043, 'support': 55301}, 'accuracy': 0.3288545026800223, 'macro avg': {'precision': 0.32259356146750934, 'recall': 0.33089116381565814, 'f1-score': 0.20077170543627496, 'support': 164924}, 'weighted avg': {'precision': 0.32255921733035914, 'recall': 0.3288545026800223, 'f1-score': 0.1998112322084527, 'support': 164924}}
[[ 1383 51272  2370]
 [ 1551 50707  2340]
 [ 1320 51835  2146]]
Evaluating performance on  train set...
224/224 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1423588
{'0': {'precision': 0.3236196319018405, 'recall': 0.03309976992261033, 'f1-score': 0.06005692599620493, 'support': 19124}, '1': {'precision': 0.3314847153192224, 'recall': 0.9168789808917197, 'f1-score': 0.48692759791969104, 'support': 18840}, '2': {'precision': 0.3488824101068999, 'recall': 0.05612298071912455, 'f1-score': 0.09669165507025185, 'support': 19190}, 'accuracy': 0.3321552297302026, 'macro avg': {'precision': 0.3346622524426543, 'recall': 0.33536724384448485, 'f1-score': 0.21455872632871595, 'support': 57154}, 'weighted avg': {'precision': 0.3346944628032396, 'recall': 0.3321552297302026, 'f1-score': 0.21306920702586934, 'support': 57154}}
[[  633 17416  1075]
 [  631 17274   935]
 [  692 17421  1077]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1622298
{'0': {'precision': 0.32653061224489793, 'recall': 0.0078252363873492, 'f1-score': 0.015284190415538924, 'support': 6134}, '1': {'precision': 0.3050449038635405, 'recall': 0.9643673780487805, 'f1-score': 0.46348276019964285, 'support': 5248}, '2': {'precision': 0.35671342685370744, 'recall': 0.030401366353543978, 'f1-score': 0.05602769908718918, 'support': 5855}, 'accuracy': 0.3067239078725996, 'macro avg': {'precision': 0.32942964765404864, 'recall': 0.33419799359655794, 'f1-score': 0.17826488323412362, 'support': 17237}, 'weighted avg': {'precision': 0.3302414309459025, 'recall': 0.3067239078725996, 'f1-score': 0.1655829278698227, 'support': 17237}}
[[  48 5904  182]
 [  48 5061  139]
 [  51 5626  178]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
2179/2179 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1615137
{'0': {'precision': 0.36363636363636365, 'recall': 2.086735146358386e-05, 'f1-score': 4.173230810963077e-05, 'support': 191687}, '1': {'precision': 0.33362270873461564, 'recall': 0.9914754556546324, 'f1-score': 0.49925165704511437, 'support': 186051}, '2': {'precision': 0.33250927070457353, 'recall': 0.008964574932515746, 'f1-score': 0.01745846313603323, 'support': 180042}, 'accuracy': 0.333613611101151, 'macro avg': {'precision': 0.3432561143585176, 'recall': 0.3334869659795372, 'f1-score': 0.1722506174964191, 'support': 557780}, 'weighted avg': {'precision': 0.3435778198130812, 'recall': 0.333613611101151, 'f1-score': 0.17217814587432836, 'support': 557780}}
[[     4 190024   1659]
 [     5 184465   1581]
 [     2 178426   1614]]
Evaluating performance on  train set...
614/614 - 12s - 12s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1429667
{'0': {'precision': 0.35953324526640246, 'recall': 0.059854121614191985, 'f1-score': 0.10262372348782405, 'support': 54566}, '1': {'precision': 0.3211685685396504, 'recall': 0.8831099195710456, 'f1-score': 0.4710324921219182, 'support': 50355}, '2': {'precision': 0.3420308079220371, 'recall': 0.06256948970593873, 'f1-score': 0.10578683822457016, 'support': 52166}, 'accuracy': 0.32465449082355635, 'macro avg': {'precision': 0.3409108739093633, 'recall': 0.3351778436303921, 'f1-score': 0.2264810179447708, 'support': 157087}, 'weighted avg': {'precision': 0.3414229914383851, 'recall': 0.32465449082355635, 'f1-score': 0.22176935990539465, 'support': 157087}}
[[ 3266 48023  3277]
 [ 2884 44469  3002]
 [ 2934 45968  3264]]
Evaluating performance on  val set...
190/190 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1305093
{'0': {'precision': 0.3252623083131558, 'recall': 0.024778652238071814, 'f1-score': 0.04604924870022281, 'support': 16264}, '1': {'precision': 0.3474285456269472, 'recall': 0.9186365807067812, 'f1-score': 0.5041771778658716, 'support': 16752}, '2': {'precision': 0.3508424182358771, 'recall': 0.06832218219248584, 'f1-score': 0.1143718701200797, 'support': 15544}, 'accuracy': 0.34707578253706756, 'macro avg': {'precision': 0.34117775739199335, 'recall': 0.3372458050457796, 'f1-score': 0.221532765562058, 'support': 48560}, 'weighted avg': {'precision': 0.34109727610803664, 'recall': 0.34707578253706756, 'f1-score': 0.22596205546985224, 'support': 48560}}
[[  403 14843  1018]
 [  416 15389   947]
 [  420 14062  1062]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
1162/1162 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0704914
{'0': {'precision': 0.2867169100329722, 'recall': 0.07804546561870937, 'f1-score': 0.12269332715197083, 'support': 77993}, '1': {'precision': 0.4669889195796425, 'recall': 0.8615274228857178, 'f1-score': 0.6056737844188399, 'support': 136583}, '2': {'precision': 0.3125283423341716, 'recall': 0.09146186977451229, 'f1-score': 0.14151049055476742, 'support': 82887}, 'accuracy': 0.44152718153182074, 'macro avg': {'precision': 0.35541139064892874, 'recall': 0.3436782527596465, 'f1-score': 0.28995920070852604, 'support': 297463}, 'weighted avg': {'precision': 0.37668280182140434, 'recall': 0.44152718153182074, 'f1-score': 0.34970178876853614, 'support': 297463}}
[[  6087  65171   6735]
 [  8972 117670   9941]
 [  6171  69135   7581]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1425177
{'0': {'precision': 0.3637713437268003, 'recall': 0.050974408766211246, 'f1-score': 0.08941877794336811, 'support': 28838}, '1': {'precision': 0.32375751395448693, 'recall': 0.8938321911465086, 'f1-score': 0.475340563222127, 'support': 26995}, '2': {'precision': 0.3379214043486934, 'recall': 0.06104724494576381, 'f1-score': 0.10341249007997069, 'support': 27749}, 'accuracy': 0.32654159986599984, 'macro avg': {'precision': 0.3418167540099935, 'recall': 0.3352846149528279, 'f1-score': 0.22272394374848858, 'support': 83582}, 'weighted avg': {'precision': 0.34226571688720936, 'recall': 0.32654159986599984, 'f1-score': 0.21870821958963982, 'support': 83582}}
[[ 1470 25582  1786]
 [ 1333 24129  1533]
 [ 1238 24817  1694]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1236428
{'0': {'precision': 0.29694323144104806, 'recall': 0.02694937085108491, 'f1-score': 0.049414115723498964, 'support': 10093}, '1': {'precision': 0.3616085345156039, 'recall': 0.9034267912772586, 'f1-score': 0.5164865065426572, 'support': 11556}, '2': {'precision': 0.2947630922693267, 'recall': 0.05826678497485951, 'f1-score': 0.09729996707276918, 'support': 10143}, 'accuracy': 0.35552969300452947, 'macro avg': {'precision': 0.31777161940865956, 'recall': 0.329547649034401, 'f1-score': 0.2210668631129751, 'support': 31792}, 'weighted avg': {'precision': 0.3197527146667274, 'recall': 0.35552969300452947, 'f1-score': 0.23446679370984272, 'support': 31792}}
[[  272  9196   625]
 [  327 10440   789]
 [  317  9235   591]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1223/1223 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1330633
{'0': {'precision': 0.2968249547416794, 'recall': 0.041602826220613065, 'f1-score': 0.07297720639213907, 'support': 102469}, '1': {'precision': 0.35941522258499814, 'recall': 0.8904502311139338, 'f1-score': 0.5121213120492716, 'support': 113364}, '2': {'precision': 0.3497642039074781, 'recall': 0.06409465020576131, 'f1-score': 0.10833652140646192, 'support': 97200}, 'accuracy': 0.35599441592419967, 'macro avg': {'precision': 0.3353347937447186, 'recall': 0.33204923584676943, 'f1-score': 0.23114501328262418, 'support': 313033}, 'weighted avg': {'precision': 0.335930027186775, 'recall': 0.35599441592419967, 'f1-score': 0.24299141515960881, 'support': 313033}}
[[  4263  92824   5382]
 [  6219 100945   6200]
 [  3880  87090   6230]]
Evaluating performance on  train set...
358/358 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1431491
{'0': {'precision': 0.3126147390506163, 'recall': 0.03946758492815045, 'f1-score': 0.07008672644421579, 'support': 30202}, '1': {'precision': 0.3279869393452225, 'recall': 0.8690110615816411, 'f1-score': 0.47623183685286713, 'support': 30285}, '2': {'precision': 0.3181262729124236, 'recall': 0.07574679943100995, 'f1-score': 0.12235945374311302, 'support': 30932}, 'accuracy': 0.32655137334689727, 'macro avg': {'precision': 0.3195759837694208, 'recall': 0.3280751486469338, 'f1-score': 0.22289267234673202, 'support': 91419}, 'weighted avg': {'precision': 0.31957204389244975, 'recall': 0.32655137334689727, 'f1-score': 0.2223199019278187, 'support': 91419}}
[[ 1192 26547  2463]
 [ 1408 26318  2559]
 [ 1213 27376  2343]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1198301
{'0': {'precision': 0.32511978097193706, 'recall': 0.05603397428335496, 'f1-score': 0.09559267458241096, 'support': 8477}, '1': {'precision': 0.3431420953885652, 'recall': 0.8021698984302862, 'f1-score': 0.48066947921709663, 'support': 8664}, '2': {'precision': 0.33220434659892745, 'recall': 0.14500431193790808, 'f1-score': 0.20188679245283017, 'support': 8117}, 'accuracy': 0.340565365428775, 'macro avg': {'precision': 0.3334887409864766, 'recall': 0.3344027282171831, 'f1-score': 0.2593829820841126, 'support': 25258}, 'weighted avg': {'precision': 0.33357851686947243, 'recall': 0.340565365428775, 'f1-score': 0.26184078568024566, 'support': 25258}}
[[ 475 6909 1093]
 [ 441 6950 1273]
 [ 545 6395 1177]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
1443/1443 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1475836
{'0': {'precision': 0.308092819952433, 'recall': 0.039423899453839575, 'f1-score': 0.06990294094054678, 'support': 121576}, '1': {'precision': 0.3291472650855062, 'recall': 0.9037840937013678, 'f1-score': 0.48255413498815947, 'support': 122090}, '2': {'precision': 0.34081887879941275, 'recall': 0.049935867305072455, 'f1-score': 0.08710878870420813, 'support': 125521}, 'accuracy': 0.3288414814172763, 'macro avg': {'precision': 0.32601965461245064, 'recall': 0.33104795348675997, 'f1-score': 0.21318862154430476, 'support': 369187}, 'weighted avg': {'precision': 0.3261821482300502, 'recall': 0.3288414814172763, 'f1-score': 0.2122164013235385, 'support': 369187}}
[[  4793 110687   6096]
 [  5720 110343   6027]
 [  5044 114209   6268]]
Evaluating performance on  train set...
494/494 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1257497
{'0': {'precision': 0.33365837802697873, 'recall': 0.04955107163545086, 'f1-score': 0.08628769570242724, 'support': 41432}, '1': {'precision': 0.3308809275447941, 'recall': 0.8617589075347406, 'f1-score': 0.4781654582685779, 'support': 41594}, '2': {'precision': 0.34928027095681624, 'recall': 0.09534045208708918, 'f1-score': 0.14979301329072553, 'support': 43266}, 'accuracy': 0.33273683210337945, 'macro avg': {'precision': 0.33793985884286304, 'recall': 0.33555014375242687, 'f1-score': 0.2380820557539102, 'support': 126292}, 'weighted avg': {'precision': 0.338095488407259, 'recall': 0.33273683210337945, 'f1-score': 0.23710789592850479, 'support': 126292}}
[[ 2053 35560  3819]
 [ 1884 35844  3866]
 [ 2216 36925  4125]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1420383
{'0': {'precision': 0.30632008154943935, 'recall': 0.04720760348755008, 'f1-score': 0.0818076635132376, 'support': 12731}, '1': {'precision': 0.3224872829328188, 'recall': 0.891321913380737, 'f1-score': 0.4736164183590228, 'support': 12376}, '2': {'precision': 0.3373737373737374, 'recall': 0.05122306571581934, 'f1-score': 0.08894214765994274, 'support': 13041}, 'accuracy': 0.3224284366152878, 'macro avg': {'precision': 0.3220603672853319, 'recall': 0.32991752752803544, 'f1-score': 0.21478874317740107, 'support': 38148}, 'weighted avg': {'precision': 0.3221808346669127, 'recall': 0.3224284366152878, 'f1-score': 0.21135746842381267, 'support': 38148}}
[[  601 11420   710]
 [  743 11031   602]
 [  618 11755   668]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
5521/5521 - 98s - 98s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1491197
{'0': {'precision': 0.33434311224489793, 'recall': 0.00873822818568214, 'f1-score': 0.01703133375566493, 'support': 479960}, '1': {'precision': 0.32559381897793155, 'recall': 0.9476476668571154, 'f1-score': 0.48466567627613155, 'support': 458566}, '2': {'precision': 0.36750378214826024, 'recall': 0.051164318932398735, 'f1-score': 0.08982332625849536, 'support': 474784}, 'accuracy': 0.3276315882573533, 'macro avg': {'precision': 0.34248023779036324, 'recall': 0.33585007132506545, 'f1-score': 0.19717344543009727, 'support': 1413310}, 'weighted avg': {'precision': 0.3426442118501779, 'recall': 0.3276315882573533, 'f1-score': 0.19321467872648104, 'support': 1413310}}
[[  4194 453435  22331]
 [  4530 434559  19477]
 [  3820 446672  24292]]
Evaluating performance on  train set...
1289/1289 - 24s - 24s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.13961
{'0': {'precision': 0.36079545454545453, 'recall': 0.02066590126291619, 'f1-score': 0.0390926269527075, 'support': 110617}, '1': {'precision': 0.33121502325214786, 'recall': 0.9242464510571222, 'f1-score': 0.48766818582947496, 'support': 109117}, '2': {'precision': 0.3581931661906273, 'recall': 0.061565875122731734, 'f1-score': 0.10507207025492234, 'support': 109996}, 'accuracy': 0.333330300548934, 'macro avg': {'precision': 0.35006788132940986, 'recall': 0.33549274248092337, 'f1-score': 0.2106109610123683, 'support': 329730}, 'weighted avg': {'precision': 0.35013834348091893, 'recall': 0.333330300548934, 'f1-score': 0.20954934640021503, 'support': 329730}}
[[  2286 102480   5851]
 [  1983 100851   6283]
 [  2067 101157   6772]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.149937
{'0': {'precision': 0.4563279857397504, 'recall': 0.006864559032526211, 'f1-score': 0.013525651186136207, 'support': 37293}, '1': {'precision': 0.34054236792573506, 'recall': 0.976805744836985, 'f1-score': 0.505020257178087, 'support': 38156}, '2': {'precision': 0.3780299123259412, 'recall': 0.020083842507603363, 'f1-score': 0.038141325840357995, 'support': 36497}, 'accuracy': 0.34177192574991516, 'macro avg': {'precision': 0.39163342199714224, 'recall': 0.33458471545903823, 'f1-score': 0.18556241140152707, 'support': 111946}, 'weighted avg': {'precision': 0.3913362860033117, 'recall': 0.34177192574991516, 'f1-score': 0.18907338370077725, 'support': 111946}}
[[  256 36502   535]
 [  214 37271   671]
 [   91 35673   733]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
5918/5918 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1343493
{'0': {'precision': 0.5228726020659125, 'recall': 0.002209639265476829, 'f1-score': 0.004400681422542005, 'support': 481074}, '1': {'precision': 0.36768305879037494, 'recall': 0.9799171314397425, 'f1-score': 0.5347267399648102, 'support': 556544}, '2': {'precision': 0.3136397281475002, 'recall': 0.019527011458136952, 'f1-score': 0.036765053873700486, 'support': 477390}, 'accuracy': 0.36683106623859413, 'macro avg': {'precision': 0.4013984630012626, 'recall': 0.3338845940544521, 'f1-score': 0.1919641584203509, 'support': 1515008}, 'weighted avg': {'precision': 0.39993233320089555, 'recall': 0.36683106623859413, 'f1-score': 0.2094162415316679, 'support': 1515008}}
[[  1063 470257   9754]
 [   531 545367  10646]
 [   439 467629   9322]]
Evaluating performance on  train set...
1814/1814 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.126522
{'0': {'precision': 0.31862861484400967, 'recall': 0.04519370655746538, 'f1-score': 0.0791595637376055, 'support': 148472}, '1': {'precision': 0.35657428388821105, 'recall': 0.8885135338935507, 'f1-score': 0.5089136244823638, 'support': 165769}, '2': {'precision': 0.3416235575009948, 'recall': 0.0686626054732801, 'f1-score': 0.11434342985892983, 'support': 150038}, 'accuracy': 0.3538820407556663, 'macro avg': {'precision': 0.33894215207773853, 'recall': 0.33412328197476543, 'f1-score': 0.23413887269296638, 'support': 464279}, 'weighted avg': {'precision': 0.33960809230940653, 'recall': 0.3538820407556663, 'f1-score': 0.24397170859168918, 'support': 464279}}
[[  6710 131973   9789]
 [  8416 147288  10065]
 [  5933 133803  10302]]
Evaluating performance on  val set...
636/636 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093197
{'0': {'precision': 0.33473980309423346, 'recall': 0.009674010243069669, 'f1-score': 0.01880456682337139, 'support': 49204}, '1': {'precision': 0.40053416775224043, 'recall': 0.9393864955322873, 'f1-score': 0.5616099497464374, 'support': 65134}, '2': {'precision': 0.32767302962876216, 'recall': 0.05782903439153439, 'f1-score': 0.09830824095708238, 'support': 48384}, 'accuracy': 0.39613574071115154, 'macro avg': {'precision': 0.3543156668250787, 'recall': 0.3356298467222971, 'f1-score': 0.22624091917563038, 'support': 162722}, 'weighted avg': {'precision': 0.35897458007756244, 'recall': 0.39613574071115154, 'f1-score': 0.25971723739401614, 'support': 162722}}
[[  476 46379  2349]
 [  556 61186  3392]
 [  390 45196  2798]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
3755/3755 - 73s - 73s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119522
{'0': {'precision': 0.23809523809523808, 'recall': 1.7197200295791846e-05, 'f1-score': 3.4391916523940214e-05, 'support': 290745}, '1': {'precision': 0.4074537381505335, 'recall': 0.991265829248366, 'f1-score': 0.5775210085596075, 'support': 391680}, '2': {'precision': 0.2880862925705975, 'recall': 0.008527721372758647, 'f1-score': 0.016565094829418547, 'support': 278738}, 'accuracy': 0.40642534096714084, 'macro avg': {'precision': 0.311211756272123, 'recall': 0.33327024927380683, 'f1-score': 0.19804016510185005, 'support': 961163}, 'weighted avg': {'precision': 0.3216073414991465, 'recall': 0.40642534096714084, 'f1-score': 0.24015775608607415, 'support': 961163}}
[[     5 288278   2462]
 [     9 388259   3412]
 [     7 276354   2377]]
Evaluating performance on  train set...
1532/1532 - 30s - 30s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1329391
{'0': {'precision': 0.3285579021036598, 'recall': 0.061376727446109836, 'f1-score': 0.10343174101241545, 'support': 130033}, '1': {'precision': 0.32939673853827434, 'recall': 0.8357959083369171, 'f1-score': 0.472554383222613, 'support': 130216}, '2': {'precision': 0.33297764498746196, 'recall': 0.09460934420762211, 'f1-score': 0.14735152108984878, 'support': 131932}, 'accuracy': 0.3296870577615948, 'macro avg': {'precision': 0.33031076187646535, 'recall': 0.3305939933302164, 'f1-score': 0.24111254844162575, 'support': 392181}, 'weighted avg': {'precision': 0.33032324882702363, 'recall': 0.3296870577615948, 'f1-score': 0.24076653898380884, 'support': 392181}}
[[  7981 109703  12349]
 [  8727 108834  12655]
 [  7583 111867  12482]]
Evaluating performance on  val set...
467/467 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1329705
{'0': {'precision': 0.30733382389011527, 'recall': 0.03361863110729522, 'f1-score': 0.06060752636161362, 'support': 37271}, '1': {'precision': 0.3571673264311815, 'recall': 0.8584301527765071, 'f1-score': 0.5044485659758621, 'support': 43724}, '2': {'precision': 0.2700137013114112, 'recall': 0.07187141815150568, 'f1-score': 0.1135250792083282, 'support': 38388}, 'accuracy': 0.3480059975038322, 'macro avg': {'precision': 0.311504950544236, 'recall': 0.32130673401176935, 'f1-score': 0.22619372384860129, 'support': 119383}, 'weighted avg': {'precision': 0.3135849249644248, 'recall': 0.3480059975038322, 'f1-score': 0.2401800336262416, 'support': 119383}}
[[ 1253 33206  2812]
 [ 1543 37534  4647]
 [ 1281 34348  2759]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
4960/4960 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1253675
{'0': {'precision': 0.3252478431277378, 'recall': 0.06474536886067571, 'f1-score': 0.10799311848058628, 'support': 413991}, '1': {'precision': 0.344011996013678, 'recall': 0.8514593419894366, 'f1-score': 0.49003638724045395, 'support': 436224}, '2': {'precision': 0.33840876767338746, 'recall': 0.08678912424159346, 'f1-score': 0.13814838286132794, 'support': 419465}, 'accuracy': 0.3423193245542184, 'macro avg': {'precision': 0.33588953560493434, 'recall': 0.3343312783639019, 'f1-score': 0.24539262952745602, 'support': 1269680}, 'weighted avg': {'precision': 0.3360426268866828, 'recall': 0.3423193245542184, 'f1-score': 0.24921415121715954, 'support': 1269680}}
[[ 26804 351595  35592]
 [ 29217 371427  35580]
 [ 26390 356670  36405]]
Evaluating performance on  train set...
1691/1691 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1431202
{'0': {'precision': 0.3298788862529654, 'recall': 0.05357432542042935, 'f1-score': 0.09217833239325235, 'support': 147944}, '1': {'precision': 0.329061414099964, 'recall': 0.8777549344990422, 'f1-score': 0.4786731308616843, 'support': 142517}, '2': {'precision': 0.3370202372644801, 'recall': 0.06783815483590035, 'f1-score': 0.11294235952362856, 'support': 142383}, 'accuracy': 0.3296337710583952, 'macro avg': {'precision': 0.3319868458724698, 'recall': 0.3330558049184573, 'f1-score': 0.22793127425952173, 'support': 432844}, 'weighted avg': {'precision': 0.3319588580262675, 'recall': 0.3296337710583952, 'f1-score': 0.22626480157898637, 'support': 432844}}
[[  7926 130213   9805]
 [  8226 125095   9196]
 [  7875 124849   9659]]
Evaluating performance on  val set...
591/591 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.177741
{'0': {'precision': 0.32061615618842915, 'recall': 0.03389766314433966, 'f1-score': 0.06131291852917502, 'support': 52806}, '1': {'precision': 0.29398649509491653, 'recall': 0.9199743067245504, 'f1-score': 0.4455827924690232, 'support': 45148}, '2': {'precision': 0.3363785429843055, 'recall': 0.027002632568634825, 'f1-score': 0.049992166965482435, 'support': 53180}, 'accuracy': 0.2961676393134569, 'macro avg': {'precision': 0.3169937314225504, 'recall': 0.32695820081250826, 'f1-score': 0.1856292926545602, 'support': 151134}, 'weighted avg': {'precision': 0.3182074843525404, 'recall': 0.2961676393134569, 'f1-score': 0.17212172859493846, 'support': 151134}}
[[ 1790 49705  1311]
 [ 2091 41535  1522]
 [ 1702 50042  1436]]
testing model on single stock: results/universal/W8/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
10609/10609 - 186s - 186s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1836016
{'0': {'precision': 0.3762279867807506, 'recall': 0.01643162551592892, 'f1-score': 0.03148802267304346, 'support': 1011525}, '1': {'precision': 0.25632468639620076, 'recall': 0.9255616524936796, 'f1-score': 0.40146720121772467, 'support': 696160}, '2': {'precision': 0.37256169845888565, 'recall': 0.058302752885177236, 'f1-score': 0.1008269425429341, 'support': 1007997}, 'accuracy': 0.2650269803312759, 'macro avg': {'precision': 0.33503812387861237, 'recall': 0.3334320102982619, 'f1-score': 0.17792738881123407, 'support': 2715682}, 'weighted avg': {'precision': 0.344130160442732, 'recall': 0.2650269803312759, 'f1-score': 0.1520684618215724, 'support': 2715682}}
[[ 16621 936176  58728]
 [ 11575 644339  40246]
 [ 15982 933246  58769]]
Evaluating performance on  train set...
3903/3903 - 68s - 68s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1246523
{'0': {'precision': 0.34599210357175647, 'recall': 0.05631962981673178, 'f1-score': 0.09687088680487002, 'support': 334537}, '1': {'precision': 0.3279113912822363, 'recall': 0.8507307433852612, 'f1-score': 0.47336556782560596, 'support': 325901}, '2': {'precision': 0.3417799440929228, 'recall': 0.10001624215577704, 'f1-score': 0.15474803412242585, 'support': 338625}, 'accuracy': 0.3302724652999861, 'macro avg': {'precision': 0.33856114631563855, 'recall': 0.3356888717859234, 'f1-score': 0.2416614962509673, 'support': 999063}, 'weighted avg': {'precision': 0.3386663746443645, 'recall': 0.3302724652999861, 'f1-score': 0.23930298773318606, 'support': 999063}}
[[ 18841 282394  33302]
 [ 16724 277254  31923]
 [ 18890 285867  33868]]
Evaluating performance on  val set...
1144/1144 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1260202
{'0': {'precision': 0.34537403868562105, 'recall': 0.08815394224191773, 'f1-score': 0.14045729179007224, 'support': 100869}, '1': {'precision': 0.31645103211489345, 'recall': 0.817775565630444, 'f1-score': 0.45632137757397, 'support': 92419}, '2': {'precision': 0.34151905050433046, 'recall': 0.09645175902159142, 'f1-score': 0.1504215004474027, 'support': 99345}, 'accuracy': 0.32139915867315033, 'macro avg': {'precision': 0.3344480404349483, 'recall': 0.33412708896465104, 'f1-score': 0.24906672327048165, 'support': 292633}, 'weighted avg': {'precision': 0.3349308926797694, 'recall': 0.32139915867315033, 'f1-score': 0.24359582111904243, 'support': 292633}}
[[ 8892 82200  9777]
 [ 8143 75578  8698]
 [ 8711 81052  9582]]
training model: results/universal/W8/deepOF_L2/h50
Epoch 1/50
7695/7695 - 218s - loss: 3.0563 - accuracy50: 0.4631 - val_loss: 3.1324 - val_accuracy50: 0.4486 - 218s/epoch - 28ms/step
Epoch 2/50
7695/7695 - 213s - loss: 2.9817 - accuracy50: 0.4822 - val_loss: 3.0522 - val_accuracy50: 0.4639 - 213s/epoch - 28ms/step
Epoch 3/50
7695/7695 - 213s - loss: 2.9593 - accuracy50: 0.4886 - val_loss: 3.0391 - val_accuracy50: 0.4662 - 213s/epoch - 28ms/step
Epoch 4/50
7695/7695 - 215s - loss: 2.9472 - accuracy50: 0.4917 - val_loss: 3.0346 - val_accuracy50: 0.4664 - 215s/epoch - 28ms/step
Epoch 5/50
7695/7695 - 216s - loss: 2.9388 - accuracy50: 0.4941 - val_loss: 3.0314 - val_accuracy50: 0.4678 - 216s/epoch - 28ms/step
Epoch 6/50
7695/7695 - 217s - loss: 2.9334 - accuracy50: 0.4960 - val_loss: 3.0382 - val_accuracy50: 0.4661 - 217s/epoch - 28ms/step
Epoch 7/50
7695/7695 - 216s - loss: 2.9284 - accuracy50: 0.4970 - val_loss: 3.0338 - val_accuracy50: 0.4680 - 216s/epoch - 28ms/step
Epoch 8/50
7695/7695 - 215s - loss: 2.9245 - accuracy50: 0.4980 - val_loss: 3.0376 - val_accuracy50: 0.4669 - 215s/epoch - 28ms/step
Epoch 9/50
7695/7695 - 210s - loss: 2.9210 - accuracy50: 0.4989 - val_loss: 3.0374 - val_accuracy50: 0.4672 - 210s/epoch - 27ms/step
Epoch 10/50
7695/7695 - 213s - loss: 2.9176 - accuracy50: 0.4999 - val_loss: 3.0454 - val_accuracy50: 0.4654 - 213s/epoch - 28ms/step
Epoch 11/50
7695/7695 - 215s - loss: 2.9151 - accuracy50: 0.5006 - val_loss: 3.0316 - val_accuracy50: 0.4682 - 215s/epoch - 28ms/step
Epoch 12/50
7695/7695 - 216s - loss: 2.9121 - accuracy50: 0.5015 - val_loss: 3.0400 - val_accuracy50: 0.4680 - 216s/epoch - 28ms/step
Epoch 13/50
7695/7695 - 214s - loss: 2.9096 - accuracy50: 0.5021 - val_loss: 3.0401 - val_accuracy50: 0.4672 - 214s/epoch - 28ms/step
Epoch 14/50
7695/7695 - 211s - loss: 2.9073 - accuracy50: 0.5029 - val_loss: 3.0499 - val_accuracy50: 0.4663 - 211s/epoch - 27ms/step
Epoch 15/50
7695/7695 - 209s - loss: 2.9053 - accuracy50: 0.5035 - val_loss: 3.0444 - val_accuracy50: 0.4662 - 209s/epoch - 27ms/step
testing model in sample: results/universal/W8/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 284s - 284s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9764439
{'0': {'precision': 0.41542700820589884, 'recall': 0.47667072471232746, 'f1-score': 0.4439466344540781, 'support': 1708540}, '1': {'precision': 0.5779650065924279, 'recall': 0.5635071435465793, 'f1-score': 0.570644513569809, 'support': 2538305}, '2': {'precision': 0.44349960510318115, 'recall': 0.39475805934083114, 'f1-score': 0.41771176299372836, 'support': 1714098}, 'accuracy': 0.49009326208957205, 'macro avg': {'precision': 0.4789638733005026, 'recall': 0.47831197586657925, 'f1-score': 0.47743430367253853, 'support': 5960943}, 'weighted avg': {'precision': 0.49271179287687394, 'recall': 0.49009326208957205, 'f1-score': 0.4903535065460295, 'support': 5960943}}
[[ 814411  528069  366060]
 [ 624951 1430353  483001]
 [ 521057  516387  676654]]
Evaluating performance on  train set...
7695/7695 - 101s - 101s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0174804
{'0': {'precision': 0.4189682036636682, 'recall': 0.4819045518803105, 'f1-score': 0.448237963011153, 'support': 607639}, '1': {'precision': 0.5153706608822523, 'recall': 0.5282128985727803, 'f1-score': 0.5217127620640979, 'support': 755665}, '2': {'precision': 0.44340468938045424, 'recall': 0.3628615970899013, 'f1-score': 0.39911016111091957, 'support': 606165}, 'accuracy': 0.46303343693147747, 'macro avg': {'precision': 0.4592478513087916, 'recall': 0.4576596825143307, 'f1-score': 0.4563536287287235, 'support': 1969469}, 'weighted avg': {'precision': 0.4634779193274318, 'recall': 0.46303343693147747, 'f1-score': 0.4613088871980727, 'support': 1969469}}
[[292824 185902 128913]
 [209323 399152 147190]
 [196770 189441 219954]]
Evaluating performance on  val set...
2338/2338 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.005359
{'0': {'precision': 0.41294013452378103, 'recall': 0.4830538848380991, 'f1-score': 0.44525372240618816, 'support': 178566}, '1': {'precision': 0.5470898684308333, 'recall': 0.5146472083515001, 'f1-score': 0.5303728760393287, 'support': 243118}, '2': {'precision': 0.426491794273158, 'recall': 0.387978080013629, 'f1-score': 0.40632434104101245, 'support': 176095}, 'accuracy': 0.4678953258645754, 'macro avg': {'precision': 0.46217393240925747, 'recall': 0.4618930577344094, 'f1-score': 0.4606503131621764, 'support': 597779}, 'weighted avg': {'precision': 0.471491195252882, 'recall': 0.4678953258645754, 'f1-score': 0.46840396519069755, 'support': 597779}}
[[ 86257  51406  40903]
 [ 67029 125120  50969]
 [ 55599  52175  68321]]
testing model out of sample: results/universal/W8/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 175s - 175s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93314147
{'0': {'precision': 0.46631949181193244, 'recall': 0.3393297222641835, 'f1-score': 0.39281628003417485, 'support': 926780}, '1': {'precision': 0.5865650165634053, 'recall': 0.7673671278861159, 'f1-score': 0.6648940479387724, 'support': 1764742}, '2': {'precision': 0.46593075432331393, 'recall': 0.319015047879617, 'f1-score': 0.3787240379702308, 'support': 924715}, 'accuracy': 0.5430194425863127, 'macro avg': {'precision': 0.506271754232884, 'recall': 0.47523729934330544, 'f1-score': 0.4788114553143927, 'support': 3616237}, 'weighted avg': {'precision': 0.5249005130376363, 'recall': 0.5430194425863127, 'f1-score': 0.5219880562942306, 'support': 3616237}}
[[ 314484  475874  136422]
 [ 208820 1354205  201717]
 [ 151092  478625  294998]]
Evaluating performance on  train set...
4550/4550 - 58s - 58s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9659447
{'0': {'precision': 0.4720859335038363, 'recall': 0.35058726999225076, 'f1-score': 0.40236467633928574, 'support': 329065}, '1': {'precision': 0.54436509986101, 'recall': 0.7395315742896056, 'f1-score': 0.6271146072636441, 'support': 507359}, '2': {'precision': 0.48459936662183856, 'recall': 0.3408560382522832, 'f1-score': 0.40021209933557733, 'support': 327719}, 'accuracy': 0.5173582626876595, 'macro avg': {'precision': 0.500350133328895, 'recall': 0.47699162751137986, 'f1-score': 0.47656379431283574, 'support': 1164143}, 'weighted avg': {'precision': 0.5071094446633827, 'recall': 0.5173582626876595, 'f1-score': 0.49970964153752445, 'support': 1164143}}
[[115366 157584  56115]
 [ 69461 375208  62690]
 [ 59548 156466 111705]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95784706
{'0': {'precision': 0.46633702389910064, 'recall': 0.35605507933612984, 'f1-score': 0.4038017033202852, 'support': 109660}, '1': {'precision': 0.5630546145583739, 'recall': 0.7505245130701499, 'f1-score': 0.6434120054666865, 'support': 181597}, '2': {'precision': 0.4771802982376864, 'recall': 0.3270779433735379, 'f1-score': 0.38812197995827347, 'support': 109772}, 'accuracy': 0.5267499357901798, 'macro avg': {'precision': 0.5021906455650537, 'recall': 0.4778858452599392, 'f1-score': 0.47844522958174834, 'support': 401029}, 'weighted avg': {'precision': 0.5131015028311662, 'recall': 0.5267499357901798, 'f1-score': 0.5080119161627112, 'support': 401029}}
[[ 39045  52084  18531]
 [ 24497 136293  20807]
 [ 20185  53683  35904]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091859
{'0': {'precision': 0.3987126451468639, 'recall': 0.4453384236628965, 'f1-score': 0.42073771942391475, 'support': 56054}, '1': {'precision': 0.38864195078344216, 'recall': 0.28623943816525843, 'f1-score': 0.3296717185015113, 'support': 54678}, '2': {'precision': 0.39579941649607503, 'recall': 0.45315297026962187, 'f1-score': 0.42253884672964737, 'support': 54187}, 'accuracy': 0.39515762283302713, 'macro avg': {'precision': 0.3943846708087937, 'recall': 0.39491027736592565, 'f1-score': 0.39098276155169115, 'support': 164919}, 'weighted avg': {'precision': 0.3944165692107772, 'recall': 0.39515762283302713, 'f1-score': 0.3911370723600868, 'support': 164919}}
[[24963 12922 18169]
 [19712 15651 19315]
 [17934 11698 24555]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0898087
{'0': {'precision': 0.391293330630448, 'recall': 0.4096673210590545, 'f1-score': 0.4002695767127194, 'support': 18847}, '1': {'precision': 0.4062067497072288, 'recall': 0.40171615076858286, 'f1-score': 0.40394897040918953, 'support': 18996}, '2': {'precision': 0.41291049581455247, 'recall': 0.39847755165449744, 'f1-score': 0.40556565736421846, 'support': 19311}, 'accuracy': 0.40324386744584806, 'macro avg': {'precision': 0.4034701920507431, 'recall': 0.40328700782737825, 'f1-score': 0.40326140149537587, 'support': 57154}, 'weighted avg': {'precision': 0.4035539665553661, 'recall': 0.40324386744584806, 'f1-score': 0.4032819008915913, 'support': 57154}}
[[7721 5511 5615]
 [6039 7631 5326]
 [5972 5644 7695]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.110573
{'0': {'precision': 0.41370808678500987, 'recall': 0.41364009860312245, 'f1-score': 0.41367408990056703, 'support': 6085}, '1': {'precision': 0.3318567737172388, 'recall': 0.34182509505703423, 'f1-score': 0.3367671848660798, 'support': 5260}, '2': {'precision': 0.3973486830629688, 'recall': 0.3867572156196944, 'f1-score': 0.3919814161576185, 'support': 5890}, 'accuracy': 0.3825355381491152, 'macro avg': {'precision': 0.3809711811884058, 'recall': 0.3807408030932837, 'f1-score': 0.3808075636414218, 'support': 17235}, 'weighted avg': {'precision': 0.3831368773472786, 'recall': 0.3825355381491152, 'f1-score': 0.38278925271882236, 'support': 17235}}
[[2517 1820 1748]
 [1755 1798 1707]
 [1812 1800 2278]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7978502
{'0': {'precision': 0.6483314199754563, 'recall': 0.2913316493524975, 'f1-score': 0.4020152926592781, 'support': 112432}, '1': {'precision': 0.6861366301686131, 'recall': 0.8877760093121593, 'f1-score': 0.7740399614236986, 'support': 336764}, '2': {'precision': 0.5614496238919493, 'recall': 0.369832103813813, 'f1-score': 0.44592756286750207, 'support': 108579}, 'accuracy': 0.6667240374703062, 'macro avg': {'precision': 0.6319725580120062, 'recall': 0.5163132541594899, 'f1-score': 0.540660938983493, 'support': 557775}, 'weighted avg': {'precision': 0.6542440106590423, 'recall': 0.6667240374703062, 'f1-score': 0.635178245352963, 'support': 557775}}
[[ 32755  73075   6602]
 [ 13029 298971  24764]
 [  4738  63685  40156]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8562513
{'0': {'precision': 0.6219816819317235, 'recall': 0.3035844915874177, 'f1-score': 0.40801835263272884, 'support': 36909}, '1': {'precision': 0.6308592246709598, 'recall': 0.8834794481172751, 'f1-score': 0.7360984298522654, 'support': 83496}, '2': {'precision': 0.5795916523624537, 'recall': 0.3498186973472559, 'f1-score': 0.43630242956968224, 'support': 36679}, 'accuracy': 0.6226159252374526, 'macro avg': {'precision': 0.610810852988379, 'recall': 0.5122942123506495, 'f1-score': 0.5268064040182255, 'support': 157084}, 'weighted avg': {'precision': 0.6168023855933569, 'recall': 0.6226159252374526, 'f1-score': 0.589009451570195, 'support': 157084}}
[[11205 22055  3649]
 [ 4071 73767  5658]
 [ 2739 21109 12831]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8348007
{'0': {'precision': 0.5708631737655484, 'recall': 0.29580078125, 'f1-score': 0.3896822333719285, 'support': 10240}, '1': {'precision': 0.6726170798898071, 'recall': 0.8653553074605707, 'f1-score': 0.7569092459118034, 'support': 28215}, '2': {'precision': 0.5323554788610871, 'recall': 0.36635329045027215, 'f1-score': 0.43402309631279673, 'support': 10105}, 'accuracy': 0.6414126853377266, 'macro avg': {'precision': 0.5919452441721476, 'recall': 0.5091697930536142, 'f1-score': 0.5268715251988428, 'support': 48560}, 'weighted avg': {'precision': 0.6219724448587605, 'recall': 0.6414126853377266, 'f1-score': 0.6122805566592029, 'support': 48560}}
[[ 3029  6271   940]
 [ 1487 24416  2312]
 [  790  5613  3702]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
1162/1162 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879375
{'0': {'precision': 0.3368777819800425, 'recall': 0.29711595206938135, 'f1-score': 0.3157500068170043, 'support': 77946}, '1': {'precision': 0.5009377073775931, 'recall': 0.6172189950727709, 'f1-score': 0.5530320887297654, 'support': 140647}, '2': {'precision': 0.3364130140570583, 'recall': 0.23639130159132696, 'f1-score': 0.2776693823446181, 'support': 78865}, 'accuracy': 0.43237028420819074, 'macro avg': {'precision': 0.3914095011382313, 'recall': 0.3835754162444931, 'f1-score': 0.38215049263046263, 'support': 297458}, 'weighted avg': {'precision': 0.41432697616928316, 'recall': 0.4323702842081908, 'f1-score': 0.41784772994352753, 'support': 297458}}
[[23159 42834 11953]
 [29016 86810 24821]
 [16571 43651 18643]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1471275
{'0': {'precision': 0.3806176538372897, 'recall': 0.35476710465074646, 'f1-score': 0.36723802464560357, 'support': 27931}, '1': {'precision': 0.348835265269728, 'recall': 0.4494023046272032, 'f1-score': 0.39278374774492114, 'support': 27857}, '2': {'precision': 0.39658356417359186, 'recall': 0.3090595092466, 'f1-score': 0.34739353742872164, 'support': 27794}, 'accuracy': 0.37110861190208416, 'macro avg': {'precision': 0.3753454944268699, 'recall': 0.3710763061748499, 'f1-score': 0.36913843660641543, 'support': 83582}, 'weighted avg': {'precision': 0.37533415396364006, 'recall': 0.37110861190208416, 'f1-score': 0.369153144296625, 'support': 83582}}
[[ 9909 11947  6075]
 [ 8343 12519  6995]
 [ 7782 11422  8590]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1368872
{'0': {'precision': 0.38776207839562443, 'recall': 0.33904553153332667, 'f1-score': 0.3617711157178547, 'support': 10037}, '1': {'precision': 0.3857512953367876, 'recall': 0.5172383847155884, 'f1-score': 0.4419217213874977, 'support': 11515}, '2': {'precision': 0.41116684266103487, 'recall': 0.30419921875, 'f1-score': 0.34968567579703635, 'support': 10240}, 'accuracy': 0.392362858580775, 'macro avg': {'precision': 0.3948934054644823, 'recall': 0.38682771166630503, 'f1-score': 0.3844595043007963, 'support': 31792}, 'weighted avg': {'precision': 0.3945723016956778, 'recall': 0.392362858580775, 'f1-score': 0.3869088648213008, 'support': 31792}}
[[3403 4769 1865]
 [2963 5956 2596]
 [2410 4715 3115]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1237081
{'0': {'precision': 0.3553967883016726, 'recall': 0.5037383354469913, 'f1-score': 0.4167609532273408, 'support': 105662}, '1': {'precision': 0.36131439926331604, 'recall': 0.13644350086020718, 'f1-score': 0.19808425555658885, 'support': 109276}, '2': {'precision': 0.33818864398304876, 'recall': 0.42061372209195635, 'f1-score': 0.37492446169014976, 'support': 98090}, 'accuracy': 0.3494703349221156, 'macro avg': {'precision': 0.3516332771826791, 'recall': 0.35359851946638493, 'f1-score': 0.32992322349135983, 'support': 313028}, 'weighted avg': {'precision': 0.352070267924041, 'recall': 0.3494703349221156, 'f1-score': 0.32731254519498537, 'support': 313028}}
[[53226 14950 37486]
 [51113 14910 43253]
 [45426 11406 41258]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1129124
{'0': {'precision': 0.3693489306392532, 'recall': 0.5014759674003721, 'f1-score': 0.4253888760359821, 'support': 31166}, '1': {'precision': 0.3552232336367577, 'recall': 0.16224509998020195, 'f1-score': 0.22275074748572982, 'support': 30306}, '2': {'precision': 0.36820760068065794, 'recall': 0.43356152947069626, 'f1-score': 0.3982209953224446, 'support': 29945}, 'accuracy': 0.3667698568100025, 'macro avg': {'precision': 0.36425992165222293, 'recall': 0.36576086561709015, 'f1-score': 0.3487868729480521, 'support': 91417}, 'weighted avg': {'precision': 0.3642922070652159, 'recall': 0.3667698568100025, 'f1-score': 0.3493122894950671, 'support': 91417}}
[[15629  4840 10697]
 [13809  4917 11580]
 [12877  4085 12983]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1169364
{'0': {'precision': 0.35392088827203333, 'recall': 0.47853624208304013, 'f1-score': 0.40690136631096047, 'support': 8526}, '1': {'precision': 0.36369488252333443, 'recall': 0.1323185011709602, 'f1-score': 0.1940413840473942, 'support': 8540}, '2': {'precision': 0.35454716625870836, 'recall': 0.45977292149920646, 'f1-score': 0.4003614521873172, 'support': 8191}, 'accuracy': 0.3553866254899632, 'macro avg': {'precision': 0.35738764568469206, 'recall': 0.3568758882510689, 'f1-score': 0.333768067515224, 'support': 25257}, 'weighted avg': {'precision': 0.35742881692131734, 'recall': 0.3553866254899632, 'f1-score': 0.332807345440801, 'support': 25257}}
[[4080 1103 3343]
 [3897 1130 3513]
 [3551  874 3766]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1277561
{'0': {'precision': 0.36422311136515195, 'recall': 0.38099785746316994, 'f1-score': 0.372421686649187, 'support': 120418}, '1': {'precision': 0.37013116718822825, 'recall': 0.35521334206616717, 'f1-score': 0.36251885062156103, 'support': 125198}, '2': {'precision': 0.37324687566021486, 'recall': 0.3717365618373986, 'f1-score': 0.37249018781017873, 'support': 123566}, 'accuracy': 0.3691539674198634, 'macro avg': {'precision': 0.36920038473786504, 'recall': 0.36931592045557854, 'f1-score': 0.3691435750269756, 'support': 369182}, 'weighted avg': {'precision': 0.36924694034874606, 'recall': 0.3691539674198634, 'f1-score': 0.3690863375516481, 'support': 369182}}
[[45879 37628 36911]
 [40505 44472 40221]
 [39580 38052 45934]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.110209
{'0': {'precision': 0.37229006282629856, 'recall': 0.4038636909047276, 'f1-score': 0.38743467550705624, 'support': 41670}, '1': {'precision': 0.38263244433297106, 'recall': 0.3275755117621797, 'f1-score': 0.35296990886538043, 'support': 41914}, '2': {'precision': 0.3914871023406044, 'recall': 0.4143777075283925, 'f1-score': 0.4026073008975395, 'support': 42705}, 'accuracy': 0.38209978699649216, 'macro avg': {'precision': 0.382136536499958, 'recall': 0.3819389700650999, 'f1-score': 0.38100396175665874, 'support': 126289}, 'weighted avg': {'precision': 0.3822141270831151, 'recall': 0.38209978699649216, 'f1-score': 0.3811268477333102, 'support': 126289}}
[[16829 11440 13401]
 [14079 13730 14105]
 [14296 10713 17696]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1070904
{'0': {'precision': 0.3874069683198314, 'recall': 0.4691338331472324, 'f1-score': 0.4243714151726128, 'support': 12538}, '1': {'precision': 0.39419795221843, 'recall': 0.32962823882838904, 'f1-score': 0.3590330892879054, 'support': 13315}, '2': {'precision': 0.37917335812695463, 'recall': 0.3648637657584384, 'f1-score': 0.3718809583022465, 'support': 12295}, 'accuracy': 0.3868354828562441, 'macro avg': {'precision': 0.3869260928884053, 'recall': 0.3878752792446866, 'f1-score': 0.3850951542542549, 'support': 38148}, 'weighted avg': {'precision': 0.3871235907715568, 'recall': 0.3868354828562441, 'f1-score': 0.38464849453782113, 'support': 38148}}
[[5882 3320 3336]
 [4917 4389 4009]
 [4384 3425 4486]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/EXC
Evaluating performance on  test set...
5521/5521 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75304854
{'0': {'precision': 0.6168056587675116, 'recall': 0.39573930057284934, 'f1-score': 0.4821400526235394, 'support': 283146}, '1': {'precision': 0.6948650120594414, 'recall': 0.8511635941269321, 'f1-score': 0.7651136579632857, 'support': 839425}, '2': {'precision': 0.612748279252704, 'recall': 0.4286839516534014, 'f1-score': 0.5044502098621022, 'support': 290734}, 'accuracy': 0.6730132561619749, 'macro avg': {'precision': 0.6414729833598857, 'recall': 0.5585289487843942, 'f1-score': 0.5839013068163091, 'support': 1413305}, 'weighted avg': {'precision': 0.6623339449203378, 'recall': 0.6730132561619749, 'f1-score': 0.6548001931571912, 'support': 1413305}}
[[112052 157748  13346]
 [ 59516 714488  65421]
 [ 10097 156004 124633]]
Evaluating performance on  train set...
1288/1288 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78334874
{'0': {'precision': 0.5696818960832671, 'recall': 0.38970861571015986, 'f1-score': 0.46281454817129086, 'support': 69942}, '1': {'precision': 0.6777348711955693, 'recall': 0.8419972856105798, 'f1-score': 0.7509888099092125, 'support': 190098}, '2': {'precision': 0.5972872456792825, 'recall': 0.3917747675353002, 'f1-score': 0.47317977781244047, 'support': 69688}, 'accuracy': 0.6509031686723602, 'macro avg': {'precision': 0.6149013376527063, 'recall': 0.5411602229520133, 'f1-score': 0.5623277119643146, 'support': 329728}, 'weighted avg': {'precision': 0.6378120399155942, 'recall': 0.6509031686723602, 'f1-score': 0.6311462728992117, 'support': 329728}}
[[ 27257  38467   4218]
 [ 15846 160062  14190]
 [  4743  37643  27302]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75750726
{'0': {'precision': 0.5661206301387058, 'recall': 0.4066543438077634, 'f1-score': 0.4733168914309702, 'support': 22181}, '1': {'precision': 0.7052582687559587, 'recall': 0.8467487489544047, 'f1-score': 0.7695539387957882, 'support': 68143}, '2': {'precision': 0.6055356010986689, 'recall': 0.3976505411155305, 'f1-score': 0.48005359984366713, 'support': 21622}, 'accuracy': 0.6728065317206511, 'macro avg': {'precision': 0.6256381666644444, 'recall': 0.5503512112925661, 'f1-score': 0.5743081433568085, 'support': 111946}, 'weighted avg': {'precision': 0.6584284089820034, 'recall': 0.6728065317206511, 'f1-score': 0.6549414445894584, 'support': 111946}}
[[ 9020 12218   943]
 [ 5785 57700  4658]
 [ 1128 11896  8598]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/AAL
Evaluating performance on  test set...
5918/5918 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7820947
{'0': {'precision': 0.5534203584098972, 'recall': 0.34694401277426895, 'f1-score': 0.42650705879260026, 'support': 280564}, '1': {'precision': 0.7133964985163723, 'recall': 0.8523939487238361, 'f1-score': 0.7767257227145936, 'support': 958145}, '2': {'precision': 0.5021772026805843, 'recall': 0.3531238463375969, 'f1-score': 0.41466275659824053, 'support': 276294}, 'accuracy': 0.667736631544624, 'macro avg': {'precision': 0.589664686535618, 'recall': 0.5174872692785674, 'f1-score': 0.5392985127018115, 'support': 1515003}, 'weighted avg': {'precision': 0.6452499866635996, 'recall': 0.667736631544624, 'f1-score': 0.645838474052537, 'support': 1515003}}
[[ 97340 164638  18586]
 [ 63294 816717  78134]
 [ 15254 163474  97566]]
Evaluating performance on  train set...
1814/1814 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8181153
{'0': {'precision': 0.5191463599212955, 'recall': 0.3638948418171402, 'f1-score': 0.42787286063569685, 'support': 94258}, '1': {'precision': 0.6857999215005293, 'recall': 0.8386421153678332, 'f1-score': 0.7545589572796094, 'support': 275016}, '2': {'precision': 0.5292331055429005, 'recall': 0.3448206898729514, 'f1-score': 0.4175727524187073, 'support': 95003}, 'accuracy': 0.6412098811700774, 'macro avg': {'precision': 0.5780597956549084, 'recall': 0.5157858823526416, 'f1-score': 0.5333348567780045, 'support': 464277}, 'weighted avg': {'precision': 0.6199281496407171, 'recall': 0.6412098811700774, 'f1-score': 0.6192787721361236, 'support': 464277}}
[[ 34300  51622   8336]
 [ 23572 230640  20804]
 [  8198  54046  32759]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7808364
{'0': {'precision': 0.4912680702435238, 'recall': 0.35655939722554747, 'f1-score': 0.4132120124041129, 'support': 28402}, '1': {'precision': 0.7300114001115756, 'recall': 0.8479128515753392, 'f1-score': 0.7845573667929513, 'support': 106485}, '2': {'precision': 0.49663482414242294, 'recall': 0.32873464108644107, 'f1-score': 0.39560724631415106, 'support': 27834}, 'accuracy': 0.6733427154454558, 'macro avg': {'precision': 0.5726380981658408, 'recall': 0.511068963295776, 'f1-score': 0.5311255418370718, 'support': 162721}, 'weighted avg': {'precision': 0.6484202614728147, 'recall': 0.6733427154454558, 'f1-score': 0.6532099168094906, 'support': 162721}}
[[10127 16486  1789]
 [ 8710 90290  7485]
 [ 1777 16907  9150]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/WBA
Evaluating performance on  test set...
3755/3755 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0309305
{'0': {'precision': 0.4722087088130594, 'recall': 0.39333944393522763, 'f1-score': 0.42918076910254993, 'support': 310935}, '1': {'precision': 0.45409185817566866, 'recall': 0.5790324530551081, 'f1-score': 0.5090073279537338, 'support': 355683}, '2': {'precision': 0.45394173179571135, 'recall': 0.3831533917294765, 'f1-score': 0.415554479525876, 'support': 294540}, 'accuracy': 0.45893495138156265, 'macro avg': {'precision': 0.4600807662614798, 'recall': 0.45184176290660405, 'f1-score': 0.4512475255273866, 'support': 961158}, 'weighted avg': {'precision': 0.4599066614951899, 'recall': 0.45893495138156265, 'f1-score': 0.45454544650205353, 'support': 961158}}
[[122303 125525  63107]
 [ 77083 205952  72648]
 [ 59616 122070 112854]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0486317
{'0': {'precision': 0.4737803982073323, 'recall': 0.39158519553072624, 'f1-score': 0.4287792147345324, 'support': 131744}, '1': {'precision': 0.4180982724667382, 'recall': 0.6051070534803967, 'f1-score': 0.49451308999668603, 'support': 129468}, '2': {'precision': 0.4832608718317642, 'recall': 0.3539162836155949, 'f1-score': 0.40859665284138247, 'support': 130966}, 'accuracy': 0.449494872226387, 'macro avg': {'precision': 0.4583798475019449, 'recall': 0.45020284420890594, 'f1-score': 0.44396298585753363, 'support': 392178}, 'weighted avg': {'precision': 0.4585642623030085, 'recall': 0.449494872226387, 'f1-score': 0.4437397784620801, 'support': 392178}}
[[51589 54440 25715]
 [27279 78342 23847]
 [30020 54595 46351]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602887
{'0': {'precision': 0.4669163919688343, 'recall': 0.39116790520184774, 'f1-score': 0.42569875140023494, 'support': 39832}, '1': {'precision': 0.39808522620611975, 'recall': 0.5376774847870183, 'f1-score': 0.4574695286376874, 'support': 39440}, '2': {'precision': 0.46703112115566686, 'recall': 0.3812420533020867, 'f1-score': 0.41979850111181266, 'support': 40111}, 'accuracy': 0.436234639772832, 'macro avg': {'precision': 0.44401091311020696, 'recall': 0.4366958144303175, 'f1-score': 0.434322260383245, 'support': 119383}, 'weighted avg': {'precision': 0.44421551097850553, 'recall': 0.436234639772832, 'f1-score': 0.4342123129201014, 'support': 119383}}
[[15581 15913  8338]
 [ 9121 21206  9113]
 [ 8668 16151 15292]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
4960/4960 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0001395
{'0': {'precision': 0.5104256969475749, 'recall': 0.31408276714021, 'f1-score': 0.38887633614321715, 'support': 391798}, '1': {'precision': 0.4700673870847646, 'recall': 0.8026493908334945, 'f1-score': 0.5929037920147714, 'support': 486074}, '2': {'precision': 0.5458166127075078, 'recall': 0.2766773097704714, 'f1-score': 0.3672126149624837, 'support': 391803}, 'accuracy': 0.4895796168310788, 'macro avg': {'precision': 0.5087698989132824, 'recall': 0.46446982258139197, 'f1-score': 0.44966424770682406, 'support': 1269675}, 'weighted avg': {'precision': 0.5058963030942134, 'recall': 0.4895796168310788, 'f1-score': 0.46029975602274137, 'support': 1269675}}
[[123057 217956  50785]
 [ 56508 390147  39419]
 [ 61522 221878 108403]]
Evaluating performance on  train set...
1691/1691 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0309191
{'0': {'precision': 0.5335373862195777, 'recall': 0.3191877506678783, 'f1-score': 0.39942201968211083, 'support': 146359}, '1': {'precision': 0.4225383817110765, 'recall': 0.7713615088872792, 'f1-score': 0.5459919148097023, 'support': 143576}, '2': {'precision': 0.5406477674385054, 'recall': 0.3146823786265097, 'f1-score': 0.3978167406804551, 'support': 142906}, 'accuracy': 0.46768905903091434, 'macro avg': {'precision': 0.49890784512305314, 'recall': 0.4684105460605557, 'f1-score': 0.4477435583907561, 'support': 432841}, 'weighted avg': {'precision': 0.49906588991298817, 'recall': 0.46768905903091434, 'f1-score': 0.4475101519566145, 'support': 432841}}
[[ 46716  76919  22724]
 [ 17343 110749  15484]
 [ 23500  74436  44970]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0546205
{'0': {'precision': 0.5203036510422943, 'recall': 0.3283775048480931, 'f1-score': 0.40263887917569996, 'support': 52598}, '1': {'precision': 0.39122556364776806, 'recall': 0.7481009284349873, 'f1-score': 0.5137705643223783, 'support': 45022}, '2': {'precision': 0.5290460340388118, 'recall': 0.3148393848223796, 'f1-score': 0.39475626471725306, 'support': 53513}, 'accuracy': 0.4486181045833802, 'macro avg': {'precision': 0.48019174957629135, 'recall': 0.4637726060351533, 'f1-score': 0.43705523607177715, 'support': 151133}, 'weighted avg': {'precision': 0.48494722650639727, 'recall': 0.4486181045833802, 'f1-score': 0.4329535581747199, 'support': 151133}}
[[17272 25595  9731]
 [ 6074 33681  5267]
 [ 9850 26815 16848]]
testing model on single stock: results/universal/W8/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
10609/10609 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0931484
{'0': {'precision': 0.3745328599091298, 'recall': 0.5513189381557736, 'f1-score': 0.4460477563712017, 'support': 896365}, '1': {'precision': 0.3805300824090712, 'recall': 0.21905196080507647, 'f1-score': 0.2780465547306355, 'support': 897157}, '2': {'precision': 0.4069102622976162, 'recall': 0.3882048028802099, 'f1-score': 0.3973375051819754, 'support': 922155}, 'accuracy': 0.38616227187548446, 'macro avg': {'precision': 0.38732440153860576, 'recall': 0.3861919006136867, 'f1-score': 0.37381060542793754, 'support': 2715677}, 'weighted avg': {'precision': 0.3875084213053984, 'recall': 0.38616227187548446, 'f1-score': 0.37400610497243575, 'support': 2715677}}
[[494183 156939 245243]
 [424097 196524 276536]
 [401185 162985 357985]]
Evaluating performance on  train set...
3903/3903 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0990862
{'0': {'precision': 0.387546821337041, 'recall': 0.5527231722692806, 'f1-score': 0.45562680921193077, 'support': 337878}, '1': {'precision': 0.3716603898729347, 'recall': 0.25383729913713127, 'f1-score': 0.301651856494967, 'support': 322297}, '2': {'precision': 0.4054750988035845, 'recall': 0.35542230891123, 'f1-score': 0.37880243607504466, 'support': 338887}, 'accuracy': 0.3893772358472247, 'macro avg': {'precision': 0.3882274366711867, 'recall': 0.38732759343921397, 'f1-score': 0.3786937005939808, 'support': 999062}, 'weighted avg': {'precision': 0.3885032294120328, 'recall': 0.3893772358472247, 'f1-score': 0.3798953264059996, 'support': 999062}}
[[186753  66449  84676]
 [148556  81811  91930]
 [146576  71863 120448]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0961447
{'0': {'precision': 0.3818975867661824, 'recall': 0.5562191293321198, 'f1-score': 0.45286207901419595, 'support': 97787}, '1': {'precision': 0.38384322987784625, 'recall': 0.21058918809475602, 'f1-score': 0.27196778537529254, 'support': 98780}, '2': {'precision': 0.3855399100149975, 'recall': 0.3853392459350863, 'f1-score': 0.38543955185806056, 'support': 96066}, 'accuracy': 0.38345299402323046, 'macro avg': {'precision': 0.38376024221967536, 'recall': 0.3840491877873207, 'f1-score': 0.3700898054158497, 'support': 292633}, 'weighted avg': {'precision': 0.3837500574437574, 'recall': 0.38345299402323046, 'f1-score': 0.36966657194755553, 'support': 292633}}
[[54391 15950 27446]
 [46426 20802 31552]
 [41606 17442 37018]]
training model: results/universal/W8/deepOF_L2/h100
Epoch 1/50
7695/7695 - 218s - loss: 3.1867 - accuracy100: 0.4157 - val_loss: 3.3970 - val_accuracy100: 0.3635 - 218s/epoch - 28ms/step
Epoch 2/50
7695/7695 - 210s - loss: 3.1411 - accuracy100: 0.4323 - val_loss: 3.4774 - val_accuracy100: 0.3655 - 210s/epoch - 27ms/step
Epoch 3/50
7695/7695 - 210s - loss: 3.1225 - accuracy100: 0.4390 - val_loss: 3.4544 - val_accuracy100: 0.3678 - 210s/epoch - 27ms/step
Epoch 4/50
7695/7695 - 209s - loss: 3.1115 - accuracy100: 0.4431 - val_loss: 3.4363 - val_accuracy100: 0.3706 - 209s/epoch - 27ms/step
Epoch 5/50
7695/7695 - 210s - loss: 3.1041 - accuracy100: 0.4457 - val_loss: 3.4082 - val_accuracy100: 0.3745 - 210s/epoch - 27ms/step
Epoch 6/50
7695/7695 - 211s - loss: 3.0980 - accuracy100: 0.4478 - val_loss: 3.3887 - val_accuracy100: 0.3786 - 211s/epoch - 27ms/step
Epoch 7/50
7695/7695 - 211s - loss: 3.0933 - accuracy100: 0.4494 - val_loss: 3.3614 - val_accuracy100: 0.3835 - 211s/epoch - 27ms/step
Epoch 8/50
7695/7695 - 211s - loss: 3.0889 - accuracy100: 0.4511 - val_loss: 3.3518 - val_accuracy100: 0.3850 - 211s/epoch - 27ms/step
Epoch 9/50
7695/7695 - 210s - loss: 3.0854 - accuracy100: 0.4522 - val_loss: 3.3380 - val_accuracy100: 0.3913 - 210s/epoch - 27ms/step
Epoch 10/50
7695/7695 - 210s - loss: 3.0821 - accuracy100: 0.4534 - val_loss: 3.3274 - val_accuracy100: 0.3933 - 210s/epoch - 27ms/step
Epoch 11/50
7695/7695 - 213s - loss: 3.0801 - accuracy100: 0.4540 - val_loss: 3.3082 - val_accuracy100: 0.3971 - 213s/epoch - 28ms/step
Epoch 12/50
7695/7695 - 210s - loss: 3.0769 - accuracy100: 0.4552 - val_loss: 3.3139 - val_accuracy100: 0.3972 - 210s/epoch - 27ms/step
Epoch 13/50
7695/7695 - 211s - loss: 3.0741 - accuracy100: 0.4560 - val_loss: 3.3070 - val_accuracy100: 0.4000 - 211s/epoch - 27ms/step
Epoch 14/50
7695/7695 - 213s - loss: 3.0718 - accuracy100: 0.4570 - val_loss: 3.3221 - val_accuracy100: 0.3983 - 213s/epoch - 28ms/step
Epoch 15/50
7695/7695 - 212s - loss: 3.0690 - accuracy100: 0.4575 - val_loss: 3.3114 - val_accuracy100: 0.4012 - 212s/epoch - 28ms/step
Epoch 16/50
7695/7695 - 211s - loss: 3.0674 - accuracy100: 0.4585 - val_loss: 3.3354 - val_accuracy100: 0.3994 - 211s/epoch - 27ms/step
Epoch 17/50
7695/7695 - 210s - loss: 3.0650 - accuracy100: 0.4593 - val_loss: 3.3164 - val_accuracy100: 0.4022 - 210s/epoch - 27ms/step
Epoch 18/50
7695/7695 - 211s - loss: 3.0632 - accuracy100: 0.4596 - val_loss: 3.3361 - val_accuracy100: 0.4003 - 211s/epoch - 27ms/step
Epoch 19/50
7695/7695 - 209s - loss: 3.0605 - accuracy100: 0.4606 - val_loss: 3.3199 - val_accuracy100: 0.4020 - 209s/epoch - 27ms/step
Epoch 20/50
7695/7695 - 211s - loss: 3.0590 - accuracy100: 0.4615 - val_loss: 3.3383 - val_accuracy100: 0.4004 - 211s/epoch - 27ms/step
Epoch 21/50
7695/7695 - 212s - loss: 3.0567 - accuracy100: 0.4617 - val_loss: 3.3296 - val_accuracy100: 0.4011 - 212s/epoch - 28ms/step
Epoch 22/50
7695/7695 - 212s - loss: 3.0545 - accuracy100: 0.4628 - val_loss: 3.3289 - val_accuracy100: 0.4023 - 212s/epoch - 27ms/step
Epoch 23/50
7695/7695 - 211s - loss: 3.0525 - accuracy100: 0.4634 - val_loss: 3.3433 - val_accuracy100: 0.4000 - 211s/epoch - 27ms/step
testing model in sample: results/universal/W8/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 297s - 297s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0937374
{'0': {'precision': 0.41686435577829706, 'recall': 0.4283154657333549, 'f1-score': 0.42251233677933875, 'support': 1974617}, '1': {'precision': 0.38210041393037825, 'recall': 0.626065321430954, 'f1-score': 0.47456446906616023, 'support': 2023685}, '2': {'precision': 0.4584437352042563, 'recall': 0.14396061225664805, 'f1-score': 0.21911475600535102, 'support': 1962641}, 'accuracy': 0.40182585205058996, 'macro avg': {'precision': 0.4191361683043105, 'recall': 0.39944713314031904, 'f1-score': 0.37206385395028335, 'support': 5960943}, 'weighted avg': {'precision': 0.4187523334283833, 'recall': 0.40182585205058996, 'f1-score': 0.37321488300382305, 'support': 5960943}}
[[ 845759  979350  149508]
 [ 572468 1266959  184258]
 [ 610632 1069466  282543]]
Evaluating performance on  train set...
7695/7695 - 101s - 101s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1059035
{'0': {'precision': 0.3961715734858532, 'recall': 0.4357094780831138, 'f1-score': 0.41500094079394084, 'support': 640351}, '1': {'precision': 0.38790508168357946, 'recall': 0.6031093570900016, 'f1-score': 0.47214081908967814, 'support': 689210}, '2': {'precision': 0.44074737782551887, 'recall': 0.13337073454309056, 'f1-score': 0.20477598689932758, 'support': 639908}, 'accuracy': 0.3960565005085127, 'macro avg': {'precision': 0.4082746776649839, 'recall': 0.39072985657206866, 'f1-score': 0.3639725822609822, 'support': 1969469}, 'weighted avg': {'precision': 0.40776204025041857, 'recall': 0.3960565005085127, 'f1-score': 0.3666918512492011, 'support': 1969469}}
[[279007 314094  47250]
 [212499 415669  61042]
 [212752 341811  85345]]
Evaluating performance on  val set...
2338/2338 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.098396
{'0': {'precision': 0.3931643992669694, 'recall': 0.44992200332648064, 'f1-score': 0.41963270575992906, 'support': 193598}, '1': {'precision': 0.39801392170636696, 'recall': 0.5835810763360566, 'f1-score': 0.4732570831949125, 'support': 213595}, '2': {'precision': 0.43246157994068485, 'recall': 0.14307451754063782, 'f1-score': 0.2150142525400274, 'support': 190586}, 'accuracy': 0.39985011183062635, 'macro avg': {'precision': 0.4078799669713404, 'recall': 0.3921925324010584, 'f1-score': 0.3693013471649563, 'support': 597779}, 'weighted avg': {'precision': 0.40742606824718425, 'recall': 0.39985011183062635, 'f1-score': 0.37355629018303044, 'support': 597779}}
[[ 87104  90765  15729]
 [ 68889 124650  20056]
 [ 65553  97765  27268]]
testing model out of sample: results/universal/W8/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 175s - 175s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0875628
{'0': {'precision': 0.4115167567750376, 'recall': 0.2542680853408104, 'f1-score': 0.31432249943786483, 'support': 1052814}, '1': {'precision': 0.4347085758391222, 'recall': 0.7730259061316742, 'f1-score': 0.556481570672539, 'support': 1509604}, '2': {'precision': 0.4399790934820019, 'recall': 0.11742528840341653, 'f1-score': 0.18537590884679542, 'support': 1053819}, 'accuracy': 0.43094658895420845, 'macro avg': {'precision': 0.42873480869872055, 'recall': 0.38157309329196704, 'f1-score': 0.3520599929857331, 'support': 3616237}, 'weighted avg': {'precision': 0.42949251832844654, 'recall': 0.43094658895420845, 'f1-score': 0.3778354648275942, 'support': 3616237}}
[[ 267697  738189   46928]
 [ 232062 1166963  110579]
 [ 150754  779320  123745]]
Evaluating performance on  train set...
4550/4550 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1075637
{'0': {'precision': 0.40984800946729616, 'recall': 0.2710989035478695, 'f1-score': 0.32633776250157187, 'support': 358976}, '1': {'precision': 0.39984816694462877, 'recall': 0.7450606049129967, 'f1-score': 0.5204102273646736, 'support': 448891}, '2': {'precision': 0.44582211437245844, 'recall': 0.11293210881451458, 'f1-score': 0.1802138738032585, 'support': 356276}, 'accuracy': 0.4054519075405685, 'macro avg': {'precision': 0.4185060969281278, 'recall': 0.376363872425127, 'f1-score': 0.342320621223168, 'support': 1164143}, 'weighted avg': {'precision': 0.41700165888094115, 'recall': 0.4054519075405685, 'f1-score': 0.35645171607512965, 'support': 1164143}}
[[ 97318 244051  17607]
 [ 82033 334451  32407]
 [ 58098 257943  40235]]
Evaluating performance on  val set...
1570/1570 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1019636
{'0': {'precision': 0.4025441065251621, 'recall': 0.2692138669850667, 'f1-score': 0.32264732187220513, 'support': 120603}, '1': {'precision': 0.4108814635935262, 'recall': 0.7449162641911811, 'f1-score': 0.5296294974937119, 'support': 159430}, '2': {'precision': 0.4327162464091925, 'recall': 0.11204502628186055, 'f1-score': 0.17799981618371127, 'support': 120996}, 'accuracy': 0.4109104329113356, 'macro avg': {'precision': 0.4153806055092936, 'recall': 0.3753917191527028, 'f1-score': 0.3434255451832094, 'support': 401029}, 'weighted avg': {'precision': 0.414961994196172, 'recall': 0.4109104329113356, 'f1-score': 0.3612914066168291, 'support': 401029}}
[[ 32468  82107   6028]
 [ 28923 118762  11745]
 [ 19266  88173  13557]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1336836
{'0': {'precision': 0.37513738354102905, 'recall': 0.3930134098598785, 'f1-score': 0.38386739566752026, 'support': 56451}, '1': {'precision': 0.33743803515096893, 'recall': 0.5613847653321338, 'f1-score': 0.42151260977257377, 'support': 53352}, '2': {'precision': 0.38118462804089787, 'recall': 0.11769722040786705, 'f1-score': 0.1798597055480079, 'support': 55116}, 'accuracy': 0.3554714738750538, 'macro avg': {'precision': 0.36458668224429863, 'recall': 0.35736513186662644, 'f1-score': 0.328413236996034, 'support': 164919}, 'weighted avg': {'precision': 0.36496247520753367, 'recall': 0.3554714738750538, 'f1-score': 0.32786632613827116, 'support': 164919}}
[[22186 29138  5127]
 [17997 29951  5404]
 [18958 29671  6487]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.141774
{'0': {'precision': 0.37729491851749986, 'recall': 0.2871421843110576, 'f1-score': 0.326102460477832, 'support': 19109}, '1': {'precision': 0.34735349716446123, 'recall': 0.7000370389967723, 'f1-score': 0.4643164230438521, 'support': 18899}, '2': {'precision': 0.4079151005969489, 'recall': 0.09636477593230962, 'f1-score': 0.1559001225231315, 'support': 19146}, 'accuracy': 0.35976484585505825, 'macro avg': {'precision': 0.37752117209297004, 'recall': 0.36118133308004646, 'f1-score': 0.3154396686816052, 'support': 57154}, 'weighted avg': {'precision': 0.37765169291547823, 'recall': 0.35976484585505825, 'f1-score': 0.31478937156112485, 'support': 57154}}
[[ 5487 12237  1385]
 [ 4376 13230  1293]
 [ 4680 12621  1845]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1567838
{'0': {'precision': 0.3844761258203213, 'recall': 0.28036303630363035, 'f1-score': 0.3242675827846168, 'support': 6060}, '1': {'precision': 0.3138711651079451, 'recall': 0.6693383038210624, 'f1-score': 0.4273473759371653, 'support': 5365}, '2': {'precision': 0.39127272727272727, 'recall': 0.09259896729776247, 'f1-score': 0.1497564370215727, 'support': 5810}, 'accuracy': 0.33814911517261387, 'macro avg': {'precision': 0.3632066727336645, 'recall': 0.3474334358074851, 'f1-score': 0.3004571319144516, 'support': 17235}, 'weighted avg': {'precision': 0.3647890147217765, 'recall': 0.33814911517261387, 'f1-score': 0.2975262618319122, 'support': 17235}}
[[1699 3951  410]
 [1347 3591  427]
 [1373 3899  538]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0564878
{'0': {'precision': 0.46805256810354473, 'recall': 0.23662557907109769, 'f1-score': 0.3143370073480294, 'support': 159091}, '1': {'precision': 0.4563264631323708, 'recall': 0.804091425889436, 'f1-score': 0.5822326065142716, 'support': 247151}, '2': {'precision': 0.52377993403757, 'recall': 0.14462856275530742, 'f1-score': 0.2266683904330963, 'support': 151533}, 'accuracy': 0.46307740576397294, 'macro avg': {'precision': 0.4827196550911618, 'recall': 0.3951151892386137, 'f1-score': 0.3744126680984658, 'support': 557775}, 'weighted avg': {'precision': 0.4779963919973191, 'recall': 0.46307740576397294, 'f1-score': 0.4092246891239522, 'support': 557775}}
[[ 37645 116531   4915]
 [ 33408 198732  15011]
 [  9376 120241  21916]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0902593
{'0': {'precision': 0.4823220802919708, 'recall': 0.26117298309899745, 'f1-score': 0.338857654144576, 'support': 48577}, '1': {'precision': 0.4076178990062532, 'recall': 0.8072933708526929, 'f1-score': 0.5417140096936562, 'support': 61124}, '2': {'precision': 0.5503445438650623, 'recall': 0.11293079796551506, 'f1-score': 0.1874058767905299, 'support': 47383}, 'accuracy': 0.42896157469888724, 'macro avg': {'precision': 0.4800948410544288, 'recall': 0.39379905063906845, 'f1-score': 0.3559925135429207, 'support': 157084}, 'weighted avg': {'precision': 0.47377181428509285, 'recall': 0.42896157469888724, 'f1-score': 0.3721083500156718, 'support': 157084}}
[[12687 34379  1511]
 [ 8918 49345  2861]
 [ 4699 37333  5351]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0715593
{'0': {'precision': 0.4292465568458007, 'recall': 0.23113276137850808, 'f1-score': 0.3004725897920605, 'support': 13754}, '1': {'precision': 0.4485251284223905, 'recall': 0.7944749308193799, 'f1-score': 0.5733579298322812, 'support': 21321}, '2': {'precision': 0.518004722550177, 'recall': 0.13014460511679643, 'f1-score': 0.20802465477389911, 'support': 13485}, 'accuracy': 0.4504324546952224, 'macro avg': {'precision': 0.4652588026061227, 'recall': 0.38525076577156153, 'f1-score': 0.36061839146608027, 'support': 48560}, 'weighted avg': {'precision': 0.4623590422063441, 'recall': 0.4504324546952224, 'f1-score': 0.3946144335168883, 'support': 48560}}
[[ 3179 10157   418]
 [ 3167 16939  1215]
 [ 1060 10670  1755]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0197707
{'0': {'precision': 0.27210456019843543, 'recall': 0.21892174019833593, 'f1-score': 0.24263304750238193, 'support': 65142}, '1': {'precision': 0.5757035181305747, 'recall': 0.8138039675416262, 'f1-score': 0.6743537721290989, 'support': 163779}, '2': {'precision': 0.3114608734205276, 'recall': 0.06149962793819397, 'f1-score': 0.1027171926404289, 'support': 68537}, 'accuracy': 0.5101896738363063, 'macro avg': {'precision': 0.3864229839165126, 'recall': 0.3647417785593854, 'f1-score': 0.3399013374239699, 'support': 297458}, 'weighted avg': {'precision': 0.4483327919839997, 'recall': 0.5101896738363063, 'f1-score': 0.44809861109107485, 'support': 297458}}
[[ 14261  47958   2923]
 [ 24100 133284   6395]
 [ 14049  50273   4215]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1587954
{'0': {'precision': 0.37763409961685823, 'recall': 0.27962976097595577, 'f1-score': 0.32132523737723623, 'support': 28198}, '1': {'precision': 0.3495108045329767, 'recall': 0.7211793326313496, 'f1-score': 0.47083644466569474, 'support': 27541}, '2': {'precision': 0.3827034388832142, 'recall': 0.0807384261753403, 'f1-score': 0.1333451967850046, 'support': 27843}, 'accuracy': 0.3588691345026441, 'macro avg': {'precision': 0.36994944767768306, 'recall': 0.36051583992754854, 'f1-score': 0.30850229294264514, 'support': 83582}, 'weighted avg': {'precision': 0.3700559361760213, 'recall': 0.3588691345026441, 'f1-score': 0.307970207463163, 'support': 83582}}
[[ 7885 18424  1889]
 [ 5942 19862  1737]
 [ 7053 18542  2248]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1223978
{'0': {'precision': 0.3410535876475931, 'recall': 0.23713293337543417, 'f1-score': 0.2797541441609238, 'support': 9501}, '1': {'precision': 0.41470575536462156, 'recall': 0.7555258396916542, 'f1-score': 0.5354853096950437, 'support': 12713}, '2': {'precision': 0.37530864197530867, 'recall': 0.07934850699519733, 'f1-score': 0.131000603292252, 'support': 9578}, 'accuracy': 0.3968922999496729, 'macro avg': {'precision': 0.3770226616625078, 'recall': 0.3573357600207619, 'f1-score': 0.3154133523827398, 'support': 31792}, 'weighted avg': {'precision': 0.3808256975663601, 'recall': 0.3968922999496729, 'f1-score': 0.33720095131351335, 'support': 31792}}
[[2253 6709  539]
 [2382 9605  726]
 [1971 6847  760]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1310034
{'0': {'precision': 0.34137612096352593, 'recall': 0.49101530868006016, 'f1-score': 0.4027453802177643, 'support': 103732}, '1': {'precision': 0.36666791758922207, 'recall': 0.4318993563901266, 'f1-score': 0.3966194027124341, 'support': 113112}, '2': {'precision': 0.31718479291294827, 'recall': 0.1008795641686767, 'f1-score': 0.15307434431078684, 'support': 96184}, 'accuracy': 0.349777016752495, 'macro avg': {'precision': 0.3417429438218988, 'recall': 0.3412647430796211, 'f1-score': 0.3174797090803284, 'support': 313028}, 'weighted avg': {'precision': 0.3430819971238342, 'recall': 0.349777016752495, 'f1-score': 0.3238154426873848, 'support': 313028}}
[[50934 42969  9829]
 [53200 48853 11059]
 [45068 41413  9703]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1303734
{'0': {'precision': 0.367816091954023, 'recall': 0.48731490781842335, 'f1-score': 0.41921592128552115, 'support': 30863}, '1': {'precision': 0.34262275009183296, 'recall': 0.4632014567124648, 'f1-score': 0.39389076576576576, 'support': 30205}, '2': {'precision': 0.35214609987618656, 'recall': 0.11245840060628028, 'f1-score': 0.17047526285557305, 'support': 30349}, 'accuracy': 0.3549011671789711, 'macro avg': {'precision': 0.35419498064068083, 'recall': 0.35432492171238944, 'f1-score': 0.3278606499689533, 'support': 91417}, 'weighted avg': {'precision': 0.35428979508891356, 'recall': 0.3549011671789711, 'f1-score': 0.3282702922978634, 'support': 91417}}
[[15040 12703  3120]
 [13055 13991  3159]
 [12795 14141  3413]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1274956
{'0': {'precision': 0.35507115834984687, 'recall': 0.46414694454256444, 'f1-score': 0.40234753763715236, 'support': 8493}, '1': {'precision': 0.35604785112981835, 'recall': 0.46381161260533305, 'f1-score': 0.402847403248446, 'support': 8663}, '2': {'precision': 0.313588850174216, 'recall': 0.11109739538328602, 'f1-score': 0.16406890894175555, 'support': 8101}, 'accuracy': 0.3507938393316704, 'macro avg': {'precision': 0.34156928655129376, 'recall': 0.3463519841770612, 'f1-score': 0.32308794994245127, 'support': 25257}, 'weighted avg': {'precision': 0.3421010079369755, 'recall': 0.3507938393316704, 'f1-score': 0.32609284249240944, 'support': 25257}}
[[3942 3554  997]
 [3672 4018  973]
 [3488 3713  900]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
1443/1443 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1339737
{'0': {'precision': 0.35152042014321433, 'recall': 0.33280726316236053, 'f1-score': 0.3419079830540978, 'support': 117855}, '1': {'precision': 0.3803636889614117, 'recall': 0.6449632485379893, 'f1-score': 0.4785217114391647, 'support': 130471}, '2': {'precision': 0.3623790145182578, 'recall': 0.10904713046931885, 'f1-score': 0.16764616089146697, 'support': 120856}, 'accuracy': 0.3698744792541348, 'macro avg': {'precision': 0.3647543745409612, 'recall': 0.36227254738988957, 'f1-score': 0.3293586184615765, 'support': 369182}, 'weighted avg': {'precision': 0.3652684804705577, 'recall': 0.3698744792541348, 'f1-score': 0.33314142069959823, 'support': 369182}}
[[39223 66805 11827]
 [34960 84149 11362]
 [37398 70279 13179]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1281735
{'0': {'precision': 0.36464202850513755, 'recall': 0.42270838836723423, 'f1-score': 0.3915340384593997, 'support': 41641}, '1': {'precision': 0.3624345569952588, 'recall': 0.5644195387094447, 'f1-score': 0.4414182262766858, 'support': 41579}, '2': {'precision': 0.37728026533996684, 'recall': 0.11620887413220646, 'f1-score': 0.177687050678974, 'support': 43069}, 'accuracy': 0.3648377926818646, 'macro avg': {'precision': 0.36811895028012104, 'recall': 0.3677789337362951, 'f1-score': 0.3368797718050198, 'support': 126289}, 'weighted avg': {'precision': 0.36822533159828114, 'recall': 0.3648377926818646, 'f1-score': 0.3350283944883475, 'support': 126289}}
[[17602 19771  4268]
 [14118 23468  3993]
 [16552 21512  5005]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.139201
{'0': {'precision': 0.35947712418300654, 'recall': 0.4535991672671951, 'f1-score': 0.4010903426791277, 'support': 12489}, '1': {'precision': 0.36386672417511323, 'recall': 0.5143662830576937, 'f1-score': 0.4262212258044144, 'support': 13121}, '2': {'precision': 0.3561572507159594, 'recall': 0.10910831073536449, 'f1-score': 0.16704316502839003, 'support': 12538}, 'accuracy': 0.36127713117332494, 'macro avg': {'precision': 0.35983369969135975, 'recall': 0.3590245870200845, 'f1-score': 0.3314515778373107, 'support': 38148}, 'weighted avg': {'precision': 0.35989579273618344, 'recall': 0.36127713117332494, 'f1-score': 0.33281045393271735, 'support': 38148}}
[[5665 5599 1225]
 [5124 6749 1248]
 [4970 6200 1368]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/EXC
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0312839
{'0': {'precision': 0.5093590681866108, 'recall': 0.3027798259843681, 'f1-score': 0.37979624208622953, 'support': 406860}, '1': {'precision': 0.437910722694252, 'recall': 0.743443809830263, 'f1-score': 0.5511673372931045, 'support': 596688}, '2': {'precision': 0.5762276511015885, 'recall': 0.22282718782107444, 'f1-score': 0.32137765966808046, 'support': 409757}, 'accuracy': 0.4656447122171081, 'macro avg': {'precision': 0.5078324806608171, 'recall': 0.4230169412119018, 'f1-score': 0.41744707968247147, 'support': 1413305}, 'weighted avg': {'precision': 0.49858113954017425, 'recall': 0.4656447122171081, 'f1-score': 0.4352107867039067, 'support': 1413305}}
[[123189 272433  11238]
 [ 97174 443604  55910]
 [ 21488 296964  91305]]
Evaluating performance on  train set...
1288/1288 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0473562
{'0': {'precision': 0.4971626160183975, 'recall': 0.3112602674455942, 'f1-score': 0.3828366860739174, 'support': 96543}, '1': {'precision': 0.43508193134094714, 'recall': 0.7502122379677398, 'f1-score': 0.5507557496903757, 'support': 137817}, '2': {'precision': 0.5618858027617152, 'recall': 0.18645667309789446, 'f1-score': 0.27999842538282876, 'support': 95368}, 'accuracy': 0.4586325698757764, 'macro avg': {'precision': 0.4980434500403533, 'recall': 0.41597639283707616, 'f1-score': 0.4045302870490406, 'support': 329728}, 'weighted avg': {'precision': 0.4899346801231885, 'recall': 0.4586325698757764, 'f1-score': 0.4232779659920368, 'support': 329728}}
[[ 30050  63732   2761]
 [ 23321 103392  11104]
 [  7072  70514  17782]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0307803
{'0': {'precision': 0.47908121410992616, 'recall': 0.33050367855121676, 'f1-score': 0.391158740790355, 'support': 31806}, '1': {'precision': 0.4558570198105082, 'recall': 0.7312756532693949, 'f1-score': 0.5616173280691625, 'support': 49214}, '2': {'precision': 0.5706403762662807, 'recall': 0.2040031041841816, 'f1-score': 0.3005573817350293, 'support': 30926}, 'accuracy': 0.471745305772426, 'macro avg': {'precision': 0.501859536728905, 'recall': 0.42192747866826447, 'f1-score': 0.41777781686484894, 'support': 111946}, 'weighted avg': {'precision': 0.49416530063910874, 'recall': 0.471745305772426, 'f1-score': 0.4410668329436631, 'support': 111946}}
[[10512 20430   864]
 [ 9342 35989  3883]
 [ 2088 22529  6309]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/AAL
Evaluating performance on  test set...
5918/5918 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0158646
{'0': {'precision': 0.46928890753777697, 'recall': 0.23526539812965672, 'f1-score': 0.31341073578456474, 'support': 385063}, '1': {'precision': 0.5083493548035026, 'recall': 0.8077318143617518, 'f1-score': 0.6239887877819801, 'support': 749630}, '2': {'precision': 0.45041726530737014, 'recall': 0.154973574189477, 'f1-score': 0.23060399638470777, 'support': 380310}, 'accuracy': 0.4983686500950823, 'macro avg': {'precision': 0.4760185092162166, 'recall': 0.3993235955602952, 'f1-score': 0.3893345066504175, 'support': 1515003}, 'weighted avg': {'precision': 0.48387885147000675, 'recall': 0.4983686500950823, 'f1-score': 0.44629918158807985, 'support': 1515003}}
[[ 90592 283666  10805]
 [ 83021 605500  61109]
 [ 19428 301944  58938]]
Evaluating performance on  train set...
1814/1814 - 22s - 22s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.045821
{'0': {'precision': 0.4222679922367014, 'recall': 0.26039699081612716, 'f1-score': 0.32214136428877194, 'support': 122824}, '1': {'precision': 0.47665749710959615, 'recall': 0.7706410191481623, 'f1-score': 0.5890038584496176, 'support': 217201}, '2': {'precision': 0.4609889227805426, 'recall': 0.1386617519235103, 'f1-score': 0.21319589669978842, 'support': 124252}, 'accuracy': 0.466523217820396, 'macro avg': {'precision': 0.45330480404228, 'recall': 0.3898999206292666, 'f1-score': 0.3747803731460593, 'support': 464277}, 'weighted avg': {'precision': 0.45807551212209513, 'recall': 0.466523217820396, 'f1-score': 0.41783016290546726, 'support': 464277}}
[[ 31983  86971   3870]
 [ 33542 167384  16275]
 [ 10216  96807  17229]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0091709
{'0': {'precision': 0.41026240885873594, 'recall': 0.2682746487850896, 'f1-score': 0.32441265338841957, 'support': 39221}, '1': {'precision': 0.5318566552344953, 'recall': 0.7689961012497203, 'f1-score': 0.6288116656714118, 'support': 84899}, '2': {'precision': 0.4235039452552196, 'recall': 0.15712028185798296, 'f1-score': 0.2292052454555761, 'support': 38601}, 'accuracy': 0.503155708236798, 'macro avg': {'precision': 0.45520766978281696, 'recall': 0.3981303439642643, 'f1-score': 0.3941431881718025, 'support': 162721}, 'weighted avg': {'precision': 0.4768448811241243, 'recall': 0.503155708236798, 'f1-score': 0.46064627160732224, 'support': 162721}}
[[10522 27392  1307]
 [12663 65287  6949]
 [ 2462 30074  6065]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/WBA
Evaluating performance on  test set...
3755/3755 - 50s - 50s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918945
{'0': {'precision': 0.4244001297016861, 'recall': 0.33111133598117837, 'f1-score': 0.3719961915047819, 'support': 316232}, '1': {'precision': 0.390756054199884, 'recall': 0.7069979018432567, 'f1-score': 0.5033253743810895, 'support': 346018}, '2': {'precision': 0.44104768908751485, 'recall': 0.13041470954273557, 'f1-score': 0.20130495516314523, 'support': 298908}, 'accuracy': 0.404016821375882, 'macro avg': {'precision': 0.418734624329695, 'recall': 0.38950798245572354, 'f1-score': 0.3588755070163389, 'support': 961158}, 'weighted avg': {'precision': 0.41746540405191446, 'recall': 0.404016821375882, 'f1-score': 0.3661920314479424, 'support': 961158}}
[[104708 189916  21608]
 [ 73589 244634  27795]
 [ 68423 191503  38982]]
Evaluating performance on  train set...
1532/1532 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1123831
{'0': {'precision': 0.4226710125030131, 'recall': 0.30912031394912126, 'f1-score': 0.35708593791503607, 'support': 130467}, '1': {'precision': 0.364440063746705, 'recall': 0.7388355089384834, 'f1-score': 0.4881124292828005, 'support': 130615}, '2': {'precision': 0.46882332697181117, 'recall': 0.11430554708000244, 'f1-score': 0.1837985023825732, 'support': 131096}, 'accuracy': 0.38711503449964046, 'macro avg': {'precision': 0.4186448010738431, 'recall': 0.38742045665586905, 'f1-score': 0.34299895652680323, 'support': 392178}, 'weighted avg': {'precision': 0.4187048248173101, 'recall': 0.38711503449964046, 'f1-score': 0.3427983835938778, 'support': 392178}}
[[40330 81942  8195]
 [25329 96503  8783]
 [29758 86353 14985]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1068006
{'0': {'precision': 0.4040517907755733, 'recall': 0.32577646203386307, 'f1-score': 0.36071654494220473, 'support': 38508}, '1': {'precision': 0.37708943484544255, 'recall': 0.7079911636171541, 'f1-score': 0.49208508223670483, 'support': 41646}, '2': {'precision': 0.4494282334384858, 'recall': 0.11621504499222514, 'f1-score': 0.18467583497053044, 'support': 39229}, 'accuracy': 0.39024819279126843, 'macro avg': {'precision': 0.41018981968650053, 'recall': 0.3833275568810808, 'f1-score': 0.34582582071648, 'support': 119383}, 'weighted avg': {'precision': 0.40955674704369494, 'recall': 0.39024819279126843, 'f1-score': 0.3486970203255335, 'support': 119383}}
[[12545 23422  2541]
 [ 9117 29485  3044]
 [ 9386 25284  4559]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
4960/4960 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1694765
{'0': {'precision': 0.433214586603145, 'recall': 0.2365124689764022, 'f1-score': 0.3059773399342127, 'support': 428303}, '1': {'precision': 0.3303540861996904, 'recall': 0.7628573229996217, 'f1-score': 0.46105086668435163, 'support': 412372}, '2': {'precision': 0.4933843761215456, 'recall': 0.09613519813519814, 'f1-score': 0.16091613180124467, 'support': 429000}, 'accuracy': 0.36003071652194457, 'macro avg': {'precision': 0.4189843496414604, 'recall': 0.36516833003707405, 'f1-score': 0.30931477947326963, 'support': 1269675}, 'weighted avg': {'precision': 0.42013726321804296, 'recall': 0.36003071652194457, 'f1-score': 0.3073294356153634, 'support': 1269675}}
[[101299 310713  16291]
 [ 71734 314581  26057]
 [ 60798 326960  41242]]
Evaluating performance on  train set...
1691/1691 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1537846
{'0': {'precision': 0.4387083531117298, 'recall': 0.23230347001440177, 'f1-score': 0.3037605873391635, 'support': 147204}, '1': {'precision': 0.33927601393343254, 'recall': 0.7694524295090868, 'f1-score': 0.47091197982560395, 'support': 143671}, '2': {'precision': 0.48346467531573695, 'recall': 0.098960314441486, 'f1-score': 0.1642917702090338, 'support': 141966}, 'accuracy': 0.36686219651095897, 'macro avg': {'precision': 0.42048301412029976, 'recall': 0.3669054046549915, 'f1-score': 0.31298811245793373, 'support': 432841}, 'weighted avg': {'precision': 0.4203836852450742, 'recall': 0.36686219651095897, 'f1-score': 0.3134985225560754, 'support': 432841}}
[[ 34196 106841   6167]
 [ 24280 110548   8843]
 [ 19471 108446  14049]]
Evaluating performance on  val set...
591/591 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1824316
{'0': {'precision': 0.4418032786885246, 'recall': 0.232449561239031, 'f1-score': 0.3046245331236485, 'support': 53332}, '1': {'precision': 0.2987175642540881, 'recall': 0.7815932797932245, 'f1-score': 0.4322378916469912, 'support': 43332}, '2': {'precision': 0.49221248066013407, 'recall': 0.08760946593475187, 'f1-score': 0.14874384390000622, 'support': 54469}, 'accuracy': 0.33769593669152337, 'macro avg': {'precision': 0.4109111078675822, 'recall': 0.36721743565566917, 'f1-score': 0.29520208955688193, 'support': 151133}, 'weighted avg': {'precision': 0.4189462497426199, 'recall': 0.33769593669152337, 'f1-score': 0.2850330262403796, 'support': 151133}}
[[12397 38362  2573]
 [ 7114 33868  2350]
 [ 8549 41148  4772]]
testing model on single stock: results/universal/W8/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
10609/10609 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1304476
{'0': {'precision': 0.403402096296624, 'recall': 0.5349336807248292, 'f1-score': 0.4599491428730451, 'support': 988702}, '1': {'precision': 0.2984088629072091, 'recall': 0.4585329033905172, 'f1-score': 0.36153450212043453, 'support': 720716}, '2': {'precision': 0.404841228176446, 'recall': 0.1195527195284713, 'f1-score': 0.1845935484860923, 'support': 1006259}, 'accuracy': 0.3607435641278399, 'macro avg': {'precision': 0.36888406246009303, 'recall': 0.3710064345479392, 'f1-score': 0.3353590644931907, 'support': 2715677}, 'weighted avg': {'precision': 0.37607109787920256, 'recall': 0.3607435641278399, 'f1-score': 0.3318013361652226, 'support': 2715677}}
[[528890 357682 102130]
 [315519 330472  74725]
 [466665 419293 120301]]
Evaluating performance on  train set...
3903/3903 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1223593
{'0': {'precision': 0.3768966033841314, 'recall': 0.5424811545937269, 'f1-score': 0.44477757438026166, 'support': 333901}, '1': {'precision': 0.37481651387387915, 'recall': 0.46426305740797513, 'f1-score': 0.4147722496264498, 'support': 329449}, '2': {'precision': 0.3986430790691776, 'recall': 0.13109153083595462, 'f1-score': 0.19730155634609478, 'support': 335712}, 'accuracy': 0.3784499860869496, 'macro avg': {'precision': 0.3834520654423961, 'recall': 0.37927858094588557, 'f1-score': 0.35228379345093536, 'support': 999062}, 'weighted avg': {'precision': 0.38351808376884744, 'recall': 0.3784499860869496, 'f1-score': 0.35172439729905475, 'support': 999062}}
[[181135 121323  31443]
 [141553 152951  34945]
 [157908 133795  44009]]
Evaluating performance on  val set...
1144/1144 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1234297
{'0': {'precision': 0.3804138980065647, 'recall': 0.5643576115680394, 'f1-score': 0.4544791554583169, 'support': 101037}, '1': {'precision': 0.35461563655078837, 'recall': 0.40857780509105024, 'f1-score': 0.37968900288554025, 'support': 92751}, '2': {'precision': 0.3853272382651355, 'recall': 0.13985532905053366, 'f1-score': 0.20522412986839467, 'support': 98845}, 'accuracy': 0.3715951379372798, 'macro avg': {'precision': 0.3734522576074962, 'recall': 0.37093024856987444, 'f1-score': 0.34646409607075057, 'support': 292633}, 'weighted avg': {'precision': 0.37389667188911974, 'recall': 0.3715951379372798, 'f1-score': 0.34658129552552236, 'support': 292633}}
[[57021 33224 10792]
 [43595 37896 11260]
 [49276 35745 13824]]
training model: results/universal/W8/deepOF_L2/h200
Epoch 1/50
7695/7695 - 214s - loss: 3.2341 - accuracy200: 0.3971 - val_loss: 3.2941 - val_accuracy200: 0.3478 - 214s/epoch - 28ms/step
Epoch 2/50
7695/7695 - 212s - loss: 3.2085 - accuracy200: 0.4083 - val_loss: 3.3054 - val_accuracy200: 0.3458 - 212s/epoch - 28ms/step
Epoch 3/50
7695/7695 - 211s - loss: 3.1939 - accuracy200: 0.4137 - val_loss: 3.3127 - val_accuracy200: 0.3430 - 211s/epoch - 27ms/step
Epoch 4/50
7695/7695 - 212s - loss: 3.1862 - accuracy200: 0.4167 - val_loss: 3.2990 - val_accuracy200: 0.3458 - 212s/epoch - 28ms/step
Epoch 5/50
7695/7695 - 211s - loss: 3.1809 - accuracy200: 0.4189 - val_loss: 3.3097 - val_accuracy200: 0.3421 - 211s/epoch - 27ms/step
Epoch 6/50
7695/7695 - 211s - loss: 3.1768 - accuracy200: 0.4206 - val_loss: 3.3182 - val_accuracy200: 0.3424 - 211s/epoch - 27ms/step
Epoch 7/50
7695/7695 - 211s - loss: 3.1738 - accuracy200: 0.4221 - val_loss: 3.3150 - val_accuracy200: 0.3435 - 211s/epoch - 27ms/step
Epoch 8/50
7695/7695 - 210s - loss: 3.1711 - accuracy200: 0.4233 - val_loss: 3.3228 - val_accuracy200: 0.3417 - 210s/epoch - 27ms/step
Epoch 9/50
7695/7695 - 210s - loss: 3.1689 - accuracy200: 0.4240 - val_loss: 3.3380 - val_accuracy200: 0.3418 - 210s/epoch - 27ms/step
Epoch 10/50
7695/7695 - 210s - loss: 3.1671 - accuracy200: 0.4248 - val_loss: 3.3376 - val_accuracy200: 0.3408 - 210s/epoch - 27ms/step
Epoch 11/50
7695/7695 - 211s - loss: 3.1651 - accuracy200: 0.4255 - val_loss: 3.3518 - val_accuracy200: 0.3395 - 211s/epoch - 27ms/step
testing model in sample: results/universal/W8/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 290s - 290s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026281
{'0': {'precision': 0.4268040049034323, 'recall': 0.22117076267125416, 'f1-score': 0.2913587750614303, 'support': 2076373}, '1': {'precision': 0.30833609213390717, 'recall': 0.7992618990604707, 'f1-score': 0.44500133172340095, 'support': 1845818}, '2': {'precision': 0.44644673594351475, 'recall': 0.02195804099762992, 'f1-score': 0.041857368727635846, 'support': 2038752}, 'accuracy': 0.33204343675153414, 'macro avg': {'precision': 0.3938622776602847, 'recall': 0.34746356757645164, 'f1-score': 0.2594058251708224, 'support': 5960943}, 'weighted avg': {'precision': 0.3968383520496826, 'recall': 0.33204343675153414, 'f1-score': 0.25360043808133326, 'support': 5960943}}
[[ 459233 1591766   25374]
 [ 340393 1475292   30133]
 [ 276355 1717630   44767]]
Evaluating performance on  train set...
7695/7695 - 98s - 98s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024987
{'0': {'precision': 0.39336947396878247, 'recall': 0.2095119441147896, 'f1-score': 0.2734056840185683, 'support': 659781}, '1': {'precision': 0.3276490917570525, 'recall': 0.8057943152742757, 'f1-score': 0.4658684746053933, 'support': 646047}, '2': {'precision': 0.4235809354364115, 'recall': 0.018654664193441937, 'f1-score': 0.035735522494905234, 'support': 663641}, 'accuracy': 0.34079896662501413, 'macro avg': {'precision': 0.3815331670540822, 'recall': 0.34465364119416914, 'f1-score': 0.2583365603729556, 'support': 1969469}, 'weighted avg': {'precision': 0.3819913353604049, 'recall': 0.34079896662501413, 'f1-score': 0.2564530662350547, 'support': 1969469}}
[[138232 514051   7498]
 [116117 520581   9349]
 [ 97056 554205  12380]]
Evaluating performance on  val set...
2338/2338 - 29s - 29s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099317
{'0': {'precision': 0.4050270157318129, 'recall': 0.20324764815147703, 'f1-score': 0.2706697920303227, 'support': 200268}, '1': {'precision': 0.3346523447991651, 'recall': 0.8175784654531612, 'f1-score': 0.47491274853392806, 'support': 199642}, '2': {'precision': 0.4044849627999581, 'recall': 0.019507856207895122, 'f1-score': 0.037220604400902545, 'support': 197869}, 'accuracy': 0.34759835992900384, 'macro avg': {'precision': 0.3813881077769787, 'recall': 0.34677798993751113, 'f1-score': 0.2609343816550511, 'support': 597779}, 'weighted avg': {'precision': 0.3813443578834963, 'recall': 0.34759835992900384, 'f1-score': 0.2616081070518391, 'support': 597779}}
[[ 40704 157137   2427]
 [ 33163 163223   3256]
 [ 26630 167379   3860]]
testing model out of sample: results/universal/W8/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 184s - 184s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0906358
{'0': {'precision': 0.38797977936546024, 'recall': 0.2545516066208034, 'f1-score': 0.3074118349013198, 'support': 1149649}, '1': {'precision': 0.3590089130427753, 'recall': 0.765127860377295, 'f1-score': 0.48870871941514366, 'support': 1306034}, '2': {'precision': 0.3936236609815435, 'recall': 0.0266278001712975, 'f1-score': 0.049881240905426116, 'support': 1160554}, 'accuracy': 0.36580318159456915, 'macro avg': {'precision': 0.3802041177965931, 'recall': 0.34876908905646525, 'f1-score': 0.2820005984072965, 'support': 3616237}, 'weighted avg': {'precision': 0.37932799380997545, 'recall': 0.36580318159456915, 'f1-score': 0.2902397674413654, 'support': 3616237}}
[[292645 838669  18335]
 [277480 999283  29271]
 [184154 945497  30903]]
Evaluating performance on  train set...
4550/4550 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977181
{'0': {'precision': 0.39411154450771735, 'recall': 0.22556030325344065, 'f1-score': 0.28691288725159586, 'support': 385684}, '1': {'precision': 0.33561772630979414, 'recall': 0.7802494093269486, 'f1-score': 0.4693489472892184, 'support': 395735}, '2': {'precision': 0.39901688394956186, 'recall': 0.024390944910692824, 'f1-score': 0.04597174719725007, 'support': 382724}, 'accuracy': 0.3479830227042554, 'macro avg': {'precision': 0.3762487182556911, 'recall': 0.34340021916369406, 'f1-score': 0.26741119391268814, 'support': 1164143}, 'weighted avg': {'precision': 0.3758400263076211, 'recall': 0.3479830227042554, 'f1-score': 0.26971772938252747, 'support': 1164143}}
[[ 86995 292921   5768]
 [ 78671 308772   8292]
 [ 55071 318318   9335]]
Evaluating performance on  val set...
1570/1570 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960243
{'0': {'precision': 0.3858053426913987, 'recall': 0.2466744510840946, 'f1-score': 0.3009371115735374, 'support': 131031}, '1': {'precision': 0.34226924805732784, 'recall': 0.759727814983096, 'f1-score': 0.4719276968761983, 'support': 139317}, '2': {'precision': 0.4062656015976036, 'recall': 0.02490798203258316, 'f1-score': 0.04693820163959248, 'support': 130681}, 'accuracy': 0.35264282632926797, 'macro avg': {'precision': 0.3781133974487767, 'recall': 0.34377008269992465, 'f1-score': 0.2732676700297761, 'support': 401029}, 'weighted avg': {'precision': 0.3773482211315786, 'recall': 0.35264282632926797, 'f1-score': 0.2775698833270339, 'support': 401029}}
[[ 32322  96697   2012]
 [ 30729 105843   2745]
 [ 20727 106699   3255]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
645/645 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1101013
{'0': {'precision': 0.37143284773498303, 'recall': 0.13530705341402685, 'f1-score': 0.19835613518590056, 'support': 55023}, '1': {'precision': 0.33268914129433763, 'recall': 0.8733836404263893, 'f1-score': 0.48183701308543425, 'support': 54598}, '2': {'precision': 0.3681140635126377, 'recall': 0.010271619226735144, 'f1-score': 0.019985573793564502, 'support': 55298}, 'accuracy': 0.33772943081148926, 'macro avg': {'precision': 0.3574120175139861, 'recall': 0.3396541043557171, 'f1-score': 0.23339290735496643, 'support': 164919}, 'weighted avg': {'precision': 0.35749357443006596, 'recall': 0.33772943081148926, 'f1-score': 0.23239680768382587, 'support': 164919}}
[[ 7445 47105   473]
 [ 6411 47685   502]
 [ 6188 48542   568]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140778
{'0': {'precision': 0.3474853037230568, 'recall': 0.11132035990793053, 'f1-score': 0.16862123613312202, 'support': 19116}, '1': {'precision': 0.32716513616212795, 'recall': 0.8783740701381509, 'f1-score': 0.47675491722904767, 'support': 18820}, '2': {'precision': 0.4043824701195219, 'recall': 0.01056301384119055, 'f1-score': 0.020588235294117647, 'support': 19218}, 'accuracy': 0.3300206459740351, 'macro avg': {'precision': 0.3596776366682355, 'recall': 0.333419147962424, 'f1-score': 0.2219881295520958, 'support': 57154}, 'weighted avg': {'precision': 0.35992580115649253, 'recall': 0.3300206459740351, 'f1-score': 0.2203092661590403, 'support': 57154}}
[[ 2128 16846   142]
 [ 2132 16531   157]
 [ 1864 17151   203]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1187053
{'0': {'precision': 0.3807792207792208, 'recall': 0.11936166748086631, 'f1-score': 0.18175055789734687, 'support': 6141}, '1': {'precision': 0.30399735711926, 'recall': 0.8792279763042232, 'f1-score': 0.4517871170463472, 'support': 5233}, '2': {'precision': 0.3314285714285714, 'recall': 0.009895922197577206, 'f1-score': 0.019218025182239896, 'support': 5861}, 'accuracy': 0.3128517551494053, 'macro avg': {'precision': 0.3387350497756841, 'recall': 0.3361618553275556, 'f1-score': 0.21758523337531133, 'support': 17235}, 'weighted avg': {'precision': 0.3406838538876205, 'recall': 0.3128517551494053, 'f1-score': 0.20846933595266898, 'support': 17235}}
[[ 733 5340   68]
 [ 583 4601   49]
 [ 609 5194   58]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879275
{'0': {'precision': 0.45537608999842466, 'recall': 0.2563659792469859, 'f1-score': 0.32804843856393273, 'support': 191683}, '1': {'precision': 0.3336917407918456, 'recall': 0.7889987154059909, 'f1-score': 0.46902038468911755, 'support': 186051}, '2': {'precision': 0.4599618205566161, 'recall': 0.0254275415044351, 'f1-score': 0.04819099550512121, 'support': 180041}, 'accuracy': 0.3594872484424723, 'macro avg': {'precision': 0.41634321711562877, 'recall': 0.35693074538580394, 'f1-score': 0.2817532729193905, 'support': 557775}, 'weighted avg': {'precision': 0.4162673537897278, 'recall': 0.3594872484424723, 'f1-score': 0.28473735011928264, 'support': 557775}}
[[ 49141 140171   2371]
 [ 36253 146794   3004]
 [ 22519 152944   4578]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963384
{'0': {'precision': 0.43376463339494764, 'recall': 0.2324455205811138, 'f1-score': 0.3026872088857041, 'support': 54516}, '1': {'precision': 0.316641440293157, 'recall': 0.7890735116034383, 'f1-score': 0.45193089373120415, 'support': 50373}, '2': {'precision': 0.45726495726495725, 'recall': 0.020500047897308173, 'f1-score': 0.03924085449711195, 'support': 52195}, 'accuracy': 0.3405184487280691, 'macro avg': {'precision': 0.40255701031768726, 'recall': 0.3473396933606201, 'f1-score': 0.26461965237134005, 'support': 157084}, 'weighted avg': {'precision': 0.4040146448428268, 'recall': 0.3405184487280691, 'f1-score': 0.2630095184106067, 'support': 157084}}
[[12672 41237   607]
 [ 9962 39748   663]
 [ 6580 44545  1070]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0873371
{'0': {'precision': 0.43497172683775553, 'recall': 0.24612355402412012, 'f1-score': 0.31436655139893116, 'support': 16252}, '1': {'precision': 0.3434298903036747, 'recall': 0.7905324737344794, 'f1-score': 0.4788386093685028, 'support': 16752}, '2': {'precision': 0.45703611457036114, 'recall': 0.023592183080483414, 'f1-score': 0.044868268231554494, 'support': 15556}, 'accuracy': 0.3626441515650741, 'macro avg': {'precision': 0.41181257723726383, 'recall': 0.3534160702796944, 'f1-score': 0.2793578096663295, 'support': 48560}, 'weighted avg': {'precision': 0.4104602929405045, 'recall': 0.3626441515650741, 'f1-score': 0.28477265976290467, 'support': 48560}}
[[ 4000 12084   168]
 [ 3241 13243   268]
 [ 1955 13234   367]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
1162/1162 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0700427
{'0': {'precision': 0.31677660510114336, 'recall': 0.18472644279468145, 'f1-score': 0.2333665395113023, 'support': 77991}, '1': {'precision': 0.45578214578214576, 'recall': 0.8149097245610696, 'f1-score': 0.5845969609908032, 'support': 136582}, '2': {'precision': 0.21033684751864232, 'recall': 0.019738191470109186, 'f1-score': 0.03608969480383398, 'support': 82885}, 'accuracy': 0.4281108593482105, 'macro avg': {'precision': 0.32763186613397716, 'recall': 0.3397914529419534, 'f1-score': 0.2846843984353131, 'support': 297458}, 'weighted avg': {'precision': 0.3509441025295772, 'recall': 0.4281108593482105, 'f1-score': 0.3396688146322763, 'support': 297458}}
[[ 14407  62480   1104]
 [ 20242 111302   5038]
 [ 10831  70418   1636]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1124921
{'0': {'precision': 0.36764252696456085, 'recall': 0.1655449941025463, 'f1-score': 0.22829258958044302, 'support': 28826}, '1': {'precision': 0.31879818430722673, 'recall': 0.8193703703703704, 'f1-score': 0.4590072099175269, 'support': 27000}, '2': {'precision': 0.3496271748135874, 'recall': 0.015203919873180573, 'f1-score': 0.029140627697407034, 'support': 27756}, 'accuracy': 0.3268287430307961, 'macro avg': {'precision': 0.3453559620284583, 'recall': 0.3333730947820324, 'f1-score': 0.23881347573179232, 'support': 83582}, 'weighted avg': {'precision': 0.3458814855196272, 'recall': 0.3268287430307961, 'f1-score': 0.23668713499782615, 'support': 83582}}
[[ 4772 23685   369]
 [ 4461 22123   416]
 [ 3747 23587   422]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000286
{'0': {'precision': 0.34807549962990375, 'recall': 0.18623762376237624, 'f1-score': 0.2426470588235294, 'support': 10100}, '1': {'precision': 0.3585979860573199, 'recall': 0.8023396880415945, 'f1-score': 0.49566381156316924, 'support': 11540}, '2': {'precision': 0.375, 'recall': 0.02098108747044917, 'f1-score': 0.03973880597014925, 'support': 10152}, 'accuracy': 0.3571024157020634, 'macro avg': {'precision': 0.36055782856240787, 'recall': 0.3365194664248066, 'f1-score': 0.25934989211894927, 'support': 31792}, 'weighted avg': {'precision': 0.36049268071727164, 'recall': 0.3571024157020634, 'f1-score': 0.2696943897133108, 'support': 31792}}
[[1881 8060  159]
 [2085 9259  196]
 [1438 8501  213]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1223/1223 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043282
{'0': {'precision': 0.3337364941138526, 'recall': 0.12118047761718406, 'f1-score': 0.17780100663693055, 'support': 102467}, '1': {'precision': 0.36098161667692846, 'recall': 0.868847253096221, 'f1-score': 0.5100512661177568, 'support': 113364}, '2': {'precision': 0.29635873229939314, 'recall': 0.009043488996573968, 'f1-score': 0.017551391232291366, 'support': 97197}, 'accuracy': 0.3571309914768008, 'macro avg': {'precision': 0.33035894769672475, 'recall': 0.33302373990332634, 'f1-score': 0.23513455466232622, 'support': 313028}, 'weighted avg': {'precision': 0.3319973837440471, 'recall': 0.3571309914768008, 'f1-score': 0.24836797364083968, 'support': 313028}}
[[12417 89075   975]
 [13756 98496  1112]
 [11033 85285   879]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1133834
{'0': {'precision': 0.3472681314407933, 'recall': 0.11838398568256388, 'f1-score': 0.17657381546751033, 'support': 30173}, '1': {'precision': 0.3304165470409806, 'recall': 0.8731362976645995, 'f1-score': 0.479411738071305, 'support': 30316}, '2': {'precision': 0.4, 'recall': 0.013191929643041904, 'f1-score': 0.0255415049455365, 'support': 30928}, 'accuracy': 0.3330890315805594, 'macro avg': {'precision': 0.3592282261605913, 'recall': 0.3349040709967351, 'f1-score': 0.2271756861614506, 'support': 91417}, 'weighted avg': {'precision': 0.35951988547050795, 'recall': 0.3330890315805594, 'f1-score': 0.22590498102570009, 'support': 91417}}
[[ 3572 26308   293]
 [ 3527 26470   319]
 [ 3187 27333   408]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086767
{'0': {'precision': 0.3502057613168724, 'recall': 0.10047225501770957, 'f1-score': 0.15614678899082568, 'support': 8470}, '1': {'precision': 0.3429330970314577, 'recall': 0.8914996544574982, 'f1-score': 0.49532829898886477, 'support': 8682}, '2': {'precision': 0.30739299610894943, 'recall': 0.009747069710055522, 'f1-score': 0.018895001195886153, 'support': 8105}, 'accuracy': 0.3432711723482599, 'macro avg': {'precision': 0.33351061815242655, 'recall': 0.3339063263950877, 'f1-score': 0.22345669639185886, 'support': 25257}, 'weighted avg': {'precision': 0.3339671449595779, 'recall': 0.3432711723482599, 'f1-score': 0.2286949193992269, 'support': 25257}}
[[ 851 7536   83]
 [ 847 7740   95]
 [ 732 7294   79]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1123239
{'0': {'precision': 0.34203578762100323, 'recall': 0.14386299702238967, 'f1-score': 0.20253721577914297, 'support': 121574}, '1': {'precision': 0.3263095154617488, 'recall': 0.8385440129741418, 'f1-score': 0.4698013679614346, 'support': 122089}, '2': {'precision': 0.36283391405342624, 'recall': 0.012444331137118684, 'f1-score': 0.0240633473009613, 'support': 125519}, 'accuracy': 0.3289136523449139, 'macro avg': {'precision': 0.3437264057120594, 'recall': 0.33161711371121677, 'f1-score': 0.23213397701384628, 'support': 369182}, 'weighted avg': {'precision': 0.34390628832260867, 'recall': 0.3289136523449139, 'f1-score': 0.23024211899292618, 'support': 369182}}
[[ 17490 102904   1180]
 [ 18149 102377   1563]
 [ 15496 108461   1562]]
Evaluating performance on  train set...
494/494 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1104524
{'0': {'precision': 0.35311572700296734, 'recall': 0.1493351352655839, 'f1-score': 0.20990146028730852, 'support': 41437}, '1': {'precision': 0.32649742017497946, 'recall': 0.8391389996636718, 'f1-score': 0.47008949599623173, 'support': 41626}, '2': {'precision': 0.32341381246490736, 'recall': 0.013325313468745662, 'f1-score': 0.025596018397138223, 'support': 43226}, 'accuracy': 0.3301475187862759, 'macro avg': {'precision': 0.33434231988095137, 'recall': 0.33393314946600045, 'f1-score': 0.2351956582268928, 'support': 126289}, 'weighted avg': {'precision': 0.3341757670868701, 'recall': 0.3301475187862759, 'f1-score': 0.2325780207420998, 'support': 126289}}
[[ 6188 34792   457]
 [ 5948 34930   748]
 [ 5388 37262   576]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110326
{'0': {'precision': 0.3626616746085773, 'recall': 0.1678878121799417, 'f1-score': 0.2295223221498196, 'support': 12693}, '1': {'precision': 0.32319487211713693, 'recall': 0.8291817815397017, 'f1-score': 0.46510366032872863, 'support': 12405}, '2': {'precision': 0.35874439461883406, 'recall': 0.012260536398467433, 'f1-score': 0.02371072910491998, 'support': 13050}, 'accuracy': 0.3296896298626402, 'macro avg': {'precision': 0.3482003137815161, 'recall': 0.3364433767060369, 'f1-score': 0.23944557052782275, 'support': 38148}, 'weighted avg': {'precision': 0.34848776801393355, 'recall': 0.3296896298626402, 'f1-score': 0.23572304593280763, 'support': 38148}}
[[ 2131 10440   122]
 [ 1955 10286   164]
 [ 1790 11100   160]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/EXC
Evaluating performance on  test set...
5521/5521 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0810885
{'0': {'precision': 0.4613469864755639, 'recall': 0.37341653471122593, 'f1-score': 0.4127506500146239, 'support': 479960}, '1': {'precision': 0.32596750501960375, 'recall': 0.6963817640208825, 'f1-score': 0.4440709902831615, 'support': 458566}, '2': {'precision': 0.49856080063767605, 'recall': 0.04742627622535959, 'f1-score': 0.0866133403084569, 'support': 474779}, 'accuracy': 0.36869536299666383, 'macro avg': {'precision': 0.4286250973776145, 'recall': 0.37240819165248934, 'f1-score': 0.31447832686874744, 'support': 1413305}, 'weighted avg': {'precision': 0.4299227080506942, 'recall': 0.36869536299666383, 'f1-score': 0.3133519338072928, 'support': 1413305}}
[[179225 291034   9701]
 [126283 319337  12946]
 [ 82974 369288  22517]]
Evaluating performance on  train set...
1288/1288 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0849202
{'0': {'precision': 0.4362720574859014, 'recall': 0.3466997967020556, 'f1-score': 0.38636237772306886, 'support': 110675}, '1': {'precision': 0.32699456185034764, 'recall': 0.6970158287632289, 'f1-score': 0.4451524859872202, 'support': 109042}, '2': {'precision': 0.4764554794520548, 'recall': 0.040468680404686805, 'f1-score': 0.07460098026894559, 'support': 110011}, 'accuracy': 0.36037885772515527, 'macro avg': {'precision': 0.41324069959610127, 'recall': 0.3613947686233237, 'f1-score': 0.30203861465974485, 'support': 329728}, 'weighted avg': {'precision': 0.4135405386425713, 'recall': 0.36037885772515527, 'f1-score': 0.30178784322801244, 'support': 329728}}
[[38371 70261  2043]
 [30189 76004  2849]
 [19392 86167  4452]]
Evaluating performance on  val set...
438/438 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0821327
{'0': {'precision': 0.4390657494800832, 'recall': 0.3679088471849866, 'f1-score': 0.4003500838742616, 'support': 37300}, '1': {'precision': 0.3408906046247402, 'recall': 0.6916125314333613, 'f1-score': 0.4566847417170434, 'support': 38176}, '2': {'precision': 0.4691167387276096, 'recall': 0.04165067178502879, 'f1-score': 0.07650851213861187, 'support': 36470}, 'accuracy': 0.37200971897164703, 'macro avg': {'precision': 0.416357697610811, 'recall': 0.3670573501344589, 'f1-score': 0.31118111257663894, 'support': 111946}, 'weighted avg': {'precision': 0.4153759816264727, 'recall': 0.37200971897164703, 'f1-score': 0.3140596382719792, 'support': 111946}}
[[13723 22892   685]
 [10739 26403  1034]
 [ 6793 28158  1519]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/AAL
Evaluating performance on  test set...
5918/5918 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0826246
{'0': {'precision': 0.4079357840007297, 'recall': 0.3253712541989557, 'f1-score': 0.36200546499270914, 'support': 481072}, '1': {'precision': 0.368203712669441, 'recall': 0.7228785556551784, 'f1-score': 0.48789459003868585, 'support': 556543}, '2': {'precision': 0.4350637593440418, 'recall': 0.03523339505810787, 'f1-score': 0.06518760815348931, 'support': 477388}, 'accuracy': 0.37997284493826083, 'macro avg': {'precision': 0.4037344186714042, 'recall': 0.3611610683040807, 'f1-score': 0.3050292210616281, 'support': 1515003}, 'weighted avg': {'precision': 0.4018882472752339, 'recall': 0.37997284493826083, 'f1-score': 0.31472201293334134, 'support': 1515003}}
[[156527 315708   8837]
 [141226 402313  13004]
 [ 85952 374616  16820]]
Evaluating performance on  train set...
1814/1814 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0885415
{'0': {'precision': 0.3946345107654586, 'recall': 0.2775603414013082, 'f1-score': 0.32590219691127326, 'support': 148447}, '1': {'precision': 0.3510592564569935, 'recall': 0.7391118083630001, 'f1-score': 0.4760207828949158, 'support': 165730}, '2': {'precision': 0.42366377341251715, 'recall': 0.0308927381745503, 'f1-score': 0.05758638889751312, 'support': 150100}, 'accuracy': 0.3625701897789466, 'macro avg': {'precision': 0.3897858468783231, 'recall': 0.34918829597961953, 'f1-score': 0.2865031229012341, 'support': 464277}, 'weighted avg': {'precision': 0.3884648435770809, 'recall': 0.3625701897789466, 'f1-score': 0.2927430063250579, 'support': 464277}}
[[ 41203 104814   2430]
 [ 39359 122493   3878]
 [ 23846 121617   4637]]
Evaluating performance on  val set...
636/636 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0766858
{'0': {'precision': 0.38015536883111, 'recall': 0.3409090909090909, 'f1-score': 0.3594641767231686, 'support': 49236}, '1': {'precision': 0.3989291662669934, 'recall': 0.7026479080911716, 'f1-score': 0.5089189865672887, 'support': 65108}, '2': {'precision': 0.41480339244410175, 'recall': 0.033362961738016, 'f1-score': 0.061758628606413096, 'support': 48377}, 'accuracy': 0.3942146373240086, 'macro avg': {'precision': 0.3979626425140684, 'recall': 0.3589733202460928, 'f1-score': 0.3100472639656235, 'support': 162721}, 'weighted avg': {'precision': 0.3979680165027762, 'recall': 0.3942146373240086, 'f1-score': 0.3307561578324704, 'support': 162721}}
[[16785 31634   817]
 [17900 45748  1460]
 [ 9468 37295  1614]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/WBA
Evaluating performance on  test set...
3755/3755 - 48s - 48s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0820497
{'0': {'precision': 0.3551663539153486, 'recall': 0.2050622375241194, 'f1-score': 0.260005320471167, 'support': 290741}, '1': {'precision': 0.4058905029539831, 'recall': 0.8070358635515307, 'f1-score': 0.5401287359307211, 'support': 391679}, '2': {'precision': 0.3438059804326857, 'recall': 0.017902115965530353, 'f1-score': 0.034032163463505787, 'support': 278738}, 'accuracy': 0.39609408650814953, 'macro avg': {'precision': 0.36828761243400576, 'recall': 0.34333340568039344, 'f1-score': 0.27805540662179795, 'support': 961158}, 'weighted avg': {'precision': 0.3725422860591718, 'recall': 0.39609408650814953, 'f1-score': 0.3086249578312901, 'support': 961158}}
[[ 59620 227779   3342]
 [ 69398 316099   6182]
 [ 38847 234901   4990]]
Evaluating performance on  train set...
1532/1532 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016953
{'0': {'precision': 0.38735573760688874, 'recall': 0.1992310945369267, 'f1-score': 0.26312662797605446, 'support': 130055}, '1': {'precision': 0.3308345497637771, 'recall': 0.8099307567571722, 'f1-score': 0.4697777460795763, 'support': 130121}, '2': {'precision': 0.38909523102065074, 'recall': 0.019840608475629157, 'f1-score': 0.03775597730893154, 'support': 132002}, 'accuracy': 0.3414750444951017, 'macro avg': {'precision': 0.3690951727971055, 'recall': 0.34300081992324266, 'f1-score': 0.2568867837881874, 'support': 392178}, 'weighted avg': {'precision': 0.3691880258185423, 'recall': 0.3414750444951017, 'f1-score': 0.25583471845891376, 'support': 392178}}
[[ 25911 102296   1848]
 [ 22468 105389   2264]
 [ 18513 110870   2619]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925226
{'0': {'precision': 0.3815362621652829, 'recall': 0.18595240647443456, 'f1-score': 0.2500405383492784, 'support': 37316}, '1': {'precision': 0.3677581103123301, 'recall': 0.8364056882456663, 'f1-score': 0.5108856049850685, 'support': 43669}, '2': {'precision': 0.38604898828541, 'recall': 0.018881191728735872, 'f1-score': 0.03600158903565399, 'support': 38398}, 'accuracy': 0.3701448279905849, 'macro avg': {'precision': 0.37844778692100767, 'recall': 0.3470797621496122, 'f1-score': 0.265642577456667, 'support': 119383}, 'weighted avg': {'precision': 0.3779478244839886, 'recall': 0.3701448279905849, 'f1-score': 0.27661195671850825, 'support': 119383}}
[[ 6939 29881   496]
 [ 6487 36525   657]
 [ 4761 32912   725]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
4960/4960 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960511
{'0': {'precision': 0.38062850305434853, 'recall': 0.23359074758024972, 'f1-score': 0.2895099640298, 'support': 413989}, '1': {'precision': 0.33891555109912547, 'recall': 0.768645322794357, 'f1-score': 0.4704136076220192, 'support': 436222}, '2': {'precision': 0.3999771680809772, 'recall': 0.025058169473423226, 'f1-score': 0.04716170528757603, 'support': 419464}, 'accuracy': 0.34852619764900467, 'macro avg': {'precision': 0.3731737407448171, 'recall': 0.3424314132826767, 'f1-score': 0.26902842564646506, 'support': 1269675}, 'weighted avg': {'precision': 0.3726894328977482, 'recall': 0.34852619764900467, 'f1-score': 0.2715981198256035, 'support': 1269675}}
[[ 96704 310723   6562]
 [ 91716 335300   9206]
 [ 65644 343309  10511]]
Evaluating performance on  train set...
1691/1691 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987797
{'0': {'precision': 0.40805678351285724, 'recall': 0.22162480217505987, 'f1-score': 0.2872420155765834, 'support': 147858}, '1': {'precision': 0.327614547845491, 'recall': 0.7899045307556871, 'f1-score': 0.46314057744509335, 'support': 142559}, '2': {'precision': 0.3911514463981849, 'recall': 0.024209402909621973, 'f1-score': 0.04559670455371961, 'support': 142424}, 'accuracy': 0.3438329548263681, 'macro avg': {'precision': 0.3756075925855111, 'recall': 0.345246245280123, 'f1-score': 0.2653264325251321, 'support': 432841}, 'weighted avg': {'precision': 0.3759999995951504, 'recall': 0.3438329548263681, 'f1-score': 0.26566326334260504, 'support': 432841}}
[[ 32769 112764   2325]
 [ 26909 112608   3042]
 [ 20627 118349   3448]]
Evaluating performance on  val set...
591/591 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1094337
{'0': {'precision': 0.4119255402824076, 'recall': 0.2080550878719661, 'f1-score': 0.27647058823529413, 'support': 52861}, '1': {'precision': 0.2956948175164494, 'recall': 0.7993826475094935, 'f1-score': 0.43170152547251267, 'support': 45031}, '2': {'precision': 0.40637745643307377, 'recall': 0.02058563888732368, 'f1-score': 0.039186241910686835, 'support': 53241}, 'accuracy': 0.3182031720405206, 'macro avg': {'precision': 0.3713326047439769, 'recall': 0.34267445808959446, 'f1-score': 0.24911945187283122, 'support': 151133}, 'weighted avg': {'precision': 0.3753394127715645, 'recall': 0.3182031720405206, 'f1-score': 0.23913227332101847, 'support': 151133}}
[[10998 41105   758]
 [ 8191 35997   843]
 [ 7510 44635  1096]]
testing model on single stock: results/universal/W8/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
10609/10609 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1240236
{'0': {'precision': 0.4227441153733372, 'recall': 0.15677760839606059, 'f1-score': 0.2287293423295823, 'support': 1011522}, '1': {'precision': 0.25674023792583855, 'recall': 0.8532071742334355, 'f1-score': 0.3947080924970727, 'support': 696158}, '2': {'precision': 0.4279377518205005, 'recall': 0.011485153229622708, 'f1-score': 0.022369933819622243, 'support': 1007997}, 'accuracy': 0.281376614376452, 'macro avg': {'precision': 0.3691407017065587, 'recall': 0.34048997861970626, 'f1-score': 0.21526912288209243, 'support': 2715677}, 'weighted avg': {'precision': 0.38211713456587576, 'recall': 0.281376614376452, 'f1-score': 0.19468176231888354, 'support': 2715677}}
[[158584 844109   8829]
 [ 95544 593967   6647]
 [121002 875418  11577]]
Evaluating performance on  train set...
3903/3903 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086564
{'0': {'precision': 0.36966016017927855, 'recall': 0.17365609728378226, 'f1-score': 0.23630340471597525, 'support': 334362}, '1': {'precision': 0.3279131163805218, 'recall': 0.8369472248195098, 'f1-score': 0.47120837241975666, 'support': 326195}, '2': {'precision': 0.3762995968597496, 'recall': 0.010478427201961566, 'f1-score': 0.020389100137670972, 'support': 338505}, 'accuracy': 0.33493316731093764, 'macro avg': {'precision': 0.3579576244731833, 'recall': 0.34036058310175116, 'f1-score': 0.24263362575780092, 'support': 999062}, 'weighted avg': {'precision': 0.3582792904850928, 'recall': 0.33493316731093764, 'f1-score': 0.23984347957504915, 'support': 999062}}
[[ 58064 273530   2768]
 [ 50076 273008   3111]
 [ 48934 286024   3547]]
Evaluating performance on  val set...
1144/1144 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1098658
{'0': {'precision': 0.38768243141581826, 'recall': 0.15317546814623997, 'f1-score': 0.21958979603431625, 'support': 100930}, '1': {'precision': 0.3167966918703194, 'recall': 0.8559921180559315, 'f1-score': 0.4624455297867985, 'support': 92363}, '2': {'precision': 0.36260978670012545, 'recall': 0.011636802899134286, 'f1-score': 0.022549937578027465, 'support': 99340}, 'accuracy': 0.32695560651054395, 'macro avg': {'precision': 0.35569630332875435, 'recall': 0.34026812970043524, 'f1-score': 0.23486175446638072, 'support': 292633}, 'weighted avg': {'precision': 0.35679754800315516, 'recall': 0.32695560651054395, 'f1-score': 0.22935268879601023, 'support': 292633}}
[[15460 84577   893]
 [12162 79062  1139]
 [12256 85928  1156]]
training model: results/universal/W8/deepVOL_L2/h50
Epoch 1/50
7696/7696 - 488s - loss: 3.0859 - accuracy50: 0.4452 - val_loss: 3.1295 - val_accuracy50: 0.4473 - 488s/epoch - 63ms/step
Epoch 2/50
7696/7696 - 484s - loss: 3.0182 - accuracy50: 0.4712 - val_loss: 3.1890 - val_accuracy50: 0.4538 - 484s/epoch - 63ms/step
Epoch 3/50
7696/7696 - 489s - loss: 2.9914 - accuracy50: 0.4786 - val_loss: 3.1947 - val_accuracy50: 0.4550 - 489s/epoch - 64ms/step
Epoch 4/50
7696/7696 - 493s - loss: 2.9772 - accuracy50: 0.4825 - val_loss: 3.2111 - val_accuracy50: 0.4553 - 493s/epoch - 64ms/step
Epoch 5/50
7696/7696 - 501s - loss: 2.9671 - accuracy50: 0.4855 - val_loss: 3.1982 - val_accuracy50: 0.4530 - 501s/epoch - 65ms/step
Epoch 6/50
7696/7696 - 486s - loss: 2.9602 - accuracy50: 0.4865 - val_loss: 3.1818 - val_accuracy50: 0.4560 - 486s/epoch - 63ms/step
Epoch 7/50
7696/7696 - 477s - loss: 2.9548 - accuracy50: 0.4880 - val_loss: 3.1763 - val_accuracy50: 0.4555 - 477s/epoch - 62ms/step
Epoch 8/50
7696/7696 - 472s - loss: 2.9500 - accuracy50: 0.4897 - val_loss: 3.1519 - val_accuracy50: 0.4588 - 472s/epoch - 61ms/step
Epoch 9/50
7696/7696 - 473s - loss: 2.9443 - accuracy50: 0.4914 - val_loss: 3.1418 - val_accuracy50: 0.4594 - 473s/epoch - 61ms/step
Epoch 10/50
7696/7696 - 471s - loss: 2.9403 - accuracy50: 0.4928 - val_loss: 3.1457 - val_accuracy50: 0.4618 - 471s/epoch - 61ms/step
Epoch 11/50
7696/7696 - 481s - loss: 2.9383 - accuracy50: 0.4933 - val_loss: 3.1353 - val_accuracy50: 0.4611 - 481s/epoch - 62ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 892s - 892s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0173794
{'0': {'precision': 0.3972007605234535, 'recall': 0.41315945500017265, 'f1-score': 0.40502296781063923, 'support': 1708551}, '1': {'precision': 0.6106642081036185, 'recall': 0.5041411395215165, 'f1-score': 0.5523133709291898, 'support': 2538311}, '2': {'precision': 0.4027620414914392, 'recall': 0.4906715220645631, 'f1-score': 0.44239185092143163, 'support': 1714106}, 'accuracy': 0.4741904335000624, 'macro avg': {'precision': 0.47020900337283705, 'recall': 0.46932403886208407, 'f1-score': 0.46657606322042017, 'support': 5960968}, 'weighted avg': {'precision': 0.4896973553995821, 'recall': 0.4741904335000624, 'f1-score': 0.47848806226908275, 'support': 5960968}}
[[ 705904  425430  577217]
 [ 588686 1279667  669958]
 [ 482607  390436  841063]]
Evaluating performance on  train set...
7696/7696 - 287s - 287s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0506681
{'0': {'precision': 0.39405207808110637, 'recall': 0.4318388880300753, 'f1-score': 0.41208105720235577, 'support': 608074}, '1': {'precision': 0.5554079886651095, 'recall': 0.44742504472224537, 'f1-score': 0.49560282897380764, 'support': 755217}, '2': {'precision': 0.39696333284871793, 'recall': 0.45493072292634806, 'f1-score': 0.4239748235449666, 'support': 606189}, 'accuracy': 0.444923025367102, 'macro avg': {'precision': 0.44880779986497793, 'recall': 0.4447315518928896, 'f1-score': 0.44388623657370996, 'support': 1969480}, 'weighted avg': {'precision': 0.45682169104485454, 'recall': 0.444923025367102, 'f1-score': 0.44776912320829715, 'support': 1969480}}
[[262590 136396 209088]
 [207467 337903 209847]
 [196327 134088 275774]]
Evaluating performance on  val set...
2338/2338 - 87s - 87s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0455542
{'0': {'precision': 0.39188192268049327, 'recall': 0.41938933776799764, 'f1-score': 0.40516928935795005, 'support': 178593}, '1': {'precision': 0.576618033760285, 'recall': 0.44769164910432035, 'f1-score': 0.5040410781151522, 'support': 242944}, '2': {'precision': 0.3834937874666899, 'recall': 0.4744131681825661, 'f1-score': 0.42413574454054326, 'support': 176243}, 'accuracy': 0.4471143229950818, 'macro avg': {'precision': 0.4506645813024894, 'recall': 0.447164718351628, 'f1-score': 0.44444870400454856, 'support': 597780}, 'weighted avg': {'precision': 0.46448752951859856, 'recall': 0.4471143229950818, 'f1-score': 0.45094367593591433, 'support': 597780}}
[[ 74900  39824  63869]
 [ 63634 108764  70546]
 [ 52595  40036  83612]]
testing model out of sample: results/universal/W8/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 531s - 531s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9655975
{'0': {'precision': 0.4333301667567923, 'recall': 0.3839029164135526, 'f1-score': 0.40712183149156256, 'support': 926789}, '1': {'precision': 0.6328613779052195, 'recall': 0.6869764827346259, 'f1-score': 0.6588095347426213, 'support': 1764746}, '2': {'precision': 0.4208795744134143, 'recall': 0.40031274094949104, 'f1-score': 0.41033860860870847, 'support': 924727}, 'accuracy': 0.535999880539629, 'macro avg': {'precision': 0.4956903730251421, 'recall': 0.4903973800325565, 'f1-score': 0.4920899916142974, 'support': 3616262}, 'weighted avg': {'precision': 0.5275181730028627, 'recall': 0.535999880539629, 'f1-score': 0.5307687100127261, 'support': 3616262}}
[[ 355797  354184  216808]
 [ 259856 1212339  292551]
 [ 205423  349124  370180]]
Evaluating performance on  train set...
4550/4550 - 168s - 168s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98611647
{'0': {'precision': 0.43600033988483133, 'recall': 0.40539308634772464, 'f1-score': 0.4201400151793334, 'support': 329088}, '1': {'precision': 0.6019076012479225, 'recall': 0.6509066042885605, 'f1-score': 0.6254488991142734, 'support': 507443}, '2': {'precision': 0.43890528193708733, 'recall': 0.4145137659483548, 'f1-score': 0.4263609577525811, 'support': 327620}, 'accuracy': 0.5149770089962556, 'macro avg': {'precision': 0.4922710743566137, 'recall': 0.49027115219488, 'f1-score': 0.4906499573487293, 'support': 1164151}, 'weighted avg': {'precision': 0.5091353503285204, 'recall': 0.5149770089962556, 'f1-score': 0.5113830422406382, 'support': 1164151}}
[[133410 109615  86063]
 [ 89598 330298  87547]
 [ 82978 108839 135803]]
Evaluating performance on  val set...
1570/1570 - 59s - 59s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97868246
{'0': {'precision': 0.4302628102197199, 'recall': 0.38595899464870137, 'f1-score': 0.40690851598579464, 'support': 109693}, '1': {'precision': 0.6257105646211599, 'recall': 0.6754010695187166, 'f1-score': 0.6496069567983881, 'support': 181390}, '2': {'precision': 0.43218831898165483, 'recall': 0.41996361982719416, 'f1-score': 0.42598828359241664, 'support': 109950}, 'accuracy': 0.5261985921358092, 'macro avg': {'precision': 0.4960538979408449, 'recall': 0.49377456133153735, 'f1-score': 0.49416791879219985, 'support': 401033}, 'weighted avg': {'precision': 0.5191930924140828, 'recall': 0.5261985921358092, 'f1-score': 0.5219137415591126, 'support': 401033}}
[[ 42337  36559  30797]
 [ 29011 122511  29868]
 [ 27050  36725  46175]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0634538
{'0': {'precision': 0.39537955871483166, 'recall': 0.4485059316742485, 'f1-score': 0.4202704735795122, 'support': 56055}, '1': {'precision': 0.5418736603202623, 'recall': 0.39299169684333735, 'f1-score': 0.4555775815462245, 'support': 54678}, '2': {'precision': 0.40564508284426576, 'recall': 0.46171873558339943, 'f1-score': 0.43186937422868144, 'support': 54191}, 'accuracy': 0.43444253110523634, 'macro avg': {'precision': 0.4476327672931199, 'recall': 0.43440545470032843, 'f1-score': 0.43590580978480603, 'support': 164924}, 'weighted avg': {'precision': 0.44732047395870095, 'recall': 0.43444253110523634, 'f1-score': 0.43578718475849787, 'support': 164924}}
[[25141  9894 21020]
 [17549 21488 15641]
 [20897  8273 25021]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0900894
{'0': {'precision': 0.382628560772064, 'recall': 0.43598597535061623, 'f1-score': 0.4075683460382887, 'support': 18824}, '1': {'precision': 0.5106648817492191, 'recall': 0.30090450147244424, 'f1-score': 0.3786770788524536, 'support': 19016}, '2': {'precision': 0.394, 'recall': 0.4997928963446205, 'f1-score': 0.44063541333820244, 'support': 19314}, 'accuracy': 0.4126045421142877, 'macro avg': {'precision': 0.4290978141737611, 'recall': 0.41222779105589363, 'f1-score': 0.40896027940964824, 'support': 57154}, 'weighted avg': {'precision': 0.42907092100844185, 'recall': 0.4126045421142877, 'f1-score': 0.4091301090124409, 'support': 57154}}
[[8207 2736 7881]
 [6328 5722 6966]
 [6914 2747 9653]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.108658
{'0': {'precision': 0.3836073680306589, 'recall': 0.5097749301790702, 'f1-score': 0.4377821670428894, 'support': 6087}, '1': {'precision': 0.42666184971098264, 'recall': 0.22439673190195705, 'f1-score': 0.29411032250031127, 'support': 5263}, '2': {'precision': 0.4043887147335423, 'recall': 0.4382537795141838, 'f1-score': 0.4206407434580582, 'support': 5887}, 'accuracy': 0.39821314613911934, 'macro avg': {'precision': 0.40488597749172794, 'recall': 0.39080848053173706, 'f1-score': 0.3841777443337529, 'support': 17237}, 'weighted avg': {'precision': 0.40385077031199657, 'recall': 0.39821314613911934, 'f1-score': 0.3880602619276437, 'support': 17237}}
[[3103  822 2162]
 [2444 1181 1638]
 [2542  765 2580]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
2179/2179 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84154195
{'0': {'precision': 0.5283434828963299, 'recall': 0.2600435807355361, 'f1-score': 0.34854029825837135, 'support': 112435}, '1': {'precision': 0.6778825560925289, 'recall': 0.8975932772111116, 'f1-score': 0.772417846373997, 'support': 336765}, '2': {'precision': 0.564678201181757, 'recall': 0.29396758150672314, 'f1-score': 0.38664857727762775, 'support': 108580}, 'accuracy': 0.6515740973143533, 'macro avg': {'precision': 0.5903014133902053, 'recall': 0.4838681464844569, 'f1-score': 0.5025355739699987, 'support': 557780}, 'weighted avg': {'precision': 0.6257022080143865, 'recall': 0.6515740973143533, 'f1-score': 0.6118787460820106, 'support': 557780}}
[[ 29238  74363   8834]
 [ 18714 302278  15773]
 [  7387  69274  31919]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9078357
{'0': {'precision': 0.5125065261758982, 'recall': 0.29228811953550066, 'f1-score': 0.372267806660691, 'support': 36943}, '1': {'precision': 0.6233699324324324, 'recall': 0.8840326270526656, 'f1-score': 0.7311641545601791, 'support': 83489}, '2': {'precision': 0.545805426268589, 'recall': 0.26233801664165873, 'f1-score': 0.35435667827464856, 'support': 36655}, 'accuracy': 0.5998013839464755, 'macro avg': {'precision': 0.5605606282923065, 'recall': 0.4795529210766083, 'f1-score': 0.4859295464985062, 'support': 157087}, 'weighted avg': {'precision': 0.579198525563813, 'recall': 0.5998013839464755, 'f1-score': 0.5588355352365119, 'support': 157087}}
[[10798 21724  4421]
 [ 6101 73807  3581]
 [ 4170 22869  9616]]
Evaluating performance on  val set...
190/190 - 11s - 11s/epoch - 61ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86852765
{'0': {'precision': 0.47826752372206915, 'recall': 0.30616243754286276, 'f1-score': 0.37333492622901854, 'support': 10207}, '1': {'precision': 0.6638140179690207, 'recall': 0.880756986204457, 'f1-score': 0.7570501223794828, 'support': 28270}, '2': {'precision': 0.5946424618109365, 'recall': 0.26638897153624913, 'f1-score': 0.3679452054794521, 'support': 10083}, 'accuracy': 0.6324135090609555, 'macro avg': {'precision': 0.5789080011673421, 'recall': 0.4844361317611896, 'f1-score': 0.49944341802931774, 'support': 48560}, 'weighted avg': {'precision': 0.6104505528223857, 'recall': 0.6324135090609555, 'f1-score': 0.5956018957688815, 'support': 48560}}
[[ 3125  6219   863]
 [ 2403 24899   968]
 [ 1006  6391  2686]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1137515
{'0': {'precision': 0.35594369801663467, 'recall': 0.35686153767206763, 'f1-score': 0.35640202691881434, 'support': 77949}, '1': {'precision': 0.489934125469433, 'recall': 0.3960667766338661, 'f1-score': 0.43802806380209863, 'support': 140648}, '2': {'precision': 0.3036681437715411, 'recall': 0.40665178911064337, 'f1-score': 0.3476945760470083, 'support': 78866}, 'accuracy': 0.3885995905373105, 'macro avg': {'precision': 0.3831819890858696, 'recall': 0.38652670113885906, 'f1-score': 0.3807082222559737, 'support': 297463}, 'weighted avg': {'precision': 0.40543799404433434, 'recall': 0.3885995905373105, 'f1-score': 0.39268827769657266, 'support': 297463}}
[[27817 29391 20741]
 [32142 55706 52800]
 [18191 28604 32071]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.139433
{'0': {'precision': 0.37950992964336466, 'recall': 0.3917149602919081, 'f1-score': 0.38551586952312217, 'support': 27954}, '1': {'precision': 0.36219483840967215, 'recall': 0.280129473116346, 'f1-score': 0.3159196917460961, 'support': 27805}, '2': {'precision': 0.38189260775343126, 'recall': 0.4560255903389282, 'f1-score': 0.4156797221812702, 'support': 27823}, 'accuracy': 0.37600201000215355, 'macro avg': {'precision': 0.37453245860215606, 'recall': 0.37595667458239407, 'f1-score': 0.37237176115016285, 'support': 83582}, 'weighted avg': {'precision': 0.3745429169050186, 'recall': 0.37600201000215355, 'f1-score': 0.3724045195843487, 'support': 83582}}
[[10950  7200  9804]
 [ 9284  7789 10732]
 [ 8619  6516 12688]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1313921
{'0': {'precision': 0.3789706696181516, 'recall': 0.34140991125735365, 'f1-score': 0.35921107847251366, 'support': 10029}, '1': {'precision': 0.4003552065806693, 'recall': 0.3706299757701627, 'f1-score': 0.3849195650220186, 'support': 11556}, '2': {'precision': 0.38278464217596814, 'recall': 0.4522386597433134, 'f1-score': 0.414623192311147, 'support': 10207}, 'accuracy': 0.38761323603422243, 'macro avg': {'precision': 0.38737017279159636, 'recall': 0.38809284892360996, 'f1-score': 0.38625127860189307, 'support': 31792}, 'weighted avg': {'precision': 0.387968182421262, 'recall': 0.38761323603422243, 'f1-score': 0.3863461664354292, 'support': 31792}}
[[3424 3350 3255]
 [3085 4283 4188]
 [2526 3065 4616]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1223/1223 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1303217
{'0': {'precision': 0.3346331748998141, 'recall': 0.6456503634161115, 'f1-score': 0.44080314019416217, 'support': 105664}, '1': {'precision': 0.3415447224867954, 'recall': 0.0721920240121525, 'f1-score': 0.11919078987127578, 'support': 109278}, '2': {'precision': 0.3199828034950734, 'recall': 0.2807495081098164, 'f1-score': 0.2990850099101301, 'support': 98091}, 'accuracy': 0.33111524982989016, 'macro avg': {'precision': 0.33205356696056093, 'recall': 0.3328639651793601, 'f1-score': 0.2863596466585227, 'support': 313033}, 'weighted avg': {'precision': 0.33245516336667774, 'recall': 0.33111524982989016, 'f1-score': 0.28412180775868295, 'support': 313033}}
[[68222  8142 29300]
 [72164  7889 29225]
 [63485  7067 27539]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1245697
{'0': {'precision': 0.33921146482160175, 'recall': 0.6606279806676696, 'f1-score': 0.4482571397545879, 'support': 31243}, '1': {'precision': 0.31587735276259865, 'recall': 0.06879111434332749, 'f1-score': 0.1129780938679117, 'support': 30251}, '2': {'precision': 0.3355153435623749, 'recall': 0.26890559732665, 'f1-score': 0.29854013244541727, 'support': 29925}, 'accuracy': 0.3365602336494602, 'macro avg': {'precision': 0.33020138704885843, 'recall': 0.33277489744588234, 'f1-score': 0.2865917886893056, 'support': 91419}, 'weighted avg': {'precision': 0.33028020706796996, 'recall': 0.3365602336494602, 'f1-score': 0.28830343362298755, 'support': 91419}}
[[20640  2296  8307]
 [20540  2081  7630]
 [19667  2211  8047]]
Evaluating performance on  val set...
99/99 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1219721
{'0': {'precision': 0.33710930549789453, 'recall': 0.6648730845712949, 'f1-score': 0.44738292011019287, 'support': 8549}, '1': {'precision': 0.347651775486827, 'recall': 0.07133623222470326, 'f1-score': 0.11838127742564603, 'support': 8509}, '2': {'precision': 0.33318298000300706, 'recall': 0.2702439024390244, 'f1-score': 0.2984310820820147, 'support': 8200}, 'accuracy': 0.33680418085359093, 'macro avg': {'precision': 0.33931468699590955, 'recall': 0.3354844064116742, 'f1-score': 0.2880650932059512, 'support': 25258}, 'weighted avg': {'precision': 0.3393862081852708, 'recall': 0.33680418085359093, 'f1-score': 0.288190583051286, 'support': 25258}}
[[5684  593 2272]
 [5739  607 2163]
 [5438  546 2216]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1427075
{'0': {'precision': 0.36214988530725584, 'recall': 0.3985633615678459, 'f1-score': 0.37948511156443226, 'support': 120420}, '1': {'precision': 0.37350982257793697, 'recall': 0.21321256559557186, 'f1-score': 0.2714639466712768, 'support': 125199}, '2': {'precision': 0.3725868842733563, 'recall': 0.4980901204195261, 'f1-score': 0.4262932064455134, 'support': 123568}, 'accuracy': 0.36901895245498895, 'macro avg': {'precision': 0.3694155307195164, 'recall': 0.3699553491943146, 'f1-score': 0.35908075489374086, 'support': 369187}, 'weighted avg': {'precision': 0.36949557157084345, 'recall': 0.36901895245498895, 'f1-score': 0.3585196952437255, 'support': 369187}}
[[47995 21842 50583]
 [45445 26694 53060]
 [39088 22932 61548]]
Evaluating performance on  train set...
494/494 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1333163
{'0': {'precision': 0.3745255442607216, 'recall': 0.41235949658948984, 'f1-score': 0.39253297972061546, 'support': 41636}, '1': {'precision': 0.38015956865459577, 'recall': 0.24853522602772352, 'f1-score': 0.30056887736732196, 'support': 41986}, '2': {'precision': 0.38016263844078413, 'recall': 0.47220529646121395, 'f1-score': 0.4212143700807977, 'support': 42670}, 'accuracy': 0.3781157951414183, 'macro avg': {'precision': 0.37828258378536717, 'recall': 0.37770000635947576, 'f1-score': 0.3714387423895784, 'support': 126292}, 'weighted avg': {'precision': 0.3783031782903075, 'recall': 0.3781157951414183, 'f1-score': 0.3716498685596836, 'support': 126292}}
[[17169  8344 16123]
 [14822 10435 16729]
 [13851  8670 20149]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1386174
{'0': {'precision': 0.37779787474564774, 'recall': 0.39877495823721265, 'f1-score': 0.38800309597523225, 'support': 12571}, '1': {'precision': 0.3851823118696664, 'recall': 0.22527223230490018, 'f1-score': 0.28428285141711995, 'support': 13224}, '2': {'precision': 0.36162146398366873, 'recall': 0.5019023718934672, 'f1-score': 0.4203674825411892, 'support': 12353}, 'accuracy': 0.37202474572716787, 'macro avg': {'precision': 0.3748672168663276, 'recall': 0.37531652081186, 'f1-score': 0.3642178099778471, 'support': 38148}, 'weighted avg': {'precision': 0.3751194799250882, 'recall': 0.37202474572716787, 'f1-score': 0.3625286478577107, 'support': 38148}}
[[5013 2367 5191]
 [4491 2979 5754]
 [3765 2388 6200]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
5521/5521 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8184436
{'0': {'precision': 0.5806402834183012, 'recall': 0.3797192967585627, 'f1-score': 0.45916201522909844, 'support': 283146}, '1': {'precision': 0.6971587106934078, 'recall': 0.8079556744727945, 'f1-score': 0.7484791081186519, 'support': 839426}, '2': {'precision': 0.5296523036790712, 'recall': 0.4651094800129326, 'f1-score': 0.49528703573135646, 'support': 290738}, 'accuracy': 0.6516333996080124, 'macro avg': {'precision': 0.6024837659302601, 'recall': 0.5509281504147633, 'f1-score': 0.5676427196930356, 'support': 1413310}, 'weighted avg': {'precision': 0.639356668415513, 'recall': 0.6516333996080124, 'f1-score': 0.6384313943650926, 'support': 1413310}}
[[107516 151550  24080]
 [ 65203 678219  96004]
 [ 12449 143064 135225]]
Evaluating performance on  train set...
1289/1289 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83885187
{'0': {'precision': 0.5335767347627891, 'recall': 0.3617955982942675, 'f1-score': 0.4312076816809646, 'support': 69882}, '1': {'precision': 0.6810235130203728, 'recall': 0.8303320676126263, 'f1-score': 0.7483026084730943, 'support': 190142}, '2': {'precision': 0.548033335312865, 'recall': 0.39716810604539066, 'f1-score': 0.4605607911963601, 'support': 69706}, 'accuracy': 0.6394595578200346, 'macro avg': {'precision': 0.5875445276986756, 'recall': 0.5297652573174282, 'f1-score': 0.5466903604501396, 'support': 329730}, 'weighted avg': {'precision': 0.6216595210103161, 'recall': 0.6394595578200346, 'f1-score': 0.6202688875827306, 'support': 329730}}
[[ 25283  37773   6826]
 [ 16255 157881  16006]
 [  5846  36175  27685]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82198024
{'0': {'precision': 0.481724803170134, 'recall': 0.4172424694034232, 'f1-score': 0.44717099849958863, 'support': 22143}, '1': {'precision': 0.699418016194332, 'recall': 0.8110384084974033, 'f1-score': 0.7511039252184074, 'support': 68162}, '2': {'precision': 0.5787863335033147, 'recall': 0.36712721223603345, 'f1-score': 0.44927618185930784, 'support': 21641}, 'accuracy': 0.6473299626605685, 'macro avg': {'precision': 0.586643050955927, 'recall': 0.5318026967122866, 'f1-score': 0.5491837018591013, 'support': 111946}, 'weighted avg': {'precision': 0.6330380556677287, 'recall': 0.6473299626605685, 'f1-score': 0.6326375129270431, 'support': 111946}}
[[ 9239 11663  1241]
 [ 8339 55282  4541]
 [ 1601 12095  7945]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
5918/5918 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8507648
{'0': {'precision': 0.4805901387052858, 'recall': 0.3472683594473988, 'f1-score': 0.4031939018737999, 'support': 280564}, '1': {'precision': 0.7152344687512313, 'recall': 0.8335547676922226, 'f1-score': 0.769875057776681, 'support': 958147}, '2': {'precision': 0.4515652476178792, 'recall': 0.3197175503172311, 'f1-score': 0.37437198175118297, 'support': 276297}, 'accuracy': 0.6497893080432579, 'macro avg': {'precision': 0.5491299516914654, 'recall': 0.5001802258189508, 'f1-score': 0.515813647133888, 'support': 1515008}, 'weighted avg': {'precision': 0.6236945121262547, 'recall': 0.6497893080432579, 'f1-score': 0.629840255834148, 'support': 1515008}}
[[ 97431 158191  24942]
 [ 77134 798668  82345]
 [ 28167 159793  88337]]
Evaluating performance on  train set...
1814/1814 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8679226
{'0': {'precision': 0.4601883260376934, 'recall': 0.3468523901466126, 'f1-score': 0.39556225008922685, 'support': 94262}, '1': {'precision': 0.7064554533192328, 'recall': 0.8109541342424826, 'f1-score': 0.755106564797658, 'support': 275129}, '2': {'precision': 0.4557011084412061, 'recall': 0.37174352921338844, 'f1-score': 0.40946289481932047, 'support': 94888}, 'accuracy': 0.6269635283956414, 'macro avg': {'precision': 0.5407816292660441, 'recall': 0.5098500178674945, 'f1-score': 0.5200439032354017, 'support': 464279}, 'weighted avg': {'precision': 0.605207690166907, 'recall': 0.6269635283956414, 'f1-score': 0.6114670662419391, 'support': 464279}}
[[ 32695  46178  15389]
 [ 25269 223117  26743]
 [ 13083  46531  35274]]
Evaluating performance on  val set...
636/636 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8343227
{'0': {'precision': 0.45364745394379413, 'recall': 0.3233016543470609, 'f1-score': 0.37754074439443447, 'support': 28410}, '1': {'precision': 0.7412346332228276, 'recall': 0.8423905894732886, 'f1-score': 0.788581882467798, 'support': 106434}, '2': {'precision': 0.43530395984383713, 'recall': 0.33596384245641725, 'f1-score': 0.3792363444952828, 'support': 27878}, 'accuracy': 0.6649992010914321, 'macro avg': {'precision': 0.5433953490034863, 'recall': 0.5005520287589222, 'f1-score': 0.5151196571191717, 'support': 162722}, 'weighted avg': {'precision': 0.6386112198197422, 'recall': 0.6649992010914321, 'f1-score': 0.6466870333369981, 'support': 162722}}
[[ 9185 15766  3459]
 [ 8084 89659  8691]
 [ 2978 15534  9366]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
3755/3755 - 49s - 49s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0556544
{'0': {'precision': 0.443117750188143, 'recall': 0.33896255511566653, 'f1-score': 0.38410460870135643, 'support': 310937}, '1': {'precision': 0.4788116224414884, 'recall': 0.583110288908132, 'f1-score': 0.5258390104025374, 'support': 355684}, '2': {'precision': 0.4195450628985008, 'recall': 0.4132891064771747, 'f1-score': 0.4163935884192019, 'support': 294542}, 'accuracy': 0.45208773121728574, 'macro avg': {'precision': 0.447158145176044, 'recall': 0.4451206501669911, 'f1-score': 0.44211240250769857, 'support': 961163}, 'weighted avg': {'precision': 0.44910278373489115, 'recall': 0.45208773121728574, 'f1-score': 0.44644899732091065, 'support': 961163}}
[[105396 118309  87232]
 [ 67094 207403  81187]
 [ 65361 107450 121731]]
Evaluating performance on  train set...
1532/1532 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0683206
{'0': {'precision': 0.43562964792871683, 'recall': 0.3880693287195131, 'f1-score': 0.41047642363215325, 'support': 131778}, '1': {'precision': 0.44362470976814156, 'recall': 0.5244243764400254, 'f1-score': 0.48065251051436225, 'support': 129338}, '2': {'precision': 0.43582591574715945, 'recall': 0.4053332316026399, 'f1-score': 0.42002688172043007, 'support': 131065}, 'accuracy': 0.4388075913927498, 'macro avg': {'precision': 0.4383600911480059, 'recall': 0.4392756455873928, 'f1-score': 0.43705193862231523, 'support': 392181}, 'weighted avg': {'precision': 0.43833194393441754, 'recall': 0.4388075913927498, 'f1-score': 0.4368116247625271, 'support': 392181}}
[[51139 42927 37712]
 [30452 67828 31058]
 [35800 42140 53125]]
Evaluating performance on  val set...
467/467 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816214
{'0': {'precision': 0.4337610895575029, 'recall': 0.40148661543870223, 'f1-score': 0.4170002999439235, 'support': 39822}, '1': {'precision': 0.4228316470243595, 'recall': 0.4754592677055619, 'f1-score': 0.447603826244603, 'support': 39465}, '2': {'precision': 0.42844784648858364, 'recall': 0.4076217079010375, 'f1-score': 0.4177753920478509, 'support': 40096}, 'accuracy': 0.428000636606552, 'macro avg': {'precision': 0.428346861023482, 'recall': 0.42818919701510055, 'f1-score': 0.4274598394121258, 'support': 119383}, 'weighted avg': {'precision': 0.4283635853595694, 'recall': 0.428000636606552, 'f1-score': 0.42737737422129457, 'support': 119383}}
[[15988 12604 11230]
 [10128 18764 10573]
 [10743 13009 16344]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
4960/4960 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0034101
{'0': {'precision': 0.4588876753076235, 'recall': 0.4031970311459134, 'f1-score': 0.4292435463207133, 'support': 391801}, '1': {'precision': 0.5399160359487433, 'recall': 0.637378259277394, 'f1-score': 0.5846129460482258, 'support': 486074}, '2': {'precision': 0.4657960075196737, 'recall': 0.4180115108280905, 'f1-score': 0.44061198575225713, 'support': 391805}, 'accuracy': 0.4974206099174595, 'macro avg': {'precision': 0.48819990625868015, 'recall': 0.48619560041713267, 'f1-score': 0.4848228260403988, 'support': 1269680}, 'weighted avg': {'precision': 0.49203972816551994, 'recall': 0.4974206099174595, 'f1-score': 0.49223204500906537, 'support': 1269680}}
[[157973 134587  99241]
 [ 87670 309813  88591]
 [ 98609 129417 163779]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0266988
{'0': {'precision': 0.463311720985063, 'recall': 0.4402303089910663, 'f1-score': 0.451476202150387, 'support': 146412}, '1': {'precision': 0.48214648178111824, 'recall': 0.5793236566857366, 'f1-score': 0.5262868031069388, 'support': 143507}, '2': {'precision': 0.4790469516468115, 'recall': 0.40654888927759314, 'f1-score': 0.4398304443266974, 'support': 142925}, 'accuracy': 0.47522433024369054, 'macro avg': {'precision': 0.4748350514709976, 'recall': 0.47536761831813196, 'f1-score': 0.472531149861341, 'support': 432844}, 'weighted avg': {'precision': 0.4747520502027255, 'recall': 0.47522433024369054, 'f1-score': 0.47243381037533877, 'support': 432844}}
[[64455 44935 37022]
 [34203 83137 26167]
 [40460 44359 58106]]
Evaluating performance on  val set...
591/591 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.046676
{'0': {'precision': 0.4547950333811693, 'recall': 0.41575404973762264, 'f1-score': 0.43439911797133407, 'support': 52596}, '1': {'precision': 0.4572551956562442, 'recall': 0.5437623850555519, 'f1-score': 0.4967708471059671, 'support': 44913}, '2': {'precision': 0.47362165864270894, 'recall': 0.43845221445221444, 'f1-score': 0.4553588720610451, 'support': 53625}, 'accuracy': 0.46184842590019454, 'macro avg': {'precision': 0.4618906292267075, 'recall': 0.46598954974846296, 'f1-score': 0.4621762790461154, 'support': 151134}, 'weighted avg': {'precision': 0.4622061456915065, 'recall': 0.46184842590019454, 'f1-score': 0.4603712240737632, 'support': 151134}}
[[21867 14102 16627]
 [10987 24422  9504]
 [15227 14886 23512]]
testing model on single stock: results/universal/W8/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
10609/10609 - 153s - 153s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1305456
{'0': {'precision': 0.3610065029027066, 'recall': 0.44114756311295905, 'f1-score': 0.39707369387154656, 'support': 896369}, '1': {'precision': 0.3784315865091706, 'recall': 0.09277407101090332, 'f1-score': 0.1490162026676215, 'support': 897158}, '2': {'precision': 0.37465679032093363, 'recall': 0.5689531586338522, 'f1-score': 0.4518014344652273, 'support': 922155}, 'accuracy': 0.3694567331521143, 'macro avg': {'precision': 0.37136495991093693, 'recall': 0.36762493091923815, 'f1-score': 0.33263044366813177, 'support': 2715682}, 'weighted avg': {'precision': 0.3713982696678739, 'recall': 0.3694567331521143, 'f1-score': 0.3337086522111587, 'support': 2715682}}
[[395431  73037 427901]
 [366106  83233 447819]
 [333820  63672 524663]]
Evaluating performance on  train set...
3903/3903 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.129658
{'0': {'precision': 0.3680365187957379, 'recall': 0.4564820180469979, 'f1-score': 0.4075155264748501, 'support': 338228}, '1': {'precision': 0.3647278521480549, 'recall': 0.11160662987543363, 'f1-score': 0.17091370848076703, 'support': 321997}, '2': {'precision': 0.36818898096136976, 'recall': 0.5226893087552164, 'f1-score': 0.4320420559607738, 'support': 338838}, 'accuracy': 0.36778361324561115, 'macro avg': {'precision': 0.36698445063505414, 'recall': 0.3635926522258826, 'f1-score': 0.33682376363879696, 'support': 999063}, 'weighted avg': {'precision': 0.36702184728926074, 'recall': 0.36778361324561115, 'f1-score': 0.3395773129781143, 'support': 999063}}
[[154395  31759 152074]
 [134219  35937 151841]
 [130896  30835 177107]]
Evaluating performance on  val set...
1144/1144 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1387235
{'0': {'precision': 0.3669664086382895, 'recall': 0.41946624162171, 'f1-score': 0.3914639611720844, 'support': 97872}, '1': {'precision': 0.3592763664357198, 'recall': 0.09472487771215166, 'f1-score': 0.14992209961611977, 'support': 98538}, '2': {'precision': 0.3511652097506768, 'recall': 0.5648649491285868, 'f1-score': 0.4330881825642824, 'support': 96223}, 'accuracy': 0.35792613956730784, 'macro avg': {'precision': 0.359135994941562, 'recall': 0.3596853561541495, 'f1-score': 0.3248247477841622, 'support': 292633}, 'weighted avg': {'precision': 0.3591812301412657, 'recall': 0.35792613956730784, 'f1-score': 0.3238166196248899, 'support': 292633}}
[[41054  8682 48136]
 [36914  9334 52290]
 [33906  7964 54353]]
training model: results/universal/W8/deepVOL_L2/h100
Epoch 1/50
7696/7696 - 471s - loss: 3.2118 - accuracy100: 0.4027 - val_loss: 3.5614 - val_accuracy100: 0.3544 - 471s/epoch - 61ms/step
Epoch 2/50
7696/7696 - 466s - loss: 3.1662 - accuracy100: 0.4209 - val_loss: 3.5480 - val_accuracy100: 0.3596 - 466s/epoch - 61ms/step
Epoch 3/50
7696/7696 - 471s - loss: 3.1462 - accuracy100: 0.4284 - val_loss: 3.6575 - val_accuracy100: 0.3597 - 471s/epoch - 61ms/step
Epoch 4/50
7696/7696 - 469s - loss: 3.1323 - accuracy100: 0.4342 - val_loss: 3.5729 - val_accuracy100: 0.3614 - 469s/epoch - 61ms/step
Epoch 5/50
7696/7696 - 473s - loss: 3.1237 - accuracy100: 0.4374 - val_loss: 3.5028 - val_accuracy100: 0.3664 - 473s/epoch - 61ms/step
Epoch 6/50
7696/7696 - 473s - loss: 3.1185 - accuracy100: 0.4387 - val_loss: 3.5215 - val_accuracy100: 0.3665 - 473s/epoch - 61ms/step
Epoch 7/50
7696/7696 - 464s - loss: 3.1141 - accuracy100: 0.4404 - val_loss: 3.5450 - val_accuracy100: 0.3684 - 464s/epoch - 60ms/step
Epoch 8/50
7696/7696 - 462s - loss: 3.1112 - accuracy100: 0.4416 - val_loss: 3.5383 - val_accuracy100: 0.3711 - 462s/epoch - 60ms/step
Epoch 9/50
7696/7696 - 472s - loss: 3.1075 - accuracy100: 0.4428 - val_loss: 3.5741 - val_accuracy100: 0.3708 - 472s/epoch - 61ms/step
Epoch 10/50
7696/7696 - 476s - loss: 3.1047 - accuracy100: 0.4440 - val_loss: 3.5560 - val_accuracy100: 0.3686 - 476s/epoch - 62ms/step
Epoch 11/50
7696/7696 - 476s - loss: 3.1024 - accuracy100: 0.4445 - val_loss: 3.5506 - val_accuracy100: 0.3699 - 476s/epoch - 62ms/step
Epoch 12/50
7696/7696 - 475s - loss: 3.0994 - accuracy100: 0.4457 - val_loss: 3.5313 - val_accuracy100: 0.3709 - 475s/epoch - 62ms/step
Epoch 13/50
7696/7696 - 479s - loss: 3.0972 - accuracy100: 0.4464 - val_loss: 3.5434 - val_accuracy100: 0.3705 - 479s/epoch - 62ms/step
Epoch 14/50
7696/7696 - 475s - loss: 3.0952 - accuracy100: 0.4471 - val_loss: 3.5858 - val_accuracy100: 0.3698 - 475s/epoch - 62ms/step
Epoch 15/50
7696/7696 - 472s - loss: 3.0931 - accuracy100: 0.4478 - val_loss: 3.5689 - val_accuracy100: 0.3707 - 472s/epoch - 61ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 907s - 907s/epoch - 39ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1638769
{'0': {'precision': 0.4762177344425815, 'recall': 0.11291139394356811, 'f1-score': 0.18254201201647446, 'support': 1974628}, '1': {'precision': 0.34135621717825126, 'recall': 0.8912788563076083, 'f1-score': 0.49364744746347433, 'support': 2023691}, '2': {'precision': 0.490540301236246, 'recall': 0.052221767621209905, 'f1-score': 0.0943945168236332, 'support': 1962649}, 'accuracy': 0.35717755908100834, 'macro avg': {'precision': 0.43603808428569285, 'recall': 0.35213733929079544, 'f1-score': 0.25686132543452733, 'support': 5960968}, 'weighted avg': {'precision': 0.43514925909777996, 'recall': 0.35717755908100834, 'f1-score': 0.25913673228211587, 'support': 5960968}}
[[ 222958 1701883   49787]
 [ 163359 1803673   56659]
 [  81868 1778288  102493]]
Evaluating performance on  train set...
7696/7696 - 302s - 302s/epoch - 39ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1652535
{'0': {'precision': 0.4486015928875718, 'recall': 0.09835486909081254, 'f1-score': 0.1613369765585869, 'support': 640253}, '1': {'precision': 0.35131706690030073, 'recall': 0.9038383715313888, 'f1-score': 0.5059673661377092, 'support': 689433}, '2': {'precision': 0.46604202772963604, 'recall': 0.04034892481017328, 'f1-score': 0.07426789377231417, 'support': 639794}, 'accuracy': 0.36147764892255824, 'macro avg': {'precision': 0.4219868958391695, 'recall': 0.3475140551441249, 'f1-score': 0.24719074548953676, 'support': 1969480}, 'weighted avg': {'precision': 0.42021192808486313, 'recall': 0.36147764892255824, 'f1-score': 0.2536929723679084, 'support': 1969480}}
[[ 62972 563578  13703]
 [ 50423 623136  15874]
 [ 26979 587000  25815]]
Evaluating performance on  val set...
2338/2338 - 86s - 86s/epoch - 37ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1561583
{'0': {'precision': 0.4375792603064385, 'recall': 0.10877856677726441, 'f1-score': 0.1742420165980256, 'support': 193494}, '1': {'precision': 0.3569700076516862, 'recall': 0.886331305568554, 'f1-score': 0.5089573855773597, 'support': 213700}, '2': {'precision': 0.45699009278188396, 'recall': 0.04574312908608187, 'f1-score': 0.08316202668091174, 'support': 190586}, 'accuracy': 0.3666482652480846, 'macro avg': {'precision': 0.41717978691333624, 'recall': 0.34695100047730004, 'f1-score': 0.2554538096187657, 'support': 597780}, 'weighted avg': {'precision': 0.414950928187339, 'recall': 0.3666482652480846, 'f1-score': 0.26486081179448684, 'support': 597780}}
[[ 21048 167572   4874]
 [ 18806 189409   5485]
 [  8247 173621   8718]]
testing model out of sample: results/universal/W8/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 592s - 592s/epoch - 42ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1127135
{'0': {'precision': 0.43168294070316804, 'recall': 0.13911887988343674, 'f1-score': 0.2104241612743802, 'support': 1052819}, '1': {'precision': 0.41907153508019634, 'recall': 0.8869115635443474, 'f1-score': 0.5691947940311908, 'support': 1509615}, '2': {'precision': 0.435139713140225, 'recall': 0.03388408734632217, 'f1-score': 0.06287234051918807, 'support': 1053828}, 'accuracy': 0.4206194130845608, 'macro avg': {'precision': 0.4286313963078631, 'recall': 0.3533048435913688, 'f1-score': 0.28083043194158636, 'support': 3616262}, 'weighted avg': {'precision': 0.42742563757753077, 'recall': 0.4206194130845608, 'f1-score': 0.3171949894406939, 'support': 3616262}}
[[ 146467  890455   15897]
 [ 140264 1338895   30456]
 [  52562  965558   35708]]
Evaluating performance on  train set...
4550/4550 - 193s - 193s/epoch - 42ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1405898
{'0': {'precision': 0.433035163771924, 'recall': 0.12713499965188332, 'f1-score': 0.19656143432882095, 'support': 359075}, '1': {'precision': 0.3861946799860611, 'recall': 0.8891588014396987, 'f1-score': 0.5384991749815257, 'support': 448705}, '2': {'precision': 0.4787914230019493, 'recall': 0.03446127771339419, 'f1-score': 0.06429489478327108, 'support': 356371}, 'accuracy': 0.3924765773512199, 'macro avg': {'precision': 0.43267375558664484, 'recall': 0.3502516929349921, 'f1-score': 0.2664518346978726, 'support': 1164151}, 'weighted avg': {'precision': 0.428988132571442, 'recall': 0.3924765773512199, 'f1-score': 0.2878667847130793, 'support': 1164151}}
[[ 45651 307885   5539]
 [ 41905 398970   7830]
 [ 17865 326225  12281]]
Evaluating performance on  val set...
1570/1570 - 61s - 61s/epoch - 39ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1326038
{'0': {'precision': 0.4218661049755209, 'recall': 0.12283377120645787, 'f1-score': 0.19026773048507295, 'support': 120659}, '1': {'precision': 0.39872547234555106, 'recall': 0.8936652435961828, 'f1-score': 0.5514231756331414, 'support': 159280}, '2': {'precision': 0.46047608353918706, 'recall': 0.03386625266322031, 'f1-score': 0.0630923076923077, 'support': 121094}, 'accuracy': 0.40212401473195475, 'macro avg': {'precision': 0.4270225536200863, 'recall': 0.35012175582195365, 'f1-score': 0.268261071270174, 'support': 401033}, 'weighted avg': {'precision': 0.4243337242958436, 'recall': 0.40212401473195475, 'f1-score': 0.2953081103428832, 'support': 401033}}
[[ 14821 103636   2202]
 [ 14334 142343   2603]
 [  5977 111016   4101]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2271273
{'0': {'precision': 0.3597675997887271, 'recall': 0.08446263130856849, 'f1-score': 0.13680706989555835, 'support': 56451}, '1': {'precision': 0.3168403603407748, 'recall': 0.8740886514853341, 'f1-score': 0.46509331883978483, 'support': 53355}, '2': {'precision': 0.398481125753853, 'recall': 0.0323669218767009, 'f1-score': 0.05987079452974243, 'support': 55118}, 'accuracy': 0.32250612403288786, 'macro avg': {'precision': 0.35836302862778496, 'recall': 0.3303060682235345, 'f1-score': 0.22059039442169517, 'support': 164924}, 'weighted avg': {'precision': 0.3588182489568307, 'recall': 0.32250612403288786, 'f1-score': 0.21729953422340734, 'support': 164924}}
[[ 4768 50462  1221]
 [ 5246 46637  1472]
 [ 3239 50095  1784]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2025629
{'0': {'precision': 0.39608076009501186, 'recall': 0.10480280731158016, 'f1-score': 0.16574860219507145, 'support': 19093}, '1': {'precision': 0.3326695976184374, 'recall': 0.8915777237662474, 'f1-score': 0.4845439274074287, 'support': 18926}, '2': {'precision': 0.44017403915881076, 'recall': 0.03172197543767964, 'f1-score': 0.059179097201910884, 'support': 19135}, 'accuracy': 0.3408685306365259, 'macro avg': {'precision': 0.3896414656240867, 'recall': 0.3427008355051691, 'f1-score': 0.236490542268137, 'support': 57154}, 'weighted avg': {'precision': 0.3898450676474866, 'recall': 0.3408685306365259, 'f1-score': 0.2356354490811152, 'support': 57154}}
[[ 2001 16694   398]
 [ 1678 16874   374]
 [ 1373 17155   607]]
Evaluating performance on  val set...
68/68 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2290626
{'0': {'precision': 0.4167164179104478, 'recall': 0.1152766308835673, 'f1-score': 0.18059508408796895, 'support': 6055}, '1': {'precision': 0.31257750799556167, 'recall': 0.8929703524146932, 'f1-score': 0.4630632372848578, 'support': 5363}, '2': {'precision': 0.3900414937759336, 'recall': 0.01615397834679498, 'f1-score': 0.031023102310231022, 'support': 5819}, 'accuracy': 0.323780240181006, 'macro avg': {'precision': 0.37311180656064763, 'recall': 0.3414669872150185, 'f1-score': 0.22489380789435257, 'support': 17237}, 'weighted avg': {'precision': 0.37531023601033336, 'recall': 0.323780240181006, 'f1-score': 0.2179865874603805, 'support': 17237}}
[[ 698 5275   82]
 [ 509 4789   65]
 [ 468 5257   94]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
2179/2179 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0827985
{'0': {'precision': 0.4299154641172157, 'recall': 0.19531220536286723, 'f1-score': 0.26859891689105375, 'support': 159094}, '1': {'precision': 0.4437968814693538, 'recall': 0.8543689713212922, 'f1-score': 0.5841569230641549, 'support': 247152}, '2': {'precision': 0.5996701710987425, 'recall': 0.03839402378344134, 'f1-score': 0.07216750601602619, 'support': 151534}, 'accuracy': 0.44470938362795365, 'macro avg': {'precision': 0.4911275055617707, 'recall': 0.3626917334892002, 'f1-score': 0.3083077819904116, 'support': 557780}, 'weighted avg': {'precision': 0.4821841539755009, 'recall': 0.44470938362795365, 'f1-score': 0.3550572964065578, 'support': 557780}}
[[ 31073 127128    893]
 [ 33002 211159   2991]
 [  8202 137514   5818]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1440499
{'0': {'precision': 0.4286639526276832, 'recall': 0.19067805329766438, 'f1-score': 0.26394724473373116, 'support': 48595}, '1': {'precision': 0.38690181610953644, 'recall': 0.8441943031036796, 'f1-score': 0.530617071929166, 'support': 61121}, '2': {'precision': 0.6135609293504031, 'recall': 0.02731629055751409, 'f1-score': 0.05230396119644301, 'support': 47371}, 'accuracy': 0.3956915594543151, 'macro avg': {'precision': 0.47637556602920755, 'recall': 0.3540628823196194, 'f1-score': 0.28228942595311335, 'support': 157087}, 'weighted avg': {'precision': 0.46817206684595913, 'recall': 0.3956915594543151, 'f1-score': 0.3038829015580851, 'support': 157087}}
[[ 9266 39060   269]
 [ 8977 51598   546]
 [ 3373 42704  1294]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1095991
{'0': {'precision': 0.38930568817350975, 'recall': 0.20715685562894678, 'f1-score': 0.27041879855978773, 'support': 13777}, '1': {'precision': 0.4313961485557084, 'recall': 0.8241670577193806, 'f1-score': 0.56634742510722, 'support': 21310}, '2': {'precision': 0.6943907156673114, 'recall': 0.026645884361315222, 'f1-score': 0.051322373123659754, 'support': 13473}, 'accuracy': 0.42784184514003293, 'macro avg': {'precision': 0.5050308507988431, 'recall': 0.3526565992365476, 'f1-score': 0.29602953226355583, 'support': 48560}, 'weighted avg': {'precision': 0.49242262157895955, 'recall': 0.42784184514003293, 'f1-score': 0.33949525844085915, 'support': 48560}}
[[ 2854 10880    43]
 [ 3632 17563   115]
 [  845 12269   359]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
1162/1162 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0392005
{'0': {'precision': 0.29929451153892145, 'recall': 0.07684514306766548, 'f1-score': 0.122291437645047, 'support': 65144}, '1': {'precision': 0.5467155618241655, 'recall': 0.8875090058736613, 'f1-score': 0.6766234461442499, 'support': 163782}, '2': {'precision': 0.2439106445969587, 'recall': 0.05289113909275282, 'f1-score': 0.08693149797959208, 'support': 68537}, 'accuracy': 0.5176744670765776, 'macro avg': {'precision': 0.36330690598668186, 'recall': 0.33908176267802653, 'f1-score': 0.2952821272562963, 'support': 297463}, 'weighted avg': {'precision': 0.42276287691282183, 'recall': 0.5176744670765776, 'f1-score': 0.4193574284780755, 'support': 297463}}
[[  5006  58521   1617]
 [  8804 145358   9620]
 [  2916  61996   3625]]
Evaluating performance on  train set...
327/327 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2236547
{'0': {'precision': 0.4051959890610757, 'recall': 0.06309887146000426, 'f1-score': 0.10919363753608058, 'support': 28178}, '1': {'precision': 0.3313431665861019, 'recall': 0.9195127256906678, 'f1-score': 0.48714525810324133, 'support': 27582}, '2': {'precision': 0.4006035458317616, 'recall': 0.038171231399611816, 'f1-score': 0.06970104682833984, 'support': 27822}, 'accuracy': 0.33741714723265775, 'macro avg': {'precision': 0.37904756715964644, 'recall': 0.3402609428500946, 'f1-score': 0.22201331415588724, 'support': 83582}, 'weighted avg': {'precision': 0.37929592080438523, 'recall': 0.33741714723265775, 'f1-score': 0.22077147414937848, 'support': 83582}}
[[ 1778 25681   719]
 [ 1350 25362   870]
 [ 1260 25500  1062]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1746435
{'0': {'precision': 0.3725379853685988, 'recall': 0.06953051150089276, 'f1-score': 0.11718888298813948, 'support': 9521}, '1': {'precision': 0.3977578475336323, 'recall': 0.9097435897435897, 'f1-score': 0.5535101404056163, 'support': 12675}, '2': {'precision': 0.35609756097560974, 'recall': 0.03803668195081284, 'f1-score': 0.06873175783824499, 'support': 9596}, 'accuracy': 0.3950050327126321, 'macro avg': {'precision': 0.3754644646259469, 'recall': 0.33910359439843174, 'f1-score': 0.2464769270773336, 'support': 31792}, 'weighted avg': {'precision': 0.37763044386339867, 'recall': 0.3950050327126321, 'f1-score': 0.2765175620529398, 'support': 31792}}
[[  662  8634   225]
 [  709 11531   435]
 [  406  8825   365]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1428456
{'0': {'precision': 0.31236749116607776, 'recall': 0.02556514194823348, 'f1-score': 0.04726219648028514, 'support': 103735}, '1': {'precision': 0.3610112266112266, 'recall': 0.9594656718001309, 'f1-score': 0.5246254281080585, 'support': 113114}, '2': {'precision': 0.3302705461970393, 'recall': 0.013453381019712218, 'f1-score': 0.025853629298115924, 'support': 96184}, 'accuracy': 0.35930716569818516, 'macro avg': {'precision': 0.3345497546581145, 'recall': 0.3328280649226922, 'f1-score': 0.19924708462881988, 'support': 313033}, 'weighted avg': {'precision': 0.3354458085838598, 'recall': 0.35930716569818516, 'f1-score': 0.21317857895911066, 'support': 313033}}
[[  2652  99901   1182]
 [  3143 108529   1442]
 [  2695  92195   1294]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1650286
{'0': {'precision': 0.3297653355290243, 'recall': 0.02591897488998188, 'f1-score': 0.04806048060480604, 'support': 30904}, '1': {'precision': 0.3295327952711152, 'recall': 0.9618115461181155, 'f1-score': 0.4908813817627635, 'support': 30140}, '2': {'precision': 0.3627450980392157, 'recall': 0.012181069958847737, 'f1-score': 0.02357063226628444, 'support': 30375}, 'accuracy': 0.32990953740469703, 'macro avg': {'precision': 0.3406810762797851, 'recall': 0.33330386365564835, 'f1-score': 0.18750416487795132, 'support': 91419}, 'weighted avg': {'precision': 0.34064656943963023, 'recall': 0.32990953740469703, 'f1-score': 0.18591741207001836, 'support': 91419}}
[[  801 29784   319]
 [  820 28989   331]
 [  808 29197   370]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1526055
{'0': {'precision': 0.3274760383386581, 'recall': 0.024126162174885255, 'f1-score': 0.044941357009755566, 'support': 8497}, '1': {'precision': 0.34364106139523437, 'recall': 0.9665474679893875, 'f1-score': 0.5070192424059059, 'support': 8669}, '2': {'precision': 0.3493975903614458, 'recall': 0.010751359367276322, 'f1-score': 0.02086080805658794, 'support': 8092}, 'accuracy': 0.34329717317285613, 'macro avg': {'precision': 0.34017156336511273, 'recall': 0.33380832984384967, 'f1-score': 0.19094046915741647, 'support': 25258}, 'weighted avg': {'precision': 0.3400472547392384, 'recall': 0.34329717317285613, 'f1-score': 0.1958200246148785, 'support': 25258}}
[[ 205 8213   79]
 [ 207 8379   83]
 [ 214 7791   87]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1979749
{'0': {'precision': 0.35607946060907736, 'recall': 0.06676848669975818, 'f1-score': 0.11245123397687813, 'support': 117855}, '1': {'precision': 0.35297196261682245, 'recall': 0.9045863543694529, 'f1-score': 0.5077993068716938, 'support': 130474}, '2': {'precision': 0.3989616927554472, 'recall': 0.04196660543778649, 'f1-score': 0.07594462869934343, 'support': 120858}, 'accuracy': 0.35474163499798206, 'macro avg': {'precision': 0.36933770532711563, 'recall': 0.3377738155023325, 'f1-score': 0.23206505651597178, 'support': 369187}, 'weighted avg': {'precision': 0.3690192800493732, 'recall': 0.35474163499798206, 'f1-score': 0.2402198963681484, 'support': 369187}}
[[  7869 106645   3341]
 [  8149 118025   4300]
 [  6081 109705   5072]]
Evaluating performance on  train set...
494/494 - 11s - 11s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2299373
{'0': {'precision': 0.3754192942439286, 'recall': 0.06724668333012881, 'f1-score': 0.11406208597460303, 'support': 41608}, '1': {'precision': 0.3277953105031168, 'recall': 0.9070438799076213, 'f1-score': 0.48156024292583866, 'support': 41568}, '2': {'precision': 0.3977987421383648, 'recall': 0.03520734762037295, 'f1-score': 0.06468933776527742, 'support': 43116}, 'accuracy': 0.33272099578754, 'macro avg': {'precision': 0.3670044489618034, 'recall': 0.33649930361937436, 'f1-score': 0.22010388888857302, 'support': 126292}, 'weighted avg': {'precision': 0.3673845693150214, 'recall': 0.33272099578754, 'f1-score': 0.218165338566657, 'support': 126292}}
[[ 2798 37868   942]
 [ 2508 37704  1356]
 [ 2147 39451  1518]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2129557
{'0': {'precision': 0.39023186975826346, 'recall': 0.06347805152074472, 'f1-score': 0.10919381557150745, 'support': 12461}, '1': {'precision': 0.34683319995427003, 'recall': 0.9233754375285345, 'f1-score': 0.5042592977353002, 'support': 13142}, '2': {'precision': 0.4077669902912621, 'recall': 0.03682742128337983, 'f1-score': 0.06755373592630501, 'support': 12545}, 'accuracy': 0.35094893572402225, 'macro avg': {'precision': 0.38161068666793185, 'recall': 0.3412269701108863, 'f1-score': 0.2270022830777042, 'support': 38148}, 'weighted avg': {'precision': 0.3810474503528526, 'recall': 0.35094893572402225, 'f1-score': 0.23160064600685135, 'support': 38148}}
[[  791 11345   325]
 [  661 12135   346]
 [  575 11508   462]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
5521/5521 - 71s - 71s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0488805
{'0': {'precision': 0.5411822020136408, 'recall': 0.24573071818315884, 'f1-score': 0.3379918864097363, 'support': 406860}, '1': {'precision': 0.4322508807942235, 'recall': 0.8522728796288848, 'f1-score': 0.5735911070656553, 'support': 596688}, '2': {'precision': 0.6118290926548248, 'recall': 0.07775489186405768, 'f1-score': 0.13797508644824907, 'support': 409762}, 'accuracy': 0.4531065371362263, 'macro avg': {'precision': 0.5284207251542297, 'recall': 0.39191949655870045, 'f1-score': 0.34985269330788027, 'support': 1413310}, 'weighted avg': {'precision': 0.5156749877486466, 'recall': 0.4531065371362263, 'f1-score': 0.37946894649486984, 'support': 1413310}}
[[ 99978 303963   2919]
 [ 70852 508541  17295]
 [ 13910 363991  31861]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0745567
{'0': {'precision': 0.5049114657688948, 'recall': 0.24558239799355366, 'f1-score': 0.33044205829033607, 'support': 96489}, '1': {'precision': 0.4250319891785179, 'recall': 0.84323865614483, 'f1-score': 0.5651844181603396, 'support': 137872}, '2': {'precision': 0.628007336282231, 'recall': 0.06103660518617161, 'f1-score': 0.11125977178462891, 'support': 95369}, 'accuracy': 0.4421071786006733, 'macro avg': {'precision': 0.5193169304098812, 'recall': 0.38328588644151845, 'f1-score': 0.3356287494117682, 'support': 329730}, 'weighted avg': {'precision': 0.5071144405619616, 'recall': 0.4421071786006733, 'f1-score': 0.3652014164264909, 'support': 329730}}
[[ 23696  72029    764]
 [ 18929 116259   2684]
 [  4306  85242   5821]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.053684
{'0': {'precision': 0.46708703544473107, 'recall': 0.3077068319853982, 'f1-score': 0.3710041547305116, 'support': 31777}, '1': {'precision': 0.4456399859555334, 'recall': 0.7993417711232554, 'f1-score': 0.5722471893770816, 'support': 49223}, '2': {'precision': 0.6497611172363101, 'recall': 0.05713177793575906, 'f1-score': 0.10502866308254373, 'support': 30946}, 'accuracy': 0.45461204509316994, 'macro avg': {'precision': 0.5208293795455249, 'recall': 0.38806012701480425, 'f1-score': 0.349426669063379, 'support': 111946}, 'weighted avg': {'precision': 0.5081545503011389, 'recall': 0.45461204509316994, 'f1-score': 0.38596590709209755, 'support': 111946}}
[[ 9778 21804   195]
 [ 9119 39346   758]
 [ 2037 27141  1768]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
5918/5918 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0379016
{'0': {'precision': 0.4452881332864547, 'recall': 0.20392247502356758, 'f1-score': 0.27973744444741316, 'support': 385063}, '1': {'precision': 0.5033236723443866, 'recall': 0.8886587018697174, 'f1-score': 0.6426560703232926, 'support': 749632}, '2': {'precision': 0.5352280237937872, 'recall': 0.021292987618093517, 'f1-score': 0.04095659804320723, 'support': 380313}, 'accuracy': 0.4968871451503886, 'macro avg': {'precision': 0.49461327647487613, 'recall': 0.37129138817045954, 'f1-score': 0.3211167042713044, 'support': 1515008}, 'weighted avg': {'precision': 0.4965819923245527, 'recall': 0.4968871451503886, 'f1-score': 0.3993697865301378, 'support': 1515008}}
[[ 78523 305478   1062]
 [ 77495 666167   5970]
 [ 20324 351891   8098]]
Evaluating performance on  train set...
1814/1814 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0681411
{'0': {'precision': 0.43035277238585534, 'recall': 0.1660506691849295, 'f1-score': 0.23963767094318342, 'support': 122836}, '1': {'precision': 0.4716965495724746, 'recall': 0.8908868265016757, 'f1-score': 0.6168110509775424, 'support': 217224}, '2': {'precision': 0.5372637944066515, 'recall': 0.02861076002865906, 'f1-score': 0.05432838558784414, 'support': 124219}, 'accuracy': 0.4684101585469082, 'macro avg': {'precision': 0.47977103878832716, 'recall': 0.36184941857175473, 'f1-score': 0.3035923691695233, 'support': 464279}, 'weighted avg': {'precision': 0.4783007538797146, 'recall': 0.4684101585469082, 'f1-score': 0.3665272700571401, 'support': 464279}}
[[ 20397 101583    856]
 [ 21497 193522   2205]
 [  5502 115163   3554]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0222778
{'0': {'precision': 0.41201108715737605, 'recall': 0.17067694113444412, 'f1-score': 0.24136686753509182, 'support': 39191}, '1': {'precision': 0.528417211283631, 'recall': 0.8972939222223532, 'f1-score': 0.6651355115906401, 'support': 84883}, '2': {'precision': 0.49255002128565345, 'recall': 0.029936866073276756, 'f1-score': 0.05644315437714955, 'support': 38648}, 'accuracy': 0.5162854438858913, 'macro avg': {'precision': 0.4776594399088869, 'recall': 0.36596924314335805, 'f1-score': 0.3209818445009605, 'support': 162722}, 'weighted avg': {'precision': 0.4918624272367664, 'recall': 0.5162854438858913, 'f1-score': 0.4185022404240617, 'support': 162722}}
[[ 6689 32186   316]
 [ 7842 76165   876]
 [ 1704 35787  1157]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
3755/3755 - 59s - 59s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1591288
{'0': {'precision': 0.4781478786438765, 'recall': 0.10181733089209538, 'f1-score': 0.16788503853253103, 'support': 316233}, '1': {'precision': 0.3638890354005233, 'recall': 0.9171724177793191, 'f1-score': 0.5210507045907168, 'support': 346020}, '2': {'precision': 0.46685108344859383, 'recall': 0.0338764176507979, 'f1-score': 0.0631690580162196, 'support': 298910}, 'accuracy': 0.3742174844433254, 'macro avg': {'precision': 0.43629599916433115, 'recall': 0.35095538877407084, 'f1-score': 0.2507016003798225, 'support': 961163}, 'weighted avg': {'precision': 0.4335013722855512, 'recall': 0.3742174844433254, 'f1-score': 0.26245976730727866, 'support': 961163}}
[[ 32198 279043   4992]
 [ 22088 317360   6572]
 [ 13053 275731  10126]]
Evaluating performance on  train set...
1532/1532 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1867614
{'0': {'precision': 0.4419247395648785, 'recall': 0.0956441717791411, 'f1-score': 0.15725435311621336, 'support': 130400}, '1': {'precision': 0.33493279724618924, 'recall': 0.9122820434383604, 'f1-score': 0.4899768134871982, 'support': 130760}, '2': {'precision': 0.4743523980507823, 'recall': 0.02823211546240679, 'f1-score': 0.053292416744105627, 'support': 131021}, 'accuracy': 0.34540429036592796, 'macro avg': {'precision': 0.4170699782872833, 'recall': 0.34538611022663607, 'f1-score': 0.23350786111583907, 'support': 392181}, 'weighted avg': {'precision': 0.4170852849887766, 'recall': 0.34540429036592796, 'f1-score': 0.2334579225209016, 'support': 392181}}
[[ 12472 115959   1969]
 [  9340 119290   2130]
 [  6410 120912   3699]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1703557
{'0': {'precision': 0.4452211318725635, 'recall': 0.08607963405759435, 'f1-score': 0.14426657954916697, 'support': 38476}, '1': {'precision': 0.35245526729847415, 'recall': 0.9235360387353484, 'f1-score': 0.5101996226040322, 'support': 41719}, '2': {'precision': 0.4836377473363775, 'recall': 0.032433397978973155, 'f1-score': 0.060790128180600735, 'support': 39188}, 'accuracy': 0.3611234430362782, 'macro avg': {'precision': 0.4271047155024717, 'recall': 0.3473496902573053, 'f1-score': 0.2384187767779333, 'support': 119383}, 'weighted avg': {'precision': 0.42541405065186627, 'recall': 0.3611234430362782, 'f1-score': 0.2447422372807916, 'support': 119383}}
[[ 3312 34534   630]
 [ 2463 38529   727]
 [ 1664 36253  1271]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
4960/4960 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1795318
{'0': {'precision': 0.45323026351436774, 'recall': 0.11717790551614966, 'f1-score': 0.18621252597209853, 'support': 428306}, '1': {'precision': 0.3223848635023711, 'recall': 0.8783598304443561, 'f1-score': 0.4716571565484391, 'support': 412372}, '2': {'precision': 0.48573849195142615, 'recall': 0.04009305317923926, 'f1-score': 0.07407216006477008, 'support': 429002}, 'accuracy': 0.33835218322726984, 'macro avg': {'precision': 0.42045120632272165, 'recall': 0.34521026304658164, 'f1-score': 0.24398061419510256, 'support': 1269680}, 'weighted avg': {'precision': 0.42171769004877624, 'recall': 0.33835218322726984, 'f1-score': 0.24103022172618693, 'support': 1269680}}
[[ 50188 369298   8820]
 [ 40771 362211   9390]
 [ 19775 392027  17200]]
Evaluating performance on  train set...
1691/1691 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1681912
{'0': {'precision': 0.45021582386843184, 'recall': 0.12669652551574376, 'f1-score': 0.19774504975401028, 'support': 147360}, '1': {'precision': 0.32965934762426985, 'recall': 0.8740978348035284, 'f1-score': 0.4787585506238948, 'support': 143405}, '2': {'precision': 0.4927249865277528, 'recall': 0.038612321314198436, 'f1-score': 0.07161272215804142, 'support': 142079}, 'accuracy': 0.34540388685068985, 'macro avg': {'precision': 0.4242000526734848, 'recall': 0.34646889387782354, 'f1-score': 0.24937210751198213, 'support': 432844}, 'weighted avg': {'precision': 0.4242278416985961, 'recall': 0.34540388685068985, 'f1-score': 0.24944493728794428, 'support': 432844}}
[[ 18670 125991   2699]
 [ 15106 125350   2949]
 [  7693 128900   5486]]
Evaluating performance on  val set...
591/591 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.211615
{'0': {'precision': 0.4456934415246036, 'recall': 0.11205105650277929, 'f1-score': 0.1790799234266571, 'support': 53431}, '1': {'precision': 0.2828830583247822, 'recall': 0.8739153573825115, 'f1-score': 0.4274138789552306, 'support': 43217}, '2': {'precision': 0.4782816229116945, 'recall': 0.036780090298425286, 'f1-score': 0.0683073147453814, 'support': 54486}, 'accuracy': 0.3027710508555322, 'macro avg': {'precision': 0.40228604092036013, 'recall': 0.340915501394572, 'f1-score': 0.2249337057090897, 'support': 151134}, 'weighted avg': {'precision': 0.41088607402496985, 'recall': 0.3027710508555322, 'f1-score': 0.2101562675945503, 'support': 151134}}
[[ 5987 46168  1276]
 [ 4539 37768   910]
 [ 2907 49575  2004]]
testing model on single stock: results/universal/W8/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
10609/10609 - 147s - 147s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2443707
{'0': {'precision': 0.4219809142907556, 'recall': 0.05805264659059417, 'f1-score': 0.10206415084945283, 'support': 988706}, '1': {'precision': 0.26766144133278974, 'recall': 0.9127244119397766, 'f1-score': 0.4139343604671467, 'support': 720717}, '2': {'precision': 0.44075658487813674, 'recall': 0.053447472271055466, 'f1-score': 0.09533440694295127, 'support': 1006259}, 'accuracy': 0.28316827964393476, 'macro avg': {'precision': 0.37679964683389405, 'recall': 0.3414081769338087, 'f1-score': 0.20377763941985028, 'support': 2715682}, 'weighted avg': {'precision': 0.3879830161265896, 'recall': 0.28316827964393476, 'f1-score': 0.18233801814739978, 'support': 2715682}}
[[ 57397 891451  39858]
 [ 34519 657816  28382]
 [ 44102 908375  53782]]
Evaluating performance on  train set...
3903/3903 - 61s - 61s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1902869
{'0': {'precision': 0.4030293375162374, 'recall': 0.04925344076198464, 'f1-score': 0.08777951562191393, 'support': 333865}, '1': {'precision': 0.3327459465434672, 'recall': 0.9317078351641682, 'f1-score': 0.49036510467782135, 'support': 329540}, '2': {'precision': 0.4165939602037657, 'recall': 0.04409845735838264, 'f1-score': 0.0797545185875659, 'support': 335658}, 'accuracy': 0.3385982665757815, 'macro avg': {'precision': 0.3841230814211567, 'recall': 0.34168657776151184, 'f1-score': 0.2192997129624337, 'support': 999063}, 'weighted avg': {'precision': 0.38440377082112775, 'recall': 0.3385982665757815, 'f1-score': 0.21787581641868906, 'support': 999063}}
[[ 16444 306908  10513]
 [ 12289 307035  10216]
 [ 12068 308788  14802]]
Evaluating performance on  val set...
1144/1144 - 26s - 26s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1971797
{'0': {'precision': 0.41767403084618593, 'recall': 0.04962017292778829, 'f1-score': 0.08870239549583045, 'support': 100967}, '1': {'precision': 0.3196253798087332, 'recall': 0.9229135903598875, 'f1-score': 0.47481264400003326, 'support': 92779}, '2': {'precision': 0.41161695447409735, 'recall': 0.05303022642005521, 'f1-score': 0.09395576339057755, 'support': 98887}, 'accuracy': 0.32764930817782, 'macro avg': {'precision': 0.38297212170967215, 'recall': 0.34185466323591035, 'f1-score': 0.21915693429548042, 'support': 292633}, 'weighted avg': {'precision': 0.38454098738967024, 'recall': 0.32764930817782, 'f1-score': 0.21289348992803492, 'support': 292633}}
[[ 5010 92170  3787]
 [ 3443 85627  3709]
 [ 3542 90101  5244]]
training model: results/universal/W8/deepVOL_L2/h200
Epoch 1/50
7696/7696 - 511s - loss: 3.2512 - accuracy200: 0.3847 - val_loss: 3.3544 - val_accuracy200: 0.3355 - 511s/epoch - 66ms/step
Epoch 2/50
7696/7696 - 493s - loss: 3.2351 - accuracy200: 0.3934 - val_loss: 3.3209 - val_accuracy200: 0.3463 - 493s/epoch - 64ms/step
Epoch 3/50
7696/7696 - 475s - loss: 3.2280 - accuracy200: 0.3952 - val_loss: 3.3331 - val_accuracy200: 0.3469 - 475s/epoch - 62ms/step
Epoch 4/50
7696/7696 - 479s - loss: 3.2194 - accuracy200: 0.3983 - val_loss: 3.3622 - val_accuracy200: 0.3432 - 479s/epoch - 62ms/step
Epoch 5/50
7696/7696 - 472s - loss: 3.2125 - accuracy200: 0.4019 - val_loss: 3.3302 - val_accuracy200: 0.3378 - 472s/epoch - 61ms/step
Epoch 6/50
7696/7696 - 469s - loss: 3.2065 - accuracy200: 0.4049 - val_loss: 3.3324 - val_accuracy200: 0.3437 - 469s/epoch - 61ms/step
Epoch 7/50
7696/7696 - 492s - loss: 3.2011 - accuracy200: 0.4075 - val_loss: 3.3161 - val_accuracy200: 0.3491 - 492s/epoch - 64ms/step
Epoch 8/50
7696/7696 - 469s - loss: 3.1965 - accuracy200: 0.4095 - val_loss: 3.3417 - val_accuracy200: 0.3427 - 469s/epoch - 61ms/step
Epoch 9/50
7696/7696 - 467s - loss: 3.1940 - accuracy200: 0.4115 - val_loss: 3.3439 - val_accuracy200: 0.3418 - 467s/epoch - 61ms/step
Epoch 10/50
7696/7696 - 465s - loss: 3.1887 - accuracy200: 0.4139 - val_loss: 3.3686 - val_accuracy200: 0.3428 - 465s/epoch - 60ms/step
Epoch 11/50
7696/7696 - 468s - loss: 3.1858 - accuracy200: 0.4155 - val_loss: 3.3618 - val_accuracy200: 0.3458 - 468s/epoch - 61ms/step
Epoch 12/50
7696/7696 - 463s - loss: 3.1821 - accuracy200: 0.4171 - val_loss: 3.3434 - val_accuracy200: 0.3506 - 463s/epoch - 60ms/step
Epoch 13/50
7696/7696 - 469s - loss: 3.1794 - accuracy200: 0.4185 - val_loss: 3.3550 - val_accuracy200: 0.3504 - 469s/epoch - 61ms/step
Epoch 14/50
7696/7696 - 470s - loss: 3.1777 - accuracy200: 0.4196 - val_loss: 3.3878 - val_accuracy200: 0.3486 - 470s/epoch - 61ms/step
Epoch 15/50
7696/7696 - 459s - loss: 3.1749 - accuracy200: 0.4208 - val_loss: 3.3678 - val_accuracy200: 0.3514 - 459s/epoch - 60ms/step
Epoch 16/50
7696/7696 - 466s - loss: 3.1734 - accuracy200: 0.4214 - val_loss: 3.3932 - val_accuracy200: 0.3488 - 466s/epoch - 61ms/step
Epoch 17/50
7696/7696 - 465s - loss: 3.1717 - accuracy200: 0.4223 - val_loss: 3.4029 - val_accuracy200: 0.3468 - 465s/epoch - 60ms/step
testing model in sample: results/universal/W8/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 872s - 872s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1094223
{'0': {'precision': 0.39244972389413774, 'recall': 0.24958413320066694, 'f1-score': 0.3051216788042253, 'support': 2076386}, '1': {'precision': 0.31264827164772013, 'recall': 0.7106994665246522, 'f1-score': 0.43425895535123005, 'support': 1845821}, '2': {'precision': 0.3968948346205922, 'recall': 0.08655502042662186, 'f1-score': 0.1421170785725072, 'support': 2038761}, 'accuracy': 0.3366100941994656, 'macro avg': {'precision': 0.3673309433874834, 'recall': 0.3489462067173137, 'f1-score': 0.29383257090932086, 'support': 5960968}, 'weighted avg': {'precision': 0.3692594168840753, 'recall': 0.3366100941994656, 'f1-score': 0.2893586140067379, 'support': 5960968}}
[[ 518233 1413085  145068]
 [ 410916 1311824  123081]
 [ 391359 1470937  176465]]
Evaluating performance on  train set...
7696/7696 - 278s - 278s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1117046
{'0': {'precision': 0.368152053802563, 'recall': 0.25190959989696265, 'f1-score': 0.29913488770453756, 'support': 659955}, '1': {'precision': 0.3307375930974539, 'recall': 0.7075637043757761, 'f1-score': 0.4507707293015227, 'support': 645874}, '2': {'precision': 0.38590692755156003, 'recall': 0.07917113060931122, 'f1-score': 0.13138735413595598, 'support': 663651}, 'accuracy': 0.34313016633832283, 'macro avg': {'precision': 0.3615988581505256, 'recall': 0.34621481162735, 'f1-score': 0.29376432371400546, 'support': 1969480}, 'weighted avg': {'precision': 0.36186512137620885, 'recall': 0.34313016633832283, 'f1-score': 0.2923370675465712, 'support': 1969480}}
[[166249 451140  42566]
 [147833 456997  41044]
 [137495 473614  52542]]
Evaluating performance on  val set...
2338/2338 - 83s - 83s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069714
{'0': {'precision': 0.3678187452346477, 'recall': 0.26268646277738367, 'f1-score': 0.3064875718744626, 'support': 200174}, '1': {'precision': 0.3383543418394549, 'recall': 0.6927221290338733, 'f1-score': 0.45464239882878166, 'support': 199715}, '2': {'precision': 0.3843139815842748, 'recall': 0.08921578040436402, 'f1-score': 0.144814009760899, 'support': 197891}, 'accuracy': 0.34893271772223894, 'macro avg': {'precision': 0.3634956895527925, 'recall': 0.3482081240718737, 'f1-score': 0.30198132682138107, 'support': 597780}, 'weighted avg': {'precision': 0.3634354863306916, 'recall': 0.34893271772223894, 'f1-score': 0.3024643499282058, 'support': 597780}}
[[ 52583 133052  14539]
 [ 47623 138347  13745]
 [ 42753 137483  17655]]
testing model out of sample: results/universal/W8/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 528s - 528s/epoch - 37ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955862
{'0': {'precision': 0.3670513610768667, 'recall': 0.30663179255761924, 'f1-score': 0.3341321990924493, 'support': 1149659}, '1': {'precision': 0.36750593090727757, 'recall': 0.6743068162589325, 'f1-score': 0.47573185277378044, 'support': 1306039}, '2': {'precision': 0.38055344680752673, 'recall': 0.08509138660168676, 'f1-score': 0.13908377433427344, 'support': 1160564}, 'accuracy': 0.3683214877683088, 'macro avg': {'precision': 0.37170357959722367, 'recall': 0.35534333180607947, 'f1-score': 0.3163159420668344, 'support': 3616262}, 'weighted avg': {'precision': 0.3715487455447669, 'recall': 0.3683214877683088, 'f1-score': 0.3226752001425016, 'support': 3616262}}
[[352522 724557  72580]
 [337201 880671  88167]
 [270693 791117  98754]]
Evaluating performance on  train set...
4550/4550 - 171s - 171s/epoch - 38ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029221
{'0': {'precision': 0.37261869703216516, 'recall': 0.2951608304605894, 'f1-score': 0.329397471869486, 'support': 385810}, '1': {'precision': 0.34364198207846, 'recall': 0.6730551027886231, 'f1-score': 0.4549830879087089, 'support': 395715}, '2': {'precision': 0.39500095812973074, 'recall': 0.08619644247907879, 'f1-score': 0.1415123079365488, 'support': 382626}, 'accuracy': 0.35493247869047917, 'macro avg': {'precision': 0.3704205457467853, 'recall': 0.3514707919094304, 'f1-score': 0.3086309559049146, 'support': 1164151}, 'weighted avg': {'precision': 0.3701254760297451, 'recall': 0.35493247869047917, 'f1-score': 0.3103332467955541, 'support': 1164151}}
[[113876 246694  25240]
 [104102 266338  25275]
 [ 87632 262013  32981]]
Evaluating performance on  val set...
1570/1570 - 56s - 56s/epoch - 36ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011744
{'0': {'precision': 0.36481537992065916, 'recall': 0.29210188748396554, 'f1-score': 0.32443434309169245, 'support': 130968}, '1': {'precision': 0.3543256708462051, 'recall': 0.6711003714273422, 'f1-score': 0.46378398735400367, 'support': 139462}, '2': {'precision': 0.38882123341139735, 'recall': 0.09534237345237093, 'f1-score': 0.15313476154167796, 'support': 130603}, 'accuracy': 0.3598232564402431, 'macro avg': {'precision': 0.3693207613927539, 'recall': 0.3528482107878929, 'f1-score': 0.31378436399579135, 'support': 401033}, 'weighted avg': {'precision': 0.36898541250278927, 'recall': 0.3598232564402431, 'f1-score': 0.31710761646055213, 'support': 401033}}
[[38256 82670 10042]
 [36338 93593  9531]
 [30270 87881 12452]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
645/645 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176124
{'0': {'precision': 0.3294723589332723, 'recall': 0.2615720127214902, 'f1-score': 0.29162192280417387, 'support': 55025}, '1': {'precision': 0.326266572727855, 'recall': 0.653100846184842, 'f1-score': 0.43514817956055624, 'support': 54598}, '2': {'precision': 0.3616504854368932, 'recall': 0.07813601924015841, 'f1-score': 0.12850748710017995, 'support': 55301}, 'accuracy': 0.3296791249302709, 'macro avg': {'precision': 0.33912980569934015, 'recall': 0.3309362927154969, 'f1-score': 0.2850925298216367, 'support': 164924}, 'weighted avg': {'precision': 0.339200797841699, 'recall': 0.3296791249302709, 'f1-score': 0.2844419802701485, 'support': 164924}}
[[14393 36812  3820]
 [15133 35658  3807]
 [14159 36821  4321]]
Evaluating performance on  train set...
224/224 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1174002
{'0': {'precision': 0.37059258650447935, 'recall': 0.23577703409328593, 'f1-score': 0.28819788437569904, 'support': 19124}, '1': {'precision': 0.33713494941782784, 'recall': 0.75, 'f1-score': 0.4651698709507507, 'support': 18840}, '2': {'precision': 0.3648780487804878, 'recall': 0.058467952058363734, 'f1-score': 0.10078598697507297, 'support': 19190}, 'accuracy': 0.34575007873464675, 'macro avg': {'precision': 0.3575351949009316, 'recall': 0.34808166205054986, 'f1-score': 0.28471791410050756, 'support': 57154}, 'weighted avg': {'precision': 0.35764504369669836, 'recall': 0.34575007873464675, 'f1-score': 0.2836088427680418, 'support': 57154}}
[[ 4509 13559  1056]
 [ 3813 14130   897]
 [ 3845 14223  1122]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1250377
{'0': {'precision': 0.37103960396039604, 'recall': 0.24437561134659277, 'f1-score': 0.29467269510517, 'support': 6134}, '1': {'precision': 0.31431560312223383, 'recall': 0.7442835365853658, 'f1-score': 0.44198019801980193, 'support': 5248}, '2': {'precision': 0.36233766233766235, 'recall': 0.04765157984628523, 'f1-score': 0.08422641509433963, 'support': 5855}, 'accuracy': 0.3297557579625225, 'macro avg': {'precision': 0.3492309564734308, 'recall': 0.34543690925941467, 'f1-score': 0.27362643607310383, 'support': 17237}, 'weighted avg': {'precision': 0.350813495902162, 'recall': 0.3297557579625225, 'f1-score': 0.2680385247641928, 'support': 17237}}
[[1499 4344  291]
 [1142 3906  200]
 [1399 4177  279]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
2179/2179 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1103164
{'0': {'precision': 0.39157842838025025, 'recall': 0.17401806069269174, 'f1-score': 0.24095523940579255, 'support': 191687}, '1': {'precision': 0.3278772752385682, 'recall': 0.8197698480524157, 'f1-score': 0.46840862255882015, 'support': 186051}, '2': {'precision': 0.42462616192913916, 'recall': 0.017507026138345497, 'f1-score': 0.03362761048729096, 'support': 180042}, 'accuracy': 0.33889347054394203, 'macro avg': {'precision': 0.38136062184931924, 'recall': 0.33709831162781767, 'f1-score': 0.2476638241506346, 'support': 557780}, 'weighted avg': {'precision': 0.3809977636028218, 'recall': 0.33889347054394203, 'f1-score': 0.24990186428165595, 'support': 557780}}
[[ 33357 155989   2341]
 [ 31602 152519   1930]
 [ 20227 156663   3152]]
Evaluating performance on  train set...
614/614 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211419
{'0': {'precision': 0.39715992336301137, 'recall': 0.1937470219550636, 'f1-score': 0.26044219991377715, 'support': 54566}, '1': {'precision': 0.3195507872195359, 'recall': 0.8097507695362923, 'f1-score': 0.4582593450066309, 'support': 50355}, '2': {'precision': 0.42204394837809556, 'recall': 0.02319518460299812, 'f1-score': 0.043973615830501696, 'support': 52166}, 'accuracy': 0.33457256170147753, 'macro avg': {'precision': 0.37958488632021425, 'recall': 0.3422309920314513, 'f1-score': 0.2542250535836366, 'support': 157087}, 'weighted avg': {'precision': 0.38054551223053174, 'recall': 0.33457256170147753, 'f1-score': 0.25196780154766474, 'support': 157087}}
[[10572 43101   893]
 [ 8816 40775   764]
 [ 7231 43725  1210]]
Evaluating performance on  val set...
190/190 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096222
{'0': {'precision': 0.3677820852887166, 'recall': 0.22165518937530743, 'f1-score': 0.27660553978362623, 'support': 16264}, '1': {'precision': 0.3327816309373686, 'recall': 0.7561485195797517, 'f1-score': 0.4621643315820198, 'support': 16752}, '2': {'precision': 0.4884726224783862, 'recall': 0.02180905815748842, 'f1-score': 0.04175391058012071, 'support': 15544}, 'accuracy': 0.3420716639209226, 'macro avg': {'precision': 0.39634544623482376, 'recall': 0.3332042557041825, 'f1-score': 0.2601745939819223, 'support': 48560}, 'weighted avg': {'precision': 0.3943406952306944, 'recall': 0.3420716639209226, 'f1-score': 0.2654430018072547, 'support': 48560}}
[[ 3605 12530   129]
 [ 3859 12667   226]
 [ 2338 12867   339]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
1162/1162 - 16s - 16s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.078265
{'0': {'precision': 0.30192605416923307, 'recall': 0.23254651058428322, 'f1-score': 0.2627332251709353, 'support': 77993}, '1': {'precision': 0.4534005520625671, 'recall': 0.6927069986747985, 'f1-score': 0.5480702669041723, 'support': 136583}, '2': {'precision': 0.26100278551532036, 'recall': 0.09043637723647859, 'f1-score': 0.1343284919404697, 'support': 82887}, 'accuracy': 0.40423514857309983, 'macro avg': {'precision': 0.33877646391570687, 'recall': 0.3385632954985201, 'f1-score': 0.31504399467185906, 'support': 297463}, 'weighted avg': {'precision': 0.3600739057569881, 'recall': 0.40423514857309983, 'f1-score': 0.35796895548958707, 'support': 297463}}
[[18137 54566  5290]
 [26037 94612 15934]
 [15897 59494  7496]]
Evaluating performance on  train set...
327/327 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.12019
{'0': {'precision': 0.3662293211637193, 'recall': 0.20036063527290382, 'f1-score': 0.25901602600022416, 'support': 28838}, '1': {'precision': 0.323020175843045, 'recall': 0.7526208557140212, 'f1-score': 0.45203132648066574, 'support': 26995}, '2': {'precision': 0.36613691931540343, 'recall': 0.06475909041767271, 'f1-score': 0.11005297485990752, 'support': 27749}, 'accuracy': 0.3337082146873729, 'macro avg': {'precision': 0.35179547210738926, 'recall': 0.33924686046819924, 'f1-score': 0.27370010911359915, 'support': 83582}, 'weighted avg': {'precision': 0.3522431167558262, 'recall': 0.3337082146873729, 'f1-score': 0.2719000480429711, 'support': 83582}}
[[ 5778 21447  1613]
 [ 5180 20317  1498]
 [ 4819 21133  1797]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1095215
{'0': {'precision': 0.3316236292889989, 'recall': 0.18577231744773606, 'f1-score': 0.2381405982091827, 'support': 10093}, '1': {'precision': 0.35735600703102643, 'recall': 0.7564901349948079, 'f1-score': 0.4854104778033816, 'support': 11556}, '2': {'precision': 0.351044776119403, 'recall': 0.057971014492753624, 'f1-score': 0.09950922321881876, 'support': 10143}, 'accuracy': 0.35244715651736286, 'macro avg': {'precision': 0.34667480414647606, 'recall': 0.33341115564509916, 'f1-score': 0.2743534330771277, 'support': 31792}, 'weighted avg': {'precision': 0.34717320306503247, 'recall': 0.35244715651736286, 'f1-score': 0.28379084644972435, 'support': 31792}}
[[1875 7726  492]
 [2219 8742  595]
 [1560 7995  588]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1223/1223 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1176853
{'0': {'precision': 0.30648728345005527, 'recall': 0.08114649308571373, 'f1-score': 0.12831889134947028, 'support': 102469}, '1': {'precision': 0.3601094404802356, 'recall': 0.8974718605553791, 'f1-score': 0.5139836116920776, 'support': 113364}, '2': {'precision': 0.3291851851851852, 'recall': 0.011430041152263374, 'f1-score': 0.022092965448670145, 'support': 97200}, 'accuracy': 0.35512869250206847, 'macro avg': {'precision': 0.331927303038492, 'recall': 0.3300161315977854, 'f1-score': 0.221465156163406, 'support': 313033}, 'weighted avg': {'precision': 0.3329543276857237, 'recall': 0.35512869250206847, 'f1-score': 0.2350020057794555, 'support': 313033}}
[[  8315  93134   1020]
 [ 10379 101741   1244]
 [  8436  87653   1111]]
Evaluating performance on  train set...
358/358 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1323323
{'0': {'precision': 0.32105331430795175, 'recall': 0.08194821534997682, 'f1-score': 0.13056896415288438, 'support': 30202}, '1': {'precision': 0.33060647437678986, 'recall': 0.9034175334323923, 'f1-score': 0.48406786857981987, 'support': 30285}, '2': {'precision': 0.35257082896117525, 'recall': 0.010862537178326652, 'f1-score': 0.021075740944017565, 'support': 30932}, 'accuracy': 0.3300298625012306, 'macro avg': {'precision': 0.3347435392153056, 'recall': 0.3320760953202319, 'f1-score': 0.21190419122557394, 'support': 91419}, 'weighted avg': {'precision': 0.33488213781223714, 'recall': 0.3300298625012306, 'f1-score': 0.21062748525104857, 'support': 91419}}
[[ 2475 27395   332]
 [ 2640 27360   285]
 [ 2594 28002   336]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241442
{'0': {'precision': 0.33299284984678246, 'recall': 0.07691400259525775, 'f1-score': 0.12496406324868231, 'support': 8477}, '1': {'precision': 0.34235248279146285, 'recall': 0.9127423822714681, 'f1-score': 0.4979378522179895, 'support': 8664}, '2': {'precision': 0.3283582089552239, 'recall': 0.008131082912406062, 'f1-score': 0.015869199326761244, 'support': 8117}, 'accuracy': 0.3415155594267163, 'macro avg': {'precision': 0.33456784719782307, 'recall': 0.33259582259304393, 'f1-score': 0.21292370493114432, 'support': 25258}, 'weighted avg': {'precision': 0.3347139869010199, 'recall': 0.3415155594267163, 'f1-score': 0.21784243434599185, 'support': 25258}}
[[ 652 7759   66]
 [ 687 7908   69]
 [ 619 7432   66]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.122137
{'0': {'precision': 0.3254399640444388, 'recall': 0.19058860301375272, 'f1-score': 0.24039424199195952, 'support': 121576}, '1': {'precision': 0.32420271435041126, 'recall': 0.7270701941190925, 'f1-score': 0.4484432701682774, 'support': 122090}, '2': {'precision': 0.3833939794905723, 'recall': 0.07386811768548689, 'f1-score': 0.1238702782138205, 'support': 125521}, 'accuracy': 0.32831871111387995, 'macro avg': {'precision': 0.34434555262847416, 'recall': 0.33050897160611065, 'f1-score': 0.2709025967913525, 'support': 369187}, 'weighted avg': {'precision': 0.3447347662928124, 'recall': 0.32831871111387995, 'f1-score': 0.26957864283123845, 'support': 369187}}
[[23171 91423  6982]
 [25392 88768  7930]
 [22636 93613  9272]]
Evaluating performance on  train set...
494/494 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1258004
{'0': {'precision': 0.3321484665619575, 'recall': 0.19395636223209115, 'f1-score': 0.24490293481242195, 'support': 41432}, '1': {'precision': 0.3194779521952153, 'recall': 0.7227003894792519, 'f1-score': 0.4430850867818845, 'support': 41594}, '2': {'precision': 0.3623079805170476, 'recall': 0.06705033975870198, 'f1-score': 0.11315897255865659, 'support': 43266}, 'accuracy': 0.32462072023564437, 'macro avg': {'precision': 0.33797813309140673, 'recall': 0.3279023638233483, 'f1-score': 0.2670489980509877, 'support': 126292}, 'weighted avg': {'precision': 0.33830771779093993, 'recall': 0.32462072023564437, 'f1-score': 0.26504003105087265, 'support': 126292}}
[[ 8036 31163  2233]
 [ 8661 30060  2873]
 [ 7497 32868  2901]]
Evaluating performance on  val set...
150/150 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1234758
{'0': {'precision': 0.3400337362946303, 'recall': 0.19000864032676146, 'f1-score': 0.2437893675988914, 'support': 12731}, '1': {'precision': 0.32262584509755843, 'recall': 0.7441822882999354, 'f1-score': 0.45011362803313537, 'support': 12376}, '2': {'precision': 0.3839967832730197, 'recall': 0.07323058047695728, 'f1-score': 0.12300360638845954, 'support': 13041}, 'accuracy': 0.32987312572087657, 'macro avg': {'precision': 0.34888545488840284, 'recall': 0.335807169701218, 'f1-score': 0.2723022006734954, 'support': 38148}, 'weighted avg': {'precision': 0.34941514643907345, 'recall': 0.32987312572087657, 'f1-score': 0.26943427520057334, 'support': 38148}}
[[2419 9564  748]
 [2382 9210  784]
 [2313 9773  955]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
5521/5521 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0851643
{'0': {'precision': 0.4337406957715251, 'recall': 0.34237644803733647, 'f1-score': 0.3826808877296756, 'support': 479960}, '1': {'precision': 0.32266823311646736, 'recall': 0.6660109995071593, 'f1-score': 0.4347225780738463, 'support': 458566}, '2': {'precision': 0.42438819141193596, 'recall': 0.07860205904158522, 'f1-score': 0.13263790162069944, 'support': 474784}, 'accuracy': 0.35877196085784435, 'macro avg': {'precision': 0.3935990400999761, 'recall': 0.36232983552869363, 'f1-score': 0.31668045580807375, 'support': 1413310}, 'weighted avg': {'precision': 0.39455999632148064, 'recall': 0.35877196085784435, 'f1-score': 0.3155676150984771, 'support': 1413310}}
[[164327 295065  20568]
 [123107 305410  30049]
 [ 91426 346039  37319]]
Evaluating performance on  train set...
1289/1289 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937182
{'0': {'precision': 0.4095116427617444, 'recall': 0.31876655486950467, 'f1-score': 0.3584855786338081, 'support': 110617}, '1': {'precision': 0.3288273182968308, 'recall': 0.6919636720217748, 'f1-score': 0.44580440224835854, 'support': 109117}, '2': {'precision': 0.4713694131086677, 'recall': 0.06002036437688643, 'f1-score': 0.106482153513653, 'support': 109996}, 'accuracy': 0.3559518393837382, 'macro avg': {'precision': 0.4032361247224143, 'recall': 0.3569168637560553, 'f1-score': 0.3035907114652732, 'support': 329730}, 'weighted avg': {'precision': 0.4034463040738549, 'recall': 0.3559518393837382, 'f1-score': 0.30331498246977184, 'support': 329730}}
[[35261 71795  3561]
 [29769 75505  3843]
 [21075 82319  6602]]
Evaluating performance on  val set...
438/438 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0902379
{'0': {'precision': 0.3993353723091401, 'recall': 0.3641165902448181, 'f1-score': 0.3809136429302776, 'support': 37293}, '1': {'precision': 0.33837876029239927, 'recall': 0.6526889611070342, 'f1-score': 0.44569321903466547, 'support': 38156}, '2': {'precision': 0.47421731123388583, 'recall': 0.0564429953146834, 'f1-score': 0.10087901863323621, 'support': 36497}, 'accuracy': 0.36216568702767404, 'macro avg': {'precision': 0.4039771479451417, 'recall': 0.35774951555551193, 'f1-score': 0.30916196019939307, 'support': 111946}, 'weighted avg': {'precision': 0.4029719974393429, 'recall': 0.36216568702767404, 'f1-score': 0.31169550045863864, 'support': 111946}}
[[13579 22756   958]
 [11926 24904  1326]
 [ 8499 25938  2060]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
5918/5918 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923493
{'0': {'precision': 0.37770633649640273, 'recall': 0.3284754528409351, 'f1-score': 0.3513748493513771, 'support': 481074}, '1': {'precision': 0.3708405188500459, 'recall': 0.6873760205841767, 'f1-score': 0.4817669552864906, 'support': 556544}, '2': {'precision': 0.4099524973481529, 'recall': 0.055859988688493685, 'f1-score': 0.0983225763634252, 'support': 477390}, 'accuracy': 0.374415844668807, 'macro avg': {'precision': 0.3861664508982005, 'recall': 0.3572371540378685, 'f1-score': 0.310488127000431, 'support': 1515008}, 'weighted avg': {'precision': 0.3853451510193907, 'recall': 0.374415844668807, 'f1-score': 0.3195362845410484, 'support': 1515008}}
[[158021 307006  16047]
 [151654 382555  22335]
 [108695 342028  26667]]
Evaluating performance on  train set...
1814/1814 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965317
{'0': {'precision': 0.3687383655603817, 'recall': 0.2961837922301848, 'f1-score': 0.32850259589885333, 'support': 148472}, '1': {'precision': 0.35766990171116014, 'recall': 0.6974162841061959, 'f1-score': 0.47284253578732105, 'support': 165769}, '2': {'precision': 0.42721431849472236, 'recall': 0.06204428211519748, 'f1-score': 0.10835253858509672, 'support': 150038}, 'accuracy': 0.36377695308209074, 'macro avg': {'precision': 0.3845408619220881, 'recall': 0.35188145281719274, 'f1-score': 0.3032325567570904, 'support': 464279}, 'weighted avg': {'precision': 0.3836837041230584, 'recall': 0.36377695308209074, 'f1-score': 0.3088941561376968, 'support': 464279}}
[[ 43975  98755   5742]
 [ 43420 115610   6739]
 [ 31863 108866   9309]]
Evaluating performance on  val set...
636/636 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0846859
{'0': {'precision': 0.34882200537543284, 'recall': 0.2927810747093732, 'f1-score': 0.31835408770979967, 'support': 49204}, '1': {'precision': 0.4057156179664452, 'recall': 0.6946448859274726, 'f1-score': 0.5122471738379761, 'support': 65134}, '2': {'precision': 0.40468497576736673, 'recall': 0.08283730158730158, 'f1-score': 0.13752401866593467, 'support': 48384}, 'accuracy': 0.3912132348422463, 'macro avg': {'precision': 0.3864075330364149, 'recall': 0.35675442074138247, 'f1-score': 0.3227084267379035, 'support': 162722}, 'weighted avg': {'precision': 0.3882056321864746, 'recall': 0.3912132348422463, 'f1-score': 0.3421969006745757, 'support': 162722}}
[[14406 32244  2554]
 [16547 45245  3342]
 [10346 34030  4008]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
3755/3755 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.088762
{'0': {'precision': 0.32451213003524604, 'recall': 0.2112194534729746, 'f1-score': 0.25588663002670914, 'support': 290745}, '1': {'precision': 0.4082096159699993, 'recall': 0.7498110702614379, 'f1-score': 0.5286262891167453, 'support': 391680}, '2': {'precision': 0.3571169935014198, 'recall': 0.0672280062280708, 'f1-score': 0.11315445441123635, 'support': 278738}, 'accuracy': 0.38894131380421426, 'macro avg': {'precision': 0.36327957983555503, 'recall': 0.3427528433208278, 'f1-score': 0.2992224578515636, 'support': 961163}, 'weighted avg': {'precision': 0.3680748199471116, 'recall': 0.38894131380421426, 'f1-score': 0.3256373263245064, 'support': 961163}}
[[ 61411 213500  15834]
 [ 80094 293686  17900]
 [ 47736 212263  18739]]
Evaluating performance on  train set...
1532/1532 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113923
{'0': {'precision': 0.3675814710810109, 'recall': 0.23958533603008467, 'f1-score': 0.29009204467681937, 'support': 130033}, '1': {'precision': 0.33886257582011653, 'recall': 0.7439331572157032, 'f1-score': 0.4656300319642384, 'support': 130216}, '2': {'precision': 0.39307752981023525, 'recall': 0.06421489858411909, 'f1-score': 0.11039515262077727, 'support': 131932}, 'accuracy': 0.3480484776162027, 'macro avg': {'precision': 0.36650719223712097, 'recall': 0.34924446394330233, 'f1-score': 0.2887057430872783, 'support': 392181}, 'weighted avg': {'precision': 0.36662295028314307, 'recall': 0.3480484776162027, 'f1-score': 0.28792489274921657, 'support': 392181}}
[[31154 91924  6955]
 [27218 96872  6126]
 [26382 97078  8472]]
Evaluating performance on  val set...
467/467 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010607
{'0': {'precision': 0.3362965628936477, 'recall': 0.25070430093101875, 'f1-score': 0.2872602065912445, 'support': 37271}, '1': {'precision': 0.37264369179666645, 'recall': 0.7184155155063581, 'f1-score': 0.4907396558323373, 'support': 43724}, '2': {'precision': 0.3913460221826647, 'recall': 0.0744503490674169, 'f1-score': 0.12510122343568755, 'support': 38388}, 'accuracy': 0.3653283968404212, 'macro avg': {'precision': 0.36676209229099294, 'recall': 0.34785672183493127, 'f1-score': 0.3010336952864231, 'support': 119383}, 'weighted avg': {'precision': 0.36731002802136586, 'recall': 0.3653283968404212, 'f1-score': 0.3096417549963107, 'support': 119383}}
[[ 9344 25723  2204]
 [10071 31412  2241]
 [ 8370 27160  2858]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
4960/4960 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927205
{'0': {'precision': 0.37827159148194067, 'recall': 0.3353212992552978, 'f1-score': 0.35550388232160784, 'support': 413991}, '1': {'precision': 0.3610355174098109, 'recall': 0.6404874559859155, 'f1-score': 0.4617741703564505, 'support': 436224}, '2': {'precision': 0.3932355749450788, 'recall': 0.12076573730823788, 'f1-score': 0.18478312413594367, 'support': 419465}, 'accuracy': 0.3692843866171004, 'macro avg': {'precision': 0.3775142279456101, 'recall': 0.3655248308498171, 'f1-score': 0.334020392271334, 'support': 1269680}, 'weighted avg': {'precision': 0.37729345379947304, 'recall': 0.3692843866171004, 'f1-score': 0.33561404180695975, 'support': 1269680}}
[[138820 234870  40301]
 [118965 279396  37863]
 [109200 259608  50657]]
Evaluating performance on  train set...
1691/1691 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971992
{'0': {'precision': 0.38665681268476215, 'recall': 0.3500986859892932, 'f1-score': 0.36747073430294425, 'support': 147944}, '1': {'precision': 0.34281569669085676, 'recall': 0.6085659956356084, 'f1-score': 0.4385747118299525, 'support': 142517}, '2': {'precision': 0.39348906127429617, 'recall': 0.12682693860924407, 'f1-score': 0.1918257867481078, 'support': 142383}, 'accuracy': 0.3617561985380414, 'macro avg': {'precision': 0.37432052354997164, 'recall': 0.36183054007804855, 'f1-score': 0.3326237442936682, 'support': 432844}, 'weighted avg': {'precision': 0.3744692617953429, 'recall': 0.3617561985380414, 'f1-score': 0.3331042442915692, 'support': 432844}}
[[51795 81583 14566]
 [42518 86731 13268]
 [39643 84682 18058]]
Evaluating performance on  val set...
591/591 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086817
{'0': {'precision': 0.38297963374978605, 'recall': 0.3390145059273567, 'f1-score': 0.35965846308387744, 'support': 52806}, '1': {'precision': 0.304921348056395, 'recall': 0.5877779746611146, 'f1-score': 0.4015373325162472, 'support': 45148}, '2': {'precision': 0.38765048096307814, 'recall': 0.1265513350883791, 'f1-score': 0.19081101770601497, 'support': 53180}, 'accuracy': 0.33856709939523866, 'macro avg': {'precision': 0.35851715425641967, 'recall': 0.3511146052256168, 'f1-score': 0.31733560443537984, 'support': 151134}, 'weighted avg': {'precision': 0.3613049620830377, 'recall': 0.33856709939523866, 'f1-score': 0.31275597953906226, 'support': 151134}}
[[17902 28877  6027]
 [14007 26537  4604]
 [14835 31615  6730]]
testing model on single stock: results/universal/W8/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
10609/10609 - 147s - 147s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1282014
{'0': {'precision': 0.3913859958039862, 'recall': 0.24786831763920814, 'f1-score': 0.3035167265589393, 'support': 1011525}, '1': {'precision': 0.25704577579035176, 'recall': 0.6577611468627902, 'f1-score': 0.36964023794167056, 'support': 696160}, '2': {'precision': 0.3951377821366788, 'recall': 0.11511244577116797, 'f1-score': 0.17828615855733768, 'support': 1007997}, 'accuracy': 0.30366773429289584, 'macro avg': {'precision': 0.34785651791033895, 'recall': 0.34024730342438875, 'f1-score': 0.28381437435264917, 'support': 2715682}, 'weighted avg': {'precision': 0.35834070618734604, 'recall': 0.30366773429289584, 'f1-score': 0.2739847367421241, 'support': 2715682}}
[[250725 655073 105727]
 [166361 457907  71892]
 [223522 668442 116033]]
Evaluating performance on  train set...
3903/3903 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144269
{'0': {'precision': 0.353760423022168, 'recall': 0.2599772222504536, 'f1-score': 0.2997034737166753, 'support': 334537}, '1': {'precision': 0.32992828673114, 'recall': 0.6641925001764339, 'f1-score': 0.4408637190346909, 'support': 325901}, '2': {'precision': 0.3701404332427312, 'recall': 0.10616758951642673, 'f1-score': 0.16500632238905985, 'support': 338625}, 'accuracy': 0.33970230105608956, 'macro avg': {'precision': 0.3512763809986797, 'recall': 0.34344577064777143, 'f1-score': 0.301857838380142, 'support': 999063}, 'weighted avg': {'precision': 0.35153810462138235, 'recall': 0.33970230105608956, 'f1-score': 0.30009628402100325, 'support': 999063}}
[[ 86972 216513  31052]
 [ 79315 216461  30125]
 [ 79563 223111  35951]]
Evaluating performance on  val set...
1144/1144 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1133366
{'0': {'precision': 0.364658680740304, 'recall': 0.2513953741982175, 'f1-score': 0.29761513543965074, 'support': 100869}, '1': {'precision': 0.3242561482963821, 'recall': 0.6662374619937459, 'f1-score': 0.43620996850968263, 'support': 92419}, '2': {'precision': 0.37290687868931455, 'recall': 0.12463636821178721, 'f1-score': 0.1868290217202695, 'support': 99345}, 'accuracy': 0.3393773087792559, 'macro avg': {'precision': 0.3539405692420002, 'recall': 0.34742306813458357, 'f1-score': 0.30688470855653427, 'support': 292633}, 'weighted avg': {'precision': 0.35469895500639714, 'recall': 0.3393773087792559, 'f1-score': 0.30377558012650197, 'support': 292633}}
[[25358 64387 11124]
 [21148 61573  9698]
 [23033 63930 12382]]
training model: results/universal/W8/deepVOL_L3/h50
Epoch 1/50
7696/7696 - 658s - loss: 3.1293 - accuracy50: 0.4331 - val_loss: 3.1554 - val_accuracy50: 0.4326 - 658s/epoch - 86ms/step
Epoch 2/50
7696/7696 - 658s - loss: 3.0287 - accuracy50: 0.4666 - val_loss: 3.1696 - val_accuracy50: 0.4456 - 658s/epoch - 85ms/step
Epoch 3/50
7696/7696 - 641s - loss: 2.9986 - accuracy50: 0.4745 - val_loss: 3.1382 - val_accuracy50: 0.4514 - 641s/epoch - 83ms/step
Epoch 4/50
7696/7696 - 636s - loss: 2.9815 - accuracy50: 0.4792 - val_loss: 3.1341 - val_accuracy50: 0.4512 - 636s/epoch - 83ms/step
Epoch 5/50
7696/7696 - 635s - loss: 2.9685 - accuracy50: 0.4842 - val_loss: 3.1053 - val_accuracy50: 0.4537 - 635s/epoch - 83ms/step
Epoch 6/50
7696/7696 - 638s - loss: 2.9593 - accuracy50: 0.4862 - val_loss: 3.0848 - val_accuracy50: 0.4557 - 638s/epoch - 83ms/step
Epoch 7/50
7696/7696 - 632s - loss: 2.9521 - accuracy50: 0.4882 - val_loss: 3.0690 - val_accuracy50: 0.4581 - 632s/epoch - 82ms/step
Epoch 8/50
7696/7696 - 634s - loss: 2.9452 - accuracy50: 0.4906 - val_loss: 3.0848 - val_accuracy50: 0.4574 - 634s/epoch - 82ms/step
Epoch 9/50
7696/7696 - 630s - loss: 2.9404 - accuracy50: 0.4914 - val_loss: 3.0561 - val_accuracy50: 0.4607 - 630s/epoch - 82ms/step
Epoch 10/50
7696/7696 - 629s - loss: 2.9358 - accuracy50: 0.4925 - val_loss: 3.0501 - val_accuracy50: 0.4614 - 629s/epoch - 82ms/step
Epoch 11/50
7696/7696 - 638s - loss: 2.9319 - accuracy50: 0.4938 - val_loss: 3.0597 - val_accuracy50: 0.4612 - 638s/epoch - 83ms/step
Epoch 12/50
7696/7696 - 631s - loss: 2.9281 - accuracy50: 0.4948 - val_loss: 3.0596 - val_accuracy50: 0.4646 - 631s/epoch - 82ms/step
Epoch 13/50
7696/7696 - 628s - loss: 2.9246 - accuracy50: 0.4954 - val_loss: 3.0518 - val_accuracy50: 0.4655 - 628s/epoch - 82ms/step
Epoch 14/50
7696/7696 - 639s - loss: 2.9225 - accuracy50: 0.4961 - val_loss: 3.0556 - val_accuracy50: 0.4667 - 639s/epoch - 83ms/step
Epoch 15/50
7696/7696 - 630s - loss: 2.9199 - accuracy50: 0.4968 - val_loss: 3.0504 - val_accuracy50: 0.4683 - 630s/epoch - 82ms/step
Epoch 16/50
7696/7696 - 626s - loss: 2.9173 - accuracy50: 0.4974 - val_loss: 3.0516 - val_accuracy50: 0.4669 - 626s/epoch - 81ms/step
Epoch 17/50
7696/7696 - 626s - loss: 2.9143 - accuracy50: 0.4982 - val_loss: 3.0576 - val_accuracy50: 0.4672 - 626s/epoch - 81ms/step
Epoch 18/50
7696/7696 - 628s - loss: 2.9125 - accuracy50: 0.4989 - val_loss: 3.0581 - val_accuracy50: 0.4687 - 628s/epoch - 82ms/step
Epoch 19/50
7696/7696 - 633s - loss: 2.9101 - accuracy50: 0.4995 - val_loss: 3.0642 - val_accuracy50: 0.4680 - 633s/epoch - 82ms/step
Epoch 20/50
7696/7696 - 638s - loss: 2.9088 - accuracy50: 0.4999 - val_loss: 3.0665 - val_accuracy50: 0.4668 - 638s/epoch - 83ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 1167s - 1167s/epoch - 50ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98150235
{'0': {'precision': 0.3923262617178067, 'recall': 0.6142936324405885, 'f1-score': 0.47883719725997337, 'support': 1708551}, '1': {'precision': 0.6018624744559566, 'recall': 0.5555548551773206, 'f1-score': 0.5777822938576282, 'support': 2538311}, '2': {'precision': 0.477314336507721, 'recall': 0.2625216876902595, 'f1-score': 0.338738209766416, 'support': 1714106}, 'accuracy': 0.4881275994100287, 'macro avg': {'precision': 0.49050102422716146, 'recall': 0.47745672510272286, 'f1-score': 0.4651192336280059, 'support': 5960968}, 'weighted avg': {'precision': 0.5059901234626487, 'recall': 0.4881275994100287, 'f1-score': 0.48068403019604317, 'support': 5960968}}
[[1049552  448652  210347]
 [ 845723 1410171  282417]
 [ 779927  484189  449990]]
Evaluating performance on  train set...
7696/7696 - 392s - 392s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0224837
{'0': {'precision': 0.3966349694064048, 'recall': 0.6156388860566313, 'f1-score': 0.4824463447685706, 'support': 608074}, '1': {'precision': 0.5353397480185812, 'recall': 0.5047873657505062, 'f1-score': 0.5196148386221805, 'support': 755217}, '2': {'precision': 0.46454826991219594, 'recall': 0.240278197063952, 'f1-score': 0.3167327731677192, 'support': 606189}, 'accuracy': 0.45759896013160833, 'macro avg': {'precision': 0.4655076624457273, 'recall': 0.4535681496236965, 'f1-score': 0.4395979855194901, 'support': 1969480}, 'weighted avg': {'precision': 0.47072584746023477, 'recall': 0.45759896013160833, 'f1-score': 0.4456937675235583, 'support': 1969480}}
[[374354 154822  78898]
 [285006 381224  88987]
 [284465 176070 145654]]
Evaluating performance on  val set...
2338/2338 - 119s - 119s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0143414
{'0': {'precision': 0.38896538089488586, 'recall': 0.6169110771418813, 'f1-score': 0.47711038504093345, 'support': 178593}, '1': {'precision': 0.5602848898456465, 'recall': 0.5035193295574288, 'f1-score': 0.5303875787492899, 'support': 242944}, '2': {'precision': 0.45296062206328747, 'recall': 0.2472325141991455, 'f1-score': 0.31987343955894715, 'support': 176243}, 'accuracy': 0.4618354578607514, 'macro avg': {'precision': 0.46740363093460663, 'recall': 0.45588764029948514, 'f1-score': 0.44245713444972345, 'support': 597780}, 'weighted avg': {'precision': 0.4774590743469521, 'recall': 0.4618354578607514, 'f1-score': 0.452404746788903, 'support': 597780}}
[[110176  45133  23284]
 [ 91278 122327  29339]
 [ 81800  50870  43573]]
testing model out of sample: results/universal/W8/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 716s - 716s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92185575
{'0': {'precision': 0.440649843637718, 'recall': 0.5246814539231691, 'f1-score': 0.47900819379840376, 'support': 926789}, '1': {'precision': 0.6293470891393297, 'recall': 0.7521762338602835, 'f1-score': 0.6853013849551719, 'support': 1764746}, '2': {'precision': 0.5180726772638856, 'recall': 0.2260948366382727, 'f1-score': 0.31480427496363755, 'support': 924727}, 'accuracy': 0.5593469167886619, 'macro avg': {'precision': 0.5293565366803111, 'recall': 0.5009841748072418, 'f1-score': 0.493037951239071, 'support': 3616262}, 'weighted avg': {'precision': 0.5525326922478608, 'recall': 0.5593469167886619, 'f1-score': 0.5376906915457531, 'support': 3616262}}
[[ 486269  357768   82752]
 [ 325609 1327400  111737]
 [ 291649  424002  209076]]
Evaluating performance on  train set...
4550/4550 - 231s - 231s/epoch - 51ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94754255
{'0': {'precision': 0.44763739188958424, 'recall': 0.5416514731621938, 'f1-score': 0.490177260302602, 'support': 329088}, '1': {'precision': 0.5915023208821754, 'recall': 0.7280049187790549, 'f1-score': 0.6526930449915636, 'support': 507443}, '2': {'precision': 0.5298161244695898, 'recall': 0.22866735852512057, 'f1-score': 0.3194575924267622, 'support': 327620}, 'accuracy': 0.5348000388265783, 'macro avg': {'precision': 0.5229852790804498, 'recall': 0.49944125015545643, 'f1-score': 0.48744263257364256, 'support': 1164151}, 'weighted avg': {'precision': 0.5334738920778319, 'recall': 0.5348000388265783, 'f1-score': 0.5129718288254466, 'support': 1164151}}
[[178251 118081  32756]
 [104294 369421  33728]
 [115659 137045  74916]]
Evaluating performance on  val set...
1570/1570 - 81s - 81s/epoch - 52ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93675226
{'0': {'precision': 0.4459240868224053, 'recall': 0.5403261830745809, 'f1-score': 0.4886071357910704, 'support': 109693}, '1': {'precision': 0.615497639573536, 'recall': 0.7482441148905673, 'f1-score': 0.6754101134358959, 'support': 181390}, '2': {'precision': 0.5212888860881804, 'recall': 0.22571168713051387, 'f1-score': 0.3150224997937255, 'support': 109950}, 'accuracy': 0.5481120007580423, 'macro avg': {'precision': 0.5275702041613739, 'recall': 0.5047606616985539, 'f1-score': 0.4930132496735639, 'support': 401033}, 'weighted avg': {'precision': 0.5432859159307319, 'recall': 0.5481120007580423, 'f1-score': 0.5255082421516113, 'support': 401033}}
[[ 59270  38933  11490]
 [ 34366 135724  11300]
 [ 39279  45854  24817]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
645/645 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0684346
{'0': {'precision': 0.38582496126355775, 'recall': 0.6885380429934885, 'f1-score': 0.4945352040489462, 'support': 56055}, '1': {'precision': 0.4740717693424601, 'recall': 0.33439408903032297, 'f1-score': 0.39216695622332326, 'support': 54678}, '2': {'precision': 0.4600129174423464, 'recall': 0.2234319351921906, 'f1-score': 0.30077503974562797, 'support': 54191}, 'accuracy': 0.4183017632363998, 'macro avg': {'precision': 0.4399698826827881, 'recall': 0.4154546890720006, 'f1-score': 0.39582573333929916, 'support': 164924}, 'weighted avg': {'precision': 0.43945862589346585, 'recall': 0.4183017632363998, 'f1-score': 0.39693056119302145, 'support': 164924}}
[[38596 10281  7178]
 [29359 18284  7035]
 [32080 10003 12108]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0897902
{'0': {'precision': 0.36430230480614617, 'recall': 0.7582341691457714, 'f1-score': 0.4921469579159699, 'support': 18824}, '1': {'precision': 0.4557093785781201, 'recall': 0.23022717711400925, 'f1-score': 0.30590783635537855, 'support': 19016}, '2': {'precision': 0.4612810707456979, 'recall': 0.19985502744123435, 'f1-score': 0.2788815837005997, 'support': 19314}, 'accuracy': 0.3938656961892431, 'macro avg': {'precision': 0.4270975847099881, 'recall': 0.3961054579003383, 'f1-score': 0.3589787926573161, 'support': 57154}, 'weighted avg': {'precision': 0.42748676783943096, 'recall': 0.3938656961892431, 'f1-score': 0.3581138093490828, 'support': 57154}}
[[14273  2404  2147]
 [12277  4378  2361]
 [12629  2825  3860]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0904982
{'0': {'precision': 0.38639165091626265, 'recall': 0.7724659109577788, 'f1-score': 0.5151183172655565, 'support': 6087}, '1': {'precision': 0.39959016393442626, 'recall': 0.222306669200076, 'f1-score': 0.28567940422414845, 'support': 5263}, '2': {'precision': 0.48878504672897194, 'recall': 0.177679633089859, 'f1-score': 0.2606204061293136, 'support': 5887}, 'accuracy': 0.4013459418692348, 'macro avg': {'precision': 0.42492228719322034, 'recall': 0.3908174044159047, 'f1-score': 0.3538060425396728, 'support': 17237}, 'weighted avg': {'precision': 0.42539227139337665, 'recall': 0.4013459418692348, 'f1-score': 0.3581440060631435, 'support': 17237}}
[[4702  851  534]
 [3533 1170  560]
 [3934  907 1046]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
2179/2179 - 43s - 43s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78307194
{'0': {'precision': 0.5900291699814373, 'recall': 0.3562058078000623, 'f1-score': 0.44422753767060613, 'support': 112435}, '1': {'precision': 0.685866929355724, 'recall': 0.917957626237881, 'f1-score': 0.7851192653094397, 'support': 336765}, '2': {'precision': 0.7200285867428979, 'recall': 0.25980843617609134, 'f1-score': 0.3818379929479761, 'support': 108580}, 'accuracy': 0.6766036788698053, 'macro avg': {'precision': 0.665308228693353, 'recall': 0.5113239567380116, 'f1-score': 0.537061598642674, 'support': 557780}, 'weighted avg': {'precision': 0.6731984118109061, 'recall': 0.6766036788698053, 'f1-score': 0.6378991391843007, 'support': 557780}}
[[ 40050  68583   3802]
 [ 20462 309136   7167]
 [  7366  73004  28210]]
Evaluating performance on  train set...
614/614 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8547943
{'0': {'precision': 0.5559743413184504, 'recall': 0.415261348564004, 'f1-score': 0.47542456923267634, 'support': 36943}, '1': {'precision': 0.6326490846090632, 'recall': 0.8944411838685336, 'f1-score': 0.7411053660569851, 'support': 83489}, '2': {'precision': 0.7022780832678712, 'recall': 0.21950620652025646, 'f1-score': 0.33446957100099767, 'support': 36655}, 'accuracy': 0.6242591684862528, 'macro avg': {'precision': 0.6303005030651282, 'recall': 0.509736246317598, 'f1-score': 0.5169998354302198, 'support': 157087}, 'weighted avg': {'precision': 0.6308644423691165, 'recall': 0.6242591684862528, 'f1-score': 0.583738551840292, 'support': 157087}}
[[15341 19709  1893]
 [ 7295 74676  1518]
 [ 4957 23652  8046]]
Evaluating performance on  val set...
190/190 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8204476
{'0': {'precision': 0.5197505197505198, 'recall': 0.39188792005486434, 'f1-score': 0.4468524828241077, 'support': 10207}, '1': {'precision': 0.6753003505204291, 'recall': 0.8927484966395473, 'f1-score': 0.7689471840104808, 'support': 28270}, '2': {'precision': 0.6946433686622744, 'recall': 0.24050381830804324, 'f1-score': 0.3573007219684691, 'support': 10083}, 'accuracy': 0.6520387149917628, 'macro avg': {'precision': 0.6298980796444077, 'recall': 0.5083800783341516, 'f1-score': 0.5243667962676859, 'support': 48560}, 'weighted avg': {'precision': 0.6466211604309678, 'recall': 0.6520387149917628, 'f1-score': 0.6157706623511128, 'support': 48560}}
[[ 4000  5694   513]
 [ 2479 25238   553]
 [ 1217  6441  2425]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
1162/1162 - 23s - 23s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.106006
{'0': {'precision': 0.3349159414104772, 'recall': 0.5637917099642074, 'f1-score': 0.42020968890886223, 'support': 77949}, '1': {'precision': 0.5269041046295877, 'recall': 0.41390563676696435, 'f1-score': 0.4636188792392875, 'support': 140648}, '2': {'precision': 0.3359038737446198, 'recall': 0.23749144117870818, 'f1-score': 0.27825234352948164, 'support': 78866}, 'accuracy': 0.4064102090007833, 'macro avg': {'precision': 0.39924130659489493, 'recall': 0.4050629293032933, 'f1-score': 0.3873603038925438, 'support': 297463}, 'weighted avg': {'precision': 0.4259547107764351, 'recall': 0.4064102090007833, 'f1-score': 0.4030976709466398, 'support': 297463}}
[[43947 24343  9659]
 [55062 58215 27371]
 [32209 27927 18730]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1263669
{'0': {'precision': 0.3807128516223743, 'recall': 0.6308578378765114, 'f1-score': 0.4748569505217099, 'support': 27954}, '1': {'precision': 0.37233252463237115, 'recall': 0.270454954144938, 'f1-score': 0.3133202783217366, 'support': 27805}, '2': {'precision': 0.41901078293483357, 'recall': 0.2569816339000108, 'f1-score': 0.318577761935527, 'support': 27823}, 'accuracy': 0.38650666411428297, 'macro avg': {'precision': 0.39068538639652634, 'recall': 0.3860981419738201, 'f1-score': 0.36891833025965787, 'support': 83582}, 'weighted avg': {'precision': 0.3906737086364386, 'recall': 0.38650666411428297, 'f1-score': 0.3690963437576504, 'support': 83582}}
[[17635  6148  4171]
 [14542  7520  5743]
 [14144  6529  7150]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1134785
{'0': {'precision': 0.37448796722990274, 'recall': 0.5834081164622594, 'f1-score': 0.45616497095856234, 'support': 10029}, '1': {'precision': 0.4065307699739156, 'recall': 0.3641398407753548, 'f1-score': 0.38416944355685395, 'support': 11556}, '2': {'precision': 0.4179130135808836, 'recall': 0.23816988341334377, 'f1-score': 0.30341987019470795, 'support': 10207}, 'accuracy': 0.3928661298439859, 'macro avg': {'precision': 0.399643916928234, 'recall': 0.395239280216986, 'f1-score': 0.3812514282367081, 'support': 31792}, 'weighted avg': {'precision': 0.40007698574444334, 'recall': 0.3928661298439859, 'f1-score': 0.3809558127379155, 'support': 31792}}
[[5851 2876 1302]
 [5264 4208 2084]
 [4509 3267 2431]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1212096
{'0': {'precision': 0.33759114782520017, 'recall': 0.25062462144155057, 'f1-score': 0.28767897103873813, 'support': 105664}, '1': {'precision': 0.3541144860877089, 'recall': 0.4269477845494976, 'f1-score': 0.3871353181320322, 'support': 109278}, '2': {'precision': 0.31922983420041817, 'recall': 0.33466882792508995, 'f1-score': 0.32676706847297016, 'support': 98091}, 'accuracy': 0.33851383081017017, 'macro avg': {'precision': 0.336978489371109, 'recall': 0.3374137446387127, 'f1-score': 0.33386045254791347, 'support': 313033}, 'weighted avg': {'precision': 0.33760570777217674, 'recall': 0.33851383081017017, 'f1-score': 0.3346471222019773, 'support': 313033}}
[[26482 44755 34427]
 [27042 46656 35580]
 [24920 40343 32828]]
Evaluating performance on  train set...
358/358 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1220448
{'0': {'precision': 0.3452339986235375, 'recall': 0.2568895432576897, 'f1-score': 0.2945807564551944, 'support': 31243}, '1': {'precision': 0.3359078379362355, 'recall': 0.4269941489537536, 'f1-score': 0.376013390582927, 'support': 30251}, '2': {'precision': 0.33055153615775484, 'recall': 0.32825396825396824, 'f1-score': 0.32939874585023976, 'support': 29925}, 'accuracy': 0.33653835635918133, 'macro avg': {'precision': 0.33723112423917595, 'recall': 0.33737922015513716, 'f1-score': 0.33333096429612036, 'support': 91419}, 'weighted avg': {'precision': 0.3373417839171841, 'recall': 0.33653835635918133, 'f1-score': 0.3329245028060052, 'support': 91419}}
[[ 8026 13069 10148]
 [ 7588 12917  9746]
 [ 7634 12468  9823]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1188369
{'0': {'precision': 0.3420535309239377, 'recall': 0.26459234998245407, 'f1-score': 0.29837752275425405, 'support': 8549}, '1': {'precision': 0.34978951396861846, 'recall': 0.4296627100716888, 'f1-score': 0.385633669110279, 'support': 8509}, '2': {'precision': 0.3367508849017454, 'recall': 0.33646341463414636, 'f1-score': 0.3366070883913866, 'support': 8200}, 'accuracy': 0.34353472167234145, 'macro avg': {'precision': 0.3428646432647671, 'recall': 0.34357282489609636, 'f1-score': 0.3402060934186399, 'support': 25258}, 'weighted avg': {'precision': 0.3429381529187596, 'recall': 0.34353472167234145, 'f1-score': 0.34018388064355265, 'support': 25258}}
[[2262 3552 2735]
 [2154 3656 2699]
 [2197 3244 2759]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
1443/1443 - 34s - 34s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1240747
{'0': {'precision': 0.3648501772097519, 'recall': 0.7052649061617672, 'f1-score': 0.480912810203995, 'support': 120420}, '1': {'precision': 0.39160768622967906, 'recall': 0.186055799167725, 'f1-score': 0.2522606426181219, 'support': 125199}, '2': {'precision': 0.4253922447971506, 'recall': 0.2648339375890198, 'f1-score': 0.3264387995830361, 'support': 123568}, 'accuracy': 0.381776714781398, 'macro avg': {'precision': 0.39395003607886053, 'recall': 0.3853848809728373, 'f1-score': 0.35320408413505106, 'support': 369187}, 'weighted avg': {'precision': 0.3941878179701946, 'recall': 0.381776714781398, 'f1-score': 0.35166918224852967, 'support': 369187}}
[[84928 16431 19061]
 [76762 23294 25143]
 [71085 19758 32725]]
Evaluating performance on  train set...
494/494 - 11s - 11s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1233658
{'0': {'precision': 0.3699493617470197, 'recall': 0.6737919108463829, 'f1-score': 0.4776449756529438, 'support': 41636}, '1': {'precision': 0.37221979938944616, 'recall': 0.20328204639641786, 'f1-score': 0.262955203647791, 'support': 41986}, '2': {'precision': 0.41311296767163097, 'recall': 0.26653386454183264, 'f1-score': 0.32401709401709394, 'support': 42670}, 'accuracy': 0.3797706901466443, 'macro avg': {'precision': 0.3850940429360323, 'recall': 0.3812026072615445, 'f1-score': 0.35487242443927625, 'support': 126292}, 'weighted avg': {'precision': 0.3852877652853125, 'recall': 0.3797706901466443, 'f1-score': 0.35436506499502357, 'support': 126292}}
[[28054  6714  6868]
 [24162  8535  9289]
 [23616  7681 11373]]
Evaluating performance on  val set...
150/150 - 4s - 4s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1325465
{'0': {'precision': 0.3756171329448917, 'recall': 0.6717842653726832, 'f1-score': 0.4818280367433103, 'support': 12571}, '1': {'precision': 0.4004718372161604, 'recall': 0.20538415003024804, 'f1-score': 0.271518544436669, 'support': 13224}, '2': {'precision': 0.399639761341889, 'recall': 0.2873795839067433, 'f1-score': 0.33433791674514973, 'support': 12353}, 'accuracy': 0.385629652930691, 'macro avg': {'precision': 0.391909577167647, 'recall': 0.3881826664365582, 'f1-score': 0.36256149930837633, 'support': 38148}, 'weighted avg': {'precision': 0.39201196721854603, 'recall': 0.385629652930691, 'f1-score': 0.3611643537559898, 'support': 38148}}
[[8445 1929 2197]
 [7372 2716 3136]
 [6666 2137 3550]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
5521/5521 - 105s - 105s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7364962
{'0': {'precision': 0.6265866387791617, 'recall': 0.4464905031326595, 'f1-score': 0.5214256695586182, 'support': 283146}, '1': {'precision': 0.7015755469792126, 'recall': 0.8803146435778735, 'f1-score': 0.7808471552180972, 'support': 839426}, '2': {'precision': 0.6755380318712009, 'recall': 0.36772626901196265, 'f1-score': 0.47622271714922054, 'support': 290738}, 'accuracy': 0.6879545181170443, 'macro avg': {'precision': 0.6679000725431917, 'recall': 0.5648438052408319, 'f1-score': 0.5928318473086454, 'support': 1413310}, 'weighted avg': {'precision': 0.6811957969819121, 'recall': 0.6879545181170443, 'f1-score': 0.6662084306256102, 'support': 1413310}}
[[126422 145101  11623]
 [ 60740 738959  39727]
 [ 14601 169225 106912]]
Evaluating performance on  train set...
1289/1289 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7780602
{'0': {'precision': 0.548076601717857, 'recall': 0.46933402020548926, 'f1-score': 0.5056581665690235, 'support': 69882}, '1': {'precision': 0.6873171346897595, 'recall': 0.8598784066644929, 'f1-score': 0.763974748961502, 'support': 190142}, '2': {'precision': 0.6807048237940515, 'recall': 0.3125699365908243, 'f1-score': 0.4284169337554319, 'support': 69706}, 'accuracy': 0.6614047857337821, 'macro avg': {'precision': 0.6386995200672226, 'recall': 0.5472607878202688, 'f1-score': 0.5660166164286524, 'support': 329730}, 'weighted avg': {'precision': 0.656409044226536, 'recall': 0.6614047857337821, 'f1-score': 0.6382898780746991, 'support': 329730}}
[[ 32798  33928   3156]
 [ 19579 163499   7064]
 [  7465  40453  21788]]
Evaluating performance on  val set...
438/438 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.75731003
{'0': {'precision': 0.531061929722384, 'recall': 0.49415165063451205, 'f1-score': 0.5119423585280838, 'support': 22143}, '1': {'precision': 0.709205097755959, 'recall': 0.8498870338311669, 'f1-score': 0.7731989722713472, 'support': 68162}, '2': {'precision': 0.6956206646650792, 'recall': 0.310475486345363, 'f1-score': 0.4293290734824281, 'support': 21641}, 'accuracy': 0.6752452075107641, 'macro avg': {'precision': 0.6452958973811408, 'recall': 0.5515047236036806, 'f1-score': 0.5714901347606197, 'support': 111946}, 'weighted avg': {'precision': 0.6713421559242975, 'recall': 0.6752452075107641, 'f1-score': 0.6550465266474922, 'support': 111946}}
[[10942 10516   685]
 [ 7977 57930  2255]
 [ 1685 13237  6719]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
5918/5918 - 114s - 114s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77031153
{'0': {'precision': 0.5604185547465025, 'recall': 0.3835025163599036, 'f1-score': 0.4553811383999425, 'support': 280564}, '1': {'precision': 0.7118650656425813, 'recall': 0.9174020270376049, 'f1-score': 0.8016689923116911, 'support': 958147}, '2': {'precision': 0.6563629974722571, 'recall': 0.20957520349479003, 'f1-score': 0.31770721884790326, 'support': 276297}, 'accuracy': 0.6894405838120987, 'macro avg': {'precision': 0.6428822059537803, 'recall': 0.5034932489640994, 'f1-score': 0.5249191165198456, 'support': 1515008}, 'weighted avg': {'precision': 0.6736966244117076, 'recall': 0.6894405838120987, 'f1-score': 0.6492783174323373, 'support': 1515008}}
[[107597 161841  11126]
 [ 59951 879006  19190]
 [ 24446 193946  57905]]
Evaluating performance on  train set...
1814/1814 - 36s - 36s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7972002
{'0': {'precision': 0.5373898937002832, 'recall': 0.4006280367486368, 'f1-score': 0.4590391102197101, 'support': 94262}, '1': {'precision': 0.6904328434193634, 'recall': 0.9069890851200709, 'f1-score': 0.7840321230125379, 'support': 275129}, '2': {'precision': 0.6335092996132834, 'recall': 0.21753014079757188, 'f1-score': 0.32385659370832354, 'support': 94888}, 'accuracy': 0.6632735919565605, 'macro avg': {'precision': 0.62044401224431, 'recall': 0.5083824208887598, 'f1-score': 0.5223092756468571, 'support': 464279}, 'weighted avg': {'precision': 0.6477268503611134, 'recall': 0.6632735919565605, 'f1-score': 0.6239998428609571, 'support': 464279}}
[[ 37764  51269   5229]
 [ 18878 249539   6712]
 [ 13631  60616  20641]]
Evaluating performance on  val set...
636/636 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7562641
{'0': {'precision': 0.5270439621033636, 'recall': 0.3700809574093629, 'f1-score': 0.43483115862610894, 'support': 28410}, '1': {'precision': 0.7318826529851303, 'recall': 0.9221113553939531, 'f1-score': 0.8160577386792609, 'support': 106434}, '2': {'precision': 0.6536023054755044, 'recall': 0.20338618265298802, 'f1-score': 0.3102344540803764, 'support': 27878}, 'accuracy': 0.7025970673910105, 'macro avg': {'precision': 0.6375096401879995, 'recall': 0.49852616515210135, 'f1-score': 0.5203744504619153, 'support': 162722}, 'weighted avg': {'precision': 0.682708191413712, 'recall': 0.7025970673910105, 'f1-score': 0.6628394358845697, 'support': 162722}}
[[10514 16677  1219]
 [ 6504 98144  1786]
 [ 2931 19277  5670]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
3755/3755 - 70s - 70s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0290256
{'0': {'precision': 0.448203501735094, 'recall': 0.5117531847287392, 'f1-score': 0.4778748305080928, 'support': 310937}, '1': {'precision': 0.48170794946764495, 'recall': 0.6137414109153069, 'f1-score': 0.5397677469126263, 'support': 355684}, '2': {'precision': 0.48692502811118954, 'recall': 0.252873953459948, 'f1-score': 0.3328759837856923, 'support': 294542}, 'accuracy': 0.4701627091346629, 'macro avg': {'precision': 0.4722788264379762, 'recall': 0.4594561830346647, 'f1-score': 0.4501728537354705, 'support': 961163}, 'weighted avg': {'precision': 0.47246797280729785, 'recall': 0.4701627091346629, 'f1-score': 0.4563447359945928, 'support': 961163}}
[[159123 113443  38371]
 [ 97275 218298  40111]
 [ 98626 121434  74482]]
Evaluating performance on  train set...
1532/1532 - 29s - 29s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0439926
{'0': {'precision': 0.4464121753348846, 'recall': 0.5386635098423106, 'f1-score': 0.48821822083442235, 'support': 131778}, '1': {'precision': 0.44211877520397636, 'recall': 0.5831928744839103, 'f1-score': 0.5029505310955972, 'support': 129338}, '2': {'precision': 0.500071927497083, 'recall': 0.2387059855796742, 'f1-score': 0.3231557419381495, 'support': 131065}, 'accuracy': 0.45310456141424493, 'macro avg': {'precision': 0.46286762601198134, 'recall': 0.4535207899686317, 'f1-score': 0.438108164622723, 'support': 392181}, 'weighted avg': {'precision': 0.4629290785785581, 'recall': 0.45310456141424493, 'f1-score': 0.4379137281333987, 'support': 392181}}
[[70984 44293 16501]
 [39133 75429 14776]
 [48893 50886 31286]]
Evaluating performance on  val set...
467/467 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0583369
{'0': {'precision': 0.43615673817326445, 'recall': 0.5447742453919944, 'f1-score': 0.48445193778541995, 'support': 39822}, '1': {'precision': 0.42544062846208075, 'recall': 0.5351830736095274, 'f1-score': 0.4740433172483447, 'support': 39465}, '2': {'precision': 0.48827441372068603, 'recall': 0.2435405027932961, 'f1-score': 0.32498543972044264, 'support': 40096}, 'accuracy': 0.4404312171749747, 'macro avg': {'precision': 0.44995726011867704, 'recall': 0.4411659405982727, 'f1-score': 0.4278268982514024, 'support': 119383}, 'weighted avg': {'precision': 0.45011851706136036, 'recall': 0.4404312171749747, 'f1-score': 0.4274526588603719, 'support': 119383}}
[[21694 13250  4878]
 [12988 21121  5356]
 [15057 15274  9765]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
4960/4960 - 98s - 98s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9816317
{'0': {'precision': 0.4719789588002762, 'recall': 0.5390797879535785, 'f1-score': 0.5033027365531441, 'support': 391801}, '1': {'precision': 0.5235159621724248, 'recall': 0.7164711545978596, 'f1-score': 0.6049806176132608, 'support': 486074}, '2': {'precision': 0.5604850014017382, 'recall': 0.2245172981457613, 'f1-score': 0.3206069032880003, 'support': 391805}, 'accuracy': 0.5099213975174848, 'macro avg': {'precision': 0.5186599741248131, 'recall': 0.4933560802323998, 'f1-score': 0.4762967524848017, 'support': 1269680}, 'weighted avg': {'precision': 0.519020660172732, 'recall': 0.5099213975174848, 'f1-score': 0.48585096398522587, 'support': 1269680}}
[[211212 144920  35669]
 [104504 348258  33312]
 [131787 172051  87967]]
Evaluating performance on  train set...
1691/1691 - 33s - 33s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0042318
{'0': {'precision': 0.4841253646064651, 'recall': 0.5509384476682239, 'f1-score': 0.5153755231128007, 'support': 146412}, '1': {'precision': 0.4722981224784615, 'recall': 0.6925724877532107, 'f1-score': 0.5616086160522569, 'support': 143507}, '2': {'precision': 0.5692878524440302, 'recall': 0.22221444813713487, 'f1-score': 0.31965538411989086, 'support': 142925}, 'accuracy': 0.48935182190350335, 'macro avg': {'precision': 0.5085704465096522, 'recall': 0.4885751278528565, 'f1-score': 0.46554650776164946, 'support': 432844}, 'weighted avg': {'precision': 0.5083247448407311, 'recall': 0.48935182190350335, 'f1-score': 0.4660770959725398, 'support': 432844}}
[[80664 51459 14289]
 [34378 99389  9740]
 [51576 59589 31760]]
Evaluating performance on  val set...
591/591 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.026347
{'0': {'precision': 0.4747899829435863, 'recall': 0.5662978173245113, 'f1-score': 0.5165222970805261, 'support': 52596}, '1': {'precision': 0.4445780054993764, 'recall': 0.6587847616503016, 'f1-score': 0.5308883426336282, 'support': 44913}, '2': {'precision': 0.550256316367631, 'recall': 0.22418648018648019, 'f1-score': 0.3185775045380467, 'support': 53625}, 'accuracy': 0.47239535776198605, 'macro avg': {'precision': 0.4898747682701979, 'recall': 0.4830896863870977, 'f1-score': 0.45532938141740037, 'support': 151134}, 'weighted avg': {'precision': 0.4925885695416556, 'recall': 0.47239535776198605, 'f1-score': 0.45055721115569125, 'support': 151134}}
[[29785 16620  6191]
 [11690 29588  3635]
 [21258 20345 12022]]
testing model on single stock: results/universal/W8/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
10609/10609 - 208s - 208s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1169324
{'0': {'precision': 0.3535552573569513, 'recall': 0.7774599523187438, 'f1-score': 0.48606782857605185, 'support': 896369}, '1': {'precision': 0.3831069942695659, 'recall': 0.10879688973402678, 'f1-score': 0.1694674539775578, 'support': 897158}, '2': {'precision': 0.4239506581163601, 'recall': 0.22518340192267028, 'f1-score': 0.29413539457860766, 'support': 922155}, 'accuracy': 0.3690244292225673, 'macro avg': {'precision': 0.3868709699142925, 'recall': 0.3704800813251469, 'f1-score': 0.31655689237740575, 'support': 2715682}, 'weighted avg': {'precision': 0.3872219561723281, 'recall': 0.3690244292225673, 'f1-score': 0.3163012607131913, 'support': 2715682}}
[[696891  77067 122411]
 [639808  97608 159742]
 [634396  80105 207654]]
Evaluating performance on  train set...
3903/3903 - 76s - 76s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1119742
{'0': {'precision': 0.3665981640913856, 'recall': 0.7299425239779084, 'f1-score': 0.48807233893654334, 'support': 338228}, '1': {'precision': 0.3694780478868844, 'recall': 0.16912269368969277, 'f1-score': 0.2320350415223292, 'support': 321997}, '2': {'precision': 0.4168219055100438, 'recall': 0.21923751173126982, 'f1-score': 0.2873410719880555, 'support': 338838}, 'accuracy': 0.3759822954107999, 'macro avg': {'precision': 0.3842993724961046, 'recall': 0.37276757646629033, 'f1-score': 0.3358161508156427, 'support': 999063}, 'weighted avg': {'precision': 0.38456002038805015, 'recall': 0.3759822954107999, 'f1-score': 0.3374726042994119, 'support': 999063}}
[[246887  44003  47338]
 [210944  54457  56596]
 [215623  48929  74286]]
Evaluating performance on  val set...
1144/1144 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1179857
{'0': {'precision': 0.3584528461507473, 'recall': 0.7273070949811999, 'f1-score': 0.4802264079661063, 'support': 97872}, '1': {'precision': 0.3693995733008229, 'recall': 0.14759788102052, 'f1-score': 0.21092016532521207, 'support': 98538}, '2': {'precision': 0.39824789216672457, 'recall': 0.22629724701994325, 'f1-score': 0.28860172299536113, 'support': 96223}, 'accuracy': 0.36736116569218097, 'macro avg': {'precision': 0.3753667705394316, 'recall': 0.36706740767388774, 'f1-score': 0.32658276542889314, 'support': 292633}, 'weighted avg': {'precision': 0.3752242537251136, 'recall': 0.36736116569218097, 'f1-score': 0.32653355514606053, 'support': 292633}}
[[71183 12218 14471]
 [65563 14544 18431]
 [61838 12610 21775]]
training model: results/universal/W8/deepVOL_L3/h100
Epoch 1/50
7696/7696 - 651s - loss: 3.2366 - accuracy100: 0.3917 - val_loss: 3.3243 - val_accuracy100: 0.3594 - 651s/epoch - 85ms/step
Epoch 2/50
7696/7696 - 626s - loss: 3.1824 - accuracy100: 0.4151 - val_loss: 3.3981 - val_accuracy100: 0.3610 - 626s/epoch - 81ms/step
Epoch 3/50
7696/7696 - 629s - loss: 3.1618 - accuracy100: 0.4228 - val_loss: 3.3374 - val_accuracy100: 0.3625 - 629s/epoch - 82ms/step
Epoch 4/50
7696/7696 - 623s - loss: 3.1471 - accuracy100: 0.4292 - val_loss: 3.4008 - val_accuracy100: 0.3630 - 623s/epoch - 81ms/step
Epoch 5/50
7696/7696 - 618s - loss: 3.1272 - accuracy100: 0.4355 - val_loss: 3.4564 - val_accuracy100: 0.3635 - 618s/epoch - 80ms/step
Epoch 6/50
7696/7696 - 613s - loss: 3.1181 - accuracy100: 0.4379 - val_loss: 3.3899 - val_accuracy100: 0.3628 - 613s/epoch - 80ms/step
Epoch 7/50
7696/7696 - 603s - loss: 3.1101 - accuracy100: 0.4411 - val_loss: 3.3985 - val_accuracy100: 0.3645 - 603s/epoch - 78ms/step
Epoch 8/50
7696/7696 - 586s - loss: 3.1046 - accuracy100: 0.4435 - val_loss: 3.4006 - val_accuracy100: 0.3648 - 586s/epoch - 76ms/step
Epoch 9/50
7696/7696 - 591s - loss: 3.0987 - accuracy100: 0.4450 - val_loss: 3.4535 - val_accuracy100: 0.3633 - 591s/epoch - 77ms/step
Epoch 10/50
7696/7696 - 590s - loss: 3.0950 - accuracy100: 0.4462 - val_loss: 3.4291 - val_accuracy100: 0.3636 - 590s/epoch - 77ms/step
Epoch 11/50
7696/7696 - 599s - loss: 3.0919 - accuracy100: 0.4475 - val_loss: 3.4300 - val_accuracy100: 0.3642 - 599s/epoch - 78ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 1091s - 1091s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1020801
{'0': {'precision': 0.46475661648253097, 'recall': 0.07400837018415621, 'f1-score': 0.12768416867985688, 'support': 1974628}, '1': {'precision': 0.3351955810403778, 'recall': 0.9195623244853093, 'f1-score': 0.49130310524651816, 'support': 2023691}, '2': {'precision': 0.5210205459224571, 'recall': 0.02516955400583599, 'f1-score': 0.04801937922517122, 'support': 1962649}, 'accuracy': 0.34498557952332576, 'macro avg': {'precision': 0.4403242478151219, 'recall': 0.33958008289176717, 'f1-score': 0.22233555105051542, 'support': 5960968}, 'weighted avg': {'precision': 0.43929679913011016, 'recall': 0.34498557952332576, 'f1-score': 0.22489964609914082, 'support': 5960968}}
[[ 146139 1818729    9760]
 [ 127128 1860910   35653]
 [  41175 1872075   49399]]
Evaluating performance on  train set...
7696/7696 - 365s - 365s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1070197
{'0': {'precision': 0.43006417830912164, 'recall': 0.05798332846546599, 'f1-score': 0.10218903760795513, 'support': 640253}, '1': {'precision': 0.3477428064735173, 'recall': 0.9411298849924503, 'f1-score': 0.5078409211869235, 'support': 689433}, '2': {'precision': 0.5142658718675849, 'recall': 0.013888845472136344, 'f1-score': 0.02704722306349523, 'support': 639794}, 'accuracy': 0.3528119097426732, 'macro avg': {'precision': 0.43069095221674125, 'recall': 0.3376673529766842, 'f1-score': 0.21235906061945797, 'support': 1969480}, 'weighted avg': {'precision': 0.4286001715559722, 'recall': 0.3528119097426732, 'f1-score': 0.21978074351857152, 'support': 1969480}}
[[ 37124 600743   2386]
 [ 34580 648846   6007]
 [ 14618 616290   8886]]
Evaluating performance on  val set...
2338/2338 - 108s - 108s/epoch - 46ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007435
{'0': {'precision': 0.42770063237499184, 'recall': 0.06781088819291554, 'f1-score': 0.11706189889905966, 'support': 193494}, '1': {'precision': 0.3538628134411695, 'recall': 0.9297285914833879, 'f1-score': 0.512618538667052, 'support': 213700}, '2': {'precision': 0.5139357358423575, 'recall': 0.01518999296905334, 'f1-score': 0.02950784582532782, 'support': 190586}, 'accuracy': 0.3591605607414099, 'macro avg': {'precision': 0.4318330605528396, 'recall': 0.3375764908817856, 'f1-score': 0.21972942779714646, 'support': 597780}, 'weighted avg': {'precision': 0.42879812898456987, 'recall': 0.3591605607414099, 'f1-score': 0.230554951793619, 'support': 597780}}
[[ 13121 179620    753]
 [ 13032 198683   1985]
 [  4525 183166   2895]]
testing model out of sample: results/universal/W8/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 669s - 669s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0672139
{'0': {'precision': 0.4410475056503419, 'recall': 0.05875653839833818, 'f1-score': 0.10369833941844443, 'support': 1052819}, '1': {'precision': 0.41738367594768083, 'recall': 0.9530588924990809, 'f1-score': 0.5805295794288444, 'support': 1509615}, '2': {'precision': 0.45482510714779484, 'recall': 0.012486857437836155, 'f1-score': 0.024306402157449482, 'support': 1053828}, 'accuracy': 0.41860103056692244, 'macro avg': {'precision': 0.4377520962486059, 'recall': 0.34143409611175174, 'f1-score': 0.23617810700157946, 'support': 3616262}, 'weighted avg': {'precision': 0.4351839786034286, 'recall': 0.41860103056692244, 'f1-score': 0.2796164963242273, 'support': 3616262}}
[[  61860  987915    3044]
 [  58134 1438752   12729]
 [  20263 1020406   13159]]
Evaluating performance on  train set...
4550/4550 - 218s - 218s/epoch - 48ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0846685
{'0': {'precision': 0.42777890363765325, 'recall': 0.04702917217851424, 'f1-score': 0.08474197781463352, 'support': 359075}, '1': {'precision': 0.38384012126359246, 'recall': 0.9548812694309179, 'f1-score': 0.5475698600147865, 'support': 448705}, '2': {'precision': 0.4545023134416894, 'recall': 0.010750032971257482, 'f1-score': 0.02100328947368421, 'support': 356371}, 'accuracy': 0.3858416992297391, 'macro avg': {'precision': 0.4220404461143117, 'recall': 0.33755349152689657, 'f1-score': 0.21777170910103474, 'support': 1164151}, 'weighted avg': {'precision': 0.41902393708273145, 'recall': 0.3858416992297391, 'f1-score': 0.24362047792318234, 'support': 1164151}}
[[ 16887 341202    986]
 [ 16633 428460   3612]
 [  5956 346584   3831]]
Evaluating performance on  val set...
1570/1570 - 73s - 73s/epoch - 47ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0794895
{'0': {'precision': 0.41300448430493275, 'recall': 0.045798489959306805, 'f1-score': 0.08245361424659986, 'support': 120659}, '1': {'precision': 0.39564941943792453, 'recall': 0.9566926167754897, 'f1-score': 0.5597916329919328, 'support': 159280}, '2': {'precision': 0.4348345954563571, 'recall': 0.009009529786777215, 'f1-score': 0.017653293204857486, 'support': 121094}, 'accuracy': 0.39647360691015454, 'macro avg': {'precision': 0.41449616639973813, 'recall': 0.3371668788405246, 'f1-score': 0.21996618014779676, 'support': 401033}, 'weighted avg': {'precision': 0.4127032142043513, 'recall': 0.39647360691015454, 'f1-score': 0.25247321250790977, 'support': 401033}}
[[  5526 114796    337]
 [  5817 152382   1081]
 [  2037 117966   1091]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
645/645 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1271865
{'0': {'precision': 0.3909048067860509, 'recall': 0.029388319073178508, 'f1-score': 0.05466677650547821, 'support': 56451}, '1': {'precision': 0.32382003967511325, 'recall': 0.9728985099803205, 'f1-score': 0.48590965893932797, 'support': 53355}, '2': {'precision': 0.4021164021164021, 'recall': 0.002757719801153888, 'f1-score': 0.005477872279083177, 'support': 55118}, 'accuracy': 0.32572578884819675, 'macro avg': {'precision': 0.3722804161925221, 'recall': 0.33501484961821765, 'f1-score': 0.18201810257462978, 'support': 164924}, 'weighted avg': {'precision': 0.372948978417919, 'recall': 0.32572578884819675, 'f1-score': 0.17774025258602205, 'support': 164924}}
[[ 1659 54695    97]
 [ 1317 51909   129]
 [ 1268 53698   152]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1274626
{'0': {'precision': 0.3896551724137931, 'recall': 0.023673597653590322, 'f1-score': 0.04463536266232163, 'support': 19093}, '1': {'precision': 0.33126846298451346, 'recall': 0.9776497939342703, 'f1-score': 0.4948583196266431, 'support': 18926}, '2': {'precision': 0.33093525179856115, 'recall': 0.0024039717794617195, 'f1-score': 0.00477326968973747, 'support': 19135}, 'accuracy': 0.3324526717290128, 'macro avg': {'precision': 0.35061962906562255, 'recall': 0.3345757877891074, 'f1-score': 0.18142231732623407, 'support': 57154}, 'weighted avg': {'precision': 0.3506617066260791, 'recall': 0.3324526717290128, 'f1-score': 0.180376667461222, 'support': 57154}}
[[  452 18601    40]
 [  370 18503    53]
 [  338 18751    46]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1397034
{'0': {'precision': 0.4181360201511335, 'recall': 0.02741535920726672, 'f1-score': 0.05145691258524489, 'support': 6055}, '1': {'precision': 0.3113740412628575, 'recall': 0.9765056871154205, 'f1-score': 0.4721846542241458, 'support': 5363}, '2': {'precision': 0.23809523809523808, 'recall': 0.0008592541673827118, 'f1-score': 0.0017123287671232876, 'support': 5819}, 'accuracy': 0.31374369089748794, 'macro avg': {'precision': 0.32253509983640966, 'recall': 0.3349267668300233, 'f1-score': 0.1751179651921713, 'support': 17237}, 'weighted avg': {'precision': 0.3241392803726872, 'recall': 0.31374369089748794, 'f1-score': 0.16556604672527947, 'support': 17237}}
[[ 166 5878   11]
 [ 121 5237    5]
 [ 110 5704    5]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
2179/2179 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0409529
{'0': {'precision': 0.41137959332543084, 'recall': 0.1417903880724603, 'f1-score': 0.21089239888000222, 'support': 159094}, '1': {'precision': 0.4397780430757236, 'recall': 0.8763959021169159, 'f1-score': 0.5856667748215444, 'support': 247152}, '2': {'precision': 0.552942305846213, 'recall': 0.03801127139783811, 'f1-score': 0.07113262653518657, 'support': 151534}, 'accuracy': 0.4390996450213346, 'macro avg': {'precision': 0.46803331408245574, 'recall': 0.3520658538624047, 'f1-score': 0.28923060007891105, 'support': 557780}, 'weighted avg': {'precision': 0.46242175642164896, 'recall': 0.4390996450213346, 'f1-score': 0.33898569591504246, 'support': 557780}}
[[ 22558 135563    973]
 [ 26865 216603   3684]
 [  5412 140362   5760]]
Evaluating performance on  train set...
614/614 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0831254
{'0': {'precision': 0.41451950846593805, 'recall': 0.1506327811503241, 'f1-score': 0.22096779062396232, 'support': 48595}, '1': {'precision': 0.38205941485153544, 'recall': 0.861226092505031, 'f1-score': 0.5293064786976239, 'support': 61121}, '2': {'precision': 0.5003028467595396, 'recall': 0.017436828439340524, 'f1-score': 0.03369915548121252, 'support': 47371}, 'accuracy': 0.3869511799194077, 'macro avg': {'precision': 0.4322939233590044, 'recall': 0.3430985673648985, 'f1-score': 0.26132447493426625, 'support': 157087}, 'weighted avg': {'precision': 0.4277583451392484, 'recall': 0.3869511799194077, 'f1-score': 0.2844667844197766, 'support': 157087}}
[[ 7320 41068   207]
 [ 7864 52639   618]
 [ 2475 44070   826]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0488183
{'0': {'precision': 0.3725231175693527, 'recall': 0.16375117950206866, 'f1-score': 0.22749962184238387, 'support': 13777}, '1': {'precision': 0.42794655448526425, 'recall': 0.8401689347724073, 'f1-score': 0.5670578174735141, 'support': 21310}, '2': {'precision': 0.5322338830584707, 'recall': 0.026348994284866027, 'f1-score': 0.05021216407355021, 'support': 13473}, 'accuracy': 0.4224670510708402, 'macro avg': {'precision': 0.44423451837102923, 'recall': 0.3434230361864474, 'f1-score': 0.28158986779648276, 'support': 48560}, 'weighted avg': {'precision': 0.4411569022504269, 'recall': 0.4224670510708402, 'f1-score': 0.32732234075465505, 'support': 48560}}
[[ 2256 11449    72]
 [ 3166 17904   240]
 [  634 12484   355]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
1162/1162 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0137337
{'0': {'precision': 0.27307692307692305, 'recall': 0.029427115313766426, 'f1-score': 0.05312898398093232, 'support': 65144}, '1': {'precision': 0.5506080870378712, 'recall': 0.9702592470479051, 'f1-score': 0.7025367380501866, 'support': 163782}, '2': {'precision': 0.2765957446808511, 'recall': 0.00739746414345536, 'f1-score': 0.014409549523944862, 'support': 68537}, 'accuracy': 0.5423699754255151, 'macro avg': {'precision': 0.36676025159854847, 'recall': 0.3356946088350423, 'f1-score': 0.2566917571850213, 'support': 297463}, 'weighted avg': {'precision': 0.4266952842583824, 'recall': 0.5423699754255151, 'f1-score': 0.4017692750342467, 'support': 297463}}
[[  1917  63092    135]
 [  3680 158911   1191]
 [  1423  66607    507]]
Evaluating performance on  train set...
327/327 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1266137
{'0': {'precision': 0.38006042296072506, 'recall': 0.022322379161047626, 'f1-score': 0.042168068916971134, 'support': 28178}, '1': {'precision': 0.3292907244812871, 'recall': 0.9735697193822058, 'f1-score': 0.4921286538990195, 'support': 27582}, '2': {'precision': 0.3562005277044855, 'recall': 0.0048522751779167565, 'f1-score': 0.009574128577000816, 'support': 27822}, 'accuracy': 0.3304180325907492, 'macro avg': {'precision': 0.35518389171549924, 'recall': 0.3335814579070568, 'f1-score': 0.1812902837976638, 'support': 83582}, 'weighted avg': {'precision': 0.35536419854303997, 'recall': 0.3304180325907492, 'f1-score': 0.17980517076708483, 'support': 83582}}
[[  629 27470    79]
 [  564 26853   165]
 [  462 27225   135]]
Evaluating performance on  val set...
125/125 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886565
{'0': {'precision': 0.3858267716535433, 'recall': 0.03602562756013024, 'f1-score': 0.06589817483189242, 'support': 9521}, '1': {'precision': 0.39785085868259584, 'recall': 0.9668639053254438, 'f1-score': 0.5637333824002944, 'support': 12675}, '2': {'precision': 0.26, 'recall': 0.0027094622759483117, 'f1-score': 0.005363036303630363, 'support': 9596}, 'accuracy': 0.39708102667337697, 'macro avg': {'precision': 0.3478925434453797, 'recall': 0.33519966505384075, 'f1-score': 0.21166486451193903, 'support': 31792}, 'weighted avg': {'precision': 0.35264142950161326, 'recall': 0.39708102667337697, 'f1-score': 0.24610596504994384, 'support': 31792}}
[[  343  9160    18]
 [  364 12255    56]
 [  182  9388    26]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1223/1223 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1144062
{'0': {'precision': 0.3146374829001368, 'recall': 0.008868752108738612, 'f1-score': 0.017251239932870175, 'support': 103735}, '1': {'precision': 0.36107399446155036, 'recall': 0.9890287674381597, 'f1-score': 0.5290153872343645, 'support': 113114}, '2': {'precision': 0.24727272727272728, 'recall': 0.0007069782916077518, 'f1-score': 0.0014099254605583716, 'support': 96184}, 'accuracy': 0.36054026252823185, 'macro avg': {'precision': 0.30766140154480487, 'recall': 0.3328681659461687, 'f1-score': 0.18255885087593102, 'support': 313033}, 'weighted avg': {'precision': 0.31071843255557563, 'recall': 0.36054026252823185, 'f1-score': 0.19730896153620398, 'support': 313033}}
[[   920 102728     87]
 [  1121 111873    120]
 [   883  95233     68]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1302446
{'0': {'precision': 0.3075089392133492, 'recall': 0.008348433859694538, 'f1-score': 0.016255552405254704, 'support': 30904}, '1': {'precision': 0.3294545374176723, 'recall': 0.9891506303915063, 'f1-score': 0.4942801246767027, 'support': 30140}, '2': {'precision': 0.42045454545454547, 'recall': 0.0012181069958847736, 'f1-score': 0.0024291763779010606, 'support': 30375}, 'accuracy': 0.32934072785744756, 'macro avg': {'precision': 0.3524726740285223, 'recall': 0.33290572374902855, 'f1-score': 0.17098828448661949, 'support': 91419}, 'weighted avg': {'precision': 0.35227165942965694, 'recall': 0.32934072785744756, 'f1-score': 0.16926186877745933, 'support': 91419}}
[[  258 30623    23]
 [  299 29813    28]
 [  282 30056    37]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1228106
{'0': {'precision': 0.3107569721115538, 'recall': 0.009179710486053901, 'f1-score': 0.017832647462277088, 'support': 8497}, '1': {'precision': 0.3433935075851579, 'recall': 0.9896181797208444, 'f1-score': 0.5098656840603827, 'support': 8669}, '2': {'precision': 0.375, 'recall': 0.0011122095897182402, 'f1-score': 0.0022178413011335633, 'support': 8092}, 'accuracy': 0.3430992160899517, 'macro avg': {'precision': 0.3430501598989039, 'recall': 0.3333033665988722, 'f1-score': 0.17663872427459779, 'support': 25258}, 'weighted avg': {'precision': 0.34254019753296405, 'recall': 0.3430992160899517, 'f1-score': 0.18170466356858017, 'support': 25258}}
[[  78 8411    8]
 [  83 8579    7]
 [  90 7993    9]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
1443/1443 - 27s - 27s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1177012
{'0': {'precision': 0.3213965980304387, 'recall': 0.024368927919901574, 'f1-score': 0.04530290004811067, 'support': 117855}, '1': {'precision': 0.35159424166931397, 'recall': 0.9670202492450604, 'f1-score': 0.5156909067128798, 'support': 130474}, '2': {'precision': 0.3192555476020043, 'recall': 0.0036902811563984178, 'f1-score': 0.00729622510326776, 'support': 120858}, 'accuracy': 0.35074095241706776, 'macro avg': {'precision': 0.3307487957672523, 'recall': 0.3316931527737868, 'f1-score': 0.1894300106214194, 'support': 369187}, 'weighted avg': {'precision': 0.3313678166363454, 'recall': 0.35074095241706776, 'f1-score': 0.19910028202823252, 'support': 369187}}
[[  2872 114720    263]
 [  3615 126171    688]
 [  2449 117963    446]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1292462
{'0': {'precision': 0.3610304789550073, 'recall': 0.02391367044799077, 'f1-score': 0.044856189703363095, 'support': 41608}, '1': {'precision': 0.3286274764639466, 'recall': 0.9732727097767514, 'f1-score': 0.49134973311391383, 'support': 41568}, '2': {'precision': 0.4309133489461358, 'recall': 0.004267557287317933, 'f1-score': 0.008451415841811544, 'support': 43116}, 'accuracy': 0.32968042314635926, 'macro avg': {'precision': 0.3735237681216966, 'recall': 0.33381797917068673, 'f1-score': 0.18155244621969616, 'support': 126292}, 'weighted avg': {'precision': 0.3742232529627757, 'recall': 0.32968042314635926, 'f1-score': 0.1793873981938068, 'support': 126292}}
[[  995 40524    89]
 [  957 40457   154]
 [  804 42128   184]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1209468
{'0': {'precision': 0.37246531483457845, 'recall': 0.028007383035069416, 'f1-score': 0.05209732795939692, 'support': 12461}, '1': {'precision': 0.3436783160167319, 'recall': 0.9690305889514533, 'f1-score': 0.5074008406876904, 'support': 13142}, '2': {'precision': 0.46794871794871795, 'recall': 0.005819051414906337, 'f1-score': 0.011495157861585701, 'support': 12545}, 'accuracy': 0.3448935724022229, 'macro avg': {'precision': 0.39469744960000935, 'recall': 0.334285674467143, 'f1-score': 0.19033110883622437, 'support': 38148}, 'weighted avg': {'precision': 0.39394797588110103, 'recall': 0.3448935724022229, 'f1-score': 0.19559749940739396, 'support': 38148}}
[[  349 12089    23]
 [  347 12735    60]
 [  241 12231    73]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
5521/5521 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0242343
{'0': {'precision': 0.5037584600808991, 'recall': 0.21824952071965786, 'f1-score': 0.3045535378964174, 'support': 406860}, '1': {'precision': 0.42415637644925147, 'recall': 0.8293664360603866, 'f1-score': 0.5612679063474142, 'support': 596688}, '2': {'precision': 0.5331920703091669, 'recall': 0.09149945578164886, 'f1-score': 0.15619480086652227, 'support': 409762}, 'accuracy': 0.4395093786925727, 'macro avg': {'precision': 0.4870356356131058, 'recall': 0.37970513752056445, 'f1-score': 0.34067208170345137, 'support': 1413310}, 'weighted avg': {'precision': 0.478684815173805, 'recall': 0.4395093786925727, 'f1-score': 0.3699225017326914, 'support': 1413310}}
[[ 88797 312805   5258]
 [ 74248 494873  27567]
 [ 13224 359045  37493]]
Evaluating performance on  train set...
1289/1289 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0398827
{'0': {'precision': 0.4752825223179731, 'recall': 0.1909129538082061, 'f1-score': 0.2724053028902674, 'support': 96489}, '1': {'precision': 0.4192200855463757, 'recall': 0.8516304978530811, 'f1-score': 0.561860874641707, 'support': 137872}, '2': {'precision': 0.5505050505050505, 'recall': 0.06286109742159401, 'f1-score': 0.11283750082345965, 'support': 95369}, 'accuracy': 0.4301458769296091, 'macro avg': {'precision': 0.48166921945646646, 'recall': 0.36846818302762707, 'f1-score': 0.315701226118478, 'support': 329730}, 'weighted avg': {'precision': 0.4735976801989658, 'recall': 0.4301458769296091, 'f1-score': 0.34728474022749817, 'support': 329730}}
[[ 18421  77031   1037]
 [ 16598 117416   3858]
 [  3739  85635   5995]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0293597
{'0': {'precision': 0.4652100638016131, 'recall': 0.24322623280989394, 'f1-score': 0.31943956520840655, 'support': 31777}, '1': {'precision': 0.44324530356656683, 'recall': 0.8268695528513094, 'f1-score': 0.5771226816402927, 'support': 49223}, '2': {'precision': 0.5662959794696322, 'recall': 0.06417630711562076, 'f1-score': 0.11528749310655097, 'support': 30946}, 'accuracy': 0.4503599949975881, 'macro avg': {'precision': 0.49158378227927074, 'recall': 0.37809069759227465, 'f1-score': 0.3372832466517501, 'support': 111946}, 'weighted avg': {'precision': 0.48349596372847814, 'recall': 0.4503599949975881, 'f1-score': 0.37630846643634425, 'support': 111946}}
[[ 7729 23738   310]
 [ 7311 40701  1211]
 [ 1574 27386  1986]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
5918/5918 - 106s - 106s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0160633
{'0': {'precision': 0.4632325732732771, 'recall': 0.09428067614909769, 'f1-score': 0.15667387373390818, 'support': 385063}, '1': {'precision': 0.499072472328875, 'recall': 0.9467458699735337, 'f1-score': 0.6536018919809992, 'support': 749632}, '2': {'precision': 0.48802908691774716, 'recall': 0.018705645087073015, 'f1-score': 0.036030286915343504, 'support': 380313}, 'accuracy': 0.49711222647009123, 'macro avg': {'precision': 0.48344471083996643, 'recall': 0.35324406373656814, 'f1-score': 0.28210201754341696, 'support': 1515008}, 'weighted avg': {'precision': 0.48719097593683747, 'recall': 0.49711222647009123, 'f1-score': 0.3722706360882156, 'support': 1515008}}
[[ 36304 347612   1147]
 [ 33605 709711   6316]
 [  8462 364737   7114]]
Evaluating performance on  train set...
1814/1814 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0308648
{'0': {'precision': 0.43613399773052447, 'recall': 0.0719658731967827, 'f1-score': 0.12354564830019917, 'support': 122836}, '1': {'precision': 0.4678895319691929, 'recall': 0.9452822892498066, 'f1-score': 0.6259503356277549, 'support': 217224}, '2': {'precision': 0.45689320388349514, 'recall': 0.018942351814134714, 'f1-score': 0.03637656625621285, 'support': 124219}, 'accuracy': 0.4663812061282117, 'macro avg': {'precision': 0.4536389111944042, 'recall': 0.34539683808690796, 'f1-score': 0.2619575167280557, 'support': 464279}, 'weighted avg': {'precision': 0.4565457587590792, 'recall': 0.4663812061282117, 'f1-score': 0.3352853556693005, 'support': 464279}}
[[  8840 113584    412]
 [  9501 205338   2385]
 [  1928 119938   2353]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0020541
{'0': {'precision': 0.4252041287937144, 'recall': 0.0704243321170677, 'f1-score': 0.12083533995884595, 'support': 39191}, '1': {'precision': 0.5236301126412863, 'recall': 0.9545609839426034, 'f1-score': 0.676281810518233, 'support': 84883}, '2': {'precision': 0.43967828418230565, 'recall': 0.016973711446905404, 'f1-score': 0.03268560039860489, 'support': 38648}, 'accuracy': 0.5189341330612948, 'macro avg': {'precision': 0.4628375085391021, 'recall': 0.3473196758355255, 'f1-score': 0.2766009169585613, 'support': 162722}, 'weighted avg': {'precision': 0.479985227504348, 'recall': 0.5189341330612948, 'f1-score': 0.3896444230943056, 'support': 162722}}
[[ 2760 36297   134]
 [ 3155 81026   702]
 [  576 37416   656]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
3755/3755 - 69s - 69s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1037383
{'0': {'precision': 0.456364796346664, 'recall': 0.04297780434047047, 'f1-score': 0.07855751501384337, 'support': 316233}, '1': {'precision': 0.35993957978519664, 'recall': 0.961372175018785, 'f1-score': 0.5237763085590302, 'support': 346020}, '2': {'precision': 0.4471341124095715, 'recall': 0.010752400388076679, 'f1-score': 0.020999810518200056, 'support': 298910}, 'accuracy': 0.36357933045695684, 'macro avg': {'precision': 0.42114616284714407, 'recall': 0.3383674599157774, 'f1-score': 0.20777787803035788, 'support': 961163}, 'weighted avg': {'precision': 0.4187809555514656, 'recall': 0.36357933045695684, 'f1-score': 0.2209371462436273, 'support': 961163}}
[[ 13591 301351   1291]
 [ 10683 332654   2683]
 [  5507 290189   3214]]
Evaluating performance on  train set...
1532/1532 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1207663
{'0': {'precision': 0.4246709719610889, 'recall': 0.03983895705521472, 'f1-score': 0.07284429269523883, 'support': 130400}, '1': {'precision': 0.3327241134526345, 'recall': 0.9606454573263995, 'f1-score': 0.4942592053386636, 'support': 130760}, '2': {'precision': 0.464817880794702, 'recall': 0.008571145083612551, 'f1-score': 0.01683191318749672, 'support': 131021}, 'accuracy': 0.33640589421721095, 'macro avg': {'precision': 0.40740432206947513, 'recall': 0.3363518531550756, 'f1-score': 0.1946451370737997, 'support': 392181}, 'weighted avg': {'precision': 0.40742668150266104, 'recall': 0.33640589421721095, 'f1-score': 0.19463860705970407, 'support': 392181}}
[[  5195 124747    458]
 [  4311 125614    835]
 [  2727 127171   1123]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1122388
{'0': {'precision': 0.42951388888888886, 'recall': 0.032149911633225906, 'f1-score': 0.0598220330786343, 'support': 38476}, '1': {'precision': 0.3492985211133928, 'recall': 0.9703732112466742, 'f1-score': 0.5136882442883699, 'support': 41719}, '2': {'precision': 0.4578512396694215, 'recall': 0.0070684903541900585, 'f1-score': 0.01392204659110899, 'support': 39188}, 'accuracy': 0.35178375480596064, 'macro avg': {'precision': 0.41222121655723437, 'recall': 0.3365305377446967, 'f1-score': 0.19581077465270438, 'support': 119383}, 'weighted avg': {'precision': 0.4107840795706576, 'recall': 0.35178375480596064, 'f1-score': 0.20336102770086545, 'support': 119383}}
[[ 1237 37142    97]
 [ 1005 40483   231]
 [  638 38273   277]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
4960/4960 - 91s - 91s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11824
{'0': {'precision': 0.4588091646915176, 'recall': 0.044743711271847696, 'f1-score': 0.08153592511833217, 'support': 428306}, '1': {'precision': 0.3222381046267087, 'recall': 0.9512139524506998, 'f1-score': 0.4813960281090686, 'support': 412372}, '2': {'precision': 0.46580754397516694, 'recall': 0.011543069729278651, 'f1-score': 0.022527881210009256, 'support': 429002}, 'accuracy': 0.3279330224938567, 'macro avg': {'precision': 0.41561827109779775, 'recall': 0.3358335778172754, 'f1-score': 0.19515327814580333, 'support': 1269680}, 'weighted avg': {'precision': 0.41681766882515653, 'recall': 0.3279330224938567, 'f1-score': 0.19146641275122991, 'support': 1269680}}
[[ 19164 407702   1440]
 [ 15879 392254   4239]
 [  6726 417324   4952]]
Evaluating performance on  train set...
1691/1691 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1156919
{'0': {'precision': 0.44907441551736854, 'recall': 0.04132057546145494, 'f1-score': 0.07567782548984271, 'support': 147360}, '1': {'precision': 0.3299517950931722, 'recall': 0.9593807747289146, 'f1-score': 0.49102832924381, 'support': 143405}, '2': {'precision': 0.5075593952483801, 'recall': 0.0082700469457133, 'f1-score': 0.01627491447013034, 'support': 142079}, 'accuracy': 0.33463326279213756, 'macro avg': {'precision': 0.4288618686196403, 'recall': 0.3363237990453609, 'f1-score': 0.19432702306792768, 'support': 432844}, 'weighted avg': {'precision': 0.4288054688605373, 'recall': 0.33463326279213756, 'f1-score': 0.19378835213701345, 'support': 432844}}
[[  6089 140936    335]
 [  5020 137580    805]
 [  2450 138454   1175]]
Evaluating performance on  val set...
591/591 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1429753
{'0': {'precision': 0.41898628998753634, 'recall': 0.037749621006531786, 'f1-score': 0.0692591638767276, 'support': 53431}, '1': {'precision': 0.2823264468200512, 'recall': 0.951477427864035, 'f1-score': 0.4354456116570654, 'support': 43217}, '2': {'precision': 0.4442793462109955, 'recall': 0.005487648203208163, 'f1-score': 0.010841385811925524, 'support': 54486}, 'accuracy': 0.28740058491140313, 'macro avg': {'precision': 0.38186402767286104, 'recall': 0.3315715656912583, 'f1-score': 0.17184872044857283, 'support': 151134}, 'weighted avg': {'precision': 0.38902671119799986, 'recall': 0.28740058491140313, 'f1-score': 0.15291028578234814, 'support': 151134}}
[[ 2017 51262   152]
 [ 1875 41120   222]
 [  922 53265   299]]
testing model on single stock: results/universal/W8/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
10609/10609 - 188s - 188s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1530749
{'0': {'precision': 0.39972315602135655, 'recall': 0.020444904754295008, 'f1-score': 0.03890015741727895, 'support': 988706}, '1': {'precision': 0.2651844846033344, 'recall': 0.9780385366239454, 'f1-score': 0.41723912898714793, 'support': 720717}, '2': {'precision': 0.40619645916619074, 'recall': 0.0028273039048594844, 'f1-score': 0.00561552134046146, 'support': 1006259}, 'accuracy': 0.2680534760697313, 'macro avg': {'precision': 0.35703469993029396, 'recall': 0.3337702484276999, 'f1-score': 0.15391826924829613, 'support': 2715682}, 'weighted avg': {'precision': 0.36641642566811017, 'recall': 0.2680534760697313, 'f1-score': 0.1269746683353095, 'support': 2715682}}
[[ 20214 966121   2371]
 [ 14040 704889   1788]
 [ 16316 987098   2845]]
Evaluating performance on  train set...
3903/3903 - 70s - 70s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1255158
{'0': {'precision': 0.36629007283362963, 'recall': 0.019130486873436867, 'f1-score': 0.036361876675908476, 'support': 333865}, '1': {'precision': 0.3299614923919137, 'recall': 0.9805395399647994, 'f1-score': 0.49376579181205765, 'support': 329540}, '2': {'precision': 0.3916203505771697, 'recall': 0.0027289681759409875, 'f1-score': 0.00542016645118152, 'support': 335658}, 'accuracy': 0.33073990328938213, 'macro avg': {'precision': 0.3626239719342377, 'recall': 0.33413299833805904, 'f1-score': 0.17851594497971587, 'support': 999063}, 'weighted avg': {'precision': 0.36281740891561653, 'recall': 0.33073990328938213, 'f1-score': 0.17684055882443686, 'support': 999063}}
[[  6387 326809    669]
 [  5659 323127    754]
 [  5391 329351    916]]
Evaluating performance on  val set...
1144/1144 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1298773
{'0': {'precision': 0.3934791413527744, 'recall': 0.01924391137698456, 'f1-score': 0.03669326282989472, 'support': 100967}, '1': {'precision': 0.3173759359705509, 'recall': 0.9813104258506774, 'f1-score': 0.47962976133092056, 'support': 92779}, '2': {'precision': 0.37122128174123337, 'recall': 0.0031045536824860697, 'f1-score': 0.0061576107667930275, 'support': 98887}, 'accuracy': 0.31881230073163314, 'macro avg': {'precision': 0.36069211968818626, 'recall': 0.334552963636716, 'f1-score': 0.17416021164253612, 'support': 292633}, 'weighted avg': {'precision': 0.36182928554169436, 'recall': 0.31881230073163314, 'f1-score': 0.16680718152280613, 'support': 292633}}
[[ 1943 98775   249]
 [ 1463 91045   271]
 [ 1532 97048   307]]
training model: results/universal/W8/deepVOL_L3/h200
Epoch 1/50
7696/7696 - 583s - loss: 3.2748 - accuracy200: 0.3657 - val_loss: 3.3026 - val_accuracy200: 0.3357 - 583s/epoch - 76ms/step
Epoch 2/50
7696/7696 - 579s - loss: 3.2660 - accuracy200: 0.3728 - val_loss: 3.2893 - val_accuracy200: 0.3560 - 579s/epoch - 75ms/step
Epoch 3/50
7696/7696 - 577s - loss: 3.2505 - accuracy200: 0.3839 - val_loss: 3.2835 - val_accuracy200: 0.3590 - 577s/epoch - 75ms/step
Epoch 4/50
7696/7696 - 573s - loss: 3.2431 - accuracy200: 0.3889 - val_loss: 3.3033 - val_accuracy200: 0.3384 - 573s/epoch - 74ms/step
Epoch 5/50
7696/7696 - 588s - loss: 3.2362 - accuracy200: 0.3929 - val_loss: 3.3065 - val_accuracy200: 0.3423 - 588s/epoch - 76ms/step
Epoch 6/50
7696/7696 - 575s - loss: 3.2300 - accuracy200: 0.3933 - val_loss: 3.2895 - val_accuracy200: 0.3475 - 575s/epoch - 75ms/step
Epoch 7/50
7696/7696 - 574s - loss: 3.2281 - accuracy200: 0.3931 - val_loss: 3.2784 - val_accuracy200: 0.3561 - 574s/epoch - 75ms/step
Epoch 8/50
7696/7696 - 575s - loss: 3.2185 - accuracy200: 0.3983 - val_loss: 3.2856 - val_accuracy200: 0.3511 - 575s/epoch - 75ms/step
Epoch 9/50
7696/7696 - 576s - loss: 3.2095 - accuracy200: 0.4038 - val_loss: 3.3331 - val_accuracy200: 0.3432 - 576s/epoch - 75ms/step
Epoch 10/50
7696/7696 - 580s - loss: 3.2039 - accuracy200: 0.4062 - val_loss: 3.2987 - val_accuracy200: 0.3524 - 580s/epoch - 75ms/step
Epoch 11/50
7696/7696 - 574s - loss: 3.1983 - accuracy200: 0.4087 - val_loss: 3.3022 - val_accuracy200: 0.3540 - 574s/epoch - 75ms/step
Epoch 12/50
7696/7696 - 575s - loss: 3.1967 - accuracy200: 0.4105 - val_loss: 3.3106 - val_accuracy200: 0.3489 - 575s/epoch - 75ms/step
Epoch 13/50
7696/7696 - 571s - loss: 3.1867 - accuracy200: 0.4143 - val_loss: 3.3046 - val_accuracy200: 0.3525 - 571s/epoch - 74ms/step
Epoch 14/50
7696/7696 - 575s - loss: 3.1825 - accuracy200: 0.4166 - val_loss: 3.3311 - val_accuracy200: 0.3464 - 575s/epoch - 75ms/step
Epoch 15/50
7696/7696 - 574s - loss: 3.1780 - accuracy200: 0.4198 - val_loss: 3.3554 - val_accuracy200: 0.3533 - 574s/epoch - 75ms/step
Epoch 16/50
7696/7696 - 577s - loss: 3.1731 - accuracy200: 0.4218 - val_loss: 3.3688 - val_accuracy200: 0.3495 - 577s/epoch - 75ms/step
Epoch 17/50
7696/7696 - 576s - loss: 3.1687 - accuracy200: 0.4237 - val_loss: 3.3316 - val_accuracy200: 0.3622 - 576s/epoch - 75ms/step
testing model in sample: results/universal/W8/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
23287/23287 - 1069s - 1069s/epoch - 46ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.089184
{'0': {'precision': 0.41656802199852566, 'recall': 0.13117888485088997, 'f1-score': 0.19952619688760875, 'support': 2076386}, '1': {'precision': 0.3321958717822432, 'recall': 0.5978169064064175, 'f1-score': 0.4270743650998685, 'support': 1845821}, '2': {'precision': 0.38560891556385624, 'recall': 0.3755128727692947, 'f1-score': 0.38049393373943224, 'support': 2038761}, 'accuracy': 0.35924064682112034, 'macro avg': {'precision': 0.3781242697815417, 'recall': 0.3681695546755341, 'f1-score': 0.33569816524230317, 'support': 5960968}, 'weighted avg': {'precision': 0.37985349753232794, 'recall': 0.35924064682112034, 'f1-score': 0.33188106803428863, 'support': 5960968}}
[[ 272378 1123646  680362]
 [ 202919 1103463  539439]
 [ 178565 1094615  765581]]
Evaluating performance on  train set...
7696/7696 - 364s - 364s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951788
{'0': {'precision': 0.386498587862506, 'recall': 0.12752687683251132, 'f1-score': 0.19177632703284686, 'support': 659955}, '1': {'precision': 0.34125870685830345, 'recall': 0.5585207021803015, 'f1-score': 0.4236595117981048, 'support': 645874}, '2': {'precision': 0.36497057536392113, 'recall': 0.38202157459266994, 'f1-score': 0.37330147013893034, 'support': 663651}, 'accuracy': 0.3546240632045007, 'macro avg': {'precision': 0.3642426233615769, 'recall': 0.3560230512018276, 'f1-score': 0.3295791029899607, 'support': 1969480}, 'weighted avg': {'precision': 0.3644083153406187, 'recall': 0.3546240632045007, 'f1-score': 0.3289885164557258, 'support': 1969480}}
[[ 84162 349166 226627]
 [ 70640 360734 214500]
 [ 62953 347169 253529]]
Evaluating performance on  val set...
2338/2338 - 108s - 108s/epoch - 46ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933516
{'0': {'precision': 0.39369032672486787, 'recall': 0.13471779551789942, 'f1-score': 0.20074291329204383, 'support': 200174}, '1': {'precision': 0.3470088937431737, 'recall': 0.5567884235034924, 'f1-score': 0.4275527957475032, 'support': 199715}, '2': {'precision': 0.3586231995096537, 'recall': 0.3784507632989878, 'f1-score': 0.3682702969834506, 'support': 197891}, 'accuracy': 0.35641540366020946, 'macro avg': {'precision': 0.36644080665923173, 'recall': 0.35665232744012654, 'f1-score': 0.33218866867433255, 'support': 597780}, 'weighted avg': {'precision': 0.36648558374302664, 'recall': 0.35641540366020946, 'f1-score': 0.33197764372910804, 'support': 597780}}
[[ 26967 105048  68159]
 [ 22735 111199  65781]
 [ 18796 104203  74892]]
testing model out of sample: results/universal/W8/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14128/14128 - 660s - 660s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0835818
{'0': {'precision': 0.38896172480482966, 'recall': 0.11948151582338763, 'f1-score': 0.18280796267264302, 'support': 1149659}, '1': {'precision': 0.3788601924375654, 'recall': 0.7168966623508181, 'f1-score': 0.4957369990781986, 'support': 1306039}, '2': {'precision': 0.38615391999110843, 'recall': 0.2634426020452125, 'f1-score': 0.3132079376087805, 'support': 1160564}, 'accuracy': 0.3814436011550048, 'macro avg': {'precision': 0.3846586124111678, 'recall': 0.36660692673980605, 'f1-score': 0.33058429978654075, 'support': 3616262}, 'weighted avg': {'precision': 0.38441237732468553, 'recall': 0.3814436011550048, 'f1-score': 0.3376736892958409, 'support': 3616262}}
[[137363 779647 232649]
 [116373 936295 253371]
 [ 99417 755405 305742]]
Evaluating performance on  train set...
4550/4550 - 211s - 211s/epoch - 46ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0851464
{'0': {'precision': 0.39454866513978004, 'recall': 0.1169850444519323, 'f1-score': 0.1804623713524882, 'support': 385810}, '1': {'precision': 0.3631962577563652, 'recall': 0.7079185777643001, 'f1-score': 0.480085551452978, 'support': 395715}, '2': {'precision': 0.3950476737713455, 'recall': 0.28749483830163136, 'f1-score': 0.33279734253442467, 'support': 382626}, 'accuracy': 0.37389565442970885, 'macro avg': {'precision': 0.3842641988891636, 'recall': 0.3707994868392879, 'f1-score': 0.3311150884466303, 'support': 1164151}, 'weighted avg': {'precision': 0.38405545230822585, 'recall': 0.37389565442970885, 'f1-score': 0.3323779797202385, 'support': 1164151}}
[[ 45134 250936  89740]
 [ 36869 280134  78712]
 [ 32391 240232 110003]]
Evaluating performance on  val set...
1570/1570 - 74s - 74s/epoch - 47ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0856583
{'0': {'precision': 0.3834068570544076, 'recall': 0.11347810152098223, 'f1-score': 0.17512416706435477, 'support': 130968}, '1': {'precision': 0.3740220814204955, 'recall': 0.7068663865425707, 'f1-score': 0.4891968875920522, 'support': 139462}, '2': {'precision': 0.3957548125633232, 'recall': 0.29908195064431903, 'f1-score': 0.3406933184476435, 'support': 130603}, 'accuracy': 0.38027793223999024, 'macro avg': {'precision': 0.38439458367940876, 'recall': 0.3731421462359574, 'f1-score': 0.33500479103468345, 'support': 401033}, 'weighted avg': {'precision': 0.3841645514433338, 'recall': 0.38027793223999024, 'f1-score': 0.3382654487752, 'support': 401033}}
[[14862 84591 31515]
 [12757 98581 28124]
 [11144 80398 39061]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
645/645 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011643
{'0': {'precision': 0.3551424579308669, 'recall': 0.10624261699227623, 'f1-score': 0.16355650057353888, 'support': 55025}, '1': {'precision': 0.33640921876215996, 'recall': 0.5542144400893806, 'f1-score': 0.41867930402296866, 'support': 54598}, '2': {'precision': 0.3568767516576663, 'recall': 0.37762427442541724, 'f1-score': 0.36695748438282505, 'support': 55301}, 'accuracy': 0.3455409764497587, 'macro avg': {'precision': 0.34947614278356437, 'recall': 0.346027110502358, 'f1-score': 0.31639776299311084, 'support': 164924}, 'weighted avg': {'precision': 0.34952235888677796, 'recall': 0.3455409764497587, 'f1-score': 0.31621756038514487, 'support': 164924}}
[[ 5846 30506 18673]
 [ 5379 30259 18960]
 [ 5236 29182 20883]]
Evaluating performance on  train set...
224/224 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993328
{'0': {'precision': 0.37129596572652623, 'recall': 0.10876385693369588, 'f1-score': 0.1682439537329127, 'support': 19124}, '1': {'precision': 0.34660176227740463, 'recall': 0.5971337579617835, 'f1-score': 0.43861359117314513, 'support': 18840}, '2': {'precision': 0.3658217241018121, 'recall': 0.36399166232412716, 'f1-score': 0.36490439870441954, 'support': 19190}, 'accuracy': 0.35544318857822726, 'macro avg': {'precision': 0.36123981736858096, 'recall': 0.35662975907320216, 'f1-score': 0.3239206478701591, 'support': 57154}, 'weighted avg': {'precision': 0.361317845389197, 'recall': 0.35544318857822726, 'f1-score': 0.32339806207838623, 'support': 57154}}
[[ 2080 10737  6307]
 [ 1788 11250  5802]
 [ 1734 10471  6985]]
Evaluating performance on  val set...
68/68 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1071182
{'0': {'precision': 0.3646322378716745, 'recall': 0.11395500489077275, 'f1-score': 0.1736430257110918, 'support': 6134}, '1': {'precision': 0.30912025827280065, 'recall': 0.5838414634146342, 'f1-score': 0.40422163588390503, 'support': 5248}, '2': {'precision': 0.36519970414201186, 'recall': 0.3373185311699402, 'f1-score': 0.350705851016603, 'support': 5855}, 'accuracy': 0.3328885536926379, 'macro avg': {'precision': 0.34631740009549566, 'recall': 0.345038333158449, 'f1-score': 0.3095235042038666, 'support': 17237}, 'weighted avg': {'precision': 0.34792374138608745, 'recall': 0.3328885536926379, 'f1-score': 0.30398933819880386, 'support': 17237}}
[[ 699 3602 1833]
 [ 584 3064 1600]
 [ 634 3246 1975]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
2179/2179 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0860506
{'0': {'precision': 0.46483076593159156, 'recall': 0.13569516972981996, 'f1-score': 0.21006682953421224, 'support': 191687}, '1': {'precision': 0.3454449906392669, 'recall': 0.8479556680695078, 'f1-score': 0.49090309391268094, 'support': 186051}, '2': {'precision': 0.48875396104327784, 'recall': 0.12250474889192521, 'f1-score': 0.1959061860202781, 'support': 180042}, 'accuracy': 0.36901645810176054, 'macro avg': {'precision': 0.4330099058713788, 'recall': 0.3687185288970844, 'f1-score': 0.29895870315572376, 'support': 557780}, 'weighted avg': {'precision': 0.43273090042079143, 'recall': 0.36901645810176054, 'f1-score': 0.29917070067398555, 'support': 557780}}
[[ 26011 152238  13438]
 [ 18655 157763   9633]
 [ 11292 146694  22056]]
Evaluating performance on  train set...
614/614 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964224
{'0': {'precision': 0.4485696895922094, 'recall': 0.13506579188505663, 'f1-score': 0.20761733055383402, 'support': 54566}, '1': {'precision': 0.33626097867001253, 'recall': 0.8355873299573031, 'f1-score': 0.4795422944541952, 'support': 50355}, '2': {'precision': 0.4480937660999485, 'recall': 0.13338189625426522, 'f1-score': 0.20557213342393713, 'support': 52166}, 'accuracy': 0.359062175737012, 'macro avg': {'precision': 0.4109748114540568, 'recall': 0.36801167269887497, 'f1-score': 0.29757725281065545, 'support': 157087}, 'weighted avg': {'precision': 0.41241054107333447, 'recall': 0.359062175737012, 'f1-score': 0.2941050208383546, 'support': 157087}}
[[ 7370 41797  5399]
 [ 5108 42076  3171]
 [ 3952 41256  6958]]
Evaluating performance on  val set...
190/190 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.082243
{'0': {'precision': 0.4538420960084403, 'recall': 0.1586940482046237, 'f1-score': 0.23516012937907155, 'support': 16264}, '1': {'precision': 0.3543094496365524, 'recall': 0.8147086914995224, 'f1-score': 0.4938486032710957, 'support': 16752}, '2': {'precision': 0.49391224442912934, 'recall': 0.1383170355120947, 'f1-score': 0.2161129818565613, 'support': 15544}, 'accuracy': 0.37848023064250413, 'macro avg': {'precision': 0.4340212633580407, 'recall': 0.3705732584054136, 'f1-score': 0.31504057150224285, 'support': 48560}, 'weighted avg': {'precision': 0.4323322009307905, 'recall': 0.37848023064250413, 'f1-score': 0.3183042902841228, 'support': 48560}}
[[ 2581 12561  1122]
 [ 2023 13648  1081]
 [ 1083 12311  2150]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
1162/1162 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0635471
{'0': {'precision': 0.32470545586369404, 'recall': 0.11484363981382945, 'f1-score': 0.16967550057777187, 'support': 77993}, '1': {'precision': 0.49938173105044154, 'recall': 0.712599664672763, 'f1-score': 0.5872355060003258, 'support': 136583}, '2': {'precision': 0.34418970645113967, 'recall': 0.31135159916512845, 'f1-score': 0.32694817123383124, 'support': 82887}, 'accuracy': 0.44406531232455804, 'macro avg': {'precision': 0.3894256311217584, 'recall': 0.3795983012172403, 'f1-score': 0.3612863926039764, 'support': 297463}, 'weighted avg': {'precision': 0.4103389658204723, 'recall': 0.44406531232455804, 'f1-score': 0.4052256633654042, 'support': 297463}}
[[ 8957 48318 20718]
 [10800 97329 28454]
 [ 7828 49252 25807]]
Evaluating performance on  train set...
327/327 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097608
{'0': {'precision': 0.3686036426712923, 'recall': 0.103162493931618, 'f1-score': 0.16120729361402367, 'support': 28838}, '1': {'precision': 0.3493288256935468, 'recall': 0.6507130950175959, 'f1-score': 0.4546066252587992, 'support': 26995}, '2': {'precision': 0.365971616586062, 'recall': 0.33269667375400913, 'f1-score': 0.3485417649834827, 'support': 27749}, 'accuracy': 0.3562130602282788, 'macro avg': {'precision': 0.3613013616503004, 'recall': 0.36219075423440766, 'f1-score': 0.32145189461876855, 'support': 83582}, 'weighted avg': {'precision': 0.3615045091718152, 'recall': 0.3562130602282788, 'f1-score': 0.3181628486830796, 'support': 83582}}
[[ 2975 16708  9155]
 [ 2590 17566  6839]
 [ 2506 16011  9232]]
Evaluating performance on  val set...
125/125 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0839967
{'0': {'precision': 0.3498532768177372, 'recall': 0.10631130486475775, 'f1-score': 0.16306990881458966, 'support': 10093}, '1': {'precision': 0.39698294924082356, 'recall': 0.6991173416407062, 'f1-score': 0.5064092518883003, 'support': 11556}, '2': {'precision': 0.3845235251970385, 'recall': 0.31746031746031744, 'f1-score': 0.34778851865853, 'support': 10143}, 'accuracy': 0.38915450427780574, 'macro avg': {'precision': 0.37711991708519976, 'recall': 0.3742963213219271, 'f1-score': 0.3390892264538066, 'support': 31792}, 'weighted avg': {'precision': 0.37804561526239117, 'recall': 0.38915450427780574, 'f1-score': 0.34680261855939615, 'support': 31792}}
[[1073 6288 2732]
 [1055 8079 2422]
 [ 939 5984 3220]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1223/1223 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028663
{'0': {'precision': 0.3230252390386769, 'recall': 0.07319286808693361, 'f1-score': 0.11934408490933827, 'support': 102469}, '1': {'precision': 0.3577851800334322, 'recall': 0.2586623619491196, 'f1-score': 0.30025445292620867, 'support': 113364}, '2': {'precision': 0.309100443572054, 'recall': 0.6609979423868313, 'f1-score': 0.4212248162644481, 'support': 97200}, 'accuracy': 0.3228796963898375, 'macro avg': {'precision': 0.3299702875480544, 'recall': 0.3309510574742948, 'f1-score': 0.280274451366665, 'support': 313033}, 'weighted avg': {'precision': 0.3312896579068911, 'recall': 0.3228796963898375, 'f1-score': 0.2785973586778584, 'support': 313033}}
[[ 7500 26999 67970]
 [ 8402 29323 75639]
 [ 7316 25635 64249]]
Evaluating performance on  train set...
358/358 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1014699
{'0': {'precision': 0.33289703315881325, 'recall': 0.07578968280246341, 'f1-score': 0.12346944279626733, 'support': 30202}, '1': {'precision': 0.32738675367600323, 'recall': 0.2551097903252435, 'f1-score': 0.28676416004750943, 'support': 30285}, '2': {'precision': 0.3378019165135206, 'recall': 0.6655567050303892, 'f1-score': 0.44814750315642815, 'support': 30932}, 'accuracy': 0.3347444185563176, 'macro avg': {'precision': 0.33269523444944565, 'recall': 0.33215205938603204, 'f1-score': 0.2861270353334016, 'support': 91419}, 'weighted avg': {'precision': 0.33273119277323593, 'recall': 0.3347444185563176, 'f1-score': 0.28742138139780926, 'support': 91419}}
[[ 2289  7877 20036]
 [ 2238  7726 20321]
 [ 2349  7996 20587]]
Evaluating performance on  val set...
99/99 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023288
{'0': {'precision': 0.3240284619594964, 'recall': 0.06983602689630766, 'f1-score': 0.11490683229813667, 'support': 8477}, '1': {'precision': 0.3458739742994272, 'recall': 0.257848568790397, 'f1-score': 0.29544402565628514, 'support': 8664}, '2': {'precision': 0.31993872260193257, 'recall': 0.6689663668843169, 'f1-score': 0.4328590218820997, 'support': 8117}, 'accuracy': 0.3268667352917887, 'macro avg': {'precision': 0.32994705295361876, 'recall': 0.33221698752367385, 'f1-score': 0.28106995994550715, 'support': 25258}, 'weighted avg': {'precision': 0.330207617258721, 'recall': 0.3268667352917887, 'f1-score': 0.2790129438710255, 'support': 25258}}
[[ 592 2142 5743]
 [ 631 2234 5799]
 [ 604 2083 5430]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
1443/1443 - 28s - 28s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988389
{'0': {'precision': 0.350812189555645, 'recall': 0.10747186944791735, 'f1-score': 0.16453743522582026, 'support': 121576}, '1': {'precision': 0.3568857408267534, 'recall': 0.6041772462937177, 'f1-score': 0.44871615497387296, 'support': 122090}, '2': {'precision': 0.36924170086384467, 'recall': 0.36845627424893046, 'f1-score': 0.36884856943475225, 'support': 125521}, 'accuracy': 0.36046502179112483, 'macro avg': {'precision': 0.35897987708208107, 'recall': 0.36003512999685516, 'f1-score': 0.3273673865448152, 'support': 369187}, 'weighted avg': {'precision': 0.35908661569634376, 'recall': 0.36046502179112483, 'f1-score': 0.32797958722759474, 'support': 369187}}
[[13066 65629 42881]
 [12202 73764 36124]
 [11977 67295 46249]]
Evaluating performance on  train set...
494/494 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952963
{'0': {'precision': 0.35061073609771776, 'recall': 0.1053050782004248, 'f1-score': 0.16196451109956198, 'support': 41432}, '1': {'precision': 0.3594672714951526, 'recall': 0.6248978218012213, 'f1-score': 0.4563963441936419, 'support': 41594}, '2': {'precision': 0.3794564406249248, 'recall': 0.36432764757546343, 'f1-score': 0.3717381819896942, 'support': 43266}, 'accuracy': 0.3651696069426409, 'macro avg': {'precision': 0.3631781494059317, 'recall': 0.36484351585903657, 'f1-score': 0.33003301242763267, 'support': 126292}, 'weighted avg': {'precision': 0.36340978105222826, 'recall': 0.3651696069426409, 'f1-score': 0.33080074229748124, 'support': 126292}}
[[ 4363 22895 14174]
 [ 3998 25992 11604]
 [ 4083 23420 15763]]
Evaluating performance on  val set...
150/150 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017745
{'0': {'precision': 0.3529919447640967, 'recall': 0.09637891760270206, 'f1-score': 0.15141605479113965, 'support': 12731}, '1': {'precision': 0.3412534435261708, 'recall': 0.6405946994182288, 'f1-score': 0.445293192541002, 'support': 12376}, '2': {'precision': 0.3786713286713287, 'recall': 0.33218311479181045, 'f1-score': 0.35390711163759647, 'support': 13041}, 'accuracy': 0.3535440914333648, 'macro avg': {'precision': 0.35763890565386536, 'recall': 0.35638557727091374, 'f1-score': 0.3168721196565794, 'support': 38148}, 'weighted avg': {'precision': 0.35796230111865374, 'recall': 0.3535440914333648, 'f1-score': 0.31597800637777435, 'support': 38148}}
[[1227 7688 3816]
 [1156 7928 3292]
 [1093 7616 4332]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
5521/5521 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0722538
{'0': {'precision': 0.5210444166724774, 'recall': 0.20239811650970915, 'f1-score': 0.29154605574138015, 'support': 479960}, '1': {'precision': 0.33766055195031425, 'recall': 0.7925707531740251, 'f1-score': 0.4735665642299231, 'support': 458566}, '2': {'precision': 0.5037739359228204, 'recall': 0.1596957774482712, 'f1-score': 0.24251467319163908, 'support': 474784}, 'accuracy': 0.3795416433761878, 'macro avg': {'precision': 0.45415963484853733, 'recall': 0.3848882157106685, 'f1-score': 0.3358757643876474, 'support': 1413310}, 'weighted avg': {'precision': 0.45574143767818126, 'recall': 0.3795416433761878, 'f1-score': 0.3341333865909892, 'support': 1413310}}
[[ 97143 348056  34761]
 [ 55196 363446  39924]
 [ 34100 364863  75821]]
Evaluating performance on  train set...
1289/1289 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0796283
{'0': {'precision': 0.4778365967217297, 'recall': 0.20318757514667726, 'f1-score': 0.2851307293186345, 'support': 110617}, '1': {'precision': 0.3463598901098901, 'recall': 0.7856795916310015, 'f1-score': 0.4807745690996727, 'support': 109117}, '2': {'precision': 0.4916555312313422, 'recall': 0.15721480781119312, 'f1-score': 0.23824645757703092, 'support': 109996}, 'accuracy': 0.3806144421193097, 'macro avg': {'precision': 0.4386173393543207, 'recall': 0.3820273248629573, 'f1-score': 0.33471725199844604, 'support': 329730}, 'weighted avg': {'precision': 0.4389371448215545, 'recall': 0.3806144421193097, 'f1-score': 0.3342345006190867, 'support': 329730}}
[[22476 78880  9261]
 [14767 85731  8619]
 [ 9794 82909 17293]]
Evaluating performance on  val set...
438/438 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0804968
{'0': {'precision': 0.46485554118154376, 'recall': 0.23124983240822675, 'f1-score': 0.3088548661473722, 'support': 37293}, '1': {'precision': 0.35080418535127056, 'recall': 0.7688436943075794, 'f1-score': 0.48178287253348223, 'support': 38156}, '2': {'precision': 0.5031221209949841, 'recall': 0.1346686028988684, 'f1-score': 0.21246703842994855, 'support': 36497}, 'accuracy': 0.38299715934468403, 'macro avg': {'precision': 0.4395939491759328, 'recall': 0.37825404320489153, 'f1-score': 0.33436825903693435, 'support': 111946}, 'weighted avg': {'precision': 0.4384577407276751, 'recall': 0.38299715934468403, 'f1-score': 0.3363714765083105, 'support': 111946}}
[[ 8624 26441  2228]
 [ 6194 29336  2626]
 [ 3734 27848  4915]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
5918/5918 - 106s - 106s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0756351
{'0': {'precision': 0.4334675749934134, 'recall': 0.11969884051102325, 'f1-score': 0.18759478041891517, 'support': 481074}, '1': {'precision': 0.38109051500150426, 'recall': 0.8011621722631095, 'f1-score': 0.5164975442498378, 'support': 556544}, '2': {'precision': 0.4316440958392058, 'recall': 0.1918180104317225, 'f1-score': 0.26560431129874107, 'support': 477390}, 'accuracy': 0.39276228244339306, 'macro avg': {'precision': 0.4154007286113745, 'recall': 0.37089300773528505, 'f1-score': 0.3232322119891647, 'support': 1515008}, 'weighted avg': {'precision': 0.4136520696036305, 'recall': 0.39276228244339306, 'f1-score': 0.3329998408147924, 'support': 1515008}}
[[ 57584 372661  50829]
 [ 40916 445882  69746]
 [ 34345 351473  91572]]
Evaluating performance on  train set...
1814/1814 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.071214
{'0': {'precision': 0.431363401998576, 'recall': 0.11833207608168543, 'f1-score': 0.18571783447233367, 'support': 148472}, '1': {'precision': 0.384339633047229, 'recall': 0.7987621328475167, 'f1-score': 0.5189679432157122, 'support': 165769}, '2': {'precision': 0.44245100396017056, 'recall': 0.23307428784707873, 'f1-score': 0.30531485321401286, 'support': 150038}, 'accuracy': 0.39835745316932275, 'macro avg': {'precision': 0.4193846796686585, 'recall': 0.38338949892542695, 'f1-score': 0.3366668769673529, 'support': 464279}, 'weighted avg': {'precision': 0.41815685694230137, 'recall': 0.39835745316932275, 'f1-score': 0.3433528659388553, 'support': 464279}}
[[ 17569 107439  23464]
 [ 12756 132410  20603]
 [ 10404 104664  34970]]
Evaluating performance on  val set...
636/636 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0687125
{'0': {'precision': 0.4039122793611981, 'recall': 0.1074302902203073, 'f1-score': 0.1697195421489461, 'support': 49204}, '1': {'precision': 0.4209341359887671, 'recall': 0.8008566954278872, 'f1-score': 0.551825914014895, 'support': 65134}, '2': {'precision': 0.40761482518570374, 'recall': 0.2166211970899471, 'f1-score': 0.2828994426225083, 'support': 48384}, 'accuracy': 0.41746045402588466, 'macro avg': {'precision': 0.41082041351188964, 'recall': 0.3749693942460472, 'f1-score': 0.3348149662621165, 'support': 162722}, 'weighted avg': {'precision': 0.4118266706958238, 'recall': 0.41746045402588466, 'f1-score': 0.35632130914805843, 'support': 162722}}
[[ 5286 37032  6886]
 [ 4625 52163  8346]
 [ 3176 34727 10481]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
3755/3755 - 69s - 69s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0797336
{'0': {'precision': 0.32340921846499227, 'recall': 0.1268431099417015, 'f1-score': 0.18221885136754312, 'support': 290745}, '1': {'precision': 0.42841360948791535, 'recall': 0.6326669730392157, 'f1-score': 0.510881352437893, 'support': 391680}, '2': {'precision': 0.3438043102068765, 'recall': 0.3314366896512137, 'f1-score': 0.337507238117158, 'support': 278738}, 'accuracy': 0.3923018260170231, 'macro avg': {'precision': 0.3652090460532613, 'recall': 0.3636489242107103, 'f1-score': 0.343535813974198, 'support': 961163}, 'weighted avg': {'precision': 0.3721137638519951, 'recall': 0.3923018260170231, 'f1-score': 0.3611846488077783, 'support': 961163}}
[[ 36879 173059  80807]
 [ 48357 247803  95520]
 [ 28796 157558  92384]]
Evaluating performance on  train set...
1532/1532 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963366
{'0': {'precision': 0.3628243109794416, 'recall': 0.1243222874193474, 'f1-score': 0.18518921581542938, 'support': 130033}, '1': {'precision': 0.3490865009957572, 'recall': 0.6192173004853474, 'f1-score': 0.44647227544048107, 'support': 130216}, '2': {'precision': 0.37394659008101505, 'recall': 0.3306172876936604, 'f1-score': 0.3509496051525282, 'support': 131932}, 'accuracy': 0.3580413125572121, 'macro avg': {'precision': 0.3619524673520713, 'recall': 0.35805229186611837, 'f1-score': 0.3275370321361462, 'support': 392181}, 'weighted avg': {'precision': 0.3620045411833356, 'recall': 0.3580413125572121, 'f1-score': 0.3277058970879996, 'support': 392181}}
[[16166 75562 38305]
 [14863 80632 34721]
 [13527 74786 43619]]
Evaluating performance on  val set...
467/467 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0904313
{'0': {'precision': 0.34444105536068326, 'recall': 0.1211934211585415, 'f1-score': 0.17929939466110947, 'support': 37271}, '1': {'precision': 0.38385660334817656, 'recall': 0.6229988107218004, 'f1-score': 0.4750279017857143, 'support': 43724}, '2': {'precision': 0.3648491715054525, 'recall': 0.3355475669480046, 'f1-score': 0.3495854423079533, 'support': 38388}, 'accuracy': 0.3739058324887128, 'macro avg': {'precision': 0.36438227673810414, 'recall': 0.35991326627611553, 'f1-score': 0.3346375795849257, 'support': 119383}, 'weighted avg': {'precision': 0.3654392894708209, 'recall': 0.3739058324887128, 'f1-score': 0.34236594553169625, 'support': 119383}}
[[ 4517 22081 10673]
 [ 4733 27240 11751]
 [ 3864 21643 12881]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
4960/4960 - 90s - 90s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910708
{'0': {'precision': 0.37319042215653253, 'recall': 0.12472493363382296, 'f1-score': 0.18696410984299866, 'support': 413991}, '1': {'precision': 0.3570584155801206, 'recall': 0.6633014231220657, 'f1-score': 0.46422320089203345, 'support': 436224}, '2': {'precision': 0.37716737341604534, 'recall': 0.28858903603399566, 'f1-score': 0.32698556761180847, 'support': 419465}, 'accuracy': 0.36389956524478606, 'macro avg': {'precision': 0.36913873705089956, 'recall': 0.3588717975966282, 'f1-score': 0.32605762611561356, 'support': 1269680}, 'weighted avg': {'precision': 0.36896181606939465, 'recall': 0.36389956524478606, 'f1-score': 0.3284810042705457, 'support': 1269680}}
[[ 51635 262310 100046]
 [ 47022 289348  99854]
 [ 39704 258708 121053]]
Evaluating performance on  train set...
1691/1691 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927346
{'0': {'precision': 0.3868371710872817, 'recall': 0.12411452982209485, 'f1-score': 0.18793210208227787, 'support': 147944}, '1': {'precision': 0.3421232725506645, 'recall': 0.6524484798304764, 'f1-score': 0.4488722076730911, 'support': 142517}, '2': {'precision': 0.378108795746067, 'recall': 0.3016441569569401, 'f1-score': 0.33557576609941714, 'support': 142383}, 'accuracy': 0.3564702294591123, 'macro avg': {'precision': 0.369023079794671, 'recall': 0.35940238886983705, 'f1-score': 0.3241266919515953, 'support': 432844}, 'weighted avg': {'precision': 0.3692436201914595, 'recall': 0.3564702294591123, 'f1-score': 0.32241553916870686, 'support': 432844}}
[[18362 92853 36729]
 [15621 92985 33911]
 [13484 85950 42949]]
Evaluating performance on  val set...
591/591 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973468
{'0': {'precision': 0.3790024087891428, 'recall': 0.12216414801348331, 'f1-score': 0.1847709338794449, 'support': 52806}, '1': {'precision': 0.3164973033031643, 'recall': 0.6056968193496943, 'f1-score': 0.4157506651463322, 'support': 45148}, '2': {'precision': 0.39783278489237284, 'recall': 0.3569198946972546, 'f1-score': 0.3762674569584998, 'support': 53180}, 'accuracy': 0.34921328092950626, 'macro avg': {'precision': 0.36444416566155996, 'recall': 0.3615936206868107, 'f1-score': 0.32559635199475895, 'support': 151134}, 'weighted avg': {'precision': 0.366956270254391, 'recall': 0.34921328092950626, 'f1-score': 0.3211536009469582, 'support': 151134}}
[[ 6451 30036 16319]
 [ 5391 27346 12411]
 [ 5179 29020 18981]]
testing model on single stock: results/universal/W8/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
10609/10609 - 186s - 186s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003995
{'0': {'precision': 0.38552318722207096, 'recall': 0.10499196757371296, 'f1-score': 0.16503807303807305, 'support': 1011525}, '1': {'precision': 0.2706771788843239, 'recall': 0.43807314410480347, 'f1-score': 0.33460698061112026, 'support': 696160}, '2': {'precision': 0.38918157193125635, 'recall': 0.5071413903017569, 'f1-score': 0.4403994805116486, 'support': 1007997}, 'accuracy': 0.33964506889981966, 'macro avg': {'precision': 0.3484606460125504, 'recall': 0.3500688339934244, 'f1-score': 0.313348178053614, 'support': 2715682}, 'weighted avg': {'precision': 0.35744053382130414, 'recall': 0.33964506889981966, 'f1-score': 0.3107143942513794, 'support': 2715682}}
[[106202 422247 483076]
 [ 71946 304969 319245]
 [ 97327 399473 511197]]
Evaluating performance on  train set...
3903/3903 - 68s - 68s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991436
{'0': {'precision': 0.3486469661303815, 'recall': 0.10714210984136284, 'f1-score': 0.16391253546987145, 'support': 334537}, '1': {'precision': 0.337375918442536, 'recall': 0.44395077032595787, 'f1-score': 0.3833948104807937, 'support': 325901}, '2': {'precision': 0.35322610321647563, 'recall': 0.48755998523440386, 'f1-score': 0.40966166313702573, 'support': 338625}, 'accuracy': 0.3459511562333907, 'macro avg': {'precision': 0.34641632926313104, 'recall': 0.34621762180057486, 'f1-score': 0.318989669695897, 'support': 999063}, 'weighted avg': {'precision': 0.3465223399389022, 'recall': 0.3459511562333907, 'f1-score': 0.3188039599992802, 'support': 999063}}
[[ 35843 143934 154760]
 [ 33671 144684 147546]
 [ 33292 140233 165100]]
Evaluating performance on  val set...
1144/1144 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004416
{'0': {'precision': 0.36430334613274823, 'recall': 0.10534455581001101, 'f1-score': 0.16343040826841593, 'support': 100869}, '1': {'precision': 0.32152281062781085, 'recall': 0.4192644369664247, 'f1-score': 0.36394546641431813, 'support': 92419}, '2': {'precision': 0.34709096123846633, 'recall': 0.4994413407821229, 'f1-score': 0.40955690560306396, 'support': 99345}, 'accuracy': 0.3382769544104732, 'macro avg': {'precision': 0.3443057059996751, 'recall': 0.34135011118618613, 'f1-score': 0.3123109267619327, 'support': 292633}, 'weighted avg': {'precision': 0.3449490740986535, 'recall': 0.3382769544104732, 'f1-score': 0.3103134940328265, 'support': 292633}}
[[10626 41527 48716]
 [ 9053 38748 44618]
 [ 9489 40239 49617]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        67 (peak)  14.61 (ave)

============================================
