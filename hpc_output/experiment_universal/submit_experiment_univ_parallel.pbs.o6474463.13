This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W4/deepLOB_L1/h50
Epoch 1/50
9854/9854 - 170s - loss: 3.0312 - accuracy50: 0.4771 - val_loss: 3.7682 - val_accuracy50: 0.4225 - 170s/epoch - 17ms/step
Epoch 2/50
9854/9854 - 149s - loss: 2.9505 - accuracy50: 0.5036 - val_loss: 3.6405 - val_accuracy50: 0.4328 - 149s/epoch - 15ms/step
Epoch 3/50
9854/9854 - 152s - loss: 2.9189 - accuracy50: 0.5118 - val_loss: 3.7032 - val_accuracy50: 0.4264 - 152s/epoch - 15ms/step
Epoch 4/50
9854/9854 - 150s - loss: 2.9037 - accuracy50: 0.5148 - val_loss: 3.6916 - val_accuracy50: 0.4259 - 150s/epoch - 15ms/step
Epoch 5/50
9854/9854 - 151s - loss: 2.8937 - accuracy50: 0.5168 - val_loss: 3.7584 - val_accuracy50: 0.4264 - 151s/epoch - 15ms/step
Epoch 6/50
9854/9854 - 153s - loss: 2.8868 - accuracy50: 0.5183 - val_loss: 3.7636 - val_accuracy50: 0.4242 - 153s/epoch - 16ms/step
Epoch 7/50
9854/9854 - 153s - loss: 2.8812 - accuracy50: 0.5195 - val_loss: 3.7488 - val_accuracy50: 0.4255 - 153s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 150s - loss: 2.8768 - accuracy50: 0.5208 - val_loss: 3.7447 - val_accuracy50: 0.4261 - 150s/epoch - 15ms/step
Epoch 9/50
9854/9854 - 148s - loss: 2.8729 - accuracy50: 0.5216 - val_loss: 3.6423 - val_accuracy50: 0.4293 - 148s/epoch - 15ms/step
Epoch 10/50
9854/9854 - 153s - loss: 2.8699 - accuracy50: 0.5220 - val_loss: 3.6176 - val_accuracy50: 0.4293 - 153s/epoch - 15ms/step
Epoch 11/50
9854/9854 - 152s - loss: 2.8670 - accuracy50: 0.5228 - val_loss: 3.6184 - val_accuracy50: 0.4297 - 152s/epoch - 15ms/step
Epoch 12/50
9854/9854 - 151s - loss: 2.8644 - accuracy50: 0.5233 - val_loss: 3.6298 - val_accuracy50: 0.4278 - 151s/epoch - 15ms/step
Epoch 13/50
9854/9854 - 151s - loss: 2.8623 - accuracy50: 0.5237 - val_loss: 3.6463 - val_accuracy50: 0.4286 - 151s/epoch - 15ms/step
Epoch 14/50
9854/9854 - 152s - loss: 2.8600 - accuracy50: 0.5244 - val_loss: 3.6334 - val_accuracy50: 0.4277 - 152s/epoch - 15ms/step
Epoch 15/50
9854/9854 - 152s - loss: 2.8577 - accuracy50: 0.5248 - val_loss: 3.6278 - val_accuracy50: 0.4267 - 152s/epoch - 15ms/step
Epoch 16/50
9854/9854 - 152s - loss: 2.8562 - accuracy50: 0.5252 - val_loss: 3.6345 - val_accuracy50: 0.4269 - 152s/epoch - 15ms/step
Epoch 17/50
9854/9854 - 152s - loss: 2.8544 - accuracy50: 0.5258 - val_loss: 3.6561 - val_accuracy50: 0.4265 - 152s/epoch - 15ms/step
Epoch 18/50
9854/9854 - 154s - loss: 2.8525 - accuracy50: 0.5261 - val_loss: 3.6422 - val_accuracy50: 0.4291 - 154s/epoch - 16ms/step
Epoch 19/50
9854/9854 - 153s - loss: 2.8512 - accuracy50: 0.5264 - val_loss: 3.6486 - val_accuracy50: 0.4288 - 153s/epoch - 15ms/step
Epoch 20/50
9854/9854 - 151s - loss: 2.8499 - accuracy50: 0.5267 - val_loss: 3.6638 - val_accuracy50: 0.4294 - 151s/epoch - 15ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0914999
{'0': {'precision': 0.462512449418795, 'recall': 0.12457027806088952, 'f1-score': 0.19627661225211612, 'support': 1599290}, '1': {'precision': 0.4878526539213983, 'recall': 0.9012047444662197, 'f1-score': 0.6330265787788772, 'support': 2866666}, '2': {'precision': 0.43555112820275216, 'recall': 0.09367275444906348, 'f1-score': 0.1541853087873263, 'support': 1605675}, 'accuracy': 0.4830802464774292, 'macro avg': {'precision': 0.4619720771809818, 'recall': 0.37314925899205753, 'f1-score': 0.3278294999394399, 'support': 6071631}, 'weighted avg': {'precision': 0.467346534895513, 'recall': 0.4830802464774292, 'f1-score': 0.39135291478970086, 'support': 6071631}}
[[ 199224 1333127   66939]
 [ 155232 2583453  127981]
 [  76287 1378980  150408]]
Evaluating performance on  train set...
9854/9854 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1727219
{'0': {'precision': 0.518692548657115, 'recall': 0.10447608740905664, 'f1-score': 0.17392071717220633, 'support': 773421}, '1': {'precision': 0.40457132857679867, 'recall': 0.8951274647678142, 'f1-score': 0.5572720533728688, 'support': 976309}, '2': {'precision': 0.49222536495907704, 'recall': 0.13137180511440666, 'f1-score': 0.2073920082419604, 'support': 772289}, 'accuracy': 0.4187843152648731, 'macro avg': {'precision': 0.4718297473976636, 'recall': 0.3769917857637592, 'f1-score': 0.3128615929290119, 'support': 2522019}, 'weighted avg': {'precision': 0.4664098778737594, 'recall': 0.4187843152648731, 'f1-score': 0.3325709373345849, 'support': 2522019}}
[[ 80804 647583  45034]
 [ 42760 873921  59628]
 [ 32220 638612 101457]]
Evaluating performance on  val set...
3566/3566 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1555829
{'0': {'precision': 0.5342379014020805, 'recall': 0.08605252613557716, 'f1-score': 0.14822901960784313, 'support': 274530}, '1': {'precision': 0.4169257625683032, 'recall': 0.884620020820777, 'f1-score': 0.5667428398923043, 'support': 365020}, '2': {'precision': 0.4805540130707787, 'recall': 0.16495846804642195, 'f1-score': 0.24560781124640468, 'support': 272802}, 'accuracy': 0.4291424800954018, 'macro avg': {'precision': 0.4772392256803875, 'recall': 0.378543671667592, 'f1-score': 0.32019322358218405, 'support': 912352}, 'weighted avg': {'precision': 0.471250864576753, 'recall': 0.4291424800954018, 'f1-score': 0.3447880711546331, 'support': 912352}}
[[ 23624 231372  19534]
 [ 13007 322904  29109]
 [  7589 220212  45001]]
testing model out of sample: results/universal/W4/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1596929
{'0': {'precision': 0.4761429658841187, 'recall': 0.11565592992828827, 'f1-score': 0.18610632053493087, 'support': 957305}, '1': {'precision': 0.3917835719122233, 'recall': 0.8613249001913181, 'f1-score': 0.5385853714761428, 'support': 1144690}, '2': {'precision': 0.4427821605914852, 'recall': 0.13457258507799197, 'f1-score': 0.20641153614532373, 'support': 929647}, 'accuracy': 0.4030070173193273, 'macro avg': {'precision': 0.436902899462609, 'recall': 0.3705178050658661, 'f1-score': 0.31036774271879913, 'support': 3031642}, 'weighted avg': {'precision': 0.4340604484748831, 'recall': 0.4030070173193273, 'f1-score': 0.3254222185197361, 'support': 3031642}}
[[110718 777341  69246]
 [ 70548 985950  88192]
 [ 51265 753277 125105]]
Evaluating performance on  train set...
5528/5528 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001601
{'0': {'precision': 0.4795992493492342, 'recall': 0.1190667034040528, 'f1-score': 0.19077183632189812, 'support': 399230}, '1': {'precision': 0.4588517820120777, 'recall': 0.8932239498352891, 'f1-score': 0.6062639709652848, 'support': 613499}, '2': {'precision': 0.4657422242777622, 'recall': 0.14037362938255318, 'f1-score': 0.21572749164621655, 'support': 401735}, 'accuracy': 0.46089543459571963, 'macro avg': {'precision': 0.46806441854635805, 'recall': 0.3842214275406317, 'f1-score': 0.33758776631113313, 'support': 1414464}, 'weighted avg': {'precision': 0.4666647367487255, 'recall': 0.46089543459571963, 'f1-score': 0.37807216302042007, 'support': 1414464}}
[[ 47535 323719  27976]
 [ 28794 547992  36713]
 [ 22785 322557  56393]]
Evaluating performance on  val set...
1908/1908 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953387
{'0': {'precision': 0.5066194899012236, 'recall': 0.12000363181751514, 'f1-score': 0.19404384112392287, 'support': 143179}, '1': {'precision': 0.45365243553854534, 'recall': 0.8335840291168768, 'f1-score': 0.5875492738408915, 'support': 202769}, '2': {'precision': 0.46515441040498057, 'recall': 0.26633208394214686, 'f1-score': 0.33872270899166906, 'support': 141669}, 'accuracy': 0.4592497800527873, 'macro avg': {'precision': 0.4751421119482498, 'recall': 0.40663991495884627, 'f1-score': 0.3734386079854945, 'support': 487617}, 'weighted avg': {'precision': 0.472546861192177, 'recall': 0.4592497800527873, 'f1-score': 0.3997118420725009, 'support': 487617}}
[[ 17182 107324  18673]
 [  9033 169025  24711]
 [  7700  96238  37731]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3736959
{'0': {'precision': 0.4649217485159201, 'recall': 0.034374750618466204, 'f1-score': 0.06401634776147129, 'support': 50124}, '1': {'precision': 0.2704557266289872, 'recall': 0.9000621571223955, 'f1-score': 0.4159303639780952, 'support': 37003}, '2': {'precision': 0.3974908200734394, 'recall': 0.07868435398873341, 'f1-score': 0.13136471658997825, 'support': 49527}, 'accuracy': 0.28484347329752513, 'macro avg': {'precision': 0.3776227650727823, 'recall': 0.33770708724319837, 'f1-score': 0.20377047610984825, 'support': 136654}, 'weighted avg': {'precision': 0.3878257410748432, 'recall': 0.28484347329752513, 'f1-score': 0.1837160053275374, 'support': 136654}}
[[ 1723 45337  3064]
 [  855 33305  2843]
 [ 1128 44502  3897]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3285345
{'0': {'precision': 0.39181692094313453, 'recall': 0.05294972119394593, 'f1-score': 0.09329205366357068, 'support': 21341}, '1': {'precision': 0.3382745928503, 'recall': 0.9217769635905656, 'f1-score': 0.4949221727690756, 'support': 21835}, '2': {'precision': 0.3736780258519389, 'recall': 0.04384191176470588, 'f1-score': 0.07847653518693702, 'support': 21760}, 'accuracy': 0.3420444745595663, 'macro avg': {'precision': 0.3679231798817912, 'recall': 0.3395228655164058, 'f1-score': 0.2222302538731944, 'support': 64936}, 'weighted avg': {'precision': 0.3677347617234188, 'recall': 0.3420444745595663, 'f1-score': 0.22337718315441016, 'support': 64936}}
[[ 1130 19482   729]
 [  838 20127   870]
 [  916 19890   954]]
Evaluating performance on  val set...
81/81 - 1s - 601ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.369649
{'0': {'precision': 0.41906202723146746, 'recall': 0.03804422469441011, 'f1-score': 0.06975572903550743, 'support': 7281}, '1': {'precision': 0.3000794461468619, 'recall': 0.8616587909401988, 'f1-score': 0.4451365798223831, 'support': 6137}, '2': {'precision': 0.3916023993144816, 'recall': 0.12696207806639812, 'f1-score': 0.19175495646700932, 'support': 7199}, 'accuracy': 0.31425522626958335, 'macro avg': {'precision': 0.3702479575642703, 'recall': 0.3422216979003357, 'f1-score': 0.23554908844163328, 'support': 20617}, 'weighted avg': {'precision': 0.3740565481855051, 'recall': 0.31425522626958335, 'f1-score': 0.22409364044640318, 'support': 20617}}
[[ 277 6249  755]
 [ 184 5288  665]
 [ 200 6085  914]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
1613/1613 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8702183
{'0': {'precision': 0.4765907109948948, 'recall': 0.1068731065101149, 'f1-score': 0.1745943048729031, 'support': 71627}, '1': {'precision': 0.6936563910300886, 'recall': 0.811699290906924, 'f1-score': 0.7480496569524195, 'support': 268512}, '2': {'precision': 0.3330911468739783, 'recall': 0.3783110988859854, 'f1-score': 0.35426393029860065, 'support': 72710}, 'accuracy': 0.6130885626463913, 'macro avg': {'precision': 0.5011127496329872, 'recall': 0.43229449876767484, 'f1-score': 0.4256359640413077, 'support': 412849}, 'weighted avg': {'precision': 0.5924947983740046, 'recall': 0.6130885626463913, 'f1-score': 0.5792057292975173, 'support': 412849}}
[[  7655  52821  11151]
 [  6638 217951  43923]
 [  1769  43434  27507]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86609626
{'0': {'precision': 0.5487872616182189, 'recall': 0.18236072230596487, 'f1-score': 0.2737537232445912, 'support': 32507}, '1': {'precision': 0.6633045538641306, 'recall': 0.8433721266146672, 'f1-score': 0.7425781249999999, 'support': 96924}, '2': {'precision': 0.4219127469091943, 'recall': 0.36257059990841095, 'f1-score': 0.38999720867609156, 'support': 32755}, 'accuracy': 0.6137829405744022, 'macro avg': {'precision': 0.5446681874638479, 'recall': 0.4627678162763477, 'f1-score': 0.46877635230689424, 'support': 162186}, 'weighted avg': {'precision': 0.591600447123433, 'recall': 0.6137829405744022, 'f1-score': 0.5774044186255121, 'support': 162186}}
[[ 5928 21936  4643]
 [ 3552 81743 11629]
 [ 1322 19557 11876]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8172943
{'0': {'precision': 0.7193251533742331, 'recall': 0.10973327094057089, 'f1-score': 0.19041818920016237, 'support': 8548}, '1': {'precision': 0.7414314648709788, 'recall': 0.7991098006974173, 'f1-score': 0.7691908855232639, 'support': 35273}, '2': {'precision': 0.3678872399134909, 'recall': 0.5537097317319565, 'f1-score': 0.4420647011380948, 'support': 8909}, 'accuracy': 0.6458941778873507, 'macro avg': {'precision': 0.6095479527195676, 'recall': 0.48751760112331494, 'f1-score': 0.4672245919538403, 'support': 52730}, 'weighted avg': {'precision': 0.6747356512768115, 'recall': 0.6458941778873507, 'f1-score': 0.6200970834209057, 'support': 52730}}
[[  938  5955  1655]
 [  265 28187  6821]
 [  101  3875  4933]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.195318
{'0': {'precision': 0.3459603118355776, 'recall': 0.1374450951683748, 'f1-score': 0.1967315520090275, 'support': 71032}, '1': {'precision': 0.4526373331197014, 'recall': 0.8292554477328452, 'f1-score': 0.5856214808966225, 'support': 115828}, '2': {'precision': 0.3154790371433126, 'recall': 0.05987081940431711, 'f1-score': 0.10064204437098723, 'support': 66109}, 'accuracy': 0.43393459277618995, 'macro avg': {'precision': 0.3713588940328639, 'recall': 0.3421904541018457, 'f1-score': 0.29433169242554574, 'support': 252969}, 'weighted avg': {'precision': 0.3868392315161177, 'recall': 0.43393459277618995, 'f1-score': 0.3496829469338963, 'support': 252969}}
[[ 9763 58870  2399]
 [13588 96051  6189]
 [ 4869 57282  3958]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3194151
{'0': {'precision': 0.4088604216706699, 'recall': 0.10645542352859426, 'f1-score': 0.16892711434557284, 'support': 28782}, '1': {'precision': 0.33216052628031434, 'recall': 0.8620508693978939, 'f1-score': 0.47954536608150716, 'support': 28583}, '2': {'precision': 0.41956030408876105, 'recall': 0.06998663330705693, 'f1-score': 0.11996240159793209, 'support': 29177}, 'accuracy': 0.34371750132883455, 'macro avg': {'precision': 0.3868604173465817, 'recall': 0.34616430874451504, 'f1-score': 0.2561449606750041, 'support': 86542}, 'weighted avg': {'precision': 0.38713544835563335, 'recall': 0.34371750132883455, 'f1-score': 0.25500968772647803, 'support': 86542}}
[[ 3064 24320  1398]
 [ 2516 24640  1427]
 [ 1914 25221  2042]]
Evaluating performance on  val set...
124/124 - 1s - 848ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3105236
{'0': {'precision': 0.4029356060606061, 'recall': 0.16335540838852097, 'f1-score': 0.23246602472171, 'support': 10419}, '1': {'precision': 0.3280667638956409, 'recall': 0.7844618812360747, 'f1-score': 0.46265032707744164, 'support': 10323}, '2': {'precision': 0.40434451219512196, 'recall': 0.09833178869323447, 'f1-score': 0.15819293275682123, 'support': 10790}, 'accuracy': 0.3444437396930103, 'macro avg': {'precision': 0.3784489607171229, 'recall': 0.34871635943927676, 'f1-score': 0.2844364281853243, 'support': 31532}, 'weighted avg': {'precision': 0.37890703316711666, 'recall': 0.3444437396930103, 'f1-score': 0.2824084924027028, 'support': 31532}}
[[1702 8032  685]
 [1347 8098  878]
 [1175 8554 1061]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3069129
{'0': {'precision': 0.3265114616381429, 'recall': 0.1989950843557238, 'f1-score': 0.24728207991742598, 'support': 73439}, '1': {'precision': 0.3900241188078571, 'recall': 0.7681394491547738, 'f1-score': 0.5173585494580331, 'support': 94945}, '2': {'precision': 0.36036400404448937, 'recall': 0.02608695652173913, 'f1-score': 0.04865196914886355, 'support': 68310}, 'accuracy': 0.37739444176869713, 'macro avg': {'precision': 0.35896652816349645, 'recall': 0.3310738300107456, 'f1-score': 0.2710975328414409, 'support': 236694}, 'weighted avg': {'precision': 0.36175813627609754, 'recall': 0.37739444176869713, 'f1-score': 0.29829303724601247, 'support': 236694}}
[[14614 57383  1442]
 [20293 72931  1721]
 [ 9851 56677  1782]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3568385
{'0': {'precision': 0.34963758092181707, 'recall': 0.20854097224514043, 'f1-score': 0.26125604663662294, 'support': 30301}, '1': {'precision': 0.32048967439503356, 'recall': 0.6983814749629016, 'f1-score': 0.43935693272977927, 'support': 28977}, '2': {'precision': 0.3882768937848497, 'recall': 0.09746688515635668, 'f1-score': 0.15581934779642517, 'support': 29292}, 'accuracy': 0.33206503330698883, 'macro avg': {'precision': 0.35280138303390013, 'recall': 0.3347964441214662, 'f1-score': 0.28547744238760914, 'support': 88570}, 'weighted avg': {'precision': 0.35288025750482876, 'recall': 0.33206503330698883, 'f1-score': 0.2846542355707351, 'support': 88570}}
[[ 6319 21560  2422]
 [ 6664 20237  2076]
 [ 5090 21347  2855]]
Evaluating performance on  val set...
127/127 - 1s - 830ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3353935
{'0': {'precision': 0.41453287197231836, 'recall': 0.10932651943785363, 'f1-score': 0.1730213749277874, 'support': 10958}, '1': {'precision': 0.32707153885743695, 'recall': 0.7244917347520425, 'f1-score': 0.4506825837716447, 'support': 10526}, '2': {'precision': 0.3587798845836768, 'recall': 0.20172429776582923, 'f1-score': 0.25824827913600756, 'support': 10787}, 'accuracy': 0.34086331381116175, 'macro avg': {'precision': 0.3667947651378107, 'recall': 0.3451808506519085, 'f1-score': 0.2939840792784799, 'support': 32271}, 'weighted avg': {'precision': 0.3673689951997201, 'recall': 0.34086331381116175, 'f1-score': 0.29207577361343434, 'support': 32271}}
[[1198 8026 1734]
 [ 745 7626 2155]
 [ 947 7664 2176]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
1590/1590 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2471435
{'0': {'precision': 0.35966915919309467, 'recall': 0.12470925627964752, 'f1-score': 0.1852026098475938, 'support': 119951}, '1': {'precision': 0.41344384285066543, 'recall': 0.7324953632057083, 'f1-score': 0.5285545624645704, 'support': 169298}, '2': {'precision': 0.3590895203177513, 'recall': 0.19963310855570465, 'f1-score': 0.2566073163542679, 'support': 117746}, 'accuracy': 0.3992063784567378, 'macro avg': {'precision': 0.37740084078717046, 'recall': 0.35227924268035343, 'f1-score': 0.3234548295554774, 'support': 406995}, 'weighted avg': {'precision': 0.3818701597823973, 'recall': 0.3992063784567378, 'f1-score': 0.3486847593739609, 'support': 406995}}
[[ 14959  89886  15106]
 [ 18440 124010  26848]
 [  8192  86048  23506]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3407214
{'0': {'precision': 0.40663729000275406, 'recall': 0.12860658058053698, 'f1-score': 0.19541085579102355, 'support': 45923}, '1': {'precision': 0.32801554661725496, 'recall': 0.7987234510839661, 'f1-score': 0.4650477349907093, 'support': 45435}, '2': {'precision': 0.3851318944844125, 'recall': 0.10403575824318197, 'f1-score': 0.16381904421890142, 'support': 46311}, 'accuracy': 0.3415002651286782, 'macro avg': {'precision': 0.37326157703480717, 'recall': 0.34378859663589506, 'f1-score': 0.27475921166687806, 'support': 137669}, 'weighted avg': {'precision': 0.3734554169407716, 'recall': 0.3415002651286782, 'f1-score': 0.27377202076441026, 'support': 137669}}
[[ 5906 36723  3294]
 [ 4747 36290  4398]
 [ 3871 37622  4818]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2978004
{'0': {'precision': 0.37611607142857145, 'recall': 0.09647867162897222, 'f1-score': 0.15356573251310093, 'support': 17465}, '1': {'precision': 0.342961201881734, 'recall': 0.7265323617659666, 'f1-score': 0.46596336895639323, 'support': 18664}, '2': {'precision': 0.3818872704243192, 'recall': 0.20837412889477624, 'f1-score': 0.2696277527294407, 'support': 17363}, 'accuracy': 0.3526321692963434, 'macro avg': {'precision': 0.3669881812448749, 'recall': 0.3437950540965717, 'f1-score': 0.2963856180663116, 'support': 53492}, 'weighted avg': {'precision': 0.3664212169258606, 'recall': 0.3526321692963434, 'f1-score': 0.300237652493545, 'support': 53492}}
[[ 1685 13243  2537]
 [ 1785 13560  3319]
 [ 1010 12735  3618]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.918901
{'0': {'precision': 0.529042170194226, 'recall': 0.20750381126695958, 'f1-score': 0.29808937771532856, 'support': 222367}, '1': {'precision': 0.6085747341253949, 'recall': 0.8078470210893368, 'f1-score': 0.6941933562703614, 'support': 507887}, '2': {'precision': 0.45826555116585327, 'recall': 0.39820276148726536, 'f1-score': 0.42612810135016504, 'support': 237698}, 'accuracy': 0.5693350496718845, 'macro avg': {'precision': 0.5319608184951581, 'recall': 0.47118453128118726, 'f1-score': 0.4728036117786183, 'support': 967952}, 'weighted avg': {'precision': 0.5533926488414145, 'recall': 0.5693350496718845, 'f1-score': 0.537368401765006, 'support': 967952}}
[[ 46142 134272  41953]
 [ 27653 410295  69939]
 [ 13423 129623  94652]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9505131
{'0': {'precision': 0.5937660684116451, 'recall': 0.21803044334355304, 'f1-score': 0.3189446548821549, 'support': 111223}, '1': {'precision': 0.5397453822428002, 'recall': 0.8202230395951335, 'f1-score': 0.6510615848452169, 'support': 187321}, '2': {'precision': 0.5150802976889933, 'recall': 0.39021473275303936, 'f1-score': 0.44403628419550084, 'support': 111208}, 'accuracy': 0.540058376774244, 'macro avg': {'precision': 0.5495305827811462, 'recall': 0.47615607189724196, 'f1-score': 0.47134750797429087, 'support': 409752}, 'weighted avg': {'precision': 0.5477145637347701, 'recall': 0.540058376774244, 'f1-score': 0.5047245054998196, 'support': 409752}}
[[ 24250  69833  17140]
 [  9962 153645  23714]
 [  6629  61184  43395]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.868323
{'0': {'precision': 0.6175861558940985, 'recall': 0.24726120684550246, 'f1-score': 0.35313768606224627, 'support': 33774}, '1': {'precision': 0.6121598722058522, 'recall': 0.8205439814814814, 'f1-score': 0.701197386396652, 'support': 69120}, '2': {'precision': 0.5159235668789809, 'recall': 0.4650974025974026, 'f1-score': 0.48919384673760097, 'support': 33264}, 'accuracy': 0.591503988013925, 'macro avg': {'precision': 0.5818898649929772, 'recall': 0.5109675303081288, 'f1-score': 0.5145096397321663, 'support': 136158}, 'weighted avg': {'precision': 0.5899949083028408, 'recall': 0.591503988013925, 'f1-score': 0.5630677571254163, 'support': 136158}}
[[ 8351 20036  5387]
 [ 3275 56716  9129]
 [ 1896 15897 15471]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
4457/4457 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0086809
{'0': {'precision': 0.5450106951358714, 'recall': 0.17649050438283148, 'f1-score': 0.26663632033524876, 'support': 321938}, '1': {'precision': 0.4876630177156023, 'recall': 0.8682026311192758, 'f1-score': 0.6245313692312797, 'support': 509517}, '2': {'precision': 0.47647303929133616, 'recall': 0.19950953784119108, 'f1-score': 0.2812525620587566, 'support': 309504}, 'accuracy': 0.4916320393633776, 'macro avg': {'precision': 0.5030489173809366, 'recall': 0.4147342244477661, 'f1-score': 0.39080675054176167, 'support': 1140959}, 'weighted avg': {'precision': 0.5008090233924956, 'recall': 0.4916320393633776, 'f1-score': 0.4304260769406584, 'support': 1140959}}
[[ 56819 238787  26332]
 [ 25638 442364  41515]
 [ 21796 225959  61749]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96185654
{'0': {'precision': 0.48642533936651583, 'recall': 0.14462142818705268, 'f1-score': 0.2229550356728057, 'support': 148664}, '1': {'precision': 0.5556956310475308, 'recall': 0.8989073152013467, 'f1-score': 0.6868112965977564, 'support': 323149}, '2': {'precision': 0.4499749084623534, 'recall': 0.16256614111896, 'f1-score': 0.23884337064130576, 'support': 148924}, 'accuracy': 0.541599743530674, 'macro avg': {'precision': 0.4973652929588, 'recall': 0.4020316281691198, 'f1-score': 0.3828699009706226, 'support': 620737}, 'weighted avg': {'precision': 0.5137417092855907, 'recall': 0.541599743530674, 'f1-score': 0.46824545860310596, 'support': 620737}}
[[ 21500 116427  10737]
 [ 13812 290481  18856]
 [  8888 115826  24210]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94331527
{'0': {'precision': 0.5617213232135185, 'recall': 0.15702876358614062, 'f1-score': 0.24544387954634334, 'support': 49959}, '1': {'precision': 0.5732626499473272, 'recall': 0.8281004555450833, 'f1-score': 0.6775104321039717, 'support': 101856}, '2': {'precision': 0.46142917674036044, 'recall': 0.3747039893132552, 'f1-score': 0.41356893932624433, 'support': 49407}, 'accuracy': 0.550163501008836, 'macro avg': {'precision': 0.5321377166337354, 'recall': 0.4532777361481597, 'f1-score': 0.44550775032551976, 'support': 201222}, 'weighted avg': {'precision': 0.5429381846650472, 'recall': 0.550163501008836, 'f1-score': 0.5054309863530312, 'support': 201222}}
[[ 7845 34579  7535]
 [ 3436 84347 14073]
 [ 2685 28209 18513]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003737
{'0': {'precision': 0.5483941208492107, 'recall': 0.21346175035527518, 'f1-score': 0.3073052879042394, 'support': 353951}, '1': {'precision': 0.43713736256295066, 'recall': 0.9252512305588089, 'f1-score': 0.5937540649952502, 'support': 488396}, '2': {'precision': 0.6891785770378515, 'recall': 0.04949216392869429, 'f1-score': 0.09235221383283787, 'support': 354642}, 'accuracy': 0.45530577139806633, 'macro avg': {'precision': 0.5582366868166709, 'recall': 0.39606838161425945, 'f1-score': 0.3311371889107758, 'support': 1196989}, 'weighted avg': {'precision': 0.5447104824796648, 'recall': 0.45530577139806633, 'f1-score': 0.36049629370405156, 'support': 1196989}}
[[ 75555 273160   5236]
 [ 33827 451889   2680]
 [ 28393 308697  17552]]
Evaluating performance on  train set...
2108/2108 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0309349
{'0': {'precision': 0.5785915492957746, 'recall': 0.19362866785236207, 'f1-score': 0.29015534282310507, 'support': 159119}, '1': {'precision': 0.4645477809667887, 'recall': 0.8853589857591313, 'f1-score': 0.6093629016927777, 'support': 222669}, '2': {'precision': 0.545342720725095, 'recall': 0.21376593220446513, 'f1-score': 0.30713836449322257, 'support': 157621}, 'accuracy': 0.48506050140060697, 'macro avg': {'precision': 0.5294940169958862, 'recall': 0.43091786193865284, 'f1-score': 0.4022188696697018, 'support': 539409}, 'weighted avg': {'precision': 0.5217984192994526, 'recall': 0.48506050140060697, 'f1-score': 0.4268874121519757, 'support': 539409}}
[[ 30810 114820  13489]
 [ 10925 197142  14602]
 [ 11515 112412  33694]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.057571
{'0': {'precision': 0.6167892156862745, 'recall': 0.15865460391514044, 'f1-score': 0.2523882355890981, 'support': 63446}, '1': {'precision': 0.44047284925758123, 'recall': 0.856172390502416, 'f1-score': 0.5816867725054493, 'support': 76988}, '2': {'precision': 0.5363748136134145, 'recall': 0.32158597217647705, 'f1-score': 0.4020944051144274, 'support': 63759}, 'accuracy': 0.47251864657456427, 'macro avg': {'precision': 0.5312122928524234, 'recall': 0.4454709888646779, 'f1-score': 0.4120564710696583, 'support': 204193}, 'weighted avg': {'precision': 0.5252024018367512, 'recall': 0.47251864657456427, 'f1-score': 0.42329101591399426, 'support': 204193}}
[[10066 43544  9836]
 [ 3186 65915  7887]
 [ 3068 40187 20504]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
4274/4274 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2491541
{'0': {'precision': 0.4988272940491991, 'recall': 0.06958859635773347, 'f1-score': 0.12213835610035145, 'support': 394260}, '1': {'precision': 0.2980455289831696, 'recall': 0.9267227610176205, 'f1-score': 0.45103319180162965, 'support': 313044}, '2': {'precision': 0.49092929108452804, 'recall': 0.08340292842349668, 'f1-score': 0.14258277399235747, 'support': 386761}, 'accuracy': 0.3197232339943239, 'macro avg': {'precision': 0.4292673713722989, 'recall': 0.35990476193295023, 'f1-score': 0.2385847739647795, 'support': 1094065}, 'weighted avg': {'precision': 0.4385857486310116, 'recall': 0.3197232339943239, 'f1-score': 0.22347205972454295, 'support': 1094065}}
[[ 27436 344100  22724]
 [ 12214 290105  10725]
 [ 15351 339153  32257]]
Evaluating performance on  train set...
1972/1972 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1375214
{'0': {'precision': 0.5290638451680741, 'recall': 0.10420010354646647, 'f1-score': 0.17410909798705615, 'support': 154520}, '1': {'precision': 0.41336890747830735, 'recall': 0.9065075553864584, 'f1-score': 0.5678138042974183, 'support': 194497}, '2': {'precision': 0.5146577068458631, 'recall': 0.1575438889710278, 'f1-score': 0.2412406549760561, 'support': 155563}, 'accuracy': 0.4299060604859487, 'macro avg': {'precision': 0.48569681983074825, 'recall': 0.3894171826346509, 'f1-score': 0.32772118575351017, 'support': 504580}, 'weighted avg': {'precision': 0.48002626858623443, 'recall': 0.4299060604859487, 'f1-score': 0.34656454739671627, 'support': 504580}}
[[ 16101 126639  11780]
 [  6852 176313  11332]
 [  7480 123575  24508]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1360487
{'0': {'precision': 0.5404939689833429, 'recall': 0.09725260528808888, 'f1-score': 0.1648443088422067, 'support': 58055}, '1': {'precision': 0.40255188958036364, 'recall': 0.8799799358555381, 'f1-score': 0.5524035800843495, 'support': 65789}, '2': {'precision': 0.5186653078171592, 'recall': 0.24145141451414515, 'f1-score': 0.3295085308681942, 'support': 56910}, 'accuracy': 0.4275424057005654, 'macro avg': {'precision': 0.48723705546028856, 'recall': 0.4062279852192574, 'f1-score': 0.3489188065982501, 'support': 180754}, 'weighted avg': {'precision': 0.48341450978017114, 'recall': 0.4275424057005654, 'f1-score': 0.3577483539601476, 'support': 180754}}
[[ 5646 45357  7052]
 [ 2196 57893  5700]
 [ 2604 40565 13741]]
testing model on single stock: results/universal/W4/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
12724/12724 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1521142
{'0': {'precision': 0.3789256966583809, 'recall': 0.06268438762236504, 'f1-score': 0.10757329189207682, 'support': 877906}, '1': {'precision': 0.4633798162284055, 'recall': 0.9490804458878538, 'f1-score': 0.622721551036865, 'support': 1506926}, '2': {'precision': 0.3416280712771803, 'recall': 0.009978046921123676, 'f1-score': 0.01938977024770743, 'support': 872315}, 'accuracy': 0.4586618288950422, 'macro avg': {'precision': 0.39464452805465555, 'recall': 0.3405809601437808, 'f1-score': 0.24989487105888306, 'support': 3257147}, 'weighted avg': {'precision': 0.40800968657433406, 'recall': 0.4586618288950422, 'f1-score': 0.3222908029153162, 'support': 3257147}}
[[  55031  815508    7367]
 [  67325 1430194    9407]
 [  22873  840738    8704]]
Evaluating performance on  train set...
5165/5165 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3244207
{'0': {'precision': 0.40971987850151875, 'recall': 0.03033131866509491, 'f1-score': 0.0564813561616025, 'support': 440271}, '1': {'precision': 0.33311757797619895, 'recall': 0.9570476229400252, 'f1-score': 0.4942148275821638, 'support': 440418}, '2': {'precision': 0.3868193657750031, 'recall': 0.021195569681907875, 'f1-score': 0.04018900343642612, 'support': 441413}, 'accuracy': 0.33598844869760425, 'macro avg': {'precision': 0.37655227408424025, 'recall': 0.33619150376234264, 'f1-score': 0.19696172906006412, 'support': 1322102}, 'weighted avg': {'precision': 0.3765563131964896, 'recall': 0.33598844869760425, 'f1-score': 0.1968593630949726, 'support': 1322102}}
[[ 13354 419587   7330]
 [ 11416 421501   7501]
 [  7823 424234   9356]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3017731
{'0': {'precision': 0.30058202624050506, 'recall': 0.01930876276900459, 'f1-score': 0.0362865530156424, 'support': 157804}, '1': {'precision': 0.3492080002377485, 'recall': 0.9502868068833652, 'f1-score': 0.510733484528849, 'support': 173113}, '2': {'precision': 0.33512203565864634, 'recall': 0.012403657028632203, 'f1-score': 0.023921907821574204, 'support': 156083}, 'accuracy': 0.3480287474332649, 'macro avg': {'precision': 0.32830402071229997, 'recall': 0.32733307556033403, 'f1-score': 0.19031398178868855, 'support': 487000}, 'weighted avg': {'precision': 0.3289370499090811, 'recall': 0.3480287474332649, 'f1-score': 0.20097448061157666, 'support': 487000}}
[[  3047 154039    718]
 [  5483 164507   3123]
 [  1607 152540   1936]]
training model: results/universal/W4/deepLOB_L1/h100
Epoch 1/50
9854/9854 - 152s - loss: 3.1853 - accuracy100: 0.4266 - val_loss: 3.4163 - val_accuracy100: 0.3837 - 152s/epoch - 15ms/step
Epoch 2/50
9854/9854 - 150s - loss: 3.1444 - accuracy100: 0.4421 - val_loss: 3.5298 - val_accuracy100: 0.3754 - 150s/epoch - 15ms/step
Epoch 3/50
9854/9854 - 150s - loss: 3.1197 - accuracy100: 0.4498 - val_loss: 3.5870 - val_accuracy100: 0.3782 - 150s/epoch - 15ms/step
Epoch 4/50
9854/9854 - 151s - loss: 3.1067 - accuracy100: 0.4540 - val_loss: 3.7065 - val_accuracy100: 0.3769 - 151s/epoch - 15ms/step
Epoch 5/50
9854/9854 - 151s - loss: 3.1000 - accuracy100: 0.4561 - val_loss: 3.7336 - val_accuracy100: 0.3799 - 151s/epoch - 15ms/step
Epoch 6/50
9854/9854 - 150s - loss: 3.0951 - accuracy100: 0.4576 - val_loss: 3.7727 - val_accuracy100: 0.3786 - 150s/epoch - 15ms/step
Epoch 7/50
9854/9854 - 151s - loss: 3.0908 - accuracy100: 0.4589 - val_loss: 3.7414 - val_accuracy100: 0.3791 - 151s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 153s - loss: 3.0877 - accuracy100: 0.4597 - val_loss: 3.6660 - val_accuracy100: 0.3784 - 153s/epoch - 15ms/step
Epoch 9/50
9854/9854 - 153s - loss: 3.0848 - accuracy100: 0.4605 - val_loss: 3.7089 - val_accuracy100: 0.3742 - 153s/epoch - 16ms/step
Epoch 10/50
9854/9854 - 156s - loss: 3.0825 - accuracy100: 0.4613 - val_loss: 3.7578 - val_accuracy100: 0.3724 - 156s/epoch - 16ms/step
Epoch 11/50
9854/9854 - 155s - loss: 3.0806 - accuracy100: 0.4619 - val_loss: 3.7466 - val_accuracy100: 0.3715 - 155s/epoch - 16ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 116s - 116s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1095574
{'0': {'precision': 0.3201641898995087, 'recall': 0.4939233134587066, 'f1-score': 0.3885001474009964, 'support': 1802298}, '1': {'precision': 0.39972842688996013, 'recall': 0.3883669509498669, 'f1-score': 0.3939657932895324, 'support': 2437710}, '2': {'precision': 0.37072875226627683, 'recall': 0.18677260549796545, 'f1-score': 0.24840109904472568, 'support': 1831623}, 'accuracy': 0.3588854461017147, 'macro avg': {'precision': 0.3635404563519152, 'recall': 0.3563542899688463, 'f1-score': 0.3436223465784181, 'support': 6071631}, 'weighted avg': {'precision': 0.36736234004563917, 'recall': 0.3588854461017147, 'f1-score': 0.3484310161233356, 'support': 6071631}}
[[ 890197  685695  226406]
 [1136718  946726  354266]
 [ 753524  736002  342097]]
Evaluating performance on  train set...
9854/9854 - 60s - 60s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1236075
{'0': {'precision': 0.37064773430234704, 'recall': 0.32461271484115717, 'f1-score': 0.3461061748293838, 'support': 836141}, '1': {'precision': 0.36132171479957714, 'recall': 0.5373359164024891, 'f1-score': 0.4320914394912517, 'support': 851700}, '2': {'precision': 0.38139777608285497, 'recall': 0.23918276435005478, 'f1-score': 0.29399495619641514, 'support': 834178}, 'accuracy': 0.3681938954464657, 'macro avg': {'precision': 0.37112240839492633, 'recall': 0.36704379853123364, 'f1-score': 0.3573975235056836, 'support': 2522019}, 'weighted avg': {'precision': 0.37105394755524934, 'recall': 0.3681938954464657, 'f1-score': 0.35790767901143017, 'support': 2522019}}
[[271422 412450 152269]
 [222710 457649 171341]
 [238159 396498 199521]]
Evaluating performance on  val set...
3566/3566 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1373259
{'0': {'precision': 0.41643589334647896, 'recall': 0.09620434631153033, 'f1-score': 0.15630042201440453, 'support': 298552}, '1': {'precision': 0.38047421828776834, 'recall': 0.6456629020494379, 'f1-score': 0.4788016787735821, 'support': 316721}, '2': {'precision': 0.3812335121458483, 'recall': 0.3925622477522814, 'f1-score': 0.3868149509275505, 'support': 297079}, 'accuracy': 0.3834473974957034, 'macro avg': {'precision': 0.39271454126003186, 'recall': 0.37814316537108317, 'f1-score': 0.34063901723851236, 'support': 912352}, 'weighted avg': {'precision': 0.3924893180214158, 'recall': 0.3834473974957034, 'f1-score': 0.3433159009929259, 'support': 912352}}
[[ 28722 171637  98193]
 [ 21134 204495  91092]
 [ 19115 161342 116622]]
testing model out of sample: results/universal/W4/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 62s - 62s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1445769
{'0': {'precision': 0.37089573843897167, 'recall': 0.36269088273651906, 'f1-score': 0.36674742666950394, 'support': 1059682}, '1': {'precision': 0.3107517624960553, 'recall': 0.41580220913969057, 'f1-score': 0.355682507795007, 'support': 940185}, '2': {'precision': 0.36924266156756647, 'recall': 0.26388892927237045, 'f1-score': 0.30780031201248054, 'support': 1031775}, 'accuracy': 0.34553618138289416, 'macro avg': {'precision': 0.35029672083419783, 'recall': 0.3474606737161934, 'f1-score': 0.34341008215899715, 'support': 3031642}, 'weighted avg': {'precision': 0.3516810463972052, 'recall': 0.34553618138289416, 'f1-score': 0.34325414151998124, 'support': 3031642}}
[[384337 438969 236376]
 [320519 390931 228735]
 [331384 428117 272274]]
Evaluating performance on  train set...
5528/5528 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1266643
{'0': {'precision': 0.3494847374432617, 'recall': 0.36521945559305036, 'f1-score': 0.35717889104541245, 'support': 450729}, '1': {'precision': 0.3769371633021027, 'recall': 0.4749221374407396, 'f1-score': 0.4202942977089703, 'support': 506662}, '2': {'precision': 0.3815545787401704, 'recall': 0.25466829149829456, 'f1-score': 0.30545853419161156, 'support': 457073}, 'accuracy': 0.36879128772453734, 'macro avg': {'precision': 0.3693254931618449, 'recall': 0.36493662817736144, 'f1-score': 0.36097724098199807, 'support': 1414464}, 'weighted avg': {'precision': 0.3696813345723467, 'recall': 0.36879128772453734, 'f1-score': 0.36307384454209685, 'support': 1414464}}
[[164615 200491  85623]
 [162989 240625 103048]
 [143418 197253 116402]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1668788
{'0': {'precision': 0.3639646145513631, 'recall': 0.11259704234180004, 'f1-score': 0.17198756350951697, 'support': 161141}, '1': {'precision': 0.35904852444426466, 'recall': 0.5287063953488372, 'f1-score': 0.42766589490371437, 'support': 167872}, '2': {'precision': 0.3707542070934193, 'recall': 0.44548056795541097, 'f1-score': 0.4046967852795876, 'support': 158604}, 'accuracy': 0.36412594310698765, 'macro avg': {'precision': 0.3645891153630157, 'recall': 0.3622613352153494, 'f1-score': 0.33478341456427296, 'support': 487617}, 'weighted avg': {'precision': 0.3644805577138891, 'recall': 0.36412594310698765, 'f1-score': 0.3357018028765345, 'support': 487617}}
[[18144 82723 60274]
 [19475 88755 59642]
 [12232 75717 70655]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2024647
{'0': {'precision': 0.4279347008914188, 'recall': 0.15479497290262426, 'f1-score': 0.227351183258919, 'support': 51481}, '1': {'precision': 0.24682205305317975, 'recall': 0.41139240506329117, 'f1-score': 0.3085338426590418, 'support': 33180}, '2': {'precision': 0.37405346809290757, 'recall': 0.4512915200123093, 'f1-score': 0.4090584194836213, 'support': 51993}, 'accuracy': 0.3299061864270347, 'macro avg': {'precision': 0.3496034073458354, 'recall': 0.33915963265940824, 'f1-score': 0.31498114846719405, 'support': 136654}, 'weighted avg': {'precision': 0.36345971595013815, 'recall': 0.3299061864270347, 'f1-score': 0.31619706389122415, 'support': 136654}}
[[ 7969 19844 23668]
 [ 3933 13650 15597]
 [ 6720 21809 23464]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1452047
{'0': {'precision': 0.34889774668510537, 'recall': 0.3969458583988894, 'f1-score': 0.37137414494761456, 'support': 21610}, '1': {'precision': 0.35741659607083787, 'recall': 0.4150855001171235, 'f1-score': 0.3840984956864785, 'support': 21345}, '2': {'precision': 0.3738191632928475, 'recall': 0.26463764159956327, 'f1-score': 0.30989291992967877, 'support': 21981}, 'accuracy': 0.35812184304546013, 'macro avg': {'precision': 0.36004450201626365, 'recall': 0.358889666705192, 'f1-score': 0.35512185352125725, 'support': 64936}, 'weighted avg': {'precision': 0.3601339253624683, 'recall': 0.35812184304546013, 'f1-score': 0.35474519427929196, 'support': 64936}}
[[8578 7877 5155]
 [7896 8860 4589]
 [8112 8052 5817]]
Evaluating performance on  val set...
81/81 - 1s - 618ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2427598
{'0': {'precision': 0.2934426229508197, 'recall': 0.1982281284606866, 'f1-score': 0.23661599471249176, 'support': 7224}, '1': {'precision': 0.2734274711168164, 'recall': 0.2319539514623522, 'f1-score': 0.2509889739920882, 'support': 6428}, '2': {'precision': 0.3562816024893038, 'recall': 0.5260588657573583, 'f1-score': 0.4248362223897038, 'support': 6965}, 'accuracy': 0.31949362176844354, 'macro avg': {'precision': 0.30771723218564667, 'recall': 0.3187469818934657, 'f1-score': 0.3041470636980946, 'support': 20617}, 'weighted avg': {'precision': 0.3084310352560323, 'recall': 0.31949362176844354, 'f1-score': 0.30468328852735466, 'support': 20617}}
[[1432 2088 3704]
 [2021 1491 2916]
 [1427 1874 3664]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
1613/1613 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1363695
{'0': {'precision': 0.2723705268080939, 'recall': 0.3691905384523951, 'f1-score': 0.31347482537773497, 'support': 100956}, '1': {'precision': 0.5249529660901415, 'recall': 0.2753365494622836, 'f1-score': 0.36121612367613815, 'support': 209776}, '2': {'precision': 0.3033275293862477, 'recall': 0.49302270924527747, 'f1-score': 0.37558188111721175, 'support': 102117}, 'accuracy': 0.35213116660086374, 'macro avg': {'precision': 0.36688367409482775, 'recall': 0.3791832657199854, 'f1-score': 0.3500909433903616, 'support': 412849}, 'weighted avg': {'precision': 0.4083693302812867, 'recall': 0.35213116660086374, 'f1-score': 0.35309503713262347, 'support': 412849}}
[[37272 30789 32895]
 [69279 57759 82738]
 [30292 21479 50346]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0791507
{'0': {'precision': 0.3452569454440766, 'recall': 0.21665688089968835, 'f1-score': 0.26624115443318996, 'support': 44282}, '1': {'precision': 0.48601749605621686, 'recall': 0.5066114017802541, 'f1-score': 0.49610081975939524, 'support': 73585}, '2': {'precision': 0.3412080769564087, 'recall': 0.4441887226697353, 'f1-score': 0.3859470268786637, 'support': 44319}, 'accuracy': 0.4103868398012159, 'macro avg': {'precision': 0.3908275061522341, 'recall': 0.3891523351165593, 'f1-score': 0.382763000357083, 'support': 162186}, 'weighted avg': {'precision': 0.408014663830925, 'recall': 0.4103868398012159, 'f1-score': 0.4032410683218102, 'support': 162186}}
[[ 9594 21047 13641]
 [11938 37279 24368]
 [ 6256 18377 19686]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0446169
{'0': {'precision': 0.44806671721000757, 'recall': 0.04787751134154245, 'f1-score': 0.08651101515040621, 'support': 12344}, '1': {'precision': 0.5826639631911409, 'recall': 0.5407077724706904, 'f1-score': 0.5609023685297099, 'support': 27636}, '2': {'precision': 0.31915389093731805, 'recall': 0.6449411764705882, 'f1-score': 0.4270024665714656, 'support': 12750}, 'accuracy': 0.450540489285037, 'macro avg': {'precision': 0.4499615237794889, 'recall': 0.41117548676094035, 'f1-score': 0.3581386167505272, 'support': 52730}, 'weighted avg': {'precision': 0.4874388195228809, 'recall': 0.450540489285037, 'f1-score': 0.4174714825808812, 'support': 52730}}
[[  591  6258  5495]
 [  646 14943 12047]
 [   82  4445  8223]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1354716
{'0': {'precision': 0.3719978651485501, 'recall': 0.3036779745119634, 'f1-score': 0.33438389115066064, 'support': 82627}, '1': {'precision': 0.3670378584611567, 'recall': 0.5047294054918688, 'f1-score': 0.4250097652303921, 'support': 93775}, '2': {'precision': 0.3298976362639888, 'recall': 0.24370812491020935, 'f1-score': 0.28032749943664087, 'support': 76567}, 'accuracy': 0.36005597523807265, 'macro avg': {'precision': 0.35631111995789855, 'recall': 0.3507051683046805, 'f1-score': 0.34657371860589786, 'support': 252969}, 'weighted avg': {'precision': 0.3574165810698111, 'recall': 0.36005597523807265, 'f1-score': 0.3516172501687991, 'support': 252969}}
[[25092 40794 16741]
 [25282 47331 21162]
 [17078 40829 18660]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.134562
{'0': {'precision': 0.3544294160935874, 'recall': 0.48306989935323214, 'f1-score': 0.4088700234192037, 'support': 28913}, '1': {'precision': 0.352989179713474, 'recall': 0.41198673627769156, 'f1-score': 0.38021291141713054, 'support': 28348}, '2': {'precision': 0.37824756210406435, 'recall': 0.18148287285270312, 'f1-score': 0.2452804061850912, 'support': 29281}, 'accuracy': 0.35774537218922603, 'macro avg': {'precision': 0.3618887193037086, 'recall': 0.3588465028278756, 'f1-score': 0.34478778034047514, 'support': 86542}, 'weighted avg': {'precision': 0.3620163832590021, 'recall': 0.35774537218922603, 'f1-score': 0.3441333707734731, 'support': 86542}}
[[13967 10808  4138]
 [12072 11679  4597]
 [13368 10599  5314]]
Evaluating performance on  val set...
124/124 - 1s - 795ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1948003
{'0': {'precision': 0.37238023952095806, 'recall': 0.09517887889802946, 'f1-score': 0.15160749657168976, 'support': 10454}, '1': {'precision': 0.31247190450027473, 'recall': 0.6116542823621431, 'f1-score': 0.4136335085457371, 'support': 10228}, '2': {'precision': 0.3416676094580835, 'recall': 0.2783410138248848, 'f1-score': 0.30677027782010263, 'support': 10850}, 'accuracy': 0.32573258911581887, 'macro avg': {'precision': 0.3421732511597721, 'recall': 0.32839139169501913, 'f1-score': 0.29067042764584317, 'support': 31532}, 'weighted avg': {'precision': 0.3423797800901025, 'recall': 0.32573258911581887, 'f1-score': 0.28999130435476206, 'support': 31532}}
[[ 995 6727 2732]
 [ 885 6256 3087]
 [ 792 7038 3020]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1311736
{'0': {'precision': 0.3329425461413835, 'recall': 0.5512347010298161, 'f1-score': 0.4151418405518305, 'support': 74188}, '1': {'precision': 0.36771934823982005, 'recall': 0.39039438141545113, 'f1-score': 0.3787177619269734, 'support': 92550}, '2': {'precision': 0.3580855971296771, 'recall': 0.07989307564754988, 'f1-score': 0.13063905380767613, 'support': 69956}, 'accuracy': 0.3490371534555164, 'macro avg': {'precision': 0.35291583050362685, 'recall': 0.34050738603093905, 'f1-score': 0.30816621876216, 'support': 236694}, 'weighted avg': {'precision': 0.35397180885673485, 'recall': 0.3490371534555164, 'f1-score': 0.3168135118818829, 'support': 236694}}
[[40895 29163  4130]
 [50530 36131  5889]
 [31404 32963  5589]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.156711
{'0': {'precision': 0.36244874260623433, 'recall': 0.3292457805907173, 'f1-score': 0.34505035151054536, 'support': 30336}, '1': {'precision': 0.3496285533500504, 'recall': 0.513403764754465, 'f1-score': 0.4159765788373066, 'support': 29059}, '2': {'precision': 0.3757496456220696, 'recall': 0.23622964867180807, 'f1-score': 0.2900856535555696, 'support': 29175}, 'accuracy': 0.35902675849610477, 'macro avg': {'precision': 0.36260898052611806, 'recall': 0.3596263980056635, 'f1-score': 0.3503708613011405, 'support': 88570}, 'weighted avg': {'precision': 0.36262388052981503, 'recall': 0.35902675849610477, 'f1-score': 0.3502151948779602, 'support': 88570}}
[[ 9988 14143  6205]
 [ 8895 14919  5245]
 [ 8674 13609  6892]]
Evaluating performance on  val set...
127/127 - 1s - 852ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1902417
{'0': {'precision': 0.39590050667894977, 'recall': 0.1562869351759251, 'f1-score': 0.2241053386350303, 'support': 10999}, '1': {'precision': 0.29961739130434784, 'recall': 0.4301837794646424, 'f1-score': 0.35322097839012595, 'support': 10012}, '2': {'precision': 0.3503024937287885, 'recall': 0.4216696269982238, 'f1-score': 0.3826871927137906, 'support': 11260}, 'accuracy': 0.3338601220910415, 'macro avg': {'precision': 0.3486067972373621, 'recall': 0.33604678054626375, 'f1-score': 0.32000450324631563, 'support': 32271}, 'weighted avg': {'precision': 0.35011883964200236, 'recall': 0.3338601220910415, 'f1-score': 0.31949554848767997, 'support': 32271}}
[[1719 5136 4144]
 [1043 4307 4662]
 [1580 4932 4748]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1664239
{'0': {'precision': 0.32895448156557466, 'recall': 0.18845427235281365, 'f1-score': 0.2396282513241578, 'support': 129156}, '1': {'precision': 0.3729416116014993, 'recall': 0.44623371819598934, 'f1-score': 0.4063089205972124, 'support': 151396}, '2': {'precision': 0.34377099055671895, 'recall': 0.41285796762177424, 'f1-score': 0.37516035027326916, 'support': 126443}, 'accuracy': 0.3540608606985344, 'macro avg': {'precision': 0.3485556945745976, 'recall': 0.3491819860568591, 'f1-score': 0.34036584073154647, 'support': 406995}, 'weighted avg': {'precision': 0.34992014302403507, 'recall': 0.3540608606985344, 'f1-score': 0.34373732340780955, 'support': 406995}}
[[24340 58971 45845]
 [30032 67558 53806]
 [19620 54620 52203]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1503648
{'0': {'precision': 0.34911927153306466, 'recall': 0.41000131480913354, 'f1-score': 0.377118900288231, 'support': 45634}, '1': {'precision': 0.33303247468274455, 'recall': 0.405650835532102, 'f1-score': 0.3657721779989492, 'support': 45480}, '2': {'precision': 0.3662482566248257, 'recall': 0.22562560412415422, 'f1-score': 0.2792317405462883, 'support': 46555}, 'accuracy': 0.34621447094117047, 'macro avg': {'precision': 0.34946666761354495, 'recall': 0.34709258482179656, 'f1-score': 0.34070760627782287, 'support': 137669}, 'weighted avg': {'precision': 0.349597319461025, 'recall': 0.34621447094117047, 'f1-score': 0.34026829738196535, 'support': 137669}}
[[18710 18564  8360]
 [17215 18449  9816]
 [17667 18384 10504]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1984813
{'0': {'precision': 0.3880281690140845, 'recall': 0.06136199120218275, 'f1-score': 0.10596663301120246, 'support': 17959}, '1': {'precision': 0.35470727848101263, 'recall': 0.49018750341660744, 'f1-score': 0.41158515594519546, 'support': 18293}, '2': {'precision': 0.35365757527983605, 'recall': 0.5204756380510441, 'f1-score': 0.4211489721205295, 'support': 17240}, 'accuracy': 0.35597846406939354, 'macro avg': {'precision': 0.36546434092497776, 'recall': 0.35734171088994476, 'f1-score': 0.3129002536923091, 'support': 53492}, 'weighted avg': {'precision': 0.3655558724744164, 'recall': 0.35597846406939354, 'f1-score': 0.3120614353419497, 'support': 53492}}
[[1102 8716 8141]
 [1068 8967 8258]
 [ 670 7597 8973]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
3782/3782 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097455
{'0': {'precision': 0.3549134534035564, 'recall': 0.3234309449059539, 'f1-score': 0.33844163489877277, 'support': 287944}, '1': {'precision': 0.4180817891643052, 'recall': 0.43520300463305645, 'f1-score': 0.42647062774185407, 'support': 364770}, '2': {'precision': 0.4106346020463906, 'recall': 0.4244475602560605, 'f1-score': 0.41742684220378107, 'support': 315238}, 'accuracy': 0.39845054300213234, 'macro avg': {'precision': 0.39454328153808405, 'recall': 0.39436050326502364, 'f1-score': 0.39411303494813593, 'support': 967952}, 'weighted avg': {'precision': 0.39686526226527485, 'recall': 0.39845054300213234, 'f1-score': 0.3973386406385067, 'support': 967952}}
[[ 93130 106956  87858]
 [101839 158749 104182]
 [ 67433 114003 133802]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1201036
{'0': {'precision': 0.3982909474687638, 'recall': 0.25536605596705425, 'f1-score': 0.31120293318318654, 'support': 137438}, '1': {'precision': 0.3619986866314463, 'recall': 0.4556448310013329, 'f1-score': 0.4034590303373972, 'support': 134291}, '2': {'precision': 0.41114795349995414, 'recall': 0.4545764111778472, 'f1-score': 0.43177290322580647, 'support': 138023}, 'accuracy': 0.3881079286983346, 'macro avg': {'precision': 0.39047919586672136, 'recall': 0.3885290993820781, 'f1-score': 0.3821449555821301, 'support': 409752}, 'weighted avg': {'precision': 0.3907274420882868, 'recall': 0.3881079286983346, 'f1-score': 0.382052111510879, 'support': 409752}}
[[35097 58549 43792]
 [27034 61189 46068]
 [25988 49293 62742]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1020594
{'0': {'precision': 0.5101476811469039, 'recall': 0.13491845964094834, 'f1-score': 0.21339932443416848, 'support': 43782}, '1': {'precision': 0.4038996814829694, 'recall': 0.5661906677393403, 'f1-score': 0.4714699626521965, 'support': 49720}, '2': {'precision': 0.40318142890982306, 'recall': 0.5187312453113279, 'f1-score': 0.45371500046136337, 'support': 42656}, 'accuracy': 0.41264560290251034, 'macro avg': {'precision': 0.43907626384656545, 'recall': 0.40661345756387224, 'f1-score': 0.3795280958492428, 'support': 136158}, 'weighted avg': {'precision': 0.43783901769183153, 'recall': 0.41264560290251034, 'f1-score': 0.3829242705175156, 'support': 136158}}
[[ 5907 22713 15162]
 [ 3977 28151 17592]
 [ 1695 18834 22127]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
4457/4457 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.140625
{'0': {'precision': 0.3615292038867061, 'recall': 0.3000033035253698, 'f1-score': 0.32790514229211687, 'support': 393519}, '1': {'precision': 0.30726939635096356, 'recall': 0.44867684790552037, 'f1-score': 0.3647472694256986, 'support': 374938}, '2': {'precision': 0.3690427576492097, 'recall': 0.26444421774916643, 'f1-score': 0.3081080658404035, 'support': 372502}, 'accuracy': 0.3372505059340432, 'macro avg': {'precision': 0.3459471192956265, 'recall': 0.3377081230600189, 'f1-score': 0.33358682585273963, 'support': 1140959}, 'weighted avg': {'precision': 0.3461515698839101, 'recall': 0.3372505059340432, 'f1-score': 0.33354869555809286, 'support': 1140959}}
[[118057 198252  77210]
 [115505 168226  91207]
 [ 92987 181009  98506]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1054733
{'0': {'precision': 0.3432164432231959, 'recall': 0.3518239469242361, 'f1-score': 0.3474668966460176, 'support': 187807}, '1': {'precision': 0.41499289475883977, 'recall': 0.506929156370617, 'f1-score': 0.4563769741317497, 'support': 244835}, '2': {'precision': 0.37368848968214025, 'recall': 0.2565724766740211, 'f1-score': 0.30424914890934307, 'support': 188095}, 'accuracy': 0.38413853209974597, 'macro avg': {'precision': 0.3772992758880586, 'recall': 0.37177519332295805, 'f1-score': 0.36936433989570344, 'support': 620737}, 'weighted avg': {'precision': 0.38076056753095344, 'recall': 0.38413853209974597, 'f1-score': 0.37732810446944265, 'support': 620737}}
[[ 66075  88727  33005]
 [ 72841 124114  47880]
 [ 53601  86234  48260]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1355821
{'0': {'precision': 0.4715181248296539, 'recall': 0.08186765517785315, 'f1-score': 0.1395123786994973, 'support': 63395}, '1': {'precision': 0.40274503124243594, 'recall': 0.590908493035369, 'f1-score': 0.4790109503449306, 'support': 76027}, '2': {'precision': 0.3643667056490568, 'recall': 0.4638187702265372, 'f1-score': 0.4081214226727796, 'support': 61800}, 'accuracy': 0.3915029171760543, 'macro avg': {'precision': 0.41287662057371555, 'recall': 0.3788649728132531, 'f1-score': 0.34221491723906916, 'support': 201222}, 'weighted avg': {'precision': 0.41262511267632906, 'recall': 0.3915029171760543, 'f1-score': 0.350280072212315, 'support': 201222}}
[[ 5190 35240 22965]
 [ 4063 44925 27039]
 [ 1754 31382 28664]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
4676/4676 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973067
{'0': {'precision': 0.41749638670306727, 'recall': 0.4387643921362286, 'f1-score': 0.42786625957376256, 'support': 402911}, '1': {'precision': 0.34769376367598803, 'recall': 0.6003527023598072, 'f1-score': 0.44035582240892035, 'support': 394100}, '2': {'precision': 0.4415936049510057, 'recall': 0.10275565156083584, 'f1-score': 0.16671737146334042, 'support': 399978}, 'accuracy': 0.3796876997198805, 'macro avg': {'precision': 0.402261251776687, 'recall': 0.3806242486856239, 'f1-score': 0.34497981781534115, 'support': 1196989}, 'weighted avg': {'precision': 0.4025665447624997, 'recall': 0.3796876997198805, 'f1-score': 0.3447145570474279, 'support': 1196989}}
[[176783 203963  22165]
 [127694 236599  29807]
 [118959 239919  41100]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1233304
{'0': {'precision': 0.39627575634609313, 'recall': 0.2891356197055679, 'f1-score': 0.3343318783106521, 'support': 182385}, '1': {'precision': 0.3404911218751446, 'recall': 0.5779316919970837, 'f1-score': 0.4285185585615556, 'support': 178310}, '2': {'precision': 0.4022144848139968, 'recall': 0.23334489743388878, 'f1-score': 0.2953451725420068, 'support': 178714}, 'accuracy': 0.36611736177928067, 'macro avg': {'precision': 0.37966045434507817, 'recall': 0.36680406971218016, 'f1-score': 0.35273186980473814, 'support': 539409}, 'weighted avg': {'precision': 0.3798028679569452, 'recall': 0.36611736177928067, 'f1-score': 0.35254988509363294, 'support': 539409}}
[[ 52734 101956  27695]
 [ 40975 103051  34284]
 [ 39365  97647  41702]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1220286
{'0': {'precision': 0.43937872607467837, 'recall': 0.19738937990724686, 'f1-score': 0.2724027584596979, 'support': 70941}, '1': {'precision': 0.3584602360819153, 'recall': 0.6068403594087147, 'f1-score': 0.45069512960803665, 'support': 62102}, '2': {'precision': 0.42105968150022327, 'recall': 0.3976247364722417, 'f1-score': 0.4090067948532601, 'support': 71150}, 'accuracy': 0.39168825571885424, 'macro avg': {'precision': 0.4062995478856057, 'recall': 0.4006181585960678, 'f1-score': 0.37736822764033157, 'support': 204193}, 'weighted avg': {'precision': 0.4083854986525676, 'recall': 0.39168825571885424, 'f1-score': 0.3742264743679615, 'support': 204193}}
[[14003 34830 22108]
 [ 7625 37686 16791]
 [10242 32617 28291]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
4274/4274 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1355486
{'0': {'precision': 0.3800920935187323, 'recall': 0.5189538817420744, 'f1-score': 0.4387990665189215, 'support': 402899}, '1': {'precision': 0.27133590930715584, 'recall': 0.3260275500529809, 'f1-score': 0.2961780817580191, 'support': 286896}, '2': {'precision': 0.3990303541315346, 'recall': 0.19666559477576867, 'f1-score': 0.26347515732753624, 'support': 404270}, 'accuracy': 0.34927358063734787, 'macro avg': {'precision': 0.3501527856524742, 'recall': 0.347215675523608, 'f1-score': 0.33281743520149226, 'support': 1094065}, 'weighted avg': {'precision': 0.3585709374561338, 'recall': 0.34927358063734787, 'f1-score': 0.33661538747538644, 'support': 1094065}}
[[209086 121178  72635]
 [146253  93536  47107]
 [194754 130010  79506]]
Evaluating performance on  train set...
1972/1972 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1425829
{'0': {'precision': 0.35481561714100746, 'recall': 0.3417923425179144, 'f1-score': 0.34818224300492656, 'support': 166765}, '1': {'precision': 0.34281767221912274, 'recall': 0.4645793080274101, 'f1-score': 0.39451719745222924, 'support': 166654}, '2': {'precision': 0.39287831315098654, 'recall': 0.2710605803892242, 'f1-score': 0.3207940508416566, 'support': 171161}, 'accuracy': 0.35835348210392803, 'macro avg': {'precision': 0.3635038675037056, 'recall': 0.3591440769781829, 'f1-score': 0.35449783043293753, 'support': 504580}, 'weighted avg': {'precision': 0.36376433409124775, 'recall': 0.35835348210392803, 'f1-score': 0.3541953928317198, 'support': 504580}}
[[56999 74517 35249]
 [52784 77424 36446]
 [50861 73905 46395]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.179305
{'0': {'precision': 0.3327449249779347, 'recall': 0.15174934389540967, 'f1-score': 0.2084393038016675, 'support': 62109}, '1': {'precision': 0.32067972011524665, 'recall': 0.4792779808773903, 'f1-score': 0.3842571390323467, 'support': 56896}, '2': {'precision': 0.3888625100157284, 'recall': 0.4244117313640707, 'f1-score': 0.4058601705086609, 'support': 61749}, 'accuracy': 0.3479922989256116, 'macro avg': {'precision': 0.3474290517029699, 'recall': 0.35181301871229026, 'f1-score': 0.33285220444755836, 'support': 180754}, 'weighted avg': {'precision': 0.3481179892676944, 'recall': 0.3479922989256116, 'f1-score': 0.3312242637559416, 'support': 180754}}
[[ 9425 29879 22805]
 [11245 27269 18382]
 [ 7655 27887 26207]]
testing model on single stock: results/universal/W4/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
12724/12724 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1125768
{'0': {'precision': 0.2957406579994115, 'recall': 0.5796876852373013, 'f1-score': 0.3916647634057222, 'support': 936299}, '1': {'precision': 0.41634632444260455, 'recall': 0.3324339599887833, 'f1-score': 0.3696883057393383, 'support': 1376514}, '2': {'precision': 0.34553069683583126, 'recall': 0.11811287108163002, 'f1-score': 0.17604740138390826, 'support': 944334}, 'accuracy': 0.34137206579868823, 'macro avg': {'precision': 0.3525392264259491, 'recall': 0.3434115054359048, 'f1-score': 0.31246682350965627, 'support': 3257147}, 'weighted avg': {'precision': 0.36114569341013664, 'recall': 0.34137206579868823, 'f1-score': 0.31986397959225216, 'support': 3257147}}
[[542761 314067  79471]
 [787121 457600 131793]
 [505378 327418 111538]]
Evaluating performance on  train set...
5165/5165 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1278661
{'0': {'precision': 0.36027718176643164, 'recall': 0.37254471360652025, 'f1-score': 0.3663082676639508, 'support': 441700}, '1': {'precision': 0.3567815601639347, 'recall': 0.5519011123712639, 'f1-score': 0.43339252718149124, 'support': 436455}, '2': {'precision': 0.3588202823121205, 'recall': 0.1537413249779816, 'f1-score': 0.21525414641684618, 'support': 443947}, 'accuracy': 0.35828249257621575, 'macro avg': {'precision': 0.3586263414141622, 'recall': 0.35939571698525524, 'f1-score': 0.3383183137540961, 'support': 1322102}, 'weighted avg': {'precision': 0.3586339895856764, 'recall': 0.35828249257621575, 'f1-score': 0.33773198271955146, 'support': 1322102}}
[[164553 216592  60555]
 [134168 240880  61407]
 [158019 217675  68253]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1595358
{'0': {'precision': 0.32972144134934833, 'recall': 0.0401966526675224, 'f1-score': 0.07165747482657692, 'support': 160486}, '1': {'precision': 0.3705659347136821, 'recall': 0.7141721125733179, 'f1-score': 0.48794795592185214, 'support': 167251}, '2': {'precision': 0.3686535585557646, 'recall': 0.33587211091088326, 'f1-score': 0.35150017741914286, 'support': 159263}, 'accuracy': 0.3683552361396304, 'macro avg': {'precision': 0.35631364487293166, 'recall': 0.3634136253839078, 'f1-score': 0.30370186938919064, 'support': 487000}, 'weighted avg': {'precision': 0.35648063671346264, 'recall': 0.3683552361396304, 'f1-score': 0.3061412275918043, 'support': 487000}}
[[  6451 102560  51475]
 [  7671 119446  40134]
 [  5443 100328  53492]]
training model: results/universal/W4/deepLOB_L1/h200
Epoch 1/50
9854/9854 - 154s - loss: 3.2234 - accuracy200: 0.4092 - val_loss: 3.3984 - val_accuracy200: 0.3223 - 154s/epoch - 16ms/step
Epoch 2/50
9854/9854 - 155s - loss: 3.2065 - accuracy200: 0.4194 - val_loss: 3.4518 - val_accuracy200: 0.3248 - 155s/epoch - 16ms/step
Epoch 3/50
9854/9854 - 155s - loss: 3.1975 - accuracy200: 0.4245 - val_loss: 3.4854 - val_accuracy200: 0.3202 - 155s/epoch - 16ms/step
Epoch 4/50
9854/9854 - 153s - loss: 3.1884 - accuracy200: 0.4287 - val_loss: 3.5094 - val_accuracy200: 0.3218 - 153s/epoch - 16ms/step
Epoch 5/50
9854/9854 - 155s - loss: 3.1832 - accuracy200: 0.4307 - val_loss: 3.6181 - val_accuracy200: 0.3223 - 155s/epoch - 16ms/step
Epoch 6/50
9854/9854 - 151s - loss: 3.1786 - accuracy200: 0.4327 - val_loss: 3.5500 - val_accuracy200: 0.3259 - 151s/epoch - 15ms/step
Epoch 7/50
9854/9854 - 151s - loss: 3.1750 - accuracy200: 0.4341 - val_loss: 3.5632 - val_accuracy200: 0.3332 - 151s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 154s - loss: 3.1712 - accuracy200: 0.4355 - val_loss: 3.5687 - val_accuracy200: 0.3326 - 154s/epoch - 16ms/step
Epoch 9/50
9854/9854 - 152s - loss: 3.1677 - accuracy200: 0.4368 - val_loss: 3.6234 - val_accuracy200: 0.3310 - 152s/epoch - 15ms/step
Epoch 10/50
9854/9854 - 153s - loss: 3.1650 - accuracy200: 0.4377 - val_loss: 3.7432 - val_accuracy200: 0.3357 - 153s/epoch - 16ms/step
Epoch 11/50
9854/9854 - 153s - loss: 3.1626 - accuracy200: 0.4393 - val_loss: 3.6870 - val_accuracy200: 0.3349 - 153s/epoch - 16ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 121s - 121s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1066973
{'0': {'precision': 0.31531558443850916, 'recall': 0.12894038970240382, 'f1-score': 0.18303373146692528, 'support': 1800964}, '1': {'precision': 0.40457615456173934, 'recall': 0.8723591279330475, 'f1-score': 0.5527855737315734, 'support': 2412934}, '2': {'precision': 0.3543587340930387, 'recall': 0.02524205577443045, 'f1-score': 0.04712710388856646, 'support': 1857733}, 'accuracy': 0.39265479078026977, 'macro avg': {'precision': 0.3580834910310957, 'recall': 0.34218052446996056, 'f1-score': 0.26098213636235507, 'support': 6071631}, 'weighted avg': {'precision': 0.36273473952993096, 'recall': 0.39265479078026977, 'f1-score': 0.2883939822450077, 'support': 6071631}}
[[ 232217 1529299   39448]
 [ 261998 2104945   45991]
 [ 242244 1568596   46893]]
Evaluating performance on  train set...
9854/9854 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1349614
{'0': {'precision': 0.33809382183468745, 'recall': 0.14504202742842698, 'f1-score': 0.2029980323535155, 'support': 838619}, '1': {'precision': 0.33108547212642025, 'recall': 0.7785467373972625, 'f1-score': 0.4645963084188127, 'support': 844142}, '2': {'precision': 0.32889525765285976, 'recall': 0.06946374058990203, 'f1-score': 0.11470203991689228, 'support': 839258}, 'accuracy': 0.3319312820403018, 'macro avg': {'precision': 0.3326915172046558, 'recall': 0.3310175018051972, 'f1-score': 0.2607654602297402, 'support': 2522019}, 'weighted avg': {'precision': 0.3326870382547269, 'recall': 0.3319312820403018, 'f1-score': 0.2611748240168363, 'support': 2522019}}
[[121635 662431  54553]
 [122535 657204  64403]
 [115597 665363  58298]]
Evaluating performance on  val set...
3566/3566 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1324455
{'0': {'precision': 0.2844072586761618, 'recall': 0.11817862142634404, 'f1-score': 0.1669748464374184, 'support': 301442}, '1': {'precision': 0.3254350082509543, 'recall': 0.73570384771371, 'f1-score': 0.4512581674022553, 'support': 310678}, '2': {'precision': 0.34721304511987916, 'recall': 0.09801420235018253, 'f1-score': 0.1528738856679758, 'support': 300232}, 'accuracy': 0.3218253481112553, 'macro avg': {'precision': 0.31901843734899843, 'recall': 0.31729889049674553, 'f1-score': 0.25703563316921646, 'support': 912352}, 'weighted avg': {'precision': 0.3190460012425918, 'recall': 0.3218253481112553, 'f1-score': 0.2591399471189342, 'support': 912352}}
[[ 35624 236679  29139]
 [ 55925 228567  26186]
 [ 33708 237097  29427]]
testing model out of sample: results/universal/W4/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 67s - 67s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1430768
{'0': {'precision': 0.35137713507460944, 'recall': 0.15558869325104313, 'f1-score': 0.21567650610737396, 'support': 1062905}, '1': {'precision': 0.3092924966583333, 'recall': 0.7807874913160818, 'f1-score': 0.4430715455982036, 'support': 937077}, '2': {'precision': 0.35353752462833604, 'recall': 0.06696295291084271, 'f1-score': 0.11259876208676801, 'support': 1031660}, 'accuracy': 0.3186777990277216, 'macro avg': {'precision': 0.3380690521204263, 'recall': 0.33444637915932257, 'f1-score': 0.25711560459744853, 'support': 3031642}, 'weighted avg': {'precision': 0.3391039975385114, 'recall': 0.3186777990277216, 'f1-score': 0.2508869551065137, 'support': 3031642}}
[[165376 829518  68011]
 [147108 731658  58311]
 [158167 804410  69083]]
Evaluating performance on  train set...
5528/5528 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1332076
{'0': {'precision': 0.3492361537461853, 'recall': 0.16668092551321154, 'f1-score': 0.22566031507485962, 'support': 467546}, '1': {'precision': 0.33070033025598256, 'recall': 0.7774963874765854, 'f1-score': 0.46403009140366075, 'support': 467125}, '2': {'precision': 0.3489546401942457, 'recall': 0.0676958605065101, 'f1-score': 0.11339376578671288, 'support': 479793}, 'accuracy': 0.33482577145830505, 'macro avg': {'precision': 0.3429637080654711, 'recall': 0.3372910578321024, 'f1-score': 0.26769472408841105, 'support': 1414464}, 'weighted avg': {'precision': 0.343019230035517, 'recall': 0.33482577145830505, 'f1-score': 0.2663002870253535, 'support': 1414464}}
[[ 77931 360526  29089]
 [ 72428 363188  31509]
 [ 72788 374525  32480]]
Evaluating performance on  val set...
1908/1908 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1360353
{'0': {'precision': 0.34318485002681776, 'recall': 0.1499522272899353, 'f1-score': 0.20871005244097254, 'support': 166413}, '1': {'precision': 0.3236628911080965, 'recall': 0.7523476036396562, 'f1-score': 0.4526108280558069, 'support': 157927}, '2': {'precision': 0.35127389867380665, 'recall': 0.1028497583860556, 'f1-score': 0.15911276606832386, 'support': 163277}, 'accuracy': 0.329280972566584, 'macro avg': {'precision': 0.3393738799362403, 'recall': 0.33504986310521573, 'f1-score': 0.2734778821883677, 'support': 487617}, 'weighted avg': {'precision': 0.33957076600139924, 'recall': 0.329280972566584, 'f1-score': 0.27109594477749277, 'support': 487617}}
[[ 24954 125997  15462]
 [ 23560 118816  15551]
 [ 24199 122285  16793]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1577307
{'0': {'precision': 0.3431318377721295, 'recall': 0.12521928497973506, 'f1-score': 0.1834808172430604, 'support': 49593}, '1': {'precision': 0.28158092067962764, 'recall': 0.7899030321686933, 'f1-score': 0.41516557005716753, 'support': 38982}, '2': {'precision': 0.35296674635948705, 'recall': 0.06755548160319474, 'f1-score': 0.11340584137846756, 'support': 48079}, 'accuracy': 0.2945394939043131, 'macro avg': {'precision': 0.3258931682704147, 'recall': 0.32755926625054105, 'f1-score': 0.23735074289289848, 'support': 136654}, 'weighted avg': {'precision': 0.3290340047037353, 'recall': 0.2945394939043131, 'f1-score': 0.22491685475096918, 'support': 136654}}
[[ 6210 40216  3167]
 [ 5403 30792  2787]
 [ 6485 38346  3248]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.139404
{'0': {'precision': 0.3428598556779339, 'recall': 0.16723012087250497, 'f1-score': 0.22480933852140078, 'support': 21593}, '1': {'precision': 0.3293600878506539, 'recall': 0.7686501095009552, 'f1-score': 0.461129902440388, 'support': 21461}, '2': {'precision': 0.3466080111136837, 'recall': 0.06841239374828627, 'f1-score': 0.11427044769283615, 'support': 21882}, 'accuracy': 0.332696809165948, 'macro avg': {'precision': 0.3396093182140905, 'recall': 0.33476420804058216, 'f1-score': 0.26673656288487496, 'support': 64936}, 'weighted avg': {'precision': 0.3396613004836475, 'recall': 0.332696809165948, 'f1-score': 0.26566284987342015, 'support': 64936}}
[[ 3611 16554  1428]
 [ 3571 16496  1394]
 [ 3350 17035  1497]]
Evaluating performance on  val set...
81/81 - 1s - 621ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1504558
{'0': {'precision': 0.3152542372881356, 'recall': 0.012474849094567404, 'f1-score': 0.023999999999999997, 'support': 7455}, '1': {'precision': 0.28824246277751286, 'recall': 0.9179885251434357, 'f1-score': 0.4387273680390339, 'support': 5926}, '2': {'precision': 0.32988267770876467, 'recall': 0.06605859590934218, 'f1-score': 0.11007484168105933, 'support': 7236}, 'accuracy': 0.2915555124411893, 'macro avg': {'precision': 0.3111264592581377, 'recall': 0.3321739900491151, 'f1-score': 0.19093406990669773, 'support': 20617}, 'weighted avg': {'precision': 0.31262435025965046, 'recall': 0.2915555124411893, 'f1-score': 0.1734161098803638, 'support': 20617}}
[[  93 6807  555]
 [  70 5440  416]
 [ 132 6626  478]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
1613/1613 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205255
{'0': {'precision': 0.28988545332035637, 'recall': 0.03015905160998863, 'f1-score': 0.054634091277876155, 'support': 128386}, '1': {'precision': 0.3748411486421546, 'recall': 0.916330553053739, 'f1-score': 0.5320413955656269, 'support': 153222}, '2': {'precision': 0.27627567394094993, 'recall': 0.0524759793052476, 'f1-score': 0.08819932252879893, 'support': 131241}, 'accuracy': 0.3661411315032857, 'macro avg': {'precision': 0.3136674253011536, 'recall': 0.33298852798965844, 'f1-score': 0.2249582697907673, 'support': 412849}, 'weighted avg': {'precision': 0.3170889114686476, 'recall': 0.3661411315032857, 'f1-score': 0.24248591238481867, 'support': 412849}}
[[  3872 115530   8984]
 [  3763 140402   9057]
 [  5722 118632   6887]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1262476
{'0': {'precision': 0.40027519779841764, 'recall': 0.1070942090343482, 'f1-score': 0.16897808628977215, 'support': 54326}, '1': {'precision': 0.335192951406256, 'recall': 0.8061292471685543, 'f1-score': 0.4735014212651705, 'support': 54036}, '2': {'precision': 0.337251356238698, 'recall': 0.11087990487514864, 'f1-score': 0.16689038031319908, 'support': 53824}, 'accuracy': 0.34125016955840826, 'macro avg': {'precision': 0.35757316848112386, 'recall': 0.341367787026017, 'f1-score': 0.2697899626227139, 'support': 162186}, 'weighted avg': {'precision': 0.357676086197187, 'recall': 0.34125016955840826, 'f1-score': 0.2697442081637166, 'support': 162186}}
[[ 5818 42824  5684]
 [ 4432 43560  6044]
 [ 4285 43571  5968]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069616
{'0': {'precision': 0.4090909090909091, 'recall': 0.0005627462014631402, 'f1-score': 0.001123946300343428, 'support': 15993}, '1': {'precision': 0.38539053441551596, 'recall': 0.905762275182084, 'f1-score': 0.5407140110621432, 'support': 20183}, '2': {'precision': 0.3244832163853594, 'recall': 0.10335870484475052, 'f1-score': 0.15677830210290006, 'support': 16554}, 'accuracy': 0.37930969087805805, 'macro avg': {'precision': 0.3729882199639281, 'recall': 0.3365612420760992, 'f1-score': 0.23287208648846222, 'support': 52730}, 'weighted avg': {'precision': 0.3734576755024181, 'recall': 0.37930969087805805, 'f1-score': 0.25652406924824656, 'support': 52730}}
[[    9 14318  1666]
 [    6 18281  1896]
 [    7 14836  1711]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110353
{'0': {'precision': 0.28580882879015523, 'recall': 0.2031659249841068, 'f1-score': 0.23750353007624964, 'support': 78650}, '1': {'precision': 0.3900832504319598, 'recall': 0.7374756243627689, 'f1-score': 0.5102649539575294, 'support': 101023}, '2': {'precision': 0.3426124197002141, 'recall': 0.02837808338790657, 'f1-score': 0.05241473156349616, 'support': 73296}, 'accuracy': 0.3658985883645822, 'macro avg': {'precision': 0.33950149964077636, 'recall': 0.3230065442449274, 'f1-score': 0.2667277385324251, 'support': 252969}, 'weighted avg': {'precision': 0.3439091924586826, 'recall': 0.3658985883645822, 'f1-score': 0.2928024352739922, 'support': 252969}}
[[15979 60975  1696]
 [24226 74502  2295]
 [15703 55513  2080]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1297741
{'0': {'precision': 0.33941502868428475, 'recall': 0.12635227392080664, 'f1-score': 0.18415144402490052, 'support': 28563}, '1': {'precision': 0.3181754621472719, 'recall': 0.7971552690582959, 'f1-score': 0.4548162066001719, 'support': 28544}, '2': {'precision': 0.34675767918088735, 'recall': 0.05177509767283846, 'f1-score': 0.09009754655631097, 'support': 29435}, 'accuracy': 0.32223660188116754, 'macro avg': {'precision': 0.3347827233374813, 'recall': 0.325094213550647, 'f1-score': 0.24302173239379446, 'support': 86542}, 'weighted avg': {'precision': 0.33490702944848016, 'recall': 0.32223660188116754, 'f1-score': 0.24143436458324924, 'support': 86542}}
[[ 3609 23633  1321]
 [ 4240 22754  1550]
 [ 2784 25127  1524]]
Evaluating performance on  val set...
124/124 - 1s - 816ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.147748
{'0': {'precision': 0.33459072048283667, 'recall': 0.25645720894371626, 'f1-score': 0.2903595395275247, 'support': 10376}, '1': {'precision': 0.33015667099091905, 'recall': 0.6522424839822573, 'f1-score': 0.43840063603537943, 'support': 10145}, '2': {'precision': 0.3717839977381962, 'recall': 0.11942602851693761, 'f1-score': 0.18078086334891394, 'support': 11011}, 'accuracy': 0.3359444373969301, 'macro avg': {'precision': 0.34551046307065064, 'recall': 0.3427085738143037, 'f1-score': 0.30318034630393936, 'support': 31532}, 'weighted avg': {'precision': 0.34615204687390794, 'recall': 0.3359444373969301, 'f1-score': 0.29972482307025916, 'support': 31532}}
[[2661 6545 1170]
 [2476 6617 1052]
 [2816 6880 1315]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1274301
{'0': {'precision': 0.30821376738375617, 'recall': 0.22517347363334989, 'f1-score': 0.2602295641383589, 'support': 74507}, '1': {'precision': 0.3861690450054885, 'recall': 0.7960626803190587, 'f1-score': 0.5200583920025131, 'support': 88385}, '2': {'precision': 0.4098360655737705, 'recall': 0.0003387442074740522, 'f1-score': 0.0006769289089259846, 'support': 73802}, 'accuracy': 0.3682476108393115, 'macro avg': {'precision': 0.36807295932100503, 'recall': 0.34052496605329424, 'f1-score': 0.26032162834993267, 'support': 236694}, 'weighted avg': {'precision': 0.36900958841688863, 'recall': 0.3682476108393115, 'f1-score': 0.27632404632029284, 'support': 236694}}
[[16777 57719    11]
 [18000 70360    25]
 [19656 54121    25]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1449015
{'0': {'precision': 0.30951143451143454, 'recall': 0.23867735470941884, 'f1-score': 0.2695179904955872, 'support': 29940}, '1': {'precision': 0.3121344790407423, 'recall': 0.6514268180423443, 'f1-score': 0.42204428737092053, 'support': 29331}, '2': {'precision': 0.3395032802249297, 'recall': 0.04945561281955015, 'f1-score': 0.08633479310036643, 'support': 29299}, 'accuracy': 0.31276956079936774, 'macro avg': {'precision': 0.3203830645923688, 'recall': 0.31318659519043773, 'f1-score': 0.25929902365562474, 'support': 88570}, 'weighted avg': {'precision': 0.3203014041021404, 'recall': 0.31276956079936774, 'f1-score': 0.2594317797376311, 'support': 88570}}
[[ 7146 21222  1572]
 [ 8977 19107  1247]
 [ 6965 20885  1449]]
Evaluating performance on  val set...
127/127 - 1s - 811ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1485192
{'0': {'precision': 0.4027450980392157, 'recall': 0.09295800144822593, 'f1-score': 0.15105162523900575, 'support': 11048}, '1': {'precision': 0.31550310368610623, 'recall': 0.8555694098088114, 'f1-score': 0.4610044230446224, 'support': 9624}, '2': {'precision': 0.367927132210875, 'recall': 0.11492370031899302, 'f1-score': 0.1751412429378531, 'support': 11599}, 'accuracy': 0.3282823587741316, 'macro avg': {'precision': 0.362058444645399, 'recall': 0.3544837038586768, 'f1-score': 0.2623990970738271, 'support': 32271}, 'weighted avg': {'precision': 0.36421296270726905, 'recall': 0.3282823587741316, 'f1-score': 0.2521455238405423, 'support': 32271}}
[[1027 8717 1304]
 [ 404 8234  986]
 [1119 9147 1333]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1181092
{'0': {'precision': 0.34936699932997145, 'recall': 0.07644821013804971, 'f1-score': 0.12544634943145846, 'support': 129591}, '1': {'precision': 0.37700964153861655, 'recall': 0.835950331778464, 'f1-score': 0.5196566116951326, 'support': 152210}, '2': {'precision': 0.3055906660184735, 'recall': 0.100420147930412, 'f1-score': 0.1511657267906742, 'support': 125194}, 'accuracy': 0.36786447007948503, 'macro avg': {'precision': 0.34398910229568713, 'recall': 0.33760622994897527, 'f1-score': 0.26542289597242175, 'support': 406995}, 'weighted avg': {'precision': 0.3462390795716899, 'recall': 0.36786447007948503, 'f1-score': 0.28078647829855385, 'support': 406995}}
[[  9907 105390  14294]
 [ 10696 127240  14274]
 [  7754 104868  12572]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1412748
{'0': {'precision': 0.33855521399858124, 'recall': 0.12617594571371918, 'f1-score': 0.18383757322847283, 'support': 45389}, '1': {'precision': 0.3290294736463522, 'recall': 0.8051662302800942, 'f1-score': 0.46715645285861096, 'support': 45449}, '2': {'precision': 0.3143156790770844, 'recall': 0.06399607097862527, 'f1-score': 0.10634070184153567, 'support': 46831}, 'accuracy': 0.3291808613413332, 'macro avg': {'precision': 0.3273001222406726, 'recall': 0.33177941565747954, 'f1-score': 0.25244490930953983, 'support': 137669}, 'weighted avg': {'precision': 0.32716487170527575, 'recall': 0.3291808613413332, 'f1-score': 0.2510081328779835, 'support': 137669}}
[[ 5727 36545  3117]
 [ 5434 36594  3421]
 [ 5755 38079  2997]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1381456
{'0': {'precision': 0.3598993288590604, 'recall': 0.11244495701404907, 'f1-score': 0.17135325131810192, 'support': 19076}, '1': {'precision': 0.30945627041071727, 'recall': 0.7633776314242032, 'f1-score': 0.4403887579083061, 'support': 17006}, '2': {'precision': 0.33846980827808637, 'recall': 0.10850086157380816, 'f1-score': 0.16432517071897698, 'support': 17410}, 'accuracy': 0.31810364166604355, 'macro avg': {'precision': 0.3359418025159547, 'recall': 0.32810781667068684, 'f1-score': 0.25868905998179503, 'support': 53492}, 'weighted avg': {'precision': 0.33688798874675796, 'recall': 0.31810364166604355, 'f1-score': 0.2545967071964061, 'support': 53492}}
[[ 2145 15010  1921]
 [ 2253 12982  1771]
 [ 1562 13959  1889]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
3782/3782 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1379237
{'0': {'precision': 0.3473566469767141, 'recall': 0.1178355833607727, 'f1-score': 0.17597444867489967, 'support': 318885}, '1': {'precision': 0.3010452638346667, 'recall': 0.7636602696240798, 'f1-score': 0.43184955863280755, 'support': 297377}, '2': {'precision': 0.3725858470878391, 'recall': 0.11168358497540448, 'f1-score': 0.17185360197764216, 'support': 351690}, 'accuracy': 0.3140124716928112, 'macro avg': {'precision': 0.3403292526330733, 'recall': 0.331059812653419, 'f1-score': 0.25989253642844984, 'support': 967952}, 'weighted avg': {'precision': 0.34229536005592553, 'recall': 0.3140124716928112, 'f1-score': 0.2530878923156941, 'support': 967952}}
[[ 37576 251359  29950]
 [ 34090 227095  36192]
 [ 36511 275901  39278]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1313847
{'0': {'precision': 0.3288558019096941, 'recall': 0.05947955390334572, 'f1-score': 0.10073868424966535, 'support': 136652}, '1': {'precision': 0.327113800136774, 'recall': 0.8078128572166051, 'f1-score': 0.4656631013314741, 'support': 135597}, '2': {'precision': 0.3409729557366921, 'recall': 0.12442637615179306, 'f1-score': 0.1823209718670077, 'support': 137503}, 'accuracy': 0.32891602725551067, 'macro avg': {'precision': 0.33231418592772005, 'recall': 0.3305729290905813, 'f1-score': 0.2495742524827157, 'support': 409752}, 'weighted avg': {'precision': 0.3323455586119703, 'recall': 0.32891602725551067, 'f1-score': 0.24887820639303362, 'support': 409752}}
[[  8128 112541  15983]
 [  8975 109537  17085]
 [  7613 112781  17109]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1290084
{'0': {'precision': 0.313426190930484, 'recall': 0.10760765132325967, 'f1-score': 0.1602106666233196, 'support': 45796}, '1': {'precision': 0.32833131011298905, 'recall': 0.7656845451971864, 'f1-score': 0.4595878727673173, 'support': 45921}, '2': {'precision': 0.33653053578119146, 'recall': 0.10105533178821359, 'f1-score': 0.1554355726300488, 'support': 44441}, 'accuracy': 0.32741373991979905, 'macro avg': {'precision': 0.32609601227488816, 'recall': 0.3247825094362199, 'f1-score': 0.2584113706735619, 'support': 136158}, 'weighted avg': {'precision': 0.32599422341840323, 'recall': 0.32741373991979905, 'f1-score': 0.2596208425306006, 'support': 136158}}
[[ 4928 36500  4368]
 [ 6274 35161  4486]
 [ 4521 35429  4491]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
4457/4457 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1508936
{'0': {'precision': 0.39100167077730924, 'recall': 0.18623466439297048, 'f1-score': 0.2522989649042873, 'support': 422220}, '1': {'precision': 0.28880263393440325, 'recall': 0.7366009865894177, 'f1-score': 0.4149240373796046, 'support': 324147}, '2': {'precision': 0.35606991609714694, 'recall': 0.10206491768713, 'f1-score': 0.15865306017935824, 'support': 394592}, 'accuracy': 0.31348453362478407, 'macro avg': {'precision': 0.34529140693628646, 'recall': 0.34163352288983945, 'f1-score': 0.27529202082108334, 'support': 1140959}, 'weighted avg': {'precision': 0.34988599340566656, 'recall': 0.31348453362478407, 'f1-score': 0.26611410158355225, 'support': 1140959}}
[[ 78632 303600  39988]
 [ 52535 238767  32845]
 [ 69937 284381  40274]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1296414
{'0': {'precision': 0.3564232921775537, 'recall': 0.2022398913992049, 'f1-score': 0.2580553364574151, 'support': 206260}, '1': {'precision': 0.3324026351972602, 'recall': 0.7698138271894353, 'f1-score': 0.4643155922657272, 'support': 204756}, '2': {'precision': 0.3727716396665085, 'recall': 0.05244586855870418, 'f1-score': 0.09195450346323783, 'support': 209721}, 'accuracy': 0.33885043101990053, 'macro avg': {'precision': 0.35386585568044077, 'recall': 0.3414998623824481, 'f1-score': 0.2714418107287934, 'support': 620737}, 'weighted avg': {'precision': 0.35402327114299975, 'recall': 0.33885043101990053, 'f1-score': 0.2699737369102879, 'support': 620737}}
[[ 41714 155853   8693]
 [ 37318 157624   9814]
 [ 38003 160719  10999]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1383412
{'0': {'precision': 0.34396559871467725, 'recall': 0.2104365423532813, 'f1-score': 0.26112067728511984, 'support': 69180}, '1': {'precision': 0.3214488564875727, 'recall': 0.6944595455180876, 'f1-score': 0.4394751068953654, 'support': 64381}, '2': {'precision': 0.353627139179161, 'recall': 0.10353083755782504, 'f1-score': 0.16016920086886932, 'support': 67661}, 'accuracy': 0.32935265527626206, 'macro avg': {'precision': 0.3396805314604703, 'recall': 0.336142308476398, 'f1-score': 0.2869216616831182, 'support': 201222}, 'weighted avg': {'precision': 0.34001006258067706, 'recall': 0.32935265527626206, 'f1-score': 0.2842402103726415, 'support': 201222}}
[[14558 48255  6367]
 [13234 44710  6437]
 [14532 46124  7005]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
4676/4676 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1374227
{'0': {'precision': 0.33258344415556307, 'recall': 0.2974869584708807, 'f1-score': 0.3140577206203656, 'support': 392592}, '1': {'precision': 0.35570549242424243, 'recall': 0.7233695298940582, 'f1-score': 0.4769019938629618, 'support': 415417}, '2': {'precision': 0.6500974658869396, 'recall': 0.0017147411177952593, 'f1-score': 0.003420460198048235, 'support': 388980}, 'accuracy': 0.34917447027499837, 'macro avg': {'precision': 0.4461288008222484, 'recall': 0.34085707649424474, 'f1-score': 0.2647933915604585, 'support': 1196989}, 'weighted avg': {'precision': 0.4437890576563561, 'recall': 0.34917447027499837, 'f1-score': 0.2696267341188577, 'support': 1196989}}
[[116791 275698    103]
 [114661 300500    256]
 [119711 268602    667]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293119
{'0': {'precision': 0.3614329384376054, 'recall': 0.18464548112085544, 'f1-score': 0.24442261924467645, 'support': 179934}, '1': {'precision': 0.34569963392836234, 'recall': 0.7252056304818876, 'f1-score': 0.46820821469850304, 'support': 183217}, '2': {'precision': 0.34869723608141284, 'recall': 0.12490213210180531, 'f1-score': 0.18392350653527884, 'support': 176258}, 'accuracy': 0.3487316674360272, 'macro avg': {'precision': 0.3519432694824602, 'recall': 0.34491774790151614, 'f1-score': 0.2988514468261528, 'support': 539409}, 'weighted avg': {'precision': 0.3519273901835574, 'recall': 0.3487316674360272, 'f1-score': 0.30066541985484563, 'support': 539409}}
[[ 33224 126473  20237]
 [ 29464 132870  20883]
 [ 29235 125008  22015]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1350211
{'0': {'precision': 0.3271469242134852, 'recall': 0.1309748813319675, 'f1-score': 0.1870595507933237, 'support': 69311}, '1': {'precision': 0.31348213893955634, 'recall': 0.763751870743105, 'f1-score': 0.44451357440927214, 'support': 65482}, '2': {'precision': 0.3608564499911279, 'recall': 0.0879106628242075, 'f1-score': 0.14137903066958646, 'support': 69400}, 'accuracy': 0.3192616789018233, 'macro avg': {'precision': 0.33382850438138983, 'recall': 0.32754580496642666, 'f1-score': 0.25765071862406075, 'support': 204193}, 'weighted avg': {'precision': 0.3342218171807319, 'recall': 0.3192616789018233, 'f1-score': 0.2540960127574075, 'support': 204193}}
[[ 9078 54580  5653]
 [10317 50012  5153]
 [ 8354 54945  6101]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
4274/4274 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1498681
{'0': {'precision': 0.32835669307332926, 'recall': 0.14355715408866634, 'f1-score': 0.19977355047770673, 'support': 382851}, '1': {'precision': 0.2891709185655029, 'recall': 0.8125313752085185, 'f1-score': 0.4265407187770331, 'support': 320715}, '2': {'precision': 0.41748638162793433, 'recall': 0.027280479591497032, 'f1-score': 0.05121437637013961, 'support': 390499}, 'accuracy': 0.2981587017224754, 'macro avg': {'precision': 0.3450046644222555, 'recall': 0.32778966962956063, 'f1-score': 0.22584288187495982, 'support': 1094065}, 'weighted avg': {'precision': 0.3486823488429656, 'recall': 0.2981587017224754, 'f1-score': 0.21322377825328456, 'support': 1094065}}
[[ 54961 319067   8823]
 [ 54083 260591   6041]
 [ 58338 321508  10653]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1350576
{'0': {'precision': 0.34168304344000233, 'recall': 0.14056871866345683, 'f1-score': 0.19919034570613908, 'support': 165741}, '1': {'precision': 0.33078760659058476, 'recall': 0.7748374921367163, 'f1-score': 0.46364113805953433, 'support': 166915}, '2': {'precision': 0.33627675504272, 'recall': 0.08882413159302947, 'f1-score': 0.14052895056502374, 'support': 171924}, 'accuracy': 0.3327539736018074, 'macro avg': {'precision': 0.33624913502443565, 'recall': 0.3347434474644008, 'f1-score': 0.26778681144356575, 'support': 504580}, 'weighted avg': {'precision': 0.33623676620322146, 'recall': 0.3327539736018074, 'f1-score': 0.2666831165401512, 'support': 504580}}
[[ 23298 127971  14472]
 [ 21914 129332  15669]
 [ 22974 133679  15271]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1286329
{'0': {'precision': 0.34182486221677894, 'recall': 0.09253058382786858, 'f1-score': 0.14563765393446046, 'support': 60326}, '1': {'precision': 0.334044060545784, 'recall': 0.8109444508756553, 'f1-score': 0.47317710971838256, 'support': 60469}, '2': {'precision': 0.34415068648587316, 'recall': 0.10116913224036425, 'f1-score': 0.1563704324289489, 'support': 59959}, 'accuracy': 0.335732542571672, 'macro avg': {'precision': 0.34000653641614537, 'recall': 0.33488138898129605, 'f1-score': 0.2583950653605973, 'support': 180754}, 'weighted avg': {'precision': 0.33999340510438986, 'recall': 0.335732542571672, 'f1-score': 0.2587721351495319, 'support': 180754}}
[[ 5582 49055  5689]
 [ 5561 49037  5871]
 [ 5187 48706  6066]]
testing model on single stock: results/universal/W4/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
12724/12724 - 80s - 80s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0828094
{'0': {'precision': 0.2722767769422838, 'recall': 0.06408006370446902, 'f1-score': 0.10374406643944369, 'support': 886594}, '1': {'precision': 0.44839106376947024, 'recall': 0.936951032304377, 'f1-score': 0.6065223474627858, 'support': 1458533}, '2': {'precision': 0.2789473684210526, 'recall': 0.00023245104274029077, 'f1-score': 0.00046451499813755776, 'support': 912020}, 'accuracy': 0.43706931249955866, 'macro avg': {'precision': 0.33320506971093555, 'recall': 0.3337545156838621, 'f1-score': 0.2369103096334557, 'support': 3257147}, 'weighted avg': {'precision': 0.3530076165234827, 'recall': 0.43706931249955866, 'f1-score': 0.2999666188911194, 'support': 3257147}}
[[  56813  829570     211]
 [  91622 1366574     337]
 [  60224  851584     212]]
Evaluating performance on  train set...
5165/5165 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1388234
{'0': {'precision': 0.3275819186446299, 'recall': 0.15344007200177262, 'f1-score': 0.20898916956276892, 'support': 437767}, '1': {'precision': 0.3280174266001202, 'recall': 0.7979527605376945, 'f1-score': 0.4649189011396092, 'support': 441961}, '2': {'precision': 0.284589506835588, 'recall': 0.02696360997707822, 'f1-score': 0.0492600462122667, 'support': 442374}, 'accuracy': 0.3265731388349764, 'macro avg': {'precision': 0.3133962840267794, 'recall': 0.3261188141721818, 'f1-score': 0.24105603897154826, 'support': 1322102}, 'weighted avg': {'precision': 0.3133422853560511, 'recall': 0.3265731388349764, 'f1-score': 0.2410978486846346, 'support': 1322102}}
[[ 67171 359449  11147]
 [ 70459 352664  18838]
 [ 67421 363025  11928]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1335715
{'0': {'precision': 0.2611379293005481, 'recall': 0.13040666942885482, 'f1-score': 0.1739476306512255, 'support': 159294}, '1': {'precision': 0.3238498521119739, 'recall': 0.6900240753416574, 'f1-score': 0.4408125876445663, 'support': 169468}, '2': {'precision': 0.34922791580400275, 'recall': 0.10233319430225357, 'f1-score': 0.15828470328338368, 'support': 158238}, 'accuracy': 0.31602258726899385, 'macro avg': {'precision': 0.31140523240550827, 'recall': 0.30758797969092194, 'f1-score': 0.2576816405263918, 'support': 487000}, 'weighted avg': {'precision': 0.3115832012088446, 'recall': 0.31602258726899385, 'f1-score': 0.2617229904682993, 'support': 487000}}
[[ 20773 121945  16576]
 [ 38932 116937  13599]
 [ 19843 122202  16193]]
training model: results/universal/W4/deepOF_L1/h50
Epoch 1/50
9854/9854 - 141s - loss: 3.1395 - accuracy50: 0.4535 - val_loss: 3.2193 - val_accuracy50: 0.4166 - 141s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 138s - loss: 3.1213 - accuracy50: 0.4591 - val_loss: 3.2253 - val_accuracy50: 0.4190 - 138s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 135s - loss: 3.1042 - accuracy50: 0.4652 - val_loss: 3.2371 - val_accuracy50: 0.4184 - 135s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 131s - loss: 3.0935 - accuracy50: 0.4690 - val_loss: 3.2582 - val_accuracy50: 0.4177 - 131s/epoch - 13ms/step
Epoch 5/50
9854/9854 - 136s - loss: 3.0841 - accuracy50: 0.4716 - val_loss: 3.2722 - val_accuracy50: 0.4162 - 136s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 139s - loss: 3.0763 - accuracy50: 0.4738 - val_loss: 3.3511 - val_accuracy50: 0.4135 - 139s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 138s - loss: 3.0693 - accuracy50: 0.4760 - val_loss: 3.4138 - val_accuracy50: 0.4119 - 138s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 138s - loss: 3.0633 - accuracy50: 0.4774 - val_loss: 3.4796 - val_accuracy50: 0.4108 - 138s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 135s - loss: 3.0574 - accuracy50: 0.4794 - val_loss: 3.4905 - val_accuracy50: 0.4110 - 135s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 139s - loss: 3.0521 - accuracy50: 0.4808 - val_loss: 3.5279 - val_accuracy50: 0.4122 - 139s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 138s - loss: 3.0474 - accuracy50: 0.4822 - val_loss: 3.5280 - val_accuracy50: 0.4130 - 138s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 130s - 130s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0466709
{'0': {'precision': 0.4123580090719739, 'recall': 0.2270313972341321, 'f1-score': 0.29283630300085295, 'support': 1599281}, '1': {'precision': 0.485178590205169, 'recall': 0.7372003615353462, 'f1-score': 0.5852094092411804, 'support': 2866663}, '2': {'precision': 0.39668961455449137, 'recall': 0.20638339082761245, 'f1-score': 0.2715099068511019, 'support': 1605667}, 'accuracy': 0.4624431637665852, 'macro avg': {'precision': 0.4314087379438781, 'recall': 0.3902050498656969, 'f1-score': 0.3831852063643784, 'support': 6071611}, 'weighted avg': {'precision': 0.4425960861742991, 'recall': 0.4624431637665852, 'f1-score': 0.4252380783002971, 'support': 6071611}}
[[ 363087 1102004  134190]
 [ 383560 2113305  369798]
 [ 133867 1140417  331383]]
Evaluating performance on  train set...
9854/9854 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0672754
{'0': {'precision': 0.4397750527301941, 'recall': 0.2172529785297646, 'f1-score': 0.2908321579689704, 'support': 773536}, '1': {'precision': 0.39552289556139436, 'recall': 0.7209051470249285, 'f1-score': 0.5107977949315361, 'support': 976195}, '2': {'precision': 0.44829106640229616, 'recall': 0.20932223032230413, 'f1-score': 0.28538743459194554, 'support': 772283}, 'accuracy': 0.40977290371901187, 'macro avg': {'precision': 0.42786300489796153, 'recall': 0.3824934519589991, 'f1-score': 0.3623391291641507, 'support': 2522014}, 'weighted avg': {'precision': 0.4252541333456608, 'recall': 0.40977290371901187, 'f1-score': 0.37430690778038817, 'support': 2522014}}
[[168053 536922  68561]
 [142063 703744 130388]
 [ 72018 538609 161656]]
Evaluating performance on  val set...
3566/3566 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.064977
{'0': {'precision': 0.43191471525177444, 'recall': 0.2252026153313785, 'f1-score': 0.2960455277856919, 'support': 274535}, '1': {'precision': 0.40853863120941936, 'recall': 0.720795753205787, 'f1-score': 0.5214981753145488, 'support': 364887}, '2': {'precision': 0.4389475782340044, 'recall': 0.20172060660909327, 'f1-score': 0.2764138249588304, 'support': 272927}, 'accuracy': 0.41638671166406716, 'macro avg': {'precision': 0.4264669748983994, 'recall': 0.38257299171541964, 'f1-score': 0.3646525093530237, 'support': 912349}, 'weighted avg': {'precision': 0.4246694933215572, 'recall': 0.41638671166406716, 'f1-score': 0.38034081220145294, 'support': 912349}}
[[ 61826 188878  23831]
 [ 55339 263009  46539]
 [ 25979 191893  55055]]
testing model out of sample: results/universal/W4/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802149
{'0': {'precision': 0.43158711011545753, 'recall': 0.15174142086069783, 'f1-score': 0.2245377616091917, 'support': 957293}, '1': {'precision': 0.37976088303809713, 'recall': 0.7901166081936737, 'f1-score': 0.5129688930330057, 'support': 1144688}, '2': {'precision': 0.424836976634381, 'recall': 0.1432445427858711, 'f1-score': 0.2142494567984857, 'support': 929641}, 'accuracy': 0.3901752923022725, 'macro avg': {'precision': 0.41206165659597854, 'recall': 0.3617008572800809, 'f1-score': 0.3172520371468944, 'support': 3031622}, 'weighted avg': {'precision': 0.40994850838337776, 'recall': 0.3901752923022725, 'f1-score': 0.33028947636608863, 'support': 3031622}}
[[145261 746812  65220]
 [125185 904437 115066]
 [ 66128 730347 133166]]
Evaluating performance on  train set...
5528/5528 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0606322
{'0': {'precision': 0.40895063331913256, 'recall': 0.19705397868089944, 'f1-score': 0.265956224701486, 'support': 399454}, '1': {'precision': 0.447506709275088, 'recall': 0.7523852216507869, 'f1-score': 0.5612129325485918, 'support': 613465}, '2': {'precision': 0.4190883998194851, 'recall': 0.19889772447096501, 'f1-score': 0.2697656979660496, 'support': 401533}, 'accuracy': 0.43843127939300874, 'macro avg': {'precision': 0.4251819141379019, 'recall': 0.38277897493421714, 'f1-score': 0.3656449517387092, 'support': 1414452}, 'weighted avg': {'precision': 0.4285507688716336, 'recall': 0.43843127939300874, 'f1-score': 0.3950940713783367, 'support': 1414452}}
[[ 78714 285095  35645]
 [ 76846 461562  75057]
 [ 36918 284751  79864]]
Evaluating performance on  val set...
1908/1908 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0673107
{'0': {'precision': 0.4116608594657375, 'recall': 0.18573015573581506, 'f1-score': 0.25597249906115493, 'support': 143127}, '1': {'precision': 0.4267597582431, 'recall': 0.7582075718208755, 'f1-score': 0.5461289469151782, 'support': 202831}, '2': {'precision': 0.42182264909537637, 'recall': 0.18664097079565428, 'f1-score': 0.2587809234834952, 'support': 141657}, 'accuracy': 0.42412559088625246, 'macro avg': {'precision': 0.42008108893473795, 'recall': 0.3768595661174483, 'f1-score': 0.3536274564866095, 'support': 487615}, 'weighted avg': {'precision': 0.4208935807140112, 'recall': 0.42412559088625246, 'f1-score': 0.377483435872112, 'support': 487615}}
[[ 26583 104183  12361]
 [ 25165 153788  23878]
 [ 12827 102391  26439]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1344442
{'0': {'precision': 0.4066912882902455, 'recall': 0.0746992278685581, 'f1-score': 0.12621571965546885, 'support': 50121}, '1': {'precision': 0.2708237824875692, 'recall': 0.8301759316812151, 'f1-score': 0.40841315952164114, 'support': 37003}, '2': {'precision': 0.3854880136986301, 'recall': 0.10909421314057263, 'f1-score': 0.17006074722230968, 'support': 49526}, 'accuracy': 0.2917380168313209, 'macro avg': {'precision': 0.3543343614921483, 'recall': 0.33798979089678194, 'f1-score': 0.2348965421331399, 'support': 136650}, 'weighted avg': {'precision': 0.36221548371914575, 'recall': 0.2917380168313209, 'f1-score': 0.21852176211901317, 'support': 136650}}
[[ 3744 41782  4595]
 [ 2266 30719  4018]
 [ 3196 40927  5403]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1135237
{'0': {'precision': 0.3886986301369863, 'recall': 0.053024994160242936, 'f1-score': 0.09331963001027749, 'support': 21405}, '1': {'precision': 0.33691901408450703, 'recall': 0.8781260037626761, 'f1-score': 0.48698993549043806, 'support': 21793}, '2': {'precision': 0.3569236670502493, 'recall': 0.08561832903938167, 'f1-score': 0.13810760667903524, 'support': 21736}, 'accuracy': 0.34085379000215604, 'macro avg': {'precision': 0.36084710375724754, 'recall': 0.3389231089874336, 'f1-score': 0.23947239072658358, 'support': 64934}, 'weighted avg': {'precision': 0.36068412663673993, 'recall': 0.34085379000215604, 'f1-score': 0.24043467649133915, 'support': 64934}}
[[ 1135 18712  1558]
 [  861 19137  1795]
 [  924 18951  1861]]
Evaluating performance on  val set...
81/81 - 1s - 567ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1217668
{'0': {'precision': 0.3996138996138996, 'recall': 0.056829100892244334, 'f1-score': 0.09950727076072587, 'support': 7285}, '1': {'precision': 0.30165566618189954, 'recall': 0.8773385391247763, 'f1-score': 0.44894901144641, 'support': 6147}, '2': {'precision': 0.4095182138660399, 'recall': 0.09702115812917594, 'f1-score': 0.1568759846950259, 'support': 7184}, 'accuracy': 0.31548311990686845, 'macro avg': {'precision': 0.370262593220613, 'recall': 0.34372959938206554, 'f1-score': 0.23511075563405393, 'support': 20616}, 'weighted avg': {'precision': 0.37385736743893216, 'recall': 0.31548311990686845, 'f1-score': 0.22369019765725826, 'support': 20616}}
[[ 414 6325  546]
 [ 295 5393  459]
 [ 327 6160  697]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
1613/1613 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98494387
{'0': {'precision': 0.42321757332728055, 'recall': 0.23428316137769276, 'f1-score': 0.3016049893060623, 'support': 71627}, '1': {'precision': 0.6853812859809942, 'recall': 0.8504078060407434, 'f1-score': 0.759028174819503, 'support': 268510}, '2': {'precision': 0.4223621103117506, 'recall': 0.23254662485558672, 'f1-score': 0.2999467802022352, 'support': 72708}, 'accuracy': 0.6346982523707445, 'macro avg': {'precision': 0.5103203232066751, 'recall': 0.43907919742467433, 'f1-score': 0.4535266481092668, 'support': 412845}, 'weighted avg': {'precision': 0.5935754061209816, 'recall': 0.6346982523707445, 'f1-score': 0.598816132652095, 'support': 412845}}
[[ 16781  51260   3586]
 [ 20629 228343  19538]
 [  2241  53559  16908]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99865025
{'0': {'precision': 0.43371859061344814, 'recall': 0.28489319194713386, 'f1-score': 0.3438949282083627, 'support': 32535}, '1': {'precision': 0.6400019711068586, 'recall': 0.8042313844883637, 'f1-score': 0.7127790939109279, 'support': 96895}, '2': {'precision': 0.41719143576826195, 'recall': 0.2427036268164611, 'f1-score': 0.3068787153555161, 'support': 32756}, 'accuracy': 0.5866412637342311, 'macro avg': {'precision': 0.49697066582952293, 'recall': 0.4439427344173195, 'f1-score': 0.4545175791582689, 'support': 162186}, 'weighted avg': {'precision': 0.553620830441794, 'recall': 0.5866412637342311, 'f1-score': 0.5568018879184623, 'support': 162186}}
[[ 9269 21061  2205]
 [10068 77926  8901]
 [ 2034 22772  7950]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9826265
{'0': {'precision': 0.3953050034270048, 'recall': 0.26932056969413964, 'f1-score': 0.32037217053187056, 'support': 8566}, '1': {'precision': 0.7065983656543481, 'recall': 0.8221787011807448, 'f1-score': 0.7600194156926023, 'support': 35232}, '2': {'precision': 0.378942014242116, 'recall': 0.2502519314746389, 'f1-score': 0.3014363746712523, 'support': 8931}, 'accuracy': 0.6354946993115743, 'macro avg': {'precision': 0.4936151277744896, 'recall': 0.4472504007831745, 'f1-score': 0.46060932029857504, 'support': 52729}, 'weighted avg': {'precision': 0.6005307782678612, 'recall': 0.6354946993115743, 'f1-score': 0.6109245449116563, 'support': 52729}}
[[ 2307  5755   504]
 [ 3106 28967  3159]
 [  423  6273  2235]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0678567
{'0': {'precision': 0.36279279997872965, 'recall': 0.1920992242823556, 'f1-score': 0.25119198836545714, 'support': 71031}, '1': {'precision': 0.45762177238165863, 'recall': 0.7139527053277733, 'f1-score': 0.5577456809191558, 'support': 115827}, '2': {'precision': 0.3422131147540984, 'recall': 0.17936073335652805, 'f1-score': 0.23536300927993645, 'support': 66107}, 'accuracy': 0.42771529658253116, 'macro avg': {'precision': 0.3875425623714956, 'recall': 0.36180422098888565, 'f1-score': 0.3481002261881831, 'support': 252965}, 'weighted avg': {'precision': 0.4008347984187089, 'recall': 0.42771529658253116, 'f1-score': 0.38741948318494107, 'support': 252965}}
[[13645 50344  7042]
 [17383 82695 15749]
 [ 6583 47667 11857]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967981
{'0': {'precision': 0.42836890016415463, 'recall': 0.19993034999129375, 'f1-score': 0.272621506754992, 'support': 28715}, '1': {'precision': 0.32780939070247245, 'recall': 0.687534896705751, 'f1-score': 0.44394871448207485, 'support': 28656}, '2': {'precision': 0.4246701442160172, 'recall': 0.18979053104323082, 'f1-score': 0.26233858547565453, 'support': 29169}, 'accuracy': 0.35797319158770513, 'macro avg': {'precision': 0.3936161450275481, 'recall': 0.35908525924675855, 'f1-score': 0.3263029355709071, 'support': 86540}, 'weighted avg': {'precision': 0.39382392309707365, 'recall': 0.35797319158770513, 'f1-score': 0.3258871634898001, 'support': 86540}}
[[ 5741 19926  3048]
 [ 4502 19702  4452]
 [ 3159 20474  5536]]
Evaluating performance on  val set...
124/124 - 1s - 821ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1001015
{'0': {'precision': 0.39642922208052467, 'recall': 0.20931127356675644, 'f1-score': 0.2739691532892666, 'support': 10396}, '1': {'precision': 0.3219955716775804, 'recall': 0.6604502850516958, 'f1-score': 0.4329237395490245, 'support': 10349}, '2': {'precision': 0.4358388704318937, 'recall': 0.19458607583202003, 'f1-score': 0.26905082355957183, 'support': 10787}, 'accuracy': 0.3523404795128758, 'macro avg': {'precision': 0.3847545547299996, 'recall': 0.3547825448168241, 'f1-score': 0.325314572132621, 'support': 31532}, 'weighted avg': {'precision': 0.3854815507861617, 'recall': 0.3523404795128758, 'f1-score': 0.3244564991730677, 'support': 31532}}
[[2176 6991 1229]
 [2026 6835 1488]
 [1287 7401 2099]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0766959
{'0': {'precision': 0.42882282115402426, 'recall': 0.1260944755368547, 'f1-score': 0.19488377476823351, 'support': 73437}, '1': {'precision': 0.41008019490407066, 'recall': 0.8509558165253568, 'f1-score': 0.5534498998167589, 'support': 94945}, '2': {'precision': 0.40213542819207787, 'recall': 0.10641506119341805, 'f1-score': 0.1682950546397481, 'support': 68308}, 'accuracy': 0.4111834044530821, 'macro avg': {'precision': 0.4136794814167242, 'recall': 0.36115511775187653, 'f1-score': 0.3055429097415801, 'support': 236690}, 'weighted avg': {'precision': 0.4136025706671153, 'recall': 0.4111834044530821, 'f1-score': 0.33104431576361, 'support': 236690}}
[[ 9260 60420  3757]
 [ 7101 80794  7050]
 [ 5233 55806  7269]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.098825
{'0': {'precision': 0.40145015105740184, 'recall': 0.10953213096376406, 'f1-score': 0.17210651745933064, 'support': 30329}, '1': {'precision': 0.3285647825075599, 'recall': 0.779875081955899, 'f1-score': 0.4623426040526579, 'support': 28979}, '2': {'precision': 0.43892267593397044, 'recall': 0.1726530193773282, 'f1-score': 0.24782320767211988, 'support': 29261}, 'accuracy': 0.3497160406011133, 'macro avg': {'precision': 0.3896458698329774, 'recall': 0.3540200774323304, 'f1-score': 0.29409077639470277, 'support': 88569}, 'weighted avg': {'precision': 0.3899826901535574, 'recall': 0.3497160406011133, 'f1-score': 0.2920841352003513, 'support': 88569}}
[[ 3322 23905  3102]
 [ 3023 22600  3356]
 [ 1930 22279  5052]]
Evaluating performance on  val set...
127/127 - 1s - 801ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0904105
{'0': {'precision': 0.4184563758389262, 'recall': 0.11346678798908098, 'f1-score': 0.17852541159627774, 'support': 10990}, '1': {'precision': 0.3278453258919673, 'recall': 0.7821207798383262, 'f1-score': 0.46202247191011236, 'support': 10515}, '2': {'precision': 0.47015457788347204, 'recall': 0.1836507199256851, 'f1-score': 0.2641282565130261, 'support': 10765}, 'accuracy': 0.3547567400061977, 'macro avg': {'precision': 0.4054854265381218, 'recall': 0.3597460959176974, 'f1-score': 0.30155871333980544, 'support': 32270}, 'weighted avg': {'precision': 0.40617735367646146, 'recall': 0.3547567400061977, 'f1-score': 0.2994577392916223, 'support': 32270}}
[[1247 8697 1046]
 [1109 8224 1182]
 [ 624 8164 1977]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0792726
{'0': {'precision': 0.37194573833455913, 'recall': 0.15178243905692468, 'f1-score': 0.21558829101932553, 'support': 119948}, '1': {'precision': 0.4126036762118597, 'recall': 0.7272560809932781, 'f1-score': 0.5265007921693895, 'support': 169298}, '2': {'precision': 0.36540460780039574, 'recall': 0.18507792262941103, 'f1-score': 0.24570562004250693, 'support': 117745}, 'accuracy': 0.40079756063401895, 'macro avg': {'precision': 0.38331800744893824, 'recall': 0.3547054808932046, 'f1-score': 0.329264901077074, 'support': 406991}, 'weighted avg': {'precision': 0.3869660266259616, 'recall': 0.40079756063401895, 'f1-score': 0.3536331851952116, 'support': 406991}}
[[ 18206  89721  12021]
 [ 20350 123123  25825]
 [ 10392  85561  21792]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1002127
{'0': {'precision': 0.4180112570356473, 'recall': 0.1696692776327241, 'f1-score': 0.24136810338156778, 'support': 45960}, '1': {'precision': 0.3268443351655609, 'recall': 0.7090680655968965, 'f1-score': 0.447441077675237, 'support': 45368}, '2': {'precision': 0.42061294866190685, 'recall': 0.18688361855024924, 'f1-score': 0.25878556060243846, 'support': 46339}, 'accuracy': 0.3532219050317069, 'macro avg': {'precision': 0.3884895136210383, 'recall': 0.3552069872599566, 'f1-score': 0.3158649138864144, 'support': 137667}, 'weighted avg': {'precision': 0.38884303863085284, 'recall': 0.3532219050317069, 'f1-score': 0.31514196529410393, 'support': 137667}}
[[ 7798 33255  4907]
 [ 6177 32169  7022]
 [ 4680 32999  8660]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0933592
{'0': {'precision': 0.41566554541086015, 'recall': 0.1486935594774238, 'f1-score': 0.21903355138214817, 'support': 17452}, '1': {'precision': 0.34771997111050235, 'recall': 0.7476705579950733, 'f1-score': 0.47467999388036114, 'support': 18674}, '2': {'precision': 0.413953488372093, 'recall': 0.16913331413763316, 'f1-score': 0.24014717906786587, 'support': 17365}, 'accuracy': 0.3644351386214503, 'macro avg': {'precision': 0.39244633496448517, 'recall': 0.3551658105367101, 'f1-score': 0.31128690811012505, 'support': 53491}, 'weighted avg': {'precision': 0.3913895826327653, 'recall': 0.3644351386214503, 'f1-score': 0.31513532199728184, 'support': 53491}}
[[ 2595 13195  1662]
 [ 2216 13962  2496]
 [ 1432 12996  2937]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/EXC
Evaluating performance on  test set...
3782/3782 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0167415
{'0': {'precision': 0.42343641932615356, 'recall': 0.2890935583097983, 'f1-score': 0.34360025549269196, 'support': 222364}, '1': {'precision': 0.5579071812906155, 'recall': 0.7331158308836414, 'f1-score': 0.6336224574014231, 'support': 507887}, '2': {'precision': 0.4577534858080217, 'recall': 0.2864529211559254, 'f1-score': 0.35238832117543856, 'support': 237697}, 'accuracy': 0.5214257377462426, 'macro avg': {'precision': 0.4796990288082636, 'recall': 0.4362207701164551, 'f1-score': 0.44320367802318456, 'support': 967948}, 'weighted avg': {'precision': 0.5024210503532184, 'recall': 0.5214257377462426, 'f1-score': 0.4979343756204381, 'support': 967948}}
[[ 64284 142337  15743]
 [ 70633 372340  64914]
 [ 16898 152710  68089]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0420263
{'0': {'precision': 0.4277966956741077, 'recall': 0.30500031471140965, 'f1-score': 0.356109877534737, 'support': 111213}, '1': {'precision': 0.48928678974311457, 'recall': 0.6766686065446857, 'f1-score': 0.5679205418497366, 'support': 187297}, '2': {'precision': 0.44235238121902737, 'recall': 0.2840614886731392, 'f1-score': 0.3459605636270077, 'support': 111240}, 'accuracy': 0.4692056131787675, 'macro avg': {'precision': 0.4531452888787499, 'recall': 0.4219101366430782, 'f1-score': 0.4233303276704938, 'support': 409750}, 'weighted avg': {'precision': 0.4598554744632709, 'recall': 0.4692056131787675, 'f1-score': 0.45017331210486683, 'support': 409750}}
[[ 33920  65912  11381]
 [ 32105 126738  28454]
 [ 13265  66376  31599]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0264506
{'0': {'precision': 0.41357490960540794, 'recall': 0.31162639185027247, 'f1-score': 0.3554347091805715, 'support': 33768}, '1': {'precision': 0.544500534370239, 'recall': 0.6927071279796343, 'f1-score': 0.6097269081418296, 'support': 69136}, '2': {'precision': 0.4310193321616872, 'recall': 0.29500210500992363, 'f1-score': 0.350269575463277, 'support': 33254}, 'accuracy': 0.50106493926174, 'macro avg': {'precision': 0.463031592045778, 'recall': 0.43311187494661013, 'f1-score': 0.4384770642618927, 'support': 136158}, 'weighted avg': {'precision': 0.4843145710386537, 'recall': 0.50106493926174, 'f1-score': 0.48329340357054956, 'support': 136158}}
[[10523 20160  3085]
 [11380 47891  9865]
 [ 3541 19903  9810]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/AAL
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0547894
{'0': {'precision': 0.4238839336374572, 'recall': 0.2320554395904776, 'f1-score': 0.2999197077361596, 'support': 321936}, '1': {'precision': 0.4650347488143543, 'recall': 0.7674797896831705, 'f1-score': 0.5791489837523299, 'support': 509517}, '2': {'precision': 0.4218819405745483, 'recall': 0.16877758463596357, 'f1-score': 0.2411007082509271, 'support': 309502}, 'accuracy': 0.45399511812472887, 'macro avg': {'precision': 0.4369335410087866, 'recall': 0.38943760463653726, 'f1-score': 0.37338979991313886, 'support': 1140955}, 'weighted avg': {'precision': 0.4417176072175113, 'recall': 0.45399511812472887, 'f1-score': 0.4086597238185228, 'support': 1140955}}
[[ 74707 223085  24144]
 [ 71035 391044  47438]
 [ 30502 226763  52237]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0339357
{'0': {'precision': 0.3779950038014554, 'recall': 0.2337807155428372, 'f1-score': 0.28888999568350104, 'support': 148866}, '1': {'precision': 0.5407927603108618, 'recall': 0.7466134224863794, 'f1-score': 0.6272505741028261, 'support': 323040}, '2': {'precision': 0.3850359224944967, 'recall': 0.2138979224339506, 'f1-score': 0.27501663023852513, 'support': 148828}, 'accuracy': 0.4959000151433625, 'macro avg': {'precision': 0.4346078955356047, 'recall': 0.3980973534877224, 'f1-score': 0.39705240000828407, 'support': 620734}, 'weighted avg': {'precision': 0.46440572580161427, 'recall': 0.4959000151433625, 'f1-score': 0.461652009718714, 'support': 620734}}
[[ 34802 101744  12320]
 [ 43330 241186  38524]
 [ 13938 103056  31834]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0383494
{'0': {'precision': 0.38382912252105406, 'recall': 0.22615951018448116, 'f1-score': 0.2846171278926296, 'support': 49978}, '1': {'precision': 0.5264954564499179, 'recall': 0.7526511134676565, 'f1-score': 0.6195809000343525, 'support': 101844}, '2': {'precision': 0.39391971890157734, 'recall': 0.20878542510121456, 'f1-score': 0.27291851342233037, 'support': 49400}, 'accuracy': 0.4883660832314558, 'macro avg': {'precision': 0.43474809929084973, 'recall': 0.3958653495844507, 'f1-score': 0.39237218044977085, 'support': 201222}, 'weighted avg': {'precision': 0.4585137274541581, 'recall': 0.4883660832314558, 'f1-score': 0.4512795149833495, 'support': 201222}}
[[11303 34453  4222]
 [13544 76653 11647]
 [ 4601 34485 10314]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/WBA
Evaluating performance on  test set...
4676/4676 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0514464
{'0': {'precision': 0.49097377054622104, 'recall': 0.2507253869907812, 'f1-score': 0.3319394052739854, 'support': 353949}, '1': {'precision': 0.4363255676165005, 'recall': 0.7569390412697893, 'f1-score': 0.5535601313800521, 'support': 488396}, '2': {'precision': 0.4759740298171789, 'recall': 0.22677080983532596, 'f1-score': 0.3071869336119159, 'support': 354640}, 'accuracy': 0.45017439650455104, 'macro avg': {'precision': 0.4677577893266334, 'recall': 0.41147841269863217, 'f1-score': 0.3975621567553178, 'support': 1196985}, 'weighted avg': {'precision': 0.4642320220947272, 'recall': 0.45017439650455104, 'f1-score': 0.4150318914764543, 'support': 1196985}}
[[ 88744 234491  30714]
 [ 60883 369686  57827]
 [ 31124 243094  80422]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0510474
{'0': {'precision': 0.4565147180954139, 'recall': 0.24871332424229095, 'f1-score': 0.32199880403698533, 'support': 159131}, '1': {'precision': 0.4395915481467381, 'recall': 0.7259699374407753, 'f1-score': 0.5475991659877474, 'support': 222669}, '2': {'precision': 0.4712347465904143, 'recall': 0.25408769915041846, 'f1-score': 0.33015647929823405, 'support': 157607}, 'accuracy': 0.44729675365725696, 'macro avg': {'precision': 0.4557803376108554, 'recall': 0.4095903202778282, 'f1-score': 0.3999181497743223, 'support': 539407}, 'weighted avg': {'precision': 0.4538297588748436, 'recall': 0.44729675365725696, 'f1-score': 0.4175109381400167, 'support': 539407}}
[[ 39578 104119  15434]
 [ 31517 161651  29501]
 [ 15601 101960  40046]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.060771
{'0': {'precision': 0.4661506469500924, 'recall': 0.25413320736891826, 'f1-score': 0.3289379827582693, 'support': 63510}, '1': {'precision': 0.39971109129367716, 'recall': 0.7045206547155105, 'f1-score': 0.5100464114585047, 'support': 76980}, '2': {'precision': 0.4810541226465207, 'recall': 0.25589061739635494, 'f1-score': 0.3340745370892211, 'support': 63703}, 'accuracy': 0.4244758635212764, 'macro avg': {'precision': 0.44897195363009673, 'recall': 0.40484815982692784, 'f1-score': 0.39101964376866505, 'support': 204193}, 'weighted avg': {'precision': 0.44575268579500255, 'recall': 0.4244758635212764, 'f1-score': 0.39881765915211603, 'support': 204193}}
[[16140 40600  6770]
 [11931 54234 10815]
 [ 6553 40849 16301]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
4274/4274 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1032134
{'0': {'precision': 0.5405136186770428, 'recall': 0.0880846757318196, 'f1-score': 0.1514829653636695, 'support': 394257}, '1': {'precision': 0.29205850407567147, 'recall': 0.884741073909974, 'f1-score': 0.43915065806320674, 'support': 313043}, '2': {'precision': 0.516705316499184, 'recall': 0.10888378093965007, 'f1-score': 0.17986511824576842, 'support': 386761}, 'accuracy': 0.3233841623090486, 'macro avg': {'precision': 0.4497591464172994, 'recall': 0.3605698435271479, 'f1-score': 0.2568329138908816, 'support': 1094061}, 'weighted avg': {'precision': 0.46100684784912016, 'recall': 0.3233841623090486, 'f1-score': 0.243826506863252, 'support': 1094061}}
[[ 34728 342220  17309]
 [ 14001 276962  22080]
 [ 15521 329128  42112]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.069939
{'0': {'precision': 0.4486958116223278, 'recall': 0.19004841173272582, 'f1-score': 0.2670049238239426, 'support': 154508}, '1': {'precision': 0.40307305942238364, 'recall': 0.7669982734522733, 'f1-score': 0.5284401591013289, 'support': 194608}, '2': {'precision': 0.4631279152559613, 'recall': 0.20501604904123863, 'f1-score': 0.28421615837346176, 'support': 155461}, 'accuracy': 0.4171811239909865, 'macro avg': {'precision': 0.43829892876689086, 'recall': 0.38735424474207925, 'f1-score': 0.35988708043291107, 'support': 504577}, 'weighted avg': {'precision': 0.43554633533399434, 'recall': 0.4171811239909865, 'f1-score': 0.373139495953002, 'support': 504577}}
[[ 29364 111594  13550]
 [ 21947 149264  23397]
 [ 14132 109457  31872]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0797707
{'0': {'precision': 0.452258382201531, 'recall': 0.17414161610590181, 'f1-score': 0.2514591500217784, 'support': 58016}, '1': {'precision': 0.37517922338994575, 'recall': 0.7712900922254129, 'f1-score': 0.5048055170219219, 'support': 65817}, '2': {'precision': 0.4507334804621576, 'recall': 0.1829904604627466, 'f1-score': 0.26030238660502314, 'support': 56921}, 'accuracy': 0.39436471668676765, 'macro avg': {'precision': 0.4260570286845448, 'recall': 0.3761407229313538, 'f1-score': 0.3388556845495745, 'support': 180754}, 'weighted avg': {'precision': 0.4237117501634628, 'recall': 0.39436471668676765, 'f1-score': 0.34649363726080673, 'support': 180754}}
[[10103 43177  4736]
 [ 7096 50764  7957]
 [ 5140 41365 10416]]
testing model on single stock: results/universal/W4/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
12724/12724 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0594423
{'0': {'precision': 0.37735759828766346, 'recall': 0.2090536095062786, 'f1-score': 0.2690534114906502, 'support': 877904}, '1': {'precision': 0.4594150716947761, 'recall': 0.704652189060504, 'f1-score': 0.5562012554962993, 'support': 1506925}, '2': {'precision': 0.34576158306200266, 'recall': 0.18211905346010726, 'f1-score': 0.23857579866914755, 'support': 872314}, 'accuracy': 0.4311299810907903, 'macro avg': {'precision': 0.39417808434814744, 'recall': 0.36527495067562993, 'f1-score': 0.35461015521869904, 'support': 3257143}, 'weighted avg': {'precision': 0.40685977602086587, 'recall': 0.4311299810907903, 'f1-score': 0.39374066546673797, 'support': 3257143}}
[[ 183529  614446   79929]
 [ 224397 1061858  220670]
 [  78427  635022  158865]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880034
{'0': {'precision': 0.4380260937123262, 'recall': 0.18565932668374485, 'f1-score': 0.2607841292069867, 'support': 440328}, '1': {'precision': 0.32725340723421187, 'recall': 0.7154613891065164, 'f1-score': 0.44909150258786706, 'support': 440355}, '2': {'precision': 0.44469016302334197, 'recall': 0.17401607089862467, 'f1-score': 0.25014532162076347, 'support': 441419}, 'accuracy': 0.3582340848134259, 'macro avg': {'precision': 0.40332322132329335, 'recall': 0.3583789288962953, 'f1-score': 0.3200069844718724, 'support': 1322102}, 'weighted avg': {'precision': 0.40335580386867514, 'recall': 0.3582340848134259, 'f1-score': 0.3199519707193923, 'support': 1322102}}
[[ 81751 322380  36197]
 [ 65573 315057  59725]
 [ 39311 325294  76814]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0846845
{'0': {'precision': 0.424447025143814, 'recall': 0.19931389147817705, 'f1-score': 0.27125196867381496, 'support': 157701}, '1': {'precision': 0.3499755814577164, 'recall': 0.7165190956167931, 'f1-score': 0.47025867546177147, 'support': 173024}, '2': {'precision': 0.4244710932443021, 'recall': 0.15945710738830515, 'f1-score': 0.23182621639222256, 'support': 156274}, 'accuracy': 0.3702800211088729, 'macro avg': {'precision': 0.3996312332819441, 'recall': 0.3584300314944251, 'f1-score': 0.3244456201759363, 'support': 486999}, 'weighted avg': {'precision': 0.3979960758523212, 'recall': 0.3702800211088729, 'f1-score': 0.32930489367617805, 'support': 486999}}
[[ 31432 113746  12523]
 [ 27785 123975  21264]
 [ 14837 116518  24919]]
training model: results/universal/W4/deepOF_L1/h100
Epoch 1/50
9854/9854 - 147s - loss: 3.2323 - accuracy100: 0.4099 - val_loss: 3.2631 - val_accuracy100: 0.3781 - 147s/epoch - 15ms/step
Epoch 2/50
9854/9854 - 139s - loss: 3.2184 - accuracy100: 0.4184 - val_loss: 3.2845 - val_accuracy100: 0.3729 - 139s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 137s - loss: 3.2095 - accuracy100: 0.4232 - val_loss: 3.2929 - val_accuracy100: 0.3736 - 137s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 136s - loss: 3.2031 - accuracy100: 0.4261 - val_loss: 3.3026 - val_accuracy100: 0.3715 - 136s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 140s - loss: 3.1991 - accuracy100: 0.4278 - val_loss: 3.3083 - val_accuracy100: 0.3715 - 140s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 136s - loss: 3.1952 - accuracy100: 0.4289 - val_loss: 3.3062 - val_accuracy100: 0.3722 - 136s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 137s - loss: 3.1920 - accuracy100: 0.4301 - val_loss: 3.3107 - val_accuracy100: 0.3712 - 137s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 136s - loss: 3.1890 - accuracy100: 0.4314 - val_loss: 3.3100 - val_accuracy100: 0.3725 - 136s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 137s - loss: 3.1866 - accuracy100: 0.4321 - val_loss: 3.3165 - val_accuracy100: 0.3719 - 137s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 139s - loss: 3.1841 - accuracy100: 0.4333 - val_loss: 3.3190 - val_accuracy100: 0.3716 - 139s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 135s - loss: 3.1817 - accuracy100: 0.4339 - val_loss: 3.3275 - val_accuracy100: 0.3714 - 135s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 130s - 130s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0741444
{'0': {'precision': 0.41131480269031606, 'recall': 0.22238886216361528, 'f1-score': 0.28868960693934304, 'support': 1802289}, '1': {'precision': 0.4096543923540296, 'recall': 0.6896764049165875, 'f1-score': 0.5140017350163756, 'support': 2437707}, '2': {'precision': 0.40177820739375814, 'recall': 0.21785145895835095, 'f1-score': 0.2825170369059209, 'support': 1831615}, 'accuracy': 0.40863256885199, 'macro avg': {'precision': 0.40758246747936794, 'recall': 0.37663890867951794, 'f1-score': 0.3617361262872132, 'support': 6071611}, 'weighted avg': {'precision': 0.40777126788649826, 'recall': 0.40863256885199, 'f1-score': 0.3772886920810809, 'support': 6071611}}
[[ 400809 1190640  210840]
 [ 373203 1681229  383275]
 [ 200446 1232149  399020]]
Evaluating performance on  train set...
9854/9854 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889839
{'0': {'precision': 0.43332038194812383, 'recall': 0.22006744959219307, 'f1-score': 0.29189313515935744, 'support': 836180}, '1': {'precision': 0.3443499035458055, 'recall': 0.6715236935634805, 'f1-score': 0.45525175526819256, 'support': 851687}, '2': {'precision': 0.42986594326588873, 'recall': 0.22492198617270098, 'f1-score': 0.2953209654620952, 'support': 834147}, 'accuracy': 0.3741303577220428, 'macro avg': {'precision': 0.40251207625327273, 'recall': 0.3721710431094582, 'f1-score': 0.34748861862988173, 'support': 2522014}, 'weighted avg': {'precision': 0.40213240697950525, 'recall': 0.3741303577220428, 'f1-score': 0.34819326967414255, 'support': 2522014}}
[[184016 545364 106800]
 [137720 571928 142039]
 [102929 543600 187618]]
Evaluating performance on  val set...
3566/3566 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0871022
{'0': {'precision': 0.43186461611231186, 'recall': 0.22017691052989427, 'f1-score': 0.29165816303894515, 'support': 298569}, '1': {'precision': 0.3527812935434169, 'recall': 0.6804380917491457, 'f1-score': 0.4646560713057224, 'support': 316646}, '2': {'precision': 0.42201233022511697, 'recall': 0.2121736320986491, 'f1-score': 0.2823773915341427, 'support': 297134}, 'accuracy': 0.3773117524105359, 'macro avg': {'precision': 0.40221941329361527, 'recall': 0.37092954479256307, 'f1-score': 0.34623054195960346, 'support': 912349}, 'weighted avg': {'precision': 0.4012087301816471, 'recall': 0.3773117524105359, 'f1-score': 0.3486774209114632, 'support': 912349}}
[[ 65738 196734  36097]
 [ 50940 215458  50248]
 [ 35541 198549  63044]]
testing model out of sample: results/universal/W4/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 80s - 80s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991881
{'0': {'precision': 0.4382981667611361, 'recall': 0.15543046420111922, 'f1-score': 0.22948156435633907, 'support': 1059670}, '1': {'precision': 0.31263107095509557, 'recall': 0.7138365616055597, 'f1-score': 0.43482615849255624, 'support': 940183}, '2': {'precision': 0.4255088872345566, 'recall': 0.20995687988299708, 'f1-score': 0.28117492066170413, 'support': 1031769}, 'accuracy': 0.3471636635438059, 'macro avg': {'precision': 0.39214604165026273, 'recall': 0.35974130189655873, 'f1-score': 0.3151608811701998, 'support': 3031622}, 'weighted avg': {'precision': 0.3949729602267891, 'recall': 0.3471636635438059, 'f1-score': 0.31075723100957003, 'support': 3031622}}
[[164705 758304 136661]
 [113233 671137 155813]
 [ 97845 717297 216627]]
Evaluating performance on  train set...
5528/5528 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0863863
{'0': {'precision': 0.41955099912760235, 'recall': 0.18022862591611136, 'f1-score': 0.25214294356527484, 'support': 450955}, '1': {'precision': 0.36683057869116215, 'recall': 0.7032868077442593, 'f1-score': 0.48216599401313537, 'support': 506388}, '2': {'precision': 0.4210423111246283, 'recall': 0.2301704845015084, 'f1-score': 0.29763393286524964, 'support': 457109}, 'accuracy': 0.38362842995025637, 'macro avg': {'precision': 0.4024746296477976, 'recall': 0.371228639387293, 'f1-score': 0.34398095681455326, 'support': 1414452}, 'weighted avg': {'precision': 0.4011585078105979, 'recall': 0.38362842995025637, 'f1-score': 0.3491948428860814, 'support': 1414452}}
[[ 81275 310178  59502]
 [ 65080 356136  85172]
 [ 47364 304532 105213]]
Evaluating performance on  val set...
1908/1908 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913986
{'0': {'precision': 0.42274896105895027, 'recall': 0.17037404627504496, 'f1-score': 0.24286851180475724, 'support': 161210}, '1': {'precision': 0.3522928212857363, 'recall': 0.7073727228318499, 'f1-score': 0.47034148389626745, 'support': 167862}, '2': {'precision': 0.4178846400990735, 'recall': 0.22560441016001967, 'f1-score': 0.2930170069141789, 'support': 158543}, 'accuracy': 0.3731940157706387, 'macro avg': {'precision': 0.3976421408145867, 'recall': 0.3677837264223049, 'f1-score': 0.33540900087173453, 'support': 487615}, 'weighted avg': {'precision': 0.3969127735492285, 'recall': 0.3731940157706387, 'f1-score': 0.33748159979704245, 'support': 487615}}
[[ 27466 111691  22053]
 [ 21349 118741  27772]
 [ 16155 106620  35768]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1306168
{'0': {'precision': 0.4077038990393671, 'recall': 0.0840941761529197, 'f1-score': 0.13942927080649317, 'support': 51478}, '1': {'precision': 0.23727315979066133, 'recall': 0.7364978902953586, 'f1-score': 0.3589163625147792, 'support': 33180}, '2': {'precision': 0.3900872357970574, 'recall': 0.1728727496537929, 'f1-score': 0.23957458718164013, 'support': 51992}, 'accuracy': 0.27628247347237467, 'macro avg': {'precision': 0.3450214315423619, 'recall': 0.3311549387006904, 'f1-score': 0.24597340683430416, 'support': 136650}, 'weighted avg': {'precision': 0.35961888269420633, 'recall': 0.27628247347237467, 'f1-score': 0.23082580934917574, 'support': 136650}}
[[ 4329 39556  7593]
 [ 2283 24437  6460]
 [ 4006 38998  8988]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1082182
{'0': {'precision': 0.3938384679433805, 'recall': 0.06548525543403018, 'f1-score': 0.11229819563152896, 'support': 21669}, '1': {'precision': 0.32965355474058494, 'recall': 0.832221073409155, 'f1-score': 0.47224481632108806, 'support': 21278}, '2': {'precision': 0.3694510112949829, 'recall': 0.1279392368217583, 'f1-score': 0.1900611465828857, 'support': 21987}, 'accuracy': 0.3378815412572766, 'macro avg': {'precision': 0.36431434465964946, 'recall': 0.3418818552216478, 'f1-score': 0.2582013861785009, 'support': 64934}, 'weighted avg': {'precision': 0.3645482102593105, 'recall': 0.3378815412572766, 'f1-score': 0.2565788220768414, 'support': 64934}}
[[ 1419 17969  2281]
 [ 1050 17708  2520]
 [ 1134 18040  2813]]
Evaluating performance on  val set...
81/81 - 1s - 594ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1095816
{'0': {'precision': 0.408675799086758, 'recall': 0.07389569285812578, 'f1-score': 0.12516023773452978, 'support': 7267}, '1': {'precision': 0.3112393645504849, 'recall': 0.820034488164289, 'f1-score': 0.4512205641335289, 'support': 6379}, '2': {'precision': 0.4072144288577154, 'recall': 0.14576757532281207, 'f1-score': 0.2146856840993133, 'support': 6970}, 'accuracy': 0.32906480403570043, 'macro avg': {'precision': 0.37570986416498614, 'recall': 0.3465659187817423, 'f1-score': 0.2636888286557907, 'support': 20616}, 'weighted avg': {'precision': 0.37803296020417587, 'recall': 0.32906480403570043, 'f1-score': 0.25631716358153, 'support': 20616}}
[[ 537 5995  735]
 [ 404 5231  744]
 [ 373 5581 1016]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
1613/1613 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0342388
{'0': {'precision': 0.4697944419173869, 'recall': 0.21483829428953494, 'f1-score': 0.2948437351313876, 'support': 100955}, '1': {'precision': 0.5411084013454929, 'recall': 0.7752793455876744, 'f1-score': 0.6373656519737035, 'support': 209776}, '2': {'precision': 0.43150985344605935, 'recall': 0.27940341187300466, 'f1-score': 0.33918434552079557, 'support': 102114}, 'accuracy': 0.5155809080889923, 'macro avg': {'precision': 0.480804232236313, 'recall': 0.423173683916738, 'f1-score': 0.4237979108752956, 'support': 412845}, 'weighted avg': {'precision': 0.4965613028114978, 'recall': 0.5155809080889923, 'f1-score': 0.4798542710875398, 'support': 412845}}
[[ 21689  69788   9478]
 [ 19031 162635  28110]
 [  5447  68136  28531]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0496718
{'0': {'precision': 0.45857801066040293, 'recall': 0.22924758377743654, 'f1-score': 0.30568185239830176, 'support': 44284}, '1': {'precision': 0.4878207239037762, 'recall': 0.7448936603927431, 'f1-score': 0.5895519177404437, 'support': 73585}, '2': {'precision': 0.43142495936427666, 'recall': 0.2695128280343886, 'f1-score': 0.33176856198438925, 'support': 44317}, 'accuracy': 0.4742024589052076, 'macro avg': {'precision': 0.45927456464281863, 'recall': 0.4145513574015227, 'f1-score': 0.40900077737437823, 'support': 162186}, 'weighted avg': {'precision': 0.46442613121164156, 'recall': 0.4742024589052076, 'f1-score': 0.44160396322740014, 'support': 162186}}
[[10152 28991  5141]
 [ 8172 54813 10600]
 [ 3814 28559 11944]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0348742
{'0': {'precision': 0.4363729159578088, 'recall': 0.207742771523447, 'f1-score': 0.2814814814814815, 'support': 12347}, '1': {'precision': 0.5547175699573494, 'recall': 0.7722105568025487, 'f1-score': 0.6456397372642795, 'support': 27622}, '2': {'precision': 0.40338135492320515, 'recall': 0.2655172413793103, 'f1-score': 0.3202419774091403, 'support': 12760}, 'accuracy': 0.5174192569553756, 'macro avg': {'precision': 0.4648239469461211, 'recall': 0.4151568565684354, 'f1-score': 0.4157877320516337, 'support': 52729}, 'weighted avg': {'precision': 0.49038387224322605, 'recall': 0.5174192569553756, 'f1-score': 0.48162491809642527, 'support': 52729}}
[[ 2565  8539  1243]
 [ 2524 21330  3768]
 [  789  8583  3388]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0930784
{'0': {'precision': 0.3942649636864513, 'recall': 0.19053555219364599, 'f1-score': 0.2569132226347354, 'support': 82625}, '1': {'precision': 0.3688078846455722, 'recall': 0.7015270757352784, 'f1-score': 0.48345373439256867, 'support': 93774}, '2': {'precision': 0.35868216830626315, 'recall': 0.16238278086879293, 'f1-score': 0.22355680622859145, 'support': 76566}, 'accuracy': 0.3714387365841124, 'macro avg': {'precision': 0.3739183388794289, 'recall': 0.3514818029325724, 'f1-score': 0.32130792108529854, 'support': 252965}, 'weighted avg': {'precision': 0.37405804003670184, 'recall': 0.3714387365841124, 'f1-score': 0.33079554853367893, 'support': 252965}}
[[15743 57895  8987]
 [14746 65785 13243]
 [ 9441 54692 12433]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021726
{'0': {'precision': 0.4047186932849365, 'recall': 0.20059507334624965, 'f1-score': 0.2682396483923202, 'support': 28904}, '1': {'precision': 0.32281400534477184, 'recall': 0.668322937590302, 'f1-score': 0.43534650965268695, 'support': 28377}, '2': {'precision': 0.3936130709246194, 'recall': 0.18114084555179602, 'f1-score': 0.24810411010205038, 'support': 29259}, 'accuracy': 0.3473884908712734, 'macro avg': {'precision': 0.3737152565181092, 'recall': 0.35001961882944926, 'f1-score': 0.3172300893823525, 'support': 86540}, 'weighted avg': {'precision': 0.3741068521210981, 'recall': 0.3473884908712734, 'f1-score': 0.31622723433119726, 'support': 86540}}
[[ 5798 19560  3546]
 [ 4793 18965  4619]
 [ 3735 20224  5300]]
Evaluating performance on  val set...
124/124 - 1s - 804ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104031
{'0': {'precision': 0.3731973267674991, 'recall': 0.2031594064145524, 'f1-score': 0.2630959022999194, 'support': 10445}, '1': {'precision': 0.31501989548875786, 'recall': 0.6415739113454404, 'f1-score': 0.4225587601684833, 'support': 10242}, '2': {'precision': 0.4158812913575296, 'recall': 0.1912402028584601, 'f1-score': 0.2620010106114199, 'support': 10845}, 'accuracy': 0.3414626411264747, 'macro avg': {'precision': 0.36803283787126223, 'recall': 0.3453245068728177, 'f1-score': 0.3158852243599409, 'support': 31532}, 'weighted avg': {'precision': 0.36898111291560304, 'recall': 0.3414626411264747, 'f1-score': 0.3145149207550778, 'support': 31532}}
[[2122 6994 1329]
 [2087 6571 1584]
 [1477 7294 2074]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0860956
{'0': {'precision': 0.40470193115029385, 'recall': 0.1364389987464111, 'f1-score': 0.2040766950946592, 'support': 74187}, '1': {'precision': 0.39752866695481937, 'recall': 0.844689357104268, 'f1-score': 0.5406268909596998, 'support': 92550}, '2': {'precision': 0.38924387646432373, 'recall': 0.08359898789187026, 'f1-score': 0.1376372430186992, 'support': 69953}, 'accuracy': 0.3977607841480417, 'macro avg': {'precision': 0.3971581581898123, 'recall': 0.3549091145808498, 'f1-score': 0.2941136096910194, 'support': 236690}, 'weighted avg': {'precision': 0.3973284768398505, 'recall': 0.3977607841480417, 'f1-score': 0.3160378326004257, 'support': 236690}}
[[10122 60687  3378]
 [ 8576 78176  5798]
 [ 6313 57792  5848]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011573
{'0': {'precision': 0.3847738745235397, 'recall': 0.12348740329299743, 'f1-score': 0.1869696893850274, 'support': 30246}, '1': {'precision': 0.32761216501053897, 'recall': 0.7823585810162992, 'f1-score': 0.46183233109303146, 'support': 29204}, '2': {'precision': 0.4190330007674597, 'recall': 0.13125450736632438, 'f1-score': 0.19989539748953972, 'support': 29119}, 'accuracy': 0.3432916709006537, 'macro avg': {'precision': 0.37713968010051274, 'recall': 0.3457001638918737, 'f1-score': 0.28289913932253286, 'support': 88569}, 'weighted avg': {'precision': 0.37718928999033996, 'recall': 0.3432916709006537, 'f1-score': 0.2818502038171181, 'support': 88569}}
[[ 3735 23889  2622]
 [ 3679 22848  2677]
 [ 2293 23004  3822]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985457
{'0': {'precision': 0.40363728214195504, 'recall': 0.14494331065759636, 'f1-score': 0.2132941804591564, 'support': 11025}, '1': {'precision': 0.30860027024878783, 'recall': 0.7715620031796503, 'f1-score': 0.44086754102083686, 'support': 10064}, '2': {'precision': 0.4671324229914258, 'recall': 0.13156247205080046, 'f1-score': 0.20530355896720168, 'support': 11181}, 'accuracy': 0.3357297799814069, 'macro avg': {'precision': 0.39312332512738957, 'recall': 0.34935592862934906, 'f1-score': 0.28648842681573167, 'support': 32270}, 'weighted avg': {'precision': 0.3959981957504179, 'recall': 0.3357297799814069, 'f1-score': 0.28149855485615694, 'support': 32270}}
[[1598 8551  876]
 [1497 7765  802]
 [ 864 8846 1471]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0919548
{'0': {'precision': 0.3840276303857063, 'recall': 0.15410404713789072, 'f1-score': 0.21994695546469223, 'support': 129153}, '1': {'precision': 0.36797989963324934, 'recall': 0.7197283944093635, 'f1-score': 0.486979061920404, 'support': 151396}, '2': {'precision': 0.36733276883996613, 'recall': 0.17154901061356195, 'f1-score': 0.2338753153774826, 'support': 126442}, 'accuracy': 0.36992955618183204, 'macro avg': {'precision': 0.37311343295297394, 'recall': 0.3484604840536054, 'f1-score': 0.3136004442541929, 'support': 406991}, 'weighted avg': {'precision': 0.3728713789487815, 'recall': 0.36992955618183204, 'f1-score': 0.3236070424765966, 'support': 406991}}
[[ 19903  94977  14273]
 [ 19346 108964  23086]
 [ 12578  92173  21691]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023388
{'0': {'precision': 0.3939619643477829, 'recall': 0.173914949583516, 'f1-score': 0.24130537264861085, 'support': 45620}, '1': {'precision': 0.326581993470407, 'recall': 0.7015191153516389, 'f1-score': 0.4456828403028017, 'support': 45487}, '2': {'precision': 0.4003229224481558, 'recall': 0.17040378006872853, 'f1-score': 0.23905150725380017, 'support': 46560}, 'accuracy': 0.34705484974612655, 'macro avg': {'precision': 0.3736222934221152, 'recall': 0.3486126150012945, 'f1-score': 0.3086799067350709, 'support': 137667}, 'weighted avg': {'precision': 0.3738500528065578, 'recall': 0.34705484974612655, 'f1-score': 0.3080721206594181, 'support': 137667}}
[[ 7934 32598  5088]
 [ 6780 31910  6797]
 [ 5425 33201  7934]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0985295
{'0': {'precision': 0.39123540435346693, 'recall': 0.15122304563436786, 'f1-score': 0.21813213309757276, 'support': 17947}, '1': {'precision': 0.3387133211174979, 'recall': 0.7377802077638054, 'f1-score': 0.4642777271241548, 'support': 18290}, '2': {'precision': 0.4007446016381236, 'recall': 0.15596383447316564, 'f1-score': 0.22454003087321123, 'support': 17254}, 'accuracy': 0.3533117720738068, 'macro avg': {'precision': 0.37689777570302946, 'recall': 0.34832236262377964, 'f1-score': 0.3023166303649796, 'support': 53491}, 'weighted avg': {'precision': 0.3763439793953169, 'recall': 0.3533117720738068, 'f1-score': 0.30436280335924387, 'support': 53491}}
[[ 2714 13436  1797]
 [ 2569 13494  2227]
 [ 1654 12909  2691]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/EXC
Evaluating performance on  test set...
3782/3782 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0689276
{'0': {'precision': 0.4337310038510589, 'recall': 0.23977134204576633, 'f1-score': 0.3088222795772034, 'support': 287941}, '1': {'precision': 0.39120512919200473, 'recall': 0.6687583957014008, 'f1-score': 0.493642863069112, 'support': 364770}, '2': {'precision': 0.4792146995459037, 'recall': 0.2815405552013247, 'f1-score': 0.35469586763647987, 'support': 315237}, 'accuracy': 0.41503779128630874, 'macro avg': {'precision': 0.4347169441963224, 'recall': 0.3966900976494973, 'f1-score': 0.3857203367609318, 'support': 967948}, 'weighted avg': {'precision': 0.4325181086132699, 'recall': 0.41503779128630874, 'f1-score': 0.3934115927628142, 'support': 967948}}
[[ 69040 183229  35672]
 [ 60048 243943  60779]
 [ 30089 196396  88752]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0869787
{'0': {'precision': 0.44903307086614175, 'recall': 0.25937677383672697, 'f1-score': 0.32881742154814125, 'support': 137414}, '1': {'precision': 0.34606819121146337, 'recall': 0.642236404119535, 'f1-score': 0.44977548774700254, 'support': 134287}, '2': {'precision': 0.45626139667833027, 'recall': 0.26825257698353483, 'f1-score': 0.33786317417306455, 'support': 138049}, 'accuracy': 0.38784136668700425, 'macro avg': {'precision': 0.41712088625197846, 'recall': 0.38995525164659894, 'f1-score': 0.3721520278227361, 'support': 409750}, 'weighted avg': {'precision': 0.4177237807035036, 'recall': 0.38784136668700425, 'f1-score': 0.37150650742920166, 'support': 409750}}
[[35642 81936 19836]
 [23747 86244 24296]
 [19986 81031 37032]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0759461
{'0': {'precision': 0.44565088640581196, 'recall': 0.25764112396996053, 'f1-score': 0.32651585281184914, 'support': 43809}, '1': {'precision': 0.3847271953770341, 'recall': 0.655023942698483, 'f1-score': 0.4847420024865436, 'support': 49702}, '2': {'precision': 0.44524990461655856, 'recall': 0.27364175674725066, 'f1-score': 0.3389633588451428, 'support': 42647}, 'accuracy': 0.40771016025499784, 'macro avg': {'precision': 0.42520932879980156, 'recall': 0.3954356078052314, 'f1-score': 0.3834070713811785, 'support': 136158}, 'weighted avg': {'precision': 0.42328620741611905, 'recall': 0.40771016025499784, 'f1-score': 0.3881721997098172, 'support': 136158}}
[[11287 26592  5930]
 [ 8536 32556  8610]
 [ 5504 25473 11670]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/AAL
Evaluating performance on  test set...
4457/4457 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920553
{'0': {'precision': 0.44132321590289064, 'recall': 0.19937639288772785, 'f1-score': 0.2746667226796617, 'support': 393517}, '1': {'precision': 0.340996147918838, 'recall': 0.6745355232065035, 'f1-score': 0.45299230262892753, 'support': 374938}, '2': {'precision': 0.4252660282890668, 'recall': 0.2528751677852349, 'f1-score': 0.3171587830955944, 'support': 372500}, 'accuracy': 0.3729884175975389, 'macro avg': {'precision': 0.40252846403693177, 'recall': 0.37559569462648873, 'f1-score': 0.34827260280139455, 'support': 1140955}, 'weighted avg': {'precision': 0.40311160142032637, 'recall': 0.3729884175975389, 'f1-score': 0.34714050893762344, 'support': 1140955}}
[[ 78458 255839  59220]
 [ 53946 252909  68083]
 [ 45375 232929  94196]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0760422
{'0': {'precision': 0.41295963263321006, 'recall': 0.1942436091825606, 'f1-score': 0.26421061010644836, 'support': 187965}, '1': {'precision': 0.40948470310885604, 'recall': 0.6901227099189836, 'f1-score': 0.5139919750117208, 'support': 244642}, '2': {'precision': 0.4072074324042828, 'recall': 0.25977664024834285, 'f1-score': 0.31719791524686664, 'support': 188127}, 'accuracy': 0.4095393517996436, 'macro avg': {'precision': 0.4098839227154496, 'recall': 0.3813809864499624, 'f1-score': 0.3651335001216786, 'support': 620734}, 'weighted avg': {'precision': 0.4098467728878692, 'recall': 0.4095393517996436, 'f1-score': 0.3787127244216093, 'support': 620734}}
[[ 36511 124209  27245]
 [ 31910 168833  43899]
 [ 19992 119264  48871]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0803021
{'0': {'precision': 0.42676528455876994, 'recall': 0.1847359788025992, 'f1-score': 0.25785360484314807, 'support': 63404}, '1': {'precision': 0.39351477921943195, 'recall': 0.6983588448792805, 'f1-score': 0.5033815646667962, 'support': 76044}, '2': {'precision': 0.4103495350694176, 'recall': 0.2578916696344741, 'f1-score': 0.3167291271111465, 'support': 61774}, 'accuracy': 0.40129806879963426, 'macro avg': {'precision': 0.4102098662825398, 'recall': 0.3803288311054513, 'f1-score': 0.3593214322070302, 'support': 201222}, 'weighted avg': {'precision': 0.40916001308259003, 'recall': 0.40129806879963426, 'f1-score': 0.36871576051903254, 'support': 201222}}
[[11713 42305  9386]
 [ 9432 53106 13506]
 [ 6301 39542 15931]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/WBA
Evaluating performance on  test set...
4676/4676 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0819482
{'0': {'precision': 0.4846300341076597, 'recall': 0.22358398546570069, 'f1-score': 0.3059965250827543, 'support': 402909}, '1': {'precision': 0.34348834461875183, 'recall': 0.7008670410226872, 'f1-score': 0.46103014936982256, 'support': 394099}, '2': {'precision': 0.4608925051215647, 'recall': 0.2384887131010033, 'f1-score': 0.31432831640428704, 'support': 399977}, 'accuracy': 0.38570658780185213, 'macro avg': {'precision': 0.42967029461599204, 'recall': 0.3876465798631304, 'f1-score': 0.3604516636189546, 'support': 1196985}, 'weighted avg': {'precision': 0.4302281290569193, 'recall': 0.38570658780185213, 'f1-score': 0.35982436853553107, 'support': 1196985}}
[[ 90084 263673  49152]
 [ 55462 276211  62426]
 [ 40336 264251  95390]]
Evaluating performance on  train set...
2108/2108 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0844082
{'0': {'precision': 0.45912309248427813, 'recall': 0.22898879731530375, 'f1-score': 0.3055725277419024, 'support': 182367}, '1': {'precision': 0.3441063226926856, 'recall': 0.6757705791614079, 'f1-score': 0.4560097959987054, 'support': 178275}, '2': {'precision': 0.4545944461956135, 'recall': 0.2500936984309009, 'f1-score': 0.32267097779959003, 'support': 178765}, 'accuracy': 0.3836453735305623, 'macro avg': {'precision': 0.4192746204575257, 'recall': 0.38495102496920425, 'f1-score': 0.36141776718006596, 'support': 539407}, 'weighted avg': {'precision': 0.41960899999309936, 'recall': 0.3836453735305623, 'f1-score': 0.36095892136127344, 'support': 539407}}
[[ 41760 116819  23788]
 [ 27951 120473  29851]
 [ 21245 112812  44708]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0906422
{'0': {'precision': 0.46409105029794684, 'recall': 0.23163666605584765, 'f1-score': 0.30903038964946594, 'support': 70943}, '1': {'precision': 0.31380184331797234, 'recall': 0.6585696094392237, 'f1-score': 0.42506463308693865, 'support': 62039}, '2': {'precision': 0.4702467343976778, 'recall': 0.25479209672662934, 'f1-score': 0.33050685368186167, 'support': 71211}, 'accuracy': 0.3694250047748943, 'macro avg': {'precision': 0.416046542671199, 'recall': 0.38166612407390027, 'f1-score': 0.3548672921394221, 'support': 204193}, 'weighted avg': {'precision': 0.420576141895579, 'recall': 0.3694250047748943, 'f1-score': 0.3517743079465099, 'support': 204193}}
[[16433 44893  9617]
 [10359 40857 10823]
 [ 8617 44450 18144]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1068546
{'0': {'precision': 0.4858276227555593, 'recall': 0.11490529837650813, 'f1-score': 0.18585353320433248, 'support': 402897}, '1': {'precision': 0.2647501461486803, 'recall': 0.7640181948099479, 'f1-score': 0.39323513503088836, 'support': 286895}, '2': {'precision': 0.4628964096320663, 'recall': 0.19562222183743994, 'f1-score': 0.27501977865296506, 'support': 404269}, 'accuracy': 0.31494770401284755, 'macro avg': {'precision': 0.4044913928454353, 'recall': 0.3581819050079653, 'f1-score': 0.2847028156293953, 'support': 1094061}, 'weighted avg': {'precision': 0.41938123516898784, 'recall': 0.31494770401284755, 'f1-score': 0.27318311860889677, 'support': 1094061}}
[[ 46295 309864  46738]
 [ 22678 219193  45024]
 [ 26318 298867  79084]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0893713
{'0': {'precision': 0.4407290321623106, 'recall': 0.17803077993009467, 'f1-score': 0.25361483341446955, 'support': 166797}, '1': {'precision': 0.34087848411670624, 'recall': 0.7125519195217401, 'f1-score': 0.46114791701870206, 'support': 166604}, '2': {'precision': 0.4519288067370504, 'recall': 0.23481679674720754, 'f1-score': 0.30905323373712595, 'support': 171176}, 'accuracy': 0.37378635966363905, 'macro avg': {'precision': 0.41117877433868905, 'recall': 0.3751331653996808, 'f1-score': 0.34127199472343256, 'support': 504577}, 'weighted avg': {'precision': 0.4115593155601186, 'recall': 0.37378635966363905, 'f1-score': 0.34094653001267083, 'support': 504577}}
[[ 29695 115621  21481]
 [ 20625 118714  27265]
 [ 17057 113924  40195]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967826
{'0': {'precision': 0.4425103262243952, 'recall': 0.16893816274317344, 'f1-score': 0.24452388993047872, 'support': 62147}, '1': {'precision': 0.3234885309123047, 'recall': 0.7075228003584796, 'f1-score': 0.4439825331363165, 'support': 56907}, '2': {'precision': 0.43512575622639194, 'recall': 0.22964343598055106, 'f1-score': 0.30062696922440413, 'support': 61700}, 'accuracy': 0.359223032408688, 'macro avg': {'precision': 0.4003748711210306, 'recall': 0.3687014663607347, 'f1-score': 0.3297111307637331, 'support': 180754}, 'weighted avg': {'precision': 0.40251784321045386, 'recall': 0.359223032408688, 'f1-score': 0.32647036415151837, 'support': 180754}}
[[10499 42969  8679]
 [ 6929 40263  9715]
 [ 6298 41233 14169]]
testing model on single stock: results/universal/W4/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
12724/12724 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0770346
{'0': {'precision': 0.3760269693014729, 'recall': 0.22432411937665078, 'f1-score': 0.2810086309201275, 'support': 936297}, '1': {'precision': 0.4223705893423547, 'recall': 0.6684627522317277, 'f1-score': 0.5176574566488948, 'support': 1376512}, '2': {'precision': 0.34750947982124863, 'recall': 0.1913761444573636, 'f1-score': 0.2468242662795192, 'support': 944334}, 'accuracy': 0.4024705086635742, 'macro avg': {'precision': 0.3819690128216921, 'recall': 0.361387672021914, 'f1-score': 0.34849678461618055, 'support': 3257143}, 'weighted avg': {'precision': 0.3873444073749306, 'recall': 0.4024705086635742, 'f1-score': 0.37110860215351604, 'support': 3257143}}
[[210034 613067 113196]
 [230232 920147 226133]
 [118295 645316 180723]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095362
{'0': {'precision': 0.4176368457179774, 'recall': 0.2106732990999595, 'f1-score': 0.2800684752228604, 'support': 441869}, '1': {'precision': 0.3277179659167131, 'recall': 0.6606468409665945, 'f1-score': 0.43810916253402493, 'support': 436336}, '2': {'precision': 0.4108609030260252, 'recall': 0.2032521057812961, 'f1-score': 0.271964093010918, 'support': 443897}, 'accuracy': 0.35668730551803113, 'macro avg': {'precision': 0.3854052382202385, 'recall': 0.35819074861595007, 'f1-score': 0.3300472435892678, 'support': 1322102}, 'weighted avg': {'precision': 0.3856857065697922, 'recall': 0.35668730551803113, 'f1-score': 0.3295059092391993, 'support': 1322102}}
[[ 93090 293580  55199]
 [ 73899 288264  74173]
 [ 55908 297766  90223]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0936602
{'0': {'precision': 0.41777081139330413, 'recall': 0.21263361276449874, 'f1-score': 0.28182580429314313, 'support': 160445}, '1': {'precision': 0.340415860123608, 'recall': 0.676232963957445, 'f1-score': 0.45286124493890634, 'support': 167219}, '2': {'precision': 0.3907979988518002, 'recall': 0.1794332695264694, 'f1-score': 0.24594288860309774, 'support': 159335}, 'accuracy': 0.360955566643874, 'macro avg': {'precision': 0.3829948901229041, 'recall': 0.3560999487494711, 'f1-score': 0.32687664594504906, 'support': 486999}, 'weighted avg': {'precision': 0.382384844106579, 'recall': 0.360955566643874, 'f1-score': 0.32881352085492355, 'support': 486999}}
[[ 34116 107987  18342]
 [ 27914 113079  26226]
 [ 19632 111113  28590]]
training model: results/universal/W4/deepOF_L1/h200
Epoch 1/50
9854/9854 - 139s - loss: 3.2546 - accuracy200: 0.3911 - val_loss: 3.2860 - val_accuracy200: 0.3524 - 139s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 139s - loss: 3.2524 - accuracy200: 0.3938 - val_loss: 3.2902 - val_accuracy200: 0.3508 - 139s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 137s - loss: 3.2487 - accuracy200: 0.3966 - val_loss: 3.2937 - val_accuracy200: 0.3490 - 137s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 141s - loss: 3.2457 - accuracy200: 0.3988 - val_loss: 3.2969 - val_accuracy200: 0.3470 - 141s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 139s - loss: 3.2437 - accuracy200: 0.4001 - val_loss: 3.2965 - val_accuracy200: 0.3479 - 139s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 135s - loss: 3.2419 - accuracy200: 0.4008 - val_loss: 3.2943 - val_accuracy200: 0.3489 - 135s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 136s - loss: 3.2404 - accuracy200: 0.4017 - val_loss: 3.2957 - val_accuracy200: 0.3477 - 136s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 138s - loss: 3.2393 - accuracy200: 0.4021 - val_loss: 3.2934 - val_accuracy200: 0.3484 - 138s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 141s - loss: 3.2385 - accuracy200: 0.4029 - val_loss: 3.2932 - val_accuracy200: 0.3491 - 141s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 136s - loss: 3.2378 - accuracy200: 0.4032 - val_loss: 3.2939 - val_accuracy200: 0.3481 - 136s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 136s - loss: 3.2372 - accuracy200: 0.4033 - val_loss: 3.2930 - val_accuracy200: 0.3488 - 136s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 122s - 122s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0826101
{'0': {'precision': 0.36783076454334374, 'recall': 0.19439963796985488, 'f1-score': 0.2543660646658905, 'support': 1800955}, '1': {'precision': 0.3993251342584063, 'recall': 0.7536735390802559, 'f1-score': 0.5220488004704448, 'support': 2412932}, '2': {'precision': 0.36543458662565625, 'recall': 0.11128133134954385, 'f1-score': 0.17060914388425683, 'support': 1857724}, 'accuracy': 0.3912302682105293, 'macro avg': {'precision': 0.3775301618091354, 'recall': 0.3531181694665515, 'f1-score': 0.3156746696735307, 'support': 6071611}, 'weighted avg': {'precision': 0.37961385395393793, 'recall': 0.3912302682105293, 'f1-score': 0.33511942603377376, 'support': 6071611}}
[[ 350105 1310989  139861]
 [ 375250 1818563  219119]
 [ 226455 1424539  206730]]
Evaluating performance on  train set...
9854/9854 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961605
{'0': {'precision': 0.389644139861945, 'recall': 0.1871131384816732, 'f1-score': 0.252818787514716, 'support': 838963}, '1': {'precision': 0.33548190319096544, 'recall': 0.744238875017923, 'f1-score': 0.46248748613303375, 'support': 843889}, '2': {'precision': 0.38785101585618115, 'recall': 0.1141758087234646, 'f1-score': 0.17641767822536467, 'support': 839162}, 'accuracy': 0.3492637233576023, 'macro avg': {'precision': 0.37099235296969724, 'recall': 0.3485092740743536, 'f1-score': 0.29724131729103814, 'support': 2522014}, 'weighted avg': {'precision': 0.37092432416347504, 'recall': 0.3492637233576023, 'f1-score': 0.29755454264329295, 'support': 2522014}}
[[156981 610694  71288]
 [135901 628055  79933]
 [110001 633349  95812]]
Evaluating performance on  val set...
3566/3566 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951492
{'0': {'precision': 0.388900611943448, 'recall': 0.18343905934812613, 'f1-score': 0.24929099279044495, 'support': 301408}, '1': {'precision': 0.3401838350156651, 'recall': 0.7499855161093051, 'f1-score': 0.46806112979233716, 'support': 310690}, '2': {'precision': 0.38225940833401784, 'recall': 0.10849256122377611, 'f1-score': 0.16901532682349768, 'support': 300251}, 'accuracy': 0.35170532329185433, 'macro avg': {'precision': 0.370447951764377, 'recall': 0.3473057122270691, 'f1-score': 0.29545581646875996, 'support': 912349}, 'weighted avg': {'precision': 0.37012507380110565, 'recall': 0.35170532329185433, 'f1-score': 0.2973722039090805, 'support': 912349}}
[[ 55290 221475  24643]
 [ 49678 233013  27999]
 [ 37202 230474  32575]]
testing model out of sample: results/universal/W4/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 60s - 60s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009002
{'0': {'precision': 0.40658719230310825, 'recall': 0.15084665074786385, 'f1-score': 0.22005235943413384, 'support': 1062894}, '1': {'precision': 0.31100621202083023, 'recall': 0.7454152549155617, 'f1-score': 0.4388944792765916, 'support': 937075}, '2': {'precision': 0.39362096326981216, 'recall': 0.1493031087003091, 'f1-score': 0.2164900637119931, 'support': 1031653}, 'accuracy': 0.3341026684725206, 'macro avg': {'precision': 0.3704047891979169, 'recall': 0.34852167145457824, 'f1-score': 0.29181230080757287, 'support': 3031622}, 'weighted avg': {'precision': 0.37263071745931087, 'recall': 0.3341026684725206, 'f1-score': 0.28648426498922525, 'support': 3031622}}
[[160334 782739 119821]
 [121102 698510 117463]
 [112905 764719 154029]]
Evaluating performance on  train set...
5528/5528 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973202
{'0': {'precision': 0.39564830551367364, 'recall': 0.1587524183118313, 'f1-score': 0.226587457779161, 'support': 467785}, '1': {'precision': 0.33280482973786585, 'recall': 0.7808331245275099, 'f1-score': 0.4666957229084145, 'support': 466941}, '2': {'precision': 0.3931056558620217, 'recall': 0.10751762464406765, 'f1-score': 0.1688526602666405, 'support': 479726}, 'accuracy': 0.34673781789696645, 'macro avg': {'precision': 0.37385293037118705, 'recall': 0.34903438916113627, 'f1-score': 0.2873786136514053, 'support': 1414452}, 'weighted avg': {'precision': 0.37403995785039496, 'recall': 0.34673781789696645, 'f1-score': 0.28627100303642483, 'support': 1414452}}
[[ 74262 355654  37869]
 [ 60577 364603  41761]
 [ 52858 375289  51579]]
Evaluating performance on  val set...
1908/1908 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995578
{'0': {'precision': 0.4037533082043468, 'recall': 0.15125313207909966, 'f1-score': 0.22006574346062388, 'support': 166423}, '1': {'precision': 0.32634817899679036, 'recall': 0.7792133764012921, 'f1-score': 0.46002841758899193, 'support': 157890}, '2': {'precision': 0.3865575807787904, 'recall': 0.11428518940368153, 'f1-score': 0.17641387263566843, 'support': 163302}, 'accuracy': 0.34220645386216586, 'macro avg': {'precision': 0.3722196893266425, 'recall': 0.3482505659613577, 'f1-score': 0.28550267789509476, 'support': 487615}, 'weighted avg': {'precision': 0.37293064579521396, 'recall': 0.34220645386216586, 'f1-score': 0.2831467988191981, 'support': 487615}}
[[ 25172 126558  14693]
 [ 19936 123030  14924]
 [ 17237 127402  18663]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1139773
{'0': {'precision': 0.36310383566040766, 'recall': 0.09124639551531528, 'f1-score': 0.14584306963402252, 'support': 49591}, '1': {'precision': 0.2844069723380068, 'recall': 0.770170082860881, 'f1-score': 0.4154115441293474, 'support': 38981}, '2': {'precision': 0.36649130341421515, 'recall': 0.14199841923540912, 'f1-score': 0.20468923335232211, 'support': 48078}, 'accuracy': 0.3027735089645079, 'macro avg': {'precision': 0.3380007038042099, 'recall': 0.33447163253720175, 'f1-score': 0.2553146157052307, 'support': 136650}, 'weighted avg': {'precision': 0.341846464606599, 'recall': 0.3027735089645079, 'f1-score': 0.2434446398027065, 'support': 136650}}
[[ 4525 38512  6554]
 [ 3712 30022  5247]
 [ 4225 37026  6827]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1036538
{'0': {'precision': 0.3664498766539583, 'recall': 0.07562364048687925, 'f1-score': 0.12537405048722475, 'support': 21607}, '1': {'precision': 0.3322550233839215, 'recall': 0.8381831747808245, 'f1-score': 0.47587402867317086, 'support': 21444}, '2': {'precision': 0.3449357165255566, 'recall': 0.10053466160946854, 'f1-score': 0.15569158911574255, 'support': 21883}, 'accuracy': 0.3358487079188099, 'macro avg': {'precision': 0.34788020552114546, 'recall': 0.33811382562572406, 'f1-score': 0.2523132227587127, 'support': 64934}, 'weighted avg': {'precision': 0.34790691303532273, 'recall': 0.3358487079188099, 'f1-score': 0.25134134389325674, 'support': 64934}}
[[ 1634 17882  2091]
 [ 1383 17974  2087]
 [ 1442 18241  2200]]
Evaluating performance on  val set...
81/81 - 1s - 570ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1091614
{'0': {'precision': 0.39504643962848296, 'recall': 0.08532834024341314, 'f1-score': 0.1403431588209415, 'support': 7477}, '1': {'precision': 0.2847205847677435, 'recall': 0.8167061210686507, 'f1-score': 0.4222397062680304, 'support': 5914}, '2': {'precision': 0.36180657830142365, 'recall': 0.10200692041522491, 'f1-score': 0.15914489311163896, 'support': 7225}, 'accuracy': 0.30097982149786573, 'macro avg': {'precision': 0.3471912008992167, 'recall': 0.33468046057576295, 'f1-score': 0.24057591940020362, 'support': 20616}, 'weighted avg': {'precision': 0.35174875318424464, 'recall': 0.30097982149786573, 'f1-score': 0.22779847080446752, 'support': 20616}}
[[ 638 6141  698]
 [ 482 4830  602]
 [ 495 5993  737]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
1613/1613 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0774288
{'0': {'precision': 0.46699045900443453, 'recall': 0.18947843968095712, 'f1-score': 0.2695775038093918, 'support': 128384}, '1': {'precision': 0.38233440751732894, 'recall': 0.7642620789578453, 'f1-score': 0.5096887921653972, 'support': 153221}, '2': {'precision': 0.4195869664983938, 'recall': 0.17416184090216397, 'f1-score': 0.24615136095630405, 'support': 131240}, 'accuracy': 0.39793142704889245, 'macro avg': {'precision': 0.42297061100671907, 'recall': 0.3759674531803221, 'f1-score': 0.3418058856436977, 'support': 412845}, 'weighted avg': {'precision': 0.42050250536227196, 'recall': 0.39793142704889245, 'f1-score': 0.35124409714383037, 'support': 412845}}
[[ 24326  91365  12693]
 [ 17195 117101  18925]
 [ 10570  97813  22857]]
Evaluating performance on  train set...
634/634 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0885209
{'0': {'precision': 0.4566063659262652, 'recall': 0.18355549009499963, 'f1-score': 0.26184817008312433, 'support': 54316}, '1': {'precision': 0.34443543153796236, 'recall': 0.7852862849533955, 'f1-score': 0.47884433217556044, 'support': 54072}, '2': {'precision': 0.41063792396461835, 'recall': 0.13030224171902302, 'f1-score': 0.1978297986425659, 'support': 53798}, 'accuracy': 0.3665051237468092, 'macro avg': {'precision': 0.403893240476282, 'recall': 0.36638133892247265, 'f1-score': 0.31284076696708357, 'support': 162186}, 'weighted avg': {'precision': 0.4039611499094883, 'recall': 0.3665051237468092, 'f1-score': 0.31295835302063457, 'support': 162186}}
[[ 9970 39566  4780]
 [ 6329 42462  5281]
 [ 5536 41252  7010]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.080118
{'0': {'precision': 0.4333100558659218, 'recall': 0.1552802802802803, 'f1-score': 0.22862932940309505, 'support': 15984}, '1': {'precision': 0.3932442711799943, 'recall': 0.8192037238783797, 'f1-score': 0.5313995695608879, 'support': 20194}, '2': {'precision': 0.3914453679302656, 'recall': 0.11666968763216724, 'f1-score': 0.17976168311301433, 'support': 16551}, 'accuracy': 0.3974283601054448, 'macro avg': {'precision': 0.4059998983253939, 'recall': 0.3637178972636091, 'f1-score': 0.3132635273589991, 'support': 52729}, 'weighted avg': {'precision': 0.4048249545749687, 'recall': 0.3974283601054448, 'f1-score': 0.32924443334967746, 'support': 52729}}
[[ 2482 12287  1215]
 [ 1864 16543  1787]
 [ 1382 13238  1931]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908952
{'0': {'precision': 0.3394776378134751, 'recall': 0.14939985759332722, 'f1-score': 0.20748719759844603, 'support': 78648}, '1': {'precision': 0.3989251489251489, 'recall': 0.7928194569553468, 'f1-score': 0.5307775145380143, 'support': 101023}, '2': {'precision': 0.3223934929753711, 'recall': 0.0773323873714083, 'f1-score': 0.12474277854195323, 'support': 73294}, 'accuracy': 0.38547229853932363, 'macro avg': {'precision': 0.35359875990466505, 'recall': 0.3398505673066941, 'f1-score': 0.2876691635594712, 'support': 252965}, 'weighted avg': {'precision': 0.3582683820004995, 'recall': 0.38547229853932363, 'f1-score': 0.31262066759571605, 'support': 252965}}
[[11750 61903  4995]
 [14012 80093  6918]
 [ 8850 58776  5668]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035852
{'0': {'precision': 0.3677751385589865, 'recall': 0.1626343615419628, 'f1-score': 0.22553470418295257, 'support': 28561}, '1': {'precision': 0.3319709758625796, 'recall': 0.784724166900028, 'f1-score': 0.4665653811733856, 'support': 28568}, '2': {'precision': 0.3686520376175549, 'recall': 0.07997007922205977, 'f1-score': 0.13142968902796792, 'support': 29411}, 'accuracy': 0.33990062398890686, 'macro avg': {'precision': 0.3561327173463737, 'recall': 0.34244286922135014, 'f1-score': 0.2745099247947687, 'support': 86540}, 'weighted avg': {'precision': 0.35625372832441987, 'recall': 0.33990062398890686, 'f1-score': 0.27312011878359316, 'support': 86540}}
[[ 4645 21962  1954]
 [ 4076 22418  2074]
 [ 3909 23150  2352]]
Evaluating performance on  val set...
124/124 - 1s - 934ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.104862
{'0': {'precision': 0.36889153754469606, 'recall': 0.17954171903702987, 'f1-score': 0.24152955713077973, 'support': 10343}, '1': {'precision': 0.32313543906069125, 'recall': 0.7669512314787558, 'f1-score': 0.45469618080805146, 'support': 10191}, '2': {'precision': 0.40865800865800866, 'recall': 0.08583378796144754, 'f1-score': 0.14186955214908328, 'support': 10998}, 'accuracy': 0.3367055689458328, 'macro avg': {'precision': 0.36689499508779866, 'recall': 0.3441089128257444, 'f1-score': 0.2793650966959715, 'support': 31532}, 'weighted avg': {'precision': 0.36797346224511845, 'recall': 0.3367055689458328, 'f1-score': 0.27566378036769396, 'support': 31532}}
[[1857 7830  656]
 [1665 7816  710]
 [1512 8542  944]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958717
{'0': {'precision': 0.38226921512810086, 'recall': 0.20186293721311035, 'f1-score': 0.26420729029424683, 'support': 74506}, '1': {'precision': 0.3808425782593739, 'recall': 0.8016631781410873, 'f1-score': 0.516373759715486, 'support': 88385}, '2': {'precision': 0.3552841210833776, 'recall': 0.054390980907600375, 'f1-score': 0.09433940091895132, 'support': 73799}, 'accuracy': 0.37985973213908486, 'macro avg': {'precision': 0.3727986381569508, 'recall': 0.35263903208726605, 'f1-score': 0.2916401503095614, 'support': 236690}, 'weighted avg': {'precision': 0.37332263413587913, 'recall': 0.37985973213908486, 'f1-score': 0.3054073960519417, 'support': 236690}}
[[15040 56832  2634]
 [12880 70855  4650]
 [11424 58361  4014]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022861
{'0': {'precision': 0.35304192929569744, 'recall': 0.1722719978603905, 'f1-score': 0.23155387795452503, 'support': 29912}, '1': {'precision': 0.31993192024943506, 'recall': 0.7621724760639204, 'f1-score': 0.45068351012924734, 'support': 29349}, '2': {'precision': 0.4004932182490752, 'recall': 0.05541149174286884, 'f1-score': 0.09735335551359289, 'support': 29308}, 'accuracy': 0.3290767650080728, 'macro avg': {'precision': 0.3578223559314026, 'recall': 0.32995198855572655, 'f1-score': 0.2598635811991218, 'support': 88569}, 'weighted avg': {'precision': 0.3577722155261713, 'recall': 0.3290767650080728, 'f1-score': 0.25975885557645917, 'support': 88569}}
[[ 5153 23577  1182]
 [ 5731 22369  1249]
 [ 3712 23972  1624]]
Evaluating performance on  val set...
127/127 - 1s - 798ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045523
{'0': {'precision': 0.3715036605969589, 'recall': 0.179046412738623, 'f1-score': 0.24163614163614167, 'support': 11053}, '1': {'precision': 0.28161445687218883, 'recall': 0.7366722199083715, 'f1-score': 0.40746393296282435, 'support': 9604}, '2': {'precision': 0.44560439560439563, 'recall': 0.06983552914836821, 'f1-score': 0.12074741308717336, 'support': 11613}, 'accuracy': 0.3057018903005888, 'macro avg': {'precision': 0.36624083769118115, 'recall': 0.32851805393178757, 'f1-score': 0.2566158292287131, 'support': 32270}, 'weighted avg': {'precision': 0.37141800590432394, 'recall': 0.3057018903005888, 'f1-score': 0.24748458611281632, 'support': 32270}}
[[1979 8552  522]
 [2042 7075  487]
 [1306 9496  811]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936307
{'0': {'precision': 0.3591282375236892, 'recall': 0.14038336883044727, 'f1-score': 0.20185970129380176, 'support': 129588}, '1': {'precision': 0.3741585650719686, 'recall': 0.8187241311346166, 'f1-score': 0.5136006198585535, 'support': 152210}, '2': {'precision': 0.3382460361792635, 'recall': 0.062878914955309, 'f1-score': 0.10604448156480273, 'support': 125193}, 'accuracy': 0.3702342312237863, 'macro avg': {'precision': 0.3571776129249738, 'recall': 0.340662138306791, 'f1-score': 0.2738349342390527, 'support': 406991}, 'weighted avg': {'precision': 0.358325911976468, 'recall': 0.3702342312237863, 'f1-score': 0.28897388910436345, 'support': 406991}}
[[ 18192 104668   6728]
 [ 18919 124618   8673]
 [ 13545 103776   7872]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1032705
{'0': {'precision': 0.36550843127235566, 'recall': 0.1573332746788668, 'f1-score': 0.2199772426730633, 'support': 45464}, '1': {'precision': 0.3294520610009152, 'recall': 0.8015785528462455, 'f1-score': 0.46697534630130305, 'support': 45358}, '2': {'precision': 0.3781338847247351, 'recall': 0.062461308570818656, 'f1-score': 0.10721286847553267, 'support': 46845}, 'accuracy': 0.33731395323498004, 'macro avg': {'precision': 0.35769812566600195, 'recall': 0.34045771203197694, 'f1-score': 0.26472181914996634, 'support': 137667}, 'weighted avg': {'precision': 0.35792487474976653, 'recall': 0.33731395323498004, 'f1-score': 0.26298604561847777, 'support': 137667}}
[[ 7153 35957  2354]
 [ 6542 36358  2458]
 [ 5875 38044  2926]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039046
{'0': {'precision': 0.40609137055837563, 'recall': 0.15126050420168066, 'f1-score': 0.2204194091535282, 'support': 19040}, '1': {'precision': 0.3195550351288056, 'recall': 0.8003401959059182, 'f1-score': 0.4567440459254548, 'support': 17049}, '2': {'precision': 0.3663152203298189, 'recall': 0.07786461326284336, 'f1-score': 0.12842993223069998, 'support': 17402}, 'accuracy': 0.3342618384401114, 'macro avg': {'precision': 0.3639872086723333, 'recall': 0.34315510445681413, 'f1-score': 0.2685311291032277, 'support': 53491}, 'weighted avg': {'precision': 0.36556973983514957, 'recall': 0.3342618384401114, 'f1-score': 0.2658157908796788, 'support': 53491}}
[[ 2880 14968  1192]
 [ 2252 13645  1152]
 [ 1960 14087  1355]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/EXC
Evaluating performance on  test set...
3782/3782 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0928165
{'0': {'precision': 0.42500132682305486, 'recall': 0.2008975050488579, 'f1-score': 0.2728290958647417, 'support': 318884}, '1': {'precision': 0.3091969452405266, 'recall': 0.7575266412668095, 'f1-score': 0.43914829742335115, 'support': 297377}, '2': {'precision': 0.4517733856775416, 'recall': 0.11387114109989849, 'f1-score': 0.18189498354646844, 'support': 351687}, 'accuracy': 0.3402879080281172, 'macro avg': {'precision': 0.39532388591370765, 'recall': 0.35743176247185526, 'f1-score': 0.29795745894485376, 'support': 967948}, 'weighted avg': {'precision': 0.39915058430433525, 'recall': 0.3402879080281172, 'f1-score': 0.29088704943561333, 'support': 967948}}
[[ 64063 231285  23536]
 [ 47045 225271  25061]
 [ 39628 272012  40047]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971695
{'0': {'precision': 0.4046224473642552, 'recall': 0.20567365510380242, 'f1-score': 0.2727206592010243, 'support': 136702}, '1': {'precision': 0.33269271698628655, 'recall': 0.7728785541919725, 'f1-score': 0.46515511536497073, 'support': 135509}, '2': {'precision': 0.3971408373262116, 'recall': 0.07352096496266514, 'f1-score': 0.12407285844872118, 'support': 137539}, 'accuracy': 0.348895668090299, 'macro avg': {'precision': 0.3781520005589178, 'recall': 0.3506910580861467, 'f1-score': 0.2873162110049054, 'support': 409750}, 'weighted avg': {'precision': 0.37832314535861605, 'recall': 0.348895668090299, 'f1-score': 0.2864649687865013, 'support': 409750}}
[[ 28116 101267   7319]
 [ 22746 104732   8031]
 [ 18625 108802  10112]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939713
{'0': {'precision': 0.4200723806161179, 'recall': 0.20772135047249077, 'f1-score': 0.2779830312942653, 'support': 45821}, '1': {'precision': 0.33963181527842656, 'recall': 0.7767360732584759, 'f1-score': 0.47261173536396067, 'support': 45865}, '2': {'precision': 0.3868943882886023, 'recall': 0.07487857528332434, 'f1-score': 0.12547335104278529, 'support': 44472}, 'accuracy': 0.35600552299534366, 'macro avg': {'precision': 0.3821995280610489, 'recall': 0.3531119996714303, 'f1-score': 0.2920227059003371, 'support': 136158}, 'weighted avg': {'precision': 0.3821392573034776, 'recall': 0.35600552299534366, 'f1-score': 0.29373116957488604, 'support': 136158}}
[[ 9518 33805  2498]
 [ 7461 35625  2779]
 [ 5679 35463  3330]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/AAL
Evaluating performance on  test set...
4457/4457 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1047934
{'0': {'precision': 0.43441409710667905, 'recall': 0.1904632204216779, 'f1-score': 0.26481968735489864, 'support': 422218}, '1': {'precision': 0.2882365212114316, 'recall': 0.7033383002156429, 'f1-score': 0.40890063060930204, 'support': 324147}, '2': {'precision': 0.4022829554690248, 'recall': 0.1680883955498112, 'f1-score': 0.23710551527890986, 'support': 394590}, 'accuracy': 0.3284336367341394, 'macro avg': {'precision': 0.3749778579290452, 'recall': 0.3539633053957107, 'f1-score': 0.3036086110810368, 'support': 1140955}, 'weighted avg': {'precision': 0.3817725381735758, 'recall': 0.3284336367341394, 'f1-score': 0.2961685752195565, 'support': 1140955}}
[[ 80417 289271  52530]
 [ 50144 227985  46018]
 [ 54555 273709  66326]]
Evaluating performance on  train set...
2425/2425 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969814
{'0': {'precision': 0.40853388626144493, 'recall': 0.16993739582121953, 'f1-score': 0.24002984032687474, 'support': 206376}, '1': {'precision': 0.33488620206704395, 'recall': 0.770072475454621, 'f1-score': 0.46678061699064505, 'support': 204621}, '2': {'precision': 0.3973524339273784, 'recall': 0.12193365977390733, 'f1-score': 0.18660479098716518, 'support': 209737}, 'accuracy': 0.3515483282694359, 'macro avg': {'precision': 0.38025750741862246, 'recall': 0.3539811770165826, 'f1-score': 0.2978050827682283, 'support': 620734}, 'weighted avg': {'precision': 0.3804783470840636, 'recall': 0.3515483282694359, 'f1-score': 0.2967252381919098, 'support': 620734}}
[[ 35071 152617  18688]
 [ 26949 157573  20099]
 [ 23826 160337  25574]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991153
{'0': {'precision': 0.4168012924071082, 'recall': 0.16407469503382088, 'f1-score': 0.23546005143947568, 'support': 69188}, '1': {'precision': 0.3242116732743456, 'recall': 0.7676514927808775, 'f1-score': 0.45588418531457237, 'support': 64343}, '2': {'precision': 0.40128477678158797, 'recall': 0.12827406893087706, 'f1-score': 0.19440495247903816, 'support': 67691}, 'accuracy': 0.3450318553637276, 'macro avg': {'precision': 0.3807659141543473, 'recall': 0.3533334189151918, 'f1-score': 0.2952497297443621, 'support': 201222}, 'weighted avg': {'precision': 0.3819749696239809, 'recall': 0.3450318553637276, 'f1-score': 0.292132231132523, 'support': 201222}}
[[11352 51458  6378]
 [ 8373 49393  6577]
 [ 7511 51497  8683]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/WBA
Evaluating performance on  test set...
4676/4676 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876199
{'0': {'precision': 0.40703145322732054, 'recall': 0.18333838524061938, 'f1-score': 0.2528059006892919, 'support': 392591}, '1': {'precision': 0.34598950685755386, 'recall': 0.7561095383904327, 'f1-score': 0.4747412992434518, 'support': 415416}, '2': {'precision': 0.3996883903133903, 'recall': 0.11541269686203333, 'f1-score': 0.17910703812901707, 'support': 388978}, 'accuracy': 0.36004628295258506, 'macro avg': {'precision': 0.3842364501327549, 'recall': 0.3516202068310285, 'f1-score': 0.30221807935392025, 'support': 1196985}, 'weighted avg': {'precision': 0.3834604885792441, 'recall': 0.36004628295258506, 'f1-score': 0.30587948086348316, 'support': 1196985}}
[[ 71977 290533  30081]
 [ 63970 314100  37346]
 [ 40887 303198  44893]]
Evaluating performance on  train set...
2108/2108 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092772
{'0': {'precision': 0.3928091519883784, 'recall': 0.1801955895174681, 'f1-score': 0.2470572111650855, 'support': 180071}, '1': {'precision': 0.3385703558365429, 'recall': 0.7635394246632214, 'f1-score': 0.46912171414762505, 'support': 183058}, '2': {'precision': 0.38726917129082145, 'recall': 0.09660309284198822, 'f1-score': 0.15463337116912598, 'support': 176278}, 'accuracy': 0.35084639242723953, 'macro avg': {'precision': 0.37288289303858085, 'recall': 0.3467793690075593, 'f1-score': 0.29027076549394554, 'support': 539407}, 'weighted avg': {'precision': 0.37259172384345884, 'recall': 0.35084639242723953, 'f1-score': 0.2922149382990863, 'support': 539407}}
[[ 32448 134919  12704]
 [ 29047 139772  14239]
 [ 21110 138139  17029]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967008
{'0': {'precision': 0.4076772934287573, 'recall': 0.1808265035207203, 'f1-score': 0.25052976690256284, 'support': 69304}, '1': {'precision': 0.3200012770168886, 'recall': 0.7645614035087719, 'f1-score': 0.4511691760628362, 'support': 65550}, '2': {'precision': 0.40824325929445304, 'recall': 0.09913612829720647, 'f1-score': 0.15953212574120706, 'support': 69339}, 'accuracy': 0.34047690175471246, 'macro avg': {'precision': 0.37864060991336634, 'recall': 0.3481746784422329, 'f1-score': 0.287077022902202, 'support': 204193}, 'weighted avg': {'precision': 0.3797237427750301, 'recall': 0.34047690175471246, 'f1-score': 0.2840383976096325, 'support': 204193}}
[[12532 51860  4912]
 [10381 50117  5052]
 [ 7827 54638  6874]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
4274/4274 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003591
{'0': {'precision': 0.40640402950170895, 'recall': 0.11802042058357211, 'f1-score': 0.1829204358448593, 'support': 382849}, '1': {'precision': 0.2892651031885735, 'recall': 0.7357926376771828, 'f1-score': 0.4152724764232707, 'support': 320714}, '2': {'precision': 0.40205753682081236, 'recall': 0.17203929341507512, 'f1-score': 0.24096873873502261, 'support': 390498}, 'accuracy': 0.31839540939673383, 'macro avg': {'precision': 0.36590888983703157, 'recall': 0.34195078389194333, 'f1-score': 0.2797205503343842, 'support': 1094061}, 'weighted avg': {'precision': 0.37051444901899755, 'recall': 0.31839540939673383, 'f1-score': 0.2717512218102375, 'support': 1094061}}
[[ 45184 288288  49377]
 [ 34200 235979  50535]
 [ 31796 291521  67181]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942152
{'0': {'precision': 0.3922963463724918, 'recall': 0.1540201596120089, 'f1-score': 0.22119612064297875, 'support': 165777}, '1': {'precision': 0.3315667228654235, 'recall': 0.7798203054806828, 'f1-score': 0.4652968885140206, 'support': 166950}, '2': {'precision': 0.40239554198603666, 'recall': 0.10967122490544079, 'f1-score': 0.17236506971150548, 'support': 171850}, 'accuracy': 0.3459749453502637, 'macro avg': {'precision': 0.37541953707465064, 'recall': 0.3478372299993775, 'f1-score': 0.2862860262895016, 'support': 504577}, 'weighted avg': {'precision': 0.37564227003068995, 'recall': 0.3459749453502637, 'f1-score': 0.28533104374390633, 'support': 504577}}
[[ 25533 127104  13140]
 [ 21909 130191  14850]
 [ 17644 135359  18847]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096708
{'0': {'precision': 0.3982586262495969, 'recall': 0.14318840579710146, 'f1-score': 0.2106430155210643, 'support': 60375}, '1': {'precision': 0.33619783528877023, 'recall': 0.7838325633765503, 'f1-score': 0.4705636763967654, 'support': 60393}, '2': {'precision': 0.381296935810996, 'recall': 0.11596039075784349, 'f1-score': 0.17783686356721934, 'support': 59986}, 'accuracy': 0.34820252940460517, 'macro avg': {'precision': 0.37191779911645434, 'recall': 0.3476604533104984, 'f1-score': 0.2863478518283497, 'support': 180754}, 'weighted avg': {'precision': 0.3718940572157326, 'recall': 0.34820252940460517, 'f1-score': 0.28659972265431094, 'support': 180754}}
[[ 8645 46282  5448]
 [ 7216 47338  5839]
 [ 5846 47184  6956]]
testing model on single stock: results/universal/W4/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
12724/12724 - 72s - 72s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0774815
{'0': {'precision': 0.32782689142807814, 'recall': 0.19704260142794303, 'f1-score': 0.2461406669057212, 'support': 886590}, '1': {'precision': 0.44964396429706704, 'recall': 0.7477328246944018, 'f1-score': 0.5615835460011246, 'support': 1458533}, '2': {'precision': 0.3172263071758709, 'recall': 0.10392864191574747, 'f1-score': 0.15656422585485952, 'support': 912020}, 'accuracy': 0.4175665606330456, 'macro avg': {'precision': 0.3648990543003387, 'recall': 0.3495680226793641, 'f1-score': 0.3214294795872351, 'support': 3257143}, 'weighted avg': {'precision': 0.37940776334347365, 'recall': 0.4175665606330456, 'f1-score': 0.3623125215060409, 'support': 3257143}}
[[ 174696  641363   70531]
 [ 234463 1090593  133477]
 [ 123732  693503   94785]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976708
{'0': {'precision': 0.3823064476267306, 'recall': 0.1871988894013636, 'f1-score': 0.25133159517054376, 'support': 437962}, '1': {'precision': 0.335202064930885, 'recall': 0.7211751048311726, 'f1-score': 0.4576762755495877, 'support': 441901}, '2': {'precision': 0.38475117418762783, 'recall': 0.13651894111555063, 'f1-score': 0.20153015241439626, 'support': 442239}, 'accuracy': 0.3487234721678055, 'macro avg': {'precision': 0.3674198955817478, 'recall': 0.34829764511602895, 'f1-score': 0.3035126743781759, 'support': 1322102}, 'weighted avg': {'precision': 0.3673799741866237, 'recall': 0.3487234721678055, 'f1-score': 0.303642067706811, 'support': 1322102}}
[[ 81986 310581  45395]
 [ 72065 318688  51148]
 [ 60400 321465  60374]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957476
{'0': {'precision': 0.3747409094398526, 'recall': 0.18392298707659846, 'f1-score': 0.24674394702700878, 'support': 159246}, '1': {'precision': 0.3479607524599978, 'recall': 0.7304944033703689, 'f1-score': 0.4713842404858453, 'support': 169477}, '2': {'precision': 0.3717011008897602, 'recall': 0.12457984786069903, 'f1-score': 0.18661391985765932, 'support': 158276}, 'accuracy': 0.3548446711389551, 'macro avg': {'precision': 0.3648009209298702, 'recall': 0.34633241276922216, 'f1-score': 0.3015807024568378, 'support': 486999}, 'weighted avg': {'precision': 0.3644333946347929, 'recall': 0.3548446711389551, 'f1-score': 0.30537696852041485, 'support': 486999}}
[[ 29289 114551  15406]
 [ 27751 123802  17924]
 [ 21118 117440  19718]]
training model: results/universal/W4/deepLOB_L2/h50
Epoch 1/50
9854/9854 - 402s - loss: 3.0165 - accuracy50: 0.4824 - val_loss: 3.3384 - val_accuracy50: 0.4277 - 402s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 398s - loss: 2.9474 - accuracy50: 0.5054 - val_loss: 3.2088 - val_accuracy50: 0.4552 - 398s/epoch - 40ms/step
Epoch 3/50
9854/9854 - 401s - loss: 2.9062 - accuracy50: 0.5153 - val_loss: 3.1491 - val_accuracy50: 0.4644 - 401s/epoch - 41ms/step
Epoch 4/50
9854/9854 - 397s - loss: 2.8811 - accuracy50: 0.5208 - val_loss: 3.2359 - val_accuracy50: 0.4608 - 397s/epoch - 40ms/step
Epoch 5/50
9854/9854 - 396s - loss: 2.8667 - accuracy50: 0.5236 - val_loss: 3.2952 - val_accuracy50: 0.4524 - 396s/epoch - 40ms/step
Epoch 6/50
9854/9854 - 397s - loss: 2.8559 - accuracy50: 0.5258 - val_loss: 3.3350 - val_accuracy50: 0.4516 - 397s/epoch - 40ms/step
Epoch 7/50
9854/9854 - 395s - loss: 2.8479 - accuracy50: 0.5277 - val_loss: 3.3290 - val_accuracy50: 0.4500 - 395s/epoch - 40ms/step
Epoch 8/50
9854/9854 - 398s - loss: 2.8419 - accuracy50: 0.5288 - val_loss: 3.3258 - val_accuracy50: 0.4532 - 398s/epoch - 40ms/step
Epoch 9/50
9854/9854 - 396s - loss: 2.8370 - accuracy50: 0.5299 - val_loss: 3.3401 - val_accuracy50: 0.4534 - 396s/epoch - 40ms/step
Epoch 10/50
9854/9854 - 397s - loss: 2.8327 - accuracy50: 0.5306 - val_loss: 3.4009 - val_accuracy50: 0.4480 - 397s/epoch - 40ms/step
Epoch 11/50
9854/9854 - 397s - loss: 2.8296 - accuracy50: 0.5313 - val_loss: 3.4005 - val_accuracy50: 0.4490 - 397s/epoch - 40ms/step
Epoch 12/50
9854/9854 - 398s - loss: 2.8261 - accuracy50: 0.5322 - val_loss: 3.4400 - val_accuracy50: 0.4431 - 398s/epoch - 40ms/step
Epoch 13/50
9854/9854 - 400s - loss: 2.8234 - accuracy50: 0.5324 - val_loss: 3.4655 - val_accuracy50: 0.4435 - 400s/epoch - 41ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 312s - 312s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1611506
{'0': {'precision': 0.3362513881044272, 'recall': 0.7359346960213595, 'f1-score': 0.4615972297255826, 'support': 1599290}, '1': {'precision': 0.5435391001170089, 'recall': 0.3197142603986652, 'f1-score': 0.40260996212712746, 'support': 2866666}, '2': {'precision': 0.4181201752909371, 'recall': 0.23049620875955595, 'f1-score': 0.29717138691007666, 'support': 1605675}, 'accuracy': 0.40575407168189237, 'macro avg': {'precision': 0.43263688783745774, 'recall': 0.4287150550598602, 'f1-score': 0.3871261929209289, 'support': 6071631}, 'weighted avg': {'precision': 0.45577105277277724, 'recall': 0.40575407168189237, 'f1-score': 0.39026363589878704, 'support': 6071631}}
[[1176973  287947  134370]
 [1569467  916514  380685]
 [ 753837  481736  370102]]
Evaluating performance on  train set...
9854/9854 - 136s - 136s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0692731
{'0': {'precision': 0.4123419773673109, 'recall': 0.5985162026890917, 'f1-score': 0.4882848244635544, 'support': 773421}, '1': {'precision': 0.49057135859282225, 'recall': 0.5149384057711237, 'f1-score': 0.502459632444361, 'support': 976309}, '2': {'precision': 0.44738809157696907, 'recall': 0.21700166647459695, 'f1-score': 0.29225002419605867, 'support': 772289}, 'accuracy': 0.44933523498435185, 'macro avg': {'precision': 0.45010047584570073, 'recall': 0.44348542497827087, 'f1-score': 0.42766482703465797, 'support': 2522019}, 'weighted avg': {'precision': 0.453357440554448, 'recall': 0.44933523498435185, 'f1-score': 0.4337425996592009, 'support': 2522019}}
[[462905 234934  75582]
 [342148 502739 131422]
 [317571 287130 167588]]
Evaluating performance on  val set...
3566/3566 - 47s - 47s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.049938
{'0': {'precision': 0.43354046591003365, 'recall': 0.3997595891159436, 'f1-score': 0.4159653115873777, 'support': 274530}, '1': {'precision': 0.5053888288375822, 'recall': 0.5699989041696345, 'f1-score': 0.5357529563991477, 'support': 365020}, '2': {'precision': 0.4286626159464788, 'recall': 0.3889487613727172, 'f1-score': 0.407841177714143, 'support': 272802}, 'accuracy': 0.4646375521728456, 'macro avg': {'precision': 0.4558639702313649, 'recall': 0.4529024182194317, 'f1-score': 0.45318648190022276, 'support': 912352}, 'weighted avg': {'precision': 0.46082752420557754, 'recall': 0.4646375521728456, 'f1-score': 0.46146157414865463, 'support': 912352}}
[[109746  99061  65723]
 [ 81260 208061  75699]
 [ 62133 104563 106106]]
testing model out of sample: results/universal/W4/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 158s - 158s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2563287
{'0': {'precision': 0.3694440766298706, 'recall': 0.763604076025927, 'f1-score': 0.49796471953457117, 'support': 957305}, '1': {'precision': 0.48966532141184865, 'recall': 0.11511064130900069, 'f1-score': 0.1864018831731014, 'support': 1144690}, '2': {'precision': 0.41565568814150894, 'recall': 0.35048787335407955, 'f1-score': 0.38030020874901743, 'support': 929647}, 'accuracy': 0.3920641025556448, 'macro avg': {'precision': 0.42492169539440944, 'recall': 0.4097341968963357, 'f1-score': 0.35488893715222997, 'support': 3031642}, 'weighted avg': {'precision': 0.4290080167970944, 'recall': 0.3920641025556448, 'f1-score': 0.3442429665660912, 'support': 3031642}}
[[731002  62520 163783]
 [718643 131766 294281]
 [529009  74808 325830]]
Evaluating performance on  train set...
5528/5528 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0632409
{'0': {'precision': 0.3825512305484544, 'recall': 0.632339754026501, 'f1-score': 0.4767060791831856, 'support': 399230}, '1': {'precision': 0.5922620421858543, 'recall': 0.4390536903890634, 'f1-score': 0.5042778405984857, 'support': 613499}, '2': {'precision': 0.4452424956131279, 'recall': 0.33222148929020373, 'f1-score': 0.3805169830632665, 'support': 401735}, 'accuracy': 0.46326594384869463, 'macro avg': {'precision': 0.4733519227824789, 'recall': 0.4678716445685894, 'f1-score': 0.45383363428164586, 'support': 1414464}, 'weighted avg': {'precision': 0.4913151500257191, 'recall': 0.46326594384869463, 'f1-score': 0.4613452934203733, 'support': 1414464}}
[[252449  79899  66882]
 [244729 269359  99411]
 [162731 105539 133465]]
Evaluating performance on  val set...
1908/1908 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851548
{'0': {'precision': 0.4468871623479028, 'recall': 0.4314529365339889, 'f1-score': 0.43903444403776654, 'support': 143179}, '1': {'precision': 0.5379578855632707, 'recall': 0.46881919820090845, 'f1-score': 0.5010145515682068, 'support': 202769}, '2': {'precision': 0.3939388674612275, 'recall': 0.48015444451503153, 'f1-score': 0.4327947496842621, 'support': 141669}, 'accuracy': 0.4611406083052888, 'macro avg': {'precision': 0.459594638457467, 'recall': 0.4601421930833096, 'f1-score': 0.45761458176341185, 'support': 487617}, 'weighted avg': {'precision': 0.4693744576787804, 'recall': 0.4611406083052888, 'f1-score': 0.46299520251106263, 'support': 487617}}
[[61775 39653 41751]
 [44807 95062 62900]
 [31652 41994 68023]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2019745
{'0': {'precision': 0.41364570338298967, 'recall': 0.4498244354002075, 'f1-score': 0.4309771389249943, 'support': 50124}, '1': {'precision': 0.2609383774952775, 'recall': 0.13812393589708943, 'f1-score': 0.18063262060434707, 'support': 37003}, '2': {'precision': 0.3833501174890903, 'recall': 0.4842207280877097, 'f1-score': 0.4279214174830041, 'support': 49527}, 'accuracy': 0.3778886823656827, 'macro avg': {'precision': 0.3526447327891192, 'recall': 0.3573896997950022, 'f1-score': 0.34651039233744846, 'support': 136654}, 'weighted avg': {'precision': 0.3613158874801243, 'recall': 0.3778886823656827, 'f1-score': 0.3620816881714389, 'support': 136654}}
[[22547  6472 21105]
 [14420  5111 17472]
 [17541  8004 23982]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.283226
{'0': {'precision': 0.3537289234760052, 'recall': 0.511175671243147, 'f1-score': 0.4181215384910216, 'support': 21341}, '1': {'precision': 0.3693652776200749, 'recall': 0.14898099381726584, 'f1-score': 0.21232295542066443, 'support': 21835}, '2': {'precision': 0.3763296294831745, 'recall': 0.4373621323529412, 'f1-score': 0.40455695126357627, 'support': 21760}, 'accuracy': 0.3646513490205741, 'macro avg': {'precision': 0.36647461019308486, 'recall': 0.3658395991377847, 'f1-score': 0.3450004817250874, 'support': 64936}, 'weighted avg': {'precision': 0.3665601904997173, 'recall': 0.3646513490205741, 'f1-score': 0.34437542725210235, 'support': 64936}}
[[10909  2592  7840]
 [10650  3253  7932]
 [ 9281  2962  9517]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2876136
{'0': {'precision': 0.3754433166197872, 'recall': 0.4216453783820904, 'f1-score': 0.3972053305731659, 'support': 7281}, '1': {'precision': 0.332657200811359, 'recall': 0.08016946390744664, 'f1-score': 0.12920168067226892, 'support': 6137}, '2': {'precision': 0.3748745552413101, 'recall': 0.5707737185720239, 'f1-score': 0.452533039647577, 'support': 7199}, 'accuracy': 0.3720715914051511, 'macro avg': {'precision': 0.3609916908908188, 'recall': 0.35752952028718693, 'f1-score': 0.32631335029767067, 'support': 20617}, 'weighted avg': {'precision': 0.36250870412136454, 'recall': 0.3720715914051511, 'f1-score': 0.33674870634000303, 'support': 20617}}
[[3070  473 3738]
 [2531  492 3114]
 [2576  514 4109]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
1613/1613 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.7970977
{'0': {'precision': 0.210195530726257, 'recall': 0.865679143339802, 'f1-score': 0.33825851906202353, 'support': 71627}, '1': {'precision': 0.848930286712269, 'recall': 0.02172342390656656, 'f1-score': 0.04236281832938126, 'support': 268512}, '2': {'precision': 0.26791667417512116, 'recall': 0.4089533764269014, 'f1-score': 0.32374139883285424, 'support': 72710}, 'accuracy': 0.23634306974220598, 'macro avg': {'precision': 0.4423474972045491, 'recall': 0.43211864789108995, 'f1-score': 0.23478757874141967, 'support': 412849}, 'weighted avg': {'precision': 0.6357866091580394, 'recall': 0.23634306974220598, 'f1-score': 0.14325481018302386, 'support': 412849}}
[[ 62006    260   9361]
 [190789   5833  71890]
 [ 42197    778  29735]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.093116
{'0': {'precision': 0.3436782723951767, 'recall': 0.6540745070292553, 'f1-score': 0.4505949794962542, 'support': 32507}, '1': {'precision': 0.7607531626949102, 'recall': 0.4001795220997895, 'f1-score': 0.5244711275175953, 'support': 96924}, '2': {'precision': 0.3382385730211817, 'recall': 0.5094489390932682, 'f1-score': 0.406553782433914, 'support': 32755}, 'accuracy': 0.47313578237332443, 'macro avg': {'precision': 0.4808900027037562, 'recall': 0.521234322740771, 'f1-score': 0.46053996314925455, 'support': 162186}, 'weighted avg': {'precision': 0.5918278618444274, 'recall': 0.47313578237332443, 'f1-score': 0.4858495782966656, 'support': 162186}}
[[21262  5487  5758]
 [31247 38787 26890]
 [ 9357  6711 16687]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9648743
{'0': {'precision': 0.4235294117647059, 'recall': 0.40851661207299955, 'f1-score': 0.4158875722027035, 'support': 8548}, '1': {'precision': 0.7844724667960006, 'recall': 0.5961216794715505, 'f1-score': 0.6774489746605022, 'support': 35273}, '2': {'precision': 0.30456422148068546, 'recall': 0.6044449433157482, 'f1-score': 0.4050394885295224, 'support': 8909}, 'accuracy': 0.567115494026171, 'macro avg': {'precision': 0.5041887000137973, 'recall': 0.536361078286766, 'f1-score': 0.4994586784642427, 'support': 52730}, 'weighted avg': {'precision': 0.6448774773796977, 'recall': 0.567115494026171, 'f1-score': 0.5890225953669281, 'support': 52730}}
[[ 3492  3011  2045]
 [ 3995 21027 10251]
 [  758  2766  5385]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2812485
{'0': {'precision': 0.32509369205885835, 'recall': 0.5800765852010361, 'f1-score': 0.4166713015163543, 'support': 71032}, '1': {'precision': 0.4810403168292794, 'recall': 0.2736989329005077, 'f1-score': 0.3488892924157133, 'support': 115828}, '2': {'precision': 0.3292054176820676, 'recall': 0.3003827012963439, 'f1-score': 0.3141343035671913, 'support': 66109}, 'accuracy': 0.36670105823243165, 'macro avg': {'precision': 0.37844647552340177, 'recall': 0.38471940646596253, 'f1-score': 0.35989829916641963, 'support': 252969}, 'weighted avg': {'precision': 0.3975721685644107, 'recall': 0.36670105823243165, 'f1-score': 0.35883942113761125, 'support': 252969}}
[[41204 16632 13196]
 [56859 31702 27267]
 [28682 17569 19858]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2304441
{'0': {'precision': 0.37189515052081346, 'recall': 0.6772983114446529, 'f1-score': 0.48014778325123153, 'support': 28782}, '1': {'precision': 0.3876683541885567, 'recall': 0.28397998810481756, 'f1-score': 0.3278205205872256, 'support': 28583}, '2': {'precision': 0.4025481571363567, 'recall': 0.18192411831236932, 'f1-score': 0.2505960389962939, 'support': 29177}, 'accuracy': 0.3803817799449978, 'macro avg': {'precision': 0.38737055394857567, 'recall': 0.3810674726206133, 'f1-score': 0.35285478094491696, 'support': 86542}, 'weighted avg': {'precision': 0.3874391436623726, 'recall': 0.3803817799449978, 'f1-score': 0.3524456110013228, 'support': 86542}}
[[19494  5823  3465]
 [16053  8117  4413]
 [16871  6998  5308]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2132822
{'0': {'precision': 0.3849614834003681, 'recall': 0.5419905941069201, 'f1-score': 0.4501753826530613, 'support': 10419}, '1': {'precision': 0.37907813769882737, 'recall': 0.31628402596144534, 'f1-score': 0.3448457963667089, 'support': 10323}, '2': {'precision': 0.40315151515151515, 'recall': 0.3082483781278962, 'f1-score': 0.34936974789915964, 'support': 10790}, 'accuracy': 0.3881136623113028, 'macro avg': {'precision': 0.3890637120835702, 'recall': 0.3888409993987539, 'f1-score': 0.38146364230630997, 'support': 31532}, 'weighted avg': {'precision': 0.38925986805462004, 'recall': 0.3881136623113028, 'f1-score': 0.3811975151461282, 'support': 31532}}
[[5647 2423 2349]
 [4483 3265 2575]
 [4539 2925 3326]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3560925
{'0': {'precision': 0.3276165616439287, 'recall': 0.6562725527308378, 'f1-score': 0.43705282248923144, 'support': 73439}, '1': {'precision': 0.3849913637867039, 'recall': 0.11033756385275686, 'f1-score': 0.17151838632568192, 'support': 94945}, '2': {'precision': 0.3494196113640736, 'recall': 0.3190455277411799, 'f1-score': 0.3335424924626192, 'support': 68310}, 'accuracy': 0.33995792035286065, 'macro avg': {'precision': 0.3540091789315687, 'recall': 0.3618852147749248, 'f1-score': 0.3140379004258442, 'support': 236694}, 'weighted avg': {'precision': 0.3569236708897435, 'recall': 0.33995792035286065, 'f1-score': 0.3006659361056895, 'support': 236694}}
[[48196  8263 16980]
 [60871 10476 23598]
 [38044  8472 21794]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3296759
{'0': {'precision': 0.36049579082127475, 'recall': 0.6133460941883107, 'f1-score': 0.45409565695437054, 'support': 30301}, '1': {'precision': 0.3350532086423734, 'recall': 0.10756807122890569, 'f1-score': 0.16285266457680253, 'support': 28977}, '2': {'precision': 0.3467325803774402, 'recall': 0.3280417861532159, 'f1-score': 0.3371283220770108, 'support': 29292}, 'accuracy': 0.3535169922095518, 'macro avg': {'precision': 0.34742719328036276, 'recall': 0.3496519838568107, 'f1-score': 0.31802554786939463, 'support': 88570}, 'weighted avg': {'precision': 0.3476200804891214, 'recall': 0.3535169922095518, 'f1-score': 0.3201275485276751, 'support': 88570}}
[[18585  3116  8600]
 [16356  3117  9504]
 [16613  3070  9609]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3247185
{'0': {'precision': 0.3767586888736786, 'recall': 0.4520897974082862, 'f1-score': 0.4110009540797279, 'support': 10958}, '1': {'precision': 0.3540683962264151, 'recall': 0.11409842295268859, 'f1-score': 0.1725822675671792, 'support': 10526}, '2': {'precision': 0.3455816910362365, 'recall': 0.5039399276907388, 'f1-score': 0.4100011313497002, 'support': 10787}, 'accuracy': 0.359176970035016, 'macro avg': {'precision': 0.3588029253787767, 'recall': 0.3567093826839045, 'f1-score': 0.33119478433220245, 'support': 32271}, 'weighted avg': {'precision': 0.3589363624481701, 'recall': 0.359176970035016, 'f1-score': 0.33290048672452055, 'support': 32271}}
[[4954 1112 4892]
 [3923 1201 5402]
 [4272 1079 5436]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.301285
{'0': {'precision': 0.35982666738440006, 'recall': 0.4458153746112996, 'f1-score': 0.39823209850800734, 'support': 119951}, '1': {'precision': 0.4553059690728693, 'recall': 0.35426880412054484, 'f1-score': 0.3984825281453158, 'support': 169298}, '2': {'precision': 0.3471535728385314, 'recall': 0.3734054660030914, 'f1-score': 0.35980130607702254, 'support': 117746}, 'accuracy': 0.38678607845305224, 'macro avg': {'precision': 0.38742873643193354, 'recall': 0.3911632149116453, 'f1-score': 0.3855053109101152, 'support': 406995}, 'weighted avg': {'precision': 0.39587686118741144, 'recall': 0.38678607845305224, 'f1-score': 0.38721802008237144, 'support': 406995}}
[[53476 33140 33335]
 [59973 59977 49348]
 [35167 38612 43967]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2737528
{'0': {'precision': 0.37647697050690027, 'recall': 0.6195806023125667, 'f1-score': 0.4683621399176955, 'support': 45923}, '1': {'precision': 0.38838692532553815, 'recall': 0.2573346539011775, 'f1-score': 0.30956194813275256, 'support': 45435}, '2': {'precision': 0.39549205952232086, 'recall': 0.2731748396709205, 'f1-score': 0.3231458894749613, 'support': 46311}, 'accuracy': 0.3834995532763367, 'macro avg': {'precision': 0.3867853184515864, 'recall': 0.38336336529488824, 'f1-score': 0.36702332584180314, 'support': 137669}, 'weighted avg': {'precision': 0.38680417986106097, 'recall': 0.3834995532763367, 'f1-score': 0.3671033489916167, 'support': 137669}}
[[28453  8505  8965]
 [23371 11692 10372]
 [23753  9907 12651]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.292235
{'0': {'precision': 0.39502413238336015, 'recall': 0.393644431720584, 'f1-score': 0.39433307522441136, 'support': 17465}, '1': {'precision': 0.4183509513742072, 'recall': 0.26505572224603513, 'f1-score': 0.3245104791892158, 'support': 18664}, '2': {'precision': 0.36780282735028647, 'recall': 0.5139664804469274, 'f1-score': 0.4287704799884688, 'support': 17363}, 'accuracy': 0.38783369475809465, 'macro avg': {'precision': 0.3937259703692846, 'recall': 0.39088887813784884, 'f1-score': 0.3825380114673653, 'support': 53492}, 'weighted avg': {'precision': 0.3943273596015593, 'recall': 0.38783369475809465, 'f1-score': 0.3811491921487634, 'support': 53492}}
[[6875 3452 7138]
 [5516 4947 8201]
 [5013 3426 8924]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
3782/3782 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1635792
{'0': {'precision': 0.34035329115027957, 'recall': 0.7897934495676067, 'f1-score': 0.47570601268737167, 'support': 222367}, '1': {'precision': 0.7265440752937085, 'recall': 0.2632534402337528, 'f1-score': 0.3864734439156368, 'support': 507887}, '2': {'precision': 0.4332359165574927, 'recall': 0.4883213152824172, 'f1-score': 0.45913227153251757, 'support': 237698}, 'accuracy': 0.43948460254227484, 'macro avg': {'precision': 0.5000444276671603, 'recall': 0.5137894016945922, 'f1-score': 0.4404372427118421, 'support': 967952}, 'weighted avg': {'precision': 0.5657976242166893, 'recall': 0.43948460254227484, 'f1-score': 0.42481546565529094, 'support': 967952}}
[[175624  16114  30629]
 [252965 133703 121219]
 [ 87416  34209 116073]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98596674
{'0': {'precision': 0.42784284418481267, 'recall': 0.6742939859561422, 'f1-score': 0.5235136851951387, 'support': 111223}, '1': {'precision': 0.6679704542845115, 'recall': 0.4658687493660615, 'f1-score': 0.5489077448532234, 'support': 187321}, '2': {'precision': 0.4809085304769978, 'recall': 0.44894252212071073, 'f1-score': 0.4643760696480393, 'support': 111208}, 'accuracy': 0.5178498213553564, 'macro avg': {'precision': 0.5255739429821072, 'recall': 0.5297017524809715, 'f1-score': 0.5122658332321338, 'support': 409752}, 'weighted avg': {'precision': 0.5520210614788514, 'recall': 0.5178498213553564, 'f1-score': 0.5190726201105271, 'support': 409752}}
[[74997 19386 16840]
 [63004 87267 37050]
 [37290 23992 49926]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.934457
{'0': {'precision': 0.463002655980616, 'recall': 0.588411203884645, 'f1-score': 0.5182278084906645, 'support': 33774}, '1': {'precision': 0.6997460153863143, 'recall': 0.5500578703703703, 'f1-score': 0.6159379201969964, 'support': 69120}, '2': {'precision': 0.4580998406251607, 'recall': 0.5357443482443482, 'f1-score': 0.4938890890447025, 'support': 33264}, 'accuracy': 0.5560745604371392, 'macro avg': {'precision': 0.540282837330697, 'recall': 0.5580711408331211, 'f1-score': 0.5426849392441212, 'support': 136158}, 'weighted avg': {'precision': 0.581986584593977, 'recall': 0.5560745604371392, 'f1-score': 0.5618838533612648, 'support': 136158}}
[[19873  8127  5774]
 [15793 38020 15307]
 [ 7256  8187 17821]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2663529
{'0': {'precision': 0.3529477150337259, 'recall': 0.8383508625884487, 'f1-score': 0.49675879230503056, 'support': 321938}, '1': {'precision': 0.6889176486615353, 'recall': 0.05955051548819765, 'f1-score': 0.10962497290266637, 'support': 509517}, '2': {'precision': 0.4093949226721891, 'recall': 0.43944504755996694, 'f1-score': 0.42388807684276464, 'support': 309504}, 'accuracy': 0.38235291539836225, 'macro avg': {'precision': 0.48375342878915006, 'recall': 0.44578214187887105, 'f1-score': 0.34342394735015386, 'support': 1140959}, 'weighted avg': {'precision': 0.5182937346761279, 'recall': 0.38235291539836225, 'f1-score': 0.3041094156150114, 'support': 1140959}}
[[269897   4987  47054]
 [330017  30342 149158]
 [164780   8714 136010]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9961756
{'0': {'precision': 0.35495960186173964, 'recall': 0.7110127535919927, 'f1-score': 0.47352223093291523, 'support': 148664}, '1': {'precision': 0.7104626898613535, 'recall': 0.43829626580927067, 'f1-score': 0.542138352743036, 'support': 323149}, '2': {'precision': 0.43417613981148107, 'recall': 0.36033144422658536, 'f1-score': 0.3938220821300533, 'support': 148924}, 'accuracy': 0.4849058457929848, 'macro avg': {'precision': 0.499866143844858, 'recall': 0.5032134878759495, 'f1-score': 0.46982755526866815, 'support': 620737}, 'weighted avg': {'precision': 0.5590359032286867, 'recall': 0.4849058457929848, 'f1-score': 0.49012179916632376, 'support': 620737}}
[[105702  22850  20112]
 [131693 141635  49821]
 [ 60391  34871  53662]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9966163
{'0': {'precision': 0.4582379312335251, 'recall': 0.47671090294041113, 'f1-score': 0.46729192010359843, 'support': 49959}, '1': {'precision': 0.701421507076532, 'recall': 0.44423499842915487, 'f1-score': 0.5439605686292188, 'support': 101856}, '2': {'precision': 0.3648808118952089, 'recall': 0.6258222519076244, 'f1-score': 0.4609868278828449, 'support': 49407}, 'accuracy': 0.4968840385246146, 'macro avg': {'precision': 0.5081800834017554, 'recall': 0.5155893844257301, 'f1-score': 0.49074643887188735, 'support': 201222}, 'weighted avg': {'precision': 0.5584119236693279, 'recall': 0.4968840385246146, 'f1-score': 0.5045524888926712, 'support': 201222}}
[[23816  9725 16418]
 [19206 45248 37402]
 [ 8951  9536 30920]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9612052
{'0': {'precision': 0.4606389709192669, 'recall': 0.6561981743235645, 'f1-score': 0.5412972751256165, 'support': 353951}, '1': {'precision': 0.5569867949225521, 'recall': 0.6020421952677745, 'f1-score': 0.5786387667408903, 'support': 488396}, '2': {'precision': 0.5671533156627383, 'recall': 0.2636630743115593, 'f1-score': 0.3599769783507953, 'support': 354642}, 'accuracy': 0.5178017508932831, 'macro avg': {'precision': 0.5282596938348525, 'recall': 0.5073011479676328, 'f1-score': 0.493304340072434, 'support': 1196989}, 'weighted avg': {'precision': 0.5315087551031004, 'recall': 0.5178017508932831, 'f1-score': 0.5028120780604114, 'support': 1196989}}
[[232262  88330  33359]
 [156357 294035  38004]
 [115598 145538  93506]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95534533
{'0': {'precision': 0.45597659334826457, 'recall': 0.6640501762831591, 'f1-score': 0.5406858932372687, 'support': 159119}, '1': {'precision': 0.6441292655165487, 'recall': 0.5184646268676826, 'f1-score': 0.574505408102076, 'support': 222669}, '2': {'precision': 0.49736866689502696, 'recall': 0.40532670139131205, 'f1-score': 0.44665522436580873, 'support': 157621}, 'accuracy': 0.5283504724615273, 'macro avg': {'precision': 0.5324915085866134, 'recall': 0.5292805015140513, 'f1-score': 0.5206155085683845, 'support': 539409}, 'weighted avg': {'precision': 0.545741553487146, 'recall': 0.5283504724615273, 'f1-score': 0.5271698960945502, 'support': 539409}}
[[105663  27171  26285]
 [ 68944 115446  38279]
 [ 57122  36611  63888]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9745743
{'0': {'precision': 0.460500461379797, 'recall': 0.6685843079153926, 'f1-score': 0.5453680549752188, 'support': 63446}, '1': {'precision': 0.6186612911220899, 'recall': 0.4863355328103081, 'f1-score': 0.5445752641645274, 'support': 76988}, '2': {'precision': 0.5044319878968908, 'recall': 0.4078953559497483, 'f1-score': 0.45105622810364565, 'support': 63759}, 'accuracy': 0.518470270773239, 'macro avg': {'precision': 0.5278645801329259, 'recall': 0.5209383988918163, 'f1-score': 0.5136665157477972, 'support': 204193}, 'weighted avg': {'precision': 0.5338502635738146, 'recall': 0.518470270773239, 'f1-score': 0.5156203988438228, 'support': 204193}}
[[42419 10157 10870]
 [24866 37442 14680]
 [24830 12922 26007]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2301615
{'0': {'precision': 0.3893424315793878, 'recall': 0.8732435448688682, 'f1-score': 0.5385625556790478, 'support': 394260}, '1': {'precision': 0.5964751958224543, 'recall': 0.014595392341012765, 'f1-score': 0.028493564158850525, 'support': 313044}, '2': {'precision': 0.5050659964775494, 'recall': 0.263961464573729, 'f1-score': 0.34671833423049686, 'support': 386761}, 'accuracy': 0.4121729513328733, 'macro avg': {'precision': 0.49696120795979715, 'recall': 0.38393346726120336, 'f1-score': 0.30459148468946506, 'support': 1094065}, 'weighted avg': {'precision': 0.4895184089968944, 'recall': 0.4121729513328733, 'f1-score': 0.32479838233184116, 'support': 1094065}}
[[344285   1167  48808]
 [257241   4569  51234]
 [282747   1924 102090]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.031011
{'0': {'precision': 0.4322067672687374, 'recall': 0.5684895159202692, 'f1-score': 0.4910681093349508, 'support': 154520}, '1': {'precision': 0.5354144913293615, 'recall': 0.5378232054993136, 'f1-score': 0.5366161454232063, 'support': 194497}, '2': {'precision': 0.49440853111876565, 'recall': 0.33677673997030144, 'f1-score': 0.4006454375822092, 'support': 155563}, 'accuracy': 0.4852312814618098, 'macro avg': {'precision': 0.4873432632389549, 'recall': 0.48102982046329473, 'f1-score': 0.4761098974467888, 'support': 504580}, 'weighted avg': {'precision': 0.49116646780467055, 'recall': 0.4852312814618098, 'f1-score': 0.48074771274607625, 'support': 504580}}
[[ 87843  40070  26607]
 [ 62924 104605  26968]
 [ 52476  50697  52390]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.076211
{'0': {'precision': 0.4893359984185209, 'recall': 0.38373955731633796, 'f1-score': 0.43015195690370917, 'support': 58055}, '1': {'precision': 0.45539999557649347, 'recall': 0.6259405067716488, 'f1-score': 0.527222097749896, 'support': 65789}, '2': {'precision': 0.46755652775607687, 'recall': 0.3680723950096644, 'f1-score': 0.4118925189999116, 'support': 56910}, 'accuracy': 0.4669606205118559, 'macro avg': {'precision': 0.47076417391703046, 'recall': 0.45925081969921705, 'f1-score': 0.45642219121783895, 'support': 180754}, 'weighted avg': {'precision': 0.47012709921643503, 'recall': 0.4669606205118559, 'f1-score': 0.4597336142115677, 'support': 180754}}
[[22278 23683 12094]
 [12849 41180 11760]
 [10400 25563 20947]]
testing model on single stock: results/universal/W4/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
12724/12724 - 170s - 170s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1391314
{'0': {'precision': 0.3232122993159359, 'recall': 0.7503035632516465, 'f1-score': 0.4518001984311388, 'support': 877906}, '1': {'precision': 0.5022810015128657, 'recall': 0.3132954106571922, 'f1-score': 0.3858923095031027, 'support': 1506926}, '2': {'precision': 0.39036749486108824, 'recall': 0.12496288611338793, 'f1-score': 0.18932106704227408, 'support': 872315}, 'accuracy': 0.38064477900444776, 'macro avg': {'precision': 0.40528693189662995, 'recall': 0.3961872866740756, 'f1-score': 0.3423378583255052, 'support': 3257147}, 'weighted avg': {'precision': 0.4240440295168694, 'recall': 0.38064477900444776, 'f1-score': 0.35101174923672196, 'support': 3257147}}
[[658696 175137  44073]
 [908651 472113 126162]
 [470620 292688 109007]]
Evaluating performance on  train set...
5165/5165 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.121142
{'0': {'precision': 0.4027680014111249, 'recall': 0.5497500403160781, 'f1-score': 0.46491870035823707, 'support': 440271}, '1': {'precision': 0.3949731193045335, 'recall': 0.5880186550050179, 'f1-score': 0.4725401950381947, 'support': 440418}, '2': {'precision': 0.4268720987051063, 'recall': 0.06333071296042482, 'f1-score': 0.11029767153744026, 'support': 441413}, 'accuracy': 0.4000962104285449, 'macro avg': {'precision': 0.4082044064735882, 'recall': 0.40036646942717363, 'f1-score': 0.34925218897795735, 'support': 1322102}, 'weighted avg': {'precision': 0.4082190600368644, 'recall': 0.4000962104285449, 'f1-score': 0.3490594937683395, 'support': 1322102}}
[[242039 180120  18112]
 [162023 258974  19421]
 [196877 216581  27955]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1046515
{'0': {'precision': 0.40422885572139305, 'recall': 0.24714202428328813, 'f1-score': 0.30674364096836615, 'support': 157804}, '1': {'precision': 0.4136831642317286, 'recall': 0.6370983115075124, 'f1-score': 0.5016396872541037, 'support': 173113}, '2': {'precision': 0.41600290521728606, 'recall': 0.33026658893024863, 'f1-score': 0.36820977292694945, 'support': 156083}, 'accuracy': 0.41240041067761807, 'macro avg': {'precision': 0.4113049750568025, 'recall': 0.40483564157368307, 'f1-score': 0.3921977003831398, 'support': 487000}, 'weighted avg': {'precision': 0.4113631322647548, 'recall': 0.41240041067761807, 'f1-score': 0.3957228145518455, 'support': 487000}}
[[ 39000  76720  42084]
 [ 32541 110290  30282]
 [ 24939  79595  51549]]
training model: results/universal/W4/deepLOB_L2/h100
Epoch 1/50
9854/9854 - 404s - loss: 3.1710 - accuracy100: 0.4293 - val_loss: 3.3617 - val_accuracy100: 0.3926 - 404s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 396s - loss: 3.1282 - accuracy100: 0.4485 - val_loss: 3.3995 - val_accuracy100: 0.3887 - 396s/epoch - 40ms/step
Epoch 3/50
9854/9854 - 396s - loss: 3.1103 - accuracy100: 0.4547 - val_loss: 3.4535 - val_accuracy100: 0.3790 - 396s/epoch - 40ms/step
Epoch 4/50
9854/9854 - 396s - loss: 3.0953 - accuracy100: 0.4591 - val_loss: 3.3696 - val_accuracy100: 0.3934 - 396s/epoch - 40ms/step
Epoch 5/50
9854/9854 - 397s - loss: 3.0833 - accuracy100: 0.4619 - val_loss: 3.4578 - val_accuracy100: 0.3841 - 397s/epoch - 40ms/step
Epoch 6/50
9854/9854 - 396s - loss: 3.0742 - accuracy100: 0.4646 - val_loss: 3.4077 - val_accuracy100: 0.3920 - 396s/epoch - 40ms/step
Epoch 7/50
9854/9854 - 394s - loss: 3.0678 - accuracy100: 0.4662 - val_loss: 3.4469 - val_accuracy100: 0.3893 - 394s/epoch - 40ms/step
Epoch 8/50
9854/9854 - 394s - loss: 3.0629 - accuracy100: 0.4675 - val_loss: 3.5263 - val_accuracy100: 0.3822 - 394s/epoch - 40ms/step
Epoch 9/50
9854/9854 - 396s - loss: 3.0592 - accuracy100: 0.4686 - val_loss: 3.4536 - val_accuracy100: 0.4008 - 396s/epoch - 40ms/step
Epoch 10/50
9854/9854 - 397s - loss: 3.0554 - accuracy100: 0.4697 - val_loss: 3.5647 - val_accuracy100: 0.3842 - 397s/epoch - 40ms/step
Epoch 11/50
9854/9854 - 396s - loss: 3.0524 - accuracy100: 0.4705 - val_loss: 3.5450 - val_accuracy100: 0.3856 - 396s/epoch - 40ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 316s - 316s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1430752
{'0': {'precision': 0.3119778588333178, 'recall': 0.7959993297445817, 'f1-score': 0.44826584714295464, 'support': 1802298}, '1': {'precision': 0.448928687287913, 'recall': 0.17882028625226135, 'f1-score': 0.2557632421601689, 'support': 2437710}, '2': {'precision': 0.3763684123529025, 'recall': 0.10318007581254439, 'f1-score': 0.1619595193327837, 'support': 1831623}, 'accuracy': 0.33920490227419947, 'macro avg': {'precision': 0.3790916528247111, 'recall': 0.3593332306031291, 'f1-score': 0.28866286954530246, 'support': 6071631}, 'weighted avg': {'precision': 0.3863871275851991, 'recall': 0.33920490227419947, 'f1-score': 0.2846078810618085, 'support': 6071631}}
[[1434628  237664  130006]
 [1818658  435912  183140]
 [1345207  297429  188987]]
Evaluating performance on  train set...
9854/9854 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1284654
{'0': {'precision': 0.3659843103582858, 'recall': 0.5831755648867835, 'f1-score': 0.4497305722658907, 'support': 836141}, '1': {'precision': 0.41994695639403895, 'recall': 0.39282963484795114, 'f1-score': 0.4059359270760851, 'support': 851700}, '2': {'precision': 0.3994508514601549, 'recall': 0.18817686393071983, 'f1-score': 0.2558334351953714, 'support': 834178}, 'accuracy': 0.3882456872846715, 'macro avg': {'precision': 0.39512737273749327, 'recall': 0.38806068788848475, 'f1-score': 0.3704999781791158, 'support': 2522019}, 'weighted avg': {'precision': 0.39527712613482274, 'recall': 0.3882456872846715, 'f1-score': 0.3708078419790177, 'support': 2522019}}
[[487617 228178 120346]
 [401474 334573 115653]
 [443253 233952 156973]]
Evaluating performance on  val set...
3566/3566 - 47s - 47s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.119616
{'0': {'precision': 0.3727919787696398, 'recall': 0.25455197084594977, 'f1-score': 0.3025292041774563, 'support': 298552}, '1': {'precision': 0.4040692319653601, 'recall': 0.5332990234307167, 'f1-score': 0.4597760283965942, 'support': 316721}, '2': {'precision': 0.39044609230303157, 'recall': 0.3817705054884391, 'f1-score': 0.3860595652847298, 'support': 297079}, 'accuracy': 0.39274315176598507, 'macro avg': {'precision': 0.3891024343460105, 'recall': 0.38987383325503516, 'f1-score': 0.38278826595292675, 'support': 912352}, 'weighted avg': {'precision': 0.3893983207339126, 'recall': 0.39274315176598507, 'f1-score': 0.3843161543467959, 'support': 912352}}
[[ 75997 126806  95749]
 [ 66501 168907  81313]
 [ 61361 122302 113416]]
testing model out of sample: results/universal/W4/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 160s - 160s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1302465
{'0': {'precision': 0.3711076196436615, 'recall': 0.6149722275173118, 'f1-score': 0.46288519161603703, 'support': 1059682}, '1': {'precision': 0.37354063751234984, 'recall': 0.19101453437355415, 'f1-score': 0.2527713658371805, 'support': 940185}, '2': {'precision': 0.37470937547179306, 'recall': 0.2886617721887039, 'f1-score': 0.3261048442063598, 'support': 1031775}, 'accuracy': 0.3724377746448954, 'macro avg': {'precision': 0.37311921087593475, 'recall': 0.36488284469319, 'f1-score': 0.34725380055319244, 'support': 3031642}, 'weighted avg': {'precision': 0.3730879618227326, 'recall': 0.3724377746448954, 'f1-score': 0.3511726575376353, 'support': 3031642}}
[[651675 147863 260144]
 [523734 179589 236862]
 [580618 153323 297834]]
Evaluating performance on  train set...
5528/5528 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1248878
{'0': {'precision': 0.3500046593099089, 'recall': 0.5749840813437787, 'f1-score': 0.43513417764875556, 'support': 450729}, '1': {'precision': 0.4362355271681336, 'recall': 0.3894410869573799, 'f1-score': 0.4115122917698585, 'support': 506662}, '2': {'precision': 0.3974776497758212, 'recall': 0.1927919610215436, 'f1-score': 0.2596457420838545, 'support': 457073}, 'accuracy': 0.38502004999773765, 'macro avg': {'precision': 0.3945726120846212, 'recall': 0.38573904310756735, 'f1-score': 0.3687640705008228, 'support': 1414464}, 'weighted avg': {'precision': 0.39623314313276325, 'recall': 0.38502004999773765, 'f1-score': 0.3699650834532654, 'support': 1414464}}
[[259162 123248  68319]
 [244088 197315  65259]
 [237203 131750  88120]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1201458
{'0': {'precision': 0.37317662914222294, 'recall': 0.23369595571580168, 'f1-score': 0.28740750916799274, 'support': 161141}, '1': {'precision': 0.4083491269299775, 'recall': 0.4813071864277545, 'f1-score': 0.44183662030366083, 'support': 167872}, '2': {'precision': 0.37751535691590765, 'recall': 0.44948425008196513, 'f1-score': 0.41036828956608834, 'support': 158604}, 'accuracy': 0.38912917310101985, 'macro avg': {'precision': 0.3863470376627027, 'recall': 0.38816246407517374, 'f1-score': 0.37987080634591397, 'support': 487617}, 'weighted avg': {'precision': 0.38669670151140495, 'recall': 0.38912917310101985, 'f1-score': 0.3805675002241422, 'support': 487617}}
[[37658 60526 62957]
 [32481 80798 54593]
 [30773 56541 71290]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1613476
{'0': {'precision': 0.40031735576779137, 'recall': 0.25972688953206036, 'f1-score': 0.31504912702339716, 'support': 51481}, '1': {'precision': 0.24541062801932367, 'recall': 0.2908981314044605, 'f1-score': 0.26622534822783067, 'support': 33180}, '2': {'precision': 0.3692411182203589, 'recall': 0.45396495682111054, 'f1-score': 0.4072431760930329, 'support': 51993}, 'accuracy': 0.34119747683931684, 'macro avg': {'precision': 0.33832303400249125, 'recall': 0.3348633259192105, 'f1-score': 0.3295058837814202, 'support': 136654}, 'weighted avg': {'precision': 0.350881905319961, 'recall': 0.34119747683931684, 'f1-score': 0.33827180775605536, 'support': 136654}}
[[13371 14173 23937]
 [ 7145  9652 16383]
 [12885 15505 23603]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1806154
{'0': {'precision': 0.33956087373708865, 'recall': 0.5567792688570107, 'f1-score': 0.42184980015426693, 'support': 21610}, '1': {'precision': 0.35869383198437066, 'recall': 0.3010541110330288, 'f1-score': 0.3273560876209883, 'support': 21345}, '2': {'precision': 0.3415897126089583, 'recall': 0.1800646012465311, 'f1-score': 0.2358198284080076, 'support': 21981}, 'accuracy': 0.345201429099421, 'macro avg': {'precision': 0.34661480611013923, 'recall': 0.34596599371219017, 'f1-score': 0.32834190539442093, 'support': 64936}, 'weighted avg': {'precision': 0.34653680235959083, 'recall': 0.345201429099421, 'f1-score': 0.32781732043612355, 'support': 64936}}
[[12032  5483  4095]
 [11385  6426  3534]
 [12017  6006  3958]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.176396
{'0': {'precision': 0.3009924709103354, 'recall': 0.24349390919158362, 'f1-score': 0.2692072237526783, 'support': 7224}, '1': {'precision': 0.30254497586660817, 'recall': 0.2145301804604854, 'f1-score': 0.2510467868195886, 'support': 6428}, '2': {'precision': 0.3565345080763583, 'recall': 0.522900215362527, 'f1-score': 0.4239813736903376, 'support': 6965}, 'accuracy': 0.3288548285395547, 'macro avg': {'precision': 0.3200239849511006, 'recall': 0.32697476833819866, 'f1-score': 0.3147451280875348, 'support': 20617}, 'weighted avg': {'precision': 0.3202401689614714, 'recall': 0.3288548285395547, 'f1-score': 0.31583217722359536, 'support': 20617}}
[[1759 1653 3812]
 [2288 1379 2761]
 [1797 1526 3642]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1376925
{'0': {'precision': 0.2712853320925904, 'recall': 0.5775387297436507, 'f1-score': 0.369164337202934, 'support': 100956}, '1': {'precision': 0.557340306313037, 'recall': 0.12802227137518116, 'f1-score': 0.20821671408967213, 'support': 209776}, '2': {'precision': 0.2759353003245669, 'recall': 0.4046143149524565, 'f1-score': 0.32810942804391413, 'support': 102117}, 'accuracy': 0.30635898355088664, 'macro avg': {'precision': 0.3681869795767314, 'recall': 0.3700584386904295, 'f1-score': 0.30183015977884003, 'support': 412849}, 'weighted avg': {'precision': 0.4177851639391328, 'recall': 0.30635898355088664, 'f1-score': 0.2772291435975256, 'support': 412849}}
[[ 58306  10433  32217]
 [106717  26856  76203]
 [ 49902  10897  41318]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0654453
{'0': {'precision': 0.35933087117097545, 'recall': 0.33616367824398175, 'f1-score': 0.34736142062093833, 'support': 44282}, '1': {'precision': 0.5468349501962947, 'recall': 0.4580824896378338, 'f1-score': 0.49853949285275867, 'support': 73585}, '2': {'precision': 0.3505590608454421, 'recall': 0.4676098287416232, 'f1-score': 0.40071155110406437, 'support': 44319}, 'accuracy': 0.4273981724686471, 'macro avg': {'precision': 0.4189082940709041, 'recall': 0.4206186655411463, 'f1-score': 0.4155374881925871, 'support': 162186}, 'weighted avg': {'precision': 0.44200588500238386, 'recall': 0.4273981724686471, 'f1-score': 0.4305305158453114, 'support': 162186}}
[[14886 14572 14824]
 [16308 33708 23569]
 [10233 13362 20724]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0337071
{'0': {'precision': 0.5860091743119266, 'recall': 0.041396629941672064, 'f1-score': 0.07733050847457627, 'support': 12344}, '1': {'precision': 0.5810583721741336, 'recall': 0.6631205673758865, 'f1-score': 0.6193831854668356, 'support': 27636}, '2': {'precision': 0.3250652099020621, 'recall': 0.5180392156862745, 'f1-score': 0.3994677794913665, 'support': 12750}, 'accuracy': 0.48249573297932863, 'macro avg': {'precision': 0.49737758546270744, 'recall': 0.407518804334611, 'f1-score': 0.3653938244775928, 'support': 52730}, 'weighted avg': {'precision': 0.52031875303171, 'recall': 0.48249573297932863, 'f1-score': 0.43931454008508547, 'support': 52730}}
[[  511  7150  4683]
 [  279 18326  9031]
 [   82  6063  6605]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1357989
{'0': {'precision': 0.34391893324288225, 'recall': 0.5890205380807726, 'f1-score': 0.43427322209333447, 'support': 82627}, '1': {'precision': 0.37778530745276473, 'recall': 0.24968275126632897, 'f1-score': 0.3006574554419847, 'support': 93775}, '2': {'precision': 0.3346672325633097, 'recall': 0.21626810505831495, 'f1-score': 0.26274534693683266, 'support': 76567}, 'accuracy': 0.3504065715561986, 'macro avg': {'precision': 0.35212382441965223, 'recall': 0.35165713146847216, 'f1-score': 0.3325586748240506, 'support': 252969}, 'weighted avg': {'precision': 0.3536728725619249, 'recall': 0.3504065715561986, 'f1-score': 0.3328252449307644, 'support': 252969}}
[[48669 18972 14986]
 [52427 23414 17934]
 [40417 19591 16559]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1634375
{'0': {'precision': 0.3501621288698078, 'recall': 0.6685573963269118, 'f1-score': 0.4596034048219126, 'support': 28913}, '1': {'precision': 0.3662611222080988, 'recall': 0.28460561591646677, 'f1-score': 0.3203112593298396, 'support': 28348}, '2': {'precision': 0.3796584684781441, 'recall': 0.12072675113554865, 'f1-score': 0.1831985903814262, 'support': 29281}, 'accuracy': 0.35743338494603777, 'macro avg': {'precision': 0.3653605731853502, 'recall': 0.35796325445964233, 'f1-score': 0.32103775151105945, 'support': 86542}, 'weighted avg': {'precision': 0.36541549236066273, 'recall': 0.35743338494603777, 'f1-score': 0.32045636509506126, 'support': 86542}}
[[19330  6852  2731]
 [17235  8068  3045]
 [18638  7108  3535]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1304405
{'0': {'precision': 0.36390557576783145, 'recall': 0.41142146546776354, 'f1-score': 0.3862075158263368, 'support': 10454}, '1': {'precision': 0.3661421480620974, 'recall': 0.33897145091904574, 'f1-score': 0.35203330456414683, 'support': 10228}, '2': {'precision': 0.35894181960171806, 'recall': 0.33889400921658985, 'f1-score': 0.3486299421636484, 'support': 10850}, 'accuracy': 0.36296460738297603, 'macro avg': {'precision': 0.3629965144772156, 'recall': 0.36309564186779975, 'f1-score': 0.36229025418471067, 'support': 31532}, 'weighted avg': {'precision': 0.36292304713099977, 'recall': 0.36296460738297603, 'f1-score': 0.36219221368787907, 'support': 31532}}
[[4301 2823 3330]
 [3524 3467 3237]
 [3994 3179 3677]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1441319
{'0': {'precision': 0.3227667009714667, 'recall': 0.7693966679247317, 'f1-score': 0.4547591162950039, 'support': 74188}, '1': {'precision': 0.37522556609814306, 'recall': 0.20894651539708267, 'f1-score': 0.2684211622144954, 'support': 92550}, '2': {'precision': 0.3515822404042835, 'recall': 0.04176911201326548, 'f1-score': 0.0746674843803902, 'support': 69956}, 'accuracy': 0.335200723296746, 'macro avg': {'precision': 0.34985816915796436, 'recall': 0.34003743177835993, 'f1-score': 0.2659492542966298, 'support': 236694}, 'weighted avg': {'precision': 0.3517952688440618, 'recall': 0.335200723296746, 'f1-score': 0.26956106373613137, 'support': 236694}}
[[57080 15233  1875]
 [69698 19338  3514]
 [50068 16966  2922]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1678475
{'0': {'precision': 0.3472384012853987, 'recall': 0.5699169303797469, 'f1-score': 0.4315453161270999, 'support': 30336}, '1': {'precision': 0.32891024510668315, 'recall': 0.2567535014969545, 'f1-score': 0.28838683493419404, 'support': 29059}, '2': {'precision': 0.3576043737574553, 'recall': 0.19729220222793487, 'f1-score': 0.25429082635682887, 'support': 29175}, 'accuracy': 0.3444281359376764, 'macro avg': {'precision': 0.34458434004984567, 'recall': 0.3413208780348787, 'f1-score': 0.3247409924727076, 'support': 88570}, 'weighted avg': {'precision': 0.34463965855620093, 'recall': 0.3444281359376764, 'f1-score': 0.3261886260059267, 'support': 88570}}
[[17289  7680  5367]
 [16625  7461  4973]
 [15876  7543  5756]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1624286
{'0': {'precision': 0.39663147906535406, 'recall': 0.3040276388762615, 'f1-score': 0.3442099845599589, 'support': 10999}, '1': {'precision': 0.2927720787642967, 'recall': 0.24800239712345185, 'f1-score': 0.2685340399069919, 'support': 10012}, '2': {'precision': 0.3422748876880005, 'recall': 0.4668738898756661, 'f1-score': 0.3949810285886021, 'support': 11260}, 'accuracy': 0.34346627002571967, 'macro avg': {'precision': 0.3438928151725504, 'recall': 0.33963464195845977, 'f1-score': 0.3359083510185176, 'support': 32271}, 'weighted avg': {'precision': 0.345443243971208, 'recall': 0.34346627002571967, 'f1-score': 0.338446741955051, 'support': 32271}}
[[3344 2933 4722]
 [2149 2483 5380]
 [2938 3065 5257]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1364055
{'0': {'precision': 0.3428662940270904, 'recall': 0.2569373470841463, 'f1-score': 0.2937466529168861, 'support': 129156}, '1': {'precision': 0.394642543088287, 'recall': 0.4742925836878121, 'f1-score': 0.43081704405006177, 'support': 151396}, '2': {'precision': 0.34382796906187624, 'recall': 0.348757938359577, 'f1-score': 0.3462754074417253, 'support': 126443}, 'accuracy': 0.36631653951522747, 'macro avg': {'precision': 0.36044560205908455, 'recall': 0.3599959563771784, 'f1-score': 0.3569463681362244, 'support': 406995}, 'weighted avg': {'precision': 0.36242504555792576, 'recall': 0.36631653951522747, 'f1-score': 0.36105411921102365, 'support': 406995}}
[[33185 54435 41536]
 [36968 71806 42622]
 [26634 55711 44098]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1573627
{'0': {'precision': 0.35130104463437795, 'recall': 0.6079677433492572, 'f1-score': 0.44529688866775274, 'support': 45634}, '1': {'precision': 0.3790971272229822, 'recall': 0.3046613896218118, 'f1-score': 0.3378276240399854, 'support': 45480}, '2': {'precision': 0.3624458092485549, 'recall': 0.1723982386424659, 'f1-score': 0.23365696735032532, 'support': 46555}, 'accuracy': 0.360473309169094, 'macro avg': {'precision': 0.3642813270353051, 'recall': 0.36167579053784493, 'f1-score': 0.33892716001935447, 'support': 137669}, 'weighted avg': {'precision': 0.3642524741700231, 'recall': 0.360473309169094, 'f1-score': 0.33822413668870377, 'support': 137669}}
[[27744 11037  6853]
 [24359 13856  7265]
 [26872 11657  8026]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1376679
{'0': {'precision': 0.38537549407114624, 'recall': 0.17372904950164264, 'f1-score': 0.2394933793897525, 'support': 17959}, '1': {'precision': 0.3914114932885906, 'recall': 0.4080795932870497, 'f1-score': 0.39957179178375485, 'support': 18293}, '2': {'precision': 0.3551511928278377, 'recall': 0.5422853828306264, 'f1-score': 0.42920760260765767, 'support': 17240}, 'accuracy': 0.37265385478202345, 'macro avg': {'precision': 0.3773127267291915, 'recall': 0.3746980085397729, 'f1-score': 0.35609092459372166, 'support': 53492}, 'weighted avg': {'precision': 0.3776986373495817, 'recall': 0.37265385478202345, 'f1-score': 0.3553796353943919, 'support': 53492}}
[[3120 6077 8762]
 [2615 7465 8213]
 [2361 5530 9349]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
3782/3782 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0919679
{'0': {'precision': 0.3458399512978839, 'recall': 0.5247964882060401, 'f1-score': 0.41692624771343356, 'support': 287944}, '1': {'precision': 0.4830288982924703, 'recall': 0.31136606628834607, 'f1-score': 0.3786499529092106, 'support': 364770}, '2': {'precision': 0.4108897338403042, 'recall': 0.3856514760276363, 'f1-score': 0.3978707702176193, 'support': 315238}, 'accuracy': 0.39904974626841, 'macro avg': {'precision': 0.4132528611435528, 'recall': 0.4072713435073408, 'f1-score': 0.3978156569467545, 'support': 967952}, 'weighted avg': {'precision': 0.4187243252589096, 'recall': 0.39904974626841, 'f1-score': 0.3962960360184715, 'support': 967952}}
[[151112  52418  84414]
 [161304 113577  89889]
 [124526  69140 121572]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.103001
{'0': {'precision': 0.4036050156739812, 'recall': 0.35597869584830977, 'f1-score': 0.3782987574325944, 'support': 137438}, '1': {'precision': 0.41838151133623946, 'recall': 0.5117245385022079, 'f1-score': 0.4603691930475677, 'support': 134291}, '2': {'precision': 0.42284357901512715, 'recall': 0.38074089101091846, 'f1-score': 0.4006892791923844, 'support': 138023}, 'accuracy': 0.4153634393486792, 'macro avg': {'precision': 0.414943368675116, 'recall': 0.4161480417871453, 'f1-score': 0.41311907655751545, 'support': 409752}, 'weighted avg': {'precision': 0.4149282419352693, 'recall': 0.4153634393486792, 'f1-score': 0.41273843766361673, 'support': 409752}}
[[48925 48567 39946]
 [33788 68720 31783]
 [38507 46965 52551]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.079139
{'0': {'precision': 0.4584583492444493, 'recall': 0.19195103010369557, 'f1-score': 0.2706035773509571, 'support': 43782}, '1': {'precision': 0.44284189617858943, 'recall': 0.6008648431214803, 'f1-score': 0.5098905975320442, 'support': 49720}, '2': {'precision': 0.4112776729871935, 'recall': 0.485605776444111, 'f1-score': 0.44536180002365056, 'support': 42656}, 'accuracy': 0.43326870253675875, 'macro avg': {'precision': 0.4375259728034107, 'recall': 0.4261405498897623, 'f1-score': 0.40861865830221733, 'support': 136158}, 'weighted avg': {'precision': 0.4379748743633255, 'recall': 0.43326870253675875, 'f1-score': 0.4127313802691115, 'support': 136158}}
[[ 8404 20184 15194]
 [ 5388 29875 14457]
 [ 4539 17403 20714]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
4457/4457 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.103649
{'0': {'precision': 0.3825259466195669, 'recall': 0.61309873220861, 'f1-score': 0.4711136192111787, 'support': 393519}, '1': {'precision': 0.4218850772396425, 'recall': 0.14655222996868816, 'f1-score': 0.2175374419516135, 'support': 374938}, '2': {'precision': 0.37314768274486376, 'recall': 0.3806556743319499, 'f1-score': 0.3768642881917451, 'support': 372502}, 'accuracy': 0.3838954774010284, 'macro avg': {'precision': 0.39251956886802447, 'recall': 0.38010221216974943, 'f1-score': 0.3551717831181791, 'support': 1140959}, 'weighted avg': {'precision': 0.39239817837072993, 'recall': 0.3838954774010284, 'f1-score': 0.3570136304712258, 'support': 1140959}}
[[241266  37604 114649]
 [196437  54948 123553]
 [193015  37692 141795]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036963
{'0': {'precision': 0.3438992579266921, 'recall': 0.610728034631297, 'f1-score': 0.4400228645086049, 'support': 187807}, '1': {'precision': 0.49624052582310846, 'recall': 0.4027283680846284, 'f1-score': 0.44462080611814675, 'support': 244835}, '2': {'precision': 0.40034344849402353, 'recall': 0.18839416252425636, 'f1-score': 0.2562172597420908, 'support': 188095}, 'accuracy': 0.4007123789946467, 'macro avg': {'precision': 0.4134944107479414, 'recall': 0.4006168550800606, 'f1-score': 0.38028697678961415, 'support': 620737}, 'weighted avg': {'precision': 0.4210903136397901, 'recall': 0.4007123789946467, 'f1-score': 0.3861398541602846, 'support': 620737}}
[[114699  48283  24825]
 [117980  98602  28253]
 [100846  51813  35436]]
Evaluating performance on  val set...
787/787 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883809
{'0': {'precision': 0.4098049986267509, 'recall': 0.23536556510765833, 'f1-score': 0.2990030559591203, 'support': 63395}, '1': {'precision': 0.47811277910937305, 'recall': 0.49850710931642706, 'f1-score': 0.4880970012299014, 'support': 76027}, '2': {'precision': 0.37878469056136166, 'recall': 0.5243042071197411, 'f1-score': 0.43982028206485596, 'support': 61800}, 'accuracy': 0.4235272485115942, 'macro avg': {'precision': 0.4222341560991619, 'recall': 0.4193922938479422, 'f1-score': 0.40897344641795924, 'support': 201222}, 'weighted avg': {'precision': 0.42608642207106245, 'recall': 0.4235272485115942, 'f1-score': 0.41369603162995217, 'support': 201222}}
[[14921 22460 26014]
 [11001 37900 27126]
 [10488 18910 32402]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1164753
{'0': {'precision': 0.3821079680127595, 'recall': 0.7706193179138817, 'f1-score': 0.5108923598398993, 'support': 402911}, '1': {'precision': 0.4077803242702214, 'recall': 0.3638898756660746, 'f1-score': 0.38458691682019674, 'support': 394100}, '2': {'precision': 0.5360339718327071, 'recall': 0.04386741270769892, 'f1-score': 0.08109800767717945, 'support': 399978}, 'accuracy': 0.39385992686649585, 'macro avg': {'precision': 0.4419740880385626, 'recall': 0.3927922020958851, 'f1-score': 0.3255257614457585, 'support': 1196989}, 'weighted avg': {'precision': 0.44199531096825934, 'recall': 0.39385992686649585, 'f1-score': 0.3256899390295116, 'support': 1196989}}
[[310491  84570   7850]
 [243354 143409   7337]
 [258729 123703  17546]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.08629
{'0': {'precision': 0.4083100142699812, 'recall': 0.5224223483290841, 'f1-score': 0.4583708165160123, 'support': 182385}, '1': {'precision': 0.44389607970947015, 'recall': 0.4544837642308339, 'f1-score': 0.44912753240059516, 'support': 178310}, '2': {'precision': 0.42143834673533676, 'recall': 0.2912082992938438, 'f1-score': 0.3444241122689054, 'support': 178714}, 'accuracy': 0.4233596399021892, 'macro avg': {'precision': 0.4245481469049294, 'recall': 0.4227048039512539, 'f1-score': 0.4173074870618376, 'support': 539409}, 'weighted avg': {'precision': 0.42442314574670637, 'recall': 0.4233596399021892, 'f1-score': 0.41756311532185814, 'support': 539409}}
[[95282 49237 37866]
 [63691 81039 33580]
 [74384 52287 52043]]
Evaluating performance on  val set...
798/798 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048849
{'0': {'precision': 0.4142759853579637, 'recall': 0.4115955512327145, 'f1-score': 0.4129314185104262, 'support': 70941}, '1': {'precision': 0.39902726908761993, 'recall': 0.4333193777978165, 'f1-score': 0.4154669178098054, 'support': 62102}, '2': {'precision': 0.42455335586673104, 'recall': 0.3954462403373155, 'f1-score': 0.4094831977412641, 'support': 71150}, 'accuracy': 0.41257535762734276, 'macro avg': {'precision': 0.4126188701041049, 'recall': 0.41345372312261547, 'f1-score': 0.4126271780204986, 'support': 204193}, 'weighted avg': {'precision': 0.41321943167531, 'recall': 0.41257535762734276, 'f1-score': 0.4125010348526327, 'support': 204193}}
[[29199 20203 21539]
 [18595 26910 16597]
 [22688 20326 28136]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
4274/4274 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1500515
{'0': {'precision': 0.3691341298189432, 'recall': 0.7810518268846535, 'f1-score': 0.5013326493515183, 'support': 402899}, '1': {'precision': 0.28875268248228825, 'recall': 0.06847429033517372, 'f1-score': 0.11069788408982052, 'support': 286896}, '2': {'precision': 0.41518186428176285, 'recall': 0.17822000148415662, 'f1-score': 0.2493882029608554, 'support': 404270}, 'accuracy': 0.3714395396982812, 'macro avg': {'precision': 0.35768955886099807, 'recall': 0.3425820395679946, 'f1-score': 0.28713957880073143, 'support': 1094065}, 'weighted avg': {'precision': 0.3650709360381232, 'recall': 0.3714395396982812, 'f1-score': 0.30580026968772017, 'support': 1094065}}
[[314685  23209  65005]
 [230769  19645  36482]
 [307041  25180  72049]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1286706
{'0': {'precision': 0.3601990760785039, 'recall': 0.51384283272869, 'f1-score': 0.42351679417986277, 'support': 166765}, '1': {'precision': 0.3991211386591119, 'recall': 0.42183205923650197, 'f1-score': 0.41016246050800625, 'support': 166654}, '2': {'precision': 0.41291526771514403, 'recall': 0.21843176891932156, 'f1-score': 0.2857186526814543, 'support': 171161}, 'accuracy': 0.3832454714812319, 'macro avg': {'precision': 0.39074516081758665, 'recall': 0.38470222029483786, 'f1-score': 0.37313263578977446, 'support': 504580}, 'weighted avg': {'precision': 0.39093646855150643, 'recall': 0.3832454714812319, 'f1-score': 0.3723629220074448, 'support': 504580}}
[[85691 51265 29809]
 [73006 70300 23348]
 [79202 54572 37387]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1419512
{'0': {'precision': 0.35055075149269094, 'recall': 0.21930799079038465, 'f1-score': 0.26981627296587923, 'support': 62109}, '1': {'precision': 0.3566745222484075, 'recall': 0.5373312710911136, 'f1-score': 0.42874973704508795, 'support': 56896}, '2': {'precision': 0.3924070909867578, 'recall': 0.35704221930719526, 'f1-score': 0.37389025972374146, 'support': 61749}, 'accuracy': 0.3664649191719132, 'macro avg': {'precision': 0.3665441215759521, 'recall': 0.37122716039623116, 'f1-score': 0.3574854232449029, 'support': 180754}, 'weighted avg': {'precision': 0.3667772536355834, 'recall': 0.3664649191719132, 'f1-score': 0.3553974660822799, 'support': 180754}}
[[13621 27561 20927]
 [13114 30572 13210]
 [12121 27581 22047]]
testing model on single stock: results/universal/W4/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
12724/12724 - 170s - 170s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1686146
{'0': {'precision': 0.2900703270262512, 'recall': 0.9162393637075336, 'f1-score': 0.4406395039457924, 'support': 936299}, '1': {'precision': 0.46523635903812516, 'recall': 0.0962213243018233, 'f1-score': 0.15946227082942052, 'support': 1376514}, '2': {'precision': 0.37533368926855315, 'recall': 0.005955519974924126, 'f1-score': 0.011724996299454404, 'support': 944334}, 'accuracy': 0.3057731198499791, 'macro avg': {'precision': 0.3768801251109765, 'recall': 0.3394720693280937, 'f1-score': 0.2039422570248891, 'support': 3257147}, 'weighted avg': {'precision': 0.3888179694594956, 'recall': 0.3057731198499791, 'f1-score': 0.19745645125285394, 'support': 3257147}}
[[ 857874   75172    3253]
 [1237957  132450    6107]
 [ 861638   77072    5624]]
Evaluating performance on  train set...
5165/5165 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1584432
{'0': {'precision': 0.35093637696316154, 'recall': 0.703488793298619, 'f1-score': 0.46827373874831024, 'support': 441700}, '1': {'precision': 0.3920895599763167, 'recall': 0.32924814700255467, 'f1-score': 0.357931548100897, 'support': 436455}, '2': {'precision': 0.3710539442742108, 'recall': 0.05864438773096788, 'f1-score': 0.10128143283953692, 'support': 443947}, 'accuracy': 0.36341220268935376, 'macro avg': {'precision': 0.371359960404563, 'recall': 0.3637937760107139, 'f1-score': 0.3091622398962481, 'support': 1322102}, 'weighted avg': {'precision': 0.3712772025175023, 'recall': 0.36341220268935376, 'f1-score': 0.30861545667151213, 'support': 1322102}}
[[310731 108772  22197]
 [270820 143702  21933]
 [303883 114029  26035]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1435639
{'0': {'precision': 0.3254943476123861, 'recall': 0.21457323380232543, 'f1-score': 0.2586430926611637, 'support': 160486}, '1': {'precision': 0.37508323947483085, 'recall': 0.5455752133021626, 'f1-score': 0.4445429632787285, 'support': 167251}, '2': {'precision': 0.3833176248821866, 'recall': 0.33197290017141456, 'f1-score': 0.35580245833515595, 'support': 159263}, 'accuracy': 0.36664271047227925, 'macro avg': {'precision': 0.36129840398980123, 'recall': 0.36404044909196753, 'f1-score': 0.35299617142501605, 'support': 487000}, 'weighted avg': {'precision': 0.3614345947596263, 'recall': 0.36664271047227925, 'f1-score': 0.3542608161026326, 'support': 487000}}
[[34436 76696 49354]
 [40298 91248 35705]
 [31062 75330 52871]]
training model: results/universal/W4/deepLOB_L2/h200
Epoch 1/50
9854/9854 - 407s - loss: 3.2267 - accuracy200: 0.4093 - val_loss: 3.3788 - val_accuracy200: 0.3361 - 407s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 396s - loss: 3.1981 - accuracy200: 0.4233 - val_loss: 3.3834 - val_accuracy200: 0.3274 - 396s/epoch - 40ms/step
Epoch 3/50
9854/9854 - 395s - loss: 3.1833 - accuracy200: 0.4304 - val_loss: 3.4584 - val_accuracy200: 0.3473 - 395s/epoch - 40ms/step
Epoch 4/50
9854/9854 - 396s - loss: 3.1734 - accuracy200: 0.4347 - val_loss: 3.4998 - val_accuracy200: 0.3380 - 396s/epoch - 40ms/step
Epoch 5/50
9854/9854 - 398s - loss: 3.1669 - accuracy200: 0.4375 - val_loss: 3.4424 - val_accuracy200: 0.3344 - 398s/epoch - 40ms/step
Epoch 6/50
9854/9854 - 396s - loss: 3.1612 - accuracy200: 0.4393 - val_loss: 3.4922 - val_accuracy200: 0.3366 - 396s/epoch - 40ms/step
Epoch 7/50
9854/9854 - 396s - loss: 3.1573 - accuracy200: 0.4408 - val_loss: 3.5232 - val_accuracy200: 0.3352 - 396s/epoch - 40ms/step
Epoch 8/50
9854/9854 - 397s - loss: 3.1532 - accuracy200: 0.4422 - val_loss: 3.5461 - val_accuracy200: 0.3370 - 397s/epoch - 40ms/step
Epoch 9/50
9854/9854 - 396s - loss: 3.1494 - accuracy200: 0.4438 - val_loss: 3.6539 - val_accuracy200: 0.3411 - 396s/epoch - 40ms/step
Epoch 10/50
9854/9854 - 401s - loss: 3.1460 - accuracy200: 0.4451 - val_loss: 3.7626 - val_accuracy200: 0.3433 - 401s/epoch - 41ms/step
Epoch 11/50
9854/9854 - 398s - loss: 3.1428 - accuracy200: 0.4464 - val_loss: 3.7992 - val_accuracy200: 0.3381 - 398s/epoch - 40ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 314s - 314s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974156
{'0': {'precision': 0.31406035080885664, 'recall': 0.11460973123282864, 'f1-score': 0.1679350806366315, 'support': 1800964}, '1': {'precision': 0.406427568468433, 'recall': 0.8471371367803678, 'f1-score': 0.5493133066356083, 'support': 2412934}, '2': {'precision': 0.3506307644756356, 'recall': 0.07266706248960426, 'f1-score': 0.1203847789892908, 'support': 1857733}, 'accuracy': 0.3928911358414238, 'macro avg': {'precision': 0.3570395612509751, 'recall': 0.34480464350093354, 'f1-score': 0.2792110554205102, 'support': 6071631}, 'weighted avg': {'precision': 0.3619575409161966, 'recall': 0.3928911358414238, 'f1-score': 0.30495011396826777, 'support': 6071631}}
[[ 206408 1471879  122677]
 [ 241512 2044086  127336]
 [ 209304 1513433  134996]]
Evaluating performance on  train set...
9854/9854 - 135s - 135s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1229193
{'0': {'precision': 0.3334060924224632, 'recall': 0.1438889412236069, 'f1-score': 0.2010222032678519, 'support': 838619}, '1': {'precision': 0.3305028812446559, 'recall': 0.6744777537428537, 'f1-score': 0.4436241519225038, 'support': 844142}, '2': {'precision': 0.33921275900146547, 'recall': 0.1767894973893606, 'f1-score': 0.23243794936627554, 'support': 839258}, 'accuracy': 0.33243008875032265, 'macro avg': {'precision': 0.3343739108895282, 'recall': 0.3317187307852737, 'f1-score': 0.2923614348522104, 'support': 2522019}, 'weighted avg': {'precision': 0.33436665968611334, 'recall': 0.33243008875032265, 'f1-score': 0.29267750419155864, 'support': 2522019}}
[[120668 579066 138885]
 [124643 569355 150144]
 [116614 574272 148372]]
Evaluating performance on  val set...
3566/3566 - 50s - 50s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1260118
{'0': {'precision': 0.2854110690912766, 'recall': 0.11241300150609404, 'f1-score': 0.1612970019206557, 'support': 301442}, '1': {'precision': 0.3385987648327712, 'recall': 0.5163609911226414, 'f1-score': 0.40899982153328407, 'support': 310678}, '2': {'precision': 0.3517976006978424, 'recall': 0.3747768392443177, 'f1-score': 0.36292383985808163, 'support': 300232}, 'accuracy': 0.33630440882466417, 'macro avg': {'precision': 0.3252691448739634, 'recall': 0.33451694395768444, 'f1-score': 0.31107355443734047, 'support': 912352}, 'weighted avg': {'precision': 0.325368901260087, 'recall': 0.33630440882466417, 'f1-score': 0.31199612396920867, 'support': 912352}}
[[ 33886 157428 110128]
 [ 53061 160422  97195]
 [ 31780 155932 112520]]
testing model out of sample: results/universal/W4/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 159s - 159s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1337103
{'0': {'precision': 0.3551106825666971, 'recall': 0.11503473969922053, 'f1-score': 0.17377629558357133, 'support': 1062905}, '1': {'precision': 0.3072360594045324, 'recall': 0.6823516103799367, 'f1-score': 0.4236977203790919, 'support': 937077}, '2': {'precision': 0.3431507120514208, 'recall': 0.20161293449392242, 'f1-score': 0.25399500304067174, 'support': 1031660}, 'accuracy': 0.31985405928536415, 'macro avg': {'precision': 0.3351658180075501, 'recall': 0.3329997615243599, 'f1-score': 0.28382300633444496, 'support': 3031642}, 'weighted avg': {'precision': 0.33624274518137204, 'recall': 0.31985405928536415, 'f1-score': 0.27832493645815487, 'support': 3031642}}
[[122271 732764 207870]
 [107391 639416 190270]
 [114656 709008 207996]]
Evaluating performance on  train set...
5528/5528 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223234
{'0': {'precision': 0.3415891586047113, 'recall': 0.15262455458928106, 'f1-score': 0.2109811678337909, 'support': 467546}, '1': {'precision': 0.3281718602796576, 'recall': 0.6994765854963875, 'f1-score': 0.4467452526745471, 'support': 467125}, '2': {'precision': 0.3477836267060477, 'recall': 0.15215936872776384, 'f1-score': 0.21169828391145237, 'support': 479793}, 'accuracy': 0.3330639733496222, 'macro avg': {'precision': 0.3391815485301389, 'recall': 0.3347535029378108, 'f1-score': 0.2898082348065968, 'support': 1414464}, 'weighted avg': {'precision': 0.3392593057089528, 'recall': 0.3330639733496222, 'f1-score': 0.28908521672120524, 'support': 1414464}}
[[ 71359 329531  66656]
 [ 70128 326743  70254]
 [ 67416 339372  73005]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1290728
{'0': {'precision': 0.34341012113804786, 'recall': 0.13338501198824612, 'f1-score': 0.19214022938757847, 'support': 166413}, '1': {'precision': 0.33096541562346515, 'recall': 0.5248247608072084, 'f1-score': 0.4059379270150211, 'support': 157927}, '2': {'precision': 0.342725834400663, 'recall': 0.3621881832713732, 'f1-score': 0.3521883356261874, 'support': 163277}, 'accuracy': 0.33677660951115324, 'macro avg': {'precision': 0.33903379038739195, 'recall': 0.3401326520222759, 'f1-score': 0.316755497342929, 'support': 487617}, 'weighted avg': {'precision': 0.339150459777961, 'recall': 0.33677660951115324, 'f1-score': 0.3149755768745005, 'support': 487617}}
[[22197 84304 59912]
 [21543 82884 53500]
 [20897 83243 59137]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1560282
{'0': {'precision': 0.3427463337777239, 'recall': 0.11404835359829008, 'f1-score': 0.1711475905893033, 'support': 49593}, '1': {'precision': 0.27574561194881797, 'recall': 0.4461289826073572, 'f1-score': 0.3408295852073963, 'support': 38982}, '2': {'precision': 0.3354939298915614, 'recall': 0.39832359242080745, 'f1-score': 0.36421901447290844, 'support': 48079}, 'accuracy': 0.3087944736341417, 'macro avg': {'precision': 0.3179952918727011, 'recall': 0.3195003095421516, 'f1-score': 0.29206539675653603, 'support': 136654}, 'weighted avg': {'precision': 0.3210820541753909, 'recall': 0.3087944736341417, 'f1-score': 0.2874795274744465, 'support': 136654}}
[[ 5656 22619 21318]
 [ 4977 17391 16614]
 [ 5869 23059 19151]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269096
{'0': {'precision': 0.3222397787872803, 'recall': 0.15111378687537627, 'f1-score': 0.20574419117878875, 'support': 21593}, '1': {'precision': 0.3277942083874125, 'recall': 0.7178603047388286, 'f1-score': 0.450073035349109, 'support': 21461}, '2': {'precision': 0.3370887210344386, 'recall': 0.12032720957864912, 'f1-score': 0.17734819654464015, 'support': 21882}, 'accuracy': 0.32804607613650366, 'macro avg': {'precision': 0.32904090273637715, 'recall': 0.329767100397618, 'f1-score': 0.277721807690846, 'support': 64936}, 'weighted avg': {'precision': 0.3290792540845076, 'recall': 0.32804607613650366, 'f1-score': 0.2769247407992582, 'support': 64936}}
[[ 3263 15705  2625]
 [ 3502 15406  2553]
 [ 3361 15888  2633]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1463408
{'0': {'precision': 0.29863013698630136, 'recall': 0.014621059691482226, 'f1-score': 0.0278772378516624, 'support': 7455}, '1': {'precision': 0.2888035401185606, 'recall': 0.583698953763078, 'f1-score': 0.38641568452214714, 'support': 5926}, '2': {'precision': 0.3422356495468278, 'recall': 0.3913764510779436, 'f1-score': 0.3651602088840178, 'support': 7236}, 'accuracy': 0.3104234369694912, 'macro avg': {'precision': 0.30988977555056324, 'recall': 0.3298988215108346, 'f1-score': 0.25981771041927576, 'support': 20617}, 'weighted avg': {'precision': 0.3111099873937194, 'recall': 0.3104234369694912, 'f1-score': 0.24930995907004605, 'support': 20617}}
[[ 109 4257 3089]
 [ 113 3459 2354]
 [ 143 4261 2832]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
1613/1613 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1183171
{'0': {'precision': 0.2737387922653127, 'recall': 0.019737354540214667, 'f1-score': 0.036819889133483, 'support': 128386}, '1': {'precision': 0.3753312728449196, 'recall': 0.7117189437548133, 'f1-score': 0.4914775287988318, 'support': 153222}, '2': {'precision': 0.31836597491286733, 'recall': 0.2742283280377321, 'f1-score': 0.2946534199527605, 'support': 131241}, 'accuracy': 0.35745514703923226, 'macro avg': {'precision': 0.3224786800076999, 'recall': 0.33522820877758663, 'f1-score': 0.27431694596169176, 'support': 412849}, 'weighted avg': {'precision': 0.32562972366448345, 'recall': 0.35745514703923226, 'f1-score': 0.2875214368738357, 'support': 412849}}
[[  2534  89387  36465]
 [  3580 109051  40591]
 [  3143  92108  35990]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1267711
{'0': {'precision': 0.3882174228914867, 'recall': 0.10819865257887568, 'f1-score': 0.16923143363035686, 'support': 54326}, '1': {'precision': 0.34737659785923986, 'recall': 0.5627544599896366, 'f1-score': 0.42958149390782274, 'support': 54036}, '2': {'precision': 0.349847074244614, 'recall': 0.3867791319857313, 'f1-score': 0.36738727609635574, 'support': 53824}, 'accuracy': 0.3520957419259369, 'macro avg': {'precision': 0.3618136983317802, 'recall': 0.3525774148514145, 'f1-score': 0.32206673454484513, 'support': 162186}, 'weighted avg': {'precision': 0.3618765521195842, 'recall': 0.3520957419259369, 'f1-score': 0.3217342139075884, 'support': 162186}}
[[ 5878 28976 19472]
 [ 4411 30409 19216]
 [ 4852 28154 20818]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.111885
{'0': {'precision': 0.15384615384615385, 'recall': 0.00012505471143625337, 'f1-score': 0.00024990628514307136, 'support': 15993}, '1': {'precision': 0.3908110945133029, 'recall': 0.47961155427835306, 'f1-score': 0.4306816159458979, 'support': 20183}, '2': {'precision': 0.3219550593960212, 'recall': 0.5435544279328259, 'f1-score': 0.40438631971596783, 'support': 16554}, 'accuracy': 0.354257538403186, 'macro avg': {'precision': 0.288870769251826, 'recall': 0.34109701230753836, 'f1-score': 0.278439280649003, 'support': 52730}, 'weighted avg': {'precision': 0.29732307817684933, 'recall': 0.354257538403186, 'f1-score': 0.29187663459951607, 'support': 52730}}
[[    2  7538  8453]
 [    6  9680 10497]
 [    5  7551  8998]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057099
{'0': {'precision': 0.2928287290389222, 'recall': 0.16940877304513668, 'f1-score': 0.21464184742772913, 'support': 78650}, '1': {'precision': 0.3894980731775595, 'recall': 0.6473179374993814, 'f1-score': 0.4863526156866829, 'support': 101023}, '2': {'precision': 0.30162981680353756, 'recall': 0.16286018336607727, 'f1-score': 0.2115158012244066, 'support': 73296}, 'accuracy': 0.35836406832457735, 'macro avg': {'precision': 0.32798553967333977, 'recall': 0.32652896463686515, 'f1-score': 0.30417008811293955, 'support': 252969}, 'weighted avg': {'precision': 0.33398362027742495, 'recall': 0.35836406832457735, 'f1-score': 0.3222436099334337, 'support': 252969}}
[[13324 53646 11680]
 [19671 65394 15958]
 [12506 48853 11937]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205951
{'0': {'precision': 0.3333927934356047, 'recall': 0.13086860623884045, 'f1-score': 0.18795725958516654, 'support': 28563}, '1': {'precision': 0.3213766999691915, 'recall': 0.7674467488789237, 'f1-score': 0.45303855977333596, 'support': 28544}, '2': {'precision': 0.3844007255476489, 'recall': 0.09359605911330049, 'f1-score': 0.15053822195508443, 'support': 29435}, 'accuracy': 0.3281528044186638, 'macro avg': {'precision': 0.3463900729841483, 'recall': 0.33063713807702155, 'f1-score': 0.2638446804378623, 'support': 86542}, 'weighted avg': {'precision': 0.3467785611531606, 'recall': 0.3281528044186638, 'f1-score': 0.2626614640168834, 'support': 86542}}
[[ 3738 22614  2211]
 [ 4437 21906  2201]
 [ 3037 23643  2755]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1308423
{'0': {'precision': 0.3386741143613112, 'recall': 0.2220508866615266, 'f1-score': 0.26823447232085684, 'support': 10376}, '1': {'precision': 0.322770173135821, 'recall': 0.5090192212912765, 'f1-score': 0.39504283965728276, 'support': 10145}, '2': {'precision': 0.3556701030927835, 'recall': 0.28199073653619106, 'f1-score': 0.3145737298009219, 'support': 11011}, 'accuracy': 0.33531016110617784, 'macro avg': {'precision': 0.3390381301966386, 'recall': 0.33768694816299805, 'f1-score': 0.3259503472596872, 'support': 31532}, 'weighted avg': {'precision': 0.3394922466773598, 'recall': 0.33531016110617784, 'f1-score': 0.32521507776107744, 'support': 31532}}
[[2304 5353 2719]
 [2075 5164 2906]
 [2424 5482 3105]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049494
{'0': {'precision': 0.3188354023399125, 'recall': 0.19165984404149947, 'f1-score': 0.2394065132654344, 'support': 74507}, '1': {'precision': 0.3849842688839049, 'recall': 0.8292809865927476, 'f1-score': 0.5258490809693944, 'support': 88385}, '2': {'precision': 0.34101382488479265, 'recall': 0.007018779978862361, 'f1-score': 0.013754464226444153, 'support': 73802}, 'accuracy': 0.37218518424632646, 'macro avg': {'precision': 0.3482778320362034, 'recall': 0.3426532035377032, 'f1-score': 0.25967001948709095, 'support': 236694}, 'weighted avg': {'precision': 0.35045166430746555, 'recall': 0.37218518424632646, 'f1-score': 0.27600927389028734, 'support': 236694}}
[[14280 59761   466]
 [14554 73296   535]
 [15954 57330   518]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1296858
{'0': {'precision': 0.30618074365919723, 'recall': 0.20764863059452238, 'f1-score': 0.24746740969250666, 'support': 29940}, '1': {'precision': 0.31922398589065254, 'recall': 0.6047526507790393, 'f1-score': 0.41787106729330836, 'support': 29331}, '2': {'precision': 0.3505787857311599, 'recall': 0.15195057851803817, 'f1-score': 0.21201009571884374, 'support': 29299}, 'accuracy': 0.32072936660268714, 'macro avg': {'precision': 0.32532783842700325, 'recall': 0.32145061996386665, 'f1-score': 0.2924495242348863, 'support': 88570}, 'weighted avg': {'precision': 0.3251870615157767, 'recall': 0.32072936660268714, 'f1-score': 0.292169293388733, 'support': 88570}}
[[ 6217 19331  4392]
 [ 7738 17738  3855]
 [ 6350 18497  4452]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.13995
{'0': {'precision': 0.38612933458294285, 'recall': 0.07458363504706735, 'f1-score': 0.12501896525565165, 'support': 11048}, '1': {'precision': 0.27725782414307004, 'recall': 0.48327098919368244, 'f1-score': 0.3523618318875715, 'support': 9624}, '2': {'precision': 0.3441850022451729, 'recall': 0.3964996982498491, 'f1-score': 0.3684948519690718, 'support': 11599}, 'accuracy': 0.3121688203030585, 'macro avg': {'precision': 0.3358573869903953, 'recall': 0.3181181074968663, 'f1-score': 0.28195854970409834, 'support': 32271}, 'weighted avg': {'precision': 0.33858535617325214, 'recall': 0.3121688203030585, 'f1-score': 0.28032944706453755, 'support': 32271}}
[[ 824 6069 4155]
 [ 365 4651 4608]
 [ 945 6055 4599]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119039
{'0': {'precision': 0.3441060058509723, 'recall': 0.0771504193964087, 'f1-score': 0.12604162727077897, 'support': 129591}, '1': {'precision': 0.3807798237836402, 'recall': 0.5840483542474213, 'f1-score': 0.46100193687398394, 'support': 152210}, '2': {'precision': 0.3189988717927421, 'recall': 0.3681326581146061, 'f1-score': 0.3418090933025798, 'support': 125194}, 'accuracy': 0.3562304205211366, 'macro avg': {'precision': 0.3479615671424516, 'recall': 0.343110477252812, 'f1-score': 0.30961755248244754, 'support': 406995}, 'weighted avg': {'precision': 0.35009836272573813, 'recall': 0.3562304205211366, 'f1-score': 0.3176830500575187, 'support': 406995}}
[[ 9998 73702 45891]
 [10814 88898 52498]
 [ 8243 70863 46088]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293402
{'0': {'precision': 0.3230161343431017, 'recall': 0.10806583092819846, 'f1-score': 0.161950671905438, 'support': 45389}, '1': {'precision': 0.3210546918127892, 'recall': 0.7037998635833572, 'f1-score': 0.4409567135373587, 'support': 45449}, '2': {'precision': 0.3291471579223734, 'recall': 0.16062010206914223, 'f1-score': 0.21588886975489352, 'support': 46831}, 'accuracy': 0.32261438668109743, 'macro avg': {'precision': 0.32440599469275483, 'recall': 0.324161932193566, 'f1-score': 0.2729320850658967, 'support': 137669}, 'weighted avg': {'precision': 0.32445419493539696, 'recall': 0.32261438668109743, 'f1-score': 0.2724078215151324, 'support': 137669}}
[[ 4905 33388  7096]
 [ 5227 31987  8235]
 [ 5053 34256  7522]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1342276
{'0': {'precision': 0.3785415699024617, 'recall': 0.08544768295240092, 'f1-score': 0.13942348815328032, 'support': 19076}, '1': {'precision': 0.31963958460598657, 'recall': 0.49229683641067856, 'f1-score': 0.38761053752488545, 'support': 17006}, '2': {'precision': 0.33660955031747414, 'recall': 0.4445720850086157, 'f1-score': 0.3831303831303831, 'support': 17410}, 'accuracy': 0.33167576460031406, 'macro avg': {'precision': 0.3449302349419741, 'recall': 0.3407722014572317, 'f1-score': 0.30338813626951633, 'support': 53492}, 'weighted avg': {'precision': 0.34616806315516324, 'recall': 0.33167576460031406, 'f1-score': 0.2976453905529826, 'support': 53492}}
[[1630 9126 8320]
 [1700 8372 6934]
 [ 976 8694 7740]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1295553
{'0': {'precision': 0.3570787129062528, 'recall': 0.11097731157000172, 'f1-score': 0.16932859959042276, 'support': 318885}, '1': {'precision': 0.3054104783423379, 'recall': 0.6390843945564049, 'f1-score': 0.41330678703116724, 'support': 297377}, '2': {'precision': 0.37207944162127743, 'recall': 0.2608661036708465, 'f1-score': 0.3067022587131703, 'support': 351690}, 'accuracy': 0.3276836041456601, 'macro avg': {'precision': 0.3448562109566227, 'recall': 0.3369759365990843, 'f1-score': 0.29644588177825343, 'support': 967952}, 'weighted avg': {'precision': 0.34665532589106374, 'recall': 0.3276836041456601, 'f1-score': 0.2941968199396192, 'support': 967952}}
[[ 35389 204894  78602]
 [ 31103 190049  76225]
 [ 32615 227331  91744]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1292759
{'0': {'precision': 0.31571412425121503, 'recall': 0.0613236542458215, 'f1-score': 0.10269922485370263, 'support': 136652}, '1': {'precision': 0.3347600774049657, 'recall': 0.6021667146028304, 'f1-score': 0.4303033656645824, 'support': 135597}, '2': {'precision': 0.35611678643474015, 'recall': 0.360763037897355, 'f1-score': 0.3584248554913295, 'support': 137503}, 'accuracy': 0.3407866221519358, 'macro avg': {'precision': 0.3355303293636403, 'recall': 0.34141780224866897, 'f1-score': 0.29714248200320487, 'support': 409752}, 'weighted avg': {'precision': 0.3355750678659146, 'recall': 0.3407866221519358, 'f1-score': 0.2969269042087722, 'support': 409752}}
[[ 8380 82278 45994]
 [10248 81652 43697]
 [ 7915 79982 49606]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1284772
{'0': {'precision': 0.3000580383052815, 'recall': 0.09031356450345009, 'f1-score': 0.138838536421618, 'support': 45796}, '1': {'precision': 0.3355167734992748, 'recall': 0.4684784739008297, 'f1-score': 0.39100327153762265, 'support': 45921}, '2': {'precision': 0.3439018110033474, 'recall': 0.4507999369951171, 'f1-score': 0.39016125262911894, 'support': 44441}, 'accuracy': 0.335514622717725, 'macro avg': {'precision': 0.3264922076026346, 'recall': 0.3365306584664656, 'f1-score': 0.3066676868627865, 'support': 136158}, 'weighted avg': {'precision': 0.32632723792130197, 'recall': 0.335514622717725, 'f1-score': 0.3059142105078972, 'support': 136158}}
[[ 4136 21935 19725]
 [ 5912 21513 18496]
 [ 3736 20671 20034]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1401539
{'0': {'precision': 0.39867211024604615, 'recall': 0.13922836435981242, 'f1-score': 0.20638191801598113, 'support': 422220}, '1': {'precision': 0.2846071912417729, 'recall': 0.648742700071264, 'f1-score': 0.3956433475256299, 'support': 324147}, '2': {'precision': 0.35105798080397116, 'recall': 0.22654285945989783, 'f1-score': 0.27537937365609616, 'support': 394592}, 'accuracy': 0.31417868652598385, 'macro avg': {'precision': 0.3447790940972634, 'recall': 0.33817130796365813, 'f1-score': 0.2924682130659024, 'support': 1140959}, 'weighted avg': {'precision': 0.34979922711414974, 'recall': 0.31417868652598385, 'f1-score': 0.28401342677940594, 'support': 1140959}}
[[ 58785 275531  87904]
 [ 36519 210288  77340]
 [ 52148 253052  89392]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189647
{'0': {'precision': 0.3508682653775205, 'recall': 0.1872006205759721, 'f1-score': 0.24414255770501445, 'support': 206260}, '1': {'precision': 0.3295099540230413, 'recall': 0.701088124401727, 'f1-score': 0.44831349965412726, 'support': 204756}, '2': {'precision': 0.3426309687220971, 'recall': 0.12259144291701833, 'f1-score': 0.1805743824580872, 'support': 209721}, 'accuracy': 0.33488256701308283, 'macro avg': {'precision': 0.34100306270755293, 'recall': 0.33696006263157247, 'f1-score': 0.291010146605743, 'support': 620737}, 'weighted avg': {'precision': 0.34103998626483706, 'recall': 0.33488256701308283, 'f1-score': 0.2900132631870007, 'support': 620737}}
[[ 38612 143384  24264]
 [ 36141 143552  25063]
 [ 35294 148717  25710]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.128958
{'0': {'precision': 0.341936497133733, 'recall': 0.18882625036137612, 'f1-score': 0.24329735619232093, 'support': 69180}, '1': {'precision': 0.3195869522413529, 'recall': 0.45379848091828334, 'f1-score': 0.3750473366324559, 'support': 64381}, '2': {'precision': 0.33587519727378107, 'recall': 0.3554337062709685, 'f1-score': 0.34537777713949247, 'support': 67661}, 'accuracy': 0.3296259852302432, 'macro avg': {'precision': 0.3324662155496223, 'recall': 0.33268614585020934, 'f1-score': 0.32124082332142306, 'support': 201222}, 'weighted avg': {'precision': 0.33274764273639806, 'recall': 0.3296259852302432, 'f1-score': 0.31977536979134535, 'support': 201222}}
[[13063 31335 24782]
 [12395 29216 22770]
 [12745 30867 24049]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1098782
{'0': {'precision': 0.3332382167315698, 'recall': 0.2528451929738762, 'f1-score': 0.28752795189377706, 'support': 392592}, '1': {'precision': 0.35380430699957505, 'recall': 0.7596150374202307, 'f1-score': 0.4827562467777443, 'support': 415417}, '2': {'precision': 0.3623128119800333, 'recall': 0.006717569026685176, 'f1-score': 0.013190574267022049, 'support': 388980}, 'accuracy': 0.34873754061231976, 'macro avg': {'precision': 0.3497851119037261, 'recall': 0.339725933140264, 'f1-score': 0.26115825764618117, 'support': 1196989}, 'weighted avg': {'precision': 0.3498239494163407, 'recall': 0.34873754061231976, 'f1-score': 0.2661320989883267, 'support': 1196989}}
[[ 99265 291251   2076]
 [ 97337 315557   2523]
 [101278 285089   2613]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205934
{'0': {'precision': 0.35798157473371545, 'recall': 0.17146842731223672, 'f1-score': 0.23187283932060723, 'support': 179934}, '1': {'precision': 0.3381342176252465, 'recall': 0.6355687518079655, 'f1-score': 0.44142320478849423, 'support': 183217}, '2': {'precision': 0.33879384796310247, 'recall': 0.20921036208285582, 'f1-score': 0.2586811645036829, 'support': 176258}, 'accuracy': 0.3414385002845707, 'macro avg': {'precision': 0.3449698801073548, 'recall': 0.33874918040101937, 'f1-score': 0.3106590695375948, 'support': 539409}, 'weighted avg': {'precision': 0.3449703651089649, 'recall': 0.3414385002845707, 'f1-score': 0.3118091605352113, 'support': 539409}}
[[ 30853 115606  33475]
 [ 28278 116447  38492]
 [ 27055 112328  36875]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1291809
{'0': {'precision': 0.33222419402543624, 'recall': 0.12964753069498347, 'f1-score': 0.1865108604281904, 'support': 69311}, '1': {'precision': 0.3155647284890755, 'recall': 0.5417061177117376, 'f1-score': 0.39880825229074146, 'support': 65482}, '2': {'precision': 0.359438960717982, 'recall': 0.33528818443804037, 'f1-score': 0.34694379626799465, 'support': 69400}, 'accuracy': 0.33168130151376396, 'macro avg': {'precision': 0.3357426277441646, 'recall': 0.3355472776149205, 'f1-score': 0.31075430299564216, 'support': 204193}, 'weighted avg': {'precision': 0.33613132936411433, 'recall': 0.33168130151376396, 'f1-score': 0.3091189006706374, 'support': 204193}}
[[ 8986 38851 21474]
 [10016 35472 19994]
 [ 8046 38085 23269]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1360824
{'0': {'precision': 0.324677402656075, 'recall': 0.09010293821878486, 'f1-score': 0.14105966493422586, 'support': 382851}, '1': {'precision': 0.2930009522126114, 'recall': 0.8011287279983786, 'f1-score': 0.42907433075599943, 'support': 320715}, '2': {'precision': 0.375231036938862, 'recall': 0.10657645730206736, 'f1-score': 0.1660032069435913, 'support': 390499}, 'accuracy': 0.3044133575244615, 'macro avg': {'precision': 0.3309697972691828, 'recall': 0.3326027078397436, 'f1-score': 0.2453790675446055, 'support': 1094065}, 'weighted avg': {'precision': 0.33343559419845925, 'recall': 0.3044133575244615, 'f1-score': 0.2343914612718706, 'support': 1094065}}
[[ 34496 307012  41343]
 [ 35829 256934  27952]
 [ 35922 312959  41618]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1243259
{'0': {'precision': 0.33471706006339397, 'recall': 0.12551511092608347, 'f1-score': 0.18256893616274378, 'support': 165741}, '1': {'precision': 0.33056444257857176, 'recall': 0.6840128208968637, 'f1-score': 0.4457232090571931, 'support': 166915}, '2': {'precision': 0.35288116730555213, 'recall': 0.1991868500034899, 'f1-score': 0.2546399571696261, 'support': 171924}, 'accuracy': 0.33536802885568195, 'macro avg': {'precision': 0.33938755664917264, 'recall': 0.33623826060881234, 'f1-score': 0.29431070079652094, 'support': 504580}, 'weighted avg': {'precision': 0.3395323754267094, 'recall': 0.33536802885568195, 'f1-score': 0.2941768747963881, 'support': 504580}}
[[ 20803 114206  30732]
 [ 20676 114172  32067]
 [ 20672 117007  34245]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1248068
{'0': {'precision': 0.3455162772119033, 'recall': 0.08603255644332461, 'f1-score': 0.13776261828606318, 'support': 60326}, '1': {'precision': 0.35244053873340336, 'recall': 0.6101804230266749, 'f1-score': 0.44680580531487835, 'support': 60469}, '2': {'precision': 0.3483118457480792, 'recall': 0.3546089828049167, 'f1-score': 0.3514322077321036, 'support': 59959}, 'accuracy': 0.350470805625325, 'macro avg': {'precision': 0.3487562205644619, 'recall': 0.35027398742497207, 'f1-score': 0.3120002104443484, 'support': 180754}, 'weighted avg': {'precision': 0.3487600375923328, 'recall': 0.350470805625325, 'f1-score': 0.3120267971702957, 'support': 180754}}
[[ 5190 33766 21370]
 [ 5161 36897 18411]
 [ 4670 34027 21262]]
testing model on single stock: results/universal/W4/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
12724/12724 - 171s - 171s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0800936
{'0': {'precision': 0.2658188705500367, 'recall': 0.06205320586424, 'f1-score': 0.10061798050773527, 'support': 886594}, '1': {'precision': 0.44692040714870634, 'recall': 0.9294839403702213, 'f1-score': 0.603609457957965, 'support': 1458533}, '2': {'precision': 0.2734202846763147, 'recall': 0.00503388083594658, 'f1-score': 0.009885757166958617, 'support': 912020}, 'accuracy': 0.43451830697232885, 'macro avg': {'precision': 0.3287198541250193, 'recall': 0.3321903423568026, 'f1-score': 0.23803773187755295, 'support': 3257147}, 'weighted avg': {'precision': 0.3490436096211672, 'recall': 0.43451830697232885, 'f1-score': 0.300449325623157, 'support': 3257147}}
[[  55016  826946    4632]
 [  95282 1355683    7568]
 [  56670  850759    4591]]
Evaluating performance on  train set...
5165/5165 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1209385
{'0': {'precision': 0.3234042355044795, 'recall': 0.1586528906929942, 'f1-score': 0.2128752549718554, 'support': 437767}, '1': {'precision': 0.3257495117039563, 'recall': 0.7298155267093703, 'f1-score': 0.4504451034431714, 'support': 441961}, '2': {'precision': 0.3166137511948655, 'recall': 0.08385890671694086, 'f1-score': 0.13259773171629655, 'support': 442374}, 'accuracy': 0.3245589220801421, 'macro avg': {'precision': 0.32192249946776713, 'recall': 0.32410910803976845, 'f1-score': 0.26530603004377445, 'support': 1322102}, 'weighted avg': {'precision': 0.32191614071936897, 'recall': 0.3245589220801421, 'f1-score': 0.265430896463644, 'support': 1322102}}
[[ 69453 333010  35304]
 [ 74644 322550  44767]
 [ 70659 334618  37097]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1245388
{'0': {'precision': 0.2625396699982881, 'recall': 0.12515851193390837, 'f1-score': 0.16950852984062612, 'support': 159294}, '1': {'precision': 0.34806746558058194, 'recall': 0.524966365331508, 'f1-score': 0.4185948031477538, 'support': 169468}, '2': {'precision': 0.35985823084443985, 'recall': 0.35354971625020537, 'f1-score': 0.3566760811215739, 'support': 158238}, 'accuracy': 0.3384948665297741, 'macro avg': {'precision': 0.3234884554744366, 'recall': 0.33455819783854057, 'f1-score': 0.3149264713699846, 'support': 487000}, 'weighted avg': {'precision': 0.32392307634923995, 'recall': 0.3384948665297741, 'f1-score': 0.31700169522955207, 'support': 487000}}
[[19937 83664 55693]
 [36677 88965 43826]
 [19325 82968 55945]]
training model: results/universal/W4/deepOF_L2/h50
Epoch 1/50
9854/9854 - 218s - loss: 2.9484 - accuracy50: 0.5033 - val_loss: 3.2485 - val_accuracy50: 0.4688 - 218s/epoch - 22ms/step
Epoch 2/50
9854/9854 - 216s - loss: 2.8861 - accuracy50: 0.5189 - val_loss: 3.2217 - val_accuracy50: 0.4738 - 216s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 222s - loss: 2.8662 - accuracy50: 0.5237 - val_loss: 3.2564 - val_accuracy50: 0.4778 - 222s/epoch - 23ms/step
Epoch 4/50
9854/9854 - 218s - loss: 2.8560 - accuracy50: 0.5261 - val_loss: 3.2796 - val_accuracy50: 0.4807 - 218s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 216s - loss: 2.8495 - accuracy50: 0.5279 - val_loss: 3.2887 - val_accuracy50: 0.4806 - 216s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 215s - loss: 2.8444 - accuracy50: 0.5288 - val_loss: 3.3016 - val_accuracy50: 0.4821 - 215s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 216s - loss: 2.8405 - accuracy50: 0.5300 - val_loss: 3.3154 - val_accuracy50: 0.4820 - 216s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 217s - loss: 2.8366 - accuracy50: 0.5306 - val_loss: 3.3449 - val_accuracy50: 0.4821 - 217s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 216s - loss: 2.8331 - accuracy50: 0.5316 - val_loss: 3.3420 - val_accuracy50: 0.4815 - 216s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 215s - loss: 2.8305 - accuracy50: 0.5322 - val_loss: 3.3571 - val_accuracy50: 0.4831 - 215s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 216s - loss: 2.8276 - accuracy50: 0.5325 - val_loss: 3.3649 - val_accuracy50: 0.4823 - 216s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 215s - loss: 2.8251 - accuracy50: 0.5333 - val_loss: 3.3653 - val_accuracy50: 0.4813 - 215s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 178s - 178s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1286464
{'0': {'precision': 0.38313908548125597, 'recall': 0.4450637505228912, 'f1-score': 0.41178636668021396, 'support': 1599281}, '1': {'precision': 0.5603121697610207, 'recall': 0.5091916978033344, 'f1-score': 0.5335301978294464, 'support': 2866663}, '2': {'precision': 0.37897628309606485, 'recall': 0.37969828115045023, 'f1-score': 0.37933693857596124, 'support': 1605667}, 'accuracy': 0.45805503679336507, 'macro avg': {'precision': 0.4408091794461138, 'recall': 0.4446512431588919, 'f1-score': 0.44155116769520725, 'support': 6071611}, 'weighted avg': {'precision': 0.46568907935985926, 'recall': 0.45805503679336507, 'f1-score': 0.46068534264522243, 'support': 6071611}}
[[ 711782  550844  336655]
 [ 744580 1459681  662402]
 [ 401402  594596  609669]]
Evaluating performance on  train set...
9854/9854 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0791122
{'0': {'precision': 0.42932333010086465, 'recall': 0.4778976026972242, 'f1-score': 0.45231008857873317, 'support': 773536}, '1': {'precision': 0.5310608618070459, 'recall': 0.5414563688607297, 'f1-score': 0.5362082354594144, 'support': 976195}, '2': {'precision': 0.44353155914099646, 'recall': 0.38229379644508554, 'f1-score': 0.41064218345992665, 'support': 772283}, 'accuracy': 0.47322378067687176, 'macro avg': {'precision': 0.46797191701630236, 'recall': 0.4672159226676798, 'f1-score': 0.46638683583269147, 'support': 2522014}, 'weighted avg': {'precision': 0.4730536359245895, 'recall': 0.47322378067687176, 'f1-score': 0.47202510075761855, 'support': 2522014}}
[[369671 225411 178454]
 [255666 528567 191962]
 [235718 241326 295239]]
Evaluating performance on  val set...
3566/3566 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0811268
{'0': {'precision': 0.42201063592650384, 'recall': 0.4827216930446027, 'f1-score': 0.4503291904887311, 'support': 274535}, '1': {'precision': 0.5429166236349899, 'recall': 0.5474681202673705, 'f1-score': 0.5451828724961895, 'support': 364887}, '2': {'precision': 0.43430002647879745, 'recall': 0.3665852041021958, 'f1-score': 0.3975799721835883, 'support': 272927}, 'accuracy': 0.4738745808895499, 'macro avg': {'precision': 0.4664090953467637, 'recall': 0.4655916724713896, 'f1-score': 0.46436401172283626, 'support': 912349}, 'weighted avg': {'precision': 0.47404240187599483, 'recall': 0.4738745808895499, 'f1-score': 0.47248539339166384, 'support': 912349}}
[[132524  79892  62119]
 [ 96920 199764  68203]
 [ 84586  88290 100051]]
testing model out of sample: results/universal/W4/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0707823
{'0': {'precision': 0.459206695568122, 'recall': 0.41438514644941515, 'f1-score': 0.4356460869737111, 'support': 957293}, '1': {'precision': 0.48567078001529274, 'recall': 0.6453260626476385, 'f1-score': 0.5542296855088269, 'support': 1144688}, '2': {'precision': 0.4508491242826044, 'recall': 0.3136716216259825, 'f1-score': 0.36995353410406456, 'support': 929641}, 'accuracy': 0.4707008327555348, 'macro avg': {'precision': 0.4652421999553397, 'recall': 0.45779427690767865, 'f1-score': 0.4532764355288675, 'support': 3031622}, 'weighted avg': {'precision': 0.4666362428435485, 'recall': 0.4707008327555348, 'f1-score': 0.46027670770996165, 'support': 3031622}}
[[396688 377913 182692]
 [233501 738697 172490]
 [233666 404373 291602]]
Evaluating performance on  train set...
5528/5528 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99244344
{'0': {'precision': 0.47012424209786047, 'recall': 0.3715221277043164, 'f1-score': 0.41504737613406273, 'support': 399454}, '1': {'precision': 0.5534932734655541, 'recall': 0.7876879691587947, 'f1-score': 0.6501432896064582, 'support': 613465}, '2': {'precision': 0.4946775758273789, 'recall': 0.2781091466952903, 'f1-score': 0.3560474177236177, 'support': 401533}, 'accuracy': 0.5255003351121141, 'macro avg': {'precision': 0.5060983637969312, 'recall': 0.47910641451946717, 'f1-score': 0.4737460278213795, 'support': 1414452}, 'weighted avg': {'precision': 0.5132525748941639, 'recall': 0.5255003351121141, 'f1-score': 0.5002624871862029, 'support': 1414452}}
[[148406 187325  63723]
 [ 79896 483219  50350]
 [ 87372 202491 111670]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.022296
{'0': {'precision': 0.47319704512037414, 'recall': 0.3732559195679362, 'f1-score': 0.41732643296553074, 'support': 143127}, '1': {'precision': 0.5274393945525921, 'recall': 0.7710359856234994, 'f1-score': 0.626388085048434, 'support': 202831}, '2': {'precision': 0.4854684243501387, 'recall': 0.26802770071369575, 'f1-score': 0.3453740005275941, 'support': 141657}, 'accuracy': 0.5081488469386709, 'macro avg': {'precision': 0.4953682880077017, 'recall': 0.4707732019683771, 'f1-score': 0.4630295061805196, 'support': 487615}, 'weighted avg': {'precision': 0.499324946733813, 'recall': 0.5081488469386709, 'f1-score': 0.48338596401311246, 'support': 487615}}
[[ 53423  67767  21937]
 [ 28137 156390  18304]
 [ 31338  72351  37968]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1725854
{'0': {'precision': 0.4081198253329786, 'recall': 0.5202609684563356, 'f1-score': 0.4574175101303348, 'support': 50121}, '1': {'precision': 0.3128504148912312, 'recall': 0.1130989379239521, 'f1-score': 0.166137356093688, 'support': 37003}, '2': {'precision': 0.4021050858875042, 'recall': 0.48211040665509025, 'f1-score': 0.4384882375626687, 'support': 49526}, 'accuracy': 0.39618002195389684, 'macro avg': {'precision': 0.37435844203723795, 'recall': 0.3718234376784593, 'f1-score': 0.3540143679288972, 'support': 136650}, 'weighted avg': {'precision': 0.380142218451511, 'recall': 0.39618002195389684, 'f1-score': 0.37168219587490653, 'support': 136650}}
[[26076  4590 19455]
 [16770  4185 16048]
 [21047  4602 23877]]
Evaluating performance on  train set...
254/254 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2438561
{'0': {'precision': 0.36085998882277526, 'recall': 0.5128241065171689, 'f1-score': 0.4236261191725842, 'support': 21405}, '1': {'precision': 0.444275041927123, 'recall': 0.1337126600284495, 'f1-score': 0.20555869074492097, 'support': 21793}, '2': {'precision': 0.37498211475175275, 'recall': 0.48228744939271256, 'f1-score': 0.42191902117040975, 'support': 21736}, 'accuracy': 0.3753657559983984, 'macro avg': {'precision': 0.3933723818338837, 'recall': 0.37627473864611033, 'f1-score': 0.35036794369597163, 'support': 64934}, 'weighted avg': {'precision': 0.3935827963118458, 'recall': 0.3753657559983984, 'f1-score': 0.34986739570106956, 'support': 64934}}
[[10977  1890  8538]
 [ 9944  2914  8935]
 [ 9498  1755 10483]]
Evaluating performance on  val set...
81/81 - 1s - 926ms/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.217121
{'0': {'precision': 0.38597748208802457, 'recall': 0.5176389842141387, 'f1-score': 0.44221635883905014, 'support': 7285}, '1': {'precision': 0.35633423180592994, 'recall': 0.10753212949406214, 'f1-score': 0.1652086978255436, 'support': 6147}, '2': {'precision': 0.38249360471582694, 'recall': 0.47870267260579064, 'f1-score': 0.42522411128284393, 'support': 7184}, 'accuracy': 0.381790842064416, 'macro avg': {'precision': 0.3749351062032605, 'recall': 0.36795792877133043, 'f1-score': 0.34421638931581255, 'support': 20616}, 'weighted avg': {'precision': 0.3759248416861084, 'recall': 0.381790842064416, 'f1-score': 0.35370072056325413, 'support': 20616}}
[[3771  580 2934]
 [2868  661 2618]
 [3131  614 3439]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.72826606
{'0': {'precision': 0.559856283201446, 'recall': 0.35460091864799587, 'f1-score': 0.43419320648922166, 'support': 71627}, '1': {'precision': 0.7304971797338511, 'recall': 0.9304011023797997, 'f1-score': 0.8184190309894038, 'support': 268510}, '2': {'precision': 0.6369806583231983, 'recall': 0.22330417560653573, 'f1-score': 0.33068220006721183, 'support': 72708}, 'accuracy': 0.7059719749542807, 'macro avg': {'precision': 0.6424447070861651, 'recall': 0.5027687322114437, 'f1-score': 0.5277648125152791, 'support': 412845}, 'weighted avg': {'precision': 0.6844220311074845, 'recall': 0.7059719749542807, 'f1-score': 0.6658598074692806, 'support': 412845}}
[[ 25399  41123   5105]
 [ 14540 249822   4148]
 [  5428  51044  16236]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7899124
{'0': {'precision': 0.5664641189172902, 'recall': 0.3467035500230521, 'f1-score': 0.4301403294691885, 'support': 32535}, '1': {'precision': 0.6865992686599268, 'recall': 0.9224005366633985, 'f1-score': 0.7872213928047668, 'support': 96895}, '2': {'precision': 0.6132551028840592, 'recall': 0.22655391378678716, 'f1-score': 0.33087366520275546, 'support': 32756}, 'accuracy': 0.6663768759325712, 'macro avg': {'precision': 0.622106163487092, 'recall': 0.4985526668244125, 'f1-score': 0.5160784624922369, 'support': 162186}, 'weighted avg': {'precision': 0.6476867941489888, 'recall': 0.6663768759325712, 'f1-score': 0.6234232933328362, 'support': 162186}}
[[11280 18624  2631]
 [ 5470 89376  2049]
 [ 3163 22172  7421]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7198896
{'0': {'precision': 0.5939505041246563, 'recall': 0.3025916413728695, 'f1-score': 0.40092807424593974, 'support': 8566}, '1': {'precision': 0.7388619029826142, 'recall': 0.9541326067211626, 'f1-score': 0.8328110096743425, 'support': 35232}, '2': {'precision': 0.6558577405857741, 'recall': 0.2106147127981189, 'f1-score': 0.31884057971014496, 'support': 8931}, 'accuracy': 0.7223539228887329, 'macro avg': {'precision': 0.6628900492310149, 'recall': 0.4891129869640503, 'f1-score': 0.5175265545434757, 'support': 52729}, 'weighted avg': {'precision': 0.7012616978396484, 'recall': 0.7223539228887329, 'f1-score': 0.675596210704327, 'support': 52729}}
[[ 2592  5445   529]
 [ 1158 33616   458]
 [  614  6436  1881]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2959158
{'0': {'precision': 0.31593377733890793, 'recall': 0.42340668158972844, 'f1-score': 0.361858926154309, 'support': 71031}, '1': {'precision': 0.471022154466547, 'recall': 0.3307691643571879, 'f1-score': 0.3886288134303756, 'support': 115827}, '2': {'precision': 0.31591066685855584, 'recall': 0.3652563268640235, 'f1-score': 0.3387961274028343, 'support': 66107}, 'accuracy': 0.3657936868736782, 'macro avg': {'precision': 0.36762219955467024, 'recall': 0.3731440576036466, 'f1-score': 0.36309462232917294, 'support': 252965}, 'weighted avg': {'precision': 0.38693922747247744, 'recall': 0.3657936868736782, 'f1-score': 0.3680892872574704, 'support': 252965}}
[[30075 23050 17906]
 [43134 38312 34381]
 [21985 19976 24146]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2240486
{'0': {'precision': 0.37682595402559166, 'recall': 0.4635556329444541, 'f1-score': 0.4157154234138572, 'support': 28715}, '1': {'precision': 0.3978620194035214, 'recall': 0.3091150195421552, 'f1-score': 0.34791830322073836, 'support': 28656}, '2': {'precision': 0.39517131804365846, 'recall': 0.3922314786245672, 'f1-score': 0.3936959102561897, 'support': 29169}, 'accuracy': 0.38837531777212847, 'macro avg': {'precision': 0.38995309715759047, 'recall': 0.3883007103703922, 'f1-score': 0.38577654563026176, 'support': 86540}, 'weighted avg': {'precision': 0.38997508058571345, 'recall': 0.38837531777212847, 'f1-score': 0.38584390208788055, 'support': 86540}}
[[13311  6611  8793]
 [11080  8858  8718]
 [10933  6795 11441]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.236988
{'0': {'precision': 0.36842466694135423, 'recall': 0.5160638707195075, 'f1-score': 0.42992226941261324, 'support': 10396}, '1': {'precision': 0.3793256433007986, 'recall': 0.24785003381969273, 'f1-score': 0.29980714160481564, 'support': 10349}, '2': {'precision': 0.39292711598746083, 'recall': 0.3718364698247891, 'f1-score': 0.38209097404143844, 'support': 10787}, 'accuracy': 0.37869465939363184, 'macro avg': {'precision': 0.3802258087432045, 'recall': 0.3785834581213298, 'f1-score': 0.3706067950196224, 'support': 31532}, 'weighted avg': {'precision': 0.38038464798297045, 'recall': 0.37869465939363184, 'f1-score': 0.3708547303776088, 'support': 31532}}
[[5365 1975 3056]
 [4643 2565 3141]
 [4554 2222 4011]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3829349
{'0': {'precision': 0.31025663967550965, 'recall': 0.5666217301905034, 'f1-score': 0.40096360000963605, 'support': 73437}, '1': {'precision': 0.5987950576942714, 'recall': 0.0617620727789773, 'f1-score': 0.11197464148637552, 'support': 94945}, '2': {'precision': 0.28503217322885566, 'recall': 0.3871435263805118, 'f1-score': 0.3283318951870728, 'support': 68308}, 'accuracy': 0.31230723731463095, 'macro avg': {'precision': 0.39802795686621223, 'recall': 0.3385091097833308, 'f1-score': 0.2804233788943615, 'support': 236690}, 'weighted avg': {'precision': 0.4187202302148366, 'recall': 0.31230723731463095, 'f1-score': 0.264078293659513, 'support': 236690}}
[[41611  2421 29405]
 [52152  5864 36929]
 [40355  1508 26445]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2813327
{'0': {'precision': 0.3430857666673032, 'recall': 0.5923373668765868, 'f1-score': 0.4345039423402505, 'support': 30329}, '1': {'precision': 0.45304509530450954, 'recall': 0.067255598881949, 'f1-score': 0.11712388449866291, 'support': 28979}, '2': {'precision': 0.3428723671013039, 'recall': 0.37384231571033116, 'f1-score': 0.3576882203874765, 'support': 29261}, 'accuracy': 0.3483498741094514, 'macro avg': {'precision': 0.37966774302437223, 'recall': 0.344478427156289, 'f1-score': 0.3031053490754633, 'support': 88569}, 'weighted avg': {'precision': 0.37899299267049735, 'recall': 0.3483498741094514, 'f1-score': 0.3052819624573176, 'support': 88569}}
[[17965  1252 11112]
 [17177  1949  9853]
 [17221  1101 10939]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2871811
{'0': {'precision': 0.34270036581310276, 'recall': 0.5626023657870791, 'f1-score': 0.4259437861669882, 'support': 10990}, '1': {'precision': 0.40973630831643004, 'recall': 0.057631954350927245, 'f1-score': 0.10105052526263131, 'support': 10515}, '2': {'precision': 0.3402619813318692, 'recall': 0.40297259637714816, 'f1-score': 0.3689716764480735, 'support': 10765}, 'accuracy': 0.34480942051440966, 'macro avg': {'precision': 0.36423288515380065, 'recall': 0.34106897217171817, 'f1-score': 0.29865532929256433, 'support': 32270}, 'weighted avg': {'precision': 0.36373023028419066, 'recall': 0.34480942051440966, 'f1-score': 0.3010737087101109, 'support': 32270}}
[[6183  462 4345]
 [5843  606 4066]
 [6016  411 4338]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
1590/1590 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3612069
{'0': {'precision': 0.32618398452216, 'recall': 0.42588454997165437, 'f1-score': 0.36942569216695176, 'support': 119948}, '1': {'precision': 0.43314369364873406, 'recall': 0.307599617242968, 'f1-score': 0.35973280465312274, 'support': 169298}, '2': {'precision': 0.3320655848546315, 'recall': 0.3670559259416536, 'f1-score': 0.3486851393925703, 'support': 117745}, 'accuracy': 0.359661515856616, 'macro avg': {'precision': 0.36379775434184186, 'recall': 0.3668466977187587, 'f1-score': 0.35928121207088165, 'support': 406991}, 'weighted avg': {'precision': 0.3723781113378822, 'recall': 0.359661515856616, 'f1-score': 0.359393325709866, 'support': 406991}}
[[51084 34628 34236]
 [64525 52076 52697]
 [41002 33524 43219]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.264957
{'0': {'precision': 0.36480805017575296, 'recall': 0.4606614447345518, 'f1-score': 0.40716950651948147, 'support': 45960}, '1': {'precision': 0.3707173358932768, 'recall': 0.24684799858931405, 'f1-score': 0.2963600037048308, 'support': 45368}, '2': {'precision': 0.3815102585892922, 'recall': 0.406892682189948, 'f1-score': 0.39379288019130965, 'support': 46339}, 'accuracy': 0.3721007939448088, 'macro avg': {'precision': 0.37234521488610733, 'recall': 0.3714673751712712, 'f1-score': 0.3657741301385406, 'support': 137667}, 'weighted avg': {'precision': 0.37237744669131306, 'recall': 0.3721007939448088, 'f1-score': 0.3661497631451345, 'support': 137667}}
[[21172  9857 14931]
 [18533 11199 15636]
 [18331  9153 18855]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2813925
{'0': {'precision': 0.3601875928677563, 'recall': 0.44447627779051113, 'f1-score': 0.3979173078896071, 'support': 17452}, '1': {'precision': 0.3972614611318139, 'recall': 0.24547499196744135, 'f1-score': 0.3034455366895045, 'support': 18674}, '2': {'precision': 0.37132641065830724, 'recall': 0.43656780881082635, 'f1-score': 0.40131282919986233, 'support': 17365}, 'accuracy': 0.37243648464227624, 'macro avg': {'precision': 0.3762584882192925, 'recall': 0.37550635952292627, 'f1-score': 0.3675585579263247, 'support': 53491}, 'weighted avg': {'precision': 0.37674632212867737, 'recall': 0.37243648464227624, 'f1-score': 0.3660389988686852, 'support': 53491}}
[[7757 3685 6010]
 [7265 4584 6825]
 [6514 3270 7581]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/EXC
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8400132
{'0': {'precision': 0.550976326248488, 'recall': 0.344138439675487, 'f1-score': 0.42365993821487485, 'support': 222364}, '1': {'precision': 0.6243434236043167, 'recall': 0.9134394067971813, 'f1-score': 0.741717068522542, 'support': 507887}, '2': {'precision': 0.6609341751840095, 'recall': 0.23913217247167612, 'f1-score': 0.3511977213328473, 'support': 237697}, 'accuracy': 0.6170672391492105, 'macro avg': {'precision': 0.6120846416789382, 'recall': 0.49890333964811484, 'f1-score': 0.5055249093567548, 'support': 967948}, 'weighted avg': {'precision': 0.616474520152692, 'recall': 0.6170672391492105, 'f1-score': 0.5727516561319147, 'support': 967948}}
[[ 76524 126767  19073]
 [ 33876 463924  10087]
 [ 28488 152368  56841]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89681727
{'0': {'precision': 0.5909634703944673, 'recall': 0.32424266947209407, 'f1-score': 0.4187375168377537, 'support': 111213}, '1': {'precision': 0.5550498279844298, 'recall': 0.9173878919576929, 'f1-score': 0.6916367120045405, 'support': 187297}, '2': {'precision': 0.6497472297400807, 'recall': 0.22876663070837827, 'f1-score': 0.33839075568793797, 'support': 111240}, 'accuracy': 0.5694496644295302, 'macro avg': {'precision': 0.598586842706326, 'recall': 0.49013239737938835, 'f1-score': 0.48292166151007737, 'support': 409750}, 'weighted avg': {'precision': 0.5905060888377455, 'recall': 0.5694496644295302, 'f1-score': 0.5216671735719774, 'support': 409750}}
[[ 36060  65870   9283]
 [ 11038 171824   4435]
 [ 13921  71871  25448]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84346426
{'0': {'precision': 0.6029452471903892, 'recall': 0.32252428334517885, 'f1-score': 0.4202504292797747, 'support': 33768}, '1': {'precision': 0.6007885565864095, 'recall': 0.9300943068734089, 'f1-score': 0.7300232166069694, 'support': 69136}, '2': {'precision': 0.6683839479392625, 'recall': 0.22237926264509533, 'f1-score': 0.33372444604900947, 'support': 33254}, 'accuracy': 0.6065673702610203, 'macro avg': {'precision': 0.6240392505720204, 'recall': 0.49166595095456106, 'f1-score': 0.4946660306452512, 'support': 136158}, 'weighted avg': {'precision': 0.6178323165737989, 'recall': 0.6065673702610203, 'f1-score': 0.5564092769295423, 'support': 136158}}
[[10891 20574  2303]
 [ 3467 64303  1366]
 [ 3705 22154  7395]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/AAL
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9144757
{'0': {'precision': 0.5614027991262843, 'recall': 0.38799947815714925, 'f1-score': 0.4588655374205138, 'support': 321936}, '1': {'precision': 0.5660708753616491, 'recall': 0.8463427128044796, 'f1-score': 0.6783989679895855, 'support': 509517}, '2': {'precision': 0.5337622631152302, 'recall': 0.2701888840782935, 'f1-score': 0.3587696360348456, 'support': 309502}, 'accuracy': 0.560724130224242, 'macro avg': {'precision': 0.5537453125343879, 'recall': 0.5015103583466408, 'f1-score': 0.498678047148315, 'support': 1140955}, 'weighted avg': {'precision': 0.5559894945022817, 'recall': 0.560724130224242, 'f1-score': 0.5297501325821061, 'support': 1140955}}
[[124911 153738  43287]
 [ 48533 431226  29758]
 [ 49054 176824  83624]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85477173
{'0': {'precision': 0.545613704029857, 'recall': 0.34960971612053793, 'f1-score': 0.4261547405569612, 'support': 148866}, '1': {'precision': 0.6207685162946794, 'recall': 0.904117137196632, 'f1-score': 0.7361174295648185, 'support': 323040}, '2': {'precision': 0.6020782061799289, 'recall': 0.22191388717176874, 'f1-score': 0.3242980513837679, 'support': 148828}, 'accuracy': 0.607567814877226, 'macro avg': {'precision': 0.5894868088348217, 'recall': 0.4918802468296462, 'f1-score': 0.4955234071685159, 'support': 620734}, 'weighted avg': {'precision': 0.5982634855466085, 'recall': 0.607567814877226, 'f1-score': 0.5630430368655736, 'support': 620734}}
[[ 52045  83473  13348]
 [ 22494 292066   8480]
 [ 20849  94952  33027]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.869156
{'0': {'precision': 0.5607280250864772, 'recall': 0.34705270318940334, 'f1-score': 0.42874269258815245, 'support': 49978}, '1': {'precision': 0.6055636973369773, 'recall': 0.9007108911668826, 'f1-score': 0.7242209642910716, 'support': 101844}, '2': {'precision': 0.580688041686606, 'recall': 0.22107287449392712, 'f1-score': 0.3202310613280162, 'support': 49400}, 'accuracy': 0.5963463239606007, 'macro avg': {'precision': 0.5823265880366869, 'recall': 0.4896121562834044, 'f1-score': 0.4910649060690801, 'support': 201222}, 'weighted avg': {'precision': 0.5883207784868325, 'recall': 0.5963463239606007, 'f1-score': 0.551652784521745, 'support': 201222}}
[[17345 27945  4688]
 [ 6914 91732  3198]
 [ 6674 31805 10921]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/WBA
Evaluating performance on  test set...
4676/4676 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95217097
{'0': {'precision': 0.574259056240678, 'recall': 0.34482086402278295, 'f1-score': 0.43090159969778385, 'support': 353949}, '1': {'precision': 0.5155970219583451, 'recall': 0.8737540848000394, 'f1-score': 0.6485113832715071, 'support': 488396}, '2': {'precision': 0.575309004171078, 'recall': 0.254356530566208, 'f1-score': 0.35275323893210075, 'support': 354640}, 'accuracy': 0.5338345927476117, 'macro avg': {'precision': 0.5550550274567003, 'recall': 0.49097715979634343, 'f1-score': 0.47738874063379716, 'support': 1196985}, 'weighted avg': {'precision': 0.5506347423509323, 'recall': 0.5338345927476117, 'f1-score': 0.49653752094686415, 'support': 1196985}}
[[122049 190294  41606]
 [ 36675 426738  24983]
 [ 53809 210626  90205]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94725186
{'0': {'precision': 0.5762281916366657, 'recall': 0.3268941940916603, 'f1-score': 0.4171431320818264, 'support': 159131}, '1': {'precision': 0.5228406123332824, 'recall': 0.9054291347246362, 'f1-score': 0.6628931603416871, 'support': 222669}, '2': {'precision': 0.6152223534041716, 'recall': 0.24797121955243104, 'f1-score': 0.3534721342908308, 'support': 157607}, 'accuracy': 0.5426551750348068, 'macro avg': {'precision': 0.5714303857913733, 'recall': 0.4934315161229092, 'f1-score': 0.4778361422381148, 'support': 539407}, 'weighted avg': {'precision': 0.565583157289292, 'recall': 0.5426551750348068, 'f1-score': 0.4999858057841504, 'support': 539407}}
[[ 52019  89727  17385]
 [ 14000 201611   7058]
 [ 24256  94269  39082]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97833973
{'0': {'precision': 0.56187624750499, 'recall': 0.33686033695481027, 'f1-score': 0.4211997716220739, 'support': 63510}, '1': {'precision': 0.4917165175978627, 'recall': 0.8798519095869057, 'f1-score': 0.6308656694174849, 'support': 76980}, '2': {'precision': 0.5980685863320763, 'recall': 0.26637677974349716, 'f1-score': 0.36858681958382206, 'support': 63703}, 'accuracy': 0.5195770667946502, 'macro avg': {'precision': 0.550553783811643, 'recall': 0.4943630087617377, 'f1-score': 0.47355075354112697, 'support': 204193}, 'weighted avg': {'precision': 0.5467173760062177, 'recall': 0.5195770667946502, 'f1-score': 0.4838291366277204, 'support': 204193}}
[[21394 33878  8238]
 [ 6083 67731  3166]
 [10599 36135 16969]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0610335
{'0': {'precision': 0.505258989095196, 'recall': 0.41743583500102727, 'f1-score': 0.4571678576637013, 'support': 394257}, '1': {'precision': 0.39124404831883375, 'recall': 0.6803761783524948, 'f1-score': 0.49680497581718325, 'support': 313043}, '2': {'precision': 0.5226368503543217, 'recall': 0.30262616964999056, 'f1-score': 0.38330467816148417, 'support': 386761}, 'accuracy': 0.45208448157826664, 'macro avg': {'precision': 0.4730466292561171, 'recall': 0.46681272766783755, 'f1-score': 0.44575917054745623, 'support': 1094061}, 'weighted avg': {'precision': 0.47877920404937674, 'recall': 0.45208448157826664, 'f1-score': 0.4423978633129873, 'support': 1094061}}
[[164577 161821  67859]
 [ 61010 212987  39046]
 [100141 169576 117044]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0161178
{'0': {'precision': 0.5254242559323263, 'recall': 0.3280347943148575, 'f1-score': 0.4039032398165525, 'support': 154508}, '1': {'precision': 0.4892788261543698, 'recall': 0.8642707391268601, 'f1-score': 0.6248302737723523, 'support': 194608}, '2': {'precision': 0.5841348768549453, 'recall': 0.2418098429831276, 'f1-score': 0.34203151726898867, 'support': 155461}, 'accuracy': 0.5082871395247901, 'macro avg': {'precision': 0.5329459863138805, 'recall': 0.4780384588082818, 'f1-score': 0.4569216769526312, 'support': 504577}, 'weighted avg': {'precision': 0.5295723285575603, 'recall': 0.5082871395247901, 'f1-score': 0.47004880008803435, 'support': 504577}}
[[ 50684  85799  18025]
 [ 17676 168194   8738]
 [ 28103  89766  37592]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0570866
{'0': {'precision': 0.5287876683793917, 'recall': 0.3281680915609487, 'f1-score': 0.40499462885951015, 'support': 58016}, '1': {'precision': 0.45452579474733884, 'recall': 0.8622088518164001, 'f1-score': 0.5952545786393103, 'support': 65817}, '2': {'precision': 0.5983515931249371, 'recall': 0.2091670912317071, 'f1-score': 0.30997539671175095, 'support': 56921}, 'accuracy': 0.48515108932582407, 'macro avg': {'precision': 0.5272216854172226, 'recall': 0.4665146782030187, 'f1-score': 0.4367415347368571, 'support': 180754}, 'weighted avg': {'precision': 0.5236533666411196, 'recall': 0.48515108932582407, 'f1-score': 0.44435060107353863, 'support': 180754}}
[[19039 33550  5427]
 [ 6504 56748  2565]
 [10462 34553 11906]]
testing model on single stock: results/universal/W4/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
12724/12724 - 98s - 98s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3114944
{'0': {'precision': 0.336345675067968, 'recall': 0.5084416974976763, 'f1-score': 0.40486439909297056, 'support': 877904}, '1': {'precision': 0.45911004033014446, 'recall': 0.20789488527962574, 'f1-score': 0.2861946756327271, 'support': 1506925}, '2': {'precision': 0.3366763406292804, 'recall': 0.4815513679707078, 'f1-score': 0.39628810095127665, 'support': 872314}, 'accuracy': 0.36219134376353757, 'macro avg': {'precision': 0.377377352009131, 'recall': 0.39929598358266993, 'f1-score': 0.36244905855899145, 'support': 3257143}, 'weighted avg': {'precision': 0.3932314597329814, 'recall': 0.36219134376353757, 'f1-score': 0.3476647004728913, 'support': 3257143}}
[[446363 190105 241436]
 [607464 313282 586179]
 [273269 178981 420064]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2116725
{'0': {'precision': 0.3954095242877497, 'recall': 0.5722665830926037, 'f1-score': 0.4676764377266602, 'support': 440328}, '1': {'precision': 0.38506447293825313, 'recall': 0.14498756684947373, 'f1-score': 0.21065690468373913, 'support': 440355}, '2': {'precision': 0.409352240761435, 'recall': 0.481315937918395, 'f1-score': 0.4424268485557125, 'support': 441419}, 'accuracy': 0.39958565980537053, 'macro avg': {'precision': 0.3966087459958126, 'recall': 0.3995233626201575, 'f1-score': 0.37358673032203726, 'support': 1322102}, 'weighted avg': {'precision': 0.3966190261840407, 'recall': 0.39958565980537053, 'f1-score': 0.37364020990508057, 'support': 1322102}}
[[251985  50278 138065]
 [208016  63846 168493]
 [177275  51682 212462]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2163485
{'0': {'precision': 0.3882289577139852, 'recall': 0.5804909290365946, 'f1-score': 0.4652808132147396, 'support': 157701}, '1': {'precision': 0.4371644097540533, 'recall': 0.1929269927871278, 'f1-score': 0.2677097785726315, 'support': 173024}, '2': {'precision': 0.39628350167579873, 'recall': 0.44336869856789995, 'f1-score': 0.41850590125514925, 'support': 156274}, 'accuracy': 0.3987934266805476, 'macro avg': {'precision': 0.4072256230479458, 'recall': 0.40559554013054083, 'f1-score': 0.38383216434750683, 'support': 486999}, 'weighted avg': {'precision': 0.4081996834379994, 'recall': 0.3987934266805476, 'f1-score': 0.38007687380318195, 'support': 486999}}
[[91544 19667 46490]
 [80578 33381 59065]
 [63677 23310 69287]]
training model: results/universal/W4/deepOF_L2/h100
Epoch 1/50
9854/9854 - 219s - loss: 3.1479 - accuracy100: 0.4390 - val_loss: 3.3918 - val_accuracy100: 0.3972 - 219s/epoch - 22ms/step
Epoch 2/50
9854/9854 - 217s - loss: 3.1037 - accuracy100: 0.4532 - val_loss: 3.3540 - val_accuracy100: 0.4037 - 217s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 217s - loss: 3.0896 - accuracy100: 0.4579 - val_loss: 3.4018 - val_accuracy100: 0.4153 - 217s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 217s - loss: 3.0806 - accuracy100: 0.4607 - val_loss: 3.4407 - val_accuracy100: 0.4159 - 217s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 215s - loss: 3.0753 - accuracy100: 0.4626 - val_loss: 3.4570 - val_accuracy100: 0.4180 - 215s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 217s - loss: 3.0710 - accuracy100: 0.4638 - val_loss: 3.4602 - val_accuracy100: 0.4191 - 217s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 218s - loss: 3.0675 - accuracy100: 0.4648 - val_loss: 3.4427 - val_accuracy100: 0.4188 - 218s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 216s - loss: 3.0648 - accuracy100: 0.4656 - val_loss: 3.4734 - val_accuracy100: 0.4202 - 216s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 219s - loss: 3.0620 - accuracy100: 0.4666 - val_loss: 3.4617 - val_accuracy100: 0.4206 - 219s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 220s - loss: 3.0594 - accuracy100: 0.4674 - val_loss: 3.4722 - val_accuracy100: 0.4214 - 220s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 217s - loss: 3.0577 - accuracy100: 0.4675 - val_loss: 3.4609 - val_accuracy100: 0.4222 - 217s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 218s - loss: 3.0552 - accuracy100: 0.4687 - val_loss: 3.4116 - val_accuracy100: 0.4215 - 218s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050828
{'0': {'precision': 0.4057132149492469, 'recall': 0.2823126590685512, 'f1-score': 0.3329467127819372, 'support': 1802289}, '1': {'precision': 0.43110049690594165, 'recall': 0.6058057838780461, 'f1-score': 0.5037353506256284, 'support': 2437707}, '2': {'precision': 0.37179386781981216, 'recall': 0.2825380879715442, 'f1-score': 0.3210783994381294, 'support': 1831615}, 'accuracy': 0.4122607657176983, 'macro avg': {'precision': 0.4028691932250002, 'recall': 0.39021884363938053, 'f1-score': 0.38592015428189835, 'support': 6071611}, 'weighted avg': {'precision': 0.40567361589461853, 'recall': 0.4122607657176983, 'f1-score': 0.3979367915677508, 'support': 6071611}}
[[ 508809  928998  364482]
 [ 451010 1476777  509920]
 [ 294291 1019823  517501]]
Evaluating performance on  train set...
9854/9854 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1184895
{'0': {'precision': 0.43306973777338936, 'recall': 0.2963584395704274, 'f1-score': 0.3519026977516961, 'support': 836180}, '1': {'precision': 0.3783707677028546, 'recall': 0.6168639418002153, 'f1-score': 0.46904168634491644, 'support': 851687}, '2': {'precision': 0.4109945125427594, 'recall': 0.276549576993024, 'f1-score': 0.33062711270457, 'support': 834147}, 'accuracy': 0.3980418030986347, 'macro avg': {'precision': 0.40747833933966776, 'recall': 0.3965906527878889, 'f1-score': 0.3838571656003942, 'support': 2522014}, 'weighted avg': {'precision': 0.40729653246092173, 'recall': 0.3980418030986347, 'f1-score': 0.38442384487367437, 'support': 2522014}}
[[247809 416283 172088]
 [167803 525375 158509]
 [156603 446861 230683]]
Evaluating performance on  val set...
3566/3566 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1171286
{'0': {'precision': 0.43016578544729145, 'recall': 0.2975627074478596, 'f1-score': 0.3517831087247897, 'support': 298569}, '1': {'precision': 0.3905380262631854, 'recall': 0.6416818781857342, 'f1-score': 0.4855577248906105, 'support': 316646}, '2': {'precision': 0.4135977795144035, 'recall': 0.2582706792221691, 'f1-score': 0.3179794438954253, 'support': 297134}, 'accuracy': 0.4041983933779727, 'macro avg': {'precision': 0.41143386374162677, 'recall': 0.399171754951921, 'f1-score': 0.3851067591702752, 'support': 912349}, 'weighted avg': {'precision': 0.411016436558354, 'recall': 0.4041983933779727, 'f1-score': 0.3872026455084483, 'support': 912349}}
[[ 88843 152202  57524]
 [ 62180 203186  51280]
 [ 55509 164884  76741]]
testing model out of sample: results/universal/W4/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 91s - 91s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1208473
{'0': {'precision': 0.4712325866164795, 'recall': 0.26038861154887843, 'f1-score': 0.33542931575342005, 'support': 1059670}, '1': {'precision': 0.35806394874188857, 'recall': 0.6885478678087138, 'f1-score': 0.47112819585383664, 'support': 940183}, '2': {'precision': 0.424782921428605, 'recall': 0.2627215975668972, 'f1-score': 0.3246513867280834, 'support': 1031769}, 'accuracy': 0.39396567250138703, 'macro avg': {'precision': 0.4180264855956577, 'recall': 0.4038860256414965, 'f1-score': 0.3770696327784467, 'support': 3031622}, 'weighted avg': {'precision': 0.420327640662111, 'recall': 0.39396567250138703, 'f1-score': 0.37384487255334675, 'support': 3031622}}
[[275926 570164 213580]
 [139337 647361 153485]
 [170278 590423 271068]]
Evaluating performance on  train set...
5528/5528 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0866969
{'0': {'precision': 0.47673454862167947, 'recall': 0.22576532026477142, 'f1-score': 0.30642035057305206, 'support': 450955}, '1': {'precision': 0.41890820984154703, 'recall': 0.7996141298766953, 'f1-score': 0.5497887281871358, 'support': 506388}, '2': {'precision': 0.4563229036402204, 'recall': 0.2338960729279012, 'f1-score': 0.3092703584569458, 'support': 457109}, 'accuracy': 0.43383656709453555, 'macro avg': {'precision': 0.45065522070114894, 'recall': 0.41975850768978934, 'f1-score': 0.38849314573904453, 'support': 1414452}, 'weighted avg': {'precision': 0.44943570025635954, 'recall': 0.43383656709453555, 'f1-score': 0.39446970838585826, 'support': 1414452}}
[[101810 272672  76473]
 [ 50563 404915  50910]
 [ 61184 289009 106916]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1074315
{'0': {'precision': 0.4792194050441328, 'recall': 0.2219403262824887, 'f1-score': 0.3033776937393745, 'support': 161210}, '1': {'precision': 0.39852259770505327, 'recall': 0.7829050053019743, 'f1-score': 0.5281835902176315, 'support': 167862}, '2': {'precision': 0.44113192123674655, 'recall': 0.2314577117879692, 'f1-score': 0.3036127233389457, 'support': 158543}, 'accuracy': 0.41814751391979327, 'macro avg': {'precision': 0.4396246413286442, 'recall': 0.41210101445747743, 'f1-score': 0.37839133576531725, 'support': 487615}, 'weighted avg': {'precision': 0.439055686908253, 'recall': 0.41814751391979327, 'f1-score': 0.3808437882861747, 'support': 487615}}
[[ 35779  97668  27763]
 [ 17715 131420  18727]
 [ 21167 100680  36696]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1540416
{'0': {'precision': 0.3971025476593016, 'recall': 0.2646373207972338, 'f1-score': 0.3176116758369859, 'support': 51478}, '1': {'precision': 0.24748921423014358, 'recall': 0.42185051235684146, 'f1-score': 0.31195952571988944, 'support': 33180}, '2': {'precision': 0.39440464750589677, 'recall': 0.3473418987536544, 'f1-score': 0.36938024135815095, 'support': 51992}, 'accuracy': 0.3342773508964508, 'macro avg': {'precision': 0.346332136465114, 'recall': 0.3446099106359099, 'f1-score': 0.33298381430500873, 'support': 136650}, 'weighted avg': {'precision': 0.3597484340262589, 'recall': 0.3342773508964508, 'f1-score': 0.3359359562445318, 'support': 136650}}
[[13623 20996 16859]
 [ 8313 13997 10870]
 [12370 21563 18059]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1519557
{'0': {'precision': 0.3523597130974625, 'recall': 0.2697863307028474, 'f1-score': 0.30559330893883957, 'support': 21669}, '1': {'precision': 0.3506922120783507, 'recall': 0.38452862111100666, 'f1-score': 0.3668318052410948, 'support': 21278}, '2': {'precision': 0.36026707180553336, 'recall': 0.4098330831855187, 'f1-score': 0.3834549671269602, 'support': 21987}, 'accuracy': 0.35480641882526875, 'macro avg': {'precision': 0.3544396656604489, 'recall': 0.35471601166645755, 'f1-score': 0.35196002710229823, 'support': 64934}, 'weighted avg': {'precision': 0.35449076938892293, 'recall': 0.35480641882526875, 'f1-score': 0.3520247162586042, 'support': 64934}}
[[5846 7536 8287]
 [5382 8182 7714]
 [5363 7613 9011]]
Evaluating performance on  val set...
81/81 - 1s - 845ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1625055
{'0': {'precision': 0.36838138307895235, 'recall': 0.2690243566808862, 'f1-score': 0.31095912199777326, 'support': 7267}, '1': {'precision': 0.3091495930395734, 'recall': 0.3453519360401317, 'f1-score': 0.3262495372084413, 'support': 6379}, '2': {'precision': 0.3487718440669681, 'recall': 0.4094691535150646, 'f1-score': 0.37669108427374115, 'support': 6970}, 'accuracy': 0.3401241753977493, 'macro avg': {'precision': 0.3421009400618313, 'recall': 0.34128181541202746, 'f1-score': 0.33796658115998524, 'support': 20616}, 'weighted avg': {'precision': 0.3434241617181293, 'recall': 0.3401241753977493, 'f1-score': 0.3379133971089659, 'support': 20616}}
[[1955 2472 2840]
 [1687 2203 2489]
 [1665 2451 2854]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
1613/1613 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.90834534
{'0': {'precision': 0.6216982618284934, 'recall': 0.23454014164726858, 'f1-score': 0.3405901856286994, 'support': 100955}, '1': {'precision': 0.5667501340421406, 'recall': 0.9473104644954619, 'f1-score': 0.7092032290529112, 'support': 209776}, '2': {'precision': 0.640716328814824, 'recall': 0.1513602444326929, 'f1-score': 0.24487273937118278, 'support': 102114}, 'accuracy': 0.576141166781722, 'macro avg': {'precision': 0.6097215748951527, 'recall': 0.44440361685847446, 'f1-score': 0.4315553846842644, 'support': 412845}, 'weighted avg': {'precision': 0.5984818305715621, 'recall': 0.576141166781722, 'f1-score': 0.5042159495115547, 'support': 412845}}
[[ 23678  70851   6426]
 [  8812 198723   2241]
 [  5596  81062  15456]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9747094
{'0': {'precision': 0.6085766423357665, 'recall': 0.22592810044259778, 'f1-score': 0.3295237467887491, 'support': 44284}, '1': {'precision': 0.5145240577983018, 'recall': 0.9387782836175851, 'f1-score': 0.6647261180206403, 'support': 73585}, '2': {'precision': 0.5942016367752045, 'recall': 0.1540041067761807, 'f1-score': 0.24461050481156926, 'support': 44317}, 'accuracy': 0.5297004673646307, 'macro avg': {'precision': 0.5724341123030909, 'recall': 0.43957016361212115, 'f1-score': 0.4129534565403195, 'support': 162186}, 'weighted avg': {'precision': 0.561976340493334, 'recall': 0.5297004673646307, 'f1-score': 0.45840519366083443, 'support': 162186}}
[[10005 30766  3513]
 [ 3357 69080  1148]
 [ 3078 34414  6825]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.91975194
{'0': {'precision': 0.6471935853379153, 'recall': 0.1830404146756297, 'f1-score': 0.2853715512342951, 'support': 12347}, '1': {'precision': 0.5744763382467029, 'recall': 0.9651002823836072, 'f1-score': 0.7202334314970414, 'support': 27622}, '2': {'precision': 0.6480762442640311, 'recall': 0.1438871473354232, 'f1-score': 0.23549028410184059, 'support': 12760}, 'accuracy': 0.5832464108934362, 'macro avg': {'precision': 0.6232487226162163, 'recall': 0.4306759481315534, 'f1-score': 0.41369842227772563, 'support': 52729}, 'weighted avg': {'precision': 0.6093143714090293, 'recall': 0.5832464108934362, 'f1-score': 0.5011023613768629, 'support': 52729}}
[[ 2260  9354   733]
 [  700 26658   264]
 [  532 10392  1836]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1874689
{'0': {'precision': 0.3687637816979052, 'recall': 0.25907413010590014, 'f1-score': 0.3043370085233129, 'support': 82625}, '1': {'precision': 0.3630527817403709, 'recall': 0.5047987715144923, 'f1-score': 0.42235010706638115, 'support': 93774}, '2': {'precision': 0.33497078923308177, 'recall': 0.2823185225818248, 'f1-score': 0.30639914385139305, 'support': 76566}, 'accuracy': 0.35719961259462774, 'macro avg': {'precision': 0.35559578422378596, 'recall': 0.3487304747340724, 'f1-score': 0.34436208648036243, 'support': 252965}, 'weighted avg': {'precision': 0.35641844708213033, 'recall': 0.35719961259462774, 'f1-score': 0.34870856093691743, 'support': 252965}}
[[21406 42961 18258]
 [21780 47337 24657]
 [14862 40088 21616]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1801591
{'0': {'precision': 0.3783722920326082, 'recall': 0.2906518128978688, 'f1-score': 0.328761226446475, 'support': 28904}, '1': {'precision': 0.34579699646150847, 'recall': 0.43736124326038694, 'f1-score': 0.38622642683761743, 'support': 28377}, '2': {'precision': 0.3722140195458061, 'recall': 0.36187156088724837, 'f1-score': 0.3669699332813448, 'support': 29259}, 'accuracy': 0.3628379939912179, 'macro avg': {'precision': 0.3654611026799743, 'recall': 0.3632948723485014, 'f1-score': 0.3606525288551457, 'support': 86540}, 'weighted avg': {'precision': 0.36560855206135284, 'recall': 0.3628379939912179, 'f1-score': 0.3605227072042853, 'support': 86540}}
[[ 8401 11446  9057]
 [ 7165 12411  8801]
 [ 6637 12034 10588]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1752839
{'0': {'precision': 0.36621661574849707, 'recall': 0.35576831019626615, 'f1-score': 0.36091686091686087, 'support': 10445}, '1': {'precision': 0.3293795620437956, 'recall': 0.3524702206600273, 'f1-score': 0.3405339118951042, 'support': 10242}, '2': {'precision': 0.37534772182254195, 'recall': 0.3608114338404795, 'f1-score': 0.36793606017865543, 'support': 10845}, 'accuracy': 0.3564315615882278, 'macro avg': {'precision': 0.35698129987161153, 'recall': 0.35634998823225766, 'f1-score': 0.35646227766354016, 'support': 31532}, 'weighted avg': {'precision': 0.35739198493946067, 'recall': 0.3564315615882278, 'f1-score': 0.35671037392311894, 'support': 31532}}
[[3716 3446 3283]
 [3403 3610 3229]
 [3028 3904 3913]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1261837
{'0': {'precision': 0.3185178817056396, 'recall': 0.2996481863399248, 'f1-score': 0.30879503260892216, 'support': 74187}, '1': {'precision': 0.46570272828987, 'recall': 0.4092598595353863, 'f1-score': 0.4356607603963585, 'support': 92550}, '2': {'precision': 0.3130719336177175, 'recall': 0.3829428330450445, 'f1-score': 0.3445003150760683, 'support': 69953}, 'accuracy': 0.36712577633191096, 'macro avg': {'precision': 0.365764181204409, 'recall': 0.3639502929734519, 'f1-score': 0.3629853693604497, 'support': 236690}, 'weighted avg': {'precision': 0.37446024152133145, 'recall': 0.36712577633191096, 'f1-score': 0.3689543749180671, 'support': 236690}}
[[22230 22509 29448]
 [25344 37877 29329]
 [22218 20947 26788]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1383075
{'0': {'precision': 0.354284237280834, 'recall': 0.2719037228063215, 'f1-score': 0.30767504068538504, 'support': 30246}, '1': {'precision': 0.34915325660407176, 'recall': 0.4539446651143679, 'f1-score': 0.3947121611361708, 'support': 29204}, '2': {'precision': 0.33826267937342536, 'recall': 0.3181427933651568, 'f1-score': 0.3278943828973914, 'support': 29119}, 'accuracy': 0.34713048583590195, 'macro avg': {'precision': 0.34723339108611034, 'recall': 0.3479970604286154, 'f1-score': 0.34342719490631574, 'support': 88569}, 'weighted avg': {'precision': 0.34732495237990935, 'recall': 0.34713048583590195, 'f1-score': 0.34302148347593436, 'support': 88569}}
[[ 8224 12491  9531]
 [ 7355 13257  8592]
 [ 7634 12221  9264]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1303531
{'0': {'precision': 0.36228142236826666, 'recall': 0.28, 'f1-score': 0.3158702547835875, 'support': 11025}, '1': {'precision': 0.3433657690276835, 'recall': 0.4523052464228935, 'f1-score': 0.3903777711075854, 'support': 10064}, '2': {'precision': 0.35665268776210446, 'recall': 0.33467489491100977, 'f1-score': 0.34531444654639415, 'support': 11181}, 'accuracy': 0.35268050821196156, 'macro avg': {'precision': 0.35409995971935154, 'recall': 0.3556600471113011, 'f1-score': 0.3505208241458557, 'support': 32270}, 'weighted avg': {'precision': 0.35443196414542416, 'recall': 0.35268050821196156, 'f1-score': 0.34930871627675936, 'support': 32270}}
[[3087 4226 3712]
 [2474 4552 3038]
 [2960 4479 3742]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2200651
{'0': {'precision': 0.36071934264658334, 'recall': 0.2505090861226607, 'f1-score': 0.29567823949261124, 'support': 129153}, '1': {'precision': 0.37576386163592534, 'recall': 0.44271314962086183, 'f1-score': 0.40650036692685115, 'support': 151396}, '2': {'precision': 0.32804762178970404, 'recall': 0.3604419417598583, 'f1-score': 0.3434826845536421, 'support': 126442}, 'accuracy': 0.3561602099309321, 'macro avg': {'precision': 0.3548436086907376, 'recall': 0.35122139250112694, 'f1-score': 0.34855376365770147, 'support': 406991}, 'weighted avg': {'precision': 0.35616543916548643, 'recall': 0.3561602099309321, 'f1-score': 0.35175445849362363, 'support': 406991}}
[[32354 55107 41692]
 [32710 67025 51661]
 [24629 56238 45575]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1882334
{'0': {'precision': 0.36290599268069534, 'recall': 0.278233231039018, 'f1-score': 0.3149784108392476, 'support': 45620}, '1': {'precision': 0.3422951332538177, 'recall': 0.38485721195066724, 'f1-score': 0.36233053917003, 'support': 45487}, '2': {'precision': 0.3664545666175215, 'recall': 0.405713058419244, 'f1-score': 0.3850858237860317, 'support': 46560}, 'accuracy': 0.35657782910937263, 'macro avg': {'precision': 0.35721856418401154, 'recall': 0.3562678338029764, 'f1-score': 0.3541315912651031, 'support': 137667}, 'weighted avg': {'precision': 0.35729604577801166, 'recall': 0.35657782910937263, 'f1-score': 0.3543350279528955, 'support': 137667}}
[[12693 16769 16158]
 [11481 17506 16500]
 [10802 16868 18890]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1907076
{'0': {'precision': 0.3665564478034955, 'recall': 0.25943054549506883, 'f1-score': 0.3038272048027668, 'support': 17947}, '1': {'precision': 0.3583253176732648, 'recall': 0.38698742482230725, 'f1-score': 0.3721052493231343, 'support': 18290}, '2': {'precision': 0.35211066742726754, 'recall': 0.4292917584328272, 'f1-score': 0.3868895272917211, 'support': 17254}, 'accuracy': 0.3578358976276383, 'macro avg': {'precision': 0.358997477634676, 'recall': 0.358569909583401, 'f1-score': 0.3542739938058741, 'support': 53491}, 'weighted avg': {'precision': 0.35908238927601693, 'recall': 0.3578358976276383, 'f1-score': 0.3539657841245581, 'support': 53491}}
[[4656 6549 6742]
 [4325 7078 6887]
 [3721 6126 7407]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/EXC
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.025233
{'0': {'precision': 0.5732419439451664, 'recall': 0.23149186812576186, 'f1-score': 0.32980060363168573, 'support': 287941}, '1': {'precision': 0.4417533132684983, 'recall': 0.9186281766592648, 'f1-score': 0.596607707037499, 'support': 364770}, '2': {'precision': 0.6017309509492311, 'recall': 0.17776466594974574, 'f1-score': 0.27445055281427155, 'support': 315237}, 'accuracy': 0.4729406951613103, 'macro avg': {'precision': 0.5389087360542986, 'recall': 0.4426282369115908, 'f1-score': 0.4002862878278188, 'support': 967948}, 'weighted avg': {'precision': 0.5329687901073694, 'recall': 0.4729406951613103, 'f1-score': 0.4123203703338323, 'support': 967948}}
[[ 66656 190380  30905]
 [ 23497 335088   6185]
 [ 26126 233073  56038]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0849133
{'0': {'precision': 0.5918040756796176, 'recall': 0.21260570247573027, 'f1-score': 0.3128279259021309, 'support': 137414}, '1': {'precision': 0.38745669115730025, 'recall': 0.9185401416369418, 'f1-score': 0.545015906680806, 'support': 134287}, '2': {'precision': 0.5787157098332183, 'recall': 0.17619830639845271, 'f1-score': 0.27014660151043984, 'support': 138049}, 'accuracy': 0.4316949359365467, 'macro avg': {'precision': 0.5193254922233786, 'recall': 0.43578138350370826, 'f1-score': 0.37599681136445895, 'support': 409750}, 'weighted avg': {'precision': 0.5204238852169502, 'recall': 0.4316949359365467, 'f1-score': 0.3745429063142783, 'support': 409750}}
[[ 29215  93565  14634]
 [  7866 123348   3073]
 [ 12285 101440  24324]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.051221
{'0': {'precision': 0.6250169491525424, 'recall': 0.21043621173731425, 'f1-score': 0.31486193411772745, 'support': 43809}, '1': {'precision': 0.42265769416392723, 'recall': 0.9338658404088367, 'f1-score': 0.581936947949774, 'support': 49702}, '2': {'precision': 0.5986541282029161, 'recall': 0.16270781063146295, 'f1-score': 0.25587226667649987, 'support': 42647}, 'accuracy': 0.4595616856886852, 'macro avg': {'precision': 0.5487762571731286, 'recall': 0.43566995425920463, 'f1-score': 0.38422371624800045, 'support': 136158}, 'weighted avg': {'precision': 0.542892102162407, 'recall': 0.4595616856886852, 'f1-score': 0.393876240953274, 'support': 136158}}
[[ 9219 30792  3798]
 [ 2433 46415   854]
 [ 3098 32610  6939]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/AAL
Evaluating performance on  test set...
4457/4457 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0548416
{'0': {'precision': 0.5691138286535212, 'recall': 0.2456310654939939, 'f1-score': 0.3431553535927293, 'support': 393517}, '1': {'precision': 0.40140810621088086, 'recall': 0.8754220697822039, 'f1-score': 0.550427961013959, 'support': 374938}, '2': {'precision': 0.5030570076522963, 'recall': 0.20718926174496644, 'f1-score': 0.29349822595917996, 'support': 372500}, 'accuracy': 0.44004101826978276, 'macro avg': {'precision': 0.49119298083889945, 'recall': 0.4427474656737214, 'f1-score': 0.39569384685528936, 'support': 1140955}, 'weighted avg': {'precision': 0.49243647154114173, 'recall': 0.44004101826978276, 'f1-score': 0.3950566966236147, 'support': 1140955}}
[[ 96660 239351  57506]
 [ 27975 328229  18734]
 [ 45208 250114  77178]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0216504
{'0': {'precision': 0.562266138196735, 'recall': 0.21584869523581518, 'f1-score': 0.3119447338374538, 'support': 187965}, '1': {'precision': 0.4592602399331935, 'recall': 0.9216855650297169, 'f1-score': 0.6130487267744408, 'support': 244642}, '2': {'precision': 0.5638995937923132, 'recall': 0.17267058954854966, 'f1-score': 0.26438451490031867, 'support': 188127}, 'accuracy': 0.48094513914172576, 'macro avg': {'precision': 0.5284753239740806, 'recall': 0.43673494993802725, 'f1-score': 0.39645932517073773, 'support': 620734}, 'weighted avg': {'precision': 0.522164787437537, 'recall': 0.48094513914172576, 'f1-score': 0.41620085921821914, 'support': 620734}}
[[ 40572 128098  19295]
 [ 13332 225483   5827]
 [ 18254 137389  32484]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0382346
{'0': {'precision': 0.576441214499086, 'recall': 0.20391457952179673, 'f1-score': 0.30125942236668884, 'support': 63404}, '1': {'precision': 0.4407504170732475, 'recall': 0.9206643522171375, 'f1-score': 0.5961198693851139, 'support': 76044}, '2': {'precision': 0.5472729095648686, 'recall': 0.1767248356913912, 'f1-score': 0.26717407797166, 'support': 61774}, 'accuracy': 0.4664350816511117, 'macro avg': {'precision': 0.5214881803790674, 'recall': 0.43376792247677515, 'f1-score': 0.3881844565744876, 'support': 201222}, 'weighted avg': {'precision': 0.5162076721008553, 'recall': 0.4664350816511117, 'f1-score': 0.40222641289660405, 'support': 201222}}
[[12929 43494  6981]
 [ 3983 70011  2050]
 [ 5517 45340 10917]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0834453
{'0': {'precision': 0.5505590422152118, 'recall': 0.24516205892645734, 'f1-score': 0.3392550182630602, 'support': 402909}, '1': {'precision': 0.38652797554961277, 'recall': 0.847195755381262, 'f1-score': 0.530856061226388, 'support': 394099}, '2': {'precision': 0.5150831377088196, 'recall': 0.1980363870922578, 'f1-score': 0.28608164577306333, 'support': 399977}, 'accuracy': 0.4276302543473811, 'macro avg': {'precision': 0.48405671849121473, 'recall': 0.43013140046665904, 'f1-score': 0.38539757508750383, 'support': 1196985}, 'weighted avg': {'precision': 0.4846985467214512, 'recall': 0.4276302543473811, 'f1-score': 0.3845702506363757, 'support': 1196985}}
[[ 98778 256065  48066]
 [ 33715 333879  26505]
 [ 46921 273846  79210]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0911105
{'0': {'precision': 0.5691196312120531, 'recall': 0.2220467518794519, 'f1-score': 0.31945534654207375, 'support': 182367}, '1': {'precision': 0.3923227470201903, 'recall': 0.8849361940821764, 'f1-score': 0.5436338512537948, 'support': 178275}, '2': {'precision': 0.5338414080929051, 'recall': 0.19748832265823846, 'f1-score': 0.2883171292420895, 'support': 178765}, 'accuracy': 0.43299401008885685, 'macro avg': {'precision': 0.49842792877504954, 'recall': 0.4348237562066222, 'f1-score': 0.3838021090126527, 'support': 539407}, 'weighted avg': {'precision': 0.4989963734768016, 'recall': 0.43299401008885685, 'f1-score': 0.38322722846398133, 'support': 539407}}
[[ 40494 119898  21975]
 [ 11660 157762   8853]
 [ 18998 124463  35304]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1120489
{'0': {'precision': 0.5454795462358198, 'recall': 0.2236725258305964, 'f1-score': 0.3172553057491028, 'support': 70943}, '1': {'precision': 0.36496085375125864, 'recall': 0.8588307355050855, 'f1-score': 0.5122434264288804, 'support': 62039}, '2': {'precision': 0.5276861775212971, 'recall': 0.2157250986504894, 'f1-score': 0.30625080988407444, 'support': 71211}, 'accuracy': 0.4138780467498886, 'macro avg': {'precision': 0.4793755258361252, 'recall': 0.4327427866620572, 'f1-score': 0.3785831806873525, 'support': 204193}, 'weighted avg': {'precision': 0.48442807658416887, 'recall': 0.4138780467498886, 'f1-score': 0.3726598831039004, 'support': 204193}}
[[15868 45192  9883]
 [ 4891 53281  3867]
 [ 8331 47518 15362]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1329361
{'0': {'precision': 0.4789169634954097, 'recall': 0.2779866814595294, 'f1-score': 0.35178199567182505, 'support': 402897}, '1': {'precision': 0.30544388395257727, 'recall': 0.6652468673207969, 'f1-score': 0.4186618378205262, 'support': 286895}, '2': {'precision': 0.4606801726775213, 'recall': 0.268192713267651, 'f1-score': 0.3390195131179245, 'support': 404269}, 'accuracy': 0.3759187101998883, 'macro avg': {'precision': 0.4150136733751694, 'recall': 0.4038087540159924, 'f1-score': 0.36982111553675856, 'support': 1094061}, 'weighted avg': {'precision': 0.4266884969450091, 'recall': 0.3759187101998883, 'f1-score': 0.3646039646970154, 'support': 1094061}}
[[112000 211542  79355]
 [ 48464 190856  47575]
 [ 73397 222450 108422]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.115087
{'0': {'precision': 0.5075173534189927, 'recall': 0.20602289009994185, 'f1-score': 0.29307440716055383, 'support': 166797}, '1': {'precision': 0.38723443834702065, 'recall': 0.8496314614294975, 'f1-score': 0.5320003758338815, 'support': 166604}, '2': {'precision': 0.506064132583671, 'recall': 0.210853156984624, 'f1-score': 0.29767790941743605, 'support': 171176}, 'accuracy': 0.4201717478204516, 'macro avg': {'precision': 0.46693864144989483, 'recall': 0.4221691695046878, 'f1-score': 0.3742508974706238, 'support': 504577}, 'weighted avg': {'precision': 0.4673086809817673, 'recall': 0.4201717478204516, 'f1-score': 0.3735260155120545, 'support': 504577}}
[[ 34364 109037  23396]
 [ 13220 141552  11832]
 [ 20126 114957  36093]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1425517
{'0': {'precision': 0.5165392287234043, 'recall': 0.20000965452877853, 'f1-score': 0.2883622739557597, 'support': 62147}, '1': {'precision': 0.3645746416194965, 'recall': 0.8522501625459082, 'f1-score': 0.5106878106309493, 'support': 56907}, '2': {'precision': 0.49558344955834494, 'recall': 0.1900486223662885, 'f1-score': 0.27473904944881156, 'support': 61700}, 'accuracy': 0.40195514345464, 'macro avg': {'precision': 0.4588991066337486, 'recall': 0.41410281314699177, 'f1-score': 0.35792971134517354, 'support': 180754}, 'weighted avg': {'precision': 0.4615428229298603, 'recall': 0.40195514345464, 'f1-score': 0.3537070318227851, 'support': 180754}}
[[12430 41684  8033]
 [ 4506 48499  3902]
 [ 7128 42846 11726]]
testing model on single stock: results/universal/W4/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
12724/12724 - 96s - 96s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1602821
{'0': {'precision': 0.34929237190544904, 'recall': 0.3174761854411581, 'f1-score': 0.3326251923981807, 'support': 936297}, '1': {'precision': 0.4163278757371255, 'recall': 0.41482529756369724, 'f1-score': 0.4155752284524042, 'support': 1376512}, '2': {'precision': 0.3283542128404861, 'recall': 0.35973606795900603, 'f1-score': 0.3433295214917624, 'support': 944334}, 'accuracy': 0.37086950127765345, 'macro avg': {'precision': 0.36465815349435354, 'recall': 0.3640125169879538, 'f1-score': 0.36384331411411575, 'support': 3257143}, 'weighted avg': {'precision': 0.3715519288078926, 'recall': 0.37086950127765345, 'f1-score': 0.3707844571094107, 'support': 3257143}}
[[297252 389666 249379]
 [360003 571012 445497]
 [193757 410866 339711]]
Evaluating performance on  train set...
5165/5165 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1563948
{'0': {'precision': 0.3874862868071804, 'recall': 0.3613039158664672, 'f1-score': 0.3739373519260881, 'support': 441869}, '1': {'precision': 0.32630173079910507, 'recall': 0.3706707674819405, 'f1-score': 0.34707399010518203, 'support': 436336}, '2': {'precision': 0.37443143840954773, 'recall': 0.349569832641356, 'f1-score': 0.3615737720197595, 'support': 443897}, 'accuracy': 0.36045554730270435, 'macro avg': {'precision': 0.3627398186719444, 'recall': 0.3605148386632546, 'f1-score': 0.36086170468367657, 'support': 1322102}, 'weighted avg': {'precision': 0.36291024617680273, 'recall': 0.36045554730270435, 'f1-score': 0.36092049855685754, 'support': 1322102}}
[[159649 159678 122542]
 [137891 161737 136708]
 [114472 174252 155173]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.158335
{'0': {'precision': 0.38662866027468257, 'recall': 0.3626663342578454, 'f1-score': 0.3742643417184977, 'support': 160445}, '1': {'precision': 0.3516033903601281, 'recall': 0.4306568033536859, 'f1-score': 0.3871356189605817, 'support': 167219}, '2': {'precision': 0.3715541987515378, 'recall': 0.3070700097279317, 'f1-score': 0.3362483978599188, 'support': 159335}, 'accuracy': 0.3678221105176807, 'macro avg': {'precision': 0.3699287497954495, 'recall': 0.366797715779821, 'f1-score': 0.365882786179666, 'support': 486999}, 'weighted avg': {'precision': 0.3696701450895751, 'recall': 0.3678221105176807, 'f1-score': 0.3662459509095584, 'support': 486999}}
[[58188 62868 39389]
 [51839 72014 43366]
 [40474 69934 48927]]
training model: results/universal/W4/deepOF_L2/h200
Epoch 1/50
9854/9854 - 218s - loss: 3.2389 - accuracy200: 0.4004 - val_loss: 3.3451 - val_accuracy200: 0.3442 - 218s/epoch - 22ms/step
Epoch 2/50
9854/9854 - 216s - loss: 3.2180 - accuracy200: 0.4108 - val_loss: 3.3707 - val_accuracy200: 0.3439 - 216s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 217s - loss: 3.2072 - accuracy200: 0.4162 - val_loss: 3.3529 - val_accuracy200: 0.3468 - 217s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 216s - loss: 3.2012 - accuracy200: 0.4191 - val_loss: 3.3495 - val_accuracy200: 0.3480 - 216s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 216s - loss: 3.1972 - accuracy200: 0.4208 - val_loss: 3.3292 - val_accuracy200: 0.3537 - 216s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 217s - loss: 3.1935 - accuracy200: 0.4227 - val_loss: 3.3270 - val_accuracy200: 0.3559 - 217s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 217s - loss: 3.1909 - accuracy200: 0.4236 - val_loss: 3.3225 - val_accuracy200: 0.3588 - 217s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 216s - loss: 3.1882 - accuracy200: 0.4248 - val_loss: 3.3253 - val_accuracy200: 0.3576 - 216s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 217s - loss: 3.1861 - accuracy200: 0.4256 - val_loss: 3.3328 - val_accuracy200: 0.3554 - 217s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 216s - loss: 3.1839 - accuracy200: 0.4265 - val_loss: 3.3410 - val_accuracy200: 0.3532 - 216s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 216s - loss: 3.1818 - accuracy200: 0.4277 - val_loss: 3.3497 - val_accuracy200: 0.3521 - 216s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 217s - loss: 3.1803 - accuracy200: 0.4281 - val_loss: 3.3495 - val_accuracy200: 0.3533 - 217s/epoch - 22ms/step
Epoch 13/50
9854/9854 - 217s - loss: 3.1778 - accuracy200: 0.4293 - val_loss: 3.3627 - val_accuracy200: 0.3538 - 217s/epoch - 22ms/step
Epoch 14/50
9854/9854 - 218s - loss: 3.1764 - accuracy200: 0.4298 - val_loss: 3.3598 - val_accuracy200: 0.3525 - 218s/epoch - 22ms/step
Epoch 15/50
9854/9854 - 216s - loss: 3.1747 - accuracy200: 0.4304 - val_loss: 3.3797 - val_accuracy200: 0.3527 - 216s/epoch - 22ms/step
Epoch 16/50
9854/9854 - 217s - loss: 3.1731 - accuracy200: 0.4311 - val_loss: 3.3774 - val_accuracy200: 0.3525 - 217s/epoch - 22ms/step
Epoch 17/50
9854/9854 - 215s - loss: 3.1708 - accuracy200: 0.4321 - val_loss: 3.3751 - val_accuracy200: 0.3543 - 215s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888599
{'0': {'precision': 0.37082514864742094, 'recall': 0.23343892545899259, 'f1-score': 0.2865138867023912, 'support': 1800955}, '1': {'precision': 0.398586180873713, 'recall': 0.802885866655173, 'f1-score': 0.5327118711180381, 'support': 2412932}, '2': {'precision': 0.3401260395681595, 'recall': 0.014177563513202176, 'f1-score': 0.027220488228363544, 'support': 1857724}, 'accuracy': 0.3926569076971499, 'macro avg': {'precision': 0.36984578969643117, 'recall': 0.3501674518757893, 'f1-score': 0.28214874868293094, 'support': 6071611}, 'weighted avg': {'precision': 0.37246474830172843, 'recall': 0.3926569076971499, 'f1-score': 0.3050202477893006, 'support': 6071611}}
[[ 420413 1360726   19816]
 [ 444341 1937309   31282]
 [ 268969 1562417   26338]]
Evaluating performance on  train set...
9854/9854 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096601
{'0': {'precision': 0.40577482840582785, 'recall': 0.24641968716141235, 'f1-score': 0.3066290926619452, 'support': 838963}, '1': {'precision': 0.34046063022171325, 'recall': 0.7982661226772715, 'f1-score': 0.4773369669579661, 'support': 843889}, '2': {'precision': 0.39530835054588376, 'recall': 0.015964736248781523, 'f1-score': 0.030690039081291837, 'support': 839162}, 'accuracy': 0.3543921643575333, 'macro avg': {'precision': 0.3805146030578082, 'recall': 0.3535501820291551, 'f1-score': 0.2715520329004011, 'support': 2522014}, 'weighted avg': {'precision': 0.3804375369057407, 'recall': 0.3543921643575333, 'f1-score': 0.27193496695564323, 'support': 2522014}}
[[206737 621855  10371]
 [160119 673648  10122]
 [142631 683134  13397]]
Evaluating performance on  val set...
3566/3566 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073275
{'0': {'precision': 0.405555903503328, 'recall': 0.23632086739568955, 'f1-score': 0.29862841977943194, 'support': 301408}, '1': {'precision': 0.34679083454450843, 'recall': 0.8086871157745663, 'f1-score': 0.48541866106127063, 'support': 310690}, '2': {'precision': 0.3935969868173258, 'recall': 0.01600993835157918, 'f1-score': 0.030768344513287933, 'support': 300251}, 'accuracy': 0.3587300473831834, 'macro avg': {'precision': 0.3819812416217207, 'recall': 0.35367264050727837, 'f1-score': 0.2716051417846635, 'support': 912349}, 'weighted avg': {'precision': 0.3816084930620336, 'recall': 0.3587300473831834, 'f1-score': 0.2740858429860332, 'support': 912349}}
[[ 71229 226217   3962]
 [ 55995 251251   3444]
 [ 48409 247035   4807]]
testing model out of sample: results/universal/W4/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 90s - 90s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1289842
{'0': {'precision': 0.4149218301320911, 'recall': 0.15293716965191262, 'f1-score': 0.22349551684953758, 'support': 1062894}, '1': {'precision': 0.3096126164651209, 'recall': 0.8568588426753462, 'f1-score': 0.4548663512392761, 'support': 937075}, '2': {'precision': 0.38580711795842837, 'recall': 0.01737987482225128, 'f1-score': 0.03326138757307813, 'support': 1031653}, 'accuracy': 0.32438971613215634, 'macro avg': {'precision': 0.37011385485188014, 'recall': 0.3423919623831701, 'f1-score': 0.23720775188729729, 'support': 3031622}, 'weighted avg': {'precision': 0.37246306991888783, 'recall': 0.32438971613215634, 'f1-score': 0.2302761162993757, 'support': 3031622}}
[[162556 885911  14427]
 [120017 802941  14117]
 [109202 904521  17930]]
Evaluating performance on  train set...
5528/5528 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241983
{'0': {'precision': 0.42082532169797365, 'recall': 0.1824684416986436, 'f1-score': 0.2545603662309969, 'support': 467785}, '1': {'precision': 0.3321904478096694, 'recall': 0.849886816535708, 'f1-score': 0.4776748368117536, 'support': 466941}, '2': {'precision': 0.41159846923756255, 'recall': 0.014572902031576358, 'f1-score': 0.028149165208743113, 'support': 479726}, 'accuracy': 0.34585408341887885, 'macro avg': {'precision': 0.3882047462484019, 'recall': 0.34897605342197596, 'f1-score': 0.25346145608383125, 'support': 1414452}, 'weighted avg': {'precision': 0.3884356628960476, 'recall': 0.34585408341887885, 'f1-score': 0.25142555090028745, 'support': 1414452}}
[[ 85356 377205   5224]
 [ 65324 396847   4770]
 [ 52150 420585   6991]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.130623
{'0': {'precision': 0.42737598983434316, 'recall': 0.1657162771972624, 'f1-score': 0.23882677935866017, 'support': 166423}, '1': {'precision': 0.32522183318144754, 'recall': 0.8588954335296726, 'f1-score': 0.4717971019534851, 'support': 157890}, '2': {'precision': 0.3994102228047182, 'recall': 0.014929394618559478, 'f1-score': 0.02878292386338146, 'support': 163302}, 'accuracy': 0.339669616398183, 'macro avg': {'precision': 0.3840026819401696, 'recall': 0.34651370178183155, 'f1-score': 0.2464689350585089, 'support': 487615}, 'weighted avg': {'precision': 0.38493269854634443, 'recall': 0.339669616398183, 'f1-score': 0.24391912176897756, 'support': 487615}}
[[ 27579 136934   1910]
 [ 20523 135611   1756]
 [ 16429 144435   2438]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1393503
{'0': {'precision': 0.36772864162307817, 'recall': 0.23391341170776955, 'f1-score': 0.28593965687241174, 'support': 49591}, '1': {'precision': 0.28712890817634873, 'recall': 0.7468253764654575, 'f1-score': 0.414786529981264, 'support': 38981}, '2': {'precision': 0.35962314939434725, 'recall': 0.027788177544822996, 'f1-score': 0.05158998320236326, 'support': 48078}, 'accuracy': 0.30770581778265643, 'macro avg': {'precision': 0.3381602330645914, 'recall': 0.33617565523935006, 'f1-score': 0.25077205668534636, 'support': 136650}, 'weighted avg': {'precision': 0.34188485044225203, 'recall': 0.30770581778265643, 'f1-score': 0.24024274029683604, 'support': 136650}}
[[11600 36657  1334]
 [ 8824 29112  1045]
 [11121 35621  1336]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.123926
{'0': {'precision': 0.3384906188742649, 'recall': 0.22377007451288933, 'f1-score': 0.26942687581845026, 'support': 21607}, '1': {'precision': 0.33188297696005303, 'recall': 0.746968849095318, 'f1-score': 0.4595742239054341, 'support': 21444}, '2': {'precision': 0.3575020955574183, 'recall': 0.038980030160398485, 'f1-score': 0.07029543862540691, 'support': 21883}, 'accuracy': 0.3342778821572674, 'macro avg': {'precision': 0.3426252304639121, 'recall': 0.3365729845895353, 'f1-score': 0.2664321794497638, 'support': 64934}, 'weighted avg': {'precision': 0.3427154297753196, 'recall': 0.3342778821572674, 'f1-score': 0.2651136730630666, 'support': 64934}}
[[ 4835 15946   826]
 [ 4719 16018   707]
 [ 4730 16300   853]]
Evaluating performance on  val set...
81/81 - 1s - 802ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1405205
{'0': {'precision': 0.377402819307988, 'recall': 0.236324729169453, 'f1-score': 0.29064890204786575, 'support': 7477}, '1': {'precision': 0.29134527389201204, 'recall': 0.753635441325668, 'f1-score': 0.42023382990759944, 'support': 5914}, '2': {'precision': 0.31761006289308175, 'recall': 0.02795847750865052, 'f1-score': 0.051392952550566084, 'support': 7225}, 'accuracy': 0.3116996507566938, 'macro avg': {'precision': 0.3287860520310273, 'recall': 0.33930621600125715, 'f1-score': 0.2540918948353437, 'support': 20616}, 'weighted avg': {'precision': 0.3317612307996557, 'recall': 0.3116996507566938, 'f1-score': 0.24397355417458647, 'support': 20616}}
[[1767 5468  242]
 [1265 4457  192]
 [1650 5373  202]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
1613/1613 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911924
{'0': {'precision': 0.46165700576151864, 'recall': 0.20533711365902294, 'f1-score': 0.28424633532269106, 'support': 128384}, '1': {'precision': 0.3707834395443983, 'recall': 0.8570626741765163, 'f1-score': 0.5176294369222886, 'support': 153221}, '2': {'precision': 0.48506039415130325, 'recall': 0.00581377628771716, 'f1-score': 0.01148983909707634, 'support': 131240}, 'accuracy': 0.38378810449442285, 'macro avg': {'precision': 0.43916694648574, 'recall': 0.3560711880410854, 'f1-score': 0.271121870447352, 'support': 412845}, 'weighted avg': {'precision': 0.43537043817058724, 'recall': 0.38378810449442285, 'f1-score': 0.2841558162308824, 'support': 412845}}
[[ 26362 101599    423]
 [ 21514 131320    387]
 [  9227 121250    763]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.120655
{'0': {'precision': 0.4765465391844406, 'recall': 0.21472494292657782, 'f1-score': 0.2960527985784998, 'support': 54316}, '1': {'precision': 0.33528616823112606, 'recall': 0.8488496819056074, 'f1-score': 0.48070085407426416, 'support': 54072}, '2': {'precision': 0.4969400244798042, 'recall': 0.007546748949775085, 'f1-score': 0.014867710335988283, 'support': 53798}, 'accuracy': 0.3574167930647528, 'macro avg': {'precision': 0.43625757729845693, 'recall': 0.3570404579273201, 'f1-score': 0.2638737876629174, 'support': 162186}, 'weighted avg': {'precision': 0.4362156718082943, 'recall': 0.3574167930647528, 'f1-score': 0.2643428746608764, 'support': 162186}}
[[11663 42414   239]
 [ 8001 45899   172]
 [ 4810 48582   406]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005734
{'0': {'precision': 0.46385339609952925, 'recall': 0.1726101101101101, 'f1-score': 0.2515958416925041, 'support': 15984}, '1': {'precision': 0.38624168276454174, 'recall': 0.8911062691888679, 'f1-score': 0.5389015333013896, 'support': 20194}, '2': {'precision': 0.5759162303664922, 'recall': 0.006646124101262764, 'f1-score': 0.01314060446780552, 'support': 16551}, 'accuracy': 0.39568358967551065, 'macro avg': {'precision': 0.47533710307685445, 'recall': 0.3567875011334136, 'f1-score': 0.26787932648723306, 'support': 52729}, 'weighted avg': {'precision': 0.4693050646474965, 'recall': 0.39568358967551065, 'f1-score': 0.28677910906043913, 'support': 52729}}
[[ 2759 13187    38]
 [ 2156 17995    43]
 [ 1033 15408   110]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923685
{'0': {'precision': 0.3453875186518037, 'recall': 0.250165293459465, 'f1-score': 0.29016392233782895, 'support': 78648}, '1': {'precision': 0.40473772038017847, 'recall': 0.7730813775080922, 'f1-score': 0.5313128220827593, 'support': 101023}, '2': {'precision': 0.36109282422646477, 'recall': 0.01496711872731738, 'f1-score': 0.028742860137294976, 'support': 73294}, 'accuracy': 0.3908485363587848, 'macro avg': {'precision': 0.370406021086149, 'recall': 0.3460712632316249, 'f1-score': 0.28340653485262773, 'support': 252965}, 'weighted avg': {'precision': 0.3736398068971926, 'recall': 0.3908485363587848, 'f1-score': 0.3107240392156823, 'support': 252965}}
[[19675 58140   833]
 [21816 78099  1108]
 [15474 56723  1097]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1229376
{'0': {'precision': 0.3591515602572963, 'recall': 0.23654633941388606, 'f1-score': 0.2852317824875453, 'support': 28561}, '1': {'precision': 0.33729039691925167, 'recall': 0.7787384486138337, 'f1-score': 0.4707064722933373, 'support': 28568}, '2': {'precision': 0.3805759457933371, 'recall': 0.02291659583149162, 'f1-score': 0.04323006862933744, 'support': 29411}, 'accuracy': 0.3429281257222094, 'macro avg': {'precision': 0.35900596765662834, 'recall': 0.3460671279530705, 'f1-score': 0.26638944113674, 'support': 86540}, 'weighted avg': {'precision': 0.35921607249163, 'recall': 0.3429281257222094, 'f1-score': 0.2642140858396151, 'support': 86540}}
[[ 6756 21228   577]
 [ 5801 22247   520]
 [ 6254 22483   674]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269757
{'0': {'precision': 0.35698447893569846, 'recall': 0.2646234168036353, 'f1-score': 0.3039422543031649, 'support': 10343}, '1': {'precision': 0.328562245553889, 'recall': 0.7523304876852125, 'f1-score': 0.4573763646125396, 'support': 10191}, '2': {'precision': 0.4320754716981132, 'recall': 0.020821967630478267, 'f1-score': 0.0397293546148508, 'support': 10998}, 'accuracy': 0.33721298997843463, 'macro avg': {'precision': 0.3725407320625669, 'recall': 0.345925290706442, 'f1-score': 0.26701599117685176, 'support': 31532}, 'weighted avg': {'precision': 0.3739894186162458, 'recall': 0.33721298997843463, 'f1-score': 0.26137703634651005, 'support': 31532}}
[[2737 7459  147]
 [2370 7667  154]
 [2560 8209  229]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090807
{'0': {'precision': 0.32074938921832225, 'recall': 0.35065632298069954, 'f1-score': 0.33503677248507624, 'support': 74506}, '1': {'precision': 0.3804764032585158, 'recall': 0.6261922271878713, 'f1-score': 0.4733461620697028, 'support': 88385}, '2': {'precision': 0.3319688907081457, 'recall': 0.04395723519288879, 'f1-score': 0.0776345861602709, 'support': 73799}, 'accuracy': 0.3579196417254637, 'macro avg': {'precision': 0.3443982277283279, 'recall': 0.3402685951204865, 'f1-score': 0.2953391735716833, 'support': 236690}, 'weighted avg': {'precision': 0.34655090227924573, 'recall': 0.3579196417254637, 'f1-score': 0.30642741615338887, 'support': 236690}}
[[26126 44787  3593]
 [30104 55346  2935]
 [25223 45332  3244]]
Evaluating performance on  train set...
346/346 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1163517
{'0': {'precision': 0.3475854011349727, 'recall': 0.4177253276277079, 'f1-score': 0.37944123899180077, 'support': 29912}, '1': {'precision': 0.34365719980069753, 'recall': 0.5875157586289141, 'f1-score': 0.43365524872994315, 'support': 29349}, '2': {'precision': 0.3446443172526574, 'recall': 0.02876347754879214, 'f1-score': 0.05309567298608049, 'support': 29308}, 'accuracy': 0.34527882216125283, 'macro avg': {'precision': 0.34529563939610924, 'recall': 0.3446681879351381, 'f1-score': 0.2887307202359415, 'support': 88569}, 'weighted avg': {'precision': 0.34531049606228886, 'recall': 0.34527882216125283, 'f1-score': 0.289416412283913, 'support': 88569}}
[[12495 16544   873]
 [11376 17243   730]
 [12077 16388   843]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1269696
{'0': {'precision': 0.3524011899702507, 'recall': 0.3751017823215417, 'f1-score': 0.36339731790691554, 'support': 11053}, '1': {'precision': 0.31198484615778427, 'recall': 0.634527280299875, 'f1-score': 0.41829975632357486, 'support': 9604}, '2': {'precision': 0.33127572016460904, 'recall': 0.027727546714888487, 'f1-score': 0.051172030194676206, 'support': 11613}, 'accuracy': 0.327300898667493, 'macro avg': {'precision': 0.331887252097548, 'recall': 0.34578553644543514, 'f1-score': 0.27762303480838885, 'support': 32270}, 'weighted avg': {'precision': 0.3327703053458985, 'recall': 0.327300898667493, 'f1-score': 0.2673765789032391, 'support': 32270}}
[[4146 6531  376]
 [3236 6094  274]
 [4383 6908  322]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132421
{'0': {'precision': 0.353998613998614, 'recall': 0.19709386671605394, 'f1-score': 0.2532096085021166, 'support': 129588}, '1': {'precision': 0.37897054263565894, 'recall': 0.8029564417580973, 'f1-score': 0.5149164753217754, 'support': 152210}, '2': {'precision': 0.3263917024552305, 'recall': 0.03217432284552651, 'f1-score': 0.058574607006267536, 'support': 125193}, 'accuracy': 0.372949278976685, 'macro avg': {'precision': 0.3531202863631678, 'recall': 0.3440748771065592, 'f1-score': 0.2755668969433865, 'support': 406991}, 'weighted avg': {'precision': 0.3548457707686502, 'recall': 0.372949278976685, 'f1-score': 0.2912140421538446, 'support': 406991}}
[[ 25541 100162   3885]
 [ 25564 122218   4428]
 [ 21045 100120   4028]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1209987
{'0': {'precision': 0.3697097658588851, 'recall': 0.2580503255322893, 'f1-score': 0.3039496353485239, 'support': 45464}, '1': {'precision': 0.3402785222145342, 'recall': 0.7698090744741831, 'f1-score': 0.47194382683093306, 'support': 45358}, '2': {'precision': 0.3670581150255947, 'recall': 0.026021987405272708, 'f1-score': 0.04859865247378703, 'support': 46845}, 'accuracy': 0.3477086011898276, 'macro avg': {'precision': 0.3590154676996713, 'recall': 0.35129379580391507, 'f1-score': 0.2748307048844147, 'support': 137667}, 'weighted avg': {'precision': 0.35911057409538366, 'recall': 0.3477086011898276, 'f1-score': 0.27240949678584775, 'support': 137667}}
[[11732 32627  1105]
 [ 9444 34917   997]
 [10557 35069  1219]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1226554
{'0': {'precision': 0.39603684063633826, 'recall': 0.22358193277310925, 'f1-score': 0.28581019839538085, 'support': 19040}, '1': {'precision': 0.3242850570259341, 'recall': 0.7855006158718987, 'f1-score': 0.4590546052857094, 'support': 17049}, '2': {'precision': 0.3356401384083045, 'recall': 0.027870359728766808, 'f1-score': 0.051467076988380114, 'support': 17402}, 'accuracy': 0.3390103007982651, 'macro avg': {'precision': 0.35198734535685894, 'recall': 0.3456509694579249, 'f1-score': 0.2654439602231568, 'support': 53491}, 'weighted avg': {'precision': 0.35351904192354494, 'recall': 0.3390103007982651, 'f1-score': 0.264789931328932, 'support': 53491}}
[[ 4257 14249   534]
 [ 3231 13392   426]
 [ 3261 13656   485]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/EXC
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1455102
{'0': {'precision': 0.4317411555467113, 'recall': 0.21771866885764102, 'f1-score': 0.2894655100887863, 'support': 318884}, '1': {'precision': 0.2980170176935541, 'recall': 0.8021837600083396, 'f1-score': 0.43458324452241587, 'support': 297377}, '2': {'precision': 0.43488023952095806, 'recall': 0.008260185903942995, 'f1-score': 0.016212430273992863, 'support': 351687}, 'accuracy': 0.32117737729712753, 'macro avg': {'precision': 0.38821280425374116, 'recall': 0.34272087158997455, 'f1-score': 0.24675372829506503, 'support': 967948}, 'weighted avg': {'precision': 0.39179840250966025, 'recall': 0.32117737729712753, 'f1-score': 0.23476744844895048, 'support': 967948}}
[[ 69427 247476   1981]
 [ 57032 238551   1794]
 [ 34348 314434   2905]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1242855
{'0': {'precision': 0.47430040473171325, 'recall': 0.19974104255972847, 'f1-score': 0.28110217170859264, 'support': 136702}, '1': {'precision': 0.3322202331772698, 'recall': 0.8545853042971315, 'f1-score': 0.4784449012053668, 'support': 135509}, '2': {'precision': 0.45714285714285713, 'recall': 0.011982055998662198, 'f1-score': 0.02335203763532279, 'support': 137539}, 'accuracy': 0.353281269066504, 'macro avg': {'precision': 0.4212211650172801, 'recall': 0.355436134285174, 'f1-score': 0.2609663701830941, 'support': 409750}, 'weighted avg': {'precision': 0.42155367158956614, 'recall': 0.353281269066504, 'f1-score': 0.25984779767826904, 'support': 409750}}
[[ 27305 108520    877]
 [ 18625 115804   1080]
 [ 11639 124252   1648]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1185957
{'0': {'precision': 0.49318531545394595, 'recall': 0.19584906483926584, 'f1-score': 0.28036302857053597, 'support': 45821}, '1': {'precision': 0.33868995185029976, 'recall': 0.8634470729314292, 'f1-score': 0.48653496486313824, 'support': 45865}, '2': {'precision': 0.43768115942028984, 'recall': 0.010186184565569347, 'f1-score': 0.019909024985167115, 'support': 44472}, 'accuracy': 0.36008901423346407, 'macro avg': {'precision': 0.4231854755748452, 'recall': 0.3564941074454215, 'f1-score': 0.26226900613961374, 'support': 136158}, 'weighted avg': {'precision': 0.42301455296617446, 'recall': 0.36008901423346407, 'f1-score': 0.2647426861052506, 'support': 136158}}
[[ 8974 36588   259]
 [ 5940 39602   323]
 [ 3282 40737   453]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/AAL
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1450157
{'0': {'precision': 0.4884493799140796, 'recall': 0.1427224798563775, 'f1-score': 0.2208992866412018, 'support': 422218}, '1': {'precision': 0.2833888713366279, 'recall': 0.8799587841318908, 'f1-score': 0.4287119598095689, 'support': 324147}, '2': {'precision': 0.43245685370922565, 'recall': 0.012129045338199144, 'f1-score': 0.023596289476084473, 'support': 394590}, 'accuracy': 0.3070077259839345, 'macro avg': {'precision': 0.40143170165331105, 'recall': 0.3449367697754892, 'f1-score': 0.22440251197561836, 'support': 1140955}, 'weighted avg': {'precision': 0.41082682723756864, 'recall': 0.3070077259839345, 'f1-score': 0.21170353827086558, 'support': 1140955}}
[[ 60260 358619   3339]
 [ 35969 285236   2942]
 [ 27141 362663   4786]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.133117
{'0': {'precision': 0.45533093260122887, 'recall': 0.18564174128774663, 'f1-score': 0.26375048620218433, 'support': 206376}, '1': {'precision': 0.327913956039003, 'recall': 0.8533092888804179, 'f1-score': 0.47376653963611104, 'support': 204621}, '2': {'precision': 0.46736229070613927, 'recall': 0.009182929096916615, 'f1-score': 0.018011951855904387, 'support': 209737}, 'accuracy': 0.3461112167208498, 'macro avg': {'precision': 0.4168690597821237, 'recall': 0.3493779864216937, 'f1-score': 0.25184299256473325, 'support': 620734}, 'weighted avg': {'precision': 0.4173939608769643, 'recall': 0.3461112167208498, 'f1-score': 0.24994945692316592, 'support': 620734}}
[[ 38312 166867   1197]
 [ 29018 174605    998]
 [ 16811 191000   1926]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1403654
{'0': {'precision': 0.4666035639326721, 'recall': 0.16387234780597792, 'f1-score': 0.24255778878346723, 'support': 69188}, '1': {'precision': 0.3177908581727753, 'recall': 0.8659372425904915, 'f1-score': 0.4649495762906341, 'support': 64343}, '2': {'precision': 0.4633688165309956, 'recall': 0.01093202936874917, 'f1-score': 0.021360120078512877, 'support': 67691}, 'accuracy': 0.3369164405482502, 'macro avg': {'precision': 0.415921079545481, 'recall': 0.3469138732550729, 'f1-score': 0.2429558283842047, 'support': 201222}, 'weighted avg': {'precision': 0.4179308580999305, 'recall': 0.3369164405482502, 'f1-score': 0.23925925975218126, 'support': 201222}}
[[11338 57453   397]
 [ 8166 55717   460]
 [ 4795 62156   740]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0879648
{'0': {'precision': 0.4601346642386637, 'recall': 0.20853509122725686, 'f1-score': 0.28700034179644707, 'support': 392591}, '1': {'precision': 0.3526588322904113, 'recall': 0.8572683767596818, 'f1-score': 0.49973793868958116, 'support': 415416}, '2': {'precision': 0.4149166486252436, 'recall': 0.009854027734216331, 'f1-score': 0.01925085883038351, 'support': 388978}, 'accuracy': 0.36911490118923795, 'macro avg': {'precision': 0.40923671505143955, 'recall': 0.3585524985737183, 'f1-score': 0.2686630464388039, 'support': 1196985}, 'weighted avg': {'precision': 0.4081407015057204, 'recall': 0.36911490118923795, 'f1-score': 0.27382218431392613, 'support': 1196985}}
[[ 81869 308481   2241]
 [ 56129 356123   3164]
 [ 39926 345219   3833]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995775
{'0': {'precision': 0.4681360740859697, 'recall': 0.19426226321839718, 'f1-score': 0.2745815263250848, 'support': 180071}, '1': {'precision': 0.3459684101332881, 'recall': 0.8690524314698074, 'f1-score': 0.4949128076541985, 'support': 183058}, '2': {'precision': 0.41075845012366036, 'recall': 0.011306005287103325, 'f1-score': 0.02200629382211671, 'support': 176278}, 'accuracy': 0.363475075406882, 'macro avg': {'precision': 0.4082876447809727, 'recall': 0.3582068999917693, 'f1-score': 0.26383354260046665, 'support': 539407}, 'weighted avg': {'precision': 0.4079251739221269, 'recall': 0.363475075406882, 'f1-score': 0.2668136383710662, 'support': 539407}}
[[ 34981 143639   1451]
 [ 22563 159087   1408]
 [ 17180 157105   1993]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1151284
{'0': {'precision': 0.4582374393655065, 'recall': 0.1867424679672169, 'f1-score': 0.265349011245861, 'support': 69304}, '1': {'precision': 0.3259770114942529, 'recall': 0.8652936689549962, 'f1-score': 0.47355458150699226, 'support': 65550}, '2': {'precision': 0.4307692307692308, 'recall': 0.012114394496603642, 'f1-score': 0.023566048057905145, 'support': 69339}, 'accuracy': 0.3452713854049845, 'macro avg': {'precision': 0.40499456054299676, 'recall': 0.3547168438062722, 'f1-score': 0.2541565469369195, 'support': 204193}, 'weighted avg': {'precision': 0.40645168195551773, 'recall': 0.3452713854049845, 'f1-score': 0.25008348424996735, 'support': 204193}}
[[12942 55773   589]
 [ 8309 56720   521]
 [ 6992 61507   840]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1254737
{'0': {'precision': 0.4184535231897359, 'recall': 0.11790288077022534, 'f1-score': 0.1839704923377894, 'support': 382849}, '1': {'precision': 0.2967906361507841, 'recall': 0.8975910000810691, 'f1-score': 0.4460828864678997, 'support': 320714}, '2': {'precision': 0.4107219794423586, 'recall': 0.017088435792244776, 'f1-score': 0.03281171249800243, 'support': 390498}, 'accuracy': 0.3104781177649144, 'macro avg': {'precision': 0.3753220462609595, 'recall': 0.34419410554784635, 'f1-score': 0.2209550304345638, 'support': 1094061}, 'weighted avg': {'precision': 0.38002957468588305, 'recall': 0.3104781177649144, 'f1-score': 0.20685396333361786, 'support': 1094061}}
[[ 45139 332720   4990]
 [ 28260 287870   4584]
 [ 34472 349353   6673]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142148
{'0': {'precision': 0.43995168633280685, 'recall': 0.14281836442932372, 'f1-score': 0.2156362709024008, 'support': 165777}, '1': {'precision': 0.33492541337167503, 'recall': 0.892973944294699, 'f1-score': 0.48714035976277215, 'support': 166950}, '2': {'precision': 0.4151010280042538, 'recall': 0.013628164096595868, 'f1-score': 0.02638992179929236, 'support': 171850}, 'accuracy': 0.34702334826993697, 'macro avg': {'precision': 0.39665937590291184, 'recall': 0.3498068242735395, 'f1-score': 0.2430555174881551, 'support': 504577}, 'weighted avg': {'precision': 0.3967378222355079, 'recall': 0.34702334826993697, 'f1-score': 0.24101519729395218, 'support': 504577}}
[[ 23676 140439   1662]
 [ 16230 149082   1638]
 [ 13909 155599   2342]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1215934
{'0': {'precision': 0.4454263475156552, 'recall': 0.12606211180124224, 'f1-score': 0.19650925615140327, 'support': 60375}, '1': {'precision': 0.33737448635956374, 'recall': 0.9040617290083288, 'f1-score': 0.4913782241661716, 'support': 60393}, '2': {'precision': 0.3930131004366812, 'recall': 0.012002800653485813, 'f1-score': 0.023294186159371056, 'support': 59986}, 'accuracy': 0.34815273797536983, 'macro avg': {'precision': 0.3919379781039667, 'recall': 0.34737554715435226, 'f1-score': 0.2370605554923153, 'support': 180754}, 'weighted avg': {'precision': 0.3919302307487833, 'recall': 0.34815273797536983, 'f1-score': 0.23754592696794877, 'support': 180754}}
[[ 7611 52163   601]
 [ 5283 54599   511]
 [ 4193 55073   720]]
testing model on single stock: results/universal/W4/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
12724/12724 - 97s - 97s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0705905
{'0': {'precision': 0.32937303984512206, 'recall': 0.24389966049696027, 'f1-score': 0.280264427547798, 'support': 886590}, '1': {'precision': 0.4531299499709863, 'recall': 0.7923831685673207, 'f1-score': 0.5765536150307816, 'support': 1458533}, '2': {'precision': 0.3113998323554065, 'recall': 0.017108177452248855, 'f1-score': 0.03243442127122643, 'support': 912020}, 'accuracy': 0.42600493745592377, 'macro avg': {'precision': 0.3646342740571717, 'recall': 0.3511303355055099, 'f1-score': 0.29641748794993533, 'support': 3257143}, 'weighted avg': {'precision': 0.37975818188581134, 'recall': 0.42600493745592377, 'f1-score': 0.34354738293623505, 'support': 3257143}}
[[ 216239  658765   11586]
 [ 279899 1155717   22917]
 [ 160379  736038   15603]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1075864
{'0': {'precision': 0.3798506897074428, 'recall': 0.27464026559381866, 'f1-score': 0.3187891091916705, 'support': 437962}, '1': {'precision': 0.3413329563380468, 'recall': 0.7594529091357567, 'f1-score': 0.4709840756599122, 'support': 441901}, '2': {'precision': 0.38469842126568615, 'recall': 0.019340221011715383, 'f1-score': 0.03682891541363096, 'support': 442239}, 'accuracy': 0.35128757085308093, 'macro avg': {'precision': 0.3686273557703919, 'recall': 0.3511444652470969, 'f1-score': 0.27553403342173793, 'support': 1322102}, 'weighted avg': {'precision': 0.36859802619352067, 'recall': 0.35128757085308093, 'f1-score': 0.27534413576380795, 'support': 1322102}}
[[120282 310749   6931]
 [ 99549 335603   6749]
 [ 96825 336861   8553]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003405
{'0': {'precision': 0.37843283649218756, 'recall': 0.26418245984200545, 'f1-score': 0.31115137843684704, 'support': 159246}, '1': {'precision': 0.3550298271277319, 'recall': 0.7704585282958749, 'f1-score': 0.4860747901865567, 'support': 169477}, '2': {'precision': 0.3796618597712581, 'recall': 0.01929540802143092, 'f1-score': 0.03672438672438673, 'support': 158276}, 'accuracy': 0.3607789749054926, 'macro avg': {'precision': 0.3710415077970592, 'recall': 0.3513121320531038, 'f1-score': 0.27798351844926344, 'support': 486999}, 'weighted avg': {'precision': 0.3706879603640195, 'recall': 0.3607789749054926, 'f1-score': 0.2828356909566349, 'support': 486999}}
[[ 42070 114597   2579]
 [ 36491 130575   2411]
 [ 32608 122614   3054]]
training model: results/universal/W4/deepVOL_L2/h50
Epoch 1/50
9854/9854 - 318s - loss: 2.9781 - accuracy50: 0.4920 - val_loss: 3.5600 - val_accuracy50: 0.4449 - 318s/epoch - 32ms/step
Epoch 2/50
9854/9854 - 314s - loss: 2.9232 - accuracy50: 0.5075 - val_loss: 3.5459 - val_accuracy50: 0.4508 - 314s/epoch - 32ms/step
Epoch 3/50
9854/9854 - 311s - loss: 2.9015 - accuracy50: 0.5142 - val_loss: 3.5803 - val_accuracy50: 0.4550 - 311s/epoch - 32ms/step
Epoch 4/50
9854/9854 - 319s - loss: 2.8847 - accuracy50: 0.5181 - val_loss: 3.5702 - val_accuracy50: 0.4614 - 319s/epoch - 32ms/step
Epoch 5/50
9854/9854 - 318s - loss: 2.8731 - accuracy50: 0.5205 - val_loss: 3.4615 - val_accuracy50: 0.4707 - 318s/epoch - 32ms/step
Epoch 6/50
9854/9854 - 318s - loss: 2.8645 - accuracy50: 0.5226 - val_loss: 3.5776 - val_accuracy50: 0.4681 - 318s/epoch - 32ms/step
Epoch 7/50
9854/9854 - 315s - loss: 2.8581 - accuracy50: 0.5237 - val_loss: 3.4967 - val_accuracy50: 0.4745 - 315s/epoch - 32ms/step
Epoch 8/50
9854/9854 - 313s - loss: 2.8532 - accuracy50: 0.5252 - val_loss: 3.5072 - val_accuracy50: 0.4727 - 313s/epoch - 32ms/step
Epoch 9/50
9854/9854 - 320s - loss: 2.8485 - accuracy50: 0.5263 - val_loss: 3.5121 - val_accuracy50: 0.4704 - 320s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 315s - loss: 2.8452 - accuracy50: 0.5271 - val_loss: 3.5266 - val_accuracy50: 0.4730 - 315s/epoch - 32ms/step
Epoch 11/50
9854/9854 - 312s - loss: 2.8422 - accuracy50: 0.5276 - val_loss: 3.4786 - val_accuracy50: 0.4760 - 312s/epoch - 32ms/step
Epoch 12/50
9854/9854 - 311s - loss: 2.8397 - accuracy50: 0.5283 - val_loss: 3.5041 - val_accuracy50: 0.4737 - 311s/epoch - 32ms/step
Epoch 13/50
9854/9854 - 313s - loss: 2.8372 - accuracy50: 0.5290 - val_loss: 3.5022 - val_accuracy50: 0.4747 - 313s/epoch - 32ms/step
Epoch 14/50
9854/9854 - 317s - loss: 2.8353 - accuracy50: 0.5296 - val_loss: 3.4659 - val_accuracy50: 0.4772 - 317s/epoch - 32ms/step
Epoch 15/50
9854/9854 - 311s - loss: 2.8331 - accuracy50: 0.5299 - val_loss: 3.4889 - val_accuracy50: 0.4766 - 311s/epoch - 32ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 363s - 363s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2088157
{'0': {'precision': 0.3695715190574423, 'recall': 0.5341126374828831, 'f1-score': 0.43686240895940237, 'support': 1599290}, '1': {'precision': 0.5505149636133286, 'recall': 0.5508398955441618, 'f1-score': 0.5506773816465285, 'support': 2866666}, '2': {'precision': 0.4419039290539215, 'recall': 0.24547557880642099, 'f1-score': 0.315623673737398, 'support': 1605675}, 'accuracy': 0.4656786619608471, 'macro avg': {'precision': 0.4539968039082308, 'recall': 0.4434760372778219, 'f1-score': 0.4343878214477763, 'support': 6071631}, 'weighted avg': {'precision': 0.4741310291548677, 'recall': 0.4656786619608471, 'f1-score': 0.45853689911131074, 'support': 6071631}}
[[ 854201  590031  155058]
 [ 944859 1579074  342733]
 [ 512268  699253  394154]]
Evaluating performance on  train set...
9854/9854 - 161s - 161s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1758035
{'0': {'precision': 0.4120830417541404, 'recall': 0.6052964685468846, 'f1-score': 0.4903429003559091, 'support': 773421}, '1': {'precision': 0.5226494583129765, 'recall': 0.5522442177630238, 'f1-score': 0.5370394257485802, 'support': 976309}, '2': {'precision': 0.503882925287551, 'recall': 0.23121137294458421, 'f1-score': 0.3169755587528103, 'support': 772289}, 'accuracy': 0.47020740129237726, 'macro avg': {'precision': 0.4795384751182226, 'recall': 0.4629173530848309, 'f1-score': 0.44811929495243324, 'support': 2522019}, 'weighted avg': {'precision': 0.48299568271294163, 'recall': 0.47020740129237726, 'f1-score': 0.4553314857433617, 'support': 2522019}}
[[468149 228139  77133]
 [338471 539161  98677]
 [329435 264292 178562]]
Evaluating performance on  val set...
3566/3566 - 55s - 55s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1706551
{'0': {'precision': 0.41015973230633246, 'recall': 0.5916038320037883, 'f1-score': 0.48444978038940795, 'support': 274530}, '1': {'precision': 0.5318676998355678, 'recall': 0.5485178894307161, 'f1-score': 0.540064493767086, 'support': 365020}, '2': {'precision': 0.4776531122704209, 'recall': 0.24500553515003556, 'f1-score': 0.3238808718490449, 'support': 272802}, 'accuracy': 0.4707294991406825, 'macro avg': {'precision': 0.47322684813744037, 'recall': 0.46170908552817996, 'f1-score': 0.44946504866851295, 'support': 912352}, 'weighted avg': {'precision': 0.4790346526753181, 'recall': 0.4707294991406825, 'f1-score': 0.45868884961870965, 'support': 912352}}
[[162413  82567  29550]
 [121258 200220  43542]
 [112304  93660  66838]]
testing model out of sample: results/universal/W4/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 182s - 182s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1204343
{'0': {'precision': 0.4528647875323374, 'recall': 0.5363337703239824, 'f1-score': 0.49107770531033634, 'support': 957305}, '1': {'precision': 0.49326333156911245, 'recall': 0.6383116826389678, 'f1-score': 0.5564911617959882, 'support': 1144690}, '2': {'precision': 0.4965494230635362, 'recall': 0.22251564303439908, 'f1-score': 0.3073157614815739, 'support': 929647}, 'accuracy': 0.4786069727230326, 'macro avg': {'precision': 0.48089251405499533, 'recall': 0.46572036533244976, 'f1-score': 0.45162820952929944, 'support': 3031642}, 'weighted avg': {'precision': 0.48151431136830763, 'recall': 0.4786069727230326, 'f1-score': 0.45942633938717764, 'support': 3031642}}
[[513435 348401  95469]
 [299754 730669 114267]
 [320560 402226 206861]]
Evaluating performance on  train set...
5528/5528 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0146255
{'0': {'precision': 0.4467665963447677, 'recall': 0.5447736893520027, 'f1-score': 0.49092647163386716, 'support': 399230}, '1': {'precision': 0.5780519483983155, 'recall': 0.7065700188590365, 'f1-score': 0.6358822852037961, 'support': 613499}, '2': {'precision': 0.5295656429845238, 'recall': 0.23431864288647988, 'f1-score': 0.3248845540576919, 'support': 401735}, 'accuracy': 0.5267748065698384, 'macro avg': {'precision': 0.518128062575869, 'recall': 0.49522078369917294, 'f1-score': 0.4838977702984517, 'support': 1414464}, 'weighted avg': {'precision': 0.5272258425336576, 'recall': 0.5267748065698384, 'f1-score': 0.5066394179597355, 'support': 1414464}}
[[217490 143267  38473]
 [134869 433480  45150]
 [134450 173151  94134]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0398276
{'0': {'precision': 0.45049091288907456, 'recall': 0.5422163864812577, 'f1-score': 0.49211596426115095, 'support': 143179}, '1': {'precision': 0.5551235520923428, 'recall': 0.6773816510413327, 'f1-score': 0.6101889181354747, 'support': 202769}, '2': {'precision': 0.5099249915265477, 'recall': 0.2442524476067453, 'f1-score': 0.3302947577412088, 'support': 141669}, 'accuracy': 0.511854590795645, 'macro avg': {'precision': 0.5051798188359884, 'recall': 0.48795016170977856, 'f1-score': 0.4775332133792782, 'support': 487617}, 'weighted avg': {'precision': 0.5112685767217541, 'recall': 0.511854590795645, 'f1-score': 0.49420056401396734, 'support': 487617}}
[[ 77634  50293  15252]
 [ 47413 137352  18004]
 [ 47285  59781  34603]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2992625
{'0': {'precision': 0.40031295460935684, 'recall': 0.6532998164551911, 'f1-score': 0.4964335796854273, 'support': 50124}, '1': {'precision': 0.32574527505358186, 'recall': 0.27108612815177147, 'f1-score': 0.2959127985014086, 'support': 37003}, '2': {'precision': 0.4368011970572343, 'recall': 0.2121872917802411, 'f1-score': 0.28562498301307315, 'support': 49527}, 'accuracy': 0.38993370117230375, 'macro avg': {'precision': 0.3876198089067244, 'recall': 0.3788577454624012, 'f1-score': 0.3593237870666363, 'support': 136654}, 'weighted avg': {'precision': 0.39334590891083127, 'recall': 0.38993370117230375, 'f1-score': 0.3657342380375873, 'support': 136654}}
[[32746 10089  7289]
 [20711 10031  6261]
 [28344 10674 10509]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3563795
{'0': {'precision': 0.35049450433088375, 'recall': 0.775502553769739, 'f1-score': 0.48278879813302217, 'support': 21341}, '1': {'precision': 0.41468521010916704, 'recall': 0.1269979390886192, 'f1-score': 0.19444639225860738, 'support': 21835}, '2': {'precision': 0.3989120580235721, 'recall': 0.20220588235294118, 'f1-score': 0.26837450442207994, 'support': 21760}, 'accuracy': 0.3653289392632746, 'macro avg': {'precision': 0.3880305908212076, 'recall': 0.3682354584037664, 'f1-score': 0.31520323160456987, 'support': 64936}, 'weighted avg': {'precision': 0.3883035783271527, 'recall': 0.3653289392632746, 'f1-score': 0.3139824124083402, 'support': 64936}}
[[16550  1840  2951]
 [15383  2773  3679]
 [15286  2074  4400]]
Evaluating performance on  val set...
81/81 - 1s - 824ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3343737
{'0': {'precision': 0.3705693507174212, 'recall': 0.776816371377558, 'f1-score': 0.5017743080198722, 'support': 7281}, '1': {'precision': 0.36099754701553555, 'recall': 0.14388137526478736, 'f1-score': 0.20575556332284747, 'support': 6137}, '2': {'precision': 0.40543328748280605, 'recall': 0.16377274621475205, 'f1-score': 0.23330365093499555, 'support': 7199}, 'accuracy': 0.37435126352039577, 'macro avg': {'precision': 0.3790000617385876, 'recall': 0.36149016428569913, 'f1-score': 0.3136111740925718, 'support': 20617}, 'weighted avg': {'precision': 0.37989385580814894, 'recall': 0.37435126352039577, 'f1-score': 0.31991529378115324, 'support': 20617}}
[[5656  735  890]
 [4415  883  839]
 [5192  828 1179]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.72096765
{'0': {'precision': 0.5394646533973919, 'recall': 0.4169935918019741, 'f1-score': 0.47038813162930243, 'support': 71627}, '1': {'precision': 0.7358597877658539, 'recall': 0.9155084316529615, 'f1-score': 0.8159123232383579, 'support': 268512}, '2': {'precision': 0.6862242719275771, 'recall': 0.22101499106037684, 'f1-score': 0.33434587217043943, 'support': 72710}, 'accuracy': 0.7067063260417247, 'macro avg': {'precision': 0.6538495710302743, 'recall': 0.5178390048384375, 'f1-score': 0.5402154423460334, 'support': 412849}, 'weighted avg': {'precision': 0.6930446358676758, 'recall': 0.7067063260417247, 'f1-score': 0.6711534454657822, 'support': 412849}}
[[ 29868  37594   4165]
 [ 19504 245825   3183]
 [  5994  50646  16070]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7975962
{'0': {'precision': 0.5721983833948707, 'recall': 0.3527855538807026, 'f1-score': 0.4364688195779177, 'support': 32507}, '1': {'precision': 0.68994591766869, 'recall': 0.9253022987082663, 'f1-score': 0.7904773237084144, 'support': 96924}, '2': {'precision': 0.6264703463025417, 'recall': 0.2325141199816822, 'f1-score': 0.3391521197007482, 'support': 32755}, 'accuracy': 0.6706374162998039, 'macro avg': {'precision': 0.6295382157887008, 'recall': 0.5035339908568838, 'f1-score': 0.5220327543290267, 'support': 162186}, 'weighted avg': {'precision': 0.6535262425010601, 'recall': 0.6706374162998039, 'f1-score': 0.6283738653270426, 'support': 162186}}
[[11468 18571  2468]
 [ 5167 89684  2073]
 [ 3407 21732  7616]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7138988
{'0': {'precision': 0.568220742150333, 'recall': 0.3493214787084698, 'f1-score': 0.43265956676084905, 'support': 8548}, '1': {'precision': 0.749509602664112, 'recall': 0.931590735123182, 'f1-score': 0.8306895026227644, 'support': 35273}, '2': {'precision': 0.611065235342692, 'recall': 0.24918621618587944, 'f1-score': 0.35401052463721894, 'support': 8909}, 'accuracy': 0.7219040394462355, 'macro avg': {'precision': 0.642931860052379, 'recall': 0.5100328100058437, 'f1-score': 0.5391198646736107, 'support': 52730}, 'weighted avg': {'precision': 0.6967301972376315, 'recall': 0.7219040394462355, 'f1-score': 0.6856280024023799, 'support': 52730}}
[[ 2986  4960   602]
 [ 1602 32860   811]
 [  667  6022  2220]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.557385
{'0': {'precision': 0.31706547516055816, 'recall': 0.4385629012276157, 'f1-score': 0.3680464074951413, 'support': 71032}, '1': {'precision': 0.44581265425773625, 'recall': 0.43196809061712194, 'f1-score': 0.43878119258612897, 'support': 115828}, '2': {'precision': 0.3189210817426507, 'recall': 0.2049645282790543, 'f1-score': 0.2495487863273049, 'support': 66109}, 'accuracy': 0.374496479805826, 'macro avg': {'precision': 0.3605997370536484, 'recall': 0.35849850670793065, 'f1-score': 0.3521254621361917, 'support': 252969}, 'weighted avg': {'precision': 0.37650042788600474, 'recall': 0.374496479805826, 'f1-score': 0.3694667769860055, 'support': 252969}}
[[31152 31966  7914]
 [44771 50034 21023]
 [22328 30231 13550]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4137629
{'0': {'precision': 0.38434945798454206, 'recall': 0.5407893822527969, 'f1-score': 0.44934251360441113, 'support': 28782}, '1': {'precision': 0.3776428391643594, 'recall': 0.4199349263548263, 'f1-score': 0.39766759984759886, 'support': 28583}, '2': {'precision': 0.41259378725194584, 'recall': 0.20166569558213662, 'f1-score': 0.27091486716699664, 'support': 29177}, 'accuracy': 0.38654063922719606, 'macro avg': {'precision': 0.39152869480028246, 'recall': 0.38746333472991995, 'f1-score': 0.3726416602063356, 'support': 86542}, 'weighted avg': {'precision': 0.3916567713040604, 'recall': 0.38654063922719606, 'f1-score': 0.3721198067104705, 'support': 86542}}
[[15565  9417  3800]
 [12003 12003  4577]
 [12929 10364  5884]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4768449
{'0': {'precision': 0.3720914903434184, 'recall': 0.5417986371052884, 'f1-score': 0.44118796404845645, 'support': 10419}, '1': {'precision': 0.33065026679931264, 'recall': 0.35416061222512835, 'f1-score': 0.3420018709073901, 'support': 10323}, '2': {'precision': 0.41195324283559576, 'recall': 0.20250231696014828, 'f1-score': 0.27152976264446377, 'support': 10790}, 'accuracy': 0.3642648737790181, 'macro avg': {'precision': 0.37156499999277565, 'recall': 0.36615385543018836, 'f1-score': 0.35157319920010344, 'support': 31532}, 'weighted avg': {'precision': 0.37216476697492884, 'recall': 0.3642648737790181, 'f1-score': 0.3506605622774204, 'support': 31532}}
[[5645 3476 1298]
 [4846 3656 1821]
 [4680 3925 2185]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.6772684
{'0': {'precision': 0.3112685816474796, 'recall': 0.9480385081496208, 'f1-score': 0.4686618604306764, 'support': 73439}, '1': {'precision': 0.37592520451889366, 'recall': 0.020327558059929432, 'f1-score': 0.03856953007124372, 'support': 94945}, '2': {'precision': 0.2352568167406468, 'recall': 0.02715561411213585, 'f1-score': 0.048690858980248046, 'support': 68310}, 'accuracy': 0.31013882903664647, 'macro avg': {'precision': 0.30748353430234004, 'recall': 0.3318405601072287, 'f1-score': 0.18530741649405605, 'support': 236694}, 'weighted avg': {'precision': 0.31526724404593776, 'recall': 0.31013882903664647, 'f1-score': 0.17493521161382808, 'support': 236694}}
[[69623  1606  2210]
 [89195  1930  3820]
 [64857  1598  1855]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5490283
{'0': {'precision': 0.34127888154818287, 'recall': 0.9393419359097059, 'f1-score': 0.5006596190040632, 'support': 30301}, '1': {'precision': 0.2874062376628504, 'recall': 0.02512337371018394, 'f1-score': 0.04620755315772771, 'support': 28977}, '2': {'precision': 0.32435508345978753, 'recall': 0.029188857025809093, 'f1-score': 0.053558005512402904, 'support': 29292}, 'accuracy': 0.33923450378231906, 'macro avg': {'precision': 0.3176800675569402, 'recall': 0.3312180555485663, 'f1-score': 0.20014172589139792, 'support': 88570}, 'weighted avg': {'precision': 0.3180565772073163, 'recall': 0.33923450378231906, 'f1-score': 0.2041127298268364, 'support': 88570}}
[[28463   901   937]
 [27405   728   844]
 [27533   904   855]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5538664
{'0': {'precision': 0.33838818621283356, 'recall': 0.9326519437853623, 'f1-score': 0.49659863945578225, 'support': 10958}, '1': {'precision': 0.28421052631578947, 'recall': 0.03078092342770283, 'f1-score': 0.05554603120178296, 'support': 10526}, '2': {'precision': 0.341227125941873, 'recall': 0.02938722536386391, 'f1-score': 0.05411403209286446, 'support': 10787}, 'accuracy': 0.33655604102754794, 'macro avg': {'precision': 0.3212752794901653, 'recall': 0.33094003085897633, 'f1-score': 0.20208623425014324, 'support': 32271}, 'weighted avg': {'precision': 0.32166572935623977, 'recall': 0.33655604102754794, 'f1-score': 0.2048320002408403, 'support': 32271}}
[[10220   400   338]
 [ 9928   324   274]
 [10054   416   317]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
1590/1590 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5232202
{'0': {'precision': 0.34218879081699205, 'recall': 0.5904911172061925, 'f1-score': 0.43328786145554865, 'support': 119951}, '1': {'precision': 0.42851482323852697, 'recall': 0.3193953856513367, 'f1-score': 0.36599488975751726, 'support': 169298}, '2': {'precision': 0.36467209450397603, 'recall': 0.2286192312265385, 'f1-score': 0.2810459222292405, 'support': 117746}, 'accuracy': 0.3730316097249352, 'macro avg': {'precision': 0.3784585695198317, 'recall': 0.37950191136135586, 'f1-score': 0.3601095578141022, 'support': 406995}, 'weighted avg': {'precision': 0.3846024413847598, 'recall': 0.3730316097249352, 'f1-score': 0.36125148533624934, 'support': 406995}}
[[70830 33933 15188]
 [83515 54073 31710]
 [52646 38181 26919]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4483043
{'0': {'precision': 0.3739498987854251, 'recall': 0.6436208435860027, 'f1-score': 0.47305202339892616, 'support': 45923}, '1': {'precision': 0.35829658056016955, 'recall': 0.2753604049741389, 'f1-score': 0.3114009433375232, 'support': 45435}, '2': {'precision': 0.4243178271688246, 'recall': 0.21724860184405434, 'f1-score': 0.2873668275684785, 'support': 46311}, 'accuracy': 0.378654599074592, 'macro avg': {'precision': 0.38552143550480644, 'recall': 0.3787432834680653, 'f1-score': 0.3572732647683093, 'support': 137669}, 'weighted avg': {'precision': 0.3857272823488935, 'recall': 0.378654599074592, 'f1-score': 0.35723884885205137, 'support': 137669}}
[[29557 10643  5723]
 [24997 12511  7927]
 [24486 11764 10061]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4784204
{'0': {'precision': 0.3652626953737995, 'recall': 0.6663612940166046, 'f1-score': 0.4718713888945203, 'support': 17465}, '1': {'precision': 0.3578346416556224, 'recall': 0.18806258036862408, 'f1-score': 0.24654936255399854, 'support': 18664}, '2': {'precision': 0.39903561458421455, 'recall': 0.2716696423429131, 'f1-score': 0.32325932017543857, 'support': 17363}, 'accuracy': 0.3713639422717416, 'macro avg': {'precision': 0.3740443172045455, 'recall': 0.3753645055760473, 'f1-score': 0.3472266905413191, 'support': 53492}, 'weighted avg': {'precision': 0.3736333302660148, 'recall': 0.3713639422717416, 'f1-score': 0.34501575349504165, 'support': 53492}}
[[11638  3054  2773]
 [10823  3510  4331]
 [ 9401  3245  4717]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83070123
{'0': {'precision': 0.551274495780289, 'recall': 0.4332882127294068, 'f1-score': 0.485211838586702, 'support': 222367}, '1': {'precision': 0.6335817929534155, 'recall': 0.8945533159935183, 'f1-score': 0.7417834856633457, 'support': 507887}, '2': {'precision': 0.7088130158229512, 'recall': 0.2269055692517396, 'f1-score': 0.34376493833455496, 'support': 237698}, 'accuracy': 0.6246342793857547, 'macro avg': {'precision': 0.6312231015188852, 'recall': 0.5182490326582215, 'f1-score': 0.5235867541948676, 'support': 967952}, 'weighted avg': {'precision': 0.6331477677777314, 'recall': 0.6246342793857547, 'f1-score': 0.58510084013087, 'support': 967952}}
[[ 96349 112914  13104]
 [ 44502 454332   9053]
 [ 33924 149839  53935]]
Evaluating performance on  train set...
1601/1601 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8994197
{'0': {'precision': 0.5819992087564289, 'recall': 0.396797424993032, 'f1-score': 0.4718769546599092, 'support': 111223}, '1': {'precision': 0.5594082927351571, 'recall': 0.892516055327486, 'f1-score': 0.6877505476310458, 'support': 187321}, '2': {'precision': 0.6813566090478635, 'recall': 0.21479569815121213, 'f1-score': 0.326624095825414, 'support': 111208}, 'accuracy': 0.574022823561569, 'macro avg': {'precision': 0.6075880368464832, 'recall': 0.5013697261572433, 'f1-score': 0.49541719937212303, 'support': 409752}, 'weighted avg': {'precision': 0.5986375285000524, 'recall': 0.574022823561569, 'f1-score': 0.5311429921256928, 'support': 409752}}
[[ 44133  60435   6655]
 [ 15618 167187   4516]
 [ 16079  71242  23887]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8484908
{'0': {'precision': 0.5722659521018255, 'recall': 0.4046899982234855, 'f1-score': 0.47410593499601095, 'support': 33774}, '1': {'precision': 0.6060018222966816, 'recall': 0.8948784722222223, 'f1-score': 0.7226398892452202, 'support': 69120}, '2': {'precision': 0.7062224399804018, 'recall': 0.21666065416065416, 'f1-score': 0.331592629230026, 'support': 33264}, 'accuracy': 0.607595587479252, 'macro avg': {'precision': 0.6281634047929696, 'recall': 0.5054097082021206, 'f1-score': 0.5094461511570857, 'support': 136158}, 'weighted avg': {'precision': 0.6221179766663859, 'recall': 0.607595587479252, 'f1-score': 0.5654564565570328, 'support': 136158}}
[[13668 18438  1668]
 [ 5936 61854  1330]
 [ 4280 21777  7207]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93262005
{'0': {'precision': 0.5323374687034067, 'recall': 0.4702271866011468, 'f1-score': 0.49935841824533156, 'support': 321938}, '1': {'precision': 0.5682118652510724, 'recall': 0.8283393880871492, 'f1-score': 0.6740494022555461, 'support': 509517}, '2': {'precision': 0.5794972278115088, 'recall': 0.2130893300248139, 'f1-score': 0.3115992185451427, 'support': 309504}, 'accuracy': 0.5603961229106392, 'macro avg': {'precision': 0.5600155205886627, 'recall': 0.5038853015710366, 'f1-score': 0.4950023463486734, 'support': 1140959}, 'weighted avg': {'precision': 0.5611507292927627, 'recall': 0.5603961229106392, 'f1-score': 0.5264372201618993, 'support': 1140959}}
[[151384 145735  24819]
 [ 64426 422053  23038]
 [ 68566 174986  65952]]
Evaluating performance on  train set...
2425/2425 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8573806
{'0': {'precision': 0.4840808767568116, 'recall': 0.5134127966420923, 'f1-score': 0.4983155750548417, 'support': 148664}, '1': {'precision': 0.648048402928006, 'recall': 0.8213424766903193, 'f1-score': 0.7244766353992228, 'support': 323149}, '2': {'precision': 0.6034241070594172, 'recall': 0.21678842899734094, 'f1-score': 0.31897918755897187, 'support': 148924}, 'accuracy': 0.6025530941445411, 'macro avg': {'precision': 0.5785177955814116, 'recall': 0.5171812341099176, 'f1-score': 0.5139237993376787, 'support': 620737}, 'weighted avg': {'precision': 0.5980728143153599, 'recall': 0.6025530941445411, 'f1-score': 0.5730271329574501, 'support': 620737}}
[[ 76326  62923   9415]
 [ 45930 265416  11803]
 [ 35416  81223  32285]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8610908
{'0': {'precision': 0.5139872784904376, 'recall': 0.4836165655837787, 'f1-score': 0.4983396241981725, 'support': 49959}, '1': {'precision': 0.6285439550279226, 'recall': 0.8342758404021363, 'f1-score': 0.7169427675900967, 'support': 101856}, '2': {'precision': 0.592534174553102, 'recall': 0.22810532920436374, 'f1-score': 0.32940213658351236, 'support': 49407}, 'accuracy': 0.5983789048911153, 'macro avg': {'precision': 0.5783551360238207, 'recall': 0.5153325783967596, 'f1-score': 0.5148948427905938, 'support': 201222}, 'weighted avg': {'precision': 0.5912603964356431, 'recall': 0.5983789048911153, 'f1-score': 0.5675137071649968, 'support': 201222}}
[[24161 22293  3505]
 [12635 84976  4245]
 [10211 27926 11270]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9753974
{'0': {'precision': 0.5419314607775321, 'recall': 0.4493249065548621, 'f1-score': 0.4913023734279862, 'support': 353951}, '1': {'precision': 0.5172766621331732, 'recall': 0.8363745812824019, 'f1-score': 0.6392149437356522, 'support': 488396}, '2': {'precision': 0.617063701205158, 'recall': 0.19808426525904999, 'f1-score': 0.2998979692029218, 'support': 354642}, 'accuracy': 0.5328119138939456, 'macro avg': {'precision': 0.5587572747052878, 'recall': 0.494594584365438, 'f1-score': 0.4768050954555201, 'support': 1196989}, 'weighted avg': {'precision': 0.5541318594203131, 'recall': 0.5328119138939456, 'f1-score': 0.4949447351913754, 'support': 1196989}}
[[159039 169524  25388]
 [ 61707 408482  18207]
 [ 72721 211672  70249]]
Evaluating performance on  train set...
2108/2108 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94940823
{'0': {'precision': 0.5419433467518558, 'recall': 0.4611077244075189, 'f1-score': 0.4982682747942303, 'support': 159119}, '1': {'precision': 0.5340822382365409, 'recall': 0.8487261361033642, 'f1-score': 0.6556071872739667, 'support': 222669}, '2': {'precision': 0.6441583290150277, 'recall': 0.2050488196369773, 'f1-score': 0.31107581991866984, 'support': 157621}, 'accuracy': 0.5462941849320274, 'macro avg': {'precision': 0.5733946380011415, 'recall': 0.5049608933826202, 'f1-score': 0.4883170939956223, 'support': 539409}, 'weighted avg': {'precision': 0.5685665631744716, 'recall': 0.5462941849320274, 'f1-score': 0.5085184492870729, 'support': 539409}}
[[ 73371  74848  10900]
 [ 26730 188985   6954]
 [ 35284  90017  32320]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9878932
{'0': {'precision': 0.5226285695122156, 'recall': 0.49125240361882544, 'f1-score': 0.5064549937846818, 'support': 63446}, '1': {'precision': 0.5043019147343598, 'recall': 0.8138670961708319, 'f1-score': 0.6227346137600318, 'support': 76988}, '2': {'precision': 0.6408488847309075, 'recall': 0.2041280446682037, 'f1-score': 0.309630299281534, 'support': 63759}, 'accuracy': 0.5232353704583409, 'macro avg': {'precision': 0.5559264563258276, 'recall': 0.503082514819287, 'f1-score': 0.4796066356087492, 'support': 204193}, 'weighted avg': {'precision': 0.5526329113848116, 'recall': 0.5232353704583409, 'f1-score': 0.4888382766877982, 'support': 204193}}
[[31168 27679  4599]
 [11635 62658  2695]
 [16834 33910 13015]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
4274/4274 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0434724
{'0': {'precision': 0.49159437824757746, 'recall': 0.57711155075331, 'f1-score': 0.5309314494723517, 'support': 394260}, '1': {'precision': 0.4147424454724019, 'recall': 0.6212193813010312, 'f1-score': 0.4974045157206161, 'support': 313044}, '2': {'precision': 0.5525075618034978, 'recall': 0.23189514971778435, 'f1-score': 0.32667868655411675, 'support': 386761}, 'accuracy': 0.46769524662611456, 'macro avg': {'precision': 0.48628146184115906, 'recall': 0.4767420272573752, 'f1-score': 0.45167155058236147, 'support': 1094065}, 'weighted avg': {'precision': 0.49113810493803844, 'recall': 0.46769524662611456, 'f1-score': 0.4491333768821512, 'support': 1094065}}
[[227532 126380  40348]
 [ 86282 194469  32293]
 [149031 148042  89688]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9773808
{'0': {'precision': 0.48837466784765277, 'recall': 0.5138363965829666, 'f1-score': 0.5007820975351313, 'support': 154520}, '1': {'precision': 0.5267421619092185, 'recall': 0.7234353229098649, 'f1-score': 0.6096156595656186, 'support': 194497}, '2': {'precision': 0.551503091654536, 'recall': 0.26546158148145765, 'f1-score': 0.35840688763333073, 'support': 155563}, 'accuracy': 0.5180546196836974, 'macro avg': {'precision': 0.5222066404704692, 'recall': 0.500911100324763, 'f1-score': 0.4896015482446936, 'support': 504580}, 'weighted avg': {'precision': 0.5226265396720662, 'recall': 0.5180546196836974, 'f1-score': 0.4988388705667415, 'support': 504580}}
[[ 79398  58523  16599]
 [ 36807 140706  16984]
 [ 46371  67896  41296]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9988203
{'0': {'precision': 0.48745707745135447, 'recall': 0.5281715614503488, 'f1-score': 0.5069982390727437, 'support': 58055}, '1': {'precision': 0.49882611967962615, 'recall': 0.6749760598276308, 'f1-score': 0.573683870550998, 'support': 65789}, '2': {'precision': 0.5329008984009157, 'recall': 0.2699525566684238, 'f1-score': 0.3583666709432113, 'support': 56910}, 'accuracy': 0.5003042809564381, 'macro avg': {'precision': 0.5063946985106321, 'recall': 0.49103339264880114, 'f1-score': 0.479682926855651, 'support': 180754}, 'weighted avg': {'precision': 0.5059029528919826, 'recall': 0.5003042809564381, 'f1-score': 0.4844734731869053, 'support': 180754}}
[[30663 20686  6706]
 [14623 44406  6760]
 [17618 23929 15363]]
testing model on single stock: results/universal/W4/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
12724/12724 - 91s - 91s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4345803
{'0': {'precision': 0.31916493782567656, 'recall': 0.5684754404230066, 'f1-score': 0.40880841621019887, 'support': 877906}, '1': {'precision': 0.45826739461705335, 'recall': 0.31092369499232214, 'f1-score': 0.3704832090584896, 'support': 1506926}, '2': {'precision': 0.3759427179185325, 'recall': 0.2892097464791962, 'f1-score': 0.3269214321813163, 'support': 872315}, 'accuracy': 0.3745268481895352, 'macro avg': {'precision': 0.3844583501204208, 'recall': 0.38953629396484163, 'f1-score': 0.3687376858166682, 'support': 3257147}, 'weighted avg': {'precision': 0.39872696497535753, 'recall': 0.3745268481895352, 'f1-score': 0.3691465601179036, 'support': 3257147}}
[[499068 268561 110277]
 [729881 468539 308506]
 [334719 285314 252282]]
Evaluating performance on  train set...
5165/5165 - 51s - 51s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3757757
{'0': {'precision': 0.37785057909090575, 'recall': 0.7052179225976728, 'f1-score': 0.49205936655599486, 'support': 440271}, '1': {'precision': 0.3744271273483716, 'recall': 0.20924894077898723, 'f1-score': 0.268465623570744, 'support': 440418}, '2': {'precision': 0.44751922282747636, 'recall': 0.2577721997313174, 'f1-score': 0.32712155798455583, 'support': 441413}, 'accuracy': 0.39061131440690655, 'macro avg': {'precision': 0.39993230975558464, 'recall': 0.39074635436932575, 'f1-score': 0.3625488493704316, 'support': 1322102}, 'weighted avg': {'precision': 0.39997057835582445, 'recall': 0.39061131440690655, 'f1-score': 0.3625077873336483, 'support': 1322102}}
[[310487  73652  56132]
 [263922  92157  84339]
 [247310  80319 113784]]
Evaluating performance on  val set...
1903/1903 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.360835
{'0': {'precision': 0.3767966849313091, 'recall': 0.6614978074066563, 'f1-score': 0.4801146163434075, 'support': 157804}, '1': {'precision': 0.4044415240598425, 'recall': 0.24533108432064604, 'f1-score': 0.3054055414530314, 'support': 173113}, '2': {'precision': 0.4198355454346231, 'recall': 0.282304927506519, 'f1-score': 0.3376009439311053, 'support': 156083}, 'accuracy': 0.39203285420944556, 'macro avg': {'precision': 0.40035791814192495, 'recall': 0.39637793974460717, 'f1-score': 0.37437370057584807, 'support': 487000}, 'weighted avg': {'precision': 0.40041745597852996, 'recall': 0.39203285420944556, 'f1-score': 0.37233561508544644, 'support': 487000}}
[[104387  30957  22460]
 [ 92213  42470  38430]
 [ 80438  31582  44063]]
training model: results/universal/W4/deepVOL_L2/h100
Epoch 1/50
9854/9854 - 315s - loss: 3.1580 - accuracy100: 0.4313 - val_loss: 3.5240 - val_accuracy100: 0.4000 - 315s/epoch - 32ms/step
Epoch 2/50
9854/9854 - 314s - loss: 3.1241 - accuracy100: 0.4415 - val_loss: 3.5425 - val_accuracy100: 0.4061 - 314s/epoch - 32ms/step
Epoch 3/50
9854/9854 - 318s - loss: 3.1145 - accuracy100: 0.4452 - val_loss: 3.5202 - val_accuracy100: 0.4047 - 318s/epoch - 32ms/step
Epoch 4/50
9854/9854 - 314s - loss: 3.1049 - accuracy100: 0.4492 - val_loss: 3.4674 - val_accuracy100: 0.4062 - 314s/epoch - 32ms/step
Epoch 5/50
9854/9854 - 310s - loss: 3.0974 - accuracy100: 0.4521 - val_loss: 3.5372 - val_accuracy100: 0.4056 - 310s/epoch - 32ms/step
Epoch 6/50
9854/9854 - 312s - loss: 3.0909 - accuracy100: 0.4546 - val_loss: 3.4848 - val_accuracy100: 0.4085 - 312s/epoch - 32ms/step
Epoch 7/50
9854/9854 - 316s - loss: 3.0852 - accuracy100: 0.4564 - val_loss: 3.5705 - val_accuracy100: 0.4078 - 316s/epoch - 32ms/step
Epoch 8/50
9854/9854 - 316s - loss: 3.0815 - accuracy100: 0.4578 - val_loss: 3.5549 - val_accuracy100: 0.4107 - 316s/epoch - 32ms/step
Epoch 9/50
9854/9854 - 312s - loss: 3.0776 - accuracy100: 0.4590 - val_loss: 3.5798 - val_accuracy100: 0.4116 - 312s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 316s - loss: 3.0746 - accuracy100: 0.4604 - val_loss: 3.5573 - val_accuracy100: 0.4135 - 316s/epoch - 32ms/step
Epoch 11/50
9854/9854 - 318s - loss: 3.0719 - accuracy100: 0.4611 - val_loss: 3.5677 - val_accuracy100: 0.4142 - 318s/epoch - 32ms/step
Epoch 12/50
9854/9854 - 313s - loss: 3.0693 - accuracy100: 0.4621 - val_loss: 3.5510 - val_accuracy100: 0.4149 - 313s/epoch - 32ms/step
Epoch 13/50
9854/9854 - 312s - loss: 3.0673 - accuracy100: 0.4626 - val_loss: 3.5633 - val_accuracy100: 0.4172 - 312s/epoch - 32ms/step
Epoch 14/50
9854/9854 - 312s - loss: 3.0655 - accuracy100: 0.4634 - val_loss: 3.5321 - val_accuracy100: 0.4187 - 312s/epoch - 32ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 374s - 374s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1691351
{'0': {'precision': 0.37226233753299137, 'recall': 0.4562475239943672, 'f1-score': 0.40999818508539077, 'support': 1802298}, '1': {'precision': 0.4332249084037735, 'recall': 0.5421009882225531, 'f1-score': 0.4815860048024309, 'support': 2437710}, '2': {'precision': 0.38380087077797626, 'recall': 0.17022662414699968, 'f1-score': 0.2358479576399395, 'support': 1831623}, 'accuracy': 0.4044333392460774, 'macro avg': {'precision': 0.39642937223824704, 'recall': 0.38952504545464, 'f1-score': 0.375810715842587, 'support': 6071631}, 'weighted avg': {'precision': 0.4002191273173497, 'recall': 0.4044333392460774, 'f1-score': 0.3862043777802541, 'support': 6071631}}
[[ 822294  778694  201310]
 [ 816949 1321485  299276]
 [ 569667  950165  311791]]
Evaluating performance on  train set...
9854/9854 - 158s - 158s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1662539
{'0': {'precision': 0.39514893866385387, 'recall': 0.5322595112546807, 'f1-score': 0.4535688260862919, 'support': 836141}, '1': {'precision': 0.40156157557162303, 'recall': 0.5012598332746272, 'f1-score': 0.44590588226692646, 'support': 851700}, '2': {'precision': 0.4281328831334394, 'recall': 0.1706997787043053, 'f1-score': 0.24408217208003974, 'support': 834178}, 'accuracy': 0.4022019659645705, 'macro avg': {'precision': 0.40828113245630543, 'recall': 0.4014063744112044, 'f1-score': 0.38118562681108603, 'support': 2522019}, 'weighted avg': {'precision': 0.4082242262346838, 'recall': 0.4022019659645705, 'f1-score': 0.3816916168675743, 'support': 2522019}}
[[445044 292408  98689]
 [333267 426923  91510]
 [347958 343826 142394]]
Evaluating performance on  val set...
3566/3566 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1563324
{'0': {'precision': 0.3986447970161804, 'recall': 0.5176686138428147, 'f1-score': 0.4504264524374019, 'support': 298552}, '1': {'precision': 0.4114207306908093, 'recall': 0.5064867817416591, 'f1-score': 0.4540308451712788, 'support': 316721}, '2': {'precision': 0.41115052390988155, 'recall': 0.18649921401378083, 'f1-score': 0.25660263758148366, 'support': 297079}, 'accuracy': 0.405951869453895, 'macro avg': {'precision': 0.40707201720562375, 'recall': 0.40355153653275155, 'f1-score': 0.3870199783967214, 'support': 912352}, 'weighted avg': {'precision': 0.40715203471524386, 'recall': 0.405951869453895, 'f1-score': 0.38856502370976703, 'support': 912352}}
[[154551 105385  38616]
 [115571 160415  40735]
 [117569 124105  55405]]
testing model out of sample: results/universal/W4/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 193s - 193s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1385249
{'0': {'precision': 0.4382056693778098, 'recall': 0.48198893630353257, 'f1-score': 0.4590556892239136, 'support': 1059682}, '1': {'precision': 0.3727186155841626, 'recall': 0.6186133580093279, 'f1-score': 0.46516953053237153, 'support': 940185}, '2': {'precision': 0.451293410900905, 'recall': 0.13367933900317414, 'f1-score': 0.20626124849615038, 'support': 1031775}, 'accuracy': 0.40581737553444636, 'macro avg': {'precision': 0.42073923195429247, 'recall': 0.4114272111053449, 'f1-score': 0.37682882275081186, 'support': 3031642}, 'weighted avg': {'precision': 0.4223507824350281, 'recall': 0.40581737553444636, 'f1-score': 0.3749168488887766, 'support': 3031642}}
[[510755 453893  95034]
 [285909 581611  72665]
 [368896 524952 137927]]
Evaluating performance on  train set...
5528/5528 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0871162
{'0': {'precision': 0.43202475882451347, 'recall': 0.4812869817562216, 'f1-score': 0.4553273170153213, 'support': 450729}, '1': {'precision': 0.4405981542232037, 'recall': 0.6812608800344214, 'f1-score': 0.5351158695018573, 'support': 506662}, '2': {'precision': 0.48832699914682387, 'recall': 0.13774604931816142, 'f1-score': 0.21487944600966208, 'support': 457073}, 'accuracy': 0.4419052022532917, 'macro avg': {'precision': 0.45364997073151364, 'recall': 0.43343130370293487, 'f1-score': 0.4017742108422802, 'support': 1414464}, 'weighted avg': {'precision': 0.4532893845416265, 'recall': 0.4419052022532917, 'f1-score': 0.4062087801248551, 'support': 1414464}}
[[216930 196247  37552]
 [133075 345169  28418]
 [152119 241994  62960]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011301
{'0': {'precision': 0.43540863344591707, 'recall': 0.47440440359685, 'f1-score': 0.45407081380637576, 'support': 161141}, '1': {'precision': 0.4170219348218126, 'recall': 0.6584481033168128, 'f1-score': 0.5106368235049547, 'support': 167872}, '2': {'precision': 0.47131060315838763, 'recall': 0.13962447353156288, 'f1-score': 0.21542876599056374, 'support': 158604}, 'accuracy': 0.4288734806210612, 'macro avg': {'precision': 0.4412470571420391, 'recall': 0.42415899348174185, 'f1-score': 0.3933788011006314, 'support': 487617}, 'weighted avg': {'precision': 0.4407562405491375, 'recall': 0.4288734806210612, 'f1-score': 0.395923263225368, 'support': 487617}}
[[ 76446  70477  14218]
 [ 46714 110535  10623]
 [ 52413  84046  22145]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2044424
{'0': {'precision': 0.4036816799724398, 'recall': 0.5235135292632234, 'f1-score': 0.4558539968201346, 'support': 51481}, '1': {'precision': 0.26449314092285764, 'recall': 0.2237191078963231, 'f1-score': 0.2424034615070618, 'support': 33180}, '2': {'precision': 0.4047004255726103, 'recall': 0.3255630565653069, 'f1-score': 0.3608437523316172, 'support': 51993}, 'accuracy': 0.3754079646406252, 'macro avg': {'precision': 0.3576250821559692, 'recall': 0.3575985645749511, 'f1-score': 0.3530337368862712, 'support': 136654}, 'weighted avg': {'precision': 0.3702738903308964, 'recall': 0.3754079646406252, 'f1-score': 0.3678788449520646, 'support': 136654}}
[[26951  9473 15057]
 [15915  7423  9842]
 [23897 11169 16927]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.3083651
{'0': {'precision': 0.34389864617636295, 'recall': 0.6958815363257751, 'f1-score': 0.4603140591998531, 'support': 21610}, '1': {'precision': 0.3642196640875637, 'recall': 0.09041930194424924, 'f1-score': 0.14487314217084524, 'support': 21345}, '2': {'precision': 0.3719278395876548, 'recall': 0.26918702515809106, 'f1-score': 0.31232515175508047, 'support': 21981}, 'accuracy': 0.35242392509547865, 'macro avg': {'precision': 0.36001538328386046, 'recall': 0.3518292878093718, 'f1-score': 0.3058374510419262, 'support': 64936}, 'weighted avg': {'precision': 0.3600662855087546, 'recall': 0.35242392509547865, 'f1-score': 0.3065314032227723, 'support': 64936}}
[[15038  1647  4925]
 [14348  1930  5067]
 [14342  1722  5917]]
Evaluating performance on  val set...
81/81 - 1s - 760ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2992928
{'0': {'precision': 0.3571120379692219, 'recall': 0.6874307862679956, 'f1-score': 0.4700425934690014, 'support': 7224}, '1': {'precision': 0.34247917687408136, 'recall': 0.10874299937772246, 'f1-score': 0.16507261778250087, 'support': 6428}, '2': {'precision': 0.37494646680942184, 'recall': 0.251399856424982, 'f1-score': 0.3009883970777825, 'support': 6965}, 'accuracy': 0.35970315758839794, 'macro avg': {'precision': 0.358179227217575, 'recall': 0.3491912140235667, 'f1-score': 0.3120345361097616, 'support': 20617}, 'weighted avg': {'precision': 0.35857475154308954, 'recall': 0.35970315758839794, 'f1-score': 0.3178473428710645, 'support': 20617}}
[[4966  644 1614]
 [4424  699 1305]
 [4516  698 1751]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
1613/1613 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93493116
{'0': {'precision': 0.5210223812989173, 'recall': 0.3474979198858909, 'f1-score': 0.416925645764132, 'support': 100956}, '1': {'precision': 0.5729456096781332, 'recall': 0.8886097551674167, 'f1-score': 0.6966893902019704, 'support': 209776}, '2': {'precision': 0.6762547113667923, 'recall': 0.1335331041844159, 'f1-score': 0.22302728960345433, 'support': 102117}, 'accuracy': 0.5695229975124076, 'macro avg': {'precision': 0.5900742341146142, 'recall': 0.4565469264125745, 'f1-score': 0.4455474418565189, 'support': 412849}, 'weighted avg': {'precision': 0.5858017728101468, 'recall': 0.5695229975124076, 'f1-score': 0.5111184397811505, 'support': 412849}}
[[ 35082  60832   5042]
 [ 21881 186409   1486]
 [ 10370  78111  13636]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9862394
{'0': {'precision': 0.5488436169324539, 'recall': 0.29689264260873494, 'f1-score': 0.3853391171815464, 'support': 44282}, '1': {'precision': 0.5227217648944237, 'recall': 0.9086770401576408, 'f1-score': 0.6636658693213963, 'support': 73585}, '2': {'precision': 0.6028114396509937, 'recall': 0.14030099957128997, 'f1-score': 0.2276238239923857, 'support': 44319}, 'accuracy': 0.5316735106605995, 'macro avg': {'precision': 0.5581256071592904, 'recall': 0.44862356077922194, 'f1-score': 0.4255429368317762, 'support': 162186}, 'weighted avg': {'precision': 0.5517392025739059, 'recall': 0.5316735106605995, 'f1-score': 0.4685207110143091, 'support': 162186}}
[[13147 28054  3081]
 [ 5704 66865  1016]
 [ 5103 32998  6218]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9269781
{'0': {'precision': 0.5403393867222388, 'recall': 0.2940699935191186, 'f1-score': 0.3808624488511174, 'support': 12344}, '1': {'precision': 0.5857586430623783, 'recall': 0.9147126935880735, 'f1-score': 0.7141767431348175, 'support': 27636}, '2': {'precision': 0.6116946778711485, 'recall': 0.13701960784313724, 'f1-score': 0.22388824810970137, 'support': 12750}, 'accuracy': 0.5813768253366205, 'macro avg': {'precision': 0.5792642358852552, 'recall': 0.4486007649834431, 'f1-score': 0.4396424800318788, 'support': 52730}, 'weighted avg': {'precision': 0.5813973524033443, 'recall': 0.5813768253366205, 'f1-score': 0.5175977565956894, 'support': 52730}}
[[ 3630  7958   756]
 [ 2004 25279   353]
 [ 1084  9919  1747]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.3087292
{'0': {'precision': 0.35118613708787205, 'recall': 0.40813535527127937, 'f1-score': 0.3775251465130729, 'support': 82627}, '1': {'precision': 0.36307228648672607, 'recall': 0.4367901892828579, 'f1-score': 0.39653419817028895, 'support': 93775}, '2': {'precision': 0.34177846265409717, 'recall': 0.19697781028380373, 'f1-score': 0.24991921786320886, 'support': 76567}, 'accuracy': 0.35484585067735575, 'macro avg': {'precision': 0.3520122954095651, 'recall': 0.3473011182793137, 'f1-score': 0.34132618751552357, 'support': 252969}, 'weighted avg': {'precision': 0.35274485080973794, 'recall': 0.35484585067735575, 'f1-score': 0.34594882957392736, 'support': 252969}}
[[33723 37266 11638]
 [35407 40960 17408]
 [26896 34589 15082]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2749128
{'0': {'precision': 0.36603670090754964, 'recall': 0.5077646733303358, 'f1-score': 0.42540676026136975, 'support': 28913}, '1': {'precision': 0.3528133825765805, 'recall': 0.4010159446874559, 'f1-score': 0.37537354092027275, 'support': 28348}, '2': {'precision': 0.3793006402589179, 'recall': 0.18411256446159627, 'f1-score': 0.24789626155331773, 'support': 29281}, 'accuracy': 0.36329181206812877, 'macro avg': {'precision': 0.3660502412476827, 'recall': 0.36429772749312933, 'f1-score': 0.3495588542449868, 'support': 86542}, 'weighted avg': {'precision': 0.3661930039754369, 'recall': 0.36329181206812877, 'f1-score': 0.34895802306380225, 'support': 86542}}
[[14681 10076  4156]
 [12314 11368  4666]
 [13113 10777  5391]]
Evaluating performance on  val set...
124/124 - 1s - 999ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2919681
{'0': {'precision': 0.3577241107756923, 'recall': 0.5214272048976468, 'f1-score': 0.42433442316674447, 'support': 10454}, '1': {'precision': 0.3355917289925209, 'recall': 0.37289792725850607, 'f1-score': 0.35326263140832675, 'support': 10228}, '2': {'precision': 0.3682288496652465, 'recall': 0.1672811059907834, 'f1-score': 0.23005260155903415, 'support': 10850}, 'accuracy': 0.35138906507674744, 'macro avg': {'precision': 0.3538482298111532, 'recall': 0.35386874604897883, 'f1-score': 0.33588321871136845, 'support': 31532}, 'weighted avg': {'precision': 0.3541596814998261, 'recall': 0.35138906507674744, 'f1-score': 0.3344295630072635, 'support': 31532}}
[[5451 3564 1439]
 [4739 3814 1675]
 [5048 3987 1815]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2936804
{'0': {'precision': 0.3139644957826776, 'recall': 0.39788105893136355, 'f1-score': 0.3509764870247614, 'support': 74188}, '1': {'precision': 0.3822886909763065, 'recall': 0.024581307401404646, 'f1-score': 0.04619242444239145, 'support': 92550}, '2': {'precision': 0.28217749367347833, 'recall': 0.5515038023900738, 'f1-score': 0.3733368169458395, 'support': 69956}, 'accuracy': 0.29732059114299475, 'macro avg': {'precision': 0.32614356014415413, 'recall': 0.3246553895742807, 'f1-score': 0.2568352428043308, 'support': 236694}, 'weighted avg': {'precision': 0.33128522527146564, 'recall': 0.29732059114299475, 'f1-score': 0.23841120969606105, 'support': 236694}}
[[29518  1929 42741]
 [34871  2275 55404]
 [29628  1747 38581]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2422444
{'0': {'precision': 0.33973181232347055, 'recall': 0.4083926687763713, 'f1-score': 0.3709114860111073, 'support': 30336}, '1': {'precision': 0.2918410041841004, 'recall': 0.028803468804845314, 'f1-score': 0.0524321107526545, 'support': 29059}, '2': {'precision': 0.3233065908398497, 'recall': 0.5456041131105398, 'f1-score': 0.4060196403519959, 'support': 29175}, 'accuracy': 0.32905046855594444, 'macro avg': {'precision': 0.31829313578247354, 'recall': 0.3276000835639188, 'f1-score': 0.2764544123719192, 'support': 88570}, 'weighted avg': {'precision': 0.3186088041885874, 'recall': 0.32905046855594444, 'f1-score': 0.27798598343980824, 'support': 88570}}
[[12389  1056 16891]
 [11796   837 16426]
 [12282   975 15918]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2222625
{'0': {'precision': 0.34279730044216894, 'recall': 0.4017637967087917, 'f1-score': 0.369945583926329, 'support': 10999}, '1': {'precision': 0.26485148514851486, 'recall': 0.032061526168597684, 'f1-score': 0.05719885958660014, 'support': 10012}, '2': {'precision': 0.3499009247027741, 'recall': 0.5645648312611012, 'f1-score': 0.4320375152915591, 'support': 11260}, 'accuracy': 0.3438691084874965, 'macro avg': {'precision': 0.31918323676448596, 'recall': 0.33279671804616356, 'f1-score': 0.28639398626816276, 'support': 32271}, 'weighted avg': {'precision': 0.32109339620785177, 'recall': 0.3438691084874965, 'f1-score': 0.2945817880440547, 'support': 32271}}
[[4419  464 6116]
 [3996  321 5695]
 [4476  427 6357]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2951357
{'0': {'precision': 0.3511650114591291, 'recall': 0.56945089659017, 'f1-score': 0.4344292312962941, 'support': 129156}, '1': {'precision': 0.38806922811676925, 'recall': 0.3493817538111971, 'f1-score': 0.3677106976388517, 'support': 151396}, '2': {'precision': 0.3642656566316202, 'recall': 0.17645895779125773, 'f1-score': 0.23774740936093133, 'support': 126443}, 'accuracy': 0.36549589061290677, 'macro avg': {'precision': 0.36783329873583953, 'recall': 0.3650972027308749, 'f1-score': 0.34662911276535907, 'support': 406995}, 'weighted avg': {'precision': 0.36896286072667633, 'recall': 0.36549589061290677, 'f1-score': 0.3485069012122016, 'support': 406995}}
[[73548 39470 16138]
 [75699 52895 22802]
 [60193 43938 22312]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2870066
{'0': {'precision': 0.36111931956882043, 'recall': 0.6159223386071788, 'f1-score': 0.4552957470417196, 'support': 45634}, '1': {'precision': 0.3649555747430577, 'recall': 0.2881046613896218, 'f1-score': 0.32200828182790014, 'support': 45480}, '2': {'precision': 0.38586888396774327, 'recall': 0.1983675222854688, 'f1-score': 0.2620304165247986, 'support': 46555}, 'accuracy': 0.36642236088008195, 'macro avg': {'precision': 0.3706479260932071, 'recall': 0.36746484076075653, 'f1-score': 0.3464448151314728, 'support': 137669}, 'weighted avg': {'precision': 0.3707561212882791, 'recall': 0.36642236088008195, 'f1-score': 0.34590742156438076, 'support': 137669}}
[[28107 10778  6749]
 [24428 13103  7949]
 [25298 12022  9235]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2970867
{'0': {'precision': 0.3586577346957676, 'recall': 0.6469179798429757, 'f1-score': 0.4614712424531299, 'support': 17959}, '1': {'precision': 0.3681554137701171, 'recall': 0.2113376701470508, 'f1-score': 0.2685281655900535, 'support': 18293}, '2': {'precision': 0.36950367993961125, 'recall': 0.2271461716937355, 'f1-score': 0.28134205043465765, 'support': 17240}, 'accuracy': 0.3626710536154939, 'macro avg': {'precision': 0.36543894280183203, 'recall': 0.3618006072279207, 'f1-score': 0.3371138194926137, 'support': 53492}, 'weighted avg': {'precision': 0.3654012690431643, 'recall': 0.3626710536154939, 'f1-score': 0.337435218833622, 'support': 53492}}
[[11618  3351  2990]
 [10735  3866  3692]
 [10040  3284  3916]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0166198
{'0': {'precision': 0.5410085473452024, 'recall': 0.3816054510599283, 'f1-score': 0.4475366970235089, 'support': 287944}, '1': {'precision': 0.44840745116061387, 'recall': 0.8720152424815637, 'f1-score': 0.5922620599253726, 'support': 364770}, '2': {'precision': 0.6899354745683285, 'recall': 0.12142888864921107, 'f1-score': 0.2065116529995684, 'support': 315238}, 'accuracy': 0.4816819429062598, 'macro avg': {'precision': 0.5597838243580483, 'recall': 0.4583498607302343, 'f1-score': 0.41543680331614996, 'support': 967952}, 'weighted avg': {'precision': 0.554613896400436, 'recall': 0.4816819429062598, 'f1-score': 0.42358015558105505, 'support': 967952}}
[[109881 163439  14624]
 [ 44106 318085   2579]
 [ 49117 227842  38279]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0617214
{'0': {'precision': 0.5537332139659803, 'recall': 0.33752673932973415, 'f1-score': 0.41940573112791746, 'support': 137438}, '1': {'precision': 0.3878300957089646, 'recall': 0.864503205724881, 'f1-score': 0.5354490863304707, 'support': 134291}, '2': {'precision': 0.6326224091318714, 'recall': 0.1220666120863914, 'f1-score': 0.20464607816343264, 'support': 138023}, 'accuracy': 0.4376598527890041, 'macro avg': {'precision': 0.5247285729356054, 'recall': 0.4413655190470022, 'f1-score': 0.38650029854060697, 'support': 409752}, 'weighted avg': {'precision': 0.5259340274593346, 'recall': 0.4376598527890041, 'f1-score': 0.3850967018428596, 'support': 409752}}
[[ 46389  83000   8049]
 [ 16461 116095   1735]
 [ 20925 100250  16848]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0268477
{'0': {'precision': 0.5613534447615165, 'recall': 0.3459640948334932, 'f1-score': 0.42809298381968486, 'support': 43782}, '1': {'precision': 0.4236797946895667, 'recall': 0.8632944489139179, 'f1-score': 0.568403628418195, 'support': 49720}, '2': {'precision': 0.666497139224412, 'recall': 0.1228900975243811, 'f1-score': 0.20751766592110213, 'support': 42656}, 'accuracy': 0.46498920371920854, 'macro avg': {'precision': 0.550510126225165, 'recall': 0.44404954709059746, 'f1-score': 0.40133809271966064, 'support': 136158}, 'weighted avg': {'precision': 0.5440197262097747, 'recall': 0.46498920371920854, 'f1-score': 0.4102268612940601, 'support': 136158}}
[[15147 26561  2074]
 [ 6248 42923   549]
 [ 5588 31826  5242]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0517657
{'0': {'precision': 0.5252705647033611, 'recall': 0.41107544997827294, 'f1-score': 0.46120948956928576, 'support': 393519}, '1': {'precision': 0.4103343666726827, 'recall': 0.8246830142583573, 'f1-score': 0.5480016517764572, 'support': 374938}, '2': {'precision': 0.5472132715738597, 'recall': 0.11671078276089793, 'f1-score': 0.1923885385551499, 'support': 372502}, 'accuracy': 0.4508891204679572, 'macro avg': {'precision': 0.4942727343166345, 'recall': 0.4508230823325094, 'f1-score': 0.40053322663363095, 'support': 1140959}, 'weighted avg': {'precision': 0.49466451661350685, 'recall': 0.4508891204679572, 'f1-score': 0.40196576373773946, 'support': 1140959}}
[[161766 204716  27037]
 [ 56797 309205   8936]
 [ 89404 239623  43475]]
Evaluating performance on  train set...
2425/2425 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0080152
{'0': {'precision': 0.4823353993684949, 'recall': 0.43922218021692483, 'f1-score': 0.4597703071396523, 'support': 187807}, '1': {'precision': 0.4791061926224276, 'recall': 0.812334837747871, 'f1-score': 0.6027292645895648, 'support': 244835}, '2': {'precision': 0.6015494016303405, 'recall': 0.11063558308301656, 'f1-score': 0.18689742196516215, 'support': 188095}, 'accuracy': 0.4868196998084535, 'macro avg': {'precision': 0.5209969978737544, 'recall': 0.4540642003492708, 'f1-score': 0.4164656645647931, 'support': 620737}, 'weighted avg': {'precision': 0.5171858028755655, 'recall': 0.4868196998084535, 'f1-score': 0.4334714575630258, 'support': 620737}}
[[ 82489  95349   9969]
 [ 42132 198888   3815]
 [ 46399 120886  20810]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0111992
{'0': {'precision': 0.5069136090986991, 'recall': 0.410584430948813, 'f1-score': 0.45369216422788317, 'support': 63395}, '1': {'precision': 0.45654399326252204, 'recall': 0.8271140515869362, 'f1-score': 0.5883404127916767, 'support': 76027}, '2': {'precision': 0.5950399604515119, 'recall': 0.11686084142394822, 'f1-score': 0.19535550536267363, 'support': 61800}, 'accuracy': 0.47775094174593236, 'macro avg': {'precision': 0.5194991876042443, 'recall': 0.45151977465323245, 'f1-score': 0.4124626941274112, 'support': 201222}, 'weighted avg': {'precision': 0.5149483057542675, 'recall': 0.47775094174593236, 'f1-score': 0.42522458551228337, 'support': 201222}}
[[26029 33771  3595]
 [11824 62883  1320]
 [13495 41083  7222]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0814646
{'0': {'precision': 0.5049004555794382, 'recall': 0.39994192265785744, 'f1-score': 0.44633377881492664, 'support': 402911}, '1': {'precision': 0.39296048586450505, 'recall': 0.7946257295102765, 'f1-score': 0.5258675264267062, 'support': 394100}, '2': {'precision': 0.5718682405290155, 'recall': 0.11567386206241344, 'f1-score': 0.1924251845043389, 'support': 399978}, 'accuracy': 0.4348995688348013, 'macro avg': {'precision': 0.4899097273243196, 'recall': 0.43674717141018243, 'f1-score': 0.3882088299153239, 'support': 1196989}, 'weighted avg': {'precision': 0.49042254360523196, 'recall': 0.4348995688348013, 'f1-score': 0.38767525998028585, 'support': 1196989}}
[[161141 217829  23941]
 [ 70241 313162  10697]
 [ 87772 265939  46267]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0692289
{'0': {'precision': 0.5026372629340989, 'recall': 0.40702360391479564, 'f1-score': 0.44980549933954606, 'support': 182385}, '1': {'precision': 0.3997120125094566, 'recall': 0.7970725141607313, 'f1-score': 0.5324257652922655, 'support': 178310}, '2': {'precision': 0.5813483829916729, 'recall': 0.11758452051881778, 'f1-score': 0.19560553101772776, 'support': 178714}, 'accuracy': 0.4400649599839825, 'macro avg': {'precision': 0.49456588614507613, 'recall': 0.4405602128647816, 'f1-score': 0.3926122652165131, 'support': 539409}, 'weighted avg': {'precision': 0.49469185918064157, 'recall': 0.4400649599839825, 'f1-score': 0.39289678347341106, 'support': 539409}}
[[ 74235  97284  10866]
 [ 31917 142126   4267]
 [ 41539 116161  21014]]
Evaluating performance on  val set...
798/798 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0909959
{'0': {'precision': 0.48336871903750883, 'recall': 0.44287506519502123, 'f1-score': 0.462236738537138, 'support': 70941}, '1': {'precision': 0.3745752773248295, 'recall': 0.7508936910244437, 'f1-score': 0.4998204667863555, 'support': 62102}, '2': {'precision': 0.5767242552033737, 'recall': 0.11917076598735067, 'f1-score': 0.19752597493360669, 'support': 71150}, 'accuracy': 0.42376085370213473, 'macro avg': {'precision': 0.47822275052190405, 'recall': 0.4376465074022719, 'f1-score': 0.38652772675236674, 'support': 204193}, 'weighted avg': {'precision': 0.48281020861335355, 'recall': 0.42376085370213473, 'f1-score': 0.38143011863019527, 'support': 204193}}
[[31418 35053  4470]
 [13717 46632  1753]
 [19863 42808  8479]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1232967
{'0': {'precision': 0.4420353388965105, 'recall': 0.5318206299841896, 'f1-score': 0.48278907748013256, 'support': 402899}, '1': {'precision': 0.3224032486727799, 'recall': 0.5960801126540628, 'f1-score': 0.4184684728774739, 'support': 286896}, '2': {'precision': 0.5087708180182007, 'recall': 0.09929255200732184, 'f1-score': 0.1661575269885423, 'support': 404270}, 'accuracy': 0.38884709775013365, 'macro avg': {'precision': 0.4244031351958304, 'recall': 0.40906443154852473, 'f1-score': 0.3558050257820496, 'support': 1094065}, 'weighted avg': {'precision': 0.4353238400255095, 'recall': 0.38884709775013365, 'f1-score': 0.34892320927731135, 'support': 1094065}}
[[214270 163482  25147]
 [102273 171013  13610]
 [168192 195937  40141]]
Evaluating performance on  train set...
1972/1972 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0694097
{'0': {'precision': 0.4527452904934782, 'recall': 0.4591550984918898, 'f1-score': 0.4559276670110244, 'support': 166765}, '1': {'precision': 0.4064936560516458, 'recall': 0.7201387305435213, 'f1-score': 0.5196581048547725, 'support': 166654}, '2': {'precision': 0.5332487814582711, 'recall': 0.12527970740998243, 'f1-score': 0.20289251701967614, 'support': 171161}, 'accuracy': 0.4320979824804788, 'macro avg': {'precision': 0.4641625760011317, 'recall': 0.4348578454817979, 'f1-score': 0.3928260962951577, 'support': 504580}, 'weighted avg': {'precision': 0.4647771548772346, 'recall': 0.4320979824804788, 'f1-score': 0.39114345654042076, 'support': 504580}}
[[ 76571  78369  11825]
 [ 39696 120014   6944]
 [ 52859  96859  21443]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0872406
{'0': {'precision': 0.4521430512701635, 'recall': 0.4553607367692283, 'f1-score': 0.45374618963580937, 'support': 62109}, '1': {'precision': 0.38022563944053783, 'recall': 0.6918588301462317, 'f1-score': 0.49074951378846055, 'support': 56896}, '2': {'precision': 0.5098466780238501, 'recall': 0.1211679541369091, 'f1-score': 0.19580236574897938, 'support': 61749}, 'accuracy': 0.41563672173229915, 'macro avg': {'precision': 0.4474051229115171, 'recall': 0.4227958403507897, 'f1-score': 0.3800993563910831, 'support': 180754}, 'weighted avg': {'precision': 0.4492182373515505, 'recall': 0.41563672173229915, 'f1-score': 0.3772752288260977, 'support': 180754}}
[[28282 29241  4586]
 [14925 39364  2607]
 [19344 34923  7482]]
testing model on single stock: results/universal/W4/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
12724/12724 - 117s - 117s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2673794
{'0': {'precision': 0.3189243343968297, 'recall': 0.5195028511191404, 'f1-score': 0.3952212043517315, 'support': 936299}, '1': {'precision': 0.41361341196521123, 'recall': 0.3642498369068531, 'f1-score': 0.3873653063550098, 'support': 1376514}, '2': {'precision': 0.33722039872402154, 'recall': 0.18560488132376893, 'f1-score': 0.2394289429899214, 'support': 944334}, 'accuracy': 0.357084896690263, 'macro avg': {'precision': 0.35658604836202085, 'recall': 0.3564525231165874, 'f1-score': 0.3406718178988876, 'support': 3257147}, 'weighted avg': {'precision': 0.3642457265631389, 'recall': 0.357084896690263, 'f1-score': 0.3467328546039605, 'support': 3257147}}
[[486410 334404 115485]
 [646119 501395 229000]
 [392629 376432 175273]]
Evaluating performance on  train set...
5165/5165 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.255253
{'0': {'precision': 0.3578421966593432, 'recall': 0.6755399592483586, 'f1-score': 0.4678553845092462, 'support': 441700}, '1': {'precision': 0.36386205504970615, 'recall': 0.23137093171117298, 'f1-score': 0.28287109271050137, 'support': 436455}, '2': {'precision': 0.3923824167271726, 'recall': 0.18624745746676968, 'f1-score': 0.252597491866131, 'support': 443947}, 'accuracy': 0.3646110511896964, 'macro avg': {'precision': 0.3713622228120739, 'recall': 0.3643861161421004, 'f1-score': 0.3344413230286262, 'support': 1322102}, 'weighted avg': {'precision': 0.3714277024465053, 'recall': 0.3646110511896964, 'f1-score': 0.3345068117499173, 'support': 1322102}}
[[298386  83170  60144]
 [267577 100983  67895]
 [267885  93378  82684]]
Evaluating performance on  val set...
1903/1903 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2402053
{'0': {'precision': 0.3623648250187228, 'recall': 0.6240918210934288, 'f1-score': 0.4585075774742668, 'support': 160486}, '1': {'precision': 0.3772287485587287, 'recall': 0.26994756384117286, 'f1-score': 0.3146962573665997, 'support': 167251}, '2': {'precision': 0.3723779877465269, 'recall': 0.21256663506275783, 'f1-score': 0.27064146840624204, 'support': 159263}, 'accuracy': 0.3678870636550308, 'macro avg': {'precision': 0.37065718710799284, 'recall': 0.3688686733324531, 'f1-score': 0.34794843441570283, 'support': 487000}, 'weighted avg': {'precision': 0.37074415235241437, 'recall': 0.3678870636550308, 'f1-score': 0.34768066324874675, 'support': 487000}}
[[100158  35415  24913]
 [ 89956  45149  32146]
 [ 86287  39122  33854]]
training model: results/universal/W4/deepVOL_L2/h200
Epoch 1/50
9854/9854 - 322s - loss: 3.2384 - accuracy200: 0.3985 - val_loss: 3.4307 - val_accuracy200: 0.3484 - 322s/epoch - 33ms/step
Epoch 2/50
9854/9854 - 321s - loss: 3.2246 - accuracy200: 0.4062 - val_loss: 3.3705 - val_accuracy200: 0.3507 - 321s/epoch - 33ms/step
Epoch 3/50
9854/9854 - 323s - loss: 3.2175 - accuracy200: 0.4094 - val_loss: 3.3524 - val_accuracy200: 0.3553 - 323s/epoch - 33ms/step
Epoch 4/50
9854/9854 - 322s - loss: 3.2102 - accuracy200: 0.4128 - val_loss: 3.3693 - val_accuracy200: 0.3544 - 322s/epoch - 33ms/step
Epoch 5/50
9854/9854 - 315s - loss: 3.2036 - accuracy200: 0.4154 - val_loss: 3.3690 - val_accuracy200: 0.3550 - 315s/epoch - 32ms/step
Epoch 6/50
9854/9854 - 315s - loss: 3.1990 - accuracy200: 0.4175 - val_loss: 3.3609 - val_accuracy200: 0.3554 - 315s/epoch - 32ms/step
Epoch 7/50
9854/9854 - 321s - loss: 3.1950 - accuracy200: 0.4189 - val_loss: 3.3538 - val_accuracy200: 0.3546 - 321s/epoch - 33ms/step
Epoch 8/50
9854/9854 - 319s - loss: 3.1917 - accuracy200: 0.4202 - val_loss: 3.3586 - val_accuracy200: 0.3561 - 319s/epoch - 32ms/step
Epoch 9/50
9854/9854 - 312s - loss: 3.1890 - accuracy200: 0.4214 - val_loss: 3.3835 - val_accuracy200: 0.3532 - 312s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 317s - loss: 3.1867 - accuracy200: 0.4226 - val_loss: 3.3900 - val_accuracy200: 0.3513 - 317s/epoch - 32ms/step
Epoch 11/50
9854/9854 - 318s - loss: 3.1845 - accuracy200: 0.4234 - val_loss: 3.3816 - val_accuracy200: 0.3521 - 318s/epoch - 32ms/step
Epoch 12/50
9854/9854 - 331s - loss: 3.1828 - accuracy200: 0.4241 - val_loss: 3.3889 - val_accuracy200: 0.3538 - 331s/epoch - 34ms/step
Epoch 13/50
9854/9854 - 318s - loss: 3.1816 - accuracy200: 0.4246 - val_loss: 3.3736 - val_accuracy200: 0.3543 - 318s/epoch - 32ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 371s - 371s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983386
{'0': {'precision': 0.35970851548908656, 'recall': 0.22628714399621536, 'f1-score': 0.2778089268191428, 'support': 1800964}, '1': {'precision': 0.39721560617768464, 'recall': 0.7452110169610938, 'f1-score': 0.518211743033813, 'support': 2412934}, '2': {'precision': 0.34442857906060736, 'recall': 0.07634843112546313, 'f1-score': 0.12499058175455634, 'support': 1857733}, 'accuracy': 0.38663663849137075, 'macro avg': {'precision': 0.3671175669091262, 'recall': 0.34928219736092414, 'f1-score': 0.3070037505358374, 'support': 6071631}, 'weighted avg': {'precision': 0.3699390601685168, 'recall': 0.38663663849137075, 'f1-score': 0.3265899621469253, 'support': 6071631}}
[[ 407535 1288264  105165]
 [ 449991 1798145  164798]
 [ 275433 1440465  141835]]
Evaluating performance on  train set...
9854/9854 - 160s - 160s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1202484
{'0': {'precision': 0.3925832152615562, 'recall': 0.2078214302323224, 'f1-score': 0.27177406401893717, 'support': 838619}, '1': {'precision': 0.3377258449343686, 'recall': 0.7649731917141903, 'f1-score': 0.4685797464900746, 'support': 844142}, '2': {'precision': 0.3840265481395825, 'recall': 0.07597544497639581, 'f1-score': 0.12685418026133596, 'support': 839258}, 'accuracy': 0.3504303496524015, 'macro avg': {'precision': 0.37144520277850246, 'recall': 0.3495900223076362, 'f1-score': 0.28906933025678255, 'support': 2522019}, 'weighted avg': {'precision': 0.37137454806349535, 'recall': 0.3504303496524015, 'f1-score': 0.2894213420965068, 'support': 2522019}}
[[174283 613159  51177]
 [147298 645746  51098]
 [122358 653137  63763]]
Evaluating performance on  val set...
3566/3566 - 57s - 57s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1170913
{'0': {'precision': 0.39461400808399344, 'recall': 0.2092210110070926, 'f1-score': 0.27345728259738455, 'support': 301442}, '1': {'precision': 0.34383574990220783, 'recall': 0.7610773855889378, 'f1-score': 0.47367635554674103, 'support': 310678}, '2': {'precision': 0.3820222986414175, 'recall': 0.08251285672413333, 'f1-score': 0.13571309223483138, 'support': 300232}, 'accuracy': 0.3554450475255165, 'macro avg': {'precision': 0.37349068554253956, 'recall': 0.35093708444005456, 'f1-score': 0.2942822434596523, 'support': 912352}, 'weighted avg': {'precision': 0.3731791651672636, 'recall': 0.3554450475255165, 'f1-score': 0.2963086024660647, 'support': 912352}}
[[ 63068 218999  19375]
 [ 53529 236450  20699]
 [ 43225 232234  24773]]
testing model out of sample: results/universal/W4/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 186s - 186s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1297944
{'0': {'precision': 0.4219746158984636, 'recall': 0.22286657791618253, 'f1-score': 0.29168123722510897, 'support': 1062905}, '1': {'precision': 0.3190344268877789, 'recall': 0.774102875217298, 'f1-score': 0.4518471132062661, 'support': 937077}, '2': {'precision': 0.39977613838717885, 'recall': 0.07616462788127872, 'f1-score': 0.1279520603154184, 'support': 1031660}, 'accuracy': 0.343330775863377, 'macro avg': {'precision': 0.3802617270578071, 'recall': 0.35771136033825307, 'f1-score': 0.29049347024893113, 'support': 3031642}, 'weighted avg': {'precision': 0.3826018387675038, 'recall': 0.343330775863377, 'f1-score': 0.28547170322213083, 'support': 3031642}}
[[236886 761129  64890]
 [158599 725394  53084]
 [165890 787194  78576]]
Evaluating performance on  train set...
5528/5528 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117817
{'0': {'precision': 0.41874798643818173, 'recall': 0.2335192686922784, 'f1-score': 0.29983330541359204, 'support': 467546}, '1': {'precision': 0.3400013395127004, 'recall': 0.7715943270002676, 'f1-score': 0.4720117442764986, 'support': 467125}, '2': {'precision': 0.41637033477494795, 'recall': 0.0812662960901889, 'f1-score': 0.13599029014470615, 'support': 479793}, 'accuracy': 0.35957295484367224, 'macro avg': {'precision': 0.3917065535752767, 'recall': 0.362126630594245, 'f1-score': 0.3026117799449322, 'support': 1414464}, 'weighted avg': {'precision': 0.39193549204488265, 'recall': 0.35957295484367224, 'f1-score': 0.30111868378231027, 'support': 1414464}}
[[109181 329996  28369]
 [ 80409 360431  26285]
 [ 71142 369660  38991]]
Evaluating performance on  val set...
1908/1908 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1224778
{'0': {'precision': 0.423209397810219, 'recall': 0.22298137765679363, 'f1-score': 0.29207416182263973, 'support': 166413}, '1': {'precision': 0.33117035757433294, 'recall': 0.7671899041962426, 'f1-score': 0.4626361017295397, 'support': 157927}, '2': {'precision': 0.39791098201449404, 'recall': 0.0830613007343349, 'f1-score': 0.1374341305229023, 'support': 163277}, 'accuracy': 0.3523851711486679, 'macro avg': {'precision': 0.3840969124663487, 'recall': 0.35774419419579034, 'f1-score': 0.2973814646916939, 'support': 487617}, 'weighted avg': {'precision': 0.38492915133970756, 'recall': 0.3523851711486679, 'f1-score': 0.2955342033986098, 'support': 487617}}
[[ 37107 118598  10708]
 [ 26954 121160   9813]
 [ 23619 126096  13562]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1454426
{'0': {'precision': 0.40057024364955934, 'recall': 0.15580827939426936, 'f1-score': 0.2243514364937648, 'support': 49593}, '1': {'precision': 0.2928465658763094, 'recall': 0.8218665024883279, 'f1-score': 0.4318255337502696, 'support': 38982}, '2': {'precision': 0.4076865109269028, 'recall': 0.0675138834002371, 'f1-score': 0.11584375724915687, 'support': 48079}, 'accuracy': 0.3147438055234388, 'macro avg': {'precision': 0.36703444015092385, 'recall': 0.3483962217609448, 'f1-score': 0.2573402424977304, 'support': 136654}, 'weighted avg': {'precision': 0.3723446418191743, 'recall': 0.3147438055234388, 'f1-score': 0.24535934368163756, 'support': 136654}}
[[ 7727 39263  2603]
 [ 4831 32038  2113]
 [ 6732 38101  3246]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1406673
{'0': {'precision': 0.3483261449989731, 'recall': 0.15708794516741537, 'f1-score': 0.2165267626312598, 'support': 21593}, '1': {'precision': 0.3268228605883113, 'recall': 0.7071897861236662, 'f1-score': 0.44704634825255163, 'support': 21461}, '2': {'precision': 0.341324200913242, 'recall': 0.13664198884928253, 'f1-score': 0.1951569740878533, 'support': 21882}, 'accuracy': 0.3320038191450043, 'macro avg': {'precision': 0.3388244021668421, 'recall': 0.3336399067134547, 'f1-score': 0.2862433616572216, 'support': 64936}, 'weighted avg': {'precision': 0.33885992399334935, 'recall': 0.3320038191450043, 'f1-score': 0.2855111028140817, 'support': 64936}}
[[ 3392 15566  2635]
 [ 3149 15177  3135]
 [ 3197 15695  2990]]
Evaluating performance on  val set...
81/81 - 1s - 732ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.165786
{'0': {'precision': 0.3662420382165605, 'recall': 0.15425888665325285, 'f1-score': 0.21708352996696553, 'support': 7455}, '1': {'precision': 0.2854469183607615, 'recall': 0.7463719203509956, 'f1-score': 0.412959245600112, 'support': 5926}, '2': {'precision': 0.33198789101917253, 'recall': 0.09093421779988944, 'f1-score': 0.14276415708396614, 'support': 7236}, 'accuracy': 0.30222631808701556, 'macro avg': {'precision': 0.32789228253216485, 'recall': 0.33052167493471263, 'f1-score': 0.25760231088368124, 'support': 20617}, 'weighted avg': {'precision': 0.330996615051902, 'recall': 0.30222631808701556, 'f1-score': 0.2473005600227759, 'support': 20617}}
[[1150 5600  705]
 [ 884 4423  619]
 [1106 5472  658]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
1613/1613 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101436
{'0': {'precision': 0.4720677916289094, 'recall': 0.15013319209259576, 'f1-score': 0.2278139903201215, 'support': 128386}, '1': {'precision': 0.3764189071419234, 'recall': 0.9020571458406756, 'f1-score': 0.5311814237345457, 'support': 153222}, '2': {'precision': 0.4927596193628465, 'recall': 0.018149815987381992, 'f1-score': 0.03501010472166085, 'support': 131241}, 'accuracy': 0.3872408556154914, 'macro avg': {'precision': 0.4470821060445598, 'recall': 0.35678005130688445, 'f1-score': 0.264668506258776, 'support': 412849}, 'weighted avg': {'precision': 0.4431470549546403, 'recall': 0.3872408556154914, 'f1-score': 0.2791131096901511, 'support': 412849}}
[[ 19275 108076   1035]
 [ 13590 138215   1417]
 [  7966 120893   2382]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1173604
{'0': {'precision': 0.49979778916149903, 'recall': 0.136490814711188, 'f1-score': 0.21442410572279574, 'support': 54326}, '1': {'precision': 0.3418486222532264, 'recall': 0.9068768968835591, 'f1-score': 0.4965296424265146, 'support': 54036}, '2': {'precision': 0.4885, 'recall': 0.03630350772889417, 'f1-score': 0.06758439402324294, 'support': 53824}, 'accuracy': 0.35991392598621336, 'macro avg': {'precision': 0.4433821371382418, 'recall': 0.3598904064412138, 'f1-score': 0.25951271405751775, 'support': 162186}, 'weighted avg': {'precision': 0.4434240368839662, 'recall': 0.35991392598621336, 'f1-score': 0.25968296985906786, 'support': 162186}}
[[ 7415 45840  1071]
 [ 4057 49004   975]
 [ 3364 48506  1954]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982088
{'0': {'precision': 0.4833495618305745, 'recall': 0.1551928968923904, 'f1-score': 0.23494888299886404, 'support': 15993}, '1': {'precision': 0.39189362795477906, 'recall': 0.9068523014418075, 'f1-score': 0.5472812355166177, 'support': 20183}, '2': {'precision': 0.468013468013468, 'recall': 0.02519028633562885, 'f1-score': 0.047807394668959585, 'support': 16554}, 'accuracy': 0.40208609899487957, 'macro avg': {'precision': 0.4477522192662738, 'recall': 0.36241182822327556, 'f1-score': 0.27667917106148043, 'support': 52730}, 'weighted avg': {'precision': 0.44352917854850427, 'recall': 0.40208609899487957, 'f1-score': 0.29574660105409983, 'support': 52730}}
[[ 2482 13328   183]
 [ 1589 18303   291]
 [ 1064 15073   417]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1068947
{'0': {'precision': 0.33882727774033455, 'recall': 0.14062301335028607, 'f1-score': 0.19875642454084747, 'support': 78650}, '1': {'precision': 0.4031713298674517, 'recall': 0.8282965265335617, 'f1-score': 0.5423534368214668, 'support': 101023}, '2': {'precision': 0.3479655712050078, 'recall': 0.0606717965509714, 'f1-score': 0.10332729216041638, 'support': 73296}, 'accuracy': 0.3920796619348616, 'macro avg': {'precision': 0.363321392937598, 'recall': 0.3431971121449397, 'f1-score': 0.2814790511742435, 'support': 252969}, 'weighted avg': {'precision': 0.36717078835161276, 'recall': 0.3920796619348616, 'f1-score': 0.3083217360401574, 'support': 252969}}
[[11060 63804  3786]
 [12799 83677  4547]
 [ 8783 60066  4447]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1476086
{'0': {'precision': 0.3650154508849143, 'recall': 0.13647025872632426, 'f1-score': 0.19866469598899136, 'support': 28563}, '1': {'precision': 0.33445351936929274, 'recall': 0.8263382847533632, 'f1-score': 0.47617797876206247, 'support': 28544}, '2': {'precision': 0.3667353436973216, 'recall': 0.06651944963478852, 'f1-score': 0.11261287168574223, 'support': 29435}, 'accuracy': 0.34021631115527723, 'macro avg': {'precision': 0.3554014379838429, 'recall': 0.3431093310381587, 'f1-score': 0.2624851821455987, 'support': 86542}, 'weighted avg': {'precision': 0.35552023782941883, 'recall': 0.34021631115527723, 'f1-score': 0.2609281483601915, 'support': 86542}}
[[ 3898 22821  1844]
 [ 3420 23587  1537]
 [ 3361 24116  1958]]
Evaluating performance on  val set...
124/124 - 1s - 998ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1516272
{'0': {'precision': 0.37901785714285713, 'recall': 0.1636468774094063, 'f1-score': 0.22859450726978994, 'support': 10376}, '1': {'precision': 0.33037321492859717, 'recall': 0.81409561360276, 'f1-score': 0.47000910539494656, 'support': 10145}, '2': {'precision': 0.3648319532391622, 'recall': 0.06802288620470438, 'f1-score': 0.11466625842008572, 'support': 11011}, 'accuracy': 0.33952809843968035, 'macro avg': {'precision': 0.3580743417702055, 'recall': 0.34858845907229025, 'f1-score': 0.27108995702827404, 'support': 31532}, 'weighted avg': {'precision': 0.3584133638298021, 'recall': 0.33952809843968035, 'f1-score': 0.26648259397204865, 'support': 31532}}
[[1698 7971  707]
 [1289 8259  597]
 [1493 8769  749]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1066196
{'0': {'precision': 0.3217088389541783, 'recall': 0.11279477096111774, 'f1-score': 0.16702772533041838, 'support': 74507}, '1': {'precision': 0.3722117202268431, 'recall': 0.868823895457374, 'f1-score': 0.521155771221093, 'support': 88385}, '2': {'precision': 0.290542126261441, 'recall': 0.016774613154115065, 'f1-score': 0.03171797138208883, 'support': 73802}, 'accuracy': 0.3651676848589318, 'macro avg': {'precision': 0.32815422848082076, 'recall': 0.3327977598575356, 'f1-score': 0.23996715597786678, 'support': 236694}, 'weighted avg': {'precision': 0.33084946537958443, 'recall': 0.3651676848589318, 'f1-score': 0.257074270131523, 'support': 236694}}
[[ 8404 64900  1203]
 [ 9774 76791  1820]
 [ 7945 64619  1238]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1187527
{'0': {'precision': 0.3392182989118366, 'recall': 0.1020374081496326, 'f1-score': 0.15688389051507215, 'support': 29940}, '1': {'precision': 0.3308616134672572, 'recall': 0.8838430329685316, 'f1-score': 0.48148285724898787, 'support': 29331}, '2': {'precision': 0.3236994219653179, 'recall': 0.013379296221714052, 'f1-score': 0.025696492953130118, 'support': 29299}, 'accuracy': 0.33161341311956644, 'macro avg': {'precision': 0.3312597781148039, 'recall': 0.33308657911329276, 'f1-score': 0.2213544135723967, 'support': 88570}, 'weighted avg': {'precision': 0.3313172317736294, 'recall': 0.33161341311956644, 'f1-score': 0.22098181003754183, 'support': 88570}}
[[ 3055 26492   393]
 [ 2981 25924   426]
 [ 2970 25937   392]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1306405
{'0': {'precision': 0.34131386861313867, 'recall': 0.10581100651701665, 'f1-score': 0.16154218199405793, 'support': 11048}, '1': {'precision': 0.2982357291263162, 'recall': 0.8799875311720698, 'f1-score': 0.44549064990400045, 'support': 9624}, '2': {'precision': 0.38084632516703787, 'recall': 0.014742650228467971, 'f1-score': 0.02838645418326693, 'support': 11599}, 'accuracy': 0.30395711319760776, 'macro avg': {'precision': 0.34013197430216424, 'recall': 0.3335137293058515, 'f1-score': 0.21180642869377508, 'support': 32271}, 'weighted avg': {'precision': 0.3426758638766104, 'recall': 0.30395711319760776, 'f1-score': 0.19836306663624198, 'support': 32271}}
[[ 1169  9724   155]
 [ 1032  8469   123]
 [ 1224 10204   171]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
1590/1590 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1305914
{'0': {'precision': 0.34371796332156285, 'recall': 0.13970877607241244, 'f1-score': 0.19866677639700436, 'support': 129591}, '1': {'precision': 0.373815384429298, 'recall': 0.812167400302214, 'f1-score': 0.5119815782716377, 'support': 152210}, '2': {'precision': 0.3431824916395039, 'recall': 0.06475549946483058, 'f1-score': 0.10895260622106345, 'support': 125194}, 'accuracy': 0.3681421147679947, 'macro avg': {'precision': 0.35357194646345497, 'recall': 0.33887722527981895, 'f1-score': 0.2732003202965685, 'support': 406995}, 'weighted avg': {'precision': 0.3548092313347932, 'recall': 0.3681421147679947, 'f1-score': 0.28824519915976854, 'support': 406995}}
[[ 18105 104116   7370]
 [ 20444 123620   8146]
 [ 14125 102962   8107]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1584673
{'0': {'precision': 0.34722051029212375, 'recall': 0.12412699112119677, 'f1-score': 0.18287754605209772, 'support': 45389}, '1': {'precision': 0.32937863052279526, 'recall': 0.8234284582719091, 'f1-score': 0.4705379426538169, 'support': 45449}, '2': {'precision': 0.3691678384251566, 'recall': 0.06166855288163823, 'f1-score': 0.10568302411534379, 'support': 46831}, 'accuracy': 0.33374252736636423, 'macro avg': {'precision': 0.3485889930800252, 'recall': 0.336408000758248, 'f1-score': 0.2530328376070861, 'support': 137669}, 'weighted avg': {'precision': 0.3487961716985541, 'recall': 0.33374252736636423, 'f1-score': 0.2515842317135859, 'support': 137669}}
[[ 5634 37230  2525]
 [ 5615 37424  2410]
 [ 4977 38966  2888]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1559534
{'0': {'precision': 0.37627877237851665, 'recall': 0.12340113231285385, 'f1-score': 0.18585188694141797, 'support': 19076}, '1': {'precision': 0.3187472389499872, 'recall': 0.8061272492061625, 'f1-score': 0.4568524535532783, 'support': 17006}, '2': {'precision': 0.36669032410693164, 'recall': 0.08902929350947732, 'f1-score': 0.14327309700975183, 'support': 17410}, 'accuracy': 0.3292641890376131, 'macro avg': {'precision': 0.35390544514514516, 'recall': 0.3395192250094979, 'f1-score': 0.2619924791681494, 'support': 53492}, 'weighted avg': {'precision': 0.35486779238349186, 'recall': 0.3292641890376131, 'f1-score': 0.25814940625441785, 'support': 53492}}
[[ 2354 15311  1411]
 [ 2031 13709  1266]
 [ 1871 13989  1550]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
3782/3782 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293074
{'0': {'precision': 0.46547148111168685, 'recall': 0.23098922809163178, 'f1-score': 0.30875797212924755, 'support': 318885}, '1': {'precision': 0.3117662302687239, 'recall': 0.8252924738631434, 'f1-score': 0.4525682315442212, 'support': 297377}, '2': {'precision': 0.4846693921080697, 'recall': 0.03101310813500526, 'f1-score': 0.05829596412556054, 'support': 351690}, 'accuracy': 0.34091463213051887, 'macro avg': {'precision': 0.4206357011628268, 'recall': 0.3624316033632602, 'f1-score': 0.2732073892663431, 'support': 967952}, 'weighted avg': {'precision': 0.4252249677911814, 'recall': 0.34091463213051887, 'f1-score': 0.26193837768575234, 'support': 967952}}
[[ 73659 238729   6497]
 [ 46854 245423   5100]
 [ 37733 303050  10907]]
Evaluating performance on  train set...
1601/1601 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072578
{'0': {'precision': 0.46110145604836944, 'recall': 0.23104674648011006, 'f1-score': 0.30784156002437535, 'support': 136652}, '1': {'precision': 0.33696790825203365, 'recall': 0.8184251863979292, 'f1-score': 0.4773838867452155, 'support': 135597}, '2': {'precision': 0.47320381845587006, 'recall': 0.04109728515014218, 'f1-score': 0.07562648465990833, 'support': 137503}, 'accuracy': 0.36168218825045395, 'macro avg': {'precision': 0.42375772758542435, 'recall': 0.3635230726760605, 'f1-score': 0.28695064380983304, 'support': 409752}, 'weighted avg': {'precision': 0.4240838806798021, 'recall': 0.36168218825045395, 'f1-score': 0.28602143802015195, 'support': 409752}}
[[ 31573 101890   3189]
 [ 21519 110976   3102]
 [ 15381 116471   5651]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100119
{'0': {'precision': 0.4857091008075492, 'recall': 0.2337758756223251, 'f1-score': 0.3156343052566408, 'support': 45796}, '1': {'precision': 0.3406000198264286, 'recall': 0.8230221467302541, 'f1-score': 0.48180821498686927, 'support': 45921}, '2': {'precision': 0.48239771646051377, 'recall': 0.03422515244931482, 'f1-score': 0.06391561961591798, 'support': 44441}, 'accuracy': 0.36737466766550625, 'macro avg': {'precision': 0.43623561236483055, 'recall': 0.36367439160063136, 'f1-score': 0.2871193799531427, 'support': 136158}, 'weighted avg': {'precision': 0.4356884238036226, 'recall': 0.36737466766550625, 'f1-score': 0.28951936526165306, 'support': 136158}}
[[10706 34390   700]
 [ 7195 37794   932]
 [ 4141 38779  1521]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1453912
{'0': {'precision': 0.4723273310036281, 'recall': 0.20103500544739708, 'f1-score': 0.28203040895256576, 'support': 422220}, '1': {'precision': 0.2891782462161871, 'recall': 0.8203130061361049, 'f1-score': 0.4276134236476968, 'support': 324147}, '2': {'precision': 0.4338555890949164, 'recall': 0.045895507258129915, 'f1-score': 0.08300980441588325, 'support': 394592}, 'accuracy': 0.32331836639178096, 'macro avg': {'precision': 0.3984537221049105, 'recall': 0.35574783961387735, 'f1-score': 0.2642178790053819, 'support': 1140959}, 'weighted avg': {'precision': 0.4069894284411022, 'recall': 0.32331836639178096, 'f1-score': 0.25456084964241, 'support': 1140959}}
[[ 84881 323287  14052]
 [ 48665 265902   9580]
 [ 46162 330320  18110]]
Evaluating performance on  train set...
2425/2425 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1182358
{'0': {'precision': 0.44020349707152323, 'recall': 0.24960729176767188, 'f1-score': 0.3185743235926551, 'support': 206260}, '1': {'precision': 0.3379148851650132, 'recall': 0.7893443903963743, 'f1-score': 0.47323845510803736, 'support': 204756}, '2': {'precision': 0.4629026562561306, 'recall': 0.05625569208615255, 'f1-score': 0.10031971701642801, 'support': 209721}, 'accuracy': 0.3623193075328199, 'macro avg': {'precision': 0.41367367949755574, 'recall': 0.3650691247500662, 'f1-score': 0.2973774985723735, 'support': 620737}, 'weighted avg': {'precision': 0.4141317200449011, 'recall': 0.3623193075328199, 'f1-score': 0.2958526791068111, 'support': 620737}}
[[ 51484 147730   7046]
 [ 36490 161623   6643]
 [ 28981 168942  11798]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1221533
{'0': {'precision': 0.4539003113517152, 'recall': 0.23391153512575888, 'f1-score': 0.3087254724270493, 'support': 69180}, '1': {'precision': 0.325391194171682, 'recall': 0.7977974868361783, 'f1-score': 0.46224874117472364, 'support': 64381}, '2': {'precision': 0.46574277943271597, 'recall': 0.05314730790263224, 'f1-score': 0.09540739168501763, 'support': 67661}, 'accuracy': 0.35354484102135947, 'macro avg': {'precision': 0.41501142831870436, 'recall': 0.36161877662152314, 'f1-score': 0.28879386842893023, 'support': 201222}, 'weighted avg': {'precision': 0.41676584175922965, 'recall': 0.35354484102135947, 'f1-score': 0.2861169450501095, 'support': 201222}}
[[16182 50874  2124]
 [11017 51363  2001]
 [ 8452 55613  3596]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
4676/4676 - 41s - 41s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927219
{'0': {'precision': 0.45478333014231925, 'recall': 0.21781391368137915, 'f1-score': 0.2945540973442182, 'support': 392592}, '1': {'precision': 0.35936511273670174, 'recall': 0.8393902993859182, 'f1-score': 0.5032679502731772, 'support': 415417}, '2': {'precision': 0.43925789841384844, 'recall': 0.04364234665021338, 'f1-score': 0.07939629630495736, 'support': 388980}, 'accuracy': 0.376933288442918, 'macro avg': {'precision': 0.41780211376428983, 'recall': 0.36694885323917026, 'f1-score': 0.29240611464078425, 'support': 1196989}, 'weighted avg': {'precision': 0.41662305293531904, 'recall': 0.376933288442918, 'f1-score': 0.29706974384885415, 'support': 1196989}}
[[ 85512 296657  10423]
 [ 55472 348697  11248]
 [ 47044 324960  16976]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987685
{'0': {'precision': 0.44764114635044233, 'recall': 0.22300954794535774, 'f1-score': 0.2977056477789113, 'support': 179934}, '1': {'precision': 0.3510013760421156, 'recall': 0.8311619554953962, 'f1-score': 0.4935679906655647, 'support': 183217}, '2': {'precision': 0.42990889098334906, 'recall': 0.038818096199888796, 'f1-score': 0.07120667315387696, 'support': 176258}, 'accuracy': 0.3693894614290826, 'macro avg': {'precision': 0.409517137791969, 'recall': 0.3643298665468809, 'f1-score': 0.28749343719945103, 'support': 539409}, 'weighted avg': {'precision': 0.4090220267898236, 'recall': 0.3693894614290826, 'f1-score': 0.2902216321380982, 'support': 539409}}
[[ 40127 134977   4830]
 [ 26691 152283   4243]
 [ 22823 146593   6842]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1071192
{'0': {'precision': 0.44214726151614075, 'recall': 0.2462235431605373, 'f1-score': 0.3163035520670194, 'support': 69311}, '1': {'precision': 0.3328869708700895, 'recall': 0.8010292904920436, 'f1-score': 0.4703208220504636, 'support': 65482}, '2': {'precision': 0.45009345794392525, 'recall': 0.05204610951008645, 'f1-score': 0.09330319664191153, 'support': 69400}, 'accuracy': 0.35814645947706336, 'macro avg': {'precision': 0.40837589677671854, 'recall': 0.36643298105422245, 'f1-score': 0.2933091902531315, 'support': 204193}, 'weighted avg': {'precision': 0.4098096381892075, 'recall': 0.35814645947706336, 'f1-score': 0.28990271661503725, 'support': 204193}}
[[17066 49873  2372]
 [10988 52453  2041]
 [10544 55244  3612]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1165553
{'0': {'precision': 0.41559219308055845, 'recall': 0.3008951263023996, 'f1-score': 0.34906316425797795, 'support': 382851}, '1': {'precision': 0.3115075036618777, 'recall': 0.685655488517843, 'f1-score': 0.4283890021497374, 'support': 320715}, '2': {'precision': 0.4033059043018215, 'recall': 0.11459184274479577, 'f1-score': 0.17847371233936649, 'support': 390499}, 'accuracy': 0.34718778134754336, 'macro avg': {'precision': 0.37680186701475255, 'recall': 0.3670474858550128, 'f1-score': 0.31864195958236063, 'support': 1094065}, 'weighted avg': {'precision': 0.3806954505207286, 'recall': 0.34718778134754336, 'f1-score': 0.3114291806415473, 'support': 1094065}}
[[115198 230294  37359]
 [ 71969 219900  28846]
 [ 90023 255728  44748]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986155
{'0': {'precision': 0.4162816796034789, 'recall': 0.26856963575699433, 'f1-score': 0.3264960336816163, 'support': 165741}, '1': {'precision': 0.3490013690793013, 'recall': 0.7345954527753648, 'f1-score': 0.4731922677647295, 'support': 166915}, '2': {'precision': 0.41222824326950064, 'recall': 0.11106070124008283, 'f1-score': 0.17497926623076113, 'support': 171924}, 'accuracy': 0.3690633794442903, 'macro avg': {'precision': 0.3925037639840936, 'recall': 0.371408596590814, 'f1-score': 0.3248891892257023, 'support': 504580}, 'weighted avg': {'precision': 0.3926442464522918, 'recall': 0.3690633794442903, 'f1-score': 0.32339728459279393, 'support': 504580}}
[[ 44513 106860  14368]
 [ 31443 122615  12857]
 [ 30974 121856  19094]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027235
{'0': {'precision': 0.4138040042149631, 'recall': 0.2603852401949408, 'f1-score': 0.3196386057017276, 'support': 60326}, '1': {'precision': 0.34899576193108534, 'recall': 0.7204021895516711, 'f1-score': 0.4702034648389012, 'support': 60469}, '2': {'precision': 0.395036999944361, 'recall': 0.1184142497373205, 'f1-score': 0.18221013190987015, 'support': 59959}, 'accuracy': 0.3671841287053122, 'macro avg': {'precision': 0.3859455886968031, 'recall': 0.3664005598279774, 'f1-score': 0.324017400816833, 'support': 180754}, 'weighted avg': {'precision': 0.38589789750792014, 'recall': 0.3671841287053122, 'f1-score': 0.32442097625551763, 'support': 180754}}
[[15708 39012  5606]
 [11640 43562  5267]
 [10612 42247  7100]]
testing model on single stock: results/universal/W4/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
12724/12724 - 109s - 109s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0901566
{'0': {'precision': 0.30667928429688673, 'recall': 0.24892453592061303, 'f1-score': 0.2748001210293471, 'support': 886594}, '1': {'precision': 0.45030477962386456, 'recall': 0.678043623284492, 'f1-score': 0.5411915035666304, 'support': 1458533}, '2': {'precision': 0.32342342870200563, 'recall': 0.12104778403982369, 'f1-score': 0.176162992016672, 'support': 912020}, 'accuracy': 0.40527553714953607, 'macro avg': {'precision': 0.3601358308742523, 'recall': 0.3493386477483096, 'f1-score': 0.3307182055375498, 'support': 3257147}, 'weighted avg': {'precision': 0.37568246995479515, 'recall': 0.40527553714953607, 'f1-score': 0.3664697902042758, 'support': 3257147}}
[[220695 580142  85757]
 [324397 988949 145187]
 [174536 627086 110398]]
Evaluating performance on  train set...
5165/5165 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1333884
{'0': {'precision': 0.3529917633344163, 'recall': 0.210968391861424, 'f1-score': 0.26409704290236513, 'support': 437767}, '1': {'precision': 0.33215420117029404, 'recall': 0.6972855070922548, 'f1-score': 0.44996576047517745, 'support': 441961}, '2': {'precision': 0.36952195739677085, 'recall': 0.11081799563265472, 'f1-score': 0.17050292153589314, 'support': 442374}, 'accuracy': 0.34002747140538325, 'macro avg': {'precision': 0.3515559739671604, 'recall': 0.3396906315287778, 'f1-score': 0.2948552416378119, 'support': 1322102}, 'weighted avg': {'precision': 0.35155703156373774, 'recall': 0.34002747140538325, 'f1-score': 0.2949139681031636, 'support': 1322102}}
[[ 92355 303836  41576]
 [ 91721 308173  42067]
 [ 77559 315792  49023]]
Evaluating performance on  val set...
1903/1903 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1275434
{'0': {'precision': 0.35235628065920743, 'recall': 0.20066041407711527, 'f1-score': 0.2557027946993909, 'support': 159294}, '1': {'precision': 0.3466621316774809, 'recall': 0.7036667689475299, 'f1-score': 0.4644918786273517, 'support': 169468}, '2': {'precision': 0.36102346394354884, 'recall': 0.11930762522276571, 'f1-score': 0.1793465095401627, 'support': 158238}, 'accuracy': 0.34926488706365505, 'macro avg': {'precision': 0.35334729209341237, 'recall': 0.3412116027491369, 'f1-score': 0.2998470609556351, 'support': 487000}, 'weighted avg': {'precision': 0.35319098642699465, 'recall': 0.34926488706365505, 'f1-score': 0.3035479746256285, 'support': 487000}}
[[ 31964 111410  15920]
 [ 32725 119249  17494]
 [ 26026 113333  18879]]
training model: results/universal/W4/deepVOL_L3/h50
Epoch 1/50
9854/9854 - 563s - loss: 3.0180 - accuracy50: 0.4787 - val_loss: 3.7582 - val_accuracy50: 0.4438 - 563s/epoch - 57ms/step
Epoch 2/50
9854/9854 - 546s - loss: 2.9180 - accuracy50: 0.5080 - val_loss: 3.6222 - val_accuracy50: 0.4536 - 546s/epoch - 55ms/step
Epoch 3/50
9854/9854 - 538s - loss: 2.8909 - accuracy50: 0.5149 - val_loss: 3.4971 - val_accuracy50: 0.4629 - 538s/epoch - 55ms/step
Epoch 4/50
9854/9854 - 549s - loss: 2.8754 - accuracy50: 0.5186 - val_loss: 3.4722 - val_accuracy50: 0.4652 - 549s/epoch - 56ms/step
Epoch 5/50
9854/9854 - 550s - loss: 2.8654 - accuracy50: 0.5210 - val_loss: 3.3802 - val_accuracy50: 0.4714 - 550s/epoch - 56ms/step
Epoch 6/50
9854/9854 - 546s - loss: 2.8596 - accuracy50: 0.5226 - val_loss: 3.4735 - val_accuracy50: 0.4689 - 546s/epoch - 55ms/step
Epoch 7/50
9854/9854 - 545s - loss: 2.8534 - accuracy50: 0.5241 - val_loss: 3.4905 - val_accuracy50: 0.4669 - 545s/epoch - 55ms/step
Epoch 8/50
9854/9854 - 544s - loss: 2.8478 - accuracy50: 0.5252 - val_loss: 3.5205 - val_accuracy50: 0.4687 - 544s/epoch - 55ms/step
Epoch 9/50
9854/9854 - 530s - loss: 2.8442 - accuracy50: 0.5258 - val_loss: 3.5029 - val_accuracy50: 0.4671 - 530s/epoch - 54ms/step
Epoch 10/50
9854/9854 - 554s - loss: 2.8404 - accuracy50: 0.5268 - val_loss: 3.4799 - val_accuracy50: 0.4677 - 554s/epoch - 56ms/step
Epoch 11/50
9854/9854 - 549s - loss: 2.8375 - accuracy50: 0.5274 - val_loss: 3.4906 - val_accuracy50: 0.4688 - 549s/epoch - 56ms/step
Epoch 12/50
9854/9854 - 545s - loss: 2.8345 - accuracy50: 0.5283 - val_loss: 3.4753 - val_accuracy50: 0.4685 - 545s/epoch - 55ms/step
Epoch 13/50
9854/9854 - 548s - loss: 2.8322 - accuracy50: 0.5288 - val_loss: 3.4222 - val_accuracy50: 0.4709 - 548s/epoch - 56ms/step
Epoch 14/50
9854/9854 - 534s - loss: 2.8294 - accuracy50: 0.5298 - val_loss: 3.4204 - val_accuracy50: 0.4704 - 534s/epoch - 54ms/step
Epoch 15/50
9854/9854 - 560s - loss: 2.8277 - accuracy50: 0.5301 - val_loss: 3.4237 - val_accuracy50: 0.4713 - 560s/epoch - 57ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 687s - 687s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2105036
{'0': {'precision': 0.3622551896752953, 'recall': 0.6714979772273947, 'f1-score': 0.4706222624418525, 'support': 1599290}, '1': {'precision': 0.6286094869162856, 'recall': 0.38537834543682453, 'f1-score': 0.47782128397242457, 'support': 2866666}, '2': {'precision': 0.4266785414470092, 'recall': 0.3586416927460414, 'f1-score': 0.389712903603475, 'support': 1605675}, 'accuracy': 0.45367266225500197, 'macro avg': {'precision': 0.4725144060128634, 'recall': 0.4718393384700869, 'f1-score': 0.44605215000591736, 'support': 6071631}, 'weighted avg': {'precision': 0.5050490737586145, 'recall': 0.45367266225500197, 'f1-score': 0.4526243069505105, 'support': 6071631}}
[[1073920  293704  231666]
 [1219804 1104751  542111]
 [ 670816  358997  575862]]
Evaluating performance on  train set...
9854/9854 - 314s - 314s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1627074
{'0': {'precision': 0.4025522083589619, 'recall': 0.7218048126440839, 'f1-score': 0.5168538389608466, 'support': 773421}, '1': {'precision': 0.6098909932795267, 'recall': 0.42739952207753895, 'f1-score': 0.5025923117735942, 'support': 976309}, '2': {'precision': 0.49179898989451093, 'recall': 0.2872266729164859, 'f1-score': 0.36265246282486097, 'support': 772289}, 'accuracy': 0.47476049942526205, 'macro avg': {'precision': 0.5014140638443332, 'recall': 0.4788103358793696, 'f1-score': 0.4606995378531005, 'support': 2522019}, 'weighted avg': {'precision': 0.5101449859836822, 'recall': 0.47476049942526205, 'f1-score': 0.4641136796197221, 'support': 2522019}}
[[558259 123356  91806]
 [421621 417274 137414]
 [406919 143548 221822]]
Evaluating performance on  val set...
3566/3566 - 105s - 105s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1653858
{'0': {'precision': 0.39785026968015813, 'recall': 0.7141769569810221, 'f1-score': 0.511022550747, 'support': 274530}, '1': {'precision': 0.6178655057816259, 'recall': 0.42071119390718315, 'f1-score': 0.5005753252298856, 'support': 365020}, '2': {'precision': 0.4696783625730994, 'recall': 0.2944076656329499, 'f1-score': 0.3619406852605441, 'support': 272802}, 'accuracy': 0.4712501315281821, 'macro avg': {'precision': 0.49513137934496115, 'recall': 0.47643193884038504, 'f1-score': 0.45784618707914326, 'support': 912352}, 'weighted avg': {'precision': 0.5073527521421223, 'recall': 0.4712501315281821, 'f1-score': 0.4622658457398392, 'support': 912352}}
[[196063  43935  34532]
 [155299 153568  56153]
 [141444  51043  80315]]
testing model out of sample: results/universal/W4/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 353s - 353s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0890176
{'0': {'precision': 0.43179172631633594, 'recall': 0.6777119099973363, 'f1-score': 0.5274978575737816, 'support': 957305}, '1': {'precision': 0.5670434701698429, 'recall': 0.45785234430282434, 'f1-score': 0.506631363837607, 'support': 1144690}, '2': {'precision': 0.48534767951882524, 'recall': 0.31578007566312805, 'f1-score': 0.3826184424894102, 'support': 929647}, 'accuracy': 0.48371146725108044, 'macro avg': {'precision': 0.4947276253350013, 'recall': 0.4837814433210963, 'f1-score': 0.47224922130026625, 'support': 3031642}, 'weighted avg': {'precision': 0.4992830230784554, 'recall': 0.48371146725108044, 'f1-score': 0.47519208390070206, 'support': 3031642}}
[[648777 182588 125940]
 [435242 524099 185349]
 [418504 217579 293564]]
Evaluating performance on  train set...
5528/5528 - 174s - 174s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9980786
{'0': {'precision': 0.4318937479497489, 'recall': 0.6562658116874984, 'f1-score': 0.5209476837302893, 'support': 399230}, '1': {'precision': 0.6447051713172329, 'recall': 0.5981297443027617, 'f1-score': 0.6205447472133134, 'support': 613499}, '2': {'precision': 0.5183551013396018, 'recall': 0.3079318456196249, 'f1-score': 0.38635015022142827, 'support': 401735}, 'accuracy': 0.5321167594226506, 'macro avg': {'precision': 0.5316513402021945, 'recall': 0.5207758005366284, 'f1-score': 0.5092808603883436, 'support': 1414464}, 'weighted avg': {'precision': 0.5487536660732223, 'recall': 0.5321167594226506, 'f1-score': 0.5259178764857002, 'support': 1414464}}
[[262001  91030  46199]
 [177800 366952  68747]
 [166832 111196 123707]]
Evaluating performance on  val set...
1908/1908 - 57s - 57s/epoch - 30ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0217378
{'0': {'precision': 0.43658840395778986, 'recall': 0.6487124508482389, 'f1-score': 0.5219204099751632, 'support': 143179}, '1': {'precision': 0.6158449413002695, 'recall': 0.5714778886318914, 'f1-score': 0.592832476402425, 'support': 202769}, '2': {'precision': 0.5119073704604952, 'recall': 0.3133218982275586, 'f1-score': 0.3887205534635257, 'support': 141669}, 'accuracy': 0.5191533519134894, 'macro avg': {'precision': 0.5214469052395181, 'recall': 0.5111707459025631, 'f1-score': 0.5011578132803712, 'support': 487617}, 'weighted avg': {'precision': 0.533012506246818, 'recall': 0.5191533519134894, 'f1-score': 0.5127092428608958, 'support': 487617}}
[[ 92882  32820  17477]
 [ 62045 115878  24846]
 [ 57818  39463  44388]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2870651
{'0': {'precision': 0.38832760410219297, 'recall': 0.8136022663793792, 'f1-score': 0.5257282085328829, 'support': 50124}, '1': {'precision': 0.32185970636215333, 'recall': 0.10664000216198687, 'f1-score': 0.1602013681667783, 'support': 37003}, '2': {'precision': 0.434019714094029, 'recall': 0.1698063682435843, 'f1-score': 0.24410774410774408, 'support': 49527}, 'accuracy': 0.3888433562135027, 'macro avg': {'precision': 0.38140234151945845, 'recall': 0.3633495455949835, 'f1-score': 0.3100124402691351, 'support': 136654}, 'weighted avg': {'precision': 0.386889530657515, 'recall': 0.3888433562135027, 'f1-score': 0.3246846502349127, 'support': 136654}}
[[40781  3890  5453]
 [27543  3946  5514]
 [36693  4424  8410]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4879494
{'0': {'precision': 0.34081021325155125, 'recall': 0.8956468769036128, 'f1-score': 0.49374233128834366, 'support': 21341}, '1': {'precision': 0.4577985219758849, 'recall': 0.05390428211586902, 'f1-score': 0.09645169220683437, 'support': 21835}, '2': {'precision': 0.4004139468237542, 'recall': 0.11557904411764706, 'f1-score': 0.17938019328839913, 'support': 21760}, 'accuracy': 0.35120734261426634, 'macro avg': {'precision': 0.3996742273503968, 'recall': 0.3550434010457096, 'f1-score': 0.25652473892785904, 'support': 64936}, 'weighted avg': {'precision': 0.40012118041193934, 'recall': 0.35120734261426634, 'f1-score': 0.2548092090260616, 'support': 64936}}
[[19114   673  1554]
 [18446  1177  2212]
 [18524   721  2515]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3938532
{'0': {'precision': 0.365881480636514, 'recall': 0.881060293915671, 'f1-score': 0.5170468284033207, 'support': 7281}, '1': {'precision': 0.36434977578475336, 'recall': 0.052957471077073485, 'f1-score': 0.09247403613600796, 'support': 6137}, '2': {'precision': 0.4219890510948905, 'recall': 0.12849006806500904, 'f1-score': 0.1969971249068257, 'support': 7199}, 'accuracy': 0.3717805694329922, 'macro avg': {'precision': 0.3840734358387193, 'recall': 0.3541692776859178, 'f1-score': 0.2688393298153848, 'support': 20617}, 'weighted avg': {'precision': 0.38501706423522364, 'recall': 0.3717805694329922, 'f1-score': 0.27891125864943966, 'support': 20617}}
[[6415  270  596]
 [5141  325  671]
 [5977  297  925]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
1613/1613 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.68880206
{'0': {'precision': 0.5366843286075708, 'recall': 0.4708978457844109, 'f1-score': 0.5016434403676547, 'support': 71627}, '1': {'precision': 0.7661066325607834, 'recall': 0.8834055833631271, 'f1-score': 0.8205854677792076, 'support': 268512}, '2': {'precision': 0.6137995938382287, 'recall': 0.34086095447668824, 'f1-score': 0.43831352574985855, 'support': 72710}, 'accuracy': 0.7162860997604451, 'macro avg': {'precision': 0.6388635183355276, 'recall': 0.5650547945414087, 'f1-score': 0.5868474779655736, 'support': 412849}, 'weighted avg': {'precision': 0.6994791824500317, 'recall': 0.7162860997604451, 'f1-score': 0.6979259639355232, 'support': 412849}}
[[ 33729  32227   5671]
 [ 21384 237205   9923]
 [  7734  40192  24784]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77235734
{'0': {'precision': 0.5235197425943413, 'recall': 0.46048543390654323, 'f1-score': 0.4899836333878887, 'support': 32507}, '1': {'precision': 0.7300694053648471, 'recall': 0.8432586356320416, 'f1-score': 0.782592459605027, 'support': 96924}, '2': {'precision': 0.546529895573422, 'recall': 0.36110517478247595, 'f1-score': 0.4348769233597441, 'support': 32755}, 'accuracy': 0.6691637995881272, 'macro avg': {'precision': 0.6000396811775368, 'recall': 0.5549497481070204, 'f1-score': 0.5691510054508866, 'support': 162186}, 'weighted avg': {'precision': 0.6516030363138874, 'recall': 0.6691637995881272, 'f1-score': 0.6537203158715682, 'support': 162186}}
[[14969 14278  3260]
 [ 8638 81732  6554]
 [ 4986 15941 11828]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7224558
{'0': {'precision': 0.5291582878483194, 'recall': 0.4309780065512401, 'f1-score': 0.47504835589941974, 'support': 8548}, '1': {'precision': 0.7784112601491512, 'recall': 0.8670371105378051, 'f1-score': 0.8203374373005016, 'support': 35273}, '2': {'precision': 0.5178268251273345, 'recall': 0.3765854753619935, 'f1-score': 0.4360540681050169, 'support': 8909}, 'accuracy': 0.7134837853214488, 'macro avg': {'precision': 0.6084654577082683, 'recall': 0.5582001974836795, 'f1-score': 0.5771466204349794, 'support': 52730}, 'weighted avg': {'precision': 0.6939780885421557, 'recall': 0.7134837853214488, 'f1-score': 0.6994364017613585, 'support': 52730}}
[[ 3684  4074   790]
 [ 2356 30583  2334]
 [  922  4632  3355]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4875648
{'0': {'precision': 0.3107285856062421, 'recall': 0.6391344746029959, 'f1-score': 0.41815996352533197, 'support': 71032}, '1': {'precision': 0.47567161861379986, 'recall': 0.1586749317954208, 'f1-score': 0.23796822601737597, 'support': 115828}, '2': {'precision': 0.3316477589188872, 'recall': 0.3422680724258422, 'f1-score': 0.3368742323296237, 'support': 66109}, 'accuracy': 0.34156359079571014, 'macro avg': {'precision': 0.3726826543796431, 'recall': 0.38002582627475295, 'f1-score': 0.33100080729077724, 'support': 252969}, 'weighted avg': {'precision': 0.3917186170161186, 'recall': 0.34156359079571014, 'f1-score': 0.31441220401452785, 'support': 252969}}
[[45399 10921 14712]
 [66562 18379 30887]
 [34144  9338 22627]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3206893
{'0': {'precision': 0.37251327148908786, 'recall': 0.7240983948301022, 'f1-score': 0.49194490670254576, 'support': 28782}, '1': {'precision': 0.44416529498397295, 'recall': 0.1793723541965504, 'f1-score': 0.2555450331455914, 'support': 28583}, '2': {'precision': 0.4063615368465253, 'recall': 0.26534599170579565, 'f1-score': 0.3210516494225466, 'support': 29177}, 'accuracy': 0.38952185066210626, 'macro avg': {'precision': 0.40768003443986206, 'recall': 0.38960558024414943, 'f1-score': 0.35618052975689457, 'support': 86542}, 'weighted avg': {'precision': 0.4075901200237676, 'recall': 0.38952185066210626, 'f1-score': 0.35625159994355055, 'support': 86542}}
[[20841  3011  4930]
 [17076  5127  6380]
 [18030  3405  7742]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3695762
{'0': {'precision': 0.3619339622641509, 'recall': 0.7364430367597659, 'f1-score': 0.4853410923811632, 'support': 10419}, '1': {'precision': 0.37362637362637363, 'recall': 0.11857018308631212, 'f1-score': 0.18001323626737262, 'support': 10323}, '2': {'precision': 0.41524943310657597, 'recall': 0.2715477293790547, 'f1-score': 0.3283648996974112, 'support': 10790}, 'accuracy': 0.37507928453634404, 'macro avg': {'precision': 0.3836032563323668, 'recall': 0.3755203164083776, 'f1-score': 0.33123974278198237, 'support': 31532}, 'weighted avg': {'precision': 0.38400597459708224, 'recall': 0.37507928453634404, 'f1-score': 0.3316663309413451, 'support': 31532}}
[[7673  936 1810]
 [6783 1224 2316]
 [6744 1116 2930]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
925/925 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4909666
{'0': {'precision': 0.31504503222841135, 'recall': 0.7840112201963534, 'f1-score': 0.4494744278816692, 'support': 73439}, '1': {'precision': 0.5445885458510272, 'recall': 0.049976302069619255, 'f1-score': 0.09155106214667465, 'support': 94945}, '2': {'precision': 0.2949384162925945, 'recall': 0.19525691699604744, 'f1-score': 0.23496252190992925, 'support': 68310}, 'accuracy': 0.3196532231488758, 'macro avg': {'precision': 0.3848573314573444, 'recall': 0.3430814797540067, 'f1-score': 0.25866267064609105, 'support': 236694}, 'weighted avg': {'precision': 0.4013189807286843, 'recall': 0.3196532231488758, 'f1-score': 0.2439924880917353, 'support': 236694}}
[[57577  2101 13761]
 [72076  4745 18124]
 [53105  1867 13338]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3985852
{'0': {'precision': 0.3416986415016074, 'recall': 0.7611960001320088, 'f1-score': 0.4716672460685875, 'support': 30301}, '1': {'precision': 0.3173010380622837, 'recall': 0.03164578803878938, 'f1-score': 0.05755169925000784, 'support': 28977}, '2': {'precision': 0.3321414819296991, 'recall': 0.20613136692612316, 'f1-score': 0.25438688883739546, 'support': 29292}, 'accuracy': 0.3389409506604945, 'macro avg': {'precision': 0.33038038716453005, 'recall': 0.3329910516989738, 'f1-score': 0.2612019447186636, 'support': 88570}, 'weighted avg': {'precision': 0.33055584288986956, 'recall': 0.3389409506604945, 'f1-score': 0.26432387445090594, 'support': 88570}}
[[23065  1051  6185]
 [22104   917  5956]
 [22332   922  6038]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3885928
{'0': {'precision': 0.3374655080103785, 'recall': 0.7477641905457201, 'f1-score': 0.46505292431680817, 'support': 10958}, '1': {'precision': 0.29247675401521556, 'recall': 0.03287098612958389, 'f1-score': 0.059099837731659416, 'support': 10526}, '2': {'precision': 0.32540032319670925, 'recall': 0.20533976082321312, 'f1-score': 0.2517903830851427, 'support': 10787}, 'accuracy': 0.3332713581853677, 'macro avg': {'precision': 0.31844752840743445, 'recall': 0.32865831249950567, 'f1-score': 0.25864771504453676, 'support': 32271}, 'weighted avg': {'precision': 0.31875834761441507, 'recall': 0.3332713581853677, 'f1-score': 0.2613553251825622, 'support': 32271}}
[[8194  435 2329]
 [7917  346 2263]
 [8170  402 2215]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4988785
{'0': {'precision': 0.3274783897595978, 'recall': 0.7993764120349143, 'f1-score': 0.46461797883474815, 'support': 119951}, '1': {'precision': 0.4709768343169206, 'recall': 0.0631667237651951, 'f1-score': 0.11139351263515344, 'support': 169298}, '2': {'precision': 0.3700813221406086, 'recall': 0.2875511694664787, 'f1-score': 0.3236376497127618, 'support': 117746}, 'accuracy': 0.3450607501320655, 'macro avg': {'precision': 0.3895121820723757, 'recall': 0.38336476842219597, 'f1-score': 0.2998830470608878, 'support': 406995}, 'weighted avg': {'precision': 0.39949481389945246, 'recall': 0.3450607501320655, 'f1-score': 0.27690052404671295, 'support': 406995}}
[[ 95886   5640  18425]
 [119399  10694  39205]
 [ 77516   6372  33858]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4083626
{'0': {'precision': 0.363378883438449, 'recall': 0.8129913115432355, 'f1-score': 0.502263447839803, 'support': 45923}, '1': {'precision': 0.3974510266698135, 'recall': 0.07412787498624408, 'f1-score': 0.12495130683188337, 'support': 45435}, '2': {'precision': 0.4242939775433821, 'recall': 0.24233983286908078, 'f1-score': 0.30848519831780324, 'support': 46311}, 'accuracy': 0.37718004779580006, 'macro avg': {'precision': 0.39504129588388154, 'recall': 0.3764863397995201, 'f1-score': 0.31189998432982985, 'support': 137669}, 'weighted avg': {'precision': 0.39511519844626203, 'recall': 0.37718004779580006, 'f1-score': 0.3125530436071278, 'support': 137669}}
[[37335  2479  6109]
 [32948  3368  9119]
 [32461  2627 11223]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4828538
{'0': {'precision': 0.3505094330424609, 'recall': 0.8233610077297452, 'f1-score': 0.4916995777128106, 'support': 17465}, '1': {'precision': 0.3925515853044791, 'recall': 0.04179168452636091, 'f1-score': 0.07554113602246865, 'support': 18664}, '2': {'precision': 0.4034736138944556, 'recall': 0.2435063065138513, 'f1-score': 0.3037138136628116, 'support': 17363}, 'accuracy': 0.3624467210050101, 'macro avg': {'precision': 0.3821782107471319, 'recall': 0.36955299958998583, 'f1-score': 0.29031817579936364, 'support': 53492}, 'weighted avg': {'precision': 0.38237011878895555, 'recall': 0.3624467210050101, 'f1-score': 0.2854784983568569, 'support': 53492}}
[[14380   614  2471]
 [14104   780  3780]
 [12542   593  4228]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8199643
{'0': {'precision': 0.5049535362801993, 'recall': 0.554461768158045, 'f1-score': 0.5285508513812439, 'support': 222367}, '1': {'precision': 0.6841185915855982, 'recall': 0.7734496059162767, 'f1-score': 0.726046652182391, 'support': 507887}, '2': {'precision': 0.5951516610174024, 'recall': 0.3745130375518515, 'f1-score': 0.45973016590278226, 'support': 237698}, 'accuracy': 0.6251756285435641, 'macro avg': {'precision': 0.5947412629610666, 'recall': 0.5674748038753911, 'f1-score': 0.5714425564888056, 'support': 967952}, 'weighted avg': {'precision': 0.6211116890581024, 'recall': 0.6251756285435641, 'f1-score': 0.6152772701340672, 'support': 967952}}
[[123294  79629  19444]
 [ 73950 392825  41112]
 [ 46925 101752  89021]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8533014
{'0': {'precision': 0.5447919115918175, 'recall': 0.5208005538422809, 'f1-score': 0.5325261551473698, 'support': 111223}, '1': {'precision': 0.6139735428811981, 'recall': 0.7708158722193454, 'f1-score': 0.6835126652686192, 'support': 187321}, '2': {'precision': 0.6019866967503736, 'recall': 0.36946982231494135, 'f1-score': 0.4579019513880375, 'support': 111208}, 'accuracy': 0.5940251664421407, 'macro avg': {'precision': 0.5869173837411297, 'recall': 0.5536954161255225, 'f1-score': 0.5579802572680089, 'support': 409752}, 'weighted avg': {'precision': 0.5919416265966759, 'recall': 0.5940251664421407, 'f1-score': 0.5812974500056126, 'support': 409752}}
[[ 57925  42598  10700]
 [ 26465 144390  16466]
 [ 21935  48185  41088]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8211976
{'0': {'precision': 0.5339443312966734, 'recall': 0.5123171670515781, 'f1-score': 0.5229072227258991, 'support': 33774}, '1': {'precision': 0.6516146688560481, 'recall': 0.7922887731481482, 'f1-score': 0.7150990454551389, 'support': 69120}, '2': {'precision': 0.6097412480974125, 'recall': 0.3612914862914863, 'f1-score': 0.453732019481255, 'support': 33264}, 'accuracy': 0.6175472612699952, 'macro avg': {'precision': 0.598433416083378, 'recall': 0.5552991421637375, 'f1-score': 0.5639127625540977, 'support': 136158}, 'weighted avg': {'precision': 0.6121966732271055, 'recall': 0.6175472612699952, 'f1-score': 0.6035727350447875, 'support': 136158}}
[[17303 13731  2740]
 [ 9405 54763  4952]
 [ 5698 15548 12018]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
4457/4457 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90160054
{'0': {'precision': 0.5064654644936541, 'recall': 0.5784933745006803, 'f1-score': 0.5400885362518687, 'support': 321938}, '1': {'precision': 0.6186742889184449, 'recall': 0.7102726699992346, 'f1-score': 0.66131674571551, 'support': 509517}, '2': {'precision': 0.5387769409715214, 'recall': 0.32775666873449133, 'f1-score': 0.4075727320575508, 'support': 309504}, 'accuracy': 0.5693254534124363, 'macro avg': {'precision': 0.5546388981278735, 'recall': 0.5388409044114687, 'f1-score': 0.5363260046749765, 'support': 1140959}, 'weighted avg': {'precision': 0.565339477328692, 'recall': 0.5693254534124363, 'f1-score': 0.5582782013843827, 'support': 1140959}}
[[186239 100960  34739]
 [ 95520 361896  52101]
 [ 85964 122098 101442]]
Evaluating performance on  train set...
2425/2425 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8376123
{'0': {'precision': 0.47863963998956816, 'recall': 0.5802278964645106, 'f1-score': 0.524560555337645, 'support': 148664}, '1': {'precision': 0.6873923248903038, 'recall': 0.7630535759046136, 'f1-score': 0.7232495486656487, 'support': 323149}, '2': {'precision': 0.5686291288721547, 'recall': 0.3123405226827106, 'f1-score': 0.403205533836672, 'support': 148924}, 'accuracy': 0.6111348284378086, 'macro avg': {'precision': 0.5782203645840088, 'recall': 0.5518739983506116, 'f1-score': 0.5503385459466553, 'support': 620737}, 'weighted avg': {'precision': 0.6089038517496825, 'recall': 0.6111348284378086, 'f1-score': 0.598881039347685, 'support': 620737}}
[[ 86259  49536  12869]
 [ 54151 246580  22418]
 [ 39807  62602  46515]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8448455
{'0': {'precision': 0.5035323864058898, 'recall': 0.5421245421245421, 'f1-score': 0.5221163021581348, 'support': 49959}, '1': {'precision': 0.6627549594858899, 'recall': 0.7684967012252591, 'f1-score': 0.7117196983128982, 'support': 101856}, '2': {'precision': 0.5535854332185358, 'recall': 0.32859716234541664, 'f1-score': 0.4124012497777327, 'support': 49407}, 'accuracy': 0.6042828318971086, 'macro avg': {'precision': 0.5732909263701051, 'recall': 0.5464061352317393, 'f1-score': 0.5487457500829219, 'support': 201222}, 'weighted avg': {'precision': 0.5964185782115019, 'recall': 0.6042828318971086, 'f1-score': 0.5911522521326954, 'support': 201222}}
[[27084 18094  4781]
 [15269 78276  8311]
 [11435 21737 16235]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
4676/4676 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92661345
{'0': {'precision': 0.5161550377793936, 'recall': 0.5535172947667898, 'f1-score': 0.534183658862776, 'support': 353951}, '1': {'precision': 0.5618810236497382, 'recall': 0.7098891063808876, 'f1-score': 0.6272725052309346, 'support': 488396}, '2': {'precision': 0.5574886460048909, 'recall': 0.314976793498796, 'f1-score': 0.40252823362377754, 'support': 354642}, 'accuracy': 0.5466457920665938, 'macro avg': {'precision': 0.5451749024780076, 'recall': 0.5261277315488245, 'f1-score': 0.521328132572496, 'support': 1196989}, 'weighted avg': {'precision': 0.5470584312804531, 'recall': 0.5466457920665938, 'f1-score': 0.5331591522826941, 'support': 1196989}}
[[195918 120082  37951]
 [ 90974 346707  50715]
 [ 92680 150258 111704]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8965963
{'0': {'precision': 0.519684402184908, 'recall': 0.5650362307455427, 'f1-score': 0.5414122436198529, 'support': 159119}, '1': {'precision': 0.5907318882675308, 'recall': 0.7580938523099309, 'f1-score': 0.6640297547514569, 'support': 222669}, '2': {'precision': 0.5919528828270304, 'recall': 0.30288476789260316, 'f1-score': 0.400728582160649, 'support': 157621}, 'accuracy': 0.5681273393658616, 'macro avg': {'precision': 0.5674563910931564, 'recall': 0.5420049503160256, 'f1-score': 0.5353901935106529, 'support': 539409}, 'weighted avg': {'precision': 0.5701305439174774, 'recall': 0.5681273393658616, 'f1-score': 0.5509197215879661, 'support': 539409}}
[[ 89908  52435  16776]
 [ 37732 168804  16133]
 [ 45365  64515  47741]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9282508
{'0': {'precision': 0.5047010460336196, 'recall': 0.5863253790625098, 'f1-score': 0.5424598805713328, 'support': 63446}, '1': {'precision': 0.5590884525310755, 'recall': 0.7256065880396945, 'f1-score': 0.6315557414672199, 'support': 76988}, '2': {'precision': 0.6052080607170898, 'recall': 0.2901551153562634, 'f1-score': 0.39225248338227653, 'support': 63759}, 'accuracy': 0.5463605510472935, 'macro avg': {'precision': 0.556332519760595, 'recall': 0.5340290274861559, 'f1-score': 0.5220893684736098, 'support': 204193}, 'weighted avg': {'precision': 0.5565902116790116, 'recall': 0.5463605510472935, 'f1-score': 0.5291501133475569, 'support': 204193}}
[[37200 19932  6314]
 [15371 55863  5754]
 [21136 24123 18500]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
4274/4274 - 63s - 63s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0152725
{'0': {'precision': 0.47455472460804593, 'recall': 0.7110713742200578, 'f1-score': 0.5692220852816903, 'support': 394260}, '1': {'precision': 0.4859655322796517, 'recall': 0.4129163951393414, 'f1-score': 0.4464727338040039, 'support': 313044}, '2': {'precision': 0.535397502939082, 'recall': 0.3285232999190715, 'f1-score': 0.40719138571977953, 'support': 386761}, 'accuracy': 0.4905266140494395, 'macro avg': {'precision': 0.4986392532755932, 'recall': 0.48417035642615697, 'f1-score': 0.4742954016018246, 'support': 1094065}, 'weighted avg': {'precision': 0.4993281143671918, 'recall': 0.4905266140494395, 'f1-score': 0.47682071664523357, 'support': 1094065}}
[[280347  61050  52863]
 [126387 129261  57396]
 [184024  75677 127060]]
Evaluating performance on  train set...
1972/1972 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9643833
{'0': {'precision': 0.46479266027292365, 'recall': 0.6363706963499871, 'f1-score': 0.5372144416126485, 'support': 154520}, '1': {'precision': 0.5882509204703033, 'recall': 0.5692632791251279, 'f1-score': 0.5786013649808212, 'support': 194497}, '2': {'precision': 0.5312309160305344, 'recall': 0.357880729993636, 'f1-score': 0.4276567715074723, 'support': 155563}, 'accuracy': 0.5246442585913037, 'macro avg': {'precision': 0.5280914989245872, 'recall': 0.5211715684895837, 'f1-score': 0.5144908593669807, 'support': 504580}, 'weighted avg': {'precision': 0.5328643151423813, 'recall': 0.5246442585913037, 'f1-score': 0.5193907319923068, 'support': 504580}}
[[ 98332  35486  20702]
 [ 55352 110720  28425]
 [ 57877  42013  55673]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97911555
{'0': {'precision': 0.47000744921278237, 'recall': 0.6412195332012747, 'f1-score': 0.5424237567209197, 'support': 58055}, '1': {'precision': 0.5518093005080109, 'recall': 0.5365942634786971, 'f1-score': 0.5440954347893098, 'support': 65789}, '2': {'precision': 0.5294602938045561, 'recall': 0.34958706729924444, 'f1-score': 0.4211205892936519, 'support': 56910}, 'accuracy': 0.5113192515794948, 'macro avg': {'precision': 0.5170923478417832, 'recall': 0.5091336213264054, 'f1-score': 0.5025465936012937, 'support': 180754}, 'weighted avg': {'precision': 0.5184994514953302, 'recall': 0.5113192515794948, 'f1-score': 0.5048401611720273, 'support': 180754}}
[[37226 12990  7839]
 [20645 35302  9842]
 [21332 15683 19895]]
testing model on single stock: results/universal/W4/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
12724/12724 - 179s - 179s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4766326
{'0': {'precision': 0.316641633092413, 'recall': 0.7559283112314986, 'f1-score': 0.44632683627921305, 'support': 877906}, '1': {'precision': 0.4975204083275637, 'recall': 0.08201995320274519, 'f1-score': 0.14082401612438286, 'support': 1506926}, '2': {'precision': 0.36895517090660523, 'recall': 0.38610708287717166, 'f1-score': 0.37733631640919524, 'support': 872315}, 'accuracy': 0.34509925404042247, 'macro avg': {'precision': 0.3943724041088606, 'recall': 0.4080184491038052, 'f1-score': 0.32149572293759704, 'support': 3257147}, 'weighted avg': {'precision': 0.41433596896008856, 'recall': 0.34509925404042247, 'f1-score': 0.2865085633842371, 'support': 3257147}}
[[663634  59821 154451]
 [961719 123598 421609]
 [470499  65009 336807]]
Evaluating performance on  train set...
5165/5165 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.399214
{'0': {'precision': 0.3683844217677659, 'recall': 0.846355994376191, 'f1-score': 0.5133349635104372, 'support': 440271}, '1': {'precision': 0.4472889400258881, 'recall': 0.04943031392904014, 'f1-score': 0.0890226523189031, 'support': 440418}, '2': {'precision': 0.4397614511467373, 'recall': 0.2609370362902769, 'f1-score': 0.32753046222967885, 'support': 441413}, 'accuracy': 0.38542941467451075, 'macro avg': {'precision': 0.41847827098013046, 'recall': 0.3855744481985027, 'f1-score': 0.3099626926863397, 'support': 1322102}, 'weighted avg': {'precision': 0.4184998582404931, 'recall': 0.38542941467451075, 'f1-score': 0.30995330173684, 'support': 1322102}}
[[372626  12985  54660]
 [326572  21770  92076]
 [312316  13916 115181]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3940372
{'0': {'precision': 0.3650762359117049, 'recall': 0.8214747408177232, 'f1-score': 0.5055002476183791, 'support': 157804}, '1': {'precision': 0.4937806873977087, 'recall': 0.0697116912074772, 'f1-score': 0.12217480878549047, 'support': 173113}, '2': {'precision': 0.41198198701129535, 'recall': 0.2836888065964903, 'f1-score': 0.3360057064588463, 'support': 156083}, 'accuracy': 0.3818870636550308, 'macro avg': {'precision': 0.42361297010690296, 'recall': 0.3916250795405636, 'f1-score': 0.3212269209542386, 'support': 487000}, 'weighted avg': {'precision': 0.42585981714163085, 'recall': 0.3818870636550308, 'f1-score': 0.31491742798700084, 'support': 487000}}
[[129632   5899  22273]
 [120119  12068  40926]
 [105331   6473  44279]]
training model: results/universal/W4/deepVOL_L3/h100
Epoch 1/50
9854/9854 - 545s - loss: 3.1983 - accuracy100: 0.4174 - val_loss: 3.3984 - val_accuracy100: 0.3968 - 545s/epoch - 55ms/step
Epoch 2/50
9854/9854 - 565s - loss: 3.1237 - accuracy100: 0.4420 - val_loss: 3.6061 - val_accuracy100: 0.4056 - 565s/epoch - 57ms/step
Epoch 3/50
9854/9854 - 531s - loss: 3.1051 - accuracy100: 0.4475 - val_loss: 3.5590 - val_accuracy100: 0.4089 - 531s/epoch - 54ms/step
Epoch 4/50
9854/9854 - 528s - loss: 3.0956 - accuracy100: 0.4513 - val_loss: 3.4851 - val_accuracy100: 0.4085 - 528s/epoch - 54ms/step
Epoch 5/50
9854/9854 - 529s - loss: 3.0901 - accuracy100: 0.4534 - val_loss: 3.4479 - val_accuracy100: 0.4091 - 529s/epoch - 54ms/step
Epoch 6/50
9854/9854 - 547s - loss: 3.0861 - accuracy100: 0.4551 - val_loss: 3.4153 - val_accuracy100: 0.4086 - 547s/epoch - 55ms/step
Epoch 7/50
9854/9854 - 560s - loss: 3.0816 - accuracy100: 0.4569 - val_loss: 3.4477 - val_accuracy100: 0.4158 - 560s/epoch - 57ms/step
Epoch 8/50
9854/9854 - 544s - loss: 3.0776 - accuracy100: 0.4580 - val_loss: 3.4145 - val_accuracy100: 0.4133 - 544s/epoch - 55ms/step
Epoch 9/50
9854/9854 - 556s - loss: 3.0740 - accuracy100: 0.4593 - val_loss: 3.4344 - val_accuracy100: 0.4158 - 556s/epoch - 56ms/step
Epoch 10/50
9854/9854 - 536s - loss: 3.0704 - accuracy100: 0.4606 - val_loss: 3.3936 - val_accuracy100: 0.4143 - 536s/epoch - 54ms/step
Epoch 11/50
9854/9854 - 544s - loss: 3.0677 - accuracy100: 0.4616 - val_loss: 3.3818 - val_accuracy100: 0.4115 - 544s/epoch - 55ms/step
Epoch 12/50
9854/9854 - 553s - loss: 3.0659 - accuracy100: 0.4623 - val_loss: 3.3883 - val_accuracy100: 0.4140 - 553s/epoch - 56ms/step
Epoch 13/50
9854/9854 - 532s - loss: 3.0633 - accuracy100: 0.4630 - val_loss: 3.4216 - val_accuracy100: 0.4136 - 532s/epoch - 54ms/step
Epoch 14/50
9854/9854 - 529s - loss: 3.0616 - accuracy100: 0.4635 - val_loss: 3.3774 - val_accuracy100: 0.4150 - 529s/epoch - 54ms/step
Epoch 15/50
9854/9854 - 548s - loss: 3.0593 - accuracy100: 0.4643 - val_loss: 3.3480 - val_accuracy100: 0.4097 - 548s/epoch - 56ms/step
Epoch 16/50
9854/9854 - 555s - loss: 3.0580 - accuracy100: 0.4648 - val_loss: 3.3988 - val_accuracy100: 0.4132 - 555s/epoch - 56ms/step
Epoch 17/50
9854/9854 - 565s - loss: 3.0564 - accuracy100: 0.4654 - val_loss: 3.3543 - val_accuracy100: 0.4144 - 565s/epoch - 57ms/step
Epoch 18/50
9854/9854 - 556s - loss: 3.0545 - accuracy100: 0.4661 - val_loss: 3.3714 - val_accuracy100: 0.4154 - 556s/epoch - 56ms/step
Epoch 19/50
9854/9854 - 558s - loss: 3.0530 - accuracy100: 0.4663 - val_loss: 3.3316 - val_accuracy100: 0.4115 - 558s/epoch - 57ms/step
Epoch 20/50
9854/9854 - 556s - loss: 3.0515 - accuracy100: 0.4670 - val_loss: 3.3307 - val_accuracy100: 0.4156 - 556s/epoch - 56ms/step
Epoch 21/50
9854/9854 - 548s - loss: 3.0497 - accuracy100: 0.4675 - val_loss: 3.3329 - val_accuracy100: 0.4116 - 548s/epoch - 56ms/step
Epoch 22/50
9854/9854 - 550s - loss: 3.0487 - accuracy100: 0.4679 - val_loss: 3.3885 - val_accuracy100: 0.4158 - 550s/epoch - 56ms/step
Epoch 23/50
9854/9854 - 556s - loss: 3.0471 - accuracy100: 0.4685 - val_loss: 3.3639 - val_accuracy100: 0.4151 - 556s/epoch - 56ms/step
Epoch 24/50
9854/9854 - 556s - loss: 3.0458 - accuracy100: 0.4688 - val_loss: 3.3627 - val_accuracy100: 0.4172 - 556s/epoch - 56ms/step
Epoch 25/50
9854/9854 - 554s - loss: 3.0445 - accuracy100: 0.4697 - val_loss: 3.3205 - val_accuracy100: 0.4182 - 554s/epoch - 56ms/step
Epoch 26/50
9854/9854 - 564s - loss: 3.0434 - accuracy100: 0.4700 - val_loss: 3.3589 - val_accuracy100: 0.4170 - 564s/epoch - 57ms/step
Epoch 27/50
9854/9854 - 576s - loss: 3.0423 - accuracy100: 0.4701 - val_loss: 3.3911 - val_accuracy100: 0.4182 - 576s/epoch - 58ms/step
Epoch 28/50
9854/9854 - 558s - loss: 3.0413 - accuracy100: 0.4705 - val_loss: 3.4152 - val_accuracy100: 0.4204 - 558s/epoch - 57ms/step
Epoch 29/50
9854/9854 - 568s - loss: 3.0399 - accuracy100: 0.4709 - val_loss: 3.3796 - val_accuracy100: 0.4193 - 568s/epoch - 58ms/step
Epoch 30/50
9854/9854 - 549s - loss: 3.0391 - accuracy100: 0.4709 - val_loss: 3.4089 - val_accuracy100: 0.4194 - 549s/epoch - 56ms/step
Epoch 31/50
9854/9854 - 552s - loss: 3.0371 - accuracy100: 0.4717 - val_loss: 3.4649 - val_accuracy100: 0.4197 - 552s/epoch - 56ms/step
Epoch 32/50
9854/9854 - 573s - loss: 3.0363 - accuracy100: 0.4721 - val_loss: 3.4496 - val_accuracy100: 0.4195 - 573s/epoch - 58ms/step
Epoch 33/50
9854/9854 - 542s - loss: 3.0352 - accuracy100: 0.4725 - val_loss: 3.4714 - val_accuracy100: 0.4184 - 542s/epoch - 55ms/step
Epoch 34/50
9854/9854 - 546s - loss: 3.0338 - accuracy100: 0.4729 - val_loss: 3.5098 - val_accuracy100: 0.4195 - 546s/epoch - 55ms/step
Epoch 35/50
9854/9854 - 556s - loss: 3.0325 - accuracy100: 0.4736 - val_loss: 3.4521 - val_accuracy100: 0.4220 - 556s/epoch - 56ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 699s - 699s/epoch - 29ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1323577
{'0': {'precision': 0.3755234311132534, 'recall': 0.49623425204932814, 'f1-score': 0.4275215293530809, 'support': 1802298}, '1': {'precision': 0.46895283536736626, 'recall': 0.3606093423746057, 'f1-score': 0.40770608425480187, 'support': 2437710}, '2': {'precision': 0.386880319211929, 'recall': 0.38346865048102147, 'f1-score': 0.3851669301641252, 'support': 1831623}, 'accuracy': 0.40776407525424385, 'macro avg': {'precision': 0.4104521952308495, 'recall': 0.41343741496831843, 'f1-score': 0.406798181257336, 'support': 6071631}, 'weighted avg': {'precision': 0.41646059124275636, 'recall': 0.40776407525424385, 'f1-score': 0.40678872021155066, 'support': 6071631}}
[[894362 460568 447368]
 [892916 879061 665733]
 [594363 534890 702370]]
Evaluating performance on  train set...
9854/9854 - 302s - 302s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038523
{'0': {'precision': 0.4048263165870606, 'recall': 0.5175741890422788, 'f1-score': 0.4543094918786136, 'support': 836141}, '1': {'precision': 0.44273408513367596, 'recall': 0.3841634378302219, 'f1-score': 0.41137442903429, 'support': 851700}, '2': {'precision': 0.4130821774870129, 'recall': 0.35356003155201887, 'f1-score': 0.3810104530742037, 'support': 834178}, 'accuracy': 0.41827163078470064, 'macro avg': {'precision': 0.42021419306924984, 'recall': 0.41843255280817315, 'f1-score': 0.41556479132903573, 'support': 2522019}, 'weighted avg': {'precision': 0.42035867538568694, 'recall': 0.41827163078470064, 'f1-score': 0.41556583506385714, 'support': 2522019}}
[[432765 195569 207807]
 [313268 327192 211240]
 [322981 216265 294932]]
Evaluating performance on  val set...
3566/3566 - 107s - 107s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.108521
{'0': {'precision': 0.40288914394269204, 'recall': 0.5114586403708566, 'f1-score': 0.4507281306222207, 'support': 298552}, '1': {'precision': 0.4494963265366278, 'recall': 0.38518443677558484, 'f1-score': 0.41486277623710527, 'support': 316721}, '2': {'precision': 0.4053202820482475, 'recall': 0.3573796868846334, 'f1-score': 0.3798432971986691, 'support': 297079}, 'accuracy': 0.41745181684262217, 'macro avg': {'precision': 0.4192352508425225, 'recall': 0.41800758801035826, 'f1-score': 0.4151447346859984, 'support': 912352}, 'weighted avg': {'precision': 0.41986034974439385, 'recall': 0.41745181684262217, 'f1-score': 0.41519611410354873, 'support': 912352}}
[[152697  71653  74202]
 [113156 121996  81569]
 [113152  77757 106170]]
testing model out of sample: results/universal/W4/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 360s - 360s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883762
{'0': {'precision': 0.44023748621559594, 'recall': 0.47392991482350366, 'f1-score': 0.4564628187509543, 'support': 1059682}, '1': {'precision': 0.4139890188589162, 'recall': 0.4242420374713487, 'f1-score': 0.4190528220712261, 'support': 940185}, '2': {'precision': 0.4226937965688653, 'recall': 0.37992973274211916, 'f1-score': 0.4001725224776882, 'support': 1031775}, 'accuracy': 0.42652892392967245, 'macro avg': {'precision': 0.4256401005477925, 'recall': 0.42603389501232386, 'f1-score': 0.4252293877666229, 'support': 3031642}, 'weighted avg': {'precision': 0.42612646794002274, 'recall': 0.42652892392967245, 'f1-score': 0.4257035014682147, 'support': 3031642}}
[[502215 269944 287523]
 [293454 398866 247865]
 [345113 294660 392002]]
Evaluating performance on  train set...
5528/5528 - 166s - 166s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0451804
{'0': {'precision': 0.43392208157757484, 'recall': 0.4651553372425559, 'f1-score': 0.44899619981132904, 'support': 450729}, '1': {'precision': 0.4867914277508054, 'recall': 0.5552912987356462, 'f1-score': 0.5187899909645775, 'support': 506662}, '2': {'precision': 0.447593495106613, 'recall': 0.3460059990417286, 'f1-score': 0.3902977146051305, 'support': 457073}, 'accuracy': 0.45893992353287183, 'macro avg': {'precision': 0.4561023348116644, 'recall': 0.4554842116733102, 'f1-score': 0.4526946351270123, 'support': 1414464}, 'weighted avg': {'precision': 0.45727772913508036, 'recall': 0.45893992353287183, 'f1-score': 0.45502842762669543, 'support': 1414464}}
[[209659 138517 102553]
 [132686 281345  92631]
 [140827 158096 158150]]
Evaluating performance on  val set...
1908/1908 - 58s - 58s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0595224
{'0': {'precision': 0.44039288577884683, 'recall': 0.44992273847127673, 'f1-score': 0.44510680881237935, 'support': 161141}, '1': {'precision': 0.4587294401690056, 'recall': 0.525162028211971, 'f1-score': 0.489702962047465, 'support': 167872}, '2': {'precision': 0.4365931226396343, 'recall': 0.36007288592973696, 'f1-score': 0.3946580975087246, 'support': 158604}, 'accuracy': 0.4466005081857277, 'macro avg': {'precision': 0.44523848286249557, 'recall': 0.4450525508709949, 'f1-score': 0.44315595612285635, 'support': 487617}, 'weighted avg': {'precision': 0.4454696907828829, 'recall': 0.4466005081857277, 'f1-score': 0.4440508120531922, 'support': 487617}}
[[72501 49656 38984]
 [44999 88160 34713]
 [47128 54367 57109]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1383005
{'0': {'precision': 0.3987099581504281, 'recall': 0.6051553000135973, 'f1-score': 0.4807048403771081, 'support': 51481}, '1': {'precision': 0.25726552179656537, 'recall': 0.11738999397227246, 'f1-score': 0.16121688741721854, 'support': 33180}, '2': {'precision': 0.39260437559075084, 'recall': 0.32754409247398686, 'f1-score': 0.35713536751599034, 'support': 51993}, 'accuracy': 0.38110117523087506, 'macro avg': {'precision': 0.34952661851258143, 'recall': 0.3500297954866189, 'f1-score': 0.33301903177010567, 'support': 136654}, 'weighted avg': {'precision': 0.36204382358981174, 'recall': 0.38110117523087506, 'f1-score': 0.35611750387998964, 'support': 136654}}
[[31154  5046 15281]
 [18219  3895 11066]
 [28764  6199 17030]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1876892
{'0': {'precision': 0.3451045262754123, 'recall': 0.6661267931513188, 'f1-score': 0.4546603076339976, 'support': 21610}, '1': {'precision': 0.3595378341640236, 'recall': 0.07434996486296556, 'f1-score': 0.12321906906324002, 'support': 21345}, '2': {'precision': 0.34720893141945774, 'recall': 0.29712024020745187, 'f1-score': 0.32021769507979697, 'support': 21981}, 'accuracy': 0.34669520758901073, 'macro avg': {'precision': 0.35061709728629786, 'recall': 0.34586566607391206, 'f1-score': 0.2993656905923449, 'support': 64936}, 'weighted avg': {'precision': 0.35056122034886417, 'recall': 0.34669520758901073, 'f1-score': 0.3002036687303586, 'support': 64936}}
[[14395  1439  5776]
 [13255  1587  6503]
 [14062  1388  6531]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1763754
{'0': {'precision': 0.35749330954504904, 'recall': 0.6656976744186046, 'f1-score': 0.4651770168311085, 'support': 7224}, '1': {'precision': 0.3201417601890136, 'recall': 0.08431860609831986, 'f1-score': 0.13348109838689817, 'support': 6428}, '2': {'precision': 0.3572733918128655, 'recall': 0.28068916008614503, 'f1-score': 0.3143844978692611, 'support': 6965}, 'accuracy': 0.3543677547654848, 'macro avg': {'precision': 0.3449694871823094, 'recall': 0.3435684802010232, 'f1-score': 0.3043475376957559, 'support': 20617}, 'weighted avg': {'precision': 0.3457734916149305, 'recall': 0.3543677547654848, 'f1-score': 0.3108184167278611, 'support': 20617}}
[[4809  605 1810]
 [4179  542 1707]
 [4464  546 1955]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
1613/1613 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.89541364
{'0': {'precision': 0.5485802155803051, 'recall': 0.36397044256904, 'f1-score': 0.4376019721563911, 'support': 100956}, '1': {'precision': 0.6002814397866982, 'recall': 0.8500019067958203, 'f1-score': 0.7036423187719507, 'support': 209776}, '2': {'precision': 0.5829629477910001, 'recall': 0.27871950801531575, 'f1-score': 0.377129985424672, 'support': 102117}, 'accuracy': 0.5898451976388461, 'macro avg': {'precision': 0.5772748677193346, 'recall': 0.49756395246005863, 'f1-score': 0.5061247587843379, 'support': 412849}, 'weighted avg': {'precision': 0.5833550060588575, 'recall': 0.5898451976388461, 'f1-score': 0.5578242855991817, 'support': 412849}}
[[ 36745  54296   9915]
 [ 21020 178310  10446]
 [  9217  64438  28462]]
Evaluating performance on  train set...
634/634 - 13s - 13s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93983895
{'0': {'precision': 0.5516983949234789, 'recall': 0.333769929090827, 'f1-score': 0.4159162539396668, 'support': 44282}, '1': {'precision': 0.5596026795175394, 'recall': 0.825331249575321, 'f1-score': 0.6669741697416974, 'support': 73585}, '2': {'precision': 0.510737280881313, 'recall': 0.3096414630294005, 'f1-score': 0.38554250716412874, 'support': 44319}, 'accuracy': 0.5502016203618069, 'macro avg': {'precision': 0.5406794517741105, 'recall': 0.48958088056518284, 'f1-score': 0.48947764361516427, 'support': 162186}, 'weighted avg': {'precision': 0.5440915803317089, 'recall': 0.5502016203618069, 'f1-score': 0.5215231660710922, 'support': 162186}}
[[14780 22730  6772]
 [ 6479 60732  6374]
 [ 5531 25065 13723]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9077528
{'0': {'precision': 0.5496428050736258, 'recall': 0.30541153596889176, 'f1-score': 0.39264698224235794, 'support': 12344}, '1': {'precision': 0.610911162321017, 'recall': 0.8537414965986394, 'f1-score': 0.7121964471678464, 'support': 27636}, '2': {'precision': 0.5060689655172413, 'recall': 0.2877647058823529, 'f1-score': 0.36689999999999995, 'support': 12750}, 'accuracy': 0.5885264555281623, 'macro avg': {'precision': 0.5555409776372947, 'recall': 0.48230591281662805, 'f1-score': 0.4905811431367348, 'support': 52730}, 'weighted avg': {'precision': 0.5712177314257024, 'recall': 0.5885264555281623, 'f1-score': 0.5538985466097148, 'support': 52730}}
[[ 3770  7062  1512]
 [ 1973 23594  2069]
 [ 1116  7965  3669]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
989/989 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.225292
{'0': {'precision': 0.3611467775627144, 'recall': 0.45614629600493783, 'f1-score': 0.4031253175320474, 'support': 82627}, '1': {'precision': 0.37685696746470226, 'recall': 0.19639562783257797, 'f1-score': 0.2582214588664166, 'support': 93775}, '2': {'precision': 0.3264485597120427, 'recall': 0.4252354147348074, 'f1-score': 0.369350667029676, 'support': 76567}, 'accuracy': 0.3505014448410675, 'macro avg': {'precision': 0.35481743491315304, 'recall': 0.3592591128574411, 'f1-score': 0.34356581447604667, 'support': 252969}, 'weighted avg': {'precision': 0.35646827787258056, 'recall': 0.3505014448410675, 'f1-score': 0.33918711557297493, 'support': 252969}}
[[37690 16144 28793]
 [36973 18417 38385]
 [29699 14309 32559]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1957799
{'0': {'precision': 0.3679758458928037, 'recall': 0.5100473835299001, 'f1-score': 0.4275174303149778, 'support': 28913}, '1': {'precision': 0.3796383024713596, 'recall': 0.185868491604346, 'f1-score': 0.2495559712979847, 'support': 28348}, '2': {'precision': 0.3579341455181514, 'recall': 0.3983470509886957, 'f1-score': 0.37706083920605155, 'support': 29281}, 'accuracy': 0.3660650320075801, 'macro avg': {'precision': 0.36851609796077156, 'recall': 0.36475430870764725, 'f1-score': 0.35137808027300466, 'support': 86542}, 'weighted avg': {'precision': 0.36839848796738833, 'recall': 0.3660650320075801, 'f1-score': 0.35215204836778236, 'support': 86542}}
[[14747  4142 10024]
 [12180  5269 10899]
 [13149  4468 11664]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2036774
{'0': {'precision': 0.36182549969302136, 'recall': 0.5073656016835661, 'f1-score': 0.4224107036196393, 'support': 10454}, '1': {'precision': 0.32770745428973275, 'recall': 0.13668361360969886, 'f1-score': 0.19290740996274316, 'support': 10228}, '2': {'precision': 0.3603553581343698, 'recall': 0.41870967741935483, 'f1-score': 0.38734706057893165, 'support': 10850}, 'accuracy': 0.35662184447545353, 'macro avg': {'precision': 0.34996277070570797, 'recall': 0.35425296423754, 'f1-score': 0.33422172472043804, 'support': 31532}, 'weighted avg': {'precision': 0.35025279880832627, 'recall': 0.35662184447545353, 'f1-score': 0.33590175352086943, 'support': 31532}}
[[5304 1353 3797]
 [4563 1398 4267]
 [4792 1515 4543]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
925/925 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2597097
{'0': {'precision': 0.3150900465896297, 'recall': 0.9015878578745888, 'f1-score': 0.46697874449762106, 'support': 74188}, '1': {'precision': 0.36830553116769094, 'recall': 0.018130740140464615, 'f1-score': 0.03456017135913332, 'support': 92550}, '2': {'precision': 0.3028853416586938, 'recall': 0.0859826176453771, 'f1-score': 0.1339419918721817, 'support': 69956}, 'accuracy': 0.3150903698446095, 'macro avg': {'precision': 0.3287603064720048, 'recall': 0.3352337385534769, 'f1-score': 0.2118269692429787, 'support': 236694}, 'weighted avg': {'precision': 0.33229073929646225, 'recall': 0.3150903698446095, 'f1-score': 0.19946770488262333, 'support': 236694}}
[[66887  1572  5729]
 [82757  1678  8115]
 [62635  1306  6015]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2083722
{'0': {'precision': 0.34171531779041225, 'recall': 0.8856144514767933, 'f1-score': 0.4931486733298457, 'support': 30336}, '1': {'precision': 0.31444906444906445, 'recall': 0.020819711621184487, 'f1-score': 0.03905367459574605, 'support': 29059}, '2': {'precision': 0.3380685358255452, 'recall': 0.09299057412167952, 'f1-score': 0.14586021505376343, 'support': 29175}, 'accuracy': 0.34079259342892626, 'macro avg': {'precision': 0.33141097268834063, 'recall': 0.3331415790732191, 'f1-score': 0.22602085432645172, 'support': 88570}, 'weighted avg': {'precision': 0.33156825987383526, 'recall': 0.34079259342892626, 'f1-score': 0.22976731013216137, 'support': 88570}}
[[26866   696  2774]
 [25916   605  2538]
 [25839   623  2713]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2043967
{'0': {'precision': 0.3379471445505892, 'recall': 0.8812619329029912, 'f1-score': 0.4885461555908369, 'support': 10999}, '1': {'precision': 0.28957528957528955, 'recall': 0.0224730323611666, 'f1-score': 0.041709148206506626, 'support': 10012}, '2': {'precision': 0.36415362731152207, 'recall': 0.09094138543516873, 'f1-score': 0.14553723706651506, 'support': 11260}, 'accuracy': 0.33906603452015743, 'macro avg': {'precision': 0.3305586871458002, 'recall': 0.33155878356644214, 'f1-score': 0.22526418028795284, 'support': 32271}, 'weighted avg': {'precision': 0.33208386122733935, 'recall': 0.33906603452015743, 'f1-score': 0.2302333502697815, 'support': 32271}}
[[9693  268 1038]
 [9037  225  750]
 [9952  284 1024]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2475247
{'0': {'precision': 0.3541856781732171, 'recall': 0.5228870513177862, 'f1-score': 0.4223118531719976, 'support': 129156}, '1': {'precision': 0.3823072389219311, 'recall': 0.09425612301513911, 'f1-score': 0.15122773179597504, 'support': 151396}, '2': {'precision': 0.34036146261068745, 'recall': 0.48182184857999255, 'f1-score': 0.39892220352411945, 'support': 126443}, 'accuracy': 0.3506848978488679, 'macro avg': {'precision': 0.3589514599019452, 'recall': 0.366321674304306, 'f1-score': 0.32415392949736405, 'support': 406995}, 'weighted avg': {'precision': 0.3603516421844196, 'recall': 0.3506848978488679, 'f1-score': 0.3142060801028666, 'support': 406995}}
[[67534 11325 50297]
 [69351 14270 67775]
 [53789 11731 60923]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2193608
{'0': {'precision': 0.360699865410498, 'recall': 0.5637901564622869, 'f1-score': 0.4399377575622852, 'support': 45634}, '1': {'precision': 0.35097550850975506, 'recall': 0.11154353562005277, 'f1-score': 0.16928621483631995, 'support': 45480}, '2': {'precision': 0.3541734923969395, 'recall': 0.3947374073676297, 'f1-score': 0.3733569005099449, 'support': 46555}, 'accuracy': 0.35721912703658776, 'macro avg': {'precision': 0.3552829554390642, 'recall': 0.35669036648332314, 'f1-score': 0.3275269576361834, 'support': 137669}, 'weighted avg': {'precision': 0.3552803515948096, 'recall': 0.35721912703658776, 'f1-score': 0.3280105701544548, 'support': 137669}}
[[25728  4525 15381]
 [22278  5073 18129]
 [23322  4856 18377]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2254606
{'0': {'precision': 0.35962301587301587, 'recall': 0.5651762347569463, 'f1-score': 0.4395556806617153, 'support': 17959}, '1': {'precision': 0.3623693379790941, 'recall': 0.07959328704969114, 'f1-score': 0.1305185782797723, 'support': 18293}, '2': {'precision': 0.33590588235294117, 'recall': 0.4140371229698376, 'f1-score': 0.37090153286567945, 'support': 17240}, 'accuracy': 0.35040753757571225, 'macro avg': {'precision': 0.35263274540168377, 'recall': 0.352935548258825, 'f1-score': 0.3136585972690557, 'support': 53492}, 'weighted avg': {'precision': 0.352918370101693, 'recall': 0.35040753757571225, 'f1-score': 0.3117456675405656, 'support': 53492}}
[[10150  1247  6562]
 [ 9287  1456  7550]
 [ 8787  1315  7138]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9722448
{'0': {'precision': 0.5268411077325843, 'recall': 0.4025574417247798, 'f1-score': 0.45638936847513883, 'support': 287944}, '1': {'precision': 0.48424153523080704, 'recall': 0.7674452394659649, 'f1-score': 0.593804885498774, 'support': 364770}, '2': {'precision': 0.5606036518226729, 'recall': 0.30202259879836824, 'f1-score': 0.392556965887468, 'support': 315238}, 'accuracy': 0.507322677157545, 'macro avg': {'precision': 0.5238954315953548, 'recall': 0.4906750933297043, 'f1-score': 0.480917073287127, 'support': 967952}, 'weighted avg': {'precision': 0.521783202807958, 'recall': 0.507322677157545, 'f1-score': 0.4873853881308441, 'support': 967952}}
[[115914 129514  42516]
 [ 52721 279941  32108]
 [ 51382 168647  95209]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0013216
{'0': {'precision': 0.5453568819560827, 'recall': 0.3693592747275135, 'f1-score': 0.44042651026800045, 'support': 137438}, '1': {'precision': 0.4283532727358519, 'recall': 0.7436015816398717, 'f1-score': 0.5435775446771217, 'support': 134291}, '2': {'precision': 0.5381530911484829, 'recall': 0.32574281098077856, 'f1-score': 0.40583477758521086, 'support': 138023}, 'accuracy': 0.4773204279661844, 'macro avg': {'precision': 0.5039544152801391, 'recall': 0.4795678891160546, 'f1-score': 0.4632796108434443, 'support': 409752}, 'weighted avg': {'precision': 0.5045838765664046, 'recall': 0.4773204279661844, 'f1-score': 0.4625808886279807, 'support': 409752}}
[[50764 62930 23744]
 [19591 99859 14841]
 [22729 70334 44960]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.983187
{'0': {'precision': 0.5492081056781244, 'recall': 0.3627518158147184, 'f1-score': 0.43691884456671254, 'support': 43782}, '1': {'precision': 0.45880241087031465, 'recall': 0.7762268704746581, 'f1-score': 0.576722778861169, 'support': 49720}, '2': {'precision': 0.554431036719865, 'recall': 0.30052044261065264, 'f1-score': 0.3897715006765282, 'support': 42656}, 'accuracy': 0.49424198357790217, 'macro avg': {'precision': 0.5208138510894347, 'recall': 0.4798330429666764, 'f1-score': 0.46780437470146996, 'support': 136158}, 'weighted avg': {'precision': 0.5178314564960872, 'recall': 0.49424198357790217, 'f1-score': 0.47319974258328645, 'support': 136158}}
[[15882 21811  6089]
 [ 6913 38594  4213]
 [ 6123 23714 12819]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
4457/4457 - 63s - 63s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0080371
{'0': {'precision': 0.5245588653044506, 'recall': 0.4035535768285648, 'f1-score': 0.45616801745322516, 'support': 393519}, '1': {'precision': 0.45301538977322564, 'recall': 0.7135713104566622, 'f1-score': 0.5541959037829159, 'support': 374938}, '2': {'precision': 0.4863061826111537, 'recall': 0.32328417028633405, 'f1-score': 0.3883818283849245, 'support': 372502}, 'accuracy': 0.4792240562544316, 'macro avg': {'precision': 0.4879601458962766, 'recall': 0.4801363525238537, 'f1-score': 0.46624858320702184, 'support': 1140959}, 'weighted avg': {'precision': 0.48855970281277045, 'recall': 0.4792240562544316, 'f1-score': 0.4662506660360064, 'support': 1140959}}
[[158806 154260  80453]
 [ 60640 267545  46753]
 [ 83296 168782 120424]]
Evaluating performance on  train set...
2425/2425 - 40s - 40s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9690791
{'0': {'precision': 0.4967479674796748, 'recall': 0.4196808425671035, 'f1-score': 0.45497392323299957, 'support': 187807}, '1': {'precision': 0.5174600704239052, 'recall': 0.7604835909898503, 'f1-score': 0.6158642269323383, 'support': 244835}, '2': {'precision': 0.5294583651194179, 'recall': 0.2878066934261942, 'f1-score': 0.372906341164355, 'support': 188095}, 'accuracy': 0.5141420601639664, 'macro avg': {'precision': 0.5145554676743327, 'recall': 0.4893237089943827, 'f1-score': 0.48124816377656426, 'support': 620737}, 'weighted avg': {'precision': 0.5148292321189635, 'recall': 0.5141420601639664, 'f1-score': 0.4935652681295112, 'support': 620737}}
[[ 78819  80362  28626]
 [ 39157 186193  19485]
 [ 40694  93266  54135]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9818934
{'0': {'precision': 0.518112477956955, 'recall': 0.3846675605331651, 'f1-score': 0.4415274030888451, 'support': 63395}, '1': {'precision': 0.48990329081051914, 'recall': 0.7642548042142923, 'f1-score': 0.5970713661819863, 'support': 76027}, '2': {'precision': 0.5226710171017102, 'recall': 0.30067961165048546, 'f1-score': 0.38174870572766867, 'support': 61800}, 'accuracy': 0.502291001977915, 'macro avg': {'precision': 0.5102289286230615, 'recall': 0.4832006587993143, 'f1-score': 0.47344915833283335, 'support': 201222}, 'weighted avg': {'precision': 0.5088543344535795, 'recall': 0.502291001977915, 'f1-score': 0.4819365898833384, 'support': 201222}}
[[24386 29041  9968]
 [10921 58104  7002]
 [11760 31458 18582]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
4676/4676 - 69s - 69s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0355146
{'0': {'precision': 0.5021747802083832, 'recall': 0.390567643971001, 'f1-score': 0.4393948701338591, 'support': 402911}, '1': {'precision': 0.4194544394830518, 'recall': 0.6628774422735346, 'f1-score': 0.5137922862321014, 'support': 394100}, '2': {'precision': 0.4864712535705385, 'recall': 0.31721494682207524, 'f1-score': 0.38402041183850316, 'support': 399978}, 'accuracy': 0.4557126255963923, 'macro avg': {'precision': 0.46936682442065786, 'recall': 0.4568866776888703, 'f1-score': 0.4457358560681545, 'support': 1196989}, 'weighted avg': {'precision': 0.4696923167459746, 'recall': 0.4557126255963923, 'f1-score': 0.4453861170076878, 'support': 1196989}}
[[157364 170731  74816]
 [ 73740 261240  59120]
 [ 82261 190838 126879]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0170476
{'0': {'precision': 0.5118863246497997, 'recall': 0.404123146092058, 'f1-score': 0.4516658802478139, 'support': 182385}, '1': {'precision': 0.4404349588096868, 'recall': 0.725298637204868, 'f1-score': 0.5480615408086078, 'support': 178310}, '2': {'precision': 0.5088079541770236, 'recall': 0.289781438499502, 'f1-score': 0.3692588512533111, 'support': 178714}, 'accuracy': 0.47240961867525383, 'macro avg': {'precision': 0.48704307921217005, 'recall': 0.4730677405988093, 'f1-score': 0.4563287574365776, 'support': 539409}, 'weighted avg': {'precision': 0.487247060300072, 'recall': 0.47240961867525383, 'f1-score': 0.45622831887021653, 'support': 539409}}
[[ 73706  77355  31324]
 [ 30311 129328  18671]
 [ 39972  86954  51788]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0391046
{'0': {'precision': 0.4913194444444444, 'recall': 0.4188692011671671, 'f1-score': 0.45221083388499556, 'support': 70941}, '1': {'precision': 0.40787075234568376, 'recall': 0.6845834272648224, 'f1-score': 0.5111821854559446, 'support': 62102}, '2': {'precision': 0.5150079789255047, 'recall': 0.2857624736472242, 'f1-score': 0.36757089009210964, 'support': 71150}, 'accuracy': 0.45330153335324913, 'macro avg': {'precision': 0.4713993919052109, 'recall': 0.4630717006930712, 'f1-score': 0.4436546364776833, 'support': 204193}, 'weighted avg': {'precision': 0.4741940216905312, 'recall': 0.45330153335324913, 'f1-score': 0.44065366431696557, 'support': 204193}}
[[29715 29389 11837]
 [12278 42514  7310]
 [18487 32331 20332]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
4274/4274 - 62s - 62s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0750964
{'0': {'precision': 0.4447723340461887, 'recall': 0.5136200387690215, 'f1-score': 0.47672329191258794, 'support': 402899}, '1': {'precision': 0.34829669500292687, 'recall': 0.32975015336567953, 'f1-score': 0.33876977341700754, 'support': 286896}, '2': {'precision': 0.450533483024013, 'recall': 0.3980557548173251, 'f1-score': 0.4226719775796473, 'support': 404270}, 'accuracy': 0.4227015762317595, 'macro avg': {'precision': 0.41453417069104287, 'recall': 0.4138086489840087, 'f1-score': 0.4127216809697476, 'support': 1094065}, 'weighted avg': {'precision': 0.421602398766575, 'recall': 0.4227015762317595, 'f1-score': 0.4205752225678178, 'support': 1094065}}
[[206937  83585 112377]
 [108410  94604  83882]
 [149918  93430 160922]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0470765
{'0': {'precision': 0.44353876739562625, 'recall': 0.45485563517524663, 'f1-score': 0.44912592329440326, 'support': 166765}, '1': {'precision': 0.4482991287825627, 'recall': 0.4983438741344342, 'f1-score': 0.4719986814885539, 'support': 166654}, '2': {'precision': 0.4539588137718979, 'recall': 0.39333142479887356, 'f1-score': 0.4214760394787503, 'support': 171161}, 'accuracy': 0.44834912204209443, 'macro avg': {'precision': 0.44859890331669566, 'recall': 0.44884364470285143, 'f1-score': 0.4475335480872358, 'support': 504580}, 'weighted avg': {'precision': 0.44864566585451787, 'recall': 0.44834912204209443, 'f1-score': 0.4473011479967636, 'support': 504580}}
[[75854 47884 43027]
 [45651 83051 37952]
 [49515 54323 67323]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0585072
{'0': {'precision': 0.4526647104145834, 'recall': 0.4445893509797292, 'f1-score': 0.4485906912517261, 'support': 62109}, '1': {'precision': 0.42056410096408847, 'recall': 0.4738294431946007, 'f1-score': 0.4456106712507645, 'support': 56896}, '2': {'precision': 0.44356795026145085, 'recall': 0.39976355892403115, 'f1-score': 0.4205281090289608, 'support': 61749}, 'accuracy': 0.43847992298925614, 'macro avg': {'precision': 0.4389322538800409, 'recall': 0.43939411769945363, 'f1-score': 0.4382431571771505, 'support': 180754}, 'weighted avg': {'precision': 0.4394527642446998, 'recall': 0.43847992298925614, 'f1-score': 0.4380659581467976, 'support': 180754}}
[[27613 17569 16927]
 [15898 26959 14039]
 [17490 19574 24685]]
testing model on single stock: results/universal/W4/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
12724/12724 - 184s - 184s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.23634
{'0': {'precision': 0.3296395219123506, 'recall': 0.5523043386781359, 'f1-score': 0.41286378030928733, 'support': 936299}, '1': {'precision': 0.4235811967419725, 'recall': 0.11451100388372366, 'f1-score': 0.1802840034060736, 'support': 1376514}, '2': {'precision': 0.339229033556945, 'recall': 0.47283800011436633, 'f1-score': 0.3950422099580466, 'support': 944334}, 'accuracy': 0.3442475884570147, 'macro avg': {'precision': 0.3641499174037561, 'recall': 0.37988444755874196, 'f1-score': 0.32939666455780253, 'support': 3257147}, 'weighted avg': {'precision': 0.37212078925331143, 'recall': 0.3442475884570147, 'f1-score': 0.3094054980026494, 'support': 3257147}}
[[517122 105216 313961]
 [663096 157626 555792]
 [388532 109285 446517]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.184069
{'0': {'precision': 0.3666872073638399, 'recall': 0.6035453928005433, 'f1-score': 0.45620477927838504, 'support': 441700}, '1': {'precision': 0.3587861901164559, 'recall': 0.08378870673952642, 'f1-score': 0.13585149577809066, 'support': 436455}, '2': {'precision': 0.36834069060330965, 'recall': 0.4091749690841474, 'f1-score': 0.3876855438529095, 'support': 443947}, 'accuracy': 0.3666948541035412, 'macro avg': {'precision': 0.36460469602786844, 'recall': 0.36550302287473907, 'f1-score': 0.3265806063031284, 'support': 1322102}, 'weighted avg': {'precision': 0.36463412858550504, 'recall': 0.3666948541035412, 'f1-score': 0.32744111251171, 'support': 1322102}}
[[266586  31955 143159]
 [231533  36570 168352]
 [228893  33402 181652]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1878499
{'0': {'precision': 0.3698731908269719, 'recall': 0.5863128247946862, 'f1-score': 0.45359666798430404, 'support': 160486}, '1': {'precision': 0.39311432686372677, 'recall': 0.10281552875618083, 'f1-score': 0.16299989573163218, 'support': 167251}, '2': {'precision': 0.3616031007259384, 'recall': 0.4288001607404105, 'f1-score': 0.39234521231062675, 'support': 159263}, 'accuracy': 0.3687535934291581, 'macro avg': {'precision': 0.37486353947221235, 'recall': 0.37264283809709253, 'f1-score': 0.3363139253421876, 'support': 487000}, 'weighted avg': {'precision': 0.3751503651257858, 'recall': 0.3687535934291581, 'f1-score': 0.3337656796044509, 'support': 487000}}
[[94095 12986 53405]
 [82893 17196 67162]
 [77410 13561 68292]]
training model: results/universal/W4/deepVOL_L3/h200
Epoch 1/50
9854/9854 - 549s - loss: 3.2695 - accuracy200: 0.3735 - val_loss: 3.3247 - val_accuracy200: 0.3417 - 549s/epoch - 56ms/step
Epoch 2/50
9854/9854 - 554s - loss: 3.2438 - accuracy200: 0.3941 - val_loss: 3.4219 - val_accuracy200: 0.3435 - 554s/epoch - 56ms/step
Epoch 3/50
9854/9854 - 583s - loss: 3.2311 - accuracy200: 0.4030 - val_loss: 3.3031 - val_accuracy200: 0.3504 - 583s/epoch - 59ms/step
Epoch 4/50
9854/9854 - 579s - loss: 3.2163 - accuracy200: 0.4105 - val_loss: 3.3838 - val_accuracy200: 0.3473 - 579s/epoch - 59ms/step
Epoch 5/50
9854/9854 - 571s - loss: 3.2054 - accuracy200: 0.4160 - val_loss: 3.4900 - val_accuracy200: 0.3440 - 571s/epoch - 58ms/step
Epoch 6/50
9854/9854 - 541s - loss: 3.1992 - accuracy200: 0.4185 - val_loss: 3.4808 - val_accuracy200: 0.3472 - 541s/epoch - 55ms/step
Epoch 7/50
9854/9854 - 534s - loss: 3.1932 - accuracy200: 0.4210 - val_loss: 3.6041 - val_accuracy200: 0.3462 - 534s/epoch - 54ms/step
Epoch 8/50
9854/9854 - 530s - loss: 3.1889 - accuracy200: 0.4223 - val_loss: 3.5969 - val_accuracy200: 0.3462 - 530s/epoch - 54ms/step
Epoch 9/50
9854/9854 - 536s - loss: 3.1855 - accuracy200: 0.4233 - val_loss: 3.6245 - val_accuracy200: 0.3471 - 536s/epoch - 54ms/step
Epoch 10/50
9854/9854 - 558s - loss: 3.1826 - accuracy200: 0.4248 - val_loss: 3.5551 - val_accuracy200: 0.3483 - 558s/epoch - 57ms/step
Epoch 11/50
9854/9854 - 542s - loss: 3.1798 - accuracy200: 0.4258 - val_loss: 3.4995 - val_accuracy200: 0.3482 - 542s/epoch - 55ms/step
Epoch 12/50
9854/9854 - 543s - loss: 3.1761 - accuracy200: 0.4271 - val_loss: 3.5847 - val_accuracy200: 0.3480 - 543s/epoch - 55ms/step
Epoch 13/50
9854/9854 - 541s - loss: 3.1736 - accuracy200: 0.4285 - val_loss: 3.5701 - val_accuracy200: 0.3476 - 541s/epoch - 55ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 720s - 720s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0856831
{'0': {'precision': 0.395315435047641, 'recall': 0.1678023547389065, 'f1-score': 0.23559852687578547, 'support': 1800964}, '1': {'precision': 0.39911132463526316, 'recall': 0.8345487278143539, 'f1-score': 0.5399831948344026, 'support': 2412934}, '2': {'precision': 0.3812692031367034, 'recall': 0.05370470352844031, 'f1-score': 0.09414794407308831, 'support': 1857733}, 'accuracy': 0.3978644288495134, 'macro avg': {'precision': 0.3918986542732026, 'recall': 0.35201859536056695, 'f1-score': 0.2899098885944255, 'support': 6071631}, 'weighted avg': {'precision': 0.39252624751296006, 'recall': 0.3978644288495134, 'f1-score': 0.3132848518277226, 'support': 6071631}}
[[ 302206 1439492   59266]
 [ 296582 2013711  102641]
 [ 165680 1592284   99769]]
Evaluating performance on  train set...
9854/9854 - 288s - 288s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041356
{'0': {'precision': 0.4167673279433234, 'recall': 0.13412288536272132, 'f1-score': 0.20293711958762328, 'support': 838619}, '1': {'precision': 0.33335357917972797, 'recall': 0.8517334761213161, 'f1-score': 0.47916885346470456, 'support': 844142}, '2': {'precision': 0.41051869570691174, 'recall': 0.04662332679581249, 'f1-score': 0.08373654734670555, 'support': 839258}, 'accuracy': 0.3451960512589318, 'macro avg': {'precision': 0.38687986760998766, 'recall': 0.3441598960932833, 'f1-score': 0.2552808401330111, 'support': 2522019}, 'weighted avg': {'precision': 0.3867686390744983, 'recall': 0.3451960512589318, 'f1-score': 0.2557276713006354, 'support': 2522019}}
[[112478 700987  25154]
 [ 94125 718984  31033]
 [ 63279 736850  39129]]
Evaluating performance on  val set...
3566/3566 - 105s - 105s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1007526
{'0': {'precision': 0.4220425113381782, 'recall': 0.12811419775611893, 'f1-score': 0.19656085935253356, 'support': 301442}, '1': {'precision': 0.3393121763175182, 'recall': 0.8578882315452011, 'f1-score': 0.48628771084777006, 'support': 310678}, '2': {'precision': 0.4070994201668788, 'recall': 0.047939593381118605, 'f1-score': 0.08577805457303174, 'support': 300232}, 'accuracy': 0.3502365315141524, 'macro avg': {'precision': 0.38948470260752505, 'recall': 0.3446473408941462, 'f1-score': 0.25620887492444516, 'support': 912352}, 'weighted avg': {'precision': 0.3889534304000204, 'recall': 0.3502365315141524, 'f1-score': 0.25876406132313007, 'support': 912352}}
[[ 38619 253701   9122]
 [ 32311 266527  11840]
 [ 20575 265264  14393]]
testing model out of sample: results/universal/W4/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 348s - 348s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1167849
{'0': {'precision': 0.41895703682809443, 'recall': 0.1341483951999473, 'f1-score': 0.20322495818614453, 'support': 1062905}, '1': {'precision': 0.3077633604745584, 'recall': 0.8441077947703337, 'f1-score': 0.45106685819570747, 'support': 937077}, '2': {'precision': 0.3957925837893156, 'recall': 0.04648527615687339, 'f1-score': 0.0831989535290204, 'support': 1031660}, 'accuracy': 0.323764481426237, 'macro avg': {'precision': 0.3741709936973228, 'recall': 0.3415804887090515, 'f1-score': 0.24583025663695746, 'support': 3031642}, 'weighted avg': {'precision': 0.37670439740750017, 'recall': 0.323764481426237, 'f1-score': 0.23898805823908367, 'support': 3031642}}
[[142587 885178  35140]
 [108013 790994  38070]
 [ 89738 893965  47957]]
Evaluating performance on  train set...
5528/5528 - 165s - 165s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1048065
{'0': {'precision': 0.4093021216903384, 'recall': 0.15976182022731453, 'f1-score': 0.22981899631100758, 'support': 467546}, '1': {'precision': 0.3269121520425554, 'recall': 0.8266095798769066, 'f1-score': 0.4685281762431839, 'support': 467125}, '2': {'precision': 0.415484505656665, 'recall': 0.04401273049002382, 'f1-score': 0.07959398286526277, 'support': 479793}, 'accuracy': 0.34072482579973756, 'macro avg': {'precision': 0.38389959312985295, 'recall': 0.3434613768647483, 'f1-score': 0.2593137184731514, 'support': 1414464}, 'weighted avg': {'precision': 0.3841900297450044, 'recall': 0.34072482579973756, 'f1-score': 0.2576953620577806, 'support': 1414464}}
[[ 74696 378925  13925]
 [ 65212 386130  15783]
 [ 42588 416088  21117]]
Evaluating performance on  val set...
1908/1908 - 56s - 56s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076156
{'0': {'precision': 0.43066054139136484, 'recall': 0.1413952034997266, 'f1-score': 0.21289301063107896, 'support': 166413}, '1': {'precision': 0.32325800217213047, 'recall': 0.8462200890284752, 'f1-score': 0.4678110987037627, 'support': 157927}, '2': {'precision': 0.41173764122488626, 'recall': 0.04932721693808681, 'f1-score': 0.08809984795283256, 'support': 163277}, 'accuracy': 0.3388417549019005, 'macro avg': {'precision': 0.38855206159612715, 'recall': 0.3456475031554295, 'f1-score': 0.25626798576255805, 'support': 487617}, 'weighted avg': {'precision': 0.38953926140777495, 'recall': 0.3388417549019005, 'f1-score': 0.2536680362606995, 'support': 487617}}
[[ 23530 137375   5508]
 [ 18287 133641   5999]
 [ 12820 142403   8054]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
534/534 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1224797
{'0': {'precision': 0.408434693645561, 'recall': 0.07244974089085153, 'f1-score': 0.12306901866758006, 'support': 49593}, '1': {'precision': 0.28741003679942684, 'recall': 0.9055974552357499, 'f1-score': 0.4363389160126074, 'support': 38982}, '2': {'precision': 0.38735335056671305, 'recall': 0.04051664968073379, 'f1-score': 0.07335994577088198, 'support': 48079}, 'accuracy': 0.2988789204853133, 'macro avg': {'precision': 0.3610660270039003, 'recall': 0.3395212819357784, 'f1-score': 0.21092262681702315, 'support': 136654}, 'weighted avg': {'precision': 0.3664940767074258, 'recall': 0.2988789204853133, 'f1-score': 0.1949434213378532, 'support': 136654}}
[[ 3593 44473  1527]
 [ 2126 35302  1554]
 [ 3078 43053  1948]]
Evaluating performance on  train set...
254/254 - 7s - 7s/epoch - 27ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136565
{'0': {'precision': 0.388641425389755, 'recall': 0.04848793590515445, 'f1-score': 0.08621896487832997, 'support': 21593}, '1': {'precision': 0.3304820488353468, 'recall': 0.9037323517077489, 'f1-score': 0.48397963767030994, 'support': 21461}, '2': {'precision': 0.339521800281294, 'recall': 0.055159491819760535, 'f1-score': 0.0949011282777057, 'support': 21882}, 'accuracy': 0.3333897991868917, 'macro avg': {'precision': 0.3528817581687986, 'recall': 0.3357932598108879, 'f1-score': 0.22169991027544853, 'support': 64936}, 'weighted avg': {'precision': 0.3528678326698847, 'recall': 0.3333897991868917, 'f1-score': 0.22060243319011114, 'support': 64936}}
[[ 1047 19421  1125]
 [  843 19395  1223]
 [  804 19871  1207]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.124332
{'0': {'precision': 0.3633305298570227, 'recall': 0.0579476861167002, 'f1-score': 0.0999537251272559, 'support': 7455}, '1': {'precision': 0.2883842225361295, 'recall': 0.8957138035774553, 'f1-score': 0.43629787933585407, 'support': 5926}, '2': {'precision': 0.3835616438356164, 'recall': 0.054173576561636266, 'f1-score': 0.09493824170501333, 'support': 7236}, 'accuracy': 0.29742445554639374, 'macro avg': {'precision': 0.34509213207625616, 'recall': 0.33594502208526394, 'f1-score': 0.2103966153893744, 'support': 20617}, 'weighted avg': {'precision': 0.3488890749201013, 'recall': 0.29742445554639374, 'f1-score': 0.1948697371463084, 'support': 20617}}
[[ 432 6684  339]
 [ 327 5308  291]
 [ 430 6414  392]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
1613/1613 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0845429
{'0': {'precision': 0.4065312497630583, 'recall': 0.41762341688346083, 'f1-score': 0.4120026894630679, 'support': 128386}, '1': {'precision': 0.3623872285130871, 'recall': 0.6370429833835872, 'f1-score': 0.46197571064812626, 'support': 153222}, '2': {'precision': 0.5074074074074074, 'recall': 0.044886887481808274, 'f1-score': 0.08247754653450098, 'support': 131241}, 'accuracy': 0.38056771361926517, 'macro avg': {'precision': 0.42544196189451755, 'recall': 0.3665177625829521, 'f1-score': 0.31881864888189837, 'support': 412849}, 'weighted avg': {'precision': 0.42221556190003556, 'recall': 0.38056771361926517, 'f1-score': 0.3257962482919108, 'support': 412849}}
[[53617 72202  2567]
 [52461 97609  3152]
 [25811 99539  5891]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0929286
{'0': {'precision': 0.4428610059491617, 'recall': 0.3014578654787763, 'f1-score': 0.35872779444943376, 'support': 54326}, '1': {'precision': 0.33488949802980983, 'recall': 0.723499148715671, 'f1-score': 0.45785122031198766, 'support': 54036}, '2': {'precision': 0.47909284195605956, 'recall': 0.07535671819262782, 'f1-score': 0.13022957135976881, 'support': 53824}, 'accuracy': 0.3670353791326008, 'macro avg': {'precision': 0.41894778197834376, 'recall': 0.366771244129025, 'f1-score': 0.3156028620403967, 'support': 162186}, 'weighted avg': {'precision': 0.4189119224234885, 'recall': 0.3670353791326008, 'f1-score': 0.3159222815218743, 'support': 162186}}
[[16377 35919  2030]
 [12561 39095  2380]
 [ 8042 41726  4056]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0729351
{'0': {'precision': 0.4483676184627981, 'recall': 0.273932345401113, 'f1-score': 0.34008694302126996, 'support': 15993}, '1': {'precision': 0.39400813709776844, 'recall': 0.7917058910964673, 'f1-score': 0.5261615463136751, 'support': 20183}, '2': {'precision': 0.4908485856905158, 'recall': 0.07128186541017277, 'f1-score': 0.12448570524316911, 'support': 16554}, 'accuracy': 0.408496112270055, 'macro avg': {'precision': 0.4444081137503608, 'recall': 0.37897336730258435, 'f1-score': 0.33024473152603806, 'support': 52730}, 'weighted avg': {'precision': 0.44089734573564554, 'recall': 0.408496112270055, 'f1-score': 0.3436234654576805, 'support': 52730}}
[[ 4381 11115   497]
 [ 3477 15979   727]
 [ 1913 13461  1180]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903927
{'0': {'precision': 0.3346704871060172, 'recall': 0.10395422759059122, 'f1-score': 0.15863407062475746, 'support': 78650}, '1': {'precision': 0.39040622092884575, 'recall': 0.8100630549478831, 'f1-score': 0.526883381942969, 'support': 101023}, '2': {'precision': 0.3204396533502431, 'recall': 0.08273302772320454, 'f1-score': 0.13151160268922144, 'support': 73296}, 'accuracy': 0.3797896184908032, 'macro avg': {'precision': 0.3485054537950354, 'recall': 0.33225010342055966, 'f1-score': 0.2723430184189826, 'support': 252969}, 'weighted avg': {'precision': 0.35280523028411565, 'recall': 0.3797896184908032, 'f1-score': 0.2978356398585238, 'support': 252969}}
[[ 8176 65446  5028]
 [11356 81835  7832]
 [ 4898 62334  6064]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147738
{'0': {'precision': 0.3287300297860818, 'recall': 0.08500507649756678, 'f1-score': 0.13508025258004394, 'support': 28563}, '1': {'precision': 0.3202126227963935, 'recall': 0.8336252802690582, 'f1-score': 0.4626946934489665, 'support': 28544}, '2': {'precision': 0.33677259595542713, 'recall': 0.055444199082724646, 'f1-score': 0.09521309180012251, 'support': 29435}, 'accuracy': 0.32186683922257403, 'macro avg': {'precision': 0.3285717495126341, 'recall': 0.3246915186164499, 'f1-score': 0.230996012609711, 'support': 86542}, 'weighted avg': {'precision': 0.32865621672515205, 'recall': 0.32186683922257403, 'f1-score': 0.22957699084129904, 'support': 86542}}
[[ 2428 24585  1550]
 [ 3085 23795  1664]
 [ 1873 25930  1632]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152827
{'0': {'precision': 0.3660681568340051, 'recall': 0.0962798766383963, 'f1-score': 0.15246089278901181, 'support': 10376}, '1': {'precision': 0.3180549434405759, 'recall': 0.8536224741251848, 'f1-score': 0.4634361704974179, 'support': 10145}, '2': {'precision': 0.37142857142857144, 'recall': 0.053128689492325853, 'f1-score': 0.09296043222628317, 'support': 11011}, 'accuracy': 0.3248763161233033, 'macro avg': {'precision': 0.3518505572343842, 'recall': 0.33434368008530235, 'f1-score': 0.236285831837571, 'support': 31532}, 'weighted avg': {'precision': 0.35249240760225414, 'recall': 0.3248763161233033, 'f1-score': 0.23173542726495924, 'support': 31532}}
[[ 999 8927  450]
 [ 945 8660  540]
 [ 785 9641  585]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970354
{'0': {'precision': 0.3548151750972763, 'recall': 0.019582052693035555, 'f1-score': 0.037115709942889125, 'support': 74507}, '1': {'precision': 0.3730387323334544, 'recall': 0.975923516433784, 'f1-score': 0.5397590210661019, 'support': 88385}, '2': {'precision': 0.34416543574593794, 'recall': 0.006314192027316333, 'f1-score': 0.012400872851136304, 'support': 73802}, 'accuracy': 0.3725569722933408, 'macro avg': {'precision': 0.35733978105888947, 'recall': 0.333939920384712, 'f1-score': 0.19642520128670912, 'support': 236694}, 'weighted avg': {'precision': 0.3582994925819279, 'recall': 0.3725569722933408, 'f1-score': 0.21710389995437912, 'support': 236694}}
[[ 1459 72646   402]
 [ 1642 86257   486]
 [ 1011 72325   466]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109417
{'0': {'precision': 0.33601756954612005, 'recall': 0.015330661322645291, 'f1-score': 0.029323452373346964, 'support': 29940}, '1': {'precision': 0.331364768847467, 'recall': 0.9794415464866524, 'f1-score': 0.49519508390288464, 'support': 29331}, '2': {'precision': 0.3543307086614173, 'recall': 0.0061435543875217585, 'f1-score': 0.012077699869158251, 'support': 29299}, 'accuracy': 0.3315682511008242, 'macro avg': {'precision': 0.3405710156850015, 'recall': 0.3336385873989398, 'f1-score': 0.1788654120484633, 'support': 88570}, 'weighted avg': {'precision': 0.3405347352415801, 'recall': 0.3315682511008242, 'f1-score': 0.17789743365112323, 'support': 88570}}
[[  459 29329   152]
 [  427 28728   176]
 [  480 28639   180]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1191161
{'0': {'precision': 0.3350970017636684, 'recall': 0.01719768283852281, 'f1-score': 0.03271631510977185, 'support': 11048}, '1': {'precision': 0.2978615394377816, 'recall': 0.9754779717373233, 'f1-score': 0.4563706188323368, 'support': 9624}, '2': {'precision': 0.3978494623655914, 'recall': 0.006379860332787309, 'f1-score': 0.012558336868901145, 'support': 11599}, 'accuracy': 0.299092064082303, 'macro avg': {'precision': 0.34360266785568044, 'recall': 0.3330185049695445, 'f1-score': 0.16721509027033662, 'support': 32271}, 'weighted avg': {'precision': 0.34654727293894555, 'recall': 0.299092064082303, 'f1-score': 0.15181509201194734, 'support': 32271}}
[[  190 10804    54]
 [  178  9388    58]
 [  199 11326    74]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099017
{'0': {'precision': 0.30790697674418605, 'recall': 0.06385474299912802, 'f1-score': 0.1057737783288382, 'support': 129591}, '1': {'precision': 0.36992977734556104, 'recall': 0.8597069837724197, 'f1-score': 0.517276683888667, 'support': 152210}, '2': {'precision': 0.3499696831893285, 'recall': 0.07376551591929326, 'f1-score': 0.12184824055626658, 'support': 125194}, 'accuracy': 0.3645401049152938, 'macro avg': {'precision': 0.3426021457596919, 'recall': 0.3324424142302803, 'f1-score': 0.24829956759125724, 'support': 406995}, 'weighted avg': {'precision': 0.3440413001393837, 'recall': 0.3645401049152938, 'f1-score': 0.26461426403348376, 'support': 406995}}
[[  8275 113928   7388]
 [ 11589 130856   9765]
 [  7011 108948   9235]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132423
{'0': {'precision': 0.31992538183514047, 'recall': 0.060455176364317346, 'f1-score': 0.1016936589704629, 'support': 45389}, '1': {'precision': 0.3242007254542314, 'recall': 0.8672578054522652, 'f1-score': 0.47196877170294804, 'support': 45449}, '2': {'precision': 0.36124051643817384, 'recall': 0.0579530652772736, 'f1-score': 0.09988223170911231, 'support': 46831}, 'accuracy': 0.32595573440643866, 'macro avg': {'precision': 0.33512220790918185, 'recall': 0.32855534903128536, 'f1-score': 0.22451488746084106, 'support': 137669}, 'weighted avg': {'precision': 0.3353910215996388, 'recall': 0.32595573440643866, 'f1-score': 0.22331728265119286, 'support': 137669}}
[[ 2744 40352  2293]
 [ 3527 39416  2506]
 [ 2306 41811  2714]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116147
{'0': {'precision': 0.36494496189669773, 'recall': 0.045187670371146994, 'f1-score': 0.08041794943558168, 'support': 19076}, '1': {'precision': 0.3136357913291644, 'recall': 0.8788662824885335, 'f1-score': 0.46229508196721314, 'support': 17006}, '2': {'precision': 0.35184119677790565, 'recall': 0.07024698449167145, 'f1-score': 0.11711194101311884, 'support': 17410}, 'accuracy': 0.31838405742914827, 'macro avg': {'precision': 0.34347398333458923, 'recall': 0.331433645783784, 'f1-score': 0.21994165747197122, 'support': 53492}, 'weighted avg': {'precision': 0.34436804749099886, 'recall': 0.31838405742914827, 'f1-score': 0.21376583153379908, 'support': 53492}}
[[  862 17073  1141]
 [  948 14946  1112]
 [  552 15635  1223]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
3782/3782 - 56s - 56s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062261
{'0': {'precision': 0.43820774956625563, 'recall': 0.29464226915659253, 'f1-score': 0.35236275471266487, 'support': 318885}, '1': {'precision': 0.3050556649573983, 'recall': 0.7365868913870273, 'f1-score': 0.4314339935179723, 'support': 297377}, '2': {'precision': 0.5380345973967431, 'recall': 0.05430066251528334, 'f1-score': 0.09864560519029712, 'support': 351690}, 'accuracy': 0.34309345917979406, 'macro avg': {'precision': 0.427099337306799, 'recall': 0.36184327435296776, 'f1-score': 0.29414745114031143, 'support': 967952}, 'weighted avg': {'precision': 0.4335708839456215, 'recall': 0.34309345917979406, 'f1-score': 0.2844711479663431, 'support': 967952}}
[[ 93957 218062   6866]
 [ 68802 219044   9531]
 [ 51653 280940  19097]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1002735
{'0': {'precision': 0.4294790931290289, 'recall': 0.271565729005064, 'f1-score': 0.3327370785307924, 'support': 136652}, '1': {'precision': 0.3289724087868106, 'recall': 0.7419559429780895, 'f1-score': 0.45583447925893533, 'support': 135597}, '2': {'precision': 0.4689265536723164, 'recall': 0.05975869617390166, 'f1-score': 0.10600802446041309, 'support': 137503}, 'accuracy': 0.3561520139010914, 'macro avg': {'precision': 0.4091260185293853, 'recall': 0.35776012271901836, 'f1-score': 0.29819319408338024, 'support': 409752}, 'weighted avg': {'precision': 0.4094565899815931, 'recall': 0.3561520139010914, 'f1-score': 0.2973881677864754, 'support': 409752}}
[[ 37110  95755   3787]
 [ 29471 100607   5519]
 [ 19826 109460   8217]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888767
{'0': {'precision': 0.45231289958631066, 'recall': 0.2626211896235479, 'f1-score': 0.33230182632000665, 'support': 45796}, '1': {'precision': 0.33448923015366444, 'recall': 0.7645957187343482, 'f1-score': 0.4653853800782028, 'support': 45921}, '2': {'precision': 0.4988040878451837, 'recall': 0.05161900047253662, 'f1-score': 0.09355628058727569, 'support': 44441}, 'accuracy': 0.3630488109402312, 'macro avg': {'precision': 0.4285354058617196, 'recall': 0.35961196961014424, 'f1-score': 0.2970811623284951, 'support': 136158}, 'weighted avg': {'precision': 0.4277497756670112, 'recall': 0.3630488109402312, 'f1-score': 0.299261087430054, 'support': 136158}}
[[12027 32895   874]
 [ 9379 35111  1431]
 [ 5184 36963  2294]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
4457/4457 - 63s - 63s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217265
{'0': {'precision': 0.4617132100041047, 'recall': 0.15451897115247976, 'f1-score': 0.2315473042756095, 'support': 422220}, '1': {'precision': 0.2828308540492214, 'recall': 0.8432285352016214, 'f1-score': 0.423585201715541, 'support': 324147}, '2': {'precision': 0.4447351800054137, 'recall': 0.03747415051496229, 'f1-score': 0.06912381001353307, 'support': 394592}, 'accuracy': 0.3097026273512019, 'macro avg': {'precision': 0.3964264146862466, 'recall': 0.34507388562302116, 'f1-score': 0.24141877200156117, 'support': 1140959}, 'weighted avg': {'precision': 0.4050209240858981, 'recall': 0.3097026273512019, 'f1-score': 0.22993243195644658, 'support': 1140959}}
[[ 65241 346581  10398]
 [ 42753 273330   8064]
 [ 33308 346497  14787]]
Evaluating performance on  train set...
2425/2425 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998627
{'0': {'precision': 0.4268139340716822, 'recall': 0.20571123824299428, 'f1-score': 0.27761874695342376, 'support': 206260}, '1': {'precision': 0.3260688914636722, 'recall': 0.8067846607669616, 'f1-score': 0.46443316431887927, 'support': 204756}, '2': {'precision': 0.47738556757124395, 'recall': 0.033468274517096525, 'f1-score': 0.06255124229137703, 'support': 209721}, 'accuracy': 0.34578734633186037, 'macro avg': {'precision': 0.4100894643688661, 'recall': 0.34865472450901747, 'f1-score': 0.26820105118789334, 'support': 620737}, 'weighted avg': {'precision': 0.4106682582136552, 'recall': 0.34578734633186037, 'f1-score': 0.2665789679437177, 'support': 620737}}
[[ 42430 159983   3847]
 [ 35725 165194   3837]
 [ 21256 181446   7019]]
Evaluating performance on  val set...
787/787 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027083
{'0': {'precision': 0.4588289819249189, 'recall': 0.1717259323503903, 'f1-score': 0.24991585324806465, 'support': 69180}, '1': {'precision': 0.3202684136353183, 'recall': 0.8436339913949767, 'f1-score': 0.4642817455229303, 'support': 64381}, '2': {'precision': 0.4659466991813273, 'recall': 0.03953533054492248, 'f1-score': 0.0728862973760933, 'support': 67661}, 'accuracy': 0.3422538291041735, 'macro avg': {'precision': 0.4150146982471881, 'recall': 0.35163175143009645, 'f1-score': 0.2623612987156961, 'support': 201222}, 'weighted avg': {'precision': 0.4168898496244402, 'recall': 0.3422538291041735, 'f1-score': 0.25897596462104905, 'support': 201222}}
[[11880 55766  1534]
 [ 8535 54314  1532]
 [ 5477 59509  2675]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
4676/4676 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942925
{'0': {'precision': 0.44591205388513416, 'recall': 0.19881199820678974, 'f1-score': 0.27500964535058864, 'support': 392592}, '1': {'precision': 0.3520648289399831, 'recall': 0.8349874944934849, 'f1-score': 0.4952936338401434, 'support': 415417}, '2': {'precision': 0.43866960856419057, 'recall': 0.04140058614838809, 'f1-score': 0.07566051431672269, 'support': 388980}, 'accuracy': 0.3684444886293859, 'macro avg': {'precision': 0.4122154971297693, 'recall': 0.35840002628288753, 'f1-score': 0.2819879311691516, 'support': 1196989}, 'weighted avg': {'precision': 0.41098867612144513, 'recall': 0.3684444886293859, 'f1-score': 0.28667799707045594, 'support': 1196989}}
[[ 78052 305375   9165]
 [ 57107 346868  11442]
 [ 39880 332996  16104]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991567
{'0': {'precision': 0.4475504634258384, 'recall': 0.1840952793802172, 'f1-score': 0.2608801801943705, 'support': 179934}, '1': {'precision': 0.342941643859804, 'recall': 0.8480654087775698, 'f1-score': 0.4883882840874623, 'support': 183217}, '2': {'precision': 0.43313032886723507, 'recall': 0.030262456172202114, 'f1-score': 0.05657225583726196, 'support': 176258}, 'accuracy': 0.3593544045427496, 'macro avg': {'precision': 0.40787414538429245, 'recall': 0.3541410481099963, 'f1-score': 0.2686135733730316, 'support': 539409}, 'weighted avg': {'precision': 0.4073068297981821, 'recall': 0.3593544045427496, 'f1-score': 0.27139621930318286, 'support': 539409}}
[[ 33125 143662   3147]
 [ 24003 155380   3834]
 [ 16886 154038   5334]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10642
{'0': {'precision': 0.43275344543782074, 'recall': 0.1934469276161071, 'f1-score': 0.26737392067322074, 'support': 69311}, '1': {'precision': 0.3218815123548675, 'recall': 0.825570385754864, 'f1-score': 0.4631755714726344, 'support': 65482}, '2': {'precision': 0.4604562737642586, 'recall': 0.03489913544668588, 'f1-score': 0.06488079292794, 'support': 69400}, 'accuracy': 0.34227422095762344, 'macro avg': {'precision': 0.4050304105189823, 'recall': 0.351305482939219, 'f1-score': 0.2651434283579317, 'support': 204193}, 'weighted avg': {'precision': 0.40661376564329715, 'recall': 0.34227422095762344, 'f1-score': 0.26134266902465647, 'support': 204193}}
[[13408 54559  1344]
 [ 9928 54060  1494]
 [ 7647 59331  2422]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
4274/4274 - 65s - 65s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1238838
{'0': {'precision': 0.4099906427697402, 'recall': 0.1487785065208136, 'f1-score': 0.21832914575272003, 'support': 382851}, '1': {'precision': 0.29360914838432545, 'recall': 0.8397112701308015, 'f1-score': 0.4350877419730069, 'support': 320715}, '2': {'precision': 0.42839427998522506, 'recall': 0.041580132087406116, 'f1-score': 0.07580281091780833, 'support': 390499}, 'accuracy': 0.31305726807822204, 'macro avg': {'precision': 0.3773313570464302, 'recall': 0.34335663624634044, 'f1-score': 0.24307323288117844, 'support': 1094065}, 'weighted avg': {'precision': 0.38244320359308365, 'recall': 0.31305726807822204, 'f1-score': 0.2309987238491687, 'support': 1094065}}
[[ 56960 315271  10620]
 [ 40362 269308  11045]
 [ 41608 332654  16237]]
Evaluating performance on  train set...
1972/1972 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1055471
{'0': {'precision': 0.4087801256071528, 'recall': 0.15944153830373897, 'f1-score': 0.22940530498682654, 'support': 165741}, '1': {'precision': 0.32971974643725277, 'recall': 0.8289069286762724, 'f1-score': 0.47177747278508536, 'support': 166915}, '2': {'precision': 0.4363000886088412, 'recall': 0.051551848491193784, 'f1-score': 0.0922086164025843, 'support': 171924}, 'accuracy': 0.3441396805263784, 'macro avg': {'precision': 0.3915999868844156, 'recall': 0.34663343849040174, 'f1-score': 0.2644637980581654, 'support': 504580}, 'weighted avg': {'precision': 0.39200375502163304, 'recall': 0.3441396805263784, 'f1-score': 0.26283537930584255, 'support': 504580}}
[[ 26426 134436   4879]
 [ 21986 138357   6572]
 [ 16234 146827   8863]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1072224
{'0': {'precision': 0.4137869690905048, 'recall': 0.15422869078009482, 'f1-score': 0.22470444747678447, 'support': 60326}, '1': {'precision': 0.3347260632829961, 'recall': 0.8346590815128413, 'f1-score': 0.47782742885274454, 'support': 60469}, '2': {'precision': 0.4098316858135186, 'recall': 0.051168298337197084, 'f1-score': 0.09097783379049595, 'support': 59959}, 'accuracy': 0.34767142082609515, 'macro avg': {'precision': 0.38611490606233984, 'recall': 0.34668535687671104, 'f1-score': 0.26450323670667497, 'support': 180754}, 'weighted avg': {'precision': 0.38602609661587595, 'recall': 0.34767142082609515, 'f1-score': 0.2650243271519605, 'support': 180754}}
[[ 9304 49077  1945]
 [ 7525 50471  2473]
 [ 5656 51235  3068]]
testing model on single stock: results/universal/W4/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
12724/12724 - 180s - 180s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0757182
{'0': {'precision': 0.3153517785240506, 'recall': 0.08515622708928777, 'f1-score': 0.13410052877160514, 'support': 886594}, '1': {'precision': 0.4447838131677802, 'recall': 0.8664390863970853, 'f1-score': 0.5878147504183958, 'support': 1458533}, '2': {'precision': 0.3287878444525018, 'recall': 0.0636334729501546, 'f1-score': 0.1066298464353827, 'support': 912020}, 'accuracy': 0.42898401576594486, 'macro avg': {'precision': 0.36297447871477756, 'recall': 0.3384095954788426, 'f1-score': 0.2761817085417946, 'support': 3257147}, 'weighted avg': {'precision': 0.3770729273187132, 'recall': 0.42898401576594486, 'f1-score': 0.3295793797835112, 'support': 3257147}}
[[  75499  770909   40186]
 [ 116512 1263730   78291]
 [  47401  806584   58035]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083912
{'0': {'precision': 0.35782573449249433, 'recall': 0.05848088138210509, 'f1-score': 0.10053150027586179, 'support': 437767}, '1': {'precision': 0.33100437559218776, 'recall': 0.8939906462334912, 'f1-score': 0.48312819296319215, 'support': 441961}, '2': {'precision': 0.38072386577369965, 'recall': 0.0489608340454005, 'f1-score': 0.08676388997382141, 'support': 442374}, 'accuracy': 0.3345952127748086, 'macro avg': {'precision': 0.3565179919527939, 'recall': 0.33381078722033225, 'f1-score': 0.22347452773762513, 'support': 1322102}, 'weighted avg': {'precision': 0.3565214049675814, 'recall': 0.3345952127748086, 'f1-score': 0.22382182436358758, 'support': 1322102}}
[[ 25601 396020  16146]
 [ 27768 395109  19084]
 [ 18177 402538  21659]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1031177
{'0': {'precision': 0.36380255941499084, 'recall': 0.053718281918967443, 'f1-score': 0.09361376254683697, 'support': 159294}, '1': {'precision': 0.3450209296201796, 'recall': 0.8968654849293082, 'f1-score': 0.4983344043856313, 'support': 169468}, '2': {'precision': 0.3689827924199521, 'recall': 0.05352696570988005, 'f1-score': 0.09349147042104275, 'support': 158238}, 'accuracy': 0.34705749486652976, 'macro avg': {'precision': 0.35926876048504086, 'recall': 0.33470357751938523, 'f1-score': 0.22847987911783704, 'support': 487000}, 'weighted avg': {'precision': 0.3589500429307444, 'recall': 0.34705749486652976, 'f1-score': 0.23441016186867553, 'support': 487000}}
[[  8557 144316   6421]
 [  9414 151990   8064]
 [  5550 144218   8470]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        74 (peak)  17.40 (ave)

============================================
