This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W4/deepLOB_L1/h10
Epoch 1/50
9854/9854 - 173s - loss: 2.7079 - accuracy10: 0.5517 - val_loss: 5.2639 - val_accuracy10: 0.4975 - 173s/epoch - 18ms/step
Epoch 2/50
9854/9854 - 151s - loss: 2.5960 - accuracy10: 0.5785 - val_loss: 5.4338 - val_accuracy10: 0.5017 - 151s/epoch - 15ms/step
Epoch 3/50
9854/9854 - 152s - loss: 2.5675 - accuracy10: 0.5844 - val_loss: 5.3720 - val_accuracy10: 0.5004 - 152s/epoch - 15ms/step
Epoch 4/50
9854/9854 - 152s - loss: 2.5508 - accuracy10: 0.5872 - val_loss: 5.3509 - val_accuracy10: 0.5016 - 152s/epoch - 15ms/step
Epoch 5/50
9854/9854 - 151s - loss: 2.5390 - accuracy10: 0.5895 - val_loss: 5.2226 - val_accuracy10: 0.5011 - 151s/epoch - 15ms/step
Epoch 6/50
9854/9854 - 150s - loss: 2.5306 - accuracy10: 0.5911 - val_loss: 5.2134 - val_accuracy10: 0.5016 - 150s/epoch - 15ms/step
Epoch 7/50
9854/9854 - 150s - loss: 2.5237 - accuracy10: 0.5925 - val_loss: 5.1360 - val_accuracy10: 0.5016 - 150s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 152s - loss: 2.5178 - accuracy10: 0.5937 - val_loss: 5.1363 - val_accuracy10: 0.5014 - 152s/epoch - 15ms/step
Epoch 9/50
9854/9854 - 151s - loss: 2.5132 - accuracy10: 0.5944 - val_loss: 5.0480 - val_accuracy10: 0.5030 - 151s/epoch - 15ms/step
Epoch 10/50
9854/9854 - 153s - loss: 2.5091 - accuracy10: 0.5952 - val_loss: 5.0177 - val_accuracy10: 0.5027 - 153s/epoch - 16ms/step
Epoch 11/50
9854/9854 - 154s - loss: 2.5057 - accuracy10: 0.5960 - val_loss: 4.9436 - val_accuracy10: 0.5015 - 154s/epoch - 16ms/step
Epoch 12/50
9854/9854 - 151s - loss: 2.5024 - accuracy10: 0.5965 - val_loss: 4.9353 - val_accuracy10: 0.5020 - 151s/epoch - 15ms/step
Epoch 13/50
9854/9854 - 151s - loss: 2.4998 - accuracy10: 0.5973 - val_loss: 4.9877 - val_accuracy10: 0.5032 - 151s/epoch - 15ms/step
Epoch 14/50
9854/9854 - 152s - loss: 2.4973 - accuracy10: 0.5975 - val_loss: 4.9238 - val_accuracy10: 0.5036 - 152s/epoch - 15ms/step
Epoch 15/50
9854/9854 - 155s - loss: 2.4948 - accuracy10: 0.5982 - val_loss: 4.8371 - val_accuracy10: 0.5048 - 155s/epoch - 16ms/step
Epoch 16/50
9854/9854 - 152s - loss: 2.4928 - accuracy10: 0.5985 - val_loss: 4.7766 - val_accuracy10: 0.5049 - 152s/epoch - 15ms/step
Epoch 17/50
9854/9854 - 155s - loss: 2.4906 - accuracy10: 0.5987 - val_loss: 4.7432 - val_accuracy10: 0.5047 - 155s/epoch - 16ms/step
Epoch 18/50
9854/9854 - 154s - loss: 2.4887 - accuracy10: 0.5991 - val_loss: 4.7406 - val_accuracy10: 0.5055 - 154s/epoch - 16ms/step
Epoch 19/50
9854/9854 - 152s - loss: 2.4869 - accuracy10: 0.5996 - val_loss: 4.7881 - val_accuracy10: 0.5054 - 152s/epoch - 15ms/step
Epoch 20/50
9854/9854 - 152s - loss: 2.4853 - accuracy10: 0.5999 - val_loss: 4.7002 - val_accuracy10: 0.5055 - 152s/epoch - 15ms/step
Epoch 21/50
9854/9854 - 154s - loss: 2.4838 - accuracy10: 0.6000 - val_loss: 4.6733 - val_accuracy10: 0.5051 - 154s/epoch - 16ms/step
Epoch 22/50
9854/9854 - 156s - loss: 2.4822 - accuracy10: 0.6003 - val_loss: 4.6424 - val_accuracy10: 0.5056 - 156s/epoch - 16ms/step
Epoch 23/50
9854/9854 - 151s - loss: 2.4804 - accuracy10: 0.6008 - val_loss: 4.7387 - val_accuracy10: 0.5065 - 151s/epoch - 15ms/step
Epoch 24/50
9854/9854 - 152s - loss: 2.4789 - accuracy10: 0.6009 - val_loss: 4.6703 - val_accuracy10: 0.5057 - 152s/epoch - 15ms/step
Epoch 25/50
9854/9854 - 158s - loss: 2.4776 - accuracy10: 0.6013 - val_loss: 4.6931 - val_accuracy10: 0.5060 - 158s/epoch - 16ms/step
Epoch 26/50
9854/9854 - 154s - loss: 2.4769 - accuracy10: 0.6012 - val_loss: 4.7366 - val_accuracy10: 0.5055 - 154s/epoch - 16ms/step
Epoch 27/50
9854/9854 - 153s - loss: 2.4752 - accuracy10: 0.6018 - val_loss: 4.6503 - val_accuracy10: 0.5059 - 153s/epoch - 16ms/step
Epoch 28/50
9854/9854 - 151s - loss: 2.4737 - accuracy10: 0.6019 - val_loss: 4.6820 - val_accuracy10: 0.5046 - 151s/epoch - 15ms/step
Epoch 29/50
9854/9854 - 152s - loss: 2.4729 - accuracy10: 0.6021 - val_loss: 4.6826 - val_accuracy10: 0.5061 - 152s/epoch - 15ms/step
Epoch 30/50
9854/9854 - 152s - loss: 2.4714 - accuracy10: 0.6025 - val_loss: 4.6566 - val_accuracy10: 0.5067 - 152s/epoch - 15ms/step
Epoch 31/50
9854/9854 - 155s - loss: 2.4704 - accuracy10: 0.6027 - val_loss: 4.6864 - val_accuracy10: 0.5061 - 155s/epoch - 16ms/step
Epoch 32/50
9854/9854 - 154s - loss: 2.4692 - accuracy10: 0.6028 - val_loss: 4.6295 - val_accuracy10: 0.5057 - 154s/epoch - 16ms/step
Epoch 33/50
9854/9854 - 149s - loss: 2.4685 - accuracy10: 0.6030 - val_loss: 4.6664 - val_accuracy10: 0.5064 - 149s/epoch - 15ms/step
Epoch 34/50
9854/9854 - 152s - loss: 2.4674 - accuracy10: 0.6032 - val_loss: 4.6322 - val_accuracy10: 0.5066 - 152s/epoch - 15ms/step
Epoch 35/50
9854/9854 - 156s - loss: 2.4664 - accuracy10: 0.6032 - val_loss: 4.7213 - val_accuracy10: 0.5068 - 156s/epoch - 16ms/step
Epoch 36/50
9854/9854 - 152s - loss: 2.4649 - accuracy10: 0.6037 - val_loss: 4.7991 - val_accuracy10: 0.5042 - 152s/epoch - 15ms/step
Epoch 37/50
9854/9854 - 153s - loss: 2.4642 - accuracy10: 0.6036 - val_loss: 4.8142 - val_accuracy10: 0.5052 - 153s/epoch - 16ms/step
Epoch 38/50
9854/9854 - 152s - loss: 2.4631 - accuracy10: 0.6040 - val_loss: 4.7629 - val_accuracy10: 0.5048 - 152s/epoch - 15ms/step
Epoch 39/50
9854/9854 - 151s - loss: 2.4626 - accuracy10: 0.6043 - val_loss: 4.7880 - val_accuracy10: 0.5057 - 151s/epoch - 15ms/step
Epoch 40/50
9854/9854 - 152s - loss: 2.4616 - accuracy10: 0.6043 - val_loss: 4.7783 - val_accuracy10: 0.5057 - 152s/epoch - 15ms/step
Epoch 41/50
9854/9854 - 153s - loss: 2.4606 - accuracy10: 0.6044 - val_loss: 4.8136 - val_accuracy10: 0.5057 - 153s/epoch - 16ms/step
Epoch 42/50
9854/9854 - 151s - loss: 2.4598 - accuracy10: 0.6047 - val_loss: 4.7459 - val_accuracy10: 0.5056 - 151s/epoch - 15ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 119s - 119s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0266708
{'0': {'precision': 0.4651821456820058, 'recall': 0.20366361629944055, 'f1-score': 0.2832960404708629, 'support': 1322573}, '1': {'precision': 0.600379922930972, 'recall': 0.858433829227827, 'f1-score': 0.7065829143308482, 'support': 3418133}, '2': {'precision': 0.42678123585370126, 'recall': 0.19409283017450268, 'f1-score': 0.26683407300975565, 'support': 1330925}, 'accuracy': 0.5701802365789357, 'macro avg': {'precision': 0.49744776815555974, 'recall': 0.4187300919005901, 'f1-score': 0.4189043426038222, 'support': 6071631}, 'weighted avg': {'precision': 0.5328765185824842, 'recall': 0.5701802365789357, 'f1-score': 0.5179844113492115, 'support': 6071631}}
[[ 269360  966219   86994]
 [ 223927 2934241  259965]
 [  85755  986847  258323]]
Evaluating performance on  train set...
9854/9854 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3091285
{'0': {'precision': 0.4763796075468134, 'recall': 0.16021391291641388, 'f1-score': 0.23978453598812383, 'support': 629602}, '1': {'precision': 0.5254627113998432, 'recall': 0.866233793000669, 'f1-score': 0.6541276149462959, 'support': 1261492}, '2': {'precision': 0.4546002323524822, 'recall': 0.16621468478820778, 'f1-score': 0.24342596235647487, 'support': 630925}, 'accuracy': 0.5148601180244875, 'macro avg': {'precision': 0.4854808504330463, 'recall': 0.3975541302350969, 'f1-score': 0.3791127044302982, 'support': 2522019}, 'weighted avg': {'precision': 0.49548207685861595, 'recall': 0.5148601180244875, 'f1-score': 0.4479463088742735, 'support': 2522019}}
[[ 100871  493169   35562]
 [  78492 1092747   90253]
 [  32382  493674  104869]]
Evaluating performance on  val set...
3566/3566 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2430322
{'0': {'precision': 0.48166907193605685, 'recall': 0.14973384292850425, 'f1-score': 0.22845051697698449, 'support': 231818}, '1': {'precision': 0.5149733003334473, 'recall': 0.8679226724847098, 'f1-score': 0.6464072668789946, 'support': 447344}, '2': {'precision': 0.44769879322724854, 'recall': 0.16577469016681676, 'f1-score': 0.24195708777727704, 'support': 233190}, 'accuracy': 0.5059757637403107, 'macro avg': {'precision': 0.4814470551655842, 'recall': 0.3944770685266769, 'f1-score': 0.3722716238777521, 'support': 912352}, 'weighted avg': {'precision': 0.48931624918353944, 'recall': 0.5059757637403107, 'f1-score': 0.43683504572585014, 'support': 912352}}
[[ 34711 182620  14487]
 [ 25882 388260  33202]
 [ 11471 183062  38657]]
testing model out of sample: results/universal/W4/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 82s - 82s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8857303
{'0': {'precision': 0.45590474736442393, 'recall': 0.36331716295683913, 'f1-score': 0.4043788802622259, 'support': 641090}, '1': {'precision': 0.6656409830910712, 'recall': 0.8013617967044224, 'f1-score': 0.7272232357246383, 'support': 1761937}, '2': {'precision': 0.4596269405672726, 'recall': 0.2921486124257296, 'f1-score': 0.3572326138715551, 'support': 628615}, 'accuracy': 0.603144104745877, 'macro avg': {'precision': 0.5270575570075893, 'recall': 0.48560919069566366, 'f1-score': 0.49627824328613973, 'support': 3031642}, 'weighted avg': {'precision': 0.5785715597544457, 'recall': 0.603144104745877, 'f1-score': 0.5822344993898159, 'support': 3031642}}
[[ 232919  342227   65944]
 [ 200020 1411949  149968]
 [  77955  367011  183649]]
Evaluating performance on  train set...
5528/5528 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77352613
{'0': {'precision': 0.4698382252731999, 'recall': 0.3610236281552042, 'f1-score': 0.40830542414293014, 'support': 257828}, '1': {'precision': 0.7399915584796418, 'recall': 0.8544937183865424, 'f1-score': 0.7931313603882068, 'support': 900724}, '2': {'precision': 0.4791661938587931, 'recall': 0.33001187908343493, 'f1-score': 0.39084236539832107, 'support': 255912}, 'accuracy': 0.6696522498981946, 'macro avg': {'precision': 0.5629986592038784, 'recall': 0.5151764085417272, 'f1-score': 0.5307597166431527, 'support': 1414464}, 'weighted avg': {'precision': 0.643558256320802, 'recall': 0.6696522498981946, 'f1-score': 0.6502012591087831, 'support': 1414464}}
[[ 93082 134746  30000]
 [ 69263 769663  61798]
 [ 35770 135688  84454]]
Evaluating performance on  val set...
1908/1908 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81238127
{'0': {'precision': 0.4789580725907384, 'recall': 0.33071912369964673, 'f1-score': 0.39126850745410274, 'support': 92571}, '1': {'precision': 0.7219690710820011, 'recall': 0.8356072106885379, 'f1-score': 0.774642717343459, 'support': 304326}, '2': {'precision': 0.45101441164124806, 'recall': 0.3553130511463845, 'f1-score': 0.39748443183920096, 'support': 90720}, 'accuracy': 0.6503998014835414, 'macro avg': {'precision': 0.5506471851046625, 'recall': 0.507213128511523, 'f1-score': 0.5211318855455876, 'support': 487617}, 'weighted avg': {'precision': 0.6254244923536144, 'recall': 0.6503998014835414, 'f1-score': 0.631692135955579, 'support': 487617}}
[[ 30615  50426  11530]
 [ 22323 254297  27706]
 [ 10982  47504  32234]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5651248
{'0': {'precision': 0.5093424787133396, 'recall': 0.09366912420347535, 'f1-score': 0.15823796315006336, 'support': 45981}, '1': {'precision': 0.3429368029739777, 'recall': 0.9198138180534722, 'f1-score': 0.49960460100647014, 'support': 45332}, '2': {'precision': 0.4924357034795764, 'recall': 0.07178932974570477, 'f1-score': 0.12531038863544494, 'support': 45341}, 'accuracy': 0.36046511627906974, 'macro avg': {'precision': 0.44823832838896455, 'recall': 0.3617574240008841, 'f1-score': 0.2610509842639928, 'support': 136654}, 'weighted avg': {'precision': 0.4485314363106963, 'recall': 0.36046511627906974, 'f1-score': 0.2605537626966505, 'support': 136654}}
[[ 4307 39924  1750]
 [ 2030 41697  1605]
 [ 2119 39967  3255]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3397801
{'0': {'precision': 0.40405822673136305, 'recall': 0.10625833768342903, 'f1-score': 0.16826636050516644, 'support': 17241}, '1': {'precision': 0.4798804780876494, 'recall': 0.8825057448296533, 'f1-score': 0.6216992973359766, 'support': 30027}, '2': {'precision': 0.39810883828637594, 'recall': 0.11676477247000226, 'f1-score': 0.18056892778993439, 'support': 17668}, 'accuracy': 0.4680608599236171, 'macro avg': {'precision': 0.4273491810351295, 'recall': 0.36850961832769485, 'f1-score': 0.3235115285436925, 'support': 64936}, 'weighted avg': {'precision': 0.43750039973908106, 'recall': 0.4680608599236171, 'f1-score': 0.3812852183499061, 'support': 64936}}
[[ 1832 14100  1309]
 [ 1718 26499  1810]
 [  984 14621  2063]]
Evaluating performance on  val set...
81/81 - 1s - 595ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4089961
{'0': {'precision': 0.4262406526172672, 'recall': 0.107713451297028, 'f1-score': 0.17196928140427867, 'support': 5821}, '1': {'precision': 0.44832979555356944, 'recall': 0.8960589483085855, 'f1-score': 0.5976395249264679, 'support': 8957}, '2': {'precision': 0.41639871382636656, 'recall': 0.08871382085973625, 'f1-score': 0.14626570662148808, 'support': 5839}, 'accuracy': 0.44482708444487556, 'macro avg': {'precision': 0.43032305399906773, 'recall': 0.36416207348844987, 'f1-score': 0.30529150431741153, 'support': 20617}, 'weighted avg': {'precision': 0.43304985728721873, 'recall': 0.44482708444487556, 'f1-score': 0.34962098621446125, 'support': 20617}}
[[ 627 4873  321]
 [ 526 8026  405]
 [ 318 5003  518]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
1613/1613 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5483759
{'0': {'precision': 0.36799475909713536, 'recall': 0.36592443444273365, 'f1-score': 0.36695667666359827, 'support': 33772}, '1': {'precision': 0.9121193162704863, 'recall': 0.8408474379782054, 'f1-score': 0.8750344960708409, 'support': 345040}, '2': {'precision': 0.3162221350591619, 'recall': 0.5684696066045773, 'f1-score': 0.4063848779207141, 'support': 34037}, 'accuracy': 0.7795416726212248, 'macro avg': {'precision': 0.5321120701422611, 'recall': 0.5917471596751721, 'f1-score': 0.5494586835517178, 'support': 412849}, 'weighted avg': {'precision': 0.8184804146339357, 'recall': 0.7795416726212248, 'f1-score': 0.7948351225226495, 'support': 412849}}
[[ 12358  15642   5772]
 [ 18847 290126  36067]
 [  2377  12311  19349]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53160495
{'0': {'precision': 0.4448710177140163, 'recall': 0.41291572893223305, 'f1-score': 0.42829815517297276, 'support': 15996}, '1': {'precision': 0.8824519010185666, 'recall': 0.8871668319533814, 'f1-score': 0.8848030853098919, 'support': 130077}, '2': {'precision': 0.410092352266554, 'recall': 0.42164711723453113, 'f1-score': 0.41578947368421054, 'support': 16113}, 'accuracy': 0.7941437608671525, 'macro avg': {'precision': 0.579138423666379, 'recall': 0.5739098927067152, 'f1-score': 0.5762969047223584, 'support': 162186}, 'weighted avg': {'precision': 0.7923659921338246, 'recall': 0.7941437608671525, 'f1-score': 0.7931831601215602, 'support': 162186}}
[[  6605   7551   1840]
 [  6744 115400   7933]
 [  1498   7821   6794]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47866067
{'0': {'precision': 0.44419499679281593, 'recall': 0.34650988241180886, 'f1-score': 0.3893183415319747, 'support': 3997}, '1': {'precision': 0.9085643172304559, 'recall': 0.9007178106774338, 'f1-score': 0.9046240495635034, 'support': 44580}, '2': {'precision': 0.3590548273952372, 'recall': 0.468336142547556, 'f1-score': 0.406478578892372, 'support': 4153}, 'accuracy': 0.8246538972122132, 'macro avg': {'precision': 0.5706047138061697, 'recall': 0.5718546118789329, 'f1-score': 0.56680698999595, 'support': 52730}, 'weighted avg': {'precision': 0.830085328323289, 'recall': 0.8246538972122132, 'f1-score': 0.8263294344544719, 'support': 52730}}
[[ 1385  2107   505]
 [ 1459 40154  2967]
 [  274  1934  1945]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1756436
{'0': {'precision': 0.4506860456892284, 'recall': 0.36571158012539995, 'f1-score': 0.4037765439237087, 'support': 69697}, '1': {'precision': 0.5179812386031094, 'recall': 0.7183790172596597, 'f1-score': 0.6019392024001544, 'support': 115066}, '2': {'precision': 0.4396959000814553, 'recall': 0.2374277922763393, 'f1-score': 0.3083514223694733, 'support': 68206}, 'accuracy': 0.49153848890575524, 'macro avg': {'precision': 0.4694543947912644, 'recall': 0.44050612988713295, 'f1-score': 0.43802238956444545, 'support': 252969}, 'weighted avg': {'precision': 0.47833289094103737, 'recall': 0.49153848890575524, 'f1-score': 0.4681845094037577, 'support': 252969}}
[[25489 36074  8134]
 [19903 82661 12502]
 [11164 40848 16194]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2630038
{'0': {'precision': 0.4786384303444886, 'recall': 0.41635489043292356, 'f1-score': 0.44532947139753803, 'support': 28065}, '1': {'precision': 0.4417439621981099, 'recall': 0.6704405856768153, 'f1-score': 0.5325790244095423, 'support': 30119}, '2': {'precision': 0.4816958031309009, 'recall': 0.2788631074123704, 'f1-score': 0.3532328308207705, 'support': 28358}, 'accuracy': 0.45973053546255, 'macro avg': {'precision': 0.4673593985578331, 'recall': 0.45521952784070313, 'f1-score': 0.4437137755426169, 'support': 86542}, 'weighted avg': {'precision': 0.4667999760838556, 'recall': 0.45973053546255, 'f1-score': 0.44551658001176675, 'support': 86542}}
[[11685 11858  4522]
 [ 5939 20193  3987]
 [ 6789 13661  7908]]
Evaluating performance on  val set...
124/124 - 1s - 804ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3006638
{'0': {'precision': 0.4896189824321241, 'recall': 0.4001118672508623, 'f1-score': 0.44036320730518647, 'support': 10727}, '1': {'precision': 0.38504307447913483, 'recall': 0.6372093023255814, 'f1-score': 0.4800243744525269, 'support': 9890}, '2': {'precision': 0.4785122675418034, 'recall': 0.28053137883646356, 'f1-score': 0.35370220630703475, 'support': 10915}, 'accuracy': 0.4330838513256374, 'macro avg': {'precision': 0.45105810815102076, 'recall': 0.4392841828043024, 'f1-score': 0.4246965960215827, 'support': 31532}, 'weighted avg': {'precision': 0.4529741288648618, 'recall': 0.4330838513256374, 'f1-score': 0.42280466732016714, 'support': 31532}}
[[4292 4664 1771]
 [2022 6302 1566]
 [2452 5401 3062]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3337927
{'0': {'precision': 0.3674469814140037, 'recall': 0.39991440798858774, 'f1-score': 0.38299383854529556, 'support': 70100}, '1': {'precision': 0.5134988704087996, 'recall': 0.47983493494832163, 'f1-score': 0.49609646978652805, 'support': 104686}, '2': {'precision': 0.3383671316937533, 'recall': 0.34202364799379725, 'f1-score': 0.3401855645258465, 'support': 61908}, 'accuracy': 0.420120493126146, 'macro avg': {'precision': 0.40643766117218555, 'recall': 0.4072576636435689, 'f1-score': 0.4064252909525567, 'support': 236694}, 'weighted avg': {'precision': 0.42443749538912745, 'recall': 0.420120493126146, 'f1-score': 0.4218207096367622, 'support': 236694}}
[[28034 24521 17545]
 [30596 50232 23858]
 [17664 23070 21174]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4258007
{'0': {'precision': 0.38735521814799256, 'recall': 0.43393055228747185, 'f1-score': 0.40932223543400714, 'support': 29749}, '1': {'precision': 0.3548469063651378, 'recall': 0.28944004974265086, 'f1-score': 0.31882348464670296, 'support': 28949}, '2': {'precision': 0.38961778002592395, 'recall': 0.412560257096947, 'f1-score': 0.40076093849080535, 'support': 29872}, 'accuracy': 0.37949644349102407, 'macro avg': {'precision': 0.37727330151301813, 'recall': 0.3786436197090232, 'f1-score': 0.3763022195238385, 'support': 88570}, 'weighted avg': {'precision': 0.37749300894189236, 'recall': 0.37949644349102407, 'f1-score': 0.376855357271774, 'support': 88570}}
[[12909  7530  9310]
 [10573  8379  9997]
 [ 9844  7704 12324]]
Evaluating performance on  val set...
127/127 - 1s - 827ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3990016
{'0': {'precision': 0.40628322861285643, 'recall': 0.3869096934548467, 'f1-score': 0.3963598642021878, 'support': 10863}, '1': {'precision': 0.3802773497688752, 'recall': 0.3363925488414357, 'f1-score': 0.35699132111861137, 'support': 11005}, '2': {'precision': 0.36600771060618487, 'recall': 0.42891473613380754, 'f1-score': 0.3949721164911038, 'support': 10403}, 'accuracy': 0.38322332744569426, 'macro avg': {'precision': 0.38418942966263875, 'recall': 0.38407232614336334, 'f1-score': 0.382774433937301, 'support': 32271}, 'weighted avg': {'precision': 0.3844313829774123, 'recall': 0.38322332744569426, 'f1-score': 0.3824871129371769, 'support': 32271}}
[[4203 3019 3641]
 [3215 3702 4088]
 [2927 3014 4462]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2097083
{'0': {'precision': 0.4414507154889316, 'recall': 0.4237220316838151, 'f1-score': 0.43240472996058366, 'support': 122460}, '1': {'precision': 0.47809473725433155, 'recall': 0.5144198645598194, 'f1-score': 0.49559256767728316, 'support': 166125}, '2': {'precision': 0.41016747059779957, 'recall': 0.38348112490499114, 'f1-score': 0.3963756350494946, 'support': 118410}, 'accuracy': 0.44903500042998074, 'macro avg': {'precision': 0.4432376411136876, 'recall': 0.4405410070495419, 'f1-score': 0.4414576442291205, 'support': 406995}, 'weighted avg': {'precision': 0.447306411721608, 'recall': 0.44903500042998074, 'f1-score': 0.44771419177771815, 'support': 406995}}
[[51889 45257 25314]
 [40683 85458 39984]
 [24970 48032 45408]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3054355
{'0': {'precision': 0.4696251102266498, 'recall': 0.4274032621898317, 'f1-score': 0.4475205250786369, 'support': 46104}, '1': {'precision': 0.3972591748640018, 'recall': 0.5475537467928868, 'f1-score': 0.4604525290851771, 'support': 45212}, '2': {'precision': 0.46982900607911837, 'recall': 0.33846784458395357, 'f1-score': 0.39347428084167235, 'support': 46353}, 'accuracy': 0.4369175340853787, 'macro avg': {'precision': 0.44557109705659004, 'recall': 0.43780828452222403, 'f1-score': 0.43381577833516216, 'support': 137669}, 'weighted avg': {'precision': 0.44592799987379933, 'recall': 0.4369175340853787, 'f1-score': 0.43357022549069535, 'support': 137669}}
[[19705 17827  8572]
 [11324 24756  9132]
 [10930 19734 15689]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2951831
{'0': {'precision': 0.46475216365066874, 'recall': 0.3483722576079264, 'f1-score': 0.3982336681723185, 'support': 16956}, '1': {'precision': 0.41574779280815427, 'recall': 0.5527455919395466, 'f1-score': 0.4745572111329773, 'support': 19850}, '2': {'precision': 0.41616287957751374, 'recall': 0.3589236485676615, 'f1-score': 0.3854297390352994, 'support': 16686}, 'accuracy': 0.4275031780453152, 'macro avg': {'precision': 0.43222094534544553, 'recall': 0.42001383270504483, 'f1-score': 0.41940687278019845, 'support': 53492}, 'weighted avg': {'precision': 0.4314107751202609, 'recall': 0.4275031780453152, 'f1-score': 0.42256209048198673, 'support': 53492}}
[[ 5907  7625  3424]
 [ 3900 10972  4978]
 [ 2903  7794  5989]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59595597
{'0': {'precision': 0.4395868238391575, 'recall': 0.5052744701887116, 'f1-score': 0.47014731351820516, 'support': 116315}, '1': {'precision': 0.8997823125704714, 'recall': 0.7562516776133793, 'f1-score': 0.821797001029817, 'support': 730204}, '2': {'precision': 0.373913989806468, 'recall': 0.6790575873115215, 'f1-score': 0.48227157750062144, 'support': 121433}, 'accuracy': 0.716408458270658, 'macro avg': {'precision': 0.5710943754053657, 'recall': 0.6468612450378708, 'f1-score': 0.5914052973495479, 'support': 967952}, 'weighted avg': {'precision': 0.7785103834768964, 'recall': 0.716408458270658, 'f1-score': 0.73694597106311, 'support': 967952}}
[[ 58771  35091  22453]
 [ 62367 552218 115619]
 [ 12558  26415  82460]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58149475
{'0': {'precision': 0.49150090978367367, 'recall': 0.5337341462178914, 'f1-score': 0.5117476561361466, 'support': 59213}, '1': {'precision': 0.872846642026299, 'recall': 0.7928566529492456, 'f1-score': 0.8309310178138539, 'support': 291600}, '2': {'precision': 0.45298731600764514, 'recall': 0.6192673781367176, 'f1-score': 0.5232343939274476, 'support': 58939}, 'accuracy': 0.7304418282278061, 'macro avg': {'precision': 0.6057782892725393, 'recall': 0.6486193924346182, 'f1-score': 0.621971022625816, 'support': 409752}, 'weighted avg': {'precision': 0.757345769158086, 'recall': 0.7304418282278061, 'f1-score': 0.7405467470591952, 'support': 409752}}
[[ 31604  18183   9426]
 [ 25754 231197  34649]
 [  6943  15497  36499]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5342699
{'0': {'precision': 0.48528272656855154, 'recall': 0.5126241963763881, 'f1-score': 0.49857889949977263, 'support': 17110}, '1': {'precision': 0.8921961274337039, 'recall': 0.8182877852874915, 'f1-score': 0.8536452026588597, 'support': 102090}, '2': {'precision': 0.44268128092920533, 'recall': 0.638282816369855, 'f1-score': 0.5227849018329349, 'support': 16958}, 'accuracy': 0.7574582470365311, 'macro avg': {'precision': 0.6067200449771536, 'recall': 0.6563982660112448, 'f1-score': 0.6250030013305224, 'support': 136158}, 'weighted avg': {'precision': 0.7850767436602493, 'recall': 0.7574582470365311, 'f1-score': 0.7678190783881006, 'support': 136158}}
[[ 8771  5692  2647]
 [ 7571 83539 10980]
 [ 1732  4402 10824]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64344424
{'0': {'precision': 0.4554310864215181, 'recall': 0.517852373930309, 'f1-score': 0.48464004346644934, 'support': 172246}, '1': {'precision': 0.8130145104540689, 'recall': 0.8172234029253657, 'f1-score': 0.815113523502423, 'support': 799900}, '2': {'precision': 0.4709989791867521, 'recall': 0.39357750884114373, 'f1-score': 0.4288217583105554, 'support': 168813}, 'accuracy': 0.709347136926042, 'macro avg': {'precision': 0.5798148586874464, 'recall': 0.5762177618989395, 'f1-score': 0.5761917750931426, 'support': 1140959}, 'weighted avg': {'precision': 0.7084279456995595, 'recall': 0.709347136926042, 'f1-score': 0.7080686544058025, 'support': 1140959}}
[[ 89198  67231  15817]
 [ 87397 653697  58806]
 [ 19259  83113  66441]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55417377
{'0': {'precision': 0.4749951956479962, 'recall': 0.40380023625807426, 'f1-score': 0.4365138125675006, 'support': 79574}, '1': {'precision': 0.8397605976499932, 'recall': 0.8871897659358261, 'f1-score': 0.8628238816595304, 'support': 464488}, '2': {'precision': 0.4831644433042586, 'recall': 0.39300945549396804, 'f1-score': 0.433448645383083, 'support': 76675}, 'accuracy': 0.7641803211343935, 'macro avg': {'precision': 0.5993067455340827, 'recall': 0.5613331525626228, 'f1-score': 0.5775954465367047, 'support': 620737}, 'weighted avg': {'precision': 0.7489526512357049, 'recall': 0.7641803211343935, 'f1-score': 0.7551364976636903, 'support': 620737}}
[[ 32132  40331   7111]
 [ 27276 412089  25123]
 [  8239  38302  30134]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.593078
{'0': {'precision': 0.4923469387755102, 'recall': 0.36448805776708015, 'f1-score': 0.4188778007106837, 'support': 27005}, '1': {'precision': 0.8345924841386042, 'recall': 0.8652791364479676, 'f1-score': 0.8496588274263001, 'support': 148225}, '2': {'precision': 0.4465251315550717, 'recall': 0.47337642351492765, 'f1-score': 0.45955889218817114, 'support': 25992}, 'accuracy': 0.7474480921569212, 'macro avg': {'precision': 0.5911548514897288, 'recall': 0.5677145392433252, 'f1-score': 0.576031840108385, 'support': 201222}, 'weighted avg': {'precision': 0.7385344607570578, 'recall': 0.7474480921569212, 'f1-score': 0.7414563488545501, 'support': 201222}}
[[  9843  14079   3083]
 [  7801 128256  12168]
 [  2348  11340  12304]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
4676/4676 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6601028
{'0': {'precision': 0.4918385021717716, 'recall': 0.39851617741589884, 'f1-score': 0.4402865605922962, 'support': 186680}, '1': {'precision': 0.7824479304916987, 'recall': 0.8723534333360532, 'f1-score': 0.8249583949970344, 'support': 821111}, '2': {'precision': 0.5063060850074076, 'recall': 0.3486136217084747, 'f1-score': 0.4129164332063518, 'support': 189198}, 'accuracy': 0.7156715725875509, 'macro avg': {'precision': 0.593530839223626, 'recall': 0.5398277441534756, 'f1-score': 0.5593871295985607, 'support': 1196989}, 'weighted avg': {'precision': 0.6934776450833108, 'recall': 0.7156715725875509, 'f1-score': 0.6998377354641983, 'support': 1196989}}
[[ 74395  95063  17222]
 [ 57720 716299  47092]
 [ 19144 104097  65957]]
Evaluating performance on  train set...
2108/2108 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6412963
{'0': {'precision': 0.48899639655365895, 'recall': 0.4553825431660106, 'f1-score': 0.47159125070646096, 'support': 86121}, '1': {'precision': 0.8184201706111947, 'recall': 0.8234436657447369, 'f1-score': 0.8209242331608535, 'support': 367707}, '2': {'precision': 0.4738133656044104, 'recall': 0.4940933151049883, 'f1-score': 0.48374088374088375, 'support': 85581}, 'accuracy': 0.7124260069817152, 'macro avg': {'precision': 0.593743310923088, 'recall': 0.5909731746719119, 'f1-score': 0.5920854558693994, 'support': 539409}, 'weighted avg': {'precision': 0.7111507334588767, 'recall': 0.7124260069817152, 'f1-score': 0.7116539132205759, 'support': 539409}}
[[ 39218  34251  12652]
 [ 30614 302786  34307]
 [ 10369  32927  42285]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6963392
{'0': {'precision': 0.48833903998966344, 'recall': 0.42104383668467665, 'f1-score': 0.4522014836085188, 'support': 35906}, '1': {'precision': 0.7908743312398232, 'recall': 0.8174659824333361, 'f1-score': 0.8039503290093512, 'support': 133093}, '2': {'precision': 0.4775843216418538, 'recall': 0.4840029550491561, 'f1-score': 0.48077221602856296, 'support': 35194}, 'accuracy': 0.6902832124509655, 'macro avg': {'precision': 0.5855992309571135, 'recall': 0.5741709247223896, 'f1-score': 0.5789746762154776, 'support': 204193}, 'weighted avg': {'precision': 0.6836779005814796, 'recall': 0.6902832124509655, 'f1-score': 0.6863957382486093, 'support': 204193}}
[[ 15118  15208   5580]
 [ 11241 108799  13053]
 [  4599  13561  17034]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
4274/4274 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8654435
{'0': {'precision': 0.4696255347351931, 'recall': 0.27027905646147043, 'f1-score': 0.3430981451626215, 'support': 230706}, '1': {'precision': 0.639984317313033, 'recall': 0.8630242606771842, 'f1-score': 0.7349552096803372, 'support': 635514}, '2': {'precision': 0.5021909428245424, 'recall': 0.22987118435778708, 'f1-score': 0.31538095610860545, 'support': 227845}, 'accuracy': 0.6061742218241146, 'macro avg': {'precision': 0.5372669316242561, 'recall': 0.4543915004988139, 'f1-score': 0.4644781036505214, 'support': 1094065}, 'weighted avg': {'precision': 0.5753644595315179, 'recall': 0.6061742218241146, 'f1-score': 0.5649455011788539, 'support': 1094065}}
[[ 62355 153355  14996]
 [ 50128 548464  36922]
 [ 20293 155177  52375]]
Evaluating performance on  train set...
1972/1972 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7418512
{'0': {'precision': 0.4675894665766374, 'recall': 0.3189627377826908, 'f1-score': 0.3792338654472769, 'support': 86844}, '1': {'precision': 0.7415180594946709, 'recall': 0.8652403604954092, 'f1-score': 0.7986158281529172, 'support': 330878}, '2': {'precision': 0.4833684921103704, 'recall': 0.3297566142439384, 'f1-score': 0.3920527263145648, 'support': 86858}, 'accuracy': 0.6790419755043798, 'macro avg': {'precision': 0.5641586727272262, 'recall': 0.5046532375073461, 'f1-score': 0.523300806638253, 'support': 504580}, 'weighted avg': {'precision': 0.6499341484255851, 'recall': 0.6790419755043798, 'f1-score': 0.6564499375732584, 'support': 504580}}
[[ 27700  50505   8639]
 [ 22615 286289  21974]
 [  8925  49291  28642]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75919706
{'0': {'precision': 0.47111068665838984, 'recall': 0.30771629966939057, 'f1-score': 0.3722737906573089, 'support': 32062}, '1': {'precision': 0.7304342150114954, 'recall': 0.8578327825287043, 'f1-score': 0.7890240319642753, 'support': 117404}, '2': {'precision': 0.4720714969677625, 'recall': 0.3308936333418563, 'f1-score': 0.389071572182867, 'support': 31288}, 'accuracy': 0.669041902253892, 'macro avg': {'precision': 0.5578721328792159, 'recall': 0.49881423851331713, 'f1-score': 0.5167897982681504, 'support': 180754}, 'weighted avg': {'precision': 0.6397137679496899, 'recall': 0.669041902253892, 'f1-score': 0.6458705814269446, 'support': 180754}}
[[  9866  19187   3009]
 [  8122 100713   8569]
 [  2954  17981  10353]]
testing model on single stock: results/universal/W4/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
12724/12724 - 76s - 76s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3275784
{'0': {'precision': 0.5191593289361103, 'recall': 0.10469408303538472, 'f1-score': 0.17424897852354848, 'support': 915706}, '1': {'precision': 0.450440171043331, 'recall': 0.9349103657348994, 'f1-score': 0.6079633621555021, 'support': 1417092}, '2': {'precision': 0.5297846725895674, 'recall': 0.07522050654027862, 'f1-score': 0.13173662905424544, 'support': 924349}, 'accuracy': 0.45753323383930783, 'macro avg': {'precision': 0.4997947241896696, 'recall': 0.3716083184368542, 'f1-score': 0.3046496565777653, 'support': 3257147}, 'weighted avg': {'precision': 0.4922769551544342, 'recall': 0.45753323383930783, 'f1-score': 0.350881146371721, 'support': 3257147}}
[[  95869  795706   24131]
 [  54657 1324854   37581]
 [  34136  820683   69530]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.8943198
{'0': {'precision': 0.5496099272213205, 'recall': 0.023937170912358075, 'f1-score': 0.04587629091258725, 'support': 438523}, '1': {'precision': 0.33707223435888334, 'recall': 0.9814919701506682, 'f1-score': 0.5018089983825155, 'support': 443159}, '2': {'precision': 0.5379977788354752, 'recall': 0.015398937377957405, 'f1-score': 0.029940886395041347, 'support': 440420}, 'accuracy': 0.3420583283286766, 'macro avg': {'precision': 0.47489331347189295, 'recall': 0.3402760261469946, 'f1-score': 0.19254205856338136, 'support': 1322102}, 'weighted avg': {'precision': 0.47450058329527034, 'recall': 0.3420583283286766, 'f1-score': 0.19339320855740463, 'support': 1322102}}
[[ 10497 425604   2422]
 [  4800 434957   3402]
 [  3802 429836   6782]]
Evaluating performance on  val set...
1903/1903 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.7430837
{'0': {'precision': 0.5473516949152543, 'recall': 0.03151724390333167, 'f1-score': 0.05960249622221453, 'support': 163942}, '1': {'precision': 0.3243572458635902, 'recall': 0.9710747496423462, 'f1-score': 0.4862858604918925, 'support': 156576}, '2': {'precision': 0.5062528422010004, 'recall': 0.02674763638111027, 'f1-score': 0.050810712125880036, 'support': 166482}, 'accuracy': 0.3319650924024641, 'macro avg': {'precision': 0.459320594326615, 'recall': 0.3431132099755961, 'f1-score': 0.19889968961332904, 'support': 487000}, 'weighted avg': {'precision': 0.46160672971548466, 'recall': 0.3319650924024641, 'f1-score': 0.19378052629195403, 'support': 487000}}
[[  5167 156682   2093]
 [  2279 152047   2250]
 [  1994 160035   4453]]
training model: results/universal/W4/deepLOB_L1/h20
Epoch 1/50
9854/9854 - 152s - loss: 2.8246 - accuracy20: 0.5245 - val_loss: 4.4982 - val_accuracy20: 0.4751 - 152s/epoch - 15ms/step
Epoch 2/50
9854/9854 - 148s - loss: 2.7203 - accuracy20: 0.5512 - val_loss: 4.4161 - val_accuracy20: 0.4784 - 148s/epoch - 15ms/step
Epoch 3/50
9854/9854 - 150s - loss: 2.6953 - accuracy20: 0.5566 - val_loss: 4.4614 - val_accuracy20: 0.4790 - 150s/epoch - 15ms/step
Epoch 4/50
9854/9854 - 151s - loss: 2.6818 - accuracy20: 0.5596 - val_loss: 4.3508 - val_accuracy20: 0.4807 - 151s/epoch - 15ms/step
Epoch 5/50
9854/9854 - 151s - loss: 2.6696 - accuracy20: 0.5621 - val_loss: 4.3482 - val_accuracy20: 0.4814 - 151s/epoch - 15ms/step
Epoch 6/50
9854/9854 - 153s - loss: 2.6617 - accuracy20: 0.5638 - val_loss: 4.3258 - val_accuracy20: 0.4812 - 153s/epoch - 16ms/step
Epoch 7/50
9854/9854 - 152s - loss: 2.6551 - accuracy20: 0.5651 - val_loss: 4.3818 - val_accuracy20: 0.4817 - 152s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 154s - loss: 2.6492 - accuracy20: 0.5663 - val_loss: 4.3734 - val_accuracy20: 0.4819 - 154s/epoch - 16ms/step
Epoch 9/50
9854/9854 - 152s - loss: 2.6443 - accuracy20: 0.5672 - val_loss: 4.5411 - val_accuracy20: 0.4820 - 152s/epoch - 15ms/step
Epoch 10/50
9854/9854 - 157s - loss: 2.6394 - accuracy20: 0.5682 - val_loss: 4.5862 - val_accuracy20: 0.4812 - 157s/epoch - 16ms/step
Epoch 11/50
9854/9854 - 151s - loss: 2.6363 - accuracy20: 0.5690 - val_loss: 4.6540 - val_accuracy20: 0.4813 - 151s/epoch - 15ms/step
Epoch 12/50
9854/9854 - 151s - loss: 2.6331 - accuracy20: 0.5694 - val_loss: 4.7076 - val_accuracy20: 0.4819 - 151s/epoch - 15ms/step
Epoch 13/50
9854/9854 - 156s - loss: 2.6299 - accuracy20: 0.5701 - val_loss: 4.6954 - val_accuracy20: 0.4823 - 156s/epoch - 16ms/step
Epoch 14/50
9854/9854 - 158s - loss: 2.6268 - accuracy20: 0.5705 - val_loss: 4.7143 - val_accuracy20: 0.4831 - 158s/epoch - 16ms/step
Epoch 15/50
9854/9854 - 155s - loss: 2.6244 - accuracy20: 0.5711 - val_loss: 4.7380 - val_accuracy20: 0.4825 - 155s/epoch - 16ms/step
Epoch 16/50
9854/9854 - 152s - loss: 2.6221 - accuracy20: 0.5714 - val_loss: 4.8223 - val_accuracy20: 0.4821 - 152s/epoch - 15ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 118s - 118s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.082328
{'0': {'precision': 0.48914016465539384, 'recall': 0.12864896071538975, 'f1-score': 0.20371797185424198, 'support': 1465383}, '1': {'precision': 0.5425610502623547, 'recall': 0.9089598467635941, 'f1-score': 0.6795165128064268, 'support': 3140768}, '2': {'precision': 0.4798527031516154, 'recall': 0.13898040232551792, 'f1-score': 0.2155350809474853, 'support': 1465480}, 'accuracy': 0.5347862872430817, 'macro avg': {'precision': 0.5038513060231212, 'recall': 0.39219640326816724, 'f1-score': 0.3662565218693847, 'support': 6071631}, 'weighted avg': {'precision': 0.514532356467025, 'recall': 0.5347862872430817, 'f1-score': 0.4526939996963948, 'support': 6071631}}
[[ 188520 1209826   67037]
 [ 132197 2854832  153739]
 [  64694 1197113  203673]]
Evaluating performance on  train set...
9854/9854 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2676399
{'0': {'precision': 0.5256617192721403, 'recall': 0.12180764645378465, 'f1-score': 0.19778423581045015, 'support': 684448}, '1': {'precision': 0.4815859787941275, 'recall': 0.9102513433870688, 'f1-score': 0.6299073565102496, 'support': 1153800}, '2': {'precision': 0.5116206477333713, 'recall': 0.13663200106468393, 'f1-score': 0.2156682368068404, 'support': 683771}, 'accuracy': 0.48653241708329714, 'macro avg': {'precision': 0.5062894485998798, 'recall': 0.38956366363517914, 'f1-score': 0.34778660970918, 'support': 2522019}, 'weighted avg': {'precision': 0.5016906600173661, 'recall': 0.48653241708329714, 'f1-score': 0.4003252229753888, 'support': 2522019}}
[[  83371  568000   33077]
 [  47448 1050248   56104]
 [  27783  562563   93425]]
Evaluating performance on  val set...
3566/3566 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2384857
{'0': {'precision': 0.5386799148332151, 'recall': 0.10629316346700171, 'f1-score': 0.17755157283357342, 'support': 249922}, '1': {'precision': 0.4758916880400627, 'recall': 0.9154891140279908, 'f1-score': 0.62624647287001, 'support': 414065}, '2': {'precision': 0.5038203531570556, 'recall': 0.13487005012783604, 'f1-score': 0.2127800134031653, 'support': 248365}, 'accuracy': 0.48132080600469995, 'macro avg': {'precision': 0.5061306520101111, 'recall': 0.3855507758742762, 'f1-score': 0.33885935303558284, 'support': 912352}, 'weighted avg': {'precision': 0.500694244650209, 'recall': 0.48132080600469995, 'f1-score': 0.3907788857847741, 'support': 912352}}
[[ 26565 211809  11548]
 [ 13552 379072  21441]
 [  9198 205670  33497]]
testing model out of sample: results/universal/W4/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 75s - 75s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0266837
{'0': {'precision': 0.49530837205065137, 'recall': 0.1816116910229645, 'f1-score': 0.26577374769336054, 'support': 778375}, '1': {'precision': 0.531611674996421, 'recall': 0.9011253685199808, 'f1-score': 0.6687183369879695, 'support': 1491778}, '2': {'precision': 0.5011261571839635, 'recall': 0.1431695008069716, 'f1-score': 0.22271136201372155, 'support': 761489}, 'accuracy': 0.5260063688258706, 'macro avg': {'precision': 0.5093487347436786, 'recall': 0.40863552011663895, 'f1-score': 0.3857344822316839, 'support': 3031642}, 'weighted avg': {'precision': 0.5146334269368203, 'recall': 0.5260063688258706, 'f1-score': 0.45323398888276567, 'support': 3031642}}
[[ 141362  591194   45819]
 [  84786 1344279   62713]
 [  59254  593213  109022]]
Evaluating performance on  train set...
5528/5528 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9240546
{'0': {'precision': 0.5120714413929277, 'recall': 0.18224300558020384, 'f1-score': 0.2688160644159711, 'support': 313071}, '1': {'precision': 0.6099916866578781, 'recall': 0.9272285265595471, 'f1-score': 0.7358759505894662, 'support': 788963}, '2': {'precision': 0.5329825474380102, 'recall': 0.17701885222289793, 'f1-score': 0.2657683741112982, 'support': 312430}, 'accuracy': 0.5966288290122619, 'macro avg': {'precision': 0.5516818918296053, 'recall': 0.428830128120883, 'f1-score': 0.4234867963722451, 'support': 1414464}, 'weighted avg': {'precision': 0.5713085144655801, 'recall': 0.5966288290122619, 'f1-score': 0.5286606268037097, 'support': 1414464}}
[[ 57055 234798  21218]
 [ 30171 731549  27243]
 [ 24194 232930  55306]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94834507
{'0': {'precision': 0.544330015534204, 'recall': 0.16801633812821878, 'f1-score': 0.2567749114545874, 'support': 112620}, '1': {'precision': 0.5958107388097977, 'recall': 0.9071971491934719, 'f1-score': 0.7192481264022865, 'support': 263785}, '2': {'precision': 0.4998340135523053, 'recall': 0.2301550192425278, 'f1-score': 0.3151809187235641, 'support': 111212}, 'accuracy': 0.5820613309216045, 'macro avg': {'precision': 0.5466582559654357, 'recall': 0.43512283552140624, 'f1-score': 0.43040131886014604, 'support': 487617}, 'weighted avg': {'precision': 0.5620311072041859, 'recall': 0.5820613309216045, 'f1-score': 0.5202787390187951, 'support': 487617}}
[[ 18922  83902   9796]
 [  8663 239305  15817]
 [  7177  78439  25596]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.6879157
{'0': {'precision': 0.4954155575273588, 'recall': 0.03176981582990346, 'f1-score': 0.059710537573078565, 'support': 52723}, '1': {'precision': 0.2361381713159282, 'recall': 0.9715201810637495, 'f1-score': 0.3799302981689439, 'support': 31812}, '2': {'precision': 0.5137959866220736, 'recall': 0.023580651969531265, 'f1-score': 0.045091816330648855, 'support': 52119}, 'accuracy': 0.247413174879623, 'macro avg': {'precision': 0.41511657182178685, 'recall': 0.3422902162877281, 'f1-score': 0.16157755069089044, 'support': 136654}, 'weighted avg': {'precision': 0.44206795975363394, 'recall': 0.247413174879623, 'f1-score': 0.12867974368224094, 'support': 136654}}
[[ 1675 50246   802]
 [  545 30906   361]
 [ 1161 49729  1229]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5120484
{'0': {'precision': 0.41622103386809267, 'recall': 0.04515567588474183, 'f1-score': 0.08147243545010467, 'support': 20684}, '1': {'precision': 0.35714051913194333, 'recall': 0.9507668177065179, 'f1-score': 0.5192376329502464, 'support': 22952}, '2': {'precision': 0.41635220125786165, 'recall': 0.03107981220657277, 'f1-score': 0.05784185233726519, 'support': 21300}, 'accuracy': 0.36063200689910063, 'macro avg': {'precision': 0.3965712514192992, 'recall': 0.3423341019326109, 'f1-score': 0.21951730691253876, 'support': 64936}, 'weighted avg': {'precision': 0.39538171347844714, 'recall': 0.36063200689910063, 'f1-score': 0.22845185199439091, 'support': 64936}}
[[  934 19258   492]
 [  694 21822   436]
 [  616 20022   662]]
Evaluating performance on  val set...
81/81 - 1s - 616ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5564501
{'0': {'precision': 0.4474393530997305, 'recall': 0.047550845030077345, 'f1-score': 0.0859658208182289, 'support': 6982}, '1': {'precision': 0.33173151449387694, 'recall': 0.9542211652794292, 'f1-score': 0.4923124113339213, 'support': 6728}, '2': {'precision': 0.38697318007662834, 'recall': 0.0292456927754452, 'f1-score': 0.054381477991654326, 'support': 6907}, 'accuracy': 0.33729446573216276, 'macro avg': {'precision': 0.3887146825567453, 'recall': 0.34367256769498394, 'f1-score': 0.21088657004793485, 'support': 20617}, 'weighted avg': {'precision': 0.38942304640085335, 'recall': 0.33729446573216276, 'f1-score': 0.2079887535963454, 'support': 20617}}
[[ 332 6456  194]
 [ 182 6420  126]
 [ 228 6477  202]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
1613/1613 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62085706
{'0': {'precision': 0.4033598891582958, 'recall': 0.3011962495958616, 'f1-score': 0.34487098804279415, 'support': 46395}, '1': {'precision': 0.842894378009195, 'recall': 0.8747702759819038, 'f1-score': 0.8585365553880923, 'support': 319405}, '2': {'precision': 0.4039511140600586, 'recall': 0.40113498692852134, 'f1-score': 0.40253812519995735, 'support': 47049}, 'accuracy': 0.7563370627033128, 'macro avg': {'precision': 0.5500684604091831, 'recall': 0.5257005041687622, 'f1-score': 0.5353152228769479, 'support': 412849}, 'weighted avg': {'precision': 0.7434777771798837, 'recall': 0.7563370627033128, 'f1-score': 0.7488456414246173, 'support': 412849}}
[[ 13974  27123   5298]
 [ 17449 279406  22550]
 [  3221  24955  18873]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6374302
{'0': {'precision': 0.5080510827318157, 'recall': 0.2983371372676883, 'f1-score': 0.37592440427280194, 'support': 21469}, '1': {'precision': 0.8045601638808895, 'recall': 0.9109396796584817, 'f1-score': 0.8544515823907303, 'support': 118998}, '2': {'precision': 0.46447093688960733, 'recall': 0.317510014273217, 'f1-score': 0.37718098780287695, 'support': 21719}, 'accuracy': 0.750379194258444, 'macro avg': {'precision': 0.5923607278341042, 'recall': 0.5089289437331289, 'f1-score': 0.5358523248221364, 'support': 162186}, 'weighted avg': {'precision': 0.7197676948378579, 'recall': 0.750379194258444, 'f1-score': 0.727194359012218, 'support': 162186}}
[[  6405  13054   2010]
 [  4657 108400   5941]
 [  1545  13278   6896]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57396585
{'0': {'precision': 0.5437048917401764, 'recall': 0.24912731949292669, 'f1-score': 0.3416908151694595, 'support': 5443}, '1': {'precision': 0.849167613826302, 'recall': 0.916907305804216, 'f1-score': 0.8817383456558713, 'support': 41556}, '2': {'precision': 0.4199440820130475, 'recall': 0.39312510905601117, 'f1-score': 0.40609228550829124, 'support': 5731}, 'accuracy': 0.7910487388583349, 'macro avg': {'precision': 0.604272195859842, 'recall': 0.5197199114510513, 'f1-score': 0.5431738154445407, 'support': 52730}, 'weighted avg': {'precision': 0.7709860538578487, 'recall': 0.7910487388583349, 'f1-score': 0.7742965425240048, 'support': 52730}}
[[ 1356  3534   553]
 [  894 38103  2559]
 [  244  3234  2253]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2362157
{'0': {'precision': 0.4687744082589058, 'recall': 0.18807308200607653, 'f1-score': 0.2684454124693711, 'support': 73397}, '1': {'precision': 0.4521548681551389, 'recall': 0.8651421382251455, 'f1-score': 0.5939104507942959, 'support': 108099}, '2': {'precision': 0.4408557046979866, 'recall': 0.10293397506750801, 'f1-score': 0.16689919578952142, 'support': 71473}, 'accuracy': 0.4533440856389518, 'macro avg': {'precision': 0.45392832703734376, 'recall': 0.38538306509957665, 'f1-score': 0.34308501968439614, 'support': 252969}, 'weighted avg': {'precision': 0.45378447207982187, 'recall': 0.4533440856389518, 'f1-score': 0.3788329794563425, 'support': 252969}}
[[13804 55624  3969]
 [ 9216 93521  5362]
 [ 6427 57689  7357]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3982087
{'0': {'precision': 0.4799633424977089, 'recall': 0.20064082471354439, 'f1-score': 0.28298457608802435, 'support': 28713}, '1': {'precision': 0.3559374311522362, 'recall': 0.8418383298016465, 'f1-score': 0.5003303328103065, 'support': 28787}, '2': {'precision': 0.4848156182212581, 'recall': 0.10774051373872323, 'f1-score': 0.17630155510480056, 'support': 29042}, 'accuracy': 0.3827505719766125, 'macro avg': {'precision': 0.4402387972904011, 'recall': 0.3834065560846381, 'f1-score': 0.3198721546677105, 'support': 86542}, 'weighted avg': {'precision': 0.4403361774409872, 'recall': 0.3827505719766125, 'f1-score': 0.3194806589537953, 'support': 86542}}
[[ 5761 21213  1739]
 [ 2967 24234  1586]
 [ 3275 22638  3129]]
Evaluating performance on  val set...
124/124 - 1s - 810ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.414312
{'0': {'precision': 0.5011517788584592, 'recall': 0.17876380900209987, 'f1-score': 0.2635262449528937, 'support': 10953}, '1': {'precision': 0.31545918983064486, 'recall': 0.8410553410553411, 'f1-score': 0.4588245619167423, 'support': 9324}, '2': {'precision': 0.4924078091106291, 'recall': 0.12101288316303865, 'f1-score': 0.19428000855859068, 'support': 11255}, 'accuracy': 0.35398959786883166, 'macro avg': {'precision': 0.436339592599911, 'recall': 0.38027734440682653, 'f1-score': 0.30554360514274226, 'support': 31532}, 'weighted avg': {'precision': 0.44312148964092873, 'recall': 0.35398959786883166, 'f1-score': 0.29655919930888264, 'support': 31532}}
[[1958 8229  766]
 [ 844 7842  638]
 [1105 8788 1362]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3132885
{'0': {'precision': 0.36376205135767875, 'recall': 0.277234538761977, 'f1-score': 0.3146581622483556, 'support': 71178}, '1': {'precision': 0.45307980371900825, 'recall': 0.686651140944851, 'f1-score': 0.5459319423049993, 'support': 102196}, '2': {'precision': 0.3471179308593608, 'recall': 0.15112128869235628, 'f1-score': 0.2105691683078988, 'support': 63320}, 'accuracy': 0.4202683633721176, 'macro avg': {'precision': 0.3879865953120159, 'recall': 0.37166898946639476, 'f1-score': 0.3570530909537512, 'support': 236694}, 'weighted avg': {'precision': 0.3978736524559953, 'recall': 0.4202683633721176, 'f1-score': 0.3866681841769175, 'support': 236694}}
[[19733 43496  7949]
 [21974 70173 10049]
 [12540 41211  9569]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4679801
{'0': {'precision': 0.36802941046197457, 'recall': 0.2785357513995508, 'f1-score': 0.3170889940467104, 'support': 29831}, '1': {'precision': 0.32374357912958396, 'recall': 0.5881186765108012, 'f1-score': 0.41760615511571175, 'support': 29256}, '2': {'precision': 0.38027401525766774, 'recall': 0.16568870196384358, 'f1-score': 0.23081102790049374, 'support': 29483}, 'accuracy': 0.3432313424410071, 'macro avg': {'precision': 0.35734900161640876, 'recall': 0.3441143766247319, 'f1-score': 0.3218353923543053, 'support': 88570}, 'weighted avg': {'precision': 0.3574770947990074, 'recall': 0.3432313424410071, 'f1-score': 0.32157128814568064, 'support': 88570}}
[[ 8309 17765  3757]
 [ 7846 17206  4204]
 [ 6422 18176  4885]]
Evaluating performance on  val set...
127/127 - 1s - 830ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.426517
{'0': {'precision': 0.3919928825622776, 'recall': 0.20322878228782287, 'f1-score': 0.26767922235722963, 'support': 10840}, '1': {'precision': 0.3463822626942492, 'recall': 0.6336803983703033, 'f1-score': 0.44792166650667176, 'support': 11045}, '2': {'precision': 0.37067494181536076, 'recall': 0.2300211823608704, 'f1-score': 0.28388093399085024, 'support': 10386}, 'accuracy': 0.359176970035016, 'macro avg': {'precision': 0.3696833623572959, 'recall': 0.35564345433966554, 'f1-score': 0.33316060761825056, 'support': 32271}, 'weighted avg': {'precision': 0.3695213933292247, 'recall': 0.359176970035016, 'f1-score': 0.3345829059324945, 'support': 32271}}
[[2203 6775 1862]
 [1852 6999 2194]
 [1565 6432 2389]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
1590/1590 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2736923
{'0': {'precision': 0.4508429626823262, 'recall': 0.20890686966860572, 'f1-score': 0.2855148646585382, 'support': 125319}, '1': {'precision': 0.4168366445839668, 'recall': 0.7471663211213051, 'f1-score': 0.5351297400752677, 'support': 161098}, '2': {'precision': 0.41741601981284177, 'recall': 0.20827182404750452, 'f1-score': 0.2778893554865802, 'support': 120578}, 'accuracy': 0.42177422327055614, 'macro avg': {'precision': 0.42836520902637826, 'recall': 0.3881150049458051, 'f1-score': 0.3661779867401287, 'support': 406995}, 'weighted avg': {'precision': 0.42747927578119427, 'recall': 0.42177422327055614, 'f1-score': 0.3820590201271507, 'support': 406995}}
[[ 26180  85504  13635]
 [ 19316 120367  21415]
 [ 12573  82892  25113]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3988823
{'0': {'precision': 0.4536166931714134, 'recall': 0.20480852915578765, 'f1-score': 0.28220233544692785, 'support': 45960}, '1': {'precision': 0.34582589330497765, 'recall': 0.7567223478279957, 'f1-score': 0.47470790330687196, 'support': 45557}, '2': {'precision': 0.4556638811513463, 'recall': 0.17013347200554688, 'f1-score': 0.2477596869872523, 'support': 46152}, 'accuracy': 0.37582171730745484, 'macro avg': {'precision': 0.41836882254257907, 'recall': 0.3772214496631101, 'f1-score': 0.33488997524701736, 'support': 137669}, 'weighted avg': {'precision': 0.41863319180316527, 'recall': 0.37582171730745484, 'f1-score': 0.3343591684542463, 'support': 137669}}
[[ 9413 32128  4419]
 [ 6122 34474  4961]
 [ 5216 33084  7852]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3752648
{'0': {'precision': 0.453985688134465, 'recall': 0.15844804553638844, 'f1-score': 0.23490915353483166, 'support': 17217}, '1': {'precision': 0.36221207719443865, 'recall': 0.7344834841152956, 'f1-score': 0.4851643388228754, 'support': 19012}, '2': {'precision': 0.4054417198522002, 'recall': 0.20975496727104212, 'f1-score': 0.27647552874704134, 'support': 17263}, 'accuracy': 0.3797390263964705, 'macro avg': {'precision': 0.40721316172703464, 'recall': 0.3675621656409087, 'f1-score': 0.3321830070349161, 'support': 53492}, 'weighted avg': {'precision': 0.40570156311299416, 'recall': 0.3797390263964705, 'f1-score': 0.3372686076211373, 'support': 53492}}
[[ 2728 12262  2227]
 [ 1965 13964  3083]
 [ 1316 12326  3621]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
3782/3782 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68339664
{'0': {'precision': 0.5031214578428808, 'recall': 0.3734507776044734, 'f1-score': 0.42869507397763024, 'support': 154513}, '1': {'precision': 0.8067263266009042, 'recall': 0.7997333038029586, 'f1-score': 0.803214594661394, 'support': 650178}, '2': {'precision': 0.4499904177845918, 'recall': 0.5752874232057871, 'f1-score': 0.5049827813786189, 'support': 163261}, 'accuracy': 0.6938298593318677, 'macro avg': {'precision': 0.5866127340761257, 'recall': 0.582823834871073, 'f1-score': 0.5789641500058811, 'support': 967952}, 'weighted avg': {'precision': 0.6980928816618283, 'recall': 0.6938298593318677, 'f1-score': 0.6931288065564368, 'support': 967952}}
[[ 57703  68804  28006]
 [ 43417 519969  86792]
 [ 13570  55769  93922]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6875567
{'0': {'precision': 0.5525627158856984, 'recall': 0.4055310159400807, 'f1-score': 0.46776492132292674, 'support': 78105}, '1': {'precision': 0.7618098879480555, 'recall': 0.8372690181004742, 'f1-score': 0.7977590279614923, 'support': 253916}, '2': {'precision': 0.5173179940842114, 'recall': 0.4882479319705137, 'f1-score': 0.5023627675486784, 'support': 77731}, 'accuracy': 0.688762959058162, 'macro avg': {'precision': 0.6105635326393217, 'recall': 0.5770159886703562, 'f1-score': 0.5892955722776991, 'support': 409752}, 'weighted avg': {'precision': 0.6755434395210537, 'recall': 0.688762959058162, 'f1-score': 0.6788196782642277, 'support': 409752}}
[[ 31674  34697  11734]
 [ 17643 212596  23677]
 [  8005  31774  37952]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6310654
{'0': {'precision': 0.5695372750642673, 'recall': 0.3860596819864953, 'f1-score': 0.46018434376217054, 'support': 22955}, '1': {'precision': 0.8032617757398917, 'recall': 0.8516108361322255, 'f1-score': 0.8267300184478099, 'support': 90512}, '2': {'precision': 0.5067375598668723, 'recall': 0.5502181481644705, 'f1-score': 0.5275835111665153, 'support': 22691}, 'accuracy': 0.7228954596865407, 'macro avg': {'precision': 0.6265122035570104, 'recall': 0.5959628887610638, 'f1-score': 0.6048326244588319, 'support': 136158}, 'weighted avg': {'precision': 0.7144416043552969, 'recall': 0.7228954596865407, 'f1-score': 0.7150803955161518, 'support': 136158}}
[[ 8862 10550  3543]
 [ 4821 77081  8610]
 [ 1877  8329 12485]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7795822
{'0': {'precision': 0.5017923492499764, 'recall': 0.30124494731236306, 'f1-score': 0.37647668535111767, 'support': 229086}, '1': {'precision': 0.6746100117812638, 'recall': 0.8992100153980049, 'f1-score': 0.7708836698039818, 'support': 687102}, '2': {'precision': 0.531752104055088, 'recall': 0.20716640491878402, 'f1-score': 0.29816866235512585, 'support': 224771}, 'accuracy': 0.6428145095485465, 'macro avg': {'precision': 0.5693848216954427, 'recall': 0.4692071225430507, 'f1-score': 0.4818430058367418, 'support': 1140959}, 'weighted avg': {'precision': 0.6117677695831105, 'recall': 0.6428145095485465, 'f1-score': 0.5985674486429624, 'support': 1140959}}
[[ 69011 143773  16302]
 [ 44551 617849  24702]
 [ 23967 154239  46565]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7066661
{'0': {'precision': 0.5248812620826273, 'recall': 0.20992544935615354, 'f1-score': 0.2999045411155053, 'support': 104761}, '1': {'precision': 0.7245458205049835, 'recall': 0.9410402077801364, 'f1-score': 0.8187229454322993, 'support': 413129}, '2': {'precision': 0.5376662092462027, 'recall': 0.22095928904100265, 'f1-score': 0.3132041925947365, 'support': 102847}, 'accuracy': 0.6983440651999155, 'macro avg': {'precision': 0.5956977639446045, 'recall': 0.4573083153924309, 'f1-score': 0.47727722638084696, 'support': 620737}, 'weighted avg': {'precision': 0.659885479355646, 'recall': 0.6983440651999155, 'f1-score': 0.6474055887615732, 'support': 620737}}
[[ 21992  75649   7120]
 [ 11937 388771  12421]
 [  7970  72152  22725]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7184843
{'0': {'precision': 0.5857950473763834, 'recall': 0.20807760839437736, 'f1-score': 0.3070790550129393, 'support': 35357}, '1': {'precision': 0.7309924727503788, 'recall': 0.911287988422576, 'f1-score': 0.8112434822112679, 'support': 131290}, '2': {'precision': 0.5014605257892841, 'recall': 0.36245842371655823, 'f1-score': 0.4207769532955042, 'support': 34575}, 'accuracy': 0.6934231843436602, 'macro avg': {'precision': 0.6060826819720154, 'recall': 0.4939413401778372, 'f1-score': 0.5130331635065705, 'support': 201222}, 'weighted avg': {'precision': 0.6660402685424481, 'recall': 0.6934231843436602, 'f1-score': 0.6555640739471922, 'support': 201222}}
[[  7357  24095   3905]
 [  3093 119643   8554]
 [  2109  19934  12532]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81297445
{'0': {'precision': 0.593000912249374, 'recall': 0.24491366456639893, 'f1-score': 0.3466559253859202, 'support': 249492}, '1': {'precision': 0.649700765871964, 'recall': 0.9373863337392372, 'f1-score': 0.7674696859390899, 'support': 695567}, '2': {'precision': 0.600431487525585, 'recall': 0.21541698090739492, 'f1-score': 0.31707637702116476, 'support': 251930}, 'accuracy': 0.6410994587251846, 'macro avg': {'precision': 0.6143777218823077, 'recall': 0.465905659737677, 'f1-score': 0.47706732944872493, 'support': 1196989}, 'weighted avg': {'precision': 0.6275129519707415, 'recall': 0.6410994587251846, 'f1-score': 0.5849640379643598, 'support': 1196989}}
[[ 61104 171357  17031]
 [ 24468 652015  19084]
 [ 17470 180190  54270]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77994794
{'0': {'precision': 0.5724496426250812, 'recall': 0.2943845518017622, 'f1-score': 0.3888179136373139, 'support': 113722}, '1': {'precision': 0.6841157458046334, 'recall': 0.8881451228599847, 'f1-score': 0.7728921773956752, 'support': 312673}, '2': {'precision': 0.5384451288615122, 'recall': 0.35734510768577343, 'f1-score': 0.42958881377747754, 'support': 113014}, 'accuracy': 0.6517540493391841, 'macro avg': {'precision': 0.5983368390970757, 'recall': 0.5132915941158401, 'f1-score': 0.5304329682701555, 'support': 539409}, 'weighted avg': {'precision': 0.6300534077846986, 'recall': 0.6517540493391841, 'f1-score': 0.6199919110688705, 'support': 539409}}
[[ 33478  65767  14477]
 [ 14833 277699  20141]
 [ 10171  62458  40385]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8523982
{'0': {'precision': 0.5602498327013161, 'recall': 0.26971070208973175, 'f1-score': 0.36412665274878214, 'support': 46561}, '1': {'precision': 0.6387409108059885, 'recall': 0.8950844647578079, 'f1-score': 0.7454917298620648, 'support': 111585}, '2': {'precision': 0.5581834638542363, 'recall': 0.30803309661867223, 'f1-score': 0.39698844076240586, 'support': 46047}, 'accuracy': 0.620099611641927, 'macro avg': {'precision': 0.5857247357871803, 'recall': 0.49094275448873725, 'f1-score': 0.5022022744577509, 'support': 204193}, 'weighted avg': {'precision': 0.6026767369732959, 'recall': 0.620099611641927, 'f1-score': 0.5799411463031595, 'support': 204193}}
[[12558 29497  4506]
 [ 4986 99878  6721]
 [ 4871 26992 14184]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
4274/4274 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0611175
{'0': {'precision': 0.5375569242580217, 'recall': 0.10343797213362431, 'f1-score': 0.1734921712002658, 'support': 297850}, '1': {'precision': 0.48825639304297386, 'recall': 0.9559391423301506, 'f1-score': 0.646371472796618, 'support': 503667}, '2': {'precision': 0.5665764894058174, 'recall': 0.0980762131342549, 'f1-score': 0.1672081564385805, 'support': 292548}, 'accuracy': 0.4944642228752405, 'macro avg': {'precision': 0.5307966022356043, 'recall': 0.38581777586600996, 'f1-score': 0.32902393347848813, 'support': 1094065}, 'weighted avg': {'precision': 0.5226204854626739, 'recall': 0.4944642228752405, 'f1-score': 0.38950796847613917, 'support': 1094065}}
[[ 30809 255978  11063]
 [ 11306 481475  10886]
 [ 15198 248658  28692]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.905138
{'0': {'precision': 0.5507599489499942, 'recall': 0.16810531814117377, 'f1-score': 0.25758839848333775, 'support': 112953}, '1': {'precision': 0.6041806852433932, 'recall': 0.9412826975134452, 'f1-score': 0.7359667418026458, 'support': 278538}, '2': {'precision': 0.576391193716119, 'recall': 0.18427963816109436, 'f1-score': 0.27927233743173974, 'support': 113089}, 'accuracy': 0.5985393792857426, 'macro avg': {'precision': 0.5771106093031688, 'recall': 0.4312225512719044, 'f1-score': 0.4242758259059077, 'support': 504580}, 'weighted avg': {'precision': 0.5859938402755464, 'recall': 0.5985393792857426, 'f1-score': 0.5265224861665777, 'support': 504580}}
[[ 18988  86589   7376]
 [  8415 262183   7940]
 [  7073  85176  20840]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92739344
{'0': {'precision': 0.5677347306932394, 'recall': 0.1569423666025504, 'f1-score': 0.24590712903705908, 'support': 42111}, '1': {'precision': 0.590134309188659, 'recall': 0.9384692756925413, 'f1-score': 0.7246128730604029, 'support': 97431}, '2': {'precision': 0.5680214507479537, 'recall': 0.19533145685722605, 'f1-score': 0.2906976744186046, 'support': 41212}, 'accuracy': 0.5869579649689634, 'macro avg': {'precision': 0.5752968302099507, 'recall': 0.4302476997174392, 'f1-score': 0.4204058921720222, 'support': 180754}, 'weighted avg': {'precision': 0.579874045116611, 'recall': 0.5869579649689634, 'f1-score': 0.5141539578884409, 'support': 180754}}
[[ 6609 32745  2757]
 [ 2630 91436  3365]
 [ 2402 30760  8050]]
testing model on single stock: results/universal/W4/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
12724/12724 - 70s - 70s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3415602
{'0': {'precision': 0.45514760825238415, 'recall': 0.0380777808975371, 'f1-score': 0.07027623185798484, 'support': 943805}, '1': {'precision': 0.4263415298659238, 'recall': 0.97074679159064, 'f1-score': 0.5924746000420389, 'support': 1373422}, '2': {'precision': 0.5227593507410021, 'recall': 0.028371563537322324, 'f1-score': 0.0538220584258052, 'support': 939920}, 'accuracy': 0.42854989351110034, 'macro avg': {'precision': 0.46808282961976994, 'recall': 0.3457320453418331, 'f1-score': 0.23885763010860964, 'support': 3257147}, 'weighted avg': {'precision': 0.46251194495877557, 'recall': 0.42854989351110034, 'f1-score': 0.2857203369400415, 'support': 3257147}}
[[  35938  898820    9047]
 [  24879 1333245   15298]
 [  18142  895111   26667]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.7103448
{'0': {'precision': 0.46314589665653494, 'recall': 0.008286485347400192, 'f1-score': 0.01628166342769753, 'support': 441321}, '1': {'precision': 0.3323031966095708, 'recall': 0.9901311517984678, 'f1-score': 0.4976031471073472, 'support': 438957}, '2': {'precision': 0.5043727142629989, 'recall': 0.007179329325704353, 'f1-score': 0.014157143399097998, 'support': 441824}, 'accuracy': 0.3339031330411723, 'macro avg': {'precision': 0.43327393584303486, 'recall': 0.3351989888238574, 'f1-score': 0.17601398464471427, 'support': 1322102}, 'weighted avg': {'precision': 0.4334815276272491, 'recall': 0.3339031330411723, 'f1-score': 0.17537738416214316, 'support': 1322102}}
[[  3657 436442   1222]
 [  2437 434625   1895]
 [  1802 436850   3172]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.6301228
{'0': {'precision': 0.48846508766533375, 'recall': 0.00967567007671076, 'f1-score': 0.01897546811332704, 'support': 164123}, '1': {'precision': 0.3276405938363195, 'recall': 0.9854361316960224, 'f1-score': 0.491774582701181, 'support': 159367}, '2': {'precision': 0.48338983050847456, 'recall': 0.013081768699162132, 'f1-score': 0.02547414178104624, 'support': 163510}, 'accuracy': 0.330129363449692, 'macro avg': {'precision': 0.43316517067004257, 'recall': 0.3360645234906318, 'f1-score': 0.17874139753185145, 'support': 487000}, 'weighted avg': {'precision': 0.43413249545636745, 'recall': 0.330129363449692, 'f1-score': 0.17587726405979787, 'support': 487000}}
[[  1588 161606    929]
 [   964 157046   1357]
 [   699 160672   2139]]
training model: results/universal/W4/deepLOB_L1/h30
Epoch 1/50
9854/9854 - 154s - loss: 2.9096 - accuracy30: 0.5039 - val_loss: 4.0206 - val_accuracy30: 0.4520 - 154s/epoch - 16ms/step
Epoch 2/50
9854/9854 - 155s - loss: 2.8117 - accuracy30: 0.5310 - val_loss: 4.0588 - val_accuracy30: 0.4534 - 155s/epoch - 16ms/step
Epoch 3/50
9854/9854 - 155s - loss: 2.7854 - accuracy30: 0.5369 - val_loss: 4.0416 - val_accuracy30: 0.4537 - 155s/epoch - 16ms/step
Epoch 4/50
9854/9854 - 152s - loss: 2.7715 - accuracy30: 0.5396 - val_loss: 4.0395 - val_accuracy30: 0.4547 - 152s/epoch - 15ms/step
Epoch 5/50
9854/9854 - 153s - loss: 2.7623 - accuracy30: 0.5414 - val_loss: 4.0350 - val_accuracy30: 0.4584 - 153s/epoch - 16ms/step
Epoch 6/50
9854/9854 - 152s - loss: 2.7554 - accuracy30: 0.5428 - val_loss: 4.0728 - val_accuracy30: 0.4588 - 152s/epoch - 15ms/step
Epoch 7/50
9854/9854 - 157s - loss: 2.7510 - accuracy30: 0.5438 - val_loss: 4.0284 - val_accuracy30: 0.4592 - 157s/epoch - 16ms/step
Epoch 8/50
9854/9854 - 157s - loss: 2.7462 - accuracy30: 0.5448 - val_loss: 4.0196 - val_accuracy30: 0.4594 - 157s/epoch - 16ms/step
Epoch 9/50
9854/9854 - 152s - loss: 2.7427 - accuracy30: 0.5455 - val_loss: 4.0911 - val_accuracy30: 0.4599 - 152s/epoch - 15ms/step
Epoch 10/50
9854/9854 - 150s - loss: 2.7394 - accuracy30: 0.5465 - val_loss: 4.0817 - val_accuracy30: 0.4602 - 150s/epoch - 15ms/step
Epoch 11/50
9854/9854 - 151s - loss: 2.7368 - accuracy30: 0.5470 - val_loss: 4.1470 - val_accuracy30: 0.4602 - 151s/epoch - 15ms/step
Epoch 12/50
9854/9854 - 157s - loss: 2.7337 - accuracy30: 0.5475 - val_loss: 4.1242 - val_accuracy30: 0.4608 - 157s/epoch - 16ms/step
Epoch 13/50
9854/9854 - 152s - loss: 2.7315 - accuracy30: 0.5481 - val_loss: 4.1538 - val_accuracy30: 0.4609 - 152s/epoch - 15ms/step
Epoch 14/50
9854/9854 - 153s - loss: 2.7291 - accuracy30: 0.5483 - val_loss: 4.1307 - val_accuracy30: 0.4620 - 153s/epoch - 16ms/step
Epoch 15/50
9854/9854 - 152s - loss: 2.7269 - accuracy30: 0.5489 - val_loss: 4.1608 - val_accuracy30: 0.4622 - 152s/epoch - 15ms/step
Epoch 16/50
9854/9854 - 155s - loss: 2.7254 - accuracy30: 0.5491 - val_loss: 4.1492 - val_accuracy30: 0.4626 - 155s/epoch - 16ms/step
Epoch 17/50
9854/9854 - 153s - loss: 2.7234 - accuracy30: 0.5495 - val_loss: 4.0988 - val_accuracy30: 0.4625 - 153s/epoch - 16ms/step
Epoch 18/50
9854/9854 - 149s - loss: 2.7220 - accuracy30: 0.5499 - val_loss: 4.0526 - val_accuracy30: 0.4621 - 149s/epoch - 15ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 120s - 120s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0773909
{'0': {'precision': 0.4180636105310007, 'recall': 0.3900814840654377, 'f1-score': 0.4035881049581183, 'support': 1565214}, '1': {'precision': 0.5294754117069943, 'recall': 0.7361955564938901, 'f1-score': 0.6159538381852091, 'support': 2936645}, '2': {'precision': 0.4553255883545013, 'recall': 0.15315026640811533, 'f1-score': 0.22920625235368985, 'support': 1569772}, 'accuracy': 0.4962286080955842, 'macro avg': {'precision': 0.4676215368641654, 'recall': 0.4264757689891477, 'f1-score': 0.4162493984990057, 'support': 6071631}, 'weighted avg': {'precision': 0.48158356395314184, 'recall': 0.4962286080955842, 'f1-score': 0.4612172690371131, 'support': 6071631}}
[[ 610561  873688   80965]
 [ 568078 2161945  206622]
 [ 281811 1047550  240411]]
Evaluating performance on  train set...
9854/9854 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2272217
{'0': {'precision': 0.4489412473784879, 'recall': 0.20149277420548004, 'f1-score': 0.27814786554144744, 'support': 724557}, '1': {'precision': 0.4522209177554756, 'recall': 0.8342317770555452, 'f1-score': 0.58650747339957, 'support': 1073523}, '2': {'precision': 0.5038669438669439, 'recall': 0.15065081450232684, 'f1-score': 0.23195082035200323, 'support': 723939}, 'accuracy': 0.4562305042111102, 'macro avg': {'precision': 0.4683430363336358, 'recall': 0.39545845525445067, 'f1-score': 0.3655353864310069, 'support': 2522019}, 'weighted avg': {'precision': 0.46610355082357346, 'recall': 0.4562305042111102, 'f1-score': 0.39614352243747963, 'support': 2522019}}
[[145993 540172  38392]
 [108960 895567  68996]
 [ 70241 544636 109062]]
Evaluating performance on  val set...
3566/3566 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2163153
{'0': {'precision': 0.504948235102307, 'recall': 0.11847354992215503, 'f1-score': 0.19191825302399365, 'support': 261417}, '1': {'precision': 0.4521491455204557, 'recall': 0.8920812589881197, 'f1-score': 0.6001259570285482, 'support': 391489}, '2': {'precision': 0.49397712962845186, 'recall': 0.14968432737448256, 'f1-score': 0.22975007616923473, 'support': 259446}, 'accuracy': 0.4593029883202974, 'macro avg': {'precision': 0.4836915034170715, 'recall': 0.38674637876158574, 'f1-score': 0.3405980954072589, 'support': 912352}, 'weighted avg': {'precision': 0.4791723588921609, 'recall': 0.4593029883202974, 'f1-score': 0.3778378772707529, 'support': 912352}}
[[ 30971 216670  13776]
 [ 16243 349240  26006]
 [ 14121 206490  38835]]
testing model out of sample: results/universal/W4/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0953872
{'0': {'precision': 0.4363226524541537, 'recall': 0.3586315919248668, 'f1-score': 0.39368073961224614, 'support': 867899}, '1': {'precision': 0.485663508296987, 'recall': 0.7365217880526842, 'f1-score': 0.5853478299750333, 'support': 1315308}, '2': {'precision': 0.4904629457939304, 'recall': 0.18705498948063198, 'f1-score': 0.2708224724086296, 'support': 848435}, 'accuracy': 0.4745655984446712, 'macro avg': {'precision': 0.47081636884835704, 'recall': 0.42740278981939434, 'f1-score': 0.4166170139986363, 'support': 3031642}, 'weighted avg': {'precision': 0.4728813695443176, 'recall': 0.4745655984446712, 'f1-score': 0.44245430963007687, 'support': 3031642}}
[[311256 498597  58046]
 [239725 968753 106830]
 [162381 527350 158704]]
Evaluating performance on  train set...
5528/5528 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0234294
{'0': {'precision': 0.4017278048844728, 'recall': 0.34868535732962225, 'f1-score': 0.3733319463163225, 'support': 349943}, '1': {'precision': 0.5746316064695093, 'recall': 0.7875684150114083, 'f1-score': 0.6644570494583426, 'support': 714390}, '2': {'precision': 0.5079401261302333, 'recall': 0.19092853817571137, 'f1-score': 0.2775350240066758, 'support': 350131}, 'accuracy': 0.5312973677661644, 'macro avg': {'precision': 0.49476651249473846, 'recall': 0.44239410350558067, 'f1-score': 0.43844133992711365, 'support': 1414464}, 'weighted avg': {'precision': 0.5153460893119546, 'recall': 0.5312973677661644, 'f1-score': 0.49665455490051325, 'support': 1414464}}
[[122020 202463  25460]
 [112459 562631  39300]
 [ 69259 214022  66850]]
Evaluating performance on  val set...
1908/1908 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0640588
{'0': {'precision': 0.4764213779506581, 'recall': 0.14232841713162314, 'f1-score': 0.21917841799807566, 'support': 125639}, '1': {'precision': 0.5292186997620731, 'recall': 0.8667045789628881, 'f1-score': 0.6571654436131052, 'support': 237390}, '2': {'precision': 0.48360735956155804, 'recall': 0.237976370115902, 'f1-score': 0.3189848087102466, 'support': 124588}, 'accuracy': 0.5194199545955125, 'macro avg': {'precision': 0.49641581242476307, 'recall': 0.41566978873680444, 'f1-score': 0.39844289010714257, 'support': 487617}, 'weighted avg': {'precision': 0.5039611136484509, 'recall': 0.5194199545955125, 'f1-score': 0.4579076227157123, 'support': 487617}}
[[ 17882  95954  11803]
 [ 11787 205747  19856]
 [  7865  87074  29649]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5480511
{'0': {'precision': 0.4664412510566357, 'recall': 0.052992470805162874, 'f1-score': 0.09517239000327704, 'support': 52064}, '1': {'precision': 0.2452482080189679, 'recall': 0.9414140196492075, 'f1-score': 0.38912522188658094, 'support': 33182}, '2': {'precision': 0.5056446821152704, 'recall': 0.03310768751945223, 'f1-score': 0.06214627377953044, 'support': 51408}, 'accuracy': 0.261236407276772, 'macro avg': {'precision': 0.4057780470636246, 'recall': 0.3425047259912742, 'f1-score': 0.18214796188979612, 'support': 136654}, 'weighted avg': {'precision': 0.42747965776106, 'recall': 0.261236407276772, 'f1-score': 0.15412519259025895, 'support': 136654}}
[[ 2759 48347   958]
 [ 1238 31238   706]
 [ 1918 47788  1702]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4121691
{'0': {'precision': 0.3801776624413614, 'recall': 0.17850782641297216, 'f1-score': 0.24294415919890294, 'support': 21338}, '1': {'precision': 0.3375709464641816, 'recall': 0.8126759913216083, 'f1-score': 0.47700331910858224, 'support': 21663}, '2': {'precision': 0.4412296564195298, 'recall': 0.055618873945748805, 'f1-score': 0.09878542510121457, 'support': 21935}, 'accuracy': 0.3485585807564371, 'macro avg': {'precision': 0.386326088441691, 'recall': 0.34893423056010975, 'f1-score': 0.2729109678028999, 'support': 64936}, 'weighted avg': {'precision': 0.38658683762457996, 'recall': 0.3485585807564371, 'f1-score': 0.27233158294983595, 'support': 64936}}
[[ 3809 16793   736]
 [ 3249 17605   809]
 [ 2961 17754  1220]]
Evaluating performance on  val set...
81/81 - 1s - 631ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5252434
{'0': {'precision': 0.3872598584428716, 'recall': 0.10696830051668761, 'f1-score': 0.1676332202647992, 'support': 7161}, '1': {'precision': 0.30601584002696175, 'recall': 0.8629811500079202, 'f1-score': 0.4518162215956212, 'support': 6313}, '2': {'precision': 0.4557416267942584, 'recall': 0.05333893322133557, 'f1-score': 0.09550068930943728, 'support': 7143}, 'accuracy': 0.3198816510646554, 'macro avg': {'precision': 0.38300577508803063, 'recall': 0.34109612791531446, 'f1-score': 0.23831671038995253, 'support': 20617}, 'weighted avg': {'precision': 0.3861089530286172, 'recall': 0.3198816510646554, 'f1-score': 0.22965992729236526, 'support': 20617}}
[[ 766 6141  254]
 [ 664 5448  201]
 [ 548 6214  381]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
1613/1613 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8280896
{'0': {'precision': 0.27600047784016246, 'recall': 0.4148382231479154, 'f1-score': 0.33146825055235146, 'support': 55694}, '1': {'precision': 0.8178862353050078, 'recall': 0.7057372875433067, 'f1-score': 0.7576843026735387, 'support': 300473}, '2': {'precision': 0.3740535589047762, 'recall': 0.4610634769415335, 'f1-score': 0.41302578447873944, 'support': 56682}, 'accuracy': 0.6329021022213933, 'macro avg': {'precision': 0.48931342401664885, 'recall': 0.5272129958775852, 'f1-score': 0.5007261125682099, 'support': 412849}, 'weighted avg': {'precision': 0.6838490712572203, 'recall': 0.6329021022213932, 'f1-score': 0.6528672607643782, 'support': 412849}}
[[ 23104  25056   7534]
 [ 52219 212055  36199]
 [  8387  22161  26134]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76840276
{'0': {'precision': 0.4235636689438907, 'recall': 0.294984790577958, 'f1-score': 0.3477701149425287, 'support': 25642}, '1': {'precision': 0.7606435012782888, 'recall': 0.8364823084850567, 'f1-score': 0.7967623189029772, 'support': 110618}, '2': {'precision': 0.4290375203915171, 'recall': 0.37533749903571706, 'f1-score': 0.40039500483469465, 'support': 25926}, 'accuracy': 0.677154624936801, 'macro avg': {'precision': 0.5377482302045655, 'recall': 0.5022681993662439, 'f1-score': 0.5149758128934002, 'support': 162186}, 'weighted avg': {'precision': 0.6543419849871843, 'recall': 0.677154624936801, 'f1-score': 0.6624148593288578, 'support': 162186}}
[[ 7564 15193  2885]
 [ 8023 92530 10065]
 [ 2271 13924  9731]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70693153
{'0': {'precision': 0.6258620689655172, 'recall': 0.11028406501595017, 'f1-score': 0.18752421542037967, 'support': 6583}, '1': {'precision': 0.7986405718973397, 'recall': 0.8684592838027272, 'f1-score': 0.8320879120879121, 'support': 39235}, '2': {'precision': 0.3572150477259966, 'recall': 0.46021412037037035, 'f1-score': 0.40222545362584555, 'support': 6912}, 'accuracy': 0.7202920538592832, 'macro avg': {'precision': 0.5939058961962845, 'recall': 0.4796524897296826, 'f1-score': 0.4739458603780458, 'support': 52730}, 'weighted avg': {'precision': 0.7192069646932336, 'recall': 0.7202920538592832, 'f1-score': 0.6952706898604862, 'support': 52730}}
[[  726  4936   921]
 [  358 34074  4803]
 [   76  3655  3181]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2453463
{'0': {'precision': 0.41469032452782234, 'recall': 0.33666481822988537, 'f1-score': 0.37162623846942267, 'support': 77543}, '1': {'precision': 0.42206487085893823, 'recall': 0.7286087459371074, 'f1-score': 0.5345045750104227, 'support': 100298}, '2': {'precision': 0.442923186344239, 'recall': 0.09947023746139921, 'f1-score': 0.16245652173913042, 'support': 75128}, 'accuracy': 0.42162083101091435, 'macro avg': {'precision': 0.42655946057699984, 'recall': 0.38824793387613066, 'f1-score': 0.35619577840632527, 'support': 252969}, 'weighted avg': {'precision': 0.42599894609988065, 'recall': 0.42162083101091435, 'f1-score': 0.3740845196021932, 'support': 252969}}
[[26106 47544  3893]
 [21714 73078  5506]
 [15133 52522  7473]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3150605
{'0': {'precision': 0.40603946102021177, 'recall': 0.46375815870834763, 'f1-score': 0.43298373905513327, 'support': 29110}, '1': {'precision': 0.36289557644218334, 'recall': 0.6012357584199436, 'f1-score': 0.4526059660962265, 'support': 27999}, '2': {'precision': 0.48769186214885607, 'recall': 0.11442938198620596, 'f1-score': 0.18536558518396212, 'support': 29433}, 'accuracy': 0.3894294099974579, 'macro avg': {'precision': 0.4188756332037504, 'recall': 0.39314109970483235, 'f1-score': 0.35698509677844065, 'support': 86542}, 'weighted avg': {'precision': 0.4198511304768822, 'recall': 0.3894294099974579, 'f1-score': 0.35511701090040365, 'support': 86542}}
[[13500 13853  1757]
 [ 9384 16834  1781]
 [10364 15701  3368]]
Evaluating performance on  val set...
124/124 - 1s - 821ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4079541
{'0': {'precision': 0.45184101438673496, 'recall': 0.1717330861909175, 'f1-score': 0.24887515949231076, 'support': 10790}, '1': {'precision': 0.3089849787959256, 'recall': 0.8212367007268514, 'f1-score': 0.44902660983757625, 'support': 9493}, '2': {'precision': 0.46545454545454545, 'recall': 0.09103031380567161, 'f1-score': 0.15227897984980296, 'support': 11249}, 'accuracy': 0.3384815425599391, 'macro avg': {'precision': 0.40876017954573535, 'recall': 0.36133336690781354, 'f1-score': 0.28339358305989665, 'support': 31532}, 'weighted avg': {'precision': 0.41368949418878515, 'recall': 0.3384815425599391, 'f1-score': 0.27467204181278, 'support': 31532}}
[[1853 8328  609]
 [1130 7796  567]
 [1118 9107 1024]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3161978
{'0': {'precision': 0.332279255198659, 'recall': 0.5127946975417401, 'f1-score': 0.4032571104965389, 'support': 71514}, '1': {'precision': 0.4309952211424356, 'recall': 0.4017419380555666, 'f1-score': 0.4158547592645125, 'support': 100348}, '2': {'precision': 0.3642351793120273, 'recall': 0.18423000987166832, 'f1-score': 0.2446939277226912, 'support': 64832}, 'accuracy': 0.37571717069296223, 'macro avg': {'precision': 0.375836551884374, 'recall': 0.36625554848965836, 'f1-score': 0.35460193249458083, 'support': 236694}, 'weighted avg': {'precision': 0.3828834793135245, 'recall': 0.37571717069296223, 'f1-score': 0.3651664981150443, 'support': 236694}}
[[36672 26009  8833]
 [48019 40314 12015]
 [25674 27214 11944]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4178456
{'0': {'precision': 0.3635406763547467, 'recall': 0.356472233320016, 'f1-score': 0.3599717590102205, 'support': 30036}, '1': {'precision': 0.3271134223348701, 'recall': 0.5105026256564141, 'f1-score': 0.39873223869069024, 'support': 29326}, '2': {'precision': 0.38371657553741295, 'recall': 0.17539715146535195, 'f1-score': 0.2407481378791795, 'support': 29208}, 'accuracy': 0.34775883481991643, 'macro avg': {'precision': 0.3581235580756766, 'recall': 0.3474573368139273, 'f1-score': 0.33315071186003004, 'support': 88570}, 'weighted avg': {'precision': 0.3581328860413269, 'recall': 0.34775883481991643, 'f1-score': 0.3334888223625295, 'support': 88570}}
[[10707 15508  3821]
 [ 9948 14971  4407]
 [ 8797 15288  5123]]
Evaluating performance on  val set...
127/127 - 1s - 819ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4457715
{'0': {'precision': 0.4014911884319928, 'recall': 0.16263957532491305, 'f1-score': 0.23150078165711305, 'support': 10926}, '1': {'precision': 0.35174762332686943, 'recall': 0.6901447661469933, 'f1-score': 0.46599204235721664, 'support': 10776}, '2': {'precision': 0.3815279021187705, 'recall': 0.24193395780111648, 'f1-score': 0.29610329453998036, 'support': 10569}, 'accuracy': 0.3647547333519259, 'macro avg': {'precision': 0.3782555712925442, 'recall': 0.36490609975767424, 'f1-score': 0.33119870618477004, 'support': 32271}, 'weighted avg': {'precision': 0.37834258347344624, 'recall': 0.3647547333519259, 'f1-score': 0.33096041364754847, 'support': 32271}}
[[1777 7156 1993]
 [1187 7437 2152]
 [1462 6550 2557]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3283007
{'0': {'precision': 0.4229070272374706, 'recall': 0.21750648830564734, 'f1-score': 0.28726758615077913, 'support': 129849}, '1': {'precision': 0.38314100961023184, 'recall': 0.7098604041594133, 'f1-score': 0.49766931406602033, 'support': 151079}, '2': {'precision': 0.42232430101820834, 'recall': 0.2020116287371001, 'f1-score': 0.27329652463660803, 'support': 126067}, 'accuracy': 0.3954716888413863, 'macro avg': {'precision': 0.4094574459553036, 'recall': 0.3764595070673869, 'f1-score': 0.35274447495113587, 'support': 406995}, 'weighted avg': {'precision': 0.40796514165315295, 'recall': 0.3954716888413863, 'f1-score': 0.3610424306569763, 'support': 406995}}
[[ 28243  87352  14254]
 [ 23253 107245  20581]
 [ 15287  85313  25467]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3584555
{'0': {'precision': 0.39463160319088797, 'recall': 0.4077976589714187, 'f1-score': 0.40110661842945305, 'support': 46219}, '1': {'precision': 0.3438489247898701, 'recall': 0.5573371668694017, 'f1-score': 0.4253056884635832, 'support': 45215}, '2': {'precision': 0.4448255114320096, 'recall': 0.15990050827295338, 'f1-score': 0.23523983772174048, 'support': 46235}, 'accuracy': 0.37365710508538597, 'macro avg': {'precision': 0.39443534647092254, 'recall': 0.37501177803792457, 'f1-score': 0.3538840482049255, 'support': 137669}, 'weighted avg': {'precision': 0.39481012227380596, 'recall': 0.37365710508538597, 'f1-score': 0.3533493916432637, 'support': 137669}}
[[18848 23144  4227]
 [15015 25200  5000]
 [13898 24944  7393]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4194053
{'0': {'precision': 0.43343802850930174, 'recall': 0.1027785734746491, 'f1-score': 0.16615726590719646, 'support': 17455}, '1': {'precision': 0.34766422481085624, 'recall': 0.7832792207792207, 'f1-score': 0.4815769774598685, 'support': 18480}, '2': {'precision': 0.4067115833117388, 'recall': 0.1787890869738566, 'f1-score': 0.2483877349159248, 'support': 17557}, 'accuracy': 0.3628206086891498, 'macro avg': {'precision': 0.39593794554396555, 'recall': 0.3549489604092422, 'f1-score': 0.29870732609432993, 'support': 53492}, 'weighted avg': {'precision': 0.3950334803398393, 'recall': 0.3628206086891498, 'f1-score': 0.30211547674021116, 'support': 53492}}
[[ 1794 13727  1934]
 [ 1360 14475  2645]
 [  985 13433  3139]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
3782/3782 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8494145
{'0': {'precision': 0.4036289790858981, 'recall': 0.42158326492609266, 'f1-score': 0.4124108047513312, 'support': 181511}, '1': {'precision': 0.7582343521274819, 'recall': 0.6497231169172281, 'f1-score': 0.699797255881937, 'support': 593933}, '2': {'precision': 0.43088423052941, 'recall': 0.6030606520248509, 'f1-score': 0.5026367060657227, 'support': 192508}, 'accuracy': 0.5976618675306213, 'macro avg': {'precision': 0.5309158539142634, 'recall': 0.5581223446227239, 'f1-score': 0.5382815888996636, 'support': 967952}, 'weighted avg': {'precision': 0.6266345485476014, 'recall': 0.5976618675306213, 'f1-score': 0.6066947205752409, 'support': 967952}}
[[ 76522  67651  37338]
 [ 92041 385892 116000]
 [ 21022  55392 116094]]
Evaluating performance on  train set...
1601/1601 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84690326
{'0': {'precision': 0.4645589393716872, 'recall': 0.38046449581210223, 'f1-score': 0.4183272919634753, 'support': 91454}, '1': {'precision': 0.6878064583216682, 'recall': 0.7569655354549056, 'f1-score': 0.7207307260322198, 'support': 227190}, '2': {'precision': 0.5121140310543628, 'recall': 0.4767638407165123, 'f1-score': 0.4938070904409216, 'support': 91108}, 'accuracy': 0.6106303324938012, 'macro avg': {'precision': 0.5548264762492394, 'recall': 0.5380646239945067, 'f1-score': 0.5442883694788722, 'support': 409752}, 'weighted avg': {'precision': 0.5989139959016647, 'recall': 0.6106303324938012, 'f1-score': 0.6027799600792166, 'support': 409752}}
[[ 34795  42653  14006]
 [ 27839 171975  27376]
 [ 12265  35406  43437]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75548095
{'0': {'precision': 0.5981213505965981, 'recall': 0.2602356406480118, 'f1-score': 0.36267542396798114, 'support': 27160}, '1': {'precision': 0.7187898254157384, 'recall': 0.8447469679996104, 'f1-score': 0.7766948986503507, 'support': 82124}, '2': {'precision': 0.5069359591748724, 'recall': 0.5248939495423085, 'f1-score': 0.5157586837294332, 'support': 26874}, 'accuracy': 0.6650215191174959, 'macro avg': {'precision': 0.6079490450624029, 'recall': 0.5432921860633102, 'f1-score': 0.5517096687825883, 'support': 136158}, 'weighted avg': {'precision': 0.6529052165242676, 'recall': 0.6650215191174959, 'f1-score': 0.6426067894525225, 'support': 136158}}
[[ 7068 15681  4411]
 [ 3441 69374  9309]
 [ 1308 11460 14106]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
4457/4457 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91420877
{'0': {'precision': 0.42137009746382026, 'recall': 0.4157283642531063, 'f1-score': 0.41853021926360523, 'support': 267682}, '1': {'precision': 0.6170424686252004, 'recall': 0.7445191502720804, 'f1-score': 0.6748132850493918, 'support': 611584}, '2': {'precision': 0.49999280202694923, 'recall': 0.26543698150122474, 'f1-score': 0.34677662928303804, 'support': 261693}, 'accuracy': 0.5574976839658567, 'macro avg': {'precision': 0.51280178937199, 'recall': 0.47522816534213713, 'f1-score': 0.4800400445320117, 'support': 1140959}, 'weighted avg': {'precision': 0.5442887149335105, 'recall': 0.5574976839658567, 'f1-score': 0.5394471060954282, 'support': 1140959}}
[[111283 138051  18348]
 [105131 455336  51117]
 [ 47684 144546  69463]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8551881
{'0': {'precision': 0.4001677482011213, 'recall': 0.3696469494442043, 'f1-score': 0.3843023206518514, 'support': 122617}, '1': {'precision': 0.6847827758554402, 'recall': 0.8278712254616829, 'f1-score': 0.7495593246424698, 'support': 376503}, '2': {'precision': 0.5038721150352793, 'recall': 0.2166720113142077, 'f1-score': 0.30303483330841685, 'support': 121617}, 'accuracy': 0.6176077791399578, 'macro avg': {'precision': 0.5296075463639469, 'recall': 0.47139672874003163, 'f1-score': 0.4789654928675793, 'support': 620737}, 'weighted avg': {'precision': 0.5931168163865265, 'recall': 0.6176077791399578, 'f1-score': 0.5899237831476157, 'support': 620737}}
[[ 45325  69166   8126]
 [ 46987 311696  17820]
 [ 20953  74313  26351]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8629784
{'0': {'precision': 0.5693850850414305, 'recall': 0.15804764671702498, 'f1-score': 0.24741799162387007, 'support': 41304}, '1': {'precision': 0.6594786149177206, 'recall': 0.8797968113463763, 'f1-score': 0.7538705194091601, 'support': 119298}, '2': {'precision': 0.47346752058554437, 'recall': 0.3567208271787297, 'f1-score': 0.40688531955520607, 'support': 40620}, 'accuracy': 0.626054805140591, 'macro avg': {'precision': 0.5674437401815652, 'recall': 0.46485509508071027, 'f1-score': 0.46939127686274534, 'support': 201222}, 'weighted avg': {'precision': 0.6034360658436468, 'recall': 0.626054805140591, 'f1-score': 0.5798684022166501, 'support': 201222}}
[[  6528  30105   4671]
 [  2897 104958  11443]
 [  2040  24090  14490]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
4676/4676 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.899068
{'0': {'precision': 0.5062323405021146, 'recall': 0.47951449855951994, 'f1-score': 0.4925113371736732, 'support': 293305}, '1': {'precision': 0.6142535952562879, 'recall': 0.8267230035533637, 'f1-score': 0.704824183311823, 'support': 608719}, '2': {'precision': 0.5977675442987286, 'recall': 0.20243418710694489, 'f1-score': 0.30244520140304665, 'support': 294965}, 'accuracy': 0.5878057358923098, 'macro avg': {'precision': 0.5727511600190437, 'recall': 0.5028905630732762, 'f1-score': 0.4999269072961809, 'support': 1196989}, 'weighted avg': {'precision': 0.5837220012764189, 'recall': 0.5878057358923098, 'f1-score': 0.5536447357686357, 'support': 1196989}}
[[140644 134527  18134]
 [ 83432 503242  22045]
 [ 53749 181505  59711]]
Evaluating performance on  train set...
2108/2108 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9009727
{'0': {'precision': 0.48889650514601374, 'recall': 0.3662256856348919, 'f1-score': 0.4187622768579878, 'support': 132432}, '1': {'precision': 0.6248390475045925, 'recall': 0.7933572632680347, 'f1-score': 0.6990860051542266, 'support': 275248}, '2': {'precision': 0.5327256293814205, 'recall': 0.36689719044401764, 'f1-score': 0.4345277429389579, 'support': 131729}, 'accuracy': 0.584345088791622, 'macro avg': {'precision': 0.5488203940106756, 'recall': 0.5088267131156481, 'f1-score': 0.5174586749837241, 'support': 539409}, 'weighted avg': {'precision': 0.568968360835333, 'recall': 0.584345088791622, 'f1-score': 0.5656551070619021, 'support': 539409}}
[[ 48500  66993  16939]
 [ 31424 218370  25454]
 [ 19279  64119  48331]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95554465
{'0': {'precision': 0.5033427693790279, 'recall': 0.31178182360841666, 'f1-score': 0.38505310203423415, 'support': 53608}, '1': {'precision': 0.5810243076465296, 'recall': 0.8440124320764038, 'f1-score': 0.6882513626807991, 'support': 97168}, '2': {'precision': 0.5559353844091427, 'recall': 0.31053784375760524, 'f1-score': 0.39848657738273974, 'support': 53417}, 'accuracy': 0.5647255292786726, 'macro avg': {'precision': 0.5467674871449, 'recall': 0.48877736648080855, 'f1-score': 0.49059701403259104, 'support': 204193}, 'weighted avg': {'precision': 0.5540668364500844, 'recall': 0.5647255292786726, 'f1-score': 0.5328482984572092, 'support': 204193}}
[[16714 31300  5594]
 [ 7501 82011  7656]
 [ 8991 27838 16588]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
4274/4274 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1066074
{'0': {'precision': 0.4556903059482673, 'recall': 0.41912660192921136, 'f1-score': 0.43664434865021856, 'support': 340761}, '1': {'precision': 0.4462771911509633, 'recall': 0.7200195627020386, 'f1-score': 0.5510232399342002, 'support': 419165}, '2': {'precision': 0.5223964970441415, 'recall': 0.16317161420845816, 'f1-score': 0.24867049175841718, 'support': 334139}, 'accuracy': 0.45623523282437517, 'macro avg': {'precision': 0.4747879980477907, 'recall': 0.43410592627990274, 'f1-score': 0.41211269344761203, 'support': 1094065}, 'weighted avg': {'precision': 0.4724566696675823, 'recall': 0.45623523282437517, 'f1-score': 0.42305670202691964, 'support': 1094065}}
[[142822 177186  20753]
 [ 88264 301807  29094]
 [ 82333 197284  54522]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0389891
{'0': {'precision': 0.4100328914179632, 'recall': 0.3110386578804369, 'f1-score': 0.3537404307729803, 'support': 130659}, '1': {'precision': 0.543279600408673, 'recall': 0.7877453602732398, 'f1-score': 0.6430622973948973, 'support': 243010}, '2': {'precision': 0.5370956200805935, 'recall': 0.2178808503487102, 'f1-score': 0.3100039670247857, 'support': 130911}, 'accuracy': 0.5164552697292798, 'macro avg': {'precision': 0.49680270396907655, 'recall': 0.43888828950079567, 'f1-score': 0.4356022317308878, 'support': 504580}, 'weighted avg': {'precision': 0.5071714851469773, 'recall': 0.5164552697292798, 'f1-score': 0.48173306346165634, 'support': 504580}}
[[ 40640  79505  10514]
 [ 37511 191430  14069]
 [ 20963  81425  28523]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0703971
{'0': {'precision': 0.44033232628398794, 'recall': 0.1429826892027223, 'f1-score': 0.21586929354953174, 'support': 48929}, '1': {'precision': 0.50396986900467, 'recall': 0.8717633582321075, 'f1-score': 0.638702993797345, 'support': 83806}, '2': {'precision': 0.5330921151816674, 'recall': 0.2209125554468023, 'f1-score': 0.3123766895373833, 'support': 48019}, 'accuracy': 0.5015822609734778, 'macro avg': {'precision': 0.4924647701567751, 'recall': 0.411886200960544, 'f1-score': 0.38898299229475336, 'support': 180754}, 'weighted avg': {'precision': 0.49448017478707584, 'recall': 0.5015822609734778, 'f1-score': 0.43755285093088364, 'support': 180754}}
[[ 6996 37655  4278]
 [ 5734 73059  5013]
 [ 3158 34253 10608]]
testing model on single stock: results/universal/W4/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
12724/12724 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.224874
{'0': {'precision': 0.4177583278150462, 'recall': 0.34648407894600236, 'f1-score': 0.3787976384311674, 'support': 963190}, '1': {'precision': 0.4247212104814036, 'recall': 0.7653393560620835, 'f1-score': 0.5462845621040379, 'support': 1333172}, '2': {'precision': 0.47261253530694697, 'recall': 0.02751604157017439, 'f1-score': 0.05200433156326748, 'support': 960785}, 'accuracy': 0.4238359521384819, 'macro avg': {'precision': 0.4383640245344656, 'recall': 0.3797798255260867, 'f1-score': 0.32569551069949093, 'support': 3257147}, 'weighted avg': {'precision': 0.4367890378060841, 'recall': 0.4238359521384819, 'f1-score': 0.3509544890945648, 'support': 3257147}}
[[ 333730  620538    8922]
 [ 292264 1020329   20579]
 [ 172865  761483   26437]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5221314
{'0': {'precision': 0.4297684865238424, 'recall': 0.10061956030769023, 'f1-score': 0.16306218213799922, 'support': 444993}, '1': {'precision': 0.32779782976821953, 'recall': 0.922215702055708, 'f1-score': 0.4836752531325668, 'support': 431141}, '2': {'precision': 0.4915322580645161, 'recall': 0.00546675994690202, 'f1-score': 0.010813256218287621, 'support': 445968}, 'accuracy': 0.33644756607281434, 'macro avg': {'precision': 0.4163661914521927, 'recall': 0.3427673407701001, 'f1-score': 0.2191835638296179, 'support': 1322102}, 'weighted avg': {'precision': 0.41734957689521707, 'recall': 0.33644756607281434, 'f1-score': 0.2162587517272646, 'support': 1322102}}
[[ 44775 399423    795]
 [ 31809 397605   1727]
 [ 27600 415930   2438]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4951515
{'0': {'precision': 0.43829787234042555, 'recall': 0.028411180581095992, 'f1-score': 0.053363267420775407, 'support': 163140}, '1': {'precision': 0.3320710420907619, 'recall': 0.9645653755564598, 'f1-score': 0.4940540386901989, 'support': 162186}, '2': {'precision': 0.4560480841472577, 'recall': 0.015017875477813377, 'f1-score': 0.029078192553204228, 'support': 161674}, 'accuracy': 0.3357330595482546, 'macro avg': {'precision': 0.40880566619281505, 'recall': 0.3359981438717898, 'f1-score': 0.19216516622139287, 'support': 487000}, 'weighted avg': {'precision': 0.4088137718327989, 'recall': 0.3357330595482546, 'f1-score': 0.19206472170201364, 'support': 487000}}
[[  4635 157670    835]
 [  3686 156439   2061]
 [  2254 156992   2428]]
training model: results/universal/W4/deepOF_L1/h10
Epoch 1/50
9854/9854 - 140s - loss: 2.9377 - accuracy10: 0.5380 - val_loss: 3.5654 - val_accuracy10: 0.4889 - 140s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 139s - loss: 2.9171 - accuracy10: 0.5408 - val_loss: 3.5740 - val_accuracy10: 0.4886 - 139s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 141s - loss: 2.8984 - accuracy10: 0.5418 - val_loss: 3.5615 - val_accuracy10: 0.4883 - 141s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 135s - loss: 2.8842 - accuracy10: 0.5410 - val_loss: 3.5723 - val_accuracy10: 0.4870 - 135s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 138s - loss: 2.8695 - accuracy10: 0.5409 - val_loss: 3.6724 - val_accuracy10: 0.4888 - 138s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 137s - loss: 2.8571 - accuracy10: 0.5409 - val_loss: 3.9446 - val_accuracy10: 0.4890 - 137s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 136s - loss: 2.8474 - accuracy10: 0.5414 - val_loss: 3.9676 - val_accuracy10: 0.4889 - 136s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 137s - loss: 2.8386 - accuracy10: 0.5418 - val_loss: 4.0857 - val_accuracy10: 0.4877 - 137s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 138s - loss: 2.8309 - accuracy10: 0.5425 - val_loss: 4.2061 - val_accuracy10: 0.4882 - 138s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 133s - loss: 2.8241 - accuracy10: 0.5431 - val_loss: 4.2457 - val_accuracy10: 0.4889 - 133s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 136s - loss: 2.8179 - accuracy10: 0.5437 - val_loss: 4.3461 - val_accuracy10: 0.4888 - 136s/epoch - 14ms/step
Epoch 12/50
9854/9854 - 140s - loss: 2.8120 - accuracy10: 0.5444 - val_loss: 4.2806 - val_accuracy10: 0.4905 - 140s/epoch - 14ms/step
Epoch 13/50
9854/9854 - 135s - loss: 2.8068 - accuracy10: 0.5450 - val_loss: 4.4217 - val_accuracy10: 0.4903 - 135s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 124s - 124s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.959883
{'0': {'precision': 0.4354867438896094, 'recall': 0.11831025318226325, 'f1-score': 0.18607015639130467, 'support': 1322565}, '1': {'precision': 0.5715440880834101, 'recall': 0.9319807976483, 'f1-score': 0.7085590935781775, 'support': 3418123}, '2': {'precision': 0.4536395647530811, 'recall': 0.047237142945159113, 'f1-score': 0.08556451772052064, 'support': 1330923}, 'accuracy': 0.5608012436896896, 'macro avg': {'precision': 0.48689013224203354, 'recall': 0.3658427312585741, 'f1-score': 0.32673125589666757, 'support': 6071611}, 'weighted avg': {'precision': 0.5160618572013517, 'recall': 0.5608012436896896, 'f1-score': 0.4581834698607232, 'support': 6071611}}
[[ 156473 1153743   12349]
 [ 169128 3185625   63370]
 [  33705 1234349   62869]]
Evaluating performance on  train set...
9854/9854 - 61s - 61s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199821
{'0': {'precision': 0.4349535909808609, 'recall': 0.09361581167263765, 'f1-score': 0.154070717128871, 'support': 629712}, '1': {'precision': 0.5038352111560438, 'recall': 0.9329780882890439, 'f1-score': 0.6543191273335476, 'support': 1261289}, '2': {'precision': 0.46493072614719466, 'recall': 0.037492096042395326, 'f1-score': 0.06938867689889104, 'support': 631013}, 'accuracy': 0.49934853652676, 'macro avg': {'precision': 0.4679065094280331, 'recall': 0.3546953320013589, 'f1-score': 0.2925928404537699, 'support': 2522014}, 'weighted avg': {'precision': 0.47690244289914924, 'recall': 0.49934853652676, 'f1-score': 0.3830632400914739, 'support': 2522014}}
[[  58951  566107    4654]
 [  61961 1176755   22573]
 [  14622  592733   23658]]
Evaluating performance on  val set...
3566/3566 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0332353
{'0': {'precision': 0.431814598770298, 'recall': 0.0945224270764134, 'f1-score': 0.15509516495494796, 'support': 231818}, '1': {'precision': 0.4923968216192408, 'recall': 0.9298294254035188, 'f1-score': 0.6438427847540783, 'support': 447253}, '2': {'precision': 0.44672227443609025, 'recall': 0.03260058813947307, 'f1-score': 0.06076659395450295, 'support': 233278}, 'accuracy': 0.4881750295117329, 'macro avg': {'precision': 0.4569778982752097, 'recall': 0.3523174802064684, 'f1-score': 0.2865681812211764, 'support': 912349}, 'weighted avg': {'precision': 0.4653250357629652, 'recall': 0.4881750295117329, 'f1-score': 0.3705708862109351, 'support': 912349}}
[[ 21912 208284   1622]
 [ 23587 415869   7797]
 [  5245 220428   7605]]
testing model out of sample: results/universal/W4/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 68s - 68s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9554448
{'0': {'precision': 0.41272737734158593, 'recall': 0.07832358942041917, 'f1-score': 0.1316616475011898, 'support': 641084}, '1': {'precision': 0.5869986365976154, 'recall': 0.9578785763339066, 'f1-score': 0.7279198807873041, 'support': 1761930}, '2': {'precision': 0.47004568571674854, 'recall': 0.026024167684789247, 'f1-score': 0.04931784368965844, 'support': 628608}, 'accuracy': 0.5786625113553074, 'macro avg': {'precision': 0.4899238998853166, 'recall': 0.35407544447970496, 'f1-score': 0.30296645732605076, 'support': 3031622}, 'weighted avg': {'precision': 0.5258960068778772, 'recall': 0.5786625113553074, 'f1-score': 0.4611233334064393, 'support': 3031622}}
[[  50212  587474    3398]
 [  59169 1687715   15046]
 [  12278  599971   16359]]
Evaluating performance on  train set...
5528/5528 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8956872
{'0': {'precision': 0.38136337868480724, 'recall': 0.10426975522240003, 'f1-score': 0.16376422187803338, 'support': 258071}, '1': {'precision': 0.6466092845283467, 'recall': 0.9442387893933083, 'f1-score': 0.7675824964585366, 'support': 900375}, '2': {'precision': 0.4481276434785599, 'recall': 0.050905056912728605, 'f1-score': 0.09142472297930106, 'support': 256006}, 'accuracy': 0.629296717032462, 'macro avg': {'precision': 0.4920334355639046, 'recall': 0.36647120050947896, 'f1-score': 0.340923813771957, 'support': 1414452}, 'weighted avg': {'precision': 0.5622905751161221, 'recall': 0.629296717032462, 'f1-score': 0.5350341788792974, 'support': 1414452}}
[[ 26909 228764   2398]
 [ 36555 850169  13651]
 [  7096 235878  13032]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90998036
{'0': {'precision': 0.3842248095946774, 'recall': 0.0948839622539535, 'f1-score': 0.15218578524432422, 'support': 92513}, '1': {'precision': 0.6319126051745553, 'recall': 0.9479073221544214, 'f1-score': 0.7583074185161915, 'support': 304323}, '2': {'precision': 0.43092184853617227, 'recall': 0.03923814979235286, 'f1-score': 0.07192690191327174, 'support': 90779}, 'accuracy': 0.6169006285696708, 'macro avg': {'precision': 0.48235308776846836, 'recall': 0.3606764780669092, 'f1-score': 0.3274733685579292, 'support': 487615}, 'weighted avg': {'precision': 0.5475015822787112, 'recall': 0.6169006285696708, 'f1-score': 0.5155276279527825, 'support': 487615}}
[[  8778  82968    767]
 [ 11916 288470   3937]
 [  2152  85065   3562]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2724799
{'0': {'precision': 0.36644591611479027, 'recall': 0.01805171926314187, 'f1-score': 0.034408423845452285, 'support': 45979}, '1': {'precision': 0.33332580768970266, 'recall': 0.9770581487690815, 'f1-score': 0.49707369354304737, 'support': 45332}, '2': {'precision': 0.4588313413014608, 'recall': 0.01524074196607777, 'f1-score': 0.029501547657167254, 'support': 45339}, 'accuracy': 0.335257958287596, 'macro avg': {'precision': 0.3862010217019846, 'recall': 0.33678353666610034, 'f1-score': 0.1869945550152223, 'support': 136650}, 'weighted avg': {'precision': 0.38611120727770565, 'recall': 0.335257958287596, 'f1-score': 0.18626403413766396, 'support': 136650}}
[[  830 44692   457]
 [  682 44292   358]
 [  753 43895   691]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.133924
{'0': {'precision': 0.37168141592920356, 'recall': 0.009688581314878892, 'f1-score': 0.018884892086330936, 'support': 17340}, '1': {'precision': 0.4620456913578327, 'recall': 0.9923511139316611, 'f1-score': 0.6305178268251274, 'support': 29939}, '2': {'precision': 0.36464088397790057, 'recall': 0.003738317757009346, 'f1-score': 0.00740076250280332, 'support': 17655}, 'accuracy': 0.4611451627806696, 'macro avg': {'precision': 0.39945599708831225, 'recall': 0.3352593376678498, 'f1-score': 0.21893449380475385, 'support': 64934}, 'weighted avg': {'precision': 0.41143124576345796, 'recall': 0.4611451627806696, 'f1-score': 0.29776692808207506, 'support': 64934}}
[[  168 17134    38]
 [  152 29710    77]
 [  132 17457    66]]
Evaluating performance on  val set...
81/81 - 1s - 579ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1636679
{'0': {'precision': 0.36764705882352944, 'recall': 0.00862663906142167, 'f1-score': 0.016857720836142953, 'support': 5796}, '1': {'precision': 0.436452719255267, 'recall': 0.9912095248692556, 'f1-score': 0.6060482362145797, 'support': 8987}, '2': {'precision': 0.3142857142857143, 'recall': 0.0037716440939482257, 'f1-score': 0.007453837032017619, 'support': 5833}, 'accuracy': 0.4355840124175398, 'macro avg': {'precision': 0.37279516412150354, 'recall': 0.3345359360082085, 'f1-score': 0.21011993136091345, 'support': 20616}, 'weighted avg': {'precision': 0.38254324370958637, 'recall': 0.4355840124175398, 'f1-score': 0.27103905123372485, 'support': 20616}}
[[  50 5727   19]
 [  50 8908   29]
 [  36 5775   22]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
1613/1613 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6931508
{'0': {'precision': 0.28967439903213926, 'recall': 0.1630689052737556, 'f1-score': 0.20866962221969612, 'support': 33771}, '1': {'precision': 0.850707439642893, 'recall': 0.9572018154522111, 'f1-score': 0.9008181172257383, 'support': 345038}, '2': {'precision': 0.33178654292343385, 'recall': 0.054618639088024445, 'f1-score': 0.09379651353465022, 'support': 34036}, 'accuracy': 0.8178299361745933, 'macro avg': {'precision': 0.49072279386615536, 'recall': 0.39162978660466363, 'f1-score': 0.40109475099336156, 'support': 412845}, 'weighted avg': {'precision': 0.7620333889575043, 'recall': 0.8178299361745933, 'f1-score': 0.777666973023728, 'support': 412845}}
[[  5507  27252   1012]
 [ 12035 330271   2732]
 [  1469  30708   1859]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7116489
{'0': {'precision': 0.3776352861167784, 'recall': 0.24195455960161844, 'f1-score': 0.2949389179755672, 'support': 16065}, '1': {'precision': 0.8295803203352031, 'recall': 0.9437746989989697, 'f1-score': 0.8830007624911881, 'support': 130066}, '2': {'precision': 0.45067550344124396, 'recall': 0.11012145748987855, 'f1-score': 0.17699469416357994, 'support': 16055}, 'accuracy': 0.7917329485898906, 'macro avg': {'precision': 0.5526303699644085, 'recall': 0.4319502386968222, 'f1-score': 0.4516447915434451, 'support': 162186}, 'weighted avg': {'precision': 0.7473055628965123, 'recall': 0.7917329485898906, 'f1-score': 0.7548630628183236, 'support': 162186}}
[[  3887  11769    409]
 [  5567 122753   1746]
 [   839  13448   1768]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66719973
{'0': {'precision': 0.3524804177545692, 'recall': 0.20179372197309417, 'f1-score': 0.25665399239543724, 'support': 4014}, '1': {'precision': 0.8654522663863168, 'recall': 0.9607029040800754, 'f1-score': 0.9105934907466496, 'support': 44558}, '2': {'precision': 0.4437564499484004, 'recall': 0.10343998075535242, 'f1-score': 0.16777214202106908, 'support': 4157}, 'accuracy': 0.8353467731229495, 'macro avg': {'precision': 0.5538963780297621, 'recall': 0.4219788689361739, 'f1-score': 0.44500654172105203, 'support': 52729}, 'weighted avg': {'precision': 0.7931569732963616, 'recall': 0.8353467731229495, 'f1-score': 0.8022504253929731, 'support': 52729}}
[[  810  3099   105]
 [ 1317 42807   434]
 [  171  3556   430]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0876257
{'0': {'precision': 0.4889625502503703, 'recall': 0.09947486225895316, 'f1-score': 0.16531743666169896, 'support': 69696}, '1': {'precision': 0.46212645312440315, 'recall': 0.9462738452179204, 'f1-score': 0.620985633544163, 'support': 115065}, '2': {'precision': 0.5074062401512764, 'recall': 0.023605653627353236, 'f1-score': 0.04511257127646161, 'support': 68204}, 'accuracy': 0.4641986045500366, 'macro avg': {'precision': 0.48616508117534996, 'recall': 0.3564514537014089, 'f1-score': 0.2771385471607745, 'support': 252965}, 'weighted avg': {'precision': 0.48172849775378773, 'recall': 0.4641986045500366, 'f1-score': 0.3401756519703227, 'support': 252965}}
[[  6933  62282    481]
 [  5100 108883   1082]
 [  2146  64448   1610]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1893197
{'0': {'precision': 0.5195758564437194, 'recall': 0.09096751160299893, 'f1-score': 0.1548277328796257, 'support': 28010}, '1': {'precision': 0.351482055383385, 'recall': 0.9317278388763747, 'f1-score': 0.5104162886074112, 'support': 30188}, '2': {'precision': 0.46774193548387094, 'recall': 0.026603627125820338, 'f1-score': 0.05034386058623223, 'support': 28342}, 'accuracy': 0.3631730991449041, 'macro avg': {'precision': 0.44626661577032517, 'recall': 0.349766325868398, 'f1-score': 0.23852929402442302, 'support': 86540}, 'weighted avg': {'precision': 0.44396350776965654, 'recall': 0.3631730991449041, 'f1-score': 0.2446500741295798, 'support': 86540}}
[[ 2548 25237   225]
 [ 1428 28127   633]
 [  928 26660   754]]
Evaluating performance on  val set...
124/124 - 1s - 957ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2271321
{'0': {'precision': 0.4633781763826607, 'recall': 0.08744710860366714, 'f1-score': 0.14712861888941625, 'support': 10635}, '1': {'precision': 0.31244166349777025, 'recall': 0.9164469681606165, 'f1-score': 0.466008404444559, 'support': 9862}, '2': {'precision': 0.5635451505016722, 'recall': 0.030539193475305846, 'f1-score': 0.05793862288317717, 'support': 11035}, 'accuracy': 0.3268108588100977, 'macro avg': {'precision': 0.4464549967940344, 'recall': 0.34481109007986316, 'f1-score': 0.22369188207238414, 'support': 31532}, 'weighted avg': {'precision': 0.45122565416182164, 'recall': 0.3268108588100977, 'f1-score': 0.21564887891783088, 'support': 31532}}
[[  930  9618    87]
 [  650  9038   174]
 [  427 10271   337]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1199152
{'0': {'precision': 0.48474025974025975, 'recall': 0.021298449335939173, 'f1-score': 0.040804055808360315, 'support': 70099}, '1': {'precision': 0.4442077287438112, 'recall': 0.9899124022047515, 'f1-score': 0.6132355725985892, 'support': 104683}, '2': {'precision': 0.4707692307692308, 'recall': 0.0024714091878270984, 'f1-score': 0.004917005447270741, 'support': 61908}, 'accuracy': 0.44477164223245597, 'macro avg': {'precision': 0.46657240641776726, 'recall': 0.33789408690950595, 'f1-score': 0.21965221128474008, 'support': 236690}, 'weighted avg': {'precision': 0.4631593505179027, 'recall': 0.44477164223245597, 'f1-score': 0.2845919342924416, 'support': 236690}}
[[  1493  68523     83]
 [   967 103627     89]
 [   620  61135    153]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.246112
{'0': {'precision': 0.4212538226299694, 'recall': 0.018569069524483537, 'f1-score': 0.03557018817985217, 'support': 29673}, '1': {'precision': 0.3277902914406546, 'recall': 0.9814196745002236, 'f1-score': 0.4914411736834397, 'support': 29063}, '2': {'precision': 0.5102040816326531, 'recall': 0.004189990949619549, 'f1-score': 0.00831172285391316, 'support': 29833}, 'accuracy': 0.329675168512685, 'macro avg': {'precision': 0.419749398567759, 'recall': 0.33472624499144227, 'f1-score': 0.17844102823906835, 'support': 88569}, 'weighted avg': {'precision': 0.4205461536924405, 'recall': 0.329675168512685, 'f1-score': 0.17597796805341995, 'support': 88569}}
[[  551 29060    62]
 [  482 28523    58]
 [  275 29433   125]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2203044
{'0': {'precision': 0.46631205673758863, 'recall': 0.024121801339080987, 'f1-score': 0.04587075957094271, 'support': 10903}, '1': {'precision': 0.34180415955496557, 'recall': 0.9819304458367384, 'f1-score': 0.5070924480082531, 'support': 11013}, '2': {'precision': 0.5147058823529411, 'recall': 0.0033803361019895694, 'f1-score': 0.006716561120706198, 'support': 10354}, 'accuracy': 0.3443445925007747, 'macro avg': {'precision': 0.4409406995484984, 'recall': 0.3364775277592696, 'f1-score': 0.18655992289996734, 'support': 32270}, 'weighted avg': {'precision': 0.43934782366504854, 'recall': 0.3443445925007747, 'f1-score': 0.1907121566582173, 'support': 32270}}
[[  263 10625    15]
 [  181 10814    18]
 [  120 10199    35]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1434989
{'0': {'precision': 0.49023742580443613, 'recall': 0.05125797205595342, 'f1-score': 0.09281178149235193, 'support': 122459}, '1': {'precision': 0.41186472845154803, 'recall': 0.9666935542125159, 'f1-score': 0.5776280672474444, 'support': 166124}, '2': {'precision': 0.4870175438596491, 'recall': 0.01758327140058104, 'f1-score': 0.033941132838290554, 'support': 118408}, 'accuracy': 0.4151197446626584, 'macro avg': {'precision': 0.4630398993718778, 'recall': 0.3451782658896834, 'f1-score': 0.23479366052602899, 'support': 406991}, 'weighted avg': {'precision': 0.4573107867476277, 'recall': 0.4151197446626584, 'f1-score': 0.27357466049692175, 'support': 406991}}
[[  6277 115571    611]
 [  3951 160591   1582]
 [  2576 113750   2082]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2277296
{'0': {'precision': 0.4943778110944528, 'recall': 0.05720729512285039, 'f1-score': 0.10254815448308033, 'support': 46113}, '1': {'precision': 0.3291089866156788, 'recall': 0.9545898220861617, 'f1-score': 0.4894669790932048, 'support': 45078}, '2': {'precision': 0.528146742567995, 'recall': 0.01796626215681212, 'f1-score': 0.03475040056599455, 'support': 46476}, 'accuracy': 0.3378006348652909, 'macro avg': {'precision': 0.4505445134260422, 'recall': 0.3432544597886081, 'f1-score': 0.20892184471409322, 'support': 137667}, 'weighted avg': {'precision': 0.4516621042751727, 'recall': 0.3378006348652909, 'f1-score': 0.20635341184123235, 'support': 137667}}
[[ 2638 43224   251]
 [ 1552 43031   495]
 [ 1146 44495   835]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1830614
{'0': {'precision': 0.5521126760563381, 'recall': 0.057684384013185, 'f1-score': 0.10445534001279046, 'support': 16989}, '1': {'precision': 0.3732284690858122, 'recall': 0.9692128810474698, 'f1-score': 0.5389253538349099, 'support': 19781}, '2': {'precision': 0.5402298850574713, 'recall': 0.011243346689791281, 'f1-score': 0.02202823832679126, 'support': 16721}, 'accuracy': 0.380250883326167, 'macro avg': {'precision': 0.48852367673320723, 'recall': 0.34604687058348205, 'f1-score': 0.2218029773914972, 'support': 53491}, 'weighted avg': {'precision': 0.4822467052130929, 'recall': 0.380250883326167, 'f1-score': 0.23935630982310904, 'support': 53491}}
[[  980 15953    56]
 [  505 19172   104]
 [  290 16243   188]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/EXC
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76598513
{'0': {'precision': 0.35130676123660476, 'recall': 0.1958852406867676, 'f1-score': 0.2515234478495098, 'support': 116313}, '1': {'precision': 0.7785634957353306, 'recall': 0.9149290196411404, 'f1-score': 0.8412559599924196, 'support': 730202}, '2': {'precision': 0.4332829584851987, 'recall': 0.16054943878517372, 'f1-score': 0.23428609196714517, 'support': 121433}, 'accuracy': 0.7338854979812965, 'macro avg': {'precision': 0.5210510718190446, 'recall': 0.42378789970436065, 'f1-score': 0.44235516660302493, 'support': 967948}, 'weighted avg': {'precision': 0.683905555391794, 'recall': 0.7338854979812965, 'f1-score': 0.6942442097033633, 'support': 967948}}
[[ 22784  91451   2078]
 [ 38697 668083  23422]
 [  3374  98563  19496]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8178918
{'0': {'precision': 0.3408787525916669, 'recall': 0.20222750172707207, 'f1-score': 0.25385477696228775, 'support': 59349}, '1': {'precision': 0.7319633539381073, 'recall': 0.8966636473429952, 'f1-score': 0.8059855696206435, 'support': 291456}, '2': {'precision': 0.4055644424131627, 'recall': 0.1204343031639664, 'f1-score': 0.18571858363091734, 'support': 58945}, 'accuracy': 0.6844148871262965, 'macro avg': {'precision': 0.492802182980979, 'recall': 0.4064418174113445, 'f1-score': 0.41518631007128287, 'support': 409750}, 'weighted avg': {'precision': 0.6283634421744764, 'recall': 0.6844148871262965, 'f1-score': 0.6367847205598866, 'support': 409750}}
[[ 12002  46363    984]
 [ 20697 261338   9421]
 [  2510  49336   7099]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78165394
{'0': {'precision': 0.32658652996287785, 'recall': 0.21647431015290877, 'f1-score': 0.2603671211640771, 'support': 17069}, '1': {'precision': 0.7722636805479774, 'recall': 0.9006617978188084, 'f1-score': 0.8315354197265845, 'support': 102146}, '2': {'precision': 0.38862642169728784, 'recall': 0.13108658443014815, 'f1-score': 0.19604554682672787, 'support': 16943}, 'accuracy': 0.7191277780225914, 'macro avg': {'precision': 0.49582554406938106, 'recall': 0.4160742308006218, 'f1-score': 0.42931602923912987, 'support': 136158}, 'weighted avg': {'precision': 0.6686544224798191, 'recall': 0.7191277780225914, 'f1-score': 0.6808547648645441, 'support': 136158}}
[[ 3695 13059   315]
 [ 6968 91999  3179]
 [  651 14071  2221]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/AAL
Evaluating performance on  test set...
4457/4457 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.829798
{'0': {'precision': 0.3694352969874375, 'recall': 0.15826874510145433, 'f1-score': 0.22160171682192847, 'support': 172245}, '1': {'precision': 0.7150998622589532, 'recall': 0.9346116629870308, 'f1-score': 0.8102515636701786, 'support': 799898}, '2': {'precision': 0.44489965015650895, 'recall': 0.057253038883491696, 'f1-score': 0.10145064449762774, 'support': 168812}, 'accuracy': 0.6875994232901386, 'macro avg': {'precision': 0.5098116031342999, 'recall': 0.3833778156573256, 'f1-score': 0.37776797499657827, 'support': 1140955}, 'weighted avg': {'precision': 0.6229384437537272, 'recall': 0.6875994232901386, 'f1-score': 0.616513779412488, 'support': 1140955}}
[[ 27261 143487   1497]
 [ 41742 747594  10562]
 [  4788 154359   9665]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7829494
{'0': {'precision': 0.33502394242484346, 'recall': 0.14823172489876765, 'f1-score': 0.2055275508430384, 'support': 79767}, '1': {'precision': 0.7625651034834955, 'recall': 0.9391397807774238, 'f1-score': 0.8416914480739032, 'support': 464277}, '2': {'precision': 0.4142323742587305, 'recall': 0.07377754596427175, 'f1-score': 0.1252476507764336, 'support': 76690}, 'accuracy': 0.7305915255165659, 'macro avg': {'precision': 0.5039404733890231, 'recall': 0.3870496838801544, 'f1-score': 0.39082221656445837, 'support': 620734}, 'weighted avg': {'precision': 0.6645886549589862, 'recall': 0.7305915255165659, 'f1-score': 0.6714269540955529, 'support': 620734}}
[[ 11824  66989    954]
 [ 21209 436021   7047]
 [  2260  68772   5658]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7987077
{'0': {'precision': 0.3287432295969889, 'recall': 0.1324383298198898, 'f1-score': 0.18881155752399031, 'support': 27039}, '1': {'precision': 0.7488716229286221, 'recall': 0.940374338767138, 'f1-score': 0.8337680517833428, 'support': 148208}, '2': {'precision': 0.3984837716181, 'recall': 0.06475457170356112, 'f1-score': 0.11140548417008876, 'support': 25975}, 'accuracy': 0.7187782648020594, 'macro avg': {'precision': 0.49203287471457036, 'recall': 0.379189080096863, 'f1-score': 0.3779950311591406, 'support': 201222}, 'weighted avg': {'precision': 0.6471870354327973, 'recall': 0.7187782648020594, 'f1-score': 0.6538555852437353, 'support': 201222}}
[[  3581  23103    355]
 [  6653 139371   2184]
 [   659  23634   1682]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/WBA
Evaluating performance on  test set...
4676/4676 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82622844
{'0': {'precision': 0.423011887681902, 'recall': 0.17689093636168846, 'f1-score': 0.24946363279243347, 'support': 186680}, '1': {'precision': 0.7066628514992224, 'recall': 0.9323925719880941, 'f1-score': 0.8039840315294857, 'support': 821108}, '2': {'precision': 0.47891684963125597, 'recall': 0.0899274301389557, 'f1-score': 0.15142197282877143, 'support': 189197}, 'accuracy': 0.681404528878808, 'macro avg': {'precision': 0.5361971962707934, 'recall': 0.39973697949624604, 'f1-score': 0.4016232123835635, 'support': 1196985}, 'weighted avg': {'precision': 0.6264272409938016, 'recall': 0.681404528878808, 'f1-score': 0.6143570505261883, 'support': 1196985}}
[[ 33022 150912   2746]
 [ 39747 765595  15766]
 [  5295 166888  17014]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82851076
{'0': {'precision': 0.410275251829399, 'recall': 0.15557877626843145, 'f1-score': 0.22560631697687533, 'support': 86130}, '1': {'precision': 0.7002395641032426, 'recall': 0.9355537849472307, 'f1-score': 0.800971314557379, 'support': 367733}, '2': {'precision': 0.4805985618967416, 'recall': 0.08672729823248855, 'f1-score': 0.14693853299135484, 'support': 85544}, 'accuracy': 0.6763964872535951, 'macro avg': {'precision': 0.5303711259431277, 'recall': 0.3926199531493835, 'f1-score': 0.39117205484186973, 'support': 539407}, 'weighted avg': {'precision': 0.6191067717796371, 'recall': 0.6763964872535951, 'f1-score': 0.6053773242904882, 'support': 539407}}
[[ 13400  71599   1131]
 [ 16812 344034   6887]
 [  2449  75676   7419]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8618903
{'0': {'precision': 0.40270715462293205, 'recall': 0.1564464971342719, 'f1-score': 0.22534816150686304, 'support': 35942}, '1': {'precision': 0.6674851480855123, 'recall': 0.9257828064504003, 'f1-score': 0.7756966075911095, 'support': 133015}, '2': {'precision': 0.4728317659352142, 'recall': 0.07705187876035872, 'f1-score': 0.13251012738542634, 'support': 35236}, 'accuracy': 0.6439055207573228, 'macro avg': {'precision': 0.5143413562145528, 'recall': 0.38642706078167693, 'f1-score': 0.37785163216113293, 'support': 204193}, 'weighted avg': {'precision': 0.587289170679431, 'recall': 0.6439055207573228, 'f1-score': 0.5678347187619751, 'support': 204193}}
[[  5623  29845    474]
 [  7319 123143   2553]
 [  1021  31500   2715]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
4274/4274 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94635826
{'0': {'precision': 0.477115043295864, 'recall': 0.038451702390498686, 'f1-score': 0.07116783929273399, 'support': 230705}, '1': {'precision': 0.584643113491879, 'recall': 0.9856084316400503, 'f1-score': 0.7339323230654401, 'support': 635511}, '2': {'precision': 0.5741778319123021, 'recall': 0.010344751914678839, 'f1-score': 0.020323345548609612, 'support': 227845}, 'accuracy': 0.5827764631039768, 'macro avg': {'precision': 0.5453119962333484, 'recall': 0.3448016286484093, 'f1-score': 0.27514116930226123, 'support': 1094061}, 'weighted avg': {'precision': 0.5597891743458255, 'recall': 0.5827764631039768, 'f1-score': 0.44556145735401775, 'support': 1094061}}
[[  8871 221502    332]
 [  7730 626365   1416]
 [  1992 223496   2357]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8627257
{'0': {'precision': 0.3978464381855438, 'recall': 0.11402448152370424, 'f1-score': 0.177248724603956, 'support': 86841}, '1': {'precision': 0.6698191713070023, 'recall': 0.946266617909717, 'f1-score': 0.7843983606228832, 'support': 330893}, '2': {'precision': 0.47174748548532175, 'recall': 0.0664302246582914, 'f1-score': 0.1164607558139535, 'support': 86843}, 'accuracy': 0.6516032240867102, 'macro avg': {'precision': 0.513137698325956, 'recall': 0.37557377469723746, 'f1-score': 0.3593692803469309, 'support': 504577}, 'weighted avg': {'precision': 0.5889206691382297, 'recall': 0.6516032240867102, 'f1-score': 0.5649448640189129, 'support': 504577}}
[[  9902  75974    965]
 [ 12285 313113   5495]
 [  2702  78372   5769]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86963016
{'0': {'precision': 0.39947023208879917, 'recall': 0.0988020215885693, 'f1-score': 0.15842128958031115, 'support': 32054}, '1': {'precision': 0.6594782403863141, 'recall': 0.9531940247691194, 'f1-score': 0.7795889242764404, 'support': 117485}, '2': {'precision': 0.4396551724137931, 'recall': 0.04247957712638155, 'f1-score': 0.07747363500920218, 'support': 31215}, 'accuracy': 0.6444062095444637, 'macro avg': {'precision': 0.4995345482963021, 'recall': 0.3648252078280234, 'f1-score': 0.3384946162886513, 'support': 180754}, 'weighted avg': {'precision': 0.575407770218402, 'recall': 0.6444062095444637, 'f1-score': 0.5481836103302674, 'support': 180754}}
[[  3167  28661    226]
 [  4035 111986   1464]
 [   726  29163   1326]]
testing model on single stock: results/universal/W4/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
12724/12724 - 78s - 78s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0887729
{'0': {'precision': 0.4822457926160218, 'recall': 0.10223304088011165, 'f1-score': 0.1687022728808596, 'support': 915702}, '1': {'precision': 0.43777851443026944, 'recall': 0.9300617038272745, 'f1-score': 0.5953341999969284, 'support': 1417092}, '2': {'precision': 0.4633043279138997, 'recall': 0.0262660531898666, 'f1-score': 0.049713694250235224, 'support': 924349}, 'accuracy': 0.44083941048949954, 'macro avg': {'precision': 0.46110954498673035, 'recall': 0.3528535992990843, 'f1-score': 0.2712500557093411, 'support': 3257143}, 'weighted avg': {'precision': 0.45752389734315657, 'recall': 0.44083941048949954, 'f1-score': 0.3205499864114369, 'support': 3257143}}
[[  93615  815538    6549]
 [  77533 1317983   21576]
 [  22975  877095   24279]]
Evaluating performance on  train set...
5165/5165 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1832865
{'0': {'precision': 0.5216559155029418, 'recall': 0.06712961379263162, 'f1-score': 0.11895183695241483, 'support': 438495}, '1': {'precision': 0.33558702487155234, 'recall': 0.9483961704039316, 'f1-score': 0.49575329396292167, 'support': 442971}, '2': {'precision': 0.5289813070569482, 'recall': 0.01656923174683866, 'f1-score': 0.03213199600385531, 'support': 440636}, 'accuracy': 0.3455474691060145, 'macro avg': {'precision': 0.46207474914381413, 'recall': 0.344031671981134, 'f1-score': 0.2156123756397306, 'support': 1322102}, 'weighted avg': {'precision': 0.4617548705615636, 'recall': 0.3455474691060145, 'f1-score': 0.21626367127169713, 'support': 1322102}}
[[ 29436 407072   1987]
 [ 18345 420112   4514]
 [  8647 424688   7301]]
Evaluating performance on  val set...
1903/1903 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2024748
{'0': {'precision': 0.511248169676532, 'recall': 0.07030325218134115, 'f1-score': 0.12360870474770286, 'support': 163890}, '1': {'precision': 0.3200326936621249, 'recall': 0.9406022195104811, 'f1-score': 0.47757436959592825, 'support': 156521}, '2': {'precision': 0.4866937302661254, 'recall': 0.01295411434196941, 'f1-score': 0.025236519278221514, 'support': 166588}, 'accuracy': 0.33039903572697277, 'macro avg': {'precision': 0.4393248645349274, 'recall': 0.3412865286779305, 'f1-score': 0.2088065312072842, 'support': 486999}, 'weighted avg': {'precision': 0.4413923538047297, 'recall': 0.33039903572697277, 'f1-score': 0.20372269716805513, 'support': 486999}}
[[ 11522 151674    694]
 [  7715 147224   1582]
 [  3300 161130   2158]]
training model: results/universal/W4/deepOF_L1/h20
Epoch 1/50
9854/9854 - 139s - loss: 3.0291 - accuracy20: 0.5002 - val_loss: 3.3420 - val_accuracy20: 0.4576 - 139s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 142s - loss: 3.0056 - accuracy20: 0.5023 - val_loss: 3.3539 - val_accuracy20: 0.4597 - 142s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 137s - loss: 2.9860 - accuracy20: 0.5046 - val_loss: 3.3869 - val_accuracy20: 0.4620 - 137s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 135s - loss: 2.9684 - accuracy20: 0.5067 - val_loss: 3.4616 - val_accuracy20: 0.4606 - 135s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 135s - loss: 2.9523 - accuracy20: 0.5086 - val_loss: 3.5535 - val_accuracy20: 0.4599 - 135s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 135s - loss: 2.9399 - accuracy20: 0.5102 - val_loss: 3.6697 - val_accuracy20: 0.4593 - 135s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 140s - loss: 2.9297 - accuracy20: 0.5113 - val_loss: 3.7240 - val_accuracy20: 0.4607 - 140s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 135s - loss: 2.9203 - accuracy20: 0.5128 - val_loss: 3.6573 - val_accuracy20: 0.4629 - 135s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 133s - loss: 2.9125 - accuracy20: 0.5143 - val_loss: 3.7657 - val_accuracy20: 0.4629 - 133s/epoch - 13ms/step
Epoch 10/50
9854/9854 - 137s - loss: 2.9062 - accuracy20: 0.5154 - val_loss: 3.7031 - val_accuracy20: 0.4640 - 137s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 136s - loss: 2.9004 - accuracy20: 0.5166 - val_loss: 3.7938 - val_accuracy20: 0.4636 - 136s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 118s - 118s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.994132
{'0': {'precision': 0.4829310203963303, 'recall': 0.1250459780547342, 'f1-score': 0.19865416597101915, 'support': 1465373}, '1': {'precision': 0.5295047951031417, 'recall': 0.9087733832660301, 'f1-score': 0.6691332335266169, 'support': 3140761}, '2': {'precision': 0.453379061252216, 'recall': 0.09336414014003631, 'f1-score': 0.15484178350465297, 'support': 1465477}, 'accuracy': 0.5228105028467733, 'macro avg': {'precision': 0.48860495891722927, 'recall': 0.3757278338202668, 'f1-score': 0.3408763943340964, 'support': 6071611}, 'weighted avg': {'precision': 0.49989017321282336, 'recall': 0.5228105028467733, 'f1-score': 0.4314517328565334, 'support': 6071611}}
[[ 183239 1246405   35729]
 [ 157288 2854240  129233]
 [  38904 1289750  136823]]
Evaluating performance on  train set...
9854/9854 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0350652
{'0': {'precision': 0.4664088900013833, 'recall': 0.1034739758698092, 'f1-score': 0.16937228725306452, 'support': 684288}, '1': {'precision': 0.463011684128395, 'recall': 0.9012181609157562, 'f1-score': 0.6117364166581398, 'support': 1154281}, '2': {'precision': 0.4723113054745708, 'recall': 0.08533386007652408, 'f1-score': 0.14455122842891222, 'support': 683445}, 'accuracy': 0.463671494289881, 'macro avg': {'precision': 0.4672439598681164, 'recall': 0.36334199895402985, 'f1-score': 0.30855331078003884, 'support': 2522014}, 'weighted avg': {'precision': 0.46645355515819603, 'recall': 0.463671494289881, 'f1-score': 0.36510818765082076, 'support': 2522014}}
[[  70806  598317   15165]
 [  64028 1040259   49994]
 [  16977  608147   58321]]
Evaluating performance on  val set...
3566/3566 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0407751
{'0': {'precision': 0.46890854808872284, 'recall': 0.10233114022815755, 'f1-score': 0.16799934377819703, 'support': 250178}, '1': {'precision': 0.45693214471348576, 'recall': 0.9008725075528701, 'f1-score': 0.6063281729112816, 'support': 413750}, '2': {'precision': 0.456016755521706, 'recall': 0.0771271349845625, 'f1-score': 0.131939112440908, 'support': 248421}, 'accuracy': 0.45760668340733646, 'macro avg': {'precision': 0.46061914944130483, 'recall': 0.3601102609218634, 'f1-score': 0.30208887637679555, 'support': 912349}, 'weighted avg': {'precision': 0.4599669819799254, 'recall': 0.45760668340733646, 'f1-score': 0.3569625961353247, 'support': 912349}}
[[ 25601 219385   5192]
 [ 23350 372736  17664]
 [  5646 223615  19160]]
testing model out of sample: results/universal/W4/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0235183
{'0': {'precision': 0.4680837671854909, 'recall': 0.06688002014481656, 'f1-score': 0.1170376482305635, 'support': 778364}, '1': {'precision': 0.4986047844713304, 'recall': 0.9492497873341659, 'f1-score': 0.6537956157198789, 'support': 1491777}, '2': {'precision': 0.4608941328753143, 'recall': 0.04863023502884511, 'f1-score': 0.08797769612996496, 'support': 761481}, 'accuracy': 0.4964857096300264, 'macro avg': {'precision': 0.4758608948440452, 'recall': 0.3549200141692758, 'f1-score': 0.28627032002680247, 'support': 3031622}, 'weighted avg': {'precision': 0.4812964241986245, 'recall': 0.4964857096300264, 'f1-score': 0.37386207722659026, 'support': 3031622}}
[[  52057  714587   11720]
 [  44113 1416069   31595]
 [  15043  709407   37031]]
Evaluating performance on  train set...
5528/5528 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97901005
{'0': {'precision': 0.4296870898304195, 'recall': 0.1045219295865035, 'f1-score': 0.1681428883267633, 'support': 313207}, '1': {'precision': 0.5701468530419896, 'recall': 0.9157801328533036, 'f1-score': 0.702765567596305, 'support': 788840}, '2': {'precision': 0.4267359404619813, 'recall': 0.09727757238200413, 'f1-score': 0.15843803764141598, 'support': 312405}, 'accuracy': 0.5553606626453212, 'macro avg': {'precision': 0.47552329444479685, 'recall': 0.3725265449406037, 'f1-score': 0.3431154978548281, 'support': 1414452}, 'weighted avg': {'precision': 0.507369701748935, 'recall': 0.5553606626453212, 'f1-score': 0.46415852578680394, 'support': 1414452}}
[[ 32737 271896   8574]
 [ 34185 722404  32251]
 [  9266 272749  30390]]
Evaluating performance on  val set...
1908/1908 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99187666
{'0': {'precision': 0.43609739909569833, 'recall': 0.09341401432354143, 'f1-score': 0.15386867082818023, 'support': 112542}, '1': {'precision': 0.5500888280357122, 'recall': 0.921524544668719, 'f1-score': 0.6889314356411088, 'support': 263764}, '2': {'precision': 0.406690384881948, 'recall': 0.07907716357167884, 'f1-score': 0.1324086888501113, 'support': 111309}, 'accuracy': 0.5380884509295243, 'macro avg': {'precision': 0.4642922040044528, 'recall': 0.3646719075213131, 'f1-score': 0.32506959843980016, 'support': 487615}, 'weighted avg': {'precision': 0.4910456060167641, 'recall': 0.5380884509295243, 'f1-score': 0.4383997167642577, 'support': 487615}}
[[ 10513  99179   2850]
 [ 10708 243065   9991]
 [  2886  99621   8802]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2471558
{'0': {'precision': 0.41166989039329466, 'recall': 0.02422184708180801, 'f1-score': 0.045751751070347346, 'support': 52721}, '1': {'precision': 0.23452153293046737, 'recall': 0.9637558154155664, 'f1-score': 0.3772440353877767, 'support': 31812}, '2': {'precision': 0.4350603264726757, 'recall': 0.02352399409022008, 'f1-score': 0.04463456812596705, 'support': 52117}, 'accuracy': 0.24267837541163556, 'macro avg': {'precision': 0.3604172499321459, 'recall': 0.3371672188625315, 'f1-score': 0.1558767848613637, 'support': 136650}, 'weighted avg': {'precision': 0.379350796427262, 'recall': 0.24267837541163556, 'f1-score': 0.12249678089247536, 'support': 136650}}
[[ 1277 50383  1061]
 [  622 30659   531]
 [ 1203 49688  1226]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1579131
{'0': {'precision': 0.42981186685962375, 'recall': 0.01427404238958043, 'f1-score': 0.027630477253698018, 'support': 20807}, '1': {'precision': 0.3538634350082268, 'recall': 0.9768528628204568, 'f1-score': 0.5195284826665117, 'support': 22897}, '2': {'precision': 0.3932367149758454, 'recall': 0.01917098445595855, 'f1-score': 0.03655962272625197, 'support': 21230}, 'accuracy': 0.3552992269073213, 'macro avg': {'precision': 0.3923040056145653, 'recall': 0.3367659632219986, 'f1-score': 0.19457286088215395, 'support': 64934}, 'weighted avg': {'precision': 0.39107281307279324, 'recall': 0.3552992269073213, 'f1-score': 0.20400270733839193, 'support': 64934}}
[[  297 20236   274]
 [  176 22367   354]
 [  218 20605   407]]
Evaluating performance on  val set...
81/81 - 1s - 603ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1753892
{'0': {'precision': 0.444, 'recall': 0.015959741193386053, 'f1-score': 0.030811936155447608, 'support': 6955}, '1': {'precision': 0.3289716825650502, 'recall': 0.9796252230814991, 'f1-score': 0.4925412195760272, 'support': 6724}, '2': {'precision': 0.478134110787172, 'recall': 0.02364134352025371, 'f1-score': 0.04505494505494505, 'support': 6937}, 'accuracy': 0.33284827318587507, 'macro avg': {'precision': 0.41703526445074074, 'recall': 0.3397421025983796, 'f1-score': 0.1894693669288066, 'support': 20616}, 'weighted avg': {'precision': 0.4179686612387471, 'recall': 0.33284827318587507, 'f1-score': 0.1861995697631208, 'support': 20616}}
[[ 111 6735  109]
 [  67 6587   70]
 [  72 6701  164]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
1613/1613 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8213318
{'0': {'precision': 0.38706542056074766, 'recall': 0.1115877053067207, 'f1-score': 0.1732336160886078, 'support': 46394}, '1': {'precision': 0.7916029887318952, 'recall': 0.9649064035090466, 'f1-score': 0.8697053329043982, 'support': 319403}, '2': {'precision': 0.41061039345232225, 'recall': 0.08850535623193334, 'f1-score': 0.14562240990400252, 'support': 47048}, 'accuracy': 0.7691385386767431, 'macro avg': {'precision': 0.5297596009149884, 'recall': 0.3883331550159002, 'f1-score': 0.39618711963233616, 'support': 412845}, 'weighted avg': {'precision': 0.7027244615353793, 'recall': 0.7691385386767431, 'f1-score': 0.7089215952031437, 'support': 412845}}
[[  5177  39499   1718]
 [  6950 308194   4259]
 [  1248  41636   4164]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84565485
{'0': {'precision': 0.4381636812184919, 'recall': 0.190070723990322, 'f1-score': 0.26513061820541944, 'support': 21492}, '1': {'precision': 0.7635942896773352, 'recall': 0.9343612149729026, 'f1-score': 0.840390559464341, 'support': 119015}, '2': {'precision': 0.4355641592920354, 'recall': 0.14530190506942203, 'f1-score': 0.2179101380097541, 'support': 21679}, 'accuracy': 0.7302603183998619, 'macro avg': {'precision': 0.5457740433959541, 'recall': 0.4232446146775488, 'f1-score': 0.4411437718931715, 'support': 162186}, 'weighted avg': {'precision': 0.6766230354777102, 'recall': 0.7302603183998619, 'f1-score': 0.6809548516088496, 'support': 162186}}
[[  4085  16678    729]
 [  4459 111203   3353]
 [   779  17750   3150]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8146805
{'0': {'precision': 0.39762219286657857, 'recall': 0.1654452180285819, 'f1-score': 0.23366541596584295, 'support': 5458}, '1': {'precision': 0.8128990661591897, 'recall': 0.9410362594500891, 'f1-score': 0.8722870055236288, 'support': 41534}, '2': {'precision': 0.3874631888935633, 'recall': 0.1605368659578177, 'f1-score': 0.2270150357406951, 'support': 5737}, 'accuracy': 0.7758349295454114, 'macro avg': {'precision': 0.5326614826397772, 'recall': 0.42233944781216287, 'f1-score': 0.44432248574338895, 'support': 52729}, 'weighted avg': {'precision': 0.7236254823191022, 'recall': 0.7758349295454114, 'f1-score': 0.735976399852156, 'support': 52729}}
[[  903  4345   210]
 [ 1203 39085  1246]
 [  165  4651   921]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0715455
{'0': {'precision': 0.47082309582309584, 'recall': 0.1253201809362908, 'f1-score': 0.19795119011750525, 'support': 73396}, '1': {'precision': 0.4363133070855561, 'recall': 0.9011267553516253, 'f1-score': 0.587949480164778, 'support': 108098}, '2': {'precision': 0.472473456547385, 'recall': 0.06724405703012411, 'f1-score': 0.11773207745918204, 'support': 71471}, 'accuracy': 0.4404324708951831, 'macro avg': {'precision': 0.4598699531520123, 'recall': 0.3645636644393467, 'f1-score': 0.30121091591382176, 'support': 252965}, 'weighted avg': {'precision': 0.45654251862219897, 'recall': 0.4404324708951831, 'f1-score': 0.34194223613860336, 'support': 252965}}
[[ 9198 62228  1970]
 [ 7292 97410  3396]
 [ 3046 63619  4806]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1334357
{'0': {'precision': 0.5103154305200341, 'recall': 0.10447500698129014, 'f1-score': 0.17344189146118855, 'support': 28648}, '1': {'precision': 0.3352137806173989, 'recall': 0.8855885207264661, 'f1-score': 0.486338329764454, 'support': 28852}, '2': {'precision': 0.47821203953279423, 'recall': 0.07331267217630855, 'f1-score': 0.12713483817030932, 'support': 29040}, 'accuracy': 0.3544372544488098, 'macro avg': {'precision': 0.4412470835567424, 'recall': 0.35445873329468824, 'f1-score': 0.2623050197986506, 'support': 86540}, 'weighted avg': {'precision': 0.44116457222028516, 'recall': 0.3544372544488098, 'f1-score': 0.2622208515993753, 'support': 86540}}
[[ 2993 24860   795]
 [ 1773 25551  1528]
 [ 1099 25812  2129]]
Evaluating performance on  val set...
124/124 - 1s - 813ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1568859
{'0': {'precision': 0.47107114933541827, 'recall': 0.11046938027136047, 'f1-score': 0.17896925590375762, 'support': 10908}, '1': {'precision': 0.29303922284712586, 'recall': 0.865961579969782, 'f1-score': 0.43789565597031216, 'support': 9266}, '2': {'precision': 0.5389447236180904, 'recall': 0.07554146856840993, 'f1-score': 0.13250965250965252, 'support': 11358}, 'accuracy': 0.31989724724089813, 'macro avg': {'precision': 0.43435169860021156, 'recall': 0.35065747626985083, 'f1-score': 0.24979152146124076, 'support': 31532}, 'weighted avg': {'precision': 0.4432030859668426, 'recall': 0.31989724724089813, 'f1-score': 0.23832241611137048, 'support': 31532}}
[[1205 9392  311]
 [ 819 8024  423]
 [ 534 9966  858]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0739324
{'0': {'precision': 0.5071992568509057, 'recall': 0.03068406929204659, 'f1-score': 0.0578673343666786, 'support': 71177}, '1': {'precision': 0.43636833031408895, 'recall': 0.9758496178798939, 'f1-score': 0.6030653681132777, 'support': 102193}, '2': {'precision': 0.4722077922077922, 'recall': 0.028711307643714466, 'f1-score': 0.054131308619919605, 'support': 63320}, 'accuracy': 0.4382398918416494, 'macro avg': {'precision': 0.47192512645759566, 'recall': 0.3450816649385516, 'f1-score': 0.23835467036662528, 'support': 236690}, 'weighted avg': {'precision': 0.4672563593192024, 'recall': 0.4382398918416494, 'f1-score': 0.2922619328388634, 'support': 236690}}
[[ 2184 68125   868]
 [ 1304 99725  1164]
 [  818 60684  1818]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.150191
{'0': {'precision': 0.417995444191344, 'recall': 0.024644104217029277, 'f1-score': 0.04654407102092581, 'support': 29784}, '1': {'precision': 0.33097410398848537, 'recall': 0.9497866530124595, 'f1-score': 0.4908875990190716, 'support': 29295}, '2': {'precision': 0.4450109249817917, 'recall': 0.04143777551712445, 'f1-score': 0.07581585804690408, 'support': 29490}, 'accuracy': 0.3362350257990945, 'macro avg': {'precision': 0.39799349105387366, 'recall': 0.338622844248871, 'f1-score': 0.20441584269563381, 'support': 88569}, 'weighted avg': {'precision': 0.39820744124750984, 'recall': 0.3362350257990945, 'f1-score': 0.2032610786884142, 'support': 88569}}
[[  734 28324   726]
 [  673 27824   798]
 [  349 27919  1222]]
Evaluating performance on  val set...
127/127 - 1s - 815ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1374359
{'0': {'precision': 0.48542274052478135, 'recall': 0.030606617647058822, 'f1-score': 0.05758256960055335, 'support': 10880}, '1': {'precision': 0.3426022401667101, 'recall': 0.9555898646807738, 'f1-score': 0.5043740862354098, 'support': 11011}, '2': {'precision': 0.44839449541284404, 'recall': 0.03767222275749109, 'f1-score': 0.0695049328948538, 'support': 10379}, 'accuracy': 0.34849705608924697, 'macro avg': {'precision': 0.42547315870144514, 'recall': 0.34128956836177454, 'f1-score': 0.21048719624360565, 'support': 32270}, 'weighted avg': {'precision': 0.42478088476216835, 'recall': 0.34849705608924697, 'f1-score': 0.21386901516293166, 'support': 32270}}
[[  333 10329   218]
 [  226 10522   263]
 [  127  9861   391]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0971923
{'0': {'precision': 0.45509067542481796, 'recall': 0.07629451710462268, 'f1-score': 0.13068080860544265, 'support': 125317}, '1': {'precision': 0.39972681394721127, 'recall': 0.9100857862915741, 'f1-score': 0.5554774655651559, 'support': 161098}, '2': {'precision': 0.4422626178446794, 'recall': 0.07042031581740976, 'f1-score': 0.12149526023967089, 'support': 120576}, 'accuracy': 0.40459125631770726, 'macro avg': {'precision': 0.43236003573890286, 'recall': 0.3522668730712022, 'f1-score': 0.2692178448034231, 'support': 406991}, 'weighted avg': {'precision': 0.42937570082561977, 'recall': 0.40459125631770726, 'f1-score': 0.2961054375607379, 'support': 406991}}
[[  9561 112187   3569]
 [  7346 146613   7139]
 [  4102 107983   8491]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1405536
{'0': {'precision': 0.4764391071661663, 'recall': 0.0794462703785125, 'f1-score': 0.13618386687560627, 'support': 45943}, '1': {'precision': 0.3318445626094287, 'recall': 0.8994617159178293, 'f1-score': 0.48482085230603433, 'support': 45515}, '2': {'precision': 0.47228080747213014, 'recall': 0.06784392650782316, 'f1-score': 0.11864438851779666, 'support': 46209}, 'accuracy': 0.34666259887990586, 'macro avg': {'precision': 0.4268548257492417, 'recall': 0.34891730426805495, 'f1-score': 0.2465497025664791, 'support': 137667}, 'weighted avg': {'precision': 0.42723798005464625, 'recall': 0.34666259887990586, 'f1-score': 0.24556179068036638, 'support': 137667}}
[[ 3650 40944  1349]
 [ 2422 40939  2154]
 [ 1589 41485  3135]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1229459
{'0': {'precision': 0.5190782017378164, 'recall': 0.07974463145676146, 'f1-score': 0.1382502389696634, 'support': 17230}, '1': {'precision': 0.3603189455270331, 'recall': 0.9306504150467584, 'f1-score': 0.5195026101237609, 'support': 19034}, '2': {'precision': 0.4643281807372176, 'recall': 0.04533581006559471, 'f1-score': 0.08260616637579989, 'support': 17227}, 'accuracy': 0.3714456637565198, 'macro avg': {'precision': 0.44790844266735563, 'recall': 0.3519102855230382, 'f1-score': 0.24678633848974138, 'support': 53491}, 'weighted avg': {'precision': 0.444953539748073, 'recall': 0.3714456637565198, 'f1-score': 0.2559929843655731, 'support': 53491}}
[[ 1374 15484   372]
 [  791 17714   529]
 [  482 15964   781]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/EXC
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.890921
{'0': {'precision': 0.3967957445461166, 'recall': 0.16221498792966196, 'f1-score': 0.23028615793124674, 'support': 154511}, '1': {'precision': 0.6937307877041307, 'recall': 0.8885886283098731, 'f1-score': 0.7791616317458947, 'support': 650176}, '2': {'precision': 0.41147786946736686, 'recall': 0.18142115998309455, 'f1-score': 0.2518162070709861, 'support': 163261}, 'accuracy': 0.6533636104418833, 'macro avg': {'precision': 0.5006681339058714, 'recall': 0.4107415920742099, 'f1-score': 0.4204213322493759, 'support': 967948}, 'weighted avg': {'precision': 0.5987250393192585, 'recall': 0.6533636104418833, 'f1-score': 0.6026002465140172, 'support': 967948}}
[[ 25064 125459   3988]
 [ 34062 577739  38375]
 [  4040 129602  29619]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9349877
{'0': {'precision': 0.37241246355158203, 'recall': 0.19759116248146064, 'f1-score': 0.25819278416827474, 'support': 78212}, '1': {'precision': 0.6408288061698558, 'recall': 0.8471784487377478, 'f1-score': 0.7296958427143584, 'support': 253832}, '2': {'precision': 0.41029798690570884, 'recall': 0.17258641546341338, 'f1-score': 0.24297050510906587, 'support': 77706}, 'accuracy': 0.5952556436851739, 'macro avg': {'precision': 0.47451308554238225, 'recall': 0.4057853422275406, 'f1-score': 0.41028637733056633, 'support': 409750}, 'weighted avg': {'precision': 0.5458757693654622, 'recall': 0.5952556436851739, 'f1-score': 0.5473927889035881, 'support': 409750}}
[[ 15454  59971   2787]
 [ 22303 215041  16488]
 [  3740  60555  13411]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9049589
{'0': {'precision': 0.3688747731397459, 'recall': 0.21293871136720796, 'f1-score': 0.27000996346728656, 'support': 22908}, '1': {'precision': 0.6897161859373333, 'recall': 0.8564756541901292, 'f1-score': 0.7641032713088189, 'support': 90570}, '2': {'precision': 0.3942289317790942, 'recall': 0.18192239858906525, 'f1-score': 0.24895915042539066, 'support': 22680}, 'accuracy': 0.6358421833458189, 'macro avg': {'precision': 0.4842732969520578, 'recall': 0.4171122547154675, 'f1-score': 0.4276907950671654, 'support': 136158}, 'weighted avg': {'precision': 0.5865163298240238, 'recall': 0.6358421833458189, 'f1-score': 0.5951660207787731, 'support': 136158}}
[[ 4878 17287   743]
 [ 7402 77571  5597]
 [  944 17610  4126]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/AAL
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94215167
{'0': {'precision': 0.45150594566443886, 'recall': 0.11353477327093991, 'f1-score': 0.18144400378110076, 'support': 229084}, '1': {'precision': 0.6155249971066503, 'recall': 0.9365887451935812, 'f1-score': 0.7428499200336142, 'support': 687102}, '2': {'precision': 0.4360220877698222, 'recall': 0.0734220466345448, 'f1-score': 0.12568064641418333, 'support': 224769}, 'accuracy': 0.601289270830138, 'macro avg': {'precision': 0.5010176768469704, 'recall': 0.3745151883663553, 'f1-score': 0.34999152340963274, 'support': 1140955}, 'weighted avg': {'precision': 0.5472306035422091, 'recall': 0.601289270830138, 'f1-score': 0.5085465221073536, 'support': 1140955}}
[[ 26009 199119   3956]
 [ 26180 643532  17390]
 [  5416 202850  16503]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9058335
{'0': {'precision': 0.3891983172364757, 'recall': 0.12520371694067192, 'f1-score': 0.18945911060795076, 'support': 104925}, '1': {'precision': 0.6817196401691119, 'recall': 0.9167663481701381, 'f1-score': 0.7819619684536853, 'support': 412982}, '2': {'precision': 0.3829726651480638, 'recall': 0.11772199908584322, 'f1-score': 0.18008703090712985, 'support': 102827}, 'accuracy': 0.6506007404137683, 'macro avg': {'precision': 0.4846302075178838, 'recall': 0.3865640213988844, 'f1-score': 0.38383603665625526, 'support': 620734}, 'weighted avg': {'precision': 0.5827850643134375, 'recall': 0.6506007404137683, 'f1-score': 0.5821060614749096, 'support': 620734}}
[[ 13137  88865   2923]
 [ 17794 378608  16580]
 [  2823  87899  12105]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91696066
{'0': {'precision': 0.3940353385762435, 'recall': 0.10903233099706082, 'f1-score': 0.17080243497509687, 'support': 35384}, '1': {'precision': 0.6665622527037721, 'recall': 0.9239822658297275, 'f1-score': 0.7744413229472609, 'support': 131272}, '2': {'precision': 0.3683821198351474, 'recall': 0.10085054678007291, 'f1-score': 0.15835017829158055, 'support': 34566}, 'accuracy': 0.6392790052777529, 'macro avg': {'precision': 0.476326570371721, 'recall': 0.37795504786895373, 'f1-score': 0.3678646454046461, 'support': 201222}, 'weighted avg': {'precision': 0.5674180895296392, 'recall': 0.6392790052777529, 'f1-score': 0.5624616938899247, 'support': 201222}}
[[  3858  30431   1095]
 [  5097 121293   4882]
 [   836  30244   3486]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/WBA
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9436742
{'0': {'precision': 0.4901115241635688, 'recall': 0.15853203948871494, 'f1-score': 0.23957188155874368, 'support': 249489}, '1': {'precision': 0.6043709482662647, 'recall': 0.9131499913020601, 'f1-score': 0.7273459123530066, 'support': 695567}, '2': {'precision': 0.4885838459890429, 'recall': 0.126730150161355, 'f1-score': 0.201257584114727, 'support': 251929}, 'accuracy': 0.5903465791133556, 'macro avg': {'precision': 0.5276887728062921, 'recall': 0.39947072698404335, 'f1-score': 0.3893917926754924, 'support': 1196985}, 'weighted avg': {'precision': 0.5561860517558191, 'recall': 0.5903465791133556, 'f1-score': 0.514952973750124, 'support': 1196985}}
[[ 39552 202972   6965]
 [ 33956 635157  26454]
 [  7192 212810  31927]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9470352
{'0': {'precision': 0.45845670588841114, 'recall': 0.15658719759394266, 'f1-score': 0.23344171167864072, 'support': 113713}, '1': {'precision': 0.6020016090104585, 'recall': 0.8973798917162621, 'f1-score': 0.7205959770011633, 'support': 312697}, '2': {'precision': 0.4737392213221845, 'recall': 0.14440206377160456, 'f1-score': 0.22133749321758003, 'support': 112997}, 'accuracy': 0.5834759281952218, 'macro avg': {'precision': 0.5113991787403515, 'recall': 0.3994563843606031, 'f1-score': 0.39179172729912803, 'support': 539407}, 'weighted avg': {'precision': 0.544871859877931, 'recall': 0.5834759281952218, 'f1-score': 0.5133118967709965, 'support': 539407}}
[[ 17806  92491   3416]
 [ 17379 280608  14710]
 [  3654  93026  16317]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9706347
{'0': {'precision': 0.4617786660004996, 'recall': 0.15881607491891658, 'f1-score': 0.23634707283159392, 'support': 46557}, '1': {'precision': 0.5651690416958052, 'recall': 0.8838885502205328, 'f1-score': 0.6894776959601681, 'support': 111548}, '2': {'precision': 0.46900269541778977, 'recall': 0.1396892900538101, 'f1-score': 0.21526372983365374, 'support': 46088}, 'accuracy': 0.5505967393593316, 'macro avg': {'precision': 0.4986501343713648, 'recall': 0.3941313050644198, 'f1-score': 0.38036283287513856, 'support': 204193}, 'weighted avg': {'precision': 0.5198900150469606, 'recall': 0.5505967393593316, 'f1-score': 0.4791278030067572, 'support': 204193}}
[[ 7394 37658  1505]
 [ 7168 98596  5784]
 [ 1450 38200  6438]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
4274/4274 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.042016
{'0': {'precision': 0.6006321370309952, 'recall': 0.019778677571630977, 'f1-score': 0.038296267885351724, 'support': 297846}, '1': {'precision': 0.46374725583699067, 'recall': 0.9889669166334105, 'f1-score': 0.6314121558026703, 'support': 503667}, '2': {'precision': 0.5972427375677006, 'recall': 0.020731640619658997, 'f1-score': 0.04007228207186582, 'support': 292548}, 'accuracy': 0.46621349266631384, 'macro avg': {'precision': 0.5538740434785622, 'recall': 0.3431590782749001, 'f1-score': 0.23659356858662928, 'support': 1094061}, 'weighted avg': {'precision': 0.5367088644798956, 'recall': 0.46621349266631384, 'f1-score': 0.31182075081444655, 'support': 1094061}}
[[  5891 290828   1127]
 [  2594 498110   2963]
 [  1323 285160   6065]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97562337
{'0': {'precision': 0.44308336883965344, 'recall': 0.11054711030792672, 'f1-score': 0.17694685497135726, 'support': 112884}, '1': {'precision': 0.567501152923301, 'recall': 0.9143341206199703, 'f1-score': 0.7003284060963388, 'support': 278594}, '2': {'precision': 0.45499745953400594, 'recall': 0.11084978647026057, 'f1-score': 0.17826850475994113, 'support': 113099}, 'accuracy': 0.5544129042742733, 'macro avg': {'precision': 0.4885273270989868, 'recall': 0.37857700579938586, 'f1-score': 0.3518479219425457, 'support': 504577}, 'weighted avg': {'precision': 0.5144491264592839, 'recall': 0.5544129042742733, 'f1-score': 0.46621972536289746, 'support': 504577}}
[[ 12479  97152   3253]
 [ 12102 254728  11764]
 [  3583  96979  12537]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98695344
{'0': {'precision': 0.44507683551508254, 'recall': 0.09295138476167836, 'f1-score': 0.1537856440511308, 'support': 42065}, '1': {'precision': 0.5472534741148586, 'recall': 0.9167624245906348, 'f1-score': 0.685377012966592, 'support': 97468}, '2': {'precision': 0.4016110471806674, 'recall': 0.08466558307658717, 'f1-score': 0.13984893109735327, 'support': 41221}, 'accuracy': 0.5352855261847594, 'macro avg': {'precision': 0.4646471189368695, 'recall': 0.3647931308096335, 'f1-score': 0.3263371960383587, 'support': 180754}, 'weighted avg': {'precision': 0.4902611708554349, 'recall': 0.5352855261847594, 'f1-score': 0.4372574471690951, 'support': 180754}}
[[ 3910 37156   999]
 [ 3912 89355  4201]
 [  963 36768  3490]]
testing model on single stock: results/universal/W4/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
12724/12724 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0594286
{'0': {'precision': 0.5107738747872521, 'recall': 0.11796859934604928, 'f1-score': 0.19166918434854013, 'support': 943802}, '1': {'precision': 0.4270149880538034, 'recall': 0.898031340694994, 'f1-score': 0.5788066936209183, 'support': 1373422}, '2': {'precision': 0.4613282933784277, 'recall': 0.07401276067405808, 'f1-score': 0.12756047873227996, 'support': 939919}, 'accuracy': 0.4342090599031114, 'macro avg': {'precision': 0.46637238540649445, 'recall': 0.3633375669050338, 'f1-score': 0.2993454522339128, 'support': 3257143}, 'weighted avg': {'precision': 0.4611871237089521, 'recall': 0.4342090599031114, 'f1-score': 0.3364114267940694, 'support': 3257143}}
[[ 111339  810239   22224]
 [  81041 1233376   59005]
 [  25601  844752   69566]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1174388
{'0': {'precision': 0.5428764794242419, 'recall': 0.07456125435571667, 'f1-score': 0.13111460168876626, 'support': 441087}, '1': {'precision': 0.3338399206136316, 'recall': 0.9232685997241957, 'f1-score': 0.49036962370464904, 'support': 439442}, '2': {'precision': 0.5216130219268815, 'recall': 0.054573083046291326, 'f1-score': 0.0988084596901831, 'support': 441573}, 'accuracy': 0.34997980488646113, 'macro avg': {'precision': 0.466109807321585, 'recall': 0.3508009790420679, 'f1-score': 0.2400975616945328, 'support': 1322102}, 'weighted avg': {'precision': 0.4662947843702036, 'recall': 0.34997980488646113, 'f1-score': 0.23973422811998196, 'support': 1322102}}
[[ 32888 400679   7520]
 [ 19138 405723  14581]
 [  8555 408920  24098]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1264561
{'0': {'precision': 0.5393711248892825, 'recall': 0.07409277566539924, 'f1-score': 0.13028803722820997, 'support': 164375}, '1': {'precision': 0.32656915945584397, 'recall': 0.9237838415458208, 'f1-score': 0.48255062756010864, 'support': 159087}, '2': {'precision': 0.5037150197902923, 'recall': 0.044356934516347986, 'f1-score': 0.08153401746675808, 'support': 163537}, 'accuracy': 0.341674212883394, 'macro avg': {'precision': 0.45655176804513964, 'recall': 0.34741118390918935, 'f1-score': 0.23145756075169222, 'support': 486999}, 'weighted avg': {'precision': 0.4578820073870228, 'recall': 0.341674212883394, 'f1-score': 0.22898908708334767, 'support': 486999}}
[[ 12179 149779   2417]
 [  7395 146962   4730]
 [  3006 153277   7254]]
training model: results/universal/W4/deepOF_L1/h30
Epoch 1/50
9854/9854 - 139s - loss: 3.0863 - accuracy30: 0.4758 - val_loss: 3.2662 - val_accuracy30: 0.4381 - 139s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 134s - loss: 3.0621 - accuracy30: 0.4793 - val_loss: 3.3090 - val_accuracy30: 0.4402 - 134s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 136s - loss: 3.0415 - accuracy30: 0.4830 - val_loss: 3.3935 - val_accuracy30: 0.4404 - 136s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 135s - loss: 3.0246 - accuracy30: 0.4867 - val_loss: 3.5363 - val_accuracy30: 0.4384 - 135s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 141s - loss: 3.0121 - accuracy30: 0.4894 - val_loss: 3.5834 - val_accuracy30: 0.4371 - 141s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 134s - loss: 3.0015 - accuracy30: 0.4917 - val_loss: 3.6522 - val_accuracy30: 0.4389 - 134s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 133s - loss: 2.9915 - accuracy30: 0.4935 - val_loss: 3.6211 - val_accuracy30: 0.4402 - 133s/epoch - 13ms/step
Epoch 8/50
9854/9854 - 134s - loss: 2.9830 - accuracy30: 0.4955 - val_loss: 3.6185 - val_accuracy30: 0.4405 - 134s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 132s - loss: 2.9758 - accuracy30: 0.4973 - val_loss: 3.7086 - val_accuracy30: 0.4397 - 132s/epoch - 13ms/step
Epoch 10/50
9854/9854 - 134s - loss: 2.9697 - accuracy30: 0.4987 - val_loss: 3.6529 - val_accuracy30: 0.4411 - 134s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 134s - loss: 2.9645 - accuracy30: 0.5002 - val_loss: 3.6972 - val_accuracy30: 0.4426 - 134s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 119s - 119s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.019655
{'0': {'precision': 0.4790559696170031, 'recall': 0.13732313829617315, 'f1-score': 0.21345781621329596, 'support': 1565206}, '1': {'precision': 0.49600976460779916, 'recall': 0.8928308859209457, 'f1-score': 0.6377302354904758, 'support': 2936639}, '2': {'precision': 0.4615654032234128, 'recall': 0.0990631724728399, 'f1-score': 0.16311738334148013, 'support': 1569766}, 'accuracy': 0.4928456384969327, 'macro avg': {'precision': 0.47887704581607166, 'recall': 0.3764057322299863, 'f1-score': 0.33810181168175063, 'support': 6071611}, 'weighted avg': {'precision': 0.48273391919621295, 'recall': 0.4928456384969327, 'f1-score': 0.40564935040846417, 'support': 6071611}}
[[ 214939 1303251   47016]
 [ 180329 2621922  134388]
 [  53404 1360856  155506]]
Evaluating performance on  train set...
9854/9854 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0497608
{'0': {'precision': 0.47532856486497216, 'recall': 0.11565645482512618, 'f1-score': 0.1860447045450509, 'support': 724551}, '1': {'precision': 0.43169359170951677, 'recall': 0.8847740228771563, 'f1-score': 0.5802668771415812, 'support': 1073560}, '2': {'precision': 0.48118092854048183, 'recall': 0.09665521485613404, 'f1-score': 0.1609752057369374, 'support': 723903}, 'accuracy': 0.4375970950200911, 'macro avg': {'precision': 0.4627343617049902, 'recall': 0.3656952308528056, 'f1-score': 0.3090955958078565, 'support': 2522014}, 'weighted avg': {'precision': 0.4584340439943591, 'recall': 0.4375970950200911, 'f1-score': 0.3466597012171714, 'support': 2522014}}
[[ 83799 619892  20860]
 [ 69120 949858  54582]
 [ 23378 630556  69969]]
Evaluating performance on  val set...
3566/3566 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0497115
{'0': {'precision': 0.4775847327751698, 'recall': 0.11320357907617008, 'f1-score': 0.18302427444058744, 'support': 261520}, '1': {'precision': 0.4334514280715567, 'recall': 0.8862978379801046, 'f1-score': 0.582181893866151, 'support': 391347}, '2': {'precision': 0.4671717675206859, 'recall': 0.09029913442936312, 'f1-score': 0.15134496200389488, 'support': 259482}, 'accuracy': 0.43830376314327085, 'macro avg': {'precision': 0.4594026427891375, 'recall': 0.3632668504952126, 'f1-score': 0.3055170434368778, 'support': 912349}, 'weighted avg': {'precision': 0.4556924377805911, 'recall': 0.43830376314327085, 'f1-score': 0.34523076070805553, 'support': 912349}}
[[ 29605 224713   7202]
 [ 24975 346850  19522]
 [  7409 228642  23431]]
testing model out of sample: results/universal/W4/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0579927
{'0': {'precision': 0.4717342904455167, 'recall': 0.06860224891028441, 'f1-score': 0.11978472990644806, 'support': 867887}, '1': {'precision': 0.4396867307071721, 'recall': 0.9395456726072317, 'f1-score': 0.5990372096044426, 'support': 1315307}, '2': {'precision': 0.47397459701240613, 'recall': 0.052955583738396185, 'f1-score': 0.0952672759271432, 'support': 848428}, 'accuracy': 0.4420930445814155, 'macro avg': {'precision': 0.46179853938836496, 'recall': 0.35370116841863736, 'f1-score': 0.271363071812678, 'support': 3031622}, 'weighted avg': {'precision': 0.4584570280306015, 'recall': 0.4420930445814155, 'f1-score': 0.32085295241881157, 'support': 3031622}}
[[  59539  791355   16993]
 [  46646 1235791   32870]
 [  20028  783471   44929]]
Evaluating performance on  train set...
5528/5528 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0180098
{'0': {'precision': 0.4329260089686099, 'recall': 0.11031537450722734, 'f1-score': 0.17582752811546692, 'support': 350060}, '1': {'precision': 0.5166731303625973, 'recall': 0.9028670803835469, 'f1-score': 0.6572369802443415, 'support': 714176}, '2': {'precision': 0.44459977218597907, 'recall': 0.09807661557438838, 'f1-score': 0.16070292323239885, 'support': 350216}, 'accuracy': 0.5074551840571472, 'macro avg': {'precision': 0.46473297050572876, 'recall': 0.3704196901550542, 'f1-score': 0.3312558105307358, 'support': 1414452}, 'weighted avg': {'precision': 0.47810147114591, 'recall': 0.5074551840571472, 'f1-score': 0.4151528627750118, 'support': 1414452}}
[[ 38617 300247  11196]
 [ 37658 644806  31712]
 [ 12925 302943  34348]]
Evaluating performance on  val set...
1908/1908 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0297966
{'0': {'precision': 0.43358992302309307, 'recall': 0.09870564339479868, 'f1-score': 0.1608045417680454, 'support': 125545}, '1': {'precision': 0.4956951351003396, 'recall': 0.9082423114024187, 'f1-score': 0.6413552062108661, 'support': 237397}, '2': {'precision': 0.43171806167400884, 'recall': 0.0833219702742374, 'f1-score': 0.13968467408478166, 'support': 124673}, 'accuracy': 0.488898003547881, 'macro avg': {'precision': 0.4536677065991472, 'recall': 0.3634233083571516, 'f1-score': 0.3139481406878977, 'support': 487615}, 'weighted avg': {'precision': 0.46334745808974953, 'recall': 0.488898003547881, 'f1-score': 0.3893623359767075, 'support': 487615}}
[[ 12392 109274   3879]
 [ 11988 215614   9795]
 [  4200 110085  10388]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1946009
{'0': {'precision': 0.4207383279044517, 'recall': 0.029772766562301916, 'f1-score': 0.05561036864292762, 'support': 52061}, '1': {'precision': 0.244113444333996, 'recall': 0.9473208365981556, 'f1-score': 0.3881938870021611, 'support': 33182}, '2': {'precision': 0.4168651738923297, 'recall': 0.034042056529266444, 'f1-score': 0.06294397985792645, 'support': 51407}, 'accuracy': 0.2541822173435785, 'macro avg': {'precision': 0.3605723153769258, 'recall': 0.3370452198965746, 'f1-score': 0.16891607850100507, 'support': 136650}, 'weighted avg': {'precision': 0.3763923775573166, 'recall': 0.2541822173435785, 'f1-score': 0.13912873862408773, 'support': 136650}}
[[ 1550 49076  1435]
 [  735 31434  1013]
 [ 1399 48258  1750]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1403692
{'0': {'precision': 0.43125, 'recall': 0.022588037225833607, 'f1-score': 0.042927609652046395, 'support': 21383}, '1': {'precision': 0.33559832689626434, 'recall': 0.9665820447726748, 'f1-score': 0.49821564522268746, 'support': 21665}, '2': {'precision': 0.42473498233215545, 'recall': 0.027460477017271313, 'f1-score': 0.05158576885112227, 'support': 21886}, 'accuracy': 0.3391905627252287, 'macro avg': {'precision': 0.3971944364094733, 'recall': 0.33887685300525994, 'f1-score': 0.19757634124195209, 'support': 64934}, 'weighted avg': {'precision': 0.39714027051358486, 'recall': 0.3391905627252287, 'f1-score': 0.19775108830527757, 'support': 64934}}
[[  483 20531   369]
 [  279 20941   445]
 [  358 20927   601]]
Evaluating performance on  val set...
81/81 - 1s - 587ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1539395
{'0': {'precision': 0.4527363184079602, 'recall': 0.025362318840579712, 'f1-score': 0.04803378200052785, 'support': 7176}, '1': {'precision': 0.3079653196775338, 'recall': 0.9653528289891926, 'f1-score': 0.4669613684412839, 'support': 6292}, '2': {'precision': 0.4684317718940937, 'recall': 0.032176832680470065, 'f1-score': 0.06021730593009556, 'support': 7148}, 'accuracy': 0.31461001164144353, 'macro avg': {'precision': 0.40971113665986253, 'recall': 0.3409639935034141, 'f1-score': 0.19173748545730243, 'support': 20616}, 'weighted avg': {'precision': 0.4139941752913051, 'recall': 0.31461001164144353, 'f1-score': 0.18011469987663314, 'support': 20616}}
[[ 182 6848  146]
 [ 103 6074  115]
 [ 117 6801  230]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
1613/1613 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8912695
{'0': {'precision': 0.41989679587183487, 'recall': 0.1256531341461225, 'f1-score': 0.19342445307425477, 'support': 55693}, '1': {'precision': 0.7475655391589783, 'recall': 0.9527441916191579, 'f1-score': 0.8377752739936496, 'support': 300471}, '2': {'precision': 0.4552114803625378, 'recall': 0.106331927806496, 'f1-score': 0.17239455957437677, 'support': 56681}, 'accuracy': 0.7249621528660878, 'macro avg': {'precision': 0.5408912717977836, 'recall': 0.39490975119059213, 'f1-score': 0.401198095547427, 'support': 412845}, 'weighted avg': {'precision': 0.6632245014171335, 'recall': 0.7249621528660878, 'f1-score': 0.6594994694096953, 'support': 412845}}
[[  6998  47057   1638]
 [  8624 286272   5575]
 [  1044  49610   6027]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9127898
{'0': {'precision': 0.436885093744199, 'recall': 0.1833300876338851, 'f1-score': 0.2582786907734094, 'support': 25675}, '1': {'precision': 0.7103431457934157, 'recall': 0.9218166529534625, 'f1-score': 0.8023799405014875, 'support': 110599}, '2': {'precision': 0.4729301382021047, 'recall': 0.14394874961407841, 'f1-score': 0.2207165892482026, 'support': 25912}, 'accuracy': 0.680632113745946, 'macro avg': {'precision': 0.5400527925799065, 'recall': 0.4163651634004753, 'f1-score': 0.42712507350769985, 'support': 162186}, 'weighted avg': {'precision': 0.6291223169976523, 'recall': 0.680632113745946, 'f1-score': 0.6233147909544025, 'support': 162186}}
[[  4707  20231    737]
 [  5227 101952   3420]
 [   840  21342   3730]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88656783
{'0': {'precision': 0.3866799204771372, 'recall': 0.176497277676951, 'f1-score': 0.24236760124610593, 'support': 6612}, '1': {'precision': 0.76815897185757, 'recall': 0.9237930067076436, 'f1-score': 0.8388179986568165, 'support': 39209}, '2': {'precision': 0.40695856137607506, 'recall': 0.15069484655471915, 'f1-score': 0.21994506655398266, 'support': 6908}, 'accuracy': 0.7288019875210985, 'macro avg': {'precision': 0.5205991512369275, 'recall': 0.41699504364643797, 'f1-score': 0.4337102221523017, 'support': 52729}, 'weighted avg': {'precision': 0.673002380165454, 'recall': 0.7288019875210985, 'f1-score': 0.6829473346456273, 'support': 52729}}
[[ 1167  5237   208]
 [ 1679 36221  1309]
 [  172  5695  1041]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0803947
{'0': {'precision': 0.46656918782400636, 'recall': 0.13579737432617162, 'f1-score': 0.21036649319255626, 'support': 77542}, '1': {'precision': 0.4046855995967388, 'recall': 0.8724887085356491, 'f1-score': 0.5529137470224368, 'support': 100297}, '2': {'precision': 0.4645808319796596, 'recall': 0.08755956659478742, 'f1-score': 0.14734837878703028, 'support': 75126}, 'accuracy': 0.4135591880299646, 'macro avg': {'precision': 0.4452785398001349, 'recall': 0.3652818831522027, 'f1-score': 0.30354287300067445, 'support': 252965}, 'weighted avg': {'precision': 0.44144272578541344, 'recall': 0.4135591880299646, 'f1-score': 0.32746634121321516, 'support': 252965}}
[[10530 64157  2855]
 [ 8063 87508  4726]
 [ 3976 64572  6578]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1176363
{'0': {'precision': 0.4936784173731965, 'recall': 0.11427095885694612, 'f1-score': 0.18558488033996867, 'support': 29045}, '1': {'precision': 0.32488792557989254, 'recall': 0.8580012088029295, 'f1-score': 0.4713108350910085, 'support': 28127}, '2': {'precision': 0.4613439306358382, 'recall': 0.08696540452192864, 'f1-score': 0.14634425853770341, 'support': 29368}, 'accuracy': 0.3467298359140282, 'macro avg': {'precision': 0.4266367578629757, 'recall': 0.3530791907272681, 'f1-score': 0.26774665798956016, 'support': 86540}, 'weighted avg': {'precision': 0.42784563057896263, 'recall': 0.3467298359140282, 'f1-score': 0.2651341679317594, 'support': 86540}}
[[ 3319 24646  1080]
 [ 2092 24133  1902]
 [ 1312 25502  2554]]
Evaluating performance on  val set...
124/124 - 1s - 973ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1300584
{'0': {'precision': 0.44267839026039907, 'recall': 0.12133852428624398, 'f1-score': 0.1904692615496544, 'support': 10788}, '1': {'precision': 0.2942173029139372, 'recall': 0.8236720067453626, 'f1-score': 0.4335644937586685, 'support': 9488}, '2': {'precision': 0.5042225534028812, 'recall': 0.09017412935323384, 'f1-score': 0.15298816791016656, 'support': 11256}, 'accuracy': 0.321546365596854, 'macro avg': {'precision': 0.41370608219240584, 'recall': 0.3450615534616135, 'f1-score': 0.2590073077394965, 'support': 31532}, 'weighted avg': {'precision': 0.41997581204108375, 'recall': 0.321546365596854, 'f1-score': 0.2502371282626143, 'support': 31532}}
[[1309 9071  408]
 [1083 7815  590]
 [ 565 9676 1015]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0693381
{'0': {'precision': 0.4505788067675868, 'recall': 0.077830914226585, 'f1-score': 0.13273397164558168, 'support': 71514}, '1': {'precision': 0.43097242206786224, 'recall': 0.9342574691567177, 'f1-score': 0.5898482107746756, 'support': 100346}, '2': {'precision': 0.44932432432432434, 'recall': 0.047184945241400586, 'f1-score': 0.0854016025014657, 'support': 64830}, 'accuracy': 0.4325235540158013, 'macro avg': {'precision': 0.4436251843865911, 'recall': 0.3530911095415678, 'f1-score': 0.269327928307241, 'support': 236690}, 'weighted avg': {'precision': 0.44192296843104845, 'recall': 0.4325235540158013, 'f1-score': 0.3135655570443524, 'support': 236690}}
[[ 5566 64560  1388]
 [ 4236 93749  2361]
 [ 2551 59220  3059]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1218905
{'0': {'precision': 0.39579929988331386, 'recall': 0.056514495168277244, 'f1-score': 0.09890654614375274, 'support': 30010}, '1': {'precision': 0.3285416007592534, 'recall': 0.8850519856826317, 'f1-score': 0.47919896640826876, 'support': 29335}, '2': {'precision': 0.4318311466058186, 'recall': 0.07771010128661374, 'f1-score': 0.13171707798045412, 'support': 29224}, 'accuracy': 0.33792862062346873, 'macro avg': {'precision': 0.3853906824161286, 'recall': 0.33975886071250755, 'f1-score': 0.23660753017749184, 'support': 88569}, 'weighted avg': {'precision': 0.3854118063451026, 'recall': 0.33792862062346873, 'f1-score': 0.23568954167102907, 'support': 88569}}
[[ 1696 26962  1352]
 [ 1736 25963  1636]
 [  853 26100  2271]]
Evaluating performance on  val set...
127/127 - 1s - 831ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1107891
{'0': {'precision': 0.4253019707565162, 'recall': 0.061017876687340385, 'f1-score': 0.10672409667384541, 'support': 10964}, '1': {'precision': 0.3333793627230987, 'recall': 0.8943322837562512, 'f1-score': 0.4857035081101471, 'support': 10798}, '2': {'precision': 0.4531791907514451, 'recall': 0.07460982108869432, 'f1-score': 0.12812551070436345, 'support': 10508}, 'accuracy': 0.34428261543229005, 'macro avg': {'precision': 0.40395350807702, 'recall': 0.34331999384409534, 'f1-score': 0.240184371829452, 'support': 32270}, 'weighted avg': {'precision': 0.40362095142468696, 'recall': 0.34428261543229005, 'f1-score': 0.24050487582853614, 'support': 32270}}
[[ 669 9878  417]
 [ 612 9657  529]
 [ 292 9432  784]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0958538
{'0': {'precision': 0.4486922871630638, 'recall': 0.10358344821212657, 'f1-score': 0.16831119425864866, 'support': 129847}, '1': {'precision': 0.3726880747603614, 'recall': 0.8616088271698913, 'f1-score': 0.520314576650578, 'support': 151079}, '2': {'precision': 0.42917913407116337, 'recall': 0.09443541030420814, 'f1-score': 0.15480741723232166, 'support': 126065}, 'accuracy': 0.38213621431432143, 'macro avg': {'precision': 0.4168531653315295, 'recall': 0.3532092285620754, 'f1-score': 0.28114439604718283, 'support': 406991}, 'weighted avg': {'precision': 0.4144346105802443, 'recall': 0.38213621431432143, 'f1-score': 0.2947954785734526, 'support': 406991}}
[[ 13450 110985   5412]
 [ 10486 130171  10422]
 [  6040 108120  11905]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1202278
{'0': {'precision': 0.44796087839084703, 'recall': 0.10502065802851024, 'f1-score': 0.1701508752869434, 'support': 46229}, '1': {'precision': 0.3257552535676578, 'recall': 0.8504801707273697, 'f1-score': 0.47107641539636025, 'support': 44984}, '2': {'precision': 0.44880127863612146, 'recall': 0.09067034055194385, 'f1-score': 0.15086230054263147, 'support': 46454}, 'accuracy': 0.34376430081283094, 'macro avg': {'precision': 0.40750580353154214, 'recall': 0.3487237231026079, 'f1-score': 0.2640298637419784, 'support': 137667}, 'weighted avg': {'precision': 0.40831261211023967, 'recall': 0.34376430081283094, 'f1-score': 0.26197246684563025, 'support': 137667}}
[[ 4855 39358  2016]
 [ 3569 38258  3157]
 [ 2414 39828  4212]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1112503
{'0': {'precision': 0.4766949152542373, 'recall': 0.10296893770379269, 'f1-score': 0.16935597685468315, 'support': 17481}, '1': {'precision': 0.34481879051971515, 'recall': 0.8819659653128907, 'f1-score': 0.4957975488248417, 'support': 18393}, '2': {'precision': 0.4329588014981273, 'recall': 0.06561843673724244, 'f1-score': 0.11396460787696554, 'support': 17617}, 'accuracy': 0.35852760277429846, 'macro avg': {'precision': 0.41815750242402655, 'recall': 0.35018444658464193, 'f1-score': 0.2597060445188301, 'support': 53491}, 'weighted avg': {'precision': 0.4169447389949889, 'recall': 0.35852760277429846, 'f1-score': 0.26336076431363276, 'support': 53491}}
[[ 1800 15056   625]
 [ 1282 16222   889]
 [  694 15767  1156]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/EXC
Evaluating performance on  test set...
3782/3782 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94545454
{'0': {'precision': 0.4034478266533501, 'recall': 0.153562633257855, 'f1-score': 0.22245367044964803, 'support': 181509}, '1': {'precision': 0.63134101427586, 'recall': 0.8906945576261256, 'f1-score': 0.7389209763592555, 'support': 593932}, '2': {'precision': 0.4623336560392498, 'recall': 0.1463635088594181, 'f1-score': 0.22233971197474847, 'support': 192507}, 'accuracy': 0.6044343291168534, 'macro avg': {'precision': 0.4990408323228199, 'recall': 0.39687356658113293, 'f1-score': 0.39457145292788404, 'support': 967948}, 'weighted avg': {'precision': 0.5549941814870848, 'recall': 0.6044343291168534, 'f1-score': 0.5393348687468473, 'support': 967948}}
[[ 27873 149502   4134]
 [ 36287 529012  28633]
 [  4927 159404  28176]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9815071
{'0': {'precision': 0.4140712900677471, 'recall': 0.18897835658643708, 'f1-score': 0.25951598625677036, 'support': 91529}, '1': {'precision': 0.5773865635526307, 'recall': 0.8469102422398267, 'f1-score': 0.6866470421273048, 'support': 227089}, '2': {'precision': 0.4510219877877476, 'recall': 0.17263968748628364, 'f1-score': 0.24970043248819582, 'support': 91132}, 'accuracy': 0.5499792556436852, 'macro avg': {'precision': 0.48082661380270847, 'recall': 0.4028427621041825, 'f1-score': 0.3986211536240903, 'support': 409750}, 'weighted avg': {'precision': 0.5128009865290719, 'recall': 0.5499792556436852, 'f1-score': 0.49405473744785283, 'support': 409750}}
[[ 17297  70261   3971]
 [ 19586 192324  15179]
 [  4890  70509  15733]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95617235
{'0': {'precision': 0.39892344497607657, 'recall': 0.1967624174932704, 'f1-score': 0.2635387084825287, 'support': 27119}, '1': {'precision': 0.6267907026717284, 'recall': 0.8522021766123731, 'f1-score': 0.7223190977847024, 'support': 82146}, '2': {'precision': 0.42491436812691546, 'recall': 0.17528724947012234, 'f1-score': 0.24819017032142573, 'support': 26893}, 'accuracy': 0.5879566386110254, 'macro avg': {'precision': 0.48354283859157343, 'recall': 0.40808394785858865, 'f1-score': 0.4113493255295522, 'support': 136158}, 'weighted avg': {'precision': 0.5415324554415838, 'recall': 0.5879566386110254, 'f1-score': 0.5372957086062806, 'support': 136158}}
[[ 5336 20766  1017]
 [ 6778 70005  5363]
 [ 1262 20917  4714]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/AAL
Evaluating performance on  test set...
4457/4457 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99829036
{'0': {'precision': 0.46013181932156033, 'recall': 0.09597653915122534, 'f1-score': 0.1588246567381937, 'support': 267680}, '1': {'precision': 0.5470493841025944, 'recall': 0.939795678107995, 'f1-score': 0.6915510700582225, 'support': 611584}, '2': {'precision': 0.46431991642241505, 'recall': 0.061140811109285376, 'f1-score': 0.1080533513422252, 'support': 261691}, 'accuracy': 0.5402973824559251, 'macro avg': {'precision': 0.4905003732821899, 'recall': 0.3656376761228352, 'f1-score': 0.3194763593795471, 'support': 1140955}, 'weighted avg': {'precision': 0.5076826686166366, 'recall': 0.5402973824559251, 'f1-score': 0.43273603543721345, 'support': 1140955}}
[[ 25691 236821   5168]
 [ 23529 574764  13291]
 [  6614 239077  16000]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9624293
{'0': {'precision': 0.4006362275449102, 'recall': 0.12204993729335309, 'f1-score': 0.18710128462815695, 'support': 122794}, '1': {'precision': 0.6212461324889078, 'recall': 0.9095756693350621, 'f1-score': 0.7382575373660569, 'support': 376381}, '2': {'precision': 0.4088217972164533, 'recall': 0.108498753691623, 'f1-score': 0.17148615264594982, 'support': 121559}, 'accuracy': 0.5969110762419974, 'macro avg': {'precision': 0.4769013857500905, 'recall': 0.3800414534400127, 'f1-score': 0.3656149915467213, 'support': 620734}, 'weighted avg': {'precision': 0.5360056551844948, 'recall': 0.5969110762419974, 'f1-score': 0.5182360085729036, 'support': 620734}}
[[ 14987 104138   3669]
 [ 18631 342347  15403]
 [  3790 104580  13189]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9718678
{'0': {'precision': 0.4034715169421106, 'recall': 0.10592655435704763, 'f1-score': 0.16779940867027607, 'support': 41255}, '1': {'precision': 0.6057897965612721, 'recall': 0.9186690692704187, 'f1-score': 0.7301218301837776, 'support': 119315}, '2': {'precision': 0.3998095641134152, 'recall': 0.09295975597756569, 'f1-score': 0.15084623982117198, 'support': 40652}, 'accuracy': 0.5852242796513304, 'macro avg': {'precision': 0.46969029253893263, 'recall': 0.372518459868344, 'f1-score': 0.3495891595584086, 'support': 201222}, 'weighted avg': {'precision': 0.522696749900575, 'recall': 0.5852242796513304, 'f1-score': 0.4978046740131792, 'support': 201222}}
[[  4370  35589   1296]
 [  5327 109611   4377]
 [  1134  35739   3779]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/WBA
Evaluating performance on  test set...
4676/4676 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99870896
{'0': {'precision': 0.501232231659552, 'recall': 0.1553279554861542, 'f1-score': 0.23716143406716397, 'support': 293302}, '1': {'precision': 0.5305242667124545, 'recall': 0.9034989872174188, 'f1-score': 0.6685081798435139, 'support': 608719}, '2': {'precision': 0.5203526056520612, 'recall': 0.12247596316838665, 'f1-score': 0.19828206042975932, 'support': 294964}, 'accuracy': 0.5277100381374871, 'macro avg': {'precision': 0.517369701341356, 'recall': 0.39376763529065323, 'f1-score': 0.3679838914468124, 'support': 1196985}, 'weighted avg': {'precision': 0.5208401969053105, 'recall': 0.5277100381374871, 'f1-score': 0.44693928773838837, 'support': 1196985}}
[[ 45558 238344   9400]
 [ 34842 549977  23900]
 [ 10492 248346  36126]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99887097
{'0': {'precision': 0.4690348263035392, 'recall': 0.1628094867748439, 'f1-score': 0.241715618133716, 'support': 132437}, '1': {'precision': 0.5319668948965907, 'recall': 0.8755463905548859, 'f1-score': 0.6618220936678432, 'support': 275444}, '2': {'precision': 0.4971814825900429, 'recall': 0.15155178443805786, 'f1-score': 0.23229498071297883, 'support': 131526}, 'accuracy': 0.5240180420350496, 'macro avg': {'precision': 0.4993944012633909, 'recall': 0.39663588725592924, 'f1-score': 0.37861089750484594, 'support': 539407}, 'weighted avg': {'precision': 0.5080337228997702, 'recall': 0.5240180420350496, 'f1-score': 0.45394265502723474, 'support': 539407}}
[[ 21562 105903   4972]
 [ 19093 241164  15187]
 [  5316 106277  19933]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0167252
{'0': {'precision': 0.4886709502874535, 'recall': 0.16155179160377886, 'f1-score': 0.24282653447044492, 'support': 53667}, '1': {'precision': 0.4934971904339708, 'recall': 0.865662110803267, 'f1-score': 0.628626562254583, 'support': 97091}, '2': {'precision': 0.4910780669144981, 'recall': 0.1483297464208852, 'f1-score': 0.22784045993532162, 'support': 53435}, 'accuracy': 0.4928866317650458, 'macro avg': {'precision': 0.4910820692119741, 'recall': 0.3918478829426437, 'f1-score': 0.36643118555344983, 'support': 204193}, 'weighted avg': {'precision': 0.49159567718324154, 'recall': 0.4928866317650458, 'f1-score': 0.422347524929498, 'support': 204193}}
[[ 8670 42768  2229]
 [ 7058 84048  5985]
 [ 2014 43495  7926]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
4274/4274 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.083813
{'0': {'precision': 0.5810444336277032, 'recall': 0.02452187335843431, 'f1-score': 0.04705776346096447, 'support': 340757}, '1': {'precision': 0.3863838531696881, 'recall': 0.9823744826023165, 'f1-score': 0.5546247689214989, 'support': 419165}, '2': {'precision': 0.6100286532951289, 'recall': 0.025486399372716146, 'f1-score': 0.048928609389857484, 'support': 334139}, 'accuracy': 0.3917962526769531, 'macro avg': {'precision': 0.52581898003084, 'recall': 0.34412758511115565, 'f1-score': 0.2168703805907736, 'support': 1094061}, 'weighted avg': {'precision': 0.5153167054368346, 'recall': 0.3917962526769531, 'f1-score': 0.24209208643902447, 'support': 1094061}}
[[  8356 330361   2040]
 [  3984 411777   3404]
 [  2041 323582   8516]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0257465
{'0': {'precision': 0.4550666300734913, 'recall': 0.11425705732376788, 'f1-score': 0.18265382308662073, 'support': 130609}, '1': {'precision': 0.4950940430730598, 'recall': 0.9021599134224073, 'f1-score': 0.6393311637564009, 'support': 243019}, '2': {'precision': 0.47905370402348474, 'recall': 0.1059267348356994, 'f1-score': 0.17349159495697417, 'support': 130949}, 'accuracy': 0.4915721485521536, 'macro avg': {'precision': 0.47640479239001193, 'recall': 0.3741145685272915, 'f1-score': 0.33182552726666525, 'support': 504577}, 'weighted avg': {'precision': 0.48057018102095783, 'recall': 0.4915721485521536, 'f1-score': 0.40022514726683545, 'support': 504577}}
[[ 14923 111464   4222]
 [ 12915 219242  10862]
 [  4955 112123  13871]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0384952
{'0': {'precision': 0.45193604315160857, 'recall': 0.09605896202272494, 'f1-score': 0.1584412514562615, 'support': 48845}, '1': {'precision': 0.4723406370788332, 'recall': 0.9058623032094293, 'f1-score': 0.6209181026912441, 'support': 83909}, '2': {'precision': 0.44402116402116404, 'recall': 0.08741666666666667, 'f1-score': 0.14607484769364665, 'support': 48000}, 'accuracy': 0.4696880843577459, 'macro avg': {'precision': 0.45609928141720196, 'recall': 0.3631126439662737, 'f1-score': 0.3084780672803841, 'support': 180754}, 'weighted avg': {'precision': 0.45930636344094194, 'recall': 0.4696880843577459, 'f1-score': 0.3698467126337217, 'support': 180754}}
[[ 4692 42696  1457]
 [ 4102 76010  3797]
 [ 1588 42216  4196]]
testing model on single stock: results/universal/W4/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
12724/12724 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620238
{'0': {'precision': 0.4960377358490566, 'recall': 0.13374439880895525, 'f1-score': 0.21068323509593684, 'support': 963188}, '1': {'precision': 0.41378679812264696, 'recall': 0.8724657227017389, 'f1-score': 0.5613435807101577, 'support': 1333171}, '2': {'precision': 0.44090012013042734, 'recall': 0.08556761977718197, 'f1-score': 0.14332036316472116, 'support': 960784}, 'accuracy': 0.4218970428992525, 'macro avg': {'precision': 0.4502415513673769, 'recall': 0.3639259137626254, 'f1-score': 0.30511572632360523, 'support': 3257143}, 'weighted avg': {'precision': 0.4461075043915299, 'recall': 0.4218970428992525, 'f1-score': 0.33434038925751197, 'support': 3257143}}
[[ 128821  803794   30573]
 [  96346 1163146   73679]
 [  34533  844039   82212]]
Evaluating performance on  train set...
5165/5165 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1035365
{'0': {'precision': 0.5245811890944925, 'recall': 0.08614969656102495, 'f1-score': 0.1479948413403248, 'support': 444900}, '1': {'precision': 0.32611426696419055, 'recall': 0.901434261284688, 'f1-score': 0.4789555224421429, 'support': 431093}, '2': {'precision': 0.4959860687853722, 'recall': 0.0638453830790233, 'f1-score': 0.11312840840936264, 'support': 446109}, 'accuracy': 0.34446056355712346, 'macro avg': {'precision': 0.44889384161468504, 'recall': 0.35047644697491204, 'f1-score': 0.24669292406394347, 'support': 1322102}, 'weighted avg': {'precision': 0.4502191191574531, 'recall': 0.34446056355712346, 'f1-score': 0.24414521655330193, 'support': 1322102}}
[[ 38328 396640   9932]
 [ 23480 388602  19011]
 [ 11256 406371  28482]]
Evaluating performance on  val set...
1903/1903 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1032879
{'0': {'precision': 0.5217640320733105, 'recall': 0.08375317177214725, 'f1-score': 0.1443374104822866, 'support': 163158}, '1': {'precision': 0.33211543421308637, 'recall': 0.9056032275775279, 'f1-score': 0.4859986658301897, 'support': 162103}, '2': {'precision': 0.4768772284604332, 'recall': 0.055404419493254524, 'f1-score': 0.09927490874042398, 'support': 161738}, 'accuracy': 0.34790009835749147, 'macro avg': {'precision': 0.44358556491561, 'recall': 0.3482536062809765, 'f1-score': 0.2432036616843001, 'support': 486999}, 'weighted avg': {'precision': 0.44372997347837406, 'recall': 0.34790009835749147, 'f1-score': 0.24309735776952077, 'support': 486999}}
[[ 13665 146110   3383]
 [  8855 146801   6447]
 [  3670 149107   8961]]
training model: results/universal/W4/deepLOB_L2/h10
Epoch 1/50
9854/9854 - 410s - loss: 2.6981 - accuracy10: 0.5532 - val_loss: 3.9308 - val_accuracy10: 0.4777 - 410s/epoch - 42ms/step
Epoch 2/50
9854/9854 - 400s - loss: 2.5577 - accuracy10: 0.5883 - val_loss: 3.6703 - val_accuracy10: 0.5077 - 400s/epoch - 41ms/step
Epoch 3/50
9854/9854 - 403s - loss: 2.5144 - accuracy10: 0.5976 - val_loss: 3.4031 - val_accuracy10: 0.5271 - 403s/epoch - 41ms/step
Epoch 4/50
9854/9854 - 410s - loss: 2.4904 - accuracy10: 0.6016 - val_loss: 3.4172 - val_accuracy10: 0.5319 - 410s/epoch - 42ms/step
Epoch 5/50
9854/9854 - 411s - loss: 2.4746 - accuracy10: 0.6045 - val_loss: 3.3736 - val_accuracy10: 0.5368 - 411s/epoch - 42ms/step
Epoch 6/50
9854/9854 - 401s - loss: 2.4632 - accuracy10: 0.6062 - val_loss: 3.3241 - val_accuracy10: 0.5424 - 401s/epoch - 41ms/step
Epoch 7/50
9854/9854 - 399s - loss: 2.4545 - accuracy10: 0.6079 - val_loss: 3.2873 - val_accuracy10: 0.5441 - 399s/epoch - 40ms/step
Epoch 8/50
9854/9854 - 400s - loss: 2.4482 - accuracy10: 0.6086 - val_loss: 3.2524 - val_accuracy10: 0.5521 - 400s/epoch - 41ms/step
Epoch 9/50
9854/9854 - 401s - loss: 2.4425 - accuracy10: 0.6098 - val_loss: 3.2740 - val_accuracy10: 0.5512 - 401s/epoch - 41ms/step
Epoch 10/50
9854/9854 - 400s - loss: 2.4371 - accuracy10: 0.6107 - val_loss: 3.2223 - val_accuracy10: 0.5525 - 400s/epoch - 41ms/step
Epoch 11/50
9854/9854 - 400s - loss: 2.4328 - accuracy10: 0.6115 - val_loss: 3.2197 - val_accuracy10: 0.5572 - 400s/epoch - 41ms/step
Epoch 12/50
9854/9854 - 400s - loss: 2.4289 - accuracy10: 0.6120 - val_loss: 3.2299 - val_accuracy10: 0.5568 - 400s/epoch - 41ms/step
Epoch 13/50
9854/9854 - 401s - loss: 2.4254 - accuracy10: 0.6127 - val_loss: 3.1916 - val_accuracy10: 0.5595 - 401s/epoch - 41ms/step
Epoch 14/50
9854/9854 - 402s - loss: 2.4221 - accuracy10: 0.6134 - val_loss: 3.1744 - val_accuracy10: 0.5574 - 402s/epoch - 41ms/step
Epoch 15/50
9854/9854 - 399s - loss: 2.4193 - accuracy10: 0.6139 - val_loss: 3.1936 - val_accuracy10: 0.5615 - 399s/epoch - 41ms/step
Epoch 16/50
9854/9854 - 399s - loss: 2.4163 - accuracy10: 0.6144 - val_loss: 3.1999 - val_accuracy10: 0.5593 - 399s/epoch - 41ms/step
Epoch 17/50
9854/9854 - 400s - loss: 2.4140 - accuracy10: 0.6149 - val_loss: 3.1866 - val_accuracy10: 0.5603 - 400s/epoch - 41ms/step
Epoch 18/50
9854/9854 - 400s - loss: 2.4116 - accuracy10: 0.6151 - val_loss: 3.1693 - val_accuracy10: 0.5610 - 400s/epoch - 41ms/step
Epoch 19/50
9854/9854 - 401s - loss: 2.4094 - accuracy10: 0.6156 - val_loss: 3.2190 - val_accuracy10: 0.5622 - 401s/epoch - 41ms/step
Epoch 20/50
9854/9854 - 406s - loss: 2.4073 - accuracy10: 0.6157 - val_loss: 3.1730 - val_accuracy10: 0.5577 - 406s/epoch - 41ms/step
Epoch 21/50
9854/9854 - 401s - loss: 2.4057 - accuracy10: 0.6161 - val_loss: 3.1665 - val_accuracy10: 0.5650 - 401s/epoch - 41ms/step
Epoch 22/50
9854/9854 - 401s - loss: 2.4035 - accuracy10: 0.6165 - val_loss: 3.1771 - val_accuracy10: 0.5652 - 401s/epoch - 41ms/step
Epoch 23/50
9854/9854 - 402s - loss: 2.4019 - accuracy10: 0.6168 - val_loss: 3.1910 - val_accuracy10: 0.5640 - 402s/epoch - 41ms/step
Epoch 24/50
9854/9854 - 402s - loss: 2.4000 - accuracy10: 0.6171 - val_loss: 3.1415 - val_accuracy10: 0.5647 - 402s/epoch - 41ms/step
Epoch 25/50
9854/9854 - 402s - loss: 2.3981 - accuracy10: 0.6174 - val_loss: 3.1856 - val_accuracy10: 0.5656 - 402s/epoch - 41ms/step
Epoch 26/50
9854/9854 - 403s - loss: 2.3967 - accuracy10: 0.6178 - val_loss: 3.1753 - val_accuracy10: 0.5671 - 403s/epoch - 41ms/step
Epoch 27/50
9854/9854 - 400s - loss: 2.3949 - accuracy10: 0.6179 - val_loss: 3.1652 - val_accuracy10: 0.5653 - 400s/epoch - 41ms/step
Epoch 28/50
9854/9854 - 398s - loss: 2.3932 - accuracy10: 0.6183 - val_loss: 3.1537 - val_accuracy10: 0.5659 - 398s/epoch - 40ms/step
Epoch 29/50
9854/9854 - 397s - loss: 2.3917 - accuracy10: 0.6185 - val_loss: 3.1714 - val_accuracy10: 0.5663 - 397s/epoch - 40ms/step
Epoch 30/50
9854/9854 - 399s - loss: 2.3902 - accuracy10: 0.6187 - val_loss: 3.2100 - val_accuracy10: 0.5667 - 399s/epoch - 41ms/step
Epoch 31/50
9854/9854 - 398s - loss: 2.3891 - accuracy10: 0.6191 - val_loss: 3.1538 - val_accuracy10: 0.5675 - 398s/epoch - 40ms/step
Epoch 32/50
9854/9854 - 397s - loss: 2.3876 - accuracy10: 0.6194 - val_loss: 3.1520 - val_accuracy10: 0.5688 - 397s/epoch - 40ms/step
Epoch 33/50
9854/9854 - 401s - loss: 2.3863 - accuracy10: 0.6194 - val_loss: 3.1497 - val_accuracy10: 0.5676 - 401s/epoch - 41ms/step
Epoch 34/50
9854/9854 - 400s - loss: 2.3851 - accuracy10: 0.6197 - val_loss: 3.1440 - val_accuracy10: 0.5662 - 400s/epoch - 41ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 309s - 309s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9275073
{'0': {'precision': 0.41680643410591256, 'recall': 0.5139073608791348, 'f1-score': 0.4602916507802569, 'support': 1322573}, '1': {'precision': 0.6836901163657262, 'recall': 0.6884281565404272, 'f1-score': 0.6860509560268189, 'support': 3418133}, '2': {'precision': 0.4455228324784186, 'recall': 0.3344538572797115, 'f1-score': 0.38208021287096844, 'support': 1330925}, 'accuracy': 0.5728200544466553, 'macro avg': {'precision': 0.5153397943166858, 'recall': 0.5122631248997579, 'f1-score': 0.5094742732260148, 'support': 6071631}, 'weighted avg': {'precision': 0.5733481103042374, 'recall': 0.5728200544466553, 'f1-score': 0.5702426299028234, 'support': 6071631}}
[[ 679680  497510  145383]
 [ 656385 2353139  408609]
 [ 294620  591172  445133]]
Evaluating performance on  train set...
9854/9854 - 132s - 132s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9964333
{'0': {'precision': 0.4357876221516589, 'recall': 0.4950333702878962, 'f1-score': 0.4635250323654316, 'support': 629602}, '1': {'precision': 0.630710836803311, 'recall': 0.6922089081817403, 'f1-score': 0.6600304536643604, 'support': 1261492}, '2': {'precision': 0.46930459099228794, 'recall': 0.31414193446130684, 'f1-score': 0.37635817449195447, 'support': 630925}, 'accuracy': 0.5484058605426843, 'macro avg': {'precision': 0.5119343499824193, 'recall': 0.5004614043103145, 'f1-score': 0.4999712201739155, 'support': 2522019}, 'weighted avg': {'precision': 0.5416713484293418, 'recall': 0.5484058605426843, 'f1-score': 0.5400090981561353, 'support': 2522019}}
[[311674 242871  75057]
 [239206 873216 149070]
 [164317 268408 198200]]
Evaluating performance on  val set...
3566/3566 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9459884
{'0': {'precision': 0.45803372479289345, 'recall': 0.5311494361956363, 'f1-score': 0.4918893977920306, 'support': 231818}, '1': {'precision': 0.6711587558193977, 'recall': 0.679338495654351, 'f1-score': 0.675223854067145, 'support': 447344}, '2': {'precision': 0.46115250114033757, 'recall': 0.3771902740254728, 'f1-score': 0.41496686898328233, 'support': 233190}, 'accuracy': 0.5644586738451826, 'macro avg': {'precision': 0.5301149939175428, 'recall': 0.5292260686251534, 'f1-score': 0.5273600402808193, 'support': 912352}, 'weighted avg': {'precision': 0.5633302236617302, 'recall': 0.5644586738451826, 'f1-score': 0.5621210677122179, 'support': 912352}}
[[123130  68513  40175]
 [ 80845 303898  62601]
 [ 64848  80385  87957]]
testing model out of sample: results/universal/W4/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 160s - 160s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96008474
{'0': {'precision': 0.3714679786978941, 'recall': 0.6717481164891045, 'f1-score': 0.4783916125864524, 'support': 641090}, '1': {'precision': 0.7879052110160357, 'recall': 0.5189981253586252, 'f1-score': 0.6257866455708331, 'support': 1761937}, '2': {'precision': 0.42761559656101195, 'recall': 0.484148485161824, 'f1-score': 0.4541294123264614, 'support': 628615}, 'accuracy': 0.5440734756940299, 'macro avg': {'precision': 0.5289962620916473, 'recall': 0.5582982423365179, 'f1-score': 0.5194358901612489, 'support': 3031642}, 'weighted avg': {'precision': 0.6251362556916662, 'recall': 0.5440734756940299, 'f1-score': 0.5590242134063931, 'support': 3031642}}
[[430651 108769 101670]
 [541787 914442 305708]
 [186884 137388 304343]]
Evaluating performance on  train set...
5528/5528 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7474697
{'0': {'precision': 0.423157556159285, 'recall': 0.571489520145213, 'f1-score': 0.48626314695215117, 'support': 257828}, '1': {'precision': 0.8120968239577351, 'recall': 0.7597676979851764, 'f1-score': 0.7850612134394245, 'support': 900724}, '2': {'precision': 0.48011396674031864, 'recall': 0.4194449654568758, 'f1-score': 0.4477336147457903, 'support': 255912}, 'accuracy': 0.6638755033708882, 'macro avg': {'precision': 0.5717894489524463, 'recall': 0.5835673945290885, 'f1-score': 0.5730193250457886, 'support': 1414464}, 'weighted avg': {'precision': 0.6811370890375376, 'recall': 0.6638755033708882, 'f1-score': 0.6695653872302272, 'support': 1414464}}
[[147346  75570  34912]
 [135062 684341  81321]
 [ 65798  82773 107341]]
Evaluating performance on  val set...
1908/1908 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77722824
{'0': {'precision': 0.4399092376838155, 'recall': 0.5445225826662777, 'f1-score': 0.486657398289212, 'support': 92571}, '1': {'precision': 0.8010321430625036, 'recall': 0.7324119529714845, 'f1-score': 0.7651867033310332, 'support': 304326}, '2': {'precision': 0.4453764666160209, 'recall': 0.46528880070546735, 'f1-score': 0.45511493509294, 'support': 90720}, 'accuracy': 0.6470447092697753, 'macro avg': {'precision': 0.56210594912078, 'recall': 0.5807411121144099, 'f1-score': 0.5689863455710618, 'support': 487617}, 'weighted avg': {'precision': 0.6663063409657033, 'recall': 0.6470447092697753, 'f1-score': 0.6546215525844713, 'support': 487617}}
[[ 50407  27884  14280]
 [ 43149 222892  38285]
 [ 21029  27480  42211]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.104827
{'0': {'precision': 0.4394220081511671, 'recall': 0.5932450359931276, 'f1-score': 0.5048770104943642, 'support': 45981}, '1': {'precision': 0.4615052303514673, 'recall': 0.3299214682784788, 'f1-score': 0.3847746948121278, 'support': 45332}, '2': {'precision': 0.479701209390562, 'recall': 0.44615248891731546, 'f1-score': 0.46231902275142556, 'support': 45341}, 'accuracy': 0.45708870578248717, 'macro avg': {'precision': 0.4602094826310654, 'recall': 0.4564396643963073, 'f1-score': 0.4506569093526392, 'support': 136654}, 'weighted avg': {'precision': 0.46011204204830447, 'recall': 0.45708870578248717, 'f1-score': 0.4509151806411604, 'support': 136654}}
[[27278  8440 10263]
 [18698 14956 11678]
 [16101  9011 20229]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2028049
{'0': {'precision': 0.33053712681806585, 'recall': 0.6010672234789165, 'f1-score': 0.4265223386084416, 'support': 17241}, '1': {'precision': 0.5796689635575761, 'recall': 0.2717554201218903, 'f1-score': 0.37003446399419554, 'support': 30027}, '2': {'precision': 0.38903983185523144, 'recall': 0.4295336201041431, 'f1-score': 0.408285137861466, 'support': 17668}, 'accuracy': 0.4021190094862634, 'macro avg': {'precision': 0.4330819740769578, 'recall': 0.43411875456831667, 'f1-score': 0.401613980154701, 'support': 64936}, 'weighted avg': {'precision': 0.4616555735097918, 'recall': 0.4021190094862634, 'f1-score': 0.3954397915799901, 'support': 64936}}
[[10363  2835  4043]
 [13992  8160  7875]
 [ 6997  3082  7589]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2099894
{'0': {'precision': 0.34092811308472054, 'recall': 0.6297886961003264, 'f1-score': 0.4423796307469531, 'support': 5821}, '1': {'precision': 0.552342030807922, 'recall': 0.19615942838003797, 'f1-score': 0.2895040369088812, 'support': 8957}, '2': {'precision': 0.39682777195870117, 'recall': 0.45418736084946054, 'f1-score': 0.4235745088643987, 'support': 5839}, 'accuracy': 0.3916670708638502, 'macro avg': {'precision': 0.43003263861711455, 'recall': 0.42671182844327493, 'f1-score': 0.38515272550674434, 'support': 20617}, 'weighted avg': {'precision': 0.4486078225095587, 'recall': 0.3916670708638502, 'f1-score': 0.37063738887471925, 'support': 20617}}
[[3666  696 1459]
 [4628 1757 2572]
 [2459  728 2652]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0442576
{'0': {'precision': 0.17642766619301817, 'recall': 0.6801492360535355, 'f1-score': 0.2801783285661139, 'support': 33772}, '1': {'precision': 0.9526666666666667, 'recall': 0.472136563876652, 'f1-score': 0.6313696612665685, 'support': 345040}, '2': {'precision': 0.21640066634424204, 'recall': 0.7098745482856891, 'f1-score': 0.331688299208599, 'support': 34037}, 'accuracy': 0.5087525947743606, 'macro avg': {'precision': 0.44849833306797554, 'recall': 0.6207201160719588, 'f1-score': 0.4144120963470938, 'support': 412849}, 'weighted avg': {'precision': 0.8284676753236565, 'recall': 0.5087525947743606, 'f1-score': 0.577934414461255, 'support': 412849}}
[[ 22970   3686   7116]
 [101758 162906  80376]
 [  5467   4408  24162]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5685391
{'0': {'precision': 0.3490027027951692, 'recall': 0.6377219304826206, 'f1-score': 0.45112216694306245, 'support': 15996}, '1': {'precision': 0.9206261120800522, 'recall': 0.8034856277435672, 'f1-score': 0.8580764604705197, 'support': 130077}, '2': {'precision': 0.41639647985178324, 'recall': 0.5021411282815118, 'f1-score': 0.45526671168129645, 'support': 16113}, 'accuracy': 0.7571985251501363, 'macro avg': {'precision': 0.5620084315756683, 'recall': 0.6477828955025665, 'f1-score': 0.5881551130316262, 'support': 162186}, 'weighted avg': {'precision': 0.8141536661290139, 'recall': 0.7571985251501363, 'f1-score': 0.7779208714461529, 'support': 162186}}
[[ 10201   3947   1848]
 [ 16070 104515   9492]
 [  2958   5064   8091]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4869072
{'0': {'precision': 0.36470388019060584, 'recall': 0.5361521140855642, 'f1-score': 0.434113238124177, 'support': 3997}, '1': {'precision': 0.9360277708901562, 'recall': 0.8467922835352176, 'f1-score': 0.8891767754092569, 'support': 44580}, '2': {'precision': 0.3583690987124464, 'recall': 0.5629665302191187, 'f1-score': 0.4379507352252506, 'support': 4153}, 'accuracy': 0.8008913332069031, 'macro avg': {'precision': 0.5530335832644028, 'recall': 0.6486369759466335, 'f1-score': 0.5870802495862282, 'support': 52730}, 'weighted avg': {'precision': 0.8472244699859246, 'recall': 0.8008913332069031, 'f1-score': 0.8191439534215338, 'support': 52730}}
[[ 2143  1287   567]
 [ 3211 37750  3619]
 [  522  1293  2338]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0781827
{'0': {'precision': 0.42290268178962337, 'recall': 0.5504828041379113, 'f1-score': 0.4783318788181026, 'support': 69697}, '1': {'precision': 0.5940410717923078, 'recall': 0.5575930335633462, 'f1-score': 0.5752402811648257, 'support': 115066}, '2': {'precision': 0.45055309734513277, 'recall': 0.3582969240242794, 'f1-score': 0.39916371298368264, 'support': 68206}, 'accuracy': 0.5018994422241461, 'macro avg': {'precision': 0.489165616975688, 'recall': 0.48879092057517903, 'f1-score': 0.4842452909888703, 'support': 252969}, 'weighted avg': {'precision': 0.5082022016020429, 'recall': 0.5018994422241461, 'f1-score': 0.5010663573728883, 'support': 252969}}
[[38367 19746 11584]
 [32688 64160 18218]
 [19668 24100 24438]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1354332
{'0': {'precision': 0.46020894373908666, 'recall': 0.5540709068234456, 'f1-score': 0.5027969088498722, 'support': 28065}, '1': {'precision': 0.5070927236651168, 'recall': 0.5685115707692818, 'f1-score': 0.5360485865447828, 'support': 30119}, '2': {'precision': 0.5010534077741494, 'recall': 0.33546089286973696, 'f1-score': 0.40186718485974987, 'support': 28358}, 'accuracy': 0.4874627348570636, 'macro avg': {'precision': 0.4894516917261176, 'recall': 0.4860144568208215, 'f1-score': 0.4802375600848016, 'support': 86542}, 'weighted avg': {'precision': 0.4899096656856376, 'recall': 0.4874627348570636, 'f1-score': 0.4812968530108706, 'support': 86542}}
[[15550  7515  5000]
 [ 8523 17123  4473]
 [ 9716  9129  9513]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1612422
{'0': {'precision': 0.472982623184956, 'recall': 0.5557005686585252, 'f1-score': 0.511015859408487, 'support': 10727}, '1': {'precision': 0.4581297976273552, 'recall': 0.5310414560161779, 'f1-score': 0.4918984733539383, 'support': 9890}, '2': {'precision': 0.5086403215003349, 'recall': 0.3478699038021072, 'f1-score': 0.4131664853101197, 'support': 10915}, 'accuracy': 0.4760243562095649, 'macro avg': {'precision': 0.479917580770882, 'recall': 0.4782039761589368, 'f1-score': 0.47202693935751494, 'support': 31532}, 'weighted avg': {'precision': 0.4806671764117633, 'recall': 0.4760243562095649, 'f1-score': 0.4711485225328316, 'support': 31532}}
[[5961 2794 1972]
 [2942 5252 1696]
 [3700 3418 3797]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3871708
{'0': {'precision': 0.3232786070424504, 'recall': 0.593808844507846, 'f1-score': 0.41864207339763254, 'support': 70100}, '1': {'precision': 0.5936922301271638, 'recall': 0.10123607741245248, 'f1-score': 0.17297632551800682, 'support': 104686}, '2': {'precision': 0.32966996369933727, 'recall': 0.47969567745687147, 'f1-score': 0.3907782800071058, 'support': 61908}, 'accuracy': 0.34610509772110826, 'macro avg': {'precision': 0.4155469336229838, 'recall': 0.39158019979239, 'f1-score': 0.32746555964091506, 'support': 236694}, 'weighted avg': {'precision': 0.44454993903295653, 'recall': 0.34610509772110826, 'f1-score': 0.3027001559694458, 'support': 236694}}
[[41626  3749 24725]
 [58429 10598 35659]
 [28707  3504 29697]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3583364
{'0': {'precision': 0.37573106043432924, 'recall': 0.5571615852633702, 'f1-score': 0.44880386661792776, 'support': 29749}, '1': {'precision': 0.38187783947501264, 'recall': 0.05226432691975543, 'f1-score': 0.09194494242046733, 'support': 28949}, '2': {'precision': 0.3875141996345138, 'recall': 0.525307980717729, 'f1-score': 0.4460108575164142, 'support': 29872}, 'accuracy': 0.38139324827819804, 'macro avg': {'precision': 0.3817076998479519, 'recall': 0.3782446309669516, 'f1-score': 0.3289198888516031, 'support': 88570}, 'weighted avg': {'precision': 0.3817142267506515, 'recall': 0.38139324827819804, 'f1-score': 0.3312229502300685, 'support': 88570}}
[[16575  1229 11945]
 [14579  1513 12857]
 [12960  1220 15692]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3466696
{'0': {'precision': 0.39549861495844874, 'recall': 0.5257295406425481, 'f1-score': 0.45140892384302256, 'support': 10863}, '1': {'precision': 0.403387220939184, 'recall': 0.04761472058155384, 'f1-score': 0.08517555266579972, 'support': 11005}, '2': {'precision': 0.3611178320832325, 'recall': 0.5738729212727098, 'f1-score': 0.4432894004083906, 'support': 10403}, 'accuracy': 0.3782033404604753, 'macro avg': {'precision': 0.38666788932695506, 'recall': 0.38240572749893725, 'f1-score': 0.32662462563907096, 'support': 32271}, 'weighted avg': {'precision': 0.38710565609653297, 'recall': 0.3782033404604753, 'f1-score': 0.32389922001928567, 'support': 32271}}
[[5711  373 4779]
 [4698  524 5783]
 [4031  402 5970]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1520362
{'0': {'precision': 0.4182595100390276, 'recall': 0.5810958680385432, 'f1-score': 0.4864112974886875, 'support': 122460}, '1': {'precision': 0.5507255887974668, 'recall': 0.404117381489842, 'f1-score': 0.4661662488803094, 'support': 166125}, '2': {'precision': 0.43561126672349904, 'recall': 0.42291191622329194, 'f1-score': 0.42916766651811733, 'support': 118410}, 'accuracy': 0.46283615277828966, 'macro avg': {'precision': 0.46819878851999785, 'recall': 0.46937505525055906, 'f1-score': 0.46058173762903803, 'support': 406995}, 'weighted avg': {'precision': 0.4773770639223775, 'recall': 0.46283615277828966, 'f1-score': 0.4614934802101165, 'support': 406995}}
[[71161 26053 25246]
 [59356 67134 39635]
 [39619 28714 50077]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1632607
{'0': {'precision': 0.4468927385450917, 'recall': 0.592551622418879, 'f1-score': 0.5095164824917239, 'support': 46104}, '1': {'precision': 0.47085670576236616, 'recall': 0.4084535079182518, 'f1-score': 0.4374407807466364, 'support': 45212}, '2': {'precision': 0.4891205316469264, 'recall': 0.3937824951998792, 'f1-score': 0.4363040958038029, 'support': 46353}, 'accuracy': 0.4651664499633178, 'macro avg': {'precision': 0.46895665865146147, 'recall': 0.46492920851233666, 'f1-score': 0.4610871196807211, 'support': 137669}, 'weighted avg': {'precision': 0.4689808177748149, 'recall': 0.4651664499633178, 'f1-score': 0.4611955069093917, 'support': 137669}}
[[27319  9689  9096]
 [16776 18467  9969]
 [17036 11064 18253]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1783031
{'0': {'precision': 0.4249229979466119, 'recall': 0.5858103326256192, 'f1-score': 0.4925617375781018, 'support': 16956}, '1': {'precision': 0.49311316955296014, 'recall': 0.3084130982367758, 'f1-score': 0.3794824112815745, 'support': 19850}, '2': {'precision': 0.4321224789559912, 'recall': 0.4584082464341364, 'f1-score': 0.44487742460813684, 'support': 16686}, 'accuracy': 0.443131683242354, 'macro avg': {'precision': 0.4500528821518544, 'recall': 0.4508772257655105, 'f1-score': 0.43897385782260434, 'support': 53492}, 'weighted avg': {'precision': 0.4524730137715674, 'recall': 0.443131683242354, 'f1-score': 0.43572548032088765, 'support': 53492}}
[[9933 3089 3934]
 [7610 6122 6118]
 [5833 3204 7649]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
3782/3782 - 51s - 51s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6886656
{'0': {'precision': 0.365682131617101, 'recall': 0.7112496238662254, 'f1-score': 0.48302276767859587, 'support': 116315}, '1': {'precision': 0.9302760643138841, 'recall': 0.680320841846936, 'f1-score': 0.7859026585772934, 'support': 730204}, '2': {'precision': 0.3806580201623386, 'recall': 0.6511244884010112, 'f1-score': 0.4804418694382752, 'support': 121433}, 'accuracy': 0.6803746466766947, 'macro avg': {'precision': 0.5588720720311079, 'recall': 0.6808983180380576, 'f1-score': 0.5831224318980548, 'support': 967952}, 'weighted avg': {'precision': 0.7934794966771821, 'recall': 0.6803746466766947, 'f1-score': 0.711185632818371, 'support': 967952}}
[[ 82729  17126  16460]
 [121245 496773 112186]
 [ 22258  20107  79068]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6741347
{'0': {'precision': 0.39805937059111457, 'recall': 0.7004374039484572, 'f1-score': 0.5076312987283209, 'support': 59213}, '1': {'precision': 0.9054387964440392, 'recall': 0.6810973936899862, 'f1-score': 0.7774067912711615, 'support': 291600}, '2': {'precision': 0.43056989409458407, 'recall': 0.6297867286516567, 'f1-score': 0.5114641607187147, 'support': 58939}, 'accuracy': 0.6765116460688416, 'macro avg': {'precision': 0.578022687043246, 'recall': 0.6704405087633667, 'f1-score': 0.5988340835727324, 'support': 409752}, 'weighted avg': {'precision': 0.7638122609332821, 'recall': 0.6765116460688416, 'f1-score': 0.7001683423018584, 'support': 409752}}
[[ 41475   9984   7754]
 [ 51656 198608  41336]
 [ 11062  10758  37119]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6146069
{'0': {'precision': 0.40104840356729526, 'recall': 0.6886031560490941, 'f1-score': 0.5068834968163827, 'support': 17110}, '1': {'precision': 0.9199852052767846, 'recall': 0.7309236947791165, 'f1-score': 0.8146288209606986, 'support': 102090}, '2': {'precision': 0.4247370471367355, 'recall': 0.6429413845972403, 'f1-score': 0.5115417096743925, 'support': 16958}, 'accuracy': 0.7146476887145816, 'macro avg': {'precision': 0.5819235519936051, 'recall': 0.6874894118084836, 'f1-score': 0.6110180091504912, 'support': 136158}, 'weighted avg': {'precision': 0.7930927204944851, 'recall': 0.7146476887145816, 'f1-score': 0.7382082380401033, 'support': 136158}}
[[11782  3187  2141]
 [14844 74620 12626]
 [ 2752  3303 10903]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
4457/4457 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7882631
{'0': {'precision': 0.3525508723273888, 'recall': 0.7616258142424207, 'f1-score': 0.48199149817949344, 'support': 172246}, '1': {'precision': 0.8853573527505677, 'recall': 0.6233816727090886, 'f1-score': 0.7316249373675363, 'support': 799900}, '2': {'precision': 0.42957595798482784, 'recall': 0.5232890831867214, 'f1-score': 0.47182423428307424, 'support': 168813}, 'accuracy': 0.629442425187934, 'macro avg': {'precision': 0.5558280610209282, 'recall': 0.6360988567127436, 'f1-score': 0.5618135566100347, 'support': 1140959}, 'weighted avg': {'precision': 0.7374855978307504, 'recall': 0.629442425187934, 'f1-score': 0.6554994171199369, 'support': 1140959}}
[[131187  25065  15994]
 [199949 498643 101308]
 [ 40972  39503  88338]]
Evaluating performance on  train set...
2425/2425 - 32s - 32s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.573547
{'0': {'precision': 0.4144674179654245, 'recall': 0.6179405333400357, 'f1-score': 0.4961531282004712, 'support': 79574}, '1': {'precision': 0.8806424034605966, 'recall': 0.8161007388780765, 'f1-score': 0.8471440352025958, 'support': 464488}, '2': {'precision': 0.4815915815329649, 'recall': 0.4500423866970981, 'f1-score': 0.4652827873549657, 'support': 76675}, 'accuracy': 0.7454815807660894, 'macro avg': {'precision': 0.5922338009863286, 'recall': 0.6280278863050701, 'f1-score': 0.6028599835860109, 'support': 620737}, 'weighted avg': {'precision': 0.7715903732656928, 'recall': 0.7454815807660894, 'f1-score': 0.7549810714796277, 'support': 620737}}
[[ 49172  23965   6437]
 [ 54711 379069  30708]
 [ 14756  27412  34507]]
Evaluating performance on  val set...
787/787 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6057832
{'0': {'precision': 0.44984615384615384, 'recall': 0.5955193482688391, 'f1-score': 0.512532865907099, 'support': 27005}, '1': {'precision': 0.8896214327315084, 'recall': 0.7728858154832181, 'f1-score': 0.8271552346570398, 'support': 148225}, '2': {'precision': 0.41256778483254763, 'recall': 0.582486919052016, 'f1-score': 0.48301934948715086, 'support': 25992}, 'accuracy': 0.7244883760225025, 'macro avg': {'precision': 0.58401179047007, 'recall': 0.6502973609346911, 'f1-score': 0.6075691500170965, 'support': 201222}, 'weighted avg': {'precision': 0.7689800027562136, 'recall': 0.7244883760225025, 'f1-score': 0.7404790412217896, 'support': 201222}}
[[ 16082   7391   3532]
 [ 15639 114561  18025]
 [  4029   6823  15140]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6336627
{'0': {'precision': 0.46815517844646604, 'recall': 0.5733822584101136, 'f1-score': 0.5154531445632283, 'support': 186680}, '1': {'precision': 0.8257321724287588, 'recall': 0.8295163504081665, 'f1-score': 0.8276199357831329, 'support': 821111}, '2': {'precision': 0.5378079804844049, 'recall': 0.40783729214896564, 'f1-score': 0.4638909680076231, 'support': 189198}, 'accuracy': 0.7229189240669713, 'macro avg': {'precision': 0.6105651104532099, 'recall': 0.6035786336557486, 'f1-score': 0.6023213494513281, 'support': 1196989}, 'weighted avg': {'precision': 0.7244554234326508, 'recall': 0.7229189240669713, 'f1-score': 0.7214434464167956, 'support': 1196989}}
[[107039  63190  16451]
 [ 90124 681125  49862]
 [ 31477  80559  77162]]
Evaluating performance on  train set...
2108/2108 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6564444
{'0': {'precision': 0.4404517453798768, 'recall': 0.6525586093984046, 'f1-score': 0.5259247128184732, 'support': 86121}, '1': {'precision': 0.8694780642587069, 'recall': 0.7467059370640211, 'f1-score': 0.8034288573547936, 'support': 367707}, '2': {'precision': 0.48587405887804724, 'recall': 0.5451911055023896, 'f1-score': 0.5138263311491658, 'support': 85581}, 'accuracy': 0.6997028229043267, 'macro avg': {'precision': 0.5986012895055436, 'recall': 0.6481518839882717, 'f1-score': 0.6143933004408109, 'support': 539409}, 'weighted avg': {'precision': 0.7401190991827702, 'recall': 0.6997028229043267, 'f1-score': 0.7131756205218592, 'support': 539409}}
[[ 56199  19429  10493]
 [ 54260 274569  38878]
 [ 17135  21788  46658]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6948176
{'0': {'precision': 0.4371081205077229, 'recall': 0.6368294992480366, 'f1-score': 0.5183976059307625, 'support': 35906}, '1': {'precision': 0.8512251534702537, 'recall': 0.7355458213429708, 'f1-score': 0.7891688398582825, 'support': 133093}, '2': {'precision': 0.49326101694915253, 'recall': 0.5168210490424504, 'f1-score': 0.5047662656620738, 'support': 35194}, 'accuracy': 0.68048855739423, 'macro avg': {'precision': 0.5938647636423764, 'recall': 0.6297321232111526, 'f1-score': 0.6041109038170395, 'support': 204193}, 'weighted avg': {'precision': 0.7167079270899358, 'recall': 0.68048855739423, 'f1-score': 0.6925368489395786, 'support': 204193}}
[[22866  8481  4559]
 [21070 97896 14127]
 [ 8376  8629 18189]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
4274/4274 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0221614
{'0': {'precision': 0.35109082559510846, 'recall': 0.7058507364351165, 'f1-score': 0.4689336226421071, 'support': 230706}, '1': {'precision': 0.8045364591261989, 'recall': 0.42412126247415477, 'f1-score': 0.555437063963822, 'support': 635514}, '2': {'precision': 0.4116752421051205, 'recall': 0.5334152603743774, 'f1-score': 0.4647043978985524, 'support': 227845}, 'accuracy': 0.5062907596897808, 'macro avg': {'precision': 0.5224341756088093, 'recall': 0.5544624197612162, 'f1-score': 0.49635836150149376, 'support': 1094065}, 'weighted avg': {'precision': 0.6271026756475286, 'recall': 0.5062907596897808, 'f1-score': 0.5183004704038333, 'support': 1094065}}
[[162844  29386  38476]
 [230768 269535 135211]
 [ 70211  36098 121536]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7222521
{'0': {'precision': 0.43485231247570927, 'recall': 0.5153493620745244, 'f1-score': 0.47169115322189664, 'support': 86844}, '1': {'precision': 0.804155140812423, 'recall': 0.7916120140958299, 'f1-score': 0.7978342814063465, 'support': 330878}, '2': {'precision': 0.4939625771960549, 'recall': 0.43188883004444034, 'f1-score': 0.4608448351054354, 'support': 86858}, 'accuracy': 0.6821415830988149, 'macro avg': {'precision': 0.5776566768280624, 'recall': 0.5796167354049315, 'f1-score': 0.5767900899112263, 'support': 504580}, 'weighted avg': {'precision': 0.6871975909399269, 'recall': 0.6821415830988149, 'f1-score': 0.6836922164199124, 'support': 504580}}
[[ 44755  31733  10356]
 [ 40877 261927  28074]
 [ 17288  32057  37513]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7330552
{'0': {'precision': 0.45811273746496417, 'recall': 0.4587985777555985, 'f1-score': 0.4584554011095181, 'support': 32062}, '1': {'precision': 0.7775608879596204, 'recall': 0.8109008210963852, 'f1-score': 0.7938809716396629, 'support': 117404}, '2': {'precision': 0.48939174234908034, 'recall': 0.40990155970340064, 'f1-score': 0.44613350958360876, 'support': 31288}, 'accuracy': 0.6790333823871118, 'macro avg': {'precision': 0.5750217892578883, 'recall': 0.5598669861851281, 'f1-score': 0.5661566274442632, 'support': 180754}, 'weighted avg': {'precision': 0.6710161762020812, 'recall': 0.6790333823871118, 'f1-score': 0.6741893618542787, 'support': 180754}}
[[14710 13903  3449]
 [12269 95203  9932]
 [ 5131 13332 12825]]
testing model on single stock: results/universal/W4/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
12724/12724 - 171s - 171s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0581604
{'0': {'precision': 0.4638174643931489, 'recall': 0.4645584936649973, 'f1-score': 0.4641876832844575, 'support': 915706}, '1': {'precision': 0.528890062448015, 'recall': 0.7067240517905683, 'f1-score': 0.6050098061810505, 'support': 1417092}, '2': {'precision': 0.5266429661090988, 'recall': 0.2543357541361542, 'f1-score': 0.34301609627416196, 'support': 924349}, 'accuracy': 0.5102585176536398, 'macro avg': {'precision': 0.5064501643167542, 'recall': 0.47520609986390655, 'f1-score': 0.47073786191322337, 'support': 3257147}, 'weighted avg': {'precision': 0.5099580124888913, 'recall': 0.5102585176536398, 'f1-score': 0.49106797714236416, 'support': 3257147}}
[[ 425399  409662   80645]
 [ 284936 1001493  130663]
 [ 206834  482420  235095]]
Evaluating performance on  train set...
5165/5165 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2629889
{'0': {'precision': 0.45766069443935564, 'recall': 0.42726151193894046, 'f1-score': 0.44193896107878355, 'support': 438523}, '1': {'precision': 0.40181427835424893, 'recall': 0.6634819556863338, 'f1-score': 0.5005115285426118, 'support': 443159}, '2': {'precision': 0.5024646875483543, 'recall': 0.20644839017301667, 'f1-score': 0.29265372334946954, 'support': 440420}, 'accuracy': 0.43288339326315217, 'macro avg': {'precision': 0.453979886780653, 'recall': 0.43239728593276366, 'f1-score': 0.4117014043236216, 'support': 1322102}, 'weighted avg': {'precision': 0.4538665338823074, 'recall': 0.43288339326315217, 'f1-score': 0.41184200639900703, 'support': 1322102}}
[[187364 208140  43019]
 [102118 294028  47013]
 [119913 229583  90924]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1669368
{'0': {'precision': 0.48404408069495297, 'recall': 0.4935098998426273, 'f1-score': 0.48873116071158895, 'support': 163942}, '1': {'precision': 0.4331142547056878, 'recall': 0.5938585734723074, 'f1-score': 0.5009063655683437, 'support': 156576}, '2': {'precision': 0.48275566966195976, 'recall': 0.30495188669045303, 'f1-score': 0.3737865685982176, 'support': 166482}, 'accuracy': 0.4613141683778234, 'macro avg': {'precision': 0.4666380016875335, 'recall': 0.46410678666846256, 'f1-score': 0.45447469829271675, 'support': 487000}, 'weighted avg': {'precision': 0.46722912036704756, 'recall': 0.4613141683778234, 'f1-score': 0.45335156993424386, 'support': 487000}}
[[80907 55084 27951]
 [37147 92984 26445]
 [49094 66619 50769]]
training model: results/universal/W4/deepLOB_L2/h20
Epoch 1/50
9854/9854 - 402s - loss: 2.8074 - accuracy20: 0.5291 - val_loss: 3.3245 - val_accuracy20: 0.4857 - 402s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 398s - loss: 2.6790 - accuracy20: 0.5620 - val_loss: 3.3756 - val_accuracy20: 0.4983 - 398s/epoch - 40ms/step
Epoch 3/50
9854/9854 - 399s - loss: 2.6424 - accuracy20: 0.5701 - val_loss: 3.4671 - val_accuracy20: 0.5029 - 399s/epoch - 41ms/step
Epoch 4/50
9854/9854 - 401s - loss: 2.6212 - accuracy20: 0.5744 - val_loss: 3.3211 - val_accuracy20: 0.5159 - 401s/epoch - 41ms/step
Epoch 5/50
9854/9854 - 398s - loss: 2.6070 - accuracy20: 0.5770 - val_loss: 3.2319 - val_accuracy20: 0.5237 - 398s/epoch - 40ms/step
Epoch 6/50
9854/9854 - 397s - loss: 2.5970 - accuracy20: 0.5786 - val_loss: 3.1945 - val_accuracy20: 0.5294 - 397s/epoch - 40ms/step
Epoch 7/50
9854/9854 - 400s - loss: 2.5892 - accuracy20: 0.5799 - val_loss: 3.2285 - val_accuracy20: 0.5263 - 400s/epoch - 41ms/step
Epoch 8/50
9854/9854 - 398s - loss: 2.5834 - accuracy20: 0.5810 - val_loss: 3.1922 - val_accuracy20: 0.5272 - 398s/epoch - 40ms/step
Epoch 9/50
9854/9854 - 397s - loss: 2.5783 - accuracy20: 0.5816 - val_loss: 3.2046 - val_accuracy20: 0.5279 - 397s/epoch - 40ms/step
Epoch 10/50
9854/9854 - 400s - loss: 2.5738 - accuracy20: 0.5826 - val_loss: 3.2073 - val_accuracy20: 0.5265 - 400s/epoch - 41ms/step
Epoch 11/50
9854/9854 - 398s - loss: 2.5702 - accuracy20: 0.5831 - val_loss: 3.2278 - val_accuracy20: 0.5254 - 398s/epoch - 40ms/step
Epoch 12/50
9854/9854 - 398s - loss: 2.5668 - accuracy20: 0.5838 - val_loss: 3.1927 - val_accuracy20: 0.5289 - 398s/epoch - 40ms/step
Epoch 13/50
9854/9854 - 399s - loss: 2.5640 - accuracy20: 0.5843 - val_loss: 3.2150 - val_accuracy20: 0.5275 - 399s/epoch - 40ms/step
Epoch 14/50
9854/9854 - 402s - loss: 2.5610 - accuracy20: 0.5848 - val_loss: 3.2320 - val_accuracy20: 0.5283 - 402s/epoch - 41ms/step
Epoch 15/50
9854/9854 - 397s - loss: 2.5586 - accuracy20: 0.5854 - val_loss: 3.2265 - val_accuracy20: 0.5303 - 397s/epoch - 40ms/step
Epoch 16/50
9854/9854 - 397s - loss: 2.5562 - accuracy20: 0.5858 - val_loss: 3.1997 - val_accuracy20: 0.5317 - 397s/epoch - 40ms/step
Epoch 17/50
9854/9854 - 399s - loss: 2.5539 - accuracy20: 0.5862 - val_loss: 3.2427 - val_accuracy20: 0.5314 - 399s/epoch - 41ms/step
Epoch 18/50
9854/9854 - 399s - loss: 2.5517 - accuracy20: 0.5865 - val_loss: 3.2089 - val_accuracy20: 0.5338 - 399s/epoch - 41ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 310s - 310s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9899117
{'0': {'precision': 0.44128181378717374, 'recall': 0.40802779887578877, 'f1-score': 0.42400378961670554, 'support': 1465383}, '1': {'precision': 0.6171187631682291, 'recall': 0.6769589476204546, 'f1-score': 0.6456553033690566, 'support': 3140768}, '2': {'precision': 0.44432602329636756, 'recall': 0.3854689248573846, 'f1-score': 0.41281011620348596, 'support': 1465480}, 'accuracy': 0.5416971156514617, 'macro avg': {'precision': 0.5009088667505901, 'recall': 0.49015189045120927, 'f1-score': 0.4941564030630827, 'support': 6071631}, 'weighted avg': {'precision': 0.5329745223831296, 'recall': 0.5416971156514617, 'f1-score': 0.5359591895794732, 'support': 6071631}}
[[ 597917  645983  221483]
 [ 529620 2126171  484977]
 [ 227418  673165  564897]]
Evaluating performance on  train set...
9854/9854 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0008323
{'0': {'precision': 0.4753876887105984, 'recall': 0.38558225022207676, 'f1-score': 0.42580128864461597, 'support': 684448}, '1': {'precision': 0.561401226168767, 'recall': 0.7105442884382042, 'f1-score': 0.6272288084598991, 'support': 1153800}, '2': {'precision': 0.47843347830121075, 'recall': 0.3544315275143286, 'f1-score': 0.4072014248269373, 'support': 683771}, 'accuracy': 0.5258037310583307, 'macro avg': {'precision': 0.505074131060192, 'recall': 0.4835193553915365, 'f1-score': 0.48674384064381754, 'support': 2522019}, 'weighted avg': {'precision': 0.5155638499978042, 'recall': 0.5258037310583307, 'f1-score': 0.5129096827052458, 'support': 2522019}}
[[263911 319377 101160]
 [170935 819826 163039]
 [120303 321118 242350]]
Evaluating performance on  val set...
3566/3566 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99620837
{'0': {'precision': 0.49976717456013675, 'recall': 0.339257848448716, 'f1-score': 0.40415942723266524, 'support': 249922}, '1': {'precision': 0.5598913037437969, 'recall': 0.7299795925760448, 'f1-score': 0.6337211374562594, 'support': 414065}, '2': {'precision': 0.4634053755595433, 'recall': 0.3784712016588489, 'f1-score': 0.4166539231265333, 'support': 248365}, 'accuracy': 0.5272592157412929, 'macro avg': {'precision': 0.5076879512878256, 'recall': 0.4825695475612033, 'f1-score': 0.4848448292718193, 'support': 912352}, 'weighted avg': {'precision': 0.5171555283332965, 'recall': 0.5272592157412929, 'f1-score': 0.5117458248252754, 'support': 912352}}
[[ 84788 118520  46614]
 [ 49575 302259  62231]
 [ 35292 119074  93999]]
testing model out of sample: results/universal/W4/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 157s - 157s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0775849
{'0': {'precision': 0.4143684768754958, 'recall': 0.597281515978802, 'f1-score': 0.4892890501461577, 'support': 778375}, '1': {'precision': 0.675132869576524, 'recall': 0.44552004386711697, 'f1-score': 0.5368035402604473, 'support': 1491778}, '2': {'precision': 0.4362138583385211, 'recall': 0.5300221014354771, 'f1-score': 0.47856423378392715, 'support': 761489}, 'accuracy': 0.5057101069321509, 'macro avg': {'precision': 0.5085717349301803, 'recall': 0.5242745537604653, 'f1-score': 0.5015522747301774, 'support': 3031642}, 'weighted avg': {'precision': 0.5481697640656231, 'recall': 0.5057101069321509, 'f1-score': 0.5099756092276244, 'support': 3031642}}
[[464909 155536 157930]
 [463449 664617 363712]
 [193612 164271 403606]]
Evaluating performance on  train set...
5528/5528 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8254118
{'0': {'precision': 0.48811076447940904, 'recall': 0.44828808800559616, 'f1-score': 0.46735264735264737, 'support': 313071}, '1': {'precision': 0.7265681322343742, 'recall': 0.7792177833434522, 'f1-score': 0.7519725129457151, 'support': 788963}, '2': {'precision': 0.49139426141644793, 'recall': 0.44164772909131644, 'f1-score': 0.465194839784165, 'support': 312430}, 'accuracy': 0.631408081082304, 'macro avg': {'precision': 0.5686910527100771, 'recall': 0.5563845334801215, 'f1-score': 0.5615066666941758, 'support': 1414464}, 'weighted avg': {'precision': 0.621843332564634, 'recall': 0.631408081082304, 'f1-score': 0.6256319525871974, 'support': 1414464}}
[[140346 115806  56919]
 [ 88291 614774  85898]
 [ 58892 115554 137984]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85985494
{'0': {'precision': 0.5138834985710757, 'recall': 0.3879861481086841, 'f1-score': 0.44214744319475435, 'support': 112620}, '1': {'precision': 0.6933833291593908, 'recall': 0.7662111189036526, 'f1-score': 0.7279803196968714, 'support': 263785}, '2': {'precision': 0.46461200572472705, 'recall': 0.46413156853576953, 'f1-score': 0.46437166286565096, 'support': 111212}, 'accuracy': 0.6099602762003786, 'macro avg': {'precision': 0.5572929444850646, 'recall': 0.5394429451827021, 'f1-score': 0.5448331419190923, 'support': 487617}, 'weighted avg': {'precision': 0.5997496220846337, 'recall': 0.6099602762003786, 'f1-score': 0.60184250150107, 'support': 487617}}
[[ 43695  46831  22094]
 [ 24284 202115  37386]
 [ 17050  42545  51617]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1274467
{'0': {'precision': 0.485509225917004, 'recall': 0.3708059101340971, 'f1-score': 0.42047531992687387, 'support': 52723}, '1': {'precision': 0.2978685573311404, 'recall': 0.4212875644410914, 'f1-score': 0.3489876961135343, 'support': 31812}, '2': {'precision': 0.46227186052846636, 'recall': 0.4558414397820373, 'f1-score': 0.4590341309787177, 'support': 52119}, 'accuracy': 0.4149896819705241, 'macro avg': {'precision': 0.41521654792553697, 'recall': 0.41597830478574194, 'f1-score': 0.40949904900637524, 'support': 136654}, 'weighted avg': {'precision': 0.4329653326117317, 'recall': 0.4149896819705241, 'f1-score': 0.4185396457750824, 'support': 136654}}
[[19550 16135 17038]
 [ 7812 13402 10598]
 [12905 15456 23758]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2004762
{'0': {'precision': 0.39802960855592434, 'recall': 0.3652581705666215, 'f1-score': 0.38094037564603556, 'support': 20684}, '1': {'precision': 0.4222319645379707, 'recall': 0.3776577204600906, 'f1-score': 0.39870288171845175, 'support': 22952}, '2': {'precision': 0.4062770392511602, 'recall': 0.4849765258215962, 'f1-score': 0.44215212087488764, 'support': 21300}, 'accuracy': 0.40891031169151165, 'macro avg': {'precision': 0.40884620411501843, 'recall': 0.4092974722827695, 'f1-score': 0.4072651260797917, 'support': 64936}, 'weighted avg': {'precision': 0.4092893527395583, 'recall': 0.40891031169151165, 'f1-score': 0.40729702238665166, 'support': 64936}}
[[ 7555  5937  7192]
 [ 6380  8668  7904]
 [ 5046  5924 10330]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2072799
{'0': {'precision': 0.4012614506682685, 'recall': 0.38269836723002004, 'f1-score': 0.3917601348874716, 'support': 6982}, '1': {'precision': 0.37550054605023664, 'recall': 0.30662901307966706, 'f1-score': 0.33758795614465714, 'support': 6728}, '2': {'precision': 0.3936672967863894, 'recall': 0.4824091501375416, 'f1-score': 0.4335436861622536, 'support': 6907}, 'accuracy': 0.3912790415676384, 'macro avg': {'precision': 0.39014309783496487, 'recall': 0.39057884348240957, 'f1-score': 0.3876305923981274, 'support': 20617}, 'weighted avg': {'precision': 0.39031067280862564, 'recall': 0.3912790415676384, 'f1-score': 0.3880800926928392, 'support': 20617}}
[[2672 1731 2579]
 [2112 2063 2553]
 [1875 1700 3332]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
1613/1613 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3168999
{'0': {'precision': 0.2187516443041305, 'recall': 0.7168660415993102, 'f1-score': 0.33521304205407315, 'support': 46395}, '1': {'precision': 0.9306816768254758, 'recall': 0.3747843646780733, 'f1-score': 0.5343761229741825, 'support': 319405}, '2': {'precision': 0.2643794681696108, 'recall': 0.7427788050755595, 'f1-score': 0.38995949429237753, 'support': 47049}, 'accuracy': 0.4551639945839762, 'macro avg': {'precision': 0.47127092976640567, 'recall': 0.6114764037843143, 'f1-score': 0.41984955310687777, 'support': 412849}, 'weighted avg': {'precision': 0.7747436789766797, 'recall': 0.4551639945839762, 'f1-score': 0.49553667052997474, 'support': 412849}}
[[ 33259   4137   8999]
 [111458 119708  88239]
 [  7323   4779  34947]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63744557
{'0': {'precision': 0.45140763594292327, 'recall': 0.5452047137733477, 'f1-score': 0.49389227620835885, 'support': 21469}, '1': {'precision': 0.8732596177241883, 'recall': 0.8143246104976555, 'f1-score': 0.8427630291566107, 'support': 118998}, '2': {'precision': 0.45505951204080825, 'recall': 0.529858649109075, 'f1-score': 0.4896187882913547, 'support': 21719}, 'accuracy': 0.7406064641830984, 'macro avg': {'precision': 0.5932422552359733, 'recall': 0.6297959911266927, 'f1-score': 0.6087580312187748, 'support': 162186}, 'weighted avg': {'precision': 0.7614150177451562, 'recall': 0.7406064641830984, 'f1-score': 0.7492910527690155, 'support': 162186}}
[[11705  6785  2979]
 [11293 96903 10802]
 [ 2932  7279 11508]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55664456
{'0': {'precision': 0.5178493687418372, 'recall': 0.4370751423847143, 'f1-score': 0.4740460296901465, 'support': 5443}, '1': {'precision': 0.8917936288088643, 'recall': 0.8676725382616228, 'f1-score': 0.879567741620725, 'support': 41556}, '2': {'precision': 0.4117341640706127, 'recall': 0.5534810678764613, 'f1-score': 0.47219947897283215, 'support': 5731}, 'accuracy': 0.7890764270813578, 'macro avg': {'precision': 0.607125720540438, 'recall': 0.6194095828409328, 'f1-score': 0.6086044167612346, 'support': 52730}, 'weighted avg': {'precision': 0.8010179906529806, 'recall': 0.7890764270813578, 'f1-score': 0.7934330518563932, 'support': 52730}}
[[ 2379  2255   809]
 [ 1776 36057  3723]
 [  439  2120  3172]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1207819
{'0': {'precision': 0.4394664369124729, 'recall': 0.38917121953213346, 'f1-score': 0.41279246210095816, 'support': 73397}, '1': {'precision': 0.5151148454267318, 'recall': 0.62612050065218, 'f1-score': 0.5652190251907154, 'support': 108099}, '2': {'precision': 0.4321821202587578, 'recall': 0.3421152043428987, 'f1-score': 0.3819103326018539, 'support': 71473}, 'accuracy': 0.4771296087662915, 'macro avg': {'precision': 0.46225446753265415, 'recall': 0.45246897484240406, 'f1-score': 0.45330727329784254, 'support': 252969}, 'weighted avg': {'precision': 0.4697345146128706, 'recall': 0.4771296087662915, 'f1-score': 0.4692022221970576, 'support': 252969}}
[[28564 31030 13803]
 [22093 67683 18323]
 [14340 32681 24452]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1699034
{'0': {'precision': 0.46113007205157375, 'recall': 0.42350154982063876, 'f1-score': 0.4415155311076012, 'support': 28713}, '1': {'precision': 0.4308536825521859, 'recall': 0.6080175079028728, 'f1-score': 0.5043292849836482, 'support': 28787}, '2': {'precision': 0.47007366482504603, 'recall': 0.316403828937401, 'f1-score': 0.3782259724223091, 'support': 29042}, 'accuracy': 0.44893808786485173, 'macro avg': {'precision': 0.4540191398096019, 'recall': 0.44930762888697084, 'f1-score': 0.4413569295045195, 'support': 86542}, 'weighted avg': {'precision': 0.45406036482049866, 'recall': 0.44893808786485173, 'f1-score': 0.44117077560728357, 'support': 86542}}
[[12160 10945  5608]
 [ 6533 17503  4751]
 [ 7677 12176  9189]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2036548
{'0': {'precision': 0.4805734923935646, 'recall': 0.40089473203688486, 'f1-score': 0.4371329019412643, 'support': 10953}, '1': {'precision': 0.36919994830037484, 'recall': 0.6127198627198627, 'f1-score': 0.46076296475522216, 'support': 9324}, '2': {'precision': 0.4885132206328565, 'recall': 0.3003998223011995, 'f1-score': 0.3720290492957746, 'support': 11255}, 'accuracy': 0.42766078903970567, 'macro avg': {'precision': 0.4460955537755987, 'recall': 0.43800480568598227, 'f1-score': 0.42330830533075375, 'support': 31532}, 'weighted avg': {'precision': 0.4504743777230182, 'recall': 0.42766078903970567, 'f1-score': 0.42088219929482124, 'support': 31532}}
[[4391 4571 1991]
 [2062 5713 1549]
 [2684 5190 3381]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
925/925 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3037937
{'0': {'precision': 0.3345641822952094, 'recall': 0.5320885666919554, 'f1-score': 0.41081685007511703, 'support': 71178}, '1': {'precision': 0.5076204300099791, 'recall': 0.2190105287878195, 'f1-score': 0.3059991250136717, 'support': 102196}, '2': {'precision': 0.33931562574778656, 'recall': 0.42548957675300064, 'f1-score': 0.3775478030563127, 'support': 63320}, 'accuracy': 0.3683954810852831, 'macro avg': {'precision': 0.39383341268432503, 'recall': 0.3921962240775918, 'f1-score': 0.36478792604836713, 'support': 236694}, 'weighted avg': {'precision': 0.41055477644155786, 'recall': 0.3683954810852831, 'f1-score': 0.3566602246954701, 'support': 236694}}
[[37873 11132 22173]
 [49528 22382 30286]
 [25800 10578 26942]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3110052
{'0': {'precision': 0.37532821402031213, 'recall': 0.5079279943682746, 'f1-score': 0.43167476246777114, 'support': 29831}, '1': {'precision': 0.3416686898114429, 'recall': 0.14431227782335249, 'f1-score': 0.2029173575565328, 'support': 29256}, '2': {'precision': 0.37351784169851854, 'recall': 0.45409218871892276, 'f1-score': 0.4098827419404219, 'support': 29483}, 'accuracy': 0.3698995145082985, 'macro avg': {'precision': 0.3635049151767578, 'recall': 0.36877748697018325, 'f1-score': 0.34815828732157533, 'support': 88570}, 'weighted avg': {'precision': 0.36360733508367316, 'recall': 0.3698995145082985, 'f1-score': 0.3488586759905099, 'support': 88570}}
[[15152  4010 10669]
 [13248  4222 11786]
 [11970  4125 13388]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2836304
{'0': {'precision': 0.39670089754993126, 'recall': 0.4525830258302583, 'f1-score': 0.42280346447192657, 'support': 10840}, '1': {'precision': 0.385880465302848, 'recall': 0.17419646899049343, 'f1-score': 0.24003493231863268, 'support': 11045}, '2': {'precision': 0.35292934709746615, 'recall': 0.5069324090121318, 'f1-score': 0.41613974075245025, 'support': 10386}, 'accuracy': 0.37479470732236375, 'macro avg': {'precision': 0.3785035699834151, 'recall': 0.37790396794429454, 'f1-score': 0.35965937918100316, 'support': 32271}, 'weighted avg': {'precision': 0.37891021869993163, 'recall': 0.37479470732236375, 'f1-score': 0.35810488456477735, 'support': 32271}}
[[4906 1524 4410]
 [3878 1924 5243]
 [3583 1538 5265]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1845537
{'0': {'precision': 0.44331237231022314, 'recall': 0.3999712733105116, 'f1-score': 0.42052805114394304, 'support': 125319}, '1': {'precision': 0.47354620427151617, 'recall': 0.5560342151982023, 'f1-score': 0.511485819024833, 'support': 161098}, '2': {'precision': 0.4164057727550397, 'recall': 0.36180729486307617, 'f1-score': 0.3871912525627258, 'support': 120578}, 'accuracy': 0.4504379660683792, 'macro avg': {'precision': 0.44442144977892634, 'recall': 0.4392709277905967, 'f1-score': 0.4397350409105007, 'support': 406995}, 'weighted avg': {'precision': 0.44730816071090496, 'recall': 0.4504379660683792, 'f1-score': 0.4466547357242195, 'support': 406995}}
[[50124 48622 26573]
 [36953 89576 34569]
 [25990 50962 43626]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1986729
{'0': {'precision': 0.44437959360138346, 'recall': 0.44728024369016534, 'f1-score': 0.44582520060724357, 'support': 45960}, '1': {'precision': 0.41871347263073455, 'recall': 0.481221327128652, 'f1-score': 0.44779655823928916, 'support': 45557}, '2': {'precision': 0.45361194335612404, 'recall': 0.38381868608077657, 'f1-score': 0.4158069551541612, 'support': 46152}, 'accuracy': 0.437237141259107, 'macro avg': {'precision': 0.4389016698627473, 'recall': 0.437440085633198, 'f1-score': 0.43647623800023133, 'support': 137669}, 'weighted avg': {'precision': 0.4389812826731493, 'recall': 0.437237141259107, 'f1-score': 0.43641427349578377, 'support': 137669}}
[[20557 14929 10474]
 [12771 21923 10863]
 [12932 15506 17714]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2174805
{'0': {'precision': 0.444150417827298, 'recall': 0.37044781320787595, 'f1-score': 0.4039649111695221, 'support': 17217}, '1': {'precision': 0.42090329782780594, 'recall': 0.475962549968441, 'f1-score': 0.4467428599639604, 'support': 19012}, '2': {'precision': 0.4191005501049169, 'recall': 0.4280831836876557, 'f1-score': 0.4235442457588262, 'support': 17263}, 'accuracy': 0.426549764450759, 'macro avg': {'precision': 0.42805142192000695, 'recall': 0.4248311822879909, 'f1-score': 0.4247506722974362, 'support': 53492}, 'weighted avg': {'precision': 0.42780385924055964, 'recall': 0.426549764450759, 'f1-score': 0.4254876139193729, 'support': 53492}}
[[6378 6222 4617]
 [4337 9049 5626]
 [3645 6228 7390]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78208107
{'0': {'precision': 0.4280374739090335, 'recall': 0.627765948496243, 'f1-score': 0.5090101909089955, 'support': 154513}, '1': {'precision': 0.8801191454396056, 'recall': 0.658961084503013, 'f1-score': 0.7536504664118391, 'support': 650178}, '2': {'precision': 0.42800177574536125, 'recall': 0.6672996000269507, 'f1-score': 0.5215101890369122, 'support': 163261}, 'accuracy': 0.655387870472916, 'macro avg': {'precision': 0.5787194650313334, 'recall': 0.6513422110087356, 'f1-score': 0.5947236154525822, 'support': 967952}, 'weighted avg': {'precision': 0.7316968794523919, 'recall': 0.655387870472916, 'f1-score': 0.6754445670353424, 'support': 967952}}
[[ 96998  28977  28538]
 [104677 428442 117059]
 [ 24936  29381 108944]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70494545
{'0': {'precision': 0.5084296224543924, 'recall': 0.5644965111068434, 'f1-score': 0.534998149530102, 'support': 78105}, '1': {'precision': 0.8297467233439604, 'recall': 0.7379999684935176, 'f1-score': 0.7811887709585705, 'support': 253916}, '2': {'precision': 0.49765417618371505, 'recall': 0.6222613886351649, 'f1-score': 0.5530255823924539, 'support': 77731}, 'accuracy': 0.6829716511450828, 'macro avg': {'precision': 0.6119435073273559, 'recall': 0.6415859560785085, 'f1-score': 0.6230708342937088, 'support': 409752}, 'weighted avg': {'precision': 0.7054999644549429, 'recall': 0.6829716511450828, 'f1-score': 0.6909779329465454, 'support': 409752}}
[[ 44090  20079  13936]
 [ 31637 187390  34889]
 [ 10991  18371  48369]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65771216
{'0': {'precision': 0.5102855513462871, 'recall': 0.5457198867349161, 'f1-score': 0.5274082182553048, 'support': 22955}, '1': {'precision': 0.8525322076373767, 'recall': 0.7742509280537387, 'f1-score': 0.8115081088279401, 'support': 90512}, '2': {'precision': 0.48391594124047876, 'recall': 0.6271649552686087, 'f1-score': 0.5463060711338029, 'support': 22691}, 'accuracy': 0.7112105054422069, 'macro avg': {'precision': 0.6155779000747141, 'recall': 0.6490452566857545, 'f1-score': 0.6284074660723493, 'support': 136158}, 'weighted avg': {'precision': 0.7334019053710833, 'recall': 0.7112105054422069, 'f1-score': 0.7194150079788346, 'support': 136158}}
[[12527  6496  3932]
 [ 9188 70079 11245]
 [ 2834  5626 14231]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
4457/4457 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92957187
{'0': {'precision': 0.40627698746655116, 'recall': 0.7084850230917646, 'f1-score': 0.5164172408471834, 'support': 229086}, '1': {'precision': 0.8356351244084517, 'recall': 0.5224595474907655, 'f1-score': 0.6429383135054781, 'support': 687102}, '2': {'precision': 0.43420921843687377, 'recall': 0.6024754083044521, 'f1-score': 0.5046865158782513, 'support': 224771}, 'accuracy': 0.5755737059789178, 'macro avg': {'precision': 0.5587071101039588, 'recall': 0.6111399929623275, 'f1-score': 0.554680690076971, 'support': 1140959}, 'weighted avg': {'precision': 0.6703453633647948, 'recall': 0.5755737059789178, 'f1-score': 0.5902990852286798, 'support': 1140959}}
[[162304  32596  34186]
 [185849 358983 142270]
 [ 51338  38014 135419]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6598719
{'0': {'precision': 0.5024374813932718, 'recall': 0.5155162703677896, 'f1-score': 0.5088928569745913, 'support': 104761}, '1': {'precision': 0.8225211720418187, 'recall': 0.8261148454840982, 'f1-score': 0.8243140920437213, 'support': 413129}, '2': {'precision': 0.5082540812693892, 'recall': 0.48585763318327224, 'f1-score': 0.4968035712510315, 'support': 102847}, 'accuracy': 0.7173198955435233, 'macro avg': {'precision': 0.61107091156816, 'recall': 0.6091629163450533, 'f1-score': 0.610003506756448, 'support': 620737}, 'weighted avg': {'precision': 0.7164316123720963, 'recall': 0.7173198955435233, 'f1-score': 0.7168171673573518, 'support': 620737}}
[[ 54006  36718  14037]
 [ 37528 341292  34309]
 [ 15954  36924  49969]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68392277
{'0': {'precision': 0.5465804320902711, 'recall': 0.44935939135107617, 'f1-score': 0.49322467986030266, 'support': 35357}, '1': {'precision': 0.820361933687674, 'recall': 0.7900068550536979, 'f1-score': 0.804898301270361, 'support': 131290}, '2': {'precision': 0.45409212195442017, 'recall': 0.6004916847433116, 'f1-score': 0.5171301543021533, 'support': 34575}, 'accuracy': 0.697587738915228, 'macro avg': {'precision': 0.6070114959107884, 'recall': 0.6132859770493618, 'f1-score': 0.6050843784776055, 'support': 201222}, 'weighted avg': {'precision': 0.7093210371025261, 'recall': 0.697587738915228, 'f1-score': 0.7006878873314218, 'support': 201222}}
[[ 15888  12866   6603]
 [  9213 103720  18357]
 [  3967   9846  20762]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73453945
{'0': {'precision': 0.5636716257179324, 'recall': 0.45315681464736346, 'f1-score': 0.50240852493401, 'support': 249492}, '1': {'precision': 0.7298924847424646, 'recall': 0.8541952105260888, 'f1-score': 0.7871668551283096, 'support': 695567}, '2': {'precision': 0.5658619763253266, 'recall': 0.4096653832413766, 'f1-score': 0.475258968638259, 'support': 251930}, 'accuracy': 0.6770454866335447, 'macro avg': {'precision': 0.6198086955952412, 'recall': 0.5723391361382762, 'f1-score': 0.5882781162335262, 'support': 1196989}, 'weighted avg': {'precision': 0.6607231101322734, 'recall': 0.6770454866335447, 'f1-score': 0.6621666427953019, 'support': 1196989}}
[[113059 104157  32276]
 [ 54511 594150  46906]
 [ 33006 115717 103207]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7343566
{'0': {'precision': 0.5312941552844156, 'recall': 0.5257206169430717, 'f1-score': 0.5284926917450088, 'support': 113722}, '1': {'precision': 0.7895466432461838, 'recall': 0.7705398291505823, 'f1-score': 0.779927454481005, 'support': 312673}, '2': {'precision': 0.5174971659519937, 'recall': 0.5574265135292973, 'f1-score': 0.536720227648372, 'support': 113014}, 'accuracy': 0.6742749935577641, 'macro avg': {'precision': 0.6127793214941977, 'recall': 0.6178956532076504, 'f1-score': 0.615046791291462, 'support': 539409}, 'weighted avg': {'precision': 0.6781017302712171, 'recall': 0.6742749935577641, 'f1-score': 0.6759627716130399, 'support': 539409}}
[[ 59786  32731  21205]
 [ 34214 240927  37532]
 [ 18529  31488  62997]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7706462
{'0': {'precision': 0.5261087662696395, 'recall': 0.5113292240286935, 'f1-score': 0.5186137190406692, 'support': 46561}, '1': {'precision': 0.7626651631853192, 'recall': 0.751606398709504, 'f1-score': 0.7570953997255724, 'support': 111585}, '2': {'precision': 0.5227778571866131, 'recall': 0.555997133363737, 'f1-score': 0.5388760260997685, 'support': 46047}, 'accuracy': 0.6527060183257997, 'macro avg': {'precision': 0.6038505955471906, 'recall': 0.6063109187006449, 'f1-score': 0.6048617149553367, 'support': 204193}, 'weighted avg': {'precision': 0.6546281923973227, 'recall': 0.6527060183257997, 'f1-score': 0.6535056927732421, 'support': 204193}}
[[23808 13639  9114]
 [13460 83868 14257]
 [ 7985 12460 25602]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
4274/4274 - 59s - 59s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1759715
{'0': {'precision': 0.4051244061710545, 'recall': 0.6848581500755414, 'f1-score': 0.5090957644610051, 'support': 297850}, '1': {'precision': 0.7133162848329863, 'recall': 0.26859810152342717, 'f1-score': 0.39024868675737967, 'support': 503667}, '2': {'precision': 0.43946340465654604, 'recall': 0.6022259595006632, 'f1-score': 0.508128967504319, 'support': 292548}, 'accuracy': 0.4711319711351702, 'macro avg': {'precision': 0.5193013652201955, 'recall': 0.5185607370332106, 'f1-score': 0.46915780624090125, 'support': 1094065}, 'weighted avg': {'precision': 0.5561866230219298, 'recall': 0.4711319711351702, 'f1-score': 0.45412445507642873, 'support': 1094065}}
[[203985  27246  66619]
 [210284 135284 158099]
 [ 89243  27125 176180]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8205146
{'0': {'precision': 0.5221580180631071, 'recall': 0.40640797499845066, 'f1-score': 0.45706860758611423, 'support': 112953}, '1': {'precision': 0.7094264474094022, 'recall': 0.8095807394323217, 'f1-score': 0.7562018044966541, 'support': 278538}, '2': {'precision': 0.5160265168766763, 'recall': 0.4508484467985392, 'f1-score': 0.4812406203101551, 'support': 113089}, 'accuracy': 0.6389274247889334, 'macro avg': {'precision': 0.5825369941163951, 'recall': 0.5556123870764372, 'f1-score': 0.5648370107976411, 'support': 504580}, 'weighted avg': {'precision': 0.6241596202581724, 'recall': 0.6389274247889334, 'f1-score': 0.6276135184981936, 'support': 504580}}
[[ 45905  47306  19742]
 [ 24962 225499  28077]
 [ 17047  45056  50986]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84928566
{'0': {'precision': 0.5562677232645767, 'recall': 0.34005366768777756, 'f1-score': 0.4220827069885342, 'support': 42111}, '1': {'precision': 0.6659158975363347, 'recall': 0.8375363077459946, 'f1-score': 0.7419307911916062, 'support': 97431}, '2': {'precision': 0.5192793347705574, 'recall': 0.4091284092012035, 'f1-score': 0.4576694443690454, 'support': 41212}, 'accuracy': 0.623958529271828, 'macro avg': {'precision': 0.5804876518571563, 'recall': 0.5289061282116586, 'f1-score': 0.5405609808497286, 'support': 180754}, 'weighted avg': {'precision': 0.6069375054041484, 'recall': 0.623958529271828, 'f1-score': 0.6026027470037767, 'support': 180754}}
[[14320 21455  6336]
 [ 6556 81602  9273]
 [ 4867 19484 16861]]
testing model on single stock: results/universal/W4/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
12724/12724 - 171s - 171s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0811936
{'0': {'precision': 0.4781006038403158, 'recall': 0.33573142757243285, 'f1-score': 0.39446321121549544, 'support': 943805}, '1': {'precision': 0.487494901986247, 'recall': 0.6997310367825766, 'f1-score': 0.5746426220215511, 'support': 1373422}, '2': {'precision': 0.46643917737904733, 'recall': 0.3091826963996936, 'f1-score': 0.37186914769669976, 'support': 939920}, 'accuracy': 0.4815557910035992, 'macro avg': {'precision': 0.47734489440187006, 'recall': 0.448215053584901, 'f1-score': 0.44699166031124876, 'support': 3257147}, 'weighted avg': {'precision': 0.4786966861751646, 'recall': 0.4815557910035992, 'f1-score': 0.4639183983978634, 'support': 3257147}}
[[316865 497500 129440]
 [209410 961026 202986]
 [136483 512830 290607]]
Evaluating performance on  train set...
5165/5165 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.22491
{'0': {'precision': 0.46073915779718805, 'recall': 0.3019185581470177, 'f1-score': 0.3647919618351437, 'support': 441321}, '1': {'precision': 0.3606182232221927, 'recall': 0.6623587276202453, 'f1-score': 0.46698731050278547, 'support': 438957}, '2': {'precision': 0.4690111266996673, 'recall': 0.2406093829217064, 'f1-score': 0.3180530332722002, 'support': 441824}, 'accuracy': 0.40110142787772807, 'macro avg': {'precision': 0.43012283590634937, 'recall': 0.4016288895629898, 'f1-score': 0.3832774352033765, 'support': 1322102}, 'weighted avg': {'precision': 0.43026190968027483, 'recall': 0.40110142787772807, 'f1-score': 0.38310294184402954, 'support': 1322102}}
[[133243 255776  52302]
 [ 80157 290747  68053]
 [ 75794 259723 106307]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2146221
{'0': {'precision': 0.49527676699520445, 'recall': 0.25045240459898976, 'f1-score': 0.33267642452765284, 'support': 164123}, '1': {'precision': 0.3648219775860359, 'recall': 0.6924582881023047, 'f1-score': 0.47787518647546745, 'support': 159367}, '2': {'precision': 0.4464123881949643, 'recall': 0.27715736040609135, 'f1-score': 0.3419890878630775, 'support': 163510}, 'accuracy': 0.4040616016427105, 'macro avg': {'precision': 0.4355037109254016, 'recall': 0.40668935103579523, 'f1-score': 0.3841802329553993, 'support': 487000}, 'weighted avg': {'precision': 0.4361802515919227, 'recall': 0.4040616016427105, 'f1-score': 0.3833183232490341, 'support': 487000}}
[[ 41105  94635  28383]
 [ 21197 110355  27815]
 [ 20692  97500  45318]]
training model: results/universal/W4/deepLOB_L2/h30
Epoch 1/50
9854/9854 - 404s - loss: 2.8949 - accuracy30: 0.5092 - val_loss: 3.2843 - val_accuracy30: 0.4674 - 404s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 397s - loss: 2.7765 - accuracy30: 0.5397 - val_loss: 3.3145 - val_accuracy30: 0.4831 - 397s/epoch - 40ms/step
Epoch 3/50
9854/9854 - 397s - loss: 2.7397 - accuracy30: 0.5474 - val_loss: 3.3232 - val_accuracy30: 0.4820 - 397s/epoch - 40ms/step
Epoch 4/50
9854/9854 - 402s - loss: 2.7211 - accuracy30: 0.5511 - val_loss: 3.2661 - val_accuracy30: 0.4891 - 402s/epoch - 41ms/step
Epoch 5/50
9854/9854 - 398s - loss: 2.7107 - accuracy30: 0.5529 - val_loss: 3.2949 - val_accuracy30: 0.4888 - 398s/epoch - 40ms/step
Epoch 6/50
9854/9854 - 399s - loss: 2.7025 - accuracy30: 0.5547 - val_loss: 3.3106 - val_accuracy30: 0.4893 - 399s/epoch - 41ms/step
Epoch 7/50
9854/9854 - 399s - loss: 2.6960 - accuracy30: 0.5561 - val_loss: 3.3108 - val_accuracy30: 0.4909 - 399s/epoch - 40ms/step
Epoch 8/50
9854/9854 - 399s - loss: 2.6913 - accuracy30: 0.5569 - val_loss: 3.2855 - val_accuracy30: 0.4916 - 399s/epoch - 40ms/step
Epoch 9/50
9854/9854 - 399s - loss: 2.6869 - accuracy30: 0.5578 - val_loss: 3.2802 - val_accuracy30: 0.4918 - 399s/epoch - 41ms/step
Epoch 10/50
9854/9854 - 398s - loss: 2.6834 - accuracy30: 0.5586 - val_loss: 3.2798 - val_accuracy30: 0.4909 - 398s/epoch - 40ms/step
Epoch 11/50
9854/9854 - 400s - loss: 2.6802 - accuracy30: 0.5592 - val_loss: 3.2869 - val_accuracy30: 0.4926 - 400s/epoch - 41ms/step
Epoch 12/50
9854/9854 - 400s - loss: 2.6771 - accuracy30: 0.5601 - val_loss: 3.2427 - val_accuracy30: 0.4939 - 400s/epoch - 41ms/step
Epoch 13/50
9854/9854 - 398s - loss: 2.6743 - accuracy30: 0.5605 - val_loss: 3.2632 - val_accuracy30: 0.4935 - 398s/epoch - 40ms/step
Epoch 14/50
9854/9854 - 399s - loss: 2.6718 - accuracy30: 0.5610 - val_loss: 3.2325 - val_accuracy30: 0.4948 - 399s/epoch - 41ms/step
Epoch 15/50
9854/9854 - 401s - loss: 2.6693 - accuracy30: 0.5616 - val_loss: 3.2202 - val_accuracy30: 0.4952 - 401s/epoch - 41ms/step
Epoch 16/50
9854/9854 - 398s - loss: 2.6674 - accuracy30: 0.5619 - val_loss: 3.2377 - val_accuracy30: 0.4954 - 398s/epoch - 40ms/step
Epoch 17/50
9854/9854 - 399s - loss: 2.6653 - accuracy30: 0.5624 - val_loss: 3.2323 - val_accuracy30: 0.4962 - 399s/epoch - 40ms/step
Epoch 18/50
9854/9854 - 397s - loss: 2.6633 - accuracy30: 0.5628 - val_loss: 3.2385 - val_accuracy30: 0.4964 - 397s/epoch - 40ms/step
Epoch 19/50
9854/9854 - 397s - loss: 2.6607 - accuracy30: 0.5634 - val_loss: 3.2309 - val_accuracy30: 0.4973 - 397s/epoch - 40ms/step
Epoch 20/50
9854/9854 - 403s - loss: 2.6592 - accuracy30: 0.5637 - val_loss: 3.2272 - val_accuracy30: 0.4970 - 403s/epoch - 41ms/step
Epoch 21/50
9854/9854 - 398s - loss: 2.6576 - accuracy30: 0.5640 - val_loss: 3.1995 - val_accuracy30: 0.4995 - 398s/epoch - 40ms/step
Epoch 22/50
9854/9854 - 398s - loss: 2.6559 - accuracy30: 0.5644 - val_loss: 3.2133 - val_accuracy30: 0.4995 - 398s/epoch - 40ms/step
Epoch 23/50
9854/9854 - 400s - loss: 2.6543 - accuracy30: 0.5647 - val_loss: 3.2219 - val_accuracy30: 0.4984 - 400s/epoch - 41ms/step
Epoch 24/50
9854/9854 - 398s - loss: 2.6527 - accuracy30: 0.5652 - val_loss: 3.2272 - val_accuracy30: 0.4992 - 398s/epoch - 40ms/step
Epoch 25/50
9854/9854 - 398s - loss: 2.6513 - accuracy30: 0.5657 - val_loss: 3.1819 - val_accuracy30: 0.5023 - 398s/epoch - 40ms/step
Epoch 26/50
9854/9854 - 399s - loss: 2.6497 - accuracy30: 0.5658 - val_loss: 3.2058 - val_accuracy30: 0.4998 - 399s/epoch - 40ms/step
Epoch 27/50
9854/9854 - 397s - loss: 2.6481 - accuracy30: 0.5662 - val_loss: 3.2272 - val_accuracy30: 0.4979 - 397s/epoch - 40ms/step
Epoch 28/50
9854/9854 - 397s - loss: 2.6464 - accuracy30: 0.5665 - val_loss: 3.2011 - val_accuracy30: 0.4997 - 397s/epoch - 40ms/step
Epoch 29/50
9854/9854 - 403s - loss: 2.6451 - accuracy30: 0.5669 - val_loss: 3.1918 - val_accuracy30: 0.5001 - 403s/epoch - 41ms/step
Epoch 30/50
9854/9854 - 400s - loss: 2.6439 - accuracy30: 0.5673 - val_loss: 3.2070 - val_accuracy30: 0.5009 - 400s/epoch - 41ms/step
Epoch 31/50
9854/9854 - 399s - loss: 2.6422 - accuracy30: 0.5675 - val_loss: 3.2068 - val_accuracy30: 0.5011 - 399s/epoch - 40ms/step
Epoch 32/50
9854/9854 - 399s - loss: 2.6411 - accuracy30: 0.5677 - val_loss: 3.2025 - val_accuracy30: 0.5020 - 399s/epoch - 41ms/step
Epoch 33/50
9854/9854 - 399s - loss: 2.6397 - accuracy30: 0.5680 - val_loss: 3.1954 - val_accuracy30: 0.5012 - 399s/epoch - 40ms/step
Epoch 34/50
9854/9854 - 399s - loss: 2.6382 - accuracy30: 0.5684 - val_loss: 3.2068 - val_accuracy30: 0.5008 - 399s/epoch - 41ms/step
Epoch 35/50
9854/9854 - 398s - loss: 2.6376 - accuracy30: 0.5685 - val_loss: 3.1799 - val_accuracy30: 0.5027 - 398s/epoch - 40ms/step
Epoch 36/50
9854/9854 - 401s - loss: 2.6358 - accuracy30: 0.5688 - val_loss: 3.2031 - val_accuracy30: 0.4999 - 401s/epoch - 41ms/step
Epoch 37/50
9854/9854 - 400s - loss: 2.6347 - accuracy30: 0.5692 - val_loss: 3.1908 - val_accuracy30: 0.5027 - 400s/epoch - 41ms/step
Epoch 38/50
9854/9854 - 398s - loss: 2.6333 - accuracy30: 0.5695 - val_loss: 3.1840 - val_accuracy30: 0.5022 - 398s/epoch - 40ms/step
Epoch 39/50
9854/9854 - 401s - loss: 2.6322 - accuracy30: 0.5696 - val_loss: 3.2229 - val_accuracy30: 0.5014 - 401s/epoch - 41ms/step
Epoch 40/50
9854/9854 - 402s - loss: 2.6309 - accuracy30: 0.5699 - val_loss: 3.1828 - val_accuracy30: 0.5035 - 402s/epoch - 41ms/step
Epoch 41/50
9854/9854 - 398s - loss: 2.6298 - accuracy30: 0.5700 - val_loss: 3.2033 - val_accuracy30: 0.5019 - 398s/epoch - 40ms/step
Epoch 42/50
9854/9854 - 400s - loss: 2.6286 - accuracy30: 0.5702 - val_loss: 3.1981 - val_accuracy30: 0.5029 - 400s/epoch - 41ms/step
Epoch 43/50
9854/9854 - 400s - loss: 2.6273 - accuracy30: 0.5705 - val_loss: 3.1728 - val_accuracy30: 0.5050 - 400s/epoch - 41ms/step
Epoch 44/50
9854/9854 - 398s - loss: 2.6261 - accuracy30: 0.5710 - val_loss: 3.1959 - val_accuracy30: 0.5028 - 398s/epoch - 40ms/step
Epoch 45/50
9854/9854 - 398s - loss: 2.6250 - accuracy30: 0.5709 - val_loss: 3.1910 - val_accuracy30: 0.5038 - 398s/epoch - 40ms/step
Epoch 46/50
9854/9854 - 401s - loss: 2.6236 - accuracy30: 0.5713 - val_loss: 3.1833 - val_accuracy30: 0.5044 - 401s/epoch - 41ms/step
Epoch 47/50
9854/9854 - 402s - loss: 2.6227 - accuracy30: 0.5715 - val_loss: 3.1900 - val_accuracy30: 0.5042 - 402s/epoch - 41ms/step
Epoch 48/50
9854/9854 - 398s - loss: 2.6216 - accuracy30: 0.5717 - val_loss: 3.2145 - val_accuracy30: 0.5015 - 398s/epoch - 40ms/step
Epoch 49/50
9854/9854 - 402s - loss: 2.6201 - accuracy30: 0.5719 - val_loss: 3.2131 - val_accuracy30: 0.5021 - 402s/epoch - 41ms/step
Epoch 50/50
9854/9854 - 399s - loss: 2.6193 - accuracy30: 0.5721 - val_loss: 3.2433 - val_accuracy30: 0.5016 - 399s/epoch - 40ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 316s - 316s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0829203
{'0': {'precision': 0.40020503581906086, 'recall': 0.5137789465210508, 'f1-score': 0.44993550361590984, 'support': 1565214}, '1': {'precision': 0.5767205543303773, 'recall': 0.6271020160761686, 'f1-score': 0.600857021996202, 'support': 2936645}, '2': {'precision': 0.4382122802172512, 'recall': 0.24259828815904474, 'f1-score': 0.3123028753343841, 'support': 1569772}, 'accuracy': 0.4984779213361286, 'macro avg': {'precision': 0.47171262345556314, 'recall': 0.46115975025208805, 'f1-score': 0.45436513364883196, 'support': 6071631}, 'weighted avg': {'precision': 0.4954061642987232, 'recall': 0.4984779213361286, 'f1-score': 0.4873473746899501, 'support': 6071631}}
[[ 804174  616251  144789]
 [ 751642 1841576  343427]
 [ 453589  735359  380824]]
Evaluating performance on  train set...
9854/9854 - 135s - 135s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0794489
{'0': {'precision': 0.4434396975110702, 'recall': 0.455962746892239, 'f1-score': 0.44961403833486663, 'support': 724557}, '1': {'precision': 0.5358829164749784, 'recall': 0.6716493265631012, 'f1-score': 0.5961338126450999, 'support': 1073523}, '2': {'precision': 0.478195777973993, 'recall': 0.285025395786109, 'f1-score': 0.35716498851517775, 'support': 723939}, 'accuracy': 0.4987048075371359, 'macro avg': {'precision': 0.48583946398668054, 'recall': 0.4708791564138164, 'f1-score': 0.4676376131650481, 'support': 2522019}, 'weighted avg': {'precision': 0.49276573505719473, 'recall': 0.4987048075371359, 'f1-score': 0.4854444087640462, 'support': 2522019}}
[[330371 300975  93211]
 [220545 721031 131947]
 [194103 323495 206341]]
Evaluating performance on  val set...
3566/3566 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0309067
{'0': {'precision': 0.4598897459775209, 'recall': 0.3532670025285272, 'f1-score': 0.39958808028972836, 'support': 261417}, '1': {'precision': 0.5604168332515717, 'recall': 0.6623940902554095, 'f1-score': 0.6071532258819784, 'support': 391489}, '2': {'precision': 0.43714632499517714, 'recall': 0.4192356020135211, 'f1-score': 0.42800366739988427, 'support': 259446}, 'accuracy': 0.5046725386692855, 'macro avg': {'precision': 0.4858176347414232, 'recall': 0.47829889826581923, 'f1-score': 0.47824832452386373, 'support': 912352}, 'weighted avg': {'precision': 0.49655822400973404, 'recall': 0.5046725386692855, 'f1-score': 0.496734556316685, 'support': 912352}}
[[ 92350 101275  67792]
 [ 59914 259320  72255]
 [ 48545 102132 108769]]
testing model out of sample: results/universal/W4/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 158s - 158s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1521509
{'0': {'precision': 0.42866635603368786, 'recall': 0.5522670264627566, 'f1-score': 0.48267965595963036, 'support': 867899}, '1': {'precision': 0.6366059009613373, 'recall': 0.39320448138382796, 'f1-score': 0.48614055058048106, 'support': 1315308}, '2': {'precision': 0.41855533405686207, 'recall': 0.5431942340898243, 'f1-score': 0.4727984324346506, 'support': 848435}, 'accuracy': 0.4807170503641261, 'macro avg': {'precision': 0.4946091970172957, 'recall': 0.49622191397880294, 'f1-score': 0.4805395463249207, 'support': 3031642}, 'weighted avg': {'precision': 0.5160533238975678, 'recall': 0.4807170503641261, 'f1-score': 0.4814158413339409, 'support': 3031642}}
[[479312 140134 248453]
 [406356 517185 391767]
 [232479 155091 460865]]
Evaluating performance on  train set...
5528/5528 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9038342
{'0': {'precision': 0.4609106742970888, 'recall': 0.4764090151824726, 'f1-score': 0.4685317141921695, 'support': 349943}, '1': {'precision': 0.6746323392392609, 'recall': 0.7601562171922899, 'f1-score': 0.7148453543108079, 'support': 714390}, '2': {'precision': 0.49606941081517353, 'recall': 0.35108573648148833, 'f1-score': 0.41117118864885743, 'support': 350131}, 'accuracy': 0.5886964956336818, 'macro avg': {'precision': 0.5438708081171745, 'recall': 0.5292169896187503, 'f1-score': 0.5315160857172783, 'support': 1414464}, 'weighted avg': {'precision': 0.5775561200587709, 'recall': 0.5886964956336818, 'f1-score': 0.5787362179443672, 'support': 1414464}}
[[166716 125733  57494]
 [103962 543048  67380]
 [ 91032 136173 122926]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9224287
{'0': {'precision': 0.49287037309264103, 'recall': 0.4002897189566934, 'f1-score': 0.4417818146680839, 'support': 125639}, '1': {'precision': 0.6566118138420223, 'recall': 0.7178861788617886, 'f1-score': 0.68588320759539, 'support': 237390}, '2': {'precision': 0.46048319911135793, 'recall': 0.46583138022923554, 'f1-score': 0.46314185050853274, 'support': 124588}, 'accuracy': 0.5716535723733996, 'macro avg': {'precision': 0.536655128682007, 'recall': 0.5280024260159059, 'f1-score': 0.5302689575906688, 'support': 487617}, 'weighted avg': {'precision': 0.5643107194864614, 'recall': 0.5716535723733996, 'f1-score': 0.566076976264794, 'support': 487617}}
[[ 50292  45524  29823]
 [ 28796 170419  38175]
 [ 22951  43600  58037]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1531591
{'0': {'precision': 0.45278181352021196, 'recall': 0.5087968653964352, 'f1-score': 0.47915781095967225, 'support': 52064}, '1': {'precision': 0.29360630144762984, 'recall': 0.2493821951660539, 'f1-score': 0.26969331551673564, 'support': 33182}, '2': {'precision': 0.4337236065245672, 'recall': 0.42154917522564583, 'f1-score': 0.4275497420417666, 'support': 51408}, 'accuracy': 0.41298461808655434, 'macro avg': {'precision': 0.39337057383080304, 'recall': 0.39324274526271163, 'f1-score': 0.3921336228393915, 'support': 136654}, 'weighted avg': {'precision': 0.40696166813972895, 'recall': 0.41298461808655434, 'f1-score': 0.40888165003705584, 'support': 136654}}
[[26490  9485 16089]
 [12702  8275 12205]
 [19313 10424 21671]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2192346
{'0': {'precision': 0.3702049231538173, 'recall': 0.5553941325335083, 'f1-score': 0.44427366447985, 'support': 21338}, '1': {'precision': 0.39143650059468743, 'recall': 0.2734616627429257, 'f1-score': 0.3219827703345381, 'support': 21663}, '2': {'precision': 0.3987071388420461, 'recall': 0.3233644859813084, 'f1-score': 0.35710509754562614, 'support': 21935}, 'accuracy': 0.3829616853517309, 'macro avg': {'precision': 0.3867828541968503, 'recall': 0.38407342708591413, 'f1-score': 0.37445384412000476, 'support': 64936}, 'weighted avg': {'precision': 0.38691577327120774, 'recall': 0.3829616853517309, 'f1-score': 0.37403173156787367, 'support': 64936}}
[[11851  4168  5319]
 [10361  5924  5378]
 [ 9800  5042  7093]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2182028
{'0': {'precision': 0.38284468136661015, 'recall': 0.44127915095657033, 'f1-score': 0.40999026921829385, 'support': 7161}, '1': {'precision': 0.3459715639810427, 'recall': 0.1734516077934421, 'f1-score': 0.23106140535978054, 'support': 6313}, '2': {'precision': 0.39465101108936723, 'recall': 0.508189836203276, 'f1-score': 0.444281255737103, 'support': 7143}, 'accuracy': 0.38245137507881843, 'macro avg': {'precision': 0.37448908547900667, 'recall': 0.37430686498442944, 'f1-score': 0.3617776434383924, 'support': 20617}, 'weighted avg': {'precision': 0.37564443997138125, 'recall': 0.38245137507881843, 'f1-score': 0.3670821157122095, 'support': 20617}}
[[3160 1045 2956]
 [2606 1095 2612]
 [2488 1025 3630]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
1613/1613 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5760508
{'0': {'precision': 0.2646208100619316, 'recall': 0.5470068589076023, 'f1-score': 0.3566891658519737, 'support': 55694}, '1': {'precision': 0.8609454060193974, 'recall': 0.3607212628089712, 'f1-score': 0.5084223413686833, 'support': 300473}, '2': {'precision': 0.2203120544262028, 'recall': 0.6678663420486222, 'f1-score': 0.3313275947328575, 'support': 56682}, 'accuracy': 0.42802089868208476, 'macro avg': {'precision': 0.4486260901691772, 'recall': 0.5251981545883986, 'f1-score': 0.39881303398450485, 'support': 412849}, 'weighted avg': {'precision': 0.6925446549402848, 'recall': 0.42802089868208476, 'f1-score': 0.46363911092355803, 'support': 412849}}
[[ 30465   8741  16488]
 [ 74601 108387 117485]
 [ 10061   8765  37856]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70246017
{'0': {'precision': 0.5050677842877304, 'recall': 0.4605724982450667, 'f1-score': 0.4817950025497196, 'support': 25642}, '1': {'precision': 0.819597028466714, 'recall': 0.8248205536169521, 'f1-score': 0.8222004947260759, 'support': 110618}, '2': {'precision': 0.4599344978165939, 'recall': 0.4875028928488776, 'f1-score': 0.47331760476350976, 'support': 25926}, 'accuracy': 0.7133106433354297, 'macro avg': {'precision': 0.5948664368570128, 'recall': 0.5909653149036321, 'f1-score': 0.5924377006797684, 'support': 162186}, 'weighted avg': {'precision': 0.7123758771412451, 'recall': 0.7133106433354297, 'f1-score': 0.7126114091357314, 'support': 162186}}
[[11810  9760  4072]
 [ 8609 91240 10769]
 [ 2964 10323 12639]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6458131
{'0': {'precision': 0.5291115750405938, 'recall': 0.3464985568889564, 'f1-score': 0.4187626216265835, 'support': 6583}, '1': {'precision': 0.8518499746578814, 'recall': 0.8567350579839429, 'f1-score': 0.8542855327530339, 'support': 39235}, '2': {'precision': 0.41221118428396025, 'recall': 0.5342881944444444, 'f1-score': 0.4653771028920673, 'support': 6912}, 'accuracy': 0.750768063720842, 'macro avg': {'precision': 0.5977242446608119, 'recall': 0.5791739364391145, 'f1-score': 0.5794750857572282, 'support': 52730}, 'weighted avg': {'precision': 0.7539290529103915, 'recall': 0.750768063720842, 'f1-score': 0.7489340745481329, 'support': 52730}}
[[ 2281  3087  1215]
 [ 1570 33614  4051]
 [  460  2759  3693]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1816584
{'0': {'precision': 0.39833613517824046, 'recall': 0.4766903524496086, 'f1-score': 0.4340051309447631, 'support': 77543}, '1': {'precision': 0.48242065483444796, 'recall': 0.46965044168378234, 'f1-score': 0.47594990426440204, 'support': 100298}, '2': {'precision': 0.4144730529345914, 'recall': 0.3449712490682568, 'f1-score': 0.3765418646210173, 'support': 75128}, 'accuracy': 0.43478054623293766, 'macro avg': {'precision': 0.43174328098242665, 'recall': 0.4304373477338826, 'f1-score': 0.42883229994339417, 'support': 252969}, 'weighted avg': {'precision': 0.4364666709738417, 'recall': 0.43478054623293766, 'f1-score': 0.43356980725704947, 'support': 252969}}
[[36964 24779 15800]
 [32380 47105 20813]
 [23452 25759 25917]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2199856
{'0': {'precision': 0.4156573635246621, 'recall': 0.5694263139814497, 'f1-score': 0.4805403760019713, 'support': 29110}, '1': {'precision': 0.422776960940996, 'recall': 0.47240972891888994, 'f1-score': 0.44621742430631695, 'support': 27999}, '2': {'precision': 0.4504129544124342, 'recall': 0.23531410321747698, 'f1-score': 0.3091274269136353, 'support': 29433}, 'accuracy': 0.42440664648378823, 'macro avg': {'precision': 0.42961575962603077, 'recall': 0.4257167153726056, 'f1-score': 0.4119617424073079, 'support': 86542}, 'weighted avg': {'precision': 0.4297811752537615, 'recall': 0.42440664648378823, 'f1-score': 0.4111381706560859, 'support': 86542}}
[[16576  8204  4330]
 [10651 13227  4121]
 [12652  9855  6926]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2177517
{'0': {'precision': 0.4277816171389081, 'recall': 0.45894346617238185, 'f1-score': 0.4428149870338908, 'support': 10790}, '1': {'precision': 0.37451775645464436, 'recall': 0.3988201832929527, 'f1-score': 0.38628711355984086, 'support': 9493}, '2': {'precision': 0.43718899157103686, 'recall': 0.3827006845052894, 'f1-score': 0.4081342434584756, 'support': 11249}, 'accuracy': 0.41364328301408093, 'macro avg': {'precision': 0.4131627883881965, 'recall': 0.4134881113235413, 'f1-score': 0.4124121146840691, 'support': 31532}, 'weighted avg': {'precision': 0.4151021082435415, 'recall': 0.41364328301408093, 'f1-score': 0.41342443815120017, 'support': 31532}}
[[4952 2923 2915]
 [3080 3786 2627]
 [3544 3400 4305]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2840962
{'0': {'precision': 0.3175998718485842, 'recall': 0.720823894622032, 'f1-score': 0.44092514818964856, 'support': 71514}, '1': {'precision': 0.44428692234989803, 'recall': 0.17801052337864232, 'f1-score': 0.25417988815686493, 'support': 100348}, '2': {'precision': 0.3466062024575775, 'recall': 0.18273383514313918, 'f1-score': 0.2393043267482729, 'support': 64832}, 'accuracy': 0.3433082376401599, 'macro avg': {'precision': 0.3694976655520199, 'recall': 0.36052275104793785, 'f1-score': 0.3114697876982621, 'support': 236694}, 'weighted avg': {'precision': 0.37925471130268146, 'recall': 0.3433082376401599, 'f1-score': 0.306528017508444, 'support': 236694}}
[[51549 10790  9175]
 [69327 17863 13158]
 [41432 11553 11847]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2884688
{'0': {'precision': 0.36019796257495845, 'recall': 0.6639366094020509, 'f1-score': 0.46702576112412175, 'support': 30036}, '1': {'precision': 0.3549006511938554, 'recall': 0.14495669371888426, 'f1-score': 0.20583962812318418, 'support': 29326}, '2': {'precision': 0.36428302242321464, 'recall': 0.2647562311695426, 'f1-score': 0.3066460464747403, 'support': 29208}, 'accuracy': 0.3604606525911708, 'macro avg': {'precision': 0.3597938787306762, 'recall': 0.3578831780968259, 'f1-score': 0.32650381190734873, 'support': 88570}, 'weighted avg': {'precision': 0.359791137176806, 'recall': 0.3604606525911708, 'f1-score': 0.32765672824770053, 'support': 88570}}
[[19942  3609  6485]
 [18065  4251  7010]
 [17357  4118  7733]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2627951
{'0': {'precision': 0.3827994382398181, 'recall': 0.5238879736408567, 'f1-score': 0.4423663974651262, 'support': 10926}, '1': {'precision': 0.376865671641791, 'recall': 0.14996288047512993, 'f1-score': 0.21455124800849712, 'support': 10776}, '2': {'precision': 0.3353031465848043, 'recall': 0.4133787491721071, 'f1-score': 0.37026992669180897, 'support': 10569}, 'accuracy': 0.36283350376499024, 'macro avg': {'precision': 0.36498941882213787, 'recall': 0.3624098677626979, 'f1-score': 0.3423958573884774, 'support': 32271}, 'weighted avg': {'precision': 0.36526262266663534, 'recall': 0.36283350376499024, 'f1-score': 0.34268173785904565, 'support': 32271}}
[[5724 1221 3981]
 [4480 1616 4680]
 [4749 1451 4369]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2227591
{'0': {'precision': 0.41845401102712965, 'recall': 0.4412894978012923, 'f1-score': 0.4295684898644596, 'support': 129849}, '1': {'precision': 0.45003286783922014, 'recall': 0.37158043142991415, 'f1-score': 0.40706110122144434, 'support': 151079}, '2': {'precision': 0.38657977676543853, 'recall': 0.44561225380154995, 'f1-score': 0.4140022477292407, 'support': 126067}, 'accuracy': 0.416752048550965, 'macro avg': {'precision': 0.41835555187726275, 'recall': 0.4194940610109188, 'f1-score': 0.4168772796050482, 'support': 406995}, 'weighted avg': {'precision': 0.4203032057780362, 'recall': 0.416752048550965, 'f1-score': 0.4163919564523569, 'support': 406995}}
[[57301 31989 40559]
 [46359 56138 48582]
 [33275 36615 56177]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2409114
{'0': {'precision': 0.4020826283569693, 'recall': 0.5655899089119193, 'f1-score': 0.4700223854431688, 'support': 46219}, '1': {'precision': 0.40156300181993365, 'recall': 0.33183677982970256, 'f1-score': 0.36338536431780477, 'support': 45215}, '2': {'precision': 0.42685103850840156, 'recall': 0.32581377744133233, 'f1-score': 0.369550818143905, 'support': 46235}, 'accuracy': 0.40829090063848794, 'macro avg': {'precision': 0.4101655562284348, 'recall': 0.4077468220609847, 'f1-score': 0.40098618930162616, 'support': 137669}, 'weighted avg': {'precision': 0.4102302326068687, 'recall': 0.40829090063848794, 'f1-score': 0.4012567532074091, 'support': 137669}}
[[26141 10396  9682]
 [19666 15004 10545]
 [19207 11964 15064]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2363753
{'0': {'precision': 0.419030770202818, 'recall': 0.3799484388427385, 'f1-score': 0.3985337419626224, 'support': 17455}, '1': {'precision': 0.411723925435218, 'recall': 0.28923160173160173, 'f1-score': 0.3397749666264065, 'support': 18480}, '2': {'precision': 0.3898229550702913, 'recall': 0.5480435154069602, 'f1-score': 0.4555871212121212, 'support': 17557}, 'accuracy': 0.4037800044866522, 'macro avg': {'precision': 0.40685921690277577, 'recall': 0.4057411853271001, 'f1-score': 0.3979652766003834, 'support': 53492}, 'weighted avg': {'precision': 0.4069199479941322, 'recall': 0.4037800044866522, 'f1-score': 0.39696012368830436, 'support': 53492}}
[[6632 3893 6930]
 [5004 5345 8131]
 [4191 3744 9622]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8154775
{'0': {'precision': 0.45806290083392714, 'recall': 0.5241335235881021, 'f1-score': 0.48887598502580915, 'support': 181511}, '1': {'precision': 0.8047551948901662, 'recall': 0.7144661098137332, 'f1-score': 0.7569276598021815, 'support': 593933}, '2': {'precision': 0.464090864214489, 'recall': 0.5616182184636482, 'f1-score': 0.5082179513997429, 'support': 192508}, 'accuracy': 0.6483761591483875, 'macro avg': {'precision': 0.5756363199795275, 'recall': 0.6000726172884945, 'f1-score': 0.5846738654092445, 'support': 967952}, 'weighted avg': {'precision': 0.6719913037507756, 'recall': 0.6483761591483875, 'f1-score': 0.6571986070335827, 'support': 967952}}
[[ 95136  46871  39504]
 [ 84245 424345  85343]
 [ 28311  56081 108116]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7781942
{'0': {'precision': 0.5393799722961129, 'recall': 0.48112712401863234, 'f1-score': 0.5085909461310401, 'support': 91454}, '1': {'precision': 0.7551130461688068, 'recall': 0.7519389057616973, 'f1-score': 0.7535226332910626, 'support': 227190}, '2': {'precision': 0.5035020600353148, 'recall': 0.5633643587829829, 'f1-score': 0.5317537607227218, 'support': 91108}, 'accuracy': 0.6495660789941232, 'macro avg': {'precision': 0.5993316928334115, 'recall': 0.5988101295211042, 'f1-score': 0.5979557800482748, 'support': 409752}, 'weighted avg': {'precision': 0.6510173339755692, 'recall': 0.6495660789941232, 'f1-score': 0.6495453471289715, 'support': 409752}}
[[ 44001  27756  19697]
 [ 25441 170833  30916]
 [ 12135  27646  51327]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74024224
{'0': {'precision': 0.5461273040951603, 'recall': 0.4428939617083947, 'f1-score': 0.48912292115642664, 'support': 27160}, '1': {'precision': 0.7912560272112233, 'recall': 0.7733062198626467, 'f1-score': 0.7821781568494627, 'support': 82124}, '2': {'precision': 0.4856366803460187, 'recall': 0.6120785889707524, 'f1-score': 0.5415754383076796, 'support': 26874}, 'accuracy': 0.6755754344217747, 'macro avg': {'precision': 0.6076733372174674, 'recall': 0.6094262568472647, 'f1-score': 0.604292172104523, 'support': 136158}, 'weighted avg': {'precision': 0.6820379831191554, 'recall': 0.6755754344217747, 'f1-score': 0.676232581418605, 'support': 136158}}
[[12029  9081  6050]
 [ 7245 63507 11372]
 [ 2752  7673 16449]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0200969
{'0': {'precision': 0.44414698117686763, 'recall': 0.5801062454703716, 'f1-score': 0.5031030041875572, 'support': 267682}, '1': {'precision': 0.7593497536945812, 'recall': 0.5040942863122645, 'f1-score': 0.6059372002704445, 'support': 611584}, '2': {'precision': 0.41544522183237487, 'recall': 0.6117320677282159, 'f1-score': 0.49483408007987284, 'support': 261693}, 'accuracy': 0.5466156102015935, 'macro avg': {'precision': 0.5396473189012746, 'recall': 0.5653108665036174, 'f1-score': 0.5346247615126248, 'support': 1140959}, 'weighted avg': {'precision': 0.6065208464247294, 'recall': 0.5466156102015935, 'f1-score': 0.5563282554197613, 'support': 1140959}}
[[155284  46703  65695]
 [143733 308296 159555]
 [ 50606  51001 160086]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74803597
{'0': {'precision': 0.4891421858639858, 'recall': 0.4686218061117137, 'f1-score': 0.4786621683535341, 'support': 122617}, '1': {'precision': 0.7512133175449172, 'recall': 0.8374355582824041, 'f1-score': 0.7919846273642963, 'support': 376503}, '2': {'precision': 0.525189414341628, 'recall': 0.3607883766249784, 'f1-score': 0.4277358600924138, 'support': 121617}, 'accuracy': 0.6711956915730817, 'macro avg': {'precision': 0.5885149725835103, 'recall': 0.5556152470063654, 'f1-score': 0.5661275519367481, 'support': 620737}, 'weighted avg': {'precision': 0.6551618094356935, 'recall': 0.6711956915730817, 'f1-score': 0.6587277048901613, 'support': 620737}}
[[ 57461  50429  14727]
 [ 36264 315297  24942]
 [ 23748  53991  43878]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75722355
{'0': {'precision': 0.533363201911589, 'recall': 0.4323310091032346, 'f1-score': 0.47756204535729563, 'support': 41304}, '1': {'precision': 0.7612129382242832, 'recall': 0.7857214706030277, 'f1-score': 0.7732730565054013, 'support': 119298}, '2': {'precision': 0.47783781359998206, 'recall': 0.5246922698178237, 'f1-score': 0.5001701418631121, 'support': 40620}, 'accuracy': 0.6604894097066921, 'macro avg': {'precision': 0.5908046512452848, 'recall': 0.5809149165080286, 'f1-score': 0.5836684145752696, 'support': 201222}, 'weighted avg': {'precision': 0.6572392023957027, 'recall': 0.6604894097066921, 'f1-score': 0.6574433361108563, 'support': 201222}}
[[17857 15403  8044]
 [10317 93735 15246]
 [ 5306 14001 21313]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8213243
{'0': {'precision': 0.5392135244395443, 'recall': 0.5252416426586659, 'f1-score': 0.5321358871176664, 'support': 293305}, '1': {'precision': 0.6578382422824263, 'recall': 0.8391655262937414, 'f1-score': 0.7375200869749773, 'support': 608719}, '2': {'precision': 0.6206993774902246, 'recall': 0.2836133100537352, 'f1-score': 0.38933127318251415, 'support': 294965}, 'accuracy': 0.6253424216930983, 'macro avg': {'precision': 0.6059170480707317, 'recall': 0.5493401596687142, 'f1-score': 0.5529957490917193, 'support': 1196989}, 'weighted avg': {'precision': 0.6196191039943232, 'recall': 0.6253424216930983, 'f1-score': 0.601392080619495, 'support': 1196989}}
[[154056 113873  25376]
 [ 72158 510816  25745]
 [ 59491 151818  83656]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7938449
{'0': {'precision': 0.5434637500502634, 'recall': 0.5102769723329709, 'f1-score': 0.526347764792018, 'support': 132432}, '1': {'precision': 0.7172753834915997, 'recall': 0.7848522060105796, 'f1-score': 0.7495437418029658, 'support': 275248}, '2': {'precision': 0.5456956201046679, 'recall': 0.47177159167685173, 'f1-score': 0.5060481326314161, 'support': 131729}, 'accuracy': 0.6409830017667484, 'macro avg': {'precision': 0.6021449178821769, 'recall': 0.588966923340134, 'f1-score': 0.5939798797421333, 'support': 539409}, 'weighted avg': {'precision': 0.6327008715885721, 'recall': 0.6409830017667484, 'f1-score': 0.6352821652848266, 'support': 539409}}
[[ 67577  40740  24115]
 [ 31596 216029  27623]
 [ 25172  44411  62146]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8498812
{'0': {'precision': 0.5231922893167986, 'recall': 0.4698365915534995, 'f1-score': 0.49508103273742254, 'support': 53608}, '1': {'precision': 0.6733367274578613, 'recall': 0.7622159558702454, 'f1-score': 0.715024956314382, 'support': 97168}, '2': {'precision': 0.5301793390941856, 'recall': 0.45713911301645543, 'f1-score': 0.49095752701683837, 'support': 53417}, 'accuracy': 0.6056475981057137, 'macro avg': {'precision': 0.5755694519562818, 'recall': 0.5630638868134001, 'f1-score': 0.5670211720228809, 'support': 204193}, 'weighted avg': {'precision': 0.5964683663774689, 'recall': 0.6056475981057137, 'f1-score': 0.5986656113520153, 'support': 204193}}
[[25187 17998 10423]
 [11889 74063 11216]
 [11065 17933 24419]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
4274/4274 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2566835
{'0': {'precision': 0.4232971701059909, 'recall': 0.5965471400776498, 'f1-score': 0.4952064029934556, 'support': 340761}, '1': {'precision': 0.6253659980565905, 'recall': 0.2318418761108394, 'f1-score': 0.3382750686609974, 'support': 419165}, '2': {'precision': 0.4298683791483254, 'recall': 0.5897785053525628, 'f1-score': 0.49728417554382726, 'support': 334139}, 'accuracy': 0.4547517743461312, 'macro avg': {'precision': 0.4928438491036356, 'recall': 0.4727225071803507, 'f1-score': 0.4435885490660934, 'support': 1094065}, 'weighted avg': {'precision': 0.5027219551837603, 'recall': 0.4547517743461312, 'f1-score': 0.4357164660031888, 'support': 1094065}}
[[203280  27105 110376]
 [170991  97180 150994]
 [105959  31112 197068]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9089316
{'0': {'precision': 0.5101356699226206, 'recall': 0.41929756082627295, 'f1-score': 0.46027758640969196, 'support': 130659}, '1': {'precision': 0.6414677877461199, 'recall': 0.7964775112135303, 'f1-score': 0.7106176674138079, 'support': 243010}, '2': {'precision': 0.5222620319735161, 'recall': 0.38080833543399717, 'f1-score': 0.44045678439688113, 'support': 130911}, 'accuracy': 0.5909647627729994, 'macro avg': {'precision': 0.5579551632140854, 'recall': 0.5321944691579334, 'f1-score': 0.5371173460734603, 'support': 504580}, 'weighted avg': {'precision': 0.5765324595986548, 'recall': 0.5909647627729994, 'f1-score': 0.5757010714319107, 'support': 504580}}
[[ 54785  52550  23324]
 [ 27180 193552  22278]
 [ 25428  55631  49852]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9273869
{'0': {'precision': 0.5353021768914599, 'recall': 0.35933699850804224, 'f1-score': 0.43001443001442996, 'support': 48929}, '1': {'precision': 0.6050569152998508, 'recall': 0.7940839558026872, 'f1-score': 0.6868014489612682, 'support': 83806}, '2': {'precision': 0.5125128556736372, 'recall': 0.4047356254815802, 'f1-score': 0.4522922969513614, 'support': 48019}, 'accuracy': 0.57296657335384, 'macro avg': {'precision': 0.5509573159549827, 'recall': 0.5193855265974365, 'f1-score': 0.5230360586423531, 'support': 180754}, 'weighted avg': {'precision': 0.5615895353537621, 'recall': 0.57296657335384, 'f1-score': 0.5549912150499104, 'support': 180754}}
[[17582 22281  9066]
 [ 7837 66549  9420]
 [ 7426 21158 19435]]
testing model on single stock: results/universal/W4/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
12724/12724 - 169s - 169s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1814625
{'0': {'precision': 0.3817096018735363, 'recall': 0.49073495364362174, 'f1-score': 0.42941008135399206, 'support': 963190}, '1': {'precision': 0.4526521392074328, 'recall': 0.5852875697959453, 'f1-score': 0.5104952979861223, 'support': 1333172}, '2': {'precision': 0.47203175259548996, 'recall': 0.1449481413635725, 'f1-score': 0.22179045337852044, 'support': 960785}, 'accuracy': 0.42743664931303377, 'macro avg': {'precision': 0.4354644978921531, 'recall': 0.40699022160104653, 'f1-score': 0.38723194423954493, 'support': 3257147}, 'weighted avg': {'precision': 0.4373898557779188, 'recall': 0.42743664931303377, 'f1-score': 0.4013556877891566, 'support': 3257147}}
[[472671 436209  54310]
 [451426 780289 101457]
 [314203 507318 139264]]
Evaluating performance on  train set...
5165/5165 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3218405
{'0': {'precision': 0.40650309360770276, 'recall': 0.42048976051308673, 'f1-score': 0.41337815103772574, 'support': 444993}, '1': {'precision': 0.343248713135803, 'recall': 0.5530882008438075, 'f1-score': 0.42360592368630723, 'support': 431141}, '2': {'precision': 0.43456663035801923, 'recall': 0.1628143723316471, 'f1-score': 0.23687962234974405, 'support': 445968}, 'accuracy': 0.376812076526622, 'macro avg': {'precision': 0.394772812367175, 'recall': 0.3787974445628471, 'f1-score': 0.357954565691259, 'support': 1322102}, 'weighted avg': {'precision': 0.39534198993070185, 'recall': 0.376812076526622, 'f1-score': 0.3571774314907924, 'support': 1322102}}
[[187115 218997  38881]
 [137087 238459  55595]
 [136102 237256  72610]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2144489
{'0': {'precision': 0.4241178793208658, 'recall': 0.2897020963589555, 'f1-score': 0.3442544140784336, 'support': 163140}, '1': {'precision': 0.37864527753966726, 'recall': 0.5338191952449657, 'f1-score': 0.4430377803591258, 'support': 162186}, '2': {'precision': 0.40783598344587235, 'recall': 0.3705976223758922, 'f1-score': 0.3883261068227334, 'support': 161674}, 'accuracy': 0.3978562628336756, 'macro avg': {'precision': 0.4035330467688018, 'recall': 0.39803963799327113, 'f1-score': 0.3918727670867643, 'support': 487000}, 'weighted avg': {'precision': 0.4035688472342556, 'recall': 0.3978562628336756, 'f1-score': 0.3917832146869392, 'support': 487000}}
[[47262 69833 46045]
 [34657 86578 40951]
 [29517 72241 59916]]
training model: results/universal/W4/deepOF_L2/h10
Epoch 1/50
9854/9854 - 224s - loss: 2.6134 - accuracy10: 0.5797 - val_loss: 2.8973 - val_accuracy10: 0.5846 - 224s/epoch - 23ms/step
Epoch 2/50
9854/9854 - 219s - loss: 2.5208 - accuracy10: 0.5993 - val_loss: 2.7817 - val_accuracy10: 0.5953 - 219s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 217s - loss: 2.4963 - accuracy10: 0.6030 - val_loss: 2.7467 - val_accuracy10: 0.5993 - 217s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 216s - loss: 2.4812 - accuracy10: 0.6053 - val_loss: 2.7183 - val_accuracy10: 0.6005 - 216s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 217s - loss: 2.4707 - accuracy10: 0.6072 - val_loss: 2.7237 - val_accuracy10: 0.6008 - 217s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 217s - loss: 2.4622 - accuracy10: 0.6085 - val_loss: 2.6973 - val_accuracy10: 0.6028 - 217s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 217s - loss: 2.4552 - accuracy10: 0.6098 - val_loss: 2.7015 - val_accuracy10: 0.6025 - 217s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 220s - loss: 2.4489 - accuracy10: 0.6108 - val_loss: 2.6653 - val_accuracy10: 0.6043 - 220s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 216s - loss: 2.4437 - accuracy10: 0.6116 - val_loss: 2.6783 - val_accuracy10: 0.6032 - 216s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 217s - loss: 2.4389 - accuracy10: 0.6124 - val_loss: 2.6657 - val_accuracy10: 0.6051 - 217s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 217s - loss: 2.4344 - accuracy10: 0.6133 - val_loss: 2.6511 - val_accuracy10: 0.6062 - 217s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 217s - loss: 2.4304 - accuracy10: 0.6138 - val_loss: 2.6447 - val_accuracy10: 0.6072 - 217s/epoch - 22ms/step
Epoch 13/50
9854/9854 - 219s - loss: 2.4268 - accuracy10: 0.6144 - val_loss: 2.6529 - val_accuracy10: 0.6073 - 219s/epoch - 22ms/step
Epoch 14/50
9854/9854 - 219s - loss: 2.4239 - accuracy10: 0.6149 - val_loss: 2.6457 - val_accuracy10: 0.6088 - 219s/epoch - 22ms/step
Epoch 15/50
9854/9854 - 216s - loss: 2.4209 - accuracy10: 0.6151 - val_loss: 2.6444 - val_accuracy10: 0.6091 - 216s/epoch - 22ms/step
Epoch 16/50
9854/9854 - 217s - loss: 2.4182 - accuracy10: 0.6157 - val_loss: 2.6536 - val_accuracy10: 0.6089 - 217s/epoch - 22ms/step
Epoch 17/50
9854/9854 - 217s - loss: 2.4156 - accuracy10: 0.6161 - val_loss: 2.6451 - val_accuracy10: 0.6085 - 217s/epoch - 22ms/step
Epoch 18/50
9854/9854 - 219s - loss: 2.4133 - accuracy10: 0.6166 - val_loss: 2.6468 - val_accuracy10: 0.6081 - 219s/epoch - 22ms/step
Epoch 19/50
9854/9854 - 220s - loss: 2.4117 - accuracy10: 0.6168 - val_loss: 2.6372 - val_accuracy10: 0.6086 - 220s/epoch - 22ms/step
Epoch 20/50
9854/9854 - 219s - loss: 2.4092 - accuracy10: 0.6172 - val_loss: 2.6568 - val_accuracy10: 0.6076 - 219s/epoch - 22ms/step
Epoch 21/50
9854/9854 - 217s - loss: 2.4074 - accuracy10: 0.6176 - val_loss: 2.6561 - val_accuracy10: 0.6077 - 217s/epoch - 22ms/step
Epoch 22/50
9854/9854 - 219s - loss: 2.4048 - accuracy10: 0.6179 - val_loss: 2.6714 - val_accuracy10: 0.6072 - 219s/epoch - 22ms/step
Epoch 23/50
9854/9854 - 216s - loss: 2.4039 - accuracy10: 0.6178 - val_loss: 2.6509 - val_accuracy10: 0.6087 - 216s/epoch - 22ms/step
Epoch 24/50
9854/9854 - 218s - loss: 2.4019 - accuracy10: 0.6183 - val_loss: 2.6582 - val_accuracy10: 0.6069 - 218s/epoch - 22ms/step
Epoch 25/50
9854/9854 - 219s - loss: 2.4004 - accuracy10: 0.6186 - val_loss: 2.6571 - val_accuracy10: 0.6072 - 219s/epoch - 22ms/step
Epoch 26/50
9854/9854 - 220s - loss: 2.3985 - accuracy10: 0.6190 - val_loss: 2.6427 - val_accuracy10: 0.6082 - 220s/epoch - 22ms/step
Epoch 27/50
9854/9854 - 217s - loss: 2.3973 - accuracy10: 0.6192 - val_loss: 2.6329 - val_accuracy10: 0.6087 - 217s/epoch - 22ms/step
Epoch 28/50
9854/9854 - 217s - loss: 2.3955 - accuracy10: 0.6192 - val_loss: 2.6321 - val_accuracy10: 0.6085 - 217s/epoch - 22ms/step
Epoch 29/50
9854/9854 - 217s - loss: 2.3943 - accuracy10: 0.6196 - val_loss: 2.6366 - val_accuracy10: 0.6079 - 217s/epoch - 22ms/step
Epoch 30/50
9854/9854 - 216s - loss: 2.3927 - accuracy10: 0.6198 - val_loss: 2.6360 - val_accuracy10: 0.6072 - 216s/epoch - 22ms/step
Epoch 31/50
9854/9854 - 216s - loss: 2.3912 - accuracy10: 0.6201 - val_loss: 2.6413 - val_accuracy10: 0.6080 - 216s/epoch - 22ms/step
Epoch 32/50
9854/9854 - 219s - loss: 2.3901 - accuracy10: 0.6203 - val_loss: 2.6592 - val_accuracy10: 0.6067 - 219s/epoch - 22ms/step
Epoch 33/50
9854/9854 - 217s - loss: 2.3887 - accuracy10: 0.6205 - val_loss: 2.6548 - val_accuracy10: 0.6063 - 217s/epoch - 22ms/step
Epoch 34/50
9854/9854 - 218s - loss: 2.3874 - accuracy10: 0.6208 - val_loss: 2.6400 - val_accuracy10: 0.6068 - 218s/epoch - 22ms/step
Epoch 35/50
9854/9854 - 216s - loss: 2.3864 - accuracy10: 0.6210 - val_loss: 2.6581 - val_accuracy10: 0.6056 - 216s/epoch - 22ms/step
Epoch 36/50
9854/9854 - 216s - loss: 2.3852 - accuracy10: 0.6211 - val_loss: 2.6453 - val_accuracy10: 0.6054 - 216s/epoch - 22ms/step
Epoch 37/50
9854/9854 - 220s - loss: 2.3841 - accuracy10: 0.6215 - val_loss: 2.6417 - val_accuracy10: 0.6055 - 220s/epoch - 22ms/step
Epoch 38/50
9854/9854 - 219s - loss: 2.3831 - accuracy10: 0.6212 - val_loss: 2.6353 - val_accuracy10: 0.6066 - 219s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 179s - 179s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8112207
{'0': {'precision': 0.4632149717590394, 'recall': 0.5318528767962255, 'f1-score': 0.49516666760526895, 'support': 1322565}, '1': {'precision': 0.7587280122913864, 'recall': 0.696650179060262, 'f1-score': 0.7263651589143794, 'support': 3418123}, '2': {'precision': 0.46920007860801605, 'recall': 0.49870428266699124, 'f1-score': 0.4835024987825696, 'support': 1330923}, 'accuracy': 0.617362179494042, 'macro avg': {'precision': 0.5637143542194806, 'recall': 0.5757357795078263, 'f1-score': 0.5683447751007393, 'support': 6071611}, 'weighted avg': {'precision': 0.6308913326138946, 'recall': 0.617362179494042, 'f1-score': 0.6227671957265464, 'support': 6071611}}
[[ 703410  348847  270308]
 [ 556318 2381236  480569]
 [ 258811  408375  663737]]
Evaluating performance on  train set...
9854/9854 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8214172
{'0': {'precision': 0.4815007076232057, 'recall': 0.5597352440480727, 'f1-score': 0.5176788520569272, 'support': 629712}, '1': {'precision': 0.7665006584133378, 'recall': 0.6668638194735703, 'f1-score': 0.713219232908679, 'support': 1261289}, '2': {'precision': 0.4954616394114785, 'recall': 0.5438588428447592, 'f1-score': 0.5185334042476036, 'support': 631013}, 'accuracy': 0.6093392027165591, 'macro avg': {'precision': 0.5811543351493407, 'recall': 0.5901526354554675, 'f1-score': 0.5831438297377366, 'support': 2522014}, 'weighted avg': {'precision': 0.6275256037509228, 'recall': 0.6093392027165591, 'f1-score': 0.6156847175936055, 'support': 2522014}}
[[352472 121527 155713]
 [226425 841108 193756]
 [153131 134700 343182]]
Evaluating performance on  val set...
3566/3566 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8247012
{'0': {'precision': 0.48096779395935146, 'recall': 0.5531882770104133, 'f1-score': 0.514556269999699, 'support': 231818}, '1': {'precision': 0.7742468473733067, 'recall': 0.6694935528660512, 'f1-score': 0.7180699141720444, 'support': 447253}, '2': {'precision': 0.4929087462014588, 'recall': 0.5472183403492829, 'f1-score': 0.5186456722985258, 'support': 233278}, 'accuracy': 0.608677161919397, 'macro avg': {'precision': 0.5827077958447057, 'recall': 0.5899667234085825, 'f1-score': 0.5837572854900898, 'support': 912349}, 'weighted avg': {'precision': 0.6277926361345345, 'recall': 0.608677161919397, 'f1-score': 0.6153686296191864, 'support': 912349}}
[[128239  40487  63092]
 [ 79585 299433  68235]
 [ 58803  46821 127654]]
testing model out of sample: results/universal/W4/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81703293
{'0': {'precision': 0.4431659048815845, 'recall': 0.5049915455696913, 'f1-score': 0.47206302105926995, 'support': 641084}, '1': {'precision': 0.7412428980804354, 'recall': 0.7529816735057578, 'f1-score': 0.7470661753050528, 'support': 1761930}, '2': {'precision': 0.48248081241149454, 'recall': 0.3924178502341682, 'f1-score': 0.43281374465292716, 'support': 628608}, 'accuracy': 0.6257772242053924, 'macro avg': {'precision': 0.5556298717911715, 'recall': 0.5501303564365391, 'f1-score': 0.55064764700575, 'support': 3031622}, 'weighted avg': {'precision': 0.6245554257451397, 'recall': 0.6257772242053924, 'f1-score': 0.6237520833556359, 'support': 3031622}}
[[ 323742  213617  103725]
 [ 274363 1326701  160866]
 [ 132416  249515  246677]]
Evaluating performance on  train set...
5528/5528 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69998014
{'0': {'precision': 0.45907313228646207, 'recall': 0.47850010268492005, 'f1-score': 0.468585349379486, 'support': 258071}, '1': {'precision': 0.7928522531654141, 'recall': 0.8322687768985145, 'f1-score': 0.8120825006827372, 'support': 900375}, '2': {'precision': 0.5060127893452074, 'recall': 0.39595165738303006, 'f1-score': 0.4442671844217659, 'support': 256006}, 'accuracy': 0.6887522517554502, 'macro avg': {'precision': 0.5859793915990279, 'recall': 0.5689068456554881, 'f1-score': 0.5749783448279964, 'support': 1414452}, 'weighted avg': {'precision': 0.6800373006049117, 'recall': 0.6887522517554502, 'f1-score': 0.6828383968257753, 'support': 1414452}}
[[123487  92906  41678]
 [ 93742 749354  57279]
 [ 51763 102877 101366]]
Evaluating performance on  val set...
1908/1908 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.726033
{'0': {'precision': 0.46547338971196034, 'recall': 0.47477651789478237, 'f1-score': 0.4700789297658863, 'support': 92513}, '1': {'precision': 0.7793697963843014, 'recall': 0.8255932019597598, 'f1-score': 0.8018158753460615, 'support': 304323}, '2': {'precision': 0.4968327196286734, 'recall': 0.3879311294462376, 'f1-score': 0.43567982184832366, 'support': 90779}, 'accuracy': 0.6775550382986577, 'macro avg': {'precision': 0.5805586352416451, 'recall': 0.5627669497669265, 'f1-score': 0.5691915423200905, 'support': 487615}, 'weighted avg': {'precision': 0.6672158807720305, 'recall': 0.6775550382986577, 'f1-score': 0.6707135818421089, 'support': 487615}}
[[ 43923  33645  14945]
 [ 32356 251247  20720]
 [ 18083  37480  35216]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0842879
{'0': {'precision': 0.43926276092845384, 'recall': 0.5395941625524696, 'f1-score': 0.4842865508491119, 'support': 45979}, '1': {'precision': 0.509319307562682, 'recall': 0.22002117709344393, 'f1-score': 0.30729415389355313, 'support': 45332}, '2': {'precision': 0.44270953685669956, 'recall': 0.5915878162288537, 'f1-score': 0.5064337974982299, 'support': 45339}, 'accuracy': 0.45083058909623125, 'macro avg': {'precision': 0.4637638684492784, 'recall': 0.45040105195825575, 'f1-score': 0.432671500746965, 'support': 136650}, 'weighted avg': {'precision': 0.46364678394955566, 'recall': 0.45083058909623125, 'f1-score': 0.4329196622800301, 'support': 136650}}
[[24810  4811 16358]
 [17952  9974 17406]
 [13719  4798 26822]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1216989
{'0': {'precision': 0.3350454365863295, 'recall': 0.5379469434832757, 'f1-score': 0.41291693410947083, 'support': 17340}, '1': {'precision': 0.6077648291213827, 'recall': 0.31006379638598486, 'f1-score': 0.41063410965872654, 'support': 29939}, '2': {'precision': 0.38067739126449424, 'recall': 0.47046162560181254, 'f1-score': 0.4208339666616, 'support': 17655}, 'accuracy': 0.4145285982690116, 'macro avg': {'precision': 0.4411625523240688, 'recall': 0.43949078849035766, 'f1-score': 0.4147950034765991, 'support': 64934}, 'weighted avg': {'precision': 0.4731946042481085, 'recall': 0.4145285982690116, 'f1-score': 0.4140169699686049, 'support': 64934}}
[[ 9328  2891  5121]
 [12264  9283  8392]
 [ 6249  3100  8306]]
Evaluating performance on  val set...
81/81 - 1s - 817ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1298217
{'0': {'precision': 0.34866383759605457, 'recall': 0.5244996549344375, 'f1-score': 0.4188770237685153, 'support': 5796}, '1': {'precision': 0.5832579185520362, 'recall': 0.2868587960387226, 'f1-score': 0.384575221899008, 'support': 8987}, '2': {'precision': 0.37662163969506485, 'recall': 0.4827704440253729, 'f1-score': 0.4231404958677686, 'support': 5833}, 'accuracy': 0.4090997283663174, 'macro avg': {'precision': 0.4361811319477185, 'recall': 0.43137629833284435, 'f1-score': 0.4088642471784307, 'support': 20616}, 'weighted avg': {'precision': 0.4588391803005042, 'recall': 0.4090997283663174, 'f1-score': 0.4051303483394157, 'support': 20616}}
[[3040  897 1859]
 [3607 2578 2802]
 [2072  945 2816]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
1613/1613 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40232363
{'0': {'precision': 0.48011889035667105, 'recall': 0.4304876965443724, 'f1-score': 0.4539507579897269, 'support': 33771}, '1': {'precision': 0.9074041819071553, 'recall': 0.951225662100986, 'f1-score': 0.9287983258317427, 'support': 345038}, '2': {'precision': 0.5263132668711656, 'recall': 0.3226289810788577, 'f1-score': 0.4000364298724955, 'support': 34036}, 'accuracy': 0.8568058230086352, 'macro avg': {'precision': 0.6379454463783306, 'recall': 0.5681141132414054, 'f1-score': 0.5942618378979884, 'support': 412845}, 'weighted avg': {'precision': 0.841033844455772, 'recall': 0.8568058230086352, 'f1-score': 0.8463629878611687, 'support': 412845}}
[[ 14538  14646   4587]
 [ 11533 328209   5296]
 [  4209  18846  10981]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4431448
{'0': {'precision': 0.5127709808971882, 'recall': 0.44612511671335203, 'f1-score': 0.4771320151787497, 'support': 16065}, '1': {'precision': 0.8873285269041921, 'recall': 0.9434133439945873, 'f1-score': 0.9145118556528155, 'support': 130066}, '2': {'precision': 0.5604716790969563, 'recall': 0.3463718467767051, 'f1-score': 0.42814797705662705, 'support': 16055}, 'accuracy': 0.8350535804570062, 'macro avg': {'precision': 0.6535237289661122, 'recall': 0.5786367691615482, 'f1-score': 0.6065972826293974, 'support': 162186}, 'weighted avg': {'precision': 0.8178715227968852, 'recall': 0.8350535804570062, 'f1-score': 0.8230423132257398, 'support': 162186}}
[[  7167   7161   1737]
 [  4736 122706   2624]
 [  2074   8420   5561]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.38309917
{'0': {'precision': 0.5188470066518847, 'recall': 0.4080717488789238, 'f1-score': 0.45684005020220325, 'support': 4014}, '1': {'precision': 0.9096886770370055, 'recall': 0.9594012298577136, 'f1-score': 0.9338838461622484, 'support': 44558}, '2': {'precision': 0.5350911205893757, 'recall': 0.3319701707962473, 'f1-score': 0.40973871733966744, 'support': 4157}, 'accuracy': 0.8679663942043278, 'macro avg': {'precision': 0.6545422680927553, 'recall': 0.5664810498442948, 'f1-score': 0.6001542045680397, 'support': 52729}, 'weighted avg': {'precision': 0.8504036439986647, 'recall': 0.8679663942043278, 'f1-score': 0.8562467755275105, 'support': 52729}}
[[ 1638  1912   464]
 [ 1074 42749   735]
 [  445  2332  1380]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0237445
{'0': {'precision': 0.4272004057769828, 'recall': 0.4592085629017447, 'f1-score': 0.4426265783395798, 'support': 69696}, '1': {'precision': 0.6115739026697931, 'recall': 0.5168122365619432, 'f1-score': 0.5602140357322857, 'support': 115065}, '2': {'precision': 0.42223212186459763, 'recall': 0.5002785760365961, 'f1-score': 0.45795389725866525, 'support': 68204}, 'accuracy': 0.49648370327910973, 'macro avg': {'precision': 0.4870021434371245, 'recall': 0.492099791833428, 'f1-score': 0.4869315037768436, 'support': 252965}, 'weighted avg': {'precision': 0.5097259709105424, 'recall': 0.49648370327910973, 'f1-score': 0.500245558216041, 'support': 252965}}
[[32005 18696 18995]
 [27903 59467 27695]
 [15010 19073 34121]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0245262
{'0': {'precision': 0.46844553077367007, 'recall': 0.49264548375580147, 'f1-score': 0.4802408338698731, 'support': 28010}, '1': {'precision': 0.5425524376417233, 'recall': 0.5072545382271101, 'f1-score': 0.5243100732726151, 'support': 30188}, '2': {'precision': 0.48570636543192763, 'recall': 0.49456636793451414, 'f1-score': 0.4900963269872904, 'support': 28342}, 'accuracy': 0.49837069563207764, 'macro avg': {'precision': 0.4989014446157736, 'recall': 0.4981554633058085, 'f1-score': 0.49821574470992624, 'support': 86540}, 'weighted avg': {'precision': 0.4999494119894909, 'recall': 0.49837069563207764, 'f1-score': 0.49884132595473346, 'support': 86540}}
[[13799  6117  8094]
 [ 8127 15313  6748]
 [ 7531  6794 14017]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0598577
{'0': {'precision': 0.47027498908773463, 'recall': 0.506535025858016, 'f1-score': 0.48773200543232237, 'support': 10635}, '1': {'precision': 0.4830273270708796, 'recall': 0.4588318799432164, 'f1-score': 0.4706188247529901, 'support': 9862}, '2': {'precision': 0.49052199084881876, 'recall': 0.47603081105573175, 'f1-score': 0.48316777041942605, 'support': 11035}, 'accuracy': 0.48093999746289484, 'macro avg': {'precision': 0.4812747690024777, 'recall': 0.4804659056189881, 'f1-score': 0.4805062002015796, 'support': 31532}, 'weighted avg': {'precision': 0.4813491113008305, 'recall': 0.48093999746289484, 'f1-score': 0.4807823504397153, 'support': 31532}}
[[5387 2199 3049]
 [2930 4525 2407]
 [3138 2644 5253]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2229131
{'0': {'precision': 0.32016292187520934, 'recall': 0.3408893136849313, 'f1-score': 0.3302011938978554, 'support': 70099}, '1': {'precision': 0.6499588859890602, 'recall': 0.17366716658865336, 'f1-score': 0.2740965217784613, 'support': 104683}, '2': {'precision': 0.3024716218433496, 'recall': 0.655101117787685, 'f1-score': 0.41385784989030056, 'support': 61908}, 'accuracy': 0.349114875998141, 'macro avg': {'precision': 0.4241978099025397, 'recall': 0.38988586602042324, 'f1-score': 0.3393851885222057, 'support': 236690}, 'weighted avg': {'precision': 0.4613974392141669, 'recall': 0.349114875998141, 'f1-score': 0.3272682895407037, 'support': 236690}}
[[23896  5940 40263]
 [33240 18180 53263]
 [17501  3851 40556]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.198565
{'0': {'precision': 0.36958206641626423, 'recall': 0.41782091463620125, 'f1-score': 0.39222385675192584, 'support': 29673}, '1': {'precision': 0.5252379578886646, 'recall': 0.06265698654646802, 'f1-score': 0.11195819243774978, 'support': 29063}, '2': {'precision': 0.3733416091240593, 'recall': 0.6451915663862166, 'f1-score': 0.47298775018737177, 'support': 29833}, 'accuracy': 0.37786358658221275, 'macro avg': {'precision': 0.42272054447632934, 'recall': 0.3752231558562953, 'f1-score': 0.3257232664590158, 'support': 88569}, 'weighted avg': {'precision': 0.42192527466592294, 'recall': 0.37786358658221275, 'f1-score': 0.3274615610378132, 'support': 88569}}
[[12398  1021 16254]
 [11188  1821 16054]
 [ 9960   625 19248]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.21529
{'0': {'precision': 0.384519946554686, 'recall': 0.36953132165459046, 'f1-score': 0.3768766661989617, 'support': 10903}, '1': {'precision': 0.5647149460708782, 'recall': 0.0665577045310088, 'f1-score': 0.11908049711639995, 'support': 11013}, '2': {'precision': 0.338684493022348, 'recall': 0.6703689395402743, 'f1-score': 0.4500129668049792, 'support': 10354}, 'accuracy': 0.36265881623799195, 'macro avg': {'precision': 0.42930646188263744, 'recall': 0.3688193219086245, 'f1-score': 0.3153233767067803, 'support': 32270}, 'weighted avg': {'precision': 0.4313097588818629, 'recall': 0.36265881623799195, 'f1-score': 0.3123630016922513, 'support': 32270}}
[[4029  342 6532]
 [3259  733 7021]
 [3190  223 6941]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0819116
{'0': {'precision': 0.42061259845833365, 'recall': 0.48969859299847296, 'f1-score': 0.45253403362612815, 'support': 122459}, '1': {'precision': 0.5437303597827783, 'recall': 0.4405805302063519, 'f1-score': 0.48675070577555507, 'support': 166124}, '2': {'precision': 0.4296389310448428, 'recall': 0.47100702655225996, 'f1-score': 0.44937292772050264, 'support': 118408}, 'accuracy': 0.464211739325931, 'macro avg': {'precision': 0.4646606297619849, 'recall': 0.4670953832523616, 'f1-score': 0.4628858890407286, 'support': 406991}, 'weighted avg': {'precision': 0.47349240408343446, 'recall': 0.464211739325931, 'f1-score': 0.46558078457658675, 'support': 406991}}
[[59968 29971 32520]
 [51415 73191 41518]
 [31190 31447 55771]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0538809
{'0': {'precision': 0.4653270916808823, 'recall': 0.5087285581072583, 'f1-score': 0.48606089487915305, 'support': 46113}, '1': {'precision': 0.4922865091184983, 'recall': 0.3886374728248813, 'f1-score': 0.4343643463707928, 'support': 45078}, '2': {'precision': 0.4778964889869547, 'recall': 0.5312634478010155, 'f1-score': 0.5031688777485683, 'support': 46476}, 'accuracy': 0.47701337284897616, 'macro avg': {'precision': 0.4785033632621118, 'recall': 0.47620982624438507, 'f1-score': 0.4745313729995047, 'support': 137667}, 'weighted avg': {'precision': 0.4783981394152695, 'recall': 0.47701337284897616, 'f1-score': 0.4749088656940838, 'support': 137667}}
[[23459  9011 13643]
 [14227 17519 13332]
 [12728  9057 24691]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0704108
{'0': {'precision': 0.4444203095302742, 'recall': 0.48172346812643474, 'f1-score': 0.4623206417353971, 'support': 16989}, '1': {'precision': 0.5137435468117761, 'recall': 0.3722764268742733, 'f1-score': 0.43171625384728124, 'support': 19781}, '2': {'precision': 0.4448462057660785, 'recall': 0.5518210633335326, 'f1-score': 0.4925926914555695, 'support': 16721}, 'accuracy': 0.46316202725692174, 'macro avg': {'precision': 0.46767002070270963, 'recall': 0.46860698611141355, 'f1-score': 0.46220986234608263, 'support': 53491}, 'weighted avg': {'precision': 0.4701892121049928, 'recall': 0.46316202725692174, 'f1-score': 0.4604660035075865, 'support': 53491}}
[[8184 3610 5195]
 [6097 7364 6320]
 [4134 3360 9227]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/EXC
Evaluating performance on  test set...
3782/3782 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49704465
{'0': {'precision': 0.5134807783204663, 'recall': 0.4483161813382855, 'f1-score': 0.4786909324581736, 'support': 116313}, '1': {'precision': 0.858902816919369, 'recall': 0.92240640261188, 'f1-score': 0.8895226599189642, 'support': 730202}, '2': {'precision': 0.5598618105734374, 'recall': 0.37900735384944784, 'f1-score': 0.4520155765840531, 'support': 121433}, 'accuracy': 0.7972659688330365, 'macro avg': {'precision': 0.6440818019377575, 'recall': 0.5832433125998712, 'f1-score': 0.606743056320397, 'support': 967948}, 'weighted avg': {'precision': 0.7798794395280633, 'recall': 0.7972659688330365, 'f1-score': 0.7852682285169104, 'support': 967948}}
[[ 52145  51285  12883]
 [ 33360 673543  23299]
 [ 16047  59362  46024]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5252919
{'0': {'precision': 0.5511469821124186, 'recall': 0.4521895903890546, 'f1-score': 0.49678828603691155, 'support': 59349}, '1': {'precision': 0.8294421660658778, 'recall': 0.9173734628897673, 'f1-score': 0.8711946693602254, 'support': 291456}, '2': {'precision': 0.5707826266697672, 'recall': 0.3747730935617949, 'f1-score': 0.4524619039816484, 'support': 58945}, 'accuracy': 0.7719389871873094, 'macro avg': {'precision': 0.6504572582826879, 'recall': 0.5814453822802056, 'f1-score': 0.6068149531262618, 'support': 409750}, 'weighted avg': {'precision': 0.751923612259514, 'recall': 0.7719389871873094, 'f1-score': 0.7567276838834821, 'support': 409750}}
[[ 26837  25835   6677]
 [ 14147 267374   9935]
 [  7709  29145  22091]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48264253
{'0': {'precision': 0.539200115506786, 'recall': 0.43757689378405296, 'f1-score': 0.4831020988971896, 'support': 17069}, '1': {'precision': 0.85264750105792, 'recall': 0.9271141307540187, 'f1-score': 0.8883229446609728, 'support': 102146}, '2': {'precision': 0.5613488744550227, 'recall': 0.37236616891931773, 'f1-score': 0.4477325952735789, 'support': 16943}, 'accuracy': 0.7967141115468793, 'macro avg': {'precision': 0.6510654970065762, 'recall': 0.5790190644857964, 'f1-score': 0.6063858796105804, 'support': 136158}, 'weighted avg': {'precision': 0.7771050720085421, 'recall': 0.7967141115468793, 'f1-score': 0.7826983254244048, 'support': 136158}}
[[ 7469  7816  1784]
 [ 4299 94701  3146]
 [ 2084  8550  6309]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/AAL
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6180327
{'0': {'precision': 0.4802947704109117, 'recall': 0.5176347644343813, 'f1-score': 0.4982661834520413, 'support': 172245}, '1': {'precision': 0.8130515027661047, 'recall': 0.8651940622429359, 'f1-score': 0.838312756080056, 'support': 799898}, '2': {'precision': 0.5465319529014041, 'recall': 0.3370968888467645, 'f1-score': 0.41699458477141, 'support': 168812}, 'accuracy': 0.734589006577823, 'macro avg': {'precision': 0.6132927420261401, 'recall': 0.5733085718413605, 'f1-score': 0.5845245081011691, 'support': 1140955}, 'weighted avg': {'precision': 0.7233833023407769, 'recall': 0.734589006577823, 'f1-score': 0.7246405384752709, 'support': 1140955}}
[[ 89160  70098  12987]
 [ 73602 692067  34229]
 [ 22874  89032  56906]]
Evaluating performance on  train set...
2425/2425 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.52672416
{'0': {'precision': 0.4871978973011091, 'recall': 0.47637494201862923, 'f1-score': 0.48172563735246765, 'support': 79767}, '1': {'precision': 0.8477629577229858, 'recall': 0.9086084384968456, 'f1-score': 0.8771317716628756, 'support': 464277}, '2': {'precision': 0.5710013291980505, 'recall': 0.3360933628895554, 'f1-score': 0.4231305918082574, 'support': 76690}, 'accuracy': 0.7823318845109177, 'macro avg': {'precision': 0.6353207280740484, 'recall': 0.5736922478016767, 'f1-score': 0.5939960002745336, 'support': 620734}, 'weighted avg': {'precision': 0.7672356425344362, 'recall': 0.7823318845109177, 'f1-score': 0.7702297627531188, 'support': 620734}}
[[ 37999  35758   6010]
 [ 29076 421846  13355]
 [ 10920  39995  25775]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53762114
{'0': {'precision': 0.5108131487889274, 'recall': 0.4804541588076482, 'f1-score': 0.49516875988641346, 'support': 27039}, '1': {'precision': 0.8396348520864706, 'recall': 0.91041644175753, 'f1-score': 0.8735942507526464, 'support': 148208}, '2': {'precision': 0.5619697773064687, 'recall': 0.3264292589027911, 'f1-score': 0.41297518447263964, 'support': 25975}, 'accuracy': 0.7772559660474501, 'macro avg': {'precision': 0.637472592727289, 'recall': 0.572433286489323, 'f1-score': 0.5939127317038998, 'support': 201222}, 'weighted avg': {'precision': 0.7596070203738704, 'recall': 0.7772559660474501, 'f1-score': 0.7632841102403999, 'support': 201222}}
[[ 12991  11839   2209]
 [  8877 134931   4400]
 [  3564  13932   8479]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/WBA
Evaluating performance on  test set...
4676/4676 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6370247
{'0': {'precision': 0.4946917468778221, 'recall': 0.481240625669595, 'f1-score': 0.48787348893788485, 'support': 186680}, '1': {'precision': 0.8051210591664867, 'recall': 0.8718402451321873, 'f1-score': 0.8371534152701928, 'support': 821108}, '2': {'precision': 0.5436151755935641, 'recall': 0.36269074033943455, 'f1-score': 0.4350941266731341, 'support': 189197}, 'accuracy': 0.7304460791070899, 'macro avg': {'precision': 0.614475993879291, 'recall': 0.5719238703804056, 'f1-score': 0.5867070102937372, 'support': 1196985}, 'weighted avg': {'precision': 0.7153730066241456, 'recall': 0.7304460791070899, 'f1-score': 0.7191302254454139, 'support': 1196985}}
[[ 89838  78439  18403]
 [ 66027 715875  39206]
 [ 25739  94838  68620]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60886467
{'0': {'precision': 0.5128899706867671, 'recall': 0.4550446998722861, 'f1-score': 0.4822388739187676, 'support': 86130}, '1': {'precision': 0.8078353700312667, 'recall': 0.8817620393056919, 'f1-score': 0.8431814103947638, 'support': 367733}, '2': {'precision': 0.5548160893419473, 'recall': 0.39956046011409335, 'f1-score': 0.4645599728168536, 'support': 85544}, 'accuracy': 0.7371539486880964, 'macro avg': {'precision': 0.6251804766866603, 'recall': 0.5787890664306904, 'f1-score': 0.5966600857101283, 'support': 539407}, 'weighted avg': {'precision': 0.720613794128787, 'recall': 0.7371539486880964, 'f1-score': 0.7255026021426604, 'support': 539407}}
[[ 39193  37116   9821]
 [ 25875 324253  17605]
 [ 11348  40016  34180]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6549722
{'0': {'precision': 0.5031224880974463, 'recall': 0.4527850425685827, 'f1-score': 0.47662839737582, 'support': 35942}, '1': {'precision': 0.7932281189296059, 'recall': 0.8626545878284404, 'f1-score': 0.82648592584056, 'support': 133015}, '2': {'precision': 0.5423317396101508, 'recall': 0.4184924509024861, 'f1-score': 0.4724313587287348, 'support': 35236}, 'accuracy': 0.7138638445000564, 'macro avg': {'precision': 0.6128941155457343, 'recall': 0.5779773604331697, 'f1-score': 0.5918485606483715, 'support': 204193}, 'weighted avg': {'precision': 0.6988685600560411, 'recall': 0.7138638445000564, 'f1-score': 0.7038076459052441, 'support': 204193}}
[[ 16274  14656   5012]
 [ 10837 114746   7432]
 [  5235  15255  14746]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8446399
{'0': {'precision': 0.4351385669358768, 'recall': 0.5109815565332351, 'f1-score': 0.4700201945293359, 'support': 230705}, '1': {'precision': 0.7159811173907668, 'recall': 0.774446075677683, 'f1-score': 0.7440668946478839, 'support': 635511}, '2': {'precision': 0.5389862973331369, 'recall': 0.32110425947464283, 'f1-score': 0.4024478457582133, 'support': 227845}, 'accuracy': 0.6244779770049385, 'macro avg': {'precision': 0.5633686605532602, 'recall': 0.5355106305618537, 'f1-score': 0.538844978311811, 'support': 1094061}, 'weighted avg': {'precision': 0.6198994863128597, 'recall': 0.6244779770049385, 'f1-score': 0.6151342883808507, 'support': 1094061}}
[[117886  89983  22836]
 [103600 492169  39742]
 [ 49430 105253  73162]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70688
{'0': {'precision': 0.4658300628645728, 'recall': 0.4496839050678827, 'f1-score': 0.45761460579356894, 'support': 86841}, '1': {'precision': 0.7751004125201776, 'recall': 0.8619795523024059, 'f1-score': 0.8162346628510105, 'support': 330893}, '2': {'precision': 0.5436850883177924, 'recall': 0.33033174809714083, 'f1-score': 0.4109679314074509, 'support': 86843}, 'accuracy': 0.6995186066745016, 'macro avg': {'precision': 0.5948718545675142, 'recall': 0.5473317351558098, 'f1-score': 0.5616057333506768, 'support': 504577}, 'weighted avg': {'precision': 0.682043956450737, 'recall': 0.6995186066745016, 'f1-score': 0.6847631468412075, 'support': 504577}}
[[ 39051  39029   8761]
 [ 30354 285223  15316]
 [ 14426  43730  28687]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7287147
{'0': {'precision': 0.4742632483150522, 'recall': 0.4478380233356211, 'f1-score': 0.46067199383845187, 'support': 32054}, '1': {'precision': 0.762208433014354, 'recall': 0.8677958888368728, 'f1-score': 0.81158232004617, 'support': 117485}, '2': {'precision': 0.5618199210809518, 'recall': 0.30104116610603876, 'f1-score': 0.3920235289209653, 'support': 31215}, 'accuracy': 0.695447956891687, 'macro avg': {'precision': 0.5994305341367859, 'recall': 0.5388916927595109, 'f1-score': 0.5547592809351957, 'support': 180754}, 'weighted avg': {'precision': 0.6765399424119188, 'recall': 0.695447956891687, 'f1-score': 0.676898676745134, 'support': 180754}}
[[ 14355  15186   2513]
 [ 10716 101953   4816]
 [  5197  16621   9397]]
testing model on single stock: results/universal/W4/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
12724/12724 - 101s - 101s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9905443
{'0': {'precision': 0.4626871746952023, 'recall': 0.5710154613618841, 'f1-score': 0.5111751122790346, 'support': 915702}, '1': {'precision': 0.6002147339065768, 'recall': 0.4556380249129908, 'f1-score': 0.518028017820624, 'support': 1417092}, '2': {'precision': 0.47308520221173994, 'recall': 0.5380586769715767, 'f1-score': 0.5034844263755487, 'support': 924349}, 'accuracy': 0.5114651091462672, 'macro avg': {'precision': 0.5119957036045063, 'recall': 0.5215707210821505, 'f1-score': 0.5108958521584024, 'support': 3257143}, 'weighted avg': {'precision': 0.5254724470258458, 'recall': 0.5114651091462672, 'f1-score': 0.5119740700759569, 'support': 3257143}}
[[522880 198490 194332]
 [411798 645681 359613]
 [195416 231579 497354]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0209973
{'0': {'precision': 0.4771984702567783, 'recall': 0.6095303253172785, 'f1-score': 0.5353073186265821, 'support': 438495}, '1': {'precision': 0.5397637846205591, 'recall': 0.28258057525210456, 'f1-score': 0.37095593573949665, 'support': 442971}, '2': {'precision': 0.49414356886706495, 'recall': 0.5944725351537323, 'f1-score': 0.5396847961909353, 'support': 440636}, 'accuracy': 0.4949671054124417, 'macro avg': {'precision': 0.5037019412481342, 'recall': 0.4955278119077051, 'f1-score': 0.4819826835190047, 'support': 1322102}, 'weighted avg': {'precision': 0.5038085505231122, 'recall': 0.4949671054124417, 'f1-score': 0.4817002427543508, 'support': 1322102}}
[[267276  50399 120820]
 [170461 125175 147335]
 [122357  56333 261946]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0130169
{'0': {'precision': 0.47852915006383223, 'recall': 0.6037952285069254, 'f1-score': 0.5339131654625797, 'support': 163890}, '1': {'precision': 0.5629465415245967, 'recall': 0.29851585410264436, 'f1-score': 0.3901469605878423, 'support': 156521}, '2': {'precision': 0.49763194190905036, 'recall': 0.5891000552260667, 'f1-score': 0.5395166521896888, 'support': 166588}, 'accuracy': 0.5006519520573964, 'macro avg': {'precision': 0.5130358778324932, 'recall': 0.4971370459452122, 'f1-score': 0.48785892608003695, 'support': 486999}, 'weighted avg': {'precision': 0.5121953186119023, 'recall': 0.5006519520573964, 'f1-score': 0.48962363610768755, 'support': 486999}}
[[98956 15711 49223]
 [59949 46724 49848]
 [47887 20564 98137]]
training model: results/universal/W4/deepOF_L2/h20
Epoch 1/50
9854/9854 - 223s - loss: 2.7349 - accuracy20: 0.5510 - val_loss: 2.8988 - val_accuracy20: 0.5563 - 223s/epoch - 23ms/step
Epoch 2/50
9854/9854 - 217s - loss: 2.6532 - accuracy20: 0.5694 - val_loss: 2.8982 - val_accuracy20: 0.5565 - 217s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 219s - loss: 2.6295 - accuracy20: 0.5736 - val_loss: 2.9046 - val_accuracy20: 0.5572 - 219s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 217s - loss: 2.6163 - accuracy20: 0.5757 - val_loss: 2.9057 - val_accuracy20: 0.5594 - 217s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 218s - loss: 2.6066 - accuracy20: 0.5775 - val_loss: 2.9121 - val_accuracy20: 0.5599 - 218s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 220s - loss: 2.5998 - accuracy20: 0.5786 - val_loss: 2.8923 - val_accuracy20: 0.5626 - 220s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 222s - loss: 2.5938 - accuracy20: 0.5799 - val_loss: 2.8815 - val_accuracy20: 0.5624 - 222s/epoch - 23ms/step
Epoch 8/50
9854/9854 - 218s - loss: 2.5891 - accuracy20: 0.5806 - val_loss: 2.8706 - val_accuracy20: 0.5635 - 218s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 217s - loss: 2.5848 - accuracy20: 0.5814 - val_loss: 2.8665 - val_accuracy20: 0.5641 - 217s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 217s - loss: 2.5806 - accuracy20: 0.5822 - val_loss: 2.8650 - val_accuracy20: 0.5622 - 217s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 217s - loss: 2.5770 - accuracy20: 0.5829 - val_loss: 2.8646 - val_accuracy20: 0.5602 - 217s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 217s - loss: 2.5734 - accuracy20: 0.5836 - val_loss: 2.8523 - val_accuracy20: 0.5616 - 217s/epoch - 22ms/step
Epoch 13/50
9854/9854 - 220s - loss: 2.5707 - accuracy20: 0.5840 - val_loss: 2.8504 - val_accuracy20: 0.5626 - 220s/epoch - 22ms/step
Epoch 14/50
9854/9854 - 217s - loss: 2.5678 - accuracy20: 0.5845 - val_loss: 2.8459 - val_accuracy20: 0.5609 - 217s/epoch - 22ms/step
Epoch 15/50
9854/9854 - 219s - loss: 2.5654 - accuracy20: 0.5849 - val_loss: 2.8521 - val_accuracy20: 0.5608 - 219s/epoch - 22ms/step
Epoch 16/50
9854/9854 - 218s - loss: 2.5625 - accuracy20: 0.5854 - val_loss: 2.8412 - val_accuracy20: 0.5597 - 218s/epoch - 22ms/step
Epoch 17/50
9854/9854 - 219s - loss: 2.5605 - accuracy20: 0.5858 - val_loss: 2.8392 - val_accuracy20: 0.5629 - 219s/epoch - 22ms/step
Epoch 18/50
9854/9854 - 220s - loss: 2.5583 - accuracy20: 0.5864 - val_loss: 2.8381 - val_accuracy20: 0.5615 - 220s/epoch - 22ms/step
Epoch 19/50
9854/9854 - 222s - loss: 2.5561 - accuracy20: 0.5867 - val_loss: 2.8478 - val_accuracy20: 0.5616 - 222s/epoch - 23ms/step
Epoch 20/50
9854/9854 - 222s - loss: 2.5538 - accuracy20: 0.5871 - val_loss: 2.8464 - val_accuracy20: 0.5618 - 222s/epoch - 22ms/step
Epoch 21/50
9854/9854 - 219s - loss: 2.5518 - accuracy20: 0.5873 - val_loss: 2.8375 - val_accuracy20: 0.5621 - 219s/epoch - 22ms/step
Epoch 22/50
9854/9854 - 218s - loss: 2.5502 - accuracy20: 0.5878 - val_loss: 2.8372 - val_accuracy20: 0.5620 - 218s/epoch - 22ms/step
Epoch 23/50
9854/9854 - 218s - loss: 2.5483 - accuracy20: 0.5882 - val_loss: 2.8407 - val_accuracy20: 0.5618 - 218s/epoch - 22ms/step
Epoch 24/50
9854/9854 - 218s - loss: 2.5465 - accuracy20: 0.5884 - val_loss: 2.8375 - val_accuracy20: 0.5637 - 218s/epoch - 22ms/step
Epoch 25/50
9854/9854 - 223s - loss: 2.5452 - accuracy20: 0.5884 - val_loss: 2.8347 - val_accuracy20: 0.5625 - 223s/epoch - 23ms/step
Epoch 26/50
9854/9854 - 219s - loss: 2.5439 - accuracy20: 0.5888 - val_loss: 2.8333 - val_accuracy20: 0.5634 - 219s/epoch - 22ms/step
Epoch 27/50
9854/9854 - 226s - loss: 2.5423 - accuracy20: 0.5892 - val_loss: 2.8389 - val_accuracy20: 0.5625 - 226s/epoch - 23ms/step
Epoch 28/50
9854/9854 - 223s - loss: 2.5409 - accuracy20: 0.5894 - val_loss: 2.8361 - val_accuracy20: 0.5611 - 223s/epoch - 23ms/step
Epoch 29/50
9854/9854 - 223s - loss: 2.5396 - accuracy20: 0.5899 - val_loss: 2.8372 - val_accuracy20: 0.5609 - 223s/epoch - 23ms/step
Epoch 30/50
9854/9854 - 225s - loss: 2.5380 - accuracy20: 0.5901 - val_loss: 2.8379 - val_accuracy20: 0.5620 - 225s/epoch - 23ms/step
Epoch 31/50
9854/9854 - 224s - loss: 2.5367 - accuracy20: 0.5901 - val_loss: 2.8401 - val_accuracy20: 0.5618 - 224s/epoch - 23ms/step
Epoch 32/50
9854/9854 - 226s - loss: 2.5354 - accuracy20: 0.5904 - val_loss: 2.8378 - val_accuracy20: 0.5626 - 226s/epoch - 23ms/step
Epoch 33/50
9854/9854 - 224s - loss: 2.5342 - accuracy20: 0.5907 - val_loss: 2.8437 - val_accuracy20: 0.5605 - 224s/epoch - 23ms/step
Epoch 34/50
9854/9854 - 218s - loss: 2.5331 - accuracy20: 0.5907 - val_loss: 2.8448 - val_accuracy20: 0.5619 - 218s/epoch - 22ms/step
Epoch 35/50
9854/9854 - 217s - loss: 2.5320 - accuracy20: 0.5910 - val_loss: 2.8409 - val_accuracy20: 0.5625 - 217s/epoch - 22ms/step
Epoch 36/50
9854/9854 - 218s - loss: 2.5306 - accuracy20: 0.5912 - val_loss: 2.8447 - val_accuracy20: 0.5623 - 218s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 177s - 177s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95964813
{'0': {'precision': 0.4259759893856328, 'recall': 0.5891469270963775, 'f1-score': 0.49444740353831257, 'support': 1465373}, '1': {'precision': 0.7372970250137121, 'recall': 0.5769458421064194, 'f1-score': 0.6473391845926009, 'support': 3140761}, '2': {'precision': 0.44860108667163967, 'recall': 0.4858718355866383, 'f1-score': 0.46649320324996585, 'support': 1465477}, 'accuracy': 0.5579084364923905, 'macro avg': {'precision': 0.5372913670236615, 'recall': 0.550654868263145, 'f1-score': 0.5360932637936264, 'support': 6071611}, 'weighted avg': {'precision': 0.5924790026510885, 'recall': 0.5579084364923905, 'f1-score': 0.566789044921445, 'support': 6071611}}
[[ 863320  301352  300701]
 [ 754215 1812049  574497]
 [ 409152  344291  712034]]
Evaluating performance on  train set...
9854/9854 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95047706
{'0': {'precision': 0.4523936422477066, 'recall': 0.5854815516273849, 'f1-score': 0.5104045904028578, 'support': 684288}, '1': {'precision': 0.7331868598326564, 'recall': 0.5865902670147044, 'f1-score': 0.6517468247207343, 'support': 1154281}, '2': {'precision': 0.4788359009101888, 'recall': 0.49949300967890614, 'f1-score': 0.488946371101152, 'support': 683445}, 'accuracy': 0.5626868050692819, 'macro avg': {'precision': 0.5548054676635172, 'recall': 0.5571882761069985, 'f1-score': 0.5503659287415813, 'support': 2522014}, 'weighted avg': {'precision': 0.5880733432560094, 'recall': 0.5626868050692819, 'f1-score': 0.5692794193609915, 'support': 2522014}}
[[400638 117862 165788]
 [271426 677090 205765]
 [213532 128537 341376]]
Evaluating performance on  val set...
3566/3566 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94959533
{'0': {'precision': 0.4524867408121077, 'recall': 0.580074986609534, 'f1-score': 0.5083981579929199, 'support': 250178}, '1': {'precision': 0.737977056805139, 'recall': 0.593631419939577, 'f1-score': 0.6579807439871841, 'support': 413750}, '2': {'precision': 0.4755337975162863, 'recall': 0.495413028689201, 'f1-score': 0.48526990873908527, 'support': 248421}, 'accuracy': 0.5631704534120167, 'macro avg': {'precision': 0.5553325317111777, 'recall': 0.5563731450794372, 'f1-score': 0.550549603573063, 'support': 912349}, 'weighted avg': {'precision': 0.5882319338419959, 'recall': 0.5631704534120167, 'f1-score': 0.5699362888477134, 'support': 912349}}
[[145122  41700  63356]
 [ 95756 245615  72379]
 [ 79843  45507 123071]]
testing model out of sample: results/universal/W4/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 91s - 91s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.934638
{'0': {'precision': 0.44683685704623016, 'recall': 0.560162083549599, 'f1-score': 0.4971227967760731, 'support': 778364}, '1': {'precision': 0.6829000857592648, 'recall': 0.6821864125804326, 'f1-score': 0.6825430626141223, 'support': 1491777}, '2': {'precision': 0.4908368308835749, 'recall': 0.3645974095217084, 'f1-score': 0.4184023238377986, 'support': 761481}, 'accuracy': 0.5710850495213453, 'macro avg': {'precision': 0.5401912578963566, 'recall': 0.5356486352172466, 'f1-score': 0.5326893944093313, 'support': 3031622}, 'weighted avg': {'precision': 0.5740489036725839, 'recall': 0.5710850495213453, 'f1-score': 0.568589999302502, 'support': 3031622}}
[[ 436010  217697  124657]
 [ 310764 1017670  163343]
 [ 228996  254851  277634]]
Evaluating performance on  train set...
5528/5528 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81598634
{'0': {'precision': 0.46417013268767454, 'recall': 0.4945642977328093, 'f1-score': 0.4788854314964841, 'support': 313207}, '1': {'precision': 0.7375278757133503, 'recall': 0.8024453628112165, 'f1-score': 0.7686183227147606, 'support': 788840}, '2': {'precision': 0.5144069548956676, 'recall': 0.3663065571933868, 'f1-score': 0.4279045071017655, 'support': 312405}, 'accuracy': 0.6379417611909064, 'macro avg': {'precision': 0.5720349877655642, 'recall': 0.5544387392458042, 'f1-score': 0.55846942043767, 'support': 1414452}, 'weighted avg': {'precision': 0.6277173979538427, 'recall': 0.6379417611909064, 'f1-score': 0.6292095133480373, 'support': 1414452}}
[[154901 107476  50830]
 [ 98643 633001  57196]
 [ 80172 117797 114436]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8479025
{'0': {'precision': 0.46977734258589127, 'recall': 0.49024364237351387, 'f1-score': 0.47979233608856153, 'support': 112542}, '1': {'precision': 0.716218481358205, 'recall': 0.7937777710377458, 'f1-score': 0.7530062525737692, 'support': 263764}, '2': {'precision': 0.5078298626723019, 'recall': 0.3551464841117969, 'f1-score': 0.4179813060395872, 'support': 111309}, 'accuracy': 0.6235944341334865, 'macro avg': {'precision': 0.5646085622054661, 'recall': 0.5463892991743522, 'f1-score': 0.5502599649006393, 'support': 487615}, 'weighted avg': {'precision': 0.611770284733772, 'recall': 0.6235944341334865, 'f1-score': 0.6134713072524572, 'support': 487615}}
[[ 55173  39509  17860]
 [ 33942 209370  20452]
 [ 28330  43448  39531]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.10857
{'0': {'precision': 0.4608911030425849, 'recall': 0.6211945903909258, 'f1-score': 0.5291689220303928, 'support': 52721}, '1': {'precision': 0.531340620120455, 'recall': 0.07487740475292343, 'f1-score': 0.13125774900123985, 'support': 31812}, '2': {'precision': 0.47889836194341256, 'recall': 0.5615250302204655, 'f1-score': 0.5169307402893327, 'support': 52117}, 'accuracy': 0.4712550311013538, 'macro avg': {'precision': 0.4903766950354842, 'recall': 0.4191990084547716, 'f1-score': 0.39245247044032183, 'support': 136650}, 'weighted avg': {'precision': 0.4841594846702149, 'recall': 0.4712550311013538, 'f1-score': 0.431868025182956, 'support': 136650}}
[[32750  1161 18810]
 [16396  2382 13034]
 [21912   940 29265]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.281681
{'0': {'precision': 0.3560468003063677, 'recall': 0.6479069543903494, 'f1-score': 0.4595534344639509, 'support': 20807}, '1': {'precision': 0.6098130841121495, 'recall': 0.0911909857186531, 'f1-score': 0.15865658599597277, 'support': 22897}, '2': {'precision': 0.42072990231318985, 'recall': 0.46862929816297694, 'f1-score': 0.4433897096508234, 'support': 21230}, 'accuracy': 0.3929836449317769, 'macro avg': {'precision': 0.46219659557723575, 'recall': 0.4025757460906598, 'f1-score': 0.3538665767035824, 'support': 64934}, 'weighted avg': {'precision': 0.46667773103458127, 'recall': 0.3929836449317769, 'f1-score': 0.34816662605612153, 'support': 64934}}
[[13481   668  6658]
 [13769  2088  7040]
 [10613   668  9949]]
Evaluating performance on  val set...
81/81 - 1s - 820ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2662165
{'0': {'precision': 0.376769838656569, 'recall': 0.6580877066858375, 'f1-score': 0.47919174998691305, 'support': 6955}, '1': {'precision': 0.558282208588957, 'recall': 0.06766805472932778, 'f1-score': 0.12070566388115135, 'support': 6724}, '2': {'precision': 0.4271527505553378, 'recall': 0.47124117053481335, 'f1-score': 0.44811514736120633, 'support': 6937}, 'accuracy': 0.4026484284051222, 'macro avg': {'precision': 0.45406826593362126, 'recall': 0.39899897731665956, 'f1-score': 0.3493375204097569, 'support': 20616}, 'weighted avg': {'precision': 0.45292406039052013, 'recall': 0.4026484284051222, 'f1-score': 0.3518130715143835, 'support': 20616}}
[[4577  175 2203]
 [4088  455 2181]
 [3483  185 3269]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.488944
{'0': {'precision': 0.5118274810661946, 'recall': 0.44865715394232014, 'f1-score': 0.47816498587213707, 'support': 46394}, '1': {'precision': 0.8626795109384772, 'recall': 0.9415002363784937, 'f1-score': 0.9003681198343085, 'support': 319403}, '2': {'precision': 0.5987028951718876, 'recall': 0.30020404693079406, 'f1-score': 0.39989241070796583, 'support': 47048}, 'accuracy': 0.8130339473652339, 'macro avg': {'precision': 0.6577366290588531, 'recall': 0.5634538124172026, 'f1-score': 0.5928085054714705, 'support': 412845}, 'weighted avg': {'precision': 0.7931691598563976, 'recall': 0.8130339473652339, 'f1-score': 0.7958880525935349, 'support': 412845}}
[[ 20815  20772   4807]
 [ 14025 300718   4660]
 [  5828  27096  14124]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.542364
{'0': {'precision': 0.5484182976786527, 'recall': 0.4484924623115578, 'f1-score': 0.49344732261697555, 'support': 21492}, '1': {'precision': 0.8367434153802322, 'recall': 0.9377305381674579, 'f1-score': 0.8843633366878768, 'support': 119015}, '2': {'precision': 0.6159736443771703, 'recall': 0.3191106600857973, 'f1-score': 0.4204193254329991, 'support': 21679}, 'accuracy': 0.7902100057958147, 'macro avg': {'precision': 0.6670451191453517, 'recall': 0.5684445535216044, 'f1-score': 0.5994099949126172, 'support': 162186}, 'weighted avg': {'precision': 0.7690264034604751, 'recall': 0.7902100057958147, 'f1-score': 0.7705470443173498, 'support': 162186}}
[[  9639   9923   1930]
 [  5028 111604   2383]
 [  2909  11852   6918]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.47707444
{'0': {'precision': 0.5656751776783364, 'recall': 0.3937339684866251, 'f1-score': 0.46429728853840335, 'support': 5458}, '1': {'precision': 0.8650230924347883, 'recall': 0.9605142774594309, 'f1-score': 0.9102711829600812, 'support': 41534}, '2': {'precision': 0.6061899679829242, 'recall': 0.29701934809133695, 'f1-score': 0.3986897519887694, 'support': 5737}, 'accuracy': 0.8296573043296858, 'macro avg': {'precision': 0.6789627460320163, 'recall': 0.5504225313457977, 'f1-score': 0.5910860744957513, 'support': 52729}, 'weighted avg': {'precision': 0.8058760091652202, 'recall': 0.8296573043296858, 'f1-score': 0.8084473633307324, 'support': 52729}}
[[ 2149  2813   496]
 [ 1029 39894   611]
 [  621  3412  1704]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1815616
{'0': {'precision': 0.3800232912299561, 'recall': 0.5779879012480245, 'f1-score': 0.4585517711024396, 'support': 73396}, '1': {'precision': 0.5924556696983576, 'recall': 0.33504782697182184, 'f1-score': 0.428032854694794, 'support': 108098}, '2': {'precision': 0.41543333790506587, 'recall': 0.4661890836842915, 'f1-score': 0.4393501852657674, 'support': 71471}, 'accuracy': 0.4425869191390113, 'macro avg': {'precision': 0.46263743294445986, 'recall': 0.4597416039680459, 'f1-score': 0.4419782703543336, 'support': 252965}, 'weighted avg': {'precision': 0.48080524404395814, 'recall': 0.4425869191390113, 'f1-score': 0.4400852228955079, 'support': 252965}}
[[42422 12506 18468]
 [43464 36218 28416]
 [25744 12408 33319]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.121086
{'0': {'precision': 0.4224705699320645, 'recall': 0.5687308014521083, 'f1-score': 0.48480971226232633, 'support': 28648}, '1': {'precision': 0.5477166609725543, 'recall': 0.33339109940385414, 'f1-score': 0.41448700823027534, 'support': 28852}, '2': {'precision': 0.4543930027620676, 'recall': 0.47586088154269973, 'f1-score': 0.46487923030343803, 'support': 29040}, 'accuracy': 0.4591056159001618, 'macro avg': {'precision': 0.47486007788889556, 'recall': 0.4593275941328874, 'f1-score': 0.4547253169320132, 'support': 86540}, 'weighted avg': {'precision': 0.4749391124336072, 'recall': 0.4591056159001618, 'f1-score': 0.4546764576653902, 'support': 86540}}
[[16293  3784  8571]
 [11211  9619  8022]
 [11062  4159 13819]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.122509
{'0': {'precision': 0.42731161566304704, 'recall': 0.5952511917858453, 'f1-score': 0.49749070988009036, 'support': 10908}, '1': {'precision': 0.47992916174734357, 'recall': 0.2632203755665875, 'f1-score': 0.33997769724003346, 'support': 9266}, '2': {'precision': 0.46841403820524213, 'recall': 0.46416622644831834, 'f1-score': 0.46628045814354574, 'support': 11358}, 'accuracy': 0.45046302169224917, 'macro avg': {'precision': 0.45855160520521093, 'recall': 0.4408792646002504, 'f1-score': 0.43458295508788986, 'support': 31532}, 'weighted avg': {'precision': 0.45757913745840867, 'recall': 0.45046302169224917, 'f1-score': 0.4399617991117775, 'support': 31532}}
[[6493 1153 3262]
 [4106 2439 2721]
 [4596 1490 5272]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5231714
{'0': {'precision': 0.306991449657011, 'recall': 0.5306629950686317, 'f1-score': 0.38896469340363415, 'support': 71177}, '1': {'precision': 0.8742559523809523, 'recall': 0.04599140841349212, 'f1-score': 0.08738577099350185, 'support': 102193}, '2': {'precision': 0.3024437097101904, 'recall': 0.5171825647504737, 'f1-score': 0.3816827701954568, 'support': 63320}, 'accuracy': 0.31779542861971355, 'macro avg': {'precision': 0.49456370391605126, 'recall': 0.36461232274419925, 'f1-score': 0.28601107819753097, 'support': 236690}, 'weighted avg': {'precision': 0.5506962890394735, 'recall': 0.31779542861971355, 'f1-score': 0.25680724612913824, 'support': 236690}}
[[37771   379 33027]
 [54990  4700 42503]
 [30275   297 32748]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.380978
{'0': {'precision': 0.35163447909284196, 'recall': 0.5330714477571851, 'f1-score': 0.42374826518629227, 'support': 29784}, '1': {'precision': 0.6464788732394366, 'recall': 0.01566820276497696, 'f1-score': 0.03059490084985836, 'support': 29295}, '2': {'precision': 0.36886224740674833, 'recall': 0.5341810783316379, 'f1-score': 0.43638932365610766, 'support': 29490}, 'accuracy': 0.36230509546229495, 'macro avg': {'precision': 0.4556585332463423, 'recall': 0.3609735762846, 'f1-score': 0.29691082989741946, 'support': 88569}, 'weighted avg': {'precision': 0.4548931069886248, 'recall': 0.36230509546229495, 'f1-score': 0.2979182005591544, 'support': 88569}}
[[15877   133 13774]
 [15656   459 13180]
 [13619   118 15753]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4013737
{'0': {'precision': 0.35836291781097196, 'recall': 0.49172794117647056, 'f1-score': 0.4145840598240924, 'support': 10880}, '1': {'precision': 0.7804878048780488, 'recall': 0.014530923621832713, 'f1-score': 0.02853067047075606, 'support': 11011}, '2': {'precision': 0.34342903828197946, 'recall': 0.5670103092783505, 'f1-score': 0.42776667272396873, 'support': 10379}, 'accuracy': 0.3531143476913542, 'macro avg': {'precision': 0.494093253657, 'recall': 0.3577563913588846, 'f1-score': 0.2902938010062724, 'support': 32270}, 'weighted avg': {'precision': 0.4975949722226289, 'recall': 0.3531143476913542, 'f1-score': 0.2870968726260208, 'support': 32270}}
[[5350   21 5509]
 [5109  160 5742]
 [4470   24 5885]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2130749
{'0': {'precision': 0.38271895196124534, 'recall': 0.5585594931254338, 'f1-score': 0.45421480738844494, 'support': 125317}, '1': {'precision': 0.5470712484953099, 'recall': 0.2990353697749196, 'f1-score': 0.3866974907287001, 'support': 161098}, '2': {'precision': 0.396356927057682, 'recall': 0.4471868365180467, 'f1-score': 0.4202404380102488, 'support': 120576}, 'accuracy': 0.4228373600399026, 'macro avg': {'precision': 0.4420490425047457, 'recall': 0.43492723313946674, 'f1-score': 0.42038424537579794, 'support': 406991}, 'weighted avg': {'precision': 0.45181443257942283, 'recall': 0.4228373600399026, 'f1-score': 0.41742431757074144, 'support': 406991}}
[[69997 19703 35617]
 [66422 48174 46502]
 [46475 20181 53920]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1732215
{'0': {'precision': 0.41202552692837574, 'recall': 0.5663321942406896, 'f1-score': 0.4770102298977011, 'support': 45943}, '1': {'precision': 0.506214033560617, 'recall': 0.22999011314951115, 'f1-score': 0.31628244251744875, 'support': 45515}, '2': {'precision': 0.43308753877300843, 'recall': 0.5045986712545175, 'f1-score': 0.4661162641931873, 'support': 46209}, 'accuracy': 0.43441057043445414, 'macro avg': {'precision': 0.4504423664206671, 'recall': 0.43364032621490606, 'f1-score': 0.41980297886944573, 'support': 137667}, 'weighted avg': {'precision': 0.4502354420474319, 'recall': 0.43441057043445414, 'f1-score': 0.4202143056467763, 'support': 137667}}
[[26019  5132 14792]
 [19317 10468 15730]
 [17813  5079 23317]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2167007
{'0': {'precision': 0.396335865119773, 'recall': 0.5511897852582704, 'f1-score': 0.4611089531947951, 'support': 17230}, '1': {'precision': 0.5001779148380975, 'recall': 0.2215509088998634, 'f1-score': 0.30708174039686875, 'support': 19034}, '2': {'precision': 0.4194236420513793, 'recall': 0.5136704011145296, 'f1-score': 0.4617873450750163, 'support': 17227}, 'accuracy': 0.4218092763268587, 'macro avg': {'precision': 0.43864580733641656, 'recall': 0.4288036984242211, 'f1-score': 0.40999267955556, 'support': 53491}, 'weighted avg': {'precision': 0.44072207415567377, 'recall': 0.4218092763268587, 'f1-score': 0.4065190724396183, 'support': 53491}}
[[9497 2165 5568]
 [8136 4217 6681]
 [6329 2049 8849]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/EXC
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59878594
{'0': {'precision': 0.5427213328208709, 'recall': 0.4478063050527147, 'f1-score': 0.4907163120567376, 'support': 154511}, '1': {'precision': 0.7983696015621865, 'recall': 0.9180852569150507, 'f1-score': 0.8540525923456518, 'support': 650176}, '2': {'precision': 0.6245675672762935, 'recall': 0.35497148737297946, 'f1-score': 0.4526694005077133, 'support': 163261}, 'accuracy': 0.748037084636778, 'macro avg': {'precision': 0.655219500553117, 'recall': 0.573621016446915, 'f1-score': 0.5991461016367009, 'support': 967948}, 'weighted avg': {'precision': 0.7282464507616904, 'recall': 0.748037084636778, 'f1-score': 0.7283540286972181, 'support': 967948}}
[[ 69191  69386  15934]
 [ 34357 596917  18902]
 [ 23941  81367  57953]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6352137
{'0': {'precision': 0.5870544786273436, 'recall': 0.42476857771186005, 'f1-score': 0.49289704235068954, 'support': 78212}, '1': {'precision': 0.75451379016207, 'recall': 0.9199746288883986, 'f1-score': 0.8290693876391729, 'support': 253832}, '2': {'precision': 0.6172044980876257, 'recall': 0.3468071963554938, 'f1-score': 0.44408374461353395, 'support': 77706}, 'accuracy': 0.7167541183648566, 'macro avg': {'precision': 0.6529242556256797, 'recall': 0.5638501343185841, 'f1-score': 0.5886833915344655, 'support': 409750}, 'weighted avg': {'precision': 0.6965099255526965, 'recall': 0.7167541183648566, 'f1-score': 0.6918920701366638, 'support': 409750}}
[[ 33222  36555   8435]
 [ 12034 233519   8279]
 [ 11335  39422  26949]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5888942
{'0': {'precision': 0.5885331999499812, 'recall': 0.4109044875152785, 'f1-score': 0.48393398796977016, 'support': 22908}, '1': {'precision': 0.7841764039308206, 'recall': 0.9321629678701557, 'f1-score': 0.8517898220267163, 'support': 90570}, '2': {'precision': 0.6159014557670772, 'recall': 0.3395061728395062, 'f1-score': 0.4377238360525269, 'support': 22680}, 'accuracy': 0.7457439151573907, 'macro avg': {'precision': 0.6628703532159597, 'recall': 0.5608578760749802, 'f1-score': 0.5911492153496711, 'support': 136158}, 'weighted avg': {'precision': 0.723230515028613, 'recall': 0.7457439151573907, 'f1-score': 0.7209281906244399, 'support': 136158}}
[[ 9413 11307  2188]
 [ 3530 84426  2614]
 [ 3051 11929  7700]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/AAL
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72890604
{'0': {'precision': 0.519353164406174, 'recall': 0.5328831345707251, 'f1-score': 0.5260311632797284, 'support': 229084}, '1': {'precision': 0.7473556682421955, 'recall': 0.8466195703112492, 'f1-score': 0.7938968177336204, 'support': 687102}, '2': {'precision': 0.5757017406303905, 'recall': 0.32666871321223123, 'f1-score': 0.4168215969504044, 'support': 224769}, 'accuracy': 0.6811960156184951, 'macro avg': {'precision': 0.6141368577595866, 'recall': 0.5687238060314018, 'f1-score': 0.5789165259879178, 'support': 1140955}, 'weighted avg': {'precision': 0.6677607611300403, 'recall': 0.6811960156184951, 'f1-score': 0.6658299300078659, 'support': 1140955}}
[[122075  87365  19644]
 [ 70917 581714  34471]
 [ 42060 109284  73425]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63251746
{'0': {'precision': 0.5269416896334715, 'recall': 0.4628448892065761, 'f1-score': 0.49281789260580355, 'support': 104925}, '1': {'precision': 0.7864123014261761, 'recall': 0.9051314585139304, 'f1-score': 0.8416057925789336, 'support': 412982}, '2': {'precision': 0.6038125645600526, 'recall': 0.31266107150845596, 'f1-score': 0.4119893382541391, 'support': 102827}, 'accuracy': 0.7322250754751632, 'macro avg': {'precision': 0.6390555185399002, 'recall': 0.5602124730763208, 'f1-score': 0.5821376744796254, 'support': 620734}, 'weighted avg': {'precision': 0.7123046529244308, 'recall': 0.7322250754751632, 'f1-score': 0.7114812278643596, 'support': 620734}}
[[ 48564  47837   8524]
 [ 26608 373803  12571]
 [ 16990  53687  32150]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6465627
{'0': {'precision': 0.545624146317087, 'recall': 0.4628645715577662, 'f1-score': 0.5008486108775095, 'support': 35384}, '1': {'precision': 0.7751919777129697, 'recall': 0.9051130477177158, 'f1-score': 0.835129768577905, 'support': 131272}, '2': {'precision': 0.5910104840508588, 'recall': 0.3066018631024706, 'f1-score': 0.4037487142367328, 'support': 34566}, 'accuracy': 0.7245331027422449, 'macro avg': {'precision': 0.6372755360269718, 'recall': 0.5581931607926509, 'f1-score': 0.5799090312307158, 'support': 201222}, 'weighted avg': {'precision': 0.7031847138152028, 'recall': 0.7245331027422449, 'f1-score': 0.702245083958789, 'support': 201222}}
[[ 16378  15997   3009]
 [  8131 118816   4325]
 [  5508  18460  10598]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/WBA
Evaluating performance on  test set...
4676/4676 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7585621
{'0': {'precision': 0.5247502631635481, 'recall': 0.4895326046438921, 'f1-score': 0.5065300248427111, 'support': 249489}, '1': {'precision': 0.7270910918447818, 'recall': 0.8496550296376912, 'f1-score': 0.7836094787534209, 'support': 695567}, '2': {'precision': 0.5777986171189318, 'recall': 0.347288323297437, 'f1-score': 0.4338245502687479, 'support': 251929}, 'accuracy': 0.6688613474688488, 'macro avg': {'precision': 0.6098799907090873, 'recall': 0.5621586525263401, 'f1-score': 0.5746546846216266, 'support': 1196985}, 'weighted avg': {'precision': 0.6534954203267086, 'recall': 0.6688613474688488, 'f1-score': 0.652238372912542, 'support': 1196985}}
[[122133 102523  24833]
 [ 65477 590992  39098]
 [ 45135 119302  87492]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.72125125
{'0': {'precision': 0.5508108224363386, 'recall': 0.45044102257437585, 'f1-score': 0.49559517186328345, 'support': 113713}, '1': {'precision': 0.7308186204308974, 'recall': 0.8845303920408575, 'f1-score': 0.8003611304424572, 'support': 312697}, '2': {'precision': 0.6009212791946902, 'recall': 0.36135472623166986, 'f1-score': 0.45131696749306427, 'support': 112997}, 'accuracy': 0.6834227216183698, 'macro avg': {'precision': 0.6275169073539754, 'recall': 0.5654420469489677, 'f1-score': 0.5824244232662683, 'support': 539407}, 'weighted avg': {'precision': 0.6656595909762871, 'recall': 0.6834227216183698, 'f1-score': 0.6629939944418006, 'support': 539407}}
[[ 51221  49406  13086]
 [ 22076 276590  14031]
 [ 19695  52470  40832]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7689311
{'0': {'precision': 0.5364358974358975, 'recall': 0.4493631462508323, 'f1-score': 0.4890540809051276, 'support': 46557}, '1': {'precision': 0.7116297351013022, 'recall': 0.8602485028866497, 'f1-score': 0.778913276405078, 'support': 111548}, '2': {'precision': 0.5819961118982504, 'recall': 0.3832450963374414, 'f1-score': 0.46215837879560945, 'support': 46088}, 'accuracy': 0.6589011376491848, 'macro avg': {'precision': 0.6100205814784834, 'recall': 0.5642855818249745, 'f1-score': 0.5767085787019383, 'support': 204193}, 'weighted avg': {'precision': 0.6424253357028387, 'recall': 0.6589011376491848, 'f1-score': 0.6413298416844148, 'support': 204193}}
[[20921 19121  6515]
 [ 9418 95959  6171]
 [ 8661 19764 17663]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
4274/4274 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96664673
{'0': {'precision': 0.4503663174751451, 'recall': 0.5665377409802381, 'f1-score': 0.5018163001601437, 'support': 297846}, '1': {'precision': 0.6257670030581588, 'recall': 0.6934939156228223, 'f1-score': 0.657892010705884, 'support': 503667}, '2': {'precision': 0.5456524840732723, 'recall': 0.30067886295582263, 'f1-score': 0.38771143017707793, 'support': 292548}, 'accuracy': 0.5538941612944799, 'macro avg': {'precision': 0.5405952682021921, 'recall': 0.520236839852961, 'f1-score': 0.5158065803477019, 'support': 1094061}, 'weighted avg': {'precision': 0.556593771494152, 'recall': 0.5538941612944799, 'f1-score': 0.543156804391293, 'support': 1094061}}
[[168741  96872  32233]
 [113366 349290  41011]
 [ 92568 112017  87963]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.831656
{'0': {'precision': 0.4964552257151004, 'recall': 0.4472644484603664, 'f1-score': 0.47057781837331014, 'support': 112884}, '1': {'precision': 0.6943681982628565, 'recall': 0.8508187541727388, 'f1-score': 0.7646731477404151, 'support': 278594}, '2': {'precision': 0.5751467169541398, 'recall': 0.3128144369092565, 'f1-score': 0.4052298811078276, 'support': 113099}, 'accuracy': 0.639943953053746, 'macro avg': {'precision': 0.5886567136440323, 'recall': 0.5369658798474538, 'f1-score': 0.546826949073851, 'support': 504577}, 'weighted avg': {'precision': 0.6233680569412833, 'recall': 0.639943953053746, 'f1-score': 0.618310290984845, 'support': 504577}}
[[ 50489  50068  12327]
 [ 27754 237033  13807]
 [ 23456  54264  35379]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8665609
{'0': {'precision': 0.5019601347247529, 'recall': 0.43223582550814216, 'f1-score': 0.4644960210507491, 'support': 42065}, '1': {'precision': 0.6689230325557549, 'recall': 0.8567222062625682, 'f1-score': 0.751264057579847, 'support': 97468}, '2': {'precision': 0.583248730964467, 'recall': 0.2787414182091652, 'f1-score': 0.3772098291229625, 'support': 41221}, 'accuracy': 0.6261272226340773, 'macro avg': {'precision': 0.584710632748325, 'recall': 0.5225664833266251, 'f1-score': 0.5309899692511862, 'support': 180754}, 'weighted avg': {'precision': 0.610529444125316, 'recall': 0.6261272226340773, 'f1-score': 0.5992243416796859, 'support': 180754}}
[[18182 20068  3815]
 [ 9570 83503  4395]
 [ 8470 21261 11490]]
testing model on single stock: results/universal/W4/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
12724/12724 - 96s - 96s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.159523
{'0': {'precision': 0.4079783738336158, 'recall': 0.649860881837504, 'f1-score': 0.5012655455330779, 'support': 943802}, '1': {'precision': 0.586612838437925, 'recall': 0.23180275254073401, 'f1-score': 0.33229687245581735, 'support': 1373422}, '2': {'precision': 0.4292065248355786, 'recall': 0.5530231860404993, 'f1-score': 0.4833108939908433, 'support': 939919}, 'accuracy': 0.4456359453668445, 'macro avg': {'precision': 0.4745992457023731, 'recall': 0.4782289401395791, 'f1-score': 0.4389577706599128, 'support': 3257143}, 'weighted avg': {'precision': 0.4894280510837069, 'recall': 0.4456359453668445, 'f1-score': 0.4248362297068944, 'support': 3257143}}
[[613340 108301 222161]
 [585952 318363 469107]
 [304072 116050 519797]]
Evaluating performance on  train set...
5165/5165 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1629233
{'0': {'precision': 0.43182391355303096, 'recall': 0.6599219655079384, 'f1-score': 0.5220447198396649, 'support': 441087}, '1': {'precision': 0.5416464194690441, 'recall': 0.1242894397895513, 'f1-score': 0.20218442693497252, 'support': 439442}, '2': {'precision': 0.45835518753186755, 'recall': 0.5679830967926028, 'f1-score': 0.5073142117399572, 'support': 441573}, 'accuracy': 0.4511807712264258, 'macro avg': {'precision': 0.4772751735179808, 'recall': 0.4507315006966975, 'f1-score': 0.41051445283819826, 'support': 1322102}, 'weighted avg': {'precision': 0.4771881259128954, 'recall': 0.4511807712264258, 'f1-score': 0.4108092467160057, 'support': 1322102}}
[[291083  21726 128278]
 [216721  54618 168103]
 [166274  24493 250806]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1467689
{'0': {'precision': 0.4340791640868126, 'recall': 0.6525566539923955, 'f1-score': 0.5213545185451611, 'support': 164375}, '1': {'precision': 0.5754423421991051, 'recall': 0.1592524844896189, 'f1-score': 0.24946581722579436, 'support': 159087}, '2': {'precision': 0.4608071886248181, 'recall': 0.551899570127861, 'f1-score': 0.5022565261183856, 'support': 163537}, 'accuracy': 0.45760874252308525, 'macro avg': {'precision': 0.4901095649702452, 'recall': 0.45456956953662514, 'f1-score': 0.4243589539631137, 'support': 486999}, 'weighted avg': {'precision': 0.48923341464014447, 'recall': 0.4576087425230853, 'f1-score': 0.4261239611635408, 'support': 486999}}
[[107264   8306  48805]
 [ 76948  25335  56804]
 [ 62895  10386  90256]]
training model: results/universal/W4/deepOF_L2/h30
Epoch 1/50
9854/9854 - 221s - loss: 2.8306 - accuracy30: 0.5279 - val_loss: 3.0775 - val_accuracy30: 0.5198 - 221s/epoch - 22ms/step
Epoch 2/50
9854/9854 - 219s - loss: 2.7543 - accuracy30: 0.5457 - val_loss: 3.0591 - val_accuracy30: 0.5219 - 219s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 222s - loss: 2.7333 - accuracy30: 0.5496 - val_loss: 3.0576 - val_accuracy30: 0.5255 - 222s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 220s - loss: 2.7212 - accuracy30: 0.5521 - val_loss: 3.0812 - val_accuracy30: 0.5272 - 220s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 220s - loss: 2.7128 - accuracy30: 0.5535 - val_loss: 3.0927 - val_accuracy30: 0.5266 - 220s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 220s - loss: 2.7062 - accuracy30: 0.5551 - val_loss: 3.0964 - val_accuracy30: 0.5293 - 220s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 221s - loss: 2.7014 - accuracy30: 0.5558 - val_loss: 3.0854 - val_accuracy30: 0.5309 - 221s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 218s - loss: 2.6970 - accuracy30: 0.5564 - val_loss: 3.0973 - val_accuracy30: 0.5297 - 218s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 219s - loss: 2.6935 - accuracy30: 0.5571 - val_loss: 3.1020 - val_accuracy30: 0.5297 - 219s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 223s - loss: 2.6899 - accuracy30: 0.5581 - val_loss: 3.1070 - val_accuracy30: 0.5287 - 223s/epoch - 23ms/step
Epoch 11/50
9854/9854 - 217s - loss: 2.6870 - accuracy30: 0.5584 - val_loss: 3.0990 - val_accuracy30: 0.5285 - 217s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 218s - loss: 2.6843 - accuracy30: 0.5589 - val_loss: 3.1007 - val_accuracy30: 0.5286 - 218s/epoch - 22ms/step
Epoch 13/50
9854/9854 - 219s - loss: 2.6815 - accuracy30: 0.5594 - val_loss: 3.1108 - val_accuracy30: 0.5268 - 219s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 187s - 187s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0339773
{'0': {'precision': 0.4305728657039476, 'recall': 0.4560077076116498, 'f1-score': 0.44292544041463644, 'support': 1565206}, '1': {'precision': 0.6510254986805782, 'recall': 0.5830331886214138, 'f1-score': 0.6151562746167799, 'support': 2936639}, '2': {'precision': 0.41753750690160624, 'recall': 0.4745223173390174, 'f1-score': 0.44420981635299484, 'support': 1569766}, 'accuracy': 0.5222325672708611, 'macro avg': {'precision': 0.49971195709537736, 'recall': 0.5045210711906937, 'f1-score': 0.5007638437948038, 'support': 6071611}, 'weighted avg': {'precision': 0.53382838332623, 'recall': 0.5222325672708611, 'f1-score': 0.5265599081695373, 'support': 6071611}}
[[ 713746  458275  393185]
 [ 578550 1712158  645931]
 [ 365370  459507  744889]]
Evaluating performance on  train set...
9854/9854 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.024735
{'0': {'precision': 0.4489414760273523, 'recall': 0.4720896113593108, 'f1-score': 0.4602246543972563, 'support': 724551}, '1': {'precision': 0.6379355998298925, 'recall': 0.5924512835798651, 'f1-score': 0.6143527211751706, 'support': 1073560}, '2': {'precision': 0.45240129578764177, 'recall': 0.4768898595530064, 'f1-score': 0.46432291789257635, 'support': 723903}, 'accuracy': 0.5247024798434902, 'macro avg': {'precision': 0.5130927905482955, 'recall': 0.5138102514973941, 'f1-score': 0.5129667644883343, 'support': 2522014}, 'weighted avg': {'precision': 0.5303847612166446, 'recall': 0.5247024798434902, 'f1-score': 0.527009562256273, 'support': 2522014}}
[[342053 180184 202314]
 [221976 636032 215552]
 [197881 180800 345222]]
Evaluating performance on  val set...
3566/3566 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0189029
{'0': {'precision': 0.4456965962061956, 'recall': 0.4745564392780667, 'f1-score': 0.4596739843029479, 'support': 261520}, '1': {'precision': 0.6430030039934148, 'recall': 0.5978223929147278, 'f1-score': 0.6195901461342486, 'support': 391347}, '2': {'precision': 0.4495234145293765, 'recall': 0.4678243577589197, 'f1-score': 0.4584913356800774, 'support': 259482}, 'accuracy': 0.5255160031961453, 'macro avg': {'precision': 0.5127410049096623, 'recall': 0.513401063317238, 'f1-score': 0.5125851553724247, 'support': 912349}, 'weighted avg': {'precision': 0.5314184649652347, 'recall': 0.5255160031961453, 'f1-score': 0.5279327692133653, 'support': 912349}}
[[124106  64147  73267]
 [ 82004 233956  75387]
 [ 72344  65746 121392]]
testing model out of sample: results/universal/W4/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 98s - 98s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0074766
{'0': {'precision': 0.46831354902896566, 'recall': 0.4273874363828471, 'f1-score': 0.4469155006027366, 'support': 867887}, '1': {'precision': 0.5886369320176967, 'recall': 0.6996883617284786, 'f1-score': 0.6393764255279534, 'support': 1315307}, '2': {'precision': 0.4656226844285632, 'recall': 0.3710638969953844, 'f1-score': 0.4129999731069419, 'support': 848428}, 'accuracy': 0.5297659140882339, 'macro avg': {'precision': 0.5075243884917419, 'recall': 0.49937989836890334, 'f1-score': 0.49976396641254395, 'support': 3031622}, 'weighted avg': {'precision': 0.5197642849840315, 'recall': 0.5297659140882339, 'f1-score': 0.5209254921578876, 'support': 3031622}}
[[370924 315260 181703]
 [215397 920305 179605]
 [205721 327886 314821]]
Evaluating performance on  train set...
5528/5528 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91251296
{'0': {'precision': 0.4810146824747482, 'recall': 0.36948237445009424, 'f1-score': 0.41793547803383785, 'support': 350060}, '1': {'precision': 0.6536951578384163, 'recall': 0.8211463280759925, 'f1-score': 0.7279146724127659, 'support': 714176}, '2': {'precision': 0.4900982128481726, 'recall': 0.3476711515179204, 'f1-score': 0.40677784904853537, 'support': 350216}, 'accuracy': 0.5921332077723387, 'macro avg': {'precision': 0.5416026843871123, 'recall': 0.5127666180146692, 'f1-score': 0.5175426664983797, 'support': 1414452}, 'weighted avg': {'precision': 0.5704524639240884, 'recall': 0.5921332077723387, 'f1-score': 0.5716855670662324, 'support': 1414452}}
[[129341 154389  66330]
 [ 67383 586443  60350]
 [ 72168 156288 121760]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9466349
{'0': {'precision': 0.48302243794089217, 'recall': 0.37414472898164003, 'f1-score': 0.42166873886288037, 'support': 125545}, '1': {'precision': 0.6298343810286224, 'recall': 0.808649645951718, 'f1-score': 0.7081279175496548, 'support': 237397}, '2': {'precision': 0.4850945975950358, 'recall': 0.3329590207984086, 'f1-score': 0.3948802830969436, 'support': 124673}, 'accuracy': 0.5751545789198446, 'macro avg': {'precision': 0.5326504721881835, 'recall': 0.5052511319105889, 'f1-score': 0.5082256465031596, 'support': 487615}, 'weighted avg': {'precision': 0.5550281334460734, 'recall': 0.5751545789198446, 'f1-score': 0.5542831016224296, 'support': 487615}}
[[ 46972  55842  22731]
 [ 24095 191971  21331]
 [ 26179  56983  41511]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1512305
{'0': {'precision': 0.44106645022408864, 'recall': 0.48014828758571676, 'f1-score': 0.4597783602335954, 'support': 52061}, '1': {'precision': 0.38020679468242247, 'recall': 0.07757217768669761, 'f1-score': 0.1288546255506608, 'support': 33182}, '2': {'precision': 0.41892741032155834, 'recall': 0.5965724512225962, 'f1-score': 0.49221188800526433, 'support': 51407}, 'accuracy': 0.42619099890230516, 'macro avg': {'precision': 0.4134002184093564, 'recall': 0.3847643054983368, 'f1-score': 0.36028162459650687, 'support': 136650}, 'weighted avg': {'precision': 0.4179596319697678, 'recall': 0.42619099890230516, 'f1-score': 0.39162321202949035, 'support': 136650}}
[[24997  2250 24814]
 [12884  2574 17724]
 [18793  1946 30668]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2720248
{'0': {'precision': 0.37779354380986163, 'recall': 0.4482532853201141, 'f1-score': 0.41001839414809427, 'support': 21383}, '1': {'precision': 0.5157864523536165, 'recall': 0.08294484191091622, 'f1-score': 0.1429082667302875, 'support': 21665}, '2': {'precision': 0.3812189916571967, 'recall': 0.628438271040848, 'f1-score': 0.4745622358319676, 'support': 21886}, 'accuracy': 0.3871007484522746, 'macro avg': {'precision': 0.424932995940225, 'recall': 0.3865454660906262, 'f1-score': 0.34249629890344985, 'support': 64934}, 'weighted avg': {'precision': 0.4249889378282068, 'recall': 0.3871007484522746, 'f1-score': 0.3426525397203133, 'support': 64934}}
[[ 9585   910 10888]
 [ 8431  1797 11437]
 [ 7355   777 13754]]
Evaluating performance on  val set...
81/81 - 1s - 803ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2565138
{'0': {'precision': 0.3937431259929121, 'recall': 0.4489966555183946, 'f1-score': 0.4195585650107429, 'support': 7176}, '1': {'precision': 0.4155154091392136, 'recall': 0.06214240305149396, 'f1-score': 0.10811558136319645, 'support': 6292}, '2': {'precision': 0.38270100939784196, 'recall': 0.6152770005595971, 'f1-score': 0.4718884120171673, 'support': 7148}, 'accuracy': 0.388581684128832, 'macro avg': {'precision': 0.39731984817665594, 'recall': 0.3754720197098285, 'f1-score': 0.33318751946370223, 'support': 20616}, 'weighted avg': {'precision': 0.39655948979456945, 'recall': 0.388581684128832, 'f1-score': 0.3426500712821612, 'support': 20616}}
[[3222  285 3669]
 [2476  391 3425]
 [2485  265 4398]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
1613/1613 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.576424
{'0': {'precision': 0.6018065852947843, 'recall': 0.3337582820103065, 'f1-score': 0.42938322938322937, 'support': 55693}, '1': {'precision': 0.8096627538035496, 'recall': 0.961373976190714, 'f1-score': 0.8790203927618856, 'support': 300471}, '2': {'precision': 0.6096243945048837, 'recall': 0.27088442335174046, 'f1-score': 0.375096192605079, 'support': 56681}, 'accuracy': 0.7819084644358052, 'macro avg': {'precision': 0.6736979112010725, 'recall': 0.522005560517587, 'f1-score': 0.5611666049167313, 'support': 412845}, 'weighted avg': {'precision': 0.7541588532206036, 'recall': 0.7819084644358052, 'f1-score': 0.7491785147468062, 'support': 412845}}
[[ 18588  31881   5224]
 [  6998 288865   4608]
 [  5301  36026  15354]]
Evaluating performance on  train set...
634/634 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6501673
{'0': {'precision': 0.5862977602108037, 'recall': 0.3466407010710808, 'f1-score': 0.4356871863908946, 'support': 25675}, '1': {'precision': 0.7751286131981199, 'recall': 0.9468078373222181, 'f1-score': 0.8524099082598681, 'support': 110599}, '2': {'precision': 0.6033078666778608, 'recall': 0.2773232479160235, 'f1-score': 0.3799804351849404, 'support': 25912}, 'accuracy': 0.7448361757488315, 'macro avg': {'precision': 0.6549114133622614, 'recall': 0.5235905954364408, 'f1-score': 0.5560258432785677, 'support': 162186}, 'weighted avg': {'precision': 0.717784259590026, 'recall': 0.7448361757488315, 'f1-score': 0.7109615194328212, 'support': 162186}}
[[  8900  14487   2288]
 [  3446 104716   2437]
 [  2834  15892   7186]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5728008
{'0': {'precision': 0.6301369863013698, 'recall': 0.3200241984271022, 'f1-score': 0.4244734202607823, 'support': 6612}, '1': {'precision': 0.8171504694785243, 'recall': 0.9699558774771099, 'f1-score': 0.8870204081632653, 'support': 39209}, '2': {'precision': 0.6257950530035336, 'recall': 0.25636942675159236, 'f1-score': 0.36372971862805503, 'support': 6908}, 'accuracy': 0.794970509586755, 'macro avg': {'precision': 0.6910275029278092, 'recall': 0.5154498342186015, 'f1-score': 0.5584078490173675, 'support': 52729}, 'weighted avg': {'precision': 0.7686303691963915, 'recall': 0.794970509586755, 'f1-score': 0.7604628635991648, 'support': 52729}}
[[ 2116  4018   478]
 [  597 38031   581]
 [  645  4492  1771]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2106092
{'0': {'precision': 0.3936536973193555, 'recall': 0.43292667199711127, 'f1-score': 0.4123572042746591, 'support': 77542}, '1': {'precision': 0.5054988755416598, 'recall': 0.3675384109195689, 'f1-score': 0.4256181409875246, 'support': 100297}, '2': {'precision': 0.37854436858267465, 'recall': 0.47749114820435, 'f1-score': 0.4222992659913238, 'support': 75126}, 'accuracy': 0.42023600102781017, 'macro avg': {'precision': 0.42589898048123004, 'recall': 0.4259854103736767, 'f1-score': 0.4200915370845025, 'support': 252965}, 'weighted avg': {'precision': 0.4335115132602587, 'recall': 0.42023600102781017, 'f1-score': 0.42056758712610665, 'support': 252965}}
[[33570 18888 25084]
 [29627 36863 33807]
 [22081 17173 35872]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1908637
{'0': {'precision': 0.4098365827497003, 'recall': 0.447271475296953, 'f1-score': 0.42773652931201955, 'support': 29045}, '1': {'precision': 0.45761907023125503, 'recall': 0.3426245244782593, 'f1-score': 0.39185947220753875, 'support': 28127}, '2': {'precision': 0.41503122872450643, 'recall': 0.4774244075183874, 'f1-score': 0.4440468084432551, 'support': 29368}, 'accuracy': 0.4234920268084123, 'macro avg': {'precision': 0.42749562723515394, 'recall': 0.42244013576453326, 'f1-score': 0.4212142699876045, 'support': 86540}, 'weighted avg': {'precision': 0.42712956158471066, 'recall': 0.4234920268084123, 'f1-score': 0.42161087981292544, 'support': 86540}}
[[12991  5651 10403]
 [ 9131  9637  9359]
 [ 9576  5771 14021]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2022432
{'0': {'precision': 0.41233964569334147, 'recall': 0.5005561735261401, 'f1-score': 0.4521855635571931, 'support': 10788}, '1': {'precision': 0.39828468251579896, 'recall': 0.2789839797639123, 'f1-score': 0.32812693690343375, 'support': 9488}, '2': {'precision': 0.4167090754877014, 'recall': 0.43647832267235254, 'f1-score': 0.426364661980387, 'support': 11256}, 'accuracy': 0.41101103640745906, 'macro avg': {'precision': 0.409111134565614, 'recall': 0.4053394919874684, 'f1-score': 0.4022257208136713, 'support': 31532}, 'weighted avg': {'precision': 0.4096702562203233, 'recall': 0.41101103640745906, 'f1-score': 0.4056389341699231, 'support': 31532}}
[[5400 1821 3567]
 [3531 2647 3310]
 [4165 2178 4913]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5408381
{'0': {'precision': 0.3004724409448819, 'recall': 0.33350113264535614, 'f1-score': 0.31612642406007063, 'support': 71514}, '1': {'precision': 0.7257217847769029, 'recall': 0.038576525222729356, 'f1-score': 0.07325889477668433, 'support': 100346}, '2': {'precision': 0.28408814259677195, 'recall': 0.6659879685330865, 'f1-score': 0.3982823749717496, 'support': 64830}, 'accuracy': 0.2995352570873294, 'macro avg': {'precision': 0.43676078943951885, 'recall': 0.34602187546705737, 'f1-score': 0.2625558979361682, 'support': 236690}, 'weighted avg': {'precision': 0.4762714886201534, 'recall': 0.2995352570873294, 'f1-score': 0.23566415359715912, 'support': 236690}}
[[23850  1043 46621]
 [34291  3871 62184]
 [21234   420 43176]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3684891
{'0': {'precision': 0.34814814814814815, 'recall': 0.36961012995668113, 'f1-score': 0.3585582673347341, 'support': 30010}, '1': {'precision': 0.5737704918032787, 'recall': 0.03460030680074996, 'f1-score': 0.06526491769547324, 'support': 29335}, '2': {'precision': 0.34683290862759375, 'recall': 0.6520325759649603, 'f1-score': 0.45280642555011646, 'support': 29224}, 'accuracy': 0.3518386794476623, 'macro avg': {'precision': 0.42291718285967345, 'recall': 0.35208100424079714, 'f1-score': 0.29220987019344125, 'support': 88569}, 'weighted avg': {'precision': 0.4224427082241857, 'recall': 0.3518386794476623, 'f1-score': 0.29251425378618573, 'support': 88569}}
[[11092   425 18493]
 [10928  1015 17392]
 [ 9840   329 19055]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.392345
{'0': {'precision': 0.35048974311587505, 'recall': 0.3459503830718716, 'f1-score': 0.3482052694390893, 'support': 10964}, '1': {'precision': 0.5103734439834025, 'recall': 0.02278199666604927, 'f1-score': 0.043617021276595745, 'support': 10798}, '2': {'precision': 0.3267671468091195, 'recall': 0.6519794442329654, 'f1-score': 0.43534345809239366, 'support': 10508}, 'accuracy': 0.33746513789897736, 'macro avg': {'precision': 0.3958767779694657, 'recall': 0.340237274656962, 'f1-score': 0.27572191626935955, 'support': 32270}, 'weighted avg': {'precision': 0.39626436846375773, 'recall': 0.33746513789897736, 'f1-score': 0.2746603107378286, 'support': 32270}}
[[3793  160 7011]
 [3448  246 7104]
 [3581   76 6851]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2790927
{'0': {'precision': 0.38215209484483986, 'recall': 0.4426209307877733, 'f1-score': 0.41016985441050535, 'support': 129847}, '1': {'precision': 0.4637073439990029, 'recall': 0.3447534071578446, 'f1-score': 0.39547915353717894, 'support': 151079}, '2': {'precision': 0.3764962744758274, 'recall': 0.4308808947765042, 'f1-score': 0.40185692091440406, 'support': 126065}, 'accuracy': 0.40265509556722384, 'macro avg': {'precision': 0.40745190443989004, 'recall': 0.4060850775740407, 'f1-score': 0.4025019762873628, 'support': 406991}, 'weighted avg': {'precision': 0.4106743090759709, 'recall': 0.40265509556722384, 'f1-score': 0.4021416022908582, 'support': 406991}}
[[57473 29672 42702]
 [51740 52085 47254]
 [41180 30566 54319]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2514907
{'0': {'precision': 0.38728841621379456, 'recall': 0.430097990438902, 'f1-score': 0.40757215480485404, 'support': 46229}, '1': {'precision': 0.4194188058840496, 'recall': 0.2586030588653744, 'f1-score': 0.3199394939493949, 'support': 44984}, '2': {'precision': 0.3985868377935554, 'recall': 0.5027338872863478, 'f1-score': 0.4446432991260972, 'support': 46454}, 'accuracy': 0.3985704635097736, 'macro avg': {'precision': 0.40176468663046655, 'recall': 0.39714497886354144, 'f1-score': 0.39071831596011536, 'support': 137667}, 'weighted avg': {'precision': 0.401599836706672, 'recall': 0.3985704635097736, 'f1-score': 0.3914465424386156, 'support': 137667}}
[[19883  8321 18025]
 [16138 11633 17213]
 [15318  7782 23354]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2796928
{'0': {'precision': 0.3793756397134084, 'recall': 0.4240604084434529, 'f1-score': 0.40047540585073343, 'support': 17481}, '1': {'precision': 0.42531621125808633, 'recall': 0.23949328548904475, 'f1-score': 0.30643478260869567, 'support': 18393}, '2': {'precision': 0.3887852843943375, 'recall': 0.5206902423795198, 'f1-score': 0.44517240542573583, 'support': 17617}, 'accuracy': 0.3924211549606476, 'macro avg': {'precision': 0.39782571178861076, 'recall': 0.39474797877067247, 'f1-score': 0.38402753129505496, 'support': 53491}, 'weighted avg': {'precision': 0.3982714285893911, 'recall': 0.3924211549606476, 'f1-score': 0.38286006604070966, 'support': 53491}}
[[7413 3087 6981]
 [6548 4405 7440]
 [5579 2865 9173]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/EXC
Evaluating performance on  test set...
3782/3782 - 32s - 32s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7079636
{'0': {'precision': 0.5741679361122651, 'recall': 0.3426331476676088, 'f1-score': 0.4291639063707629, 'support': 181509}, '1': {'precision': 0.7253263680387725, 'recall': 0.9383683654020999, 'f1-score': 0.8182069759299074, 'support': 593932}, '2': {'precision': 0.6370052163240257, 'recall': 0.3019526562670448, 'f1-score': 0.40969978044749245, 'support': 192507}, 'accuracy': 0.7000851285399629, 'macro avg': {'precision': 0.6454998401583545, 'recall': 0.5276513897789178, 'f1-score': 0.552356887582721, 'support': 967948}, 'weighted avg': {'precision': 0.6794157862991551, 'recall': 0.7000851285399629, 'f1-score': 0.664009319451105, 'support': 967948}}
[[ 62191 100817  18501]
 [ 21982 557327  14623]
 [ 24142 110237  58128]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76912254
{'0': {'precision': 0.60567407986504, 'recall': 0.3216466912126211, 'f1-score': 0.4201632699663184, 'support': 91529}, '1': {'precision': 0.6668747580937161, 'recall': 0.9408117522204951, 'f1-score': 0.7805049126787115, 'support': 227089}, '2': {'precision': 0.6349365970910696, 'recall': 0.28406048369398235, 'f1-score': 0.39251571230373833, 'support': 91132}, 'accuracy': 0.6564368517388651, 'macro avg': {'precision': 0.6358284783499419, 'recall': 0.5155063090423662, 'f1-score': 0.531061298316256, 'support': 409750}, 'weighted avg': {'precision': 0.6461005656200476, 'recall': 0.6564368517388651, 'f1-score': 0.6137204293976996, 'support': 409750}}
[[ 29440  53145   8944]
 [  7501 213648   5940]
 [ 11666  53579  25887]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7059137
{'0': {'precision': 0.6146038906117846, 'recall': 0.3215457797116413, 'f1-score': 0.42220446897620256, 'support': 27119}, '1': {'precision': 0.7073398487788073, 'recall': 0.9497845299832006, 'f1-score': 0.8108268207515796, 'support': 82146}, '2': {'precision': 0.6493829276654096, 'recall': 0.28174617930316437, 'f1-score': 0.3929877337205985, 'support': 26893}, 'accuracy': 0.6927099399227368, 'macro avg': {'precision': 0.6571088890186672, 'recall': 0.5176921629993354, 'f1-score': 0.5420063411494602, 'support': 136158}, 'weighted avg': {'precision': 0.677422091988651, 'recall': 0.6927099399227368, 'f1-score': 0.65089500532156, 'support': 136158}}
[[ 8720 16194  2205]
 [ 2239 78021  1886]
 [ 3229 16087  7577]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/AAL
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8199983
{'0': {'precision': 0.5578012035605332, 'recall': 0.3989128810520024, 'f1-score': 0.46516318458241124, 'support': 267680}, '1': {'precision': 0.6644319548886183, 'recall': 0.8750752145249058, 'f1-score': 0.7553429396276932, 'support': 611584}, '2': {'precision': 0.5584866365845192, 'recall': 0.3074236408588755, 'f1-score': 0.3965583956267668, 'support': 261691}, 'accuracy': 0.6331651993286326, 'macro avg': {'precision': 0.5935732650112236, 'recall': 0.5271372454785946, 'f1-score': 0.5390215066122904, 'support': 1140955}, 'weighted avg': {'precision': 0.615115499982141, 'recall': 0.6331651993286326, 'f1-score': 0.6049724141164614, 'support': 1140955}}
[[106781 129465  31434]
 [ 44236 535182  32166]
 [ 40415 140826  80450]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.739653
{'0': {'precision': 0.5598363176827719, 'recall': 0.34092870987181784, 'f1-score': 0.4237826018737378, 'support': 122794}, '1': {'precision': 0.7118451094649669, 'recall': 0.928583004986968, 'f1-score': 0.8058960523888581, 'support': 376381}, '2': {'precision': 0.6009349534342259, 'recall': 0.271777490765801, 'f1-score': 0.3742827201404821, 'support': 121559}, 'accuracy': 0.683709930501632, 'macro avg': {'precision': 0.6242054601939883, 'recall': 0.513763068541529, 'f1-score': 0.5346537914676927, 'support': 620734}, 'weighted avg': {'precision': 0.6600549783700957, 'recall': 0.683709930501632, 'f1-score': 0.6457828249881775, 'support': 620734}}
[[ 41864  69830  11100]
 [ 16041 349501  10839]
 [ 16874  71648  33037]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7530623
{'0': {'precision': 0.5754814992407896, 'recall': 0.3490970791419222, 'f1-score': 0.4345740106516196, 'support': 41255}, '1': {'precision': 0.7005012451919116, 'recall': 0.9264887063655031, 'f1-score': 0.7978002468226989, 'support': 119315}, '2': {'precision': 0.5932894665289031, 'recall': 0.2683754796811965, 'f1-score': 0.36957368608255287, 'support': 40652}, 'accuracy': 0.6751548041466638, 'macro avg': {'precision': 0.6230907369872014, 'recall': 0.5146537550628739, 'f1-score': 0.5339826478522904, 'support': 201222}, 'weighted avg': {'precision': 0.6532098811987986, 'recall': 0.6751548041466638, 'f1-score': 0.6368180255921858, 'support': 201222}}
[[ 14402  23041   3812]
 [  5104 110544   3667]
 [  5520  24222  10910]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/WBA
Evaluating performance on  test set...
4676/4676 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8515674
{'0': {'precision': 0.5733484587786384, 'recall': 0.36014756121676633, 'f1-score': 0.4424015630137015, 'support': 293302}, '1': {'precision': 0.6345595894562768, 'recall': 0.885671385319006, 'f1-score': 0.7393761605788562, 'support': 608719}, '2': {'precision': 0.5765861851259325, 'recall': 0.3189067140396794, 'f1-score': 0.4106726157862683, 'support': 294964}, 'accuracy': 0.6172366403923191, 'macro avg': {'precision': 0.5948314111202825, 'recall': 0.5215752201918172, 'f1-score': 0.5308167797929421, 'support': 1196985}, 'weighted avg': {'precision': 0.6052748329347596, 'recall': 0.6172366403923191, 'f1-score': 0.5856073532828117, 'support': 1196985}}
[[105632 152452  35218]
 [ 35735 539125  33859]
 [ 42870 158028  94066]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8441146
{'0': {'precision': 0.5818732202868064, 'recall': 0.34253267591383074, 'f1-score': 0.4312187795569371, 'support': 132437}, '1': {'precision': 0.6392061729709451, 'recall': 0.9154782823368816, 'f1-score': 0.752795034764411, 'support': 275444}, '2': {'precision': 0.6069214798882765, 'recall': 0.3089427185499445, 'f1-score': 0.40945802284395677, 'support': 131526}, 'accuracy': 0.6269125168935517, 'macro avg': {'precision': 0.6093336243820093, 'recall': 0.5223178922668855, 'f1-score': 0.5311572790551017, 'support': 539407}, 'weighted avg': {'precision': 0.6172574759814357, 'recall': 0.6269125168935517, 'f1-score': 0.5901231778163887, 'support': 539407}}
[[ 45364  71077  15996]
 [ 12960 252163  10321]
 [ 19638  71254  40634]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8817889
{'0': {'precision': 0.567535400390625, 'recall': 0.3465257979764101, 'f1-score': 0.43031179499045524, 'support': 53667}, '1': {'precision': 0.6148805614986478, 'recall': 0.8968905459826348, 'f1-score': 0.7295820905526325, 'support': 97091}, '2': {'precision': 0.5927392296336063, 'recall': 0.3306072798727426, 'f1-score': 0.4244644938069895, 'support': 53435}, 'accuracy': 0.6040510693314658, 'macro avg': {'precision': 0.5917183971742931, 'recall': 0.5246745412772625, 'f1-score': 0.5281194597833591, 'support': 204193}, 'weighted avg': {'precision': 0.5966429391051634, 'recall': 0.6040510693314658, 'f1-score': 0.5710805859269166, 'support': 204193}}
[[18597 27232  7838]
 [ 5711 87080  4300]
 [ 8460 27309 17666]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
4274/4274 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0366659
{'0': {'precision': 0.48097669933802356, 'recall': 0.4347643628744237, 'f1-score': 0.4567044918569486, 'support': 340757}, '1': {'precision': 0.5186265788377495, 'recall': 0.7009912564264669, 'f1-score': 0.596174779679037, 'support': 419165}, '2': {'precision': 0.51796909170433, 'recall': 0.3402416359658705, 'f1-score': 0.4107025127025958, 'support': 334139}, 'accuracy': 0.5078948979992889, 'macro avg': {'precision': 0.505857456626701, 'recall': 0.4919990850889204, 'f1-score': 0.4878605947461938, 'support': 1094061}, 'weighted avg': {'precision': 0.5066993169373969, 'recall': 0.5078948979992889, 'f1-score': 0.4960898715407957, 'support': 1094061}}
[[148149 135052  57556]
 [ 77090 293831  48244]
 [ 82778 137673 113688]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9380492
{'0': {'precision': 0.5261413500140043, 'recall': 0.34518295063892995, 'f1-score': 0.4168712464805337, 'support': 130609}, '1': {'precision': 0.6043944550604358, 'recall': 0.8798200963710656, 'f1-score': 0.7165519125042099, 'support': 243019}, '2': {'precision': 0.5775662188099808, 'recall': 0.28724159787398146, 'f1-score': 0.383671470975244, 'support': 130949}, 'accuracy': 0.5876427185543535, 'macro avg': {'precision': 0.5693673412948069, 'recall': 0.504081548294659, 'f1-score': 0.5056982099866626, 'support': 504577}, 'weighted avg': {'precision': 0.5771762296839914, 'recall': 0.5876427185543535, 'f1-score': 0.5525901127264498, 'support': 504577}}
[[ 45084  69515  16010]
 [ 17705 213813  11501]
 [ 22899  70436  37614]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98382956
{'0': {'precision': 0.5265490958956532, 'recall': 0.3380284573651346, 'f1-score': 0.4117353681953069, 'support': 48845}, '1': {'precision': 0.5735785046511808, 'recall': 0.8825394177025111, 'f1-score': 0.6952811056446463, 'support': 83909}, '2': {'precision': 0.5964021685559389, 'recall': 0.2521041666666667, 'f1-score': 0.3544003514423781, 'support': 48000}, 'accuracy': 0.5679818980492825, 'macro avg': {'precision': 0.5655099230342576, 'recall': 0.4908906805781041, 'f1-score': 0.48713894176077716, 'support': 180754}, 'weighted avg': {'precision': 0.5669307092871204, 'recall': 0.5679818980492825, 'f1-score': 0.5281364352781711, 'support': 180754}}
[[16511 27619  4715]
 [ 6382 74053  3474]
 [ 8464 27435 12101]]
testing model on single stock: results/universal/W4/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
12724/12724 - 98s - 98s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2190497
{'0': {'precision': 0.4012998586001253, 'recall': 0.5227120769777032, 'f1-score': 0.45402937884899625, 'support': 963188}, '1': {'precision': 0.4968531387805047, 'recall': 0.24213172953807127, 'f1-score': 0.3255923496595332, 'support': 1333171}, '2': {'precision': 0.39511401855342426, 'recall': 0.556347732684974, 'f1-score': 0.4620696272617017, 'support': 960784}, 'accuracy': 0.4177903764127028, 'macro avg': {'precision': 0.4310890053113514, 'recall': 0.4403971797335828, 'f1-score': 0.41389711859007705, 'support': 3257143}, 'weighted avg': {'precision': 0.43858578861545683, 'recall': 0.4177903764127028, 'f1-score': 0.403830913319361, 'support': 3257143}}
[[503470 171968 287750]
 [479798 322803 530570]
 [271330 154924 534530]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2012994
{'0': {'precision': 0.42009832533808905, 'recall': 0.554881995954147, 'f1-score': 0.4781737480642415, 'support': 444900}, '1': {'precision': 0.4426739587830938, 'recall': 0.14983077897344657, 'f1-score': 0.22388406319540247, 'support': 431093}, '2': {'precision': 0.42872143403279245, 'recall': 0.5656106467253519, 'f1-score': 0.4877433047989724, 'support': 446109}, 'accuracy': 0.42642852064364173, 'macro avg': {'precision': 0.43049790605132515, 'recall': 0.42344114055098175, 'f1-score': 0.3966003720195388, 'support': 1322102}, 'weighted avg': {'precision': 0.4303691243728026, 'recall': 0.42642852064364173, 'f1-score': 0.39848743208121723, 'support': 1322102}}
[[246867  41434 156599]
 [186875  64591 179627]
 [153899  39886 252324]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1878079
{'0': {'precision': 0.41697425465524063, 'recall': 0.5552960933573591, 'f1-score': 0.4762958679423825, 'support': 163158}, '1': {'precision': 0.47103564843269824, 'recall': 0.1891081596269039, 'f1-score': 0.269870544891123, 'support': 162103}, '2': {'precision': 0.42672146288305635, 'recall': 0.5399040423400808, 'f1-score': 0.4766864551347663, 'support': 161738}, 'accuracy': 0.42829451395177404, 'macro avg': {'precision': 0.4382437886569985, 'recall': 0.4281027651081146, 'f1-score': 0.4076176226560906, 'support': 486999}, 'weighted avg': {'precision': 0.43820634769826056, 'recall': 0.428294513951774, 'f1-score': 0.4077146360481557, 'support': 486999}}
[[90601 16660 55897]
 [70031 30655 61417]
 [56650 17765 87323]]
training model: results/universal/W4/deepVOL_L2/h10
Epoch 1/50
9854/9854 - 325s - loss: 2.6472 - accuracy10: 0.5636 - val_loss: 2.8975 - val_accuracy10: 0.5805 - 325s/epoch - 33ms/step
Epoch 2/50
9854/9854 - 327s - loss: 2.5491 - accuracy10: 0.5919 - val_loss: 2.8278 - val_accuracy10: 0.5904 - 327s/epoch - 33ms/step
Epoch 3/50
9854/9854 - 327s - loss: 2.5184 - accuracy10: 0.5974 - val_loss: 2.8209 - val_accuracy10: 0.5939 - 327s/epoch - 33ms/step
Epoch 4/50
9854/9854 - 327s - loss: 2.4983 - accuracy10: 0.6008 - val_loss: 2.7910 - val_accuracy10: 0.5974 - 327s/epoch - 33ms/step
Epoch 5/50
9854/9854 - 328s - loss: 2.4839 - accuracy10: 0.6035 - val_loss: 2.8202 - val_accuracy10: 0.5972 - 328s/epoch - 33ms/step
Epoch 6/50
9854/9854 - 333s - loss: 2.4740 - accuracy10: 0.6050 - val_loss: 2.8164 - val_accuracy10: 0.5980 - 333s/epoch - 34ms/step
Epoch 7/50
9854/9854 - 331s - loss: 2.4658 - accuracy10: 0.6063 - val_loss: 2.8062 - val_accuracy10: 0.5998 - 331s/epoch - 34ms/step
Epoch 8/50
9854/9854 - 334s - loss: 2.4589 - accuracy10: 0.6073 - val_loss: 2.8100 - val_accuracy10: 0.6017 - 334s/epoch - 34ms/step
Epoch 9/50
9854/9854 - 326s - loss: 2.4528 - accuracy10: 0.6085 - val_loss: 2.7922 - val_accuracy10: 0.6036 - 326s/epoch - 33ms/step
Epoch 10/50
9854/9854 - 330s - loss: 2.4479 - accuracy10: 0.6092 - val_loss: 2.7848 - val_accuracy10: 0.6055 - 330s/epoch - 34ms/step
Epoch 11/50
9854/9854 - 329s - loss: 2.4434 - accuracy10: 0.6099 - val_loss: 2.7745 - val_accuracy10: 0.6045 - 329s/epoch - 33ms/step
Epoch 12/50
9854/9854 - 326s - loss: 2.4393 - accuracy10: 0.6106 - val_loss: 2.7583 - val_accuracy10: 0.6067 - 326s/epoch - 33ms/step
Epoch 13/50
9854/9854 - 325s - loss: 2.4355 - accuracy10: 0.6114 - val_loss: 2.7678 - val_accuracy10: 0.6046 - 325s/epoch - 33ms/step
Epoch 14/50
9854/9854 - 326s - loss: 2.4324 - accuracy10: 0.6119 - val_loss: 2.7529 - val_accuracy10: 0.6061 - 326s/epoch - 33ms/step
Epoch 15/50
9854/9854 - 329s - loss: 2.4293 - accuracy10: 0.6125 - val_loss: 2.7590 - val_accuracy10: 0.6064 - 329s/epoch - 33ms/step
Epoch 16/50
9854/9854 - 328s - loss: 2.4262 - accuracy10: 0.6127 - val_loss: 2.7428 - val_accuracy10: 0.6064 - 328s/epoch - 33ms/step
Epoch 17/50
9854/9854 - 330s - loss: 2.4235 - accuracy10: 0.6131 - val_loss: 2.7321 - val_accuracy10: 0.6078 - 330s/epoch - 33ms/step
Epoch 18/50
9854/9854 - 329s - loss: 2.4212 - accuracy10: 0.6135 - val_loss: 2.7194 - val_accuracy10: 0.6069 - 329s/epoch - 33ms/step
Epoch 19/50
9854/9854 - 328s - loss: 2.4188 - accuracy10: 0.6140 - val_loss: 2.7232 - val_accuracy10: 0.6083 - 328s/epoch - 33ms/step
Epoch 20/50
9854/9854 - 331s - loss: 2.4167 - accuracy10: 0.6143 - val_loss: 2.7087 - val_accuracy10: 0.6074 - 331s/epoch - 34ms/step
Epoch 21/50
9854/9854 - 338s - loss: 2.4145 - accuracy10: 0.6148 - val_loss: 2.7097 - val_accuracy10: 0.6080 - 338s/epoch - 34ms/step
Epoch 22/50
9854/9854 - 336s - loss: 2.4123 - accuracy10: 0.6151 - val_loss: 2.7200 - val_accuracy10: 0.6076 - 336s/epoch - 34ms/step
Epoch 23/50
9854/9854 - 331s - loss: 2.4103 - accuracy10: 0.6153 - val_loss: 2.7026 - val_accuracy10: 0.6092 - 331s/epoch - 34ms/step
Epoch 24/50
9854/9854 - 330s - loss: 2.4086 - accuracy10: 0.6155 - val_loss: 2.7040 - val_accuracy10: 0.6085 - 330s/epoch - 33ms/step
Epoch 25/50
9854/9854 - 332s - loss: 2.4066 - accuracy10: 0.6158 - val_loss: 2.7017 - val_accuracy10: 0.6083 - 332s/epoch - 34ms/step
Epoch 26/50
9854/9854 - 329s - loss: 2.4055 - accuracy10: 0.6160 - val_loss: 2.7090 - val_accuracy10: 0.6065 - 329s/epoch - 33ms/step
Epoch 27/50
9854/9854 - 330s - loss: 2.4033 - accuracy10: 0.6166 - val_loss: 2.6957 - val_accuracy10: 0.6088 - 330s/epoch - 34ms/step
Epoch 28/50
9854/9854 - 329s - loss: 2.4018 - accuracy10: 0.6168 - val_loss: 2.6982 - val_accuracy10: 0.6072 - 329s/epoch - 33ms/step
Epoch 29/50
9854/9854 - 327s - loss: 2.4003 - accuracy10: 0.6172 - val_loss: 2.6834 - val_accuracy10: 0.6077 - 327s/epoch - 33ms/step
Epoch 30/50
9854/9854 - 327s - loss: 2.3991 - accuracy10: 0.6171 - val_loss: 2.7120 - val_accuracy10: 0.6073 - 327s/epoch - 33ms/step
Epoch 31/50
9854/9854 - 328s - loss: 2.3974 - accuracy10: 0.6176 - val_loss: 2.7015 - val_accuracy10: 0.6057 - 328s/epoch - 33ms/step
Epoch 32/50
9854/9854 - 327s - loss: 2.3959 - accuracy10: 0.6178 - val_loss: 2.7123 - val_accuracy10: 0.6059 - 327s/epoch - 33ms/step
Epoch 33/50
9854/9854 - 327s - loss: 2.3947 - accuracy10: 0.6181 - val_loss: 2.7073 - val_accuracy10: 0.6067 - 327s/epoch - 33ms/step
Epoch 34/50
9854/9854 - 331s - loss: 2.3932 - accuracy10: 0.6182 - val_loss: 2.7047 - val_accuracy10: 0.6068 - 331s/epoch - 34ms/step
Epoch 35/50
9854/9854 - 331s - loss: 2.3923 - accuracy10: 0.6184 - val_loss: 2.7054 - val_accuracy10: 0.6055 - 331s/epoch - 34ms/step
Epoch 36/50
9854/9854 - 328s - loss: 2.3908 - accuracy10: 0.6186 - val_loss: 2.6828 - val_accuracy10: 0.6077 - 328s/epoch - 33ms/step
Epoch 37/50
9854/9854 - 320s - loss: 2.3901 - accuracy10: 0.6192 - val_loss: 2.6962 - val_accuracy10: 0.6072 - 320s/epoch - 32ms/step
Epoch 38/50
9854/9854 - 326s - loss: 2.3886 - accuracy10: 0.6190 - val_loss: 2.6891 - val_accuracy10: 0.6090 - 326s/epoch - 33ms/step
Epoch 39/50
9854/9854 - 323s - loss: 2.3872 - accuracy10: 0.6193 - val_loss: 2.7126 - val_accuracy10: 0.6054 - 323s/epoch - 33ms/step
Epoch 40/50
9854/9854 - 323s - loss: 2.3861 - accuracy10: 0.6196 - val_loss: 2.7048 - val_accuracy10: 0.6066 - 323s/epoch - 33ms/step
Epoch 41/50
9854/9854 - 326s - loss: 2.3850 - accuracy10: 0.6197 - val_loss: 2.7151 - val_accuracy10: 0.6055 - 326s/epoch - 33ms/step
Epoch 42/50
9854/9854 - 326s - loss: 2.3839 - accuracy10: 0.6201 - val_loss: 2.6972 - val_accuracy10: 0.6061 - 326s/epoch - 33ms/step
Epoch 43/50
9854/9854 - 322s - loss: 2.3829 - accuracy10: 0.6200 - val_loss: 2.7508 - val_accuracy10: 0.6058 - 322s/epoch - 33ms/step
Epoch 44/50
9854/9854 - 325s - loss: 2.3821 - accuracy10: 0.6200 - val_loss: 2.7275 - val_accuracy10: 0.6059 - 325s/epoch - 33ms/step
Epoch 45/50
9854/9854 - 334s - loss: 2.3809 - accuracy10: 0.6206 - val_loss: 2.7401 - val_accuracy10: 0.6068 - 334s/epoch - 34ms/step
Epoch 46/50
9854/9854 - 343s - loss: 2.3802 - accuracy10: 0.6204 - val_loss: 2.7545 - val_accuracy10: 0.6058 - 343s/epoch - 35ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 394s - 394s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82745624
{'0': {'precision': 0.4427211270698989, 'recall': 0.6035560986047651, 'f1-score': 0.5107767418944082, 'support': 1322573}, '1': {'precision': 0.7728690025918786, 'recall': 0.678095615354932, 'f1-score': 0.7223871284234227, 'support': 3418133}, '2': {'precision': 0.492809158152837, 'recall': 0.47010237241016584, 'f1-score': 0.48118803657413917, 'support': 1330925}, 'accuracy': 0.6162658765000706, 'macro avg': {'precision': 0.5694664292715381, 'recall': 0.5839180287899544, 'f1-score': 0.5714506356306567, 'support': 6071631}, 'weighted avg': {'precision': 0.6395632541640242, 'recall': 0.6162658765000706, 'f1-score': 0.6234206258374873, 'support': 6071631}}
[[ 798247  330755  193571]
 [ 649953 2317821  450359]
 [ 354847  350407  625671]]
Evaluating performance on  train set...
9854/9854 - 163s - 163s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.852832
{'0': {'precision': 0.4505856428217356, 'recall': 0.6612351930267057, 'f1-score': 0.5359552095080666, 'support': 629602}, '1': {'precision': 0.780375724896204, 'recall': 0.6459034222967724, 'f1-score': 0.7068004217544447, 'support': 1261492}, '2': {'precision': 0.5219040295182702, 'recall': 0.45823988588184017, 'f1-score': 0.48800434134225457, 'support': 630925}, 'accuracy': 0.6027837220893261, 'macro avg': {'precision': 0.5842884657454033, 'recall': 0.5884595004017728, 'f1-score': 0.5769199908682553, 'support': 2522019}, 'weighted avg': {'precision': 0.6333852582658684, 'recall': 0.6027837220893261, 'f1-score': 0.6094147936704354, 'support': 2522019}}
[[416315 114121  99166]
 [281009 814802 165681]
 [226618 115192 289115]]
Evaluating performance on  val set...
3566/3566 - 61s - 61s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84282357
{'0': {'precision': 0.4659374502203579, 'recall': 0.6435005047062782, 'f1-score': 0.5405096933035496, 'support': 231818}, '1': {'precision': 0.7746978554453844, 'recall': 0.6638627096820344, 'f1-score': 0.7150105876220525, 'support': 447344}, '2': {'precision': 0.5219058837048954, 'recall': 0.46742570436125047, 'f1-score': 0.49316574593134527, 'support': 233190}, 'accuracy': 0.608481156395777, 'macro avg': {'precision': 0.5875137297902125, 'recall': 0.5915963062498543, 'f1-score': 0.5828953422856491, 'support': 912352}, 'weighted avg': {'precision': 0.6316337973750127, 'recall': 0.608481156395777, 'f1-score': 0.6139701482379302, 'support': 912352}}
[[149175  42615  40028]
 [ 90548 296975  59821]
 [ 80438  43753 108999]]
testing model out of sample: results/universal/W4/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 196s - 196s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83253664
{'0': {'precision': 0.42874058626395356, 'recall': 0.6054532124974653, 'f1-score': 0.5019994619817695, 'support': 641090}, '1': {'precision': 0.7787914955465671, 'recall': 0.6836424911900937, 'f1-score': 0.7281216970636302, 'support': 1761937}, '2': {'precision': 0.47419968118362305, 'recall': 0.43725809915449043, 'f1-score': 0.45498026499285343, 'support': 628615}, 'accuracy': 0.6160199654180804, 'macro avg': {'precision': 0.5605772543313813, 'recall': 0.5754512676140164, 'f1-score': 0.5617004746794176, 'support': 3031642}, 'weighted avg': {'precision': 0.6416100206831918, 'recall': 0.6160199654180804, 'f1-score': 0.623668234217489, 'support': 3031642}}
[[ 388150  164658   88282]
 [ 340907 1204535  216495]
 [ 176269  177479  274867]]
Evaluating performance on  train set...
5528/5528 - 90s - 90s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7269669
{'0': {'precision': 0.4257131018841591, 'recall': 0.6057216438866221, 'f1-score': 0.5000096049792213, 'support': 257828}, '1': {'precision': 0.8344527506323504, 'recall': 0.7566979452085212, 'f1-score': 0.7936755247979934, 'support': 900724}, '2': {'precision': 0.48711561289651767, 'recall': 0.4393580605833255, 'f1-score': 0.4620059416436904, 'support': 255912}, 'accuracy': 0.6717632969096421, 'macro avg': {'precision': 0.5824271551376757, 'recall': 0.600592549892823, 'f1-score': 0.5852303571403017, 'support': 1414464}, 'weighted avg': {'precision': 0.6971058349457715, 'recall': 0.6717632969096421, 'f1-score': 0.6801388613415758, 'support': 1414464}}
[[156172  67342  34314]
 [135077 681576  84071]
 [ 75599  67876 112437]]
Evaluating performance on  val set...
1908/1908 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7520135
{'0': {'precision': 0.4304515854178078, 'recall': 0.6112281384018753, 'f1-score': 0.5051535807230637, 'support': 92571}, '1': {'precision': 0.826412160035547, 'recall': 0.7333747363025177, 'f1-score': 0.7771187222641023, 'support': 304326}, '2': {'precision': 0.4733694137322308, 'recall': 0.4492835097001764, 'f1-score': 0.4610120798081708, 'support': 90720}, 'accuracy': 0.6573314712161389, 'macro avg': {'precision': 0.5767443863951952, 'recall': 0.5979621281348565, 'f1-score': 0.5810947942651122, 'support': 487617}, 'weighted avg': {'precision': 0.6855587765448656, 'recall': 0.6573314712161389, 'f1-score': 0.6666769621917553, 'support': 487617}}
[[ 56582  23178  12811]
 [ 48607 223185  32534]
 [ 26259  23702  40759]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1515164
{'0': {'precision': 0.41179394371941275, 'recall': 0.70270329048955, 'f1-score': 0.5192816103499539, 'support': 45981}, '1': {'precision': 0.5297641332834144, 'recall': 0.18728492014471013, 'f1-score': 0.27673652987385505, 'support': 45332}, '2': {'precision': 0.4483208424248174, 'recall': 0.4169074347720606, 'f1-score': 0.43204388320667386, 'support': 45341}, 'accuracy': 0.4368990296661642, 'macro avg': {'precision': 0.4632929731425482, 'recall': 0.43563188180210694, 'f1-score': 0.40935400781016096, 'support': 136654}, 'weighted avg': {'precision': 0.46304740682709405, 'recall': 0.4368990296661642, 'f1-score': 0.4098775726009969, 'support': 136654}}
[[32311  3886  9784]
 [23365  8490 13477]
 [22788  3650 18903]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3411207
{'0': {'precision': 0.3023910907304291, 'recall': 0.8032016704367496, 'f1-score': 0.4393679802017894, 'support': 17241}, '1': {'precision': 0.6465968586387435, 'recall': 0.0822592999633663, 'f1-score': 0.14595089668212838, 'support': 30027}, '2': {'precision': 0.38822531166372953, 'recall': 0.33665383744623045, 'f1-score': 0.3606050501682379, 'support': 17668}, 'accuracy': 0.342891462362942, 'macro avg': {'precision': 0.4457377536776341, 'recall': 0.4073716026154488, 'f1-score': 0.31530797568405194, 'support': 64936}, 'weighted avg': {'precision': 0.48490904084180814, 'recall': 0.342891462362942, 'f1-score': 0.28225916206273477, 'support': 64936}}
[[13848   617  2776]
 [20960  2470  6597]
 [10987   733  5948]]
Evaluating performance on  val set...
81/81 - 1s - 765ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3056358
{'0': {'precision': 0.3205916914356812, 'recall': 0.7967703143789727, 'f1-score': 0.45721608832807564, 'support': 5821}, '1': {'precision': 0.6258890469416786, 'recall': 0.09824718097577313, 'f1-score': 0.1698349898677989, 'support': 8957}, '2': {'precision': 0.39945193929173695, 'recall': 0.3245418736084946, 'f1-score': 0.3581215156382878, 'support': 5839}, 'accuracy': 0.3595576466023185, 'macro avg': {'precision': 0.44864422588969893, 'recall': 0.4065197896544135, 'f1-score': 0.3283908646113875, 'support': 20617}, 'weighted avg': {'precision': 0.4755615415835556, 'recall': 0.3595576466023185, 'f1-score': 0.3042992862305653, 'support': 20617}}
[[4638  252  931]
 [6159  880 1918]
 [3670  274 1895]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.38414854
{'0': {'precision': 0.48388820773994784, 'recall': 0.45576216984484186, 'f1-score': 0.46940424818163795, 'support': 33772}, '1': {'precision': 0.913315445198662, 'recall': 0.9440760491537213, 'f1-score': 0.9284410311514448, 'support': 345040}, '2': {'precision': 0.5255342712990688, 'recall': 0.37641390251784823, 'f1-score': 0.4386469460421802, 'support': 34037}, 'accuracy': 0.8573304040944753, 'macro avg': {'precision': 0.6409126414125595, 'recall': 0.5920840405054705, 'f1-score': 0.6121640751250876, 'support': 412849}, 'weighted avg': {'precision': 0.8462170036874166, 'recall': 0.8573304040944753, 'f1-score': 0.850510089065306, 'support': 412849}}
[[ 15392  14091   4289]
 [ 12018 325744   7278]
 [  4399  16826  12812]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4336595
{'0': {'precision': 0.5246158224245874, 'recall': 0.4609902475618905, 'f1-score': 0.4907493677625449, 'support': 15996}, '1': {'precision': 0.8957925851850762, 'recall': 0.9365683402907509, 'f1-score': 0.9157267687682045, 'support': 130077}, '2': {'precision': 0.5334652159577976, 'recall': 0.40166325327375413, 'f1-score': 0.45827580102673043, 'support': 16113}, 'accuracy': 0.836521031408383, 'macro avg': {'precision': 0.6512912078558203, 'recall': 0.5997406137087985, 'f1-score': 0.6215839791858266, 'support': 162186}, 'weighted avg': {'precision': 0.8231875243445849, 'recall': 0.836521031408383, 'f1-score': 0.8283650609160785, 'support': 162186}}
[[  7374   6876   1746]
 [  4337 121826   3914]
 [  2345   7296   6472]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.37656537
{'0': {'precision': 0.5220088626292467, 'recall': 0.44208156117087816, 'f1-score': 0.4787320509347061, 'support': 3997}, '1': {'precision': 0.9175617906820303, 'recall': 0.9484970838941229, 'f1-score': 0.9327730165558167, 'support': 44580}, '2': {'precision': 0.5052115266707541, 'recall': 0.39682157476522995, 'f1-score': 0.4445043830074174, 'support': 4153}, 'accuracy': 0.8666603451545609, 'macro avg': {'precision': 0.648260726660677, 'recall': 0.5958000732767437, 'f1-score': 0.6186698168326467, 'support': 52730}, 'weighted avg': {'precision': 0.8551017925810287, 'recall': 0.8666603451545609, 'f1-score': 0.8599002425236892, 'support': 52730}}
[[ 1767  1787   443]
 [ 1125 42284  1171]
 [  493  2012  1648]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1077797
{'0': {'precision': 0.40535218831110714, 'recall': 0.5848314848558761, 'f1-score': 0.4788257544609818, 'support': 69697}, '1': {'precision': 0.6229356188757738, 'recall': 0.43204769436671125, 'f1-score': 0.5102220945030583, 'support': 115066}, '2': {'precision': 0.4305704762691789, 'recall': 0.45834677301117205, 'f1-score': 0.4440246569894611, 'support': 68206}, 'accuracy': 0.48123287833687134, 'macro avg': {'precision': 0.48628609448535326, 'recall': 0.4917419840779198, 'f1-score': 0.47769083531783374, 'support': 252969}, 'weighted avg': {'precision': 0.5111220398337134, 'recall': 0.48123287833687134, 'f1-score': 0.48372361787167256, 'support': 252969}}
[[40761 14585 14351]
 [38359 49714 26993]
 [21437 15507 31262]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0741754
{'0': {'precision': 0.45444087117943893, 'recall': 0.6193123107072867, 'f1-score': 0.5242188442514175, 'support': 28065}, '1': {'precision': 0.574172013178429, 'recall': 0.43975563597729006, 'f1-score': 0.4980540357606182, 'support': 30119}, '2': {'precision': 0.4950251714432949, 'recall': 0.44036956061781507, 'f1-score': 0.4661005878510777, 'support': 28358}, 'accuracy': 0.49818585195627557, 'macro avg': {'precision': 0.5078793519337209, 'recall': 0.4998125024341306, 'f1-score': 0.49612448928770453, 'support': 86542}, 'weighted avg': {'precision': 0.5094092316604771, 'recall': 0.49818585195627557, 'f1-score': 0.4960686353131537, 'support': 86542}}
[[17381  4691  5993]
 [10128 13245  6746]
 [10738  5132 12488]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0942858
{'0': {'precision': 0.46110804089527496, 'recall': 0.6222615829215997, 'f1-score': 0.5296988453755506, 'support': 10727}, '1': {'precision': 0.5089476495726496, 'recall': 0.3853387259858443, 'f1-score': 0.43860052940499483, 'support': 9890}, '2': {'precision': 0.5038670568561873, 'recall': 0.4416857535501603, 'f1-score': 0.4707318263926183, 'support': 10915}, 'accuracy': 0.4854433591272358, 'macro avg': {'precision': 0.4913075824413706, 'recall': 0.48309535415253485, 'f1-score': 0.47967706705772123, 'support': 31532}, 'weighted avg': {'precision': 0.4909142183985286, 'recall': 0.4854433591272358, 'f1-score': 0.48071408839383356, 'support': 31532}}
[[6675 1741 2311]
 [3643 3811 2436]
 [4158 1936 4821]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
925/925 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2744641
{'0': {'precision': 0.29817671456173805, 'recall': 0.675848787446505, 'f1-score': 0.413792802274345, 'support': 70100}, '1': {'precision': 0.4939235601479481, 'recall': 0.16072827312152532, 'f1-score': 0.2425334409594096, 'support': 104686}, '2': {'precision': 0.2991152061089645, 'recall': 0.21132971506105835, 'f1-score': 0.24767385727943056, 'support': 61908}, 'accuracy': 0.32652285229029887, 'macro avg': {'precision': 0.3637384936062169, 'recall': 0.3493022585430296, 'f1-score': 0.30133336683772843, 'support': 236694}, 'weighted avg': {'precision': 0.384997903150142, 'recall': 0.32652285229029887, 'f1-score': 0.2945986142283426, 'support': 236694}}
[[47377  9205 13518]
 [70722 16826 17138]
 [40790  8035 13083]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2444694
{'0': {'precision': 0.3388057218895542, 'recall': 0.6846952838750883, 'f1-score': 0.4533042539696669, 'support': 29749}, '1': {'precision': 0.348762649033163, 'recall': 0.12024594977374002, 'f1-score': 0.1788338042640637, 'support': 28949}, '2': {'precision': 0.37300341112133845, 'recall': 0.23061730048205678, 'f1-score': 0.2850168593947167, 'support': 29872}, 'accuracy': 0.34705882352941175, 'macro avg': {'precision': 0.3535239273480186, 'recall': 0.34518617804362833, 'f1-score': 0.30571830587614907, 'support': 88570}, 'weighted avg': {'precision': 0.3535939849200633, 'recall': 0.34705882352941175, 'f1-score': 0.30683562916137497, 'support': 88570}}
[[20369  3333  6047]
 [19935  3481  5533]
 [19816  3167  6889]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2361525
{'0': {'precision': 0.34093097913322634, 'recall': 0.6843413421706711, 'f1-score': 0.4551242806416065, 'support': 10863}, '1': {'precision': 0.39337252805986106, 'recall': 0.13375738300772377, 'f1-score': 0.1996338238285753, 'support': 11005}, '2': {'precision': 0.3506841165972635, 'recall': 0.22666538498510044, 'f1-score': 0.2753547031003678, 'support': 10403}, 'accuracy': 0.3490440333426296, 'macro avg': {'precision': 0.36166254126345027, 'recall': 0.34825470338783177, 'f1-score': 0.31003760252351653, 'support': 32271}, 'weighted avg': {'precision': 0.3619585622566497, 'recall': 0.3490440333426296, 'f1-score': 0.31004617979598925, 'support': 32271}}
[[7434 1146 2283]
 [7450 1472 2083]
 [6921 1124 2358]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1259917
{'0': {'precision': 0.4113010595376103, 'recall': 0.6634656214274048, 'f1-score': 0.507801586879959, 'support': 122460}, '1': {'precision': 0.6030349051436539, 'recall': 0.2916057185854026, 'f1-score': 0.39311522902575297, 'support': 166125}, '2': {'precision': 0.4430160156128992, 'recall': 0.48310108943501395, 'f1-score': 0.46219105254227705, 'support': 118410}, 'accuracy': 0.4592071155665303, 'macro avg': {'precision': 0.48578399343138784, 'recall': 0.4793908098159405, 'f1-score': 0.454369289482663, 'support': 406995}, 'weighted avg': {'precision': 0.4987889968591473, 'recall': 0.4592071155665303, 'f1-score': 0.4477197318953648, 'support': 406995}}
[[81248 15904 25308]
 [71070 48443 46612]
 [45221 15985 57204]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1230181
{'0': {'precision': 0.43477729660752346, 'recall': 0.6946685753947597, 'f1-score': 0.534821778954136, 'support': 46104}, '1': {'precision': 0.5384723788049606, 'recall': 0.25353888348226133, 'f1-score': 0.3447518796992481, 'support': 45212}, '2': {'precision': 0.49384334472587665, 'recall': 0.45511617371043944, 'f1-score': 0.47368952857832514, 'support': 46353}, 'accuracy': 0.4691397482367127, 'macro avg': {'precision': 0.4890310067127868, 'recall': 0.46777454419582015, 'f1-score': 0.4510877290772364, 'support': 137669}, 'weighted avg': {'precision': 0.48871936479092387, 'recall': 0.4691397482367127, 'f1-score': 0.45181759146979344, 'support': 137669}}
[[32027  4944  9133]
 [21260 11463 12489]
 [20376  4881 21096]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1818721
{'0': {'precision': 0.41314537689663555, 'recall': 0.7017574899740505, 'f1-score': 0.5200952859671744, 'support': 16956}, '1': {'precision': 0.5427642276422764, 'recall': 0.16816120906801008, 'f1-score': 0.2567692307692308, 'support': 19850}, '2': {'precision': 0.4441508009276738, 'recall': 0.4935275080906149, 'f1-score': 0.46753910352854344, 'support': 16686}, 'accuracy': 0.43879458610633365, 'macro avg': {'precision': 0.46668680182219524, 'recall': 0.4544820690442252, 'f1-score': 0.4148012067549829, 'support': 53492}, 'weighted avg': {'precision': 0.4709164584169166, 'recall': 0.43879458610633365, 'f1-score': 0.4059852385610169, 'support': 53492}}
[[11899  1463  3594]
 [ 9800  3338  6712]
 [ 7102  1349  8235]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
3782/3782 - 32s - 32s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49116153
{'0': {'precision': 0.5090011413550998, 'recall': 0.5060998151571164, 'f1-score': 0.5075463320213651, 'support': 116315}, '1': {'precision': 0.8713066506994662, 'recall': 0.9047375801830722, 'f1-score': 0.8877074760233132, 'support': 730204}, '2': {'precision': 0.5503247270910617, 'recall': 0.4263585680992811, 'f1-score': 0.4804744051375329, 'support': 121433}, 'accuracy': 0.7968205034960412, 'macro avg': {'precision': 0.6435441730485426, 'recall': 0.6123986544798231, 'f1-score': 0.6252427377274038, 'support': 967952}, 'weighted avg': {'precision': 0.7875014999802885, 'recall': 0.7968205034960412, 'f1-score': 0.7909361723207955, 'support': 967952}}
[[ 58867  46869  10579]
 [ 37835 660643  31726]
 [ 18950  50709  51774]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5205691
{'0': {'precision': 0.5410326582740376, 'recall': 0.5008021887085606, 'f1-score': 0.5201406733729159, 'support': 59213}, '1': {'precision': 0.8446839483936773, 'recall': 0.8974245541838134, 'f1-score': 0.8702559165423748, 'support': 291600}, '2': {'precision': 0.5639747424393486, 'recall': 0.43188720541576886, 'f1-score': 0.48917116666986954, 'support': 58939}, 'accuracy': 0.7731457076475526, 'macro avg': {'precision': 0.6498971163690211, 'recall': 0.610037982769381, 'f1-score': 0.6265225855283868, 'support': 409752}, 'weighted avg': {'precision': 0.7604260955178003, 'recall': 0.7731457076475526, 'f1-score': 0.7648455025199203, 'support': 409752}}
[[ 29654  23727   5832]
 [ 16063 261689  13848]
 [  9093  24391  25455]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47486508
{'0': {'precision': 0.5314386317907445, 'recall': 0.4939801285797779, 'f1-score': 0.5120252014296965, 'support': 17110}, '1': {'precision': 0.8662742976532478, 'recall': 0.9097365070036243, 'f1-score': 0.8874736027367154, 'support': 102090}, '2': {'precision': 0.5565097377702807, 'recall': 0.42799858473876634, 'f1-score': 0.48386666666666667, 'support': 16958}, 'accuracy': 0.7974926188692548, 'macro avg': {'precision': 0.651407555738091, 'recall': 0.6105717401073895, 'f1-score': 0.6277884902776929, 'support': 136158}, 'weighted avg': {'precision': 0.7856178129119709, 'recall': 0.7974926188692548, 'f1-score': 0.7900258687200657, 'support': 136158}}
[[ 8452  7066  1592]
 [ 5023 92875  4192]
 [ 2429  7271  7258]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61894464
{'0': {'precision': 0.4682410303858072, 'recall': 0.5553046224585767, 'f1-score': 0.5080699778762825, 'support': 172246}, '1': {'precision': 0.8330050689733438, 'recall': 0.825881985248156, 'f1-score': 0.8294282342306148, 'support': 799900}, '2': {'precision': 0.5055491345578099, 'recall': 0.430120903011024, 'f1-score': 0.4647947279308921, 'support': 168813}, 'accuracy': 0.72647833971247, 'macro avg': {'precision': 0.6022650779723203, 'recall': 0.6037691702392523, 'f1-score': 0.6007643133459298, 'support': 1140959}, 'weighted avg': {'precision': 0.729488671585674, 'recall': 0.72647833971247, 'f1-score': 0.7269639473254909, 'support': 1140959}}
[[ 95649  63030  13567]
 [ 81828 660623  57449]
 [ 26796  69407  72610]]
Evaluating performance on  train set...
2425/2425 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53182334
{'0': {'precision': 0.4573453594933308, 'recall': 0.5562872294970719, 'f1-score': 0.5019873783049733, 'support': 79574}, '1': {'precision': 0.8728175971219579, 'recall': 0.8639275933931555, 'f1-score': 0.8683498423037181, 'support': 464488}, '2': {'precision': 0.5176270816781169, 'recall': 0.43334854907075315, 'f1-score': 0.47175329745999744, 'support': 76675}, 'accuracy': 0.7713041110808603, 'macro avg': {'precision': 0.6159300127644686, 'recall': 0.6178544573203268, 'f1-score': 0.614030172689563, 'support': 620737}, 'weighted avg': {'precision': 0.7756830286836066, 'recall': 0.7713041110808603, 'f1-score': 0.7723962149444205, 'support': 620737}}
[[ 44266  29253   6055]
 [ 38295 401284  24909]
 [ 14228  29220  33227]]
Evaluating performance on  val set...
787/787 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5366757
{'0': {'precision': 0.48307249034116956, 'recall': 0.5463432697648584, 'f1-score': 0.5127634802856795, 'support': 27005}, '1': {'precision': 0.8650576047758614, 'recall': 0.8641996964074886, 'f1-score': 0.8646284377815953, 'support': 148225}, '2': {'precision': 0.511105211928148, 'recall': 0.4444444444444444, 'f1-score': 0.47544964398896983, 'support': 25992}, 'accuracy': 0.7673216646291161, 'macro avg': {'precision': 0.619745102348393, 'recall': 0.6183291368722638, 'f1-score': 0.6176138540187482, 'support': 201222}, 'weighted avg': {'precision': 0.7680729877349483, 'recall': 0.7673216646291161, 'f1-score': 0.7671358754105069, 'support': 201222}}
[[ 14754   9908   2343]
 [ 11422 128096   8707]
 [  4366  10074  11552]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6374739
{'0': {'precision': 0.4848045803586149, 'recall': 0.5198092993357617, 'f1-score': 0.5016970884528188, 'support': 186680}, '1': {'precision': 0.82010050132537, 'recall': 0.8455141874850051, 'f1-score': 0.8326134653980681, 'support': 821111}, '2': {'precision': 0.5249876891544778, 'recall': 0.41698115202063446, 'f1-score': 0.46479238346608853, 'support': 189198}, 'accuracy': 0.7269832889024043, 'macro avg': {'precision': 0.6099642569461542, 'recall': 0.5941015462804672, 'f1-score': 0.5997009791056584, 'support': 1196989}, 'weighted avg': {'precision': 0.7211624188841927, 'recall': 0.7269832889024043, 'f1-score': 0.7228660221822107, 'support': 1196989}}
[[ 97038  72436  17206]
 [ 72674 694261  54176]
 [ 30447  79859  78892]]
Evaluating performance on  train set...
2108/2108 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6142778
{'0': {'precision': 0.48681648891146095, 'recall': 0.5342483250310609, 'f1-score': 0.5094307241755383, 'support': 86121}, '1': {'precision': 0.8281667543258477, 'recall': 0.8478761622705034, 'f1-score': 0.8379055720169586, 'support': 367707}, '2': {'precision': 0.5454930668186269, 'recall': 0.43623000432338954, 'f1-score': 0.48478119724711083, 'support': 85581}, 'accuracy': 0.7324924129927384, 'macro avg': {'precision': 0.6201587700186452, 'recall': 0.6061181638749846, 'f1-score': 0.6107058311465359, 'support': 539409}, 'weighted avg': {'precision': 0.728819277627632, 'recall': 0.7324924129927384, 'f1-score': 0.7294362667437257, 'support': 539409}}
[[ 46010  31910   8201]
 [ 33032 311770  22905]
 [ 15470  32778  37333]]
Evaluating performance on  val set...
798/798 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66846746
{'0': {'precision': 0.464526237021794, 'recall': 0.5532501531777418, 'f1-score': 0.5050209736875556, 'support': 35906}, '1': {'precision': 0.8156786909631834, 'recall': 0.8239952514407219, 'f1-score': 0.8198158800641393, 'support': 133093}, '2': {'precision': 0.5468697876125875, 'recall': 0.4192191850883673, 'f1-score': 0.474611165618516, 'support': 35194}, 'accuracy': 0.7066206970856004, 'macro avg': {'precision': 0.6090249051991883, 'recall': 0.5988215299022771, 'f1-score': 0.599816006456737, 'support': 204193}, 'weighted avg': {'precision': 0.707599860857644, 'recall': 0.7066206970856004, 'f1-score': 0.7049629682182048, 'support': 204193}}
[[ 19865  12438   3603]
 [ 14803 109668   8622]
 [  8096  12344  14754]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8426985
{'0': {'precision': 0.4262535826563951, 'recall': 0.5988660893084705, 'f1-score': 0.49802734857264386, 'support': 230706}, '1': {'precision': 0.7574869791666666, 'recall': 0.6883813731876874, 'f1-score': 0.7212827171180084, 'support': 635514}, '2': {'precision': 0.4930404681961351, 'recall': 0.4163356667910202, 'f1-score': 0.4514530878563117, 'support': 227845}, 'accuracy': 0.6128502419874504, 'macro avg': {'precision': 0.5589270100063989, 'recall': 0.5678610430957262, 'f1-score': 0.5569210511823213, 'support': 1094065}, 'weighted avg': {'precision': 0.6325672099871578, 'recall': 0.6128502419874504, 'f1-score': 0.6180112616425493, 'support': 1094065}}
[[138162  67261  25283]
 [125783 437476  72255]
 [ 60186  72799  94860]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7210941
{'0': {'precision': 0.43285337515147193, 'recall': 0.5593938556492101, 'f1-score': 0.4880548132371556, 'support': 86844}, '1': {'precision': 0.8189792070273715, 'recall': 0.765300201282648, 'f1-score': 0.791230320481073, 'support': 330878}, '2': {'precision': 0.4777228615750929, 'recall': 0.4573671970342398, 'f1-score': 0.46732347145840075, 'support': 86858}, 'accuracy': 0.6768540172024258, 'macro avg': {'precision': 0.5765184812513121, 'recall': 0.5940204179886992, 'f1-score': 0.5822028683922098, 'support': 504580}, 'weighted avg': {'precision': 0.6937789307644902, 'recall': 0.6768540172024258, 'f1-score': 0.6832932741385662, 'support': 504580}}
[[ 48580  27983  10281]
 [ 44507 253221  33150]
 [ 19145  27987  39726]]
Evaluating performance on  val set...
707/707 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74133974
{'0': {'precision': 0.42901062045835664, 'recall': 0.5745118832262491, 'f1-score': 0.4912130990159737, 'support': 32062}, '1': {'precision': 0.8133090841260959, 'recall': 0.7427600422472829, 'f1-score': 0.7764352874136334, 'support': 117404}, '2': {'precision': 0.4642460291522322, 'recall': 0.45400792636154436, 'f1-score': 0.45906990272436415, 'support': 31288}, 'accuracy': 0.6629341536010268, 'macro avg': {'precision': 0.5688552445788949, 'recall': 0.5904266172783588, 'f1-score': 0.5755727630513238, 'support': 180754}, 'weighted avg': {'precision': 0.6847207142635352, 'recall': 0.6629341536010268, 'f1-score': 0.6709077640362054, 'support': 180754}}
[[18420  9993  3649]
 [17457 87203 12744]
 [ 7059 10024 14205]]
testing model on single stock: results/universal/W4/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
12724/12724 - 108s - 108s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0209298
{'0': {'precision': 0.4468970815435416, 'recall': 0.6327249138915766, 'f1-score': 0.523818370936529, 'support': 915706}, '1': {'precision': 0.6184299041948752, 'recall': 0.4378875895143011, 'f1-score': 0.5127298972973576, 'support': 1417092}, '2': {'precision': 0.49050489771572253, 'recall': 0.507981292780108, 'f1-score': 0.49909015152803526, 'support': 924349}, 'accuracy': 0.5125556199950447, 'macro avg': {'precision': 0.5186106278180465, 'recall': 0.5261979320619953, 'f1-score': 0.511879473253974, 'support': 3257147}, 'weighted avg': {'precision': 0.5339016385953305, 'recall': 0.5125556199950447, 'f1-score': 0.5119764454206397, 'support': 3257147}}
[[579390 188385 147931]
 [456765 620527 339800]
 [260318 194479 469552]]
Evaluating performance on  train set...
5165/5165 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0786321
{'0': {'precision': 0.4465585593816785, 'recall': 0.7133126426664052, 'f1-score': 0.549260755048288, 'support': 438523}, '1': {'precision': 0.5474324432721662, 'recall': 0.2617999408790073, 'f1-score': 0.35420673737429254, 'support': 443159}, '2': {'precision': 0.5195195415092313, 'recall': 0.48327278506879795, 'f1-score': 0.5007410788225551, 'support': 440420}, 'accuracy': 0.48533774247372746, 'macro avg': {'precision': 0.5045035147210254, 'recall': 0.48612845620473677, 'f1-score': 0.46806952374837857, 'support': 1322102}, 'weighted avg': {'precision': 0.50467559215195, 'recall': 0.48533774247372746, 'f1-score': 0.4677171379735635, 'support': 1322102}}
[[312804  48416  77303]
 [207594 116019 119546]
 [180079  47498 212843]]
Evaluating performance on  val set...
1903/1903 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.043657
{'0': {'precision': 0.4721691089376967, 'recall': 0.6808322455502556, 'f1-score': 0.5576193878111776, 'support': 163942}, '1': {'precision': 0.548937281092958, 'recall': 0.3223099325567137, 'f1-score': 0.4061486459297413, 'support': 156576}, '2': {'precision': 0.52134565209171, 'recall': 0.4968945591715621, 'f1-score': 0.5088265324951715, 'support': 166482}, 'accuracy': 0.5026837782340863, 'macro avg': {'precision': 0.5141506807074548, 'recall': 0.5000122457595104, 'f1-score': 0.4908648554120301, 'support': 487000}, 'weighted avg': {'precision': 0.5136620505819444, 'recall': 0.5026837782340863, 'f1-score': 0.4922398908511219, 'support': 487000}}
[[111617  20278  32047]
 [ 62207  50466  43903]
 [ 62568  21190  82724]]
training model: results/universal/W4/deepVOL_L2/h20
Epoch 1/50
9854/9854 - 342s - loss: 2.7645 - accuracy20: 0.5386 - val_loss: 3.0428 - val_accuracy20: 0.5425 - 342s/epoch - 35ms/step
Epoch 2/50
9854/9854 - 337s - loss: 2.6779 - accuracy20: 0.5635 - val_loss: 2.9836 - val_accuracy20: 0.5515 - 337s/epoch - 34ms/step
Epoch 3/50
9854/9854 - 330s - loss: 2.6485 - accuracy20: 0.5694 - val_loss: 2.9854 - val_accuracy20: 0.5525 - 330s/epoch - 33ms/step
Epoch 4/50
9854/9854 - 322s - loss: 2.6321 - accuracy20: 0.5726 - val_loss: 2.9880 - val_accuracy20: 0.5532 - 322s/epoch - 33ms/step
Epoch 5/50
9854/9854 - 334s - loss: 2.6206 - accuracy20: 0.5743 - val_loss: 3.0227 - val_accuracy20: 0.5525 - 334s/epoch - 34ms/step
Epoch 6/50
9854/9854 - 323s - loss: 2.6109 - accuracy20: 0.5761 - val_loss: 2.9868 - val_accuracy20: 0.5563 - 323s/epoch - 33ms/step
Epoch 7/50
9854/9854 - 329s - loss: 2.6037 - accuracy20: 0.5773 - val_loss: 2.9962 - val_accuracy20: 0.5561 - 329s/epoch - 33ms/step
Epoch 8/50
9854/9854 - 326s - loss: 2.5976 - accuracy20: 0.5785 - val_loss: 2.9783 - val_accuracy20: 0.5600 - 326s/epoch - 33ms/step
Epoch 9/50
9854/9854 - 325s - loss: 2.5918 - accuracy20: 0.5795 - val_loss: 2.9824 - val_accuracy20: 0.5584 - 325s/epoch - 33ms/step
Epoch 10/50
9854/9854 - 323s - loss: 2.5876 - accuracy20: 0.5800 - val_loss: 2.9664 - val_accuracy20: 0.5604 - 323s/epoch - 33ms/step
Epoch 11/50
9854/9854 - 326s - loss: 2.5832 - accuracy20: 0.5810 - val_loss: 2.9547 - val_accuracy20: 0.5633 - 326s/epoch - 33ms/step
Epoch 12/50
9854/9854 - 327s - loss: 2.5788 - accuracy20: 0.5816 - val_loss: 2.9306 - val_accuracy20: 0.5650 - 327s/epoch - 33ms/step
Epoch 13/50
9854/9854 - 318s - loss: 2.5755 - accuracy20: 0.5823 - val_loss: 2.9255 - val_accuracy20: 0.5649 - 318s/epoch - 32ms/step
Epoch 14/50
9854/9854 - 320s - loss: 2.5724 - accuracy20: 0.5830 - val_loss: 2.9352 - val_accuracy20: 0.5630 - 320s/epoch - 33ms/step
Epoch 15/50
9854/9854 - 328s - loss: 2.5693 - accuracy20: 0.5833 - val_loss: 2.9151 - val_accuracy20: 0.5649 - 328s/epoch - 33ms/step
Epoch 16/50
9854/9854 - 317s - loss: 2.5669 - accuracy20: 0.5839 - val_loss: 2.9161 - val_accuracy20: 0.5659 - 317s/epoch - 32ms/step
Epoch 17/50
9854/9854 - 321s - loss: 2.5645 - accuracy20: 0.5844 - val_loss: 2.8986 - val_accuracy20: 0.5683 - 321s/epoch - 33ms/step
Epoch 18/50
9854/9854 - 324s - loss: 2.5619 - accuracy20: 0.5846 - val_loss: 2.9058 - val_accuracy20: 0.5651 - 324s/epoch - 33ms/step
Epoch 19/50
9854/9854 - 325s - loss: 2.5599 - accuracy20: 0.5852 - val_loss: 2.9045 - val_accuracy20: 0.5652 - 325s/epoch - 33ms/step
Epoch 20/50
9854/9854 - 322s - loss: 2.5581 - accuracy20: 0.5852 - val_loss: 2.8773 - val_accuracy20: 0.5673 - 322s/epoch - 33ms/step
Epoch 21/50
9854/9854 - 322s - loss: 2.5557 - accuracy20: 0.5860 - val_loss: 2.8830 - val_accuracy20: 0.5648 - 322s/epoch - 33ms/step
Epoch 22/50
9854/9854 - 319s - loss: 2.5542 - accuracy20: 0.5861 - val_loss: 2.8878 - val_accuracy20: 0.5669 - 319s/epoch - 32ms/step
Epoch 23/50
9854/9854 - 314s - loss: 2.5526 - accuracy20: 0.5864 - val_loss: 2.8816 - val_accuracy20: 0.5655 - 314s/epoch - 32ms/step
Epoch 24/50
9854/9854 - 324s - loss: 2.5505 - accuracy20: 0.5867 - val_loss: 2.8775 - val_accuracy20: 0.5652 - 324s/epoch - 33ms/step
Epoch 25/50
9854/9854 - 319s - loss: 2.5491 - accuracy20: 0.5871 - val_loss: 2.8836 - val_accuracy20: 0.5635 - 319s/epoch - 32ms/step
Epoch 26/50
9854/9854 - 330s - loss: 2.5477 - accuracy20: 0.5874 - val_loss: 2.8817 - val_accuracy20: 0.5642 - 330s/epoch - 34ms/step
Epoch 27/50
9854/9854 - 342s - loss: 2.5461 - accuracy20: 0.5876 - val_loss: 2.8789 - val_accuracy20: 0.5622 - 342s/epoch - 35ms/step
Epoch 28/50
9854/9854 - 335s - loss: 2.5446 - accuracy20: 0.5880 - val_loss: 2.8725 - val_accuracy20: 0.5630 - 335s/epoch - 34ms/step
Epoch 29/50
9854/9854 - 331s - loss: 2.5430 - accuracy20: 0.5883 - val_loss: 2.8736 - val_accuracy20: 0.5660 - 331s/epoch - 34ms/step
Epoch 30/50
9854/9854 - 333s - loss: 2.5420 - accuracy20: 0.5886 - val_loss: 2.8714 - val_accuracy20: 0.5637 - 333s/epoch - 34ms/step
Epoch 31/50
9854/9854 - 314s - loss: 2.5404 - accuracy20: 0.5887 - val_loss: 2.8594 - val_accuracy20: 0.5653 - 314s/epoch - 32ms/step
Epoch 32/50
9854/9854 - 317s - loss: 2.5395 - accuracy20: 0.5889 - val_loss: 2.8651 - val_accuracy20: 0.5629 - 317s/epoch - 32ms/step
Epoch 33/50
9854/9854 - 318s - loss: 2.5380 - accuracy20: 0.5892 - val_loss: 2.8774 - val_accuracy20: 0.5632 - 318s/epoch - 32ms/step
Epoch 34/50
9854/9854 - 320s - loss: 2.5367 - accuracy20: 0.5895 - val_loss: 2.8459 - val_accuracy20: 0.5629 - 320s/epoch - 32ms/step
Epoch 35/50
9854/9854 - 322s - loss: 2.5352 - accuracy20: 0.5899 - val_loss: 2.8585 - val_accuracy20: 0.5642 - 322s/epoch - 33ms/step
Epoch 36/50
9854/9854 - 327s - loss: 2.5344 - accuracy20: 0.5898 - val_loss: 2.8387 - val_accuracy20: 0.5653 - 327s/epoch - 33ms/step
Epoch 37/50
9854/9854 - 324s - loss: 2.5333 - accuracy20: 0.5901 - val_loss: 2.8488 - val_accuracy20: 0.5625 - 324s/epoch - 33ms/step
Epoch 38/50
9854/9854 - 322s - loss: 2.5323 - accuracy20: 0.5903 - val_loss: 2.8374 - val_accuracy20: 0.5639 - 322s/epoch - 33ms/step
Epoch 39/50
9854/9854 - 322s - loss: 2.5308 - accuracy20: 0.5906 - val_loss: 2.8470 - val_accuracy20: 0.5616 - 322s/epoch - 33ms/step
Epoch 40/50
9854/9854 - 323s - loss: 2.5300 - accuracy20: 0.5907 - val_loss: 2.8386 - val_accuracy20: 0.5639 - 323s/epoch - 33ms/step
Epoch 41/50
9854/9854 - 321s - loss: 2.5287 - accuracy20: 0.5910 - val_loss: 2.8674 - val_accuracy20: 0.5609 - 321s/epoch - 33ms/step
Epoch 42/50
9854/9854 - 320s - loss: 2.5278 - accuracy20: 0.5913 - val_loss: 2.8544 - val_accuracy20: 0.5632 - 320s/epoch - 33ms/step
Epoch 43/50
9854/9854 - 327s - loss: 2.5269 - accuracy20: 0.5915 - val_loss: 2.8417 - val_accuracy20: 0.5618 - 327s/epoch - 33ms/step
Epoch 44/50
9854/9854 - 324s - loss: 2.5259 - accuracy20: 0.5916 - val_loss: 2.8333 - val_accuracy20: 0.5630 - 324s/epoch - 33ms/step
Epoch 45/50
9854/9854 - 318s - loss: 2.5254 - accuracy20: 0.5917 - val_loss: 2.8371 - val_accuracy20: 0.5651 - 318s/epoch - 32ms/step
Epoch 46/50
9854/9854 - 317s - loss: 2.5238 - accuracy20: 0.5922 - val_loss: 2.8399 - val_accuracy20: 0.5637 - 317s/epoch - 32ms/step
Epoch 47/50
9854/9854 - 315s - loss: 2.5230 - accuracy20: 0.5922 - val_loss: 2.8418 - val_accuracy20: 0.5645 - 315s/epoch - 32ms/step
Epoch 48/50
9854/9854 - 317s - loss: 2.5223 - accuracy20: 0.5924 - val_loss: 2.8407 - val_accuracy20: 0.5643 - 317s/epoch - 32ms/step
Epoch 49/50
9854/9854 - 315s - loss: 2.5213 - accuracy20: 0.5925 - val_loss: 2.8373 - val_accuracy20: 0.5638 - 315s/epoch - 32ms/step
Epoch 50/50
9854/9854 - 318s - loss: 2.5203 - accuracy20: 0.5926 - val_loss: 2.8397 - val_accuracy20: 0.5634 - 318s/epoch - 32ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 378s - 378s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9350672
{'0': {'precision': 0.4358689470063154, 'recall': 0.573702574685253, 'f1-score': 0.4953767647960026, 'support': 1465383}, '1': {'precision': 0.7365864184065689, 'recall': 0.5956218351689778, 'f1-score': 0.6586462035711833, 'support': 3140768}, '2': {'precision': 0.4471672056049582, 'recall': 0.48917556022600106, 'f1-score': 0.4672290453856963, 'support': 1465480}, 'accuracy': 0.5646392213229032, 'macro avg': {'precision': 0.5398741903392809, 'recall': 0.5528333233600773, 'f1-score': 0.5404173379176274, 'support': 6071631}, 'weighted avg': {'precision': 0.5941528056969985, 'recall': 0.5646392213229032, 'f1-score': 0.5730398356976486, 'support': 6071631}}
[[ 840694  324120  300569]
 [ 684352 1870710  585706]
 [ 403731  344872  716877]]
Evaluating performance on  train set...
9854/9854 - 153s - 153s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94597703
{'0': {'precision': 0.447570592891607, 'recall': 0.5972667025106363, 'f1-score': 0.5116950042526718, 'support': 684448}, '1': {'precision': 0.7420029643381798, 'recall': 0.5874839660253077, 'f1-score': 0.6557640159316915, 'support': 1153800}, '2': {'precision': 0.47979059790943174, 'recall': 0.48775540349034985, 'f1-score': 0.48374021769636943, 'support': 683771}, 'accuracy': 0.5631004365946489, 'macro avg': {'precision': 0.5564547183797395, 'recall': 0.5575020240087647, 'f1-score': 0.5503997459602442, 'support': 2522019}, 'weighted avg': {'precision': 0.5910061400568339, 'recall': 0.5631004365946489, 'f1-score': 0.5700261085452499, 'support': 2522019}}
[[408798 115649 160001]
 [274353 677839 201608]
 [230220 120038 333513]]
Evaluating performance on  val set...
3566/3566 - 58s - 58s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93618745
{'0': {'precision': 0.45493859031526246, 'recall': 0.5817294996038764, 'f1-score': 0.5105803893611379, 'support': 249922}, '1': {'precision': 0.7428285432623037, 'recall': 0.5914337120983421, 'f1-score': 0.6585419635894264, 'support': 414065}, '2': {'precision': 0.4698405941421958, 'recall': 0.49771908280152194, 'f1-score': 0.48337820426342265, 'support': 248365}, 'accuracy': 0.5632639595243941, 'macro avg': {'precision': 0.555869242573254, 'recall': 0.5569607648345801, 'f1-score': 0.550833519071329, 'support': 912352}, 'weighted avg': {'precision': 0.5896522639275229, 'recall': 0.5632639595243941, 'f1-score': 0.5703266698877792, 'support': 912352}}
[[145387  41859  62676]
 [ 92363 244892  76810]
 [ 81825  42924 123616]]
testing model out of sample: results/universal/W4/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 183s - 183s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9209706
{'0': {'precision': 0.45670751671232424, 'recall': 0.5663003051228521, 'f1-score': 0.5056336824524486, 'support': 778375}, '1': {'precision': 0.7101160154568309, 'recall': 0.6402024966181296, 'f1-score': 0.6733493496810539, 'support': 1491778}, '2': {'precision': 0.470706603157797, 'recall': 0.4460366466226039, 'f1-score': 0.4580396853010112, 'support': 761489}, 'accuracy': 0.5724574339582312, 'macro avg': {'precision': 0.5458433784423175, 'recall': 0.5508464827878617, 'f1-score': 0.5456742391448378, 'support': 3031642}, 'weighted avg': {'precision': 0.5849183588164907, 'recall': 0.5724574339582312, 'f1-score': 0.5762067373613406, 'support': 3031642}}
[[440794 185880 151701]
 [306512 955040 230226]
 [217850 203987 339652]]
Evaluating performance on  train set...
5528/5528 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81399304
{'0': {'precision': 0.4573575848768703, 'recall': 0.5514627672317142, 'f1-score': 0.5000209974817502, 'support': 313071}, '1': {'precision': 0.7749576650796056, 'recall': 0.7389788874763455, 'f1-score': 0.756540757556785, 'support': 788963}, '2': {'precision': 0.48635478952508765, 'recall': 0.44309765387446787, 'f1-score': 0.46371961840448056, 'support': 312430}, 'accuracy': 0.6321200115379395, 'macro avg': {'precision': 0.5728900131605211, 'recall': 0.5778464361941759, 'f1-score': 0.5734271244810053, 'support': 1414464}, 'weighted avg': {'precision': 0.6409142598613401, 'recall': 0.6321200115379395, 'f1-score': 0.6350848517777721, 'support': 1414464}}
[[172647  81647  58777]
 [118508 583027  87428]
 [ 86333  87660 138437]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8379581
{'0': {'precision': 0.4615690783654697, 'recall': 0.556046883324454, 'f1-score': 0.5044222125561839, 'support': 112620}, '1': {'precision': 0.7575385987403155, 'recall': 0.7213222889853479, 'f1-score': 0.7389869873135532, 'support': 263785}, '2': {'precision': 0.48185489873078563, 'recall': 0.43661655217062906, 'f1-score': 0.4581216418297694, 'support': 111212}, 'accuracy': 0.6182167561836441, 'macro avg': {'precision': 0.5669875252788569, 'recall': 0.5713285748268103, 'f1-score': 0.5671769472331688, 'support': 487617}, 'weighted avg': {'precision': 0.6263056371535066, 'recall': 0.6182167561836441, 'f1-score': 0.6207542724264236, 'support': 487617}}
[[ 62622  29247  20751]
 [ 42048 190274  31463]
 [ 31002  31653  48557]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1072727
{'0': {'precision': 0.4545731170224692, 'recall': 0.5383608671737192, 'f1-score': 0.4929318189712063, 'support': 52723}, '1': {'precision': 0.40850252077939775, 'recall': 0.09424116685527474, 'f1-score': 0.15315062195090803, 'support': 31812}, '2': {'precision': 0.4453001166372581, 'recall': 0.571365528885819, 'f1-score': 0.5005168371248728, 'support': 52119}, 'accuracy': 0.44756099345793027, 'macro avg': {'precision': 0.4361252514797083, 'recall': 0.4013225209716043, 'f1-score': 0.3821997593489957, 'support': 136654}, 'weighted avg': {'precision': 0.4403115709662878, 'recall': 0.44756099345793027, 'f1-score': 0.41672624958824794, 'support': 136654}}
[[28384  2246 22093]
 [13812  2998 15002]
 [20245  2095 29779]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2896136
{'0': {'precision': 0.3559720380860552, 'recall': 0.571166118739122, 'f1-score': 0.4385951885951886, 'support': 20684}, '1': {'precision': 0.5526197939991043, 'recall': 0.05376437783199721, 'f1-score': 0.09799483819733969, 'support': 22952}, '2': {'precision': 0.3854988988649839, 'recall': 0.5341784037558686, 'f1-score': 0.4478205254354029, 'support': 21300}, 'accuracy': 0.3761549833682395, 'macro avg': {'precision': 0.4313635769833812, 'recall': 0.3863696334423293, 'f1-score': 0.3281368507426437, 'support': 64936}, 'weighted avg': {'precision': 0.43516357172390613, 'recall': 0.3761549833682395, 'f1-score': 0.3212341012532694, 'support': 64936}}
[[11814   469  8401]
 [11982  1234  9736]
 [ 9392   530 11378]]
Evaluating performance on  val set...
81/81 - 1s - 741ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2552924
{'0': {'precision': 0.38191699604743085, 'recall': 0.5535663133772558, 'f1-score': 0.4519939188399018, 'support': 6982}, '1': {'precision': 0.4870848708487085, 'recall': 0.058858501783590964, 'f1-score': 0.10502585863943774, 'support': 6728}, '2': {'precision': 0.39611730689797603, 'recall': 0.5553786014188504, 'f1-score': 0.46241938400337534, 'support': 6907}, 'accuracy': 0.3927341514284328, 'macro avg': {'precision': 0.42170639126470516, 'recall': 0.3892678055265657, 'f1-score': 0.33981305382757165, 'support': 20617}, 'weighted avg': {'precision': 0.4209940202850848, 'recall': 0.3927341514284328, 'f1-score': 0.34225960147342704, 'support': 20617}}
[[3865  219 2898]
 [3382  396 2950]
 [2873  198 3836]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.48091617
{'0': {'precision': 0.5450620615218564, 'recall': 0.4571613320400905, 'f1-score': 0.4972569981713321, 'support': 46395}, '1': {'precision': 0.8708984386340807, 'recall': 0.9391650099403579, 'f1-score': 0.9037443868843273, 'support': 319405}, '2': {'precision': 0.5940191225333966, 'recall': 0.3723777338519416, 'f1-score': 0.4577819003697268, 'support': 47049}, 'accuracy': 0.8204064924463909, 'macro avg': {'precision': 0.6699932075631113, 'recall': 0.5895680252774633, 'f1-score': 0.6195944284751288, 'support': 412849}, 'weighted avg': {'precision': 0.8027280575520319, 'recall': 0.8204064924463909, 'f1-score': 0.8072416184935478, 'support': 412849}}
[[ 21210  19984   5201]
 [ 12658 299974   6773]
 [  5045  24484  17520]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5362434
{'0': {'precision': 0.5774035850081477, 'recall': 0.44561926498672505, 'f1-score': 0.5030232924969766, 'support': 21469}, '1': {'precision': 0.8467442038411508, 'recall': 0.9299399989915796, 'f1-score': 0.8863942199865431, 'support': 118998}, '2': {'precision': 0.5747303543913713, 'recall': 0.3949997697868226, 'f1-score': 0.46820935436336847, 'support': 21719}, 'accuracy': 0.7941930869495517, 'macro avg': {'precision': 0.6662927144135565, 'recall': 0.5901863445883758, 'f1-score': 0.6192089556156294, 'support': 162186}, 'weighted avg': {'precision': 0.7746643539038842, 'recall': 0.7941930869495517, 'f1-score': 0.7796455022258041, 'support': 162186}}
[[  9567   9537   2365]
 [  4354 110661   3983]
 [  2648  10492   8579]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.47265926
{'0': {'precision': 0.5783582089552238, 'recall': 0.42715414293588094, 'f1-score': 0.4913875092465392, 'support': 5443}, '1': {'precision': 0.8740019517388219, 'recall': 0.9482866493406488, 'f1-score': 0.9096302109782559, 'support': 41556}, '2': {'precision': 0.5657095527332965, 'recall': 0.3575292270109928, 'f1-score': 0.43814818774724684, 'support': 5731}, 'accuracy': 0.830286364498388, 'macro avg': {'precision': 0.6726899044757807, 'recall': 0.5776566730958409, 'f1-score': 0.6130553026573473, 'support': 52730}, 'weighted avg': {'precision': 0.8099774375975022, 'recall': 0.830286364498388, 'f1-score': 0.8152141574856968, 'support': 52730}}
[[ 2325  2596   522]
 [ 1098 39407  1051]
 [  597  3085  2049]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2032598
{'0': {'precision': 0.3750608194328416, 'recall': 0.5566303799882829, 'f1-score': 0.44815330781128304, 'support': 73397}, '1': {'precision': 0.5945326846260152, 'recall': 0.29052072637119675, 'f1-score': 0.39031331949640197, 'support': 108099}, '2': {'precision': 0.38693445300766305, 'recall': 0.4938228421921565, 'f1-score': 0.43389267932878484, 'support': 71473}, 'accuracy': 0.4251706730864256, 'macro avg': {'precision': 0.45217598568883993, 'recall': 0.4469913161838787, 'f1-score': 0.42411976887882324, 'support': 252969}, 'weighted avg': {'precision': 0.4722005217995746, 'recall': 0.4251706730864256, 'f1-score': 0.4194079089822569, 'support': 252969}}
[[40855 10880 21662]
 [42434 31405 34260]
 [25640 10538 35295]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1427581
{'0': {'precision': 0.4290933512424446, 'recall': 0.5562985407306795, 'f1-score': 0.48448542570293307, 'support': 28713}, '1': {'precision': 0.5677275620623806, 'recall': 0.30982735262444855, 'f1-score': 0.40088095826684944, 'support': 28787}, '2': {'precision': 0.44094980212455737, 'recall': 0.5102610013084499, 'f1-score': 0.4730801768583696, 'support': 29042}, 'accuracy': 0.45886390423147144, 'macro avg': {'precision': 0.47925690514312747, 'recall': 0.458795631554526, 'f1-score': 0.4528155202760507, 'support': 86542}, 'weighted avg': {'precision': 0.4791869251532835, 'recall': 0.45886390423147144, 'f1-score': 0.45284815084186736, 'support': 86542}}
[[15973  3224  9516]
 [10596  8919  9272]
 [10656  3567 14819]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1601018
{'0': {'precision': 0.4316981132075472, 'recall': 0.5744544873550625, 'f1-score': 0.49294891883422126, 'support': 10953}, '1': {'precision': 0.4868115636210171, 'recall': 0.2474259974259974, 'f1-score': 0.32809500106662876, 'support': 9324}, '2': {'precision': 0.457194303486659, 'recall': 0.49631274988893825, 'f1-score': 0.4759510927448558, 'support': 11255}, 'accuracy': 0.4498604592160345, 'macro avg': {'precision': 0.45856799343840776, 'recall': 0.43939774488999933, 'f1-score': 0.4323316708819019, 'support': 31532}, 'weighted avg': {'precision': 0.4570957230403075, 'recall': 0.4498604592160345, 'f1-score': 0.4381344934282578, 'support': 31532}}
[[6292 1147 3514]
 [3899 2307 3118]
 [4384 1285 5586]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4992176
{'0': {'precision': 0.30383729207970056, 'recall': 0.5576582651943016, 'f1-score': 0.3933563574921835, 'support': 71178}, '1': {'precision': 0.4028223220012829, 'recall': 0.012290109201925711, 'f1-score': 0.023852479252521035, 'support': 102196}, '2': {'precision': 0.27988964123687304, 'recall': 0.45500631711939354, 'f1-score': 0.3465839032341495, 'support': 63320}, 'accuracy': 0.29472652454223597, 'macro avg': {'precision': 0.3288497517726188, 'recall': 0.3416515638385403, 'f1-score': 0.25459757999295135, 'support': 236694}, 'weighted avg': {'precision': 0.3401690489746712, 'recall': 0.29472652454223597, 'f1-score': 0.22130531207405182, 'support': 236694}}
[[39693   942 30543]
 [57357  1256 43583]
 [33589   920 28811]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3642598
{'0': {'precision': 0.3424646005596583, 'recall': 0.545640441151822, 'f1-score': 0.4208117890382627, 'support': 29831}, '1': {'precision': 0.2791304347826087, 'recall': 0.010972108285479901, 'f1-score': 0.02111425376570414, 'support': 29256}, '2': {'precision': 0.34591762552956806, 'recall': 0.4680324254655225, 'f1-score': 0.39781474327557875, 'support': 29483}, 'accuracy': 0.3431974709269504, 'macro avg': {'precision': 0.3225042202906117, 'recall': 0.3415483249676081, 'f1-score': 0.27991359535984855, 'support': 88570}, 'weighted avg': {'precision': 0.3226938111412828, 'recall': 0.3431974709269504, 'f1-score': 0.2811304862025939, 'support': 88570}}
[[16277   432 13122]
 [15965   321 12970]
 [15287   397 13799]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3817412
{'0': {'precision': 0.33646295664049164, 'recall': 0.545479704797048, 'f1-score': 0.4162032800732034, 'support': 10840}, '1': {'precision': 0.31533477321814257, 'recall': 0.013218650973291082, 'f1-score': 0.025373653110879392, 'support': 11045}, '2': {'precision': 0.33764226499929745, 'recall': 0.462738301559792, 'f1-score': 0.3904142973192526, 'support': 10386}, 'accuracy': 0.3366799913234793, 'macro avg': {'precision': 0.32981333161931053, 'recall': 0.3404788857767104, 'f1-score': 0.2773304101677785, 'support': 32271}, 'weighted avg': {'precision': 0.32961121702023544, 'recall': 0.3366799913234793, 'f1-score': 0.27413896211957933, 'support': 32271}}
[[5913  163 4764]
 [6235  146 4664]
 [5426  154 4806]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2257322
{'0': {'precision': 0.38631774328431273, 'recall': 0.6045372210119775, 'f1-score': 0.4713978601673164, 'support': 125319}, '1': {'precision': 0.596942157596493, 'recall': 0.173285826018945, 'f1-score': 0.2685999913404502, 'support': 161098}, '2': {'precision': 0.38548762505940704, 'recall': 0.5246977060491964, 'f1-score': 0.4444467860906217, 'support': 120578}, 'accuracy': 0.410184400299758, 'macro avg': {'precision': 0.4562491753134043, 'recall': 0.4341735843600396, 'f1-score': 0.3948148791994628, 'support': 406995}, 'weighted avg': {'precision': 0.46944180599157187, 'recall': 0.410184400299758, 'f1-score': 0.3831411550916025, 'support': 406995}}
[[75760  9380 40179]
 [72506 27916 60676]
 [47842  9469 63267]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2068653
{'0': {'precision': 0.4118055450744827, 'recall': 0.5936684073107049, 'f1-score': 0.4862899560672625, 'support': 45960}, '1': {'precision': 0.5363585344343783, 'recall': 0.14684900234870601, 'f1-score': 0.23057039462347062, 'support': 45557}, '2': {'precision': 0.4234208249206807, 'recall': 0.5407349627318426, 'f1-score': 0.47494076562217513, 'support': 46152}, 'accuracy': 0.42806296261322446, 'macro avg': {'precision': 0.4571949681431806, 'recall': 0.4270841241304179, 'f1-score': 0.3972670387709694, 'support': 137669}, 'weighted avg': {'precision': 0.4569161286606967, 'recall': 0.42806296261322446, 'f1-score': 0.39786333934079177, 'support': 137669}}
[[27285  2828 15847]
 [20731  6690 18136]
 [18241  2955 24956]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2680817
{'0': {'precision': 0.3918512955313556, 'recall': 0.6060870070279375, 'f1-score': 0.4759732706912673, 'support': 17217}, '1': {'precision': 0.5120845921450151, 'recall': 0.08915421838838629, 'f1-score': 0.15186811217632828, 'support': 19012}, '2': {'precision': 0.4056980298913043, 'recall': 0.553495916121184, 'f1-score': 0.468210216832047, 'support': 17263}, 'accuracy': 0.40538772152845287, 'macro avg': {'precision': 0.436544639189225, 'recall': 0.4162457138458359, 'f1-score': 0.36535053323321415, 'support': 53492}, 'weighted avg': {'precision': 0.4390529632662447, 'recall': 0.40538772152845287, 'f1-score': 0.35827528085245514, 'support': 53492}}
[[10435   823  5959]
 [ 9279  1695  8038]
 [ 6916   792  9555]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
3782/3782 - 35s - 35s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59453887
{'0': {'precision': 0.5411815249288217, 'recall': 0.481001598570994, 'f1-score': 0.5093200476967147, 'support': 154513}, '1': {'precision': 0.809551560239719, 'recall': 0.9037725053754511, 'f1-score': 0.854071283433186, 'support': 650178}, '2': {'precision': 0.6154088440503575, 'recall': 0.39493204133259013, 'f1-score': 0.4811141953199618, 'support': 163261}, 'accuracy': 0.7504617997586657, 'macro avg': {'precision': 0.6553806430729661, 'recall': 0.5932353817596784, 'f1-score': 0.6148351754832875, 'support': 967952}, 'weighted avg': {'precision': 0.7339666208483193, 'recall': 0.7504617997586657, 'f1-score': 0.7361337257342477, 'support': 967952}}
[[ 74321  64631  15561]
 [ 37832 587613  24733]
 [ 25178  73606  64477]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6283932
{'0': {'precision': 0.579805523142746, 'recall': 0.4771397477754305, 'f1-score': 0.5234864447253827, 'support': 78105}, '1': {'precision': 0.7724918589930201, 'recall': 0.8987539186187558, 'f1-score': 0.8308533606148537, 'support': 253916}, '2': {'precision': 0.6127569468027727, 'recall': 0.3946173341395325, 'f1-score': 0.4800688629783238, 'support': 77731}, 'accuracy': 0.7227518108514418, 'macro avg': {'precision': 0.6550181096461797, 'recall': 0.5901703335112396, 'f1-score': 0.6114695561061868, 'support': 409752}, 'weighted avg': {'precision': 0.7054607750177235, 'recall': 0.7227518108514418, 'f1-score': 0.7057198097076409, 'support': 409752}}
[[ 37267  32576   8262]
 [ 14585 228208  11123]
 [ 12423  34634  30674]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57910764
{'0': {'precision': 0.5755754681547459, 'recall': 0.4673055979089523, 'f1-score': 0.5158203500673206, 'support': 22955}, '1': {'precision': 0.8012954978052286, 'recall': 0.9116028813858936, 'f1-score': 0.8528973972008022, 'support': 90512}, '2': {'precision': 0.6148188878960753, 'recall': 0.3942091578158741, 'f1-score': 0.48039742212674547, 'support': 22691}, 'accuracy': 0.7504737143612568, 'macro avg': {'precision': 0.6638966179520166, 'recall': 0.59103921237024, 'f1-score': 0.6163717231316227, 'support': 136158}, 'weighted avg': {'precision': 0.732164458600221, 'recall': 0.7504737143612568, 'f1-score': 0.733991416271628, 'support': 136158}}
[[10727 10017  2211]
 [ 4608 82511  3393]
 [ 3302 10444  8945]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
4457/4457 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7205236
{'0': {'precision': 0.5272092035336853, 'recall': 0.5309097893367556, 'f1-score': 0.5290530253599548, 'support': 229086}, '1': {'precision': 0.7636793438583064, 'recall': 0.8190428786410169, 'f1-score': 0.7903928045752294, 'support': 687102}, '2': {'precision': 0.54228703612901, 'recall': 0.4182301097561518, 'f1-score': 0.47224720060684916, 'support': 224771}, 'accuracy': 0.6822295980837173, 'macro avg': {'precision': 0.6110585278403339, 'recall': 0.5893942592446414, 'f1-score': 0.5972310101806778, 'support': 1140959}, 'weighted avg': {'precision': 0.6725853001923834, 'recall': 0.6822295980837173, 'f1-score': 0.6752447666432028, 'support': 1140959}}
[[121624  82923  24539]
 [ 69530 562766  54806]
 [ 39540  91225  94006]]
Evaluating performance on  train set...
2425/2425 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63104683
{'0': {'precision': 0.5051710131169388, 'recall': 0.5282786533156423, 'f1-score': 0.5164664930895788, 'support': 104761}, '1': {'precision': 0.8136364052514969, 'recall': 0.8604600500085929, 'f1-score': 0.8363934106087646, 'support': 413129}, '2': {'precision': 0.5577544426494345, 'recall': 0.4028313903176563, 'f1-score': 0.4677999401559333, 'support': 102847}, 'accuracy': 0.7285758702961157, 'macro avg': {'precision': 0.6255206203392901, 'recall': 0.5971900312139639, 'f1-score': 0.6068866146180922, 'support': 620737}, 'weighted avg': {'precision': 0.7191812090039029, 'recall': 0.7285758702961157, 'f1-score': 0.7213292264826535, 'support': 620737}}
[[ 55343  39416  10002]
 [ 34800 355481  22848]
 [ 19410  42007  41430]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63633054
{'0': {'precision': 0.5299086364419927, 'recall': 0.5216505925276466, 'f1-score': 0.5257471886891951, 'support': 35357}, '1': {'precision': 0.8003144210704416, 'recall': 0.8646736232767157, 'f1-score': 0.8312501372932365, 'support': 131290}, '2': {'precision': 0.5522224031260176, 'recall': 0.3923933477946493, 'f1-score': 0.458786331433982, 'support': 34575}, 'accuracy': 0.7232509367762968, 'macro avg': {'precision': 0.6274818202128173, 'recall': 0.5929058545330038, 'f1-score': 0.6052612191388045, 'support': 201222}, 'weighted avg': {'precision': 0.7101725933998263, 'recall': 0.7232509367762968, 'f1-score': 0.7135711367794914, 'support': 201222}}
[[ 18444  13582   3331]
 [ 10097 113523   7670]
 [  6265  14743  13567]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
4676/4676 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7493068
{'0': {'precision': 0.5372508235171253, 'recall': 0.4948615586872525, 'f1-score': 0.5151857191439998, 'support': 249492}, '1': {'precision': 0.7382556047887152, 'recall': 0.8354953584629518, 'f1-score': 0.7838713310596317, 'support': 695567}, '2': {'precision': 0.557895087723197, 'recall': 0.39860278648831027, 'f1-score': 0.46498490489155603, 'support': 251930}, 'accuracy': 0.6725433567058678, 'macro avg': {'precision': 0.6111338386763459, 'recall': 0.5763199012128383, 'f1-score': 0.5880139850317291, 'support': 1196989}, 'weighted avg': {'precision': 0.6583991399813297, 'recall': 0.6725433567058678, 'f1-score': 0.6607524318612445, 'support': 1196989}}
[[123464  97823  28205]
 [ 63051 581143  51373]
 [ 43292 108218 100420]]
Evaluating performance on  train set...
2108/2108 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71745586
{'0': {'precision': 0.5368389040944404, 'recall': 0.5122491690262219, 'f1-score': 0.524255855288321, 'support': 113722}, '1': {'precision': 0.7544557041815616, 'recall': 0.8498047480914566, 'f1-score': 0.7992966961564957, 'support': 312673}, '2': {'precision': 0.5831120484836164, 'recall': 0.4061001291875343, 'f1-score': 0.4787686273282531, 'support': 113014}, 'accuracy': 0.6856763606094819, 'macro avg': {'precision': 0.6248022189198728, 'recall': 0.5893846821017376, 'f1-score': 0.6007737262576899, 'support': 539409}, 'weighted avg': {'precision': 0.6726772213521035, 'recall': 0.6856763606094819, 'f1-score': 0.6741553772764518, 'support': 539409}}
[[ 58254  42001  13467]
 [ 27617 265711  19345]
 [ 22642  44477  45895]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76728696
{'0': {'precision': 0.515020531661984, 'recall': 0.5118017224715964, 'f1-score': 0.5134060820200148, 'support': 46561}, '1': {'precision': 0.7347409963889687, 'recall': 0.8242057624232648, 'f1-score': 0.7769062794341877, 'support': 111585}, '2': {'precision': 0.571341333089066, 'recall': 0.4063674072143679, 'f1-score': 0.4749359120789868, 'support': 46047}, 'accuracy': 0.6587444231682771, 'macro avg': {'precision': 0.6070342870466728, 'recall': 0.5807916307030764, 'f1-score': 0.5884160911777297, 'support': 204193}, 'weighted avg': {'precision': 0.6477915473181204, 'recall': 0.6587444231682771, 'f1-score': 0.6487252830366312, 'support': 204193}}
[[23830 16332  6399]
 [11976 91969  7640]
 [10464 16871 18712]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
4274/4274 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92844105
{'0': {'precision': 0.4745395007254208, 'recall': 0.5853046835655531, 'f1-score': 0.5241340122034266, 'support': 297850}, '1': {'precision': 0.6579078085632267, 'recall': 0.6547937426911035, 'f1-score': 0.6563470819443753, 'support': 503667}, '2': {'precision': 0.519171816564556, 'recall': 0.4000232440488398, 'f1-score': 0.4518753487258595, 'support': 292548}, 'accuracy': 0.567751459008377, 'macro avg': {'precision': 0.5505397086177345, 'recall': 0.5467072234351654, 'f1-score': 0.5441188142912204, 'support': 1094065}, 'weighted avg': {'precision': 0.5708899554404986, 'recall': 0.567751459008377, 'f1-score': 0.5656783744800548, 'support': 1094065}}
[[174333  80690  42827]
 [108313 329798  65556]
 [ 84727  90795 117026]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8146934
{'0': {'precision': 0.47217581482944015, 'recall': 0.550476746965552, 'f1-score': 0.5083286665549365, 'support': 112953}, '1': {'precision': 0.7392514051941308, 'recall': 0.7564389778055418, 'f1-score': 0.7477464368860371, 'support': 278538}, '2': {'precision': 0.5203682210236453, 'recall': 0.40438062057317686, 'f1-score': 0.4551004871349598, 'support': 113089}, 'accuracy': 0.6314281184351341, 'macro avg': {'precision': 0.5772651470157387, 'recall': 0.5704321151147569, 'f1-score': 0.5703918635253111, 'support': 504580}, 'weighted avg': {'precision': 0.6304078728045812, 'recall': 0.6314281184351341, 'f1-score': 0.6285621782479452, 'support': 504580}}
[[ 62178  35698  15077]
 [ 40767 210697  27074]
 [ 28739  38619  45731]]
Evaluating performance on  val set...
707/707 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8328486
{'0': {'precision': 0.4756739318910418, 'recall': 0.5602336681627128, 'f1-score': 0.5145025515767435, 'support': 42111}, '1': {'precision': 0.7219604522588036, 'recall': 0.743849493487699, 'f1-score': 0.7327415375904881, 'support': 97431}, '2': {'precision': 0.5197907188353048, 'recall': 0.3881151121032709, 'f1-score': 0.4444043120693487, 'support': 41212}, 'accuracy': 0.6199641501709505, 'macro avg': {'precision': 0.5724750343283834, 'recall': 0.5640660912512275, 'f1-score': 0.5638828004121934, 'support': 180754}, 'weighted avg': {'precision': 0.6184872748295016, 'recall': 0.6199641501709505, 'f1-score': 0.6161564790125204, 'support': 180754}}
[[23592 13384  5135]
 [15315 72474  9642]
 [10690 14527 15995]]
testing model on single stock: results/universal/W4/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
12724/12724 - 130s - 130s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1212121
{'0': {'precision': 0.41816115552573563, 'recall': 0.6167640561344769, 'f1-score': 0.49840658531489845, 'support': 943805}, '1': {'precision': 0.5899180896317052, 'recall': 0.29171441843803286, 'f1-score': 0.3903839998363035, 'support': 1373422}, '2': {'precision': 0.4262844971587723, 'recall': 0.5378585411524385, 'f1-score': 0.47561564756890296, 'support': 939920}, 'accuracy': 0.45693240127019136, 'macro avg': {'precision': 0.47812124743873774, 'recall': 0.48211233857498276, 'f1-score': 0.45480207757336827, 'support': 3257147}, 'weighted avg': {'precision': 0.4929290561520853, 'recall': 0.45693240127019136, 'f1-score': 0.44628052112455063, 'support': 3257147}}
[[582105 140645 221055]
 [513443 400647 459332]
 [296511 137865 505544]]
Evaluating performance on  train set...
5165/5165 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1598449
{'0': {'precision': 0.42473924371064997, 'recall': 0.6508913013430133, 'f1-score': 0.5140409601448788, 'support': 441321}, '1': {'precision': 0.5434871771926292, 'recall': 0.1660299300387054, 'f1-score': 0.2543564829841516, 'support': 438957}, '2': {'precision': 0.4586723157769253, 'recall': 0.5312160498297965, 'f1-score': 0.4922860076327152, 'support': 441824}, 'accuracy': 0.4499168747948343, 'macro avg': {'precision': 0.4756329122267348, 'recall': 0.4493790937371718, 'f1-score': 0.4202278169205818, 'support': 1322102}, 'weighted avg': {'precision': 0.4755051318721225, 'recall': 0.4499168747948343, 'f1-score': 0.42055181998793517, 'support': 1322102}}
[[287252  31503 122566]
 [211644  72880 154433]
 [177406  29714 234704]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1276455
{'0': {'precision': 0.4391442923510512, 'recall': 0.623751698421306, 'f1-score': 0.5154163729735173, 'support': 164123}, '1': {'precision': 0.5532516493873704, 'recall': 0.19521607359114496, 'f1-score': 0.2885992578849722, 'support': 159367}, '2': {'precision': 0.4497090817100936, 'recall': 0.5436058956638737, 'f1-score': 0.4922195148964448, 'support': 163510}, 'accuracy': 0.45660780287474334, 'macro avg': {'precision': 0.48070167448283846, 'recall': 0.4541912225587749, 'f1-score': 0.4320783819183114, 'support': 487000}, 'weighted avg': {'precision': 0.4800321688950021, 'recall': 0.45660780287474334, 'f1-score': 0.4334038854078124, 'support': 487000}}
[[102372  12802  48949]
 [ 68440  31111  59816]
 [ 62305  12320  88885]]
training model: results/universal/W4/deepVOL_L2/h30
Epoch 1/50
9854/9854 - 321s - loss: 2.8593 - accuracy30: 0.5148 - val_loss: 3.2253 - val_accuracy30: 0.5117 - 321s/epoch - 33ms/step
Epoch 2/50
9854/9854 - 315s - loss: 2.7863 - accuracy30: 0.5380 - val_loss: 3.2844 - val_accuracy30: 0.5166 - 315s/epoch - 32ms/step
Epoch 3/50
9854/9854 - 313s - loss: 2.7586 - accuracy30: 0.5442 - val_loss: 3.2766 - val_accuracy30: 0.5164 - 313s/epoch - 32ms/step
Epoch 4/50
9854/9854 - 316s - loss: 2.7430 - accuracy30: 0.5465 - val_loss: 3.2854 - val_accuracy30: 0.5202 - 316s/epoch - 32ms/step
Epoch 5/50
9854/9854 - 317s - loss: 2.7312 - accuracy30: 0.5490 - val_loss: 3.3218 - val_accuracy30: 0.5145 - 317s/epoch - 32ms/step
Epoch 6/50
9854/9854 - 315s - loss: 2.7223 - accuracy30: 0.5508 - val_loss: 3.2997 - val_accuracy30: 0.5186 - 315s/epoch - 32ms/step
Epoch 7/50
9854/9854 - 311s - loss: 2.7154 - accuracy30: 0.5524 - val_loss: 3.3507 - val_accuracy30: 0.5170 - 311s/epoch - 32ms/step
Epoch 8/50
9854/9854 - 313s - loss: 2.7100 - accuracy30: 0.5533 - val_loss: 3.2584 - val_accuracy30: 0.5223 - 313s/epoch - 32ms/step
Epoch 9/50
9854/9854 - 316s - loss: 2.7049 - accuracy30: 0.5544 - val_loss: 3.2397 - val_accuracy30: 0.5259 - 316s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 327s - loss: 2.7005 - accuracy30: 0.5551 - val_loss: 3.2589 - val_accuracy30: 0.5257 - 327s/epoch - 33ms/step
Epoch 11/50
9854/9854 - 340s - loss: 2.6962 - accuracy30: 0.5559 - val_loss: 3.2519 - val_accuracy30: 0.5250 - 340s/epoch - 35ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 400s - 400s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701888
{'0': {'precision': 0.40327846660192584, 'recall': 0.5481410209722121, 'f1-score': 0.4646814014350583, 'support': 1565214}, '1': {'precision': 0.6365644036614853, 'recall': 0.617875500784058, 'f1-score': 0.6270807366694701, 'support': 2936645}, '2': {'precision': 0.45492687966573564, 'recall': 0.3169721462734716, 'f1-score': 0.37362179404148727, 'support': 1569772}, 'accuracy': 0.5221023807276826, 'macro avg': {'precision': 0.4982565833097155, 'recall': 0.4943295560099139, 'f1-score': 0.48846131071533855, 'support': 6071631}, 'weighted avg': {'precision': 0.5294643651369773, 'recall': 0.5221023807276824, 'f1-score': 0.5196857937971828, 'support': 6071631}}
[[ 857958  499952  207304]
 [ 733297 1814481  388867]
 [ 536203  535995  497574]]
Evaluating performance on  train set...
9854/9854 - 158s - 158s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0907946
{'0': {'precision': 0.4148357655559253, 'recall': 0.6022231515256908, 'f1-score': 0.4912669225014313, 'support': 724557}, '1': {'precision': 0.6222736827313234, 'recall': 0.5939928627518926, 'f1-score': 0.6078044777165047, 'support': 1073523}, '2': {'precision': 0.4843467621538496, 'recall': 0.2980154405274478, 'f1-score': 0.3689922984434407, 'support': 723939}, 'accuracy': 0.5113978126255194, 'macro avg': {'precision': 0.5071520701470328, 'recall': 0.49807715160167704, 'f1-score': 0.48935456622045886, 'support': 2522019}, 'weighted avg': {'precision': 0.5230867725967088, 'recall': 0.5113978126255194, 'f1-score': 0.505773703307299, 'support': 2522019}}
[[436345 189155  99057]
 [305225 637665 130633]
 [310280 197914 215745]]
Evaluating performance on  val set...
3566/3566 - 56s - 56s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.080498
{'0': {'precision': 0.41932531879313445, 'recall': 0.5889517514163195, 'f1-score': 0.4898700728463863, 'support': 261417}, '1': {'precision': 0.6255436014053786, 'recall': 0.585306355989568, 'f1-score': 0.6047564252120624, 'support': 391489}, '2': {'precision': 0.4672823528754074, 'recall': 0.3221749419917825, 'f1-score': 0.3813928021445275, 'support': 259446}, 'accuracy': 0.5115240608887798, 'macro avg': {'precision': 0.5040504243579735, 'recall': 0.49881101646589004, 'f1-score': 0.492006433400992, 'support': 912352}, 'weighted avg': {'precision': 0.5214508689164358, 'recall': 0.5115240608887798, 'f1-score': 0.5083199137266295, 'support': 912352}}
[[153962  68026  39429]
 [106485 229141  55863]
 [106719  69140  83587]]
testing model out of sample: results/universal/W4/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 189s - 189s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0514224
{'0': {'precision': 0.44404774733387403, 'recall': 0.5412599853208726, 'f1-score': 0.48785829896235383, 'support': 867899}, '1': {'precision': 0.5897417505968925, 'recall': 0.67511411775797, 'f1-score': 0.6295467991576106, 'support': 1315308}, '2': {'precision': 0.48636931787831844, 'recall': 0.26829751247885814, 'f1-score': 0.34582592710754595, 'support': 848435}, 'accuracy': 0.5229426825462901, 'macro avg': {'precision': 0.506719605269695, 'recall': 0.49489053851923365, 'f1-score': 0.48774367507583677, 'support': 3031642}, 'weighted avg': {'precision': 0.5191026481924682, 'recall': 0.5229426825462901, 'f1-score': 0.5095820982764512, 'support': 3031642}}
[[469759 299178  98962]
 [285895 887983 141430]
 [302248 318554 227633]]
Evaluating performance on  train set...
5528/5528 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9519878
{'0': {'precision': 0.43186084401288083, 'recall': 0.5476406157574234, 'f1-score': 0.48290798584862876, 'support': 349943}, '1': {'precision': 0.6799376002171343, 'recall': 0.7223743333473313, 'f1-score': 0.7005138570362985, 'support': 714390}, '2': {'precision': 0.4852309116499627, 'recall': 0.2934216050563932, 'f1-score': 0.3657015931099907, 'support': 350131}, 'accuracy': 0.5729633274512466, 'macro avg': {'precision': 0.5323431186266593, 'recall': 0.5211455180537159, 'f1-score': 0.5163744786649727, 'support': 1414464}, 'weighted avg': {'precision': 0.5703656550342966, 'recall': 0.5729633274512466, 'f1-score': 0.5637993106344045, 'support': 1414464}}
[[191643 118325  39975]
 [129318 516057  69015]
 [122800 124595 102736]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9775183
{'0': {'precision': 0.4359695942527573, 'recall': 0.5487070097660758, 'f1-score': 0.48588454612410886, 'support': 125639}, '1': {'precision': 0.6585683123536593, 'recall': 0.6931210244744934, 'f1-score': 0.6754030396010138, 'support': 237390}, '2': {'precision': 0.473745668223595, 'recall': 0.30284618101261757, 'f1-score': 0.3694915586196091, 'support': 124588}, 'accuracy': 0.5561947183957902, 'macro avg': {'precision': 0.5227611916100038, 'recall': 0.5148914050843956, 'f1-score': 0.5102597147815772, 'support': 487617}, 'weighted avg': {'precision': 0.5539908182745855, 'recall': 0.5561947183957902, 'f1-score': 0.5484103104827589, 'support': 487617}}
[[ 68939  41862  14838]
 [ 45775 164540  27075]
 [ 43414  43443  37731]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2330023
{'0': {'precision': 0.42214809709024664, 'recall': 0.6587469268592502, 'f1-score': 0.5145527650253549, 'support': 52064}, '1': {'precision': 0.36410792903535155, 'recall': 0.2517328672171659, 'f1-score': 0.29766762289970244, 'support': 33182}, '2': {'precision': 0.4414980442883982, 'recall': 0.2788476501711796, 'f1-score': 0.34181003135543714, 'support': 51408}, 'accuracy': 0.4170020636058952, 'macro avg': {'precision': 0.40925135680466546, 'recall': 0.3964424814158652, 'f1-score': 0.3846768064268315, 'support': 136654}, 'weighted avg': {'precision': 0.41533419650310716, 'recall': 0.4170020636058952, 'f1-score': 0.39690497397264857, 'support': 136654}}
[[34297  7369 10398]
 [17093  8353  7736]
 [29854  7219 14335]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3751726
{'0': {'precision': 0.35193424657534245, 'recall': 0.7525072640359921, 'f1-score': 0.47957827456953844, 'support': 21338}, '1': {'precision': 0.5038222646918299, 'recall': 0.09735493698933666, 'f1-score': 0.16317845951487486, 'support': 21663}, '2': {'precision': 0.3933884297520661, 'recall': 0.2712559835878733, 'f1-score': 0.3211009174311927, 'support': 21935}, 'accuracy': 0.37138105211284955, 'macro avg': {'precision': 0.4163816470064128, 'recall': 0.37370606153773406, 'f1-score': 0.32128588383853535, 'support': 64936}, 'weighted avg': {'precision': 0.41660788899925066, 'recall': 0.37138105211284955, 'f1-score': 0.32049286705508123, 'support': 64936}}
[[16057  1015  4266]
 [14645  2109  4909]
 [14923  1062  5950]]
Evaluating performance on  val set...
81/81 - 1s - 776ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3432566
{'0': {'precision': 0.3681383015359185, 'recall': 0.7464041335009077, 'f1-score': 0.4930811808118082, 'support': 7161}, '1': {'precision': 0.4534282018111255, 'recall': 0.11104070964676065, 'f1-score': 0.17839419773508078, 'support': 6313}, '2': {'precision': 0.39235500878734625, 'recall': 0.250034999300014, 'f1-score': 0.30542967079948696, 'support': 7143}, 'accuracy': 0.37988068099141487, 'macro avg': {'precision': 0.40464050404479673, 'recall': 0.3691599474825608, 'f1-score': 0.325635016448792, 'support': 20617}, 'weighted avg': {'precision': 0.4026445381529981, 'recall': 0.37988068099141487, 'f1-score': 0.33170883468087786, 'support': 20617}}
[[5345  406 1410]
 [4256  701 1356]
 [4918  439 1786]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5889452
{'0': {'precision': 0.5652238805970149, 'recall': 0.4079793155456602, 'f1-score': 0.473898262665026, 'support': 55694}, '1': {'precision': 0.814323531760974, 'recall': 0.9500554126327491, 'f1-score': 0.8769686143013599, 'support': 300473}, '2': {'precision': 0.6432806771375549, 'recall': 0.25073215482869343, 'f1-score': 0.3608251348778166, 'support': 56682}, 'accuracy': 0.7809150561101033, 'macro avg': {'precision': 0.674276029831848, 'recall': 0.5362556276690342, 'f1-score': 0.5705640039480675, 'support': 412849}, 'weighted avg': {'precision': 0.757236298758859, 'recall': 0.7809150561101033, 'f1-score': 0.7517299801646191, 'support': 412849}}
[[ 22722  29050   3922]
 [ 11048 285466   3959]
 [  6430  36040  14212]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6757391
{'0': {'precision': 0.5605808140918829, 'recall': 0.3673660400904766, 'f1-score': 0.44385807849974085, 'support': 25642}, '1': {'precision': 0.7790661637426016, 'recall': 0.9317199732412447, 'f1-score': 0.8485824026083627, 'support': 110618}, '2': {'precision': 0.5658186263274505, 'recall': 0.28565918383090333, 'f1-score': 0.37964885300525436, 'support': 25926}, 'accuracy': 0.7392191681156204, 'macro avg': {'precision': 0.6351552013873117, 'recall': 0.5282483990542082, 'f1-score': 0.5573631113711194, 'support': 162186}, 'weighted avg': {'precision': 0.7104347344529653, 'recall': 0.7392191681156204, 'f1-score': 0.7096338353719583, 'support': 162186}}
[[  9420  13973   2249]
 [  4119 103065   3434]
 [  3265  15255   7406]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5944827
{'0': {'precision': 0.5406337572752749, 'recall': 0.38098131550964603, 'f1-score': 0.44697914810194267, 'support': 6583}, '1': {'precision': 0.8253979004402303, 'recall': 0.9318465655664585, 'f1-score': 0.8753980605770382, 'support': 39235}, '2': {'precision': 0.5345100105374078, 'recall': 0.2935474537037037, 'f1-score': 0.3789689951438177, 'support': 6912}, 'accuracy': 0.7794045135596435, 'macro avg': {'precision': 0.6335138894176376, 'recall': 0.5354584449266028, 'f1-score': 0.5671154012742662, 'support': 52730}, 'weighted avg': {'precision': 0.7517165150910323, 'recall': 0.7794045135596435, 'f1-score': 0.7568393766950361, 'support': 52730}}
[[ 2508  3574   501]
 [ 1408 36561  1266]
 [  723  4160  2029]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3762748
{'0': {'precision': 0.3811189178403016, 'recall': 0.46798550481668233, 'f1-score': 0.4201088214864552, 'support': 77543}, '1': {'precision': 0.45938877145211565, 'recall': 0.5113561586472313, 'f1-score': 0.48398146662766234, 'support': 100298}, '2': {'precision': 0.4106662618200746, 'recall': 0.25203652433180707, 'f1-score': 0.3123659639051107, 'support': 75128}, 'accuracy': 0.42104763824816477, 'macro avg': {'precision': 0.41705798370416397, 'recall': 0.4104593959319069, 'f1-score': 0.4054854173397427, 'support': 252969}, 'weighted avg': {'precision': 0.42092673079789766, 'recall': 0.42104763824816477, 'f1-score': 0.4134352494598493, 'support': 252969}}
[[36289 30242 11012]
 [32849 51288 16161]
 [26079 30114 18935]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3355688
{'0': {'precision': 0.40432075613232316, 'recall': 0.5554792167639986, 'f1-score': 0.46799704788504115, 'support': 29110}, '1': {'precision': 0.42063672726090207, 'recall': 0.4619807850280367, 'f1-score': 0.4403404255319148, 'support': 27999}, '2': {'precision': 0.4454994303076339, 'recall': 0.23911935582509428, 'f1-score': 0.3112024938648272, 'support': 29433}, 'accuracy': 0.41763536779829447, 'macro avg': {'precision': 0.4234856379002863, 'recall': 0.41885978587237654, 'f1-score': 0.40651332242726107, 'support': 86542}, 'weighted avg': {'precision': 0.42360437325038147, 'recall': 0.41763536779829447, 'f1-score': 0.405723332489717, 'support': 86542}}
[[16170  8595  4345]
 [10649 12935  4415]
 [13174  9221  7038]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.38832
{'0': {'precision': 0.39670314822321306, 'recall': 0.5442075996292863, 'f1-score': 0.458893404188809, 'support': 10790}, '1': {'precision': 0.3564447722662733, 'recall': 0.40724744548614766, 'f1-score': 0.38015634986970837, 'support': 9493}, '2': {'precision': 0.4598912304554725, 'recall': 0.2405547159747533, 'f1-score': 0.3158816319383646, 'support': 11249}, 'accuracy': 0.394646708106051, 'macro avg': {'precision': 0.40434638364831965, 'recall': 0.39733658703006247, 'f1-score': 0.38497712866562733, 'support': 31532}, 'weighted avg': {'precision': 0.4071252582724157, 'recall': 0.39464670810605096, 'f1-score': 0.38416962254804815, 'support': 31532}}
[[5872 3305 1613]
 [4062 3866 1565]
 [4868 3675 2706]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5916706
{'0': {'precision': 0.3033263776816093, 'recall': 0.8252509998042341, 'f1-score': 0.4436034275405893, 'support': 71514}, '1': {'precision': 0.36741573033707864, 'recall': 0.00977597959102324, 'f1-score': 0.019045215399250616, 'support': 100348}, '2': {'precision': 0.28219879365401185, 'recall': 0.1717516041461007, 'f1-score': 0.21353916962316616, 'support': 64832}, 'accuracy': 0.300527263048493, 'macro avg': {'precision': 0.31764696722423325, 'recall': 0.3355928611804527, 'f1-score': 0.22539593752100204, 'support': 236694}, 'weighted avg': {'precision': 0.32471050584959765, 'recall': 0.300527263048493, 'f1-score': 0.2005930705342375, 'support': 236694}}
[[59017   780 11717]
 [82761   981 16606]
 [52788   909 11135]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.447676
{'0': {'precision': 0.3387497927375228, 'recall': 0.8162205353575709, 'f1-score': 0.478790719475041, 'support': 30036}, '1': {'precision': 0.2828802351212344, 'recall': 0.01312828207051763, 'f1-score': 0.025092058526411835, 'support': 29326}, '2': {'precision': 0.33611916155557053, 'recall': 0.17074089290605313, 'f1-score': 0.2264502213645136, 'support': 29208}, 'accuracy': 0.33745060404200067, 'macro avg': {'precision': 0.3192497298047759, 'recall': 0.33336323677804724, 'f1-score': 0.2434443331219888, 'support': 88570}, 'weighted avg': {'precision': 0.3193835725476421, 'recall': 0.33745060404200067, 'f1-score': 0.24535357145887543, 'support': 88570}}
[[24516   471  5049]
 [24140   385  4801]
 [23716   505  4987]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.454138
{'0': {'precision': 0.3396977233594796, 'recall': 0.8125572030020135, 'f1-score': 0.47910202099241783, 'support': 10926}, '1': {'precision': 0.2781954887218045, 'recall': 0.01716778025241277, 'f1-score': 0.03233983043440258, 'support': 10776}, '2': {'precision': 0.34417839517455673, 'recall': 0.1781625508562778, 'f1-score': 0.23478802992518702, 'support': 10569}, 'accuracy': 0.33918998481608875, 'macro avg': {'precision': 0.32069053575194695, 'recall': 0.3359625113702347, 'f1-score': 0.24874329378400248, 'support': 32271}, 'weighted avg': {'precision': 0.32062822256799384, 'recall': 0.33918998481608875, 'f1-score': 0.24990354753195068, 'support': 32271}}
[[8878  251 1797]
 [8800  185 1791]
 [8457  229 1883]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3735228
{'0': {'precision': 0.3807783370101318, 'recall': 0.5808901108210306, 'f1-score': 0.46001378309314567, 'support': 129849}, '1': {'precision': 0.4475750830773089, 'recall': 0.37799429437579013, 'f1-score': 0.40985247837055166, 'support': 151079}, '2': {'precision': 0.42222741471333347, 'recall': 0.27233931163587616, 'f1-score': 0.3311103717312579, 'support': 126067}, 'accuracy': 0.41000012285163207, 'macro avg': {'precision': 0.4168602782669247, 'recall': 0.41040790561089896, 'f1-score': 0.40032554439831847, 'support': 406995}, 'weighted avg': {'precision': 0.41841257447715857, 'recall': 0.41000012285163207, 'f1-score': 0.40146567779370984, 'support': 406995}}
[[75428 34822 19599]
 [66590 57107 27382]
 [56071 35663 34333]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4019989
{'0': {'precision': 0.3807546043324205, 'recall': 0.6347173240442242, 'f1-score': 0.4759787776029075, 'support': 46219}, '1': {'precision': 0.3989050676450355, 'recall': 0.3077960853698994, 'f1-score': 0.34747762256095277, 'support': 45215}, '2': {'precision': 0.4428382684386415, 'recall': 0.24647993943981833, 'f1-score': 0.31669190901638206, 'support': 46235}, 'accuracy': 0.3969593735699395, 'macro avg': {'precision': 0.40749931347203255, 'recall': 0.3963311162846473, 'f1-score': 0.3800494363934141, 'support': 137669}, 'weighted avg': {'precision': 0.4075660971785297, 'recall': 0.3969593735699395, 'f1-score': 0.3802796144338572, 'support': 137669}}
[[29336 10310  6573]
 [23533 13917  7765]
 [24178 10661 11396]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4400585
{'0': {'precision': 0.3678056973063756, 'recall': 0.6524205098825552, 'f1-score': 0.4704132845901233, 'support': 17455}, '1': {'precision': 0.3862506610259122, 'recall': 0.1976190476190476, 'f1-score': 0.26146411311974227, 'support': 18480}, '2': {'precision': 0.4133078393881453, 'recall': 0.3077974597026827, 'f1-score': 0.35283363802559414, 'support': 17557}, 'accuracy': 0.3821879907275854, 'macro avg': {'precision': 0.38912139924014433, 'recall': 0.38594567240142846, 'f1-score': 0.36157034524515325, 'support': 53492}, 'weighted avg': {'precision': 0.3891125102516135, 'recall': 0.3821879907275854, 'f1-score': 0.35963547588029604, 'support': 53492}}
[[11388  2891  3176]
 [10333  3652  4495]
 [ 9241  2912  5404]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
3782/3782 - 34s - 34s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72065324
{'0': {'precision': 0.5293249964102498, 'recall': 0.4468048768394202, 'f1-score': 0.4845768914780791, 'support': 181511}, '1': {'precision': 0.73429211667532, 'recall': 0.911998491412331, 'f1-score': 0.8135541797711632, 'support': 593933}, '2': {'precision': 0.6587514759884256, 'recall': 0.26371891038294515, 'f1-score': 0.3766521376240379, 'support': 192508}, 'accuracy': 0.6958340909466585, 'macro avg': {'precision': 0.6407895296913318, 'recall': 0.5408407595448989, 'f1-score': 0.5582610696244267, 'support': 967952}, 'weighted avg': {'precision': 0.6808328907800423, 'recall': 0.6958340909466585, 'f1-score': 0.6649722925442916, 'support': 967952}}
[[ 81100  90619   9792]
 [ 35760 541666  16507]
 [ 36354 105386  50768]]
Evaluating performance on  train set...
1601/1601 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7871158
{'0': {'precision': 0.5618498285581449, 'recall': 0.4228464583287773, 'f1-score': 0.48253702848729113, 'support': 91454}, '1': {'precision': 0.675646068157221, 'recall': 0.901289669439676, 'f1-score': 0.7723242068895284, 'support': 227190}, '2': {'precision': 0.6441098784997359, 'recall': 0.2676603591342143, 'f1-score': 0.3781713293220023, 'support': 91108}, 'accuracy': 0.6536173099826237, 'macro avg': {'precision': 0.6272019250717006, 'recall': 0.530598828967556, 'f1-score': 0.5443441882329406, 'support': 409752}, 'weighted avg': {'precision': 0.6432354381575918, 'recall': 0.6536173099826237, 'f1-score': 0.6200060315468323, 'support': 409752}}
[[ 38671  47792   4991]
 [ 13943 204764   8483]
 [ 16214  50508  24386]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7306016
{'0': {'precision': 0.5466660388020342, 'recall': 0.4274300441826215, 'f1-score': 0.47975039259442925, 'support': 27160}, '1': {'precision': 0.7177895123696784, 'recall': 0.9037309434513662, 'f1-score': 0.8000991796121215, 'support': 82124}, '2': {'precision': 0.6505553627212773, 'recall': 0.27896851975887477, 'f1-score': 0.390489087973332, 'support': 26874}, 'accuracy': 0.6854095976732913, 'macro avg': {'precision': 0.6383369712976633, 'recall': 0.5367098357976208, 'f1-score': 0.5567795533932943, 'support': 136158}, 'weighted avg': {'precision': 0.670384555776982, 'recall': 0.6854095976732913, 'f1-score': 0.6553516461722843, 'support': 136158}}
[[11609 14273  1278]
 [ 5157 74218  2749]
 [ 4470 14907  7497]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
4457/4457 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8609495
{'0': {'precision': 0.49804611480437794, 'recall': 0.4780299011513662, 'f1-score': 0.4878327735481485, 'support': 267682}, '1': {'precision': 0.671944217668866, 'recall': 0.8209338373796568, 'f1-score': 0.7390044260487763, 'support': 611584}, '2': {'precision': 0.5244473674595345, 'recall': 0.27424501228538783, 'f1-score': 0.36015637153797125, 'support': 261693}, 'accuracy': 0.6150948456517719, 'macro avg': {'precision': 0.5648125666442595, 'recall': 0.5244029169388036, 'f1-score': 0.5289978570449653, 'support': 1140959}, 'weighted avg': {'precision': 0.5973155191855702, 'recall': 0.6150948456517719, 'f1-score': 0.593183222820817, 'support': 1140959}}
[[127960 117406  22316]
 [ 66753 502070  42761]
 [ 62211 127714  71768]]
Evaluating performance on  train set...
2425/2425 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7739461
{'0': {'precision': 0.4616945973078135, 'recall': 0.5138520759764144, 'f1-score': 0.48637904016426975, 'support': 122617}, '1': {'precision': 0.7480808041792602, 'recall': 0.8230532027633246, 'f1-score': 0.7837782125328333, 'support': 376503}, '2': {'precision': 0.5159070139364862, 'recall': 0.29708017793565045, 'f1-score': 0.3770434492222762, 'support': 121617}, 'accuracy': 0.6589247942365285, 'macro avg': {'precision': 0.5752274718078533, 'recall': 0.5446618188917965, 'f1-score': 0.5490669006397931, 'support': 620737}, 'weighted avg': {'precision': 0.6460213210553097, 'recall': 0.6589247942365285, 'f1-score': 0.6453426818203798, 'support': 620737}}
[[ 63007  50077   9533]
 [ 42252 309882  24369]
 [ 31210  54277  36130]]
Evaluating performance on  val set...
787/787 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7716655
{'0': {'precision': 0.4904400241109102, 'recall': 0.49247046290916136, 'f1-score': 0.49145314632938303, 'support': 41304}, '1': {'precision': 0.7307339720842205, 'recall': 0.8285302352093078, 'f1-score': 0.7765652375452738, 'support': 119298}, '2': {'precision': 0.5117019973042519, 'recall': 0.3084194977843427, 'f1-score': 0.3848670568176581, 'support': 40620}, 'accuracy': 0.6545556648875371, 'macro avg': {'precision': 0.5776253311664609, 'recall': 0.5431400653009373, 'f1-score': 0.550961813564105, 'support': 201222}, 'weighted avg': {'precision': 0.6371945974499761, 'recall': 0.6545556648875371, 'f1-score': 0.6389706906431613, 'support': 201222}}
[[20341 17765  3198]
 [11699 98842  8757]
 [ 9435 18657 12528]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8952322
{'0': {'precision': 0.5130901197821037, 'recall': 0.46018308586624845, 'f1-score': 0.4851985922935621, 'support': 293305}, '1': {'precision': 0.6358252788701938, 'recall': 0.8443468989796605, 'f1-score': 0.7253981807532442, 'support': 608719}, '2': {'precision': 0.5657405416596988, 'recall': 0.24085569474344415, 'f1-score': 0.337868750326959, 'support': 294965}, 'accuracy': 0.601499261897979, 'macro avg': {'precision': 0.5715519801039988, 'recall': 0.5151285598631177, 'f1-score': 0.5161551744579218, 'support': 1196989}, 'weighted avg': {'precision': 0.588480332218532, 'recall': 0.601499261897979, 'f1-score': 0.571044749987501, 'support': 1196989}}
[[134974 137857  20474]
 [ 60690 513970  34059]
 [ 67397 156524  71044]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8659883
{'0': {'precision': 0.5135052508944286, 'recall': 0.4692823486770569, 'f1-score': 0.4903988416272455, 'support': 132432}, '1': {'precision': 0.6511995592893541, 'recall': 0.8589272219961634, 'f1-score': 0.7407762518447496, 'support': 275248}, '2': {'precision': 0.5975023494542037, 'recall': 0.2509773853897016, 'f1-score': 0.3534782771395427, 'support': 131729}, 'accuracy': 0.6147969351642261, 'macro avg': {'precision': 0.5874023865459955, 'recall': 0.526395652020974, 'f1-score': 0.528217790203846, 'support': 539409}, 'weighted avg': {'precision': 0.6042804081373873, 'recall': 0.6147969351642261, 'f1-score': 0.5847233196543955, 'support': 539409}}
[[ 62148  60798   9486]
 [ 26045 236418  12785]
 [ 32834  65834  33061]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9057205
{'0': {'precision': 0.49934004600822113, 'recall': 0.49399343381584837, 'f1-score': 0.49665235085613546, 'support': 53608}, '1': {'precision': 0.6329465146796098, 'recall': 0.8240264284538119, 'f1-score': 0.715956543121563, 'support': 97168}, '2': {'precision': 0.5900961187492396, 'recall': 0.27238519572420766, 'f1-score': 0.37272331377923507, 'support': 53417}, 'accuracy': 0.5930712610128652, 'macro avg': {'precision': 0.5741275598123569, 'recall': 0.5301350193312893, 'f1-score': 0.5284440692523112, 'support': 204193}, 'weighted avg': {'precision': 0.5866603287087471, 'recall': 0.5930712610128652, 'f1-score': 0.5685913124293053, 'support': 204193}}
[[26482 22249  4877]
 [11869 80069  5230]
 [14683 24184 14550]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0324152
{'0': {'precision': 0.4594992291146299, 'recall': 0.5754942613738074, 'f1-score': 0.510996778030677, 'support': 340761}, '1': {'precision': 0.5423329260117445, 'recall': 0.6427039471329906, 'f1-score': 0.5882677916729445, 'support': 419165}, '2': {'precision': 0.516007786938115, 'recall': 0.26336644330652814, 'f1-score': 0.348739104503637, 'support': 334139}, 'accuracy': 0.5059169244971734, 'macro avg': {'precision': 0.5059466473548299, 'recall': 0.49385488393777544, 'f1-score': 0.48266789140241945, 'support': 1094065}, 'weighted avg': {'precision': 0.5084933012789533, 'recall': 0.5059169244971734, 'f1-score': 0.491046123964154, 'support': 1094065}}
[[196106 109339  35316]
 [102541 269399  47225]
 [128135 118003  88001]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9286688
{'0': {'precision': 0.46191048653428957, 'recall': 0.5116830834462226, 'f1-score': 0.48552453367320636, 'support': 130659}, '1': {'precision': 0.6439923481448615, 'recall': 0.7286778321879758, 'f1-score': 0.6837227979674733, 'support': 243010}, '2': {'precision': 0.4954639709694142, 'recall': 0.3212335097890934, 'f1-score': 0.3897639802212367, 'support': 130911}, 'accuracy': 0.5667783106742241, 'macro avg': {'precision': 0.5337889352161884, 'recall': 0.5205314751410972, 'f1-score': 0.5196704372873054, 'support': 504580}, 'weighted avg': {'precision': 0.5583079525275347, 'recall': 0.5667783106742241, 'f1-score': 0.5561338530937124, 'support': 504580}}
[[ 66856  48298  15505]
 [ 38616 177076  27318]
 [ 39266  49592  42053]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9565861
{'0': {'precision': 0.4599370095553302, 'recall': 0.528275664738703, 'f1-score': 0.49174339852370447, 'support': 48929}, '1': {'precision': 0.6209570154095702, 'recall': 0.6851896045629191, 'f1-score': 0.6514939216364781, 'support': 83806}, '2': {'precision': 0.48298004987531173, 'recall': 0.32266394552156435, 'f1-score': 0.3868712468320453, 'support': 48019}, 'accuracy': 0.546405612047313, 'macro avg': {'precision': 0.5212913582800707, 'recall': 0.5120430716077288, 'f1-score': 0.5100361889974093, 'support': 180754}, 'weighted avg': {'precision': 0.5407150081818924, 'recall': 0.546405612047313, 'f1-score': 0.5379509319000465, 'support': 180754}}
[[25848 17453  5628]
 [15425 57423 10958]
 [14926 17599 15494]]
testing model on single stock: results/universal/W4/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
12724/12724 - 111s - 111s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2613839
{'0': {'precision': 0.37939890392185804, 'recall': 0.5817491875953862, 'f1-score': 0.45927366673059866, 'support': 963190}, '1': {'precision': 0.4965920882619177, 'recall': 0.35430012031455804, 'f1-score': 0.4135485901623269, 'support': 1333172}, '2': {'precision': 0.4227248165427536, 'recall': 0.36477567822145435, 'f1-score': 0.3916181200663068, 'support': 960785}, 'accuracy': 0.4246504686463337, 'macro avg': {'precision': 0.4329052695755098, 'recall': 0.4336083287104662, 'f1-score': 0.4214801256530774, 'support': 3257147}, 'weighted avg': {'precision': 0.4401470245656218, 'recall': 0.4246504686463337, 'f1-score': 0.4206012254252085, 'support': 3257147}}
[[560335 241575 161280]
 [543504 472343 317325]
 [373063 237251 350471]]
Evaluating performance on  train set...
5165/5165 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3028394
{'0': {'precision': 0.3902827909215974, 'recall': 0.677691559193066, 'f1-score': 0.4953140552064411, 'support': 444993}, '1': {'precision': 0.41416284199665565, 'recall': 0.21600126176819184, 'f1-score': 0.2839250789256658, 'support': 431141}, '2': {'precision': 0.45037666959375144, 'recall': 0.32776342697233884, 'f1-score': 0.37940982942754464, 'support': 445968}, 'accuracy': 0.4090962724509909, 'macro avg': {'precision': 0.4182741008373348, 'recall': 0.40715208264453223, 'f1-score': 0.3862163211865505, 'support': 1322102}, 'weighted avg': {'precision': 0.418340849970154, 'recall': 0.4090962724509909, 'f1-score': 0.3872830331031294, 'support': 1322102}}
[[301568  66034  77391]
 [237022  93127 100992]
 [234101  65695 146172]]
Evaluating performance on  val set...
1903/1903 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2787347
{'0': {'precision': 0.3989188982694732, 'recall': 0.6400943974500429, 'f1-score': 0.49151585041538204, 'support': 163140}, '1': {'precision': 0.41665202108963095, 'recall': 0.2338796196959047, 'f1-score': 0.29959008948528193, 'support': 162186}, '2': {'precision': 0.4309039421715478, 'recall': 0.3576518178556849, 'f1-score': 0.3908755374090799, 'support': 161674}, 'accuracy': 0.411047227926078, 'macro avg': {'precision': 0.41549162051021726, 'recall': 0.41054194500054414, 'f1-score': 0.39399382576991454, 'support': 487000}, 'weighted avg': {'precision': 0.41544295216174043, 'recall': 0.411047227926078, 'f1-score': 0.3941881431726919, 'support': 487000}}
[[104425  27522  31193]
 [ 79080  37932  45174]
 [ 78265  25586  57823]]
training model: results/universal/W4/deepVOL_L3/h10
Epoch 1/50
9854/9854 - 526s - loss: 2.6773 - accuracy10: 0.5507 - val_loss: 2.8122 - val_accuracy10: 0.5695 - 526s/epoch - 53ms/step
Epoch 2/50
9854/9854 - 518s - loss: 2.5485 - accuracy10: 0.5895 - val_loss: 2.6559 - val_accuracy10: 0.5819 - 518s/epoch - 53ms/step
Epoch 3/50
9854/9854 - 524s - loss: 2.5064 - accuracy10: 0.5981 - val_loss: 2.6210 - val_accuracy10: 0.5832 - 524s/epoch - 53ms/step
Epoch 4/50
9854/9854 - 534s - loss: 2.4844 - accuracy10: 0.6021 - val_loss: 2.6088 - val_accuracy10: 0.5896 - 534s/epoch - 54ms/step
Epoch 5/50
9854/9854 - 534s - loss: 2.4701 - accuracy10: 0.6045 - val_loss: 2.5732 - val_accuracy10: 0.5908 - 534s/epoch - 54ms/step
Epoch 6/50
9854/9854 - 532s - loss: 2.4603 - accuracy10: 0.6063 - val_loss: 2.5650 - val_accuracy10: 0.5950 - 532s/epoch - 54ms/step
Epoch 7/50
9854/9854 - 528s - loss: 2.4519 - accuracy10: 0.6076 - val_loss: 2.5588 - val_accuracy10: 0.5953 - 528s/epoch - 54ms/step
Epoch 8/50
9854/9854 - 522s - loss: 2.4456 - accuracy10: 0.6088 - val_loss: 2.5567 - val_accuracy10: 0.5952 - 522s/epoch - 53ms/step
Epoch 9/50
9854/9854 - 521s - loss: 2.4398 - accuracy10: 0.6099 - val_loss: 2.5538 - val_accuracy10: 0.5966 - 521s/epoch - 53ms/step
Epoch 10/50
9854/9854 - 543s - loss: 2.4355 - accuracy10: 0.6105 - val_loss: 2.5564 - val_accuracy10: 0.5970 - 543s/epoch - 55ms/step
Epoch 11/50
9854/9854 - 536s - loss: 2.4313 - accuracy10: 0.6112 - val_loss: 2.5508 - val_accuracy10: 0.5957 - 536s/epoch - 54ms/step
Epoch 12/50
9854/9854 - 519s - loss: 2.4274 - accuracy10: 0.6120 - val_loss: 2.5550 - val_accuracy10: 0.5926 - 519s/epoch - 53ms/step
Epoch 13/50
9854/9854 - 510s - loss: 2.4239 - accuracy10: 0.6126 - val_loss: 2.5389 - val_accuracy10: 0.5995 - 510s/epoch - 52ms/step
Epoch 14/50
9854/9854 - 508s - loss: 2.4211 - accuracy10: 0.6129 - val_loss: 2.5480 - val_accuracy10: 0.5949 - 508s/epoch - 52ms/step
Epoch 15/50
9854/9854 - 525s - loss: 2.4184 - accuracy10: 0.6132 - val_loss: 2.5373 - val_accuracy10: 0.5996 - 525s/epoch - 53ms/step
Epoch 16/50
9854/9854 - 513s - loss: 2.4154 - accuracy10: 0.6138 - val_loss: 2.5426 - val_accuracy10: 0.5982 - 513s/epoch - 52ms/step
Epoch 17/50
9854/9854 - 515s - loss: 2.4130 - accuracy10: 0.6143 - val_loss: 2.5417 - val_accuracy10: 0.5971 - 515s/epoch - 52ms/step
Epoch 18/50
9854/9854 - 513s - loss: 2.4106 - accuracy10: 0.6149 - val_loss: 2.5218 - val_accuracy10: 0.6000 - 513s/epoch - 52ms/step
Epoch 19/50
9854/9854 - 503s - loss: 2.4080 - accuracy10: 0.6153 - val_loss: 2.5206 - val_accuracy10: 0.6013 - 503s/epoch - 51ms/step
Epoch 20/50
9854/9854 - 510s - loss: 2.4061 - accuracy10: 0.6156 - val_loss: 2.5247 - val_accuracy10: 0.6033 - 510s/epoch - 52ms/step
Epoch 21/50
9854/9854 - 517s - loss: 2.4042 - accuracy10: 0.6159 - val_loss: 2.5307 - val_accuracy10: 0.6026 - 517s/epoch - 52ms/step
Epoch 22/50
9854/9854 - 506s - loss: 2.4021 - accuracy10: 0.6161 - val_loss: 2.5252 - val_accuracy10: 0.6000 - 506s/epoch - 51ms/step
Epoch 23/50
9854/9854 - 500s - loss: 2.4003 - accuracy10: 0.6165 - val_loss: 2.5187 - val_accuracy10: 0.6024 - 500s/epoch - 51ms/step
Epoch 24/50
9854/9854 - 510s - loss: 2.3984 - accuracy10: 0.6171 - val_loss: 2.5152 - val_accuracy10: 0.6036 - 510s/epoch - 52ms/step
Epoch 25/50
9854/9854 - 504s - loss: 2.3966 - accuracy10: 0.6173 - val_loss: 2.5238 - val_accuracy10: 0.6021 - 504s/epoch - 51ms/step
Epoch 26/50
9854/9854 - 512s - loss: 2.3952 - accuracy10: 0.6177 - val_loss: 2.5205 - val_accuracy10: 0.6032 - 512s/epoch - 52ms/step
Epoch 27/50
9854/9854 - 519s - loss: 2.3935 - accuracy10: 0.6179 - val_loss: 2.5076 - val_accuracy10: 0.6056 - 519s/epoch - 53ms/step
Epoch 28/50
9854/9854 - 515s - loss: 2.3919 - accuracy10: 0.6184 - val_loss: 2.5075 - val_accuracy10: 0.6082 - 515s/epoch - 52ms/step
Epoch 29/50
9854/9854 - 507s - loss: 2.3907 - accuracy10: 0.6183 - val_loss: 2.5173 - val_accuracy10: 0.6057 - 507s/epoch - 51ms/step
Epoch 30/50
9854/9854 - 515s - loss: 2.3894 - accuracy10: 0.6186 - val_loss: 2.5172 - val_accuracy10: 0.6067 - 515s/epoch - 52ms/step
Epoch 31/50
9854/9854 - 506s - loss: 2.3876 - accuracy10: 0.6189 - val_loss: 2.5236 - val_accuracy10: 0.6030 - 506s/epoch - 51ms/step
Epoch 32/50
9854/9854 - 512s - loss: 2.3866 - accuracy10: 0.6193 - val_loss: 2.5192 - val_accuracy10: 0.6050 - 512s/epoch - 52ms/step
Epoch 33/50
9854/9854 - 505s - loss: 2.3852 - accuracy10: 0.6196 - val_loss: 2.5174 - val_accuracy10: 0.6090 - 505s/epoch - 51ms/step
Epoch 34/50
9854/9854 - 519s - loss: 2.3840 - accuracy10: 0.6195 - val_loss: 2.5132 - val_accuracy10: 0.6058 - 519s/epoch - 53ms/step
Epoch 35/50
9854/9854 - 503s - loss: 2.3826 - accuracy10: 0.6197 - val_loss: 2.5130 - val_accuracy10: 0.6058 - 503s/epoch - 51ms/step
Epoch 36/50
9854/9854 - 503s - loss: 2.3816 - accuracy10: 0.6202 - val_loss: 2.5239 - val_accuracy10: 0.6064 - 503s/epoch - 51ms/step
Epoch 37/50
9854/9854 - 511s - loss: 2.3807 - accuracy10: 0.6204 - val_loss: 2.5177 - val_accuracy10: 0.6065 - 511s/epoch - 52ms/step
Epoch 38/50
9854/9854 - 502s - loss: 2.3791 - accuracy10: 0.6205 - val_loss: 2.5207 - val_accuracy10: 0.6074 - 502s/epoch - 51ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 640s - 640s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83841616
{'0': {'precision': 0.4404498532813346, 'recall': 0.6346417173191953, 'f1-score': 0.5200075210771372, 'support': 1322573}, '1': {'precision': 0.8314055635050738, 'recall': 0.5789689868709029, 'f1-score': 0.6825960333062512, 'support': 3418133}, '2': {'precision': 0.45134503218724886, 'recall': 0.6055502751845521, 'f1-score': 0.517198073523136, 'support': 1330925}, 'accuracy': 0.596922803773813, 'macro avg': {'precision': 0.5744001496578858, 'recall': 0.6063869931248834, 'f1-score': 0.5732672093021748, 'support': 6071631}, 'weighted avg': {'precision': 0.6629336110458551, 'recall': 0.596922803773813, 'f1-score': 0.6109237831301884, 'support': 6071631}}
[[ 839360  209381  273832]
 [ 733269 1978993  705871]
 [ 333059  191924  805942]]
Evaluating performance on  train set...
9854/9854 - 270s - 270s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84095716
{'0': {'precision': 0.4691627570052332, 'recall': 0.6604219808704547, 'f1-score': 0.5486005377776957, 'support': 629602}, '1': {'precision': 0.844840200967734, 'recall': 0.5775803572277906, 'f1-score': 0.6861024361098516, 'support': 1261492}, '2': {'precision': 0.48799471374297515, 'recall': 0.5981360700558703, 'f1-score': 0.5374808349789318, 'support': 630925}, 'accuracy': 0.6034034636535253, 'macro avg': {'precision': 0.6006658905719808, 'recall': 0.6120461360513718, 'f1-score': 0.5907279362888264, 'support': 2522019}, 'weighted avg': {'precision': 0.66178447890499, 'recall': 0.6034034636535253, 'f1-score': 0.6145960145138019, 'support': 2522019}}
[[415803  71278 142521]
 [279453 728613 253426]
 [191010  62536 377379]]
Evaluating performance on  val set...
3566/3566 - 94s - 94s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82896227
{'0': {'precision': 0.4794044968403712, 'recall': 0.6427326609667929, 'f1-score': 0.5491822916474695, 'support': 231818}, '1': {'precision': 0.8420274263009403, 'recall': 0.5931050824421474, 'f1-score': 0.6959785846286214, 'support': 447344}, '2': {'precision': 0.49021319081048814, 'recall': 0.602191346112612, 'f1-score': 0.5404630451056198, 'support': 233190}, 'accuracy': 0.6080372487811722, 'macro avg': {'precision': 0.6038817046505999, 'recall': 0.6126763631738508, 'f1-score': 0.5952079737939036, 'support': 912352}, 'weighted avg': {'precision': 0.6599682168777037, 'recall': 0.6080372487811722, 'f1-score': 0.6189308095290178, 'support': 912352}}
[[148997  26305  56516]
 [ 92506 265322  89516]
 [ 69293  23472 140425]]
testing model out of sample: results/universal/W4/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 324s - 324s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85101825
{'0': {'precision': 0.4390370286746444, 'recall': 0.6066215351978661, 'f1-score': 0.5094001532526902, 'support': 641090}, '1': {'precision': 0.8269086847249372, 'recall': 0.5882196696022616, 'f1-score': 0.6874343967920797, 'support': 1761937}, '2': {'precision': 0.42162954962061283, 'recall': 0.5986191866245635, 'f1-score': 0.4947725570916444, 'support': 628615}, 'accuracy': 0.594267397007958, 'macro avg': {'precision': 0.5625250876733981, 'recall': 0.5978201304748971, 'f1-score': 0.5638690357121381, 'support': 3031642}, 'weighted avg': {'precision': 0.6608517480909655, 'recall': 0.594267397007958, 'f1-score': 0.6098374722363584, 'support': 3031642}}
[[ 388899  114151  138040]
 [ 347380 1036406  378151]
 [ 149521  102793  376301]]
Evaluating performance on  train set...
5528/5528 - 153s - 153s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73390335
{'0': {'precision': 0.4445245208011252, 'recall': 0.5932947546426299, 'f1-score': 0.5082466143029917, 'support': 257828}, '1': {'precision': 0.8646422931443364, 'recall': 0.7075574759859846, 'f1-score': 0.778252395885232, 'support': 900724}, '2': {'precision': 0.4427570934754429, 'recall': 0.5765849198161869, 'f1-score': 0.5008859831357694, 'support': 255912}, 'accuracy': 0.6630334883036967, 'macro avg': {'precision': 0.5839746358069681, 'recall': 0.6258123834816005, 'f1-score': 0.5957949977746644, 'support': 1414464}, 'weighted avg': {'precision': 0.7117337636763743, 'recall': 0.6630334883036967, 'f1-score': 0.678853299073064, 'support': 1414464}}
[[152968  53543  51317]
 [129018 637314 134392]
 [ 62130  46227 147555]]
Evaluating performance on  val set...
1908/1908 - 51s - 51s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75290054
{'0': {'precision': 0.45203698951080795, 'recall': 0.5898391504898942, 'f1-score': 0.5118249735191834, 'support': 92571}, '1': {'precision': 0.8550557728229066, 'recall': 0.690417512798775, 'f1-score': 0.7639672396396723, 'support': 304326}, '2': {'precision': 0.43790515041660816, 'recall': 0.5845348324514991, 'f1-score': 0.5007057979293447, 'support': 90720}, 'accuracy': 0.6516241230309854, 'macro avg': {'precision': 0.5816659709167742, 'recall': 0.6215971652467228, 'f1-score': 0.5921660036960668, 'support': 487617}, 'weighted avg': {'precision': 0.7009353130057066, 'recall': 0.6516241230309854, 'f1-score': 0.6671204526962297, 'support': 487617}}
[[ 54602  19244  18725]
 [ 44871 210112  49343]
 [ 21318  16373  53029]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2060578
{'0': {'precision': 0.4209764499833543, 'recall': 0.6325221287053349, 'f1-score': 0.5055097855181284, 'support': 45981}, '1': {'precision': 0.6339869281045751, 'recall': 0.029956763434218655, 'f1-score': 0.057210262459451496, 'support': 45332}, '2': {'precision': 0.4049216660298051, 'recall': 0.5842835402836285, 'f1-score': 0.4783417294115523, 'support': 45341}, 'accuracy': 0.41662885828442636, 'macro avg': {'precision': 0.4866283480392449, 'recall': 0.415587477474394, 'f1-score': 0.34702059246304406, 'support': 136654}, 'weighted avg': {'precision': 0.486311171505983, 'recall': 0.41662885828442636, 'f1-score': 0.34778194139191027, 'support': 136654}}
[[29084   526 16371]
 [21412  1358 22562]
 [18591   258 26492]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3990234
{'0': {'precision': 0.32484252403580505, 'recall': 0.6819790035380778, 'f1-score': 0.4400696146864533, 'support': 17241}, '1': {'precision': 0.7606837606837606, 'recall': 0.02371199254004729, 'f1-score': 0.045990375609598545, 'support': 30027}, '2': {'precision': 0.34264853977844917, 'recall': 0.5392234548335975, 'f1-score': 0.4190270935960591, 'support': 17668}, 'accuracy': 0.338748922015523, 'macro avg': {'precision': 0.4760582748326716, 'recall': 0.4149714836372409, 'f1-score': 0.30169569463070367, 'support': 64936}, 'weighted avg': {'precision': 0.5312242152235777, 'recall': 0.338748922015523, 'f1-score': 0.2521184539376267, 'support': 64936}}
[[11758   138  5345]
 [16383   712 12932]
 [ 8055    86  9527]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3565564
{'0': {'precision': 0.3428269112071246, 'recall': 0.6679264731145851, 'f1-score': 0.45309404498310213, 'support': 5821}, '1': {'precision': 0.6979472140762464, 'recall': 0.02657139667299319, 'f1-score': 0.05119380511938051, 'support': 8957}, '2': {'precision': 0.35478455512031337, 'recall': 0.5429011817091968, 'f1-score': 0.42913225937457694, 'support': 5839}, 'accuracy': 0.35388271814522, 'macro avg': {'precision': 0.4651862268012281, 'recall': 0.41246635049892505, 'f1-score': 0.31114003649235317, 'support': 20617}, 'weighted avg': {'precision': 0.5004945270390998, 'recall': 0.35388271814522, 'f1-score': 0.2717032842212293, 'support': 20617}}
[[3888   68 1865]
 [4819  238 3900]
 [2634   35 3170]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40132254
{'0': {'precision': 0.46781743709771795, 'recall': 0.4734691460381381, 'f1-score': 0.4706263244643277, 'support': 33772}, '1': {'precision': 0.925021806162903, 'recall': 0.9189977973568282, 'f1-score': 0.921999962200127, 'support': 345040}, '2': {'precision': 0.468725610435946, 'recall': 0.4940505920028205, 'f1-score': 0.4810550255317323, 'support': 34037}, 'accuracy': 0.8475180998379552, 'macro avg': {'precision': 0.6205216178988556, 'recall': 0.628839178465929, 'f1-score': 0.624560437398729, 'support': 412849}, 'weighted avg': {'precision': 0.8500024660021471, 'recall': 0.8475180998379552, 'f1-score': 0.8487232113711423, 'support': 412849}}
[[ 15990  12652   5130]
 [ 14019 317091  13930]
 [  4171  13050  16816]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47657898
{'0': {'precision': 0.49848569132826503, 'recall': 0.5041885471367842, 'f1-score': 0.5013209013209013, 'support': 15996}, '1': {'precision': 0.9139937530719348, 'recall': 0.8863442422565097, 'f1-score': 0.8999566776858859, 'support': 130077}, '2': {'precision': 0.44082557261515226, 'recall': 0.5434742133680879, 'f1-score': 0.48679748735338263, 'support': 16113}, 'accuracy': 0.8145894220216295, 'macro avg': {'precision': 0.6177683390051173, 'recall': 0.6446690009204605, 'f1-score': 0.62935835545339, 'support': 162186}, 'weighted avg': {'precision': 0.8260044947675689, 'recall': 0.8145894220216295, 'f1-score': 0.8195933176390143, 'support': 162186}}
[[  8065   5613   2318]
 [  5994 115293   8790]
 [  2120   5236   8757]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40251672
{'0': {'precision': 0.5088967971530249, 'recall': 0.46509882411808856, 'f1-score': 0.48601307189542486, 'support': 3997}, '1': {'precision': 0.9276709738417901, 'recall': 0.9243831314490804, 'f1-score': 0.926024134289117, 'support': 44580}, '2': {'precision': 0.44425349087003224, 'recall': 0.4979532867806405, 'f1-score': 0.4695731153496821, 'support': 4153}, 'accuracy': 0.8559833112080409, 'macro avg': {'precision': 0.6269404206216157, 'recall': 0.6291450807826031, 'f1-score': 0.627203440511408, 'support': 52730}, 'weighted avg': {'precision': 0.8578535418105611, 'recall': 0.8559833112080409, 'f1-score': 0.8567207908784767, 'support': 52730}}
[[ 1859  1585   553]
 [ 1337 41209  2034]
 [  457  1628  2068]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1741251
{'0': {'precision': 0.41534079849194233, 'recall': 0.5816749644891459, 'f1-score': 0.48463294801142814, 'support': 69697}, '1': {'precision': 0.7476759001462885, 'recall': 0.13769488815114803, 'f1-score': 0.23256052900034493, 'support': 115066}, '2': {'precision': 0.3578248328600496, 'recall': 0.7038823563909333, 'f1-score': 0.47445583693638044, 'support': 68206}, 'accuracy': 0.41267507085848465, 'macro avg': {'precision': 0.5069471771660935, 'recall': 0.4744174030104091, 'f1-score': 0.39721643798271783, 'support': 252969}, 'weighted avg': {'precision': 0.5509998589106898, 'recall': 0.41267507085848465, 'f1-score': 0.3672307959536108, 'support': 252969}}
[[40541  2943 26213]
 [39275 15844 59947]
 [17793  2404 48009]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.060813
{'0': {'precision': 0.46502539015765826, 'recall': 0.623231783360057, 'f1-score': 0.5326288863850909, 'support': 28065}, '1': {'precision': 0.7270198214906688, 'recall': 0.20824064543975562, 'f1-score': 0.32374954834047387, 'support': 30119}, '2': {'precision': 0.4423105553074289, 'recall': 0.6286056844629382, 'f1-score': 0.5192542965336441, 'support': 28358}, 'accuracy': 0.48056435025767835, 'macro avg': {'precision': 0.5447852556519187, 'recall': 0.486692704420917, 'f1-score': 0.45854424375306957, 'support': 86542}, 'weighted avg': {'precision': 0.5487634940914261, 'recall': 0.48056435025767835, 'f1-score': 0.45555054983667337, 'support': 86542}}
[[17491  1251  9323]
 [10694  6272 13153]
 [ 9428  1104 17826]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0563252
{'0': {'precision': 0.46896261485586027, 'recall': 0.6232870327211709, 'f1-score': 0.5352225424271534, 'support': 10727}, '1': {'precision': 0.703551912568306, 'recall': 0.15621840242669363, 'f1-score': 0.25566771471123617, 'support': 9890}, '2': {'precision': 0.46349227402347637, 'recall': 0.6403114979386166, 'f1-score': 0.5377394783411558, 'support': 10915}, 'accuracy': 0.48268425726246356, 'macro avg': {'precision': 0.5453356004825475, 'recall': 0.47327231102882705, 'f1-score': 0.4428765784931818, 'support': 31532}, 'weighted avg': {'precision': 0.5406478674307245, 'recall': 0.48268425726246356, 'f1-score': 0.44841152851718624, 'support': 31532}}
[[6686  348 3693]
 [3948 1545 4397]
 [3623  303 6989]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
925/925 - 16s - 16s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4616435
{'0': {'precision': 0.29191145046867434, 'recall': 0.7307988587731812, 'f1-score': 0.41718276023534684, 'support': 70100}, '1': {'precision': 0.6711899791231732, 'recall': 0.012284355119118125, 'f1-score': 0.024127127070786666, 'support': 104686}, '2': {'precision': 0.3088237774741494, 'recall': 0.29572914647541515, 'f1-score': 0.30213464696223313, 'support': 61908}, 'accuracy': 0.2992175551556017, 'macro avg': {'precision': 0.423975069021999, 'recall': 0.3462707867892381, 'f1-score': 0.24781484475612223, 'support': 236694}, 'weighted avg': {'precision': 0.46408379277975886, 'recall': 0.2992175551556017, 'f1-score': 0.21324932461814883, 'support': 236694}}
[[51229   350 18521]
 [80946  1286 22454]
 [43320   280 18308]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3370007
{'0': {'precision': 0.3450188291680931, 'recall': 0.677535379340482, 'f1-score': 0.4572128525899125, 'support': 29749}, '1': {'precision': 0.5273224043715847, 'recall': 0.006666896956716985, 'f1-score': 0.013167320484393657, 'support': 28949}, '2': {'precision': 0.38006983615363954, 'recall': 0.3789501874665238, 'f1-score': 0.3795091859997317, 'support': 29872}, 'accuracy': 0.35755899288698206, 'macro avg': {'precision': 0.4174703565644391, 'recall': 0.3543841545879076, 'f1-score': 0.2832964530246793, 'support': 88570}, 'weighted avg': {'precision': 0.41642618921368557, 'recall': 0.35755899288698206, 'f1-score': 0.28586998212243425, 'support': 88570}}
[[20156   104  9489]
 [19781   193  8975]
 [18483    69 11320]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3539964
{'0': {'precision': 0.33808158357228746, 'recall': 0.672926447574335, 'f1-score': 0.4500538710173926, 'support': 10863}, '1': {'precision': 0.4264705882352941, 'recall': 0.005270331667423898, 'f1-score': 0.010411991742213444, 'support': 11005}, '2': {'precision': 0.35926947588699704, 'recall': 0.3630683456695184, 'f1-score': 0.3611589213998852, 'support': 10403}, 'accuracy': 0.3453565120386725, 'macro avg': {'precision': 0.37460721589819285, 'recall': 0.3470883749704257, 'f1-score': 0.27387492805316377, 'support': 32271}, 'weighted avg': {'precision': 0.3750540554531189, 'recall': 0.3453565120386725, 'f1-score': 0.2714714582537882, 'support': 32271}}
[[7310   45 3508]
 [7719   58 3228]
 [6593   33 3777]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
1590/1590 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1716064
{'0': {'precision': 0.41882131538266665, 'recall': 0.6615057978115303, 'f1-score': 0.5129052580260163, 'support': 122460}, '1': {'precision': 0.7461857128422754, 'recall': 0.08890895410082769, 'f1-score': 0.15888639676418223, 'support': 166125}, '2': {'precision': 0.3983703336739222, 'recall': 0.6519466261295499, 'f1-score': 0.4945482267322673, 'support': 118410}, 'accuracy': 0.42500522119436357, 'macro avg': {'precision': 0.5211257872996214, 'recall': 0.46745379268063597, 'f1-score': 0.38877996050748864, 'support': 406995}, 'weighted avg': {'precision': 0.5464931781422707, 'recall': 0.42500522119436357, 'f1-score': 0.3630630255597329, 'support': 406995}}
[[81008  2803 38649]
 [73419 14770 77936]
 [38992  2221 77197]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1285185
{'0': {'precision': 0.4511664166151855, 'recall': 0.6653001908728093, 'f1-score': 0.5376983083530547, 'support': 46104}, '1': {'precision': 0.69009009009009, 'recall': 0.07624082102096788, 'f1-score': 0.13731153026470413, 'support': 45212}, '2': {'precision': 0.44940328963640863, 'recall': 0.627165447759584, 'f1-score': 0.523608396898443, 'support': 46353}, 'accuracy': 0.4590067480696453, 'macro avg': {'precision': 0.5302199321138947, 'recall': 0.4562354865511204, 'f1-score': 0.3995394118387339, 'support': 137669}, 'weighted avg': {'precision': 0.5290379120157487, 'recall': 0.4590067480696453, 'f1-score': 0.40146286917222146, 'support': 137669}}
[[30673   840 14591]
 [20739  3447 21026]
 [16574   708 29071]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.187462
{'0': {'precision': 0.4339637235564837, 'recall': 0.6617716442557207, 'f1-score': 0.5241865788428748, 'support': 16956}, '1': {'precision': 0.6626262626262627, 'recall': 0.049571788413098235, 'f1-score': 0.09224279353175534, 'support': 19850}, '2': {'precision': 0.4100956022944551, 'recall': 0.6426944744096847, 'f1-score': 0.5007003455037818, 'support': 16686}, 'accuracy': 0.42864353548194123, 'macro avg': {'precision': 0.5022285294924005, 'recall': 0.4513459690261679, 'f1-score': 0.3723765726261374, 'support': 53492}, 'weighted avg': {'precision': 0.5113713345853647, 'recall': 0.42864353548194123, 'f1-score': 0.35657318940292443, 'support': 53492}}
[[11221   302  5433]
 [ 8873   984  9993]
 [ 5763   199 10724]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51268744
{'0': {'precision': 0.49881355667608535, 'recall': 0.5494132313115248, 'f1-score': 0.5228921281844626, 'support': 116315}, '1': {'precision': 0.892586430549379, 'recall': 0.8603486149076148, 'f1-score': 0.8761710836904258, 'support': 730204}, '2': {'precision': 0.490327703721132, 'recall': 0.5491752653726747, 'f1-score': 0.5180857675574891, 'support': 121433}, 'accuracy': 0.7839469312527894, 'macro avg': {'precision': 0.6272425636488654, 'recall': 0.6529790371972715, 'f1-score': 0.6390496598107925, 'support': 967952}, 'weighted avg': {'precision': 0.7948035076363559, 'recall': 0.7839469312527894, 'f1-score': 0.7887958668370622, 'support': 967952}}
[[ 63905  38300  14110]
 [ 46765 628230  55209]
 [ 17444  37301  66688]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5280404
{'0': {'precision': 0.5394574387818094, 'recall': 0.5312853596338641, 'f1-score': 0.5353402139046533, 'support': 59213}, '1': {'precision': 0.8675068614369957, 'recall': 0.8606584362139917, 'f1-score': 0.8640690792531562, 'support': 291600}, '2': {'precision': 0.5216775564067077, 'recall': 0.5499923649875295, 'f1-score': 0.5354609050438977, 'support': 58939}, 'accuracy': 0.7683745289833851, 'macro avg': {'precision': 0.642880618875171, 'recall': 0.6473120536117952, 'f1-score': 0.6449567327339024, 'support': 409752}, 'weighted avg': {'precision': 0.7703563316705475, 'recall': 0.7683745289833851, 'f1-score': 0.769297462559155, 'support': 409752}}
[[ 31459  20365   7389]
 [ 18299 250968  22333]
 [  8558  17965  32416]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4874815
{'0': {'precision': 0.5324185043144775, 'recall': 0.5192869666861485, 'f1-score': 0.5257707556660158, 'support': 17110}, '1': {'precision': 0.8836230630063714, 'recall': 0.8802821040258595, 'f1-score': 0.8819494195118599, 'support': 102090}, '2': {'precision': 0.5179556456152201, 'recall': 0.5426347446632858, 'f1-score': 0.5300080635871444, 'support': 16958}, 'accuracy': 0.7928656413872119, 'macro avg': {'precision': 0.6446657376453563, 'recall': 0.6474012717917645, 'f1-score': 0.6459094129216734, 'support': 136158}, 'weighted avg': {'precision': 0.7939471125419297, 'recall': 0.7928656413872119, 'f1-score': 0.7933579415805322, 'support': 136158}}
[[ 8885  6330  1895]
 [ 5553 89868  6669]
 [ 2250  5506  9202]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
4457/4457 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6287586
{'0': {'precision': 0.47549440266848964, 'recall': 0.5693891295008302, 'f1-score': 0.5182230089430787, 'support': 172246}, '1': {'precision': 0.8563143137336151, 'recall': 0.7750506313289162, 'f1-score': 0.8136584661622558, 'support': 799900}, '2': {'precision': 0.45602012244316836, 'recall': 0.5691978698322997, 'f1-score': 0.5063619332688665, 'support': 168813}, 'accuracy': 0.7135453596492074, 'macro avg': {'precision': 0.5959429462817577, 'recall': 0.637879210220682, 'f1-score': 0.6127478027914003, 'support': 1140959}, 'weighted avg': {'precision': 0.7395970875093267, 'recall': 0.7135453596492074, 'f1-score': 0.7235910532477636, 'support': 1140959}}
[[ 98075  54542  19629]
 [ 84944 619963  94993]
 [ 23240  49485  96088]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53331566
{'0': {'precision': 0.47482744839653923, 'recall': 0.5524417523311634, 'f1-score': 0.5107025645493887, 'support': 79574}, '1': {'precision': 0.8847659786347999, 'recall': 0.8416256178846385, 'f1-score': 0.8626567865055476, 'support': 464488}, '2': {'precision': 0.47937809907780715, 'recall': 0.5396543853928921, 'f1-score': 0.5077335558405066, 'support': 76675}, 'accuracy': 0.7672540866743887, 'macro avg': {'precision': 0.6129905087030487, 'recall': 0.6445739185362314, 'f1-score': 0.6270309689651477, 'support': 620737}, 'weighted avg': {'precision': 0.7821402864814212, 'recall': 0.7672540866743887, 'f1-score': 0.7736977845946234, 'support': 620737}}
[[ 43960  27470   8144]
 [ 36769 390925  36794]
 [ 11852  23445  41378]]
Evaluating performance on  val set...
787/787 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5396867
{'0': {'precision': 0.5013998824790018, 'recall': 0.5371597852249583, 'f1-score': 0.5186641876430206, 'support': 27005}, '1': {'precision': 0.8754779077095441, 'recall': 0.8434946871310508, 'f1-score': 0.8591887573659526, 'support': 148225}, '2': {'precision': 0.47617109324649776, 'recall': 0.5400892582333026, 'f1-score': 0.5061200944603681, 'support': 25992}, 'accuracy': 0.7631918975062368, 'macro avg': {'precision': 0.6176829611450146, 'recall': 0.6402479101964372, 'f1-score': 0.6279910131564471, 'support': 201222}, 'weighted avg': {'precision': 0.7736959962243471, 'recall': 0.7631918975062368, 'f1-score': 0.7678825051091926, 'support': 201222}}
[[ 14506   9496   3003]
 [ 10758 125027  12440]
 [  3667   8287  14038]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
4676/4676 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6501284
{'0': {'precision': 0.481122993138208, 'recall': 0.5461163488322263, 'f1-score': 0.511563608628675, 'support': 186680}, '1': {'precision': 0.8422884433299691, 'recall': 0.788702136495553, 'f1-score': 0.8146149990282916, 'support': 821111}, '2': {'precision': 0.46955632946225817, 'recall': 0.5366177232317466, 'f1-score': 0.500852208960157, 'support': 189198}, 'accuracy': 0.7110240779155029, 'macro avg': {'precision': 0.5976559219768117, 'recall': 0.6238120695198419, 'f1-score': 0.6090102722057079, 'support': 1196989}, 'weighted avg': {'precision': 0.7270471698334363, 'recall': 0.7110240779155029, 'f1-score': 0.717757863402892, 'support': 1196989}}
[[101949  61580  23151]
 [ 81958 647612  91541]
 [ 27991  59680 101527]]
Evaluating performance on  train set...
2108/2108 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6147744
{'0': {'precision': 0.4921781845235062, 'recall': 0.56076915038144, 'f1-score': 0.5242395953192506, 'support': 86121}, '1': {'precision': 0.8533780725802035, 'recall': 0.8050866586711702, 'f1-score': 0.8285292874674997, 'support': 367707}, '2': {'precision': 0.4986279890239122, 'recall': 0.5499351491569391, 'f1-score': 0.5230263157894737, 'support': 85581}, 'accuracy': 0.7255978302178866, 'macro avg': {'precision': 0.6147280820425406, 'recall': 0.6385969860698498, 'f1-score': 0.6252650661920746, 'support': 539409}, 'weighted avg': {'precision': 0.7394260205006835, 'recall': 0.7255978302178866, 'f1-score': 0.7314768052199351, 'support': 539409}}
[[ 48294  26497  11330]
 [ 35678 296036  35993]
 [ 14151  24366  47064]]
Evaluating performance on  val set...
798/798 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6623676
{'0': {'precision': 0.4740472293663783, 'recall': 0.5646688575725506, 'f1-score': 0.5154049519548528, 'support': 35906}, '1': {'precision': 0.842016029593095, 'recall': 0.7798832395392695, 'f1-score': 0.8097595225557311, 'support': 133093}, '2': {'precision': 0.4977851170349401, 'recall': 0.5396090242654998, 'f1-score': 0.5178539777762629, 'support': 35194}, 'accuracy': 0.7006263681908782, 'macro avg': {'precision': 0.6046161253314711, 'recall': 0.6280537071257734, 'f1-score': 0.6143394840956157, 'support': 204193}, 'weighted avg': {'precision': 0.7179806783444617, 'recall': 0.7006263681908782, 'f1-score': 0.7076873704498131, 'support': 204193}}
[[ 20275  10397   5234]
 [ 15370 103797  13926]
 [  7125   9078  18991]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
4274/4274 - 63s - 63s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84407157
{'0': {'precision': 0.43949986218647424, 'recall': 0.6082199856093903, 'f1-score': 0.5102749564528036, 'support': 230706}, '1': {'precision': 0.7907204228376732, 'recall': 0.6054595178076329, 'f1-score': 0.6857987169056018, 'support': 635514}, '2': {'precision': 0.4450891122092055, 'recall': 0.5629441067392306, 'f1-score': 0.49712705490668013, 'support': 227845}, 'accuracy': 0.5971875528419244, 'macro avg': {'precision': 0.558436465744451, 'recall': 0.5922078700520846, 'f1-score': 0.5644002427550285, 'support': 1094065}, 'weighted avg': {'precision': 0.6446787739084607, 'recall': 0.5971875528419244, 'f1-score': 0.6094940371039743, 'support': 1094065}}
[[140320  53272  37114]
 [127938 384778 122798]
 [ 51014  48567 128264]]
Evaluating performance on  train set...
1972/1972 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7305257
{'0': {'precision': 0.44664568796460985, 'recall': 0.5638616369582239, 'f1-score': 0.49845530565607515, 'support': 86844}, '1': {'precision': 0.8404234491743524, 'recall': 0.7135590761549574, 'f1-score': 0.7718127716329769, 'support': 330878}, '2': {'precision': 0.4371305278299156, 'recall': 0.5737986138294688, 'f1-score': 0.49622645266637466, 'support': 86858}, 'accuracy': 0.6637361766221412, 'macro avg': {'precision': 0.5747332216562926, 'recall': 0.6170731089808833, 'f1-score': 0.5888315099851422, 'support': 504580}, 'weighted avg': {'precision': 0.7032272613416323, 'recall': 0.6637361766221412, 'f1-score': 0.6773256095018992, 'support': 504580}}
[[ 48968  23919  13957]
 [ 44559 236101  50218]
 [ 16108  20911  49839]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7401869
{'0': {'precision': 0.4529258329642207, 'recall': 0.574075229243341, 'f1-score': 0.5063548830811554, 'support': 32062}, '1': {'precision': 0.8322237286763664, 'recall': 0.7005894177370448, 'f1-score': 0.7607543539988346, 'support': 117404}, '2': {'precision': 0.4378663824427111, 'recall': 0.5777294809511634, 'f1-score': 0.49816728675761335, 'support': 31288}, 'accuracy': 0.6568817287584231, 'macro avg': {'precision': 0.574338648027766, 'recall': 0.6174647093105164, 'f1-score': 0.5884255079458677, 'support': 180754}, 'weighted avg': {'precision': 0.6966820433953689, 'recall': 0.6568817287584231, 'f1-score': 0.6701761095538654, 'support': 180754}}
[[18406  9024  4632]
 [16578 82252 18574]
 [ 5654  7558 18076]]
testing model on single stock: results/universal/W4/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
12724/12724 - 178s - 178s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0143988
{'0': {'precision': 0.44729231068740116, 'recall': 0.6623927330387701, 'f1-score': 0.5339950787271598, 'support': 915706}, '1': {'precision': 0.6835243435982854, 'recall': 0.2716295060588868, 'f1-score': 0.38876539082675926, 'support': 1417092}, '2': {'precision': 0.45038592998026067, 'recall': 0.6519052868559386, 'f1-score': 0.5327248632577845, 'support': 924349}, 'accuracy': 0.4894065266320495, 'macro avg': {'precision': 0.5270675280886491, 'recall': 0.5286425086511986, 'f1-score': 0.48516177760390117, 'support': 3257147}, 'weighted avg': {'precision': 0.5509480891590164, 'recall': 0.4894065266320495, 'f1-score': 0.4704492973162944, 'support': 3257147}}
[[606557  96426 212723]
 [509542 384924 522626]
 [239965  81796 602588]]
Evaluating performance on  train set...
5165/5165 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0412552
{'0': {'precision': 0.4698807871801565, 'recall': 0.7018879283412729, 'f1-score': 0.5629159541684574, 'support': 438523}, '1': {'precision': 0.6626449231756729, 'recall': 0.1490909583242132, 'f1-score': 0.24341505377928666, 'support': 443159}, '2': {'precision': 0.4892719975605758, 'recall': 0.6302779165342174, 'f1-score': 0.5508951970048632, 'support': 440420}, 'accuracy': 0.4927395919528145, 'macro avg': {'precision': 0.5405992359721351, 'recall': 0.4937522677332345, 'f1-score': 0.45240873498420237, 'support': 1322102}, 'weighted avg': {'precision': 0.5409535475415972, 'recall': 0.4927395919528145, 'f1-score': 0.4518172027971149, 'support': 1322102}}
[[307794  18573 112156]
 [199484  66071 177604]
 [147769  15064 277587]]
Evaluating performance on  val set...
1903/1903 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0052831
{'0': {'precision': 0.49055093384990295, 'recall': 0.676562442815142, 'f1-score': 0.5687336719232712, 'support': 163942}, '1': {'precision': 0.668271873694395, 'recall': 0.1940974351113836, 'f1-score': 0.30082206153830926, 'support': 156576}, '2': {'precision': 0.4942204850150407, 'recall': 0.6394865510986173, 'f1-score': 0.5575467795065698, 'support': 166482}, 'accuracy': 0.5087700205338809, 'macro avg': {'precision': 0.5510144308531129, 'recall': 0.5033821430083809, 'f1-score': 0.4757008376560501, 'support': 487000}, 'weighted avg': {'precision': 0.5489446671028098, 'recall': 0.5087700205338809, 'f1-score': 0.4787728001964681, 'support': 487000}}
[[110917   7833  45192]
 [ 62424  30391  63761]
 [ 52766   7253 106463]]
training model: results/universal/W4/deepVOL_L3/h20
Epoch 1/50
9854/9854 - 505s - loss: 2.8014 - accuracy20: 0.5260 - val_loss: 3.1039 - val_accuracy20: 0.5235 - 505s/epoch - 51ms/step
Epoch 2/50
9854/9854 - 505s - loss: 2.6832 - accuracy20: 0.5609 - val_loss: 3.0484 - val_accuracy20: 0.5342 - 505s/epoch - 51ms/step
Epoch 3/50
9854/9854 - 503s - loss: 2.6491 - accuracy20: 0.5679 - val_loss: 2.9557 - val_accuracy20: 0.5446 - 503s/epoch - 51ms/step
Epoch 4/50
9854/9854 - 508s - loss: 2.6287 - accuracy20: 0.5717 - val_loss: 2.9102 - val_accuracy20: 0.5470 - 508s/epoch - 52ms/step
Epoch 5/50
9854/9854 - 501s - loss: 2.6167 - accuracy20: 0.5737 - val_loss: 2.8161 - val_accuracy20: 0.5536 - 501s/epoch - 51ms/step
Epoch 6/50
9854/9854 - 504s - loss: 2.6060 - accuracy20: 0.5762 - val_loss: 2.7731 - val_accuracy20: 0.5601 - 504s/epoch - 51ms/step
Epoch 7/50
9854/9854 - 506s - loss: 2.5987 - accuracy20: 0.5772 - val_loss: 2.7559 - val_accuracy20: 0.5603 - 506s/epoch - 51ms/step
Epoch 8/50
9854/9854 - 505s - loss: 2.5929 - accuracy20: 0.5784 - val_loss: 2.7545 - val_accuracy20: 0.5586 - 505s/epoch - 51ms/step
Epoch 9/50
9854/9854 - 506s - loss: 2.5877 - accuracy20: 0.5794 - val_loss: 2.7642 - val_accuracy20: 0.5596 - 506s/epoch - 51ms/step
Epoch 10/50
9854/9854 - 505s - loss: 2.5828 - accuracy20: 0.5805 - val_loss: 2.7700 - val_accuracy20: 0.5583 - 505s/epoch - 51ms/step
Epoch 11/50
9854/9854 - 509s - loss: 2.5789 - accuracy20: 0.5810 - val_loss: 2.7503 - val_accuracy20: 0.5627 - 509s/epoch - 52ms/step
Epoch 12/50
9854/9854 - 511s - loss: 2.5753 - accuracy20: 0.5816 - val_loss: 2.7464 - val_accuracy20: 0.5645 - 511s/epoch - 52ms/step
Epoch 13/50
9854/9854 - 505s - loss: 2.5722 - accuracy20: 0.5822 - val_loss: 2.7537 - val_accuracy20: 0.5601 - 505s/epoch - 51ms/step
Epoch 14/50
9854/9854 - 503s - loss: 2.5693 - accuracy20: 0.5828 - val_loss: 2.7533 - val_accuracy20: 0.5592 - 503s/epoch - 51ms/step
Epoch 15/50
9854/9854 - 497s - loss: 2.5666 - accuracy20: 0.5832 - val_loss: 2.7488 - val_accuracy20: 0.5586 - 497s/epoch - 50ms/step
Epoch 16/50
9854/9854 - 502s - loss: 2.5640 - accuracy20: 0.5838 - val_loss: 2.7375 - val_accuracy20: 0.5642 - 502s/epoch - 51ms/step
Epoch 17/50
9854/9854 - 500s - loss: 2.5615 - accuracy20: 0.5843 - val_loss: 2.7444 - val_accuracy20: 0.5604 - 500s/epoch - 51ms/step
Epoch 18/50
9854/9854 - 508s - loss: 2.5594 - accuracy20: 0.5846 - val_loss: 2.7399 - val_accuracy20: 0.5623 - 508s/epoch - 52ms/step
Epoch 19/50
9854/9854 - 507s - loss: 2.5573 - accuracy20: 0.5850 - val_loss: 2.7340 - val_accuracy20: 0.5663 - 507s/epoch - 51ms/step
Epoch 20/50
9854/9854 - 501s - loss: 2.5554 - accuracy20: 0.5855 - val_loss: 2.7276 - val_accuracy20: 0.5647 - 501s/epoch - 51ms/step
Epoch 21/50
9854/9854 - 505s - loss: 2.5537 - accuracy20: 0.5856 - val_loss: 2.7301 - val_accuracy20: 0.5651 - 505s/epoch - 51ms/step
Epoch 22/50
9854/9854 - 502s - loss: 2.5521 - accuracy20: 0.5860 - val_loss: 2.7255 - val_accuracy20: 0.5661 - 502s/epoch - 51ms/step
Epoch 23/50
9854/9854 - 506s - loss: 2.5501 - accuracy20: 0.5864 - val_loss: 2.7353 - val_accuracy20: 0.5655 - 506s/epoch - 51ms/step
Epoch 24/50
9854/9854 - 500s - loss: 2.5484 - accuracy20: 0.5868 - val_loss: 2.7353 - val_accuracy20: 0.5656 - 500s/epoch - 51ms/step
Epoch 25/50
9854/9854 - 503s - loss: 2.5466 - accuracy20: 0.5871 - val_loss: 2.7354 - val_accuracy20: 0.5657 - 503s/epoch - 51ms/step
Epoch 26/50
9854/9854 - 501s - loss: 2.5454 - accuracy20: 0.5873 - val_loss: 2.7454 - val_accuracy20: 0.5670 - 501s/epoch - 51ms/step
Epoch 27/50
9854/9854 - 504s - loss: 2.5441 - accuracy20: 0.5876 - val_loss: 2.7480 - val_accuracy20: 0.5633 - 504s/epoch - 51ms/step
Epoch 28/50
9854/9854 - 500s - loss: 2.5426 - accuracy20: 0.5879 - val_loss: 2.7382 - val_accuracy20: 0.5673 - 500s/epoch - 51ms/step
Epoch 29/50
9854/9854 - 503s - loss: 2.5412 - accuracy20: 0.5882 - val_loss: 2.7626 - val_accuracy20: 0.5625 - 503s/epoch - 51ms/step
Epoch 30/50
9854/9854 - 505s - loss: 2.5399 - accuracy20: 0.5881 - val_loss: 2.7507 - val_accuracy20: 0.5641 - 505s/epoch - 51ms/step
Epoch 31/50
9854/9854 - 501s - loss: 2.5387 - accuracy20: 0.5886 - val_loss: 2.7607 - val_accuracy20: 0.5613 - 501s/epoch - 51ms/step
Epoch 32/50
9854/9854 - 504s - loss: 2.5374 - accuracy20: 0.5888 - val_loss: 2.7599 - val_accuracy20: 0.5641 - 504s/epoch - 51ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 630s - 630s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9545487
{'0': {'precision': 0.42838032358109734, 'recall': 0.6437852766136908, 'f1-score': 0.5144446810500454, 'support': 1465383}, '1': {'precision': 0.7866562399146, 'recall': 0.5044514590062048, 'f1-score': 0.6147122944010827, 'support': 3140768}, '2': {'precision': 0.44146956559702183, 'recall': 0.558916532467178, 'f1-score': 0.49329881586867863, 'support': 1465480}, 'accuracy': 0.5512255273747696, 'macro avg': {'precision': 0.552168709697573, 'recall': 0.5690510893623578, 'f1-score': 0.5408185971066022, 'support': 6071631}, 'weighted avg': {'precision': 0.6168706247177178, 'recall': 0.5512255273747696, 'f1-score': 0.5612078109147096, 'support': 6071631}}
[[ 943392  212213  309778]
 [ 829911 1584365  726492]
 [ 428927  217472  819081]]
Evaluating performance on  train set...
9854/9854 - 267s - 267s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95443076
{'0': {'precision': 0.44946184111163673, 'recall': 0.6704556080228155, 'f1-score': 0.5381543294971529, 'support': 684448}, '1': {'precision': 0.7885496689344408, 'recall': 0.5256881608597678, 'f1-score': 0.6308313698041013, 'support': 1153800}, '2': {'precision': 0.4880925866462619, 'recall': 0.5224161305466304, 'f1-score': 0.5046714315786797, 'support': 683771}, 'accuracy': 0.564089326844881, 'macro avg': {'precision': 0.5753680322307798, 'recall': 0.5728532998097379, 'f1-score': 0.5578857102933114, 'support': 2522019}, 'weighted avg': {'precision': 0.6150649231054313, 'recall': 0.564089326844881, 'f1-score': 0.5714753054745523, 'support': 2522019}}
[[458892  80738 144818]
 [317437 606539 229824]
 [244652  81906 357213]]
Evaluating performance on  val set...
3566/3566 - 95s - 95s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9359913
{'0': {'precision': 0.45720316386956994, 'recall': 0.6552284312705564, 'f1-score': 0.5385904412333021, 'support': 249922}, '1': {'precision': 0.791284272521943, 'recall': 0.5347324695398066, 'f1-score': 0.6381901219373352, 'support': 414065}, '2': {'precision': 0.4802399705503942, 'recall': 0.5305175850059388, 'f1-score': 0.5041283104918007, 'support': 248365}, 'accuracy': 0.5665927185998386, 'macro avg': {'precision': 0.5762424689806357, 'recall': 0.5734928286054339, 'f1-score': 0.5603029578874793, 'support': 912352}, 'weighted avg': {'precision': 0.6150948884949643, 'recall': 0.5665927185998386, 'f1-score': 0.5744116535385335, 'support': 912352}}
[[163756  28952  57214]
 [107260 221414  85391]
 [ 87153  29450 131762]]
testing model out of sample: results/universal/W4/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 316s - 316s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93678445
{'0': {'precision': 0.4513214726215996, 'recall': 0.6369873133129919, 'f1-score': 0.5283170658937857, 'support': 778375}, '1': {'precision': 0.7533772218807169, 'recall': 0.5488008269326937, 'f1-score': 0.635019216822379, 'support': 1491778}, '2': {'precision': 0.46202052306038177, 'recall': 0.513517595132694, 'f1-score': 0.4864098357189148, 'support': 761489}, 'accuracy': 0.56258027827824, 'macro avg': {'precision': 0.5555730725208995, 'recall': 0.5664352451261265, 'f1-score': 0.5499153728116932, 'support': 3031642}, 'weighted avg': {'precision': 0.6026412296172624, 'recall': 0.56258027827824, 'f1-score': 0.5702956459864624, 'support': 3031642}}
[[495815 127052 155508]
 [373270 818689 299819]
 [229500 140951 391038]]
Evaluating performance on  train set...
5528/5528 - 150s - 150s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82290155
{'0': {'precision': 0.44955809416628495, 'recall': 0.6175627892714433, 'f1-score': 0.5203353338536482, 'support': 313071}, '1': {'precision': 0.8060235545521496, 'recall': 0.6769607700234358, 'f1-score': 0.7358760535824386, 'support': 788963}, '2': {'precision': 0.4834054878901552, 'recall': 0.49784591748551676, 'f1-score': 0.4905194475498783, 'support': 312430}, 'accuracy': 0.6242505995203836, 'macro avg': {'precision': 0.57966237886953, 'recall': 0.597456492260132, 'f1-score': 0.5822436116619883, 'support': 1414464}, 'weighted avg': {'precision': 0.6558645114689251, 'recall': 0.6242505995203836, 'f1-score': 0.6339743345645174, 'support': 1414464}}
[[193341  62444  57286]
 [145931 534097 108935]
 [ 90797  66091 155542]]
Evaluating performance on  val set...
1908/1908 - 51s - 51s/epoch - 27ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8423251
{'0': {'precision': 0.4577699794742766, 'recall': 0.6138962884034808, 'f1-score': 0.524460458941779, 'support': 112620}, '1': {'precision': 0.7906232939035487, 'recall': 0.6587903027086452, 'f1-score': 0.7187112917067321, 'support': 263785}, '2': {'precision': 0.4779727195663901, 'recall': 0.5019332446138906, 'f1-score': 0.4896600423686069, 'support': 111212}, 'accuracy': 0.6126468109192256, 'macro avg': {'precision': 0.5754553309814051, 'recall': 0.5915399452420056, 'f1-score': 0.5776105976723727, 'support': 487617}, 'weighted avg': {'precision': 0.6424405276254889, 'recall': 0.6126468109192256, 'f1-score': 0.6216068504600557, 'support': 487617}}
[[ 69137  22425  21058]
 [ 50098 173779  39908]
 [ 31795  23596  55821]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0995306
{'0': {'precision': 0.4441924101677828, 'recall': 0.7019896439883921, 'f1-score': 0.5440993788819877, 'support': 52723}, '1': {'precision': 0.49126344086021506, 'recall': 0.022978750157173395, 'f1-score': 0.043903903903903904, 'support': 31812}, '2': {'precision': 0.473632435768845, 'recall': 0.47113336786968285, 'f1-score': 0.47237959658724743, 'support': 52119}, 'accuracy': 0.45587395904986316, 'macro avg': {'precision': 0.4696960955989476, 'recall': 0.3987005873384161, 'f1-score': 0.3534609597910463, 'support': 136654}, 'weighted avg': {'precision': 0.466378429769766, 'recall': 0.45587395904986316, 'f1-score': 0.40030423359957834, 'support': 136654}}
[[37011   316 15396]
 [19188   731 11893]
 [27123   441 24555]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3181548
{'0': {'precision': 0.35800656219168026, 'recall': 0.7543511893250822, 'f1-score': 0.48556802091275464, 'support': 20684}, '1': {'precision': 0.6672473867595818, 'recall': 0.01668699895433949, 'f1-score': 0.032559721159568136, 'support': 22952}, '2': {'precision': 0.4225419895086385, 'recall': 0.41220657276995304, 'f1-score': 0.4173102972979396, 'support': 21300}, 'accuracy': 0.38139090797092523, 'macro avg': {'precision': 0.4825986461533002, 'recall': 0.39441492034979153, 'f1-score': 0.3118126797900875, 'support': 64936}, 'weighted avg': {'precision': 0.488478103514424, 'recall': 0.38139090797092523, 'f1-score': 0.3030600744896504, 'support': 64936}}
[[15603    77  5004]
 [15574   383  6995]
 [12406   114  8780]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2743937
{'0': {'precision': 0.3797188325126668, 'recall': 0.7621025494127757, 'f1-score': 0.5068825910931173, 'support': 6982}, '1': {'precision': 0.5686274509803921, 'recall': 0.01293103448275862, 'f1-score': 0.02528702223514024, 'support': 6728}, '2': {'precision': 0.4217950705317005, 'recall': 0.3939481685246851, 'f1-score': 0.40739631681389427, 'support': 6907}, 'accuracy': 0.3942862686132803, 'macro avg': {'precision': 0.45671378467491985, 'recall': 0.38966058414007315, 'f1-score': 0.3131886433807172, 'support': 20617}, 'weighted avg': {'precision': 0.45546204253586714, 'recall': 0.3942862686132803, 'f1-score': 0.31639286495822555, 'support': 20617}}
[[5321   31 1630]
 [4541   87 2100]
 [4151   35 2721]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.48123586
{'0': {'precision': 0.5285365624706655, 'recall': 0.4854402414053238, 'f1-score': 0.5060725560910939, 'support': 46395}, '1': {'precision': 0.8855995803377311, 'recall': 0.9143908204317402, 'f1-score': 0.8997649392939553, 'support': 319405}, '2': {'precision': 0.5446251977848101, 'recall': 0.46821398967034367, 'f1-score': 0.5035372641347703, 'support': 47049}, 'accuracy': 0.8153392644768426, 'macro avg': {'precision': 0.6529204468644023, 'recall': 0.6226816838358026, 'f1-score': 0.6364582531732732, 'support': 412849}, 'weighted avg': {'precision': 0.8066156359932495, 'recall': 0.8153392644768426, 'f1-score': 0.8103679103384263, 'support': 412849}}
[[ 22522  17944   5929]
 [ 14854 292061  12490]
 [  5236  19784  22029]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56900424
{'0': {'precision': 0.5206883217324053, 'recall': 0.5017467045507475, 'f1-score': 0.5110420570723724, 'support': 21469}, '1': {'precision': 0.8659533772666149, 'recall': 0.8712583404763106, 'f1-score': 0.8685977589276365, 'support': 118998}, '2': {'precision': 0.4960268246750264, 'recall': 0.49721442055343246, 'f1-score': 0.49661991262359156, 'support': 21719}, 'accuracy': 0.7722553118024984, 'macro avg': {'precision': 0.6275561745580155, 'recall': 0.6234064885268302, 'f1-score': 0.6254199095412002, 'support': 162186}, 'weighted avg': {'precision': 0.7707113078339841, 'recall': 0.7722553118024984, 'f1-score': 0.7714540461102032, 'support': 162186}}
[[ 10772   7916   2781]
 [  7129 103678   8191]
 [  2787   8133  10799]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.4932194
{'0': {'precision': 0.5432681984109942, 'recall': 0.4648171963990446, 'f1-score': 0.5009900990099009, 'support': 5443}, '1': {'precision': 0.8890767749360013, 'recall': 0.9109635191067476, 'f1-score': 0.899887086230463, 'support': 41556}, '2': {'precision': 0.49271933017837644, 'recall': 0.47234339556796373, 'f1-score': 0.4823162583518931, 'support': 5731}, 'accuracy': 0.8172387635122321, 'macro avg': {'precision': 0.641688101175124, 'recall': 0.6160413703579186, 'f1-score': 0.6277311478640857, 'support': 52730}, 'weighted avg': {'precision': 0.8103026312240431, 'recall': 0.8172387635122321, 'f1-score': 0.8133273533267344, 'support': 52730}}
[[ 2530  2269   644]
 [ 1557 37856  2143]
 [  570  2454  2707]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2483296
{'0': {'precision': 0.3828424344559868, 'recall': 0.6221235200348788, 'f1-score': 0.47399671974588414, 'support': 73397}, '1': {'precision': 0.6724126799664278, 'recall': 0.09634686722356359, 'f1-score': 0.1685438715732919, 'support': 108099}, '2': {'precision': 0.36904973394580787, 'recall': 0.6103703496425223, 'f1-score': 0.45998038822871967, 'support': 71473}, 'accuracy': 0.3941273436666153, 'macro avg': {'precision': 0.4747682827894075, 'recall': 0.44294691230032157, 'f1-score': 0.36750699318263197, 'support': 252969}, 'weighted avg': {'precision': 0.5026849775575888, 'recall': 0.3941273436666153, 'f1-score': 0.33951013563029947, 'support': 252969}}
[[45662  2676 25059]
 [48159 10415 49525]
 [25450  2398 43625]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1332936
{'0': {'precision': 0.429244844882036, 'recall': 0.643785045101522, 'f1-score': 0.515067500731432, 'support': 28713}, '1': {'precision': 0.6708750544188071, 'recall': 0.1605933233751346, 'f1-score': 0.25915129771848194, 'support': 28787}, '2': {'precision': 0.4383524202585618, 'recall': 0.5522346945802631, 'f1-score': 0.48874735254232127, 'support': 29042}, 'accuracy': 0.45233528229067965, 'macro avg': {'precision': 0.5128241065198017, 'recall': 0.4522043543523065, 'f1-score': 0.42098871699741175, 'support': 86542}, 'weighted avg': {'precision': 0.5126761388898021, 'recall': 0.45233528229067965, 'f1-score': 0.421107926422519, 'support': 86542}}
[[18485  1072  9156]
 [12771  4623 11393]
 [11808  1196 16038]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1326275
{'0': {'precision': 0.4313047771880015, 'recall': 0.6379987218113758, 'f1-score': 0.5146750138096114, 'support': 10953}, '1': {'precision': 0.5828908554572272, 'recall': 0.10596310596310596, 'f1-score': 0.17932661766040475, 'support': 9324}, '2': {'precision': 0.45991932526585994, 'recall': 0.5571745890715237, 'f1-score': 0.5038971474487746, 'support': 11255}, 'accuracy': 0.4518267157173665, 'macro avg': {'precision': 0.49137165263702953, 'recall': 0.4337121389486685, 'f1-score': 0.3992995929729302, 'support': 31532}, 'weighted avg': {'precision': 0.4863423685998548, 'recall': 0.4518267157173665, 'f1-score': 0.41166558429082345, 'support': 31532}}
[[6988  351 3614]
 [4586  988 3750]
 [4628  356 6271]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4529122
{'0': {'precision': 0.3066032822985017, 'recall': 0.5790131782292282, 'f1-score': 0.4009124691141851, 'support': 71178}, '1': {'precision': 0.6254953764861294, 'recall': 0.009266507495400995, 'f1-score': 0.018262462636197088, 'support': 102196}, '2': {'precision': 0.26767035191838195, 'recall': 0.4259475679090335, 'f1-score': 0.3287502590168331, 'support': 63320}, 'accuracy': 0.2920690849789179, 'macro avg': {'precision': 0.399923003567671, 'recall': 0.3380757512112209, 'f1-score': 0.2493083969224051, 'support': 236694}, 'weighted avg': {'precision': 0.4338742030059536, 'recall': 0.2920690849789179, 'f1-score': 0.21639316906691397, 'support': 236694}}
[[41213   262 29703]
 [57161   947 44088]
 [36044   305 26971]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3123087
{'0': {'precision': 0.3432100243425516, 'recall': 0.5766149307767088, 'f1-score': 0.4302993158138314, 'support': 29831}, '1': {'precision': 0.3963254593175853, 'recall': 0.005161334427126059, 'f1-score': 0.01018996524614502, 'support': 29256}, '2': {'precision': 0.3378161855480549, 'recall': 0.43621748126038734, 'f1-score': 0.38076205702104987, 'support': 29483}, 'accuracy': 0.3411200180648075, 'macro avg': {'precision': 0.35911722306939725, 'recall': 0.33933124882140736, 'f1-score': 0.27375044602700876, 'support': 88570}, 'weighted avg': {'precision': 0.35895935951757063, 'recall': 0.3411200180648075, 'f1-score': 0.2750410324086625, 'support': 88570}}
[[17201   120 12510]
 [16405   151 12700]
 [16512   110 12861]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3291713
{'0': {'precision': 0.3393176764115637, 'recall': 0.5771217712177121, 'f1-score': 0.4273661918912456, 'support': 10840}, '1': {'precision': 0.36, 'recall': 0.005703938433680398, 'f1-score': 0.011229946524064172, 'support': 11045}, '2': {'precision': 0.3257193059521195, 'recall': 0.4283651068746389, 'f1-score': 0.3700561447286338, 'support': 10386}, 'accuracy': 0.3336741966471445, 'macro avg': {'precision': 0.3416789941212277, 'recall': 0.33706360550867714, 'f1-score': 0.2695507610479812, 'support': 32271}, 'weighted avg': {'precision': 0.34201990405999394, 'recall': 0.3336741966471445, 'f1-score': 0.2664958445232866, 'support': 32271}}
[[6256   53 4531]
 [6303   63 4679]
 [5878   59 4449]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
1590/1590 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2703688
{'0': {'precision': 0.3908553070142952, 'recall': 0.673728644499238, 'f1-score': 0.4947104750465086, 'support': 125319}, '1': {'precision': 0.6725138307920658, 'recall': 0.06187538020335448, 'f1-score': 0.11332423829013188, 'support': 161098}, '2': {'precision': 0.3915881855390362, 'recall': 0.5720861185290849, 'f1-score': 0.464933358046742, 'support': 120578}, 'accuracy': 0.40142999299745696, 'macro avg': {'precision': 0.48498577444846575, 'recall': 0.43589671441055905, 'f1-score': 0.3576560237944608, 'support': 406995}, 'weighted avg': {'precision': 0.5025593669912176, 'recall': 0.40142999299745696, 'f1-score': 0.33492712345109193, 'support': 406995}}
[[84431  2531 38357]
 [82311  9968 68819]
 [49274  2323 68981]]
Evaluating performance on  train set...
538/538 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.211873
{'0': {'precision': 0.4166924141266238, 'recall': 0.6749129677980853, 'f1-score': 0.5152615011503227, 'support': 45960}, '1': {'precision': 0.6324961558175295, 'recall': 0.054173892047325325, 'f1-score': 0.0997998342061101, 'support': 45557}, '2': {'precision': 0.43417725786333144, 'recall': 0.5581123244929798, 'f1-score': 0.48840516505811643, 'support': 46152}, 'accuracy': 0.43034379562574, 'macro avg': {'precision': 0.4944552759358282, 'recall': 0.4290663947794635, 'f1-score': 0.36782216680484975, 'support': 137669}, 'weighted avg': {'precision': 0.49396712062081727, 'recall': 0.43034379562574, 'f1-score': 0.36877492258648487, 'support': 137669}}
[[31019   735 14206]
 [23727  2468 19362]
 [19695   699 25758]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.276107
{'0': {'precision': 0.40544978165938866, 'recall': 0.674101179067201, 'f1-score': 0.5063478905806902, 'support': 17217}, '1': {'precision': 0.6227141482194418, 'recall': 0.03403113822848727, 'f1-score': 0.06453543464166377, 'support': 19012}, '2': {'precision': 0.4158133288568071, 'recall': 0.5739442738805538, 'f1-score': 0.4822467206930958, 'support': 17263}, 'accuracy': 0.41428624841097733, 'macro avg': {'precision': 0.48132575291187923, 'recall': 0.42735886372541404, 'f1-score': 0.35104334863848324, 'support': 53492}, 'weighted avg': {'precision': 0.48601390437509884, 'recall': 0.41428624841097733, 'f1-score': 0.3415419960902559, 'support': 53492}}
[[11606   219  5392]
 [ 9837   647  8528]
 [ 7182   173  9908]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
3782/3782 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60341465
{'0': {'precision': 0.5258947235066828, 'recall': 0.5373204843605393, 'f1-score': 0.5315462109013614, 'support': 154513}, '1': {'precision': 0.8339547518441812, 'recall': 0.8466158498134357, 'f1-score': 0.8402376076817223, 'support': 650178}, '2': {'precision': 0.5519985603167303, 'recall': 0.5072736293419738, 'f1-score': 0.5286918996214417, 'support': 163261}, 'accuracy': 0.74000776898028, 'macro avg': {'precision': 0.6372826785558648, 'recall': 0.6304033211719829, 'f1-score': 0.6334919060681751, 'support': 967952}, 'weighted avg': {'precision': 0.737222962516327, 'recall': 0.74000776898028, 'f1-score': 0.7384142759107735, 'support': 967952}}
[[ 83023  53478  18012]
 [ 50524 550451  49203]
 [ 24323  56120  82818]]
Evaluating performance on  train set...
1601/1601 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6230444
{'0': {'precision': 0.5676048680523609, 'recall': 0.5212982523526023, 'f1-score': 0.5434669442998439, 'support': 78105}, '1': {'precision': 0.7960724686235601, 'recall': 0.8515808377573686, 'f1-score': 0.8228916327489786, 'support': 253916}, '2': {'precision': 0.5777884876050483, 'recall': 0.4935482625979339, 'f1-score': 0.5323564306975, 'support': 77731}, 'accuracy': 0.7207042308518323, 'macro avg': {'precision': 0.6471552747603231, 'recall': 0.6221424509026349, 'f1-score': 0.6329050025821075, 'support': 409752}, 'weighted avg': {'precision': 0.7111140204130243, 'recall': 0.7207042308518323, 'f1-score': 0.7145137429961936, 'support': 409752}}
[[ 40716  27880   9509]
 [ 19161 216230  18525]
 [ 11856  27511  38364]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5786848
{'0': {'precision': 0.5626604545022345, 'recall': 0.5155739490307123, 'f1-score': 0.5380890677214758, 'support': 22955}, '1': {'precision': 0.821788249477743, 'recall': 0.873585822874315, 'f1-score': 0.8468957687343691, 'support': 90512}, '2': {'precision': 0.5819008832707463, 'recall': 0.48486183949583533, 'f1-score': 0.5289677388335977, 'support': 22691}, 'accuracy': 0.7484466575595998, 'macro avg': {'precision': 0.655449862416908, 'recall': 0.6246738704669542, 'f1-score': 0.6379841917631475, 'support': 136158}, 'weighted avg': {'precision': 0.7381239568157932, 'recall': 0.7484466575595998, 'f1-score': 0.7418504335485602, 'support': 136158}}
[[11835  8641  2479]
 [ 6016 79070  5426]
 [ 3183  8506 11002]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
4457/4457 - 76s - 76s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7260369
{'0': {'precision': 0.5090547479839842, 'recall': 0.5932750146233292, 'f1-score': 0.547947580295642, 'support': 229086}, '1': {'precision': 0.7888938821978548, 'recall': 0.7664567997182369, 'f1-score': 0.7775135052138465, 'support': 687102}, '2': {'precision': 0.5251245082650233, 'recall': 0.4822330282821182, 'f1-score': 0.502765647068646, 'support': 224771}, 'accuracy': 0.675692115141736, 'macro avg': {'precision': 0.6076910461489541, 'recall': 0.6139882808745615, 'f1-score': 0.6094089108593782, 'support': 1140959}, 'weighted avg': {'precision': 0.6807436911315893, 'recall': 0.675692115141736, 'f1-score': 0.6772945750866757, 'support': 1140959}}
[[135911  66250  26925]
 [ 89373 526634  71095]
 [ 41703  74676 108392]]
Evaluating performance on  train set...
2425/2425 - 41s - 41s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6345804
{'0': {'precision': 0.4912568661227939, 'recall': 0.5771040749897386, 'f1-score': 0.5307313818697357, 'support': 104761}, '1': {'precision': 0.8311098315538813, 'recall': 0.8245414870415778, 'f1-score': 0.8278126302410834, 'support': 413129}, '2': {'precision': 0.5404817493309038, 'recall': 0.4614330024210721, 'f1-score': 0.4978389946079768, 'support': 102847}, 'accuracy': 0.7226200468153179, 'macro avg': {'precision': 0.6209494823358597, 'recall': 0.6210261881507962, 'f1-score': 0.6187943355729321, 'support': 620737}, 'weighted avg': {'precision': 0.725600472704783, 'recall': 0.7226200468153179, 'f1-score': 0.723002820024214, 'support': 620737}}
[[ 60458  33451  10852]
 [ 42991 340642  29496]
 [ 19619  35771  47457]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6366397
{'0': {'precision': 0.5247069577373911, 'recall': 0.5519981898916764, 'f1-score': 0.5380066985514038, 'support': 35357}, '1': {'precision': 0.8170602301599164, 'recall': 0.8328052403077157, 'f1-score': 0.82485760627664, 'support': 131290}, '2': {'precision': 0.5370125140700523, 'recall': 0.4691540130151844, 'f1-score': 0.5007949861842207, 'support': 34575}, 'accuracy': 0.7209798133404897, 'macro avg': {'precision': 0.6262599006557866, 'recall': 0.6179858144048588, 'f1-score': 0.6212197636707548, 'support': 201222}, 'weighted avg': {'precision': 0.7175711860352666, 'recall': 0.7209798133404897, 'f1-score': 0.7187725229649913, 'support': 201222}}
[[ 19517  11938   3902]
 [ 11868 109339  10083]
 [  5811  12543  16221]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
4676/4676 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75163406
{'0': {'precision': 0.51461228634034, 'recall': 0.5525628076250942, 'f1-score': 0.5329127551543055, 'support': 249492}, '1': {'precision': 0.7602181264124974, 'recall': 0.7718350640556553, 'f1-score': 0.7659825519720523, 'support': 695567}, '2': {'precision': 0.5311930803671568, 'recall': 0.4699876949946414, 'f1-score': 0.49871954712403543, 'support': 251930}, 'accuracy': 0.6626017448781902, 'macro avg': {'precision': 0.6020078310399981, 'recall': 0.5981285222251304, 'f1-score': 0.5992049514167977, 'support': 1196989}, 'weighted avg': {'precision': 0.6608229171820991, 'recall': 0.6626017448781902, 'f1-score': 0.6611523333493129, 'support': 1196989}}
[[137860  81029  30603]
 [ 84809 536863  73895]
 [ 45222  88304 118404]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7107523
{'0': {'precision': 0.5264153096320928, 'recall': 0.5679463955962787, 'f1-score': 0.5463927991337305, 'support': 113722}, '1': {'precision': 0.7802091793708437, 'recall': 0.8018632884834955, 'f1-score': 0.7908880420930438, 'support': 312673}, '2': {'precision': 0.5601904282538485, 'recall': 0.4727024970357655, 'f1-score': 0.5127412682720826, 'support': 113014}, 'accuracy': 0.6835833291621015, 'macro avg': {'precision': 0.622271639085595, 'recall': 0.6141707270385132, 'f1-score': 0.6166740364996189, 'support': 539409}, 'weighted avg': {'precision': 0.6806054545661661, 'recall': 0.6835833291621015, 'f1-score': 0.6810660563337755, 'support': 539409}}
[[ 64588  34163  14971]
 [ 34981 250721  26971]
 [ 23125  36467  53422]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7541458
{'0': {'precision': 0.507249961942457, 'recall': 0.5725177723846138, 'f1-score': 0.537911272991434, 'support': 46561}, '1': {'precision': 0.7626979430701157, 'recall': 0.7739212259712327, 'f1-score': 0.7682685977616853, 'support': 111585}, '2': {'precision': 0.5618264174519706, 'recall': 0.46869502899211674, 'f1-score': 0.5110524384035235, 'support': 46047}, 'accuracy': 0.6591655933357167, 'macro avg': {'precision': 0.6105914408215144, 'recall': 0.6050446757826544, 'f1-score': 0.6057441030522143, 'support': 204193}, 'weighted avg': {'precision': 0.6591515698378129, 'recall': 0.6591655933357167, 'f1-score': 0.6577373851902801, 'support': 204193}}
[[26657 13335  6569]
 [14964 86358 10263]
 [10931 13534 21582]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
4274/4274 - 62s - 62s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94013745
{'0': {'precision': 0.4665911308343562, 'recall': 0.6470538861843209, 'f1-score': 0.5422007908296397, 'support': 297850}, '1': {'precision': 0.6996954251776687, 'recall': 0.5377560967861702, 'f1-score': 0.6081296505022654, 'support': 503667}, '2': {'precision': 0.4955242770967511, 'recall': 0.4978465072398376, 'f1-score': 0.49668267779772773, 'support': 292548}, 'accuracy': 0.5568398586921253, 'macro avg': {'precision': 0.553936944369592, 'recall': 0.5608854967367763, 'f1-score': 0.5490043730432109, 'support': 1094065}, 'weighted avg': {'precision': 0.5816403049618387, 'recall': 0.5568398586921253, 'f1-score': 0.5603806595152045, 'support': 1094065}}
[[192725  55221  49904]
 [134446 270850  98371]
 [ 85878  61026 145644]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83192426
{'0': {'precision': 0.4640813077313716, 'recall': 0.5987003443910299, 'f1-score': 0.52286495200467, 'support': 112953}, '1': {'precision': 0.7700979539790181, 'recall': 0.6678119323036713, 'f1-score': 0.7153168743270267, 'support': 278538}, '2': {'precision': 0.48990794408455507, 'recall': 0.5082368753813368, 'f1-score': 0.49890412266881934, 'support': 113089}, 'accuracy': 0.616576162352848, 'macro avg': {'precision': 0.5746957352649816, 'recall': 0.5915830506920127, 'f1-score': 0.5790286496668388, 'support': 504580}, 'weighted avg': {'precision': 0.6387968594596845, 'recall': 0.616576162352848, 'f1-score': 0.6237319449712215, 'support': 504580}}
[[ 67625  27271  18057]
 [ 50740 186011  41787]
 [ 27353  28260  57476]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8425576
{'0': {'precision': 0.4686244204018547, 'recall': 0.6120016147799863, 'f1-score': 0.5308013922929582, 'support': 42111}, '1': {'precision': 0.7557053442465094, 'recall': 0.6443944945653848, 'f1-score': 0.6956251973563938, 'support': 97431}, '2': {'precision': 0.4876871529323555, 'recall': 0.5050470736678637, 'f1-score': 0.49621532703150517, 'support': 41212}, 'accuracy': 0.6050765128295916, 'macro avg': {'precision': 0.5706723058602399, 'recall': 0.5871477276710783, 'f1-score': 0.5742139722269525, 'support': 180754}, 'weighted avg': {'precision': 0.6277146470311716, 'recall': 0.6050765128295916, 'f1-score': 0.6117599726263427, 'support': 180754}}
[[25772  9892  6447]
 [19229 62784 15418]
 [ 9994 10404 20814]]
testing model on single stock: results/universal/W4/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
12724/12724 - 180s - 180s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1572527
{'0': {'precision': 0.4119041439029806, 'recall': 0.6977871488284126, 'f1-score': 0.5180204982184012, 'support': 943805}, '1': {'precision': 0.6445447339083309, 'recall': 0.14859817303057618, 'f1-score': 0.24151554293010724, 'support': 1373422}, '2': {'precision': 0.4240232012301243, 'recall': 0.6052557664482083, 'f1-score': 0.4986840219445092, 'support': 939920}, 'accuracy': 0.439511940971654, 'macro avg': {'precision': 0.49349069301381193, 'recall': 0.4838803627690657, 'f1-score': 0.41940668769767253, 'support': 3257147}, 'weighted avg': {'precision': 0.5134975472001782, 'recall': 0.439511940971654, 'f1-score': 0.395848324386113, 'support': 3257147}}
[[658575  59377 225853]
 [622426 204088 546908]
 [317854  53174 568892]]
Evaluating performance on  train set...
5165/5165 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1801727
{'0': {'precision': 0.4309687150423336, 'recall': 0.7367856956727643, 'f1-score': 0.5438328155510305, 'support': 441321}, '1': {'precision': 0.637052549381511, 'recall': 0.0817756636754853, 'f1-score': 0.14494532650654954, 'support': 438957}, '2': {'precision': 0.47325977808246505, 'recall': 0.5476479322083001, 'f1-score': 0.5077437191465698, 'support': 441824}, 'accuracy': 0.4561062610902941, 'macro avg': {'precision': 0.5137603475021032, 'recall': 0.4554030971855165, 'f1-score': 0.3988406204013833, 'support': 1322102}, 'weighted avg': {'precision': 0.5135244847988769, 'recall': 0.4561062610902941, 'f1-score': 0.3993360335642378, 'support': 1322102}}
[[325159  10703 105459]
 [239213  35896 163848]
 [190112   9748 241964]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1344475
{'0': {'precision': 0.4457731706196696, 'recall': 0.7095410149704795, 'f1-score': 0.54754689568106, 'support': 164123}, '1': {'precision': 0.6558072114513499, 'recall': 0.11355550396255185, 'f1-score': 0.19359014131213828, 'support': 159367}, '2': {'precision': 0.46452270536764073, 'recall': 0.5629869732738059, 'f1-score': 0.5090370190140981, 'support': 163510}, 'accuracy': 0.46530390143737166, 'macro avg': {'precision': 0.5220343624795535, 'recall': 0.46202783073561243, 'f1-score': 0.4167246853357655, 'support': 487000}, 'weighted avg': {'precision': 0.5208003398432078, 'recall': 0.46530390143737166, 'f1-score': 0.4187876020315181, 'support': 487000}}
[[116452   4591  43080]
 [ 78235  18097  63035]
 [ 66549   4907  92054]]
training model: results/universal/W4/deepVOL_L3/h30
Epoch 1/50
9854/9854 - 501s - loss: 2.8894 - accuracy30: 0.5078 - val_loss: 3.2212 - val_accuracy30: 0.5067 - 501s/epoch - 51ms/step
Epoch 2/50
9854/9854 - 503s - loss: 2.7850 - accuracy30: 0.5367 - val_loss: 3.1827 - val_accuracy30: 0.5158 - 503s/epoch - 51ms/step
Epoch 3/50
9854/9854 - 509s - loss: 2.7577 - accuracy30: 0.5430 - val_loss: 3.1253 - val_accuracy30: 0.5221 - 509s/epoch - 52ms/step
Epoch 4/50
9854/9854 - 516s - loss: 2.7403 - accuracy30: 0.5463 - val_loss: 3.0680 - val_accuracy30: 0.5235 - 516s/epoch - 52ms/step
Epoch 5/50
9854/9854 - 498s - loss: 2.7286 - accuracy30: 0.5487 - val_loss: 3.0392 - val_accuracy30: 0.5292 - 498s/epoch - 51ms/step
Epoch 6/50
9854/9854 - 512s - loss: 2.7204 - accuracy30: 0.5505 - val_loss: 2.9842 - val_accuracy30: 0.5303 - 512s/epoch - 52ms/step
Epoch 7/50
9854/9854 - 496s - loss: 2.7141 - accuracy30: 0.5516 - val_loss: 2.9385 - val_accuracy30: 0.5309 - 496s/epoch - 50ms/step
Epoch 8/50
9854/9854 - 502s - loss: 2.7081 - accuracy30: 0.5529 - val_loss: 2.8992 - val_accuracy30: 0.5321 - 502s/epoch - 51ms/step
Epoch 9/50
9854/9854 - 500s - loss: 2.7039 - accuracy30: 0.5538 - val_loss: 2.8920 - val_accuracy30: 0.5342 - 500s/epoch - 51ms/step
Epoch 10/50
9854/9854 - 514s - loss: 2.6996 - accuracy30: 0.5549 - val_loss: 2.8848 - val_accuracy30: 0.5360 - 514s/epoch - 52ms/step
Epoch 11/50
9854/9854 - 507s - loss: 2.6960 - accuracy30: 0.5555 - val_loss: 2.8806 - val_accuracy30: 0.5329 - 507s/epoch - 51ms/step
Epoch 12/50
9854/9854 - 499s - loss: 2.6925 - accuracy30: 0.5560 - val_loss: 2.8786 - val_accuracy30: 0.5251 - 499s/epoch - 51ms/step
Epoch 13/50
9854/9854 - 528s - loss: 2.6896 - accuracy30: 0.5564 - val_loss: 2.8686 - val_accuracy30: 0.5298 - 528s/epoch - 54ms/step
Epoch 14/50
9854/9854 - 619s - loss: 2.6867 - accuracy30: 0.5570 - val_loss: 2.8426 - val_accuracy30: 0.5343 - 619s/epoch - 63ms/step
Epoch 15/50
9854/9854 - 627s - loss: 2.6840 - accuracy30: 0.5576 - val_loss: 2.8472 - val_accuracy30: 0.5365 - 627s/epoch - 64ms/step
Epoch 16/50
9854/9854 - 619s - loss: 2.6820 - accuracy30: 0.5580 - val_loss: 2.8742 - val_accuracy30: 0.5323 - 619s/epoch - 63ms/step
Epoch 17/50
9854/9854 - 621s - loss: 2.6799 - accuracy30: 0.5585 - val_loss: 2.8509 - val_accuracy30: 0.5339 - 621s/epoch - 63ms/step
Epoch 18/50
9854/9854 - 616s - loss: 2.6776 - accuracy30: 0.5590 - val_loss: 2.8450 - val_accuracy30: 0.5415 - 616s/epoch - 63ms/step
Epoch 19/50
9854/9854 - 613s - loss: 2.6756 - accuracy30: 0.5595 - val_loss: 2.8580 - val_accuracy30: 0.5349 - 613s/epoch - 62ms/step
Epoch 20/50
9854/9854 - 599s - loss: 2.6736 - accuracy30: 0.5597 - val_loss: 2.8715 - val_accuracy30: 0.5315 - 599s/epoch - 61ms/step
Epoch 21/50
9854/9854 - 583s - loss: 2.6715 - accuracy30: 0.5603 - val_loss: 2.8856 - val_accuracy30: 0.5317 - 583s/epoch - 59ms/step
Epoch 22/50
9854/9854 - 574s - loss: 2.6699 - accuracy30: 0.5605 - val_loss: 2.8865 - val_accuracy30: 0.5324 - 574s/epoch - 58ms/step
Epoch 23/50
9854/9854 - 559s - loss: 2.6683 - accuracy30: 0.5608 - val_loss: 2.8988 - val_accuracy30: 0.5293 - 559s/epoch - 57ms/step
Epoch 24/50
9854/9854 - 556s - loss: 2.6669 - accuracy30: 0.5611 - val_loss: 2.8920 - val_accuracy30: 0.5295 - 556s/epoch - 56ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 703s - 703s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9658225
{'0': {'precision': 0.40751855287015915, 'recall': 0.6543418344073079, 'f1-score': 0.5022438743077311, 'support': 1565214}, '1': {'precision': 0.7042103894674311, 'recall': 0.50540361535017, 'f1-score': 0.5884695041335256, 'support': 2936645}, '2': {'precision': 0.4660714138013747, 'recall': 0.4307517270023927, 'f1-score': 0.447716070799554, 'support': 1569772}, 'accuracy': 0.5244979479154778, 'macro avg': {'precision': 0.5259334520463216, 'recall': 0.5301657255866236, 'f1-score': 0.5128098164136036, 'support': 6071631}, 'weighted avg': {'precision': 0.5661568561685499, 'recall': 0.5244979479154778, 'f1-score': 0.5298505990133551, 'support': 6071631}}
[[1024185  296801  244228]
 [ 922052 1484191  530402]
 [ 566986  326604  676182]]
Evaluating performance on  train set...
9854/9854 - 300s - 300s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96019745
{'0': {'precision': 0.4316564027395794, 'recall': 0.6901347996085884, 'f1-score': 0.5311168502317865, 'support': 724557}, '1': {'precision': 0.7049230874644558, 'recall': 0.5175035839940085, 'f1-score': 0.5968459830277402, 'support': 1073523}, '2': {'precision': 0.5069193209265148, 'recall': 0.40297179734756655, 'f1-score': 0.4490079873544457, 'support': 723939}, 'accuracy': 0.5342231759554548, 'macro avg': {'precision': 0.5478329370435167, 'recall': 0.5368700603167212, 'f1-score': 0.5256569402046575, 'support': 2522019}, 'weighted avg': {'precision': 0.5695791673639679, 'recall': 0.5342231759554548, 'f1-score': 0.5355259874127322, 'support': 2522019}}
[[500042 112291 112224]
 [346432 555552 171539]
 [311952 120260 291727]]
Evaluating performance on  val set...
3566/3566 - 105s - 105s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9568104
{'0': {'precision': 0.4344621777501188, 'recall': 0.6783185485259183, 'f1-score': 0.5296708450138373, 'support': 261417}, '1': {'precision': 0.708475612509683, 'recall': 0.5209622748021017, 'f1-score': 0.6004192168534594, 'support': 391489}, '2': {'precision': 0.4896848839520554, 'recall': 0.4083123270352983, 'f1-score': 0.4453117939211272, 'support': 259446}, 'accuracy': 0.5340153800287608, 'macro avg': {'precision': 0.544207558070619, 'recall': 0.5358643834544394, 'f1-score': 0.5251339519294747, 'support': 912352}, 'weighted avg': {'precision': 0.5677446781379676, 'recall': 0.5340153800287608, 'f1-score': 0.5360396489111516, 'support': 912352}}
[[177324  40850  43243]
 [120383 203951  67155]
 [110439  43072 105935]]
testing model out of sample: results/universal/W4/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 369s - 369s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9490421
{'0': {'precision': 0.4486331469196164, 'recall': 0.6351937264589543, 'f1-score': 0.5258569747704376, 'support': 867899}, '1': {'precision': 0.662448103233859, 'recall': 0.5552326907461979, 'f1-score': 0.6041202992715916, 'support': 1315308}, '2': {'precision': 0.48715528872580866, 'recall': 0.40215926971423854, 'f1-score': 0.440595542470494, 'support': 848435}, 'accuracy': 0.5352848390410213, 'macro avg': {'precision': 0.5327455129597614, 'recall': 0.5308618956397969, 'f1-score': 0.5235242721708411, 'support': 3031642}, 'weighted avg': {'precision': 0.5521796923042993, 'recall': 0.5352848390410213, 'f1-score': 0.5359510404647251, 'support': 3031642}}
[[551284 177594 139021]
 [364828 730302 220178]
 [312696 194533 341206]]
Evaluating performance on  train set...
5528/5528 - 169s - 169s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8613279
{'0': {'precision': 0.4473186493185944, 'recall': 0.6048899392186727, 'f1-score': 0.514305915282158, 'support': 349943}, '1': {'precision': 0.7303473287058673, 'recall': 0.6847296294740968, 'f1-score': 0.7068031924078086, 'support': 714390}, '2': {'precision': 0.5039044945889598, 'recall': 0.3907137614207254, 'f1-score': 0.44014845249375417, 'support': 350131}, 'accuracy': 0.592197468440342, 'macro avg': {'precision': 0.5605234908711405, 'recall': 0.5601111100378316, 'f1-score': 0.5537525200612402, 'support': 1414464}, 'weighted avg': {'precision': 0.6042723200078676, 'recall': 0.592197468440342, 'f1-score': 0.5931720463411506, 'support': 1414464}}
[[211677  86990  51276]
 [141821 489164  83405]
 [119715  93615 136801]]
Evaluating performance on  val set...
1908/1908 - 58s - 58s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88120216
{'0': {'precision': 0.45248781892806567, 'recall': 0.600195799075128, 'f1-score': 0.5159789387972945, 'support': 125639}, '1': {'precision': 0.7104815454943388, 'recall': 0.6632208601878765, 'f1-score': 0.686038227495648, 'support': 237390}, '2': {'precision': 0.4982388342088843, 'recall': 0.39737374385976176, 'f1-score': 0.4421265081222036, 'support': 124588}, 'accuracy': 0.5790569237741916, 'macro avg': {'precision': 0.5537360662104297, 'recall': 0.5535968010409221, 'f1-score': 0.5480478914717154, 'support': 487617}, 'weighted avg': {'precision': 0.5897782707403982, 'recall': 0.5790569237741916, 'f1-score': 0.5799005164107779, 'support': 487617}}
[[ 75408  31075  19156]
 [ 49246 157442  30702]
 [ 41998  33082  49508]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1001259
{'0': {'precision': 0.4198092492708908, 'recall': 0.7160802089735709, 'f1-score': 0.5293069545896602, 'support': 52064}, '1': {'precision': 0.3829014289174134, 'recall': 0.04764631426677114, 'f1-score': 0.08474712551258343, 'support': 33182}, '2': {'precision': 0.4386065236287113, 'recall': 0.37299642079053846, 'f1-score': 0.40314950696970336, 'support': 51408}, 'accuracy': 0.4247076558315161, 'macro avg': {'precision': 0.41377240060567183, 'recall': 0.37890764801029353, 'f1-score': 0.3390678623573156, 'support': 136654}, 'weighted avg': {'precision': 0.41791874467693635, 'recall': 0.4247076558315161, 'f1-score': 0.3739006999927782, 'support': 136654}}
[[37282  1312 13470]
 [20528  1581 11073]
 [30997  1236 19175]]
Evaluating performance on  train set...
254/254 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2298511
{'0': {'precision': 0.3599366209411356, 'recall': 0.7771581216608867, 'f1-score': 0.4920041536863966, 'support': 21338}, '1': {'precision': 0.5816326530612245, 'recall': 0.028943359645478464, 'f1-score': 0.05514269381293698, 'support': 21663}, '2': {'precision': 0.4054312380524008, 'recall': 0.32874401641212675, 'f1-score': 0.36308250044057305, 'support': 21935}, 'accuracy': 0.3760779844770235, 'macro avg': {'precision': 0.44900017068492026, 'recall': 0.3782818325728306, 'f1-score': 0.30340978264663554, 'support': 64936}, 'weighted avg': {'precision': 0.44926342841546546, 'recall': 0.3760779844770235, 'f1-score': 0.30271583489272447, 'support': 64936}}
[[16583   233  4522]
 [14983   627  6053]
 [14506   218  7211]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.193622
{'0': {'precision': 0.3785938138710996, 'recall': 0.7760089372992599, 'f1-score': 0.5089060854434727, 'support': 7161}, '1': {'precision': 0.45517241379310347, 'recall': 0.031363852368129254, 'f1-score': 0.058684054534676934, 'support': 6313}, '2': {'precision': 0.4171511627906977, 'recall': 0.3214335713285734, 'f1-score': 0.36309006088400414, 'support': 7143}, 'accuracy': 0.39050298297521463, 'macro avg': {'precision': 0.4169724634849669, 'recall': 0.3762687869986541, 'f1-score': 0.3102267336207179, 'support': 20617}, 'weighted avg': {'precision': 0.415401101286354, 'recall': 0.39050298297521463, 'f1-score': 0.3205268088971511, 'support': 20617}}
[[5557  116 1488]
 [4395  198 1720]
 [4726  121 2296]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
1613/1613 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.55223227
{'0': {'precision': 0.573793548684605, 'recall': 0.4468344884547707, 'f1-score': 0.5024176046030384, 'support': 55694}, '1': {'precision': 0.8384609118309936, 'recall': 0.9248817697430385, 'f1-score': 0.8795536115559662, 'support': 300473}, '2': {'precision': 0.6063625607992639, 'recall': 0.40688401961822096, 'f1-score': 0.48698755239291786, 'support': 56682}, 'accuracy': 0.7892740445053761, 'macro avg': {'precision': 0.6728723404382874, 'recall': 0.59286675927201, 'f1-score': 0.6229862561839742, 'support': 412849}, 'weighted avg': {'precision': 0.7708909701422515, 'recall': 0.7892740445053761, 'f1-score': 0.7747800935464365, 'support': 412849}}
[[ 24886  25346   5462]
 [ 13061 277902   9510]
 [  5424  28195  23063]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6403007
{'0': {'precision': 0.5428208155480883, 'recall': 0.4661882848451759, 'f1-score': 0.5015944947969118, 'support': 25642}, '1': {'precision': 0.8116966527716775, 'recall': 0.8854345585709378, 'f1-score': 0.8469637027909289, 'support': 110618}, '2': {'precision': 0.5514694568395138, 'recall': 0.41471881508909975, 'f1-score': 0.47341655108645403, 'support': 25926}, 'accuracy': 0.7439051459435463, 'macro avg': {'precision': 0.6353289750530932, 'recall': 0.5887805528350711, 'f1-score': 0.6073249162247649, 'support': 162186}, 'weighted avg': {'precision': 0.7275885022542188, 'recall': 0.7439051459435463, 'f1-score': 0.7326471730875463, 'support': 162186}}
[[11954 11038  2650]
 [ 6578 97945  6095]
 [ 3490 11684 10752]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.577964
{'0': {'precision': 0.5509522874533673, 'recall': 0.42624943035090385, 'f1-score': 0.48064405618362455, 'support': 6583}, '1': {'precision': 0.8445872513348769, 'recall': 0.911125270804129, 'f1-score': 0.8765954316401221, 'support': 39235}, '2': {'precision': 0.5315383167011862, 'recall': 0.4084201388888889, 'f1-score': 0.4619160598870981, 'support': 6912}, 'accuracy': 0.7846956191921107, 'macro avg': {'precision': 0.6423592851631434, 'recall': 0.5819316133479738, 'f1-score': 0.6063851825702816, 'support': 52730}, 'weighted avg': {'precision': 0.7668934678450221, 'recall': 0.7846956191921107, 'f1-score': 0.7728060949781266, 'support': 52730}}
[[ 2806  3152   625]
 [ 1624 35748  1863]
 [  663  3426  2823]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
989/989 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1688787
{'0': {'precision': 0.3712729194036671, 'recall': 0.6705827734289362, 'f1-score': 0.47793418168282026, 'support': 77543}, '1': {'precision': 0.5772773797338793, 'recall': 0.12933458294283037, 'f1-score': 0.21132370549568702, 'support': 100298}, '2': {'precision': 0.39322438689989164, 'recall': 0.473378766904483, 'f1-score': 0.4295947333454128, 'support': 75128}, 'accuracy': 0.39742023726227327, 'macro avg': {'precision': 0.447258228679146, 'recall': 0.4244320410920832, 'f1-score': 0.3729508735079734, 'support': 252969}, 'weighted avg': {'precision': 0.45946951745424236, 'recall': 0.39742023726227327, 'f1-score': 0.35787147196222274, 'support': 252969}}
[[51999  5175 20369]
 [52817 12972 34509]
 [35240  4324 35564]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1155688
{'0': {'precision': 0.4042740218389233, 'recall': 0.7109584335279973, 'f1-score': 0.515447741678393, 'support': 29110}, '1': {'precision': 0.5845624385447394, 'recall': 0.16986320940033572, 'f1-score': 0.2632350906323509, 'support': 27999}, '2': {'precision': 0.4418476463454966, 'recall': 0.40852104780348586, 'f1-score': 0.4245312996504607, 'support': 29433}, 'accuracy': 0.4330382935453306, 'macro avg': {'precision': 0.47689470224305314, 'recall': 0.4297808969106063, 'f1-score': 0.40107137732040155, 'support': 86542}, 'weighted avg': {'precision': 0.47538169059453467, 'recall': 0.4330382935453306, 'f1-score': 0.4029284371228447, 'support': 86542}}
[[20696  1643  6771]
 [14825  4756  8418]
 [15672  1737 12024]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.133299
{'0': {'precision': 0.399373973727422, 'recall': 0.7213160333642261, 'f1-score': 0.5141026487878988, 'support': 10790}, '1': {'precision': 0.47586872586872586, 'recall': 0.1038660065311282, 'f1-score': 0.17051448335495026, 'support': 9493}, '2': {'precision': 0.4592860008022463, 'recall': 0.40714730198239846, 'f1-score': 0.431647895952123, 'support': 11249}, 'accuracy': 0.4233477102625904, 'macro avg': {'precision': 0.44484290013279804, 'recall': 0.4107764472925843, 'f1-score': 0.37208834269832397, 'support': 31532}, 'weighted avg': {'precision': 0.44377696353593704, 'recall': 0.4233477102625904, 'f1-score': 0.38124663048570984, 'support': 31532}}
[[7783  517 2490]
 [5605  986 2902]
 [6100  569 4580]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3640357
{'0': {'precision': 0.30354178456894926, 'recall': 0.9000055933104008, 'f1-score': 0.45397349358499617, 'support': 71514}, '1': {'precision': 0.47795044099118017, 'recall': 0.011340534938414318, 'f1-score': 0.022155379688306127, 'support': 100348}, '2': {'precision': 0.2735599155928703, 'recall': 0.09398136722606121, 'f1-score': 0.13990012054417084, 'support': 64832}, 'accuracy': 0.3024749254311474, 'macro avg': {'precision': 0.3516840470509999, 'recall': 0.3351091651582921, 'f1-score': 0.2053429979391577, 'support': 236694}, 'weighted avg': {'precision': 0.3692712721148984, 'recall': 0.3024749254311474, 'f1-score': 0.184874619028447, 'support': 236694}}
[[64363   610  6541]
 [89571  1138  9639]
 [58106   633  6093]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2786165
{'0': {'precision': 0.33883480377243685, 'recall': 0.8899320815021974, 'f1-score': 0.49080092541588627, 'support': 30036}, '1': {'precision': 0.30699774266365687, 'recall': 0.009275046034235832, 'f1-score': 0.01800609029524692, 'support': 29326}, '2': {'precision': 0.3482264665757162, 'recall': 0.10486852917009039, 'f1-score': 0.16119355857278184, 'support': 29208}, 'accuracy': 0.3394490233713447, 'macro avg': {'precision': 0.33135300433726994, 'recall': 0.3346918855688412, 'f1-score': 0.223333524761305, 'support': 88570}, 'weighted avg': {'precision': 0.3313905002055644, 'recall': 0.3394490233713447, 'f1-score': 0.22556040034530633, 'support': 88570}}
[[26730   296  3010]
 [26331   272  2723]
 [25827   318  3063]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2817881
{'0': {'precision': 0.33642602058679366, 'recall': 0.8794618341570566, 'f1-score': 0.4866794975688817, 'support': 10926}, '1': {'precision': 0.24331550802139038, 'recall': 0.008444691907943579, 'f1-score': 0.01632286995515695, 'support': 10776}, '2': {'precision': 0.3331334332833583, 'recall': 0.10511874349512726, 'f1-score': 0.15981012658227847, 'support': 10569}, 'accuracy': 0.3350066623284063, 'macro avg': {'precision': 0.30429165396384744, 'recall': 0.33100842318670914, 'f1-score': 0.22093749803543902, 'support': 32271}, 'weighted avg': {'precision': 0.3042560153618303, 'recall': 0.3350066623284063, 'f1-score': 0.22256480012774543, 'support': 32271}}
[[9609  136 1181]
 [9642   91 1043]
 [9311  147 1111]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
1590/1590 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1845641
{'0': {'precision': 0.3752916937016927, 'recall': 0.7617078298639188, 'f1-score': 0.5028368361650856, 'support': 129849}, '1': {'precision': 0.5736761522622882, 'recall': 0.07192263650143302, 'f1-score': 0.12782025644041875, 'support': 151079}, '2': {'precision': 0.4205466359321163, 'recall': 0.41534263526537474, 'f1-score': 0.4179284363102317, 'support': 126067}, 'accuracy': 0.3983685303259254, 'macro avg': {'precision': 0.45650482729869907, 'recall': 0.4163243672102422, 'f1-score': 0.3495285096385787, 'support': 406995}, 'weighted avg': {'precision': 0.46295095343962317, 'recall': 0.3983685303259254, 'f1-score': 0.3373279795631008, 'support': 406995}}
[[98907  3922 27020]
 [95087 10866 45126]
 [69553  4153 52361]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1729974
{'0': {'precision': 0.39124908228229544, 'recall': 0.7725177957117203, 'f1-score': 0.519428563115553, 'support': 46219}, '1': {'precision': 0.5399878517918607, 'recall': 0.05898485016034502, 'f1-score': 0.10635243450173465, 'support': 45215}, '2': {'precision': 0.445275011453787, 'recall': 0.39939439818319455, 'f1-score': 0.42108863703737487, 'support': 46235}, 'accuracy': 0.41285983046292196, 'macro avg': {'precision': 0.4588373151759811, 'recall': 0.41029901468508667, 'f1-score': 0.34895654488488753, 'support': 137669}, 'weighted avg': {'precision': 0.4582439198900278, 'recall': 0.41285983046292196, 'f1-score': 0.3507342046361687, 'support': 137669}}
[[35705  1102  9412]
 [28955  2667 13593]
 [26599  1170 18466]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.205848
{'0': {'precision': 0.3806980463840969, 'recall': 0.7636207390432541, 'f1-score': 0.5080907999313855, 'support': 17455}, '1': {'precision': 0.5107646622123236, 'recall': 0.03722943722943723, 'f1-score': 0.06940031270489735, 'support': 18480}, '2': {'precision': 0.4275375007295862, 'recall': 0.4172125078316341, 'f1-score': 0.422311905448256, 'support': 17557}, 'accuracy': 0.39897554774545724, 'macro avg': {'precision': 0.4396667364420022, 'recall': 0.4060208947014418, 'f1-score': 0.33326767269484625, 'support': 53492}, 'weighted avg': {'precision': 0.4410059683247495, 'recall': 0.39897554774545724, 'f1-score': 0.32838130590637604, 'support': 53492}}
[[13329   350  3776]
 [11760   688  6032]
 [ 9923   309  7325]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
3782/3782 - 56s - 56s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68414634
{'0': {'precision': 0.5216466790430179, 'recall': 0.5216984094627873, 'f1-score': 0.5216725429704714, 'support': 181511}, '1': {'precision': 0.7669546299616418, 'recall': 0.857100043270874, 'f1-score': 0.8095255133480431, 'support': 593933}, '2': {'precision': 0.60815448194912, 'recall': 0.3875631142601866, 'f1-score': 0.47342388217862935, 'support': 192508}, 'accuracy': 0.70082297469296, 'macro avg': {'precision': 0.6322519303179265, 'recall': 0.5887871889979494, 'f1-score': 0.6015406461657146, 'support': 967952}, 'weighted avg': {'precision': 0.6893718672081324, 'recall': 0.70082297469296, 'f1-score': 0.6887026488678158, 'support': 967952}}
[[ 94694  71271  15546]
 [ 52347 509060  32526]
 [ 34488  83411  74609]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7162134
{'0': {'precision': 0.5620348908137124, 'recall': 0.5037505193867955, 'f1-score': 0.5312990128240613, 'support': 91454}, '1': {'precision': 0.7182755193579726, 'recall': 0.8493507636779788, 'f1-score': 0.7783332896363537, 'support': 227190}, '2': {'precision': 0.6063450188557996, 'recall': 0.39354392589015236, 'f1-score': 0.47729980497999874, 'support': 91108}, 'accuracy': 0.6708667681914915, 'macro avg': {'precision': 0.6288851430091617, 'recall': 0.5822150696516423, 'f1-score': 0.5956440358134713, 'support': 409752}, 'weighted avg': {'precision': 0.6585159709417631, 'recall': 0.6708667681914915, 'f1-score': 0.6562623016444401, 'support': 409752}}
[[ 46070  36434   8950]
 [ 19898 192964  14328]
 [ 16002  39251  35855]]
Evaluating performance on  val set...
532/532 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67149603
{'0': {'precision': 0.5603952070632752, 'recall': 0.4907584683357879, 'f1-score': 0.5232701933457651, 'support': 27160}, '1': {'precision': 0.752027239392352, 'recall': 0.8740563050996055, 'f1-score': 0.8084629506571908, 'support': 82124}, '2': {'precision': 0.6134255155705253, 'recall': 0.38628414080523926, 'f1-score': 0.4740507340685434, 'support': 26874}, 'accuracy': 0.7013249313297787, 'macro avg': {'precision': 0.6419493206753842, 'recall': 0.583699638080211, 'f1-score': 0.6019279593571664, 'support': 136158}, 'weighted avg': {'precision': 0.6864452778179643, 'recall': 0.7013249313297787, 'f1-score': 0.685570214298096, 'support': 136158}}
[[13329 11510  2321]
 [ 6122 71781  4221]
 [ 4334 12159 10381]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
4457/4457 - 66s - 66s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7878264
{'0': {'precision': 0.5252392645296806, 'recall': 0.5305960057082658, 'f1-score': 0.5279040465048858, 'support': 267682}, '1': {'precision': 0.7072966329237345, 'recall': 0.7852134784428632, 'f1-score': 0.7442212219526539, 'support': 611584}, '2': {'precision': 0.5381126363588914, 'recall': 0.39396162679169866, 'f1-score': 0.4548902120750172, 'support': 261693}, 'accuracy': 0.6357388828169986, 'macro avg': {'precision': 0.5902161779374354, 'recall': 0.5699237036476092, 'f1-score': 0.5756718268441856, 'support': 1140959}, 'weighted avg': {'precision': 0.6257794635079179, 'recall': 0.6357388828169986, 'f1-score': 0.6271091135192064, 'support': 1140959}}
[[142031  95261  30390]
 [ 73257 480224  58103]
 [ 55124 103472 103097]]
Evaluating performance on  train set...
2425/2425 - 35s - 35s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70500433
{'0': {'precision': 0.5116894538407042, 'recall': 0.5124656450573738, 'f1-score': 0.512077255317415, 'support': 122617}, '1': {'precision': 0.7620099154551768, 'recall': 0.8450450594019171, 'f1-score': 0.8013823103070022, 'support': 376503}, '2': {'precision': 0.5614894781354162, 'recall': 0.37121455059736713, 'f1-score': 0.44694363457264347, 'support': 121617}, 'accuracy': 0.6865145786379739, 'macro avg': {'precision': 0.6117296158104324, 'recall': 0.5762417516855527, 'f1-score': 0.5868010667323535, 'support': 620737}, 'weighted avg': {'precision': 0.6732763003052838, 'recall': 0.6865145786379739, 'f1-score': 0.6747916827877087, 'support': 620737}}
[[ 62837  48128  11652]
 [ 34735 318162  23606]
 [ 25231  51240  45146]]
Evaluating performance on  val set...
787/787 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7141562
{'0': {'precision': 0.537481379016812, 'recall': 0.48917780360255664, 'f1-score': 0.5121932670857837, 'support': 41304}, '1': {'precision': 0.7443194368769052, 'recall': 0.8473654210464551, 'f1-score': 0.7925068205337263, 'support': 119298}, '2': {'precision': 0.5490365257405809, 'recall': 0.375972427375677, 'f1-score': 0.44631480507335314, 'support': 40620}, 'accuracy': 0.6786832453707845, 'macro avg': {'precision': 0.6102791138780993, 'recall': 0.5708385506748962, 'f1-score': 0.5836716308976211, 'support': 201222}, 'weighted avg': {'precision': 0.6624415557694181, 'recall': 0.6786832453707845, 'f1-score': 0.6650834240879392, 'support': 201222}}
[[ 20205  16919   4180]
 [  9845 101089   8364]
 [  7542  17806  15272]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
4676/4676 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.822305
{'0': {'precision': 0.517696575473503, 'recall': 0.5166499036838785, 'f1-score': 0.5171727100067063, 'support': 293305}, '1': {'precision': 0.6719376026041981, 'recall': 0.7860342785423159, 'f1-score': 0.7245215021199273, 'support': 608719}, '2': {'precision': 0.5603342421278279, 'recall': 0.3651077246452969, 'f1-score': 0.44212898815791907, 'support': 294965}, 'accuracy': 0.6162997320777384, 'macro avg': {'precision': 0.5833228067351763, 'recall': 0.5559306356238304, 'f1-score': 0.5612744000948509, 'support': 1196989}, 'weighted avg': {'precision': 0.6066414723260742, 'recall': 0.6162997320777384, 'f1-score': 0.6041257880811416, 'support': 1196989}}
[[151536 111237  30532]
 [ 76275 478474  53970]
 [ 64901 122370 107694]]
Evaluating performance on  train set...
2108/2108 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7847673
{'0': {'precision': 0.5326350756909262, 'recall': 0.530302343844388, 'f1-score': 0.531466150050703, 'support': 132432}, '1': {'precision': 0.6988958000633811, 'recall': 0.8172557112131605, 'f1-score': 0.7534558121619132, 'support': 275248}, '2': {'precision': 0.5792870062430714, 'recall': 0.37684944089760036, 'f1-score': 0.45663772168665834, 'support': 131729}, 'accuracy': 0.6392533309603659, 'macro avg': {'precision': 0.603605960665793, 'recall': 0.5748024986517163, 'f1-score': 0.5805198946330915, 'support': 539409}, 'weighted avg': {'precision': 0.6288669591444336, 'recall': 0.6392533309603659, 'f1-score': 0.626468525756001, 'support': 539409}}
[[ 70229  46167  16036]
 [ 30283 224948  20017]
 [ 31340  50747  49642]]
Evaluating performance on  val set...
798/798 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8201172
{'0': {'precision': 0.5159614354579539, 'recall': 0.5390799880614834, 'f1-score': 0.5272674195843747, 'support': 53608}, '1': {'precision': 0.6719369655977896, 'recall': 0.7933887699654207, 'f1-score': 0.7276296726270534, 'support': 97168}, '2': {'precision': 0.5902188209972498, 'recall': 0.36962015837654677, 'f1-score': 0.4545695242261336, 'support': 53417}, 'accuracy': 0.6157654767793215, 'macro avg': {'precision': 0.5927057406843311, 'recall': 0.5673629721344836, 'f1-score': 0.5698222054791872, 'support': 204193}, 'weighted avg': {'precision': 0.6096102729596318, 'recall': 0.6157654767793215, 'f1-score': 0.6035946978324039, 'support': 204193}}
[[28899 18290  6419]
 [12787 77092  7289]
 [14324 19349 19744]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
4274/4274 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95963746
{'0': {'precision': 0.4741484804128528, 'recall': 0.6492556366485601, 'f1-score': 0.548054914239851, 'support': 340761}, '1': {'precision': 0.5951298916136204, 'recall': 0.5364212183746258, 'f1-score': 0.5642525533890437, 'support': 419165}, '2': {'precision': 0.5242966956814331, 'recall': 0.39171422671403217, 'f1-score': 0.4484105368099735, 'support': 334139}, 'accuracy': 0.5273699460269728, 'macro avg': {'precision': 0.5311916892359688, 'recall': 0.5257970272457394, 'f1-score': 0.520239334812956, 'support': 1094065}, 'weighted avg': {'precision': 0.5358154268260895, 'recall': 0.5273699460269728, 'f1-score': 0.5238282099617044, 'support': 1094065}}
[[221241  71665  47855]
 [123415 224849  70901]
 [121951  81301 130887]]
Evaluating performance on  train set...
1972/1972 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8776224
{'0': {'precision': 0.4685025987750839, 'recall': 0.5801896539848002, 'f1-score': 0.5183987198511963, 'support': 130659}, '1': {'precision': 0.685123320178059, 'recall': 0.6700794205999753, 'f1-score': 0.6775178703680588, 'support': 243010}, '2': {'precision': 0.5144292524191476, 'recall': 0.4129981437770699, 'f1-score': 0.4581670268208974, 'support': 130911}, 'accuracy': 0.5801042451147489, 'macro avg': {'precision': 0.5560183904574302, 'recall': 0.5544224061206151, 'f1-score': 0.5513612056800509, 'support': 504580}, 'weighted avg': {'precision': 0.5847444348830054, 'recall': 0.5801042451147489, 'f1-score': 0.5794050094401877, 'support': 504580}}
[[ 75807  35839  19013]
 [ 48154 162836  32020]
 [ 37846  38999  54066]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89142805
{'0': {'precision': 0.47739681153090197, 'recall': 0.5808007521102005, 'f1-score': 0.5240466179833296, 'support': 48929}, '1': {'precision': 0.6635672329328036, 'recall': 0.6497267498747107, 'f1-score': 0.6565740606762167, 'support': 83806}, '2': {'precision': 0.5112206081339835, 'recall': 0.41700160353193527, 'f1-score': 0.4593292654952516, 'support': 48019}, 'accuracy': 0.5692432809232437, 'macro avg': {'precision': 0.550728217532563, 'recall': 0.5491763685056156, 'f1-score': 0.5466499813849327, 'support': 180754}, 'weighted avg': {'precision': 0.5726997272345165, 'recall': 0.5692432809232438, 'f1-score': 0.5682997593422765, 'support': 180754}}
[[28418 13199  7312]
 [17522 54451 11833]
 [13587 14408 20024]]
testing model on single stock: results/universal/W4/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
12724/12724 - 179s - 179s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1256589
{'0': {'precision': 0.385944908418009, 'recall': 0.7147852448634225, 'f1-score': 0.5012449691597114, 'support': 963190}, '1': {'precision': 0.5463322114392944, 'recall': 0.1629122123776977, 'f1-score': 0.2509831202613488, 'support': 1333172}, '2': {'precision': 0.43180734360286277, 'recall': 0.4834713281327248, 'f1-score': 0.45618121858617916, 'support': 960785}, 'accuracy': 0.4206675351158545, 'macro avg': {'precision': 0.4546948211533888, 'recall': 0.4537229284579483, 'f1-score': 0.40280310266907976, 'support': 3257147}, 'weighted avg': {'precision': 0.46512088706821203, 'recall': 0.4206675351158545, 'f1-score': 0.3855183331760364, 'support': 3257147}}
[[688474  88487 186229]
 [690984 217190 424998]
 [404408  91865 464512]]
Evaluating performance on  train set...
5165/5165 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.125864
{'0': {'precision': 0.40840586995336, 'recall': 0.774131278469549, 'f1-score': 0.5347142940297638, 'support': 444993}, '1': {'precision': 0.5156594676705634, 'recall': 0.09054578432577741, 'f1-score': 0.15404284536131288, 'support': 431141}, '2': {'precision': 0.4773413747316432, 'recall': 0.4312596419474043, 'f1-score': 0.4531319392660708, 'support': 445968}, 'accuracy': 0.43555565304341115, 'macro avg': {'precision': 0.4671355707851889, 'recall': 0.4319789015809102, 'f1-score': 0.3806296928857158, 'support': 1322102}, 'weighted avg': {'precision': 0.4666346999289248, 'recall': 0.43555565304341115, 'f1-score': 0.38305716875529994, 'support': 1322102}}
[[344483  18382  82128]
 [263644  39038 128459]
 [235355  18285 192328]]
Evaluating performance on  val set...
1903/1903 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1135873
{'0': {'precision': 0.41548152741492245, 'recall': 0.7515875934779943, 'f1-score': 0.5351367039604761, 'support': 163140}, '1': {'precision': 0.5485456311789245, 'recall': 0.11837026623752975, 'f1-score': 0.19472168127231415, 'support': 162186}, '2': {'precision': 0.4578969844922206, 'recall': 0.44434479260734566, 'f1-score': 0.45101910768042736, 'support': 161674}, 'accuracy': 0.4387084188911704, 'macro avg': {'precision': 0.47397471436202254, 'recall': 0.43810088410762327, 'f1-score': 0.3936258309710725, 'support': 487000}, 'weighted avg': {'precision': 0.47387703324774283, 'recall': 0.4387084188911704, 'f1-score': 0.3938427016387454, 'support': 487000}}
[[122614   7832  32694]
 [ 90632  19198  52356]
 [ 81867   7968  71839]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        76 (peak)  17.51 (ave)

============================================
