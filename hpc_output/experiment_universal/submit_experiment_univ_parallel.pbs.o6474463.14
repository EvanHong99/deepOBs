This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W4/deepLOB_L1/h300
Epoch 1/50
9854/9854 - 172s - loss: 3.2371 - accuracy300: 0.4048 - val_loss: 3.3577 - val_accuracy300: 0.3108 - 172s/epoch - 17ms/step
Epoch 2/50
9854/9854 - 154s - loss: 3.2143 - accuracy300: 0.4176 - val_loss: 3.3921 - val_accuracy300: 0.3195 - 154s/epoch - 16ms/step
Epoch 3/50
9854/9854 - 157s - loss: 3.2047 - accuracy300: 0.4228 - val_loss: 3.4118 - val_accuracy300: 0.3243 - 157s/epoch - 16ms/step
Epoch 4/50
9854/9854 - 154s - loss: 3.1935 - accuracy300: 0.4280 - val_loss: 3.4453 - val_accuracy300: 0.3249 - 154s/epoch - 16ms/step
Epoch 5/50
9854/9854 - 154s - loss: 3.1871 - accuracy300: 0.4304 - val_loss: 3.5055 - val_accuracy300: 0.3319 - 154s/epoch - 16ms/step
Epoch 6/50
9854/9854 - 155s - loss: 3.1819 - accuracy300: 0.4323 - val_loss: 3.4968 - val_accuracy300: 0.3337 - 155s/epoch - 16ms/step
Epoch 7/50
9854/9854 - 157s - loss: 3.1780 - accuracy300: 0.4339 - val_loss: 3.5839 - val_accuracy300: 0.3403 - 157s/epoch - 16ms/step
Epoch 8/50
9854/9854 - 154s - loss: 3.1739 - accuracy300: 0.4354 - val_loss: 3.6285 - val_accuracy300: 0.3426 - 154s/epoch - 16ms/step
Epoch 9/50
9854/9854 - 158s - loss: 3.1709 - accuracy300: 0.4365 - val_loss: 3.7444 - val_accuracy300: 0.3439 - 158s/epoch - 16ms/step
Epoch 10/50
9854/9854 - 153s - loss: 3.1687 - accuracy300: 0.4374 - val_loss: 3.6901 - val_accuracy300: 0.3428 - 153s/epoch - 16ms/step
Epoch 11/50
9854/9854 - 159s - loss: 3.1657 - accuracy300: 0.4387 - val_loss: 3.6409 - val_accuracy300: 0.3445 - 159s/epoch - 16ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 152s - 152s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000532
{'0': {'precision': 0.3138763497079487, 'recall': 0.2520114722066695, 'f1-score': 0.2795622662920297, 'support': 1837833}, '1': {'precision': 0.3911067564210557, 'recall': 0.6757114810890749, 'f1-score': 0.4954458338882794, 'support': 2336956}, '2': {'precision': 0.3150759986177186, 'recall': 0.09276945575857135, 'f1-score': 0.1433358082122265, 'support': 1896842}, 'accuracy': 0.36534367783549426, 'macro avg': {'precision': 0.34001970158224104, 'recall': 0.34016413635143855, 'f1-score': 0.30611463613084516, 'support': 6071631}, 'weighted avg': {'precision': 0.3439769284137267, 'recall': 0.36534367783549426, 'f1-score': 0.3200967341143416, 'support': 6071631}}
[[ 463155 1208942  165736]
 [ 541056 1579108  216792]
 [ 471386 1249487  175969]]
Evaluating performance on  train set...
9854/9854 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118723
{'0': {'precision': 0.3415299625501386, 'recall': 0.2265803104539586, 'f1-score': 0.2724258603342706, 'support': 849659}, '1': {'precision': 0.32366356449753947, 'recall': 0.6576214820402011, 'f1-score': 0.4338150544905912, 'support': 823311}, '2': {'precision': 0.338815651223715, 'recall': 0.11393924261143938, 'f1-score': 0.17053111611152388, 'support': 849049}, 'accuracy': 0.32937222122434445, 'macro avg': {'precision': 0.33466972609046436, 'recall': 0.332713678368533, 'f1-score': 0.2922573436454619, 'support': 2522019}, 'weighted avg': {'precision': 0.3347837067271364, 'recall': 0.32937222122434445, 'f1-score': 0.29080790588684396, 'support': 2522019}}
[[192516 563933  93210]
 [186310 541427  95574]
 [184861 567448  96740]]
Evaluating performance on  val set...
3566/3566 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209261
{'0': {'precision': 0.30144370814813093, 'recall': 0.16930928953912439, 'f1-score': 0.21683226793387633, 'support': 306829}, '1': {'precision': 0.3097543780990334, 'recall': 0.6972885216184541, 'f1-score': 0.42895525588852523, 'support': 301201}, '2': {'precision': 0.3457666494579246, 'recall': 0.07042540467005343, 'f1-score': 0.1170169202797661, 'support': 304322}, 'accuracy': 0.3106312037459226, 'macro avg': {'precision': 0.31898824523502967, 'recall': 0.31234107194254396, 'f1-score': 0.2542681480340559, 'support': 912352}, 'weighted avg': {'precision': 0.3189716230813593, 'recall': 0.3106312037459226, 'f1-score': 0.25356770542525475, 'support': 912352}}
[[ 51949 234094  20786]
 [ 71411 210024  19766]
 [ 48974 233916  21432]]
testing model out of sample: results/universal/W4/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1058303
{'0': {'precision': 0.31076373323770123, 'recall': 0.20172912459819523, 'f1-score': 0.2446476859311952, 'support': 962221}, '1': {'precision': 0.37560324710908477, 'recall': 0.6781177706122045, 'f1-score': 0.4834358094424702, 'support': 1150253}, '2': {'precision': 0.32995507767566323, 'recall': 0.11858550341178109, 'f1-score': 0.17446755383684562, 'support': 919168}, 'accuracy': 0.3572700866395175, 'macro avg': {'precision': 0.3387740193408164, 'recall': 0.33281079954072695, 'f1-score': 0.30085034973683705, 'support': 3031642}, 'weighted avg': {'precision': 0.3411835239100343, 'recall': 0.3572700866395175, 'f1-score': 0.31396966516763386, 'support': 3031642}}
[[194108 664188 103925]
 [252823 780007 117423]
 [177685 632483 109000]]
Evaluating performance on  train set...
5528/5528 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1097829
{'0': {'precision': 0.3453813189045566, 'recall': 0.2297536438614743, 'f1-score': 0.2759443319472998, 'support': 466195}, '1': {'precision': 0.33044563867271665, 'recall': 0.6694641428039527, 'f1-score': 0.44248293263145094, 'support': 467326}, '2': {'precision': 0.3540589082739406, 'recall': 0.11599711400311472, 'f1-score': 0.17474432663544814, 'support': 480943}, 'accuracy': 0.3363507307361658, 'macro avg': {'precision': 0.3432952886170713, 'recall': 0.3384049668895139, 'f1-score': 0.2977238637380663, 'support': 1414464}, 'weighted avg': {'precision': 0.3433972416597874, 'recall': 0.3363507307361658, 'f1-score': 0.2965573584708619, 'support': 1414464}}
[[107110 308378  50707]
 [103396 312858  51072]
 [ 99615 325540  55788]]
Evaluating performance on  val set...
1908/1908 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158882
{'0': {'precision': 0.3361356562801846, 'recall': 0.17214045801526717, 'f1-score': 0.22768154630889834, 'support': 163750}, '1': {'precision': 0.33667963598356127, 'recall': 0.7430001630326488, 'f1-score': 0.46338372664468663, 'support': 165611}, '2': {'precision': 0.353239289446186, 'recall': 0.08544383783237286, 'f1-score': 0.13760328896487156, 'support': 158256}, 'accuracy': 0.3378860868263412, 'macro avg': {'precision': 0.3420181939033106, 'recall': 0.33352815296009625, 'f1-score': 0.27622285397281887, 'support': 487617}, 'weighted avg': {'precision': 0.34187139066388045, 'recall': 0.3378860868263412, 'f1-score': 0.27849898928843747, 'support': 487617}}
[[ 28188 123924  11638]
 [ 29442 123049  13120]
 [ 26229 118505  13522]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1281476
{'0': {'precision': 0.36872740928507725, 'recall': 0.15228475601481165, 'f1-score': 0.21554799407277314, 'support': 51581}, '1': {'precision': 0.27378055735087253, 'recall': 0.7568114342765561, 'f1-score': 0.40209948838929876, 'support': 38061}, '2': {'precision': 0.3961929184337706, 'recall': 0.08544626903769251, 'f1-score': 0.14057496806705044, 'support': 47012}, 'accuracy': 0.2976641737526893, 'macro avg': {'precision': 0.34623362835657345, 'recall': 0.33151415310968674, 'f1-score': 0.2527408168430408, 'support': 136654}, 'weighted avg': {'precision': 0.35173146613398476, 'recall': 0.2976641737526893, 'f1-score': 0.24171411088311345, 'support': 136654}}
[[ 7855 40615  3111]
 [ 6245 28805  3011]
 [ 7203 35792  4017]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126679
{'0': {'precision': 0.3364061640066043, 'recall': 0.2266827368811422, 'f1-score': 0.2708541043536059, 'support': 21572}, '1': {'precision': 0.3265167962275603, 'recall': 0.6475462962962963, 'f1-score': 0.4341294597824232, 'support': 21600}, '2': {'precision': 0.35303451011503373, 'recall': 0.12267965447528027, 'f1-score': 0.18208476830224704, 'support': 21764}, 'accuracy': 0.33181902180608597, 'macro avg': {'precision': 0.3386524901163995, 'recall': 0.3323028958842396, 'f1-score': 0.29568944414609205, 'support': 64936}, 'weighted avg': {'precision': 0.3386897814249317, 'recall': 0.33181902180608597, 'f1-score': 0.29541323715268003, 'support': 64936}}
[[ 4890 14362  2320]
 [ 5040 13987  2573]
 [ 4606 14488  2670]]
Evaluating performance on  val set...
81/81 - 1s - 702ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1293315
{'0': {'precision': 0.27411167512690354, 'recall': 0.029609321453050036, 'f1-score': 0.053445502907336385, 'support': 7295}, '1': {'precision': 0.29840594007996263, 'recall': 0.9229163321021359, 'f1-score': 0.4509927018755395, 'support': 6227}, '2': {'precision': 0.3350877192982456, 'recall': 0.026920366455250175, 'f1-score': 0.04983692106979777, 'support': 7095}, 'accuracy': 0.2984915361109764, 'macro avg': {'precision': 0.3025351115017039, 'recall': 0.3264820066701454, 'f1-score': 0.18475837528422456, 'support': 20617}, 'weighted avg': {'precision': 0.3024332263350507, 'recall': 0.2984915361109764, 'f1-score': 0.17227576530427408, 'support': 20617}}
[[ 216 6912  167]
 [ 268 5747  212]
 [ 304 6600  191]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
1613/1613 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1149075
{'0': {'precision': 0.32942910038916384, 'recall': 0.06331237201736933, 'f1-score': 0.10621204646091813, 'support': 137714}, '1': {'precision': 0.32947158152522077, 'recall': 0.91020356348104, 'f1-score': 0.48381418112319324, 'support': 133914}, '2': {'precision': 0.31085276036277315, 'recall': 0.036163176864630615, 'f1-score': 0.06478908975578813, 'support': 141221}, 'accuracy': 0.3287279368485814, 'macro avg': {'precision': 0.3232511474257192, 'recall': 0.3365597041210133, 'f1-score': 0.21827177244663318, 'support': 412849}, 'weighted avg': {'precision': 0.3230885727482758, 'recall': 0.3287279368485814, 'f1-score': 0.21452385269590657, 'support': 412849}}
[[  8719 122850   6145]
 [  6848 121889   5177]
 [ 10900 125214   5107]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1134093
{'0': {'precision': 0.3720819720819721, 'recall': 0.11467906704258357, 'f1-score': 0.1753222217557412, 'support': 54622}, '1': {'precision': 0.3340407240169464, 'recall': 0.8063906962830005, 'f1-score': 0.4723954939018714, 'support': 53484}, '2': {'precision': 0.37215174282547114, 'recall': 0.11174186390532545, 'f1-score': 0.17187633322904522, 'support': 54080}, 'accuracy': 0.3418050879853995, 'macro avg': {'precision': 0.35942481297479656, 'recall': 0.3442705424103032, 'f1-score': 0.27319801629555257, 'support': 162186}, 'weighted avg': {'precision': 0.35956039247768196, 'recall': 0.3418050879853995, 'f1-score': 0.2721389213225343, 'support': 162186}}
[[ 6264 43096  5262]
 [ 5422 43129  4933]
 [ 5149 42888  6043]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109886
{'0': {'precision': 0.373134328358209, 'recall': 0.001475013275119476, 'f1-score': 0.002938410907381288, 'support': 16949}, '1': {'precision': 0.3448977632715753, 'recall': 0.9870872025935491, 'f1-score': 0.5111831995902338, 'support': 18199}, '2': {'precision': 0.35813148788927335, 'recall': 0.011773404618359686, 'f1-score': 0.02279735682819383, 'support': 17582}, 'accuracy': 0.3450787028257159, 'macro avg': {'precision': 0.3587211931730192, 'recall': 0.3334452068290094, 'f1-score': 0.17897298910860301, 'support': 52730}, 'weighted avg': {'precision': 0.3583864203525865, 'recall': 0.3450787028257159, 'f1-score': 0.18497343644159253, 'support': 52730}}
[[   25 16761   163]
 [   27 17964   208]
 [   15 17360   207]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.108172
{'0': {'precision': 0.34118921521425133, 'recall': 0.322869444381165, 'f1-score': 0.331776630733757, 'support': 87794}, '1': {'precision': 0.3345010779180782, 'recall': 0.6040459748806599, 'f1-score': 0.4305677144414529, 'support': 86308}, '2': {'precision': 0.3416945770683389, 'recall': 0.060798559600339815, 'f1-score': 0.10322927879440259, 'support': 78867}, 'accuracy': 0.3370966402997996, 'macro avg': {'precision': 0.3391282900668895, 'recall': 0.3292379929540549, 'f1-score': 0.28852454132320415, 'support': 252969}, 'weighted avg': {'precision': 0.33906490994201727, 'recall': 0.3370966402997996, 'f1-score': 0.2942290136235291, 'support': 252969}}
[[28346 54810  4638]
 [29574 52134  4600]
 [25160 48912  4795]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074182
{'0': {'precision': 0.3367851259119793, 'recall': 0.20291396362862915, 'f1-score': 0.253246322309479, 'support': 28209}, '1': {'precision': 0.3205184907971286, 'recall': 0.6587420899905604, 'f1-score': 0.4312213207611942, 'support': 28603}, '2': {'precision': 0.3525092936802974, 'recall': 0.127581567440296, 'f1-score': 0.18735490244504815, 'support': 29730}, 'accuracy': 0.32769060109542186, 'macro avg': {'precision': 0.33660430346313513, 'recall': 0.32974587368649516, 'f1-score': 0.29060751517190714, 'support': 86542}, 'weighted avg': {'precision': 0.33681060421802744, 'recall': 0.32769060109542186, 'f1-score': 0.28943299430856473, 'support': 86542}}
[[ 5724 18991  3494]
 [ 6288 18842  3473]
 [ 4984 20953  3793]]
Evaluating performance on  val set...
124/124 - 1s - 806ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1264564
{'0': {'precision': 0.3492697278554166, 'recall': 0.31164447777986126, 'f1-score': 0.32938611702918297, 'support': 10666}, '1': {'precision': 0.31456245072643313, 'recall': 0.5797011207970112, 'f1-score': 0.40782653135723146, 'support': 9636}, '2': {'precision': 0.36105238430819825, 'recall': 0.13686553873552984, 'f1-score': 0.19848905533673405, 'support': 11230}, 'accuracy': 0.33131422047443865, 'macro avg': {'precision': 0.341628187630016, 'recall': 0.3427370457708008, 'f1-score': 0.3119005679077162, 'support': 31532}, 'weighted avg': {'precision': 0.34285972879255516, 'recall': 0.33131422047443865, 'f1-score': 0.3067385789617871, 'support': 31532}}
[[3324 5795 1547]
 [2877 5586 1173]
 [3316 6377 1537]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110491
{'0': {'precision': 0.29518275865828003, 'recall': 0.37559818567683406, 'f1-score': 0.3305702391561779, 'support': 72093}, '1': {'precision': 0.37821458972737, 'recall': 0.5419529553949106, 'f1-score': 0.4455156362833527, 'support': 89362}, '2': {'precision': 0.2920411542100284, 'recall': 0.06564414731721581, 'f1-score': 0.10719362784994195, 'support': 75239}, 'accuracy': 0.3398776479336189, 'macro avg': {'precision': 0.3218128341985595, 'recall': 0.32773176279632016, 'f1-score': 0.2944265010964908, 'support': 236694}, 'weighted avg': {'precision': 0.32553215201389535, 'recall': 0.3398776479336189, 'f1-score': 0.3029612491522433, 'support': 236694}}
[[27078 40081  4934]
 [33893 48430  7039]
 [30762 39538  4939]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1207939
{'0': {'precision': 0.314882400648824, 'recall': 0.3116909182137481, 'f1-score': 0.3132785314438448, 'support': 29895}, '1': {'precision': 0.30854047042215904, 'recall': 0.5518253155919481, 'f1-score': 0.39578617660373666, 'support': 29310}, '2': {'precision': 0.33612932743632756, 'recall': 0.07505533798739997, 'f1-score': 0.1227103167975057, 'support': 29365}, 'accuracy': 0.3127018177712544, 'macro avg': {'precision': 0.3198507328357702, 'recall': 0.31285719059769873, 'f1-score': 0.27725834161502905, 'support': 88570}, 'weighted avg': {'precision': 0.3198280259189097, 'recall': 0.3127018177712544, 'f1-score': 0.27740028211051165, 'support': 88570}}
[[ 9318 18130  2447]
 [11230 16174  1906]
 [ 9044 18117  2204]]
Evaluating performance on  val set...
127/127 - 1s - 984ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228807
{'0': {'precision': 0.3972885352195697, 'recall': 0.12454957035941976, 'f1-score': 0.1896454698930782, 'support': 10823}, '1': {'precision': 0.32837980524813265, 'recall': 0.8379403253168346, 'f1-score': 0.4718476062036412, 'support': 10021}, '2': {'precision': 0.32597520411248865, 'recall': 0.09433797147107727, 'f1-score': 0.14632822044251392, 'support': 11427}, 'accuracy': 0.3353785132162003, 'macro avg': {'precision': 0.350547848193397, 'recall': 0.35227595571577724, 'f1-score': 0.26927376551307775, 'support': 32271}, 'weighted avg': {'precision': 0.3506388553954432, 'recall': 0.3353785132162003, 'f1-score': 0.26193828382808343, 'support': 32271}}
[[1348 8144 1331]
 [ 726 8397  898]
 [1319 9030 1078]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1093173
{'0': {'precision': 0.3341917682225799, 'recall': 0.11032838902637132, 'f1-score': 0.16589051728073778, 'support': 131734}, '1': {'precision': 0.36242180077242947, 'recall': 0.7968515792972009, 'f1-score': 0.49823689438965596, 'support': 147439}, '2': {'precision': 0.3093839778303206, 'recall': 0.09520270375991613, 'f1-score': 0.14560138793335528, 'support': 127822}, 'accuracy': 0.35427953660364375, 'macro avg': {'precision': 0.3353325156084433, 'recall': 0.3341275573611628, 'f1-score': 0.26990959986791635, 'support': 406995}, 'weighted avg': {'precision': 0.33662724380728715, 'recall': 0.35427953660364375, 'f1-score': 0.27991506402730876, 'support': 406995}}
[[ 14534 103503  13697]
 [ 16485 117487  13467]
 [ 12471 103182  12169]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1127728
{'0': {'precision': 0.3346518987341772, 'recall': 0.18723027553391614, 'f1-score': 0.24011920811750517, 'support': 45185}, '1': {'precision': 0.3343846954657431, 'recall': 0.7129576721902334, 'f1-score': 0.45525158049102227, 'support': 45502}, '2': {'precision': 0.33118657298985166, 'recall': 0.10836064875909923, 'f1-score': 0.16329345350739327, 'support': 46982}, 'accuracy': 0.33407666213889836, 'macro avg': {'precision': 0.3334077223965906, 'recall': 0.3361828654944163, 'f1-score': 0.28622141403864026, 'support': 137669}, 'weighted avg': {'precision': 0.3333809792298575, 'recall': 0.33407666213889836, 'f1-score': 0.2850060425148459, 'support': 137669}}
[[ 8460 31397  5328]
 [ 8108 32441  4953]
 [ 8712 33179  5091]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1191008
{'0': {'precision': 0.3569037096558189, 'recall': 0.13983628922237382, 'f1-score': 0.200942507068803, 'support': 19058}, '1': {'precision': 0.31760363957105053, 'recall': 0.7837667544965059, 'f1-score': 0.45203171456888, 'support': 17458}, '2': {'precision': 0.3581379544682297, 'recall': 0.062087653157398684, 'f1-score': 0.10582860585370753, 'support': 16976}, 'accuracy': 0.32531967396993944, 'macro avg': {'precision': 0.3442151012316997, 'recall': 0.32856356562542616, 'f1-score': 0.2529342758304635, 'support': 53492}, 'weighted avg': {'precision': 0.344469175826379, 'recall': 0.32531967396993944, 'f1-score': 0.252704673327475, 'support': 53492}}
[[ 2665 15424   969]
 [ 2855 13683   920]
 [ 1947 13975  1054]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.111299
{'0': {'precision': 0.34812224631093086, 'recall': 0.1608861049971073, 'f1-score': 0.2200672430143085, 'support': 309399}, '1': {'precision': 0.330274005730743, 'recall': 0.7128540291226816, 'f1-score': 0.45140605531272154, 'support': 316111}, '2': {'precision': 0.36862283339290847, 'recall': 0.15358513266480164, 'f1-score': 0.21682927281759734, 'support': 342442}, 'accuracy': 0.3385632758649189, 'macro avg': {'precision': 0.3490063618115274, 'recall': 0.3424417555948635, 'f1-score': 0.29610085704820915, 'support': 967952}, 'weighted avg': {'precision': 0.34954611532869495, 'recall': 0.3385632758649189, 'f1-score': 0.29447168280508484, 'support': 967952}}
[[ 49778 216338  43283]
 [ 43970 225341  46800]
 [ 49242 240606  52594]]
Evaluating performance on  train set...
1601/1601 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1160873
{'0': {'precision': 0.3492727218422389, 'recall': 0.08515255224641374, 'f1-score': 0.13692326606600277, 'support': 137330}, '1': {'precision': 0.33226161787892905, 'recall': 0.7971145376079828, 'f1-score': 0.4690209982098601, 'support': 135091}, '2': {'precision': 0.34862016098121884, 'recall': 0.1324609884148517, 'f1-score': 0.19197830205106828, 'support': 137331}, 'accuracy': 0.33573478591928774, 'macro avg': {'precision': 0.34338483356746224, 'recall': 0.3382426927564161, 'f1-score': 0.2659741887756437, 'support': 409752}, 'weighted avg': {'precision': 0.34344562671857326, 'recall': 0.33573478591928774, 'f1-score': 0.2648645033995871, 'support': 409752}}
[[ 11694 108189  17447]
 [ 10866 107683  16542]
 [ 10921 108219  18191]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.112451
{'0': {'precision': 0.3503893824723045, 'recall': 0.13837390626353635, 'f1-score': 0.19839766481383722, 'support': 46172}, '1': {'precision': 0.3366699943339719, 'recall': 0.8165517843120147, 'f1-score': 0.4767660300701126, 'support': 45844}, '2': {'precision': 0.384112843355605, 'recall': 0.05860631598024557, 'f1-score': 0.10169624781335378, 'support': 44142}, 'accuracy': 0.34085400784382847, 'macro avg': {'precision': 0.35705740672062714, 'recall': 0.3378440021852655, 'f1-score': 0.2589533142324345, 'support': 136158}, 'weighted avg': {'precision': 0.3567031457509729, 'recall': 0.34085400784382847, 'f1-score': 0.2607731799328412, 'support': 136158}}
[[ 6389 37839  1944]
 [ 6206 37434  2204]
 [ 5639 35916  2587]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1114264
{'0': {'precision': 0.36712012524655707, 'recall': 0.21208900425910265, 'f1-score': 0.26885674911054214, 'support': 391397}, '1': {'precision': 0.3458923512747875, 'recall': 0.6705212288574387, 'f1-score': 0.4563657333247901, 'support': 382404}, '2': {'precision': 0.34809991644818344, 'recall': 0.16453679342408445, 'f1-score': 0.22345354103824092, 'support': 367158}, 'accuracy': 0.35043502877842236, 'macro avg': {'precision': 0.3537041309898427, 'recall': 0.34904900884687523, 'f1-score': 0.31622534115785766, 'support': 1140959}, 'weighted avg': {'precision': 0.35388476139922004, 'recall': 0.35043502877842236, 'f1-score': 0.31709164145115676, 'support': 1140959}}
[[ 83011 249652  58734]
 [ 71594 256410  54400]
 [ 71509 235238  60411]]
Evaluating performance on  train set...
2425/2425 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063836
{'0': {'precision': 0.35269102820327813, 'recall': 0.268383460473252, 'f1-score': 0.30481509175742155, 'support': 205810}, '1': {'precision': 0.33258473899529467, 'recall': 0.6597020162882167, 'f1-score': 0.44222463261478956, 'support': 205179}, '2': {'precision': 0.3676998197378323, 'recall': 0.10016782043213761, 'f1-score': 0.15744491114216877, 'support': 209748}, 'accuracy': 0.3408899421171929, 'macro avg': {'precision': 0.35099186231213503, 'recall': 0.34275109906453544, 'f1-score': 0.3014948785047933, 'support': 620737}, 'weighted avg': {'precision': 0.3511165702498853, 'recall': 0.3408899421171929, 'f1-score': 0.30043795867188916, 'support': 620737}}
[[ 55236 132769  17805]
 [ 51498 135357  18324]
 [ 49879 138859  21010]]
Evaluating performance on  val set...
787/787 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158992
{'0': {'precision': 0.33920874733451295, 'recall': 0.217986471514374, 'f1-score': 0.26541117165728895, 'support': 68596}, '1': {'precision': 0.3258509571120364, 'recall': 0.7142857142857143, 'f1-score': 0.44753865535512916, 'support': 66395}, '2': {'precision': 0.3749784445594068, 'recall': 0.06566411499146925, 'f1-score': 0.11175782805894975, 'support': 66231}, 'accuracy': 0.3316088698054885, 'macro avg': {'precision': 0.3466793830019854, 'recall': 0.33264543359718585, 'f1-score': 0.27490255169045597, 'support': 201222}, 'weighted avg': {'precision': 0.346574603627963, 'recall': 0.3316088698054885, 'f1-score': 0.27493169963264197, 'support': 201222}}
[[14953 50274  3369]
 [15090 47425  3880]
 [14039 47843  4349]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.108265
{'0': {'precision': 0.34645802433057826, 'recall': 0.46419723900848586, 'f1-score': 0.3967774357355224, 'support': 406086}, '1': {'precision': 0.33581259425211757, 'recall': 0.49465116932979214, 'f1-score': 0.40004175909138834, 'support': 391207}, '2': {'precision': 0.3358772650776878, 'recall': 0.06441395460550017, 'f1-score': 0.10809721443731382, 'support': 399696}, 'accuracy': 0.34065559499711356, 'macro avg': {'precision': 0.3393826278867946, 'recall': 0.34108745431459275, 'f1-score': 0.30163880308807484, 'support': 1196989}, 'weighted avg': {'precision': 0.33944571768862275, 'recall': 0.34065559499711356, 'f1-score': 0.30144882069818246, 'support': 1196989}}
[[188504 191667  25915]
 [172704 193511  24992]
 [182881 191069  25746]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138148
{'0': {'precision': 0.36954283984256736, 'recall': 0.2304982141122897, 'f1-score': 0.28391045599391257, 'support': 185342}, '1': {'precision': 0.32734398151788036, 'recall': 0.6275878461814957, 'f1-score': 0.43026548778088464, 'support': 172489}, '2': {'precision': 0.3566794835993384, 'recall': 0.18289109914196655, 'f1-score': 0.24179784770863977, 'support': 181578}, 'accuracy': 0.3414514774503206, 'macro avg': {'precision': 0.3511887683199287, 'recall': 0.346992386478584, 'f1-score': 0.318657930494479, 'support': 539409}, 'weighted avg': {'precision': 0.35171862598351056, 'recall': 0.3414514774503206, 'f1-score': 0.3165348836372774, 'support': 539409}}
[[ 42721 111317  31304]
 [ 35644 108252  28593]
 [ 37240 111129  33209]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1202847
{'0': {'precision': 0.3501598841181776, 'recall': 0.17958817510267588, 'f1-score': 0.2374131381450941, 'support': 71341}, '1': {'precision': 0.2971460360867584, 'recall': 0.7096686409476549, 'f1-score': 0.41889580754585054, 'support': 62470}, '2': {'precision': 0.35555193394176443, 'recall': 0.09299252649825239, 'f1-score': 0.14742651199459397, 'support': 70382}, 'accuracy': 0.31191079028174323, 'macro avg': {'precision': 0.33428595138223355, 'recall': 0.3274164475161944, 'f1-score': 0.26791181922851287, 'support': 204193}, 'weighted avg': {'precision': 0.33579958853586545, 'recall': 0.31191079028174323, 'f1-score': 0.26191830549040346, 'support': 204193}}
[[12812 52307  6222]
 [12496 44333  5641]
 [11281 52556  6545]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
4274/4274 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953039
{'0': {'precision': 0.24084063075131273, 'recall': 0.2021553809452313, 'f1-score': 0.21980888392274092, 'support': 299715}, '1': {'precision': 0.43281774058845346, 'recall': 0.6540225505552968, 'f1-score': 0.5209092171718185, 'support': 496041}, '2': {'precision': 0.29532786708847136, 'recall': 0.09200526970356242, 'f1-score': 0.14030155172105316, 'support': 298309}, 'accuracy': 0.37699496830627066, 'macro avg': {'precision': 0.3229954128094125, 'recall': 0.31606106706803017, 'f1-score': 0.2936732176052042, 'support': 1094065}, 'weighted avg': {'precision': 0.3427381875922925, 'recall': 0.37699496830627066, 'f1-score': 0.3346469946779999, 'support': 1094065}}
[[ 60589 215866  23260]
 [129391 324422  42228]
 [ 61593 209270  27446]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1131262
{'0': {'precision': 0.33958179376958064, 'recall': 0.1972324823629692, 'f1-score': 0.2495334536665953, 'support': 165419}, '1': {'precision': 0.32822851192896146, 'recall': 0.6742348686028766, 'f1-score': 0.4415185869327872, 'support': 166442}, '2': {'precision': 0.34263707885412287, 'recall': 0.13212790717871226, 'f1-score': 0.19071296950146874, 'support': 172719}, 'accuracy': 0.332292203416703, 'macro avg': {'precision': 0.3368157948508883, 'recall': 0.33453175271485264, 'f1-score': 0.2939216700336171, 'support': 504580}, 'weighted avg': {'precision': 0.33688260404426595, 'recall': 0.332292203416703, 'f1-score': 0.2927277426724517, 'support': 504580}}
[[ 32626 110985  21808]
 [ 32246 112221  21975]
 [ 31205 118693  22821]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.111208
{'0': {'precision': 0.31839654474288026, 'recall': 0.12173389524382902, 'f1-score': 0.17612802070630396, 'support': 58135}, '1': {'precision': 0.3612614160153454, 'recall': 0.7659761742165566, 'f1-score': 0.49096595026530676, 'support': 65895}, '2': {'precision': 0.33868481207803947, 'recall': 0.11231577462802342, 'f1-score': 0.1686900112530615, 'support': 56724}, 'accuracy': 0.3536408599533067, 'macro avg': {'precision': 0.3394475909454217, 'recall': 0.3333419480294697, 'f1-score': 0.2785946607415574, 'support': 180754}, 'weighted avg': {'precision': 0.34039004070323886, 'recall': 0.3536408599533067, 'f1-score': 0.2885699678834882, 'support': 180754}}
[[ 7077 45620  5438]
 [ 8419 50474  7002]
 [ 6731 43622  6371]]
testing model on single stock: results/universal/W4/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
12724/12724 - 62s - 62s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910712
{'0': {'precision': 0.28202202214163236, 'recall': 0.20691234695208216, 'f1-score': 0.2386980428545513, 'support': 912541}, '1': {'precision': 0.43378543514507173, 'recall': 0.7037149752339725, 'f1-score': 0.5367229830682018, 'support': 1406362}, '2': {'precision': 0.28613051899904296, 'recall': 0.09336377317627398, 'f1-score': 0.14078854636525015, 'support': 938244}, 'accuracy': 0.3887119617260136, 'macro avg': {'precision': 0.3339793254285824, 'recall': 0.3346636984541096, 'f1-score': 0.30540319076266775, 'support': 3257147}, 'weighted avg': {'precision': 0.3487334937343567, 'recall': 0.3887119617260136, 'f1-score': 0.339174918274863, 'support': 3257147}}
[[188816 638244  85481]
 [283616 989678 133068]
 [197076 653570  87598]]
Evaluating performance on  train set...
5165/5165 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1088511
{'0': {'precision': 0.33272607496929824, 'recall': 0.2773815173910096, 'f1-score': 0.3025435667616945, 'support': 442470}, '1': {'precision': 0.3182423929219123, 'recall': 0.6144750852895456, 'f1-score': 0.419316730095857, 'support': 432937}, '2': {'precision': 0.3180760279286268, 'recall': 0.08352455254703993, 'f1-score': 0.1323063720536034, 'support': 446695}, 'accuracy': 0.3222686298031468, 'macro avg': {'precision': 0.3230148319399458, 'recall': 0.3251270517425317, 'f1-score': 0.284722222970385, 'support': 1322102}, 'weighted avg': {'precision': 0.3230334607705588, 'recall': 0.3222686298031468, 'f1-score': 0.2832646603870514, 'support': 1322102}}
[[122733 283408  36329]
 [123248 266029  43660]
 [122890 286495  37310]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1247357
{'0': {'precision': 0.2738713946415895, 'recall': 0.19343955826276432, 'f1-score': 0.22673366104953838, 'support': 161544}, '1': {'precision': 0.2994216420656061, 'recall': 0.6177922716755634, 'f1-score': 0.4033527482940872, 'support': 164667}, '2': {'precision': 0.3288377986965967, 'recall': 0.06778448774480841, 'f1-score': 0.11239964317573596, 'support': 160789}, 'accuracy': 0.29543737166324435, 'macro avg': {'precision': 0.30071027846793075, 'recall': 0.293005439227712, 'f1-score': 0.24749535083978716, 'support': 487000}, 'weighted avg': {'precision': 0.3006584084694562, 'recall': 0.29543737166324435, 'f1-score': 0.24870426236244866, 'support': 487000}}
[[ 31249 119062  11233]
 [ 51925 101730  11012]
 [ 30927 118963  10899]]
training model: results/universal/W4/deepLOB_L1/h500
Epoch 1/50
9854/9854 - 155s - loss: 3.2059 - accuracy500: 0.4227 - val_loss: 3.5947 - val_accuracy500: 0.3319 - 155s/epoch - 16ms/step
Epoch 2/50
9854/9854 - 157s - loss: 3.1826 - accuracy500: 0.4337 - val_loss: 3.5121 - val_accuracy500: 0.3351 - 157s/epoch - 16ms/step
Epoch 3/50
9854/9854 - 154s - loss: 3.1763 - accuracy500: 0.4361 - val_loss: 3.4811 - val_accuracy500: 0.3245 - 154s/epoch - 16ms/step
Epoch 4/50
9854/9854 - 151s - loss: 3.1690 - accuracy500: 0.4391 - val_loss: 3.5925 - val_accuracy500: 0.3289 - 151s/epoch - 15ms/step
Epoch 5/50
9854/9854 - 151s - loss: 3.1599 - accuracy500: 0.4419 - val_loss: 3.5964 - val_accuracy500: 0.3448 - 151s/epoch - 15ms/step
Epoch 6/50
9854/9854 - 153s - loss: 3.1503 - accuracy500: 0.4458 - val_loss: 3.5995 - val_accuracy500: 0.3610 - 153s/epoch - 16ms/step
Epoch 7/50
9854/9854 - 153s - loss: 3.1440 - accuracy500: 0.4485 - val_loss: 3.7242 - val_accuracy500: 0.3368 - 153s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 154s - loss: 3.1404 - accuracy500: 0.4494 - val_loss: 3.5859 - val_accuracy500: 0.3484 - 154s/epoch - 16ms/step
Epoch 9/50
9854/9854 - 157s - loss: 3.1337 - accuracy500: 0.4520 - val_loss: 3.6093 - val_accuracy500: 0.3528 - 157s/epoch - 16ms/step
Epoch 10/50
9854/9854 - 156s - loss: 3.1291 - accuracy500: 0.4537 - val_loss: 3.7885 - val_accuracy500: 0.3303 - 156s/epoch - 16ms/step
Epoch 11/50
9854/9854 - 156s - loss: 3.1290 - accuracy500: 0.4534 - val_loss: 3.8227 - val_accuracy500: 0.3339 - 156s/epoch - 16ms/step
Epoch 12/50
9854/9854 - 153s - loss: 3.1259 - accuracy500: 0.4543 - val_loss: 3.9241 - val_accuracy500: 0.3438 - 153s/epoch - 15ms/step
Epoch 13/50
9854/9854 - 156s - loss: 3.1243 - accuracy500: 0.4551 - val_loss: 3.9428 - val_accuracy500: 0.3349 - 156s/epoch - 16ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 120s - 120s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1328192
{'0': {'precision': 0.28746728088400786, 'recall': 0.11535470640447829, 'f1-score': 0.16464197503459488, 'support': 1800334}, '1': {'precision': 0.39728105447632567, 'recall': 0.85811588109977, 'f1-score': 0.5431161610248069, 'support': 2400029}, '2': {'precision': 0.3507890483598569, 'recall': 0.03096830598289502, 'f1-score': 0.05691228976457757, 'support': 1871268}, 'accuracy': 0.3829498202377582, 'macro avg': {'precision': 0.34517912790673017, 'recall': 0.33481296449571446, 'f1-score': 0.2548901419413265, 'support': 6071631}, 'weighted avg': {'precision': 0.35039077514806866, 'recall': 0.3829498202377582, 'f1-score': 0.28104527909441795, 'support': 6071631}}
[[ 207677 1535608   57049]
 [ 290326 2059503   50200]
 [ 224434 1588884   57950]]
Evaluating performance on  train set...
9854/9854 - 59s - 59s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1653059
{'0': {'precision': 0.3331608877339044, 'recall': 0.09842869532660672, 'f1-score': 0.15196192308888334, 'support': 844012}, '1': {'precision': 0.328744017271436, 'recall': 0.8177432288329272, 'f1-score': 0.4689597639337029, 'support': 831799}, '2': {'precision': 0.3369518233259981, 'recall': 0.08106517546513387, 'f1-score': 0.13068874596110466, 'support': 846208}, 'accuracy': 0.3298432723940621, 'macro avg': {'precision': 0.33295224277711283, 'recall': 0.3324123665415559, 'f1-score': 0.25053681099456365, 'support': 2522019}, 'weighted avg': {'precision': 0.33297610387291987, 'recall': 0.3298432723940621, 'f1-score': 0.2493747317734875, 'support': 2522019}}
[[ 83075 693072  67865]
 [ 84480 680198  67121]
 [ 81799 695811  68598]]
Evaluating performance on  val set...
3566/3566 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1622175
{'0': {'precision': 0.27146979944029853, 'recall': 0.060965031439953125, 'f1-score': 0.09956937914148474, 'support': 305503}, '1': {'precision': 0.3268223928004235, 'recall': 0.8101032037108722, 'f1-score': 0.46574704319174987, 'support': 304834}, '2': {'precision': 0.3501316028317299, 'recall': 0.10218697746800656, 'f1-score': 0.15820216885936245, 'support': 302015}, 'accuracy': 0.32491187611798955, 'macro avg': {'precision': 0.31614126502415063, 'recall': 0.32441840420627727, 'f1-score': 0.2411728637308657, 'support': 912352}, 'weighted avg': {'precision': 0.31600348489898494, 'recall': 0.32491187611798955, 'f1-score': 0.24132539439628042, 'support': 912352}}
[[ 18625 255777  31101]
 [ 31706 246947  26181]
 [ 18277 252876  30862]]
testing model out of sample: results/universal/W4/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1554332
{'0': {'precision': 0.3375925409149855, 'recall': 0.100201515851346, 'f1-score': 0.1545351464551475, 'support': 1026222}, '1': {'precision': 0.34014677687333167, 'recall': 0.8213549350133489, 'f1-score': 0.48106900050966545, 'support': 1029673}, '2': {'precision': 0.33632337299740744, 'recall': 0.08296105445366474, 'f1-score': 0.1330921915268798, 'support': 975747}, 'accuracy': 0.33958660026480697, 'macro avg': {'precision': 0.3380208969285749, 'recall': 0.33483916843945316, 'f1-score': 0.25623211283056424, 'support': 3031642}, 'weighted avg': {'precision': 0.33805157961871934, 'recall': 0.33958660026480697, 'f1-score': 0.25853825571524, 'support': 3031642}}
[[102829 840428  82965]
 [107172 845727  76774]
 [ 94594 800204  80949]]
Evaluating performance on  train set...
5528/5528 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1644973
{'0': {'precision': 0.3314076693616964, 'recall': 0.10531892077381719, 'f1-score': 0.15984141502586122, 'support': 466260}, '1': {'precision': 0.3295672354621574, 'recall': 0.8227443404149828, 'f1-score': 0.47061850881139117, 'support': 467923}, '2': {'precision': 0.3442622950819672, 'recall': 0.07035256443623629, 'f1-score': 0.116830039935688, 'support': 480281}, 'accuracy': 0.3307797158499615, 'macro avg': {'precision': 0.33507906663527365, 'recall': 0.3328052752083454, 'f1-score': 0.2490966545909801, 'support': 1414464}, 'weighted avg': {'precision': 0.3351636158855976, 'recall': 0.3307797158499615, 'f1-score': 0.2480459955706634, 'support': 1414464}}
[[ 49106 385067  32087]
 [ 50669 384981  32273]
 [ 48399 398093  33789]]
Evaluating performance on  val set...
1908/1908 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1647912
{'0': {'precision': 0.31975979923518166, 'recall': 0.06339663322000166, 'f1-score': 0.10581419490059221, 'support': 168826}, '1': {'precision': 0.3215074676158673, 'recall': 0.830118244523611, 'f1-score': 0.4634999232913817, 'support': 158316}, '2': {'precision': 0.3356765094755399, 'recall': 0.09492444305966662, 'f1-score': 0.14799737679434552, 'support': 160475}, 'accuracy': 0.32270614026992495, 'macro avg': {'precision': 0.3256479254421963, 'recall': 0.3294797736010931, 'f1-score': 0.23910383166210647, 'support': 487617}, 'weighted avg': {'precision': 0.3255654170523991, 'recall': 0.32270614026992495, 'f1-score': 0.2358275453176537, 'support': 487617}}
[[ 10703 142549  15574]
 [ 12322 131421  14573]
 [ 10447 134795  15233]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1684712
{'0': {'precision': 0.36344669309409555, 'recall': 0.06858267716535434, 'f1-score': 0.11539098466531979, 'support': 50800}, '1': {'precision': 0.3056199153354354, 'recall': 0.841152638266248, 'f1-score': 0.44834173486924905, 'support': 41713}, '2': {'precision': 0.34602838036209427, 'recall': 0.09612378514306427, 'f1-score': 0.15045299008917964, 'support': 44141}, 'accuracy': 0.31330220849737295, 'macro avg': {'precision': 0.33836499626387506, 'recall': 0.3352863668582222, 'f1-score': 0.23806190320791618, 'support': 136654}, 'weighted avg': {'precision': 0.34016899816419777, 'recall': 0.31330220849737295, 'f1-score': 0.2283481364843013, 'support': 136654}}
[[ 3484 43075  4241]
 [ 2848 35087  3778]
 [ 3254 36644  4243]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.162258
{'0': {'precision': 0.34179181771103057, 'recall': 0.12292791953808903, 'f1-score': 0.18082191780821918, 'support': 21476}, '1': {'precision': 0.3333584252324137, 'recall': 0.8164638643067846, 'f1-score': 0.4734211721944571, 'support': 21696}, '2': {'precision': 0.37628865979381443, 'recall': 0.07043741959198677, 'f1-score': 0.11866243517300099, 'support': 21764}, 'accuracy': 0.3370549464087717, 'macro avg': {'precision': 0.35047963424575296, 'recall': 0.3366097344789534, 'f1-score': 0.2576351750585591, 'support': 64936}, 'weighted avg': {'precision': 0.35053609496669214, 'recall': 0.3370549464087717, 'f1-score': 0.2577498844690996, 'support': 64936}}
[[ 2640 17637  1199]
 [ 2640 17714  1342]
 [ 2444 17787  1533]]
Evaluating performance on  val set...
81/81 - 1s - 615ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.195985
{'0': {'precision': 0.28874388254486133, 'recall': 0.023406506215286962, 'f1-score': 0.04330275229357799, 'support': 7562}, '1': {'precision': 0.2752538749331908, 'recall': 0.9092514124293786, 'f1-score': 0.4225814392385328, 'support': 5664}, '2': {'precision': 0.3554868624420402, 'recall': 0.062237856852929235, 'f1-score': 0.10592976396085203, 'support': 7391}, 'accuracy': 0.2806906921472571, 'macro avg': {'precision': 0.30649487330669745, 'recall': 0.3316319251658649, 'f1-score': 0.19060465183098763, 'support': 20617}, 'weighted avg': {'precision': 0.3089645723303562, 'recall': 0.2806906921472571, 'f1-score': 0.16995118446552573, 'support': 20617}}
[[ 177 6876  509]
 [ 189 5150  325]
 [ 247 6684  460]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
1613/1613 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.181422
{'0': {'precision': 0.32143338272935473, 'recall': 0.050606242709180245, 'f1-score': 0.08744517878739753, 'support': 141445}, '1': {'precision': 0.3095843935538592, 'recall': 0.8930573962687328, 'f1-score': 0.4597821808161658, 'support': 127517}, '2': {'precision': 0.28008974133380254, 'recall': 0.044250001737474544, 'f1-score': 0.07642585779532945, 'support': 143887}, 'accuracy': 0.30859951217030923, 'macro avg': {'precision': 0.3037025058723388, 'recall': 0.32930454690512917, 'f1-score': 0.20788440579963088, 'support': 412849}, 'weighted avg': {'precision': 0.30336440331515374, 'recall': 0.30859951217030923, 'f1-score': 0.19860872877326824, 'support': 412849}}
[[  7158 124986   9301]
 [  6573 113880   7064]
 [  8538 128982   6367]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1599178
{'0': {'precision': 0.347994682029692, 'recall': 0.05804091135872277, 'f1-score': 0.09948846269578576, 'support': 54117}, '1': {'precision': 0.3341011910606255, 'recall': 0.8192155265009815, 'f1-score': 0.4746326468205642, 'support': 53998}, '2': {'precision': 0.3324661559955678, 'recall': 0.12762848846886501, 'f1-score': 0.18444967124605763, 'support': 54071}, 'accuracy': 0.3346651375581123, 'macro avg': {'precision': 0.3381873430286284, 'recall': 0.3349616421095231, 'f1-score': 0.2528569269208025, 'support': 162186}, 'weighted avg': {'precision': 0.3381919638139472, 'recall': 0.3346651375581123, 'f1-score': 0.2527136064313211, 'support': 162186}}
[[ 3141 43680  7296]
 [ 3202 44236  6560]
 [ 2683 44487  6901]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1523147
{'0': {'precision': 0.25, 'recall': 0.00034283755213987773, 'f1-score': 0.0006847360912981455, 'support': 17501}, '1': {'precision': 0.32801466452808964, 'recall': 0.9109157170127842, 'f1-score': 0.48234140962416144, 'support': 17287}, '2': {'precision': 0.3490104277505852, 'recall': 0.09140564039683424, 'f1-score': 0.14486992624000708, 'support': 17942}, 'accuracy': 0.32985018016309503, 'macro avg': {'precision': 0.3090083640928916, 'recall': 0.3342213983205861, 'f1-score': 0.20929869065182224, 'support': 52730}, 'weighted avg': {'precision': 0.309265780398219, 'recall': 0.32985018016309503, 'f1-score': 0.207651730155602, 'support': 52730}}
[[    6 15963  1532]
 [   13 15747  1527]
 [    5 16297  1640]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1371696
{'0': {'precision': 0.3460100292762109, 'recall': 0.13672599821318124, 'f1-score': 0.19600180616559254, 'support': 87306}, '1': {'precision': 0.3585149664423195, 'recall': 0.8334247657501481, 'f1-score': 0.5013596641761492, 'support': 91142}, '2': {'precision': 0.2979078229229836, 'recall': 0.026368406221065205, 'f1-score': 0.04844853729797699, 'support': 74521}, 'accuracy': 0.35522929687036753, 'macro avg': {'precision': 0.3341442728805047, 'recall': 0.3321730567281315, 'f1-score': 0.24860333587990624, 'support': 252969}, 'weighted avg': {'precision': 0.33634521051796235, 'recall': 0.35522929687036753, 'f1-score': 0.2625518923244285, 'support': 252969}}
[[11937 73171  2198]
 [12749 75960  2433]
 [ 9813 62743  1965]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1564555
{'0': {'precision': 0.34666394613344215, 'recall': 0.12256528639445967, 'f1-score': 0.18110110323509032, 'support': 27724}, '1': {'precision': 0.3347154007763694, 'recall': 0.8231087692886714, 'f1-score': 0.4759050445103857, 'support': 29227}, '2': {'precision': 0.3661393055270187, 'recall': 0.06022101314588895, 'f1-score': 0.10343026292878287, 'support': 29591}, 'accuracy': 0.33783596404058147, 'macro avg': {'precision': 0.34917288414561004, 'recall': 0.33529835627634, 'f1-score': 0.25347880355808633, 'support': 86542}, 'weighted avg': {'precision': 0.349287819220084, 'recall': 0.33783596404058147, 'f1-score': 0.2541046963592279, 'support': 86542}}
[[ 3398 22798  1528]
 [ 3613 24057  1557]
 [ 2791 25018  1782]]
Evaluating performance on  val set...
124/124 - 1s - 894ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1827288
{'0': {'precision': 0.31185270425776757, 'recall': 0.10259322354722696, 'f1-score': 0.1543939609742202, 'support': 10566}, '1': {'precision': 0.309588810953841, 'recall': 0.754761417161581, 'f1-score': 0.43907669396872673, 'support': 9766}, '2': {'precision': 0.33765010595714623, 'recall': 0.12803571428571428, 'f1-score': 0.185667119829093, 'support': 11200}, 'accuracy': 0.31361791196245087, 'macro avg': {'precision': 0.3196972070562516, 'recall': 0.32846345166484076, 'f1-score': 0.25971259159068, 'support': 31532}, 'weighted avg': {'precision': 0.32031463870616583, 'recall': 0.31361791196245087, 'f1-score': 0.2536731360851845, 'support': 31532}}
[[1084 7989 1493]
 [1075 7371 1320]
 [1317 8449 1434]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1542764
{'0': {'precision': 0.29892137538326763, 'recall': 0.1531588397015093, 'f1-score': 0.202541272491189, 'support': 71292}, '1': {'precision': 0.376378896882494, 'recall': 0.8550415399282698, 'f1-score': 0.5226802836249601, 'support': 88108}, '2': {'precision': 0.3333333333333333, 'recall': 2.587522964266308e-05, 'f1-score': 5.17464424320828e-05, 'support': 77294}, 'accuracy': 0.3644241087649032, 'macro avg': {'precision': 0.336211201866365, 'recall': 0.33607541828647397, 'f1-score': 0.24175776751952707, 'support': 236694}, 'weighted avg': {'precision': 0.33899195250835834, 'recall': 0.3644241087649032, 'f1-score': 0.2555869034178778, 'support': 236694}}
[[10919 60371     2]
 [12770 75336     2]
 [12839 64453     2]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1766045
{'0': {'precision': 0.31011673151750974, 'recall': 0.13371137133845587, 'f1-score': 0.18685672754554192, 'support': 29803}, '1': {'precision': 0.32532639303694855, 'recall': 0.7822919872781369, 'f1-score': 0.4595449751393702, 'support': 29241}, '2': {'precision': 0.30706622271550127, 'recall': 0.05622163516900359, 'f1-score': 0.0950417954883774, 'support': 29526}, 'accuracy': 0.32200519363215535, 'macro avg': {'precision': 0.31416978242331983, 'recall': 0.3240749979285321, 'f1-score': 0.24714783272442986, 'support': 88570}, 'weighted avg': {'precision': 0.31412120695616624, 'recall': 0.32200519363215535, 'f1-score': 0.2462758238983848, 'support': 88570}}
[[ 3985 23764  2054]
 [ 4674 22875  1692]
 [ 4191 23675  1660]]
Evaluating performance on  val set...
127/127 - 1s - 807ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1747404
{'0': {'precision': 0.41150719199499686, 'recall': 0.061016320474777445, 'f1-score': 0.10627473148671565, 'support': 10784}, '1': {'precision': 0.30413045150373047, 'recall': 0.8039853599023994, 'f1-score': 0.44131927004855187, 'support': 9836}, '2': {'precision': 0.31156316916488225, 'recall': 0.12488198437902326, 'f1-score': 0.17829789841308744, 'support': 11651}, 'accuracy': 0.3105264788819683, 'macro avg': {'precision': 0.3424002708878698, 'recall': 0.32996122158540003, 'f1-score': 0.24196396664945163, 'support': 32271}, 'weighted avg': {'precision': 0.3426960169627462, 'recall': 0.3105264788819683, 'f1-score': 0.2343971943528611, 'support': 32271}}
[[ 658 8483 1643]
 [ 356 7908 1572]
 [ 585 9611 1455]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
1590/1590 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.142381
{'0': {'precision': 0.36328245056858927, 'recall': 0.05318574514038877, 'f1-score': 0.09278714691298261, 'support': 133344}, '1': {'precision': 0.3622700500005855, 'recall': 0.8482301976804759, 'f1-score': 0.5077048050413548, 'support': 145892}, '2': {'precision': 0.30995923883427423, 'recall': 0.11130331326951526, 'f1-score': 0.16379091893386163, 'support': 127759}, 'accuracy': 0.35642206906718754, 'macro avg': {'precision': 0.3451705798011497, 'recall': 0.33757308536346, 'f1-score': 0.25476095696273304, 'support': 406995}, 'weighted avg': {'precision': 0.3461809595143218, 'recall': 0.35642206906718754, 'f1-score': 0.2638077685159015, 'support': 406995}}
[[  7092 109987  16265]
 [  6750 123750  15392]
 [  5680 107859  14220]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1725309
{'0': {'precision': 0.32985988875589667, 'recall': 0.104298849039382, 'f1-score': 0.158485842833463, 'support': 44919}, '1': {'precision': 0.3294595326175223, 'recall': 0.8019238793841829, 'f1-score': 0.46704143563374956, 'support': 45533}, '2': {'precision': 0.30151946818613484, 'recall': 0.08069127644704238, 'f1-score': 0.12731191418976492, 'support': 47217}, 'accuracy': 0.32693634732583227, 'macro avg': {'precision': 0.32027962985318464, 'recall': 0.3289713349568691, 'f1-score': 0.25094639755232584, 'support': 137669}, 'weighted avg': {'precision': 0.3200074233926628, 'recall': 0.32693634732583227, 'f1-score': 0.2498464426649861, 'support': 137669}}
[[ 4685 35813  4421]
 [ 4614 36514  4405]
 [ 4904 38503  3810]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1553125
{'0': {'precision': 0.3399405351833499, 'recall': 0.054272151898734175, 'f1-score': 0.0936007640878701, 'support': 18960}, '1': {'precision': 0.3243596561198263, 'recall': 0.8259888280765108, 'f1-score': 0.465802243258293, 'support': 17723}, '2': {'precision': 0.3292705794112132, 'recall': 0.10446784460705574, 'f1-score': 0.1586125914551531, 'support': 16809}, 'accuracy': 0.32573095042249306, 'macro avg': {'precision': 0.3311902569047965, 'recall': 0.32824294152743355, 'f1-score': 0.23933853293377205, 'support': 53492}, 'weighted avg': {'precision': 0.33142540757143274, 'recall': 0.32573095042249306, 'f1-score': 0.23734769113404644, 'support': 53492}}
[[ 1029 16094  1837]
 [ 1344 14639  1740]
 [  654 14399  1756]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
3782/3782 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1952986
{'0': {'precision': 0.33821613348007035, 'recall': 0.08245899718115259, 'f1-score': 0.13259145199963304, 'support': 324246}, '1': {'precision': 0.287205552749648, 'recall': 0.7681079454253612, 'f1-score': 0.418084043118537, 'support': 279104}, '2': {'precision': 0.3584424883123447, 'recall': 0.14005134365691904, 'f1-score': 0.20140811738255826, 'support': 364602}, 'accuracy': 0.3018558771509331, 'macro avg': {'precision': 0.3279547248473544, 'recall': 0.33020609542114426, 'f1-score': 0.2506945375002428, 'support': 967952}, 'weighted avg': {'precision': 0.33112622850582896, 'recall': 0.3018558771509331, 'f1-score': 0.2408332015735746, 'support': 967952}}
[[ 26737 249502  48007]
 [ 21334 214382  43388]
 [ 30982 282557  51063]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1652054
{'0': {'precision': 0.31259744309323356, 'recall': 0.04347448990654611, 'f1-score': 0.07633297165591152, 'support': 138357}, '1': {'precision': 0.3283981925769158, 'recall': 0.8083152458648305, 'f1-score': 0.4670469386519517, 'support': 133610}, '2': {'precision': 0.34613263253520216, 'recall': 0.15485720506586348, 'f1-score': 0.21398091551379186, 'support': 137785}, 'accuracy': 0.33032419609910385, 'macro avg': {'precision': 0.3290427560684505, 'recall': 0.33554898027908003, 'f1-score': 0.2524536086072183, 'support': 409752}, 'weighted avg': {'precision': 0.32902636648049327, 'recall': 0.33032419609910385, 'f1-score': 0.25002123937589577, 'support': 409752}}
[[  6015 110588  21754]
 [  7058 107999  18553]
 [  6169 110279  21337]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1699451
{'0': {'precision': 0.31712723511157087, 'recall': 0.04477549657820063, 'f1-score': 0.07847152390529298, 'support': 47928}, '1': {'precision': 0.3155087550806908, 'recall': 0.85694987888951, 'f1-score': 0.46121062461611745, 'support': 42936}, '2': {'precision': 0.3476082361230721, 'recall': 0.0980262286395549, 'f1-score': 0.15292679146503177, 'support': 45294}, 'accuracy': 0.3186004494778125, 'macro avg': {'precision': 0.3267480754384446, 'recall': 0.3332505347024219, 'f1-score': 0.23086964666214738, 'support': 136158}, 'weighted avg': {'precision': 0.32675660247308524, 'recall': 0.3186004494778125, 'f1-score': 0.22393240697474737, 'support': 136158}}
[[ 2146 41250  4532]
 [ 2341 36794  3801]
 [ 2280 38574  4440]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
4457/4457 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.171548
{'0': {'precision': 0.36983052387659593, 'recall': 0.09964693380865869, 'f1-score': 0.1569935984353874, 'support': 408422}, '1': {'precision': 0.3077932590188352, 'recall': 0.7674930786346368, 'f1-score': 0.43937914521049665, 'support': 353254}, '2': {'precision': 0.3321804841966374, 'recall': 0.13142692923226193, 'f1-score': 0.18833806243931192, 'support': 379283}, 'accuracy': 0.31698422116833297, 'macro avg': {'precision': 0.33660142236402285, 'recall': 0.33285564722518585, 'f1-score': 0.26157026869506533, 'support': 1140959}, 'weighted avg': {'precision': 0.3381072700524032, 'recall': 0.31698422116833297, 'f1-score': 0.25484307968869707, 'support': 1140959}}
[[ 40698 316422  51302]
 [ 33221 271120  48913]
 [ 36126 293309  49848]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1643285
{'0': {'precision': 0.3294932514115857, 'recall': 0.11217799728839822, 'f1-score': 0.16737287370272838, 'support': 206520}, '1': {'precision': 0.3295247732610387, 'recall': 0.8535993740219092, 'f1-score': 0.47549048986330034, 'support': 204480}, '2': {'precision': 0.38149648057082247, 'recall': 0.03772820246308472, 'f1-score': 0.06866569188516089, 'support': 209737}, 'accuracy': 0.33125784349893755, 'macro avg': {'precision': 0.3468381684144823, 'recall': 0.3345018579244641, 'f1-score': 0.2371763518170632, 'support': 620737}, 'weighted avg': {'precision': 0.34707468583864093, 'recall': 0.33125784349893755, 'f1-score': 0.23551983764984707, 'support': 620737}}
[[ 23167 176629   6724]
 [ 23831 174544   6105]
 [ 23313 178511   7913]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1716241
{'0': {'precision': 0.3446507847183143, 'recall': 0.0771081640646858, 'f1-score': 0.12602169713181752, 'support': 71484}, '1': {'precision': 0.31193696955652755, 'recall': 0.8615475695222247, 'f1-score': 0.45803507249705455, 'support': 62498}, '2': {'precision': 0.3574599651181227, 'recall': 0.06705829863176681, 'f1-score': 0.11293109925614246, 'support': 67240}, 'accuracy': 0.3173907425629404, 'macro avg': {'precision': 0.3380159064643215, 'recall': 0.3352380107395591, 'f1-score': 0.23232928962833818, 'support': 201222}, 'weighted avg': {'precision': 0.3387704200966614, 'recall': 0.3173907425629404, 'f1-score': 0.22476815692456478, 'support': 201222}}
[[ 5512 61569  4403]
 [ 4951 53845  3702]
 [ 5530 57201  4509]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
4676/4676 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967494
{'0': {'precision': 0.2690807339360405, 'recall': 0.16813992738929295, 'f1-score': 0.20695826646764198, 'support': 329428}, '1': {'precision': 0.4619145819895607, 'recall': 0.83203330969654, 'f1-score': 0.5940398696412148, 'support': 549990}, '2': {'precision': 0.9215686274509803, 'recall': 0.0013319856032194374, 'f1-score': 0.002660126403169512, 'support': 317571}, 'accuracy': 0.4289287537312373, 'macro avg': {'precision': 0.5508546477921938, 'recall': 0.3338350742296841, 'f1-score': 0.2678860875040087, 'support': 1196989}, 'weighted avg': {'precision': 0.5307940169506619, 'recall': 0.42892875373123734, 'f1-score': 0.3306117388813557, 'support': 1196989}}
[[ 55390 274033      5]
 [ 92349 457610     31]
 [ 58110 259038    423]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1616865
{'0': {'precision': 0.3294322562968472, 'recall': 0.09289581298322876, 'f1-score': 0.14492466637968146, 'support': 181203}, '1': {'precision': 0.3362723470089388, 'recall': 0.7844706590028071, 'f1-score': 0.4707516143263948, 'support': 179544}, '2': {'precision': 0.35188011056086604, 'recall': 0.13681140925322677, 'f1-score': 0.1970208684297494, 'support': 178662}, 'accuracy': 0.33763433683902194, 'macro avg': {'precision': 0.33919490462221735, 'recall': 0.33805929374642085, 'f1-score': 0.2708990497119419, 'support': 539409}, 'weighted avg': {'precision': 0.3391441368648947, 'recall': 0.33763433683902194, 'f1-score': 0.2706324042795199, 'support': 539409}}
[[ 16833 139693  24677]
 [ 18353 140847  20344]
 [ 15911 138308  24443]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1528426
{'0': {'precision': 0.25853690570002624, 'recall': 0.058721754045790144, 'f1-score': 0.09570576009140301, 'support': 67045}, '1': {'precision': 0.33815508795565874, 'recall': 0.8122258966461814, 'f1-score': 0.4775084484125328, 'support': 70457}, '2': {'precision': 0.35576728157307924, 'recall': 0.10526157952347394, 'f1-score': 0.16245675341055044, 'support': 66691}, 'accuracy': 0.333919380194228, 'macro avg': {'precision': 0.31748642507625474, 'recall': 0.32540307673848184, 'f1-score': 0.2452236539714954, 'support': 204193}, 'weighted avg': {'precision': 0.31776542609266883, 'recall': 0.333919380194228, 'f1-score': 0.24924854807379762, 'support': 204193}}
[[ 3937 56286  6822]
 [ 7340 57227  5890]
 [ 3951 55720  7020]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
4274/4274 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1464415
{'0': {'precision': 0.2993351327447123, 'recall': 0.11335065685000721, 'f1-score': 0.16443422463476745, 'support': 346350}, '1': {'precision': 0.362243749313126, 'recall': 0.8537211571345229, 'f1-score': 0.5086580232513713, 'support': 397672}, '2': {'precision': 0.40966762668327233, 'recall': 0.030070591327351213, 'f1-score': 0.05602855188602666, 'support': 350043}, 'accuracy': 0.35581615351921503, 'macro avg': {'precision': 0.35708216958037026, 'recall': 0.3323808017706271, 'f1-score': 0.24304026659072178, 'support': 1094065}, 'weighted avg': {'precision': 0.357501797927978, 'recall': 0.35581615351921503, 'f1-score': 0.25486899728307866, 'support': 1094065}}
[[ 39259 298138   8953]
 [ 51956 339501   6215]
 [ 39939 299578  10526]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.16501
{'0': {'precision': 0.32857672754249306, 'recall': 0.0909244600624317, 'f1-score': 0.14243421674895484, 'support': 165621}, '1': {'precision': 0.32925665432313544, 'recall': 0.7933731368310109, 'f1-score': 0.46537761018130985, 'support': 166987}, '2': {'precision': 0.3388850458504053, 'recall': 0.11109948131091107, 'f1-score': 0.16733887742992148, 'support': 171972}, 'accuracy': 0.33027072020294107, 'macro avg': {'precision': 0.33223947590534464, 'recall': 0.3317990260681179, 'f1-score': 0.2583835681200621, 'support': 504580}, 'weighted avg': {'precision': 0.3323150466383102, 'recall': 0.33027072020294107, 'f1-score': 0.25779799007670434, 'support': 504580}}
[[ 15059 132118  18444]
 [ 15675 132483  18829]
 [ 15097 137769  19106]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1530949
{'0': {'precision': 0.27299646575604164, 'recall': 0.04743253559929631, 'f1-score': 0.08082236330472406, 'support': 60254}, '1': {'precision': 0.3405168052773225, 'recall': 0.8056171706694327, 'f1-score': 0.47869828657039093, 'support': 62665}, '2': {'precision': 0.32708371163973127, 'recall': 0.12457854240511801, 'f1-score': 0.1804339932133779, 'support': 57835}, 'accuracy': 0.33496907399006387, 'macro avg': {'precision': 0.3135323275576985, 'recall': 0.32587608289128234, 'f1-score': 0.2466515476961643, 'support': 180754}, 'weighted avg': {'precision': 0.3137109060549244, 'recall': 0.33496907399006387, 'f1-score': 0.2506328977726197, 'support': 180754}}
[[ 2858 50033  7363]
 [ 4721 50484  7460]
 [ 2890 47740  7205]]
testing model on single stock: results/universal/W4/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
12724/12724 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1196744
{'0': {'precision': 0.2831569974427117, 'recall': 0.1148842035157074, 'f1-score': 0.16345175345053473, 'support': 933923}, '1': {'precision': 0.41602849343168863, 'recall': 0.8834783186134537, 'f1-score': 0.5656794569531637, 'support': 1355310}, '2': {'precision': 0.3118279569892473, 'recall': 2.9961339540496366e-05, 'f1-score': 5.9916922088373335e-05, 'support': 967914}, 'accuracy': 0.4005680431371381, 'macro avg': {'precision': 0.3370044826212159, 'recall': 0.3327974944895672, 'f1-score': 0.24306370910859562, 'support': 3257147}, 'weighted avg': {'precision': 0.3469653212203447, 'recall': 0.4005680431371381, 'f1-score': 0.2822655444070232, 'support': 3257147}}
[[ 107293  826603      27]
 [ 157886 1197387      37]
 [ 113738  854147      29]]
Evaluating performance on  train set...
5165/5165 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1666787
{'0': {'precision': 0.33818457191584683, 'recall': 0.12063368835862094, 'f1-score': 0.17783273155599877, 'support': 440532}, '1': {'precision': 0.32581895946708295, 'recall': 0.8370027055208242, 'f1-score': 0.46905103128907444, 'support': 435406}, '2': {'precision': 0.30305575295561726, 'recall': 0.031542213177217344, 'f1-score': 0.057137521036295096, 'support': 446164}, 'accuracy': 0.32648918162138774, 'macro avg': {'precision': 0.3223530947795157, 'recall': 0.3297262023522209, 'f1-score': 0.23467376129378945, 'support': 1322102}, 'weighted avg': {'precision': 0.32225745264937694, 'recall': 0.32648918162138774, 'f1-score': 0.2330087596591757, 'support': 1322102}}
[[ 53143 375033  12356]
 [ 50962 364436  20008]
 [ 53037 379054  14073]]
Evaluating performance on  val set...
1903/1903 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1643785
{'0': {'precision': 0.26437491725872647, 'recall': 0.07385127430737465, 'f1-score': 0.11545187818872941, 'support': 162245}, '1': {'precision': 0.32624109888331443, 'recall': 0.7851483099842987, 'f1-score': 0.46095031209023646, 'support': 164318}, '2': {'precision': 0.3524512137077582, 'recall': 0.10154141501025325, 'f1-score': 0.15766068741259756, 'support': 160437}, 'accuracy': 0.3229712525667351, 'macro avg': {'precision': 0.3143557432832664, 'recall': 0.3201803331006422, 'f1-score': 0.24468762589718782, 'support': 487000}, 'weighted avg': {'precision': 0.31426490494986065, 'recall': 0.3229712525667351, 'f1-score': 0.245931275287862, 'support': 487000}}
[[ 11982 133918  16345]
 [ 21718 129014  13586]
 [ 11622 132524  16291]]
training model: results/universal/W4/deepLOB_L1/h1000
Epoch 1/50
9854/9854 - 160s - loss: 3.1579 - accuracy1000: 0.4432 - val_loss: 3.5198 - val_accuracy1000: 0.3074 - 160s/epoch - 16ms/step
Epoch 2/50
9854/9854 - 154s - loss: 3.1222 - accuracy1000: 0.4572 - val_loss: 3.9242 - val_accuracy1000: 0.3438 - 154s/epoch - 16ms/step
Epoch 3/50
9854/9854 - 154s - loss: 3.1035 - accuracy1000: 0.4645 - val_loss: 3.8745 - val_accuracy1000: 0.3460 - 154s/epoch - 16ms/step
Epoch 4/50
9854/9854 - 158s - loss: 3.0885 - accuracy1000: 0.4696 - val_loss: 3.9125 - val_accuracy1000: 0.3484 - 158s/epoch - 16ms/step
Epoch 5/50
9854/9854 - 157s - loss: 3.0733 - accuracy1000: 0.4745 - val_loss: 4.0231 - val_accuracy1000: 0.3451 - 157s/epoch - 16ms/step
Epoch 6/50
9854/9854 - 152s - loss: 3.0663 - accuracy1000: 0.4769 - val_loss: 4.0345 - val_accuracy1000: 0.3387 - 152s/epoch - 15ms/step
Epoch 7/50
9854/9854 - 152s - loss: 3.0580 - accuracy1000: 0.4799 - val_loss: 4.0325 - val_accuracy1000: 0.3394 - 152s/epoch - 15ms/step
Epoch 8/50
9854/9854 - 153s - loss: 3.0537 - accuracy1000: 0.4807 - val_loss: 4.0463 - val_accuracy1000: 0.3378 - 153s/epoch - 16ms/step
Epoch 9/50
9854/9854 - 155s - loss: 3.0493 - accuracy1000: 0.4823 - val_loss: 4.1251 - val_accuracy1000: 0.3392 - 155s/epoch - 16ms/step
Epoch 10/50
9854/9854 - 152s - loss: 3.0408 - accuracy1000: 0.4848 - val_loss: 4.1560 - val_accuracy1000: 0.3397 - 152s/epoch - 15ms/step
Epoch 11/50
9854/9854 - 156s - loss: 3.0381 - accuracy1000: 0.4855 - val_loss: 4.2400 - val_accuracy1000: 0.3392 - 156s/epoch - 16ms/step
testing model in sample: results/universal/W4/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1284841
{'0': {'precision': 0.27386401860274656, 'recall': 0.01991837359874146, 'f1-score': 0.03713582558100334, 'support': 1880274}, '1': {'precision': 0.38047918250036367, 'recall': 0.9672157842964626, 'f1-score': 0.5461257628426617, 'support': 2265999}, '2': {'precision': 0.392594120917224, 'recall': 0.03557831842182077, 'f1-score': 0.06524398752095992, 'support': 1925358}, 'accuracy': 0.37842599459683895, 'macro avg': {'precision': 0.3489791073401114, 'recall': 0.3409041587723416, 'f1-score': 0.216168525314875, 'support': 6071631}, 'weighted avg': {'precision': 0.35130413429963825, 'recall': 0.37842599459683895, 'f1-score': 0.23600973002305053, 'support': 6071631}}
[[  37452 1774823   67999]
 [  36306 2191710   37983]
 [  62996 1793861   68501]]
Evaluating performance on  train set...
9854/9854 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1625994
{'0': {'precision': 0.3335217421192933, 'recall': 0.051818544310106664, 'f1-score': 0.08970051552374604, 'support': 842652}, '1': {'precision': 0.3274034607642885, 'recall': 0.8426527243365619, 'f1-score': 0.4715797782761464, 'support': 836589}, '2': {'precision': 0.3232141956525394, 'recall': 0.0912494156230941, 'f1-score': 0.14231940113443942, 'support': 842778}, 'accuracy': 0.32732584488855954, 'macro avg': {'precision': 0.3280464661787071, 'recall': 0.3285735614232542, 'f1-score': 0.23453323164477727, 'support': 2522019}, 'weighted avg': {'precision': 0.32804777056053025, 'recall': 0.32732584488855954, 'f1-score': 0.23395875851238998, 'support': 2522019}}
[[ 43665 723669  75318]
 [ 45924 704954  85711]
 [ 41332 724543  76903]]
Evaluating performance on  val set...
3566/3566 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1741011
{'0': {'precision': 0.21046221208103358, 'recall': 0.04376989941676473, 'f1-score': 0.07246849974651155, 'support': 311881}, '1': {'precision': 0.31117831585788847, 'recall': 0.7860153449257882, 'f1-score': 0.44584823995020834, 'support': 298470}, '2': {'precision': 0.34610740048089766, 'recall': 0.10724136675044123, 'f1-score': 0.16374603110401034, 'support': 302001}, 'accuracy': 0.30760057521658307, 'macro avg': {'precision': 0.28924930947327326, 'recall': 0.3123422036976647, 'f1-score': 0.22735425693357672, 'support': 912352}, 'weighted avg': {'precision': 0.28831124188118223, 'recall': 0.30760057521658307, 'f1-score': 0.22483135619456382, 'support': 912352}}
[[ 13651 265351  32879]
 [ 35559 234602  28309]
 [ 15652 253962  32387]]
testing model out of sample: results/universal/W4/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1529762
{'0': {'precision': 0.3398499037919348, 'recall': 0.05723079393018004, 'f1-score': 0.0979643680626307, 'support': 1021513}, '1': {'precision': 0.341670690562357, 'recall': 0.8417611744973155, 'f1-score': 0.48605269178648747, 'support': 1049913}, '2': {'precision': 0.31151186132723785, 'recall': 0.0885623651345114, 'f1-score': 0.13791554357592092, 'support': 960216}, 'accuracy': 0.3388516849944683, 'macro avg': {'precision': 0.3310108185605099, 'recall': 0.3291847778540023, 'f1-score': 0.2406442011416797, 'support': 3031642}, 'weighted avg': {'precision': 0.3315049296548872, 'recall': 0.3388516849944683, 'f1-score': 0.24502023223543049, 'support': 3031642}}
[[ 58462 880064  82987]
 [ 61175 883776 104962]
 [ 52386 822791  85039]]
Evaluating performance on  train set...
5528/5528 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1601269
{'0': {'precision': 0.3284432402361256, 'recall': 0.06926210365091952, 'f1-score': 0.11439961820145614, 'support': 460295}, '1': {'precision': 0.32770203846320467, 'recall': 0.8361876174522326, 'f1-score': 0.47087004405286337, 'support': 470404}, '2': {'precision': 0.3380992646116791, 'recall': 0.08182692009550091, 'f1-score': 0.1317642124604308, 'support': 483765}, 'accuracy': 0.3286135242749197, 'macro avg': {'precision': 0.3314148477703365, 'recall': 0.3290922137328844, 'f1-score': 0.23901129157158343, 'support': 1414464}, 'weighted avg': {'precision': 0.33149922635754725, 'recall': 0.3286135242749197, 'f1-score': 0.238888821987412, 'support': 1414464}}
[[ 31881 392534  35880]
 [ 35442 393346  41616]
 [ 29744 414436  39585]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1684048
{'0': {'precision': 0.30796996823563383, 'recall': 0.05036391648515114, 'f1-score': 0.08657051103185515, 'support': 169407}, '1': {'precision': 0.3247167000915127, 'recall': 0.8374993722693718, 'f1-score': 0.46798532382983504, 'support': 159304}, '2': {'precision': 0.34730123773985033, 'recall': 0.10718286282456295, 'f1-score': 0.16381097106474246, 'support': 158906}, 'accuracy': 0.3260366230053505, 'macro avg': {'precision': 0.32666263535566564, 'recall': 0.33168205052636196, 'f1-score': 0.23945560197547752, 'support': 487617}, 'weighted avg': {'precision': 0.32625849403232665, 'recall': 0.3260366230053505, 'f1-score': 0.23634969813967827, 'support': 487617}}
[[  8532 144444  16431]
 [ 10309 133417  15578]
 [  8863 133011  17032]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2009515
{'0': {'precision': 0.3278141445257348, 'recall': 0.04620868086338224, 'f1-score': 0.0809996511369763, 'support': 55271}, '1': {'precision': 0.28054151751245876, 'recall': 0.8354016982364467, 'f1-score': 0.4200300819042239, 'support': 38275}, '2': {'precision': 0.3478202458520857, 'recall': 0.12011691565370697, 'f1-score': 0.1785671178549875, 'support': 43108}, 'accuracy': 0.2905659548933804, 'macro avg': {'precision': 0.3187253026300931, 'recall': 0.3339090982511787, 'f1-score': 0.22653228363206257, 'support': 136654}, 'weighted avg': {'precision': 0.3208846965552633, 'recall': 0.2905659548933804, 'f1-score': 0.2067356566172142, 'support': 136654}}
[[ 2554 47063  5654]
 [ 2245 31975  4055]
 [ 2992 34938  5178]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1606153
{'0': {'precision': 0.31489888567891045, 'recall': 0.07145532871324219, 'f1-score': 0.11647965804137089, 'support': 21356}, '1': {'precision': 0.33136415370440625, 'recall': 0.8565424488652283, 'f1-score': 0.47786158114814964, 'support': 21414}, '2': {'precision': 0.3742875237492084, 'recall': 0.07998736804114409, 'f1-score': 0.13180686168828756, 'support': 22166}, 'accuracy': 0.3332666009609462, 'macro avg': {'precision': 0.34018352104417504, 'recall': 0.33599504853987155, 'f1-score': 0.24204936695926937, 'support': 64936}, 'weighted avg': {'precision': 0.34060105090257975, 'recall': 0.3332666009609462, 'f1-score': 0.24088484618733175, 'support': 64936}}
[[ 1526 18279  1551]
 [ 1659 18342  1413]
 [ 1661 18732  1773]]
Evaluating performance on  val set...
81/81 - 1s - 605ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1868361
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7433}, '1': {'precision': 0.2703052250387998, 'recall': 0.9462151394422311, 'f1-score': 0.42048929663608564, 'support': 5522}, '2': {'precision': 0.38812042310821804, 'recall': 0.06225528582615505, 'f1-score': 0.10729951636486333, 'support': 7662}, 'accuracy': 0.27656788087500606, 'macro avg': {'precision': 0.21947521604900597, 'recall': 0.33615680842279544, 'f1-score': 0.17592960433364965, 'support': 20617}, 'weighted avg': {'precision': 0.2166369566144162, 'recall': 0.27656788087500606, 'f1-score': 0.15249894700548322, 'support': 20617}}
[[   0 6978  455]
 [   0 5225  297]
 [  58 7127  477]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
1613/1613 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2094126
{'0': {'precision': 0.19561031959953792, 'recall': 0.0031946470795391657, 'f1-score': 0.006286622982062086, 'support': 159016}, '1': {'precision': 0.24805611201751307, 'recall': 0.9514516001267427, 'f1-score': 0.39351707756573023, 'support': 100992}, '2': {'precision': 0.2990298898793917, 'recall': 0.04477201797946886, 'f1-score': 0.07788305591122494, 'support': 152841}, 'accuracy': 0.25055165447899835, 'macro avg': {'precision': 0.24756544049881424, 'recall': 0.3331394217285836, 'f1-score': 0.1592289188196724, 'support': 412849}, 'weighted avg': {'precision': 0.24672672295529094, 'recall': 0.25055165447899835, 'f1-score': 0.12751750515602883, 'support': 412849}}
[[   508 147062  11446]
 [   308  96089   4595]
 [  1781 144217   6843]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1698222
{'0': {'precision': 0.3067029433588919, 'recall': 0.06765358454879423, 'f1-score': 0.11085450346420324, 'support': 54986}, '1': {'precision': 0.32646045394196116, 'recall': 0.7672263288882285, 'f1-score': 0.45802703212143386, 'support': 53842}, '2': {'precision': 0.3277496705072063, 'recall': 0.14447692942014317, 'f1-score': 0.20054891452802454, 'support': 53358}, 'accuracy': 0.3251698666962623, 'macro avg': {'precision': 0.32030435593601975, 'recall': 0.32645228095238865, 'f1-score': 0.2564768167045539, 'support': 162186}, 'weighted avg': {'precision': 0.3201861980910721, 'recall': 0.3251698666962623, 'f1-score': 0.25561655242962555, 'support': 162186}}
[[ 3720 43281  7985]
 [ 4706 41309  7827]
 [ 3703 41946  7709]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1909442
{'0': {'precision': 0.3333333333333333, 'recall': 5.0286633812732576e-05, 'f1-score': 0.00010055809744079642, 'support': 19886}, '1': {'precision': 0.26167508487207086, 'recall': 0.917543732307469, 'f1-score': 0.4072159136667472, 'support': 13777}, '2': {'precision': 0.35324734102738176, 'recall': 0.08186919809094247, 'f1-score': 0.1329302563229158, 'support': 19067}, 'accuracy': 0.26935330931158735, 'macro avg': {'precision': 0.31608525307759533, 'recall': 0.33315440567740806, 'f1-score': 0.18008224269570128, 'support': 52730}, 'weighted avg': {'precision': 0.3218117079901057, 'recall': 0.26935330931158735, 'f1-score': 0.15450018088794842, 'support': 52730}}
[[    1 18163  1722]
 [    0 12641  1136]
 [    2 17504  1561]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1477283
{'0': {'precision': 0.25065250652506527, 'recall': 0.06341435646382422, 'f1-score': 0.10122027676567598, 'support': 87835}, '1': {'precision': 0.3640436977645812, 'recall': 0.8799939467312349, 'f1-score': 0.515026618038268, 'support': 92512}, '2': {'precision': 0.3061797752808989, 'recall': 0.030018451708848558, 'f1-score': 0.05467633116801686, 'support': 72622}, 'accuracy': 0.35245425328795227, 'macro avg': {'precision': 0.30695865985684845, 'recall': 0.3244755849679692, 'f1-score': 0.22364107532398694, 'support': 252969}, 'weighted avg': {'precision': 0.3080609130710699, 'recall': 0.35245425328795227, 'f1-score': 0.2391895055115572, 'support': 252969}}
[[ 5570 79920  2345]
 [ 8507 81410  2595]
 [ 8145 62297  2180]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1452731
{'0': {'precision': 0.3677854055428426, 'recall': 0.1030968247745982, 'f1-score': 0.16104879338658948, 'support': 28061}, '1': {'precision': 0.3221511659959204, 'recall': 0.8153341705036975, 'f1-score': 0.4618272346479096, 'support': 28668}, '2': {'precision': 0.382843137254902, 'recall': 0.07858987689933922, 'f1-score': 0.13040937299974953, 'support': 29813}, 'accuracy': 0.33059092694876474, 'macro avg': {'precision': 0.357593236264555, 'recall': 0.3323402907258783, 'f1-score': 0.25109513367808284, 'support': 86542}, 'weighted avg': {'precision': 0.35785581963311625, 'recall': 0.33059092694876474, 'f1-score': 0.25012997147453137, 'support': 86542}}
[[ 2893 23203  1965]
 [ 3482 23374  1812]
 [ 1491 25979  2343]]
Evaluating performance on  val set...
124/124 - 1s - 818ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2048846
{'0': {'precision': 0.32964453386988596, 'recall': 0.09190351533283471, 'f1-score': 0.14373446410293905, 'support': 10696}, '1': {'precision': 0.2924258963808884, 'recall': 0.7622017947034362, 'f1-score': 0.4226847918436703, 'support': 9138}, '2': {'precision': 0.3632713440405748, 'recall': 0.14694819627286715, 'f1-score': 0.20925136944613512, 'support': 11698}, 'accuracy': 0.3065774451351008, 'macro avg': {'precision': 0.3284472580971164, 'recall': 0.33368450210304595, 'f1-score': 0.2585568751309148, 'support': 31532}, 'weighted avg': {'precision': 0.3313336914241882, 'recall': 0.3065774451351008, 'f1-score': 0.24888050157596675, 'support': 31532}}
[[ 983 8047 1666]
 [ 826 6965 1347]
 [1173 8806 1719]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1484649
{'0': {'precision': 0.1985766117778398, 'recall': 0.04045084355501229, 'f1-score': 0.06721061767171652, 'support': 70357}, '1': {'precision': 0.38020156412320505, 'recall': 0.9592112279746304, 'f1-score': 0.544557452866041, 'support': 88137}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78200}, 'accuracy': 0.36920243014187093, 'macro avg': {'precision': 0.19292605863368162, 'recall': 0.3332206905098809, 'f1-score': 0.2039226901792525, 'support': 236694}, 'weighted avg': {'precision': 0.2006011133868218, 'recall': 0.36920243014187093, 'f1-score': 0.2227534185521526, 'support': 236694}}
[[ 2846 67510     1]
 [ 3595 84542     0]
 [ 7891 70309     0]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1903304
{'0': {'precision': 0.24839331619537275, 'recall': 0.07853030816119201, 'f1-score': 0.11933309319199302, 'support': 29530}, '1': {'precision': 0.33215538060607713, 'recall': 0.8314207650273224, 'f1-score': 0.4746760780337523, 'support': 29280}, '2': {'precision': 0.29143530203600876, 'recall': 0.058198924731182794, 'f1-score': 0.09702265916029465, 'support': 29760}, 'accuracy': 0.32059388054646043, 'macro avg': {'precision': 0.2906613329458196, 'recall': 0.3227166659732324, 'f1-score': 0.23034394346201328, 'support': 88570}, 'weighted avg': {'precision': 0.2905462206163138, 'recall': 0.32059388054646043, 'f1-score': 0.2293080743298881, 'support': 88570}}
[[ 2319 24766  2445]
 [ 3170 24344  1766]
 [ 3847 24181  1732]]
Evaluating performance on  val set...
127/127 - 1s - 800ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1876132
{'0': {'precision': 0.40160284951024044, 'recall': 0.042411134098175665, 'f1-score': 0.07672025176490602, 'support': 10634}, '1': {'precision': 0.2951197053406998, 'recall': 0.7858602370249285, 'f1-score': 0.42909740042396516, 'support': 9788}, '2': {'precision': 0.2879622344610543, 'recall': 0.12355473035699215, 'f1-score': 0.17291678970058466, 'support': 11849}, 'accuracy': 0.2976976232530755, 'macro avg': {'precision': 0.32822826310399816, 'recall': 0.3172753671600321, 'f1-score': 0.22624481396315196, 'support': 32271}, 'weighted avg': {'precision': 0.32758020804114213, 'recall': 0.2976976232530755, 'f1-score': 0.21891913959220383, 'support': 32271}}
[[ 451 8388 1795]
 [ 271 7692 1825]
 [ 401 9984 1464]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
1590/1590 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1510785
{'0': {'precision': 0.4976452119309262, 'recall': 0.04701938622643469, 'f1-score': 0.08592066568187672, 'support': 134838}, '1': {'precision': 0.34925351288056206, 'recall': 0.853025503893151, 'f1-score': 0.495595697263122, 'support': 139861}, '2': {'precision': 0.32044440224100273, 'recall': 0.12753975932756847, 'f1-score': 0.18245913782569434, 'support': 132296}, 'accuracy': 0.3501713780267571, 'macro avg': {'precision': 0.3891143756841637, 'recall': 0.3425282164823847, 'f1-score': 0.2546585002568977, 'support': 406995}, 'weighted avg': {'precision': 0.38905132321086555, 'recall': 0.3501713780267571, 'f1-score': 0.2580830099434107, 'support': 406995}}
[[  6340 110364  18134]
 [  2908 119305  17648]
 [  3492 111931  16873]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.171259
{'0': {'precision': 0.3151807228915663, 'recall': 0.05803274324504193, 'f1-score': 0.09801791000037469, 'support': 45078}, '1': {'precision': 0.32330039063515026, 'recall': 0.8331510457355863, 'f1-score': 0.46583548616571196, 'support': 44801}, '2': {'precision': 0.3222908881862604, 'recall': 0.0938480853735091, 'f1-score': 0.14536673905292838, 'support': 47790}, 'accuracy': 0.3227088160733353, 'macro avg': {'precision': 0.32025733390432565, 'recall': 0.3283439581180458, 'f1-score': 0.23640671173967168, 'support': 137669}, 'weighted avg': {'precision': 0.3202912709017482, 'recall': 0.3227088160733353, 'f1-score': 0.23415164940579505, 'support': 137669}}
[[ 2616 37350  5112]
 [ 3156 37326  4319]
 [ 2528 40777  4485]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1662905
{'0': {'precision': 0.34546602146013045, 'recall': 0.08292929292929294, 'f1-score': 0.1337514763979962, 'support': 19800}, '1': {'precision': 0.30460861509958315, 'recall': 0.7656441003550847, 'f1-score': 0.435825643234646, 'support': 17179}, '2': {'precision': 0.33009534088864906, 'recall': 0.11112456852177073, 'f1-score': 0.16627401232330555, 'support': 16513}, 'accuracy': 0.3108876093621476, 'macro avg': {'precision': 0.3267233258161209, 'recall': 0.31989932060204945, 'f1-score': 0.2452837106519826, 'support': 53492}, 'weighted avg': {'precision': 0.3275996969229153, 'recall': 0.3108876093621476, 'f1-score': 0.24080256343571102, 'support': 53492}}
[[ 1642 16185  1973]
 [ 2275 13153  1751]
 [  836 13842  1835]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
3782/3782 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2305963
{'0': {'precision': 0.335666656132478, 'recall': 0.06038768879147869, 'f1-score': 0.10236036457116147, 'support': 351777}, '1': {'precision': 0.21862749258656086, 'recall': 0.7777442289456179, 'f1-score': 0.341310912330137, 'support': 211963}, '2': {'precision': 0.4043152094536281, 'recall': 0.15066846110456888, 'f1-score': 0.21952916325728764, 'support': 404212}, 'accuracy': 0.25517587648974327, 'macro avg': {'precision': 0.3195364527242223, 'recall': 0.3296001262805552, 'f1-score': 0.22106681338619538, 'support': 967952}, 'weighted avg': {'precision': 0.3387046133993316, 'recall': 0.25517587648974327, 'f1-score': 0.20361508526924585, 'support': 967952}}
[[ 21243 273920  56614]
 [ 13996 164853  33114]
 [ 28047 315263  60902]]
Evaluating performance on  train set...
1601/1601 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.170633
{'0': {'precision': 0.29155238617663193, 'recall': 0.023027598457605825, 'f1-score': 0.04268390619980726, 'support': 138486}, '1': {'precision': 0.3217777643449745, 'recall': 0.7922681946718262, 'f1-score': 0.4576728390417952, 'support': 134380}, '2': {'precision': 0.327598640156588, 'recall': 0.16261706821734875, 'f1-score': 0.21734566846486197, 'support': 136886}, 'accuracy': 0.3219361955524317, 'macro avg': {'precision': 0.3136429302260648, 'recall': 0.32597095378226026, 'f1-score': 0.23923413790215484, 'support': 409752}, 'weighted avg': {'precision': 0.31350691926142993, 'recall': 0.3219361955524317, 'f1-score': 0.23713070032093567, 'support': 409752}}
[[  3189 112827  22470]
 [  4696 106465  23219]
 [  3053 111573  22260]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1909045
{'0': {'precision': 0.18392370572207084, 'recall': 0.02700594130708756, 'f1-score': 0.04709658288126428, 'support': 49989}, '1': {'precision': 0.28048939103592396, 'recall': 0.8021623766304617, 'f1-score': 0.4156424868136175, 'support': 40326}, '2': {'precision': 0.33511229708694684, 'recall': 0.09861920031411557, 'f1-score': 0.15239154616240266, 'support': 45843}, 'accuracy': 0.28069595616856885, 'macro avg': {'precision': 0.2665084646149805, 'recall': 0.3092625060838883, 'f1-score': 0.20504353861909483, 'support': 136158}, 'weighted avg': {'precision': 0.2634272708442557, 'recall': 0.28069595616856885, 'f1-score': 0.19170078626023065, 'support': 136158}}
[[ 1350 43911  4728]
 [ 3736 32348  4242]
 [ 2254 39068  4521]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1258138
{'0': {'precision': 0.34536464080680535, 'recall': 0.0697919930447939, 'f1-score': 0.1161185183793659, 'support': 354267}, '1': {'precision': 0.4094912241034576, 'recall': 0.7857495289258659, 'f1-score': 0.5383978677485308, 'support': 470202}, '2': {'precision': 0.2720794140877432, 'recall': 0.1436727858700117, 'f1-score': 0.18804666531572703, 'support': 316490}, 'accuracy': 0.3853398763671613, 'macro avg': {'precision': 0.3423117596660021, 'recall': 0.3330714359468905, 'f1-score': 0.28085435048120794, 'support': 1140959}, 'weighted avg': {'precision': 0.3514633755684721, 'recall': 0.3853398763671613, 'f1-score': 0.31009668398914597, 'support': 1140959}}
[[ 24725 282309  47233]
 [ 26321 369461  74420]
 [ 20545 250474  45471]]
Evaluating performance on  train set...
2425/2425 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.158334
{'0': {'precision': 0.3136628558619144, 'recall': 0.08230720966255564, 'f1-score': 0.13039730367793242, 'support': 204004}, '1': {'precision': 0.3249904177136202, 'recall': 0.8564666614615865, 'f1-score': 0.47118674554052625, 'support': 204928}, '2': {'precision': 0.3845870478155161, 'recall': 0.049290621090153676, 'f1-score': 0.08738193186050695, 'support': 211805}, 'accuracy': 0.3266198083890601, 'macro avg': {'precision': 0.3410801071303502, 'recall': 0.3293548307380986, 'f1-score': 0.22965532702632185, 'support': 620737}, 'weighted avg': {'precision': 0.34160292238264534, 'recall': 0.3266198083890601, 'f1-score': 0.22822686420715468, 'support': 620737}}
[[ 16791 179714   7499]
 [ 20207 175514   9207]
 [ 16534 184831  10440]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1550933
{'0': {'precision': 0.26700342774670754, 'recall': 0.043577475156422525, 'f1-score': 0.07492627608813963, 'support': 67925}, '1': {'precision': 0.3512386420143755, 'recall': 0.8833904182595966, 'f1-score': 0.5026300787204192, 'support': 70363}, '2': {'precision': 0.3724179829890644, 'recall': 0.07792290335907459, 'f1-score': 0.12887966150692493, 'support': 62934}, 'accuracy': 0.3479838188667243, 'macro avg': {'precision': 0.3302200175833825, 'recall': 0.33496359892503125, 'f1-score': 0.23547867210516124, 'support': 201222}, 'weighted avg': {'precision': 0.32942802347251493, 'recall': 0.3479838188667243, 'f1-score': 0.24135949423804828, 'support': 201222}}
[[ 2960 60741  4224]
 [ 4165 62158  4040]
 [ 3961 54069  4904]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1597863
{'0': {'precision': 0.2297845935644003, 'recall': 0.03191044099978334, 'f1-score': 0.05603872253676717, 'support': 406168}, '1': {'precision': 0.3431239968372676, 'recall': 0.9551865070931082, 'f1-score': 0.5048829398616532, 'support': 409341}, '2': {'precision': 0.8222013170272813, 'recall': 0.002291076858550907, 'f1-score': 0.004569420953984258, 'support': 381480}, 'accuracy': 0.33820862180020034, 'macro avg': {'precision': 0.46503663580964966, 'recall': 0.32979600831714745, 'f1-score': 0.18849702778413488, 'support': 1196989}, 'weighted avg': {'precision': 0.45734691564232977, 'recall': 0.33820862180020034, 'f1-score': 0.19312923180308972, 'support': 1196989}}
[[ 12961 393204      3]
 [ 18158 390997    186]
 [ 25286 355320    874]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1672039
{'0': {'precision': 0.37341262743695225, 'recall': 0.0924688439456769, 'f1-score': 0.14823098189047307, 'support': 180623}, '1': {'precision': 0.3456191682315094, 'recall': 0.7844646721622917, 'f1-score': 0.4798334739575702, 'support': 181599}, '2': {'precision': 0.3479799755148547, 'recall': 0.16202091575567057, 'f1-score': 0.22109778732777277, 'support': 177187}, 'accuracy': 0.3482848821580656, 'macro avg': {'precision': 0.35567059039443877, 'recall': 0.34631814395454635, 'f1-score': 0.28305408105860536, 'support': 539409}, 'weighted avg': {'precision': 0.35570139218805963, 'recall': 0.3482848821580656, 'f1-score': 0.28380478880120613, 'support': 539409}}
[[ 16702 135666  28255]
 [ 13605 142458  25536]
 [ 14421 134058  28708]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.177784
{'0': {'precision': 0.2885403137176541, 'recall': 0.04033913930132834, 'f1-score': 0.07078257885836131, 'support': 71593}, '1': {'precision': 0.29631958636832084, 'recall': 0.8297247945741489, 'f1-score': 0.4366856441696735, 'support': 61336}, '2': {'precision': 0.3727325400008914, 'recall': 0.117352379883251, 'f1-score': 0.17850396473890356, 'support': 71264}, 'accuracy': 0.3043346245953583, 'macro avg': {'precision': 0.3191974800289554, 'recall': 0.3291387712529094, 'f1-score': 0.22865739592231274, 'support': 204193}, 'weighted avg': {'precision': 0.3202604230316361, 'recall': 0.3043346245953583, 'f1-score': 0.21828855240948994, 'support': 204193}}
[[ 2888 60994  7711]
 [ 4081 50892  6363]
 [ 3040 59861  8363]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
4274/4274 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1772498
{'0': {'precision': 0.33187000052055315, 'recall': 0.04912895387128759, 'f1-score': 0.08558777266391158, 'support': 389302}, '1': {'precision': 0.2802935262849485, 'recall': 0.9115908407023811, 'f1-score': 0.4287546986044955, 'support': 309063}, '2': {'precision': 0.48815423474118363, 'recall': 0.03858478645438464, 'f1-score': 0.07151673275141285, 'support': 395700}, 'accuracy': 0.28895266734609004, 'macro avg': {'precision': 0.36677258718222844, 'recall': 0.3331015270093511, 'f1-score': 0.19528640133993994, 'support': 1094065}, 'weighted avg': {'precision': 0.3738248127341097, 'recall': 0.28895266734609004, 'f1-score': 0.1774399835824575, 'support': 1094065}}
[[ 19126 360233   9943]
 [ 21258 281739   6066]
 [ 17247 363185  15268]]
Evaluating performance on  train set...
1972/1972 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.161845
{'0': {'precision': 0.3606767949683306, 'recall': 0.05032880911765433, 'f1-score': 0.08833180563314585, 'support': 161796}, '1': {'precision': 0.3329606633206338, 'recall': 0.8135269325236089, 'f1-score': 0.47252577012453084, 'support': 170593}, '2': {'precision': 0.3135402126060346, 'recall': 0.11870539110638767, 'f1-score': 0.17221187790144155, 'support': 172191}, 'accuracy': 0.33169170399143844, 'macro avg': {'precision': 0.33572589029833305, 'recall': 0.3275203775825503, 'f1-score': 0.2443564845530394, 'support': 504580}, 'weighted avg': {'precision': 0.3352206268686801, 'recall': 0.33169170399143844, 'f1-score': 0.24684818461849792, 'support': 504580}}
[[  8143 133772  19881]
 [  6941 138782  24870]
 [  7493 144258  20440]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1756607
{'0': {'precision': 0.324912201200861, 'recall': 0.045127688700769435, 'f1-score': 0.07924841116330478, 'support': 63553}, '1': {'precision': 0.31227734462471757, 'recall': 0.8059262372596406, 'f1-score': 0.4501371832680429, 'support': 57102}, '2': {'precision': 0.3367130873849662, 'recall': 0.1375896437544718, 'f1-score': 0.1953530127455497, 'support': 60099}, 'accuracy': 0.3162143023114288, 'macro avg': {'precision': 0.3246342110701816, 'recall': 0.3295478565716273, 'f1-score': 0.24157953572563248, 'support': 180754}, 'weighted avg': {'precision': 0.3248444067319563, 'recall': 0.3162143023114288, 'f1-score': 0.23501957592433967, 'support': 180754}}
[[ 2868 52455  8230]
 [ 3023 46020  8059]
 [ 2936 48894  8269]]
testing model on single stock: results/universal/W4/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
12724/12724 - 64s - 64s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0748825
{'0': {'precision': 0.1875, 'recall': 1.3438512087941623e-05, 'f1-score': 2.6875097982128063e-05, 'support': 892956}, '1': {'precision': 0.44688164806449504, 'recall': 0.9999677101553622, 'f1-score': 0.6177107738089808, 'support': 1455566}, '2': {'precision': 0.23076923076923078, 'recall': 6.6033842344201406e-06, 'f1-score': 1.3206390572397983e-05, 'support': 908625}, 'accuracy': 0.4468748263434226, 'macro avg': {'precision': 0.28838362627790864, 'recall': 0.33332925068389485, 'f1-score': 0.20591695176584512, 'support': 3257147}, 'weighted avg': {'precision': 0.3154839727081206, 'recall': 0.4468748263434226, 'f1-score': 0.27605594654667737, 'support': 3257147}}
[[     12  892937       7]
 [     34 1455519      13]
 [     18  908601       6]]
Evaluating performance on  train set...
5165/5165 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1555126
{'0': {'precision': 0.3339081738614449, 'recall': 0.041015700628890706, 'f1-score': 0.07305737846253715, 'support': 439027}, '1': {'precision': 0.3224311655168082, 'recall': 0.8917798888198076, 'f1-score': 0.4736205092346427, 'support': 437488}, '2': {'precision': 0.2807117070654977, 'recall': 0.036646042187047645, 'f1-score': 0.06482887582703564, 'support': 445587}, 'accuracy': 0.32106373033245544, 'macro avg': {'precision': 0.31235034881458357, 'recall': 0.32314721054524864, 'f1-score': 0.20383558784140518, 'support': 1322102}, 'weighted avg': {'precision': 0.31218162970911467, 'recall': 0.32106373033245544, 'f1-score': 0.2028318203372047, 'support': 1322102}}
[[ 18007 406826  14194]
 [ 19698 390143  27647]
 [ 16223 413035  16329]]
Evaluating performance on  val set...
1903/1903 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1650914
{'0': {'precision': 0.1931582136056777, 'recall': 0.05587092171061278, 'f1-score': 0.08667200660210199, 'support': 159779}, '1': {'precision': 0.33376392084323814, 'recall': 0.7561517637076246, 'f1-score': 0.46311137821929194, 'support': 173243}, '2': {'precision': 0.34058016025840115, 'recall': 0.10682694930444608, 'f1-score': 0.16263997033741195, 'support': 153978}, 'accuracy': 0.3210965092402464, 'macro avg': {'precision': 0.2891674315691057, 'recall': 0.30628321157422783, 'f1-score': 0.23747445171960194, 'support': 487000}, 'weighted avg': {'precision': 0.2897879693359646, 'recall': 0.3210965092402464, 'f1-score': 0.2446040008056182, 'support': 487000}}
[[  8927 133934  16918]
 [ 27315 130998  14930]
 [  9974 127555  16449]]
training model: results/universal/W4/deepOF_L1/h300
Epoch 1/50
9854/9854 - 140s - loss: 3.2685 - accuracy300: 0.3802 - val_loss: 3.2869 - val_accuracy300: 0.3497 - 140s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 140s - loss: 3.2668 - accuracy300: 0.3825 - val_loss: 3.2894 - val_accuracy300: 0.3445 - 140s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 138s - loss: 3.2652 - accuracy300: 0.3840 - val_loss: 3.2902 - val_accuracy300: 0.3437 - 138s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 139s - loss: 3.2636 - accuracy300: 0.3850 - val_loss: 3.2894 - val_accuracy300: 0.3445 - 139s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 138s - loss: 3.2623 - accuracy300: 0.3863 - val_loss: 3.2889 - val_accuracy300: 0.3472 - 138s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 140s - loss: 3.2611 - accuracy300: 0.3868 - val_loss: 3.2889 - val_accuracy300: 0.3461 - 140s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 141s - loss: 3.2602 - accuracy300: 0.3875 - val_loss: 3.2890 - val_accuracy300: 0.3460 - 141s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 139s - loss: 3.2596 - accuracy300: 0.3879 - val_loss: 3.2878 - val_accuracy300: 0.3496 - 139s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 136s - loss: 3.2588 - accuracy300: 0.3882 - val_loss: 3.2869 - val_accuracy300: 0.3507 - 136s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 141s - loss: 3.2581 - accuracy300: 0.3888 - val_loss: 3.2888 - val_accuracy300: 0.3459 - 141s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 137s - loss: 3.2575 - accuracy300: 0.3894 - val_loss: 3.2881 - val_accuracy300: 0.3490 - 137s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 121s - 121s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0893795
{'0': {'precision': 0.3505777624102661, 'recall': 0.23832941747477726, 'f1-score': 0.28375607141064035, 'support': 1837826}, '1': {'precision': 0.3851960629867328, 'recall': 0.6016198028970227, 'f1-score': 0.4696754227461639, 'support': 2336951}, '2': {'precision': 0.355701486120246, 'recall': 0.219824191257643, 'f1-score': 0.27172303370292283, 'support': 1896834}, 'accuracy': 0.37237794054988044, 'macro avg': {'precision': 0.3638251038390816, 'recall': 0.35325780387648104, 'f1-score': 0.3417181759532424, 'support': 6071611}, 'weighted avg': {'precision': 0.36550298167911754, 'recall': 0.37237794054988044, 'f1-score': 0.3515568147348787, 'support': 6071611}}
[[ 438008 1091844  307974]
 [ 483692 1405956  447303]
 [ 327689 1152175  416970]]
Evaluating performance on  train set...
9854/9854 - 50s - 50s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965877
{'0': {'precision': 0.3784354665953855, 'recall': 0.23825282205296705, 'f1-score': 0.2924113187844071, 'support': 849736}, '1': {'precision': 0.3273352244554066, 'recall': 0.5918435524802078, 'f1-score': 0.4215311470516345, 'support': 823177}, '2': {'precision': 0.37651222715742405, 'recall': 0.2211291707346947, 'f1-score': 0.27862138351340643, 'support': 849101}, 'accuracy': 0.3478985445758826, 'macro avg': {'precision': 0.3607609727360721, 'recall': 0.3504085150892899, 'f1-score': 0.330854616449816, 'support': 2522014}, 'weighted avg': {'precision': 0.36110900902850684, 'recall': 0.3478985445758826, 'f1-score': 0.32991286518541424, 'support': 2522014}}
[[202452 497332 149952]
 [175013 487192 160972]
 [157506 503834 187761]]
Evaluating performance on  val set...
3566/3566 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961614
{'0': {'precision': 0.3794615769472328, 'recall': 0.23229611286696425, 'f1-score': 0.2881776584908406, 'support': 306910}, '1': {'precision': 0.33213268213268216, 'recall': 0.5959950735154982, 'f1-score': 0.4265564543241673, 'support': 301229}, '2': {'precision': 0.3750074757920262, 'recall': 0.2267315341376023, 'f1-score': 0.28260099111519926, 'support': 304210}, 'accuracy': 0.3505226618322594, 'macro avg': {'precision': 0.362200578290647, 'recall': 0.35167424017335497, 'f1-score': 0.3324450346434024, 'support': 912349}, 'weighted avg': {'precision': 0.36234990392680133, 'recall': 0.3505226618322594, 'f1-score': 0.3320065313319719, 'support': 912349}}
[[ 71294 179840  55776]
 [ 62521 179531  59177]
 [ 54067 181169  68974]]
testing model out of sample: results/universal/W4/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934588
{'0': {'precision': 0.3582515004265458, 'recall': 0.1981428170565677, 'f1-score': 0.25516062719821836, 'support': 962210}, '1': {'precision': 0.38127839628570764, 'recall': 0.6265557460452145, 'f1-score': 0.4740704050434408, 'support': 1150252}, '2': {'precision': 0.3358578397578575, 'recall': 0.22260977414160754, 'f1-score': 0.26775138250234887, 'support': 919160}, 'accuracy': 0.36810855706944995, 'macro avg': {'precision': 0.35846257882337035, 'recall': 0.3491027790811299, 'f1-score': 0.33232747158133596, 'support': 3031622}, 'weighted avg': {'precision': 0.36019876689827646, 'recall': 0.36810855706944995, 'f1-score': 0.3420363420569202, 'support': 3031622}}
[[190655 598654 172901]
 [197842 720697 231713]
 [143685 570861 204614]]
Evaluating performance on  train set...
5528/5528 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096494
{'0': {'precision': 0.3731332212441895, 'recall': 0.2265915915915916, 'f1-score': 0.2819588206718733, 'support': 466200}, '1': {'precision': 0.3323269285919128, 'recall': 0.619901485421811, 'f1-score': 0.4326902109787827, 'support': 467342}, '2': {'precision': 0.3798932178709831, 'recall': 0.20506539685180178, 'f1-score': 0.2663537266510377, 'support': 480910}, 'accuracy': 0.3492242932245138, 'macro avg': {'precision': 0.3617844559023618, 'recall': 0.3505194912884015, 'f1-score': 0.32700091943389786, 'support': 1414452}, 'weighted avg': {'precision': 0.36194899976271894, 'recall': 0.3492242932245138, 'f1-score': 0.3264555329273981, 'support': 1414452}}
[[105637 284380  76183]
 [ 92843 289706  84793]
 [ 84628 297664  98618]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962358
{'0': {'precision': 0.3767662379521517, 'recall': 0.22131222631415012, 'f1-score': 0.2788362394004216, 'support': 163737}, '1': {'precision': 0.34173938569103085, 'recall': 0.6182329477222394, 'f1-score': 0.4401679932115275, 'support': 165711}, '2': {'precision': 0.36599310435124166, 'recall': 0.21207963734533752, 'f1-score': 0.26854642761359226, 'support': 158167}, 'accuracy': 0.35320693579976004, 'macro avg': {'precision': 0.3614995759981414, 'recall': 0.35054160379390903, 'f1-score': 0.3291835534085138, 'support': 487615}, 'weighted avg': {'precision': 0.3613682519646457, 'recall': 0.35320693579976004, 'f1-score': 0.3303255036660917, 'support': 487615}}
[[ 36237  99737  27763]
 [ 32918 102448  30345]
 [ 27024  97599  33544]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1084408
{'0': {'precision': 0.37834499794153975, 'recall': 0.16035595882045017, 'f1-score': 0.22524509803921566, 'support': 51579}, '1': {'precision': 0.2783780348290327, 'recall': 0.6329313470481596, 'f1-score': 0.38668357437519063, 'support': 38061}, '2': {'precision': 0.3488956534050687, 'recall': 0.20967879174643692, 'f1-score': 0.26193829555419734, 'support': 47010}, 'accuracy': 0.3089498719356019, 'macro avg': {'precision': 0.3352062287252137, 'recall': 0.3343220325383489, 'f1-score': 0.2912889893228679, 'support': 136650}, 'weighted avg': {'precision': 0.3403701990415424, 'recall': 0.3089498719356019, 'f1-score': 0.2828335141607146, 'support': 136650}}
[[ 8271 32759 10549]
 [ 6125 24090  7846]
 [ 7465 29688  9857]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010444
{'0': {'precision': 0.35420883438504586, 'recall': 0.1377761311536146, 'f1-score': 0.1983862363296879, 'support': 21593}, '1': {'precision': 0.3359023477524836, 'recall': 0.6987951807228916, 'f1-score': 0.45371122544152603, 'support': 21580}, '2': {'precision': 0.3435271883858775, 'recall': 0.18376912825697347, 'f1-score': 0.23944673971618463, 'support': 21761}, 'accuracy': 0.3396371700495888, 'macro avg': {'precision': 0.3445461235078023, 'recall': 0.3401134800444932, 'f1-score': 0.29718140049579955, 'support': 64934}, 'weighted avg': {'precision': 0.3445452177879073, 'recall': 0.3396371700495888, 'f1-score': 0.29700068914681027, 'support': 64934}}
[[ 2975 14811  3807]
 [ 2665 15080  3835]
 [ 2759 15003  3999]]
Evaluating performance on  val set...
81/81 - 1s - 576ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028137
{'0': {'precision': 0.38095238095238093, 'recall': 0.1561774744027304, 'f1-score': 0.2215336948102246, 'support': 7325}, '1': {'precision': 0.30037805834938297, 'recall': 0.6791935483870968, 'f1-score': 0.41653889905534397, 'support': 6200}, '2': {'precision': 0.3617139677239844, 'recall': 0.18333098293611622, 'f1-score': 0.24333177351427232, 'support': 7091}, 'accuracy': 0.32280752813348856, 'macro avg': {'precision': 0.34768146900858277, 'recall': 0.3395673352419812, 'f1-score': 0.29380145579328026, 'support': 20616}, 'weighted avg': {'precision': 0.35010350685744757, 'recall': 0.32280752813348856, 'f1-score': 0.2876766149892187, 'support': 20616}}
[[1144 4967 1214]
 [ 909 4211 1080]
 [ 950 4841 1300]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
1613/1613 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0900383
{'0': {'precision': 0.4472779282432062, 'recall': 0.21345997443940978, 'f1-score': 0.28899790595475683, 'support': 137712}, '1': {'precision': 0.3325738583109174, 'recall': 0.6518310532289862, 'f1-score': 0.4404325208010616, 'support': 133912}, '2': {'precision': 0.41975644039167975, 'recall': 0.2516410448870919, 'f1-score': 0.31465101247554034, 'support': 141221}, 'accuracy': 0.36871222856035557, 'macro avg': {'precision': 0.3998694089819345, 'recall': 0.3723106908518293, 'f1-score': 0.34802714641045296, 'support': 412845}, 'weighted avg': {'precision': 0.4006578566699691, 'recall': 0.36871222856035557, 'f1-score': 0.34689292587571974, 'support': 412845}}
[[29396 85830 22486]
 [19986 87288 26638]
 [16340 89344 35537]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092045
{'0': {'precision': 0.41384942021884696, 'recall': 0.2318008013318941, 'f1-score': 0.2971597438844197, 'support': 54659}, '1': {'precision': 0.3349262066999007, 'recall': 0.6374302930498896, 'f1-score': 0.43912312025834566, 'support': 53438}, '2': {'precision': 0.39564081960626757, 'recall': 0.21847325703932408, 'f1-score': 0.2815012446847791, 'support': 54089}, 'accuracy': 0.36100526555929613, 'macro avg': {'precision': 0.38147214884167174, 'recall': 0.36256811714036924, 'f1-score': 0.3392613696091815, 'support': 162186}, 'weighted avg': {'precision': 0.3817727694440621, 'recall': 0.36100526555929613, 'f1-score': 0.338712568070604, 'support': 162186}}
[[12670 33488  8501]
 [ 9825 34063  9550]
 [ 8120 34152 11817]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907499
{'0': {'precision': 0.4024455077086656, 'recall': 0.2230800966582189, 'f1-score': 0.2870468678901866, 'support': 16967}, '1': {'precision': 0.351494105287732, 'recall': 0.6632709251101322, 'f1-score': 0.45948729686427103, 'support': 18160}, '2': {'precision': 0.3969743816254417, 'recall': 0.20423815475514145, 'f1-score': 0.2697126566133993, 'support': 17602}, 'accuracy': 0.36839310436382255, 'macro avg': {'precision': 0.38363799820727973, 'recall': 0.36352972550783086, 'f1-score': 0.33874894045595233, 'support': 52729}, 'weighted avg': {'precision': 0.38307134492763306, 'recall': 0.36839310436382255, 'f1-score': 0.3406492764940927, 'support': 52729}}
[[ 3785 10725  2457]
 [ 3111 12045  3004]
 [ 2509 11498  3595]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
989/989 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989707
{'0': {'precision': 0.37384264064770606, 'recall': 0.20512119555312558, 'f1-score': 0.26489754490225215, 'support': 87792}, '1': {'precision': 0.3440881037455336, 'recall': 0.638214302266302, 'f1-score': 0.4471167895061528, 'support': 86308}, '2': {'precision': 0.337925790074031, 'recall': 0.19158054903949787, 'f1-score': 0.24452968213892665, 'support': 78865}, 'accuracy': 0.3486648350562331, 'macro avg': {'precision': 0.3519521781557569, 'recall': 0.34497201561964186, 'f1-score': 0.3188480055157772, 'support': 252965}, 'weighted avg': {'precision': 0.35249329591050693, 'recall': 0.3486648350562331, 'f1-score': 0.32071818043066036, 'support': 252965}}
[[18008 55391 14393]
 [16016 55083 15209]
 [14146 49610 15109]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995121
{'0': {'precision': 0.3459752321981424, 'recall': 0.22204875279423766, 'f1-score': 0.27049339759244456, 'support': 28183}, '1': {'precision': 0.3348247856820575, 'recall': 0.6210768586971683, 'f1-score': 0.43509063370303414, 'support': 28676}, '2': {'precision': 0.3663826998689384, 'recall': 0.18836966409487552, 'f1-score': 0.24881511314835006, 'support': 29681}, 'accuracy': 0.3427201294199214, 'macro avg': {'precision': 0.3490609059163794, 'recall': 0.34383175852876047, 'f1-score': 0.3181330481479429, 'support': 86540}, 'weighted avg': {'precision': 0.3492796445351154, 'recall': 0.3427201294199214, 'f1-score': 0.3175994431450456, 'support': 86540}}
[[ 6258 17207  4718]
 [ 5915 17810  4951]
 [ 5915 18175  5591]]
Evaluating performance on  val set...
124/124 - 1s - 796ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1018242
{'0': {'precision': 0.36803909952606634, 'recall': 0.23348679883491497, 'f1-score': 0.28571428571428575, 'support': 10643}, '1': {'precision': 0.3077400020667562, 'recall': 0.6152256998243983, 'f1-score': 0.410263475116239, 'support': 9681}, '2': {'precision': 0.38536675267231846, 'recall': 0.18656316916488222, 'f1-score': 0.2514127690272935, 'support': 11208}, 'accuracy': 0.33400989471013576, 'macro avg': {'precision': 0.35371528475504704, 'recall': 0.34509188927473183, 'f1-score': 0.31579684328593943, 'support': 31532}, 'weighted avg': {'precision': 0.35568507104578007, 'recall': 0.33400989471013576, 'f1-score': 0.3117611366457998, 'support': 31532}}
[[2485 6450 1708]
 [2098 5956 1627]
 [2169 6948 2091]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951681
{'0': {'precision': 0.3600205413643442, 'recall': 0.30146202075126227, 'f1-score': 0.328149300155521, 'support': 72092}, '1': {'precision': 0.39563916028608637, 'recall': 0.6493587878516596, 'f1-score': 0.49169812439891364, 'support': 89362}, '2': {'precision': 0.3472264373630079, 'recall': 0.13686267212504652, 'f1-score': 0.19633714999380308, 'support': 75236}, 'accuracy': 0.380489247538975, 'macro avg': {'precision': 0.36762871300447947, 'recall': 0.3625611602426561, 'f1-score': 0.3387281915160793, 'support': 236690}, 'weighted avg': {'precision': 0.36940147767530024, 'recall': 0.380489247538975, 'f1-score': 0.34799817886806084, 'support': 236690}}
[[21733 42604  7755]
 [19731 58028 11603]
 [18902 46037 10297]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979803
{'0': {'precision': 0.3580305674546512, 'recall': 0.22655779398969278, 'f1-score': 0.27751019655264286, 'support': 29882}, '1': {'precision': 0.3298163345056663, 'recall': 0.6050179211469534, 'f1-score': 0.4269094587759231, 'support': 29295}, '2': {'precision': 0.3813830789523271, 'recall': 0.20658682634730538, 'f1-score': 0.26800255997175204, 'support': 29392}, 'accuracy': 0.34510946267881537, 'macro avg': {'precision': 0.3564099936375482, 'recall': 0.3460541804946505, 'f1-score': 0.3241407384334393, 'support': 88569}, 'weighted avg': {'precision': 0.35644808446059206, 'recall': 0.34510946267881537, 'f1-score': 0.3237702077579794, 'support': 88569}}
[[ 6770 18178  4934]
 [ 6656 17724  4915]
 [ 5483 17837  6072]]
Evaluating performance on  val set...
127/127 - 1s - 792ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979155
{'0': {'precision': 0.35971536450769676, 'recall': 0.2282318253017599, 'f1-score': 0.27927166131123515, 'support': 10853}, '1': {'precision': 0.30060493252675663, 'recall': 0.5825067628494139, 'f1-score': 0.3965623081645181, 'support': 9981}, '2': {'precision': 0.4112195929174251, 'recall': 0.21729625743266875, 'f1-score': 0.2843412094513416, 'support': 11436}, 'accuracy': 0.33393244499535174, 'macro avg': {'precision': 0.3571799633172928, 'recall': 0.34267828186128085, 'f1-score': 0.3200583929756983, 'support': 32270}, 'weighted avg': {'precision': 0.35968503090038, 'recall': 0.33393244499535174, 'f1-score': 0.3173458261322105, 'support': 32270}}
[[2477 6507 1869]
 [2478 5814 1689]
 [1931 7020 2485]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095782
{'0': {'precision': 0.35235722499041777, 'recall': 0.20935846535743294, 'f1-score': 0.2626558921147994, 'support': 131731}, '1': {'precision': 0.3631603364616765, 'recall': 0.6477322825032725, 'f1-score': 0.4653920094734303, 'support': 147439}, '2': {'precision': 0.3398834963269403, 'recall': 0.17483042692515313, 'f1-score': 0.23089321692411013, 'support': 127821}, 'accuracy': 0.3573223977925802, 'macro avg': {'precision': 0.35180035259301157, 'recall': 0.3439737249286195, 'f1-score': 0.3196470395041133, 'support': 406991}, 'weighted avg': {'precision': 0.35235328259541787, 'recall': 0.3573223977925802, 'f1-score': 0.3261247980652752, 'support': 406991}}
[[27579 84597 19555]
 [28091 95501 23847]
 [22600 82874 22347]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991527
{'0': {'precision': 0.34997035331868437, 'recall': 0.22215826063853342, 'f1-score': 0.2717878570364451, 'support': 45166}, '1': {'precision': 0.33174925928077614, 'recall': 0.6276820260288428, 'f1-score': 0.43407599978715805, 'support': 45488}, '2': {'precision': 0.36941258558283546, 'recall': 0.1801842043690043, 'f1-score': 0.24222234930801784, 'support': 47013}, 'accuracy': 0.34181757429158766, 'macro avg': {'precision': 0.3503773993940986, 'recall': 0.34334149701212685, 'f1-score': 0.31602873537720694, 'support': 137667}, 'weighted avg': {'precision': 0.3505892128844348, 'recall': 0.34181757429158766, 'f1-score': 0.3153146268695052, 'support': 137667}}
[[10034 28006  7126]
 [ 9602 28552  7334]
 [ 9035 29507  8471]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997157
{'0': {'precision': 0.3880727697246814, 'recall': 0.20938533410319668, 'f1-score': 0.27200818274803956, 'support': 19051}, '1': {'precision': 0.32655310024420753, 'recall': 0.6266072346991257, 'f1-score': 0.42935176302445327, 'support': 17499}, '2': {'precision': 0.3454432219223583, 'recall': 0.19644649076205656, 'f1-score': 0.25046095954844777, 'support': 16941}, 'accuracy': 0.34177712138490585, 'macro avg': {'precision': 0.35335636396374914, 'recall': 0.3441463531881263, 'f1-score': 0.3172736351069802, 'support': 53491}, 'weighted avg': {'precision': 0.3544461808488337, 'recall': 0.34177712138490585, 'f1-score': 0.3166572602196269, 'support': 53491}}
[[ 3989 11907  3155]
 [ 3383 10965  3151]
 [ 2907 10706  3328]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/EXC
Evaluating performance on  test set...
3782/3782 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0919942
{'0': {'precision': 0.36865329631197036, 'recall': 0.2308709170712157, 'f1-score': 0.28392956514826295, 'support': 309398}, '1': {'precision': 0.3237499363295244, 'recall': 0.6032045806839391, 'f1-score': 0.42135280859150576, 'support': 316110}, '2': {'precision': 0.4159089927436075, 'recall': 0.22495327648639177, 'f1-score': 0.29198189729672364, 'support': 342440}, 'accuracy': 0.350373160541682, 'macro avg': {'precision': 0.36943740846170076, 'recall': 0.35300959141384886, 'f1-score': 0.33242142367883076, 'support': 967948}, 'weighted avg': {'precision': 0.3707069598992693, 'recall': 0.350373160541682, 'f1-score': 0.331657647757827, 'support': 967948}}
[[ 71431 187796  50171]
 [ 67419 190679  58012]
 [ 54912 210495  77033]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967451
{'0': {'precision': 0.37354243015563277, 'recall': 0.22856768425421, 'f1-score': 0.28360170735563134, 'support': 137351}, '1': {'precision': 0.32925272685077744, 'recall': 0.6303314377110361, 'f1-score': 0.4325589194792524, 'support': 135048}, '2': {'precision': 0.37493672393770655, 'recall': 0.18334777322334747, 'f1-score': 0.24626803639795228, 'support': 137351}, 'accuracy': 0.3458255033557047, 'macro avg': {'precision': 0.35924396031470557, 'recall': 0.34741563172953116, 'f1-score': 0.32080955441094533, 'support': 409750}, 'weighted avg': {'precision': 0.35941252605153884, 'recall': 0.3458255033557047, 'f1-score': 0.3201814670704882, 'support': 409750}}
[[31394 86113 19844]
 [27784 85125 22139]
 [24866 87302 25183]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940295
{'0': {'precision': 0.38484902626407, 'recall': 0.23328351419845345, 'f1-score': 0.2904844104002589, 'support': 46167}, '1': {'precision': 0.33852960252015196, 'recall': 0.6368330464716007, 'f1-score': 0.44206498642650277, 'support': 45899}, '2': {'precision': 0.3756928856108846, 'recall': 0.18599745985666333, 'f1-score': 0.24881297310417014, 'support': 44092}, 'accuracy': 0.3540078438284934, 'macro avg': {'precision': 0.36635717146503555, 'recall': 0.3520380068422391, 'f1-score': 0.3271207899769773, 'support': 136158}, 'weighted avg': {'precision': 0.3662696715136892, 'recall': 0.3540078438284934, 'f1-score': 0.3280879287081763, 'support': 136158}}
[[10770 28968  6429]
 [ 9470 29230  7199]
 [ 7745 28146  8201]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/AAL
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963047
{'0': {'precision': 0.3813909613240717, 'recall': 0.22725890724204448, 'f1-score': 0.28480904237009996, 'support': 391395}, '1': {'precision': 0.33333785067767696, 'recall': 0.578895618246671, 'f1-score': 0.4230667427289346, 'support': 382404}, '2': {'precision': 0.3616292051816704, 'recall': 0.23996067066859864, 'f1-score': 0.2884915125478074, 'support': 367156}, 'accuracy': 0.34920132695855666, 'macro avg': {'precision': 0.35878600572780633, 'recall': 0.34870506538577134, 'f1-score': 0.3321224325489473, 'support': 1140955}, 'weighted avg': {'precision': 0.3589261410096479, 'recall': 0.34920132695855666, 'f1-score': 0.33233268586926173, 'support': 1140955}}
[[ 88948 228748  73699]
 [ 79206 221372  81826]
 [ 65066 213987  88103]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958415
{'0': {'precision': 0.3810841179433531, 'recall': 0.23897735942579731, 'f1-score': 0.293746602713051, 'support': 205781}, '1': {'precision': 0.33368222901619427, 'recall': 0.6088860954385554, 'f1-score': 0.431108205679276, 'support': 205242}, '2': {'precision': 0.3799221670336423, 'recall': 0.21227784903986915, 'f1-score': 0.27237101733025376, 'support': 209711}, 'accuracy': 0.352265221495842, 'macro avg': {'precision': 0.3648961713310632, 'recall': 0.35338043463474067, 'f1-score': 0.3324086085741936, 'support': 620734}, 'weighted avg': {'precision': 0.36501840803473795, 'recall': 0.352265221495842, 'f1-score': 0.33194279420535233, 'support': 620734}}
[[ 49177 122229  34375]
 [ 41991 124969  38282]
 [ 37877 127317  44517]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962466
{'0': {'precision': 0.38314308207045855, 'recall': 0.22712225284741364, 'f1-score': 0.28518847453281937, 'support': 68571}, '1': {'precision': 0.3308438641178459, 'recall': 0.6042607648298706, 'f1-score': 0.4275798882443496, 'support': 66420}, '2': {'precision': 0.37442375773629116, 'recall': 0.2219655448355, 'f1-score': 0.27870779380817867, 'support': 66231}, 'accuracy': 0.34991203745117333, 'macro avg': {'precision': 0.3628035679748652, 'recall': 0.3511161875042614, 'f1-score': 0.3304920521951159, 'support': 201222}, 'weighted avg': {'precision': 0.3630100766019274, 'recall': 0.34991203745117333, 'f1-score': 0.3300564101146452, 'support': 201222}}
[[15574 41054 11943]
 [13666 40135 12619]
 [11408 40122 14701]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/WBA
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934842
{'0': {'precision': 0.3951980083127624, 'recall': 0.23063151803193913, 'f1-score': 0.2912777769138663, 'support': 406085}, '1': {'precision': 0.32561426382153513, 'recall': 0.607756527251627, 'f1-score': 0.42404196937904687, 'support': 391206}, '2': {'precision': 0.3901364999107986, 'recall': 0.2243216060286119, 'f1-score': 0.28485602316718844, 'support': 399694}, 'accuracy': 0.35177884434642037, 'macro avg': {'precision': 0.3703162573483654, 'recall': 0.3542365504373927, 'f1-score': 0.33339192315336724, 'support': 1196985}, 'weighted avg': {'precision': 0.37076609572684893, 'recall': 0.35177884434642037, 'f1-score': 0.33252425221264514, 'support': 1196985}}
[[ 93656 245174  67255]
 [ 80546 237758  72902]
 [ 62783 247251  89660]]
Evaluating performance on  train set...
2108/2108 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958589
{'0': {'precision': 0.3898714961519452, 'recall': 0.23833777557164593, 'f1-score': 0.2958285059903698, 'support': 185342}, '1': {'precision': 0.3200557086233565, 'recall': 0.614460626518882, 'f1-score': 0.42088430955403133, 'support': 172413}, '2': {'precision': 0.3829538882170461, 'recall': 0.20047673573646313, 'f1-score': 0.26317900465045696, 'support': 181652}, 'accuracy': 0.34580937955940505, 'macro avg': {'precision': 0.36429369766411596, 'recall': 0.351091712608997, 'f1-score': 0.32663060673161937, 'support': 539407}, 'weighted avg': {'precision': 0.36522638273710845, 'recall': 0.34580937955940505, 'f1-score': 0.3248055104460475, 'support': 539407}}
[[ 44174 112458  28710]
 [ 36504 105941  29968]
 [ 32626 112609  36417]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977052
{'0': {'precision': 0.39539070939863163, 'recall': 0.23081127289544123, 'f1-score': 0.29147347184369804, 'support': 71357}, '1': {'precision': 0.30836784350376256, 'recall': 0.6121293541886575, 'f1-score': 0.41012837273097447, 'support': 62526}, '2': {'precision': 0.39341488807912545, 'recall': 0.21497653249893328, 'f1-score': 0.2780281431067782, 'support': 70310}, 'accuracy': 0.342122403804244, 'macro avg': {'precision': 0.36572448032717325, 'recall': 0.352639053194344, 'f1-score': 0.32654332922715024, 'support': 204193}, 'weighted avg': {'precision': 0.36806307471028743, 'recall': 0.342122403804244, 'f1-score': 0.32317717995017087, 'support': 204193}}
[[16470 42875 12012]
 [12959 38274 11293]
 [12226 42969 15115]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
4274/4274 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0864962
{'0': {'precision': 0.31599286959066664, 'recall': 0.15850830627967422, 'f1-score': 0.2111164191043317, 'support': 299713}, '1': {'precision': 0.4532828388500649, 'recall': 0.6551145068946053, 'f1-score': 0.5358225813100292, 'support': 496040}, '2': {'precision': 0.3066148168723463, 'recall': 0.23312482400740175, 'f1-score': 0.2648666868526442, 'support': 298308}, 'accuracy': 0.40401129370300193, 'macro avg': {'precision': 0.3586301751043593, 'recall': 0.34891587906056043, 'f1-score': 0.33726856242233505, 'support': 1094061}, 'weighted avg': {'precision': 0.37568219971132283, 'recall': 0.40401129370300193, 'f1-score': 0.372991652360958, 'support': 1094061}}
[[ 47507 197656  54550]
 [ 68361 324963 102716]
 [ 34474 194291  69543]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955443
{'0': {'precision': 0.3747500858291092, 'recall': 0.22427890280824525, 'f1-score': 0.2806159290161846, 'support': 165477}, '1': {'precision': 0.3297119152319911, 'recall': 0.6206268484455024, 'f1-score': 0.4306423659990865, 'support': 166356}, '2': {'precision': 0.3860355388178257, 'recall': 0.20650210716435882, 'f1-score': 0.269070337544786, 'support': 172744}, 'accuracy': 0.34886647627616796, 'macro avg': {'precision': 0.36349917995964204, 'recall': 0.35046928613936884, 'f1-score': 0.32677621085335234, 'support': 504577}, 'weighted avg': {'precision': 0.36376489305026416, 'recall': 0.34886647627616796, 'f1-score': 0.32612606185535953, 'support': 504577}}
[[ 37113 102007  26357]
 [ 32734 103245  30377]
 [ 29187 107885  35672]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935961
{'0': {'precision': 0.3625555524103377, 'recall': 0.2202693174196433, 'f1-score': 0.2740441192203179, 'support': 58147}, '1': {'precision': 0.36723988219391457, 'recall': 0.6224150748736933, 'f1-score': 0.4619299628420223, 'support': 65911}, '2': {'precision': 0.35402455661664395, 'recall': 0.21054395371807536, 'f1-score': 0.2640520273408985, 'support': 56696}, 'accuracy': 0.36385916770859844, 'macro avg': {'precision': 0.36127333040696546, 'recall': 0.35107611533713734, 'f1-score': 0.3333420364677462, 'support': 180754}, 'weighted avg': {'precision': 0.36158780355192277, 'recall': 0.36385916770859844, 'f1-score': 0.3394215504127374, 'support': 180754}}
[[12808 35568  9771]
 [12877 41024 12010]
 [ 9642 35117 11937]]
testing model on single stock: results/universal/W4/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
12724/12724 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0865864
{'0': {'precision': 0.31975533012230606, 'recall': 0.24254744180796656, 'f1-score': 0.2758508091980181, 'support': 912539}, '1': {'precision': 0.4331406114118562, 'recall': 0.5921452600008106, 'f1-score': 0.5003134581538622, 'support': 1406361}, '2': {'precision': 0.31789485811434615, 'recall': 0.2176280558448078, 'f1-score': 0.2583749009842106, 'support': 938243}, 'accuracy': 0.38631770235448676, 'macro avg': {'precision': 0.35693026654950283, 'recall': 0.3507735858845283, 'f1-score': 0.34484638944536367, 'support': 3257143}, 'weighted avg': {'precision': 0.36817661919112765, 'recall': 0.38631770235448676, 'f1-score': 0.36773466781212943, 'support': 3257143}}
[[221334 530892 160313]
 [295779 832770 277812]
 [175085 558970 204188]]
Evaluating performance on  train set...
5165/5165 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972173
{'0': {'precision': 0.3744914020451631, 'recall': 0.24356726071294593, 'f1-score': 0.2951624188864074, 'support': 442502}, '1': {'precision': 0.32940045446600247, 'recall': 0.5658074335481994, 'f1-score': 0.4163887031077247, 'support': 432983}, '2': {'precision': 0.37336141597062333, 'recall': 0.2429105922972032, 'f1-score': 0.2943292620064352, 'support': 446617}, 'accuracy': 0.34887777191169816, 'macro avg': {'precision': 0.3590844241605963, 'recall': 0.35076176218611615, 'f1-score': 0.3352934613335224, 'support': 1322102}, 'weighted avg': {'precision': 0.35934258240316846, 'recall': 0.34887777191169816, 'f1-score': 0.33458208408223655, 'support': 1322102}}
[[107779 247159  87564]
 [ 93479 244985  94519]
 [ 86543 251586 108488]]
Evaluating performance on  val set...
1903/1903 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966568
{'0': {'precision': 0.36921289516333744, 'recall': 0.23406533552851466, 'f1-score': 0.28650110609412405, 'support': 161566}, '1': {'precision': 0.34003834530270044, 'recall': 0.5719317636627537, 'f1-score': 0.4265024228975137, 'support': 164663}, '2': {'precision': 0.3635704727921499, 'recall': 0.24336629968277665, 'f1-score': 0.2915651337998256, 'support': 160770}, 'accuracy': 0.35137443814053004, 'macro avg': {'precision': 0.35760723775272923, 'recall': 0.34978779962468165, 'f1-score': 0.3348562209304878, 'support': 486999}, 'weighted avg': {'precision': 0.35748576400225107, 'recall': 0.35137443814053004, 'f1-score': 0.3355097910463358, 'support': 486999}}
[[37817 91244 32505]
 [34502 94176 35985]
 [30107 91537 39126]]
training model: results/universal/W4/deepOF_L1/h500
Epoch 1/50
9854/9854 - 143s - loss: 3.2713 - accuracy500: 0.3790 - val_loss: 3.3183 - val_accuracy500: 0.3341 - 143s/epoch - 15ms/step
Epoch 2/50
9854/9854 - 137s - loss: 3.2736 - accuracy500: 0.3777 - val_loss: 3.3156 - val_accuracy500: 0.3341 - 137s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 137s - loss: 3.2709 - accuracy500: 0.3803 - val_loss: 3.3150 - val_accuracy500: 0.3340 - 137s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 138s - loss: 3.2698 - accuracy500: 0.3809 - val_loss: 3.3157 - val_accuracy500: 0.3340 - 138s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 136s - loss: 3.2689 - accuracy500: 0.3816 - val_loss: 3.3165 - val_accuracy500: 0.3341 - 136s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 139s - loss: 3.2681 - accuracy500: 0.3824 - val_loss: 3.3173 - val_accuracy500: 0.3340 - 139s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 139s - loss: 3.2670 - accuracy500: 0.3832 - val_loss: 3.3210 - val_accuracy500: 0.3341 - 139s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 139s - loss: 3.2659 - accuracy500: 0.3841 - val_loss: 3.3229 - val_accuracy500: 0.3341 - 139s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 137s - loss: 3.2648 - accuracy500: 0.3852 - val_loss: 3.3284 - val_accuracy500: 0.3341 - 137s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 141s - loss: 3.2637 - accuracy500: 0.3860 - val_loss: 3.3335 - val_accuracy500: 0.3341 - 141s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 142s - loss: 3.2627 - accuracy500: 0.3865 - val_loss: 3.3380 - val_accuracy500: 0.3341 - 142s/epoch - 14ms/step
Epoch 12/50
9854/9854 - 140s - loss: 3.2624 - accuracy500: 0.3873 - val_loss: 3.3391 - val_accuracy500: 0.3341 - 140s/epoch - 14ms/step
Epoch 13/50
9854/9854 - 137s - loss: 3.2611 - accuracy500: 0.3883 - val_loss: 3.3456 - val_accuracy500: 0.3341 - 137s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 117s - 117s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0876173
{'0': {'precision': 0.32083333333333336, 'recall': 4.277003164982342e-05, 'f1-score': 8.552866154309256e-05, 'support': 1800326}, '1': {'precision': 0.3952813282382396, 'recall': 0.9999195841709982, 'f1-score': 0.566584407804066, 'support': 2400025}, '2': {'precision': 0.3216374269005848, 'recall': 2.939196049720509e-05, 'f1-score': 5.877854967669125e-05, 'support': 1871260}, 'accuracy': 0.3952763113447156, 'macro avg': {'precision': 0.3459173628240526, 'recall': 0.33333058205438176, 'f1-score': 0.18890957167176195, 'support': 6071611}, 'weighted avg': {'precision': 0.35050943035277393, 'recall': 0.3952763113447156, 'f1-score': 0.22400656312829378, 'support': 6071611}}
[[     77 1800204      45]
 [    122 2399832      71]
 [     41 1871164      55]]
Evaluating performance on  train set...
9854/9854 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1069721
{'0': {'precision': 0.40425531914893614, 'recall': 2.2511714977991835e-05, 'f1-score': 4.502092288152862e-05, 'support': 844005}, '1': {'precision': 0.3298548506375192, 'recall': 0.9999519170665564, 'f1-score': 0.49607055439815545, 'support': 831896}, '2': {'precision': 0.47560975609756095, 'recall': 4.60931341322022e-05, 'f1-score': 9.217733501143355e-05, 'support': 846113}, 'accuracy': 0.32986097618807825, 'macro avg': {'precision': 0.4032399752946721, 'recall': 0.33334017397188886, 'f1-score': 0.1654025842186828, 'support': 2522014}, 'weighted avg': {'precision': 0.4036528104226317, 'recall': 0.32986097618807825, 'f1-score': 0.16367676795096422, 'support': 2522014}}
[[    19 843967     19]
 [    16 831856     24]
 [    12 846062     39]]
Evaluating performance on  val set...
3566/3566 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058481
{'0': {'precision': 0.5416666666666666, 'recall': 4.254692434829567e-05, 'f1-score': 8.508716525563785e-05, 'support': 305545}, '1': {'precision': 0.33405020749889835, 'recall': 0.999940939068806, 'f1-score': 0.5007986432923823, 'support': 304770}, '2': {'precision': 0.3548387096774194, 'recall': 3.6419740823880754e-05, 'f1-score': 7.283200635624783e-05, 'support': 302034}, 'accuracy': 0.33405637535636035, 'macro avg': {'precision': 0.4101851946143282, 'recall': 0.3333399685779927, 'f1-score': 0.16698552082133142, 'support': 912349}, 'weighted avg': {'precision': 0.41046285823168066, 'recall': 0.33405637535636035, 'f1-score': 0.16734429282690635, 'support': 912349}}
[[    13 305523      9]
 [     7 304752     11]
 [     4 302019     11]]
testing model out of sample: results/universal/W4/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049626
{'0': {'precision': 0.45652173913043476, 'recall': 2.0463548086901866e-05, 'f1-score': 4.092526170243242e-05, 'support': 1026215}, '1': {'precision': 0.3396425766386687, 'recall': 0.9999708643668292, 'f1-score': 0.5070607244463333, 'support': 1029667}, '2': {'precision': 0.4222222222222222, 'recall': 1.947240043454199e-05, 'f1-score': 3.894300486275153e-05, 'support': 975740}, 'accuracy': 0.3396455758666483, 'macro avg': {'precision': 0.4061288459971086, 'recall': 0.3333369334384502, 'f1-score': 0.16904686423763282, 'support': 3031622}, 'weighted avg': {'precision': 0.4057851937321533, 'recall': 0.3396455758666483, 'f1-score': 0.17224564649665605, 'support': 3031622}}
[[     21 1026186       8]
 [     12 1029637      18]
 [     13  975708      19]]
Evaluating performance on  train set...
5528/5528 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067258
{'0': {'precision': 0.390625, 'recall': 5.3613783460362256e-05, 'f1-score': 0.00010721285181897324, 'support': 466298}, '1': {'precision': 0.3307792328082544, 'recall': 0.9998909979246859, 'f1-score': 0.4971076522892263, 'support': 467881}, '2': {'precision': 0.3442622950819672, 'recall': 4.372513133155518e-05, 'f1-score': 8.743915691997653e-05, 'support': 480273}, 'accuracy': 0.3307825221357812, 'macro avg': {'precision': 0.35522217596340716, 'recall': 0.3333294456131593, 'f1-score': 0.16576743476598843, 'support': 1414452}, 'weighted avg': {'precision': 0.3550865350831704, 'recall': 0.3307825221357812, 'f1-score': 0.16450131447749688, 'support': 1414452}}
[[    25 466259     14]
 [    25 467830     26]
 [    14 480238     21]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108932
{'0': {'precision': 0.3055555555555556, 'recall': 6.514657980456026e-05, 'f1-score': 0.00013026538611844675, 'support': 168850}, '1': {'precision': 0.32447372577333544, 'recall': 0.9997472050356757, 'f1-score': 0.4899359206642695, 'support': 158231}, '2': {'precision': 0.22916666666666666, 'recall': 6.852131012744963e-05, 'f1-score': 0.00013700165647457372, 'support': 160534}, 'accuracy': 0.3244629472021985, 'macro avg': {'precision': 0.28639864933185255, 'recall': 0.33329362430853593, 'f1-score': 0.16340106256895418, 'support': 487615}, 'weighted avg': {'precision': 0.28654553146450146, 'recall': 0.3244629472021985, 'f1-score': 0.1590743504547535, 'support': 487615}}
[[    11 168823     16]
 [    19 158191     21]
 [     6 160517     11]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172228
{'0': {'precision': 0.6666666666666666, 'recall': 7.874170751392743e-05, 'f1-score': 0.00015746481645507332, 'support': 50799}, '1': {'precision': 0.30526585428330955, 'recall': 0.999952052167242, 'f1-score': 0.46773985545033, 'support': 41712}, '2': {'precision': 0.6666666666666666, 'recall': 0.0001359342078434038, 'f1-score': 0.0002718129926610492, 'support': 44139}, 'accuracy': 0.3053055250640322, 'macro avg': {'precision': 0.5461997292055476, 'recall': 0.3333889093608664, 'f1-score': 0.1560563777531487, 'support': 136650}, 'weighted avg': {'precision': 0.5563501596331168, 'recall': 0.3053055250640322, 'f1-score': 0.1429225134243566, 'support': 136650}}
[[    4 50794     1]
 [    0 41710     2]
 [    2 44131     6]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1079245
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21504}, '1': {'precision': 0.3339084089403718, 'recall': 0.999723285523221, 'f1-score': 0.5006119951040391, 'support': 21683}, '2': {'precision': 0.23076923076923078, 'recall': 0.00013795006207752792, 'f1-score': 0.000275735294117647, 'support': 21747}, 'accuracy': 0.33387747559059966, 'macro avg': {'precision': 0.18822587990320086, 'recall': 0.3332870785284328, 'f1-score': 0.16696257679938556, 'support': 64934}, 'weighted avg': {'precision': 0.18878668328753112, 'recall': 0.33387747559059966, 'f1-score': 0.1672585441414676, 'support': 64934}}
[[    0 21500     4]
 [    0 21677     6]
 [    2 21742     3]]
Evaluating performance on  val set...
81/81 - 1s - 656ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1235691
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7558}, '1': {'precision': 0.2748750788337457, 'recall': 0.999823539791777, 'f1-score': 0.4312024353120243, 'support': 5667}, '2': {'precision': 0.3333333333333333, 'recall': 0.00013529968881071573, 'f1-score': 0.0002704895861509332, 'support': 7391}, 'accuracy': 0.27488358556461, 'macro avg': {'precision': 0.20273613738902632, 'recall': 0.3333196131601959, 'f1-score': 0.14382430829939175, 'support': 20616}, 'weighted avg': {'precision': 0.19506129891431429, 'recall': 0.27488358556461, 'f1-score': 0.11862744419113713, 'support': 20616}}
[[   0 7557    1]
 [   0 5666    1]
 [   0 7390    1]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
1613/1613 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1109506
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 141442}, '1': {'precision': 0.30887286450297086, 'recall': 0.9999921579083573, 'f1-score': 0.4719668369235324, 'support': 127517}, '2': {'precision': 1.0, 'recall': 6.949946485412062e-06, 'f1-score': 1.3899796367983209e-05, 'support': 143886}, 'accuracy': 0.30887379040560015, 'macro avg': {'precision': 0.4362909548343236, 'recall': 0.33333303595161423, 'f1-score': 0.15732691223996678, 'support': 412845}, 'weighted avg': {'precision': 0.4439257858586766, 'recall': 0.30887379040560015, 'f1-score': 0.14578303026578568, 'support': 412845}}
[[     0 141442      0]
 [     1 127516      0]
 [     0 143885      1]]
Evaluating performance on  train set...
634/634 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1042842
{'0': {'precision': 0.3333333333333333, 'recall': 3.694262809856293e-05, 'f1-score': 7.387706855791962e-05, 'support': 54138}, '1': {'precision': 0.3330126841420476, 'recall': 0.9998703991705546, 'f1-score': 0.4996230045840792, 'support': 54012}, '2': {'precision': 0.3333333333333333, 'recall': 5.5518543193426606e-05, 'f1-score': 0.00011101859561476549, 'support': 54036}, 'accuracy': 0.3330127137977384, 'macro avg': {'precision': 0.33322645026957143, 'recall': 0.33332095344728224, 'f1-score': 0.16660263341608397, 'support': 162186}, 'weighted avg': {'precision': 0.3332265491218741, 'recall': 0.3330127137977384, 'f1-score': 0.16644862245302006, 'support': 162186}}
[[    2 54134     2]
 [    3 54005     4]
 [    1 54032     3]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056033
{'0': {'precision': 0.2, 'recall': 5.708740081064109e-05, 'f1-score': 0.00011414222120762469, 'support': 17517}, '1': {'precision': 0.32693474962063734, 'recall': 0.9997099936198597, 'f1-score': 0.49273166478466573, 'support': 17241}, '2': {'precision': 0.25, 'recall': 5.564520616548884e-05, 'f1-score': 0.00011126564673157163, 'support': 17971}, 'accuracy': 0.3269168768609304, 'macro avg': {'precision': 0.2589782498735458, 'recall': 0.33327424207561196, 'f1-score': 0.164319024217535, 'support': 52729}, 'weighted avg': {'precision': 0.25854524110469396, 'recall': 0.3269168768609304, 'f1-score': 0.16118617111606, 'support': 52729}}
[[    1 17515     1]
 [    3 17236     2]
 [    1 17969     1]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
989/989 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004025
{'0': {'precision': 0.45, 'recall': 0.00010308806011179327, 'f1-score': 0.0002061288992716779, 'support': 87304}, '1': {'precision': 0.3602895536903863, 'recall': 0.9999012519063868, 'f1-score': 0.529710940996623, 'support': 91141}, '2': {'precision': 0.75, 'recall': 4.025764895330113e-05, 'f1-score': 8.051097632977297e-05, 'support': 74520}, 'accuracy': 0.36030280868894904, 'macro avg': {'precision': 0.5200965178967955, 'recall': 0.33334819920515063, 'f1-score': 0.17666586029074147, 'support': 252965}, 'weighted avg': {'precision': 0.5060540004067579, 'recall': 0.36030280868894904, 'f1-score': 0.19094491502283448, 'support': 252965}}
[[    9 87295     0]
 [    8 91132     1]
 [    3 74514     3]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068469
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 27749}, '1': {'precision': 0.33702736433391883, 'recall': 0.9999657135020229, 'f1-score': 0.5041399457226322, 'support': 29166}, '2': {'precision': 0.6666666666666666, 'recall': 6.751054852320675e-05, 'f1-score': 0.00013500742540839748, 'support': 29625}, 'accuracy': 0.3370348971573839, 'macro avg': {'precision': 0.33456467700019515, 'recall': 0.33334440801684867, 'f1-score': 0.16809165104934687, 'support': 86540}, 'weighted avg': {'precision': 0.341804253618709, 'recall': 0.3370348971573839, 'f1-score': 0.16995314596630476, 'support': 86540}}
[[    0 27749     0]
 [    0 29165     1]
 [    1 29622     2]]
Evaluating performance on  val set...
124/124 - 1s - 873ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138241
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10546}, '1': {'precision': 0.3108588100976786, 'recall': 1.0, 'f1-score': 0.47428267286011516, 'support': 9802}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11184}, 'accuracy': 0.3108588100976786, 'macro avg': {'precision': 0.10361960336589286, 'recall': 0.3333333333333333, 'f1-score': 0.15809422428670505, 'support': 31532}, 'weighted avg': {'precision': 0.09663319981534459, 'recall': 0.3108588100976786, 'f1-score': 0.14743494733524193, 'support': 31532}}
[[    0 10546     0]
 [    0  9802     0]
 [    0 11184     0]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979619
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71291}, '1': {'precision': 0.3722479709661201, 'recall': 1.0, 'f1-score': 0.5425374696732719, 'support': 88107}, '2': {'precision': 1.0, 'recall': 1.2937949593748382e-05, 'f1-score': 2.587556441074871e-05, 'support': 77292}, 'accuracy': 0.3722506231779965, 'macro avg': {'precision': 0.45741599032204006, 'recall': 0.33333764598319787, 'f1-score': 0.18085444841256085, 'support': 236690}, 'weighted avg': {'precision': 0.4651216865009588, 'recall': 0.3722506231779965, 'f1-score': 0.2019660687592522, 'support': 236690}}
[[    0 71291     0]
 [    0 88107     0]
 [    0 77291     1]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1084878
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29839}, '1': {'precision': 0.32966387788052254, 'recall': 1.0, 'f1-score': 0.49586047025057955, 'support': 29198}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29532}, 'accuracy': 0.32966387788052254, 'macro avg': {'precision': 0.10988795929350752, 'recall': 0.3333333333333333, 'f1-score': 0.16528682341685985, 'support': 88569}, 'weighted avg': {'precision': 0.10867827237922408, 'recall': 0.32966387788052254, 'f1-score': 0.16346728551046552, 'support': 88569}}
[[    0 29839     0]
 [    0 29198     0]
 [    0 29532     0]]
Evaluating performance on  val set...
127/127 - 1s - 798ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1141392
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10790}, '1': {'precision': 0.30495816547877286, 'recall': 1.0, 'f1-score': 0.4673838189546674, 'support': 9841}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11639}, 'accuracy': 0.30495816547877286, 'macro avg': {'precision': 0.10165272182625762, 'recall': 0.3333333333333333, 'f1-score': 0.15579460631822248, 'support': 32270}, 'weighted avg': {'precision': 0.0929994826921786, 'recall': 0.30495816547877286, 'f1-score': 0.14253251200287828, 'support': 32270}}
[[    0 10790     0]
 [    0  9841     0]
 [    0 11639     0]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
1590/1590 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099729
{'0': {'precision': 0.6666666666666666, 'recall': 1.4998912578838034e-05, 'f1-score': 2.999715027072428e-05, 'support': 133343}, '1': {'precision': 0.35846636575171814, 'recall': 1.0, 'f1-score': 0.527751550997522, 'support': 145889}, '2': {'precision': 1.0, 'recall': 5.4790660540549004e-05, 'f1-score': 0.00010957531737707997, 'support': 127759}, 'accuracy': 0.3584796715406483, 'macro avg': {'precision': 0.6750443441394616, 'recall': 0.33335659652437316, 'f1-score': 0.1759637078217233, 'support': 406991}, 'weighted avg': {'precision': 0.6608269788926187, 'recall': 0.3584796715406483, 'f1-score': 0.18922075713334896, 'support': 406991}}
[[     2 133341      0]
 [     0 145889      0]
 [     1 127751      7]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1080117
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 44961}, '1': {'precision': 0.3306625600197584, 'recall': 0.9999121342588525, 'f1-score': 0.4969784973824562, 'support': 45524}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 47182}, 'accuracy': 0.3306529524141588, 'macro avg': {'precision': 0.11022085333991948, 'recall': 0.33330404475295083, 'f1-score': 0.1656594991274854, 'support': 137667}, 'weighted avg': {'precision': 0.1093441593289567, 'recall': 0.3306529524141588, 'f1-score': 0.16434184746409042, 'support': 137667}}
[[    0 44961     0]
 [    0 45520     4]
 [    0 47182     0]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1083294
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 18971}, '1': {'precision': 0.3314202389186966, 'recall': 1.0, 'f1-score': 0.4978446762802061, 'support': 17728}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 16792}, 'accuracy': 0.3314202389186966, 'macro avg': {'precision': 0.11047341297289887, 'recall': 0.3333333333333333, 'f1-score': 0.16594822542673537, 'support': 53491}, 'weighted avg': {'precision': 0.10983937476492593, 'recall': 0.3314202389186966, 'f1-score': 0.1649958015571871, 'support': 53491}}
[[    0 18971     0]
 [    0 17728     0]
 [    0 16792     0]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/EXC
Evaluating performance on  test set...
3782/3782 - 19s - 19s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1164596
{'0': {'precision': 0.3353658536585366, 'recall': 0.0001696253438768335, 'f1-score': 0.00033907918423713347, 'support': 324244}, '1': {'precision': 0.28829785804995645, 'recall': 0.9996452922397825, 'f1-score': 0.4475284433130745, 'support': 279103}, '2': {'precision': 0.3333333333333333, 'recall': 1.9199069667938377e-05, 'f1-score': 3.83959278375962e-05, 'support': 364601}, 'accuracy': 0.2883068098699517, 'macro avg': {'precision': 0.3189990150139421, 'recall': 0.33327803888444246, 'f1-score': 0.1493019728083831, 'support': 967948}, 'weighted avg': {'precision': 0.32102843292784544, 'recall': 0.2883068098699517, 'f1-score': 0.12917065245107004, 'support': 967948}}
[[    55 324184      5]
 [    90 279004      9]
 [    19 364575      7]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1082602
{'0': {'precision': 0.5, 'recall': 7.2259034185749076e-06, 'f1-score': 1.445159798544724e-05, 'support': 138391}, '1': {'precision': 0.3260977800339731, 'recall': 0.9999700639135446, 'f1-score': 0.491811967888338, 'support': 133618}, '2': {'precision': 0.25, 'recall': 2.1780007405202517e-05, 'f1-score': 4.35562201912118e-05, 'support': 137741}, 'accuracy': 0.32609640024405123, 'macro avg': {'precision': 0.35869926001132435, 'recall': 0.3333330232747895, 'f1-score': 0.1639566585688382, 'support': 409750}, 'weighted avg': {'precision': 0.3592514537463805, 'recall': 0.32609640024405123, 'f1-score': 0.1603976350792583, 'support': 409750}}
[[     1 138384      6]
 [     1 133614      3]
 [     0 137738      3]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104124
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 47915}, '1': {'precision': 0.3154713378135214, 'recall': 0.9999534396461414, 'f1-score': 0.4796270448327843, 'support': 42955}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45288}, 'accuracy': 0.3154643869622057, 'macro avg': {'precision': 0.10515711260450712, 'recall': 0.33331781321538045, 'f1-score': 0.1598756816109281, 'support': 136158}, 'weighted avg': {'precision': 0.09952460608836654, 'recall': 0.3154643869622057, 'f1-score': 0.15131229682275185, 'support': 136158}}
[[    0 47915     0]
 [    2 42953     0]
 [    1 45287     0]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/AAL
Evaluating performance on  test set...
4457/4457 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1132275
{'0': {'precision': 0.3, 'recall': 7.345379756133392e-06, 'f1-score': 1.4690399823715204e-05, 'support': 408420}, '1': {'precision': 0.3096114573199057, 'recall': 0.9999745225814852, 'f1-score': 0.4728266398248141, 'support': 353254}, '2': {'precision': 0.3333333333333333, 'recall': 1.318283805410764e-05, 'f1-score': 2.636463342613684e-05, 'support': 379281}, 'accuracy': 0.30961168494813557, 'macro avg': {'precision': 0.3143149302177463, 'recall': 0.3333316835997651, 'f1-score': 0.15762256495268798, 'support': 1140955}, 'weighted avg': {'precision': 0.31405663303468234, 'recall': 0.30961168494813557, 'f1-score': 0.14640708992230314, 'support': 1140955}}
[[     3 408412      5]
 [     4 353245      5]
 [     3 379273      5]]
Evaluating performance on  train set...
2425/2425 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065458
{'0': {'precision': 0.4230769230769231, 'recall': 5.3281150097843565e-05, 'f1-score': 0.00010654888172105502, 'support': 206452}, '1': {'precision': 0.32956015576037906, 'recall': 0.9999560044191117, 'f1-score': 0.495737722398799, 'support': 204566}, '2': {'precision': 0.5454545454545454, 'recall': 2.861012035323962e-05, 'f1-score': 5.7217239554277705e-05, 'support': 209716}, 'accuracy': 0.32956789864901875, 'macro avg': {'precision': 0.43269720809728246, 'recall': 0.33334596522985427, 'f1-score': 0.1653004961733581, 'support': 620734}, 'weighted avg': {'precision': 0.43360348426362993, 'recall': 0.32956789864901875, 'f1-score': 0.1634276187877129, 'support': 620734}}
[[    11 206439      2]
 [     6 204557      3]
 [     9 209701      6]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128179
{'0': {'precision': 0.16666666666666666, 'recall': 1.3983471536643687e-05, 'f1-score': 2.796459682042534e-05, 'support': 71513}, '1': {'precision': 0.31000173943294485, 'recall': 0.9999198486742971, 'f1-score': 0.4732754925131925, 'support': 62382}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 67327}, 'accuracy': 0.3099959248988679, 'macro avg': {'precision': 0.1588894686998705, 'recall': 0.3333112773819446, 'f1-score': 0.15776781903667098, 'support': 201222}, 'weighted avg': {'precision': 0.15533769589130064, 'recall': 0.3099959248988679, 'f1-score': 0.14673282049761155, 'support': 201222}}
[[    1 71512     0]
 [    4 62377     1]
 [    1 67326     0]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/WBA
Evaluating performance on  test set...
4676/4676 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.068537
{'0': {'precision': 0.5, 'recall': 3.339121143315079e-05, 'f1-score': 6.677796327212019e-05, 'support': 329428}, '1': {'precision': 0.4594818813881328, 'recall': 0.9999745449454444, 'f1-score': 0.6296456365004994, 'support': 549989}, '2': {'precision': 0.4117647058823529, 'recall': 2.2042523176138652e-05, 'f1-score': 4.408268652486736e-05, 'support': 317568}, 'accuracy': 0.4594819483953433, 'macro avg': {'precision': 0.45708219575682857, 'recall': 0.3333433262266845, 'f1-score': 0.20991883238343215, 'support': 1196985}, 'weighted avg': {'precision': 0.45797338695173695, 'recall': 0.4594819483953433, 'f1-score': 0.28933877346395515, 'support': 1196985}}
[[    11 329415      2]
 [     6 549975      8]
 [     5 317556      7]]
Evaluating performance on  train set...
2108/2108 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055769
{'0': {'precision': 0.36363636363636365, 'recall': 2.208139201095237e-05, 'f1-score': 4.416010245143769e-05, 'support': 181148}, '1': {'precision': 0.33303669425410104, 'recall': 0.9999387674443201, 'f1-score': 0.49965856256927843, 'support': 179643}, '2': {'precision': 0.5, 'recall': 5.598602588793837e-05, 'f1-score': 0.00011195951543921716, 'support': 178616}, 'accuracy': 0.3330435088903184, 'macro avg': {'precision': 0.3988910192968216, 'recall': 0.33333894495407296, 'f1-score': 0.1666048940623897, 'support': 539407}, 'weighted avg': {'precision': 0.39860014954549994, 'recall': 0.3330435088903184, 'f1-score': 0.1664571657962938, 'support': 539407}}
[[     4 181141      3]
 [     4 179632      7]
 [     3 178603     10]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023563
{'0': {'precision': 0.5, 'recall': 5.964185068662681e-05, 'f1-score': 0.00011926947446887813, 'support': 67067}, '1': {'precision': 0.34520859250262026, 'recall': 0.9999290669466158, 'f1-score': 0.5132323868538995, 'support': 70489}, '2': {'precision': 0.42857142857142855, 'recall': 4.502003391509222e-05, 'f1-score': 9.003061040753856e-05, 'support': 66637}, 'accuracy': 0.34521751480217244, 'macro avg': {'precision': 0.42459334035801627, 'recall': 0.33334457627707254, 'f1-score': 0.17114722897959198, 'support': 204193}, 'weighted avg': {'precision': 0.42325458151176326, 'recall': 0.34521751480217244, 'f1-score': 0.1772403369977152, 'support': 204193}}
[[    4 67061     2]
 [    3 70484     2]
 [    1 66633     3]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
4274/4274 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978167
{'0': {'precision': 0.75, 'recall': 8.661783345700435e-06, 'f1-score': 1.7323366623069526e-05, 'support': 346349}, '1': {'precision': 0.3634812271091567, 'recall': 0.9999899414339994, 'f1-score': 0.5331650267275002, 'support': 397671}, '2': {'precision': 0.3333333333333333, 'recall': 5.713616404935422e-06, 'f1-score': 1.1427036940753671e-05, 'support': 350041}, 'accuracy': 0.3634824749259868, 'macro avg': {'precision': 0.4822715201474967, 'recall': 0.3333347722779167, 'f1-score': 0.17773125904368803, 'support': 1094061}, 'weighted avg': {'precision': 0.4761965067752701, 'recall': 0.3634824749259868, 'f1-score': 0.19380479626446429, 'support': 1094061}}
[[     3 346345      1]
 [     1 397667      3]
 [     0 350039      2]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1063622
{'0': {'precision': 0.25, 'recall': 4.2262364760432765e-05, 'f1-score': 8.451044307618012e-05, 'support': 165632}, '1': {'precision': 0.3308385429261196, 'recall': 0.9998322770782667, 'f1-score': 0.49716736663390226, 'support': 166942}, '2': {'precision': 0.3225806451612903, 'recall': 5.8138520839752794e-05, 'f1-score': 0.0001162560889126568, 'support': 172003}, 'accuracy': 0.3308335496861728, 'macro avg': {'precision': 0.30113972936246997, 'recall': 0.3333108926546223, 'f1-score': 0.1657893777219637, 'support': 504577}, 'weighted avg': {'precision': 0.30148755639446445, 'recall': 0.3308335496861728, 'f1-score': 0.16455785450063268, 'support': 504577}}
[[     7 165621      4]
 [    11 166914     17]
 [    10 171983     10]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022639
{'0': {'precision': 0.2857142857142857, 'recall': 9.956523182104809e-05, 'f1-score': 0.0001990610951677919, 'support': 60262}, '1': {'precision': 0.3466146481835035, 'recall': 0.9997286598991253, 'f1-score': 0.5147581536590277, 'support': 62652}, '2': {'precision': 0.39285714285714285, 'recall': 0.00019017980636237898, 'f1-score': 0.0003801755719914288, 'support': 57840}, 'accuracy': 0.34661473605010124, 'macro avg': {'precision': 0.34172869225164404, 'recall': 0.33333946831243627, 'f1-score': 0.17177913010872894, 'support': 180754}, 'weighted avg': {'precision': 0.3411082043360827, 'recall': 0.34661473605010124, 'f1-score': 0.17861078049640056, 'support': 180754}}
[[    6 60249     7]
 [    7 62635    10]
 [    8 57821    11]]
testing model on single stock: results/universal/W4/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
12724/12724 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0823506
{'0': {'precision': 0.43103448275862066, 'recall': 2.6768859464558566e-05, 'f1-score': 5.353439424226883e-05, 'support': 933921}, '1': {'precision': 0.4161014417418927, 'recall': 0.9999394971921532, 'f1-score': 0.5876613521492229, 'support': 1355309}, '2': {'precision': 0.28688524590163933, 'recall': 3.616027473543593e-05, 'f1-score': 7.231143502042798e-05, 'support': 967913}, 'accuracy': 0.41609686771504967, 'macro avg': {'precision': 0.3780070568007175, 'recall': 0.33333414210878437, 'f1-score': 0.19592906599282853, 'support': 3257143}, 'weighted avg': {'precision': 0.38198450086304775, 'recall': 0.41609686771504967, 'f1-score': 0.24456485563974964, 'support': 3257143}}
[[     25  933868      28]
 [     23 1355227      59]
 [     10  967868      35]]
Evaluating performance on  train set...
5165/5165 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1074021
{'0': {'precision': 0.4, 'recall': 2.2702042502763974e-05, 'f1-score': 4.540150823810366e-05, 'support': 440489}, '1': {'precision': 0.32934325142886534, 'recall': 0.9999448814376758, 'f1-score': 0.4954909178225534, 'support': 435425}, '2': {'precision': 0.40816326530612246, 'recall': 4.482415484056048e-05, 'f1-score': 8.963846565838332e-05, 'support': 446188}, 'accuracy': 0.3293475087398703, 'macro avg': {'precision': 0.3791688389116626, 'recall': 0.33333746921167307, 'f1-score': 0.16520865259881665, 'support': 1322102}, 'weighted avg': {'precision': 0.379484666291876, 'recall': 0.3293475087398703, 'f1-score': 0.1632318288343583, 'support': 1322102}}
[[    10 440463     16]
 [    11 435401     13]
 [     4 446164     20]]
Evaluating performance on  val set...
1903/1903 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055123
{'0': {'precision': 0.4444444444444444, 'recall': 2.4652401143871413e-05, 'f1-score': 4.930206760546021e-05, 'support': 162256}, '1': {'precision': 0.3372555300920792, 'recall': 0.9999391149752807, 'f1-score': 0.5043917839856514, 'support': 164244}, '2': {'precision': 0.16666666666666666, 'recall': 1.8691705244269434e-05, 'f1-score': 3.7379218400543245e-05, 'support': 160499}, 'accuracy': 0.33725120585463214, 'macro avg': {'precision': 0.31612221373439675, 'recall': 0.33332748636055626, 'f1-score': 0.1681594884238858, 'support': 486999}, 'weighted avg': {'precision': 0.3167476902325355, 'recall': 0.33725120585463214, 'f1-score': 0.17013858971454723, 'support': 486999}}
[[     4 162244      8]
 [     3 164234      7]
 [     2 160494      3]]
training model: results/universal/W4/deepOF_L1/h1000
Epoch 1/50
9854/9854 - 141s - loss: 3.2705 - accuracy1000: 0.3726 - val_loss: 3.3077 - val_accuracy1000: 0.3274 - 141s/epoch - 14ms/step
Epoch 2/50
9854/9854 - 138s - loss: 3.2707 - accuracy1000: 0.3743 - val_loss: 3.3073 - val_accuracy1000: 0.3274 - 138s/epoch - 14ms/step
Epoch 3/50
9854/9854 - 138s - loss: 3.2694 - accuracy1000: 0.3753 - val_loss: 3.3076 - val_accuracy1000: 0.3274 - 138s/epoch - 14ms/step
Epoch 4/50
9854/9854 - 138s - loss: 3.2692 - accuracy1000: 0.3765 - val_loss: 3.3089 - val_accuracy1000: 0.3276 - 138s/epoch - 14ms/step
Epoch 5/50
9854/9854 - 138s - loss: 3.2671 - accuracy1000: 0.3784 - val_loss: 3.3109 - val_accuracy1000: 0.3276 - 138s/epoch - 14ms/step
Epoch 6/50
9854/9854 - 141s - loss: 3.2659 - accuracy1000: 0.3794 - val_loss: 3.3127 - val_accuracy1000: 0.3276 - 141s/epoch - 14ms/step
Epoch 7/50
9854/9854 - 138s - loss: 3.2642 - accuracy1000: 0.3811 - val_loss: 3.3139 - val_accuracy1000: 0.3275 - 138s/epoch - 14ms/step
Epoch 8/50
9854/9854 - 140s - loss: 3.2631 - accuracy1000: 0.3822 - val_loss: 3.3157 - val_accuracy1000: 0.3275 - 140s/epoch - 14ms/step
Epoch 9/50
9854/9854 - 138s - loss: 3.2618 - accuracy1000: 0.3832 - val_loss: 3.3178 - val_accuracy1000: 0.3275 - 138s/epoch - 14ms/step
Epoch 10/50
9854/9854 - 137s - loss: 3.2603 - accuracy1000: 0.3844 - val_loss: 3.3200 - val_accuracy1000: 0.3275 - 137s/epoch - 14ms/step
Epoch 11/50
9854/9854 - 141s - loss: 3.2587 - accuracy1000: 0.3852 - val_loss: 3.3218 - val_accuracy1000: 0.3275 - 141s/epoch - 14ms/step
Epoch 12/50
9854/9854 - 138s - loss: 3.2578 - accuracy1000: 0.3859 - val_loss: 3.3230 - val_accuracy1000: 0.3274 - 138s/epoch - 14ms/step
testing model in sample: results/universal/W4/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 136s - 136s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944943
{'0': {'precision': 0.3423243585374166, 'recall': 0.0037393645367198047, 'f1-score': 0.007397918250425478, 'support': 1880266}, '1': {'precision': 0.3732475064285033, 'recall': 0.9962815468341515, 'f1-score': 0.5430474105981046, 'support': 2265996}, '2': {'precision': 0.34516991218022147, 'recall': 0.0004695252652895657, 'f1-score': 0.0009377749008282297, 'support': 1925349}, 'accuracy': 0.37313078851724857, 'macro avg': {'precision': 0.35358059238204714, 'recall': 0.33349681221205363, 'f1-score': 0.18379436791645276, 'support': 6071611}, 'weighted avg': {'precision': 0.35476758213807746, 'recall': 0.37313078851724857, 'f1-score': 0.20525999744553, 'support': 6071611}}
[[   7031 1872472     763]
 [   7474 2257570     952]
 [   6034 1918411     904]]
Evaluating performance on  train set...
9854/9854 - 56s - 56s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021506
{'0': {'precision': 0.3571266454834317, 'recall': 0.0037343054156328205, 'f1-score': 0.007391323239452334, 'support': 842727}, '1': {'precision': 0.33150999274246745, 'recall': 0.995607286118235, 'f1-score': 0.4973995432848962, 'support': 836385}, '2': {'precision': 0.37020316027088035, 'recall': 0.0005836977489672583, 'f1-score': 0.0011655577679568743, 'support': 842902}, 'accuracy': 0.3316198879149759, 'macro avg': {'precision': 0.3529465994989265, 'recall': 0.33330842976094505, 'f1-score': 0.16865214143076848, 'support': 2522014}, 'weighted avg': {'precision': 0.35300170262610364, 'recall': 0.3316198879149759, 'f1-score': 0.16781383277161754, 'support': 2522014}}
[[  3147 839205    375]
 [  3212 832711    462]
 [  2453 839957    492]]
Evaluating performance on  val set...
3566/3566 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027943
{'0': {'precision': 0.37187948350071737, 'recall': 0.004155977424320164, 'f1-score': 0.008220090382938238, 'support': 311840}, '1': {'precision': 0.3272044090382642, 'recall': 0.9954148720250257, 'f1-score': 0.4925138165035753, 'support': 298574}, '2': {'precision': 0.33211678832116787, 'recall': 0.0006027787437693544, 'f1-score': 0.001203373412720715, 'support': 301935}, 'accuracy': 0.3273780099501397, 'macro avg': {'precision': 0.3437335602867164, 'recall': 0.3333912093977051, 'f1-score': 0.16731242676641142, 'support': 912349}, 'weighted avg': {'precision': 0.34410002076048335, 'recall': 0.3273780099501397, 'f1-score': 0.16438721781371357, 'support': 912349}}
[[  1296 310366    178]
 [  1181 297205    188]
 [  1008 300745    182]]
testing model out of sample: results/universal/W4/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000825
{'0': {'precision': 0.35088131609870743, 'recall': 0.0014615718211302366, 'f1-score': 0.0029110179983972834, 'support': 1021503}, '1': {'precision': 0.34629592305379425, 'recall': 0.9982512803466198, 'f1-score': 0.5142108030019323, 'support': 1049911}, '2': {'precision': 0.35842293906810035, 'recall': 0.0003124323063336277, 'f1-score': 0.0006243204012299111, 'support': 960208}, 'accuracy': 0.34630570697798074, 'macro avg': {'precision': 0.35186672607353403, 'recall': 0.33334176149136124, 'f1-score': 0.1725820471338532, 'support': 3031622}, 'weighted avg': {'precision': 0.35168196740385593, 'recall': 0.34630570697798074, 'f1-score': 0.1792600361960702, 'support': 3031622}}
[[   1493 1019778     232]
 [   1531 1048075     305]
 [   1231  958677     300]]
Evaluating performance on  train set...
5528/5528 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022428
{'0': {'precision': 0.34073518379594897, 'recall': 0.004932549396083065, 'f1-score': 0.009724327518433832, 'support': 460411}, '1': {'precision': 0.33231971765696233, 'recall': 0.993909972207869, 'f1-score': 0.49809755258038585, 'support': 470277}, '2': {'precision': 0.34775767112509837, 'recall': 0.000913668648349195, 'f1-score': 0.0018225488882245612, 'support': 483764}, 'accuracy': 0.33237324419633896, 'macro avg': {'precision': 0.3402708575260032, 'recall': 0.3332520634174338, 'f1-score': 0.16988147632901474, 'support': 1414452}, 'weighted avg': {'precision': 0.3403390066127391, 'recall': 0.33237324419633896, 'f1-score': 0.1693961291244233, 'support': 1414452}}
[[  2271 457744    396]
 [  2431 467413    433]
 [  1963 481359    442]]
Evaluating performance on  val set...
1908/1908 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034749
{'0': {'precision': 0.3572228443449048, 'recall': 0.005647217108058348, 'f1-score': 0.011118662972063926, 'support': 169464}, '1': {'precision': 0.3262035618576496, 'recall': 0.9922503014469454, 'f1-score': 0.49099265677003545, 'support': 159232}, '2': {'precision': 0.30412371134020616, 'recall': 0.0011137749419515603, 'f1-score': 0.00221942182180676, 'support': 158919}, 'accuracy': 0.32634763081529483, 'macro avg': {'precision': 0.3291833725142535, 'recall': 0.3330037644989851, 'f1-score': 0.16811024718796871, 'support': 487615}, 'weighted avg': {'precision': 0.32978783207706175, 'recall': 0.32634763081529483, 'f1-score': 0.1649224575150556, 'support': 487615}}
[[   957 168327    180]
 [  1009 157998    225]
 [   713 158029    177]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
534/534 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1128675
{'0': {'precision': 0.3482142857142857, 'recall': 0.0021169190685556096, 'f1-score': 0.004208254653358511, 'support': 55269}, '1': {'precision': 0.2800901621891497, 'recall': 0.9966819072501633, 'f1-score': 0.43729151621445034, 'support': 38275}, '2': {'precision': 0.4260869565217391, 'recall': 0.0011367327054238388, 'f1-score': 0.002267416302260475, 'support': 43106}, 'accuracy': 0.28038053421148923, 'macro avg': {'precision': 0.3514638014750582, 'recall': 0.33331185300804755, 'f1-score': 0.14792239572335644, 'support': 136650}, 'weighted avg': {'precision': 0.35369784605019133, 'recall': 0.28038053421148923, 'f1-score': 0.12490053462619682, 'support': 136650}}
[[  117 55118    34]
 [   95 38148    32]
 [  124 42933    49]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10359
{'0': {'precision': 0.3235294117647059, 'recall': 0.003091914175958025, 'f1-score': 0.0061252900232018565, 'support': 21346}, '1': {'precision': 0.3303791007377848, 'recall': 0.9960363721147121, 'f1-score': 0.49617877302608665, 'support': 21445}, '2': {'precision': 0.44155844155844154, 'recall': 0.0015354739646840988, 'f1-score': 0.00306030603060306, 'support': 22143}, 'accuracy': 0.33048942002648846, 'macro avg': {'precision': 0.3651556513536441, 'recall': 0.3335545867517847, 'f1-score': 0.1684547896932972, 'support': 64934}, 'weighted avg': {'precision': 0.36604039810083744, 'recall': 0.33048942002648846, 'f1-score': 0.16692439376621399, 'support': 64934}}
[[   66 21260    20]
 [   62 21360    23]
 [   76 22033    34]]
Evaluating performance on  val set...
81/81 - 1s - 560ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.115036
{'0': {'precision': 0.25555555555555554, 'recall': 0.0030963920301561657, 'f1-score': 0.0061186485767491345, 'support': 7428}, '1': {'precision': 0.268406928519151, 'recall': 0.994576026035075, 'f1-score': 0.4227311150388074, 'support': 5531}, '2': {'precision': 0.3870967741935484, 'recall': 0.0015671934177876453, 'f1-score': 0.0031217481789802292, 'support': 7657}, 'accuracy': 0.2685292976329065, 'macro avg': {'precision': 0.30368641942275165, 'recall': 0.3330798704943396, 'f1-score': 0.14399050393151228, 'support': 20616}, 'weighted avg': {'precision': 0.3078592058743738, 'recall': 0.2685292976329065, 'f1-score': 0.11677718008896916, 'support': 20616}}
[[  23 7393   12]
 [  23 5501    7]
 [  44 7601   12]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
1613/1613 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.118753
{'0': {'precision': 0.4514285714285714, 'recall': 0.00248405800747104, 'f1-score': 0.0049409277686394935, 'support': 159014}, '1': {'precision': 0.24453796409395892, 'recall': 0.9971284285572829, 'f1-score': 0.3927556665828112, 'support': 100990}, '2': {'precision': 0.44508670520231214, 'recall': 0.0005037915219083884, 'f1-score': 0.001006443854810671, 'support': 152841}, 'accuracy': 0.24506049485884532, 'macro avg': {'precision': 0.3803510802416141, 'recall': 0.3333720926955541, 'f1-score': 0.13290101273542046, 'support': 412845}, 'weighted avg': {'precision': 0.39847121549447945, 'recall': 0.24506049485884532, 'f1-score': 0.09835143296300951, 'support': 412845}}
[[   395 158570     49]
 [   243 100700     47]
 [   237 152527     77]]
Evaluating performance on  train set...
634/634 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101662
{'0': {'precision': 0.3785517873510541, 'recall': 0.0075101832993890024, 'f1-score': 0.01472817074692866, 'support': 54992}, '1': {'precision': 0.3319722817811752, 'recall': 0.9918300653594772, 'f1-score': 0.49744599810952633, 'support': 53856}, '2': {'precision': 0.3473684210526316, 'recall': 0.0012373917282237803, 'f1-score': 0.0024659991032730533, 'support': 53338}, 'accuracy': 0.3323036513632496, 'macro avg': {'precision': 0.3526308300616203, 'recall': 0.33352588012902995, 'f1-score': 0.17154672265324267, 'support': 162186}, 'weighted avg': {'precision': 0.3528291957365087, 'recall': 0.3323036513632496, 'f1-score': 0.17098833869798954, 'support': 162186}}
[[  413 54515    64]
 [  380 53416    60]
 [  298 52974    66]]
Evaluating performance on  val set...
206/206 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1143708
{'0': {'precision': 0.42045454545454547, 'recall': 0.011161948815928403, 'f1-score': 0.021746583729245234, 'support': 19889}, '1': {'precision': 0.2613769409416326, 'recall': 0.988243831640058, 'f1-score': 0.4134120611405413, 'support': 13780}, '2': {'precision': 0.38, 'recall': 0.001993704092339979, 'f1-score': 0.00396659707724426, 'support': 19060}, 'accuracy': 0.2631948263763773, 'macro avg': {'precision': 0.35394382879872605, 'recall': 0.3337998281827754, 'f1-score': 0.14637508064901025, 'support': 52729}, 'weighted avg': {'precision': 0.36425865654044554, 'recall': 0.2631948263763773, 'f1-score': 0.1176760292552465, 'support': 52729}}
[[  222 19627    40]
 [  140 13618    22]
 [  166 18856    38]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962836
{'0': {'precision': 0.35071090047393366, 'recall': 0.00421253970603304, 'f1-score': 0.008325083250832508, 'support': 87833}, '1': {'precision': 0.36554693613285827, 'recall': 0.9947790556900726, 'f1-score': 0.5346342540281, 'support': 92512}, '2': {'precision': 0.26143790849673204, 'recall': 0.000550812448361333, 'f1-score': 0.0010993088095859727, 'support': 72620}, 'accuracy': 0.36542209396556835, 'macro avg': {'precision': 0.32589858170117464, 'recall': 0.33318080261482236, 'f1-score': 0.18135288202950617, 'support': 252965}, 'weighted avg': {'precision': 0.33050852723452917, 'recall': 0.36542209396556835, 'f1-score': 0.19872762220690646, 'support': 252965}}
[[  370 87409    54]
 [  424 92029    59]
 [  261 72319    40]]
Evaluating performance on  train set...
339/339 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031766
{'0': {'precision': 0.28133704735376047, 'recall': 0.0035978911370760903, 'f1-score': 0.0071049206851675996, 'support': 28072}, '1': {'precision': 0.33053159501724, 'recall': 0.9938215582239598, 'f1-score': 0.4960752711591236, 'support': 28648}, '2': {'precision': 0.22727272727272727, 'recall': 0.00033534540576794097, 'f1-score': 0.0006697026520225021, 'support': 29820}, 'accuracy': 0.33027501733302517, 'macro avg': {'precision': 0.27971378988124257, 'recall': 0.3325849315889346, 'f1-score': 0.16794996483210456, 'support': 86540}, 'weighted avg': {'precision': 0.27899278315971093, 'recall': 0.33027501733302517, 'f1-score': 0.16675507551102275, 'support': 86540}}
[[  101 27958    13]
 [  156 28471    21]
 [  102 29708    10]]
Evaluating performance on  val set...
124/124 - 1s - 813ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1102616
{'0': {'precision': 0.5178571428571429, 'recall': 0.008131601084213479, 'f1-score': 0.01601177877979203, 'support': 10699}, '1': {'precision': 0.28921850079744815, 'recall': 0.9951706728130831, 'f1-score': 0.44818467165912856, 'support': 9111}, '2': {'precision': 0.35714285714285715, 'recall': 0.00042654837058522436, 'f1-score': 0.0008520790729379687, 'support': 11722}, 'accuracy': 0.2904668273499937, 'macro avg': {'precision': 0.3880728335991494, 'recall': 0.3345762740892939, 'f1-score': 0.15501617650395286, 'support': 31532}, 'weighted avg': {'precision': 0.3920478213758307, 'recall': 0.2904668273499937, 'f1-score': 0.13525017872460657, 'support': 31532}}
[[   87 10609     3]
 [   38  9067     6]
 [   43 11674     5]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
925/925 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.094686
{'0': {'precision': 0.35909745559289485, 'recall': 0.010631644777986242, 'f1-score': 0.02065185880533967, 'support': 70356}, '1': {'precision': 0.3733856354062293, 'recall': 0.99358952539796, 'f1-score': 0.5427926811127088, 'support': 88137}, '2': {'precision': 0.3888888888888889, 'recall': 0.000358070002685525, 'f1-score': 0.0007154812250060688, 'support': 78197}, 'accuracy': 0.37326460771473235, 'macro avg': {'precision': 0.373790659962671, 'recall': 0.3348597467262106, 'f1-score': 0.1880533403810182, 'support': 236690}, 'weighted avg': {'precision': 0.37426040296563856, 'recall': 0.37326460771473235, 'f1-score': 0.20849655329203218, 'support': 236690}}
[[  748 69591    17]
 [  538 87572    27]
 [  797 77372    28]]
Evaluating performance on  train set...
346/346 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025965
{'0': {'precision': 0.37694704049844235, 'recall': 0.0040987771416957424, 'f1-score': 0.008109376047181824, 'support': 29521}, '1': {'precision': 0.3308132615471805, 'recall': 0.9955995224287907, 'f1-score': 0.49661391866598603, 'support': 29315}, '2': {'precision': 0.30434782608695654, 'recall': 0.0002354286483032321, 'f1-score': 0.00047049334587982255, 'support': 29733}, 'accuracy': 0.33097359121137193, 'macro avg': {'precision': 0.33736937604419315, 'recall': 0.33331124273959656, 'f1-score': 0.1683979293530159, 'support': 88569}, 'weighted avg': {'precision': 0.337305583870808, 'recall': 0.33097359121137193, 'f1-score': 0.16723258809103952, 'support': 88569}}
[[  121 29391     9]
 [  122 29186     7]
 [   78 29648     7]]
Evaluating performance on  val set...
127/127 - 1s - 783ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068705
{'0': {'precision': 0.3392857142857143, 'recall': 0.0017873941674506114, 'f1-score': 0.0035560546509451614, 'support': 10630}, '1': {'precision': 0.30398609213957534, 'recall': 0.998165137614679, 'f1-score': 0.4660415972585788, 'support': 9810}, '2': {'precision': 1.0, 'recall': 0.000169061707523246, 'f1-score': 0.00033806626098715353, 'support': 11830}, 'accuracy': 0.3040904865199876, 'macro avg': {'precision': 0.5477572688084299, 'recall': 0.33337386449655093, 'f1-score': 0.15664523939017036, 'support': 32270}, 'weighted avg': {'precision': 0.5707688474355865, 'recall': 0.3040904865199876, 'f1-score': 0.1429708166691566, 'support': 32270}}
[[   19 10611     0]
 [   18  9792     0]
 [   19 11809     2]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
1590/1590 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100019
{'0': {'precision': 0.34100808960796514, 'recall': 0.0040641965053843186, 'f1-score': 0.008032658326187492, 'support': 134836}, '1': {'precision': 0.3436540606706745, 'recall': 0.9956384956384956, 'f1-score': 0.510949172941159, 'support': 139860}, '2': {'precision': 0.3277777777777778, 'recall': 0.00044597301485316905, 'f1-score': 0.0008907341007737308, 'support': 132295}, 'accuracy': 0.3436365914725387, 'macro avg': {'precision': 0.3374799760188058, 'recall': 0.3333828883862444, 'f1-score': 0.17329085512270678, 'support': 406991}, 'weighted avg': {'precision': 0.33761676500682136, 'recall': 0.3436365914725387, 'f1-score': 0.17853535462327716, 'support': 406991}}
[[   548 134238     50]
 [   539 139250     71]
 [   520 131716     59]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035438
{'0': {'precision': 0.3693516699410609, 'recall': 0.00416694372409513, 'f1-score': 0.008240915267610572, 'support': 45117}, '1': {'precision': 0.32513547615400884, 'recall': 0.9956003216008577, 'f1-score': 0.4901888555955686, 'support': 44776}, '2': {'precision': 0.3673469387755102, 'recall': 0.0003767739774772889, 'f1-score': 0.0007527758609873911, 'support': 47774}, 'accuracy': 0.32531398229059977, 'macro avg': {'precision': 0.35394469495685993, 'recall': 0.33338134643414336, 'f1-score': 0.16639418224138883, 'support': 137667}, 'weighted avg': {'precision': 0.3542747210737793, 'recall': 0.32531398229059977, 'f1-score': 0.1623952340521605, 'support': 137667}}
[[  188 44918    11]
 [  177 44579    20]
 [  144 47612    18]]
Evaluating performance on  val set...
209/209 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037537
{'0': {'precision': 0.4233128834355828, 'recall': 0.003485552636896343, 'f1-score': 0.006914174056816475, 'support': 19796}, '1': {'precision': 0.3213347839135654, 'recall': 0.9970317774415085, 'f1-score': 0.48602717961812353, 'support': 17182}, '2': {'precision': 0.5, 'recall': 0.0004844667837461394, 'f1-score': 0.0009679956440196019, 'support': 16513}, 'accuracy': 0.32169897739806697, 'macro avg': {'precision': 0.4148825557830494, 'recall': 0.33366726562071697, 'f1-score': 0.16463644977298655, 'support': 53491}, 'weighted avg': {'precision': 0.414229984440255, 'recall': 0.32169897739806697, 'f1-score': 0.15897583709216564, 'support': 53491}}
[[   69 19723     4]
 [   47 17131     4]
 [   47 16458     8]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
3782/3782 - 20s - 20s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1224949
{'0': {'precision': 0.340547703180212, 'recall': 0.0065752256413900935, 'f1-score': 0.012901354558562278, 'support': 351775}, '1': {'precision': 0.21809493568755237, 'recall': 0.9883328694158886, 'f1-score': 0.35733658107236793, 'support': 211963}, '2': {'precision': 0.3878887070376432, 'recall': 0.0005863288884490735, 'f1-score': 0.0011708878738998225, 'support': 404210}, 'accuracy': 0.21906135453557424, 'macro avg': {'precision': 0.31551044863513583, 'recall': 0.33183147464857593, 'f1-score': 0.12380294116827667, 'support': 967948}, 'weighted avg': {'precision': 0.3335021296712691, 'recall': 0.21906135453557424, 'f1-score': 0.08342782083457956, 'support': 967948}}
[[  2313 349263    199]
 [  2298 209490    175]
 [  2181 401792    237]]
Evaluating performance on  train set...
1601/1601 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025825
{'0': {'precision': 0.34004559270516715, 'recall': 0.006463307191241677, 'f1-score': 0.01268549884484005, 'support': 138474}, '1': {'precision': 0.32765282796253964, 'recall': 0.9922805502620295, 'f1-score': 0.4926362705713219, 'support': 134336}, '2': {'precision': 0.3541666666666667, 'recall': 0.0007448517598948445, 'f1-score': 0.0014865770833940594, 'support': 136940}, 'accuracy': 0.3277510677242221, 'macro avg': {'precision': 0.3406216957781245, 'recall': 0.33316290307105534, 'f1-score': 0.16893611549985202, 'support': 409750}, 'weighted avg': {'precision': 0.34070195737587405, 'recall': 0.3277510677242221, 'f1-score': 0.16629400775182296, 'support': 409750}}
[[   895 137487     92]
 [   943 133299     94]
 [   794 136044    102]]
Evaluating performance on  val set...
532/532 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1072637
{'0': {'precision': 0.4094094094094094, 'recall': 0.008185893843567368, 'f1-score': 0.01605086042815376, 'support': 49964}, '1': {'precision': 0.2966870257264483, 'recall': 0.9920782275034039, 'f1-score': 0.45677323759047134, 'support': 40395}, '2': {'precision': 0.34523809523809523, 'recall': 0.0006332015982881723, 'f1-score': 0.0012640847372665258, 'support': 45799}, 'accuracy': 0.2975440297301664, 'macro avg': {'precision': 0.3504448434579843, 'recall': 0.3336324409817531, 'f1-score': 0.15802939425196386, 'support': 136158}, 'weighted avg': {'precision': 0.3543821417747113, 'recall': 0.2975440297301664, 'f1-score': 0.1418294476988604, 'support': 136158}}
[[  409 49528    27]
 [  292 40075    28]
 [  298 45472    29]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
4457/4457 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0873528
{'0': {'precision': 0.2986111111111111, 'recall': 0.0007282683866597039, 'f1-score': 0.0014529931377048905, 'support': 354265}, '1': {'precision': 0.4120960150474224, 'recall': 0.9990025563481227, 'f1-score': 0.5834956973786773, 'support': 470202}, '2': {'precision': 0.3684210526315789, 'recall': 0.00026541290665048914, 'f1-score': 0.0005304436782480203, 'support': 316488}, 'accuracy': 0.4120013497464843, 'macro avg': {'precision': 0.35970939293003745, 'recall': 0.333332079213811, 'f1-score': 0.1951597113982101, 'support': 1140955}, 'weighted avg': {'precision': 0.3647441641873422, 'recall': 0.4120013497464843, 'f1-score': 0.24106425544532367, 'support': 1140955}}
[[   258 353949     58]
 [   383 469733     86]
 [   223 316181     84]]
Evaluating performance on  train set...
2425/2425 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023675
{'0': {'precision': 0.35284759783646197, 'recall': 0.005435155507199498, 'f1-score': 0.010705408210053818, 'support': 204042}, '1': {'precision': 0.3299497568881686, 'recall': 0.9934608308648784, 'f1-score': 0.4953748483731366, 'support': 204919}, '2': {'precision': 0.3942470389170897, 'recall': 0.0011002346852526054, 'f1-score': 0.0021943455576274697, 'support': 211773}, 'accuracy': 0.3301269142660141, 'macro avg': {'precision': 0.3590147978805734, 'recall': 0.33333207368577683, 'f1-score': 0.16942486738027263, 'support': 620734}, 'weighted avg': {'precision': 0.3594125373543302, 'recall': 0.3301269142660141, 'f1-score': 0.16780259273303225, 'support': 620734}}
[[  1109 202771    162]
 [  1144 203579    196]
 [   890 210650    233]]
Evaluating performance on  val set...
787/787 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990938
{'0': {'precision': 0.3367816091954023, 'recall': 0.0043121210337316775, 'f1-score': 0.008515214042837631, 'support': 67948}, '1': {'precision': 0.3492424280269159, 'recall': 0.9938869222786142, 'f1-score': 0.5168638178323229, 'support': 70341}, '2': {'precision': 0.2254335260115607, 'recall': 0.0006197066721751704, 'f1-score': 0.0012360155928120937, 'support': 62933}, 'accuracy': 0.34908210831817593, 'macro avg': {'precision': 0.3038191877446263, 'recall': 0.3329395833281737, 'f1-score': 0.17553834915599087, 'support': 201222}, 'weighted avg': {'precision': 0.30631296033205135, 'recall': 0.34908210831817593, 'f1-score': 0.18394159556722725, 'support': 201222}}
[[  293 67599    56]
 [  352 69911    78]
 [  225 62669    39]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001189
{'0': {'precision': 0.3804074158846418, 'recall': 0.004091902857930709, 'f1-score': 0.008096712354793844, 'support': 406168}, '1': {'precision': 0.3419976944258466, 'recall': 0.9958103288220062, 'f1-score': 0.509138576872587, 'support': 409340}, '2': {'precision': 0.35318559556786705, 'recall': 0.0006684544546591276, 'f1-score': 0.001334383397130814, 'support': 381477}, 'accuracy': 0.34214463840399, 'macro avg': {'precision': 0.3585302352927851, 'recall': 0.33352356204486533, 'f1-score': 0.17285655754150386, 'support': 1196985}, 'weighted avg': {'precision': 0.35859667161389025, 'recall': 0.34214463840399, 'f1-score': 0.1772858031603854, 'support': 1196985}}
[[  1662 404274    232]
 [  1480 407625    235]
 [  1227 379995    255]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010727
{'0': {'precision': 0.35993690851735016, 'recall': 0.006317584589744583, 'f1-score': 0.012417223047497783, 'support': 180607}, '1': {'precision': 0.33631626684782, 'recall': 0.9921708537733511, 'f1-score': 0.5023506700768688, 'support': 181629}, '2': {'precision': 0.31630170316301703, 'recall': 0.0007337543954710421, 'f1-score': 0.0014641123537295446, 'support': 177171}, 'accuracy': 0.3364398311479087, 'macro avg': {'precision': 0.3375182928427291, 'recall': 0.33307406425285563, 'f1-score': 0.1720773351593654, 'support': 539407}, 'weighted avg': {'precision': 0.3376511641839848, 'recall': 0.3364398311479087, 'f1-score': 0.1737898942879007, 'support': 539407}}
[[  1141 179365    101]
 [  1242 180207    180]
 [   787 176254    130]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077158
{'0': {'precision': 0.3473762010347376, 'recall': 0.006565529572821502, 'f1-score': 0.01288748132000713, 'support': 71586}, '1': {'precision': 0.2998859917973319, 'recall': 0.9903833615856044, 'f1-score': 0.46037224067977683, 'support': 61352}, '2': {'precision': 0.37668161434977576, 'recall': 0.001178864641077819, 'f1-score': 0.0023503735415092756, 'support': 71255}, 'accuracy': 0.30028453472939814, 'macro avg': {'precision': 0.3413146023939484, 'recall': 0.3327092519331679, 'f1-score': 0.15853669851376442, 'support': 204193}, 'weighted avg': {'precision': 0.3433336428110459, 'recall': 0.30028453472939814, 'f1-score': 0.1436621079795093, 'support': 204193}}
[[  470 71049    67]
 [  518 60762    72]
 [  365 70806    84]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
4274/4274 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126786
{'0': {'precision': 0.3916849015317287, 'recall': 0.0004597996403801695, 'f1-score': 0.0009185210272041297, 'support': 389300}, '1': {'precision': 0.28245507662283387, 'recall': 0.9993367026680731, 'f1-score': 0.44042679861821626, 'support': 309062}, '2': {'precision': 0.3816793893129771, 'recall': 0.00012635867161655702, 'f1-score': 0.00025263370638910643, 'support': 395699}, 'accuracy': 0.2825125838504434, 'macro avg': {'precision': 0.3519397891558465, 'recall': 0.3333076203266899, 'f1-score': 0.1471993177839365, 'support': 1094061}, 'weighted avg': {'precision': 0.35720971292209847, 'recall': 0.2825125838504434, 'f1-score': 0.12483466129897527, 'support': 1094061}}
[[   179 389089     32]
 [   156 308857     49]
 [   122 395527     50]]
Evaluating performance on  train set...
1972/1972 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013352
{'0': {'precision': 0.327319587628866, 'recall': 0.004708528492158632, 'f1-score': 0.009283512627770128, 'support': 161834}, '1': {'precision': 0.3376117862075701, 'recall': 0.9935714327610579, 'f1-score': 0.5039748418691278, 'support': 170489}, '2': {'precision': 0.32745098039215687, 'recall': 0.000969498531238752, 'f1-score': 0.0019332731356069552, 'support': 172254}, 'accuracy': 0.3375540304056665, 'macro avg': {'precision': 0.3307941180761977, 'recall': 0.3330831532614851, 'f1-score': 0.1717305425441683, 'support': 504577}, 'weighted avg': {'precision': 0.3308420224059815, 'recall': 0.3375540304056665, 'f1-score': 0.17392304609351816, 'support': 504577}}
[[   762 160906    166]
 [   919 169393    177]
 [   647 171440    167]]
Evaluating performance on  val set...
707/707 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057674
{'0': {'precision': 0.3196969696969697, 'recall': 0.006635950497696288, 'f1-score': 0.013002018085745538, 'support': 63593}, '1': {'precision': 0.3149914868674463, 'recall': 0.9887675889743635, 'f1-score': 0.477777495533484, 'support': 57067}, '2': {'precision': 0.32441471571906355, 'recall': 0.001614137850700569, 'f1-score': 0.003212292815392512, 'support': 60094}, 'accuracy': 0.31504143753388586, 'macro avg': {'precision': 0.3197010574278265, 'recall': 0.3323392257742534, 'f1-score': 0.16466393547820735, 'support': 180754}, 'weighted avg': {'precision': 0.3197798472035217, 'recall': 0.31504143753388586, 'f1-score': 0.1564845325590822, 'support': 180754}}
[[  422 63075    96]
 [  535 56426   106]
 [  363 59634    97]]
testing model on single stock: results/universal/W4/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
12724/12724 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0810264
{'0': {'precision': 0.29289372599231756, 'recall': 0.0020493799785655012, 'f1-score': 0.004070280170951767, 'support': 892953}, '1': {'precision': 0.44685096187872064, 'recall': 0.9976668869704294, 'f1-score': 0.6172418131523423, 'support': 1455566}, '2': {'precision': 0.30027051397655546, 'recall': 0.00036648822835408265, 'f1-score': 0.0007320829298266635, 'support': 908624}, 'accuracy': 0.44650572603045063, 'macro avg': {'precision': 0.34667173394919787, 'recall': 0.3333609183924497, 'f1-score': 0.20734805875104023, 'support': 3257143}, 'weighted avg': {'precision': 0.3637526488629494, 'recall': 0.44650572603045063, 'f1-score': 0.27715576319873736, 'support': 3257143}}
[[   1830  890835     288]
 [   2908 1452170     488]
 [   1510  906781     333]]
Evaluating performance on  train set...
5165/5165 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024886
{'0': {'precision': 0.34212261041529335, 'recall': 0.0011818742841007166, 'f1-score': 0.002355611029161466, 'support': 439133}, '1': {'precision': 0.33067168645037154, 'recall': 0.9983396188441827, 'f1-score': 0.49679433741199147, 'support': 437249}, '2': {'precision': 0.3136842105263158, 'recall': 0.00033429058601812796, 'f1-score': 0.0006678694292854021, 'support': 445720}, 'accuracy': 0.33067872221659145, 'macro avg': {'precision': 0.3288261691306602, 'recall': 0.3332852612381005, 'f1-score': 0.16660593929014614, 'support': 1322102}, 'weighted avg': {'precision': 0.32874809872765265, 'recall': 0.33067872221659145, 'f1-score': 0.16530868007093683, 'support': 1322102}}
[[   519 438454    160]
 [   560 436523    166]
 [   438 445133    149]]
Evaluating performance on  val set...
1903/1903 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097993
{'0': {'precision': 0.28135048231511256, 'recall': 0.0010953176734200825, 'f1-score': 0.0021821401183343414, 'support': 159771}, '1': {'precision': 0.3555779944432905, 'recall': 0.9980720054030028, 'f1-score': 0.524348896733263, 'support': 173237}, '2': {'precision': 0.2627118644067797, 'recall': 0.00020131046619607638, 'f1-score': 0.00040231264883945774, 'support': 153991}, 'accuracy': 0.35546068883098325, 'macro avg': {'precision': 0.29988011372172757, 'recall': 0.33312287784753963, 'f1-score': 0.17564444983347896, 'support': 486999}, 'weighted avg': {'precision': 0.30186135011612875, 'recall': 0.35546068883098325, 'f1-score': 0.18736634995006995, 'support': 486999}}
[[   175 159561     35]
 [   282 172903     52]
 [   165 153795     31]]
training model: results/universal/W4/deepLOB_L2/h300
Epoch 1/50
9854/9854 - 408s - loss: 3.2345 - accuracy300: 0.4060 - val_loss: 3.4326 - val_accuracy300: 0.3335 - 408s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 404s - loss: 3.2038 - accuracy300: 0.4220 - val_loss: 3.4696 - val_accuracy300: 0.3413 - 404s/epoch - 41ms/step
Epoch 3/50
9854/9854 - 402s - loss: 3.1883 - accuracy300: 0.4290 - val_loss: 3.4925 - val_accuracy300: 0.3422 - 402s/epoch - 41ms/step
Epoch 4/50
9854/9854 - 405s - loss: 3.1791 - accuracy300: 0.4329 - val_loss: 3.5096 - val_accuracy300: 0.3312 - 405s/epoch - 41ms/step
Epoch 5/50
9854/9854 - 404s - loss: 3.1715 - accuracy300: 0.4365 - val_loss: 3.5627 - val_accuracy300: 0.3366 - 404s/epoch - 41ms/step
Epoch 6/50
9854/9854 - 403s - loss: 3.1658 - accuracy300: 0.4381 - val_loss: 3.5857 - val_accuracy300: 0.3426 - 403s/epoch - 41ms/step
Epoch 7/50
9854/9854 - 409s - loss: 3.1597 - accuracy300: 0.4408 - val_loss: 3.7520 - val_accuracy300: 0.3451 - 409s/epoch - 42ms/step
Epoch 8/50
9854/9854 - 409s - loss: 3.1553 - accuracy300: 0.4425 - val_loss: 3.7113 - val_accuracy300: 0.3429 - 409s/epoch - 41ms/step
Epoch 9/50
9854/9854 - 403s - loss: 3.1523 - accuracy300: 0.4436 - val_loss: 3.7174 - val_accuracy300: 0.3416 - 403s/epoch - 41ms/step
Epoch 10/50
9854/9854 - 404s - loss: 3.1493 - accuracy300: 0.4446 - val_loss: 3.7412 - val_accuracy300: 0.3429 - 404s/epoch - 41ms/step
Epoch 11/50
9854/9854 - 404s - loss: 3.1459 - accuracy300: 0.4463 - val_loss: 3.8283 - val_accuracy300: 0.3428 - 404s/epoch - 41ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 317s - 317s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1166507
{'0': {'precision': 0.3088533047103003, 'recall': 0.22451659100690868, 'f1-score': 0.2600172662595862, 'support': 1837833}, '1': {'precision': 0.39545089508134557, 'recall': 0.7193588582754661, 'f1-score': 0.5103491488716436, 'support': 2336956}, '2': {'precision': 0.3316485113163076, 'recall': 0.08471501579994538, 'f1-score': 0.13495710861506263, 'support': 1896842}, 'accuracy': 0.3713046790886996, 'macro avg': {'precision': 0.34531757036931787, 'recall': 0.34286348836077335, 'f1-score': 0.3017745079154308, 'support': 6071631}, 'weighted avg': {'precision': 0.3493059711671566, 'recall': 0.3713046790886996, 'f1-score': 0.31729927755355153, 'support': 6071631}}
[[ 412624 1268819  156390]
 [ 488405 1681110  167441]
 [ 434958 1301193  160691]]
Evaluating performance on  train set...
9854/9854 - 136s - 136s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1380997
{'0': {'precision': 0.33983032786578776, 'recall': 0.21394465309023974, 'f1-score': 0.2625791489506151, 'support': 849659}, '1': {'precision': 0.31800168075621, 'recall': 0.533608806392724, 'f1-score': 0.3985119954717638, 'support': 823311}, '2': {'precision': 0.3292094903432059, 'recall': 0.23480859173027704, 'f1-score': 0.2741090020644382, 'support': 849049}, 'accuracy': 0.3253226878941039, 'macro avg': {'precision': 0.3290138329884012, 'recall': 0.3274540170710803, 'f1-score': 0.31173338216227237, 'support': 2522019}, 'weighted avg': {'precision': 0.3291288316605077, 'recall': 0.3253226878941039, 'f1-score': 0.31083589010070634, 'support': 2522019}}
[[181780 470887 196992]
 [174757 439326 209228]
 [178377 471308 199364]]
Evaluating performance on  val set...
3566/3566 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1459668
{'0': {'precision': 0.3051954417350815, 'recall': 0.16235101636416374, 'f1-score': 0.21195237092303143, 'support': 306829}, '1': {'precision': 0.3298558541058441, 'recall': 0.38336526107151037, 'f1-score': 0.354603286229987, 'support': 301201}, '2': {'precision': 0.3495627333550505, 'recall': 0.45839604103548215, 'f1-score': 0.39664937900914427, 'support': 304322}, 'accuracy': 0.3340640454561397, 'macro avg': {'precision': 0.3282046763986587, 'recall': 0.3347041061570521, 'f1-score': 0.32106834538738754, 'support': 912352}, 'weighted avg': {'precision': 0.3281358022394244, 'recall': 0.3340640454561397, 'f1-score': 0.3206537945360145, 'support': 912352}}
[[ 49814 118248 138767]
 [ 64928 115470 120803]
 [ 48478 116344 139500]]
testing model out of sample: results/universal/W4/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 166s - 166s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1219407
{'0': {'precision': 0.3094219479150986, 'recall': 0.21361932445872622, 'f1-score': 0.25274681359785706, 'support': 962221}, '1': {'precision': 0.3889374739033785, 'recall': 0.5401420383167876, 'f1-score': 0.4522357390702418, 'support': 1150253}, '2': {'precision': 0.3225728101746561, 'recall': 0.27019326173234925, 'f1-score': 0.29406878651763885, 'support': 919168}, 'accuracy': 0.3546599499545131, 'macro avg': {'precision': 0.3403107439977111, 'recall': 0.34131820816928765, 'f1-score': 0.33301711306191256, 'support': 3031642}, 'weighted avg': {'precision': 0.3435786273897826, 'recall': 0.3546599499545131, 'f1-score': 0.34096454187715813, 'support': 3031642}}
[[205549 501905 254767]
 [262160 621300 266793]
 [196591 474224 248353]]
Evaluating performance on  train set...
5528/5528 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1352365
{'0': {'precision': 0.33732453819208186, 'recall': 0.22969572818241293, 'f1-score': 0.2732953653640752, 'support': 466195}, '1': {'precision': 0.3274585686005862, 'recall': 0.565637263922829, 'f1-score': 0.4147881157791998, 'support': 467326}, '2': {'precision': 0.3388904609735729, 'recall': 0.20418843813092197, 'f1-score': 0.25483410987893157, 'support': 480943}, 'accuracy': 0.33201481267815935, 'macro avg': {'precision': 0.3345578559220803, 'recall': 0.3331738100787213, 'f1-score': 0.3143058636740688, 'support': 1414464}, 'weighted avg': {'precision': 0.33459735354474074, 'recall': 0.33201481267815935, 'f1-score': 0.31376612282676575, 'support': 1414464}}
[[107083 265733  93379]
 [104793 264337  98196]
 [105572 277168  98203]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1441863
{'0': {'precision': 0.32968004039662135, 'recall': 0.1754320610687023, 'f1-score': 0.2290044083767129, 'support': 163750}, '1': {'precision': 0.3606516562026413, 'recall': 0.40235250073968515, 'f1-score': 0.3803625300039101, 'support': 165611}, '2': {'precision': 0.336355755814223, 'recall': 0.458491305226974, 'f1-score': 0.3880399061974399, 'support': 158256}, 'accuracy': 0.34436863357922304, 'macro avg': {'precision': 0.34222915080449523, 'recall': 0.3454252890117872, 'f1-score': 0.33246894819268763, 'support': 487617}, 'weighted avg': {'precision': 0.34236563643691265, 'recall': 0.34436863357922304, 'f1-score': 0.33202561482340925, 'support': 487617}}
[[28727 60114 74909]
 [30724 66634 68253]
 [27685 58012 72559]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1692284
{'0': {'precision': 0.36281328449730443, 'recall': 0.1709156472344468, 'f1-score': 0.2323668950975224, 'support': 51581}, '1': {'precision': 0.26685444120309826, 'recall': 0.3484932082709335, 'f1-score': 0.30225827769295627, 'support': 38061}, '2': {'precision': 0.3368555466879489, 'recall': 0.4489066621288182, 'f1-score': 0.38489175831190386, 'support': 47012}, 'accuracy': 0.3160097765158722, 'macro avg': {'precision': 0.3221744241294505, 'recall': 0.32277183921139946, 'f1-score': 0.3065056437007942, 'support': 136654}, 'weighted avg': {'precision': 0.32715670141511, 'recall': 0.3160097765158722, 'f1-score': 0.30430503655257907, 'support': 136654}}
[[ 8816 18909 23856]
 [ 7107 13264 17690]
 [ 8376 17532 21104]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1347564
{'0': {'precision': 0.3359762779604203, 'recall': 0.241609493788244, 'f1-score': 0.2810839962248887, 'support': 21572}, '1': {'precision': 0.3319290115329928, 'recall': 0.5836111111111111, 'f1-score': 0.4231763402598275, 'support': 21600}, '2': {'precision': 0.346177370030581, 'recall': 0.18204374195919867, 'f1-score': 0.23861001535728266, 'support': 21764}, 'accuracy': 0.33540717013675003, 'macro avg': {'precision': 0.33802755317466476, 'recall': 0.3357547822861846, 'f1-score': 0.3142901172806663, 'support': 64936}, 'weighted avg': {'precision': 0.3380490205528581, 'recall': 0.33540717013675003, 'f1-score': 0.31411330064080745, 'support': 64936}}
[[ 5212 12544  3816]
 [ 5327 12606  3667]
 [ 4974 12828  3962]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1591607
{'0': {'precision': 0.32457386363636365, 'recall': 0.06264564770390678, 'f1-score': 0.10502125703780305, 'support': 7295}, '1': {'precision': 0.3296884670930472, 'recall': 0.5132487554199454, 'f1-score': 0.40148231894981473, 'support': 6227}, '2': {'precision': 0.3534419337887546, 'recall': 0.4739957716701903, 'f1-score': 0.40493678506923536, 'support': 7095}, 'accuracy': 0.3403016927778047, 'macro avg': {'precision': 0.3359014215060552, 'recall': 0.3499633915980142, 'f1-score': 0.3038134536856177, 'support': 20617}, 'weighted avg': {'precision': 0.3360531086019736, 'recall': 0.3403016927778047, 'f1-score': 0.2977730494377211, 'support': 20617}}
[[ 457 3277 3561]
 [ 440 3196 2591]
 [ 511 3221 3363]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.147128
{'0': {'precision': 0.3175133985914869, 'recall': 0.1041070624627852, 'f1-score': 0.15680162740337295, 'support': 137714}, '1': {'precision': 0.33112452293550476, 'recall': 0.5772660065415117, 'f1-score': 0.42084747654291416, 'support': 133914}, '2': {'precision': 0.32441371912154715, 'recall': 0.3083677356767053, 'f1-score': 0.3161872814994718, 'support': 141221}, 'accuracy': 0.32745386327688814, 'macro avg': {'precision': 0.3243505468828463, 'recall': 0.32991360156033406, 'f1-score': 0.297945461815253, 'support': 412849}, 'weighted avg': {'precision': 0.32428873357105675, 'recall': 0.32745386327688814, 'f1-score': 0.2969691881792927, 'support': 412849}}
[[14337 75687 47690]
 [13612 77304 42998]
 [17205 80468 43548]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1406453
{'0': {'precision': 0.36801730920535014, 'recall': 0.13701438980630515, 'f1-score': 0.19968515702126524, 'support': 54622}, '1': {'precision': 0.32434660858743, 'recall': 0.3898175155186598, 'f1-score': 0.3540810434428178, 'support': 53484}, '2': {'precision': 0.33288642516436767, 'recall': 0.47747781065088757, 'f1-score': 0.3922825674135967, 'support': 54080}, 'accuracy': 0.33390674904122425, 'macro avg': {'precision': 0.3417501143190493, 'recall': 0.33476990532528417, 'f1-score': 0.3153495892925599, 'support': 162186}, 'weighted avg': {'precision': 0.34190184941976337, 'recall': 0.33390674904122425, 'f1-score': 0.31482072694337687, 'support': 162186}}
[[ 7484 21381 25757]
 [ 6644 20849 25991]
 [ 6208 22050 25822]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1382997
{'0': {'precision': 0.3413173652694611, 'recall': 0.03026727240545165, 'f1-score': 0.055603728593106444, 'support': 16949}, '1': {'precision': 0.3431511912207881, 'recall': 0.3316116270124732, 'f1-score': 0.33728273626557875, 'support': 18199}, '2': {'precision': 0.3338287752675386, 'recall': 0.6387214196337163, 'f1-score': 0.43848346413650385, 'support': 17582}, 'accuracy': 0.3371515266451735, 'macro avg': {'precision': 0.33943244391926264, 'recall': 0.33353343968388033, 'f1-score': 0.277123309665063, 'support': 52730}, 'weighted avg': {'precision': 0.3394533297882246, 'recall': 0.3371515266451735, 'f1-score': 0.2804864854858684, 'support': 52730}}
[[  513  5679 10757]
 [  511  6035 11653]
 [  479  5873 11230]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1265574
{'0': {'precision': 0.3398189629123586, 'recall': 0.2946215003303187, 'f1-score': 0.31561030071197177, 'support': 87794}, '1': {'precision': 0.3277073068455813, 'recall': 0.5070677109885526, 'f1-score': 0.3981187515351096, 'support': 86308}, '2': {'precision': 0.3206253175079666, 'recall': 0.17605589156427912, 'f1-score': 0.2273006310723319, 'support': 78867}, 'accuracy': 0.33013926607608046, 'macro avg': {'precision': 0.32938386242196876, 'recall': 0.3259150342943835, 'f1-score': 0.3136765611064711, 'support': 252969}, 'weighted avg': {'precision': 0.3297027904014201, 'recall': 0.33013926607608046, 'f1-score': 0.3162286399479015, 'support': 252969}}
[[25866 48177 13751]
 [26874 43764 15670]
 [23377 41605 13885]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.126146
{'0': {'precision': 0.33872038963914103, 'recall': 0.21695203658406892, 'f1-score': 0.264494241199732, 'support': 28209}, '1': {'precision': 0.32675213675213677, 'recall': 0.6682865433695766, 'f1-score': 0.4389056634099859, 'support': 28603}, '2': {'precision': 0.3765791056747544, 'recall': 0.12633703329969728, 'f1-score': 0.18920008059641347, 'support': 29730}, 'accuracy': 0.3349934136026438, 'macro avg': {'precision': 0.34735054402201077, 'recall': 0.33719187108444765, 'f1-score': 0.2975333284020438, 'support': 86542}, 'weighted avg': {'precision': 0.34777046579189697, 'recall': 0.3349934136026438, 'f1-score': 0.2962729673066308, 'support': 86542}}
[[ 6120 18856  3233]
 [ 6503 19115  2985]
 [ 5445 20529  3756]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1478255
{'0': {'precision': 0.34763313609467456, 'recall': 0.2864241515094693, 'f1-score': 0.31407422638017884, 'support': 10666}, '1': {'precision': 0.3032514317384075, 'recall': 0.34070153590701535, 'f1-score': 0.32088749877822303, 'support': 9636}, '2': {'precision': 0.36172176539687867, 'recall': 0.3838824577025824, 'f1-score': 0.37247278382581644, 'support': 11230}, 'accuracy': 0.3377204110110364, 'macro avg': {'precision': 0.33753544440998695, 'recall': 0.33700271503968904, 'f1-score': 0.33581150299473944, 'support': 31532}, 'weighted avg': {'precision': 0.33908795037498546, 'recall': 0.3377204110110364, 'f1-score': 0.33695474436007433, 'support': 31532}}
[[3055 3707 3904]
 [2650 3283 3703]
 [3083 3836 4311]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.124559
{'0': {'precision': 0.30451034464731486, 'recall': 0.32317978167089734, 'f1-score': 0.3135674198888336, 'support': 72093}, '1': {'precision': 0.3930540552353716, 'recall': 0.7044157471856046, 'f1-score': 0.5045668963140197, 'support': 89362}, '2': {'precision': 0.4666666666666667, 'recall': 0.00018607371177182047, 'f1-score': 0.00037199909657362266, 'support': 75239}, 'accuracy': 0.36444100822158565, 'macro avg': {'precision': 0.38807702218311774, 'recall': 0.34259386752275794, 'f1-score': 0.27283543843314234, 'support': 236694}, 'weighted avg': {'precision': 0.3894847106134312, 'recall': 0.36444100822158565, 'f1-score': 0.2861209486953037, 'support': 236694}}
[[23299 48788     6]
 [26404 62948    10]
 [26810 48415    14]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1423892
{'0': {'precision': 0.3173531397704254, 'recall': 0.2987121592239505, 'f1-score': 0.3077506289416549, 'support': 29895}, '1': {'precision': 0.3143954110199511, 'recall': 0.4693619924940293, 'f1-score': 0.37655850110172856, 'support': 29310}, '2': {'precision': 0.3389108792131462, 'recall': 0.19243997956751235, 'f1-score': 0.2454875214492061, 'support': 29365}, 'accuracy': 0.31995032177938354, 'macro avg': {'precision': 0.3235531433345076, 'recall': 0.3201713770951641, 'f1-score': 0.3099322171641965, 'support': 88570}, 'weighted avg': {'precision': 0.3235217294628619, 'recall': 0.31995032177938354, 'f1-score': 0.30987778917080694, 'support': 88570}}
[[ 8930 15077  5888]
 [10418 13757  5135]
 [ 8791 14923  5651]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1417683
{'0': {'precision': 0.3734362523289859, 'recall': 0.129631340663402, 'f1-score': 0.1924554183813443, 'support': 10823}, '1': {'precision': 0.28974664172759734, 'recall': 0.34008581977846525, 'f1-score': 0.3129045586007437, 'support': 10021}, '2': {'precision': 0.3440783190066858, 'recall': 0.5044193576616784, 'f1-score': 0.40909897441357035, 'support': 11427}, 'accuracy': 0.3276935948684577, 'macro avg': {'precision': 0.33575373768775635, 'recall': 0.3247121727011819, 'f1-score': 0.30481965046521947, 'support': 32271}, 'weighted avg': {'precision': 0.33705291459819237, 'recall': 0.3276935948684577, 'f1-score': 0.3065704674631468, 'support': 32271}}
[[1403 4193 5227]
 [ 852 3408 5761]
 [1502 4161 5764]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
1590/1590 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1309767
{'0': {'precision': 0.3418599363346976, 'recall': 0.11413150743164255, 'f1-score': 0.17113035956156025, 'support': 131734}, '1': {'precision': 0.36511901685473913, 'recall': 0.4312291863075577, 'f1-score': 0.39542997879181774, 'support': 147439}, '2': {'precision': 0.31963680643795, 'recall': 0.47232088372893555, 'f1-score': 0.3812606172363926, 'support': 127822}, 'accuracy': 0.3414980528016315, 'macro avg': {'precision': 0.3422052532091289, 'recall': 0.3392271924893786, 'f1-score': 0.3159403185299235, 'support': 406995}, 'weighted avg': {'precision': 0.3433063685098651, 'recall': 0.3414980528016315, 'f1-score': 0.3183797885624137, 'support': 406995}}
[[15035 55981 60718]
 [16070 63580 67789]
 [12875 54574 60373]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1403234
{'0': {'precision': 0.33224576581860843, 'recall': 0.20057541219431227, 'f1-score': 0.2501414514993859, 'support': 45185}, '1': {'precision': 0.3209784165236799, 'recall': 0.5467891521251813, 'f1-score': 0.4045035158314027, 'support': 45502}, '2': {'precision': 0.3198187237666525, 'recall': 0.22380911838576475, 'f1-score': 0.26333583771600305, 'support': 46982}, 'accuracy': 0.3229339938548257, 'macro avg': {'precision': 0.324347635369647, 'recall': 0.3237245609017528, 'f1-score': 0.3059936016822639, 'support': 137669}, 'weighted avg': {'precision': 0.3242807612256875, 'recall': 0.3229339938548257, 'f1-score': 0.3056636191948332, 'support': 137669}}
[[ 9063 25492 10630]
 [ 8889 24880 11733]
 [ 9326 27141 10515]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1489134
{'0': {'precision': 0.3617021276595745, 'recall': 0.14450624409696716, 'f1-score': 0.20650869826034793, 'support': 19058}, '1': {'precision': 0.32009345794392524, 'recall': 0.3374384236453202, 'f1-score': 0.3285371702637889, 'support': 17458}, '2': {'precision': 0.32649050010919417, 'recall': 0.5283930254476908, 'f1-score': 0.40359955005624304, 'support': 16976}, 'accuracy': 0.3293015778060271, 'macro avg': {'precision': 0.3360953619042313, 'recall': 0.336779231063326, 'f1-score': 0.31288180619345995, 'support': 53492}, 'weighted avg': {'precision': 0.33694783271470313, 'recall': 0.3293015778060271, 'f1-score': 0.3088826488384379, 'support': 53492}}
[[2754 6526 9778]
 [2841 5891 8726]
 [2019 5987 8970]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
3782/3782 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1443894
{'0': {'precision': 0.33463790787338843, 'recall': 0.1859863800464772, 'f1-score': 0.23909024052783998, 'support': 309399}, '1': {'precision': 0.3106930431531796, 'recall': 0.4390546358715768, 'f1-score': 0.36388567713044456, 'support': 316111}, '2': {'precision': 0.33434016067246525, 'recall': 0.3410183330315791, 'f1-score': 0.3376462288427176, 'support': 342442}, 'accuracy': 0.3234798832999983, 'macro avg': {'precision': 0.3265570372330111, 'recall': 0.322019782983211, 'f1-score': 0.313540715500334, 'support': 967952}, 'weighted avg': {'precision': 0.3267127253451758, 'recall': 0.3234798832999983, 'f1-score': 0.3147127094213484, 'support': 967952}}
[[ 57544 143416 108439]
 [ 53257 138790 124064]
 [ 61158 164505 116779]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.145186
{'0': {'precision': 0.33572087709276266, 'recall': 0.11126483652515838, 'f1-score': 0.16713701297280742, 'support': 137330}, '1': {'precision': 0.3290443996082735, 'recall': 0.41286984329081877, 'f1-score': 0.36622159771764007, 'support': 135091}, '2': {'precision': 0.33402317030585627, 'recall': 0.4736366880019806, 'f1-score': 0.3917630088266383, 'support': 137331}, 'accuracy': 0.33215213104512, 'macro avg': {'precision': 0.3329294823356308, 'recall': 0.3325904559393193, 'f1-score': 0.3083738731723619, 'support': 409752}, 'weighted avg': {'precision': 0.3329507141878598, 'recall': 0.33215213104512, 'f1-score': 0.30805798047111527, 'support': 409752}}
[[15280 56876 65174]
 [14803 55775 64513]
 [15431 56855 65045]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1471977
{'0': {'precision': 0.3390501319261214, 'recall': 0.14471974356753012, 'f1-score': 0.20285367334547666, 'support': 46172}, '1': {'precision': 0.33868006993006994, 'recall': 0.3380595061512957, 'f1-score': 0.3383695035151303, 'support': 45844}, '2': {'precision': 0.3261423115009195, 'recall': 0.5222916949843687, 'f1-score': 0.40154312386791136, 'support': 44142}, 'accuracy': 0.33222432761938336, 'macro avg': {'precision': 0.3346241711190369, 'recall': 0.3350236482343982, 'f1-score': 0.31425543357617275, 'support': 136158}, 'weighted avg': {'precision': 0.3347408579109607, 'recall': 0.33222432761938336, 'f1-score': 0.31289595836184675, 'support': 136158}}
[[ 6682 15419 24071]
 [ 6782 15498 23564]
 [ 6244 14843 23055]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
4457/4457 - 63s - 63s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1347942
{'0': {'precision': 0.3575943946751007, 'recall': 0.22936558021650652, 'f1-score': 0.279473386007185, 'support': 391397}, '1': {'precision': 0.3247331673295379, 'recall': 0.44538760054811144, 'f1-score': 0.3756089492661734, 'support': 382404}, '2': {'precision': 0.31260775095368143, 'recall': 0.3111330816705615, 'f1-score': 0.3118686730804932, 'support': 367158}, 'accuracy': 0.32808015011932945, 'macro avg': {'precision': 0.33164510431944, 'recall': 0.3286287541450598, 'f1-score': 0.32231700278461717, 'support': 1140959}, 'weighted avg': {'precision': 0.33210402129856265, 'recall': 0.32808015011932945, 'f1-score': 0.32211892606931863, 'support': 1140959}}
[[ 89773 183940 117684]
 [ 78579 170318 133507]
 [ 82695 170228 114235]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1334977
{'0': {'precision': 0.34105798252581415, 'recall': 0.2607939361547058, 'f1-score': 0.2955738810798904, 'support': 205810}, '1': {'precision': 0.32849459038404105, 'recall': 0.5950219077001058, 'f1-score': 0.4232982913569289, 'support': 205179}, '2': {'precision': 0.3338385545584403, 'recall': 0.1459656349524191, 'f1-score': 0.2031201796607808, 'support': 209748}, 'accuracy': 0.3324693066467763, 'macro avg': {'precision': 0.3344637091560985, 'recall': 0.3339271596024102, 'f1-score': 0.3073307840325334, 'support': 620737}, 'weighted avg': {'precision': 0.33446581094017064, 'recall': 0.3324693066467763, 'f1-score': 0.30655177962786984, 'support': 620737}}
[[ 53674 122650  29486]
 [ 51486 122086  31607]
 [ 52215 126917  30616]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1485232
{'0': {'precision': 0.33088332964356876, 'recall': 0.2178844247477987, 'f1-score': 0.2627498549654554, 'support': 68596}, '1': {'precision': 0.3318696071713259, 'recall': 0.35742149258227274, 'f1-score': 0.34417194819509506, 'support': 66395}, '2': {'precision': 0.33313619965698743, 'recall': 0.425254035119506, 'f1-score': 0.3736005730354963, 'support': 66231}, 'accuracy': 0.33218037789108545, 'macro avg': {'precision': 0.33196304549062733, 'recall': 0.3335199841498591, 'f1-score': 0.32684079206534894, 'support': 201222}, 'weighted avg': {'precision': 0.3319502792331473, 'recall': 0.33218037789108545, 'f1-score': 0.32610164447395246, 'support': 201222}}
[[14946 24410 29240]
 [15524 23731 27140]
 [14700 23366 28165]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369214
{'0': {'precision': 0.3365554304160053, 'recall': 0.3738222937998355, 'f1-score': 0.3542113405309297, 'support': 406086}, '1': {'precision': 0.3342597488344879, 'recall': 0.6366936174454956, 'f1-score': 0.43837542778647504, 'support': 391207}, '2': {'precision': 0.754863813229572, 'recall': 0.0014561066410471958, 'f1-score': 0.0029066065368682065, 'support': 399696}, 'accuracy': 0.33539573045366333, 'macro avg': {'precision': 0.4752263308266884, 'recall': 0.3373240059621261, 'f1-score': 0.26516445828475765, 'support': 1196989}, 'weighted avg': {'precision': 0.47548578037961453, 'recall': 0.33539573045366333, 'f1-score': 0.2644114201678267, 'support': 1196989}}
[[151804 254215     67]
 [142006 249079    122]
 [157242 241872    582]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.139089
{'0': {'precision': 0.3602702048159424, 'recall': 0.2247358936452612, 'f1-score': 0.27680274323992055, 'support': 185342}, '1': {'precision': 0.3159451454857665, 'recall': 0.46507893256961313, 'f1-score': 0.37627375427125426, 'support': 172489}, '2': {'precision': 0.3337610736674809, 'recall': 0.31226800603597354, 'f1-score': 0.32265700799230645, 'support': 181578}, 'accuracy': 0.3310567676846326, 'macro avg': {'precision': 0.33665880798972997, 'recall': 0.33402761075028264, 'f1-score': 0.32524450183449377, 'support': 539409}, 'weighted avg': {'precision': 0.3371725921055908, 'recall': 0.3310567676846326, 'f1-score': 0.3240466359205997, 'support': 539409}}
[[41653 87254 56435]
 [35519 80221 56749]
 [38444 86433 56701]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1476091
{'0': {'precision': 0.34063234351634264, 'recall': 0.1788032127388178, 'f1-score': 0.2345090036676502, 'support': 71341}, '1': {'precision': 0.29591779184009565, 'recall': 0.4199455738754602, 'f1-score': 0.3471873904038432, 'support': 62470}, '2': {'precision': 0.35034318496132766, 'recall': 0.38872154812309967, 'f1-score': 0.36853590527634467, 'support': 70382}, 'accuracy': 0.32493278417967314, 'macro avg': {'precision': 0.32896444010592196, 'recall': 0.32915677824579254, 'f1-score': 0.3167440997826127, 'support': 204193}, 'weighted avg': {'precision': 0.33029971898644095, 'recall': 0.32493278417967314, 'f1-score': 0.3151782734684422, 'support': 204193}}
[[12756 31604 26981]
 [12484 26234 23752]
 [12208 30815 27359]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981781
{'0': {'precision': 0.24609642974319204, 'recall': 0.22023255425988023, 'f1-score': 0.23244725151470866, 'support': 299715}, '1': {'precision': 0.46217143208699263, 'recall': 0.6663541924961848, 'f1-score': 0.5457915437886178, 'support': 496041}, '2': {'precision': 0.3558764526214961, 'recall': 0.13201747181613696, 'f1-score': 0.19259067268828353, 'support': 298309}, 'accuracy': 0.39844798983607005, 'macro avg': {'precision': 0.3547147714838936, 'recall': 0.3395347395240673, 'f1-score': 0.32360982266387, 'support': 1094065}, 'weighted avg': {'precision': 0.373995986974641, 'recall': 0.39844798983607005, 'f1-score': 0.3636479022170985, 'support': 1094065}}
[[ 66007 194869  38839]
 [133061 330539  32441]
 [ 69148 189779  39382]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1374495
{'0': {'precision': 0.3331691379743654, 'recall': 0.20035183382803667, 'f1-score': 0.2502283932440901, 'support': 165419}, '1': {'precision': 0.3269461811002533, 'recall': 0.5133920524867521, 'f1-score': 0.39948574100046746, 'support': 166442}, '2': {'precision': 0.34182278586683545, 'recall': 0.2844852042913634, 'f1-score': 0.3105294091624376, 'support': 172719}, 'accuracy': 0.3324111141939831, 'macro avg': {'precision': 0.3339793683138181, 'recall': 0.3327430302020507, 'f1-score': 0.320081181135665, 'support': 504580}, 'weighted avg': {'precision': 0.3340785834979663, 'recall': 0.3324111141939831, 'f1-score': 0.32010397817347297, 'support': 504580}}
[[33142 86036 46241]
 [32622 85450 48370]
 [33711 89872 49136]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1351521
{'0': {'precision': 0.3117203850983675, 'recall': 0.12809839167455062, 'f1-score': 0.18157878695519658, 'support': 58135}, '1': {'precision': 0.40895899392701673, 'recall': 0.4619166856362395, 'f1-score': 0.4338276690207593, 'support': 65895}, '2': {'precision': 0.33771653161240234, 'recall': 0.49079754601226994, 'f1-score': 0.4001149755676919, 'support': 56724}, 'accuracy': 0.363615742943448, 'macro avg': {'precision': 0.35279863687926216, 'recall': 0.3602708744410201, 'f1-score': 0.3385071438478826, 'support': 180754}, 'weighted avg': {'precision': 0.3553274064844832, 'recall': 0.363615742943448, 'f1-score': 0.34211845327829554, 'support': 180754}}
[[ 7447 22386 28302]
 [ 9163 30438 26294]
 [ 7280 21604 27840]]
testing model on single stock: results/universal/W4/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
12724/12724 - 174s - 174s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965289
{'0': {'precision': 0.27971908448618693, 'recall': 0.18113487503575182, 'f1-score': 0.21988259129238708, 'support': 912541}, '1': {'precision': 0.4325339234974727, 'recall': 0.8199190535580455, 'f1-score': 0.5663171579016901, 'support': 1406362}, '2': {'precision': 0.29292929292929293, 'recall': 9.27264123191835e-05, 'f1-score': 0.00018539413834877752, 'support': 938244}, 'accuracy': 0.40479689740745506, 'macro avg': {'precision': 0.3350607669709842, 'recall': 0.33371555166870553, 'f1-score': 0.26212838111080866, 'support': 3257147}, 'weighted avg': {'precision': 0.3495063496701297, 'recall': 0.40479689740745506, 'f1-score': 0.3061798425123041, 'support': 3257147}}
[[ 165293  747170      78]
 [ 253127 1153103     132]
 [ 172505  765652      87]]
Evaluating performance on  train set...
5165/5165 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1347977
{'0': {'precision': 0.33506028983369596, 'recall': 0.24643026645874297, 'f1-score': 0.28399084253377405, 'support': 442470}, '1': {'precision': 0.3169805641099811, 'recall': 0.6226587240175823, 'f1-score': 0.42009889556746516, 'support': 432937}, '2': {'precision': 0.3170469853730588, 'recall': 0.10379341608927792, 'f1-score': 0.15638892824134978, 'support': 446695}, 'accuracy': 0.32143813412278327, 'macro avg': {'precision': 0.3230292797722453, 'recall': 0.32429413552186775, 'f1-score': 0.28682622211419634, 'support': 1322102}, 'weighted avg': {'precision': 0.3230537765301141, 'recall': 0.32143813412278327, 'f1-score': 0.285448426783244, 'support': 1322102}}
[[109038 289954  43478]
 [106970 269572  56395]
 [109420 290911  46364]]
Evaluating performance on  val set...
1903/1903 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1453816
{'0': {'precision': 0.2819491051454139, 'recall': 0.1747573416530481, 'f1-score': 0.21577394600874378, 'support': 161544}, '1': {'precision': 0.34664657525431547, 'recall': 0.3925680312388032, 'f1-score': 0.3681809379520886, 'support': 164667}, '2': {'precision': 0.36168290991112373, 'recall': 0.45076466673715243, 'f1-score': 0.40134005205160855, 'support': 160789}, 'accuracy': 0.3395318275154004, 'macro avg': {'precision': 0.33009286343695105, 'recall': 0.3393633465430012, 'f1-score': 0.3284316453374803, 'support': 487000}, 'weighted avg': {'precision': 0.33015004363596057, 'recall': 0.3395318275154004, 'f1-score': 0.32857351637190796, 'support': 487000}}
[[28231 61188 72125]
 [44236 64643 55788]
 [27661 60650 72478]]
training model: results/universal/W4/deepLOB_L2/h500
Epoch 1/50
9854/9854 - 406s - loss: 3.2040 - accuracy500: 0.4233 - val_loss: 3.6517 - val_accuracy500: 0.3337 - 406s/epoch - 41ms/step
Epoch 2/50
9854/9854 - 403s - loss: 3.1798 - accuracy500: 0.4341 - val_loss: 3.6560 - val_accuracy500: 0.3222 - 403s/epoch - 41ms/step
Epoch 3/50
9854/9854 - 402s - loss: 3.1607 - accuracy500: 0.4423 - val_loss: 3.6995 - val_accuracy500: 0.3105 - 402s/epoch - 41ms/step
Epoch 4/50
9854/9854 - 403s - loss: 3.1488 - accuracy500: 0.4473 - val_loss: 3.5169 - val_accuracy500: 0.3185 - 403s/epoch - 41ms/step
Epoch 5/50
9854/9854 - 401s - loss: 3.1411 - accuracy500: 0.4503 - val_loss: 3.5823 - val_accuracy500: 0.3309 - 401s/epoch - 41ms/step
Epoch 6/50
9854/9854 - 402s - loss: 3.1339 - accuracy500: 0.4528 - val_loss: 3.5832 - val_accuracy500: 0.3216 - 402s/epoch - 41ms/step
Epoch 7/50
9854/9854 - 401s - loss: 3.1273 - accuracy500: 0.4546 - val_loss: 3.7677 - val_accuracy500: 0.3362 - 401s/epoch - 41ms/step
Epoch 8/50
9854/9854 - 403s - loss: 3.1212 - accuracy500: 0.4573 - val_loss: 3.6849 - val_accuracy500: 0.3251 - 403s/epoch - 41ms/step
Epoch 9/50
9854/9854 - 403s - loss: 3.1162 - accuracy500: 0.4583 - val_loss: 3.7057 - val_accuracy500: 0.3372 - 403s/epoch - 41ms/step
Epoch 10/50
9854/9854 - 401s - loss: 3.1142 - accuracy500: 0.4590 - val_loss: 3.8621 - val_accuracy500: 0.3384 - 401s/epoch - 41ms/step
Epoch 11/50
9854/9854 - 400s - loss: 3.1113 - accuracy500: 0.4604 - val_loss: 3.7643 - val_accuracy500: 0.3308 - 400s/epoch - 41ms/step
Epoch 12/50
9854/9854 - 403s - loss: 3.1086 - accuracy500: 0.4611 - val_loss: 3.8061 - val_accuracy500: 0.3308 - 403s/epoch - 41ms/step
Epoch 13/50
9854/9854 - 407s - loss: 3.1013 - accuracy500: 0.4633 - val_loss: 3.8441 - val_accuracy500: 0.3472 - 407s/epoch - 41ms/step
Epoch 14/50
9854/9854 - 408s - loss: 3.0971 - accuracy500: 0.4651 - val_loss: 3.8347 - val_accuracy500: 0.3387 - 408s/epoch - 41ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 326s - 326s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1262197
{'0': {'precision': 0.28860341453365607, 'recall': 0.09960485109985147, 'f1-score': 0.14809731103804882, 'support': 1800334}, '1': {'precision': 0.39771200822756536, 'recall': 0.8842701484023735, 'f1-score': 0.5486579586432008, 'support': 2400029}, '2': {'precision': 0.35109879995441756, 'recall': 0.02140420292550292, 'f1-score': 0.04034861412136014, 'support': 1871268}, 'accuracy': 0.38567050599748237, 'macro avg': {'precision': 0.34580474090521296, 'recall': 0.33509306747590933, 'f1-score': 0.2457012946008699, 'support': 6071631}, 'weighted avg': {'precision': 0.35099347148872084, 'recall': 0.38567050599748237, 'f1-score': 0.27322521850298653, 'support': 6071631}}
[[ 179322 1581733   39279]
 [ 243008 2122274   34747]
 [ 199014 1632201   40053]]
Evaluating performance on  train set...
9854/9854 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1641752
{'0': {'precision': 0.3308400063314001, 'recall': 0.09658156519101624, 'f1-score': 0.1495153626686647, 'support': 844012}, '1': {'precision': 0.32751891937400024, 'recall': 0.8418403965381059, 'f1-score': 0.47157217325365614, 'support': 831799}, '2': {'precision': 0.33049677344340445, 'recall': 0.05374446944486462, 'f1-score': 0.09245428006863073, 'support': 846208}, 'accuracy': 0.32800585562598855, 'macro avg': {'precision': 0.3296185663829349, 'recall': 0.3307221437246623, 'f1-score': 0.23784727199698386, 'support': 2522019}, 'weighted avg': {'precision': 0.3296294987080383, 'recall': 0.32800585562598855, 'f1-score': 0.2365888495864777, 'support': 2522019}}
[[ 81516 716806  45690]
 [ 85118 700242  46439]
 [ 79757 720972  45479]]
Evaluating performance on  val set...
3566/3566 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.173727
{'0': {'precision': 0.26871932496796497, 'recall': 0.07276196960422647, 'f1-score': 0.11451606671389014, 'support': 305503}, '1': {'precision': 0.3224841283050415, 'recall': 0.8326663036275481, 'f1-score': 0.4649120316651205, 'support': 304834}, '2': {'precision': 0.34626325316783035, 'recall': 0.04876910087247322, 'f1-score': 0.08549652882583761, 'support': 302015}, 'accuracy': 0.3187179948090211, 'macro avg': {'precision': 0.3124889021469456, 'recall': 0.3180657913680826, 'f1-score': 0.22164154240161607, 'support': 912352}, 'weighted avg': {'precision': 0.31235245070861856, 'recall': 0.3187179948090211, 'f1-score': 0.22198365361530886, 'support': 912352}}
[[ 22229 268224  15050]
 [ 38251 253825  12758]
 [ 22242 265044  14729]]
testing model out of sample: results/universal/W4/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 161s - 161s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1587267
{'0': {'precision': 0.3327534078765606, 'recall': 0.0995242744747238, 'f1-score': 0.1532211485810384, 'support': 1026222}, '1': {'precision': 0.3394376448475195, 'recall': 0.846058894425706, 'f1-score': 0.4844961229532015, 'support': 1029673}, '2': {'precision': 0.33378209260874514, 'recall': 0.054121611442310355, 'f1-score': 0.09314076939153992, 'support': 975747}, 'accuracy': 0.3384657555212654, 'macro avg': {'precision': 0.3353243817776084, 'recall': 0.3332349267809134, 'f1-score': 0.24361934697525992, 'support': 3031642}, 'weighted avg': {'precision': 0.33535474219504974, 'recall': 0.3384657555212654, 'f1-score': 0.24639892053883974, 'support': 3031642}}
[[102134 867725  56363]
 [109467 871164  49042]
 [ 95335 827603  52809]]
Evaluating performance on  train set...
5528/5528 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1633408
{'0': {'precision': 0.3291212734033531, 'recall': 0.10820357740316562, 'f1-score': 0.162863368573965, 'support': 466260}, '1': {'precision': 0.328187929586742, 'recall': 0.8369453948619752, 'f1-score': 0.4714917521509781, 'support': 467923}, '2': {'precision': 0.3444958453650775, 'recall': 0.0486860816896775, 'f1-score': 0.08531497362981773, 'support': 480281}, 'accuracy': 0.329071648341704, 'macro avg': {'precision': 0.3339350161183909, 'recall': 0.33127835131827277, 'f1-score': 0.23989003145158697, 'support': 1414464}, 'weighted avg': {'precision': 0.33403294436680553, 'recall': 0.329071648341704, 'f1-score': 0.23863008901106111, 'support': 1414464}}
[[ 50451 394384  21425]
 [ 53229 391626  23068]
 [ 49610 407288  23383]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1794015
{'0': {'precision': 0.3167555443663745, 'recall': 0.08197789440015163, 'f1-score': 0.1302471778993878, 'support': 168826}, '1': {'precision': 0.31986503325695936, 'recall': 0.8544745951135704, 'f1-score': 0.465481259731434, 'support': 158316}, '2': {'precision': 0.3314925017852892, 'recall': 0.04338993612712261, 'f1-score': 0.07673572845492617, 'support': 160475}, 'accuracy': 0.3200872816165146, 'macro avg': {'precision': 0.3227043598028743, 'recall': 0.32661414188028154, 'f1-score': 0.22415472202858266, 'support': 487617}, 'weighted avg': {'precision': 0.32261505107963956, 'recall': 0.3200872816165146, 'f1-score': 0.2214779369781776, 'support': 487617}}
[[ 13840 148399   6587]
 [ 15584 135277   7455]
 [ 14269 139243   6963]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
534/534 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.191633
{'0': {'precision': 0.3791829966837504, 'recall': 0.09903543307086614, 'f1-score': 0.15705188237497658, 'support': 50800}, '1': {'precision': 0.29863759757118574, 'recall': 0.8465706134778127, 'f1-score': 0.44152288072018, 'support': 41713}, '2': {'precision': 0.35415450476746446, 'recall': 0.04123150812170091, 'f1-score': 0.07386363636363637, 'support': 44141}, 'accuracy': 0.3085456700864958, 'macro avg': {'precision': 0.3439916996741335, 'recall': 0.3289458515567933, 'f1-score': 0.22414613315293097, 'support': 136654}, 'weighted avg': {'precision': 0.34651236212596803, 'recall': 0.3085456700864958, 'f1-score': 0.21701446222472043, 'support': 136654}}
[[ 5031 44324  1445]
 [ 4526 35313  1874]
 [ 3711 38610  1820]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1596186
{'0': {'precision': 0.34130350944851523, 'recall': 0.12362637362637363, 'f1-score': 0.18150743462655958, 'support': 21476}, '1': {'precision': 0.3328074841786664, 'recall': 0.8362370943952803, 'f1-score': 0.47612549369513585, 'support': 21696}, '2': {'precision': 0.3955336866010598, 'recall': 0.04801507075905165, 'f1-score': 0.08563467999672213, 'support': 21764}, 'accuracy': 0.33637735616607123, 'macro avg': {'precision': 0.35654822674274717, 'recall': 0.3359595129269019, 'f1-score': 0.2477558694394725, 'support': 64936}, 'weighted avg': {'precision': 0.3566407000868875, 'recall': 0.33637735616607123, 'f1-score': 0.2478105450397056, 'support': 64936}}
[[ 2655 18071   750]
 [ 2706 18143   847]
 [ 2418 18301  1045]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2015083
{'0': {'precision': 0.2563451776649746, 'recall': 0.013356254959005553, 'f1-score': 0.02538964303670186, 'support': 7562}, '1': {'precision': 0.27458954661846663, 'recall': 0.965572033898305, 'f1-score': 0.4275829717368359, 'support': 5664}, '2': {'precision': 0.3888888888888889, 'recall': 0.016100662968475173, 'f1-score': 0.030921138105755492, 'support': 7391}, 'accuracy': 0.27593733326866177, 'macro avg': {'precision': 0.30660787105744336, 'recall': 0.33167631727526187, 'f1-score': 0.1612979176264311, 'support': 20617}, 'weighted avg': {'precision': 0.3088730272749338, 'recall': 0.27593733326866177, 'f1-score': 0.13786509018288873, 'support': 20617}}
[[ 101 7349  112]
 [ 120 5469   75]
 [ 173 7099  119]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1826814
{'0': {'precision': 0.2949078632719088, 'recall': 0.02964403124889533, 'f1-score': 0.05387278929482279, 'support': 141445}, '1': {'precision': 0.3101772426754887, 'recall': 0.9499596132280402, 'f1-score': 0.46765690901545204, 'support': 127517}, '2': {'precision': 0.21401210923019895, 'recall': 0.01203722365467346, 'f1-score': 0.022792472693775497, 'support': 143887}, 'accuracy': 0.30776627774319426, 'macro avg': {'precision': 0.27303240505919885, 'recall': 0.3305469560438697, 'f1-score': 0.18144072366801678, 'support': 412849}, 'weighted avg': {'precision': 0.27143017068117176, 'recall': 0.30776627774319426, 'f1-score': 0.17084644329335635, 'support': 412849}}
[[  4193 133371   3881]
 [  3901 121136   2480]
 [  6124 136031   1732]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1730839
{'0': {'precision': 0.381151832460733, 'recall': 0.07398784115897038, 'f1-score': 0.1239206462195537, 'support': 54117}, '1': {'precision': 0.33480456678493764, 'recall': 0.8667543242342309, 'f1-score': 0.48302802002167294, 'support': 53998}, '2': {'precision': 0.31777273109597104, 'recall': 0.06987109541158847, 'f1-score': 0.11455427531837477, 'support': 54071}, 'accuracy': 0.33655802597018236, 'macro avg': {'precision': 0.3445763767805472, 'recall': 0.3368710869349299, 'f1-score': 0.24050098051986715, 'support': 162186}, 'weighted avg': {'precision': 0.34459114878978947, 'recall': 0.33655802597018236, 'f1-score': 0.24035875388340378, 'support': 162186}}
[[ 4004 45773  4340]
 [ 3424 46803  3771]
 [ 3077 47216  3778]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1659186
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 17501}, '1': {'precision': 0.3278174534053301, 'recall': 0.9798114189853647, 'f1-score': 0.49126979523174197, 'support': 17287}, '2': {'precision': 0.3694627709707823, 'recall': 0.021848177460706723, 'f1-score': 0.04125664368783877, 'support': 17942}, 'accuracy': 0.3286554143751185, 'macro avg': {'precision': 0.23242674145870412, 'recall': 0.3338865321486905, 'f1-score': 0.17750881297319357, 'support': 52730}, 'weighted avg': {'precision': 0.233185688484273, 'recall': 0.3286554143751185, 'f1-score': 0.17509591601020907, 'support': 52730}}
[[    0 17181   320]
 [    0 16938   349]
 [    0 17550   392]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1473639
{'0': {'precision': 0.3441846090450191, 'recall': 0.1530708084209562, 'f1-score': 0.2119016284269111, 'support': 87306}, '1': {'precision': 0.35880497082485036, 'recall': 0.837275899146387, 'f1-score': 0.5023385326324866, 'support': 91142}, '2': {'precision': 0.3561643835616438, 'recall': 0.006977898847304787, 'f1-score': 0.013687632434424397, 'support': 74521}, 'accuracy': 0.35654566369792345, 'macro avg': {'precision': 0.35305132114383775, 'recall': 0.33244153547154937, 'f1-score': 0.24264259783127404, 'support': 252969}, 'weighted avg': {'precision': 0.3529812354699595, 'recall': 0.35654566369792345, 'f1-score': 0.2581519402348736, 'support': 252969}}
[[13364 73486   456]
 [14347 76311   484]
 [11117 62884   520]]
Evaluating performance on  train set...
339/339 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1466911
{'0': {'precision': 0.35847647498132934, 'recall': 0.10388111383638725, 'f1-score': 0.16108283461043682, 'support': 27724}, '1': {'precision': 0.3350140807295159, 'recall': 0.8547575871625551, 'f1-score': 0.4813626598071235, 'support': 29227}, '2': {'precision': 0.361604875571356, 'recall': 0.04812274002230408, 'f1-score': 0.0849413940171195, 'support': 29591}, 'accuracy': 0.33840216311155275, 'macro avg': {'precision': 0.35169847709406704, 'recall': 0.33558714700708214, 'f1-score': 0.2424622961448933, 'support': 86542}, 'weighted avg': {'precision': 0.351622428449723, 'recall': 0.33840216311155275, 'f1-score': 0.24321309601445693, 'support': 86542}}
[[ 2880 23579  1265]
 [ 2996 24982  1249]
 [ 2158 26009  1424]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.190175
{'0': {'precision': 0.3180762081784387, 'recall': 0.12956653416619346, 'f1-score': 0.18412911903160725, 'support': 10566}, '1': {'precision': 0.309142668537008, 'recall': 0.7672537374564816, 'f1-score': 0.4407128573109046, 'support': 9766}, '2': {'precision': 0.3357859531772575, 'recall': 0.08964285714285715, 'f1-score': 0.14150810429880198, 'support': 11200}, 'accuracy': 0.31288849422808573, 'macro avg': {'precision': 0.32100160996423477, 'recall': 0.32882104292184405, 'f1-score': 0.25545002688043794, 'support': 31532}, 'weighted avg': {'precision': 0.32159974603993047, 'recall': 0.31288849422808573, 'f1-score': 0.24845873412193453, 'support': 31532}}
[[1369 8121 1076]
 [1363 7493  910]
 [1572 8624 1004]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1488853
{'0': {'precision': 0.3038600345206339, 'recall': 0.1629776131964316, 'f1-score': 0.21216105176663932, 'support': 71292}, '1': {'precision': 0.3821861817668671, 'recall': 0.8606823443955146, 'f1-score': 0.529325334087189, 'support': 88108}, '2': {'precision': 0.35135135135135137, 'recall': 0.00016818899267731, 'f1-score': 0.00033621704103141046, 'support': 77294}, 'accuracy': 0.3695277446830084, 'macro avg': {'precision': 0.3457991892129508, 'recall': 0.34127604886154117, 'f1-score': 0.24727420096495323, 'support': 236694}, 'weighted avg': {'precision': 0.3485251042929331, 'recall': 0.3695277446830084, 'f1-score': 0.261050849612879, 'support': 236694}}
[[11619 59660    13]
 [12264 75833    11]
 [14355 62926    13]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1843214
{'0': {'precision': 0.31184692631293254, 'recall': 0.15421266315471596, 'f1-score': 0.20637165757392065, 'support': 29803}, '1': {'precision': 0.3225719437227593, 'recall': 0.7770254095277179, 'f1-score': 0.4558879592287165, 'support': 29241}, '2': {'precision': 0.2780559646539028, 'recall': 0.03197182144550566, 'f1-score': 0.05734941222927615, 'support': 29526}, 'accuracy': 0.31908095291859545, 'macro avg': {'precision': 0.3041582782298649, 'recall': 0.3210699647093132, 'f1-score': 0.23986967634397108, 'support': 88570}, 'weighted avg': {'precision': 0.3041230728652215, 'recall': 0.31908095291859545, 'f1-score': 0.23906981000298141, 'support': 88570}}
[[ 4596 23801  1406]
 [ 5475 22721  1045]
 [ 4667 23915   944]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1821682
{'0': {'precision': 0.3912536443148688, 'recall': 0.06222181008902077, 'f1-score': 0.10736858948715898, 'support': 10784}, '1': {'precision': 0.3086590691234423, 'recall': 0.8838958926392843, 'f1-score': 0.45754282556640263, 'support': 9836}, '2': {'precision': 0.2963583089158644, 'recall': 0.06076731611020513, 'f1-score': 0.10085470085470086, 'support': 11651}, 'accuracy': 0.31213783272907564, 'macro avg': {'precision': 0.33209034078472516, 'recall': 0.3356283396128367, 'f1-score': 0.22192203863608748, 'support': 32271}, 'weighted avg': {'precision': 0.33181867811249915, 'recall': 0.31213783272907564, 'f1-score': 0.21174776799475625, 'support': 32271}}
[[  671  9181   932]
 [  393  8694   749]
 [  651 10292   708]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1494837
{'0': {'precision': 0.38262787522319086, 'recall': 0.05464062874970002, 'f1-score': 0.09562558240258293, 'support': 133344}, '1': {'precision': 0.36244509074115816, 'recall': 0.9037575740959065, 'f1-score': 0.5173934711207555, 'support': 145892}, '2': {'precision': 0.2918373257209052, 'recall': 0.055213331350433235, 'f1-score': 0.09285855328111631, 'support': 127759}, 'accuracy': 0.35919605891964274, 'macro avg': {'precision': 0.34563676389508474, 'recall': 0.3378705113986799, 'f1-score': 0.23529253560148491, 'support': 406995}, 'weighted avg': {'precision': 0.346893243083938, 'recall': 0.35919605891964274, 'f1-score': 0.2459445001960255, 'support': 406995}}
[[  7286 116567   9491]
 [  6415 131851   7626]
 [  5341 115364   7054]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.165406
{'0': {'precision': 0.32503911197198837, 'recall': 0.09713039025801999, 'f1-score': 0.14956635014226458, 'support': 44919}, '1': {'precision': 0.3276641139278931, 'recall': 0.8297278896624426, 'f1-score': 0.4698011614459629, 'support': 45533}, '2': {'precision': 0.2991615427613192, 'recall': 0.0566745028273715, 'f1-score': 0.09529575157579859, 'support': 47217}, 'accuracy': 0.32555622543927826, 'macro avg': {'precision': 0.31728825622040024, 'recall': 0.3278442609159447, 'f1-score': 0.238221087721342, 'support': 137669}, 'weighted avg': {'precision': 0.3170319573375975, 'recall': 0.32555622543927826, 'f1-score': 0.23686818868673337, 'support': 137669}}
[[ 4363 37374  3182]
 [ 4666 37780  3087]
 [ 4394 40147  2676]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1706674
{'0': {'precision': 0.34893009985734663, 'recall': 0.0645042194092827, 'f1-score': 0.10888048074782997, 'support': 18960}, '1': {'precision': 0.32300142605486115, 'recall': 0.8690402302093325, 'f1-score': 0.4709587658813276, 'support': 17723}, '2': {'precision': 0.32305688232739904, 'recall': 0.04426200249866143, 'f1-score': 0.0778568438677271, 'support': 16809}, 'accuracy': 0.324702759291109, 'macro avg': {'precision': 0.33166280274653565, 'recall': 0.3259354840390922, 'f1-score': 0.2192320301656282, 'support': 53492}, 'weighted avg': {'precision': 0.3322091546830712, 'recall': 0.324702759291109, 'f1-score': 0.21909578649641534, 'support': 53492}}
[[ 1223 16962   775]
 [ 1537 15402   784]
 [  745 15320   744]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1942767
{'0': {'precision': 0.34477112622674116, 'recall': 0.10520407345040494, 'f1-score': 0.16121478211759813, 'support': 324246}, '1': {'precision': 0.28860824755758296, 'recall': 0.7902251490483834, 'f1-score': 0.42280021393531725, 'support': 279104}, '2': {'precision': 0.36077054451430696, 'recall': 0.10370760445636612, 'f1-score': 0.16110402184865716, 'support': 364602}, 'accuracy': 0.30216271054763044, 'macro avg': {'precision': 0.3313833060995437, 'recall': 0.3330456089850515, 'f1-score': 0.24837300596719084, 'support': 967952}, 'weighted avg': {'precision': 0.3346034069786858, 'recall': 0.30216271054763044, 'f1-score': 0.23659988070355717, 'support': 967952}}
[[ 34112 255044  35090]
 [ 26642 220555  31907]
 [ 38187 288603  37812]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1744342
{'0': {'precision': 0.3186987046375952, 'recall': 0.04658961960724792, 'f1-score': 0.08129496856535694, 'support': 138357}, '1': {'precision': 0.32679596675140676, 'recall': 0.8562832123344061, 'f1-score': 0.47305354558610707, 'support': 133610}, '2': {'precision': 0.34694188051526526, 'recall': 0.09929963348695431, 'f1-score': 0.1544060805435022, 'support': 137785}, 'accuracy': 0.3283351881137859, 'macro avg': {'precision': 0.3308121839680891, 'recall': 0.3340574884762028, 'f1-score': 0.23625153156498876, 'support': 409752}, 'weighted avg': {'precision': 0.3308361955573006, 'recall': 0.3283351881137859, 'f1-score': 0.23362242038902384, 'support': 409752}}
[[  6446 118067  13844]
 [  7292 114408  11910]
 [  6488 117615  13682]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.188109
{'0': {'precision': 0.3152659358505887, 'recall': 0.06480554164580203, 'f1-score': 0.10751124956732432, 'support': 47928}, '1': {'precision': 0.3136576850848383, 'recall': 0.8830352152040246, 'f1-score': 0.4628936653379158, 'support': 42936}, '2': {'precision': 0.3422361392521643, 'recall': 0.041020885768534465, 'f1-score': 0.07326065098673186, 'support': 45294}, 'accuracy': 0.3149135563095815, 'macro avg': {'precision': 0.3237199200625304, 'recall': 0.3296205475394537, 'f1-score': 0.21455518863065734, 'support': 136158}, 'weighted avg': {'precision': 0.32373063522919815, 'recall': 0.3149135563095815, 'f1-score': 0.20818365068526642, 'support': 136158}}
[[ 3106 42969  1853]
 [ 3304 37914  1718]
 [ 3442 39994  1858]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
4457/4457 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1776015
{'0': {'precision': 0.3630831472038434, 'recall': 0.10547423987934049, 'f1-score': 0.16346308913288066, 'support': 408422}, '1': {'precision': 0.3102962166153359, 'recall': 0.7994360998035408, 'f1-score': 0.4470663664103407, 'support': 353254}, '2': {'precision': 0.321845226954716, 'recall': 0.09521122750030979, 'f1-score': 0.14695026918365933, 'support': 379283}, 'accuracy': 0.31692111635913295, 'macro avg': {'precision': 0.3317415302579651, 'recall': 0.3333738557277304, 'f1-score': 0.2524932415756269, 'support': 1140959}, 'weighted avg': {'precision': 0.3330312027571434, 'recall': 0.31692111635913295, 'f1-score': 0.24578064850405118, 'support': 1140959}}
[[ 43078 324734  40610]
 [ 35369 282404  35481]
 [ 40198 302973  36112]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1646398
{'0': {'precision': 0.32834955372901015, 'recall': 0.12611853573503776, 'f1-score': 0.18223926337442797, 'support': 206520}, '1': {'precision': 0.32728770079798564, 'recall': 0.84543720657277, 'f1-score': 0.4718944703385494, 'support': 204480}, '2': {'precision': 0.40513325257419747, 'recall': 0.02551290425628287, 'f1-score': 0.04800287066316805, 'support': 209737}, 'accuracy': 0.32907978741399335, 'macro avg': {'precision': 0.3535901690337311, 'recall': 0.3323562155213635, 'f1-score': 0.23404553479204848, 'support': 620737}, 'weighted avg': {'precision': 0.35394373444863403, 'recall': 0.32907978741399335, 'f1-score': 0.23229968900064657, 'support': 620737}}
[[ 26046 176574   3900]
 [ 27648 172875   3957]
 [ 25630 178756   5351]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1885009
{'0': {'precision': 0.3322326975713603, 'recall': 0.10697498740977002, 'f1-score': 0.16183955725336238, 'support': 71484}, '1': {'precision': 0.3113654006497801, 'recall': 0.8663957246631893, 'f1-score': 0.45809909349712147, 'support': 62498}, '2': {'precision': 0.3969767441860465, 'recall': 0.025386674598453302, 'f1-score': 0.04772155437517473, 'support': 67240}, 'accuracy': 0.3155817952311378, 'macro avg': {'precision': 0.34685828080239567, 'recall': 0.3329191288904709, 'f1-score': 0.22255340170855287, 'support': 201222}, 'weighted avg': {'precision': 0.3473862363065214, 'recall': 0.3155817952311378, 'f1-score': 0.2157220054083013, 'support': 201222}}
[[ 7647 62433  1404]
 [ 7161 54148  1189]
 [ 8209 57324  1707]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1031744
{'0': {'precision': 0.266207288795555, 'recall': 0.1847050038248115, 'f1-score': 0.21809038742074346, 'support': 329428}, '1': {'precision': 0.4658964805366298, 'recall': 0.8198385425189549, 'f1-score': 0.5941502482527434, 'support': 549990}, '2': {'precision': 0.8103161397670549, 'recall': 0.001533515339876752, 'f1-score': 0.0030612373181801034, 'support': 317571}, 'accuracy': 0.42793793426673093, 'macro avg': {'precision': 0.5141399696997465, 'recall': 0.3353590205612144, 'f1-score': 0.27176729099722235, 'support': 1196989}, 'weighted avg': {'precision': 0.5023166018114172, 'recall': 0.42793793426673093, 'f1-score': 0.33383258775154895, 'support': 1196989}}
[[ 60847 268549     32]
 [ 99005 450903     82]
 [ 68718 248366    487]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1667157
{'0': {'precision': 0.3265141896604138, 'recall': 0.10076543986578589, 'f1-score': 0.1540038123513436, 'support': 181203}, '1': {'precision': 0.334542586387024, 'recall': 0.8079245198948447, 'f1-score': 0.4731605085257157, 'support': 179544}, '2': {'precision': 0.3527772766452182, 'recall': 0.09850443854876806, 'f1-score': 0.1540063618742589, 'support': 178662}, 'accuracy': 0.33539670268757105, 'macro avg': {'precision': 0.3379446842308853, 'recall': 0.3357314661031329, 'f1-score': 0.2603902275837727, 'support': 539409}, 'weighted avg': {'precision': 0.33788527562442555, 'recall': 0.33539670268757105, 'f1-score': 0.2602369774650042, 'support': 539409}}
[[ 18259 145037  17907]
 [ 20105 145058  14381]
 [ 17557 143506  17599]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1642148
{'0': {'precision': 0.2312458872559772, 'recall': 0.06289805354612574, 'f1-score': 0.09889658892367585, 'support': 67045}, '1': {'precision': 0.32934445660102113, 'recall': 0.8203017443263267, 'f1-score': 0.469991258208136, 'support': 70457}, '2': {'precision': 0.34100678192759576, 'recall': 0.053530461381595715, 'f1-score': 0.09253499222395022, 'support': 66691}, 'accuracy': 0.32118143129294346, 'macro avg': {'precision': 0.30053237526153137, 'recall': 0.3122434197513494, 'f1-score': 0.22047427978525402, 'support': 204193}, 'weighted avg': {'precision': 0.30094364735004836, 'recall': 0.32118143129294346, 'f1-score': 0.22486543148083404, 'support': 204193}}
[[ 4217 59171  3657]
 [ 9419 57796  3242]
 [ 4600 58521  3570]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
4274/4274 - 59s - 59s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1410614
{'0': {'precision': 0.28667845363979466, 'recall': 0.09737548722390646, 'f1-score': 0.14537256947288113, 'support': 346350}, '1': {'precision': 0.3591977524582488, 'recall': 0.8680696654529361, 'f1-score': 0.508134850248984, 'support': 397672}, '2': {'precision': 0.47381432567822523, 'recall': 0.020806015260982223, 'f1-score': 0.039861636390505016, 'support': 350043}, 'accuracy': 0.3530101045184701, 'macro avg': {'precision': 0.37323017725875623, 'recall': 0.32875038931260825, 'f1-score': 0.23112301870412336, 'support': 1094065}, 'weighted avg': {'precision': 0.372911444052321, 'recall': 0.3530101045184701, 'f1-score': 0.24347189462434848, 'support': 1094065}}
[[ 33726 308178   4446]
 [ 48823 345207   3642]
 [ 35095 307665   7283]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1637679
{'0': {'precision': 0.3309581976112921, 'recall': 0.08834024670784502, 'f1-score': 0.1394564145089573, 'support': 165621}, '1': {'precision': 0.3279258511080744, 'recall': 0.8263098325019312, 'f1-score': 0.4695199757725065, 'support': 166987}, '2': {'precision': 0.3281309190090158, 'recall': 0.07555299699951155, 'f1-score': 0.12282517760163351, 'support': 171972}, 'accuracy': 0.32820761821713107, 'macro avg': {'precision': 0.3290049892427941, 'recall': 0.3300676920697626, 'f1-score': 0.24393385596103243, 'support': 504580}, 'weighted avg': {'precision': 0.3289910661329864, 'recall': 0.32820761821713107, 'f1-score': 0.24302020386107193, 'support': 504580}}
[[ 14631 138533  12457]
 [ 14857 137983  14147]
 [ 14720 144259  12993]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1679801
{'0': {'precision': 0.28312435109016854, 'recall': 0.058834268264347594, 'f1-score': 0.09742356578495362, 'support': 60254}, '1': {'precision': 0.33617448938701, 'recall': 0.8433894518471236, 'f1-score': 0.4807302231237322, 'support': 62665}, '2': {'precision': 0.30553539019963705, 'recall': 0.05821734243969914, 'f1-score': 0.09779972405780264, 'support': 57835}, 'accuracy': 0.33063168726556535, 'macro avg': {'precision': 0.3082780768922719, 'recall': 0.3201470208503901, 'f1-score': 0.22531783765549618, 'support': 180754}, 'weighted avg': {'precision': 0.3086868800702613, 'recall': 0.33063168726556535, 'f1-score': 0.23043122700321042, 'support': 180754}}
[[ 3545 53514  3195]
 [ 5356 52851  4458]
 [ 3620 50848  3367]]
testing model on single stock: results/universal/W4/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
12724/12724 - 171s - 171s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057891
{'0': {'precision': 0.283914636418207, 'recall': 0.07343324877961031, 'f1-score': 0.11668614810315464, 'support': 933923}, '1': {'precision': 0.41582040713985563, 'recall': 0.9250673277700304, 'f1-score': 0.5737421006255433, 'support': 1355310}, '2': {'precision': 0.27114967462039047, 'recall': 0.0001291437049159326, 'f1-score': 0.000258164450755131, 'support': 967914}, 'accuracy': 0.40601759760919603, 'macro avg': {'precision': 0.32362823939281776, 'recall': 0.33287657341818555, 'f1-score': 0.230228804393151, 'support': 3257147}, 'weighted avg': {'precision': 0.335007763281436, 'recall': 0.40601759760919603, 'f1-score': 0.2722702306281957, 'support': 3257147}}
[[  68581  865202     140]
 [ 101361 1253753     196]
 [  71613  896176     125]]
Evaluating performance on  train set...
5165/5165 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1577226
{'0': {'precision': 0.3324059954113946, 'recall': 0.10984673077097691, 'f1-score': 0.165126000238863, 'support': 440532}, '1': {'precision': 0.32430074057234787, 'recall': 0.8518623996913226, 'f1-score': 0.46976409586122864, 'support': 435406}, '2': {'precision': 0.28183092582434327, 'recall': 0.020727804125837135, 'f1-score': 0.03861555228006296, 'support': 446164}, 'accuracy': 0.32413913601219874, 'macro avg': {'precision': 0.31284588726936186, 'recall': 0.3274789781960456, 'f1-score': 0.22450188279338487, 'support': 1322102}, 'weighted avg': {'precision': 0.31266935486801206, 'recall': 0.32413913601219874, 'f1-score': 0.22275910809246408, 'support': 1322102}}
[[ 48391 384016   8125]
 [ 49059 370906  15441]
 [ 48128 388788   9248]]
Evaluating performance on  val set...
1903/1903 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1742462
{'0': {'precision': 0.269437124386221, 'recall': 0.08759591975099387, 'f1-score': 0.13220957058867305, 'support': 162245}, '1': {'precision': 0.3223451241341739, 'recall': 0.8065945301184289, 'f1-score': 0.46061242150113124, 'support': 164318}, '2': {'precision': 0.355382282867663, 'recall': 0.05113533661187881, 'f1-score': 0.08940617473654384, 'support': 160437}, 'accuracy': 0.3181806981519507, 'macro avg': {'precision': 0.315721510462686, 'recall': 0.3151085954937672, 'f1-score': 0.22740938894211607, 'support': 487000}, 'weighted avg': {'precision': 0.31560246338800996, 'recall': 0.3181806981519507, 'f1-score': 0.2289143985884785, 'support': 487000}}
[[ 14212 139927   8106]
 [ 25005 132538   6775]
 [ 13530 138703   8204]]
training model: results/universal/W4/deepLOB_L2/h1000
Epoch 1/50
9854/9854 - 413s - loss: 3.1510 - accuracy1000: 0.4465 - val_loss: 3.5676 - val_accuracy1000: 0.3207 - 413s/epoch - 42ms/step
Epoch 2/50
9854/9854 - 403s - loss: 3.1141 - accuracy1000: 0.4620 - val_loss: 3.7270 - val_accuracy1000: 0.3368 - 403s/epoch - 41ms/step
Epoch 3/50
9854/9854 - 402s - loss: 3.0893 - accuracy1000: 0.4710 - val_loss: 3.7984 - val_accuracy1000: 0.3302 - 402s/epoch - 41ms/step
Epoch 4/50
9854/9854 - 403s - loss: 3.0726 - accuracy1000: 0.4766 - val_loss: 3.6862 - val_accuracy1000: 0.3064 - 403s/epoch - 41ms/step
Epoch 5/50
9854/9854 - 405s - loss: 3.0613 - accuracy1000: 0.4791 - val_loss: 3.7032 - val_accuracy1000: 0.3266 - 405s/epoch - 41ms/step
Epoch 6/50
9854/9854 - 403s - loss: 3.0456 - accuracy1000: 0.4844 - val_loss: 3.9043 - val_accuracy1000: 0.3408 - 403s/epoch - 41ms/step
Epoch 7/50
9854/9854 - 402s - loss: 3.0348 - accuracy1000: 0.4880 - val_loss: 3.8280 - val_accuracy1000: 0.3400 - 402s/epoch - 41ms/step
Epoch 8/50
9854/9854 - 402s - loss: 3.0248 - accuracy1000: 0.4911 - val_loss: 3.8437 - val_accuracy1000: 0.3412 - 402s/epoch - 41ms/step
Epoch 9/50
9854/9854 - 403s - loss: 3.0180 - accuracy1000: 0.4926 - val_loss: 3.8929 - val_accuracy1000: 0.3385 - 403s/epoch - 41ms/step
Epoch 10/50
9854/9854 - 402s - loss: 3.0104 - accuracy1000: 0.4951 - val_loss: 4.0965 - val_accuracy1000: 0.3442 - 402s/epoch - 41ms/step
Epoch 11/50
9854/9854 - 403s - loss: 3.0030 - accuracy1000: 0.4972 - val_loss: 4.1802 - val_accuracy1000: 0.3419 - 403s/epoch - 41ms/step
testing model in sample: results/universal/W4/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 322s - 322s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.147923
{'0': {'precision': 0.3002410142564449, 'recall': 0.33590317155903876, 'f1-score': 0.3170724850422351, 'support': 1880274}, '1': {'precision': 0.39052303634543767, 'recall': 0.5964340672701092, 'f1-score': 0.47199871620947925, 'support': 2265999}, '2': {'precision': 0.3867878216742339, 'recall': 0.10189793274809153, 'f1-score': 0.16130152796179542, 'support': 1925358}, 'accuracy': 0.3589313975108171, 'macro avg': {'precision': 0.3591839574253722, 'recall': 0.34474505719241316, 'f1-score': 0.3167909097378366, 'support': 6071631}, 'weighted avg': {'precision': 0.3613798680187923, 'recall': 0.3589313975108171, 'f1-score': 0.325496552070726, 'support': 6071631}}
[[ 631590 1056848  191836]
 [ 795277 1351519  119203]
 [ 676743 1052425  196190]]
Evaluating performance on  train set...
9854/9854 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1727715
{'0': {'precision': 0.33400381518750716, 'recall': 0.2900699221030746, 'f1-score': 0.31049042721840575, 'support': 842652}, '1': {'precision': 0.32119068076755003, 'recall': 0.44191711820260604, 'f1-score': 0.3720042180931241, 'support': 836589}, '2': {'precision': 0.3301667167317513, 'recall': 0.2504004613314538, 'f1-score': 0.28480389973723735, 'support': 842778}, 'accuracy': 0.32718349861757584, 'macro avg': {'precision': 0.32845373756226953, 'recall': 0.32746250054571147, 'f1-score': 0.3224328483495891, 'support': 2522019}, 'weighted avg': {'precision': 0.32847128372219997, 'recall': 0.32718349861757584, 'f1-score': 0.32231179753185923, 'support': 2522019}}
[[244428 391383 206841]
 [245591 369703 221295]
 [241793 389953 211032]]
Evaluating performance on  val set...
3566/3566 - 48s - 48s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.189256
{'0': {'precision': 0.27381723402574837, 'recall': 0.1667366719998974, 'f1-score': 0.2072635094739695, 'support': 311881}, '1': {'precision': 0.3064679192423643, 'recall': 0.33718966730324657, 'f1-score': 0.3210956194365568, 'support': 298470}, '2': {'precision': 0.35430037533593706, 'recall': 0.4622865487200373, 'f1-score': 0.40115336873319074, 'support': 302001}, 'accuracy': 0.3203303111079934, 'macro avg': {'precision': 0.3115285095346832, 'recall': 0.3220709626743938, 'f1-score': 0.3098374992145723, 'support': 912352}, 'weighted avg': {'precision': 0.3111397139188397, 'recall': 0.3203303111079934, 'f1-score': 0.30868313835260136, 'support': 912352}}
[[ 52002 116780 143099]
 [ 86492 100641 111337]
 [ 51421 110969 139611]]
testing model out of sample: results/universal/W4/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 163s - 163s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1666806
{'0': {'precision': 0.3430980520804703, 'recall': 0.30305634876893395, 'f1-score': 0.3218365232723207, 'support': 1021513}, '1': {'precision': 0.3283916935612754, 'recall': 0.41295612112622665, 'f1-score': 0.36585083896227727, 'support': 1049913}, '2': {'precision': 0.3096274854184254, 'recall': 0.26088921659293324, 'f1-score': 0.28317653741483145, 'support': 960216}, 'accuracy': 0.32776099552651666, 'macro avg': {'precision': 0.327039077020057, 'recall': 0.32563389549603133, 'f1-score': 0.32362129988314314, 'support': 3031642}, 'weighted avg': {'precision': 0.3274037944372771, 'recall': 0.32776099552651666, 'f1-score': 0.3248346560494938, 'support': 3031642}}
[[309576 455135 256802]
 [314588 433568 301757]
 [278132 431574 250510]]
Evaluating performance on  train set...
5528/5528 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1666174
{'0': {'precision': 0.33308567222631136, 'recall': 0.31264080643934866, 'f1-score': 0.3225395786569424, 'support': 460295}, '1': {'precision': 0.32656478252674237, 'recall': 0.4714266885485668, 'f1-score': 0.38584711642522335, 'support': 470404}, '2': {'precision': 0.34311850997197957, 'recall': 0.21515611919010263, 'f1-score': 0.2644721546406815, 'support': 483765}, 'accuracy': 0.33210672028415006, 'macro avg': {'precision': 0.3342563215750111, 'recall': 0.33307453805933934, 'f1-score': 0.3242862832409491, 'support': 1414464}, 'weighted avg': {'precision': 0.3343484001245096, 'recall': 0.33210672028415006, 'f1-score': 0.32373376360411954, 'support': 1414464}}
[[143907 222386  94002]
 [143380 221761 105263]
 [144755 234925 104085]]
Evaluating performance on  val set...
1908/1908 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1913787
{'0': {'precision': 0.3074124695557451, 'recall': 0.17658066077552875, 'f1-score': 0.2243135020021296, 'support': 169407}, '1': {'precision': 0.32726905987886395, 'recall': 0.3666574599507859, 'f1-score': 0.34584538502757706, 'support': 159304}, '2': {'precision': 0.33870396684149157, 'recall': 0.45151221476847947, 'f1-score': 0.3870560532129245, 'support': 158906}, 'accuracy': 0.32827403474448186, 'macro avg': {'precision': 0.32446183209203355, 'recall': 0.3315834451649314, 'f1-score': 0.3190716467475437, 'support': 487617}, 'weighted avg': {'precision': 0.3240969594987187, 'recall': 0.32827403474448186, 'f1-score': 0.31705285058142124, 'support': 487617}}
[[29914 62128 77365]
 [38176 58410 62718]
 [29219 57939 71748]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.226347
{'0': {'precision': 0.40420245616525874, 'recall': 0.2060393334660129, 'f1-score': 0.2729462520222901, 'support': 55271}, '1': {'precision': 0.2805039162026989, 'recall': 0.31064663618549965, 'f1-score': 0.29480678873833105, 'support': 38275}, '2': {'precision': 0.30064152998850086, 'recall': 0.46093532522965575, 'f1-score': 0.36391941391941396, 'support': 43108}, 'accuracy': 0.31574633746542363, 'macro avg': {'precision': 0.3284493007854861, 'recall': 0.32587376496038944, 'f1-score': 0.31055748489334506, 'support': 136654}, 'weighted avg': {'precision': 0.33688744143685956, 'recall': 0.31574633746542363, 'f1-score': 0.3077669166634106, 'support': 136654}}
[[11388 16563 27320]
 [ 7483 11890 18902]
 [ 9303 13935 19870]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1677547
{'0': {'precision': 0.3220840999865368, 'recall': 0.33606480614347256, 'f1-score': 0.32892596072320623, 'support': 21356}, '1': {'precision': 0.3327895063138317, 'recall': 0.47627720183057815, 'f1-score': 0.39180960795989317, 'support': 21414}, '2': {'precision': 0.3741462602032317, 'recall': 0.20265271135974014, 'f1-score': 0.26290530258691325, 'support': 22166}, 'accuracy': 0.33676235062215104, 'macro avg': {'precision': 0.34300662216786676, 'recall': 0.33833157311126355, 'f1-score': 0.32788029042333755, 'support': 64936}, 'weighted avg': {'precision': 0.34338592662285494, 'recall': 0.33676235062215104, 'f1-score': 0.3271269049402406, 'support': 64936}}
[[ 7177 10031  4148]
 [ 7849 10199  3366]
 [ 7257 10417  4492]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2038577
{'0': {'precision': 0.25869809203142535, 'recall': 0.06202071841786627, 'f1-score': 0.10005425935973956, 'support': 7433}, '1': {'precision': 0.28529900332225916, 'recall': 0.4976457805143064, 'f1-score': 0.3626765210505477, 'support': 5522}, '2': {'precision': 0.3710746495707921, 'recall': 0.445706081962934, 'f1-score': 0.40498072932107915, 'support': 7662}, 'accuracy': 0.3212882572634234, 'macro avg': {'precision': 0.30502391497482556, 'recall': 0.3351241936317022, 'f1-score': 0.28923716991045545, 'support': 20617}, 'weighted avg': {'precision': 0.30758587473572824, 'recall': 0.3212882572634234, 'f1-score': 0.2837156427763582, 'support': 20617}}
[[ 461 3364 3608]
 [ 594 2748 2180]
 [ 727 3520 3415]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
1613/1613 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2151017
{'0': {'precision': 0.3415065046308689, 'recall': 0.12034638023846657, 'f1-score': 0.17797473181029794, 'support': 159016}, '1': {'precision': 0.2533316466077185, 'recall': 0.5750356463878327, 'f1-score': 0.351715304042903, 'support': 100992}, '2': {'precision': 0.3449294902446481, 'recall': 0.28790049790304956, 'f1-score': 0.3138453418541289, 'support': 152841}, 'accuracy': 0.29360371467534135, 'macro avg': {'precision': 0.31325588049441183, 'recall': 0.32776084150978296, 'f1-score': 0.2811784592357766, 'support': 412849}, 'weighted avg': {'precision': 0.32120420834995655, 'recall': 0.29360371467534135, 'f1-score': 0.2707762349764057, 'support': 412849}}
[[19137 85425 54454]
 [13804 58074 29114]
 [23096 85742 44003]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1840935
{'0': {'precision': 0.3342608559335319, 'recall': 0.1551122103808242, 'f1-score': 0.21189535663710218, 'support': 54986}, '1': {'precision': 0.3437585922463569, 'recall': 0.3715315181456855, 'f1-score': 0.35710587857257625, 'support': 53842}, '2': {'precision': 0.34401998012181756, 'recall': 0.5059784849507103, 'f1-score': 0.4095694650929943, 'support': 53358}, 'accuracy': 0.34239083521389024, 'macro avg': {'precision': 0.34067980943390214, 'recall': 0.34420740449240667, 'f1-score': 0.32619023343422426, 'support': 162186}, 'weighted avg': {'precision': 0.34062456468147356, 'recall': 0.34239083521389024, 'f1-score': 0.325135217050697, 'support': 162186}}
[[ 8529 19171 27286]
 [ 9644 20004 24194]
 [ 7343 19017 26998]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.212195
{'0': {'precision': 0.3935969868173258, 'recall': 0.010509906466861108, 'f1-score': 0.020473135132487632, 'support': 19886}, '1': {'precision': 0.25812619502868067, 'recall': 0.3723597299847572, 'f1-score': 0.3048943567798877, 'support': 13777}, '2': {'precision': 0.35560711523588556, 'recall': 0.6028740756280485, 'f1-score': 0.4473458904109589, 'support': 19067}, 'accuracy': 0.31924900436184334, 'macro avg': {'precision': 0.33577676569396403, 'recall': 0.3285812373598889, 'f1-score': 0.2575711274411114, 'support': 52730}, 'weighted avg': {'precision': 0.3444649181673071, 'recall': 0.31924900436184334, 'f1-score': 0.24914095222960203, 'support': 52730}}
[[  209  7351 12326]
 [  143  5130  8504]
 [  179  7393 11495]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
989/989 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1516465
{'0': {'precision': 0.33901486482395327, 'recall': 0.38246712586098935, 'f1-score': 0.3594325087734315, 'support': 87835}, '1': {'precision': 0.3552211707746479, 'recall': 0.4187456762365963, 'f1-score': 0.38437648833148114, 'support': 92512}, '2': {'precision': 0.2895582329317269, 'recall': 0.17870617719148468, 'f1-score': 0.2210112225609237, 'support': 72622}, 'accuracy': 0.33723895022710293, 'macro avg': {'precision': 0.3279314228434427, 'recall': 0.32663965976302345, 'f1-score': 0.32160673988861216, 'support': 252969}, 'weighted avg': {'precision': 0.3307436468282044, 'recall': 0.33723895022710293, 'f1-score': 0.3288168475246206, 'support': 252969}}
[[33594 39349 14892]
 [36823 38739 16950]
 [28676 30968 12978]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1460886
{'0': {'precision': 0.3414581302134113, 'recall': 0.33698015038665763, 'f1-score': 0.3392043620188686, 'support': 28061}, '1': {'precision': 0.32529436501261566, 'recall': 0.5396609460025115, 'f1-score': 0.4059138374350632, 'support': 28668}, '2': {'precision': 0.4064133227035167, 'recall': 0.15389259718914566, 'f1-score': 0.2232494769110992, 'support': 29813}, 'accuracy': 0.3410482771371126, 'macro avg': {'precision': 0.35772193930984786, 'recall': 0.34351123119277155, 'f1-score': 0.3227892254550103, 'support': 86542}, 'weighted avg': {'precision': 0.3584802273793088, 'recall': 0.3410482771371126, 'f1-score': 0.3213571231234599, 'support': 86542}}
[[ 9456 15173  3432]
 [ 9928 15471  3269]
 [ 8309 16916  4588]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.200158
{'0': {'precision': 0.34101288947528674, 'recall': 0.31413612565445026, 'f1-score': 0.3270232128084092, 'support': 10696}, '1': {'precision': 0.28661065617356163, 'recall': 0.2949223024731889, 'f1-score': 0.290707081602934, 'support': 9138}, '2': {'precision': 0.37561094819159335, 'recall': 0.39416994358009916, 'f1-score': 0.38466672228247273, 'support': 11698}, 'accuracy': 0.3382595458581758, 'macro avg': {'precision': 0.33441149794681396, 'recall': 0.3344094572359128, 'f1-score': 0.33413233889793864, 'support': 31532}, 'weighted avg': {'precision': 0.3380825483282675, 'recall': 0.3382595458581758, 'f1-score': 0.33788382954289997, 'support': 31532}}
[[3360 3286 4050]
 [2828 2695 3615]
 [3665 3422 4611]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1643443
{'0': {'precision': 0.2949092769565297, 'recall': 0.45878874880964227, 'f1-score': 0.35903253972226395, 'support': 70357}, '1': {'precision': 0.39189445260315503, 'recall': 0.5631573572960278, 'f1-score': 0.4621702026621227, 'support': 88137}, '2': {'precision': 0.27474402730375425, 'recall': 0.002058823529411765, 'f1-score': 0.004087020536643567, 'support': 78200}, 'accuracy': 0.3467557268033833, 'macro avg': {'precision': 0.3205159189544797, 'recall': 0.34133497654502726, 'f1-score': 0.2750965876403434, 'support': 236694}, 'weighted avg': {'precision': 0.3243610581724438, 'recall': 0.3467557268033833, 'f1-score': 0.2801691321082763, 'support': 236694}}
[[32279 37907   171]
 [38248 49635   254]
 [38927 39112   161]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1940055
{'0': {'precision': 0.30680573964156055, 'recall': 0.3605824585167626, 'f1-score': 0.3315274923718787, 'support': 29530}, '1': {'precision': 0.312072707542051, 'recall': 0.3928620218579235, 'f1-score': 0.34783791956456, 'support': 29280}, '2': {'precision': 0.31304398964949426, 'recall': 0.17886424731182796, 'f1-score': 0.22765375074843897, 'support': 29760}, 'accuracy': 0.3101953257310602, 'macro avg': {'precision': 0.31064081227770196, 'recall': 0.3107695758955047, 'f1-score': 0.30233972089495925, 'support': 88570}, 'weighted avg': {'precision': 0.3106430111822907, 'recall': 0.3101953257310602, 'f1-score': 0.30201735076058983, 'support': 88570}}
[[10648 12584  6298]
 [12394 11503  5383]
 [11664 12773  5323]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1834114
{'0': {'precision': 0.3883369330453564, 'recall': 0.1690803084446116, 'f1-score': 0.23558700209643607, 'support': 10634}, '1': {'precision': 0.2651738923296808, 'recall': 0.2843277482631794, 'f1-score': 0.27441699945767395, 'support': 9788}, '2': {'precision': 0.352268750729033, 'recall': 0.5097476580302135, 'f1-score': 0.4166235557854802, 'support': 11849}, 'accuracy': 0.3291190232716681, 'macro avg': {'precision': 0.3352598587013567, 'recall': 0.32105190491266816, 'f1-score': 0.3088758524465301, 'support': 32271}, 'weighted avg': {'precision': 0.33773757960755935, 'recall': 0.3291190232716681, 'f1-score': 0.3138358985927727, 'support': 32271}}
[[1798 3530 5306]
 [1205 2783 5800]
 [1627 4182 6040]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
1590/1590 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1687549
{'0': {'precision': 0.38564268173714134, 'recall': 0.17004108634064583, 'f1-score': 0.23601589360344224, 'support': 134838}, '1': {'precision': 0.3534534611397638, 'recall': 0.3949421211059552, 'f1-score': 0.3730477917464434, 'support': 139861}, '2': {'precision': 0.3312297726167633, 'recall': 0.4788655741670194, 'f1-score': 0.39159473233629727, 'support': 132296}, 'accuracy': 0.34771188835243677, 'macro avg': {'precision': 0.35677530516455613, 'recall': 0.3479495938712068, 'f1-score': 0.3335528058953943, 'support': 406995}, 'weighted avg': {'precision': 0.35689385974434196, 'recall': 0.34771188835243677, 'f1-score': 0.33367772324552647, 'support': 406995}}
[[22928 50101 61809]
 [18522 55237 66102]
 [18004 50940 63352]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1763364
{'0': {'precision': 0.32653425916470946, 'recall': 0.28375260659301654, 'f1-score': 0.30364391691394654, 'support': 45078}, '1': {'precision': 0.31876084800396726, 'recall': 0.4591192160889266, 'f1-score': 0.37627710854393626, 'support': 44801}, '2': {'precision': 0.34225323088698517, 'recall': 0.2432726511822557, 'f1-score': 0.2843968248143935, 'support': 47790}, 'accuracy': 0.32676927993956517, 'macro avg': {'precision': 0.32918277935188733, 'recall': 0.3287148246213996, 'f1-score': 0.32143928342409206, 'support': 137669}, 'weighted avg': {'precision': 0.32946122939907696, 'recall': 0.32676927993956517, 'f1-score': 0.32059923065035434, 'support': 137669}}
[[12791 21314 10973]
 [12862 20569 11370]
 [13519 22645 11626]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1861151
{'0': {'precision': 0.3806545292080867, 'recall': 0.17212121212121212, 'f1-score': 0.23705352484958087, 'support': 19800}, '1': {'precision': 0.3036365646070521, 'recall': 0.3198090692124105, 'f1-score': 0.31151305531142803, 'support': 17179}, '2': {'precision': 0.3265645679712611, 'recall': 0.5229818930539575, 'f1-score': 0.40206713534149635, 'support': 16513}, 'accuracy': 0.3278621102220893, 'macro avg': {'precision': 0.33695188726213327, 'recall': 0.3383040581291934, 'f1-score': 0.31687790516750175, 'support': 53492}, 'weighted avg': {'precision': 0.33922255538424617, 'recall': 0.3278621102220893, 'f1-score': 0.31190602660418104, 'support': 53492}}
[[3408 6636 9756]
 [3632 5494 8053]
 [1913 5964 8636]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
3782/3782 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2185063
{'0': {'precision': 0.366404395394557, 'recall': 0.24000432091921872, 'f1-score': 0.2900309172105806, 'support': 351777}, '1': {'precision': 0.21351468106286442, 'recall': 0.3754192948769361, 'f1-score': 0.2722122828202664, 'support': 211963}, '2': {'precision': 0.4058184728564459, 'recall': 0.36628798749171226, 'f1-score': 0.38504128470190496, 'support': 404212}, 'accuracy': 0.3223930525480602, 'macro avg': {'precision': 0.3285791831046224, 'recall': 0.32723720109595567, 'f1-score': 0.3157614949109173, 'support': 967952}, 'weighted avg': {'precision': 0.3493835932888084, 'recall': 0.3223930525480602, 'f1-score': 0.32580483932978593, 'support': 967952}}
[[ 84428 133703 133646]
 [ 49254  79575  83134]
 [ 96741 159413 148058]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1901894
{'0': {'precision': 0.29934782608695654, 'recall': 0.11931892032407608, 'f1-score': 0.17062668442737214, 'support': 138486}, '1': {'precision': 0.326856532757046, 'recall': 0.3781738353921715, 'f1-score': 0.35064755845965956, 'support': 134380}, '2': {'precision': 0.3444246862975577, 'recall': 0.5008985579241121, 'f1-score': 0.40817954518395044, 'support': 136886}, 'accuracy': 0.3316859954313829, 'macro avg': {'precision': 0.32354301504718674, 'recall': 0.33279710454678657, 'f1-score': 0.30981792935699404, 'support': 409752}, 'weighted avg': {'precision': 0.32342827252557055, 'recall': 0.3316859954313829, 'f1-score': 0.30902470554742467, 'support': 409752}}
[[16524 52912 69050]
 [22103 50819 61458]
 [16573 51747 68566]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2101114
{'0': {'precision': 0.280735865988633, 'recall': 0.11264478185200744, 'f1-score': 0.1607777635016489, 'support': 49989}, '1': {'precision': 0.27314118809329496, 'recall': 0.31537965580518773, 'f1-score': 0.29274468281005434, 'support': 40326}, '2': {'precision': 0.34870142943426613, 'recall': 0.5289357153763934, 'f1-score': 0.4203118364375418, 'support': 45843}, 'accuracy': 0.31284977746441633, 'macro avg': {'precision': 0.300859494505398, 'recall': 0.31898671767786285, 'f1-score': 0.2912780942497483, 'support': 136158}, 'weighted avg': {'precision': 0.3013698525647487, 'recall': 0.31284977746441633, 'f1-score': 0.28724494496458824, 'support': 136158}}
[[ 5631 17855 26503]
 [ 8821 12718 18787]
 [ 5606 15989 24248]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
4457/4457 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1534812
{'0': {'precision': 0.33636189865456473, 'recall': 0.3079626383490418, 'f1-score': 0.3215364053384574, 'support': 354267}, '1': {'precision': 0.3880562768231551, 'recall': 0.35248680354400874, 'f1-score': 0.36941731072489287, 'support': 470202}, '2': {'precision': 0.2677458279845956, 'recall': 0.32951120098581316, 'f1-score': 0.29543477952945507, 'support': 316490}, 'accuracy': 0.33228889031069475, 'macro avg': {'precision': 0.33072133448743846, 'recall': 0.3299868809596212, 'f1-score': 0.3287961651976018, 'support': 1140959}, 'weighted avg': {'precision': 0.33863235692457183, 'recall': 0.33228889031069475, 'f1-score': 0.3340283475749633, 'support': 1140959}}
[[109101 137033 108133]
 [127382 165740 177080]
 [ 87873 124330 104287]]
Evaluating performance on  train set...
2425/2425 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.162939
{'0': {'precision': 0.33387503742034813, 'recall': 0.3444197172604459, 'f1-score': 0.33906541424679876, 'support': 204004}, '1': {'precision': 0.3284902860779193, 'recall': 0.5088274906308557, 'f1-score': 0.3992388376576263, 'support': 204928}, '2': {'precision': 0.35445137251101133, 'recall': 0.15539765350204196, 'f1-score': 0.21606753669616363, 'support': 211805}, 'accuracy': 0.334199508004195, 'macro avg': {'precision': 0.3389388986697595, 'recall': 0.3362149537977812, 'f1-score': 0.3181239295335296, 'support': 620737}, 'weighted avg': {'precision': 0.33911829556474204, 'recall': 0.334199508004195, 'f1-score': 0.3169620981211639, 'support': 620737}}
[[ 70263 104430  29311]
 [ 70021 104273  30634]
 [ 70163 108728  32914]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.184016
{'0': {'precision': 0.27832655432887854, 'recall': 0.19040117776959883, 'f1-score': 0.2261172109937758, 'support': 67925}, '1': {'precision': 0.34681675683540786, 'recall': 0.372624817020309, 'f1-score': 0.35925788903961303, 'support': 70363}, '2': {'precision': 0.3321794936580929, 'recall': 0.4178027775129501, 'f1-score': 0.37010345555633756, 'support': 62934}, 'accuracy': 0.32524276669549057, 'macro avg': {'precision': 0.3191076016074597, 'recall': 0.32694292410095266, 'f1-score': 0.31849285186324217, 'support': 201222}, 'weighted avg': {'precision': 0.31911909690728296, 'recall': 0.32524276669549057, 'f1-score': 0.3177066388129979, 'support': 201222}}
[[12933 26203 28789]
 [20071 26219 24073]
 [13463 23177 26294]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1662533
{'0': {'precision': 0.3251225350507238, 'recall': 0.49157245277816075, 'f1-score': 0.3913854851324835, 'support': 406168}, '1': {'precision': 0.34727149127650175, 'recall': 0.4917000740214149, 'f1-score': 0.4070541244280406, 'support': 409341}, '2': {'precision': 0.382701062215478, 'recall': 0.0033055468176575445, 'f1-score': 0.0065544798908453, 'support': 381480}, 'accuracy': 0.3360055940363696, 'macro avg': {'precision': 0.35169836284756784, 'recall': 0.32885935787241105, 'f1-score': 0.2683313631504565, 'support': 1196989}, 'weighted avg': {'precision': 0.35104719470359164, 'recall': 0.3360055940363696, 'f1-score': 0.27409826244146673, 'support': 1196989}}
[[199661 205555    952]
 [206986 201273   1082]
 [207463 172756   1261]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1761359
{'0': {'precision': 0.34948471661034974, 'recall': 0.29833409920109843, 'f1-score': 0.32189002717959436, 'support': 180623}, '1': {'precision': 0.3390052356020942, 'recall': 0.38793165160601106, 'f1-score': 0.3618219497851862, 'support': 181599}, '2': {'precision': 0.3291622983530048, 'recall': 0.32958399882609896, 'f1-score': 0.3293730136124827, 'support': 177187}, 'accuracy': 0.33876335025926524, 'macro avg': {'precision': 0.3392174168551496, 'recall': 0.33861658321106947, 'f1-score': 0.3376949968590878, 'support': 539409}, 'weighted avg': {'precision': 0.33928108338327645, 'recall': 0.33876335025926524, 'f1-score': 0.33779166235872016, 'support': 539409}}
[[53886 69711 57026]
 [49161 70448 61990]
 [51140 67649 58398]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1858045
{'0': {'precision': 0.3258313892319656, 'recall': 0.1989859343790594, 'f1-score': 0.24707973810865888, 'support': 71593}, '1': {'precision': 0.2866027302795408, 'recall': 0.365902569453502, 'f1-score': 0.32143394226706673, 'support': 61336}, '2': {'precision': 0.37291271116303976, 'recall': 0.42995060619667713, 'f1-score': 0.3994055843783403, 'support': 71264}, 'accuracy': 0.32973216515747356, 'macro avg': {'precision': 0.32844894355818205, 'recall': 0.33161303667641284, 'f1-score': 0.32263975491802194, 'support': 204193}, 'weighted avg': {'precision': 0.3304793169307121, 'recall': 0.32973216515747356, 'f1-score': 0.3225766384667646, 'support': 204193}}
[[14246 28288 29059]
 [16428 22443 22465]
 [13048 27576 30640]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
4274/4274 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1752347
{'0': {'precision': 0.3393176450094017, 'recall': 0.34023457367288124, 'f1-score': 0.33977549072924473, 'support': 389302}, '1': {'precision': 0.2774078672688325, 'recall': 0.5262745783222191, 'f1-score': 0.36330943688288136, 'support': 309063}, '2': {'precision': 0.4236558956578039, 'recall': 0.12567601718473592, 'f1-score': 0.19384777901431155, 'support': 395700}, 'accuracy': 0.3151878544693414, 'macro avg': {'precision': 0.3467938026453461, 'recall': 0.33072838972661206, 'f1-score': 0.2989775688754792, 'support': 1094065}, 'weighted avg': {'precision': 0.3523320675014284, 'recall': 0.3151878544693414, 'f1-score': 0.2936446634698793, 'support': 1094065}}
[[132454 211793  45055]
 [123813 162652  22598]
 [134087 211883  49730]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1720539
{'0': {'precision': 0.3345127436281859, 'recall': 0.27580409898885017, 'f1-score': 0.3023347199826556, 'support': 161796}, '1': {'precision': 0.3264518972927304, 'recall': 0.4167580146899345, 'f1-score': 0.3661184879640143, 'support': 170593}, '2': {'precision': 0.32989778090693367, 'recall': 0.29388876305962564, 'f1-score': 0.3108539345858403, 'support': 172191}, 'accuracy': 0.32963058385191646, 'macro avg': {'precision': 0.33028747394261665, 'recall': 0.32881695891280344, 'f1-score': 0.3264357141775034, 'support': 504580}, 'weighted avg': {'precision': 0.33021257516166025, 'recall': 0.32963058385191646, 'f1-score': 0.3268065508379826, 'support': 504580}}
[[44624 70999 46173]
 [42879 71096 56618]
 [45897 75689 50605]]
Evaluating performance on  val set...
707/707 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1959027
{'0': {'precision': 0.32783347719274947, 'recall': 0.15538212200840243, 'f1-score': 0.21083533493461437, 'support': 63553}, '1': {'precision': 0.32954859299720746, 'recall': 0.37613393576407134, 'f1-score': 0.3513036082305604, 'support': 57102}, '2': {'precision': 0.3448711647827003, 'recall': 0.49039085508910296, 'f1-score': 0.4049547599909314, 'support': 60099}, 'accuracy': 0.33650707591533247, 'macro avg': {'precision': 0.33408441165755237, 'recall': 0.34063563762052557, 'f1-score': 0.3223645677187021, 'support': 180754}, 'weighted avg': {'precision': 0.33404016987526064, 'recall': 0.33650707591533247, 'f1-score': 0.3197535479102869, 'support': 180754}}
[[ 9875 22465 31213]
 [10851 21478 24773]
 [ 9396 21231 29472]]
testing model on single stock: results/universal/W4/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
12724/12724 - 180s - 180s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110533
{'0': {'precision': 0.2706488407154776, 'recall': 0.33130747763607615, 'f1-score': 0.2979218990113009, 'support': 892956}, '1': {'precision': 0.4473466459826732, 'recall': 0.6615048716444325, 'f1-score': 0.5337450162211004, 'support': 1455566}, '2': {'precision': 0.2750642673521851, 'recall': 0.0035328105654147753, 'f1-score': 0.006976023992306815, 'support': 908625}, 'accuracy': 0.3874301651107549, 'macro avg': {'precision': 0.3310199180167786, 'recall': 0.3321150532819745, 'f1-score': 0.279547646408236, 'support': 3257147}, 'weighted avg': {'precision': 0.35084395768420185, 'recall': 0.3874301651107549, 'f1-score': 0.3221441449631924, 'support': 3257147}}
[[295843 593995   3118]
 [487360 962864   5342]
 [309885 595530   3210]]
Evaluating performance on  train set...
5165/5165 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1629177
{'0': {'precision': 0.33476311340375575, 'recall': 0.3526935700993333, 'f1-score': 0.34349450790788055, 'support': 439027}, '1': {'precision': 0.31328380549487383, 'recall': 0.4956364517426764, 'f1-score': 0.38390650340290217, 'support': 437488}, '2': {'precision': 0.3098958333333333, 'recall': 0.1164396627370188, 'f1-score': 0.1692759183766686, 'support': 445587}, 'accuracy': 0.3203693814849384, 'macro avg': {'precision': 0.3193142507439876, 'recall': 0.32158989485967615, 'f1-score': 0.2988923098958171, 'support': 1322102}, 'weighted avg': {'precision': 0.3192745382535932, 'recall': 0.3203693814849384, 'f1-score': 0.2981502186107476, 'support': 1322102}}
[[154842 236745  47440]
 [152553 216835  68100]
 [155147 238556  51884]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1835511
{'0': {'precision': 0.24867991571292816, 'recall': 0.18834765519874327, 'f1-score': 0.21434930945817932, 'support': 159779}, '1': {'precision': 0.33030819337714573, 'recall': 0.3289945336896729, 'f1-score': 0.3296500548009382, 'support': 173243}, '2': {'precision': 0.34825338234305775, 'recall': 0.43748457571860916, 'f1-score': 0.3878022734010921, 'support': 153978}, 'accuracy': 0.31715195071868585, 'macro avg': {'precision': 0.30908049714437724, 'recall': 0.3182755882023418, 'f1-score': 0.3106005458867365, 'support': 487000}, 'weighted avg': {'precision': 0.30920075955719134, 'recall': 0.31715195071868585, 'f1-score': 0.3102076000278249, 'support': 487000}}
[[30094 59617 70068]
 [60247 56996 56000]
 [30674 55941 67363]]
training model: results/universal/W4/deepOF_L2/h300
Epoch 1/50
9854/9854 - 224s - loss: 3.2574 - accuracy300: 0.3890 - val_loss: 3.2916 - val_accuracy300: 0.3476 - 224s/epoch - 23ms/step
Epoch 2/50
9854/9854 - 217s - loss: 3.2442 - accuracy300: 0.3971 - val_loss: 3.2885 - val_accuracy300: 0.3474 - 217s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 218s - loss: 3.2378 - accuracy300: 0.4007 - val_loss: 3.2871 - val_accuracy300: 0.3514 - 218s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 217s - loss: 3.2331 - accuracy300: 0.4031 - val_loss: 3.2907 - val_accuracy300: 0.3540 - 217s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 218s - loss: 3.2299 - accuracy300: 0.4048 - val_loss: 3.2900 - val_accuracy300: 0.3565 - 218s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 219s - loss: 3.2277 - accuracy300: 0.4061 - val_loss: 3.2895 - val_accuracy300: 0.3577 - 219s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 218s - loss: 3.2260 - accuracy300: 0.4072 - val_loss: 3.2897 - val_accuracy300: 0.3583 - 218s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 220s - loss: 3.2241 - accuracy300: 0.4079 - val_loss: 3.2871 - val_accuracy300: 0.3627 - 220s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 218s - loss: 3.2224 - accuracy300: 0.4093 - val_loss: 3.2852 - val_accuracy300: 0.3661 - 218s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 218s - loss: 3.2211 - accuracy300: 0.4100 - val_loss: 3.2862 - val_accuracy300: 0.3652 - 218s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 219s - loss: 3.2196 - accuracy300: 0.4107 - val_loss: 3.2839 - val_accuracy300: 0.3676 - 219s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 218s - loss: 3.2182 - accuracy300: 0.4119 - val_loss: 3.2851 - val_accuracy300: 0.3688 - 218s/epoch - 22ms/step
Epoch 13/50
9854/9854 - 218s - loss: 3.2170 - accuracy300: 0.4121 - val_loss: 3.2801 - val_accuracy300: 0.3721 - 218s/epoch - 22ms/step
Epoch 14/50
9854/9854 - 218s - loss: 3.2156 - accuracy300: 0.4134 - val_loss: 3.2793 - val_accuracy300: 0.3737 - 218s/epoch - 22ms/step
Epoch 15/50
9854/9854 - 219s - loss: 3.2143 - accuracy300: 0.4139 - val_loss: 3.2791 - val_accuracy300: 0.3750 - 219s/epoch - 22ms/step
Epoch 16/50
9854/9854 - 220s - loss: 3.2129 - accuracy300: 0.4146 - val_loss: 3.2773 - val_accuracy300: 0.3764 - 220s/epoch - 22ms/step
Epoch 17/50
9854/9854 - 219s - loss: 3.2115 - accuracy300: 0.4155 - val_loss: 3.2754 - val_accuracy300: 0.3758 - 219s/epoch - 22ms/step
Epoch 18/50
9854/9854 - 220s - loss: 3.2098 - accuracy300: 0.4164 - val_loss: 3.2791 - val_accuracy300: 0.3756 - 220s/epoch - 22ms/step
Epoch 19/50
9854/9854 - 219s - loss: 3.2085 - accuracy300: 0.4173 - val_loss: 3.2763 - val_accuracy300: 0.3765 - 219s/epoch - 22ms/step
Epoch 20/50
9854/9854 - 219s - loss: 3.2073 - accuracy300: 0.4180 - val_loss: 3.2814 - val_accuracy300: 0.3751 - 219s/epoch - 22ms/step
Epoch 21/50
9854/9854 - 219s - loss: 3.2056 - accuracy300: 0.4188 - val_loss: 3.2816 - val_accuracy300: 0.3752 - 219s/epoch - 22ms/step
Epoch 22/50
9854/9854 - 218s - loss: 3.2045 - accuracy300: 0.4193 - val_loss: 3.2848 - val_accuracy300: 0.3748 - 218s/epoch - 22ms/step
Epoch 23/50
9854/9854 - 220s - loss: 3.2027 - accuracy300: 0.4202 - val_loss: 3.2829 - val_accuracy300: 0.3760 - 220s/epoch - 22ms/step
Epoch 24/50
9854/9854 - 218s - loss: 3.2006 - accuracy300: 0.4213 - val_loss: 3.2876 - val_accuracy300: 0.3750 - 218s/epoch - 22ms/step
Epoch 25/50
9854/9854 - 219s - loss: 3.2007 - accuracy300: 0.4209 - val_loss: 3.2823 - val_accuracy300: 0.3758 - 219s/epoch - 22ms/step
Epoch 26/50
9854/9854 - 221s - loss: 3.1983 - accuracy300: 0.4224 - val_loss: 3.2880 - val_accuracy300: 0.3757 - 221s/epoch - 22ms/step
Epoch 27/50
9854/9854 - 221s - loss: 3.1963 - accuracy300: 0.4236 - val_loss: 3.2877 - val_accuracy300: 0.3749 - 221s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 182s - 182s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0849202
{'0': {'precision': 0.37314477991337164, 'recall': 0.2797979786987451, 'f1-score': 0.3197987995262285, 'support': 1837826}, '1': {'precision': 0.3963968555977553, 'recall': 0.4159723502974602, 'f1-score': 0.40594874960041205, 'support': 2336951}, '2': {'precision': 0.36006625075518184, 'recall': 0.42543206205709094, 'f1-score': 0.39002942472914554, 'support': 1896834}, 'accuracy': 0.37770881566687986, 'macro avg': {'precision': 0.3765359620887696, 'recall': 0.37373413035109876, 'f1-score': 0.3719256579519287, 'support': 6071611}, 'weighted avg': {'precision': 0.378008589987082, 'recall': 0.37770881566687986, 'f1-score': 0.3748985168338695, 'support': 6071611}}
[[514220 732087 591519]
 [522155 972107 842689]
 [341696 748164 806974]]
Evaluating performance on  train set...
9854/9854 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0914029
{'0': {'precision': 0.4044355210929567, 'recall': 0.24748863176327707, 'f1-score': 0.30707005811406707, 'support': 849736}, '1': {'precision': 0.3484539686205723, 'recall': 0.406880901677282, 'f1-score': 0.37540770463690465, 'support': 823177}, '2': {'precision': 0.38547136075447697, 'recall': 0.47251033740391307, 'f1-score': 0.42457596268217623, 'support': 849101}, 'accuracy': 0.37527309523261965, 'macro avg': {'precision': 0.3794536168226686, 'recall': 0.375626623614824, 'f1-score': 0.36901790847771593, 'support': 2522014}, 'weighted avg': {'precision': 0.3797785549035845, 'recall': 0.37527309523261965, 'f1-score': 0.3689366298009871, 'support': 2522014}}
[[210300 316227 323209]
 [171833 334935 316409]
 [137851 310041 401209]]
Evaluating performance on  val set...
3566/3566 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925106
{'0': {'precision': 0.39472616429641283, 'recall': 0.25674627741031575, 'f1-score': 0.31112436011584543, 'support': 306910}, '1': {'precision': 0.3578074480038524, 'recall': 0.41439901204731283, 'f1-score': 0.3840295584839894, 'support': 301229}, '2': {'precision': 0.3837350556548028, 'recall': 0.4589658459616712, 'f1-score': 0.4179923958925845, 'support': 304210}, 'accuracy': 0.37622554526831287, 'macro avg': {'precision': 0.37875622265168934, 'recall': 0.3767037118064333, 'f1-score': 0.37104877149747306, 'support': 912349}, 'weighted avg': {'precision': 0.3788719318152506, 'recall': 0.37622554526831287, 'f1-score': 0.37082901827065184, 'support': 912349}}
[[ 78798 112414 115698]
 [ 67870 124829 108530]
 [ 52959 111629 139622]]
testing model out of sample: results/universal/W4/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 95s - 95s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0887499
{'0': {'precision': 0.37735080418516626, 'recall': 0.22815289801602562, 'f1-score': 0.28437044804365863, 'support': 962210}, '1': {'precision': 0.4017689132757471, 'recall': 0.47500721581010075, 'f1-score': 0.4353292170331805, 'support': 1150252}, '2': {'precision': 0.34680830371347676, 'recall': 0.4112385221289003, 'f1-score': 0.3762852885048993, 'support': 919160}, 'accuracy': 0.37732375606193647, 'macro avg': {'precision': 0.37530934039146335, 'recall': 0.3714662119850089, 'f1-score': 0.3653283178605795, 'support': 3031622}, 'weighted avg': {'precision': 0.3773552684897863, 'recall': 0.37732375606193647, 'f1-score': 0.36951466150631646, 'support': 3031622}}
[[219531 418221 324458]
 [216404 546378 387470]
 [145834 395332 377994]]
Evaluating performance on  train set...
5528/5528 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963457
{'0': {'precision': 0.3927919309959248, 'recall': 0.2607078507078507, 'f1-score': 0.31340160462900524, 'support': 466200}, '1': {'precision': 0.3439878097432067, 'recall': 0.4907712125167436, 'f1-score': 0.4044743691936541, 'support': 467342}, '2': {'precision': 0.397961023048015, 'recall': 0.3626666112162359, 'f1-score': 0.37949495685777046, 'support': 480910}, 'accuracy': 0.37138764694736903, 'macro avg': {'precision': 0.3782469212623822, 'recall': 0.37138189148027667, 'f1-score': 0.3657903102268099, 'support': 1414452}, 'weighted avg': {'precision': 0.3784242836132515, 'recall': 0.37138764694736903, 'f1-score': 0.3659640683658501, 'support': 1414452}}
[[121542 214317 130341]
 [104476 229358 133508]
 [ 83413 223087 174410]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957453
{'0': {'precision': 0.39902590169910285, 'recall': 0.24067254194226106, 'f1-score': 0.3002495285624488, 'support': 163737}, '1': {'precision': 0.35640546610970003, 'recall': 0.5123015370132339, 'f1-score': 0.42036513446197876, 'support': 165711}, '2': {'precision': 0.3810914497351688, 'recall': 0.36300871863283746, 'f1-score': 0.37183036567161765, 'support': 158167}, 'accuracy': 0.3726649098161459, 'macro avg': {'precision': 0.3788409391813239, 'recall': 0.3719942658627775, 'f1-score': 0.36414834289868175, 'support': 487615}, 'weighted avg': {'precision': 0.37872440673743213, 'recall': 0.3726649098161459, 'f1-score': 0.36428817264079527, 'support': 487615}}
[[39407 78185 46145]
 [33716 84894 47101]
 [25635 75116 57416]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1112151
{'0': {'precision': 0.39856720003431856, 'recall': 0.18013144884546037, 'f1-score': 0.24812391507544396, 'support': 51579}, '1': {'precision': 0.29098413852184524, 'recall': 0.29450093271327604, 'f1-score': 0.292731973570813, 'support': 38061}, '2': {'precision': 0.3505172552059665, 'recall': 0.5578600297808977, 'f1-score': 0.43052500246248815, 'support': 47010}, 'accuracy': 0.3419319429198683, 'macro avg': {'precision': 0.34668953125404345, 'recall': 0.34416413711321137, 'f1-score': 0.3237936303695817, 'support': 136650}, 'weighted avg': {'precision': 0.35207216300097005, 'recall': 0.3419319429198683, 'f1-score': 0.3232977345592141, 'support': 136650}}
[[ 9291 14140 28148]
 [ 6407 11209 20445]
 [ 7613 13172 26225]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033286
{'0': {'precision': 0.3432639870733185, 'recall': 0.15741212429954152, 'f1-score': 0.21584378472773455, 'support': 21593}, '1': {'precision': 0.34972468644845517, 'recall': 0.2119091751621872, 'f1-score': 0.26390812557710064, 'support': 21580}, '2': {'precision': 0.3437410620650205, 'recall': 0.6627452782500804, 'f1-score': 0.4526892352119528, 'support': 21761}, 'accuracy': 0.3448732559213971, 'macro avg': {'precision': 0.34557657852893137, 'recall': 0.34402219257060307, 'f1-score': 0.3108137151722627, 'support': 64934}, 'weighted avg': {'precision': 0.34557099913802847, 'recall': 0.3448732559213971, 'f1-score': 0.3111901721906414, 'support': 64934}}
[[ 3399  4288 13906]
 [ 3379  4573 13628]
 [ 3124  4215 14422]]
Evaluating performance on  val set...
81/81 - 1s - 824ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1075643
{'0': {'precision': 0.3683414043583535, 'recall': 0.1661433447098976, 'f1-score': 0.22899614262865742, 'support': 7325}, '1': {'precision': 0.3047153024911032, 'recall': 0.22096774193548388, 'f1-score': 0.256170531039641, 'support': 6200}, '2': {'precision': 0.3510455680399501, 'recall': 0.6344662247919899, 'f1-score': 0.45200180840910237, 'support': 7091}, 'accuracy': 0.3437136204889406, 'macro avg': {'precision': 0.34136742496313555, 'recall': 0.3405257704791238, 'f1-score': 0.31238949402580024, 'support': 20616}, 'weighted avg': {'precision': 0.34325765353808035, 'recall': 0.3437136204889406, 'f1-score': 0.3138726649509912, 'support': 20616}}
[[1217 1612 4496]
 [1009 1370 3821]
 [1078 1514 4499]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962175
{'0': {'precision': 0.4145774121742881, 'recall': 0.39085192285349135, 'f1-score': 0.4023652272718778, 'support': 137712}, '1': {'precision': 0.310695724552357, 'recall': 0.45714349722205627, 'f1-score': 0.3699538290466061, 'support': 133912}, '2': {'precision': 0.4459305436021493, 'recall': 0.2715035299282685, 'f1-score': 0.3375131490341237, 'support': 141221}, 'accuracy': 0.37152926643171164, 'macro avg': {'precision': 0.3904012267762648, 'recall': 0.3731663166679387, 'f1-score': 0.3699440684508692, 'support': 412845}, 'weighted avg': {'precision': 0.3916068445776016, 'recall': 0.37152926643171164, 'f1-score': 0.36966833013140993, 'support': 412845}}
[[53825 64248 19639]
 [44694 61217 28001]
 [31312 71567 38342]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.090735
{'0': {'precision': 0.4215049351478265, 'recall': 0.3382974441537533, 'f1-score': 0.3753450795712894, 'support': 54659}, '1': {'precision': 0.33394235430105523, 'recall': 0.5027882780044163, 'f1-score': 0.40132939990290895, 'support': 53438}, '2': {'precision': 0.43153724247226627, 'recall': 0.3020577196842241, 'f1-score': 0.35537091213607547, 'support': 54089}, 'accuracy': 0.38040891322308956, 'macro avg': {'precision': 0.3956615106403827, 'recall': 0.3810478139474645, 'f1-score': 0.37734846387009124, 'support': 162186}, 'weighted avg': {'precision': 0.39600007206212157, 'recall': 0.38040891322308956, 'f1-score': 0.3772451656914095, 'support': 162186}}
[[18491 26008 10160]
 [15208 26868 11362]
 [10170 27581 16338]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000504
{'0': {'precision': 0.40218114110919007, 'recall': 0.3564566511463429, 'f1-score': 0.3779409467270739, 'support': 16967}, '1': {'precision': 0.33667589613110827, 'recall': 0.49548458149779734, 'f1-score': 0.4009267923183175, 'support': 18160}, '2': {'precision': 0.4237118103055176, 'recall': 0.26394727871832746, 'f1-score': 0.3252704169146218, 'support': 17602}, 'accuracy': 0.37345673158982723, 'macro avg': {'precision': 0.3875229491819386, 'recall': 0.37196283712082256, 'f1-score': 0.36804605198667106, 'support': 52729}, 'weighted avg': {'precision': 0.3868083403807824, 'recall': 0.37345673158982723, 'f1-score': 0.36827484818885403, 'support': 52729}}
[[6048 8253 2666]
 [5509 8998 3653]
 [3481 9475 4646]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978333
{'0': {'precision': 0.37696343156920226, 'recall': 0.2782827592491343, 'f1-score': 0.32019239590568926, 'support': 87792}, '1': {'precision': 0.36246661296476873, 'recall': 0.3962320989942995, 'f1-score': 0.37859799840581, 'support': 86308}, '2': {'precision': 0.35465370388137346, 'recall': 0.42184746085082103, 'f1-score': 0.38534330985915494, 'support': 78865}, 'accuracy': 0.36328345818591506, 'macro avg': {'precision': 0.36469458280511485, 'recall': 0.3654541063647516, 'f1-score': 0.3613779013902181, 'support': 252965}, 'weighted avg': {'precision': 0.3650619902859731, 'recall': 0.36328345818591506, 'f1-score': 0.3604311545067625, 'support': 252965}}
[[24431 32088 31273]
 [22845 34198 29265]
 [17534 28062 33269]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984387
{'0': {'precision': 0.3337172647914646, 'recall': 0.1953305183976156, 'f1-score': 0.24642449472906733, 'support': 28183}, '1': {'precision': 0.36805011746280347, 'recall': 0.3933603012972521, 'f1-score': 0.38028453914098853, 'support': 28676}, '2': {'precision': 0.3777540867093106, 'recall': 0.5013982008692429, 'f1-score': 0.43088148008743865, 'support': 29681}, 'accuracy': 0.365923272475156, 'macro avg': {'precision': 0.3598404896545262, 'recall': 0.3633630068547036, 'f1-score': 0.35253017131916486, 'support': 86540}, 'weighted avg': {'precision': 0.36019734099376294, 'recall': 0.365923272475156, 'f1-score': 0.35404453651296003, 'support': 86540}}
[[ 5505  9633 13045]
 [ 5927 11280 11469]
 [ 5064  9735 14882]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026095
{'0': {'precision': 0.34655623365300786, 'recall': 0.22409095179930472, 'f1-score': 0.2721825962910129, 'support': 10643}, '1': {'precision': 0.3301618353192246, 'recall': 0.3835347588059085, 'f1-score': 0.35485258278778614, 'support': 9681}, '2': {'precision': 0.3719039092808117, 'recall': 0.44477159172019987, 'f1-score': 0.4050869494555501, 'support': 11208}, 'accuracy': 0.3514842065203603, 'macro avg': {'precision': 0.34954065941768137, 'recall': 0.3507991007751377, 'f1-score': 0.3440407095114497, 'support': 31532}, 'weighted avg': {'precision': 0.35053259348324606, 'recall': 0.3514842065203603, 'f1-score': 0.3448046985852979, 'support': 31532}}
[[2385 3603 4655]
 [2204 3713 3764]
 [2293 3930 4985]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009475
{'0': {'precision': 0.2992260619150468, 'recall': 0.13836486711424292, 'f1-score': 0.1892286679060591, 'support': 72092}, '1': {'precision': 0.4098304504195924, 'recall': 0.13389360130704325, 'f1-score': 0.2018438388285803, 'support': 89362}, '2': {'precision': 0.3289120860822582, 'recall': 0.7613775320325377, 'f1-score': 0.4593756891677861, 'support': 75236}, 'accuracy': 0.33471207064092273, 'macro avg': {'precision': 0.34598953280563244, 'recall': 0.344545333484608, 'f1-score': 0.28348273196747514, 'support': 236690}, 'weighted avg': {'precision': 0.3504208191071019, 'recall': 0.33471207064092273, 'f1-score': 0.27986240061815354, 'support': 236690}}
[[ 9975  8891 53226]
 [13747 11965 63650]
 [ 9614  8339 57283]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015432
{'0': {'precision': 0.3427192856114072, 'recall': 0.1592597550364768, 'f1-score': 0.2174648144763297, 'support': 29882}, '1': {'precision': 0.3724969350224765, 'recall': 0.12445809865164704, 'f1-score': 0.1865772842412302, 'support': 29295}, '2': {'precision': 0.3448956005855613, 'recall': 0.7614997278170931, 'f1-score': 0.47476322292574796, 'support': 29392}, 'accuracy': 0.34760469238672675, 'macro avg': {'precision': 0.3533706070731483, 'recall': 0.348405860501739, 'f1-score': 0.29293510721443594, 'support': 88569}, 'weighted avg': {'precision': 0.3532907326099915, 'recall': 0.34760469238672675, 'f1-score': 0.29263405679483917, 'support': 88569}}
[[ 4759  3213 21910]
 [ 5046  3646 20603]
 [ 4081  2929 22382]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988295
{'0': {'precision': 0.32114003590664275, 'recall': 0.131852943886483, 'f1-score': 0.1869488536155203, 'support': 10853}, '1': {'precision': 0.3128562381253958, 'recall': 0.09898807734695922, 'f1-score': 0.15039196285866505, 'support': 9981}, '2': {'precision': 0.3636031797534069, 'recall': 0.7839279468345576, 'f1-score': 0.49678599135542506, 'support': 11436}, 'accuracy': 0.35277347381468854, 'macro avg': {'precision': 0.3325331512618152, 'recall': 0.3382563226893333, 'f1-score': 0.2780422692765368, 'support': 32270}, 'weighted avg': {'precision': 0.33362618178135517, 'recall': 0.35277347381468854, 'f1-score': 0.28544352918259125, 'support': 32270}}
[[1431 1126 8296]
 [1598  988 7395]
 [1427 1044 8965]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080441
{'0': {'precision': 0.32340959432457134, 'recall': 0.15849724058877562, 'f1-score': 0.21273625757807327, 'support': 131731}, '1': {'precision': 0.38161194710442314, 'recall': 0.40867748696070916, 'f1-score': 0.3946812517398922, 'support': 147439}, '2': {'precision': 0.31871829886851344, 'recall': 0.4601356584598775, 'f1-score': 0.376588326818352, 'support': 127821}, 'accuracy': 0.34386264069721445, 'macro avg': {'precision': 0.3412466134325027, 'recall': 0.34243679533645405, 'f1-score': 0.32800194537877253, 'support': 406991}, 'weighted avg': {'precision': 0.343020963163243, 'recall': 0.34386264069721445, 'f1-score': 0.3301086892450784, 'support': 406991}}
[[20879 48145 62707]
 [24170 60255 63014]
 [19510 49496 58815]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984825
{'0': {'precision': 0.3453960777209113, 'recall': 0.16884382057299738, 'f1-score': 0.22681240240910103, 'support': 45166}, '1': {'precision': 0.3736649202887145, 'recall': 0.3653271192402392, 'f1-score': 0.3694489834483832, 'support': 45488}, '2': {'precision': 0.3702875623989313, 'recall': 0.5601216684746773, 'f1-score': 0.44583841256941625, 'support': 47013}, 'accuracy': 0.3673865196452309, 'macro avg': {'precision': 0.36311618680285235, 'recall': 0.36476420276263793, 'f1-score': 0.3473665994756335, 'support': 137667}, 'weighted avg': {'precision': 0.3632370743278831, 'recall': 0.3673865196452309, 'f1-score': 0.3487393900966497, 'support': 137667}}
[[ 7626 13967 23573]
 [ 7661 16618 21209]
 [ 6792 13888 26333]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106453
{'0': {'precision': 0.3737152254351103, 'recall': 0.14314209227862054, 'f1-score': 0.20699863367238497, 'support': 19051}, '1': {'precision': 0.35692986641221375, 'recall': 0.34201954397394135, 'f1-score': 0.34931566813552395, 'support': 17499}, '2': {'precision': 0.33759260517909334, 'recall': 0.5863880526533263, 'f1-score': 0.4284944033472082, 'support': 16941}, 'accuracy': 0.3485820044493466, 'macro avg': {'precision': 0.3560792323421391, 'recall': 0.3571832296352961, 'f1-score': 0.328269568385039, 'support': 53491}, 'weighted avg': {'precision': 0.35678377327869426, 'recall': 0.3485820044493466, 'f1-score': 0.32370547445179926, 'support': 53491}}
[[ 2727  5844 10480]
 [ 2502  5985  9012]
 [ 2068  4939  9934]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/EXC
Evaluating performance on  test set...
3782/3782 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0779567
{'0': {'precision': 0.4161768035488172, 'recall': 0.3208133213530792, 'f1-score': 0.3623252418324512, 'support': 309398}, '1': {'precision': 0.35432523798660226, 'recall': 0.5404605991585207, 'f1-score': 0.4280327704564814, 'support': 316110}, '2': {'precision': 0.4622365292224074, 'recall': 0.3337811003387455, 'f1-score': 0.387644221964471, 'support': 342440}, 'accuracy': 0.397132903833677, 'macro avg': {'precision': 0.41091285691927565, 'recall': 0.3983516736167818, 'f1-score': 0.3926674114178012, 'support': 967948}, 'weighted avg': {'precision': 0.4122724554534572, 'recall': 0.397132903833677, 'f1-score': 0.3927411716445393, 'support': 967948}}
[[ 99259 145439  64700]
 [ 76989 170845  68276]
 [ 62254 165886 114300]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0812117
{'0': {'precision': 0.4413983707220309, 'recall': 0.2883706707632271, 'f1-score': 0.3488400767997746, 'support': 137351}, '1': {'precision': 0.35703593506001496, 'recall': 0.5722335762099402, 'f1-score': 0.43971732092155197, 'support': 135048}, '2': {'precision': 0.4350445588050709, 'recall': 0.3280500323987448, 'f1-score': 0.37404637185479117, 'support': 137351}, 'accuracy': 0.39522879804759, 'macro avg': {'precision': 0.41115962152903895, 'recall': 0.3962180931239707, 'f1-score': 0.3875345898587059, 'support': 409750}, 'weighted avg': {'precision': 0.4114638237253493, 'recall': 0.39522879804759, 'f1-score': 0.3872412968028481, 'support': 409750}}
[[39608 69528 28215]
 [27471 77279 30298]
 [22654 69639 45058]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0757401
{'0': {'precision': 0.45987624005500444, 'recall': 0.30424329066216127, 'f1-score': 0.36621040281579975, 'support': 46167}, '1': {'precision': 0.3659765355417529, 'recall': 0.577681430967995, 'f1-score': 0.44808152160136544, 'support': 45899}, '2': {'precision': 0.42888587366199304, 'recall': 0.32259820375578335, 'f1-score': 0.3682255329614144, 'support': 44092}, 'accuracy': 0.4023634307201927, 'macro avg': {'precision': 0.4182462164195835, 'recall': 0.4015076417953132, 'f1-score': 0.39417248579285985, 'support': 136158}, 'weighted avg': {'precision': 0.41818695428072467, 'recall': 0.4023634307201927, 'f1-score': 0.3944617989843622, 'support': 136158}}
[[14046 23257  8864]
 [ 9307 26515 10077]
 [ 7190 22678 14224]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/AAL
Evaluating performance on  test set...
4457/4457 - 38s - 38s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0863278
{'0': {'precision': 0.43249176728869376, 'recall': 0.2657570996052581, 'f1-score': 0.3292171691995081, 'support': 391395}, '1': {'precision': 0.3596418106037166, 'recall': 0.516725766466878, 'f1-score': 0.4241055810369658, 'support': 382404}, '2': {'precision': 0.3975858994191231, 'recall': 0.3801136301735502, 'f1-score': 0.38865349349812095, 'support': 367156}, 'accuracy': 0.386671691696868, 'macro avg': {'precision': 0.39657315910384444, 'recall': 0.3875321654152288, 'f1-score': 0.3806587479115316, 'support': 1140955}, 'weighted avg': {'precision': 0.3968426718732899, 'recall': 0.386671691696868, 'f1-score': 0.3801465321669105, 'support': 1140955}}
[[104016 183285 104094]
 [ 77440 197598 107366]
 [ 59048 168547 139561]]
Evaluating performance on  train set...
2425/2425 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960212
{'0': {'precision': 0.4069817022302145, 'recall': 0.32004412457904274, 'f1-score': 0.35831492584411484, 'support': 205781}, '1': {'precision': 0.3346855072417257, 'recall': 0.5081172469572505, 'f1-score': 0.4035570071144012, 'support': 205242}, '2': {'precision': 0.42482045155246617, 'recall': 0.298420206856102, 'f1-score': 0.3505748897136055, 'support': 209711}, 'accuracy': 0.3749238804383198, 'macro avg': {'precision': 0.3888292203414688, 'recall': 0.37552719279746505, 'f1-score': 0.3708156075573738, 'support': 620734}, 'weighted avg': {'precision': 0.3891041029804414, 'recall': 0.3749238804383198, 'f1-score': 0.3706590289979793, 'support': 620734}}
[[ 65859 100943  38979]
 [ 55202 104287  45753]
 [ 40762 106367  62582]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0912228
{'0': {'precision': 0.42742761977965665, 'recall': 0.2919455746598416, 'f1-score': 0.34692869583300834, 'support': 68571}, '1': {'precision': 0.34132120576059705, 'recall': 0.5288166214995483, 'f1-score': 0.41486836044080644, 'support': 66420}, '2': {'precision': 0.4194055944055944, 'recall': 0.325995379807039, 'f1-score': 0.3668476183194434, 'support': 66231}, 'accuracy': 0.38134001252348154, 'macro avg': {'precision': 0.3960514733152827, 'recall': 0.382252525322143, 'f1-score': 0.37621489153108606, 'support': 201222}, 'weighted avg': {'precision': 0.39636493885164953, 'recall': 0.38134001252348154, 'f1-score': 0.3759106296098768, 'support': 201222}}
[[20019 34424 14128]
 [15535 35124 15761]
 [11282 33358 21591]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/WBA
Evaluating performance on  test set...
4676/4676 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0838596
{'0': {'precision': 0.4239591545594474, 'recall': 0.3337133851287292, 'f1-score': 0.373461719181678, 'support': 406085}, '1': {'precision': 0.35233329933072494, 'recall': 0.520914812145008, 'f1-score': 0.42035163207655174, 'support': 391206}, '2': {'precision': 0.42226563283983487, 'recall': 0.31583661501048305, 'f1-score': 0.3613779757474437, 'support': 399694}, 'accuracy': 0.38892634410623356, 'macro avg': {'precision': 0.39951936224333573, 'recall': 0.39015493742807345, 'f1-score': 0.3850637756685578, 'support': 1196985}, 'weighted avg': {'precision': 0.3999844558031502, 'recall': 0.38892634410623356, 'f1-score': 0.3847515979318287, 'support': 1196985}}
[[135516 186103  84466]
 [ 99171 203785  88250]
 [ 84957 188499 126238]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0856228
{'0': {'precision': 0.44246766006222366, 'recall': 0.2915852855801707, 'f1-score': 0.351519763758529, 'support': 185342}, '1': {'precision': 0.3435245111663785, 'recall': 0.5519827391205999, 'f1-score': 0.4234909333629992, 'support': 172413}, '2': {'precision': 0.42471653711759255, 'recall': 0.3278686719661771, 'f1-score': 0.37006107828334606, 'support': 181652}, 'accuracy': 0.387036134125067, 'macro avg': {'precision': 0.40356956944873157, 'recall': 0.3904788988889825, 'f1-score': 0.38169059180162473, 'support': 539407}, 'weighted avg': {'precision': 0.4048641211468639, 'recall': 0.387036134125067, 'f1-score': 0.3807682387154309, 'support': 539407}}
[[54043 90967 40332]
 [36904 95169 40340]
 [31193 90901 59558]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964248
{'0': {'precision': 0.4266626761015029, 'recall': 0.2796922516361394, 'f1-score': 0.33788748370494526, 'support': 71357}, '1': {'precision': 0.3287292015525636, 'recall': 0.5431660429261427, 'f1-score': 0.40957796417006853, 'support': 62526}, '2': {'precision': 0.4211041901558139, 'recall': 0.3240364101834732, 'f1-score': 0.36624790013905295, 'support': 70310}, 'accuracy': 0.37563971340839303, 'macro avg': {'precision': 0.39216535593662677, 'recall': 0.3822982349152517, 'f1-score': 0.37123778267135554, 'support': 204193}, 'weighted avg': {'precision': 0.39476047780631957, 'recall': 0.37563971340839303, 'f1-score': 0.3696052206550092, 'support': 204193}}
[[19958 34674 16725]
 [13969 33962 14595]
 [12850 34677 22783]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0791914
{'0': {'precision': 0.3244238504907301, 'recall': 0.20370487766630077, 'f1-score': 0.2502674717463753, 'support': 299713}, '1': {'precision': 0.4674417799391349, 'recall': 0.48986775260059673, 'f1-score': 0.47839209038880653, 'support': 496040}, '2': {'precision': 0.3106099462741624, 'recall': 0.40195368545261945, 'f1-score': 0.35042712561847733, 'support': 298308}, 'accuracy': 0.38750398743762915, 'macro avg': {'precision': 0.36749185890134245, 'recall': 0.3651754385731723, 'f1-score': 0.35969556258455304, 'support': 1094061}, 'weighted avg': {'precision': 0.38550071511212763, 'recall': 0.38750398743762915, 'f1-score': 0.38100731336276655, 'support': 1094061}}
[[ 61053 140393  98267]
 [ 85185 242994 167861]
 [ 41951 136451 119906]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951877
{'0': {'precision': 0.39439907830375553, 'recall': 0.2358333786568526, 'f1-score': 0.29516876240900064, 'support': 165477}, '1': {'precision': 0.34713953079858423, 'recall': 0.5583267210079589, 'f1-score': 0.42810491407342877, 'support': 166356}, '2': {'precision': 0.4075890141089898, 'recall': 0.32577108322141435, 'f1-score': 0.36211600581702125, 'support': 172744}, 'accuracy': 0.3729480336995146, 'macro avg': {'precision': 0.38304254107044317, 'recall': 0.37331039429540863, 'f1-score': 0.36179656076648353, 'support': 504577}, 'weighted avg': {'precision': 0.3833335184109524, 'recall': 0.3729480336995146, 'f1-score': 0.3619166741480666, 'support': 504577}}
[[39025 85887 40565]
 [32247 92881 41228]
 [27676 88793 56275]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954686
{'0': {'precision': 0.37913084166812894, 'recall': 0.22295217294099437, 'f1-score': 0.280785349952892, 'support': 58147}, '1': {'precision': 0.3748350667494567, 'recall': 0.5861692282016658, 'f1-score': 0.4572649319754058, 'support': 65911}, '2': {'precision': 0.3743561442236939, 'recall': 0.28714547763510656, 'f1-score': 0.32500199632675875, 'support': 56696}, 'accuracy': 0.37553249167376657, 'macro avg': {'precision': 0.3761073508804265, 'recall': 0.36542229292592227, 'f1-score': 0.3543507594183522, 'support': 180754}, 'weighted avg': {'precision': 0.3760667597281758, 'recall': 0.37553249167376657, 'f1-score': 0.3590068704365253, 'support': 180754}}
[[12964 32762 12421]
 [12489 38635 14787]
 [ 8741 31675 16280]]
testing model on single stock: results/universal/W4/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
12724/12724 - 97s - 97s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.084788
{'0': {'precision': 0.32862468357416963, 'recall': 0.23658057354261022, 'f1-score': 0.2751079015677744, 'support': 912539}, '1': {'precision': 0.44976342364014676, 'recall': 0.37303224421041253, 'f1-score': 0.40781998700244715, 'support': 1406361}, '2': {'precision': 0.3281451283857536, 'recall': 0.5014511166083839, 'f1-score': 0.39669596392592266, 'support': 938243}, 'accuracy': 0.3717951591317913, 'macro avg': {'precision': 0.36884441186669, 'recall': 0.37035464478713553, 'f1-score': 0.3598746174987147, 'support': 3257143}, 'weighted avg': {'precision': 0.38079152436663183, 'recall': 0.3717951591317913, 'f1-score': 0.36743428993177557, 'support': 3257143}}
[[215889 327557 369093]
 [287554 524618 594189]
 [153504 314256 470483]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963124
{'0': {'precision': 0.37291337829435117, 'recall': 0.21142955286077803, 'f1-score': 0.2698583472986187, 'support': 442502}, '1': {'precision': 0.35082400662603264, 'recall': 0.30521752586129247, 'f1-score': 0.3264355380342086, 'support': 432983}, '2': {'precision': 0.37198245699920235, 'recall': 0.5784598436691841, 'f1-score': 0.452793218004117, 'support': 446617}, 'accuracy': 0.36613060111852186, 'macro avg': {'precision': 0.3652399473065287, 'recall': 0.3650356407970849, 'f1-score': 0.34969570111231474, 'support': 1322102}, 'weighted avg': {'precision': 0.3653647264587598, 'recall': 0.36613060111852186, 'f1-score': 0.3501840596310601, 'support': 1322102}}
[[ 93558 126425 222519]
 [ 87176 132154 213653]
 [ 70150 118117 258350]]
Evaluating performance on  val set...
1903/1903 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094171
{'0': {'precision': 0.3604230638007506, 'recall': 0.22884765359048315, 'f1-score': 0.27994594001158435, 'support': 161566}, '1': {'precision': 0.3790284327129663, 'recall': 0.32998305630287317, 'f1-score': 0.35280940461465043, 'support': 164663}, '2': {'precision': 0.36964962789038325, 'recall': 0.5542514150649996, 'f1-score': 0.4435081676737311, 'support': 160770}, 'accuracy': 0.3704668798087881, 'macro avg': {'precision': 0.36970037480136675, 'recall': 0.37102737498611865, 'f1-score': 0.35875450409998866, 'support': 486999}, 'weighted avg': {'precision': 0.36975977818801303, 'recall': 0.3704668798087881, 'f1-score': 0.3585781672095416, 'support': 486999}}
[[36974 45369 79223]
 [37599 54336 72728]
 [28012 43651 89107]]
training model: results/universal/W4/deepOF_L2/h500
Epoch 1/50
9854/9854 - 225s - loss: 3.2640 - accuracy500: 0.3836 - val_loss: 3.3334 - val_accuracy500: 0.3340 - 225s/epoch - 23ms/step
Epoch 2/50
9854/9854 - 219s - loss: 3.2526 - accuracy500: 0.3915 - val_loss: 3.3738 - val_accuracy500: 0.3340 - 219s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 218s - loss: 3.2432 - accuracy500: 0.3965 - val_loss: 3.3787 - val_accuracy500: 0.3341 - 218s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 217s - loss: 3.2407 - accuracy500: 0.3981 - val_loss: 3.4010 - val_accuracy500: 0.3340 - 217s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 219s - loss: 3.2390 - accuracy500: 0.3991 - val_loss: 3.4129 - val_accuracy500: 0.3340 - 219s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 218s - loss: 3.2391 - accuracy500: 0.3994 - val_loss: 3.4283 - val_accuracy500: 0.3340 - 218s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 218s - loss: 3.2366 - accuracy500: 0.4007 - val_loss: 3.4439 - val_accuracy500: 0.3341 - 218s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 218s - loss: 3.2362 - accuracy500: 0.4007 - val_loss: 3.4788 - val_accuracy500: 0.3340 - 218s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 218s - loss: 3.2341 - accuracy500: 0.4024 - val_loss: 3.4868 - val_accuracy500: 0.3340 - 218s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 219s - loss: 3.2335 - accuracy500: 0.4030 - val_loss: 3.5312 - val_accuracy500: 0.3340 - 219s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 217s - loss: 3.2312 - accuracy500: 0.4041 - val_loss: 3.5141 - val_accuracy500: 0.3341 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0882789
{'0': {'precision': 0.29874572405929306, 'recall': 0.00043658759580209364, 'f1-score': 0.000871900993756368, 'support': 1800326}, '1': {'precision': 0.3952013779318853, 'recall': 0.9986537640232914, 'f1-score': 0.5662989384467332, 'support': 2400025}, '2': {'precision': 0.28638829912715263, 'recall': 0.0006487607280655815, 'f1-score': 0.0012945888001006667, 'support': 1871260}, 'accuracy': 0.3950836112524337, 'macro avg': {'precision': 0.32677846703944363, 'recall': 0.3332463707823864, 'f1-score': 0.18948847608019673, 'support': 6071611}, 'weighted avg': {'precision': 0.3330647912240128, 'recall': 0.3950836112524337, 'f1-score': 0.22450776705098244, 'support': 6071611}}
[[    786 1798504    1036]
 [   1242 2396794    1989]
 [    603 1869443    1214]]
Evaluating performance on  train set...
9854/9854 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1138982
{'0': {'precision': 0.3583138173302108, 'recall': 0.00036255709385607906, 'f1-score': 0.0007243812281102528, 'support': 844005}, '1': {'precision': 0.32984471654112274, 'recall': 0.9992138440381971, 'f1-score': 0.4959682243152365, 'support': 831896}, '2': {'precision': 0.3493862134088763, 'recall': 0.0004372938366388414, 'f1-score': 0.0008734944025534366, 'support': 846113}, 'accuracy': 0.3298625622220971, 'macro avg': {'precision': 0.3458482490934032, 'recall': 0.3333378983228974, 'f1-score': 0.1658553666486334, 'support': 2522014}, 'weighted avg': {'precision': 0.34592804436989766, 'recall': 0.3298625622220971, 'f1-score': 0.16413249025691648, 'support': 2522014}}
[[   306 843386    313]
 [   278 831242    376]
 [   270 845473    370]]
Evaluating performance on  val set...
3566/3566 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123722
{'0': {'precision': 0.37362637362637363, 'recall': 0.0004451062854898624, 'f1-score': 0.0008891533102981606, 'support': 305545}, '1': {'precision': 0.3340668454008135, 'recall': 0.9992256455687896, 'f1-score': 0.5007275770615094, 'support': 304770}, '2': {'precision': 0.35989717223650386, 'recall': 0.0004635239741221187, 'f1-score': 0.0009258555070216221, 'support': 302034}, 'accuracy': 0.33409364179716317, 'macro avg': {'precision': 0.3558634637545637, 'recall': 0.3333780919428005, 'f1-score': 0.16751419529294306, 'support': 912349}, 'weighted avg': {'precision': 0.35586645606205136, 'recall': 0.33409364179716317, 'f1-score': 0.16787222855665876, 'support': 912349}}
[[   136 305285    124]
 [   111 304534    125]
 [   117 301777    140]]
testing model out of sample: results/universal/W4/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 92s - 92s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105146
{'0': {'precision': 0.3997627520759193, 'recall': 0.0003283912240612347, 'f1-score': 0.0006562433669763536, 'support': 1026215}, '1': {'precision': 0.33966533951847755, 'recall': 0.9995513112491708, 'f1-score': 0.5070321300246348, 'support': 1029667}, '2': {'precision': 0.37206085753803597, 'recall': 0.00027568819562588393, 'f1-score': 0.0005509681370415468, 'support': 975740}, 'accuracy': 0.33968977662782496, 'macro avg': {'precision': 0.37049631637747765, 'recall': 0.3333851302229527, 'f1-score': 0.16941311384288424, 'support': 3031622}, 'weighted avg': {'precision': 0.3704351614092143, 'recall': 0.33968977662782496, 'f1-score': 0.17260901941698345, 'support': 3031622}}
[[    337 1025640     238]
 [    246 1029205     216]
 [    260  975211     269]]
Evaluating performance on  train set...
5528/5528 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1134666
{'0': {'precision': 0.3616557734204793, 'recall': 0.0003559955221768054, 'f1-score': 0.0007112908858356704, 'support': 466298}, '1': {'precision': 0.330793153115423, 'recall': 0.9993823215732205, 'f1-score': 0.49706047902950357, 'support': 467881}, '2': {'precision': 0.41797752808988764, 'recall': 0.0003872797346509173, 'f1-score': 0.000773842460652607, 'support': 480273}, 'accuracy': 0.3308305972913892, 'macro avg': {'precision': 0.3701421515419299, 'recall': 0.3333751989433494, 'f1-score': 0.16618187079199728, 'support': 1414452}, 'weighted avg': {'precision': 0.37057073442968336, 'recall': 0.3308305972913892, 'f1-score': 0.164917920966135, 'support': 1414452}}
[[   166 466018    114]
 [   144 467592    145]
 [   149 479938    186]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1168612
{'0': {'precision': 0.41208791208791207, 'recall': 0.0004441812259401836, 'f1-score': 0.000887405934970893, 'support': 168850}, '1': {'precision': 0.32452239299119795, 'recall': 0.9993680125891892, 'f1-score': 0.48994584076938336, 'support': 158231}, '2': {'precision': 0.3625, 'recall': 0.00036129418067200715, 'f1-score': 0.0007218688936736902, 'support': 160534}, 'accuracy': 0.32456753791413306, 'macro avg': {'precision': 0.3663701016930367, 'recall': 0.3333911626652671, 'f1-score': 0.16385170519934264, 'support': 487615}, 'weighted avg': {'precision': 0.3673474395197731, 'recall': 0.32456753791413306, 'f1-score': 0.15953230176240915, 'support': 487615}}
[[    75 168721     54]
 [    52 158131     48]
 [    55 160421     58]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1262459
{'0': {'precision': 0.24691358024691357, 'recall': 0.0003937085375696372, 'f1-score': 0.0007861635220125786, 'support': 50799}, '1': {'precision': 0.30513081640278705, 'recall': 0.9984416954353663, 'f1-score': 0.4674160077665108, 'support': 41712}, '2': {'precision': 0.2875, 'recall': 0.0005210811300663812, 'f1-score': 0.0010402768040887402, 'support': 44139}, 'accuracy': 0.30508598609586535, 'macro avg': {'precision': 0.27984813221656685, 'recall': 0.33311882836766743, 'f1-score': 0.15641414936420406, 'support': 136650}, 'weighted avg': {'precision': 0.27779394128617646, 'recall': 0.30508598609586535, 'f1-score': 0.14330559542310348, 'support': 136650}}
[[   20 50754    25]
 [   33 41647    32]
 [   28 44088    23]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146063
{'0': {'precision': 0.2876712328767123, 'recall': 0.0009765625, 'f1-score': 0.0019465171247161329, 'support': 21504}, '1': {'precision': 0.33390910072330776, 'recall': 0.9985241894571785, 'f1-score': 0.5004622994776016, 'support': 21683}, '2': {'precision': 0.25, 'recall': 0.00022991677012921323, 'f1-score': 0.00045941103505306197, 'support': 21747}, 'accuracy': 0.33383127483290725, 'macro avg': {'precision': 0.29052677786667336, 'recall': 0.3332435562424359, 'f1-score': 0.16762274254579027, 'support': 64934}, 'weighted avg': {'precision': 0.29049470574374453, 'recall': 0.33383127483290725, 'f1-score': 0.16791469423725672, 'support': 64934}}
[[   21 21474     9]
 [   26 21651     6]
 [   26 21716     5]]
Evaluating performance on  val set...
81/81 - 1s - 808ms/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.136107
{'0': {'precision': 0.5, 'recall': 0.001984652024345065, 'f1-score': 0.003953610964681076, 'support': 7558}, '1': {'precision': 0.2749003984063745, 'recall': 0.9984118581259925, 'f1-score': 0.43110213722427515, 'support': 5667}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7391}, 'accuracy': 0.275174621653085, 'macro avg': {'precision': 0.2583001328021248, 'recall': 0.3334655033834459, 'f1-score': 0.14501858272965207, 'support': 20616}, 'weighted avg': {'precision': 0.25886983691156984, 'recall': 0.275174621653085, 'f1-score': 0.11995232844979759, 'support': 20616}}
[[  15 7539    4]
 [   9 5658    0]
 [   6 7385    0]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1190844
{'0': {'precision': 0.5333333333333333, 'recall': 5.656028619504815e-05, 'f1-score': 0.00011310857716479214, 'support': 141442}, '1': {'precision': 0.3088695610039733, 'recall': 0.9997804214340049, 'f1-score': 0.4719393940515698, 'support': 127517}, '2': {'precision': 0.44285714285714284, 'recall': 0.00021544834104777393, 'f1-score': 0.00043068715440829146, 'support': 143886}, 'accuracy': 0.3089004347878744, 'macro avg': {'precision': 0.42835334573148315, 'recall': 0.3333508100204159, 'f1-score': 0.15749439659438097, 'support': 412845}, 'weighted avg': {'precision': 0.43246931899628155, 'recall': 0.3089004347878744, 'f1-score': 0.14595856524008904, 'support': 412845}}
[[     8 141421     13]
 [     2 127489     26]
 [     5 143850     31]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1103566
{'0': {'precision': 0.46153846153846156, 'recall': 0.0002216557685913776, 'f1-score': 0.00044309873716859906, 'support': 54138}, '1': {'precision': 0.33304958239263727, 'recall': 0.9996297119158706, 'f1-score': 0.49963447248364373, 'support': 54012}, '2': {'precision': 0.30434782608695654, 'recall': 0.0002590865349026575, 'f1-score': 0.0005177323323841574, 'support': 54036}, 'accuracy': 0.3330620398801376, 'macro avg': {'precision': 0.3663119566726851, 'recall': 0.3333701514064549, 'f1-score': 0.16686510118439882, 'support': 162186}, 'weighted avg': {'precision': 0.3663767674484551, 'recall': 0.3330620398801376, 'f1-score': 0.1667111945021895, 'support': 162186}}
[[   12 54108    18]
 [    6 53992    14]
 [    8 54014    14]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1115972
{'0': {'precision': 0.75, 'recall': 0.00017126220243192326, 'f1-score': 0.00034244620740825295, 'support': 17517}, '1': {'precision': 0.32698400652639964, 'recall': 0.9996519923438316, 'f1-score': 0.4927805575411008, 'support': 17241}, '2': {'precision': 0.5, 'recall': 0.00044516164932391074, 'f1-score': 0.0008895313281814643, 'support': 17971}, 'accuracy': 0.32706859602875077, 'macro avg': {'precision': 0.5256613355087999, 'recall': 0.33342280539852914, 'f1-score': 0.1646708450255635, 'support': 52729}, 'weighted avg': {'precision': 0.5264803287853298, 'recall': 0.32706859602875077, 'f1-score': 0.16154324926093874, 'support': 52729}}
[[    3 17511     3]
 [    1 17235     5]
 [    0 17963     8]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037855
{'0': {'precision': 0.40764331210191085, 'recall': 0.0007330706496838633, 'f1-score': 0.001463509449926253, 'support': 87304}, '1': {'precision': 0.3603324757569761, 'recall': 0.998869882928649, 'f1-score': 0.5296124680401756, 'support': 91141}, '2': {'precision': 0.35443037974683544, 'recall': 0.0007514761137949544, 'f1-score': 0.0014997723559816815, 'support': 74520}, 'accuracy': 0.36035815231356116, 'macro avg': {'precision': 0.3741353892019075, 'recall': 0.3334514765640426, 'f1-score': 0.17752524994869448, 'support': 252965}, 'weighted avg': {'precision': 0.37492185002449335, 'recall': 0.36035815231356116, 'f1-score': 0.19176148168574214, 'support': 252965}}
[[   64 87193    47]
 [   48 91038    55]
 [   45 74419    56]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122587
{'0': {'precision': 0.29508196721311475, 'recall': 0.0006486720242170889, 'f1-score': 0.0012944983818770227, 'support': 27749}, '1': {'precision': 0.33704406591371966, 'recall': 0.9986285400809162, 'f1-score': 0.5039885103216764, 'support': 29166}, '2': {'precision': 0.3333333333333333, 'recall': 0.0007088607594936709, 'f1-score': 0.0014147130153597414, 'support': 29625}, 'accuracy': 0.33701178645712965, 'macro avg': {'precision': 0.32181978882005585, 'recall': 0.33332869095487566, 'f1-score': 0.16889924057297104, 'support': 86540}, 'weighted avg': {'precision': 0.32231865882408445, 'recall': 0.33701178645712965, 'f1-score': 0.17075526693691645, 'support': 86540}}
[[   18 27709    22]
 [   20 29126    20]
 [   23 29581    21]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218972
{'0': {'precision': 0.5294117647058824, 'recall': 0.0017068082685378343, 'f1-score': 0.003402646502835539, 'support': 10546}, '1': {'precision': 0.3109198322957693, 'recall': 0.9986737400530504, 'f1-score': 0.4742043307658771, 'support': 9802}, '2': {'precision': 0.42857142857142855, 'recall': 0.000536480686695279, 'f1-score': 0.0010716199321307376, 'support': 11184}, 'accuracy': 0.31120766205759226, 'macro avg': {'precision': 0.42296767519102674, 'recall': 0.3336390096694278, 'f1-score': 0.15955953240028112, 'support': 31532}, 'weighted avg': {'precision': 0.42572483584594134, 'recall': 0.31120766205759226, 'f1-score': 0.1489287123400666, 'support': 31532}}
[[   18 10525     3]
 [    8  9789     5]
 [    8 11170     6]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999228
{'0': {'precision': 0.4006734006734007, 'recall': 0.0016692149079126398, 'f1-score': 0.0033245795384701346, 'support': 71291}, '1': {'precision': 0.37236902831351065, 'recall': 0.998161326568831, 'f1-score': 0.5423949377705961, 'support': 88107}, '2': {'precision': 0.3888888888888889, 'recall': 0.001086787765874864, 'f1-score': 0.002167518191670537, 'support': 77292}, 'accuracy': 0.3724196206007858, 'macro avg': {'precision': 0.3873104392919334, 'recall': 0.3336391097475395, 'f1-score': 0.1826290118335789, 'support': 236690}, 'weighted avg': {'precision': 0.3862889238456458, 'recall': 0.3724196206007858, 'f1-score': 0.20361373610250363, 'support': 236690}}
[[  119 71103    69]
 [   99 87945    63]
 [   79 77129    84]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113689
{'0': {'precision': 0.2824427480916031, 'recall': 0.0012399879352525218, 'f1-score': 0.0024691358024691358, 'support': 29839}, '1': {'precision': 0.32971125222135444, 'recall': 0.9976368244400301, 'f1-score': 0.4956229529116508, 'support': 29198}, '2': {'precision': 0.3516483516483517, 'recall': 0.001083570364350535, 'f1-score': 0.0021604834081625766, 'support': 29532}, 'accuracy': 0.32966387788052254, 'macro avg': {'precision': 0.32126745065376977, 'recall': 0.3333201275798777, 'f1-score': 0.1667508573740942, 'support': 88569}, 'weighted avg': {'precision': 0.3211010333586647, 'recall': 0.32966387788052254, 'f1-score': 0.16494122004690256, 'support': 88569}}
[[   37 29771    31]
 [   41 29129    28]
 [   53 29447    32]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234215
{'0': {'precision': 0.3090909090909091, 'recall': 0.0015755329008341056, 'f1-score': 0.003135085292761641, 'support': 10790}, '1': {'precision': 0.30509474992233615, 'recall': 0.9979676862107509, 'f1-score': 0.4673217387166615, 'support': 9841}, '2': {'precision': 0.56, 'recall': 0.0012028524787352866, 'f1-score': 0.002400548696844993, 'support': 11639}, 'accuracy': 0.3052990393554385, 'macro avg': {'precision': 0.39139521967108176, 'recall': 0.3335820238634401, 'f1-score': 0.1576191242354227, 'support': 32270}, 'weighted avg': {'precision': 0.3983690220971993, 'recall': 0.3052990393554385, 'f1-score': 0.14442766616988356, 'support': 32270}}
[[   17 10767     6]
 [   15  9821     5]
 [   23 11602    14]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
1590/1590 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.104226
{'0': {'precision': 0.38996138996138996, 'recall': 0.0007574450852313207, 'f1-score': 0.0015119534138710498, 'support': 133343}, '1': {'precision': 0.35851785529804747, 'recall': 0.9990746389378226, 'f1-score': 0.527678369400925, 'support': 145889}, '2': {'precision': 0.34946236559139787, 'recall': 0.0005087704193050979, 'f1-score': 0.001016061588964008, 'support': 127759}, 'accuracy': 0.3585337267900273, 'macro avg': {'precision': 0.36598053695027843, 'recall': 0.33344695148078635, 'f1-score': 0.17673546146792005, 'support': 406991}, 'weighted avg': {'precision': 0.365977123274937, 'recall': 0.3585337267900273, 'f1-score': 0.18996461604836914, 'support': 406991}}
[[   101 133166     76]
 [    90 145754     45]
 [    68 127626     65]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1143351
{'0': {'precision': 0.31683168316831684, 'recall': 0.0007117279419941728, 'f1-score': 0.001420265412098886, 'support': 44961}, '1': {'precision': 0.3307679997672287, 'recall': 0.9988577453650822, 'f1-score': 0.49696717996917994, 'support': 45524}, '2': {'precision': 0.3804347826086957, 'recall': 0.0007418083167309567, 'f1-score': 0.0014807293649786353, 'support': 47182}, 'accuracy': 0.33079096660782903, 'macro avg': {'precision': 0.34267815518141376, 'recall': 0.33343709387460246, 'f1-score': 0.16662272491541916, 'support': 137667}, 'weighted avg': {'precision': 0.34323858035242644, 'recall': 0.33079096660782903, 'f1-score': 0.16530943673508355, 'support': 137667}}
[[   32 44896    33]
 [   28 45472    24]
 [   41 47106    35]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1139835
{'0': {'precision': 0.3939393939393939, 'recall': 0.0006852564440461758, 'f1-score': 0.0013681330246263948, 'support': 18971}, '1': {'precision': 0.33141819815099, 'recall': 0.9989282490974729, 'f1-score': 0.49770945167364605, 'support': 17728}, '2': {'precision': 0.3333333333333333, 'recall': 0.0004764173415912339, 'f1-score': 0.0009514747859181731, 'support': 16792}, 'accuracy': 0.3314576283860836, 'macro avg': {'precision': 0.352896975141239, 'recall': 0.33336330762770344, 'f1-score': 0.16667635316139687, 'support': 53491}, 'weighted avg': {'precision': 0.3541930304645329, 'recall': 0.3314576283860836, 'f1-score': 0.16573489326215107, 'support': 53491}}
[[   13 18951     7]
 [   10 17709     9]
 [   10 16774     8]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/EXC
Evaluating performance on  test set...
3782/3782 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127507
{'0': {'precision': 0.2767489711934156, 'recall': 0.0008296221364157856, 'f1-score': 0.0016542851520220407, 'support': 324244}, '1': {'precision': 0.28809297745894435, 'recall': 0.9980007380787738, 'f1-score': 0.4471167235571579, 'support': 279103}, '2': {'precision': 0.3898305084745763, 'recall': 0.0001261653149607379, 'f1-score': 0.00025224899168949246, 'support': 364601}, 'accuracy': 0.2880939885200445, 'macro avg': {'precision': 0.31822415237564544, 'recall': 0.3329855085100501, 'f1-score': 0.14967441923362315, 'support': 967948}, 'weighted avg': {'precision': 0.3226148521653029, 'recall': 0.2880939885200445, 'f1-score': 0.1295730567803484, 'support': 967948}}
[[   269 323941     34]
 [   520 278545     38]
 [   183 364372     46]]
Evaluating performance on  train set...
1601/1601 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.115653
{'0': {'precision': 0.38636363636363635, 'recall': 0.00012284035811577343, 'f1-score': 0.00024560262939285585, 'support': 138391}, '1': {'precision': 0.3261009137358198, 'recall': 0.9997380592435151, 'f1-score': 0.4917874662911524, 'support': 133618}, '2': {'precision': 0.4057971014492754, 'recall': 0.0002032800691152235, 'f1-score': 0.0004063565778971047, 'support': 137741}, 'accuracy': 0.3261208053691275, 'macro avg': {'precision': 0.3727538838495772, 'recall': 0.3333547265569154, 'f1-score': 0.16414647516614747, 'support': 409750}, 'weighted avg': {'precision': 0.3732449065095239, 'recall': 0.3261208053691275, 'f1-score': 0.1605896737663737, 'support': 409750}}
[[    17 138355     19]
 [    13 133583     22]
 [    14 137699     28]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1184711
{'0': {'precision': 0.6, 'recall': 0.0001878326202650527, 'f1-score': 0.0003755476736907991, 'support': 47915}, '1': {'precision': 0.31550916063059226, 'recall': 0.999860318938424, 'f1-score': 0.47966004210385244, 'support': 42955}, '2': {'precision': 0.5294117647058824, 'recall': 0.0001987281399046105, 'f1-score': 0.0003973071404922194, 'support': 45288}, 'accuracy': 0.3155672086840288, 'macro avg': {'precision': 0.4816403084454916, 'recall': 0.33341562656619783, 'f1-score': 0.16014429897267848, 'support': 136158}, 'weighted avg': {'precision': 0.486770487190522, 'recall': 0.3155672086840288, 'f1-score': 0.1515870145061949, 'support': 136158}}
[[    9 47901     5]
 [    3 42949     3]
 [    3 45276     9]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/AAL
Evaluating performance on  test set...
4457/4457 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.121691
{'0': {'precision': 0.41228070175438597, 'recall': 0.00011507761617942314, 'f1-score': 0.0002300910083371274, 'support': 408420}, '1': {'precision': 0.30961773467072723, 'recall': 0.9998159964218382, 'f1-score': 0.4728162358264501, 'support': 353254}, '2': {'precision': 0.3739130434782609, 'recall': 0.00011337240726532571, 'f1-score': 0.00022667608514586343, 'support': 379281}, 'accuracy': 0.30963447287579265, 'macro avg': {'precision': 0.36527049330112465, 'recall': 0.3333481488150943, 'f1-score': 0.1577576676399777, 'support': 1140955}, 'weighted avg': {'precision': 0.36774062123166784, 'recall': 0.30963447287579265, 'f1-score': 0.1465475625879303, 'support': 1140955}}
[[    47 408330     43]
 [    36 353189     29]
 [    31 379207     43]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128793
{'0': {'precision': 0.42168674698795183, 'recall': 0.00016953093212950226, 'f1-score': 0.0003389256058295204, 'support': 206452}, '1': {'precision': 0.3295665332815479, 'recall': 0.9996724773422758, 'f1-score': 0.4957100869617914, 'support': 204566}, '2': {'precision': 0.36619718309859156, 'recall': 0.0002479543763947434, 'f1-score': 0.0004955731971142391, 'support': 209716}, 'accuracy': 0.3295872306011915, 'macro avg': {'precision': 0.37248348778936374, 'recall': 0.3333633208836, 'f1-score': 0.1655148619215784, 'support': 620734}, 'weighted avg': {'precision': 0.37258082880450244, 'recall': 0.3295872306011915, 'f1-score': 0.16364389762314704, 'support': 620734}}
[[    35 206368     49]
 [    26 204499     41]
 [    22 209642     52]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1217909
{'0': {'precision': 0.45454545454545453, 'recall': 0.00013983471536643688, 'f1-score': 0.0002795834207031523, 'support': 71513}, '1': {'precision': 0.30998811944186233, 'recall': 0.9996473341669071, 'f1-score': 0.4732290903847832, 'support': 62382}, '2': {'precision': 0.25806451612903225, 'recall': 0.00011882305761433007, 'f1-score': 0.00023753674396508208, 'support': 67327}, 'accuracy': 0.3099959248988679, 'macro avg': {'precision': 0.3408660300387831, 'recall': 0.33330199731329596, 'f1-score': 0.15791540351648384, 'support': 201222}, 'weighted avg': {'precision': 0.3439897110422851, 'recall': 0.3099959248988679, 'f1-score': 0.14688733638423845, 'support': 201222}}
[[   10 71497     6]
 [    5 62360    17]
 [    7 67312     8]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0619646
{'0': {'precision': 0.35602094240837695, 'recall': 0.00020641839795038674, 'f1-score': 0.00041259757477572594, 'support': 329428}, '1': {'precision': 0.45952092025032093, 'recall': 0.999723630836253, 'f1-score': 0.629632534856198, 'support': 549989}, '2': {'precision': 0.384, 'recall': 0.0003022974607013301, 'f1-score': 0.0006041193387410405, 'support': 317568}, 'accuracy': 0.45948863185420036, 'macro avg': {'precision': 0.3998472875528993, 'recall': 0.33341078223163495, 'f1-score': 0.21021641725657159, 'support': 1196985}, 'weighted avg': {'precision': 0.4109999961764438, 'recall': 0.45948863185420036, 'f1-score': 0.2895765096279853, 'support': 1196985}}
[[    68 329289     71]
 [    69 549837     83]
 [    54 317418     96]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128799
{'0': {'precision': 0.375, 'recall': 0.0002152935721067856, 'f1-score': 0.00043034007900602473, 'support': 181148}, '1': {'precision': 0.3330415332856067, 'recall': 0.9995936384941244, 'f1-score': 0.4996209091225263, 'support': 179643}, '2': {'precision': 0.30578512396694213, 'recall': 0.00020714829578537196, 'f1-score': 0.00041401612424959576, 'support': 178616}, 'accuracy': 0.3330435088903184, 'macro avg': {'precision': 0.3379422190841829, 'recall': 0.3333386934540055, 'f1-score': 0.16682175510859398, 'support': 539407}, 'weighted avg': {'precision': 0.33810683930039015, 'recall': 0.3330435088903184, 'f1-score': 0.16667433705194545, 'support': 539407}}
[[    39 181068     41]
 [    30 179570     43]
 [    35 178544     37]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1085347
{'0': {'precision': 0.35714285714285715, 'recall': 0.0002236569400748505, 'f1-score': 0.0004470339298752775, 'support': 67067}, '1': {'precision': 0.34523360364553984, 'recall': 0.9995460284583411, 'f1-score': 0.5132095537086541, 'support': 70489}, '2': {'precision': 0.4090909090909091, 'recall': 0.00040518030523582993, 'f1-score': 0.0008095587904591997, 'support': 66637}, 'accuracy': 0.3452566934223994, 'macro avg': {'precision': 0.370489123293102, 'recall': 0.33339162190121724, 'f1-score': 0.17148871547632952, 'support': 204193}, 'weighted avg': {'precision': 0.3699845851545419, 'recall': 0.3452566934223994, 'f1-score': 0.17757492188793977, 'support': 204193}}
[[   15 67034    18]
 [   11 70457    21]
 [   16 66594    27]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007999
{'0': {'precision': 0.39591836734693875, 'recall': 0.0002800643281776474, 'f1-score': 0.0005597327132033445, 'support': 346349}, '1': {'precision': 0.36352057610158584, 'recall': 0.9997736822649879, 'f1-score': 0.53317660911097, 'support': 397671}, '2': {'precision': 0.43333333333333335, 'recall': 0.00014855402652832098, 'f1-score': 0.0002970062342750906, 'support': 350041}, 'accuracy': 0.363535488423406, 'macro avg': {'precision': 0.397590758927286, 'recall': 0.3334007668732313, 'f1-score': 0.1780111160194828, 'support': 1094061}, 'weighted avg': {'precision': 0.3961131554497162, 'recall': 0.363535488423406, 'f1-score': 0.19407208788770067, 'support': 1094061}}
[[    97 346217     35]
 [    57 397581     33]
 [    91 349898     52]]
Evaluating performance on  train set...
1972/1972 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1139376
{'0': {'precision': 0.3870967741935484, 'recall': 0.00021734930448222566, 'f1-score': 0.00043445466887916725, 'support': 165632}, '1': {'precision': 0.33085882198984023, 'recall': 0.999544752069581, 'f1-score': 0.4971547065027619, 'support': 166942}, '2': {'precision': 0.4084507042253521, 'recall': 0.0003372034208705662, 'f1-score': 0.0006738505329809174, 'support': 172003}, 'accuracy': 0.33089102357023803, 'macro avg': {'precision': 0.3754687668029136, 'recall': 0.3333664349316446, 'f1-score': 0.1660876705682073, 'support': 504577}, 'weighted avg': {'precision': 0.37576939266499854, 'recall': 0.33089102357023803, 'f1-score': 0.16485861409046423, 'support': 504577}}
[[    36 165561     35]
 [    27 166866     49]
 [    30 171915     58]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1092108
{'0': {'precision': 0.3953488372093023, 'recall': 0.00028210149015963623, 'f1-score': 0.0005638006798772904, 'support': 60262}, '1': {'precision': 0.34657751109831836, 'recall': 0.9993615527038243, 'f1-score': 0.5146685298590276, 'support': 62652}, '2': {'precision': 0.32075471698113206, 'recall': 0.00029391424619640386, 'f1-score': 0.0005872903459831067, 'support': 57840}, 'accuracy': 0.34658154176394435, 'macro avg': {'precision': 0.35422702176291754, 'recall': 0.33331252281339346, 'f1-score': 0.171939873628296, 'support': 180754}, 'weighted avg': {'precision': 0.35457438664387786, 'recall': 0.34658154176394435, 'f1-score': 0.17876759221323027, 'support': 180754}}
[[   17 60233    12]
 [   16 62612    24]
 [   10 57813    17]]
testing model on single stock: results/universal/W4/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
12724/12724 - 104s - 104s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0815337
{'0': {'precision': 0.28975853455453787, 'recall': 0.00037262252374665523, 'f1-score': 0.0007442879110960923, 'support': 933921}, '1': {'precision': 0.4159914400751453, 'recall': 0.9982638645504457, 'f1-score': 0.5872620328608317, 'support': 1355309}, '2': {'precision': 0.2622309197651663, 'recall': 0.000969095362909683, 'f1-score': 0.0019310543597978365, 'support': 967913}, 'accuracy': 0.415776034395788, 'macro avg': {'precision': 0.3226602981316165, 'recall': 0.33320186081236736, 'f1-score': 0.19664579171057517, 'support': 3257143}, 'weighted avg': {'precision': 0.3341042254666667, 'recall': 0.415776034395788, 'f1-score': 0.24514911295677058, 'support': 3257143}}
[[    348  932724     849]
 [    563 1352956    1790]
 [    290  966685     938]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1142699
{'0': {'precision': 0.35247524752475246, 'recall': 0.00040409635654919875, 'f1-score': 0.0008072672190551346, 'support': 440489}, '1': {'precision': 0.3293527916283704, 'recall': 0.9990767640810703, 'f1-score': 0.4953950623680797, 'support': 435425}, '2': {'precision': 0.31390728476821195, 'recall': 0.0005311662348606417, 'f1-score': 0.001060537920942939, 'support': 446188}, 'accuracy': 0.3293528033389254, 'macro avg': {'precision': 0.3319117746404449, 'recall': 0.33333734222416006, 'f1-score': 0.16575428916935925, 'support': 1322102}, 'weighted avg': {'precision': 0.3318439667876403, 'recall': 0.3293528033389254, 'f1-score': 0.16378175561004005, 'support': 1322102}}
[[   178 440039    272]
 [   156 435023    246]
 [   171 445780    237]]
Evaluating performance on  val set...
1903/1903 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1116543
{'0': {'precision': 0.3411214953271028, 'recall': 0.0004499063208756533, 'f1-score': 0.0008986274389117991, 'support': 162256}, '1': {'precision': 0.33724307623998667, 'recall': 0.9988858040476365, 'f1-score': 0.5042437542356862, 'support': 164244}, '2': {'precision': 0.34415584415584416, 'recall': 0.0006604402519641867, 'f1-score': 0.0013183505693160123, 'support': 160499}, 'accuracy': 0.3372491524623254, 'macro avg': {'precision': 0.34084013857431117, 'recall': 0.33333205020682544, 'f1-score': 0.1688202440813047, 'support': 486999}, 'weighted avg': {'precision': 0.3408134924115318, 'recall': 0.3372491524623254, 'f1-score': 0.17079380617298756, 'support': 486999}}
[[    73 162095     88]
 [    69 164061    114]
 [    72 160321    106]]
training model: results/universal/W4/deepOF_L2/h1000
Epoch 1/50
9854/9854 - 226s - loss: 3.2614 - accuracy1000: 0.3806 - val_loss: 3.3758 - val_accuracy1000: 0.3339 - 226s/epoch - 23ms/step
Epoch 2/50
9854/9854 - 220s - loss: 3.2450 - accuracy1000: 0.3926 - val_loss: 3.3662 - val_accuracy1000: 0.3303 - 220s/epoch - 22ms/step
Epoch 3/50
9854/9854 - 219s - loss: 3.2424 - accuracy1000: 0.3938 - val_loss: 3.3722 - val_accuracy1000: 0.3328 - 219s/epoch - 22ms/step
Epoch 4/50
9854/9854 - 219s - loss: 3.2391 - accuracy1000: 0.3963 - val_loss: 3.3762 - val_accuracy1000: 0.3311 - 219s/epoch - 22ms/step
Epoch 5/50
9854/9854 - 217s - loss: 3.2376 - accuracy1000: 0.3970 - val_loss: 3.3816 - val_accuracy1000: 0.3310 - 217s/epoch - 22ms/step
Epoch 6/50
9854/9854 - 219s - loss: 3.2356 - accuracy1000: 0.3976 - val_loss: 3.3896 - val_accuracy1000: 0.3290 - 219s/epoch - 22ms/step
Epoch 7/50
9854/9854 - 217s - loss: 3.2346 - accuracy1000: 0.3987 - val_loss: 3.3848 - val_accuracy1000: 0.3308 - 217s/epoch - 22ms/step
Epoch 8/50
9854/9854 - 218s - loss: 3.2334 - accuracy1000: 0.3994 - val_loss: 3.3753 - val_accuracy1000: 0.3306 - 218s/epoch - 22ms/step
Epoch 9/50
9854/9854 - 217s - loss: 3.2311 - accuracy1000: 0.4011 - val_loss: 3.3732 - val_accuracy1000: 0.3311 - 217s/epoch - 22ms/step
Epoch 10/50
9854/9854 - 219s - loss: 3.2309 - accuracy1000: 0.4015 - val_loss: 3.3899 - val_accuracy1000: 0.3305 - 219s/epoch - 22ms/step
Epoch 11/50
9854/9854 - 216s - loss: 3.2290 - accuracy1000: 0.4028 - val_loss: 3.3794 - val_accuracy1000: 0.3312 - 216s/epoch - 22ms/step
Epoch 12/50
9854/9854 - 217s - loss: 3.2284 - accuracy1000: 0.4033 - val_loss: 3.3815 - val_accuracy1000: 0.3311 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W4/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 187s - 187s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1099823
{'0': {'precision': 0.3003795490064747, 'recall': 0.0071553705699087256, 'f1-score': 0.013977775191994413, 'support': 1880266}, '1': {'precision': 0.3732628186739745, 'recall': 0.9715965959339734, 'f1-score': 0.5393290630576075, 'support': 2265996}, '2': {'precision': 0.32321188109563875, 'recall': 0.021566999021995492, 'f1-score': 0.040435831342735644, 'support': 1925349}, 'accuracy': 0.3716661031149723, 'macro avg': {'precision': 0.3322847495920293, 'recall': 0.33343965517529256, 'f1-score': 0.19791422319744587, 'support': 6071611}, 'weighted avg': {'precision': 0.3348207220804769, 'recall': 0.3716661031149723, 'f1-score': 0.2184350286046556, 'support': 6071611}}
[[  13454 1827474   39338]
 [  16751 2201634   47611]
 [  14585 1869240   41524]]
Evaluating performance on  train set...
9854/9854 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1197867
{'0': {'precision': 0.3522307797475277, 'recall': 0.009171416128829383, 'f1-score': 0.017877340488278763, 'support': 842727}, '1': {'precision': 0.3334054471129742, 'recall': 0.9691983954757677, 'f1-score': 0.49613860149926803, 'support': 836385}, '2': {'precision': 0.3642329181701781, 'recall': 0.029698588922555648, 'f1-score': 0.05491921064466944, 'support': 842902}, 'accuracy': 0.3344093252456172, 'macro avg': {'precision': 0.34995638167689336, 'recall': 0.33602280017571756, 'f1-score': 0.18964505087740538, 'support': 2522014}, 'weighted avg': {'precision': 0.3499989922337303, 'recall': 0.3344093252456172, 'f1-score': 0.1888649762544713, 'support': 2522014}}
[[  7729 810730  24268]
 [  6335 810623  19427]
 [  7879 809990  25033]]
Evaluating performance on  val set...
3566/3566 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1230137
{'0': {'precision': 0.36578171091445427, 'recall': 0.009145715751667522, 'f1-score': 0.017845243197752454, 'support': 311840}, '1': {'precision': 0.32902428478532497, 'recall': 0.9710356561522436, 'f1-score': 0.49150704856905275, 'support': 298574}, '2': {'precision': 0.36244280032502246, 'recall': 0.02806895523871032, 'f1-score': 0.05210286550390694, 'support': 301935}, 'accuracy': 0.33019491444611654, 'macro avg': {'precision': 0.35241626534160053, 'recall': 0.33608344238087384, 'f1-score': 0.1871517190902374, 'support': 912349}, 'weighted avg': {'precision': 0.35264754217212124, 'recall': 0.33019491444611654, 'f1-score': 0.18419241414652246, 'support': 912349}}
[[  2852 300489   8499]
 [  2239 289926   6409]
 [  2706 290754   8475]]
testing model out of sample: results/universal/W4/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 95s - 95s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1127489
{'0': {'precision': 0.3892198027536373, 'recall': 0.007804186576055088, 'f1-score': 0.015301563842089857, 'support': 1021503}, '1': {'precision': 0.34876816973521174, 'recall': 0.9737263444234797, 'f1-score': 0.5135821000869345, 'support': 1049911}, '2': {'precision': 0.34675562008711763, 'recall': 0.028851040607868295, 'f1-score': 0.05326987789635612, 'support': 960208}, 'accuracy': 0.3489884292962645, 'macro avg': {'precision': 0.36158119752532225, 'recall': 0.33679385720246774, 'f1-score': 0.19405118060846016, 'support': 3031622}, 'weighted avg': {'precision': 0.36176088393596756, 'recall': 0.3489884292962645, 'f1-score': 0.19989175846093743, 'support': 3031622}}
[[   7972  983350   30181]
 [   5577 1022326   22008]
 [   6933  925572   27703]]
Evaluating performance on  train set...
5528/5528 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233855
{'0': {'precision': 0.3599374021909233, 'recall': 0.006993751235309322, 'f1-score': 0.013720899017166038, 'support': 460411}, '1': {'precision': 0.33434877228398646, 'recall': 0.9748446128558276, 'f1-score': 0.49792200781887663, 'support': 470277}, '2': {'precision': 0.37327470735542484, 'recall': 0.026498457925765457, 'f1-score': 0.049484082407847046, 'support': 483764}, 'accuracy': 0.3354557100559086, 'macro avg': {'precision': 0.3558536272767782, 'recall': 0.33611227400563415, 'f1-score': 0.18704232974796323, 'support': 1414452}, 'weighted avg': {'precision': 0.35599125484117605, 'recall': 0.3354557100559086, 'f1-score': 0.18693963354739504, 'support': 1414452}}
[[  3220 445046  12145]
 [  2452 458447   9378]
 [  3274 467671  12819]]
Evaluating performance on  val set...
1908/1908 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1246145
{'0': {'precision': 0.38807397959183676, 'recall': 0.0071814662701222675, 'f1-score': 0.014101969872537657, 'support': 169464}, '1': {'precision': 0.32857415092741593, 'recall': 0.9745465735530546, 'f1-score': 0.49145226060629094, 'support': 159232}, '2': {'precision': 0.361996884990573, 'recall': 0.027787740924621978, 'f1-score': 0.05161350646922007, 'support': 158919}, 'accuracy': 0.32979297191431767, 'macro avg': {'precision': 0.3595483385032752, 'recall': 0.33650526024926625, 'f1-score': 0.18572257898268288, 'support': 487615}, 'weighted avg': {'precision': 0.3601453422143334, 'recall': 0.32979297191431767, 'f1-score': 0.18220741654363098, 'support': 487615}}
[[  1217 163706   4541]
 [   811 155179   3242]
 [  1108 153395   4416]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1224027
{'0': {'precision': 0.40389876880984954, 'recall': 0.02136821726465107, 'f1-score': 0.040589074287285414, 'support': 55269}, '1': {'precision': 0.28141789067079975, 'recall': 0.9155584585238407, 'f1-score': 0.43050897431172375, 'support': 38275}, '2': {'precision': 0.33108768879713135, 'recall': 0.07068621537604974, 'f1-score': 0.11650002867575371, 'support': 43106}, 'accuracy': 0.2873838272960117, 'macro avg': {'precision': 0.3388014494259268, 'recall': 0.3358709637215138, 'f1-score': 0.1958660257582543, 'support': 136650}, 'weighted avg': {'precision': 0.3466243449108349, 'recall': 0.2873838272960117, 'f1-score': 0.17374971660931024, 'support': 136650}}
[[ 1181 50349  3739]
 [  815 35043  2417]
 [  928 39131  3047]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076834
{'0': {'precision': 0.3408007626310772, 'recall': 0.03349573690621194, 'f1-score': 0.06099641699368709, 'support': 21346}, '1': {'precision': 0.33074476214170206, 'recall': 0.8678946141291677, 'f1-score': 0.4789624025322319, 'support': 21445}, '2': {'precision': 0.3486210574432424, 'recall': 0.10332836562344759, 'f1-score': 0.15940918274925103, 'support': 22143}, 'accuracy': 0.33287645917393044, 'macro avg': {'precision': 0.34005552740534056, 'recall': 0.33490623888627574, 'f1-score': 0.2331226674250567, 'support': 64934}, 'weighted avg': {'precision': 0.3401464653065804, 'recall': 0.33287645917393044, 'f1-score': 0.23259272142587276, 'support': 64934}}
[[  715 18487  2144]
 [  702 18612  2131]
 [  681 19174  2288]]
Evaluating performance on  val set...
81/81 - 1s - 818ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.122464
{'0': {'precision': 0.35443037974683544, 'recall': 0.033925686591276254, 'f1-score': 0.061924069295982306, 'support': 7428}, '1': {'precision': 0.2683751056040552, 'recall': 0.8615078647622492, 'f1-score': 0.40925878210083305, 'support': 5531}, '2': {'precision': 0.3702325581395349, 'recall': 0.1039571633799138, 'f1-score': 0.16233302742938718, 'support': 7657}, 'accuracy': 0.281965463717501, 'macro avg': {'precision': 0.3310126811634752, 'recall': 0.33313023824447974, 'f1-score': 0.21117195960873417, 'support': 20616}, 'weighted avg': {'precision': 0.33721198426125054, 'recall': 0.281965463717501, 'f1-score': 0.19240232351363415, 'support': 20616}}
[[ 252 6412  764]
 [ 176 4765  590]
 [ 283 6578  796]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
1613/1613 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1804249
{'0': {'precision': 0.30666666666666664, 'recall': 0.0004339240570012703, 'f1-score': 0.000866621870270474, 'support': 159014}, '1': {'precision': 0.2445428123213873, 'recall': 0.9955936231310031, 'f1-score': 0.3926427086079138, 'support': 100990}, '2': {'precision': 0.40273037542662116, 'recall': 0.0038602207522850543, 'f1-score': 0.007647142690498101, 'support': 152841}, 'accuracy': 0.2451380057890976, 'macro avg': {'precision': 0.3179799514715584, 'recall': 0.33329592264676317, 'f1-score': 0.1337188243895608, 'support': 412845}, 'weighted avg': {'precision': 0.3270340812175282, 'recall': 0.2451380057890976, 'f1-score': 0.09921299540590495, 'support': 412845}}
[[    69 158448    497]
 [    67 100545    378]
 [    89 152162    590]]
Evaluating performance on  train set...
634/634 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1294873
{'0': {'precision': 0.39204545454545453, 'recall': 0.001254727960430608, 'f1-score': 0.0025014501160092804, 'support': 54992}, '1': {'precision': 0.33267856032821536, 'recall': 0.9937240047534165, 'f1-score': 0.4984771289922972, 'support': 53856}, '2': {'precision': 0.39035087719298245, 'recall': 0.008343019985751246, 'f1-score': 0.01633686992914571, 'support': 53338}, 'accuracy': 0.3331483605243363, 'macro avg': {'precision': 0.37169163068888417, 'recall': 0.33444058423319944, 'f1-score': 0.17243848301248407, 'support': 162186}, 'weighted avg': {'precision': 0.3717745999600416, 'recall': 0.3331483605243363, 'f1-score': 0.1717467597207497, 'support': 162186}}
[[   69 54518   405]
 [   48 53518   290]
 [   59 52834   445]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1699657
{'0': {'precision': 0.42105263157894735, 'recall': 0.0004022323897631857, 'f1-score': 0.0008036970062286518, 'support': 19889}, '1': {'precision': 0.261311893920631, 'recall': 0.995355587808418, 'f1-score': 0.41394920701987353, 'support': 13780}, '2': {'precision': 0.45701357466063347, 'recall': 0.0052990556138509965, 'f1-score': 0.010476635029303459, 'support': 19060}, 'accuracy': 0.2621896868895674, 'macro avg': {'precision': 0.3797927000534039, 'recall': 0.3336856252706774, 'f1-score': 0.14174317968513522, 'support': 52729}, 'weighted avg': {'precision': 0.39230541866395446, 'recall': 0.2621896868895674, 'f1-score': 0.11227008792408852, 'support': 52729}}
[[    8 19818    63]
 [    7 13716    57]
 [    4 18955   101]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
989/989 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002412
{'0': {'precision': 0.3429037520391517, 'recall': 0.01196588981362358, 'f1-score': 0.02312482122818984, 'support': 87833}, '1': {'precision': 0.36941124667156844, 'recall': 0.9612590799031477, 'f1-score': 0.5337158392874826, 'support': 92512}, '2': {'precision': 0.3592847017773416, 'recall': 0.045373175433764804, 'f1-score': 0.08057121199153942, 'support': 72620}, 'accuracy': 0.36872294586207577, 'macro avg': {'precision': 0.35719990016268727, 'recall': 0.33953271505017873, 'f1-score': 0.2124706241690706, 'support': 252965}, 'weighted avg': {'precision': 0.35730039154825965, 'recall': 0.36872294586207577, 'f1-score': 0.22634484439319585, 'support': 252965}}
[[ 1051 83557  3225]
 [  933 88928  2651]
 [ 1081 68244  3295]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1109251
{'0': {'precision': 0.3435672514619883, 'recall': 0.016742661726987747, 'f1-score': 0.03192934782608696, 'support': 28072}, '1': {'precision': 0.33546041403873267, 'recall': 0.9468723820161966, 'f1-score': 0.49540681216327276, 'support': 28648}, '2': {'precision': 0.3812064965197216, 'recall': 0.0550972501676727, 'f1-score': 0.0962789334895986, 'support': 29820}, 'accuracy': 0.3378668823665357, 'macro avg': {'precision': 0.3534113873401476, 'recall': 0.33957076463695235, 'f1-score': 0.20787169782631942, 'support': 86540}, 'weighted avg': {'precision': 0.3538533343036821, 'recall': 0.3378668823665357, 'f1-score': 0.20753146294993277, 'support': 86540}}
[[  470 26107  1495]
 [  350 27126  1172]
 [  548 27629  1643]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1253954
{'0': {'precision': 0.3645224171539961, 'recall': 0.017478268997102534, 'f1-score': 0.033357117374241886, 'support': 10699}, '1': {'precision': 0.2920749820739577, 'recall': 0.9388651081110745, 'f1-score': 0.44554403875201826, 'support': 9111}, '2': {'precision': 0.38856812933025403, 'recall': 0.0574134106807712, 'f1-score': 0.10004459640255685, 'support': 11722}, 'accuracy': 0.29855385005708485, 'macro avg': {'precision': 0.3483885095194026, 'recall': 0.3379189292629827, 'f1-score': 0.19298191750960567, 'support': 31532}, 'weighted avg': {'precision': 0.3525281020809232, 'recall': 0.29855385005708485, 'f1-score': 0.17724731367776936, 'support': 31532}}
[[  187  9880   632]
 [  130  8554   427]
 [  196 10853   673]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0930861
{'0': {'precision': 0.31450258196976294, 'recall': 0.07184888282449257, 'f1-score': 0.11697462657209962, 'support': 70356}, '1': {'precision': 0.37915355206786167, 'recall': 0.8022850789112405, 'f1-score': 0.5149471660464473, 'support': 88137}, '2': {'precision': 0.33798358733880424, 'recall': 0.1474736882489098, 'f1-score': 0.20534736504714335, 'support': 78197}, 'accuracy': 0.36882842536651317, 'macro avg': {'precision': 0.3438799071254763, 'recall': 0.3405358833282142, 'f1-score': 0.2790897192218968, 'support': 236690}, 'weighted avg': {'precision': 0.34633445796105555, 'recall': 0.36882842536651317, 'f1-score': 0.2943652588006837, 'support': 236690}}
[[ 5055 54852 10449]
 [ 5287 70711 12139]
 [ 5731 60934 11532]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019859
{'0': {'precision': 0.33309796999117386, 'recall': 0.06392059889570137, 'f1-score': 0.10725856874893423, 'support': 29521}, '1': {'precision': 0.3346782185226082, 'recall': 0.8064472113252601, 'f1-score': 0.47304232989505063, 'support': 29315}, '2': {'precision': 0.3525191586499266, 'recall': 0.1454276393233108, 'f1-score': 0.2059096645158218, 'support': 29733}, 'accuracy': 0.3370479513147941, 'macro avg': {'precision': 0.34009844905456954, 'recall': 0.3385984831814241, 'f1-score': 0.26207018771993557, 'support': 88569}, 'weighted avg': {'precision': 0.34014078619198557, 'recall': 0.3370479513147941, 'f1-score': 0.2614450672804212, 'support': 88569}}
[[ 1887 23553  4081]
 [ 1813 23641  3861]
 [ 1965 23444  4324]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1039041
{'0': {'precision': 0.3369158878504673, 'recall': 0.06782690498588899, 'f1-score': 0.11292090837901331, 'support': 10630}, '1': {'precision': 0.31124167645906775, 'recall': 0.8099898063200816, 'f1-score': 0.44968873797396713, 'support': 9810}, '2': {'precision': 0.38630434782608697, 'recall': 0.15021132713440405, 'f1-score': 0.21631162507608034, 'support': 11830}, 'accuracy': 0.323644251626898, 'macro avg': {'precision': 0.3448206373785407, 'recall': 0.3426760128134582, 'f1-score': 0.25964042380968694, 'support': 32270}, 'weighted avg': {'precision': 0.34721652211640935, 'recall': 0.323644251626898, 'f1-score': 0.2531999473270393, 'support': 32270}}
[[ 721 8356 1553]
 [ 594 7946 1270]
 [ 825 9228 1777]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068525
{'0': {'precision': 0.38784153005464483, 'recall': 0.0210552078080038, 'f1-score': 0.03994203551028448, 'support': 134836}, '1': {'precision': 0.34665408974531736, 'recall': 0.9196768196768197, 'f1-score': 0.5035172535280186, 'support': 139860}, '2': {'precision': 0.3160965724468048, 'recall': 0.06838504856570543, 'f1-score': 0.11244375947699421, 'support': 132295}, 'accuracy': 0.3452459636699583, 'macro avg': {'precision': 0.350197397415589, 'recall': 0.3363723586835097, 'f1-score': 0.2186343495050991, 'support': 406991}, 'weighted avg': {'precision': 0.3503665623811785, 'recall': 0.3452459636699583, 'f1-score': 0.22281400458118816, 'support': 406991}}
[[  2839 121429  10568]
 [  2228 128626   9006]
 [  2253 120995   9047]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1085789
{'0': {'precision': 0.36852880959344836, 'recall': 0.027927388789148213, 'f1-score': 0.0519202241635075, 'support': 45117}, '1': {'precision': 0.3306868672153835, 'recall': 0.9125424334464892, 'f1-score': 0.48545477227228717, 'support': 44776}, '2': {'precision': 0.3684850753251614, 'recall': 0.08242977351697577, 'f1-score': 0.13472229349480852, 'support': 47774}, 'accuracy': 0.33456093326650543, 'macro avg': {'precision': 0.3559002507113311, 'recall': 0.34096653191753773, 'f1-score': 0.22403242997686776, 'support': 137667}, 'weighted avg': {'precision': 0.3562055936240921, 'recall': 0.33456093326650543, 'f1-score': 0.2216611859506627, 'support': 137667}}
[[ 1260 40116  3741]
 [  908 40860  3008]
 [ 1251 42585  3938]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112468
{'0': {'precision': 0.3825088339222615, 'recall': 0.02187310567791473, 'f1-score': 0.04137996941896025, 'support': 19796}, '1': {'precision': 0.3246605162226599, 'recall': 0.9114189267838435, 'f1-score': 0.4787746304477429, 'support': 17182}, '2': {'precision': 0.3181377303588749, 'recall': 0.07945255253436687, 'f1-score': 0.1271502640887726, 'support': 16513}, 'accuracy': 0.32538183993569014, 'macro avg': {'precision': 0.34176902683459875, 'recall': 0.33758152833204175, 'f1-score': 0.21576828798515857, 'support': 53491}, 'weighted avg': {'precision': 0.3440554524588983, 'recall': 0.32538183993569014, 'f1-score': 0.20835459957504543, 'support': 53491}}
[[  433 17734  1629]
 [  339 15660  1183]
 [  360 14841  1312]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
3782/3782 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1981342
{'0': {'precision': 0.3858839050131926, 'recall': 0.0016629948120247316, 'f1-score': 0.0033117175359689316, 'support': 351775}, '1': {'precision': 0.2189367397304893, 'recall': 0.9893990932379708, 'f1-score': 0.3585357743363021, 'support': 211963}, '2': {'precision': 0.39284043051006085, 'recall': 0.008307562900472527, 'f1-score': 0.016271035328206843, 'support': 404210}, 'accuracy': 0.22073396504770917, 'macro avg': {'precision': 0.33255369175124755, 'recall': 0.33312321698348935, 'f1-score': 0.12603950906682596, 'support': 967948}, 'weighted avg': {'precision': 0.3522305219557055, 'recall': 0.22073396504770917, 'f1-score': 0.08651106563769496, 'support': 967948}}
[[   585 347859   3331]
 [   388 209716   1859]
 [   543 400309   3358]]
Evaluating performance on  train set...
1601/1601 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1335875
{'0': {'precision': 0.394109396914446, 'recall': 0.002029261810881465, 'f1-score': 0.004037733409010899, 'support': 138474}, '1': {'precision': 0.32861578471168157, 'recall': 0.9895411505478799, 'f1-score': 0.4933841077546052, 'support': 134336}, '2': {'precision': 0.3662314671387475, 'recall': 0.012085584927705565, 'f1-score': 0.023399006072430884, 'support': 136940}, 'accuracy': 0.3291446003660769, 'macro avg': {'precision': 0.36298554958829166, 'recall': 0.334551999095489, 'f1-score': 0.17360694907868232, 'support': 409750}, 'weighted avg': {'precision': 0.3633204924791691, 'recall': 0.3291446003660769, 'f1-score': 0.17093991088947086, 'support': 409750}}
[[   281 136553   1640]
 [   181 132931   1224]
 [   251 135034   1655]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1539685
{'0': {'precision': 0.45555555555555555, 'recall': 0.0016411816507885678, 'f1-score': 0.003270580727504786, 'support': 49964}, '1': {'precision': 0.2966341803509709, 'recall': 0.990073028840203, 'f1-score': 0.4564977942141638, 'support': 40395}, '2': {'precision': 0.3159722222222222, 'recall': 0.007947771785410162, 'f1-score': 0.015505527038827713, 'support': 45799}, 'accuracy': 0.2970078878949456, 'macro avg': {'precision': 0.3560539860429162, 'recall': 0.3332206607588006, 'f1-score': 0.1584246339934988, 'support': 136158}, 'weighted avg': {'precision': 0.3614560091849969, 'recall': 0.2970078878949456, 'f1-score': 0.14184827425198274, 'support': 136158}}
[[   82 49437   445]
 [   58 39994   343]
 [   40 45395   364]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
4457/4457 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0851107
{'0': {'precision': 0.3881278538812785, 'recall': 0.0026392672152202447, 'f1-score': 0.005242882856614163, 'support': 354265}, '1': {'precision': 0.4135368161265111, 'recall': 0.9913909341091701, 'f1-score': 0.5836266674345625, 'support': 470202}, '2': {'precision': 0.30701211424529135, 'recall': 0.01097040014155355, 'f1-score': 0.021183842439070524, 'support': 316488}, 'accuracy': 0.41242730870192074, 'macro avg': {'precision': 0.3695589280843603, 'recall': 0.3350002004886479, 'f1-score': 0.2033511309100824, 'support': 1140955}, 'weighted avg': {'precision': 0.3760986210541456, 'recall': 0.41242730870192074, 'f1-score': 0.24802400454191545, 'support': 1140955}}
[[   935 348821   4509]
 [   720 466154   3328]
 [   754 312262   3472]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1315646
{'0': {'precision': 0.3469613259668508, 'recall': 0.0015388988541574773, 'f1-score': 0.0030642068437205716, 'support': 204042}, '1': {'precision': 0.3308683919630665, 'recall': 0.9932558718322849, 'f1-score': 0.49638388496718, 'support': 204919}, '2': {'precision': 0.3925894195759263, 'recall': 0.008655494326472214, 'f1-score': 0.01693756294988958, 'support': 211773}, 'accuracy': 0.33135610422499817, 'macro avg': {'precision': 0.3568063791686145, 'recall': 0.33448342167097156, 'f1-score': 0.17212855158693005, 'support': 620734}, 'weighted avg': {'precision': 0.3572153966714574, 'recall': 0.33135610422499817, 'f1-score': 0.17065383036048123, 'support': 620734}}
[[   314 202041   1687]
 [   233 203537   1149]
 [   358 209582   1833]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1189054
{'0': {'precision': 0.3356643356643357, 'recall': 0.0014128451168540649, 'f1-score': 0.0028138464695020076, 'support': 67948}, '1': {'precision': 0.3503858775829712, 'recall': 0.9926927396539714, 'f1-score': 0.5179525789331186, 'support': 70341}, '2': {'precision': 0.3896969696969697, 'recall': 0.010217215133554733, 'f1-score': 0.019912360837991423, 'support': 62933}, 'accuracy': 0.3506873005933745, 'macro avg': {'precision': 0.35858239431475886, 'recall': 0.3347742666347934, 'f1-score': 0.180226262080204, 'support': 201222}, 'weighted avg': {'precision': 0.3577094586512581, 'recall': 0.3506873005933745, 'f1-score': 0.18823807634981035, 'support': 201222}}
[[   96 67265   587]
 [   94 69827   420]
 [   96 62194   643]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1222582
{'0': {'precision': 0.3850085178875639, 'recall': 0.002225680014181324, 'f1-score': 0.004425775245033242, 'support': 406168}, '1': {'precision': 0.34306497890295357, 'recall': 0.9931401768700836, 'f1-score': 0.509969015391949, 'support': 409340}, '2': {'precision': 0.3901629137698454, 'recall': 0.009856426468699293, 'f1-score': 0.01922713070869363, 'support': 381477}, 'accuracy': 0.3435264435226841, 'macro avg': {'precision': 0.3727454701867876, 'recall': 0.33507409445098807, 'f1-score': 0.177873973781892, 'support': 1196985}, 'weighted avg': {'precision': 0.3723075360289982, 'recall': 0.3435264435226841, 'f1-score': 0.1820265359896953, 'support': 1196985}}
[[   904 401659   3605]
 [   536 406532   2272]
 [   908 376809   3760]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233951
{'0': {'precision': 0.40439932318104904, 'recall': 0.002646630529270737, 'f1-score': 0.005258844044469137, 'support': 180607}, '1': {'precision': 0.3382589914545967, 'recall': 0.9916147751735681, 'f1-score': 0.5044427857421938, 'support': 181629}, '2': {'precision': 0.41194805194805195, 'recall': 0.013427705437120071, 'f1-score': 0.02600767439572333, 'support': 177171}, 'accuracy': 0.33919285437526764, 'macro avg': {'precision': 0.3848687888612326, 'recall': 0.33589637037998626, 'f1-score': 0.17856976806079547, 'support': 539407}, 'weighted avg': {'precision': 0.38460798475428565, 'recall': 0.33919285437526764, 'f1-score': 0.18015900508942795, 'support': 539407}}
[[   478 178011   2118]
 [   245 180106   1278]
 [   459 174333   2379]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.141473
{'0': {'precision': 0.4255663430420712, 'recall': 0.0036739027184086274, 'f1-score': 0.007284914963159936, 'support': 71586}, '1': {'precision': 0.30218201912689363, 'recall': 0.9893565001955926, 'f1-score': 0.4629606324436258, 'support': 61352}, '2': {'precision': 0.4205469327420547, 'recall': 0.015970809066030454, 'f1-score': 0.03077297494625546, 'support': 71255}, 'accuracy': 0.3041240395116385, 'macro avg': {'precision': 0.3827650983036732, 'recall': 0.33633373732667726, 'f1-score': 0.16700617411768037, 'support': 204193}, 'weighted avg': {'precision': 0.38674261685277156, 'recall': 0.3041240395116385, 'f1-score': 0.1523939947697988, 'support': 204193}}
[[  263 70300  1023]
 [  108 60699   545]
 [  247 69870  1138]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
4274/4274 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1453815
{'0': {'precision': 0.37837285363859363, 'recall': 0.004754687901361418, 'f1-score': 0.009391362584730285, 'support': 389300}, '1': {'precision': 0.2839549899787206, 'recall': 0.9805314144087595, 'f1-score': 0.4403792511903369, 'support': 309062}, '2': {'precision': 0.3932087511394713, 'recall': 0.02180192520072075, 'f1-score': 0.041313191536231045, 'support': 395699}, 'accuracy': 0.28656811640301594, 'macro avg': {'precision': 0.35184553158559523, 'recall': 0.33569600917028053, 'f1-score': 0.16369460177043274, 'support': 1094061}, 'weighted avg': {'precision': 0.3570665243084668, 'recall': 0.28656811640301594, 'f1-score': 0.142686868614564, 'support': 1094061}}
[[  1851 379047   8402]
 [  1106 303045   4911]
 [  1935 385137   8627]]
Evaluating performance on  train set...
1972/1972 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1215489
{'0': {'precision': 0.37452615617892343, 'recall': 0.003052510597278693, 'f1-score': 0.006055665540933971, 'support': 161834}, '1': {'precision': 0.33974066645412027, 'recall': 0.9875593146771933, 'f1-score': 0.5055587500957112, 'support': 170489}, '2': {'precision': 0.3944010416666667, 'recall': 0.017584497312108864, 'f1-score': 0.0336679004523881, 'support': 172254}, 'accuracy': 0.3406635657194046, 'macro avg': {'precision': 0.36955595476657016, 'recall': 0.33606544086219364, 'f1-score': 0.18176077202967775, 'support': 504577}, 'weighted avg': {'precision': 0.36955760859770936, 'recall': 0.3406635657194046, 'f1-score': 0.18425661266118917, 'support': 504577}}
[[   494 158515   2825]
 [   295 168368   1826]
 [   530 168695   3029]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1349356
{'0': {'precision': 0.3909952606635071, 'recall': 0.0025946251945968895, 'f1-score': 0.005155041787081152, 'support': 63593}, '1': {'precision': 0.3167549434034481, 'recall': 0.9861215763926613, 'f1-score': 0.47949115572066386, 'support': 57067}, '2': {'precision': 0.36540621490078623, 'recall': 0.01624122208539954, 'f1-score': 0.031100135425794637, 'support': 60094}, 'accuracy': 0.3176471889972006, 'macro avg': {'precision': 0.35771880632258046, 'recall': 0.3349858078908859, 'f1-score': 0.1719154443111799, 'support': 180754}, 'weighted avg': {'precision': 0.35904896735246156, 'recall': 0.3176471889972006, 'f1-score': 0.16353650759681487, 'support': 180754}}
[[  165 62411  1017]
 [  114 56275   678]
 [  143 58975   976]]
testing model on single stock: results/universal/W4/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
12724/12724 - 100s - 100s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0715708
{'0': {'precision': 0.28456235132846835, 'recall': 0.00790411141459853, 'f1-score': 0.015380994512702724, 'support': 892953}, '1': {'precision': 0.447864236459942, 'recall': 0.9714942503466005, 'f1-score': 0.6130903992206268, 'support': 1455566}, '2': {'precision': 0.2987941521715932, 'recall': 0.024652661607001355, 'f1-score': 0.04554734076731002, 'support': 908624}, 'accuracy': 0.44318962968466535, 'macro avg': {'precision': 0.3437402466533346, 'recall': 0.33468367445606684, 'f1-score': 0.22467291150021318, 'support': 3257143}, 'weighted avg': {'precision': 0.3615095493920972, 'recall': 0.44318962968466535, 'f1-score': 0.2909032401041123, 'support': 3257143}}
[[   7058  864460   21435]
 [  10359 1414074   31133]
 [   7386  878838   22400]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1139733
{'0': {'precision': 0.3647702861894533, 'recall': 0.011987256708104379, 'f1-score': 0.023211718743110128, 'support': 439133}, '1': {'precision': 0.3330923562491191, 'recall': 0.962076528476909, 'f1-score': 0.4948549050885121, 'support': 437249}, '2': {'precision': 0.3653059856558751, 'recall': 0.03668222202279458, 'f1-score': 0.06666979287509914, 'support': 445720}, 'accuracy': 0.33452865210097255, 'macro avg': {'precision': 0.35438954269814915, 'recall': 0.336915335735936, 'f1-score': 0.19491213890224046, 'support': 1322102}, 'weighted avg': {'precision': 0.3544742793591878, 'recall': 0.33452865210097255, 'f1-score': 0.19384578811782616, 'support': 1322102}}
[[  5264 418024  15845]
 [  4020 420667  12562]
 [  5147 424223  16350]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102607
{'0': {'precision': 0.3489572578979971, 'recall': 0.010577639246171082, 'f1-score': 0.020532882986866244, 'support': 159771}, '1': {'precision': 0.35872111806956697, 'recall': 0.9677955633034513, 'f1-score': 0.5234290852213658, 'support': 173237}, '2': {'precision': 0.3537451789701604, 'recall': 0.03395003604106733, 'f1-score': 0.061954138768738516, 'support': 153991}, 'accuracy': 0.3584730153450007, 'macro avg': {'precision': 0.35380785164590817, 'recall': 0.3374410795302299, 'f1-score': 0.20197203565899022, 'support': 486999}, 'weighted avg': {'precision': 0.35394445211885944, 'recall': 0.3584730153450007, 'f1-score': 0.2125224558311725, 'support': 486999}}
[[  1690 152689   5392]
 [  1420 167658   4159]
 [  1733 147030   5228]]
training model: results/universal/W4/deepVOL_L2/h300
Epoch 1/50
9854/9854 - 318s - loss: 3.2676 - accuracy300: 0.3770 - val_loss: 3.3543 - val_accuracy300: 0.3381 - 318s/epoch - 32ms/step
Epoch 2/50
9854/9854 - 317s - loss: 3.2553 - accuracy300: 0.3889 - val_loss: 3.3689 - val_accuracy300: 0.3416 - 317s/epoch - 32ms/step
Epoch 3/50
9854/9854 - 318s - loss: 3.2459 - accuracy300: 0.3952 - val_loss: 3.3683 - val_accuracy300: 0.3417 - 318s/epoch - 32ms/step
Epoch 4/50
9854/9854 - 337s - loss: 3.2391 - accuracy300: 0.3998 - val_loss: 3.3995 - val_accuracy300: 0.3436 - 337s/epoch - 34ms/step
Epoch 5/50
9854/9854 - 327s - loss: 3.2362 - accuracy300: 0.4012 - val_loss: 3.4074 - val_accuracy300: 0.3432 - 327s/epoch - 33ms/step
Epoch 6/50
9854/9854 - 332s - loss: 3.2319 - accuracy300: 0.4031 - val_loss: 3.4007 - val_accuracy300: 0.3448 - 332s/epoch - 34ms/step
Epoch 7/50
9854/9854 - 319s - loss: 3.2291 - accuracy300: 0.4045 - val_loss: 3.3800 - val_accuracy300: 0.3443 - 319s/epoch - 32ms/step
Epoch 8/50
9854/9854 - 325s - loss: 3.2258 - accuracy300: 0.4068 - val_loss: 3.3694 - val_accuracy300: 0.3416 - 325s/epoch - 33ms/step
Epoch 9/50
9854/9854 - 319s - loss: 3.2235 - accuracy300: 0.4081 - val_loss: 3.3950 - val_accuracy300: 0.3385 - 319s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 318s - loss: 3.2205 - accuracy300: 0.4093 - val_loss: 3.4116 - val_accuracy300: 0.3402 - 318s/epoch - 32ms/step
Epoch 11/50
9854/9854 - 317s - loss: 3.2178 - accuracy300: 0.4111 - val_loss: 3.3839 - val_accuracy300: 0.3414 - 317s/epoch - 32ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 364s - 364s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995305
{'0': {'precision': 0.3471230183235598, 'recall': 0.19115882672691153, 'f1-score': 0.24654604097381047, 'support': 1837833}, '1': {'precision': 0.38751961276752317, 'recall': 0.8269869009087034, 'f1-score': 0.52774298037135, 'support': 2336956}, '2': {'precision': 0.4170893160680477, 'recall': 0.015911182902951328, 'f1-score': 0.03065301038034169, 'support': 1896842}, 'accuracy': 0.3811382806366197, 'macro avg': {'precision': 0.38391064905304356, 'recall': 0.34468563684618875, 'f1-score': 0.2683140105751674, 'support': 6071631}, 'weighted avg': {'precision': 0.3845297836410893, 'recall': 0.3811382806366197, 'f1-score': 0.2873307834540007, 'support': 6071631}}
[[ 351318 1469786   16729]
 [ 378873 1932632   25451]
 [ 281894 1584767   30181]]
Evaluating performance on  train set...
9854/9854 - 156s - 156s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1216325
{'0': {'precision': 0.3738024494528589, 'recall': 0.18212365195919775, 'f1-score': 0.24491840563962997, 'support': 849659}, '1': {'precision': 0.3274007034841668, 'recall': 0.8263220095443885, 'f1-score': 0.46898341200046606, 'support': 823311}, '2': {'precision': 0.39301135986182156, 'recall': 0.013935591467630255, 'f1-score': 0.026916755293435173, 'support': 849049}, 'accuracy': 0.33580040435857145, 'macro avg': {'precision': 0.36473817093294914, 'recall': 0.3407937509904055, 'f1-score': 0.24693952431117705, 'support': 2522019}, 'weighted avg': {'precision': 0.3651214039486773, 'recall': 0.33580040435857145, 'f1-score': 0.24467300749915596, 'support': 2522019}}
[[154743 687626   7290]
 [132007 680320  10984]
 [127220 709997  11832]]
Evaluating performance on  val set...
3566/3566 - 58s - 58s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1200829
{'0': {'precision': 0.36979344598323394, 'recall': 0.18344745770445428, 'f1-score': 0.24523735352615567, 'support': 306829}, '1': {'precision': 0.33046215184037225, 'recall': 0.8233505200845946, 'f1-score': 0.4716297388762579, 'support': 301201}, '2': {'precision': 0.3977718176191459, 'recall': 0.012670789492708381, 'f1-score': 0.02455925812697442, 'support': 304322}, 'accuracy': 0.33773916207779453, 'macro avg': {'precision': 0.3660091384809174, 'recall': 0.3398229224272524, 'f1-score': 0.24714211684312937, 'support': 912352}, 'weighted avg': {'precision': 0.366141137319319, 'recall': 0.33773916207779453, 'f1-score': 0.24636894912935106, 'support': 912352}}
[[ 56287 248002   2540]
 [ 49909 247994   3298]
 [ 46016 254450   3856]]
testing model out of sample: results/universal/W4/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 183s - 183s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017704
{'0': {'precision': 0.35529810916839744, 'recall': 0.15040723492835845, 'f1-score': 0.21134602115285622, 'support': 962221}, '1': {'precision': 0.3822242432496274, 'recall': 0.8637491056315437, 'f1-score': 0.5299404655067713, 'support': 1150253}, '2': {'precision': 0.39767721265518624, 'recall': 0.010803248154853085, 'f1-score': 0.021035060552588712, 'support': 919168}, 'accuracy': 0.37873370272611345, 'macro avg': {'precision': 0.37839985502440365, 'recall': 0.3416531962382517, 'f1-score': 0.2541071824040721, 'support': 3031642}, 'weighted avg': {'precision': 0.37836329374463756, 'recall': 0.37873370272611345, 'f1-score': 0.27452514004895184, 'support': 3031642}}
[[144725 811087   6409]
 [148092 993530   8631]
 [114517 794721   9930]]
Evaluating performance on  train set...
5528/5528 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1202031
{'0': {'precision': 0.37324938390334794, 'recall': 0.15984083913383884, 'f1-score': 0.22382888355893843, 'support': 466195}, '1': {'precision': 0.33040201318761087, 'recall': 0.8493107595126315, 'f1-score': 0.4757327228433332, 'support': 467326}, '2': {'precision': 0.40255520271767226, 'recall': 0.011333983445023631, 'f1-score': 0.022047224986046065, 'support': 480943}, 'accuracy': 0.3371404291661011, 'macro avg': {'precision': 0.36873553326954367, 'recall': 0.34016186069716464, 'f1-score': 0.24053627712943923, 'support': 1414464}, 'weighted avg': {'precision': 0.3690575048954093, 'recall': 0.3371404291661011, 'f1-score': 0.23844624913232626, 'support': 1414464}}
[[ 74517 388689   2989]
 [ 65320 396905   5101]
 [ 59807 415685   5451]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1160896
{'0': {'precision': 0.38028919211066375, 'recall': 0.1482442748091603, 'f1-score': 0.21332876357197153, 'support': 163750}, '1': {'precision': 0.34030009698952135, 'recall': 0.8643870274317528, 'f1-score': 0.48834420707006104, 'support': 165611}, '2': {'precision': 0.3730769230769231, 'recall': 0.007355171367910221, 'f1-score': 0.014425936942296253, 'support': 158256}, 'accuracy': 0.34574471357643394, 'macro avg': {'precision': 0.364555404059036, 'recall': 0.3399954912029411, 'f1-score': 0.23869963586144294, 'support': 487617}, 'weighted avg': {'precision': 0.36436682090475586, 'recall': 0.34574471357643394, 'f1-score': 0.2421793099681312, 'support': 487617}}
[[ 24275 138678    797]
 [ 21300 143152   1159]
 [ 18258 138834   1164]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.135986
{'0': {'precision': 0.37580256821829855, 'recall': 0.18155910121944127, 'f1-score': 0.24483340087057687, 'support': 51581}, '1': {'precision': 0.2754315393765493, 'recall': 0.7969575155671159, 'f1-score': 0.40937985019232065, 'support': 38061}, '2': {'precision': 0.2903426791277259, 'recall': 0.009912362800986983, 'f1-score': 0.019170249089824547, 'support': 47012}, 'accuracy': 0.29391016728379704, 'macro avg': {'precision': 0.3138589289075246, 'recall': 0.3294763265291814, 'f1-score': 0.22446116671757402, 'support': 136654}, 'weighted avg': {'precision': 0.31844704233049564, 'recall': 0.29391016728379704, 'f1-score': 0.2130299140799828, 'support': 136654}}
[[ 9365 41607   609]
 [ 7198 30333   530]
 [ 8357 38189   466]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1297742
{'0': {'precision': 0.3424373890751331, 'recall': 0.16099573521231225, 'f1-score': 0.2190199911710916, 'support': 21572}, '1': {'precision': 0.3325311909962608, 'recall': 0.8316666666666667, 'f1-score': 0.4750998386712861, 'support': 21600}, '2': {'precision': 0.34196891191709844, 'recall': 0.012130123139128837, 'f1-score': 0.023429179978700747, 'support': 21764}, 'accuracy': 0.3341905876555378, 'macro avg': {'precision': 0.33897916399616407, 'recall': 0.3349308416727026, 'f1-score': 0.2391830032736928, 'support': 64936}, 'weighted avg': {'precision': 0.33898522362960043, 'recall': 0.3341905876555378, 'f1-score': 0.23864679742976175, 'support': 64936}}
[[ 3473 17873   226]
 [ 3354 17964   282]
 [ 3315 18185   264]]
Evaluating performance on  val set...
81/81 - 1s - 797ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1379883
{'0': {'precision': 0.3472829481574016, 'recall': 0.15243317340644277, 'f1-score': 0.2118700581118415, 'support': 7295}, '1': {'precision': 0.30497443049744305, 'recall': 0.8427814356833147, 'f1-score': 0.44787710689140176, 'support': 6227}, '2': {'precision': 0.357487922705314, 'recall': 0.010429880197322057, 'f1-score': 0.02026841961106546, 'support': 7095}, 'accuracy': 0.31207256147839163, 'macro avg': {'precision': 0.3365817671200529, 'recall': 0.33521482976235983, 'f1-score': 0.22667186153810293, 'support': 20617}, 'weighted avg': {'precision': 0.338016282539168, 'recall': 0.31207256147839163, 'f1-score': 0.2172152716534487, 'support': 20617}}
[[1112 6104   79]
 [ 925 5248   54]
 [1165 5856   74]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
1613/1613 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028913
{'0': {'precision': 0.39265731151364003, 'recall': 0.3521210624918309, 'f1-score': 0.3712860484435954, 'support': 137714}, '1': {'precision': 0.3141267215098733, 'recall': 0.6124901055901548, 'f1-score': 0.4152730733984436, 'support': 133914}, '2': {'precision': 0.45510550913468345, 'recall': 0.09102045729742744, 'f1-score': 0.15170094119729738, 'support': 141221}, 'accuracy': 0.347262558465686, 'macro avg': {'precision': 0.38729651405273224, 'recall': 0.35187720845980436, 'f1-score': 0.31275335434644547, 'support': 412849}, 'weighted avg': {'precision': 0.38854600565236136, 'recall': 0.347262558465686, 'f1-score': 0.31044164777742955, 'support': 412849}}
[[48492 83350  5872]
 [42375 82021  9518]
 [32630 95737 12854]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1025996
{'0': {'precision': 0.4163257658557912, 'recall': 0.24407747793929185, 'f1-score': 0.3077384730798084, 'support': 54622}, '1': {'precision': 0.32533917224798214, 'recall': 0.7084174706454267, 'f1-score': 0.4458998258249776, 'support': 53484}, '2': {'precision': 0.3914471283660512, 'recall': 0.09918639053254438, 'f1-score': 0.15826977265686085, 'support': 54080}, 'accuracy': 0.34888954656998755, 'macro avg': {'precision': 0.37770402215660814, 'recall': 0.35056044637242095, 'f1-score': 0.3039693571872156, 'support': 162186}, 'weighted avg': {'precision': 0.37802551991615896, 'recall': 0.34888954656998755, 'f1-score': 0.303460387864991, 'support': 162186}}
[[13332 38167  3123]
 [10379 37889  5216]
 [ 8312 40404  5364]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010321
{'0': {'precision': 0.3944181646168401, 'recall': 0.24597321375892384, 'f1-score': 0.30299066099785604, 'support': 16949}, '1': {'precision': 0.3390345185569686, 'recall': 0.7177866915764602, 'f1-score': 0.46054046431278534, 'support': 18199}, '2': {'precision': 0.3950413223140496, 'recall': 0.08156068706631782, 'f1-score': 0.13520648689421083, 'support': 17582}, 'accuracy': 0.35399203489474684, 'macro avg': {'precision': 0.37616466849595276, 'recall': 0.348440197467234, 'f1-score': 0.2995792040682841, 'support': 52730}, 'weighted avg': {'precision': 0.3755110791624259, 'recall': 0.35399203489474684, 'f1-score': 0.30142167790356644, 'support': 52730}}
[[ 4169 11765  1015]
 [ 3955 13063  1181]
 [ 2446 13702  1434]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139503
{'0': {'precision': 0.3826041580840955, 'recall': 0.1586782695856209, 'f1-score': 0.22432269232317542, 'support': 87794}, '1': {'precision': 0.3442298585420974, 'recall': 0.8506395699124067, 'f1-score': 0.49012140046130176, 'support': 86308}, '2': {'precision': 0.3549862763037511, 'recall': 0.0147590246871315, 'f1-score': 0.028339785260390035, 'support': 78867}, 'accuracy': 0.34989267459649204, 'macro avg': {'precision': 0.3606067643099813, 'recall': 0.34135895472838634, 'f1-score': 0.24759462601495574, 'support': 252969}, 'weighted avg': {'precision': 0.36090130703419926, 'recall': 0.34989267459649204, 'f1-score': 0.25390723023360995, 'support': 252969}}
[[13931 73039   824]
 [11600 73417  1291]
 [10880 66823  1164]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1326185
{'0': {'precision': 0.32732265446224257, 'recall': 0.12676805274912262, 'f1-score': 0.18275668216895793, 'support': 28209}, '1': {'precision': 0.3255212520769684, 'recall': 0.8493165052616858, 'f1-score': 0.47065319526111343, 'support': 28603}, '2': {'precision': 0.2982810920121335, 'recall': 0.009922637066935755, 'f1-score': 0.019206354373514763, 'support': 29730}, 'accuracy': 0.32543735989461764, 'macro avg': {'precision': 0.3170416661837815, 'recall': 0.3286690650259147, 'f1-score': 0.2242054106011954, 'support': 86542}, 'weighted avg': {'precision': 0.31675054884800047, 'recall': 0.32543735989461764, 'f1-score': 0.22172449801116637, 'support': 86542}}
[[ 3576 24438   195]
 [ 3811 24293   499]
 [ 3538 25897   295]]
Evaluating performance on  val set...
124/124 - 1s - 986ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369041
{'0': {'precision': 0.35714285714285715, 'recall': 0.14016501031314457, 'f1-score': 0.20131968758416371, 'support': 10666}, '1': {'precision': 0.3064373897707231, 'recall': 0.8655043586550436, 'f1-score': 0.45262129599479, 'support': 9636}, '2': {'precision': 0.36153846153846153, 'recall': 0.004185218165627782, 'f1-score': 0.008274647887323943, 'support': 11230}, 'accuracy': 0.31339591526068755, 'macro avg': {'precision': 0.34170623615068063, 'recall': 0.336618195711272, 'f1-score': 0.22073854382209254, 'support': 31532}, 'weighted avg': {'precision': 0.34321303200536996, 'recall': 0.31339591526068755, 'f1-score': 0.20936378573363995, 'support': 31532}}
[[1495 9142   29]
 [1242 8340   54]
 [1449 9734   47]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027346
{'0': {'precision': 0.311689452267338, 'recall': 0.1476842411884649, 'f1-score': 0.20041034521703122, 'support': 72093}, '1': {'precision': 0.37823275323961947, 'recall': 0.8475974127705289, 'f1-score': 0.5230563123021092, 'support': 89362}, '2': {'precision': 0.35526315789473684, 'recall': 0.01076569332394104, 'f1-score': 0.02089810240070176, 'support': 75239}, 'accuracy': 0.36840815567779495, 'macro avg': {'precision': 0.3483951211338981, 'recall': 0.33534911576097826, 'f1-score': 0.2481215866399474, 'support': 236694}, 'weighted avg': {'precision': 0.35066333626602353, 'recall': 0.36840815567779495, 'f1-score': 0.26516047523046177, 'support': 236694}}
[[10647 60826   620]
 [12769 75743   850]
 [10743 63686   810]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1124253
{'0': {'precision': 0.3388402980239715, 'recall': 0.13995651446730223, 'f1-score': 0.19809199157256824, 'support': 29895}, '1': {'precision': 0.32930385451460686, 'recall': 0.8476287956328898, 'f1-score': 0.47433033583443124, 'support': 29310}, '2': {'precision': 0.3380462724935733, 'recall': 0.008956240422271411, 'f1-score': 0.01745015426467173, 'support': 29365}, 'accuracy': 0.3307101727447217, 'macro avg': {'precision': 0.33539680834405056, 'recall': 0.33218051684082117, 'f1-score': 0.22995749389055709, 'support': 88570}, 'weighted avg': {'precision': 0.33542119766313117, 'recall': 0.3307101727447217, 'f1-score': 0.2296150616614112, 'support': 88570}}
[[ 4184 25449   262]
 [ 4213 24844   253]
 [ 3951 25151   263]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1187478
{'0': {'precision': 0.33778668448007126, 'recall': 0.1401644645662016, 'f1-score': 0.19811936789865484, 'support': 10823}, '1': {'precision': 0.3097867687260798, 'recall': 0.8481189502045704, 'f1-score': 0.4538124733020077, 'support': 10021}, '2': {'precision': 0.4028985507246377, 'recall': 0.012164172573728888, 'f1-score': 0.0236153584777438, 'support': 11427}, 'accuracy': 0.3146788137956679, 'macro avg': {'precision': 0.3501573346435962, 'recall': 0.3334825291148336, 'f1-score': 0.2251823998928021, 'support': 32271}, 'weighted avg': {'precision': 0.3521477560243653, 'recall': 0.3146788137956679, 'f1-score': 0.21572784899915523, 'support': 32271}}
[[1517 9184  122]
 [1438 8499   84]
 [1536 9752  139]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
1590/1590 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126761
{'0': {'precision': 0.3414268205063184, 'recall': 0.12264867080632183, 'f1-score': 0.18046868018943793, 'support': 131734}, '1': {'precision': 0.3641136512630243, 'recall': 0.8852610232028161, 'f1-score': 0.5159951295107372, 'support': 147439}, '2': {'precision': 0.3758278145695364, 'recall': 0.0035518142416798362, 'f1-score': 0.00703712314965512, 'support': 127822}, 'accuracy': 0.361510583668104, 'macro avg': {'precision': 0.36045609544629303, 'recall': 0.33715383608360594, 'f1-score': 0.23450031094994342, 'support': 406995}, 'weighted avg': {'precision': 0.36044948049744013, 'recall': 0.361510583668104, 'f1-score': 0.2475489039699363, 'support': 406995}}
[[ 16157 115295    282]
 [ 16445 130522    472]
 [ 14720 112648    454]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1304927
{'0': {'precision': 0.33361963190184046, 'recall': 0.12034967356423591, 'f1-score': 0.17688867203382938, 'support': 45185}, '1': {'precision': 0.3318750880332745, 'recall': 0.8802909762208254, 'f1-score': 0.482024128283041, 'support': 45502}, '2': {'precision': 0.3431952662721893, 'recall': 0.004938061385211357, 'f1-score': 0.0097360359226153, 'support': 46982}, 'accuracy': 0.3321372276983199, 'macro avg': {'precision': 0.33622999540243476, 'recall': 0.33519290372342425, 'f1-score': 0.2228829454131619, 'support': 137669}, 'weighted avg': {'precision': 0.3363108856981217, 'recall': 0.3321372276983199, 'f1-score': 0.22069743348684034, 'support': 137669}}
[[ 5438 39559   188]
 [ 5191 40055   256]
 [ 5671 41079   232]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279742
{'0': {'precision': 0.35681917848267797, 'recall': 0.12808269493126245, 'f1-score': 0.188501486543882, 'support': 19058}, '1': {'precision': 0.3278043113463276, 'recall': 0.8727803872150304, 'f1-score': 0.47660306537378794, 'support': 17458}, '2': {'precision': 0.33136094674556216, 'recall': 0.003298774740810556, 'f1-score': 0.006532516768737241, 'support': 16976}, 'accuracy': 0.3315262095266582, 'macro avg': {'precision': 0.3386614788581892, 'recall': 0.33472061896236777, 'f1-score': 0.22387902289546904, 'support': 53492}, 'weighted avg': {'precision': 0.33927037693411594, 'recall': 0.3315262095266582, 'f1-score': 0.22477928756664503, 'support': 53492}}
[[ 2441 16554    63]
 [ 2171 15237    50]
 [ 2229 14691    56]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
3782/3782 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999712
{'0': {'precision': 0.4142363429643934, 'recall': 0.29674627261238723, 'f1-score': 0.3457836747683332, 'support': 309399}, '1': {'precision': 0.3301376295823061, 'recall': 0.7650508840249153, 'f1-score': 0.4612394710567897, 'support': 316111}, '2': {'precision': 0.503705856706874, 'recall': 0.020242844043662868, 'f1-score': 0.03892151688358357, 'support': 342442}, 'accuracy': 0.35186248904904377, 'macro avg': {'precision': 0.41602660975119116, 'recall': 0.3606800002269885, 'f1-score': 0.2819815542362355, 'support': 967952}, 'weighted avg': {'precision': 0.4184241444659942, 'recall': 0.35186248904904377, 'f1-score': 0.2749272233638946, 'support': 967952}}
[[ 91813 214681   2905]
 [ 70345 241841   3925]
 [ 59486 276024   6932]]
Evaluating performance on  train set...
1601/1601 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101289
{'0': {'precision': 0.41469006030766026, 'recall': 0.23182844243792325, 'f1-score': 0.29739891547526187, 'support': 137330}, '1': {'precision': 0.332801281834841, 'recall': 0.802577521818626, 'f1-score': 0.4705016989459158, 'support': 135091}, '2': {'precision': 0.4501111728738188, 'recall': 0.023585352178313708, 'f1-score': 0.04482207476803642, 'support': 137331}, 'accuracy': 0.35020451394990143, 'macro avg': {'precision': 0.39920083833877335, 'recall': 0.35266377214495437, 'f1-score': 0.2709075630630714, 'support': 409752}, 'weighted avg': {'precision': 0.39956378840941814, 'recall': 0.35020451394990143, 'f1-score': 0.26981637289016197, 'support': 409752}}
[[ 31837 103885   1608]
 [ 24321 108421   2349]
 [ 20615 113477   3239]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092631
{'0': {'precision': 0.4337743250519191, 'recall': 0.24428224898206705, 'f1-score': 0.31255022584310144, 'support': 46172}, '1': {'precision': 0.3394922804775268, 'recall': 0.7995811883779775, 'f1-score': 0.47661831917148295, 'support': 45844}, '2': {'precision': 0.4915254237288136, 'recall': 0.024307915364052378, 'f1-score': 0.04632487857528332, 'support': 44142}, 'accuracy': 0.3599347816507293, 'macro avg': {'precision': 0.4215973430860865, 'recall': 0.356057117574699, 'f1-score': 0.27849780786328926, 'support': 136158}, 'weighted avg': {'precision': 0.4207525631747399, 'recall': 0.3599347816507293, 'f1-score': 0.2814820432276862, 'support': 136158}}
[[11279 34460   433]
 [ 8511 36656   677]
 [ 6212 36857  1073]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081676
{'0': {'precision': 0.401603644764857, 'recall': 0.15855256938607093, 'f1-score': 0.22734832942555686, 'support': 391397}, '1': {'precision': 0.33881433394084354, 'recall': 0.8590155960711708, 'f1-score': 0.4859567952601272, 'support': 382404}, '2': {'precision': 0.4351966873706004, 'recall': 0.020037694943321405, 'f1-score': 0.03831142286551946, 'support': 367158}, 'accuracy': 0.3487460986766396, 'macro avg': {'precision': 0.391871555358767, 'recall': 0.34586862013352104, 'f1-score': 0.25053884918373454, 'support': 1140959}, 'weighted avg': {'precision': 0.3913693337341307, 'recall': 0.3487460986766396, 'f1-score': 0.2531919392574902, 'support': 1140959}}
[[ 62057 325141   4199]
 [ 48564 328491   5349]
 [ 43902 315899   7357]]
Evaluating performance on  train set...
2425/2425 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1119128
{'0': {'precision': 0.3924275929022167, 'recall': 0.17676497740634567, 'f1-score': 0.2437398455688994, 'support': 205810}, '1': {'precision': 0.3303703361210167, 'recall': 0.8357824143796393, 'f1-score': 0.4735532580000221, 'support': 205179}, '2': {'precision': 0.40321320986276915, 'recall': 0.01723020004958331, 'f1-score': 0.03304817773225856, 'support': 209748}, 'accuracy': 0.3406901795768578, 'macro avg': {'precision': 0.3753370462953342, 'recall': 0.3432591972785228, 'f1-score': 0.2501137604337267, 'support': 620737}, 'weighted avg': {'precision': 0.3755596048446853, 'recall': 0.3406901795768578, 'f1-score': 0.2485095470750213, 'support': 620737}}
[[ 36380 167427   2003]
 [ 30348 171485   3346]
 [ 25977 180157   3614]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1093457
{'0': {'precision': 0.41660810061031994, 'recall': 0.16419324741967462, 'f1-score': 0.23555123338666337, 'support': 68596}, '1': {'precision': 0.3306204430409139, 'recall': 0.8578055576474132, 'f1-score': 0.47728348815674243, 'support': 66395}, '2': {'precision': 0.40717628705148207, 'recall': 0.011822258459029759, 'f1-score': 0.022977374768905715, 'support': 66231}, 'accuracy': 0.34290485135820137, 'macro avg': {'precision': 0.38480161023423864, 'recall': 0.3446070211753725, 'f1-score': 0.24527069877077048, 'support': 201222}, 'weighted avg': {'precision': 0.3851312791487695, 'recall': 0.34290485135820137, 'f1-score': 0.24534555918278256, 'support': 201222}}
[[11263 56881   452]
 [ 8753 56954   688]
 [ 7019 58429   783]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
4676/4676 - 41s - 41s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074289
{'0': {'precision': 0.4095374973493862, 'recall': 0.17121496431790312, 'f1-score': 0.24147619725696265, 'support': 406086}, '1': {'precision': 0.3290539681162478, 'recall': 0.8531084566482706, 'f1-score': 0.474924117046876, 'support': 391207}, '2': {'precision': 0.43346183500385504, 'recall': 0.014065689924342501, 'f1-score': 0.027247216877571694, 'support': 399696}, 'accuracy': 0.3416004658355256, 'macro avg': {'precision': 0.3906844334898297, 'recall': 0.3461297036301721, 'f1-score': 0.24788251039380346, 'support': 1196989}, 'weighted avg': {'precision': 0.39122215948281613, 'recall': 0.3416004658355256, 'f1-score': 0.24623814061277594, 'support': 1196989}}
[[ 69528 333529   3029]
 [ 53146 333742   4319]
 [ 47098 346976   5622]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1121275
{'0': {'precision': 0.4117412981905854, 'recall': 0.18981126781841137, 'f1-score': 0.2598380997400142, 'support': 185342}, '1': {'precision': 0.32215592265823995, 'recall': 0.84104493619883, 'f1-score': 0.4658655559872962, 'support': 172489}, '2': {'precision': 0.45977011494252873, 'recall': 0.009252222185507055, 'f1-score': 0.018139414356050793, 'support': 181578}, 'accuracy': 0.3372783917213098, 'macro avg': {'precision': 0.39788911193045134, 'recall': 0.34670280873424947, 'f1-score': 0.24794769002778708, 'support': 539409}, 'weighted avg': {'precision': 0.3992618709804084, 'recall': 0.3372783917213098, 'f1-score': 0.24435876217981056, 'support': 539409}}
[[ 35180 149322    840]
 [ 26284 145071   1134]
 [ 23978 155920   1680]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1191639
{'0': {'precision': 0.4100149735084082, 'recall': 0.1995906981959883, 'f1-score': 0.2684856084247047, 'support': 71341}, '1': {'precision': 0.3092589728642977, 'recall': 0.8322714903153514, 'f1-score': 0.45095148056273526, 'support': 62470}, '2': {'precision': 0.4617668893838159, 'recall': 0.008837486857435139, 'f1-score': 0.017343055110206472, 'support': 70382}, 'accuracy': 0.3274010372539705, 'macro avg': {'precision': 0.3936802785855073, 'recall': 0.34689989178959163, 'f1-score': 0.24559338136588216, 'support': 204193}, 'weighted avg': {'precision': 0.3970281227491038, 'recall': 0.3274010372539705, 'f1-score': 0.23774375069736708, 'support': 204193}}
[[14239 56775   327]
 [10080 51992   398]
 [10409 59351   622]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
4274/4274 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0842211
{'0': {'precision': 0.29783391013002053, 'recall': 0.14414360308960178, 'f1-score': 0.19426713642362664, 'support': 299715}, '1': {'precision': 0.45426955791741247, 'recall': 0.8672488766049581, 'f1-score': 0.5962304474732439, 'support': 496041}, '2': {'precision': 0.24454365079365079, 'recall': 0.0016526487635304332, 'f1-score': 0.0032831099642054436, 'support': 298309}, 'accuracy': 0.43314245497296777, 'macro avg': {'precision': 0.3322157062803613, 'recall': 0.3376817094860301, 'f1-score': 0.2645935646203587, 'support': 1094065}, 'weighted avg': {'precision': 0.35423049643132126, 'recall': 0.43314245497296777, 'f1-score': 0.3244404157326985, 'support': 1094065}}
[[ 43202 256021    492]
 [ 64819 430191   1031]
 [ 37033 260783    493]]
Evaluating performance on  train set...
1972/1972 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1239607
{'0': {'precision': 0.3658094946043428, 'recall': 0.1514396774252051, 'f1-score': 0.21420265070542968, 'support': 165419}, '1': {'precision': 0.3302954870234638, 'recall': 0.860972591052739, 'f1-score': 0.4774330253772268, 'support': 166442}, '2': {'precision': 0.4609200535953551, 'recall': 0.005975023014260157, 'f1-score': 0.011797117022371083, 'support': 172719}, 'accuracy': 0.3356950334932023, 'macro avg': {'precision': 0.3856750117410539, 'recall': 0.33946243049740144, 'f1-score': 0.23447759770167587, 'support': 504580}, 'weighted avg': {'precision': 0.386651339680628, 'recall': 0.3356950334932023, 'f1-score': 0.23174854758782504, 'support': 504580}}
[[ 25051 139887    481]
 [ 22414 143302    726]
 [ 21016 150671   1032]]
Evaluating performance on  val set...
707/707 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1141676
{'0': {'precision': 0.3551973566708341, 'recall': 0.13683667326051432, 'f1-score': 0.19756367113285567, 'support': 58135}, '1': {'precision': 0.3641728536074624, 'recall': 0.8709310266332803, 'f1-score': 0.5135915162091416, 'support': 65895}, '2': {'precision': 0.2786458333333333, 'recall': 0.003772653550525351, 'f1-score': 0.007444514019341821, 'support': 56724}, 'accuracy': 0.3626973676931078, 'macro avg': {'precision': 0.3326720145372099, 'recall': 0.3371801178147733, 'f1-score': 0.23953323378711303, 'support': 180754}, 'weighted avg': {'precision': 0.33444612439294663, 'recall': 0.3626973676931078, 'f1-score': 0.25311063431593817, 'support': 180754}}
[[ 7955 49989   191]
 [ 8142 57390   363]
 [ 6299 50211   214]]
testing model on single stock: results/universal/W4/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
12724/12724 - 113s - 113s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957917
{'0': {'precision': 0.28269279032132444, 'recall': 0.14318699105026514, 'f1-score': 0.19009087450618403, 'support': 912541}, '1': {'precision': 0.43159060666572896, 'recall': 0.853077657103932, 'f1-score': 0.5731912493612886, 'support': 1406362}, '2': {'precision': 0.2687987313334214, 'recall': 0.00433575914154527, 'f1-score': 0.008533865895793694, 'support': 938244}, 'accuracy': 0.40970456660384075, 'macro avg': {'precision': 0.3276940427734916, 'recall': 0.3335334690985808, 'f1-score': 0.25727199658775546, 'support': 3257147}, 'weighted avg': {'precision': 0.3429812001808436, 'recall': 0.40970456660384075, 'f1-score': 0.30320613623533765, 'support': 3257147}}
[[ 130664  777567    4310]
 [ 199870 1199736    6756]
 [ 131678  802498    4068]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1345624
{'0': {'precision': 0.34077961236826465, 'recall': 0.1593870770899722, 'f1-score': 0.21719105846918554, 'support': 442470}, '1': {'precision': 0.3283353082915831, 'recall': 0.8422472553743385, 'f1-score': 0.47248185789652025, 'support': 432937}, '2': {'precision': 0.2966601178781925, 'recall': 0.0030423443289045097, 'f1-score': 0.006022921670995134, 'support': 446695}, 'accuracy': 0.3301734661924723, 'macro avg': {'precision': 0.3219250128460134, 'recall': 0.3348922255977384, 'f1-score': 0.23189861267890033, 'support': 1322102}, 'weighted avg': {'precision': 0.3217980532561167, 'recall': 0.3301734661924723, 'f1-score': 0.22944206630716202, 'support': 1322102}}
[[ 70524 370641   1305]
 [ 66380 364640   1917]
 [ 70045 375291   1359]]
Evaluating performance on  val set...
1903/1903 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1301495
{'0': {'precision': 0.33531040969899667, 'recall': 0.15887931461397514, 'f1-score': 0.21560095426900977, 'support': 161544}, '1': {'precision': 0.33845727908190393, 'recall': 0.8389112572646614, 'f1-score': 0.4823224211614201, 'support': 164667}, '2': {'precision': 0.2795838751625488, 'recall': 0.004011468446224555, 'f1-score': 0.007909452101829598, 'support': 160789}, 'accuracy': 0.33768377823408624, 'macro avg': {'precision': 0.31778385464781644, 'recall': 0.3339340134416204, 'f1-score': 0.23527760917741983, 'support': 487000}, 'weighted avg': {'precision': 0.3179756494917981, 'recall': 0.33768377823408624, 'f1-score': 0.23721433177786766, 'support': 487000}}
[[ 25666 135246    632]
 [ 25496 138141   1030]
 [ 25382 134762    645]]
training model: results/universal/W4/deepVOL_L2/h500
Epoch 1/50
9854/9854 - 319s - loss: 3.2606 - accuracy500: 0.3835 - val_loss: 3.4421 - val_accuracy500: 0.3341 - 319s/epoch - 32ms/step
Epoch 2/50
9854/9854 - 320s - loss: 3.2519 - accuracy500: 0.3898 - val_loss: 3.5431 - val_accuracy500: 0.3341 - 320s/epoch - 32ms/step
Epoch 3/50
9854/9854 - 316s - loss: 3.2485 - accuracy500: 0.3929 - val_loss: 3.4587 - val_accuracy500: 0.3341 - 316s/epoch - 32ms/step
Epoch 4/50
9854/9854 - 314s - loss: 3.2484 - accuracy500: 0.3924 - val_loss: 3.4179 - val_accuracy500: 0.3350 - 314s/epoch - 32ms/step
Epoch 5/50
9854/9854 - 317s - loss: 3.2437 - accuracy500: 0.3956 - val_loss: 3.3982 - val_accuracy500: 0.3345 - 317s/epoch - 32ms/step
Epoch 6/50
9854/9854 - 314s - loss: 3.2384 - accuracy500: 0.3976 - val_loss: 3.4009 - val_accuracy500: 0.3342 - 314s/epoch - 32ms/step
Epoch 7/50
9854/9854 - 318s - loss: 3.2349 - accuracy500: 0.4004 - val_loss: 3.4258 - val_accuracy500: 0.3350 - 318s/epoch - 32ms/step
Epoch 8/50
9854/9854 - 315s - loss: 3.2314 - accuracy500: 0.4030 - val_loss: 3.4201 - val_accuracy500: 0.3356 - 315s/epoch - 32ms/step
Epoch 9/50
9854/9854 - 317s - loss: 3.2293 - accuracy500: 0.4041 - val_loss: 3.4122 - val_accuracy500: 0.3352 - 317s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 317s - loss: 3.2257 - accuracy500: 0.4060 - val_loss: 3.4135 - val_accuracy500: 0.3348 - 317s/epoch - 32ms/step
Epoch 11/50
9854/9854 - 320s - loss: 3.2239 - accuracy500: 0.4072 - val_loss: 3.4184 - val_accuracy500: 0.3339 - 320s/epoch - 33ms/step
Epoch 12/50
9854/9854 - 316s - loss: 3.2252 - accuracy500: 0.4069 - val_loss: 3.4010 - val_accuracy500: 0.3341 - 316s/epoch - 32ms/step
Epoch 13/50
9854/9854 - 315s - loss: 3.2216 - accuracy500: 0.4086 - val_loss: 3.3751 - val_accuracy500: 0.3389 - 315s/epoch - 32ms/step
Epoch 14/50
9854/9854 - 321s - loss: 3.2201 - accuracy500: 0.4092 - val_loss: 3.4149 - val_accuracy500: 0.3341 - 321s/epoch - 33ms/step
Epoch 15/50
9854/9854 - 322s - loss: 3.2175 - accuracy500: 0.4105 - val_loss: 3.3925 - val_accuracy500: 0.3346 - 322s/epoch - 33ms/step
Epoch 16/50
9854/9854 - 324s - loss: 3.2164 - accuracy500: 0.4112 - val_loss: 3.4309 - val_accuracy500: 0.3350 - 324s/epoch - 33ms/step
Epoch 17/50
9854/9854 - 323s - loss: 3.2144 - accuracy500: 0.4124 - val_loss: 3.4265 - val_accuracy500: 0.3375 - 323s/epoch - 33ms/step
Epoch 18/50
9854/9854 - 320s - loss: 3.2122 - accuracy500: 0.4136 - val_loss: 3.4321 - val_accuracy500: 0.3373 - 320s/epoch - 32ms/step
Epoch 19/50
9854/9854 - 318s - loss: 3.2111 - accuracy500: 0.4143 - val_loss: 3.4847 - val_accuracy500: 0.3388 - 318s/epoch - 32ms/step
Epoch 20/50
9854/9854 - 330s - loss: 3.2101 - accuracy500: 0.4149 - val_loss: 3.4897 - val_accuracy500: 0.3373 - 330s/epoch - 33ms/step
Epoch 21/50
9854/9854 - 314s - loss: 3.2080 - accuracy500: 0.4160 - val_loss: 3.4862 - val_accuracy500: 0.3378 - 314s/epoch - 32ms/step
Epoch 22/50
9854/9854 - 318s - loss: 3.2075 - accuracy500: 0.4159 - val_loss: 3.5013 - val_accuracy500: 0.3361 - 318s/epoch - 32ms/step
Epoch 23/50
9854/9854 - 315s - loss: 3.2056 - accuracy500: 0.4172 - val_loss: 3.5075 - val_accuracy500: 0.3372 - 315s/epoch - 32ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 361s - 361s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1154257
{'0': {'precision': 0.3075456414111529, 'recall': 0.1377072254370578, 'f1-score': 0.19023462902678157, 'support': 1800334}, '1': {'precision': 0.39399559487770663, 'recall': 0.6039385357426931, 'f1-score': 0.47688342418268487, 'support': 2400029}, '2': {'precision': 0.3178088390916236, 'recall': 0.2694638074289733, 'f1-score': 0.29164641099356, 'support': 1871268}, 'accuracy': 0.362608992542531, 'macro avg': {'precision': 0.33978335846016106, 'recall': 0.3370365228695747, 'f1-score': 0.31958815473434216, 'support': 6071631}, 'weighted avg': {'precision': 0.3448811759265934, 'recall': 0.362608992542531, 'f1-score': 0.3347977692450585, 'support': 6071631}}
[[ 247919 1106513  445902]
 [ 314089 1449470  636470]
 [ 244113 1122916  504239]]
Evaluating performance on  train set...
9854/9854 - 152s - 152s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1259626
{'0': {'precision': 0.3487061409373944, 'recall': 0.1699253091188277, 'f1-score': 0.2285013713842337, 'support': 844012}, '1': {'precision': 0.3372102480141006, 'recall': 0.6081288869065724, 'f1-score': 0.4338491557223264, 'support': 831799}, '2': {'precision': 0.35248438559315093, 'recall': 0.2543653569807896, 'f1-score': 0.2954926410325755, 'support': 846208}, 'accuracy': 0.3427833017911443, 'macro avg': {'precision': 0.346133591514882, 'recall': 0.34413985100206324, 'f1-score': 0.3192810560463786, 'support': 2522019}, 'weighted avg': {'precision': 0.346182333073915, 'recall': 0.3427833017911443, 'f1-score': 0.31870554112729477, 'support': 2522019}}
[[143419 503071 197522]
 [128072 505841 197886]
 [139798 491164 215246]]
Evaluating performance on  val set...
3566/3566 - 56s - 56s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1257597
{'0': {'precision': 0.35483538529185443, 'recall': 0.16905562302170518, 'f1-score': 0.22900533194399794, 'support': 305503}, '1': {'precision': 0.3347084563217514, 'recall': 0.5613284607360072, 'f1-score': 0.41936080758668776, 'support': 304834}, '2': {'precision': 0.33919075958728034, 'recall': 0.2870321010545834, 'f1-score': 0.3109392598119041, 'support': 302015}, 'accuracy': 0.3391750113991091, 'macro avg': {'precision': 0.34291153373362876, 'recall': 0.33913872827076524, 'f1-score': 0.31976846644752993, 'support': 912352}, 'weighted avg': {'precision': 0.3429317736399489, 'recall': 0.3391750113991091, 'f1-score': 0.3197291932246104, 'support': 912352}}
[[ 51647 173311  80545]
 [ 45382 171112  88340]
 [ 48523 166804  86688]]
testing model out of sample: results/universal/W4/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 182s - 182s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200316
{'0': {'precision': 0.3705390623134061, 'recall': 0.15117684087848438, 'f1-score': 0.21474110534067123, 'support': 1026222}, '1': {'precision': 0.3551563595468101, 'recall': 0.673509939563337, 'f1-score': 0.4650708173502508, 'support': 1029673}, '2': {'precision': 0.34721227311621145, 'recall': 0.2349645963554077, 'f1-score': 0.2802673753645972, 'support': 975747}, 'accuracy': 0.3555505564311353, 'macro avg': {'precision': 0.3576358983254759, 'recall': 0.35321712559907636, 'f1-score': 0.3200264326851731, 'support': 3031642}, 'weighted avg': {'precision': 0.3578066228352011, 'recall': 0.3555505564311353, 'f1-score': 0.32085350480969677, 'support': 3031642}}
[[155141 650645 220436]
 [125575 693495 210603]
 [137974 608507 229266]]
Evaluating performance on  train set...
5528/5528 - 87s - 87s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1205219
{'0': {'precision': 0.3736464465115697, 'recall': 0.12810449105649208, 'f1-score': 0.19079501115606187, 'support': 466260}, '1': {'precision': 0.34683545578094327, 'recall': 0.7362942193480552, 'f1-score': 0.4715463845564792, 'support': 467923}, '2': {'precision': 0.3711900542377812, 'recall': 0.20191512885165142, 'f1-score': 0.2615536897637073, 'support': 480281}, 'accuracy': 0.3543639145287544, 'macro avg': {'precision': 0.3638906521767647, 'recall': 0.3554379464187329, 'f1-score': 0.3079650284920828, 'support': 1414464}, 'weighted avg': {'precision': 0.36394295617650685, 'recall': 0.3543639145287544, 'f1-score': 0.30769729627325254, 'support': 1414464}}
[[ 59730 322128  84402]
 [ 43515 344529  79879]
 [ 56612 326693  96976]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.125375
{'0': {'precision': 0.3798970901348474, 'recall': 0.12682288273133285, 'f1-score': 0.19016279875303085, 'support': 168826}, '1': {'precision': 0.33572634264319023, 'recall': 0.719864069329695, 'f1-score': 0.45789982261133, 'support': 158316}, '2': {'precision': 0.35786962394875593, 'recall': 0.20471101417666304, 'f1-score': 0.26044214356782985, 'support': 160475}, 'accuracy': 0.3450002768566313, 'macro avg': {'precision': 0.35783101890893115, 'recall': 0.35046598874589696, 'f1-score': 0.30283492164406356, 'support': 487617}, 'weighted avg': {'precision': 0.35830679755665135, 'recall': 0.3450002768566313, 'f1-score': 0.3002187084696842, 'support': 487617}}
[[ 21411 116985  30430]
 [ 15835 113966  28515]
 [ 19114 108510  32851]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198494
{'0': {'precision': 0.38244983528002396, 'recall': 0.17596456692913387, 'f1-score': 0.24103110296199426, 'support': 50800}, '1': {'precision': 0.29988510935127816, 'recall': 0.3504183348116894, 'f1-score': 0.32318832568680556, 'support': 41713}, '2': {'precision': 0.30411069275941677, 'recall': 0.4446433021453977, 'f1-score': 0.3611888111888112, 'support': 44141}, 'accuracy': 0.31600245876447086, 'macro avg': {'precision': 0.328815212463573, 'recall': 0.323675401295407, 'f1-score': 0.3084694132792037, 'support': 136654}, 'weighted avg': {'precision': 0.33194278460702575, 'recall': 0.31600245876447086, 'f1-score': 0.30492169987361034, 'support': 136654}}
[[ 8939 17230 24631]
 [ 6815 14617 20281]
 [ 7619 16895 19627]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1111143
{'0': {'precision': 0.3394562226897556, 'recall': 0.19533432669025888, 'f1-score': 0.2479754093515399, 'support': 21476}, '1': {'precision': 0.33988772477559964, 'recall': 0.5218473451327433, 'f1-score': 0.41165669823840595, 'support': 21696}, '2': {'precision': 0.34416359578554007, 'recall': 0.30467744899834587, 'f1-score': 0.3232190295142697, 'support': 21764}, 'accuracy': 0.3410742885302452, 'macro avg': {'precision': 0.34116918108363176, 'recall': 0.34061970694044935, 'f1-score': 0.32761704570140515, 'support': 64936}, 'weighted avg': {'precision': 0.34117812020902266, 'recall': 0.3410742885302452, 'f1-score': 0.3278822621436906, 'support': 64936}}
[[ 4195 10974  6307]
 [ 4045 11322  6329]
 [ 4118 11015  6631]]
Evaluating performance on  val set...
81/81 - 1s - 730ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1239971
{'0': {'precision': 0.3744908350305499, 'recall': 0.1945252578682888, 'f1-score': 0.25604873803307227, 'support': 7562}, '1': {'precision': 0.28159222931149414, 'recall': 0.522069209039548, 'f1-score': 0.36585214970615526, 'support': 5664}, '2': {'precision': 0.3498707175177763, 'recall': 0.2929238262751996, 'f1-score': 0.3188747330436704, 'support': 7391}, 'accuracy': 0.3197846437406024, 'macro avg': {'precision': 0.33531792728660675, 'recall': 0.3365060977276788, 'f1-score': 0.31359187359429935, 'support': 20617}, 'weighted avg': {'precision': 0.3401432097053503, 'recall': 0.3197846437406024, 'f1-score': 0.3087369784579485, 'support': 20617}}
[[1471 3706 2385]
 [1069 2957 1638]
 [1388 3838 2165]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
1613/1613 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1800067
{'0': {'precision': 0.3077251387110542, 'recall': 0.005097387677189013, 'f1-score': 0.010028653295128939, 'support': 141445}, '1': {'precision': 0.30847927820484566, 'recall': 0.9330677478297011, 'f1-score': 0.4636667952659863, 'support': 127517}, '2': {'precision': 0.4107092455949357, 'recall': 0.07079166290213848, 'f1-score': 0.12076733377596509, 'support': 143887}, 'accuracy': 0.31461623983587217, 'macro avg': {'precision': 0.3423045541702785, 'recall': 0.33631893280300956, 'f1-score': 0.19815426077902676, 'support': 412849}, 'weighted avg': {'precision': 0.343850307460478, 'recall': 0.31461623983587217, 'f1-score': 0.18873910546539915, 'support': 412849}}
[[   721 134157   6567]
 [   487 118982   8048]
 [  1135 132566  10186]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1504533
{'0': {'precision': 0.3611567532040749, 'recall': 0.02030785150692019, 'f1-score': 0.03845346396081176, 'support': 54117}, '1': {'precision': 0.3381305606627359, 'recall': 0.8889218119189599, 'f1-score': 0.4899083973361231, 'support': 53998}, '2': {'precision': 0.39427440940300246, 'recall': 0.12531671321040855, 'f1-score': 0.190184823947121, 'support': 54071}, 'accuracy': 0.3445118567570567, 'macro avg': {'precision': 0.36452057442327107, 'recall': 0.3448487922120962, 'f1-score': 0.2395155617480186, 'support': 162186}, 'weighted avg': {'precision': 0.3645314985180045, 'recall': 0.3445118567570567, 'f1-score': 0.23934583357483388, 'support': 162186}}
[[ 1099 47926  5092]
 [  680 48000  5318]
 [ 1264 46031  6776]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1687863
{'0': {'precision': 0.45345345345345345, 'recall': 0.008628078395520256, 'f1-score': 0.01693394639452731, 'support': 17501}, '1': {'precision': 0.3284094603381014, 'recall': 0.9349800428067334, 'f1-score': 0.4860833345864097, 'support': 17287}, '2': {'precision': 0.41056271612700407, 'recall': 0.07279010143796678, 'f1-score': 0.12365667755527152, 'support': 17942}, 'accuracy': 0.33415512990707374, 'macro avg': {'precision': 0.39747520997285296, 'recall': 0.33879940754674015, 'f1-score': 0.20889131951206952, 'support': 52730}, 'weighted avg': {'precision': 0.3978649626873573, 'recall': 0.33415512990707374, 'f1-score': 0.2070535124130963, 'support': 52730}}
[[  151 16510   840]
 [   89 16163  1035]
 [   93 16543  1306]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10279
{'0': {'precision': 0.3612113918973125, 'recall': 0.14440015577394452, 'f1-score': 0.2063203718250851, 'support': 87306}, '1': {'precision': 0.3836569297379611, 'recall': 0.6523666366768339, 'f1-score': 0.4831646479954818, 'support': 91142}, '2': {'precision': 0.34035504834363606, 'recall': 0.28814696528495326, 'f1-score': 0.3120826096750987, 'support': 74521}, 'accuracy': 0.36976072166945356, 'macro avg': {'precision': 0.36174112332630326, 'recall': 0.3616379192452439, 'f1-score': 0.33385587649855514, 'support': 252969}, 'weighted avg': {'precision': 0.3631543004430587, 'recall': 0.36976072166945356, 'f1-score': 0.337220398095273, 'support': 252969}}
[[12607 53312 21387]
 [11454 59458 20230]
 [10841 42207 21473]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089951
{'0': {'precision': 0.3600660352767399, 'recall': 0.14947338046457942, 'f1-score': 0.21125073280146814, 'support': 27724}, '1': {'precision': 0.3543448224354905, 'recall': 0.6493310979573682, 'f1-score': 0.45848885667693423, 'support': 29227}, '2': {'precision': 0.34905704307334107, 'recall': 0.25332026629718496, 'f1-score': 0.29358085614694707, 'support': 29591}, 'accuracy': 0.3537935337755079, 'macro avg': {'precision': 0.35448930026185715, 'recall': 0.35070824823971086, 'f1-score': 0.3211068152084498, 'support': 86542}, 'weighted avg': {'precision': 0.3543695991416613, 'recall': 0.3537935337755079, 'f1-score': 0.3228989420689257, 'support': 86542}}
[[ 4144 16550  7030]
 [ 3300 18978  6949]
 [ 4065 18030  7496]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1175855
{'0': {'precision': 0.35541099940863397, 'recall': 0.17064168086314593, 'f1-score': 0.23057740264722812, 'support': 10566}, '1': {'precision': 0.31793224904174866, 'recall': 0.6285070653286914, 'f1-score': 0.4222619702806824, 'support': 9766}, '2': {'precision': 0.37858241297357753, 'recall': 0.2417857142857143, 'f1-score': 0.2951016182640441, 'support': 11200}, 'accuracy': 0.3377204110110364, 'macro avg': {'precision': 0.3506418871413201, 'recall': 0.3469781534925172, 'f1-score': 0.31598033039731815, 'support': 31532}, 'weighted avg': {'precision': 0.3520335528731895, 'recall': 0.3377204110110364, 'f1-score': 0.3128640543793305, 'support': 31532}}
[[1803 6465 2298]
 [1481 6138 2147]
 [1789 6703 2708]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
925/925 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.11014
{'0': {'precision': 0.3059463379260334, 'recall': 0.1775374516074735, 'f1-score': 0.22468978005006127, 'support': 71292}, '1': {'precision': 0.38459591893073225, 'recall': 0.18974440459436145, 'f1-score': 0.25411736093694187, 'support': 88108}, '2': {'precision': 0.3295578018504494, 'recall': 0.6474629337335369, 'f1-score': 0.43679003617733436, 'support': 77294}, 'accuracy': 0.33553871243039535, 'macro avg': {'precision': 0.34003335290240505, 'recall': 0.33824826331179064, 'f1-score': 0.3051990590547792, 'support': 236694}, 'weighted avg': {'precision': 0.3429336792854925, 'recall': 0.33553871243039535, 'f1-score': 0.3049067796101799, 'support': 236694}}
[[12657 13241 45394]
 [14974 16718 56416]
 [13739 13510 50045]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107956
{'0': {'precision': 0.33899566026038436, 'recall': 0.1834714626044358, 'f1-score': 0.23808590773517954, 'support': 29803}, '1': {'precision': 0.34591150938112575, 'recall': 0.16897506925207756, 'f1-score': 0.22704192992533026, 'support': 29241}, '2': {'precision': 0.33638833482357794, 'recall': 0.6625685836212152, 'f1-score': 0.446226135352752, 'support': 29526}, 'accuracy': 0.3383990064355877, 'macro avg': {'precision': 0.340431834821696, 'recall': 0.3383383718259095, 'f1-score': 0.30378465767108725, 'support': 88570}, 'weighted avg': {'precision': 0.3404097107661138, 'recall': 0.3383990064355877, 'f1-score': 0.3038261290911538, 'support': 88570}}
[[ 5468  4756 19579]
 [ 5286  4941 19014]
 [ 5376  4587 19563]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039042
{'0': {'precision': 0.3336280056577086, 'recall': 0.1749814540059347, 'f1-score': 0.2295620437956204, 'support': 10784}, '1': {'precision': 0.31044006628613513, 'recall': 0.1714111427409516, 'f1-score': 0.22086853998820985, 'support': 9836}, '2': {'precision': 0.3655117069486405, 'recall': 0.6645781477984722, 'f1-score': 0.471630881681133, 'support': 11651}, 'accuracy': 0.35065538718973693, 'macro avg': {'precision': 0.33652659296416143, 'recall': 0.3369902481817862, 'f1-score': 0.30735382182165444, 'support': 32271}, 'weighted avg': {'precision': 0.3380716371560151, 'recall': 0.35065538718973693, 'f1-score': 0.3143079372217435, 'support': 32271}}
[[1887 1830 7067]
 [1776 1686 6374]
 [1993 1915 7743]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
1590/1590 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062584
{'0': {'precision': 0.37053730886330005, 'recall': 0.16337443004559635, 'f1-score': 0.22676527685974068, 'support': 133344}, '1': {'precision': 0.370461218422529, 'recall': 0.6200956872206838, 'f1-score': 0.46382272945169484, 'support': 145892}, '2': {'precision': 0.32847761079220394, 'recall': 0.2673940779123193, 'f1-score': 0.2948049706593027, 'support': 127759}, 'accuracy': 0.3597439771987371, 'macro avg': {'precision': 0.356492046026011, 'recall': 0.3502880650595331, 'f1-score': 0.3284643256569128, 'support': 406995}, 'weighted avg': {'precision': 0.357307156275553, 'recall': 0.3597439771987371, 'f1-score': 0.3330994311213007, 'support': 406995}}
[[21785 78174 33385]
 [18971 90467 36454]
 [18037 75560 34162]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1116167
{'0': {'precision': 0.33747079439252337, 'recall': 0.1543444867428037, 'f1-score': 0.21181430731863798, 'support': 44919}, '1': {'precision': 0.34313312171411564, 'recall': 0.6077570113983265, 'f1-score': 0.43862388156695536, 'support': 45533}, '2': {'precision': 0.36327000575705237, 'recall': 0.28064044729652454, 'f1-score': 0.3166535235500753, 'support': 47217}, 'accuracy': 0.34762364802533613, 'macro avg': {'precision': 0.3479579739545638, 'recall': 0.34758064847921827, 'f1-score': 0.32236390414522287, 'support': 137669}, 'weighted avg': {'precision': 0.3481920469107593, 'recall': 0.34762364802533613, 'f1-score': 0.3227871016081906, 'support': 137669}}
[[ 6933 26404 11582]
 [ 6216 27673 11644]
 [ 7395 26571 13251]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152822
{'0': {'precision': 0.3554014519449561, 'recall': 0.1729957805907173, 'f1-score': 0.23271488878640603, 'support': 18960}, '1': {'precision': 0.33455548698587867, 'recall': 0.5200022569542403, 'f1-score': 0.40715705765407556, 'support': 17723}, '2': {'precision': 0.33608518784398184, 'recall': 0.33422571241596766, 'f1-score': 0.33515287099179725, 'support': 16809}, 'accuracy': 0.3386300755253122, 'macro avg': {'precision': 0.3420140422582722, 'recall': 0.34240791665364173, 'f1-score': 0.3250082724774263, 'support': 53492}, 'weighted avg': {'precision': 0.3424249298436512, 'recall': 0.3386300755253122, 'f1-score': 0.32270065491465194, 'support': 53492}}
[[ 3280 10046  5634]
 [ 3043  9216  5464]
 [ 2906  8285  5618]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
3782/3782 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.196878
{'0': {'precision': 0.40662947161142105, 'recall': 0.026748209692640773, 'f1-score': 0.050194603197569264, 'support': 324246}, '1': {'precision': 0.29067417928209793, 'recall': 0.9530175131850493, 'f1-score': 0.4454762947511571, 'support': 279104}, '2': {'precision': 0.4287254280279011, 'recall': 0.03708701543052424, 'f1-score': 0.06826844919246129, 'support': 364602}, 'accuracy': 0.29772757326809596, 'macro avg': {'precision': 0.37534302630714, 'recall': 0.3389509127694048, 'f1-score': 0.1879797823803959, 'support': 967952}, 'weighted avg': {'precision': 0.38151732141293815, 'recall': 0.29772757326809596, 'f1-score': 0.17097999507320175, 'support': 967952}}
[[  8673 305451  10122]
 [  5217 265991   7896]
 [  7439 343641  13522]]
Evaluating performance on  train set...
1601/1601 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1661342
{'0': {'precision': 0.40745965964200687, 'recall': 0.033399105213324946, 'f1-score': 0.06173763176528744, 'support': 138357}, '1': {'precision': 0.33042046373791506, 'recall': 0.9446523463812588, 'f1-score': 0.48959159647241135, 'support': 133610}, '2': {'precision': 0.3892744095446798, 'recall': 0.04641288964691367, 'f1-score': 0.08293723616037557, 'support': 137785}, 'accuracy': 0.3349123372186103, 'macro avg': {'precision': 0.3757181776415339, 'recall': 0.34148811374716576, 'f1-score': 0.21142215479935814, 'support': 409752}, 'weighted avg': {'precision': 0.3762240301651381, 'recall': 0.3349123372186103, 'f1-score': 0.20837890677089094, 'support': 409752}}
[[  4621 128417   5319]
 [  2681 126215   4714]
 [  4039 127351   6395]]
Evaluating performance on  val set...
532/532 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1724472
{'0': {'precision': 0.4857452183327319, 'recall': 0.028083792355199467, 'f1-score': 0.05309769423460029, 'support': 47928}, '1': {'precision': 0.3169495122583891, 'recall': 0.939118688280231, 'f1-score': 0.47394434486203757, 'support': 42936}, '2': {'precision': 0.3737029831387808, 'recall': 0.05088974257075993, 'f1-score': 0.08958066145894057, 'support': 45294}, 'accuracy': 0.3229556838378942, 'macro avg': {'precision': 0.3921325712433006, 'recall': 0.33936407440206345, 'f1-score': 0.2055409001851928, 'support': 136158}, 'weighted avg': {'precision': 0.3952455529668863, 'recall': 0.3229556838378942, 'f1-score': 0.1979436181523937, 'support': 136158}}
[[ 1346 44739  1843]
 [  594 40322  2020]
 [  831 42158  2305]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
4457/4457 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1566439
{'0': {'precision': 0.40230293747606805, 'recall': 0.07202844117114161, 'f1-score': 0.12218147383635208, 'support': 408422}, '1': {'precision': 0.3188500608557251, 'recall': 0.7712609057505364, 'f1-score': 0.45117716318328377, 'support': 353254}, '2': {'precision': 0.3577230437533688, 'recall': 0.20122705209566472, 'f1-score': 0.2575670139275578, 'support': 379283}, 'accuracy': 0.33146765133541173, 'macro avg': {'precision': 0.35962534736172064, 'recall': 0.3481721330057809, 'f1-score': 0.27697521698239785, 'support': 1140959}, 'weighted avg': {'precision': 0.36164550955055175, 'recall': 0.33146765133541173, 'f1-score': 0.26904781789163695, 'support': 1140959}}
[[ 29418 303397  75607]
 [ 19377 272451  61426]
 [ 24329 278632  76322]]
Evaluating performance on  train set...
2425/2425 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1344334
{'0': {'precision': 0.3982430824536088, 'recall': 0.07617179934146814, 'f1-score': 0.12788339206815677, 'support': 206520}, '1': {'precision': 0.341868224193366, 'recall': 0.8278266823161189, 'f1-score': 0.48389992338741955, 'support': 204480}, '2': {'precision': 0.3765971286530688, 'recall': 0.15458407434072194, 'f1-score': 0.21919419664738748, 'support': 209737}, 'accuracy': 0.35027233756002946, 'macro avg': {'precision': 0.3722361451000145, 'recall': 0.3528608519994363, 'f1-score': 0.27699250403432124, 'support': 620737}, 'weighted avg': {'precision': 0.3723585477322722, 'recall': 0.35027233756002946, 'f1-score': 0.27601297761597643, 'support': 620737}}
[[ 15731 162662  28127]
 [  9663 169274  25543]
 [ 14107 163208  32422]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1468253
{'0': {'precision': 0.3982665769101313, 'recall': 0.06621062055844665, 'f1-score': 0.11354476537760291, 'support': 71484}, '1': {'precision': 0.32088792342678707, 'recall': 0.8319786233159461, 'f1-score': 0.46314448714922574, 'support': 62498}, '2': {'precision': 0.3872220390519105, 'recall': 0.1571980963712076, 'f1-score': 0.22361615029036253, 'support': 67240}, 'accuracy': 0.3344564709624196, 'macro avg': {'precision': 0.3687921797962763, 'recall': 0.35179578008186674, 'f1-score': 0.2667684676057304, 'support': 201222}, 'weighted avg': {'precision': 0.37054274049567953, 'recall': 0.3344564709624196, 'f1-score': 0.25890900652825666, 'support': 201222}}
[[ 4733 57704  9047]
 [ 2821 51997  7680]
 [ 4330 52340 10570]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
4676/4676 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0600991
{'0': {'precision': 0.3727608974750871, 'recall': 0.07403438687664679, 'f1-score': 0.12353364264440707, 'support': 329428}, '1': {'precision': 0.47992060444375995, 'recall': 0.8612174766813943, 'f1-score': 0.6163660815890203, 'support': 549990}, '2': {'precision': 0.31967995352825646, 'recall': 0.14556429900715115, 'f1-score': 0.20004110996916752, 'support': 317571}, 'accuracy': 0.4547050975405789, 'macro avg': {'precision': 0.3907871518157012, 'recall': 0.3602720541883974, 'f1-score': 0.31331361140086494, 'support': 1196989}, 'weighted avg': {'precision': 0.40791560548456873, 'recall': 0.4547050975405789, 'f1-score': 0.3702773186522395, 'support': 1196989}}
[[ 24389 260985  44054]
 [ 22006 473661  54323]
 [ 19033 252311  46227]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1354032
{'0': {'precision': 0.3938242713430386, 'recall': 0.07151095732410612, 'f1-score': 0.12104284793513494, 'support': 181203}, '1': {'precision': 0.34684433741868237, 'recall': 0.8599786124849619, 'f1-score': 0.4943205829246116, 'support': 179544}, '2': {'precision': 0.3880791678893997, 'recall': 0.13323482329762346, 'f1-score': 0.1983666666666667, 'support': 178662}, 'accuracy': 0.35439898110710055, 'macro avg': {'precision': 0.3762492588837069, 'recall': 0.3549081310355638, 'f1-score': 0.27124336584213776, 'support': 539409}, 'weighted avg': {'precision': 0.376283969031159, 'recall': 0.35439898110710055, 'f1-score': 0.27090057324777067, 'support': 539409}}
[[ 12958 147423  20822]
 [  8428 154404  16712]
 [ 11517 143341  23804]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1205009
{'0': {'precision': 0.37750148016577856, 'recall': 0.09510030576478484, 'f1-score': 0.15192708643593258, 'support': 67045}, '1': {'precision': 0.3655495431109296, 'recall': 0.8130632868274267, 'f1-score': 0.5043469839634809, 'support': 70457}, '2': {'precision': 0.37118760419731295, 'recall': 0.17026285405826874, 'f1-score': 0.23344503608067269, 'support': 66691}, 'accuracy': 0.367382819195565, 'macro avg': {'precision': 0.3714128758246737, 'recall': 0.35947548221682674, 'f1-score': 0.29657303549336206, 'support': 204193}, 'weighted avg': {'precision': 0.3713152919453869, 'recall': 0.367382819195565, 'f1-score': 0.30015431410708604, 'support': 204193}}
[[ 6376 50161 10508]
 [ 4443 57286  8728]
 [ 6071 49265 11355]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
4274/4274 - 40s - 40s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0911638
{'0': {'precision': 0.3611528569488198, 'recall': 0.23798758481305038, 'f1-score': 0.2869106813114902, 'support': 346350}, '1': {'precision': 0.39446384354594716, 'recall': 0.6445588324045948, 'f1-score': 0.48941213759209073, 'support': 397672}, '2': {'precision': 0.3610083737982049, 'recall': 0.22279834191799294, 'f1-score': 0.2755434801810364, 'support': 350043}, 'accuracy': 0.38090881254770054, 'macro avg': {'precision': 0.37220835809765723, 'recall': 0.36844825304521267, 'f1-score': 0.3506220996948724, 'support': 1094065}, 'weighted avg': {'precision': 0.37321454555650047, 'recall': 0.38090881254770054, 'f1-score': 0.3568792388804752, 'support': 1094065}}
[[ 82427 198152  65771]
 [ 69078 256323  72271]
 [ 76728 195326  77989]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087121
{'0': {'precision': 0.37974783605391094, 'recall': 0.1740359012444074, 'f1-score': 0.23868435434987828, 'support': 165621}, '1': {'precision': 0.3531595588569008, 'recall': 0.6989825555282747, 'f1-score': 0.4692376962845634, 'support': 166987}, '2': {'precision': 0.378753616102351, 'recall': 0.2162154304189054, 'f1-score': 0.2752828121298271, 'support': 171972}, 'accuracy': 0.36213880851401165, 'macro avg': {'precision': 0.37055367033772096, 'recall': 0.3630779623971958, 'f1-score': 0.32773495425475624, 'support': 504580}, 'weighted avg': {'precision': 0.37060979126853144, 'recall': 0.36213880851401165, 'f1-score': 0.32745783108494625, 'support': 504580}}
[[ 28824 105557  31240]
 [ 20517 116721  29749]
 [ 26562 108227  37183]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.105954
{'0': {'precision': 0.387539155015662, 'recall': 0.16837056460981845, 'f1-score': 0.23475101814142912, 'support': 60254}, '1': {'precision': 0.3649209132996983, 'recall': 0.7006143780419692, 'f1-score': 0.4798880727527107, 'support': 62665}, '2': {'precision': 0.34341164453524003, 'recall': 0.20345811359903174, 'f1-score': 0.2555266015200869, 'support': 57835}, 'accuracy': 0.36411918961682727, 'macro avg': {'precision': 0.3652905709502001, 'recall': 0.3574810187502731, 'f1-score': 0.32338856413807554, 'support': 180754}, 'weighted avg': {'precision': 0.3655784421917905, 'recall': 0.36411918961682727, 'f1-score': 0.32638422898003094, 'support': 180754}}
[[10145 39008 11101]
 [ 7364 43904 11397]
 [ 8669 37399 11767]]
testing model on single stock: results/universal/W4/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
12724/12724 - 105s - 105s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036633
{'0': {'precision': 0.29810015788858424, 'recall': 0.21570729064387534, 'f1-score': 0.2502975680182094, 'support': 933923}, '1': {'precision': 0.4258755708228381, 'recall': 0.4235267208240181, 'f1-score': 0.42469789818896136, 'support': 1355310}, '2': {'precision': 0.3113815028386267, 'recall': 0.39682761071748107, 'f1-score': 0.3489499793997819, 'support': 967914}, 'accuracy': 0.3560045033276054, 'macro avg': {'precision': 0.34511907718334967, 'recall': 0.34535387406179147, 'f1-score': 0.34131514853565087, 'support': 3257147}, 'weighted avg': {'precision': 0.35521471078407807, 'recall': 0.3560045033276054, 'f1-score': 0.3521823038295514, 'support': 3257147}}
[[201454 392796 339673]
 [271549 574010 509751]
 [202790 381029 384095]]
Evaluating performance on  train set...
5165/5165 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078259
{'0': {'precision': 0.3431119892334565, 'recall': 0.27200067191486654, 'f1-score': 0.30344584824288834, 'support': 440532}, '1': {'precision': 0.33329458535791506, 'recall': 0.39510709544654876, 'f1-score': 0.36157812102627057, 'support': 435406}, '2': {'precision': 0.347213585685634, 'recall': 0.35542535928492663, 'f1-score': 0.3512714867978026, 'support': 446164}, 'accuracy': 0.34069610362891817, 'macro avg': {'precision': 0.3412067200923352, 'recall': 0.34084437554878066, 'f1-score': 0.3387651520223205, 'support': 1322102}, 'weighted avg': {'precision': 0.3412629852440936, 'recall': 0.34069610362891817, 'f1-score': 0.3387299780329772, 'support': 1322102}}
[[119825 174560 146147]
 [111383 172032 151991]
 [118022 169564 158578]]
Evaluating performance on  val set...
1903/1903 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1120223
{'0': {'precision': 0.3467304731945653, 'recall': 0.2554408456346883, 'f1-score': 0.29416587110901327, 'support': 162245}, '1': {'precision': 0.3234219500313174, 'recall': 0.3393846078944486, 'f1-score': 0.331211061155886, 'support': 164318}, '2': {'precision': 0.3289309078977051, 'recall': 0.3998828200477446, 'f1-score': 0.36095318737147697, 'support': 160437}, 'accuracy': 0.33134907597535934, 'macro avg': {'precision': 0.33302777704119596, 'recall': 0.33156942452562715, 'f1-score': 0.3287767065454587, 'support': 487000}, 'weighted avg': {'precision': 0.33300209790365987, 'recall': 0.33134907597535934, 'f1-score': 0.3286676127872944, 'support': 487000}}
[[41444 60047 60754]
 [38417 55767 70134]
 [39667 56614 64156]]
training model: results/universal/W4/deepVOL_L2/h1000
Epoch 1/50
9854/9854 - 321s - loss: 3.2653 - accuracy1000: 0.3750 - val_loss: 3.3440 - val_accuracy1000: 0.3269 - 321s/epoch - 33ms/step
Epoch 2/50
9854/9854 - 317s - loss: 3.2636 - accuracy1000: 0.3784 - val_loss: 3.3761 - val_accuracy1000: 0.3276 - 317s/epoch - 32ms/step
Epoch 3/50
9854/9854 - 320s - loss: 3.2685 - accuracy1000: 0.3729 - val_loss: 3.3410 - val_accuracy1000: 0.3276 - 320s/epoch - 33ms/step
Epoch 4/50
9854/9854 - 316s - loss: 3.2598 - accuracy1000: 0.3812 - val_loss: 3.3536 - val_accuracy1000: 0.3317 - 316s/epoch - 32ms/step
Epoch 5/50
9854/9854 - 319s - loss: 3.2650 - accuracy1000: 0.3755 - val_loss: 3.3084 - val_accuracy1000: 0.3306 - 319s/epoch - 32ms/step
Epoch 6/50
9854/9854 - 316s - loss: 3.2641 - accuracy1000: 0.3794 - val_loss: 3.3809 - val_accuracy1000: 0.3273 - 316s/epoch - 32ms/step
Epoch 7/50
9854/9854 - 322s - loss: 3.2528 - accuracy1000: 0.3877 - val_loss: 3.4213 - val_accuracy1000: 0.3274 - 322s/epoch - 33ms/step
Epoch 8/50
9854/9854 - 321s - loss: 3.2473 - accuracy1000: 0.3896 - val_loss: 3.3841 - val_accuracy1000: 0.3271 - 321s/epoch - 33ms/step
Epoch 9/50
9854/9854 - 317s - loss: 3.2446 - accuracy1000: 0.3934 - val_loss: 3.3843 - val_accuracy1000: 0.3272 - 317s/epoch - 32ms/step
Epoch 10/50
9854/9854 - 322s - loss: 3.2388 - accuracy1000: 0.3972 - val_loss: 3.4029 - val_accuracy1000: 0.3273 - 322s/epoch - 33ms/step
Epoch 11/50
9854/9854 - 317s - loss: 3.2307 - accuracy1000: 0.4022 - val_loss: 3.4148 - val_accuracy1000: 0.3275 - 317s/epoch - 32ms/step
Epoch 12/50
9854/9854 - 315s - loss: 3.2290 - accuracy1000: 0.4037 - val_loss: 3.4032 - val_accuracy1000: 0.3284 - 315s/epoch - 32ms/step
Epoch 13/50
9854/9854 - 317s - loss: 3.2263 - accuracy1000: 0.4061 - val_loss: 3.3840 - val_accuracy1000: 0.3289 - 317s/epoch - 32ms/step
Epoch 14/50
9854/9854 - 316s - loss: 3.2229 - accuracy1000: 0.4082 - val_loss: 3.3937 - val_accuracy1000: 0.3294 - 316s/epoch - 32ms/step
Epoch 15/50
9854/9854 - 321s - loss: 3.2195 - accuracy1000: 0.4105 - val_loss: 3.4056 - val_accuracy1000: 0.3304 - 321s/epoch - 33ms/step
testing model in sample: results/universal/W4/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 360s - 360s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974483
{'0': {'precision': 0.3010989010989011, 'recall': 0.003351639175992435, 'f1-score': 0.006629483211691117, 'support': 1880274}, '1': {'precision': 0.3712148595846164, 'recall': 0.929533066872492, 'f1-score': 0.5305508928823314, 'support': 2265999}, '2': {'precision': 0.31239975356638305, 'recall': 0.061100844622143, 'f1-score': 0.10221075358503517, 'support': 1925358}, 'accuracy': 0.3673253529405855, 'macro avg': {'precision': 0.32823783808330015, 'recall': 0.3313285168902092, 'f1-score': 0.2131303765596859, 'support': 6071631}, 'weighted avg': {'precision': 0.3308505244300552, 'recall': 0.3673253529405855, 'f1-score': 0.23247218576653053, 'support': 6071631}}
[[   6302 1766153  107819]
 [   8566 2106321  151112]
 [   6062 1801655  117641]]
Evaluating performance on  train set...
9854/9854 - 153s - 153s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100909
{'0': {'precision': 0.33483113494709377, 'recall': 0.0027413451816408196, 'f1-score': 0.005438166749259315, 'support': 842652}, '1': {'precision': 0.3341749377174091, 'recall': 0.929797068811567, 'f1-score': 0.49164835289856856, 'support': 836589}, '2': {'precision': 0.36025994675146594, 'recall': 0.0801171838847241, 'f1-score': 0.13108315755857353, 'support': 842778}, 'accuracy': 0.3361152314871537, 'macro avg': {'precision': 0.34308867313865626, 'recall': 0.33755186595931064, 'f1-score': 0.2093898924021338, 'support': 2522019}, 'weighted avg': {'precision': 0.3431109598693804, 'recall': 0.3361152314871537, 'f1-score': 0.20870742343795065, 'support': 2522019}}
[[  2310 776814  63528]
 [  2357 777858  56374]
 [  2232 773025  67521]]
Evaluating performance on  val set...
3566/3566 - 55s - 55s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031103
{'0': {'precision': 0.3629421221864952, 'recall': 0.002895335079725921, 'f1-score': 0.005744841253431476, 'support': 311881}, '1': {'precision': 0.32846441680962585, 'recall': 0.9276041143163467, 'f1-score': 0.4851406382516419, 'support': 298470}, '2': {'precision': 0.35416480004778544, 'recall': 0.07853285254022338, 'f1-score': 0.12855892261367546, 'support': 302001}, 'accuracy': 0.3304448283118796, 'macro avg': {'precision': 0.34852377968130216, 'recall': 0.336344100645432, 'f1-score': 0.20648146737291628, 'support': 912352}, 'weighted avg': {'precision': 0.34875755221016297, 'recall': 0.3304448283118796, 'f1-score': 0.20322918821045124, 'support': 912352}}
[[   903 288553  22425]
 [   784 276862  20824]
 [   801 277483  23717]]
testing model out of sample: results/universal/W4/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 185s - 185s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096953
{'0': {'precision': 0.339661214953271, 'recall': 0.00227701458522799, 'f1-score': 0.004523703252068097, 'support': 1021513}, '1': {'precision': 0.35199127179155115, 'recall': 0.9547391069545762, 'f1-score': 0.5143522151961252, 'support': 1049913}, '2': {'precision': 0.3889648393365571, 'recall': 0.07170574120822815, 'f1-score': 0.1210887488217004, 'support': 960216}, 'accuracy': 0.35412228752603375, 'macro avg': {'precision': 0.3602057753604598, 'recall': 0.34290728758267747, 'f1-score': 0.21332155575663123, 'support': 3031642}, 'weighted avg': {'precision': 0.35954734133497135, 'recall': 0.35412228752603375, 'f1-score': 0.21800643117885196, 'support': 3031642}}
[[   2326  955963   63224]
 [   2581 1002393   44939]
 [   1941  889422   68853]]
Evaluating performance on  train set...
5528/5528 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005969
{'0': {'precision': 0.33126596132798247, 'recall': 0.001972647975754679, 'f1-score': 0.003921941274544528, 'support': 460295}, '1': {'precision': 0.3355758460286429, 'recall': 0.9502108825605224, 'f1-score': 0.49598866395323543, 'support': 470404}, '2': {'precision': 0.3715181538847432, 'recall': 0.06123427697332382, 'f1-score': 0.10513930789707186, 'support': 483765}, 'accuracy': 0.3375936043617936, 'macro avg': {'precision': 0.34611998708045616, 'recall': 0.3378059358365337, 'f1-score': 0.2016833043749506, 'support': 1414464}, 'weighted avg': {'precision': 0.3464660575728857, 'recall': 0.3375936043617936, 'f1-score': 0.2021847277287023, 'support': 1414464}}
[[   908 431739  27648]
 [   957 446983  22464]
 [   876 453266  29623]]
Evaluating performance on  val set...
1908/1908 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013504
{'0': {'precision': 0.3262786596119929, 'recall': 0.0010920446026433381, 'f1-score': 0.0021768035111252304, 'support': 169407}, '1': {'precision': 0.3307347631269848, 'recall': 0.9544769748405564, 'f1-score': 0.4912477949871092, 'support': 159304}, '2': {'precision': 0.35942878066642253, 'recall': 0.061772368570098046, 'f1-score': 0.10542595695321562, 'support': 158906}, 'accuracy': 0.3323366494605397, 'macro avg': {'precision': 0.33881406780180007, 'recall': 0.3391137960044326, 'f1-score': 0.19961685181715003, 'support': 487617}, 'weighted avg': {'precision': 0.3385375190254823, 'recall': 0.3323366494605397, 'f1-score': 0.1956029457558767, 'support': 487617}}
[[   185 158813  10409]
 [   167 152052   7085]
 [   215 148875   9816]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
534/534 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075574
{'0': {'precision': 0.48859934853420195, 'recall': 0.005427801197734798, 'f1-score': 0.010736333542095374, 'support': 55271}, '1': {'precision': 0.2842015710049641, 'recall': 0.898967994774657, 'f1-score': 0.4318706697459584, 'support': 38275}, '2': {'precision': 0.39189098924587534, 'recall': 0.1361000278370604, 'f1-score': 0.2020351590075587, 'support': 43108}, 'accuracy': 0.29691776310975165, 'macro avg': {'precision': 0.3882306362616805, 'recall': 0.34683194126981737, 'f1-score': 0.21488072076520415, 'support': 136654}, 'weighted avg': {'precision': 0.4008431987900835, 'recall': 0.29691776310975165, 'f1-score': 0.1890364673571908, 'support': 136654}}
[[  300 49611  5360]
 [  123 34408  3744]
 [  191 37050  5867]]
Evaluating performance on  train set...
254/254 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018698
{'0': {'precision': 0.30454545454545456, 'recall': 0.0031372916276456264, 'f1-score': 0.006210604375231739, 'support': 21356}, '1': {'precision': 0.32205933754137794, 'recall': 0.7314840758382367, 'f1-score': 0.44721702759418136, 'support': 21414}, '2': {'precision': 0.33994651408669696, 'recall': 0.24659388252278264, 'f1-score': 0.28584128644267226, 'support': 22166}, 'accuracy': 0.3264290994209683, 'macro avg': {'precision': 0.3221837687245098, 'recall': 0.3270717499962217, 'f1-score': 0.24642297280402845, 'support': 64936}, 'weighted avg': {'precision': 0.32240522687922757, 'recall': 0.3264290994209683, 'f1-score': 0.24709401643506718, 'support': 64936}}
[[   67 16344  4945]
 [   82 15664  5668]
 [   71 16629  5466]]
Evaluating performance on  val set...
81/81 - 1s - 708ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1112875
{'0': {'precision': 0.3258426966292135, 'recall': 0.003901520247544733, 'f1-score': 0.007710715235309758, 'support': 7433}, '1': {'precision': 0.27705997074597755, 'recall': 0.823252444766389, 'f1-score': 0.4145918832649339, 'support': 5522}, '2': {'precision': 0.34878640776699027, 'recall': 0.187548942834769, 'f1-score': 0.24393142081140723, 'support': 7662}, 'accuracy': 0.2916040161032158, 'macro avg': {'precision': 0.31722969171406046, 'recall': 0.3382343026162343, 'f1-score': 0.22207800643721698, 'support': 20617}, 'weighted avg': {'precision': 0.32130355429087215, 'recall': 0.2916040161032158, 'f1-score': 0.20447653256972523, 'support': 20617}}
[[  29 5673 1731]
 [  24 4546  952]
 [  36 6189 1437]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
1613/1613 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204088
{'0': {'precision': 0.4126163391933816, 'recall': 0.010036725864063994, 'f1-score': 0.01959676825225314, 'support': 159016}, '1': {'precision': 0.24478035047794677, 'recall': 0.9883753168567807, 'f1-score': 0.392383318461097, 'support': 100992}, '2': {'precision': 0.45523012552301256, 'recall': 0.0035592543885475756, 'f1-score': 0.00706328390765795, 'support': 152841}, 'accuracy': 0.24696196430171807, 'macro avg': {'precision': 0.37087560506478034, 'recall': 0.3339904323697975, 'f1-score': 0.13968112354033602, 'support': 412849}, 'weighted avg': {'precision': 0.387336010414719, 'recall': 0.24696196430171807, 'f1-score': 0.10614858016890859, 'support': 412849}}
[[  1596 157073    347]
 [   870  99818    304]
 [  1402 150895    544]]
Evaluating performance on  train set...
634/634 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025972
{'0': {'precision': 0.3439767779390421, 'recall': 0.00862037609573346, 'f1-score': 0.01681924632744305, 'support': 54986}, '1': {'precision': 0.33253287019330247, 'recall': 0.9850302737639761, 'f1-score': 0.4972132768957452, 'support': 53842}, '2': {'precision': 0.44570994684889903, 'recall': 0.011001161962592302, 'f1-score': 0.02147233653406493, 'support': 53358}, 'accuracy': 0.33354913494382993, 'macro avg': {'precision': 0.37407319832708114, 'recall': 0.3348839372741006, 'f1-score': 0.1785016199190844, 'support': 162186}, 'weighted avg': {'precision': 0.3736471289301636, 'recall': 0.33354913494382993, 'f1-score': 0.17782978349528403, 'support': 162186}}
[[  474 54098   414]
 [  490 53036   316]
 [  414 52357   587]]
Evaluating performance on  val set...
206/206 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1190896
{'0': {'precision': 0.3368421052631579, 'recall': 0.003218344564014885, 'f1-score': 0.006375772066148635, 'support': 19886}, '1': {'precision': 0.26097835845128264, 'recall': 0.991725339333672, 'f1-score': 0.4132163919552397, 'support': 13777}, '2': {'precision': 0.46524064171123, 'recall': 0.004562857292704673, 'f1-score': 0.009037083203490184, 'support': 19067}, 'accuracy': 0.2619761046842405, 'macro avg': {'precision': 0.3543537018085568, 'recall': 0.3331688470634639, 'f1-score': 0.14287641574162616, 'support': 52730}, 'weighted avg': {'precision': 0.3634493507520292, 'recall': 0.2619761046842405, 'f1-score': 0.11363513940291516, 'support': 52730}}
[[   64 19769    53]
 [   67 13663    47]
 [   59 18921    87]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
989/989 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0900273
{'0': {'precision': 0.36162361623616235, 'recall': 0.007810098480104742, 'f1-score': 0.015289974591004327, 'support': 87835}, '1': {'precision': 0.3681560134999034, 'recall': 0.9680690072639225, 'f1-score': 0.5334437253739878, 'support': 92512}, '2': {'precision': 0.46306490846242476, 'recall': 0.04980584395913084, 'f1-score': 0.08993820944139844, 'support': 72622}, 'accuracy': 0.3710375579616475, 'macro avg': {'precision': 0.3976148460661635, 'recall': 0.34189498323438605, 'f1-score': 0.21289063646879683, 'support': 252969}, 'weighted avg': {'precision': 0.39313417547353463, 'recall': 0.3710375579616475, 'f1-score': 0.2262112491493126, 'support': 252969}}
[[  686 85299  1850]
 [  610 89558  2344]
 [  601 68404  3617]]
Evaluating performance on  train set...
339/339 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009499
{'0': {'precision': 0.35945945945945945, 'recall': 0.004739674281030612, 'f1-score': 0.009355984664626641, 'support': 28061}, '1': {'precision': 0.33530260441282556, 'recall': 0.9403864936514581, 'f1-score': 0.4943430824241313, 'support': 28668}, '2': {'precision': 0.37244367417677643, 'recall': 0.07208264850903968, 'f1-score': 0.12078801674957143, 'support': 29813}, 'accuracy': 0.3378821843729056, 'macro avg': {'precision': 0.3557352460163538, 'recall': 0.3390696054805095, 'f1-score': 0.2081623612794431, 'support': 86542}, 'weighted avg': {'precision': 0.35593018665423737, 'recall': 0.3378821843729056, 'f1-score': 0.20840076397545768, 'support': 86542}}
[[  133 25851  2077]
 [  165 26959  1544]
 [   72 27592  2149]]
Evaluating performance on  val set...
124/124 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057595
{'0': {'precision': 0.3188405797101449, 'recall': 0.002056843679880329, 'f1-score': 0.004087320018578727, 'support': 10696}, '1': {'precision': 0.29330316436459425, 'recall': 0.9504267892317794, 'f1-score': 0.44826963276471654, 'support': 9138}, '2': {'precision': 0.39794816414686823, 'recall': 0.06300222260215421, 'f1-score': 0.10878228782287823, 'support': 11698}, 'accuracy': 0.29950526449321324, 'macro avg': {'precision': 0.3366973027405358, 'recall': 0.3384952851712713, 'f1-score': 0.18704641353539117, 'support': 31532}, 'weighted avg': {'precision': 0.3407877959131497, 'recall': 0.29950526449321324, 'f1-score': 0.17165232405412684, 'support': 31532}}
[[   22  9991   683]
 [   21  8685   432]
 [   26 10935   737]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
925/925 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966386
{'0': {'precision': 0.26670850329463447, 'recall': 0.012081242804553917, 'f1-score': 0.023115413901881866, 'support': 70357}, '1': {'precision': 0.371020827299297, 'recall': 0.9592566118656183, 'f1-score': 0.5350826395283709, 'support': 88137}, '2': {'precision': 0.3243387182673531, 'recall': 0.023363171355498723, 'f1-score': 0.043586654420097105, 'support': 78200}, 'accuracy': 0.3685053275537192, 'macro avg': {'precision': 0.32068934962042817, 'recall': 0.33156700867522365, 'f1-score': 0.20059490261678328, 'support': 236694}, 'weighted avg': {'precision': 0.3245910778916481, 'recall': 0.3685053275537192, 'f1-score': 0.22051841682365553, 'support': 236694}}
[[  850 68146  1361]
 [ 1146 84546  2445]
 [ 1191 75182  1827]]
Evaluating performance on  train set...
346/346 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006941
{'0': {'precision': 0.333889816360601, 'recall': 0.013545546901456146, 'f1-score': 0.02603488674824264, 'support': 29530}, '1': {'precision': 0.3297352507631417, 'recall': 0.9702527322404372, 'f1-score': 0.492199208226132, 'support': 29280}, '2': {'precision': 0.2716049382716049, 'recall': 0.011088709677419355, 'f1-score': 0.021307506053268765, 'support': 29760}, 'accuracy': 0.32899401603251666, 'macro avg': {'precision': 0.31174333513178254, 'recall': 0.3316289962731042, 'f1-score': 0.17984720034254784, 'support': 88570}, 'weighted avg': {'precision': 0.3115883186455493, 'recall': 0.32899401603251666, 'f1-score': 0.17855384896332874, 'support': 88570}}
[[  400 28719   411]
 [  397 28409   474]
 [  401 29029   330]]
Evaluating performance on  val set...
127/127 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035643
{'0': {'precision': 0.3441682600382409, 'recall': 0.016926838442730862, 'f1-score': 0.032266738370529714, 'support': 10634}, '1': {'precision': 0.3027209799355641, 'recall': 0.9695545565999183, 'f1-score': 0.46138512774388024, 'support': 9788}, '2': {'precision': 0.2631578947368421, 'recall': 0.008861507300194109, 'f1-score': 0.01714565643370346, 'support': 11849}, 'accuracy': 0.3029035356821914, 'macro avg': {'precision': 0.303349044903549, 'recall': 0.3317809674476144, 'f1-score': 0.17026584084937113, 'support': 32271}, 'weighted avg': {'precision': 0.30185231705223875, 'recall': 0.3029035356821914, 'f1-score': 0.15686904679967356, 'support': 32271}}
[[  180 10326   128]
 [  132  9490   166]
 [  211 11533   105]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
1590/1590 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001278
{'0': {'precision': 0.22981366459627328, 'recall': 0.0005488067162075972, 'f1-score': 0.00109499852027227, 'support': 134838}, '1': {'precision': 0.34567121132669115, 'recall': 0.9426430527452256, 'f1-score': 0.5058463994045209, 'support': 139861}, '2': {'precision': 0.32291378150595496, 'recall': 0.06168742819132854, 'f1-score': 0.10358636533835971, 'support': 132296}, 'accuracy': 0.3441663902504945, 'macro avg': {'precision': 0.29946621914297317, 'recall': 0.3349597625509206, 'f1-score': 0.20350925442105097, 'support': 406995}, 'weighted avg': {'precision': 0.2998900178928647, 'recall': 0.3441663902504945, 'f1-score': 0.20786469727243778, 'support': 406995}}
[[    74 125528   9236]
 [   146 131839   7876]
 [   102 124033   8161]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016986
{'0': {'precision': 0.35, 'recall': 0.001552863924752651, 'f1-score': 0.0030920093643712183, 'support': 45078}, '1': {'precision': 0.3283150243466397, 'recall': 0.9345996741144171, 'f1-score': 0.48592848770410946, 'support': 44801}, '2': {'precision': 0.35909822866344604, 'recall': 0.07465997070516844, 'f1-score': 0.12361847347815542, 'support': 47790}, 'accuracy': 0.3305682470272901, 'macro avg': {'precision': 0.34580441767002856, 'recall': 0.3369375029147794, 'f1-score': 0.20421299018221203, 'support': 137669}, 'weighted avg': {'precision': 0.3461014880153113, 'recall': 0.3305682470272901, 'f1-score': 0.20205849264017303, 'support': 137669}}
[[   70 41510  3498]
 [   60 41871  2870]
 [   70 44152  3568]]
Evaluating performance on  val set...
209/209 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046861
{'0': {'precision': 0.3076923076923077, 'recall': 0.0008080808080808081, 'f1-score': 0.0016119282691920208, 'support': 19800}, '1': {'precision': 0.32366271905090127, 'recall': 0.9020315501484371, 'f1-score': 0.47638957206099364, 'support': 17179}, '2': {'precision': 0.33866618730900594, 'recall': 0.11409192757221583, 'f1-score': 0.1706830947635441, 'support': 16513}, 'accuracy': 0.3252075076646975, 'macro avg': {'precision': 0.3233404046840716, 'recall': 0.33897718617624456, 'f1-score': 0.2162281983645766, 'support': 53492}, 'weighted avg': {'precision': 0.3223828664831515, 'recall': 0.3252075076646975, 'f1-score': 0.20627949192395525, 'support': 53492}}
[[   16 17772  2012]
 [   16 15496  1667]
 [   20 14609  1884]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
3782/3782 - 32s - 32s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1277846
{'0': {'precision': 0.4667059516794343, 'recall': 0.002251426329748676, 'f1-score': 0.004481234829152921, 'support': 351777}, '1': {'precision': 0.21945769084233135, 'recall': 0.9891773564254138, 'f1-score': 0.35921940037297867, 'support': 211963}, '2': {'precision': 0.420941154802468, 'recall': 0.01130842231304365, 'f1-score': 0.02202514750488471, 'support': 404212}, 'accuracy': 0.22215151164520555, 'macro avg': {'precision': 0.3690349324414112, 'recall': 0.3342457350227354, 'f1-score': 0.12857526090233876, 'support': 967952}, 'weighted avg': {'precision': 0.39345215067788963, 'recall': 0.22215151164520555, 'f1-score': 0.08948836928793688, 'support': 967952}}
[[   792 346679   4306]
 [   312 209669   1982]
 [   593 399048   4571]]
Evaluating performance on  train set...
1601/1601 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027442
{'0': {'precision': 0.3548387096774194, 'recall': 0.0011120257643371892, 'f1-score': 0.0022171033688453785, 'support': 138486}, '1': {'precision': 0.32933558041465105, 'recall': 0.987401399017711, 'f1-score': 0.4939276680570213, 'support': 134380}, '2': {'precision': 0.3894163424124514, 'recall': 0.018277983139254564, 'f1-score': 0.03491706847345982, 'support': 136886}, 'accuracy': 0.33030467209434, 'macro avg': {'precision': 0.35786354416817395, 'recall': 0.33559713597376756, 'f1-score': 0.1770206132997755, 'support': 409752}, 'weighted avg': {'precision': 0.35802620680796854, 'recall': 0.33030467209434, 'f1-score': 0.1743998702768955, 'support': 409752}}
[[   154 135936   2396]
 [   166 132687   1527]
 [   114 134270   2502]]
Evaluating performance on  val set...
532/532 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109314
{'0': {'precision': 0.38011695906432746, 'recall': 0.0013002860629338455, 'f1-score': 0.00259170653907496, 'support': 49989}, '1': {'precision': 0.29647743683654176, 'recall': 0.987625849327977, 'f1-score': 0.4560517577006756, 'support': 40326}, '2': {'precision': 0.3502722323049002, 'recall': 0.012630063477521105, 'f1-score': 0.024381000505305714, 'support': 45843}, 'accuracy': 0.2972355645646969, 'macro avg': {'precision': 0.3422888760685898, 'recall': 0.33385206628947733, 'f1-score': 0.16100815491501877, 'support': 136158}, 'weighted avg': {'precision': 0.3452969765279351, 'recall': 0.2972355645646969, 'f1-score': 0.1442294849027159, 'support': 136158}}
[[   65 49277   647]
 [   72 39827   427]
 [   34 45230   579]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
4457/4457 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0865502
{'0': {'precision': 0.20478507704785076, 'recall': 0.0014254785232607045, 'f1-score': 0.0028312491415148026, 'support': 354267}, '1': {'precision': 0.4164616455474495, 'recall': 0.975978409279416, 'f1-score': 0.5838062083007606, 'support': 470202}, '2': {'precision': 0.35623667085908023, 'recall': 0.04116717747796139, 'f1-score': 0.07380531575011896, 'support': 316490}, 'accuracy': 0.4140735994895522, 'macro avg': {'precision': 0.3258277978181268, 'recall': 0.33952368842687936, 'f1-score': 0.22014759106413143, 'support': 1140959}, 'weighted avg': {'precision': 0.3340304406296835, 'recall': 0.4140735994895522, 'f1-score': 0.2619450035249351, 'support': 1140959}}
[[   505 340435  13327]
 [  1077 458907  10218]
 [   884 302577  13029]]
Evaluating performance on  train set...
2425/2425 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018438
{'0': {'precision': 0.33469945355191255, 'recall': 0.0024019136879669025, 'f1-score': 0.004769599158993128, 'support': 204004}, '1': {'precision': 0.3322643595481671, 'recall': 0.9737566364772018, 'f1-score': 0.4954661925949468, 'support': 204928}, '2': {'precision': 0.36984542974808793, 'recall': 0.032647954486437994, 'f1-score': 0.05999947939714188, 'support': 211805}, 'accuracy': 0.33340206883108303, 'macro avg': {'precision': 0.34560308094938924, 'recall': 0.33626883488386894, 'f1-score': 0.18674509038369394, 'support': 620737}, 'weighted avg': {'precision': 0.34588788688878686, 'recall': 0.33340206883108303, 'f1-score': 0.18561178559782987, 'support': 620737}}
[[   490 196616   6898]
 [   494 199550   4884]
 [   480 204410   6915]]
Evaluating performance on  val set...
787/787 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959895
{'0': {'precision': 0.4420289855072464, 'recall': 0.0017960986382039013, 'f1-score': 0.00357766015161068, 'support': 67925}, '1': {'precision': 0.3519967337773355, 'recall': 0.9802310873612552, 'f1-score': 0.5179866921008757, 'support': 70363}, '2': {'precision': 0.3693261347730454, 'recall': 0.029348206057139226, 'f1-score': 0.054375505998380806, 'support': 62934}, 'accuracy': 0.35255091391597343, 'macro avg': {'precision': 0.38778395135254246, 'recall': 0.33712513068553274, 'f1-score': 0.19197995275028903, 'support': 201222}, 'weighted avg': {'precision': 0.38780817199491713, 'recall': 0.35255091391597343, 'f1-score': 0.19934290622593037, 'support': 201222}}
[[  122 65963  1840]
 [   77 68972  1314]
 [   77 61010  1847]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
4676/4676 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989915
{'0': {'precision': 0.4382638010956595, 'recall': 0.0025605168304740893, 'f1-score': 0.005091288267273051, 'support': 406168}, '1': {'precision': 0.34409716393931195, 'recall': 0.9815630489005499, 'f1-score': 0.5095620402316525, 'support': 409341}, '2': {'precision': 0.39034892353377876, 'recall': 0.02756632064590542, 'f1-score': 0.0514960090103325, 'support': 381480}, 'accuracy': 0.34532481083786065, 'macro avg': {'precision': 0.39090329618958336, 'recall': 0.33722996212564316, 'f1-score': 0.18871644583641933, 'support': 1196989}, 'weighted avg': {'precision': 0.39079065563440396, 'recall': 0.34532481083786065, 'f1-score': 0.19239713230503228, 'support': 1196989}}
[[  1040 395532   9596]
 [   719 401794   6828]
 [   614 370350  10516]]
Evaluating performance on  train set...
2108/2108 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997505
{'0': {'precision': 0.3745583038869258, 'recall': 0.0011737154183022096, 'f1-score': 0.002340097908813449, 'support': 180623}, '1': {'precision': 0.33898243880188533, 'recall': 0.982158492062181, 'f1-score': 0.5040105459626794, 'support': 181599}, '2': {'precision': 0.3914688953717575, 'recall': 0.028021243093454936, 'f1-score': 0.052298941380944854, 'support': 177187}, 'accuracy': 0.3402538704396849, 'macro avg': {'precision': 0.36833654602018956, 'recall': 0.33711781685797937, 'f1-score': 0.18621652841747918, 'support': 539409}, 'weighted avg': {'precision': 0.36813608150992544, 'recall': 0.3402538704396849, 'f1-score': 0.1876445872562855, 'support': 539409}}
[[   212 175726   4685]
 [   207 178359   3033]
 [   147 172075   4965]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066141
{'0': {'precision': 0.46798029556650245, 'recall': 0.0026538907435084435, 'f1-score': 0.005277851081265017, 'support': 71593}, '1': {'precision': 0.3046621828187099, 'recall': 0.9748434850658667, 'f1-score': 0.46423857513315425, 'support': 61336}, '2': {'precision': 0.44147734821309953, 'recall': 0.046629434216434666, 'f1-score': 0.0843497353758678, 'support': 71264}, 'accuracy': 0.31003021651085005, 'macro avg': {'precision': 0.404706608866104, 'recall': 0.3413756033419366, 'f1-score': 0.184622053863429, 'support': 204193}, 'weighted avg': {'precision': 0.4096727835377282, 'recall': 0.31003021651085005, 'f1-score': 0.1707379487967462, 'support': 204193}}
[[  190 68623  2780]
 [  119 59793  1424]
 [   97 67844  3323]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
4274/4274 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069398
{'0': {'precision': 0.46055045871559636, 'recall': 0.0019342310083174503, 'f1-score': 0.0038522831044388224, 'support': 389302}, '1': {'precision': 0.28748952443431947, 'recall': 0.930146927972614, 'f1-score': 0.4392238708824768, 'support': 309063}, '2': {'precision': 0.4129687297262229, 'recall': 0.09652009097801365, 'f1-score': 0.15646969175556757, 'support': 395700}, 'accuracy': 0.2983552165547751, 'macro avg': {'precision': 0.38700290429204626, 'recall': 0.3428670833196484, 'f1-score': 0.1998486152474944, 'support': 1094065}, 'weighted avg': {'precision': 0.39445308635392734, 'recall': 0.2983552165547751, 'f1-score': 0.18203909799815665, 'support': 1094065}}
[[   753 355128  33421]
 [   719 287474  20870]
 [   163 357344  38193]]
Evaluating performance on  train set...
1972/1972 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984883
{'0': {'precision': 0.3257261410788382, 'recall': 0.0009703577344310119, 'f1-score': 0.0019349511332404886, 'support': 161796}, '1': {'precision': 0.34296678208271203, 'recall': 0.9545643725123539, 'f1-score': 0.5046258349512006, 'support': 170593}, '2': {'precision': 0.390045743155595, 'recall': 0.066356545928649, 'f1-score': 0.11341787229818596, 'support': 172191}, 'accuracy': 0.34568353878473185, 'macro avg': {'precision': 0.35291288877238175, 'recall': 0.3406304253918113, 'f1-score': 0.20665955279420903, 'support': 504580}, 'weighted avg': {'precision': 0.3535044701286869, 'recall': 0.34568353878473185, 'f1-score': 0.20993348778049245, 'support': 504580}}
[[   157 151352  10287]
 [   170 162842   7581]
 [   155 160610  11426]]
Evaluating performance on  val set...
707/707 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045451
{'0': {'precision': 0.3125, 'recall': 0.0004720469529369188, 'f1-score': 0.0009426699555374005, 'support': 63553}, '1': {'precision': 0.32009633332744497, 'recall': 0.9519981786977689, 'f1-score': 0.4791013929466926, 'support': 57102}, '2': {'precision': 0.3576770381312898, 'recall': 0.0644603071598529, 'f1-score': 0.10923445650641478, 'support': 60099}, 'accuracy': 0.3223441804883986, 'macro avg': {'precision': 0.3300911238195782, 'recall': 0.3389768442701862, 'f1-score': 0.1964261731362149, 'support': 180754}, 'weighted avg': {'precision': 0.32992069686046316, 'recall': 0.3223441804883986, 'f1-score': 0.18800379988993512, 'support': 180754}}
[[   30 59275  4248]
 [   32 54361  2709]
 [   34 56191  3874]]
testing model on single stock: results/universal/W4/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
12724/12724 - 124s - 124s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0850184
{'0': {'precision': 0.20923520923520925, 'recall': 0.002273348294876791, 'f1-score': 0.004497827527147602, 'support': 892956}, '1': {'precision': 0.4495226092125976, 'recall': 0.90027590641716, 'f1-score': 0.5996367158176422, 'support': 1455566}, '2': {'precision': 0.30155448833682386, 'recall': 0.11029302517540239, 'f1-score': 0.16151296624449113, 'support': 908625}, 'accuracy': 0.4337096237903908, 'macro avg': {'precision': 0.32010410226154357, 'recall': 0.3376140932958131, 'f1-score': 0.2552158365297603, 'support': 3257147}, 'weighted avg': {'precision': 0.3423694443830831, 'recall': 0.4337096237903908, 'f1-score': 0.3142572002206393, 'support': 3257147}}
[[   2030  798529   92397]
 [   5439 1310411  139716]
 [   2233  806177  100215]]
Evaluating performance on  train set...
5165/5165 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10068
{'0': {'precision': 0.3216200119118523, 'recall': 0.0024599853767535936, 'f1-score': 0.004882624862958735, 'support': 439027}, '1': {'precision': 0.334077027905028, 'recall': 0.8803098599275866, 'f1-score': 0.4843453179323784, 'support': 437488}, '2': {'precision': 0.3551563507511706, 'recall': 0.13226373300836874, 'f1-score': 0.19274669352834214, 'support': 445587}, 'accuracy': 0.33669111762935083, 'macro avg': {'precision': 0.33695113018935025, 'recall': 0.3383445261042363, 'f1-score': 0.22732487877455976, 'support': 1322102}, 'weighted avg': {'precision': 0.33704480638854, 'recall': 0.33669111762935083, 'f1-score': 0.22685412284870904, 'support': 1322102}}
[[  1080 382171  55776]
 [  1133 385125  51230]
 [  1145 385507  58935]]
Evaluating performance on  val set...
1903/1903 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981218
{'0': {'precision': 0.32825040128410915, 'recall': 0.002559785704003655, 'f1-score': 0.005079956528489364, 'support': 159779}, '1': {'precision': 0.36030810083045356, 'recall': 0.8913145119860543, 'f1-score': 0.5131704009943437, 'support': 173243}, '2': {'precision': 0.34913363523508123, 'recall': 0.1296808634999805, 'f1-score': 0.1891168768438848, 'support': 153978}, 'accuracy': 0.35891375770020534, 'macro avg': {'precision': 0.345897379116548, 'recall': 0.3411850537300128, 'f1-score': 0.2357890781222393, 'support': 487000}, 'weighted avg': {'precision': 0.34625724038022854, 'recall': 0.35891375770020534, 'f1-score': 0.24401373432504375, 'support': 487000}}
[[   409 140526  18844]
 [   448 154414  18381]
 [   389 133621  19968]]
training model: results/universal/W4/deepVOL_L3/h300
Epoch 1/50
9854/9854 - 538s - loss: 3.2731 - accuracy300: 0.3703 - val_loss: 3.2927 - val_accuracy300: 0.3455 - 538s/epoch - 55ms/step
Epoch 2/50
9854/9854 - 533s - loss: 3.2566 - accuracy300: 0.3873 - val_loss: 3.3000 - val_accuracy300: 0.3527 - 533s/epoch - 54ms/step
Epoch 3/50
9854/9854 - 537s - loss: 3.2448 - accuracy300: 0.3965 - val_loss: 3.3067 - val_accuracy300: 0.3516 - 537s/epoch - 55ms/step
Epoch 4/50
9854/9854 - 545s - loss: 3.2368 - accuracy300: 0.4023 - val_loss: 3.2995 - val_accuracy300: 0.3558 - 545s/epoch - 55ms/step
Epoch 5/50
9854/9854 - 542s - loss: 3.2302 - accuracy300: 0.4055 - val_loss: 3.2924 - val_accuracy300: 0.3594 - 542s/epoch - 55ms/step
Epoch 6/50
9854/9854 - 539s - loss: 3.2238 - accuracy300: 0.4091 - val_loss: 3.2906 - val_accuracy300: 0.3578 - 539s/epoch - 55ms/step
Epoch 7/50
9854/9854 - 530s - loss: 3.2180 - accuracy300: 0.4116 - val_loss: 3.2913 - val_accuracy300: 0.3596 - 530s/epoch - 54ms/step
Epoch 8/50
9854/9854 - 555s - loss: 3.2132 - accuracy300: 0.4141 - val_loss: 3.2943 - val_accuracy300: 0.3606 - 555s/epoch - 56ms/step
Epoch 9/50
9854/9854 - 538s - loss: 3.2090 - accuracy300: 0.4161 - val_loss: 3.2935 - val_accuracy300: 0.3612 - 538s/epoch - 55ms/step
Epoch 10/50
9854/9854 - 540s - loss: 3.2057 - accuracy300: 0.4175 - val_loss: 3.2914 - val_accuracy300: 0.3619 - 540s/epoch - 55ms/step
Epoch 11/50
9854/9854 - 533s - loss: 3.2026 - accuracy300: 0.4190 - val_loss: 3.3054 - val_accuracy300: 0.3607 - 533s/epoch - 54ms/step
Epoch 12/50
9854/9854 - 556s - loss: 3.2001 - accuracy300: 0.4202 - val_loss: 3.2909 - val_accuracy300: 0.3621 - 556s/epoch - 56ms/step
Epoch 13/50
9854/9854 - 549s - loss: 3.1978 - accuracy300: 0.4213 - val_loss: 3.2969 - val_accuracy300: 0.3609 - 549s/epoch - 56ms/step
Epoch 14/50
9854/9854 - 558s - loss: 3.1957 - accuracy300: 0.4224 - val_loss: 3.3071 - val_accuracy300: 0.3617 - 558s/epoch - 57ms/step
Epoch 15/50
9854/9854 - 558s - loss: 3.1935 - accuracy300: 0.4236 - val_loss: 3.3010 - val_accuracy300: 0.3632 - 558s/epoch - 57ms/step
Epoch 16/50
9854/9854 - 555s - loss: 3.1919 - accuracy300: 0.4245 - val_loss: 3.3268 - val_accuracy300: 0.3629 - 555s/epoch - 56ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 704s - 704s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027813
{'0': {'precision': 0.3381537448275727, 'recall': 0.375467194244526, 'f1-score': 0.35583495618494043, 'support': 1837833}, '1': {'precision': 0.36928261084230274, 'recall': 0.1280203820696667, 'f1-score': 0.19012835878944406, 'support': 2336956}, '2': {'precision': 0.3244647441679088, 'recall': 0.5509420394529434, 'f1-score': 0.40840731698023613, 'support': 1896842}, 'accuracy': 0.33504572329906085, 'macro avg': {'precision': 0.3439670332792614, 'recall': 0.35147653858904543, 'f1-score': 0.3181235439848736, 'support': 6071631}, 'weighted avg': {'precision': 0.3458585804503306, 'recall': 0.33504572329906085, 'f1-score': 0.30847905378782187, 'support': 6071631}}
[[ 690046  236916  910871]
 [ 772856  299178 1264922]
 [ 577726  274066 1045050]]
Evaluating performance on  train set...
9854/9854 - 300s - 300s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965531
{'0': {'precision': 0.3625471401164036, 'recall': 0.3565230286503174, 'f1-score': 0.3595098504628531, 'support': 849659}, '1': {'precision': 0.35415870487470413, 'recall': 0.13394573860910397, 'f1-score': 0.1943766337003633, 'support': 823311}, '2': {'precision': 0.35681825619320845, 'recall': 0.5778924420145363, 'f1-score': 0.44121154025998316, 'support': 849049}, 'accuracy': 0.3583878630573362, 'macro avg': {'precision': 0.3578413670614387, 'recall': 0.3561204030913192, 'f1-score': 0.33169934147439983, 'support': 2522019}, 'weighted avg': {'precision': 0.3578800879754864, 'recall': 0.3583878630573362, 'f1-score': 0.3331074895744622, 'support': 2522019}}
[[302923  96394 450342]
 [278938 110279 434094]
 [253680 104710 490659]]
Evaluating performance on  val set...
3566/3566 - 107s - 107s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962981
{'0': {'precision': 0.36470139659809087, 'recall': 0.3522613573032536, 'f1-score': 0.35837345322882264, 'support': 306829}, '1': {'precision': 0.35259496550155434, 'recall': 0.12351552617687192, 'f1-score': 0.18294473006763984, 'support': 301201}, '2': {'precision': 0.3548641760549447, 'recall': 0.5952576547209864, 'f1-score': 0.44464953933424073, 'support': 304322}, 'accuracy': 0.3577972098488303, 'macro avg': {'precision': 0.35738684605153, 'recall': 0.3570115127337039, 'f1-score': 0.3286559075435677, 'support': 912352}, 'weighted avg': {'precision': 0.35742333749059807, 'recall': 0.3577972098488303, 'f1-score': 0.32923601968442484, 'support': 912352}}
[[108084  33486 165259]
 [ 99930  37203 164068]
 [ 88349  34823 181150]]
testing model out of sample: results/universal/W4/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 360s - 360s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997748
{'0': {'precision': 0.3303891127446938, 'recall': 0.3580684686781935, 'f1-score': 0.3436723680896534, 'support': 962221}, '1': {'precision': 0.4100777949852063, 'recall': 0.17748790918171914, 'f1-score': 0.24774710272434922, 'support': 1150253}, '2': {'precision': 0.32749414639282987, 'recall': 0.5312206256092467, 'f1-score': 0.4051907594987655, 'support': 919168}, 'accuracy': 0.342051601079547, 'macro avg': {'precision': 0.35598701804091, 'recall': 0.3555923344897198, 'f1-score': 0.332203410104256, 'support': 3031642}, 'weighted avg': {'precision': 0.35974653205128937, 'recall': 0.342051601079547, 'f1-score': 0.3259286544626795, 'support': 3031642}}
[[344541 141186 476494]
 [419911 204156 526186]
 [278382 152505 488281]]
Evaluating performance on  train set...
5528/5528 - 163s - 163s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954379
{'0': {'precision': 0.3567764297454193, 'recall': 0.4148714593678611, 'f1-score': 0.3836370452503318, 'support': 466195}, '1': {'precision': 0.35619735728190943, 'recall': 0.19537325122077523, 'f1-score': 0.25233917360945096, 'support': 467326}, '2': {'precision': 0.3715922925831534, 'recall': 0.4759649272366996, 'f1-score': 0.4173521134977798, 'support': 480943}, 'accuracy': 0.36312412334283517, 'macro avg': {'precision': 0.36152202653682736, 'recall': 0.36206987927511197, 'f1-score': 0.35110944411918754, 'support': 1414464}, 'weighted avg': {'precision': 0.3616227672292196, 'recall': 0.36312412334283517, 'f1-score': 0.35172115124785885, 'support': 1414464}}
[[193411  75490 197294]
 [186199  91303 189824]
 [162497  89534 228912]]
Evaluating performance on  val set...
1908/1908 - 61s - 61s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960075
{'0': {'precision': 0.3644407158836689, 'recall': 0.39793587786259543, 'f1-score': 0.3804524886877828, 'support': 163750}, '1': {'precision': 0.35480457415941286, 'recall': 0.18828459462233788, 'f1-score': 0.24601571622431911, 'support': 165611}, '2': {'precision': 0.35283254576068657, 'recall': 0.49256900212314225, 'f1-score': 0.41115225165353336, 'support': 158256}, 'accuracy': 0.3574444697375194, 'macro avg': {'precision': 0.35735927860125605, 'recall': 0.3595964915360252, 'f1-score': 0.3458734855218784, 'support': 487617}, 'weighted avg': {'precision': 0.3574005313985536, 'recall': 0.3574444697375194, 'f1-score': 0.34475687791839027, 'support': 487617}}
[[65162 27386 71202]
 [62651 31182 71778]
 [50987 29317 77952]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
534/534 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997936
{'0': {'precision': 0.38021758078574425, 'recall': 0.22833989259611098, 'f1-score': 0.28532667942537365, 'support': 51581}, '1': {'precision': 0.29090426942455583, 'recall': 0.028822153910827358, 'f1-score': 0.05244788678523619, 'support': 38061}, '2': {'precision': 0.34510234922379446, 'recall': 0.7480643240023823, 'f1-score': 0.472313622261916, 'support': 47012}, 'accuracy': 0.3515667305750289, 'macro avg': {'precision': 0.3387413998113648, 'recall': 0.33507545683644024, 'f1-score': 0.2700293961575086, 'support': 136654}, 'weighted avg': {'precision': 0.3432615369823534, 'recall': 0.3515667305750289, 'f1-score': 0.2847927062519229, 'support': 136654}}
[[11778  1440 38363]
 [ 8589  1097 28375]
 [10610  1234 35168]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1072885
{'0': {'precision': 0.3312220309810671, 'recall': 0.22302058223623214, 'f1-score': 0.26655954788486574, 'support': 21572}, '1': {'precision': 0.32225705329153603, 'recall': 0.023796296296296298, 'f1-score': 0.044319896529424446, 'support': 21600}, '2': {'precision': 0.3325753851196329, 'recall': 0.7459566256202904, 'f1-score': 0.4600453386228394, 'support': 21764}, 'accuracy': 0.3320192189232475, 'macro avg': {'precision': 0.3286848231307454, 'recall': 0.33092450138427293, 'f1-score': 0.2569749276790432, 'support': 64936}, 'weighted avg': {'precision': 0.328693554964341, 'recall': 0.3320192189232475, 'f1-score': 0.2574836620949145, 'support': 64936}}
[[ 4811   523 16238]
 [ 4743   514 16343]
 [ 4971   558 16235]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037428
{'0': {'precision': 0.34918941979522183, 'recall': 0.22440027416038383, 'f1-score': 0.27322039556037725, 'support': 7295}, '1': {'precision': 0.31150442477876106, 'recall': 0.028264011562550186, 'f1-score': 0.05182567726737338, 'support': 6227}, '2': {'precision': 0.34300963290809683, 'recall': 0.7427766032417196, 'f1-score': 0.46929961262745457, 'support': 7095}, 'accuracy': 0.3435514381335791, 'macro avg': {'precision': 0.33456782582735994, 'recall': 0.33181362965488453, 'f1-score': 0.26478189515173506, 'support': 20617}, 'weighted avg': {'precision': 0.3356806623653507, 'recall': 0.3435514381335791, 'f1-score': 0.27382946255753393, 'support': 20617}}
[[1637  199 5459]
 [1416  176 4635]
 [1635  190 5270]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
1613/1613 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0846925
{'0': {'precision': 0.3944888417933585, 'recall': 0.5839130371639775, 'f1-score': 0.4708641360835005, 'support': 137714}, '1': {'precision': 0.3257285153210228, 'recall': 0.26568543990919546, 'f1-score': 0.29265905249174357, 'support': 133914}, '2': {'precision': 0.4433498030647732, 'recall': 0.31324661346400323, 'f1-score': 0.3671120331950207, 'support': 141221}, 'accuracy': 0.3881055785529334, 'macro avg': {'precision': 0.38785572005971813, 'recall': 0.3876150301790587, 'f1-score': 0.37687840725675487, 'support': 412849}, 'weighted avg': {'precision': 0.3888989613588512, 'recall': 0.3881055785529334, 'f1-score': 0.3775706285635101, 'support': 412849}}
[[80413 30718 26583]
 [69376 35579 28959]
 [54052 42932 44237]]
Evaluating performance on  train set...
634/634 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0867605
{'0': {'precision': 0.38603685702713647, 'recall': 0.4187873018197796, 'f1-score': 0.40174572788422697, 'support': 54622}, '1': {'precision': 0.3460252920299094, 'recall': 0.1877570862313963, 'f1-score': 0.2434276710502394, 'support': 53484}, '2': {'precision': 0.3921985143893166, 'recall': 0.5360022189349113, 'f1-score': 0.4529608013188633, 'support': 54080}, 'accuracy': 0.3816852256051694, 'macro avg': {'precision': 0.3747535544821208, 'recall': 0.38084886899536236, 'f1-score': 0.36604473341777655, 'support': 162186}, 'weighted avg': {'precision': 0.37489683191914325, 'recall': 0.3816852256051694, 'f1-score': 0.3666146328429542, 'support': 162186}}
[[22875  9236 22511]
 [21031 10042 22411]
 [15350  9743 28987]]
Evaluating performance on  val set...
206/206 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088517
{'0': {'precision': 0.3740734356145492, 'recall': 0.512124609121482, 'f1-score': 0.4323462754962269, 'support': 16949}, '1': {'precision': 0.34613701986175516, 'recall': 0.2173745810209352, 'f1-score': 0.2670446874578102, 'support': 18199}, '2': {'precision': 0.40979167817870366, 'recall': 0.42179501763166877, 'f1-score': 0.4157067182376188, 'support': 17582}, 'accuracy': 0.3802768822302295, 'macro avg': {'precision': 0.3766673778850027, 'recall': 0.38376473592469534, 'f1-score': 0.3716992270638853, 'support': 52730}, 'weighted avg': {'precision': 0.3763412776490242, 'recall': 0.3802768822302295, 'f1-score': 0.3697466112361853, 'support': 52730}}
[[8680 3331 4938]
 [8500 3956 5743]
 [6024 4142 7416]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
989/989 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1088552
{'0': {'precision': 0.3668846281724482, 'recall': 0.18853224593935805, 'f1-score': 0.2490726737843186, 'support': 87794}, '1': {'precision': 0.3438177874186551, 'recall': 0.02938313945404829, 'f1-score': 0.05413944750437641, 'support': 86308}, '2': {'precision': 0.3150969183651074, 'recall': 0.8009687194897739, 'f1-score': 0.4522722797973832, 'support': 78867}, 'accuracy': 0.325170277781072, 'macro avg': {'precision': 0.3419331113187369, 'recall': 0.3396280349610601, 'f1-score': 0.2518281336953594, 'support': 252969}, 'weighted avg': {'precision': 0.3428690602524504, 'recall': 0.325170277781072, 'f1-score': 0.24591594878506223, 'support': 252969}}
[[16552  2579 68663]
 [15127  2536 68645]
 [13436  2261 63170]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011338
{'0': {'precision': 0.331356160690213, 'recall': 0.217838278563579, 'f1-score': 0.2628652093938487, 'support': 28209}, '1': {'precision': 0.38849407783417933, 'recall': 0.04013565010663217, 'f1-score': 0.07275492743519868, 'support': 28603}, '2': {'precision': 0.34892838473601673, 'recall': 0.7633703329969728, 'f1-score': 0.4789389271092728, 'support': 29730}, 'accuracy': 0.346513831434448, 'macro avg': {'precision': 0.356259541086803, 'recall': 0.34044808722239467, 'f1-score': 0.2715196879794401, 'support': 86542}, 'weighted avg': {'precision': 0.35627744821477464, 'recall': 0.346513831434448, 'f1-score': 0.2742602225991859, 'support': 86542}}
[[ 6145   844 21220]
 [ 6328  1148 21127]
 [ 6072   963 22695]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974067
{'0': {'precision': 0.35599879117558175, 'recall': 0.2208888055503469, 'f1-score': 0.2726220782226337, 'support': 10666}, '1': {'precision': 0.3534798534798535, 'recall': 0.04005811540058116, 'f1-score': 0.07196122296793438, 'support': 9636}, '2': {'precision': 0.3661321467551003, 'recall': 0.7766696349065004, 'f1-score': 0.4976606185096428, 'support': 11230}, 'accuracy': 0.3635671698591907, 'macro avg': {'precision': 0.3585369304701785, 'recall': 0.3458721852858095, 'f1-score': 0.28074797323340367, 'support': 31532}, 'weighted avg': {'precision': 0.35883797357828234, 'recall': 0.3635671698591907, 'f1-score': 0.2914478680928871, 'support': 31532}}
[[2356  355 7955]
 [2105  386 7145]
 [2157  351 8722]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1110853
{'0': {'precision': 0.3043441600053965, 'recall': 0.25032943559014054, 'f1-score': 0.27470679118052227, 'support': 72093}, '1': {'precision': 0.37332624867162595, 'recall': 0.03931201181710347, 'f1-score': 0.0711335196209452, 'support': 89362}, '2': {'precision': 0.3179491148071863, 'recall': 0.7098845013889074, 'f1-score': 0.43919005036488845, 'support': 75239}, 'accuracy': 0.3167422917353207, 'macro avg': {'precision': 0.33187317449473624, 'recall': 0.3331753162653838, 'f1-score': 0.261676787055452, 'support': 236694}, 'weighted avg': {'precision': 0.33471248620599076, 'recall': 0.3167422917353207, 'f1-score': 0.2501343104444901, 'support': 236694}}
[[18047  2821 51225]
 [22499  3513 63350]
 [18752  3076 53411]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1061444
{'0': {'precision': 0.3384159058256477, 'recall': 0.2442548921224285, 'f1-score': 0.28372707491451665, 'support': 29895}, '1': {'precision': 0.32124930284439485, 'recall': 0.039303991811668375, 'f1-score': 0.07003891050583658, 'support': 29310}, '2': {'precision': 0.3311937167820588, 'recall': 0.7151370679380215, 'f1-score': 0.45272280429439915, 'support': 29365}, 'accuracy': 0.3325505250084679, 'macro avg': {'precision': 0.3302863084840338, 'recall': 0.33289865062403945, 'f1-score': 0.2688295965715841, 'support': 88570}, 'weighted avg': {'precision': 0.33034056750967716, 'recall': 0.3325505250084679, 'f1-score': 0.269042187192058, 'support': 88570}}
[[ 7302  1200 21393]
 [ 7144  1152 21014]
 [ 7131  1234 21000]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1019126
{'0': {'precision': 0.3305626598465473, 'recall': 0.2388432042871662, 'f1-score': 0.27731588263691465, 'support': 10823}, '1': {'precision': 0.2985529322162985, 'recall': 0.039117852509729566, 'f1-score': 0.06917240162343391, 'support': 10021}, '2': {'precision': 0.35214798167516637, 'recall': 0.7130480441060646, 'f1-score': 0.4714595689281065, 'support': 11427}, 'accuracy': 0.3447367605590158, 'macro avg': {'precision': 0.32708785791267075, 'recall': 0.33033636696765345, 'f1-score': 0.27264928439615166, 'support': 32271}, 'weighted avg': {'precision': 0.32826604653902375, 'recall': 0.3447367605590158, 'f1-score': 0.2814271305069329, 'support': 32271}}
[[2585  439 7799]
 [2438  392 7191]
 [2797  482 8148]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
1590/1590 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1106884
{'0': {'precision': 0.33321203575246194, 'recall': 0.22243308485280944, 'f1-score': 0.2667795622564551, 'support': 131734}, '1': {'precision': 0.36975397973950797, 'recall': 0.031192560991325224, 'f1-score': 0.057531727515527556, 'support': 147439}, '2': {'precision': 0.3164481000851219, 'recall': 0.759094678537341, 'f1-score': 0.4466843599015747, 'support': 127822}, 'accuracy': 0.32169928377498497, 'macro avg': {'precision': 0.3398047051923639, 'recall': 0.3375734414604919, 'f1-score': 0.25699854989118576, 'support': 406995}, 'weighted avg': {'precision': 0.3411848803688217, 'recall': 0.32169928377498497, 'f1-score': 0.24747834120515683, 'support': 406995}}
[[ 29302   3963  98469]
 [ 31719   4599 111121]
 [ 26917   3876  97029]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034974
{'0': {'precision': 0.33445383975602994, 'recall': 0.21358858028106673, 'f1-score': 0.2606933996029227, 'support': 45185}, '1': {'precision': 0.34549244398124024, 'recall': 0.02914157619445299, 'f1-score': 0.05374949331171463, 'support': 45502}, '2': {'precision': 0.345158371040724, 'recall': 0.7712102507343238, 'f1-score': 0.4768849082306178, 'support': 46982}, 'accuracy': 0.3429239698116497, 'macro avg': {'precision': 0.34170155159266474, 'recall': 0.3379801357366145, 'f1-score': 0.26377593371508506, 'support': 137669}, 'weighted avg': {'precision': 0.341755402622565, 'recall': 0.3429239698116497, 'f1-score': 0.2660740432793046, 'support': 137669}}
[[ 9651  1219 34315]
 [ 9749  1326 34427]
 [ 9456  1293 36233]]
Evaluating performance on  val set...
209/209 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074001
{'0': {'precision': 0.3555767397521449, 'recall': 0.2152901668590618, 'f1-score': 0.26819622838840407, 'support': 19058}, '1': {'precision': 0.3451443569553806, 'recall': 0.030129453545652423, 'f1-score': 0.05542092508692446, 'support': 17458}, '2': {'precision': 0.3211061366840634, 'recall': 0.7647266729500471, 'f1-score': 0.4522950962459716, 'support': 16976}, 'accuracy': 0.32922680026919915, 'macro avg': {'precision': 0.34060907779719624, 'recall': 0.3367154311182538, 'f1-score': 0.2586374165737667, 'support': 53492}, 'weighted avg': {'precision': 0.3412325107730515, 'recall': 0.32922680026919915, 'f1-score': 0.2571783403997859, 'support': 53492}}
[[ 4103   521 14434]
 [ 3919   526 13013]
 [ 3517   477 12982]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
3782/3782 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0879351
{'0': {'precision': 0.36630183197084604, 'recall': 0.5769734226678173, 'f1-score': 0.4481118754730195, 'support': 309399}, '1': {'precision': 0.3446383444865023, 'recall': 0.20104330440889434, 'f1-score': 0.2539474499163858, 'support': 316111}, '2': {'precision': 0.42916753880745157, 'recall': 0.3712219879570847, 'f1-score': 0.39809723039921835, 'support': 342442}, 'accuracy': 0.38141250805825083, 'macro avg': {'precision': 0.3800359050882667, 'recall': 0.38307957167793205, 'f1-score': 0.36671885192954123, 'support': 967952}, 'weighted avg': {'precision': 0.3814676580535211, 'recall': 0.38141250805825083, 'f1-score': 0.36700803373758667, 'support': 967952}}
[[178515  52312  78572]
 [162047  63552  90512]
 [146782  68538 127122]]
Evaluating performance on  train set...
1601/1601 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0908575
{'0': {'precision': 0.37367415508268004, 'recall': 0.53692565353528, 'f1-score': 0.44066611485789925, 'support': 137330}, '1': {'precision': 0.3616917562724014, 'recall': 0.18674819195949396, 'f1-score': 0.24631787581587672, 'support': 135091}, '2': {'precision': 0.39673383564044157, 'recall': 0.41217205146689384, 'f1-score': 0.4043056220223853, 'support': 137331}, 'accuracy': 0.3796637966379664, 'macro avg': {'precision': 0.377366582331841, 'recall': 0.3786152989872226, 'f1-score': 0.36376320423205377, 'support': 409752}, 'weighted avg': {'precision': 0.3774522812492359, 'recall': 0.3796637966379664, 'f1-score': 0.3644050574328719, 'support': 409752}}
[[73736 21692 41902]
 [65694 25228 44169]
 [57897 22830 56604]]
Evaluating performance on  val set...
532/532 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0853969
{'0': {'precision': 0.39028311015388456, 'recall': 0.5416053019145802, 'f1-score': 0.4536581826097999, 'support': 46172}, '1': {'precision': 0.35180814296552304, 'recall': 0.18207399005322397, 'f1-score': 0.23995975276699724, 'support': 45844}, '2': {'precision': 0.3971007899416849, 'recall': 0.43502786461873044, 'f1-score': 0.41519999999999996, 'support': 44142}, 'accuracy': 0.38600008813290443, 'macro avg': {'precision': 0.37973068102036417, 'recall': 0.38623571886217817, 'f1-score': 0.36960597845893234, 'support': 136158}, 'weighted avg': {'precision': 0.37953897191308955, 'recall': 0.38600008813290443, 'f1-score': 0.36923852372471616, 'support': 136158}}
[[25007  7743 13422]
 [21764  8347 15733]
 [17303  7636 19203]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
4457/4457 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0908128
{'0': {'precision': 0.3869859242351434, 'recall': 0.39504901672726156, 'f1-score': 0.39097590362969037, 'support': 391397}, '1': {'precision': 0.38052366423881157, 'recall': 0.3385450989006391, 'f1-score': 0.3583090467768764, 'support': 382404}, '2': {'precision': 0.36789144268661406, 'recall': 0.4019904237412776, 'f1-score': 0.38418579105534345, 'support': 367158}, 'accuracy': 0.37834488355848017, 'macro avg': {'precision': 0.3784670103868563, 'recall': 0.37852817978972614, 'f1-score': 0.3778235804873034, 'support': 1140959}, 'weighted avg': {'precision': 0.3786754716000949, 'recall': 0.37834488355848017, 'f1-score': 0.37784223197232536, 'support': 1140959}}
[[154621 100161 136615]
 [135963 129461 116980]
 [108968 110596 147594]]
Evaluating performance on  train set...
2425/2425 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0901412
{'0': {'precision': 0.36841076881228135, 'recall': 0.4672270540790049, 'f1-score': 0.4119762736626087, 'support': 205810}, '1': {'precision': 0.3582089552238806, 'recall': 0.3054113725088825, 'f1-score': 0.32970987803723073, 'support': 205179}, '2': {'precision': 0.4015217520713037, 'recall': 0.3537387722409749, 'f1-score': 0.37611872203986974, 'support': 209748}, 'accuracy': 0.3753924770071705, 'macro avg': {'precision': 0.37604715870248856, 'recall': 0.3754590662762874, 'f1-score': 0.37260162457990303, 'support': 620737}, 'weighted avg': {'precision': 0.3762269044806223, 'recall': 0.3753924770071705, 'f1-score': 0.372667538198498, 'support': 620737}}
[[96160 50490 59160]
 [91084 62664 51431]
 [73769 61783 74196]]
Evaluating performance on  val set...
787/787 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0855217
{'0': {'precision': 0.3921664563644323, 'recall': 0.4440200594786868, 'f1-score': 0.4164854849516621, 'support': 68596}, '1': {'precision': 0.354592432072012, 'recall': 0.3203855712026508, 'f1-score': 0.33662222573881395, 'support': 66395}, '2': {'precision': 0.3992543183462858, 'recall': 0.3831891410366747, 'f1-score': 0.39105680408638105, 'support': 66231}, 'accuracy': 0.3832036258460805, 'macro avg': {'precision': 0.38200440226091, 'recall': 0.3825315905726708, 'f1-score': 0.3813881715922857, 'support': 201222}, 'weighted avg': {'precision': 0.38210149748332034, 'recall': 0.3832036258460805, 'f1-score': 0.3817641917639118, 'support': 201222}}
[[30458 18501 19637]
 [26573 21272 18550]
 [20635 20217 25379]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
4676/4676 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0927134
{'0': {'precision': 0.37631266374796857, 'recall': 0.4322212536260792, 'f1-score': 0.40233397210786426, 'support': 406086}, '1': {'precision': 0.3538070834410499, 'recall': 0.29736175477432664, 'f1-score': 0.3231379912833575, 'support': 391207}, '2': {'precision': 0.37313328820039027, 'recall': 0.3750750570433529, 'f1-score': 0.37410165295855624, 'support': 399696}, 'accuracy': 0.36906354193731106, 'macro avg': {'precision': 0.3677510117964696, 'recall': 0.3682193551479196, 'f1-score': 0.36652453878325936, 'support': 1196989}, 'weighted avg': {'precision': 0.36789560707995106, 'recall': 0.36906354193731106, 'f1-score': 0.36702339940827, 'support': 1196989}}
[[175519 100646 129921]
 [152938 116330 121939]
 [137961 111819 149916]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0909798
{'0': {'precision': 0.38735676002960107, 'recall': 0.4659872020373148, 'f1-score': 0.4230493231808419, 'support': 185342}, '1': {'precision': 0.3482141126139808, 'recall': 0.3123851376029776, 'f1-score': 0.32932799559942544, 'support': 172489}, '2': {'precision': 0.3829551708997359, 'recall': 0.34103801121281213, 'f1-score': 0.36078314849933435, 'support': 181578}, 'accuracy': 0.374808355070086, 'macro avg': {'precision': 0.37284201451443927, 'recall': 0.37313678361770153, 'f1-score': 0.37105348909320063, 'support': 539409}, 'weighted avg': {'precision': 0.37335827676162525, 'recall': 0.374808355070086, 'f1-score': 0.3721193877524199, 'support': 539409}}
[[86367 47086 51889]
 [70717 53883 47889]
 [65881 53772 61925]]
Evaluating performance on  val set...
798/798 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0920297
{'0': {'precision': 0.38461631346978203, 'recall': 0.4464753788144265, 'f1-score': 0.413243727133553, 'support': 71341}, '1': {'precision': 0.34168225084574816, 'recall': 0.2603009444533376, 'f1-score': 0.29549068243973803, 'support': 62470}, '2': {'precision': 0.38964858308374106, 'recall': 0.4084993322156233, 'f1-score': 0.3988513480706671, 'support': 70382}, 'accuracy': 0.3764281831404602, 'macro avg': {'precision': 0.37198238246642373, 'recall': 0.3717585518277959, 'f1-score': 0.369195252547986, 'support': 204193}, 'weighted avg': {'precision': 0.37321577725084343, 'recall': 0.3764281831404602, 'f1-score': 0.3722580071273498, 'support': 204193}}
[[31852 15027 24462]
 [25635 16261 20574]
 [25328 16303 28751]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
4274/4274 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029776
{'0': {'precision': 0.2766709772538436, 'recall': 0.4432911265702417, 'f1-score': 0.340700680062775, 'support': 299715}, '1': {'precision': 0.4969754450949934, 'recall': 0.1341562491810153, 'f1-score': 0.21127876243164087, 'support': 496041}, '2': {'precision': 0.3027452974072191, 'recall': 0.4870855388204848, 'f1-score': 0.3734036442974493, 'support': 298309}, 'accuracy': 0.315072687637389, 'macro avg': {'precision': 0.3587972399186854, 'recall': 0.3548443048572472, 'f1-score': 0.3084610289306217, 'support': 1094065}, 'weighted avg': {'precision': 0.3836648513865734, 'recall': 0.315072687637389, 'f1-score': 0.29093856457074857, 'support': 1094065}}
[[132861  33103 133751]
 [228599  66547 200895]
 [118753  34254 145302]]
Evaluating performance on  train set...
1972/1972 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971951
{'0': {'precision': 0.35136683842155286, 'recall': 0.4670624293460848, 'f1-score': 0.40103709778721325, 'support': 165419}, '1': {'precision': 0.35314329695703567, 'recall': 0.15437209358214873, 'f1-score': 0.21483277591973243, 'support': 166442}, '2': {'precision': 0.37449689763370847, 'recall': 0.45952674575466507, 'f1-score': 0.4126773671923339, 'support': 172719}, 'accuracy': 0.3613381426136589, 'macro avg': {'precision': 0.359669011004099, 'recall': 0.36032042289429955, 'f1-score': 0.34284908029975986, 'support': 504580}, 'weighted avg': {'precision': 0.35987030270596193, 'recall': 0.3613381426136589, 'f1-score': 0.3435997755610366, 'support': 504580}}
[[77261 22053 66105]
 [74287 25694 66461]
 [68339 25011 79369]]
Evaluating performance on  val set...
707/707 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031599
{'0': {'precision': 0.3393549873890944, 'recall': 0.45593876322353144, 'f1-score': 0.38910174542358444, 'support': 58135}, '1': {'precision': 0.3541861695632708, 'recall': 0.13205857804082252, 'f1-score': 0.19238592147152458, 'support': 65895}, '2': {'precision': 0.3283767514536745, 'recall': 0.4519956279528947, 'f1-score': 0.38039494962982745, 'support': 56724}, 'accuracy': 0.33662878829790766, 'macro avg': {'precision': 0.3406393028020133, 'recall': 0.34666432307241624, 'f1-score': 0.32062753884164547, 'support': 180754}, 'weighted avg': {'precision': 0.3413166108893577, 'recall': 0.33662878829790766, 'f1-score': 0.3146554067316271, 'support': 180754}}
[[26506  7846 23783]
 [28537  8702 28656]
 [23064  8021 25639]]
testing model on single stock: results/universal/W4/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
12724/12724 - 184s - 184s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1125208
{'0': {'precision': 0.28846202847273034, 'recall': 0.260523088825598, 'f1-score': 0.2737816246693438, 'support': 912541}, '1': {'precision': 0.44766146993318484, 'recall': 0.05702585820720412, 'f1-score': 0.10116473343327996, 'support': 1406362}, '2': {'precision': 0.29727633606482096, 'recall': 0.7141138126116447, 'f1-score': 0.4197967283432166, 'support': 938244}, 'accuracy': 0.30331759665744285, 'macro avg': {'precision': 0.34446661149024543, 'recall': 0.34388758654814894, 'f1-score': 0.26491436214861347, 'support': 3257147}, 'weighted avg': {'precision': 0.35973974977411505, 'recall': 0.30331759665744285, 'f1-score': 0.24131024973258344, 'support': 3257147}}
[[237738  50982 623821]
 [366158  80199 960005]
 [220261  47970 670013]]
Evaluating performance on  train set...
5165/5165 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011422
{'0': {'precision': 0.33772476943464746, 'recall': 0.2551517617013583, 'f1-score': 0.29068807876852093, 'support': 442470}, '1': {'precision': 0.36254914208031747, 'recall': 0.04558399951956058, 'f1-score': 0.08098553258195501, 'support': 432937}, '2': {'precision': 0.34542271591129453, 'recall': 0.7217698877310021, 'f1-score': 0.4672365869705726, 'support': 446695}, 'accuracy': 0.34418146254978815, 'macro avg': {'precision': 0.3485655424754199, 'recall': 0.340835216317307, 'f1-score': 0.27963673277368284, 'support': 1322102}, 'weighted avg': {'precision': 0.34845467047215006, 'recall': 0.34418146254978815, 'f1-score': 0.28166861176290575, 'support': 1322102}}
[[112897  17717 311856]
 [114088  19735 299114]
 [107302  16982 322411]]
Evaluating performance on  val set...
1903/1903 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1018641
{'0': {'precision': 0.3376611309151729, 'recall': 0.2474434209874709, 'f1-score': 0.2855969077541921, 'support': 161544}, '1': {'precision': 0.384922711058264, 'recall': 0.04914767379013403, 'f1-score': 0.08716584451672663, 'support': 164667}, '2': {'precision': 0.3381282131688498, 'recall': 0.7309641828732065, 'f1-score': 0.46237278267129833, 'support': 160789}, 'accuracy': 0.3400349075975359, 'macro avg': {'precision': 0.35357068504742895, 'recall': 0.3425184258836038, 'f1-score': 0.2783785116474057, 'support': 487000}, 'weighted avg': {'precision': 0.35379567774455445, 'recall': 0.3400349075975359, 'f1-score': 0.2768670684562925, 'support': 487000}}
[[ 39973   6590 114981]
 [ 41493   8093 115081]
 [ 36916   6342 117531]]
training model: results/universal/W4/deepVOL_L3/h500
Epoch 1/50
9854/9854 - 533s - loss: 3.2690 - accuracy500: 0.3776 - val_loss: 3.4067 - val_accuracy500: 0.3341 - 533s/epoch - 54ms/step
Epoch 2/50
9854/9854 - 534s - loss: 3.2624 - accuracy500: 0.3841 - val_loss: 3.4028 - val_accuracy500: 0.3341 - 534s/epoch - 54ms/step
Epoch 3/50
9854/9854 - 533s - loss: 3.2525 - accuracy500: 0.3917 - val_loss: 3.5208 - val_accuracy500: 0.3341 - 533s/epoch - 54ms/step
Epoch 4/50
9854/9854 - 537s - loss: 3.2476 - accuracy500: 0.3957 - val_loss: 3.5036 - val_accuracy500: 0.3342 - 537s/epoch - 54ms/step
Epoch 5/50
9854/9854 - 559s - loss: 3.2413 - accuracy500: 0.4002 - val_loss: 3.6172 - val_accuracy500: 0.3343 - 559s/epoch - 57ms/step
Epoch 6/50
9854/9854 - 555s - loss: 3.2338 - accuracy500: 0.4054 - val_loss: 3.6978 - val_accuracy500: 0.3348 - 555s/epoch - 56ms/step
Epoch 7/50
9854/9854 - 552s - loss: 3.2266 - accuracy500: 0.4078 - val_loss: 3.6799 - val_accuracy500: 0.3351 - 552s/epoch - 56ms/step
Epoch 8/50
9854/9854 - 551s - loss: 3.2182 - accuracy500: 0.4114 - val_loss: 3.7110 - val_accuracy500: 0.3336 - 551s/epoch - 56ms/step
Epoch 9/50
9854/9854 - 549s - loss: 3.2145 - accuracy500: 0.4137 - val_loss: 3.6956 - val_accuracy500: 0.3311 - 549s/epoch - 56ms/step
Epoch 10/50
9854/9854 - 548s - loss: 3.2094 - accuracy500: 0.4164 - val_loss: 3.6678 - val_accuracy500: 0.3329 - 548s/epoch - 56ms/step
Epoch 11/50
9854/9854 - 547s - loss: 3.2053 - accuracy500: 0.4183 - val_loss: 3.6939 - val_accuracy500: 0.3330 - 547s/epoch - 56ms/step
Epoch 12/50
9854/9854 - 549s - loss: 3.2016 - accuracy500: 0.4200 - val_loss: 3.6127 - val_accuracy500: 0.3347 - 549s/epoch - 56ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 689s - 689s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101747
{'0': {'precision': 0.32608695652173914, 'recall': 8.331787323907675e-05, 'f1-score': 0.0001665931805636847, 'support': 1800334}, '1': {'precision': 0.3952876291205203, 'recall': 0.9999287508609271, 'f1-score': 0.5665923521088753, 'support': 2400029}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1871268}, 'accuracy': 0.3952822561186607, 'macro avg': {'precision': 0.24045819521408648, 'recall': 0.3333373562447221, 'f1-score': 0.188919648429813, 'support': 6071631}, 'weighted avg': {'precision': 0.2529414597186657, 'recall': 0.3952822561186607, 'f1-score': 0.22401526041464784, 'support': 6071631}}
[[    150 1800184       0]
 [    169 2399858       2]
 [    141 1871127       0]]
Evaluating performance on  train set...
9854/9854 - 295s - 295s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.139438
{'0': {'precision': 0.4036697247706422, 'recall': 5.213196020909655e-05, 'f1-score': 0.00010425045698424752, 'support': 844012}, '1': {'precision': 0.3298162900341408, 'recall': 0.9999615291675032, 'f1-score': 0.49602812885673747, 'support': 831799}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 846208}, 'accuracy': 0.329819481930945, 'macro avg': {'precision': 0.244495338268261, 'recall': 0.3333378870425708, 'f1-score': 0.16537745977124058, 'support': 2522019}, 'weighted avg': {'precision': 0.24386927774026587, 'recall': 0.329819481930945, 'f1-score': 0.16363226850852655, 'support': 2522019}}
[[    44 843968      0]
 [    32 831767      0]
 [    33 846175      0]]
Evaluating performance on  val set...
3566/3566 - 106s - 106s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1359961
{'0': {'precision': 0.4146341463414634, 'recall': 5.564593473713843e-05, 'f1-score': 0.00011127693556410862, 'support': 305503}, '1': {'precision': 0.3341250954992322, 'recall': 0.999973756208297, 'f1-score': 0.500886911584076, 'support': 304834}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 302015}, 'accuracy': 0.3341287134790081, 'macro avg': {'precision': 0.24958641394689854, 'recall': 0.333343134047678, 'f1-score': 0.16699939617321335, 'support': 912352}, 'weighted avg': {'precision': 0.25047861458205717, 'recall': 0.3341287134790081, 'f1-score': 0.1673930196278036, 'support': 912352}}
[[    17 305486      0]
 [     8 304826      0]
 [    16 301999      0]]
testing model out of sample: results/universal/W4/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 381s - 381s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1352504
{'0': {'precision': 0.284789644012945, 'recall': 8.5751426104683e-05, 'f1-score': 0.00017145122748363177, 'support': 1026222}, '1': {'precision': 0.3396327622204489, 'recall': 0.9998708327789502, 'f1-score': 0.507036926318257, 'support': 1029673}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 975747}, 'accuracy': 0.3396271723376309, 'macro avg': {'precision': 0.20814080207779795, 'recall': 0.33331886140168493, 'f1-score': 0.16906945918191355, 'support': 3031642}, 'weighted avg': {'precision': 0.21175590100416497, 'recall': 0.3396271723376309, 'f1-score': 0.1722690806020201, 'support': 3031642}}
[[     88 1026134       0]
 [    133 1029540       0]
 [     88  975659       0]]
Evaluating performance on  train set...
5528/5528 - 177s - 177s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1378918
{'0': {'precision': 0.33121019108280253, 'recall': 0.00011152575816068288, 'f1-score': 0.00022297643525000157, 'support': 466260}, '1': {'precision': 0.33081714224705105, 'recall': 0.9999016932273045, 'f1-score': 0.4971517827258093, 'support': 467923}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 480281}, 'accuracy': 0.3308171858739424, 'macro avg': {'precision': 0.22067577777661787, 'recall': 0.33333773966182173, 'f1-score': 0.16579158638701977, 'support': 1414464}, 'weighted avg': {'precision': 0.21861780387902013, 'recall': 0.3308171858739424, 'f1-score': 0.16453774618591108, 'support': 1414464}}
[[    52 466208      0]
 [    46 467877      0]
 [    59 480222      0]]
Evaluating performance on  val set...
1908/1908 - 59s - 59s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1443428
{'0': {'precision': 0.3103448275862069, 'recall': 0.00010661864878632438, 'f1-score': 0.00021316406527557375, 'support': 168826}, '1': {'precision': 0.32467250117421687, 'recall': 0.9998799868617196, 'f1-score': 0.49017844010063866, 'support': 158316}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160475}, 'accuracy': 0.32467079695744816, 'macro avg': {'precision': 0.21167244292014123, 'recall': 0.333328868503502, 'f1-score': 0.16346386805530475, 'support': 487617}, 'weighted avg': {'precision': 0.21286199529131733, 'recall': 0.32467079695744816, 'f1-score': 0.15922143313185744, 'support': 487617}}
[[    18 168808      0]
 [    19 158297      0]
 [    21 160454      0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
534/534 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1714771
{'0': {'precision': 0.43902439024390244, 'recall': 0.00035433070866141734, 'f1-score': 0.0007080899274207825, 'support': 50800}, '1': {'precision': 0.30527841420655427, 'recall': 0.9998082132668472, 'f1-score': 0.46773886028958195, 'support': 41713}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 44141}, 'accuracy': 0.30531854171850076, 'macro avg': {'precision': 0.2481009348168189, 'recall': 0.33338751465850286, 'f1-score': 0.15614898340566757, 'support': 136654}, 'weighted avg': {'precision': 0.2563885251524891, 'recall': 0.30531854171850076, 'f1-score': 0.1430383453654654, 'support': 136654}}
[[   18 50782     0]
 [    8 41705     0]
 [   15 44126     0]]
Evaluating performance on  train set...
254/254 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1414138
{'0': {'precision': 0.30357142857142855, 'recall': 0.0007915813000558763, 'f1-score': 0.0015790451421140628, 'support': 21476}, '1': {'precision': 0.3341091245376079, 'recall': 0.9991242625368731, 'f1-score': 0.5007623359822584, 'support': 21696}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21764}, 'accuracy': 0.3340827892078354, 'macro avg': {'precision': 0.2125601843696788, 'recall': 0.33330528127897635, 'f1-score': 0.16744712704145748, 'support': 64936}, 'weighted avg': {'precision': 0.2120292528946646, 'recall': 0.3340827892078354, 'f1-score': 0.1678337319043846, 'support': 64936}}
[[   17 21459     0]
 [   19 21677     0]
 [   20 21744     0]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1818339
{'0': {'precision': 0.2857142857142857, 'recall': 0.0007934408886537953, 'f1-score': 0.0015824871422919688, 'support': 7562}, '1': {'precision': 0.2747135366090503, 'recall': 0.9989406779661016, 'f1-score': 0.4309215536938309, 'support': 5664}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7391}, 'accuracy': 0.2747247417179997, 'macro avg': {'precision': 0.18680927410777867, 'recall': 0.3332447062849185, 'f1-score': 0.14416801361204096, 'support': 20617}, 'weighted avg': {'precision': 0.1802662317468637, 'recall': 0.2747247417179997, 'f1-score': 0.1189652445987229, 'support': 20617}}
[[   6 7556    0]
 [   6 5658    0]
 [   9 7382    0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
1613/1613 - 29s - 29s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1398093
{'0': {'precision': 0.32727272727272727, 'recall': 0.0005090317791367669, 'f1-score': 0.0010164825468534924, 'support': 141445}, '1': {'precision': 0.3088827978644254, 'recall': 0.999505948226511, 'f1-score': 0.47192425751556055, 'support': 127517}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 143887}, 'accuracy': 0.30889259753566073, 'macro avg': {'precision': 0.21205184171238423, 'recall': 0.33333832666854923, 'f1-score': 0.15764691335413802, 'support': 412849}, 'weighted avg': {'precision': 0.2075308372900718, 'recall': 0.30889259753566073, 'f1-score': 0.1461118760598946, 'support': 412849}}
[[    72 141373      0]
 [    63 127454      0]
 [    85 143802      0]]
Evaluating performance on  train set...
634/634 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1293036
{'0': {'precision': 0.39285714285714285, 'recall': 0.00020326329988728126, 'f1-score': 0.0004063163727029273, 'support': 54117}, '1': {'precision': 0.3329530457948421, 'recall': 0.9998703655690951, 'f1-score': 0.49955587631155274, 'support': 53998}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54071}, 'accuracy': 0.3329633877153392, 'macro avg': {'precision': 0.24193672955066167, 'recall': 0.3333578762896608, 'f1-score': 0.16665406422808524, 'support': 162186}, 'weighted avg': {'precision': 0.24193856785930892, 'recall': 0.3329633877153392, 'f1-score': 0.16645707294225637, 'support': 162186}}
[[   11 54106     0]
 [    7 53991     0]
 [   10 54061     0]]
Evaluating performance on  val set...
206/206 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1348002
{'0': {'precision': 0.7, 'recall': 0.0003999771441631907, 'f1-score': 0.0007994974587402205, 'support': 17501}, '1': {'precision': 0.3278831562974203, 'recall': 0.9999421530629953, 'f1-score': 0.49383633065264904, 'support': 17287}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 17942}, 'accuracy': 0.3279537265313863, 'macro avg': {'precision': 0.3426277187658067, 'recall': 0.3334473767357195, 'f1-score': 0.1648786093704631, 'support': 52730}, 'weighted avg': {'precision': 0.33982203912219805, 'recall': 0.3279537265313863, 'f1-score': 0.16216462455941127, 'support': 52730}}
[[    7 17494     0]
 [    1 17286     0]
 [    2 17940     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
989/989 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1167446
{'0': {'precision': 0.5294117647058824, 'recall': 0.00010308569857741736, 'f1-score': 0.0002061312598055495, 'support': 87306}, '1': {'precision': 0.36029760586988835, 'recall': 0.9999561124399289, 'f1-score': 0.5297273419472587, 'support': 91142}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 74521}, 'accuracy': 0.3603089706643897, 'macro avg': {'precision': 0.2965697901919236, 'recall': 0.33335306604616877, 'f1-score': 0.1766444910690214, 'support': 252969}, 'weighted avg': {'precision': 0.3125247280244027, 'recall': 0.3603089706643897, 'f1-score': 0.1909261842183257, 'support': 252969}}
[[    9 87297     0]
 [    4 91138     0]
 [    4 74517     0]]
Evaluating performance on  train set...
339/339 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1287476
{'0': {'precision': 0.5, 'recall': 0.00010820949357957004, 'f1-score': 0.00021637216011539847, 'support': 27724}, '1': {'precision': 0.33772071738929466, 'recall': 0.999931570123516, 'f1-score': 0.5049108955365704, 'support': 29227}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29591}, 'accuracy': 0.337731968292852, 'macro avg': {'precision': 0.27924023912976487, 'recall': 0.3333465932056985, 'f1-score': 0.16837575589889528, 'support': 86542}, 'weighted avg': {'precision': 0.27423174189569127, 'recall': 0.337731968292852, 'f1-score': 0.17058803177202264, 'support': 86542}}
[[    3 27721     0]
 [    2 29225     0]
 [    1 29590     0]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145025
{'0': {'precision': 0.5, 'recall': 9.46431951542684e-05, 'f1-score': 0.00018925056775170325, 'support': 10566}, '1': {'precision': 0.3097367586425626, 'recall': 1.0, 'f1-score': 0.47297559085625723, 'support': 9766}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11200}, 'accuracy': 0.3097488265888621, 'macro avg': {'precision': 0.2699122528808542, 'recall': 0.3333648810650514, 'f1-score': 0.15772161380800298, 'support': 31532}, 'weighted avg': {'precision': 0.2634748568090596, 'recall': 0.3097488265888621, 'f1-score': 0.14655205003809058, 'support': 31532}}
[[    1 10565     0]
 [    0  9766     0]
 [    1 11199     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1242826
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71292}, '1': {'precision': 0.3722363756965833, 'recall': 0.9999659508784673, 'f1-score': 0.5425201432270419, 'support': 88108}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 77294}, 'accuracy': 0.3722316577522033, 'macro avg': {'precision': 0.1240787918988611, 'recall': 0.3333219836261558, 'f1-score': 0.1808400477423473, 'support': 236694}, 'weighted avg': {'precision': 0.13856288114559118, 'recall': 0.3722316577522033, 'f1-score': 0.20195004849910944, 'support': 236694}}
[[    0 71292     0]
 [    3 88105     0]
 [    0 77294     0]]
Evaluating performance on  train set...
346/346 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1527524
{'0': {'precision': 0.3333333333333333, 'recall': 3.35536690937154e-05, 'f1-score': 6.710058377507885e-05, 'support': 29803}, '1': {'precision': 0.3301455395350413, 'recall': 0.9999658014431791, 'f1-score': 0.4964009235366019, 'support': 29241}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29526}, 'accuracy': 0.33014564751044373, 'macro avg': {'precision': 0.2211596242894582, 'recall': 0.33333311837075763, 'f1-score': 0.165489341373459, 'support': 88570}, 'weighted avg': {'precision': 0.22115974997039037, 'recall': 0.33014564751044373, 'f1-score': 0.16390718306234645, 'support': 88570}}
[[    1 29802     0]
 [    1 29240     0]
 [    1 29525     0]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1625566
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10784}, '1': {'precision': 0.30479377769514426, 'recall': 1.0, 'f1-score': 0.4671907283824542, 'support': 9836}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11651}, 'accuracy': 0.30479377769514426, 'macro avg': {'precision': 0.10159792589838142, 'recall': 0.3333333333333333, 'f1-score': 0.1557302427941514, 'support': 32271}, 'weighted avg': {'precision': 0.09289924692167702, 'recall': 0.30479377769514426, 'f1-score': 0.14239682700783426, 'support': 32271}}
[[    0 10784     0]
 [    0  9836     0]
 [    0 11651     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.125667
{'0': {'precision': 0.4, 'recall': 5.999520038396928e-05, 'f1-score': 0.0001199724063465403, 'support': 133344}, '1': {'precision': 0.35846673628601267, 'recall': 0.999965728072821, 'f1-score': 0.5277471797014471, 'support': 145892}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 127759}, 'accuracy': 0.3584687772577059, 'macro avg': {'precision': 0.2528222454286709, 'recall': 0.33334190775773503, 'f1-score': 0.17595571736926455, 'support': 406995}, 'weighted avg': {'precision': 0.2595487145793903, 'recall': 0.3584687772577059, 'f1-score': 0.18921630275938375, 'support': 406995}}
[[     8 133336      0]
 [     5 145887      0]
 [     7 127752      0]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1368282
{'0': {'precision': 0.16666666666666666, 'recall': 2.226229435205592e-05, 'f1-score': 4.4518642181413464e-05, 'support': 44919}, '1': {'precision': 0.330727937063699, 'recall': 0.999912151626293, 'f1-score': 0.49705233738727916, 'support': 45533}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 47217}, 'accuracy': 0.3307207868147513, 'macro avg': {'precision': 0.16579820124345523, 'recall': 0.3333114713068817, 'f1-score': 0.16569895200982018, 'support': 137669}, 'weighted avg': {'precision': 0.1637662448214297, 'recall': 0.3307207868147513, 'f1-score': 0.16441089723280572, 'support': 137669}}
[[    1 44918     0]
 [    4 45529     0]
 [    1 47216     0]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1385812
{'0': {'precision': 0.3333333333333333, 'recall': 5.2742616033755275e-05, 'f1-score': 0.00010546854400675, 'support': 18960}, '1': {'precision': 0.33132045841200997, 'recall': 0.9999435761439937, 'f1-score': 0.49772510251081276, 'support': 17723}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 16809}, 'accuracy': 0.33132057130038134, 'macro avg': {'precision': 0.2215512639151144, 'recall': 0.3333321062533425, 'f1-score': 0.16594352368493984, 'support': 53492}, 'weighted avg': {'precision': 0.22792179175271168, 'recall': 0.33132057130038134, 'f1-score': 0.16494394816782887, 'support': 53492}}
[[    1 18959     0]
 [    1 17722     0]
 [    1 16808     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
3782/3782 - 68s - 68s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1525514
{'0': {'precision': 0.4069767441860465, 'recall': 0.00010794273483712983, 'f1-score': 0.00021582822539866557, 'support': 324246}, '1': {'precision': 0.2883501314749474, 'recall': 0.9999283421233662, 'f1-score': 0.44761978846306516, 'support': 279104}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 364602}, 'accuracy': 0.28836037324164837, 'macro avg': {'precision': 0.23177562522033132, 'recall': 0.3333454282860678, 'f1-score': 0.1492785388961546, 'support': 967952}, 'weighted avg': {'precision': 0.2194739578930903, 'recall': 0.28836037324164837, 'f1-score': 0.12914117113035353, 'support': 967952}}
[[    35 324210      1]
 [    20 279084      0]
 [    31 364571      0]]
Evaluating performance on  train set...
1601/1601 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1378366
{'0': {'precision': 0.47368421052631576, 'recall': 6.504911207962011e-05, 'f1-score': 0.0001300803607562005, 'support': 138357}, '1': {'precision': 0.3260757615325102, 'recall': 0.9999550931816481, 'f1-score': 0.49178511547954057, 'support': 133610}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 137785}, 'accuracy': 0.3260826060641559, 'macro avg': {'precision': 0.266586657352942, 'recall': 0.3333400474312426, 'f1-score': 0.1639717319467656, 'support': 409752}, 'weighted avg': {'precision': 0.26626961873071553, 'recall': 0.3260826060641559, 'f1-score': 0.16040289445248485, 'support': 409752}}
[[     9 138348      0]
 [     6 133604      0]
 [     4 137781      0]]
Evaluating performance on  val set...
532/532 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1398021
{'0': {'precision': 0.4, 'recall': 4.172926055750292e-05, 'f1-score': 8.344981536728349e-05, 'support': 47928}, '1': {'precision': 0.3153290783163059, 'recall': 0.9999301285634432, 'f1-score': 0.47945993332923853, 'support': 42936}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45294}, 'accuracy': 0.31533218760557585, 'macro avg': {'precision': 0.23844302610543533, 'recall': 0.33332395260800024, 'f1-score': 0.15984779438153526, 'support': 136158}, 'weighted avg': {'precision': 0.24023685208793397, 'recall': 0.31533218760557585, 'f1-score': 0.15122204556599764, 'support': 136158}}
[[    2 47926     0]
 [    3 42933     0]
 [    0 45294     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
4457/4457 - 74s - 74s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1531287
{'0': {'precision': 0.3018867924528302, 'recall': 3.917516686172635e-05, 'f1-score': 7.834016769692147e-05, 'support': 408422}, '1': {'precision': 0.3096039463373845, 'recall': 0.9999292293930147, 'f1-score': 0.47281281790437435, 'support': 353254}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 379283}, 'accuracy': 0.3096035878589853, 'macro avg': {'precision': 0.20383024626340487, 'recall': 0.3333228015199588, 'f1-score': 0.15763038602402377, 'support': 1140959}, 'weighted avg': {'precision': 0.20392147308241246, 'recall': 0.3096035878589853, 'f1-score': 0.14641631734704136, 'support': 1140959}}
[[    16 408406      0]
 [    25 353229      0]
 [    12 379271      0]]
Evaluating performance on  train set...
2425/2425 - 39s - 39s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.138648
{'0': {'precision': 0.3, 'recall': 4.357931435212086e-05, 'f1-score': 8.714596949891068e-05, 'support': 206520}, '1': {'precision': 0.3294130725124737, 'recall': 0.9999462050078247, 'f1-score': 0.49557009502088617, 'support': 204480}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 209737}, 'accuracy': 0.3294116509890662, 'macro avg': {'precision': 0.2098043575041579, 'recall': 0.3333299281073923, 'f1-score': 0.16521908033012836, 'support': 620737}, 'weighted avg': {'precision': 0.2083239521203837, 'recall': 0.3294116509890662, 'f1-score': 0.1632771534731967, 'support': 620737}}
[[     9 206511      0]
 [    11 204469      0]
 [    10 209727      0]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1493117
{'0': {'precision': 0.4166666666666667, 'recall': 6.994572211963516e-05, 'f1-score': 0.00013986796464137853, 'support': 71484}, '1': {'precision': 0.3106008647681527, 'recall': 0.9999679989759672, 'f1-score': 0.47397879472750165, 'support': 62498}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 67240}, 'accuracy': 0.31060719006868037, 'macro avg': {'precision': 0.24242251047827312, 'recall': 0.33334598156602896, 'f1-score': 0.15803955423071434, 'support': 201222}, 'weighted avg': {'precision': 0.24449082528888494, 'recall': 0.31060719006868037, 'f1-score': 0.1472638430910329, 'support': 201222}}
[[    5 71479     0]
 [    2 62496     0]
 [    5 67235     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
4676/4676 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0661795
{'0': {'precision': 0.3389830508474576, 'recall': 6.071129351481963e-05, 'f1-score': 0.00012140084434287242, 'support': 329428}, '1': {'precision': 0.4594767108157627, 'recall': 0.9999472717685776, 'f1-score': 0.629635375194843, 'support': 549990}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 317571}, 'accuracy': 0.45947038778134136, 'macro avg': {'precision': 0.2661532538877401, 'recall': 0.33333599435403083, 'f1-score': 0.2099189253463953, 'support': 1196989}, 'weighted avg': {'precision': 0.3044122415963201, 'recall': 0.45947038778134136, 'f1-score': 0.28933695534441994, 'support': 1196989}}
[[    20 329408      0]
 [    28 549961      1]
 [    11 317560      0]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1330998
{'0': {'precision': 0.36363636363636365, 'recall': 2.2074689712642727e-05, 'f1-score': 4.414669948237995e-05, 'support': 181203}, '1': {'precision': 0.33285440435448405, 'recall': 0.9999832910038765, 'f1-score': 0.49945892714572243, 'support': 179544}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 178662}, 'accuracy': 0.3328550320814076, 'macro avg': {'precision': 0.23216358933028255, 'recall': 0.3333351218978631, 'f1-score': 0.16650102461506827, 'support': 539409}, 'weighted avg': {'precision': 0.2329475614522959, 'recall': 0.3328550320814076, 'f1-score': 0.16626132142741018, 'support': 539409}}
[[     4 181199      0]
 [     3 179541      0]
 [     4 178658      0]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1284621
{'0': {'precision': 0.3333333333333333, 'recall': 4.474606607502424e-05, 'f1-score': 8.94801204998956e-05, 'support': 67045}, '1': {'precision': 0.3450466246130941, 'recall': 0.9999432277843223, 'f1-score': 0.513055224820766, 'support': 70457}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 66691}, 'accuracy': 0.3450461083386796, 'macro avg': {'precision': 0.22612665264880913, 'recall': 0.33332932461679915, 'f1-score': 0.171048234980422, 'support': 204193}, 'weighted avg': {'precision': 0.22850579287095102, 'recall': 0.3450461083386796, 'f1-score': 0.17705960130795684, 'support': 204193}}
[[    3 67042     0]
 [    4 70453     0]
 [    2 66689     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
4274/4274 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198921
{'0': {'precision': 0.2484076433121019, 'recall': 0.00011260285838025119, 'f1-score': 0.00022510367755918353, 'support': 346350}, '1': {'precision': 0.3634674945242196, 'recall': 0.9998189462672755, 'f1-score': 0.5331259469823946, 'support': 397672}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 350043}, 'accuracy': 0.36345098325967834, 'macro avg': {'precision': 0.20395837927877383, 'recall': 0.3333105163752186, 'f1-score': 0.17778368355331794, 'support': 1094065}, 'weighted avg': {'precision': 0.21075240752933505, 'recall': 0.36345098325967834, 'f1-score': 0.19385249162262339, 'support': 1094065}}
[[    39 346311      0]
 [    72 397600      0]
 [    46 349997      0]]
Evaluating performance on  train set...
1972/1972 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1383443
{'0': {'precision': 0.27450980392156865, 'recall': 8.453034337433055e-05, 'f1-score': 0.00016900864358491475, 'support': 165621}, '1': {'precision': 0.33092845009900324, 'recall': 0.9998562762370723, 'f1-score': 0.49727184460236246, 'support': 166987}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 171972}, 'accuracy': 0.33092274763169366, 'macro avg': {'precision': 0.2018127513401906, 'recall': 0.3333136021934822, 'f1-score': 0.16581361774864914, 'support': 504580}, 'weighted avg': {'precision': 0.19962213589911681, 'recall': 0.33092274763169366, 'f1-score': 0.16462389491294518, 'support': 504580}}
[[    14 165607      0]
 [    24 166963      0]
 [    13 171959      0]]
Evaluating performance on  val set...
707/707 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.136108
{'0': {'precision': 0.4, 'recall': 0.0001991569024463106, 'f1-score': 0.0003981155862252007, 'support': 60254}, '1': {'precision': 0.34669440694097076, 'recall': 0.9998563791590201, 'f1-score': 0.5148630381816762, 'support': 62665}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 57835}, 'accuracy': 0.3467032541465196, 'macro avg': {'precision': 0.24889813564699026, 'recall': 0.3333518453538222, 'f1-score': 0.1717537179226338, 'support': 180754}, 'weighted avg': {'precision': 0.253533559483917, 'recall': 0.3467032541465196, 'f1-score': 0.17862885659065444, 'support': 180754}}
[[   12 60242     0]
 [    9 62656     0]
 [    9 57826     0]]
testing model on single stock: results/universal/W4/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
12724/12724 - 194s - 194s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932134
{'0': {'precision': 0.23529411764705882, 'recall': 3.426406673783599e-05, 'f1-score': 6.851815570536765e-05, 'support': 933923}, '1': {'precision': 0.4161028059477865, 'recall': 0.9999564675240351, 'f1-score': 0.5876656433204981, 'support': 1355310}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 967914}, 'accuracy': 0.41609512865093284, 'macro avg': {'precision': 0.21713230786494844, 'recall': 0.33333024386359095, 'f1-score': 0.1959113871587345, 'support': 3257147}, 'weighted avg': {'precision': 0.2406077718212867, 'recall': 0.41609512865093284, 'f1-score': 0.24454932913075, 'support': 3257147}}
[[     32  933891       0]
 [     58 1355251       1]
 [     46  967868       0]]
Evaluating performance on  train set...
5165/5165 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1427866
{'0': {'precision': 0.3076923076923077, 'recall': 2.7239791887989977e-05, 'f1-score': 5.447476116221902e-05, 'support': 440532}, '1': {'precision': 0.3293284813204817, 'recall': 0.9999701428092401, 'f1-score': 0.49547730287134517, 'support': 435406}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 446164}, 'accuracy': 0.3293278430862369, 'macro avg': {'precision': 0.21234026300426315, 'recall': 0.3333324608670427, 'f1-score': 0.1651772592108358, 'support': 1322102}, 'weighted avg': {'precision': 0.21098213634812849, 'recall': 0.3293278430862369, 'f1-score': 0.16319299752173827, 'support': 1322102}}
[[    12 440520      0]
 [    13 435393      0]
 [    14 446150      0]]
Evaluating performance on  val set...
1903/1903 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1362773
{'0': {'precision': 0.6, 'recall': 3.698110881691269e-05, 'f1-score': 7.395765924008504e-05, 'support': 162245}, '1': {'precision': 0.33741349925049796, 'recall': 0.9999939142394625, 'f1-score': 0.5045754082553876, 'support': 164318}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 160437}, 'accuracy': 0.3374188911704312, 'macro avg': {'precision': 0.31247116641683265, 'recall': 0.33334363178275983, 'f1-score': 0.16821645530487592, 'support': 487000}, 'weighted avg': {'precision': 0.31373739500994524, 'recall': 0.3374188911704312, 'f1-score': 0.17027273345817698, 'support': 487000}}
[[     6 162239      0]
 [     1 164317      0]
 [     3 160434      0]]
training model: results/universal/W4/deepVOL_L3/h1000
Epoch 1/50
9854/9854 - 551s - loss: 3.2541 - accuracy1000: 0.3908 - val_loss: 3.3170 - val_accuracy1000: 0.3275 - 551s/epoch - 56ms/step
Epoch 2/50
9854/9854 - 545s - loss: 3.2394 - accuracy1000: 0.3979 - val_loss: 3.3217 - val_accuracy1000: 0.3311 - 545s/epoch - 55ms/step
Epoch 3/50
9854/9854 - 549s - loss: 3.2245 - accuracy1000: 0.4090 - val_loss: 3.3655 - val_accuracy1000: 0.3389 - 549s/epoch - 56ms/step
Epoch 4/50
9854/9854 - 555s - loss: 3.2035 - accuracy1000: 0.4196 - val_loss: 3.3430 - val_accuracy1000: 0.3296 - 555s/epoch - 56ms/step
Epoch 5/50
9854/9854 - 561s - loss: 3.1906 - accuracy1000: 0.4267 - val_loss: 3.3435 - val_accuracy1000: 0.3298 - 561s/epoch - 57ms/step
Epoch 6/50
9854/9854 - 551s - loss: 3.1820 - accuracy1000: 0.4312 - val_loss: 3.3417 - val_accuracy1000: 0.3288 - 551s/epoch - 56ms/step
Epoch 7/50
9854/9854 - 558s - loss: 3.1768 - accuracy1000: 0.4332 - val_loss: 3.3453 - val_accuracy1000: 0.3296 - 558s/epoch - 57ms/step
Epoch 8/50
9854/9854 - 556s - loss: 3.1721 - accuracy1000: 0.4352 - val_loss: 3.3469 - val_accuracy1000: 0.3351 - 556s/epoch - 56ms/step
Epoch 9/50
9854/9854 - 565s - loss: 3.1685 - accuracy1000: 0.4368 - val_loss: 3.3629 - val_accuracy1000: 0.3382 - 565s/epoch - 57ms/step
Epoch 10/50
9854/9854 - 542s - loss: 3.1641 - accuracy1000: 0.4382 - val_loss: 3.3681 - val_accuracy1000: 0.3408 - 542s/epoch - 55ms/step
Epoch 11/50
9854/9854 - 550s - loss: 3.1608 - accuracy1000: 0.4393 - val_loss: 3.3909 - val_accuracy1000: 0.3416 - 550s/epoch - 56ms/step
testing model in sample: results/universal/W4/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
23720/23720 - 726s - 726s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977111
{'0': {'precision': 0.3183981160864204, 'recall': 0.024304968318447206, 'f1-score': 0.045162453892544, 'support': 1880274}, '1': {'precision': 0.3732050683599277, 'recall': 0.9515789724532093, 'f1-score': 0.5361388490856104, 'support': 2265999}, '2': {'precision': 0.3297267461578874, 'recall': 0.025752093896303962, 'f1-score': 0.047773049590722504, 'support': 1925358}, 'accuracy': 0.3708326477679556, 'macro avg': {'precision': 0.3404433102014119, 'recall': 0.3338786782226535, 'f1-score': 0.2096914508562923, 'support': 6071631}, 'weighted avg': {'precision': 0.34244505958182625, 'recall': 0.3708326477679556, 'f1-score': 0.22922804546807732, 'support': 6071631}}
[[  45700 1788106   46468]
 [  55399 2156277   54323]
 [  42432 1833344   49582]]
Evaluating performance on  train set...
9854/9854 - 305s - 305s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058646
{'0': {'precision': 0.33376442090569447, 'recall': 0.01929503519839744, 'f1-score': 0.036481086332662456, 'support': 842652}, '1': {'precision': 0.3317427420290816, 'recall': 0.9566656984492983, 'f1-score': 0.49264952330008005, 'support': 836589}, '2': {'precision': 0.34903347865427325, 'recall': 0.025173889209257953, 'f1-score': 0.04696075425841916, 'support': 842778}, 'accuracy': 0.33219852824265006, 'macro avg': {'precision': 0.3381802138630164, 'recall': 0.3337115409523179, 'f1-score': 0.19203045463038723, 'support': 2522019}, 'weighted avg': {'precision': 0.3381962319434087, 'recall': 0.33219852824265006, 'f1-score': 0.19130051080538382, 'support': 2522019}}
[[ 16259 806035  20358]
 [ 17042 800336  19211]
 [ 15413 806149  21216]]
Evaluating performance on  val set...
3566/3566 - 104s - 104s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060288
{'0': {'precision': 0.3563630255864733, 'recall': 0.020408425008256355, 'f1-score': 0.038605940401889964, 'support': 311881}, '1': {'precision': 0.32661059345235977, 'recall': 0.9532549334941535, 'f1-score': 0.4865247996525287, 'support': 298470}, '2': {'precision': 0.34174940089010614, 'recall': 0.026443621047612425, 'f1-score': 0.04908888062476757, 'support': 302001}, 'accuracy': 0.32758080214653995, 'macro avg': {'precision': 0.3415743399763131, 'recall': 0.33336899318334073, 'f1-score': 0.1914065402263954, 'support': 912352}, 'weighted avg': {'precision': 0.3417924018677809, 'recall': 0.32758080214653995, 'f1-score': 0.1886096674182032, 'support': 912352}}
[[  6365 298058   7458]
 [  6028 284518   7924]
 [  5468 288547   7986]]
testing model out of sample: results/universal/W4/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
11844/11844 - 354s - 354s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025746
{'0': {'precision': 0.3348395263503661, 'recall': 0.020456910484741752, 'f1-score': 0.038558125031136925, 'support': 1021513}, '1': {'precision': 0.34656389220774825, 'recall': 0.9553524911111683, 'f1-score': 0.5086204951286045, 'support': 1049913}, '2': {'precision': 0.32684435792477234, 'recall': 0.02552863105801195, 'f1-score': 0.04735827823205808, 'support': 960216}, 'accuracy': 0.3458346994796879, 'macro avg': {'precision': 0.33608259216096226, 'recall': 0.33377934421797395, 'f1-score': 0.19817896613059985, 'support': 3031642}, 'weighted avg': {'precision': 0.3363675680800531, 'recall': 0.3458346994796879, 'f1-score': 0.20413659408589938, 'support': 3031642}}
[[  20897  975056   25560]
 [  21950 1003037   24926]
 [  19562  916141   24513]]
Evaluating performance on  train set...
5528/5528 - 170s - 170s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1067976
{'0': {'precision': 0.33721836049856185, 'recall': 0.024451710316210257, 'f1-score': 0.04559716896475588, 'support': 460295}, '1': {'precision': 0.3327808315965819, 'recall': 0.9551959592180339, 'f1-score': 0.4935972572071365, 'support': 470404}, '2': {'precision': 0.35216743342188817, 'recall': 0.022469587506330553, 'f1-score': 0.042243860163884414, 'support': 483765}, 'accuracy': 0.3333085889778743, 'macro avg': {'precision': 0.3407222085056773, 'recall': 0.3340390856801916, 'f1-score': 0.19381276211192558, 'support': 1414464}, 'weighted avg': {'precision': 0.34085536145238327, 'recall': 0.3333085889778743, 'f1-score': 0.1934403237410635, 'support': 1414464}}
[[ 11255 438932  10108]
 [ 11188 449328   9888]
 [ 10933 461962  10870]]
Evaluating performance on  val set...
1908/1908 - 60s - 60s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081482
{'0': {'precision': 0.3447639401593161, 'recall': 0.020949547539357877, 'f1-score': 0.03949894547053161, 'support': 169407}, '1': {'precision': 0.3267508453243966, 'recall': 0.9566175362828303, 'f1-score': 0.4871174841335926, 'support': 159304}, '2': {'precision': 0.332174867386135, 'recall': 0.022856279813222913, 'f1-score': 0.04276966556759303, 'support': 158906}, 'accuracy': 0.32725274139334765, 'macro avg': {'precision': 0.3345632176232825, 'recall': 0.3334744545451371, 'f1-score': 0.18979536505723907, 'support': 487617}, 'weighted avg': {'precision': 0.3347765171250963, 'recall': 0.32725274139334765, 'f1-score': 0.18680135849330134, 'support': 487617}}
[[  3549 162051   3807]
 [  3416 152393   3495]
 [  3329 151945   3632]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
534/534 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1230141
{'0': {'precision': 0.3564154786150713, 'recall': 0.012664869461381194, 'f1-score': 0.024460557351271076, 'support': 55271}, '1': {'precision': 0.2806416963533657, 'recall': 0.9488438928804703, 'f1-score': 0.43316515785832704, 'support': 38275}, '2': {'precision': 0.28411887185311374, 'recall': 0.03481952305836504, 'f1-score': 0.06203632906945506, 'support': 43108}, 'accuracy': 0.2818651484771759, 'macro avg': {'precision': 0.3070586822738503, 'recall': 0.33210942846673885, 'f1-score': 0.17322068142635105, 'support': 136654}, 'weighted avg': {'precision': 0.31238600534417366, 'recall': 0.2818651484771759, 'f1-score': 0.15078678967257186, 'support': 136654}}
[[  700 52153  2418]
 [  594 36317  1364]
 [  670 40937  1501]]
Evaluating performance on  train set...
254/254 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069019
{'0': {'precision': 0.3672869735553379, 'recall': 0.017559468065180744, 'f1-score': 0.03351655717924655, 'support': 21356}, '1': {'precision': 0.3305267248498195, 'recall': 0.9532548799850565, 'f1-score': 0.49085640772846956, 'support': 21414}, '2': {'precision': 0.35018552875695735, 'recall': 0.0340611747721736, 'f1-score': 0.06208371022119893, 'support': 22166}, 'accuracy': 0.3317574226931132, 'macro avg': {'precision': 0.34933307572070493, 'recall': 0.3349585076074703, 'f1-score': 0.19548555837630502, 'support': 64936}, 'weighted avg': {'precision': 0.3493269114760464, 'recall': 0.3317574226931132, 'f1-score': 0.19408534912807274, 'support': 64936}}
[[  375 20287   694]
 [  294 20413   707]
 [  352 21059   755]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1228628
{'0': {'precision': 0.3541666666666667, 'recall': 0.016009686533028387, 'f1-score': 0.03063457330415755, 'support': 7433}, '1': {'precision': 0.2675022928767961, 'recall': 0.9507424846070265, 'f1-score': 0.4175282328614602, 'support': 5522}, '2': {'precision': 0.3511450381679389, 'recall': 0.03001827199164709, 'f1-score': 0.05530840447276662, 'support': 7662}, 'accuracy': 0.2715720036862783, 'macro avg': {'precision': 0.3242713325704672, 'recall': 0.332256814377234, 'f1-score': 0.16782373687946142, 'support': 20617}, 'weighted avg': {'precision': 0.3298317784858006, 'recall': 0.2715720036862783, 'f1-score': 0.14342875686574788, 'support': 20617}}
[[ 119 7062  252]
 [  99 5250  173]
 [ 118 7314  230]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
1613/1613 - 28s - 28s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1201121
{'0': {'precision': 0.42387434554973824, 'recall': 0.012728278915329275, 'f1-score': 0.024714422648375062, 'support': 159016}, '1': {'precision': 0.24451918863888245, 'recall': 0.9393912389100126, 'f1-score': 0.388034733384869, 'support': 100992}, '2': {'precision': 0.41366261700856405, 'recall': 0.054357142389803784, 'f1-score': 0.09608789937834322, 'support': 152841}, 'accuracy': 0.25482198091796276, 'macro avg': {'precision': 0.3606853837323949, 'recall': 0.3354922200717152, 'f1-score': 0.16961235180386244, 'support': 412849}, 'weighted avg': {'precision': 0.3762196175288329, 'recall': 0.25482198091796276, 'f1-score': 0.1400138138998618, 'support': 412849}}
[[  2024 150379   6613]
 [   958  94871   5163]
 [  1793 142740   8308]]
Evaluating performance on  train set...
634/634 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045352
{'0': {'precision': 0.370250606305578, 'recall': 0.016658785872767614, 'f1-score': 0.03188304907761921, 'support': 54986}, '1': {'precision': 0.3321765322158198, 'recall': 0.9422012555254262, 'f1-score': 0.4911842449240422, 'support': 53842}, '2': {'precision': 0.34539473684210525, 'recall': 0.045260317103339706, 'f1-score': 0.08003314001657001, 'support': 53358}, 'accuracy': 0.33332716757303343, 'macro avg': {'precision': 0.34927395845450104, 'recall': 0.3347067861671778, 'f1-score': 0.20103347800607715, 'support': 162186}, 'weighted avg': {'precision': 0.34943349644422905, 'recall': 0.33332716757303343, 'f1-score': 0.2002014460976064, 'support': 162186}}
[[  916 51755  2315]
 [  850 50730  2262]
 [  708 50235  2415]]
Evaluating performance on  val set...
206/206 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1185246
{'0': {'precision': 0.43478260869565216, 'recall': 0.02715478225887559, 'f1-score': 0.05111700113593336, 'support': 19886}, '1': {'precision': 0.2601712846347607, 'recall': 0.9371416128329825, 'f1-score': 0.4072742184789123, 'support': 13777}, '2': {'precision': 0.38056897477187335, 'recall': 0.03718466460376567, 'f1-score': 0.06774964166268514, 'support': 19067}, 'accuracy': 0.2685378342499526, 'macro avg': {'precision': 0.35850762270076214, 'recall': 0.3338270198985412, 'f1-score': 0.17538028709251027, 'support': 52730}, 'weighted avg': {'precision': 0.3695576595279754, 'recall': 0.2685378342499526, 'f1-score': 0.1501860802229388, 'support': 52730}}
[[  540 18748   598]
 [  310 12911   556]
 [  392 17966   709]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
989/989 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023574
{'0': {'precision': 0.3014967925873129, 'recall': 0.009631695793248705, 'f1-score': 0.018667049127878112, 'support': 87835}, '1': {'precision': 0.3644064635647413, 'recall': 0.9504496713939813, 'f1-score': 0.5268257025850576, 'support': 92512}, '2': {'precision': 0.2603697024346258, 'recall': 0.03180854286579824, 'f1-score': 0.05669129015633052, 'support': 72622}, 'accuracy': 0.3600599282916089, 'macro avg': {'precision': 0.3087576528622267, 'recall': 0.3306299700176761, 'f1-score': 0.20072801395642206, 'support': 252969}, 'weighted avg': {'precision': 0.3126964571327529, 'recall': 0.3600599282916089, 'f1-score': 0.21541910088362232, 'support': 252969}}
[[  846 83906  3083]
 [ 1105 87928  3479]
 [  855 69457  2310]]
Evaluating performance on  train set...
339/339 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030614
{'0': {'precision': 0.3238095238095238, 'recall': 0.01211646056804818, 'f1-score': 0.0233588677819381, 'support': 28061}, '1': {'precision': 0.3317904787292048, 'recall': 0.9551765034184456, 'f1-score': 0.49250442899666363, 'support': 28668}, '2': {'precision': 0.3596757852077001, 'recall': 0.03572267131788146, 'f1-score': 0.0649905412827241, 'support': 29813}, 'accuracy': 0.3326477317371912, 'macro avg': {'precision': 0.3384252625821429, 'recall': 0.33433854510145844, 'f1-score': 0.19361794602044194, 'support': 86542}, 'weighted avg': {'precision': 0.33880893296000847, 'recall': 0.3326477317371912, 'f1-score': 0.19311031830287226, 'support': 86542}}
[[  340 26741   980]
 [  369 27383   916]
 [  341 28407  1065]]
Evaluating performance on  val set...
124/124 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1158538
{'0': {'precision': 0.36074270557029176, 'recall': 0.012715033657442034, 'f1-score': 0.024564255396008306, 'support': 10696}, '1': {'precision': 0.28958871448440293, 'recall': 0.9569927774130007, 'f1-score': 0.4446308724832215, 'support': 9138}, '2': {'precision': 0.35318704284221525, 'recall': 0.028893828004787143, 'f1-score': 0.05341762149348084, 'support': 11698}, 'accuracy': 0.2923696562222504, 'macro avg': {'precision': 0.33450615429896996, 'recall': 0.33286721302507666, 'f1-score': 0.17420424979090354, 'support': 31532}, 'weighted avg': {'precision': 0.3373191576464084, 'recall': 0.2923696562222504, 'f1-score': 0.15700417114988335, 'support': 31532}}
[[  136 10216   344]
 [  118  8745   275]
 [  123 11237   338]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
925/925 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0958956
{'0': {'precision': 0.3515456506110712, 'recall': 0.0069502679193257245, 'f1-score': 0.013631041980264259, 'support': 70357}, '1': {'precision': 0.3720295840082593, 'recall': 0.9485346676197284, 'f1-score': 0.5344426935333847, 'support': 88137}, '2': {'precision': 0.3285161046566544, 'recall': 0.044475703324808186, 'f1-score': 0.0783448027301294, 'support': 78200}, 'accuracy': 0.369962905692582, 'macro avg': {'precision': 0.35069711309199497, 'recall': 0.3333202129546208, 'f1-score': 0.20880617941459279, 'support': 236694}, 'weighted avg': {'precision': 0.3515645862165051, 'recall': 0.369962905692582, 'f1-score': 0.22894445348869638, 'support': 236694}}
[[  489 66832  3036]
 [  463 83601  4073]
 [  439 74283  3478]]
Evaluating performance on  train set...
346/346 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1041492
{'0': {'precision': 0.35311572700296734, 'recall': 0.004029800203183204, 'f1-score': 0.007968661064050624, 'support': 29530}, '1': {'precision': 0.3315489614243323, 'recall': 0.9539959016393442, 'f1-score': 0.4920813881793359, 'support': 29280}, '2': {'precision': 0.3464725081596786, 'recall': 0.046370967741935484, 'f1-score': 0.08179474261328276, 'support': 29760}, 'accuracy': 0.33230213390538554, 'macro avg': {'precision': 0.3437123988623261, 'recall': 0.3347988898614876, 'f1-score': 0.1939482639522231, 'support': 88570}, 'weighted avg': {'precision': 0.34375389919537214, 'recall': 0.33230213390538554, 'f1-score': 0.19281550352584018, 'support': 88570}}
[[  119 28036  1375]
 [  119 27933  1228]
 [   99 28281  1380]]
Evaluating performance on  val set...
127/127 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108014
{'0': {'precision': 0.3153846153846154, 'recall': 0.0038555576452886965, 'f1-score': 0.007617985878855443, 'support': 10634}, '1': {'precision': 0.30477272727272725, 'recall': 0.9590314671025746, 'f1-score': 0.46255050753917415, 'support': 9788}, '2': {'precision': 0.4123788217747949, 'recall': 0.04667060511435564, 'f1-score': 0.08385140257771038, 'support': 11849}, 'accuracy': 0.309286975922655, 'macro avg': {'precision': 0.3441787214773792, 'recall': 0.336519209954073, 'f1-score': 0.18467329866524665, 'support': 32271}, 'weighted avg': {'precision': 0.3477794959485296, 'recall': 0.309286975922655, 'f1-score': 0.17359267759822986, 'support': 32271}}
[[   41 10163   430]
 [   43  9387   358]
 [   46 11250   553]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
1590/1590 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048702
{'0': {'precision': 0.2847208424398967, 'recall': 0.010627567896290364, 'f1-score': 0.020490308927511778, 'support': 134838}, '1': {'precision': 0.3434799452465198, 'recall': 0.9508869520452449, 'f1-score': 0.5046646339728034, 'support': 139861}, '2': {'precision': 0.32040346601678854, 'recall': 0.035775836004111994, 'f1-score': 0.06436478363750102, 'support': 132296}, 'accuracy': 0.34191574835071686, 'macro avg': {'precision': 0.31620141790106837, 'recall': 0.33243011864854904, 'f1-score': 0.1965065755126054, 'support': 406995}, 'weighted avg': {'precision': 0.3165118355635606, 'recall': 0.34191574835071686, 'f1-score': 0.20113509026731263, 'support': 406995}}
[[  1433 128225   5180]
 [  2010 132992   4859]
 [  1590 125973   4733]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075191
{'0': {'precision': 0.3, 'recall': 0.011446825502462399, 'f1-score': 0.022052224454036498, 'support': 45078}, '1': {'precision': 0.32521608474923547, 'recall': 0.9565857904957479, 'f1-score': 0.48540588295257625, 'support': 44801}, '2': {'precision': 0.3681687440076702, 'recall': 0.03214061519146265, 'f1-score': 0.05912012624610292, 'support': 47790}, 'accuracy': 0.3262027035861378, 'macro avg': {'precision': 0.33112827625230185, 'recall': 0.3333910770632243, 'f1-score': 0.1888594112175719, 'support': 137669}, 'weighted avg': {'precision': 0.33186984788861007, 'recall': 0.3262027035861378, 'f1-score': 0.18570694905460694, 'support': 137669}}
[[  516 43223  1339]
 [  648 42856  1297]
 [  556 45698  1536]]
Evaluating performance on  val set...
209/209 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1114372
{'0': {'precision': 0.31781701444622795, 'recall': 0.01, 'f1-score': 0.01938990354012633, 'support': 19800}, '1': {'precision': 0.32057811424638677, 'recall': 0.9490075091681704, 'f1-score': 0.47926036981509246, 'support': 17179}, '2': {'precision': 0.2874875868917577, 'recall': 0.03506328347362684, 'f1-score': 0.06250337345495763, 'support': 16513}, 'accuracy': 0.3193000822552905, 'macro avg': {'precision': 0.30862757186145745, 'recall': 0.3313569308805991, 'f1-score': 0.18705121560339213, 'support': 53492}, 'weighted avg': {'precision': 0.3093410385294546, 'recall': 0.3193000822552905, 'f1-score': 0.1803868277314307, 'support': 53492}}
[[  198 18814   788]
 [  229 16303   647]
 [  196 15738   579]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
3782/3782 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1329622
{'0': {'precision': 0.37997223186393614, 'recall': 0.031119146504745905, 'f1-score': 0.05752692551243212, 'support': 351777}, '1': {'precision': 0.21875755534832314, 'recall': 0.9561951850087044, 'f1-score': 0.3560567398562443, 'support': 211963}, '2': {'precision': 0.4448046813221572, 'recall': 0.013915964889711339, 'f1-score': 0.026987607290732095, 'support': 404212}, 'accuracy': 0.2265091657437559, 'macro avg': {'precision': 0.34784482284480545, 'recall': 0.33374343213438723, 'f1-score': 0.1468570908864695, 'support': 967952}, 'weighted avg': {'precision': 0.371743009322041, 'recall': 0.2265091657437559, 'f1-score': 0.11014618363755367, 'support': 967952}}
[[ 10947 336383   4447]
 [  6711 202678   2574]
 [ 11152 387435   5625]]
Evaluating performance on  train set...
1601/1601 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1083456
{'0': {'precision': 0.3294894539720087, 'recall': 0.02413962422194301, 'f1-score': 0.044983583615910434, 'support': 138486}, '1': {'precision': 0.328513578439223, 'recall': 0.961683286203304, 'f1-score': 0.48973304203986273, 'support': 134380}, '2': {'precision': 0.35582329317269074, 'recall': 0.016181347982993147, 'f1-score': 0.030954992977479022, 'support': 136886}, 'accuracy': 0.32895263476444286, 'macro avg': {'precision': 0.3379421085279741, 'recall': 0.3340014194694134, 'f1-score': 0.18855720621108407, 'support': 409752}, 'weighted avg': {'precision': 0.3379667664896506, 'recall': 0.32895263476444286, 'f1-score': 0.18615462015722903, 'support': 409752}}
[[  3343 132882   2261]
 [  3400 129231   1749]
 [  3403 131268   2215]]
Evaluating performance on  val set...
532/532 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112469
{'0': {'precision': 0.36804915514592934, 'recall': 0.02396527235991918, 'f1-score': 0.04500037562917887, 'support': 49989}, '1': {'precision': 0.2961725348334585, 'recall': 0.9582899370133413, 'f1-score': 0.4524952577223016, 'support': 40326}, '2': {'precision': 0.37443298969072164, 'recall': 0.01980673167113845, 'f1-score': 0.03762327007541228, 'support': 45843}, 'accuracy': 0.2992846545924588, 'macro avg': {'precision': 0.34621822655670315, 'recall': 0.33402064701479967, 'f1-score': 0.17837296780896425, 'support': 136158}, 'weighted avg': {'precision': 0.3489107830805069, 'recall': 0.2992846545924588, 'f1-score': 0.16320459400331733, 'support': 136158}}
[[ 1198 47945   846]
 [ 1011 38644   671]
 [ 1046 43889   908]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
4457/4457 - 66s - 66s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0868517
{'0': {'precision': 0.31740708593071887, 'recall': 0.022708860830955184, 'f1-score': 0.04238527131578739, 'support': 354267}, '1': {'precision': 0.4133525730328469, 'recall': 0.9522162815130518, 'f1-score': 0.5764645975000307, 'support': 470202}, '2': {'precision': 0.31141324454310026, 'recall': 0.03191570033808335, 'f1-score': 0.05789766311481517, 'support': 316490}, 'accuracy': 0.408323173751204, 'macro avg': {'precision': 0.34739096783555534, 'recall': 0.3356136142273634, 'f1-score': 0.2255825106435444, 'support': 1140959}, 'weighted avg': {'precision': 0.35528466879358017, 'recall': 0.408323173751204, 'f1-score': 0.26678832542286557, 'support': 1140959}}
[[  8045 335611  10611]
 [ 10744 447734  11724]
 [  6557 299832  10101]]
Evaluating performance on  train set...
2425/2425 - 40s - 40s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107209
{'0': {'precision': 0.345921084483176, 'recall': 0.02801905844983432, 'f1-score': 0.051839222230283685, 'support': 204004}, '1': {'precision': 0.3304348120876811, 'recall': 0.951270690193629, 'f1-score': 0.4904916943855959, 'support': 204928}, '2': {'precision': 0.3558953496528021, 'recall': 0.02395599726163216, 'f1-score': 0.04489033981827994, 'support': 211805}, 'accuracy': 0.3314318302276165, 'macro avg': {'precision': 0.3440837487412198, 'recall': 0.3344152486350318, 'f1-score': 0.1957404188113865, 'support': 620737}, 'weighted avg': {'precision': 0.34421187173250817, 'recall': 0.3314318302276165, 'f1-score': 0.19428339065357628, 'support': 620737}}
[[  5716 193581   4707]
 [  5510 194942   4476]
 [  5298 201433   5074]]
Evaluating performance on  val set...
787/787 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009567
{'0': {'precision': 0.3336965998256321, 'recall': 0.022539565697460434, 'f1-score': 0.0422269110366417, 'support': 67925}, '1': {'precision': 0.3500735240439267, 'recall': 0.9541236161050553, 'f1-score': 0.5122130794203031, 'support': 70363}, '2': {'precision': 0.344238683127572, 'recall': 0.02658340483681317, 'f1-score': 0.049355400182907044, 'support': 62934}, 'accuracy': 0.3495591933287613, 'macro avg': {'precision': 0.3426696023323769, 'recall': 0.33441552887977627, 'f1-score': 0.20126513021328396, 'support': 201222}, 'weighted avg': {'precision': 0.3427203894177053, 'recall': 0.3495591933287613, 'f1-score': 0.20880045220962792, 'support': 201222}}
[[ 1531 64810  1584]
 [ 1625 67135  1603]
 [ 1432 59829  1673]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
4676/4676 - 74s - 74s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030066
{'0': {'precision': 0.3512742628537561, 'recall': 0.023347481830178644, 'f1-score': 0.04378480206111311, 'support': 406168}, '1': {'precision': 0.3428959195401295, 'recall': 0.959156302447104, 'f1-score': 0.5051883123525518, 'support': 409341}, '2': {'precision': 0.35875875875875873, 'recall': 0.02348746985425186, 'f1-score': 0.044088521484543175, 'support': 381480}, 'accuracy': 0.3434158542810335, 'macro avg': {'precision': 0.3509763137175481, 'recall': 0.33533041804384484, 'f1-score': 0.1976872119660694, 'support': 1196989}, 'weighted avg': {'precision': 0.35079438047179373, 'recall': 0.3434158542810335, 'f1-score': 0.20167032748520464, 'support': 1196989}}
[[  9483 388010   8675]
 [  9379 392622   7340]
 [  8134 364386   8960]]
Evaluating performance on  train set...
2108/2108 - 35s - 35s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103756
{'0': {'precision': 0.35789025946405784, 'recall': 0.02329160738111979, 'f1-score': 0.043736809822328956, 'support': 180623}, '1': {'precision': 0.3369080035431498, 'recall': 0.9613489061063112, 'f1-score': 0.4989553889639917, 'support': 181599}, '2': {'precision': 0.3448421497201985, 'recall': 0.018432503513237428, 'f1-score': 0.034994481886659025, 'support': 177187}, 'accuracy': 0.3375045651815227, 'macro avg': {'precision': 0.3465468042424687, 'recall': 0.3343576723335561, 'f1-score': 0.19256222689099323, 'support': 539409}, 'weighted avg': {'precision': 0.346540222452873, 'recall': 0.3375045651815227, 'f1-score': 0.1941203071195733, 'support': 539409}}
[[  4207 173368   3048]
 [  3862 174580   3157]
 [  3686 170235   3266]]
Evaluating performance on  val set...
798/798 - 13s - 13s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1137484
{'0': {'precision': 0.37387857291883997, 'recall': 0.025030380065090164, 'f1-score': 0.0469195925955018, 'support': 71593}, '1': {'precision': 0.30015697623880844, 'recall': 0.9570562149471762, 'f1-score': 0.45699027274461196, 'support': 61336}, '2': {'precision': 0.340036563071298, 'recall': 0.01827009429726089, 'f1-score': 0.034677000519355995, 'support': 71264}, 'accuracy': 0.3026352519430147, 'macro avg': {'precision': 0.3380240374096488, 'recall': 0.3334522297698424, 'f1-score': 0.1795289552864899, 'support': 204193}, 'weighted avg': {'precision': 0.33992292877951275, 'recall': 0.3026352519430147, 'f1-score': 0.16582493781258253, 'support': 204193}}
[[ 1792 68511  1290]
 [ 1397 58702  1237]
 [ 1604 68358  1302]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
4274/4274 - 68s - 68s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1156076
{'0': {'precision': 0.36714003367249837, 'recall': 0.02576662847866181, 'f1-score': 0.048153730942048466, 'support': 389302}, '1': {'precision': 0.2831047366746901, 'recall': 0.9647094605307008, 'f1-score': 0.4377475723593995, 'support': 309063}, '2': {'precision': 0.42782442185888936, 'recall': 0.014680313368713673, 'f1-score': 0.028386573429307223, 'support': 395700}, 'accuracy': 0.28699940131527835, 'macro avg': {'precision': 0.35935639740202596, 'recall': 0.33505213412602547, 'f1-score': 0.17142929224358505, 'support': 1094065}, 'weighted avg': {'precision': 0.36534910846176716, 'recall': 0.28699940131527835, 'f1-score': 0.15106094137486467, 'support': 1094065}}
[[ 10031 374942   4329]
 [  7467 298156   3440]
 [  9824 380067   5809]]
Evaluating performance on  train set...
1972/1972 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066421
{'0': {'precision': 0.32863490117971506, 'recall': 0.026514870577764593, 'f1-score': 0.04907063197026023, 'support': 161796}, '1': {'precision': 0.33798639377151773, 'recall': 0.959881120561805, 'f1-score': 0.4999381752068841, 'support': 170593}, '2': {'precision': 0.34152229480261287, 'recall': 0.013967048219709509, 'f1-score': 0.026836575853776926, 'support': 172191}, 'accuracy': 0.3377938087121963, 'macro avg': {'precision': 0.33604786325128194, 'recall': 0.333454346453093, 'f1-score': 0.19194846101030708, 'support': 504580}, 'weighted avg': {'precision': 0.33619444054123115, 'recall': 0.3377938087121963, 'f1-score': 0.19391652845171412, 'support': 504580}}
[[  4290 155356   2150]
 [  4357 163749   2487]
 [  4407 165379   2405]]
Evaluating performance on  val set...
707/707 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1123075
{'0': {'precision': 0.3412055780476833, 'recall': 0.02386984092017686, 'f1-score': 0.04461830321034133, 'support': 63553}, '1': {'precision': 0.31560056919983637, 'recall': 0.9593534377079612, 'f1-score': 0.4749543738268329, 'support': 57102}, '2': {'precision': 0.30867813987550347, 'recall': 0.014026855688114612, 'f1-score': 0.026834314817762217, 'support': 60099}, 'accuracy': 0.3161257842150105, 'macro avg': {'precision': 0.3218280957076744, 'recall': 0.3324167114387509, 'f1-score': 0.1821356639516455, 'support': 180754}, 'weighted avg': {'precision': 0.32230163278539536, 'recall': 0.3161257842150105, 'f1-score': 0.1746527720792864, 'support': 180754}}
[[ 1517 61048   988]
 [ 1421 54781   900]
 [ 1508 57748   843]]
testing model on single stock: results/universal/W4/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
12724/12724 - 205s - 205s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0825636
{'0': {'precision': 0.2817907972242887, 'recall': 0.025875855025331594, 'f1-score': 0.0473992079618197, 'support': 892956}, '1': {'precision': 0.4469674171043151, 'recall': 0.9499713513506086, 'f1-score': 0.6079095960747237, 'support': 1455566}, '2': {'precision': 0.2836152232838237, 'recall': 0.02544944283945522, 'f1-score': 0.04670769715540348, 'support': 908625}, 'accuracy': 0.4387201437331505, 'macro avg': {'precision': 0.3374578125374758, 'recall': 0.3337655497384651, 'f1-score': 0.23400550039731563, 'support': 3257147}, 'weighted avg': {'precision': 0.3561144894066297, 'recall': 0.4387201437331505, 'f1-score': 0.29768927456841354, 'support': 3257147}}
[[  23106  846401   23449]
 [  37860 1382746   34960]
 [  21031  864470   23124]]
Evaluating performance on  train set...
5165/5165 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1061968
{'0': {'precision': 0.3145650708024275, 'recall': 0.017001232270452613, 'f1-score': 0.032258970729651754, 'support': 439027}, '1': {'precision': 0.3306901431736793, 'recall': 0.9555347803825477, 'f1-score': 0.49133853270154215, 'support': 437488}, '2': {'precision': 0.34749598481530153, 'recall': 0.026706344664453856, 'f1-score': 0.049600693576084966, 'support': 445587}, 'accuracy': 0.33083604744565853, 'macro avg': {'precision': 0.33091706626380274, 'recall': 0.33308078577248473, 'f1-score': 0.19106606566909298, 'support': 1322102}, 'weighted avg': {'precision': 0.3309995916214027, 'recall': 0.33083604744565853, 'f1-score': 0.19001460960315167, 'support': 1322102}}
[[  7464 419887  11676]
 [  8784 418035  10669]
 [  7480 426207  11900]]
Evaluating performance on  val set...
1903/1903 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993527
{'0': {'precision': 0.3383038210624418, 'recall': 0.01817510436290126, 'f1-score': 0.03449689064699489, 'support': 159779}, '1': {'precision': 0.354837946534185, 'recall': 0.9523559393453127, 'f1-score': 0.5170342816583179, 'support': 173243}, '2': {'precision': 0.32247508552729437, 'recall': 0.028159866993986152, 'f1-score': 0.05179663608562691, 'support': 153978}, 'accuracy': 0.353652977412731, 'macro avg': {'precision': 0.33853895104130705, 'recall': 0.3328969702340667, 'f1-score': 0.20110926946364657, 'support': 487000}, 'weighted avg': {'precision': 0.3391809144071446, 'recall': 0.353652977412731, 'f1-score': 0.2116221584788723, 'support': 487000}}
[[  2904 152702   4173]
 [  3317 164989   4937]
 [  2363 147279   4336]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        80 (peak)  19.85 (ave)

============================================
