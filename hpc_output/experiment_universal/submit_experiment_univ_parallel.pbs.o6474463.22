This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W7/deepLOB_L1/h50
Epoch 1/50
12475/12475 - 211s - loss: 3.1912 - accuracy50: 0.4123 - val_loss: 3.5070 - val_accuracy50: 0.3390 - 211s/epoch - 17ms/step
Epoch 2/50
12475/12475 - 189s - loss: 3.1594 - accuracy50: 0.4272 - val_loss: 3.3876 - val_accuracy50: 0.3771 - 189s/epoch - 15ms/step
Epoch 3/50
12475/12475 - 187s - loss: 3.1403 - accuracy50: 0.4340 - val_loss: 3.6830 - val_accuracy50: 0.3800 - 187s/epoch - 15ms/step
Epoch 4/50
12475/12475 - 187s - loss: 3.1296 - accuracy50: 0.4376 - val_loss: 3.4311 - val_accuracy50: 0.3696 - 187s/epoch - 15ms/step
Epoch 5/50
12475/12475 - 190s - loss: 3.1218 - accuracy50: 0.4402 - val_loss: 3.4059 - val_accuracy50: 0.3727 - 190s/epoch - 15ms/step
Epoch 6/50
12475/12475 - 192s - loss: 3.1173 - accuracy50: 0.4416 - val_loss: 3.4015 - val_accuracy50: 0.3669 - 192s/epoch - 15ms/step
Epoch 7/50
12475/12475 - 189s - loss: 3.1135 - accuracy50: 0.4430 - val_loss: 3.4360 - val_accuracy50: 0.3719 - 189s/epoch - 15ms/step
Epoch 8/50
12475/12475 - 193s - loss: 3.1105 - accuracy50: 0.4439 - val_loss: 3.5446 - val_accuracy50: 0.3737 - 193s/epoch - 15ms/step
Epoch 9/50
12475/12475 - 191s - loss: 3.1077 - accuracy50: 0.4450 - val_loss: 3.4696 - val_accuracy50: 0.3739 - 191s/epoch - 15ms/step
Epoch 10/50
12475/12475 - 185s - loss: 3.1048 - accuracy50: 0.4458 - val_loss: 3.4722 - val_accuracy50: 0.3774 - 185s/epoch - 15ms/step
Epoch 11/50
12475/12475 - 189s - loss: 3.1027 - accuracy50: 0.4467 - val_loss: 3.4900 - val_accuracy50: 0.3736 - 189s/epoch - 15ms/step
Epoch 12/50
12475/12475 - 187s - loss: 3.1014 - accuracy50: 0.4470 - val_loss: 3.5000 - val_accuracy50: 0.3769 - 187s/epoch - 15ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 184s - 184s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0553082
{'0': {'precision': 0.3302357239424233, 'recall': 0.34150571445848704, 'f1-score': 0.33577617933811277, 'support': 2480550}, '1': {'precision': 0.4909640515822517, 'recall': 0.7177846740310911, 'f1-score': 0.5830930188524209, 'support': 4547719}, '2': {'precision': 0.5072262015381609, 'recall': 0.05971453633245509, 'f1-score': 0.1068498889470738, 'support': 2477303}, 'accuracy': 0.4480883422901852, 'macro avg': {'precision': 0.44280865902094524, 'recall': 0.37300164160734445, 'f1-score': 0.34190636237920247, 'support': 9505572}, 'weighted avg': {'precision': 0.4532589686840576, 'recall': 0.4480883422901852, 'f1-score': 0.3944373208364443, 'support': 9505572}}
[[ 847122 1596893   36535]
 [1176255 3264283  107181]
 [ 541827 1787545  147931]]
Evaluating performance on  train set...
12475/12475 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1171513
{'0': {'precision': 0.37322253707039366, 'recall': 0.4349976409633395, 'f1-score': 0.40174924505088916, 'support': 1032201}, '1': {'precision': 0.3787642836326421, 'recall': 0.6287771949286292, 'f1-score': 0.47275144273318637, 'support': 1143044}, '2': {'precision': 0.4803883411174537, 'recall': 0.04365523427575481, 'f1-score': 0.08003710591848405, 'support': 1017839}, 'accuracy': 0.37962014153088364, 'macro avg': {'precision': 0.41079172060682984, 'recall': 0.3691433567225744, 'f1-score': 0.3181792645675198, 'support': 3193084}, 'weighted avg': {'precision': 0.40936690251237834, 'recall': 0.37962014153088364, 'f1-score': 0.32461612674431645, 'support': 3193084}}
[[449005 564753  18443]
 [394705 718720  29619]
 [359339 614066  44434]]
Evaluating performance on  val set...
3866/3866 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1187065
{'0': {'precision': 0.35902810788064865, 'recall': 0.30071895019564715, 'f1-score': 0.32729681586579357, 'support': 306419}, '1': {'precision': 0.3789442766618557, 'recall': 0.726527851873407, 'f1-score': 0.4980922887086212, 'support': 371142}, '2': {'precision': 0.5316268649601983, 'recall': 0.03578797398288415, 'f1-score': 0.06706151163489868, 'support': 311641}, 'accuracy': 0.3770150080569995, 'macro avg': {'precision': 0.4231997498342342, 'recall': 0.3543449253506461, 'f1-score': 0.29748353873643785, 'support': 989202}, 'weighted avg': {'precision': 0.4208765230363223, 'recall': 0.3770150080569995, 'f1-score': 0.3093928720161172, 'support': 989202}}
[[ 92146 210686   3587]
 [ 95258 269645   6239]
 [ 69250 231238  11153]]
testing model out of sample: results/universal/W7/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 74s - 74s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0548487
{'0': {'precision': 0.37086737565992667, 'recall': 0.4762081515676618, 'f1-score': 0.41698776971586976, 'support': 1023754}, '1': {'precision': 0.4919415838789963, 'recall': 0.6762611397508441, 'f1-score': 0.5695603502295199, 'support': 1708970}, '2': {'precision': 0.48938327945743804, 'recall': 0.051891529641741346, 'f1-score': 0.09383347063352827, 'support': 1041538}, 'accuracy': 0.44969771573886497, 'macro avg': {'precision': 0.45073074633212035, 'recall': 0.4014536069867491, 'f1-score': 0.3601271968596393, 'support': 3774262}, 'weighted avg': {'precision': 0.4583946874972065, 'recall': 0.44969771573886497, 'f1-score': 0.3968949623174403, 'support': 3774262}}
[[ 487520  515285   20949]
 [ 517817 1155710   35443]
 [ 309203  678288   54047]]
Evaluating performance on  train set...
5285/5285 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0640578
{'0': {'precision': 0.4000912571517629, 'recall': 0.5193343098998003, 'f1-score': 0.45198028938040524, 'support': 410281}, '1': {'precision': 0.45674543027701575, 'recall': 0.6116901902013853, 'f1-score': 0.5229827492922101, 'support': 536484}, '2': {'precision': 0.4915064071019428, 'recall': 0.12304098984677775, 'f1-score': 0.1968129232867049, 'support': 405881}, 'accuracy': 0.43705078786319557, 'macro avg': {'precision': 0.44944769817690716, 'recall': 0.4180218299826544, 'f1-score': 0.3905919873197734, 'support': 1352646}, 'weighted avg': {'precision': 0.44999177058384865, 'recall': 0.43705078786319557, 'f1-score': 0.4035744965756711, 'support': 1352646}}
[[213073 174543  22665]
 [179321 328162  29001]
 [140167 215774  49940]]
Evaluating performance on  val set...
1714/1714 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0620406
{'0': {'precision': 0.3861007174487659, 'recall': 0.5260921762449717, 'f1-score': 0.4453544159280939, 'support': 128276}, '1': {'precision': 0.46327835406425394, 'recall': 0.6105627724788103, 'f1-score': 0.5268200468303581, 'support': 180748}, '2': {'precision': 0.49279066980868313, 'recall': 0.09563599720951864, 'f1-score': 0.16018487864093425, 'support': 129010}, 'accuracy': 0.4341694936922705, 'macro avg': {'precision': 0.44738991377390097, 'recall': 0.41076364864443354, 'f1-score': 0.3774531137997954, 'support': 438034}, 'weighted avg': {'precision': 0.44936926330805804, 'recall': 0.4341694936922705, 'f1-score': 0.39498167739388423, 'support': 438034}}
[[ 67485  55247   5544]
 [ 63235 110358   7155]
 [ 44066  72606  12338]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1107239
{'0': {'precision': 0.35506031265213395, 'recall': 0.24310210732935816, 'f1-score': 0.2886035877594091, 'support': 54002}, '1': {'precision': 0.3913915593225284, 'recall': 0.7846948027258636, 'f1-score': 0.5222795405878917, 'support': 68382}, '2': {'precision': 0.42938733125649015, 'recall': 0.029780338494778538, 'f1-score': 0.055697737068965525, 'support': 55540}, 'accuracy': 0.3846642386636991, 'macro avg': {'precision': 0.3919464010770508, 'recall': 0.35252574951666676, 'f1-score': 0.2888602884720888, 'support': 177924}, 'weighted avg': {'precision': 0.3922252028473907, 'recall': 0.3846642386636991, 'f1-score': 0.305709981831991, 'support': 177924}}
[[13128 39894   980]
 [13505 53659  1218]
 [10341 43545  1654]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1248869
{'0': {'precision': 0.38430063177190743, 'recall': 0.4764417028529686, 'f1-score': 0.4254393911940569, 'support': 24641}, '1': {'precision': 0.33966876971608834, 'recall': 0.5419655215804706, 'f1-score': 0.4176079895282882, 'support': 23841}, '2': {'precision': 0.43704138538303494, 'recall': 0.06332397720506933, 'f1-score': 0.11061996211136288, 'support': 23514}, 'accuracy': 0.36321462303461305, 'macro avg': {'precision': 0.38700359562367687, 'recall': 0.36057706721283617, 'f1-score': 0.3178891142779026, 'support': 71996}, 'weighted avg': {'precision': 0.3867462934356008, 'recall': 0.36321462303461305, 'f1-score': 0.3200255834469035, 'support': 71996}}
[[11740 12022   879]
 [ 9881 12921  1039]
 [ 8928 13097  1489]]
Evaluating performance on  val set...
73/73 - 1s - 563ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1547831
{'0': {'precision': 0.38453304789938453, 'recall': 0.4514608859566447, 'f1-score': 0.41531791907514454, 'support': 6366}, '1': {'precision': 0.32816240543905006, 'recall': 0.6092444444444445, 'f1-score': 0.42656211102813046, 'support': 5625}, '2': {'precision': 0.46362098138747887, 'recall': 0.04204388522326224, 'f1-score': 0.0770962296004502, 'support': 6517}, 'accuracy': 0.35525178301275123, 'macro avg': {'precision': 0.3921054782419711, 'recall': 0.36758307187478384, 'f1-score': 0.30632541990124174, 'support': 18508}, 'weighted avg': {'precision': 0.39524901930107725, 'recall': 0.35525178301275123, 'f1-score': 0.29964133756601136, 'support': 18508}}
[[2874 3322  170]
 [2051 3427  147]
 [2549 3694  274]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
2006/2006 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0008093
{'0': {'precision': 0.31073037724242275, 'recall': 0.678544847241636, 'f1-score': 0.4262605413357205, 'support': 110174}, '1': {'precision': 0.6473218362962757, 'recall': 0.5495967796313028, 'f1-score': 0.5944698192161475, 'support': 296612}, '2': {'precision': 0.5225022717490077, 'recall': 0.10253979576512989, 'f1-score': 0.17143574494127248, 'support': 106544}, 'accuracy': 0.48448366547834726, 'macro avg': {'precision': 0.49351816176256874, 'recall': 0.44356047421268957, 'f1-score': 0.39738870183104685, 'support': 513330}, 'weighted avg': {'precision': 0.5491736604738549, 'recall': 0.48448366547834726, 'f1-score': 0.47056505738508275, 'support': 513330}}
[[ 74758  33227   2189]
 [125800 163017   7795]
 [ 40030  55589  10925]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9971428
{'0': {'precision': 0.31983856728465127, 'recall': 0.6677638075176091, 'f1-score': 0.4325154028183426, 'support': 30382}, '1': {'precision': 0.6548348587345801, 'recall': 0.526376396228105, 'f1-score': 0.5836206040487438, 'support': 78157}, '2': {'precision': 0.47562056737588654, 'recall': 0.1850127595006552, 'f1-score': 0.2663985302150057, 'support': 28998}, 'accuracy': 0.48563659233515344, 'macro avg': {'precision': 0.483431331131706, 'recall': 0.4597176544154564, 'f1-score': 0.4275115123606974, 'support': 137537}, 'weighted avg': {'precision': 0.5430488422615501, 'recall': 0.48563659233515344, 'f1-score': 0.4833589732089495, 'support': 137537}}
[[20288  8643  1451]
 [32553 41140  4464]
 [10591 13042  5365]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0163082
{'0': {'precision': 0.3258426966292135, 'recall': 0.6744925946242457, 'f1-score': 0.43940964156809487, 'support': 9115}, '1': {'precision': 0.6030825496342738, 'recall': 0.5563427800269906, 'f1-score': 0.5787705575611714, 'support': 20748}, '2': {'precision': 0.5969289827255279, 'recall': 0.06770436486339393, 'f1-score': 0.12161501613060907, 'support': 9187}, 'accuracy': 0.4689628681177977, 'macro avg': {'precision': 0.5086180763296717, 'recall': 0.43284657983821, 'f1-score': 0.3799317384199585, 'support': 39050}, 'weighted avg': {'precision': 0.5369218817896702, 'recall': 0.4689628681177977, 'f1-score': 0.4386895663089443, 'support': 39050}}
[[ 6148  2887    80]
 [ 8865 11543   340]
 [ 3855  4710   622]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1273761
{'0': {'precision': 0.3464556616643929, 'recall': 0.4409501319627726, 'f1-score': 0.38803288207071485, 'support': 71990}, '1': {'precision': 0.38591733961083463, 'recall': 0.5715231349705434, 'f1-score': 0.46072981794573054, 'support': 90642}, '2': {'precision': 0.4333829857663026, 'recall': 0.0695364678076826, 'f1-score': 0.1198439305696992, 'support': 75313}, 'accuracy': 0.3731324465737881, 'macro avg': {'precision': 0.3885853290138434, 'recall': 0.3606699115803329, 'f1-score': 0.3228688768620482, 'support': 237945}, 'weighted avg': {'precision': 0.38900180876775076, 'recall': 0.3731324465737881, 'f1-score': 0.33084017433231805, 'support': 237945}}
[[31744 37879  2367]
 [34358 51804  4480]
 [25523 44553  5237]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1190231
{'0': {'precision': 0.38666919144101497, 'recall': 0.504992426350119, 'f1-score': 0.43798007962786706, 'support': 32349}, '1': {'precision': 0.3581302521008403, 'recall': 0.5250400394234322, 'f1-score': 0.42581305889993504, 'support': 32468}, '2': {'precision': 0.4622702984491073, 'recall': 0.10845768101761252, 'f1-score': 0.17569408326522523, 'support': 32704}, 'accuracy': 0.3786876672716646, 'macro avg': {'precision': 0.4023565806636542, 'recall': 0.37949671559705456, 'f1-score': 0.3464957405976758, 'support': 97521}, 'weighted avg': {'precision': 0.40252071389357247, 'recall': 0.3786876672716646, 'f1-score': 0.3459707682586406, 'support': 97521}}
[[16336 14061  1952]
 [13247 17047  2174]
 [12665 16492  3547]]
Evaluating performance on  val set...
114/114 - 1s - 899ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1242753
{'0': {'precision': 0.3781215643160044, 'recall': 0.5038719129342821, 'f1-score': 0.43203230148048455, 'support': 9556}, '1': {'precision': 0.3625747650242096, 'recall': 0.5292589127949278, 'f1-score': 0.430340164800338, 'support': 9621}, '2': {'precision': 0.44149630274032187, 'recall': 0.10252525252525252, 'f1-score': 0.1664070825477498, 'support': 9900}, 'accuracy': 0.37562334491178595, 'macro avg': {'precision': 0.39406421069351194, 'recall': 0.37855202608482075, 'f1-score': 0.34292651627619075, 'support': 29077}, 'weighted avg': {'precision': 0.3945549705963767, 'recall': 0.37562334491178595, 'f1-score': 0.34103358378492576, 'support': 29077}}
[[4815 4145  596]
 [3841 5092  688]
 [4078 4807 1015]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1065/1065 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1475288
{'0': {'precision': 0.3466234039076542, 'recall': 0.34765405506649183, 'f1-score': 0.34713796448901824, 'support': 85424}, '1': {'precision': 0.35191671812154124, 'recall': 0.6401511572980633, 'f1-score': 0.4541622603851711, 'support': 95265}, '2': {'precision': 0.4181373275989915, 'recall': 0.06144977442625809, 'f1-score': 0.10715235814996389, 'support': 91766}, 'accuracy': 0.3535299407241563, 'macro avg': {'precision': 0.372225816542729, 'recall': 0.3497516622636044, 'f1-score': 0.30281752767471776, 'support': 272455}, 'weighted avg': {'precision': 0.3725609506586598, 'recall': 0.3535299407241563, 'f1-score': 0.30372951317499325, 'support': 272455}}
[[29698 52239  3487]
 [29921 60984  4360]
 [26059 60068  5639]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1460751
{'0': {'precision': 0.3800071771408065, 'recall': 0.47667679495836146, 'f1-score': 0.42288780731311615, 'support': 35544}, '1': {'precision': 0.33599752168525404, 'recall': 0.47845778313678206, 'f1-score': 0.3947684505538503, 'support': 34003}, '2': {'precision': 0.39268647413255764, 'recall': 0.11425117122563096, 'f1-score': 0.17700358221535434, 'support': 33085}, 'accuracy': 0.3604333930937719, 'macro avg': {'precision': 0.3695637243195394, 'recall': 0.3564619164402581, 'f1-score': 0.3315532800274403, 'support': 102632}, 'weighted avg': {'precision': 0.3695137075262315, 'recall': 0.3604333930937719, 'f1-score': 0.33430703255237126, 'support': 102632}}
[[16943 15890  2711]
 [14599 16269  3135]
 [13044 16261  3780]]
Evaluating performance on  val set...
123/123 - 1s - 912ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1623353
{'0': {'precision': 0.3451822595243973, 'recall': 0.4213962832747363, 'f1-score': 0.3795006332549304, 'support': 9955}, '1': {'precision': 0.3465404055074653, 'recall': 0.5599887345099512, 'f1-score': 0.42813565404629467, 'support': 10652}, '2': {'precision': 0.4312655086848635, 'recall': 0.08065713755336922, 'f1-score': 0.1358980373758699, 'support': 10774}, 'accuracy': 0.3514547018896785, 'macro avg': {'precision': 0.37432939123890874, 'recall': 0.35401405177935225, 'f1-score': 0.31451144155903166, 'support': 31381}, 'weighted avg': {'precision': 0.37519812573218236, 'recall': 0.3514547018896785, 'f1-score': 0.31237357782229963, 'support': 31381}}
[[4195 5245  515]
 [4056 5965  631]
 [3902 6003  869]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
1646/1646 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1128029
{'0': {'precision': 0.33668555810120987, 'recall': 0.3434048589303138, 'f1-score': 0.34001201513257245, 'support': 121961}, '1': {'precision': 0.4164290573046816, 'recall': 0.6931014254707574, 'f1-score': 0.5202697496031474, 'support': 170470}, '2': {'precision': 0.3903198845072563, 'recall': 0.03986682602014683, 'f1-score': 0.07234447065450832, 'support': 128854}, 'accuracy': 0.39206712795376053, 'macro avg': {'precision': 0.3811448333043826, 'recall': 0.35879103680707275, 'f1-score': 0.3108754117967428, 'support': 421285}, 'weighted avg': {'precision': 0.38535776765991847, 'recall': 0.39206712795376053, 'f1-score': 0.33108338539028975, 'support': 421285}}
[[ 41882  76972   3107]
 [ 47400 118153   4917]
 [ 35113  88604   5137]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.134909
{'0': {'precision': 0.3745422870324069, 'recall': 0.5112515413070283, 'f1-score': 0.4323473824353639, 'support': 45416}, '1': {'precision': 0.3411250606922383, 'recall': 0.4432627309598918, 'f1-score': 0.385544057698338, 'support': 44380}, '2': {'precision': 0.4202423187629694, 'recall': 0.14012141773055978, 'f1-score': 0.21016688147565404, 'support': 44804}, 'accuracy': 0.365297176820208, 'macro avg': {'precision': 0.3786365554958715, 'recall': 0.36487856333249336, 'f1-score': 0.34268610720311865, 'support': 134600}, 'weighted avg': {'precision': 0.378736103649639, 'recall': 0.365297176820208, 'f1-score': 0.3429587738408018, 'support': 134600}}
[[23219 18306  3891]
 [19938 19672  4770]
 [18836 19690  6278]]
Evaluating performance on  val set...
146/146 - 1s - 944ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.131747
{'0': {'precision': 0.36279626005653404, 'recall': 0.5496170633286667, 'f1-score': 0.4370804545008022, 'support': 12143}, '1': {'precision': 0.3625243083871777, 'recall': 0.4594530131976467, 'f1-score': 0.40527367719765767, 'support': 12578}, '2': {'precision': 0.4418604651162791, 'recall': 0.10533819103437352, 'f1-score': 0.1701202353543106, 'support': 12626}, 'accuracy': 0.3690524004605457, 'macro avg': {'precision': 0.38906034451999694, 'recall': 0.371469422520229, 'f1-score': 0.3374914556842568, 'support': 37347}, 'weighted avg': {'precision': 0.38943411704604264, 'recall': 0.3690524004605457, 'f1-score': 0.3361163778182693, 'support': 37347}}
[[6674 4710  759]
 [5878 5779  921]
 [5844 5452 1330]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
5929/5929 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9348739
{'0': {'precision': 0.4010989944285908, 'recall': 0.6821379152957082, 'f1-score': 0.5051615753314029, 'support': 346169}, '1': {'precision': 0.661447767785169, 'recall': 0.5672395800772327, 'f1-score': 0.6107320217697888, 'support': 831772}, '2': {'precision': 0.5351615417447622, 'recall': 0.33964114099967024, 'f1-score': 0.41555171295795956, 'support': 339632}, 'accuracy': 0.5425122877120244, 'macro avg': {'precision': 0.5325694346528407, 'recall': 0.5296728787908703, 'f1-score': 0.5104817700197172, 'support': 1517573}, 'weighted avg': {'precision': 0.5737976066089825, 'recall': 0.5425122877120244, 'f1-score': 0.5429694202240912, 'support': 1517573}}
[[236135  88796  21238]
 [281001 471814  78957]
 [ 71584 152695 115353]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0013034
{'0': {'precision': 0.397591572048014, 'recall': 0.628267135668572, 'f1-score': 0.4869943906653097, 'support': 81876}, '1': {'precision': 0.561978159202762, 'recall': 0.5886196063345516, 'f1-score': 0.5749904488717144, 'support': 155970}, '2': {'precision': 0.5282905225863596, 'recall': 0.17938692524241476, 'f1-score': 0.2678293981876476, 'support': 83122}, 'accuracy': 0.4927531716557414, 'macro avg': {'precision': 0.49595341794571185, 'recall': 0.46542455574851277, 'f1-score': 0.4432714125748906, 'support': 320968}, 'weighted avg': {'precision': 0.5113204614238223, 'recall': 0.4927531716557414, 'f1-score': 0.4729970846837935, 'support': 320968}}
[[51440 26823  3613]
 [54462 91807  9701]
 [23477 44734 14911]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9963772
{'0': {'precision': 0.3790041107577755, 'recall': 0.7154465592972181, 'f1-score': 0.4955128530142473, 'support': 27320}, '1': {'precision': 0.5758071367884452, 'recall': 0.49949330237871503, 'f1-score': 0.5349422316063659, 'support': 54273}, '2': {'precision': 0.5819679893929349, 'recall': 0.22249981895865015, 'f1-score': 0.3219215758179009, 'support': 27618}, 'accuracy': 0.4834677825493769, 'macro avg': {'precision': 0.5122597456463852, 'recall': 0.47914656021152774, 'f1-score': 0.4507922201461713, 'support': 109211}, 'weighted avg': {'precision': 0.5281332921763905, 'recall': 0.4834677825493769, 'f1-score': 0.4712085866923691, 'support': 109211}}
[[19546  6701  1073]
 [23823 27109  3341]
 [ 8203 13270  6145]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
5331/5331 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0010195
{'0': {'precision': 0.3326200090561169, 'recall': 0.5369792414223581, 'f1-score': 0.41078701493032765, 'support': 299587}, '1': {'precision': 0.6149572035645932, 'recall': 0.697719415854989, 'f1-score': 0.6537292955467183, 'support': 760770}, '2': {'precision': 0.4053598516770605, 'recall': 0.023714128887851727, 'f1-score': 0.04480698529411765, 'support': 304249}, 'accuracy': 0.5121558896853744, 'macro avg': {'precision': 0.45097902143259017, 'recall': 0.4194709287217329, 'f1-score': 0.3697744319237213, 'support': 1364606}, 'weighted avg': {'precision': 0.5062413267432683, 'recall': 0.5121558896853744, 'f1-score': 0.46462976572267667, 'support': 1364606}}
[[160872 135289   3426]
 [222808 530804   7158]
 [ 99971 197063   7215]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0087237
{'0': {'precision': 0.3864637796590573, 'recall': 0.4620837429343819, 'f1-score': 0.42090425122597885, 'support': 130208}, '1': {'precision': 0.5533747545850692, 'recall': 0.7174709360982197, 'f1-score': 0.6248284997871033, 'support': 257708}, '2': {'precision': 0.5020393756373049, 'recall': 0.10048196175704104, 'f1-score': 0.1674493439899538, 'support': 127396}, 'accuracy': 0.5004075201043251, 'macro avg': {'precision': 0.48062596996047713, 'recall': 0.4266788802632142, 'f1-score': 0.4043940316676786, 'support': 515312}, 'weighted avg': {'precision': 0.4985088361519733, 'recall': 0.5004075201043251, 'f1-score': 0.46022755222799244, 'support': 515312}}
[[ 60167  65591   4450]
 [ 64563 184898   8247]
 [ 30956  83639  12801]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9960583
{'0': {'precision': 0.37292805337543, 'recall': 0.5844965221044769, 'f1-score': 0.4553364427351826, 'support': 42842}, '1': {'precision': 0.5914979443022264, 'recall': 0.6559421910619812, 'f1-score': 0.6220554343170647, 'support': 92996}, '2': {'precision': 0.5215573556310426, 'recall': 0.09484212777078235, 'f1-score': 0.16049854256709215, 'support': 42091}, 'accuracy': 0.5060052043230727, 'macro avg': {'precision': 0.49532778443623293, 'recall': 0.4450936136457468, 'f1-score': 0.41263013987311314, 'support': 177929}, 'weighted avg': {'precision': 0.5223251810941792, 'recall': 0.5060052043230727, 'f1-score': 0.4727263976338984, 'support': 177929}}
[[25041 16687  1114]
 [29448 61000  2548]
 [12658 25441  3992]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
4192/4192 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0901791
{'0': {'precision': 0.39694266455224303, 'recall': 0.323410147059277, 'f1-score': 0.35642336212931686, 'support': 324291}, '1': {'precision': 0.4114847505069543, 'recall': 0.7615753487789487, 'f1-score': 0.5342891512128314, 'support': 423119}, '2': {'precision': 0.4276863504356244, 'recall': 0.03390741081844416, 'f1-score': 0.06283333096297981, 'support': 325740}, 'accuracy': 0.40829427386665423, 'macro avg': {'precision': 0.41203792183160726, 'recall': 0.37296430221888993, 'f1-score': 0.31784861476837606, 'support': 1073150}, 'weighted avg': {'precision': 0.4120081084386747, 'recall': 0.40829427386665423, 'f1-score': 0.3374366203496076, 'support': 1073150}}
[[104879 212879   6533]
 [ 92635 322237   8247]
 [ 66703 247992  11045]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0991175
{'0': {'precision': 0.4070557892076494, 'recall': 0.591853464115103, 'f1-score': 0.4823608914008386, 'support': 106131}, '1': {'precision': 0.3709423143198633, 'recall': 0.48697560693864195, 'f1-score': 0.42111221639980184, 'support': 103882}, '2': {'precision': 0.5081689208752119, 'recall': 0.1171724493104698, 'f1-score': 0.19043485673985322, 'support': 104854}, 'accuracy': 0.3991780656594689, 'macro avg': {'precision': 0.4287223414675749, 'recall': 0.39866717345473823, 'f1-score': 0.36463598818016457, 'support': 314867}, 'weighted avg': {'precision': 0.42881283681688637, 'recall': 0.3991780656594689, 'f1-score': 0.36493909967671173, 'support': 314867}}
[[62814 37903  5414]
 [46817 50588  6477]
 [44682 47886 12286]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1019702
{'0': {'precision': 0.40541975445194117, 'recall': 0.5352511682242991, 'f1-score': 0.46137579457486316, 'support': 34240}, '1': {'precision': 0.37436723423838014, 'recall': 0.5763542435424355, 'f1-score': 0.45390400688156046, 'support': 33875}, '2': {'precision': 0.5220949263502455, 'recall': 0.07477292704365661, 'f1-score': 0.1308114203700856, 'support': 34130}, 'accuracy': 0.3951586874663798, 'macro avg': {'precision': 0.43396063834685555, 'recall': 0.39545944627013035, 'f1-score': 0.34869707394216976, 'support': 102245}, 'weighted avg': {'precision': 0.4340785592311944, 'recall': 0.3951586874663798, 'f1-score': 0.3485559119427571, 'support': 102245}}
[[18327 14738  1175]
 [13190 19524  1161]
 [13688 17890  2552]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
6143/6143 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0688895
{'0': {'precision': 0.41471939976189814, 'recall': 0.5032779380698593, 'f1-score': 0.45472707989048666, 'support': 476214}, '1': {'precision': 0.43093771948099924, 'recall': 0.6485762219858867, 'f1-score': 0.5178181536635095, 'support': 618706}, '2': {'precision': 0.5452352421796165, 'recall': 0.07240850785833637, 'f1-score': 0.1278396173055382, 'support': 477582}, 'accuracy': 0.4295873709540592, 'macro avg': {'precision': 0.463630787140838, 'recall': 0.4080875559713608, 'f1-score': 0.3667949502865115, 'support': 1572502}, 'weighted avg': {'precision': 0.46073930229535437, 'recall': 0.4295873709540592, 'f1-score': 0.3802720125732858, 'support': 1572502}}
[[239668 225405  11141]
 [199726 401278  17702]
 [138510 304491  34581]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820448
{'0': {'precision': 0.41954549581899075, 'recall': 0.5721377633437836, 'f1-score': 0.48410179234342887, 'support': 177667}, '1': {'precision': 0.38785599541735677, 'recall': 0.5246761414364889, 'f1-score': 0.4460090311124688, 'support': 178087}, '2': {'precision': 0.5161928751349406, 'recall': 0.14550075226948717, 'f1-score': 0.22701277007275206, 'support': 177463}, 'accuracy': 0.41429474304082575, 'macro avg': {'precision': 0.4411981221237627, 'recall': 0.4141048856832532, 'f1-score': 0.3857078645095499, 'support': 533217}, 'weighted avg': {'precision': 0.44112741428280683, 'recall': 0.41429474304082575, 'f1-score': 0.38581607615553704, 'support': 533217}}
[[101650  64612  11405]
 [ 71853  93438  12796]
 [ 68783  82859  25821]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0948994
{'0': {'precision': 0.4090699484105254, 'recall': 0.4948142725165159, 'f1-score': 0.44787516862175875, 'support': 57369}, '1': {'precision': 0.37174650275540483, 'recall': 0.5853357362167935, 'f1-score': 0.45470807839883853, 'support': 59928}, '2': {'precision': 0.49908047990191784, 'recall': 0.09846914092197111, 'f1-score': 0.16448517209033842, 'support': 57876}, 'accuracy': 0.3948325369777306, 'macro avg': {'precision': 0.42663231035594934, 'recall': 0.3928730498850935, 'f1-score': 0.35568947303697857, 'support': 175173}, 'weighted avg': {'precision': 0.4260402010714706, 'recall': 0.3948325369777306, 'f1-score': 0.35658257888400435, 'support': 175173}}
[[28387 26216  2766]
 [21896 35078  2954]
 [19111 33066  5699]]
testing model on single stock: results/universal/W7/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
23942/23942 - 123s - 123s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079427
{'0': {'precision': 0.2895102393484667, 'recall': 0.24862929020397748, 'f1-score': 0.26751695931297703, 'support': 1614492}, '1': {'precision': 0.47513377996124184, 'recall': 0.7740882214142879, 'f1-score': 0.5888392331532144, 'support': 2900951}, '2': {'precision': 0.3160120105398615, 'recall': 0.0031959177526817016, 'f1-score': 0.00632784028859958, 'support': 1613621}, 'accuracy': 0.43271843792135306, 'macro avg': {'precision': 0.3602186766165234, 'recall': 0.341971143123649, 'f1-score': 0.287561344251597, 'support': 6129064}, 'weighted avg': {'precision': 0.3843450477785631, 'recall': 0.43271843792135306, 'f1-score': 0.35083798911293923, 'support': 6129064}}
[[ 401410 1210081    3001]
 [ 647198 2245592    8161]
 [ 337906 1270558    5157]]
Evaluating performance on  train set...
9052/9052 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1416934
{'0': {'precision': 0.36700327991614845, 'recall': 0.3828681122698094, 'f1-score': 0.37476787204459366, 'support': 778268}, '1': {'precision': 0.34927589873349574, 'recall': 0.6731458616503595, 'f1-score': 0.45991514444761483, 'support': 771032}, '2': {'precision': 0.4259211006305696, 'recall': 0.010644976425538565, 'f1-score': 0.020770830871355794, 'support': 767780}, 'accuracy': 0.35612236090251526, 'macro avg': {'precision': 0.3807334264267379, 'recall': 0.3555529834485691, 'f1-score': 0.2851512824545214, 'support': 2317080}, 'weighted avg': {'precision': 0.3806271281303211, 'recall': 0.35612236090251526, 'f1-score': 0.285802201227642, 'support': 2317080}}
[[297974 475070   5224]
 [246223 519017   5792]
 [267714 491893   8173]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1437778
{'0': {'precision': 0.34019833374782393, 'recall': 0.19387126919380485, 'f1-score': 0.24698909047821907, 'support': 225789}, '1': {'precision': 0.3566832336077522, 'recall': 0.8169431703458747, 'f1-score': 0.4965633538767059, 'support': 251594}, '2': {'precision': 0.37620041753653444, 'recall': 0.00391854983212428, 'f1-score': 0.007756308995510637, 'support': 229932}, 'accuracy': 0.3537504506478726, 'macro avg': {'precision': 0.3576939949640369, 'recall': 0.3382443297906013, 'f1-score': 0.25043625111681184, 'support': 707315}, 'weighted avg': {'precision': 0.35776551813535223, 'recall': 0.3537504506478726, 'f1-score': 0.2579942512815341, 'support': 707315}}
[[ 43774 181349    666]
 [ 45228 205538    828]
 [ 39670 189361    901]]
training model: results/universal/W7/deepLOB_L1/h100
Epoch 1/50
12475/12475 - 192s - loss: 3.2524 - accuracy100: 0.3871 - val_loss: 3.3904 - val_accuracy100: 0.3359 - 192s/epoch - 15ms/step
Epoch 2/50
12475/12475 - 187s - loss: 3.2392 - accuracy100: 0.3959 - val_loss: 3.5582 - val_accuracy100: 0.3369 - 187s/epoch - 15ms/step
Epoch 3/50
12475/12475 - 188s - loss: 3.2318 - accuracy100: 0.4007 - val_loss: 3.6669 - val_accuracy100: 0.3365 - 188s/epoch - 15ms/step
Epoch 4/50
12475/12475 - 192s - loss: 3.2258 - accuracy100: 0.4041 - val_loss: 3.7716 - val_accuracy100: 0.3374 - 192s/epoch - 15ms/step
Epoch 5/50
12475/12475 - 190s - loss: 3.2241 - accuracy100: 0.4049 - val_loss: 3.7286 - val_accuracy100: 0.3369 - 190s/epoch - 15ms/step
Epoch 6/50
12475/12475 - 192s - loss: 3.2198 - accuracy100: 0.4073 - val_loss: 3.7756 - val_accuracy100: 0.3379 - 192s/epoch - 15ms/step
Epoch 7/50
12475/12475 - 189s - loss: 3.2167 - accuracy100: 0.4088 - val_loss: 3.8168 - val_accuracy100: 0.3374 - 189s/epoch - 15ms/step
Epoch 8/50
12475/12475 - 185s - loss: 3.2138 - accuracy100: 0.4105 - val_loss: 3.8604 - val_accuracy100: 0.3367 - 185s/epoch - 15ms/step
Epoch 9/50
12475/12475 - 187s - loss: 3.2105 - accuracy100: 0.4121 - val_loss: 3.7272 - val_accuracy100: 0.3377 - 187s/epoch - 15ms/step
Epoch 10/50
12475/12475 - 186s - loss: 3.2079 - accuracy100: 0.4135 - val_loss: 3.7634 - val_accuracy100: 0.3355 - 186s/epoch - 15ms/step
Epoch 11/50
12475/12475 - 188s - loss: 3.2055 - accuracy100: 0.4145 - val_loss: 3.6788 - val_accuracy100: 0.3371 - 188s/epoch - 15ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 183s - 183s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.103184
{'0': {'precision': 0.3280781041620453, 'recall': 0.1306707258656845, 'f1-score': 0.18690054864619818, 'support': 2818290}, '1': {'precision': 0.4101654436891095, 'recall': 0.735950680706315, 'f1-score': 0.5267555896998475, 'support': 3877590}, '2': {'precision': 0.3169028014910234, 'recall': 0.1607920014008653, 'f1-score': 0.21333887407946092, 'support': 2809692}, 'accuracy': 0.3864847901841152, 'macro avg': {'precision': 0.35171544978072605, 'recall': 0.3424711359909549, 'f1-score': 0.30899833747516886, 'support': 9505572}, 'weighted avg': {'precision': 0.3582606001090961, 'recall': 0.3864847901841152, 'f1-score': 0.3333517101441548, 'support': 9505572}}
[[ 368268 2040908  409114]
 [ 459167 2853715  564708]
 [ 295066 2062850  451776]]
Evaluating performance on  train set...
12475/12475 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1294876
{'0': {'precision': 0.3469829681547803, 'recall': 0.07336401224041673, 'f1-score': 0.12111928435403742, 'support': 1070225}, '1': {'precision': 0.3332870681632869, 'recall': 0.8092081857632452, 'f1-score': 0.4721220903804425, 'support': 1065313}, '2': {'precision': 0.32882505003116264, 'recall': 0.11823599162589618, 'f1-score': 0.1739313079831883, 'support': 1057546}, 'accuracy': 0.3337262658921594, 'macro avg': {'precision': 0.3363650287830766, 'recall': 0.3336027298765194, 'f1-score': 0.25572422757255603, 'support': 3193084}, 'weighted avg': {'precision': 0.3363997032022776, 'recall': 0.3337262658921594, 'f1-score': 0.2557161182103725, 'support': 3193084}}
[[ 78516 864973 126736]
 [ 74766 862060 128487]
 [ 73000 859506 125040]]
Evaluating performance on  val set...
3866/3866 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1307173
{'0': {'precision': 0.33406060211342137, 'recall': 0.06335301310475155, 'f1-score': 0.10650740132219307, 'support': 323852}, '1': {'precision': 0.3365108001671118, 'recall': 0.8069356823316697, 'f1-score': 0.4749545803865182, 'support': 332397}, '2': {'precision': 0.3331701271478189, 'recall': 0.13079924193504788, 'f1-score': 0.1878503322427518, 'support': 332953}, 'accuracy': 0.3359172342959274, 'macro avg': {'precision': 0.3345805098094507, 'recall': 0.33369597912382304, 'f1-score': 0.25643743798382107, 'support': 989202}, 'weighted avg': {'precision': 0.3345842081829909, 'recall': 0.3359172342959274, 'f1-score': 0.2576940243357305, 'support': 989202}}
[[ 20517 260147  43188]
 [ 20198 268223  43976]
 [ 20702 268701  43550]]
testing model out of sample: results/universal/W7/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 76s - 76s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1013136
{'0': {'precision': 0.30576054487577536, 'recall': 0.08585647699918968, 'f1-score': 0.13406732456470322, 'support': 1089679}, '1': {'precision': 0.41560666473097924, 'recall': 0.7907953380048883, 'f1-score': 0.544859528030768, 'support': 1562078}, '2': {'precision': 0.29560661316302483, 'recall': 0.13063015309508644, 'f1-score': 0.18119101959412956, 'support': 1122505}, 'accuracy': 0.3909302003941433, 'macro avg': {'precision': 0.3389912742565932, 'recall': 0.3357606560330548, 'f1-score': 0.2867059573965336, 'support': 3774262}, 'weighted avg': {'precision': 0.34820337690332304, 'recall': 0.3909302003941433, 'f1-score': 0.3180996060795715, 'support': 3774262}}
[[  93556  852287  143836]
 [ 121222 1235284  205572]
 [  91200  884672  146633]]
Evaluating performance on  train set...
5285/5285 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1213235
{'0': {'precision': 0.35082250929351616, 'recall': 0.17775620319085159, 'f1-score': 0.23595682449185634, 'support': 447028}, '1': {'precision': 0.3467154392409899, 'recall': 0.7148766929364949, 'f1-score': 0.46695671356611795, 'support': 463396}, '2': {'precision': 0.33885018952598, 'recall': 0.13078951295955424, 'f1-score': 0.18873213239768905, 'support': 442222}, 'accuracy': 0.3464106647267652, 'macro avg': {'precision': 0.34546271268682877, 'recall': 0.34114080302896693, 'f1-score': 0.2972152234852211, 'support': 1352646}, 'weighted avg': {'precision': 0.34550136612205823, 'recall': 0.3464106647267652, 'f1-score': 0.29965466325394907, 'support': 1352646}}
[[ 79462 311625  55941]
 [ 75215 331271  56910]
 [ 71825 312559  57838]]
Evaluating performance on  val set...
1714/1714 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1181039
{'0': {'precision': 0.3505883115620239, 'recall': 0.0773062875685257, 'f1-score': 0.12667923776952716, 'support': 139911}, '1': {'precision': 0.36186402394262807, 'recall': 0.8214388719756449, 'f1-score': 0.5024058956693879, 'support': 156025}, '2': {'precision': 0.32545327622964737, 'recall': 0.12139509352700249, 'f1-score': 0.1768314872809468, 'support': 142098}, 'accuracy': 0.3566640945680016, 'macro avg': {'precision': 0.34596853724476645, 'recall': 0.3400467510237244, 'f1-score': 0.26863887357328725, 'support': 438034}, 'weighted avg': {'precision': 0.34645085824452737, 'recall': 0.3566640945680016, 'f1-score': 0.27678011155991666, 'support': 438034}}
[[ 10816 111775  17320]
 [  9427 128165  18433]
 [ 10608 114240  17250]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1075993
{'0': {'precision': 0.2971438553585466, 'recall': 0.0641378530221334, 'f1-score': 0.10550309345490068, 'support': 53042}, '1': {'precision': 0.4010873550898372, 'recall': 0.7970711883408071, 'f1-score': 0.5336441934212749, 'support': 71360}, '2': {'precision': 0.3011393585532985, 'recall': 0.1387653675124248, 'f1-score': 0.18998529129628447, 'support': 53522}, 'accuracy': 0.3805445021469841, 'macro avg': {'precision': 0.33312352300056075, 'recall': 0.33332480295845507, 'f1-score': 0.2763775260574867, 'support': 177924}, 'weighted avg': {'precision': 0.34003438987224016, 'recall': 0.3805445021469841, 'f1-score': 0.302631109273267, 'support': 177924}}
[[ 3402 42263  7377]
 [ 4622 56879  9859]
 [ 3425 42670  7427]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1285868
{'0': {'precision': 0.3399201321949876, 'recall': 0.20051173747055479, 'f1-score': 0.2522352219894753, 'support': 24622}, '1': {'precision': 0.33117626168961845, 'recall': 0.7037860047796738, 'f1-score': 0.4504071803265493, 'support': 23851}, '2': {'precision': 0.3269967580312408, 'recall': 0.09433320579858011, 'f1-score': 0.1464251542446138, 'support': 23523}, 'accuracy': 0.3325462525695872, 'macro avg': {'precision': 0.3326977173052823, 'recall': 0.3328769826829362, 'f1-score': 0.2830225188535461, 'support': 71996}, 'weighted avg': {'precision': 0.3328010341079081, 'recall': 0.3325462525695872, 'f1-score': 0.28331513135576203, 'support': 71996}}
[[ 4937 17398  2287]
 [ 4785 16786  2280]
 [ 4802 16502  2219]]
Evaluating performance on  val set...
73/73 - 1s - 677ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1485893
{'0': {'precision': 0.35581622678396874, 'recall': 0.055538602380225816, 'f1-score': 0.09608024284017422, 'support': 6554}, '1': {'precision': 0.2808569182389937, 'recall': 0.8284057971014492, 'f1-score': 0.41949214736533097, 'support': 5175}, '2': {'precision': 0.3565961278703287, 'recall': 0.11683139106062841, 'f1-score': 0.176, 'support': 6779}, 'accuracy': 0.2940890425761833, 'macro avg': {'precision': 0.33108975763109705, 'recall': 0.33359193018076777, 'f1-score': 0.2305241300685017, 'support': 18508}, 'weighted avg': {'precision': 0.33514260066251794, 'recall': 0.2940890425761833, 'f1-score': 0.21578159575265232, 'support': 18508}}
[[ 364 5356  834]
 [ 293 4287  595]
 [ 366 5621  792]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
2006/2006 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1046592
{'0': {'precision': 0.30116571428571426, 'recall': 0.042684151532625385, 'f1-score': 0.07477102225652316, 'support': 154343}, '1': {'precision': 0.4122563515274561, 'recall': 0.8408277940180132, 'f1-score': 0.5532535063299425, 'support': 211067}, '2': {'precision': 0.2821808161658575, 'recall': 0.11630611141157382, 'f1-score': 0.16471984987170157, 'support': 147920}, 'accuracy': 0.39207332515146204, 'macro avg': {'precision': 0.3318676273263426, 'recall': 0.3332726856540708, 'f1-score': 0.26424812615272236, 'support': 513330}, 'weighted avg': {'precision': 0.34137244562971036, 'recall': 0.39207332515146204, 'f1-score': 0.2974291428548938, 'support': 513330}}
[[  6588 128761  18994]
 [  8826 177471  24770]
 [  6461 124255  17204]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1009331
{'0': {'precision': 0.3337747134834026, 'recall': 0.17567470140107183, 'f1-score': 0.2301927194860814, 'support': 41611}, '1': {'precision': 0.42409671513646596, 'recall': 0.7097302436962952, 'f1-score': 0.5309351001751913, 'support': 56792}, '2': {'precision': 0.31785957074876175, 'recall': 0.16727142638115194, 'f1-score': 0.21919367800696493, 'support': 39134}, 'accuracy': 0.3938067574543577, 'macro avg': {'precision': 0.35857699978954344, 'recall': 0.350892123826173, 'f1-score': 0.3267738325560792, 'support': 137537}, 'weighted avg': {'precision': 0.3665422154799805, 'recall': 0.3938067574543577, 'f1-score': 0.351246143618149, 'support': 137537}}
[[ 7310 28019  6282]
 [ 8719 40307  7766]
 [ 5872 26716  6546]]
Evaluating performance on  val set...
153/153 - 1s - 982ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1179813
{'0': {'precision': 0.3058461538461538, 'recall': 0.041081170441395275, 'f1-score': 0.0724331414413758, 'support': 12098}, '1': {'precision': 0.37629784358296986, 'recall': 0.8341845420497106, 'f1-score': 0.5186392599335294, 'support': 14685}, '2': {'precision': 0.29419010470129336, 'recall': 0.11681747778592973, 'f1-score': 0.16723071536935466, 'support': 12267}, 'accuracy': 0.3631241997439181, 'macro avg': {'precision': 0.32544470071013903, 'recall': 0.33069439675901185, 'f1-score': 0.25276770558142, 'support': 39050}, 'weighted avg': {'precision': 0.32867837686600376, 'recall': 0.3631241997439181, 'f1-score': 0.2700110848327149, 'support': 39050}}
[[  497  9965  1636]
 [  633 12250  1802]
 [  495 10339  1433]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1352812
{'0': {'precision': 0.33641491695393294, 'recall': 0.05441366550928859, 'f1-score': 0.09367569100547568, 'support': 78914}, '1': {'precision': 0.33065723578914763, 'recall': 0.816317426328133, 'f1-score': 0.47066648049208876, 'support': 78456}, '2': {'precision': 0.33644533358737416, 'recall': 0.13149239838659635, 'f1-score': 0.1890850034800921, 'support': 80575}, 'accuracy': 0.3317321229695938, 'macro avg': {'precision': 0.33450582877681817, 'recall': 0.3340744967413393, 'f1-score': 0.25114239165921887, 'support': 237945}, 'weighted avg': {'precision': 0.3345267755211444, 'recall': 0.3317321229695938, 'f1-score': 0.25028665039778875, 'support': 237945}}
[[ 4294 64004 10616]
 [ 4131 64045 10280]
 [ 4339 65641 10595]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1259562
{'0': {'precision': 0.3732513777024163, 'recall': 0.10855293573740175, 'f1-score': 0.1681908263890547, 'support': 32445}, '1': {'precision': 0.3381185489312221, 'recall': 0.7303029363430591, 'f1-score': 0.4622313806299676, 'support': 32251}, '2': {'precision': 0.334852925214371, 'recall': 0.18796648895658796, 'f1-score': 0.24077578974068795, 'support': 32825}, 'accuracy': 0.3409009341577712, 'macro avg': {'precision': 0.34874095061600313, 'recall': 0.34227412034568294, 'f1-score': 0.2903993322532367, 'support': 97521}, 'weighted avg': {'precision': 0.34870796588732134, 'recall': 0.3409009341577712, 'f1-score': 0.2898641412324325, 'support': 97521}}
[[ 3522 22653  6270]
 [ 2712 23553  5986]
 [ 3202 23453  6170]]
Evaluating performance on  val set...
114/114 - 1s - 796ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1386678
{'0': {'precision': 0.3344968004653869, 'recall': 0.059573145462080396, 'f1-score': 0.10113446486676633, 'support': 9652}, '1': {'precision': 0.31738738351870144, 'recall': 0.7958436524173575, 'f1-score': 0.45379750721434275, 'support': 9287}, '2': {'precision': 0.3352984524686809, 'recall': 0.13464194121128428, 'f1-score': 0.192131747483989, 'support': 10138}, 'accuracy': 0.32090655844825805, 'macro avg': {'precision': 0.3290608788175897, 'recall': 0.3300195796969074, 'f1-score': 0.2490212398550327, 'support': 29077}, 'weighted avg': {'precision': 0.3293116710787764, 'recall': 0.32090655844825805, 'f1-score': 0.24549984387613272, 'support': 29077}}
[[ 575 7727 1350]
 [ 540 7391 1356]
 [ 604 8169 1365]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.126011
{'0': {'precision': 0.3040908383885519, 'recall': 0.11524540492106722, 'f1-score': 0.1671454464621593, 'support': 84819}, '1': {'precision': 0.3438868322104836, 'recall': 0.7576128620102215, 'f1-score': 0.4730515832651894, 'support': 93920}, '2': {'precision': 0.3431249251407354, 'recall': 0.12227367792052585, 'f1-score': 0.18029769022594247, 'support': 93716}, 'accuracy': 0.3390981997027032, 'macro avg': {'precision': 0.3303675319132569, 'recall': 0.3317106482839382, 'f1-score': 0.2734982399844304, 'support': 272455}, 'weighted avg': {'precision': 0.33123571814419395, 'recall': 0.3390981997027032, 'f1-score': 0.2771205984876582, 'support': 272455}}
[[ 9775 64518 10526]
 [11354 71155 11411]
 [11016 71241 11459]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1305561
{'0': {'precision': 0.3535687453042825, 'recall': 0.13203153494374772, 'f1-score': 0.1922660511102486, 'support': 35643}, '1': {'precision': 0.3320246490057811, 'recall': 0.7736854571293226, 'f1-score': 0.46464736266569473, 'support': 33776}, '2': {'precision': 0.3230667796929453, 'recall': 0.10327281486165056, 'f1-score': 0.1565138033310518, 'support': 33213}, 'accuracy': 0.33389196352014966, 'macro avg': {'precision': 0.3362200580010029, 'recall': 0.336329935644907, 'f1-score': 0.2711424057023317, 'support': 102632}, 'weighted avg': {'precision': 0.336607805437306, 'recall': 0.33389196352014966, 'f1-score': 0.27033635835951086, 'support': 102632}}
[[ 4706 27192  3745]
 [ 4202 26132  3442]
 [ 4402 25381  3430]]
Evaluating performance on  val set...
123/123 - 1s - 815ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1289684
{'0': {'precision': 0.29876252209781967, 'recall': 0.052, 'f1-score': 0.08858216126496025, 'support': 9750}, '1': {'precision': 0.3367696257683031, 'recall': 0.8153136183838764, 'f1-score': 0.47665455346327495, 'support': 10618}, '2': {'precision': 0.345148315736551, 'recall': 0.12467084354853356, 'f1-score': 0.18317657261023282, 'support': 11013}, 'accuracy': 0.33577642522545487, 'macro avg': {'precision': 0.32689348786755795, 'recall': 0.3306614873108033, 'f1-score': 0.24947109577948934, 'support': 31381}, 'weighted avg': {'precision': 0.3279013695570001, 'recall': 0.33577642522545487, 'f1-score': 0.2530868269068198, 'support': 31381}}
[[ 507 7989 1254]
 [ 610 8657 1351]
 [ 580 9060 1373]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
1646/1646 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.088469
{'0': {'precision': 0.26362222945366454, 'recall': 0.06585138955373514, 'f1-score': 0.10537954558593976, 'support': 110719}, '1': {'precision': 0.44849012017289697, 'recall': 0.7993280423280423, 'f1-score': 0.5745880938978564, 'support': 189000}, '2': {'precision': 0.28874603733709053, 'recall': 0.13486501159863779, 'f1-score': 0.18385609994056498, 'support': 121566}, 'accuracy': 0.41482369417377785, 'macro avg': {'precision': 0.33361946232121736, 'recall': 0.33334814782680505, 'f1-score': 0.287941246474787, 'support': 421285}, 'weighted avg': {'precision': 0.353808759178415, 'recall': 0.41482369417377785, 'f1-score': 0.33852455772173046, 'support': 421285}}
[[  7291  88529  14899]
 [ 12441 151073  25486]
 [  7925  97246  16395]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1206032
{'0': {'precision': 0.36214906881626496, 'recall': 0.20324025583312905, 'f1-score': 0.2603631380609798, 'support': 44873}, '1': {'precision': 0.34444432431263583, 'recall': 0.7102599545191064, 'f1-score': 0.4639120463067458, 'support': 44854}, '2': {'precision': 0.3401866950254047, 'recall': 0.12831769661043388, 'f1-score': 0.18634605737956925, 'support': 44873}, 'accuracy': 0.34722139673105495, 'macro avg': {'precision': 0.34892669605143517, 'recall': 0.34727263565422306, 'f1-score': 0.303540413915765, 'support': 134600}, 'weighted avg': {'precision': 0.34892732877850086, 'recall': 0.34722139673105495, 'f1-score': 0.30351777601817637, 'support': 134600}}
[[ 9120 30092  5661]
 [ 7489 31858  5507]
 [ 8574 30541  5758]]
Evaluating performance on  val set...
146/146 - 1s - 940ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1352464
{'0': {'precision': 0.32111801242236027, 'recall': 0.042207527145073066, 'f1-score': 0.07460855761598961, 'support': 12249}, '1': {'precision': 0.3301654232890042, 'recall': 0.8296519683755808, 'f1-score': 0.4723543469686071, 'support': 12269}, '2': {'precision': 0.3468514367230487, 'recall': 0.1326681736690311, 'f1-score': 0.19192602616147947, 'support': 12829}, 'accuracy': 0.3319677618014834, 'macro avg': {'precision': 0.33271162414480443, 'recall': 0.33484255639656163, 'f1-score': 0.24629631024869206, 'support': 37347}, 'weighted avg': {'precision': 0.33292985230980465, 'recall': 0.3319677618014834, 'f1-score': 0.24557299635370222, 'support': 37347}}
[[  517 10068  1664]
 [  549 10179  1541]
 [  544 10583  1702]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
5929/5929 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0935313
{'0': {'precision': 0.35293093784581775, 'recall': 0.477007214988529, 'f1-score': 0.40569433558436596, 'support': 463341}, '1': {'precision': 0.41768288577046353, 'recall': 0.40789596981677995, 'f1-score': 0.41273141775421957, 'support': 608285}, '2': {'precision': 0.403598288643427, 'recall': 0.26907457612675945, 'f1-score': 0.32288514708949145, 'support': 445947}, 'accuracy': 0.3882034010884485, 'macro avg': {'precision': 0.39140403741990276, 'recall': 0.38465925364402276, 'f1-score': 0.38043696680935896, 'support': 1517573}, 'weighted avg': {'precision': 0.39377417354484806, 'recall': 0.3882034010884485, 'f1-score': 0.3841810656105101, 'support': 1517573}}
[[221017 167325  74999]
 [257852 248117 102316]
 [147364 178590 119993]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1279728
{'0': {'precision': 0.3466263466263466, 'recall': 0.12205858583937858, 'f1-score': 0.18054227372447543, 'support': 105179}, '1': {'precision': 0.33375259190201406, 'recall': 0.7726477756898059, 'f1-score': 0.46614806957283095, 'support': 107494}, '2': {'precision': 0.3321645428889079, 'recall': 0.10759499515213075, 'f1-score': 0.1625399305313376, 'support': 108295}, 'accuracy': 0.33506455472196606, 'macro avg': {'precision': 0.3375144938057562, 'recall': 0.3341004522271051, 'f1-score': 0.269743424609548, 'support': 320968}, 'weighted avg': {'precision': 0.337435422839292, 'recall': 0.33506455472196606, 'f1-score': 0.2701192585417228, 'support': 320968}}
[[12838 80784 11557]
 [12569 83055 11870]
 [11630 85013 11652]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1218758
{'0': {'precision': 0.37156430268069224, 'recall': 0.09245968082411551, 'f1-score': 0.14807302231237324, 'support': 35529}, '1': {'precision': 0.35029765901257776, 'recall': 0.8335729882302817, 'f1-score': 0.49329488331048393, 'support': 37554}, '2': {'precision': 0.3191895329820098, 'recall': 0.09723759964570416, 'f1-score': 0.14906436966945305, 'support': 36128}, 'accuracy': 0.34888426989955224, 'macro avg': {'precision': 0.34701716489175993, 'recall': 0.34109008956670045, 'f1-score': 0.2634774250974367, 'support': 109211}, 'weighted avg': {'precision': 0.34692536323332546, 'recall': 0.34888426989955224, 'f1-score': 0.2671111884791479, 'support': 109211}}
[[ 3285 28631  3613]
 [ 2370 31304  3880]
 [ 3186 29429  3513]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
5331/5331 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968767
{'0': {'precision': 0.2891053300218603, 'recall': 0.06542431266916174, 'f1-score': 0.10670203688528052, 'support': 386095}, '1': {'precision': 0.4293856964563723, 'recall': 0.7990450015648702, 'f1-score': 0.5585964190728518, 'support': 584713}, '2': {'precision': 0.28748169335779505, 'recall': 0.13807586630709145, 'f1-score': 0.18655189154231075, 'support': 393798}, 'accuracy': 0.40073545037908376, 'macro avg': {'precision': 0.3353242399453425, 'recall': 0.3341817268470411, 'f1-score': 0.283950115833481, 'support': 1364606}, 'weighted avg': {'precision': 0.34874479300823674, 'recall': 0.40073545037908376, 'f1-score': 0.3233750054610237, 'support': 1364606}}
[[ 25260 306377  54458]
 [ 37194 467212  80307]
 [ 24919 314505  54374]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1170582
{'0': {'precision': 0.33606686023699284, 'recall': 0.20654605084674235, 'f1-score': 0.2558482534585441, 'support': 165871}, '1': {'precision': 0.36663218730032293, 'recall': 0.6821865370056407, 'f1-score': 0.4769395061567334, 'support': 187566}, '2': {'precision': 0.33695837929373745, 'recall': 0.1339861003861004, 'f1-score': 0.19173274635125218, 'support': 161875}, 'accuracy': 0.35687893936100845, 'macro avg': {'precision': 0.3465524756103511, 'recall': 0.34090622941282783, 'f1-score': 0.30817350198884325, 'support': 515312}, 'weighted avg': {'precision': 0.3474722433510502, 'recall': 0.35687893936100845, 'f1-score': 0.3161816130360344, 'support': 515312}}
[[ 34260 111128  20483]
 [ 37416 127955  22195]
 [ 30268 109918  21689]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1109178
{'0': {'precision': 0.33084608574680663, 'recall': 0.04767111305488738, 'f1-score': 0.08333466065654714, 'support': 54876}, '1': {'precision': 0.38728584909421976, 'recall': 0.8464979810010749, 'f1-score': 0.5314329485145265, 'support': 68846}, '2': {'precision': 0.2980966025378633, 'recall': 0.10747689412806465, 'f1-score': 0.1579910780870768, 'support': 54207}, 'accuracy': 0.37498103175985925, 'macro avg': {'precision': 0.33874284579296327, 'recall': 0.33388199606134233, 'f1-score': 0.25758622908605017, 'support': 177929}, 'weighted avg': {'precision': 0.342707000556134, 'recall': 0.37498103175985925, 'f1-score': 0.2794616278486696, 'support': 177929}}
[[ 2616 46167  6093]
 [ 2943 58278  7625]
 [ 2348 46033  5826]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
4192/4192 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1068068
{'0': {'precision': 0.29809879404317413, 'recall': 0.06602138613861386, 'f1-score': 0.10810109771534104, 'support': 315625}, '1': {'precision': 0.40194657931208266, 'recall': 0.7999976781174176, 'f1-score': 0.5350603044846536, 'support': 430685}, '2': {'precision': 0.30101129057657944, 'recall': 0.13450923999510464, 'f1-score': 0.18593291054386743, 'support': 326840}, 'accuracy': 0.38144527792014166, 'macro avg': {'precision': 0.3336855546439454, 'recall': 0.3335094347503787, 'f1-score': 0.2763647709146207, 'support': 1073150}, 'weighted avg': {'precision': 0.3406628379937105, 'recall': 0.38144527792014166, 'f1-score': 0.3031562863397802, 'support': 1073150}}
[[ 20838 250925  43862]
 [ 27912 344547  58226]
 [ 21153 261724  43963]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1214157
{'0': {'precision': 0.391970155483669, 'recall': 0.14083120875824834, 'f1-score': 0.2072127982347262, 'support': 106688}, '1': {'precision': 0.33663879411484265, 'recall': 0.7886619465244796, 'f1-score': 0.47186355976523914, 'support': 102963}, '2': {'precision': 0.3486041112180758, 'recall': 0.11701642335766424, 'f1-score': 0.17521738511676888, 'support': 105216}, 'accuracy': 0.3447169757389628, 'macro avg': {'precision': 0.3590710202721958, 'recall': 0.34883652621346406, 'f1-score': 0.2847645810389114, 'support': 314867}, 'weighted avg': {'precision': 0.35938533499099395, 'recall': 0.3447169757389628, 'f1-score': 0.2830632588191863, 'support': 314867}}
[[15025 80222 11441]
 [10195 81203 11565]
 [13112 79792 12312]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1460036
{'0': {'precision': 0.3480608738340697, 'recall': 0.03900640937474211, 'f1-score': 0.07015113661661761, 'support': 36353}, '1': {'precision': 0.28830168968023256, 'recall': 0.8598570799607139, 'f1-score': 0.4318187616399214, 'support': 29527}, '2': {'precision': 0.3455031166518255, 'recall': 0.09602639901003712, 'f1-score': 0.15028404200378723, 'support': 36365}, 'accuracy': 0.29633722920436206, 'macro avg': {'precision': 0.3272885600553759, 'recall': 0.33162996278183104, 'f1-score': 0.2174179800867754, 'support': 102245}, 'weighted avg': {'precision': 0.32989350848180155, 'recall': 0.29633722920436206, 'f1-score': 0.20309644512527342, 'support': 102245}}
[[ 1418 31292  3643]
 [ 1166 25389  2972]
 [ 1490 31383  3492]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
6143/6143 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1027839
{'0': {'precision': 0.32037339079041605, 'recall': 0.11549134427837165, 'f1-score': 0.16977906490905204, 'support': 460909}, '1': {'precision': 0.40896437099694394, 'recall': 0.7764635133717225, 'f1-score': 0.535749017777259, 'support': 638549}, '2': {'precision': 0.2979834427868903, 'recall': 0.1222021630123202, 'f1-score': 0.17332445827673987, 'support': 473044}, 'accuracy': 0.38591238675690076, 'macro avg': {'precision': 0.34244040152475014, 'recall': 0.3380523402208048, 'f1-score': 0.29295084698768364, 'support': 1572502}, 'weighted avg': {'precision': 0.34961230511708674, 'recall': 0.38591238675690076, 'f1-score': 0.319455742264162, 'support': 1572502}}
[[ 53231 351395  56283]
 [ 62835 495810  79904]
 [ 50087 365150  57807]]
Evaluating performance on  train set...
2083/2083 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1247288
{'0': {'precision': 0.3627343326233347, 'recall': 0.15298771879899786, 'f1-score': 0.21520855245600537, 'support': 179217}, '1': {'precision': 0.33300016022828716, 'recall': 0.7487219369374521, 'f1-score': 0.4609770395185041, 'support': 174874}, '2': {'precision': 0.3418320634378734, 'recall': 0.1229748891841497, 'f1-score': 0.1808783620112741, 'support': 179126}, 'accuracy': 0.33828253787857476, 'macro avg': {'precision': 0.3458555187631651, 'recall': 0.3415615149735332, 'f1-score': 0.28568798466192785, 'support': 533217}, 'weighted avg': {'precision': 0.34596091104539084, 'recall': 0.33828253787857476, 'f1-score': 0.2842781596008722, 'support': 533217}}
[[ 27418 130250  21549]
 [ 23078 130932  20864]
 [ 25091 132007  22028]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1140977
{'0': {'precision': 0.36265201621506293, 'recall': 0.12016613644397313, 'f1-score': 0.18051720475785896, 'support': 56580}, '1': {'precision': 0.3582451417139542, 'recall': 0.7968832715722605, 'f1-score': 0.49428194695986327, 'support': 60448}, '2': {'precision': 0.34319796029867056, 'recall': 0.12964141370711152, 'f1-score': 0.18819358623874968, 'support': 58145}, 'accuracy': 0.35683010509610497, 'macro avg': {'precision': 0.35469837274256255, 'recall': 0.34889694057444837, 'f1-score': 0.2876642459854906, 'support': 175173}, 'weighted avg': {'precision': 0.3546739440743697, 'recall': 0.35683010509610497, 'f1-score': 0.29133790393999975, 'support': 175173}}
[[ 6799 42461  7320]
 [ 5172 48170  7106]
 [ 6777 43830  7538]]
testing model on single stock: results/universal/W7/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
23942/23942 - 119s - 119s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038538
{'0': {'precision': 0.2957096100109996, 'recall': 0.06108005835030403, 'f1-score': 0.10124710346672387, 'support': 1800162}, '1': {'precision': 0.4132702192665485, 'recall': 0.7942460490528818, 'f1-score': 0.5436584954677294, 'support': 2533633}, '2': {'precision': 0.2917234451334191, 'recall': 0.1442886832001221, 'f1-score': 0.19307899492513292, 'support': 1795269}, 'accuracy': 0.3885289825656903, 'macro avg': {'precision': 0.3335677581369891, 'recall': 0.33320493020110264, 'f1-score': 0.27932819795319536, 'support': 6129064}, 'weighted avg': {'precision': 0.34313923399214175, 'recall': 0.3885289825656903, 'f1-score': 0.31102971469354906, 'support': 6129064}}
[[ 109954 1429374  260834]
 [ 153222 2012328  368083]
 [ 108655 1427577  259037]]
Evaluating performance on  train set...
9052/9052 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1321987
{'0': {'precision': 0.3335829954286009, 'recall': 0.04960671050205862, 'f1-score': 0.08636951789947406, 'support': 781104}, '1': {'precision': 0.32842771294004786, 'recall': 0.8259805204320885, 'f1-score': 0.4699808705731792, 'support': 764288}, '2': {'precision': 0.32854570368829233, 'recall': 0.11868786348887116, 'f1-score': 0.17438041547433417, 'support': 771688}, 'accuracy': 0.32870034698845096, 'macro avg': {'precision': 0.3301854706856471, 'recall': 0.33142503147433944, 'f1-score': 0.2435769346489958, 'support': 2317080}, 'weighted avg': {'precision': 0.3302048910337995, 'recall': 0.32870034698845096, 'f1-score': 0.24221502476157178, 'support': 2317080}}
[[ 38748 649058  93298]
 [ 39115 631287  93886]
 [ 38294 641804  91590]]
Evaluating performance on  val set...
2763/2763 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1304688
{'0': {'precision': 0.32863591324452274, 'recall': 0.06485690199111775, 'f1-score': 0.10833390796880273, 'support': 230122}, '1': {'precision': 0.3392183945690597, 'recall': 0.794036156374863, 'f1-score': 0.47535952089654804, 'support': 240013}, '2': {'precision': 0.3346655742291321, 'recall': 0.1412176406105068, 'f1-score': 0.1986230289804366, 'support': 237180}, 'accuracy': 0.33789471451899084, 'macro avg': {'precision': 0.3341732940142382, 'recall': 0.33337023299216256, 'f1-score': 0.2607721526152625, 'support': 707315}, 'weighted avg': {'precision': 0.3342487562953216, 'recall': 0.33789471451899084, 'f1-score': 0.26315275410831096, 'support': 707315}}
[[ 14925 182547  32650]
 [ 15496 190579  33938]
 [ 14994 188692  33494]]
training model: results/universal/W7/deepLOB_L1/h200
Epoch 1/50
12475/12475 - 194s - loss: 3.2493 - accuracy200: 0.3962 - val_loss: 3.4173 - val_accuracy200: 0.3321 - 194s/epoch - 16ms/step
Epoch 2/50
12475/12475 - 191s - loss: 3.2342 - accuracy200: 0.4054 - val_loss: 3.6140 - val_accuracy200: 0.3266 - 191s/epoch - 15ms/step
Epoch 3/50
12475/12475 - 190s - loss: 3.2275 - accuracy200: 0.4086 - val_loss: 3.7739 - val_accuracy200: 0.3259 - 190s/epoch - 15ms/step
Epoch 4/50
12475/12475 - 201s - loss: 3.2206 - accuracy200: 0.4124 - val_loss: 3.6865 - val_accuracy200: 0.3274 - 201s/epoch - 16ms/step
Epoch 5/50
12475/12475 - 196s - loss: 3.2156 - accuracy200: 0.4146 - val_loss: 3.8135 - val_accuracy200: 0.3251 - 196s/epoch - 16ms/step
Epoch 6/50
12475/12475 - 199s - loss: 3.2120 - accuracy200: 0.4163 - val_loss: 3.8497 - val_accuracy200: 0.3245 - 199s/epoch - 16ms/step
Epoch 7/50
12475/12475 - 198s - loss: 3.2090 - accuracy200: 0.4176 - val_loss: 3.7421 - val_accuracy200: 0.3263 - 198s/epoch - 16ms/step
Epoch 8/50
12475/12475 - 199s - loss: 3.2062 - accuracy200: 0.4187 - val_loss: 3.9213 - val_accuracy200: 0.3310 - 199s/epoch - 16ms/step
Epoch 9/50
12475/12475 - 192s - loss: 3.2032 - accuracy200: 0.4201 - val_loss: 4.0564 - val_accuracy200: 0.3284 - 192s/epoch - 15ms/step
Epoch 10/50
12475/12475 - 199s - loss: 3.2008 - accuracy200: 0.4208 - val_loss: 4.3811 - val_accuracy200: 0.3257 - 199s/epoch - 16ms/step
Epoch 11/50
12475/12475 - 215s - loss: 3.1993 - accuracy200: 0.4216 - val_loss: 4.3207 - val_accuracy200: 0.3267 - 215s/epoch - 17ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 219s - 219s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1233968
{'0': {'precision': 0.29887571828775006, 'recall': 0.5270970001910706, 'f1-score': 0.38145689564555285, 'support': 2826180}, '1': {'precision': 0.4134802927970996, 'recall': 0.39017967159023537, 'f1-score': 0.40149220317475137, 'support': 3879300}, '2': {'precision': 0.3036678901875484, 'recall': 0.0933347904283145, 'f1-score': 0.14278381620242778, 'support': 2800092}, 'accuracy': 0.3434449815329367, 'macro avg': {'precision': 0.33867463375746604, 'recall': 0.33687048740320685, 'f1-score': 0.3085776383409107, 'support': 9505572}, 'weighted avg': {'precision': 0.3470584103017993, 'recall': 0.3434449815329367, 'f1-score': 0.31932664068919253, 'support': 9505572}}
[[1489671 1068287  268222]
 [2034613 1513624  331063]
 [1459965 1078781  261346]]
Evaluating performance on  train set...
12475/12475 - 66s - 66s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1450211
{'0': {'precision': 0.3441777208106871, 'recall': 0.6144231265245362, 'f1-score': 0.4412071028070766, 'support': 1085576}, '1': {'precision': 0.3339261774292817, 'recall': 0.3471920951795443, 'f1-score': 0.34042994833454493, 'support': 1034508}, '2': {'precision': 0.32940055816440783, 'recall': 0.055109972041006525, 'f1-score': 0.09442267051065974, 'support': 1073000}, 'accuracy': 0.3398936576676342, 'macro avg': {'precision': 0.3358348188014588, 'recall': 0.33890839791502897, 'f1-score': 0.2920199072174271, 'support': 3193084}, 'weighted avg': {'precision': 0.3358906857186355, 'recall': 0.3398936576676342, 'f1-score': 0.2920239092634288, 'support': 3193084}}
[[667003 359992  58581]
 [613532 359173  61803]
 [657426 356441  59133]]
Evaluating performance on  val set...
3866/3866 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1400272
{'0': {'precision': 0.32434188472012443, 'recall': 0.5381300853653964, 'f1-score': 0.40473924293379027, 'support': 320036}, '1': {'precision': 0.3416025152239991, 'recall': 0.3888611448003615, 'f1-score': 0.36370308998604306, 'support': 336408}, '2': {'precision': 0.33469734814263696, 'recall': 0.07570666971192277, 'f1-score': 0.12348232710660596, 'support': 332758}, 'accuracy': 0.3318119049496463, 'macro avg': {'precision': 0.3335472493622535, 'recall': 0.33423263329256026, 'f1-score': 0.29730822000881313, 'support': 989202}, 'weighted avg': {'precision': 0.333695361041539, 'recall': 0.3318119049496463, 'f1-score': 0.2961715500483453, 'support': 989202}}
[[172221 123915  23900]
 [179416 130816  26176]
 [179349 128217  25192]]
testing model out of sample: results/universal/W7/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 74s - 74s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1305729
{'0': {'precision': 0.3076213251802409, 'recall': 0.5296548405198849, 'f1-score': 0.3891980462446637, 'support': 1151178}, '1': {'precision': 0.38166062286330044, 'recall': 0.396547498848186, 'f1-score': 0.3889616702340019, 'support': 1428182}, '2': {'precision': 0.3118133783972261, 'recall': 0.08045262289292343, 'f1-score': 0.12790404502379915, 'support': 1194902}, 'accuracy': 0.33707304898282103, 'macro avg': {'precision': 0.33369844214692246, 'recall': 0.3355516540869981, 'f1-score': 0.3020212538341549, 'support': 3774262}, 'weighted avg': {'precision': 0.33696499157559695, 'recall': 0.33707304898282103, 'f1-score': 0.30638495255628906, 'support': 3774262}}
[[609727 448421  93030]
 [742700 566342 119140]
 [629643 469126  96133]]
Evaluating performance on  train set...
5285/5285 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1433978
{'0': {'precision': 0.338797111598379, 'recall': 0.643683475833188, 'f1-score': 0.4439336617652589, 'support': 458480}, '1': {'precision': 0.3299988349555694, 'recall': 0.2834903224779188, 'f1-score': 0.304981677362519, 'support': 439627}, '2': {'precision': 0.3388863225160719, 'recall': 0.077469700069741, 'f1-score': 0.12611044557496057, 'support': 454539}, 'accuracy': 0.3363474257122706, 'macro avg': {'precision': 0.3358940896900067, 'recall': 0.3348811661269493, 'f1-score': 0.29167526156757945, 'support': 1352646}, 'weighted avg': {'precision': 0.3359675389501538, 'recall': 0.3363474257122706, 'f1-score': 0.29197217966946637, 'support': 1352646}}
[[295116 126762  36602]
 [282904 124630  32093]
 [293050 126276  35213]]
Evaluating performance on  val set...
1714/1714 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1417328
{'0': {'precision': 0.32557457140970814, 'recall': 0.618931074155423, 'f1-score': 0.4266956373346665, 'support': 143415}, '1': {'precision': 0.33533229806997333, 'recall': 0.31737183959037435, 'f1-score': 0.3261049598797436, 'support': 147647}, '2': {'precision': 0.3507814631484585, 'recall': 0.06123615382521841, 'f1-score': 0.10426985037276472, 'support': 146972}, 'accuracy': 0.33016386855814844, 'macro avg': {'precision': 0.33722944420938, 'recall': 0.33251302252367193, 'f1-score': 0.28569014919572494, 'support': 438034}, 'weighted avg': {'precision': 0.33732116268078705, 'recall': 0.33016386855814844, 'f1-score': 0.28460741012958285, 'support': 438034}}
[[88764 45988  8663]
 [92794 46859  7994]
 [91080 46892  9000]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1330266
{'0': {'precision': 0.31703255824938886, 'recall': 0.47450377361825474, 'f1-score': 0.38010420796284755, 'support': 56577}, '1': {'precision': 0.3457573563294056, 'recall': 0.42507526464018647, 'f1-score': 0.38133544363533406, 'support': 61782}, '2': {'precision': 0.33360323886639676, 'recall': 0.09683538991018216, 'f1-score': 0.15010083924272985, 'support': 59565}, 'accuracy': 0.33090533036577413, 'macro avg': {'precision': 0.3321310511483971, 'recall': 0.33213814272287445, 'f1-score': 0.30384683028030385, 'support': 177924}, 'weighted avg': {'precision': 0.33255439940590326, 'recall': 0.33090533036577413, 'f1-score': 0.3035317250179034, 'support': 177924}}
[[26846 24220  5511]
 [29509 26262  6011]
 [28324 25473  5768]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1398576
{'0': {'precision': 0.3394195978962289, 'recall': 0.7397967479674796, 'f1-score': 0.4653404587179421, 'support': 24600}, '1': {'precision': 0.32061366443476563, 'recall': 0.20697469469973562, 'f1-score': 0.2515556462307457, 'support': 23829}, '2': {'precision': 0.32654424040066776, 'recall': 0.04149870581745661, 'f1-score': 0.07363903320533093, 'support': 23567}, 'accuracy': 0.33486582587921554, 'macro avg': {'precision': 0.3288591675772208, 'recall': 0.329423382828224, 'f1-score': 0.2635117127180063, 'support': 71996}, 'weighted avg': {'precision': 0.32898068269884156, 'recall': 0.33486582587921554, 'f1-score': 0.26636404625317867, 'support': 71996}}
[[18199  5333  1068]
 [17948  4932   949]
 [17471  5118   978]]
Evaluating performance on  val set...
73/73 - 1s - 590ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1448324
{'0': {'precision': 0.3451104100946372, 'recall': 0.6009102322661645, 'f1-score': 0.438426747581153, 'support': 6372}, '1': {'precision': 0.3069137340392401, 'recall': 0.3462146495696469, 'f1-score': 0.3253817581510524, 'support': 5693}, '2': {'precision': 0.3632694248234107, 'recall': 0.05587459258109576, 'f1-score': 0.09685230024213075, 'support': 6443}, 'accuracy': 0.3328290468986384, 'macro avg': {'precision': 0.3384311896524293, 'recall': 0.334333158138969, 'f1-score': 0.28688693532477877, 'support': 18508}, 'weighted avg': {'precision': 0.3396827493595017, 'recall': 0.3328290468986384, 'f1-score': 0.28474567512432986, 'support': 18508}}
[[3829 2204  339]
 [3430 1971  292]
 [3836 2247  360]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
2006/2006 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1468966
{'0': {'precision': 0.3443640868112687, 'recall': 0.6210026343549215, 'f1-score': 0.4430461510599551, 'support': 177273}, '1': {'precision': 0.328033502088048, 'recall': 0.3378770493280547, 'f1-score': 0.33288252162564475, 'support': 166457}, '2': {'precision': 0.31812038205082, 'recall': 0.04163325471698113, 'f1-score': 0.07363031554359839, 'support': 169600}, 'accuracy': 0.33777492061636766, 'macro avg': {'precision': 0.3301726569833789, 'recall': 0.33350431279998577, 'f1-score': 0.28318632940973276, 'support': 513330}, 'weighted avg': {'precision': 0.3303978809229605, 'recall': 0.33777492061636766, 'f1-score': 0.2852715558320879, 'support': 513330}}
[[110087  59326   7860]
 [102940  56242   7275]
 [106655  55884   7061]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1373216
{'0': {'precision': 0.3499661763188369, 'recall': 0.6285496591915323, 'f1-score': 0.44960155548026925, 'support': 48561}, '1': {'precision': 0.3210087935687959, 'recall': 0.2520049211701449, 'f1-score': 0.28235204023025184, 'support': 43892}, '2': {'precision': 0.35157284246359455, 'recall': 0.12370242214532871, 'f1-score': 0.18301146898124598, 'support': 45084}, 'accuracy': 0.34289682049194037, 'macro avg': {'precision': 0.3408492707837425, 'recall': 0.33475233416900196, 'f1-score': 0.3049883548972557, 'support': 137537}, 'weighted avg': {'precision': 0.34125170307022346, 'recall': 0.34289682049194037, 'f1-score': 0.3088404280521901, 'support': 137537}}
[[30523 12117  5921]
 [28466 11061  4365]
 [28228 11279  5577]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1655194
{'0': {'precision': 0.3406758006960659, 'recall': 0.5789907157831686, 'f1-score': 0.42895576203023156, 'support': 13356}, '1': {'precision': 0.30483604298704875, 'recall': 0.37272574123989216, 'f1-score': 0.33537971805366074, 'support': 11872}, '2': {'precision': 0.3231607629427793, 'recall': 0.042902619013167415, 'f1-score': 0.07574886632177302, 'support': 13822}, 'accuracy': 0.3265300896286812, 'macro avg': {'precision': 0.322890868875298, 'recall': 0.33153969201207606, 'f1-score': 0.2800281154685551, 'support': 39050}, 'weighted avg': {'precision': 0.32358021925311126, 'recall': 0.3265300896286812, 'f1-score': 0.27548686301429914, 'support': 39050}}
[[7733 4985  638]
 [6843 4425  604]
 [8123 5106  593]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.138686
{'0': {'precision': 0.32299578405157564, 'recall': 0.5100642453758872, 'f1-score': 0.3955263607235765, 'support': 77204}, '1': {'precision': 0.3455898067391946, 'recall': 0.409808961780288, 'f1-score': 0.374969634062852, 'support': 82863}, '2': {'precision': 0.3290554992682652, 'recall': 0.07506612907367935, 'f1-score': 0.12224499184475766, 'support': 77878}, 'accuracy': 0.3327785832860535, 'macro avg': {'precision': 0.3325470300196785, 'recall': 0.33164644540995153, 'f1-score': 0.29758032887706204, 'support': 237945}, 'weighted avg': {'precision': 0.3328473337946235, 'recall': 0.3327785832860535, 'f1-score': 0.2989242111224827, 'support': 237945}}
[[39379 32010  5815]
 [42800 33958  6105]
 [39739 32293  5846]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1394949
{'0': {'precision': 0.33489669672098005, 'recall': 0.5120707242434546, 'f1-score': 0.40495251598078635, 'support': 32351}, '1': {'precision': 0.3474852434825381, 'recall': 0.35151609392007466, 'f1-score': 0.34948904658101826, 'support': 32155}, '2': {'precision': 0.3358021510916468, 'recall': 0.1579282144479782, 'f1-score': 0.2148242758848008, 'support': 33015}, 'accuracy': 0.3392397534889921, 'macro avg': {'precision': 0.3393946970983883, 'recall': 0.3405050108705025, 'f1-score': 0.32308861281553514, 'support': 97521}, 'weighted avg': {'precision': 0.33935397563696185, 'recall': 0.3392397534889921, 'f1-score': 0.32229840347867394, 'support': 97521}}
[[16566 10319  5466]
 [16005 11303  4847]
 [16895 10906  5214]]
Evaluating performance on  val set...
114/114 - 1s - 789ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.147394
{'0': {'precision': 0.3232638888888889, 'recall': 0.48917612442202607, 'f1-score': 0.38927914366950994, 'support': 9516}, '1': {'precision': 0.31760904684975766, 'recall': 0.4168787107718405, 'f1-score': 0.3605354850540986, 'support': 9432}, '2': {'precision': 0.33826730518067044, 'recall': 0.07671043538355218, 'f1-score': 0.12506035731530663, 'support': 10129}, 'accuracy': 0.3220414760807511, 'macro avg': {'precision': 0.326380080306439, 'recall': 0.32758842352580625, 'f1-score': 0.29162499534630504, 'support': 29077}, 'weighted avg': {'precision': 0.32665602471811367, 'recall': 0.3220414760807511, 'f1-score': 0.28791441295305764, 'support': 29077}}
[[4655 4085  776]
 [4756 3932  744]
 [4989 4363  777]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1065/1065 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1366581
{'0': {'precision': 0.30706133131863683, 'recall': 0.5538117137503954, 'f1-score': 0.3950737291592532, 'support': 82194}, '1': {'precision': 0.3507714753967302, 'recall': 0.3720099623761327, 'f1-score': 0.3610786789628799, 'support': 94355}, '2': {'precision': 0.3554239324027669, 'recall': 0.08947302567096949, 'f1-score': 0.1429582920307541, 'support': 95906}, 'accuracy': 0.3274008551870951, 'macro avg': {'precision': 0.33775224637271134, 'recall': 0.3384315672658325, 'f1-score': 0.2997035667176291, 'support': 272455}, 'weighted avg': {'precision': 0.3392227314179672, 'recall': 0.3274008551870951, 'f1-score': 0.2945544284507889, 'support': 272455}}
[[45520 29492  7182]
 [50874 35101  8380]
 [51850 35475  8581]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1381165
{'0': {'precision': 0.349155487197015, 'recall': 0.6922968317614503, 'f1-score': 0.46419645561950923, 'support': 35414}, '1': {'precision': 0.33091102445941156, 'recall': 0.27575918704950964, 'f1-score': 0.3008282040540105, 'support': 33852}, '2': {'precision': 0.33158896289248335, 'recall': 0.04177905652460589, 'f1-score': 0.07420814479638009, 'support': 33366}, 'accuracy': 0.34342115519526073, 'macro avg': {'precision': 0.3372184915163033, 'recall': 0.33661169177852196, 'f1-score': 0.2797442681566333, 'support': 102632}, 'weighted avg': {'precision': 0.33742682359756887, 'recall': 0.34342115519526073, 'f1-score': 0.28352481294549153, 'support': 102632}}
[[24517  9506  1391]
 [23098  9335  1419]
 [22603  9369  1394]]
Evaluating performance on  val set...
123/123 - 1s - 814ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1523507
{'0': {'precision': 0.29761186829091785, 'recall': 0.5233853006681515, 'f1-score': 0.379454846026681, 'support': 9429}, '1': {'precision': 0.33964071856287426, 'recall': 0.39583139480785334, 'f1-score': 0.36558954967342727, 'support': 10747}, '2': {'precision': 0.351363236587511, 'recall': 0.0713074520303436, 'f1-score': 0.11855478893092959, 'support': 11205}, 'accuracy': 0.31828176285013227, 'macro avg': {'precision': 0.3295386078137677, 'recall': 0.3301747158354495, 'f1-score': 0.28786639487701265, 'support': 31381}, 'weighted avg': {'precision': 0.33119805533518165, 'recall': 0.31828176285013227, 'f1-score': 0.2815486136036762, 'support': 31381}}
[[4935 3816  678]
 [5696 4254  797]
 [5951 4455  799]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
1646/1646 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1188552
{'0': {'precision': 0.2635140522224437, 'recall': 0.4752840092033362, 'f1-score': 0.33904803426255997, 'support': 111264}, '1': {'precision': 0.43871304406376427, 'recall': 0.4211300226219972, 'f1-score': 0.4297417548141003, 'support': 185660}, '2': {'precision': 0.2955221063558722, 'recall': 0.10072289544149693, 'f1-score': 0.15023958452026123, 'support': 124361}, 'accuracy': 0.34085001839609763, 'macro avg': {'precision': 0.33258306754736006, 'recall': 0.3323789757556101, 'f1-score': 0.30634312453230716, 'support': 421285}, 'weighted avg': {'precision': 0.35017272377577907, 'recall': 0.34085001839609763, 'f1-score': 0.3232814832085157, 'support': 421285}}
[[52882 47093 11289]
 [88902 78187 18571]
 [58896 52939 12526]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1419591
{'0': {'precision': 0.33541403098369654, 'recall': 0.6188588667943891, 'f1-score': 0.4350410613249533, 'support': 45411}, '1': {'precision': 0.33638288220172385, 'recall': 0.3018795376925339, 'f1-score': 0.31819861486929474, 'support': 44213}, '2': {'precision': 0.33575790229885055, 'recall': 0.08313322660974742, 'f1-score': 0.1332691759338466, 'support': 44976}, 'accuracy': 0.33572808320950964, 'macro avg': {'precision': 0.3358516051614237, 'recall': 0.3346238770322234, 'f1-score': 0.2955029507093649, 'support': 134600}, 'weighted avg': {'precision': 0.33584717938765646, 'recall': 0.33572808320950964, 'f1-score': 0.29582525595723824, 'support': 134600}}
[[28103 13279  4029]
 [27498 13347  3368]
 [28185 13052  3739]]
Evaluating performance on  val set...
146/146 - 1s - 911ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1538385
{'0': {'precision': 0.31370772946859904, 'recall': 0.5312313591819344, 'f1-score': 0.3944695795235233, 'support': 11735}, '1': {'precision': 0.3562398703403566, 'recall': 0.4161302536917834, 'f1-score': 0.38386308068459657, 'support': 13205}, '2': {'precision': 0.2975609756097561, 'recall': 0.04916579350366729, 'f1-score': 0.08438818565400844, 'support': 12407}, 'accuracy': 0.33038798297051974, 'macro avg': {'precision': 0.32250285847290394, 'recall': 0.33217580212579506, 'f1-score': 0.28757361528737607, 'support': 37347}, 'weighted avg': {'precision': 0.32338197760325227, 'recall': 0.33038798297051974, 'f1-score': 0.2877076261964261, 'support': 37347}}
[[6234 4808  693]
 [6963 5495  747]
 [6675 5122  610]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
5929/5929 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1274006
{'0': {'precision': 0.3381961232042339, 'recall': 0.6039696806979042, 'f1-score': 0.43359715179420066, 'support': 513996}, '1': {'precision': 0.3362248716482873, 'recall': 0.23267956867586856, 'f1-score': 0.27502917034237456, 'support': 523226}, '2': {'precision': 0.33790342609625396, 'recall': 0.1671111333170952, 'f1-score': 0.22362691702302515, 'support': 480351}, 'accuracy': 0.3376799666309298, 'macro avg': {'precision': 0.3374414736495917, 'recall': 0.33458679423028936, 'f1-score': 0.31075107971986676, 'support': 1517573}, 'weighted avg': {'precision': 0.3374238325696964, 'recall': 0.3376799666309298, 'f1-score': 0.312465382247904, 'support': 1517573}}
[[310438 117287  86271]
 [330466 121744  71016]
 [277019 123060  80272]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.14468
{'0': {'precision': 0.33415165722888307, 'recall': 0.6433767808426796, 'f1-score': 0.4398550654245553, 'support': 105568}, '1': {'precision': 0.33953608709064315, 'recall': 0.3221819349234227, 'f1-score': 0.33063144685778517, 'support': 105906}, '2': {'precision': 0.33240385732543276, 'recall': 0.052258571245913016, 'f1-score': 0.09031789626542916, 'support': 109494}, 'accuracy': 0.3357437501557788, 'macro avg': {'precision': 0.3353638672149863, 'recall': 0.33927242900400506, 'f1-score': 0.2869348028492566, 'support': 320968}, 'weighted avg': {'precision': 0.3353320547336536, 'recall': 0.3357437501557788, 'f1-score': 0.28457584959044807, 'support': 320968}}
[[67920 32215  5433]
 [65726 34121  6059]
 [69615 34157  5722]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1481172
{'0': {'precision': 0.32701232917218415, 'recall': 0.714173405211141, 'f1-score': 0.4486106579423098, 'support': 35616}, '1': {'precision': 0.35311402565756467, 'recall': 0.2651562037510427, 'f1-score': 0.3028784828412916, 'support': 37163}, '2': {'precision': 0.3202725724020443, 'recall': 0.030961791831357048, 'f1-score': 0.05646493467487611, 'support': 36432}, 'accuracy': 0.3334645777440001, 'macro avg': {'precision': 0.33346630907726443, 'recall': 0.3367638002645135, 'f1-score': 0.2693180251528258, 'support': 109211}, 'weighted avg': {'precision': 0.33364604306397583, 'recall': 0.3334645777440001, 'f1-score': 0.2682030267205621, 'support': 109211}}
[[25436  9038  1142]
 [26057  9854  1252]
 [26290  9014  1128]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
5331/5331 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1263592
{'0': {'precision': 0.3081962204333766, 'recall': 0.4837089281008824, 'f1-score': 0.376502826649125, 'support': 421243}, '1': {'precision': 0.37810792527449655, 'recall': 0.4227754072924748, 'f1-score': 0.39919605167977584, 'support': 515600}, '2': {'precision': 0.31186496747058173, 'recall': 0.09256293788850369, 'f1-score': 0.14275541935193115, 'support': 427763}, 'accuracy': 0.33807340726920443, 'macro avg': {'precision': 0.33272303772615164, 'recall': 0.33301575776062026, 'f1-score': 0.3061514325602773, 'support': 1364606}, 'weighted avg': {'precision': 0.3357615610921143, 'recall': 0.33807340726920443, 'f1-score': 0.31180439694717, 'support': 1364606}}
[[203759 177945  39539]
 [249789 217983  47828]
 [207586 180582  39595]]
Evaluating performance on  train set...
2013/2013 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1415156
{'0': {'precision': 0.3475763171919735, 'recall': 0.6287251632430009, 'f1-score': 0.4476690472057101, 'support': 178415}, '1': {'precision': 0.3268610948000261, 'recall': 0.30512768976837384, 'f1-score': 0.3156206982362965, 'support': 164187}, '2': {'precision': 0.34418722971254134, 'recall': 0.07833941288865728, 'f1-score': 0.1276294689180266, 'support': 172710}, 'accuracy': 0.34115642562175924, 'macro avg': {'precision': 0.33954154723484703, 'recall': 0.3373974219666773, 'f1-score': 0.29697307145334445, 'support': 515312}, 'weighted avg': {'precision': 0.3398402281479781, 'recall': 0.34115642562175924, 'f1-score': 0.29833299867917296, 'support': 515312}}
[[112174  51856  14385]
 [102694  50098  11395]
 [107864  51316  13530]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1402012
{'0': {'precision': 0.3356691981903068, 'recall': 0.6290680160435953, 'f1-score': 0.4377539363819439, 'support': 59089}, '1': {'precision': 0.34188607812768884, 'recall': 0.33240751585323003, 'f1-score': 0.3370801767944552, 'support': 59767}, '2': {'precision': 0.3321955516406078, 'recall': 0.051072401943358214, 'f1-score': 0.0885334898393368, 'support': 59073}, 'accuracy': 0.33752227011898006, 'macro avg': {'precision': 0.33658360931953446, 'recall': 0.33751597794672783, 'f1-score': 0.2877892010052453, 'support': 177929}, 'weighted avg': {'precision': 0.3366042090125288, 'recall': 0.33752227011898006, 'f1-score': 0.2879949424693335, 'support': 177929}}
[[37171 18929  2989]
 [36824 19867  3076]
 [36742 19314  3017]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
4192/4192 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.128403
{'0': {'precision': 0.31659711965992293, 'recall': 0.4785543648696135, 'f1-score': 0.38108193587300165, 'support': 338647}, '1': {'precision': 0.355170980307626, 'recall': 0.4232771501218905, 'f1-score': 0.38624477206377456, 'support': 381490}, '2': {'precision': 0.32714329928814606, 'recall': 0.09880939228866925, 'f1-score': 0.1517766232409994, 'support': 353013}, 'accuracy': 0.3339868611098169, 'macro avg': {'precision': 0.33297046641856504, 'recall': 0.33354696909339104, 'f1-score': 0.30636777705925855, 'support': 1073150}, 'weighted avg': {'precision': 0.3337787630532884, 'recall': 0.3339868611098169, 'f1-score': 0.30748720452161266, 'support': 1073150}}
[[162061 142941  33645]
 [181917 161476  38097]
 [167906 150226  34881]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.144431
{'0': {'precision': 0.34598349701003045, 'recall': 0.7019341106792523, 'f1-score': 0.46350517731818286, 'support': 108060}, '1': {'precision': 0.3296143002819267, 'recall': 0.27177138561367414, 'f1-score': 0.29791109834048063, 'support': 101096}, '2': {'precision': 0.3526345793631403, 'recall': 0.0409607325633094, 'f1-score': 0.07339605051275531, 'support': 105711}, 'accuracy': 0.34190944112911165, 'macro avg': {'precision': 0.34274412555169914, 'recall': 0.33822207628541195, 'f1-score': 0.27827077539047296, 'support': 314867}, 'weighted avg': {'precision': 0.34296073582580094, 'recall': 0.34190944112911165, 'f1-score': 0.2793648103948205, 'support': 314867}}
[[75851 28215  3994]
 [69666 27475  3955]
 [73716 27665  4330]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1449637
{'0': {'precision': 0.33529553461202616, 'recall': 0.6515036274280365, 'f1-score': 0.4427370136969962, 'support': 34184}, '1': {'precision': 0.3387458917705249, 'recall': 0.3084170295973691, 'f1-score': 0.32287078965324734, 'support': 33753}, '2': {'precision': 0.3155930871956009, 'recall': 0.04684038708173021, 'f1-score': 0.08157360406091371, 'support': 34308}, 'accuracy': 0.3353513619247885, 'macro avg': {'precision': 0.3298781711927173, 'recall': 0.33558701470237856, 'f1-score': 0.28239380247038576, 'support': 102245}, 'weighted avg': {'precision': 0.3298234659456668, 'recall': 0.3353513619247885, 'f1-score': 0.2819796278302705, 'support': 102245}}
[[22271 10222  1691]
 [21549 10410  1794]
 [22602 10099  1607]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
6143/6143 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1357034
{'0': {'precision': 0.31406338129779504, 'recall': 0.5925447008599889, 'f1-score': 0.4105337156916957, 'support': 484890}, '1': {'precision': 0.3768235637801012, 'recall': 0.35887730410096913, 'f1-score': 0.36763154862278474, 'support': 582277}, '2': {'precision': 0.313416479168283, 'recall': 0.06395163604341675, 'f1-score': 0.10622782263697578, 'support': 505335}, 'accuracy': 0.33615346753136083, 'macro avg': {'precision': 0.33476780808205975, 'recall': 0.33845788033479157, 'f1-score': 0.2947976956504854, 'support': 1572502}, 'weighted avg': {'precision': 0.3370947723469847, 'recall': 0.33615346753136083, 'f1-score': 0.29685668151228534, 'support': 1572502}}
[[287319 166961  30610]
 [333126 208966  40185]
 [294399 178619  32317]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.146521
{'0': {'precision': 0.332665530294645, 'recall': 0.6765220620923676, 'f1-score': 0.4460133522047462, 'support': 177703}, '1': {'precision': 0.32801787396228066, 'recall': 0.2563583138841494, 'f1-score': 0.28779444077872657, 'support': 175243}, '2': {'precision': 0.3360669839995412, 'recall': 0.06501323008137748, 'f1-score': 0.10894977805665945, 'support': 180271}, 'accuracy': 0.3316942258030033, 'macro avg': {'precision': 0.33225012941882226, 'recall': 0.3326312020192982, 'f1-score': 0.28091919034671076, 'support': 533217}, 'weighted avg': {'precision': 0.3322880371205392, 'recall': 0.3316942258030033, 'f1-score': 0.2800592579611649, 'support': 533217}}
[[120220  45700  11783]
 [118947  44925  11371]
 [122217  46334  11720]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1401803
{'0': {'precision': 0.31793643845962394, 'recall': 0.6533164030121863, 'f1-score': 0.42772197205865375, 'support': 56703}, '1': {'precision': 0.32640905838279244, 'recall': 0.26043660789252726, 'f1-score': 0.28971456325188677, 'support': 59550}, '2': {'precision': 0.366810267456471, 'recall': 0.0693652410047522, 'f1-score': 0.11666809397390883, 'support': 58920}, 'accuracy': 0.32334320928453586, 'macro avg': {'precision': 0.3370519214329624, 'recall': 0.3277060839698219, 'f1-score': 0.2780348764281498, 'support': 175173}, 'weighted avg': {'precision': 0.33725557166462083, 'recall': 0.32334320928453586, 'f1-score': 0.27618243291051936, 'support': 175173}}
[[37045 15721  3937]
 [40923 15509  3118]
 [38549 16284  4087]]
testing model on single stock: results/universal/W7/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
23942/23942 - 116s - 116s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189356
{'0': {'precision': 0.27920901488295147, 'recall': 0.5029619560461358, 'f1-score': 0.35908137092951675, 'support': 1714070}, '1': {'precision': 0.44298282278097617, 'recall': 0.4198329852323629, 'f1-score': 0.43109734237025193, 'support': 2713772}, '2': {'precision': 0.277133124705752, 'recall': 0.07646914982289202, 'f1-score': 0.11986424274142315, 'support': 1701222}, 'accuracy': 0.3477747988926205, 'macro avg': {'precision': 0.3331083207898932, 'recall': 0.33308803036713025, 'f1-score': 0.3033476520137306, 'support': 6129064}, 'weighted avg': {'precision': 0.351147115736198, 'recall': 0.3477747988926205, 'f1-score': 0.3245693288947561, 'support': 6129064}}
[[ 862112  718484  133474]
 [1368589 1139331  205852]
 [ 856993  714138  130091]]
Evaluating performance on  train set...
9052/9052 - 52s - 52s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1458182
{'0': {'precision': 0.3448087403519446, 'recall': 0.5940964982302693, 'f1-score': 0.4363585520336685, 'support': 787973}, '1': {'precision': 0.33444893151200766, 'recall': 0.36959595178203214, 'f1-score': 0.35114514457180945, 'support': 749762}, '2': {'precision': 0.3242479120341716, 'recall': 0.054448286702294874, 'f1-score': 0.09323961178360254, 'support': 779345}, 'accuracy': 0.33994294543131875, 'macro avg': {'precision': 0.3345018612993746, 'recall': 0.33938024557153207, 'f1-score': 0.2935811027963602, 'support': 2317080}, 'weighted avg': {'precision': 0.33454091630583327, 'recall': 0.33994294543131875, 'f1-score': 0.2933778153760624, 'support': 2317080}}
[[468132 277612  42229]
 [426447 277109  46206]
 [463078 273833  42434]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1355132
{'0': {'precision': 0.32195403293249125, 'recall': 0.4908485783751226, 'f1-score': 0.3888537688450962, 'support': 227451}, '1': {'precision': 0.34245831223656986, 'recall': 0.4205119548076567, 'f1-score': 0.3774925984380025, 'support': 242873}, '2': {'precision': 0.3352269080172026, 'recall': 0.08814680726272306, 'f1-score': 0.1395891175281567, 'support': 236991}, 'accuracy': 0.33176873104628063, 'macro avg': {'precision': 0.33321308439542124, 'recall': 0.3331691134818341, 'f1-score': 0.3019784949370851, 'support': 707315}, 'weighted avg': {'precision': 0.3334418251702076, 'recall': 0.33176873104628063, 'f1-score': 0.30143472567404106, 'support': 707315}}
[[111644  95932  19875]
 [119191 102131  21551]
 [115935 100166  20890]]
training model: results/universal/W7/deepOF_L1/h50
Epoch 1/50
12475/12475 - 174s - loss: 3.2140 - accuracy50: 0.4110 - val_loss: 3.2782 - val_accuracy50: 0.3610 - 174s/epoch - 14ms/step
Epoch 2/50
12475/12475 - 163s - loss: 3.2044 - accuracy50: 0.4148 - val_loss: 3.2761 - val_accuracy50: 0.3625 - 163s/epoch - 13ms/step
Epoch 3/50
12475/12475 - 164s - loss: 3.1996 - accuracy50: 0.4171 - val_loss: 3.2720 - val_accuracy50: 0.3636 - 164s/epoch - 13ms/step
Epoch 4/50
12475/12475 - 166s - loss: 3.1958 - accuracy50: 0.4188 - val_loss: 3.2716 - val_accuracy50: 0.3647 - 166s/epoch - 13ms/step
Epoch 5/50
12475/12475 - 169s - loss: 3.1931 - accuracy50: 0.4201 - val_loss: 3.2706 - val_accuracy50: 0.3660 - 169s/epoch - 14ms/step
Epoch 6/50
12475/12475 - 164s - loss: 3.1908 - accuracy50: 0.4208 - val_loss: 3.2728 - val_accuracy50: 0.3647 - 164s/epoch - 13ms/step
Epoch 7/50
12475/12475 - 162s - loss: 3.1888 - accuracy50: 0.4216 - val_loss: 3.2716 - val_accuracy50: 0.3653 - 162s/epoch - 13ms/step
Epoch 8/50
12475/12475 - 163s - loss: 3.1869 - accuracy50: 0.4223 - val_loss: 3.2720 - val_accuracy50: 0.3651 - 163s/epoch - 13ms/step
Epoch 9/50
12475/12475 - 163s - loss: 3.1849 - accuracy50: 0.4231 - val_loss: 3.2723 - val_accuracy50: 0.3650 - 163s/epoch - 13ms/step
Epoch 10/50
12475/12475 - 164s - loss: 3.1831 - accuracy50: 0.4236 - val_loss: 3.2725 - val_accuracy50: 0.3648 - 164s/epoch - 13ms/step
Epoch 11/50
12475/12475 - 168s - loss: 3.1814 - accuracy50: 0.4241 - val_loss: 3.2725 - val_accuracy50: 0.3655 - 168s/epoch - 13ms/step
Epoch 12/50
12475/12475 - 164s - loss: 3.1801 - accuracy50: 0.4245 - val_loss: 3.2715 - val_accuracy50: 0.3659 - 164s/epoch - 13ms/step
Epoch 13/50
12475/12475 - 163s - loss: 3.1784 - accuracy50: 0.4251 - val_loss: 3.2713 - val_accuracy50: 0.3659 - 163s/epoch - 13ms/step
Epoch 14/50
12475/12475 - 163s - loss: 3.1768 - accuracy50: 0.4255 - val_loss: 3.2724 - val_accuracy50: 0.3671 - 163s/epoch - 13ms/step
Epoch 15/50
12475/12475 - 164s - loss: 3.1752 - accuracy50: 0.4260 - val_loss: 3.2715 - val_accuracy50: 0.3682 - 164s/epoch - 13ms/step
testing model in sample: results/universal/W7/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 175s - 175s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1132754
{'0': {'precision': 0.31231445966662363, 'recall': 0.5960146548853514, 'f1-score': 0.4098602409892399, 'support': 2480538}, '1': {'precision': 0.6248225103545862, 'recall': 0.02796393968486145, 'f1-score': 0.053532051690850846, 'support': 4547714}, '2': {'precision': 0.31394409839313253, 'recall': 0.5789221711584611, 'f1-score': 0.40711404442551985, 'support': 2477295}, 'accuracy': 0.31978906632095977, 'macro avg': {'precision': 0.41702702280478077, 'recall': 0.40096692190955796, 'f1-score': 0.2901687790352035, 'support': 9505547}, 'weighted avg': {'precision': 0.46225157881351164, 'recall': 0.31978906632095977, 'f1-score': 0.2386673749623553, 'support': 9505547}}
[[1478437   43742  958359]
 [2244857  127172 2175685]
 [1010515   32619 1434161]]
Evaluating performance on  train set...
12475/12475 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0919018
{'0': {'precision': 0.37682668571356964, 'recall': 0.582710274488223, 'f1-score': 0.45768071595796206, 'support': 1032139}, '1': {'precision': 0.5171889486371222, 'recall': 0.024392248910779218, 'f1-score': 0.04658729522435127, 'support': 1143478}, '2': {'precision': 0.3737823118318592, 'recall': 0.5668806961642756, 'f1-score': 0.4505119800480287, 'support': 1017461}, 'accuracy': 0.3777261313378502, 'macro avg': {'precision': 0.42259931539418366, 'recall': 0.3913277398544259, 'f1-score': 0.3182599970767807, 'support': 3193078}, 'weighted avg': {'precision': 0.42612195128153857, 'recall': 0.3777261313378502, 'f1-score': 0.30817914043701194, 'support': 3193078}}
[[601438  14732 415969]
 [565246  27892 550340]
 [429376  11306 576779]]
Evaluating performance on  val set...
3866/3866 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973847
{'0': {'precision': 0.3578339058712407, 'recall': 0.5959589036625087, 'f1-score': 0.44717112585603336, 'support': 306402}, '1': {'precision': 0.5294891596590584, 'recall': 0.024920373805607084, 'f1-score': 0.04760043609734022, 'support': 371423}, '2': {'precision': 0.36791289478760086, 'recall': 0.5451993731051847, 'f1-score': 0.43934549265976097, 'support': 311376}, 'accuracy': 0.36556877722525555, 'macro avg': {'precision': 0.4184119867726333, 'recall': 0.3886928835244335, 'f1-score': 0.31137235153771153, 'support': 989201}, 'weighted avg': {'precision': 0.42545925661436895, 'recall': 0.36556877722525555, 'f1-score': 0.29467789276754514, 'support': 989201}}
[[182603   4638 119161]
 [189671   9256 172496]
 [138027   3587 169762]]
testing model out of sample: results/universal/W7/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 81s - 81s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1034172
{'0': {'precision': 0.3313517903941871, 'recall': 0.6260305310702675, 'f1-score': 0.43334064701393915, 'support': 1023744}, '1': {'precision': 0.5598376326768947, 'recall': 0.03478306155074068, 'f1-score': 0.06549676802323563, 'support': 1708964}, '2': {'precision': 0.3420436882704924, 'recall': 0.5694138137296225, 'f1-score': 0.42736913256592557, 'support': 1041529}, 'accuracy': 0.34269151619254434, 'macro avg': {'precision': 0.4110777037805247, 'recall': 0.4100758021168769, 'f1-score': 0.3087355158677001, 'support': 3774237}, 'weighted avg': {'precision': 0.43776005269303997, 'recall': 0.34269151619254434, 'f1-score': 0.2651340790938552, 'support': 3774237}}
[[640895  26267 356582]
 [865289  59443 784232]
 [427999  20469 593061]]
Evaluating performance on  train set...
5285/5285 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0958068
{'0': {'precision': 0.36331478321598293, 'recall': 0.603500212030669, 'f1-score': 0.4535729168097665, 'support': 410318}, '1': {'precision': 0.5246583481877599, 'recall': 0.03454899798030989, 'f1-score': 0.06482897743064965, 'support': 536716}, '2': {'precision': 0.36271843377341245, 'recall': 0.5685013744899594, 'f1-score': 0.4428727274124096, 'support': 405605}, 'accuracy': 0.3672502419344703, 'macro avg': {'precision': 0.4168971883923851, 'recall': 0.40218352816697944, 'f1-score': 0.32042487388427526, 'support': 1352639}, 'weighted avg': {'precision': 0.427155756677297, 'recall': 0.3672502419344703, 'f1-score': 0.29611394772169713, 'support': 1352639}}
[[247627   9235 153456]
 [266497  18543 251676]
 [167453   7565 230587]]
Evaluating performance on  val set...
1714/1714 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0980767
{'0': {'precision': 0.3542322349352343, 'recall': 0.5991146511211042, 'f1-score': 0.4452224577498234, 'support': 128311}, '1': {'precision': 0.5311124034227798, 'recall': 0.035401611429520724, 'f1-score': 0.06637871063533761, 'support': 180585}, '2': {'precision': 0.3544819864006776, 'recall': 0.5736632206605491, 'f1-score': 0.43819280956831386, 'support': 129135}, 'accuracy': 0.35921201924064733, 'macro avg': {'precision': 0.4132755415862306, 'recall': 0.4027264944037247, 'f1-score': 0.3165979926511583, 'support': 438031}, 'weighted avg': {'precision': 0.4272274267865266, 'recall': 0.35921201924064733, 'f1-score': 0.28696591496954377, 'support': 438031}}
[[76873  3152 48286]
 [87577  6393 86615]
 [52563  2492 74080]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
695/695 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1177704
{'0': {'precision': 0.31519337566432454, 'recall': 0.5864597607496018, 'f1-score': 0.4100207146556188, 'support': 54002}, '1': {'precision': 0.38031423290203326, 'recall': 0.012035858962546981, 'f1-score': 0.023333286080830132, 'support': 68379}, '2': {'precision': 0.33922712116582754, 'recall': 0.45979329468111924, 'f1-score': 0.39041394335511986, 'support': 55538}, 'accuracy': 0.3261540363873448, 'macro avg': {'precision': 0.34491157657739513, 'recall': 0.3527629714644227, 'f1-score': 0.2745893146971896, 'support': 177919}, 'weighted avg': {'precision': 0.3477232642918447, 'recall': 0.3261540363873448, 'f1-score': 0.2552861413778768, 'support': 177919}}
[[31670   599 21733]
 [39548   823 28008]
 [29260   742 25536]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.105633
{'0': {'precision': 0.36410936808970057, 'recall': 0.5688968376554752, 'f1-score': 0.44402848939579004, 'support': 24602}, '1': {'precision': 0.36691542288557216, 'recall': 0.012339998326779887, 'f1-score': 0.02387697288547147, 'support': 23906}, '2': {'precision': 0.35663033189826265, 'recall': 0.49731755088137614, 'f1-score': 0.4153848889521134, 'support': 23486}, 'accuracy': 0.3607383948662389, 'macro avg': {'precision': 0.3625517076245118, 'recall': 0.3595181289545437, 'f1-score': 0.29443011707779165, 'support': 71994}, 'weighted avg': {'precision': 0.3626013105009848, 'recall': 0.3607383948662389, 'f1-score': 0.2951707268917499, 'support': 71994}}
[[13996   296 10310]
 [12850   295 10761]
 [11593   213 11680]]
Evaluating performance on  val set...
73/73 - 1s - 556ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017191
{'0': {'precision': 0.3722260352322123, 'recall': 0.5132492113564668, 'f1-score': 0.4315077575918313, 'support': 6340}, '1': {'precision': 0.3287671232876712, 'recall': 0.025513819985825654, 'f1-score': 0.04735284445905952, 'support': 5644}, '2': {'precision': 0.37875214408233276, 'recall': 0.5415389331698345, 'f1-score': 0.44574817057784505, 'support': 6524}, 'accuracy': 0.37448670845039983, 'macro avg': {'precision': 0.35991510086740547, 'recall': 0.3601006548373757, 'f1-score': 0.3082029242095786, 'support': 18508}, 'weighted avg': {'precision': 0.3612737030041594, 'recall': 0.37448670845039983, 'f1-score': 0.3193797115900694, 'support': 18508}}
[[3254  163 2923]
 [2628  144 2872]
 [2860  131 3533]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
2006/2006 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1046138
{'0': {'precision': 0.2885708726950431, 'recall': 0.7269905239080711, 'f1-score': 0.41314742885439715, 'support': 110172}, '1': {'precision': 0.6724471000494182, 'recall': 0.050463231426914626, 'f1-score': 0.09388122469588016, 'support': 296612}, '2': {'precision': 0.31911555322417473, 'recall': 0.6395190583906665, 'f1-score': 0.42577323130856454, 'support': 106541}, 'accuracy': 0.3179213948278381, 'macro avg': {'precision': 0.42671117532287867, 'recall': 0.47232427124188403, 'f1-score': 0.3109339616196139, 'support': 513325}, 'weighted avg': {'precision': 0.5167237122339126, 'recall': 0.3179213948278381, 'f1-score': 0.23128794075505152, 'support': 513325}}
[[ 80094   5040  25038]
 [161305  14968 120339]
 [ 36155   2251  68135]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1025782
{'0': {'precision': 0.3061028491603853, 'recall': 0.6907240190444919, 'f1-score': 0.4242112586587616, 'support': 30455}, '1': {'precision': 0.666969476744186, 'recall': 0.04699782358212777, 'f1-score': 0.08780826177434402, 'support': 78110}, '2': {'precision': 0.30460124152964035, 'recall': 0.665654124956852, 'f1-score': 0.417949912764551, 'support': 28970}, 'accuracy': 0.31985312829461593, 'macro avg': {'precision': 0.4258911891447372, 'recall': 0.46779198919449055, 'f1-score': 0.3099898110658856, 'support': 137535}, 'weighted avg': {'precision': 0.5107328757536742, 'recall': 0.31985312829461593, 'f1-score': 0.23183964941604418, 'support': 137535}}
[[21036  1329  8090]
 [38504  3671 35935]
 [ 9182   504 19284]]
Evaluating performance on  val set...
153/153 - 1s - 971ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0945574
{'0': {'precision': 0.3205220061412487, 'recall': 0.6874108220831961, 'f1-score': 0.43719241911277096, 'support': 9111}, '1': {'precision': 0.6438679245283019, 'recall': 0.0525328330206379, 'f1-score': 0.09714006137970911, 'support': 20787}, '2': {'precision': 0.3289547546873246, 'recall': 0.6402972027972028, 'f1-score': 0.43462137506489656, 'support': 9152}, 'accuracy': 0.3384122919334187, 'macro avg': {'precision': 0.43111489511895834, 'recall': 0.46008028596701234, 'f1-score': 0.3229846185191256, 'support': 39050}, 'weighted avg': {'precision': 0.49462106171628994, 'recall': 0.3384122919334187, 'f1-score': 0.2555740182082049, 'support': 39050}}
[[ 6263   421  2427]
 [10168  1092  9527]
 [ 3109   183  5860]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0950195
{'0': {'precision': 0.36045371907359103, 'recall': 0.6334703970216431, 'f1-score': 0.45946517813960985, 'support': 71986}, '1': {'precision': 0.40426364169763346, 'recall': 0.022804249732461028, 'f1-score': 0.0431731311485682, 'support': 90641}, '2': {'precision': 0.3838896883847362, 'recall': 0.5419250328628523, 'f1-score': 0.4494191488190277, 'support': 75313}, 'accuracy': 0.37186685719088847, 'macro avg': {'precision': 0.3828690163853203, 'recall': 0.3993998932056521, 'f1-score': 0.3173524860357353, 'support': 237940}, 'weighted avg': {'precision': 0.3845606718906714, 'recall': 0.37186685719088847, 'f1-score': 0.29770286815584923, 'support': 237940}}
[[45601  1660 24725]
 [47796  2067 40778]
 [33113  1386 40814]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851115
{'0': {'precision': 0.39493978884856484, 'recall': 0.5911967157452851, 'f1-score': 0.4735391195777138, 'support': 32397}, '1': {'precision': 0.43765281173594134, 'recall': 0.022071516646115907, 'f1-score': 0.04202371170325156, 'support': 32440}, '2': {'precision': 0.39936270785852956, 'recall': 0.5790472110883333, 'f1-score': 0.4727054738919209, 'support': 32683}, 'accuracy': 0.39780557834290403, 'macro avg': {'precision': 0.4106517694810119, 'recall': 0.3974384811599115, 'f1-score': 0.3294227683909621, 'support': 97520}, 'weighted avg': {'precision': 0.410630567401366, 'recall': 0.39780557834290403, 'f1-score': 0.329716253771763, 'support': 97520}}
[[19153   528 12716]
 [15977   716 15747]
 [13366   392 18925]]
Evaluating performance on  val set...
114/114 - 1s - 746ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0839168
{'0': {'precision': 0.39755069791941006, 'recall': 0.6301398455437278, 'f1-score': 0.487525232135648, 'support': 9582}, '1': {'precision': 0.3542319749216301, 'recall': 0.011786794617711484, 'f1-score': 0.02281445588532203, 'support': 9587}, '2': {'precision': 0.41503316138540897, 'recall': 0.5684295518772708, 'f1-score': 0.47976829372178204, 'support': 9908}, 'accuracy': 0.4052343776868315, 'macro avg': {'precision': 0.3889386114088164, 'recall': 0.4034520640129034, 'f1-score': 0.3300359939142507, 'support': 29077}, 'weighted avg': {'precision': 0.3892252052840419, 'recall': 0.4052343776868315, 'f1-score': 0.3316619051859469, 'support': 29077}}
[[6038  102 3442]
 [4978  113 4496]
 [4172  104 5632]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.090023
{'0': {'precision': 0.37141553147215584, 'recall': 0.5620800262227529, 'f1-score': 0.44727636880225435, 'support': 85422}, '1': {'precision': 0.3897814589362339, 'recall': 0.04100184749748068, 'f1-score': 0.07419860378971363, 'support': 95264}, '2': {'precision': 0.3978491393553426, 'recall': 0.5773070049256789, 'f1-score': 0.47106526765072027, 'support': 91764}, 'accuracy': 0.3850100935951551, 'macro avg': {'precision': 0.3863487099212441, 'recall': 0.39346295954863747, 'f1-score': 0.3308467467475627, 'support': 272450}, 'weighted avg': {'precision': 0.38674041790170505, 'recall': 0.3850100935951551, 'f1-score': 0.32483953381519604, 'support': 272450}}
[[48014  3319 34089]
 [45267  3906 46091]
 [35992  2796 52976]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0880768
{'0': {'precision': 0.39452545095885955, 'recall': 0.5450356801708153, 'f1-score': 0.4577252940413133, 'support': 35594}, '1': {'precision': 0.45544554455445546, 'recall': 0.06928529238038984, 'f1-score': 0.1202737689369665, 'support': 33860}, '2': {'precision': 0.3776600149043637, 'recall': 0.5498824522273796, 'f1-score': 0.4477824411555359, 'support': 33178}, 'accuracy': 0.3896445553043885, 'macro avg': {'precision': 0.40921033680589286, 'recall': 0.3880678082595283, 'f1-score': 0.3419271680446052, 'support': 102632}, 'weighted avg': {'precision': 0.40917188610316946, 'recall': 0.3896445553043885, 'f1-score': 0.3431801949194263, 'support': 102632}}
[[19400  1569 14625]
 [16075  2346 15439]
 [13698  1236 18244]]
Evaluating performance on  val set...
123/123 - 1s - 777ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934544
{'0': {'precision': 0.3761881966764686, 'recall': 0.5522537897801425, 'f1-score': 0.44752684672958015, 'support': 9961}, '1': {'precision': 0.3394736842105263, 'recall': 0.024245841556244714, 'f1-score': 0.04525918779054469, 'support': 10641}, '2': {'precision': 0.3917364670583823, 'recall': 0.581408293904815, 'f1-score': 0.4680882847219629, 'support': 10779}, 'accuracy': 0.38322551862592014, 'macro avg': {'precision': 0.3691327826484591, 'recall': 0.38596930841373406, 'f1-score': 0.32029143974736257, 'support': 31381}, 'weighted avg': {'precision': 0.3690792989133812, 'recall': 0.38322551862592014, 'f1-score': 0.3181843012832788, 'support': 31381}}
[[5501  269 4191]
 [4843  258 5540]
 [4279  233 6267]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
1646/1646 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1095923
{'0': {'precision': 0.330901308646719, 'recall': 0.6072646769432601, 'f1-score': 0.42837766318949394, 'support': 121960}, '1': {'precision': 0.4609429978888107, 'recall': 0.02305418025670507, 'f1-score': 0.043912086438651576, 'support': 170468}, '2': {'precision': 0.3506602799904729, 'recall': 0.5141712973023314, 'f1-score': 0.4169585288259117, 'support': 128852}, 'accuracy': 0.34239460691226736, 'macro avg': {'precision': 0.3808348621753342, 'recall': 0.3814967181674322, 'f1-score': 0.29641609281801906, 'support': 421280}, 'weighted avg': {'precision': 0.3895652130744304, 'recall': 0.34239460691226736, 'f1-score': 0.2693137241499504, 'support': 421280}}
[[74062  2310 45588]
 [89443  3930 77095]
 [60314  2286 66252]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0961959
{'0': {'precision': 0.38187032983621405, 'recall': 0.5570922063908036, 'f1-score': 0.45313199706235335, 'support': 45409}, '1': {'precision': 0.377529658060014, 'recall': 0.024351270452141426, 'f1-score': 0.04575149580329394, 'support': 44433}, '2': {'precision': 0.3775500855118495, 'recall': 0.5524275532318967, 'f1-score': 0.44854641933874556, 'support': 44757}, 'accuracy': 0.3796759262698831, 'macro avg': {'precision': 0.3789833578026925, 'recall': 0.37795701002494725, 'f1-score': 0.3158099707347976, 'support': 134599}, 'weighted avg': {'precision': 0.3790008416211643, 'recall': 0.3796759262698831, 'f1-score': 0.31712523241611307, 'support': 134599}}
[[25297   986 19126]
 [21714  1082 21637]
 [19234   798 24725]]
Evaluating performance on  val set...
146/146 - 1s - 890ms/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.100247
{'0': {'precision': 0.3650021853146853, 'recall': 0.5497408047395704, 'f1-score': 0.4387168795350822, 'support': 12153}, '1': {'precision': 0.49193548387096775, 'recall': 0.034037465125548026, 'f1-score': 0.06366957429359575, 'support': 12545}, '2': {'precision': 0.3756878714505833, 'recall': 0.5398544994464652, 'f1-score': 0.4430527613732234, 'support': 12646}, 'accuracy': 0.37315231362467866, 'macro avg': {'precision': 0.41087518021207875, 'recall': 0.3745442564371946, 'f1-score': 0.31514640506730046, 'support': 37344}, 'weighted avg': {'precision': 0.4112615420323141, 'recall': 0.3731523136246786, 'f1-score': 0.31419521922742066, 'support': 37344}}
[[6681  230 5242]
 [6015  427 6103]
 [5608  211 6827]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/EXC
Evaluating performance on  test set...
5928/5928 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0799617
{'0': {'precision': 0.34402426023568733, 'recall': 0.6898453343193728, 'f1-score': 0.45909761166426033, 'support': 346166}, '1': {'precision': 0.7112742437658888, 'recall': 0.08981187152248453, 'f1-score': 0.1594856527387412, 'support': 831772}, '2': {'precision': 0.33826790330191636, 'recall': 0.7155198304036746, 'f1-score': 0.4593665024937833, 'support': 339630}, 'accuracy': 0.36671569247638325, 'macro avg': {'precision': 0.46452213576783086, 'recall': 0.4983923454151773, 'f1-score': 0.359316588965595, 'support': 1517568}, 'weighted avg': {'precision': 0.544024011018167, 'recall': 0.36671569247638325, 'f1-score': 0.2949418605499999, 'support': 1517568}}
[[238801  17991  89374]
 [371054  74703 386015]
 [ 84285  12333 243012]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0810899
{'0': {'precision': 0.3631099805877234, 'recall': 0.6619522374217482, 'f1-score': 0.46896951201061654, 'support': 81947}, '1': {'precision': 0.6796861171750546, 'recall': 0.07394569612940496, 'f1-score': 0.13338041785584032, 'support': 155790}, '2': {'precision': 0.3559404243760792, 'recall': 0.6612839274772014, 'f1-score': 0.46278420556975647, 'support': 83229}, 'accuracy': 0.37637319840730793, 'macro avg': {'precision': 0.466245507379619, 'recall': 0.46572728700945154, 'f1-score': 0.35504471181207115, 'support': 320966}, 'weighted avg': {'precision': 0.5149101130783964, 'recall': 0.37637319840730793, 'f1-score': 0.3044778778557872, 'support': 320966}}
[[54245  3196 24506]
 [69187 11520 75083]
 [25958  2233 55038]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0826137
{'0': {'precision': 0.34869233143033485, 'recall': 0.6627442354925034, 'f1-score': 0.4569615933878449, 'support': 27279}, '1': {'precision': 0.6848958333333334, 'recall': 0.08231157259103797, 'f1-score': 0.14696118068566547, 'support': 54318}, '2': {'precision': 0.35211960263597913, 'recall': 0.6482219164192077, 'f1-score': 0.4563474359137784, 'support': 27614}, 'accuracy': 0.37038393568413436, 'macro avg': {'precision': 0.4619025891332158, 'recall': 0.464425908167583, 'f1-score': 0.3534234033290962, 'support': 109211}, 'weighted avg': {'precision': 0.5167756058572673, 'recall': 0.37038393568413436, 'f1-score': 0.3026221792111974, 'support': 109211}}
[[18079  1209  7991]
 [24903  4471 24944]
 [ 8866   848 17900]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/AAL
Evaluating performance on  test set...
5331/5331 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1200238
{'0': {'precision': 0.27624704457643734, 'recall': 0.6396026516592899, 'f1-score': 0.38584571889982744, 'support': 299586}, '1': {'precision': 0.6776861270194033, 'recall': 0.04168539768918333, 'f1-score': 0.0785397106861854, 'support': 760770}, '2': {'precision': 0.2902021100189854, 'recall': 0.5953557166099689, 'f1-score': 0.3902026044527741, 'support': 304245}, 'accuracy': 0.296396529095318, 'macro avg': {'precision': 0.41471176053827535, 'recall': 0.4255479219861473, 'f1-score': 0.28486267801292897, 'support': 1364601}, 'weighted avg': {'precision': 0.5031621425689665, 'recall': 0.296396529095318, 'f1-score': 0.2154928969220946, 'support': 1364601}}
[[191616   9369  98601]
 [384627  31713 344430]
 [117397   5714 181134]]
Evaluating performance on  train set...
2013/2013 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1074569
{'0': {'precision': 0.31942217521994415, 'recall': 0.6474312187401563, 'f1-score': 0.42778747944037204, 'support': 130159}, '1': {'precision': 0.6334254870984729, 'recall': 0.03733694429140121, 'f1-score': 0.07051728307306743, 'support': 257734}, '2': {'precision': 0.3211624157324768, 'recall': 0.5956112606638047, 'f1-score': 0.41730681462011776, 'support': 127417}, 'accuracy': 0.3294774019522229, 'macro avg': {'precision': 0.42467002601696463, 'recall': 0.4267931412317874, 'f1-score': 0.3052038590445191, 'support': 515310}, 'weighted avg': {'precision': 0.47690226644481093, 'recall': 0.3294774019522229, 'f1-score': 0.24650613100946012, 'support': 515310}}
[[ 84269   3166  42724]
 [130425   9623 117686]
 [ 49123   2403  75891]]
Evaluating performance on  val set...
696/696 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1084322
{'0': {'precision': 0.313618230896018, 'recall': 0.6127744976780005, 'f1-score': 0.4148937010673345, 'support': 42851}, '1': {'precision': 0.6032103632779499, 'recall': 0.0460942543576501, 'f1-score': 0.0856440295076068, 'support': 92940}, '2': {'precision': 0.30443967348250883, 'recall': 0.6292894774312972, 'f1-score': 0.41035600708764386, 'support': 42138}, 'accuracy': 0.32068409309331253, 'macro avg': {'precision': 0.40708942255215885, 'recall': 0.4293860764889826, 'f1-score': 0.3036312458875284, 'support': 177929}, 'weighted avg': {'precision': 0.4627109967255696, 'recall': 0.32068409309331253, 'f1-score': 0.24183774153472712, 'support': 177929}}
[[26258  1608 14985]
 [43057  4284 45599]
 [14411  1210 26517]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/WBA
Evaluating performance on  test set...
4192/4192 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0860864
{'0': {'precision': 0.3735326682395497, 'recall': 0.5961071760065867, 'f1-score': 0.4592746581770233, 'support': 324289}, '1': {'precision': 0.5424502765682006, 'recall': 0.05446720410666553, 'f1-score': 0.0989944201270613, 'support': 423117}, '2': {'precision': 0.37467820610010155, 'recall': 0.5902332849305733, 'f1-score': 0.4583789299516735, 'support': 325739}, 'accuracy': 0.3807677434083931, 'macro avg': {'precision': 0.4302203836359506, 'recall': 0.4136025550146085, 'f1-score': 0.338882669418586, 'support': 1073145}, 'weighted avg': {'precision': 0.4404808048290619, 'recall': 0.3807677434083931, 'f1-score': 0.3169523558792136, 'support': 1073145}}
[[193311  10711 120267]
 [199461  23046 200610]
 [124749   8728 192262]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0804396
{'0': {'precision': 0.4047849156111392, 'recall': 0.595955598273685, 'f1-score': 0.48211066347007775, 'support': 106122}, '1': {'precision': 0.4623059866962306, 'recall': 0.03609209109093707, 'f1-score': 0.06695687855702842, 'support': 103984}, '2': {'precision': 0.40036410024716296, 'recall': 0.5751949675929019, 'f1-score': 0.47211373100533166, 'support': 104761}, 'accuracy': 0.40415477010928424, 'macro avg': {'precision': 0.4224850008515109, 'recall': 0.4024142189858413, 'f1-score': 0.3403937576774793, 'support': 314867}, 'weighted avg': {'precision': 0.422310226353029, 'recall': 0.40415477010928424, 'f1-score': 0.3416810858632222, 'support': 314867}}
[[63244  2414 40464]
 [50445  3753 49786]
 [42552  1951 60258]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830145
{'0': {'precision': 0.3929131449114621, 'recall': 0.6003681626928471, 'f1-score': 0.47497630550868025, 'support': 34224}, '1': {'precision': 0.47555233611010506, 'recall': 0.03878075434917447, 'f1-score': 0.07171336501174284, 'support': 33857}, '2': {'precision': 0.40222504767959316, 'recall': 0.5555848261327714, 'f1-score': 0.4666273323991445, 'support': 34164}, 'accuracy': 0.3994425155264316, 'macro avg': {'precision': 0.4235635095670534, 'recall': 0.3982445810582644, 'f1-score': 0.3377723343065225, 'support': 102245}, 'weighted avg': {'precision': 0.4233894219184834, 'recall': 0.3994425155264316, 'f1-score': 0.3386517156146122, 'support': 102245}}
[[20547   773 12904]
 [17239  1313 15305]
 [14508   675 18981]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
6143/6143 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869756
{'0': {'precision': 0.3771633571275708, 'recall': 0.6254404569412654, 'f1-score': 0.4705611909973718, 'support': 476210}, '1': {'precision': 0.4784400395975781, 'recall': 0.0335894592908425, 'f1-score': 0.06277193899203043, 'support': 618706}, '2': {'precision': 0.37740761428940467, 'recall': 0.5842883196777091, 'f1-score': 0.45859580559330915, 'support': 477581}, 'accuracy': 0.38007576485042577, 'macro avg': {'precision': 0.4110036703381845, 'recall': 0.414439411969939, 'f1-score': 0.33064297852757046, 'support': 1572497}, 'weighted avg': {'precision': 0.41708530526730914, 'recall': 0.38007576485042577, 'f1-score': 0.30648068866390193, 'support': 1572497}}
[[297841  12147 166222]
 [303818  20782 294106]
 [188028  10508 279045]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0851237
{'0': {'precision': 0.3963694748772195, 'recall': 0.5902582826538247, 'f1-score': 0.47426268671559113, 'support': 177751}, '1': {'precision': 0.46144891810462885, 'recall': 0.03781642284361094, 'f1-score': 0.0699041009921839, 'support': 178203}, '2': {'precision': 0.3919231859856958, 'recall': 0.5613949972357302, 'f1-score': 0.46159555075213254, 'support': 177262}, 'accuracy': 0.39603462761807595, 'macro avg': {'precision': 0.4165805263225147, 'recall': 0.39648990091105524, 'f1-score': 0.33525411281996914, 'support': 533216}, 'weighted avg': {'precision': 0.4166411733258121, 'recall': 0.39603462761807595, 'f1-score': 0.33491331440338945, 'support': 533216}}
[[104919   4168  68664]
 [ 85730   6739  85734]
 [ 74051   3697  99514]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0892123
{'0': {'precision': 0.3812074643249177, 'recall': 0.6051755685283611, 'f1-score': 0.46776442064855034, 'support': 57385}, '1': {'precision': 0.4337984496124031, 'recall': 0.023367686114683726, 'f1-score': 0.04434653057343012, 'support': 59869}, '2': {'precision': 0.3905724322184841, 'recall': 0.5451924239023463, 'f1-score': 0.45510820295891674, 'support': 57919}, 'accuracy': 0.3864979191998767, 'macro avg': {'precision': 0.40185944871860163, 'recall': 0.3912452261817971, 'f1-score': 0.32240638472696576, 'support': 175173}, 'weighted avg': {'precision': 0.4022779447848284, 'recall': 0.3864979191998767, 'f1-score': 0.31886795182474037, 'support': 175173}}
[[34728   987 21670]
 [30869  1399 27601]
 [25503   839 31577]]
testing model on single stock: results/universal/W7/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
23942/23942 - 153s - 153s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1280411
{'0': {'precision': 0.29473485185300513, 'recall': 0.5686957297324416, 'f1-score': 0.3882522931822756, 'support': 1614489}, '1': {'precision': 0.4487141714718633, 'recall': 0.0036750042830811574, 'f1-score': 0.007290300433410789, 'support': 2900949}, '2': {'precision': 0.2937075706402124, 'recall': 0.5442541959976971, 'f1-score': 0.38152475227738847, 'support': 1613621}, 'accuracy': 0.2948305767655361, 'macro avg': {'precision': 0.34571886465502694, 'recall': 0.3722083100044067, 'f1-score': 0.2590224486310249, 'support': 6129059}, 'weighted avg': {'precision': 0.36734444995462884, 'recall': 0.2948305767655361, 'f1-score': 0.20616773286309586, 'support': 6129059}}
[[ 918153    6634  689702]
 [1468093   10661 1422195]
 [ 728937    6464  878220]]
Evaluating performance on  train set...
9052/9052 - 45s - 45s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0944371
{'0': {'precision': 0.3784920345289782, 'recall': 0.5705501522452479, 'f1-score': 0.45508764717430966, 'support': 778021}, '1': {'precision': 0.36998489172402216, 'recall': 0.008567718929061049, 'f1-score': 0.016747614313485856, 'support': 771734}, '2': {'precision': 0.37636441923126435, 'recall': 0.5524857198337597, 'f1-score': 0.4477276975769359, 'support': 767323}, 'accuracy': 0.3773921292248254, 'macro avg': {'precision': 0.3749471151614216, 'recall': 0.37720119700268956, 'f1-score': 0.3065209863549105, 'support': 2317078}, 'weighted avg': {'precision': 0.374954035593022, 'recall': 0.3773921292248254, 'f1-score': 0.3066552829963577, 'support': 2317078}}
[[443900   6095 328026]
 [390688   6612 374434]
 [338224   5164 423935]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102025
{'0': {'precision': 0.35579438021327553, 'recall': 0.5861035217223804, 'f1-score': 0.4427918117738369, 'support': 225827}, '1': {'precision': 0.35342077277561146, 'recall': 0.007918354380112779, 'f1-score': 0.01548966449417778, 'support': 251820}, '2': {'precision': 0.3663840565422474, 'recall': 0.525909251220245, 'f1-score': 0.43188660759620406, 'support': 229667}, 'accuracy': 0.36071108446884975, 'macro avg': {'precision': 0.35853306984371147, 'recall': 0.37331037577424614, 'f1-score': 0.29672269462140627, 'support': 707314}, 'weighted avg': {'precision': 0.35838782155402865, 'recall': 0.36071108446884975, 'f1-score': 0.2871214980859583, 'support': 707314}}
[[132358   1945  91524]
 [132469   1994 117357]
 [107180   1703 120784]]
training model: results/universal/W7/deepOF_L1/h100
Epoch 1/50
12475/12475 - 173s - loss: 3.2631 - accuracy100: 0.3843 - val_loss: 3.3483 - val_accuracy100: 0.3664 - 173s/epoch - 14ms/step
Epoch 2/50
12475/12475 - 170s - loss: 3.2573 - accuracy100: 0.3871 - val_loss: 3.3524 - val_accuracy100: 0.3668 - 170s/epoch - 14ms/step
Epoch 3/50
12475/12475 - 168s - loss: 3.2545 - accuracy100: 0.3889 - val_loss: 3.3581 - val_accuracy100: 0.3667 - 168s/epoch - 13ms/step
Epoch 4/50
12475/12475 - 169s - loss: 3.2523 - accuracy100: 0.3902 - val_loss: 3.3630 - val_accuracy100: 0.3659 - 169s/epoch - 14ms/step
Epoch 5/50
12475/12475 - 163s - loss: 3.2504 - accuracy100: 0.3911 - val_loss: 3.3636 - val_accuracy100: 0.3659 - 163s/epoch - 13ms/step
Epoch 6/50
12475/12475 - 170s - loss: 3.2484 - accuracy100: 0.3925 - val_loss: 3.3619 - val_accuracy100: 0.3654 - 170s/epoch - 14ms/step
Epoch 7/50
12475/12475 - 171s - loss: 3.2474 - accuracy100: 0.3931 - val_loss: 3.3634 - val_accuracy100: 0.3643 - 171s/epoch - 14ms/step
Epoch 8/50
12475/12475 - 165s - loss: 3.2460 - accuracy100: 0.3937 - val_loss: 3.3575 - val_accuracy100: 0.3651 - 165s/epoch - 13ms/step
Epoch 9/50
12475/12475 - 169s - loss: 3.2448 - accuracy100: 0.3944 - val_loss: 3.3625 - val_accuracy100: 0.3649 - 169s/epoch - 14ms/step
Epoch 10/50
12475/12475 - 165s - loss: 3.2438 - accuracy100: 0.3947 - val_loss: 3.3631 - val_accuracy100: 0.3648 - 165s/epoch - 13ms/step
Epoch 11/50
12475/12475 - 171s - loss: 3.2426 - accuracy100: 0.3954 - val_loss: 3.3642 - val_accuracy100: 0.3648 - 171s/epoch - 14ms/step
testing model in sample: results/universal/W7/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 190s - 190s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.144798
{'0': {'precision': 0.33433815950673157, 'recall': 0.6126649767446481, 'f1-score': 0.4326010609212314, 'support': 2818276}, '1': {'precision': 0.5205338809034907, 'recall': 0.00013075138462363716, 'f1-score': 0.00026143709962609855, 'support': 3877588}, '2': {'precision': 0.34105831023896793, 'recall': 0.5268384369339887, 'f1-score': 0.4140645247373825, 'support': 2809683}, 'accuracy': 0.33742561054087683, 'macro avg': {'precision': 0.39864345021639674, 'recall': 0.3798780550210868, 'f1-score': 0.28230900758607996, 'support': 9505547}, 'weighted avg': {'precision': 0.41227915419217354, 'recall': 0.33742561054087683, 'f1-score': 0.25075810881654814, 'support': 9505547}}
[[1726659     257 1091360]
 [2108526     507 1768555]
 [1329224     210 1480249]]
Evaluating performance on  train set...
12475/12475 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.113067
{'0': {'precision': 0.3698659962070046, 'recall': 0.6145734886238393, 'f1-score': 0.4618056043360129, 'support': 1069737}, '1': {'precision': 0.47249190938511326, 'recall': 0.00013704789448438546, 'f1-score': 0.0002740163096008934, 'support': 1065321}, '2': {'precision': 0.37524323774343205, 'recall': 0.5019517589459557, 'f1-score': 0.4294461412314388, 'support': 1058020}, 'accuracy': 0.37225930591109896, 'macro avg': {'precision': 0.4058670477785166, 'recall': 0.3722207651547598, 'f1-score': 0.29717525395901756, 'support': 3193078}, 'weighted avg': {'precision': 0.40588728022925114, 'recall': 0.37225930591109896, 'f1-score': 0.2971004978394642, 'support': 3193078}}
[[657432     81 412224]
 [593192    146 471983]
 [526863     82 531075]]
Evaluating performance on  val set...
3866/3866 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1160123
{'0': {'precision': 0.3571689899627247, 'recall': 0.6238130811117834, 'f1-score': 0.4542523144427748, 'support': 323948}, '1': {'precision': 0.36923076923076925, 'recall': 7.223476297968398e-05, 'f1-score': 0.00014444126807396597, 'support': 332250}, '2': {'precision': 0.37824233190423884, 'recall': 0.4808575298120437, 'f1-score': 0.4234214938097277, 'support': 333003}, 'accuracy': 0.366188469279752, 'macro avg': {'precision': 0.36821403036591094, 'recall': 0.36824761522893557, 'f1-score': 0.2926060831735255, 'support': 989201}, 'weighted avg': {'precision': 0.3683143610737101, 'recall': 0.366188469279752, 'f1-score': 0.2913490251966449, 'support': 989201}}
[[202083     21 121844]
 [190852     24 141374]
 [172856     20 160127]]
testing model out of sample: results/universal/W7/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 97s - 97s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1449329
{'0': {'precision': 0.3283841680049225, 'recall': 0.6327841441467899, 'f1-score': 0.4323827410355818, 'support': 1089667}, '1': {'precision': 0.47068403908794787, 'recall': 0.000185010678124952, 'f1-score': 0.0003698759699645355, 'support': 1562072}, '2': {'precision': 0.3450365170636995, 'recall': 0.5145202931319254, 'f1-score': 0.4130693580577412, 'support': 1122498}, 'accuracy': 0.3357926383531294, 'macro avg': {'precision': 0.3813682413855233, 'recall': 0.3824964826522801, 'f1-score': 0.28194065835442916, 'support': 3774237}, 'weighted avg': {'precision': 0.3922314761459276, 'recall': 0.3357926383531294, 'f1-score': 0.24783830624660616, 'support': 3774237}}
[[689524    194 399949]
 [865405    289 696378]
 [544819    131 577548]]
Evaluating performance on  train set...
5285/5285 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1146545
{'0': {'precision': 0.3705145311852822, 'recall': 0.6143090100146069, 'f1-score': 0.4622359343098988, 'support': 447047}, '1': {'precision': 0.34972677595628415, 'recall': 0.00013816776589199167, 'f1-score': 0.00027622640206479234, 'support': 463205}, '2': {'precision': 0.37544109924303526, 'recall': 0.5187562021487974, 'f1-score': 0.4356139265254678, 'support': 442387}, 'accuracy': 0.37273803283803, 'macro avg': {'precision': 0.36522746879486717, 'recall': 0.3777344599764321, 'f1-score': 0.29937536241247714, 'support': 1352639}, 'weighted avg': {'precision': 0.36500711753131926, 'recall': 0.37273803283803, 'f1-score': 0.29533310461241163, 'support': 1352639}}
[[274625     64 172358]
 [253733     64 209408]
 [212841     55 229491]]
Evaluating performance on  val set...
1714/1714 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1204383
{'0': {'precision': 0.35949176304167524, 'recall': 0.6104141199682601, 'f1-score': 0.45249513796520524, 'support': 139887}, '1': {'precision': 0.3384615384615385, 'recall': 0.000141077188459886, 'f1-score': 0.0002820368186246859, 'support': 155943}, '2': {'precision': 0.37114034693847003, 'recall': 0.5231397810141982, 'f1-score': 0.4342225075881392, 'support': 142201}, 'accuracy': 0.36481892834068824, 'macro avg': {'precision': 0.35636454948056123, 'recall': 0.37789832605697277, 'f1-score': 0.2956665607906564, 'support': 438031}, 'weighted avg': {'precision': 0.3557863722520002, 'recall': 0.36481892834068824, 'f1-score': 0.28557121261665597, 'support': 438031}}
[[85389    23 54475]
 [84348    22 71573]
 [67790    20 74391]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
695/695 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1505879
{'0': {'precision': 0.3110143259653161, 'recall': 0.5910333515582286, 'f1-score': 0.4075612498943687, 'support': 53041}, '1': {'precision': 0.30303030303030304, 'recall': 0.00014013845679531378, 'f1-score': 0.0002801473575100503, 'support': 71358}, '2': {'precision': 0.32705928135945, 'recall': 0.4710949177877429, 'f1-score': 0.38608069826200136, 'support': 53520}, 'accuracy': 0.3179649166193605, 'macro avg': {'precision': 0.31370130345168973, 'recall': 0.3540894692675889, 'f1-score': 0.26464069850462674, 'support': 177919}, 'weighted avg': {'precision': 0.31263867246061666, 'recall': 0.3179649166193605, 'f1-score': 0.2377513699029712, 'support': 177919}}
[[31349    12 21680]
 [41151    10 30197]
 [28296    11 25213]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1182806
{'0': {'precision': 0.3622452769455518, 'recall': 0.5937259039811696, 'f1-score': 0.44996001722334994, 'support': 24641}, '1': {'precision': 0.4, 'recall': 0.0002516989680342311, 'f1-score': 0.0005030813734121495, 'support': 23838}, '2': {'precision': 0.35531147125854645, 'recall': 0.47735487986391667, 'f1-score': 0.4073892608924456, 'support': 23515}, 'accuracy': 0.3592104897630358, 'macro avg': {'precision': 0.3725189160680327, 'recall': 0.3571108276043735, 'f1-score': 0.28595078649640254, 'support': 71994}, 'weighted avg': {'precision': 0.37248152784759925, 'recall': 0.3592104897630358, 'f1-score': 0.2872352655508212, 'support': 71994}}
[[14630     3 10008]
 [13473     6 10359]
 [12284     6 11225]]
Evaluating performance on  val set...
73/73 - 1s - 686ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0941929
{'0': {'precision': 0.38000206803846553, 'recall': 0.5604697270093031, 'f1-score': 0.45292087749568655, 'support': 6557}, '1': {'precision': 0.2631578947368421, 'recall': 0.0009665571235260004, 'f1-score': 0.001926040061633282, 'support': 5173}, '2': {'precision': 0.39339986391471987, 'recall': 0.5118028917084686, 'f1-score': 0.44485765580918185, 'support': 6778}, 'accuracy': 0.386265398746488, 'macro avg': {'precision': 0.3455199422300092, 'recall': 0.3577463919470992, 'f1-score': 0.29990152445550056, 'support': 18508}, 'weighted avg': {'precision': 0.3522505741958004, 'recall': 0.386265398746488, 'f1-score': 0.3239145661364102, 'support': 18508}}
[[3675    6 2876]
 [2695    5 2473]
 [3301    8 3469]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
2006/2006 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1350847
{'0': {'precision': 0.36164519818968516, 'recall': 0.7067078741228837, 'f1-score': 0.47845139556000044, 'support': 154341}, '1': {'precision': 0.5142857142857142, 'recall': 0.00042640488565242316, 'f1-score': 0.0008521032749169201, 'support': 211067}, '2': {'precision': 0.38888179819896473, 'recall': 0.5561632537166113, 'f1-score': 0.4577173665088382, 'support': 147917}, 'accuracy': 0.37292163833828473, 'macro avg': {'precision': 0.4216042368914547, 'recall': 0.42109917757504917, 'f1-score': 0.3123402884479185, 'support': 513325}, 'weighted avg': {'precision': 0.4322556924660464, 'recall': 0.37292163833828473, 'f1-score': 0.2760993472477295, 'support': 513325}}
[[109074     58  45209]
 [126907     90  84070]
 [ 65624     27  82266]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1343677
{'0': {'precision': 0.3727869159128262, 'recall': 0.6698278552735829, 'f1-score': 0.478993905056228, 'support': 41651}, '1': {'precision': 0.4339622641509434, 'recall': 0.0004052863436123348, 'f1-score': 0.000809816382937521, 'support': 56750}, '2': {'precision': 0.37040052360199865, 'recall': 0.592911534726836, 'f1-score': 0.45595763286400665, 'support': 39134}, 'accuracy': 0.37172356127531175, 'macro avg': {'precision': 0.3923832345552561, 'recall': 0.4210482254480104, 'f1-score': 0.31192045143439073, 'support': 137535}, 'weighted avg': {'precision': 0.39735020479072075, 'recall': 0.37172356127531175, 'f1-score': 0.2751298085849325, 'support': 137535}}
[[27899    18 13734]
 [31021    23 25706]
 [15919    12 23203]]
Evaluating performance on  val set...
153/153 - 1s - 967ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1209213
{'0': {'precision': 0.37389852518319266, 'recall': 0.6663360608314737, 'f1-score': 0.479011318736817, 'support': 12099}, '1': {'precision': 0.3333333333333333, 'recall': 0.0004071937563624024, 'f1-score': 0.0008133938859892902, 'support': 14735}, '2': {'precision': 0.39427590154550657, 'recall': 0.5638506876227898, 'f1-score': 0.46405713130768705, 'support': 12216}, 'accuracy': 0.38299615877080667, 'macro avg': {'precision': 0.3671692533540109, 'recall': 0.41019798073687525, 'f1-score': 0.31462728131016443, 'support': 39050}, 'weighted avg': {'precision': 0.36496643626473807, 'recall': 0.38299615877080667, 'f1-score': 0.293891554938835, 'support': 39050}}
[[8062    7 4030]
 [8177    6 6552]
 [5323    5 6888]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1070126
{'0': {'precision': 0.36980937157535443, 'recall': 0.6714063034634833, 'f1-score': 0.4769277856795636, 'support': 78909}, '1': {'precision': 0.35, 'recall': 8.922198429693076e-05, 'f1-score': 0.00017839849125847395, 'support': 78456}, '2': {'precision': 0.40159734620788745, 'recall': 0.4717840521253491, 'f1-score': 0.4338705259313368, 'support': 80575}, 'accuracy': 0.38245355972093803, 'macro avg': {'precision': 0.37380223926108064, 'recall': 0.3810931925243764, 'f1-score': 0.30365890336738627, 'support': 237940}, 'weighted avg': {'precision': 0.3740421697585113, 'recall': 0.38245355972093803, 'f1-score': 0.30514839328879684, 'support': 237940}}
[[52980     8 25921]
 [47727     7 30722]
 [42556     5 38014]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1084657
{'0': {'precision': 0.3755810233538456, 'recall': 0.6151333025119433, 'f1-score': 0.46639558796036645, 'support': 32445}, '1': {'precision': 0.4375, 'recall': 0.00021710811984368216, 'f1-score': 0.000434000868001736, 'support': 32242}, '2': {'precision': 0.3844697396596416, 'recall': 0.5195078122620534, 'f1-score': 0.441902639964766, 'support': 32833}, 'accuracy': 0.3796349466776046, 'macro avg': {'precision': 0.3991835876711624, 'recall': 0.3782860742979468, 'f1-score': 0.3029107429310447, 'support': 97520}, 'weighted avg': {'precision': 0.3990452857358545, 'recall': 0.3796349466776046, 'f1-score': 0.3040933888979016, 'support': 97520}}
[[19958     6 12481]
 [17408     7 14827]
 [15773     3 17057]]
Evaluating performance on  val set...
114/114 - 1s - 778ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.105346
{'0': {'precision': 0.37578928378134585, 'recall': 0.6487749169435216, 'f1-score': 0.4759148547275428, 'support': 9632}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9304}, '2': {'precision': 0.3981362467866324, 'recall': 0.48870920027610687, 'f1-score': 0.43879764487139755, 'support': 10141}, 'accuracy': 0.38535612339649894, 'macro avg': {'precision': 0.25797517685599275, 'recall': 0.3791613724065428, 'f1-score': 0.30490416653298014, 'support': 29077}, 'weighted avg': {'precision': 0.2633387921740607, 'recall': 0.38535612339649894, 'f1-score': 0.3106874435937867, 'support': 29077}}
[[6249    0 3383]
 [5195    0 4109]
 [5185    0 4956]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1146731
{'0': {'precision': 0.3501505173410597, 'recall': 0.6212315927231569, 'f1-score': 0.4478661102091815, 'support': 84817}, '1': {'precision': 0.2857142857142857, 'recall': 2.129494564465124e-05, 'f1-score': 4.258671720290441e-05, 'support': 93919}, '2': {'precision': 0.3969269116610092, 'recall': 0.5165716968649294, 'f1-score': 0.4489141119086036, 'support': 93714}, 'accuracy': 0.3710882730776289, 'macro avg': {'precision': 0.3442639049054515, 'recall': 0.3792748615112436, 'f1-score': 0.29894093627832935, 'support': 272450}, 'weighted avg': {'precision': 0.3440276198521434, 'recall': 0.3710882730776289, 'f1-score': 0.2938528047528281, 'support': 272450}}
[[52691     1 32125]
 [52490     2 41427]
 [45300     4 48410]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1065896
{'0': {'precision': 0.3796413106481639, 'recall': 0.6251122838535819, 'f1-score': 0.4723913366284126, 'support': 35624}, '1': {'precision': 0.7, 'recall': 0.0006226280834914611, 'f1-score': 0.001244149534925055, 'support': 33728}, '2': {'precision': 0.3757509557618788, 'recall': 0.49615384615384617, 'f1-score': 0.42763907593494255, 'support': 33280}, 'accuracy': 0.37806921817756645, 'macro avg': {'precision': 0.4851307554700142, 'recall': 0.37396291936363985, 'f1-score': 0.3004248540327601, 'support': 102632}, 'weighted avg': {'precision': 0.48365942258053546, 'recall': 0.37806921817756645, 'f1-score': 0.3030464192325923, 'support': 102632}}
[[22269     9 13346]
 [19621    21 14086]
 [16768     0 16512]]
Evaluating performance on  val set...
123/123 - 1s - 796ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1130984
{'0': {'precision': 0.36177922159055415, 'recall': 0.5935225991595777, 'f1-score': 0.4495419965843814, 'support': 9757}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10595}, '2': {'precision': 0.39415820973198024, 'recall': 0.5493698431408106, 'f1-score': 0.4589977652361653, 'support': 11029}, 'accuracy': 0.377617029412702, 'macro avg': {'precision': 0.2519791437741781, 'recall': 0.3809641474334628, 'f1-score': 0.30284658727351554, 'support': 31381}, 'weighted avg': {'precision': 0.25101337625292525, 'recall': 0.377617029412702, 'f1-score': 0.3010887993838143, 'support': 31381}}
[[5791    1 3965]
 [5247    0 5348]
 [4969    1 6059]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
1646/1646 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1656231
{'0': {'precision': 0.2879119929619505, 'recall': 0.6621115095242827, 'f1-score': 0.4013160595949449, 'support': 110717}, '1': {'precision': 0.6428571428571429, 'recall': 0.00014285865458893744, 'f1-score': 0.0002856538298772746, 'support': 188998}, '2': {'precision': 0.31850535943632896, 'recall': 0.43655657467198616, 'f1-score': 0.36830252579054573, 'support': 121565}, 'accuracy': 0.30004747436384355, 'macro avg': {'precision': 0.4164248317518075, 'recall': 0.3662703142836192, 'f1-score': 0.2566347464051226, 'support': 421280}, 'weighted avg': {'precision': 0.4559783764488224, 'recall': 0.30004747436384355, 'f1-score': 0.21187617432690928, 'support': 421280}}
[[ 73307      8  37402]
 [112821     27  76150]
 [ 68488      7  53070]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1152346
{'0': {'precision': 0.35921602227696264, 'recall': 0.5979808785184195, 'f1-score': 0.44881949032759877, 'support': 44871}, '1': {'precision': 0.47619047619047616, 'recall': 0.0002231644722160232, 'f1-score': 0.0004461198724097165, 'support': 44810}, '2': {'precision': 0.3662703316522494, 'recall': 0.48828977247428645, 'f1-score': 0.4185687022900763, 'support': 44918}, 'accuracy': 0.3623726773601587, 'macro avg': {'precision': 0.40055894337322934, 'recall': 0.362164605154974, 'f1-score': 0.2892781041633616, 'support': 134599}, 'weighted avg': {'precision': 0.4005126942313135, 'recall': 0.3623726773601587, 'f1-score': 0.28945414862991564, 'support': 134599}}
[[26832     8 18031]
 [24882    10 19918]
 [22982     3 21933]]
Evaluating performance on  val set...
146/146 - 1s - 895ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1159663
{'0': {'precision': 0.35217727141064015, 'recall': 0.5962890305705412, 'f1-score': 0.44281898749544735, 'support': 12234}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 12279}, '2': {'precision': 0.3688736544590775, 'recall': 0.47806094614605255, 'f1-score': 0.41642905634759, 'support': 12831}, 'accuracy': 0.35960261353898887, 'macro avg': {'precision': 0.24035030862323922, 'recall': 0.3581166589055312, 'f1-score': 0.2864160146143458, 'support': 37344}, 'weighted avg': {'precision': 0.24211532237580857, 'recall': 0.35960261353898887, 'f1-score': 0.28814933362829986, 'support': 37344}}
[[7295    1 4938]
 [6722    0 5557]
 [6697    0 6134]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/EXC
Evaluating performance on  test set...
5928/5928 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1121978
{'0': {'precision': 0.3964595503201123, 'recall': 0.7080785691624023, 'f1-score': 0.508311132354502, 'support': 463337}, '1': {'precision': 0.5823008849557522, 'recall': 0.0005408648906351463, 'f1-score': 0.0010807259587747393, 'support': 608285}, '2': {'precision': 0.40538027878940824, 'recall': 0.626761984634911, 'f1-score': 0.49232931751667, 'support': 445946}, 'accuracy': 0.4005817202260459, 'macro avg': {'precision': 0.4613802380217576, 'recall': 0.44512713956264943, 'f1-score': 0.3339070586099822, 'support': 1517568}, 'weighted avg': {'precision': 0.4735715211950971, 'recall': 0.4005817202260459, 'f1-score': 0.3003022166722414, 'support': 1517568}}
[[328079    134 135124]
 [333101    329 274855]
 [166342    102 279502]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0969926
{'0': {'precision': 0.4060105754793683, 'recall': 0.6509295731765333, 'f1-score': 0.5000932000511686, 'support': 105102}, '1': {'precision': 0.4722222222222222, 'recall': 0.00015806160683569961, 'f1-score': 0.000316017436726803, 'support': 107553}, '2': {'precision': 0.4194729280245626, 'recall': 0.5903278522033774, 'f1-score': 0.49044634844173085, 'support': 108311}, 'accuracy': 0.41241128343812117, 'macro avg': {'precision': 0.432568575242051, 'recall': 0.41380516232891545, 'f1-score': 0.33028518864320877, 'support': 320966}, 'weighted avg': {'precision': 0.4327404537488943, 'recall': 0.41241128343812117, 'f1-score': 0.32936671978098153, 'support': 320966}}
[[68414    11 36677]
 [55725    17 51811]
 [44364     8 63939]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038017
{'0': {'precision': 0.390541289488269, 'recall': 0.6549869025152804, 'f1-score': 0.4893209603770806, 'support': 35503}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 37583}, '2': {'precision': 0.4101443730745223, 'recall': 0.5638477508650519, 'f1-score': 0.4748682799459132, 'support': 36125}, 'accuracy': 0.39943778557105053, 'macro avg': {'precision': 0.26689522085426376, 'recall': 0.4062782177934441, 'f1-score': 0.32139641344099795, 'support': 109211}, 'weighted avg': {'precision': 0.26262787519589725, 'recall': 0.39943778557105053, 'f1-score': 0.31614927680649024, 'support': 109211}}
[[23254     4 12245]
 [20534     0 17049]
 [15755     1 20369]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/AAL
Evaluating performance on  test set...
5331/5331 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1517423
{'0': {'precision': 0.3251896517132368, 'recall': 0.6213046563790166, 'f1-score': 0.42692669800189004, 'support': 386094}, '1': {'precision': 0.4732824427480916, 'recall': 0.0002120702157643421, 'f1-score': 0.000423950466174565, 'support': 584712}, '2': {'precision': 0.3388301038343884, 'recall': 0.53920186899275, 'f1-score': 0.4161530124472545, 'support': 393795}, 'accuracy': 0.3314822427947803, 'macro avg': {'precision': 0.3791007327652389, 'recall': 0.386906198529177, 'f1-score': 0.28116788697177303, 'support': 1364601}, 'weighted avg': {'precision': 0.39258163946249164, 'recall': 0.3314822427947803, 'f1-score': 0.24106731638038237, 'support': 1364601}}
[[239882     93 146119]
 [316371    124 268217]
 [181415     45 212335]]
Evaluating performance on  train set...
2013/2013 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.121588
{'0': {'precision': 0.3685107397563832, 'recall': 0.6337242606047816, 'f1-score': 0.46602682203850154, 'support': 165845}, '1': {'precision': 0.40384615384615385, 'recall': 0.00011201015558743992, 'f1-score': 0.00022395819447036552, 'support': 187483}, '2': {'precision': 0.3733830023994158, 'recall': 0.5302996629255102, 'f1-score': 0.4382177237920814, 'support': 161982}, 'accuracy': 0.3706894878810813, 'macro avg': {'precision': 0.38191329866731766, 'recall': 0.3880453112286264, 'f1-score': 0.30148950134168445, 'support': 515310}, 'weighted avg': {'precision': 0.38289821193281326, 'recall': 0.3706894878810813, 'f1-score': 0.28781430593320156, 'support': 515310}}
[[105100     17  60728]
 [104033     21  83429]
 [ 76069     14  85899]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1294233
{'0': {'precision': 0.35607646304997864, 'recall': 0.608049456561383, 'f1-score': 0.4491365607909696, 'support': 54836}, '1': {'precision': 0.30303030303030304, 'recall': 0.00014532349008893798, 'f1-score': 0.00029050766213958894, 'support': 68812}, '2': {'precision': 0.360520319027725, 'recall': 0.5596064921427387, 'f1-score': 0.43852544807524346, 'support': 54281}, 'accuracy': 0.3581709558306965, 'macro avg': {'precision': 0.33987569503600223, 'recall': 0.38926709073140353, 'f1-score': 0.29598417217611755, 'support': 177929}, 'weighted avg': {'precision': 0.33691716121078513, 'recall': 0.3581709558306965, 'f1-score': 0.2723133536846329, 'support': 177929}}
[[33343    13 21480]
 [36402    10 32400]
 [23895    10 30376]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/WBA
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1348311
{'0': {'precision': 0.3351125446129964, 'recall': 0.6333537163007765, 'f1-score': 0.4383111401514238, 'support': 315623}, '1': {'precision': 0.5112781954887218, 'recall': 0.00015788838220133554, 'f1-score': 0.0003156792791370814, 'support': 430684}, '2': {'precision': 0.3602382406457178, 'recall': 0.5251867897857654, 'f1-score': 0.42734812922693133, 'support': 326838}, 'accuracy': 0.3462905758308523, 'macro avg': {'precision': 0.40220966024914534, 'recall': 0.3862327981562477, 'f1-score': 0.28865831621916405, 'support': 1073145}, 'weighted avg': {'precision': 0.4134651991207316, 'recall': 0.3462905758308523, 'f1-score': 0.25919204102236004, 'support': 1073145}}
[[199901     42 115680]
 [241454     68 189162]
 [155164     23 171651]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10548
{'0': {'precision': 0.38392790431688995, 'recall': 0.6257025103034844, 'f1-score': 0.47586651516824513, 'support': 106760}, '1': {'precision': 0.3333333333333333, 'recall': 7.774538386783285e-05, 'f1-score': 0.00015545451012397496, 'support': 102900}, '2': {'precision': 0.38663987731803595, 'recall': 0.5176366591576607, 'f1-score': 0.44264993355252197, 'support': 105207}, 'accuracy': 0.3851372166660844, 'macro avg': {'precision': 0.36796703832275307, 'recall': 0.38113897161500426, 'f1-score': 0.30622396774363037, 'support': 314867}, 'weighted avg': {'precision': 0.3682995189647368, 'recall': 0.3851372166660844, 'f1-score': 0.3093032200507319, 'support': 314867}}
[[66800     9 39951]
 [56450     8 46442]
 [50741     7 54459]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0920079
{'0': {'precision': 0.3928349125112387, 'recall': 0.6252063841496973, 'f1-score': 0.48250084947332655, 'support': 36340}, '1': {'precision': 0.375, 'recall': 0.00010158128195577828, 'f1-score': 0.0002031075454453133, 'support': 29533}, '2': {'precision': 0.40746830026350755, 'recall': 0.4974155944132849, 'f1-score': 0.4479714756168521, 'support': 36372}, 'accuracy': 0.3991882243630495, 'macro avg': {'precision': 0.39176773759158207, 'recall': 0.37424118661497935, 'f1-score': 0.31022514421187464, 'support': 102245}, 'weighted avg': {'precision': 0.3928889700018848, 'recall': 0.3991882243630495, 'f1-score': 0.330908090920206, 'support': 102245}}
[[22720     5 13615]
 [16836     3 12694]
 [18280     0 18092]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
6143/6143 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1385853
{'0': {'precision': 0.3384075036402664, 'recall': 0.6338255522818101, 'f1-score': 0.44123437602658877, 'support': 460906}, '1': {'precision': 0.48868778280542985, 'recall': 0.00016913372213208717, 'f1-score': 0.0003381504111815069, 'support': 638548}, '2': {'precision': 0.3515257082008138, 'recall': 0.5268802201913991, 'f1-score': 0.4217001196218798, 'support': 473043}, 'accuracy': 0.34434342323069617, 'macro avg': {'precision': 0.39287366488217, 'recall': 0.3869583020651138, 'f1-score': 0.28775754868655, 'support': 1572497}, 'weighted avg': {'precision': 0.4033784679984126, 'recall': 0.34434342323069617, 'f1-score': 0.2563221336968929, 'support': 1572497}}
[[292134     58 168714]
 [347376    108 291064]
 [223751     55 249237]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1083341
{'0': {'precision': 0.3758639243252625, 'recall': 0.6040726380094285, 'f1-score': 0.4633955319695284, 'support': 179245}, '1': {'precision': 0.3611111111111111, 'recall': 0.00014871419419785852, 'f1-score': 0.00029730595069295154, 'support': 174832}, '2': {'precision': 0.3812844545821789, 'recall': 0.5216117093430241, 'f1-score': 0.4405433183721193, 'support': 179139}, 'accuracy': 0.37835323771229673, 'macro avg': {'precision': 0.3727531633395175, 'recall': 0.3752776871822168, 'f1-score': 0.30141205209744687, 'support': 533216}, 'weighted avg': {'precision': 0.37284781927559635, 'recall': 0.37835323771229673, 'f1-score': 0.30387647825967856, 'support': 533216}}
[[108277     23  70945]
 [ 94123     26  80683]
 [ 85675     23  93441]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1175648
{'0': {'precision': 0.36005922331095325, 'recall': 0.6184043229497775, 'f1-score': 0.4551261640034572, 'support': 56628}, '1': {'precision': 0.36363636363636365, 'recall': 6.625258799171843e-05, 'f1-score': 0.00013248103865134305, 'support': 60375}, '2': {'precision': 0.37690461214587373, 'recall': 0.5047619047619047, 'f1-score': 0.4315624701447017, 'support': 58170}, 'accuracy': 0.3675509353610431, 'macro avg': {'precision': 0.36686673303106354, 'recall': 0.374410826766558, 'f1-score': 0.29560703839560337, 'support': 175173}, 'weighted avg': {'precision': 0.3668859952202884, 'recall': 0.3675509353610431, 'f1-score': 0.29048353254333514, 'support': 175173}}
[[35019     4 21605]
 [33435     4 26936]
 [28805     3 29362]]
testing model on single stock: results/universal/W7/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
23942/23942 - 134s - 134s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1567686
{'0': {'precision': 0.31535185283184825, 'recall': 0.5759911074472351, 'f1-score': 0.4075644752751097, 'support': 1800158}, '1': {'precision': 0.39655172413793105, 'recall': 1.815574710307294e-05, 'f1-score': 3.6309831794704215e-05, 'support': 2533633}, '2': {'precision': 0.31620067801287527, 'recall': 0.5003765454517097, 'f1-score': 0.38751853073313874, 'support': 1795268}, 'accuracy': 0.3157468381361641, 'macro avg': {'precision': 0.34270141832755147, 'recall': 0.3587952695486827, 'f1-score': 0.26503977194668105, 'support': 6129059}, 'weighted avg': {'precision': 0.3491669200749497, 'recall': 0.3157468381361641, 'f1-score': 0.23322863495074383, 'support': 6129059}}
[[1036875      41  763242]
 [1354190      46 1179397]
 [ 896929      29  898310]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1152936
{'0': {'precision': 0.36284989937534307, 'recall': 0.6046912631309249, 'f1-score': 0.45354590064540806, 'support': 780600}, '1': {'precision': 0.43670886075949367, 'recall': 9.026805688195817e-05, 'f1-score': 0.00018049880452241065, 'support': 764390}, '2': {'precision': 0.36753257234416553, 'recall': 0.48366248406917345, 'f1-score': 0.4176756328105164, 'support': 772088}, 'accuracy': 0.3649083026121693, 'macro avg': {'precision': 0.3890304441596674, 'recall': 0.3628146717523268, 'f1-score': 0.2904673440868156, 'support': 2317078}, 'weighted avg': {'precision': 0.38877586608841147, 'recall': 0.3649083026121693, 'f1-score': 0.29203084467178075, 'support': 2317078}}
[[472022     34 308544]
 [430249     69 334072]
 [398603     55 373430]]
Evaluating performance on  val set...
2763/2763 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1212962
{'0': {'precision': 0.3464547576113751, 'recall': 0.6183262468023748, 'f1-score': 0.4440843444898468, 'support': 230249}, '1': {'precision': 0.1935483870967742, 'recall': 2.502043335390569e-05, 'f1-score': 5.003439864907124e-05, 'support': 239804}, '2': {'precision': 0.3665607115862218, 'recall': 0.4578544303530711, 'f1-score': 0.4071527492770979, 'support': 237261}, 'accuracy': 0.3548720935821997, 'macro avg': {'precision': 0.30218795209812366, 'recall': 0.3587352325296, 'f1-score': 0.28376237605519794, 'support': 707314}, 'weighted avg': {'precision': 0.30135851954899084, 'recall': 0.3548720935821997, 'f1-score': 0.2811529859858703, 'support': 707314}}
[[142369     15  87865]
 [139942      6  99856]
 [128620     10 108631]]
training model: results/universal/W7/deepOF_L1/h200
Epoch 1/50
12475/12475 - 170s - loss: 3.2716 - accuracy200: 0.3772 - val_loss: 3.2954 - val_accuracy200: 0.3515 - 170s/epoch - 14ms/step
Epoch 2/50
12475/12475 - 168s - loss: 3.2690 - accuracy200: 0.3798 - val_loss: 3.2957 - val_accuracy200: 0.3533 - 168s/epoch - 13ms/step
Epoch 3/50
12475/12475 - 173s - loss: 3.2687 - accuracy200: 0.3805 - val_loss: 3.2961 - val_accuracy200: 0.3535 - 173s/epoch - 14ms/step
Epoch 4/50
12475/12475 - 169s - loss: 3.2673 - accuracy200: 0.3819 - val_loss: 3.2976 - val_accuracy200: 0.3527 - 169s/epoch - 14ms/step
Epoch 5/50
12475/12475 - 165s - loss: 3.2657 - accuracy200: 0.3829 - val_loss: 3.2975 - val_accuracy200: 0.3531 - 165s/epoch - 13ms/step
Epoch 6/50
12475/12475 - 171s - loss: 3.2647 - accuracy200: 0.3839 - val_loss: 3.2973 - val_accuracy200: 0.3536 - 171s/epoch - 14ms/step
Epoch 7/50
12475/12475 - 167s - loss: 3.2640 - accuracy200: 0.3842 - val_loss: 3.2969 - val_accuracy200: 0.3536 - 167s/epoch - 13ms/step
Epoch 8/50
12475/12475 - 166s - loss: 3.2633 - accuracy200: 0.3848 - val_loss: 3.2960 - val_accuracy200: 0.3541 - 166s/epoch - 13ms/step
Epoch 9/50
12475/12475 - 164s - loss: 3.2627 - accuracy200: 0.3853 - val_loss: 3.2957 - val_accuracy200: 0.3535 - 164s/epoch - 13ms/step
Epoch 10/50
12475/12475 - 173s - loss: 3.2621 - accuracy200: 0.3856 - val_loss: 3.2948 - val_accuracy200: 0.3535 - 173s/epoch - 14ms/step
Epoch 11/50
12475/12475 - 162s - loss: 3.2614 - accuracy200: 0.3863 - val_loss: 3.2946 - val_accuracy200: 0.3537 - 162s/epoch - 13ms/step
Epoch 12/50
12475/12475 - 170s - loss: 3.2609 - accuracy200: 0.3864 - val_loss: 3.2949 - val_accuracy200: 0.3532 - 170s/epoch - 14ms/step
Epoch 13/50
12475/12475 - 169s - loss: 3.2602 - accuracy200: 0.3869 - val_loss: 3.2944 - val_accuracy200: 0.3536 - 169s/epoch - 14ms/step
Epoch 14/50
12475/12475 - 168s - loss: 3.2597 - accuracy200: 0.3876 - val_loss: 3.2954 - val_accuracy200: 0.3524 - 168s/epoch - 13ms/step
Epoch 15/50
12475/12475 - 171s - loss: 3.2591 - accuracy200: 0.3878 - val_loss: 3.2948 - val_accuracy200: 0.3527 - 171s/epoch - 14ms/step
Epoch 16/50
12475/12475 - 165s - loss: 3.2588 - accuracy200: 0.3880 - val_loss: 3.2956 - val_accuracy200: 0.3530 - 165s/epoch - 13ms/step
Epoch 17/50
12475/12475 - 161s - loss: 3.2580 - accuracy200: 0.3884 - val_loss: 3.2952 - val_accuracy200: 0.3520 - 161s/epoch - 13ms/step
Epoch 18/50
12475/12475 - 168s - loss: 3.2573 - accuracy200: 0.3888 - val_loss: 3.2948 - val_accuracy200: 0.3532 - 168s/epoch - 13ms/step
Epoch 19/50
12475/12475 - 164s - loss: 3.2570 - accuracy200: 0.3891 - val_loss: 3.2950 - val_accuracy200: 0.3528 - 164s/epoch - 13ms/step
Epoch 20/50
12475/12475 - 166s - loss: 3.2565 - accuracy200: 0.3893 - val_loss: 3.2954 - val_accuracy200: 0.3523 - 166s/epoch - 13ms/step
Epoch 21/50
12475/12475 - 167s - loss: 3.2558 - accuracy200: 0.3897 - val_loss: 3.2971 - val_accuracy200: 0.3515 - 167s/epoch - 13ms/step
Epoch 22/50
12475/12475 - 163s - loss: 3.2558 - accuracy200: 0.3897 - val_loss: 3.2983 - val_accuracy200: 0.3512 - 163s/epoch - 13ms/step
Epoch 23/50
12475/12475 - 169s - loss: 3.2548 - accuracy200: 0.3903 - val_loss: 3.2996 - val_accuracy200: 0.3508 - 169s/epoch - 14ms/step
testing model in sample: results/universal/W7/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 188s - 188s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948962
{'0': {'precision': 0.3292634010802308, 'recall': 0.5341487130276756, 'f1-score': 0.4073966974990585, 'support': 2826168}, '1': {'precision': 0.42095442785483744, 'recall': 0.11794201834559673, 'f1-score': 0.1842588319250097, 'support': 3879296}, '2': {'precision': 0.3297242959768841, 'recall': 0.45146090312322884, 'f1-score': 0.38110713980467525, 'support': 2800083}, 'accuracy': 0.33993351460994303, 'macro avg': {'precision': 0.3599807083039841, 'recall': 0.367850544832167, 'f1-score': 0.3242542230762478, 'support': 9505547}, 'weighted avg': {'precision': 0.3668190701403628, 'recall': 0.33993351460994303, 'f1-score': 0.3085879942284832, 'support': 9505547}}
[[1509594  312264 1004310]
 [1856308  457532 1565456]
 [1218859  317096 1264128]]
Evaluating performance on  train set...
12475/12475 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945686
{'0': {'precision': 0.368563673881656, 'recall': 0.5479280554066229, 'f1-score': 0.4406943798179658, 'support': 1085502}, '1': {'precision': 0.33492615249168933, 'recall': 0.10665502696755869, 'f1-score': 0.161789312986055, 'support': 1034391}, '2': {'precision': 0.36979053742140455, 'recall': 0.4306862283762818, 'f1-score': 0.39792208507777116, 'support': 1073185}, 'accuracy': 0.3655739070577042, 'macro avg': {'precision': 0.35776012126491663, 'recall': 0.36175643691682113, 'f1-score': 0.333468592627264, 'support': 3193078}, 'weighted avg': {'precision': 0.35807921410955396, 'recall': 0.3655739070577042, 'f1-score': 0.3359680072971308, 'support': 3193078}}
[[594777 108698 382027]
 [518388 110323 405680]
 [500605 110374 462206]]
Evaluating performance on  val set...
3866/3866 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970126
{'0': {'precision': 0.3461192085064652, 'recall': 0.5535366158460385, 'f1-score': 0.42591766800124525, 'support': 320080}, '1': {'precision': 0.34544966288470946, 'recall': 0.10705316249528174, 'f1-score': 0.16345302977360085, 'support': 336459}, '2': {'precision': 0.36580161429976865, 'recall': 0.4102031491423727, 'f1-score': 0.3867320955132683, 'support': 332662}, 'accuracy': 0.35347113478453823, 'macro avg': {'precision': 0.3524568285636478, 'recall': 0.3569309758278976, 'f1-score': 0.3253675977627048, 'support': 989201}, 'weighted avg': {'precision': 0.3525105423462628, 'recall': 0.35347113478453823, 'f1-score': 0.323467164384255, 'support': 989201}}
[[177176  33092 109812]
 [173670  36019 126770]
 [161047  35156 136459]]
testing model out of sample: results/universal/W7/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 89s - 89s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949799
{'0': {'precision': 0.335327418016327, 'recall': 0.5468702629592405, 'f1-score': 0.4157358316001074, 'support': 1151167}, '1': {'precision': 0.3892177397322648, 'recall': 0.10773447007305811, 'f1-score': 0.16875734167482864, 'support': 1428178}, '2': {'precision': 0.35525245831765495, 'recall': 0.44642026224964265, 'f1-score': 0.3956524689895184, 'support': 1194892}, 'accuracy': 0.34889886353188737, 'macro avg': {'precision': 0.35993253868874886, 'recall': 0.3670083317606471, 'f1-score': 0.3267152140881515, 'support': 3774237}, 'weighted avg': {'precision': 0.3620277135047552, 'recall': 0.34889886353188737, 'f1-score': 0.3159205059856861, 'support': 3774237}}
[[629539 117861 403767]
 [709970 153864 564344]
 [537877 123591 533424]]
Evaluating performance on  train set...
5285/5285 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0947455
{'0': {'precision': 0.3703108874553506, 'recall': 0.5430963602380708, 'f1-score': 0.440361067073629, 'support': 458519}, '1': {'precision': 0.3348096520700858, 'recall': 0.10970389274812459, 'f1-score': 0.16525895595264609, 'support': 439638}, '2': {'precision': 0.3733233854045232, 'recall': 0.44038707803609384, 'f1-score': 0.40409163270600756, 'support': 454482}, 'accuracy': 0.36772413038512125, 'macro avg': {'precision': 0.35948130830998654, 'recall': 0.36439577700742976, 'f1-score': 0.33657055191076085, 'support': 1352639}, 'weighted avg': {'precision': 0.3597843788825746, 'recall': 0.36772413038512125, 'f1-score': 0.3387603095919417, 'support': 1352639}}
[[249020  47243 162256]
 [217687  48230 173721]
 [205755  48579 200148]]
Evaluating performance on  val set...
1714/1714 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950981
{'0': {'precision': 0.357689325162657, 'recall': 0.5278483309143687, 'f1-score': 0.42642051860202934, 'support': 143312}, '1': {'precision': 0.3407487341246783, 'recall': 0.11109156597161143, 'f1-score': 0.16755614967805135, 'support': 147806}, '2': {'precision': 0.3712259258220964, 'recall': 0.4506748892201507, 'f1-score': 0.4071104443105378, 'support': 146913}, 'accuracy': 0.3613374395876091, 'macro avg': {'precision': 0.3565546617031439, 'recall': 0.3632049287020436, 'f1-score': 0.33369570419687283, 'support': 438031}, 'weighted avg': {'precision': 0.3565131107251417, 'recall': 0.3613374395876091, 'f1-score': 0.33259472120969097, 'support': 438031}}
[[75647 15561 52104]
 [71345 16420 60041]
 [64496 16207 66210]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
695/695 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012125
{'0': {'precision': 0.32979127914744055, 'recall': 0.5672293415819708, 'f1-score': 0.417085819004172, 'support': 56575}, '1': {'precision': 0.34137760158572844, 'recall': 0.11150496908484672, 'f1-score': 0.16810229130572704, 'support': 61782}, '2': {'precision': 0.34521445591739475, 'recall': 0.3502568751888788, 'f1-score': 0.34771738586929346, 'support': 59562}, 'accuracy': 0.3363440666820295, 'macro avg': {'precision': 0.3387944455501879, 'recall': 0.3429970619518988, 'f1-score': 0.3109684987263975, 'support': 177919}, 'weighted avg': {'precision': 0.3389778271139552, 'recall': 0.3363440666820295, 'f1-score': 0.30740431830641085, 'support': 177919}}
[[32091  6082 18402]
 [33725  6889 21168]
 [31491  7209 20862]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978886
{'0': {'precision': 0.36138468518963357, 'recall': 0.5499593826157595, 'f1-score': 0.43616215955030846, 'support': 24620}, '1': {'precision': 0.3305937193326791, 'recall': 0.11305478647537545, 'f1-score': 0.1684901531728665, 'support': 23838}, '2': {'precision': 0.34881516587677724, 'recall': 0.3908905506458192, 'f1-score': 0.36865620805032956, 'support': 23536}, 'accuracy': 0.3532933299997222, 'macro avg': {'precision': 0.34693119013303003, 'recall': 0.3513015732456514, 'f1-score': 0.3244361735911682, 'support': 71994}, 'weighted avg': {'precision': 0.34708028134145913, 'recall': 0.3532933299997222, 'f1-score': 0.3254642491337604, 'support': 71994}}
[[13540  2723  8357]
 [12325  2695  8818]
 [11602  2734  9200]]
Evaluating performance on  val set...
73/73 - 1s - 517ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992286
{'0': {'precision': 0.35823691460055096, 'recall': 0.5114852108244179, 'f1-score': 0.4213596008035772, 'support': 6356}, '1': {'precision': 0.3116830065359477, 'recall': 0.13341493268053856, 'f1-score': 0.1868495163462716, 'support': 5719}, '2': {'precision': 0.37193987115246957, 'recall': 0.40385512202704804, 'f1-score': 0.38724101952600987, 'support': 6433}, 'accuracy': 0.35725091852172036, 'macro avg': {'precision': 0.3472865974296561, 'recall': 0.34958508851066816, 'f1-score': 0.33181671222528625, 'support': 18508}, 'weighted avg': {'precision': 0.34861455233974625, 'recall': 0.35725091852172036, 'f1-score': 0.3370367130593627, 'support': 18508}}
[[3251  839 2266]
 [2835  763 2121]
 [2989  846 2598]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
2006/2006 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0843617
{'0': {'precision': 0.3938188886673692, 'recall': 0.6240106954888278, 'f1-score': 0.4828847627133811, 'support': 177271}, '1': {'precision': 0.35597002357696195, 'recall': 0.10158840774739271, 'f1-score': 0.1580669283978314, 'support': 166456}, '2': {'precision': 0.4157181249425468, 'recall': 0.4533072323966085, 'f1-score': 0.43369973288654584, 'support': 169598}, 'accuracy': 0.3982058150294648, 'macro avg': {'precision': 0.3885023457289593, 'recall': 0.39296877854427636, 'f1-score': 0.35821714133258614, 'support': 513325}, 'weighted avg': {'precision': 0.38878094192078316, 'recall': 0.3982058150294648, 'f1-score': 0.3613057238639178, 'support': 513325}}
[[110619  14754  51898]
 [ 93391  16910  56155]
 [ 76878  15840  76880]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0831448
{'0': {'precision': 0.4104607154036595, 'recall': 0.5940691927512356, 'f1-score': 0.48548492957035394, 'support': 48560}, '1': {'precision': 0.3731220753632707, 'recall': 0.10347182697780308, 'f1-score': 0.16201475777991659, 'support': 43925}, '2': {'precision': 0.4017649622312609, 'recall': 0.4911431742508324, 'f1-score': 0.4419807834441981, 'support': 45050}, 'accuracy': 0.4036717926346021, 'macro avg': {'precision': 0.3951159176660637, 'recall': 0.396228064659957, 'f1-score': 0.36316015693148956, 'support': 137535}, 'weighted avg': {'precision': 0.3956874326451571, 'recall': 0.4036717926346021, 'f1-score': 0.36792729639422944, 'support': 137535}}
[[28848  3861 15851]
 [22285  4545 17095]
 [19149  3775 22126]]
Evaluating performance on  val set...
153/153 - 1s - 925ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.086287
{'0': {'precision': 0.3913690476190476, 'recall': 0.5914099392849111, 'f1-score': 0.4710307155010298, 'support': 13341}, '1': {'precision': 0.3325450783328407, 'recall': 0.0945696032279758, 'f1-score': 0.1472609463970155, 'support': 11896}, '2': {'precision': 0.4126523505513639, 'recall': 0.4632592485339897, 'f1-score': 0.43649386084583897, 'support': 13813}, 'accuracy': 0.3947247119078105, 'macro avg': {'precision': 0.3788554921677507, 'recall': 0.38307959701562555, 'f1-score': 0.35159517424796144, 'support': 39050}, 'weighted avg': {'precision': 0.3809776602893515, 'recall': 0.3947247119078105, 'f1-score': 0.36018250175932676, 'support': 39050}}
[[7890 1084 4367]
 [6030 1125 4741]
 [6240 1174 6399]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956949
{'0': {'precision': 0.35276247601140576, 'recall': 0.5881141435991761, 'f1-score': 0.44100277793966236, 'support': 77201}, '1': {'precision': 0.35200773289298803, 'recall': 0.10547784844498619, 'f1-score': 0.1623177639520847, 'support': 82861}, '2': {'precision': 0.370065399744088, 'recall': 0.4010760420144328, 'f1-score': 0.38494719069274475, 'support': 77878}, 'accuracy': 0.3588215516516769, 'macro avg': {'precision': 0.3582785362161606, 'recall': 0.3648893446861983, 'f1-score': 0.32942257752816395, 'support': 237940}, 'weighted avg': {'precision': 0.3581629060564533, 'recall': 0.3588215516516769, 'f1-score': 0.3256055518841857, 'support': 237940}}
[[45403  7948 23850]
 [44802  8740 29319]
 [38502  8141 31235]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951127
{'0': {'precision': 0.36377015613002306, 'recall': 0.5272350686286633, 'f1-score': 0.4305078756058158, 'support': 32348}, '1': {'precision': 0.34314794620138134, 'recall': 0.11755549329099343, 'f1-score': 0.17511884057971014, 'support': 32121}, '2': {'precision': 0.37066007266855067, 'recall': 0.44446461529151915, 'f1-score': 0.4042210695761045, 'support': 33051}, 'accuracy': 0.36424323215750615, 'macro avg': {'precision': 0.35919272499998506, 'recall': 0.363085059070392, 'f1-score': 0.3366159285872102, 'support': 97520}, 'weighted avg': {'precision': 0.35931273843516026, 'recall': 0.36424323215750615, 'f1-score': 0.33747920025551303, 'support': 97520}}
[[17055  3451 11842]
 [15245  3776 13100]
 [14584  3777 14690]]
Evaluating performance on  val set...
114/114 - 1s - 733ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989838
{'0': {'precision': 0.3566366857454347, 'recall': 0.5503680336487907, 'f1-score': 0.43281237079302076, 'support': 9510}, '1': {'precision': 0.322540857230959, 'recall': 0.11072298084047846, 'f1-score': 0.16485421591804572, 'support': 9447}, '2': {'precision': 0.3660154149489156, 'recall': 0.40355731225296443, 'f1-score': 0.38387066453614066, 'support': 10120}, 'accuracy': 0.35643291948963096, 'macro avg': {'precision': 0.3483976526417698, 'recall': 0.3548827755807446, 'f1-score': 0.32717908374906907, 'support': 29077}, 'weighted avg': {'precision': 0.3488232747182646, 'recall': 0.35643291948963096, 'f1-score': 0.32872010692730164, 'support': 29077}}
[[5234 1033 3243]
 [4570 1046 3831]
 [4872 1164 4084]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1065/1065 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998929
{'0': {'precision': 0.32223310479921646, 'recall': 0.5403744844451474, 'f1-score': 0.4037213445561474, 'support': 82193}, '1': {'precision': 0.34695937421145595, 'recall': 0.07286466779010736, 'f1-score': 0.12043654964613552, 'support': 94353}, '2': {'precision': 0.38365853658536586, 'recall': 0.4592509175842509, 'f1-score': 0.41806515301085884, 'support': 95904}, 'accuracy': 0.3499137456414021, 'macro avg': {'precision': 0.35095033853201274, 'recall': 0.35749668993983524, 'f1-score': 0.3140743490710472, 'support': 272450}, 'weighted avg': {'precision': 0.35241824815716066, 'recall': 0.3499137456414021, 'f1-score': 0.3106652181178882, 'support': 272450}}
[[44415  5950 31828]
 [48550  6875 38928]
 [44870  6990 44044]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930741
{'0': {'precision': 0.3740958100177426, 'recall': 0.541730193686826, 'f1-score': 0.4425709573621507, 'support': 35418}, '1': {'precision': 0.38836166440713316, 'recall': 0.10998877665544332, 'f1-score': 0.17142725619720578, 'support': 33858}, '2': {'precision': 0.36207309479331323, 'recall': 0.45323180237438543, 'f1-score': 0.40255625083211294, 'support': 33356}, 'accuracy': 0.3705374542053161, 'macro avg': {'precision': 0.37484352307272967, 'recall': 0.3683169242388849, 'f1-score': 0.3388514881304898, 'support': 102632}, 'weighted avg': {'precision': 0.37489462139129004, 'recall': 0.3705374542053161, 'f1-score': 0.34011642091095956, 'support': 102632}}
[[19187  2962 13269]
 [16767  3724 13367]
 [15335  2903 15118]]
Evaluating performance on  val set...
123/123 - 1s - 780ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955896
{'0': {'precision': 0.3451847704367301, 'recall': 0.5225683407501589, 'f1-score': 0.41574643850628, 'support': 9438}, '1': {'precision': 0.3393915448439352, 'recall': 0.08050609184629803, 'f1-score': 0.13014165593515642, 'support': 10670}, '2': {'precision': 0.3888202170031589, 'recall': 0.5022620420473698, 'f1-score': 0.4383201083801045, 'support': 11273}, 'accuracy': 0.3649660622669768, 'macro avg': {'precision': 0.35779884409460805, 'recall': 0.36844549154794226, 'f1-score': 0.3280694009405136, 'support': 31381}, 'weighted avg': {'precision': 0.358890154970946, 'recall': 0.3649660622669768, 'f1-score': 0.3267457677326825, 'support': 31381}}
[[4932  729 3777]
 [4688  859 5123]
 [4668  943 5662]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
1646/1646 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101268
{'0': {'precision': 0.281344430896464, 'recall': 0.5723787097122108, 'f1-score': 0.37725476722212675, 'support': 111262}, '1': {'precision': 0.4446759789329059, 'recall': 0.10459498327579056, 'f1-score': 0.1693549442067946, 'support': 185659}, '2': {'precision': 0.31353220410699884, 'recall': 0.38133950900216307, 'f1-score': 0.34412745407509804, 'support': 124359}, 'accuracy': 0.30983194075199394, 'macro avg': {'precision': 0.34651753797878954, 'recall': 0.3527710673300548, 'f1-score': 0.2969123885013398, 'support': 421280}, 'weighted avg': {'precision': 0.36282660703961506, 'recall': 0.30983194075199394, 'f1-score': 0.27585391083954297, 'support': 421280}}
[[63684 11296 36282]
 [98691 19419 67549]
 [63981 12955 47423]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984192
{'0': {'precision': 0.3569026085656626, 'recall': 0.5259273944840955, 'f1-score': 0.42523443552911633, 'support': 45396}, '1': {'precision': 0.33845354704660136, 'recall': 0.10316670436552816, 'f1-score': 0.1581319557604965, 'support': 44210}, '2': {'precision': 0.35802537434535664, 'recall': 0.43151156846620586, 'f1-score': 0.3913486056379194, 'support': 44993}, 'accuracy': 0.35550784181160333, 'macro avg': {'precision': 0.3511271766525402, 'recall': 0.35353522243860985, 'f1-score': 0.3249049989758441, 'support': 134599}, 'weighted avg': {'precision': 0.35121819479563515, 'recall': 0.35550784181160333, 'f1-score': 0.3261755586068115, 'support': 134599}}
[[23875  4478 17043]
 [21879  4561 17770]
 [21141  4437 19415]]
Evaluating performance on  val set...
146/146 - 1s - 889ms/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998719
{'0': {'precision': 0.33108438979269816, 'recall': 0.5185342991052407, 'f1-score': 0.40413096898452544, 'support': 11735}, '1': {'precision': 0.36133603238866396, 'recall': 0.1080835603996367, 'f1-score': 0.16639477977161501, 'support': 13212}, '2': {'precision': 0.3478318790381669, 'recall': 0.4212309429700734, 'f1-score': 0.3810288215979569, 'support': 12397}, 'accuracy': 0.3410186375321337, 'macro avg': {'precision': 0.34675076707317637, 'recall': 0.34928293415831696, 'f1-score': 0.31718485678469915, 'support': 37344}, 'weighted avg': {'precision': 0.34734679676982905, 'recall': 0.3410186375321337, 'f1-score': 0.3123526952850754, 'support': 37344}}
[[6085 1168 4482]
 [6475 1428 5309]
 [5819 1356 5222]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/EXC
Evaluating performance on  test set...
5928/5928 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0745789
{'0': {'precision': 0.43149913441051135, 'recall': 0.6051950123834371, 'f1-score': 0.503795887727561, 'support': 513993}, '1': {'precision': 0.38876929868063237, 'recall': 0.13634261294354638, 'f1-score': 0.2018839064244407, 'support': 523226}, '2': {'precision': 0.4164993680433808, 'recall': 0.5316696818354988, 'f1-score': 0.4670898855443502, 'support': 480349}, 'accuracy': 0.4202717769483806, 'macro avg': {'precision': 0.41225593371150815, 'recall': 0.4244024357208274, 'f1-score': 0.3909232265654506, 'support': 1517568}, 'weighted avg': {'precision': 0.41201896363444956, 'recall': 0.4202717769483806, 'f1-score': 0.38808450624613183, 'support': 1517568}}
[[311066  56941 145986]
 [240086  71338 211802]
 [169744  55218 255387]]
Evaluating performance on  train set...
1254/1254 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850933
{'0': {'precision': 0.39418946024166623, 'recall': 0.5378154443444912, 'f1-score': 0.4549357598282656, 'support': 105605}, '1': {'precision': 0.33896844154038647, 'recall': 0.11518982557590188, 'f1-score': 0.17194761599165012, 'support': 105834}, '2': {'precision': 0.40482408209029364, 'recall': 0.5208487404932117, 'f1-score': 0.4555650941324442, 'support': 109527}, 'accuracy': 0.3926708747967074, 'macro avg': {'precision': 0.3793273279574487, 'recall': 0.3912846701378683, 'f1-score': 0.36081615665078665, 'support': 320966}, 'weighted avg': {'precision': 0.37961008714290617, 'recall': 0.3926708747967074, 'f1-score': 0.36183917602664617, 'support': 320966}}
[[56796 11943 36866]
 [46638 12191 47005]
 [40649 11831 57047]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0877699
{'0': {'precision': 0.3805687854020893, 'recall': 0.5454213483146068, 'f1-score': 0.44832084598423017, 'support': 35600}, '1': {'precision': 0.3528957528957529, 'recall': 0.12303136357517835, 'f1-score': 0.18245333865655256, 'support': 37145}, '2': {'precision': 0.38919098143236075, 'recall': 0.4828333241923984, 'f1-score': 0.43098426064181333, 'support': 36466}, 'accuracy': 0.3808590709727042, 'macro avg': {'precision': 0.3742185065767343, 'recall': 0.3837620120273945, 'f1-score': 0.35391948176086535, 'support': 109211}, 'weighted avg': {'precision': 0.3740355809445897, 'recall': 0.3808590709727042, 'f1-score': 0.35210485601267827, 'support': 109211}}
[[19417  4151 12032]
 [16974  4570 15601]
 [14630  4229 17607]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/AAL
Evaluating performance on  test set...
5331/5331 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0938269
{'0': {'precision': 0.3401798907319143, 'recall': 0.5328670930249121, 'f1-score': 0.41525982645245013, 'support': 421242}, '1': {'precision': 0.39887083781837884, 'recall': 0.10852232064065291, 'f1-score': 0.17062267487955113, 'support': 515599}, '2': {'precision': 0.3561061163027592, 'recall': 0.46992004862539744, 'f1-score': 0.40517216183666166, 'support': 427760}, 'accuracy': 0.35280129503056207, 'macro avg': {'precision': 0.36505228161768416, 'recall': 0.3704364874303208, 'f1-score': 0.3303515543895543, 'support': 1364601}, 'weighted avg': {'precision': 0.36734797567177485, 'recall': 0.35280129503056207, 'f1-score': 0.31966428597586777, 'support': 1364601}}
[[224466  42461 154315]
 [250498  55954 209147]
 [184881  41866 201013]]
Evaluating performance on  train set...
2013/2013 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926689
{'0': {'precision': 0.3813751324127584, 'recall': 0.5670192075956036, 'f1-score': 0.45602765907574694, 'support': 178419}, '1': {'precision': 0.3324363250454821, 'recall': 0.1068500493378976, 'f1-score': 0.16172064422748939, 'support': 164174}, '2': {'precision': 0.3842745839521881, 'recall': 0.43890873509845585, 'f1-score': 0.40977864266601804, 'support': 172717}, 'accuracy': 0.37747375366284375, 'macro avg': {'precision': 0.36602868047014286, 'recall': 0.3709259973439856, 'f1-score': 0.3425089819897515, 'support': 515310}, 'weighted avg': {'precision': 0.36675539829314197, 'recall': 0.37747375366284375, 'f1-score': 0.3467622630559977, 'support': 515310}}
[[101167  17463  59789]
 [ 84955  17542  61677]
 [ 79147  17763  75807]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921081
{'0': {'precision': 0.37194412819665307, 'recall': 0.5145736302819883, 'f1-score': 0.4317852371884148, 'support': 59045}, '1': {'precision': 0.3501019038624049, 'recall': 0.11774244779912064, 'f1-score': 0.17622038181499738, 'support': 59817}, '2': {'precision': 0.37705090311986866, 'recall': 0.48593969559991196, 'f1-score': 0.4246257174980768, 'support': 59067}, 'accuracy': 0.3716594821529936, 'macro avg': {'precision': 0.3663656450596422, 'recall': 0.37275192456034034, 'f1-score': 0.34421044550049634, 'support': 177929}, 'weighted avg': {'precision': 0.3662964009649362, 'recall': 0.3716594821529936, 'f1-score': 0.34349151158201613, 'support': 177929}}
[[30383  6492 22170]
 [27522  7043 25252]
 [23782  6582 28703]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/WBA
Evaluating performance on  test set...
4192/4192 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0921984
{'0': {'precision': 0.35375534257717484, 'recall': 0.5445436962010365, 'f1-score': 0.4288888966414669, 'support': 338645}, '1': {'precision': 0.3662252977576685, 'recall': 0.11542141450998587, 'f1-score': 0.17552384691890513, 'support': 381489}, '2': {'precision': 0.373638008567543, 'recall': 0.45684978655056074, 'f1-score': 0.41107514274061985, 'support': 353011}, 'accuracy': 0.36314943460576155, 'macro avg': {'precision': 0.36453954963412877, 'recall': 0.3722716324205277, 'f1-score': 0.33849596210033067, 'support': 1073145}, 'weighted avg': {'precision': 0.36472865050460046, 'recall': 0.36314943460576155, 'f1-score': 0.3329611044680865, 'support': 1073145}}
[[184407  36547 117691]
 [184792  44032 152665]
 [152085  39653 161273]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0922472
{'0': {'precision': 0.3824926531436726, 'recall': 0.5435587821320098, 'f1-score': 0.4490187754102938, 'support': 107992}, '1': {'precision': 0.3290933694181326, 'recall': 0.10813481280939065, 'f1-score': 0.162782049947197, 'support': 101207}, '2': {'precision': 0.37726013500331657, 'recall': 0.4575084226066548, 'f1-score': 0.41352704939417395, 'support': 105668}, 'accuracy': 0.3747232958677791, 'macro avg': {'precision': 0.36294871918837385, 'recall': 0.36973400584935173, 'f1-score': 0.3417759582505549, 'support': 314867}, 'weighted avg': {'precision': 0.36357262965799175, 'recall': 0.3747232958677791, 'f1-score': 0.34510347155623794, 'support': 314867}}
[[58700 10938 38354]
 [48816 10944 41447]
 [45951 11373 48344]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0939468
{'0': {'precision': 0.3676476312818716, 'recall': 0.552584618085013, 'f1-score': 0.4415329414102219, 'support': 34183}, '1': {'precision': 0.34512296214423877, 'recall': 0.11093019124874179, 'f1-score': 0.16789514954632015, 'support': 33778}, '2': {'precision': 0.375806048487878, 'recall': 0.4385719285964298, 'f1-score': 0.4047702371658546, 'support': 34284}, 'accuracy': 0.3684483348819013, 'macro avg': {'precision': 0.36285888063799615, 'recall': 0.36736224597672823, 'f1-score': 0.33806610937413223, 'support': 102245}, 'weighted avg': {'precision': 0.3629419234365957, 'recall': 0.3684483348819013, 'f1-score': 0.33880606101614136, 'support': 102245}}
[[18889  3511 11783]
 [16840  3747 13191]
 [15649  3599 15036]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
6143/6143 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936636
{'0': {'precision': 0.3448069186241622, 'recall': 0.5445784275511614, 'f1-score': 0.42225658509127656, 'support': 484887}, '1': {'precision': 0.37586790396300157, 'recall': 0.107194685690831, 'f1-score': 0.16681499536305786, 'support': 582277}, '2': {'precision': 0.3629099355467134, 'recall': 0.4600669261655186, 'f1-score': 0.4057534696043115, 'support': 505333}, 'accuracy': 0.355462045396589, 'macro avg': {'precision': 0.36119491937795906, 'recall': 0.3706133464691703, 'f1-score': 0.33160835001954864, 'support': 1572497}, 'weighted avg': {'precision': 0.3621259654717345, 'recall': 0.355462045396589, 'f1-score': 0.3223661996720659, 'support': 1572497}}
[[264059  49701 171127]
 [282855  62417 237005]
 [218903  53943 232487]]
Evaluating performance on  train set...
2083/2083 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953616
{'0': {'precision': 0.363843017169997, 'recall': 0.5241144168879687, 'f1-score': 0.429514666961758, 'support': 177736}, '1': {'precision': 0.3388573695011123, 'recall': 0.1120967511908497, 'f1-score': 0.16846418957150938, 'support': 175295}, '2': {'precision': 0.3702069808712631, 'recall': 0.4503649027388517, 'f1-score': 0.40637081104901546, 'support': 180185}, 'accuracy': 0.3637418982176079, 'macro avg': {'precision': 0.3576357891807908, 'recall': 0.36219202360589003, 'f1-score': 0.3347832225274276, 'support': 533216}, 'weighted avg': {'precision': 0.35777949261596165, 'recall': 0.3637418982176079, 'f1-score': 0.3358734050495852, 'support': 533216}}
[[93154 18866 65716]
 [83311 19650 72334]
 [79563 19473 81149]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958093
{'0': {'precision': 0.35161470250088217, 'recall': 0.5451064130166238, 'f1-score': 0.4274850361554164, 'support': 56666}, '1': {'precision': 0.34494021257750224, 'recall': 0.1045276878428478, 'f1-score': 0.16043772127454137, 'support': 59611}, '2': {'precision': 0.3711521801905862, 'recall': 0.43646427601195326, 'f1-score': 0.401167327319829, 'support': 58896}, 'accuracy': 0.35865116199414293, 'macro avg': {'precision': 0.3559023650896569, 'recall': 0.36203279229047497, 'f1-score': 0.3296966949165956, 'support': 175173}, 'weighted avg': {'precision': 0.3559122042117064, 'recall': 0.35865116199414293, 'f1-score': 0.32776096185775294, 'support': 175173}}
[[30889  5728 20049]
 [29875  6231 23505]
 [27085  6105 25706]]
testing model on single stock: results/universal/W7/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
23942/23942 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010646
{'0': {'precision': 0.29376788944706433, 'recall': 0.5011703166622522, 'f1-score': 0.3704130586450655, 'support': 1714066}, '1': {'precision': 0.44509675500323287, 'recall': 0.11744833390572237, 'f1-score': 0.18585487041887144, 'support': 2713772}, '2': {'precision': 0.2918507273897625, 'recall': 0.4269562861027462, 'f1-score': 0.3467064186179276, 'support': 1701221}, 'accuracy': 0.3106698760772249, 'macro avg': {'precision': 0.34357179061335325, 'recall': 0.34852497889024026, 'f1-score': 0.3009914492272882, 'support': 6129059}, 'weighted avg': {'precision': 0.3602398424476488, 'recall': 0.3106698760772249, 'f1-score': 0.2821158049503984, 'support': 6129059}}
[[ 859039  198204  656823]
 [1289452  318728 1105592]
 [ 775719  199155  726347]]
Evaluating performance on  train set...
9052/9052 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096932
{'0': {'precision': 0.3609515358670044, 'recall': 0.5477575968332091, 'f1-score': 0.4351534253260175, 'support': 787927}, '1': {'precision': 0.3301934320320736, 'recall': 0.10405207272998945, 'f1-score': 0.1582391095727824, 'support': 749567}, '2': {'precision': 0.36193261798405263, 'recall': 0.4109486597980461, 'f1-score': 0.3848863430216981, 'support': 779584}, 'accuracy': 0.3581907902970897, 'macro avg': {'precision': 0.3510258619610435, 'recall': 0.3542527764537482, 'f1-score': 0.32609295930683263, 'support': 2317078}, 'weighted avg': {'precision': 0.3513314783220703, 'recall': 0.3581907902970897, 'f1-score': 0.32866014110885444, 'support': 2317078}}
[[431593  78339 277995]
 [384775  77994 286798]
 [379341  79874 320369]]
Evaluating performance on  val set...
2763/2763 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995442
{'0': {'precision': 0.33592412664046545, 'recall': 0.5537451981821219, 'f1-score': 0.4181696881990959, 'support': 227518}, '1': {'precision': 0.3458861999540584, 'recall': 0.10535457052310986, 'f1-score': 0.1615132959173694, 'support': 242970}, '2': {'precision': 0.3557602580335397, 'recall': 0.38795993683126007, 'f1-score': 0.3711630481107361, 'support': 236826}, 'accuracy': 0.34420921966764406, 'macro avg': {'precision': 0.34585686154268785, 'recall': 0.3490199018454973, 'f1-score': 0.3169486774090671, 'support': 707314}, 'weighted avg': {'precision': 0.34598782763648683, 'recall': 0.34420921966764406, 'f1-score': 0.3142664738158701, 'support': 707314}}
[[125987  23388  78143]
 [129133  25598  88239]
 [119926  25021  91879]]
training model: results/universal/W7/deepLOB_L2/h50
Epoch 1/50
12475/12475 - 498s - loss: 3.1912 - accuracy50: 0.4132 - val_loss: 3.6692 - val_accuracy50: 0.3833 - 498s/epoch - 40ms/step
Epoch 2/50
12475/12475 - 494s - loss: 3.1578 - accuracy50: 0.4274 - val_loss: 3.3697 - val_accuracy50: 0.3742 - 494s/epoch - 40ms/step
Epoch 3/50
12475/12475 - 490s - loss: 3.1332 - accuracy50: 0.4378 - val_loss: 3.3558 - val_accuracy50: 0.3856 - 490s/epoch - 39ms/step
Epoch 4/50
12475/12475 - 490s - loss: 3.1166 - accuracy50: 0.4438 - val_loss: 3.3709 - val_accuracy50: 0.3879 - 490s/epoch - 39ms/step
Epoch 5/50
12475/12475 - 491s - loss: 3.1025 - accuracy50: 0.4482 - val_loss: 3.3891 - val_accuracy50: 0.3816 - 491s/epoch - 39ms/step
Epoch 6/50
12475/12475 - 491s - loss: 3.0927 - accuracy50: 0.4508 - val_loss: 3.5303 - val_accuracy50: 0.3917 - 491s/epoch - 39ms/step
Epoch 7/50
12475/12475 - 492s - loss: 3.0851 - accuracy50: 0.4532 - val_loss: 3.5007 - val_accuracy50: 0.3938 - 492s/epoch - 39ms/step
Epoch 8/50
12475/12475 - 496s - loss: 3.0799 - accuracy50: 0.4551 - val_loss: 3.5842 - val_accuracy50: 0.3969 - 496s/epoch - 40ms/step
Epoch 9/50
12475/12475 - 494s - loss: 3.0755 - accuracy50: 0.4560 - val_loss: 3.6779 - val_accuracy50: 0.3937 - 494s/epoch - 40ms/step
Epoch 10/50
12475/12475 - 492s - loss: 3.0719 - accuracy50: 0.4572 - val_loss: 3.6820 - val_accuracy50: 0.3945 - 492s/epoch - 39ms/step
Epoch 11/50
12475/12475 - 495s - loss: 3.0689 - accuracy50: 0.4583 - val_loss: 3.6965 - val_accuracy50: 0.3951 - 495s/epoch - 40ms/step
Epoch 12/50
12475/12475 - 502s - loss: 3.0662 - accuracy50: 0.4592 - val_loss: 3.8099 - val_accuracy50: 0.3877 - 502s/epoch - 40ms/step
Epoch 13/50
12475/12475 - 493s - loss: 3.0633 - accuracy50: 0.4602 - val_loss: 3.6517 - val_accuracy50: 0.3894 - 493s/epoch - 40ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 495s - 495s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0816963
{'0': {'precision': 0.306511235137235, 'recall': 0.7248997198202012, 'f1-score': 0.4308465164244735, 'support': 2480550}, '1': {'precision': 0.5428056736269598, 'recall': 0.369650587470334, 'f1-score': 0.4397984751557122, 'support': 4547719}, '2': {'precision': 0.41981662884867266, 'recall': 0.09186199669560001, 'f1-score': 0.15073990527172362, 'support': 2477303}, 'accuracy': 0.389959383822457, 'macro avg': {'precision': 0.4230445125376225, 'recall': 0.3954707679953784, 'f1-score': 0.34046163228396975, 'support': 9505572}, 'weighted avg': {'precision': 0.44908997729726263, 'recall': 0.389959383822457, 'f1-score': 0.362129141465947, 'support': 9505572}}
[[1798150  602790   79610]
 [2631762 1681067  234890]
 [1436594  813139  227570]]
Evaluating performance on  train set...
12475/12475 - 171s - 171s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1150458
{'0': {'precision': 0.35873835009656907, 'recall': 0.7487611424519062, 'f1-score': 0.485073516813123, 'support': 1032201}, '1': {'precision': 0.4219419774744666, 'recall': 0.32362183782951487, 'f1-score': 0.3662989952162113, 'support': 1143044}, '2': {'precision': 0.4555759293215536, 'recall': 0.07249771329257378, 'f1-score': 0.12508942102640083, 'support': 1017839}, 'accuracy': 0.3810037568695343, 'macro avg': {'precision': 0.4120854189641964, 'recall': 0.38162689785799825, 'f1-score': 0.32548731101857836, 'support': 3193084}, 'weighted avg': {'precision': 0.4122319606164679, 'recall': 0.3810037568695343, 'f1-score': 0.3278053847077096, 'support': 3193084}}
[[772872 223706  35623]
 [720571 369914  52559]
 [660974 283074  73791]]
Evaluating performance on  val set...
3866/3866 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1137725
{'0': {'precision': 0.34890843248836007, 'recall': 0.7153374953902989, 'f1-score': 0.469040618674062, 'support': 306419}, '1': {'precision': 0.4451861754981843, 'recall': 0.3983623518761013, 'f1-score': 0.42047471162378, 'support': 371142}, '2': {'precision': 0.50008659208202, 'recall': 0.04632894901505258, 'f1-score': 0.08480171036556715, 'support': 311641}, 'accuracy': 0.3856441859195594, 'macro avg': {'precision': 0.43139373335618814, 'recall': 0.38667626542715094, 'f1-score': 0.32477234688780304, 'support': 989202}, 'weighted avg': {'precision': 0.4326587958419319, 'recall': 0.3856441859195594, 'f1-score': 0.3297672998790905, 'support': 989202}}
[[219193  80966   6260]
 [215120 147849   8173]
 [193912 103291  14438]]
testing model out of sample: results/universal/W7/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 200s - 200s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0857846
{'0': {'precision': 0.31679973018122853, 'recall': 0.8018967447257838, 'f1-score': 0.4541726519401968, 'support': 1023754}, '1': {'precision': 0.5408382643988788, 'recall': 0.31501138112430294, 'f1-score': 0.3981311659690278, 'support': 1708970}, '2': {'precision': 0.48953883404532195, 'recall': 0.08812928572937329, 'f1-score': 0.14936849136847347, 'support': 1041538}, 'accuracy': 0.384467215047604, 'macro avg': {'precision': 0.4490589428751431, 'recall': 0.4016791371931534, 'f1-score': 0.33389076975923265, 'support': 3774262}, 'weighted avg': {'precision': 0.46591218569765486, 'recall': 0.384467215047604, 'f1-score': 0.34468413893455485, 'support': 3774262}}
[[ 820945  168076   34733]
 [1109645  538345   60980]
 [ 660779  288969   91790]]
Evaluating performance on  train set...
5285/5285 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0667335
{'0': {'precision': 0.36533881994090645, 'recall': 0.7175691781973818, 'f1-score': 0.4841701737161239, 'support': 410281}, '1': {'precision': 0.5204237423926813, 'recall': 0.32086511433705384, 'f1-score': 0.39697619259014977, 'support': 536484}, '2': {'precision': 0.4376220850035642, 'recall': 0.232932805428192, 'f1-score': 0.30403637772764625, 'support': 405881}, 'accuracy': 0.4148069783224879, 'macro avg': {'precision': 0.44112821577905065, 'recall': 0.42378903265420925, 'f1-score': 0.39506091467797333, 'support': 1352646}, 'weighted avg': {'precision': 0.4485379595853623, 'recall': 0.4148069783224879, 'f1-score': 0.3955357039287691, 'support': 1352646}}
[[294405  61871  54005]
 [296855 172139  67490]
 [214581  96757  94543]]
Evaluating performance on  val set...
1714/1714 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0624602
{'0': {'precision': 0.3545643061006065, 'recall': 0.7437790389472699, 'f1-score': 0.48020958113971074, 'support': 128276}, '1': {'precision': 0.5294196209951474, 'recall': 0.3947595547391949, 'f1-score': 0.4522790803810828, 'support': 180748}, '2': {'precision': 0.49994147255062626, 'recall': 0.13242384311293698, 'f1-score': 0.20938583912441325, 'support': 129010}, 'accuracy': 0.4197048630928193, 'macro avg': {'precision': 0.46130846654879337, 'recall': 0.42365414559980064, 'f1-score': 0.3806248335484022, 'support': 438034}, 'weighted avg': {'precision': 0.46953222343185375, 'recall': 0.4197048630928193, 'f1-score': 0.3889213407097121, 'support': 438034}}
[[ 95409  24089   8778]
 [101086  71352   8310]
 [ 72593  39333  17084]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1234233
{'0': {'precision': 0.3242571309474186, 'recall': 0.8066738268953002, 'f1-score': 0.4625741985494781, 'support': 54002}, '1': {'precision': 0.40568209851163556, 'recall': 0.1442923576379749, 'f1-score': 0.2128710735243355, 'support': 68382}, '2': {'precision': 0.4266278949008204, 'recall': 0.14792942023766656, 'f1-score': 0.2196850183159978, 'support': 55540}, 'accuracy': 0.3464681549425597, 'macro avg': {'precision': 0.3855223747866248, 'recall': 0.3662985349236472, 'f1-score': 0.2983767634632705, 'support': 177924}, 'weighted avg': {'precision': 0.38750702619453664, 'recall': 0.3464681549425597, 'f1-score': 0.29078588350689366, 'support': 177924}}
[[43562  5736  4704]
 [52177  9867  6338]
 [38605  8719  8216]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1124719
{'0': {'precision': 0.3644216925291953, 'recall': 0.739580374173126, 'f1-score': 0.48825838256373155, 'support': 24641}, '1': {'precision': 0.36626506024096384, 'recall': 0.13388700138417012, 'f1-score': 0.19609288610394396, 'support': 23841}, '2': {'precision': 0.39629322685150303, 'recall': 0.22369652122140002, 'f1-score': 0.2859705874357789, 'support': 23514}, 'accuracy': 0.3705205844769154, 'macro avg': {'precision': 0.3756599932072207, 'recall': 0.365721298926232, 'f1-score': 0.32344061870115143, 'support': 71996}, 'weighted avg': {'precision': 0.37544140178625146, 'recall': 0.3705205844769154, 'f1-score': 0.32544221478029256, 'support': 71996}}
[[18224  2545  3872]
 [16508  3192  4141]
 [15276  2978  5260]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1380708
{'0': {'precision': 0.3703648100885753, 'recall': 0.7750549795790135, 'f1-score': 0.5012190166598943, 'support': 6366}, '1': {'precision': 0.367561260210035, 'recall': 0.28, 'f1-score': 0.31786074672048437, 'support': 5625}, '2': {'precision': 0.4361820199778024, 'recall': 0.06030382077643087, 'f1-score': 0.10595847937449447, 'support': 6517}, 'accuracy': 0.3729198184568835, 'macro avg': {'precision': 0.3913693634254709, 'recall': 0.37178626678514815, 'f1-score': 0.308346080918291, 'support': 18508}, 'weighted avg': {'precision': 0.3926881723525316, 'recall': 0.3729198184568835, 'f1-score': 0.30631393832089865, 'support': 18508}}
[[4934 1162  270]
 [3812 1575  238]
 [4576 1548  393]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.001669
{'0': {'precision': 0.29306010000141647, 'recall': 0.7511663368852906, 'f1-score': 0.42162671625442605, 'support': 110174}, '1': {'precision': 0.6605587263442475, 'recall': 0.47447844321875043, 'f1-score': 0.5522653962971974, 'support': 296612}, '2': {'precision': 0.5537532162434277, 'recall': 0.09291935726084997, 'f1-score': 0.15913584414331872, 'support': 106544}, 'accuracy': 0.4546685368086806, 'macro avg': {'precision': 0.5024573475296972, 'recall': 0.4395213791216303, 'f1-score': 0.3776759855649807, 'support': 513330}, 'weighted avg': {'precision': 0.559515966468774, 'recall': 0.4546685368086806, 'f1-score': 0.44263108515287475, 'support': 513330}}
[[ 82759  25046   2369]
 [150267 140736   5609]
 [ 49370  47274   9900]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0502633
{'0': {'precision': 0.294056058733002, 'recall': 0.7672635112895794, 'f1-score': 0.42516597359013647, 'support': 30382}, '1': {'precision': 0.710256336981682, 'recall': 0.3180009468121857, 'f1-score': 0.4393106495802032, 'support': 78157}, '2': {'precision': 0.38053287494628274, 'recall': 0.3053658873025726, 'f1-score': 0.33883064207545727, 'support': 28998}, 'accuracy': 0.4145793495568465, 'macro avg': {'precision': 0.46161509022032227, 'recall': 0.4635434484681125, 'f1-score': 0.401102421748599, 'support': 137537}, 'weighted avg': {'precision': 0.5487992904716236, 'recall': 0.4145793495568465, 'f1-score': 0.41500109794280504, 'support': 137537}}
[[23311  3523  3548]
 [42436 24854 10867]
 [13527  6616  8855]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0170624
{'0': {'precision': 0.30772673637954184, 'recall': 0.8297312122874383, 'f1-score': 0.44894930547310935, 'support': 9115}, '1': {'precision': 0.6586392849228042, 'recall': 0.42972816657027185, 'f1-score': 0.5201108356424092, 'support': 20748}, '2': {'precision': 0.6111111111111112, 'recall': 0.062261891803635575, 'f1-score': 0.1130099772794626, 'support': 9187}, 'accuracy': 0.43664532650448146, 'macro avg': {'precision': 0.5258257108044857, 'recall': 0.44057375688711525, 'f1-score': 0.36069003946499373, 'support': 39050}, 'weighted avg': {'precision': 0.5655481399092354, 'recall': 0.43664532650448146, 'f1-score': 0.40772484503361134, 'support': 39050}}
[[ 7563  1417   135]
 [11603  8916   229]
 [ 5411  3204   572]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.126936
{'0': {'precision': 0.3305637813211845, 'recall': 0.8063203222669815, 'f1-score': 0.4688961589724948, 'support': 71990}, '1': {'precision': 0.4617838055284179, 'recall': 0.1773019130204541, 'f1-score': 0.25622588565415644, 'support': 90642}, '2': {'precision': 0.42718658098246376, 'recall': 0.1562280084447572, 'f1-score': 0.22878587539861553, 'support': 75313}, 'accuracy': 0.3609405534892517, 'macro avg': {'precision': 0.40651138927735536, 'recall': 0.3799500812440642, 'f1-score': 0.31796930667508894, 'support': 237945}, 'weighted avg': {'precision': 0.41113281342978936, 'recall': 0.3609405534892517, 'f1-score': 0.31188388848595217, 'support': 237945}}
[[58047  7409  6534]
 [65328 16071  9243]
 [52225 11322 11766]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077379
{'0': {'precision': 0.3705880509058993, 'recall': 0.7309344956567436, 'f1-score': 0.4918203280188866, 'support': 32349}, '1': {'precision': 0.4240793050151895, 'recall': 0.24507207096217815, 'f1-score': 0.31063223438933457, 'support': 32468}, '2': {'precision': 0.4342650795773706, 'recall': 0.19856898238747553, 'f1-score': 0.27252507448906793, 'support': 32704}, 'accuracy': 0.39064406640620997, 'macro avg': {'precision': 0.40964414516615316, 'recall': 0.3915251830021324, 'f1-score': 0.35832587896576307, 'support': 97521}, 'weighted avg': {'precision': 0.40975138581932546, 'recall': 0.39064406640620997, 'f1-score': 0.35795534513926597, 'support': 97521}}
[[23645  4281  4423]
 [20474  7957  4037]
 [19685  6525  6494]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1144521
{'0': {'precision': 0.3690562145435792, 'recall': 0.7488488907492675, 'f1-score': 0.49443791888343813, 'support': 9556}, '1': {'precision': 0.39600231749710313, 'recall': 0.2841700446938988, 'f1-score': 0.33089258698941, 'support': 9621}, '2': {'precision': 0.4505928853754941, 'recall': 0.12666666666666668, 'f1-score': 0.19774501300954037, 'support': 9900}, 'accuracy': 0.3832582453485573, 'macro avg': {'precision': 0.4052171391387254, 'recall': 0.3865618673699443, 'f1-score': 0.3410251729607962, 'support': 29077}, 'weighted avg': {'precision': 0.4057333647912599, 'recall': 0.3832582453485573, 'f1-score': 0.33930742377376266, 'support': 29077}}
[[7156 1675  725]
 [6083 2734  804]
 [6151 2495 1254]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1065/1065 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1456245
{'0': {'precision': 0.3302565959800126, 'recall': 0.7899536430043079, 'f1-score': 0.46578292545719974, 'support': 85424}, '1': {'precision': 0.340968169110795, 'recall': 0.07297538445389178, 'f1-score': 0.12022065817005896, 'support': 95265}, '2': {'precision': 0.4050107882774368, 'recall': 0.21068805439923283, 'f1-score': 0.2771840032114005, 'support': 91766}, 'accuracy': 0.3441559156557964, 'macro avg': {'precision': 0.35874518445608145, 'recall': 0.3578723606191441, 'f1-score': 0.2877291956128864, 'support': 272455}, 'weighted avg': {'precision': 0.3591800190211365, 'recall': 0.3441559156557964, 'f1-score': 0.2814333701474514, 'support': 272455}}
[[67481  5744 12199]
 [72109  6952 16204]
 [64739  7693 19334]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.132175
{'0': {'precision': 0.3671090740376234, 'recall': 0.7346106234526221, 'f1-score': 0.4895659510640293, 'support': 35544}, '1': {'precision': 0.34877470355731227, 'recall': 0.12975325706555305, 'f1-score': 0.18914110560949993, 'support': 34003}, '2': {'precision': 0.37155282138311413, 'recall': 0.2117575940758652, 'f1-score': 0.26976762095454454, 'support': 33085}, 'accuracy': 0.36566567932029, 'macro avg': {'precision': 0.36247886632601656, 'recall': 0.35870715819801346, 'f1-score': 0.31615822587602455, 'support': 102632}, 'weighted avg': {'precision': 0.36246722531094494, 'recall': 0.36566567932029, 'f1-score': 0.3191768543723282, 'support': 102632}}
[[26111  3807  5626]
 [23367  4412  6224]
 [21648  4431  7006]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.154287
{'0': {'precision': 0.3308614771812365, 'recall': 0.7843294826720241, 'f1-score': 0.4653990582344877, 'support': 9955}, '1': {'precision': 0.3417985012489592, 'recall': 0.07707472775065716, 'f1-score': 0.12578519993871612, 'support': 10652}, '2': {'precision': 0.39163568773234203, 'recall': 0.19556339335437165, 'f1-score': 0.26086418224588337, 'support': 10774}, 'accuracy': 0.34211784200630957, 'macro avg': {'precision': 0.3547652220541792, 'recall': 0.3523225345923509, 'f1-score': 0.2840161468063624, 'support': 31381}, 'weighted avg': {'precision': 0.3554394869593504, 'recall': 0.34211784200630957, 'f1-score': 0.2798974626044, 'support': 31381}}
[[7808  724 1423]
 [7981  821 1850]
 [7810  857 2107]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1332978
{'0': {'precision': 0.31563971925208356, 'recall': 0.8340781069358237, 'f1-score': 0.4579700749364649, 'support': 121961}, '1': {'precision': 0.5055869827750588, 'recall': 0.2333079134158503, 'f1-score': 0.3192807112609629, 'support': 170470}, '2': {'precision': 0.40987314386862034, 'recall': 0.06469337389603738, 'f1-score': 0.11174861922891309, 'support': 128854}, 'accuracy': 0.3556570967397368, 'macro avg': {'precision': 0.4103666152985876, 'recall': 0.3773597980825705, 'f1-score': 0.2963331351421136, 'support': 421285}, 'weighted avg': {'precision': 0.4213227217522932, 'recall': 0.3556570967397368, 'f1-score': 0.2959552980526364, 'support': 421285}}
[[101725  15549   4687]
 [123383  39772   7315]
 [ 97174  23344   8336]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1147974
{'0': {'precision': 0.3693556394536617, 'recall': 0.7043993306323763, 'f1-score': 0.4846056548182597, 'support': 45416}, '1': {'precision': 0.41029220174948816, 'recall': 0.19869310500225326, 'f1-score': 0.26773135778479473, 'support': 44380}, '2': {'precision': 0.40388752594829214, 'recall': 0.23884028211766806, 'f1-score': 0.3001725129384704, 'support': 44804}, 'accuracy': 0.3826894502228826, 'macro avg': {'precision': 0.3945117890504806, 'recall': 0.38064423925076585, 'f1-score': 0.3508365085138416, 'support': 134600}, 'weighted avg': {'precision': 0.39434769946253395, 'recall': 0.3826894502228826, 'f1-score': 0.35170651818284177, 'support': 134600}}
[[31991  5767  7658]
 [27426  8818  8136]
 [27196  6907 10701]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1210269
{'0': {'precision': 0.35555214252802947, 'recall': 0.7625792637733674, 'f1-score': 0.4849818000890355, 'support': 12143}, '1': {'precision': 0.4195053663089127, 'recall': 0.28589600890443634, 'f1-score': 0.3400472813238771, 'support': 12578}, '2': {'precision': 0.4452581471988283, 'recall': 0.09630920323142722, 'f1-score': 0.15836426385361727, 'support': 12626}, 'accuracy': 0.3767906391410287, 'macro avg': {'precision': 0.4067718853452568, 'recall': 0.381594825303077, 'f1-score': 0.32779778175550994, 'support': 37347}, 'weighted avg': {'precision': 0.407417932650113, 'recall': 0.3767906391410287, 'f1-score': 0.3257492140838262, 'support': 37347}}
[[9260 2138  745]
 [8212 3596  770]
 [8572 2838 1216]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
5929/5929 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97889227
{'0': {'precision': 0.3774291760572406, 'recall': 0.6976043493207075, 'f1-score': 0.4898381837636093, 'support': 346169}, '1': {'precision': 0.7048146113457676, 'recall': 0.37635553973925545, 'f1-score': 0.49069220640792527, 'support': 831772}, '2': {'precision': 0.41121635428125985, 'recall': 0.5249888114194187, 'f1-score': 0.4611894763660536, 'support': 339632}, 'accuracy': 0.48289868098602173, 'macro avg': {'precision': 0.49782004722808937, 'recall': 0.5329829001597939, 'f1-score': 0.4805732888458627, 'support': 1517573}, 'weighted avg': {'precision': 0.5644285791801144, 'recall': 0.48289868098602173, 'f1-score': 0.4838947031745776, 'support': 1517573}}
[[241489  51069  53611]
 [317045 313042 201685]
 [ 81292  80037 178303]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0232657
{'0': {'precision': 0.34471870327689225, 'recall': 0.7800210073770092, 'f1-score': 0.4781334341532437, 'support': 81876}, '1': {'precision': 0.6208870996304735, 'recall': 0.33718663845611335, 'f1-score': 0.4370328204659434, 'support': 155970}, '2': {'precision': 0.5064120161574964, 'recall': 0.3106999350352494, 'f1-score': 0.38511780495079034, 'support': 83122}, 'accuracy': 0.44329029685202265, 'macro avg': {'precision': 0.4906726063549541, 'recall': 0.4759691936227906, 'f1-score': 0.43342801985665913, 'support': 320968}, 'weighted avg': {'precision': 0.5207931291776975, 'recall': 0.44329029685202265, 'f1-score': 0.43407263105955657, 'support': 320968}}
[[63865 10197  7814]
 [86021 52591 17358]
 [35381 21915 25826]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9963132
{'0': {'precision': 0.35619887814111806, 'recall': 0.7507686676427525, 'f1-score': 0.4831631391116922, 'support': 27320}, '1': {'precision': 0.6026481418610117, 'recall': 0.4251837930462661, 'f1-score': 0.49859556631087676, 'support': 54273}, '2': {'precision': 0.5451000974731949, 'recall': 0.2632341226736187, 'f1-score': 0.3550238066170187, 'support': 27618}, 'accuracy': 0.46567653441503143, 'macro avg': {'precision': 0.5013157058251082, 'recall': 0.47972886112087904, 'f1-score': 0.4455941706798625, 'support': 109211}, 'weighted avg': {'precision': 0.5264437689065453, 'recall': 0.46567653441503143, 'f1-score': 0.45842764576892864, 'support': 109211}}
[[20511  4664  2145]
 [27275 23076  3922]
 [ 9797 10551  7270]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
5331/5331 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0873089
{'0': {'precision': 0.2560055712484848, 'recall': 0.9178368887835587, 'f1-score': 0.4003456426675053, 'support': 299587}, '1': {'precision': 0.7355395838246916, 'recall': 0.2336619477634502, 'f1-score': 0.3546581515032715, 'support': 760770}, '2': {'precision': 0.5005425547161313, 'recall': 0.08035523534999293, 'f1-score': 0.13847948976470723, 'support': 304249}, 'accuracy': 0.34968555026139414, 'macro avg': {'precision': 0.49736256992976924, 'recall': 0.4106180239656673, 'f1-score': 0.29782776131182803, 'support': 1364606}, 'weighted avg': {'precision': 0.5778678695460512, 'recall': 0.34968555026139414, 'f1-score': 0.316489798704092, 'support': 1364606}}
[[274972  19089   5526]
 [564138 177763  18869]
 [234976  44825  24448]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0504224
{'0': {'precision': 0.32329869083453155, 'recall': 0.7580640206438929, 'f1-score': 0.45328196143893346, 'support': 130208}, '1': {'precision': 0.6235194895676727, 'recall': 0.3299082682726186, 'f1-score': 0.43150460713134703, 'support': 257708}, '2': {'precision': 0.3992504888116446, 'recall': 0.23080787465854502, 'f1-score': 0.2925130817134558, 'support': 127396}, 'accuracy': 0.41359409445151674, 'macro avg': {'precision': 0.4486895564046163, 'recall': 0.43959338785835217, 'f1-score': 0.39243321676124543, 'support': 515312}, 'weighted avg': {'precision': 0.49221627252293126, 'recall': 0.41359409445151674, 'f1-score': 0.4026456272852432, 'support': 515312}}
[[ 98706  18041  13461]
 [141905  85020  30783]
 [ 64698  33294  29404]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0330441
{'0': {'precision': 0.31205147019346063, 'recall': 0.8139909434666915, 'f1-score': 0.45115009443970094, 'support': 42842}, '1': {'precision': 0.6513519530112848, 'recall': 0.4090175921545013, 'f1-score': 0.5024935102679782, 'support': 92996}, '2': {'precision': 0.5487271792234507, 'recall': 0.10139934902948373, 'f1-score': 0.17116846136878622, 'support': 42091}, 'accuracy': 0.4337572852092689, 'macro avg': {'precision': 0.5040435341427321, 'recall': 0.44146929488355885, 'f1-score': 0.3749373553588218, 'support': 177929}, 'weighted avg': {'precision': 0.545377712508697, 'recall': 0.4337572852092689, 'f1-score': 0.41175249978553324, 'support': 177929}}
[[34873  6813  1156]
 [52605 38037  2354]
 [24276 13547  4268]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0794964
{'0': {'precision': 0.36970568255422676, 'recall': 0.7216358147466319, 'f1-score': 0.4889264489737078, 'support': 324291}, '1': {'precision': 0.48187077650855537, 'recall': 0.4545246136429704, 'f1-score': 0.467798391196581, 'support': 423119}, '2': {'precision': 0.4773585365259543, 'recall': 0.06016147847976914, 'f1-score': 0.10685591055445441, 'support': 325740}, 'accuracy': 0.4155383683548432, 'macro avg': {'precision': 0.44297833186291213, 'recall': 0.4121073022897905, 'f1-score': 0.3545269169082477, 'support': 1073150}, 'weighted avg': {'precision': 0.44660641687991476, 'recall': 0.4155383683548432, 'f1-score': 0.3646238446189692, 'support': 1073150}}
[[234020  79192  11079]
 [220424 192318  10377]
 [178546 127597  19597]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0721035
{'0': {'precision': 0.3973651818776427, 'recall': 0.726988344593003, 'f1-score': 0.5138594738594738, 'support': 106131}, '1': {'precision': 0.4426393777321292, 'recall': 0.3401840549854643, 'f1-score': 0.3847070798338767, 'support': 103882}, '2': {'precision': 0.4802378796407332, 'recall': 0.18714593625422016, 'f1-score': 0.26933397385306934, 'support': 104854}, 'accuracy': 0.4195993864075943, 'macro avg': {'precision': 0.44008081308350167, 'recall': 0.41810611194422914, 'f1-score': 0.3893001758488066, 'support': 314867}, 'weighted avg': {'precision': 0.4398996737901228, 'recall': 0.4195993864075943, 'f1-score': 0.38981952755249777, 'support': 314867}}
[[77156 17679 11296]
 [58601 35339  9942]
 [58412 26819 19623]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777085
{'0': {'precision': 0.38708810085740747, 'recall': 0.7568341121495327, 'f1-score': 0.51220524578499, 'support': 34240}, '1': {'precision': 0.43928080537910025, 'recall': 0.34907749077490774, 'f1-score': 0.3890186531565615, 'support': 33875}, '2': {'precision': 0.4954653937947494, 'recall': 0.12165250512745385, 'f1-score': 0.1953422724064926, 'support': 34130}, 'accuracy': 0.409711966355323, 'macro avg': {'precision': 0.44061143334375236, 'recall': 0.4091880360172981, 'f1-score': 0.3655220571160147, 'support': 102245}, 'weighted avg': {'precision': 0.4405571690135405, 'recall': 0.409711966355323, 'f1-score': 0.36562126508474907, 'support': 102245}}
[[25914  5941  2385]
 [20207 11825  1843]
 [20825  9153  4152]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
6143/6143 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0612527
{'0': {'precision': 0.3870569731811156, 'recall': 0.7193488641661102, 'f1-score': 0.5033035521449949, 'support': 476214}, '1': {'precision': 0.47873483552407325, 'recall': 0.47670137351181335, 'f1-score': 0.4777159406017571, 'support': 618706}, '2': {'precision': 0.5499467608159605, 'recall': 0.08219112110590433, 'f1-score': 0.14300911909472128, 'support': 477582}, 'accuracy': 0.43036829205940597, 'macro avg': {'precision': 0.4719128565070498, 'recall': 0.42608045292794267, 'f1-score': 0.3746762039471578, 'support': 1572502}, 'weighted avg': {'precision': 0.47259891465844694, 'recall': 0.43036829205940597, 'f1-score': 0.38381159301712975, 'support': 1572502}}
[[342564 120323  13327]
 [304972 294938  18796]
 [237512 200817  39253]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.056658
{'0': {'precision': 0.4052810328302983, 'recall': 0.683081270016379, 'f1-score': 0.5087274373527612, 'support': 177667}, '1': {'precision': 0.4603575659223653, 'recall': 0.3775233453312145, 'f1-score': 0.41484589516551995, 'support': 178087}, '2': {'precision': 0.48530065545739526, 'recall': 0.2398978942089337, 'f1-score': 0.3210778768270058, 'support': 177463}, 'accuracy': 0.43353081390878384, 'macro avg': {'precision': 0.4503130847366863, 'recall': 0.43350083651884236, 'f1-score': 0.41488373644842896, 'support': 533217}, 'weighted avg': {'precision': 0.4503076108258226, 'recall': 0.43353081390878384, 'f1-score': 0.4149195952114165, 'support': 533217}}
[[121361  31647  24659]
 [ 90362  67232  20493]
 [ 87726  47164  42573]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0636204
{'0': {'precision': 0.3976860208075605, 'recall': 0.6836270459655912, 'f1-score': 0.5028495964407291, 'support': 57369}, '1': {'precision': 0.45138643276508456, 'recall': 0.4259277800026699, 'f1-score': 0.43828771592431065, 'support': 59928}, '2': {'precision': 0.49107812265707, 'recall': 0.16975948579722164, 'f1-score': 0.2523015292169023, 'support': 57876}, 'accuracy': 0.4256877486827308, 'macro avg': {'precision': 0.44671685874323835, 'recall': 0.4264381039218275, 'f1-score': 0.39781294719398064, 'support': 175173}, 'weighted avg': {'precision': 0.44691346781384983, 'recall': 0.4256877486827308, 'f1-score': 0.39798306841281317, 'support': 175173}}
[[39219 12202  5948]
 [30169 25525  4234]
 [29230 18821  9825]]
testing model on single stock: results/universal/W7/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
23942/23942 - 319s - 319s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1113584
{'0': {'precision': 0.28547106114648935, 'recall': 0.7261429601385452, 'f1-score': 0.40982587629911105, 'support': 1614492}, '1': {'precision': 0.5090048768268298, 'recall': 0.35442515230350324, 'f1-score': 0.4178778242732242, 'support': 2900951}, '2': {'precision': 0.4345263157894737, 'recall': 0.0006395553850625395, 'f1-score': 0.001277230884234862, 'support': 1613621}, 'accuracy': 0.35919905551647036, 'macro avg': {'precision': 0.409667417920931, 'recall': 0.3604025559423703, 'f1-score': 0.27632697715219, 'support': 6129064}, 'weighted avg': {'precision': 0.4305143067683276, 'recall': 0.35919905551647036, 'f1-score': 0.30607685895559067, 'support': 6129064}}
[[1172352  441798     342]
 [1871780 1028170    1001]
 [1062596  549993    1032]]
Evaluating performance on  train set...
9052/9052 - 125s - 125s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.136796
{'0': {'precision': 0.35835795764577205, 'recall': 0.7476576192262819, 'f1-score': 0.48449418443448433, 'support': 778268}, '1': {'precision': 0.3799885508054253, 'recall': 0.32800324759543054, 'f1-score': 0.3520873518444139, 'support': 771032}, '2': {'precision': 0.44227794366298523, 'recall': 0.016012399385240565, 'f1-score': 0.030905870833369996, 'support': 767780}, 'accuracy': 0.3655777961917586, 'macro avg': {'precision': 0.39354148403806083, 'recall': 0.363891088735651, 'f1-score': 0.28916246903742276, 'support': 2317080}, 'weighted avg': {'precision': 0.39336320837918204, 'recall': 0.3655777961917586, 'f1-score': 0.2901349303896301, 'support': 2317080}}
[[581878 189088   7302]
 [509930 252901   8201]
 [531926 223560  12294]]
Evaluating performance on  val set...
2763/2763 - 37s - 37s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1406089
{'0': {'precision': 0.3459311700477602, 'recall': 0.6983599732493612, 'f1-score': 0.46267649440734265, 'support': 225789}, '1': {'precision': 0.41158468462717057, 'recall': 0.40999785368490504, 'f1-score': 0.41078973672787517, 'support': 251594}, '2': {'precision': 0.4369266055045872, 'recall': 0.0016570116382234748, 'f1-score': 0.0033015025736122428, 'support': 229932}, 'accuracy': 0.36930646176031895, 'macro avg': {'precision': 0.398147486726506, 'recall': 0.3700049461908299, 'f1-score': 0.2922559112362767, 'support': 707315}, 'weighted avg': {'precision': 0.39886485986425113, 'recall': 0.36930646176031895, 'f1-score': 0.29488787472032735, 'support': 707315}}
[[157682  67909    198]
 [148148 103153    293]
 [149989  79562    381]]
training model: results/universal/W7/deepLOB_L2/h100
Epoch 1/50
12475/12475 - 498s - loss: 3.2435 - accuracy100: 0.3921 - val_loss: 3.5566 - val_accuracy100: 0.3356 - 498s/epoch - 40ms/step
Epoch 2/50
12475/12475 - 490s - loss: 3.2223 - accuracy100: 0.4053 - val_loss: 3.6092 - val_accuracy100: 0.3383 - 490s/epoch - 39ms/step
Epoch 3/50
12475/12475 - 493s - loss: 3.2125 - accuracy100: 0.4102 - val_loss: 3.6775 - val_accuracy100: 0.3392 - 493s/epoch - 39ms/step
Epoch 4/50
12475/12475 - 491s - loss: 3.2055 - accuracy100: 0.4140 - val_loss: 3.6857 - val_accuracy100: 0.3385 - 491s/epoch - 39ms/step
Epoch 5/50
12475/12475 - 492s - loss: 3.2000 - accuracy100: 0.4167 - val_loss: 3.7073 - val_accuracy100: 0.3389 - 492s/epoch - 39ms/step
Epoch 6/50
12475/12475 - 491s - loss: 3.1948 - accuracy100: 0.4192 - val_loss: 3.6792 - val_accuracy100: 0.3368 - 491s/epoch - 39ms/step
Epoch 7/50
12475/12475 - 491s - loss: 3.1909 - accuracy100: 0.4212 - val_loss: 3.6627 - val_accuracy100: 0.3356 - 491s/epoch - 39ms/step
Epoch 8/50
12475/12475 - 491s - loss: 3.1871 - accuracy100: 0.4230 - val_loss: 3.6106 - val_accuracy100: 0.3354 - 491s/epoch - 39ms/step
Epoch 9/50
12475/12475 - 490s - loss: 3.1837 - accuracy100: 0.4244 - val_loss: 3.6045 - val_accuracy100: 0.3373 - 490s/epoch - 39ms/step
Epoch 10/50
12475/12475 - 490s - loss: 3.1810 - accuracy100: 0.4254 - val_loss: 3.5756 - val_accuracy100: 0.3332 - 490s/epoch - 39ms/step
Epoch 11/50
12475/12475 - 490s - loss: 3.1781 - accuracy100: 0.4265 - val_loss: 3.5867 - val_accuracy100: 0.3326 - 490s/epoch - 39ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 494s - 494s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1505116
{'0': {'precision': 0.3022837526793899, 'recall': 0.7728427521653201, 'f1-score': 0.43458663943801495, 'support': 2818290}, '1': {'precision': 0.4194809802817513, 'recall': 0.21921734892033454, 'f1-score': 0.2879528698149234, 'support': 3877590}, '2': {'precision': 0.39477549230937853, 'recall': 0.03845759606391021, 'f1-score': 0.07008752021306336, 'support': 2809692}, 'accuracy': 0.3299311182956691, 'macro avg': {'precision': 0.3721800750901732, 'recall': 0.34350589904985496, 'f1-score': 0.2642090098220005, 'support': 9505572}, 'weighted avg': {'precision': 0.3774308452144948, 'recall': 0.3299311182956691, 'f1-score': 0.26703061040092, 'support': 9505572}}
[[2178095  576523   63672]
 [2925571  850035  101984]
 [2101799  599839  108054]]
Evaluating performance on  train set...
12475/12475 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1592981
{'0': {'precision': 0.3388034385677748, 'recall': 0.8378294283912261, 'f1-score': 0.4824945813486469, 'support': 1070225}, '1': {'precision': 0.3580531629695632, 'recall': 0.17313690905865226, 'f1-score': 0.23340879726355726, 'support': 1065313}, '2': {'precision': 0.3861521794544991, 'recall': 0.011459548804496447, 'f1-score': 0.022258547381374377, 'support': 1057546}, 'accuracy': 0.34237433152400626, 'macro avg': {'precision': 0.361002926997279, 'recall': 0.34080862875145823, 'f1-score': 0.24605397533119286, 'support': 3193084}, 'weighted avg': {'precision': 0.3609076028119457, 'recall': 0.34237433152400626, 'f1-score': 0.2469620677414282, 'support': 3193084}}
[[896666 163495  10064]
 [871667 184445   9201]
 [878234 167193  12119]]
Evaluating performance on  val set...
3866/3866 - 52s - 52s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1835841
{'0': {'precision': 0.33087612135714717, 'recall': 0.778778577868903, 'f1-score': 0.4644313864863023, 'support': 323852}, '1': {'precision': 0.3515096810732363, 'recall': 0.23900336043947448, 'f1-score': 0.2845389994717096, 'support': 332397}, '2': {'precision': 0.46624472573839665, 'recall': 0.0013275146942661577, 'f1-score': 0.0026474913222781604, 'support': 332953}, 'accuracy': 0.33572010570136335, 'macro avg': {'precision': 0.3828768427229267, 'recall': 0.3397031510008812, 'f1-score': 0.25053929242676337, 'support': 989202}, 'weighted avg': {'precision': 0.38337289783303286, 'recall': 0.33572010570136335, 'f1-score': 0.24855230110936524, 'support': 989202}}
[[252209  71344    299]
 [252746  79444    207]
 [257291  75220    442]]
testing model out of sample: results/universal/W7/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 197s - 197s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1574768
{'0': {'precision': 0.2963654539192379, 'recall': 0.8094044209349726, 'f1-score': 0.43386877155838205, 'support': 1089679}, '1': {'precision': 0.4517818304763154, 'recall': 0.22925423698432473, 'f1-score': 0.30416274196877285, 'support': 1562078}, '2': {'precision': 0.5070928353384809, 'recall': 0.0025158017113509515, 'f1-score': 0.005006763740676587, 'support': 1122505}, 'accuracy': 0.32931683068107087, 'macro avg': {'precision': 0.41841337324467814, 'recall': 0.3470581532102161, 'f1-score': 0.24767942575594382, 'support': 3774262}, 'weighted avg': {'precision': 0.42336115319489337, 'recall': 0.32931683068107087, 'f1-score': 0.25263845861913964, 'support': 3774262}}
[[ 881991  206660    1028]
 [1202248  358113    1717]
 [ 891786  227895    2824]]
Evaluating performance on  train set...
5285/5285 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1387914
{'0': {'precision': 0.3341838712696128, 'recall': 0.8387975697271759, 'f1-score': 0.47794894150203016, 'support': 447028}, '1': {'precision': 0.37976413236163087, 'recall': 0.13314314322954882, 'f1-score': 0.1971623046687758, 'support': 463396}, '2': {'precision': 0.3788281215607437, 'recall': 0.05837791878287376, 'f1-score': 0.10116601909598742, 'support': 442222}, 'accuracy': 0.34190763880571856, 'macro avg': {'precision': 0.36425870839732916, 'recall': 0.3434395439131995, 'f1-score': 0.25875908842226447, 'support': 1352646}, 'weighted avg': {'precision': 0.36439456964985517, 'recall': 0.34190763880571856, 'f1-score': 0.2585736564132281, 'support': 1352646}}
[[374966  49710  22352]
 [381719  61698  19979]
 [365350  51056  25816]]
Evaluating performance on  val set...
1714/1714 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1530887
{'0': {'precision': 0.3230768393823255, 'recall': 0.8489325356833988, 'f1-score': 0.4680345504267576, 'support': 139911}, '1': {'precision': 0.391555027980329, 'recall': 0.16278801474122737, 'f1-score': 0.22996758596961414, 'support': 156025}, '2': {'precision': 0.4443037974683544, 'recall': 0.017290883756280878, 'f1-score': 0.03328636843959141, 'support': 142098}, 'accuracy': 0.33474798759913615, 'macro avg': {'precision': 0.38631188827700297, 'recall': 0.3430038113936356, 'f1-score': 0.24376283494532106, 'support': 438034}, 'weighted avg': {'precision': 0.3867943080402654, 'recall': 0.33474798759913615, 'f1-score': 0.24220448862005275, 'support': 438034}}
[[118775  18923   2213]
 [129766  25399    860]
 [119096  20545   2457]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1737334
{'0': {'precision': 0.29955594642522454, 'recall': 0.7834357678820557, 'f1-score': 0.43339730084896017, 'support': 53042}, '1': {'precision': 0.398028751627812, 'recall': 0.21844170403587443, 'f1-score': 0.2820770337395836, 'support': 71360}, '2': {'precision': 0.28205128205128205, 'recall': 0.0002055229625200852, 'f1-score': 0.0004107466253430668, 'support': 53522}, 'accuracy': 0.32122704075897573, 'macro avg': {'precision': 0.3265453267014395, 'recall': 0.33402766496015013, 'f1-score': 0.2386283604046289, 'support': 177924}, 'weighted avg': {'precision': 0.33378480106335373, 'recall': 0.32122704075897573, 'f1-score': 0.24245891920240573, 'support': 177924}}
[[41555 11476    11]
 [55755 15588    17]
 [41412 12099    11]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1471124
{'0': {'precision': 0.3432608394514476, 'recall': 0.9057753228819755, 'f1-score': 0.4978513946402063, 'support': 24622}, '1': {'precision': 0.3328953851207095, 'recall': 0.08498595446731794, 'f1-score': 0.13540414161656647, 'support': 23851}, '2': {'precision': 0.3557692307692308, 'recall': 0.014156357607448029, 'f1-score': 0.027229240770268608, 'support': 23523}, 'accuracy': 0.3425468081560087, 'macro avg': {'precision': 0.3439751517804626, 'recall': 0.3349725449855805, 'f1-score': 0.2201615923423471, 'support': 71996}, 'weighted avg': {'precision': 0.34391377069381907, 'recall': 0.3425468081560087, 'f1-score': 0.22401431539484018, 'support': 71996}}
[[22302  2025   295]
 [21516  2027   308]
 [21153  2037   333]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1947895
{'0': {'precision': 0.3533446604996539, 'recall': 0.8567287152883735, 'f1-score': 0.5003341501447984, 'support': 6554}, '1': {'precision': 0.2754237288135593, 'recall': 0.13816425120772946, 'f1-score': 0.18401750096512673, 'support': 5175}, '2': {'precision': 0.38095238095238093, 'recall': 0.001180115061218469, 'f1-score': 0.0023529411764705885, 'support': 6779}, 'accuracy': 0.3424465096174627, 'macro avg': {'precision': 0.3365735900885314, 'recall': 0.33202436051910716, 'f1-score': 0.2289015307621319, 'support': 18508}, 'weighted avg': {'precision': 0.3416692723147337, 'recall': 0.3424465096174627, 'f1-score': 0.22949163474058967, 'support': 18508}}
[[5615  932    7]
 [4454  715    6]
 [5822  949    8]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1313627
{'0': {'precision': 0.3025043024818645, 'recall': 0.873496044524209, 'f1-score': 0.44938134983067113, 'support': 154343}, '1': {'precision': 0.4064394166716678, 'recall': 0.12834787058137936, 'f1-score': 0.1950892808918367, 'support': 211067}, '2': {'precision': 0.36019900497512436, 'recall': 0.002447268793942672, 'f1-score': 0.004861507470203122, 'support': 147920}, 'accuracy': 0.3161124422885863, 'macro avg': {'precision': 0.3563809080428855, 'recall': 0.3347637279665104, 'f1-score': 0.21644404606423698, 'support': 513330}, 'weighted avg': {'precision': 0.3618647005484147, 'recall': 0.3161124422885863, 'f1-score': 0.21673171081352152, 'support': 513330}}
[[134818  19204    321]
 [183655  27090    322]
 [127200  20358    362]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1213471
{'0': {'precision': 0.30435412329139133, 'recall': 0.8080074980173512, 'f1-score': 0.44215911257816554, 'support': 41611}, '1': {'precision': 0.43646367759684734, 'recall': 0.10335962811663614, 'f1-score': 0.16713885052889338, 'support': 56792}, '2': {'precision': 0.35923043031282126, 'recall': 0.12500638830684316, 'f1-score': 0.18547164088565365, 'support': 39134}, 'accuracy': 0.3227058900514044, 'macro avg': {'precision': 0.36668274373368664, 'recall': 0.3454578381469435, 'f1-score': 0.2649232013309042, 'support': 137537}, 'weighted avg': {'precision': 0.37451920764754343, 'recall': 0.3227058900514044, 'f1-score': 0.2555609009004568, 'support': 137537}}
[[33622  3758  4231]
 [46427  5870  4495]
 [30421  3821  4892]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1476656
{'0': {'precision': 0.314410348977136, 'recall': 0.8638617953380724, 'f1-score': 0.46102607084564823, 'support': 12098}, '1': {'precision': 0.3990976921742148, 'recall': 0.15662240381341505, 'f1-score': 0.2249608763693271, 'support': 14685}, '2': {'precision': 0.3829787234042553, 'recall': 0.001467351430667645, 'f1-score': 0.002923501705375995, 'support': 12267}, 'accuracy': 0.3269910371318822, 'macro avg': {'precision': 0.365495588185202, 'recall': 0.34065051686071834, 'f1-score': 0.2296368163067838, 'support': 39050}, 'weighted avg': {'precision': 0.3677973370423492, 'recall': 0.3269910371318822, 'f1-score': 0.22834587631226808, 'support': 39050}}
[[10451  1633    14]
 [12370  2300    15]
 [10419  1830    18]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1850253
{'0': {'precision': 0.3326069233663615, 'recall': 0.8065108852675064, 'f1-score': 0.47098044149097557, 'support': 78914}, '1': {'precision': 0.33874824948831195, 'recall': 0.2004053227286632, 'f1-score': 0.25182788637874287, 'support': 78456}, '2': {'precision': 0.2696629213483146, 'recall': 0.0005957182748991623, 'f1-score': 0.0011888103228363033, 'support': 80575}, 'accuracy': 0.3337578011725399, 'macro avg': {'precision': 0.3136726980676627, 'recall': 0.33583730875702295, 'f1-score': 0.24133237939751825, 'support': 237945}, 'weighted avg': {'precision': 0.31331721742431445, 'recall': 0.3337578011725399, 'f1-score': 0.2396358301511359, 'support': 237945}}
[[63645 15210    59]
 [62662 15723    71]
 [65045 15482    48]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1696329
{'0': {'precision': 0.3355132328800032, 'recall': 0.7748189243334874, 'f1-score': 0.4682598815333606, 'support': 32445}, '1': {'precision': 0.3536905700026267, 'recall': 0.16700257356361042, 'f1-score': 0.2268792518797784, 'support': 32251}, '2': {'precision': 0.35093673635623135, 'recall': 0.07875095201827875, 'f1-score': 0.1286357642258217, 'support': 32825}, 'accuracy': 0.3395166169337886, 'macro avg': {'precision': 0.3467135130796204, 'recall': 0.34019081663845885, 'f1-score': 0.27459163254632024, 'support': 97521}, 'weighted avg': {'precision': 0.34671608971236667, 'recall': 0.3395166169337886, 'f1-score': 0.2741178163619858, 'support': 97521}}
[[25139  4763  2543]
 [24627  5386  2238]
 [25161  5079  2585]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1980667
{'0': {'precision': 0.3341490640563283, 'recall': 0.8063613758806465, 'f1-score': 0.47249878581835836, 'support': 9652}, '1': {'precision': 0.33552517736632637, 'recall': 0.20878647571874664, 'f1-score': 0.2574007699455728, 'support': 9287}, '2': {'precision': 0.5, 'recall': 0.0002959163543105149, 'f1-score': 0.0005914826498422714, 'support': 10138}, 'accuracy': 0.33445678715135674, 'macro avg': {'precision': 0.38989141380755155, 'recall': 0.33848125598456785, 'f1-score': 0.24349701280459116, 'support': 29077}, 'weighted avg': {'precision': 0.39241424797856567, 'recall': 0.33445678715135674, 'f1-score': 0.23926249896163393, 'support': 29077}}
[[7783 1868    1]
 [7346 1939    2]
 [8163 1972    3]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2037463
{'0': {'precision': 0.3133931569717548, 'recall': 0.7922045768047253, 'f1-score': 0.44911722538407295, 'support': 84819}, '1': {'precision': 0.34229782216673604, 'recall': 0.21018952299829644, 'f1-score': 0.26044910021637024, 'support': 93920}, '2': {'precision': 0.38666666666666666, 'recall': 0.0015472277946135132, 'f1-score': 0.0030821226259684776, 'support': 93716}, 'accuracy': 0.31961241305903726, 'macro avg': {'precision': 0.3474525486017192, 'recall': 0.3346471091992118, 'f1-score': 0.23754948274213725, 'support': 272455}, 'weighted avg': {'precision': 0.3485608961935749, 'recall': 0.31961241305903726, 'f1-score': 0.23065789813432833, 'support': 272455}}
[[67194 17508   117]
 [74066 19741   113]
 [73148 20423   145]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1509204
{'0': {'precision': 0.349717388895046, 'recall': 0.8853070729175434, 'f1-score': 0.5013783734398958, 'support': 35643}, '1': {'precision': 0.33072733661278986, 'recall': 0.11146968261487447, 'f1-score': 0.16674047829938, 'support': 33776}, '2': {'precision': 0.3555992141453831, 'recall': 0.010899346641375365, 'f1-score': 0.021150419210657006, 'support': 33213}, 'accuracy': 0.3476693428950035, 'macro avg': {'precision': 0.34534797988440635, 'recall': 0.33589203405793105, 'f1-score': 0.2297564236499776, 'support': 102632}, 'weighted avg': {'precision': 0.3453712303495043, 'recall': 0.3476693428950035, 'f1-score': 0.2358418878400656, 'support': 102632}}
[[31555  3755   333]
 [29688  3765   323]
 [28987  3864   362]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1961415
{'0': {'precision': 0.3124178843014691, 'recall': 0.8048205128205128, 'f1-score': 0.45011041959445897, 'support': 9750}, '1': {'precision': 0.3424635591862886, 'recall': 0.20135618760595217, 'f1-score': 0.2536029891465512, 'support': 10618}, '2': {'precision': 0.2857142857142857, 'recall': 0.0005448106782892945, 'f1-score': 0.001087547580206634, 'support': 11013}, 'accuracy': 0.3183773620980848, 'macro avg': {'precision': 0.31353190973401446, 'recall': 0.3355738370349181, 'f1-score': 0.2349336521070723, 'support': 31381}, 'weighted avg': {'precision': 0.3132125767805604, 'recall': 0.3183773620980848, 'f1-score': 0.22603837644768718, 'support': 31381}}
[[7847 1896    7]
 [8472 2138    8]
 [8798 2209    6]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
1646/1646 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1655202
{'0': {'precision': 0.26758701763988757, 'recall': 0.7771114262231414, 'f1-score': 0.39809560383377723, 'support': 110719}, '1': {'precision': 0.47652509109890884, 'recall': 0.25116402116402115, 'f1-score': 0.3289480522630337, 'support': 189000}, '2': {'precision': 0.27419354838709675, 'recall': 0.0002796834641264827, 'f1-score': 0.0005587969430520173, 'support': 121566}, 'accuracy': 0.3169944336969035, 'macro avg': {'precision': 0.33943521904196433, 'recall': 0.3428517102837631, 'f1-score': 0.24253415101328768, 'support': 421285}, 'weighted avg': {'precision': 0.3632287456875756, 'recall': 0.3169944336969035, 'f1-score': 0.2523608952318844, 'support': 421285}}
[[ 86041  24645     33]
 [141473  47470     57]
 [ 94030  27502     34]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1403134
{'0': {'precision': 0.3350870462724466, 'recall': 0.8175517571813785, 'f1-score': 0.47534579378704933, 'support': 44873}, '1': {'precision': 0.36183656276326875, 'recall': 0.1340571632407366, 'f1-score': 0.1956337844872462, 'support': 44854}, '2': {'precision': 0.3784705882352941, 'recall': 0.07169121743587457, 'f1-score': 0.12054784254210929, 'support': 44873}, 'accuracy': 0.3411292719167905, 'macro avg': {'precision': 0.35846473242366983, 'recall': 0.3411000459526632, 'f1-score': 0.26384247360546825, 'support': 134600}, 'weighted avg': {'precision': 0.358464256459506, 'recall': 0.3411292719167905, 'f1-score': 0.26385210187510605, 'support': 134600}}
[[36686  5248  2939]
 [36497  6013  2344]
 [36299  5357  3217]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1757313
{'0': {'precision': 0.3341585750112533, 'recall': 0.8484774267287125, 'f1-score': 0.47948144218126454, 'support': 12249}, '1': {'precision': 0.3626426619514547, 'recall': 0.1838780666721004, 'f1-score': 0.24402379664683607, 'support': 12269}, '2': {'precision': 0.4583333333333333, 'recall': 0.0008574323797645958, 'f1-score': 0.0017116626468528747, 'support': 12829}, 'accuracy': 0.3389830508474576, 'macro avg': {'precision': 0.3850448567653471, 'recall': 0.34440430859352583, 'f1-score': 0.2417389671583178, 'support': 37347}, 'weighted avg': {'precision': 0.3861710321613134, 'recall': 0.3389830508474576, 'f1-score': 0.23801255968176335, 'support': 37347}}
[[10393  1848     8]
 [10008  2256     5]
 [10701  2117    11]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
5929/5929 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946466
{'0': {'precision': 0.32994202506767395, 'recall': 0.7797108393170473, 'f1-score': 0.4636754097582168, 'support': 463341}, '1': {'precision': 0.4769756181341366, 'recall': 0.11870422581520175, 'f1-score': 0.19009883264794616, 'support': 608285}, '2': {'precision': 0.39556619007941485, 'recall': 0.24059137072342676, 'f1-score': 0.29920201455420603, 'support': 445947}, 'accuracy': 0.35633804765899235, 'macro avg': {'precision': 0.4008279444270751, 'recall': 0.379668811951892, 'f1-score': 0.31765875232012303, 'support': 1517573}, 'weighted avg': {'precision': 0.4081611477543085, 'recall': 0.35633804765899235, 'f1-score': 0.3056869997255106, 'support': 1517573}}
[[361272  39192  62877]
 [435013  72206 101066]
 [298671  39985 107291]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1572276
{'0': {'precision': 0.3341369105322266, 'recall': 0.868424305232033, 'f1-score': 0.48259100755534423, 'support': 105179}, '1': {'precision': 0.3685153620908177, 'recall': 0.15688317487487674, 'f1-score': 0.22007621235057684, 'support': 107494}, '2': {'precision': 0.4867208672086721, 'recall': 0.008292164919894733, 'f1-score': 0.01630651897584892, 'support': 108295}, 'accuracy': 0.3399155055955734, 'macro avg': {'precision': 0.39645771327723883, 'recall': 0.34453321500893486, 'f1-score': 0.23965791296059, 'support': 320968}, 'weighted avg': {'precision': 0.3971324641703302, 'recall': 0.3399155055955734, 'f1-score': 0.23734835381273528, 'support': 320968}}
[[91340 13445   394]
 [90077 16864   553]
 [91944 15453   898]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1373267
{'0': {'precision': 0.331191201104076, 'recall': 0.8848264797770835, 'f1-score': 0.481977769260253, 'support': 35529}, '1': {'precision': 0.3812118570183086, 'recall': 0.13971880492091387, 'f1-score': 0.20448965275341988, 'support': 37554}, '2': {'precision': 0.5095057034220533, 'recall': 0.00741806908768822, 'f1-score': 0.014623233480656953, 'support': 36128}, 'accuracy': 0.3383541950902382, 'macro avg': {'precision': 0.4073029205148126, 'recall': 0.34398778459522855, 'f1-score': 0.2336968851647766, 'support': 109211}, 'weighted avg': {'precision': 0.40737969907540644, 'recall': 0.3383541950902382, 'f1-score': 0.23195374790761586, 'support': 109211}}
[[31437  3941   151]
 [32200  5247   107]
 [31284  4576   268]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
5331/5331 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1588224
{'0': {'precision': 0.2916760411329523, 'recall': 0.7991452880767687, 'f1-score': 0.4273688599124752, 'support': 386095}, '1': {'precision': 0.46892990953120717, 'recall': 0.24573081152633855, 'f1-score': 0.32247617316244664, 'support': 584713}, '2': {'precision': 0.3543956043956044, 'recall': 0.00032757911416513035, 'f1-score': 0.0006545532040125633, 'support': 393798}, 'accuracy': 0.33149275321961064, 'macro avg': {'precision': 0.3716671850199213, 'recall': 0.34840122623909076, 'f1-score': 0.2501665287596448, 'support': 1364606}, 'weighted avg': {'precision': 0.38572625029695623, 'recall': 0.33149275321961064, 'f1-score': 0.2592827177580009, 'support': 1364606}}
[[308546  77451     98]
 [440894 143682    137]
 [308398  85271    129]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1300074
{'0': {'precision': 0.32637674005570116, 'recall': 0.8131861506833624, 'f1-score': 0.46580148770262525, 'support': 165871}, '1': {'precision': 0.4013672594404255, 'recall': 0.14523954234776026, 'f1-score': 0.21329554218423968, 'support': 187566}, '2': {'precision': 0.37377788185703414, 'recall': 0.07888185328185328, 'f1-score': 0.1302713263312538, 'support': 161875}, 'accuracy': 0.3393963268854597, 'macro avg': {'precision': 0.3671739604510536, 'recall': 0.34576918210432533, 'f1-score': 0.26978945207270627, 'support': 515312}, 'weighted avg': {'precision': 0.36856231226827524, 'recall': 0.3393963268854597, 'f1-score': 0.26849291532493513, 'support': 515312}}
[[134884  20143  10844]
 [149775  27242  10549]
 [128618  20488  12769]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1396092
{'0': {'precision': 0.31417970449063515, 'recall': 0.8687404329761644, 'f1-score': 0.46146921312205363, 'support': 54876}, '1': {'precision': 0.43019776974783386, 'recall': 0.16082270574906313, 'f1-score': 0.23412241100409167, 'support': 68846}, '2': {'precision': 0.44713656387665196, 'recall': 0.00374490379471286, 'f1-score': 0.007427599202356342, 'support': 54207}, 'accuracy': 0.33130068735282053, 'macro avg': {'precision': 0.3971713460383737, 'recall': 0.34443601417331343, 'f1-score': 0.23433974110950054, 'support': 177929}, 'weighted avg': {'precision': 0.39957653242444535, 'recall': 0.33130068735282053, 'f1-score': 0.2351758505765538, 'support': 177929}}
[[47673  7060   143]
 [57666 11072   108]
 [46399  7605   203]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.172528
{'0': {'precision': 0.3002534395365677, 'recall': 0.761970693069307, 'f1-score': 0.43076468401986373, 'support': 315625}, '1': {'precision': 0.4212401943297206, 'recall': 0.26594610910526256, 'f1-score': 0.3260460522008443, 'support': 430685}, '2': {'precision': 0.3831417624521073, 'recall': 0.00030596010280259454, 'f1-score': 0.0006114319430390001, 'support': 326840}, 'accuracy': 0.3309285747565578, 'macro avg': {'precision': 0.36821179877279847, 'recall': 0.34274092075912405, 'f1-score': 0.25247405605458234, 'support': 1073150}, 'weighted avg': {'precision': 0.3740533742612604, 'recall': 0.3309285747565578, 'f1-score': 0.25773012887495034, 'support': 1073150}}
[[240497  75043     85]
 [316070 114539     76]
 [244413  82327    100]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1383915
{'0': {'precision': 0.34201988792560417, 'recall': 0.8804364127174565, 'f1-score': 0.4926585319161769, 'support': 106688}, '1': {'precision': 0.3623809824074658, 'recall': 0.11163233394520361, 'f1-score': 0.17068480335013847, 'support': 102963}, '2': {'precision': 0.4252643948296122, 'recall': 0.034395909367396595, 'f1-score': 0.06364419745704589, 'support': 105216}, 'accuracy': 0.3463208275240022, 'macro avg': {'precision': 0.37655508838756074, 'recall': 0.34215488534335226, 'f1-score': 0.24232917757445374, 'support': 314867}, 'weighted avg': {'precision': 0.37649505810713485, 'recall': 0.3463208275240022, 'f1-score': 0.2440121090493889, 'support': 314867}}
[[93932 10027  2729]
 [89307 11494  2162]
 [91400 10197  3619]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.157039
{'0': {'precision': 0.35907549803886807, 'recall': 0.8914807581217506, 'f1-score': 0.5119464168647864, 'support': 36353}, '1': {'precision': 0.3300564199008377, 'recall': 0.1307616757543943, 'f1-score': 0.18731352334748333, 'support': 29527}, '2': {'precision': 0.5085324232081911, 'recall': 0.004097346349511893, 'f1-score': 0.008129194173168203, 'support': 36365}, 'accuracy': 0.35618367646339677, 'macro avg': {'precision': 0.39922144704929896, 'recall': 0.342113260075219, 'f1-score': 0.23579637812847928, 'support': 102245}, 'weighted avg': {'precision': 0.40385181730729985, 'recall': 0.35618367646339677, 'f1-score': 0.2390064320238054, 'support': 102245}}
[[32408  3851    94]
 [25616  3861    50]
 [32230  3986   149]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
6143/6143 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1481105
{'0': {'precision': 0.3018418996661853, 'recall': 0.8298492761043937, 'f1-score': 0.44267073438193516, 'support': 460909}, '1': {'precision': 0.45050542693436435, 'recall': 0.21203384548405838, 'f1-score': 0.2883524103730538, 'support': 638549}, '2': {'precision': 0.5379641218189404, 'recall': 0.005451924133907205, 'f1-score': 0.010794453350298638, 'support': 473044}, 'accuracy': 0.33097445980990803, 'macro avg': {'precision': 0.43010381613983, 'recall': 0.3491116819074531, 'f1-score': 0.24727253270176253, 'support': 1572502}, 'weighted avg': {'precision': 0.4332408722141352, 'recall': 0.33097445980990803, 'f1-score': 0.2500882798210655, 'support': 1572502}}
[[382485  77660    764]
 [501704 135394   1451]
 [382981  87484   2579]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.140474
{'0': {'precision': 0.3399733529817057, 'recall': 0.8727855058392898, 'f1-score': 0.489336874673474, 'support': 179217}, '1': {'precision': 0.37429878157716084, 'recall': 0.11980626050756545, 'f1-score': 0.18151337676739673, 'support': 174874}, '2': {'precision': 0.40159729509152386, 'recall': 0.03845896184808459, 'f1-score': 0.07019563888322804, 'support': 179126}, 'accuracy': 0.345559125084159, 'macro avg': {'precision': 0.37195647655013014, 'recall': 0.34368357606497996, 'f1-score': 0.24701529677469958, 'support': 533217}, 'weighted avg': {'precision': 0.37193234013808835, 'recall': 0.345559125084159, 'f1-score': 0.24757897990456948, 'support': 533217}}
[[156418  16983   5816]
 [149474  20951   4449]
 [154197  18040   6889]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.150194
{'0': {'precision': 0.32491959647049123, 'recall': 0.8356486390950866, 'f1-score': 0.467906341540654, 'support': 56580}, '1': {'precision': 0.39455754559177514, 'recall': 0.15998875066172577, 'f1-score': 0.22766275497592953, 'support': 60448}, '2': {'precision': 0.4415079673532841, 'recall': 0.03907472697566429, 'f1-score': 0.07179535794978749, 'support': 58145}, 'accuracy': 0.3380886323805609, 'macro avg': {'precision': 0.3869950364718502, 'recall': 0.34490403891082555, 'f1-score': 0.25578815148879036, 'support': 175173}, 'weighted avg': {'precision': 0.3876490443503777, 'recall': 0.3380886323805609, 'f1-score': 0.2535233175497684, 'support': 175173}}
[[47281  7179  2120]
 [50023  9671   754]
 [48212  7661  2272]]
testing model on single stock: results/universal/W7/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
23942/23942 - 325s - 325s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1597832
{'0': {'precision': 0.2955795302058878, 'recall': 0.7636646035190167, 'f1-score': 0.4261975451291741, 'support': 1800162}, '1': {'precision': 0.4167516838133897, 'recall': 0.24297362719857216, 'f1-score': 0.30697524126193715, 'support': 2533633}, '2': {'precision': 0.286734693877551, 'recall': 0.0001565225044269132, 'f1-score': 0.00031287421732733043, 'support': 1795269}, 'accuracy': 0.3247815653417879, 'macro avg': {'precision': 0.33302196929894284, 'recall': 0.3355982510740052, 'f1-score': 0.24449522020281286, 'support': 6129064}, 'weighted avg': {'precision': 0.34307893738954565, 'recall': 0.3247815653417879, 'f1-score': 0.2521672020494968, 'support': 6129064}}
[[1374720  425144     298]
 [1917626  615606     401]
 [1358585  436403     281]]
Evaluating performance on  train set...
9052/9052 - 122s - 122s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1652701
{'0': {'precision': 0.34025773214879135, 'recall': 0.8271356951187038, 'f1-score': 0.48216703850931586, 'support': 781104}, '1': {'precision': 0.3535655227175045, 'recall': 0.19051064520180874, 'f1-score': 0.24760502233215173, 'support': 764288}, '2': {'precision': 0.36750154607297464, 'recall': 0.0030802604161267247, 'f1-score': 0.006109314841754095, 'support': 771688}, 'accuracy': 0.3426990004661039, 'macro avg': {'precision': 0.35377493364642354, 'recall': 0.34024220024554636, 'f1-score': 0.24529379189440725, 'support': 2317080}, 'weighted avg': {'precision': 0.35372067210671504, 'recall': 0.3426990004661039, 'f1-score': 0.24624900077147957, 'support': 2317080}}
[[646079 132610   2415]
 [617007 145605   1676]
 [635707 133604   2377]]
Evaluating performance on  val set...
2763/2763 - 37s - 37s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1958303
{'0': {'precision': 0.32771071808223823, 'recall': 0.7394816662465996, 'f1-score': 0.45415629161695986, 'support': 230122}, '1': {'precision': 0.3468679654946704, 'recall': 0.2715727898072188, 'f1-score': 0.30463678299519076, 'support': 240013}, '2': {'precision': 0.43846153846153846, 'recall': 0.00024032380470528713, 'f1-score': 0.00048038430744595676, 'support': 237180}, 'accuracy': 0.3328205961982992, 'macro avg': {'precision': 0.371013407346149, 'recall': 0.3370982599528412, 'f1-score': 0.25309115297319884, 'support': 707315}, 'weighted avg': {'precision': 0.37134879729837605, 'recall': 0.3328205961982992, 'f1-score': 0.2512912632795046, 'support': 707315}}
[[170171  59912     39]
 [174798  65181     34]
 [174303  62820     57]]
training model: results/universal/W7/deepLOB_L2/h200
Epoch 1/50
12475/12475 - 495s - loss: 3.2552 - accuracy200: 0.3928 - val_loss: 3.3559 - val_accuracy200: 0.3374 - 495s/epoch - 40ms/step
Epoch 2/50
12475/12475 - 491s - loss: 3.2366 - accuracy200: 0.4039 - val_loss: 3.4500 - val_accuracy200: 0.3271 - 491s/epoch - 39ms/step
Epoch 3/50
12475/12475 - 490s - loss: 3.2285 - accuracy200: 0.4087 - val_loss: 3.5099 - val_accuracy200: 0.3331 - 490s/epoch - 39ms/step
Epoch 4/50
12475/12475 - 492s - loss: 3.2201 - accuracy200: 0.4134 - val_loss: 3.6137 - val_accuracy200: 0.3247 - 492s/epoch - 39ms/step
Epoch 5/50
12475/12475 - 493s - loss: 3.2150 - accuracy200: 0.4158 - val_loss: 3.6225 - val_accuracy200: 0.3246 - 493s/epoch - 39ms/step
Epoch 6/50
12475/12475 - 494s - loss: 3.2103 - accuracy200: 0.4181 - val_loss: 3.6922 - val_accuracy200: 0.3251 - 494s/epoch - 40ms/step
Epoch 7/50
12475/12475 - 497s - loss: 3.2057 - accuracy200: 0.4202 - val_loss: 3.6827 - val_accuracy200: 0.3256 - 497s/epoch - 40ms/step
Epoch 8/50
12475/12475 - 493s - loss: 3.2017 - accuracy200: 0.4214 - val_loss: 3.7574 - val_accuracy200: 0.3247 - 493s/epoch - 40ms/step
Epoch 9/50
12475/12475 - 494s - loss: 3.1984 - accuracy200: 0.4229 - val_loss: 3.7717 - val_accuracy200: 0.3251 - 494s/epoch - 40ms/step
Epoch 10/50
12475/12475 - 492s - loss: 3.1956 - accuracy200: 0.4240 - val_loss: 3.8455 - val_accuracy200: 0.3254 - 492s/epoch - 39ms/step
Epoch 11/50
12475/12475 - 492s - loss: 3.1921 - accuracy200: 0.4255 - val_loss: 3.8701 - val_accuracy200: 0.3245 - 492s/epoch - 39ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 497s - 497s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961632
{'0': {'precision': 0.30642531253603017, 'recall': 0.19089937654360303, 'f1-score': 0.23524430781251737, 'support': 2826180}, '1': {'precision': 0.4120701267166704, 'recall': 0.8072038769881165, 'f1-score': 0.5456109174246228, 'support': 3879300}, '2': {'precision': 0.36477353040065325, 'recall': 0.018985447621006738, 'f1-score': 0.036092386896863324, 'support': 2800092}, 'accuracy': 0.39177684414993647, 'macro avg': {'precision': 0.3610896565511179, 'recall': 0.33902956705090875, 'f1-score': 0.2723158707113345, 'support': 9505572}, 'weighted avg': {'precision': 0.36672766001264134, 'recall': 0.39177684414993647, 'f1-score': 0.3032424764790306, 'support': 9505572}}
[[ 539516 2233443   53221]
 [ 708559 3131386   39355]
 [ 512602 2234329   53161]]
Evaluating performance on  train set...
12475/12475 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1242546
{'0': {'precision': 0.34242051381309035, 'recall': 0.18252337929357318, 'f1-score': 0.23811973104679038, 'support': 1085576}, '1': {'precision': 0.3246712720855661, 'recall': 0.8166626067657282, 'f1-score': 0.46462633295386424, 'support': 1034508}, '2': {'precision': 0.37237335070858446, 'recall': 0.004260950605778192, 'f1-score': 0.00842549098019125, 'support': 1073000}, 'accuracy': 0.3280712314489691, 'macro avg': {'precision': 0.3464883788690803, 'recall': 0.33448231222169317, 'f1-score': 0.2370571849936153, 'support': 3193084}, 'weighted avg': {'precision': 0.34673535846728903, 'recall': 0.3280712314489691, 'f1-score': 0.234318068495546, 'support': 3193084}}
[[198143 883401   4032]
 [185990 844844   3674]
 [194521 873907   4572]]
Evaluating performance on  val set...
3866/3866 - 53s - 53s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201358
{'0': {'precision': 0.32527296840651854, 'recall': 0.1678311189991126, 'f1-score': 0.22141745591705914, 'support': 320036}, '1': {'precision': 0.34017579642579643, 'recall': 0.8329052816817674, 'f1-score': 0.48305990580024966, 'support': 336408}, '2': {'precision': 0.39185750636132316, 'recall': 0.00046279879071277027, 'f1-score': 0.0009245057046204274, 'support': 332758}, 'accuracy': 0.3377085772167869, 'macro avg': {'precision': 0.35243542373121267, 'recall': 0.3337330664905309, 'f1-score': 0.23513395580730975, 'support': 989202}, 'weighted avg': {'precision': 0.3527395204849354, 'recall': 0.3377085772167869, 'f1-score': 0.23622516976469965, 'support': 989202}}
[[ 53712 266219    105]
 [ 56078 280196    134]
 [ 55339 277265    154]]
testing model out of sample: results/universal/W7/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 198s - 198s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082752
{'0': {'precision': 0.30798112955130497, 'recall': 0.18198228249671206, 'f1-score': 0.22878079278364305, 'support': 1151178}, '1': {'precision': 0.3790751414431731, 'recall': 0.8208022506935391, 'f1-score': 0.5186292054798157, 'support': 1428182}, '2': {'precision': 0.3231521075137447, 'recall': 0.00044271413053120675, 'f1-score': 0.0008842168955629528, 'support': 1194902}, 'accuracy': 0.3662379559235686, 'macro avg': {'precision': 0.33673612616940757, 'recall': 0.3344090824402608, 'f1-score': 0.24943140505300723, 'support': 3774262}, 'weighted avg': {'precision': 0.3396861410213691, 'recall': 0.3662379559235686, 'f1-score': 0.26630924507959564, 'support': 3774262}}
[[ 209494  941190     494]
 [ 255313 1172255     614]
 [ 215410  978963     529]]
Evaluating performance on  train set...
5285/5285 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1244816
{'0': {'precision': 0.33935069309153826, 'recall': 0.22415590647356481, 'f1-score': 0.26997895776579284, 'support': 458480}, '1': {'precision': 0.32616736290301757, 'recall': 0.7469946113409777, 'f1-score': 0.45406987636789997, 'support': 439627}, '2': {'precision': 0.34342846501233765, 'recall': 0.03245706089026464, 'f1-score': 0.05930890035517803, 'support': 454539}, 'accuracy': 0.3296671856494604, 'macro avg': {'precision': 0.33631550700229784, 'recall': 0.33453585956826903, 'f1-score': 0.2611192448296236, 'support': 1352646}, 'weighted avg': {'precision': 0.33643622653511435, 'recall': 0.3296671856494604, 'f1-score': 0.25901790886380754, 'support': 1352646}}
[[102771 339994  15715]
 [ 98738 328399  12490]
 [101337 338449  14753]]
Evaluating performance on  val set...
1714/1714 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1216251
{'0': {'precision': 0.3333216484967458, 'recall': 0.1989052749015096, 'f1-score': 0.24913972296459327, 'support': 143415}, '1': {'precision': 0.33868538885983784, 'recall': 0.8027660568789071, 'f1-score': 0.47638493104986673, 'support': 147647}, '2': {'precision': 0.4318364073777065, 'recall': 0.007327926407751136, 'f1-score': 0.014411304243105456, 'support': 146972}, 'accuracy': 0.3381678134574029, 'macro avg': {'precision': 0.3679478149114301, 'recall': 0.33633308606272255, 'f1-score': 0.24664531941918846, 'support': 438034}, 'weighted avg': {'precision': 0.368183899636251, 'recall': 0.3381678134574029, 'f1-score': 0.24697908721903897, 'support': 438034}}
[[ 28526 113803   1086]
 [ 28790 118526    331]
 [ 28265 117630   1077]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1180751
{'0': {'precision': 0.3177460108684365, 'recall': 0.16225674744153984, 'f1-score': 0.21481724154069357, 'support': 56577}, '1': {'precision': 0.3473047459834706, 'recall': 0.8372988896442329, 'f1-score': 0.4909623260206237, 'support': 61782}, '2': {'precision': 0.3372093023255814, 'recall': 0.00048686309074120706, 'f1-score': 0.0009723223416204255, 'support': 59565}, 'accuracy': 0.3425001686113172, 'macro avg': {'precision': 0.3340866863924961, 'recall': 0.333347500058838, 'f1-score': 0.23558396330097922, 'support': 177924}, 'weighted avg': {'precision': 0.334525808582752, 'recall': 0.3425001686113172, 'f1-score': 0.23911482363892791, 'support': 177924}}
[[ 9180 47367    30]
 [10025 51730    27]
 [ 9686 49850    29]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241082
{'0': {'precision': 0.33346655342958487, 'recall': 0.27134146341463417, 'f1-score': 0.2992133043458772, 'support': 24600}, '1': {'precision': 0.3294115359184785, 'recall': 0.7108565193671577, 'f1-score': 0.450199997342228, 'support': 23829}, '2': {'precision': 0.2836624775583483, 'recall': 0.006704289896889718, 'f1-score': 0.013098988559111258, 'support': 23567}, 'accuracy': 0.3301850102783488, 'macro avg': {'precision': 0.3155135223021372, 'recall': 0.32963409089289386, 'f1-score': 0.2541707634157388, 'support': 71996}, 'weighted avg': {'precision': 0.3158216888769766, 'recall': 0.3301850102783488, 'f1-score': 0.2555304028966763, 'support': 71996}}
[[ 6675 17694   231]
 [ 6722 16939   168]
 [ 6620 16789   158]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1298513
{'0': {'precision': 0.3416296296296296, 'recall': 0.18094789704959197, 'f1-score': 0.2365856160870011, 'support': 6372}, '1': {'precision': 0.30944194657498014, 'recall': 0.822062181626559, 'f1-score': 0.4496325118893212, 'support': 5693}, '2': {'precision': 0.3333333333333333, 'recall': 0.0004656216048424647, 'f1-score': 0.000929944203347799, 'support': 6443}, 'accuracy': 0.31532310352280096, 'macro avg': {'precision': 0.328134969845981, 'recall': 0.3344919000936644, 'f1-score': 0.22904935739322338, 'support': 18508}, 'weighted avg': {'precision': 0.3288406996173562, 'recall': 0.31532310352280096, 'f1-score': 0.22008175202044772, 'support': 18508}}
[[1153 5215    4]
 [1011 4680    2]
 [1211 5229    3]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1233853
{'0': {'precision': 0.3480276439611617, 'recall': 0.18379561467341332, 'f1-score': 0.24055343088758618, 'support': 177273}, '1': {'precision': 0.32443169225709745, 'recall': 0.8178628714923374, 'f1-score': 0.46457480207480206, 'support': 166457}, '2': {'precision': 0.3181818181818182, 'recall': 0.00016509433962264152, 'f1-score': 0.00033001744377917123, 'support': 169600}, 'accuracy': 0.32873395281787543, 'macro avg': {'precision': 0.3302137181333591, 'recall': 0.33394119350179113, 'f1-score': 0.23515275013538914, 'support': 513330}, 'weighted avg': {'precision': 0.33051539378100453, 'recall': 0.32873395281787543, 'f1-score': 0.23382877903330285, 'support': 513330}}
[[ 32582 144657     34]
 [ 30292 136139     26]
 [ 30745 138827     28]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1216315
{'0': {'precision': 0.35434527409199246, 'recall': 0.2051234529766685, 'f1-score': 0.25983409849749584, 'support': 48561}, '1': {'precision': 0.32080000787022006, 'recall': 0.7429372095142622, 'f1-score': 0.4481074061604633, 'support': 43892}, '2': {'precision': 0.3560498907033561, 'recall': 0.061418685121107264, 'f1-score': 0.10476532793552902, 'support': 45084}, 'accuracy': 0.3296494761409657, 'macro avg': {'precision': 0.3437317242218562, 'recall': 0.33649311587067937, 'f1-score': 0.27090227753116275, 'support': 137537}, 'weighted avg': {'precision': 0.34419878340440063, 'recall': 0.3296494761409657, 'f1-score': 0.2690866746619262, 'support': 137537}}
[[ 9961 35775  2825]
 [ 9100 32609  2183]
 [ 9050 33265  2769]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1323702
{'0': {'precision': 0.34761752478413815, 'recall': 0.16277328541479485, 'f1-score': 0.2217236104028557, 'support': 13356}, '1': {'precision': 0.3026468256388364, 'recall': 0.8360006738544474, 'f1-score': 0.4444096180540008, 'support': 11872}, '2': {'precision': 0.5, 'recall': 7.234843003906815e-05, 'f1-score': 0.00014467592592592592, 'support': 13822}, 'accuracy': 0.30985915492957744, 'macro avg': {'precision': 0.38342145014099155, 'recall': 0.3329487692330938, 'f1-score': 0.2220926347942608, 'support': 39050}, 'weighted avg': {'precision': 0.3878822733675087, 'recall': 0.30985915492957744, 'f1-score': 0.21099542219528264, 'support': 39050}}
[[ 2174 11181     1]
 [ 1947  9925     0]
 [ 2133 11688     1]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.115818
{'0': {'precision': 0.3240520241802528, 'recall': 0.16039324387337445, 'f1-score': 0.21457844165071005, 'support': 77204}, '1': {'precision': 0.3478025638841994, 'recall': 0.8378649095494973, 'f1-score': 0.4915569841618227, 'support': 82863}, '2': {'precision': 0.34513274336283184, 'recall': 0.0005007832764066873, 'f1-score': 0.0010001153979305303, 'support': 77878}, 'accuracy': 0.34398705583223016, 'macro avg': {'precision': 0.33899577714242807, 'recall': 0.33291964556642617, 'f1-score': 0.23571184707015444, 'support': 237945}, 'weighted avg': {'precision': 0.3392226107443286, 'recall': 0.34398705583223016, 'f1-score': 0.24113172109001055, 'support': 237945}}
[[12383 64783    38]
 [13399 69428    36]
 [12431 65408    39]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.121826
{'0': {'precision': 0.34520276953511375, 'recall': 0.172606720039566, 'f1-score': 0.23013992210521977, 'support': 32351}, '1': {'precision': 0.33534109728083766, 'recall': 0.7808738920852123, 'f1-score': 0.46919116891367924, 'support': 32155}, '2': {'precision': 0.32972638738599475, 'recall': 0.06460699681962744, 'f1-score': 0.1080437645628609, 'support': 33015}, 'accuracy': 0.33660442366259574, 'macro avg': {'precision': 0.3367567514006487, 'recall': 0.3393625363148019, 'f1-score': 0.26912495186058666, 'support': 97521}, 'weighted avg': {'precision': 0.33671172834409424, 'recall': 0.33660442366259574, 'f1-score': 0.26762608610953714, 'support': 97521}}
[[ 5584 24351  2416]
 [ 5126 25109  1920]
 [ 5466 25416  2133]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1273029
{'0': {'precision': 0.3185878349638452, 'recall': 0.15741908364859183, 'f1-score': 0.2107188071458714, 'support': 9516}, '1': {'precision': 0.32201789672440684, 'recall': 0.8317430025445293, 'f1-score': 0.4642836006391667, 'support': 9432}, '2': {'precision': 0.46153846153846156, 'recall': 0.0005923585743903643, 'f1-score': 0.001183198580161704, 'support': 10129}, 'accuracy': 0.3215256044296179, 'macro avg': {'precision': 0.36738139774223794, 'recall': 0.32991814825583715, 'f1-score': 0.22539520212173325, 'support': 29077}, 'weighted avg': {'precision': 0.3694974624735576, 'recall': 0.3215256044296179, 'f1-score': 0.21997825458084364, 'support': 29077}}
[[1498 8016    2]
 [1582 7845    5]
 [1622 8501    6]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1233861
{'0': {'precision': 0.30037039214533484, 'recall': 0.18647346521643915, 'f1-score': 0.23009885828810775, 'support': 82194}, '1': {'precision': 0.34707740702073137, 'recall': 0.813883736950877, 'f1-score': 0.4866324054066043, 'support': 94355}, '2': {'precision': 0.33727810650887574, 'recall': 0.0005943319500344087, 'f1-score': 0.0011865729898516784, 'support': 95906}, 'accuracy': 0.3383237598869538, 'macro avg': {'precision': 0.328241968558314, 'recall': 0.33365051137245016, 'f1-score': 0.23930594556152127, 'support': 272455}, 'weighted avg': {'precision': 0.3295374532832027, 'recall': 0.3383237598869538, 'f1-score': 0.23836136477377032, 'support': 272455}}
[[15327 66812    55]
 [17504 76794    57]
 [18196 77653    57]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1211358
{'0': {'precision': 0.34849254742547425, 'recall': 0.23239396848703903, 'f1-score': 0.2788412671522954, 'support': 35414}, '1': {'precision': 0.33185571710826284, 'recall': 0.7740163062743708, 'f1-score': 0.46454152187788106, 'support': 33852}, '2': {'precision': 0.35, 'recall': 0.0006293832044596295, 'f1-score': 0.0012565069107880091, 'support': 33366}, 'accuracy': 0.3356945202276093, 'macro avg': {'precision': 0.34344942151124574, 'recall': 0.3356798859886232, 'f1-score': 0.24821309864698818, 'support': 102632}, 'weighted avg': {'precision': 0.3434951556052173, 'recall': 0.3356945202276093, 'f1-score': 0.2498486714000192, 'support': 102632}}
[[ 8230 27168    16]
 [ 7627 26202    23]
 [ 7759 25586    21]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1260365
{'0': {'precision': 0.2857693048334296, 'recall': 0.15738678544914625, 'f1-score': 0.2029818082341677, 'support': 9429}, '1': {'precision': 0.34036213614485444, 'recall': 0.8290685772773797, 'f1-score': 0.4825998645903859, 'support': 10747}, '2': {'precision': 0.6, 'recall': 0.000535475234270415, 'f1-score': 0.001069995541685243, 'support': 11205}, 'accuracy': 0.3314107262356203, 'macro avg': {'precision': 0.40871048032609475, 'recall': 0.32899694598693213, 'f1-score': 0.22888388945541296, 'support': 31381}, 'weighted avg': {'precision': 0.41666583768596155, 'recall': 0.3314107262356203, 'f1-score': 0.22664687277771348, 'support': 31381}}
[[1484 7944    1]
 [1834 8910    3]
 [1875 9324    6]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
1646/1646 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.090517
{'0': {'precision': 0.265882937813455, 'recall': 0.16343111878055797, 'f1-score': 0.20243243995435695, 'support': 111264}, '1': {'precision': 0.4409423362156245, 'recall': 0.837455563934073, 'f1-score': 0.5777068513560963, 'support': 185660}, '2': {'precision': 0.28113879003558717, 'recall': 0.0006352473846302297, 'f1-score': 0.0012676304937340544, 'support': 124361}, 'accuracy': 0.41241677249368003, 'macro avg': {'precision': 0.3293213546882222, 'recall': 0.33384064336642044, 'f1-score': 0.26046897393472906, 'support': 421285}, 'weighted avg': {'precision': 0.34753493336407604, 'recall': 0.41241677249368003, 'f1-score': 0.3084328680529468, 'support': 421285}}
[[ 18184  93004     76]
 [ 30052 155482    126]
 [ 20155 104127     79]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1226442
{'0': {'precision': 0.34260840448685753, 'recall': 0.2253198564224527, 'f1-score': 0.27185291460757743, 'support': 45411}, '1': {'precision': 0.3344035266055415, 'recall': 0.751498428064144, 'f1-score': 0.4628479090630485, 'support': 44213}, '2': {'precision': 0.35453869047619047, 'recall': 0.042378157239416576, 'f1-score': 0.07570702256116936, 'support': 44976}, 'accuracy': 0.33702823179791974, 'macro avg': {'precision': 0.3438502071895298, 'recall': 0.33973214724200446, 'f1-score': 0.27013594874393176, 'support': 134600}, 'weighted avg': {'precision': 0.34389974383967786, 'recall': 0.33702823179791974, 'f1-score': 0.2690490813919793, 'support': 134600}}
[[10232 33240  1939]
 [ 9456 33226  1531]
 [10177 32893  1906]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.117703
{'0': {'precision': 0.3152536715620828, 'recall': 0.1609714529186195, 'f1-score': 0.21312122750606416, 'support': 11735}, '1': {'precision': 0.35479342797894403, 'recall': 0.8421809920484665, 'f1-score': 0.49925925925925924, 'support': 13205}, '2': {'precision': 0.2, 'recall': 0.00016119932296284356, 'f1-score': 0.0003221390029797858, 'support': 12407}, 'accuracy': 0.3484081720084612, 'macro avg': {'precision': 0.2900156998470089, 'recall': 0.33443788143001635, 'f1-score': 0.23756754192276774, 'support': 37347}, 'weighted avg': {'precision': 0.2909456998485286, 'recall': 0.3484081720084612, 'f1-score': 0.24359902808557984, 'support': 37347}}
[[ 1889  9840     6]
 [ 2082 11121     2]
 [ 2021 10384     2]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
5929/5929 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1113125
{'0': {'precision': 0.35122192072003466, 'recall': 0.32660954559957667, 'f1-score': 0.33846888977825, 'support': 513996}, '1': {'precision': 0.34993246807708567, 'recall': 0.5996529224465145, 'f1-score': 0.4419571514798509, 'support': 523226}, '2': {'precision': 0.367197499003378, 'recall': 0.10930132340725844, 'f1-score': 0.16845864335973973, 'support': 480351}, 'accuracy': 0.35196527613498657, 'macro avg': {'precision': 0.35611729593349944, 'recall': 0.34518793048444985, 'f1-score': 0.31629489487261353, 'support': 1517573}, 'weighted avg': {'precision': 0.35583402824660676, 'recall': 0.35196527613498657, 'f1-score': 0.3203367520423414, 'support': 1517573}}
[[167876 293691  52429]
 [171421 313754  38051]
 [138680 289168  52503]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1250176
{'0': {'precision': 0.3355552962455147, 'recall': 0.21791641406486814, 'f1-score': 0.26423394553369395, 'support': 105568}, '1': {'precision': 0.3307516993995125, 'recall': 0.7879345834985743, 'f1-score': 0.46592276403471794, 'support': 105906}, '2': {'precision': 0.4608695652173913, 'recall': 0.0004840447878422562, 'f1-score': 0.0009670738716711219, 'support': 109494}, 'accuracy': 0.3318243563221256, 'macro avg': {'precision': 0.3757255202874728, 'recall': 0.3354450141170949, 'f1-score': 0.243707927813361, 'support': 320968}, 'weighted avg': {'precision': 0.37671962053713864, 'recall': 0.3318243563221256, 'f1-score': 0.24097278917669862, 'support': 320968}}
[[23005 82533    30]
 [22427 83447    32]
 [23126 86315    53]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1233778
{'0': {'precision': 0.3305274233855057, 'recall': 0.2116745283018868, 'f1-score': 0.2580744544287548, 'support': 35616}, '1': {'precision': 0.34395155220527784, 'recall': 0.7992896160159298, 'f1-score': 0.4809429746446034, 'support': 37163}, '2': {'precision': 0.4146341463414634, 'recall': 0.0004666227492314449, 'f1-score': 0.0009321964192690483, 'support': 36432}, 'accuracy': 0.3411744238217762, 'macro avg': {'precision': 0.36303770731074897, 'recall': 0.3371435890223493, 'f1-score': 0.24664987516420908, 'support': 109211}, 'weighted avg': {'precision': 0.3631528643214979, 'recall': 0.3411744238217762, 'f1-score': 0.24813274592851212, 'support': 109211}}
[[ 7539 28061    16]
 [ 7451 29704     8]
 [ 7819 28596    17]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
5331/5331 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062964
{'0': {'precision': 0.31095259242811146, 'recall': 0.15957060414060292, 'f1-score': 0.21090944461265965, 'support': 421243}, '1': {'precision': 0.37792562298137133, 'recall': 0.84127812257564, 'f1-score': 0.5215544321178924, 'support': 515600}, '2': {'precision': 0.30390738060781475, 'recall': 0.0004909260501726423, 'f1-score': 0.0009802685935946449, 'support': 427763}, 'accuracy': 0.36727890687861553, 'macro avg': {'precision': 0.33092853200576583, 'recall': 0.33377988425547184, 'f1-score': 0.24448138177471557, 'support': 1364606}, 'weighted avg': {'precision': 0.3340490859283417, 'recall': 0.36727890687861553, 'f1-score': 0.2624764327662034, 'support': 1364606}}
[[ 67218 353800    225]
 [ 81581 433763    256]
 [ 67369 360184    210]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1237243
{'0': {'precision': 0.34900835296637395, 'recall': 0.22833281954992574, 'f1-score': 0.2760588195432676, 'support': 178415}, '1': {'precision': 0.31951988968744777, 'recall': 0.7451747093253425, 'f1-score': 0.4472609162144328, 'support': 164187}, '2': {'precision': 0.35942583732057415, 'recall': 0.03262115685252736, 'f1-score': 0.05981367943307588, 'support': 172710}, 'accuracy': 0.327413295246375, 'macro avg': {'precision': 0.3426513599914653, 'recall': 0.33537622857593186, 'f1-score': 0.26104447173025874, 'support': 515312}, 'weighted avg': {'precision': 0.3431043208507564, 'recall': 0.327413295246375, 'f1-score': 0.25813076915382854, 'support': 515312}}
[[ 40738 131612   6065]
 [ 37863 122348   3976]
 [ 38124 128952   5634]]
Evaluating performance on  val set...
696/696 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1203529
{'0': {'precision': 0.3456456176351708, 'recall': 0.18813992452063835, 'f1-score': 0.24365493359049661, 'support': 59089}, '1': {'precision': 0.3379172156346069, 'recall': 0.8239329395820436, 'f1-score': 0.4792720017518674, 'support': 59767}, '2': {'precision': 0.34210526315789475, 'recall': 0.0002200666971374401, 'f1-score': 0.0004398504508467121, 'support': 59073}, 'accuracy': 0.33931512007598535, 'macro avg': {'precision': 0.3418893654758908, 'recall': 0.3374309769332731, 'f1-score': 0.24112226193107023, 'support': 177929}, 'weighted avg': {'precision': 0.3418742101501412, 'recall': 0.33931512007598535, 'f1-score': 0.24205137659018808, 'support': 177929}}
[[11117 47959    13]
 [10511 49244    12]
 [10535 48525    13]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
4192/4192 - 57s - 57s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142046
{'0': {'precision': 0.3173066469837673, 'recall': 0.16375754103830834, 'f1-score': 0.2160267072833442, 'support': 338647}, '1': {'precision': 0.35543596678645345, 'recall': 0.8363967600723479, 'f1-score': 0.498871165951113, 'support': 381490}, '2': {'precision': 0.33580980683506684, 'recall': 0.0006402030520122489, 'f1-score': 0.0012779697245579413, 'support': 353013}, 'accuracy': 0.34921399617947163, 'macro avg': {'precision': 0.3361841402017625, 'recall': 0.3335981680542228, 'f1-score': 0.23872528098633838, 'support': 1073150}, 'weighted avg': {'precision': 0.33694771317219724, 'recall': 0.34921399617947163, 'f1-score': 0.2459323462390608, 'support': 1073150}}
[[ 55456 282982    209]
 [ 62175 319077    238]
 [ 57140 295647    226]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1250023
{'0': {'precision': 0.349734426418798, 'recall': 0.2242365352581899, 'f1-score': 0.27326551786358716, 'support': 108060}, '1': {'precision': 0.3236982996513376, 'recall': 0.7750751760702699, 'f1-score': 0.45667377696961226, 'support': 101096}, '2': {'precision': 0.40995732574679944, 'recall': 0.013631504762985877, 'f1-score': 0.026385659092157548, 'support': 105711}, 'accuracy': 0.3303902917739871, 'macro avg': {'precision': 0.3611300172723117, 'recall': 0.33764773869714854, 'f1-score': 0.25210831797511896, 'support': 314867}, 'weighted avg': {'precision': 0.36159363884556606, 'recall': 0.3303902917739871, 'f1-score': 0.24926784459835488, 'support': 314867}}
[[24231 82953   876]
 [21541 78357  1198]
 [23512 80758  1441]]
Evaluating performance on  val set...
400/400 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1237923
{'0': {'precision': 0.33610780816488306, 'recall': 0.17364849052188158, 'f1-score': 0.22899025942713858, 'support': 34184}, '1': {'precision': 0.3304434220019634, 'recall': 0.8277190175688087, 'f1-score': 0.4723245984784446, 'support': 33753}, '2': {'precision': 0.21621621621621623, 'recall': 0.00023318176518596245, 'f1-score': 0.0004658611151550444, 'support': 34308}, 'accuracy': 0.33138050760428384, 'macro avg': {'precision': 0.2942558154610209, 'recall': 0.3338668966186254, 'f1-score': 0.23392690634024607, 'support': 102245}, 'weighted avg': {'precision': 0.2940086271513187, 'recall': 0.33138050760428384, 'f1-score': 0.23263883773132168, 'support': 102245}}
[[ 5936 28230    18]
 [ 5804 27938    11]
 [ 5921 28379     8]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
6143/6143 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1124002
{'0': {'precision': 0.31256600433415743, 'recall': 0.21119429148879126, 'f1-score': 0.252070102889775, 'support': 484890}, '1': {'precision': 0.3714379854461584, 'recall': 0.7937751276454333, 'f1-score': 0.5060674841319113, 'support': 582277}, '2': {'precision': 0.3795066413662239, 'recall': 0.00039577705878278765, 'f1-score': 0.0007907294874886827, 'support': 505335}, 'accuracy': 0.3591747419081184, 'macro avg': {'precision': 0.3545035437155133, 'recall': 0.3351217320643358, 'f1-score': 0.2529761055030583, 'support': 1572502}, 'weighted avg': {'precision': 0.35587739431048304, 'recall': 0.3591747419081184, 'f1-score': 0.2653715619653647, 'support': 1572502}}
[[102406 382349    135]
 [119888 462197    192]
 [105336 399799    200]]
Evaluating performance on  train set...
2083/2083 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1259539
{'0': {'precision': 0.335268069350279, 'recall': 0.22623703595324784, 'f1-score': 0.27016692650932744, 'support': 177703}, '1': {'precision': 0.32820304303520426, 'recall': 0.7461753108540712, 'f1-score': 0.4558859674964831, 'support': 175243}, '2': {'precision': 0.3290339916700255, 'recall': 0.027170204858241204, 'f1-score': 0.05019548363625183, 'support': 180271}, 'accuracy': 0.32981506591125187, 'macro avg': {'precision': 0.3308350346851696, 'recall': 0.33319418388852007, 'f1-score': 0.25874945921402076, 'support': 533217}, 'weighted avg': {'precision': 0.3308385034811682, 'recall': 0.32981506591125187, 'f1-score': 0.25683556220837656, 'support': 533217}}
[[ 40203 132428   5072]
 [ 39565 130762   4916]
 [ 40145 135228   4898]]
Evaluating performance on  val set...
685/685 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1224313
{'0': {'precision': 0.32595033721643163, 'recall': 0.22501454949473573, 'f1-score': 0.26623681492378476, 'support': 56703}, '1': {'precision': 0.34269057490532995, 'recall': 0.7689504617968094, 'f1-score': 0.4740956246246868, 'support': 59550}, '2': {'precision': 0.4308267552970503, 'recall': 0.017600135777325186, 'f1-score': 0.03381870954065909, 'support': 58920}, 'accuracy': 0.3401608695403972, 'macro avg': {'precision': 0.3664892224729373, 'recall': 0.33718838235629006, 'f1-score': 0.25805038302971023, 'support': 175173}, 'weighted avg': {'precision': 0.3669166945185498, 'recall': 0.3401608695403972, 'f1-score': 0.2587237698113242, 'support': 175173}}
[[12759 42888  1056]
 [13445 45791   314]
 [12940 44943  1037]]
testing model on single stock: results/universal/W7/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
23942/23942 - 320s - 320s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857812
{'0': {'precision': 0.2789731304897904, 'recall': 0.15694283197302328, 'f1-score': 0.2008774025896444, 'support': 1714070}, '1': {'precision': 0.4427177646622175, 'recall': 0.8421669174860673, 'f1-score': 0.5803513114632542, 'support': 2713772}, '2': {'precision': 0.26078112286411714, 'recall': 0.0003767879794641734, 'f1-score': 0.0007524887302779865, 'support': 1701222}, 'accuracy': 0.41688274098622563, 'macro avg': {'precision': 0.3274906726720417, 'recall': 0.3331621791461849, 'f1-score': 0.2606604009277255, 'support': 6129064}, 'weighted avg': {'precision': 0.3464250219646408, 'recall': 0.41688274098622563, 'f1-score': 0.3133495129193937, 'support': 6129064}}
[[ 269011 1444321     738]
 [ 427244 2285449    1079]
 [ 268035 1432546     641]]
Evaluating performance on  train set...
9052/9052 - 124s - 124s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1242126
{'0': {'precision': 0.34125358354221247, 'recall': 0.16828622300510296, 'f1-score': 0.2254123266655617, 'support': 787973}, '1': {'precision': 0.32409104467933336, 'recall': 0.8332324124188742, 'f1-score': 0.4666684345595164, 'support': 749762}, '2': {'precision': 0.33791523482245134, 'recall': 0.0003785229904599375, 'f1-score': 0.0007561989085101856, 'support': 779345}, 'accuracy': 0.3269744678647263, 'macro avg': {'precision': 0.33441995434799904, 'recall': 0.33396571947147907, 'f1-score': 0.23094565337786277, 'support': 2317080}, 'weighted avg': {'precision': 0.3345772733388909, 'recall': 0.3269744678647263, 'f1-score': 0.22791549102758973, 'support': 2317080}}
[[132605 655084    284]
 [124742 624726    294]
 [131235 647815    295]]
Evaluating performance on  val set...
2763/2763 - 37s - 37s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1187541
{'0': {'precision': 0.32015876368500723, 'recall': 0.15994214138429816, 'f1-score': 0.21331714939940602, 'support': 227451}, '1': {'precision': 0.34318651037760495, 'recall': 0.8384134918249455, 'f1-score': 0.48702132697454487, 'support': 242873}, '2': {'precision': 0.3391812865497076, 'recall': 0.0004894700642640438, 'f1-score': 0.0009775294628222794, 'support': 236991}, 'accuracy': 0.3394852364222447, 'macro avg': {'precision': 0.33417552020410657, 'recall': 0.33294836775783593, 'f1-score': 0.23377200194559103, 'support': 707315}, 'weighted avg': {'precision': 0.3344395079625915, 'recall': 0.3394852364222447, 'f1-score': 0.23615389943555082, 'support': 707315}}
[[ 36379 190971    101]
 [ 39120 203628    125]
 [ 38129 198746    116]]
training model: results/universal/W7/deepOF_L2/h50
Epoch 1/50
12475/12475 - 272s - loss: 3.1450 - accuracy50: 0.4340 - val_loss: 3.2406 - val_accuracy50: 0.4085 - 272s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 269s - loss: 3.1060 - accuracy50: 0.4464 - val_loss: 3.1960 - val_accuracy50: 0.4174 - 269s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 270s - loss: 3.0919 - accuracy50: 0.4514 - val_loss: 3.1876 - val_accuracy50: 0.4164 - 270s/epoch - 22ms/step
Epoch 4/50
12475/12475 - 269s - loss: 3.0834 - accuracy50: 0.4542 - val_loss: 3.1954 - val_accuracy50: 0.4165 - 269s/epoch - 22ms/step
Epoch 5/50
12475/12475 - 267s - loss: 3.0776 - accuracy50: 0.4560 - val_loss: 3.1994 - val_accuracy50: 0.4183 - 267s/epoch - 21ms/step
Epoch 6/50
12475/12475 - 268s - loss: 3.0728 - accuracy50: 0.4578 - val_loss: 3.2218 - val_accuracy50: 0.4178 - 268s/epoch - 22ms/step
Epoch 7/50
12475/12475 - 269s - loss: 3.0689 - accuracy50: 0.4590 - val_loss: 3.2261 - val_accuracy50: 0.4190 - 269s/epoch - 22ms/step
Epoch 8/50
12475/12475 - 269s - loss: 3.0661 - accuracy50: 0.4600 - val_loss: 3.2415 - val_accuracy50: 0.4188 - 269s/epoch - 22ms/step
Epoch 9/50
12475/12475 - 268s - loss: 3.0633 - accuracy50: 0.4607 - val_loss: 3.2494 - val_accuracy50: 0.4193 - 268s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 269s - loss: 3.0606 - accuracy50: 0.4617 - val_loss: 3.2598 - val_accuracy50: 0.4184 - 269s/epoch - 22ms/step
Epoch 11/50
12475/12475 - 269s - loss: 3.0584 - accuracy50: 0.4624 - val_loss: 3.2630 - val_accuracy50: 0.4200 - 269s/epoch - 22ms/step
Epoch 12/50
12475/12475 - 266s - loss: 3.0564 - accuracy50: 0.4629 - val_loss: 3.2748 - val_accuracy50: 0.4198 - 266s/epoch - 21ms/step
Epoch 13/50
12475/12475 - 268s - loss: 3.0544 - accuracy50: 0.4638 - val_loss: 3.2916 - val_accuracy50: 0.4190 - 268s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 280s - 280s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0668099
{'0': {'precision': 0.35301622778548714, 'recall': 0.5167778119101581, 'f1-score': 0.4194808091064811, 'support': 2480538}, '1': {'precision': 0.5927745614777329, 'recall': 0.2865228552191277, 'f1-score': 0.3863162944203672, 'support': 4547714}, '2': {'precision': 0.34070032381897475, 'recall': 0.5055748306116147, 'f1-score': 0.40707684162132196, 'support': 2477295}, 'accuracy': 0.40369786189053614, 'macro avg': {'precision': 0.42883037102739824, 'recall': 0.4362918325803002, 'f1-score': 0.4042913150493901, 'support': 9505547}, 'weighted avg': {'precision': 0.464513462340445, 'recall': 0.40369786189053614, 'f1-score': 0.40038132810108573, 'support': 9505547}}
[[1281887  424985  773666]
 [1594686 1303024 1650004]
 [ 754668  470169 1252458]]
Evaluating performance on  train set...
12475/12475 - 98s - 98s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0630959
{'0': {'precision': 0.4124981012417879, 'recall': 0.5051557978140541, 'f1-score': 0.4541490155361886, 'support': 1032139}, '1': {'precision': 0.506230750287586, 'recall': 0.2624685389662066, 'f1-score': 0.34569993042853253, 'support': 1143478}, '2': {'precision': 0.4012780752985269, 'recall': 0.5269971035744859, 'f1-score': 0.4556243411937601, 'support': 1017461}, 'accuracy': 0.4252063369576315, 'macro avg': {'precision': 0.44000230894263365, 'recall': 0.4315404801182489, 'f1-score': 0.4184910957194938, 'support': 3193078}, 'weighted avg': {'precision': 0.44248962767782696, 'recall': 0.4252063369576315, 'f1-score': 0.41578225574458494, 'support': 3193078}}
[[521391 144026 366722]
 [410044 300127 433307]
 [332549 148713 536199]]
Evaluating performance on  val set...
3866/3866 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0685542
{'0': {'precision': 0.3916732884751372, 'recall': 0.5260442164215638, 'f1-score': 0.44902154972483044, 'support': 306402}, '1': {'precision': 0.5118014281438406, 'recall': 0.25780848251185307, 'f1-score': 0.34289254259926694, 'support': 371423}, '2': {'precision': 0.39761025740809963, 'recall': 0.4987571296439032, 'f1-score': 0.4424769431963554, 'support': 311376}, 'accuracy': 0.4167383575228897, 'macro avg': {'precision': 0.43369499134235917, 'recall': 0.4275366095257733, 'f1-score': 0.4114636785068176, 'support': 989201}, 'weighted avg': {'precision': 0.438647547153241, 'recall': 0.4167383575228897, 'f1-score': 0.4071123850393837, 'support': 989201}}
[[161181  43175 102046]
 [142428  95756 133239]
 [107910  48165 155301]]
testing model out of sample: results/universal/W7/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 117s - 117s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98747647
{'0': {'precision': 0.42699882240424714, 'recall': 0.4487616044636159, 'f1-score': 0.43760980918384595, 'support': 1023744}, '1': {'precision': 0.5625676121180796, 'recall': 0.5961172967950173, 'f1-score': 0.5788567394302875, 'support': 1708964}, '2': {'precision': 0.44457453221926113, 'recall': 0.3787998221844999, 'f1-score': 0.4090599928251642, 'support': 1041529}, 'accuracy': 0.4961773730690468, 'macro avg': {'precision': 0.4780469889138626, 'recall': 0.4745595744810444, 'f1-score': 0.47517551381309925, 'support': 3774237}, 'weighted avg': {'precision': 0.49323414165219887, 'recall': 0.4961773730690468, 'f1-score': 0.4936874898433907, 'support': 3774237}}
[[ 459417  365096  199231]
 [ 396548 1018743  293673]
 [ 219956  427042  394531]]
Evaluating performance on  train set...
5285/5285 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0121163
{'0': {'precision': 0.45359990051357224, 'recall': 0.4178076516262996, 'f1-score': 0.434968709523139, 'support': 410318}, '1': {'precision': 0.5150495282576323, 'recall': 0.5625656771924071, 'f1-score': 0.5377600189501375, 'support': 536716}, '2': {'precision': 0.4326133236542615, 'recall': 0.41433414282368314, 'f1-score': 0.4232764787072205, 'support': 405605}, 'accuracy': 0.4742048691483833, 'macro avg': {'precision': 0.467087584141822, 'recall': 0.4649024905474633, 'f1-score': 0.46533506906016564, 'support': 1352639}, 'weighted avg': {'precision': 0.47168952967350347, 'recall': 0.4742048691483833, 'f1-score': 0.47224939797758275, 'support': 1352639}}
[[171434 136236 102648]
 [117015 301938 117763]
 [ 89492 148057 168056]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99714446
{'0': {'precision': 0.45507383104357424, 'recall': 0.42104729914036987, 'f1-score': 0.4373998089285425, 'support': 128311}, '1': {'precision': 0.5358018320216746, 'recall': 0.5979344906830578, 'f1-score': 0.5651656194142539, 'support': 180585}, '2': {'precision': 0.44101266682514345, 'recall': 0.4022611995198823, 'f1-score': 0.42074654851917404, 'support': 129135}, 'accuracy': 0.48843346703772106, 'macro avg': {'precision': 0.4772961099634641, 'recall': 0.47374766311443667, 'f1-score': 0.4744373256206568, 'support': 438031}, 'weighted avg': {'precision': 0.4842098456527759, 'recall': 0.48843346703772106, 'f1-score': 0.48516371171989375, 'support': 438031}}
[[ 54025  44017  30269]
 [ 37034 107978  35573]
 [ 27658  49531  51946]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1058869
{'0': {'precision': 0.34852875207623574, 'recall': 0.5323321358468205, 'f1-score': 0.42125392906076214, 'support': 54002}, '1': {'precision': 0.47428050527412424, 'recall': 0.15978589917957267, 'f1-score': 0.23903911787870832, 'support': 68379}, '2': {'precision': 0.3667905139431776, 'recall': 0.47815909827505493, 'f1-score': 0.4151353379344844, 'support': 55538}, 'accuracy': 0.37224242492370124, 'macro avg': {'precision': 0.39653325709784587, 'recall': 0.3900923777671494, 'f1-score': 0.3584761282913183, 'support': 177919}, 'weighted avg': {'precision': 0.40255896167995786, 'recall': 0.37224242492370124, 'f1-score': 0.3493139963509961, 'support': 177919}}
[[28747  5645 19610]
 [31218 10926 26235]
 [22516  6466 26556]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1051126
{'0': {'precision': 0.3862984903497038, 'recall': 0.4930086984797984, 'f1-score': 0.43317857142857147, 'support': 24602}, '1': {'precision': 0.3742299121772185, 'recall': 0.11942608550154774, 'f1-score': 0.18106865387664503, 'support': 23906}, '2': {'precision': 0.36921770255103586, 'recall': 0.5182662011411053, 'f1-score': 0.43122597559031406, 'support': 23486}, 'accuracy': 0.3771980998416535, 'macro avg': {'precision': 0.3765820350259861, 'recall': 0.3769003283741505, 'f1-score': 0.34849106696517684, 'support': 71994}, 'weighted avg': {'precision': 0.376718930774865, 'recall': 0.3771980998416535, 'f1-score': 0.3488271205458081, 'support': 71994}}
[[12129  2499  9974]
 [10230  2855 10821]
 [ 9039  2275 12172]]
Evaluating performance on  val set...
73/73 - 1s - 763ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0998663
{'0': {'precision': 0.3925246076084065, 'recall': 0.46545741324921136, 'f1-score': 0.425891181988743, 'support': 6340}, '1': {'precision': 0.37098344693281404, 'recall': 0.20251594613749113, 'f1-score': 0.26200573065902577, 'support': 5644}, '2': {'precision': 0.39398154001770136, 'recall': 0.4776210913549969, 'f1-score': 0.4317882630083835, 'support': 6524}, 'accuracy': 0.3895612708018154, 'macro avg': {'precision': 0.38582986485297394, 'recall': 0.38186481691389984, 'f1-score': 0.3732283918853841, 'support': 18508}, 'weighted avg': {'precision': 0.3864692108170296, 'recall': 0.3895612708018154, 'f1-score': 0.37799314164225556, 'support': 18508}}
[[2951  941 2448]
 [2156 1143 2345]
 [2411  997 3116]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8827477
{'0': {'precision': 0.4385670211969764, 'recall': 0.47869694659260065, 'f1-score': 0.45775414994032765, 'support': 110172}, '1': {'precision': 0.6709416253201741, 'recall': 0.7577171523741454, 'f1-score': 0.7116940527497443, 'support': 296612}, '2': {'precision': 0.564873145375056, 'recall': 0.30803164978740577, 'f1-score': 0.3986661726565394, 'support': 106541}, 'accuracy': 0.604500073053134, 'macro avg': {'precision': 0.5581272639640688, 'recall': 0.5148152495847172, 'f1-score': 0.5227047917822037, 'support': 513325}, 'weighted avg': {'precision': 0.5990538021919536, 'recall': 0.604500073053134, 'f1-score': 0.5922232100178898, 'support': 513325}}
[[ 52739  49976   7457]
 [ 54041 224748  17823]
 [ 13473  60250  32818]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87860435
{'0': {'precision': 0.47815859117195414, 'recall': 0.4805450664915449, 'f1-score': 0.4793488585372245, 'support': 30455}, '1': {'precision': 0.6827934420112409, 'recall': 0.7496479324030214, 'f1-score': 0.7146605804672053, 'support': 78110}, '2': {'precision': 0.509447331128956, 'recall': 0.3722816706938212, 'f1-score': 0.4301954527323494, 'support': 28970}, 'accuracy': 0.6105718544370524, 'macro avg': {'precision': 0.5567997881040504, 'recall': 0.5341582231961292, 'f1-score': 0.5414016305789264, 'support': 137535}, 'weighted avg': {'precision': 0.6009670617111699, 'recall': 0.6105718544370524, 'f1-score': 0.6026354723721288, 'support': 137535}}
[[14635 12748  3072]
 [12242 58555  7313]
 [ 3730 14455 10785]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.888723
{'0': {'precision': 0.48465351756143865, 'recall': 0.5043354187246186, 'f1-score': 0.49429862306368333, 'support': 9111}, '1': {'precision': 0.6522811344019729, 'recall': 0.7380093327560494, 'f1-score': 0.6925021441791179, 'support': 20787}, '2': {'precision': 0.5370247933884298, 'recall': 0.3550043706293706, 'f1-score': 0.4274437574003421, 'support': 9152}, 'accuracy': 0.5937259923175416, 'macro avg': {'precision': 0.5579864817839472, 'recall': 0.5324497073700128, 'f1-score': 0.538081508214381, 'support': 39050}, 'weighted avg': {'precision': 0.5861586952216898, 'recall': 0.5937259923175416, 'f1-score': 0.5841373135342504, 'support': 39050}}
[[ 4595  3605   911]
 [ 3556 15341  1890]
 [ 1330  4573  3249]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0984435
{'0': {'precision': 0.35701303307030763, 'recall': 0.4475036812713583, 'f1-score': 0.3971692413912143, 'support': 71986}, '1': {'precision': 0.4158836925211516, 'recall': 0.30423318365860924, 'f1-score': 0.35140301246272654, 'support': 90641}, '2': {'precision': 0.389614378201742, 'recall': 0.421109237449046, 'f1-score': 0.40475005423893207, 'support': 75313}, 'accuracy': 0.3845717407749853, 'macro avg': {'precision': 0.3875037012644004, 'recall': 0.39094870079300453, 'f1-score': 0.3844407693642909, 'support': 237940}, 'weighted avg': {'precision': 0.38975826526820484, 'recall': 0.3845717407749853, 'f1-score': 0.3821345141561681, 'support': 237940}}
[[32214 19502 20270]
 [33649 27576 29416]
 [24369 19229 31715]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0905064
{'0': {'precision': 0.39779106107958856, 'recall': 0.40466709880544494, 'f1-score': 0.4011996205282002, 'support': 32397}, '1': {'precision': 0.39209503556500697, 'recall': 0.32965474722564736, 'f1-score': 0.3581739625548448, 'support': 32440}, '2': {'precision': 0.40819008286626085, 'recall': 0.4657161215310712, 'f1-score': 0.4350597381809867, 'support': 32683}, 'accuracy': 0.40017432321575064, 'macro avg': {'precision': 0.39935872650361876, 'recall': 0.4000126558540545, 'f1-score': 0.3981444404213439, 'support': 97520}, 'weighted avg': {'precision': 0.3993814236858312, 'recall': 0.40017432321575064, 'f1-score': 0.39823507869668223, 'support': 97520}}
[[13110  8619 10668]
 [10346 10694 11400]
 [ 9501  7961 15221]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0965029
{'0': {'precision': 0.3820816864295125, 'recall': 0.4237111250260906, 'f1-score': 0.4018210609659541, 'support': 9582}, '1': {'precision': 0.357931435212086, 'recall': 0.2570147074162929, 'f1-score': 0.2991925201869953, 'support': 9587}, '2': {'precision': 0.3983746866084551, 'recall': 0.46507872426322167, 'f1-score': 0.4291501746216531, 'support': 9908}, 'accuracy': 0.3828455480276507, 'macro avg': {'precision': 0.37946260275001786, 'recall': 0.38193485223520174, 'f1-score': 0.3767212519248675, 'support': 29077}, 'weighted avg': {'precision': 0.37967093522930256, 'recall': 0.3828455480276507, 'f1-score': 0.37729573296281715, 'support': 29077}}
[[4060 2267 3255]
 [3419 2464 3704]
 [3147 2153 4608]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1303834
{'0': {'precision': 0.3389361668782422, 'recall': 0.5063449696799419, 'f1-score': 0.4060628250624308, 'support': 85422}, '1': {'precision': 0.369004329004329, 'recall': 0.02236941551897884, 'f1-score': 0.04218173180653015, 'support': 95264}, '2': {'precision': 0.3605755747477726, 'recall': 0.5464234340264156, 'f1-score': 0.4344590057402794, 'support': 91764}, 'accuracy': 0.3506184621031382, 'macro avg': {'precision': 0.35617202354344796, 'recall': 0.3583792730751121, 'f1-score': 0.2942345208697468, 'support': 272450}, 'weighted avg': {'precision': 0.3567380829014359, 'recall': 0.3506184621031382, 'f1-score': 0.28839344960194996, 'support': 272450}}
[[43253  1937 40232]
 [44446  2131 48687]
 [39915  1707 50142]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1166863
{'0': {'precision': 0.3698727756701809, 'recall': 0.4957858065966174, 'f1-score': 0.4236720484964888, 'support': 35594}, '1': {'precision': 0.4370895718413449, 'recall': 0.04914353219137625, 'f1-score': 0.08835320041415562, 'support': 33860}, '2': {'precision': 0.35266267558790154, 'recall': 0.5433118331424438, 'f1-score': 0.4277036966734684, 'support': 33178}, 'accuracy': 0.36379491776443995, 'macro avg': {'precision': 0.3865416743664758, 'recall': 0.36274705731014584, 'f1-score': 0.31324298186137095, 'support': 102632}, 'weighted avg': {'precision': 0.38648517743401434, 'recall': 0.36379491776443995, 'f1-score': 0.3143481127566419, 'support': 102632}}
[[17647  1185 16762]
 [15870  1664 16326]
 [14194   958 18026]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1287379
{'0': {'precision': 0.3396127985161141, 'recall': 0.5881939564300773, 'f1-score': 0.43060302061514716, 'support': 9961}, '1': {'precision': 0.3640939597315436, 'recall': 0.02039282022366319, 'f1-score': 0.03862240811604521, 'support': 10641}, '2': {'precision': 0.37042784305032145, 'recall': 0.4650709713331478, 'f1-score': 0.41238894373149065, 'support': 10779}, 'accuracy': 0.3533666868487301, 'macro avg': {'precision': 0.35804486709932637, 'recall': 0.3578859159956294, 'f1-score': 0.293871457487561, 'support': 31381}, 'weighted avg': {'precision': 0.3584987295421364, 'recall': 0.3533666868487301, 'f1-score': 0.2914297873742728, 'support': 31381}}
[[5859  187 3915]
 [5819  217 4605]
 [5574  192 5013]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
1646/1646 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1173388
{'0': {'precision': 0.32946385364578407, 'recall': 0.4856674319449, 'f1-score': 0.3925989998110975, 'support': 121960}, '1': {'precision': 0.470914172435085, 'recall': 0.17000844733322384, 'f1-score': 0.2498254385586828, 'support': 170468}, '2': {'precision': 0.35062654552527023, 'recall': 0.4896858411200447, 'f1-score': 0.40865006298432355, 'support': 128852}, 'accuracy': 0.35916729965818456, 'macro avg': {'precision': 0.38366819053537976, 'recall': 0.38178724013272286, 'f1-score': 0.35035816711803464, 'support': 421280}, 'weighted avg': {'precision': 0.39317351970500863, 'recall': 0.35916729965818456, 'f1-score': 0.33973603017669735, 'support': 421280}}
[[59232 16315 46413]
 [71042 28981 70445]
 [49509 16246 63097]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1094668
{'0': {'precision': 0.368686230248307, 'recall': 0.4496025017067101, 'f1-score': 0.40514367359898396, 'support': 45409}, '1': {'precision': 0.3854424679126323, 'recall': 0.15409718002385614, 'f1-score': 0.22017139090309823, 'support': 44433}, '2': {'precision': 0.3682557761145461, 'recall': 0.5056862613669371, 'f1-score': 0.4261653031059059, 'support': 44757}, 'accuracy': 0.37070111962198826, 'macro avg': {'precision': 0.3741281580918285, 'recall': 0.3697953143658344, 'f1-score': 0.35049345586932934, 'support': 134599}, 'weighted avg': {'precision': 0.3740745620522151, 'recall': 0.37070111962198826, 'f1-score': 0.3510718872916192, 'support': 134599}}
[[20416  5811 19182]
 [17941  6847 19645]
 [17018  5106 22633]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043112
{'0': {'precision': 0.35800654686351796, 'recall': 0.44096107956883074, 'f1-score': 0.39517734680333316, 'support': 12153}, '1': {'precision': 0.42389620449264137, 'recall': 0.1744918294141092, 'f1-score': 0.24721892822858435, 'support': 12545}, '2': {'precision': 0.37127418511417115, 'recall': 0.5052981179819706, 'f1-score': 0.42804032555179694, 'support': 12646}, 'accuracy': 0.37323264781491, 'macro avg': {'precision': 0.3843923121567769, 'recall': 0.3735836756549702, 'f1-score': 0.3568122001945715, 'support': 37344}, 'weighted avg': {'precision': 0.384633804475855, 'recall': 0.37323264781491, 'f1-score': 0.3566021236947441, 'support': 37344}}
[[5359 1477 5317]
 [4852 2189 5504]
 [4758 1498 6390]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/EXC
Evaluating performance on  test set...
5928/5928 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8427079
{'0': {'precision': 0.5339743866728268, 'recall': 0.4640865942929115, 'f1-score': 0.4965835941424211, 'support': 346166}, '1': {'precision': 0.6546578906392593, 'recall': 0.763265654530328, 'f1-score': 0.7048022935996248, 'support': 831772}, '2': {'precision': 0.5344083321859839, 'recall': 0.3885699143185231, 'f1-score': 0.44996726766863965, 'support': 339630}, 'accuracy': 0.611164705634278, 'macro avg': {'precision': 0.57434686983269, 'recall': 0.5386407210472542, 'f1-score': 0.5504510518035618, 'support': 1517568}, 'weighted avg': {'precision': 0.6002175733872285, 'recall': 0.611164705634278, 'f1-score': 0.6002746189430408, 'support': 1517568}}
[[160651 155995  29520]
 [111453 634863  85456]
 [ 28755 178905 131970]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8961545
{'0': {'precision': 0.5391777638479062, 'recall': 0.4303513246366554, 'f1-score': 0.4786568399907705, 'support': 81947}, '1': {'precision': 0.5857308217416253, 'recall': 0.7600552025162077, 'f1-score': 0.6616025880998809, 'support': 155790}, '2': {'precision': 0.5597251090762692, 'recall': 0.3591416453399656, 'f1-score': 0.4375402541132385, 'support': 83229}, 'accuracy': 0.5719172747269181, 'macro avg': {'precision': 0.5615445648886003, 'recall': 0.5165160574976095, 'f1-score': 0.5259332274012967, 'support': 320966}, 'weighted avg': {'precision': 0.5671017055902525, 'recall': 0.5719172747269181, 'f1-score': 0.5567929222297529, 'support': 320966}}
[[ 35266  39143   7538]
 [ 21407 118409  15974]
 [  8734  44604  29891]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89314884
{'0': {'precision': 0.5351062396118773, 'recall': 0.436672898566663, 'f1-score': 0.48090431974162295, 'support': 27279}, '1': {'precision': 0.5900260450023483, 'recall': 0.7632276593394455, 'f1-score': 0.66554289980013, 'support': 54318}, '2': {'precision': 0.5634925391022952, 'recall': 0.3405156804519447, 'f1-score': 0.4245050901785513, 'support': 27614}, 'accuracy': 0.5747772660263161, 'macro avg': {'precision': 0.5628749412388404, 'recall': 0.5134720794526844, 'f1-score': 0.5236507699067681, 'support': 109211}, 'weighted avg': {'precision': 0.5695990403675522, 'recall': 0.5747772660263161, 'f1-score': 0.5584770007578514, 'support': 109211}}
[[11912 13170  2197]
 [ 7774 41457  5087]
 [ 2575 15636  9403]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/AAL
Evaluating performance on  test set...
5331/5331 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90397745
{'0': {'precision': 0.4432777783000097, 'recall': 0.4722149900195603, 'f1-score': 0.457289055466933, 'support': 299586}, '1': {'precision': 0.6536652540085623, 'recall': 0.7162874456143118, 'f1-score': 0.6835450818258392, 'support': 760770}, '2': {'precision': 0.47240622270484645, 'recall': 0.3288731121300268, 'f1-score': 0.3877841294448212, 'support': 304245}, 'accuracy': 0.5763274393027705, 'macro avg': {'precision': 0.5231164183378062, 'recall': 0.5057918492546329, 'f1-score': 0.5095394222458645, 'support': 1364601}, 'weighted avg': {'precision': 0.5670638985378998, 'recall': 0.5763274393027705, 'f1-score': 0.5679311193049835, 'support': 1364601}}
[[141469 123552  34565]
 [138658 544930  77182]
 [ 39016 165171 100058]]
Evaluating performance on  train set...
2013/2013 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9370821
{'0': {'precision': 0.4924102118760468, 'recall': 0.4269239929624536, 'f1-score': 0.457334737951014, 'support': 130159}, '1': {'precision': 0.6039183012922714, 'recall': 0.6834061474233124, 'f1-score': 0.6412081741419136, 'support': 257734}, '2': {'precision': 0.43170824157972637, 'recall': 0.37542086220833953, 'f1-score': 0.4016018738902112, 'support': 127417}, 'accuracy': 0.5424695814170111, 'macro avg': {'precision': 0.5093455849160149, 'recall': 0.49525033419803516, 'f1-score': 0.5000482619943796, 'support': 515310}, 'weighted avg': {'precision': 0.5331720115080256, 'recall': 0.5424695814170111, 'f1-score': 0.5355189801803323, 'support': 515310}}
[[ 55568  52249  22342]
 [ 40970 176137  40627]
 [ 16311  63271  47835]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91637176
{'0': {'precision': 0.4993208059769074, 'recall': 0.41175235117033443, 'f1-score': 0.45132822591990995, 'support': 42851}, '1': {'precision': 0.6171570621468927, 'recall': 0.734592210027975, 'f1-score': 0.6707734630216392, 'support': 92940}, '2': {'precision': 0.4520457957957958, 'recall': 0.34294461056528547, 'f1-score': 0.39000890616144435, 'support': 42138}, 'accuracy': 0.5640901707984646, 'macro avg': {'precision': 0.522841221306532, 'recall': 0.4964297239211983, 'f1-score': 0.5040368650343311, 'support': 177929}, 'weighted avg': {'precision': 0.5496758760859214, 'recall': 0.5640901707984646, 'f1-score': 0.5514320136119247, 'support': 177929}}
[[17644 19374  5833]
 [12983 68273 11684]
 [ 4709 22978 14451]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/WBA
Evaluating performance on  test set...
4192/4192 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0110687
{'0': {'precision': 0.4584805277718664, 'recall': 0.43182469957352854, 'f1-score': 0.44475357458188036, 'support': 324289}, '1': {'precision': 0.4897728570018827, 'recall': 0.5982269679544902, 'f1-score': 0.5385944455319982, 'support': 423117}, '2': {'precision': 0.47474880330332125, 'recall': 0.36567313094225745, 'f1-score': 0.4131326759596141, 'support': 325739}, 'accuracy': 0.4773539456457422, 'macro avg': {'precision': 0.47433406269235673, 'recall': 0.46524159949009203, 'f1-score': 0.4654935653578309, 'support': 1073145}, 'weighted avg': {'precision': 0.47575641152490755, 'recall': 0.4773539456457422, 'f1-score': 0.47215481849345114, 'support': 1073145}}
[[140036 125963  58290]
 [ 96502 253120  73495]
 [ 68897 137728 119114]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0445048
{'0': {'precision': 0.47050083975711643, 'recall': 0.41180904996136525, 'f1-score': 0.4392028381053838, 'support': 106122}, '1': {'precision': 0.4158454957795489, 'recall': 0.5263694414525312, 'f1-score': 0.46462511406803764, 'support': 103984}, '2': {'precision': 0.4676080653371993, 'recall': 0.4033371197296704, 'f1-score': 0.4331011720812001, 'support': 104761}, 'accuracy': 0.4468235794795898, 'macro avg': {'precision': 0.45131813362462153, 'recall': 0.44717187038118894, 'f1-score': 0.44564304141820715, 'support': 314867}, 'weighted avg': {'precision': 0.4514885862368418, 'recall': 0.4468235794795898, 'f1-score': 0.44556836167356045, 'support': 314867}}
[[43702 38343 24077]
 [25219 54734 24031]
 [23963 38544 42254]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.041299
{'0': {'precision': 0.4578115313081215, 'recall': 0.431539270687237, 'f1-score': 0.44428734733168884, 'support': 34224}, '1': {'precision': 0.4316426633270716, 'recall': 0.488643411997519, 'f1-score': 0.4583777793170326, 'support': 33857}, '2': {'precision': 0.4587926840825094, 'recall': 0.42512586348202785, 'f1-score': 0.4413181203567251, 'support': 34164}, 'accuracy': 0.4483055406132329, 'macro avg': {'precision': 0.44941562623923414, 'recall': 0.44843618205559466, 'f1-score': 0.44799441566848214, 'support': 102245}, 'weighted avg': {'precision': 0.44947391812556764, 'recall': 0.4483055406132329, 'f1-score': 0.44796106326259133, 'support': 102245}}
[[14769 10598  8857]
 [ 9037 16544  8276]
 [ 8454 11186 14524]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
6143/6143 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.995005
{'0': {'precision': 0.48891452164248744, 'recall': 0.4147749942252368, 'f1-score': 0.4488035200810718, 'support': 476210}, '1': {'precision': 0.49197399062452746, 'recall': 0.6573041153633551, 'f1-score': 0.5627472184572253, 'support': 618706}, '2': {'precision': 0.5067319926873858, 'recall': 0.3627426551726304, 'f1-score': 0.422814647766323, 'support': 477581}, 'accuracy': 0.4943964916944198, 'macro avg': {'precision': 0.4958735016514669, 'recall': 0.4782739215870741, 'f1-score': 0.4781217954348734, 'support': 1572497}, 'weighted avg': {'precision': 0.49552960418642594, 'recall': 0.4943964916944198, 'f1-score': 0.48574213313951736, 'support': 1572497}}
[[197520 200004  78686]
 [122078 406678  89950]
 [ 84399 219943 173239]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0329771
{'0': {'precision': 0.4847342474833257, 'recall': 0.394968242091465, 'f1-score': 0.43527132383712824, 'support': 177751}, '1': {'precision': 0.43712302734859126, 'recall': 0.5937610477938082, 'f1-score': 0.5035418297589842, 'support': 178203}, '2': {'precision': 0.4810213091674526, 'recall': 0.3970619760580384, 'f1-score': 0.4350276898734178, 'support': 177262}, 'accuracy': 0.4621016623657205, 'macro avg': {'precision': 0.46762619466645655, 'recall': 0.46193042198110384, 'f1-score': 0.45794694782317674, 'support': 533216}, 'weighted avg': {'precision': 0.4675880531954229, 'recall': 0.4621016623657205, 'f1-score': 0.45800661670740456, 'support': 533216}}
[[ 70206  66787  40758]
 [ 37213 105810  35180]
 [ 37415  69463  70384]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0289755
{'0': {'precision': 0.47404263718910383, 'recall': 0.41848915221747846, 'f1-score': 0.44453699847285855, 'support': 57385}, '1': {'precision': 0.4458583623142586, 'recall': 0.5653343132505971, 'f1-score': 0.4985380870666736, 'support': 59869}, '2': {'precision': 0.4786321269109689, 'recall': 0.40162986239403303, 'f1-score': 0.4367630491926399, 'support': 57919}, 'accuracy': 0.4631021904060557, 'macro avg': {'precision': 0.46617770880477716, 'recall': 0.4618177759540362, 'f1-score': 0.459946044910724, 'support': 175173}, 'weighted avg': {'precision': 0.4659275412708892, 'recall': 0.4631021904060557, 'f1-score': 0.4604226190003492, 'support': 175173}}
[[24015 20072 13298]
 [13982 33846 12041]
 [12663 21994 23262]]
testing model on single stock: results/universal/W7/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
23942/23942 - 182s - 182s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1446244
{'0': {'precision': 0.31876785723288603, 'recall': 0.5482737881769402, 'f1-score': 0.4031457117645384, 'support': 1614489}, '1': {'precision': 0.5076273219595169, 'recall': 0.06491461931940203, 'f1-score': 0.11510924173527576, 'support': 2900949}, '2': {'precision': 0.30801112570625827, 'recall': 0.5690580377920218, 'f1-score': 0.39968616867889417, 'support': 1613621}, 'accuracy': 0.3249666873821903, 'macro avg': {'precision': 0.37813543496622043, 'recall': 0.3940821484294547, 'f1-score': 0.30598037405956946, 'support': 6129059}, 'weighted avg': {'precision': 0.4053250901550241, 'recall': 0.3249666873821903, 'f1-score': 0.2659041709230618, 'support': 6129059}}
[[ 885182   91002  638305]
 [1287980  188314 1424655]
 [ 603724   91653  918244]]
Evaluating performance on  train set...
9052/9052 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973207
{'0': {'precision': 0.3989308467553506, 'recall': 0.5266811564212277, 'f1-score': 0.4539901362128841, 'support': 778021}, '1': {'precision': 0.3933984248252264, 'recall': 0.08640671526717755, 'f1-score': 0.14169196134031847, 'support': 771734}, '2': {'precision': 0.3885648493178806, 'recall': 0.5673621147808681, 'f1-score': 0.46124229761914853, 'support': 767323}, 'accuracy': 0.39351372720296857, 'macro avg': {'precision': 0.3936313736328192, 'recall': 0.39348332882309106, 'f1-score': 0.352308131724117, 'support': 2317078}, 'weighted avg': {'precision': 0.39365539795408705, 'recall': 0.39351372720296857, 'f1-score': 0.3523766517119888, 'support': 2317078}}
[[409769  52826 315426]
 [335422  66683 369629]
 [281977  49996 435350]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1067612
{'0': {'precision': 0.37490915257522167, 'recall': 0.5482249686707081, 'f1-score': 0.44529728388223383, 'support': 225827}, '1': {'precision': 0.4086515403062166, 'recall': 0.08797156699229608, 'f1-score': 0.14477665588341013, 'support': 251820}, '2': {'precision': 0.38093099603567887, 'recall': 0.5355362328937113, 'f1-score': 0.4451928976177592, 'support': 229667}, 'accuracy': 0.3802441348538273, 'macro avg': {'precision': 0.3881638963057057, 'recall': 0.3905775895189052, 'f1-score': 0.3450889457944677, 'support': 707314}, 'weighted avg': {'precision': 0.3888775270177634, 'recall': 0.3802441348538273, 'f1-score': 0.33827115599155605, 'support': 707314}}
[[123804  15559  86464]
 [116246  22153 113421]
 [ 90174  16498 122995]]
training model: results/universal/W7/deepOF_L2/h100
Epoch 1/50
12475/12475 - 275s - loss: 3.2387 - accuracy100: 0.3962 - val_loss: 3.3112 - val_accuracy100: 0.3716 - 275s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 273s - loss: 3.2144 - accuracy100: 0.4063 - val_loss: 3.3332 - val_accuracy100: 0.3752 - 273s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 269s - loss: 3.2015 - accuracy100: 0.4120 - val_loss: 3.3717 - val_accuracy100: 0.3828 - 269s/epoch - 22ms/step
Epoch 4/50
12475/12475 - 269s - loss: 3.1934 - accuracy100: 0.4157 - val_loss: 3.3646 - val_accuracy100: 0.3816 - 269s/epoch - 22ms/step
Epoch 5/50
12475/12475 - 269s - loss: 3.1873 - accuracy100: 0.4182 - val_loss: 3.3661 - val_accuracy100: 0.3843 - 269s/epoch - 22ms/step
Epoch 6/50
12475/12475 - 267s - loss: 3.1830 - accuracy100: 0.4203 - val_loss: 3.4022 - val_accuracy100: 0.3863 - 267s/epoch - 21ms/step
Epoch 7/50
12475/12475 - 268s - loss: 3.1799 - accuracy100: 0.4214 - val_loss: 3.4176 - val_accuracy100: 0.3877 - 268s/epoch - 21ms/step
Epoch 8/50
12475/12475 - 267s - loss: 3.1770 - accuracy100: 0.4228 - val_loss: 3.4305 - val_accuracy100: 0.3875 - 267s/epoch - 21ms/step
Epoch 9/50
12475/12475 - 266s - loss: 3.1747 - accuracy100: 0.4234 - val_loss: 3.4542 - val_accuracy100: 0.3875 - 266s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 266s - loss: 3.1724 - accuracy100: 0.4246 - val_loss: 3.4592 - val_accuracy100: 0.3881 - 266s/epoch - 21ms/step
Epoch 11/50
12475/12475 - 267s - loss: 3.1701 - accuracy100: 0.4252 - val_loss: 3.4667 - val_accuracy100: 0.3881 - 267s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 280s - 280s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1210392
{'0': {'precision': 0.3385647349010204, 'recall': 0.6098675218466892, 'f1-score': 0.4354125123639522, 'support': 2818276}, '1': {'precision': 0.3868359751769823, 'recall': 0.021927290882889052, 'f1-score': 0.04150209011408254, 'support': 3877588}, '2': {'precision': 0.34553752583687725, 'recall': 0.517639178512309, 'f1-score': 0.4144313907411014, 'support': 2809683}, 'accuracy': 0.3427684908611782, 'macro avg': {'precision': 0.3569794119716267, 'recall': 0.3831446637472958, 'f1-score': 0.2971153310730454, 'support': 9505547}, 'weighted avg': {'precision': 0.360317014301061, 'recall': 0.3427684908611782, 'f1-score': 0.2685233657282369, 'support': 9505547}}
[[1718775   71184 1028317]
 [2066182   85025 1726381]
 [1291694   63587 1454402]]
Evaluating performance on  train set...
12475/12475 - 97s - 97s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1028901
{'0': {'precision': 0.3725517025790851, 'recall': 0.6439377155319486, 'f1-score': 0.4720169005244068, 'support': 1069737}, '1': {'precision': 0.35771057398854306, 'recall': 0.020574080488416167, 'f1-score': 0.03891020190059595, 'support': 1065321}, '2': {'precision': 0.38428738026342046, 'recall': 0.4659363717132001, 'f1-score': 0.42119140341313954, 'support': 1058020}, 'accuracy': 0.37698170855832525, 'macro avg': {'precision': 0.37151655227701613, 'recall': 0.3768160559111882, 'f1-score': 0.3107061686127141, 'support': 3193078}, 'weighted avg': {'precision': 0.3714887832743815, 'recall': 0.37698170855832525, 'f1-score': 0.3106766345683983, 'support': 3193078}}
[[688844  19819 361074]
 [614631  21918 428772]
 [545514  19536 492970]]
Evaluating performance on  val set...
3866/3866 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1036907
{'0': {'precision': 0.3633977876027628, 'recall': 0.631774235371109, 'f1-score': 0.4613983393789917, 'support': 323948}, '1': {'precision': 0.34456589184287145, 'recall': 0.021727614747930776, 'f1-score': 0.04087757395930363, 'support': 332250}, '2': {'precision': 0.3845356243519479, 'recall': 0.4677435338420375, 'f1-score': 0.4220777901073486, 'support': 333003}, 'accuracy': 0.37165449691215435, 'macro avg': {'precision': 0.3641664345991941, 'recall': 0.37374846132035905, 'f1-score': 0.308117901148548, 'support': 989201}, 'weighted avg': {'precision': 0.36418839101376316, 'recall': 0.37165449691215435, 'f1-score': 0.3069182234270301, 'support': 989201}}
[[204662   6759 112527]
 [188258   7219 136773]
 [170270   6973 155760]]
testing model out of sample: results/universal/W7/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 112s - 112s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1107713
{'0': {'precision': 0.33998789299468063, 'recall': 0.6540704637288273, 'f1-score': 0.4474104308446961, 'support': 1089667}, '1': {'precision': 0.44200707916204596, 'recall': 0.037253084364869224, 'f1-score': 0.06871477440861154, 'support': 1562072}, '2': {'precision': 0.3630574360592805, 'recall': 0.5001229400854166, 'f1-score': 0.42070778567237244, 'support': 1122498}, 'accuracy': 0.35299797018576207, 'macro avg': {'precision': 0.3816841360720023, 'recall': 0.3971488293930377, 'f1-score': 0.31227766364189335, 'support': 3774237}, 'weighted avg': {'precision': 0.389072470917518, 'recall': 0.35299797018576207, 'f1-score': 0.2827351475381442, 'support': 3774237}}
[[712719  37511 339437]
 [858428  58192 645452]
 [525160  35951 561387]]
Evaluating performance on  train set...
5285/5285 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0921351
{'0': {'precision': 0.38342373973927296, 'recall': 0.6253481177594302, 'f1-score': 0.4753766913061296, 'support': 447047}, '1': {'precision': 0.35418696259900884, 'recall': 0.03610496432465107, 'f1-score': 0.06552996240373181, 'support': 463205}, '2': {'precision': 0.38417958515094414, 'recall': 0.5004780881897524, 'f1-score': 0.43468444369402753, 'support': 442387}, 'accuracy': 0.3827251764883313, 'macro avg': {'precision': 0.373930095829742, 'recall': 0.38731039009127793, 'f1-score': 0.32519703246796294, 'support': 1352639}, 'weighted avg': {'precision': 0.37365894279705625, 'recall': 0.3827251764883313, 'f1-score': 0.3217179727525391, 'support': 1352639}}
[[279560  14547 152940]
 [244520  16724 201961]
 [205035  15947 221405]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0936403
{'0': {'precision': 0.3752415552291876, 'recall': 0.6246541851637393, 'f1-score': 0.46884129705193517, 'support': 139887}, '1': {'precision': 0.356348590638738, 'recall': 0.035346248308676886, 'f1-score': 0.06431325877569118, 'support': 155943}, '2': {'precision': 0.38091799026869166, 'recall': 0.5081469187980394, 'f1-score': 0.43542895708922624, 'support': 142201}, 'accuracy': 0.37703267576952315, 'macro avg': {'precision': 0.37083604537887244, 'recall': 0.3893824507568185, 'f1-score': 0.32286117097228423, 'support': 438031}, 'weighted avg': {'precision': 0.3703582687995149, 'recall': 0.37703267576952315, 'f1-score': 0.31397877812530783, 'support': 438031}}
[[87381  4774 47732]
 [80725  5512 69706]
 [64760  5182 72259]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
695/695 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1454865
{'0': {'precision': 0.3158293763217749, 'recall': 0.7461209253219208, 'f1-score': 0.44380025343994256, 'support': 53041}, '1': {'precision': 0.4322990126939351, 'recall': 0.008590487401552735, 'f1-score': 0.016846213037265034, 'support': 71358}, '2': {'precision': 0.33465505117587313, 'recall': 0.3201233183856502, 'f1-score': 0.32722793078421636, 'support': 53520}, 'accuracy': 0.3221746974746935, 'macro avg': {'precision': 0.36092781339719443, 'recall': 0.35827824370304123, 'f1-score': 0.2626247990871413, 'support': 177919}, 'weighted avg': {'precision': 0.36820484173264134, 'recall': 0.3221746974746935, 'f1-score': 0.2374954904658435, 'support': 177919}}
[[39575   345 13121]
 [49803   613 20942]
 [35927   460 17133]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1179249
{'0': {'precision': 0.3563617988883274, 'recall': 0.7155147924191388, 'f1-score': 0.47576771547304225, 'support': 24641}, '1': {'precision': 0.3303437967115097, 'recall': 0.009270911989260845, 'f1-score': 0.01803566327987922, 'support': 23838}, '2': {'precision': 0.3575286041189931, 'recall': 0.33221348075696366, 'f1-score': 0.3444064807671112, 'support': 23515}, 'accuracy': 0.3564741506236631, 'macro avg': {'precision': 0.34807806657294343, 'recall': 0.35233306172178774, 'f1-score': 0.27940328650667756, 'support': 71994}, 'weighted avg': {'precision': 0.3481280612033554, 'recall': 0.3564741506236631, 'f1-score': 0.2813018420073286, 'support': 71994}}
[[17631   241  6769]
 [16348   221  7269]
 [15496   207  7812]]
Evaluating performance on  val set...
73/73 - 1s - 769ms/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944171
{'0': {'precision': 0.3737992008841282, 'recall': 0.6705810584108586, 'f1-score': 0.48002183406113547, 'support': 6557}, '1': {'precision': 0.26433915211970077, 'recall': 0.02049101101875121, 'f1-score': 0.03803372802296376, 'support': 5173}, '2': {'precision': 0.3896595208070618, 'recall': 0.36470935379167896, 'f1-score': 0.37677183356195704, 'support': 6778}, 'accuracy': 0.3768640587853901, 'macro avg': {'precision': 0.3425992912702969, 'recall': 0.35192714107376294, 'f1-score': 0.2982757985486854, 'support': 18508}, 'weighted avg': {'precision': 0.34901340102348744, 'recall': 0.3768640587853901, 'f1-score': 0.31867360756886765, 'support': 18508}}
[[4397  153 2007]
 [3202  106 1865]
 [4164  142 2472]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0980855
{'0': {'precision': 0.37042369468608677, 'recall': 0.6734568261187889, 'f1-score': 0.4779557828134197, 'support': 154341}, '1': {'precision': 0.3564198381888764, 'recall': 0.04654446218499339, 'f1-score': 0.08233667183505847, 'support': 211067}, '2': {'precision': 0.39400659975921115, 'recall': 0.5464821487726225, 'f1-score': 0.45788442148432634, 'support': 147917}, 'accuracy': 0.37909706326401404, 'macro avg': {'precision': 0.3736167108780581, 'recall': 0.422161145692135, 'f1-score': 0.3393922920442682, 'support': 513325}, 'weighted avg': {'precision': 0.3714611672237669, 'recall': 0.37909706326401404, 'f1-score': 0.3095029810784852, 'support': 513325}}
[[103942   8526  41873]
 [118791   9824  82452]
 [ 57870   9213  80834]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095727
{'0': {'precision': 0.38048794081174847, 'recall': 0.6556385200835514, 'f1-score': 0.4815291566010122, 'support': 41651}, '1': {'precision': 0.36779356524579454, 'recall': 0.03968281938325991, 'f1-score': 0.07163647352599685, 'support': 56750}, '2': {'precision': 0.3796717023524086, 'recall': 0.578627280625543, 'f1-score': 0.458496583143508, 'support': 39134}, 'accuracy': 0.3795688370233032, 'macro avg': {'precision': 0.3759844028033172, 'recall': 0.42464954003078476, 'f1-score': 0.33722073775683903, 'support': 137535}, 'weighted avg': {'precision': 0.3750177078584225, 'recall': 0.3795688370233032, 'f1-score': 0.3058446654228169, 'support': 137535}}
[[27308  2026 12317]
 [29818  2252 24680]
 [14645  1845 22644]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0821867
{'0': {'precision': 0.3889544605094915, 'recall': 0.6536903876353418, 'f1-score': 0.48771313168686214, 'support': 12099}, '1': {'precision': 0.35481963335304556, 'recall': 0.04071937563624024, 'f1-score': 0.07305491294289541, 'support': 14735}, '2': {'precision': 0.40534508076358294, 'recall': 0.5649148657498363, 'f1-score': 0.4720084812420916, 'support': 12216}, 'accuracy': 0.3946222791293214, 'macro avg': {'precision': 0.38303972487537336, 'recall': 0.4197748763404728, 'f1-score': 0.3442588419572831, 'support': 39050}, 'weighted avg': {'precision': 0.38120160875209713, 'recall': 0.3946222791293214, 'f1-score': 0.3263344668206479, 'support': 39050}}
[[7909  595 3595]
 [7606  600 6529]
 [4819  496 6901]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062256
{'0': {'precision': 0.3558378787226585, 'recall': 0.7333257296379374, 'f1-score': 0.4791659766155478, 'support': 78909}, '1': {'precision': 0.3925942962281509, 'recall': 0.021757418170694404, 'f1-score': 0.041229892275735466, 'support': 78456}, '2': {'precision': 0.3850478350922182, 'recall': 0.33916227117592307, 'f1-score': 0.3606514107741442, 'support': 80575}, 'accuracy': 0.3652223249558712, 'macro avg': {'precision': 0.3778266700143425, 'recall': 0.36474847299485164, 'f1-score': 0.2936824265551425, 'support': 237940}, 'weighted avg': {'precision': 0.37784911569957785, 'recall': 0.3652223249558712, 'f1-score': 0.29463195721723134, 'support': 237940}}
[[57866  1245 19798]
 [52902  1707 23847]
 [51851  1396 27328]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1021118
{'0': {'precision': 0.3627434769668309, 'recall': 0.6761596548004315, 'f1-score': 0.47217588756282086, 'support': 32445}, '1': {'precision': 0.4289788933257273, 'recall': 0.023323615160349854, 'f1-score': 0.044241800264744814, 'support': 32242}, '2': {'precision': 0.3763495706877497, 'recall': 0.40450156854384306, 'f1-score': 0.3899180881359913, 'support': 32833}, 'accuracy': 0.368857670221493, 'macro avg': {'precision': 0.3893573136601027, 'recall': 0.36799494616820816, 'f1-score': 0.3021119253211857, 'support': 97520}, 'weighted avg': {'precision': 0.3892230828874878, 'recall': 0.368857670221493, 'f1-score': 0.3029980658724429, 'support': 97520}}
[[21938   496 10011]
 [19493   752 11997]
 [19047   505 13281]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1038578
{'0': {'precision': 0.3569338794616735, 'recall': 0.6966362126245847, 'f1-score': 0.4720199781928177, 'support': 9632}, '1': {'precision': 0.38, 'recall': 0.012252794496990542, 'f1-score': 0.023740108288213244, 'support': 9304}, '2': {'precision': 0.38845460012026456, 'recall': 0.3822108273345824, 'f1-score': 0.3853074208459664, 'support': 10141}, 'accuracy': 0.3679884444750146, 'macro avg': {'precision': 0.3751294931939794, 'recall': 0.36369994481871926, 'f1-score': 0.2936891691089991, 'support': 29077}, 'weighted avg': {'precision': 0.37530781121829765, 'recall': 0.3679884444750146, 'f1-score': 0.2983381006385013, 'support': 29077}}
[[6710  100 2822]
 [5910  114 3280]
 [6179   86 3876]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1065/1065 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1394346
{'0': {'precision': 0.3205052878965922, 'recall': 0.8232311918601224, 'f1-score': 0.4613824160067135, 'support': 84817}, '1': {'precision': 0.42376681614349776, 'recall': 0.0020123723634195424, 'f1-score': 0.004005722460658083, 'support': 93919}, '2': {'precision': 0.38488956194134594, 'recall': 0.222389397528651, 'f1-score': 0.28189798595988147, 'support': 93714}, 'accuracy': 0.3334703615342265, 'macro avg': {'precision': 0.37638722199381197, 'recall': 0.34921098725073096, 'f1-score': 0.24909537480908436, 'support': 272450}, 'weighted avg': {'precision': 0.37824772624950526, 'recall': 0.3334703615342265, 'f1-score': 0.2419786150943964, 'support': 272450}}
[[69824   131 14862]
 [75285   189 18445]
 [72747   126 20841]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1251255
{'0': {'precision': 0.3551010807531847, 'recall': 0.8051875140354817, 'f1-score': 0.4928479995876324, 'support': 35624}, '1': {'precision': 0.3319838056680162, 'recall': 0.002431214421252372, 'f1-score': 0.004827078734363503, 'support': 33728}, '2': {'precision': 0.36634579785264715, 'recall': 0.2378605769230769, 'f1-score': 0.2884419180877423, 'support': 33280}, 'accuracy': 0.3574128926650557, 'macro avg': {'precision': 0.35114356142461606, 'recall': 0.34849310179327037, 'f1-score': 0.26203899880324605, 'support': 102632}, 'weighted avg': {'precision': 0.351150312289134, 'recall': 0.3574128926650557, 'f1-score': 0.2661876596268464, 'support': 102632}}
[[28684    86  6854]
 [26808    82  6838]
 [25285    79  7916]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1378043
{'0': {'precision': 0.3204792509719908, 'recall': 0.827918417546377, 'f1-score': 0.46208849355032466, 'support': 9757}, '1': {'precision': 0.2962962962962963, 'recall': 0.0007550731477111845, 'f1-score': 0.0015063076633402373, 'support': 10595}, '2': {'precision': 0.3885816525699414, 'recall': 0.21661075346812947, 'f1-score': 0.2781626593700879, 'support': 11029}, 'accuracy': 0.33380070743443485, 'macro avg': {'precision': 0.3351190666127428, 'recall': 0.3484280813874059, 'f1-score': 0.24725248686125093, 'support': 31381}, 'weighted avg': {'precision': 0.33624939795375736, 'recall': 0.33380070743443485, 'f1-score': 0.24194298242427922, 'support': 31381}}
[[8078    7 1672]
 [8500    8 2087]
 [8628   12 2389]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1655742
{'0': {'precision': 0.27862589198686916, 'recall': 0.7719772031395359, 'f1-score': 0.40946545430156456, 'support': 110717}, '1': {'precision': 0.45503133063029855, 'recall': 0.01306363030296617, 'f1-score': 0.025398099000123443, 'support': 188998}, '2': {'precision': 0.3162381410697099, 'recall': 0.28379879077036974, 'f1-score': 0.29914159368767884, 'support': 121565}, 'accuracy': 0.29063805545005694, 'macro avg': {'precision': 0.3499651212289592, 'recall': 0.3562798747376239, 'f1-score': 0.24466838232978896, 'support': 421280}, 'weighted avg': {'precision': 0.36861973967127476, 'recall': 0.29063805545005694, 'f1-score': 0.20532691904522962, 'support': 421280}}
[[ 85471   1502  23744]
 [135678   2469  50851]
 [ 85610   1455  34500]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1167085
{'0': {'precision': 0.3472667811976073, 'recall': 0.7478103897840476, 'f1-score': 0.47428567390121346, 'support': 44871}, '1': {'precision': 0.4101818181818182, 'recall': 0.01258647623298371, 'f1-score': 0.024423514127963626, 'support': 44810}, '2': {'precision': 0.3583802393573419, 'recall': 0.2919987532837615, 'f1-score': 0.32180185485058144, 'support': 44918}, 'accuracy': 0.35093128477923313, 'macro avg': {'precision': 0.37194294624558916, 'recall': 0.35079853976693093, 'f1-score': 0.2735036809599195, 'support': 134599}, 'weighted avg': {'precision': 0.371920880565964, 'recall': 0.35093128477923313, 'f1-score': 0.27363342861294526, 'support': 134599}}
[[33555   420 10896]
 [31660   564 12586]
 [31411   391 13116]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.114667
{'0': {'precision': 0.3448172333558508, 'recall': 0.7510217426843224, 'f1-score': 0.4726337448559671, 'support': 12234}, '1': {'precision': 0.37104072398190047, 'recall': 0.006678068246599886, 'f1-score': 0.01312, 'support': 12279}, '2': {'precision': 0.3716712799465496, 'recall': 0.30348375029226093, 'f1-score': 0.33413420284880724, 'support': 12831}, 'accuracy': 0.35250642673521854, 'macro avg': {'precision': 0.36250974576143363, 'recall': 0.3537278537410611, 'f1-score': 0.2732959825682581, 'support': 37344}, 'weighted avg': {'precision': 0.36266648660141954, 'recall': 0.35250642673521854, 'f1-score': 0.27395505760820876, 'support': 37344}}
[[9188   74 2972]
 [8586   82 3611]
 [8872   65 3894]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/EXC
Evaluating performance on  test set...
5928/5928 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0744861
{'0': {'precision': 0.4059094314813903, 'recall': 0.6582768050037014, 'f1-score': 0.5021691777540325, 'support': 463337}, '1': {'precision': 0.341370168133576, 'recall': 0.06752426905151368, 'f1-score': 0.11274680691622084, 'support': 608285}, '2': {'precision': 0.4199582557855066, 'recall': 0.6082014414301283, 'f1-score': 0.49684736174921046, 'support': 445946}, 'accuracy': 0.40677122870276655, 'macro avg': {'precision': 0.389079285133491, 'recall': 0.44466750516178116, 'f1-score': 0.3705877821398213, 'support': 1517568}, 'weighted avg': {'precision': 0.38416856135075905, 'recall': 0.40677122870276655, 'f1-score': 0.3445136200425068, 'support': 1517568}}
[[305004  43419 114914]
 [307512  41074 259699]
 [138893  35828 271225]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.069347
{'0': {'precision': 0.42440551790048164, 'recall': 0.6422332591197123, 'f1-score': 0.5110771234308039, 'support': 105102}, '1': {'precision': 0.30754115540806076, 'recall': 0.06548399393787249, 'f1-score': 0.10797675809097461, 'support': 107553}, '2': {'precision': 0.4427596227853747, 'recall': 0.5682894627507825, 'f1-score': 0.49773177536085395, 'support': 108311}, 'accuracy': 0.4240168740614271, 'macro avg': {'precision': 0.3915687653646391, 'recall': 0.4253355719361225, 'f1-score': 0.37226188562754414, 'support': 320966}, 'weighted avg': {'precision': 0.39143890671749126, 'recall': 0.4240168740614271, 'f1-score': 0.3714981599636485, 'support': 320966}}
[[67500  7856 29746]
 [52789  7043 47721]
 [38757  8002 61552]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0742917
{'0': {'precision': 0.4122554608465896, 'recall': 0.641635918091429, 'f1-score': 0.5019832525341561, 'support': 35503}, '1': {'precision': 0.3164028144239226, 'recall': 0.0765771758507836, 'f1-score': 0.12331026800059983, 'support': 37583}, '2': {'precision': 0.4432654153105355, 'recall': 0.5504221453287197, 'f1-score': 0.49106602620303025, 'support': 36125}, 'accuracy': 0.41700927562241896, 'macro avg': {'precision': 0.3906412301936826, 'recall': 0.4228784130903107, 'f1-score': 0.3721198489125954, 'support': 109211}, 'weighted avg': {'precision': 0.38952702318469606, 'recall': 0.41700927562241896, 'f1-score': 0.36805854184625314, 'support': 109211}}
[[22780  2996  9727]
 [19458  2878 15247]
 [13019  3222 19884]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/AAL
Evaluating performance on  test set...
5331/5331 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1055661
{'0': {'precision': 0.3468804373053021, 'recall': 0.6232471885084979, 'f1-score': 0.44569858964231235, 'support': 386094}, '1': {'precision': 0.36482795212922753, 'recall': 0.03175067383600815, 'f1-score': 0.0584173354583629, 'support': 584712}, '2': {'precision': 0.3607145679673425, 'recall': 0.5679274749552432, 'f1-score': 0.44120275476767745, 'support': 393795}, 'accuracy': 0.35383529691096516, 'macro avg': {'precision': 0.3574743191339574, 'recall': 0.40764177909991645, 'f1-score': 0.31510622662278426, 'support': 1364601}, 'weighted avg': {'precision': 0.3585629282105449, 'recall': 0.35383529691096516, 'f1-score': 0.27845671162019286, 'support': 1364601}}
[[240632  17254 128208]
 [297991  18565 268156]
 [155080  15068 223647]]
Evaluating performance on  train set...
2013/2013 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085959
{'0': {'precision': 0.3974374054439924, 'recall': 0.5908348156411106, 'f1-score': 0.4752129042270461, 'support': 165845}, '1': {'precision': 0.3043606219649777, 'recall': 0.03309633406762213, 'f1-score': 0.05970077452253812, 'support': 187483}, '2': {'precision': 0.38088623699552293, 'recall': 0.5840340284722993, 'f1-score': 0.4610754511913987, 'support': 161982}, 'accuracy': 0.3857774931594574, 'macro avg': {'precision': 0.36089475480149763, 'recall': 0.40265505939367735, 'f1-score': 0.3319963766469943, 'support': 515310}, 'weighted avg': {'precision': 0.3583710066459561, 'recall': 0.3857774931594574, 'f1-score': 0.31959497806413345, 'support': 515310}}
[[97987  6434 61424]
 [88929  6205 92349]
 [59631  7748 94603]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0891488
{'0': {'precision': 0.386137162954279, 'recall': 0.5766284922313808, 'f1-score': 0.462537667125011, 'support': 54836}, '1': {'precision': 0.3147708382806934, 'recall': 0.03852525722257746, 'f1-score': 0.06864852267136236, 'support': 68812}, '2': {'precision': 0.3685958524977459, 'recall': 0.5949779849302702, 'f1-score': 0.4551937984496124, 'support': 54281}, 'accuracy': 0.3741211382068128, 'macro avg': {'precision': 0.3565012845775728, 'recall': 0.40337724479474285, 'f1-score': 0.3287933294153286, 'support': 177929}, 'weighted avg': {'precision': 0.3531857081249378, 'recall': 0.3741211382068128, 'f1-score': 0.30796515593395285, 'support': 177929}}
[[31620  2625 20591]
 [31429  2651 34732]
 [18839  3146 32296]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/WBA
Evaluating performance on  test set...
4192/4192 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1042739
{'0': {'precision': 0.3454886515895895, 'recall': 0.6739876371493839, 'f1-score': 0.4568131353693786, 'support': 315623}, '1': {'precision': 0.5199055994156154, 'recall': 0.042966536950525214, 'f1-score': 0.0793734196625611, 'support': 430684}, '2': {'precision': 0.3776548205781043, 'recall': 0.4874127243466182, 'f1-score': 0.425570849445346, 'support': 326838}, 'accuracy': 0.36391727119820716, 'macro avg': {'precision': 0.4143496905277697, 'recall': 0.40145563281550906, 'f1-score': 0.32058580149242855, 'support': 1073145}, 'weighted avg': {'precision': 0.4252837539265266, 'recall': 0.36391727119820716, 'f1-score': 0.2958205269461795, 'support': 1073145}}
[[212726   8933  93964]
 [243621  18505 168558]
 [159378   8155 159305]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.086483
{'0': {'precision': 0.3896796554276869, 'recall': 0.6508336455601349, 'f1-score': 0.4874836881024879, 'support': 106760}, '1': {'precision': 0.4299903567984571, 'recall': 0.043333333333333335, 'f1-score': 0.07873223271828375, 'support': 102900}, '2': {'precision': 0.3986401350355419, 'recall': 0.4781430893381619, 'f1-score': 0.43478711818700405, 'support': 105207}, 'accuracy': 0.39459835422575246, 'macro avg': {'precision': 0.406103382420562, 'recall': 0.3907700227438767, 'f1-score': 0.3336676796692586, 'support': 314867}, 'weighted avg': {'precision': 0.40584735909036307, 'recall': 0.39459835422575246, 'f1-score': 0.33629422464606684, 'support': 314867}}
[[69483  3102 34175]
 [56731  4459 41710]
 [52094  2809 50304]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0781003
{'0': {'precision': 0.40201961322178026, 'recall': 0.6452669235002751, 'f1-score': 0.4953944310643511, 'support': 36340}, '1': {'precision': 0.3570595099183197, 'recall': 0.031083872278468153, 'f1-score': 0.05718913531024171, 'support': 29533}, '2': {'precision': 0.4162192231412954, 'recall': 0.4731386781040361, 'f1-score': 0.44285751048663113, 'support': 36372}, 'accuracy': 0.4066311311066556, 'macro avg': {'precision': 0.39176611542713174, 'recall': 0.3831631579609265, 'f1-score': 0.33181369228707464, 'support': 102245}, 'weighted avg': {'precision': 0.39408437415025116, 'recall': 0.4066311311066556, 'f1-score': 0.3501316810544832, 'support': 102245}}
[[23449   849 12042]
 [16520   918 12095]
 [18359   804 17209]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
6143/6143 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974575
{'0': {'precision': 0.35822820852470383, 'recall': 0.6278199893253722, 'f1-score': 0.4561700544504665, 'support': 460906}, '1': {'precision': 0.4985182840866588, 'recall': 0.05427000006264212, 'f1-score': 0.09788408359719912, 'support': 638548}, '2': {'precision': 0.37251317222203845, 'recall': 0.5474682005652763, 'f1-score': 0.44335488112194593, 'support': 473043}, 'accuracy': 0.3707453813902348, 'macro avg': {'precision': 0.4097532216111337, 'recall': 0.4098527299844303, 'f1-score': 0.33246967305653713, 'support': 1572497}, 'weighted avg': {'precision': 0.41949341237069754, 'recall': 0.3707453813902348, 'f1-score': 0.3068248295290482, 'support': 1572497}}
[[289366  17019 154521]
 [322178  34654 281716]
 [196226  17841 258976]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0864056
{'0': {'precision': 0.39279211310927176, 'recall': 0.6041563223520879, 'f1-score': 0.4760684305506404, 'support': 179245}, '1': {'precision': 0.3896619411123228, 'recall': 0.05109476526036424, 'f1-score': 0.0903431989765217, 'support': 174832}, '2': {'precision': 0.3945855161918727, 'recall': 0.5167328164163024, 'f1-score': 0.44747324354896406, 'support': 179139}, 'accuracy': 0.39344655824281344, 'macro avg': {'precision': 0.3923465234711558, 'recall': 0.39066130134291815, 'f1-score': 0.3379616243587087, 'support': 533216}, 'weighted avg': {'precision': 0.39236829650257476, 'recall': 0.39344655824281344, 'f1-score': 0.33998919269795097, 'support': 533216}}
[[108292   6890  64063]
 [ 87936   8933  77963]
 [ 79470   7102  92567]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0922328
{'0': {'precision': 0.3779917086930507, 'recall': 0.6247262838171929, 'f1-score': 0.47100252962321926, 'support': 56628}, '1': {'precision': 0.4258777633289987, 'recall': 0.04339544513457557, 'f1-score': 0.07876501270160988, 'support': 60375}, '2': {'precision': 0.3927269352636254, 'recall': 0.5092487536530858, 'f1-score': 0.4434614031542152, 'support': 58170}, 'accuracy': 0.38601839324553444, 'macro avg': {'precision': 0.3988654690952249, 'recall': 0.39245682753495137, 'f1-score': 0.33107631515968144, 'support': 175173}, 'weighted avg': {'precision': 0.3993892338724773, 'recall': 0.38601839324553444, 'f1-score': 0.32666860024572314, 'support': 175173}}
[[35377  1681 19570]
 [31519  2620 26236]
 [26696  1851 29623]]
testing model on single stock: results/universal/W7/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
23942/23942 - 197s - 197s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1366068
{'0': {'precision': 0.3198398356253626, 'recall': 0.5705443633281079, 'f1-score': 0.4098967964578072, 'support': 1800158}, '1': {'precision': 0.43005837647317985, 'recall': 0.006164270831647677, 'f1-score': 0.012154326797924784, 'support': 2533633}, '2': {'precision': 0.32005190276594964, 'recall': 0.513707702693971, 'f1-score': 0.39438976567361084, 'support': 1795268}, 'accuracy': 0.320592606466996, 'macro avg': {'precision': 0.35665003828816405, 'recall': 0.3634721122845755, 'f1-score': 0.27214696297644764, 'support': 6129059}, 'weighted avg': {'precision': 0.3654641393978055, 'recall': 0.320592606466996, 'f1-score': 0.2409356683672374, 'support': 6129059}}
[[1027070   10480  762608]
 [1321324   15618 1196691]
 [ 862807   10218  922243]]
Evaluating performance on  train set...
9052/9052 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1091974
{'0': {'precision': 0.3648870163899223, 'recall': 0.635630284396618, 'f1-score': 0.46362664157477185, 'support': 780600}, '1': {'precision': 0.3720058125908217, 'recall': 0.010382134774133623, 'f1-score': 0.02020050323078235, 'support': 764390}, '2': {'precision': 0.3745547285847688, 'recall': 0.45404539378930897, 'f1-score': 0.4104871448694815, 'support': 772088}, 'accuracy': 0.3688576733282177, 'macro avg': {'precision': 0.37048251918850433, 'recall': 0.36668593765335356, 'f1-score': 0.29810476322501195, 'support': 2317078}, 'weighted avg': {'precision': 0.3704569027731602, 'recall': 0.3688576733282177, 'f1-score': 0.299636101066012, 'support': 2317078}}
[[496173   6782 277645]
 [448716   7936 307738]
 [414910   6615 350563]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1116185
{'0': {'precision': 0.3521618989713246, 'recall': 0.618825706083414, 'f1-score': 0.44887665847046615, 'support': 230249}, '1': {'precision': 0.37160362280234416, 'recall': 0.011634501509566146, 'f1-score': 0.022562592999935308, 'support': 239804}, '2': {'precision': 0.3698138261835723, 'recall': 0.4601346196804363, 'f1-score': 0.41005955276269607, 'support': 237261}, 'accuracy': 0.35973556298899784, 'macro avg': {'precision': 0.3645264493190803, 'recall': 0.36353160909113885, 'f1-score': 0.29383293474436584, 'support': 707314}, 'weighted avg': {'precision': 0.3646744705362574, 'recall': 0.35973556298899784, 'f1-score': 0.2913206034886244, 'support': 707314}}
[[142484   2326  85439]
 [136417   2790 100597]
 [125697   2392 109172]]
training model: results/universal/W7/deepOF_L2/h200
Epoch 1/50
12475/12475 - 273s - loss: 3.2658 - accuracy200: 0.3814 - val_loss: 3.2871 - val_accuracy200: 0.3568 - 273s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 267s - loss: 3.2590 - accuracy200: 0.3856 - val_loss: 3.2856 - val_accuracy200: 0.3555 - 267s/epoch - 21ms/step
Epoch 3/50
12475/12475 - 267s - loss: 3.2528 - accuracy200: 0.3900 - val_loss: 3.2926 - val_accuracy200: 0.3512 - 267s/epoch - 21ms/step
Epoch 4/50
12475/12475 - 267s - loss: 3.2471 - accuracy200: 0.3934 - val_loss: 3.2894 - val_accuracy200: 0.3532 - 267s/epoch - 21ms/step
Epoch 5/50
12475/12475 - 267s - loss: 3.2427 - accuracy200: 0.3960 - val_loss: 3.2923 - val_accuracy200: 0.3530 - 267s/epoch - 21ms/step
Epoch 6/50
12475/12475 - 267s - loss: 3.2397 - accuracy200: 0.3976 - val_loss: 3.2922 - val_accuracy200: 0.3545 - 267s/epoch - 21ms/step
Epoch 7/50
12475/12475 - 269s - loss: 3.2372 - accuracy200: 0.3992 - val_loss: 3.2921 - val_accuracy200: 0.3560 - 269s/epoch - 22ms/step
Epoch 8/50
12475/12475 - 267s - loss: 3.2350 - accuracy200: 0.4004 - val_loss: 3.2932 - val_accuracy200: 0.3568 - 267s/epoch - 21ms/step
Epoch 9/50
12475/12475 - 266s - loss: 3.2331 - accuracy200: 0.4014 - val_loss: 3.2930 - val_accuracy200: 0.3589 - 266s/epoch - 21ms/step
Epoch 10/50
12475/12475 - 269s - loss: 3.2315 - accuracy200: 0.4023 - val_loss: 3.2938 - val_accuracy200: 0.3599 - 269s/epoch - 22ms/step
Epoch 11/50
12475/12475 - 268s - loss: 3.2299 - accuracy200: 0.4031 - val_loss: 3.2974 - val_accuracy200: 0.3603 - 268s/epoch - 22ms/step
Epoch 12/50
12475/12475 - 268s - loss: 3.2283 - accuracy200: 0.4040 - val_loss: 3.2997 - val_accuracy200: 0.3609 - 268s/epoch - 21ms/step
testing model in sample: results/universal/W7/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 283s - 283s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0829864
{'0': {'precision': 0.3608078762627523, 'recall': 0.32228798854137475, 'f1-score': 0.34046186101258663, 'support': 2826168}, '1': {'precision': 0.412354727132836, 'recall': 0.58936673045831, 'f1-score': 0.4852210272179283, 'support': 3879296}, '2': {'precision': 0.33869484558329593, 'recall': 0.17376163492296479, 'f1-score': 0.22968650938083163, 'support': 2800083}, 'accuracy': 0.3875331950912451, 'macro avg': {'precision': 0.37061914965962806, 'recall': 0.3618054513075499, 'f1-score': 0.35178979920378217, 'support': 9505547}, 'weighted avg': {'precision': 0.37533067764481776, 'recall': 0.3875331950912451, 'f1-score': 0.36690783781966757, 'support': 9505547}}
[[ 910840 1551708  363620]
 [1006600 2286328  586368]
 [ 607006 1706530  486547]]
Evaluating performance on  train set...
12475/12475 - 99s - 99s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956783
{'0': {'precision': 0.3908809695326073, 'recall': 0.29742368047226075, 'f1-score': 0.3378075582785368, 'support': 1085502}, '1': {'precision': 0.32508559384096086, 'recall': 0.591790725170656, 'f1-score': 0.41964796196080634, 'support': 1034391}, '2': {'precision': 0.3804111615147534, 'recall': 0.17159576401086485, 'f1-score': 0.2365076990156536, 'support': 1073185}, 'accuracy': 0.3504928473404032, 'macro avg': {'precision': 0.3654592416294405, 'recall': 0.3536033898845939, 'f1-score': 0.3313210730849989, 'support': 3193078}, 'weighted avg': {'precision': 0.3660478193951229, 'recall': 0.3504928473404032, 'f1-score': 0.3302729748898031, 'support': 3193078}}
[[322854 617789 144859]
 [267169 612143 155079]
 [235942 653089 184154]]
Evaluating performance on  val set...
3866/3866 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953102
{'0': {'precision': 0.3710532827006035, 'recall': 0.32328167958010495, 'f1-score': 0.3455240912862655, 'support': 320080}, '1': {'precision': 0.34264190292770386, 'recall': 0.5742512460656425, 'f1-score': 0.4291940449692786, 'support': 336459}, '2': {'precision': 0.37645194993205455, 'recall': 0.16571775555969723, 'f1-score': 0.2301300555412928, 'support': 332662}, 'accuracy': 0.35565673710398593, 'macro avg': {'precision': 0.3633823785201207, 'recall': 0.3544168937351482, 'f1-score': 0.3349493972656123, 'support': 989201}, 'weighted avg': {'precision': 0.3632051982481403, 'recall': 0.35565673710398593, 'f1-score': 0.3351766474677077, 'support': 989201}}
[[103476 174811  41793]
 [ 93727 193212  49520]
 [ 81668 195866  55128]]
testing model out of sample: results/universal/W7/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 114s - 114s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850102
{'0': {'precision': 0.363574376643301, 'recall': 0.3668485979879548, 'f1-score': 0.3652041487420985, 'support': 1151167}, '1': {'precision': 0.37987680619885783, 'recall': 0.575873595588225, 'f1-score': 0.4577785619702874, 'support': 1428178}, '2': {'precision': 0.3929285460584954, 'recall': 0.1472082832590728, 'f1-score': 0.21417660699728652, 'support': 1194892}, 'accuracy': 0.3764077348613773, 'macro avg': {'precision': 0.37879324296688477, 'recall': 0.3633101589450842, 'f1-score': 0.34571977256989084, 'support': 3774237}, 'weighted avg': {'precision': 0.3790365305670362, 'recall': 0.3764077348613773, 'f1-score': 0.3524204096512217, 'support': 3774237}}
[[422304 620729 108134]
 [442101 822450 163627]
 [297129 721865 175898]]
Evaluating performance on  train set...
5285/5285 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0933876
{'0': {'precision': 0.397334844145299, 'recall': 0.33190772901450105, 'f1-score': 0.36168624990493575, 'support': 458519}, '1': {'precision': 0.3272300410854552, 'recall': 0.5960267310833004, 'f1-score': 0.4224996936491864, 'support': 439638}, '2': {'precision': 0.3985975884206287, 'recall': 0.14808947329047134, 'f1-score': 0.21594843214071427, 'support': 454482}, 'accuracy': 0.3559900313387386, 'macro avg': {'precision': 0.37438749121712767, 'recall': 0.3586746444627576, 'f1-score': 0.33337812523161214, 'support': 1352639}, 'weighted avg': {'precision': 0.37497348914674933, 'recall': 0.3559900313387386, 'f1-score': 0.33248458256258945, 'support': 1352639}}
[[152186 257906  48427]
 [124481 262036  53121]
 [106350 280828  67304]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09133
{'0': {'precision': 0.385349222482773, 'recall': 0.33597326113654125, 'f1-score': 0.35897130033810365, 'support': 143312}, '1': {'precision': 0.3409670201381457, 'recall': 0.5928040810251275, 'f1-score': 0.43292545845778335, 'support': 147806}, '2': {'precision': 0.40324736663874383, 'recall': 0.15400270908633001, 'f1-score': 0.22288444488227765, 'support': 146913}, 'accuracy': 0.36160454397063224, 'macro avg': {'precision': 0.3765212030865541, 'recall': 0.36092668374933295, 'f1-score': 0.3382604012260549, 'support': 438031}, 'weighted avg': {'precision': 0.37637614581156975, 'recall': 0.36160454397063224, 'f1-score': 0.33828313009320227, 'support': 438031}}
[[48149 79780 15383]
 [42087 87620 18099]
 [34713 89575 22625]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992467
{'0': {'precision': 0.34214311743608433, 'recall': 0.31531595227574016, 'f1-score': 0.3281822028441599, 'support': 56575}, '1': {'precision': 0.34991999528806605, 'recall': 0.5769641643197048, 'f1-score': 0.4356343682592835, 'support': 61782}, '2': {'precision': 0.3579524068420392, 'recall': 0.14369900271985495, 'f1-score': 0.20507229882716568, 'support': 59562}, 'accuracy': 0.34872048516459736, 'macro avg': {'precision': 0.35000517318872987, 'recall': 0.34532637310509995, 'f1-score': 0.32296295664353636, 'support': 177919}, 'weighted avg': {'precision': 0.35013610280048396, 'recall': 0.34872048516459736, 'f1-score': 0.32428120059379295, 'support': 177919}}
[[17839 31748  6988]
 [17772 35646  8364]
 [16528 34475  8559]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986019
{'0': {'precision': 0.3676426799007444, 'recall': 0.30089358245329, 'f1-score': 0.3309358945722582, 'support': 24620}, '1': {'precision': 0.3337823275862069, 'recall': 0.5717342058897559, 'f1-score': 0.4214937374362147, 'support': 23838}, '2': {'precision': 0.3508899382491827, 'recall': 0.16417403127124405, 'f1-score': 0.22368878082667593, 'support': 23536}, 'accuracy': 0.3458760452259911, 'macro avg': {'precision': 0.3507716485787113, 'recall': 0.3456006065380966, 'f1-score': 0.32537280427838294, 'support': 71994}, 'weighted avg': {'precision': 0.35095440579477577, 'recall': 0.3458760452259911, 'f1-score': 0.32585977418826745, 'support': 71994}}
[[ 7408 13715  3497]
 [ 6558 13629  3651]
 [ 6184 13488  3864]]
Evaluating performance on  val set...
73/73 - 1s - 787ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1017919
{'0': {'precision': 0.3671442215854823, 'recall': 0.30239144115796096, 'f1-score': 0.33163661461478733, 'support': 6356}, '1': {'precision': 0.31485882688468486, 'recall': 0.5791222241650639, 'f1-score': 0.4079320113314448, 'support': 5719}, '2': {'precision': 0.3765432098765432, 'recall': 0.16120006217938754, 'f1-score': 0.22575378251877654, 'support': 6433}, 'accuracy': 0.33882645342554574, 'macro avg': {'precision': 0.3528487527822368, 'recall': 0.3475712425008042, 'f1-score': 0.3217741361550029, 'support': 18508}, 'weighted avg': {'precision': 0.3542548504693452, 'recall': 0.33882645342554574, 'f1-score': 0.3184093137151184, 'support': 18508}}
[[1922 3554  880]
 [1570 3312  837]
 [1743 3653 1037]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
2006/2006 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0834613
{'0': {'precision': 0.4255283878988811, 'recall': 0.40545830959378576, 'f1-score': 0.4152509814230128, 'support': 177271}, '1': {'precision': 0.32242758284381506, 'recall': 0.6037691642235786, 'f1-score': 0.42036820542206843, 'support': 166456}, '2': {'precision': 0.49101302194778995, 'recall': 0.09471220179483249, 'f1-score': 0.15879433745897426, 'support': 169598}, 'accuracy': 0.36709686845565676, 'macro avg': {'precision': 0.41298966423016203, 'recall': 0.36797989187073227, 'f1-score': 0.3314711747680185, 'support': 513325}, 'weighted avg': {'precision': 0.4137314081281331, 'recall': 0.36709686845565676, 'f1-score': 0.3321793576660826, 'support': 513325}}
[[ 71876  97916   7479]
 [ 56783 100501   9172]
 [ 40251 113284  16063]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0830895
{'0': {'precision': 0.43591240194247294, 'recall': 0.38449341021416805, 'f1-score': 0.4085915616246499, 'support': 48560}, '1': {'precision': 0.3191344045436572, 'recall': 0.6063517359134889, 'f1-score': 0.4181752523904476, 'support': 43925}, '2': {'precision': 0.46674373110439266, 'recall': 0.1165149833518313, 'f1-score': 0.18647861304533178, 'support': 45050}, 'accuracy': 0.36757189079143493, 'macro avg': {'precision': 0.4072635125301743, 'recall': 0.36912004315982944, 'f1-score': 0.3377484756868097, 'support': 137535}, 'weighted avg': {'precision': 0.40871552727785304, 'recall': 0.36757189079143493, 'f1-score': 0.33889857644552734, 'support': 137535}}
[[18671 27202  2687]
 [13981 26634  3310]
 [10180 29621  5249]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0873413
{'0': {'precision': 0.42170199304017714, 'recall': 0.39967018964095646, 'f1-score': 0.4103906099672888, 'support': 13341}, '1': {'precision': 0.30384483055221057, 'recall': 0.593897108271688, 'f1-score': 0.402014339364971, 'support': 11896}, '2': {'precision': 0.49080532656943565, 'recall': 0.11206834141750525, 'f1-score': 0.18247185713443748, 'support': 13813}, 'accuracy': 0.35710627400768247, 'macro avg': {'precision': 0.4054507167206078, 'recall': 0.3685452131100499, 'f1-score': 0.33162560215556575, 'support': 39050}, 'weighted avg': {'precision': 0.41024221176188774, 'recall': 0.35710627400768247, 'f1-score': 0.32721811706164605, 'support': 39050}}
[[5332 7331  678]
 [3903 7065  928]
 [3409 8856 1548]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
930/930 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945526
{'0': {'precision': 0.35516359373334755, 'recall': 0.34533231434825973, 'f1-score': 0.35017896430565126, 'support': 77201}, '1': {'precision': 0.3568322743627038, 'recall': 0.5625445022386889, 'f1-score': 0.4366741455143308, 'support': 82861}, '2': {'precision': 0.3774111517707623, 'recall': 0.15627006343254835, 'f1-score': 0.22102357342631945, 'support': 77878}, 'accuracy': 0.359094729763806, 'macro avg': {'precision': 0.3631356732889379, 'recall': 0.35471562667316564, 'f1-score': 0.33595889441543386, 'support': 237940}, 'weighted avg': {'precision': 0.3630263485054198, 'recall': 0.359094729763806, 'f1-score': 0.338027639094387, 'support': 237940}}
[[26660 40817  9724]
 [25896 46613 10352]
 [22508 43200 12170]]
Evaluating performance on  train set...
381/381 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976986
{'0': {'precision': 0.35884939538292415, 'recall': 0.302738963769012, 'f1-score': 0.3284147691069452, 'support': 32348}, '1': {'precision': 0.3325537802374364, 'recall': 0.5799321316272843, 'f1-score': 0.42271035672143054, 'support': 32121}, '2': {'precision': 0.3824129440731622, 'recall': 0.16447308704729055, 'f1-score': 0.23001734862268858, 'support': 33051}, 'accuracy': 0.3471800656275636, 'macro avg': {'precision': 0.3579387065645076, 'recall': 0.34904806081452894, 'f1-score': 0.3270474914836881, 'support': 97520}, 'weighted avg': {'precision': 0.3581742250965505, 'recall': 0.3471800656275636, 'f1-score': 0.3261253456588291, 'support': 97520}}
[[ 9793 18032  4523]
 [ 9237 18628  4256]
 [ 8260 19355  5436]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992278
{'0': {'precision': 0.35664863504843375, 'recall': 0.2981072555205047, 'f1-score': 0.3247608683200641, 'support': 9510}, '1': {'precision': 0.33051248668481475, 'recall': 0.5911929713136446, 'f1-score': 0.42398937179730495, 'support': 9447}, '2': {'precision': 0.39030732860520095, 'recall': 0.16314229249011858, 'f1-score': 0.23010452961672476, 'support': 10120}, 'accuracy': 0.34635622657082915, 'macro avg': {'precision': 0.3591561501128165, 'recall': 0.3508141731080892, 'f1-score': 0.326284923244698, 'support': 29077}, 'weighted avg': {'precision': 0.3598717249546612, 'recall': 0.34635622657082915, 'f1-score': 0.32405548346852164, 'support': 29077}}
[[2835 5360 1315]
 [2598 5585 1264]
 [2516 5953 1651]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990055
{'0': {'precision': 0.3123612960497115, 'recall': 0.3082379278040709, 'f1-score': 0.3102859137421081, 'support': 82193}, '1': {'precision': 0.34892740743034534, 'recall': 0.4776954627833773, 'f1-score': 0.40328194482968427, 'support': 94353}, '2': {'precision': 0.3885859511975422, 'recall': 0.2518977310643977, 'f1-score': 0.3056562474299848, 'support': 95904}, 'accuracy': 0.3470912093962195, 'macro avg': {'precision': 0.3499582182258663, 'recall': 0.34594370721728196, 'f1-score': 0.33974136866725907, 'support': 272450}, 'weighted avg': {'precision': 0.35185614513906555, 'recall': 0.3470912093962195, 'f1-score': 0.3408619864277686, 'support': 272450}}
[[25335 39607 17251]
 [28521 45072 20760]
 [27252 44494 24158]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989527
{'0': {'precision': 0.35895292859053224, 'recall': 0.30315094019989836, 'f1-score': 0.328700443900199, 'support': 35418}, '1': {'precision': 0.33511238838140206, 'recall': 0.48216078917833305, 'f1-score': 0.395407699853463, 'support': 33858}, '2': {'precision': 0.3557175588419079, 'recall': 0.2559959227725147, 'f1-score': 0.2977284217499695, 'support': 33356}, 'accuracy': 0.3468801153636293, 'macro avg': {'precision': 0.3499276252712808, 'recall': 0.34710255071691537, 'f1-score': 0.3406121885012105, 'support': 102632}, 'weighted avg': {'precision': 0.35003648923695985, 'recall': 0.3468801153636293, 'f1-score': 0.3406408864641416, 'support': 102632}}
[[10737 16851  7830]
 [ 9897 16325  7636]
 [ 9278 15539  8539]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992852
{'0': {'precision': 0.32201867816091956, 'recall': 0.37995337995337997, 'f1-score': 0.3485953144745796, 'support': 9438}, '1': {'precision': 0.34724175652445693, 'recall': 0.41649484536082476, 'f1-score': 0.3787284813362877, 'support': 10670}, '2': {'precision': 0.3978783402712502, 'recall': 0.26284041515124634, 'f1-score': 0.3165598290598291, 'support': 11273}, 'accuracy': 0.3503075109142475, 'macro avg': {'precision': 0.35571292498554224, 'recall': 0.35309621348848363, 'f1-score': 0.34796120829023214, 'support': 31381}, 'weighted avg': {'precision': 0.35784596910476135, 'recall': 0.3503075109142475, 'f1-score': 0.3473329220503083, 'support': 31381}}
[[3586 3913 1939]
 [3681 4444 2545]
 [3869 4441 2963]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
1646/1646 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0868201
{'0': {'precision': 0.2873960445033282, 'recall': 0.3236414948499937, 'f1-score': 0.3044437680718308, 'support': 111262}, '1': {'precision': 0.446968221651766, 'recall': 0.5439434662472598, 'f1-score': 0.4907106188304637, 'support': 185659}, '2': {'precision': 0.33693572795020416, 'recall': 0.18978119798325815, 'f1-score': 0.24280239705768886, 'support': 124359}, 'accuracy': 0.38121439422711734, 'macro avg': {'precision': 0.35709999803509945, 'recall': 0.35245538636017054, 'f1-score': 0.34598559465332784, 'support': 421280}, 'weighted avg': {'precision': 0.37234362409640603, 'recall': 0.38121439422711734, 'f1-score': 0.36833585406463687, 'support': 421280}}
[[ 36009  57394  17859]
 [ 56085 100988  28586]
 [ 33200  67558  23601]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984097
{'0': {'precision': 0.3601857783472133, 'recall': 0.2972508591065292, 'f1-score': 0.32570601013758144, 'support': 45396}, '1': {'precision': 0.3364143293990674, 'recall': 0.5499434517077584, 'f1-score': 0.41745864132347765, 'support': 44210}, '2': {'precision': 0.3634572072072072, 'recall': 0.20085346609472585, 'f1-score': 0.2587285454571482, 'support': 44993}, 'accuracy': 0.34802635977979035, 'macro avg': {'precision': 0.35335243831782925, 'recall': 0.3493492589696712, 'f1-score': 0.3339643989727357, 'support': 134599}, 'weighted avg': {'precision': 0.35347143158906635, 'recall': 0.34802635977979035, 'f1-score': 0.3334539633642899, 'support': 134599}}
[[13494 23632  8270]
 [12340 24313  7557]
 [11630 24326  9037]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0958861
{'0': {'precision': 0.3319777821860742, 'recall': 0.2852151682999574, 'f1-score': 0.3068249530182885, 'support': 11735}, '1': {'precision': 0.3590699060962886, 'recall': 0.5470027247956403, 'f1-score': 0.43354629712948795, 'support': 13212}, '2': {'precision': 0.35739313244569026, 'recall': 0.20569492619182062, 'f1-score': 0.2611099733770223, 'support': 12397}, 'accuracy': 0.35143530419880037, 'macro avg': {'precision': 0.3494802735760177, 'recall': 0.3459709397624728, 'f1-score': 0.33382707450826626, 'support': 37344}, 'weighted avg': {'precision': 0.34999982691267584, 'recall': 0.35143530419880037, 'f1-score': 0.3364820276697557, 'support': 37344}}
[[3347 6153 2235]
 [3635 7227 2350]
 [3100 6747 2550]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/EXC
Evaluating performance on  test set...
5928/5928 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0650057
{'0': {'precision': 0.45509661023709536, 'recall': 0.466167827188308, 'f1-score': 0.46056569500908223, 'support': 513993}, '1': {'precision': 0.34595758721324305, 'recall': 0.5170155917328267, 'f1-score': 0.4145330840663214, 'support': 523226}, '2': {'precision': 0.46945303796076254, 'recall': 0.2043930558822856, 'f1-score': 0.2847918594431214, 'support': 480349}, 'accuracy': 0.4008406872047908, 'macro avg': {'precision': 0.42350241180370035, 'recall': 0.39585882493447344, 'f1-score': 0.3866302128395083, 'support': 1517568}, 'weighted avg': {'precision': 0.42201191237838825, 'recall': 0.4008406872047908, 'f1-score': 0.3890576999581779, 'support': 1517568}}
[[239607 234949  39437]
 [181190 270516  71520]
 [105700 276469  98180]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0786645
{'0': {'precision': 0.42807037829296024, 'recall': 0.4206808389754273, 'f1-score': 0.4243434406147468, 'support': 105605}, '1': {'precision': 0.33265836915987745, 'recall': 0.529328949108982, 'f1-score': 0.40855753032037867, 'support': 105834}, '2': {'precision': 0.46152111521115213, 'recall': 0.2055474905731007, 'f1-score': 0.2844220407183511, 'support': 109527}, 'accuracy': 0.38309353638703164, 'macro avg': {'precision': 0.4074166208879966, 'recall': 0.3851857595525033, 'f1-score': 0.37244100388449225, 'support': 320966}, 'weighted avg': {'precision': 0.40802440547293606, 'recall': 0.38309353638703164, 'f1-score': 0.3713912363421862, 'support': 320966}}
[[44426 50940 10239]
 [33785 56021 16028]
 [25571 61443 22513]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0795623
{'0': {'precision': 0.4150964126792287, 'recall': 0.4244943820224719, 'f1-score': 0.4197427992111768, 'support': 35600}, '1': {'precision': 0.33979373487213665, 'recall': 0.5215506797684749, 'f1-score': 0.4114954491870135, 'support': 37145}, '2': {'precision': 0.4569691596479007, 'recall': 0.1978829594690945, 'f1-score': 0.27617352699159925, 'support': 36466}, 'accuracy': 0.38183882575930994, 'macro avg': {'precision': 0.40395310239975535, 'recall': 0.3813093404200138, 'f1-score': 0.36913725846326323, 'support': 109211}, 'weighted avg': {'precision': 0.40346584088531745, 'recall': 0.38183882575930994, 'f1-score': 0.36899933108611005, 'support': 109211}}
[[15112 17162  3326]
 [12523 19373  5249]
 [ 8771 20479  7216]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/AAL
Evaluating performance on  test set...
5331/5331 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0822722
{'0': {'precision': 0.37229250978124956, 'recall': 0.39440511629894454, 'f1-score': 0.3830299341559232, 'support': 421242}, '1': {'precision': 0.37612901257170755, 'recall': 0.5737714774466204, 'f1-score': 0.45438885761527104, 'support': 515599}, '2': {'precision': 0.4162475058985972, 'recall': 0.12826351224985974, 'f1-score': 0.19610022678087322, 'support': 427760}, 'accuracy': 0.37874953924260646, 'macro avg': {'precision': 0.3882230094171848, 'recall': 0.3654800353318082, 'f1-score': 0.34450633951735576, 'support': 1364601}, 'weighted avg': {'precision': 0.38752061392408244, 'recall': 0.37874953924260646, 'f1-score': 0.3513954402269028, 'support': 1364601}}
[[166140 225990  29112]
 [171930 295836  47833]
 [108192 264702  54866]]
Evaluating performance on  train set...
2013/2013 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903796
{'0': {'precision': 0.4196209487782435, 'recall': 0.3680605765081073, 'f1-score': 0.3921532329098428, 'support': 178419}, '1': {'precision': 0.3197315698602469, 'recall': 0.5978291325057561, 'f1-score': 0.41663695175997145, 'support': 164174}, '2': {'precision': 0.4209937504822159, 'recall': 0.12636856823590034, 'f1-score': 0.19438816179122823, 'support': 172717}, 'accuracy': 0.3602549921406532, 'macro avg': {'precision': 0.3867820897069021, 'recall': 0.3640860924165879, 'f1-score': 0.3343927821536808, 'support': 515310}, 'weighted avg': {'precision': 0.38825704607389433, 'recall': 0.3602549921406532, 'f1-score': 0.33366843787405315, 'support': 515310}}
[[ 65669  98653  14097]
 [ 50105  98148  15921]
 [ 40722 110169  21826]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0870168
{'0': {'precision': 0.40686815757462336, 'recall': 0.3682106867643323, 'f1-score': 0.3865753911806543, 'support': 59045}, '1': {'precision': 0.33741068654861756, 'recall': 0.5810388351137636, 'f1-score': 0.4269123291877783, 'support': 59817}, '2': {'precision': 0.42804616959880853, 'recall': 0.15570453891343727, 'f1-score': 0.2283465544424168, 'support': 59067}, 'accuracy': 0.36921468675707725, 'macro avg': {'precision': 0.3907750045740164, 'recall': 0.36831802026384436, 'f1-score': 0.34727809160361645, 'support': 177929}, 'weighted avg': {'precision': 0.3905480753613245, 'recall': 0.36921468675707725, 'f1-score': 0.34760890410521783, 'support': 177929}}
[[21741 32042  5262]
 [18034 34756  7027]
 [13660 36210  9197]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/WBA
Evaluating performance on  test set...
4192/4192 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0882896
{'0': {'precision': 0.3757212874068418, 'recall': 0.35743920624843123, 'f1-score': 0.3663523059508605, 'support': 338645}, '1': {'precision': 0.35604289361271896, 'recall': 0.5907850554013353, 'f1-score': 0.4443147687967534, 'support': 381489}, '2': {'precision': 0.4074595236076969, 'recall': 0.1361657285467025, 'f1-score': 0.20411863748219142, 'support': 353011}, 'accuracy': 0.3676027004738409, 'macro avg': {'precision': 0.37974123487575256, 'recall': 0.3614633300654897, 'f1-score': 0.3382619040766018, 'support': 1073145}, 'weighted avg': {'precision': 0.379166167389858, 'recall': 0.3676027004738409, 'f1-score': 0.3407001829374965, 'support': 1073145}}
[[121045 188849  28751]
 [114960 225378  41151]
 [ 86162 218781  48068]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937278
{'0': {'precision': 0.4011554742020364, 'recall': 0.3246999777761316, 'f1-score': 0.35890113714291566, 'support': 107992}, '1': {'precision': 0.32495544799805975, 'recall': 0.608979616034464, 'f1-score': 0.4237794501380328, 'support': 101207}, '2': {'precision': 0.4072398190045249, 'recall': 0.14564484990725668, 'f1-score': 0.21455607525495088, 'support': 105668}, 'accuracy': 0.35598522550791284, 'macro avg': {'precision': 0.3777835804015403, 'recall': 0.35977481457261745, 'f1-score': 0.3324122208452998, 'support': 314867}, 'weighted avg': {'precision': 0.3787045488734484, 'recall': 0.35598522550791284, 'f1-score': 0.33131325217472074, 'support': 314867}}
[[35065 62142 10785]
 [27958 61633 11616]
 [24387 65891 15390]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935272
{'0': {'precision': 0.3844042909583378, 'recall': 0.31553696281777494, 'f1-score': 0.3465826933581826, 'support': 34183}, '1': {'precision': 0.33104722992363445, 'recall': 0.6044762863402214, 'f1-score': 0.42780367712534706, 'support': 33778}, '2': {'precision': 0.4020305380126309, 'recall': 0.14668650099171626, 'f1-score': 0.21494668005898315, 'support': 34284}, 'accuracy': 0.3543742970316397, 'macro avg': {'precision': 0.37249401963153445, 'recall': 0.35556658338323754, 'f1-score': 0.32977768351417097, 'support': 102245}, 'weighted avg': {'precision': 0.3726873702911088, 'recall': 0.3543742970316397, 'f1-score': 0.32927596256193364, 'support': 102245}}
[[10786 19878  3519]
 [ 9399 20418  3961]
 [ 7874 21381  5029]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
6143/6143 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0839205
{'0': {'precision': 0.37903532832062853, 'recall': 0.36137285594375596, 'f1-score': 0.36999342257376905, 'support': 484887}, '1': {'precision': 0.3727976056019878, 'recall': 0.5895441516666466, 'f1-score': 0.4567621564334343, 'support': 582277}, '2': {'precision': 0.40254713842937023, 'recall': 0.1508668541338088, 'f1-score': 0.21947771914521205, 'support': 505333}, 'accuracy': 0.3782143940497184, 'macro avg': {'precision': 0.3847933574506622, 'recall': 0.36726128724807044, 'f1-score': 0.3487444327174718, 'support': 1572497}, 'weighted avg': {'precision': 0.3842812595155617, 'recall': 0.3782143940497184, 'f1-score': 0.35375357352155545, 'support': 1572497}}
[[175225 265067  44595]
 [170443 343278  68556]
 [116624 312471  76238]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093657
{'0': {'precision': 0.394285391688484, 'recall': 0.31435949948237835, 'f1-score': 0.34981514699022986, 'support': 177736}, '1': {'precision': 0.3321489215483847, 'recall': 0.6148492541144928, 'f1-score': 0.4313028724179052, 'support': 175295}, '2': {'precision': 0.4047839321952966, 'recall': 0.15055082276549103, 'f1-score': 0.21947322219570312, 'support': 180185}, 'accuracy': 0.35779121406709474, 'macro avg': {'precision': 0.3770727484773884, 'recall': 0.3599198587874541, 'f1-score': 0.3335304138679461, 'support': 533216}, 'weighted avg': {'precision': 0.3774056787541597, 'recall': 0.35779121406709474, 'f1-score': 0.332558971462381, 'support': 533216}}
[[ 55873 103418  18445]
 [ 46071 107780  21444]
 [ 39763 113295  27127]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920831
{'0': {'precision': 0.3815987933634992, 'recall': 0.32146260544241695, 'f1-score': 0.34895883220627955, 'support': 56666}, '1': {'precision': 0.3438802629738425, 'recall': 0.6186106591065408, 'f1-score': 0.44203636886709907, 'support': 59611}, '2': {'precision': 0.4060984060984061, 'recall': 0.13929638685139908, 'f1-score': 0.20743887329641708, 'support': 58896}, 'accuracy': 0.36133422388153424, 'macro avg': {'precision': 0.3771924874785826, 'recall': 0.35978988380011895, 'f1-score': 0.33281135812326523, 'support': 175173}, 'weighted avg': {'precision': 0.37700042418889607, 'recall': 0.36133422388153424, 'f1-score': 0.3330516178406687, 'support': 175173}}
[[18216 32934  5516]
 [16253 36876  6482]
 [13267 37425  8204]]
testing model on single stock: results/universal/W7/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
23942/23942 - 182s - 182s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857457
{'0': {'precision': 0.318117942547646, 'recall': 0.26453532127701035, 'f1-score': 0.28886281897203336, 'support': 1714066}, '1': {'precision': 0.44606350215791535, 'recall': 0.6063582349585742, 'f1-score': 0.5140035943935957, 'support': 2713772}, '2': {'precision': 0.29557112405602687, 'recall': 0.17629925800351628, 'f1-score': 0.22086137142537338, 'support': 1701221}, 'accuracy': 0.3913933607100209, 'macro avg': {'precision': 0.35325085625386277, 'recall': 0.34906427141303364, 'f1-score': 0.34124259493033415, 'support': 6129059}, 'weighted avg': {'precision': 0.3685103365666217, 'recall': 0.3913933607100209, 'f1-score': 0.3696737953063365, 'support': 6129059}}
[[ 453431  989543  271092]
 [ 624543 1645518  443711]
 [ 347381 1053916  299924]]
Evaluating performance on  train set...
9052/9052 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989188
{'0': {'precision': 0.3803039955016353, 'recall': 0.27124847860271317, 'f1-score': 0.31664949266950587, 'support': 787927}, '1': {'precision': 0.324272032782297, 'recall': 0.6028173598891093, 'f1-score': 0.4217000264115479, 'support': 749567}, '2': {'precision': 0.36521217383129506, 'recall': 0.1694275408422954, 'f1-score': 0.23147176986536636, 'support': 779584}, 'accuracy': 0.3442521140850675, 'macro avg': {'precision': 0.3565960673717425, 'recall': 0.347831126444706, 'f1-score': 0.32327376298214006, 'support': 2317078}, 'weighted avg': {'precision': 0.35710017892545753, 'recall': 0.3442521140850675, 'f1-score': 0.3219748306904439, 'support': 2317078}}
[[213724 460670 113533]
 [181670 451852 116045]
 [166588 480913 132083]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982867
{'0': {'precision': 0.35943252740336706, 'recall': 0.3012201232429962, 'f1-score': 0.32776167656652033, 'support': 227518}, '1': {'precision': 0.3467761829048181, 'recall': 0.584364324813763, 'f1-score': 0.4352589717768203, 'support': 242970}, '2': {'precision': 0.3584187599690319, 'recall': 0.16224992188357698, 'f1-score': 0.2233797339208739, 'support': 236826}, 'accuracy': 0.3519525981388747, 'macro avg': {'precision': 0.354875823425739, 'recall': 0.3492781233134454, 'f1-score': 0.3288001274214048, 'support': 707314}, 'weighted avg': {'precision': 0.35474550225015883, 'recall': 0.3519525981388747, 'f1-score': 0.3297385353141893, 'support': 707314}}
[[ 68533 126605  32380]
 [ 64585 141983  36402]
 [ 57552 140849  38425]]
training model: results/universal/W7/deepVOL_L2/h50
Epoch 1/50
12475/12475 - 411s - loss: 3.1890 - accuracy50: 0.4106 - val_loss: 3.2666 - val_accuracy50: 0.3898 - 411s/epoch - 33ms/step
Epoch 2/50
12475/12475 - 386s - loss: 3.1478 - accuracy50: 0.4294 - val_loss: 3.3285 - val_accuracy50: 0.3937 - 386s/epoch - 31ms/step
Epoch 3/50
12475/12475 - 385s - loss: 3.1278 - accuracy50: 0.4380 - val_loss: 3.3280 - val_accuracy50: 0.3969 - 385s/epoch - 31ms/step
Epoch 4/50
12475/12475 - 389s - loss: 3.1154 - accuracy50: 0.4427 - val_loss: 3.3077 - val_accuracy50: 0.4031 - 389s/epoch - 31ms/step
Epoch 5/50
12475/12475 - 382s - loss: 3.1075 - accuracy50: 0.4456 - val_loss: 3.2998 - val_accuracy50: 0.4074 - 382s/epoch - 31ms/step
Epoch 6/50
12475/12475 - 382s - loss: 3.1005 - accuracy50: 0.4481 - val_loss: 3.2922 - val_accuracy50: 0.4090 - 382s/epoch - 31ms/step
Epoch 7/50
12475/12475 - 379s - loss: 3.0953 - accuracy50: 0.4500 - val_loss: 3.2919 - val_accuracy50: 0.4089 - 379s/epoch - 30ms/step
Epoch 8/50
12475/12475 - 388s - loss: 3.0903 - accuracy50: 0.4518 - val_loss: 3.2616 - val_accuracy50: 0.4118 - 388s/epoch - 31ms/step
Epoch 9/50
12475/12475 - 387s - loss: 3.0865 - accuracy50: 0.4531 - val_loss: 3.2865 - val_accuracy50: 0.4115 - 387s/epoch - 31ms/step
Epoch 10/50
12475/12475 - 386s - loss: 3.0833 - accuracy50: 0.4540 - val_loss: 3.2799 - val_accuracy50: 0.4123 - 386s/epoch - 31ms/step
Epoch 11/50
12475/12475 - 392s - loss: 3.0805 - accuracy50: 0.4551 - val_loss: 3.2810 - val_accuracy50: 0.4124 - 392s/epoch - 31ms/step
Epoch 12/50
12475/12475 - 391s - loss: 3.0777 - accuracy50: 0.4559 - val_loss: 3.2863 - val_accuracy50: 0.4121 - 391s/epoch - 31ms/step
Epoch 13/50
12475/12475 - 390s - loss: 3.0756 - accuracy50: 0.4566 - val_loss: 3.2807 - val_accuracy50: 0.4121 - 390s/epoch - 31ms/step
Epoch 14/50
12475/12475 - 394s - loss: 3.0734 - accuracy50: 0.4574 - val_loss: 3.2774 - val_accuracy50: 0.4128 - 394s/epoch - 32ms/step
Epoch 15/50
12475/12475 - 383s - loss: 3.0713 - accuracy50: 0.4580 - val_loss: 3.2945 - val_accuracy50: 0.4126 - 383s/epoch - 31ms/step
Epoch 16/50
12475/12475 - 385s - loss: 3.0699 - accuracy50: 0.4586 - val_loss: 3.2889 - val_accuracy50: 0.4131 - 385s/epoch - 31ms/step
Epoch 17/50
12475/12475 - 380s - loss: 3.0684 - accuracy50: 0.4589 - val_loss: 3.2750 - val_accuracy50: 0.4132 - 380s/epoch - 30ms/step
Epoch 18/50
12475/12475 - 385s - loss: 3.0663 - accuracy50: 0.4597 - val_loss: 3.2838 - val_accuracy50: 0.4129 - 385s/epoch - 31ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 574s - 574s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1007401
{'0': {'precision': 0.3615356768885565, 'recall': 0.4871633307129467, 'f1-score': 0.4150515623255854, 'support': 2480550}, '1': {'precision': 0.5827825814486984, 'recall': 0.2928263597640927, 'f1-score': 0.38979524723256737, 'support': 4547719}, '2': {'precision': 0.3433878784346833, 'recall': 0.537545467792999, 'f1-score': 0.4190705200071059, 'support': 2477303}, 'accuracy': 0.4073177290119942, 'macro avg': {'precision': 0.4292353789239794, 'recall': 0.43917838609001275, 'f1-score': 0.4079724431884195, 'support': 9505572}, 'weighted avg': {'precision': 0.4626564885562993, 'recall': 0.4073177290119942, 'f1-score': 0.4040156722079574, 'support': 9505572}}
[[1208433  425887  846230]
 [1515906 1331692 1700121]
 [ 618161  527479 1331663]]
Evaluating performance on  train set...
12475/12475 - 197s - 197s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0932312
{'0': {'precision': 0.4116955829210168, 'recall': 0.42393874836393297, 'f1-score': 0.41772747623261536, 'support': 1032201}, '1': {'precision': 0.49151254562846514, 'recall': 0.2688199229425989, 'f1-score': 0.3475541821579209, 'support': 1143044}, '2': {'precision': 0.38558127451364727, 'recall': 0.5701402677633692, 'f1-score': 0.4600407155665695, 'support': 1017839}, 'accuracy': 0.4150138236263124, 'macro avg': {'precision': 0.42959646768770976, 'recall': 0.4209663130233004, 'f1-score': 0.40844079131903527, 'support': 3193084}, 'weighted avg': {'precision': 0.43194376266383716, 'recall': 0.4150138236263124, 'f1-score': 0.40609511781614943, 'support': 3193084}}
[[437590 149963 444648]
 [355701 307273 480070]
 [269606 167922 580311]]
Evaluating performance on  val set...
3866/3866 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.095249
{'0': {'precision': 0.39845969187851144, 'recall': 0.43444107578185426, 'f1-score': 0.41567318440987466, 'support': 306419}, '1': {'precision': 0.502289735863539, 'recall': 0.26095133399076365, 'f1-score': 0.3434646844894753, 'support': 371142}, '2': {'precision': 0.3840656202952221, 'recall': 0.5697324806427909, 'f1-score': 0.458828044143128, 'support': 311641}, 'accuracy': 0.41197146791049755, 'macro avg': {'precision': 0.4282716826790909, 'recall': 0.4217082968051362, 'f1-score': 0.405988637680826, 'support': 989202}, 'weighted avg': {'precision': 0.4328812835477592, 'recall': 0.41197146791049755, 'f1-score': 0.4021766655640514, 'support': 989202}}
[[133121  44294 129004]
 [118552  96850 155740]
 [ 82416  51673 177552]]
testing model out of sample: results/universal/W7/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 239s - 239s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9946833
{'0': {'precision': 0.43666846993884156, 'recall': 0.46518499561418075, 'f1-score': 0.4504758877846955, 'support': 1023754}, '1': {'precision': 0.5789898287304157, 'recall': 0.5942321983416912, 'f1-score': 0.5865119999537963, 'support': 1708970}, '2': {'precision': 0.45991253017128253, 'recall': 0.4105246280020508, 'f1-score': 0.4338174642228456, 'support': 1041538}, 'accuracy': 0.5085330589132392, 'macro avg': {'precision': 0.4918569429468466, 'recall': 0.48998060731930754, 'f1-score': 0.49026845065377916, 'support': 3774262}, 'weighted avg': {'precision': 0.5075253697885109, 'recall': 0.5085330589132392, 'f1-score': 0.5074754425198639, 'support': 3774262}}
[[ 476235  330579  216940]
 [ 408270 1015525  285175]
 [ 206105  407856  427577]]
Evaluating performance on  train set...
5285/5285 - 85s - 85s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0185277
{'0': {'precision': 0.45142535633908476, 'recall': 0.4341366039373015, 'f1-score': 0.44261221670151796, 'support': 410281}, '1': {'precision': 0.5351010404624278, 'recall': 0.5392313657070854, 'f1-score': 0.5371582634626579, 'support': 536484}, '2': {'precision': 0.4504650822966897, 'recall': 0.4633082110273701, 'f1-score': 0.45679639125798277, 'support': 405881}, 'accuracy': 0.48457246020022976, 'macro avg': {'precision': 0.47899715969940077, 'recall': 0.478892060223919, 'f1-score': 0.4788556238073862, 'support': 1352646}, 'weighted avg': {'precision': 0.48432451009596283, 'recall': 0.48457246020022976, 'f1-score': 0.48436706483159475, 'support': 1352646}}
[[178118 119706 112457]
 [130247 289289 116948]
 [ 86203 131630 188048]]
Evaluating performance on  val set...
1714/1714 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.005869
{'0': {'precision': 0.4425544455695437, 'recall': 0.4565546166079391, 'f1-score': 0.4494455316373124, 'support': 128276}, '1': {'precision': 0.5515378583253463, 'recall': 0.5603381503529776, 'f1-score': 0.555903178000988, 'support': 180748}, '2': {'precision': 0.46484746207032146, 'recall': 0.4398341213859391, 'f1-score': 0.4519949975704762, 'support': 129010}, 'accuracy': 0.4944547683513152, 'macro avg': {'precision': 0.48631325532173714, 'recall': 0.48557562944895194, 'f1-score': 0.4857812357362588, 'support': 438034}, 'weighted avg': {'precision': 0.4940905271238321, 'recall': 0.4944547683513152, 'f1-score': 0.4941245137824863, 'support': 438034}}
[[ 58565  37920  31791]
 [ 45934 101280  33534]
 [ 27835  44432  56743]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1046681
{'0': {'precision': 0.39108820113689613, 'recall': 0.3554497981556239, 'f1-score': 0.37241834250070327, 'support': 54002}, '1': {'precision': 0.5292634872805239, 'recall': 0.26713170132491004, 'f1-score': 0.35505753382055666, 'support': 68382}, '2': {'precision': 0.37784774565616086, 'recall': 0.6417356859920778, 'f1-score': 0.47564206073304016, 'support': 55540}, 'accuracy': 0.410872057732515, 'macro avg': {'precision': 0.43273314469119367, 'recall': 0.4214390618242039, 'f1-score': 0.40103931235143336, 'support': 177924}, 'weighted avg': {'precision': 0.440060388810698, 'recall': 0.410872057732515, 'f1-score': 0.3979678945086291, 'support': 177924}}
[[19195  7729 27078]
 [18506 18267 31609]
 [11380  8518 35642]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1289904
{'0': {'precision': 0.4247256691621372, 'recall': 0.33614707195324867, 'f1-score': 0.3752803388985796, 'support': 24641}, '1': {'precision': 0.4269676340618655, 'recall': 0.1499517637682983, 'f1-score': 0.22195318805488295, 'support': 23841}, '2': {'precision': 0.3715464291380522, 'recall': 0.6971591392361998, 'f1-score': 0.4847490204775635, 'support': 23514}, 'accuracy': 0.39239679982221237, 'macro avg': {'precision': 0.4077465774540183, 'recall': 0.3944193249859156, 'f1-score': 0.36066084914367535, 'support': 71996}, 'weighted avg': {'precision': 0.40809966265133224, 'recall': 0.39239679982221237, 'f1-score': 0.36025969852110945, 'support': 71996}}
[[ 8283  2518 13840]
 [ 6378  3575 13888]
 [ 4841  2280 16393]]
Evaluating performance on  val set...
73/73 - 1s - 717ms/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1117492
{'0': {'precision': 0.41102831594634875, 'recall': 0.43323908262645305, 'f1-score': 0.42184154175588867, 'support': 6366}, '1': {'precision': 0.44352844187963725, 'recall': 0.1912888888888889, 'f1-score': 0.2672959880760154, 'support': 5625}, '2': {'precision': 0.3984208279982928, 'recall': 0.5729630197943839, 'f1-score': 0.47001069922587957, 'support': 6517}, 'accuracy': 0.4089042576183272, 'macro avg': {'precision': 0.41765919527475964, 'recall': 0.3991636637699087, 'f1-score': 0.3863827430192612, 'support': 18508}, 'weighted avg': {'precision': 0.41646651615259833, 'recall': 0.4089042576183272, 'f1-score': 0.3918328784634013, 'support': 18508}}
[[2758  648 2960]
 [1871 1076 2678]
 [2081  702 3734]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86394364
{'0': {'precision': 0.43396332282831307, 'recall': 0.4211973786918874, 'f1-score': 0.42748506496796507, 'support': 110174}, '1': {'precision': 0.6578386049714053, 'recall': 0.7891858724529014, 'f1-score': 0.7175510041428653, 'support': 296612}, '2': {'precision': 0.5933705154068273, 'recall': 0.281592581468689, 'f1-score': 0.3819332170636386, 'support': 106544}, 'accuracy': 0.6048526289131747, 'macro avg': {'precision': 0.5617241477355153, 'recall': 0.4973252775378259, 'f1-score': 0.5089897620581563, 'support': 513330}, 'weighted avg': {'precision': 0.5964084850302341, 'recall': 0.6048526289131747, 'f1-score': 0.5856362781591422, 'support': 513330}}
[[ 46405  54986   8783]
 [ 50753 234082  11777]
 [  9775  66767  30002]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8463452
{'0': {'precision': 0.4765600419507079, 'recall': 0.4486867224014219, 'f1-score': 0.46220353637242095, 'support': 30382}, '1': {'precision': 0.6670809788909663, 'recall': 0.8171628900802231, 'f1-score': 0.7345340371942173, 'support': 78157}, '2': {'precision': 0.6071563945114093, 'recall': 0.2761914614801021, 'f1-score': 0.379672426461874, 'support': 28998}, 'accuracy': 0.6217090673782327, 'macro avg': {'precision': 0.5835991384510278, 'recall': 0.5140136913205824, 'f1-score': 0.5254700000095042, 'support': 137537}, 'weighted avg': {'precision': 0.6123604294827538, 'recall': 0.6217090673782327, 'f1-score': 0.5995578325075925, 'support': 137537}}
[[13632 14131  2619]
 [11727 63867  2563]
 [ 3246 17743  8009]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8772471
{'0': {'precision': 0.48557103064066853, 'recall': 0.47811300054854633, 'f1-score': 0.4818131564400221, 'support': 9115}, '1': {'precision': 0.6373438627130871, 'recall': 0.8090900327742433, 'f1-score': 0.7130205789283667, 'support': 20748}, '2': {'precision': 0.6271413276231264, 'recall': 0.25503428758027646, 'f1-score': 0.36260930124584073, 'support': 9187}, 'accuracy': 0.6014852752880921, 'macro avg': {'precision': 0.5833520736589607, 'recall': 0.5140791069676888, 'f1-score': 0.5191476788714099, 'support': 39050}, 'weighted avg': {'precision': 0.5995169727204734, 'recall': 0.6014852752880921, 'f1-score': 0.5766138167247655, 'support': 39050}}
[[ 4358  3997   760]
 [ 3328 16787   633]
 [ 1289  5555  2343]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1696761
{'0': {'precision': 0.36844854605606825, 'recall': 0.38210862619808306, 'f1-score': 0.3751542799473573, 'support': 71990}, '1': {'precision': 0.3879987033134971, 'recall': 0.3697292645793341, 'f1-score': 0.37864373841912596, 'support': 90642}, '2': {'precision': 0.3985983981693364, 'recall': 0.4070611979339556, 'f1-score': 0.4027853506322877, 'support': 75313}, 'accuracy': 0.38529071844333773, 'macro avg': {'precision': 0.38501521584630055, 'recall': 0.3862996962371243, 'f1-score': 0.385527789666257, 'support': 237945}, 'weighted avg': {'precision': 0.38543877979216035, 'recall': 0.38529071844333773, 'f1-score': 0.38522917255401945, 'support': 237945}}
[[27508 25765 18717]
 [29591 33513 27538]
 [17560 27096 30657]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1398171
{'0': {'precision': 0.4095771457337025, 'recall': 0.40242356796191536, 'f1-score': 0.40596884599192307, 'support': 32349}, '1': {'precision': 0.367008235368077, 'recall': 0.3596156215350499, 'f1-score': 0.36327432251641206, 'support': 32468}, '2': {'precision': 0.41573563658874507, 'recall': 0.43123165362035226, 'f1-score': 0.42334188842361203, 'support': 32704}, 'accuracy': 0.39783226176925995, 'macro avg': {'precision': 0.39744033923017485, 'recall': 0.3977569477057725, 'f1-score': 0.39752835231064904, 'support': 97521}, 'weighted avg': {'precision': 0.3974698037578428, 'recall': 0.39783226176925995, 'f1-score': 0.3975805213385978, 'support': 97521}}
[[13018  9604  9727]
 [10699 11676 10093]
 [ 8067 10534 14103]]
Evaluating performance on  val set...
114/114 - 1s - 987ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1472107
{'0': {'precision': 0.40638339154055103, 'recall': 0.4383633319380494, 'f1-score': 0.4217680225533629, 'support': 9556}, '1': {'precision': 0.3617787066062928, 'recall': 0.32387485708346325, 'f1-score': 0.3417790940002194, 'support': 9621}, '2': {'precision': 0.41925955100433243, 'recall': 0.4301010101010101, 'f1-score': 0.4246110889509374, 'support': 9900}, 'accuracy': 0.39766826013687795, 'macro avg': {'precision': 0.3958072163837254, 'recall': 0.39744639970750756, 'f1-score': 0.39605273516817324, 'support': 29077}, 'weighted avg': {'precision': 0.39600860407757127, 'recall': 0.39766826013687795, 'f1-score': 0.3962692735670918, 'support': 29077}}
[[4189 2647 2720]
 [3327 3116 3178]
 [2792 2850 4258]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.176051
{'0': {'precision': 0.3507187615186141, 'recall': 0.02227711181869264, 'f1-score': 0.041893230599889926, 'support': 85424}, '1': {'precision': 0.33494721803317723, 'recall': 0.04429748596021624, 'f1-score': 0.07824668100571089, 'support': 95265}, '2': {'precision': 0.33599811343002006, 'recall': 0.9315868622365582, 'f1-score': 0.4938705242117182, 'support': 91766}, 'accuracy': 0.33624268227780735, 'macro avg': {'precision': 0.3405546976606038, 'recall': 0.33272048667182236, 'f1-score': 0.20467014527243965, 'support': 272455}, 'weighted avg': {'precision': 0.34024609233420544, 'recall': 0.33624268227780735, 'f1-score': 0.20683555053710365, 'support': 272455}}
[[ 1903  3977 79544]
 [ 1647  4220 89398]
 [ 1876  4402 85488]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1875741
{'0': {'precision': 0.3773809523809524, 'recall': 0.02675557056043214, 'f1-score': 0.04996847414880202, 'support': 35544}, '1': {'precision': 0.3568213296398892, 'recall': 0.06061229891480163, 'f1-score': 0.10362251439201589, 'support': 34003}, '2': {'precision': 0.32363042740841247, 'recall': 0.922774671301194, 'f1-score': 0.479198876166409, 'support': 33085}, 'accuracy': 0.3268181463870917, 'macro avg': {'precision': 0.3526109031430847, 'recall': 0.3367141802588092, 'f1-score': 0.21092995490240896, 'support': 102632}, 'weighted avg': {'precision': 0.35324203887657896, 'recall': 0.3268181463870917, 'f1-score': 0.20611359634404838, 'support': 102632}}
[[  951  1908 32685]
 [  821  2061 31121]
 [  748  1807 30530]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1807408
{'0': {'precision': 0.42704149933065594, 'recall': 0.032044198895027624, 'f1-score': 0.05961502522892917, 'support': 9955}, '1': {'precision': 0.3120567375886525, 'recall': 0.04956815621479534, 'f1-score': 0.08554763447828906, 'support': 10652}, '2': {'precision': 0.34465482689516963, 'recall': 0.9258399851494338, 'f1-score': 0.5023164467720818, 'support': 10774}, 'accuracy': 0.34485835378095026, 'macro avg': {'precision': 0.3612510212714927, 'recall': 0.3358174467530856, 'f1-score': 0.21582636882643333, 'support': 31381}, 'weighted avg': {'precision': 0.3597252350020574, 'recall': 0.34485835378095026, 'f1-score': 0.22040975036293087, 'support': 31381}}
[[ 319  568 9068]
 [ 225  528 9899]
 [ 203  596 9975]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
1646/1646 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1659489
{'0': {'precision': 0.3520440017838561, 'recall': 0.3883536540369462, 'f1-score': 0.3693085017212408, 'support': 121961}, '1': {'precision': 0.4381928396798285, 'recall': 0.23025752331788585, 'f1-score': 0.3018838902198449, 'support': 170470}, '2': {'precision': 0.36432889718412725, 'recall': 0.5574836636813758, 'f1-score': 0.44066964806056036, 'support': 128854}, 'accuracy': 0.37611118364052837, 'macro avg': {'precision': 0.3848552462159373, 'recall': 0.3920316136787359, 'f1-score': 0.3706206800005487, 'support': 421285}, 'weighted avg': {'precision': 0.39066097202498257, 'recall': 0.37611118364052837, 'f1-score': 0.36385209009434627, 'support': 421285}}
[[47364 24916 49681]
 [55565 39252 75653]
 [31611 25409 71834]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.150348
{'0': {'precision': 0.4032870691096725, 'recall': 0.3717192178967765, 'f1-score': 0.38686022663473774, 'support': 45416}, '1': {'precision': 0.3581479800272356, 'recall': 0.16000450653447498, 'f1-score': 0.22119083589016775, 'support': 44380}, '2': {'precision': 0.3808152293175335, 'recall': 0.619721453441657, 'f1-score': 0.4717455571035374, 'support': 44804}, 'accuracy': 0.38446508172362553, 'macro avg': {'precision': 0.38075009281814715, 'recall': 0.3838150592909695, 'f1-score': 0.35993220654281427, 'support': 134600}, 'weighted avg': {'precision': 0.38092376239700126, 'recall': 0.38446508172362553, 'f1-score': 0.36049168863384684, 'support': 134600}}
[[16882  6402 22132]
 [14265  7101 23014]
 [10714  6324 27766]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1443582
{'0': {'precision': 0.39076683669058526, 'recall': 0.3722309149304126, 'f1-score': 0.38127372416701816, 'support': 12143}, '1': {'precision': 0.38271806599150604, 'recall': 0.18627762760375258, 'f1-score': 0.25058823529411767, 'support': 12578}, '2': {'precision': 0.3879845355580425, 'recall': 0.6040709646760652, 'f1-score': 0.4724941147317556, 'support': 12626}, 'accuracy': 0.38798297051972047, 'macro avg': {'precision': 0.38715647941337794, 'recall': 0.3875265024034101, 'f1-score': 0.3681186913976305, 'support': 37347}, 'weighted avg': {'precision': 0.387115491951985, 'recall': 0.38798297051972047, 'f1-score': 0.368099615730652, 'support': 37347}}
[[4520 1855 5768]
 [3972 2343 6263]
 [3075 1924 7627]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
5929/5929 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8432701
{'0': {'precision': 0.4801235904178683, 'recall': 0.5727838136863787, 'f1-score': 0.5223764598641104, 'support': 346169}, '1': {'precision': 0.6650270051280496, 'recall': 0.7380928908402783, 'f1-score': 0.699657536198025, 'support': 831772}, '2': {'precision': 0.626213913292695, 'recall': 0.3345356150186084, 'f1-score': 0.4360987967067765, 'support': 339632}, 'accuracy': 0.6100688401809995, 'macro avg': {'precision': 0.5904548362795375, 'recall': 0.5484707731817551, 'f1-score': 0.5527109309229706, 'support': 1517573}, 'weighted avg': {'precision': 0.6141628963352378, 'recall': 0.6100688401809995, 'f1-score': 0.6002341840928369, 'support': 1517573}}
[[198280 121071  26818]
 [176846 613925  41001]
 [ 37851 188162 113619]]
Evaluating performance on  train set...
1254/1254 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9018584
{'0': {'precision': 0.48843457685588554, 'recall': 0.5395353949875421, 'f1-score': 0.5127148643786488, 'support': 81876}, '1': {'precision': 0.5938578422193093, 'recall': 0.7116432647303969, 'f1-score': 0.6474371126503828, 'support': 155970}, '2': {'precision': 0.6112881410329887, 'recall': 0.3207935323981617, 'f1-score': 0.4207727448458692, 'support': 83122}, 'accuracy': 0.5665206500336483, 'macro avg': {'precision': 0.5645268533693945, 'recall': 0.5239907307053668, 'f1-score': 0.5269749072916335, 'support': 320968}, 'weighted avg': {'precision': 0.5714793061132021, 'recall': 0.5665206500336483, 'f1-score': 0.5543707808660826, 'support': 320968}}
[[ 44175  30870   6831]
 [ 34850 110995  10125]
 [ 11417  45040  26665]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90454584
{'0': {'precision': 0.47120951835592034, 'recall': 0.5421669106881406, 'f1-score': 0.5042039690914661, 'support': 27320}, '1': {'precision': 0.5930120256713814, 'recall': 0.70143533617084, 'f1-score': 0.6426828959474631, 'support': 54273}, '2': {'precision': 0.6200574331787055, 'recall': 0.30490984140777755, 'f1-score': 0.4087963300080099, 'support': 27618}, 'accuracy': 0.5613170834439755, 'macro avg': {'precision': 0.5614263257353357, 'recall': 0.5161706960889193, 'f1-score': 0.5185610650156464, 'support': 109211}, 'weighted avg': {'precision': 0.5693815815281988, 'recall': 0.5613170834439755, 'f1-score': 0.5488945096143862, 'support': 109211}}
[[14812 10482  2026]
 [13070 38069  3134]
 [ 3552 15645  8421]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
5331/5331 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.891859
{'0': {'precision': 0.45573752187919725, 'recall': 0.46323104807618487, 'f1-score': 0.4594537328256911, 'support': 299587}, '1': {'precision': 0.6657350320061585, 'recall': 0.757072439764975, 'f1-score': 0.7084720243850237, 'support': 760770}, '2': {'precision': 0.5211416436262164, 'recall': 0.3339205716370473, 'f1-score': 0.40703451149448316, 'support': 304249}, 'accuracy': 0.5982173609085699, 'macro avg': {'precision': 0.5475380658371907, 'recall': 0.5180746864927357, 'f1-score': 0.524986756235066, 'support': 1364606}, 'weighted avg': {'precision': 0.5873937980619908, 'recall': 0.5982173609085699, 'f1-score': 0.5865945705464652, 'support': 1364606}}
[[138778 126024  34785]
 [126245 575958  58567]
 [ 39490 163164 101595]]
Evaluating performance on  train set...
2013/2013 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9359639
{'0': {'precision': 0.46008828875616725, 'recall': 0.4082237650528385, 'f1-score': 0.4326070855952274, 'support': 130208}, '1': {'precision': 0.6146899683238849, 'recall': 0.7017981591568753, 'f1-score': 0.6553622159090909, 'support': 257708}, '2': {'precision': 0.4856092616101711, 'recall': 0.4023517221890797, 'f1-score': 0.4400772698003863, 'support': 127396}, 'accuracy': 0.5535888937187567, 'macro avg': {'precision': 0.5201291728967411, 'recall': 0.5041245487995979, 'f1-score': 0.5093488571015682, 'support': 515312}, 'weighted avg': {'precision': 0.5437140523629648, 'recall': 0.5535888937187567, 'f1-score': 0.545853916078363, 'support': 515312}}
[[ 53154  54014  23040]
 [ 45593 180859  31256]
 [ 16783  59355  51258]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9228583
{'0': {'precision': 0.44074291123833564, 'recall': 0.4564212688483264, 'f1-score': 0.44844509678011185, 'support': 42842}, '1': {'precision': 0.6254399817348123, 'recall': 0.7069658910060648, 'f1-score': 0.6637087737363336, 'support': 92996}, '2': {'precision': 0.527509228335384, 'recall': 0.35648951082179087, 'f1-score': 0.42545650447998185, 'support': 42091}, 'accuracy': 0.5637304767632033, 'macro avg': {'precision': 0.531230707102844, 'recall': 0.5066255568920607, 'f1-score': 0.5125367916654758, 'support': 177929}, 'weighted avg': {'precision': 0.5578017932689332, 'recall': 0.5637304767632033, 'f1-score': 0.5555161648112705, 'support': 177929}}
[[19554 17909  5379]
 [19190 65745  8061]
 [ 5622 21464 15005]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0283686
{'0': {'precision': 0.43905360222238243, 'recall': 0.4883391768504214, 'f1-score': 0.46238676759345093, 'support': 324291}, '1': {'precision': 0.49573691942788567, 'recall': 0.5399048494631534, 'f1-score': 0.5168790500669732, 'support': 423119}, '2': {'precision': 0.4740958277532497, 'recall': 0.3662460858353288, 'f1-score': 0.4132502221244624, 'support': 325740}, 'accuracy': 0.47161067884265945, 'macro avg': {'precision': 0.4696287831345059, 'recall': 0.4648300373829679, 'f1-score': 0.4641720132616289, 'support': 1073150}, 'weighted avg': {'precision': 0.4720391522732607, 'recall': 0.47161067884265945, 'f1-score': 0.4689571275122376, 'support': 1073150}}
[[158364 102494  63433]
 [125770 228444  68905]
 [ 76560 129879 119301]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0573349
{'0': {'precision': 0.46262092431879676, 'recall': 0.48167830322902827, 'f1-score': 0.47195731048681183, 'support': 106131}, '1': {'precision': 0.4280144456222937, 'recall': 0.4586357598043935, 'f1-score': 0.44279633450435885, 'support': 103882}, '2': {'precision': 0.46975819451907574, 'recall': 0.4168748927079558, 'f1-score': 0.44173942921820675, 'support': 104854}, 'accuracy': 0.4524958156936103, 'macro avg': {'precision': 0.4534645214867221, 'recall': 0.45239631858045914, 'f1-score': 0.45216435806979244, 'support': 314867}, 'weighted avg': {'precision': 0.4535802217670207, 'recall': 0.4524958156936103, 'f1-score': 0.452273551218462, 'support': 314867}}
[[51121 29739 25271]
 [32170 47644 24068]
 [27212 33931 43711]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0572723
{'0': {'precision': 0.4584700690279507, 'recall': 0.47330607476635517, 'f1-score': 0.46576996033798934, 'support': 34240}, '1': {'precision': 0.4356169976959197, 'recall': 0.4409151291512915, 'f1-score': 0.4382500513482585, 'support': 33875}, '2': {'precision': 0.4584483287335173, 'recall': 0.4380310577204805, 'f1-score': 0.44800719208870243, 'support': 34130}, 'accuracy': 0.4507995501002494, 'macro avg': {'precision': 0.4508451318191293, 'recall': 0.45075075387937574, 'f1-score': 0.4506757345916501, 'support': 102245}, 'weighted avg': {'precision': 0.45089131419767475, 'recall': 0.4507995501002494, 'f1-score': 0.45072296344449536, 'support': 102245}}
[[16206  9007  9027]
 [10306 14936  8633]
 [ 8836 10344 14950]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
6143/6143 - 56s - 56s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9990906
{'0': {'precision': 0.46065629074809716, 'recall': 0.5103944865123663, 'f1-score': 0.4842515684676733, 'support': 476214}, '1': {'precision': 0.5141219189881184, 'recall': 0.5634129942169624, 'f1-score': 0.5376400638529223, 'support': 618706}, '2': {'precision': 0.5116888285547614, 'recall': 0.3930445452299291, 'f1-score': 0.4445873419640277, 'support': 477582}, 'accuracy': 0.49561463196867156, 'macro avg': {'precision': 0.49548901276365903, 'recall': 0.4889506753197526, 'f1-score': 0.48882632476154103, 'support': 1572502}, 'weighted avg': {'precision': 0.49719152342611794, 'recall': 0.49561463196867156, 'f1-score': 0.49321108763124943, 'support': 1572502}}
[[243057 145939  87218]
 [178202 348587  91917]
 [106373 183498 187711]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0281909
{'0': {'precision': 0.4673154539625061, 'recall': 0.4881210354201962, 'f1-score': 0.47749171355893005, 'support': 177667}, '1': {'precision': 0.4617943943288596, 'recall': 0.4832132609342625, 'f1-score': 0.4722610952874869, 'support': 178087}, '2': {'precision': 0.48691511720905434, 'recall': 0.4425485875929067, 'f1-score': 0.4636729681540696, 'support': 177463}, 'accuracy': 0.4713146805146873, 'macro avg': {'precision': 0.4720083218334734, 'recall': 0.4712942946491218, 'f1-score': 0.47114192566682883, 'support': 533217}, 'weighted avg': {'precision': 0.47199457351748086, 'recall': 0.4713146805146873, 'f1-score': 0.47114566470473135, 'support': 533217}}
[[86723 47045 43899]
 [53175 86054 38858]
 [45679 53248 78536]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0263057
{'0': {'precision': 0.4628468662285493, 'recall': 0.48001533929474105, 'f1-score': 0.471274793353071, 'support': 57369}, '1': {'precision': 0.4738036910011432, 'recall': 0.4840975837671873, 'f1-score': 0.47889532676339985, 'support': 59928}, '2': {'precision': 0.4782353157256731, 'recall': 0.4498928744211763, 'f1-score': 0.4636313455956981, 'support': 57876}, 'accuracy': 0.471459642753164, 'macro avg': {'precision': 0.47162862431845526, 'recall': 0.4713352658277015, 'f1-score': 0.47126715523738966, 'support': 175173}, 'weighted avg': {'precision': 0.47167952022241566, 'recall': 0.471459642753164, 'f1-score': 0.471356490554172, 'support': 175173}}
[[27538 14840 14991]
 [17500 29011 13417]
 [14459 17379 26038]]
testing model on single stock: results/universal/W7/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
23942/23942 - 222s - 222s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1936289
{'0': {'precision': 0.3269896475476835, 'recall': 0.49754845487001487, 'f1-score': 0.39462868585161587, 'support': 1614492}, '1': {'precision': 0.4712846527311027, 'recall': 0.08653231302424619, 'f1-score': 0.14621767926484008, 'support': 2900951}, '2': {'precision': 0.31311265727882553, 'recall': 0.609258927592043, 'f1-score': 0.41364388261353335, 'support': 1613621}, 'accuracy': 0.3324205784113202, 'macro avg': {'precision': 0.37046231918587064, 'recall': 0.39777989849543466, 'f1-score': 0.3181634159099964, 'support': 6129064}, 'weighted avg': {'precision': 0.391632558221682, 'recall': 0.3324205784113202, 'f1-score': 0.2820593217277053, 'support': 6129064}}
[[ 803288  143404  667800]
 [1161032  251026 1488893]
 [ 492296  138212  983113]]
Evaluating performance on  train set...
9052/9052 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1349919
{'0': {'precision': 0.394309476698745, 'recall': 0.420703408080507, 'f1-score': 0.4070790628801758, 'support': 778268}, '1': {'precision': 0.3667683116008191, 'recall': 0.1073249878085475, 'f1-score': 0.166057628826052, 'support': 771032}, '2': {'precision': 0.3738338507408244, 'recall': 0.6140300606944697, 'f1-score': 0.4647304540693734, 'support': 767780}, 'accuracy': 0.38048362594299723, 'macro avg': {'precision': 0.37830387968012946, 'recall': 0.38068615219450813, 'f1-score': 0.34595571525853375, 'support': 2317080}, 'weighted avg': {'precision': 0.3783601371395773, 'recall': 0.38048362594299723, 'f1-score': 0.34597989789045724, 'support': 2317080}}
[[327420  73546 377302]
 [275928  82751 412353]
 [227015  69325 471440]]
Evaluating performance on  val set...
2763/2763 - 26s - 26s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1385105
{'0': {'precision': 0.3784962353461967, 'recall': 0.4316995070619029, 'f1-score': 0.403351016726117, 'support': 225789}, '1': {'precision': 0.4005671533727525, 'recall': 0.10555100678076584, 'f1-score': 0.16707666173833718, 'support': 251594}, '2': {'precision': 0.3699060215076195, 'recall': 0.6169476192961397, 'f1-score': 0.4625055426589113, 'support': 229932}, 'accuracy': 0.37590748110813427, 'macro avg': {'precision': 0.3829898034088562, 'recall': 0.3847327110462695, 'f1-score': 0.3443110737077885, 'support': 707315}, 'weighted avg': {'precision': 0.383554442088089, 'recall': 0.37590748110813427, 'f1-score': 0.3385373317172932, 'support': 707315}}
[[ 97473  20279 108037]
 [ 91439  26556 133599]
 [ 68615  19461 141856]]
training model: results/universal/W7/deepVOL_L2/h100
Epoch 1/50
12475/12475 - 396s - loss: 3.2612 - accuracy100: 0.3766 - val_loss: 3.3378 - val_accuracy100: 0.3616 - 396s/epoch - 32ms/step
Epoch 2/50
12475/12475 - 397s - loss: 3.2404 - accuracy100: 0.3882 - val_loss: 3.3621 - val_accuracy100: 0.3644 - 397s/epoch - 32ms/step
Epoch 3/50
12475/12475 - 397s - loss: 3.2300 - accuracy100: 0.3939 - val_loss: 3.3580 - val_accuracy100: 0.3658 - 397s/epoch - 32ms/step
Epoch 4/50
12475/12475 - 396s - loss: 3.2227 - accuracy100: 0.3975 - val_loss: 3.3854 - val_accuracy100: 0.3651 - 396s/epoch - 32ms/step
Epoch 5/50
12475/12475 - 402s - loss: 3.2161 - accuracy100: 0.4009 - val_loss: 3.3938 - val_accuracy100: 0.3649 - 402s/epoch - 32ms/step
Epoch 6/50
12475/12475 - 404s - loss: 3.2114 - accuracy100: 0.4031 - val_loss: 3.3795 - val_accuracy100: 0.3662 - 404s/epoch - 32ms/step
Epoch 7/50
12475/12475 - 406s - loss: 3.2078 - accuracy100: 0.4047 - val_loss: 3.4350 - val_accuracy100: 0.3674 - 406s/epoch - 33ms/step
Epoch 8/50
12475/12475 - 406s - loss: 3.2038 - accuracy100: 0.4065 - val_loss: 3.4605 - val_accuracy100: 0.3681 - 406s/epoch - 33ms/step
Epoch 9/50
12475/12475 - 406s - loss: 3.2003 - accuracy100: 0.4085 - val_loss: 3.5104 - val_accuracy100: 0.3704 - 406s/epoch - 33ms/step
Epoch 10/50
12475/12475 - 410s - loss: 3.1974 - accuracy100: 0.4102 - val_loss: 3.4533 - val_accuracy100: 0.3712 - 410s/epoch - 33ms/step
Epoch 11/50
12475/12475 - 401s - loss: 3.1946 - accuracy100: 0.4117 - val_loss: 3.4479 - val_accuracy100: 0.3720 - 401s/epoch - 32ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 600s - 600s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1240137
{'0': {'precision': 0.33214305039167225, 'recall': 0.6054934020274706, 'f1-score': 0.4289731377711726, 'support': 2818290}, '1': {'precision': 0.4640550100378296, 'recall': 0.017526092237704346, 'f1-score': 0.033776536790426324, 'support': 3877590}, '2': {'precision': 0.34636278098418255, 'recall': 0.5203915589324382, 'f1-score': 0.41590623606193283, 'support': 2809692}, 'accuracy': 0.34049029348260157, 'macro avg': {'precision': 0.38085361380456145, 'recall': 0.38113701773253766, 'f1-score': 0.2928853035411772, 'support': 9505572}, 'weighted avg': {'precision': 0.390156766861578, 'recall': 0.34049029348260157, 'f1-score': 0.2638989731449755, 'support': 9505572}}
[[1706456   37060 1074774]
 [2125133   67959 1684498]
 [1306125   41427 1462140]]
Evaluating performance on  train set...
12475/12475 - 206s - 206s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1122175
{'0': {'precision': 0.36037935066375026, 'recall': 0.5345100329369993, 'f1-score': 0.4305032155326917, 'support': 1070225}, '1': {'precision': 0.4011606724613543, 'recall': 0.014469925740134589, 'f1-score': 0.027932328204403393, 'support': 1065313}, '2': {'precision': 0.36063609461792595, 'recall': 0.5344732049480589, 'f1-score': 0.43067439787264844, 'support': 1057546}, 'accuracy': 0.3609961404084578, 'macro avg': {'precision': 0.3740587059143435, 'recall': 0.36115105454173096, 'f1-score': 0.2963699805365812, 'support': 3193084}, 'weighted avg': {'precision': 0.37407031238287, 'recall': 0.3609961404084578, 'f1-score': 0.29624963294812173, 'support': 3193084}}
[[572046  11307 486872]
 [534686  15415 515212]
 [480612  11704 565230]]
Evaluating performance on  val set...
3866/3866 - 65s - 65s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1124445
{'0': {'precision': 0.35489254953754223, 'recall': 0.5443011005026988, 'f1-score': 0.42964806360642793, 'support': 323852}, '1': {'precision': 0.39892183288409705, 'recall': 0.012912270568025583, 'f1-score': 0.025014862045250556, 'support': 332397}, '2': {'precision': 0.36699816709531313, 'recall': 0.5310088811333732, 'f1-score': 0.4340261838070853, 'support': 332953}, 'accuracy': 0.36126696064100156, 'macro avg': {'precision': 0.3736041831723174, 'recall': 0.3627407507346992, 'f1-score': 0.29622970315292124, 'support': 989202}, 'weighted avg': {'precision': 0.3737621063917108, 'recall': 0.36126696064100156, 'f1-score': 0.2951546496786749, 'support': 989202}}
[[176273   3080 144499]
 [167656   4292 160449]
 [152765   3387 176801]]
testing model out of sample: results/universal/W7/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 237s - 237s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1110955
{'0': {'precision': 0.32632000788415866, 'recall': 0.6867334325062702, 'f1-score': 0.44241468450745447, 'support': 1089679}, '1': {'precision': 0.48072870201569634, 'recall': 0.023802268516680984, 'f1-score': 0.045358696759404696, 'support': 1562078}, '2': {'precision': 0.3732372643125767, 'recall': 0.4667400145210934, 'f1-score': 0.4147844722822812, 'support': 1122505}, 'accuracy': 0.3469335197185569, 'macro avg': {'precision': 0.39342865807081057, 'recall': 0.39242523851468153, 'f1-score': 0.30085261784971346, 'support': 3774262}, 'weighted avg': {'precision': 0.40417980644578094, 'recall': 0.3469335197185569, 'f1-score': 0.2698650643159266, 'support': 3774262}}
[[748319  19041 322319]
 [967421  37181 557476]
 [577466  21121 523918]]
Evaluating performance on  train set...
5285/5285 - 88s - 88s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974754
{'0': {'precision': 0.36713538990194705, 'recall': 0.6328820566049554, 'f1-score': 0.46469869385824286, 'support': 447028}, '1': {'precision': 0.41208791208791207, 'recall': 0.02621947535153519, 'f1-score': 0.04930206135367635, 'support': 463396}, '2': {'precision': 0.3921416394297069, 'recall': 0.48998240702633516, 'f1-score': 0.43563602002452806, 'support': 442222}, 'accuracy': 0.3783303244159965, 'macro avg': {'precision': 0.39045498047318866, 'recall': 0.38302797966094193, 'f1-score': 0.3165455917454824, 'support': 1352646}, 'weighted avg': {'precision': 0.3907107619132142, 'recall': 0.3783303244159965, 'f1-score': 0.31288861815168023, 'support': 1352646}}
[[282916   8441 155671]
 [271040  12150 180206]
 [216648   8893 216681]]
Evaluating performance on  val set...
1714/1714 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003034
{'0': {'precision': 0.3531704105226086, 'recall': 0.659404907405422, 'f1-score': 0.4599802063623831, 'support': 139911}, '1': {'precision': 0.40600428877769834, 'recall': 0.018202211184105112, 'f1-score': 0.034842350631824316, 'support': 156025}, '2': {'precision': 0.40134031364281464, 'recall': 0.4796126616841898, 'f1-score': 0.4369992529872495, 'support': 142098}, 'accuracy': 0.37268796486117517, 'macro avg': {'precision': 0.3868383376477072, 'recall': 0.38573992675790564, 'f1-score': 0.310607269993819, 'support': 438034}, 'weighted avg': {'precision': 0.38761580231485626, 'recall': 0.37268796486117517, 'f1-score': 0.30109372391339473, 'support': 438034}}
[[92258  1973 45680]
 [97206  2840 55979]
 [71764  2182 68152]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1286833
{'0': {'precision': 0.3240123536224424, 'recall': 0.4746992948983824, 'f1-score': 0.3851413362701909, 'support': 53042}, '1': {'precision': 0.4237879316358563, 'recall': 0.03405269058295964, 'f1-score': 0.06303992528601447, 'support': 71360}, '2': {'precision': 0.3335626587637595, 'recall': 0.5888232876200441, 'f1-score': 0.4258726233429278, 'support': 53522}, 'accuracy': 0.3322991839212248, 'macro avg': {'precision': 0.3604543146740194, 'recall': 0.36585842436712873, 'f1-score': 0.29135129496637774, 'support': 177924}, 'weighted avg': {'precision': 0.3669022205252256, 'recall': 0.3322991839212248, 'f1-score': 0.26820861926110945, 'support': 177924}}
[[25179  1548 26315]
 [32280  2430 36650]
 [20251  1756 31515]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1138345
{'0': {'precision': 0.36944444444444446, 'recall': 0.3997238242222403, 'f1-score': 0.3839881393624907, 'support': 24622}, '1': {'precision': 0.35138316656856977, 'recall': 0.02503039704834179, 'f1-score': 0.04673189823874755, 'support': 23851}, '2': {'precision': 0.35178780035274987, 'recall': 0.6528929133188794, 'f1-score': 0.45721941053885085, 'support': 23523}, 'accuracy': 0.3583115728651592, 'macro avg': {'precision': 0.3575384704552547, 'recall': 0.3592157115298205, 'f1-score': 0.2959798160466964, 'support': 71996}, 'weighted avg': {'precision': 0.3576921696293656, 'recall': 0.3583115728651592, 'f1-score': 0.29618771412829886, 'support': 71996}}
[[ 9842   561 14219]
 [ 9174   597 14080]
 [ 7624   541 15358]]
Evaluating performance on  val set...
73/73 - 1s - 700ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1094265
{'0': {'precision': 0.3676817619957299, 'recall': 0.4992371071101617, 'f1-score': 0.4234776418818353, 'support': 6554}, '1': {'precision': 0.33067729083665337, 'recall': 0.03207729468599034, 'f1-score': 0.05848159239034702, 'support': 5175}, '2': {'precision': 0.378500054902822, 'recall': 0.5084820770025077, 'f1-score': 0.43396701498174495, 'support': 6779}, 'accuracy': 0.37200129673654636, 'macro avg': {'precision': 0.35895303591173516, 'recall': 0.3465988262662199, 'f1-score': 0.3053087497513091, 'support': 18508}, 'weighted avg': {'precision': 0.3612974454498554, 'recall': 0.37200129673654636, 'f1-score': 0.32526351307947066, 'support': 18508}}
[[3272  188 3094]
 [2443  166 2566]
 [3184  148 3447]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
2006/2006 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0842453
{'0': {'precision': 0.33331964092177313, 'recall': 0.6834647505879762, 'f1-score': 0.4481033091202582, 'support': 154343}, '1': {'precision': 0.46765199161425575, 'recall': 0.10568681982498448, 'f1-score': 0.172409928623047, 'support': 211067}, '2': {'precision': 0.40614670841350825, 'recall': 0.40953217955651705, 'f1-score': 0.40783241829449324, 'support': 147920}, 'accuracy': 0.3669627724855356, 'macro avg': {'precision': 0.4023727803165124, 'recall': 0.39956124998982595, 'f1-score': 0.3427818853459328, 'support': 513330}, 'weighted avg': {'precision': 0.4095390438146251, 'recall': 0.3669627724855356, 'f1-score': 0.3231415010974424, 'support': 513330}}
[[105488  11735  37120]
 [137305  22307  51455]
 [ 73684  13658  60578]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0762773
{'0': {'precision': 0.3464503273555366, 'recall': 0.7312249164884286, 'f1-score': 0.4701474087579962, 'support': 41611}, '1': {'precision': 0.5078112794875801, 'recall': 0.11447034793632906, 'f1-score': 0.18682645055608244, 'support': 56792}, '2': {'precision': 0.40720671904632894, 'recall': 0.3840650074104359, 'f1-score': 0.39529745936563043, 'support': 39134}, 'accuracy': 0.37777470789678413, 'macro avg': {'precision': 0.4204894419631486, 'recall': 0.40992009061173124, 'f1-score': 0.3507571062265697, 'support': 137537}, 'weighted avg': {'precision': 0.43036703213977995, 'recall': 0.37777470789678413, 'f1-score': 0.331860680257855, 'support': 137537}}
[[30427  2982  8202]
 [36613  6501 13678]
 [20785  3319 15030]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0857779
{'0': {'precision': 0.347723704866562, 'recall': 0.7323524549512316, 'f1-score': 0.47155250412475386, 'support': 12098}, '1': {'precision': 0.46835803876852905, 'recall': 0.1118828736806265, 'f1-score': 0.1806189193645908, 'support': 14685}, '2': {'precision': 0.4445438282647585, 'recall': 0.3646368305209098, 'f1-score': 0.4006449012494962, 'support': 12267}, 'accuracy': 0.38350832266325224, 'macro avg': {'precision': 0.4202085239666165, 'recall': 0.40295738638425593, 'f1-score': 0.35093877491294695, 'support': 39050}, 'weighted avg': {'precision': 0.4235036702206225, 'recall': 0.38350832266325224, 'f1-score': 0.3398704745044266, 'support': 39050}}
[[8860  838 2400]
 [9853 1643 3189]
 [6767 1027 4473]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1117061
{'0': {'precision': 0.34778492768211283, 'recall': 0.7355602301239323, 'f1-score': 0.47227194324209976, 'support': 78914}, '1': {'precision': 0.3162518301610542, 'recall': 0.041297032731722236, 'f1-score': 0.07305441877769134, 'support': 78456}, '2': {'precision': 0.41016151847100235, 'recall': 0.30948805460750856, 'f1-score': 0.3527830632440424, 'support': 80575}, 'accuracy': 0.3623652524743113, 'macro avg': {'precision': 0.3580660921047231, 'recall': 0.3621151058210544, 'f1-score': 0.29936980842127786, 'support': 237945}, 'weighted avg': {'precision': 0.358510234386194, 'recall': 0.3623652524743113, 'f1-score': 0.30017828039890865, 'support': 237945}}
[[58046  3294 17574]
 [56929  3240 18287]
 [51927  3711 24937]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1106716
{'0': {'precision': 0.34744926833212064, 'recall': 0.6622900292803205, 'f1-score': 0.45578534309046564, 'support': 32445}, '1': {'precision': 0.3467706978760295, 'recall': 0.024805432389693342, 'f1-score': 0.04629897563516407, 'support': 32251}, '2': {'precision': 0.38547753903323445, 'recall': 0.39186595582635186, 'f1-score': 0.38864549657068614, 'support': 32825}, 'accuracy': 0.3604454425200726, 'macro avg': {'precision': 0.3598991684137949, 'recall': 0.3596538058321219, 'f1-score': 0.2969099384321053, 'support': 97521}, 'weighted avg': {'precision': 0.3600249536715313, 'recall': 0.3604454425200726, 'f1-score': 0.29776593907684096, 'support': 97521}}
[[21488   680 10277]
 [21222   800 10229]
 [19135   827 12863]]
Evaluating performance on  val set...
114/114 - 1s - 987ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1108117
{'0': {'precision': 0.3454661898916582, 'recall': 0.670638209697472, 'f1-score': 0.45602169854521124, 'support': 9652}, '1': {'precision': 0.37721021611001965, 'recall': 0.020674060514697966, 'f1-score': 0.039199673336055535, 'support': 9287}, '2': {'precision': 0.388363340453667, 'recall': 0.3766028802525153, 'f1-score': 0.3823927086984827, 'support': 10138}, 'accuracy': 0.3605255012552877, 'macro avg': {'precision': 0.3703465821517817, 'recall': 0.35597171682156176, 'f1-score': 0.2925380268599165, 'support': 29077}, 'weighted avg': {'precision': 0.3705615602492456, 'recall': 0.3605255012552877, 'f1-score': 0.2972200048634847, 'support': 29077}}
[[6473  158 3021]
 [6103  192 2992]
 [6161  159 3818]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1279607
{'0': {'precision': 0.30508711851995435, 'recall': 0.3340171423855504, 'f1-score': 0.3188973497447673, 'support': 84819}, '1': {'precision': 0.35586963400485183, 'recall': 0.03592419080068143, 'f1-score': 0.06526049071092156, 'support': 93920}, '2': {'precision': 0.34339141271632806, 'recall': 0.6233193904989542, 'f1-score': 0.44282638688842735, 'support': 93716}, 'accuracy': 0.330770218935237, 'macro avg': {'precision': 0.3347827217470447, 'recall': 0.331086907895062, 'f1-score': 0.2756614091147054, 'support': 272455}, 'weighted avg': {'precision': 0.33576821847865923, 'recall': 0.330770218935237, 'f1-score': 0.27409200517225607, 'support': 272455}}
[[28331  2867 53621]
 [32470  3374 58076]
 [32061  3240 58415]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.121494
{'0': {'precision': 0.3476027872629855, 'recall': 0.3512891731896866, 'f1-score': 0.3494362580933244, 'support': 35643}, '1': {'precision': 0.3135430916552668, 'recall': 0.03392941733775462, 'f1-score': 0.06123266810932115, 'support': 33776}, '2': {'precision': 0.32451235783721966, 'recall': 0.6151205853129799, 'f1-score': 0.42487703937859395, 'support': 33213}, 'accuracy': 0.33222581650947075, 'macro avg': {'precision': 0.3285527455851573, 'recall': 0.3334463919468071, 'f1-score': 0.27851532186041317, 'support': 102632}, 'weighted avg': {'precision': 0.3289214528705517, 'recall': 0.33222581650947075, 'f1-score': 0.2790025747735797, 'support': 102632}}
[[12521  1278 21844]
 [11948  1146 20682]
 [11552  1231 20430]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.126581
{'0': {'precision': 0.3077567743737778, 'recall': 0.33897435897435896, 'f1-score': 0.3226121333398409, 'support': 9750}, '1': {'precision': 0.2956841138659321, 'recall': 0.030325861744207948, 'f1-score': 0.0550098231827112, 'support': 10618}, '2': {'precision': 0.3477727202986754, 'recall': 0.6174521020612004, 'f1-score': 0.44493882091212456, 'support': 11013}, 'accuracy': 0.3322711194671935, 'macro avg': {'precision': 0.31707120284612844, 'recall': 0.3289174409265891, 'f1-score': 0.27418692581155885, 'support': 31381}, 'weighted avg': {'precision': 0.31771528758873563, 'recall': 0.3322711194671935, 'f1-score': 0.2749967763080432, 'support': 31381}}
[[3305  362 6083]
 [3626  322 6670]
 [3808  405 6800]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
1646/1646 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1369209
{'0': {'precision': 0.2759402661480274, 'recall': 0.6253398242397421, 'f1-score': 0.38291412264401375, 'support': 110719}, '1': {'precision': 0.4806828391734052, 'recall': 0.028306878306878308, 'f1-score': 0.05346524758906711, 'support': 189000}, '2': {'precision': 0.33780660880923374, 'recall': 0.4425003701692908, 'f1-score': 0.38313011025326915, 'support': 121566}, 'accuracy': 0.3047343247445316, 'macro avg': {'precision': 0.3648099047102222, 'recall': 0.3653823575719704, 'f1-score': 0.2731698268287834, 'support': 421285}, 'weighted avg': {'precision': 0.38564554906517046, 'recall': 0.3047343247445316, 'f1-score': 0.23517665125130294, 'support': 421285}}
[[ 69237   2684  38798]
 [116999   5350  66651]
 [ 64677   3096  53793]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1113113
{'0': {'precision': 0.3463506067054695, 'recall': 0.547679005192432, 'f1-score': 0.42434602434602436, 'support': 44873}, '1': {'precision': 0.3404761904761905, 'recall': 0.022316850225175013, 'f1-score': 0.041888103109176886, 'support': 44854}, '2': {'precision': 0.3656491441938619, 'recall': 0.4946404296570321, 'f1-score': 0.4204743502311131, 'support': 44873}, 'accuracy': 0.354925705794948, 'macro avg': {'precision': 0.3508253137918406, 'recall': 0.35487876169154636, 'f1-score': 0.2955694925621048, 'support': 134600}, 'weighted avg': {'precision': 0.3508267746636311, 'recall': 0.354925705794948, 'f1-score': 0.29560530197072, 'support': 134600}}
[[24576   911 19386]
 [24732  1001 19121]
 [21649  1028 22196]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1107224
{'0': {'precision': 0.34396891138722707, 'recall': 0.5491876887909217, 'f1-score': 0.42300194931773877, 'support': 12249}, '1': {'precision': 0.37757731958762886, 'recall': 0.023881326921509495, 'f1-score': 0.04492142583365274, 'support': 12269}, '2': {'precision': 0.3763371341248384, 'recall': 0.4991035934211552, 'f1-score': 0.4291123546560332, 'support': 12829}, 'accuracy': 0.35941307200042844, 'macro avg': {'precision': 0.36596112169989814, 'recall': 0.35739086971119544, 'f1-score': 0.29901190993580823, 'support': 37347}, 'weighted avg': {'precision': 0.3661284821616278, 'recall': 0.35941307200042844, 'f1-score': 0.30089630354856656, 'support': 37347}}
[[6727  219 5303]
 [6668  293 5308]
 [6162  264 6403]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
5929/5929 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0569288
{'0': {'precision': 0.3836902154881803, 'recall': 0.7922091936608243, 'f1-score': 0.5169879563889166, 'support': 463341}, '1': {'precision': 0.5133136633519105, 'recall': 0.04633354430899989, 'f1-score': 0.08499512206890623, 'support': 608285}, '2': {'precision': 0.45288160916360015, 'recall': 0.5138704823667386, 'f1-score': 0.48145226267373564, 'support': 445947}, 'accuracy': 0.41145038821855684, 'macro avg': {'precision': 0.4499618293345637, 'recall': 0.4508044067788543, 'f1-score': 0.3611451137105195, 'support': 1517573}, 'weighted avg': {'precision': 0.45597912245948347, 'recall': 0.41145038821855684, 'f1-score': 0.33339099121521404, 'support': 1517573}}
[[367063  12634  83644]
 [386902  28184 193199]
 [202700  14088 229159]]
Evaluating performance on  train set...
1254/1254 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0672579
{'0': {'precision': 0.3972647460623594, 'recall': 0.7520227421823749, 'f1-score': 0.5198910225020787, 'support': 105179}, '1': {'precision': 0.4390473944824334, 'recall': 0.017321897036113643, 'f1-score': 0.03332885845974851, 'support': 107494}, '2': {'precision': 0.45936594033479844, 'recall': 0.498933468765871, 'f1-score': 0.47833284643100593, 'support': 108295}, 'accuracy': 0.42057463672391016, 'macro avg': {'precision': 0.43189269362653043, 'recall': 0.4227593693281198, 'f1-score': 0.34385090913094435, 'support': 320968}, 'weighted avg': {'precision': 0.432211011244562, 'recall': 0.42057463672391016, 'f1-score': 0.3429168196557418, 'support': 320968}}
[[79097  1072 25010]
 [67051  1862 38581]
 [52956  1307 54032]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0734732
{'0': {'precision': 0.3858183856502242, 'recall': 0.7749162655858595, 'f1-score': 0.5151512316515263, 'support': 35529}, '1': {'precision': 0.4345442083618917, 'recall': 0.016882356073920222, 'f1-score': 0.032501986517314736, 'support': 37554}, '2': {'precision': 0.4605957353264454, 'recall': 0.46396147032772367, 'f1-score': 0.4622724765581908, 'support': 36128}, 'accuracy': 0.4113871313329243, 'macro avg': {'precision': 0.42698610977952045, 'recall': 0.4185866973291678, 'f1-score': 0.336641898242344, 'support': 109211}, 'weighted avg': {'precision': 0.4273105946329867, 'recall': 0.4113871313329243, 'f1-score': 0.33169156718748694, 'support': 109211}}
[[27532   397  7600]
 [24890   634 12030]
 [18938   428 16762]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
5331/5331 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0971798
{'0': {'precision': 0.33504794112089215, 'recall': 0.7072093655706497, 'f1-score': 0.45468434781812295, 'support': 386095}, '1': {'precision': 0.5427657662420046, 'recall': 0.03511979381337511, 'f1-score': 0.06597092267732395, 'support': 584713}, '2': {'precision': 0.3777348802494656, 'recall': 0.4909369778414314, 'f1-score': 0.42695989010746327, 'support': 393798}, 'accuracy': 0.3568172791267223, 'macro avg': {'precision': 0.4185161958707874, 'recall': 0.41108871240848543, 'f1-score': 0.31587172020097004, 'support': 1364606}, 'weighted avg': {'precision': 0.43637047959353187, 'recall': 0.3568172791267223, 'f1-score': 0.2801258093448242, 'support': 1364606}}
[[273050   8232 104813]
 [350507  20535 213671]
 [191401   9067 193330]]
Evaluating performance on  train set...
2013/2013 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0887482
{'0': {'precision': 0.372217646470947, 'recall': 0.6511626504934558, 'f1-score': 0.4736738238080202, 'support': 165871}, '1': {'precision': 0.42686864849463385, 'recall': 0.04792446392203278, 'f1-score': 0.08617416979829742, 'support': 187566}, '2': {'precision': 0.39904545833190413, 'recall': 0.5030795366795366, 'f1-score': 0.44506383350821965, 'support': 161875}, 'accuracy': 0.38507544943645794, 'macro avg': {'precision': 0.3993772510991616, 'recall': 0.40072221703167504, 'f1-score': 0.33497060903817905, 'support': 515312}, 'weighted avg': {'precision': 0.40053723128668445, 'recall': 0.38507544943645794, 'f1-score': 0.32364238211101354, 'support': 515312}}
[[108009   5977  51885]
 [107821   8989  70756]
 [ 74347   6092  81436]]
Evaluating performance on  val set...
696/696 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912036
{'0': {'precision': 0.35500603798441105, 'recall': 0.7071397332167068, 'f1-score': 0.47270135945037284, 'support': 54876}, '1': {'precision': 0.4250159540523293, 'recall': 0.029021293902332743, 'f1-score': 0.054332603641209024, 'support': 68846}, '2': {'precision': 0.41304755944931165, 'recall': 0.4870588669360046, 'f1-score': 0.44701042098758115, 'support': 54207}, 'accuracy': 0.37770683812082345, 'macro avg': {'precision': 0.3976898504953507, 'recall': 0.40773996468501467, 'f1-score': 0.32468146135972104, 'support': 177929}, 'weighted avg': {'precision': 0.3997776009992077, 'recall': 0.37770683812082345, 'f1-score': 0.3029952178787896, 'support': 177929}}
[[38805  1328 14743]
 [44073  1998 22775]
 [26430  1375 26402]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
4192/4192 - 38s - 38s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1157143
{'0': {'precision': 0.3189121256073994, 'recall': 0.7042883168316831, 'f1-score': 0.43902655793587936, 'support': 315625}, '1': {'precision': 0.4209006170408297, 'recall': 0.0074439555591673725, 'f1-score': 0.014629182618377283, 'support': 430685}, '2': {'precision': 0.3800528623841261, 'recall': 0.4285001835760617, 'f1-score': 0.4028250765088935, 'support': 326840}, 'accuracy': 0.3406308530960257, 'macro avg': {'precision': 0.37328853501078507, 'recall': 0.38007748532230407, 'f1-score': 0.2854936056877167, 'support': 1073150}, 'weighted avg': {'precision': 0.3784640538943232, 'recall': 0.3406308530960257, 'f1-score': 0.2576784931003816, 'support': 1073150}}
[[222291   2021  91313]
 [290339   3206 137140]
 [184399   2390 140051]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0993823
{'0': {'precision': 0.3668099777128373, 'recall': 0.6741432963407319, 'f1-score': 0.4751077568411144, 'support': 106688}, '1': {'precision': 0.378018728437654, 'recall': 0.007449277895943203, 'f1-score': 0.014610637000914356, 'support': 102963}, '2': {'precision': 0.3971702880242547, 'recall': 0.4407504562043796, 'f1-score': 0.41782707217414417, 'support': 105216}, 'accuracy': 0.37814061175035807, 'macro avg': {'precision': 0.38066633139158196, 'recall': 0.37411434348035155, 'f1-score': 0.3025151553387243, 'support': 314867}, 'weighted avg': {'precision': 0.3806204977438516, 'recall': 0.37814061175035807, 'f1-score': 0.3053820965844776, 'support': 314867}}
[[71923   670 34095]
 [65904   767 36292]
 [58250   592 46374]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0887066
{'0': {'precision': 0.3890511065371053, 'recall': 0.6707286881412813, 'f1-score': 0.4924565265687799, 'support': 36353}, '1': {'precision': 0.3212669683257919, 'recall': 0.004809157720052833, 'f1-score': 0.009476459007641228, 'support': 29527}, '2': {'precision': 0.41318681318681316, 'recall': 0.44460332737522346, 'f1-score': 0.42831975627525004, 'support': 36365}, 'accuracy': 0.397995011981026, 'macro avg': {'precision': 0.37450162934990344, 'recall': 0.3733803910788525, 'f1-score': 0.31008424728389045, 'support': 102245}, 'weighted avg': {'precision': 0.3780601800698079, 'recall': 0.397995011981026, 'f1-score': 0.33016706393880335, 'support': 102245}}
[[24383   150 11820]
 [18243   142 11142]
 [20047   150 16168]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
6143/6143 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1141851
{'0': {'precision': 0.32868705310218493, 'recall': 0.7015224263357843, 'f1-score': 0.44763971522218415, 'support': 460909}, '1': {'precision': 0.44895591647331784, 'recall': 0.008484861772549953, 'f1-score': 0.016654959830437875, 'support': 638549}, '2': {'precision': 0.38198013552785814, 'recall': 0.4656881812262707, 'f1-score': 0.4197010341490181, 'support': 473044}, 'accuracy': 0.34915504082029786, 'macro avg': {'precision': 0.38654103503445364, 'recall': 0.39189848977820163, 'f1-score': 0.2946652364005467, 'support': 1572502}, 'weighted avg': {'precision': 0.3935566273982709, 'recall': 0.34915504082029786, 'f1-score': 0.2642242982496023, 'support': 1572502}}
[[323338   3203 134368]
 [411082   5418 222049]
 [249306   3447 220291]]
Evaluating performance on  train set...
2083/2083 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.098033
{'0': {'precision': 0.370125293049108, 'recall': 0.6650987350530363, 'f1-score': 0.47558761685505785, 'support': 179217}, '1': {'precision': 0.40894568690095845, 'recall': 0.0029278223177830894, 'f1-score': 0.005814019508760773, 'support': 174874}, '2': {'precision': 0.40120522103658535, 'recall': 0.4701774170137222, 'f1-score': 0.4329616549199837, 'support': 179126}, 'accuracy': 0.38245217238010043, 'macro avg': {'precision': 0.39342540032888396, 'recall': 0.3794013247948472, 'f1-score': 0.3047877637612674, 'support': 533217}, 'weighted avg': {'precision': 0.3932976614003297, 'recall': 0.38245217238010043, 'f1-score': 0.3072010010496382, 'support': 533217}}
[[119197    341  59679]
 [108342    512  66020]
 [ 94506    399  84221]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1056505
{'0': {'precision': 0.35253443053888794, 'recall': 0.6541887592788972, 'f1-score': 0.4581677745181775, 'support': 56580}, '1': {'precision': 0.3612565445026178, 'recall': 0.002282953943885654, 'f1-score': 0.004537234916981753, 'support': 60448}, '2': {'precision': 0.4013209736808172, 'recall': 0.48174391607188927, 'f1-score': 0.43787028497287833, 'support': 58145}, 'accuracy': 0.37199225908102274, 'macro avg': {'precision': 0.37170398290744094, 'recall': 0.3794052097648907, 'f1-score': 0.30019176480267923, 'support': 175173}, 'weighted avg': {'precision': 0.37173789166512894, 'recall': 0.37199225908102274, 'f1-score': 0.29489343208284496, 'support': 175173}}
[[37014   115 19451]
 [37975   138 22335]
 [30005   129 28011]]
testing model on single stock: results/universal/W7/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
23942/23942 - 232s - 232s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1452038
{'0': {'precision': 0.3197570263438293, 'recall': 0.5461264041791795, 'f1-score': 0.4033516495464162, 'support': 1800162}, '1': {'precision': 0.40678216541686674, 'recall': 0.0043463279804138956, 'f1-score': 0.008600759791057459, 'support': 2533633}, '2': {'precision': 0.32174580278065057, 'recall': 0.5425705005767938, 'f1-score': 0.4039488335348115, 'support': 1795269}, 'accuracy': 0.32112374744332906, 'macro avg': {'precision': 0.3494283315137822, 'recall': 0.3643477442454624, 'f1-score': 0.2719670809574284, 'support': 6129064}, 'weighted avg': {'precision': 0.356314019853767, 'recall': 0.32112374744332906, 'f1-score': 0.2403444146469476, 'support': 6129064}}
[[ 983116    7985  809061]
 [1278321   11012 1244300]
 [ 813135    8074  974060]]
Evaluating performance on  train set...
9052/9052 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1216979
{'0': {'precision': 0.35390426444438, 'recall': 0.48436699850468057, 'f1-score': 0.40898347325869805, 'support': 781104}, '1': {'precision': 0.32066967160334836, 'recall': 0.006515868363758164, 'f1-score': 0.012772210951786187, 'support': 764288}, '2': {'precision': 0.34817253697968603, 'recall': 0.5560835467183629, 'f1-score': 0.4282260804744463, 'support': 771688}, 'accuracy': 0.3506326928720631, 'macro avg': {'precision': 0.3409154910091381, 'recall': 0.3489888045289338, 'f1-score': 0.28332725489497684, 'support': 2317080}, 'weighted avg': {'precision': 0.34103293251062666, 'recall': 0.3506326928720631, 'f1-score': 0.284701953341855, 'support': 2317080}}
[[378341   5251 397512]
 [353442   4980 405866]
 [337266   5299 429123]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1226646
{'0': {'precision': 0.3444859052102816, 'recall': 0.48903190481570646, 'f1-score': 0.40422555194566123, 'support': 230122}, '1': {'precision': 0.3351404632824051, 'recall': 0.005666359738847479, 'f1-score': 0.01114429817553089, 'support': 240013}, '2': {'precision': 0.352961951903467, 'recall': 0.5604055991230289, 'f1-score': 0.4331265193334159, 'support': 237180}, 'accuracy': 0.34894495380417495, 'macro avg': {'precision': 0.34419610679871787, 'recall': 0.35170128789252764, 'f1-score': 0.282832123151536, 'support': 707315}, 'weighted avg': {'precision': 0.34415694456510126, 'recall': 0.34894495380417495, 'f1-score': 0.28053260111597056, 'support': 707315}}
[[112537   1369 116216]
 [111210   1360 127443]
 [102934   1329 132917]]
training model: results/universal/W7/deepVOL_L2/h200
Epoch 1/50
12475/12475 - 406s - loss: 3.2762 - accuracy200: 0.3670 - val_loss: 3.2948 - val_accuracy200: 0.3443 - 406s/epoch - 33ms/step
Epoch 2/50
12475/12475 - 403s - loss: 3.2701 - accuracy200: 0.3743 - val_loss: 3.2970 - val_accuracy200: 0.3453 - 403s/epoch - 32ms/step
Epoch 3/50
12475/12475 - 401s - loss: 3.2673 - accuracy200: 0.3764 - val_loss: 3.3082 - val_accuracy200: 0.3424 - 401s/epoch - 32ms/step
Epoch 4/50
12475/12475 - 403s - loss: 3.2615 - accuracy200: 0.3813 - val_loss: 3.3074 - val_accuracy200: 0.3469 - 403s/epoch - 32ms/step
Epoch 5/50
12475/12475 - 406s - loss: 3.2565 - accuracy200: 0.3851 - val_loss: 3.3204 - val_accuracy200: 0.3462 - 406s/epoch - 33ms/step
Epoch 6/50
12475/12475 - 410s - loss: 3.2531 - accuracy200: 0.3881 - val_loss: 3.3167 - val_accuracy200: 0.3470 - 410s/epoch - 33ms/step
Epoch 7/50
12475/12475 - 417s - loss: 3.2500 - accuracy200: 0.3897 - val_loss: 3.3258 - val_accuracy200: 0.3465 - 417s/epoch - 33ms/step
Epoch 8/50
12475/12475 - 417s - loss: 3.2481 - accuracy200: 0.3908 - val_loss: 3.3174 - val_accuracy200: 0.3473 - 417s/epoch - 33ms/step
Epoch 9/50
12475/12475 - 413s - loss: 3.2460 - accuracy200: 0.3924 - val_loss: 3.3119 - val_accuracy200: 0.3466 - 413s/epoch - 33ms/step
Epoch 10/50
12475/12475 - 413s - loss: 3.2443 - accuracy200: 0.3931 - val_loss: 3.3138 - val_accuracy200: 0.3471 - 413s/epoch - 33ms/step
Epoch 11/50
12475/12475 - 420s - loss: 3.2429 - accuracy200: 0.3944 - val_loss: 3.3139 - val_accuracy200: 0.3474 - 420s/epoch - 34ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 616s - 616s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092332
{'0': {'precision': 0.33090156644589813, 'recall': 0.4594590578094814, 'f1-score': 0.38472494018828657, 'support': 2826180}, '1': {'precision': 0.40890838311536876, 'recall': 0.29378728121052766, 'f1-score': 0.3419178123289007, 'support': 3879300}, '2': {'precision': 0.3147135619836722, 'recall': 0.3140571809783393, 'f1-score': 0.3143850288791679, 'support': 2800092}, 'accuracy': 0.3490155037487486, 'macro avg': {'precision': 0.3515078371816463, 'recall': 0.35576783999944944, 'f1-score': 0.3470092604654517, 'support': 9505572}, 'weighted avg': {'precision': 0.3579682113690268, 'recall': 0.3490155037487486, 'f1-score': 0.34653471722829127, 'support': 9505572}}
[[1298514  769251  758415]
 [1583163 1139689 1156448]
 [1042493  878210  879389]]
Evaluating performance on  train set...
12475/12475 - 205s - 205s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.098027
{'0': {'precision': 0.36085717233628134, 'recall': 0.4220496768535782, 'f1-score': 0.38906200177561595, 'support': 1085576}, '1': {'precision': 0.32474363748296875, 'recall': 0.29421232121936225, 'f1-score': 0.30872496836574526, 'support': 1034508}, '2': {'precision': 0.35164382755984236, 'recall': 0.3231891891891892, 'f1-score': 0.3368166070472918, 'support': 1073000}, 'accuracy': 0.34741146803529127, 'macro avg': {'precision': 0.3457482124596975, 'recall': 0.34648372908737657, 'f1-score': 0.34486785906288436, 'support': 3193084}, 'weighted avg': {'precision': 0.3460609253038983, 'recall': 0.34741146803529127, 'f1-score': 0.3454776136723683, 'support': 3193084}}
[[458167 306530 320879]
 [411630 304365 318513]
 [399866 326352 346782]]
Evaluating performance on  val set...
3866/3866 - 64s - 64s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976895
{'0': {'precision': 0.34375711402164183, 'recall': 0.4246491019760277, 'f1-score': 0.3799452600149292, 'support': 320036}, '1': {'precision': 0.33875191815856776, 'recall': 0.2952932153813227, 'f1-score': 0.31553319421019027, 'support': 336408}, '2': {'precision': 0.3504753730797123, 'recall': 0.31661147139963575, 'f1-score': 0.3326838910957996, 'support': 332758}, 'accuracy': 0.34431491242435824, 'macro avg': {'precision': 0.3443281350866407, 'recall': 0.345517929585662, 'f1-score': 0.3427207817736397, 'support': 989202}, 'weighted avg': {'precision': 0.34431490355071714, 'recall': 0.34431491242435824, 'f1-score': 0.34214172460756814, 'support': 989202}}
[[135903  91056  93077]
 [134895  99339 102174]
 [124548 102855 105355]]
testing model out of sample: results/universal/W7/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 246s - 246s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920954
{'0': {'precision': 0.33561497058618767, 'recall': 0.5360239684914062, 'f1-score': 0.4127802473099938, 'support': 1151178}, '1': {'precision': 0.3780635559311639, 'recall': 0.283159989413114, 'f1-score': 0.3238011509079394, 'support': 1428182}, '2': {'precision': 0.3624096129552262, 'recall': 0.26265417582362405, 'f1-score': 0.3045717890242127, 'support': 1194902}, 'accuracy': 0.35379340384954727, 'macro avg': {'precision': 0.3586960464908593, 'recall': 0.3606127112427147, 'f1-score': 0.34705106241404865, 'support': 3774262}, 'weighted avg': {'precision': 0.3601605048578434, 'recall': 0.35379340384954727, 'f1-score': 0.3448525710966638, 'support': 3774262}}
[[617059 295471 238648]
 [710274 404404 313504]
 [511259 369797 313846]]
Evaluating performance on  train set...
5285/5285 - 91s - 91s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095385
{'0': {'precision': 0.3679270645807881, 'recall': 0.47162362589425927, 'f1-score': 0.4133713383382178, 'support': 458480}, '1': {'precision': 0.32375155404482836, 'recall': 0.307426522938764, 'f1-score': 0.31537792006869786, 'support': 439627}, '2': {'precision': 0.3715139184261948, 'recall': 0.2840174330475493, 'f1-score': 0.3219264165340861, 'support': 454539}, 'accuracy': 0.35521488992685446, 'macro avg': {'precision': 0.3543975123506038, 'recall': 0.35435586062685753, 'f1-score': 0.3502252249803339, 'support': 1352646}, 'weighted avg': {'precision': 0.3547747821577779, 'recall': 0.35521488992685446, 'f1-score': 0.35079337203698124, 'support': 1352646}}
[[216230 133466 108784]
 [194866 135153 109608]
 [176602 148840 129097]]
Evaluating performance on  val set...
1714/1714 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945426
{'0': {'precision': 0.3575808590960106, 'recall': 0.48874246069100163, 'f1-score': 0.4129980703227422, 'support': 143415}, '1': {'precision': 0.33762206336136913, 'recall': 0.2971614729726984, 'f1-score': 0.3161023054755044, 'support': 147647}, '2': {'precision': 0.3770089504823266, 'recall': 0.2874561140897586, 'f1-score': 0.3261978203549355, 'support': 146972}, 'accuracy': 0.3566298506508627, 'macro avg': {'precision': 0.3574039576465688, 'recall': 0.3577866825844862, 'f1-score': 0.3517660653843941, 'support': 438034}, 'weighted avg': {'precision': 0.3573720377109058, 'recall': 0.3566298506508627, 'f1-score': 0.3512138815824421, 'support': 438034}}
[[70093 39635 33687]
 [67646 43875 36126]
 [58281 46443 42248]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994042
{'0': {'precision': 0.3417383820998279, 'recall': 0.4913127242519045, 'f1-score': 0.4030975151721688, 'support': 56577}, '1': {'precision': 0.3636129390311583, 'recall': 0.2969311449936875, 'f1-score': 0.3269062850829517, 'support': 61782}, '2': {'precision': 0.36330529784097804, 'recall': 0.281373289683539, 'f1-score': 0.31713293660179565, 'support': 59565}, 'accuracy': 0.3535329691328882, 'macro avg': {'precision': 0.35621887299065474, 'recall': 0.356539052976377, 'f1-score': 0.3490455789523054, 'support': 177924}, 'weighted avg': {'precision': 0.3565541866706169, 'recall': 0.3535329691328882, 'f1-score': 0.3478619837097675, 'support': 177924}}
[[27797 15360 13420]
 [27485 18345 15952]
 [26058 16747 16760]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988822
{'0': {'precision': 0.3601015651646644, 'recall': 0.386260162601626, 'f1-score': 0.37272245866593445, 'support': 24600}, '1': {'precision': 0.3344080474593758, 'recall': 0.32645096311217425, 'f1-score': 0.33038160157991975, 'support': 23829}, '2': {'precision': 0.3360182574842261, 'recall': 0.31862349896041076, 'f1-score': 0.3270897765387464, 'support': 23567}, 'accuracy': 0.34432468470470584, 'macro avg': {'precision': 0.34350929003608877, 'recall': 0.343778208224737, 'f1-score': 0.34339794559486686, 'support': 71996}, 'weighted avg': {'precision': 0.343714236069934, 'recall': 0.34432468470470584, 'f1-score': 0.3437713266142359, 'support': 71996}}
[[9502 7586 7512]
 [8724 7779 7326]
 [8161 7897 7509]]
Evaluating performance on  val set...
73/73 - 1s - 770ms/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023029
{'0': {'precision': 0.3419091967403958, 'recall': 0.4609227871939736, 'f1-score': 0.39259457291805916, 'support': 6372}, '1': {'precision': 0.3314917127071823, 'recall': 0.284559985947655, 'f1-score': 0.30623818525519847, 'support': 5693}, '2': {'precision': 0.36791890280262374, 'recall': 0.2872885301878007, 'f1-score': 0.32264249607808954, 'support': 6443}, 'accuracy': 0.34622865787767454, 'macro avg': {'precision': 0.3471066040834006, 'recall': 0.34425710110980984, 'f1-score': 0.34049175141711574, 'support': 18508}, 'weighted avg': {'precision': 0.347759304777885, 'recall': 0.34622865787767454, 'f1-score': 0.34167993351647113, 'support': 18508}}
[[2937 1704 1731]
 [2624 1620 1449]
 [3029 1563 1851]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931667
{'0': {'precision': 0.3704406779661017, 'recall': 0.554805300299538, 'f1-score': 0.4442547309795313, 'support': 177273}, '1': {'precision': 0.2975390734450922, 'recall': 0.2615570387547535, 'f1-score': 0.2783901989871605, 'support': 166457}, '2': {'precision': 0.3901461040560378, 'recall': 0.23349646226415094, 'f1-score': 0.29214726506161864, 'support': 169600}, 'accuracy': 0.35355619192332416, 'macro avg': {'precision': 0.35270861848907725, 'recall': 0.34995293377281417, 'f1-score': 0.3382640650094368, 'support': 513330}, 'weighted avg': {'precision': 0.3533114587135731, 'recall': 0.35355619192332416, 'f1-score': 0.34021495418578834, 'support': 513330}}
[[98352 48702 30219]
 [91236 43538 31683]
 [75912 54087 39601]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0898387
{'0': {'precision': 0.3899945637041064, 'recall': 0.6056918103004468, 'f1-score': 0.47447975479916116, 'support': 48561}, '1': {'precision': 0.3178613712194597, 'recall': 0.2691378838968377, 'f1-score': 0.2914774970390841, 'support': 43892}, '2': {'precision': 0.39717079426144103, 'recall': 0.2198340874811463, 'f1-score': 0.28301779034238556, 'support': 45084}, 'accuracy': 0.3718054050909937, 'macro avg': {'precision': 0.368342243061669, 'recall': 0.3648879272261436, 'f1-score': 0.34965834739354357, 'support': 137537}, 'weighted avg': {'precision': 0.3693271294421315, 'recall': 0.3718054050909937, 'f1-score': 0.353318130631304, 'support': 137537}}
[[29413 11690  7458]
 [24494 11813  7585]
 [21512 13661  9911]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940049
{'0': {'precision': 0.3796192105144709, 'recall': 0.631476489967056, 'f1-score': 0.47417985550839115, 'support': 13356}, '1': {'precision': 0.30648881757095575, 'recall': 0.2574123989218329, 'f1-score': 0.27981504372110055, 'support': 11872}, '2': {'precision': 0.43456718157971436, 'recall': 0.21574301837650123, 'f1-score': 0.28833881260877975, 'support': 13822}, 'accuracy': 0.3706017925736236, 'macro avg': {'precision': 0.37355840322171363, 'recall': 0.36821063575513, 'f1-score': 0.34744457061275713, 'support': 39050}, 'weighted avg': {'precision': 0.3768352625256971, 'recall': 0.3706017925736236, 'f1-score': 0.34930933206416215, 'support': 39050}}
[[8434 3001 1921]
 [6857 3056 1959]
 [6926 3914 2982]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968592
{'0': {'precision': 0.33176915439126237, 'recall': 0.631884358323403, 'f1-score': 0.4350936025614727, 'support': 77204}, '1': {'precision': 0.3147942916574312, 'recall': 0.22281355973112246, 'f1-score': 0.26093531382054075, 'support': 82863}, '2': {'precision': 0.3891231551531688, 'recall': 0.16114949022830583, 'f1-score': 0.22791246708435492, 'support': 77878}, 'accuracy': 0.3353590115362794, 'macro avg': {'precision': 0.34522886706728745, 'recall': 0.3386158027609438, 'f1-score': 0.30798046115545613, 'support': 237945}, 'weighted avg': {'precision': 0.3446293818413971, 'recall': 0.3353590115362794, 'f1-score': 0.3066347959102431, 'support': 237945}}
[[48784 18735  9685]
 [54383 18463 10017]
 [43875 21453 12550]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996896
{'0': {'precision': 0.3357773033074165, 'recall': 0.5152854625823003, 'f1-score': 0.406600241472249, 'support': 32351}, '1': {'precision': 0.30595459197210323, 'recall': 0.2510340538018971, 'f1-score': 0.27578666848884487, 'support': 32155}, '2': {'precision': 0.35790061418202124, 'recall': 0.23298500681508405, 'f1-score': 0.2822389784798283, 'support': 33015}, 'accuracy': 0.33258477661221686, 'macro avg': {'precision': 0.3332108364871803, 'recall': 0.3331015077330938, 'f1-score': 0.3215419628136407, 'support': 97521}, 'weighted avg': {'precision': 0.333433724237658, 'recall': 0.33258477661221686, 'f1-score': 0.3213663171177394, 'support': 97521}}
[[16670  8648  7033]
 [17316  8072  6767]
 [15660  9663  7692]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101178
{'0': {'precision': 0.3333788955713505, 'recall': 0.512610340479193, 'f1-score': 0.40400861354977635, 'support': 9516}, '1': {'precision': 0.3180286961946351, 'recall': 0.27025021204410515, 'f1-score': 0.2921992319596492, 'support': 9432}, '2': {'precision': 0.35754276827371695, 'recall': 0.22697206042057458, 'f1-score': 0.2776737725708074, 'support': 10129}, 'accuracy': 0.3344911785947656, 'macro avg': {'precision': 0.33631678667990084, 'recall': 0.3366108709812909, 'f1-score': 0.32462720602674433, 'support': 29077}, 'weighted avg': {'precision': 0.3368171039862864, 'recall': 0.3344911785947656, 'f1-score': 0.3237310164306081, 'support': 29077}}
[[4878 2524 2114]
 [4866 2549 2017]
 [4888 2942 2299]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1025499
{'0': {'precision': 0.29886292416509985, 'recall': 0.5279460787892061, 'f1-score': 0.3816685796711392, 'support': 82194}, '1': {'precision': 0.34821942964136543, 'recall': 0.40997297440517194, 'f1-score': 0.3765813388628476, 'support': 94355}, '2': {'precision': 0.3585034013605442, 'recall': 0.060444602006131005, 'f1-score': 0.10344766051607839, 'support': 95906}, 'accuracy': 0.32252665577801837, 'macro avg': {'precision': 0.3351952517223365, 'recall': 0.3327878850668363, 'f1-score': 0.2872325263500217, 'support': 272455}, 'weighted avg': {'precision': 0.33694962721741795, 'recall': 0.32252665577801837, 'f1-score': 0.28197115411847323, 'support': 272455}}
[[43394 33886  4914]
 [50213 38683  5459]
 [51590 38519  5797]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996441
{'0': {'precision': 0.34598058043326096, 'recall': 0.5443327497599819, 'f1-score': 0.4230613073487617, 'support': 35414}, '1': {'precision': 0.3300167447278375, 'recall': 0.40171924849344204, 'f1-score': 0.3623549474413461, 'support': 33852}, '2': {'precision': 0.3286615276804485, 'recall': 0.05622489959839357, 'f1-score': 0.09602293084915801, 'support': 33366}, 'accuracy': 0.33860784160885493, 'macro avg': {'precision': 0.33488628428051564, 'recall': 0.3340922992839392, 'f1-score': 0.29381306187975526, 'support': 102632}, 'weighted avg': {'precision': 0.335084609581574, 'recall': 0.33860784160885493, 'f1-score': 0.29671675432561484, 'support': 102632}}
[[19277 14218  1919]
 [18340 13599  1913]
 [18100 13390  1876]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1031708
{'0': {'precision': 0.3023241627523943, 'recall': 0.5256124721603563, 'f1-score': 0.38385872511811636, 'support': 9429}, '1': {'precision': 0.3393633540372671, 'recall': 0.4067181539034149, 'f1-score': 0.3700004232445931, 'support': 10747}, '2': {'precision': 0.3235294117647059, 'recall': 0.0608656849620705, 'f1-score': 0.10245624577480658, 'support': 11205}, 'accuracy': 0.31895095758580033, 'macro avg': {'precision': 0.3217389761847891, 'recall': 0.3310654370086139, 'f1-score': 0.2854384647125054, 'support': 31381}, 'weighted avg': {'precision': 0.32258052819395067, 'recall': 0.31895095758580033, 'f1-score': 0.27863422777014973, 'support': 31381}}
[[4956 3809  664]
 [5614 4371  762]
 [5823 4700  682]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
1646/1646 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949376
{'0': {'precision': 0.2748653932512916, 'recall': 0.5446146102962324, 'f1-score': 0.365343164888566, 'support': 111264}, '1': {'precision': 0.428932983188277, 'recall': 0.29119896585155663, 'f1-score': 0.346894319271871, 'support': 185660}, '2': {'precision': 0.31434111118539815, 'recall': 0.18903032301123343, 'f1-score': 0.2360880961706487, 'support': 124361}, 'accuracy': 0.3279680026585328, 'macro avg': {'precision': 0.33937982920832227, 'recall': 0.34161463305300743, 'f1-score': 0.31610852677702855, 'support': 421285}, 'weighted avg': {'precision': 0.35441588402524304, 'recall': 0.3279680026585328, 'f1-score': 0.3190573909397558, 'support': 421285}}
[[60596 31780 18888]
 [99207 54064 32389]
 [60654 40199 23508]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09859
{'0': {'precision': 0.3475464392569719, 'recall': 0.47834225187729845, 'f1-score': 0.40258729335013715, 'support': 45411}, '1': {'precision': 0.32474314703500023, 'recall': 0.3445819102978762, 'f1-score': 0.33436851866077016, 'support': 44213}, '2': {'precision': 0.3452451856263649, 'recall': 0.1933253290643899, 'f1-score': 0.24785849688573425, 'support': 44976}, 'accuracy': 0.3391679049034175, 'macro avg': {'precision': 0.33917825730611234, 'recall': 0.3387498304131882, 'f1-score': 0.3282714362988805, 'support': 134600}, 'weighted avg': {'precision': 0.3392871291358707, 'recall': 0.3391679049034175, 'f1-score': 0.32847704791830973, 'support': 134600}}
[[21722 15252  8437]
 [20925 15235  8053]
 [19854 16427  8695]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976917
{'0': {'precision': 0.32956004201190336, 'recall': 0.48129527055815935, 'f1-score': 0.3912305614241679, 'support': 11735}, '1': {'precision': 0.35190237986963774, 'recall': 0.35160923892464974, 'f1-score': 0.3517557483238002, 'support': 13205}, '2': {'precision': 0.3518175338560228, 'recall': 0.19891996453614894, 'f1-score': 0.2541447842652662, 'support': 12407}, 'accuracy': 0.3416338661739899, 'macro avg': {'precision': 0.34442665191252125, 'recall': 0.34394149133965274, 'f1-score': 0.33237703133774477, 'support': 37347}, 'weighted avg': {'precision': 0.34485388817682616, 'recall': 0.3416338661739899, 'f1-score': 0.3317321239539334, 'support': 37347}}
[[5648 4048 2039]
 [6054 4643 2508]
 [5436 4503 2468]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
5929/5929 - 57s - 57s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0772513
{'0': {'precision': 0.4197809327338804, 'recall': 0.644510852224531, 'f1-score': 0.50841953405568, 'support': 513996}, '1': {'precision': 0.3602202259933554, 'recall': 0.2841047654359684, 'f1-score': 0.3176666563378506, 'support': 523226}, '2': {'precision': 0.41895915019224556, 'recall': 0.27538820570790945, 'f1-score': 0.33233051917301126, 'support': 480351}, 'accuracy': 0.40341387201801826, 'macro avg': {'precision': 0.3996534363064938, 'recall': 0.40133460778946956, 'f1-score': 0.3861389031888473, 'support': 1517573}, 'weighted avg': {'precision': 0.39898558752763674, 'recall': 0.40341387201801826, 'f1-score': 0.38691539581343803, 'support': 1517573}}
[[331276 107083  75637]
 [266753 148651 107822]
 [191135 156933 132283]]
Evaluating performance on  train set...
1254/1254 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0872512
{'0': {'precision': 0.38852097130242824, 'recall': 0.5768414671112458, 'f1-score': 0.464312672984987, 'support': 105568}, '1': {'precision': 0.3286868618184703, 'recall': 0.27385606103525767, 'f1-score': 0.2987766875273635, 'support': 105906}, '2': {'precision': 0.40827203221434116, 'recall': 0.2833488592982264, 'f1-score': 0.3345283985227916, 'support': 109494}, 'accuracy': 0.37674783779068316, 'macro avg': {'precision': 0.3751599551117466, 'recall': 0.3780154624815766, 'f1-score': 0.3658725863450474, 'support': 320968}, 'weighted avg': {'precision': 0.37551603456256927, 'recall': 0.37674783779068316, 'f1-score': 0.36541853580047423, 'support': 320968}}
[[60896 24777 19895]
 [51832 29003 25071]
 [44010 34459 31025]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0875875
{'0': {'precision': 0.3777175788529229, 'recall': 0.61463948787062, 'f1-score': 0.4678963792587526, 'support': 35616}, '1': {'precision': 0.343267183959349, 'recall': 0.2690310254823346, 'f1-score': 0.3016488406824662, 'support': 37163}, '2': {'precision': 0.4023679334809526, 'recall': 0.24440052700922266, 'f1-score': 0.3040931678079268, 'support': 36432}, 'accuracy': 0.3735246449533472, 'macro avg': {'precision': 0.3744508987644082, 'recall': 0.37602368012072573, 'f1-score': 0.35787946258304854, 'support': 109211}, 'weighted avg': {'precision': 0.3742177637645023, 'recall': 0.3735246449533472, 'f1-score': 0.3566810632586518, 'support': 109211}}
[[21891  7998  5727]
 [19667  9998  7498]
 [16398 11130  8904]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
5331/5331 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0898355
{'0': {'precision': 0.3497516318141426, 'recall': 0.5194958729284522, 'f1-score': 0.41805016013532936, 'support': 421243}, '1': {'precision': 0.38328900795901205, 'recall': 0.3041155934833204, 'f1-score': 0.3391428101776151, 'support': 515600}, '2': {'precision': 0.3632309156949422, 'recall': 0.2800686361373003, 'f1-score': 0.3162743915236362, 'support': 427763}, 'accuracy': 0.36306377078805163, 'macro avg': {'precision': 0.36542385182269893, 'recall': 0.36789336751635765, 'f1-score': 0.35782245394552686, 'support': 1364606}, 'weighted avg': {'precision': 0.3666486775921893, 'recall': 0.36306377078805163, 'f1-score': 0.3563323179546257, 'support': 1364606}}
[[218834 112502  89907]
 [238682 156802 120116]
 [168168 139792 119803]]
Evaluating performance on  train set...
2013/2013 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.093308
{'0': {'precision': 0.38654516410107465, 'recall': 0.47740380573382285, 'f1-score': 0.42719683424154964, 'support': 178415}, '1': {'precision': 0.3213727086860497, 'recall': 0.3341190228215389, 'f1-score': 0.32762193701737313, 'support': 164187}, '2': {'precision': 0.38209092152807395, 'recall': 0.27490591164379596, 'f1-score': 0.31975512760505237, 'support': 172710}, 'accuracy': 0.36388246343962494, 'macro avg': {'precision': 0.3633362647717328, 'recall': 0.3621429133997192, 'f1-score': 0.358191299621325, 'support': 515312}, 'weighted avg': {'precision': 0.3642872656395414, 'recall': 0.36388246343962494, 'f1-score': 0.35946085913571996, 'support': 515312}}
[[85176 55128 38111]
 [70658 54858 38671]
 [64518 60713 47479]]
Evaluating performance on  val set...
696/696 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0908566
{'0': {'precision': 0.37664495956076965, 'recall': 0.5177951903061484, 'f1-score': 0.4360827240204672, 'support': 59089}, '1': {'precision': 0.3352671989583932, 'recall': 0.2929710375290712, 'f1-score': 0.3126953229637302, 'support': 59767}, '2': {'precision': 0.39162112932604737, 'recall': 0.2948047331268092, 'f1-score': 0.3363852349771108, 'support': 59073}, 'accuracy': 0.3682423888180117, 'macro avg': {'precision': 0.3678444292817367, 'recall': 0.3685236536540096, 'f1-score': 0.3617210939871027, 'support': 177929}, 'weighted avg': {'precision': 0.36771815537832625, 'recall': 0.3682423888180117, 'f1-score': 0.36153655915011895, 'support': 177929}}
[[30596 15749 12744]
 [27947 17510 14310]
 [22690 18968 17415]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
4192/4192 - 41s - 41s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945435
{'0': {'precision': 0.339314749301064, 'recall': 0.5293447158840917, 'f1-score': 0.41354403368129655, 'support': 338647}, '1': {'precision': 0.3548862672122608, 'recall': 0.28394715457810166, 'f1-score': 0.31547800204740484, 'support': 381490}, '2': {'precision': 0.36970711227223785, 'recall': 0.250945432604465, 'f1-score': 0.29896376641631245, 'support': 353013}, 'accuracy': 0.35052974887014865, 'macro avg': {'precision': 0.3546360429285209, 'recall': 0.3547457676888861, 'f1-score': 0.34266193404833795, 'support': 1073150}, 'weighted avg': {'precision': 0.35484778531418937, 'recall': 0.35052974887014865, 'f1-score': 0.3409917024172354, 'support': 1073150}}
[[179261  88112  71274]
 [193414 108323  79753]
 [155628 108798  88587]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095721
{'0': {'precision': 0.3697398649113395, 'recall': 0.49745511752729965, 'f1-score': 0.4241929247255826, 'support': 108060}, '1': {'precision': 0.32151467106834913, 'recall': 0.29286025164200363, 'f1-score': 0.30651924092306737, 'support': 101096}, '2': {'precision': 0.37568318366819564, 'recall': 0.27505179215029657, 'f1-score': 0.31758653457560104, 'support': 105711}, 'accuracy': 0.35709680595298965, 'macro avg': {'precision': 0.35564590654929473, 'recall': 0.35512238710653327, 'f1-score': 0.3494329000747503, 'support': 314867}, 'weighted avg': {'precision': 0.35625131251415293, 'recall': 0.35709680595298965, 'f1-score': 0.35061961648164536, 'support': 314867}}
[[53755 29757 24548]
 [47718 29607 23771]
 [43913 32722 29076]]
Evaluating performance on  val set...
400/400 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959878
{'0': {'precision': 0.3601151531012824, 'recall': 0.4830329978937515, 'f1-score': 0.41261432355440053, 'support': 34184}, '1': {'precision': 0.3312163826064416, 'recall': 0.3028471543270228, 'f1-score': 0.316397121411437, 'support': 33753}, '2': {'precision': 0.3673964983745251, 'recall': 0.273405619680541, 'f1-score': 0.313507912899614, 'support': 34308}, 'accuracy': 0.3532104259376987, 'macro avg': {'precision': 0.352909344694083, 'recall': 0.35309525730043845, 'f1-score': 0.3475064526218172, 'support': 102245}, 'weighted avg': {'precision': 0.35301835808071463, 'recall': 0.3532104259376987, 'f1-score': 0.34759635729027155, 'support': 102245}}
[[16512  9647  8025]
 [15405 10222  8126]
 [13935 10993  9380]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
6143/6143 - 57s - 57s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0917373
{'0': {'precision': 0.3419233622531555, 'recall': 0.538949039988451, 'f1-score': 0.4184017284842061, 'support': 484890}, '1': {'precision': 0.36838826447178086, 'recall': 0.2681077906219892, 'f1-score': 0.3103483922270265, 'support': 582277}, '2': {'precision': 0.3707157572730678, 'recall': 0.2820208376621449, 'f1-score': 0.32034229185843033, 'support': 505335}, 'accuracy': 0.3560943006749753, 'macro avg': {'precision': 0.36034246133266806, 'recall': 0.36302588942419506, 'f1-score': 0.3496974708565543, 'support': 1572502}, 'weighted avg': {'precision': 0.36097561707161796, 'recall': 0.3560943006749753, 'f1-score': 0.34687887008204943, 'support': 1572502}}
[[261331 116977 106582]
 [290829 156113 135335]
 [212137 150683 142515]]
Evaluating performance on  train set...
2083/2083 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0952262
{'0': {'precision': 0.3619356132610174, 'recall': 0.4671558724388446, 'f1-score': 0.4078689748861981, 'support': 177703}, '1': {'precision': 0.32827242524916944, 'recall': 0.2819228157472766, 'f1-score': 0.30333729351052824, 'support': 175243}, '2': {'precision': 0.3727674059196755, 'recall': 0.317105912764671, 'f1-score': 0.34269117329688514, 'support': 180271}, 'accuracy': 0.3555494292192484, 'macro avg': {'precision': 0.35432514814328747, 'recall': 0.3553948669835974, 'f1-score': 0.35129914723120387, 'support': 533217}, 'weighted avg': {'precision': 0.3545341613898443, 'recall': 0.3555494292192484, 'f1-score': 0.3514789631093352, 'support': 533217}}
[[83015 47124 47564]
 [77214 49405 48624]
 [69135 53971 57165]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095606
{'0': {'precision': 0.3492437926293371, 'recall': 0.4569246777066469, 'f1-score': 0.395892702977332, 'support': 56703}, '1': {'precision': 0.34066588538164494, 'recall': 0.2977665827036104, 'f1-score': 0.3177749303321655, 'support': 59550}, '2': {'precision': 0.3678682360634298, 'recall': 0.3055329260013578, 'f1-score': 0.33381545764723336, 'support': 58920}, 'accuracy': 0.35189783813715586, 'macro avg': {'precision': 0.35259263802480395, 'recall': 0.35340806213720505, 'f1-score': 0.34916103031891027, 'support': 175173}, 'weighted avg': {'precision': 0.3525921273072651, 'recall': 0.35189783813715586, 'f1-score': 0.34845671309379356, 'support': 175173}}
[[25909 15639 15155]
 [26039 17732 15779]
 [22238 18680 18002]]
testing model on single stock: results/universal/W7/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
23942/23942 - 240s - 240s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951564
{'0': {'precision': 0.2941420040176924, 'recall': 0.37672148745383793, 'f1-score': 0.3303492131704422, 'support': 1714070}, '1': {'precision': 0.4420674676616751, 'recall': 0.29521087254198214, 'f1-score': 0.3540131744946662, 'support': 2713772}, '2': {'precision': 0.2890708960711336, 'recall': 0.36048910724173566, 'f1-score': 0.3208538355895625, 'support': 1701222}, 'accuracy': 0.33612538554010857, 'macro avg': {'precision': 0.34176012258350036, 'recall': 0.3441404890791852, 'f1-score': 0.3350720744182236, 'support': 6129064}, 'weighted avg': {'precision': 0.3582315454094934, 'recall': 0.33612538554010857, 'f1-score': 0.33819133236056037, 'support': 6129064}}
[[645727 491753 576590]
 [980971 801135 931666]
 [568592 519358 613272]]
Evaluating performance on  train set...
9052/9052 - 70s - 70s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003022
{'0': {'precision': 0.35309587822193306, 'recall': 0.37468161980169373, 'f1-score': 0.3635686345257146, 'support': 787973}, '1': {'precision': 0.32455850946314163, 'recall': 0.29390526593772426, 'f1-score': 0.30847224633096104, 'support': 749762}, '2': {'precision': 0.342767828864843, 'recall': 0.35272568631350687, 'f1-score': 0.34767547085335077, 'support': 779345}, 'accuracy': 0.34115913132045506, 'macro avg': {'precision': 0.3401407388499726, 'recall': 0.3404375240176416, 'f1-score': 0.33990545057000876, 'support': 2317080}, 'weighted avg': {'precision': 0.3403879232520873, 'recall': 0.34115913132045506, 'f1-score': 0.34039488314556665, 'support': 2317080}}
[[295239 225969 266765]
 [269077 220359 260326]
 [271828 232622 274895]]
Evaluating performance on  val set...
2763/2763 - 27s - 27s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994447
{'0': {'precision': 0.33239103150376326, 'recall': 0.3691036750772694, 'f1-score': 0.3497866773328, 'support': 227451}, '1': {'precision': 0.33912973186307377, 'recall': 0.29365141452528687, 'f1-score': 0.3147562977739333, 'support': 242873}, '2': {'precision': 0.34187670543571197, 'recall': 0.35262098560704835, 'f1-score': 0.3471657354132481, 'support': 236991}, 'accuracy': 0.33767274835115896, 'macro avg': {'precision': 0.3377991562675163, 'recall': 0.33845869173653487, 'f1-score': 0.33723623683999376, 'support': 707315}, 'weighted avg': {'precision': 0.3378831640376036, 'recall': 0.33767274835115896, 'f1-score': 0.3368800190248931, 'support': 707315}}
[[83953 66666 76832]
 [87514 71320 84039]
 [81106 72317 83568]]
training model: results/universal/W7/deepVOL_L3/h50
Epoch 1/50
12475/12475 - 731s - loss: 3.2142 - accuracy50: 0.4022 - val_loss: 3.2369 - val_accuracy50: 0.3862 - 731s/epoch - 59ms/step
Epoch 2/50
12475/12475 - 704s - loss: 3.1419 - accuracy50: 0.4321 - val_loss: 3.2767 - val_accuracy50: 0.3958 - 704s/epoch - 56ms/step
Epoch 3/50
12475/12475 - 693s - loss: 3.1158 - accuracy50: 0.4413 - val_loss: 3.3200 - val_accuracy50: 0.3922 - 693s/epoch - 56ms/step
Epoch 4/50
12475/12475 - 682s - loss: 3.1010 - accuracy50: 0.4470 - val_loss: 3.2927 - val_accuracy50: 0.3966 - 682s/epoch - 55ms/step
Epoch 5/50
12475/12475 - 682s - loss: 3.0927 - accuracy50: 0.4498 - val_loss: 3.2814 - val_accuracy50: 0.3992 - 682s/epoch - 55ms/step
Epoch 6/50
12475/12475 - 673s - loss: 3.0868 - accuracy50: 0.4516 - val_loss: 3.2693 - val_accuracy50: 0.4015 - 673s/epoch - 54ms/step
Epoch 7/50
12475/12475 - 673s - loss: 3.0822 - accuracy50: 0.4531 - val_loss: 3.2449 - val_accuracy50: 0.4040 - 673s/epoch - 54ms/step
Epoch 8/50
12475/12475 - 676s - loss: 3.0788 - accuracy50: 0.4540 - val_loss: 3.2570 - val_accuracy50: 0.4055 - 676s/epoch - 54ms/step
Epoch 9/50
12475/12475 - 676s - loss: 3.0753 - accuracy50: 0.4551 - val_loss: 3.2369 - val_accuracy50: 0.4074 - 676s/epoch - 54ms/step
Epoch 10/50
12475/12475 - 682s - loss: 3.0727 - accuracy50: 0.4560 - val_loss: 3.2464 - val_accuracy50: 0.4088 - 682s/epoch - 55ms/step
Epoch 11/50
12475/12475 - 682s - loss: 3.0701 - accuracy50: 0.4571 - val_loss: 3.2456 - val_accuracy50: 0.4093 - 682s/epoch - 55ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 1143s - 1143s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772136
{'0': {'precision': 0.32132802586964176, 'recall': 0.6104992844328878, 'f1-score': 0.4210448174092676, 'support': 2480550}, '1': {'precision': 0.5806285422323988, 'recall': 0.269876173088091, 'f1-score': 0.3684819287670838, 'support': 4547719}, '2': {'precision': 0.3270803439579653, 'recall': 0.35370158595860096, 'f1-score': 0.3398704675019661, 'support': 2477303}, 'accuracy': 0.380610551369239, 'macro avg': {'precision': 0.4096789706866686, 'recall': 0.4113590144931933, 'f1-score': 0.3764657378927725, 'support': 9505572}, 'weighted avg': {'precision': 0.44688344955481074, 'recall': 0.380610551369239, 'f1-score': 0.37474200597179164, 'support': 9505572}}
[[1514374  384841  581335]
 [2099027 1227321 1221371]
 [1099459  501618  876226]]
Evaluating performance on  train set...
12475/12475 - 393s - 393s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0802785
{'0': {'precision': 0.3697877495152018, 'recall': 0.6349606326674746, 'f1-score': 0.46738201832140763, 'support': 1032201}, '1': {'precision': 0.4985274563262945, 'recall': 0.24731156455919456, 'f1-score': 0.3306118391429691, 'support': 1143044}, '2': {'precision': 0.3757343457689384, 'recall': 0.31512449414887816, 'f1-score': 0.3427707334797407, 'support': 1017839}, 'accuracy': 0.39423986340478356, 'macro avg': {'precision': 0.41468318387014486, 'recall': 0.3991322304585158, 'f1-score': 0.3802548636480392, 'support': 3193084}, 'weighted avg': {'precision': 0.41776889470790135, 'recall': 0.39423986340478356, 'f1-score': 0.37870018024862395, 'support': 3193084}}
[[655407 126032 250762]
 [578213 282688 282143]
 [538767 158326 320746]]
Evaluating performance on  val set...
3866/3866 - 120s - 120s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0823948
{'0': {'precision': 0.3564113464566498, 'recall': 0.6375028963608653, 'f1-score': 0.4572089942446009, 'support': 306419}, '1': {'precision': 0.5043967460105704, 'recall': 0.23939893625620381, 'f1-score': 0.3246914369764021, 'support': 371142}, '2': {'precision': 0.3709909950710657, 'recall': 0.31542704586367004, 'f1-score': 0.340960134025428, 'support': 311641}, 'accuracy': 0.38666925461129276, 'macro avg': {'precision': 0.4105996958460953, 'recall': 0.3974429594935797, 'f1-score': 0.37428685508214365, 'support': 989202}, 'weighted avg': {'precision': 0.41652769623666075, 'recall': 0.38666925461129276, 'f1-score': 0.37086591943561636, 'support': 989202}}
[[195343  37673  73403]
 [189028  88851  93263]
 [163712  49629  98300]]
testing model out of sample: results/universal/W7/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 463s - 463s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.024302
{'0': {'precision': 0.3803730445913521, 'recall': 0.536398392582593, 'f1-score': 0.4451087401446518, 'support': 1023754}, '1': {'precision': 0.5616177255831716, 'recall': 0.5705225954814889, 'f1-score': 0.5660351398257842, 'support': 1708970}, '2': {'precision': 0.43217994069035354, 'recall': 0.246687110791925, 'f1-score': 0.314091605059763, 'support': 1041538}, 'accuracy': 0.4719015267090626, 'macro avg': {'precision': 0.45805690362162577, 'recall': 0.45120269961866893, 'f1-score': 0.441745161676733, 'support': 3774262}, 'weighted avg': {'precision': 0.47673640607069606, 'recall': 0.4719015267090626, 'f1-score': 0.46370847286617983, 'support': 3774262}}
[[549140 325444 149170]
 [545561 975006 188403]
 [348987 435617 256934]]
Evaluating performance on  train set...
5285/5285 - 169s - 169s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0462378
{'0': {'precision': 0.391956183270165, 'recall': 0.5510052866206332, 'f1-score': 0.45806734633710455, 'support': 410281}, '1': {'precision': 0.5208078347474132, 'recall': 0.4909689757756056, 'f1-score': 0.5054484082703355, 'support': 536484}, '2': {'precision': 0.4238134548537202, 'recall': 0.2820678967480616, 'f1-score': 0.3387089616487232, 'support': 405881}, 'accuracy': 0.44649523970055727, 'macro avg': {'precision': 0.4455258242904328, 'recall': 0.44134738638143345, 'f1-score': 0.4340749054187211, 'support': 1352646}, 'weighted avg': {'precision': 0.4526203264670732, 'recall': 0.44649523970055727, 'f1-score': 0.4410443270803904, 'support': 1352646}}
[[226067 107049  77165]
 [194605 263397  78482]
 [156094 135301 114486]]
Evaluating performance on  val set...
1714/1714 - 54s - 54s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0323976
{'0': {'precision': 0.40005238802060594, 'recall': 0.535774423898469, 'f1-score': 0.4580715897237654, 'support': 128276}, '1': {'precision': 0.5437017994858612, 'recall': 0.5523048664438888, 'f1-score': 0.5479695682244837, 'support': 180748}, '2': {'precision': 0.43012912829325556, 'recall': 0.27549802340903806, 'f1-score': 0.3358706488818329, 'support': 129010}, 'accuracy': 0.4659387170858883, 'macro avg': {'precision': 0.4579611052665742, 'recall': 0.4545257712504653, 'f1-score': 0.4473039356100273, 'support': 438034}, 'weighted avg': {'precision': 0.4681853276693466, 'recall': 0.4659387170858883, 'f1-score': 0.45917592509506105, 'support': 438034}}
[[68727 36273 23276]
 [57107 99828 23813]
 [45961 47507 35542]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0862281
{'0': {'precision': 0.3451487682165163, 'recall': 0.589441131809933, 'f1-score': 0.4353671713648736, 'support': 54002}, '1': {'precision': 0.4920943742635574, 'recall': 0.2626129683249978, 'f1-score': 0.3424648390941597, 'support': 68382}, '2': {'precision': 0.34988924340032923, 'recall': 0.3099927979834354, 'f1-score': 0.32873495183632945, 'support': 55540}, 'accuracy': 0.3765989973247004, 'macro avg': {'precision': 0.3957107952934676, 'recall': 0.38734896603945534, 'f1-score': 0.3688556540984542, 'support': 177924}, 'weighted avg': {'precision': 0.403104526992273, 'recall': 0.3765989973247004, 'f1-score': 0.3663759124118864, 'support': 177924}}
[[31831  7871 14300]
 [32734 17958 17690]
 [27659 10664 17217]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0982798
{'0': {'precision': 0.37133305080755286, 'recall': 0.6400714256726594, 'f1-score': 0.46999925501005735, 'support': 24641}, '1': {'precision': 0.39251904871854076, 'recall': 0.14261146763978022, 'f1-score': 0.20921145740393196, 'support': 23841}, '2': {'precision': 0.35091083413231067, 'recall': 0.31130390405715747, 'f1-score': 0.32992292784062743, 'support': 23514}, 'accuracy': 0.3679648869381632, 'macro avg': {'precision': 0.3715876445528014, 'recall': 0.3646622657898657, 'f1-score': 0.33637788008487224, 'support': 71996}, 'weighted avg': {'precision': 0.3716787279742596, 'recall': 0.3679648869381632, 'f1-score': 0.3378919623856115, 'support': 71996}}
[[15772  2482  6387]
 [13288  3400  7153]
 [13414  2780  7320]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0862541
{'0': {'precision': 0.37571541780399753, 'recall': 0.6702796104304115, 'f1-score': 0.48152118715793035, 'support': 6366}, '1': {'precision': 0.45782178217821784, 'recall': 0.20551111111111112, 'f1-score': 0.28368098159509203, 'support': 5625}, '2': {'precision': 0.383916990920882, 'recall': 0.2725180297682983, 'f1-score': 0.31876514403661493, 'support': 6517}, 'accuracy': 0.38896693321806786, 'macro avg': {'precision': 0.4058180636343658, 'recall': 0.3827695837699403, 'f1-score': 0.36132243759654575, 'support': 18508}, 'weighted avg': {'precision': 0.4035573213920527, 'recall': 0.38896693321806786, 'f1-score': 0.3640837390645341, 'support': 18508}}
[[4267  600 1499]
 [3118 1156 1351]
 [3972  769 1776]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
2006/2006 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9516504
{'0': {'precision': 0.36128847939432895, 'recall': 0.45912828798083033, 'f1-score': 0.4043743804559844, 'support': 110174}, '1': {'precision': 0.6379611729159672, 'recall': 0.7431796420913517, 'f1-score': 0.6865625155728311, 'support': 296612}, '2': {'precision': 0.509788397869584, 'recall': 0.13295915302597988, 'f1-score': 0.21091028198791056, 'support': 106544}, 'accuracy': 0.555560750394483, 'macro avg': {'precision': 0.5030126833932934, 'recall': 0.4450890276993873, 'f1-score': 0.43394905933890865, 'support': 513330}, 'weighted avg': {'precision': 0.5519771519536333, 'recall': 0.555560750394483, 'f1-score': 0.5272737789444726, 'support': 513330}}
[[ 50584  55229   4361]
 [ 66915 220436   9261]
 [ 22511  69867  14166]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93309015
{'0': {'precision': 0.42167385453484224, 'recall': 0.42801658876966625, 'f1-score': 0.4248215481615785, 'support': 30382}, '1': {'precision': 0.6461693960060441, 'recall': 0.809793108742659, 'f1-score': 0.7187870872490842, 'support': 78157}, '2': {'precision': 0.5108571428571429, 'recall': 0.15414856196979101, 'f1-score': 0.23683373953586945, 'support': 28998}, 'accuracy': 0.5872238015952072, 'macro avg': {'precision': 0.5262334644660097, 'recall': 0.4639860864940388, 'f1-score': 0.46014745831551074, 'support': 137537}, 'weighted avg': {'precision': 0.5680492664569782, 'recall': 0.5872238015952072, 'f1-score': 0.5522359469337916, 'support': 137537}}
[[13004 15795  1583]
 [12169 63291  2697]
 [ 5666 18862  4470]]
Evaluating performance on  val set...
153/153 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9606274
{'0': {'precision': 0.42618246586186426, 'recall': 0.4725178277564454, 'f1-score': 0.448155663076843, 'support': 9115}, '1': {'precision': 0.6142300420573369, 'recall': 0.767254675149412, 'f1-score': 0.6822672238294225, 'support': 20748}, '2': {'precision': 0.5133795837462835, 'recall': 0.16915206269728963, 'f1-score': 0.2544620926805305, 'support': 9187}, 'accuracy': 0.5577464788732395, 'macro avg': {'precision': 0.5179306972218282, 'recall': 0.4696415218677157, 'f1-score': 0.46162832652893204, 'support': 39050}, 'weighted avg': {'precision': 0.5466098930810147, 'recall': 0.5577464788732395, 'f1-score': 0.5269747112526073, 'support': 39050}}
[[ 4307  4166   642]
 [ 3998 15919   831]
 [ 1801  5832  1554]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077832
{'0': {'precision': 0.3321222075670474, 'recall': 0.5561466870398667, 'f1-score': 0.4158845740343514, 'support': 71990}, '1': {'precision': 0.3918861795852986, 'recall': 0.3886608856821341, 'f1-score': 0.3902668690248036, 'support': 90642}, '2': {'precision': 0.3934909090909091, 'recall': 0.14368037390623134, 'f1-score': 0.21049867234688222, 'support': 75313}, 'accuracy': 0.36179369181953813, 'macro avg': {'precision': 0.37249976541441837, 'recall': 0.362829315542744, 'f1-score': 0.3388833718020124, 'support': 237945}, 'weighted avg': {'precision': 0.37431257496096165, 'recall': 0.36179369181953813, 'f1-score': 0.3411182690846202, 'support': 237945}}
[[40037 24864  7089]
 [45823 35229  9590]
 [34689 29803 10821]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1018071
{'0': {'precision': 0.3749721575377139, 'recall': 0.5724442795758756, 'f1-score': 0.4531284410404483, 'support': 32349}, '1': {'precision': 0.3703054318476698, 'recall': 0.32524331649624244, 'f1-score': 0.34631466754119866, 'support': 32468}, '2': {'precision': 0.4003262143840155, 'recall': 0.2401541095890411, 'f1-score': 0.3002121437990941, 'support': 32704}, 'accuracy': 0.3787081756749828, 'macro avg': {'precision': 0.38186793458979973, 'recall': 0.3792805685537197, 'f1-score': 0.3665517507935803, 'support': 97521}, 'weighted avg': {'precision': 0.38192101804362644, 'recall': 0.3787081756749828, 'f1-score': 0.36628556429641485, 'support': 97521}}
[[18518  8064  5767]
 [15910 10560  5998]
 [14957  9893  7854]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1056871
{'0': {'precision': 0.3686588356783271, 'recall': 0.5977396400167434, 'f1-score': 0.4560479041916167, 'support': 9556}, '1': {'precision': 0.37330567081604427, 'recall': 0.2805321692131795, 'f1-score': 0.3203370719838586, 'support': 9621}, '2': {'precision': 0.39823705336061704, 'recall': 0.25555555555555554, 'f1-score': 0.31132713960499603, 'support': 9900}, 'accuracy': 0.37627678233655465, 'macro avg': {'precision': 0.38006718661832944, 'recall': 0.3779424549284928, 'f1-score': 0.36257070526015706, 'support': 29077}, 'weighted avg': {'precision': 0.3802670330822768, 'recall': 0.37627678233655465, 'f1-score': 0.36187004932081207, 'support': 29077}}
[[5712 2001 1843]
 [4942 2699 1980]
 [4840 2530 2530]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1065/1065 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1271888
{'0': {'precision': 0.31252011337156327, 'recall': 0.9435638696385091, 'f1-score': 0.4695270244686708, 'support': 85424}, '1': {'precision': 0.3574383330779838, 'recall': 0.02448958169317168, 'f1-score': 0.04583857277585665, 'support': 95265}, '2': {'precision': 0.35508421709295074, 'recall': 0.03101366519190114, 'f1-score': 0.057044928393181066, 'support': 91766}, 'accuracy': 0.31484832357637044, 'macro avg': {'precision': 0.3416808878474993, 'recall': 0.33302237217452735, 'f1-score': 0.19080350854590286, 'support': 272455}, 'weighted avg': {'precision': 0.3425620349455076, 'recall': 0.31484832357637044, 'f1-score': 0.18245388439423896, 'support': 272455}}
[[80603  2101  2720]
 [90483  2333  2449]
 [86827  2093  2846]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1159519
{'0': {'precision': 0.34587236685471767, 'recall': 0.9400461399954986, 'f1-score': 0.505686762669411, 'support': 35544}, '1': {'precision': 0.30602498163115355, 'recall': 0.024497838426021233, 'f1-score': 0.0453641933287951, 'support': 34003}, '2': {'precision': 0.31860816944024206, 'recall': 0.03182711198428291, 'f1-score': 0.05787304204451773, 'support': 33085}, 'accuracy': 0.3439375633330735, 'macro avg': {'precision': 0.3235018393087044, 'recall': 0.33212369680193427, 'f1-score': 0.2029746660142413, 'support': 102632}, 'weighted avg': {'precision': 0.3238815003490004, 'recall': 0.3439375633330735, 'f1-score': 0.20881770358293156, 'support': 102632}}
[[33413   986  1145]
 [32063   833  1107]
 [31129   903  1053]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1299549
{'0': {'precision': 0.3138261927287471, 'recall': 0.9329984932194877, 'f1-score': 0.4696720689742358, 'support': 9955}, '1': {'precision': 0.2857142857142857, 'recall': 0.019339091250469394, 'f1-score': 0.03622614965268619, 'support': 10652}, '2': {'precision': 0.3101503759398496, 'recall': 0.03062929274178578, 'f1-score': 0.055752660922453116, 'support': 10774}, 'accuracy': 0.3130556706287244, 'macro avg': {'precision': 0.30323028479429415, 'recall': 0.32765562573724766, 'f1-score': 0.1872169598497917, 'support': 31381}, 'weighted avg': {'precision': 0.30302184348552275, 'recall': 0.3130556706287244, 'f1-score': 0.1804322858263739, 'support': 31381}}
[[ 9288   272   395]
 [10107   206   339]
 [10201   243   330]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
1646/1646 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1054544
{'0': {'precision': 0.31731851073993217, 'recall': 0.6590549437935077, 'f1-score': 0.4283818497713634, 'support': 121961}, '1': {'precision': 0.4406256214685961, 'recall': 0.22095383351909426, 'f1-score': 0.294319660250124, 'support': 170470}, '2': {'precision': 0.34963331110976426, 'recall': 0.22384248839772145, 'f1-score': 0.2729419112463271, 'support': 128854}, 'accuracy': 0.34866657963136594, 'macro avg': {'precision': 0.36919248110609754, 'recall': 0.3679504219034411, 'f1-score': 0.3318811404226048, 'support': 421285}, 'weighted avg': {'precision': 0.3770976494530829, 'recall': 0.34866657963136594, 'f1-score': 0.3265917568737034, 'support': 421285}}
[[80379 21634 19948]
 [99100 37666 33704]
 [73828 26183 28843]]
Evaluating performance on  train set...
526/526 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1019061
{'0': {'precision': 0.36427401507858115, 'recall': 0.6415140038752862, 'f1-score': 0.4646841630980008, 'support': 45416}, '1': {'precision': 0.37054904663450494, 'recall': 0.1817260027039207, 'f1-score': 0.24385819033940587, 'support': 44380}, '2': {'precision': 0.3633347537590552, 'recall': 0.26642710472279263, 'f1-score': 0.30742486286023335, 'support': 44804}, 'accuracy': 0.3650594353640416, 'macro avg': {'precision': 0.3660526051573805, 'recall': 0.36322237043399985, 'f1-score': 0.33865573876588, 'support': 134600}, 'weighted avg': {'precision': 0.36603035412978363, 'recall': 0.3650594353640416, 'f1-score': 0.33952738480023426, 'support': 134600}}
[[29135  6354  9927]
 [25325  8065 10990]
 [25521  7346 11937]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003323
{'0': {'precision': 0.36055563324476764, 'recall': 0.636992505970518, 'f1-score': 0.4604714847005596, 'support': 12143}, '1': {'precision': 0.37949167397020156, 'recall': 0.20655112100492923, 'f1-score': 0.2675041186161449, 'support': 12578}, '2': {'precision': 0.3664898320070734, 'recall': 0.2626326627593854, 'f1-score': 0.3059887422718464, 'support': 12626}, 'accuracy': 0.36546442820039093, 'macro avg': {'precision': 0.3688457130740142, 'recall': 0.3687254299116109, 'f1-score': 0.3446547818628503, 'support': 37347}, 'weighted avg': {'precision': 0.36893924407876716, 'recall': 0.36546442820039093, 'f1-score': 0.34325610899395126, 'support': 37347}}
[[7735 1851 2557]
 [6805 2598 3175]
 [6913 2397 3316]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
5929/5929 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9203597
{'0': {'precision': 0.46577212557310593, 'recall': 0.48392837024690255, 'f1-score': 0.47467669360414383, 'support': 346169}, '1': {'precision': 0.6345841343665615, 'recall': 0.7591683778727825, 'f1-score': 0.6913081105580617, 'support': 831772}, '2': {'precision': 0.5374690649160838, 'recall': 0.25769656569463417, 'f1-score': 0.34836498677540884, 'support': 339632}, 'accuracy': 0.5841550950102565, 'macro avg': {'precision': 0.5459417749519171, 'recall': 0.5002644379381064, 'f1-score': 0.5047832636458714, 'support': 1517573}, 'weighted avg': {'precision': 0.5743426372263077, 'recall': 0.5841550950102565, 'f1-score': 0.5651424895355008, 'support': 1517573}}
[[167521 156292  22356]
 [147354 631455  52963]
 [ 44788 207322  87522]]
Evaluating performance on  train set...
1254/1254 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96667504
{'0': {'precision': 0.4749495628782784, 'recall': 0.4830475352972788, 'f1-score': 0.4789643229103591, 'support': 81876}, '1': {'precision': 0.5726381941521383, 'recall': 0.7501314355324742, 'f1-score': 0.6494765240754515, 'support': 155970}, '2': {'precision': 0.5480498472230544, 'recall': 0.2200981689564736, 'f1-score': 0.3140664698207787, 'support': 83122}, 'accuracy': 0.5447365469454899, 'macro avg': {'precision': 0.5318792014178236, 'recall': 0.4844257132620755, 'f1-score': 0.48083577226886315, 'support': 320968}, 'weighted avg': {'precision': 0.5413510036919744, 'recall': 0.5447365469454899, 'f1-score': 0.5191183216616595, 'support': 320968}}
[[ 39550  36065   6261]
 [ 30146 116998   8826]
 [ 13576  51251  18295]]
Evaluating performance on  val set...
427/427 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9734695
{'0': {'precision': 0.44593046759196875, 'recall': 0.4845168374816984, 'f1-score': 0.4644235492246158, 'support': 27320}, '1': {'precision': 0.5649693399917481, 'recall': 0.7316713651355186, 'f1-score': 0.6376043673731535, 'support': 54273}, '2': {'precision': 0.5550865800865801, 'recall': 0.1857122166702875, 'f1-score': 0.2783113571002225, 'support': 27618}, 'accuracy': 0.5317779344571517, 'macro avg': {'precision': 0.5219954625567657, 'recall': 0.46730013976250157, 'f1-score': 0.4601130912326639, 'support': 109211}, 'weighted avg': {'precision': 0.5326916018790772, 'recall': 0.5317779344571517, 'f1-score': 0.5034214159347832, 'support': 109211}}
[[13237 12485  1598]
 [12050 39710  2513]
 [ 4397 18092  5129]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
5331/5331 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9657694
{'0': {'precision': 0.3764714060617295, 'recall': 0.4880819261182895, 'f1-score': 0.42507242100550735, 'support': 299587}, '1': {'precision': 0.6481517530768066, 'recall': 0.7090027209274814, 'f1-score': 0.6772130443625846, 'support': 760770}, '2': {'precision': 0.46363396477973445, 'recall': 0.219448543791434, 'f1-score': 0.29789607301168747, 'support': 304249}, 'accuracy': 0.5513518187667356, 'macro avg': {'precision': 0.4960857079727569, 'recall': 0.47217773027906834, 'f1-score': 0.4667271794599264, 'support': 1364606}, 'weighted avg': {'precision': 0.5473671656627093, 'recall': 0.5513518187667356, 'f1-score': 0.5372863093590629, 'support': 1364606}}
[[146223 124499  28865]
 [173006 539388  48376]
 [ 69175 168307  66767]]
Evaluating performance on  train set...
2013/2013 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0092711
{'0': {'precision': 0.3675908397266811, 'recall': 0.5383463381666257, 'f1-score': 0.43687617053234484, 'support': 130208}, '1': {'precision': 0.5914247309842615, 'recall': 0.621474692287395, 'f1-score': 0.6060774630565173, 'support': 257708}, '2': {'precision': 0.44039987364587396, 'recall': 0.1860419479418506, 'f1-score': 0.2615816746039191, 'support': 127396}, 'accuracy': 0.49282182444810135, 'macro avg': {'precision': 0.4664718147856055, 'recall': 0.4486209927986238, 'f1-score': 0.434845102730927, 'support': 515312}, 'weighted avg': {'precision': 0.4975303019037273, 'recall': 0.49282182444810135, 'f1-score': 0.4781573925697158, 'support': 515312}}
[[ 70097  48229  11882]
 [ 79315 160159  18234]
 [ 41281  62414  23701]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9848948
{'0': {'precision': 0.3943165003604356, 'recall': 0.48517809626067876, 'f1-score': 0.4350537904474863, 'support': 42842}, '1': {'precision': 0.6043362921214235, 'recall': 0.7079551808679944, 'f1-score': 0.6520548487894738, 'support': 92996}, '2': {'precision': 0.4694604891237557, 'recall': 0.18151148701622674, 'f1-score': 0.261800736742911, 'support': 42091}, 'accuracy': 0.5297787319661214, 'macro avg': {'precision': 0.4893710938685383, 'recall': 0.4582149213816333, 'f1-score': 0.44963645865995705, 'support': 177929}, 'weighted avg': {'precision': 0.5218611175147034, 'recall': 0.5297787319661214, 'f1-score': 0.5074862558583648, 'support': 177929}}
[[20786 18693  3363]
 [21888 65837  5271]
 [10040 24411  7640]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
4192/4192 - 62s - 62s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0472692
{'0': {'precision': 0.39642187991484357, 'recall': 0.5363053553752648, 'f1-score': 0.45587427737142094, 'support': 324291}, '1': {'precision': 0.4945004207008243, 'recall': 0.4986493161498302, 'f1-score': 0.49656620239400884, 'support': 423119}, '2': {'precision': 0.4304795460124471, 'recall': 0.2745625345367471, 'f1-score': 0.3352808533849173, 'support': 325740}, 'accuracy': 0.44200997064716024, 'macro avg': {'precision': 0.44046728220937165, 'recall': 0.4365057353539474, 'f1-score': 0.42924044438344905, 'support': 1073150}, 'weighted avg': {'precision': 0.4454297895765467, 'recall': 0.44200997064716024, 'f1-score': 0.43531370773462147, 'support': 1073150}}
[[173919  92563  57809]
 [151617 210988  60514]
 [113186 123118  89436]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0639933
{'0': {'precision': 0.41958340327905547, 'recall': 0.5652165719723737, 'f1-score': 0.48163180101084313, 'support': 106131}, '1': {'precision': 0.43638698093905925, 'recall': 0.40242775456768254, 'f1-score': 0.41871995192307687, 'support': 103882}, '2': {'precision': 0.438312242940303, 'recall': 0.31811852671333474, 'f1-score': 0.36866624298858836, 'support': 104854}, 'accuracy': 0.4292224971178307, 'macro avg': {'precision': 0.4314275423861393, 'recall': 0.42858761775113036, 'f1-score': 0.4230059986408361, 'support': 314867}, 'weighted avg': {'precision': 0.43136419646575647, 'recall': 0.4292224971178307, 'f1-score': 0.42325699727529503, 'support': 314867}}
[[59987 24105 22039]
 [41371 41805 20706]
 [41610 29888 33356]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0634313
{'0': {'precision': 0.4133490464966788, 'recall': 0.5634053738317757, 'f1-score': 0.47685082190087746, 'support': 34240}, '1': {'precision': 0.44946996466431094, 'recall': 0.3754981549815498, 'f1-score': 0.409167671893848, 'support': 33875}, '2': {'precision': 0.4257378551787351, 'recall': 0.3402285379431585, 'f1-score': 0.3782102434655158, 'support': 34130}, 'accuracy': 0.4266516700083134, 'macro avg': {'precision': 0.42951895544657487, 'recall': 0.42637735558549467, 'f1-score': 0.42140957908674714, 'support': 102245}, 'weighted avg': {'precision': 0.4294518010885622, 'recall': 0.4266516700083134, 'f1-score': 0.4214997568269177, 'support': 102245}}
[[19291  6952  7997]
 [13489 12720  7666]
 [13890  8628 11612]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
6143/6143 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0337806
{'0': {'precision': 0.42481034041203575, 'recall': 0.5259652173182645, 'f1-score': 0.4700067459606332, 'support': 476214}, '1': {'precision': 0.4979750526486311, 'recall': 0.5564646213225668, 'f1-score': 0.5255976343465524, 'support': 618706}, '2': {'precision': 0.4568515729785913, 'recall': 0.2788631062309719, 'f1-score': 0.3463273258709217, 'support': 477582}, 'accuracy': 0.46291833015156736, 'macro avg': {'precision': 0.45987898867975274, 'recall': 0.4537643149572677, 'f1-score': 0.44731056872603575, 'support': 1572502}, 'weighted avg': {'precision': 0.46332842330201346, 'recall': 0.46291833015156736, 'f1-score': 0.45431668730532715, 'support': 1572502}}
[[250472 146518  79224]
 [195305 344288  79113]
 [143832 200570 133180]]
Evaluating performance on  train set...
2083/2083 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.050679
{'0': {'precision': 0.43245064727191035, 'recall': 0.5200740711555888, 'f1-score': 0.47223208878372125, 'support': 177667}, '1': {'precision': 0.4608144230222374, 'recall': 0.45497425415667625, 'f1-score': 0.457875716622824, 'support': 178087}, '2': {'precision': 0.4449941205530159, 'recall': 0.3603849816581485, 'f1-score': 0.3982452426023712, 'support': 177463}, 'accuracy': 0.44518460589216025, 'macro avg': {'precision': 0.44608639694905455, 'recall': 0.44514443565680456, 'f1-score': 0.4427843493363055, 'support': 533217}, 'weighted avg': {'precision': 0.4460984156868959, 'recall': 0.44518460589216025, 'f1-score': 0.44281327630606465, 'support': 533217}}
[[92400 41735 43532]
 [60828 81025 36234]
 [60438 53070 63955]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0486537
{'0': {'precision': 0.4259734762979684, 'recall': 0.5262946887691959, 'f1-score': 0.4708496752411325, 'support': 57369}, '1': {'precision': 0.47262317415972543, 'recall': 0.4573154452009078, 'f1-score': 0.46484331934020273, 'support': 59928}, '2': {'precision': 0.43802099080032825, 'recall': 0.35045614762595895, 'f1-score': 0.389376283811023, 'support': 57876}, 'accuracy': 0.4446004806676828, 'macro avg': {'precision': 0.4455392137526741, 'recall': 0.4446887605320209, 'f1-score': 0.4416897594641194, 'support': 175173}, 'weighted avg': {'precision': 0.4459131076498203, 'recall': 0.4446004806676828, 'f1-score': 0.4418765863584854, 'support': 175173}}
[[30193 13196 13980]
 [20479 27406 12043]
 [20208 17385 20283]]
testing model on single stock: results/universal/W7/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
23942/23942 - 354s - 354s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1295576
{'0': {'precision': 0.2962935162336545, 'recall': 0.6454637124247131, 'f1-score': 0.4061486487934852, 'support': 1614492}, '1': {'precision': 0.47746961707044594, 'recall': 0.05583789591758013, 'f1-score': 0.09998321093363258, 'support': 2900951}, '2': {'precision': 0.3002155142068655, 'recall': 0.42283844843367807, 'f1-score': 0.3511291515763607, 'support': 1613621}, 'accuracy': 0.3077761955169664, 'macro avg': {'precision': 0.3579928825036553, 'recall': 0.37471335225865715, 'f1-score': 0.28575367043449285, 'support': 6129064}, 'weighted avg': {'precision': 0.38307864511958584, 'recall': 0.3077761955169664, 'f1-score': 0.24675211626519525, 'support': 6129064}}
[[1042096   78317  494079]
 [1642644  161983 1096324]
 [ 832367   98953  682301]]
Evaluating performance on  train set...
9052/9052 - 136s - 136s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1053704
{'0': {'precision': 0.3587920708514246, 'recall': 0.6543722727903498, 'f1-score': 0.4634659408132816, 'support': 778268}, '1': {'precision': 0.3601049363402248, 'recall': 0.07762064350117764, 'f1-score': 0.12771278706995523, 'support': 771032}, '2': {'precision': 0.3594071060327043, 'recall': 0.34240667899658755, 'f1-score': 0.35070098709815556, 'support': 767780}, 'accuracy': 0.3590803942893642, 'macro avg': {'precision': 0.35943470440811787, 'recall': 0.3581331984293717, 'f1-score': 0.31395990499379745, 'support': 2317080}, 'weighted avg': {'precision': 0.3594327362643769, 'recall': 0.3590803942893642, 'f1-score': 0.3143752310404538, 'support': 2317080}}
[[509277  49052 219939]
 [462553  59848 248631]
 [447591  57296 262893]]
Evaluating performance on  val set...
2763/2763 - 41s - 41s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1067961
{'0': {'precision': 0.344741911880482, 'recall': 0.6593899614241615, 'f1-score': 0.45276793221998707, 'support': 225789}, '1': {'precision': 0.40233814716573335, 'recall': 0.08138906333219394, 'f1-score': 0.1353900472413873, 'support': 251594}, '2': {'precision': 0.35406498272115144, 'recall': 0.34578049162361046, 'f1-score': 0.3498737029246354, 'support': 229932}, 'accuracy': 0.35184606575571, 'macro avg': {'precision': 0.3670483472557889, 'recall': 0.36218650545998865, 'f1-score': 0.31267722746200327, 'support': 707315}, 'weighted avg': {'precision': 0.36825977809976806, 'recall': 0.35184606575571, 'f1-score': 0.30642712575660846, 'support': 707315}}
[[148883  13705  63201]
 [149272  20477  81845]
 [133713  16713  79506]]
training model: results/universal/W7/deepVOL_L3/h100
Epoch 1/50
12475/12475 - 724s - loss: 3.2726 - accuracy100: 0.3690 - val_loss: 3.3470 - val_accuracy100: 0.3513 - 724s/epoch - 58ms/step
Epoch 2/50
12475/12475 - 693s - loss: 3.2557 - accuracy100: 0.3811 - val_loss: 3.3479 - val_accuracy100: 0.3598 - 693s/epoch - 56ms/step
Epoch 3/50
12475/12475 - 703s - loss: 3.2395 - accuracy100: 0.3924 - val_loss: 3.4117 - val_accuracy100: 0.3558 - 703s/epoch - 56ms/step
Epoch 4/50
12475/12475 - 678s - loss: 3.2242 - accuracy100: 0.4004 - val_loss: 3.3948 - val_accuracy100: 0.3583 - 678s/epoch - 54ms/step
Epoch 5/50
12475/12475 - 677s - loss: 3.2110 - accuracy100: 0.4060 - val_loss: 3.3808 - val_accuracy100: 0.3525 - 677s/epoch - 54ms/step
Epoch 6/50
12475/12475 - 681s - loss: 3.2022 - accuracy100: 0.4096 - val_loss: 3.4038 - val_accuracy100: 0.3581 - 681s/epoch - 55ms/step
Epoch 7/50
12475/12475 - 679s - loss: 3.1966 - accuracy100: 0.4127 - val_loss: 3.4115 - val_accuracy100: 0.3624 - 679s/epoch - 54ms/step
Epoch 8/50
12475/12475 - 698s - loss: 3.1931 - accuracy100: 0.4143 - val_loss: 3.4274 - val_accuracy100: 0.3615 - 698s/epoch - 56ms/step
Epoch 9/50
12475/12475 - 708s - loss: 3.1903 - accuracy100: 0.4157 - val_loss: 3.4200 - val_accuracy100: 0.3627 - 708s/epoch - 57ms/step
Epoch 10/50
12475/12475 - 707s - loss: 3.1874 - accuracy100: 0.4170 - val_loss: 3.4279 - val_accuracy100: 0.3622 - 707s/epoch - 57ms/step
Epoch 11/50
12475/12475 - 691s - loss: 3.1845 - accuracy100: 0.4179 - val_loss: 3.4716 - val_accuracy100: 0.3654 - 691s/epoch - 55ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 1154s - 1154s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1379834
{'0': {'precision': 0.31690973553994367, 'recall': 0.8417064957829038, 'f1-score': 0.4604544210057497, 'support': 2818290}, '1': {'precision': 0.40350877192982454, 'recall': 5.931519319989994e-06, 'f1-score': 1.18628642576284e-05, 'support': 3877590}, '2': {'precision': 0.3721376426352399, 'recall': 0.26756954143016387, 'f1-score': 0.3113071132202042, 'support': 2809692}, 'accuracy': 0.32864766055109573, 'macro avg': {'precision': 0.364185383368336, 'recall': 0.3697606562441292, 'f1-score': 0.2572577990300705, 'support': 9505572}, 'weighted avg': {'precision': 0.3685603848914435, 'recall': 0.32864766055109573, 'f1-score': 0.22854144864275536, 'support': 9505572}}
[[2372173      19  446098]
 [3055265      23  822302]
 [2057889      15  751788]]
Evaluating performance on  train set...
12475/12475 - 395s - 395s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1131243
{'0': {'precision': 0.35003574399706455, 'recall': 0.8271849377467355, 'f1-score': 0.4919116688953278, 'support': 1070225}, '1': {'precision': 0.2857142857142857, 'recall': 1.8773825157488925e-06, 'f1-score': 3.7547403597041264e-06, 'support': 1065313}, '2': {'precision': 0.3819130366682179, 'recall': 0.23978436871776737, 'f1-score': 0.29460240821085, 'support': 1057546}, 'accuracy': 0.3566642781711975, 'macro avg': {'precision': 0.3392210221265228, 'recall': 0.35565706128233954, 'f1-score': 0.2621726106155125, 'support': 3193084}, 'weighted avg': {'precision': 0.33913381271921705, 'recall': 0.3566642781711975, 'f1-score': 0.2624471401976805, 'support': 3193084}}
[[885274      3 184948]
 [839861      2 225450]
 [803961      2 253583]]
Evaluating performance on  val set...
3866/3866 - 121s - 121s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1154215
{'0': {'precision': 0.3422151588627712, 'recall': 0.8411033435025876, 'f1-score': 0.48649338912791495, 'support': 323852}, '1': {'precision': 0.2, 'recall': 3.0084507381233885e-06, 'f1-score': 6.01681096984976e-06, 'support': 332397}, '2': {'precision': 0.38955735999627383, 'recall': 0.2260769538042907, 'f1-score': 0.286111216693907, 'support': 332953}, 'accuracy': 0.3514620876221439, 'macro avg': {'precision': 0.3105908396196817, 'recall': 0.35572776858587213, 'f1-score': 0.2575368742109306, 'support': 989202}, 'weighted avg': {'precision': 0.31036204466920364, 'recall': 0.3514620876221439, 'f1-score': 0.2555751453774415, 'support': 989202}}
[[272393      4  51455]
 [265897      1  66499]
 [257680      0  75273]]
testing model out of sample: results/universal/W7/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 456s - 456s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1376153
{'0': {'precision': 0.317414883575797, 'recall': 0.8252311001680311, 'f1-score': 0.4584808196231099, 'support': 1089679}, '1': {'precision': 0.4666666666666667, 'recall': 4.481210285273847e-06, 'f1-score': 8.962334508892877e-06, 'support': 1562078}, '2': {'precision': 0.3712784662866735, 'recall': 0.31132511659190826, 'f1-score': 0.3386689279224712, 'support': 1122505}, 'accuracy': 0.3308482558974443, 'macro avg': {'precision': 0.38512000550971237, 'recall': 0.3788535659900749, 'f1-score': 0.26571956996003, 'support': 3774262}, 'weighted avg': {'precision': 0.3952062684181561, 'recall': 0.3308482558974443, 'f1-score': 0.2330968241868925, 'support': 3774262}}
[[ 899237       5  190437]
 [1160727       7  401344]
 [ 773038       3  349464]]
Evaluating performance on  train set...
5285/5285 - 164s - 164s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115884
{'0': {'precision': 0.3547904034250274, 'recall': 0.83050278729744, 'f1-score': 0.49718402376254067, 'support': 447028}, '1': {'precision': 0.4, 'recall': 4.315963020828838e-06, 'f1-score': 8.631832904978627e-06, 'support': 463396}, '2': {'precision': 0.3976180990510277, 'recall': 0.27533908308496635, 'f1-score': 0.3253692975330283, 'support': 442222}, 'accuracy': 0.3644863474996414, 'macro avg': {'precision': 0.38413616749201834, 'recall': 0.3686153954484757, 'f1-score': 0.27418731770949134, 'support': 1352646}, 'weighted avg': {'precision': 0.3842802296098363, 'recall': 0.3644863474996414, 'f1-score': 0.2706877048577475, 'support': 1352646}}
[[371258      1  75769]
 [354698      2 108696]
 [320459      2 121761]]
Evaluating performance on  val set...
1714/1714 - 54s - 54s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.116392
{'0': {'precision': 0.34236568926134636, 'recall': 0.8281050096132542, 'f1-score': 0.4844456895326181, 'support': 139911}, '1': {'precision': 0.5, 'recall': 6.409229290177856e-06, 'f1-score': 1.2818294269581547e-05, 'support': 156025}, '2': {'precision': 0.4084963711741736, 'recall': 0.28637982237610665, 'f1-score': 0.3367078029265628, 'support': 142098}, 'accuracy': 0.35740604610601, 'macro avg': {'precision': 0.4169540201451733, 'recall': 0.371497080406217, 'f1-score': 0.2737221035844835, 'support': 438034}, 'weighted avg': {'precision': 0.4199668137664016, 'recall': 0.35740604610601, 'f1-score': 0.2639676057630692, 'support': 438034}}
[[115861      1  24049]
 [121148      1  34876]
 [101404      0  40694]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1475087
{'0': {'precision': 0.31234068491632494, 'recall': 0.8501187738018928, 'f1-score': 0.45683602654374145, 'support': 53042}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 71360}, '2': {'precision': 0.3687676948293846, 'recall': 0.23119464892941222, 'f1-score': 0.2842082294980305, 'support': 53522}, 'accuracy': 0.3229805984577685, 'macro avg': {'precision': 0.2270361265819032, 'recall': 0.3604378075771017, 'f1-score': 0.24701475201392398, 'support': 177924}, 'weighted avg': {'precision': 0.20404419399288476, 'recall': 0.3229805984577685, 'f1-score': 0.22168391773525054, 'support': 177924}}
[[45092     1  7949]
 [58128     0 13232]
 [41148     0 12374]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.117043
{'0': {'precision': 0.3521222180820433, 'recall': 0.8443668264154008, 'f1-score': 0.49698795180722893, 'support': 24622}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 23851}, '2': {'precision': 0.3684576192681797, 'recall': 0.20290779237342177, 'f1-score': 0.26169915289086276, 'support': 23523}, 'accuracy': 0.3550613922995722, 'macro avg': {'precision': 0.24019327911674102, 'recall': 0.3490915395962742, 'f1-score': 0.25289570156603053, 'support': 71996}, 'weighted avg': {'precision': 0.2408075703047594, 'recall': 0.3550613922995722, 'f1-score': 0.2554695611263036, 'support': 71996}}
[[20790     0  3832]
 [19502     0  4349]
 [18750     0  4773]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0969422
{'0': {'precision': 0.36470359320275003, 'recall': 0.8579493439121147, 'f1-score': 0.5118332423083924, 'support': 6554}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5175}, '2': {'precision': 0.37928802588996763, 'recall': 0.17288685646850568, 'f1-score': 0.23751139933123921, 'support': 6779}, 'accuracy': 0.36713853468770263, 'macro avg': {'precision': 0.2479972063642392, 'recall': 0.3436120667935401, 'f1-score': 0.24978154721321055, 'support': 18508}, 'weighted avg': {'precision': 0.268071151791599, 'recall': 0.36713853468770263, 'f1-score': 0.26824318382081663, 'support': 18508}}
[[5623    0  931]
 [4188    0  987]
 [5607    0 1172]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
2006/2006 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1155504
{'0': {'precision': 0.3318961151307595, 'recall': 0.7855101948258101, 'f1-score': 0.4666302306247498, 'support': 154343}, '1': {'precision': 1.0, 'recall': 1.8951328251218807e-05, 'f1-score': 3.7901938210365235e-05, 'support': 211067}, '2': {'precision': 0.4121334531232057, 'recall': 0.41245943753380204, 'f1-score': 0.4122963808931703, 'support': 147920}, 'accuracy': 0.3550406171468646, 'macro avg': {'precision': 0.5813431894179885, 'recall': 0.3993295278959545, 'f1-score': 0.29298817115204345, 'support': 513330}, 'weighted avg': {'precision': 0.6297228342072573, 'recall': 0.3550406171468646, 'f1-score': 0.25912374144395567, 'support': 513330}}
[[121238      0  33105]
 [157142      4  53921]
 [ 86909      0  61011]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1144847
{'0': {'precision': 0.3483030334243189, 'recall': 0.8126456946480498, 'f1-score': 0.4876131972082829, 'support': 41611}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56792}, '2': {'precision': 0.382082468110353, 'recall': 0.39495068227117086, 'f1-score': 0.3884100218631417, 'support': 39134}, 'accuracy': 0.358238146825945, 'macro avg': {'precision': 0.24346183384489062, 'recall': 0.4025321256397402, 'f1-score': 0.29200773969047483, 'support': 137537}, 'weighted avg': {'precision': 0.21409259203596043, 'recall': 0.358238146825945, 'f1-score': 0.25804045852844, 'support': 137537}}
[[33815     0  7796]
 [39592     0 17200]
 [23678     0 15456]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.11008
{'0': {'precision': 0.34982244318181815, 'recall': 0.8142668209621425, 'f1-score': 0.4893934124894431, 'support': 12098}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 14685}, '2': {'precision': 0.4187712370281936, 'recall': 0.37172902910247, 'f1-score': 0.39385040594230436, 'support': 12267}, 'accuracy': 0.36903969270166453, 'macro avg': {'precision': 0.25619789340333726, 'recall': 0.39533195002153754, 'f1-score': 0.29441460614391585, 'support': 39050}, 'weighted avg': {'precision': 0.23992877547345676, 'recall': 0.36903969270166453, 'f1-score': 0.27534044645304817, 'support': 39050}}
[[ 9851     1  2246]
 [10602     0  4083]
 [ 7707     0  4560]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115205
{'0': {'precision': 0.3426133290194076, 'recall': 0.8588083229845148, 'f1-score': 0.48981833819378945, 'support': 78914}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 78456}, '2': {'precision': 0.40216307814992025, 'recall': 0.20028544834005585, 'f1-score': 0.2674001474694084, 'support': 80575}, 'accuracy': 0.3526445186912942, 'macro avg': {'precision': 0.24825880238977596, 'recall': 0.3530312571081902, 'f1-score': 0.2524061618877326, 'support': 237945}, 'weighted avg': {'precision': 0.24981099946696655, 'recall': 0.3526445186912942, 'f1-score': 0.2529966640298064, 'support': 237945}}
[[67772     7 11135]
 [65601     0 12855]
 [64436     1 16138]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1144743
{'0': {'precision': 0.3484165296270755, 'recall': 0.8097395592541223, 'f1-score': 0.487199695871079, 'support': 32445}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 32251}, '2': {'precision': 0.3807930551159741, 'recall': 0.25657273419649657, 'f1-score': 0.30657784572822244, 'support': 32825}, 'accuracy': 0.3557592723618503, 'macro avg': {'precision': 0.2430698615810165, 'recall': 0.35543743115020626, 'f1-score': 0.2645925138664338, 'support': 97521}, 'weighted avg': {'precision': 0.24409005586419655, 'recall': 0.3557592723618503, 'f1-score': 0.26528247165806396, 'support': 97521}}
[[26272     0  6173]
 [24729     0  7522]
 [24403     0  8422]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1123401
{'0': {'precision': 0.34532563025210083, 'recall': 0.8174471612101119, 'f1-score': 0.48553846153846153, 'support': 9652}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9287}, '2': {'precision': 0.38471419396274886, 'recall': 0.23633852830933122, 'f1-score': 0.2928021508004399, 'support': 10138}, 'accuracy': 0.35375038690373833, 'macro avg': {'precision': 0.24334660807161657, 'recall': 0.35126189650648104, 'f1-score': 0.2594468707796338, 'support': 29077}, 'weighted avg': {'precision': 0.2487641600435955, 'recall': 0.35375038690373833, 'f1-score': 0.2632611836016126, 'support': 29077}}
[[7890    1 1761]
 [7216    0 2071]
 [7742    0 2396]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1065/1065 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1293122
{'0': {'precision': 0.31096317358985226, 'recall': 0.9257477687782218, 'f1-score': 0.4655468861167766, 'support': 84819}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 93920}, '2': {'precision': 0.35495838764664595, 'recall': 0.07554739852319775, 'f1-score': 0.1245798947757386, 'support': 93716}, 'accuracy': 0.31418399368703087, 'macro avg': {'precision': 0.22197385374549938, 'recall': 0.3337650557671399, 'f1-score': 0.19670892696417172, 'support': 272455}, 'weighted avg': {'precision': 0.2189017110253464, 'recall': 0.31418399368703087, 'f1-score': 0.18778275587653737, 'support': 272455}}
[[78521     0  6298]
 [87352     0  6568]
 [86636     0  7080]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1188847
{'0': {'precision': 0.3480453972257251, 'recall': 0.9292147125662823, 'f1-score': 0.506410403431114, 'support': 35643}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 33776}, '2': {'precision': 0.3333779443254818, 'recall': 0.0750007527173095, 'f1-score': 0.12245299250337964, 'support': 33213}, 'accuracy': 0.3469775508613298, 'macro avg': {'precision': 0.22714111385040228, 'recall': 0.3347384884278639, 'f1-score': 0.20962113197816454, 'support': 102632}, 'weighted avg': {'precision': 0.22875773402251487, 'recall': 0.3469775508613298, 'f1-score': 0.2154982583357037, 'support': 102632}}
[[33120     0  2523]
 [31318     0  2458]
 [30722     0  2491]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1264132
{'0': {'precision': 0.31070567986230635, 'recall': 0.9257435897435897, 'f1-score': 0.4652577319587628, 'support': 9750}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10618}, '2': {'precision': 0.33976833976833976, 'recall': 0.07191500953418686, 'f1-score': 0.11870503597122302, 'support': 11013}, 'accuracy': 0.3128644721328192, 'macro avg': {'precision': 0.21682467321021537, 'recall': 0.3325528664259255, 'f1-score': 0.19465425597666194, 'support': 31381}, 'weighted avg': {'precision': 0.21577544069743515, 'recall': 0.3128644721328192, 'f1-score': 0.18621335992317062, 'support': 31381}}
[[ 9026     0   724]
 [ 9803     0   815]
 [10221     0   792]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1650407
{'0': {'precision': 0.27608437201503766, 'recall': 0.8536475221055103, 'f1-score': 0.41722950602569203, 'support': 110719}, '1': {'precision': 0.3333333333333333, 'recall': 5.291005291005291e-06, 'f1-score': 1.058184261625477e-05, 'support': 189000}, '2': {'precision': 0.3004269011033557, 'recall': 0.19508744221246072, 'f1-score': 0.23656031958983978, 'support': 121566}, 'accuracy': 0.2806461184233951, 'macro avg': {'precision': 0.30328153548390885, 'recall': 0.349580085107754, 'f1-score': 0.21793346915271603, 'support': 421285}, 'weighted avg': {'precision': 0.3087921056877494, 'recall': 0.2806461184233951, 'f1-score': 0.17791975849406347, 'support': 421285}}
[[ 94515      1  16203]
 [149977      1  39022]
 [ 97849      1  23716]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1168531
{'0': {'precision': 0.34554911928123894, 'recall': 0.8468121141889332, 'f1-score': 0.4908163265306123, 'support': 44873}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 44854}, '2': {'precision': 0.35285998457353956, 'recall': 0.19370222628306555, 'f1-score': 0.25010790435358105, 'support': 44873}, 'accuracy': 0.34688707280832093, 'macro avg': {'precision': 0.2328030346182595, 'recall': 0.34683811349066623, 'f1-score': 0.24697474362806446, 'support': 134600}, 'weighted avg': {'precision': 0.23283589685940173, 'recall': 0.34688707280832093, 'f1-score': 0.2470096063333314, 'support': 134600}}
[[37999     0  6874]
 [35787     0  9067]
 [36181     0  8692]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1159177
{'0': {'precision': 0.3405673331323889, 'recall': 0.830190219609764, 'f1-score': 0.48299610525315856, 'support': 12249}, '1': {'precision': 1.0, 'recall': 8.150623522699487e-05, 'f1-score': 0.00016299918500407498, 'support': 12269}, '2': {'precision': 0.369573928142113, 'recall': 0.21568321770987606, 'f1-score': 0.2723961409726324, 'support': 12829}, 'accuracy': 0.3463999785792701, 'macro avg': {'precision': 0.5700470870915005, 'recall': 0.34865164785162234, 'f1-score': 0.251851748470265, 'support': 37347}, 'weighted avg': {'precision': 0.5671639807126088, 'recall': 0.3463999785792701, 'f1-score': 0.2520360195674259, 'support': 37347}}
[[10169     0  2080]
 [ 9628     1  2640]
 [10062     0  2767]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
5929/5929 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865116
{'0': {'precision': 0.38809970797921406, 'recall': 0.7999766910331699, 'f1-score': 0.522644369399539, 'support': 463341}, '1': {'precision': 0.3333333333333333, 'recall': 1.3151729863468604e-05, 'f1-score': 2.630242195989209e-05, 'support': 608285}, '2': {'precision': 0.4210851941402361, 'recall': 0.5311214112887854, 'f1-score': 0.46974545505029125, 'support': 445947}, 'accuracy': 0.4003247290245675, 'macro avg': {'precision': 0.38083941181759445, 'recall': 0.4437037513506063, 'f1-score': 0.33080537562393003, 'support': 1517573}, 'weighted avg': {'precision': 0.3758408014195821, 'recall': 0.4003247290245675, 'f1-score': 0.2976200423795138, 'support': 1517573}}
[[370662     12  92667]
 [375316      8 232961]
 [209091      4 236852]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0852329
{'0': {'precision': 0.3884063461993843, 'recall': 0.7797374000513411, 'f1-score': 0.5185234360428541, 'support': 105179}, '1': {'precision': 0.5, 'recall': 9.302844809942881e-06, 'f1-score': 1.8605343454640175e-05, 'support': 107494}, '2': {'precision': 0.4508632621840169, 'recall': 0.4571956230666236, 'f1-score': 0.45400736322331287, 'support': 108295}, 'accuracy': 0.4097760524413649, 'macro avg': {'precision': 0.44642320279446707, 'recall': 0.41231410865425816, 'f1-score': 0.3241831348698739, 'support': 320968}, 'weighted avg': {'precision': 0.44685273318562335, 'recall': 0.4097760524413649, 'f1-score': 0.32310543058064767, 'support': 320968}}
[[82012     1 23166]
 [70355     1 37138]
 [58783     0 49512]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0924869
{'0': {'precision': 0.3744605364187561, 'recall': 0.7961383658419883, 'f1-score': 0.5093502120341775, 'support': 35529}, '1': {'precision': 0.5, 'recall': 2.6628321883154923e-05, 'f1-score': 5.3253807647246777e-05, 'support': 37554}, '2': {'precision': 0.4502390781384574, 'recall': 0.4196191319751993, 'f1-score': 0.43439017750970643, 'support': 36128}, 'accuracy': 0.39782622629588593, 'macro avg': {'precision': 0.4415665381857378, 'recall': 0.40526137537969026, 'f1-score': 0.31459788111717707, 'support': 109211}, 'weighted avg': {'precision': 0.4426975836995191, 'recall': 0.39782622629588593, 'f1-score': 0.30942260312537523, 'support': 109211}}
[[28286     0  7243]
 [26285     1 11268]
 [20967     1 15160]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
5331/5331 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1370176
{'0': {'precision': 0.32072110951606025, 'recall': 0.8315207397143191, 'f1-score': 0.46289978862496645, 'support': 386095}, '1': {'precision': 0.75, 'recall': 1.0261444503542764e-05, 'f1-score': 2.052260821827846e-05, 'support': 584713}, '2': {'precision': 0.3728234113068471, 'recall': 0.34421962529012334, 'f1-score': 0.3579509970516898, 'support': 393798}, 'accuracy': 0.33460573967870577, 'macro avg': {'precision': 0.4811815069409691, 'recall': 0.391916875482982, 'f1-score': 0.27362376942829153, 'support': 1364606}, 'weighted avg': {'precision': 0.519696293658695, 'recall': 0.33460573967870577, 'f1-score': 0.2342769125021705, 'support': 1364606}}
[[321046      2  65047]
 [421722      6 162985]
 [258245      0 135553]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143223
{'0': {'precision': 0.3528026295413788, 'recall': 0.8515834594353443, 'f1-score': 0.4989112486644474, 'support': 165871}, '1': {'precision': 0.3333333333333333, 'recall': 5.331456660588806e-06, 'f1-score': 1.0662742777324611e-05, 'support': 187566}, '2': {'precision': 0.4059250880932701, 'recall': 0.28821621621621624, 'f1-score': 0.3370904230338499, 'support': 161875}, 'accuracy': 0.36465092992206666, 'macro avg': {'precision': 0.3640203503226607, 'recall': 0.379935002369407, 'f1-score': 0.27867077814702484, 'support': 515312}, 'weighted avg': {'precision': 0.3624034538294395, 'recall': 0.36465092992206666, 'f1-score': 0.2664859733983233, 'support': 515312}}
[[141253      0  24618]
 [143903      1  43662]
 [115218      2  46655]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1203662
{'0': {'precision': 0.33617725249956654, 'recall': 0.8480027698811867, 'f1-score': 0.4814795654423176, 'support': 54876}, '1': {'precision': 0.5, 'recall': 1.4525172123289662e-05, 'f1-score': 2.9049500348594004e-05, 'support': 68846}, '2': {'precision': 0.4244487760423259, 'recall': 0.3093142952017267, 'f1-score': 0.35784868210436455, 'support': 54207}, 'accuracy': 0.3557767424084888, 'macro avg': {'precision': 0.4202086761806308, 'recall': 0.38577719675167893, 'f1-score': 0.2797857656823436, 'support': 177929}, 'weighted avg': {'precision': 0.426457506708252, 'recall': 0.3557767424084888, 'f1-score': 0.2575273063185029, 'support': 177929}}
[[46535     1  8340]
 [54449     1 14396]
 [37440     0 16767]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
4192/4192 - 62s - 62s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.133935
{'0': {'precision': 0.3135693498741923, 'recall': 0.8169314851485149, 'f1-score': 0.45318794423470354, 'support': 315625}, '1': {'precision': 0.26666666666666666, 'recall': 9.287530329591232e-06, 'f1-score': 1.857441374506617e-05, 'support': 430685}, '2': {'precision': 0.3863813943104988, 'recall': 0.29654571043935873, 'f1-score': 0.33555483236626, 'support': 326840}, 'accuracy': 0.33058845454969016, 'macro avg': {'precision': 0.32220580361711926, 'recall': 0.3711621610394011, 'f1-score': 0.26292045033823624, 'support': 1073150}, 'weighted avg': {'precision': 0.3169217297710653, 'recall': 0.33058845454969016, 'f1-score': 0.23549194989614733, 'support': 1073150}}
[[257844      7  57774]
 [334530      4  96151]
 [229913      4  96923]]
Evaluating performance on  train set...
1230/1230 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1069194
{'0': {'precision': 0.35904312027423774, 'recall': 0.8207296040791842, 'f1-score': 0.49954929770312984, 'support': 106688}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 102963}, '2': {'precision': 0.4002620050428928, 'recall': 0.2700634884428224, 'f1-score': 0.32251840165260176, 'support': 105216}, 'accuracy': 0.3683364722247806, 'macro avg': {'precision': 0.2531017084390435, 'recall': 0.36359769750733556, 'f1-score': 0.27402256645191053, 'support': 314867}, 'weighted avg': {'precision': 0.2554080279559652, 'recall': 0.3683364722247806, 'f1-score': 0.27703764326408187, 'support': 314867}}
[[87562     0 19126]
 [79513     0 23450]
 [76801     0 28415]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0919522
{'0': {'precision': 0.38050693252005435, 'recall': 0.8168239209968916, 'f1-score': 0.5191667176613545, 'support': 36353}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29527}, '2': {'precision': 0.41171610344542675, 'recall': 0.27405472294788946, 'f1-score': 0.3290683660497598, 'support': 36365}, 'accuracy': 0.387891828451269, 'macro avg': {'precision': 0.26407434532182705, 'recall': 0.36362621464826034, 'f1-score': 0.28274502790370476, 'support': 102245}, 'weighted avg': {'precision': 0.28172159635869215, 'recall': 0.387891828451269, 'f1-score': 0.3016268650647243, 'support': 102245}}
[[29694     1  6658]
 [21945     0  7582]
 [26399     0  9966]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
6143/6143 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1336533
{'0': {'precision': 0.32327933652683966, 'recall': 0.8048768845911015, 'f1-score': 0.4612837484130645, 'support': 460909}, '1': {'precision': 0.5714285714285714, 'recall': 6.264202120745628e-06, 'f1-score': 1.2528266902198084e-05, 'support': 638549}, '2': {'precision': 0.38003049713148124, 'recall': 0.3413995315446343, 'f1-score': 0.3596807134059835, 'support': 473044}, 'accuracy': 0.3386170574027887, 'macro avg': {'precision': 0.4249128016956307, 'recall': 0.3820942267792855, 'f1-score': 0.27365899669531674, 'support': 1572502}, 'weighted avg': {'precision': 0.4411178141976648, 'recall': 0.3386170574027887, 'f1-score': 0.24340995083124814, 'support': 1572502}}
[[370975      1  89933]
 [465017      4 173528]
 [311545      2 161497]]
Evaluating performance on  train set...
2083/2083 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063068
{'0': {'precision': 0.36104575163398694, 'recall': 0.8091029310835468, 'f1-score': 0.4992924065408494, 'support': 179217}, '1': {'precision': 1.0, 'recall': 5.7184029644200965e-06, 'f1-score': 1.1436740528949248e-05, 'support': 174874}, '2': {'precision': 0.4024211382237387, 'recall': 0.2956298918080011, 'f1-score': 0.34085679251537576, 'support': 179126}, 'accuracy': 0.37125785561975705, 'macro avg': {'precision': 0.5878222966192418, 'recall': 0.3682461804315041, 'f1-score': 0.28005354526558474, 'support': 533217}, 'weighted avg': {'precision': 0.5844967907550841, 'recall': 0.37125785561975705, 'f1-score': 0.2823240838677384, 'support': 533217}}
[[145005      0  34212]
 [130449      1  44424]
 [126171      0  52955]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1149815
{'0': {'precision': 0.3459085193097283, 'recall': 0.8070342877341817, 'f1-score': 0.48425651957197247, 'support': 56580}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60448}, '2': {'precision': 0.40519378228739544, 'recall': 0.3008169232092183, 'f1-score': 0.34528979785217934, 'support': 58145}, 'accuracy': 0.3605178880306897, 'macro avg': {'precision': 0.2503674338657079, 'recall': 0.3692837369811333, 'f1-score': 0.27651543914138393, 'support': 175173}, 'weighted avg': {'precision': 0.24622228593244988, 'recall': 0.3605178880306897, 'f1-score': 0.27102412571285056, 'support': 175173}}
[[45662     0 10918]
 [45690     0 14758]
 [40654     0 17491]]
testing model on single stock: results/universal/W7/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
23942/23942 - 346s - 346s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1536801
{'0': {'precision': 0.3033435079228984, 'recall': 0.8576778089971903, 'f1-score': 0.44817608679055887, 'support': 1800162}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2533633}, '2': {'precision': 0.33722745030117585, 'recall': 0.1952169841956832, 'f1-score': 0.24728411669099168, 'support': 1795269}, 'accuracy': 0.3090889571392957, 'macro avg': {'precision': 0.21352365274135807, 'recall': 0.3509649310642911, 'f1-score': 0.23182006782718353, 'support': 6129064}, 'weighted avg': {'precision': 0.18787231515028105, 'recall': 0.3090889571392957, 'f1-score': 0.20406559135893929, 'support': 6129064}}
[[1543959       0  256203]
 [2101043       0  432590]
 [1444802       0  350467]]
Evaluating performance on  train set...
9052/9052 - 129s - 129s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1175153
{'0': {'precision': 0.34486630868260165, 'recall': 0.8307690141133575, 'f1-score': 0.48740325798271866, 'support': 781104}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 764288}, '2': {'precision': 0.36346432967719416, 'recall': 0.20508806667979806, 'f1-score': 0.26221750944396577, 'support': 771688}, 'accuracy': 0.34836129956669604, 'macro avg': {'precision': 0.2361102127865986, 'recall': 0.3452856935977185, 'f1-score': 0.24987358914222813, 'support': 2317080}, 'weighted avg': {'precision': 0.23730622801851878, 'recall': 0.34836129956669604, 'f1-score': 0.2516368618481574, 'support': 2317080}}
[[648917      0 132187]
 [619307      0 144981]
 [613424      0 158264]]
Evaluating performance on  val set...
2763/2763 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1221992
{'0': {'precision': 0.3345026245039048, 'recall': 0.8515483091577511, 'f1-score': 0.48032531524719135, 'support': 230122}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 240013}, '2': {'precision': 0.36707850093424094, 'recall': 0.18802597183573658, 'f1-score': 0.24867496215173324, 'support': 237180}, 'accuracy': 0.3400974106303415, 'macro avg': {'precision': 0.23386037514604854, 'recall': 0.3465247603311626, 'f1-score': 0.2430000924663082, 'support': 707315}, 'weighted avg': {'precision': 0.23191943025055434, 'recall': 0.3400974106303415, 'f1-score': 0.23965863825659325, 'support': 707315}}
[[195960      1  34161]
 [197281      0  42732]
 [192584      0  44596]]
training model: results/universal/W7/deepVOL_L3/h200
Epoch 1/50
12475/12475 - 689s - loss: 3.2789 - accuracy200: 0.3650 - val_loss: 3.3021 - val_accuracy200: 0.3255 - 689s/epoch - 55ms/step
Epoch 2/50
12475/12475 - 695s - loss: 3.2699 - accuracy200: 0.3742 - val_loss: 3.3038 - val_accuracy200: 0.3429 - 695s/epoch - 56ms/step
Epoch 3/50
12475/12475 - 685s - loss: 3.2580 - accuracy200: 0.3836 - val_loss: 3.3206 - val_accuracy200: 0.3440 - 685s/epoch - 55ms/step
Epoch 4/50
12475/12475 - 702s - loss: 3.2493 - accuracy200: 0.3904 - val_loss: 3.3263 - val_accuracy200: 0.3458 - 702s/epoch - 56ms/step
Epoch 5/50
12475/12475 - 689s - loss: 3.2430 - accuracy200: 0.3940 - val_loss: 3.3041 - val_accuracy200: 0.3518 - 689s/epoch - 55ms/step
Epoch 6/50
12475/12475 - 692s - loss: 3.2387 - accuracy200: 0.3965 - val_loss: 3.3112 - val_accuracy200: 0.3528 - 692s/epoch - 55ms/step
Epoch 7/50
12475/12475 - 680s - loss: 3.2354 - accuracy200: 0.3986 - val_loss: 3.3136 - val_accuracy200: 0.3501 - 680s/epoch - 55ms/step
Epoch 8/50
12475/12475 - 691s - loss: 3.2325 - accuracy200: 0.4003 - val_loss: 3.3228 - val_accuracy200: 0.3474 - 691s/epoch - 55ms/step
Epoch 9/50
12475/12475 - 689s - loss: 3.2302 - accuracy200: 0.4020 - val_loss: 3.3269 - val_accuracy200: 0.3444 - 689s/epoch - 55ms/step
Epoch 10/50
12475/12475 - 702s - loss: 3.2280 - accuracy200: 0.4032 - val_loss: 3.3075 - val_accuracy200: 0.3481 - 702s/epoch - 56ms/step
Epoch 11/50
12475/12475 - 689s - loss: 3.2257 - accuracy200: 0.4043 - val_loss: 3.3099 - val_accuracy200: 0.3472 - 689s/epoch - 55ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 1160s - 1160s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001999
{'0': {'precision': 0.29832209525161474, 'recall': 0.892312591554678, 'f1-score': 0.447150691781077, 'support': 2826180}, '1': {'precision': 0.40326090143984045, 'recall': 0.035448663418658, 'f1-score': 0.06516867244349347, 'support': 3879300}, '2': {'precision': 0.31586052123144936, 'recall': 0.08022164986007603, 'f1-score': 0.12794745125245854, 'support': 2800092}, 'accuracy': 0.3033988906717029, 'macro avg': {'precision': 0.33914783930763487, 'recall': 0.33599430161113736, 'f1-score': 0.21342227182567633, 'support': 9505572}, 'weighted avg': {'precision': 0.3463148217413737, 'recall': 0.3033988906717029, 'f1-score': 0.1972318770275253, 'support': 9505572}}
[[2521836  103492  200852]
 [3456102  137516  285682]
 [2475462  100002  224628]]
Evaluating performance on  train set...
12475/12475 - 418s - 418s/epoch - 34ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987607
{'0': {'precision': 0.3405657442864409, 'recall': 0.8956010449752021, 'f1-score': 0.4934787750573297, 'support': 1085576}, '1': {'precision': 0.3251502387959748, 'recall': 0.035669129673235975, 'f1-score': 0.06428605027552409, 'support': 1034508}, '2': {'precision': 0.34595880966149195, 'recall': 0.07248369058713887, 'f1-score': 0.11985575700603324, 'support': 1073000}, 'accuracy': 0.34039755922487475, 'macro avg': {'precision': 0.33722493091463585, 'recall': 0.33458462174519227, 'f1-score': 0.22587352744629566, 'support': 3193084}, 'weighted avg': {'precision': 0.3373836467886922, 'recall': 0.34039755922487475, 'f1-score': 0.2288753992308193, 'support': 3193084}}
[[972243  38714  74619]
 [925192  36900  72416]
 [957353  37872  77775]]
Evaluating performance on  val set...
3866/3866 - 128s - 128s/epoch - 33ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995402
{'0': {'precision': 0.32355263498771686, 'recall': 0.897558399680036, 'f1-score': 0.47564451884729664, 'support': 320036}, '1': {'precision': 0.3366633943523705, 'recall': 0.034660293453187795, 'f1-score': 0.06285002775966064, 'support': 336408}, '2': {'precision': 0.34610948850445594, 'recall': 0.06944386010253698, 'f1-score': 0.11567794595054604, 'support': 332758}, 'accuracy': 0.32553411739968174, 'macro avg': {'precision': 0.33544183928151444, 'recall': 0.3338875177452536, 'f1-score': 0.21805749751916778, 'support': 989202}, 'weighted avg': {'precision': 0.33559925215879766, 'recall': 0.32553411739968174, 'f1-score': 0.21417201270417685, 'support': 989202}}
[[287251  11357  21428]
 [302519  11660  22229]
 [298033  11617  23108]]
testing model out of sample: results/universal/W7/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 463s - 463s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000881
{'0': {'precision': 0.3068752360960355, 'recall': 0.8919854271016298, 'f1-score': 0.4566472934493207, 'support': 1151178}, '1': {'precision': 0.38148749174253954, 'recall': 0.03720044084017303, 'f1-score': 0.0677903601390794, 'support': 1428182}, '2': {'precision': 0.3243843848001717, 'recall': 0.07842818908998395, 'f1-score': 0.12631621512333197, 'support': 1194902}, 'accuracy': 0.31096860790268405, 'macro avg': {'precision': 0.33758237087958226, 'recall': 0.3358713523439289, 'f1-score': 0.216917956237244, 'support': 3774262}, 'weighted avg': {'precision': 0.34065179885151065, 'recall': 0.31096860790268405, 'f1-score': 0.20492344945471525, 'support': 3774262}}
[[1026834   43474   80870]
 [1260739   53129  114314]
 [1058523   42665   93714]]
Evaluating performance on  train set...
5285/5285 - 165s - 165s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987612
{'0': {'precision': 0.3398955053191266, 'recall': 0.8835674402373059, 'f1-score': 0.4909353449137768, 'support': 458480}, '1': {'precision': 0.32420281243810656, 'recall': 0.03723383686625253, 'f1-score': 0.0667962955784027, 'support': 439627}, '2': {'precision': 0.34239746204396104, 'recall': 0.08310618010775753, 'f1-score': 0.1337490086109223, 'support': 454539}, 'accuracy': 0.33951381218737203, 'macro avg': {'precision': 0.3354985932670647, 'recall': 0.33463581907043866, 'f1-score': 0.23049354970103395, 'support': 1352646}, 'weighted avg': {'precision': 0.33563593216735244, 'recall': 0.33951381218737203, 'f1-score': 0.23305701018397637, 'support': 1352646}}
[[405098  17402  35980]
 [386688  16369  36570]
 [400045  16719  37775]]
Evaluating performance on  val set...
1714/1714 - 54s - 54s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992475
{'0': {'precision': 0.3285587454964023, 'recall': 0.8876756266778231, 'f1-score': 0.4796009666913426, 'support': 143415}, '1': {'precision': 0.33186147732290416, 'recall': 0.03563228511246419, 'f1-score': 0.06435474006116208, 'support': 147647}, '2': {'precision': 0.34834211966698353, 'recall': 0.08227417467272678, 'f1-score': 0.1331095027107356, 'support': 146972}, 'accuracy': 0.3302460539592817, 'macro avg': {'precision': 0.33625411416209666, 'recall': 0.3351940288210047, 'f1-score': 0.22568840315441344, 'support': 438034}, 'weighted avg': {'precision': 0.33630983448626656, 'recall': 0.3302460539592817, 'f1-score': 0.22337792677338184, 'support': 438034}}
[[127306   5210  10899]
 [130664   5261  11722]
 [129498   5382  12092]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996733
{'0': {'precision': 0.31901107741815704, 'recall': 0.9111299644731958, 'f1-score': 0.4725645950120779, 'support': 56577}, '1': {'precision': 0.3500297265160523, 'recall': 0.03811789841701466, 'f1-score': 0.06874908772441979, 'support': 61782}, '2': {'precision': 0.355194669997918, 'recall': 0.057281960883068916, 'f1-score': 0.098654060227552, 'support': 59565}, 'accuracy': 0.32213754187181043, 'macro avg': {'precision': 0.34141182464404246, 'recall': 0.3355099412577598, 'f1-score': 0.21332258098801657, 'support': 177924}, 'weighted avg': {'precision': 0.3418953980864178, 'recall': 0.32213754187181043, 'f1-score': 0.20716751156247934, 'support': 177924}}
[[51549  2118  2910]
 [56143  2355  3284]
 [53898  2255  3412]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984097
{'0': {'precision': 0.341975098072659, 'recall': 0.8965447154471544, 'f1-score': 0.49510062518940884, 'support': 24600}, '1': {'precision': 0.33592017738359203, 'recall': 0.03814679592093667, 'f1-score': 0.06851328434143583, 'support': 23829}, '2': {'precision': 0.3437565144882218, 'recall': 0.06997072177196928, 'f1-score': 0.116274150331406, 'support': 23567}, 'accuracy': 0.3418662147897105, 'macro avg': {'precision': 0.3405505966481576, 'recall': 0.3348874110466868, 'f1-score': 0.22662935328741687, 'support': 71996}, 'weighted avg': {'precision': 0.3405541849047857, 'recall': 0.3418662147897105, 'f1-score': 0.2299059855143588, 'support': 71996}}
[[22055   927  1618]
 [21390   909  1530]
 [21048   870  1649]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986999
{'0': {'precision': 0.3441080689904716, 'recall': 0.8954802259887006, 'f1-score': 0.4971682495425634, 'support': 6372}, '1': {'precision': 0.3209580838323353, 'recall': 0.04707535569998243, 'f1-score': 0.08210784313725489, 'support': 5693}, '2': {'precision': 0.3538038496791934, 'recall': 0.05990997982306379, 'f1-score': 0.10246880807008231, 'support': 6443}, 'accuracy': 0.34363518478495786, 'macro avg': {'precision': 0.3396233341673334, 'recall': 0.3341551871705823, 'f1-score': 0.22724830024996687, 'support': 18508}, 'weighted avg': {'precision': 0.3403625021800202, 'recall': 0.34363518478495786, 'f1-score': 0.23209436824406454, 'support': 18508}}
[[5706  267  399]
 [5119  268  306]
 [5757  300  386]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
2006/2006 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976835
{'0': {'precision': 0.3489855713416994, 'recall': 0.8902652970277481, 'f1-score': 0.5014154135517508, 'support': 177273}, '1': {'precision': 0.34837143435160833, 'recall': 0.0517250701382339, 'f1-score': 0.09007595254535183, 'support': 166457}, '2': {'precision': 0.3615278922780984, 'recall': 0.07757075471698113, 'f1-score': 0.12773435603670083, 'support': 169600}, 'accuracy': 0.34984512886447316, 'macro avg': {'precision': 0.35296163265713537, 'recall': 0.3398537072943211, 'f1-score': 0.23974190737793447, 'support': 513330}, 'weighted avg': {'precision': 0.352930305196829, 'recall': 0.34984512886447316, 'f1-score': 0.24456964179616544, 'support': 513330}}
[[157820   8112  11341]
 [145954   8610  11893]
 [148451   7993  13156]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976021
{'0': {'precision': 0.35561287153033655, 'recall': 0.8943596713411998, 'f1-score': 0.508884475455648, 'support': 48561}, '1': {'precision': 0.3010734072022161, 'recall': 0.03961997630547708, 'f1-score': 0.07002496577273093, 'support': 43892}, '2': {'precision': 0.3634098224483439, 'recall': 0.07763286309999112, 'f1-score': 0.12793566663620579, 'support': 45084}, 'accuracy': 0.35386841359052473, 'macro avg': {'precision': 0.34003203372696555, 'recall': 0.3372041702488893, 'f1-score': 0.23561503595486155, 'support': 137537}, 'weighted avg': {'precision': 0.34076356964718935, 'recall': 0.35386841359052473, 'f1-score': 0.24395854500916211, 'support': 137537}}
[[43431  2134  2996]
 [39018  1739  3135]
 [39681  1903  3500]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979805
{'0': {'precision': 0.3445014473646499, 'recall': 0.8999700509134472, 'f1-score': 0.49826932244491884, 'support': 13356}, '1': {'precision': 0.3137847642079806, 'recall': 0.043716307277628035, 'f1-score': 0.0767410912317019, 'support': 11872}, '2': {'precision': 0.3980039920159681, 'recall': 0.07213138474895095, 'f1-score': 0.12212898879157225, 'support': 13822}, 'accuracy': 0.3466325224071703, 'macro avg': {'precision': 0.3520967345295329, 'recall': 0.338605914313342, 'f1-score': 0.232379800822731, 'support': 39050}, 'weighted avg': {'precision': 0.3541005180364692, 'recall': 0.3466325224071703, 'f1-score': 0.23697880124850734, 'support': 39050}}
[[12020   550   786]
 [10631   519   722]
 [12240   585   997]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988295
{'0': {'precision': 0.3263242158957103, 'recall': 0.9081783327288742, 'f1-score': 0.48012955931344525, 'support': 77204}, '1': {'precision': 0.3729253112033195, 'recall': 0.04338486417339464, 'f1-score': 0.07772720884728063, 'support': 82863}, '2': {'precision': 0.35151019193572386, 'recall': 0.06067182002619482, 'f1-score': 0.10348226018396847, 'support': 77878}, 'accuracy': 0.3296349996848011, 'macro avg': {'precision': 0.3502532396782512, 'recall': 0.3374116723094878, 'f1-score': 0.22044634278156475, 'support': 237945}, 'weighted avg': {'precision': 0.3507960056055953, 'recall': 0.3296349996848011, 'f1-score': 0.21672077018871813, 'support': 237945}}
[[70115  3021  4068]
 [74619  3595  4649]
 [70129  3024  4725]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988836
{'0': {'precision': 0.33171691453040913, 'recall': 0.8859695218076721, 'f1-score': 0.48270403179628824, 'support': 32351}, '1': {'precision': 0.31300699300699303, 'recall': 0.03480018659617478, 'f1-score': 0.06263643996641478, 'support': 32155}, '2': {'precision': 0.3642752950537064, 'recall': 0.08320460396789338, 'f1-score': 0.13546700858072788, 'support': 33015}, 'accuracy': 0.3335486715681751, 'macro avg': {'precision': 0.3363330675303695, 'recall': 0.3346581041239134, 'f1-score': 0.22693582678114366, 'support': 97521}, 'weighted avg': {'precision': 0.3365702015802878, 'recall': 0.3335486715681751, 'f1-score': 0.22664324758825813, 'support': 97521}}
[[28662  1216  2473]
 [28715  1119  2321]
 [29028  1240  2747]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994614
{'0': {'precision': 0.3266764524103832, 'recall': 0.8887137452711223, 'f1-score': 0.47774262795164385, 'support': 9516}, '1': {'precision': 0.31420765027322406, 'recall': 0.03657760814249364, 'f1-score': 0.06552706552706553, 'support': 9432}, '2': {'precision': 0.34146341463414637, 'recall': 0.07049067035245335, 'f1-score': 0.11685761047463175, 'support': 10129}, 'accuracy': 0.3272689754789008, 'macro avg': {'precision': 0.3274491724392512, 'recall': 0.33192734125535645, 'f1-score': 0.2200424346511137, 'support': 29077}, 'weighted avg': {'precision': 0.32778287324495387, 'recall': 0.3272689754789008, 'f1-score': 0.2183134734029188, 'support': 29077}}
[[8457  358  701]
 [8411  345  676]
 [9020  395  714]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1065/1065 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008515
{'0': {'precision': 0.30203535061987286, 'recall': 0.9357495680949948, 'f1-score': 0.45666972447104437, 'support': 82194}, '1': {'precision': 0.34350213544844416, 'recall': 0.035800964442795825, 'f1-score': 0.06484369751125359, 'support': 94355}, '2': {'precision': 0.3483442047165078, 'recall': 0.028955435530623734, 'f1-score': 0.053466566549221196, 'support': 95906}, 'accuracy': 0.3048870455671579, 'macro avg': {'precision': 0.3312938969282749, 'recall': 0.3335019893561381, 'f1-score': 0.19165999617717308, 'support': 272455}, 'weighted avg': {'precision': 0.33269691103715904, 'recall': 0.3048870455671579, 'f1-score': 0.17904462367479754, 'support': 272455}}
[[76913  2941  2340]
 [88122  3378  2855]
 [89614  3515  2777]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983763
{'0': {'precision': 0.3456995335404178, 'recall': 0.9396283955497826, 'f1-score': 0.5054415930614942, 'support': 35414}, '1': {'precision': 0.32262455758235775, 'recall': 0.03500531726338178, 'f1-score': 0.06315789473684211, 'support': 33852}, '2': {'precision': 0.32790525536639525, 'recall': 0.02655397710243961, 'f1-score': 0.04912942220250637, 'support': 33366}, 'accuracy': 0.344405253722036, 'macro avg': {'precision': 0.3320764488297236, 'recall': 0.333729229971868, 'f1-score': 0.20590963666694753, 'support': 102632}, 'weighted avg': {'precision': 0.33230353646653554, 'recall': 0.344405253722036, 'f1-score': 0.21121075230454595, 'support': 102632}}
[[33276  1261   877]
 [31728  1185   939]
 [31253  1227   886]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010551
{'0': {'precision': 0.3009605852391208, 'recall': 0.9337151341605685, 'f1-score': 0.45519880047567346, 'support': 9429}, '1': {'precision': 0.34960767218831734, 'recall': 0.03731273843863404, 'f1-score': 0.06742895577602152, 'support': 10747}, '2': {'precision': 0.3598369011213048, 'recall': 0.03150379294957608, 'f1-score': 0.05793533563105203, 'support': 11205}, 'accuracy': 0.3045792039769287, 'macro avg': {'precision': 0.3368017195162476, 'recall': 0.33417722184959286, 'f1-score': 0.19352103062758233, 'support': 31381}, 'weighted avg': {'precision': 0.33864323916674854, 'recall': 0.3045792039769287, 'f1-score': 0.18055173235894223, 'support': 31381}}
[[ 8804   343   282]
 [10000   401   346]
 [10449   403   353]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1018494
{'0': {'precision': 0.26413230843370944, 'recall': 0.8965433563416738, 'f1-score': 0.4080486452987869, 'support': 111264}, '1': {'precision': 0.44020438522734623, 'recall': 0.036658407842292365, 'f1-score': 0.06768064995699108, 'support': 185660}, '2': {'precision': 0.29171549305777494, 'recall': 0.06605768689540933, 'f1-score': 0.10772216467132611, 'support': 124361}, 'accuracy': 0.27243789833485643, 'macro avg': {'precision': 0.3320173955729435, 'recall': 0.33308648369312516, 'f1-score': 0.19448381997570138, 'support': 421285}, 'weighted avg': {'precision': 0.3498695509192952, 'recall': 0.27243789833485643, 'f1-score': 0.16939399708565456, 'support': 421285}}
[[ 99753   4185   7326]
 [166234   6806  12620]
 [111676   4470   8215]]
Evaluating performance on  train set...
526/526 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987583
{'0': {'precision': 0.33813159275016025, 'recall': 0.8943648014798177, 'f1-score': 0.4907324617578116, 'support': 45411}, '1': {'precision': 0.3299897645854657, 'recall': 0.03645986474566304, 'f1-score': 0.065664589188969, 'support': 44213}, '2': {'precision': 0.3505519683399292, 'recall': 0.07483991462113126, 'f1-score': 0.1233464033126901, 'support': 44976}, 'accuracy': 0.3387221396731055, 'macro avg': {'precision': 0.33955777522518504, 'recall': 0.3352215269488707, 'f1-score': 0.22658115141982357, 'support': 134600}, 'weighted avg': {'precision': 0.33960740377452736, 'recall': 0.3387221396731055, 'f1-score': 0.22834701439886643, 'support': 134600}}
[[40614  1637  3160]
 [39525  1612  3076]
 [39974  1636  3366]]
Evaluating performance on  val set...
146/146 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001486
{'0': {'precision': 0.31365116967722834, 'recall': 0.9025990626331487, 'f1-score': 0.4655312603010659, 'support': 11735}, '1': {'precision': 0.33837579617834396, 'recall': 0.03218477849299508, 'f1-score': 0.058778784316437314, 'support': 13205}, '2': {'precision': 0.34683326152520466, 'recall': 0.06488272749254453, 'f1-score': 0.10931558935361219, 'support': 12407}, 'accuracy': 0.3165448362652957, 'macro avg': {'precision': 0.33295340912692567, 'recall': 0.3332221895395628, 'f1-score': 0.21120854465703845, 'support': 37347}, 'weighted avg': {'precision': 0.33341658340537444, 'recall': 0.3165448362652957, 'f1-score': 0.20337541713234877, 'support': 37347}}
[[10592   423   720]
 [11984   425   796]
 [11194   408   805]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
5929/5929 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09767
{'0': {'precision': 0.34631076020412976, 'recall': 0.8571136740363738, 'f1-score': 0.4933050710811319, 'support': 513996}, '1': {'precision': 0.33316932592957055, 'recall': 0.03623673135509321, 'f1-score': 0.06536420895861991, 'support': 523226}, '2': {'precision': 0.3598680337129309, 'recall': 0.14124463152986044, 'f1-score': 0.20286626679663441, 'support': 480351}, 'accuracy': 0.34750222888783605, 'macro avg': {'precision': 0.3464493732822104, 'recall': 0.34486501230710914, 'f1-score': 0.25384518227879543, 'support': 1517573}, 'weighted avg': {'precision': 0.34607110767834387, 'recall': 0.34750222888783605, 'f1-score': 0.2538290421838228, 'support': 1517573}}
[[440553  21297  52146]
 [435726  18960  68540]
 [395853  16651  67847]]
Evaluating performance on  train set...
1254/1254 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985072
{'0': {'precision': 0.33441345663729705, 'recall': 0.870055319793877, 'f1-score': 0.48313117392722266, 'support': 105568}, '1': {'precision': 0.3270417156286721, 'recall': 0.04204672067682662, 'f1-score': 0.07451347869011561, 'support': 105906}, '2': {'precision': 0.37929768750764714, 'recall': 0.1132482145140373, 'f1-score': 0.17441942244665437, 'support': 109494}, 'accuracy': 0.33867239101717306, 'macro avg': {'precision': 0.34691761992453873, 'recall': 0.34178341832824694, 'f1-score': 0.2440213583546642, 'support': 320968}, 'weighted avg': {'precision': 0.3472927541736828, 'recall': 0.33867239101717306, 'f1-score': 0.24299150222040328, 'support': 320968}}
[[91850  4535  9183]
 [90344  4453 11109]
 [92466  4628 12400]]
Evaluating performance on  val set...
427/427 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988215
{'0': {'precision': 0.3316486393681861, 'recall': 0.8677841419586703, 'f1-score': 0.47989255325756164, 'support': 35616}, '1': {'precision': 0.33981191222570534, 'recall': 0.043753195382504106, 'f1-score': 0.07752455420997426, 'support': 37163}, '2': {'precision': 0.35855438846359267, 'recall': 0.11056214317083882, 'f1-score': 0.1690093567742206, 'support': 36432}, 'accuracy': 0.3347739696550714, 'macro avg': {'precision': 0.3433383133524947, 'recall': 0.34069982683733774, 'f1-score': 0.24214215474725218, 'support': 109211}, 'weighted avg': {'precision': 0.34340205212191827, 'recall': 0.3347739696550714, 'f1-score': 0.23926387516756548, 'support': 109211}}
[[30907  1475  3234]
 [31565  1626  3972]
 [30720  1684  4028]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
5331/5331 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09987
{'0': {'precision': 0.31168724722752317, 'recall': 0.8937193021605107, 'f1-score': 0.46218582307510053, 'support': 421243}, '1': {'precision': 0.3775525102726154, 'recall': 0.0351066718386346, 'f1-score': 0.06423999588318903, 'support': 515600}, '2': {'precision': 0.3211069039041247, 'recall': 0.08167840603324739, 'f1-score': 0.13023066844835074, 'support': 427763}, 'accuracy': 0.3147523900671696, 'macro avg': {'precision': 0.33678222046808776, 'recall': 0.3368347933441309, 'f1-score': 0.21888549580221342, 'support': 1364606}, 'weighted avg': {'precision': 0.33952642588055754, 'recall': 0.3147523900671696, 'f1-score': 0.2077687962492241, 'support': 1364606}}
[[376473  15156  29614]
 [453244  18101  44255]
 [378138  14686  34939]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982441
{'0': {'precision': 0.3484568283575486, 'recall': 0.8828966174368748, 'f1-score': 0.49969625882871693, 'support': 178415}, '1': {'precision': 0.32724763825496234, 'recall': 0.03755473941298641, 'f1-score': 0.06737730086489027, 'support': 164187}, '2': {'precision': 0.33980276489395234, 'recall': 0.08738347518962422, 'f1-score': 0.1390173357159964, 'support': 172710}, 'accuracy': 0.3469354488154749, 'macro avg': {'precision': 0.3385024105021544, 'recall': 0.33594494401316183, 'f1-score': 0.2353636318032012, 'support': 515312}, 'weighted avg': {'precision': 0.33879876373617157, 'recall': 0.3469354488154749, 'f1-score': 0.24106845749281794, 'support': 515312}}
[[157522   6459  14434]
 [143133   6166  14888]
 [151401   6217  15092]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987464
{'0': {'precision': 0.33421192027621244, 'recall': 0.8862563252043527, 'f1-score': 0.4853832607285198, 'support': 59089}, '1': {'precision': 0.3351604062550379, 'recall': 0.03478508206870012, 'f1-score': 0.06302864938608459, 'support': 59767}, '2': {'precision': 0.35543731293648156, 'recall': 0.09046434073096, 'f1-score': 0.14422194634857238, 'support': 59073}, 'accuracy': 0.33603853222352736, 'macro avg': {'precision': 0.34160321315591063, 'recall': 0.33716858266800426, 'f1-score': 0.23087795215439222, 'support': 177929}, 'weighted avg': {'precision': 0.3415774187734587, 'recall': 0.33603853222352736, 'f1-score': 0.23024615334034831, 'support': 177929}}
[[52368  2029  4692]
 [52689  2079  4999]
 [51634  2095  5344]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
4192/4192 - 63s - 63s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998917
{'0': {'precision': 0.31558691601114797, 'recall': 0.9041568358792489, 'f1-score': 0.4678688732503051, 'support': 338647}, '1': {'precision': 0.3434682323338226, 'recall': 0.03434952423392487, 'f1-score': 0.062453233947031034, 'support': 381490}, '2': {'precision': 0.3443356902460864, 'recall': 0.06318180916850087, 'f1-score': 0.10677211114754646, 'support': 353013}, 'accuracy': 0.3183133765084098, 'macro avg': {'precision': 0.3344636128636857, 'recall': 0.33389605642722486, 'f1-score': 0.21236473944829418, 'support': 1073150}, 'weighted avg': {'precision': 0.3349552563204574, 'recall': 0.3183133765084098, 'f1-score': 0.20496633071851816, 'support': 1073150}}
[[306190  12551  19906]
 [345822  13104  22564]
 [318212  12497  22304]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985969
{'0': {'precision': 0.3434293882016623, 'recall': 0.9005089764945401, 'f1-score': 0.4972292127080646, 'support': 108060}, '1': {'precision': 0.31884568009853953, 'recall': 0.035847115612882806, 'f1-score': 0.06444843591613168, 'support': 101096}, '2': {'precision': 0.34183369716213535, 'recall': 0.06517770146909972, 'f1-score': 0.10948064226524824, 'support': 105711}, 'accuracy': 0.34243982379861976, 'macro avg': {'precision': 0.3347029218207791, 'recall': 0.33384459785884085, 'f1-score': 0.22371943029648148, 'support': 314867}, 'weighted avg': {'precision': 0.33500044312366833, 'recall': 0.34243982379861976, 'f1-score': 0.22809432546793523, 'support': 314867}}
[[97309  3962  6789]
 [90995  3624  6477]
 [95041  3780  6890]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989763
{'0': {'precision': 0.33528070365946355, 'recall': 0.9032295810905687, 'f1-score': 0.48903178801653546, 'support': 34184}, '1': {'precision': 0.33983739837398375, 'recall': 0.03715225313305484, 'f1-score': 0.06698181235477928, 'support': 33753}, '2': {'precision': 0.3423047177107502, 'recall': 0.06450390579456687, 'f1-score': 0.10855222819022393, 'support': 34308}, 'accuracy': 0.3358892855396352, 'macro avg': {'precision': 0.33914093991473254, 'recall': 0.3349619133393968, 'f1-score': 0.22152194285384622, 'support': 102245}, 'weighted avg': {'precision': 0.3391418410331321, 'recall': 0.3358892855396352, 'f1-score': 0.22203637927251518, 'support': 102245}}
[[30876  1210  2098]
 [30345  1254  2154]
 [30869  1226  2213]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
6143/6143 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000395
{'0': {'precision': 0.3097248773038959, 'recall': 0.8834539792530265, 'f1-score': 0.4586532418406602, 'support': 484890}, '1': {'precision': 0.3753199694159104, 'recall': 0.03877879428519416, 'f1-score': 0.07029461162849703, 'support': 582277}, '2': {'precision': 0.3296917553849963, 'recall': 0.08432426014426074, 'f1-score': 0.13429921696610214, 'support': 505335}, 'accuracy': 0.313875594434856, 'macro avg': {'precision': 0.3382455340349342, 'recall': 0.3355190112274938, 'f1-score': 0.22108235681175312, 'support': 1572502}, 'weighted avg': {'precision': 0.34043038723954006, 'recall': 0.313875594434856, 'f1-score': 0.21061556730413658, 'support': 1572502}}
[[428378  19116  37396]
 [510457  22580  49240]
 [444257  18466  42612]]
Evaluating performance on  train set...
2083/2083 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992754
{'0': {'precision': 0.33293868434694124, 'recall': 0.8782744241796706, 'f1-score': 0.4828407638976973, 'support': 177703}, '1': {'precision': 0.3292700765517578, 'recall': 0.038535062741450445, 'f1-score': 0.06899546364788099, 'support': 175243}, '2': {'precision': 0.33939504290233746, 'recall': 0.08271990503186868, 'f1-score': 0.13301933918504247, 'support': 180271}, 'accuracy': 0.33332958251518613, 'macro avg': {'precision': 0.33386793460034553, 'recall': 0.33317646398432993, 'f1-score': 0.2282851889102069, 'support': 533217}, 'weighted avg': {'precision': 0.333915765680223, 'recall': 0.33332958251518613, 'f1-score': 0.228561267921287, 'support': 533217}}
[[156072   7044  14587]
 [154052   6753  14438]
 [158647   6712  14912]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099567
{'0': {'precision': 0.3245124625345461, 'recall': 0.8821579105161984, 'f1-score': 0.47448125400175484, 'support': 56703}, '1': {'precision': 0.33857553304097987, 'recall': 0.03759865659109991, 'f1-score': 0.06768133246678656, 'support': 59550}, '2': {'precision': 0.34283534470800386, 'recall': 0.08389341479972845, 'f1-score': 0.1348005126946467, 'support': 58920}, 'accuracy': 0.32655146626477827, 'macro avg': {'precision': 0.33530778009450996, 'recall': 0.3345499939690089, 'f1-score': 0.22565436638772937, 'support': 175173}, 'weighted avg': {'precision': 0.3354561585739943, 'recall': 0.32655146626477827, 'f1-score': 0.22193705709228723, 'support': 175173}}
[[50021  2160  4522]
 [52358  2239  4953]
 [51763  2214  4943]]
testing model on single stock: results/universal/W7/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
23942/23942 - 343s - 343s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1010587
{'0': {'precision': 0.2798948379190336, 'recall': 0.8987433418705187, 'f1-score': 0.4268546977641174, 'support': 1714070}, '1': {'precision': 0.4409013082591545, 'recall': 0.034349974868927824, 'f1-score': 0.06373448908415771, 'support': 2713772}, '2': {'precision': 0.2874299400850266, 'recall': 0.06990563253943342, 'f1-score': 0.11245995815553375, 'support': 1701222}, 'accuracy': 0.28595752956732057, 'macro avg': {'precision': 0.3360753620877382, 'recall': 0.33433298309296, 'f1-score': 0.2010163816679363, 'support': 6129064}, 'weighted avg': {'precision': 0.35327533004717676, 'recall': 0.28595752956732057, 'f1-score': 0.17881018351916492, 'support': 6129064}}
[[1540509   58422  115139]
 [2440865   93218  179689]
 [1522511   59786  118925]]
Evaluating performance on  train set...
9052/9052 - 129s - 129s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988901
{'0': {'precision': 0.3398132513602055, 'recall': 0.8964520357931046, 'f1-score': 0.49281700964487773, 'support': 787973}, '1': {'precision': 0.3233769189913756, 'recall': 0.03410682323190559, 'f1-score': 0.06170551614304329, 'support': 749762}, '2': {'precision': 0.33783088050630367, 'recall': 0.06904131033111138, 'f1-score': 0.11465166303188627, 'support': 779345}, 'accuracy': 0.3391160426053481, 'macro avg': {'precision': 0.3336736836192949, 'recall': 0.33320005645204054, 'f1-score': 0.22305806293993577, 'support': 2317080}, 'weighted avg': {'precision': 0.3338280077593575, 'recall': 0.3391160426053481, 'f1-score': 0.22612259786495464, 'support': 2317080}}
[[706380  26686  54907]
 [673632  25572  50558]
 [698718  26820  53807]]
Evaluating performance on  val set...
2763/2763 - 39s - 39s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0997419
{'0': {'precision': 0.3209674788587488, 'recall': 0.899771818985188, 'f1-score': 0.4731517905549512, 'support': 227451}, '1': {'precision': 0.3338878935244433, 'recall': 0.032226719314209486, 'f1-score': 0.05878001614629292, 'support': 242873}, '2': {'precision': 0.34172125299954603, 'recall': 0.066698735395015, 'f1-score': 0.11161243856973395, 'support': 236991}, 'accuracy': 0.32275294600001414, 'macro avg': {'precision': 0.33219220846091274, 'recall': 0.3328990912314708, 'f1-score': 0.21451474842365936, 'support': 707315}, 'weighted avg': {'precision': 0.33235770465419057, 'recall': 0.32275294600001414, 'f1-score': 0.2097312657077718, 'support': 707315}}
[[204654   7674  15123]
 [219719   7827  15327]
 [213243   7941  15807]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        93 (peak)  18.90 (ave)

============================================
