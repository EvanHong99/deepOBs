This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W9/deepLOB_L1/h10
Epoch 1/50
6697/6697 - 126s - loss: 2.7760 - accuracy10: 0.5363 - val_loss: 3.3465 - val_accuracy10: 0.3817 - 126s/epoch - 19ms/step
Epoch 2/50
6697/6697 - 109s - loss: 2.7268 - accuracy10: 0.5513 - val_loss: 3.2164 - val_accuracy10: 0.4643 - 109s/epoch - 16ms/step
Epoch 3/50
6697/6697 - 105s - loss: 2.6863 - accuracy10: 0.5616 - val_loss: 3.2667 - val_accuracy10: 0.4703 - 105s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 106s - loss: 2.6560 - accuracy10: 0.5677 - val_loss: 3.4483 - val_accuracy10: 0.4842 - 106s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 105s - loss: 2.6379 - accuracy10: 0.5706 - val_loss: 3.6364 - val_accuracy10: 0.5005 - 105s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 105s - loss: 2.6270 - accuracy10: 0.5724 - val_loss: 3.7045 - val_accuracy10: 0.4989 - 105s/epoch - 16ms/step
Epoch 7/50
6697/6697 - 106s - loss: 2.6175 - accuracy10: 0.5740 - val_loss: 3.7852 - val_accuracy10: 0.5023 - 106s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 105s - loss: 2.6100 - accuracy10: 0.5750 - val_loss: 3.7958 - val_accuracy10: 0.5105 - 105s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 106s - loss: 2.6032 - accuracy10: 0.5767 - val_loss: 3.8080 - val_accuracy10: 0.5098 - 106s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 106s - loss: 2.5967 - accuracy10: 0.5781 - val_loss: 3.7930 - val_accuracy10: 0.5111 - 106s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 105s - loss: 2.5921 - accuracy10: 0.5789 - val_loss: 3.8461 - val_accuracy10: 0.5146 - 105s/epoch - 16ms/step
Epoch 12/50
6697/6697 - 105s - loss: 2.5878 - accuracy10: 0.5800 - val_loss: 3.8688 - val_accuracy10: 0.5133 - 105s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 98s - 98s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0263557
{'0': {'precision': 0.3488898764154287, 'recall': 0.28968184280830234, 'f1-score': 0.31654099075995007, 'support': 1070540}, '1': {'precision': 0.5521088229755234, 'recall': 0.43073545321775464, 'f1-score': 0.4839278202056026, 'support': 2171219}, '2': {'precision': 0.3394422015114869, 'recall': 0.5492932509144537, 'f1-score': 0.4195923766894876, 'support': 1065937}, 'accuracy': 0.42501815355586836, 'macro avg': {'precision': 0.413480300300813, 'recall': 0.42323684898017017, 'f1-score': 0.4066870625516801, 'support': 4307696}, 'weighted avg': {'precision': 0.4489810183361166, 'recall': 0.42501815355586836, 'f1-score': 0.42640940988835047, 'support': 4307696}}
[[310116 411165 349259]
 [445845 935221 790153]
 [132904 347521 585512]]
Evaluating performance on  train set...
6697/6697 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0329789
{'0': {'precision': 0.3370871116639932, 'recall': 0.19778246234075553, 'f1-score': 0.24929411657895456, 'support': 416498}, '1': {'precision': 0.5010865108147726, 'recall': 0.6974350328310329, 'f1-score': 0.5831773137063737, 'support': 877828}, '2': {'precision': 0.31131268460383815, 'recall': 0.1838357411259558, 'f1-score': 0.23116461700027116, 'support': 419679}, 'accuracy': 0.4502647308496766, 'macro avg': {'precision': 0.383162102360868, 'recall': 0.359684412099248, 'f1-score': 0.3545453490951998, 'support': 1714005}, 'weighted avg': {'precision': 0.4147684946141897, 'recall': 0.4502647308496766, 'f1-score': 0.41585340252869557, 'support': 1714005}}
[[ 82376 301231  32891]
 [127815 612228 137785]
 [ 34185 308342  77152]]
Evaluating performance on  val set...
2631/2631 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9973146
{'0': {'precision': 0.3477044002056857, 'recall': 0.2877788383786183, 'f1-score': 0.3149161529837961, 'support': 164477}, '1': {'precision': 0.5305488729219175, 'recall': 0.6655772229542721, 'f1-score': 0.5904415039489955, 'support': 347578}, '2': {'precision': 0.3346408603859025, 'recall': 0.20954773556864184, 'f1-score': 0.2577166630976781, 'support': 160813}, 'accuracy': 0.4642381566666865, 'macro avg': {'precision': 0.4042980445045019, 'recall': 0.38763459896717745, 'f1-score': 0.3876914400101566, 'support': 672868}, 'weighted avg': {'precision': 0.43903275748931886, 'recall': 0.4642381566666865, 'f1-score': 0.44357159338328866, 'support': 672868}}
[[ 47333 101034  16110]
 [ 65347 231340  50891]
 [ 23450 103665  33698]]
testing model out of sample: results/universal/W9/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9325767
{'0': {'precision': 0.2979709002416411, 'recall': 0.498287636881579, 'f1-score': 0.37293217923240346, 'support': 348933}, '1': {'precision': 0.749673578707288, 'recall': 0.47235961277946426, 'f1-score': 0.5795513965023242, 'support': 1516965}, '2': {'precision': 0.2518164094474127, 'recall': 0.48992940740440466, 'f1-score': 0.3326537513319676, 'support': 345362}, 'accuracy': 0.4791951195246149, 'macro avg': {'precision': 0.4331536294654472, 'recall': 0.4868588856884826, 'f1-score': 0.42837910902223175, 'support': 2211260}, 'weighted avg': {'precision': 0.6006386762557525, 'recall': 0.4791951195246149, 'f1-score': 0.5083859397622892, 'support': 2211260}}
[[173869 116774  58290]
 [355975 716553 444437]
 [ 53666 122493 169203]]
Evaluating performance on  train set...
3947/3947 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9049671
{'0': {'precision': 0.3475461000067299, 'recall': 0.46537051326097856, 'f1-score': 0.39791955116242667, 'support': 177551}, '1': {'precision': 0.7619580441467594, 'recall': 0.5943914337902609, 'f1-score': 0.6678239520352363, 'support': 655319}, '2': {'precision': 0.3247784215170932, 'recall': 0.4790218892183716, 'f1-score': 0.38710105227535685, 'support': 176708}, 'accuracy': 0.5515076596360063, 'macro avg': {'precision': 0.47809418855686087, 'recall': 0.5129279454232037, 'f1-score': 0.4842815184910066, 'support': 1009578}, 'weighted avg': {'precision': 0.6125566191457694, 'recall': 0.5515076596360063, 'f1-score': 0.5712214325170445, 'support': 1009578}}
[[ 82627  61073  33851]
 [123671 389516 142132]
 [ 31446  60615  84647]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9231881
{'0': {'precision': 0.37180933392796245, 'recall': 0.44328026772589374, 'f1-score': 0.4044113450893112, 'support': 63946}, '1': {'precision': 0.7591812027611637, 'recall': 0.5954906410764613, 'f1-score': 0.6674462205470222, 'support': 229567}, '2': {'precision': 0.31873252562907733, 'recall': 0.5019388527553338, 'f1-score': 0.3898862381798109, 'support': 64729}, 'accuracy': 0.5514177567119434, 'macro avg': {'precision': 0.4832410207727345, 'recall': 0.5135699205192297, 'f1-score': 0.48724793460538146, 'support': 358242}, 'weighted avg': {'precision': 0.6104530135859952, 'recall': 0.5514177567119434, 'f1-score': 0.5703436802400063, 'support': 358242}}
[[ 28346  22345  13255]
 [ 36672 136705  56190]
 [ 11220  21019  32490]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.074744
{'0': {'precision': 0.40401399839777374, 'recall': 0.44825973053892215, 'f1-score': 0.4249883573947176, 'support': 21376}, '1': {'precision': 0.4627051411682352, 'recall': 0.38576014006419607, 'f1-score': 0.42074367452304756, 'support': 30843}, '2': {'precision': 0.40739313109509306, 'recall': 0.45644569207514574, 'f1-score': 0.43052670169864354, 'support': 23155}, 'accuracy': 0.42519967097407596, 'macro avg': {'precision': 0.42470409022036737, 'recall': 0.43015518755942134, 'f1-score': 0.4254195778721362, 'support': 75374}, 'weighted avg': {'precision': 0.42906845662044696, 'recall': 0.42519967097407596, 'f1-score': 0.424952822708307, 'support': 75374}}
[[ 9582  6454  5340]
 [ 8911 11898 10034]
 [ 5224  7362 10569]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0489609
{'0': {'precision': 0.4295932051855163, 'recall': 0.3267818280739935, 'f1-score': 0.3712001236046197, 'support': 14704}, '1': {'precision': 0.495354958581714, 'recall': 0.5784216235762069, 'f1-score': 0.533675299220151, 'support': 22124}, '2': {'precision': 0.4014883061658398, 'recall': 0.39612614502482346, 'f1-score': 0.3987892013656682, 'support': 14301}, 'accuracy': 0.4550646404193315, 'macro avg': {'precision': 0.44214548997769004, 'recall': 0.43377653222500795, 'f1-score': 0.43455487473014626, 'support': 51129}, 'weighted avg': {'precision': 0.45018787496699225, 'recall': 0.4550646404193315, 'f1-score': 0.4492214458753226, 'support': 51129}}
[[ 4805  6615  3284]
 [ 4166 12797  5161]
 [ 2214  6422  5665]]
Evaluating performance on  val set...
53/53 - 0s - 491ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.04359
{'0': {'precision': 0.39651773981603156, 'recall': 0.3314113124656782, 'f1-score': 0.3610529464552797, 'support': 3642}, '1': {'precision': 0.5101158568217188, 'recall': 0.486156888595913, 'f1-score': 0.49784828284532945, 'support': 6068}, '2': {'precision': 0.385772619815173, 'recall': 0.4761273209549072, 'f1-score': 0.42621393802683133, 'support': 3770}, 'accuracy': 0.44154302670623147, 'macro avg': {'precision': 0.43080207215097444, 'recall': 0.4312318406721662, 'f1-score': 0.4283717224424801, 'support': 13480}, 'weighted avg': {'precision': 0.44464862049758, 'recall': 0.44154302670623147, 'f1-score': 0.440854952348423, 'support': 13480}}
[[1207 1414 1021]
 [1281 2950 1837]
 [ 556 1419 1795]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95688444
{'0': {'precision': 0.11724560825772458, 'recall': 0.5853838303662546, 'f1-score': 0.19536239013822004, 'support': 17638}, '1': {'precision': 0.9143075745983168, 'recall': 0.31515476028738343, 'f1-score': 0.4687388565315582, 'support': 250258}, '2': {'precision': 0.11592388582874312, 'recall': 0.7099282624171732, 'f1-score': 0.19930357513471134, 'support': 18261}, 'accuracy': 0.35700332335046847, 'macro avg': {'precision': 0.38249235622826144, 'recall': 0.5368222843569371, 'f1-score': 0.2878016072681632, 'support': 286157}, 'weighted avg': {'precision': 0.8142301223502971, 'recall': 0.35700332335046847, 'f1-score': 0.4346947066843292, 'support': 286157}}
[[10325  4073  3240]
 [75760 78870 95628]
 [ 1978  3319 12964]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73085684
{'0': {'precision': 0.24397098228873929, 'recall': 0.39827163128134, 'f1-score': 0.302585717759585, 'support': 9373}, '1': {'precision': 0.908251405597261, 'recall': 0.7841627118644068, 'f1-score': 0.8416579345674701, 'support': 110625}, '2': {'precision': 0.23537082314588428, 'recall': 0.4698991213797592, 'f1-score': 0.313640312771503, 'support': 9219}, 'accuracy': 0.7337502031466447, 'macro avg': {'precision': 0.4625310703439615, 'recall': 0.550777821508502, 'f1-score': 0.48596132169951933, 'support': 129217}, 'weighted avg': {'precision': 0.8120598325280053, 'recall': 0.7337502031466447, 'f1-score': 0.7648838387172544, 'support': 129217}}
[[ 3733  4688   952]
 [10756 86748 13121]
 [  812  4075  4332]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75845474
{'0': {'precision': 0.19920174165457186, 'recall': 0.49623380536306116, 'f1-score': 0.284284111504272, 'support': 3319}, '1': {'precision': 0.9132448870261243, 'recall': 0.7069154774972558, 'f1-score': 0.7969420305796941, 'support': 40995}, '2': {'precision': 0.22043010752688172, 'recall': 0.49214061160331524, 'f1-score': 0.30448236230218373, 'support': 3499}, 'accuracy': 0.6765733168803464, 'macro avg': {'precision': 0.444292245402526, 'recall': 0.5650966314878775, 'f1-score': 0.4619028347953833, 'support': 47813}, 'weighted avg': {'precision': 0.8129778443189937, 'recall': 0.6765733168803464, 'f1-score': 0.7253165728022207, 'support': 47813}}
[[ 1647  1369   303]
 [ 6228 28980  5787]
 [  393  1384  1722]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0128981
{'0': {'precision': 0.4839687439170212, 'recall': 0.45623509057068706, 'f1-score': 0.4696928806606574, 'support': 38147}, '1': {'precision': 0.5090193089430894, 'recall': 0.5357565802039959, 'f1-score': 0.5220458225539281, 'support': 52354}, '2': {'precision': 0.451538897767696, 'recall': 0.44506834696885006, 'f1-score': 0.4482802743371891, 'support': 39358}, 'accuracy': 0.48491055683472073, 'macro avg': {'precision': 0.48150898354260224, 'recall': 0.47902000591451105, 'f1-score': 0.4800063258505915, 'support': 129859}, 'weighted avg': {'precision': 0.484239217250634, 'recall': 0.48491055683472073, 'f1-score': 0.4843097232376156, 'support': 129859}}
[[17404 12887  7856]
 [10884 28049 13421]
 [ 7673 14168 17517]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0756292
{'0': {'precision': 0.464093023255814, 'recall': 0.44778530718484943, 'f1-score': 0.45579334444875863, 'support': 22283}, '1': {'precision': 0.4068647969861867, 'recall': 0.42317906743872175, 'f1-score': 0.41486160609488043, 'support': 22969}, '2': {'precision': 0.4568148010412793, 'recall': 0.45390300230946884, 'f1-score': 0.45535424679115893, 'support': 21650}, 'accuracy': 0.44131715045888015, 'macro avg': {'precision': 0.44259087376109335, 'recall': 0.44162245897768, 'f1-score': 0.44200306577826604, 'support': 66902}, 'weighted avg': {'precision': 0.44208996445141735, 'recall': 0.44131715045888015, 'f1-score': 0.44159843902683915, 'support': 66902}}
[[9978 7036 5269]
 [6833 9720 6416]
 [4689 7134 9827]]
Evaluating performance on  val set...
73/73 - 1s - 565ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0823623
{'0': {'precision': 0.493234100135318, 'recall': 0.5346926800645445, 'f1-score': 0.5131273315971001, 'support': 6817}, '1': {'precision': 0.3424657534246575, 'recall': 0.3335295271728468, 'f1-score': 0.3379385746943644, 'support': 5097}, '2': {'precision': 0.508095238095238, 'recall': 0.47492581602373884, 'f1-score': 0.4909509202453987, 'support': 6740}, 'accuracy': 0.45813230406347166, 'macro avg': {'precision': 0.4479316972184046, 'recall': 0.44771600775371007, 'f1-score': 0.4473389421789544, 'support': 18654}, 'weighted avg': {'precision': 0.45740788627585754, 'recall': 0.45813230406347166, 'f1-score': 0.45724622800303394, 'support': 18654}}
[[3645 1558 1614]
 [1912 1700 1485]
 [1833 1706 3201]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.14834
{'0': {'precision': 0.41291322907295036, 'recall': 0.41184893844508935, 'f1-score': 0.4123803970673982, 'support': 52376}, '1': {'precision': 0.37657926480858356, 'recall': 0.22058386017106732, 'f1-score': 0.278206421050163, 'support': 53780}, '2': {'precision': 0.35804949836562, 'recall': 0.5243493037135278, 'f1-score': 0.4255286945553921, 'support': 48256}, 'accuracy': 0.3803914203559309, 'macro avg': {'precision': 0.38251399741571795, 'recall': 0.38559403410989485, 'f1-score': 0.3720385042243177, 'support': 154412}, 'weighted avg': {'precision': 0.3831127939568287, 'recall': 0.3803914203559309, 'f1-score': 0.36975811261653774, 'support': 154412}}
[[21571 10187 20618]
 [17169 11863 24748]
 [13501  9452 25303]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1887784
{'0': {'precision': 0.42652513613763715, 'recall': 0.367528051683101, 'f1-score': 0.3948348918760959, 'support': 29410}, '1': {'precision': 0.32335426372290865, 'recall': 0.3078762632106765, 'f1-score': 0.3154255003852917, 'support': 25926}, '2': {'precision': 0.37438665358194306, 'recall': 0.4471958679805121, 'f1-score': 0.40756505917505464, 'support': 27299}, 'accuracy': 0.3751316028317299, 'macro avg': {'precision': 0.3747553511474963, 'recall': 0.3742000609580965, 'f1-score': 0.37260848381214745, 'support': 82635}, 'weighted avg': {'precision': 0.3769319071969686, 'recall': 0.3751316028317299, 'f1-score': 0.3741263900706101, 'support': 82635}}
[[10809  8499 10102]
 [ 7646  7982 10298]
 [ 6887  8204 12208]]
Evaluating performance on  val set...
112/112 - 1s - 766ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1956978
{'0': {'precision': 0.4577135129512119, 'recall': 0.4037808571166376, 'f1-score': 0.4290589956118966, 'support': 10897}, '1': {'precision': 0.2758899676375405, 'recall': 0.22959870724481551, 'f1-score': 0.25062472438630023, 'support': 7426}, '2': {'precision': 0.40528355611801, 'recall': 0.5066745772767725, 'f1-score': 0.4503427667428371, 'support': 10113}, 'accuracy': 0.39488676325784217, 'macro avg': {'precision': 0.3796290122355874, 'recall': 0.38001804721274185, 'f1-score': 0.37667549558034463, 'support': 28436}, 'weighted avg': {'precision': 0.39158445819831084, 'recall': 0.39488676325784217, 'f1-score': 0.39003064701595913, 'support': 28436}}
[[4400 2350 4147]
 [2349 1705 3372]
 [2864 2125 5124]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.130709
{'0': {'precision': 0.5293703079515857, 'recall': 0.2824814415121489, 'f1-score': 0.3683857004254049, 'support': 61158}, '1': {'precision': 0.2775401834687356, 'recall': 0.4368181363226904, 'f1-score': 0.33942233845017156, 'support': 39964}, '2': {'precision': 0.46121567792744855, 'recall': 0.5040374838002193, 'f1-score': 0.48167672276913304, 'support': 60186}, 'accuracy': 0.4033835891586282, 'macro avg': {'precision': 0.4227087231159233, 'recall': 0.4077790205450195, 'f1-score': 0.3964949205482365, 'support': 161308}, 'weighted avg': {'precision': 0.44155015236435297, 'recall': 0.4033835891586282, 'f1-score': 0.40348031242729815, 'support': 161308}}
[[17276 24470 19412]
 [ 6481 17457 16026]
 [ 8878 20972 30336]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1061358
{'0': {'precision': 0.46058171745152354, 'recall': 0.4007761467447634, 'f1-score': 0.42860272983876163, 'support': 41487}, '1': {'precision': 0.37245833665576905, 'recall': 0.4785125236900067, 'f1-score': 0.4188768075327878, 'support': 39046}, '2': {'precision': 0.4600611209241035, 'recall': 0.39637180540122713, 'f1-score': 0.42584830986829303, 'support': 41398}, 'accuracy': 0.42417432810359956, 'macro avg': {'precision': 0.4310337250104654, 'recall': 0.4252201586119991, 'f1-score': 0.4244426157466141, 'support': 121931}, 'weighted avg': {'precision': 0.43218518841794584, 'recall': 0.42417432810359956, 'f1-score': 0.424553014505528, 'support': 121931}}
[[16627 15404  9456]
 [10560 18684  9802]
 [ 8913 16076 16409]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1066316
{'0': {'precision': 0.4536911796113049, 'recall': 0.4067007019783025, 'f1-score': 0.4289127435474644, 'support': 15670}, '1': {'precision': 0.4035247645092677, 'recall': 0.5036025786879029, 'f1-score': 0.44804318488529016, 'support': 15822}, '2': {'precision': 0.4692707537073842, 'recall': 0.39907690307482285, 'f1-score': 0.4313367293167047, 'support': 15383}, 'accuracy': 0.43690666666666667, 'macro avg': {'precision': 0.4421622326093189, 'recall': 0.4364600612470095, 'f1-score': 0.43609755258315314, 'support': 46875}, 'weighted avg': {'precision': 0.4418709677409167, 'recall': 0.43690666666666667, 'f1-score': 0.43616543722075085, 'support': 46875}}
[[6373 5731 3566]
 [4477 7968 3377]
 [3197 6047 6139]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8693326
{'0': {'precision': 0.21290811637563814, 'recall': 0.697676463476292, 'f1-score': 0.3262541118421053, 'support': 45491}, '1': {'precision': 0.9317944074068292, 'recall': 0.4653822235305356, 'f1-score': 0.6207383427267587, 'support': 512959}, '2': {'precision': 0.15290918591496422, 'recall': 0.6860830374214696, 'f1-score': 0.25008193354878056, 'support': 43932}, 'accuracy': 0.4990205550630663, 'macro avg': {'precision': 0.4325372365658105, 'recall': 0.6163805748094324, 'f1-score': 0.3990247960392148, 'support': 602382}, 'weighted avg': {'precision': 0.8207007130137688, 'recall': 0.4990205550630663, 'f1-score': 0.5714671833707673, 'support': 602382}}
[[ 31738   8687   5066]
 [112327 238722 161910]
 [  5004   8787  30141]]
Evaluating performance on  train set...
1250/1250 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83339816
{'0': {'precision': 0.1920615889442797, 'recall': 0.6815962735701169, 'f1-score': 0.29967901380437567, 'support': 22327}, '1': {'precision': 0.9363187050121073, 'recall': 0.5139039088244397, 'f1-score': 0.6635916966405717, 'support': 274635}, '2': {'precision': 0.17909203108842855, 'recall': 0.7019830028328612, 'f1-score': 0.2853776509983877, 'support': 22945}, 'accuracy': 0.539097300152857, 'macro avg': {'precision': 0.43582410834827184, 'recall': 0.6324943950758058, 'f1-score': 0.4162161204811117, 'support': 319907}, 'weighted avg': {'precision': 0.8300640914412096, 'recall': 0.539097300152857, 'f1-score': 0.611066432276417, 'support': 319907}}
[[ 15218   4822   2287]
 [ 61956 141136  71543]
 [  2061   4777  16107]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8363043
{'0': {'precision': 0.1733046594982079, 'recall': 0.6535467128027682, 'f1-score': 0.2739614260136437, 'support': 9248}, '1': {'precision': 0.9346255657074545, 'recall': 0.5060707779658039, 'f1-score': 0.6566084369151031, 'support': 108141}, '2': {'precision': 0.19298562776823647, 'recall': 0.6939328277356447, 'f1-score': 0.3019873170041727, 'support': 9230}, 'accuracy': 0.5305364913638554, 'macro avg': {'precision': 0.4336386176579663, 'recall': 0.6178501061680722, 'f1-score': 0.4108523933109732, 'support': 126619}, 'weighted avg': {'precision': 0.8249577246425109, 'recall': 0.5305364913638554, 'f1-score': 0.6028102510694197, 'support': 126619}}
[[ 6044  1900  1304]
 [27934 54727 25480]
 [  897  1928  6405]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
3870/3870 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9538526
{'0': {'precision': 0.19288414692018097, 'recall': 0.5789523662563653, 'f1-score': 0.28936369649886245, 'support': 84247}, '1': {'precision': 0.8887467264348253, 'recall': 0.35928604307483586, 'f1-score': 0.5117081897808456, 'support': 825540}, '2': {'precision': 0.13866891697930175, 'recall': 0.6925510746375647, 'f1-score': 0.23107073564493416, 'support': 80911}, 'accuracy': 0.4051840217705093, 'macro avg': {'precision': 0.4067665967781027, 'recall': 0.5435964946562553, 'f1-score': 0.34404754064154747, 'support': 990698}, 'weighted avg': {'precision': 0.7683125675112925, 'recall': 0.4051840217705093, 'f1-score': 0.469880595925687, 'support': 990698}}
[[ 48775  21464  14008]
 [194886 296605 334049]
 [  9211  15665  56035]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76412636
{'0': {'precision': 0.23260321435309858, 'recall': 0.46176110051757013, 'f1-score': 0.3093681917211329, 'support': 29368}, '1': {'precision': 0.909355633258271, 'recall': 0.6973492386726524, 'f1-score': 0.7893652027994925, 'support': 345712}, '2': {'precision': 0.18615161805833, 'recall': 0.5244460077383046, 'f1-score': 0.27477286548845437, 'support': 28430}, 'accuracy': 0.6680206190676811, 'macro avg': {'precision': 0.44270348855656655, 'recall': 0.5611854489761757, 'f1-score': 0.4578354200030266, 'support': 403510}, 'weighted avg': {'precision': 0.8091460840759919, 'recall': 0.6680206190676811, 'f1-score': 0.7181738757664521, 'support': 403510}}
[[ 13561  12868   2939]
 [ 42383 241082  62247]
 [  2357  11163  14910]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81064326
{'0': {'precision': 0.21709317987020937, 'recall': 0.3436046511627907, 'f1-score': 0.2660763862834847, 'support': 10320}, '1': {'precision': 0.9138468479553751, 'recall': 0.6725884110908186, 'f1-score': 0.7748728426726949, 'support': 132506}, '2': {'precision': 0.169150333400687, 'recall': 0.6303652108433735, 'f1-score': 0.2667277361797037, 'support': 10624}, 'accuracy': 0.6475399152818507, 'macro avg': {'precision': 0.43336345374209045, 'recall': 0.5488527576989942, 'f1-score': 0.435892321711961, 'support': 153450}, 'weighted avg': {'precision': 0.8154294245258024, 'recall': 0.6475399152818507, 'f1-score': 0.7054736048667763, 'support': 153450}}
[[ 3546  5095  1679]
 [12168 89122 31216]
 [  620  3307  6697]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93513215
{'0': {'precision': 0.43611888376314, 'recall': 0.21709406857504254, 'f1-score': 0.2898865447160602, 'support': 132818}, '1': {'precision': 0.6310324169606604, 'recall': 0.7229545702146203, 'f1-score': 0.6738731968865352, 'support': 367160}, '2': {'precision': 0.34552787696860193, 'recall': 0.38139019966552296, 'f1-score': 0.36257440892720516, 'support': 127363}, 'accuracy': 0.5465113869490437, 'macro avg': {'precision': 0.47089305923080077, 'recall': 0.44047961281839526, 'f1-score': 0.4421113835099335, 'support': 627341}, 'weighted avg': {'precision': 0.5318029064086053, 'recall': 0.5465113869490437, 'f1-score': 0.5293771625147305, 'support': 627341}}
[[ 28834  83662  20322]
 [ 30035 265440  71685]
 [  7246  71542  48575]]
Evaluating performance on  train set...
1200/1200 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8849314
{'0': {'precision': 0.4391053474594261, 'recall': 0.3516357848212768, 'f1-score': 0.3905327474941645, 'support': 64709}, '1': {'precision': 0.6653167830359452, 'recall': 0.7221879140374121, 'f1-score': 0.6925868297646672, 'support': 178124}, '2': {'precision': 0.41679182210164234, 'recall': 0.401640237165222, 'f1-score': 0.4090757794297126, 'support': 64259}, 'accuracy': 0.5770322899977857, 'macro avg': {'precision': 0.5070713175323379, 'recall': 0.49182131200797025, 'f1-score': 0.4973984522295148, 'support': 307092}, 'weighted avg': {'precision': 0.565646712668113, 'recall': 0.5770322899977857, 'f1-score': 0.5696147100314414, 'support': 307092}}
[[ 22754  32758   9197]
 [ 22568 128639  26917]
 [  6497  31953  25809]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8914309
{'0': {'precision': 0.41505023580069716, 'recall': 0.4084507042253521, 'f1-score': 0.411724025709869, 'support': 24779}, '1': {'precision': 0.6556324110671937, 'recall': 0.7015596087761036, 'f1-score': 0.6778189247861065, 'support': 64311}, '2': {'precision': 0.44002457379818766, 'recall': 0.3635171713754018, 'f1-score': 0.39812863330013665, 'support': 23644}, 'accuracy': 0.5662355633615413, 'macro avg': {'precision': 0.5035690735553595, 'recall': 0.49117582812561916, 'f1-score': 0.49589052793203736, 'support': 112734}, 'weighted avg': {'precision': 0.5575323043973612, 'recall': 0.5662355633615413, 'f1-score': 0.5606709236852464, 'support': 112734}}
[[10121 11839  2819]
 [11074 45118  8119]
 [ 3190 11859  8595]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
3337/3337 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84563756
{'0': {'precision': 0.3399515291014403, 'recall': 0.5620360404152633, 'f1-score': 0.42365331365190034, 'support': 144005}, '1': {'precision': 0.758231239628659, 'recall': 0.6384356566666197, 'f1-score': 0.6931958660458221, 'support': 568264}, '2': {'precision': 0.3993874492572277, 'recall': 0.3872890682318415, 'f1-score': 0.3932452276064611, 'support': 141752}, 'accuracy': 0.5838673756265946, 'macro avg': {'precision': 0.4991900726624423, 'recall': 0.5292535884379083, 'f1-score': 0.5033648024347278, 'support': 854021}, 'weighted avg': {'precision': 0.6281393628630956, 'recall': 0.5838673756265946, 'f1-score': 0.5979592405324646, 'support': 854021}}
[[ 80936  51453  11616]
 [134521 362800  70943]
 [ 22624  64229  54899]]
Evaluating performance on  train set...
1431/1431 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9419437
{'0': {'precision': 0.3395338737695426, 'recall': 0.5383522931041903, 'f1-score': 0.4164294789638088, 'support': 69709}, '1': {'precision': 0.7330247229675755, 'recall': 0.476169567300016, 'f1-score': 0.5773167603668422, 'support': 225468}, '2': {'precision': 0.34581863171882876, 'recall': 0.5319967855179123, 'f1-score': 0.4191642043056142, 'support': 70929}, 'accuracy': 0.4988254767744861, 'macro avg': {'precision': 0.4727924094853156, 'recall': 0.515506215307373, 'f1-score': 0.4709701478787551, 'support': 366106}, 'weighted avg': {'precision': 0.583084556860142, 'recall': 0.4988254767744861, 'f1-score': 0.5160424459655735, 'support': 366106}}
[[ 37528  19228  12953]
 [ 59679 107361  58428]
 [ 13321  19874  37734]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9554651
{'0': {'precision': 0.3785680069880808, 'recall': 0.4885987562279521, 'f1-score': 0.4266027371161845, 'support': 27497}, '1': {'precision': 0.6710049359864261, 'recall': 0.4966321317464395, 'f1-score': 0.5707982745329594, 'support': 70074}, '2': {'precision': 0.38287795992714024, 'recall': 0.5215511130015597, 'f1-score': 0.4415833858527655, 'support': 28212}, 'accuracy': 0.5004650866969305, 'macro avg': {'precision': 0.477483634300549, 'recall': 0.5022606669919837, 'f1-score': 0.4796614658339698, 'support': 125783}, 'weighted avg': {'precision': 0.5424519798218247, 'recall': 0.5004650866969305, 'f1-score': 0.5102944295634907, 'support': 125783}}
[[13435  8591  5471]
 [17028 34801 18245]
 [ 5026  8472 14714]]
testing model on single stock: results/universal/W9/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
10303/10303 - 61s - 61s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0843526
{'0': {'precision': 0.4081738250126544, 'recall': 0.26480114130454613, 'f1-score': 0.32121520152667365, 'support': 822217}, '1': {'precision': 0.3781198558526494, 'recall': 0.344416054918536, 'f1-score': 0.36048187252073277, 'support': 987062}, '2': {'precision': 0.38870574995393864, 'recall': 0.5655631698113207, 'f1-score': 0.4607457112234443, 'support': 828125}, 'accuracy': 0.38903444447646246, 'macro avg': {'precision': 0.3916664769397475, 'recall': 0.391593455344801, 'f1-score': 0.38081426175695027, 'support': 2637404}, 'weighted avg': {'precision': 0.3908131436134407, 'recall': 0.38903444447646246, 'f1-score': 0.3797224845016658, 'support': 2637404}}
[[217724 304487 300006]
 [210551 339960 436551]
 [105135 254633 468357]]
Evaluating performance on  train set...
3419/3419 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1877507
{'0': {'precision': 0.4115539446926833, 'recall': 0.10234657474396155, 'f1-score': 0.16392719979281806, 'support': 290679}, '1': {'precision': 0.32683482454554214, 'recall': 0.8582826721383068, 'f1-score': 0.4733989116585212, 'support': 288518}, '2': {'precision': 0.41474583019953104, 'recall': 0.06335041914872769, 'f1-score': 0.10991227067413523, 'support': 295957}, 'accuracy': 0.3383735891054603, 'macro avg': {'precision': 0.3843781998125855, 'recall': 0.34132655534366535, 'f1-score': 0.24907946070849152, 'support': 875154}, 'weighted avg': {'precision': 0.3847034358134887, 'recall': 0.3383735891054603, 'f1-score': 0.24768624447168708, 'support': 875154}}
[[ 29750 250516  10413]
 [ 24844 247630  16044]
 [ 17693 259515  18749]]
Evaluating performance on  val set...
1396/1396 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1044357
{'0': {'precision': 0.4262264534489768, 'recall': 0.21646850319183716, 'f1-score': 0.2871178665571189, 'support': 116234}, '1': {'precision': 0.3726970369249283, 'recall': 0.7968430606526972, 'f1-score': 0.5078595393429676, 'support': 126705}, '2': {'precision': 0.4344931035744338, 'recall': 0.1038774742624227, 'f1-score': 0.16766906677961319, 'support': 114327}, 'accuracy': 0.38626961423701106, 'macro avg': {'precision': 0.4111388646494463, 'recall': 0.3723963460356523, 'f1-score': 0.3208821575598999, 'support': 357266}, 'weighted avg': {'precision': 0.4098875255583114, 'recall': 0.38626961423701106, 'f1-score': 0.32718003513226473, 'support': 357266}}
[[ 25161  83615   7458]
 [ 17742 100964   7999]
 [ 16129  86322  11876]]
training model: results/universal/W9/deepLOB_L1/h20
Epoch 1/50
6697/6697 - 106s - loss: 2.8654 - accuracy20: 0.5111 - val_loss: 3.1779 - val_accuracy20: 0.3872 - 106s/epoch - 16ms/step
Epoch 2/50
6697/6697 - 103s - loss: 2.8151 - accuracy20: 0.5260 - val_loss: 3.1903 - val_accuracy20: 0.4281 - 103s/epoch - 15ms/step
Epoch 3/50
6697/6697 - 104s - loss: 2.7807 - accuracy20: 0.5354 - val_loss: 3.1668 - val_accuracy20: 0.4452 - 104s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 106s - loss: 2.7573 - accuracy20: 0.5398 - val_loss: 3.1830 - val_accuracy20: 0.4511 - 106s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 104s - loss: 2.7368 - accuracy20: 0.5441 - val_loss: 3.2413 - val_accuracy20: 0.4509 - 104s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 105s - loss: 2.7263 - accuracy20: 0.5459 - val_loss: 3.3224 - val_accuracy20: 0.4537 - 105s/epoch - 16ms/step
Epoch 7/50
6697/6697 - 107s - loss: 2.7171 - accuracy20: 0.5476 - val_loss: 3.3286 - val_accuracy20: 0.4570 - 107s/epoch - 16ms/step
Epoch 8/50
6697/6697 - 107s - loss: 2.7116 - accuracy20: 0.5489 - val_loss: 3.4098 - val_accuracy20: 0.4645 - 107s/epoch - 16ms/step
Epoch 9/50
6697/6697 - 104s - loss: 2.7036 - accuracy20: 0.5506 - val_loss: 3.3918 - val_accuracy20: 0.4603 - 104s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 106s - loss: 2.6982 - accuracy20: 0.5515 - val_loss: 3.3924 - val_accuracy20: 0.4606 - 106s/epoch - 16ms/step
Epoch 11/50
6697/6697 - 109s - loss: 2.6929 - accuracy20: 0.5528 - val_loss: 3.4035 - val_accuracy20: 0.4651 - 109s/epoch - 16ms/step
Epoch 12/50
6697/6697 - 109s - loss: 2.6891 - accuracy20: 0.5536 - val_loss: 3.4172 - val_accuracy20: 0.4675 - 109s/epoch - 16ms/step
Epoch 13/50
6697/6697 - 103s - loss: 2.6851 - accuracy20: 0.5545 - val_loss: 3.4236 - val_accuracy20: 0.4669 - 103s/epoch - 15ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 109s - 109s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0775617
{'0': {'precision': 0.34904763804804795, 'recall': 0.5058442565427549, 'f1-score': 0.4130668312183081, 'support': 1141377}, '1': {'precision': 0.6010327625018437, 'recall': 0.21516188870734293, 'f1-score': 0.3168835869318743, 'support': 2026423}, '2': {'precision': 0.35317205737060886, 'recall': 0.5974001136945827, 'f1-score': 0.44391164321700255, 'support': 1139896}, 'accuracy': 0.39332905571795224, 'macro avg': {'precision': 0.43441748597350016, 'recall': 0.43946875298156013, 'f1-score': 0.3912873537890616, 'support': 4307696}, 'weighted avg': {'precision': 0.46867768179745456, 'recall': 0.39332905571795224, 'f1-score': 0.37598249178985627, 'support': 4307696}}
[[577359 150232 413786]
 [757009 436009 833405]
 [319730 139192 680974]]
Evaluating performance on  train set...
6697/6697 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0507722
{'0': {'precision': 0.3636517215231184, 'recall': 0.4266540536279379, 'f1-score': 0.39264164827078735, 'support': 443985}, '1': {'precision': 0.5061476777124695, 'recall': 0.5084589810711866, 'f1-score': 0.5073006967838267, 'support': 820548}, '2': {'precision': 0.3543471482219601, 'recall': 0.2907522604300157, 'f1-score': 0.3194150636031564, 'support': 449472}, 'accuracy': 0.4301784417198316, 'macro avg': {'precision': 0.408048849152516, 'recall': 0.40862176504304676, 'f1-score': 0.4064524695525901, 'support': 1714005}, 'weighted avg': {'precision': 0.4294290247914528, 'recall': 0.4301784417198316, 'f1-score': 0.4283299650934034, 'support': 1714005}}
[[189428 194927  59630]
 [224843 417215 178490]
 [106634 212153 130685]]
Evaluating performance on  val set...
2631/2631 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0337006
{'0': {'precision': 0.3649191803987887, 'recall': 0.5234216345502956, 'f1-score': 0.43002998549388005, 'support': 177272}, '1': {'precision': 0.5558099804754795, 'recall': 0.4803814215210331, 'f1-score': 0.5153503262079511, 'support': 322373}, '2': {'precision': 0.37205481017903325, 'recall': 0.3006413697950041, 'f1-score': 0.3325574638326676, 'support': 173223}, 'accuracy': 0.4454484386239203, 'macro avg': {'precision': 0.43092799035110047, 'recall': 0.4348148086221109, 'f1-score': 0.4259792585114996, 'support': 672868}, 'weighted avg': {'precision': 0.45821250849664197, 'recall': 0.4454484386239203, 'f1-score': 0.445813900878914, 'support': 672868}}
[[ 92788  59355  25129]
 [104744 154862  62767]
 [ 56738  64407  52078]]
testing model out of sample: results/universal/W9/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 58s - 58s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0402792
{'0': {'precision': 0.31661939007309237, 'recall': 0.6325820819008292, 'f1-score': 0.4220131528580483, 'support': 425246}, '1': {'precision': 0.7509055019308635, 'recall': 0.2933970444575347, 'f1-score': 0.42193415250273214, 'support': 1366585}, '2': {'precision': 0.29453830651981655, 'recall': 0.5812354415169194, 'f1-score': 0.3909596582849619, 'support': 419429}, 'accuracy': 0.4132223257328401, 'macro avg': {'precision': 0.45402106617459076, 'recall': 0.5024048559584278, 'f1-score': 0.4116356545485808, 'support': 2211260}, 'weighted avg': {'precision': 0.5808250643852426, 'recall': 0.4132223257328401, 'f1-score': 0.4160741421239579, 'support': 2211260}}
[[269003  59625  96618]
 [478346 400952 487287]
 [102261  73381 243787]]
Evaluating performance on  train set...
3947/3947 - 27s - 27s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9739387
{'0': {'precision': 0.3531258135517005, 'recall': 0.5732280666368923, 'f1-score': 0.4370287245746965, 'support': 208233}, '1': {'precision': 0.768352606276798, 'recall': 0.4387395499259769, 'f1-score': 0.5585433969230504, 'support': 593058}, '2': {'precision': 0.34538764230572827, 'recall': 0.5520411739570881, 'f1-score': 0.4249210546252104, 'support': 208287}, 'accuracy': 0.48985417669560943, 'macro avg': {'precision': 0.4889553540447422, 'recall': 0.5213362635066524, 'f1-score': 0.4734977253743191, 'support': 1009578}, 'weighted avg': {'precision': 0.5954466751053904, 'recall': 0.48985417669560943, 'f1-score': 0.5059123356506129, 'support': 1009578}}
[[119365  37686  51182]
 [166115 260198 166745]
 [ 52544  40760 114983]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9925137
{'0': {'precision': 0.3645735221685519, 'recall': 0.5639000267308206, 'f1-score': 0.4428408739051258, 'support': 74820}, '1': {'precision': 0.7645740113814792, 'recall': 0.4052805788622893, 'f1-score': 0.5297530146053108, 'support': 207856}, '2': {'precision': 0.3297137589166969, 'recall': 0.5774157689966387, 'f1-score': 0.4197458417908438, 'support': 75566}, 'accuracy': 0.4747182072453816, 'macro avg': {'precision': 0.4862870974889093, 'recall': 0.5155321248632495, 'f1-score': 0.4641132434337601, 'support': 358242}, 'weighted avg': {'precision': 0.589305096958645, 'recall': 0.4747182072453816, 'f1-score': 0.4883967013084727, 'support': 358242}}
[[42191 12803 19826]
 [54739 84240 68877]
 [18797 13136 43633]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1195036
{'0': {'precision': 0.41024784554746474, 'recall': 0.508613549776379, 'f1-score': 0.45416558813741076, 'support': 24148}, '1': {'precision': 0.39362809745262717, 'recall': 0.2301822462150424, 'f1-score': 0.2904927773793668, 'support': 24637}, '2': {'precision': 0.4390731251409971, 'recall': 0.5123923426981083, 'f1-score': 0.472907771876844, 'support': 26589}, 'accuracy': 0.418937564677475, 'macro avg': {'precision': 0.4143163560470297, 'recall': 0.41706271289650987, 'f1-score': 0.4058553791312072, 'support': 75374}, 'weighted avg': {'precision': 0.41498389014241677, 'recall': 0.418937564677475, 'f1-score': 0.4072784504613137, 'support': 75374}}
[[12282  3847  8019]
 [ 9580  5671  9386]
 [ 8076  4889 13624]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.091315
{'0': {'precision': 0.43709130540082347, 'recall': 0.42995830851697436, 'f1-score': 0.43349546628235147, 'support': 16790}, '1': {'precision': 0.43741653514629114, 'recall': 0.4038784889586369, 'f1-score': 0.4199790185336286, 'support': 17842}, '2': {'precision': 0.423066321186394, 'recall': 0.4651754864520822, 'f1-score': 0.4431227624437002, 'support': 16497}, 'accuracy': 0.4322204619687457, 'macro avg': {'precision': 0.4325247205778362, 'recall': 0.43300409464256456, 'f1-score': 0.4321990824198934, 'support': 51129}, 'weighted avg': {'precision': 0.4326795739868156, 'recall': 0.4322204619687457, 'f1-score': 0.43188505035481634, 'support': 51129}}
[[7219 4584 4987]
 [5158 7206 5478]
 [4139 4684 7674]]
Evaluating performance on  val set...
53/53 - 1s - 518ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0734892
{'0': {'precision': 0.41867720465890185, 'recall': 0.4783745247148289, 'f1-score': 0.4465394853593611, 'support': 4208}, '1': {'precision': 0.4961214165261383, 'recall': 0.2950852557673019, 'f1-score': 0.370062893081761, 'support': 4985}, '2': {'precision': 0.41089889609251795, 'recall': 0.5470025658968976, 'f1-score': 0.4692815689413648, 'support': 4287}, 'accuracy': 0.4324183976261128, 'macro avg': {'precision': 0.4418991724258527, 'recall': 0.44015411545967614, 'f1-score': 0.42862798246082895, 'support': 13480}, 'weighted avg': {'precision': 0.44484291588546604, 'recall': 0.4324183976261128, 'f1-score': 0.42549048682910984, 'support': 13480}}
[[2013  710 1485]
 [1637 1471 1877]
 [1158  784 2345]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.140345
{'0': {'precision': 0.15640227580011434, 'recall': 0.7104406248711924, 'f1-score': 0.2563660161827701, 'support': 24261}, '1': {'precision': 0.91400234348845, 'recall': 0.18452245173826723, 'f1-score': 0.30705534194192363, 'support': 236730}, '2': {'precision': 0.14994304083893822, 'recall': 0.763609632043233, 'f1-score': 0.25066524053010536, 'support': 25166}, 'accuracy': 0.2800385802199492, 'macro avg': {'precision': 0.4067825533758342, 'recall': 0.5528575695508975, 'f1-score': 0.27136219955159974, 'support': 286157}, 'weighted avg': {'precision': 0.7825764071924156, 'recall': 0.2800385802199492, 'f1-score': 0.29779858070815113, 'support': 286157}}
[[ 17236   1755   5270]
 [ 89373  43682 103675]
 [  3594   2355  19217]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82630956
{'0': {'precision': 0.25499428729702595, 'recall': 0.5729733934961879, 'f1-score': 0.3529242638426336, 'support': 12854}, '1': {'precision': 0.8997387647905228, 'recall': 0.6208944288592609, 'f1-score': 0.7347502196059641, 'support': 103731}, '2': {'precision': 0.2575910403116413, 'recall': 0.5862887903736542, 'f1-score': 0.3579247517096392, 'support': 12632}, 'accuracy': 0.6127444531292322, 'macro avg': {'precision': 0.47077469746639666, 'recall': 0.5933855375763677, 'f1-score': 0.4818664117194123, 'support': 129217}, 'weighted avg': {'precision': 0.7728270150260286, 'recall': 0.6127444531292322, 'f1-score': 0.6599299548896478, 'support': 129217}}
[[ 7365  3624  1865]
 [19845 64406 19480]
 [ 1673  3553  7406]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8643423
{'0': {'precision': 0.2225614084907, 'recall': 0.6785714285714286, 'f1-score': 0.3351865711536406, 'support': 4620}, '1': {'precision': 0.9125039200752655, 'recall': 0.5304166666666666, 'f1-score': 0.6708716918364322, 'support': 38400}, '2': {'precision': 0.26056461511485185, 'recall': 0.6200709367828082, 'f1-score': 0.3669362306315205, 'support': 4793}, 'accuracy': 0.5537196996632715, 'macro avg': {'precision': 0.4652099812269392, 'recall': 0.6096863440069679, 'f1-score': 0.45766483120719775, 'support': 47813}, 'weighted avg': {'precision': 0.7804837688152325, 'recall': 0.5537196996632715, 'f1-score': 0.6079677133554827, 'support': 47813}}
[[ 3135   868   617]
 [10215 20368  7817]
 [  736  1085  2972]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0578556
{'0': {'precision': 0.450605411548717, 'recall': 0.5216852226720647, 'f1-score': 0.48354715388043246, 'support': 39520}, '1': {'precision': 0.5222995617427172, 'recall': 0.3645779181829088, 'f1-score': 0.42941418899028555, 'support': 50014}, '2': {'precision': 0.42222628775866977, 'recall': 0.5150898946063236, 'f1-score': 0.4640579094940739, 'support': 40325}, 'accuracy': 0.4591287473336465, 'macro avg': {'precision': 0.465043753683368, 'recall': 0.467117678487099, 'f1-score': 0.45900641745493065, 'support': 129859}, 'weighted avg': {'precision': 0.46940521026092846, 'recall': 0.4591287473336465, 'f1-score': 0.45664636236120226, 'support': 129859}}
[[20617  8036 10867]
 [14224 18234 17556]
 [10913  8641 20771]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1034216
{'0': {'precision': 0.4459010270774977, 'recall': 0.522906447091801, 'f1-score': 0.4813433588001694, 'support': 22832}, '1': {'precision': 0.42123028173865124, 'recall': 0.28177126532116853, 'f1-score': 0.3376680747673873, 'support': 21702}, '2': {'precision': 0.4456071846934791, 'recall': 0.5101931330472103, 'f1-score': 0.47571803743382385, 'support': 22368}, 'accuracy': 0.4404352635197752, 'macro avg': {'precision': 0.43757949783654265, 'recall': 0.43829028182005997, 'f1-score': 0.4315764903337935, 'support': 66902}, 'weighted avg': {'precision': 0.43779996609592203, 'recall': 0.4404352635197752, 'f1-score': 0.43285649439549007, 'support': 66902}}
[[11939  4121  6772]
 [ 8161  6115  7426]
 [ 6675  4281 11412]]
Evaluating performance on  val set...
73/73 - 1s - 658ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1029161
{'0': {'precision': 0.4612447940768163, 'recall': 0.5918942992874109, 'f1-score': 0.5184655396618985, 'support': 6736}, '1': {'precision': 0.3890521675238795, 'recall': 0.20842353867348948, 'f1-score': 0.27143406382160706, 'support': 5081}, '2': {'precision': 0.4822996706915478, 'recall': 0.5141143776510165, 'f1-score': 0.4976991150442478, 'support': 6837}, 'accuracy': 0.4589364211429184, 'macro avg': {'precision': 0.4441988774307479, 'recall': 0.4381440718706389, 'f1-score': 0.4291995728425844, 'support': 18654}, 'weighted avg': {'precision': 0.4492978366360233, 'recall': 0.4589364211429184, 'f1-score': 0.4435675567169323, 'support': 18654}}
[[3987  770 1979]
 [2228 1059 1794]
 [2429  893 3515]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2070316
{'0': {'precision': 0.3761064184917303, 'recall': 0.4564203289958262, 'f1-score': 0.41238942960929487, 'support': 48876}, '1': {'precision': 0.3902561275124054, 'recall': 0.13067266380236306, 'f1-score': 0.19578801785377511, 'support': 59584}, '2': {'precision': 0.3325038590514718, 'recall': 0.543763057103064, 'f1-score': 0.4126672171758877, 'support': 45952}, 'accuracy': 0.35671450405408905, 'macro avg': {'precision': 0.36628880168520245, 'recall': 0.37695201663375116, 'f1-score': 0.34028155487965256, 'support': 154412}, 'weighted avg': {'precision': 0.3685906260072676, 'recall': 0.35671450405408905, 'f1-score': 0.3288906495677125, 'support': 154412}}
[[22308  5952 20616]
 [22253  7786 29545]
 [14752  6213 24987]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.206964
{'0': {'precision': 0.40174383644016837, 'recall': 0.46697420842944015, 'f1-score': 0.43191001066683904, 'support': 28614}, '1': {'precision': 0.35158199822880604, 'recall': 0.15668616124286894, 'f1-score': 0.2167675965452199, 'support': 27871}, '2': {'precision': 0.3574443903231044, 'recall': 0.5051242829827916, 'f1-score': 0.41864224137931033, 'support': 26150}, 'accuracy': 0.37439341683306104, 'macro avg': {'precision': 0.3702567416640263, 'recall': 0.37626155088503355, 'f1-score': 0.3557732828637898, 'support': 82635}, 'weighted avg': {'precision': 0.370806689846714, 'recall': 0.37439341683306104, 'f1-score': 0.3551485126230014, 'support': 82635}}
[[13362  3951 11301]
 [11060  4367 12444]
 [ 8838  4103 13209]]
Evaluating performance on  val set...
112/112 - 1s - 922ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.21564
{'0': {'precision': 0.43111305872042066, 'recall': 0.46484596484596485, 'f1-score': 0.4473444889050564, 'support': 10582}, '1': {'precision': 0.2944231820667031, 'recall': 0.13345724907063197, 'f1-score': 0.18366302864938608, 'support': 8070}, '2': {'precision': 0.38681926989826454, 'recall': 0.5285159443990188, 'f1-score': 0.44670006910850035, 'support': 9784}, 'accuracy': 0.39270642847095233, 'macro avg': {'precision': 0.37078517022846275, 'recall': 0.3756063861052052, 'f1-score': 0.359235862220981, 'support': 28436}, 'weighted avg': {'precision': 0.37708092570482504, 'recall': 0.39270642847095233, 'f1-score': 0.3722912329072802, 'support': 28436}}
[[4919 1272 4391]
 [3187 1077 3806]
 [3304 1309 5171]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1293318
{'0': {'precision': 0.4702367359366674, 'recall': 0.4134526897013302, 'f1-score': 0.44002030041046, 'support': 59765}, '1': {'precision': 0.3107054573112759, 'recall': 0.1502217931922131, 'f1-score': 0.2025253698969711, 'support': 43509}, '2': {'precision': 0.4167160640189686, 'recall': 0.6299066064720681, 'f1-score': 0.5015985400458294, 'support': 58034}, 'accuracy': 0.42032633223398713, 'macro avg': {'precision': 0.39921941908897063, 'recall': 0.39786036312187045, 'f1-score': 0.3813814034510868, 'support': 161308}, 'weighted avg': {'precision': 0.40795175890029045, 'recall': 0.42032633223398713, 'f1-score': 0.39811577383575597, 'support': 161308}}
[[24710  7666 27389]
 [13194  6536 23779]
 [14644  6834 36556]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1231521
{'0': {'precision': 0.4264918684261679, 'recall': 0.4873155323034401, 'f1-score': 0.45487946742222685, 'support': 40522}, '1': {'precision': 0.40041243654822334, 'recall': 0.30964940258593193, 'f1-score': 0.3492300668243888, 'support': 40759}, '2': {'precision': 0.42727272727272725, 'recall': 0.46364083640836407, 'f1-score': 0.4447144879660217, 'support': 40650}, 'accuracy': 0.42003264141194613, 'macro avg': {'precision': 0.41805901074903945, 'recall': 0.42020192376591203, 'f1-score': 0.4162746740708791, 'support': 121931}, 'weighted avg': {'precision': 0.4180343830303252, 'recall': 0.42003264141194613, 'f1-score': 0.41617421335343363, 'support': 121931}}
[[19747  9021 11754]
 [14629 12621 13509]
 [11925  9878 18847]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1144463
{'0': {'precision': 0.4187989857076994, 'recall': 0.4768372703412074, 'f1-score': 0.44593765341188024, 'support': 15240}, '1': {'precision': 0.43828973430776585, 'recall': 0.38485066570708887, 'f1-score': 0.4098355420724892, 'support': 16674}, '2': {'precision': 0.43495497916946646, 'recall': 0.43265824476973463, 'f1-score': 0.433803572026941, 'support': 14961}, 'accuracy': 0.430016, 'macro avg': {'precision': 0.4306812330616439, 'recall': 0.43144872693934366, 'f1-score': 0.4298589225037701, 'support': 46875}, 'weighted avg': {'precision': 0.4308885549949315, 'recall': 0.430016, 'f1-score': 0.42922288869565445, 'support': 46875}}
[[7267 3946 4027]
 [5875 6417 4382]
 [4210 4278 6473]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
2354/2354 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0098603
{'0': {'precision': 0.2235169163366008, 'recall': 0.800961020013321, 'f1-score': 0.34950159675873543, 'support': 63058}, '1': {'precision': 0.9321816494732821, 'recall': 0.2860624434692305, 'f1-score': 0.4377811670917549, 'support': 477616}, '2': {'precision': 0.20174984446310404, 'recall': 0.751474687236663, 'f1-score': 0.3180990338081404, 'support': 61708}, 'accuracy': 0.3876394048958966, 'macro avg': {'precision': 0.45248280342432895, 'recall': 0.6128327169064048, 'f1-score': 0.36846059921954355, 'support': 602382}, 'weighted avg': {'precision': 0.7831724384316159, 'recall': 0.3876394048958966, 'f1-score': 0.4162797307494923, 'support': 602382}}
[[ 50507   3879   8672]
 [166183 136628 174805]
 [  9275   6061  46372]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9530341
{'0': {'precision': 0.2257481091746136, 'recall': 0.7812974203338392, 'f1-score': 0.3502848881707628, 'support': 31632}, '1': {'precision': 0.9356584307079356, 'recall': 0.3692648887984918, 'f1-score': 0.5295419297118866, 'support': 255662}, '2': {'precision': 0.23153964138334002, 'recall': 0.77763468555484, 'f1-score': 0.3568328115656548, 'support': 32613}, 'accuracy': 0.4516375071505156, 'macro avg': {'precision': 0.4643153937552964, 'recall': 0.6427323315623904, 'f1-score': 0.41221987648276803, 'support': 319907}, 'weighted avg': {'precision': 0.7936818269856505, 'recall': 0.4516375071505156, 'f1-score': 0.4942103451947242, 'support': 319907}}
[[24714  2916  4002]
 [81086 94407 80169]
 [ 3676  3576 25361]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95832354
{'0': {'precision': 0.21029370142169776, 'recall': 0.7481217566416234, 'f1-score': 0.32830291288535396, 'support': 12911}, '1': {'precision': 0.9327467312588053, 'recall': 0.3747641462591114, 'f1-score': 0.5346954100753062, 'support': 100698}, '2': {'precision': 0.2456685475651893, 'recall': 0.7596464258262875, 'f1-score': 0.37126918236631046, 'support': 13010}, 'accuracy': 0.45238076434026486, 'macro avg': {'precision': 0.46290299341523083, 'recall': 0.6275107762423408, 'f1-score': 0.4114225017756568, 'support': 126619}, 'weighted avg': {'precision': 0.7884834039692133, 'recall': 0.45238076434026486, 'f1-score': 0.49685820749343845, 'support': 126619}}
[[ 9659  1159  2093]
 [34707 37738 28253]
 [ 1565  1562  9883]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
3870/3870 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.108415
{'0': {'precision': 0.22024147417143355, 'recall': 0.6994704133549444, 'f1-score': 0.33500142178422504, 'support': 115373}, '1': {'precision': 0.8934776081619678, 'recall': 0.198366453879574, 'f1-score': 0.32465439143479025, 'support': 765084}, '2': {'precision': 0.1824035420898242, 'recall': 0.7518799720612114, 'f1-score': 0.29358448062734877, 'support': 110241}, 'accuracy': 0.3183159752013227, 'macro avg': {'precision': 0.43204087480774184, 'recall': 0.5499056130985766, 'f1-score': 0.3177467646154547, 'support': 990698}, 'weighted avg': {'precision': 0.7359494930302636, 'recall': 0.3183159752013227, 'f1-score': 0.32240202986262817, 'support': 990698}}
[[ 80700   8752  25921]
 [267705 151767 345612]
 [ 18011   9342  82888]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8731316
{'0': {'precision': 0.244144610307829, 'recall': 0.618189459112034, 'f1-score': 0.3500444432001904, 'support': 40452}, '1': {'precision': 0.8991827774986115, 'recall': 0.5249059773110437, 'f1-score': 0.6628609530271216, 'support': 323858}, '2': {'precision': 0.2178651765630021, 'recall': 0.6226275510204081, 'f1-score': 0.3227841405030814, 'support': 39200}, 'accuracy': 0.5437510842358306, 'macro avg': {'precision': 0.45373085478981423, 'recall': 0.5885743291478286, 'f1-score': 0.4452298455767978, 'support': 403510}, 'weighted avg': {'precision': 0.7673266800143423, 'recall': 0.5437510842358306, 'f1-score': 0.5984633804602425, 'support': 403510}}
[[ 25007   9417   6028]
 [ 72270 169995  81593]
 [  5150   9643  24407]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92518073
{'0': {'precision': 0.2392393825710931, 'recall': 0.5786119961213464, 'f1-score': 0.33851328079097187, 'support': 14438}, '1': {'precision': 0.9149561058595067, 'recall': 0.4588662357836785, 'f1-score': 0.6112034307156259, 'support': 124241}, '2': {'precision': 0.19419444345629824, 'recall': 0.7391510391984294, 'f1-score': 0.3075796205259674, 'support': 14771}, 'accuracy': 0.4971130661453242, 'macro avg': {'precision': 0.44946331062896605, 'recall': 0.5922097570344848, 'f1-score': 0.4190987773441884, 'support': 153450}, 'weighted avg': {'precision': 0.7819983439422965, 'recall': 0.4971130661453242, 'f1-score': 0.5563195748347292, 'support': 153450}}
[[ 8354  2940  3144]
 [25071 57010 42160]
 [ 1494  2359 10918]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
2451/2451 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99582183
{'0': {'precision': 0.45326520973766693, 'recall': 0.4371144143238239, 'f1-score': 0.4450433305831411, 'support': 169061}, '1': {'precision': 0.5751592276987374, 'recall': 0.4647451560609482, 'f1-score': 0.5140904667991396, 'support': 296711}, '2': {'precision': 0.38374014152560865, 'recall': 0.5333325080925178, 'f1-score': 0.44633561413232087, 'support': 161569}, 'accuracy': 0.47496337717445536, 'macro avg': {'precision': 0.47072152632067094, 'recall': 0.47839735949242995, 'f1-score': 0.46848980383820055, 'support': 627341}, 'weighted avg': {'precision': 0.49301105803594986, 'recall': 0.47496337717445536, 'f1-score': 0.47803310455701264, 'support': 627341}}
[[ 73899  51232  43930]
 [ 64363 137895  94453]
 [ 24775  50624  86170]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95745
{'0': {'precision': 0.45414857329126745, 'recall': 0.48047197349459914, 'f1-score': 0.46693957674997605, 'support': 81191}, '1': {'precision': 0.6232646307071994, 'recall': 0.552357084334529, 'f1-score': 0.5856724655244158, 'support': 145243}, '2': {'precision': 0.43982222414464295, 'recall': 0.5042649210245729, 'f1-score': 0.46984416694583386, 'support': 80658}, 'accuracy': 0.5207201750615451, 'macro avg': {'precision': 0.50574514271437, 'recall': 0.5123646596179003, 'f1-score': 0.5074854030734085, 'support': 307092}, 'weighted avg': {'precision': 0.5303712976142514, 'recall': 0.5207201750615451, 'f1-score': 0.5238586739595531, 'support': 307092}}
[[39010 23792 18389]
 [31603 80226 33414]
 [15284 24701 40673]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95181954
{'0': {'precision': 0.4464689997545075, 'recall': 0.5316702397193529, 'f1-score': 0.48535887437543546, 'support': 30786}, '1': {'precision': 0.6289256546265892, 'recall': 0.5679338528796807, 'f1-score': 0.5968756866897063, 'support': 52610}, '2': {'precision': 0.4711360056012603, 'recall': 0.4587224759697321, 'f1-score': 0.46484638101652764, 'support': 29338}, 'accuracy': 0.5296095233026417, 'macro avg': {'precision': 0.515510219994119, 'recall': 0.5194421895229219, 'f1-score': 0.5156936473605565, 'support': 112734}, 'weighted avg': {'precision': 0.5380360977937171, 'recall': 0.5296095233026417, 'f1-score': 0.5320626546519283, 'support': 112734}}
[[16368  8685  5733]
 [13357 29879  9374]
 [ 6936  8944 13458]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9349717
{'0': {'precision': 0.36795805910621926, 'recall': 0.7002038189229779, 'f1-score': 0.4824093491616241, 'support': 186440}, '1': {'precision': 0.7450408242480371, 'recall': 0.45271764654767543, 'f1-score': 0.5632072521456452, 'support': 483341}, '2': {'precision': 0.4380747112456091, 'recall': 0.48871580547112464, 'f1-score': 0.46201170922935625, 'support': 184240}, 'accuracy': 0.5145119382310271, 'macro avg': {'precision': 0.5170245315332885, 'recall': 0.5472124236472593, 'f1-score': 0.5025427701788752, 'support': 854021}, 'weighted avg': {'precision': 0.5964979343277567, 'recall': 0.5145119382310271, 'f1-score': 0.5237372299105503, 'support': 854021}}
[[130546  31343  24551]
 [173578 218817  90946]
 [ 50661  43538  90041]]
Evaluating performance on  train set...
1431/1431 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99537426
{'0': {'precision': 0.3802445817679142, 'recall': 0.6340244417312323, 'f1-score': 0.4753854314607895, 'support': 87637}, '1': {'precision': 0.7376832423110089, 'recall': 0.3396560030069297, 'f1-score': 0.4651432548428257, 'support': 188897}, '2': {'precision': 0.3963940934107245, 'recall': 0.5885991157951146, 'f1-score': 0.47374379987060605, 'support': 89572}, 'accuracy': 0.4710275166208694, 'macro avg': {'precision': 0.5047739724965492, 'recall': 0.5207598535110921, 'f1-score': 0.47142416205807375, 'support': 366106}, 'weighted avg': {'precision': 0.5686207206934679, 'recall': 0.4710275166208694, 'f1-score': 0.4696992076310806, 'support': 366106}}
[[55564 10590 21483]
 [65938 64160 58799]
 [24625 12225 52722]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0041375
{'0': {'precision': 0.4099996001759226, 'recall': 0.5997134335341248, 'f1-score': 0.48703395867964855, 'support': 34198}, '1': {'precision': 0.6592446345654638, 'recall': 0.31702857142857144, 'f1-score': 0.42815757604540167, 'support': 56875}, '2': {'precision': 0.4203263788473456, 'recall': 0.5862287525208874, 'f1-score': 0.48960538979788265, 'support': 34710}, 'accuracy': 0.4681713745100689, 'macro avg': {'precision': 0.49652353786291065, 'recall': 0.5009902524945279, 'f1-score': 0.46826564150764427, 'support': 125783}, 'weighted avg': {'precision': 0.5255498241218473, 'recall': 0.4681713745100689, 'f1-score': 0.4611215548714322, 'support': 125783}}
[[20509  4404  9285]
 [20067 18031 18777]
 [ 9446  4916 20348]]
testing model on single stock: results/universal/W9/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
10303/10303 - 66s - 66s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0981315
{'0': {'precision': 0.37722506972736963, 'recall': 0.49433515005603257, 'f1-score': 0.42791216766391427, 'support': 836121}, '1': {'precision': 0.40394394283498586, 'recall': 0.1144465997476412, 'f1-score': 0.1783597768423833, 'support': 955782}, '2': {'precision': 0.3967077211422025, 'recall': 0.5963103532698365, 'f1-score': 0.47644836974240395, 'support': 845501}, 'accuracy': 0.38935673108860075, 'macro avg': {'precision': 0.3926255779015193, 'recall': 0.4016973676911701, 'f1-score': 0.3609067714162339, 'support': 2637404}, 'weighted avg': {'precision': 0.3931536188728309, 'recall': 0.38935673108860075, 'f1-score': 0.3530354040696301, 'support': 2637404}}
[[413324  87396 335401]
 [415065 109386 431331]
 [267307  74013 504181]]
Evaluating performance on  train set...
3419/3419 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1379944
{'0': {'precision': 0.39868831267584215, 'recall': 0.36197850145325755, 'f1-score': 0.37944759857720267, 'support': 289694}, '1': {'precision': 0.34068626491688814, 'recall': 0.6043931245899021, 'f1-score': 0.43574844281693387, 'support': 288041}, '2': {'precision': 0.4366892105679481, 'recall': 0.14849421186945017, 'f1-score': 0.22162562256150342, 'support': 297419}, 'accuracy': 0.3692127328447336, 'macro avg': {'precision': 0.39202126272022614, 'recall': 0.3716219459708699, 'f1-score': 0.34560722131854665, 'support': 875154}, 'weighted avg': {'precision': 0.39251250957334294, 'recall': 0.3692127328447336, 'f1-score': 0.344342573851318, 'support': 875154}}
[[104863 160459  24372]
 [ 81352 174090  32599]
 [ 76805 176449  44165]]
Evaluating performance on  val set...
1396/1396 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0942614
{'0': {'precision': 0.4002666757837875, 'recall': 0.49451310687403377, 'f1-score': 0.4424264411340121, 'support': 118373}, '1': {'precision': 0.39943920469028804, 'recall': 0.5368408173253395, 'f1-score': 0.45805798281603977, 'support': 122595}, '2': {'precision': 0.4414657874824343, 'recall': 0.17558341502003474, 'f1-score': 0.2512411336610213, 'support': 116298}, 'accuracy': 0.40521908046105704, 'macro avg': {'precision': 0.41372388931883664, 'recall': 0.40231244640646935, 'f1-score': 0.38390851920369107, 'support': 357266}, 'weighted avg': {'precision': 0.413393954824115, 'recall': 0.40521908046105704, 'f1-score': 0.3855553141978198, 'support': 357266}}
[[58537 47466 12370]
 [43316 65814 13465]
 [44392 51486 20420]]
training model: results/universal/W9/deepLOB_L1/h30
Epoch 1/50
6697/6697 - 116s - loss: 2.9296 - accuracy30: 0.4940 - val_loss: 3.2511 - val_accuracy30: 0.3633 - 116s/epoch - 17ms/step
Epoch 2/50
6697/6697 - 113s - loss: 2.8902 - accuracy30: 0.5045 - val_loss: 3.1725 - val_accuracy30: 0.3915 - 113s/epoch - 17ms/step
Epoch 3/50
6697/6697 - 110s - loss: 2.8500 - accuracy30: 0.5158 - val_loss: 3.2177 - val_accuracy30: 0.4181 - 110s/epoch - 16ms/step
Epoch 4/50
6697/6697 - 110s - loss: 2.8180 - accuracy30: 0.5238 - val_loss: 3.2126 - val_accuracy30: 0.4272 - 110s/epoch - 16ms/step
Epoch 5/50
6697/6697 - 109s - loss: 2.7987 - accuracy30: 0.5285 - val_loss: 3.2113 - val_accuracy30: 0.4382 - 109s/epoch - 16ms/step
Epoch 6/50
6697/6697 - 113s - loss: 2.7864 - accuracy30: 0.5309 - val_loss: 3.2106 - val_accuracy30: 0.4446 - 113s/epoch - 17ms/step
Epoch 7/50
6697/6697 - 113s - loss: 2.7769 - accuracy30: 0.5321 - val_loss: 3.2544 - val_accuracy30: 0.4477 - 113s/epoch - 17ms/step
Epoch 8/50
6697/6697 - 112s - loss: 2.7691 - accuracy30: 0.5333 - val_loss: 3.3095 - val_accuracy30: 0.4506 - 112s/epoch - 17ms/step
Epoch 9/50
6697/6697 - 109s - loss: 2.7629 - accuracy30: 0.5347 - val_loss: 3.2866 - val_accuracy30: 0.4504 - 109s/epoch - 16ms/step
Epoch 10/50
6697/6697 - 111s - loss: 2.7573 - accuracy30: 0.5357 - val_loss: 3.3823 - val_accuracy30: 0.4512 - 111s/epoch - 17ms/step
Epoch 11/50
6697/6697 - 111s - loss: 2.7528 - accuracy30: 0.5365 - val_loss: 3.5548 - val_accuracy30: 0.4532 - 111s/epoch - 17ms/step
Epoch 12/50
6697/6697 - 108s - loss: 2.7482 - accuracy30: 0.5377 - val_loss: 3.8157 - val_accuracy30: 0.4518 - 108s/epoch - 16ms/step
testing model in sample: results/universal/W9/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 101s - 101s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1163381
{'0': {'precision': 0.34983398154914586, 'recall': 0.5915358983332532, 'f1-score': 0.43965578879371975, 'support': 1205822}, '1': {'precision': 0.6022464987539886, 'recall': 0.06904482154613803, 'f1-score': 0.12388660712807892, 'support': 1897101}, '2': {'precision': 0.3586691574788716, 'recall': 0.6106776961303083, 'f1-score': 0.45191513016558427, 'support': 1204773}, 'accuracy': 0.36678539989822867, 'macro avg': {'precision': 0.43691654592733536, 'recall': 0.4237528053365665, 'f1-score': 0.3384858420291277, 'support': 4307696}, 'weighted avg': {'precision': 0.463466981698694, 'recall': 0.36678539989822867, 'f1-score': 0.30402033382557353, 'support': 4307696}}
[[713287  35469 457066]
 [907638 130985 858478]
 [418005  51040 735728]]
Evaluating performance on  train set...
6697/6697 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0888964
{'0': {'precision': 0.3485342338254485, 'recall': 0.6144794721407625, 'f1-score': 0.4447852210144164, 'support': 463760}, '1': {'precision': 0.5050673389504412, 'recall': 0.24432551231178648, 'f1-score': 0.3293355044237987, 'support': 778969}, '2': {'precision': 0.3598959105230843, 'recall': 0.3967632555020837, 'f1-score': 0.37743142358570453, 'support': 471276}, 'accuracy': 0.38639210504053373, 'macro avg': {'precision': 0.404499161099658, 'recall': 0.4185227466515442, 'f1-score': 0.3838507163413066, 'support': 1714005}, 'weighted avg': {'precision': 0.42279826567685236, 'recall': 0.38639210504053373, 'f1-score': 0.37379710924117737, 'support': 1714005}}
[[284971  86676  92113]
 [348192 190322 240455]
 [184464  99827 186985]]
Evaluating performance on  val set...
2631/2631 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0817373
{'0': {'precision': 0.3457593835711465, 'recall': 0.69977482707043, 'f1-score': 0.4628327038634273, 'support': 185191}, '1': {'precision': 0.5728677654799027, 'recall': 0.21849596152338135, 'f1-score': 0.31633821205899887, 'support': 306056}, '2': {'precision': 0.36987404319149403, 'recall': 0.36928549011402867, 'f1-score': 0.36957953233614266, 'support': 181621}, 'accuracy': 0.39165779915228544, 'macro avg': {'precision': 0.42950039741418106, 'recall': 0.4291854262359467, 'f1-score': 0.3829168160861896, 'support': 672868}, 'weighted avg': {'precision': 0.4555693485692939, 'recall': 0.39165779915228544, 'f1-score': 0.371028289848118, 'support': 672868}}
[[129592  22089  33510]
 [158432  66872  80752]
 [ 86780  27771  67070]]
testing model out of sample: results/universal/W9/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 51s - 51s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1134831
{'0': {'precision': 0.31732600732600735, 'recall': 0.70405943276304, 'f1-score': 0.43747709718562444, 'support': 479870}, '1': {'precision': 0.7282553600170738, 'recall': 0.12989652784992534, 'f1-score': 0.2204687631450541, 'support': 1260919}, '2': {'precision': 0.3136426468067192, 'recall': 0.6144268190813036, 'f1-score': 0.4152931669210739, 'support': 470471}, 'accuracy': 0.3575861725893834, 'macro avg': {'precision': 0.4530746713832668, 'recall': 0.4827942598980896, 'f1-score': 0.35774634241725084, 'support': 2211260}, 'weighted avg': {'precision': 0.5508651271757747, 'recall': 0.3575861725893834, 'f1-score': 0.3090133130057472, 'support': 2211260}}
[[337857  25945 116068]
 [580614 163789 516516]
 [146229  35172 289070]]
Evaluating performance on  train set...
3947/3947 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0643659
{'0': {'precision': 0.3288198877249436, 'recall': 0.6556446691657223, 'f1-score': 0.4379822615116733, 'support': 229420}, '1': {'precision': 0.7622512631226858, 'recall': 0.23608054247490545, 'f1-score': 0.3605067787907803, 'support': 550219}, '2': {'precision': 0.34783964120203603, 'recall': 0.5774444526591835, 'f1-score': 0.434154380389041, 'support': 229939}, 'accuracy': 0.4091719510528161, 'macro avg': {'precision': 0.4796369306832218, 'recall': 0.48972322143327046, 'f1-score': 0.41088114023049815, 'support': 1009578}, 'weighted avg': {'precision': 0.5693714459351457, 'recall': 0.4091719510528161, 'f1-score': 0.394886372155265, 'support': 1009578}}
[[150418  18302  60700]
 [232081 129896 188242]
 [ 74949  22213 132777]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0875155
{'0': {'precision': 0.321882928867795, 'recall': 0.654165807257859, 'f1-score': 0.4314637132591247, 'support': 82421}, '1': {'precision': 0.7262213264228813, 'recall': 0.1567707281193832, 'f1-score': 0.25787377255202676, 'support': 193059}, '2': {'precision': 0.33270942768396833, 'recall': 0.5992363645151156, 'f1-score': 0.4278609111261609, 'support': 82762}, 'accuracy': 0.37342634308651695, 'macro avg': {'precision': 0.4602712276582149, 'recall': 0.4700576332974526, 'f1-score': 0.37239946564577076, 'support': 358242}, 'weighted avg': {'precision': 0.5422847505096223, 'recall': 0.37342634308651695, 'f1-score': 0.33708260922023486, 'support': 358242}}
[[53917  5061 23443]
 [86769 30266 76024]
 [26819  6349 49594]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
295/295 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1123195
{'0': {'precision': 0.39479065487449516, 'recall': 0.6125322228832044, 'f1-score': 0.4801280756019087, 'support': 25215}, '1': {'precision': 0.3977764051883879, 'recall': 0.05707954797252382, 'f1-score': 0.09983335271092508, 'support': 22565}, '2': {'precision': 0.44753740837220574, 'recall': 0.5354424874972821, 'f1-score': 0.4875593980992609, 'support': 27594}, 'accuracy': 0.41802212964682783, 'macro avg': {'precision': 0.4133681561450296, 'recall': 0.40168475278433674, 'f1-score': 0.35584027547069824, 'support': 75374}, 'weighted avg': {'precision': 0.4149948018197126, 'recall': 0.41802212964682783, 'f1-score': 0.36899836895182897, 'support': 75374}}
[[15445   833  8937]
 [11975  1288  9302]
 [11702  1117 14775]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0895869
{'0': {'precision': 0.4195213936155884, 'recall': 0.5334855837853268, 'f1-score': 0.46968935357394187, 'support': 17515}, '1': {'precision': 0.4375451263537906, 'recall': 0.18406025999271047, 'f1-score': 0.25911831359302173, 'support': 16462}, '2': {'precision': 0.4189047467055766, 'recall': 0.5356226679104478, 'f1-score': 0.470127676995113, 'support': 17152}, 'accuracy': 0.42169805785366427, 'macro avg': {'precision': 0.42532375555831853, 'recall': 0.417722837229495, 'f1-score': 0.39964511472069225, 'support': 51129}, 'weighted avg': {'precision': 0.4251176298129668, 'recall': 0.42169805785366427, 'f1-score': 0.4020388550927281, 'support': 51129}}
[[9344 1891 6280]
 [6968 3030 6464]
 [5961 2004 9187]]
Evaluating performance on  val set...
53/53 - 0s - 476ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0887326
{'0': {'precision': 0.4053201082055906, 'recall': 0.6099050203527816, 'f1-score': 0.4869989165763814, 'support': 4422}, '1': {'precision': 0.5777262180974478, 'recall': 0.10586734693877552, 'f1-score': 0.1789435860582106, 'support': 4704}, '2': {'precision': 0.4106304493628437, 'recall': 0.5624712907671107, 'f1-score': 0.47470440007753434, 'support': 4354}, 'accuracy': 0.41869436201780413, 'macro avg': {'precision': 0.4645589252219607, 'recall': 0.4260812193528893, 'f1-score': 0.3802156342373754, 'support': 13480}, 'weighted avg': {'precision': 0.46719841431315556, 'recall': 0.41869436201780413, 'f1-score': 0.3755283973187067, 'support': 13480}}
[[2697  133 1592]
 [2283  498 1923]
 [1674  231 2449]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2445465
{'0': {'precision': 0.1665730562464896, 'recall': 0.7690442513639119, 'f1-score': 0.27383429164143486, 'support': 29694}, '1': {'precision': 0.9025450386045182, 'recall': 0.06996767857697066, 'f1-score': 0.12986767174693045, 'support': 225547}, '2': {'precision': 0.1819819272072291, 'recall': 0.7745180489067149, 'f1-score': 0.29471676051570816, 'support': 30916}, 'accuracy': 0.2186282355490168, 'macro avg': {'precision': 0.41703334068607895, 'recall': 0.5378433262825325, 'f1-score': 0.23280624130135782, 'support': 286157}, 'weighted avg': {'precision': 0.7483259169471835, 'recall': 0.2186282355490168, 'f1-score': 0.1626168941651238, 'support': 286157}}
[[ 22836    536   6322]
 [108454  15781 101312]
 [  5803   1168  23945]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.010646
{'0': {'precision': 0.22783727837278372, 'recall': 0.6510641033884138, 'f1-score': 0.33755021084387554, 'support': 15553}, '1': {'precision': 0.8722135314822057, 'recall': 0.3629373474369406, 'f1-score': 0.5125833141806482, 'support': 98320}, '2': {'precision': 0.2330088233282415, 'recall': 0.666058394160584, 'f1-score': 0.34524111139261887, 'support': 15344}, 'accuracy': 0.4336116764821966, 'macro avg': {'precision': 0.444353211061077, 'recall': 0.5600199483286461, 'f1-score': 0.3984582121390475, 'support': 129217}, 'weighted avg': {'precision': 0.7187512091366531, 'recall': 0.4336116764821966, 'f1-score': 0.471644516531915, 'support': 129217}}
[[10126  2626  2801]
 [31796 35684 30840]
 [ 2522  2602 10220]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0414884
{'0': {'precision': 0.1943957160003693, 'recall': 0.7424188998589563, 'f1-score': 0.3081144362332626, 'support': 5672}, '1': {'precision': 0.8876699909338168, 'recall': 0.26922759644732863, 'f1-score': 0.41314851150916726, 'support': 36367}, '2': {'precision': 0.2571919846570994, 'recall': 0.6735365431243505, 'f1-score': 0.37224216319693715, 'support': 5774}, 'accuracy': 0.3741869366071989, 'macro avg': {'precision': 0.4464192305304285, 'recall': 0.5617276798102118, 'f1-score': 0.3645017036464557, 'support': 47813}, 'weighted avg': {'precision': 0.7292898078107273, 'recall': 0.3741869366071989, 'f1-score': 0.3957485046047742, 'support': 47813}}
[[ 4211   492   969]
 [16313  9791 10263]
 [ 1138   747  3889]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0810798
{'0': {'precision': 0.4167999715616224, 'recall': 0.5890923706885723, 'f1-score': 0.4881907795438696, 'support': 39807}, '1': {'precision': 0.5313428000647913, 'recall': 0.19953770352196923, 'f1-score': 0.290123820754717, 'support': 49319}, '2': {'precision': 0.40218970150337713, 'recall': 0.5438096874769842, 'f1-score': 0.46239914830548273, 'support': 40733}, 'accuracy': 0.4269399887570365, 'macro avg': {'precision': 0.45011082437659694, 'recall': 0.44414658722917527, 'f1-score': 0.41357124953468977, 'support': 129859}, 'weighted avg': {'precision': 0.4557192426838803, 'recall': 0.4269399887570365, 'f1-score': 0.4048770711697452, 'support': 129859}}
[[23450  4121 12236]
 [18789  9841 20689]
 [14023  4559 22151]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.106933
{'0': {'precision': 0.40718743404986585, 'recall': 0.6002133143720558, 'f1-score': 0.48520773831977154, 'support': 22502}, '1': {'precision': 0.41520258157045536, 'recall': 0.10372626298817628, 'f1-score': 0.1659858095033326, 'support': 22328}, '2': {'precision': 0.42141715503462973, 'recall': 0.5375588981515041, 'f1-score': 0.4724550540545921, 'support': 22072}, 'accuracy': 0.41384413022032224, 'macro avg': {'precision': 0.41460239021831696, 'recall': 0.41383282517057873, 'f1-score': 0.37454953395923213, 'support': 66902}, 'weighted avg': {'precision': 0.41455702861229193, 'recall': 0.41384413022032224, 'f1-score': 0.3744627011951043, 'support': 66902}}
[[13506  1509  7487]
 [11209  2316  8803]
 [ 8454  1753 11865]]
Evaluating performance on  val set...
73/73 - 1s - 582ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1017487
{'0': {'precision': 0.4155332150601222, 'recall': 0.6461302681992337, 'f1-score': 0.5057884949913023, 'support': 6525}, '1': {'precision': 0.41348600508905853, 'recall': 0.05868544600938967, 'f1-score': 0.1027830487033523, 'support': 5538}, '2': {'precision': 0.4435379435379435, 'recall': 0.5196480048551054, 'f1-score': 0.47858590092922515, 'support': 6591}, 'accuracy': 0.42703977699152995, 'macro avg': {'precision': 0.4241857212290414, 'recall': 0.40815457302124286, 'f1-score': 0.3623858148746266, 'support': 18654}, 'weighted avg': {'precision': 0.42482032327163555, 'recall': 0.42703977699152995, 'f1-score': 0.37653276115374373, 'support': 18654}}
[[4216  214 2095]
 [3011  325 2202]
 [2919  247 3425]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
604/604 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1872383
{'0': {'precision': 0.3630144453529572, 'recall': 0.5426691384684336, 'f1-score': 0.43502331240252473, 'support': 49087}, '1': {'precision': 0.39171779141104296, 'recall': 0.02143768466290626, 'f1-score': 0.0406506653084612, 'support': 59568}, '2': {'precision': 0.3245641104767783, 'recall': 0.5516532989487947, 'f1-score': 0.40868136227120755, 'support': 45757}, 'accuracy': 0.34425433256482657, 'macro avg': {'precision': 0.3597654490802595, 'recall': 0.3719200406933782, 'f1-score': 0.2947851133273978, 'support': 154412}, 'weighted avg': {'precision': 0.36269341424824214, 'recall': 0.34425433256482657, 'f1-score': 0.2750790175662564, 'support': 154412}}
[[26638   958 21491]
 [27252  1277 31039]
 [19490  1025 25242]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1636413
{'0': {'precision': 0.39017471633698164, 'recall': 0.537708434235107, 'f1-score': 0.4522126211050013, 'support': 28906}, '1': {'precision': 0.35952747817154596, 'recall': 0.050643901027347706, 'f1-score': 0.0887817870505422, 'support': 27644}, '2': {'precision': 0.351317311399563, 'recall': 0.5239792984473836, 'f1-score': 0.42061855670103093, 'support': 26085}, 'accuracy': 0.37043625582380346, 'macro avg': {'precision': 0.3670065019693635, 'recall': 0.3707772112366127, 'f1-score': 0.3205376549521915, 'support': 82635}, 'weighted avg': {'precision': 0.36765632026222067, 'recall': 0.37043625582380346, 'f1-score': 0.3206604562041841, 'support': 82635}}
[[15543  1242 12121]
 [13128  1400 13116]
 [11165  1252 13668]]
Evaluating performance on  val set...
112/112 - 1s - 880ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1552246
{'0': {'precision': 0.4130111524163569, 'recall': 0.525742949081961, 'f1-score': 0.46260826115922715, 'support': 10566}, '1': {'precision': 0.31894934333958724, 'recall': 0.04275116308311329, 'f1-score': 0.07539638540858189, 'support': 7953}, '2': {'precision': 0.382183908045977, 'recall': 0.5364525562165977, 'f1-score': 0.44636489491127235, 'support': 9917}, 'accuracy': 0.3943944295962864, 'macro avg': {'precision': 0.37138146793397375, 'recall': 0.368315556127224, 'f1-score': 0.32812318049302713, 'support': 28436}, 'weighted avg': {'precision': 0.37595293923557876, 'recall': 0.39439442959628634, 'f1-score': 0.3486477353846509, 'support': 28436}}
[[5555  357 4654]
 [3667  340 3946]
 [4228  369 5320]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0931566
{'0': {'precision': 0.4561768317642243, 'recall': 0.4631920199501247, 'f1-score': 0.4596576613734791, 'support': 60150}, '1': {'precision': 0.29815716272600834, 'recall': 0.038974615367134056, 'f1-score': 0.06893779519646266, 'support': 44003}, '2': {'precision': 0.4011917740074724, 'recall': 0.6631965707287202, 'f1-score': 0.4999472420797172, 'support': 57155}, 'accuracy': 0.4183363503360032, 'macro avg': {'precision': 0.38517525616590165, 'recall': 0.3884544020153264, 'f1-score': 0.34284756621655293, 'support': 161308}, 'weighted avg': {'precision': 0.39358842652222903, 'recall': 0.4183363503360032, 'f1-score': 0.36734918760824603, 'support': 161308}}
[[27861  2031 30258]
 [15970  1715 26318]
 [17244  2006 37905]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1133715
{'0': {'precision': 0.39694540288207836, 'recall': 0.5749528405889415, 'f1-score': 0.4696476991885375, 'support': 40819}, '1': {'precision': 0.3645938829248532, 'recall': 0.13556598799989958, 'f1-score': 0.19764292511529172, 'support': 39833}, '2': {'precision': 0.4202225185432119, 'recall': 0.4886019525666804, 'f1-score': 0.4518398207784934, 'support': 41279}, 'accuracy': 0.40217828115901616, 'macro avg': {'precision': 0.3939206014500478, 'recall': 0.39970692705184047, 'f1-score': 0.37304348169410756, 'support': 121931}, 'weighted avg': {'precision': 0.39425698043757923, 'recall': 0.40217828115901616, 'f1-score': 0.3747591345204235, 'support': 121931}}
[[23469  4469 12881]
 [19487  5400 14946]
 [16168  4942 20169]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1202989
{'0': {'precision': 0.38126566416040103, 'recall': 0.5524643320363165, 'f1-score': 0.4511704268615613, 'support': 15420}, '1': {'precision': 0.3867147851584527, 'recall': 0.20908536585365853, 'f1-score': 0.2714212213559188, 'support': 16400}, '2': {'precision': 0.4175178753830439, 'recall': 0.4344071736964464, 'f1-score': 0.4257951105179205, 'support': 15055}, 'accuracy': 0.3944106666666667, 'macro avg': {'precision': 0.3951661082339659, 'recall': 0.3986522905288072, 'f1-score': 0.38279558624513355, 'support': 46875}, 'weighted avg': {'precision': 0.394815373479333, 'recall': 0.3944106666666667, 'f1-score': 0.3801322965608456, 'support': 46875}}
[[8519 2638 4263]
 [8110 3429 4861]
 [5715 2800 6540]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
2354/2354 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1529847
{'0': {'precision': 0.22259683019286344, 'recall': 0.8366020732406105, 'f1-score': 0.3516336148620911, 'support': 76788}, '1': {'precision': 0.8975542406311637, 'recall': 0.10103171977718227, 'f1-score': 0.18161971451548853, 'support': 450413}, '2': {'precision': 0.21901369904669232, 'recall': 0.7664037456272197, 'f1-score': 0.34067373213309093, 'support': 75181}, 'accuracy': 0.27784030731329956, 'macro avg': {'precision': 0.4463882566235731, 'recall': 0.5680125128816709, 'f1-score': 0.29130902050355684, 'support': 602382}, 'weighted avg': {'precision': 0.7268287108351235, 'recall': 0.27784030731329956, 'f1-score': 0.22314297961690904, 'support': 602382}}
[[ 64241   1462  11085]
 [210527  45506 194380]
 [ 13830   3732  57619]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0933789
{'0': {'precision': 0.22900123584811852, 'recall': 0.8254268963928215, 'f1-score': 0.35853326290623, 'support': 39061}, '1': {'precision': 0.9053118754601872, 'recall': 0.17891695249974016, 'f1-score': 0.2987849753523572, 'support': 240525}, '2': {'precision': 0.24425055860402195, 'recall': 0.7970536445028645, 'f1-score': 0.3739172421014666, 'support': 40321}, 'accuracy': 0.33576633209026374, 'macro avg': {'precision': 0.45952122330410927, 'recall': 0.6004658311318086, 'f1-score': 0.3437451601200179, 'support': 319907}, 'weighted avg': {'precision': 0.739413588611683, 'recall': 0.33576633209026374, 'f1-score': 0.315549960137725, 'support': 319907}}
[[ 32242   1711   5108]
 [103159  43034  94332]
 [  5393   2790  32138]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0951291
{'0': {'precision': 0.21284789976378762, 'recall': 0.7929978955423761, 'f1-score': 0.33561394275535406, 'support': 15681}, '1': {'precision': 0.9032751307092828, 'recall': 0.19262851192291913, 'f1-score': 0.31753985937594825, 'support': 95069}, '2': {'precision': 0.25891534336331196, 'recall': 0.7819018211607537, 'f1-score': 0.3890142964635064, 'support': 15869}, 'accuracy': 0.34083352419463114, 'macro avg': {'precision': 0.4583461246121275, 'recall': 0.589176076208683, 'f1-score': 0.3473893661982696, 'support': 126619}, 'weighted avg': {'precision': 0.7370130778274125, 'recall': 0.34083352419463114, 'f1-score': 0.3287360269622893, 'support': 126619}}
[[12435   739  2507]
 [43748 18313 33008]
 [ 2239  1222 12408]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
3870/3870 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1903913
{'0': {'precision': 0.23612152612084442, 'recall': 0.7504802900518569, 'f1-score': 0.35922202555451077, 'support': 138458}, '1': {'precision': 0.8873778556506503, 'recall': 0.09141525008365511, 'f1-score': 0.16575488347385622, 'support': 720219}, '2': {'precision': 0.2121200672497497, 'recall': 0.7654918535687504, 'f1-score': 0.33218945064047567, 'support': 132021}, 'accuracy': 0.2733527270671789, 'macro avg': {'precision': 0.44520648300708143, 'recall': 0.5357957979014208, 'f1-score': 0.2857221198896142, 'support': 990698}, 'weighted avg': {'precision': 0.7063743032497035, 'recall': 0.2733527270671789, 'f1-score': 0.2149726385819795, 'support': 990698}}
[[103910   3441  31107]
 [310115  65839 344265]
 [ 26045   4915 101061]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.038364
{'0': {'precision': 0.22150041369324647, 'recall': 0.700627696334008, 'f1-score': 0.33658951049294494, 'support': 48909}, '1': {'precision': 0.8683259014687279, 'recall': 0.31512027715189955, 'f1-score': 0.46242423808056266, 'support': 307124}, '2': {'precision': 0.2290733824054052, 'recall': 0.6626998336036397, 'f1-score': 0.340460757685607, 'support': 47477}, 'accuracy': 0.40274342643305, 'macro avg': {'precision': 0.43963323252245984, 'recall': 0.5594826023631825, 'f1-score': 0.37982483541970485, 'support': 403510}, 'weighted avg': {'precision': 0.7147104281739387, 'recall': 0.40274342643305, 'f1-score': 0.4328217230244449, 'support': 403510}}
[[ 34267   6741   7901]
 [112358  96781  97985]
 [  8079   7935  31463]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031919
{'0': {'precision': 0.19837547369074984, 'recall': 0.7259448707019039, 'f1-score': 0.31160118561165123, 'support': 17595}, '1': {'precision': 0.9165291835733714, 'recall': 0.17428205628237847, 'f1-score': 0.29287301949162203, 'support': 117941}, '2': {'precision': 0.21203571696555865, 'recall': 0.7887127386401697, 'f1-score': 0.33422039290825445, 'support': 17914}, 'accuracy': 0.309266862170088, 'macro avg': {'precision': 0.44231345807656, 'recall': 0.562979888541484, 'f1-score': 0.3128981993371759, 'support': 153450}, 'weighted avg': {'precision': 0.7519399982609108, 'recall': 0.309266862170088, 'f1-score': 0.2998474015722182, 'support': 153450}}
[[12773   595  4227]
 [49107 20555 48279]
 [ 2508  1277 14129]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
2451/2451 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0578501
{'0': {'precision': 0.41979915302167103, 'recall': 0.6302812525888493, 'f1-score': 0.5039452875961483, 'support': 193136}, '1': {'precision': 0.5459823937066867, 'recall': 0.12819948984079516, 'f1-score': 0.2076432667307761, 'support': 250118}, '2': {'precision': 0.4071490094745909, 'recall': 0.616273827049167, 'f1-score': 0.4903452791818934, 'support': 184087}, 'accuracy': 0.42599319987056483, 'macro avg': {'precision': 0.4576435187343162, 'recall': 0.4582515231596038, 'f1-score': 0.400644611169606, 'support': 627341}, 'weighted avg': {'precision': 0.4663957772156953, 'recall': 0.42599319987056483, 'f1-score': 0.3818202334330056, 'support': 627341}}
[[121730  11360  60046]
 [112907  32065 105146]
 [ 55335  15304 113448]]
Evaluating performance on  train set...
1200/1200 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0240519
{'0': {'precision': 0.42710429762880875, 'recall': 0.5610937023980502, 'f1-score': 0.4850152128625105, 'support': 91908}, '1': {'precision': 0.5588599567261061, 'recall': 0.30264242424242427, 'f1-score': 0.39265064346185097, 'support': 123750}, '2': {'precision': 0.43714386270697864, 'recall': 0.5705426865279875, 'f1-score': 0.4950135218484605, 'support': 91434}, 'accuracy': 0.45975798783426464, 'macro avg': {'precision': 0.47436937235396454, 'recall': 0.47809293772282063, 'f1-score': 0.457559792724274, 'support': 307092}, 'weighted avg': {'precision': 0.483187557390209, 'recall': 0.45975798783426464, 'f1-score': 0.45077163087564576, 'support': 307092}}
[[51569 14488 25851]
 [44980 37452 41318]
 [24192 15075 52167]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0135714
{'0': {'precision': 0.42450670011747604, 'recall': 0.6154379077420472, 'f1-score': 0.5024450598008602, 'support': 34642}, '1': {'precision': 0.5743597313454868, 'recall': 0.3439862087256332, 'f1-score': 0.4302775627557226, 'support': 45246}, '2': {'precision': 0.4604523762460114, 'recall': 0.49643792242586615, 'f1-score': 0.4777684993920216, 'support': 32846}, 'accuracy': 0.4718186172760658, 'macro avg': {'precision': 0.48643960256965807, 'recall': 0.48528734629784887, 'f1-score': 0.4701637073162015, 'support': 112734}, 'weighted avg': {'precision': 0.4951235675138289, 'recall': 0.4718186172760658, 'f1-score': 0.46629077737946995, 'support': 112734}}
[[21320  5561  7761]
 [18336 15564 11346]
 [10567  5973 16306]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
3337/3337 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0333459
{'0': {'precision': 0.35700523748088275, 'recall': 0.7729236034036256, 'f1-score': 0.4884161986195289, 'support': 216240}, '1': {'precision': 0.6903026519543063, 'recall': 0.20042701141443411, 'f1-score': 0.31065609060194543, 'support': 424813}, '2': {'precision': 0.43099796582277516, 'recall': 0.5312676082791781, 'f1-score': 0.47590865689973544, 'support': 212968}, 'accuracy': 0.42788643370596274, 'macro avg': {'precision': 0.4927686184193214, 'recall': 0.5015394076990792, 'f1-score': 0.42499364870706996, 'support': 854021}, 'weighted avg': {'precision': 0.5412479644211039, 'recall': 0.42788643370596274, 'f1-score': 0.39687452585942734, 'support': 854021}}
[[167137  15660  33443]
 [223741  85144 115928]
 [ 77286  22539 113143]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.06531
{'0': {'precision': 0.37148993631115035, 'recall': 0.7010584399297718, 'f1-score': 0.48563992257894134, 'support': 99675}, '1': {'precision': 0.7128731518975422, 'recall': 0.13807821392091055, 'f1-score': 0.23134636248338247, 'support': 164472}, '2': {'precision': 0.41185244993054937, 'recall': 0.5903451387322355, 'f1-score': 0.4852039047826332, 'support': 101959}, 'accuracy': 0.41730810202509655, 'macro avg': {'precision': 0.4987385127130806, 'recall': 0.47649393086097264, 'f1-score': 0.40073006328165234, 'support': 366106}, 'weighted avg': {'precision': 0.5360960934351673, 'recall': 0.41730810202509655, 'f1-score': 0.3712778898492659, 'support': 366106}}
[[69878  3715 26082]
 [81888 22710 59874]
 [36336  5432 60191]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0541133
{'0': {'precision': 0.40431368246155774, 'recall': 0.6706882654255181, 'f1-score': 0.504498513534658, 'support': 38459}, '1': {'precision': 0.6281555606095065, 'recall': 0.11395329647660699, 'f1-score': 0.1929107735288982, 'support': 48476}, '2': {'precision': 0.43433223041058805, 'recall': 0.5947024299835255, 'f1-score': 0.5020208604954367, 'support': 38848}, 'accuracy': 0.4326578313444583, 'macro avg': {'precision': 0.4889338244938841, 'recall': 0.45978133062855014, 'f1-score': 0.399810049186331, 'support': 125783}, 'weighted avg': {'precision': 0.49985218476969073, 'recall': 0.4326578313444583, 'f1-score': 0.38364927993562736, 'support': 125783}}
[[25794  1451 11214]
 [24077  5524 18875]
 [13926  1819 23103]]
testing model on single stock: results/universal/W9/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.103837
{'0': {'precision': 0.38242014246673534, 'recall': 0.5577021573484133, 'f1-score': 0.4537208371913342, 'support': 857117}, '1': {'precision': 0.41684417874894064, 'recall': 0.039933951758452144, 'f1-score': 0.07288543042312917, 'support': 911455}, '2': {'precision': 0.3965241402650545, 'recall': 0.5933540661485764, 'f1-score': 0.4753700191153106, 'support': 868832}, 'accuracy': 0.3905124129636567, 'macro avg': {'precision': 0.3985961538269102, 'recall': 0.39699672508514733, 'f1-score': 0.3339920955765914, 'support': 2637404}, 'weighted avg': {'precision': 0.39896291126692923, 'recall': 0.3905124129636567, 'f1-score': 0.3292405400330141, 'support': 2637404}}
[[478016  21175 357926]
 [448398  36398 426659]
 [323562  29745 515525]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1144651
{'0': {'precision': 0.37241142595629456, 'recall': 0.6096097554208343, 'f1-score': 0.46236403572227114, 'support': 288332}, '1': {'precision': 0.33513322080203845, 'recall': 0.25236380009004955, 'f1-score': 0.2879180323658355, 'support': 288730}, '2': {'precision': 0.4253075287340852, 'recall': 0.26502891724702443, 'f1-score': 0.32656190903322746, 'support': 298092}, 'accuracy': 0.37437753812471863, 'macro avg': {'precision': 0.3776173918308061, 'recall': 0.37566749091930274, 'f1-score': 0.358947992373778, 'support': 875154}, 'weighted avg': {'precision': 0.3781299268087717, 'recall': 0.37437753812471863, 'f1-score': 0.35855450951534745, 'support': 875154}}
[[175770  66543  46019]
 [155132  72865  60733]
 [141076  78013  79003]]
Evaluating performance on  val set...
1396/1396 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.098435
{'0': {'precision': 0.373431388703397, 'recall': 0.7259546489083706, 'f1-score': 0.4931739050760492, 'support': 118630}, '1': {'precision': 0.39978487534914386, 'recall': 0.18978595135932005, 'f1-score': 0.25738570997754967, 'support': 121421}, '2': {'precision': 0.4223774399698581, 'recall': 0.24866271381649108, 'f1-score': 0.3130349797553458, 'support': 117215}, 'accuracy': 0.38713731505376947, 'macro avg': {'precision': 0.398531234674133, 'recall': 0.38813443802806064, 'f1-score': 0.35453153160298156, 'support': 357266}, 'weighted avg': {'precision': 0.3984465821480894, 'recall': 0.38713731505376947, 'f1-score': 0.35393697077913555, 'support': 357266}}
[[86120 15025 17485]
 [76002 23044 22375]
 [68496 19572 29147]]
training model: results/universal/W9/deepOF_L1/h10
Epoch 1/50
6697/6697 - 99s - loss: 2.8507 - accuracy10: 0.5394 - val_loss: 3.2317 - val_accuracy10: 0.4410 - 99s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 96s - loss: 2.8396 - accuracy10: 0.5378 - val_loss: 3.2277 - val_accuracy10: 0.4404 - 96s/epoch - 14ms/step
Epoch 3/50
6697/6697 - 98s - loss: 2.8263 - accuracy10: 0.5402 - val_loss: 3.2365 - val_accuracy10: 0.4487 - 98s/epoch - 15ms/step
Epoch 4/50
6697/6697 - 96s - loss: 2.8162 - accuracy10: 0.5439 - val_loss: 3.2474 - val_accuracy10: 0.4564 - 96s/epoch - 14ms/step
Epoch 5/50
6697/6697 - 98s - loss: 2.8092 - accuracy10: 0.5447 - val_loss: 3.2407 - val_accuracy10: 0.4492 - 98s/epoch - 15ms/step
Epoch 6/50
6697/6697 - 96s - loss: 2.8017 - accuracy10: 0.5454 - val_loss: 3.2555 - val_accuracy10: 0.4608 - 96s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 97s - loss: 2.7980 - accuracy10: 0.5460 - val_loss: 3.2392 - val_accuracy10: 0.4621 - 97s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 94s - loss: 2.7901 - accuracy10: 0.5467 - val_loss: 3.2417 - val_accuracy10: 0.4588 - 94s/epoch - 14ms/step
Epoch 9/50
6697/6697 - 96s - loss: 2.7851 - accuracy10: 0.5474 - val_loss: 3.2424 - val_accuracy10: 0.4593 - 96s/epoch - 14ms/step
Epoch 10/50
6697/6697 - 96s - loss: 2.7791 - accuracy10: 0.5485 - val_loss: 3.2408 - val_accuracy10: 0.4598 - 96s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 95s - loss: 2.7732 - accuracy10: 0.5494 - val_loss: 3.2483 - val_accuracy10: 0.4609 - 95s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 94s - loss: 2.7690 - accuracy10: 0.5499 - val_loss: 3.2397 - val_accuracy10: 0.4600 - 94s/epoch - 14ms/step
testing model in sample: results/universal/W9/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 88s - 88s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0552111
{'0': {'precision': 0.3671171050387676, 'recall': 0.3197298546988188, 'f1-score': 0.34178879876338447, 'support': 1070535}, '1': {'precision': 0.5325027489231755, 'recall': 0.5957599679441418, 'f1-score': 0.5623580676484341, 'support': 2171210}, '2': {'precision': 0.3595443630890982, 'recall': 0.31915574272631153, 'f1-score': 0.338148313994721, 'support': 1065931}, 'accuracy': 0.45871602228208436, 'macro avg': {'precision': 0.41972140568368044, 'recall': 0.4115485217897574, 'f1-score': 0.4140983934688465, 'support': 4307676}, 'weighted avg': {'precision': 0.44860302539561714, 'recall': 0.45871602228208436, 'f1-score': 0.45206211010944725, 'support': 4307676}}
[[ 342282  568971  159282]
 [ 430978 1293520  446712]
 [ 159091  566642  340198]]
Evaluating performance on  train set...
6697/6697 - 35s - 35s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0621878
{'0': {'precision': 0.3362539734289673, 'recall': 0.2973347619688263, 'f1-score': 0.31559902998528655, 'support': 416248}, '1': {'precision': 0.5274174357188461, 'recall': 0.5793010569072371, 'f1-score': 0.5521430788027143, 'support': 878412}, '2': {'precision': 0.33224964248697864, 'recall': 0.3019561738831828, 'f1-score': 0.3163794094277676, 'support': 419339}, 'accuracy': 0.44297108691428644, 'macro avg': {'precision': 0.39864035054493074, 'recall': 0.39286399758641544, 'f1-score': 0.3947071727385895, 'support': 1713999}, 'weighted avg': {'precision': 0.43324417418409866, 'recall': 0.44297108691428644, 'f1-score': 0.4370170556345692, 'support': 1713999}}
[[123765 225918  66565]
 [181629 508865 187918]
 [ 62676 230041 126622]]
Evaluating performance on  val set...
2631/2631 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.061923
{'0': {'precision': 0.33028945915922, 'recall': 0.2875652396072849, 'f1-score': 0.30745017445849576, 'support': 164394}, '1': {'precision': 0.5245863269621198, 'recall': 0.5735138523110186, 'f1-score': 0.5479600694444444, 'support': 347812}, '2': {'precision': 0.3300888389392845, 'recall': 0.3071287634057227, 'f1-score': 0.31819515513811375, 'support': 160659}, 'accuracy': 0.4400466661217332, 'macro avg': {'precision': 0.3949882083535414, 'recall': 0.3894026184413421, 'f1-score': 0.39120179968035135, 'support': 672865}, 'weighted avg': {'precision': 0.430675941946031, 'recall': 0.4400466661217332, 'f1-score': 0.43433819129078677, 'support': 672865}}
[[ 47274  91954  25166]
 [ 73362 199475  74975]
 [ 22493  88823  49343]]
testing model out of sample: results/universal/W9/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 44s - 44s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0364383
{'0': {'precision': 0.2623360643731141, 'recall': 0.38495158012994124, 'f1-score': 0.31203031098494444, 'support': 348927}, '1': {'precision': 0.7334746289694055, 'recall': 0.5598420525261049, 'f1-score': 0.6350029310427334, 'support': 1516960}, '2': {'precision': 0.25358489311356947, 'recall': 0.3975150063847715, 'f1-score': 0.30964157875861875, 'support': 345353}, 'accuracy': 0.506892512798249, 'macro avg': {'precision': 0.41646519548536304, 'recall': 0.44743621301360587, 'f1-score': 0.41889160692876554, 'support': 2211240}, 'weighted avg': {'precision': 0.584180872581175, 'recall': 0.506892512798249, 'f1-score': 0.5332236639824957, 'support': 2211240}}
[[134320 156354  58253]
 [321869 849258 345833]
 [ 55826 152244 137283]]
Evaluating performance on  train set...
3947/3947 - 26s - 26s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0464807
{'0': {'precision': 0.26447001255307073, 'recall': 0.3723315041508372, 'f1-score': 0.3092659643348847, 'support': 177675}, '1': {'precision': 0.6803619756094196, 'recall': 0.526720096686769, 'f1-score': 0.5937629823186733, 'support': 655312}, '2': {'precision': 0.25829303991527475, 'recall': 0.3687587421497619, 'f1-score': 0.30379569671748746, 'support': 176587}, 'accuracy': 0.4719198394570383, 'macro avg': {'precision': 0.40104167602592167, 'recall': 0.42260344766245606, 'f1-score': 0.4022748811236818, 'support': 1009574}, 'weighted avg': {'precision': 0.5333440337017845, 'recall': 0.47191983945703825, 'f1-score': 0.4929754613120644, 'support': 1009574}}
[[ 66154  81496  30025]
 [153180 345166 156966]
 [ 30804  80665  65118]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0466408
{'0': {'precision': 0.26771270518230256, 'recall': 0.3703095171032454, 'f1-score': 0.3107620992363906, 'support': 63906}, '1': {'precision': 0.6689710065066987, 'recall': 0.5235672341389465, 'f1-score': 0.5874047265876051, 'support': 229556}, '2': {'precision': 0.2635529977933757, 'recall': 0.3669090291606848, 'f1-score': 0.30675907641873496, 'support': 64779}, 'accuracy': 0.4679001007701519, 'macro avg': {'precision': 0.4000789031607923, 'recall': 0.4202619268009589, 'f1-score': 0.4016419674142435, 'support': 358241}, 'weighted avg': {'precision': 0.5240814316370517, 'recall': 0.4679001007701519, 'f1-score': 0.4873071154381388, 'support': 358241}}
[[ 23665  29694  10547]
 [ 53500 120188  55868]
 [ 11232  29779  23768]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0895026
{'0': {'precision': 0.3521886746695768, 'recall': 0.27175336826347307, 'f1-score': 0.30678637443886986, 'support': 21376}, '1': {'precision': 0.45808397683397684, 'recall': 0.615511818682922, 'f1-score': 0.5252555996734964, 'support': 30841}, '2': {'precision': 0.3586831842165634, 'recall': 0.2701161836479074, 'f1-score': 0.30816230998546407, 'support': 23153}, 'accuracy': 0.4119145548626775, 'macro avg': {'precision': 0.38965194524003904, 'recall': 0.38579379019810084, 'f1-score': 0.38006809469927677, 'support': 75370}, 'weighted avg': {'precision': 0.39751552080986663, 'recall': 0.4119145548626775, 'f1-score': 0.3966054856392336, 'support': 75370}}
[[ 5809 10739  4828]
 [ 5504 18983  6354]
 [ 5181 11718  6254]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.095889
{'0': {'precision': 0.31813755864388776, 'recall': 0.24519033974621368, 'f1-score': 0.2769408591793489, 'support': 14658}, '1': {'precision': 0.46791704363560443, 'recall': 0.6075543306375096, 'f1-score': 0.528670558864579, 'support': 22133}, '2': {'precision': 0.3295761947700631, 'recall': 0.2549881400865076, 'f1-score': 0.2875235997482693, 'support': 14334}, 'accuracy': 0.4048117359413203, 'macro avg': {'precision': 0.3718769323498518, 'recall': 0.3692442701567436, 'f1-score': 0.36437833926406576, 'support': 51125}, 'weighted avg': {'precision': 0.38618705989678287, 'recall': 0.4048117359413203, 'f1-score': 0.388886608743126, 'support': 51125}}
[[ 3594  7648  3416]
 [ 4667 13447  4019]
 [ 3036  7643  3655]]
Evaluating performance on  val set...
53/53 - 0s - 455ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0925008
{'0': {'precision': 0.3104733507267984, 'recall': 0.22747132714363735, 'f1-score': 0.26256895193065405, 'support': 3662}, '1': {'precision': 0.48356625258799174, 'recall': 0.6170739762219286, 'f1-score': 0.5422228670922808, 'support': 6056}, '2': {'precision': 0.3225806451612903, 'recall': 0.2631578947368421, 'f1-score': 0.2898550724637681, 'support': 3762}, 'accuracy': 0.4124629080118694, 'macro avg': {'precision': 0.37220674949202676, 'recall': 0.3692343993674694, 'f1-score': 0.3648822971622343, 'support': 13480}, 'weighted avg': {'precision': 0.39161565453495456, 'recall': 0.4124629080118694, 'f1-score': 0.39582076911643943, 'support': 13480}}
[[ 833 1948  881]
 [1121 3737 1198]
 [ 729 2043  990]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9956852
{'0': {'precision': 0.14741438486766836, 'recall': 0.4383150017008731, 'f1-score': 0.22062726520361864, 'support': 17638}, '1': {'precision': 0.9155711915177898, 'recall': 0.6790740607542737, 'f1-score': 0.7797855304153111, 'support': 250254}, '2': {'precision': 0.17595692039004512, 'recall': 0.4634466896665024, 'f1-score': 0.2550709786310618, 'support': 18261}, 'accuracy': 0.6504736976372779, 'macro avg': {'precision': 0.4129808322585011, 'recall': 0.5269452507072164, 'f1-score': 0.41849459141666384, 'support': 286153}, 'weighted avg': {'precision': 0.8210244072423896, 'recall': 0.6504736976372779, 'f1-score': 0.711835007751086, 'support': 286153}}
[[  7731   7915   1992]
 [ 42671 169941  37642]
 [  2042   7756   8463]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0000155
{'0': {'precision': 0.1786410858575807, 'recall': 0.48252876034834963, 'f1-score': 0.2607483151289798, 'support': 9301}, '1': {'precision': 0.915342573453886, 'recall': 0.6520478401474228, 'f1-score': 0.761580704891829, 'support': 110702}, '2': {'precision': 0.19369922726372102, 'recall': 0.5304970696765792, 'f1-score': 0.28378182240413363, 'support': 9214}, 'accuracy': 0.6311785600965817, 'macro avg': {'precision': 0.4292276288583959, 'recall': 0.5550245567241172, 'f1-score': 0.4353702808083142, 'support': 129217}, 'weighted avg': {'precision': 0.8108572322996306, 'recall': 0.6311785600965817, 'f1-score': 0.6914608215914437, 'support': 129217}}
[[ 4488  3380  1433]
 [19605 72183 18914]
 [ 1030  3296  4888]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0030969
{'0': {'precision': 0.18179083525518902, 'recall': 0.5405485986881335, 'f1-score': 0.272079237637878, 'support': 3354}, '1': {'precision': 0.9247602473432813, 'recall': 0.6099794841735052, 'f1-score': 0.7350885196685847, 'support': 40944}, '2': {'precision': 0.19490351768073125, 'recall': 0.600910902362653, 'f1-score': 0.29433909648633577, 'support': 3513}, 'accuracy': 0.6044424923134843, 'macro avg': {'precision': 0.4338182000930672, 'recall': 0.5838129950747639, 'f1-score': 0.43383561793093284, 'support': 47811}, 'weighted avg': {'precision': 0.819012488470888, 'recall': 0.6044424923134842, 'f1-score': 0.6702229896531022, 'support': 47811}}
[[ 1813  1092   449]
 [ 7698 24975  8271]
 [  462   940  2111]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0643102
{'0': {'precision': 0.42807839270306913, 'recall': 0.3641892777559313, 'f1-score': 0.3935577999065116, 'support': 38145}, '1': {'precision': 0.43204231359836204, 'recall': 0.48366886961836725, 'f1-score': 0.45640027396272664, 'support': 52354}, '2': {'precision': 0.37617611424741576, 'recall': 0.370794796219128, 'f1-score': 0.3734660712229203, 'support': 39356}, 'accuracy': 0.41436217319317703, 'macro avg': {'precision': 0.41209894018294896, 'recall': 0.4062176478644755, 'f1-score': 0.4078080483640529, 'support': 129855}, 'weighted avg': {'precision': 0.41394617633597863, 'recall': 0.41436217319317703, 'f1-score': 0.4128048432446015, 'support': 129855}}
[[13892 16327  7926]
 [10758 25322 16274]
 [ 7802 16961 14593]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0803603
{'0': {'precision': 0.4251559857717651, 'recall': 0.32737640878272195, 'f1-score': 0.3699137493658042, 'support': 22271}, '1': {'precision': 0.37485266383781235, 'recall': 0.5528706158459733, 'f1-score': 0.44678198261480373, 'support': 23009}, '2': {'precision': 0.4376303976733894, 'recall': 0.3201368976042919, 'f1-score': 0.3697748337295334, 'support': 21622}, 'accuracy': 0.402588861319542, 'macro avg': {'precision': 0.41254634909432236, 'recall': 0.40012797407766243, 'f1-score': 0.3954901885700471, 'support': 66902}, 'weighted avg': {'precision': 0.411887213534143, 'recall': 0.402588861319542, 'f1-score': 0.3963054498372218, 'support': 66902}}
[[ 7291 10907  4073]
 [ 5466 12721  4822]
 [ 4392 10308  6922]]
Evaluating performance on  val set...
73/73 - 1s - 559ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0903151
{'0': {'precision': 0.467966573816156, 'recall': 0.3452730475631239, 'f1-score': 0.397364419665484, 'support': 6812}, '1': {'precision': 0.2812914639540027, 'recall': 0.5016761979885624, 'f1-score': 0.3604675876726886, 'support': 5071}, '2': {'precision': 0.46388828278420247, 'recall': 0.31403249630723784, 'f1-score': 0.37452655685721836, 'support': 6770}, 'accuracy': 0.37645418967458316, 'macro avg': {'precision': 0.4043821068514537, 'recall': 0.3869939139529747, 'f1-score': 0.37745285473179696, 'support': 18653}, 'weighted avg': {'precision': 0.4157369318069722, 'recall': 0.37645418967458316, 'f1-score': 0.3790447838831743, 'support': 18653}}
[[2352 3249 1211]
 [1281 2544 1246]
 [1393 3251 2126]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0893896
{'0': {'precision': 0.41757961060339444, 'recall': 0.28092183144308247, 'f1-score': 0.33588256780202724, 'support': 52374}, '1': {'precision': 0.37741104868913855, 'recall': 0.5996020751594489, 'f1-score': 0.4632413679167355, 'support': 53779}, '2': {'precision': 0.40911246813304086, 'recall': 0.28600145062687804, 'f1-score': 0.3366549171230287, 'support': 48255}, 'accuracy': 0.39350292730946584, 'macro avg': {'precision': 0.40136770914185793, 'recall': 0.3888417857431365, 'f1-score': 0.3785929509472638, 'support': 154408}, 'weighted avg': {'precision': 0.40094312123047543, 'recall': 0.39350292730946584, 'f1-score': 0.3804819320050078, 'support': 154408}}
[[14713 28173  9488]
 [11088 32246 10445]
 [ 9433 25021 13801]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0887703
{'0': {'precision': 0.44434550311665183, 'recall': 0.27149075081610446, 'f1-score': 0.33704829449510304, 'support': 29408}, '1': {'precision': 0.3379453899840823, 'recall': 0.636604774535809, 'f1-score': 0.44151169766046794, 'support': 26013}, '2': {'precision': 0.44992020427705076, 'recall': 0.2589843462923495, 'f1-score': 0.3287390097716831, 'support': 27214}, 'accuracy': 0.3823077388515762, 'macro avg': {'precision': 0.41073703245926163, 'recall': 0.389026623881421, 'f1-score': 0.3690996673090847, 'support': 82635}, 'weighted avg': {'precision': 0.4126872926061123, 'recall': 0.3823077388515762, 'f1-score': 0.36719626608193046, 'support': 82635}}
[[ 7984 16840  4584]
 [ 5420 16560  4033]
 [ 4564 15602  7048]]
Evaluating performance on  val set...
112/112 - 1s - 757ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0957493
{'0': {'precision': 0.4702117933871705, 'recall': 0.2842405821129225, 'f1-score': 0.3543053960964409, 'support': 10857}, '1': {'precision': 0.26762512030798846, 'recall': 0.5928047968021319, 'f1-score': 0.36876787268432176, 'support': 7505}, '2': {'precision': 0.4611280487804878, 'recall': 0.24024620272014297, 'f1-score': 0.3159062724365251, 'support': 10073}, 'accuracy': 0.35009671179883944, 'macro avg': {'precision': 0.3996549874918823, 'recall': 0.37243052721173253, 'f1-score': 0.3463265137390959, 'support': 28435}, 'weighted avg': {'precision': 0.41352413589174675, 'recall': 0.35009671179883944, 'f1-score': 0.34451979786066506, 'support': 28435}}
[[3086 6198 1573]
 [1801 4449 1255]
 [1676 5977 2420]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1074232
{'0': {'precision': 0.48281474389660123, 'recall': 0.2473796948836601, 'f1-score': 0.3271418068589716, 'support': 61157}, '1': {'precision': 0.27495033684574194, 'recall': 0.6372644696344119, 'f1-score': 0.38415530934405334, 'support': 39963}, '2': {'precision': 0.44884187976971485, 'recall': 0.27851256147813375, 'f1-score': 0.34373365870664113, 'support': 60184}, 'accuracy': 0.35558944601497794, 'macro avg': {'precision': 0.40220232017068597, 'recall': 0.3877189086654019, 'f1-score': 0.3516769249698887, 'support': 161304}, 'weighted avg': {'precision': 0.41864083529181767, 'recall': 0.35558944601497794, 'f1-score': 0.3474574506831264, 'support': 161304}}
[[15129 33656 12372]
 [ 6285 25467  8211]
 [ 9921 33501 16762]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0927086
{'0': {'precision': 0.4243916465978937, 'recall': 0.2838903582591969, 'f1-score': 0.3402054429413205, 'support': 41590}, '1': {'precision': 0.3399902231423971, 'recall': 0.607033756898986, 'f1-score': 0.43586128083902415, 'support': 38955}, '2': {'precision': 0.4352553139506474, 'recall': 0.2582757454211569, 'f1-score': 0.3241841562537911, 'support': 41386}, 'accuracy': 0.3784353445801314, 'macro avg': {'precision': 0.3998790612303127, 'recall': 0.3830666201931132, 'f1-score': 0.36675029334471193, 'support': 121931}, 'weighted avg': {'precision': 0.4011141067298716, 'recall': 0.3784353445801314, 'f1-score': 0.36532798105267, 'support': 121931}}
[[11807 22858  6925]
 [ 8364 23647  6944]
 [ 7650 23047 10689]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0864211
{'0': {'precision': 0.4148917287894924, 'recall': 0.2992957746478873, 'f1-score': 0.34773876822374294, 'support': 15620}, '1': {'precision': 0.35883925162275676, 'recall': 0.5970016516325752, 'f1-score': 0.44824954688543356, 'support': 15742}, '2': {'precision': 0.44717001168100246, 'recall': 0.2714497518210533, 'f1-score': 0.3378259125551545, 'support': 15513}, 'accuracy': 0.39005866666666666, 'macro avg': {'precision': 0.4069669973644172, 'recall': 0.38924905936717197, 'f1-score': 0.37793807588811035, 'support': 46875}, 'weighted avg': {'precision': 0.4067499668041536, 'recall': 0.39005866666666666, 'f1-score': 0.37821263590812737, 'support': 46875}}
[[4675 8491 2454]
 [3592 9398 2752]
 [3001 8301 4211]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/EXC
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.023354
{'0': {'precision': 0.18431205903382034, 'recall': 0.6006814684546055, 'f1-score': 0.28207325130068545, 'support': 45490}, '1': {'precision': 0.9198159619728655, 'recall': 0.5175716483058034, 'f1-score': 0.6624109741477283, 'support': 512957}, '2': {'precision': 0.15945567050178866, 'recall': 0.6006692312945301, 'f1-score': 0.25201151757958923, 'support': 43931}, 'accuracy': 0.5299081307750283, 'macro avg': {'precision': 0.4211945638361582, 'recall': 0.5729741160183129, 'f1-score': 0.3988319143426677, 'support': 602378}, 'weighted avg': {'precision': 0.8088201080251565, 'recall': 0.5299081307750283, 'f1-score': 0.603758729977445, 'support': 602378}}
[[ 27325  12080   6085]
 [114450 265492 133015]
 [  6479  11064  26388]]
Evaluating performance on  train set...
1250/1250 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0335116
{'0': {'precision': 0.15662460389954555, 'recall': 0.6219326526956833, 'f1-score': 0.250231963174157, 'support': 22332}, '1': {'precision': 0.9250379181267324, 'recall': 0.4507879176254697, 'f1-score': 0.6061754416887603, 'support': 274648}, '2': {'precision': 0.15400254651497106, 'recall': 0.6541917473610748, 'f1-score': 0.24931429426334428, 'support': 22926}, 'accuracy': 0.4773120854250936, 'macro avg': {'precision': 0.4118883561804163, 'recall': 0.5756374392274093, 'f1-score': 0.3685738997087539, 'support': 319906}, 'weighted avg': {'precision': 0.8161404199150928, 'recall': 0.4773120854250936, 'f1-score': 0.5557533538627638, 'support': 319906}}
[[ 13889   5000   3443]
 [ 71893 123808  78947]
 [  2895   5033  14998]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0352914
{'0': {'precision': 0.1473262701259698, 'recall': 0.5741844586539504, 'f1-score': 0.2344870319553864, 'support': 9227}, '1': {'precision': 0.9152189665743855, 'recall': 0.4551233484246512, 'f1-score': 0.6079320707678447, 'support': 108230}, '2': {'precision': 0.15544153975622335, 'recall': 0.6249727133813577, 'f1-score': 0.24896193395508595, 'support': 9162}, 'accuracy': 0.47608968638198057, 'macro avg': {'precision': 0.40599559215219294, 'recall': 0.5514268401533197, 'f1-score': 0.3637936788927723, 'support': 126619}, 'weighted avg': {'precision': 0.8042843778109493, 'recall': 0.47608968638198057, 'f1-score': 0.5547436727659568, 'support': 126619}}
[[ 5298  2288  1641]
 [29502 49258 29470]
 [ 1161  2275  5726]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/AAL
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.016194
{'0': {'precision': 0.18832178323278928, 'recall': 0.493204344471482, 'f1-score': 0.272568043610887, 'support': 84245}, '1': {'precision': 0.8903337314418325, 'recall': 0.5553517827162407, 'f1-score': 0.6840331733649242, 'support': 825538}, '2': {'precision': 0.169586792408457, 'recall': 0.5347356972475931, 'f1-score': 0.2575073578207162, 'support': 80911}, 'accuracy': 0.5483832545670005, 'macro avg': {'precision': 0.4160807690276929, 'recall': 0.5277639414784385, 'f1-score': 0.40470285826550906, 'support': 990694}, 'weighted avg': {'precision': 0.7717730536129566, 'recall': 0.5483832545670005, 'f1-score': 0.6142088783579631, 'support': 990694}}
[[ 41550  30485  12210]
 [167424 458464 199650]
 [ 11659  25986  43266]]
Evaluating performance on  train set...
1577/1577 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0268195
{'0': {'precision': 0.15202095522159764, 'recall': 0.5411052130121138, 'f1-score': 0.23735745417636872, 'support': 29388}, '1': {'precision': 0.9103156583954614, 'recall': 0.4905860130919357, 'f1-score': 0.6375724129634712, 'support': 345709}, '2': {'precision': 0.14716200254003214, 'recall': 0.5831837539154612, 'f1-score': 0.2350187929934047, 'support': 28413}, 'accuracy': 0.5007856063046765, 'macro avg': {'precision': 0.4031662053856971, 'recall': 0.5382916600065036, 'f1-score': 0.36998288671108154, 'support': 403510}, 'weighted avg': {'precision': 0.8013511976368834, 'recall': 0.5007856063046765, 'f1-score': 0.5800787369379827, 'support': 403510}}
[[ 15902   8875   4611]
 [ 84693 169600  91416]
 [  4009   7834  16570]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0247377
{'0': {'precision': 0.1475705632169094, 'recall': 0.555771284341326, 'f1-score': 0.233216555320189, 'support': 10301}, '1': {'precision': 0.9155270074634207, 'recall': 0.4915517722789462, 'f1-score': 0.6396641461258961, 'support': 132513}, '2': {'precision': 0.14567435873862278, 'recall': 0.5959007145543438, 'f1-score': 0.2341164302600473, 'support': 10636}, 'accuracy': 0.5030954708374064, 'macro avg': {'precision': 0.40292397647298434, 'recall': 0.5477412570582053, 'f1-score': 0.36899904390204413, 'support': 153450}, 'weighted avg': {'precision': 0.8106141882778863, 'recall': 0.5030954708374064, 'f1-score': 0.5842700624579993, 'support': 153450}}
[[ 5725  3132  1444]
 [31650 65137 35726]
 [ 1420  2878  6338]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/WBA
Evaluating performance on  test set...
2451/2451 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0432515
{'0': {'precision': 0.32530103434126184, 'recall': 0.3461880166844855, 'f1-score': 0.33541967581447596, 'support': 132818}, '1': {'precision': 0.6274524742638767, 'recall': 0.5607679506698733, 'f1-score': 0.59223900002445, 'support': 367159}, '2': {'precision': 0.3253279950333538, 'recall': 0.40321922110552766, 'f1-score': 0.360109812666323, 'support': 127360}, 'accuracy': 0.48335264777942316, 'macro avg': {'precision': 0.4260271678794975, 'recall': 0.43672506281996215, 'f1-score': 0.429256162835083, 'support': 627337}, 'weighted avg': {'precision': 0.5021454644391075, 'recall': 0.48335264777942316, 'f1-score': 0.49073980213742685, 'support': 627337}}
[[ 45980  65290  21548]
 [ 76317 205891  84951]
 [ 19049  56957  51354]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0410681
{'0': {'precision': 0.3318336253118862, 'recall': 0.3861288280079687, 'f1-score': 0.3569282160726904, 'support': 64753}, '1': {'precision': 0.6307103444847642, 'recall': 0.5697542575524546, 'f1-score': 0.5986847149724261, 'support': 178154}, '2': {'precision': 0.33250946274221793, 'recall': 0.3668219566538384, 'f1-score': 0.34882394340111866, 'support': 64181}, 'accuracy': 0.4886221539102798, 'macro avg': {'precision': 0.4316844775129561, 'recall': 0.4409016807380872, 'f1-score': 0.4348122914820784, 'support': 307088}, 'weighted avg': {'precision': 0.5053651828772779, 'recall': 0.4886221539102798, 'f1-score': 0.4954870232571111, 'support': 307088}}
[[ 25003  29600  10150]
 [ 39539 101504  37111]
 [ 10806  29832  23543]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0449333
{'0': {'precision': 0.332234074772016, 'recall': 0.39940936122011406, 'f1-score': 0.36273789404070833, 'support': 24719}, '1': {'precision': 0.6126213051787802, 'recall': 0.5136358686351685, 'f1-score': 0.5587787293098195, 'support': 64279}, '2': {'precision': 0.3288353248180195, 'recall': 0.40347994607347487, 'f1-score': 0.36235338630344305, 'support': 23736}, 'accuracy': 0.465396419891071, 'macro avg': {'precision': 0.4245635682562719, 'recall': 0.4388417253095858, 'f1-score': 0.4279566698846569, 'support': 112734}, 'weighted avg': {'precision': 0.4913904788241062, 'recall': 0.465396419891071, 'f1-score': 0.4744360700533706, 'support': 112734}}
[[ 9873 10748  4098]
 [15814 33016 15449]
 [ 4030 10129  9577]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.037701
{'0': {'precision': 0.2737972370302336, 'recall': 0.40159995555679007, 'f1-score': 0.3256067967997838, 'support': 144004}, '1': {'precision': 0.7124308632001349, 'recall': 0.5648606985485619, 'f1-score': 0.6301211205119648, 'support': 568264}, '2': {'precision': 0.2924068477260077, 'recall': 0.396560116826221, 'f1-score': 0.33661089619986345, 'support': 141749}, 'accuracy': 0.5093973539168424, 'macro avg': {'precision': 0.42621164931879213, 'recall': 0.454340256977191, 'f1-score': 0.4307796045038707, 'support': 854017}, 'weighted avg': {'precision': 0.568753417818588, 'recall': 0.5093973539168424, 'f1-score': 0.5300574666761922, 'support': 854017}}
[[ 57832  65382  20790]
 [132037 320990 115237]
 [ 21353  64184  56212]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0398163
{'0': {'precision': 0.308316680512832, 'recall': 0.3936331842678592, 'f1-score': 0.3457901562559021, 'support': 69768}, '1': {'precision': 0.665680567315834, 'recall': 0.5577989055723572, 'f1-score': 0.6069834437565446, 'support': 225506}, '2': {'precision': 0.30956490144427284, 'recall': 0.3849107747910549, 'f1-score': 0.34315058148315963, 'support': 70832}, 'accuracy': 0.4930648500707445, 'macro avg': {'precision': 0.42785404975764624, 'recall': 0.4454476215437571, 'f1-score': 0.43197472716520213, 'support': 366106}, 'weighted avg': {'precision': 0.5286794023540844, 'recall': 0.4930648500707445, 'f1-score': 0.5061636194900938, 'support': 366106}}
[[ 27463  31318  10987]
 [ 49898 125787  49821]
 [ 11713  31855  27264]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0473223
{'0': {'precision': 0.32702851766537977, 'recall': 0.3663988949874596, 'f1-score': 0.3455960503308534, 'support': 27511}, '1': {'precision': 0.6005889173684853, 'recall': 0.5609627497363696, 'f1-score': 0.5800999130550112, 'support': 70174}, '2': {'precision': 0.34297661136796304, 'recall': 0.35906470211402947, 'f1-score': 0.3508363181138505, 'support': 28098}, 'accuracy': 0.47330720367617246, 'macro avg': {'precision': 0.4235313488006094, 'recall': 0.42880878227928626, 'f1-score': 0.42551076049990505, 'support': 125783}, 'weighted avg': {'precision': 0.4832096949756753, 'recall': 0.47330720367617246, 'f1-score': 0.47759572522310195, 'support': 125783}}
[[10080 12898  4533]
 [16015 39365 14794]
 [ 4728 13281 10089]]
testing model on single stock: results/universal/W9/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
10303/10303 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0697836
{'0': {'precision': 0.4441256874885193, 'recall': 0.29993979676848515, 'f1-score': 0.3580624857985172, 'support': 822215}, '1': {'precision': 0.402328778766666, 'recall': 0.6282124407711378, 'f1-score': 0.49051496303046555, 'support': 987061}, '2': {'precision': 0.4440791967179472, 'recall': 0.2900459351498085, 'f1-score': 0.3509030281116577, 'support': 828124}, 'accuracy': 0.41969098354439976, 'macro avg': {'precision': 0.43017788765771087, 'recall': 0.4060660575631438, 'f1-score': 0.39982682564688016, 'support': 2637400}, 'weighted avg': {'precision': 0.428468373981736, 'recall': 0.41969098354439976, 'f1-score': 0.4053855144978314, 'support': 2637400}}
[[246615 455464 120136]
 [186426 620084 180551]
 [122241 465689 240194]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0867609
{'0': {'precision': 0.452239608068588, 'recall': 0.24916510015355273, 'f1-score': 0.3213047358163034, 'support': 290454}, '1': {'precision': 0.36017362295066857, 'recall': 0.6764187680645217, 'f1-score': 0.4700559263936497, 'support': 288895}, '2': {'precision': 0.4426783334299125, 'recall': 0.2582554664575192, 'f1-score': 0.32620512667227475, 'support': 295804}, 'accuracy': 0.3932775183310804, 'macro avg': {'precision': 0.41836385481638966, 'recall': 0.39461311155853124, 'f1-score': 0.3725219296274093, 'support': 875153}, 'weighted avg': {'precision': 0.4186161547365876, 'recall': 0.3932775183310804, 'f1-score': 0.37206503763621623, 'support': 875153}}
[[ 72371 170988  47095]
 [ 44399 195414  49082]
 [ 43258 176153  76393]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0819017
{'0': {'precision': 0.4464781102775817, 'recall': 0.2339960597744264, 'f1-score': 0.307062701799544, 'support': 116237}, '1': {'precision': 0.3833779224803495, 'recall': 0.6924732369495641, 'f1-score': 0.493523567136633, 'support': 126854}, '2': {'precision': 0.4400309440923562, 'recall': 0.2590584628859207, 'f1-score': 0.3261206331005055, 'support': 114175}, 'accuracy': 0.4047964261922489, 'macro avg': {'precision': 0.4232956589500958, 'recall': 0.3951759198699704, 'f1-score': 0.37556896734556083, 'support': 357266}, 'weighted avg': {'precision': 0.4220128199280152, 'recall': 0.4047964261922489, 'f1-score': 0.37935966237726015, 'support': 357266}}
[[27199 71702 17336]
 [18707 87843 20304]
 [15013 69584 29578]]
training model: results/universal/W9/deepOF_L1/h20
Epoch 1/50
6697/6697 - 98s - loss: 2.9374 - accuracy20: 0.5059 - val_loss: 3.2510 - val_accuracy20: 0.3139 - 98s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 97s - loss: 2.9260 - accuracy20: 0.5035 - val_loss: 3.2434 - val_accuracy20: 0.3172 - 97s/epoch - 14ms/step
Epoch 3/50
6697/6697 - 95s - loss: 2.9133 - accuracy20: 0.5048 - val_loss: 3.2409 - val_accuracy20: 0.3200 - 95s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 95s - loss: 2.9008 - accuracy20: 0.5069 - val_loss: 3.2387 - val_accuracy20: 0.3203 - 95s/epoch - 14ms/step
Epoch 5/50
6697/6697 - 96s - loss: 2.8959 - accuracy20: 0.5074 - val_loss: 3.2312 - val_accuracy20: 0.3281 - 96s/epoch - 14ms/step
Epoch 6/50
6697/6697 - 97s - loss: 2.8869 - accuracy20: 0.5098 - val_loss: 3.2283 - val_accuracy20: 0.3426 - 97s/epoch - 15ms/step
Epoch 7/50
6697/6697 - 95s - loss: 2.8796 - accuracy20: 0.5123 - val_loss: 3.2281 - val_accuracy20: 0.3469 - 95s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 98s - loss: 2.8734 - accuracy20: 0.5137 - val_loss: 3.2245 - val_accuracy20: 0.3544 - 98s/epoch - 15ms/step
Epoch 9/50
6697/6697 - 98s - loss: 2.8679 - accuracy20: 0.5148 - val_loss: 3.2220 - val_accuracy20: 0.3582 - 98s/epoch - 15ms/step
Epoch 10/50
6697/6697 - 96s - loss: 2.8623 - accuracy20: 0.5162 - val_loss: 3.2276 - val_accuracy20: 0.3600 - 96s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 98s - loss: 2.8579 - accuracy20: 0.5172 - val_loss: 3.2202 - val_accuracy20: 0.3650 - 98s/epoch - 15ms/step
Epoch 12/50
6697/6697 - 94s - loss: 2.8528 - accuracy20: 0.5181 - val_loss: 3.2190 - val_accuracy20: 0.3666 - 94s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 97s - loss: 2.8488 - accuracy20: 0.5193 - val_loss: 3.2203 - val_accuracy20: 0.3714 - 97s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 94s - loss: 2.8442 - accuracy20: 0.5201 - val_loss: 3.2203 - val_accuracy20: 0.3734 - 94s/epoch - 14ms/step
Epoch 15/50
6697/6697 - 96s - loss: 2.8396 - accuracy20: 0.5215 - val_loss: 3.2179 - val_accuracy20: 0.3791 - 96s/epoch - 14ms/step
Epoch 16/50
6697/6697 - 97s - loss: 2.8354 - accuracy20: 0.5225 - val_loss: 3.2206 - val_accuracy20: 0.3807 - 97s/epoch - 15ms/step
Epoch 17/50
6697/6697 - 97s - loss: 2.8315 - accuracy20: 0.5235 - val_loss: 3.2177 - val_accuracy20: 0.3832 - 97s/epoch - 14ms/step
Epoch 18/50
6697/6697 - 99s - loss: 2.8284 - accuracy20: 0.5240 - val_loss: 3.2153 - val_accuracy20: 0.3889 - 99s/epoch - 15ms/step
Epoch 19/50
6697/6697 - 97s - loss: 2.8244 - accuracy20: 0.5249 - val_loss: 3.2161 - val_accuracy20: 0.3960 - 97s/epoch - 14ms/step
Epoch 20/50
6697/6697 - 94s - loss: 2.8210 - accuracy20: 0.5258 - val_loss: 3.2156 - val_accuracy20: 0.3962 - 94s/epoch - 14ms/step
Epoch 21/50
6697/6697 - 98s - loss: 2.8170 - accuracy20: 0.5267 - val_loss: 3.2238 - val_accuracy20: 0.4003 - 98s/epoch - 15ms/step
Epoch 22/50
6697/6697 - 95s - loss: 2.8144 - accuracy20: 0.5272 - val_loss: 3.2235 - val_accuracy20: 0.3992 - 95s/epoch - 14ms/step
Epoch 23/50
6697/6697 - 94s - loss: 2.8114 - accuracy20: 0.5279 - val_loss: 3.2225 - val_accuracy20: 0.4071 - 94s/epoch - 14ms/step
Epoch 24/50
6697/6697 - 94s - loss: 2.8092 - accuracy20: 0.5288 - val_loss: 3.2205 - val_accuracy20: 0.4064 - 94s/epoch - 14ms/step
Epoch 25/50
6697/6697 - 96s - loss: 2.8063 - accuracy20: 0.5293 - val_loss: 3.2305 - val_accuracy20: 0.4079 - 96s/epoch - 14ms/step
Epoch 26/50
6697/6697 - 96s - loss: 2.8042 - accuracy20: 0.5293 - val_loss: 3.2336 - val_accuracy20: 0.4102 - 96s/epoch - 14ms/step
Epoch 27/50
6697/6697 - 99s - loss: 2.8021 - accuracy20: 0.5302 - val_loss: 3.2333 - val_accuracy20: 0.4129 - 99s/epoch - 15ms/step
Epoch 28/50
6697/6697 - 96s - loss: 2.7997 - accuracy20: 0.5307 - val_loss: 3.2380 - val_accuracy20: 0.4119 - 96s/epoch - 14ms/step
testing model in sample: results/universal/W9/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 91s - 91s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0802997
{'0': {'precision': 0.361540771780795, 'recall': 0.4450840261404924, 'f1-score': 0.3989860533244845, 'support': 1141371}, '1': {'precision': 0.5302582506130777, 'recall': 0.24339326179816978, 'f1-score': 0.3336419127776581, 'support': 2026416}, '2': {'precision': 0.331900574877853, 'recall': 0.5743076738173629, 'f1-score': 0.4206826573719568, 'support': 1139889}, 'accuracy': 0.3843996159414032, 'macro avg': {'precision': 0.4078998657572419, 'recall': 0.42092832058534174, 'f1-score': 0.3844368744913665, 'support': 4307676}, 'weighted avg': {'precision': 0.4330654788799133, 'recall': 0.3843996159414032, 'f1-score': 0.3739881909923898, 'support': 4307676}}
[[508006 221352 412013]
 [627441 493216 905759]
 [269667 215575 654647]]
Evaluating performance on  train set...
6697/6697 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.079499
{'0': {'precision': 0.35121318060805884, 'recall': 0.4174487454083138, 'f1-score': 0.38147720513627936, 'support': 444009}, '1': {'precision': 0.5415848420887672, 'recall': 0.2695722651846164, 'f1-score': 0.35997034695848823, 'support': 820485}, '2': {'precision': 0.32811688478646545, 'recall': 0.5678001357048309, 'f1-score': 0.41589747141233463, 'support': 449505}, 'accuracy': 0.386091240426628, 'macro avg': {'precision': 0.4069716358277638, 'recall': 0.41827371543258707, 'f1-score': 0.38578167450236744, 'support': 1713999}, 'weighted avg': {'precision': 0.4362862712088781, 'recall': 0.386091240426628, 'f1-score': 0.38020884223782564, 'support': 1713999}}
[[185351  93293 165365]
 [242039 221180 357266]
 [100355  93921 255229]]
Evaluating performance on  val set...
2631/2631 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0796008
{'0': {'precision': 0.3515960385939559, 'recall': 0.42001218604021395, 'f1-score': 0.38277098677360893, 'support': 177252}, '1': {'precision': 0.5376263571695994, 'recall': 0.28072287661201234, 'f1-score': 0.3688499024546368, 'support': 322268}, '2': {'precision': 0.33051845831810933, 'recall': 0.5583778014941302, 'f1-score': 0.4152434394265048, 'support': 173345}, 'accuracy': 0.388945776641674, 'macro avg': {'precision': 0.4065802846938882, 'recall': 0.4197042880487855, 'f1-score': 0.38895477621825014, 'support': 672865}, 'weighted avg': {'precision': 0.43526501462008127, 'recall': 0.388945776641674, 'f1-score': 0.38446912429571173, 'support': 672865}}
[[ 74448  39963  62841]
 [ 98584  90468 133216]
 [ 38711  37842  96792]]
testing model out of sample: results/universal/W9/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 45s - 45s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0845548
{'0': {'precision': 0.29347159135918666, 'recall': 0.5140074828860142, 'f1-score': 0.373623537214494, 'support': 425237}, '1': {'precision': 0.6972495662668778, 'recall': 0.2164449579718173, 'f1-score': 0.3303426890781642, 'support': 1366583}, '2': {'precision': 0.24483964594977092, 'recall': 0.6084068475513805, 'f1-score': 0.34916549504154565, 'support': 419420}, 'accuracy': 0.3480142363560717, 'macro avg': {'precision': 0.41185360119194514, 'recall': 0.4462864294697373, 'f1-score': 0.3510439071114013, 'support': 2211240}, 'weighted avg': {'precision': 0.5337887463218592, 'recall': 0.3480142363560717, 'f1-score': 0.34223614220677523, 'support': 2211240}}
[[218575  64764 141898]
 [425644 295790 645149]
 [100572  63670 255178]]
Evaluating performance on  train set...
3947/3947 - 28s - 28s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.086006
{'0': {'precision': 0.30162779222203306, 'recall': 0.5016942807226371, 'f1-score': 0.37674786579706643, 'support': 208348}, '1': {'precision': 0.6562638791591691, 'recall': 0.24165430267062316, 'f1-score': 0.35323706167292857, 'support': 593120}, '2': {'precision': 0.2611081623289581, 'recall': 0.5578695472499592, 'f1-score': 0.3557222390744162, 'support': 208106}, 'accuracy': 0.3605015580829142, 'macro avg': {'precision': 0.40633327790338675, 'recall': 0.4337393768810731, 'f1-score': 0.361902388848137, 'support': 1009574}, 'weighted avg': {'precision': 0.5016224214276443, 'recall': 0.3605015580829142, 'f1-score': 0.35860131367027587, 'support': 1009574}}
[[104527  36721  67100]
 [188358 143330 261432]
 [ 53658  38352 116096]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0953981
{'0': {'precision': 0.30502192140950174, 'recall': 0.499705740730833, 'f1-score': 0.3788143799398723, 'support': 74764}, '1': {'precision': 0.6297019451224022, 'recall': 0.20473618652341402, 'f1-score': 0.30900499390279307, 'support': 207931}, '2': {'precision': 0.25845509744102096, 'recall': 0.5752786381807111, 'f1-score': 0.35666949802830544, 'support': 75546}, 'accuracy': 0.34443572902040803, 'macro avg': {'precision': 0.3977263213243083, 'recall': 0.4265735218116527, 'f1-score': 0.3481629572903236, 'support': 358241}, 'weighted avg': {'precision': 0.48365335870206244, 'recall': 0.34443572902040803, 'f1-score': 0.3336255470118514, 'support': 358241}}
[[37360 12404 25000]
 [65667 42571 99693]
 [19456 12630 43460]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1019279
{'0': {'precision': 0.3829377537778894, 'recall': 0.37887761441292195, 'f1-score': 0.3808968647208228, 'support': 24145}, '1': {'precision': 0.4302598559054481, 'recall': 0.21573243495555466, 'f1-score': 0.287374966207083, 'support': 24637}, '2': {'precision': 0.3818493150684932, 'recall': 0.5619452384534377, 'f1-score': 0.4547142248463084, 'support': 26588}, 'accuracy': 0.39012869842112247, 'macro avg': {'precision': 0.3983489749172769, 'recall': 0.38551842927397145, 'f1-score': 0.3743286852580714, 'support': 75370}, 'weighted avg': {'precision': 0.398022472123534, 'recall': 0.39012869842112247, 'f1-score': 0.37636663992758146, 'support': 75370}}
[[ 9148  3558 11439]
 [ 6574  5315 12748]
 [ 8167  3480 14941]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1215314
{'0': {'precision': 0.3553238660195338, 'recall': 0.3521586792564879, 'f1-score': 0.35373419231686953, 'support': 16839}, '1': {'precision': 0.3941488828774672, 'recall': 0.22061462539255272, 'f1-score': 0.28288929637220006, 'support': 17832}, '2': {'precision': 0.3475362911470047, 'recall': 0.516530934727118, 'f1-score': 0.41550759001686666, 'support': 16454}, 'accuracy': 0.35917848410757947, 'macro avg': {'precision': 0.3656696800146686, 'recall': 0.36310141312538624, 'f1-score': 0.3507103595686454, 'support': 51125}, 'weighted avg': {'precision': 0.36635938569988735, 'recall': 0.35917848410757947, 'f1-score': 0.34890511263511703, 'support': 51125}}
[[5930 3091 7818]
 [5760 3934 8138]
 [4999 2956 8499]]
Evaluating performance on  val set...
53/53 - 0s - 446ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1242745
{'0': {'precision': 0.34661558109833973, 'recall': 0.32027377861694595, 'f1-score': 0.33292443572129543, 'support': 4237}, '1': {'precision': 0.3991919191919192, 'recall': 0.19895287958115182, 'f1-score': 0.2655557048783766, 'support': 4966}, '2': {'precision': 0.3301833568406206, 'recall': 0.5473462707505261, 'f1-score': 0.41189407935251166, 'support': 4277}, 'accuracy': 0.3476261127596439, 'macro avg': {'precision': 0.35866361904362654, 'recall': 0.3555243096495413, 'f1-score': 0.3367914066507279, 'support': 13480}, 'weighted avg': {'precision': 0.36077088316231976, 'recall': 0.3476261127596439, 'f1-score': 0.3331618280391572, 'support': 13480}}
[[1357  735 2145]
 [1374  988 2604]
 [1184  752 2341]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
1118/1118 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0524372
{'0': {'precision': 0.17684001517078285, 'recall': 0.6534355550059767, 'f1-score': 0.2783498819212164, 'support': 24261}, '1': {'precision': 0.9064402177039824, 'recall': 0.3327729104534356, 'f1-score': 0.48682303720572373, 'support': 236726}, '2': {'precision': 0.15427919708029197, 'recall': 0.671898593340221, 'f1-score': 0.25093866405473186, 'support': 25166}, 'accuracy': 0.389784485921867, 'macro avg': {'precision': 0.4125198099850191, 'recall': 0.5527023529332111, 'f1-score': 0.3387038610605573, 'support': 286153}, 'weighted avg': {'precision': 0.7784327714822977, 'recall': 0.389784485921867, 'f1-score': 0.44840291456128073, 'support': 286153}}
[[15853  3091  5317]
 [70576 78776 87374]
 [ 3217  5040 16909]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0590103
{'0': {'precision': 0.21084273531437048, 'recall': 0.6231214777708203, 'f1-score': 0.3150749990105671, 'support': 12776}, '1': {'precision': 0.9152421652421653, 'recall': 0.2723401795691881, 'f1-score': 0.41977251804116056, 'support': 103804}, '2': {'precision': 0.1574185666408017, 'recall': 0.7545303473925774, 'f1-score': 0.26049065675882416, 'support': 12637}, 'accuracy': 0.3541794036388401, 'macro avg': {'precision': 0.4278344890657791, 'recall': 0.5499973349108619, 'f1-score': 0.3317793912701839, 'support': 129217}, 'weighted avg': {'precision': 0.7714838057981066, 'recall': 0.3541794036388401, 'f1-score': 0.3938435738297971, 'support': 129217}}
[[ 7961  1143  3672]
 [28170 28270 47364]
 [ 1627  1475  9535]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0508553
{'0': {'precision': 0.21256815322242414, 'recall': 0.654823428079242, 'f1-score': 0.3209498680738786, 'support': 4644}, '1': {'precision': 0.9172913749073235, 'recall': 0.2902687625452934, 'f1-score': 0.440990099009901, 'support': 38361}, '2': {'precision': 0.16657306000187214, 'recall': 0.7405326674989596, 'f1-score': 0.2719700443221764, 'support': 4806}, 'accuracy': 0.37093974190039947, 'macro avg': {'precision': 0.4321441960438733, 'recall': 0.5618749527078316, 'f1-score': 0.34463667046865204, 'support': 47811}, 'weighted avg': {'precision': 0.773377069351274, 'recall': 0.37093974190039947, 'f1-score': 0.4123402649696991, 'support': 47811}}
[[ 3041   459  1144]
 [10563 11135 16663]
 [  702   545  3559]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0704356
{'0': {'precision': 0.41917746982565934, 'recall': 0.47456855104003237, 'f1-score': 0.44515654299888435, 'support': 39518}, '1': {'precision': 0.46185691318327976, 'recall': 0.2297556684128444, 'f1-score': 0.30686036264587285, 'support': 50014}, '2': {'precision': 0.3723914667552088, 'recall': 0.5562830146566475, 'f1-score': 0.44613059130054294, 'support': 40323}, 'accuracy': 0.40565245851141657, 'macro avg': {'precision': 0.4178086165880493, 'recall': 0.42020241136984143, 'f1-score': 0.3993824989817667, 'support': 129855}, 'weighted avg': {'precision': 0.4210874284585826, 'recall': 0.40565245851141657, 'f1-score': 0.39219386451513133, 'support': 129855}}
[[18754  6502 14262]
 [14981 11491 23542]
 [11005  6887 22431]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0881922
{'0': {'precision': 0.41899375975039, 'recall': 0.4707506244248718, 'f1-score': 0.4433668310600276, 'support': 22821}, '1': {'precision': 0.3625788793431156, 'recall': 0.21998247151621383, 'f1-score': 0.2738286632981166, 'support': 21679}, '2': {'precision': 0.40759187448859796, 'recall': 0.511427551111508, 'f1-score': 0.4536437607649819, 'support': 22402}, 'accuracy': 0.4031120145885026, 'macro avg': {'precision': 0.3963881711940345, 'recall': 0.40072021568419786, 'f1-score': 0.39027975170770873, 'support': 66902}, 'weighted avg': {'precision': 0.39689511956050083, 'recall': 0.4031120145885026, 'f1-score': 0.39187070000774094, 'support': 66902}}
[[10743  4135  7943]
 [ 8201  4769  8709]
 [ 6696  4249 11457]]
Evaluating performance on  val set...
73/73 - 1s - 611ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0895934
{'0': {'precision': 0.4304571349173267, 'recall': 0.4612864800476474, 'f1-score': 0.4453388916840365, 'support': 6716}, '1': {'precision': 0.2823972387825541, 'recall': 0.17695635076681085, 'f1-score': 0.21757524477215034, 'support': 5086}, '2': {'precision': 0.43366791631394364, 'recall': 0.5234272368997227, 'f1-score': 0.47433862433862434, 'support': 6851}, 'accuracy': 0.4065833914115692, 'macro avg': {'precision': 0.38217409667127483, 'recall': 0.38722335590472695, 'f1-score': 0.37908425359827036, 'support': 18653}, 'weighted avg': {'precision': 0.39126582154182515, 'recall': 0.4065833914115692, 'f1-score': 0.39388718205141593, 'support': 18653}}
[[3098 1178 2440]
 [1943  900 2243]
 [2156 1109 3586]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0897169
{'0': {'precision': 0.3853400813869986, 'recall': 0.46112452428694195, 'f1-score': 0.4198397913561848, 'support': 48874}, '1': {'precision': 0.4830028328611898, 'recall': 0.17741637715455752, 'f1-score': 0.2595097521756742, 'support': 59583}, '2': {'precision': 0.3517072775406559, 'recall': 0.5666688428978695, 'f1-score': 0.4340303532882729, 'support': 45951}, 'accuracy': 0.3830565773794104, 'macro avg': {'precision': 0.40668339726294817, 'recall': 0.40173658144645624, 'f1-score': 0.37112663227337733, 'support': 154408}, 'weighted avg': {'precision': 0.413017266193119, 'recall': 0.3830565773794104, 'f1-score': 0.3621946291032511, 'support': 154408}}
[[22537  5570 20767]
 [21782 10571 27230]
 [14167  5745 26039]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0901968
{'0': {'precision': 0.42023433259904863, 'recall': 0.45908900669642855, 'f1-score': 0.43880323360280027, 'support': 28672}, '1': {'precision': 0.36770186335403726, 'recall': 0.18070169138506842, 'f1-score': 0.24231917557545987, 'support': 27847}, '2': {'precision': 0.3774683073325006, 'recall': 0.543842854954817, 'f1-score': 0.44563324600348275, 'support': 26116}, 'accuracy': 0.39206147516185635, 'macro avg': {'precision': 0.3884681677618622, 'recall': 0.39454451767877136, 'f1-score': 0.3755852183939143, 'support': 82635}, 'weighted avg': {'precision': 0.3890157304700839, 'recall': 0.39206147516185635, 'f1-score': 0.374749031871922, 'support': 82635}}
[[13163  4313 11196]
 [10587  5032 12228]
 [ 7573  4340 14203]]
Evaluating performance on  val set...
112/112 - 1s - 950ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0904642
{'0': {'precision': 0.45510919385279053, 'recall': 0.47891053527520333, 'f1-score': 0.4667066033823326, 'support': 10574}, '1': {'precision': 0.30978466188137516, 'recall': 0.20322180916976457, 'f1-score': 0.2454354983537863, 'support': 8070}, '2': {'precision': 0.4099384051939404, 'recall': 0.5030129710959044, 'f1-score': 0.4517312542994726, 'support': 9791}, 'accuracy': 0.4089678213469316, 'macro avg': {'precision': 0.39161075364270204, 'recall': 0.3950484385136241, 'f1-score': 0.38795778534519715, 'support': 28435}, 'weighted avg': {'precision': 0.3983117201489705, 'recall': 0.4089678213469316, 'f1-score': 0.3987522703262169, 'support': 28435}}
[[5064 1692 3818]
 [3159 1640 3271]
 [2904 1962 4925]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1172069
{'0': {'precision': 0.43084729000494487, 'recall': 0.3353189210896192, 'f1-score': 0.37712769460936985, 'support': 59764}, '1': {'precision': 0.280838128324829, 'recall': 0.29727182881702635, 'f1-score': 0.28882140145594215, 'support': 43509}, '2': {'precision': 0.40466422253258844, 'recall': 0.479312781099757, 'f1-score': 0.4388366057412418, 'support': 58031}, 'accuracy': 0.3768598422853742, 'macro avg': {'precision': 0.3721165469541208, 'recall': 0.3706345103354675, 'f1-score': 0.3682619006021846, 'support': 161304}, 'weighted avg': {'precision': 0.3809652151399169, 'recall': 0.3768598422853742, 'f1-score': 0.37550908200882166, 'support': 161304}}
[[20040 17057 22667]
 [12321 12934 18254]
 [14152 16064 27815]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1026452
{'0': {'precision': 0.3959293484618084, 'recall': 0.4181346510191476, 'f1-score': 0.40672915164623885, 'support': 40475}, '1': {'precision': 0.355546265328874, 'recall': 0.312258285602389, 'f1-score': 0.3324992832381995, 'support': 40854}, '2': {'precision': 0.3969426869255992, 'recall': 0.4233781587113935, 'f1-score': 0.4097344710873814, 'support': 40602}, 'accuracy': 0.3844059345039407, 'macro avg': {'precision': 0.38280610023876055, 'recall': 0.3845903651109767, 'f1-score': 0.3829876353239399, 'support': 121931}, 'weighted avg': {'precision': 0.38273609235789663, 'recall': 0.3844059345039407, 'f1-score': 0.38285856037746574, 'support': 121931}}
[[16924 11422 12129]
 [14110 12757 13987]
 [11711 11701 17190]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0996996
{'0': {'precision': 0.39077184259989084, 'recall': 0.4241805976043175, 'f1-score': 0.40679142866159623, 'support': 15194}, '1': {'precision': 0.37635321587773296, 'recall': 0.3189422558014031, 'f1-score': 0.34527750730282375, 'support': 16677}, '2': {'precision': 0.3848852237060742, 'recall': 0.4168221807517995, 'f1-score': 0.40021757911240524, 'support': 15004}, 'accuracy': 0.384384, 'macro avg': {'precision': 0.384003427394566, 'recall': 0.38664834471917336, 'f1-score': 0.38409550502560835, 'support': 46875}, 'weighted avg': {'precision': 0.38375782088835475, 'recall': 0.384384, 'f1-score': 0.38280205895202163, 'support': 46875}}
[[6445 4452 4297]
 [5660 5319 5698]
 [4388 4362 6254]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/EXC
Evaluating performance on  test set...
2354/2354 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0887201
{'0': {'precision': 0.21547784719549146, 'recall': 0.6924528601106935, 'f1-score': 0.3286776190745027, 'support': 63057}, '1': {'precision': 0.9191437364228819, 'recall': 0.21261222404609562, 'f1-score': 0.34534157688540645, 'support': 477616}, '2': {'precision': 0.16125630920279332, 'recall': 0.755935499554331, 'f1-score': 0.2658099810522417, 'support': 61705}, 'accuracy': 0.3184976874985474, 'macro avg': {'precision': 0.4319592976070556, 'recall': 0.55366686123704, 'f1-score': 0.3132763923373836, 'support': 602378}, 'weighted avg': {'precision': 0.7678491943353104, 'recall': 0.3184976874985474, 'f1-score': 0.33545031872430564, 'support': 602378}}
[[ 43664   3545  15848]
 [149302 101547 226767]
 [  9672   5388  46645]]
Evaluating performance on  train set...
1250/1250 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0799723
{'0': {'precision': 0.20350470415124627, 'recall': 0.7216951296647691, 'f1-score': 0.31748460923098326, 'support': 31620}, '1': {'precision': 0.9207898524649154, 'recall': 0.24018256268259203, 'f1-score': 0.38098694434363456, 'support': 255693}, '2': {'precision': 0.17918837497784867, 'recall': 0.775595986868346, 'f1-score': 0.29111868622889653, 'support': 32593}, 'accuracy': 0.3423255581327015, 'macro avg': {'precision': 0.4344943105313368, 'recall': 0.5791578930719024, 'f1-score': 0.32986341326783813, 'support': 319906}, 'weighted avg': {'precision': 0.7743356648428821, 'recall': 0.3423255581327015, 'f1-score': 0.3655542235662947, 'support': 319906}}
[[ 22820   2312   6488]
 [ 84972  61413 109308]
 [  4343   2971  25279]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0875552
{'0': {'precision': 0.19083936198030158, 'recall': 0.6788094869012556, 'f1-score': 0.29792155662142394, 'support': 12902}, '1': {'precision': 0.9155096576783324, 'recall': 0.23748623361676374, 'f1-score': 0.3771408763609435, 'support': 100789}, '2': {'precision': 0.1794181231907955, 'recall': 0.757503094059406, 'f1-score': 0.2901199822248556, 'support': 12928}, 'accuracy': 0.33554995695748663, 'macro avg': {'precision': 0.4285890476164764, 'recall': 0.557932938192475, 'f1-score': 0.321727471735741, 'support': 126619}, 'weighted avg': {'precision': 0.7665123704390485, 'recall': 0.33554995695748663, 'f1-score': 0.3601837547388282, 'support': 126619}}
[[ 8758   976  3168]
 [35232 23936 41621]
 [ 1902  1233  9793]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/AAL
Evaluating performance on  test set...
3870/3870 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0987247
{'0': {'precision': 0.22810874681594978, 'recall': 0.6124242660633955, 'f1-score': 0.33240653183351443, 'support': 115371}, '1': {'precision': 0.8939005672339005, 'recall': 0.17508057959800388, 'f1-score': 0.2928108318432408, 'support': 765082}, '2': {'precision': 0.15654955686061114, 'recall': 0.7541930860569117, 'f1-score': 0.2592798181302215, 'support': 110241}, 'accuracy': 0.2904529552011014, 'macro avg': {'precision': 0.4261862903034872, 'recall': 0.5138993105727704, 'f1-score': 0.2948323939356589, 'support': 990694}, 'weighted avg': {'precision': 0.7343160932712025, 'recall': 0.2904529552011014, 'f1-score': 0.2936907231324188, 'support': 990694}}
[[ 70656   7739  36976]
 [220153 133951 410978]
 [ 18938   8160  83143]]
Evaluating performance on  train set...
1577/1577 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1142755
{'0': {'precision': 0.19260133104814478, 'recall': 0.6419615698493953, 'f1-score': 0.296305174125946, 'support': 40437}, '1': {'precision': 0.9039594216064805, 'recall': 0.1843046821699683, 'f1-score': 0.30618294459146206, 'support': 323931}, '2': {'precision': 0.1430255964950366, 'recall': 0.7406111082724439, 'f1-score': 0.239750895271807, 'support': 39142}, 'accuracy': 0.28413174394686624, 'macro avg': {'precision': 0.413195449716554, 'recall': 0.5222924534306025, 'f1-score': 0.280746337996405, 'support': 403510}, 'weighted avg': {'precision': 0.7588585346633574, 'recall': 0.28413174394686624, 'f1-score': 0.2987489016215629, 'support': 403510}}
[[ 25959   2845  11633]
 [102167  59702 162062]
 [  6655   3498  28989]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1231629
{'0': {'precision': 0.1948372840498192, 'recall': 0.6713969264848401, 'f1-score': 0.3020272163921154, 'support': 14446}, '1': {'precision': 0.9087920737071161, 'recall': 0.15801676045113144, 'f1-score': 0.2692223288986421, 'support': 124221}, '2': {'precision': 0.138221783577634, 'recall': 0.7673679226138131, 'f1-score': 0.23424948892146943, 'support': 14783}, 'accuracy': 0.26505050505050504, 'macro avg': {'precision': 0.4139503804448565, 'recall': 0.5322605365165949, 'f1-score': 0.2684996780707423, 'support': 153450}, 'weighted avg': {'precision': 0.7673444914954939, 'recall': 0.26505050505050504, 'f1-score': 0.2689414290051796, 'support': 153450}}
[[ 9699   808  3939]
 [37804 19629 66788]
 [ 2277  1162 11344]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/WBA
Evaluating performance on  test set...
2451/2451 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0758704
{'0': {'precision': 0.36604540927367296, 'recall': 0.469567017626878, 'f1-score': 0.4113937170278702, 'support': 169060}, '1': {'precision': 0.5819276488447486, 'recall': 0.1905665464595059, 'f1-score': 0.28711139320850526, 'support': 296710}, '2': {'precision': 0.327762527928503, 'recall': 0.635575334071933, 'f1-score': 0.43249162397050117, 'support': 161567}, 'accuracy': 0.380363345378959, 'macro avg': {'precision': 0.42524519534897487, 'recall': 0.4319029660527723, 'f1-score': 0.37699891140229225, 'support': 627337}, 'weighted avg': {'precision': 0.45829115440402357, 'recall': 0.380363345378959, 'f1-score': 0.35804586289294155, 'support': 627337}}
[[ 79385  21687  67988]
 [ 97543  56543 142624]
 [ 39944  18935 102688]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0491292
{'0': {'precision': 0.3783723392886635, 'recall': 0.4790057558911792, 'f1-score': 0.4227832024359399, 'support': 81308}, '1': {'precision': 0.5979801248601054, 'recall': 0.30547117696085524, 'f1-score': 0.4043730794831815, 'support': 145179}, '2': {'precision': 0.3534217490307096, 'recall': 0.5699929281274426, 'f1-score': 0.4363107985545579, 'support': 80601}, 'accuracy': 0.42084679310165163, 'macro avg': {'precision': 0.4432580710598262, 'recall': 0.45148995365982564, 'f1-score': 0.4211556934912264, 'support': 307088}, 'weighted avg': {'precision': 0.4756454211938341, 'recall': 0.42084679310165163, 'f1-score': 0.4176301991749796, 'support': 307088}}
[[38947 15519 26842]
 [43623 44348 57208]
 [20363 14296 45942]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.046476
{'0': {'precision': 0.3856747191875673, 'recall': 0.48865999480114375, 'f1-score': 0.43110219291959295, 'support': 30776}, '1': {'precision': 0.5961250801339126, 'recall': 0.3187461913467398, 'f1-score': 0.41538652438267776, 'support': 52512}, '2': {'precision': 0.35918269020191845, 'recall': 0.5569856686816546, 'f1-score': 0.4367311072056239, 'support': 29446}, 'accuracy': 0.42735998013021803, 'macro avg': {'precision': 0.4469941631744661, 'recall': 0.4547972849431794, 'f1-score': 0.42773994150263156, 'support': 112734}, 'weighted avg': {'precision': 0.47678374635331205, 'recall': 0.42735998013021803, 'f1-score': 0.42525203080218366, 'support': 112734}}
[[15039  5851  9886]
 [16399 16738 19375]
 [ 7556  5489 16401]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
3337/3337 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0627748
{'0': {'precision': 0.3109188228706215, 'recall': 0.5330858886820891, 'f1-score': 0.39276187615837255, 'support': 186439}, '1': {'precision': 0.6894775608711324, 'recall': 0.27307015130104834, 'f1-score': 0.3912029284052344, 'support': 483341}, '2': {'precision': 0.31069988248296293, 'recall': 0.5783203156803465, 'f1-score': 0.4042294078146162, 'support': 184237}, 'accuracy': 0.39568533179081916, 'macro avg': {'precision': 0.43703208874157234, 'recall': 0.4614921185544946, 'f1-score': 0.39606473745940773, 'support': 854017}, 'weighted avg': {'precision': 0.5251213762901715, 'recall': 0.39568533179081916, 'f1-score': 0.39435346070973604, 'support': 854017}}
[[ 99388  30215  56836]
 [171810 131986 179545]
 [ 48461  29228 106548]]
Evaluating performance on  train set...
1431/1431 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0446215
{'0': {'precision': 0.35455164981457415, 'recall': 0.509740703609187, 'f1-score': 0.41821359804086516, 'support': 87776}, '1': {'precision': 0.6613655730720068, 'recall': 0.3288194297335085, 'f1-score': 0.4392509479880016, 'support': 188824}, '2': {'precision': 0.3420598507156064, 'recall': 0.5580743190400643, 'f1-score': 0.4241474763942667, 'support': 89506}, 'accuracy': 0.42824482526918434, 'macro avg': {'precision': 0.4526590245340625, 'recall': 0.46554481746091997, 'f1-score': 0.42720400747437787, 'support': 366106}, 'weighted avg': {'precision': 0.5097409700524541, 'recall': 0.42824482526918434, 'f1-score': 0.4305146099945552, 'support': 366106}}
[[44743 15566 27467]
 [58123 62089 68612]
 [23330 16225 49951]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0571833
{'0': {'precision': 0.36907769016188197, 'recall': 0.49173275584560006, 'f1-score': 0.42166679214032976, 'support': 34171}, '1': {'precision': 0.599632620259462, 'recall': 0.27498639897509697, 'f1-score': 0.37705746462604683, 'support': 56981}, '2': {'precision': 0.3675011547344111, 'recall': 0.5743697842973059, 'f1-score': 0.44821758529000855, 'support': 34631}, 'accuracy': 0.4162963198524443, 'macro avg': {'precision': 0.445403821718585, 'recall': 0.4470296463726677, 'f1-score': 0.4156472806854617, 'support': 125783}, 'weighted avg': {'precision': 0.47308740112044917, 'recall': 0.4162963198524443, 'f1-score': 0.40876835933522226, 'support': 125783}}
[[16803  5262 12106]
 [19184 15669 22128]
 [ 9540  5200 19891]]
testing model on single stock: results/universal/W9/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
10303/10303 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820531
{'0': {'precision': 0.4135779041290119, 'recall': 0.41444698661314955, 'f1-score': 0.4140119892831221, 'support': 836119}, '1': {'precision': 0.39987574459480835, 'recall': 0.2565702812673615, 'f1-score': 0.31258086185512873, 'support': 955781}, '2': {'precision': 0.3896192354023659, 'recall': 0.5466516853932585, 'f1-score': 0.45496662763667767, 'support': 845500}, 'accuracy': 0.399615530446652, 'macro avg': {'precision': 0.40102429470872875, 'recall': 0.40588965109125646, 'f1-score': 0.39385315959164285, 'support': 2637400}, 'weighted avg': {'precision': 0.4009316168194874, 'recall': 0.399615530446652, 'f1-score': 0.39038311323992664, 'support': 2637400}}
[[346527 187337 302255]
 [288734 245225 421822]
 [202615 180691 462194]]
Evaluating performance on  train set...
3419/3419 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0923387
{'0': {'precision': 0.4199193234637672, 'recall': 0.3540273380450432, 'f1-score': 0.38416838697833344, 'support': 289633}, '1': {'precision': 0.36706839558113147, 'recall': 0.28420069314701246, 'f1-score': 0.3203624869107386, 'support': 287962}, '2': {'precision': 0.39150031248851147, 'recall': 0.5368297945274535, 'f1-score': 0.4527894349698756, 'support': 297558}, 'accuracy': 0.39320553091859367, 'macro avg': {'precision': 0.39282934384447005, 'recall': 0.391685941906503, 'f1-score': 0.3857734362863159, 'support': 875153}, 'weighted avg': {'precision': 0.39286649617217967, 'recall': 0.39320553091859367, 'f1-score': 0.3865051980308038, 'support': 875153}}
[[102538  69888 117207]
 [ 75053  81839 131070]
 [ 66594  71226 159738]]
Evaluating performance on  val set...
1396/1396 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.090359
{'0': {'precision': 0.418768461713247, 'recall': 0.3581482983541181, 'f1-score': 0.3860933878012014, 'support': 118356}, '1': {'precision': 0.3819529641720904, 'recall': 0.29980577136514985, 'f1-score': 0.3359302846587844, 'support': 122536}, '2': {'precision': 0.3886188626369158, 'recall': 0.5338391736985925, 'f1-score': 0.4497981790866472, 'support': 116374}, 'accuracy': 0.39536647763851024, 'macro avg': {'precision': 0.3964467628407511, 'recall': 0.3972644144726201, 'f1-score': 0.39060728384887766, 'support': 357266}, 'weighted avg': {'precision': 0.396320612632696, 'recall': 0.39536647763851024, 'f1-score': 0.3896391922561265, 'support': 357266}}
[[42389 30991 44976]
 [33039 36737 52760]
 [25795 28454 62125]]
training model: results/universal/W9/deepOF_L1/h30
Epoch 1/50
6697/6697 - 102s - loss: 2.9903 - accuracy30: 0.4861 - val_loss: 3.2953 - val_accuracy30: 0.3307 - 102s/epoch - 15ms/step
Epoch 2/50
6697/6697 - 99s - loss: 2.9736 - accuracy30: 0.4869 - val_loss: 3.2762 - val_accuracy30: 0.3346 - 99s/epoch - 15ms/step
Epoch 3/50
6697/6697 - 96s - loss: 2.9630 - accuracy30: 0.4893 - val_loss: 3.2845 - val_accuracy30: 0.3351 - 96s/epoch - 14ms/step
Epoch 4/50
6697/6697 - 96s - loss: 2.9560 - accuracy30: 0.4897 - val_loss: 3.2810 - val_accuracy30: 0.3363 - 96s/epoch - 14ms/step
Epoch 5/50
6697/6697 - 93s - loss: 2.9520 - accuracy30: 0.4902 - val_loss: 3.2773 - val_accuracy30: 0.3377 - 93s/epoch - 14ms/step
Epoch 6/50
6697/6697 - 96s - loss: 2.9471 - accuracy30: 0.4913 - val_loss: 3.2751 - val_accuracy30: 0.3396 - 96s/epoch - 14ms/step
Epoch 7/50
6697/6697 - 95s - loss: 2.9416 - accuracy30: 0.4928 - val_loss: 3.2665 - val_accuracy30: 0.3414 - 95s/epoch - 14ms/step
Epoch 8/50
6697/6697 - 96s - loss: 2.9361 - accuracy30: 0.4941 - val_loss: 3.2671 - val_accuracy30: 0.3414 - 96s/epoch - 14ms/step
Epoch 9/50
6697/6697 - 95s - loss: 2.9295 - accuracy30: 0.4953 - val_loss: 3.2644 - val_accuracy30: 0.3426 - 95s/epoch - 14ms/step
Epoch 10/50
6697/6697 - 94s - loss: 2.9239 - accuracy30: 0.4959 - val_loss: 3.2618 - val_accuracy30: 0.3425 - 94s/epoch - 14ms/step
Epoch 11/50
6697/6697 - 96s - loss: 2.9185 - accuracy30: 0.4971 - val_loss: 3.2563 - val_accuracy30: 0.3448 - 96s/epoch - 14ms/step
Epoch 12/50
6697/6697 - 93s - loss: 2.9133 - accuracy30: 0.4986 - val_loss: 3.2547 - val_accuracy30: 0.3471 - 93s/epoch - 14ms/step
Epoch 13/50
6697/6697 - 93s - loss: 2.9082 - accuracy30: 0.4998 - val_loss: 3.2526 - val_accuracy30: 0.3489 - 93s/epoch - 14ms/step
Epoch 14/50
6697/6697 - 95s - loss: 2.9035 - accuracy30: 0.5013 - val_loss: 3.2542 - val_accuracy30: 0.3560 - 95s/epoch - 14ms/step
Epoch 15/50
6697/6697 - 93s - loss: 2.8992 - accuracy30: 0.5024 - val_loss: 3.2564 - val_accuracy30: 0.3588 - 93s/epoch - 14ms/step
Epoch 16/50
6697/6697 - 95s - loss: 2.8951 - accuracy30: 0.5037 - val_loss: 3.2515 - val_accuracy30: 0.3610 - 95s/epoch - 14ms/step
Epoch 17/50
6697/6697 - 95s - loss: 2.8918 - accuracy30: 0.5051 - val_loss: 3.2652 - val_accuracy30: 0.3730 - 95s/epoch - 14ms/step
Epoch 18/50
6697/6697 - 94s - loss: 2.8879 - accuracy30: 0.5064 - val_loss: 3.2541 - val_accuracy30: 0.3650 - 94s/epoch - 14ms/step
Epoch 19/50
6697/6697 - 94s - loss: 2.8849 - accuracy30: 0.5075 - val_loss: 3.2551 - val_accuracy30: 0.3687 - 94s/epoch - 14ms/step
Epoch 20/50
6697/6697 - 94s - loss: 2.8816 - accuracy30: 0.5081 - val_loss: 3.2506 - val_accuracy30: 0.3727 - 94s/epoch - 14ms/step
Epoch 21/50
6697/6697 - 95s - loss: 2.8778 - accuracy30: 0.5095 - val_loss: 3.2461 - val_accuracy30: 0.3722 - 95s/epoch - 14ms/step
Epoch 22/50
6697/6697 - 96s - loss: 2.8753 - accuracy30: 0.5104 - val_loss: 3.2447 - val_accuracy30: 0.3759 - 96s/epoch - 14ms/step
Epoch 23/50
6697/6697 - 95s - loss: 2.8724 - accuracy30: 0.5112 - val_loss: 3.2470 - val_accuracy30: 0.3788 - 95s/epoch - 14ms/step
Epoch 24/50
6697/6697 - 94s - loss: 2.8692 - accuracy30: 0.5123 - val_loss: 3.2493 - val_accuracy30: 0.3819 - 94s/epoch - 14ms/step
Epoch 25/50
6697/6697 - 95s - loss: 2.8664 - accuracy30: 0.5130 - val_loss: 3.2549 - val_accuracy30: 0.3853 - 95s/epoch - 14ms/step
Epoch 26/50
6697/6697 - 95s - loss: 2.8645 - accuracy30: 0.5133 - val_loss: 3.2500 - val_accuracy30: 0.3875 - 95s/epoch - 14ms/step
Epoch 27/50
6697/6697 - 95s - loss: 2.8615 - accuracy30: 0.5145 - val_loss: 3.2552 - val_accuracy30: 0.3907 - 95s/epoch - 14ms/step
Epoch 28/50
6697/6697 - 95s - loss: 2.8594 - accuracy30: 0.5152 - val_loss: 3.2443 - val_accuracy30: 0.3894 - 95s/epoch - 14ms/step
Epoch 29/50
6697/6697 - 95s - loss: 2.8571 - accuracy30: 0.5154 - val_loss: 3.2405 - val_accuracy30: 0.3886 - 95s/epoch - 14ms/step
Epoch 30/50
6697/6697 - 97s - loss: 2.8546 - accuracy30: 0.5162 - val_loss: 3.2403 - val_accuracy30: 0.3886 - 97s/epoch - 15ms/step
Epoch 31/50
6697/6697 - 99s - loss: 2.8525 - accuracy30: 0.5167 - val_loss: 3.2354 - val_accuracy30: 0.3902 - 99s/epoch - 15ms/step
Epoch 32/50
6697/6697 - 99s - loss: 2.8504 - accuracy30: 0.5170 - val_loss: 3.2299 - val_accuracy30: 0.3900 - 99s/epoch - 15ms/step
Epoch 33/50
6697/6697 - 96s - loss: 2.8488 - accuracy30: 0.5175 - val_loss: 3.2428 - val_accuracy30: 0.3914 - 96s/epoch - 14ms/step
Epoch 34/50
6697/6697 - 96s - loss: 2.8467 - accuracy30: 0.5181 - val_loss: 3.2316 - val_accuracy30: 0.3901 - 96s/epoch - 14ms/step
Epoch 35/50
6697/6697 - 100s - loss: 2.8451 - accuracy30: 0.5185 - val_loss: 3.2353 - val_accuracy30: 0.3930 - 100s/epoch - 15ms/step
Epoch 36/50
6697/6697 - 95s - loss: 2.8430 - accuracy30: 0.5189 - val_loss: 3.2326 - val_accuracy30: 0.3956 - 95s/epoch - 14ms/step
Epoch 37/50
6697/6697 - 94s - loss: 2.8400 - accuracy30: 0.5197 - val_loss: 3.2396 - val_accuracy30: 0.3908 - 94s/epoch - 14ms/step
Epoch 38/50
6697/6697 - 97s - loss: 2.8389 - accuracy30: 0.5196 - val_loss: 3.2499 - val_accuracy30: 0.3929 - 97s/epoch - 14ms/step
Epoch 39/50
6697/6697 - 96s - loss: 2.8373 - accuracy30: 0.5202 - val_loss: 3.2332 - val_accuracy30: 0.3924 - 96s/epoch - 14ms/step
Epoch 40/50
6697/6697 - 95s - loss: 2.8357 - accuracy30: 0.5210 - val_loss: 3.2395 - val_accuracy30: 0.3924 - 95s/epoch - 14ms/step
Epoch 41/50
6697/6697 - 94s - loss: 2.8346 - accuracy30: 0.5211 - val_loss: 3.2319 - val_accuracy30: 0.3982 - 94s/epoch - 14ms/step
Epoch 42/50
6697/6697 - 97s - loss: 2.8319 - accuracy30: 0.5215 - val_loss: 3.2250 - val_accuracy30: 0.3936 - 97s/epoch - 14ms/step
Epoch 43/50
6697/6697 - 95s - loss: 2.8301 - accuracy30: 0.5218 - val_loss: 3.2315 - val_accuracy30: 0.3927 - 95s/epoch - 14ms/step
Epoch 44/50
6697/6697 - 96s - loss: 2.8293 - accuracy30: 0.5219 - val_loss: 3.2424 - val_accuracy30: 0.3944 - 96s/epoch - 14ms/step
Epoch 45/50
6697/6697 - 95s - loss: 2.8268 - accuracy30: 0.5228 - val_loss: 3.2384 - val_accuracy30: 0.3936 - 95s/epoch - 14ms/step
Epoch 46/50
6697/6697 - 95s - loss: 2.8253 - accuracy30: 0.5230 - val_loss: 3.2314 - val_accuracy30: 0.3956 - 95s/epoch - 14ms/step
Epoch 47/50
6697/6697 - 95s - loss: 2.8240 - accuracy30: 0.5234 - val_loss: 3.2250 - val_accuracy30: 0.3997 - 95s/epoch - 14ms/step
Epoch 48/50
6697/6697 - 96s - loss: 2.8228 - accuracy30: 0.5231 - val_loss: 3.2223 - val_accuracy30: 0.3946 - 96s/epoch - 14ms/step
Epoch 49/50
6697/6697 - 97s - loss: 2.8211 - accuracy30: 0.5238 - val_loss: 3.2350 - val_accuracy30: 0.3969 - 97s/epoch - 14ms/step
Epoch 50/50
6697/6697 - 96s - loss: 2.8191 - accuracy30: 0.5243 - val_loss: 3.2274 - val_accuracy30: 0.3990 - 96s/epoch - 14ms/step
testing model in sample: results/universal/W9/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 83s - 83s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1105789
{'0': {'precision': 0.3549019111708667, 'recall': 0.5118114937838826, 'f1-score': 0.4191532662693721, 'support': 1205817}, '1': {'precision': 0.5446372490724999, 'recall': 0.20568331808195262, 'f1-score': 0.2985998290440009, 'support': 1897096}, '2': {'precision': 0.35261998596339683, 'recall': 0.5421464636613176, 'f1-score': 0.4273107881649805, 'support': 1204763}, 'accuracy': 0.38547699502005256, 'macro avg': {'precision': 0.41738638206892115, 'recall': 0.4198804251757176, 'f1-score': 0.3816879611594512, 'support': 4307676}, 'weighted avg': {'precision': 0.43782295062070226, 'recall': 0.38547699502005256, 'f1-score': 0.3683431396500572, 'support': 4307676}}
[[617151 160136 428530]
 [736283 390201 770612]
 [385500 166105 653158]]
Evaluating performance on  train set...
6697/6697 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0966305
{'0': {'precision': 0.35347036383305813, 'recall': 0.5083524402227317, 'f1-score': 0.41699412258606217, 'support': 464056}, '1': {'precision': 0.5771268757328919, 'recall': 0.23639875578250338, 'f1-score': 0.33540940830041255, 'support': 778642}, '2': {'precision': 0.3590783096021098, 'recall': 0.5543972959955528, 'f1-score': 0.43585628926306386, 'support': 471301}, 'accuracy': 0.39746931007544345, 'macro avg': {'precision': 0.4298918497226866, 'recall': 0.43304949733359593, 'f1-score': 0.3960866067165128, 'support': 1713999}, 'weighted avg': {'precision': 0.4566159223704961, 'recall': 0.39746931007544345, 'f1-score': 0.38511806718359737, 'support': 1713999}}
[[235904  66351 161801]
 [289998 184070 304574]
 [141492  68521 261288]]
Evaluating performance on  val set...
2631/2631 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1019982
{'0': {'precision': 0.3527743307924127, 'recall': 0.515610830418448, 'f1-score': 0.4189253197200148, 'support': 185256}, '1': {'precision': 0.5711871900956953, 'recall': 0.23639631396640742, 'f1-score': 0.3343964943421344, 'support': 306020}, '2': {'precision': 0.35554103360017425, 'recall': 0.5393057949545402, 'f1-score': 0.42855454955211214, 'support': 181589}, 'accuracy': 0.3950183171958714, 'macro avg': {'precision': 0.4265008514960941, 'recall': 0.4304376464464652, 'f1-score': 0.3939587878714204, 'support': 672865}, 'weighted avg': {'precision': 0.4528554852589835, 'recall': 0.3950183171958714, 'f1-score': 0.3830801666415247, 'support': 672865}}
[[ 95520  27295  62441]
 [118606  72342 115072]
 [ 56642  27015  97932]]
testing model out of sample: results/universal/W9/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 45s - 45s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1225362
{'0': {'precision': 0.3048779108434716, 'recall': 0.5617135759864295, 'f1-score': 0.39523596560041646, 'support': 479862}, '1': {'precision': 0.6975321159520212, 'recall': 0.21823958277983405, 'f1-score': 0.33246084842261053, 'support': 1260917}, '2': {'precision': 0.29141647652215685, 'recall': 0.577692943729661, 'f1-score': 0.3874063224964988, 'support': 470461}, 'accuracy': 0.3692539027875762, 'macro avg': {'precision': 0.43127550110588314, 'recall': 0.45254870083197485, 'f1-score': 0.3717010455065086, 'support': 2211240}, 'weighted avg': {'precision': 0.525917364946426, 'recall': 0.3692539027875762, 'f1-score': 0.3577738383999318, 'support': 2211240}}
[[269545  60112 150205]
 [475098 275182 510637]
 [139465  59214 271782]]
Evaluating performance on  train set...
3947/3947 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.112728
{'0': {'precision': 0.30861184329167524, 'recall': 0.5447477434265033, 'f1-score': 0.394008827801108, 'support': 229330}, '1': {'precision': 0.6662127349956737, 'recall': 0.24623371243024805, 'f1-score': 0.35956967221270686, 'support': 550343}, '2': {'precision': 0.31009335688640954, 'recall': 0.5413634564442956, 'f1-score': 0.3943199675571551, 'support': 229901}, 'accuracy': 0.3812499133297807, 'macro avg': {'precision': 0.42830597839125284, 'recall': 0.4441149707670157, 'f1-score': 0.38263282252365666, 'support': 1009574}, 'weighted avg': {'precision': 0.5038860371595806, 'recall': 0.3812499133297807, 'f1-score': 0.37530607113053954, 'support': 1009574}}
[[124927  32619  71784]
 [209711 135513 205119]
 [ 70165  35276 124460]]
Evaluating performance on  val set...
1402/1402 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.127285
{'0': {'precision': 0.3069810697702629, 'recall': 0.553722725338844, 'f1-score': 0.3949846522033193, 'support': 82265}, '1': {'precision': 0.6535294977346909, 'recall': 0.20835274749169075, 'f1-score': 0.31597046388656624, 'support': 193158}, '2': {'precision': 0.3094899273637142, 'recall': 0.554094520514864, 'f1-score': 0.39715090592017865, 'support': 82818}, 'accuracy': 0.3675905326302685, 'macro avg': {'precision': 0.423333498289556, 'recall': 0.4387233311151329, 'f1-score': 0.36936867400335477, 'support': 358241}, 'weighted avg': {'precision': 0.4944146126001664, 'recall': 0.3675905326302685, 'f1-score': 0.35288221896266697, 'support': 358241}}
[[45552 10420 26293]
 [76822 40245 76091]
 [26013 10916 45889]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1157125
{'0': {'precision': 0.3783315347133654, 'recall': 0.45885059294808234, 'f1-score': 0.4147189561227416, 'support': 25213}, '1': {'precision': 0.40199917559769166, 'recall': 0.17287835142920452, 'f1-score': 0.24178003656760355, 'support': 22565}, '2': {'precision': 0.41040841337247413, 'recall': 0.5218904030153668, 'f1-score': 0.45948403771598145, 'support': 27592}, 'accuracy': 0.3963115297863872, 'macro avg': {'precision': 0.3969130412278437, 'recall': 0.3845397824642179, 'f1-score': 0.3719943434687756, 'support': 75370}, 'weighted avg': {'precision': 0.39716032007248636, 'recall': 0.3963115297863872, 'f1-score': 0.37933075672721267, 'support': 75370}}
[[11569  2882 10762]
 [ 8739  3901  9925]
 [10271  2921 14400]]
Evaluating performance on  train set...
200/200 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1339927
{'0': {'precision': 0.3686147290950467, 'recall': 0.4346808267671577, 'f1-score': 0.39893101370293715, 'support': 17514}, '1': {'precision': 0.35271790700826894, 'recall': 0.15752512410703476, 'f1-score': 0.21778614772965058, 'support': 16518}, '2': {'precision': 0.37189867936782856, 'recall': 0.5024863979406775, 'f1-score': 0.42744102717229027, 'support': 17093}, 'accuracy': 0.3678044009779951, 'macro avg': {'precision': 0.3644104384903814, 'recall': 0.3648974496049567, 'f1-score': 0.3480527295349593, 'support': 51125}, 'weighted avg': {'precision': 0.36457656488542844, 'recall': 0.3678044009779951, 'f1-score': 0.34993679881951234, 'support': 51125}}
[[7613 2398 7503]
 [6913 2602 7003]
 [6127 2377 8589]]
Evaluating performance on  val set...
53/53 - 0s - 497ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1301849
{'0': {'precision': 0.37115741695894366, 'recall': 0.40637000225886605, 'f1-score': 0.38796635755876646, 'support': 4427}, '1': {'precision': 0.4299812030075188, 'recall': 0.19451530612244897, 'f1-score': 0.26785714285714285, 'support': 4704}, '2': {'precision': 0.35326671790930053, 'recall': 0.5283973327201655, 'f1-score': 0.42343836373687116, 'support': 4349}, 'accuracy': 0.3718100890207715, 'macro avg': {'precision': 0.384801779291921, 'recall': 0.3764275470338269, 'f1-score': 0.35975395471759347, 'support': 13480}, 'weighted avg': {'precision': 0.38591264243413653, 'recall': 0.3718100890207715, 'f1-score': 0.3574970703860766, 'support': 13480}}
[[1799  612 2016]
 [1598  915 2191]
 [1450  601 2298]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
1118/1118 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850937
{'0': {'precision': 0.18591557007537735, 'recall': 0.6860982016569004, 'f1-score': 0.2925557885062753, 'support': 29694}, '1': {'precision': 0.8668795588183307, 'recall': 0.3261728362219178, 'f1-score': 0.4739985696152781, 'support': 225543}, '2': {'precision': 0.2077027085968509, 'recall': 0.6161211023418295, 'f1-score': 0.3106732776617954, 'support': 30916}, 'accuracy': 0.39484821057266567, 'macro avg': {'precision': 0.4201659458301863, 'recall': 0.5427973800735493, 'f1-score': 0.3590758785944496, 'support': 286153}, 'weighted avg': {'precision': 0.7249986203582043, 'recall': 0.39484821057266567, 'f1-score': 0.43752463200747876, 'support': 286153}}
[[20373  4492  4829]
 [84146 73566 67831]
 [ 5063  6805 19048]]
Evaluating performance on  train set...
505/505 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1057143
{'0': {'precision': 0.21304364892447794, 'recall': 0.7008199367292918, 'f1-score': 0.3267560692945621, 'support': 15489}, '1': {'precision': 0.8819623887453345, 'recall': 0.24980940279542566, 'f1-score': 0.3893408534604995, 'support': 98375}, '2': {'precision': 0.21432114442173766, 'recall': 0.703575848368397, 'f1-score': 0.3285579584511969, 'support': 15353}, 'accuracy': 0.3577857402663736, 'macro avg': {'precision': 0.4364423940305167, 'recall': 0.5514017292977048, 'f1-score': 0.34821829373541946, 'support': 129217}, 'weighted avg': {'precision': 0.722454132206447, 'recall': 0.3577857402663736, 'f1-score': 0.3746169741797235, 'support': 129217}}
[[10855  1410  3224]
 [37425 24575 36375]
 [ 2672  1879 10802]]
Evaluating performance on  val set...
187/187 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0852429
{'0': {'precision': 0.21594250245017968, 'recall': 0.6959115634321811, 'f1-score': 0.3296073135258674, 'support': 5699}, '1': {'precision': 0.8750833333333333, 'recall': 0.28900509150956377, 'f1-score': 0.4345091548567291, 'support': 36335}, '2': {'precision': 0.22774433935224994, 'recall': 0.6877271940453522, 'f1-score': 0.34217552321074846, 'support': 5777}, 'accuracy': 0.3856853025454393, 'macro avg': {'precision': 0.43959005837858767, 'recall': 0.5575479496623656, 'f1-score': 0.36876399719778163, 'support': 47811}, 'weighted avg': {'precision': 0.7182967996186691, 'recall': 0.3856853025454393, 'f1-score': 0.4108483449225422, 'support': 47811}}
[[ 3966   654  1079]
 [13441 10501 12393]
 [  959   845  3973]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0993001
{'0': {'precision': 0.38894251187212847, 'recall': 0.5061802833886042, 'f1-score': 0.4398838504028121, 'support': 39804}, '1': {'precision': 0.4823719736695303, 'recall': 0.17532796690930472, 'f1-score': 0.2571789724143059, 'support': 49319}, '2': {'precision': 0.3674721838774594, 'recall': 0.5424481979770205, 'f1-score': 0.43813640825310585, 'support': 40732}, 'accuracy': 0.39189865619344655, 'macro avg': {'precision': 0.4129288898063727, 'recall': 0.4079854827583098, 'f1-score': 0.3783997436900746, 'support': 129855}, 'weighted avg': {'precision': 0.41769241157954984, 'recall': 0.39189865619344655, 'f1-score': 0.3699443125247406, 'support': 129855}}
[[20148  4667 14989]
 [17629  8647 23043]
 [14025  4612 22095]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1178613
{'0': {'precision': 0.39023456532331036, 'recall': 0.49897650409398364, 'f1-score': 0.43795648947388977, 'support': 22472}, '1': {'precision': 0.3765955164646573, 'recall': 0.15708469419712764, 'f1-score': 0.22169602828818588, 'support': 22351}, '2': {'precision': 0.38554342173686945, 'recall': 0.5036912903664115, 'f1-score': 0.4367685177912183, 'support': 22079}, 'accuracy': 0.3863113210367403, 'macro avg': {'precision': 0.3841245011749457, 'recall': 0.3865841628858409, 'f1-score': 0.36547367851776463, 'support': 66902}, 'weighted avg': {'precision': 0.38412978310028584, 'recall': 0.3863113210367403, 'f1-score': 0.36531491232009206, 'support': 66902}}
[[11213  2868  8391]
 [ 9507  3511  9333]
 [ 8014  2944 11121]]
Evaluating performance on  val set...
73/73 - 1s - 568ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1222291
{'0': {'precision': 0.39145597210113336, 'recall': 0.48578052550231837, 'f1-score': 0.4335471411821505, 'support': 6470}, '1': {'precision': 0.3052681091251176, 'recall': 0.1162041181736795, 'f1-score': 0.16833095577746077, 'support': 5585}, '2': {'precision': 0.40327135796658037, 'recall': 0.5193998181267051, 'f1-score': 0.4540275569687334, 'support': 6598}, 'accuracy': 0.3870154934863025, 'macro avg': {'precision': 0.36666514639761044, 'recall': 0.373794820600901, 'f1-score': 0.3519685513094482, 'support': 18653}, 'weighted avg': {'precision': 0.3698293544642477, 'recall': 0.3870154934863025, 'f1-score': 0.36138166580953923, 'support': 18653}}
[[3143  765 2562]
 [2427  649 2509]
 [2459  712 3427]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1165591
{'0': {'precision': 0.38215321783381684, 'recall': 0.4803911581949679, 'f1-score': 0.42567787124959383, 'support': 49085}, '1': {'precision': 0.44419681124635696, 'recall': 0.21748254096159012, 'f1-score': 0.29199959428848343, 'support': 59568}, '2': {'precision': 0.34551463644948066, 'recall': 0.47981641350672055, 'f1-score': 0.40173841438309166, 'support': 45755}, 'accuracy': 0.37879514014817883, 'macro avg': {'precision': 0.39062155517655145, 'recall': 0.39256337088775956, 'f1-score': 0.3731386266403896, 'support': 154408}, 'weighted avg': {'precision': 0.395231649528793, 'recall': 0.37879514014817883, 'f1-score': 0.3670131812662625, 'support': 154408}}
[[23580  8281 17224]
 [22251 12955 24362]
 [15872  7929 21954]]
Evaluating performance on  train set...
323/323 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1117138
{'0': {'precision': 0.4065696908545643, 'recall': 0.4987622060239307, 'f1-score': 0.4479718357704245, 'support': 29084}, '1': {'precision': 0.3504414283831862, 'recall': 0.19369287352973308, 'f1-score': 0.2494899036093717, 'support': 27461}, '2': {'precision': 0.38007426521492854, 'recall': 0.4629359908010732, 'f1-score': 0.4174327780465888, 'support': 26090}, 'accuracy': 0.3860712773038059, 'macro avg': {'precision': 0.3790284614842263, 'recall': 0.3851303567849123, 'f1-score': 0.37163150580879495, 'support': 82635}, 'weighted avg': {'precision': 0.37955203646278585, 'recall': 0.3860712773038059, 'f1-score': 0.3723709843746534, 'support': 82635}}
[[14506  5154  9424]
 [11866  5319 10276]
 [ 9307  4705 12078]]
Evaluating performance on  val set...
112/112 - 1s - 764ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1101723
{'0': {'precision': 0.4361763022323984, 'recall': 0.5053529133112269, 'f1-score': 0.46822331460674155, 'support': 10555}, '1': {'precision': 0.311696556102206, 'recall': 0.246084450570104, 'f1-score': 0.27503150819212996, 'support': 7981}, '2': {'precision': 0.4176678445229682, 'recall': 0.4179210021214264, 'f1-score': 0.41779438497273275, 'support': 9899}, 'accuracy': 0.40214524353789344, 'macro avg': {'precision': 0.38851356761919087, 'recall': 0.3897861220009191, 'f1-score': 0.38701640259053477, 'support': 28435}, 'weighted avg': {'precision': 0.3947946220238274, 'recall': 0.40214524353789344, 'f1-score': 0.3964434735150563, 'support': 28435}}
[[5334 2087 3134]
 [3383 1964 2634]
 [3512 2250 4137]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1321295
{'0': {'precision': 0.42566905116380405, 'recall': 0.3897820412641939, 'f1-score': 0.4069358744044364, 'support': 60149}, '1': {'precision': 0.2799963695770557, 'recall': 0.21032656864304705, 'f1-score': 0.24021179127139647, 'support': 44003}, '2': {'precision': 0.39705078445306946, 'recall': 0.5083461646136618, 'f1-score': 0.4458580154077529, 'support': 57152}, 'accuracy': 0.38283613549570994, 'macro avg': {'precision': 0.3675720683979764, 'recall': 0.36948492484030093, 'f1-score': 0.3643352270278619, 'support': 161304}, 'weighted avg': {'precision': 0.37579039851468443, 'recall': 0.38283613549570994, 'f1-score': 0.37524489570904374, 'support': 161304}}
[[23445 12434 24270]
 [14899  9255 19849]
 [16734 11365 29053]]
Evaluating performance on  train set...
477/477 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.122215
{'0': {'precision': 0.3858901318251757, 'recall': 0.454476442354785, 'f1-score': 0.4173844596873946, 'support': 40836}, '1': {'precision': 0.34614576033637, 'recall': 0.24892282107491118, 'f1-score': 0.2895920969704076, 'support': 39687}, '2': {'precision': 0.400048568337859, 'recall': 0.43762074961360126, 'f1-score': 0.41799204198143125, 'support': 41408}, 'accuracy': 0.3818471102508796, 'macro avg': {'precision': 0.3773614868331349, 'recall': 0.3803400043477658, 'f1-score': 0.3749895328797445, 'support': 121931}, 'weighted avg': {'precision': 0.37776207306932985, 'recall': 0.3818471102508796, 'f1-score': 0.3759959962817177, 'support': 121931}}
[[18559  9217 13060]
 [15692  9879 14116]
 [13843  9444 18121]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1198996
{'0': {'precision': 0.3766339041442902, 'recall': 0.4846153846153846, 'f1-score': 0.42385540794800164, 'support': 15340}, '1': {'precision': 0.3765874152582832, 'recall': 0.2399464622498023, 'f1-score': 0.293125232255667, 'support': 16437}, '2': {'precision': 0.3940230436869899, 'recall': 0.43489203868061993, 'f1-score': 0.4134500346325798, 'support': 15098}, 'accuracy': 0.38280533333333333, 'macro avg': {'precision': 0.38241478769652115, 'recall': 0.38648462851526894, 'f1-score': 0.37681022494541616, 'support': 46875}, 'weighted avg': {'precision': 0.3822184820855463, 'recall': 0.38280533333333333, 'f1-score': 0.3746626138323506, 'support': 46875}}
[[7434 3247 4659]
 [7054 3944 5439]
 [5250 3282 6566]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/EXC
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1272027
{'0': {'precision': 0.23178555000657117, 'recall': 0.7349811817104458, 'f1-score': 0.3524283818593396, 'support': 76787}, '1': {'precision': 0.8898277437035104, 'recall': 0.2422221383485823, 'f1-score': 0.38078883670930036, 'support': 450413}, '2': {'precision': 0.2218577801102073, 'recall': 0.6972917608874937, 'f1-score': 0.3366146535670712, 'support': 75178}, 'accuracy': 0.3618292832739575, 'macro avg': {'precision': 0.44782369127342964, 'recall': 0.558165026982174, 'f1-score': 0.3566106240452371, 'support': 602378}, 'weighted avg': {'precision': 0.7225810450351922, 'recall': 0.3618292832739575, 'f1-score': 0.3716606132568661, 'support': 602378}}
[[ 56437   4948  15402]
 [172854 109100 168459]
 [ 14197   8560  52421]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0948726
{'0': {'precision': 0.2301278755943966, 'recall': 0.7342012198247143, 'f1-score': 0.35042013723259824, 'support': 39022}, '1': {'precision': 0.891065739749526, 'recall': 0.28715418634036044, 'f1-score': 0.4343387033398821, 'support': 240592}, '2': {'precision': 0.24512839654894508, 'recall': 0.7171398788841458, 'f1-score': 0.36536868792241206, 'support': 40292}, 'accuracy': 0.3958412783755228, 'macro avg': {'precision': 0.4554406706309559, 'recall': 0.5794984283497402, 'f1-score': 0.3833758428316308, 'support': 319906}, 'weighted avg': {'precision': 0.7290893317818753, 'recall': 0.3958412783755228, 'f1-score': 0.4154156129700886, 'support': 319906}}
[[28650  3550  6822]
 [89345 69087 82160]
 [ 6501  4896 28895]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1116288
{'0': {'precision': 0.21627861475249463, 'recall': 0.7056945863125639, 'f1-score': 0.3310869500104831, 'support': 15664}, '1': {'precision': 0.8853880814445912, 'recall': 0.27466106148187075, 'f1-score': 0.4192609110670827, 'support': 95150}, '2': {'precision': 0.2394981735954079, 'recall': 0.6969313508383423, 'f1-score': 0.3564897972393482, 'support': 15805}, 'accuracy': 0.38069326088501726, 'macro avg': {'precision': 0.4470549565974979, 'recall': 0.5590956662109257, 'f1-score': 0.368945886105638, 'support': 126619}, 'weighted avg': {'precision': 0.721990639671861, 'recall': 0.38069326088501726, 'f1-score': 0.40051763888804226, 'support': 126619}}
[[11054  1386  3224]
 [37263 26134 31753]
 [ 2793  1997 11015]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/AAL
Evaluating performance on  test set...
3870/3870 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1484027
{'0': {'precision': 0.2397732237435456, 'recall': 0.677811001328942, 'f1-score': 0.35423653641090486, 'support': 138456}, '1': {'precision': 0.8654911514271325, 'recall': 0.2052062086843271, 'f1-score': 0.33175417153490716, 'support': 720217}, '2': {'precision': 0.20765495306079113, 'recall': 0.6740367062815764, 'f1-score': 0.3174966194157922, 'support': 132021}, 'accuracy': 0.3337327166612496, 'macro avg': {'precision': 0.43763977607715643, 'recall': 0.5190179720982818, 'f1-score': 0.3344957757872014, 'support': 990694}, 'weighted avg': {'precision': 0.6903789632642069, 'recall': 0.3337327166612496, 'f1-score': 0.3329962523620379, 'support': 990694}}
[[ 93847  10944  33665]
 [266543 147793 305881]
 [ 31009  12025  88987]]
Evaluating performance on  train set...
1577/1577 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1505843
{'0': {'precision': 0.2019699300656439, 'recall': 0.6737134795853693, 'f1-score': 0.3107741059302852, 'support': 48911}, '1': {'precision': 0.8810726922838165, 'recall': 0.23103318053963953, 'f1-score': 0.3660749059226799, 'support': 307168}, '2': {'precision': 0.19835181338072236, 'recall': 0.6683181885264912, 'f1-score': 0.3059114179972303, 'support': 47431}, 'accuracy': 0.3360932814552304, 'macro avg': {'precision': 0.4271314785767275, 'recall': 0.5243549495505, 'f1-score': 0.3275868099500651, 'support': 403510}, 'weighted avg': {'precision': 0.7185049016216132, 'recall': 0.3360932814552304, 'f1-score': 0.3522997037610977, 'support': 403510}}
[[ 32952   4426  11533]
 [119622  70966 116580]
 [ 10579   5153  31699]]
Evaluating performance on  val set...
600/600 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1708567
{'0': {'precision': 0.19970082273747194, 'recall': 0.712485096235735, 'f1-score': 0.31196241237010885, 'support': 17613}, '1': {'precision': 0.888248934101279, 'recall': 0.20146411393962013, 'f1-score': 0.32843560933448573, 'support': 117887}, '2': {'precision': 0.19458926306890234, 'recall': 0.6924233983286908, 'f1-score': 0.30380210943133346, 'support': 17950}, 'accuracy': 0.31754969045291626, 'macro avg': {'precision': 0.4275130066358845, 'recall': 0.5354575361680153, 'f1-score': 0.31473337704530935, 'support': 153450}, 'weighted avg': {'precision': 0.7280756595461673, 'recall': 0.31754969045291626, 'f1-score': 0.3236632812706528, 'support': 153450}}
[[12549  1270  3794]
 [46487 23750 47650]
 [ 3803  1718 12429]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/WBA
Evaluating performance on  test set...
2451/2451 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0961931
{'0': {'precision': 0.39553315854039883, 'recall': 0.5108369232043741, 'f1-score': 0.44585086335844404, 'support': 193136}, '1': {'precision': 0.5449248733787034, 'recall': 0.18023492911345845, 'f1-score': 0.27087683456263423, 'support': 250118}, '2': {'precision': 0.36980472402531406, 'recall': 0.5929716486584856, 'f1-score': 0.455523677374258, 'support': 184083}, 'accuracy': 0.4031278244388582, 'macro avg': {'precision': 0.43675425198147205, 'recall': 0.4280145003254394, 'f1-score': 0.39075045843177875, 'support': 627337}, 'weighted avg': {'precision': 0.4475456964922281, 'recall': 0.4031278244388582, 'f1-score': 0.37892741788674816, 'support': 627337}}
[[ 98661  19715  74760]
 [ 93782  45080 111256]
 [ 56995  17932 109156]]
Evaluating performance on  train set...
1200/1200 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0526462
{'0': {'precision': 0.40777147762068655, 'recall': 0.5371910710984984, 'f1-score': 0.4636187902332827, 'support': 91971}, '1': {'precision': 0.5739998707425839, 'recall': 0.287039356209652, 'f1-score': 0.3827016196359993, 'support': 123767}, '2': {'precision': 0.40425686298222274, 'recall': 0.5488998357963876, 'f1-score': 0.4656034542795459, 'support': 91350}, 'accuracy': 0.43985437399051736, 'macro avg': {'precision': 0.46200940378183103, 'recall': 0.4577100877015126, 'f1-score': 0.437307954716276, 'support': 307088}, 'weighted avg': {'precision': 0.47372172472996527, 'recall': 0.43985437399051736, 'f1-score': 0.43159677572054417, 'support': 307088}}
[[49406 13198 29367]
 [43715 35526 44526]
 [28040 13168 50142]]
Evaluating performance on  val set...
441/441 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0548674
{'0': {'precision': 0.41440598690364827, 'recall': 0.5246844036167201, 'f1-score': 0.4630701374193713, 'support': 34617}, '1': {'precision': 0.5687379989377783, 'recall': 0.3085601560422023, 'f1-score': 0.4000689724541261, 'support': 45116}, '2': {'precision': 0.3960115242639777, 'recall': 0.5331353595345596, 'f1-score': 0.4544550491417944, 'support': 33001}, 'accuracy': 0.4406656376958149, 'macro avg': {'precision': 0.4597185033684681, 'recall': 0.455459973064494, 'f1-score': 0.43919805300509723, 'support': 112734}, 'weighted avg': {'precision': 0.47078478472294005, 'recall': 0.4406656376958149, 'f1-score': 0.43533522970013566, 'support': 112734}}
[[18163  5303 11151]
 [15512 13921 15683]
 [10154  5253 17594]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
3337/3337 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0945834
{'0': {'precision': 0.33988251461527197, 'recall': 0.5581529781724011, 'f1-score': 0.4224920713820649, 'support': 216240}, '1': {'precision': 0.6486483172177837, 'recall': 0.249027219035199, 'f1-score': 0.35988746500290864, 'support': 424813}, '2': {'precision': 0.34922695761964884, 'recall': 0.5506846227531413, 'f1-score': 0.42740624658333026, 'support': 212964}, 'accuracy': 0.40252243222324613, 'macro avg': {'precision': 0.44591926315090147, 'recall': 0.4526216066535804, 'f1-score': 0.4032619276561012, 'support': 854017}, 'weighted avg': {'precision': 0.4958018427562398, 'recall': 0.40252243222324613, 'f1-score': 0.3925761467082162, 'support': 854017}}
[[120695  29199  66346]
 [166829 105790 152194]
 [ 67584  28104 117276]]
Evaluating performance on  train set...
1431/1431 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0642915
{'0': {'precision': 0.3767280146568954, 'recall': 0.5450465375463116, 'f1-score': 0.4455195676527434, 'support': 99597}, '1': {'precision': 0.6224697137272049, 'recall': 0.29402438357662236, 'f1-score': 0.3993943319704427, 'support': 164619}, '2': {'precision': 0.3791559215816765, 'recall': 0.5367945823927766, 'f1-score': 0.44441013723785455, 'support': 101890}, 'accuracy': 0.42987823198745717, 'macro avg': {'precision': 0.45945121665525895, 'recall': 0.45862183450523686, 'f1-score': 0.42977467895368027, 'support': 366106}, 'weighted avg': {'precision': 0.48790109621202216, 'recall': 0.42987823198745717, 'f1-score': 0.424470663680239, 'support': 366106}}
[[54285 13999 31313]
 [57972 48402 58245]
 [31839 15357 54694]]
Evaluating performance on  val set...
492/492 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768585
{'0': {'precision': 0.38979553554680174, 'recall': 0.5409345307822465, 'f1-score': 0.45309348596347776, 'support': 38415}, '1': {'precision': 0.5472908145230521, 'recall': 0.2232567720671542, 'f1-score': 0.3171416866623749, 'support': 48545}, '2': {'precision': 0.40167078033035886, 'recall': 0.5449347036550498, 'f1-score': 0.46246160908484807, 'support': 38823}, 'accuracy': 0.4195638520308786, 'macro avg': {'precision': 0.44625237680007085, 'recall': 0.4363753355014835, 'f1-score': 0.4108989272369003, 'support': 125783}, 'weighted avg': {'precision': 0.454244951971391, 'recall': 0.4195638520308786, 'f1-score': 0.4035153915220105, 'support': 125783}}
[[20780  4418 13217]
 [19410 10838 18297]
 [13120  4547 21156]]
testing model on single stock: results/universal/W9/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
10303/10303 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.112734
{'0': {'precision': 0.3891286305509654, 'recall': 0.48794269147080616, 'f1-score': 0.4329692843717761, 'support': 857115}, '1': {'precision': 0.37649713416538233, 'recall': 0.16402802555038434, 'f1-score': 0.22850400368042087, 'support': 911454}, '2': {'precision': 0.3864757966264564, 'recall': 0.5184587106123055, 'f1-score': 0.44284252970574195, 'support': 868831}, 'accuracy': 0.38605444756199286, 'macro avg': {'precision': 0.38403385378093474, 'recall': 0.3901431425444987, 'f1-score': 0.36810527258597964, 'support': 2637400}, 'weighted avg': {'precision': 0.38388942062524684, 'recall': 0.38605444756199286, 'f1-score': 0.3655610352133232, 'support': 2637400}}
[[418223 122611 316281]
 [363144 149504 398806]
 [293401 124977 450453]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.110369
{'0': {'precision': 0.3955332293254502, 'recall': 0.4596173177579812, 'f1-score': 0.42517407622959624, 'support': 288490}, '1': {'precision': 0.36141385678933036, 'recall': 0.17163985064847267, 'f1-score': 0.23274585482119436, 'support': 288447}, '2': {'precision': 0.3946467792572003, 'recall': 0.5332275934222175, 'f1-score': 0.4535884566947776, 'support': 298216}, 'accuracy': 0.38978441483946236, 'macro avg': {'precision': 0.3838646217906603, 'recall': 0.3881615872762238, 'f1-score': 0.3705027959151894, 'support': 875153}, 'weighted avg': {'precision': 0.3839855522410097, 'recall': 0.38978441483946236, 'f1-score': 0.37143293577097386, 'support': 875153}}
[[132595  42965 112930]
 [107950  49509 130988]
 [ 94686  44513 159017]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1153487
{'0': {'precision': 0.3924095929532395, 'recall': 0.4803109812080424, 'f1-score': 0.43193352421639475, 'support': 118721}, '1': {'precision': 0.3658061644597752, 'recall': 0.16242856437029596, 'f1-score': 0.22496578467153286, 'support': 121438}, '2': {'precision': 0.3877389593049377, 'recall': 0.5232308914070039, 'f1-score': 0.4454088160037218, 'support': 117107}, 'accuracy': 0.3863283939697592, 'macro avg': {'precision': 0.3819849055726508, 'recall': 0.38865681232844745, 'f1-score': 0.36743604163054977, 'support': 357266}, 'weighted avg': {'precision': 0.3818358718489614, 'recall': 0.3863283939697592, 'f1-score': 0.3660003053836191, 'support': 357266}}
[[57023 17621 44077]
 [49035 19725 52678]
 [39257 16576 61274]]
training model: results/universal/W9/deepLOB_L2/h10
Epoch 1/50
6697/6697 - 281s - loss: 2.7959 - accuracy10: 0.5363 - val_loss: 3.4897 - val_accuracy10: 0.4323 - 281s/epoch - 42ms/step
Epoch 2/50
6697/6697 - 273s - loss: 2.7138 - accuracy10: 0.5561 - val_loss: 3.5455 - val_accuracy10: 0.4714 - 273s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 272s - loss: 2.6548 - accuracy10: 0.5710 - val_loss: 3.1784 - val_accuracy10: 0.4908 - 272s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 272s - loss: 2.6116 - accuracy10: 0.5802 - val_loss: 3.4830 - val_accuracy10: 0.4804 - 272s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 273s - loss: 2.5842 - accuracy10: 0.5859 - val_loss: 3.4386 - val_accuracy10: 0.4960 - 273s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 272s - loss: 2.5658 - accuracy10: 0.5893 - val_loss: 3.3680 - val_accuracy10: 0.5035 - 272s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 274s - loss: 2.5504 - accuracy10: 0.5920 - val_loss: 3.4186 - val_accuracy10: 0.5023 - 274s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 273s - loss: 2.5392 - accuracy10: 0.5941 - val_loss: 3.2941 - val_accuracy10: 0.5061 - 273s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 273s - loss: 2.5303 - accuracy10: 0.5956 - val_loss: 3.3805 - val_accuracy10: 0.5016 - 273s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 274s - loss: 2.5228 - accuracy10: 0.5969 - val_loss: 3.5217 - val_accuracy10: 0.5051 - 274s/epoch - 41ms/step
Epoch 11/50
6697/6697 - 276s - loss: 2.5160 - accuracy10: 0.5981 - val_loss: 3.4888 - val_accuracy10: 0.5061 - 276s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 274s - loss: 2.5106 - accuracy10: 0.5994 - val_loss: 3.4028 - val_accuracy10: 0.5068 - 274s/epoch - 41ms/step
Epoch 13/50
6697/6697 - 274s - loss: 2.5057 - accuracy10: 0.5999 - val_loss: 3.3458 - val_accuracy10: 0.5124 - 274s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 233s - 233s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.000335
{'0': {'precision': 0.3672412047437051, 'recall': 0.4167392157229062, 'f1-score': 0.3904276373507847, 'support': 1070540}, '1': {'precision': 0.5896504245968052, 'recall': 0.5402453644703735, 'f1-score': 0.5638677683884555, 'support': 2171219}, '2': {'precision': 0.38140899592774696, 'recall': 0.3948732429777745, 'f1-score': 0.38802435396494034, 'support': 1065937}, 'accuracy': 0.4735796119317612, 'macro avg': {'precision': 0.4461002084227524, 'recall': 0.45061927439035143, 'f1-score': 0.4474399199013935, 'support': 4307696}, 'weighted avg': {'precision': 0.4828485031119215, 'recall': 0.4735796119317612, 'f1-score': 0.477252417741282, 'support': 4307696}}
[[ 446136  406463  217941]
 [ 533513 1172991  464715]
 [ 235182  409845  420910]]
Evaluating performance on  train set...
6697/6697 - 93s - 93s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9773964
{'0': {'precision': 0.3754218637329881, 'recall': 0.33625611647594944, 'f1-score': 0.3547612865637804, 'support': 416498}, '1': {'precision': 0.5482669176809034, 'recall': 0.7086376830085165, 'f1-score': 0.6182213001726772, 'support': 877828}, '2': {'precision': 0.37320036247159105, 'recall': 0.1835069183828593, 'f1-score': 0.2460353970992269, 'support': 419679}, 'accuracy': 0.48957033380882786, 'macro avg': {'precision': 0.4322963812951608, 'recall': 0.409466905955775, 'f1-score': 0.40633932794522815, 'support': 1714005}, 'weighted avg': {'precision': 0.46340055142007697, 'recall': 0.48957033380882786, 'f1-score': 0.4630705413568973, 'support': 1714005}}
[[140050 247912  28536]
 [154955 622062 100811]
 [ 78042 264623  77014]]
Evaluating performance on  val set...
2631/2631 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9753359
{'0': {'precision': 0.36813186813186816, 'recall': 0.3499151857098561, 'f1-score': 0.3587924504776896, 'support': 164477}, '1': {'precision': 0.5532719452053562, 'recall': 0.7071966580163301, 'f1-score': 0.6208358853577991, 'support': 347578}, '2': {'precision': 0.37331321882828394, 'recall': 0.16772897713493312, 'f1-score': 0.2314623325581595, 'support': 160813}, 'accuracy': 0.4909313565216357, 'macro avg': {'precision': 0.4315723440551695, 'recall': 0.40828027362037306, 'f1-score': 0.4036968894645494, 'support': 672868}, 'weighted avg': {'precision': 0.46500650960477447, 'recall': 0.4909313565216357, 'f1-score': 0.4637226816014246, 'support': 672868}}
[[ 57553  96264  10660]
 [ 67152 245806  34620]
 [ 31633 102207  26973]]
testing model out of sample: results/universal/W9/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 120s - 120s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9114679
{'0': {'precision': 0.30075454788777717, 'recall': 0.5732103297767767, 'f1-score': 0.3945138254006294, 'support': 348933}, '1': {'precision': 0.7802269589328709, 'recall': 0.5408964610257982, 'f1-score': 0.6388835357970014, 'support': 1516965}, '2': {'precision': 0.28295813434374883, 'recall': 0.40521539717745436, 'f1-score': 0.33322697703656434, 'support': 345362}, 'accuracy': 0.5248044101552961, 'macro avg': {'precision': 0.45464654705479896, 'recall': 0.5064407293266765, 'f1-score': 0.45554144607806507, 'support': 2211260}, 'weighted avg': {'precision': 0.6269019303966762, 'recall': 0.5248044101552961, 'f1-score': 0.5525839524805396, 'support': 2211260}}
[[200012 104557  44364]
 [386172 820521 310272]
 [ 78850 126566 139946]]
Evaluating performance on  train set...
3947/3947 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86642647
{'0': {'precision': 0.3566025536158047, 'recall': 0.5156377604181334, 'f1-score': 0.42162174608839814, 'support': 177551}, '1': {'precision': 0.7681202021266111, 'recall': 0.6898487606799132, 'f1-score': 0.726883470098347, 'support': 655319}, '2': {'precision': 0.3863677861498947, 'recall': 0.3592423659370261, 'f1-score': 0.372311662414592, 'support': 176708}, 'accuracy': 0.6013443240641139, 'macro avg': {'precision': 0.5036968472974368, 'recall': 0.5215762956783575, 'f1-score': 0.506938959533779, 'support': 1009578}, 'weighted avg': {'precision': 0.6289292966857678, 'recall': 0.6013443240641139, 'f1-score': 0.6111368914765155, 'support': 1009578}}
[[ 91552  65171  20828]
 [123255 452071  79993]
 [ 41927  71300  63481]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89109534
{'0': {'precision': 0.3657316439686519, 'recall': 0.5064742126168955, 'f1-score': 0.42474754098360656, 'support': 63946}, '1': {'precision': 0.7589783513778814, 'recall': 0.6837176074958509, 'f1-score': 0.719384925636501, 'support': 229567}, '2': {'precision': 0.38129919694680764, 'recall': 0.3704367439632931, 'f1-score': 0.375789490181328, 'support': 64729}, 'accuracy': 0.5954745674711508, 'macro avg': {'precision': 0.5020030640977803, 'recall': 0.5202095213586798, 'f1-score': 0.5066406522671452, 'support': 358242}, 'weighted avg': {'precision': 0.6205430257065208, 'recall': 0.5954745674711508, 'f1-score': 0.6047097308224036, 'support': 358242}}
[[ 32387  23930   7629]
 [ 41330 156959  31278]
 [ 14837  25914  23978]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0908564
{'0': {'precision': 0.380654212003011, 'recall': 0.5204434880239521, 'f1-score': 0.43970594047666106, 'support': 21376}, '1': {'precision': 0.4565103444023063, 'recall': 0.4800440942839542, 'f1-score': 0.46798154118465135, 'support': 30843}, '2': {'precision': 0.43317535545023694, 'recall': 0.2565752537248974, 'f1-score': 0.3222674260916734, 'support': 23155}, 'accuracy': 0.4228513811128506, 'macro avg': {'precision': 0.4234466372851848, 'recall': 0.4190209453442679, 'f1-score': 0.4099849692509953, 'support': 75374}, 'weighted avg': {'precision': 0.42782907028454015, 'recall': 0.4228513811128506, 'f1-score': 0.41519902233581873, 'support': 75374}}
[[11125  7657  2594]
 [10857 14806  5180]
 [ 7244  9970  5941]]
Evaluating performance on  train set...
200/200 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0412669
{'0': {'precision': 0.4193243243243243, 'recall': 0.4220620239390642, 'f1-score': 0.4206887201735358, 'support': 14704}, '1': {'precision': 0.5183657884688813, 'recall': 0.6136322545651781, 'f1-score': 0.561990313366726, 'support': 22124}, '2': {'precision': 0.4287405069533485, 'recall': 0.3039647577092511, 'f1-score': 0.3557283142389525, 'support': 14301}, 'accuracy': 0.47192395704981516, 'macro avg': {'precision': 0.4554768732488514, 'recall': 0.44655301207116443, 'f1-score': 0.4461357825930714, 'support': 51129}, 'weighted avg': {'precision': 0.46481424551409634, 'recall': 0.47192395704981516, 'f1-score': 0.4636615473857963, 'support': 51129}}
[[ 6206  6251  2247]
 [ 5003 13576  3545]
 [ 3591  6363  4347]]
Evaluating performance on  val set...
53/53 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0442445
{'0': {'precision': 0.3670647391577624, 'recall': 0.48105436573311366, 'f1-score': 0.41639928698752227, 'support': 3642}, '1': {'precision': 0.5161395500489078, 'recall': 0.521753460777851, 'f1-score': 0.518931322733978, 'support': 6068}, '2': {'precision': 0.430625728721337, 'recall': 0.2938992042440318, 'f1-score': 0.3493615008670976, 'support': 3770}, 'accuracy': 0.4470326409495549, 'macro avg': {'precision': 0.4379433393093357, 'recall': 0.4322356769183322, 'f1-score': 0.4282307035295327, 'support': 13480}, 'weighted avg': {'precision': 0.45194685215050323, 'recall': 0.4470326409495549, 'f1-score': 0.4438052171978704, 'support': 13480}}
[[1752 1390  500]
 [1937 3166  965]
 [1084 1578 1108]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81139565
{'0': {'precision': 0.15990407052113043, 'recall': 0.5594738632498015, 'f1-score': 0.24872085696282295, 'support': 17638}, '1': {'precision': 0.9275239006865909, 'recall': 0.627256671115409, 'f1-score': 0.7483957091775923, 'support': 250258}, '2': {'precision': 0.17444704092168903, 'recall': 0.5273533760473139, 'f1-score': 0.26216922574322116, 'support': 18261}, 'accuracy': 0.6167034180537257, 'macro avg': {'precision': 0.42062500404313674, 'recall': 0.5713613034708415, 'f1-score': 0.4197619306278788, 'support': 286157}, 'weighted avg': {'precision': 0.8321524259345306, 'recall': 0.6167034180537257, 'f1-score': 0.6865686462109022, 'support': 286157}}
[[  9868   5899   1871]
 [ 49580 156976  43702]
 [  2264   6367   9630]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6799367
{'0': {'precision': 0.24913385826771653, 'recall': 0.5063480209111277, 'f1-score': 0.33395489568307357, 'support': 9373}, '1': {'precision': 0.9241529962822156, 'recall': 0.7954440677966101, 'f1-score': 0.8549817093610179, 'support': 110625}, '2': {'precision': 0.2834972238945749, 'recall': 0.459702787721011, 'f1-score': 0.3507116848725587, 'support': 9219}, 'accuracy': 0.7505204423566558, 'macro avg': {'precision': 0.48559469281483575, 'recall': 0.587164958809583, 'f1-score': 0.5132160966388833, 'support': 129217}, 'weighted avg': {'precision': 0.8294815525383462, 'recall': 0.7505204423566558, 'f1-score': 0.781210845772152, 'support': 129217}}
[[ 4746  3616  1011]
 [12929 87996  9700]
 [ 1375  3606  4238]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6741181
{'0': {'precision': 0.2346187445401223, 'recall': 0.5664356733956011, 'f1-score': 0.33180374161666076, 'support': 3319}, '1': {'precision': 0.9266147422039269, 'recall': 0.7632394194413953, 'f1-score': 0.8370295069687809, 'support': 40995}, '2': {'precision': 0.27316426321896237, 'recall': 0.4709917119176908, 'f1-score': 0.34578262694083095, 'support': 3499}, 'accuracy': 0.7281910777403635, 'macro avg': {'precision': 0.4781325833210039, 'recall': 0.6002222682515623, 'f1-score': 0.5048719585087574, 'support': 47813}, 'weighted avg': {'precision': 0.8307588464807019, 'recall': 0.7281910777403635, 'f1-score': 0.766008714539494, 'support': 47813}}
[[ 1880  1180   259]
 [ 5580 31289  4126]
 [  553  1298  1648]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0067819
{'0': {'precision': 0.48465299273873924, 'recall': 0.43916952840328205, 'f1-score': 0.4607915944659901, 'support': 38147}, '1': {'precision': 0.5156881844210278, 'recall': 0.667417962333346, 'f1-score': 0.5818236312774744, 'support': 52354}, '2': {'precision': 0.4995278564683664, 'recall': 0.3494588139641242, 'f1-score': 0.41123004245649697, 'support': 39358}, 'accuracy': 0.5040004928422366, 'macro avg': {'precision': 0.49995634454271115, 'recall': 0.485348768233584, 'f1-score': 0.48461508939998715, 'support': 129859}, 'weighted avg': {'precision': 0.5016734634955231, 'recall': 0.5040004928422366, 'f1-score': 0.4945656701268131, 'support': 129859}}
[[16753 16247  5147]
 [ 8779 34942  8633]
 [ 9035 16569 13754]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0752584
{'0': {'precision': 0.47266488036478166, 'recall': 0.451240856258134, 'f1-score': 0.4617044724033428, 'support': 22283}, '1': {'precision': 0.4223339592018585, 'recall': 0.5777787452653577, 'f1-score': 0.4879761729666127, 'support': 22969}, '2': {'precision': 0.5077432070955934, 'recall': 0.3331639722863741, 'f1-score': 0.4023315484158857, 'support': 21650}, 'accuracy': 0.45647364802248064, 'macro avg': {'precision': 0.4675806822207445, 'recall': 0.45406119126995526, 'f1-score': 0.4506707312619471, 'support': 66902}, 'weighted avg': {'precision': 0.46673672942057803, 'recall': 0.45647364802248064, 'f1-score': 0.4515106199909979, 'support': 66902}}
[[10055  9085  3143]
 [ 5848 13271  3850]
 [ 5370  9067  7213]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1000646
{'0': {'precision': 0.49072052401746724, 'recall': 0.5275047674930321, 'f1-score': 0.5084482149169317, 'support': 6817}, '1': {'precision': 0.34336158192090394, 'recall': 0.47694722385717087, 'f1-score': 0.3992773261065944, 'support': 5097}, '2': {'precision': 0.5367404616109279, 'recall': 0.3381305637982196, 'f1-score': 0.4148916803204078, 'support': 6740}, 'accuracy': 0.44526643079232336, 'macro avg': {'precision': 0.45694085584976635, 'recall': 0.4475275183828075, 'f1-score': 0.44087240711464465, 'support': 18654}, 'weighted avg': {'precision': 0.4670840841929653, 'recall': 0.44526643079232336, 'f1-score': 0.44481494251171777, 'support': 18654}}
[[3596 2246  975]
 [1674 2431  992]
 [2058 2403 2279]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1494261
{'0': {'precision': 0.3895779051589369, 'recall': 0.42821139453184665, 'f1-score': 0.4079821003037854, 'support': 52376}, '1': {'precision': 0.3443562523388415, 'recall': 0.3251022685013016, 'f1-score': 0.3344523830019224, 'support': 53780}, '2': {'precision': 0.36538670255486333, 'recall': 0.34882708885941643, 'f1-score': 0.3569149218128809, 'support': 48256}, 'accuracy': 0.36749086858534313, 'macro avg': {'precision': 0.36644028668421397, 'recall': 0.36738025063085494, 'f1-score': 0.3664498017061963, 'support': 154412}, 'weighted avg': {'precision': 0.36626759791904034, 'recall': 0.36749086858534313, 'f1-score': 0.3664132717039921, 'support': 154412}}
[[22428 17411 12537]
 [19597 17484 16699]
 [15545 15878 16833]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1692975
{'0': {'precision': 0.4126524965413156, 'recall': 0.446242774566474, 'f1-score': 0.4287907994903127, 'support': 29410}, '1': {'precision': 0.31333619635955207, 'recall': 0.36584895471727225, 'f1-score': 0.337562503336477, 'support': 25926}, '2': {'precision': 0.39455252918287936, 'recall': 0.2971537418953075, 'f1-score': 0.3389958001629787, 'support': 27299}, 'accuracy': 0.37176741090337023, 'macro avg': {'precision': 0.3735137406945823, 'recall': 0.3697484903930179, 'f1-score': 0.36844970099658947, 'support': 82635}, 'weighted avg': {'precision': 0.37551344641206824, 'recall': 0.37176741090337023, 'f1-score': 0.3705043773602076, 'support': 82635}}
[[13124 10578  5708]
 [ 9701  9485  6740]
 [ 8979 10208  8112]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.177022
{'0': {'precision': 0.43987462006079026, 'recall': 0.42497935211526106, 'f1-score': 0.4322987164527421, 'support': 10897}, '1': {'precision': 0.24713337356668677, 'recall': 0.3308645300296256, 'f1-score': 0.28293413173652693, 'support': 7426}, '2': {'precision': 0.41815214662314837, 'recall': 0.3293780282804311, 'f1-score': 0.36849383262348584, 'support': 10113}, 'accuracy': 0.3664017442678295, 'macro avg': {'precision': 0.3683867134168752, 'recall': 0.36174063680843926, 'f1-score': 0.36124222693758495, 'support': 28436}, 'weighted avg': {'precision': 0.3818152632475927, 'recall': 0.3664017442678295, 'f1-score': 0.37060086175208506, 'support': 28436}}
[[4631 3840 2426]
 [2760 2457 2209]
 [3137 3645 3331]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1128141
{'0': {'precision': 0.4884420519316023, 'recall': 0.4539880310016678, 'f1-score': 0.4705852443178929, 'support': 61158}, '1': {'precision': 0.29762613395557036, 'recall': 0.31278150335301774, 'f1-score': 0.30501567780583927, 'support': 39964}, '2': {'precision': 0.4644200752421356, 'recall': 0.48200578207556577, 'f1-score': 0.4730495470888945, 'support': 60186}, 'accuracy': 0.42945793141071736, 'macro avg': {'precision': 0.41682942037643606, 'recall': 0.4162584388100838, 'f1-score': 0.41621682307087554, 'support': 161308}, 'weighted avg': {'precision': 0.43220458054130306, 'recall': 0.42945793141071736, 'f1-score': 0.43048490441217085, 'support': 161308}}
[[27765 16013 17380]
 [11389 12500 16075]
 [17690 13486 29010]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0917425
{'0': {'precision': 0.4715467473071252, 'recall': 0.4547930677079567, 'f1-score': 0.46301840490797547, 'support': 41487}, '1': {'precision': 0.4072195331058996, 'recall': 0.5839010397992112, 'f1-score': 0.47981227573579704, 'support': 39046}, '2': {'precision': 0.49805252400601596, 'recall': 0.3119715928305715, 'f1-score': 0.38363855099585614, 'support': 41398}, 'accuracy': 0.44764661980956444, 'macro avg': {'precision': 0.4589396014730136, 'recall': 0.4502219001125798, 'f1-score': 0.4421564105465429, 'support': 121931}, 'weighted avg': {'precision': 0.4599464630322454, 'recall': 0.44764661980956444, 'f1-score': 0.44144527164481195, 'support': 121931}}
[[18868 16286  6333]
 [ 9564 22799  6683]
 [11581 16902 12915]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0761958
{'0': {'precision': 0.47525482832618027, 'recall': 0.4522654754307594, 'f1-score': 0.46347524687724806, 'support': 15670}, '1': {'precision': 0.43471147468494364, 'recall': 0.6213500189609404, 'f1-score': 0.5115383614746208, 'support': 15822}, '2': {'precision': 0.5136927685066325, 'recall': 0.3121627770915946, 'f1-score': 0.38833852250212286, 'support': 15383}, 'accuracy': 0.46336, 'macro avg': {'precision': 0.47455302383925213, 'recall': 0.4619260904944315, 'f1-score': 0.45445071028466394, 'support': 46875}, 'weighted avg': {'precision': 0.4741841913658443, 'recall': 0.46336, 'f1-score': 0.4550406093966525, 'support': 46875}}
[[7087 6316 2267]
 [3712 9831 2279]
 [4113 6468 4802]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84386575
{'0': {'precision': 0.19504363243642833, 'recall': 0.7423886043393199, 'f1-score': 0.3089250921597863, 'support': 45491}, '1': {'precision': 0.9393384925769022, 'recall': 0.5364307868660069, 'f1-score': 0.6828846402017134, 'support': 512959}, '2': {'precision': 0.19664842179406283, 'recall': 0.6100792133296914, 'f1-score': 0.2974265644246668, 'support': 43932}, 'accuracy': 0.5573556314763721, 'macro avg': {'precision': 0.4436768489357978, 'recall': 0.6296328681783394, 'f1-score': 0.42974543226205547, 'support': 602382}, 'weighted avg': {'precision': 0.8289657097376374, 'recall': 0.5573556314763721, 'f1-score': 0.6265321296934104, 'support': 602382}}
[[ 33772   7913   3806]
 [132106 275167 105686]
 [  7273   9857  26802]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7731851
{'0': {'precision': 0.2016772962386381, 'recall': 0.7194876158910736, 'f1-score': 0.3150452544151247, 'support': 22327}, '1': {'precision': 0.9436010159106181, 'recall': 0.6033535419738926, 'f1-score': 0.736059132775558, 'support': 274635}, '2': {'precision': 0.22267939179260313, 'recall': 0.6274133798213118, 'f1-score': 0.3286983126698176, 'support': 22945}, 'accuracy': 0.6131844567327379, 'macro avg': {'precision': 0.4559859013139531, 'recall': 0.6500848458954259, 'f1-score': 0.4599342332868334, 'support': 319907}, 'weighted avg': {'precision': 0.8401131974055397, 'recall': 0.6131844567327379, 'f1-score': 0.6774581303608573, 'support': 319907}}
[[ 16064   4381   1882]
 [ 60562 165702  48371]
 [  3026   5523  14396]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80195856
{'0': {'precision': 0.17662050802820492, 'recall': 0.6744160899653979, 'f1-score': 0.27993088126388543, 'support': 9248}, '1': {'precision': 0.9375757025193798, 'recall': 0.5726320267058748, 'f1-score': 0.7110093059837304, 'support': 108141}, '2': {'precision': 0.230857550083142, 'recall': 0.6317443120260021, 'f1-score': 0.3381466017165391, 'support': 9230}, 'accuracy': 0.5843751727623816, 'macro avg': {'precision': 0.4483512535435756, 'recall': 0.6262641428990916, 'f1-score': 0.4430289296547183, 'support': 126619}, 'weighted avg': {'precision': 0.8304802256506567, 'recall': 0.5843751727623816, 'f1-score': 0.6523440501201135, 'support': 126619}}
[[ 6237  1870  1141]
 [27930 61925 18286]
 [ 1146  2253  5831]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
3870/3870 - 52s - 52s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9342712
{'0': {'precision': 0.1889064072695023, 'recall': 0.6371384144242525, 'f1-score': 0.2914116174845885, 'support': 84247}, '1': {'precision': 0.9078704149298743, 'recall': 0.4456113574145408, 'f1-score': 0.5978024620939743, 'support': 825540}, '2': {'precision': 0.16573364614685202, 'recall': 0.6172708284411267, 'f1-score': 0.2613076894904542, 'support': 80911}, 'accuracy': 0.47591798913493316, 'macro avg': {'precision': 0.4208368227820762, 'recall': 0.56667353342664, 'f1-score': 0.38350725635633903, 'support': 990698}, 'weighted avg': {'precision': 0.78612030656954, 'recall': 0.47591798913493316, 'f1-score': 0.544265826275662, 'support': 990698}}
[[ 53677  18977  11593]
 [217856 367870 239814]
 [ 12613  18354  49944]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72316676
{'0': {'precision': 0.23012352419299803, 'recall': 0.574094252247344, 'f1-score': 0.32854929700973373, 'support': 29368}, '1': {'precision': 0.9260394253548064, 'recall': 0.7394825750914056, 'f1-score': 0.8223127868789182, 'support': 345712}, '2': {'precision': 0.2574982926964322, 'recall': 0.4907140344706296, 'f1-score': 0.337759808253338, 'support': 28430}, 'accuracy': 0.7099179698148744, 'macro avg': {'precision': 0.47122041408141224, 'recall': 0.6014302872697931, 'f1-score': 0.49620729738066327, 'support': 403510}, 'weighted avg': {'precision': 0.8282865008007739, 'recall': 0.7099179698148744, 'f1-score': 0.7522359923687364, 'support': 403510}}
[[ 16860  10159   2349]
 [ 52185 255648  37879]
 [  4220  10259  13951]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7621354
{'0': {'precision': 0.22053515868077161, 'recall': 0.5151162790697674, 'f1-score': 0.30884531590413944, 'support': 10320}, '1': {'precision': 0.9305215161014534, 'recall': 0.73925709024497, 'f1-score': 0.8239351322252877, 'support': 132506}, '2': {'precision': 0.24710280373831775, 'recall': 0.5599585843373494, 'f1-score': 0.34289172598633966, 'support': 10624}, 'accuracy': 0.7117693059628544, 'macro avg': {'precision': 0.4660531595068476, 'recall': 0.6047773178840289, 'f1-score': 0.4918907247052557, 'support': 153450}, 'weighted avg': {'precision': 0.8354566766832234, 'recall': 0.7117693059628544, 'f1-score': 0.7559890126272634, 'support': 153450}}
[[ 5316  3957  1047]
 [17471 97956 17079]
 [ 1318  3357  5949]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
2451/2451 - 34s - 34s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9007094
{'0': {'precision': 0.4332776666601938, 'recall': 0.3359860862232529, 'f1-score': 0.3784794666938069, 'support': 132818}, '1': {'precision': 0.6603356586981316, 'recall': 0.7852843446998584, 'f1-score': 0.7174101822108649, 'support': 367160}, '2': {'precision': 0.42971965387114797, 'recall': 0.29594152147798025, 'f1-score': 0.35049935836634494, 'support': 127363}, 'accuracy': 0.5908142461595847, 'macro avg': {'precision': 0.5077776597431578, 'recall': 0.4724039841336973, 'f1-score': 0.48212966909033894, 'support': 627341}, 'weighted avg': {'precision': 0.5654441489621603, 'recall': 0.5908142461595847, 'f1-score': 0.5711628254609407, 'support': 627341}}
[[ 44625  77049  11144]
 [ 39958 288325  38877]
 [ 18411  71260  37692]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8587884
{'0': {'precision': 0.43638252421502355, 'recall': 0.4609096107187563, 'f1-score': 0.4483108488970726, 'support': 64709}, '1': {'precision': 0.6998711291566239, 'recall': 0.7286833890997283, 'f1-score': 0.7139867044757564, 'support': 178124}, '2': {'precision': 0.45637936534744505, 'recall': 0.37846838575141223, 'f1-score': 0.4137884098410862, 'support': 64259}, 'accuracy': 0.5989768538418454, 'macro avg': {'precision': 0.5308776729063641, 'recall': 0.5226871285232989, 'f1-score': 0.5253619877379717, 'support': 307092}, 'weighted avg': {'precision': 0.5933993832701142, 'recall': 0.5989768538418454, 'f1-score': 0.5951882299027609, 'support': 307092}}
[[ 29825  27255   7629]
 [ 26988 129796  21340]
 [ 11533  28406  24320]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85389084
{'0': {'precision': 0.4325437693099897, 'recall': 0.4915452600992776, 'f1-score': 0.4601609429899127, 'support': 24779}, '1': {'precision': 0.6852817925254425, 'recall': 0.7475859495265196, 'f1-score': 0.7150793119603774, 'support': 64311}, '2': {'precision': 0.5029479087188735, 'recall': 0.3066739976315344, 'f1-score': 0.38101994167257813, 'support': 23644}, 'accuracy': 0.5988344243972538, 'macro avg': {'precision': 0.5402578235181019, 'recall': 0.5152684024191105, 'f1-score': 0.5187533988742895, 'support': 112734}, 'weighted avg': {'precision': 0.5914884575424008, 'recall': 0.5988344243972538, 'f1-score': 0.588984948096735, 'support': 112734}}
[[12180 10627  1972]
 [11039 48078  5194]
 [ 4940 11453  7251]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
3337/3337 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8165629
{'0': {'precision': 0.3495503050539711, 'recall': 0.6309989236484844, 'f1-score': 0.4498822900343847, 'support': 144005}, '1': {'precision': 0.7743480922745888, 'recall': 0.6877472442385933, 'f1-score': 0.7284829562664554, 'support': 568264}, '2': {'precision': 0.46257665965352074, 'recall': 0.29159376940007903, 'f1-score': 0.3577028921543175, 'support': 141752}, 'accuracy': 0.6124240504624594, 'macro avg': {'precision': 0.5288250189940269, 'recall': 0.536779979095719, 'f1-score': 0.5120227128183859, 'support': 854021}, 'weighted avg': {'precision': 0.6509702953988602, 'recall': 0.6124240504624594, 'f1-score': 0.6199625515120372, 'support': 854021}}
[[ 90867  45593   7545]
 [136965 390822  40477]
 [ 32122  68296  41334]]
Evaluating performance on  train set...
1431/1431 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8860853
{'0': {'precision': 0.368558236520703, 'recall': 0.5679610954109225, 'f1-score': 0.4470313267431817, 'support': 69709}, '1': {'precision': 0.7382784952952791, 'recall': 0.6500523355864247, 'f1-score': 0.6913621011717204, 'support': 225468}, '2': {'precision': 0.4183483493467203, 'recall': 0.3548196083407351, 'f1-score': 0.38397400199867265, 'support': 70929}, 'accuracy': 0.5772235363528595, 'macro avg': {'precision': 0.5083950270542342, 'recall': 0.5242776797793608, 'f1-score': 0.5074558099711916, 'support': 366106}, 'weighted avg': {'precision': 0.6058983790423298, 'recall': 0.5772235363528595, 'f1-score': 0.5852868540004528, 'support': 366106}}
[[ 39592  23273   6844]
 [ 50755 146566  28147]
 [ 17077  28685  25167]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93243504
{'0': {'precision': 0.3896353166986564, 'recall': 0.5315488962432265, 'f1-score': 0.4496608161946807, 'support': 27497}, '1': {'precision': 0.6618214541738481, 'recall': 0.6192168279247653, 'f1-score': 0.639810671129559, 'support': 70074}, '2': {'precision': 0.433327461687511, 'recall': 0.3487877498936623, 'f1-score': 0.3864886095836606, 'support': 28212}, 'accuracy': 0.5393972158399784, 'macro avg': {'precision': 0.49492807752000517, 'recall': 0.49985115802055136, 'f1-score': 0.4919866989693001, 'support': 125783}, 'weighted avg': {'precision': 0.5510705996213261, 'recall': 0.5393972158399784, 'f1-score': 0.5414247798606496, 'support': 125783}}
[[14616 10040  2841]
 [16656 43391 10027]
 [ 6240 12132  9840]]
testing model on single stock: results/universal/W9/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
10303/10303 - 144s - 144s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0716362
{'0': {'precision': 0.4093155232277867, 'recall': 0.4079056988605198, 'f1-score': 0.4086093949690607, 'support': 822217}, '1': {'precision': 0.418220007270615, 'recall': 0.4405660434704203, 'f1-score': 0.42910229793414856, 'support': 987062}, '2': {'precision': 0.423902330583886, 'recall': 0.39835532075471697, 'f1-score': 0.4107319611888377, 'support': 828125}, 'accuracy': 0.41713025384051894, 'macro avg': {'precision': 0.41714595369409585, 'recall': 0.41560902102855235, 'f1-score': 0.416147884697349, 'support': 2637404}, 'weighted avg': {'precision': 0.417228219830223, 'recall': 0.41713025384051894, 'f1-score': 0.41694543902498776, 'support': 2637404}}
[[335387 298387 188443]
 [292310 434866 259886]
 [191688 306549 329888]]
Evaluating performance on  train set...
3419/3419 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1193627
{'0': {'precision': 0.43929165443694357, 'recall': 0.2625920689145071, 'f1-score': 0.32869975626351106, 'support': 290679}, '1': {'precision': 0.35384714962027813, 'recall': 0.7958255637429901, 'f1-score': 0.4898796049557612, 'support': 288518}, '2': {'precision': 0.49475248090512564, 'recall': 0.08776612818754076, 'f1-score': 0.14908539910118293, 'support': 295957}, 'accuracy': 0.37926467798810265, 'macro avg': {'precision': 0.4292970949874491, 'recall': 0.3820612536150127, 'f1-score': 0.32255492010681835, 'support': 875154}, 'weighted avg': {'precision': 0.4298781594158948, 'recall': 0.37926467798810265, 'f1-score': 0.32109556463815087, 'support': 875154}}
[[ 76330 202222  12127]
 [ 44509 229610  14399]
 [ 52918 217064  25975]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.099552
{'0': {'precision': 0.4389212769108559, 'recall': 0.2804687096718688, 'f1-score': 0.342244641929168, 'support': 116234}, '1': {'precision': 0.38503207466573924, 'recall': 0.8038830353971824, 'f1-score': 0.5206776333950169, 'support': 126705}, '2': {'precision': 0.48152162132870924, 'recall': 0.07772442205253352, 'f1-score': 0.1338444506367628, 'support': 114327}, 'accuracy': 0.40121925959929017, 'macro avg': {'precision': 0.4351583243017681, 'recall': 0.38735872237386154, 'f1-score': 0.33225557532031597, 'support': 357266}, 'weighted avg': {'precision': 0.43344171324062813, 'recall': 0.40121925959929017, 'f1-score': 0.338837050705244, 'support': 357266}}
[[ 32600  78938   4696]
 [ 19977 101856   4872]
 [ 21696  83745   8886]]
training model: results/universal/W9/deepLOB_L2/h20
Epoch 1/50
6697/6697 - 283s - loss: 2.8719 - accuracy20: 0.5128 - val_loss: 3.4916 - val_accuracy20: 0.4166 - 283s/epoch - 42ms/step
Epoch 2/50
6697/6697 - 274s - loss: 2.8026 - accuracy20: 0.5295 - val_loss: 3.3373 - val_accuracy20: 0.4382 - 274s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 275s - loss: 2.7442 - accuracy20: 0.5442 - val_loss: 3.1729 - val_accuracy20: 0.4500 - 275s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 274s - loss: 2.7035 - accuracy20: 0.5532 - val_loss: 3.1093 - val_accuracy20: 0.4593 - 274s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 274s - loss: 2.6758 - accuracy20: 0.5596 - val_loss: 3.0619 - val_accuracy20: 0.4785 - 274s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 275s - loss: 2.6602 - accuracy20: 0.5629 - val_loss: 3.0272 - val_accuracy20: 0.4821 - 275s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 274s - loss: 2.6488 - accuracy20: 0.5651 - val_loss: 3.0265 - val_accuracy20: 0.4877 - 274s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 273s - loss: 2.6401 - accuracy20: 0.5672 - val_loss: 3.0167 - val_accuracy20: 0.4946 - 273s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 274s - loss: 2.6322 - accuracy20: 0.5684 - val_loss: 3.0264 - val_accuracy20: 0.4916 - 274s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 273s - loss: 2.6262 - accuracy20: 0.5691 - val_loss: 3.0425 - val_accuracy20: 0.4908 - 273s/epoch - 41ms/step
Epoch 11/50
6697/6697 - 274s - loss: 2.6209 - accuracy20: 0.5700 - val_loss: 2.9955 - val_accuracy20: 0.4953 - 274s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 273s - loss: 2.6158 - accuracy20: 0.5714 - val_loss: 3.0300 - val_accuracy20: 0.4995 - 273s/epoch - 41ms/step
Epoch 13/50
6697/6697 - 273s - loss: 2.6110 - accuracy20: 0.5724 - val_loss: 3.0334 - val_accuracy20: 0.4967 - 273s/epoch - 41ms/step
Epoch 14/50
6697/6697 - 274s - loss: 2.6075 - accuracy20: 0.5731 - val_loss: 3.0504 - val_accuracy20: 0.4980 - 274s/epoch - 41ms/step
Epoch 15/50
6697/6697 - 274s - loss: 2.6041 - accuracy20: 0.5737 - val_loss: 3.0749 - val_accuracy20: 0.4981 - 274s/epoch - 41ms/step
Epoch 16/50
6697/6697 - 272s - loss: 2.6008 - accuracy20: 0.5744 - val_loss: 3.0614 - val_accuracy20: 0.4991 - 272s/epoch - 41ms/step
Epoch 17/50
6697/6697 - 273s - loss: 2.5977 - accuracy20: 0.5751 - val_loss: 3.0806 - val_accuracy20: 0.5010 - 273s/epoch - 41ms/step
Epoch 18/50
6697/6697 - 274s - loss: 2.5947 - accuracy20: 0.5755 - val_loss: 3.0543 - val_accuracy20: 0.5030 - 274s/epoch - 41ms/step
Epoch 19/50
6697/6697 - 272s - loss: 2.5929 - accuracy20: 0.5759 - val_loss: 3.0671 - val_accuracy20: 0.5022 - 272s/epoch - 41ms/step
Epoch 20/50
6697/6697 - 273s - loss: 2.5899 - accuracy20: 0.5768 - val_loss: 3.0885 - val_accuracy20: 0.5016 - 273s/epoch - 41ms/step
Epoch 21/50
6697/6697 - 276s - loss: 2.5877 - accuracy20: 0.5771 - val_loss: 3.0911 - val_accuracy20: 0.5015 - 276s/epoch - 41ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 227s - 227s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0445341
{'0': {'precision': 0.3621477204927526, 'recall': 0.7232439413094884, 'f1-score': 0.48262973435878037, 'support': 1141377}, '1': {'precision': 0.7286927998247018, 'recall': 0.3249316653038383, 'f1-score': 0.44944925403392316, 'support': 2026423}, '2': {'precision': 0.4038525660803821, 'recall': 0.39845213949342745, 'f1-score': 0.4011341772688513, 'support': 1139896}, 'accuracy': 0.44992427506490706, 'macro avg': {'precision': 0.4982310287992789, 'recall': 0.4822092487022514, 'f1-score': 0.4444043885538516, 'support': 4307696}, 'weighted avg': {'precision': 0.5456134446202312, 'recall': 0.44992427506490706, 'f1-score': 0.44545576757330624, 'support': 4307696}}
[[825494 105497 210386]
 [907901 658449 460073]
 [546045 139657 454194]]
Evaluating performance on  train set...
6697/6697 - 96s - 96s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9812452
{'0': {'precision': 0.39334870474849476, 'recall': 0.6405306485579467, 'f1-score': 0.4873912998769465, 'support': 443985}, '1': {'precision': 0.6884730081560001, 'recall': 0.5053171782759814, 'f1-score': 0.5828448612739352, 'support': 820548}, '2': {'precision': 0.42338757388839443, 'recall': 0.3662007867008401, 'f1-score': 0.3927232729762811, 'support': 449472}, 'accuracy': 0.5038608405459727, 'macro avg': {'precision': 0.501736428930963, 'recall': 0.5040162045115895, 'f1-score': 0.48765314470905424, 'support': 1714005}, 'weighted avg': {'precision': 0.5425112144859054, 'recall': 0.5038608405459727, 'f1-score': 0.5082626517750334, 'support': 1714005}}
[[284386  86823  72776]
 [254522 414637 151389]
 [184079 100796 164597]]
Evaluating performance on  val set...
2631/2631 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9909854
{'0': {'precision': 0.38844602008947415, 'recall': 0.6489913804774584, 'f1-score': 0.48600160102397943, 'support': 177272}, '1': {'precision': 0.6573861076197026, 'recall': 0.5159241003433911, 'f1-score': 0.5781273082772106, 'support': 322373}, '2': {'precision': 0.4184621354827756, 'recall': 0.29880558586330913, 'f1-score': 0.3486531453552207, 'support': 173223}, 'accuracy': 0.49508670348419004, 'macro avg': {'precision': 0.48809808773065083, 'recall': 0.4879070222280529, 'f1-score': 0.4709273515521369, 'support': 672868}, 'weighted avg': {'precision': 0.5250233345020427, 'recall': 0.49508670348419015, 'f1-score': 0.4947803348737635, 'support': 672868}}
[[115048  39805  22419]
 [106541 166320  49512]
 [ 74586  46877  51760]]
testing model out of sample: results/universal/W9/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 117s - 117s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9504269
{'0': {'precision': 0.3510951966751257, 'recall': 0.6672819967736322, 'f1-score': 0.46010359501790493, 'support': 425246}, '1': {'precision': 0.8193845020275868, 'recall': 0.4508157194759199, 'f1-score': 0.5816270656475636, 'support': 1366585}, '2': {'precision': 0.35477371500529814, 'recall': 0.5507916715343956, 'f1-score': 0.431567748522089, 'support': 419429}, 'accuracy': 0.5114075233125006, 'macro avg': {'precision': 0.5084178045693368, 'recall': 0.5562964625946493, 'f1-score': 0.4910994697291859, 'support': 2211260}, 'weighted avg': {'precision': 0.6412012980018802, 'recall': 0.5114075233125006, 'f1-score': 0.5297939030551951, 'support': 2211260}}
[[283759  62906  78581]
 [408936 616078 341571]
 [115516  72895 231018]]
Evaluating performance on  train set...
3947/3947 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8843904
{'0': {'precision': 0.4025762690769925, 'recall': 0.6213520431439782, 'f1-score': 0.4885919928704676, 'support': 208233}, '1': {'precision': 0.8223491582437795, 'recall': 0.6076066759069096, 'f1-score': 0.6988535261609952, 'support': 593058}, '2': {'precision': 0.43076178437710005, 'recall': 0.5170125835985924, 'f1-score': 0.46996262102343767, 'support': 208287}, 'accuracy': 0.5917512069399293, 'macro avg': {'precision': 0.551895737232624, 'recall': 0.5819904342164933, 'f1-score': 0.5524693800183001, 'support': 1009578}, 'weighted avg': {'precision': 0.654979101278952, 'recall': 0.5917512069399293, 'f1-score': 0.6082628141802737, 'support': 1009578}}
[[129386  37338  41509]
 [131916 360346 100796]
 [ 60093  40507 107687]]
Evaluating performance on  val set...
1402/1402 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.903822
{'0': {'precision': 0.4001444847725235, 'recall': 0.6144480085538626, 'f1-score': 0.48466351450363976, 'support': 74820}, '1': {'precision': 0.8247774224793345, 'recall': 0.5981160033869602, 'f1-score': 0.6933935692573692, 'support': 207856}, '2': {'precision': 0.4347905892006867, 'recall': 0.532898393457375, 'f1-score': 0.478871229553522, 'support': 75566}, 'accuracy': 0.5877702781918368, 'macro avg': {'precision': 0.5532374988175149, 'recall': 0.5818208017993993, 'f1-score': 0.5523094377715103, 'support': 358242}, 'weighted avg': {'precision': 0.6538293442451858, 'recall': 0.5877702781918368, 'f1-score': 0.6045492187380695, 'support': 358242}}
[[ 45973  12986  15861]
 [ 47047 124322  36487]
 [ 21871  13426  40269]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0864841
{'0': {'precision': 0.3987817522032141, 'recall': 0.637112804373033, 'f1-score': 0.4905305445733962, 'support': 24148}, '1': {'precision': 0.4929024463908185, 'recall': 0.2649673255672363, 'f1-score': 0.34465827195691773, 'support': 24637}, '2': {'precision': 0.48653927813163483, 'recall': 0.43093008386926923, 'f1-score': 0.45704940266060357, 'support': 26589}, 'accuracy': 0.44273887547430146, 'macro avg': {'precision': 0.4594078255752225, 'recall': 0.4443367379365128, 'f1-score': 0.43074607306363916, 'support': 75374}, 'weighted avg': {'precision': 0.46050378366778794, 'recall': 0.44273887547430146, 'f1-score': 0.4310394035596325, 'support': 75374}}
[[15385  2963  5800]
 [11817  6528  6292]
 [11378  3753 11458]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.060142
{'0': {'precision': 0.43960058451047246, 'recall': 0.5375223347230494, 'f1-score': 0.48365487674169344, 'support': 16790}, '1': {'precision': 0.5095638867635807, 'recall': 0.41060419235511714, 'f1-score': 0.45476271765107545, 'support': 17842}, '2': {'precision': 0.4599309579583282, 'recall': 0.4522640480087289, 'f1-score': 0.456065283168801, 'support': 16497}, 'accuracy': 0.4657239531381408, 'macro avg': {'precision': 0.4696984764107938, 'recall': 0.4667968583622985, 'f1-score': 0.4648276258538566, 'support': 51129}, 'weighted avg': {'precision': 0.4705746972365033, 'recall': 0.4657239531381408, 'f1-score': 0.4646707497752593, 'support': 51129}}
[[9025 3575 4190]
 [5945 7326 4571]
 [5560 3476 7461]]
Evaluating performance on  val set...
53/53 - 1s - 917ms/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0612316
{'0': {'precision': 0.3989214400233202, 'recall': 0.6504277566539924, 'f1-score': 0.4945342849399224, 'support': 4208}, '1': {'precision': 0.5917182662538699, 'recall': 0.30672016048144435, 'f1-score': 0.4040163826132911, 'support': 4985}, '2': {'precision': 0.4711276332094176, 'recall': 0.44343363657569396, 'f1-score': 0.45686133141071855, 'support': 4287}, 'accuracy': 0.4574925816023739, 'macro avg': {'precision': 0.48725577982886925, 'recall': 0.46686051790371025, 'f1-score': 0.4518039996546441, 'support': 13480}, 'weighted avg': {'precision': 0.4931825771856414, 'recall': 0.4574925816023739, 'f1-score': 0.4490791146967507, 'support': 13480}}
[[2737  518  953]
 [2275 1529 1181]
 [1849  537 1901]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85431814
{'0': {'precision': 0.2167433500114019, 'recall': 0.6660071720044516, 'f1-score': 0.32705191782208276, 'support': 24261}, '1': {'precision': 0.9247897465641511, 'recall': 0.5522916402652811, 'f1-score': 0.6915714334831146, 'support': 236730}, '2': {'precision': 0.2343836767239538, 'recall': 0.6540967972661528, 'f1-score': 0.34510519198716944, 'support': 25166}, 'accuracy': 0.5708859122789238, 'macro avg': {'precision': 0.45863892443316895, 'recall': 0.6241318698452951, 'f1-score': 0.45457618109745557, 'support': 286157}, 'weighted avg': {'precision': 0.8040424897073744, 'recall': 0.5708859122789238, 'f1-score': 0.6301968125479662, 'support': 286157}}
[[ 16158   5308   2795]
 [ 55011 130744  50975]
 [  3380   5325  16461]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71119756
{'0': {'precision': 0.3685652769622235, 'recall': 0.5859654582231212, 'f1-score': 0.4525082607389606, 'support': 12854}, '1': {'precision': 0.9161289590964244, 'recall': 0.7788125054226798, 'f1-score': 0.8419083547839137, 'support': 103731}, '2': {'precision': 0.36644334401398193, 'recall': 0.597530082330589, 'f1-score': 0.45428829371050256, 'support': 12632}, 'accuracy': 0.7419070246175039, 'macro avg': {'precision': 0.5503791933575433, 'recall': 0.65410268199213, 'f1-score': 0.5829016364111256, 'support': 129217}, 'weighted avg': {'precision': 0.8079232875526304, 'recall': 0.7419070246175039, 'f1-score': 0.7652793863019558, 'support': 129217}}
[[ 7532  3862  1460]
 [11354 80787 11590]
 [ 1550  3534  7548]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71684724
{'0': {'precision': 0.3339859495566049, 'recall': 0.6277056277056277, 'f1-score': 0.43599188153048185, 'support': 4620}, '1': {'precision': 0.9181320265206111, 'recall': 0.746484375, 'f1-score': 0.8234584392640151, 'support': 38400}, '2': {'precision': 0.3656593753951195, 'recall': 0.6033799290632172, 'f1-score': 0.4553613604156826, 'support': 4793}, 'accuracy': 0.7206617447137807, 'macro avg': {'precision': 0.5392591171574451, 'recall': 0.6591899772562817, 'f1-score': 0.5716038937367265, 'support': 47813}, 'weighted avg': {'precision': 0.8063056133606297, 'recall': 0.7206617447137807, 'f1-score': 0.7491191425110614, 'support': 47813}}
[[ 2900  1290   430]
 [ 5148 28665  4587]
 [  635  1266  2892]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.023777
{'0': {'precision': 0.4748067933569801, 'recall': 0.5114625506072874, 'f1-score': 0.49245349672923944, 'support': 39520}, '1': {'precision': 0.5796378544584899, 'recall': 0.508837525492862, 'f1-score': 0.5419350717107294, 'support': 50014}, '2': {'precision': 0.4585667196828251, 'recall': 0.4933415995040298, 'f1-score': 0.4753189659291824, 'support': 40325}, 'accuracy': 0.5048244634565182, 'macro avg': {'precision': 0.5043371224994317, 'recall': 0.5045472252013931, 'f1-score': 0.5032358447897171, 'support': 129859}, 'weighted avg': {'precision': 0.5101384971204512, 'recall': 0.5048244634565182, 'f1-score': 0.5061900997880335, 'support': 129859}}
[[20213  9475  9832]
 [10908 25449 13657]
 [11450  8981 19894]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0799116
{'0': {'precision': 0.4528301886792453, 'recall': 0.5770847932725999, 'f1-score': 0.5074621117294768, 'support': 22832}, '1': {'precision': 0.4967409948542024, 'recall': 0.3336098055478758, 'f1-score': 0.3991509772031866, 'support': 21702}, '2': {'precision': 0.4659922513990529, 'recall': 0.4839502861230329, 'f1-score': 0.47480152638273615, 'support': 22368}, 'accuracy': 0.4669666078742041, 'macro avg': {'precision': 0.47185447831083355, 'recall': 0.4648816283145029, 'f1-score': 0.4604715384384665, 'support': 66902}, 'weighted avg': {'precision': 0.4714747932430188, 'recall': 0.4669666078742041, 'f1-score': 0.4614078799497775, 'support': 66902}}
[[13176  3592  6064]
 [ 8121  7240  6341]
 [ 7800  3743 10825]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0909
{'0': {'precision': 0.46759420289855075, 'recall': 0.5987232779097387, 'f1-score': 0.5250960223943755, 'support': 6736}, '1': {'precision': 0.4372561768530559, 'recall': 0.26471167093091913, 'f1-score': 0.3297781046953537, 'support': 5081}, '2': {'precision': 0.49345606213145404, 'recall': 0.5018282872604943, 'f1-score': 0.4976069615663524, 'support': 6837}, 'accuracy': 0.4722311568564383, 'macro avg': {'precision': 0.46610214729435356, 'recall': 0.4550877453670507, 'f1-score': 0.4508270295520272, 'support': 18654}, 'weighted avg': {'precision': 0.4688094929831546, 'recall': 0.4722311568564383, 'f1-score': 0.4618198859780614, 'support': 18654}}
[[4033  840 1863]
 [2077 1345 1659]
 [2515  891 3431]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2673556
{'0': {'precision': 0.35526494657567764, 'recall': 0.5347000572878304, 'f1-score': 0.42689361146049426, 'support': 48876}, '1': {'precision': 0.41163176133795387, 'recall': 0.04585123523093448, 'f1-score': 0.08251158997900968, 'support': 59584}, '2': {'precision': 0.3425680136903238, 'recall': 0.5532512186629527, 'f1-score': 0.42313485623933755, 'support': 45952}, 'accuracy': 0.35158536901277104, 'macro avg': {'precision': 0.3698215738679851, 'recall': 0.37793417039390587, 'f1-score': 0.31084668589294717, 'support': 154412}, 'weighted avg': {'precision': 0.3732370655227004, 'recall': 0.35158536901277104, 'f1-score': 0.2928860169220169, 'support': 154412}}
[[26134  1989 20753]
 [28815  2732 28037]
 [18613  1916 25423]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2352827
{'0': {'precision': 0.38701861406459337, 'recall': 0.47448801286083736, 'f1-score': 0.4263128974016799, 'support': 28614}, '1': {'precision': 0.36848412222887955, 'recall': 0.08826378673172831, 'f1-score': 0.1424146814484615, 'support': 27871}, '2': {'precision': 0.3568912373403787, 'recall': 0.5578967495219885, 'f1-score': 0.4353106164587934, 'support': 26150}, 'accuracy': 0.3706177769710171, 'macro avg': {'precision': 0.37079799121128393, 'recall': 0.3735495163715181, 'f1-score': 0.3346793984363116, 'support': 82635}, 'weighted avg': {'precision': 0.3712334658429997, 'recall': 0.3706177769710171, 'f1-score': 0.33340750835964406, 'support': 82635}}
[[13577  2125 12912]
 [12034  2460 13377]
 [ 9470  2091 14589]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2213551
{'0': {'precision': 0.42457683372054433, 'recall': 0.48355698355698357, 'f1-score': 0.4521516302907131, 'support': 10582}, '1': {'precision': 0.28492739108662996, 'recall': 0.07050805452292441, 'f1-score': 0.11304261448296414, 'support': 8070}, '2': {'precision': 0.3833321748801001, 'recall': 0.5636753883892068, 'f1-score': 0.4563319680608994, 'support': 9784}, 'accuracy': 0.39390209593473063, 'macro avg': {'precision': 0.3642787998957582, 'recall': 0.37258014215637153, 'f1-score': 0.3405087376115255, 'support': 28436}, 'weighted avg': {'precision': 0.3707539070026306, 'recall': 0.39390209593473063, 'f1-score': 0.3573524555535829, 'support': 28436}}
[[5117  709 4756]
 [3385  569 4116]
 [3550  719 5515]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
631/631 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1101079
{'0': {'precision': 0.46001246953465963, 'recall': 0.5431941771940099, 'f1-score': 0.4981547833692658, 'support': 59765}, '1': {'precision': 0.40074678046178464, 'recall': 0.1208715438185203, 'f1-score': 0.1857253849413759, 'support': 43509}, '2': {'precision': 0.43854766598379136, 'recall': 0.5865010166454148, 'f1-score': 0.5018467050506094, 'support': 58034}, 'accuracy': 0.44486324298856844, 'macro avg': {'precision': 0.43310230532674526, 'recall': 0.416855579219315, 'f1-score': 0.39524229112041703, 'support': 161308}, 'weighted avg': {'precision': 0.4363045364182438, 'recall': 0.44486324298856844, 'f1-score': 0.4152126248071116, 'support': 161308}}
[[32464  4472 22829]
 [17503  5259 20747]
 [20605  3392 34037]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.097367
{'0': {'precision': 0.43272425249169433, 'recall': 0.5785746014510637, 'f1-score': 0.49513209858292334, 'support': 40522}, '1': {'precision': 0.5081863731408056, 'recall': 0.31602836183419614, 'f1-score': 0.3897074395667564, 'support': 40759}, '2': {'precision': 0.4498160550891425, 'recall': 0.4692250922509225, 'f1-score': 0.4593156259782792, 'support': 40650}, 'accuracy': 0.45435533211406454, 'macro avg': {'precision': 0.4635755602405475, 'recall': 0.45460935184539414, 'f1-score': 0.4480517213759863, 'support': 121931}, 'weighted avg': {'precision': 0.46364782689954304, 'recall': 0.45435533211406454, 'f1-score': 0.44795014085093776, 'support': 121931}}
[[23445  6122 10955]
 [15503 12881 12375]
 [15232  6344 19074]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.086213
{'0': {'precision': 0.43773724167018135, 'recall': 0.5448162729658793, 'f1-score': 0.4854420018709074, 'support': 15240}, '1': {'precision': 0.541653290529695, 'recall': 0.40476190476190477, 'f1-score': 0.463307475801469, 'support': 16674}, '2': {'precision': 0.4540040137243478, 'recall': 0.46875208876412006, 'f1-score': 0.4612601946856091, 'support': 14961}, 'accuracy': 0.47072, 'macro avg': {'precision': 0.4777981819747414, 'recall': 0.4727767554973014, 'f1-score': 0.47000322411932843, 'support': 46875}, 'weighted avg': {'precision': 0.47989326034508084, 'recall': 0.47072, 'f1-score': 0.469850426297978, 'support': 46875}}
[[8303 2939 3998]
 [5489 6749 4436]
 [5176 2772 7013]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
2354/2354 - 34s - 34s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86084443
{'0': {'precision': 0.2951163990651653, 'recall': 0.7709727552412065, 'f1-score': 0.42684366947184504, 'support': 63058}, '1': {'precision': 0.9392031709947247, 'recall': 0.539764162004623, 'f1-score': 0.6855434886664611, 'support': 477616}, '2': {'precision': 0.26780012135401665, 'recall': 0.7080767485577235, 'f1-score': 0.38862082920126123, 'support': 61708}, 'accuracy': 0.5812092658811187, 'macro avg': {'precision': 0.5007065638046356, 'recall': 0.6729378886011843, 'f1-score': 0.5003359957798558, 'support': 602382}, 'weighted avg': {'precision': 0.8030009553714773, 'recall': 0.5812092658811187, 'f1-score': 0.6280457602000515, 'support': 602382}}
[[ 48616   7766   6676]
 [107027 257800 112789]
 [  9092   8922  43694]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8015262
{'0': {'precision': 0.2933844444715735, 'recall': 0.7597369752149722, 'f1-score': 0.42330353604297855, 'support': 31632}, '1': {'precision': 0.9399994972727044, 'recall': 0.5850849950325039, 'f1-score': 0.7212447624604019, 'support': 255662}, '2': {'precision': 0.3052040272881743, 'recall': 0.7380185815472358, 'f1-score': 0.43182776407266205, 'support': 32613}, 'accuracy': 0.6179452153282048, 'macro avg': {'precision': 0.5128626563441507, 'recall': 0.6942801839315708, 'f1-score': 0.5254586875253475, 'support': 319907}, 'weighted avg': {'precision': 0.8113486330752631, 'recall': 0.6179452153282048, 'f1-score': 0.6622800213248367, 'support': 319907}}
[[ 24032   4428   3172]
 [ 54457 149584  51621]
 [  3424   5120  24069]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8315183
{'0': {'precision': 0.26483626087438356, 'recall': 0.740376423205019, 'f1-score': 0.39012345679012345, 'support': 12911}, '1': {'precision': 0.943128281060708, 'recall': 0.5566346898647441, 'f1-score': 0.700081184037969, 'support': 100698}, '2': {'precision': 0.3074968642459718, 'recall': 0.7348962336664104, 'f1-score': 0.4335759472144752, 'support': 13010}, 'accuracy': 0.5936865715256004, 'macro avg': {'precision': 0.5051538020603544, 'recall': 0.6773024489120578, 'f1-score': 0.5079268626808559, 'support': 126619}, 'weighted avg': {'precision': 0.8086540472933796, 'recall': 0.5936865715256004, 'f1-score': 0.6410924276303952, 'support': 126619}}
[[ 9559  1465  1887]
 [25001 56052 19645]
 [ 1534  1915  9561]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
3870/3870 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.976249
{'0': {'precision': 0.2520058004778262, 'recall': 0.7350593293058167, 'f1-score': 0.37533331710544654, 'support': 115373}, '1': {'precision': 0.9204530248287776, 'recall': 0.39558532135033536, 'f1-score': 0.5533542493984802, 'support': 765084}, '2': {'precision': 0.2356359992869481, 'recall': 0.6954490616014005, 'f1-score': 0.35200400364552126, 'support': 110241}, 'accuracy': 0.4684868648165233, 'macro avg': {'precision': 0.46936494153118397, 'recall': 0.6086979040858509, 'f1-score': 0.42689719004981597, 'support': 990698}, 'weighted avg': {'precision': 0.7664043890913489, 'recall': 0.4684868648165233, 'f1-score': 0.5102171264170104, 'support': 990698}}
[[ 84806  13565  17002]
 [230735 302656 231693]
 [ 20983  12591  76667]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.743108
{'0': {'precision': 0.3178788472848461, 'recall': 0.6413527143280926, 'f1-score': 0.4250745486122489, 'support': 40452}, '1': {'precision': 0.9180525787993786, 'recall': 0.7208313520123016, 'f1-score': 0.8075752884666942, 'support': 323858}, '2': {'precision': 0.33877146533745506, 'recall': 0.5842857142857143, 'f1-score': 0.4288777162973158, 'support': 39200}, 'accuracy': 0.6995985229610171, 'macro avg': {'precision': 0.5249009638072266, 'recall': 0.6488232602087028, 'f1-score': 0.5538425177920864, 'support': 403510}, 'weighted avg': {'precision': 0.801609250418587, 'recall': 0.6995985229610171, 'f1-score': 0.7324399392618873, 'support': 403510}}
[[ 25944  10418   4090]
 [ 49796 233447  40615]
 [  5876  10420  22904]]
Evaluating performance on  val set...
600/600 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7802571
{'0': {'precision': 0.29450675870002874, 'recall': 0.6383155561712148, 'f1-score': 0.4030526338807373, 'support': 14438}, '1': {'precision': 0.9224514474548354, 'recall': 0.7122286523772345, 'f1-score': 0.8038225355183313, 'support': 124241}, '2': {'precision': 0.33415935951200915, 'recall': 0.593392458195112, 'f1-score': 0.4275505475476208, 'support': 14771}, 'accuracy': 0.6938351254480287, 'macro avg': {'precision': 0.5170391885556245, 'recall': 0.6479788889145205, 'f1-score': 0.5448085723155631, 'support': 153450}, 'weighted avg': {'precision': 0.8067399593659114, 'recall': 0.6938351254480287, 'f1-score': 0.7298946803592635, 'support': 153450}}
[[ 9216  3714  1508]
 [19796 88488 15957]
 [ 2281  3725  8765]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9484434
{'0': {'precision': 0.45342151962914673, 'recall': 0.592442964373806, 'f1-score': 0.5136925353308185, 'support': 169061}, '1': {'precision': 0.6634969577372143, 'recall': 0.5439265817580069, 'f1-score': 0.5977912810606888, 'support': 296711}, '2': {'precision': 0.4674550412058454, 'recall': 0.4721883529637492, 'f1-score': 0.4698097754130564, 'support': 161569}, 'accuracy': 0.5385252996376771, 'macro avg': {'precision': 0.5281245061907355, 'recall': 0.5361859663651873, 'f1-score': 0.5270978639348546, 'support': 627341}, 'weighted avg': {'precision': 0.5563943451962761, 'recall': 0.5385252996376771, 'f1-score': 0.5421665698783814, 'support': 627341}}
[[100159  40890  28012]
 [ 76420 161389  58902]
 [ 44317  40961  76291]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89198405
{'0': {'precision': 0.4861108147895287, 'recall': 0.5612567895456393, 'f1-score': 0.5209880354192747, 'support': 81191}, '1': {'precision': 0.6980867905637945, 'recall': 0.6144805601646895, 'f1-score': 0.653620954187432, 'support': 145243}, '2': {'precision': 0.49043297232813265, 'recall': 0.5198864340796945, 'f1-score': 0.5047303803562831, 'support': 80658}, 'accuracy': 0.5755636747293971, 'macro avg': {'precision': 0.5582101925604853, 'recall': 0.5652079279300078, 'f1-score': 0.5597797899876634, 'support': 307092}, 'weighted avg': {'precision': 0.5875027209027794, 'recall': 0.5755636747293971, 'f1-score': 0.579448343986651, 'support': 307092}}
[[45569 19317 16305]
 [28730 89249 27264]
 [19443 19282 41933]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87762105
{'0': {'precision': 0.48040593286494926, 'recall': 0.5996881699473787, 'f1-score': 0.5334604715672678, 'support': 30786}, '1': {'precision': 0.700175702811245, 'recall': 0.6362668694164607, 'f1-score': 0.6666932223306579, 'support': 52610}, '2': {'precision': 0.5169082125603864, 'recall': 0.46683482173290614, 'f1-score': 0.4905971271984812, 'support': 29338}, 'accuracy': 0.5821846115635034, 'macro avg': {'precision': 0.5658299494121936, 'recall': 0.5675966203655819, 'f1-score': 0.5635836070321356, 'support': 112734}, 'weighted avg': {'precision': 0.5924661052936695, 'recall': 0.5821846115635034, 'f1-score': 0.5844819045029438, 'support': 112734}}
[[18462  7237  5087]
 [11423 33474  7713]
 [ 8545  7097 13696]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
3337/3337 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8671586
{'0': {'precision': 0.40906051801168497, 'recall': 0.7022527354644926, 'f1-score': 0.5169809085704132, 'support': 186440}, '1': {'precision': 0.78306106876725, 'recall': 0.5711454232105284, 'f1-score': 0.6605222293205467, 'support': 483341}, '2': {'precision': 0.49045277652220887, 'recall': 0.4829298740772905, 'f1-score': 0.48666225448101214, 'support': 184240}, 'accuracy': 0.5807363050791491, 'macro avg': {'precision': 0.5608581211003812, 'recall': 0.5854426775841038, 'f1-score': 0.5547217974573241, 'support': 854021}, 'weighted avg': {'precision': 0.6382884994204846, 'recall': 0.5807363050791491, 'f1-score': 0.5916787165672411, 'support': 854021}}
[[130928  32336  23176]
 [138020 276058  69263]
 [ 51122  44143  88975]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90931267
{'0': {'precision': 0.42494563939821345, 'recall': 0.6600750824423474, 'f1-score': 0.5170334949612316, 'support': 87637}, '1': {'precision': 0.7667417776611671, 'recall': 0.525995648422156, 'f1-score': 0.6239516708898121, 'support': 188897}, '2': {'precision': 0.47081440752251175, 'recall': 0.5276872236859733, 'f1-score': 0.4976311301088627, 'support': 89572}, 'accuracy': 0.5585049138774016, 'macro avg': {'precision': 0.5541672748606308, 'recall': 0.5712526515168256, 'f1-score': 0.5462054319866355, 'support': 366106}, 'weighted avg': {'precision': 0.6125219763822749, 'recall': 0.5585049138774016, 'f1-score': 0.5674522645356845, 'support': 366106}}
[[57847 13562 16228]
 [52640 99359 36898]
 [25641 16665 47266]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9416522
{'0': {'precision': 0.4411381053318115, 'recall': 0.6329025089186502, 'f1-score': 0.519901035286205, 'support': 34198}, '1': {'precision': 0.7123504238558618, 'recall': 0.4594989010989011, 'f1-score': 0.5586456039845237, 'support': 56875}, '2': {'precision': 0.47986610711430855, 'recall': 0.5534428118697782, 'f1-score': 0.5140349468839474, 'support': 34710}, 'accuracy': 0.5325679940850513, 'macro avg': {'precision': 0.544451545433994, 'recall': 0.5486147406291098, 'f1-score': 0.5308605287182253, 'support': 125783}, 'weighted avg': {'precision': 0.5744585823273183, 'recall': 0.5325679940850513, 'f1-score': 0.5358013192377288, 'support': 125783}}
[[21644  5046  7508]
 [17427 26134 13314]
 [ 9993  5507 19210]]
testing model on single stock: results/universal/W9/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
10303/10303 - 138s - 138s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.116868
{'0': {'precision': 0.3633988336234568, 'recall': 0.7585217928983963, 'f1-score': 0.4913822391728375, 'support': 836121}, '1': {'precision': 0.44576056715717494, 'recall': 0.11130885494809487, 'f1-score': 0.17813614010177106, 'support': 955782}, '2': {'precision': 0.44730882348440565, 'recall': 0.34573465909561313, 'f1-score': 0.3900168578265479, 'support': 845501}, 'accuracy': 0.39164344939190204, 'macro avg': {'precision': 0.41882274142167913, 'recall': 0.40518843564736806, 'f1-score': 0.3531784123670521, 'support': 2637404}, 'weighted avg': {'precision': 0.4201462423396589, 'recall': 0.39164344939190204, 'f1-score': 0.3453676299753042, 'support': 2637404}}
[[634216  49692 152213]
 [640421 106387 208974]
 [470597  82585 292319]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.09408
{'0': {'precision': 0.39313698176057527, 'recall': 0.6673248324093699, 'f1-score': 0.4947845683112137, 'support': 289694}, '1': {'precision': 0.41913333363529715, 'recall': 0.32125634892254923, 'f1-score': 0.3637253399054279, 'support': 288041}, '2': {'precision': 0.47051770782095426, 'recall': 0.2572969447143592, 'f1-score': 0.33267472215520183, 'support': 297419}, 'accuracy': 0.4140756941064087, 'macro avg': {'precision': 0.42759600773894224, 'recall': 0.4152927086820928, 'f1-score': 0.3970615434572811, 'support': 875154}, 'weighted avg': {'precision': 0.4279908627398071, 'recall': 0.4140756941064087, 'f1-score': 0.39655616560368356, 'support': 875154}}
[[193320  57557  38817]
 [148208  92535  47298]
 [150209  70685  76525]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1019481
{'0': {'precision': 0.39428596990889164, 'recall': 0.6701359262669697, 'f1-score': 0.4964670392599871, 'support': 118373}, '1': {'precision': 0.42282602883775644, 'recall': 0.3870223092295771, 'f1-score': 0.4041327206367728, 'support': 122595}, '2': {'precision': 0.4610947723593917, 'recall': 0.17390668799119505, 'f1-score': 0.25255836314708324, 'support': 116298}, 'accuracy': 0.41145253116725355, 'macro avg': {'precision': 0.42606892370201327, 'recall': 0.4103549744959139, 'f1-score': 0.3843860410146143, 'support': 357266}, 'weighted avg': {'precision': 0.4258271706718314, 'recall': 0.41145253116725355, 'f1-score': 0.38538505271161294, 'support': 357266}}
[[79326 29023 10024]
 [61534 47447 13614]
 [60329 35744 20225]]
training model: results/universal/W9/deepLOB_L2/h30
Epoch 1/50
6697/6697 - 276s - loss: 2.9357 - accuracy30: 0.4884 - val_loss: 3.3506 - val_accuracy30: 0.3848 - 276s/epoch - 41ms/step
Epoch 2/50
6697/6697 - 273s - loss: 2.8812 - accuracy30: 0.5059 - val_loss: 3.2440 - val_accuracy30: 0.3955 - 273s/epoch - 41ms/step
Epoch 3/50
6697/6697 - 275s - loss: 2.8394 - accuracy30: 0.5165 - val_loss: 3.3009 - val_accuracy30: 0.4194 - 275s/epoch - 41ms/step
Epoch 4/50
6697/6697 - 275s - loss: 2.8001 - accuracy30: 0.5266 - val_loss: 3.2326 - val_accuracy30: 0.4311 - 275s/epoch - 41ms/step
Epoch 5/50
6697/6697 - 273s - loss: 2.7640 - accuracy30: 0.5358 - val_loss: 3.2104 - val_accuracy30: 0.4281 - 273s/epoch - 41ms/step
Epoch 6/50
6697/6697 - 273s - loss: 2.7442 - accuracy30: 0.5402 - val_loss: 3.2057 - val_accuracy30: 0.4261 - 273s/epoch - 41ms/step
Epoch 7/50
6697/6697 - 276s - loss: 2.7312 - accuracy30: 0.5427 - val_loss: 3.1933 - val_accuracy30: 0.4304 - 276s/epoch - 41ms/step
Epoch 8/50
6697/6697 - 275s - loss: 2.7212 - accuracy30: 0.5451 - val_loss: 3.1656 - val_accuracy30: 0.4362 - 275s/epoch - 41ms/step
Epoch 9/50
6697/6697 - 275s - loss: 2.7136 - accuracy30: 0.5469 - val_loss: 3.1410 - val_accuracy30: 0.4370 - 275s/epoch - 41ms/step
Epoch 10/50
6697/6697 - 274s - loss: 2.7075 - accuracy30: 0.5479 - val_loss: 3.1702 - val_accuracy30: 0.4411 - 274s/epoch - 41ms/step
Epoch 11/50
6697/6697 - 275s - loss: 2.7078 - accuracy30: 0.5481 - val_loss: 3.1711 - val_accuracy30: 0.4410 - 275s/epoch - 41ms/step
Epoch 12/50
6697/6697 - 275s - loss: 2.6994 - accuracy30: 0.5496 - val_loss: 3.1612 - val_accuracy30: 0.4431 - 275s/epoch - 41ms/step
Epoch 13/50
6697/6697 - 276s - loss: 2.6944 - accuracy30: 0.5508 - val_loss: 3.2199 - val_accuracy30: 0.4460 - 276s/epoch - 41ms/step
Epoch 14/50
6697/6697 - 274s - loss: 2.6897 - accuracy30: 0.5518 - val_loss: 3.1677 - val_accuracy30: 0.4522 - 274s/epoch - 41ms/step
Epoch 15/50
6697/6697 - 275s - loss: 2.6864 - accuracy30: 0.5526 - val_loss: 3.1606 - val_accuracy30: 0.4569 - 275s/epoch - 41ms/step
Epoch 16/50
6697/6697 - 274s - loss: 2.6835 - accuracy30: 0.5530 - val_loss: 3.1969 - val_accuracy30: 0.4513 - 274s/epoch - 41ms/step
Epoch 17/50
6697/6697 - 276s - loss: 2.6800 - accuracy30: 0.5537 - val_loss: 3.2266 - val_accuracy30: 0.4527 - 276s/epoch - 41ms/step
Epoch 18/50
6697/6697 - 274s - loss: 2.6769 - accuracy30: 0.5543 - val_loss: 3.2214 - val_accuracy30: 0.4577 - 274s/epoch - 41ms/step
Epoch 19/50
6697/6697 - 278s - loss: 2.6742 - accuracy30: 0.5551 - val_loss: 3.2207 - val_accuracy30: 0.4489 - 278s/epoch - 42ms/step
testing model in sample: results/universal/W9/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 238s - 238s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.135724
{'0': {'precision': 0.35556595553099657, 'recall': 0.6798507574086391, 'f1-score': 0.4669265642625712, 'support': 1205822}, '1': {'precision': 0.7499463265423905, 'recall': 0.17123916965939082, 'f1-score': 0.2788150416517185, 'support': 1897101}, '2': {'precision': 0.3854425861717316, 'recall': 0.5019568001606942, 'f1-score': 0.4360506220317529, 'support': 1204773}, 'accuracy': 0.40610595548060957, 'macro avg': {'precision': 0.4969849560817062, 'recall': 0.451015575742908, 'f1-score': 0.39393074264868083, 'support': 4307696}, 'weighted avg': {'precision': 0.5376061817106101, 'recall': 0.40610595548060957, 'f1-score': 0.3754472539292002, 'support': 4307696}}
[[819779  47933 338110]
 [946137 324858 626106]
 [539645  60384 604744]]
Evaluating performance on  train set...
6697/6697 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0604602
{'0': {'precision': 0.3632764484788638, 'recall': 0.6837933413834743, 'f1-score': 0.47447843296852765, 'support': 463760}, '1': {'precision': 0.6880133597876673, 'recall': 0.33743319695648993, 'f1-score': 0.45279502089127494, 'support': 778969}, '2': {'precision': 0.39556456005054136, 'recall': 0.3852859046503535, 'f1-score': 0.39035758126895875, 'support': 471276}, 'accuracy': 0.4443055883734295, 'macro avg': {'precision': 0.48228478943902414, 'recall': 0.4688374809967725, 'f1-score': 0.4392103450429205, 'support': 1714005}, 'weighted avg': {'precision': 0.5197384186215187, 'recall': 0.4443055883734295, 'f1-score': 0.44149437263733166, 'support': 1714005}}
[[317116  51537  95107]
 [333772 262850 182347]
 [222045  67655 181576]]
Evaluating performance on  val set...
2631/2631 - 41s - 41s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0698909
{'0': {'precision': 0.35869676797826894, 'recall': 0.7358618939365303, 'f1-score': 0.4822971892098501, 'support': 185191}, '1': {'precision': 0.655223543012239, 'recall': 0.34074809838722325, 'f1-score': 0.44833842053222134, 'support': 306056}, '2': {'precision': 0.40069662971738657, 'recall': 0.2951641054723848, 'f1-score': 0.3399279663166438, 'support': 181621}, 'accuracy': 0.4371897608446233, 'macro avg': {'precision': 0.47153898023596486, 'recall': 0.4572580325987128, 'f1-score': 0.42352119201957167, 'support': 672868}, 'weighted avg': {'precision': 0.5049094806480897, 'recall': 0.4371897608446233, 'f1-score': 0.42842254286392883, 'support': 672868}}
[[136275  23982  24934]
 [146523 104288  55245]
 [ 97119  30894  53608]]
testing model out of sample: results/universal/W9/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 131s - 131s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1058668
{'0': {'precision': 0.3402346512896102, 'recall': 0.6565861587513285, 'f1-score': 0.44821167558724684, 'support': 479870}, '1': {'precision': 0.7410882469414138, 'recall': 0.2805049333065804, 'f1-score': 0.4069700411119204, 'support': 1260919}, '2': {'precision': 0.3319470952122801, 'recall': 0.5700542647687105, 'f1-score': 0.41957333037132755, 'support': 470471}, 'accuracy': 0.4237240306431627, 'macro avg': {'precision': 0.4710899978144347, 'recall': 0.5023817856088731, 'f1-score': 0.4249183490234983, 'support': 2211260}, 'weighted avg': {'precision': 0.5670487121329391, 'recall': 0.4237240306431627, 'f1-score': 0.4186014662888953, 'support': 2211260}}
[[315076  54676 110118]
 [477595 353694 429630]
 [133384  68893 268194]]
Evaluating performance on  train set...
3947/3947 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.002082
{'0': {'precision': 0.3581014493115209, 'recall': 0.6256254903670124, 'f1-score': 0.45548695636996595, 'support': 229420}, '1': {'precision': 0.7788054267510446, 'recall': 0.39499726472550023, 'f1-score': 0.5241528504813207, 'support': 550219}, '2': {'precision': 0.3857478655161432, 'recall': 0.5531162612692931, 'f1-score': 0.4545139410053534, 'support': 229939}, 'accuracy': 0.4834188145938204, 'macro avg': {'precision': 0.5075515805262362, 'recall': 0.524579672120602, 'f1-score': 0.47805124928554665, 'support': 1009578}, 'weighted avg': {'precision': 0.5936813758337628, 'recall': 0.4834188145938204, 'f1-score': 0.4926881883818876, 'support': 1009578}}
[[143531  28111  57778]
 [188140 217335 144744]
 [ 69140  33616 127183]]
Evaluating performance on  val set...
1402/1402 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0161694
{'0': {'precision': 0.3466645719203814, 'recall': 0.6157532667645381, 'f1-score': 0.44359078573020594, 'support': 82421}, '1': {'precision': 0.776781394511516, 'recall': 0.35760052626399186, 'f1-score': 0.4897423528744113, 'support': 193059}, '2': {'precision': 0.38698187318548877, 'recall': 0.574974021894106, 'f1-score': 0.4626085773031512, 'support': 82762}, 'accuracy': 0.4672121080163688, 'macro avg': {'precision': 0.5034759465391287, 'recall': 0.5161092716408787, 'f1-score': 0.4653139053025895, 'support': 358242}, 'weighted avg': {'precision': 0.5877716005209493, 'recall': 0.4672121080163688, 'f1-score': 0.4728557124206924, 'support': 358242}}
[[50751  9161 22509]
 [71149 69038 52872]
 [24498 10678 47586]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1169084
{'0': {'precision': 0.39575318141461974, 'recall': 0.6364069006543724, 'f1-score': 0.4880251813329684, 'support': 25215}, '1': {'precision': 0.43480885311871226, 'recall': 0.09576778196321738, 'f1-score': 0.1569638641728709, 'support': 22565}, '2': {'precision': 0.4609123794212219, 'recall': 0.49869536855838226, 'f1-score': 0.4790600522193212, 'support': 27594}, 'accuracy': 0.4241382970254995, 'macro avg': {'precision': 0.4304914713181846, 'recall': 0.41029001705865736, 'f1-score': 0.3746830325750535, 'support': 75374}, 'weighted avg': {'precision': 0.4312998439480799, 'recall': 0.4241382970254995, 'f1-score': 0.3856320166544376, 'support': 75374}}
[[16047  1272  7896]
 [12205  2161  8199]
 [12296  1537 13761]]
Evaluating performance on  train set...
200/200 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.113243
{'0': {'precision': 0.42168730364073187, 'recall': 0.5210962032543535, 'f1-score': 0.4661508210117725, 'support': 17515}, '1': {'precision': 0.44719642242862057, 'recall': 0.2369092455351719, 'f1-score': 0.3097327562244371, 'support': 16462}, '2': {'precision': 0.42684453862454247, 'recall': 0.5167327425373134, 'f1-score': 0.4675071210043253, 'support': 17152}, 'accuracy': 0.4281327622288721, 'macro avg': {'precision': 0.4319094215646317, 'recall': 0.42491273044227956, 'f1-score': 0.4144635660801783, 'support': 51129}, 'weighted avg': {'precision': 0.4316305454003701, 'recall': 0.4281327622288721, 'f1-score': 0.41624390076970147, 'support': 51129}}
[[9127 2496 5892]
 [6553 3900 6009]
 [5964 2325 8863]]
Evaluating performance on  val set...
53/53 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1271131
{'0': {'precision': 0.38771619229197873, 'recall': 0.6438263229308006, 'f1-score': 0.4839779005524862, 'support': 4422}, '1': {'precision': 0.5445544554455446, 'recall': 0.10522959183673469, 'f1-score': 0.17637626937466594, 'support': 4704}, '2': {'precision': 0.42635807192042846, 'recall': 0.5119430408819476, 'f1-score': 0.4652473387601753, 'support': 4354}, 'accuracy': 0.4132789317507418, 'macro avg': {'precision': 0.45287623988598397, 'recall': 0.4203329852164943, 'f1-score': 0.37520050289577583, 'support': 13480}, 'weighted avg': {'precision': 0.4549279084475161, 'recall': 0.4132789317507418, 'f1-score': 0.37058688133110723, 'support': 13480}}
[[2847  196 1379]
 [2589  495 1620]
 [1907  218 2229]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0444043
{'0': {'precision': 0.18566797130906587, 'recall': 0.7444601603017444, 'f1-score': 0.29721154104708386, 'support': 29694}, '1': {'precision': 0.8934932751726645, 'recall': 0.2724487579085512, 'f1-score': 0.4175698724526199, 'support': 225547}, '2': {'precision': 0.21390358014646055, 'recall': 0.6802626471729849, 'f1-score': 0.325466588257142, 'support': 30916}, 'accuracy': 0.36548817607117773, 'macro avg': {'precision': 0.43102160887606367, 'recall': 0.5657238551277602, 'f1-score': 0.3467493339189485, 'support': 286157}, 'weighted avg': {'precision': 0.7466215942969361, 'recall': 0.36548817607117773, 'f1-score': 0.39512979435932366, 'support': 286157}}
[[22106  3069  4519]
 [91327 61450 72770]
 [ 5629  4256 21031]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87493724
{'0': {'precision': 0.28887785211370476, 'recall': 0.6357615894039735, 'f1-score': 0.3972520188019766, 'support': 15553}, '1': {'precision': 0.8937045238848466, 'recall': 0.5746541903986981, 'f1-score': 0.6995171474557386, 'support': 98320}, '2': {'precision': 0.3071014857718459, 'recall': 0.6358185610010427, 'f1-score': 0.41416199694345385, 'support': 15344}, 'accuracy': 0.589272309371058, 'macro avg': {'precision': 0.4965612872567991, 'recall': 0.6154114469345714, 'f1-score': 0.5036437210670563, 'support': 129217}, 'weighted avg': {'precision': 0.7512487615403993, 'recall': 0.589272309371058, 'f1-score': 0.6292507043761711, 'support': 129217}}
[[ 9888  3338  2327]
 [22135 56500 19685]
 [ 2206  3382  9756]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8637756
{'0': {'precision': 0.27856535299121066, 'recall': 0.6928772919605077, 'f1-score': 0.39737108190091, 'support': 5672}, '1': {'precision': 0.900890772290928, 'recall': 0.5728820084142217, 'f1-score': 0.7003849192341955, 'support': 36367}, '2': {'precision': 0.3374610076566783, 'recall': 0.6182888811915483, 'f1-score': 0.4366171344707393, 'support': 5774}, 'accuracy': 0.5926003388199862, 'macro avg': {'precision': 0.5056390443129389, 'recall': 0.6280160605220926, 'f1-score': 0.5114577118686149, 'support': 47813}, 'weighted avg': {'precision': 0.7590240573961053, 'recall': 0.5926003388199862, 'f1-score': 0.6325855827654822, 'support': 47813}}
[[ 3930  1032   710]
 [ 9234 20834  6299]
 [  944  1260  3570]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.078982
{'0': {'precision': 0.4472059630510335, 'recall': 0.49134574321099306, 'f1-score': 0.4682379134098608, 'support': 39807}, '1': {'precision': 0.5409582689335394, 'recall': 0.4045094182769318, 'f1-score': 0.4628877700178658, 'support': 49319}, '2': {'precision': 0.4186499878157745, 'recall': 0.5061252547074854, 'f1-score': 0.458250441779566, 'support': 40733}, 'accuracy': 0.4630021792867649, 'macro avg': {'precision': 0.4689380732667825, 'recall': 0.46732680539847005, 'f1-score': 0.4631253750690975, 'support': 129859}, 'weighted avg': {'precision': 0.4738548625078405, 'recall': 0.4630021792867649, 'f1-score': 0.4630732085848845, 'support': 129859}}
[[19559  8452 11796]
 [12537 19950 16832]
 [11640  8477 20616]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1361842
{'0': {'precision': 0.4184660445473742, 'recall': 0.5460403519687139, 'f1-score': 0.4738161345056302, 'support': 22502}, '1': {'precision': 0.4647143951647229, 'recall': 0.2444912217843067, 'f1-score': 0.3204108584005869, 'support': 22328}, '2': {'precision': 0.4302717791648897, 'recall': 0.5028089887640449, 'f1-score': 0.4637208816462969, 'support': 22072}, 'accuracy': 0.4311380825685331, 'macro avg': {'precision': 0.43781740629232885, 'recall': 0.4311135208390218, 'f1-score': 0.4193159581841714, 'support': 66902}, 'weighted avg': {'precision': 0.4377959501863979, 'recall': 0.4311380825685331, 'f1-score': 0.4192877881783962, 'support': 66902}}
[[12287  3024  7191]
 [ 9365  5459  7504]
 [ 7710  3264 11098]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1446491
{'0': {'precision': 0.43285920925747345, 'recall': 0.5503448275862068, 'f1-score': 0.4845826867282909, 'support': 6525}, '1': {'precision': 0.42970927917164475, 'recall': 0.19483568075117372, 'f1-score': 0.26810783948316563, 'support': 5538}, '2': {'precision': 0.4430992736077482, 'recall': 0.5275375512061903, 'f1-score': 0.48164565729325387, 'support': 6591}, 'accuracy': 0.43674278975018765, 'macro avg': {'precision': 0.43522258734562214, 'recall': 0.42423935318119027, 'f1-score': 0.41144539450157014, 'support': 18654}, 'weighted avg': {'precision': 0.43554217008717977, 'recall': 0.43674278975018765, 'f1-score': 0.4192778907033186, 'support': 18654}}
[[3591  693 2241]
 [2330 1079 2129]
 [2375  739 3477]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3262722
{'0': {'precision': 0.35416550648772066, 'recall': 0.5182431193595045, 'f1-score': 0.42077492453376336, 'support': 49087}, '1': {'precision': 0.3343548881397487, 'recall': 0.018315202793446145, 'f1-score': 0.034728080087854725, 'support': 59568}, '2': {'precision': 0.3221845412942348, 'recall': 0.5585156369517232, 'f1-score': 0.4086410080110011, 'support': 45757}, 'accuracy': 0.3373183431339533, 'macro avg': {'precision': 0.3369016453072347, 'recall': 0.3650246530348913, 'f1-score': 0.28804800421087307, 'support': 154412}, 'weighted avg': {'precision': 0.3370461638322902, 'recall': 0.3373183431339533, 'f1-score': 0.26825277568337663, 'support': 154412}}
[[25439  1063 22585]
 [27297  1091 31180]
 [19092  1109 25556]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2632128
{'0': {'precision': 0.38187839673913043, 'recall': 0.46671971217048364, 'f1-score': 0.42005791325466263, 'support': 28906}, '1': {'precision': 0.3410184950595389, 'recall': 0.04869049341629287, 'f1-score': 0.08521414326865247, 'support': 27644}, '2': {'precision': 0.34384225092250925, 'recall': 0.571554533256661, 'f1-score': 0.42937576499388014, 'support': 26085}, 'accuracy': 0.35996853633448295, 'macro avg': {'precision': 0.35557971424039286, 'recall': 0.3623215796144792, 'f1-score': 0.31154927383906506, 'support': 82635}, 'weighted avg': {'precision': 0.35620278730417926, 'recall': 0.35996853633448295, 'f1-score': 0.31098348940428716, 'support': 82635}}
[[13491  1345 14070]
 [11917  1346 14381]
 [ 9920  1256 14909]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2385366
{'0': {'precision': 0.40526566974228445, 'recall': 0.48220707931099754, 'f1-score': 0.4404010718298902, 'support': 10566}, '1': {'precision': 0.23505654281098545, 'recall': 0.036589966050546964, 'f1-score': 0.06332281579806333, 'support': 7953}, '2': {'precision': 0.3733078080131273, 'recall': 0.5505697287486135, 'f1-score': 0.4449333822271116, 'support': 9917}, 'accuracy': 0.38141792094528065, 'macro avg': {'precision': 0.3378766735221324, 'recall': 0.35645559137005267, 'f1-score': 0.31621908995168835, 'support': 28436}, 'weighted avg': {'precision': 0.3465162218152668, 'recall': 0.38141792094528065, 'f1-score': 0.3365202008208919, 'support': 28436}}
[[5095  472 4999]
 [3495  291 4167]
 [3982  475 5460]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1526592
{'0': {'precision': 0.4602040313439456, 'recall': 0.4657356608478803, 'f1-score': 0.46295332292208924, 'support': 60150}, '1': {'precision': 0.3766847137426564, 'recall': 0.07431311501488534, 'f1-score': 0.12413636018525548, 'support': 44003}, '2': {'precision': 0.40775334045382217, 'recall': 0.6545883999650074, 'f1-score': 0.5024948122678952, 'support': 57155}, 'accuracy': 0.4258747241302353, 'macro avg': {'precision': 0.4148806951801414, 'recall': 0.398212391942591, 'f1-score': 0.3631948317917466, 'support': 161308}, 'weighted avg': {'precision': 0.4188364626540199, 'recall': 0.4258747241302353, 'f1-score': 0.3845383094835161, 'support': 161308}}
[[28014  3251 28885]
 [15277  3270 25456]
 [17582  2160 37413]]
Evaluating performance on  train set...
477/477 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1390023
{'0': {'precision': 0.4134941575574821, 'recall': 0.5643695337955363, 'f1-score': 0.47729250404011103, 'support': 40819}, '1': {'precision': 0.47327357237715806, 'recall': 0.2147214621042854, 'f1-score': 0.295414903721613, 'support': 39833}, '2': {'precision': 0.43089768620446145, 'recall': 0.5025800043605707, 'f1-score': 0.46398658093374334, 'support': 41279}, 'accuracy': 0.4292263657314383, 'macro avg': {'precision': 0.43922180537970057, 'recall': 0.4272236667534641, 'f1-score': 0.4122313295651558, 'support': 121931}, 'weighted avg': {'precision': 0.4389150405940423, 'recall': 0.4292263657314383, 'f1-score': 0.4133712235339684, 'support': 121931}}
[[23037  4618 13164]
 [17044  8553 14236]
 [15632  4901 20746]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.137211
{'0': {'precision': 0.4194121953770526, 'recall': 0.5201037613488976, 'f1-score': 0.4643622256962539, 'support': 15420}, '1': {'precision': 0.5129453189726595, 'recall': 0.3020121951219512, 'f1-score': 0.3801811482959779, 'support': 16400}, '2': {'precision': 0.41857766480632147, 'recall': 0.503155097974095, 'f1-score': 0.45698600386100385, 'support': 15055}, 'accuracy': 0.4383573333333333, 'macro avg': {'precision': 0.4503117263853445, 'recall': 0.4417570181483146, 'f1-score': 0.4338431259510786, 'support': 46875}, 'weighted avg': {'precision': 0.4518682885871987, 'recall': 0.4383573333333333, 'f1-score': 0.4325410269955773, 'support': 46875}}
[[8020 2280 5120]
 [6045 4953 5402]
 [5057 2423 7575]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
2354/2354 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0201993
{'0': {'precision': 0.26164238355538005, 'recall': 0.8196853675053394, 'f1-score': 0.3966686938519567, 'support': 76788}, '1': {'precision': 0.9193362924863067, 'recall': 0.33016364980584484, 'f1-score': 0.48584464144822276, 'support': 450413}, '2': {'precision': 0.270725136084855, 'recall': 0.7204080818291856, 'f1-score': 0.3935547158843191, 'support': 75181}, 'accuracy': 0.4412698254595921, 'macro avg': {'precision': 0.48390127070884725, 'recall': 0.6234190330467899, 'f1-score': 0.42535601706149956, 'support': 602382}, 'weighted avg': {'precision': 0.7545467814643877, 'recall': 0.4412698254595921, 'f1-score': 0.4629586794542689, 'support': 602382}}
[[ 62942   4542   9304]
 [165109 148710 136594]
 [ 12514   8506  54161]]
Evaluating performance on  train set...
1250/1250 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96251667
{'0': {'precision': 0.27846898529939046, 'recall': 0.7953201402933873, 'f1-score': 0.41250556031363494, 'support': 39061}, '1': {'precision': 0.9225051979941857, 'recall': 0.40766656272736723, 'f1-score': 0.5654525742756966, 'support': 240525}, '2': {'precision': 0.3012953672493533, 'recall': 0.7626050941196895, 'f1-score': 0.43193774275339414, 'support': 40321}, 'accuracy': 0.49973586073452597, 'macro avg': {'precision': 0.5007565168476432, 'recall': 0.6551972657134814, 'f1-score': 0.46996529244757523, 'support': 319907}, 'weighted avg': {'precision': 0.7655705260753662, 'recall': 0.49973586073452597, 'f1-score': 0.5299493973080691, 'support': 319907}}
[[31066  3422  4573]
 [75737 98054 66734]
 [ 4757  4815 30749]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.010314
{'0': {'precision': 0.2438781008641507, 'recall': 0.779287035265608, 'f1-score': 0.371496321517602, 'support': 15681}, '1': {'precision': 0.9222415407248896, 'recall': 0.3626629079931418, 'f1-score': 0.5206033792863938, 'support': 95069}, '2': {'precision': 0.3050834462136121, 'recall': 0.752221311991934, 'f1-score': 0.43410429849443594, 'support': 15869}, 'accuracy': 0.46308215986542306, 'macro avg': {'precision': 0.49040102926755075, 'recall': 0.6313904184168946, 'f1-score': 0.44206799976614386, 'support': 126619}, 'weighted avg': {'precision': 0.7608826696055812, 'recall': 0.46308215986542306, 'f1-score': 0.49129654787910104, 'support': 126619}}
[[12220  1093  2368]
 [35769 34478 24822]
 [ 2118  1814 11937]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
3870/3870 - 60s - 60s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2489941
{'0': {'precision': 0.24279469029110753, 'recall': 0.7268269077987548, 'f1-score': 0.3639970774617321, 'support': 138458}, '1': {'precision': 0.8821450362367368, 'recall': 0.16460965345263037, 'f1-score': 0.2774472187996204, 'support': 720219}, '2': {'precision': 0.22465585376784106, 'recall': 0.7518273607986609, 'f1-score': 0.3459402375927743, 'support': 132021}, 'accuracy': 0.32143700703948125, 'macro avg': {'precision': 0.4498651934318951, 'recall': 0.5477546406833487, 'f1-score': 0.32912817795137556, 'support': 990698}, 'weighted avg': {'precision': 0.7051732955471766, 'recall': 0.32143700703948125, 'f1-score': 0.2986706765685163, 'support': 990698}}
[[100635   7823  30000]
 [289103 118555 312561]
 [ 24748   8016  99257]]
Evaluating performance on  train set...
1577/1577 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9390278
{'0': {'precision': 0.2503584578028518, 'recall': 0.7104418409699647, 'f1-score': 0.3702436893307334, 'support': 48909}, '1': {'precision': 0.9045312168188575, 'recall': 0.4438012008179107, 'f1-score': 0.5954496605593563, 'support': 307124}, '2': {'precision': 0.2738417826418668, 'recall': 0.6577290056237757, 'f1-score': 0.3866881307658968, 'support': 47477}, 'accuracy': 0.5012911699833957, 'macro avg': {'precision': 0.4762438190878588, 'recall': 0.6039906824705503, 'f1-score': 0.4507938268853288, 'support': 403510}, 'weighted avg': {'precision': 0.7510327217700734, 'recall': 0.5012911699833957, 'f1-score': 0.5435898057928702, 'support': 403510}}
[[ 34747   6434   7728]
 [ 95744 136302  75078]
 [  8298   7952  31227]]
Evaluating performance on  val set...
600/600 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9727416
{'0': {'precision': 0.21720992227665356, 'recall': 0.7131571469167377, 'f1-score': 0.33299718698582875, 'support': 17595}, '1': {'precision': 0.9226572722697534, 'recall': 0.38860955901679656, 'f1-score': 0.546880966017564, 'support': 117941}, '2': {'precision': 0.2743772551406338, 'recall': 0.704644412191582, 'f1-score': 0.39496245306633293, 'support': 17914}, 'accuracy': 0.4627174975562072, 'macro avg': {'precision': 0.4714148165623469, 'recall': 0.6021370393750388, 'f1-score': 0.42494686868990855, 'support': 153450}, 'weighted avg': {'precision': 0.7660874817843858, 'recall': 0.4627174975562072, 'f1-score': 0.5046212505853597, 'support': 153450}}
[[12548  1712  3335]
 [42060 45833 30048]
 [ 3161  2130 12623]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0019441
{'0': {'precision': 0.45339016684923245, 'recall': 0.5914899345538895, 'f1-score': 0.5133138620534712, 'support': 193136}, '1': {'precision': 0.5802777971213233, 'recall': 0.4331075732254376, 'f1-score': 0.49600619046201827, 'support': 250118}, '2': {'precision': 0.45984504011786276, 'recall': 0.47135321885847453, 'f1-score': 0.4655280177906063, 'support': 184087}, 'accuracy': 0.493090679550675, 'macro avg': {'precision': 0.4978376680294729, 'recall': 0.4986502422126005, 'f1-score': 0.49161602343536526, 'support': 627341}, 'weighted avg': {'precision': 0.5058738058331298, 'recall': 0.493090679550675, 'f1-score': 0.492391089724022, 'support': 627341}}
[[114238  35816  43082]
 [ 82948 108328  58842]
 [ 54778  42539  86770]]
Evaluating performance on  train set...
1200/1200 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9493126
{'0': {'precision': 0.4921209123045687, 'recall': 0.5195412804108456, 'f1-score': 0.505459491788268, 'support': 91908}, '1': {'precision': 0.6322860326970462, 'recall': 0.4997333333333333, 'f1-score': 0.558249118736939, 'support': 123750}, '2': {'precision': 0.47300812428734323, 'recall': 0.5807248944593915, 'f1-score': 0.5213608915508862, 'support': 91434}, 'accuracy': 0.5297760931577508, 'macro avg': {'precision': 0.5324716897629861, 'recall': 0.5333331694011901, 'f1-score': 0.528356500692031, 'support': 307092}, 'weighted avg': {'precision': 0.5429131015801021, 'recall': 0.5297760931577508, 'f1-score': 0.5314668280939786, 'support': 307092}}
[[47750 17946 26212]
 [28962 61842 32946]
 [20317 18019 53098]]
Evaluating performance on  val set...
441/441 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9373324
{'0': {'precision': 0.4833538840937115, 'recall': 0.5657871947347151, 'f1-score': 0.5213320566017661, 'support': 34642}, '1': {'precision': 0.6372120526532291, 'recall': 0.5477832294567475, 'f1-score': 0.5891231489624682, 'support': 45246}, '2': {'precision': 0.49666546503244413, 'recall': 0.5033489618218352, 'f1-score': 0.49998487918468565, 'support': 32846}, 'accuracy': 0.540369365054021, 'macro avg': {'precision': 0.5390771339264616, 'recall': 0.5389731286710993, 'f1-score': 0.5368133615829733, 'support': 112734}, 'weighted avg': {'precision': 0.5489835865983467, 'recall': 0.540369365054021, 'f1-score': 0.5423204573993152, 'support': 112734}}
[[19600  6973  8069]
 [11775 24785  8686]
 [ 9175  7138 16533]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
3337/3337 - 51s - 51s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9340679
{'0': {'precision': 0.41135970583261044, 'recall': 0.6973825379208287, 'f1-score': 0.5174783900733313, 'support': 216240}, '1': {'precision': 0.717233778191564, 'recall': 0.4932570330945616, 'f1-score': 0.5845242312745653, 'support': 424813}, '2': {'precision': 0.4964460194393519, 'recall': 0.4551998422298186, 'f1-score': 0.47492908617927604, 'support': 212968}, 'accuracy': 0.5354517043491904, 'macro avg': {'precision': 0.5416798344878421, 'recall': 0.5486131377484029, 'f1-score': 0.5256439025090576, 'support': 854021}, 'weighted avg': {'precision': 0.584727742844844, 'recall': 0.5354517043491904, 'f1-score': 0.540218234628103, 'support': 854021}}
[[150802  33781  31657]
 [148597 209542  66674]
 [ 67195  48830  96943]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9865399
{'0': {'precision': 0.4148624926857812, 'recall': 0.6472937045397542, 'f1-score': 0.5056466844831776, 'support': 99675}, '1': {'precision': 0.7037210390826117, 'recall': 0.38393769152196117, 'f1-score': 0.4968194960760017, 'support': 164472}, '2': {'precision': 0.45876015688351235, 'recall': 0.5437774007198972, 'f1-score': 0.49766396036137933, 'support': 101959}, 'accuracy': 0.500152961164253, 'macro avg': {'precision': 0.5257812295506351, 'recall': 0.5250029322605375, 'f1-score': 0.5000433803068528, 'support': 366106}, 'weighted avg': {'precision': 0.5568566276819735, 'recall': 0.500152961164253, 'f1-score': 0.4994579416042314, 'support': 366106}}
[[64519 11492 23664]
 [59578 63147 41747]
 [31422 15094 55443]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9924737
{'0': {'precision': 0.43856579045349614, 'recall': 0.612548428196261, 'f1-score': 0.5111581231353404, 'support': 38459}, '1': {'precision': 0.6368661837590546, 'recall': 0.34460351514151333, 'f1-score': 0.4472197681578454, 'support': 48476}, '2': {'precision': 0.47348212143028556, 'recall': 0.5586645387149918, 'f1-score': 0.5125583043041861, 'support': 38848}, 'accuracy': 0.49264208994856223, 'macro avg': {'precision': 0.5163046985476121, 'recall': 0.5052721606842554, 'f1-score': 0.49031206519912396, 'support': 125783}, 'weighted avg': {'precision': 0.5257734376845732, 'recall': 0.49264208994856223, 'f1-score': 0.48694911668898655, 'support': 125783}}
[[23558  4413 10488]
 [18125 16705 13646]
 [12033  5112 21703]]
testing model on single stock: results/universal/W9/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
10303/10303 - 144s - 144s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1926854
{'0': {'precision': 0.36684168684945184, 'recall': 0.6944944505825926, 'f1-score': 0.48009204016312695, 'support': 857117}, '1': {'precision': 0.3919921715730246, 'recall': 0.005273985002002293, 'f1-score': 0.010407938353480178, 'support': 911455}, '2': {'precision': 0.4163681542907476, 'recall': 0.4804116330890207, 'f1-score': 0.4461030629459794, 'support': 868832}, 'accuracy': 0.38578352046178743, 'macro avg': {'precision': 0.3917340042377413, 'recall': 0.3933933562245386, 'f1-score': 0.3122010138208622, 'support': 2637404}, 'weighted avg': {'precision': 0.3918487448556124, 'recall': 0.38578352046178743, 'f1-score': 0.30657799602410224, 'support': 2637404}}
[[595263   3489 258365]
 [579939   4807 326709]
 [447468   3967 417397]]
Evaluating performance on  train set...
3419/3419 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1436436
{'0': {'precision': 0.3611513088785243, 'recall': 0.7452381282688012, 'f1-score': 0.48652620210187403, 'support': 288332}, '1': {'precision': 0.40956759735156767, 'recall': 0.15703944861981783, 'f1-score': 0.22702954408329729, 'support': 288730}, '2': {'precision': 0.431162669939577, 'recall': 0.24512566590180213, 'f1-score': 0.31255614204686416, 'support': 298092}, 'accuracy': 0.3808335447246999, 'macro avg': {'precision': 0.40062719205655634, 'recall': 0.3824677475968071, 'f1-score': 0.3420372960773452, 'support': 875154}, 'weighted avg': {'precision': 0.4009717994575917, 'recall': 0.3808335447246999, 'f1-score': 0.3416562098358024, 'support': 875154}}
[[214876  25440  48016]
 [195002  45342  48386]
 [185097  39925  73070]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1466224
{'0': {'precision': 0.3636945246273715, 'recall': 0.8050577425609037, 'f1-score': 0.5010387593645731, 'support': 118630}, '1': {'precision': 0.4070787363804564, 'recall': 0.19569926124805428, 'f1-score': 0.2643261973491738, 'support': 121421}, '2': {'precision': 0.4477134986225895, 'recall': 0.1386511965192168, 'f1-score': 0.21173175259746602, 'support': 117215}, 'accuracy': 0.37931961059826574, 'macro avg': {'precision': 0.40616225321013916, 'recall': 0.3798027334427249, 'f1-score': 0.3256989031037376, 'support': 357266}, 'weighted avg': {'precision': 0.4060048435833337, 'recall': 0.37931961059826574, 'f1-score': 0.32567083521092216, 'support': 357266}}
[[95504 14376  8750]
 [86361 23762 11298]
 [80729 20234 16252]]
training model: results/universal/W9/deepOF_L2/h10
Epoch 1/50
6697/6697 - 157s - loss: 2.6834 - accuracy10: 0.5724 - val_loss: 2.8201 - val_accuracy10: 0.5528 - 157s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 153s - loss: 2.5813 - accuracy10: 0.5923 - val_loss: 2.7661 - val_accuracy10: 0.5616 - 153s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 152s - loss: 2.5493 - accuracy10: 0.5976 - val_loss: 2.7488 - val_accuracy10: 0.5599 - 152s/epoch - 23ms/step
Epoch 4/50
6697/6697 - 152s - loss: 2.5316 - accuracy10: 0.6005 - val_loss: 2.7280 - val_accuracy10: 0.5594 - 152s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 151s - loss: 2.5200 - accuracy10: 0.6027 - val_loss: 2.7216 - val_accuracy10: 0.5599 - 151s/epoch - 23ms/step
Epoch 6/50
6697/6697 - 152s - loss: 2.5114 - accuracy10: 0.6040 - val_loss: 2.7160 - val_accuracy10: 0.5586 - 152s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 152s - loss: 2.5049 - accuracy10: 0.6053 - val_loss: 2.7155 - val_accuracy10: 0.5594 - 152s/epoch - 23ms/step
Epoch 8/50
6697/6697 - 151s - loss: 2.4995 - accuracy10: 0.6064 - val_loss: 2.7027 - val_accuracy10: 0.5626 - 151s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 152s - loss: 2.4946 - accuracy10: 0.6073 - val_loss: 2.6966 - val_accuracy10: 0.5626 - 152s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 151s - loss: 2.4901 - accuracy10: 0.6083 - val_loss: 2.6982 - val_accuracy10: 0.5619 - 151s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 150s - loss: 2.4863 - accuracy10: 0.6088 - val_loss: 2.7028 - val_accuracy10: 0.5612 - 150s/epoch - 22ms/step
Epoch 12/50
6697/6697 - 152s - loss: 2.4826 - accuracy10: 0.6095 - val_loss: 2.6923 - val_accuracy10: 0.5624 - 152s/epoch - 23ms/step
Epoch 13/50
6697/6697 - 152s - loss: 2.4795 - accuracy10: 0.6099 - val_loss: 2.7006 - val_accuracy10: 0.5599 - 152s/epoch - 23ms/step
Epoch 14/50
6697/6697 - 151s - loss: 2.4770 - accuracy10: 0.6105 - val_loss: 2.6951 - val_accuracy10: 0.5615 - 151s/epoch - 23ms/step
Epoch 15/50
6697/6697 - 152s - loss: 2.4738 - accuracy10: 0.6106 - val_loss: 2.6938 - val_accuracy10: 0.5608 - 152s/epoch - 23ms/step
Epoch 16/50
6697/6697 - 151s - loss: 2.4717 - accuracy10: 0.6114 - val_loss: 2.6908 - val_accuracy10: 0.5636 - 151s/epoch - 23ms/step
Epoch 17/50
6697/6697 - 151s - loss: 2.4689 - accuracy10: 0.6117 - val_loss: 2.6819 - val_accuracy10: 0.5633 - 151s/epoch - 23ms/step
Epoch 18/50
6697/6697 - 151s - loss: 2.4665 - accuracy10: 0.6122 - val_loss: 2.6891 - val_accuracy10: 0.5629 - 151s/epoch - 23ms/step
Epoch 19/50
6697/6697 - 151s - loss: 2.4649 - accuracy10: 0.6124 - val_loss: 2.6824 - val_accuracy10: 0.5646 - 151s/epoch - 23ms/step
Epoch 20/50
6697/6697 - 152s - loss: 2.4623 - accuracy10: 0.6132 - val_loss: 2.6810 - val_accuracy10: 0.5646 - 152s/epoch - 23ms/step
Epoch 21/50
6697/6697 - 151s - loss: 2.4607 - accuracy10: 0.6132 - val_loss: 2.6885 - val_accuracy10: 0.5607 - 151s/epoch - 23ms/step
Epoch 22/50
6697/6697 - 152s - loss: 2.4583 - accuracy10: 0.6136 - val_loss: 2.6786 - val_accuracy10: 0.5644 - 152s/epoch - 23ms/step
Epoch 23/50
6697/6697 - 151s - loss: 2.4566 - accuracy10: 0.6140 - val_loss: 2.6763 - val_accuracy10: 0.5633 - 151s/epoch - 23ms/step
Epoch 24/50
6697/6697 - 151s - loss: 2.4549 - accuracy10: 0.6142 - val_loss: 2.6775 - val_accuracy10: 0.5633 - 151s/epoch - 23ms/step
Epoch 25/50
6697/6697 - 152s - loss: 2.4533 - accuracy10: 0.6145 - val_loss: 2.6725 - val_accuracy10: 0.5631 - 152s/epoch - 23ms/step
Epoch 26/50
6697/6697 - 153s - loss: 2.4514 - accuracy10: 0.6149 - val_loss: 2.6735 - val_accuracy10: 0.5640 - 153s/epoch - 23ms/step
Epoch 27/50
6697/6697 - 153s - loss: 2.4494 - accuracy10: 0.6151 - val_loss: 2.6745 - val_accuracy10: 0.5639 - 153s/epoch - 23ms/step
Epoch 28/50
6697/6697 - 153s - loss: 2.4477 - accuracy10: 0.6157 - val_loss: 2.6736 - val_accuracy10: 0.5628 - 153s/epoch - 23ms/step
Epoch 29/50
6697/6697 - 154s - loss: 2.4463 - accuracy10: 0.6155 - val_loss: 2.6741 - val_accuracy10: 0.5657 - 154s/epoch - 23ms/step
Epoch 30/50
6697/6697 - 154s - loss: 2.4445 - accuracy10: 0.6157 - val_loss: 2.6688 - val_accuracy10: 0.5666 - 154s/epoch - 23ms/step
Epoch 31/50
6697/6697 - 154s - loss: 2.4429 - accuracy10: 0.6161 - val_loss: 2.6759 - val_accuracy10: 0.5647 - 154s/epoch - 23ms/step
Epoch 32/50
6697/6697 - 153s - loss: 2.4413 - accuracy10: 0.6164 - val_loss: 2.6730 - val_accuracy10: 0.5657 - 153s/epoch - 23ms/step
Epoch 33/50
6697/6697 - 153s - loss: 2.4402 - accuracy10: 0.6166 - val_loss: 2.6756 - val_accuracy10: 0.5620 - 153s/epoch - 23ms/step
Epoch 34/50
6697/6697 - 157s - loss: 2.4385 - accuracy10: 0.6168 - val_loss: 2.6729 - val_accuracy10: 0.5653 - 157s/epoch - 23ms/step
Epoch 35/50
6697/6697 - 151s - loss: 2.4375 - accuracy10: 0.6173 - val_loss: 2.6745 - val_accuracy10: 0.5627 - 151s/epoch - 23ms/step
Epoch 36/50
6697/6697 - 152s - loss: 2.4358 - accuracy10: 0.6173 - val_loss: 2.6754 - val_accuracy10: 0.5629 - 152s/epoch - 23ms/step
Epoch 37/50
6697/6697 - 154s - loss: 2.4342 - accuracy10: 0.6174 - val_loss: 2.6852 - val_accuracy10: 0.5629 - 154s/epoch - 23ms/step
Epoch 38/50
6697/6697 - 153s - loss: 2.4326 - accuracy10: 0.6178 - val_loss: 2.6856 - val_accuracy10: 0.5613 - 153s/epoch - 23ms/step
Epoch 39/50
6697/6697 - 152s - loss: 2.4319 - accuracy10: 0.6179 - val_loss: 2.6764 - val_accuracy10: 0.5662 - 152s/epoch - 23ms/step
Epoch 40/50
6697/6697 - 152s - loss: 2.4303 - accuracy10: 0.6184 - val_loss: 2.6737 - val_accuracy10: 0.5651 - 152s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 129s - 129s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9415986
{'0': {'precision': 0.410559619624987, 'recall': 0.5607420588771035, 'f1-score': 0.4740402523659804, 'support': 1070535}, '1': {'precision': 0.8213843602826643, 'recall': 0.4969072544802207, 'f1-score': 0.6192132951015752, 'support': 2171210}, '2': {'precision': 0.41830294026649467, 'recall': 0.6012171519544887, 'f1-score': 0.49335153729701936, 'support': 1065931}, 'accuracy': 0.5385827532061371, 'macro avg': {'precision': 0.5500823067247153, 'recall': 0.5529554884372709, 'f1-score': 0.5288683615881916, 'support': 4307676}, 'weighted avg': {'precision': 0.6195448429050291, 'recall': 0.5385827532061371, 'f1-score': 0.551990789819535, 'support': 4307676}}
[[ 600294  122866  347375]
 [ 548513 1078890  543807]
 [ 313329  111746  640856]]
Evaluating performance on  train set...
6697/6697 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8808504
{'0': {'precision': 0.4247752921657642, 'recall': 0.5597264130998828, 'f1-score': 0.4830016025076238, 'support': 416248}, '1': {'precision': 0.8571135873719878, 'recall': 0.566721538412499, 'f1-score': 0.6823047444655213, 'support': 878412}, '2': {'precision': 0.4378789304008004, 'recall': 0.6105561371587188, 'f1-score': 0.509997569827617, 'support': 419339}, 'accuracy': 0.5757471270403308, 'macro avg': {'precision': 0.5732559366461841, 'recall': 0.5790013628903669, 'f1-score': 0.5584346389335874, 'support': 1713999}, 'weighted avg': {'precision': 0.6495513936235429, 'recall': 0.5757471270403308, 'f1-score': 0.5917477181550187, 'support': 1713999}}
[[232985  40536 142727]
 [194649 497815 185948]
 [120856  42453 256030]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8957541
{'0': {'precision': 0.41548985392530763, 'recall': 0.5619730647103909, 'f1-score': 0.47775542604189836, 'support': 164394}, '1': {'precision': 0.8460846440106726, 'recall': 0.5543195749427852, 'f1-score': 0.6698084365728421, 'support': 347812}, '2': {'precision': 0.4312143765074717, 'recall': 0.5975762328907811, 'f1-score': 0.5009444299504304, 'support': 160659}, 'accuracy': 0.5665178007475496, 'macro avg': {'precision': 0.5642629581478172, 'recall': 0.5712896241813191, 'f1-score': 0.5495027641883903, 'support': 672865}, 'weighted avg': {'precision': 0.6418239940614403, 'recall': 0.5665178007475496, 'f1-score': 0.5825667386792468, 'support': 672865}}
[[ 92385  17719  54290]
 [ 82668 192799  72345]
 [ 47299  17354  96006]]
testing model out of sample: results/universal/W9/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6833918
{'0': {'precision': 0.4335196468838459, 'recall': 0.5179220868548435, 'f1-score': 0.47197719470296573, 'support': 348927}, '1': {'precision': 0.8667068691728492, 'recall': 0.7854313890939775, 'f1-score': 0.8240699914616725, 'support': 1516960}, '2': {'precision': 0.45463015252351235, 'recall': 0.5524666066314756, 'f1-score': 0.49879611934757767, 'support': 345353}, 'accuracy': 0.7068346267252763, 'macro avg': {'precision': 0.5849522228600691, 'recall': 0.6186066941934322, 'f1-score': 0.5982811018374052, 'support': 2211240}, 'weighted avg': {'precision': 0.7339928045590426, 'recall': 0.7068346267252763, 'f1-score': 0.7177093110964274, 'support': 2211240}}
[[ 180717   97479   70731]
 [ 167346 1191468  158146]
 [  68797   85760  190796]]
Evaluating performance on  train set...
3947/3947 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71631104
{'0': {'precision': 0.4440961385968736, 'recall': 0.5390066131982553, 'f1-score': 0.4869699635413224, 'support': 177675}, '1': {'precision': 0.858927629370294, 'recall': 0.7652324388993335, 'f1-score': 0.8093774714721499, 'support': 655312}, '2': {'precision': 0.4565371562929857, 'recall': 0.5431770175607491, 'f1-score': 0.49610278106784317, 'support': 176587}, 'accuracy': 0.6865786955686259, 'macro avg': {'precision': 0.5865203080867177, 'recall': 0.6158053565527793, 'f1-score': 0.5974834053604384, 'support': 1009574}, 'weighted avg': {'precision': 0.7155383269591086, 'recall': 0.6865786955686259, 'f1-score': 0.6978413267952515, 'support': 1009574}}
[[ 95768  41539  40368]
 [ 80033 501466  73813]
 [ 39846  40823  95918]]
Evaluating performance on  val set...
1402/1402 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7202377
{'0': {'precision': 0.45282046538669907, 'recall': 0.5362407285700873, 'f1-score': 0.4910126446251388, 'support': 63906}, '1': {'precision': 0.8590688991020015, 'recall': 0.7597144051996028, 'f1-score': 0.8063426599131225, 'support': 229556}, '2': {'precision': 0.46082584375589214, 'recall': 0.5659395791846124, 'f1-score': 0.5080022725068244, 'support': 64779}, 'accuracy': 0.6848099463768804, 'macro avg': {'precision': 0.5909050694148642, 'recall': 0.6206315709847675, 'f1-score': 0.6017858590150286, 'support': 358241}, 'weighted avg': {'precision': 0.7145865554080197, 'recall': 0.6848099463768804, 'f1-score': 0.6961440173434935, 'support': 358241}}
[[ 34269  14601  15036]
 [ 27301 174397  27858]
 [ 14109  14009  36661]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0616577
{'0': {'precision': 0.377840597211549, 'recall': 0.6440400449101796, 'f1-score': 0.47626790285753823, 'support': 21376}, '1': {'precision': 0.6267636823789939, 'recall': 0.32119581077137577, 'f1-score': 0.42473095227886637, 'support': 30841}, '2': {'precision': 0.5014483981149207, 'recall': 0.5009286053643156, 'f1-score': 0.5011883669677196, 'support': 23153}, 'accuracy': 0.46797134138251295, 'macro avg': {'precision': 0.5020175592351546, 'recall': 0.48872148701529033, 'f1-score': 0.4673957407013747, 'support': 75370}, 'weighted avg': {'precision': 0.5176698168475439, 'recall': 0.46797134138251295, 'f1-score': 0.4628346059588545, 'support': 75370}}
[[13767  2620  4989]
 [14393  9906  6542]
 [ 8276  3279 11598]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0154403
{'0': {'precision': 0.4478564091474293, 'recall': 0.5651521353527085, 'f1-score': 0.4997134670487106, 'support': 14658}, '1': {'precision': 0.6981928728255362, 'recall': 0.3735598427687164, 'f1-score': 0.4867108167770419, 'support': 22133}, '2': {'precision': 0.43134802270759165, 'recall': 0.6255057904283522, 'f1-score': 0.5105922551252848, 'support': 14334}, 'accuracy': 0.4991295843520782, 'macro avg': {'precision': 0.5257991015601857, 'recall': 0.5214059228499256, 'f1-score': 0.4990055129836792, 'support': 51125}, 'weighted avg': {'precision': 0.5516034162742539, 'recall': 0.4991295843520782, 'f1-score': 0.4971344722286964, 'support': 51125}}
[[8284 1866 4508]
 [6553 8268 7312]
 [3660 1708 8966]]
Evaluating performance on  val set...
53/53 - 1s - 625ms/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0032958
{'0': {'precision': 0.4251890171110227, 'recall': 0.5835608956854178, 'f1-score': 0.4919429097605893, 'support': 3662}, '1': {'precision': 0.7267100977198697, 'recall': 0.36839498018494055, 'f1-score': 0.4889327197019504, 'support': 6056}, '2': {'precision': 0.4487369985141159, 'recall': 0.6422115895800107, 'f1-score': 0.5283183905532474, 'support': 3762}, 'accuracy': 0.5032640949554896, 'macro avg': {'precision': 0.5335453711150028, 'recall': 0.531389155150123, 'f1-score': 0.5030646733385957, 'support': 13480}, 'weighted avg': {'precision': 0.5672215965031306, 'recall': 0.5032640949554896, 'f1-score': 0.5007422308100599, 'support': 13480}}
[[2137  457 1068]
 [1925 2231 1900]
 [ 964  382 2416]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.44715652
{'0': {'precision': 0.33478854024556615, 'recall': 0.5565256831840345, 'f1-score': 0.41807572724562375, 'support': 17638}, '1': {'precision': 0.9461905303078134, 'recall': 0.8982673603618724, 'f1-score': 0.9216063693928045, 'support': 250254}, '2': {'precision': 0.4923652228108445, 'recall': 0.5191391490060785, 'f1-score': 0.5053978408636545, 'support': 18261}, 'accuracy': 0.8530087051332679, 'macro avg': {'precision': 0.5911147644547413, 'recall': 0.6579773975173285, 'f1-score': 0.6150266458340276, 'support': 286153}, 'weighted avg': {'precision': 0.8795436237895519, 'recall': 0.8530087051332679, 'f1-score': 0.8640090092195308, 'support': 286153}}
[[  9816   6250   1572]
 [ 17257 224795   8202]
 [  2247   6534   9480]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4925392
{'0': {'precision': 0.3737991266375546, 'recall': 0.5521986883130846, 'f1-score': 0.4458139837680657, 'support': 9301}, '1': {'precision': 0.9418065424254987, 'recall': 0.8824321150476053, 'f1-score': 0.9111530838288446, 'support': 110702}, '2': {'precision': 0.4269184958312064, 'recall': 0.544606034295637, 'f1-score': 0.478634109118657, 'support': 9214}, 'accuracy': 0.8345728503215522, 'macro avg': {'precision': 0.5808413882980866, 'recall': 0.659745612552109, 'f1-score': 0.6118670589051891, 'support': 129217}, 'weighted avg': {'precision': 0.8642067263365671, 'recall': 0.8345728503215522, 'f1-score': 0.8468167441626632, 'support': 129217}}
[[ 5136  2985  1180]
 [ 7459 97687  5556]
 [ 1145  3051  5018]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4738604
{'0': {'precision': 0.3894576345022871, 'recall': 0.5330948121645797, 'f1-score': 0.4500943989930774, 'support': 3354}, '1': {'precision': 0.9413408544000827, 'recall': 0.8885306760453302, 'f1-score': 0.914173713108266, 'support': 40944}, '2': {'precision': 0.4412858080034988, 'recall': 0.5744378024480501, 'f1-score': 0.4991343062082613, 'support': 3513}, 'accuracy': 0.8405178724561293, 'macro avg': {'precision': 0.5906947656352896, 'recall': 0.6653544302193201, 'f1-score': 0.621134139436535, 'support': 47811}, 'weighted avg': {'precision': 0.8658831208758224, 'recall': 0.8405178724561293, 'f1-score': 0.8511222091451182, 'support': 47811}}
[[ 1788  1244   322]
 [ 2331 36380  2233]
 [  472  1023  2018]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9803621
{'0': {'precision': 0.46799423690439435, 'recall': 0.4768645956219688, 'f1-score': 0.4723877786867152, 'support': 38145}, '1': {'precision': 0.6632541727604058, 'recall': 0.5457271650685717, 'f1-score': 0.5987781748069286, 'support': 52354}, '2': {'precision': 0.46286787726988105, 'recall': 0.563471897550564, 'f1-score': 0.508239176769876, 'support': 39356}, 'accuracy': 0.5308767471410419, 'macro avg': {'precision': 0.5313720956448937, 'recall': 0.5286878860803682, 'f1-score': 0.5264683767545065, 'support': 129855}, 'weighted avg': {'precision': 0.5451640468618831, 'recall': 0.5308767471410419, 'f1-score': 0.5342106612976161, 'support': 129855}}
[[18190  7713 12242]
 [10291 28571 13492]
 [10387  6793 22176]]
Evaluating performance on  train set...
262/262 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0405327
{'0': {'precision': 0.45906503087162215, 'recall': 0.514121503300256, 'f1-score': 0.48503590112892636, 'support': 22271}, '1': {'precision': 0.5664518482490273, 'recall': 0.40492850623668997, 'f1-score': 0.4722609422916086, 'support': 23009}, '2': {'precision': 0.4550799623706491, 'recall': 0.5369531033206919, 'f1-score': 0.4926380107777825, 'support': 21622}, 'accuracy': 0.48394666826103855, 'macro avg': {'precision': 0.4935322804970996, 'recall': 0.48533437095254595, 'f1-score': 0.48331161806610584, 'support': 66902}, 'weighted avg': {'precision': 0.4947096772186472, 'recall': 0.48394666826103855, 'f1-score': 0.4830992443315171, 'support': 66902}}
[[11450  3658  7163]
 [ 6953  9317  6739]
 [ 6539  3473 11610]]
Evaluating performance on  val set...
73/73 - 1s - 796ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.059142
{'0': {'precision': 0.4728071308616458, 'recall': 0.5372871403405755, 'f1-score': 0.5029890744176458, 'support': 6812}, '1': {'precision': 0.4792626728110599, 'recall': 0.3281404062315125, 'f1-score': 0.3895587030317219, 'support': 5071}, '2': {'precision': 0.4922043010752688, 'recall': 0.5409158050221565, 'f1-score': 0.5154116819141449, 'support': 6770}, 'accuracy': 0.4817455637162923, 'macro avg': {'precision': 0.4814247015826581, 'recall': 0.4687811171980815, 'f1-score': 0.4693198197878375, 'support': 18653}, 'weighted avg': {'precision': 0.48160222524709084, 'recall': 0.4817455637162923, 'f1-score': 0.47666063606742215, 'support': 18653}}
[[3660  951 2201]
 [1830 1664 1577]
 [2251  857 3662]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.283073
{'0': {'precision': 0.37486282626512385, 'recall': 0.5152556612059419, 'f1-score': 0.43398760081374693, 'support': 52374}, '1': {'precision': 0.6143092105263158, 'recall': 0.013890180181855371, 'f1-score': 0.027166106009637238, 'support': 53779}, '2': {'precision': 0.3515756807014519, 'recall': 0.5916278105895763, 'f1-score': 0.44105424153007156, 'support': 48255}, 'accuracy': 0.3645018392829387, 'macro avg': {'precision': 0.4469159058309638, 'recall': 0.3735912173257912, 'f1-score': 0.30073598278448527, 'support': 154408}, 'weighted avg': {'precision': 0.45098236599109437, 'recall': 0.3645018392829387, 'f1-score': 0.29450355580763343, 'support': 154408}}
[[26986   305 25083]
 [25461   747 27571]
 [19542   164 28549]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.234685
{'0': {'precision': 0.4003631019278983, 'recall': 0.4724224700761698, 'f1-score': 0.4334180848242837, 'support': 29408}, '1': {'precision': 0.5977653631284916, 'recall': 0.020566639757044553, 'f1-score': 0.03976512561320053, 'support': 26013}, '2': {'precision': 0.35861731754501586, 'recall': 0.6198647754832072, 'f1-score': 0.4543654801826189, 'support': 27214}, 'accuracy': 0.3787378229563744, 'macro avg': {'precision': 0.4522485942004686, 'recall': 0.3709512951054738, 'f1-score': 0.3091828968733677, 'support': 82635}, 'weighted avg': {'precision': 0.4487560981693852, 'recall': 0.3787378229563744, 'f1-score': 0.3163970645462396, 'support': 82635}}
[[13893   232 15283]
 [10591   535 14887]
 [10217   128 16869]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2104598
{'0': {'precision': 0.42257303279355524, 'recall': 0.4783089251174358, 'f1-score': 0.44871684092283765, 'support': 10857}, '1': {'precision': 0.460431654676259, 'recall': 0.008527648234510327, 'f1-score': 0.01674515960230246, 'support': 7505}, '2': {'precision': 0.3781470606609608, 'recall': 0.600913332671498, 'f1-score': 0.46418711656441713, 'support': 10073}, 'accuracy': 0.3977492526815544, 'macro avg': {'precision': 0.42038391604359165, 'recall': 0.3625833020078147, 'f1-score': 0.3098830390298524, 'support': 28435}, 'weighted avg': {'precision': 0.4168275128335788, 'recall': 0.3977492526815544, 'f1-score': 0.3401845609237877, 'support': 28435}}
[[5193   41 5623]
 [3110   64 4331]
 [3986   34 6053]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0505401
{'0': {'precision': 0.49988094671174815, 'recall': 0.5149206141570057, 'f1-score': 0.50728933421396, 'support': 61157}, '1': {'precision': 0.4564178501716363, 'recall': 0.16968195580912343, 'f1-score': 0.2473914629697191, 'support': 39963}, '2': {'precision': 0.46494907130017976, 'recall': 0.6446896185032567, 'f1-score': 0.540262054945208, 'support': 60184}, 'accuracy': 0.4778058820612012, 'macro avg': {'precision': 0.47374928939452143, 'recall': 0.44309739615646193, 'f1-score': 0.4316476173762957, 'support': 161304}, 'weighted avg': {'precision': 0.47607957962350284, 'recall': 0.4778058820612012, 'f1-score': 0.45520216710065736, 'support': 161304}}
[[31491  4656 25010]
 [13542  6781 19640]
 [17964  3420 38800]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0379871
{'0': {'precision': 0.4543417146676627, 'recall': 0.5556864630920895, 'f1-score': 0.49992969704835755, 'support': 41590}, '1': {'precision': 0.6131014372005832, 'recall': 0.3022461814914645, 'f1-score': 0.404890042813666, 'support': 38955}, '2': {'precision': 0.46494408021596606, 'recall': 0.5826124776494467, 'f1-score': 0.5171696373034769, 'support': 41386}, 'accuracy': 0.4838556232623369, 'macro avg': {'precision': 0.5107957440280707, 'recall': 0.48018170741100025, 'f1-score': 0.4739964590551668, 'support': 121931}, 'weighted avg': {'precision': 0.5086615717331506, 'recall': 0.4838556232623369, 'f1-score': 0.4754176569329313, 'support': 121931}}
[[23111  3773 14706]
 [14139 11774 13042]
 [13617  3657 24112]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0167181
{'0': {'precision': 0.46675395650688833, 'recall': 0.5249039692701665, 'f1-score': 0.49412402820466467, 'support': 15620}, '1': {'precision': 0.6209071793331331, 'recall': 0.3939143692034049, 'f1-score': 0.48202417505538503, 'support': 15742}, '2': {'precision': 0.4740710071421178, 'recall': 0.5904725069296719, 'f1-score': 0.525907851298981, 'support': 15513}, 'accuracy': 0.5026133333333334, 'macro avg': {'precision': 0.5205773809940464, 'recall': 0.5030969484677478, 'f1-score': 0.5006853515196769, 'support': 46875}, 'weighted avg': {'precision': 0.5209446645652364, 'recall': 0.5026133333333334, 'f1-score': 0.5005792081382363, 'support': 46875}}
[[8199 2000 5421]
 [4800 6201 4741]
 [4567 1786 9160]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49222612
{'0': {'precision': 0.3748709491439068, 'recall': 0.6146185974939548, 'f1-score': 0.4657000324802412, 'support': 45490}, '1': {'precision': 0.9388964927106194, 'recall': 0.8598907900662238, 'f1-score': 0.8976586110404478, 'support': 512957}, '2': {'precision': 0.39945174304334335, 'recall': 0.5273952334342492, 'f1-score': 0.45459272267077394, 'support': 43931}, 'accuracy': 0.8171198151326907, 'macro avg': {'precision': 0.5710730616326232, 'recall': 0.6673015403314758, 'f1-score': 0.6059837887304876, 'support': 602378}, 'weighted avg': {'precision': 0.8569614464863502, 'recall': 0.8171198151326907, 'f1-score': 0.8327257561209919, 'support': 602378}}
[[ 27959  13706   3825]
 [ 40862 441087  31008]
 [  5762  15000  23169]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4840964
{'0': {'precision': 0.3475958483372167, 'recall': 0.5878559914024718, 'f1-score': 0.4368718801996672, 'support': 22332}, '1': {'precision': 0.9420914481998769, 'recall': 0.8468148320759663, 'f1-score': 0.8919159380273047, 'support': 274648}, '2': {'precision': 0.3774740543299495, 'recall': 0.5806507894966414, 'f1-score': 0.457519934011548, 'support': 22926}, 'accuracy': 0.8096628384587973, 'macro avg': {'precision': 0.5557204502890144, 'recall': 0.6717738709916931, 'f1-score': 0.59543591741284, 'support': 319906}, 'weighted avg': {'precision': 0.8601277022620236, 'recall': 0.8096628384587973, 'f1-score': 0.8290193162463064, 'support': 319906}}
[[ 13128   6950   2254]
 [ 22372 232576  19700]
 [  2268   7346  13312]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5050854
{'0': {'precision': 0.3192711550339716, 'recall': 0.560203749864528, 'f1-score': 0.40673564936853285, 'support': 9227}, '1': {'precision': 0.9399089561060588, 'recall': 0.8374942252610182, 'f1-score': 0.8857510004055368, 'support': 108230}, '2': {'precision': 0.3775728987993139, 'recall': 0.5766208251473477, 'f1-score': 0.4563358383000777, 'support': 9162}, 'accuracy': 0.7984109809744193, 'macro avg': {'precision': 0.5455843366464481, 'recall': 0.6581062667576313, 'f1-score': 0.5829408293580491, 'support': 126619}, 'weighted avg': {'precision': 0.8539917718956597, 'recall': 0.7984109809744193, 'f1-score': 0.8197721476328197, 'support': 126619}}
[[ 5169  2842  1216]
 [10095 90642  7493]
 [  926  2953  5283]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/AAL
Evaluating performance on  test set...
3870/3870 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.50463265
{'0': {'precision': 0.4178966139090662, 'recall': 0.49237343462520033, 'f1-score': 0.4520882378585753, 'support': 84245}, '1': {'precision': 0.9213104387402515, 'recall': 0.8859362016042871, 'f1-score': 0.9032771204270279, 'support': 825538}, '2': {'precision': 0.436317806422526, 'recall': 0.5262819641334305, 'f1-score': 0.4770958796672362, 'support': 80911}, 'accuracy': 0.8230957288527032, 'macro avg': {'precision': 0.5918416196906146, 'recall': 0.6348638667876393, 'f1-score': 0.6108204126509466, 'support': 990694}, 'weighted avg': {'precision': 0.8388921172945148, 'recall': 0.8230957288527032, 'f1-score': 0.8301030043194358, 'support': 990694}}
[[ 41480  34575   8190]
 [ 47342 731374  46822]
 [ 10437  27892  42582]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46976876
{'0': {'precision': 0.4051188894612694, 'recall': 0.5084388185654009, 'f1-score': 0.45093630698193776, 'support': 29388}, '1': {'precision': 0.9336213442729085, 'recall': 0.8926640613926742, 'f1-score': 0.9126834375351199, 'support': 345709}, '2': {'precision': 0.4188560026604589, 'recall': 0.5319396051103368, 'f1-score': 0.4686729615330945, 'support': 28413}, 'accuracy': 0.8392803152338232, 'macro avg': {'precision': 0.5858654121315455, 'recall': 0.644347495022804, 'f1-score': 0.6107642353500508, 'support': 403510}, 'weighted avg': {'precision': 0.8588830285106251, 'recall': 0.8392803152338232, 'f1-score': 0.8477891490978012, 'support': 403510}}
[[ 14942  11914   2532]
 [ 18669 308602  18438]
 [  3272  10027  15114]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4730641
{'0': {'precision': 0.39026222343621964, 'recall': 0.5548005048053587, 'f1-score': 0.45820805772699946, 'support': 10301}, '1': {'precision': 0.9426467017401862, 'recall': 0.8788873544482428, 'f1-score': 0.9096511405396328, 'support': 132513}, '2': {'precision': 0.39925275301520713, 'recall': 0.5726776983828507, 'f1-score': 0.47049281631391937, 'support': 10636}, 'accuracy': 0.8359074617139133, 'macro avg': {'precision': 0.577387226063871, 'recall': 0.6687885192121508, 'f1-score': 0.6127840048601838, 'support': 153450}, 'weighted avg': {'precision': 0.8679015042840243, 'recall': 0.8359074617139133, 'f1-score': 0.8489069037685829, 'support': 153450}}
[[  5715   3664    922]
 [  7806 116464   8243]
 [  1123   3422   6091]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85120517
{'0': {'precision': 0.44775595608586827, 'recall': 0.509125269165324, 'f1-score': 0.4764726606538895, 'support': 132818}, '1': {'precision': 0.7486438636599486, 'recall': 0.6484057315767828, 'f1-score': 0.6949287609573266, 'support': 367159}, '2': {'precision': 0.4421284014249981, 'recall': 0.5495917085427136, 'f1-score': 0.49003766504711627, 'support': 127360}, 'accuracy': 0.5988567548223682, 'macro avg': {'precision': 0.546176073723605, 'recall': 0.5690409030949402, 'f1-score': 0.5538130288861108, 'support': 627337}, 'weighted avg': {'precision': 0.6227129216329081, 'recall': 0.5988567548223682, 'f1-score': 0.607081507718276, 'support': 627337}}
[[ 67621  44113  21084]
 [ 61855 238068  67236]
 [ 21546  35818  69996]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81543857
{'0': {'precision': 0.4710424182792172, 'recall': 0.532315105091656, 'f1-score': 0.49980787216611455, 'support': 64753}, '1': {'precision': 0.7795137986591133, 'recall': 0.6735128035295306, 'f1-score': 0.7226468161478189, 'support': 178154}, '2': {'precision': 0.4608671734346869, 'recall': 0.5743444321528178, 'f1-score': 0.5113862588006799, 'support': 64181}, 'accuracy': 0.6230135987078622, 'macro avg': {'precision': 0.5704744634576725, 'recall': 0.5933907802580015, 'f1-score': 0.5779469823715377, 'support': 307088}, 'weighted avg': {'precision': 0.647872359243479, 'recall': 0.6230135987078622, 'f1-score': 0.6315055017013279, 'support': 307088}}
[[ 34469  17799  12485]
 [ 27528 119989  30637]
 [ 11179  16140  36862]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81290734
{'0': {'precision': 0.47147223637289865, 'recall': 0.5241716897932764, 'f1-score': 0.49642727150820865, 'support': 24719}, '1': {'precision': 0.7806438961779806, 'recall': 0.681264487624263, 'f1-score': 0.727576323987539, 'support': 64279}, '2': {'precision': 0.47496227191658663, 'recall': 0.583417593528817, 'f1-score': 0.5236330636013007, 'support': 23736}, 'accuracy': 0.6262174676672522, 'macro avg': {'precision': 0.5756928014891552, 'recall': 0.5962845903154522, 'f1-score': 0.5825455530323495, 'support': 112734}, 'weighted avg': {'precision': 0.6484914551026149, 'recall': 0.6262174676672522, 'f1-score': 0.6339526553803368, 'support': 112734}}
[[12957  6891  4871]
 [10051 43791 10437]
 [ 4474  5414 13848]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
3337/3337 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7430047
{'0': {'precision': 0.4231398863566524, 'recall': 0.5259159467792561, 'f1-score': 0.4689629549359877, 'support': 144004}, '1': {'precision': 0.8182517151644192, 'recall': 0.7303823574958118, 'f1-score': 0.7718241866139038, 'support': 568264}, '2': {'precision': 0.45187608763021764, 'recall': 0.5349102991908232, 'f1-score': 0.48989969148266005, 'support': 141749}, 'accuracy': 0.6634610318061585, 'macro avg': {'precision': 0.5644225630504297, 'recall': 0.5970695344886304, 'f1-score': 0.5768956110108505, 'support': 854017}, 'weighted avg': {'precision': 0.6908174104339756, 'recall': 0.6634610318061585, 'f1-score': 0.6739622657541255, 'support': 854017}}
[[ 75734  47891  20379]
 [ 81620 415050  71594]
 [ 21627  44299  75823]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7806388
{'0': {'precision': 0.44930026425244995, 'recall': 0.5434583190001147, 'f1-score': 0.4919140875860324, 'support': 69768}, '1': {'precision': 0.7950620168623557, 'recall': 0.7242734117939212, 'f1-score': 0.758018629302863, 'support': 225506}, '2': {'precision': 0.4742885606050676, 'recall': 0.51082843912356, 'f1-score': 0.491880832783899, 'support': 70832}, 'accuracy': 0.6485198275909163, 'macro avg': {'precision': 0.5728836139066243, 'recall': 0.592853389972532, 'f1-score': 0.5806045165575981, 'support': 366106}, 'weighted avg': {'precision': 0.6671096440257888, 'recall': 0.6485198275909163, 'f1-score': 0.6558169334291787, 'support': 366106}}
[[ 37916  20196  11656]
 [ 33728 163328  28450]
 [ 12745  21904  36183]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.830415
{'0': {'precision': 0.4731130389576632, 'recall': 0.5292791974119443, 'f1-score': 0.49962256382102666, 'support': 27511}, '1': {'precision': 0.7596830286957489, 'recall': 0.6817054749622368, 'f1-score': 0.7185850013143567, 'support': 70174}, '2': {'precision': 0.47960043702200716, 'recall': 0.546800484020215, 'f1-score': 0.5110006153027455, 'support': 28098}, 'accuracy': 0.6182313985196728, 'macro avg': {'precision': 0.5707988348918064, 'recall': 0.5859283854647986, 'f1-score': 0.5764027268127097, 'support': 125783}, 'weighted avg': {'precision': 0.6344388569989912, 'recall': 0.6182313985196728, 'f1-score': 0.6243228061366836, 'support': 125783}}
[[14561  7545  5405]
 [11070 47838 11266]
 [ 5146  7588 15364]]
testing model on single stock: results/universal/W9/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
10303/10303 - 82s - 82s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0994185
{'0': {'precision': 0.41217719813484915, 'recall': 0.5692598651204369, 'f1-score': 0.47814769790272654, 'support': 822215}, '1': {'precision': 0.6068519422553874, 'recall': 0.17631433113049752, 'f1-score': 0.27324132289665665, 'support': 987061}, '2': {'precision': 0.4194196970507508, 'recall': 0.6153885166955674, 'f1-score': 0.49884811854467964, 'support': 828124}, 'accuracy': 0.43668195950557365, 'macro avg': {'precision': 0.47948294581366246, 'recall': 0.45365423764883395, 'f1-score': 0.4167457131146876, 'support': 2637400}, 'weighted avg': {'precision': 0.4873093490329286, 'recall': 0.43668195950557365, 'f1-score': 0.40796017372127147, 'support': 2637400}}
[[468054  58538 295623]
 [403214 174033 409814]
 [264297  54209 509618]]
Evaluating performance on  train set...
3419/3419 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0729353
{'0': {'precision': 0.42758672129587477, 'recall': 0.5723694629786472, 'f1-score': 0.48949661173900305, 'support': 290454}, '1': {'precision': 0.6227136879856545, 'recall': 0.1622769518337112, 'f1-score': 0.2574605964083695, 'support': 288895}, '2': {'precision': 0.44786834198970965, 'recall': 0.622381712214845, 'f1-score': 0.520897082769226, 'support': 295804}, 'accuracy': 0.45389891824629525, 'macro avg': {'precision': 0.49938958375707965, 'recall': 0.45234270900906776, 'f1-score': 0.42261809697219954, 'support': 875153}, 'weighted avg': {'precision': 0.49885493333372755, 'recall': 0.45389891824629525, 'f1-score': 0.42351310974984313, 'support': 875153}}
[[166247  12744 111463]
 [126515  46881 115499]
 [ 96041  15660 184103]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0916095
{'0': {'precision': 0.41452774615118065, 'recall': 0.5763311165979852, 'f1-score': 0.4822185031222444, 'support': 116237}, '1': {'precision': 0.5948353354580371, 'recall': 0.1721427783120753, 'f1-score': 0.2670131140525174, 'support': 126854}, '2': {'precision': 0.43318842129766527, 'recall': 0.6030567111889643, 'f1-score': 0.504199588462299, 'support': 114175}, 'accuracy': 0.4413574199615972, 'macro avg': {'precision': 0.48085050096896104, 'recall': 0.45051020203300823, 'f1-score': 0.41781040187902024, 'support': 357266}, 'weighted avg': {'precision': 0.48451291551737236, 'recall': 0.4413574199615972, 'f1-score': 0.4128305008876337, 'support': 357266}}
[[66991  6874 42372]
 [57296 21837 47721]
 [37321  8000 68854]]
training model: results/universal/W9/deepOF_L2/h20
Epoch 1/50
6697/6697 - 155s - loss: 2.7866 - accuracy20: 0.5409 - val_loss: 2.9403 - val_accuracy20: 0.5090 - 155s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 151s - loss: 2.6898 - accuracy20: 0.5618 - val_loss: 2.8895 - val_accuracy20: 0.5128 - 151s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 151s - loss: 2.6599 - accuracy20: 0.5664 - val_loss: 2.8686 - val_accuracy20: 0.5156 - 151s/epoch - 23ms/step
Epoch 4/50
6697/6697 - 151s - loss: 2.6444 - accuracy20: 0.5693 - val_loss: 2.8588 - val_accuracy20: 0.5181 - 151s/epoch - 23ms/step
Epoch 5/50
6697/6697 - 152s - loss: 2.6342 - accuracy20: 0.5715 - val_loss: 2.8535 - val_accuracy20: 0.5181 - 152s/epoch - 23ms/step
Epoch 6/50
6697/6697 - 152s - loss: 2.6268 - accuracy20: 0.5728 - val_loss: 2.8426 - val_accuracy20: 0.5202 - 152s/epoch - 23ms/step
Epoch 7/50
6697/6697 - 151s - loss: 2.6208 - accuracy20: 0.5745 - val_loss: 2.8375 - val_accuracy20: 0.5208 - 151s/epoch - 23ms/step
Epoch 8/50
6697/6697 - 152s - loss: 2.6162 - accuracy20: 0.5749 - val_loss: 2.8423 - val_accuracy20: 0.5202 - 152s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 151s - loss: 2.6116 - accuracy20: 0.5758 - val_loss: 2.8334 - val_accuracy20: 0.5228 - 151s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 153s - loss: 2.6079 - accuracy20: 0.5764 - val_loss: 2.8432 - val_accuracy20: 0.5200 - 153s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 152s - loss: 2.6047 - accuracy20: 0.5772 - val_loss: 2.8380 - val_accuracy20: 0.5202 - 152s/epoch - 23ms/step
Epoch 12/50
6697/6697 - 151s - loss: 2.6012 - accuracy20: 0.5780 - val_loss: 2.8338 - val_accuracy20: 0.5223 - 151s/epoch - 23ms/step
Epoch 13/50
6697/6697 - 153s - loss: 2.5984 - accuracy20: 0.5787 - val_loss: 2.8390 - val_accuracy20: 0.5191 - 153s/epoch - 23ms/step
Epoch 14/50
6697/6697 - 151s - loss: 2.5960 - accuracy20: 0.5791 - val_loss: 2.8482 - val_accuracy20: 0.5172 - 151s/epoch - 23ms/step
Epoch 15/50
6697/6697 - 150s - loss: 2.5930 - accuracy20: 0.5798 - val_loss: 2.8422 - val_accuracy20: 0.5195 - 150s/epoch - 22ms/step
Epoch 16/50
6697/6697 - 151s - loss: 2.5904 - accuracy20: 0.5801 - val_loss: 2.8398 - val_accuracy20: 0.5199 - 151s/epoch - 22ms/step
Epoch 17/50
6697/6697 - 151s - loss: 2.5887 - accuracy20: 0.5805 - val_loss: 2.8435 - val_accuracy20: 0.5193 - 151s/epoch - 23ms/step
Epoch 18/50
6697/6697 - 151s - loss: 2.5863 - accuracy20: 0.5809 - val_loss: 2.8392 - val_accuracy20: 0.5208 - 151s/epoch - 23ms/step
Epoch 19/50
6697/6697 - 151s - loss: 2.5842 - accuracy20: 0.5813 - val_loss: 2.8530 - val_accuracy20: 0.5164 - 151s/epoch - 22ms/step
testing model in sample: results/universal/W9/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 126s - 126s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0433041
{'0': {'precision': 0.3936490839107722, 'recall': 0.5929973689536531, 'f1-score': 0.4731844327264402, 'support': 1141371}, '1': {'precision': 0.7984996911478214, 'recall': 0.39806140496324544, 'f1-score': 0.531275686555525, 'support': 2026416}, '2': {'precision': 0.40234584407931007, 'recall': 0.5570244120260832, 'f1-score': 0.46721577160256494, 'support': 1139889}, 'accuracy': 0.49177654029690254, 'macro avg': {'precision': 0.5314982063793012, 'recall': 0.5160277286476606, 'f1-score': 0.4905586302948433, 'support': 4307676}, 'weighted avg': {'precision': 0.5864001379284437, 'recall': 0.49177654029690254, 'f1-score': 0.49893229191071636, 'support': 4307676}}
[[676830 104823 359718]
 [636332 806638 583446]
 [406212  98731 634946]]
Evaluating performance on  train set...
6697/6697 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98513806
{'0': {'precision': 0.4060478454456267, 'recall': 0.6059043848210284, 'f1-score': 0.4862406794395961, 'support': 444009}, '1': {'precision': 0.8248130705772552, 'recall': 0.46854360530661743, 'f1-score': 0.5976091468011846, 'support': 820485}, '2': {'precision': 0.4249304706131569, 'recall': 0.5533620315680582, 'f1-score': 0.48071591670056785, 'support': 449505}, 'accuracy': 0.5263707855138772, 'macro avg': {'precision': 0.5519304622120129, 'recall': 0.5426033405652347, 'f1-score': 0.5215219143137829, 'support': 1713999}, 'weighted avg': {'precision': 0.6114612792737999, 'recall': 0.5263707855138772, 'f1-score': 0.5381034567622002, 'support': 1713999}}
[[269027  40555 134427]
 [233854 384433 202198]
 [159669  41097 248739]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9877468
{'0': {'precision': 0.4056458409911967, 'recall': 0.6163710423577731, 'f1-score': 0.4892841868140973, 'support': 177252}, '1': {'precision': 0.8172611549426506, 'recall': 0.4589999627639108, 'f1-score': 0.5878465378012335, 'support': 322268}, '2': {'precision': 0.4247903728801373, 'recall': 0.5453402174853615, 'f1-score': 0.47757544527044604, 'support': 173345}, 'accuracy': 0.5226992041494207, 'macro avg': {'precision': 0.5492324562713282, 'recall': 0.5402370742023485, 'f1-score': 0.5182353899619256, 'support': 672865}, 'weighted avg': {'precision': 0.6077206299559899, 'recall': 0.5226992041494207, 'f1-score': 0.5334740910668645, 'support': 672865}}
[[109253  16980  51019]
 [ 97360 147921  76987]
 [ 62718  16095  94532]]
testing model out of sample: results/universal/W9/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 67s - 67s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80464727
{'0': {'precision': 0.43022497984193264, 'recall': 0.575928247071633, 'f1-score': 0.4925268077643974, 'support': 425237}, '1': {'precision': 0.827462673817348, 'recall': 0.6804636088697137, 'f1-score': 0.7467980944365384, 'support': 1366583}, '2': {'precision': 0.4325871318846733, 'recall': 0.534447570454437, 'f1-score': 0.4781527303754266, 'support': 419420}, 'accuracy': 0.6326649300844774, 'macro avg': {'precision': 0.5634249285146513, 'recall': 0.5969464754652613, 'f1-score': 0.5724925441921208, 'support': 2211240}, 'weighted avg': {'precision': 0.6761725085388499, 'recall': 0.6326649300844774, 'f1-score': 0.6469442577995779, 'support': 2211240}}
[[244906 100195  80136]
 [222787 929910 213886]
 [101558  93704 224158]]
Evaluating performance on  train set...
3947/3947 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8303977
{'0': {'precision': 0.42883552896183347, 'recall': 0.5833989287154184, 'f1-score': 0.49431667988369016, 'support': 208348}, '1': {'precision': 0.8231393298059965, 'recall': 0.6688562179660102, 'f1-score': 0.7380207800422298, 'support': 593120}, '2': {'precision': 0.4387792711993513, 'recall': 0.5148433971149318, 'f1-score': 0.4737777699165134, 'support': 208106}, 'accuracy': 0.6194731639285481, 'macro avg': {'precision': 0.5635847099890604, 'recall': 0.5890328479321202, 'f1-score': 0.5687050766141445, 'support': 1009574}, 'weighted avg': {'precision': 0.6625368948634621, 'recall': 0.6194731639285481, 'f1-score': 0.633257961541502, 'support': 1009574}}
[[121550  42107  44691]
 [104059 396712  92349]
 [ 57833  43131 107142]]
Evaluating performance on  val set...
1402/1402 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8353554
{'0': {'precision': 0.43476075087726357, 'recall': 0.578353218126371, 'f1-score': 0.49638103328531, 'support': 74764}, '1': {'precision': 0.8265335339665056, 'recall': 0.6524904896335804, 'f1-score': 0.7292718193497062, 'support': 207931}, '2': {'precision': 0.4355061973646671, 'recall': 0.5455616445609298, 'f1-score': 0.48436095262158974, 'support': 75546}, 'accuracy': 0.6144690306246354, 'macro avg': {'precision': 0.5656001607361455, 'recall': 0.5921351174402937, 'f1-score': 0.5700046017522019, 'support': 358241}, 'weighted avg': {'precision': 0.6623115394828855, 'recall': 0.6144690306246354, 'f1-score': 0.6290211973741066, 'support': 358241}}
[[ 43240  14579  16945]
 [ 35781 135673  36477]
 [ 20436  13895  41215]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.07895
{'0': {'precision': 0.3920120611233199, 'recall': 0.6353696417477739, 'f1-score': 0.48486859779705743, 'support': 24145}, '1': {'precision': 0.5420445177246497, 'recall': 0.21350002029467874, 'f1-score': 0.30633936111353777, 'support': 24637}, '2': {'precision': 0.4859038142620232, 'recall': 0.4848803971716564, 'f1-score': 0.48539156626506025, 'support': 26588}, 'accuracy': 0.4443810534695502, 'macro avg': {'precision': 0.4733201310366642, 'recall': 0.44458335307136965, 'f1-score': 0.4255331750585518, 'support': 75370}, 'weighted avg': {'precision': 0.47417663012609035, 'recall': 0.4443810534695502, 'f1-score': 0.42669531773145286, 'support': 75370}}
[[15341  2161  6643]
 [12380  5260  6997]
 [11413  2283 12892]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.053377
{'0': {'precision': 0.4516756156267358, 'recall': 0.5794880931171684, 'f1-score': 0.5076606924537627, 'support': 16839}, '1': {'precision': 0.6294160057678443, 'recall': 0.29374158815612383, 'f1-score': 0.4005505849965589, 'support': 17832}, '2': {'precision': 0.4432756262087834, 'recall': 0.5711073295247356, 'f1-score': 0.4991368549650758, 'support': 16454}, 'accuracy': 0.4771246943765281, 'macro avg': {'precision': 0.5081224158677878, 'recall': 0.48144567026600926, 'f1-score': 0.4691160441384658, 'support': 51125}, 'weighted avg': {'precision': 0.5109666319810293, 'recall': 0.4771246943765281, 'f1-score': 0.4675582248114016, 'support': 51125}}
[[9758 1589 5492]
 [6284 5238 6310]
 [5562 1495 9397]]
Evaluating performance on  val set...
53/53 - 1s - 703ms/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0617533
{'0': {'precision': 0.42353345948735593, 'recall': 0.5810715128628747, 'f1-score': 0.48995024875621895, 'support': 4237}, '1': {'precision': 0.6504955659885238, 'recall': 0.2511075312122433, 'f1-score': 0.36234200203399686, 'support': 4966}, '2': {'precision': 0.4295652173913043, 'recall': 0.5775075987841946, 'f1-score': 0.49266979156278046, 'support': 4277}, 'accuracy': 0.4583827893175074, 'macro avg': {'precision': 0.501198080955728, 'recall': 0.46989554761977087, 'f1-score': 0.44832068078433207, 'support': 13480}, 'weighted avg': {'precision': 0.5090595462410642, 'recall': 0.4583827893175074, 'f1-score': 0.44380254336757713, 'support': 13480}}
[[2462  367 1408]
 [1847 1247 1872]
 [1504  303 2470]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5929629
{'0': {'precision': 0.3323078335935348, 'recall': 0.5965953588063146, 'f1-score': 0.42685462347199077, 'support': 24261}, '1': {'precision': 0.917696997190218, 'recall': 0.8374703243412215, 'f1-score': 0.8757501264475204, 'support': 236726}, '2': {'precision': 0.49695098998720166, 'recall': 0.5245966780576969, 'f1-score': 0.5103997525709426, 'support': 25166}, 'accuracy': 0.7895321733478244, 'macro avg': {'precision': 0.5823186069236516, 'recall': 0.6528874537350777, 'f1-score': 0.6043348341634845, 'support': 286153}, 'weighted avg': {'precision': 0.8310628521164629, 'recall': 0.7895321733478244, 'f1-score': 0.8055601885238667, 'support': 286153}}
[[ 14474   8432   1355]
 [ 26466 198251  12009]
 [  2616   9348  13202]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6491661
{'0': {'precision': 0.3832893936321233, 'recall': 0.5917345021916093, 'f1-score': 0.4652307692307692, 'support': 12776}, '1': {'precision': 0.9134089861498277, 'recall': 0.801780278216639, 'f1-score': 0.8539620976595768, 'support': 103804}, '2': {'precision': 0.40538775510204084, 'recall': 0.5894595236211126, 'f1-score': 0.4803946859280279, 'support': 12637}, 'accuracy': 0.7602482645472345, 'macro avg': {'precision': 0.5673620449613306, 'recall': 0.6609914346764537, 'f1-score': 0.5998625176061246, 'support': 129217}, 'weighted avg': {'precision': 0.8113119539423235, 'recall': 0.7602482645472345, 'f1-score': 0.7789936118252203, 'support': 129217}}
[[ 7560  4001  1215]
 [10865 83228  9711]
 [ 1299  3889  7449]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6311228
{'0': {'precision': 0.38805755395683456, 'recall': 0.5807493540051679, 'f1-score': 0.4652406417112299, 'support': 4644}, '1': {'precision': 0.9118244137809292, 'recall': 0.8079038606918485, 'f1-score': 0.8567242570836213, 'support': 38361}, '2': {'precision': 0.42956926658905703, 'recall': 0.6142322097378277, 'f1-score': 0.5055660215790374, 'support': 4806}, 'accuracy': 0.7663717554537659, 'macro avg': {'precision': 0.5764837447756069, 'recall': 0.6676284748116146, 'f1-score': 0.609176973457963, 'support': 47811}, 'weighted avg': {'precision': 0.8124729771988196, 'recall': 0.7663717554537659, 'f1-score': 0.7833997838531008, 'support': 47811}}
[[ 2697  1637   310]
 [ 3759 30992  3610]
 [  494  1360  2952]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.06353
{'0': {'precision': 0.4225092996927058, 'recall': 0.5288476137456349, 'f1-score': 0.46973545211391066, 'support': 39518}, '1': {'precision': 0.5921640424752838, 'recall': 0.32334946215059784, 'f1-score': 0.4182918628110289, 'support': 50014}, '2': {'precision': 0.3866920366986304, 'recall': 0.5090395059891377, 'f1-score': 0.4395100852211897, 'support': 40323}, 'accuracy': 0.4435485734088021, 'macro avg': {'precision': 0.46712179295554, 'recall': 0.45374552729512346, 'f1-score': 0.4425124667153764, 'support': 129855}, 'weighted avg': {'precision': 0.47673018306121495, 'recall': 0.4435485734088021, 'f1-score': 0.4405361363801344, 'support': 129855}}
[[20899  5852 12767]
 [14054 16172 19788]
 [14511  5286 20526]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0949502
{'0': {'precision': 0.4195820008398747, 'recall': 0.5691687480829061, 'f1-score': 0.4830599873554242, 'support': 22821}, '1': {'precision': 0.5378766544635314, 'recall': 0.2643110844596153, 'f1-score': 0.354447606086849, 'support': 21679}, '2': {'precision': 0.4244029732721809, 'recall': 0.47915364699580393, 'f1-score': 0.45011951188828786, 'support': 22402}, 'accuracy': 0.440240949448447, 'macro avg': {'precision': 0.460620542858529, 'recall': 0.43754449317944183, 'f1-score': 0.429209035110187, 'support': 66902}, 'weighted avg': {'precision': 0.45952862755261537, 'recall': 0.440240949448447, 'f1-score': 0.43035423349251684, 'support': 66902}}
[[12989  2442  7390]
 [ 8781  5730  7168]
 [ 9187  2481 10734]]
Evaluating performance on  val set...
73/73 - 1s - 789ms/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1101091
{'0': {'precision': 0.4254352763058289, 'recall': 0.5857653365098273, 'f1-score': 0.49288980768026064, 'support': 6716}, '1': {'precision': 0.4628975265017668, 'recall': 0.18029885961462838, 'f1-score': 0.25951606056318094, 'support': 5086}, '2': {'precision': 0.4515824915824916, 'recall': 0.48941760326959566, 'f1-score': 0.4697394228075091, 'support': 6851}, 'accuracy': 0.43982201254489894, 'macro avg': {'precision': 0.4466384314633624, 'recall': 0.4184939331313504, 'f1-score': 0.40738176368365026, 'support': 18653}, 'weighted avg': {'precision': 0.44525340617003073, 'recall': 0.43982201254489894, 'f1-score': 0.42075437828012724, 'support': 18653}}
[[3934  517 2265]
 [2362  917 1807]
 [2951  547 3353]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3703458
{'0': {'precision': 0.3399503148650991, 'recall': 0.6019765110283586, 'f1-score': 0.4345180513812685, 'support': 48874}, '1': {'precision': 0.6970423661071143, 'recall': 0.01463504690935334, 'f1-score': 0.028668178978860506, 'support': 59583}, '2': {'precision': 0.32690806461298266, 'recall': 0.4738961067223782, 'f1-score': 0.3869122180467827, 'support': 45951}, 'accuracy': 0.3372169835759805, 'macro avg': {'precision': 0.45463358186173203, 'recall': 0.36350255488669675, 'f1-score': 0.28336614946897054, 'support': 154408}, 'weighted avg': {'precision': 0.4738637859794066, 'recall': 0.3372169835759805, 'f1-score': 0.26374135202044763, 'support': 154408}}
[[29421   240 19213]
 [33088   872 25623]
 [24036   139 21776]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3036748
{'0': {'precision': 0.36388453792794806, 'recall': 0.5671735491071429, 'f1-score': 0.4433357869196587, 'support': 28672}, '1': {'precision': 0.5726256983240223, 'recall': 0.007361654756347182, 'f1-score': 0.01453642971104414, 'support': 27847}, '2': {'precision': 0.33668555617633755, 'recall': 0.4845688466840251, 'f1-score': 0.3973125284523492, 'support': 26116}, 'accuracy': 0.35241725661039514, 'macro avg': {'precision': 0.42439859747610265, 'recall': 0.3530346835158384, 'f1-score': 0.2850615816943507, 'support': 82635}, 'weighted avg': {'precision': 0.42563181796817817, 'recall': 0.35241725661039514, 'f1-score': 0.2842903567953706, 'support': 82635}}
[[16262   108 12302]
 [15012   205 12630]
 [13416    45 12655]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.246723
{'0': {'precision': 0.39320296183785836, 'recall': 0.5875732929827879, 'f1-score': 0.4711279620853081, 'support': 10574}, '1': {'precision': 0.43243243243243246, 'recall': 0.003965303593556382, 'f1-score': 0.007858546168958742, 'support': 8070}, '2': {'precision': 0.3609872611464968, 'recall': 0.4630783372484935, 'f1-score': 0.4057089168269876, 'support': 9791}, 'accuracy': 0.3790750835238263, 'macro avg': {'precision': 0.3955408851389292, 'recall': 0.35153897794161265, 'f1-score': 0.2948984750270848, 'support': 28435}, 'weighted avg': {'precision': 0.3932436828587514, 'recall': 0.3790750835238263, 'f1-score': 0.317124021217745, 'support': 28435}}
[[6213   27 4334]
 [4346   32 3692]
 [5242   15 4534]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1311268
{'0': {'precision': 0.4367488809368066, 'recall': 0.5697744461548758, 'f1-score': 0.49447110672252426, 'support': 59764}, '1': {'precision': 0.4259460766533672, 'recall': 0.08097175297064975, 'f1-score': 0.13607570490536885, 'support': 43509}, '2': {'precision': 0.4255854847733994, 'recall': 0.5505161034619428, 'f1-score': 0.48005589908112134, 'support': 58031}, 'accuracy': 0.4309998512126172, 'macro avg': {'precision': 0.42942681412119105, 'recall': 0.40042076752915606, 'f1-score': 0.37020090356967145, 'support': 161304}, 'weighted avg': {'precision': 0.42981884662688963, 'recall': 0.4309998512126172, 'f1-score': 0.3926140265986534, 'support': 161304}}
[[34052  2653 23059]
 [19926  3523 20060]
 [23989  2095 31947]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1291798
{'0': {'precision': 0.39696139635622374, 'recall': 0.6158369363804818, 'f1-score': 0.4827486031355613, 'support': 40475}, '1': {'precision': 0.5865047673376252, 'recall': 0.17616390071963578, 'f1-score': 0.2709458823529412, 'support': 40854}, '2': {'precision': 0.4191559272851412, 'recall': 0.4838431604354465, 'f1-score': 0.4491825768835029, 'support': 40602}, 'accuracy': 0.4245679933733013, 'macro avg': {'precision': 0.4675406969929967, 'recall': 0.4252813325118547, 'f1-score': 0.4009590207906684, 'support': 121931}, 'weighted avg': {'precision': 0.467860078585108, 'recall': 0.4245679933733013, 'f1-score': 0.40060512729480513, 'support': 121931}}
[[24926  2428 13121]
 [19555  7197 14102]
 [18311  2646 19645]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1102972
{'0': {'precision': 0.4008524001794527, 'recall': 0.5880610767408188, 'f1-score': 0.47673674100949737, 'support': 15194}, '1': {'precision': 0.6234663658158228, 'recall': 0.2650956407027643, 'f1-score': 0.37201279030629425, 'support': 16677}, '2': {'precision': 0.42460272093289125, 'recall': 0.4950679818715009, 'f1-score': 0.4571358237429995, 'support': 15004}, 'accuracy': 0.443392, 'macro avg': {'precision': 0.4829738289760556, 'recall': 0.449408233105028, 'f1-score': 0.43529511835293033, 'support': 46875}, 'weighted avg': {'precision': 0.48765523575283587, 'recall': 0.443392, 'f1-score': 0.4332045065872285, 'support': 46875}}
[[8935 1334 4925]
 [7115 4421 5141]
 [6240 1336 7428]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64268965
{'0': {'precision': 0.37358085837358956, 'recall': 0.679432894048242, 'f1-score': 0.48208890564254336, 'support': 63057}, '1': {'precision': 0.9124137913807617, 'recall': 0.7647838430873337, 'f1-score': 0.8321014906264914, 'support': 477616}, '2': {'precision': 0.4019391247610435, 'recall': 0.5690462685357751, 'f1-score': 0.47111307894595605, 'support': 61705}, 'accuracy': 0.7357987841521437, 'macro avg': {'precision': 0.5626445915051316, 'recall': 0.6710876685571169, 'f1-score': 0.595101158404997, 'support': 602378}, 'weighted avg': {'precision': 0.8037178769210654, 'recall': 0.7357987841521437, 'f1-score': 0.758484038604538, 'support': 602378}}
[[ 42843  15832   4382]
 [ 64479 365273  47864]
 [  7360  19232  35113]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.634844
{'0': {'precision': 0.3544538300729133, 'recall': 0.65955091714105, 'f1-score': 0.4611030655449551, 'support': 31620}, '1': {'precision': 0.914883182798566, 'recall': 0.7514949568427763, 'f1-score': 0.8251789694281138, 'support': 255693}, '2': {'precision': 0.4001959247648903, 'recall': 0.6266989844445127, 'f1-score': 0.4884674709743762, 'support': 32593}, 'accuracy': 0.729692472163698, 'macro avg': {'precision': 0.5565109792121231, 'recall': 0.6792482861427797, 'f1-score': 0.5915831686491483, 'support': 319906}, 'weighted avg': {'precision': 0.8070515762195186, 'recall': 0.729692472163698, 'f1-score': 0.7548879528485931, 'support': 319906}}
[[ 20855   8470   2295]
 [ 35222 192152  28319]
 [  2760   9407  20426]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65375435
{'0': {'precision': 0.3216799533346296, 'recall': 0.6411409083862967, 'f1-score': 0.42841235725198745, 'support': 12902}, '1': {'precision': 0.9121994591190309, 'recall': 0.7329073609223229, 'f1-score': 0.8127833281985829, 'support': 100789}, '2': {'precision': 0.3967879548306148, 'recall': 0.6115408415841584, 'f1-score': 0.4812954676894043, 'support': 12928}, 'accuracy': 0.7111649910361004, 'macro avg': {'precision': 0.5435557890947584, 'recall': 0.6618630369642594, 'f1-score': 0.5741637177133249, 'support': 126619}, 'weighted avg': {'precision': 0.7994034127826122, 'recall': 0.7111649910361004, 'f1-score': 0.7397719371133932, 'support': 126619}}
[[ 8272  3338  1292]
 [16193 73869 10727]
 [ 1250  3772  7906]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/AAL
Evaluating performance on  test set...
3870/3870 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6617613
{'0': {'precision': 0.41725118364688496, 'recall': 0.5774848098742318, 'f1-score': 0.4844626554734282, 'support': 115371}, '1': {'precision': 0.8914174136066702, 'recall': 0.7822730112589239, 'f1-score': 0.8332864597546239, 'support': 765082}, '2': {'precision': 0.3885923364158083, 'recall': 0.5626218920365381, 'f1-score': 0.45968731123982315, 'support': 110241}, 'accuracy': 0.7339824405921506, 'macro avg': {'precision': 0.5657536445564545, 'recall': 0.6407932377232313, 'f1-score': 0.592478808822625, 'support': 990694}, 'weighted avg': {'precision': 0.7802458798623574, 'recall': 0.7339824405921506, 'f1-score': 0.7510914582151516, 'support': 990694}}
[[ 66625  39295   9451]
 [ 78442 598503  88137]
 [ 14609  33608  62024]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6364871
{'0': {'precision': 0.3857259556874448, 'recall': 0.5721739990602666, 'f1-score': 0.46080462059350724, 'support': 40437}, '1': {'precision': 0.9064245563643935, 'recall': 0.7930022134343425, 'f1-score': 0.8459283945413352, 'support': 323931}, '2': {'precision': 0.3733244636620655, 'recall': 0.5735016095242962, 'f1-score': 0.4522523974534612, 'support': 39142}, 'accuracy': 0.7495799360610642, 'macro avg': {'precision': 0.5551583252379678, 'recall': 0.6462259406729683, 'f1-score': 0.5863284708627678, 'support': 403510}, 'weighted avg': {'precision': 0.8025309895528441, 'recall': 0.7495799360610642, 'f1-score': 0.7691458713693151, 'support': 403510}}
[[ 23137  14126   3174]
 [ 32545 256878  34508]
 [  4301  12393  22448]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64114577
{'0': {'precision': 0.3827033513328191, 'recall': 0.618164197701786, 'f1-score': 0.4727368978295395, 'support': 14446}, '1': {'precision': 0.9208299155609168, 'recall': 0.7681551428502427, 'f1-score': 0.8375920577934218, 'support': 124221}, '2': {'precision': 0.35491298931712656, 'recall': 0.6360008117432185, 'f1-score': 0.45558947521442067, 'support': 14783}, 'accuracy': 0.7413033561420658, 'macro avg': {'precision': 0.5528154187369542, 'recall': 0.6741067174317491, 'f1-score': 0.588639476945794, 'support': 153450}, 'weighted avg': {'precision': 0.8156508587508741, 'recall': 0.7413033561420658, 'f1-score': 0.7664428768282631, 'support': 153450}}
[[ 8930  4284  1232]
 [12943 95421 15857]
 [ 1461  3920  9402]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93895626
{'0': {'precision': 0.4800860308225537, 'recall': 0.5505796758547261, 'f1-score': 0.5129221036854171, 'support': 169060}, '1': {'precision': 0.6631279669192488, 'recall': 0.5258872299551751, 'f1-score': 0.5865871698623907, 'support': 296710}, '2': {'precision': 0.4496997224325006, 'recall': 0.5515235165596934, 'f1-score': 0.49543391054634617, 'support': 161567}, 'accuracy': 0.539144032633178, 'macro avg': {'precision': 0.530971240058101, 'recall': 0.5426634741231983, 'f1-score': 0.5316477280313846, 'support': 627337}, 'weighted avg': {'precision': 0.5588330968677491, 'recall': 0.539144032633178, 'f1-score': 0.5432593018491944, 'support': 627337}}
[[ 93081  42237  33742]
 [ 65374 156036  75300]
 [ 35429  37030  89108]]
Evaluating performance on  train set...
1200/1200 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90234405
{'0': {'precision': 0.48118360994767134, 'recall': 0.5665986126826389, 'f1-score': 0.5204096041208932, 'support': 81308}, '1': {'precision': 0.6950037346816492, 'recall': 0.5832317346172656, 'f1-score': 0.6342309276806113, 'support': 145179}, '2': {'precision': 0.4828522275347424, 'recall': 0.5362588553491893, 'f1-score': 0.5081561513546559, 'support': 80601}, 'accuracy': 0.5664988537487625, 'macro avg': {'precision': 0.5530131907213544, 'recall': 0.5620297342163646, 'f1-score': 0.5542655610520534, 'support': 307088}, 'weighted avg': {'precision': 0.582707225767533, 'recall': 0.5664988537487625, 'f1-score': 0.5710036533402206, 'support': 307088}}
[[46069 19042 16197]
 [30410 84673 30096]
 [19262 18116 43223]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8890073
{'0': {'precision': 0.48958541102721187, 'recall': 0.5582921757213413, 'f1-score': 0.5216863263044436, 'support': 30776}, '1': {'precision': 0.7039091330961483, 'recall': 0.6066042047531993, 'f1-score': 0.6516442489643534, 'support': 52512}, '2': {'precision': 0.4940406348422158, 'recall': 0.5433675202064796, 'f1-score': 0.5175313753396299, 'support': 29446}, 'accuracy': 0.576897830290773, 'macro avg': {'precision': 0.5625117263218586, 'recall': 0.5694213002270067, 'f1-score': 0.563620650202809, 'support': 112734}, 'weighted avg': {'precision': 0.5905820563493027, 'recall': 0.576897830290773, 'f1-score': 0.5811360375593203, 'support': 112734}}
[[17182  7381  6213]
 [10485 31854 10173]
 [ 7428  6018 16000]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
3337/3337 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84524107
{'0': {'precision': 0.4444599761542573, 'recall': 0.5798464913456949, 'f1-score': 0.5032059562128057, 'support': 186439}, '1': {'precision': 0.7522059347195583, 'recall': 0.6337058101837005, 'f1-score': 0.6878897924625339, 'support': 483341}, '2': {'precision': 0.4745960017682597, 'recall': 0.5244494862595461, 'f1-score': 0.498278871764988, 'support': 184237}, 'accuracy': 0.598378018236171, 'macro avg': {'precision': 0.5570873042140251, 'recall': 0.5793339292629806, 'f1-score': 0.5631248734801092, 'support': 854017}, 'weighted avg': {'precision': 0.625133675050132, 'recall': 0.598378018236171, 'f1-score': 0.6066670334974116, 'support': 854017}}
[[108106  50254  28079]
 [ 98157 306296  78888]
 [ 36967  50647  96623]]
Evaluating performance on  train set...
1431/1431 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86524224
{'0': {'precision': 0.4695739236845033, 'recall': 0.5770597885526796, 'f1-score': 0.5177976324344218, 'support': 87776}, '1': {'precision': 0.7262152725970576, 'recall': 0.6444149048849722, 'f1-score': 0.6828741311917931, 'support': 188824}, '2': {'precision': 0.49460207536142387, 'recall': 0.5011060711013787, 'f1-score': 0.49783283108291854, 'support': 89506}, 'accuracy': 0.5932298296121888, 'macro avg': {'precision': 0.5634637572143283, 'recall': 0.5741935881796768, 'f1-score': 0.5661681982363779, 'support': 366106}, 'weighted avg': {'precision': 0.608058995797658, 'recall': 0.5932298296121888, 'f1-score': 0.5980569980050331, 'support': 366106}}
[[ 50652  21626  15498]
 [ 36810 121681  30333]
 [ 20406  24248  44852]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90416825
{'0': {'precision': 0.48992787223080886, 'recall': 0.5565830675133886, 'f1-score': 0.5211327423928978, 'support': 34171}, '1': {'precision': 0.6806232134949072, 'recall': 0.5933907793826012, 'f1-score': 0.6340205702284852, 'support': 56981}, '2': {'precision': 0.4983237226766796, 'recall': 0.5365135283416592, 'f1-score': 0.5167139440458313, 'support': 34631}, 'accuracy': 0.5677317284529706, 'macro avg': {'precision': 0.5562916028007986, 'recall': 0.5621624584125496, 'f1-score': 0.5572890855557381, 'support': 125783}, 'weighted avg': {'precision': 0.5786264081010022, 'recall': 0.5677317284529706, 'f1-score': 0.5710554975533118, 'support': 125783}}
[[19019  8083  7069]
 [11533 33812 11636]
 [ 8268  7783 18580]]
testing model on single stock: results/universal/W9/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
10303/10303 - 80s - 80s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1893234
{'0': {'precision': 0.3878218861091925, 'recall': 0.5943197080798307, 'f1-score': 0.46936244529935756, 'support': 836119}, '1': {'precision': 0.5458527832233923, 'recall': 0.08943471360070979, 'f1-score': 0.15368848774699295, 'support': 955781}, '2': {'precision': 0.3965340154032644, 'recall': 0.5625511531638084, 'f1-score': 0.46517384471091733, 'support': 845500}, 'accuracy': 0.4011674376279669, 'macro avg': {'precision': 0.44340289491194973, 'recall': 0.415435191614783, 'f1-score': 0.36274159258575595, 'support': 2637400}, 'weighted avg': {'precision': 0.44788446068750626, 'recall': 0.4011674376279669, 'f1-score': 0.35362094510185893, 'support': 2637400}}
[[496922  38160 301037]
 [447489  85480 422812]
 [336904  32959 475637]]
Evaluating performance on  train set...
3419/3419 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1620504
{'0': {'precision': 0.40177362104907316, 'recall': 0.6155272361920086, 'f1-score': 0.48619364621371824, 'support': 289633}, '1': {'precision': 0.5691227408751385, 'recall': 0.08387565025940923, 'f1-score': 0.1462041579777301, 'support': 287962}, '2': {'precision': 0.4239580039538393, 'recall': 0.5542280832644392, 'f1-score': 0.48041867490499557, 'support': 297558}, 'accuracy': 0.41974946095139937, 'macro avg': {'precision': 0.46495145529268367, 'recall': 0.41787698990528566, 'f1-score': 0.3709388263654813, 'support': 875153}, 'weighted avg': {'precision': 0.4643813340452348, 'recall': 0.41974946095139937, 'f1-score': 0.37235933161490814, 'support': 875153}}
[[178277   8675 102681]
 [142416  24153 121393]
 [123032   9611 164915]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1646464
{'0': {'precision': 0.4027122736852318, 'recall': 0.6312649971273109, 'f1-score': 0.4917287245420113, 'support': 118356}, '1': {'precision': 0.5400775230894387, 'recall': 0.09210354508062936, 'f1-score': 0.15736964296919118, 'support': 122536}, '2': {'precision': 0.41904111586958537, 'recall': 0.5431539690996271, 'f1-score': 0.4730929285671517, 'support': 116374}, 'accuracy': 0.41764119731516575, 'macro avg': {'precision': 0.45394363754808537, 'recall': 0.42217417043585576, 'f1-score': 0.3740637653594514, 'support': 357266}, 'weighted avg': {'precision': 0.4551450293388788, 'recall': 0.41764119731516575, 'f1-score': 0.3709790687102629, 'support': 357266}}
[[74714  4750 38892]
 [62509 11286 48741]
 [48304  4861 63209]]
training model: results/universal/W9/deepOF_L2/h30
Epoch 1/50
6697/6697 - 156s - loss: 2.8547 - accuracy30: 0.5202 - val_loss: 3.0607 - val_accuracy30: 0.4558 - 156s/epoch - 23ms/step
Epoch 2/50
6697/6697 - 152s - loss: 2.7703 - accuracy30: 0.5398 - val_loss: 3.0061 - val_accuracy30: 0.4777 - 152s/epoch - 23ms/step
Epoch 3/50
6697/6697 - 150s - loss: 2.7413 - accuracy30: 0.5441 - val_loss: 3.0011 - val_accuracy30: 0.4803 - 150s/epoch - 22ms/step
Epoch 4/50
6697/6697 - 150s - loss: 2.7266 - accuracy30: 0.5464 - val_loss: 2.9984 - val_accuracy30: 0.4849 - 150s/epoch - 22ms/step
Epoch 5/50
6697/6697 - 151s - loss: 2.7170 - accuracy30: 0.5481 - val_loss: 3.0058 - val_accuracy30: 0.4843 - 151s/epoch - 22ms/step
Epoch 6/50
6697/6697 - 150s - loss: 2.7097 - accuracy30: 0.5496 - val_loss: 3.0045 - val_accuracy30: 0.4852 - 150s/epoch - 22ms/step
Epoch 7/50
6697/6697 - 151s - loss: 2.7040 - accuracy30: 0.5507 - val_loss: 3.0085 - val_accuracy30: 0.4815 - 151s/epoch - 22ms/step
Epoch 8/50
6697/6697 - 151s - loss: 2.6991 - accuracy30: 0.5520 - val_loss: 3.0016 - val_accuracy30: 0.4875 - 151s/epoch - 23ms/step
Epoch 9/50
6697/6697 - 151s - loss: 2.6946 - accuracy30: 0.5530 - val_loss: 3.0060 - val_accuracy30: 0.4868 - 151s/epoch - 23ms/step
Epoch 10/50
6697/6697 - 151s - loss: 2.6903 - accuracy30: 0.5538 - val_loss: 3.0059 - val_accuracy30: 0.4879 - 151s/epoch - 23ms/step
Epoch 11/50
6697/6697 - 151s - loss: 2.6872 - accuracy30: 0.5548 - val_loss: 3.0169 - val_accuracy30: 0.4887 - 151s/epoch - 22ms/step
Epoch 12/50
6697/6697 - 151s - loss: 2.6844 - accuracy30: 0.5551 - val_loss: 3.0130 - val_accuracy30: 0.4883 - 151s/epoch - 23ms/step
Epoch 13/50
6697/6697 - 151s - loss: 2.6810 - accuracy30: 0.5559 - val_loss: 3.0130 - val_accuracy30: 0.4865 - 151s/epoch - 22ms/step
Epoch 14/50
6697/6697 - 151s - loss: 2.6777 - accuracy30: 0.5566 - val_loss: 3.0270 - val_accuracy30: 0.4877 - 151s/epoch - 23ms/step
testing model in sample: results/universal/W9/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 129s - 129s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1001655
{'0': {'precision': 0.3777638186489109, 'recall': 0.6169327518188913, 'f1-score': 0.46859490440804547, 'support': 1205817}, '1': {'precision': 0.7819005480441895, 'recall': 0.3239830772928729, 'f1-score': 0.45813599168742564, 'support': 1897096}, '2': {'precision': 0.3973602891584271, 'recall': 0.5120085859210484, 'f1-score': 0.44745731974915937, 'support': 1204763}, 'accuracy': 0.4585730217407252, 'macro avg': {'precision': 0.5190082186171758, 'recall': 0.48430813834427083, 'f1-score': 0.4580627386148768, 'support': 4307676}, 'weighted avg': {'precision': 0.5612259163993736, 'recall': 0.4585730217407252, 'f1-score': 0.45807708891007615, 'support': 4307676}}
[[743908  83570 378339]
 [725290 614627 557179]
 [500043  87871 616849]]
Evaluating performance on  train set...
6697/6697 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0523653
{'0': {'precision': 0.3859934917764869, 'recall': 0.6316112710534936, 'f1-score': 0.4791601786165311, 'support': 464056}, '1': {'precision': 0.7919339888876806, 'recall': 0.3928313653771566, 'f1-score': 0.5251613900144221, 'support': 778642}, '2': {'precision': 0.4155087664976584, 'recall': 0.5011256076265487, 'f1-score': 0.4543187315754798, 'support': 471301}, 'accuracy': 0.48725757716311385, 'macro avg': {'precision': 0.5311454157206087, 'recall': 0.5085227480190663, 'f1-score': 0.48621343340214435, 'support': 1713999}, 'weighted avg': {'precision': 0.578521549869296, 'recall': 0.48725757716311385, 'f1-score': 0.49322709254902586, 'support': 1713999}}
[[293103  39047 131906]
 [272440 305875 200327]
 [193804  41316 236181]]
Evaluating performance on  val set...
2631/2631 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0563009
{'0': {'precision': 0.38460315289672786, 'recall': 0.6527993695210952, 'f1-score': 0.484033324194462, 'support': 185256}, '1': {'precision': 0.7793909371768101, 'recall': 0.38663159270635905, 'f1-score': 0.5168633566827644, 'support': 306020}, '2': {'precision': 0.41955889399226587, 'recall': 0.47738574473123374, 'f1-score': 0.4466082440765985, 'support': 181589}, 'accuracy': 0.48440623304823405, 'macro avg': {'precision': 0.5278509946886013, 'recall': 0.5056055689862293, 'f1-score': 0.482501641651275, 'support': 672865}, 'weighted avg': {'precision': 0.5735868804129286, 'recall': 0.48440623304823405, 'f1-score': 0.4888644027444648, 'support': 672865}}
[[120935  16799  47522]
 [115296 118317  72407]
 [ 78210  16691  86688]]
testing model out of sample: results/universal/W9/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8966246
{'0': {'precision': 0.42116445215794923, 'recall': 0.5775202037252377, 'f1-score': 0.4871026680528812, 'support': 479862}, '1': {'precision': 0.7886646036910632, 'recall': 0.5891950064913075, 'f1-score': 0.6744914254794313, 'support': 1260917}, '2': {'precision': 0.4170912232136722, 'recall': 0.5418876378700891, 'f1-score': 0.4713692593143858, 'support': 470461}, 'accuracy': 0.5765963893561983, 'macro avg': {'precision': 0.5423067596875616, 'recall': 0.5695342826955447, 'f1-score': 0.5443211176155661, 'support': 2211240}, 'weighted avg': {'precision': 0.6298577162126542, 'recall': 0.5765963893561983, 'f1-score': 0.5906100732370728, 'support': 2211240}}
[[277130 100089 102643]
 [264345 742926 253646]
 [116534  98990 254937]]
Evaluating performance on  train set...
3947/3947 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91854453
{'0': {'precision': 0.40945960246761415, 'recall': 0.5736362447128592, 'f1-score': 0.4778392043762214, 'support': 229330}, '1': {'precision': 0.7857021108407544, 'recall': 0.5779377588158657, 'f1-score': 0.6659924326655904, 'support': 550343}, '2': {'precision': 0.42181552648010245, 'recall': 0.5201151800122662, 'f1-score': 0.46583608958701, 'support': 229901}, 'accuracy': 0.5637932434868569, 'macro avg': {'precision': 0.5389924132628237, 'recall': 0.557229727846997, 'f1-score': 0.5365559088762739, 'support': 1009574}, 'weighted avg': {'precision': 0.6173721181148022, 'recall': 0.5637932434868569, 'f1-score': 0.5776726826782593, 'support': 1009574}}
[[131552  42083  55695]
 [124072 318064 108207]
 [ 65658  44668 119575]]
Evaluating performance on  val set...
1402/1402 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92052114
{'0': {'precision': 0.4141594007122682, 'recall': 0.5739378836686319, 'f1-score': 0.48113029699338145, 'support': 82265}, '1': {'precision': 0.7957422155732535, 'recall': 0.5617629091210304, 'f1-score': 0.6585882495751396, 'support': 193158}, '2': {'precision': 0.42484496231819574, 'recall': 0.5533941896689125, 'f1-score': 0.4806733265161645, 'support': 82818}, 'accuracy': 0.5626240435907671, 'macro avg': {'precision': 0.5449155262012392, 'recall': 0.5630316608195249, 'f1-score': 0.5401306243615619, 'support': 358241}, 'weighted avg': {'precision': 0.6223732293750899, 'recall': 0.5626240435907671, 'f1-score': 0.5767072349312643, 'support': 358241}}
[[ 47215  13868  21182]
 [ 43785 108509  40864]
 [ 23002  13985  45831]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.119008
{'0': {'precision': 0.37593239660000494, 'recall': 0.601673739737437, 'f1-score': 0.46273983467040836, 'support': 25213}, '1': {'precision': 0.459562512542645, 'recall': 0.10148460004431642, 'f1-score': 0.16625526354000292, 'support': 22565}, '2': {'precision': 0.4624758606912166, 'recall': 0.5034067845752392, 'f1-score': 0.48207406379065004, 'support': 27592}, 'accuracy': 0.41594798991641235, 'macro avg': {'precision': 0.4326569232779556, 'recall': 0.4021883747856642, 'f1-score': 0.3703563873336871, 'support': 75370}, 'weighted avg': {'precision': 0.43265285337923254, 'recall': 0.41594798991641235, 'f1-score': 0.38105343029636174, 'support': 75370}}
[[15170  1394  8649]
 [12780  2290  7495]
 [12403  1299 13890]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1088101
{'0': {'precision': 0.41952931461601983, 'recall': 0.5801644398766701, 'f1-score': 0.4869411031772656, 'support': 17514}, '1': {'precision': 0.5457556935817806, 'recall': 0.15958348468337571, 'f1-score': 0.2469552182874274, 'support': 16518}, '2': {'precision': 0.4308946772366931, 'recall': 0.5564851108640965, 'f1-score': 0.4857026143790851, 'support': 17093}, 'accuracy': 0.43636185819070905, 'macro avg': {'precision': 0.4653932284781645, 'recall': 0.43207767847471407, 'f1-score': 0.40653297861459264, 'support': 51125}, 'weighted avg': {'precision': 0.4641117199173715, 'recall': 0.43636185819070905, 'f1-score': 0.408989879008314, 'support': 51125}}
[[10161  1126  6227]
 [ 7546  2636  6336]
 [ 6513  1068  9512]]
Evaluating performance on  val set...
53/53 - 1s - 658ms/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1206859
{'0': {'precision': 0.4020973782771536, 'recall': 0.6062796476168963, 'f1-score': 0.4835164835164836, 'support': 4427}, '1': {'precision': 0.6070287539936102, 'recall': 0.1211734693877551, 'f1-score': 0.20202020202020202, 'support': 4704}, '2': {'precision': 0.41766109785202865, 'recall': 0.5633478960680616, 'f1-score': 0.4796867351933431, 'support': 4349}, 'accuracy': 0.42314540059347183, 'macro avg': {'precision': 0.47559574337426413, 'recall': 0.430267004357571, 'f1-score': 0.3884078069100096, 'support': 13480}, 'weighted avg': {'precision': 0.47863178538407813, 'recall': 0.42314540059347183, 'f1-score': 0.38404956336694, 'support': 13480}}
[[2684  197 1546]
 [2264  570 1870]
 [1727  172 2450]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
1118/1118 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7478701
{'0': {'precision': 0.2902464525765497, 'recall': 0.6544082979726544, 'f1-score': 0.4021356731923348, 'support': 29694}, '1': {'precision': 0.8855269206990029, 'recall': 0.7429980092487907, 'f1-score': 0.8080253818855114, 'support': 225543}, '2': {'precision': 0.49993324878179024, 'recall': 0.4845064044507698, 'f1-score': 0.49209895200236536, 'support': 30916}, 'accuracy': 0.7058776249069554, 'macro avg': {'precision': 0.5585688740191143, 'recall': 0.6273042372240717, 'f1-score': 0.5674200023600705, 'support': 286153}, 'weighted avg': {'precision': 0.7820952873370578, 'recall': 0.7058776249069554, 'f1-score': 0.7317736196597003, 'support': 286153}}
[[ 19432   8738   1524]
 [ 44506 167578  13459]
 [  3012  12925  14979]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7814048
{'0': {'precision': 0.3495344916061872, 'recall': 0.6156627283878882, 'f1-score': 0.44590961165275533, 'support': 15489}, '1': {'precision': 0.8812059622292029, 'recall': 0.7157407878017789, 'f1-score': 0.7899011655953061, 'support': 98375}, '2': {'precision': 0.40318627450980393, 'recall': 0.5785839900996548, 'f1-score': 0.47521733315500875, 'support': 15353}, 'accuracy': 0.6874482459738269, 'macro avg': {'precision': 0.5446422427817313, 'recall': 0.6366625020964406, 'f1-score': 0.57034270346769, 'support': 129217}, 'weighted avg': {'precision': 0.7606792848257976, 'recall': 0.6874482459738269, 'f1-score': 0.7112781820987688, 'support': 129217}}
[[ 9536  4471  1482]
 [16297 70411 11667]
 [ 1449  5021  8883]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7626014
{'0': {'precision': 0.3599714227393346, 'recall': 0.6188805053518162, 'f1-score': 0.45518487449183714, 'support': 5699}, '1': {'precision': 0.8812273286964625, 'recall': 0.7287739094536948, 'f1-score': 0.7977825982164376, 'support': 36335}, '2': {'precision': 0.43784530386740333, 'recall': 0.6036004846806301, 'f1-score': 0.5075322028964413, 'support': 5777}, 'accuracy': 0.7005500826169709, 'macro avg': {'precision': 0.5596813517677334, 'recall': 0.6504182998287137, 'f1-score': 0.586833225201572, 'support': 47811}, 'weighted avg': {'precision': 0.7655205799255279, 'recall': 0.7005500826169709, 'f1-score': 0.7218745234790317, 'support': 47811}}
[[ 3527  1815   357]
 [ 5735 26480  4120]
 [  536  1754  3487]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.129384
{'0': {'precision': 0.3914284573618652, 'recall': 0.49263893076072757, 'f1-score': 0.4362402669632925, 'support': 39804}, '1': {'precision': 0.5368476643141773, 'recall': 0.2267280358482532, 'f1-score': 0.3188116553572447, 'support': 49319}, '2': {'precision': 0.35659256745291024, 'recall': 0.515908867720711, 'f1-score': 0.42170536413076193, 'support': 40732}, 'accuracy': 0.39894497708983095, 'macro avg': {'precision': 0.4282895630429842, 'recall': 0.41175861144323056, 'f1-score': 0.3922524288170997, 'support': 129855}, 'weighted avg': {'precision': 0.4357316755660893, 'recall': 0.39894497708983095, 'f1-score': 0.3870816103233995, 'support': 129855}}
[[19609  5106 15089]
 [15310 11182 22827]
 [15177  4541 21014]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1629522
{'0': {'precision': 0.38247246781448735, 'recall': 0.5486383054467782, 'f1-score': 0.4507284259783939, 'support': 22472}, '1': {'precision': 0.5089323392882262, 'recall': 0.16187195203794014, 'f1-score': 0.2456211812627291, 'support': 22351}, '2': {'precision': 0.38504245591116915, 'recall': 0.4805924181348793, 'f1-score': 0.42754396921651183, 'support': 22079}, 'accuracy': 0.3969687004872799, 'macro avg': {'precision': 0.4254824210046276, 'recall': 0.3970342252065325, 'f1-score': 0.3746311921525449, 'support': 66902}, 'weighted avg': {'precision': 0.42556904720667554, 'recall': 0.3969687004872799, 'f1-score': 0.3745536980556798, 'support': 66902}}
[[12329  1749  8394]
 [10180  3618  8553]
 [ 9726  1742 10611]]
Evaluating performance on  val set...
73/73 - 1s - 870ms/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1833454
{'0': {'precision': 0.38974793475958486, 'recall': 0.5687789799072643, 'f1-score': 0.4625439919557567, 'support': 6470}, '1': {'precision': 0.44903988183161003, 'recall': 0.10886302596239929, 'f1-score': 0.17524138924917135, 'support': 5585}, '2': {'precision': 0.402698230876925, 'recall': 0.47953925431949074, 'f1-score': 0.437772397094431, 'support': 6598}, 'accuracy': 0.3995067817509248, 'macro avg': {'precision': 0.41382868248937327, 'recall': 0.38572708672971806, 'f1-score': 0.3585192594331197, 'support': 18653}, 'weighted avg': {'precision': 0.4120816922344934, 'recall': 0.3995067817509248, 'f1-score': 0.36775880892829166, 'support': 18653}}
[[3680  374 2416]
 [2700  608 2277]
 [3062  372 3164]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3720645
{'0': {'precision': 0.3182562268617624, 'recall': 0.5149027197718243, 'f1-score': 0.3933727110716815, 'support': 49085}, '1': {'precision': 0.5773092369477911, 'recall': 0.009652833736234219, 'f1-score': 0.01898817779539, 'support': 59568}, '2': {'precision': 0.293697126949377, 'recall': 0.4749863402906786, 'f1-score': 0.3629637670872546, 'support': 45755}, 'accuracy': 0.3081576084140718, 'macro avg': {'precision': 0.3964208635863102, 'recall': 0.33318063126624575, 'f1-score': 0.25844155198477536, 'support': 154408}, 'weighted avg': {'precision': 0.41091702221118326, 'recall': 0.3081576084140718, 'f1-score': 0.23993053767257272, 'support': 154408}}
[[25274   248 23563]
 [30291   575 28702]
 [23849   173 21733]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3009874
{'0': {'precision': 0.34535300772693356, 'recall': 0.4932952826296245, 'f1-score': 0.4062752205247285, 'support': 29084}, '1': {'precision': 0.5085324232081911, 'recall': 0.010851753395724846, 'f1-score': 0.02125004456804649, 'support': 27461}, '2': {'precision': 0.31054658569100874, 'recall': 0.48213875047911076, 'f1-score': 0.3777704366628626, 'support': 26090}, 'accuracy': 0.3294487807829612, 'macro avg': {'precision': 0.3881440055420445, 'recall': 0.32876192883482, 'f1-score': 0.2684319005852125, 'support': 82635}, 'weighted avg': {'precision': 0.3885909865205868, 'recall': 0.3294487807829612, 'f1-score': 0.2693251852139942, 'support': 82635}}
[[14347   188 14549]
 [13785   298 13378]
 [13411   100 12579]]
Evaluating performance on  val set...
112/112 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2457329
{'0': {'precision': 0.36782390108023644, 'recall': 0.5129322595926101, 'f1-score': 0.4284244678325552, 'support': 10555}, '1': {'precision': 0.2987012987012987, 'recall': 0.005763688760806916, 'f1-score': 0.011309157959434542, 'support': 7981}, '2': {'precision': 0.33660227105146734, 'recall': 0.46115769269623197, 'f1-score': 0.38915647244362983, 'support': 9899}, 'accuracy': 0.3525584666783893, 'macro avg': {'precision': 0.3343758236110008, 'recall': 0.326617880349883, 'f1-score': 0.2762966994118732, 'support': 28435}, 'weighted avg': {'precision': 0.3375537971505341, 'recall': 0.3525584666783893, 'f1-score': 0.29768027319733986, 'support': 28435}}
[[5414   56 5085]
 [4023   46 3912]
 [5282   52 4565]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1742847
{'0': {'precision': 0.4136241857533095, 'recall': 0.5236163527240686, 'f1-score': 0.46216606869024823, 'support': 60149}, '1': {'precision': 0.3612870956985662, 'recall': 0.049246642274390386, 'f1-score': 0.0866782664346713, 'support': 44003}, '2': {'precision': 0.3918420454258356, 'recall': 0.5427456606942889, 'f1-score': 0.45511099373505287, 'support': 57152}, 'accuracy': 0.40098819620096215, 'macro avg': {'precision': 0.38891777562590374, 'recall': 0.3718695518975826, 'f1-score': 0.33465177628665743, 'support': 161304}, 'weighted avg': {'precision': 0.39162918341192515, 'recall': 0.40098819620096215, 'f1-score': 0.35723499812478504, 'support': 161304}}
[[31495  2096 26558]
 [20251  2167 21585]
 [24398  1735 31019]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1729611
{'0': {'precision': 0.3769207640328528, 'recall': 0.5832598687432657, 'f1-score': 0.4579195785709479, 'support': 40836}, '1': {'precision': 0.5167145318782309, 'recall': 0.1133368609368307, 'f1-score': 0.1858984956191106, 'support': 39687}, '2': {'precision': 0.39520335764964526, 'recall': 0.47754057187017, 'f1-score': 0.4324879979878175, 'support': 41408}, 'accuracy': 0.39440339208240727, 'macro avg': {'precision': 0.429612884520243, 'recall': 0.3913791005167555, 'f1-score': 0.3587686907259587, 'support': 121931}, 'weighted avg': {'precision': 0.4286306729236489, 'recall': 0.39440339208240727, 'f1-score': 0.36074353959894057, 'support': 121931}}
[[23818  2038 14980]
 [19908  4498 15281]
 [19465  2169 19774]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1706438
{'0': {'precision': 0.3690164588971208, 'recall': 0.5422425032594524, 'f1-score': 0.43916475277843775, 'support': 15340}, '1': {'precision': 0.5446376245360421, 'recall': 0.16961732676279126, 'f1-score': 0.2586750788643533, 'support': 16437}, '2': {'precision': 0.38953942232630756, 'recall': 0.49576102795072197, 'f1-score': 0.4362777955876781, 'support': 15098}, 'accuracy': 0.396608, 'macro avg': {'precision': 0.43439783525315684, 'recall': 0.40254028599098857, 'f1-score': 0.37803920907682304, 'support': 46875}, 'weighted avg': {'precision': 0.43720932932828477, 'recall': 0.396608, 'f1-score': 0.3749451037162106, 'support': 46875}}
[[8318 1166 5856]
 [7775 2788 5874]
 [6448 1165 7485]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/EXC
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7627727
{'0': {'precision': 0.37162310886759503, 'recall': 0.6596168622292836, 'f1-score': 0.47540606623772175, 'support': 76787}, '1': {'precision': 0.877410620466589, 'recall': 0.6877909829423218, 'f1-score': 0.7711148669671903, 'support': 450413}, '2': {'precision': 0.3933068462362071, 'recall': 0.5912367979994148, 'f1-score': 0.4723761750155429, 'support': 75178}, 'accuracy': 0.6721493812855052, 'macro avg': {'precision': 0.5474468585234636, 'recall': 0.6462148810570066, 'f1-score': 0.5729657027401517, 'support': 602378}, 'weighted avg': {'precision': 0.7525191749087439, 'recall': 0.6721493812855052, 'f1-score': 0.6961367484682501, 'support': 602378}}
[[ 50650  20249   5888]
 [ 77948 309790  62675]
 [  7696  23034  44448]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7549521
{'0': {'precision': 0.3593290007221019, 'recall': 0.6631131156783353, 'f1-score': 0.46609146747843005, 'support': 39022}, '1': {'precision': 0.8798422627141692, 'recall': 0.6723374010773425, 'f1-score': 0.7622195729923051, 'support': 240592}, '2': {'precision': 0.40220785709824497, 'recall': 0.6393080512260498, 'f1-score': 0.4937701272810919, 'support': 40292}, 'accuracy': 0.6670521965827462, 'macro avg': {'precision': 0.5471263735115054, 'recall': 0.6582528559939093, 'f1-score': 0.5740270559172757, 'support': 319906}, 'weighted avg': {'precision': 0.756192459395284, 'recall': 0.6670521965827462, 'f1-score': 0.6922869177749643, 'support': 319906}}
[[ 25876  10423   2723]
 [ 43271 161759  35562]
 [  2865  11668  25759]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7731568
{'0': {'precision': 0.32284820031298905, 'recall': 0.6585163432073544, 'f1-score': 0.43327592724828834, 'support': 15664}, '1': {'precision': 0.881159750830328, 'recall': 0.64966894377299, 'f1-score': 0.7479114111661616, 'support': 95150}, '2': {'precision': 0.40275738293359437, 'recall': 0.6247390066434673, 'f1-score': 0.4897695989682795, 'support': 15805}, 'accuracy': 0.6476516162661212, 'macro avg': {'precision': 0.5355884446923038, 'recall': 0.6443080978746039, 'f1-score': 0.5569856457942431, 'support': 126619}, 'weighted avg': {'precision': 0.7523754329008587, 'recall': 0.6476516162661212, 'f1-score': 0.6767658361586422, 'support': 126619}}
[[10315  3786  1563]
 [20255 61816 13079]
 [ 1380  4551  9874]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/AAL
Evaluating performance on  test set...
3870/3870 - 33s - 33s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7878868
{'0': {'precision': 0.3997908060205643, 'recall': 0.6018085167851158, 'f1-score': 0.48042666666666667, 'support': 138456}, '1': {'precision': 0.8601877722437221, 'recall': 0.688217578868591, 'f1-score': 0.7646529322062529, 'support': 720217}, '2': {'precision': 0.369793006382101, 'recall': 0.5771354557229532, 'f1-score': 0.45076405198984815, 'support': 132021}, 'accuracy': 0.661338415292714, 'macro avg': {'precision': 0.5432571948821292, 'recall': 0.62238718379222, 'f1-score': 0.5652812169542559, 'support': 990694}, 'weighted avg': {'precision': 0.7304937095571503, 'recall': 0.661338415292714, 'f1-score': 0.6831012566368048, 'support': 990694}}
[[ 83324  41308  13824]
 [108524 495666 116027]
 [ 16571  39256  76194]]
Evaluating performance on  train set...
1577/1577 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76709175
{'0': {'precision': 0.35543608124253284, 'recall': 0.5960826807875529, 'f1-score': 0.4453286695128191, 'support': 48911}, '1': {'precision': 0.8764563255160048, 'recall': 0.7001966350661527, 'f1-score': 0.778474128741881, 'support': 307168}, '2': {'precision': 0.3610114471211345, 'recall': 0.579136008095971, 'f1-score': 0.44477007772020727, 'support': 47431}, 'accuracy': 0.6733463854675225, 'macro avg': {'precision': 0.530967951293224, 'recall': 0.6251384413165589, 'f1-score': 0.5561909586583025, 'support': 403510}, 'weighted avg': {'precision': 0.7527129556000005, 'recall': 0.6733463854675225, 'f1-score': 0.6988666979462089, 'support': 403510}}
[[ 29155  15304   4452]
 [ 47922 215078  44168]
 [  4949  15013  27469]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76624274
{'0': {'precision': 0.3552964711030538, 'recall': 0.6453755748594788, 'f1-score': 0.45829133572551706, 'support': 17613}, '1': {'precision': 0.8954737544483986, 'recall': 0.6830354492013538, 'f1-score': 0.774959457573614, 'support': 117887}, '2': {'precision': 0.3600849795478327, 'recall': 0.6326462395543175, 'f1-score': 0.45894881484026107, 'support': 17950}, 'accuracy': 0.6728185076572173, 'macro avg': {'precision': 0.536951735033095, 'recall': 0.6536857545383834, 'f1-score': 0.5640665360464641, 'support': 153450}, 'weighted avg': {'precision': 0.7708444224117306, 'recall': 0.6728185076572173, 'f1-score': 0.7016465434831988, 'support': 153450}}
[[11367  4569  1677]
 [18862 80521 18504]
 [ 1764  4830 11356]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/WBA
Evaluating performance on  test set...
2451/2451 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98551285
{'0': {'precision': 0.4793252505769297, 'recall': 0.5764331869770525, 'f1-score': 0.5234132581100142, 'support': 193136}, '1': {'precision': 0.5907623388520231, 'recall': 0.4228524136607521, 'f1-score': 0.4928998522647304, 'support': 250118}, '2': {'precision': 0.4568724108403342, 'recall': 0.5361983453116257, 'f1-score': 0.49336712252079334, 'support': 184083}, 'accuracy': 0.5033945072584591, 'macro avg': {'precision': 0.508986666756429, 'recall': 0.5118279819831434, 'f1-score': 0.5032267442985127, 'support': 627337}, 'weighted avg': {'precision': 0.5171665313366459, 'recall': 0.5033945072584591, 'f1-score': 0.5024310191843948, 'support': 627337}}
[[111330  37222  44584]
 [ 71599 105763  72756]
 [ 49335  36043  98705]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9563395
{'0': {'precision': 0.4820789543074547, 'recall': 0.5565993628426352, 'f1-score': 0.5166659096987772, 'support': 91971}, '1': {'precision': 0.6234414220582962, 'recall': 0.4916577116678921, 'f1-score': 0.5497623909076126, 'support': 123767}, '2': {'precision': 0.4787937460670894, 'recall': 0.5414012041598248, 'f1-score': 0.5081764237457936, 'support': 91350}, 'accuracy': 0.5259046266868129, 'macro avg': {'precision': 0.5281047074776134, 'recall': 0.5298860928901173, 'f1-score': 0.5248682414507279, 'support': 307088}, 'weighted avg': {'precision': 0.5380756222767697, 'recall': 0.5259046266868129, 'f1-score': 0.5274795450344755, 'support': 307088}}
[[51191 18716 22064]
 [31142 60851 31774]
 [23855 18038 49457]]
Evaluating performance on  val set...
441/441 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93958044
{'0': {'precision': 0.4861417283828301, 'recall': 0.5669757633532657, 'f1-score': 0.5234564608614483, 'support': 34617}, '1': {'precision': 0.6366846412832234, 'recall': 0.5155598900611756, 'f1-score': 0.5697559063797474, 'support': 45116}, '2': {'precision': 0.49321759517695657, 'recall': 0.5354686221629648, 'f1-score': 0.5134754246030017, 'support': 33001}, 'accuracy': 0.5371760072382777, 'macro avg': {'precision': 0.5386813216143368, 'recall': 0.539334758525802, 'f1-score': 0.5355625972813991, 'support': 112734}, 'weighted avg': {'precision': 0.5484601481895177, 'recall': 0.5371760072382777, 'f1-score': 0.5390636566181728, 'support': 112734}}
[[19627  7161  7829]
 [11528 23260 10328]
 [ 9218  6112 17671]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
3337/3337 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91526955
{'0': {'precision': 0.4511364319325176, 'recall': 0.5901220865704773, 'f1-score': 0.5113534589329973, 'support': 216240}, '1': {'precision': 0.6937520601720056, 'recall': 0.5449739061657718, 'f1-score': 0.6104284247148736, 'support': 424813}, '2': {'precision': 0.4749334591152589, 'recall': 0.5295355083488289, 'f1-score': 0.5007504240561974, 'support': 212964}, 'accuracy': 0.5525557453774339, 'macro avg': {'precision': 0.5399406504065941, 'recall': 0.5548771670283593, 'f1-score': 0.5408441025680227, 'support': 854017}, 'weighted avg': {'precision': 0.5777547345848617, 'recall': 0.5525557453774339, 'f1-score': 0.5579921894491268, 'support': 854017}}
[[127608  50060  38572]
 [107197 231512  86104]
 [ 48054  52138 112772]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92969495
{'0': {'precision': 0.4694136609238118, 'recall': 0.564364388485597, 'f1-score': 0.5125284945746329, 'support': 99597}, '1': {'precision': 0.6646829261255023, 'recall': 0.559734903018485, 'f1-score': 0.6077112311456705, 'support': 164619}, '2': {'precision': 0.4851488824534046, 'recall': 0.5129845912258317, 'f1-score': 0.4986785990287464, 'support': 101890}, 'accuracy': 0.5479833709362862, 'macro avg': {'precision': 0.5397484898342396, 'recall': 0.5456946275766379, 'f1-score': 0.5396394415830166, 'support': 366106}, 'weighted avg': {'precision': 0.5615954139950188, 'recall': 0.5479833709362862, 'f1-score': 0.5514727376474513, 'support': 366106}}
[[56209 21871 21517]
 [38525 92143 33951]
 [25009 24613 52268]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9551195
{'0': {'precision': 0.49031303463263515, 'recall': 0.5520760119744891, 'f1-score': 0.5193647528437962, 'support': 38415}, '1': {'precision': 0.6160208301424415, 'recall': 0.4971057781439901, 'f1-score': 0.5502114707190006, 'support': 48545}, '2': {'precision': 0.49027793795409985, 'recall': 0.5475104963552533, 'f1-score': 0.5173160699944024, 'support': 38823}, 'accuracy': 0.52945151570562, 'macro avg': {'precision': 0.5322039342430588, 'recall': 0.5322307621579109, 'f1-score': 0.5289640978523997, 'support': 125783}, 'weighted avg': {'precision': 0.5388181774156247, 'recall': 0.52945151570562, 'f1-score': 0.5306374836976459, 'support': 125783}}
[[21208  7518  9689]
 [12003 24132 12410]
 [10043  7524 21256]]
testing model on single stock: results/universal/W9/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
10303/10303 - 89s - 89s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2268084
{'0': {'precision': 0.3693889298862535, 'recall': 0.6266370323702187, 'f1-score': 0.4647926692391367, 'support': 857115}, '1': {'precision': 0.48549094855381325, 'recall': 0.03386676672657095, 'f1-score': 0.06331670145174274, 'support': 911454}, '2': {'precision': 0.3902692990508986, 'recall': 0.5030000080568028, 'f1-score': 0.4395213380890434, 'support': 868831}, 'accuracy': 0.3810533100781072, 'macro avg': {'precision': 0.4150497258303218, 'recall': 0.38783460238453077, 'f1-score': 0.32254356959330766, 'support': 2637400}, 'weighted avg': {'precision': 0.4163909627005061, 'recall': 0.3810533100781072, 'f1-score': 0.3177222996864871, 'support': 2637400}}
[[537100  17050 302965]
 [500777  30868 379809]
 [416146  15663 437022]]
Evaluating performance on  train set...
3419/3419 - 29s - 29s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2115731
{'0': {'precision': 0.37473671858957436, 'recall': 0.6642032652778259, 'f1-score': 0.47914481292782796, 'support': 288490}, '1': {'precision': 0.51057850576097, 'recall': 0.044091288867625596, 'f1-score': 0.08117285132564879, 'support': 288447}, '2': {'precision': 0.41217849039122595, 'recall': 0.46842221745312124, 'f1-score': 0.43850421816754953, 'support': 298216}, 'accuracy': 0.39310269175789836, 'macro avg': {'precision': 0.4324979049139234, 'recall': 0.3922389238661909, 'f1-score': 0.3329406274736754, 'support': 875153}, 'weighted avg': {'precision': 0.4322682489663529, 'recall': 0.39310269175789836, 'f1-score': 0.3341261773117758, 'support': 875153}}
[[191616   5563  91311]
 [167822  12718 107907]
 [151897   6628 139691]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2178583
{'0': {'precision': 0.37703078656335504, 'recall': 0.6906191827899024, 'f1-score': 0.4877716502174391, 'support': 118721}, '1': {'precision': 0.451621531260448, 'recall': 0.05561685798514468, 'f1-score': 0.0990373406259852, 'support': 121438}, '2': {'precision': 0.4098249042820755, 'recall': 0.4369081267558728, 'f1-score': 0.42293337962331523, 'support': 117107}, 'accuracy': 0.39161297184730703, 'macro avg': {'precision': 0.41282574070195954, 'recall': 0.39438138917697335, 'f1-score': 0.3365807901555799, 'support': 357266}, 'weighted avg': {'precision': 0.4131343385336287, 'recall': 0.39161297184730703, 'f1-score': 0.3343841673821482, 'support': 357266}}
[[81991  4026 32704]
 [73707  6754 40977]
 [61767  4175 51165]]
training model: results/universal/W9/deepVOL_L2/h10
Epoch 1/50
6697/6697 - 254s - loss: 2.7035 - accuracy10: 0.5506 - val_loss: 2.8358 - val_accuracy10: 0.5425 - 254s/epoch - 38ms/step
Epoch 2/50
6697/6697 - 237s - loss: 2.6130 - accuracy10: 0.5777 - val_loss: 2.7956 - val_accuracy10: 0.5615 - 237s/epoch - 35ms/step
Epoch 3/50
6697/6697 - 238s - loss: 2.5789 - accuracy10: 0.5863 - val_loss: 2.7931 - val_accuracy10: 0.5705 - 238s/epoch - 35ms/step
Epoch 4/50
6697/6697 - 240s - loss: 2.5610 - accuracy10: 0.5911 - val_loss: 2.7753 - val_accuracy10: 0.5733 - 240s/epoch - 36ms/step
Epoch 5/50
6697/6697 - 244s - loss: 2.5514 - accuracy10: 0.5924 - val_loss: 2.7741 - val_accuracy10: 0.5780 - 244s/epoch - 36ms/step
Epoch 6/50
6697/6697 - 230s - loss: 2.5421 - accuracy10: 0.5943 - val_loss: 2.7686 - val_accuracy10: 0.5768 - 230s/epoch - 34ms/step
Epoch 7/50
6697/6697 - 224s - loss: 2.5348 - accuracy10: 0.5960 - val_loss: 2.7551 - val_accuracy10: 0.5782 - 224s/epoch - 33ms/step
Epoch 8/50
6697/6697 - 222s - loss: 2.5293 - accuracy10: 0.5969 - val_loss: 2.7586 - val_accuracy10: 0.5766 - 222s/epoch - 33ms/step
Epoch 9/50
6697/6697 - 226s - loss: 2.5233 - accuracy10: 0.5979 - val_loss: 2.7579 - val_accuracy10: 0.5785 - 226s/epoch - 34ms/step
Epoch 10/50
6697/6697 - 223s - loss: 2.5180 - accuracy10: 0.5987 - val_loss: 2.7455 - val_accuracy10: 0.5774 - 223s/epoch - 33ms/step
Epoch 11/50
6697/6697 - 229s - loss: 2.5134 - accuracy10: 0.5995 - val_loss: 2.7482 - val_accuracy10: 0.5787 - 229s/epoch - 34ms/step
Epoch 12/50
6697/6697 - 228s - loss: 2.5089 - accuracy10: 0.6005 - val_loss: 2.7492 - val_accuracy10: 0.5781 - 228s/epoch - 34ms/step
Epoch 13/50
6697/6697 - 227s - loss: 2.5049 - accuracy10: 0.6012 - val_loss: 2.7257 - val_accuracy10: 0.5794 - 227s/epoch - 34ms/step
Epoch 14/50
6697/6697 - 227s - loss: 2.5011 - accuracy10: 0.6017 - val_loss: 2.7157 - val_accuracy10: 0.5794 - 227s/epoch - 34ms/step
Epoch 15/50
6697/6697 - 230s - loss: 2.4981 - accuracy10: 0.6021 - val_loss: 2.7259 - val_accuracy10: 0.5785 - 230s/epoch - 34ms/step
Epoch 16/50
6697/6697 - 228s - loss: 2.4949 - accuracy10: 0.6029 - val_loss: 2.7091 - val_accuracy10: 0.5796 - 228s/epoch - 34ms/step
Epoch 17/50
6697/6697 - 231s - loss: 2.4916 - accuracy10: 0.6033 - val_loss: 2.6945 - val_accuracy10: 0.5789 - 231s/epoch - 34ms/step
Epoch 18/50
6697/6697 - 229s - loss: 2.4884 - accuracy10: 0.6039 - val_loss: 2.6991 - val_accuracy10: 0.5783 - 229s/epoch - 34ms/step
Epoch 19/50
6697/6697 - 228s - loss: 2.4860 - accuracy10: 0.6044 - val_loss: 2.6974 - val_accuracy10: 0.5795 - 228s/epoch - 34ms/step
Epoch 20/50
6697/6697 - 230s - loss: 2.4835 - accuracy10: 0.6047 - val_loss: 2.6993 - val_accuracy10: 0.5779 - 230s/epoch - 34ms/step
Epoch 21/50
6697/6697 - 226s - loss: 2.4809 - accuracy10: 0.6054 - val_loss: 2.6958 - val_accuracy10: 0.5798 - 226s/epoch - 34ms/step
Epoch 22/50
6697/6697 - 230s - loss: 2.4785 - accuracy10: 0.6058 - val_loss: 2.6805 - val_accuracy10: 0.5791 - 230s/epoch - 34ms/step
Epoch 23/50
6697/6697 - 233s - loss: 2.4763 - accuracy10: 0.6066 - val_loss: 2.6766 - val_accuracy10: 0.5795 - 233s/epoch - 35ms/step
Epoch 24/50
6697/6697 - 229s - loss: 2.4746 - accuracy10: 0.6068 - val_loss: 2.6880 - val_accuracy10: 0.5792 - 229s/epoch - 34ms/step
Epoch 25/50
6697/6697 - 227s - loss: 2.4723 - accuracy10: 0.6070 - val_loss: 2.6815 - val_accuracy10: 0.5785 - 227s/epoch - 34ms/step
Epoch 26/50
6697/6697 - 225s - loss: 2.4708 - accuracy10: 0.6076 - val_loss: 2.6927 - val_accuracy10: 0.5776 - 225s/epoch - 34ms/step
Epoch 27/50
6697/6697 - 229s - loss: 2.4689 - accuracy10: 0.6077 - val_loss: 2.6784 - val_accuracy10: 0.5793 - 229s/epoch - 34ms/step
Epoch 28/50
6697/6697 - 225s - loss: 2.4668 - accuracy10: 0.6081 - val_loss: 2.6829 - val_accuracy10: 0.5783 - 225s/epoch - 34ms/step
Epoch 29/50
6697/6697 - 226s - loss: 2.4648 - accuracy10: 0.6086 - val_loss: 2.6885 - val_accuracy10: 0.5780 - 226s/epoch - 34ms/step
Epoch 30/50
6697/6697 - 226s - loss: 2.4632 - accuracy10: 0.6095 - val_loss: 2.7034 - val_accuracy10: 0.5788 - 226s/epoch - 34ms/step
Epoch 31/50
6697/6697 - 221s - loss: 2.4618 - accuracy10: 0.6094 - val_loss: 2.6956 - val_accuracy10: 0.5785 - 221s/epoch - 33ms/step
Epoch 32/50
6697/6697 - 225s - loss: 2.4604 - accuracy10: 0.6097 - val_loss: 2.6876 - val_accuracy10: 0.5785 - 225s/epoch - 34ms/step
Epoch 33/50
6697/6697 - 224s - loss: 2.4585 - accuracy10: 0.6103 - val_loss: 2.6946 - val_accuracy10: 0.5780 - 224s/epoch - 33ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 267s - 267s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9240565
{'0': {'precision': 0.4272389254788235, 'recall': 0.5482597567582715, 'f1-score': 0.4802423901250407, 'support': 1070540}, '1': {'precision': 0.779818629260813, 'recall': 0.5467108568965175, 'f1-score': 0.6427830145895183, 'support': 2171219}, '2': {'precision': 0.43258465169586735, 'recall': 0.5729147219770024, 'f1-score': 0.4929572746576108, 'support': 1065937}, 'accuracy': 0.5535799183600699, 'macro avg': {'precision': 0.546547402145168, 'recall': 0.5559617785439306, 'f1-score': 0.5386608931240565, 'support': 4307696}, 'weighted avg': {'precision': 0.6062733696996888, 'recall': 0.5535799183600699, 'f1-score': 0.5653144467379336, 'support': 4307696}}
[[ 586934  179821  303785]
 [ 486940 1187029  497250]
 [ 299910  155336  610691]]
Evaluating performance on  train set...
6697/6697 - 109s - 109s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8683459
{'0': {'precision': 0.4450875682353206, 'recall': 0.5224947058569309, 'f1-score': 0.4806948293133325, 'support': 416498}, '1': {'precision': 0.8191545757667945, 'recall': 0.6196168269866078, 'f1-score': 0.7055491345975486, 'support': 877828}, '2': {'precision': 0.44126977903092995, 'recall': 0.5899389771706471, 'f1-score': 0.5048875710805881, 'support': 419679}, 'accuracy': 0.588749741103439, 'macro avg': {'precision': 0.5685039743443483, 'recall': 0.5773501700047287, 'f1-score': 0.5637105116638231, 'support': 1714005}, 'weighted avg': {'precision': 0.6357312636340091, 'recall': 0.588749741103439, 'f1-score': 0.6017776679113371, 'support': 1714005}}
[[217618  62624 136256]
 [156678 543917 177233]
 [114637  57457 247585]]
Evaluating performance on  val set...
2631/2631 - 43s - 43s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.880908
{'0': {'precision': 0.4297310637715582, 'recall': 0.5346157821458319, 'f1-score': 0.47646966388330475, 'support': 164477}, '1': {'precision': 0.8139256495462407, 'recall': 0.6025093648044467, 'f1-score': 0.6924395699593138, 'support': 347578}, '2': {'precision': 0.43836986613068374, 'recall': 0.5750467934806266, 'f1-score': 0.49749169502239315, 'support': 160813}, 'accuracy': 0.57934988734789, 'macro avg': {'precision': 0.5606755264828275, 'recall': 0.5707239801436351, 'f1-score': 0.5554669762883372, 'support': 672868}, 'weighted avg': {'precision': 0.6302560069374847, 'recall': 0.57934988734789, 'f1-score': 0.593055686561835, 'support': 672868}}
[[ 87932  25663  50882]
 [ 70564 209419  67595]
 [ 46125  22213  92475]]
testing model out of sample: results/universal/W9/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 140s - 140s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6827936
{'0': {'precision': 0.44069655056702844, 'recall': 0.5344579045260838, 'f1-score': 0.4830696382870701, 'support': 348933}, '1': {'precision': 0.8742021157470943, 'recall': 0.7848308959006964, 'f1-score': 0.8271093159486017, 'support': 1516965}, '2': {'precision': 0.45363744292665986, 'recall': 0.5598270799914293, 'f1-score': 0.5011690479646641, 'support': 345362}, 'accuracy': 0.7101806210034098, 'macro avg': {'precision': 0.5895120364135942, 'recall': 0.6263719601394032, 'f1-score': 0.603782667400112, 'support': 2211260}, 'weighted avg': {'precision': 0.7401104874855662, 'recall': 0.7101806210034098, 'f1-score': 0.7219140066331255, 'support': 2211260}}
[[ 186490   92155   70288]
 [ 163829 1190561  162575]
 [  72852   79167  193343]]
Evaluating performance on  train set...
3947/3947 - 67s - 67s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70742166
{'0': {'precision': 0.46160232461602324, 'recall': 0.5386170734042613, 'f1-score': 0.49714471375657937, 'support': 177551}, '1': {'precision': 0.8628542740320062, 'recall': 0.7815537165868837, 'f1-score': 0.820194220156747, 'support': 655319}, '2': {'precision': 0.4683308512625041, 'recall': 0.5534667360843878, 'f1-score': 0.5073520447996183, 'support': 176708}, 'accuracy': 0.6989068699991482, 'macro avg': {'precision': 0.5975958166368446, 'recall': 0.6245458420251776, 'f1-score': 0.6082303262376482, 'support': 1009578}, 'weighted avg': {'precision': 0.723233432589829, 'recall': 0.6989068699991482, 'f1-score': 0.7086233677472614, 'support': 1009578}}
[[ 95632  42429  39490]
 [ 71613 512167  71539]
 [ 39929  38977  97802]]
Evaluating performance on  val set...
1402/1402 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70151913
{'0': {'precision': 0.4682967708797967, 'recall': 0.5418008945047383, 'f1-score': 0.5023744100225478, 'support': 63946}, '1': {'precision': 0.8627027130889248, 'recall': 0.7823162736804505, 'f1-score': 0.8205453885042137, 'support': 229567}, '2': {'precision': 0.4795552225858602, 'recall': 0.5636731604072364, 'f1-score': 0.5182228787319263, 'support': 64729}, 'accuracy': 0.699878852842492, 'macro avg': {'precision': 0.6035182355181938, 'recall': 0.6292634428641417, 'f1-score': 0.6137142257528959, 'support': 358242}, 'weighted avg': {'precision': 0.7230724176649439, 'recall': 0.699878852842492, 'f1-score': 0.7091268638057165, 'support': 358242}}
[[ 34646  14806  14494]
 [ 24870 179594  25103]
 [ 14467  13776  36486]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0729313
{'0': {'precision': 0.4147026888931468, 'recall': 0.6075037425149701, 'f1-score': 0.49292085784778894, 'support': 21376}, '1': {'precision': 0.6775736568457539, 'recall': 0.3168952436533411, 'f1-score': 0.431828223027304, 'support': 30843}, '2': {'precision': 0.4488274000337439, 'recall': 0.5744331677823364, 'f1-score': 0.5039211971964387, 'support': 23155}, 'accuracy': 0.478427574495184, 'macro avg': {'precision': 0.5137012485908815, 'recall': 0.49961071798354917, 'f1-score': 0.4762234260238438, 'support': 75374}, 'weighted avg': {'precision': 0.5327525064830688, 'recall': 0.478427574495184, 'f1-score': 0.47130110464177316, 'support': 75374}}
[[12986  2287  6103]
 [10838  9774 10231]
 [ 7490  2364 13301]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0309991
{'0': {'precision': 0.45262569832402233, 'recall': 0.551006528835691, 'f1-score': 0.49699423383633906, 'support': 14704}, '1': {'precision': 0.7050011888721566, 'recall': 0.4020520701500633, 'f1-score': 0.5120750698022509, 'support': 22124}, '2': {'precision': 0.4256743644478944, 'recall': 0.6135235298230893, 'f1-score': 0.5026208002749692, 'support': 14301}, 'accuracy': 0.5040388038099709, 'macro avg': {'precision': 0.5277670838813577, 'recall': 0.5221940429362811, 'f1-score': 0.5038967013045198, 'support': 51129}, 'weighted avg': {'precision': 0.5542925474140576, 'recall': 0.5040388038099709, 'f1-score': 0.5050936283394329, 'support': 51129}}
[[8102 1984 4618]
 [6009 8895 7220]
 [3789 1738 8774]]
Evaluating performance on  val set...
53/53 - 1s - 509ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0120875
{'0': {'precision': 0.42047112778820095, 'recall': 0.5538165842943438, 'f1-score': 0.4780187225974642, 'support': 3642}, '1': {'precision': 0.7192285876347135, 'recall': 0.4179301252471984, 'f1-score': 0.5286637481759433, 'support': 6068}, '2': {'precision': 0.4463835563312003, 'recall': 0.6106100795755968, 'f1-score': 0.5157387700235242, 'support': 3770}, 'accuracy': 0.5085311572700296, 'macro avg': {'precision': 0.5286944239180382, 'recall': 0.5274522630390464, 'f1-score': 0.5074737469323106, 'support': 13480}, 'weighted avg': {'precision': 0.5622033326810604, 'recall': 0.5085311572700296, 'f1-score': 0.5113657993041747, 'support': 13480}}
[[2017  534 1091]
 [1768 2536 1764]
 [1012  456 2302]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.44071293
{'0': {'precision': 0.34759815983738096, 'recall': 0.5526136750198435, 'f1-score': 0.42676065588125833, 'support': 17638}, '1': {'precision': 0.9457962619548684, 'recall': 0.9068960832420941, 'f1-score': 0.9259377874967106, 'support': 250258}, '2': {'precision': 0.500082640074927, 'recall': 0.4970702590219594, 'f1-score': 0.49857189937383284, 'support': 18261}, 'accuracy': 0.8589061249593755, 'macro avg': {'precision': 0.5978256872890587, 'recall': 0.6521933390946323, 'f1-score': 0.6170901142506006, 'support': 286157}, 'weighted avg': {'precision': 0.8804817857257431, 'recall': 0.8589061249593755, 'f1-score': 0.8678975692583127, 'support': 286157}}
[[  9747   6371   1520]
 [ 15746 226958   7554]
 [  2548   6636   9077]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.41694948
{'0': {'precision': 0.4683233474118456, 'recall': 0.5086951883068388, 'f1-score': 0.48767515597831645, 'support': 9373}, '1': {'precision': 0.9370228486673886, 'recall': 0.9308564971751413, 'f1-score': 0.9339294945629008, 'support': 110625}, '2': {'precision': 0.49961702593281543, 'recall': 0.49528148389196225, 'f1-score': 0.4974398082579802, 'support': 9219}, 'accuracy': 0.8691580829147868, 'macro avg': {'precision': 0.6349877406706832, 'recall': 0.6449443897913141, 'f1-score': 0.6396814862663991, 'support': 129217}, 'weighted avg': {'precision': 0.8718180791319697, 'recall': 0.8691580829147868, 'f1-score': 0.8704181892888395, 'support': 129217}}
[[  4768   3423   1182]
 [  4258 102976   3391]
 [  1155   3498   4566]]
Evaluating performance on  val set...
187/187 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.41992444
{'0': {'precision': 0.42887523629489605, 'recall': 0.5468514612835191, 'f1-score': 0.48073102900278114, 'support': 3319}, '1': {'precision': 0.9376400206799773, 'recall': 0.9290401268447371, 'f1-score': 0.933320263680251, 'support': 40995}, '2': {'precision': 0.5611073598919649, 'recall': 0.47499285510145756, 'f1-score': 0.5144714440489089, 'support': 3499}, 'accuracy': 0.8692824127329387, 'macro avg': {'precision': 0.6425408722889461, 'recall': 0.6502948144099046, 'f1-score': 0.6428409122439803, 'support': 47813}, 'weighted avg': {'precision': 0.8747684564720979, 'recall': 0.8692824127329387, 'f1-score': 0.8712514604304111, 'support': 47813}}
[[ 1815  1231   273]
 [ 1882 38086  1027]
 [  535  1302  1662]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
508/508 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96015203
{'0': {'precision': 0.48276103714085494, 'recall': 0.5417726164573885, 'f1-score': 0.5105673382165841, 'support': 38147}, '1': {'precision': 0.6772082878953108, 'recall': 0.5574932192382626, 'f1-score': 0.6115470440949996, 'support': 52354}, '2': {'precision': 0.4905119453924915, 'recall': 0.547741247014584, 'f1-score': 0.5175493349978394, 'support': 39358}, 'accuracy': 0.5499195281035585, 'macro avg': {'precision': 0.5501604234762191, 'recall': 0.5490023609034117, 'f1-score': 0.5465545724364743, 'support': 129859}, 'weighted avg': {'precision': 0.5635036242004096, 'recall': 0.5499195281035585, 'f1-score': 0.5533944734238105, 'support': 129859}}
[[20667  7100 10380]
 [11155 29187 12012]
 [10988  6812 21558]]
Evaluating performance on  train set...
262/262 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0240029
{'0': {'precision': 0.48211856948555887, 'recall': 0.5408607458600727, 'f1-score': 0.5098030921511811, 'support': 22283}, '1': {'precision': 0.5863600136627576, 'recall': 0.4484304932735426, 'f1-score': 0.508202787714321, 'support': 22969}, '2': {'precision': 0.4859479004026625, 'recall': 0.5462817551963048, 'f1-score': 0.5143515699747759, 'support': 21650}, 'accuracy': 0.5108815879943799, 'macro avg': {'precision': 0.5181421611836597, 'recall': 0.5118576647766401, 'f1-score': 0.510785816613426, 'support': 66902}, 'weighted avg': {'precision': 0.5191462629126816, 'recall': 0.5108815879943799, 'f1-score': 0.5107255930072181, 'support': 66902}}
[[12052  3902  6329]
 [ 6487 10300  6182]
 [ 6459  3364 11827]]
Evaluating performance on  val set...
73/73 - 1s - 789ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0327284
{'0': {'precision': 0.5040526849037488, 'recall': 0.583834531318762, 'f1-score': 0.5410181472167471, 'support': 6817}, '1': {'precision': 0.4969579646017699, 'recall': 0.35256032960565037, 'f1-score': 0.41248708825892344, 'support': 5097}, '2': {'precision': 0.5243629235508261, 'recall': 0.5556379821958457, 'f1-score': 0.5395476156173461, 'support': 6740}, 'accuracy': 0.510453522032808, 'macro avg': {'precision': 0.5084578576854483, 'recall': 0.49734428104008604, 'f1-score': 0.4976842836976722, 'support': 18654}, 'weighted avg': {'precision': 0.5094525572690386, 'recall': 0.510453522032808, 'f1-score': 0.505367123817584, 'support': 18654}}
[[3980  965 1872]
 [1775 1797 1525]
 [2141  854 3745]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2043415
{'0': {'precision': 0.3769682896741891, 'recall': 0.1983733007484344, 'f1-score': 0.25995146238334704, 'support': 52376}, '1': {'precision': 0.3666490393090076, 'recall': 0.23205652658981032, 'f1-score': 0.2842241909403539, 'support': 53780}, '2': {'precision': 0.32528121363616774, 'recall': 0.6256216843501327, 'f1-score': 0.4280205291065302, 'support': 48256}, 'accuracy': 0.34362614304587724, 'macro avg': {'precision': 0.35629951420645484, 'recall': 0.3520171705627925, 'f1-score': 0.3240653941434104, 'support': 154412}, 'weighted avg': {'precision': 0.3572212439398536, 'recall': 0.34362614304587724, 'f1-score': 0.32092941892551835, 'support': 154412}}
[[10390 11854 30132]
 [ 8810 12480 32490]
 [ 8362  9704 30190]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1931945
{'0': {'precision': 0.37852478480261204, 'recall': 0.17344440666439986, 'f1-score': 0.23788648976355917, 'support': 29410}, '1': {'precision': 0.3472659739527011, 'recall': 0.2848877574635501, 'f1-score': 0.3129992583960165, 'support': 25926}, '2': {'precision': 0.34318229275422846, 'recall': 0.6020367046411956, 'f1-score': 0.4371650108393515, 'support': 27299}, 'accuracy': 0.3499969746475464, 'macro avg': {'precision': 0.35632435050318056, 'recall': 0.35345628958971514, 'f1-score': 0.3293502529996424, 'support': 82635}, 'weighted avg': {'precision': 0.35704199154886224, 'recall': 0.3499969746475464, 'f1-score': 0.327285388370846, 'support': 82635}}
[[ 5101  7544 16765]
 [ 3850  7386 14690]
 [ 4525  6339 16435]]
Evaluating performance on  val set...
112/112 - 1s - 951ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1897731
{'0': {'precision': 0.425569176882662, 'recall': 0.1783977241442599, 'f1-score': 0.25140640155189137, 'support': 10897}, '1': {'precision': 0.28949845367755817, 'recall': 0.28992728252087263, 'f1-score': 0.28971270941263544, 'support': 7426}, '2': {'precision': 0.3668066459740734, 'recall': 0.5959655888460398, 'f1-score': 0.45411392405063294, 'support': 10113}, 'accuracy': 0.35602757068504715, 'macro avg': {'precision': 0.3606247588447646, 'recall': 0.35476353183705744, 'f1-score': 0.33174434500505323, 'support': 28436}, 'weighted avg': {'precision': 0.36913625152045715, 'recall': 0.35602757068504715, 'f1-score': 0.33350106385332823, 'support': 28436}}
[[1944 2824 6129]
 [ 998 2153 4275]
 [1626 2460 6027]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
631/631 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0651855
{'0': {'precision': 0.4991307953621154, 'recall': 0.5117237319729226, 'f1-score': 0.5053488240660752, 'support': 61158}, '1': {'precision': 0.45629828686597246, 'recall': 0.1699529576618957, 'f1-score': 0.2476617622928403, 'support': 39964}, '2': {'precision': 0.4616827118320155, 'recall': 0.6422257667896188, 'f1-score': 0.5371904272173889, 'support': 60186}, 'accuracy': 0.4757420586703697, 'macro avg': {'precision': 0.4723705980200344, 'recall': 0.44130081880814576, 'f1-score': 0.4300670045254347, 'support': 161308}, 'weighted avg': {'precision': 0.47454671568297707, 'recall': 0.4757420586703697, 'f1-score': 0.45338743957528366, 'support': 161308}}
[[31296  4375 25487]
 [13590  6792 19582]
 [17815  3718 38653]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0302793
{'0': {'precision': 0.4773473814688565, 'recall': 0.5569455492081857, 'f1-score': 0.5140835669470031, 'support': 41487}, '1': {'precision': 0.6126649551862361, 'recall': 0.34838395738359884, 'f1-score': 0.44418684386683865, 'support': 39046}, '2': {'precision': 0.4770765543713345, 'recall': 0.5914536934151409, 'f1-score': 0.5281435704964357, 'support': 41398}, 'accuracy': 0.5018740107109759, 'macro avg': {'precision': 0.5223629636754757, 'recall': 0.49892773333564183, 'f1-score': 0.49547132710342584, 'support': 121931}, 'weighted avg': {'precision': 0.5205882167214633, 'recall': 0.5018740107109759, 'f1-score': 0.49647416964485114, 'support': 121931}}
[[23106  4446 13935]
 [12540 13603 12903]
 [12759  4154 24485]]
Evaluating performance on  val set...
184/184 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.008382
{'0': {'precision': 0.4737447297815255, 'recall': 0.5521378430121251, 'f1-score': 0.5099460701971532, 'support': 15670}, '1': {'precision': 0.637412040656763, 'recall': 0.41221084565794464, 'f1-score': 0.5006524909802718, 'support': 15822}, '2': {'precision': 0.4791621327529924, 'recall': 0.5725151140869791, 'f1-score': 0.5216953469774606, 'support': 15383}, 'accuracy': 0.5115946666666666, 'macro avg': {'precision': 0.5301063010637603, 'recall': 0.5122879342523495, 'f1-score': 0.5107646360516285, 'support': 46875}, 'weighted avg': {'precision': 0.5307661719698579, 'recall': 0.5115946666666666, 'f1-score': 0.5106649206364485, 'support': 46875}}
[[8652 1941 5077]
 [4804 6522 4496]
 [4807 1769 8807]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
2354/2354 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.44899067
{'0': {'precision': 0.46159959540495626, 'recall': 0.5617814512760766, 'f1-score': 0.5067869713945764, 'support': 45491}, '1': {'precision': 0.9381847838845333, 'recall': 0.9037544910996785, 'f1-score': 0.9206478448365741, 'support': 512959}, '2': {'precision': 0.43684290144467136, 'recall': 0.5258581444049896, 'f1-score': 0.47723516774086927, 'support': 43932}, 'accuracy': 0.8503690349313227, 'macro avg': {'precision': 0.6122090935780536, 'recall': 0.663798028926915, 'f1-score': 0.63488999465734, 'support': 602382}, 'weighted avg': {'precision': 0.8656306763772166, 'recall': 0.8503690349313227, 'f1-score': 0.8570553890129963, 'support': 602382}}
[[ 25556  15608   4327]
 [ 23915 463589  25455]
 [  5893  14937  23102]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43801308
{'0': {'precision': 0.44407990667833186, 'recall': 0.5456174138934922, 'f1-score': 0.4896400651138488, 'support': 22327}, '1': {'precision': 0.9404626628003755, 'recall': 0.9010614087789247, 'f1-score': 0.920340521120789, 'support': 274635}, '2': {'precision': 0.43590267838887753, 'recall': 0.5575070821529745, 'f1-score': 0.48926201449580237, 'support': 22945}, 'accuracy': 0.8516131250644718, 'macro avg': {'precision': 0.6068150826225284, 'recall': 0.6680619682751304, 'f1-score': 0.6330808669101468, 'support': 319907}, 'weighted avg': {'precision': 0.8696299938113922, 'recall': 0.8516131250644718, 'f1-score': 0.859362344914025, 'support': 319907}}
[[ 12182   7908   2237]
 [ 12855 247463  14317]
 [  2395   7758  12792]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45831567
{'0': {'precision': 0.4115327747658945, 'recall': 0.5417387543252595, 'f1-score': 0.46774344132200546, 'support': 9248}, '1': {'precision': 0.9394920875764738, 'recall': 0.8932042426091862, 'f1-score': 0.9157636261933881, 'support': 108141}, '2': {'precision': 0.43174002751031637, 'recall': 0.5440953412784398, 'f1-score': 0.4814495254529767, 'support': 9230}, 'accuracy': 0.842085311051264, 'macro avg': {'precision': 0.5942549632842282, 'recall': 0.6596794460709617, 'f1-score': 0.6216521976561235, 'support': 126619}, 'weighted avg': {'precision': 0.8639179696377532, 'recall': 0.842085311051264, 'f1-score': 0.8513814258954507, 'support': 126619}}
[[ 5010  3029  1209]
 [ 6148 96592  5401]
 [ 1016  3192  5022]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
3870/3870 - 33s - 33s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4974638
{'0': {'precision': 0.43027535230869146, 'recall': 0.49542416940662576, 'f1-score': 0.4605572413793103, 'support': 84247}, '1': {'precision': 0.9223926921576375, 'recall': 0.8992574557259491, 'f1-score': 0.9106781634152654, 'support': 825540}, '2': {'precision': 0.46183365030778406, 'recall': 0.5072116275908096, 'f1-score': 0.4834601701105012, 'support': 80911}, 'accuracy': 0.8328976136017232, 'macro avg': {'precision': 0.6048338982580377, 'recall': 0.6339644175744615, 'f1-score': 0.6182318583016922, 'support': 990698}, 'weighted avg': {'precision': 0.8429298264151331, 'recall': 0.8328976136017232, 'f1-score': 0.8375095768479717, 'support': 990698}}
[[ 41738  34264   8245]
 [ 43590 742373  39577]
 [ 11675  28197  41039]]
Evaluating performance on  train set...
1577/1577 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4537396
{'0': {'precision': 0.42422753575717875, 'recall': 0.5292154726232634, 'f1-score': 0.47094115508151024, 'support': 29368}, '1': {'precision': 0.9340060920178038, 'recall': 0.9153428287129171, 'f1-score': 0.9245802873855394, 'support': 345712}, '2': {'precision': 0.4939793373708586, 'recall': 0.48772423496306716, 'f1-score': 0.49083185840707966, 'support': 28430}, 'accuracy': 0.8571113479219846, 'macro avg': {'precision': 0.6174043217152804, 'recall': 0.6440941787664158, 'f1-score': 0.6287844336247098, 'support': 403510}, 'weighted avg': {'precision': 0.865900872135088, 'recall': 0.8571113479219846, 'f1-score': 0.8610033205858013, 'support': 403510}}
[[ 15542  11416   2410]
 [ 17473 316445  11794]
 [  3621  10943  13866]]
Evaluating performance on  val set...
600/600 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43762505
{'0': {'precision': 0.42111454197912074, 'recall': 0.5550387596899224, 'f1-score': 0.47888972493938636, 'support': 10320}, '1': {'precision': 0.9423497799758558, 'recall': 0.9131133684512399, 'f1-score': 0.9275012361010497, 'support': 132506}, '2': {'precision': 0.49733694228586395, 'recall': 0.536144578313253, 'f1-score': 0.5160121393305249, 'support': 10624}, 'accuracy': 0.8629325513196481, 'macro avg': {'precision': 0.6202670880802802, 'recall': 0.6680989021514718, 'f1-score': 0.640801033456987, 'support': 153450}, 'weighted avg': {'precision': 0.87648491165559, 'recall': 0.8629325513196481, 'f1-score': 0.8688415361383359, 'support': 153450}}
[[  5728   3684    908]
 [  6664 120993   4849]
 [  1210   3718   5696]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
2451/2451 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84501195
{'0': {'precision': 0.4461609230651282, 'recall': 0.5257871674020088, 'f1-score': 0.48271237989908067, 'support': 132818}, '1': {'precision': 0.7544926378303225, 'recall': 0.6532846715328468, 'f1-score': 0.700250631688195, 'support': 367160}, '2': {'precision': 0.44596167680334836, 'recall': 0.535414523841304, 'f1-score': 0.48661126829912266, 'support': 127363}, 'accuracy': 0.6023613951582951, 'macro avg': {'precision': 0.5488717458995996, 'recall': 0.5714954542587198, 'f1-score': 0.5565247599621327, 'support': 627341}, 'weighted avg': {'precision': 0.626575874091045, 'recall': 0.6023613951582951, 'f1-score': 0.6108212053228705, 'support': 627341}}
[[ 69834  42690  20294]
 [ 62876 239860  64424]
 [ 23812  35359  68192]]
Evaluating performance on  train set...
1200/1200 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8141274
{'0': {'precision': 0.46818529399927555, 'recall': 0.5393221962941785, 'f1-score': 0.50124236983842, 'support': 64709}, '1': {'precision': 0.7771324103521167, 'recall': 0.6872964900855584, 'f1-score': 0.7294589417172888, 'support': 178124}, '2': {'precision': 0.4628622463941987, 'recall': 0.5403601051992717, 'f1-score': 0.4986178622457405, 'support': 64259}, 'accuracy': 0.6253695960819559, 'macro avg': {'precision': 0.569393316915197, 'recall': 0.5889929305263362, 'f1-score': 0.576439724600483, 'support': 307092}, 'weighted avg': {'precision': 0.6462714780652195, 'recall': 0.6253695960819559, 'f1-score': 0.6330667104788588, 'support': 307092}}
[[ 34899  17918  11892]
 [ 27297 122424  28403]
 [ 12345  17191  34723]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8064011
{'0': {'precision': 0.46201472556894246, 'recall': 0.5571249848662173, 'f1-score': 0.5051318172670557, 'support': 24779}, '1': {'precision': 0.7802228460827565, 'recall': 0.6957596678639735, 'f1-score': 0.7355745520302482, 'support': 64311}, '2': {'precision': 0.48955106841795726, 'recall': 0.5280832346472678, 'f1-score': 0.5080876518342184, 'support': 23644}, 'accuracy': 0.6301204605531605, 'macro avg': {'precision': 0.5772628800232188, 'recall': 0.5936559624591529, 'f1-score': 0.5829313403771742, 'support': 112734}, 'weighted avg': {'precision': 0.6493171518882961, 'recall': 0.6301204605531605, 'f1-score': 0.6372116731034642, 'support': 112734}}
[[13805  6858  4116]
 [10663 44745  8903]
 [ 5412  5746 12486]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
3337/3337 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7486063
{'0': {'precision': 0.42226836368631554, 'recall': 0.5550085066490746, 'f1-score': 0.47962361752050836, 'support': 144005}, '1': {'precision': 0.8303186179472161, 'recall': 0.7084295327523827, 'f1-score': 0.7645464662693665, 'support': 568264}, '2': {'precision': 0.4381559053717538, 'recall': 0.556083864777922, 'f1-score': 0.4901260974457184, 'support': 141752}, 'accuracy': 0.6572730647138654, 'macro avg': {'precision': 0.5635809623350951, 'recall': 0.6065073013931265, 'f1-score': 0.578098727078531, 'support': 854021}, 'weighted avg': {'precision': 0.6964212949331006, 'recall': 0.6572730647138654, 'f1-score': 0.6709539773779117, 'support': 854021}}
[[ 79924  44099  19982]
 [ 84593 402575  81096]
 [ 24756  38170  78826]]
Evaluating performance on  train set...
1431/1431 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77604455
{'0': {'precision': 0.4654139812856908, 'recall': 0.5272920282890301, 'f1-score': 0.4944244918822216, 'support': 69709}, '1': {'precision': 0.8051141552511416, 'recall': 0.7233665087728636, 'f1-score': 0.7620542795934053, 'support': 225468}, '2': {'precision': 0.45925680630129856, 'recall': 0.5474770545193081, 'f1-score': 0.49950155322446826, 'support': 70929}, 'accuracy': 0.6519559908878849, 'macro avg': {'precision': 0.5765949809460437, 'recall': 0.5993785305270672, 'f1-score': 0.5853267749000317, 'support': 366106}, 'weighted avg': {'precision': 0.6734269517346162, 'recall': 0.6519559908878849, 'f1-score': 0.6602291054630135, 'support': 366106}}
[[ 36757  20678  12274]
 [ 28924 163096  33448]
 [ 13296  18801  38832]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8260654
{'0': {'precision': 0.4838841289269686, 'recall': 0.5175837364076081, 'f1-score': 0.5001669331740147, 'support': 27497}, '1': {'precision': 0.764041347969405, 'recall': 0.6813939549618975, 'f1-score': 0.7203548367630197, 'support': 70074}, '2': {'precision': 0.4740384331552381, 'recall': 0.5692258613356018, 'f1-score': 0.5172896970477863, 'support': 28212}, 'accuracy': 0.6204256537051906, 'macro avg': {'precision': 0.5739879700172039, 'recall': 0.5894011842350358, 'f1-score': 0.5792704889949402, 'support': 125783}, 'weighted avg': {'precision': 0.6377520617801175, 'recall': 0.6204256537051906, 'f1-score': 0.6266746056774752, 'support': 125783}}
[[14232  7791  5474]
 [ 9982 47748 12344]
 [ 5198  6955 16059]]
testing model on single stock: results/universal/W9/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
10303/10303 - 74s - 74s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.087537
{'0': {'precision': 0.42614124877609527, 'recall': 0.5732683707585711, 'f1-score': 0.48887522117835946, 'support': 822217}, '1': {'precision': 0.559787270150397, 'recall': 0.24729246997655668, 'f1-score': 0.3430421303232081, 'support': 987062}, '2': {'precision': 0.4383753002692494, 'recall': 0.5797892830188679, 'f1-score': 0.4992617209596379, 'support': 828125}, 'accuracy': 0.4533177321335677, 'macro avg': {'precision': 0.47476793973191384, 'recall': 0.4667833745846652, 'f1-score': 0.4437263574870685, 'support': 2637404}, 'weighted avg': {'precision': 0.48000035911434047, 'recall': 0.4533177321335677, 'f1-score': 0.4375577202591615, 'support': 2637404}}
[[471351 103332 247534]
 [375374 244093 367595]
 [259366  88621 480138]]
Evaluating performance on  train set...
3419/3419 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0807335
{'0': {'precision': 0.4429392231698748, 'recall': 0.552967362623375, 'f1-score': 0.49187531748994745, 'support': 290679}, '1': {'precision': 0.5681242163113945, 'recall': 0.22142465981325254, 'f1-score': 0.3186546523778765, 'support': 288518}, '2': {'precision': 0.44799159621829826, 'recall': 0.6052095405751511, 'f1-score': 0.5148661137117209, 'support': 295957}, 'accuracy': 0.46133251976223616, 'macro avg': {'precision': 0.4863516785665225, 'recall': 0.45986718767059287, 'f1-score': 0.4417986945265149, 'support': 875154}, 'weighted avg': {'precision': 0.48591841200006614, 'recall': 0.46133251976223616, 'f1-score': 0.44254343672450835, 'support': 875154}}
[[160736  25875 104068]
 [107997  63885 116636]
 [ 94152  22689 179116]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.091291
{'0': {'precision': 0.42511349392425946, 'recall': 0.5631398730147805, 'f1-score': 0.4844878185983339, 'support': 116234}, '1': {'precision': 0.5693020786539796, 'recall': 0.22004656485537272, 'f1-score': 0.3174084551938478, 'support': 126705}, '2': {'precision': 0.4356495311659614, 'recall': 0.5880413200731236, 'f1-score': 0.5005025200449662, 'support': 114327}, 'accuracy': 0.449429836592343, 'macro avg': {'precision': 0.4766883679147335, 'recall': 0.4570759193144256, 'f1-score': 0.43413293127904934, 'support': 357266}, 'weighted avg': {'precision': 0.4796218102989249, 'recall': 0.449429836592343, 'f1-score': 0.4303576243792471, 'support': 357266}}
[[65456 11566 39212]
 [50946 27881 47878]
 [37571  9527 67229]]
training model: results/universal/W9/deepVOL_L2/h20
Epoch 1/50
6697/6697 - 226s - loss: 2.7984 - accuracy20: 0.5252 - val_loss: 2.9634 - val_accuracy20: 0.5010 - 226s/epoch - 34ms/step
Epoch 2/50
6697/6697 - 226s - loss: 2.7428 - accuracy20: 0.5439 - val_loss: 2.9497 - val_accuracy20: 0.5190 - 226s/epoch - 34ms/step
Epoch 3/50
6697/6697 - 223s - loss: 2.7114 - accuracy20: 0.5530 - val_loss: 2.9837 - val_accuracy20: 0.5178 - 223s/epoch - 33ms/step
Epoch 4/50
6697/6697 - 224s - loss: 2.6919 - accuracy20: 0.5573 - val_loss: 3.0071 - val_accuracy20: 0.5285 - 224s/epoch - 33ms/step
Epoch 5/50
6697/6697 - 223s - loss: 2.6785 - accuracy20: 0.5607 - val_loss: 2.9723 - val_accuracy20: 0.5258 - 223s/epoch - 33ms/step
Epoch 6/50
6697/6697 - 221s - loss: 2.6649 - accuracy20: 0.5633 - val_loss: 2.9464 - val_accuracy20: 0.5316 - 221s/epoch - 33ms/step
Epoch 7/50
6697/6697 - 221s - loss: 2.6563 - accuracy20: 0.5649 - val_loss: 2.9438 - val_accuracy20: 0.5326 - 221s/epoch - 33ms/step
Epoch 8/50
6697/6697 - 221s - loss: 2.6493 - accuracy20: 0.5662 - val_loss: 2.9238 - val_accuracy20: 0.5387 - 221s/epoch - 33ms/step
Epoch 9/50
6697/6697 - 222s - loss: 2.6434 - accuracy20: 0.5673 - val_loss: 2.9134 - val_accuracy20: 0.5430 - 222s/epoch - 33ms/step
Epoch 10/50
6697/6697 - 226s - loss: 2.6384 - accuracy20: 0.5682 - val_loss: 2.9039 - val_accuracy20: 0.5427 - 226s/epoch - 34ms/step
Epoch 11/50
6697/6697 - 222s - loss: 2.6335 - accuracy20: 0.5692 - val_loss: 2.9097 - val_accuracy20: 0.5440 - 222s/epoch - 33ms/step
Epoch 12/50
6697/6697 - 225s - loss: 2.6285 - accuracy20: 0.5697 - val_loss: 2.9110 - val_accuracy20: 0.5436 - 225s/epoch - 34ms/step
Epoch 13/50
6697/6697 - 241s - loss: 2.6245 - accuracy20: 0.5708 - val_loss: 2.8985 - val_accuracy20: 0.5446 - 241s/epoch - 36ms/step
Epoch 14/50
6697/6697 - 242s - loss: 2.6212 - accuracy20: 0.5713 - val_loss: 2.8928 - val_accuracy20: 0.5436 - 242s/epoch - 36ms/step
Epoch 15/50
6697/6697 - 242s - loss: 2.6180 - accuracy20: 0.5719 - val_loss: 2.9014 - val_accuracy20: 0.5441 - 242s/epoch - 36ms/step
Epoch 16/50
6697/6697 - 237s - loss: 2.6148 - accuracy20: 0.5727 - val_loss: 2.8917 - val_accuracy20: 0.5427 - 237s/epoch - 35ms/step
Epoch 17/50
6697/6697 - 236s - loss: 2.6118 - accuracy20: 0.5732 - val_loss: 2.8904 - val_accuracy20: 0.5444 - 236s/epoch - 35ms/step
Epoch 18/50
6697/6697 - 243s - loss: 2.6091 - accuracy20: 0.5736 - val_loss: 2.9045 - val_accuracy20: 0.5450 - 243s/epoch - 36ms/step
Epoch 19/50
6697/6697 - 243s - loss: 2.6068 - accuracy20: 0.5742 - val_loss: 2.8989 - val_accuracy20: 0.5433 - 243s/epoch - 36ms/step
Epoch 20/50
6697/6697 - 246s - loss: 2.6044 - accuracy20: 0.5746 - val_loss: 2.8916 - val_accuracy20: 0.5428 - 246s/epoch - 37ms/step
Epoch 21/50
6697/6697 - 227s - loss: 2.6017 - accuracy20: 0.5751 - val_loss: 2.8895 - val_accuracy20: 0.5426 - 227s/epoch - 34ms/step
Epoch 22/50
6697/6697 - 223s - loss: 2.5990 - accuracy20: 0.5758 - val_loss: 2.9024 - val_accuracy20: 0.5416 - 223s/epoch - 33ms/step
Epoch 23/50
6697/6697 - 222s - loss: 2.5970 - accuracy20: 0.5762 - val_loss: 2.9051 - val_accuracy20: 0.5394 - 222s/epoch - 33ms/step
Epoch 24/50
6697/6697 - 221s - loss: 2.5954 - accuracy20: 0.5766 - val_loss: 2.8884 - val_accuracy20: 0.5431 - 221s/epoch - 33ms/step
Epoch 25/50
6697/6697 - 224s - loss: 2.5930 - accuracy20: 0.5770 - val_loss: 2.8934 - val_accuracy20: 0.5403 - 224s/epoch - 33ms/step
Epoch 26/50
6697/6697 - 222s - loss: 2.5914 - accuracy20: 0.5774 - val_loss: 2.8834 - val_accuracy20: 0.5419 - 222s/epoch - 33ms/step
Epoch 27/50
6697/6697 - 220s - loss: 2.5895 - accuracy20: 0.5775 - val_loss: 2.8957 - val_accuracy20: 0.5410 - 220s/epoch - 33ms/step
Epoch 28/50
6697/6697 - 219s - loss: 2.5879 - accuracy20: 0.5779 - val_loss: 2.8931 - val_accuracy20: 0.5399 - 219s/epoch - 33ms/step
Epoch 29/50
6697/6697 - 220s - loss: 2.5859 - accuracy20: 0.5785 - val_loss: 2.8991 - val_accuracy20: 0.5391 - 220s/epoch - 33ms/step
Epoch 30/50
6697/6697 - 235s - loss: 2.5846 - accuracy20: 0.5788 - val_loss: 2.8892 - val_accuracy20: 0.5400 - 235s/epoch - 35ms/step
Epoch 31/50
6697/6697 - 236s - loss: 2.5828 - accuracy20: 0.5790 - val_loss: 2.8923 - val_accuracy20: 0.5405 - 236s/epoch - 35ms/step
Epoch 32/50
6697/6697 - 235s - loss: 2.5816 - accuracy20: 0.5795 - val_loss: 2.9011 - val_accuracy20: 0.5406 - 235s/epoch - 35ms/step
Epoch 33/50
6697/6697 - 234s - loss: 2.5799 - accuracy20: 0.5798 - val_loss: 2.8965 - val_accuracy20: 0.5394 - 234s/epoch - 35ms/step
Epoch 34/50
6697/6697 - 239s - loss: 2.5787 - accuracy20: 0.5797 - val_loss: 2.9073 - val_accuracy20: 0.5406 - 239s/epoch - 36ms/step
Epoch 35/50
6697/6697 - 218s - loss: 2.5771 - accuracy20: 0.5802 - val_loss: 2.9076 - val_accuracy20: 0.5390 - 218s/epoch - 33ms/step
Epoch 36/50
6697/6697 - 222s - loss: 2.5762 - accuracy20: 0.5807 - val_loss: 2.9026 - val_accuracy20: 0.5389 - 222s/epoch - 33ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 270s - 270s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0496325
{'0': {'precision': 0.4084759144076561, 'recall': 0.6142203671530091, 'f1-score': 0.49065246573060683, 'support': 1141377}, '1': {'precision': 0.7424010275987458, 'recall': 0.46889617814247075, 'f1-score': 0.5747705894806884, 'support': 2026423}, '2': {'precision': 0.43303846458830203, 'recall': 0.4982463312442539, 'f1-score': 0.46335949482752997, 'support': 1139896}, 'accuracy': 0.5151682012843989, 'macro avg': {'precision': 0.5279718021982347, 'recall': 0.5271209588465778, 'f1-score': 0.509594183346275, 'support': 4307696}, 'weighted avg': {'precision': 0.572060411166189, 'recall': 0.5151682012843989, 'f1-score': 0.523001023364079, 'support': 4307696}}
[[701057 160587 279733]
 [612379 950182 463862]
 [402839 169108 567949]]
Evaluating performance on  train set...
6697/6697 - 114s - 114s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9911444
{'0': {'precision': 0.42592043897544024, 'recall': 0.586022050294492, 'f1-score': 0.4933062334220021, 'support': 443985}, '1': {'precision': 0.7761954556121533, 'recall': 0.5482031520398563, 'f1-score': 0.6425751173507723, 'support': 820548}, '2': {'precision': 0.4471562261268144, 'recall': 0.5209023031468034, 'f1-score': 0.4812203002449973, 'support': 449472}, 'accuracy': 0.550840283429745, 'macro avg': {'precision': 0.5497573735714694, 'recall': 0.5517091684937172, 'f1-score': 0.5390338836725905, 'support': 1714005}, 'weighted avg': {'precision': 0.599176850755875, 'recall': 0.550840283429745, 'f1-score': 0.5615965800738788, 'support': 1714005}}
[[260185  62986 120814]
 [202066 449827 168655]
 [148626  66715 234131]]
Evaluating performance on  val set...
2631/2631 - 42s - 42s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.000806
{'0': {'precision': 0.4164993267027334, 'recall': 0.5967101403492937, 'f1-score': 0.49057846333647154, 'support': 177272}, '1': {'precision': 0.7770008581430511, 'recall': 0.5308416027396835, 'f1-score': 0.6307554513689239, 'support': 322373}, '2': {'precision': 0.4421019778405344, 'recall': 0.5069996478527679, 'f1-score': 0.47233202643906275, 'support': 173223}, 'accuracy': 0.542057283152119, 'macro avg': {'precision': 0.5452007208954396, 'recall': 0.5448504636472483, 'f1-score': 0.531221980381486, 'support': 672868}, 'weighted avg': {'precision': 0.5958077917108076, 'recall': 0.542057283152119, 'f1-score': 0.5530403037335567, 'support': 672868}}
[[105780  24328  47164]
 [ 87581 171129  63663]
 [ 60613  24786  87824]]
testing model out of sample: results/universal/W9/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 139s - 139s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7967104
{'0': {'precision': 0.45105965427117245, 'recall': 0.5783217243666019, 'f1-score': 0.5068240060754006, 'support': 425246}, '1': {'precision': 0.8276853728188974, 'recall': 0.7244803652901209, 'f1-score': 0.7726517684582574, 'support': 1366585}, '2': {'precision': 0.4733777303868673, 'recall': 0.5302852210982073, 'f1-score': 0.5002181540122346, 'support': 419429}, 'accuracy': 0.6595380009587294, 'macro avg': {'precision': 0.5840409191589792, 'recall': 0.6110291035849768, 'f1-score': 0.5932313095152976, 'support': 2211260}, 'weighted avg': {'precision': 0.6880520956524088, 'recall': 0.6595380009587294, 'f1-score': 0.6698557376361284, 'support': 2211260}}
[[245929 104489  74828]
 [203915 990064 172606]
 [ 95381 101631 222417]]
Evaluating performance on  train set...
3947/3947 - 66s - 66s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8227755
{'0': {'precision': 0.4510672163361986, 'recall': 0.5743133893283006, 'f1-score': 0.5052834828313215, 'support': 208233}, '1': {'precision': 0.8141632012673461, 'recall': 0.7209952483568217, 'f1-score': 0.7647520679633356, 'support': 593058}, '2': {'precision': 0.4823563215769622, 'recall': 0.507760926029949, 'f1-score': 0.4947327058735475, 'support': 208287}, 'accuracy': 0.6467484434090284, 'macro avg': {'precision': 0.582528913060169, 'recall': 0.6010231879050237, 'f1-score': 0.5882560855560682, 'support': 1009578}, 'weighted avg': {'precision': 0.6708165497156693, 'recall': 0.6467484434090284, 'f1-score': 0.6555267829834822, 'support': 1009578}}
[[119591  47647  40995]
 [ 92964 427592  72502]
 [ 52574  49953 105760]]
Evaluating performance on  val set...
1402/1402 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81143296
{'0': {'precision': 0.46345730206038616, 'recall': 0.573616680032077, 'f1-score': 0.5126863532110091, 'support': 74820}, '1': {'precision': 0.8159360489544392, 'recall': 0.7287352782695713, 'f1-score': 0.7698743068579763, 'support': 207856}, '2': {'precision': 0.495974798739937, 'recall': 0.5250509488394252, 'f1-score': 0.510098867332639, 'support': 75566}, 'accuracy': 0.6533739762506908, 'macro avg': {'precision': 0.5917893832515875, 'recall': 0.6091343023803578, 'f1-score': 0.5975531758005415, 'support': 358242}, 'weighted avg': {'precision': 0.6748284968630537, 'recall': 0.6533739762506908, 'f1-score': 0.6613638766040203, 'support': 358242}}
[[ 42918  16889  15013]
 [ 31077 151472  25307]
 [ 18609  17281  39676]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
295/295 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1415302
{'0': {'precision': 0.4018005212035063, 'recall': 0.6321020374358125, 'f1-score': 0.49130147898997384, 'support': 24148}, '1': {'precision': 0.5545342556618971, 'recall': 0.2375289199171977, 'f1-score': 0.3325944870701904, 'support': 24637}, '2': {'precision': 0.4835644007155635, 'recall': 0.4879837526796796, 'f1-score': 0.48576402538327623, 'support': 26589}, 'accuracy': 0.4522912410114894, 'macro avg': {'precision': 0.47996639252698897, 'recall': 0.45253823667756327, 'f1-score': 0.43655333048114686, 'support': 75374}, 'weighted avg': {'precision': 0.4805666847107829, 'recall': 0.4522912410114894, 'f1-score': 0.4374725789199737, 'support': 75374}}
[[15264  2169  6715]
 [11643  5852  7142]
 [11082  2532 12975]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0954704
{'0': {'precision': 0.45932403687071616, 'recall': 0.5787373436569386, 'f1-score': 0.5121623402292792, 'support': 16790}, '1': {'precision': 0.6267364606402255, 'recall': 0.34895191122071517, 'f1-score': 0.44830069124423966, 'support': 17842}, '2': {'precision': 0.4503493013972056, 'recall': 0.5470691640904407, 'f1-score': 0.4940197607904316, 'support': 16497}, 'accuracy': 0.4883334311251931, 'macro avg': {'precision': 0.5121365996360491, 'recall': 0.4915861396560315, 'f1-score': 0.4848275974213168, 'support': 51129}, 'weighted avg': {'precision': 0.5148486169287866, 'recall': 0.4883334311251931, 'f1-score': 0.4840233648103634, 'support': 51129}}
[[9717 1920 5153]
 [5754 6226 5862]
 [5684 1788 9025]]
Evaluating performance on  val set...
53/53 - 1s - 596ms/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.075057
{'0': {'precision': 0.4340425531914894, 'recall': 0.5817490494296578, 'f1-score': 0.49715678310316813, 'support': 4208}, '1': {'precision': 0.6478626489138052, 'recall': 0.37091273821464393, 'f1-score': 0.4717438448781732, 'support': 4985}, '2': {'precision': 0.4651022864019254, 'recall': 0.5409377186843947, 'f1-score': 0.5001617599482369, 'support': 4287}, 'accuracy': 0.4908011869436202, 'macro avg': {'precision': 0.51566916283574, 'recall': 0.49786650210956546, 'f1-score': 0.4896874626431928, 'support': 13480}, 'weighted avg': {'precision': 0.5229925719933354, 'recall': 0.4908011869436202, 'f1-score': 0.4887145604535546, 'support': 13480}}
[[2448  547 1213]
 [1682 1849 1454]
 [1510  458 2319]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
1118/1118 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5920999
{'0': {'precision': 0.313857998289136, 'recall': 0.60492147891678, 'f1-score': 0.41328621112065445, 'support': 24261}, '1': {'precision': 0.9174352238580311, 'recall': 0.8202466945465298, 'f1-score': 0.8661230825501469, 'support': 236730}, '2': {'precision': 0.4748603351955307, 'recall': 0.5235238019550187, 'f1-score': 0.49800608569106614, 'support': 25166}, 'accuracy': 0.7758957495360939, 'macro avg': {'precision': 0.5687178524475659, 'recall': 0.6495639918061095, 'f1-score': 0.5924717931206225, 'support': 286157}, 'weighted avg': {'precision': 0.8273405320713286, 'recall': 0.7758957495360939, 'f1-score': 0.7953566582421393, 'support': 286157}}
[[ 14676   8048   1537]
 [ 29520 194177  13033]
 [  2564   9427  13175]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5485736
{'0': {'precision': 0.45787161497606715, 'recall': 0.5432550178932628, 'f1-score': 0.4969222558263654, 'support': 12854}, '1': {'precision': 0.9059837596508225, 'recall': 0.8744541168985164, 'f1-score': 0.8899397602181974, 'support': 103731}, '2': {'precision': 0.48884073672806067, 'recall': 0.5357821405953135, 'f1-score': 0.5112361672394908, 'support': 12632}, 'accuracy': 0.8083998235526285, 'macro avg': {'precision': 0.61756537045165, 'recall': 0.6511637584623643, 'f1-score': 0.6326993944280179, 'support': 129217}, 'weighted avg': {'precision': 0.8206282400736025, 'recall': 0.8083998235526285, 'f1-score': 0.8138226023522849, 'support': 129217}}
[[ 6983  4614  1257]
 [ 7203 90708  5820]
 [ 1065  4799  6768]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5506545
{'0': {'precision': 0.41118110236220473, 'recall': 0.5651515151515152, 'f1-score': 0.4760255241567912, 'support': 4620}, '1': {'precision': 0.9052588996763754, 'recall': 0.874140625, 'f1-score': 0.8894276629570748, 'support': 38400}, '2': {'precision': 0.5712981975815652, 'recall': 0.5224285416232005, 'f1-score': 0.5457715780296426, 'support': 4793}, 'accuracy': 0.8090268337063142, 'macro avg': {'precision': 0.6292460665400484, 'recall': 0.6539068939249053, 'f1-score': 0.6370749217145029, 'support': 47813}, 'weighted avg': {'precision': 0.8240401292848105, 'recall': 0.8090268337063142, 'f1-score': 0.8150323835076678, 'support': 47813}}
[[ 2611  1743   266]
 [ 3220 33567  1613]
 [  519  1770  2504]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
508/508 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.07061
{'0': {'precision': 0.45736465865099035, 'recall': 0.5650050607287449, 'f1-score': 0.5055183889700139, 'support': 39520}, '1': {'precision': 0.6191407254952406, 'recall': 0.481185268124925, 'f1-score': 0.5415147833130822, 'support': 50014}, '2': {'precision': 0.4716135458167331, 'recall': 0.49316800991940485, 'f1-score': 0.4821500006061121, 'support': 40325}, 'accuracy': 0.5104151425777189, 'macro avg': {'precision': 0.5160396433209881, 'recall': 0.5131194462576916, 'f1-score': 0.5097277242964028, 'support': 129859}, 'weighted avg': {'precision': 0.5240959178021228, 'recall': 0.5104151425777189, 'f1-score': 0.5121255044252374, 'support': 129859}}
[[22329  7206  9985]
 [13652 24066 12296]
 [12840  7598 19887]]
Evaluating performance on  train set...
262/262 - 12s - 12s/epoch - 46ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1218287
{'0': {'precision': 0.4630255651806465, 'recall': 0.5759022424667134, 'f1-score': 0.5133320320124928, 'support': 22832}, '1': {'precision': 0.5180492773922455, 'recall': 0.37494240162197034, 'f1-score': 0.4350290037156834, 'support': 21702}, '2': {'precision': 0.47844014563319737, 'recall': 0.4876162374821173, 'f1-score': 0.4829846119783018, 'support': 22368}, 'accuracy': 0.48119637678993155, 'macro avg': {'precision': 0.48650499606869646, 'recall': 0.47948696052360035, 'f1-score': 0.4771152159021594, 'support': 66902}, 'weighted avg': {'precision': 0.4860281351782367, 'recall': 0.48119637678993155, 'f1-score': 0.4777853605912775, 'support': 66902}}
[[13149  3718  5965]
 [ 7640  8137  5925]
 [ 7609  3852 10907]]
Evaluating performance on  val set...
73/73 - 1s - 697ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1446633
{'0': {'precision': 0.46911307948924424, 'recall': 0.6054038004750594, 'f1-score': 0.5286149458811329, 'support': 6736}, '1': {'precision': 0.4362252663622527, 'recall': 0.28203109624089745, 'f1-score': 0.34257709777671524, 'support': 5081}, '2': {'precision': 0.5026962252846016, 'recall': 0.49085856369752817, 'f1-score': 0.49670687486124476, 'support': 6837}, 'accuracy': 0.47534040956363244, 'macro avg': {'precision': 0.4693448570453662, 'recall': 0.4594311534711617, 'f1-score': 0.455966306173031, 'support': 18654}, 'weighted avg': {'precision': 0.4724638347859428, 'recall': 0.47534040956363244, 'f1-score': 0.46624688606653436, 'support': 18654}}
[[4078  915 1743]
 [2071 1433 1577]
 [2544  937 3356]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
604/604 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2863582
{'0': {'precision': 0.3417665877066595, 'recall': 0.2863368524429168, 'f1-score': 0.3116059003618147, 'support': 48876}, '1': {'precision': 0.40129004646612865, 'recall': 0.2203108216970999, 'f1-score': 0.2844543642194678, 'support': 59584}, '2': {'precision': 0.3160580054736164, 'recall': 0.5554056406685237, 'f1-score': 0.40286338918573356, 'support': 45952}, 'accuracy': 0.34093205191306375, 'macro avg': {'precision': 0.3530382132154682, 'recall': 0.35401777160284675, 'f1-score': 0.33297455125567205, 'support': 154412}, 'weighted avg': {'precision': 0.35708460052918245, 'recall': 0.34093205191306375, 'f1-score': 0.32828638501929674, 'support': 154412}}
[[13995 10381 24500]
 [15728 13127 30729]
 [11226  9204 25522]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2373916
{'0': {'precision': 0.3562785441875794, 'recall': 0.26445096805759416, 'f1-score': 0.3035725031592883, 'support': 28614}, '1': {'precision': 0.3607545702061455, 'recall': 0.2662265437192781, 'f1-score': 0.3063647061252297, 'support': 27871}, '2': {'precision': 0.33205153326148723, 'recall': 0.5184321223709369, 'f1-score': 0.40481949296784014, 'support': 26150}, 'accuracy': 0.34542264173776244, 'macro avg': {'precision': 0.3496948825517374, 'recall': 0.3497032113826031, 'f1-score': 0.3382522340841194, 'support': 82635}, 'weighted avg': {'precision': 0.35012152821911746, 'recall': 0.34542264173776244, 'f1-score': 0.33655405180522996, 'support': 82635}}
[[ 7567  7100 13947]
 [ 7127  7420 13324]
 [ 6545  6048 13557]]
Evaluating performance on  val set...
112/112 - 1s - 971ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.212817
{'0': {'precision': 0.3915687629578438, 'recall': 0.26771876771876774, 'f1-score': 0.318010888477297, 'support': 10582}, '1': {'precision': 0.30534244664527826, 'recall': 0.2712515489467162, 'f1-score': 0.28728919220421284, 'support': 8070}, '2': {'precision': 0.35511687571265677, 'recall': 0.509300899427637, 'f1-score': 0.41845817937520996, 'support': 9784}, 'accuracy': 0.351842734561823, 'macro avg': {'precision': 0.35067602843859297, 'recall': 0.349423738697707, 'f1-score': 0.34125275335224, 'support': 28436}, 'weighted avg': {'precision': 0.35455611569911144, 'recall': 0.351842734561823, 'f1-score': 0.34385320825579585, 'support': 28436}}
[[2833 2606 5143]
 [1975 2189 3906]
 [2427 2374 4983]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1965076
{'0': {'precision': 0.46959056013647993, 'recall': 0.5526813352296495, 'f1-score': 0.5077591176357558, 'support': 59765}, '1': {'precision': 0.41116138763197585, 'recall': 0.12530740766278242, 'f1-score': 0.19207666155824485, 'support': 43509}, '2': {'precision': 0.4487568847480311, 'recall': 0.6008891339559569, 'f1-score': 0.5137982348867706, 'support': 58034}, 'accuracy': 0.4547511592729437, 'macro avg': {'precision': 0.443169610838829, 'recall': 0.4262926256161295, 'f1-score': 0.404544671360257, 'support': 161308}, 'weighted avg': {'precision': 0.4463353193301237, 'recall': 0.4547511592729437, 'f1-score': 0.4247839778353055, 'support': 161308}}
[[33031  4122 22612]
 [17833  5452 20224]
 [19476  3686 34872]]
Evaluating performance on  train set...
477/477 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1727782
{'0': {'precision': 0.4382274677334685, 'recall': 0.5974285573268842, 'f1-score': 0.5055918132929567, 'support': 40522}, '1': {'precision': 0.5639254330268705, 'recall': 0.2723815599008808, 'f1-score': 0.3673361347318267, 'support': 40759}, '2': {'precision': 0.459798727686645, 'recall': 0.5316359163591636, 'f1-score': 0.4931147391358912, 'support': 40650}, 'accuracy': 0.4668378017075231, 'macro avg': {'precision': 0.48731720948232793, 'recall': 0.46714867786230957, 'f1-score': 0.4553475623868915, 'support': 121931}, 'weighted avg': {'precision': 0.48743722640427734, 'recall': 0.4668378017075231, 'f1-score': 0.45521613961720714, 'support': 121931}}
[[24209  4200 12113]
 [16380 11102 13277]
 [14654  4385 21611]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1529542
{'0': {'precision': 0.4348454203987287, 'recall': 0.59251968503937, 'f1-score': 0.5015830694884186, 'support': 15240}, '1': {'precision': 0.594816414686825, 'recall': 0.3303346527527888, 'f1-score': 0.42477057145060537, 'support': 16674}, '2': {'precision': 0.45688171404831146, 'recall': 0.5145377982755164, 'f1-score': 0.4839987425337944, 'support': 14961}, 'accuracy': 0.474368, 'macro avg': {'precision': 0.49551451637795507, 'recall': 0.47913071202255836, 'f1-score': 0.47011746115760616, 'support': 46875}, 'weighted avg': {'precision': 0.49878230249048605, 'recall': 0.474368, 'f1-score': 0.4686475877209385, 'support': 46875}}
[[9030 1757 4453]
 [6468 5508 4698]
 [5268 1995 7698]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5677366
{'0': {'precision': 0.4910282352625866, 'recall': 0.5810840813219575, 'f1-score': 0.5322738794750184, 'support': 63058}, '1': {'precision': 0.9073838326662386, 'recall': 0.8491486884861479, 'f1-score': 0.8773009120908002, 'support': 477616}, '2': {'precision': 0.43750928263775435, 'recall': 0.5728430673494522, 'f1-score': 0.49611238982765404, 'support': 61708}, 'accuracy': 0.7927826528681136, 'macro avg': {'precision': 0.6119737835221932, 'recall': 0.6676919457191858, 'f1-score': 0.6352290604644909, 'support': 602382}, 'weighted avg': {'precision': 0.8156653384312893, 'recall': 0.7927826528681136, 'f1-score': 0.8021341641559346, 'support': 602382}}
[[ 36642  21537   4879]
 [ 31481 405567  40568]
 [  6500  19859  35349]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55298966
{'0': {'precision': 0.4579267703603517, 'recall': 0.5993930197268589, 'f1-score': 0.5191960129251328, 'support': 31632}, '1': {'precision': 0.9108550176468356, 'recall': 0.8449124234340653, 'f1-score': 0.8766453943163256, 'support': 255662}, '2': {'precision': 0.4676178960096735, 'recall': 0.5928924048692239, 'f1-score': 0.5228560226058976, 'support': 32613}, 'accuracy': 0.7949435304635409, 'macro avg': {'precision': 0.6121332280056203, 'recall': 0.6790659493433827, 'f1-score': 0.6395658099491187, 'support': 319907}, 'weighted avg': {'precision': 0.820884124336846, 'recall': 0.7949435304635409, 'f1-score': 0.8052341041233684, 'support': 319907}}
[[ 18960  10312   2360]
 [ 19996 216012  19654]
 [  2448  10829  19336]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57681
{'0': {'precision': 0.4077954735959765, 'recall': 0.60289675470529, 'f1-score': 0.48651520360011247, 'support': 12911}, '1': {'precision': 0.91138493161169, 'recall': 0.8278019424417565, 'f1-score': 0.867584993833296, 'support': 100698}, '2': {'precision': 0.46545929798356983, 'recall': 0.5748654880860876, 'f1-score': 0.5144095192241558, 'support': 13010}, 'accuracy': 0.7788799469273964, 'macro avg': {'precision': 0.5948799010637454, 'recall': 0.6685213950777115, 'f1-score': 0.6228365722191881, 'support': 126619}, 'weighted avg': {'precision': 0.8142167658076422, 'recall': 0.7788799469273964, 'f1-score': 0.7924398340518608, 'support': 126619}}
[[ 7784  3787  1340]
 [10091 83358  7249]
 [ 1213  4318  7479]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
3870/3870 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6285386
{'0': {'precision': 0.4402205260969295, 'recall': 0.5689026028620214, 'f1-score': 0.4963568784479206, 'support': 115373}, '1': {'precision': 0.8916300336063441, 'recall': 0.8329660534006723, 'f1-score': 0.8613002844921376, 'support': 765084}, '2': {'precision': 0.4578885963390985, 'recall': 0.526891084079426, 'f1-score': 0.4899723739429343, 'support': 110241}, 'accuracy': 0.7681553813573864, 'macro avg': {'precision': 0.5965797186807907, 'recall': 0.6429199134473733, 'f1-score': 0.6158765122943308, 'support': 990698}, 'weighted avg': {'precision': 0.7907955119906124, 'recall': 0.7681553813573864, 'f1-score': 0.7774804163058748, 'support': 990698}}
[[ 65636  39909   9828]
 [ 68854 637289  58941]
 [ 14608  37548  58085]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5944494
{'0': {'precision': 0.39889038332212506, 'recall': 0.5865222980322358, 'f1-score': 0.4748428931673538, 'support': 40452}, '1': {'precision': 0.9056488005700262, 'recall': 0.8477233849403133, 'f1-score': 0.8757292640214863, 'support': 323858}, '2': {'precision': 0.48591204813383554, 'recall': 0.5068112244897959, 'f1-score': 0.4961416477286916, 'support': 39200}, 'accuracy': 0.7884191222026715, 'macro avg': {'precision': 0.5968170773419955, 'recall': 0.6470189691541149, 'f1-score': 0.6155712683058439, 'support': 403510}, 'weighted avg': {'precision': 0.814069726470225, 'recall': 0.7884191222026715, 'f1-score': 0.7986642841387848, 'support': 403510}}
[[ 23726  13761   2965]
 [ 31262 274542  18054]
 [  4492  14841  19867]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56641793
{'0': {'precision': 0.4246816846229187, 'recall': 0.6006372073694417, 'f1-score': 0.49756153537208103, 'support': 14438}, '1': {'precision': 0.9156772245290141, 'recall': 0.8590964335444821, 'f1-score': 0.8864849151803326, 'support': 124241}, '2': {'precision': 0.49726709583383943, 'recall': 0.5543294292871166, 'f1-score': 0.5242500880366232, 'support': 14771}, 'accuracy': 0.8054415118931249, 'macro avg': {'precision': 0.6125420016619241, 'recall': 0.67135435673368, 'f1-score': 0.6360988461963456, 'support': 153450}, 'weighted avg': {'precision': 0.8292039132476806, 'recall': 0.8054415118931249, 'f1-score': 0.8150228989573852, 'support': 153450}}
[[  8672   4671   1095]
 [ 10323 106735   7183]
 [  1425   5158   8188]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
2451/2451 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94101536
{'0': {'precision': 0.4827895869106124, 'recall': 0.5787615121169282, 'f1-score': 0.5264372701618653, 'support': 169061}, '1': {'precision': 0.6618383282967137, 'recall': 0.5890209665297208, 'f1-score': 0.6233101571569447, 'support': 296711}, '2': {'precision': 0.49165976576363424, 'recall': 0.4887323682141995, 'f1-score': 0.49019169646404454, 'support': 161569}, 'accuracy': 0.5604272636413051, 'macro avg': {'precision': 0.5454292269903201, 'recall': 0.5521716156202828, 'f1-score': 0.5466463745942848, 'support': 627341}, 'weighted avg': {'precision': 0.5697580411205483, 'recall': 0.5604272636413051, 'f1-score': 0.5629199647034524, 'support': 627341}}
[[ 97846  43948  27267]
 [ 67566 174769  54376]
 [ 37256  45349  78964]]
Evaluating performance on  train set...
1200/1200 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9034087
{'0': {'precision': 0.49157703299558325, 'recall': 0.5826015198728923, 'f1-score': 0.5332326283987916, 'support': 81191}, '1': {'precision': 0.6839286379380982, 'recall': 0.632140619513505, 'f1-score': 0.6570156858255094, 'support': 145243}, '2': {'precision': 0.5158048602229125, 'recall': 0.4899947928289816, 'f1-score': 0.5025686673448627, 'support': 80658}, 'accuracy': 0.5817084131139854, 'macro avg': {'precision': 0.563770177052198, 'recall': 0.568245644071793, 'f1-score': 0.5642723271897213, 'support': 307092}, 'weighted avg': {'precision': 0.5889155903177136, 'recall': 0.5817084131139854, 'f1-score': 0.5837234547281683, 'support': 307092}}
[[47302 20219 13670]
 [29999 91814 23430]
 [18924 22212 39522]]
Evaluating performance on  val set...
441/441 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8913913
{'0': {'precision': 0.48486702127659576, 'recall': 0.5921847593061781, 'f1-score': 0.5331793057058462, 'support': 30786}, '1': {'precision': 0.6912506380806533, 'recall': 0.6434898308306406, 'f1-score': 0.6665157257469114, 'support': 52610}, '2': {'precision': 0.5296838564165297, 'recall': 0.4722884995568887, 'f1-score': 0.49934230679135816, 'support': 29338}, 'accuracy': 0.5849255770220164, 'macro avg': {'precision': 0.5686005052579263, 'recall': 0.5693210298979025, 'f1-score': 0.5663457794147052, 'support': 112734}, 'weighted avg': {'precision': 0.5928440148135664, 'recall': 0.5849255770220164, 'f1-score': 0.5865981428286946, 'support': 112734}}
[[18231  7558  4997]
 [11450 33854  7306]
 [ 7919  7563 13856]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
3337/3337 - 27s - 27s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84424657
{'0': {'precision': 0.4579073736342798, 'recall': 0.5871647715082601, 'f1-score': 0.514542617295092, 'support': 186440}, '1': {'precision': 0.7577836146755224, 'recall': 0.6559861464266429, 'f1-score': 0.7032199540450146, 'support': 483341}, '2': {'precision': 0.48997669709273334, 'recall': 0.5226932262266609, 'f1-score': 0.5058064719445772, 'support': 184240}, 'accuracy': 0.612206257223183, 'macro avg': {'precision': 0.5685558951341785, 'recall': 0.5886147147205213, 'f1-score': 0.574523014428228, 'support': 854021}, 'weighted avg': {'precision': 0.6345434685020883, 'recall': 0.612206257223183, 'f1-score': 0.6194416129903564, 'support': 854021}}
[[109471  51050  25919]
 [ 91954 317065  74322]
 [ 37643  50296  96301]]
Evaluating performance on  train set...
1431/1431 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86525685
{'0': {'precision': 0.4835098545307107, 'recall': 0.557903625181145, 'f1-score': 0.5180495661111052, 'support': 87637}, '1': {'precision': 0.7228878770179925, 'recall': 0.6748757259247103, 'f1-score': 0.6980572104433153, 'support': 188897}, '2': {'precision': 0.5030011056705102, 'recall': 0.4977336667708659, 'f1-score': 0.5003535234503889, 'support': 89572}, 'accuracy': 0.6035355880537331, 'macro avg': {'precision': 0.5697996124064045, 'recall': 0.5768376726255737, 'f1-score': 0.5721534333349364, 'support': 366106}, 'weighted avg': {'precision': 0.6117887154640858, 'recall': 0.6035355880537332, 'f1-score': 0.6065972382558278, 'support': 366106}}
[[ 48893  23920  14824]
 [ 32188 127482  29227]
 [ 20040  24949  44583]]
Evaluating performance on  val set...
492/492 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9056888
{'0': {'precision': 0.5026671360103978, 'recall': 0.542838762500731, 'f1-score': 0.5219811891071152, 'support': 34198}, '1': {'precision': 0.6703188545748296, 'recall': 0.634654945054945, 'f1-score': 0.6519995664896499, 'support': 56875}, '2': {'precision': 0.5159557752192669, 'recall': 0.5203111495246326, 'f1-score': 0.5181243096696455, 'support': 34710}, 'accuracy': 0.5781385401842857, 'macro avg': {'precision': 0.5629805886014981, 'recall': 0.5659349523601028, 'f1-score': 0.5640350217554702, 'support': 125783}, 'weighted avg': {'precision': 0.5821408340482241, 'recall': 0.5781385401842857, 'f1-score': 0.5797069781911495, 'support': 125783}}
[[18564  9013  6621]
 [10457 36096 10322]
 [ 7910  8740 18060]]
testing model on single stock: results/universal/W9/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
10303/10303 - 77s - 77s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2213362
{'0': {'precision': 0.39800871731745713, 'recall': 0.6434774392701534, 'f1-score': 0.4918157166212733, 'support': 836121}, '1': {'precision': 0.501120038507109, 'recall': 0.16992473179030365, 'f1-score': 0.25379137699061943, 'support': 955782}, '2': {'precision': 0.43133655602194865, 'recall': 0.4905221874367978, 'f1-score': 0.4590294391253652, 'support': 845501}, 'accuracy': 0.4228297977860047, 'macro avg': {'precision': 0.4434884372821715, 'recall': 0.4346414528324183, 'f1-score': 0.40154551091241936, 'support': 2637404}, 'weighted avg': {'precision': 0.4460600078068073, 'recall': 0.4228297977860047, 'f1-score': 0.3950462380772454, 'support': 2637404}}
[[538025  76359 221737]
 [468329 162411 325042]
 [345438  85326 414737]]
Evaluating performance on  train set...
3419/3419 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2248303
{'0': {'precision': 0.4103259749714961, 'recall': 0.6186631411075134, 'f1-score': 0.49340377383423545, 'support': 289694}, '1': {'precision': 0.4993260377875762, 'recall': 0.15175617360028607, 'f1-score': 0.23276878878969495, 'support': 288041}, '2': {'precision': 0.44101416640538155, 'recall': 0.5202122258497272, 'f1-score': 0.4773505242584254, 'support': 297419}, 'accuracy': 0.4315309077031014, 'macro avg': {'precision': 0.4502220597214846, 'recall': 0.43021051351917555, 'f1-score': 0.40117436229411857, 'support': 875154}, 'weighted avg': {'precision': 0.4500480333768525, 'recall': 0.4315309077031014, 'f1-score': 0.40216485684042375, 'support': 875154}}
[[179223  20801  89670]
 [137890  43712 106439]
 [119669  23029 154721]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2285882
{'0': {'precision': 0.4044635651813562, 'recall': 0.6266378312621966, 'f1-score': 0.4916144468119654, 'support': 118373}, '1': {'precision': 0.510308988764045, 'recall': 0.14818712019250377, 'f1-score': 0.22967856126931951, 'support': 122595}, '2': {'precision': 0.42698343820062196, 'recall': 0.5076527541316274, 'f1-score': 0.4638367744571195, 'support': 116298}, 'accuracy': 0.42372629917204546, 'macro avg': {'precision': 0.4472519973820077, 'recall': 0.4274925685287759, 'f1-score': 0.3950432608461348, 'support': 357266}, 'weighted avg': {'precision': 0.4481148947131737, 'recall': 0.42372629917204546, 'f1-score': 0.3926895067739419, 'support': 357266}}
[[74177  8663 35533]
 [60730 18167 43698]
 [48489  8770 59039]]
training model: results/universal/W9/deepVOL_L2/h30
Epoch 1/50
6697/6697 - 231s - loss: 2.8711 - accuracy30: 0.5071 - val_loss: 3.0263 - val_accuracy30: 0.4744 - 231s/epoch - 34ms/step
Epoch 2/50
6697/6697 - 222s - loss: 2.7970 - accuracy30: 0.5293 - val_loss: 3.0567 - val_accuracy30: 0.4887 - 222s/epoch - 33ms/step
Epoch 3/50
6697/6697 - 221s - loss: 2.7755 - accuracy30: 0.5346 - val_loss: 3.0300 - val_accuracy30: 0.5023 - 221s/epoch - 33ms/step
Epoch 4/50
6697/6697 - 223s - loss: 2.7632 - accuracy30: 0.5379 - val_loss: 3.0228 - val_accuracy30: 0.5083 - 223s/epoch - 33ms/step
Epoch 5/50
6697/6697 - 223s - loss: 2.7514 - accuracy30: 0.5410 - val_loss: 3.0299 - val_accuracy30: 0.5095 - 223s/epoch - 33ms/step
Epoch 6/50
6697/6697 - 223s - loss: 2.7444 - accuracy30: 0.5424 - val_loss: 3.0078 - val_accuracy30: 0.5104 - 223s/epoch - 33ms/step
Epoch 7/50
6697/6697 - 222s - loss: 2.7374 - accuracy30: 0.5440 - val_loss: 3.0179 - val_accuracy30: 0.5131 - 222s/epoch - 33ms/step
Epoch 8/50
6697/6697 - 223s - loss: 2.7307 - accuracy30: 0.5451 - val_loss: 3.0274 - val_accuracy30: 0.5120 - 223s/epoch - 33ms/step
Epoch 9/50
6697/6697 - 223s - loss: 2.7247 - accuracy30: 0.5463 - val_loss: 3.0071 - val_accuracy30: 0.5112 - 223s/epoch - 33ms/step
Epoch 10/50
6697/6697 - 222s - loss: 2.7192 - accuracy30: 0.5472 - val_loss: 3.0122 - val_accuracy30: 0.5079 - 222s/epoch - 33ms/step
Epoch 11/50
6697/6697 - 225s - loss: 2.7142 - accuracy30: 0.5483 - val_loss: 2.9962 - val_accuracy30: 0.5065 - 225s/epoch - 34ms/step
Epoch 12/50
6697/6697 - 229s - loss: 2.7097 - accuracy30: 0.5488 - val_loss: 2.9976 - val_accuracy30: 0.5111 - 229s/epoch - 34ms/step
Epoch 13/50
6697/6697 - 225s - loss: 2.7058 - accuracy30: 0.5495 - val_loss: 2.9954 - val_accuracy30: 0.5095 - 225s/epoch - 34ms/step
Epoch 14/50
6697/6697 - 226s - loss: 2.7016 - accuracy30: 0.5503 - val_loss: 2.9977 - val_accuracy30: 0.5082 - 226s/epoch - 34ms/step
Epoch 15/50
6697/6697 - 223s - loss: 2.6982 - accuracy30: 0.5511 - val_loss: 2.9984 - val_accuracy30: 0.5095 - 223s/epoch - 33ms/step
Epoch 16/50
6697/6697 - 230s - loss: 2.6952 - accuracy30: 0.5516 - val_loss: 2.9774 - val_accuracy30: 0.5135 - 230s/epoch - 34ms/step
Epoch 17/50
6697/6697 - 221s - loss: 2.6923 - accuracy30: 0.5522 - val_loss: 2.9984 - val_accuracy30: 0.5106 - 221s/epoch - 33ms/step
Epoch 18/50
6697/6697 - 223s - loss: 2.6891 - accuracy30: 0.5528 - val_loss: 2.9829 - val_accuracy30: 0.5136 - 223s/epoch - 33ms/step
Epoch 19/50
6697/6697 - 224s - loss: 2.6866 - accuracy30: 0.5534 - val_loss: 2.9961 - val_accuracy30: 0.5100 - 224s/epoch - 33ms/step
Epoch 20/50
6697/6697 - 218s - loss: 2.6836 - accuracy30: 0.5538 - val_loss: 3.0063 - val_accuracy30: 0.5102 - 218s/epoch - 32ms/step
Epoch 21/50
6697/6697 - 237s - loss: 2.6819 - accuracy30: 0.5543 - val_loss: 3.0059 - val_accuracy30: 0.5118 - 237s/epoch - 35ms/step
Epoch 22/50
6697/6697 - 230s - loss: 2.6797 - accuracy30: 0.5546 - val_loss: 3.0097 - val_accuracy30: 0.5136 - 230s/epoch - 34ms/step
Epoch 23/50
6697/6697 - 234s - loss: 2.6777 - accuracy30: 0.5550 - val_loss: 3.0037 - val_accuracy30: 0.5135 - 234s/epoch - 35ms/step
Epoch 24/50
6697/6697 - 228s - loss: 2.6750 - accuracy30: 0.5557 - val_loss: 3.0073 - val_accuracy30: 0.5143 - 228s/epoch - 34ms/step
Epoch 25/50
6697/6697 - 228s - loss: 2.6736 - accuracy30: 0.5559 - val_loss: 3.0043 - val_accuracy30: 0.5141 - 228s/epoch - 34ms/step
Epoch 26/50
6697/6697 - 222s - loss: 2.6715 - accuracy30: 0.5565 - val_loss: 3.0074 - val_accuracy30: 0.5158 - 222s/epoch - 33ms/step
testing model in sample: results/universal/W9/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 270s - 270s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0696967
{'0': {'precision': 0.4121778888366047, 'recall': 0.5687879305569147, 'f1-score': 0.477981605021944, 'support': 1205822}, '1': {'precision': 0.7100542325568666, 'recall': 0.4102918083960738, 'f1-score': 0.5200704505319537, 'support': 1897101}, '2': {'precision': 0.42521266449026435, 'recall': 0.5461775786807971, 'f1-score': 0.4781633852066704, 'support': 1204773}, 'accuracy': 0.49266289914608646, 'macro avg': {'precision': 0.5158149286279119, 'recall': 0.5084191058779285, 'f1-score': 0.49207181358685603, 'support': 4307696}, 'weighted avg': {'precision': 0.547007611109634, 'recall': 0.49266289914608646, 'f1-score': 0.4965682914465149, 'support': 4307696}}
[[685857 155005 364960]
 [594208 778365 524528]
 [383918 162835 658020]]
Evaluating performance on  train set...
6697/6697 - 109s - 109s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0256711
{'0': {'precision': 0.42199199900742085, 'recall': 0.5427095911678455, 'f1-score': 0.4747978184959998, 'support': 463760}, '1': {'precision': 0.7402337594716433, 'recall': 0.48546347800746886, 'f1-score': 0.5863706703798002, 'support': 778969}, '2': {'precision': 0.4371365656192724, 'recall': 0.5627615240326264, 'f1-score': 0.49205742550009834, 'support': 471276}, 'accuracy': 0.5222061779283024, 'macro avg': {'precision': 0.5331207746994454, 'recall': 0.5303115310693136, 'f1-score': 0.5177419714586328, 'support': 1714005}, 'weighted avg': {'precision': 0.570788377478675, 'recall': 0.5222061779283024, 'f1-score': 0.5302503004954897, 'support': 1714005}}
[[251687  63569 148504]
 [207816 378161 192992]
 [136923  69137 265216]]
Evaluating performance on  val set...
2631/2631 - 42s - 42s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.035597
{'0': {'precision': 0.4129976728096107, 'recall': 0.5673061865857412, 'f1-score': 0.47800716601262583, 'support': 185191}, '1': {'precision': 0.7394139007652226, 'recall': 0.46505214731944483, 'f1-score': 0.5709849984655471, 'support': 306056}, '2': {'precision': 0.4336234628812652, 'recall': 0.5395576502717196, 'f1-score': 0.48082490211279355, 'support': 181621}, 'accuracy': 0.5133057300986226, 'macro avg': {'precision': 0.5286783454853662, 'recall': 0.5239719947256353, 'f1-score': 0.5099390221969888, 'support': 672868}, 'weighted avg': {'precision': 0.5670363872109297, 'recall': 0.5133057300986226, 'f1-score': 0.5210589734064384, 'support': 672868}}
[[105060  24223  55908]
 [ 91636 142332  72088]
 [ 57688  25938  97995]]
testing model out of sample: results/universal/W9/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 138s - 138s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8754159
{'0': {'precision': 0.4374129258158774, 'recall': 0.5914622710317378, 'f1-score': 0.5029050039778798, 'support': 479870}, '1': {'precision': 0.7885278829938589, 'recall': 0.6404202014562395, 'f1-score': 0.7067985060844585, 'support': 1260919}, '2': {'precision': 0.46426654034422865, 'recall': 0.5312059616852048, 'f1-score': 0.4954856182145492, 'support': 470471}, 'accuracy': 0.6065591563181173, 'macro avg': {'precision': 0.5634024497179883, 'recall': 0.587696144724394, 'f1-score': 0.5683963760922959, 'support': 2211260}, 'weighted avg': {'precision': 0.643341386318338, 'recall': 0.6065591563181173, 'f1-score': 0.6175919177479771, 'support': 2211260}}
[[283825 103494  92551]
 [257564 807518 195837]
 [107483 113071 249917]]
Evaluating performance on  train set...
3947/3947 - 63s - 63s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.893403
{'0': {'precision': 0.4369151478986162, 'recall': 0.5712710312963124, 'f1-score': 0.4951406243801817, 'support': 229420}, '1': {'precision': 0.77882382778509, 'recall': 0.647414938415431, 'f1-score': 0.7070655944168376, 'support': 550219}, '2': {'precision': 0.47420775729798953, 'recall': 0.520172741466215, 'f1-score': 0.49612788956500464, 'support': 229939}, 'accuracy': 0.6011313637975471, 'macro avg': {'precision': 0.5633155776605653, 'recall': 0.5796195703926528, 'f1-score': 0.566111369454008, 'support': 1009578}, 'weighted avg': {'precision': 0.6317487092986648, 'recall': 0.6011313637975471, 'f1-score': 0.610864378124748, 'support': 1009578}}
[[131061  46762  51597]
 [112977 356220  81022]
 [ 55931  54400 119608]]
Evaluating performance on  val set...
1402/1402 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.884885
{'0': {'precision': 0.4437174986389322, 'recall': 0.573531017580471, 'f1-score': 0.5003413511153448, 'support': 82421}, '1': {'precision': 0.7824574004359025, 'recall': 0.6545667386653821, 'f1-score': 0.7128211347489727, 'support': 193059}, '2': {'precision': 0.4871402598554388, 'recall': 0.5309441531137479, 'f1-score': 0.5080998577755167, 'support': 82762}, 'accuracy': 0.6073631790800632, 'macro avg': {'precision': 0.5711050529767578, 'recall': 0.5863473031198669, 'f1-score': 0.5737541145466114, 'support': 358242}, 'weighted avg': {'precision': 0.6362983274217713, 'recall': 0.6073631790800632, 'f1-score': 0.6166405122319467, 'support': 358242}}
[[ 47271  16412  18738]
 [ 39165 126370  27524]
 [ 20098  18722  43942]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1094422
{'0': {'precision': 0.42200365965233305, 'recall': 0.5853658536585366, 'f1-score': 0.4904387699157681, 'support': 25215}, '1': {'precision': 0.5196778140293637, 'recall': 0.22588078883226234, 'f1-score': 0.31489203966268187, 'support': 22565}, '2': {'precision': 0.48028767571101666, 'recall': 0.5324345872291077, 'f1-score': 0.5050185618039322, 'support': 27594}, 'accuracy': 0.45836760686708944, 'macro avg': {'precision': 0.47398971646423776, 'recall': 0.44789374323996894, 'f1-score': 0.43678312379412737, 'support': 75374}, 'weighted avg': {'precision': 0.4725821937972771, 'recall': 0.45836760686708944, 'f1-score': 0.4432222603660707, 'support': 75374}}
[[14760  2080  8375]
 [ 9945  5097  7523]
 [10271  2631 14692]]
Evaluating performance on  train set...
200/200 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0797828
{'0': {'precision': 0.44802207911683534, 'recall': 0.5282900371110477, 'f1-score': 0.48485642422972125, 'support': 17515}, '1': {'precision': 0.5585118376550169, 'recall': 0.30093548779006196, 'f1-score': 0.39112584872888045, 'support': 16462}, '2': {'precision': 0.448393964639452, 'recall': 0.5648320895522388, 'f1-score': 0.4999225966252129, 'support': 17152}, 'accuracy': 0.46734729801091357, 'macro avg': {'precision': 0.48497596047043484, 'recall': 0.4646858714844495, 'f1-score': 0.4586349565279382, 'support': 51129}, 'weighted avg': {'precision': 0.483721212398133, 'recall': 0.46734729801091357, 'f1-score': 0.4597321748806753, 'support': 51129}}
[[9253 1989 6273]
 [5863 4954 5645]
 [5537 1927 9688]]
Evaluating performance on  val set...
53/53 - 1s - 591ms/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0810862
{'0': {'precision': 0.43630516348043596, 'recall': 0.5522388059701493, 'f1-score': 0.4874737997804172, 'support': 4422}, '1': {'precision': 0.592402057776019, 'recall': 0.3182397959183674, 'f1-score': 0.41405061540589133, 'support': 4704}, '2': {'precision': 0.4436146377893951, 'recall': 0.5457050987597611, 'f1-score': 0.48939237899073124, 'support': 4354}, 'accuracy': 0.4684718100890208, 'macro avg': {'precision': 0.4907739530152833, 'recall': 0.4720612335494259, 'f1-score': 0.4636389313923466, 'support': 13480}, 'weighted avg': {'precision': 0.4931378965596371, 'recall': 0.4684718100890208, 'f1-score': 0.46247163617388437, 'support': 13480}}
[[2442  513 1467]
 [1694 1497 1513]
 [1461  517 2376]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
1118/1118 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70321774
{'0': {'precision': 0.31847874414309657, 'recall': 0.6271974136189129, 'f1-score': 0.42244703534001726, 'support': 29694}, '1': {'precision': 0.8875860232672457, 'recall': 0.7685404815847695, 'f1-score': 0.8237846417785254, 'support': 225547}, '2': {'precision': 0.48148720007411294, 'recall': 0.5043343252684694, 'f1-score': 0.49264601336514, 'support': 30916}, 'accuracy': 0.7253291025555901, 'macro avg': {'precision': 0.5625173224948185, 'recall': 0.6333574068240506, 'f1-score': 0.5796258968278942, 'support': 286157}, 'weighted avg': {'precision': 0.784656432992846, 'recall': 0.7253291025555901, 'f1-score': 0.7463628043899126, 'support': 286157}}
[[ 18624   9598   1472]
 [ 36886 173342  15319]
 [  2968  12356  15592]]
Evaluating performance on  train set...
505/505 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64314574
{'0': {'precision': 0.43123543123543123, 'recall': 0.5471613193596091, 'f1-score': 0.4823306033383399, 'support': 15553}, '1': {'precision': 0.8668060789266636, 'recall': 0.851606997558991, 'f1-score': 0.8591393215539002, 'support': 98320}, '2': {'precision': 0.555753860479553, 'recall': 0.46676225234619395, 'f1-score': 0.5073854982111863, 'support': 15344}, 'accuracy': 0.7692641061160683, 'macro avg': {'precision': 0.6179317902138827, 'recall': 0.6218435230882647, 'f1-score': 0.6162851410344755, 'support': 129217}, 'weighted avg': {'precision': 0.7774431040596245, 'recall': 0.7692641061160683, 'f1-score': 0.7720159812830595, 'support': 129217}}
[[ 8510  5915  1128]
 [ 9993 83730  4597]
 [ 1231  6951  7162]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6636148
{'0': {'precision': 0.3826086956521739, 'recall': 0.5895627644569816, 'f1-score': 0.4640577296697197, 'support': 5672}, '1': {'precision': 0.864787359123627, 'recall': 0.8292132977699562, 'f1-score': 0.8466268003032089, 'support': 36367}, '2': {'precision': 0.6230366492146597, 'recall': 0.4534118462071354, 'f1-score': 0.5248596631916599, 'support': 5774}, 'accuracy': 0.7554012507058749, 'macro avg': {'precision': 0.6234775679968202, 'recall': 0.6240626361446912, 'f1-score': 0.6118480643881962, 'support': 47813}, 'weighted avg': {'precision': 0.7783927388692097, 'recall': 0.7554012507058749, 'f1-score': 0.7623857943358938, 'support': 47813}}
[[ 3344  2085   243]
 [ 4870 30156  1341]
 [  526  2630  2618]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
508/508 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1112509
{'0': {'precision': 0.4421011561287143, 'recall': 0.5408345265908007, 'f1-score': 0.48650908433517126, 'support': 39807}, '1': {'precision': 0.5842703091301222, 'recall': 0.4119710456416391, 'f1-score': 0.4832211572763812, 'support': 49319}, '2': {'precision': 0.4454911936533943, 'recall': 0.5073282105418211, 'f1-score': 0.4744031221303948, 'support': 40733}, 'accuracy': 0.48138365457919746, 'macro avg': {'precision': 0.4906208863040769, 'recall': 0.48671126092475364, 'f1-score': 0.48137778791398245, 'support': 129859}, 'weighted avg': {'precision': 0.497158771352682, 'recall': 0.48138365457919746, 'f1-score': 0.48146307725749754, 'support': 129859}}
[[21529  7160 11118]
 [14397 20318 14604]
 [12771  7297 20665]]
Evaluating performance on  train set...
262/262 - 12s - 12s/epoch - 44ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1661249
{'0': {'precision': 0.4406402526557565, 'recall': 0.5456403875211092, 'f1-score': 0.4875511257594409, 'support': 22502}, '1': {'precision': 0.48998217468805705, 'recall': 0.30777499104263706, 'f1-score': 0.3780705856463015, 'support': 22328}, '2': {'precision': 0.44716747291408465, 'recall': 0.5067506342877854, 'f1-score': 0.47509822661144735, 'support': 22072}, 'accuracy': 0.4534244118262533, 'macro avg': {'precision': 0.45926330008596605, 'recall': 0.4533886709505106, 'f1-score': 0.4469066460057299, 'support': 66902}, 'weighted avg': {'precision': 0.45926114950008146, 'recall': 0.4534244118262533, 'f1-score': 0.44690448007409983, 'support': 66902}}
[[12278  3504  6720]
 [ 8348  6872  7108]
 [ 7238  3649 11185]]
Evaluating performance on  val set...
73/73 - 1s - 664ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1963091
{'0': {'precision': 0.4461701376632545, 'recall': 0.5811494252873564, 'f1-score': 0.5047923322683705, 'support': 6525}, '1': {'precision': 0.4291044776119403, 'recall': 0.20765619357168652, 'f1-score': 0.27987344852762225, 'support': 5538}, '2': {'precision': 0.46153846153846156, 'recall': 0.5234410559854347, 'f1-score': 0.490544575572302, 'support': 6591}, 'accuracy': 0.44987670204781816, 'macro avg': {'precision': 0.44560435893788547, 'recall': 0.43741555828149253, 'f1-score': 0.42507011878943163, 'support': 18654}, 'weighted avg': {'precision': 0.44653375926169514, 'recall': 0.44987670204781816, 'f1-score': 0.43298426201319457, 'support': 18654}}
[[3792  750 1983]
 [2346 1150 2042]
 [2361  780 3450]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
604/604 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1796306
{'0': {'precision': 0.3170490054111729, 'recall': 0.5084849349114837, 'f1-score': 0.3905705992348196, 'support': 49087}, '1': {'precision': 0.3855437879683888, 'recall': 0.24078364222401288, 'f1-score': 0.29643484550997207, 'support': 59568}, '2': {'precision': 0.31514395592973704, 'recall': 0.2650523417182071, 'f1-score': 0.2879358032312057, 'support': 45757}, 'accuracy': 0.3330764448358936, 'macro avg': {'precision': 0.3392455831030996, 'recall': 0.33810697295123454, 'f1-score': 0.32498041599199917, 'support': 154412}, 'weighted avg': {'precision': 0.34290792737479087, 'recall': 0.3330764448358936, 'f1-score': 0.32384172493347596, 'support': 154412}}
[[24960 12182 11945]
 [30814 14343 14411]
 [22952 10677 12128]]
Evaluating performance on  train set...
323/323 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1455816
{'0': {'precision': 0.35247744964784383, 'recall': 0.49342697017920156, 'f1-score': 0.41120929495033953, 'support': 28906}, '1': {'precision': 0.35366908965039806, 'recall': 0.29568803356967155, 'f1-score': 0.32208999921191583, 'support': 27644}, '2': {'precision': 0.3391751495434988, 'recall': 0.24780525206057122, 'f1-score': 0.28637884057328933, 'support': 26085}, 'accuracy': 0.3497428450414473, 'macro avg': {'precision': 0.3484405629472469, 'recall': 0.34564008526981477, 'f1-score': 0.3398927115785149, 'support': 82635}, 'weighted avg': {'precision': 0.34867701639327575, 'recall': 0.3497428450414473, 'f1-score': 0.34199145488476995, 'support': 82635}}
[[14263  8088  6555]
 [13431  8174  6039]
 [12771  6850  6464]]
Evaluating performance on  val set...
112/112 - 1s - 971ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.132785
{'0': {'precision': 0.3756489581110874, 'recall': 0.4999053568048457, 'f1-score': 0.4289600844601454, 'support': 10566}, '1': {'precision': 0.29719073435189747, 'recall': 0.3032817804602037, 'f1-score': 0.3002053643661709, 'support': 7953}, '2': {'precision': 0.371944400063908, 'recall': 0.23474841181809014, 'f1-score': 0.2878338278931751, 'support': 9917}, 'accuracy': 0.3524405682937122, 'macro avg': {'precision': 0.34826136417563097, 'recall': 0.3459785163610465, 'f1-score': 0.3389997589064971, 'support': 28436}, 'weighted avg': {'precision': 0.3524137507784557, 'recall': 0.3524405682937122, 'f1-score': 0.34373236694424925, 'support': 28436}}
[[5282 3003 2281]
 [3891 2412 1650]
 [4888 2701 2328]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
631/631 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2006512
{'0': {'precision': 0.46036091908817256, 'recall': 0.5059684123025769, 'f1-score': 0.48208840557900823, 'support': 60150}, '1': {'precision': 0.3581808097615086, 'recall': 0.07338136036179352, 'f1-score': 0.12180768795503416, 'support': 44003}, '2': {'precision': 0.42331523252575887, 'recall': 0.6383168576677456, 'f1-score': 0.5090449912445322, 'support': 57155}, 'accuracy': 0.43485753961365836, 'macro avg': {'precision': 0.41395232045848, 'recall': 0.40588887677737207, 'f1-score': 0.3709803615928582, 'support': 161308}, 'weighted avg': {'precision': 0.41936123174361467, 'recall': 0.43485753961365836, 'f1-score': 0.39335921196248136, 'support': 161308}}
[[30434  3056 26660]
 [17733  3229 23041]
 [17942  2730 36483]]
Evaluating performance on  train set...
477/477 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1886045
{'0': {'precision': 0.42662873399715506, 'recall': 0.5510669051177148, 'f1-score': 0.4809287607970581, 'support': 40819}, '1': {'precision': 0.5152549045338233, 'recall': 0.1971480932894836, 'f1-score': 0.2851799397174711, 'support': 39833}, '2': {'precision': 0.43611600111183174, 'recall': 0.5701446255965503, 'f1-score': 0.49420435932972157, 'support': 41279}, 'accuracy': 0.4419056679597477, 'macro avg': {'precision': 0.45933321321427, 'recall': 0.4394532080012496, 'f1-score': 0.4201043532814169, 'support': 121931}, 'weighted avg': {'precision': 0.45879341033224497, 'recall': 0.4419056679597477, 'f1-score': 0.42147497662212824, 'support': 121931}}
[[22494  3583 14742]
 [16292  7853 15688]
 [13939  3805 23535]]
Evaluating performance on  val set...
184/184 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1815479
{'0': {'precision': 0.42742207448089803, 'recall': 0.5753566796368352, 'f1-score': 0.4904773751278436, 'support': 15420}, '1': {'precision': 0.558364414974444, 'recall': 0.24646341463414634, 'f1-score': 0.3419772410000423, 'support': 16400}, '2': {'precision': 0.4321203453572753, 'recall': 0.5418797741614082, 'f1-score': 0.4808157010667767, 'support': 15055}, 'accuracy': 0.449536, 'macro avg': {'precision': 0.4726356116042058, 'recall': 0.4545666228107966, 'f1-score': 0.4377567723982208, 'support': 46875}, 'weighted avg': {'precision': 0.47474339399317567, 'recall': 0.449536, 'f1-score': 0.4354190561372238, 'support': 46875}}
[[8872 1489 5059]
 [6696 4042 5662]
 [5189 1708 8158]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
2354/2354 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67543674
{'0': {'precision': 0.4363386900064567, 'recall': 0.6336536958899828, 'f1-score': 0.5168029739776951, 'support': 76788}, '1': {'precision': 0.874694163306427, 'recall': 0.7960982476083062, 'f1-score': 0.8335475862261349, 'support': 450413}, '2': {'precision': 0.48872468460008156, 'recall': 0.5260903685771671, 'f1-score': 0.506719620780219, 'support': 75181}, 'accuracy': 0.7416921488357886, 'macro avg': {'precision': 0.5999191793043218, 'recall': 0.6519474373584853, 'f1-score': 0.6190233936613497, 'support': 602382}, 'weighted avg': {'precision': 0.7706438904523578, 'recall': 0.7416921488357886, 'f1-score': 0.7523807542897182, 'support': 602382}}
[[ 48657  23234   4897]
 [ 55360 358573  36480]
 [  7495  28134  39552]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6719917
{'0': {'precision': 0.407140580172139, 'recall': 0.6539515117380508, 'f1-score': 0.5018418286657302, 'support': 39061}, '1': {'precision': 0.8758512727494293, 'recall': 0.776921317950317, 'f1-score': 0.8234254718186664, 'support': 240525}, '2': {'precision': 0.5086966446016891, 'recall': 0.5527144664070831, 'f1-score': 0.5297928230973126, 'support': 40321}, 'accuracy': 0.7336475913312306, 'macro avg': {'precision': 0.5972294991744191, 'recall': 0.6611957653651502, 'f1-score': 0.6183533745272364, 'support': 319907}, 'weighted avg': {'precision': 0.7723450971286816, 'recall': 0.7336475913312306, 'f1-score': 0.7471503646334827, 'support': 319907}}
[[ 25544  11338   2179]
 [ 34311 186869  19345]
 [  2885  15150  22286]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6928508
{'0': {'precision': 0.3695480631276901, 'recall': 0.6570371787513551, 'f1-score': 0.47303780904937903, 'support': 15681}, '1': {'precision': 0.8790354282344848, 'recall': 0.7526848920257918, 'f1-score': 0.8109682501005819, 'support': 95069}, '2': {'precision': 0.5006633977502163, 'recall': 0.5469153695885058, 'f1-score': 0.5227683411637152, 'support': 15869}, 'accuracy': 0.7150506638024309, 'macro avg': {'precision': 0.583082296370797, 'recall': 0.6522124801218843, 'f1-score': 0.602258133437892, 'support': 126619}, 'weighted avg': {'precision': 0.7685175981774278, 'recall': 0.7150506638024309, 'f1-score': 0.7329978696597077, 'support': 126619}}
[[10303  4051  1327]
 [16183 71557  7329]
 [ 1394  5796  8679]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
3870/3870 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7473899
{'0': {'precision': 0.4139569618569726, 'recall': 0.5845021594996317, 'f1-score': 0.48466428513679827, 'support': 138458}, '1': {'precision': 0.8563080571325371, 'recall': 0.7570849977576265, 'f1-score': 0.8036454372343373, 'support': 720219}, '2': {'precision': 0.4294776307816603, 'recall': 0.5153952780239507, 'f1-score': 0.468530192492417, 'support': 132021}, 'accuracy': 0.7007574457604638, 'macro avg': {'precision': 0.5665808832570567, 'recall': 0.6189941450937363, 'f1-score': 0.5856133049545176, 'support': 990698}, 'weighted avg': {'precision': 0.7376062653988976, 'recall': 0.7007574457604638, 'f1-score': 0.7144076048341568, 'support': 990698}}
[[ 80929  45206  12323]
 [ 96886 545267  78066]
 [ 17686  46292  68043]]
Evaluating performance on  train set...
1577/1577 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71222985
{'0': {'precision': 0.3780178535199838, 'recall': 0.6095401664315361, 'f1-score': 0.4666400569760434, 'support': 48909}, '1': {'precision': 0.8740586588954931, 'recall': 0.7890786783188549, 'f1-score': 0.8293975920107874, 'support': 307124}, '2': {'precision': 0.476847748089992, 'recall': 0.47589359058070224, 'f1-score': 0.47637019154745464, 'support': 47477}, 'accuracy': 0.7304676464028153, 'macro avg': {'precision': 0.5763080868351563, 'recall': 0.6248374784436977, 'f1-score': 0.5908026135114285, 'support': 403510}, 'weighted avg': {'precision': 0.7671982535463727, 'recall': 0.7304676464028153, 'f1-score': 0.7438909374723325, 'support': 403510}}
[[ 29812  15604   3493]
 [ 43484 242345  21295]
 [  5568  19315  22594]]
Evaluating performance on  val set...
600/600 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6912417
{'0': {'precision': 0.38518089922058474, 'recall': 0.6431940892298948, 'f1-score': 0.48182050408719346, 'support': 17595}, '1': {'precision': 0.8872528118100761, 'recall': 0.7939393425526322, 'f1-score': 0.8380064256884346, 'support': 117941}, '2': {'precision': 0.5039930930282754, 'recall': 0.5213799263146143, 'f1-score': 0.5125390989408989, 'support': 17914}, 'accuracy': 0.7448354512870642, 'macro avg': {'precision': 0.5921422680196454, 'recall': 0.6528377860323804, 'f1-score': 0.6107886762388423, 'support': 153450}, 'weighted avg': {'precision': 0.7849415058193998, 'recall': 0.7448354512870642, 'f1-score': 0.7591695864448427, 'support': 153450}}
[[11317  5120  1158]
 [16269 93638  8034]
 [ 1795  6779  9340]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
2451/2451 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9726048
{'0': {'precision': 0.5012790515559816, 'recall': 0.5468737055753459, 'f1-score': 0.5230846946431623, 'support': 193136}, '1': {'precision': 0.5778427987118826, 'recall': 0.5258637922900391, 'f1-score': 0.5506293211536891, 'support': 250118}, '2': {'precision': 0.48874980822033764, 'recall': 0.5018442366924335, 'f1-score': 0.4952104763793667, 'support': 184087}, 'accuracy': 0.5252836973830819, 'macro avg': {'precision': 0.522623886162734, 'recall': 0.5248605781859395, 'f1-score': 0.5229748307254061, 'support': 627341}, 'weighted avg': {'precision': 0.5281280865994603, 'recall': 0.5252836973830819, 'f1-score': 0.5258871986657475, 'support': 627341}}
[[105621  46763  40752]
 [ 62706 131528  55884]
 [ 42376  49328  92383]]
Evaluating performance on  train set...
1200/1200 - 14s - 14s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93904746
{'0': {'precision': 0.5042344946498302, 'recall': 0.5409213561387475, 'f1-score': 0.5219340377841819, 'support': 91908}, '1': {'precision': 0.6078909038253507, 'recall': 0.5767030303030303, 'f1-score': 0.5918864114185718, 'support': 123750}, '2': {'precision': 0.5118775796961448, 'recall': 0.5099853446201632, 'f1-score': 0.5109297101846272, 'support': 91434}, 'accuracy': 0.5461294986518698, 'macro avg': {'precision': 0.5413343260571085, 'recall': 0.5425365770206471, 'f1-score': 0.5415833864624603, 'support': 307092}, 'weighted avg': {'precision': 0.548280964351403, 'recall': 0.5461294986518698, 'f1-score': 0.5468465608962072, 'support': 307092}}
[[49715 21767 20426]
 [28343 71367 24040]
 [20537 24267 46630]]
Evaluating performance on  val set...
441/441 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9315004
{'0': {'precision': 0.4903786621758835, 'recall': 0.5715894001501068, 'f1-score': 0.5278788605857027, 'support': 34642}, '1': {'precision': 0.6207782412972259, 'recall': 0.5821288069663617, 'f1-score': 0.6008326204733391, 'support': 45246}, '2': {'precision': 0.5243266724587315, 'recall': 0.4777141813310601, 'f1-score': 0.4999362773210986, 'support': 32846}, 'accuracy': 0.5484680752922809, 'macro avg': {'precision': 0.5451611919772804, 'recall': 0.5438107961491762, 'f1-score': 0.5428825861267135, 'support': 112734}, 'weighted avg': {'precision': 0.5526058137244375, 'recall': 0.5484680752922809, 'f1-score': 0.549017680550991, 'support': 112734}}
[[19801  7816  7025]
 [11697 26339  7210]
 [ 8881  8274 15691]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
3337/3337 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90594316
{'0': {'precision': 0.4484249475642091, 'recall': 0.628815205327414, 'f1-score': 0.5235163667444385, 'support': 216240}, '1': {'precision': 0.6998838684960371, 'recall': 0.5504398405886826, 'f1-score': 0.6162307604125352, 'support': 424813}, '2': {'precision': 0.5069339006594705, 'recall': 0.5157911047669134, 'f1-score': 0.5113241492632495, 'support': 212968}, 'accuracy': 0.5616442687006525, 'macro avg': {'precision': 0.5517475722399056, 'recall': 0.5650153835610033, 'f1-score': 0.5503570921400743, 'support': 854021}, 'weighted avg': {'precision': 0.5880978049068322, 'recall': 0.5616442687006525, 'f1-score': 0.5665946137018216, 'support': 854021}}
[[135975  46018  34247]
 [118384 233834  72595]
 [ 48869  54252 109847]]
Evaluating performance on  train set...
1431/1431 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9189857
{'0': {'precision': 0.4771370108990688, 'recall': 0.5731627790318535, 'f1-score': 0.5207602205915866, 'support': 99675}, '1': {'precision': 0.6642558933918103, 'recall': 0.5746206041149862, 'f1-score': 0.6161955990220049, 'support': 164472}, '2': {'precision': 0.5024833562295256, 'recall': 0.5130003236595102, 'f1-score': 0.5076873798846893, 'support': 101959}, 'accuracy': 0.557062708614445, 'macro avg': {'precision': 0.5479587535068017, 'recall': 0.5535945689354499, 'f1-score': 0.5482143998327603, 'support': 366106}, 'weighted avg': {'precision': 0.5682584480372043, 'recall': 0.557062708614445, 'f1-score': 0.5599935404376782, 'support': 366106}}
[[57130 21957 20588]
 [38763 94509 31200]
 [23842 25812 52305]]
Evaluating performance on  val set...
492/492 - 12s - 12s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94273084
{'0': {'precision': 0.4963891248937978, 'recall': 0.5468940950102706, 'f1-score': 0.5204191461196818, 'support': 38459}, '1': {'precision': 0.5996635634620703, 'recall': 0.5368223450779768, 'f1-score': 0.5665055729710902, 'support': 48476}, '2': {'precision': 0.5159815069348994, 'recall': 0.5314816721581549, 'f1-score': 0.5236169052660944, 'support': 38848}, 'accuracy': 0.5382523870475342, 'macro avg': {'precision': 0.5373447317635892, 'recall': 0.5383993707488007, 'f1-score': 0.5368472081189555, 'support': 125783}, 'weighted avg': {'precision': 0.542241557587948, 'recall': 0.5382523870475342, 'f1-score': 0.5391681994525543, 'support': 125783}}
[[21033  8396  9030]
 [12115 26023 10338]
 [ 9224  8977 20647]]
testing model on single stock: results/universal/W9/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
10303/10303 - 73s - 73s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2160225
{'0': {'precision': 0.40535095782958946, 'recall': 0.5695103468954646, 'f1-score': 0.473609042617702, 'support': 857117}, '1': {'precision': 0.4455861664454274, 'recall': 0.11085352540717863, 'f1-score': 0.17753872754364758, 'support': 911455}, '2': {'precision': 0.4131262961925303, 'recall': 0.5736471492762697, 'f1-score': 0.4803305625828213, 'support': 868832}, 'accuracy': 0.4123668577131149, 'macro avg': {'precision': 0.42135447348918237, 'recall': 0.4180036738596377, 'f1-score': 0.377159444248057, 'support': 2637404}, 'weighted avg': {'precision': 0.42181716658998386, 'recall': 0.4123668577131149, 'f1-score': 0.3735049639890627, 'support': 2637404}}
[[488137  63316 305664]
 [408066 101038 402351]
 [308030  62399 498403]]
Evaluating performance on  train set...
3419/3419 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2301121
{'0': {'precision': 0.41025688965336726, 'recall': 0.5327226946714204, 'f1-score': 0.4635374071648655, 'support': 288332}, '1': {'precision': 0.46577190039146027, 'recall': 0.09807778893776192, 'f1-score': 0.16203565951797852, 'support': 288730}, '2': {'precision': 0.4152729603549462, 'recall': 0.6129013861492425, 'f1-score': 0.4950938017413548, 'support': 298092}, 'accuracy': 0.4166352436256933, 'macro avg': {'precision': 0.43043391679992454, 'recall': 0.41456728991947495, 'f1-score': 0.3735556228080663, 'support': 875154}, 'weighted avg': {'precision': 0.430280907823866, 'recall': 0.4166352436256933, 'f1-score': 0.37481486138893255, 'support': 875154}}
[[153601  16604 118127]
 [121286  28318 139126]
 [ 99515  15876 182701]]
Evaluating performance on  val set...
1396/1396 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2325151
{'0': {'precision': 0.4061212513906378, 'recall': 0.560052263339796, 'f1-score': 0.47082459323090875, 'support': 118630}, '1': {'precision': 0.4667883069994953, 'recall': 0.0990273511171873, 'f1-score': 0.16339176518548715, 'support': 121421}, '2': {'precision': 0.40862827773906724, 'recall': 0.5853687667960585, 'f1-score': 0.4812855980471928, 'support': 117215}, 'accuracy': 0.4116736549237823, 'macro avg': {'precision': 0.4271792787097335, 'recall': 0.4148161270843473, 'f1-score': 0.3718339854878629, 'support': 357266}, 'weighted avg': {'precision': 0.427562182384671, 'recall': 0.4116736549237823, 'f1-score': 0.36977211486867334, 'support': 357266}}
[[66439  7235 44956]
 [55054 12024 54343]
 [42101  6500 68614]]
training model: results/universal/W9/deepVOL_L3/h10
Epoch 1/50
6697/6697 - 393s - loss: 2.7262 - accuracy10: 0.5414 - val_loss: 2.8552 - val_accuracy10: 0.5279 - 393s/epoch - 59ms/step
Epoch 2/50
6697/6697 - 383s - loss: 2.6134 - accuracy10: 0.5761 - val_loss: 2.7416 - val_accuracy10: 0.5528 - 383s/epoch - 57ms/step
Epoch 3/50
6697/6697 - 381s - loss: 2.5796 - accuracy10: 0.5839 - val_loss: 2.7176 - val_accuracy10: 0.5669 - 381s/epoch - 57ms/step
Epoch 4/50
6697/6697 - 377s - loss: 2.5582 - accuracy10: 0.5889 - val_loss: 2.7043 - val_accuracy10: 0.5670 - 377s/epoch - 56ms/step
Epoch 5/50
6697/6697 - 382s - loss: 2.5447 - accuracy10: 0.5916 - val_loss: 2.7270 - val_accuracy10: 0.5678 - 382s/epoch - 57ms/step
Epoch 6/50
6697/6697 - 381s - loss: 2.5350 - accuracy10: 0.5938 - val_loss: 2.6977 - val_accuracy10: 0.5707 - 381s/epoch - 57ms/step
Epoch 7/50
6697/6697 - 380s - loss: 2.5282 - accuracy10: 0.5954 - val_loss: 2.7029 - val_accuracy10: 0.5712 - 380s/epoch - 57ms/step
Epoch 8/50
6697/6697 - 374s - loss: 2.5217 - accuracy10: 0.5965 - val_loss: 2.6814 - val_accuracy10: 0.5732 - 374s/epoch - 56ms/step
Epoch 9/50
6697/6697 - 385s - loss: 2.5168 - accuracy10: 0.5972 - val_loss: 2.6874 - val_accuracy10: 0.5728 - 385s/epoch - 57ms/step
Epoch 10/50
6697/6697 - 380s - loss: 2.5122 - accuracy10: 0.5987 - val_loss: 2.6946 - val_accuracy10: 0.5703 - 380s/epoch - 57ms/step
Epoch 11/50
6697/6697 - 433s - loss: 2.5081 - accuracy10: 0.5993 - val_loss: 2.6704 - val_accuracy10: 0.5690 - 433s/epoch - 65ms/step
Epoch 12/50
6697/6697 - 391s - loss: 2.5045 - accuracy10: 0.6000 - val_loss: 2.6707 - val_accuracy10: 0.5667 - 391s/epoch - 58ms/step
Epoch 13/50
6697/6697 - 381s - loss: 2.5005 - accuracy10: 0.6007 - val_loss: 2.6534 - val_accuracy10: 0.5707 - 381s/epoch - 57ms/step
Epoch 14/50
6697/6697 - 377s - loss: 2.4976 - accuracy10: 0.6011 - val_loss: 2.6673 - val_accuracy10: 0.5686 - 377s/epoch - 56ms/step
Epoch 15/50
6697/6697 - 383s - loss: 2.4939 - accuracy10: 0.6020 - val_loss: 2.6587 - val_accuracy10: 0.5688 - 383s/epoch - 57ms/step
Epoch 16/50
6697/6697 - 364s - loss: 2.4913 - accuracy10: 0.6024 - val_loss: 2.6575 - val_accuracy10: 0.5720 - 364s/epoch - 54ms/step
Epoch 17/50
6697/6697 - 431s - loss: 2.4884 - accuracy10: 0.6027 - val_loss: 2.6470 - val_accuracy10: 0.5700 - 431s/epoch - 64ms/step
Epoch 18/50
6697/6697 - 425s - loss: 2.4855 - accuracy10: 0.6036 - val_loss: 2.6445 - val_accuracy10: 0.5740 - 425s/epoch - 63ms/step
Epoch 19/50
6697/6697 - 375s - loss: 2.4834 - accuracy10: 0.6040 - val_loss: 2.6499 - val_accuracy10: 0.5737 - 375s/epoch - 56ms/step
Epoch 20/50
6697/6697 - 512s - loss: 2.4806 - accuracy10: 0.6047 - val_loss: 2.6360 - val_accuracy10: 0.5733 - 512s/epoch - 76ms/step
Epoch 21/50
6697/6697 - 405s - loss: 2.4786 - accuracy10: 0.6051 - val_loss: 2.6296 - val_accuracy10: 0.5757 - 405s/epoch - 60ms/step
Epoch 22/50
6697/6697 - 387s - loss: 2.4763 - accuracy10: 0.6053 - val_loss: 2.6246 - val_accuracy10: 0.5753 - 387s/epoch - 58ms/step
Epoch 23/50
6697/6697 - 460s - loss: 2.4742 - accuracy10: 0.6058 - val_loss: 2.6175 - val_accuracy10: 0.5752 - 460s/epoch - 69ms/step
Epoch 24/50
6697/6697 - 363s - loss: 2.4721 - accuracy10: 0.6064 - val_loss: 2.6194 - val_accuracy10: 0.5749 - 363s/epoch - 54ms/step
Epoch 25/50
6697/6697 - 378s - loss: 2.4701 - accuracy10: 0.6068 - val_loss: 2.6198 - val_accuracy10: 0.5748 - 378s/epoch - 56ms/step
Epoch 26/50
6697/6697 - 394s - loss: 2.4682 - accuracy10: 0.6072 - val_loss: 2.6234 - val_accuracy10: 0.5747 - 394s/epoch - 59ms/step
Epoch 27/50
6697/6697 - 362s - loss: 2.4664 - accuracy10: 0.6073 - val_loss: 2.6222 - val_accuracy10: 0.5743 - 362s/epoch - 54ms/step
Epoch 28/50
6697/6697 - 361s - loss: 2.4645 - accuracy10: 0.6080 - val_loss: 2.6193 - val_accuracy10: 0.5736 - 361s/epoch - 54ms/step
Epoch 29/50
6697/6697 - 364s - loss: 2.4628 - accuracy10: 0.6082 - val_loss: 2.6111 - val_accuracy10: 0.5730 - 364s/epoch - 54ms/step
Epoch 30/50
6697/6697 - 367s - loss: 2.4611 - accuracy10: 0.6086 - val_loss: 2.6200 - val_accuracy10: 0.5753 - 367s/epoch - 55ms/step
Epoch 31/50
6697/6697 - 358s - loss: 2.4600 - accuracy10: 0.6087 - val_loss: 2.6260 - val_accuracy10: 0.5740 - 358s/epoch - 53ms/step
Epoch 32/50
6697/6697 - 360s - loss: 2.4581 - accuracy10: 0.6093 - val_loss: 2.6335 - val_accuracy10: 0.5756 - 360s/epoch - 54ms/step
Epoch 33/50
6697/6697 - 363s - loss: 2.4563 - accuracy10: 0.6096 - val_loss: 2.6335 - val_accuracy10: 0.5747 - 363s/epoch - 54ms/step
Epoch 34/50
6697/6697 - 363s - loss: 2.4547 - accuracy10: 0.6098 - val_loss: 2.6339 - val_accuracy10: 0.5751 - 363s/epoch - 54ms/step
Epoch 35/50
6697/6697 - 356s - loss: 2.4536 - accuracy10: 0.6100 - val_loss: 2.6116 - val_accuracy10: 0.5759 - 356s/epoch - 53ms/step
Epoch 36/50
6697/6697 - 356s - loss: 2.4522 - accuracy10: 0.6108 - val_loss: 2.6174 - val_accuracy10: 0.5749 - 356s/epoch - 53ms/step
Epoch 37/50
6697/6697 - 363s - loss: 2.4508 - accuracy10: 0.6112 - val_loss: 2.6086 - val_accuracy10: 0.5769 - 363s/epoch - 54ms/step
Epoch 38/50
6697/6697 - 358s - loss: 2.4492 - accuracy10: 0.6109 - val_loss: 2.6249 - val_accuracy10: 0.5762 - 358s/epoch - 53ms/step
Epoch 39/50
6697/6697 - 375s - loss: 2.4478 - accuracy10: 0.6114 - val_loss: 2.6221 - val_accuracy10: 0.5741 - 375s/epoch - 56ms/step
Epoch 40/50
6697/6697 - 358s - loss: 2.4467 - accuracy10: 0.6116 - val_loss: 2.6599 - val_accuracy10: 0.5709 - 358s/epoch - 53ms/step
Epoch 41/50
6697/6697 - 371s - loss: 2.4456 - accuracy10: 0.6117 - val_loss: 2.6448 - val_accuracy10: 0.5737 - 371s/epoch - 55ms/step
Epoch 42/50
6697/6697 - 363s - loss: 2.4447 - accuracy10: 0.6119 - val_loss: 2.6525 - val_accuracy10: 0.5718 - 363s/epoch - 54ms/step
Epoch 43/50
6697/6697 - 362s - loss: 2.4431 - accuracy10: 0.6120 - val_loss: 2.6534 - val_accuracy10: 0.5754 - 362s/epoch - 54ms/step
Epoch 44/50
6697/6697 - 384s - loss: 2.4415 - accuracy10: 0.6125 - val_loss: 2.6500 - val_accuracy10: 0.5764 - 384s/epoch - 57ms/step
Epoch 45/50
6697/6697 - 369s - loss: 2.4409 - accuracy10: 0.6125 - val_loss: 2.6628 - val_accuracy10: 0.5688 - 369s/epoch - 55ms/step
Epoch 46/50
6697/6697 - 378s - loss: 2.4402 - accuracy10: 0.6127 - val_loss: 2.6365 - val_accuracy10: 0.5733 - 378s/epoch - 56ms/step
Epoch 47/50
6697/6697 - 374s - loss: 2.4386 - accuracy10: 0.6130 - val_loss: 2.6590 - val_accuracy10: 0.5726 - 374s/epoch - 56ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 524s - 524s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9199915
{'0': {'precision': 0.4244847701141949, 'recall': 0.6095904870439217, 'f1-score': 0.5004701078870759, 'support': 1070540}, '1': {'precision': 0.8333703714314696, 'recall': 0.4956971176099693, 'f1-score': 0.6216377940567457, 'support': 2171219}, '2': {'precision': 0.42879080589724117, 'recall': 0.5948963212647652, 'f1-score': 0.4983672574404726, 'support': 1065937}, 'accuracy': 0.5485484583870357, 'macro avg': {'precision': 0.5622153158143018, 'recall': 0.5667279753062188, 'f1-score': 0.5401583864614313, 'support': 4307696}, 'weighted avg': {'precision': 0.6316419486316588, 'recall': 0.5485484583870357, 'f1-score': 0.5610222165551721, 'support': 4307696}}
[[ 652591  107187  310762]
 [ 560975 1076267  533977]
 [ 323806  108009  634122]]
Evaluating performance on  train set...
6697/6697 - 219s - 219s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8591684
{'0': {'precision': 0.4435128687222426, 'recall': 0.5771264207751298, 'f1-score': 0.5015738608679866, 'support': 416498}, '1': {'precision': 0.8592666122077296, 'recall': 0.584760340294454, 'f1-score': 0.6959219641816136, 'support': 877828}, '2': {'precision': 0.43864506473618264, 'recall': 0.6006090369067788, 'f1-score': 0.5070063028062423, 'support': 419679}, 'accuracy': 0.586785919527656, 'macro avg': {'precision': 0.5804748485553849, 'recall': 0.5874985993254542, 'f1-score': 0.5681673759519476, 'support': 1714005}, 'weighted avg': {'precision': 0.6552493350845415, 'recall': 0.586785919527656, 'f1-score': 0.6024394293090354, 'support': 1714005}}
[[240372  41761 134365]
 [176297 513319 188212]
 [125304  42312 252063]]
Evaluating performance on  val set...
2631/2631 - 78s - 78s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8721216
{'0': {'precision': 0.4291085500964464, 'recall': 0.5856441934130608, 'f1-score': 0.4953027864477548, 'support': 164477}, '1': {'precision': 0.8549752877337297, 'recall': 0.5693570939472579, 'f1-score': 0.6835290013505065, 'support': 347578}, '2': {'precision': 0.4335513790353437, 'recall': 0.5848345593950738, 'f1-score': 0.4979562662148568, 'support': 160813}, 'accuracy': 0.577037398122663, 'macro avg': {'precision': 0.5725450722885066, 'recall': 0.5799452822517974, 'f1-score': 0.558929351337706, 'support': 672868}, 'weighted avg': {'precision': 0.6501569185500546, 'recall': 0.577037398122663, 'f1-score': 0.5931674573271184, 'support': 672868}}
[[ 96325  17214  50938]
 [ 77742 197896  71940]
 [ 50410  16354  94049]]
testing model out of sample: results/universal/W9/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 275s - 275s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6834914
{'0': {'precision': 0.4305306829035339, 'recall': 0.5787443434699499, 'f1-score': 0.4937548059937236, 'support': 348933}, '1': {'precision': 0.8923500535725902, 'recall': 0.7505084164763195, 'f1-score': 0.8153060508363636, 'support': 1516965}, '2': {'precision': 0.4388236681569157, 'recall': 0.5925724312460549, 'f1-score': 0.5042384939764231, 'support': 345362}, 'accuracy': 0.6987373714533796, 'macro avg': {'precision': 0.5872348015443466, 'recall': 0.6406083970641081, 'f1-score': 0.6044331169355034, 'support': 2211260}, 'weighted avg': {'precision': 0.748642485043519, 'recall': 0.6987373714533796, 'f1-score': 0.7159822471728688, 'support': 2211260}}
[[ 201943   69866   77124]
 [ 193881 1138495  184589]
 [  73232   67478  204652]]
Evaluating performance on  train set...
3947/3947 - 127s - 127s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70504606
{'0': {'precision': 0.4491065826679616, 'recall': 0.5886083435182003, 'f1-score': 0.5094807350586101, 'support': 177551}, '1': {'precision': 0.8868357934247806, 'recall': 0.7470315983513373, 'f1-score': 0.8109524231548763, 'support': 655319}, '2': {'precision': 0.4558666571794507, 'recall': 0.5800982411662177, 'f1-score': 0.510533602940444, 'support': 176708}, 'accuracy': 0.6899516431617964, 'macro avg': {'precision': 0.5972696777573977, 'recall': 0.6385793943452517, 'f1-score': 0.6103222537179768, 'support': 1009578}, 'weighted avg': {'precision': 0.7344206722288712, 'recall': 0.6899516431617964, 'f1-score': 0.7053508662908876, 'support': 1009578}}
[[104508  30622  42421]
 [ 85840 489544  79935]
 [ 42354  31846 102508]]
Evaluating performance on  val set...
1402/1402 - 44s - 44s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6928444
{'0': {'precision': 0.4591112793523256, 'recall': 0.5879648453382541, 'f1-score': 0.5156096791667523, 'support': 63946}, '1': {'precision': 0.8893080394104984, 'recall': 0.7486136944769937, 'f1-score': 0.8129181793455766, 'support': 229567}, '2': {'precision': 0.4669378226495469, 'recall': 0.5994685535077013, 'f1-score': 0.5249678684975986, 'support': 64729}, 'accuracy': 0.6929896550376561, 'macro avg': {'precision': 0.6051190471374569, 'recall': 0.6453490311076497, 'f1-score': 0.6178319090033092, 'support': 358242}, 'weighted avg': {'precision': 0.736202139545604, 'recall': 0.6929896550376561, 'f1-score': 0.7078204380887897, 'support': 358242}}
[[ 37598  10610  15738]
 [ 29150 171857  28560]
 [ 15145  10781  38803]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1351645
{'0': {'precision': 0.3882574162947995, 'recall': 0.6471744011976048, 'f1-score': 0.48534390513445713, 'support': 21376}, '1': {'precision': 0.7548471290082028, 'recall': 0.13127776156664397, 'f1-score': 0.22365840859502306, 'support': 30843}, '2': {'precision': 0.4215654905610983, 'recall': 0.6259123299503347, 'f1-score': 0.5038064448847639, 'support': 23155}, 'accuracy': 0.4295380369888821, 'macro avg': {'precision': 0.5215566786213669, 'recall': 0.4681214975715278, 'f1-score': 0.40426958620474807, 'support': 75374}, 'weighted avg': {'precision': 0.5484980160885699, 'recall': 0.4295380369888821, 'f1-score': 0.3839340600705437, 'support': 75374}}
[[13834   662  6880]
 [13788  4049 13006]
 [ 8009   653 14493]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0779216
{'0': {'precision': 0.43332198940152655, 'recall': 0.6061615886833515, 'f1-score': 0.5053723811413829, 'support': 14704}, '1': {'precision': 0.7720558882235529, 'recall': 0.26224914120412224, 'f1-score': 0.39151118458787404, 'support': 22124}, '2': {'precision': 0.40347146886526364, 'recall': 0.6501643241731347, 'f1-score': 0.497938199539442, 'support': 14301}, 'accuracy': 0.46965518590232547, 'macro avg': {'precision': 0.536283115496781, 'recall': 0.5061916846868695, 'f1-score': 0.46494058842289965, 'support': 51129}, 'weighted avg': {'precision': 0.5715460204474968, 'recall': 0.46965518590232547, 'f1-score': 0.454024196282708, 'support': 51129}}
[[8913  911 4880]
 [7455 5802 8867]
 [4201  802 9298]]
Evaluating performance on  val set...
53/53 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0663534
{'0': {'precision': 0.40304659498207884, 'recall': 0.6175178473366282, 'f1-score': 0.48774669269139015, 'support': 3642}, '1': {'precision': 0.778921568627451, 'recall': 0.261865524060646, 'f1-score': 0.3919585594474593, 'support': 6068}, '2': {'precision': 0.42013651877133107, 'recall': 0.6530503978779841, 'f1-score': 0.5113187954309449, 'support': 3770}, 'accuracy': 0.46735905044510384, 'macro avg': {'precision': 0.5340348941269536, 'recall': 0.5108112564250861, 'f1-score': 0.46367468252326477, 'support': 13480}, 'weighted avg': {'precision': 0.577025701270328, 'recall': 0.46735905044510384, 'f1-score': 0.451220315451327, 'support': 13480}}
[[2249  251 1142]
 [2223 1589 2256]
 [1108  200 2462]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
1118/1118 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40891978
{'0': {'precision': 0.38542594816565295, 'recall': 0.5640662206599387, 'f1-score': 0.4579411290879381, 'support': 17638}, '1': {'precision': 0.9482785035506511, 'recall': 0.9151116048238218, 'f1-score': 0.9313998816503072, 'support': 250258}, '2': {'precision': 0.5082010722437497, 'recall': 0.5242867312852527, 'f1-score': 0.5161185983827493, 'support': 18261}, 'accuracy': 0.868533707020971, 'macro avg': {'precision': 0.6139685079866846, 'recall': 0.6678215189230045, 'f1-score': 0.6351532030403315, 'support': 286157}, 'weighted avg': {'precision': 0.8855023095558303, 'recall': 0.868533707020971, 'f1-score': 0.8757160542707779, 'support': 286157}}
[[  9949   6174   1515]
 [ 13494 229014   7750]
 [  2370   6317   9574]]
Evaluating performance on  train set...
505/505 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.41287288
{'0': {'precision': 0.4853719420868697, 'recall': 0.518617305025072, 'f1-score': 0.5014441922838869, 'support': 9373}, '1': {'precision': 0.9408431529468039, 'recall': 0.9245649717514124, 'f1-score': 0.9326330378961958, 'support': 110625}, '2': {'precision': 0.4699266037556, 'recall': 0.5347651589109448, 'f1-score': 0.5002536783358702, 'support': 9219}, 'accuracy': 0.8673084810822106, 'macro avg': {'precision': 0.6320472329297578, 'recall': 0.6593158118958097, 'f1-score': 0.6447769695053177, 'support': 129217}, 'weighted avg': {'precision': 0.8742070963413737, 'recall': 0.8673084810822106, 'f1-score': 0.8705077883879204, 'support': 129217}}
[[  4861   3231   1281]
 [  4065 102280   4280]
 [  1089   3200   4930]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40617862
{'0': {'precision': 0.4538212596465024, 'recall': 0.54926182585116, 'f1-score': 0.4970010905125409, 'support': 3319}, '1': {'precision': 0.9409840939497547, 'recall': 0.9264544456641054, 'f1-score': 0.9336627456764629, 'support': 40995}, '2': {'precision': 0.5372743156668608, 'recall': 0.5272935124321234, 'f1-score': 0.5322371267849415, 'support': 3499}, 'accuracy': 0.8710601719197708, 'macro avg': {'precision': 0.6440265564210392, 'recall': 0.6676699279824629, 'f1-score': 0.6543003209913151, 'support': 47813}, 'weighted avg': {'precision': 0.877623209644977, 'recall': 0.8710601719197708, 'f1-score': 0.8739746216518149, 'support': 47813}}
[[ 1823  1199   297]
 [ 1723 37980  1292]
 [  471  1183  1845]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98419505
{'0': {'precision': 0.46189306707464367, 'recall': 0.6014889768527014, 'f1-score': 0.5225282670826549, 'support': 38147}, '1': {'precision': 0.7403661256826398, 'recall': 0.3677082935401306, 'f1-score': 0.4913727091735157, 'support': 52354}, '2': {'precision': 0.44574666395969065, 'recall': 0.6136236597388078, 'f1-score': 0.5163835405552764, 'support': 39358}, 'accuracy': 0.5109156854742452, 'macro avg': {'precision': 0.5493352855723247, 'recall': 0.5276069767105466, 'f1-score': 0.510094838937149, 'support': 129859}, 'weighted avg': {'precision': 0.5692686696633339, 'recall': 0.5109156854742452, 'f1-score': 0.5081052218917967, 'support': 129859}}
[[22945  3420 11782]
 [14855 19251 18248]
 [11876  3331 24151]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0303919
{'0': {'precision': 0.46581520242357477, 'recall': 0.6072342144235516, 'f1-score': 0.5272057820810038, 'support': 22283}, '1': {'precision': 0.6622373300370828, 'recall': 0.2798989942966607, 'f1-score': 0.3934877742754843, 'support': 22969}, '2': {'precision': 0.4634051019683081, 'recall': 0.6024480369515012, 'f1-score': 0.5238573379387903, 'support': 21650}, 'accuracy': 0.4933036381573047, 'macro avg': {'precision': 0.5304858781429885, 'recall': 0.49652708189057115, 'f1-score': 0.48151696476509276, 'support': 66902}, 'weighted avg': {'precision': 0.5324715232256158, 'recall': 0.4933036381573047, 'f1-score': 0.48021372299511855, 'support': 66902}}
[[13531  1671  7081]
 [ 8518  6429  8022]
 [ 6999  1608 13043]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0169874
{'0': {'precision': 0.4977216964598668, 'recall': 0.6249083174416898, 'f1-score': 0.5541103017689907, 'support': 6817}, '1': {'precision': 0.617008069522036, 'recall': 0.19501667647635865, 'f1-score': 0.2963625521765057, 'support': 5097}, '2': {'precision': 0.4965818010372466, 'recall': 0.6250741839762611, 'f1-score': 0.5534682080924855, 'support': 6740}, 'accuracy': 0.5075050927415031, 'macro avg': {'precision': 0.5371038556730499, 'recall': 0.48166639263143657, 'f1-score': 0.46798035401266064, 'support': 18654}, 'weighted avg': {'precision': 0.5299035206449968, 'recall': 0.5075050927415031, 'f1-score': 0.48345156953716156, 'support': 18654}}
[[4260  305 2252]
 [2084  994 2019]
 [2215  312 4213]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
604/604 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2519771
{'0': {'precision': 0.39587041651833393, 'recall': 0.19107988391629754, 'f1-score': 0.25774881852247705, 'support': 52376}, '1': {'precision': 0.352938845071539, 'recall': 0.1655820007437709, 'f1-score': 0.22541165154219034, 'support': 53780}, '2': {'precision': 0.31717998075072185, 'recall': 0.6829202586206896, 'f1-score': 0.433173847892952, 'support': 48256}, 'accuracy': 0.33590653576146934, 'macro avg': {'precision': 0.3553297474468649, 'recall': 0.34652738109358605, 'f1-score': 0.3054447726525398, 'support': 154412}, 'weighted avg': {'precision': 0.35632591491994436, 'recall': 0.33590653576146934, 'f1-score': 0.30130901706340535, 'support': 154412}}
[[10008  8575 33793]
 [ 7723  8905 37152]
 [ 7550  7751 32955]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2088238
{'0': {'precision': 0.38214428058987643, 'recall': 0.1630057803468208, 'f1-score': 0.22853056846621378, 'support': 29410}, '1': {'precision': 0.3386064030131827, 'recall': 0.2080536912751678, 'f1-score': 0.2577408256880734, 'support': 25926}, '2': {'precision': 0.335801329394387, 'recall': 0.6662148796659219, 'f1-score': 0.4465313838863723, 'support': 27299}, 'accuracy': 0.3433775034791553, 'macro avg': {'precision': 0.35218400433248204, 'recall': 0.3457581170959701, 'f1-score': 0.3109342593468865, 'support': 82635}, 'weighted avg': {'precision': 0.3531749668760865, 'recall': 0.3433775034791553, 'f1-score': 0.3097129898238569, 'support': 82635}}
[[ 4794  5668 18948]
 [ 3507  5394 17025]
 [ 4244  4868 18187]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1822667
{'0': {'precision': 0.432258064516129, 'recall': 0.16600899330090851, 'f1-score': 0.2398886089378067, 'support': 10897}, '1': {'precision': 0.27440347071583515, 'recall': 0.20441691354699704, 'f1-score': 0.23429541595925296, 'support': 7426}, '2': {'precision': 0.36198514877931515, 'recall': 0.6700286759616335, 'f1-score': 0.4700332963374029, 'support': 10113}, 'accuracy': 0.35528907019271344, 'macro avg': {'precision': 0.35621556133709315, 'recall': 0.34681819426984634, 'f1-score': 0.31473910707815417, 'support': 28436}, 'weighted avg': {'precision': 0.3660427666399375, 'recall': 0.35528907019271344, 'f1-score': 0.32027678493349443, 'support': 28436}}
[[1809 2094 6994]
 [ 959 1518 4949]
 [1417 1920 6776]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0680112
{'0': {'precision': 0.5034782334980642, 'recall': 0.5230713888616371, 'f1-score': 0.513087829601591, 'support': 61158}, '1': {'precision': 0.5364114751315566, 'recall': 0.07907116404764288, 'f1-score': 0.13782575509759024, 'support': 39964}, '2': {'precision': 0.4542604947811796, 'recall': 0.6934669192170937, 'f1-score': 0.5489363101305363, 'support': 60186}, 'accuracy': 0.47664715947132197, 'macro avg': {'precision': 0.49805006780360017, 'recall': 0.4318698240421246, 'f1-score': 0.3999499649432392, 'support': 161308}, 'weighted avg': {'precision': 0.4932736884428064, 'recall': 0.47664715947132197, 'f1-score': 0.43349229251500654, 'support': 161308}}
[[31990  1534 27634]
 [14296  3160 22508]
 [17252  1197 41737]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0456693
{'0': {'precision': 0.4607673566553218, 'recall': 0.5971750186805506, 'f1-score': 0.5201772066851432, 'support': 41487}, '1': {'precision': 0.7143694441730976, 'recall': 0.1872919121036726, 'f1-score': 0.2967757644623907, 'support': 39046}, '2': {'precision': 0.45980146741476047, 'recall': 0.6433644137397941, 'f1-score': 0.5363108242803781, 'support': 41398}, 'accuracy': 0.4816002493213375, 'macro avg': {'precision': 0.5449794227477266, 'recall': 0.4759437815080057, 'f1-score': 0.451087931809304, 'support': 121931}, 'weighted avg': {'precision': 0.5416504891354812, 'recall': 0.4816002493213375, 'f1-score': 0.45411498123122207, 'support': 121931}}
[[24775  1425 15287]
 [15729  7313 16004]
 [13265  1499 26634]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0267913
{'0': {'precision': 0.4639912585675971, 'recall': 0.5961710274409701, 'f1-score': 0.5218411350687076, 'support': 15670}, '1': {'precision': 0.7409133271202236, 'recall': 0.251232461130072, 'f1-score': 0.3752300939255203, 'support': 15822}, '2': {'precision': 0.45990830838323354, 'recall': 0.6390821036208801, 'f1-score': 0.5348894148371828, 'support': 15383}, 'accuracy': 0.493824, 'macro avg': {'precision': 0.5549376313570181, 'recall': 0.4954951973973074, 'f1-score': 0.4773202146104702, 'support': 46875}, 'weighted avg': {'precision': 0.556122521414607, 'recall': 0.493824, 'f1-score': 0.47663669335587444, 'support': 46875}}
[[9342  700 5628]
 [5930 3975 5917]
 [4862  690 9831]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.42567134
{'0': {'precision': 0.4630345894573986, 'recall': 0.5526367852981908, 'f1-score': 0.5038833492007817, 'support': 45491}, '1': {'precision': 0.9380221942643311, 'recall': 0.9069808698161061, 'f1-score': 0.9222404040664339, 'support': 512959}, '2': {'precision': 0.44528251189927837, 'recall': 0.5281116270600018, 'f1-score': 0.48317297680036647, 'support': 43932}, 'accuracy': 0.8525902168391486, 'macro avg': {'precision': 0.6154464318736693, 'recall': 0.662576427391433, 'f1-score': 0.6364322433558608, 'support': 602382}, 'weighted avg': {'precision': 0.8662160963797102, 'recall': 0.8525902168391486, 'f1-score': 0.858625304349732, 'support': 602382}}
[[ 25140  15863   4488]
 [ 23300 465244  24415]
 [  5854  14877  23201]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.40664288
{'0': {'precision': 0.4646549103070842, 'recall': 0.5475881220047476, 'f1-score': 0.5027241514011389, 'support': 22327}, '1': {'precision': 0.9407883299950871, 'recall': 0.9064467383982376, 'f1-score': 0.9232983152370443, 'support': 274635}, '2': {'precision': 0.44053820941866484, 'recall': 0.5565046851165831, 'f1-score': 0.49177739264394377, 'support': 22945}, 'accuracy': 0.8563019877651943, 'macro avg': {'precision': 0.6153271499069454, 'recall': 0.6701798485065229, 'f1-score': 0.639266619760709, 'support': 319907}, 'weighted avg': {'precision': 0.8716780264443676, 'recall': 0.8563019877651943, 'f1-score': 0.8629951429874126, 'support': 319907}}
[[ 12226   7854   2247]
 [ 11724 248942  13969]
 [  2362   7814  12769]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43136236
{'0': {'precision': 0.43067263031137104, 'recall': 0.5414143598615917, 'f1-score': 0.4797355561943087, 'support': 9248}, '1': {'precision': 0.9408244487697179, 'recall': 0.8984381501928038, 'f1-score': 0.9191428976869589, 'support': 108141}, '2': {'precision': 0.43253155919481406, 'recall': 0.5494041170097508, 'f1-score': 0.4840125990264389, 'support': 9230}, 'accuracy': 0.8469187088825532, 'macro avg': {'precision': 0.601342879425301, 'recall': 0.6630855423547154, 'f1-score': 0.6276303509692355, 'support': 126619}, 'weighted avg': {'precision': 0.8665115305830384, 'recall': 0.8469187088825532, 'f1-score': 0.8553302649007212, 'support': 126619}}
[[ 5007  2971  1270]
 [ 5600 97158  5383]
 [ 1019  3140  5071]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
3870/3870 - 56s - 56s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48321322
{'0': {'precision': 0.4386621179474902, 'recall': 0.5219770436929505, 'f1-score': 0.4767066858180439, 'support': 84247}, '1': {'precision': 0.9256503659703527, 'recall': 0.891724204762943, 'f1-score': 0.9083706240595055, 'support': 825540}, '2': {'precision': 0.4415816406947787, 'recall': 0.5193854976455612, 'f1-score': 0.47733390883585686, 'support': 80911}, 'accuracy': 0.8298724737508302, 'macro avg': {'precision': 0.6019647082042071, 'recall': 0.6443622487004849, 'f1-score': 0.6208037395711353, 'support': 990698}, 'weighted avg': {'precision': 0.8447036157377348, 'recall': 0.8298724737508302, 'f1-score': 0.8364597052219899, 'support': 990698}}
[[ 43975  31277   8995]
 [ 45238 736154  44148]
 [ 11035  27852  42024]]
Evaluating performance on  train set...
1577/1577 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.43195444
{'0': {'precision': 0.4415380806997277, 'recall': 0.5466153636611277, 'f1-score': 0.48848992012171927, 'support': 29368}, '1': {'precision': 0.9360629017515109, 'recall': 0.9153196880640533, 'f1-score': 0.925575089614384, 'support': 345712}, '2': {'precision': 0.4832313930314068, 'recall': 0.4946535349982413, 'f1-score': 0.4888757561009525, 'support': 28430}, 'accuracy': 0.8588461252509232, 'macro avg': {'precision': 0.6202774584942151, 'recall': 0.6521961955744741, 'f1-score': 0.6343135886123519, 'support': 403510}, 'weighted avg': {'precision': 0.8681656879586401, 'recall': 0.8588461252509232, 'f1-score': 0.8629950313520176, 'support': 403510}}
[[ 16053  10810   2505]
 [ 16741 316437  12534]
 [  3563  10804  14063]]
Evaluating performance on  val set...
600/600 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4018189
{'0': {'precision': 0.443716268311488, 'recall': 0.5576550387596899, 'f1-score': 0.49420352082438807, 'support': 10320}, '1': {'precision': 0.943377619716888, 'recall': 0.9168716888291851, 'f1-score': 0.9299358181936476, 'support': 132506}, '2': {'precision': 0.48978370522356157, 'recall': 0.5392507530120482, 'f1-score': 0.5133282559025134, 'support': 10624}, 'accuracy': 0.8665689149560117, 'macro avg': {'precision': 0.6256258644173126, 'recall': 0.6712591602003077, 'f1-score': 0.645822531640183, 'support': 153450}, 'weighted avg': {'precision': 0.8783695591494013, 'recall': 0.8665689149560117, 'f1-score': 0.8717879130086897, 'support': 153450}}
[[  5755   3585    980]
 [  6027 121491   4988]
 [  1188   3707   5729]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8481468
{'0': {'precision': 0.439657132085096, 'recall': 0.5970350404312669, 'f1-score': 0.5064004930087904, 'support': 132818}, '1': {'precision': 0.7770166500085323, 'recall': 0.6076860224425319, 'f1-score': 0.6819979000683166, 'support': 367160}, '2': {'precision': 0.44275587644604053, 'recall': 0.5556323264998468, 'f1-score': 0.49281327037981026, 'support': 127363}, 'accuracy': 0.5948630808443892, 'macro avg': {'precision': 0.553143219513223, 'recall': 0.5867844631245486, 'f1-score': 0.5604038878189724, 'support': 627341}, 'weighted avg': {'precision': 0.6377305657978803, 'recall': 0.5948630808443892, 'f1-score': 0.6064128220934204, 'support': 627341}}
[[ 79297  31973  21548]
 [ 76524 223118  67518]
 [ 24540  32056  70767]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8150399
{'0': {'precision': 0.4577329320823745, 'recall': 0.5993911202460245, 'f1-score': 0.519070688686063, 'support': 64709}, '1': {'precision': 0.8039733513620102, 'recall': 0.6409074577260785, 'f1-score': 0.7132387854554543, 'support': 178124}, '2': {'precision': 0.45909085252796755, 'recall': 0.5741296938950186, 'f1-score': 0.510206057253492, 'support': 64259}, 'accuracy': 0.6181860810441171, 'macro avg': {'precision': 0.5735990453241174, 'recall': 0.6048094239557072, 'f1-score': 0.5808385104650031, 'support': 307092}, 'weighted avg': {'precision': 0.6588485165120541, 'recall': 0.6181860810441171, 'f1-score': 0.6298399881719678, 'support': 307092}}
[[ 38786  13346  12577]
 [ 33072 114161  30891]
 [ 12877  14489  36893]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80499685
{'0': {'precision': 0.4577308289445645, 'recall': 0.6068041486742807, 'f1-score': 0.521829666134518, 'support': 24779}, '1': {'precision': 0.8080209880591832, 'recall': 0.6513193699367138, 'f1-score': 0.7212569952647438, 'support': 64311}, '2': {'precision': 0.48138772017399983, 'recall': 0.5710116731517509, 'f1-score': 0.5223834397368929, 'support': 23644}, 'accuracy': 0.6246917522663971, 'macro avg': {'precision': 0.5823798457259158, 'recall': 0.6097117305875818, 'f1-score': 0.5884900337120517, 'support': 112734}, 'weighted avg': {'precision': 0.6625213443085985, 'recall': 0.6246917522663971, 'f1-score': 0.635712473333309, 'support': 112734}}
[[15036  5133  4610]
 [12489 41887  9935]
 [ 5324  4819 13501]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
3337/3337 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7574423
{'0': {'precision': 0.4054298354788012, 'recall': 0.6198187562931843, 'f1-score': 0.4902089471906501, 'support': 144005}, '1': {'precision': 0.8483322801949811, 'recall': 0.6615111990201737, 'f1-score': 0.7433635493541525, 'support': 568264}, '2': {'precision': 0.4311627443681945, 'recall': 0.5801893447711496, 'f1-score': 0.49469622465029967, 'support': 141752}, 'accuracy': 0.640983067161112, 'macro avg': {'precision': 0.5616416200139922, 'recall': 0.6205064333615026, 'f1-score': 0.5760895737317008, 'support': 854021}, 'weighted avg': {'precision': 0.7044075024742082, 'recall': 0.640983067161112, 'f1-score': 0.6594023597628242, 'support': 854021}}
[[ 89257  32887  21861]
 [105708 375913  86643]
 [ 25189  34320  82243]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7808494
{'0': {'precision': 0.4424782543651557, 'recall': 0.5940122509288615, 'f1-score': 0.507168184406979, 'support': 69709}, '1': {'precision': 0.8236074341776706, 'recall': 0.6802428726027641, 'f1-score': 0.7450915618342973, 'support': 225468}, '2': {'precision': 0.4567743879123553, 'recall': 0.5557811332459219, 'f1-score': 0.5014373664394016, 'support': 70929}, 'accuracy': 0.6397109033995618, 'macro avg': {'precision': 0.5742866921517272, 'recall': 0.6100120855925159, 'f1-score': 0.5845657042268927, 'support': 366106}, 'weighted avg': {'precision': 0.6799680643391453, 'recall': 0.6397109033995618, 'f1-score': 0.6525840663487125, 'support': 366106}}
[[ 41408  15696  12605]
 [ 37818 153373  34277]
 [ 14356  17152  39421]]
Evaluating performance on  val set...
492/492 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83508694
{'0': {'precision': 0.45998670558654375, 'recall': 0.5788267811033931, 'f1-score': 0.5126091017424071, 'support': 27497}, '1': {'precision': 0.7888282886657516, 'recall': 0.6233267688443646, 'f1-score': 0.6963793185912664, 'support': 70074}, '2': {'precision': 0.4649259983244904, 'recall': 0.5901389479654048, 'f1-score': 0.5201024647777327, 'support': 28212}, 'accuracy': 0.6061550447993767, 'macro avg': {'precision': 0.5712469975255953, 'recall': 0.5974308326377208, 'f1-score': 0.5763636283704687, 'support': 125783}, 'weighted avg': {'precision': 0.6442929506229585, 'recall': 0.6061550447993767, 'f1-score': 0.6166686084596866, 'support': 125783}}
[[15916  5807  5774]
 [13008 43679 13387]
 [ 5677  5886 16649]]
testing model on single stock: results/universal/W9/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
10303/10303 - 172s - 172s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0859252
{'0': {'precision': 0.4221142312355005, 'recall': 0.6424192153652868, 'f1-score': 0.5094706870709061, 'support': 822217}, '1': {'precision': 0.6207003383137188, 'recall': 0.15223055897197946, 'f1-score': 0.244496784350097, 'support': 987062}, '2': {'precision': 0.43510474815163175, 'recall': 0.6010590188679246, 'f1-score': 0.5047920827825265, 'support': 828125}, 'accuracy': 0.44597680143049756, 'macro avg': {'precision': 0.4926397725669503, 'recall': 0.46523626440173027, 'f1-score': 0.41958651806784325, 'support': 2637404}, 'weighted avg': {'precision': 0.5005150268079693, 'recall': 0.44597680143049756, 'f1-score': 0.40883379581582285, 'support': 2637404}}
[[528208  44796 249213]
 [439784 150261 397017]
 [283347  47026 497752]]
Evaluating performance on  train set...
3419/3419 - 57s - 57s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0731231
{'0': {'precision': 0.43963747495039013, 'recall': 0.6181217081385308, 'f1-score': 0.5138210498621611, 'support': 290679}, '1': {'precision': 0.644447467464744, 'recall': 0.14777587533533437, 'f1-score': 0.240421566664881, 'support': 288518}, '2': {'precision': 0.4479223394103511, 'recall': 0.6058515257283997, 'f1-score': 0.5150525017127149, 'support': 295957}, 'accuracy': 0.4589100889671989, 'macro avg': {'precision': 0.5106690939418285, 'recall': 0.45724970306742163, 'f1-score': 0.42309837274658574, 'support': 875154}, 'weighted avg': {'precision': 0.5099603358997007, 'recall': 0.4589100889671989, 'f1-score': 0.42410402257578805, 'support': 875154}}
[[179675  11699  99305]
 [124187  42636 121695]
 [104827  11824 179306]]
Evaluating performance on  val set...
1396/1396 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0872034
{'0': {'precision': 0.4229041741524534, 'recall': 0.6237503656417227, 'f1-score': 0.5040567316717071, 'support': 116234}, '1': {'precision': 0.6362220563901236, 'recall': 0.15476105915315103, 'f1-score': 0.24896207610172288, 'support': 126705}, '2': {'precision': 0.4307427310672284, 'recall': 0.5840177735792945, 'f1-score': 0.4958044969851784, 'support': 114327}, 'accuracy': 0.4447078647282417, 'macro avg': {'precision': 0.49662298720326853, 'recall': 0.45417639945805605, 'f1-score': 0.41627443491953614, 'support': 357266}, 'weighted avg': {'precision': 0.5010661066210329, 'recall': 0.4447078647282417, 'f1-score': 0.41094621578438045, 'support': 357266}}
[[72501  5828 37905]
 [56761 19609 50335]
 [42174  5384 66769]]
training model: results/universal/W9/deepVOL_L3/h20
Epoch 1/50
6697/6697 - 380s - loss: 2.8217 - accuracy20: 0.5225 - val_loss: 2.9098 - val_accuracy20: 0.5010 - 380s/epoch - 57ms/step
Epoch 2/50
6697/6697 - 381s - loss: 2.7179 - accuracy20: 0.5503 - val_loss: 2.9084 - val_accuracy20: 0.5202 - 381s/epoch - 57ms/step
Epoch 3/50
6697/6697 - 382s - loss: 2.6887 - accuracy20: 0.5564 - val_loss: 2.9250 - val_accuracy20: 0.5117 - 382s/epoch - 57ms/step
Epoch 4/50
6697/6697 - 388s - loss: 2.6720 - accuracy20: 0.5598 - val_loss: 2.8703 - val_accuracy20: 0.5277 - 388s/epoch - 58ms/step
Epoch 5/50
6697/6697 - 388s - loss: 2.6601 - accuracy20: 0.5626 - val_loss: 2.8457 - val_accuracy20: 0.5335 - 388s/epoch - 58ms/step
Epoch 6/50
6697/6697 - 374s - loss: 2.6527 - accuracy20: 0.5641 - val_loss: 2.8469 - val_accuracy20: 0.5319 - 374s/epoch - 56ms/step
Epoch 7/50
6697/6697 - 391s - loss: 2.6438 - accuracy20: 0.5665 - val_loss: 2.8812 - val_accuracy20: 0.5321 - 391s/epoch - 58ms/step
Epoch 8/50
6697/6697 - 400s - loss: 2.6375 - accuracy20: 0.5677 - val_loss: 2.8334 - val_accuracy20: 0.5338 - 400s/epoch - 60ms/step
Epoch 9/50
6697/6697 - 390s - loss: 2.6313 - accuracy20: 0.5687 - val_loss: 2.8369 - val_accuracy20: 0.5361 - 390s/epoch - 58ms/step
Epoch 10/50
6697/6697 - 391s - loss: 2.6259 - accuracy20: 0.5702 - val_loss: 2.8316 - val_accuracy20: 0.5331 - 391s/epoch - 58ms/step
Epoch 11/50
6697/6697 - 387s - loss: 2.6221 - accuracy20: 0.5709 - val_loss: 2.8222 - val_accuracy20: 0.5313 - 387s/epoch - 58ms/step
Epoch 12/50
6697/6697 - 380s - loss: 2.6181 - accuracy20: 0.5715 - val_loss: 2.8100 - val_accuracy20: 0.5360 - 380s/epoch - 57ms/step
Epoch 13/50
6697/6697 - 376s - loss: 2.6147 - accuracy20: 0.5722 - val_loss: 2.8141 - val_accuracy20: 0.5339 - 376s/epoch - 56ms/step
Epoch 14/50
6697/6697 - 381s - loss: 2.6105 - accuracy20: 0.5726 - val_loss: 2.8383 - val_accuracy20: 0.5310 - 381s/epoch - 57ms/step
Epoch 15/50
6697/6697 - 365s - loss: 2.6081 - accuracy20: 0.5732 - val_loss: 2.8293 - val_accuracy20: 0.5297 - 365s/epoch - 55ms/step
Epoch 16/50
6697/6697 - 380s - loss: 2.6060 - accuracy20: 0.5735 - val_loss: 2.8099 - val_accuracy20: 0.5307 - 380s/epoch - 57ms/step
Epoch 17/50
6697/6697 - 388s - loss: 2.6030 - accuracy20: 0.5740 - val_loss: 2.7978 - val_accuracy20: 0.5314 - 388s/epoch - 58ms/step
Epoch 18/50
6697/6697 - 381s - loss: 2.6003 - accuracy20: 0.5746 - val_loss: 2.7949 - val_accuracy20: 0.5326 - 381s/epoch - 57ms/step
Epoch 19/50
6697/6697 - 379s - loss: 2.5979 - accuracy20: 0.5751 - val_loss: 2.8057 - val_accuracy20: 0.5344 - 379s/epoch - 57ms/step
Epoch 20/50
6697/6697 - 393s - loss: 2.5959 - accuracy20: 0.5755 - val_loss: 2.7923 - val_accuracy20: 0.5374 - 393s/epoch - 59ms/step
Epoch 21/50
6697/6697 - 385s - loss: 2.5935 - accuracy20: 0.5762 - val_loss: 2.7968 - val_accuracy20: 0.5374 - 385s/epoch - 58ms/step
Epoch 22/50
6697/6697 - 388s - loss: 2.5923 - accuracy20: 0.5761 - val_loss: 2.7843 - val_accuracy20: 0.5342 - 388s/epoch - 58ms/step
Epoch 23/50
6697/6697 - 392s - loss: 2.5900 - accuracy20: 0.5767 - val_loss: 2.7990 - val_accuracy20: 0.5341 - 392s/epoch - 59ms/step
Epoch 24/50
6697/6697 - 394s - loss: 2.5877 - accuracy20: 0.5773 - val_loss: 2.7945 - val_accuracy20: 0.5351 - 394s/epoch - 59ms/step
Epoch 25/50
6697/6697 - 393s - loss: 2.5862 - accuracy20: 0.5777 - val_loss: 2.7915 - val_accuracy20: 0.5370 - 393s/epoch - 59ms/step
Epoch 26/50
6697/6697 - 397s - loss: 2.5844 - accuracy20: 0.5779 - val_loss: 2.7996 - val_accuracy20: 0.5341 - 397s/epoch - 59ms/step
Epoch 27/50
6697/6697 - 386s - loss: 2.5826 - accuracy20: 0.5785 - val_loss: 2.8188 - val_accuracy20: 0.5315 - 386s/epoch - 58ms/step
Epoch 28/50
6697/6697 - 389s - loss: 2.5814 - accuracy20: 0.5786 - val_loss: 2.8119 - val_accuracy20: 0.5342 - 389s/epoch - 58ms/step
Epoch 29/50
6697/6697 - 399s - loss: 2.5798 - accuracy20: 0.5789 - val_loss: 2.8087 - val_accuracy20: 0.5358 - 399s/epoch - 60ms/step
Epoch 30/50
6697/6697 - 390s - loss: 2.5781 - accuracy20: 0.5792 - val_loss: 2.8106 - val_accuracy20: 0.5357 - 390s/epoch - 58ms/step
Epoch 31/50
6697/6697 - 391s - loss: 2.5773 - accuracy20: 0.5792 - val_loss: 2.8107 - val_accuracy20: 0.5331 - 391s/epoch - 58ms/step
Epoch 32/50
6697/6697 - 402s - loss: 2.5757 - accuracy20: 0.5797 - val_loss: 2.8003 - val_accuracy20: 0.5359 - 402s/epoch - 60ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 522s - 522s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0068902
{'0': {'precision': 0.40877992606199604, 'recall': 0.5915337351287085, 'f1-score': 0.483462589566675, 'support': 1141377}, '1': {'precision': 0.8102698007030217, 'recall': 0.39676859175009366, 'f1-score': 0.5326916024753612, 'support': 2026423}, '2': {'precision': 0.41392477493667934, 'recall': 0.6041507295402387, 'f1-score': 0.4912660282132221, 'support': 1139896}, 'accuracy': 0.5032511579275789, 'macro avg': {'precision': 0.5443248339005656, 'recall': 0.5308176854730137, 'f1-score': 0.5024734067517528, 'support': 4307696}, 'weighted avg': {'precision': 0.5990099025720717, 'recall': 0.5032511579275789, 'f1-score': 0.5086857976400634, 'support': 4307696}}
[[675163  90069 376145]
 [623462 804021 598940]
 [353029  98198 688669]]
Evaluating performance on  train set...
6697/6697 - 216s - 216s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9471742
{'0': {'precision': 0.42447289234491814, 'recall': 0.554741714247103, 'f1-score': 0.4809422130055154, 'support': 443985}, '1': {'precision': 0.829072351132801, 'recall': 0.4979245577345871, 'f1-score': 0.6221800231925461, 'support': 820548}, '2': {'precision': 0.43075521329010635, 'recall': 0.6142674070909867, 'f1-score': 0.5063983932943884, 'support': 449472}, 'accuracy': 0.5431512743545089, 'macro avg': {'precision': 0.5614334855892752, 'recall': 0.5556445596908922, 'f1-score': 0.5365068764974833, 'support': 1714005}, 'weighted avg': {'precision': 0.6198147986225283, 'recall': 0.5431512743545089, 'f1-score': 0.5552326864522952, 'support': 1714005}}
[[246297  41124 156564]
 [203679 408571 208298]
 [130266  43110 276096]]
Evaluating performance on  val set...
2631/2631 - 78s - 78s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9582341
{'0': {'precision': 0.41586047533420667, 'recall': 0.5766336477277856, 'f1-score': 0.48322531542646985, 'support': 177272}, '1': {'precision': 0.8279691955125643, 'recall': 0.4819138079181569, 'f1-score': 0.6092296591426016, 'support': 322373}, '2': {'precision': 0.42665196489953094, 'recall': 0.5897138370770625, 'f1-score': 0.4951023870107839, 'support': 173223}, 'accuracy': 0.5346204604766462, 'macro avg': {'precision': 0.5568272119154339, 'recall': 0.5494204309076683, 'f1-score': 0.5291857871932851, 'support': 672868}, 'weighted avg': {'precision': 0.6160811109522355, 'recall': 0.5346204604766462, 'f1-score': 0.5466519908930549, 'support': 672868}}
[[102221  15780  59271]
 [ 89013 155356  78004]
 [ 54572  16499 102152]]
testing model out of sample: results/universal/W9/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 277s - 277s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.798998
{'0': {'precision': 0.4307905841869588, 'recall': 0.5970332466384164, 'f1-score': 0.5004676742936837, 'support': 425246}, '1': {'precision': 0.8598711887122594, 'recall': 0.6591489003611192, 'f1-score': 0.7462483907472731, 'support': 1366585}, '2': {'precision': 0.44328715795045376, 'recall': 0.6070014233636682, 'f1-score': 0.5123847685711151, 'support': 419429}, 'accuracy': 0.6373122111375414, 'macro avg': {'precision': 0.5779829769498906, 'recall': 0.621061190121068, 'f1-score': 0.5863669445373573, 'support': 2211260}, 'weighted avg': {'precision': 0.6983378393140162, 'recall': 0.6373122111375414, 'f1-score': 0.6546235018899036, 'support': 2211260}}
[[253886  73057  98303]
 [244367 900783 221435]
 [ 91096  73739 254594]]
Evaluating performance on  train set...
3947/3947 - 120s - 120s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8149142
{'0': {'precision': 0.4321926444586894, 'recall': 0.5892870006194983, 'f1-score': 0.4986599750078735, 'support': 208233}, '1': {'precision': 0.856288523546741, 'recall': 0.6533188996691723, 'f1-score': 0.7411588832958249, 'support': 593058}, '2': {'precision': 0.4551291672310221, 'recall': 0.5969119532183957, 'f1-score': 0.5164665808166825, 'support': 208287}, 'accuracy': 0.6284744715118594, 'macro avg': {'precision': 0.5812034450788175, 'recall': 0.6131726178356888, 'f1-score': 0.5854284797067937, 'support': 1009578}, 'weighted avg': {'precision': 0.6860520128075267, 'recall': 0.6284744715118594, 'f1-score': 0.6447851897565461, 'support': 1009578}}
[[122709  30746  54778]
 [111536 387456  94066]
 [ 49677  34281 124329]]
Evaluating performance on  val set...
1402/1402 - 40s - 40s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8001653
{'0': {'precision': 0.44744081959471943, 'recall': 0.5825581395348837, 'f1-score': 0.5061369996632488, 'support': 74820}, '1': {'precision': 0.8623950502629234, 'recall': 0.6611933261488723, 'f1-score': 0.7485090600133981, 'support': 207856}, '2': {'precision': 0.46214495496028224, 'recall': 0.6205436307333986, 'f1-score': 0.5297573320077725, 'support': 75566}, 'accuracy': 0.6361956442851481, 'macro avg': {'precision': 0.5906602749393084, 'recall': 0.6214316988057181, 'f1-score': 0.5948011305614731, 'support': 358242}, 'weighted avg': {'precision': 0.6913035137031833, 'recall': 0.6361956442851481, 'f1-score': 0.6517463391881703, 'support': 358242}}
[[ 43587  10694  20539]
 [ 36388 137433  34035]
 [ 17439  11235  46892]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1068343
{'0': {'precision': 0.4087027864717858, 'recall': 0.5569819446745072, 'f1-score': 0.4714583661952083, 'support': 24148}, '1': {'precision': 0.6310096153846154, 'recall': 0.08523765068798961, 'f1-score': 0.15018773466833543, 'support': 24637}, '2': {'precision': 0.44548636839819095, 'recall': 0.6557222911730415, 'f1-score': 0.5305358609986915, 'support': 26589}, 'accuracy': 0.4376177461724202, 'macro avg': {'precision': 0.4950662567515307, 'recall': 0.4326472955118461, 'f1-score': 0.38406065395407846, 'support': 75374}, 'weighted avg': {'precision': 0.4943425562036106, 'recall': 0.4376177461724202, 'f1-score': 0.387286993578686, 'support': 75374}}
[[13450   595 10103]
 [10938  2100 11599]
 [ 8521   633 17435]]
Evaluating performance on  train set...
200/200 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0669107
{'0': {'precision': 0.45150671055963537, 'recall': 0.5309708159618821, 'f1-score': 0.48802518133296835, 'support': 16790}, '1': {'precision': 0.6683375104427736, 'recall': 0.22419011321600718, 'f1-score': 0.33575355688924335, 'support': 17842}, '2': {'precision': 0.4222213472971377, 'recall': 0.650057586227799, 'f1-score': 0.5119343135382852, 'support': 16497}, 'accuracy': 0.46234035478886737, 'macro avg': {'precision': 0.5140218560998489, 'recall': 0.46840617180189614, 'f1-score': 0.44523768392016566, 'support': 51129}, 'weighted avg': {'precision': 0.5177230358109317, 'recall': 0.46234035478886737, 'f1-score': 0.44260279150852766, 'support': 51129}}
[[ 8915  1053  6822]
 [ 5989  4000  7853]
 [ 4841   932 10724]]
Evaluating performance on  val set...
53/53 - 1s - 911ms/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0631006
{'0': {'precision': 0.43608736942070275, 'recall': 0.5456273764258555, 'f1-score': 0.484746120553151, 'support': 4208}, '1': {'precision': 0.6935294117647058, 'recall': 0.23650952858575727, 'f1-score': 0.3527299925205684, 'support': 4985}, '2': {'precision': 0.4283960092095165, 'recall': 0.6510380219267553, 'f1-score': 0.5167561562673578, 'support': 4287}, 'accuracy': 0.46483679525222554, 'macro avg': {'precision': 0.5193375967983084, 'recall': 0.47772497564612265, 'f1-score': 0.4514107564470257, 'support': 13480}, 'weighted avg': {'precision': 0.5288452121402503, 'recall': 0.46483679525222554, 'f1-score': 0.44610566245703676, 'support': 13480}}
[[2296  300 1612]
 [1694 1179 2112]
 [1275  221 2791]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5903491
{'0': {'precision': 0.2852398588145289, 'recall': 0.6761881208523969, 'f1-score': 0.40122777410913, 'support': 24261}, '1': {'precision': 0.9207589340178315, 'recall': 0.7970303721539307, 'f1-score': 0.8544387058501208, 'support': 236730}, '2': {'precision': 0.5373234984193889, 'recall': 0.5065564650719224, 'f1-score': 0.5214865721707472, 'support': 25166}, 'accuracy': 0.7612394594575705, 'macro avg': {'precision': 0.5811074304172498, 'recall': 0.6599249860260833, 'f1-score': 0.5923843507099993, 'support': 286157}, 'weighted avg': {'precision': 0.8331571473909878, 'recall': 0.7612394594575705, 'f1-score': 0.7867331322973393, 'support': 286157}}
[[ 16405   6663   1193]
 [ 38265 188681   9784]
 [  2843   9575  12748]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56031924
{'0': {'precision': 0.41844129780354555, 'recall': 0.5839427415590478, 'f1-score': 0.4875292283710055, 'support': 12854}, '1': {'precision': 0.9111449188955819, 'recall': 0.8544986551754056, 'f1-score': 0.8819131100973568, 'support': 103731}, '2': {'precision': 0.4928198899764235, 'recall': 0.5460734642178594, 'f1-score': 0.5180817905291224, 'support': 12632}, 'accuracy': 0.797433774193798, 'macro avg': {'precision': 0.6074687022251837, 'recall': 0.661504953650771, 'f1-score': 0.6291747096658282, 'support': 129217}, 'weighted avg': {'precision': 0.8212380636766566, 'recall': 0.797433774193798, 'f1-score': 0.8071139146006616, 'support': 129217}}
[[ 7506  4099  1249]
 [ 9243 88638  5850]
 [ 1189  4545  6898]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5690399
{'0': {'precision': 0.3691931540342298, 'recall': 0.620995670995671, 'f1-score': 0.4630780405132757, 'support': 4620}, '1': {'precision': 0.9096669283391275, 'recall': 0.8449479166666667, 'f1-score': 0.8761138413349894, 'support': 38400}, '2': {'precision': 0.5738454503886603, 'recall': 0.5236803672021698, 'f1-score': 0.5476164503108978, 'support': 4793}, 'accuracy': 0.7911028381402547, 'macro avg': {'precision': 0.6175685109206726, 'recall': 0.6632079849548358, 'f1-score': 0.628936110719721, 'support': 47813}, 'weighted avg': {'precision': 0.8237785469134646, 'recall': 0.7911028381402547, 'f1-score': 0.8032735385935846, 'support': 47813}}
[[ 2869  1492   259]
 [ 4349 32446  1605]
 [  553  1730  2510]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
508/508 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0515194
{'0': {'precision': 0.4523411371237458, 'recall': 0.5338815789473684, 'f1-score': 0.48974049487024746, 'support': 39520}, '1': {'precision': 0.6928850503804236, 'recall': 0.2694845443275883, 'f1-score': 0.3880459505369533, 'support': 50014}, '2': {'precision': 0.41423709674889825, 'recall': 0.6550030998140112, 'f1-score': 0.507512873722235, 'support': 40325}, 'accuracy': 0.46966325014053706, 'macro avg': {'precision': 0.5198210947510226, 'recall': 0.48612307436298935, 'f1-score': 0.46176643970981185, 'support': 129859}, 'weighted avg': {'precision': 0.533152000055878, 'recall': 0.46966325014053706, 'f1-score': 0.4560926170714119, 'support': 129859}}
[[21099  3068 15353]
 [14539 13478 21997]
 [11006  2906 26413]]
Evaluating performance on  train set...
262/262 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0781543
{'0': {'precision': 0.45339532871972316, 'recall': 0.55093728100911, 'f1-score': 0.49742961088263205, 'support': 22832}, '1': {'precision': 0.6116291826659352, 'recall': 0.20551101280987927, 'f1-score': 0.3076498585914327, 'support': 21702}, '2': {'precision': 0.44153643381660707, 'recall': 0.6290236051502146, 'f1-score': 0.5188627060515544, 'support': 22368}, 'accuracy': 0.4649935726884099, 'macro avg': {'precision': 0.5021869817340885, 'recall': 0.46182396632306794, 'f1-score': 0.4413140585085397, 'support': 66902}, 'weighted avg': {'precision': 0.5007591046479135, 'recall': 0.4649935726884099, 'f1-score': 0.4430338572207811, 'support': 66902}}
[[12579  1402  8851]
 [ 8297  4460  8945]
 [ 6868  1430 14070]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0764482
{'0': {'precision': 0.47365111306753865, 'recall': 0.559085510688836, 'f1-score': 0.5128344794716416, 'support': 6736}, '1': {'precision': 0.5553571428571429, 'recall': 0.12241684707734699, 'f1-score': 0.20061280438638932, 'support': 5081}, '2': {'precision': 0.4690597933841177, 'recall': 0.6574520988737751, 'f1-score': 0.5475030450669915, 'support': 6837}, 'accuracy': 0.47619813444837567, 'macro avg': {'precision': 0.4993560164362664, 'recall': 0.44631815221331933, 'f1-score': 0.42031677630834086, 'support': 18654}, 'weighted avg': {'precision': 0.494223509587611, 'recall': 0.47619813444837567, 'f1-score': 0.44049775018394144, 'support': 18654}}
[[3766  247 2723]
 [2094  622 2365]
 [2091  251 4495]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2254921
{'0': {'precision': 0.3249794576828266, 'recall': 0.4369629265897373, 'f1-score': 0.3727420283784491, 'support': 48876}, '1': {'precision': 0.37890751407675877, 'recall': 0.1965124865735768, 'f1-score': 0.2588024666799284, 'support': 59584}, '2': {'precision': 0.31006021594684385, 'recall': 0.38995038300835655, 'f1-score': 0.34544648365206665, 'support': 45952}, 'accuracy': 0.3301880682848483, 'macro avg': {'precision': 0.3379823959021431, 'recall': 0.34114193205722354, 'f1-score': 0.32566365957014803, 'support': 154412}, 'weighted avg': {'precision': 0.34134917192734243, 'recall': 0.3301880682848483, 'f1-score': 0.3206524257859603, 'support': 154412}}
[[21357  9976 17543]
 [25545 11709 22330]
 [18816  9217 17919]]
Evaluating performance on  train set...
323/323 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.176044
{'0': {'precision': 0.3538247091286661, 'recall': 0.43468232333822604, 'f1-score': 0.3901077359762886, 'support': 28614}, '1': {'precision': 0.36170320490101765, 'recall': 0.2563237774030354, 'f1-score': 0.300029398177313, 'support': 27871}, '2': {'precision': 0.3350762684360463, 'recall': 0.35533460803059275, 'f1-score': 0.34490822367810553, 'support': 26150}, 'accuracy': 0.34941610697646275, 'macro avg': {'precision': 0.3502013941552433, 'recall': 0.3487802362572847, 'f1-score': 0.3450151192772357, 'support': 82635}, 'weighted avg': {'precision': 0.3505489764676774, 'recall': 0.34941610697646275, 'f1-score': 0.34542278892730527, 'support': 82635}}
[[12438  6768  9408]
 [11696  7144  9031]
 [11019  5839  9292]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1577836
{'0': {'precision': 0.38130469371519493, 'recall': 0.4529389529389529, 'f1-score': 0.4140463026952315, 'support': 10582}, '1': {'precision': 0.3070250284414107, 'recall': 0.26753407682775715, 'f1-score': 0.28592239438484973, 'support': 8070}, '2': {'precision': 0.3599728322390763, 'recall': 0.3250204415372036, 'f1-score': 0.34160489848533676, 'support': 9784}, 'accuracy': 0.35630890420593614, 'macro avg': {'precision': 0.34943418479856064, 'recall': 0.3484978237679712, 'f1-score': 0.34719119852180597, 'support': 28436}, 'weighted avg': {'precision': 0.3528848093629027, 'recall': 0.35630890420593614, 'f1-score': 0.35276037503823365, 'support': 28436}}
[[4793 2601 3188]
 [3445 2159 2466]
 [4332 2272 3180]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1300237
{'0': {'precision': 0.47423101120538674, 'recall': 0.46666108926629296, 'f1-score': 0.4704155984347591, 'support': 59765}, '1': {'precision': 0.44502429368364227, 'recall': 0.05683881495782482, 'f1-score': 0.10080300004076143, 'support': 43509}, '2': {'precision': 0.42517020837631525, 'recall': 0.7102043629596444, 'f1-score': 0.5319085782131197, 'support': 58034}, 'accuracy': 0.4437411659682099, 'macro avg': {'precision': 0.44814183775511474, 'recall': 0.41123475572792073, 'f1-score': 0.36770905889621336, 'support': 161308}, 'weighted avg': {'precision': 0.4487025209628946, 'recall': 0.4437411659682099, 'f1-score': 0.39284479627326024, 'support': 161308}}
[[27890  1771 30104]
 [15416  2473 25620]
 [15505  1313 41216]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1188318
{'0': {'precision': 0.4337342271293375, 'recall': 0.54289028182222, 'f1-score': 0.4822121391464457, 'support': 40522}, '1': {'precision': 0.6410770194113964, 'recall': 0.12559189381486296, 'f1-score': 0.21003610700804198, 'support': 40759}, '2': {'precision': 0.4320849017809129, 'recall': 0.6720541205412054, 'f1-score': 0.5259925295544688, 'support': 40650}, 'accuracy': 0.44645742264067384, 'macro avg': {'precision': 0.5022987161072157, 'recall': 0.44684543205942945, 'f1-score': 0.40608025856965213, 'support': 121931}, 'weighted avg': {'precision': 0.5024947539454137, 'recall': 0.44645742264067384, 'f1-score': 0.40582508397718553, 'support': 121931}}
[[21999  1423 17100]
 [16833  5119 18807]
 [11888  1443 27319]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1109178
{'0': {'precision': 0.43325649622799667, 'recall': 0.5426509186351706, 'f1-score': 0.48182241901654627, 'support': 15240}, '1': {'precision': 0.6832858499525166, 'recall': 0.1726040542161449, 'f1-score': 0.2755913051805037, 'support': 16674}, '2': {'precision': 0.41989395546129377, 'recall': 0.6616536327785576, 'f1-score': 0.5137533734689641, 'support': 14961}, 'accuracy': 0.44900266666666666, 'macro avg': {'precision': 0.5121454338806023, 'recall': 0.4589695352099577, 'f1-score': 0.42372236588867135, 'support': 46875}, 'weighted avg': {'precision': 0.517930042288626, 'recall': 0.44900266666666666, 'f1-score': 0.41865487592236916, 'support': 46875}}
[[8270  614 6356]
 [6476 2878 7320]
 [4342  720 9899]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5662626
{'0': {'precision': 0.4542961926027049, 'recall': 0.6227282818992039, 'f1-score': 0.5253419846817619, 'support': 63058}, '1': {'precision': 0.9119505569385641, 'recall': 0.84063138588322, 'f1-score': 0.874839848346189, 'support': 477616}, '2': {'precision': 0.45837132173200673, 'recall': 0.5621637388993324, 'f1-score': 0.5049894824185344, 'support': 61708}, 'accuracy': 0.789294832846931, 'macro avg': {'precision': 0.6082060237577586, 'recall': 0.6751744688939189, 'f1-score': 0.6350571051488284, 'support': 602382}, 'weighted avg': {'precision': 0.8175781547877414, 'recall': 0.789294832846931, 'f1-score': 0.8003665694839136, 'support': 602382}}
[[ 39268  18741   5049]
 [ 40175 401499  35942]
 [  6994  20024  34690]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.53664
{'0': {'precision': 0.4521743144677315, 'recall': 0.6193095599393019, 'f1-score': 0.5227066545706814, 'support': 31632}, '1': {'precision': 0.9132423942147541, 'recall': 0.8471341067503187, 'f1-score': 0.8789469519111556, 'support': 255662}, '2': {'precision': 0.48549254337019376, 'recall': 0.5869438567442431, 'f1-score': 0.5314196082786191, 'support': 32613}, 'accuracy': 0.7980819425645578, 'macro avg': {'precision': 0.6169697506842264, 'recall': 0.684462507811288, 'f1-score': 0.6443577382534854, 'support': 319907}, 'weighted avg': {'precision': 0.8240454982914031, 'recall': 0.7980819425645578, 'f1-score': 0.8082935984573024, 'support': 319907}}
[[ 19590   9713   2329]
 [ 21125 216580  17957]
 [  2609  10862  19142]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56425095
{'0': {'precision': 0.40808019131939144, 'recall': 0.6211757416156766, 'f1-score': 0.49256848053064745, 'support': 12911}, '1': {'precision': 0.9157727147954983, 'recall': 0.8282587538977934, 'f1-score': 0.8698200476605153, 'support': 100698}, '2': {'precision': 0.47592977156881255, 'recall': 0.5813220599538816, 'f1-score': 0.5233728936714993, 'support': 13010}, 'accuracy': 0.7817705083755203, 'macro avg': {'precision': 0.5999275592279009, 'recall': 0.6769188518224505, 'f1-score': 0.6285871406208874, 'support': 126619}, 'weighted avg': {'precision': 0.8188111619323482, 'recall': 0.7817705083755203, 'f1-score': 0.7957555513636656, 'support': 126619}}
[[ 8020  3482  1409]
 [10375 83404  6919]
 [ 1258  4189  7563]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
3870/3870 - 57s - 57s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6352824
{'0': {'precision': 0.41432014646921134, 'recall': 0.6198157281166304, 'f1-score': 0.49665068114970706, 'support': 115373}, '1': {'precision': 0.9015495589807228, 'recall': 0.8014414103549414, 'f1-score': 0.8485531198515374, 'support': 765084}, '2': {'precision': 0.4385640668826509, 'recall': 0.5488883446267723, 'f1-score': 0.48756315115182863, 'support': 110241}, 'accuracy': 0.7521868420043242, 'macro avg': {'precision': 0.584811257444195, 'recall': 0.6567151610327814, 'f1-score': 0.6109223173843576, 'support': 990698}, 'weighted avg': {'precision': 0.7932894205287685, 'recall': 0.7521868420043242, 'f1-score': 0.767402319910717, 'support': 990698}}
[[ 71510  33566  10297]
 [ 84748 613170  67166]
 [ 16338  33393  60510]]
Evaluating performance on  train set...
1577/1577 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59061515
{'0': {'precision': 0.37728076198267424, 'recall': 0.6384356768515772, 'f1-score': 0.4742849272301547, 'support': 40452}, '1': {'precision': 0.9126228135277016, 'recall': 0.8277454933952535, 'f1-score': 0.8681144307929456, 'support': 323858}, '2': {'precision': 0.48689464895084583, 'recall': 0.5132142857142857, 'f1-score': 0.4997081434195656, 'support': 39200}, 'accuracy': 0.7782111967485317, 'macro avg': {'precision': 0.5922660748204073, 'recall': 0.6597984853203721, 'f1-score': 0.614035833814222, 'support': 403510}, 'weighted avg': {'precision': 0.8175961705188239, 'recall': 0.7782111967485317, 'f1-score': 0.7928431424899086, 'support': 403510}}
[[ 25826  11709   2917]
 [ 37502 268072  18284]
 [  5125  13957  20118]]
Evaluating performance on  val set...
600/600 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5537387
{'0': {'precision': 0.4001989533324683, 'recall': 0.6408782379831002, 'f1-score': 0.49271812348571575, 'support': 14438}, '1': {'precision': 0.9223671791614844, 'recall': 0.8416384285380832, 'f1-score': 0.880155550318171, 'support': 124241}, '2': {'precision': 0.4993514915693904, 'recall': 0.5734208922889446, 'f1-score': 0.5338291368606813, 'support': 14771}, 'accuracy': 0.796930596285435, 'macro avg': {'precision': 0.607305874687781, 'recall': 0.685312519603376, 'f1-score': 0.635567603554856, 'support': 153450}, 'weighted avg': {'precision': 0.8325175241211314, 'recall': 0.796930596285435, 'f1-score': 0.8103646801859615, 'support': 153450}}
[[  9253   4087   1098]
 [ 12281 104566   7394]
 [  1587   4714   8470]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
2451/2451 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9418074
{'0': {'precision': 0.4610209143574353, 'recall': 0.6387635232253447, 'f1-score': 0.5355292064011585, 'support': 169061}, '1': {'precision': 0.6986566345802364, 'recall': 0.463794736292217, 'f1-score': 0.5574999139116713, 'support': 296711}, '2': {'precision': 0.4595476515815879, 'recall': 0.5578545389276408, 'f1-score': 0.5039516244013855, 'support': 161569}, 'accuracy': 0.5351714617727839, 'macro avg': {'precision': 0.5397417335064199, 'recall': 0.5534709328150675, 'f1-score': 0.5323269149047385, 'support': 627341}, 'weighted avg': {'precision': 0.5730351117231369, 'recall': 0.5351714617727839, 'f1-score': 0.537787933712191, 'support': 627341}}
[[107990  28491  32580]
 [ 85678 137613  73420]
 [ 40573  30864  90132]]
Evaluating performance on  train set...
1200/1200 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9036298
{'0': {'precision': 0.4729096156243109, 'recall': 0.6075057580273676, 'f1-score': 0.5318238179955794, 'support': 81191}, '1': {'precision': 0.7320380489779397, 'recall': 0.5229649621668514, 'f1-score': 0.6100865849544586, 'support': 145243}, '2': {'precision': 0.47944098877130625, 'recall': 0.5886582856009324, 'f1-score': 0.5284656909121265, 'support': 80658}, 'accuracy': 0.5625708256809034, 'macro avg': {'precision': 0.5614628844578523, 'recall': 0.5730430019317171, 'f1-score': 0.5567920312873881, 'support': 307092}, 'weighted avg': {'precision': 0.5971831184862267, 'recall': 0.5625708256809034, 'f1-score': 0.5679571566924888, 'support': 307092}}
[[49324 13479 18388]
 [36122 75957 33164]
 [18853 14325 47480]]
Evaluating performance on  val set...
441/441 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8868636
{'0': {'precision': 0.47113192585984737, 'recall': 0.6175859156759566, 'f1-score': 0.5345084478929465, 'support': 30786}, '1': {'precision': 0.7444946504622416, 'recall': 0.5449344231134765, 'f1-score': 0.6292719330977414, 'support': 52610}, '2': {'precision': 0.49353410097431355, 'recall': 0.5697729906605767, 'f1-score': 0.5289203898240729, 'support': 29338}, 'accuracy': 0.5712384906062058, 'macro avg': {'precision': 0.5697202257654675, 'recall': 0.5774311098166699, 'f1-score': 0.5642335902715869, 'support': 112734}, 'weighted avg': {'precision': 0.604533099905301, 'recall': 0.5712384906062058, 'f1-score': 0.5772778387510695, 'support': 112734}}
[[19013  4949  6824]
 [13611 28669 10330]
 [ 7732  4890 16716]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
3337/3337 - 48s - 48s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8608674
{'0': {'precision': 0.43139271828772224, 'recall': 0.6433383394121434, 'f1-score': 0.516466837036766, 'support': 186440}, '1': {'precision': 0.7952438520964793, 'recall': 0.557989080173211, 'f1-score': 0.6558181891131831, 'support': 483341}, '2': {'precision': 0.4609359826382145, 'recall': 0.5925369083803734, 'f1-score': 0.5185165834683031, 'support': 184240}, 'accuracy': 0.5840746304833253, 'macro avg': {'precision': 0.5625241843408053, 'recall': 0.597954775988576, 'f1-score': 0.5636005365394174, 'support': 854021}, 'weighted avg': {'precision': 0.6436910363503848, 'recall': 0.5840746304833253, 'f1-score': 0.5957762066500587, 'support': 854021}}
[[119944  34001  32495]
 [118464 269699  95178]
 [ 39631  35440 109169]]
Evaluating performance on  train set...
1431/1431 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8777538
{'0': {'precision': 0.455273242465882, 'recall': 0.6086812647626003, 'f1-score': 0.5209175602039022, 'support': 87637}, '1': {'precision': 0.7690245036770049, 'recall': 0.5602365310195503, 'f1-score': 0.6482332799402161, 'support': 188897}, '2': {'precision': 0.4686733676466625, 'recall': 0.5825034609029608, 'f1-score': 0.5194251837988243, 'support': 89572}, 'accuracy': 0.5772808967894544, 'macro avg': {'precision': 0.5643237045965165, 'recall': 0.5838070855617038, 'f1-score': 0.5628586746476475, 'support': 366106}, 'weighted avg': {'precision': 0.6204356489866447, 'recall': 0.5772808967894544, 'f1-score': 0.5862425818415559, 'support': 366106}}
[[ 53343  15173  19121]
 [ 43040 105827  40030]
 [ 20784  16612  52176]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.916082
{'0': {'precision': 0.47600648731158174, 'recall': 0.5836013801976724, 'f1-score': 0.5243412237606073, 'support': 34198}, '1': {'precision': 0.7248249588138386, 'recall': 0.4950857142857143, 'f1-score': 0.5883225557076147, 'support': 56875}, '2': {'precision': 0.47425955962405847, 'recall': 0.61495246326707, 'f1-score': 0.5355193998770651, 'support': 34710}, 'accuracy': 0.5522288385552897, 'macro avg': {'precision': 0.5583636685831596, 'recall': 0.5645465192501522, 'f1-score': 0.5493943931150956, 'support': 125783}, 'weighted avg': {'precision': 0.5880320766730768, 'recall': 0.5522288385552897, 'f1-score': 0.5563561442783903, 'support': 125783}}
[[19958  5377  8863]
 [13918 28158 14799]
 [ 8052  5313 21345]]
testing model on single stock: results/universal/W9/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
10303/10303 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1554255
{'0': {'precision': 0.40567205680332347, 'recall': 0.5862859562192554, 'f1-score': 0.4795360823985902, 'support': 836121}, '1': {'precision': 0.541641138406533, 'recall': 0.06752167335229163, 'f1-score': 0.12007468386342937, 'support': 955782}, '2': {'precision': 0.4069617329897891, 'recall': 0.6304770780874298, 'f1-score': 0.49464130620365077, 'support': 845501}, 'accuracy': 0.4124552021609128, 'macro avg': {'precision': 0.4514249760665486, 'recall': 0.42809490255299226, 'f1-score': 0.3647506908218901, 'support': 2637404}, 'weighted avg': {'precision': 0.45536001634922985, 'recall': 0.4124552021609128, 'f1-score': 0.3541115162030697, 'support': 2637404}}
[[490206  26273 319642]
 [434082  64536 457164]
 [284092  28340 533069]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.148323
{'0': {'precision': 0.4144053460097286, 'recall': 0.542869372510304, 'f1-score': 0.47001757343184025, 'support': 289694}, '1': {'precision': 0.5770538648378339, 'recall': 0.07010807489211605, 'f1-score': 0.1250263128567714, 'support': 288041}, '2': {'precision': 0.4196773766392206, 'recall': 0.6500223590288449, 'f1-score': 0.5100490713381174, 'support': 297419}, 'accuracy': 0.42368428870804453, 'macro avg': {'precision': 0.4703788624955944, 'recall': 0.4209999354770883, 'f1-score': 0.36836431920890966, 'support': 875154}, 'weighted avg': {'precision': 0.46972983071705915, 'recall': 0.42368428870804453, 'f1-score': 0.3700745924119096, 'support': 875154}}
[[157266   7189 125239]
 [125754  20194 142093]
 [ 96478   7612 193329]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1571572
{'0': {'precision': 0.40743381655356614, 'recall': 0.5695977967948772, 'f1-score': 0.4750581272458254, 'support': 118373}, '1': {'precision': 0.5551973175135414, 'recall': 0.07023124923528692, 'f1-score': 0.12468954331187593, 'support': 122595}, '2': {'precision': 0.4092618751808295, 'recall': 0.6203116132693598, 'f1-score': 0.49315546076310207, 'support': 116298}, 'accuracy': 0.4147497942709354, 'macro avg': {'precision': 0.45729766974931235, 'recall': 0.4200468864331746, 'f1-score': 0.3643010437736012, 'support': 357266}, 'weighted avg': {'precision': 0.45873359308539857, 'recall': 0.4147497942709354, 'f1-score': 0.36072104268141036, 'support': 357266}}
[[67425  3439 47509]
 [57364  8610 56621]
 [40698  3459 72141]]
training model: results/universal/W9/deepVOL_L3/h30
Epoch 1/50
6697/6697 - 426s - loss: 2.8733 - accuracy30: 0.5065 - val_loss: 3.0131 - val_accuracy30: 0.4702 - 426s/epoch - 64ms/step
Epoch 2/50
6697/6697 - 398s - loss: 2.7886 - accuracy30: 0.5307 - val_loss: 3.0219 - val_accuracy30: 0.4709 - 398s/epoch - 59ms/step
Epoch 3/50
6697/6697 - 385s - loss: 2.7639 - accuracy30: 0.5359 - val_loss: 3.0106 - val_accuracy30: 0.4906 - 385s/epoch - 57ms/step
Epoch 4/50
6697/6697 - 385s - loss: 2.7510 - accuracy30: 0.5391 - val_loss: 2.9952 - val_accuracy30: 0.4875 - 385s/epoch - 58ms/step
Epoch 5/50
6697/6697 - 396s - loss: 2.7406 - accuracy30: 0.5412 - val_loss: 2.9759 - val_accuracy30: 0.4990 - 396s/epoch - 59ms/step
Epoch 6/50
6697/6697 - 379s - loss: 2.7319 - accuracy30: 0.5433 - val_loss: 2.9607 - val_accuracy30: 0.5068 - 379s/epoch - 57ms/step
Epoch 7/50
6697/6697 - 370s - loss: 2.7246 - accuracy30: 0.5446 - val_loss: 2.9533 - val_accuracy30: 0.5063 - 370s/epoch - 55ms/step
Epoch 8/50
6697/6697 - 381s - loss: 2.7178 - accuracy30: 0.5457 - val_loss: 2.9486 - val_accuracy30: 0.5083 - 381s/epoch - 57ms/step
Epoch 9/50
6697/6697 - 370s - loss: 2.7118 - accuracy30: 0.5471 - val_loss: 2.9146 - val_accuracy30: 0.5179 - 370s/epoch - 55ms/step
Epoch 10/50
6697/6697 - 363s - loss: 2.7073 - accuracy30: 0.5479 - val_loss: 2.9056 - val_accuracy30: 0.5148 - 363s/epoch - 54ms/step
Epoch 11/50
6697/6697 - 362s - loss: 2.7035 - accuracy30: 0.5485 - val_loss: 2.9345 - val_accuracy30: 0.5162 - 362s/epoch - 54ms/step
Epoch 12/50
6697/6697 - 362s - loss: 2.6993 - accuracy30: 0.5490 - val_loss: 2.9187 - val_accuracy30: 0.5112 - 362s/epoch - 54ms/step
Epoch 13/50
6697/6697 - 362s - loss: 2.6965 - accuracy30: 0.5497 - val_loss: 2.9071 - val_accuracy30: 0.5159 - 362s/epoch - 54ms/step
Epoch 14/50
6697/6697 - 378s - loss: 2.6933 - accuracy30: 0.5505 - val_loss: 2.9146 - val_accuracy30: 0.5136 - 378s/epoch - 56ms/step
Epoch 15/50
6697/6697 - 378s - loss: 2.6909 - accuracy30: 0.5512 - val_loss: 2.9285 - val_accuracy30: 0.5115 - 378s/epoch - 56ms/step
Epoch 16/50
6697/6697 - 372s - loss: 2.6890 - accuracy30: 0.5513 - val_loss: 2.9138 - val_accuracy30: 0.5147 - 372s/epoch - 55ms/step
Epoch 17/50
6697/6697 - 357s - loss: 2.6865 - accuracy30: 0.5519 - val_loss: 2.9127 - val_accuracy30: 0.5171 - 357s/epoch - 53ms/step
Epoch 18/50
6697/6697 - 374s - loss: 2.6843 - accuracy30: 0.5523 - val_loss: 2.9417 - val_accuracy30: 0.5152 - 374s/epoch - 56ms/step
Epoch 19/50
6697/6697 - 356s - loss: 2.6824 - accuracy30: 0.5524 - val_loss: 2.9329 - val_accuracy30: 0.5135 - 356s/epoch - 53ms/step
Epoch 20/50
6697/6697 - 377s - loss: 2.6799 - accuracy30: 0.5531 - val_loss: 2.9324 - val_accuracy30: 0.5121 - 377s/epoch - 56ms/step
testing model in sample: results/universal/W9/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
16830/16830 - 459s - 459s/epoch - 27ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0425768
{'0': {'precision': 0.4164522742834531, 'recall': 0.5341526361270569, 'f1-score': 0.4680158448446306, 'support': 1205822}, '1': {'precision': 0.7353240616798797, 'recall': 0.39670423451360787, 'f1-score': 0.5153690415496379, 'support': 1897101}, '2': {'precision': 0.40816149180564676, 'recall': 0.5886760410467367, 'f1-score': 0.48207432642779363, 'support': 1204773}, 'accuracy': 0.4888696881116959, 'macro avg': {'precision': 0.5199792759229932, 'recall': 0.5065109705624672, 'f1-score': 0.4884864042740207, 'support': 4307696}, 'weighted avg': {'precision': 0.55456403422738, 'recall': 0.4888696881116959, 'f1-score': 0.49280196620850075, 'support': 4307696}}
[[644093 132495 429234]
 [545369 752588 599144]
 [357157 138395 709221]]
Evaluating performance on  train set...
6697/6697 - 204s - 204s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99813604
{'0': {'precision': 0.4257936011232592, 'recall': 0.5061238571675004, 'f1-score': 0.4624965394531892, 'support': 463760}, '1': {'precision': 0.7593837775164936, 'recall': 0.4775709944811668, 'f1-score': 0.5863749815779083, 'support': 778969}, '2': {'precision': 0.418372806391782, 'recall': 0.5973315000127314, 'f1-score': 0.49208663275473286, 'support': 471276}, 'accuracy': 0.5182254427495836, 'macro avg': {'precision': 0.5345167283438449, 'recall': 0.5270087838871329, 'f1-score': 0.5136527179286101, 'support': 1714005}, 'weighted avg': {'precision': 0.5753609382412896, 'recall': 0.5182254427495836, 'f1-score': 0.5269319214936317, 'support': 1714005}}
[[234720  58767 170273]
 [185873 372013 221083]
 [130660  59108 281508]]
Evaluating performance on  val set...
2631/2631 - 75s - 75s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0049008
{'0': {'precision': 0.42040267521854724, 'recall': 0.5216992186445346, 'f1-score': 0.46560515079372733, 'support': 185191}, '1': {'precision': 0.7666136486566093, 'recall': 0.46772159343388137, 'f1-score': 0.5809795346855119, 'support': 306056}, '2': {'precision': 0.4147374827368273, 'recall': 0.5853287890717483, 'f1-score': 0.4854834032428582, 'support': 181621}, 'accuracy': 0.5143222742053419, 'macro avg': {'precision': 0.5339179355373279, 'recall': 0.5249165337167215, 'f1-score': 0.5106893629073658, 'support': 672868}, 'weighted avg': {'precision': 0.5763486077979493, 'recall': 0.5143222742053419, 'f1-score': 0.5234490823292552, 'support': 672868}}
[[ 96614  21702  66875]
 [ 79764 143149  83143]
 [ 53435  21878 106308]]
testing model out of sample: results/universal/W9/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
8641/8641 - 266s - 266s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8562113
{'0': {'precision': 0.4585371783330309, 'recall': 0.5423948152624669, 'f1-score': 0.4969532190484191, 'support': 479870}, '1': {'precision': 0.7969006310295822, 'recall': 0.6515002153191443, 'f1-score': 0.7169022774496961, 'support': 1260919}, '2': {'precision': 0.44821272373591653, 'recall': 0.5837851854843338, 'f1-score': 0.5070939499486268, 'support': 470471}, 'accuracy': 0.6134158805386974, 'macro avg': {'precision': 0.5678835110328432, 'recall': 0.5925600720219816, 'f1-score': 0.5736498154822472, 'support': 2211260}, 'weighted avg': {'precision': 0.6492843315090138, 'recall': 0.6134158805386974, 'f1-score': 0.6245315529293881, 'support': 2211260}}
[[260279 105134 114457]
 [215765 821489 223665]
 [ 91585 104232 274654]]
Evaluating performance on  train set...
3947/3947 - 132s - 132s/epoch - 33ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8720257
{'0': {'precision': 0.4522581707228367, 'recall': 0.5149202336326388, 'f1-score': 0.4815593108410259, 'support': 229420}, '1': {'precision': 0.7880516125653994, 'recall': 0.6564549752007837, 'f1-score': 0.7162589719767946, 'support': 550219}, '2': {'precision': 0.4546172332113932, 'recall': 0.5734303445696467, 'f1-score': 0.5071580777426477, 'support': 229939}, 'accuracy': 0.6053826450259415, 'macro avg': {'precision': 0.564975672166543, 'recall': 0.5816018511343564, 'f1-score': 0.5683254535201561, 'support': 1009578}, 'weighted avg': {'precision': 0.6358025548583162, 'recall': 0.6053826450259415, 'f1-score': 0.6153007034952372, 'support': 1009578}}
[[118133  46687  64600]
 [ 95446 361194  93579]
 [ 47628  50457 131854]]
Evaluating performance on  val set...
1402/1402 - 45s - 45s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85753554
{'0': {'precision': 0.4636520250622716, 'recall': 0.5126606083401075, 'f1-score': 0.4869262592622469, 'support': 82421}, '1': {'precision': 0.7924809611303922, 'recall': 0.6635225501012644, 'f1-score': 0.7222908244103501, 'support': 193059}, '2': {'precision': 0.4625282081429086, 'recall': 0.5894130156351949, 'f1-score': 0.518318209830631, 'support': 82762}, 'accuracy': 0.6116926546859386, 'macro avg': {'precision': 0.5728870647785241, 'recall': 0.5885320580255223, 'f1-score': 0.5758450978344093, 'support': 358242}, 'weighted avg': {'precision': 0.6406005018810002, 'recall': 0.6116926546859386, 'f1-score': 0.6210180413421489, 'support': 358242}}
[[ 42254  16603  23564]
 [ 31839 128099  33121]
 [ 17040  16941  48781]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0853913
{'0': {'precision': 0.43006424931688947, 'recall': 0.46190759468570297, 'f1-score': 0.4454175191693596, 'support': 25215}, '1': {'precision': 0.5291115750405938, 'recall': 0.20217150454243296, 'f1-score': 0.29255779651777986, 'support': 22565}, '2': {'precision': 0.4573985379379884, 'recall': 0.6575704863376096, 'f1-score': 0.539515937202664, 'support': 27594}, 'accuracy': 0.4557805078674344, 'macro avg': {'precision': 0.47219145409849056, 'recall': 0.4405498618552485, 'f1-score': 0.4258304176299345, 'support': 75374}, 'weighted avg': {'precision': 0.4697233527897845, 'recall': 0.4557805078674344, 'f1-score': 0.43410422951481165, 'support': 75374}}
[[11647  2004 11564]
 [ 8042  4562  9961]
 [ 7393  2056 18145]]
Evaluating performance on  train set...
200/200 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0693755
{'0': {'precision': 0.46845208228800805, 'recall': 0.42643448472737655, 'f1-score': 0.44645685764667203, 'support': 17515}, '1': {'precision': 0.5862114948659821, 'recall': 0.2670392418904143, 'f1-score': 0.3669295939234589, 'support': 16462}, '2': {'precision': 0.4226684967131402, 'recall': 0.6822527985074627, 'f1-score': 0.5219679735938267, 'support': 17152}, 'accuracy': 0.4609321520076669, 'macro avg': {'precision': 0.49244402462237674, 'recall': 0.4585755083750845, 'f1-score': 0.44511814172131925, 'support': 51129}, 'weighted avg': {'precision': 0.49100827134076624, 'recall': 0.4609321520076669, 'f1-score': 0.44618282227171974, 'support': 51129}}
[[ 7469  1705  8341]
 [ 4423  4396  7643]
 [ 4052  1398 11702]]
Evaluating performance on  val set...
53/53 - 1s - 994ms/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669694
{'0': {'precision': 0.4519748653500898, 'recall': 0.4554500226142017, 'f1-score': 0.45370578959225055, 'support': 4422}, '1': {'precision': 0.6186641402179062, 'recall': 0.2776360544217687, 'f1-score': 0.38327219369038884, 'support': 4704}, '2': {'precision': 0.4248517286272241, 'recall': 0.674552135966927, 'f1-score': 0.5213455223218249, 'support': 4354}, 'accuracy': 0.46416913946587535, 'macro avg': {'precision': 0.49849691139840663, 'recall': 0.4692127376676325, 'f1-score': 0.45277450186815477, 'support': 13480}, 'weighted avg': {'precision': 0.5013822994514882, 'recall': 0.46416913946587535, 'f1-score': 0.4509746146057675, 'support': 13480}}
[[2014  472 1936]
 [1358 1306 2040]
 [1084  333 2937]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
1118/1118 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6657665
{'0': {'precision': 0.3393917252717143, 'recall': 0.6257156327877685, 'f1-score': 0.4400810052227051, 'support': 29694}, '1': {'precision': 0.8876230980245111, 'recall': 0.7976474969740232, 'f1-score': 0.84023342541759, 'support': 225547}, '2': {'precision': 0.5200849345586188, 'recall': 0.4832772674343382, 'f1-score': 0.5010059687479042, 'support': 30916}, 'accuracy': 0.7458423173292983, 'macro avg': {'precision': 0.5823665859516147, 'recall': 0.6355467990653766, 'f1-score': 0.5937734664627331, 'support': 286157}, 'weighted avg': {'precision': 0.7910258026788335, 'recall': 0.7458423173292983, 'f1-score': 0.7620606670518436, 'support': 286157}}
[[ 18580   9956   1158]
 [ 33011 179907  12629]
 [  3154  12821  14941]]
Evaluating performance on  train set...
505/505 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.65313715
{'0': {'precision': 0.46749582541601886, 'recall': 0.5220214749566, 'f1-score': 0.4932563791008505, 'support': 15553}, '1': {'precision': 0.8712346587334592, 'recall': 0.8310313262815296, 'f1-score': 0.850658240631328, 'support': 98320}, '2': {'precision': 0.45768528255936236, 'recall': 0.53890771637122, 'f1-score': 0.49498668103319265, 'support': 15344}, 'accuracy': 0.759149337935411, 'macro avg': {'precision': 0.5988052555696135, 'recall': 0.6306535058697832, 'f1-score': 0.6129671002551237, 'support': 129217}, 'weighted avg': {'precision': 0.7735319439002601, 'recall': 0.759149337935411, 'f1-score': 0.765405560543899, 'support': 129217}}
[[ 8119  6148  1286]
 [ 8101 81707  8512]
 [ 1147  5928  8269]]
Evaluating performance on  val set...
187/187 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6501811
{'0': {'precision': 0.41505542665635475, 'recall': 0.5677009873060649, 'f1-score': 0.4795234549516009, 'support': 5672}, '1': {'precision': 0.8720276696930394, 'recall': 0.8319355459619985, 'f1-score': 0.8515099490585687, 'support': 36367}, '2': {'precision': 0.557276119402985, 'recall': 0.5173190162798753, 'f1-score': 0.5365546973235136, 'support': 5774}, 'accuracy': 0.7625959467090541, 'macro avg': {'precision': 0.6147864052507931, 'recall': 0.6389851831826462, 'f1-score': 0.6225293671112277, 'support': 47813}, 'weighted avg': {'precision': 0.7798075200709942, 'recall': 0.7625959467090541, 'f1-score': 0.7693469595349469, 'support': 47813}}
[[ 3220  2202   250]
 [ 3989 30255  2123]
 [  549  2238  2987]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
508/508 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1021706
{'0': {'precision': 0.4449329014345211, 'recall': 0.43477277865702013, 'f1-score': 0.43979416809605487, 'support': 39807}, '1': {'precision': 0.5847445201964665, 'recall': 0.32346560149232545, 'f1-score': 0.4165219775198757, 'support': 49319}, '2': {'precision': 0.40261310636159486, 'recall': 0.6294159526673704, 'f1-score': 0.4910929778186414, 'support': 40733}, 'accuracy': 0.45355346953233894, 'macro avg': {'precision': 0.4774301759975275, 'recall': 0.46255144427223865, 'f1-score': 0.44913637447819066, 'support': 129859}, 'weighted avg': {'precision': 0.48475730338598294, 'recall': 0.45355346953233894, 'f1-score': 0.44704659764967486, 'support': 129859}}
[[17307  5967 16533]
 [11858 15953 21508]
 [ 9733  5362 25638]]
Evaluating performance on  train set...
262/262 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1407461
{'0': {'precision': 0.4383211204093136, 'recall': 0.4492489556483868, 'f1-score': 0.4437177658290355, 'support': 22502}, '1': {'precision': 0.5035917529620301, 'recall': 0.24175922608384093, 'f1-score': 0.32668623475655884, 'support': 22328}, '2': {'precision': 0.41503623188405797, 'recall': 0.6227799927509967, 'f1-score': 0.4981156689375271, 'support': 22072}, 'accuracy': 0.43725150219724374, 'macro avg': {'precision': 0.45231636841846723, 'recall': 0.4379293914944082, 'f1-score': 0.42283988984104043, 'support': 66902}, 'weighted avg': {'precision': 0.4524226214721758, 'recall': 0.43725150219724374, 'f1-score': 0.42260614721710116, 'support': 66902}}
[[10109  2709  9684]
 [ 7240  5398  9690]
 [ 5714  2612 13746]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1573088
{'0': {'precision': 0.4494279176201373, 'recall': 0.4514942528735632, 'f1-score': 0.4504587155963302, 'support': 6525}, '1': {'precision': 0.4375, 'recall': 0.16179126038280967, 'f1-score': 0.23622462430793567, 'support': 5538}, '2': {'precision': 0.4281166053129042, 'recall': 0.6528599605522682, 'f1-score': 0.5171253455113568, 'support': 6591}, 'accuracy': 0.43663557413959475, 'macro avg': {'precision': 0.4383481743110138, 'recall': 0.422048491269547, 'f1-score': 0.40126956180520756, 'support': 18654}, 'weighted avg': {'precision': 0.4383568515111369, 'recall': 0.43663557413959475, 'f1-score': 0.41041214972385304, 'support': 18654}}
[[2946  580 2999]
 [1893  896 2749]
 [1716  572 4303]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
604/604 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1902711
{'0': {'precision': 0.3157049639575006, 'recall': 0.37651516694847925, 'f1-score': 0.3434390359475606, 'support': 49087}, '1': {'precision': 0.3749429335420335, 'recall': 0.09651154982540962, 'f1-score': 0.15350929894126913, 'support': 59568}, '2': {'precision': 0.2999490917218173, 'recall': 0.5279410800533252, 'f1-score': 0.382551823522891, 'support': 45757}, 'accuracy': 0.31336942724658706, 'macro avg': {'precision': 0.3301989964071171, 'recall': 0.33365593227573803, 'f1-score': 0.2931667194705736, 'support': 154412}, 'weighted avg': {'precision': 0.3338884336769738, 'recall': 0.31336942724658706, 'f1-score': 0.28175956315460166, 'support': 154412}}
[[18482  5038 25567]
 [23006  5749 30813]
 [17054  4546 24157]]
Evaluating performance on  train set...
323/323 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.140257
{'0': {'precision': 0.3502608695652174, 'recall': 0.38320763855254963, 'f1-score': 0.3659942839206357, 'support': 28906}, '1': {'precision': 0.3554566162766618, 'recall': 0.12418608016206048, 'f1-score': 0.18406519757653747, 'support': 27644}, '2': {'precision': 0.3180982781969433, 'recall': 0.5042744872532107, 'f1-score': 0.3901122529175378, 'support': 26085}, 'accuracy': 0.3347734011012283, 'macro avg': {'precision': 0.3412719213462742, 'recall': 0.33722273532260694, 'f1-score': 0.313390578138237, 'support': 82635}, 'weighted avg': {'precision': 0.34184639659673843, 'recall': 0.3347734011012283, 'f1-score': 0.3127465022105606, 'support': 82635}}
[[11077  3327 14502]
 [10515  3433 13696]
 [10033  2898 13154]]
Evaluating performance on  val set...
112/112 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1205801
{'0': {'precision': 0.3774546128195628, 'recall': 0.38567102025364375, 'f1-score': 0.3815185844022095, 'support': 10566}, '1': {'precision': 0.3018138566755873, 'recall': 0.1276247956745882, 'f1-score': 0.17939201131141747, 'support': 7953}, '2': {'precision': 0.34916298942354834, 'recall': 0.5026721790864173, 'f1-score': 0.41208564106803336, 'support': 9917}, 'accuracy': 0.3543044028696019, 'macro avg': {'precision': 0.34281048630623284, 'recall': 0.3386559983382164, 'f1-score': 0.3243320789272201, 'support': 28436}, 'weighted avg': {'precision': 0.3464327052787233, 'recall': 0.3543044028696019, 'f1-score': 0.335647887580009, 'support': 28436}}
[[4075 1199 5292]
 [2938 1015 4000]
 [3783 1149 4985]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
631/631 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1539716
{'0': {'precision': 0.46660509254228694, 'recall': 0.4283458021612635, 'f1-score': 0.4466576520352264, 'support': 60150}, '1': {'precision': 0.37604456824512533, 'recall': 0.05829148012635502, 'f1-score': 0.10093656540217219, 'support': 44003}, '2': {'precision': 0.40778087821978665, 'recall': 0.7082494969818913, 'f1-score': 0.5175676366797933, 'support': 57155}, 'accuracy': 0.4265752473528901, 'macro avg': {'precision': 0.41681017966906636, 'recall': 0.39829559308983664, 'f1-score': 0.3550539513723973, 'support': 161308}, 'weighted avg': {'precision': 0.4210584815852947, 'recall': 0.4265752473528901, 'f1-score': 0.3774738248056156, 'support': 161308}}
[[25765  2411 31974]
 [14623  2565 26815]
 [14830  1845 40480]]
Evaluating performance on  train set...
477/477 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1465652
{'0': {'precision': 0.43261085335733906, 'recall': 0.4591489257453637, 'f1-score': 0.44548501342967844, 'support': 40819}, '1': {'precision': 0.5452466514211042, 'recall': 0.167599728868024, 'f1-score': 0.2563895769725599, 'support': 39833}, '2': {'precision': 0.41478813814718823, 'recall': 0.6668523946801037, 'f1-score': 0.5114498852688981, 'support': 41279}, 'accuracy': 0.4342209938407788, 'macro avg': {'precision': 0.46421521430854384, 'recall': 0.4312003497644971, 'f1-score': 0.40444149189037876, 'support': 121931}, 'weighted avg': {'precision': 0.4633734804424457, 'recall': 0.4342209938407788, 'f1-score': 0.4060424223269625, 'support': 121931}}
[[18742  2804 19273]
 [13593  6676 19564]
 [10988  2764 27527]]
Evaluating performance on  val set...
184/184 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1454605
{'0': {'precision': 0.42727382826692506, 'recall': 0.4575875486381323, 'f1-score': 0.44191144234984664, 'support': 15420}, '1': {'precision': 0.579655172413793, 'recall': 0.205, 'f1-score': 0.30288288288288284, 'support': 16400}, '2': {'precision': 0.4019380318390945, 'recall': 0.6557289936898041, 'f1-score': 0.4983844911147012, 'support': 15055}, 'accuracy': 0.4328533333333333, 'macro avg': {'precision': 0.4696223441732708, 'recall': 0.43943884744264544, 'f1-score': 0.4143929387824769, 'support': 46875}, 'weighted avg': {'precision': 0.47244979901439477, 'recall': 0.4328533333333333, 'f1-score': 0.4114076209929758, 'support': 46875}}
[[7056 1240 7124]
 [5473 3362 7565]
 [3985 1198 9872]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6696293
{'0': {'precision': 0.4721440747984145, 'recall': 0.5879173829244153, 'f1-score': 0.5237087091441665, 'support': 76788}, '1': {'precision': 0.8734833568205365, 'recall': 0.7899017124283713, 'f1-score': 0.8295926326208688, 'support': 450413}, '2': {'precision': 0.4281606017033514, 'recall': 0.5663798034077759, 'f1-score': 0.48766549086078154, 'support': 75181}, 'accuracy': 0.7362570594738886, 'macro avg': {'precision': 0.5912626777741008, 'recall': 0.6480662995868541, 'f1-score': 0.6136556108752723, 'support': 602382}, 'weighted avg': {'precision': 0.7667440272250641, 'recall': 0.7362570594738886, 'f1-score': 0.7479257847393017, 'support': 602382}}
[[ 45145  26229   5414]
 [ 43175 355782  51456]
 [  7297  25303  42581]]
Evaluating performance on  train set...
1250/1250 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64125353
{'0': {'precision': 0.476394231758244, 'recall': 0.5928675661145388, 'f1-score': 0.5282872524865407, 'support': 39061}, '1': {'precision': 0.8758549555331439, 'recall': 0.7943415445379898, 'f1-score': 0.8331091319372527, 'support': 240525}, '2': {'precision': 0.4544736248024682, 'recall': 0.5991418863619454, 'f1-score': 0.5168758090225404, 'support': 40321}, 'accuracy': 0.7451384308564677, 'macro avg': {'precision': 0.6022409373646186, 'recall': 0.6621169990048247, 'f1-score': 0.6260907311487779, 'support': 319907}, 'weighted avg': {'precision': 0.7739695576901366, 'recall': 0.7451384308564677, 'f1-score': 0.756032071271283, 'support': 319907}}
[[ 23158  13596   2307]
 [ 22775 191059  26691]
 [  2678  13485  24158]]
Evaluating performance on  val set...
495/495 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64807636
{'0': {'precision': 0.4443970623075101, 'recall': 0.5981123652828263, 'f1-score': 0.5099222530310444, 'support': 15681}, '1': {'precision': 0.8808437325386478, 'recall': 0.7959271686880055, 'f1-score': 0.8362352395108663, 'support': 95069}, '2': {'precision': 0.47307496175420705, 'recall': 0.5845989035225913, 'f1-score': 0.5229572423123537, 'support': 15869}, 'accuracy': 0.7449434918930018, 'macro avg': {'precision': 0.5994385855334549, 'recall': 0.659546145831141, 'f1-score': 0.6230382449514215, 'support': 126619}, 'weighted avg': {'precision': 0.775687295831102, 'recall': 0.7449434918930018, 'f1-score': 0.7565606055417678, 'support': 126619}}
[[ 9379  4914  1388]
 [10456 75668  8945]
 [ 1270  5322  9277]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
3870/3870 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7176205
{'0': {'precision': 0.46216405258977367, 'recall': 0.5631166129801095, 'f1-score': 0.5076702695663498, 'support': 138458}, '1': {'precision': 0.8586107548580424, 'recall': 0.7845363701874013, 'f1-score': 0.8199038963130748, 'support': 720219}, '2': {'precision': 0.428302991849285, 'recall': 0.5317638860484317, 'f1-score': 0.4744587457296077, 'support': 132021}, 'accuracy': 0.7199065709227231, 'macro avg': {'precision': 0.5830259330990337, 'recall': 0.6264722897386475, 'f1-score': 0.6006776372030108, 'support': 990698}, 'weighted avg': {'precision': 0.7458610786874647, 'recall': 0.7199065709227231, 'f1-score': 0.7302325154106425, 'support': 990698}}
[[ 77968  47665  12825]
 [ 74298 565038  80883]
 [ 16436  45381  70204]]
Evaluating performance on  train set...
1577/1577 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6807977
{'0': {'precision': 0.41878847538310093, 'recall': 0.5827966222985544, 'f1-score': 0.48736449748657795, 'support': 48909}, '1': {'precision': 0.8758976881455977, 'recall': 0.8117177426707128, 'f1-score': 0.8425873350638113, 'support': 307124}, '2': {'precision': 0.46731068133078874, 'recall': 0.5002843482107125, 'f1-score': 0.48323567708333337, 'support': 47477}, 'accuracy': 0.7473272037867711, 'macro avg': {'precision': 0.5873322816198291, 'recall': 0.6315995710599932, 'f1-score': 0.6043958365445743, 'support': 403510}, 'weighted avg': {'precision': 0.7724176261656029, 'recall': 0.7473272037867711, 'f1-score': 0.7572498405060456, 'support': 403510}}
[[ 28504  16794   3611]
 [ 34362 249298  23464]
 [  5197  18528  23752]]
Evaluating performance on  val set...
600/600 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.64387095
{'0': {'precision': 0.43862306947775953, 'recall': 0.5923842000568343, 'f1-score': 0.5040379128584553, 'support': 17595}, '1': {'precision': 0.8868604481424713, 'recall': 0.8242002357110759, 'f1-score': 0.8543830120105999, 'support': 117941}, '2': {'precision': 0.4893171970715673, 'recall': 0.54845372334487, 'f1-score': 0.5172005369410153, 'support': 17914}, 'accuracy': 0.7654284783317041, 'macro avg': {'precision': 0.6049335715639327, 'recall': 0.65501271970426, 'f1-score': 0.6252071539366902, 'support': 153450}, 'weighted avg': {'precision': 0.7890544756609479, 'recall': 0.7654284783317041, 'f1-score': 0.7748482522974782, 'support': 153450}}
[[10423  5970  1202]
 [11682 97207  9052]
 [ 1658  6431  9825]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
2451/2451 - 44s - 44s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96901244
{'0': {'precision': 0.5001108537626597, 'recall': 0.5489344296247204, 'f1-score': 0.5233864936180506, 'support': 193136}, '1': {'precision': 0.5887696080266557, 'recall': 0.5030145771195995, 'f1-score': 0.5425242450507323, 'support': 250118}, '2': {'precision': 0.47809205502276086, 'recall': 0.5237360595805244, 'f1-score': 0.49987427057490746, 'support': 184087}, 'accuracy': 0.5232321815408207, 'macro avg': {'precision': 0.522324172270692, 'recall': 0.5252283554416147, 'f1-score': 0.5219283364145634, 'support': 627341}, 'weighted avg': {'precision': 0.5289974970641025, 'recall': 0.5232321815408207, 'f1-score': 0.5241171991027811, 'support': 627341}}
[[106019  42266  44851]
 [ 63907 125813  60398]
 [ 42065  45609  96413]]
Evaluating performance on  train set...
1200/1200 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.937957
{'0': {'precision': 0.5092640357664862, 'recall': 0.5155807981894939, 'f1-score': 0.5124029498907848, 'support': 91908}, '1': {'precision': 0.61425606023291, 'recall': 0.5643313131313131, 'f1-score': 0.5882362850717229, 'support': 123750}, '2': {'precision': 0.49791733099489793, 'recall': 0.5464816151541002, 'f1-score': 0.5210703596717174, 'support': 91434}, 'accuracy': 0.5444264259570422, 'macro avg': {'precision': 0.5404791423314314, 'recall': 0.5421312421583023, 'f1-score': 0.5405698648780751, 'support': 307092}, 'weighted avg': {'precision': 0.5481946768240017, 'recall': 0.5444264259570422, 'f1-score': 0.5455424363461496, 'support': 307092}}
[[47386 21226 23296]
 [26825 69836 27089]
 [18837 22630 49967]]
Evaluating performance on  val set...
441/441 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9218764
{'0': {'precision': 0.498859825620389, 'recall': 0.5367761676577565, 'f1-score': 0.5171239067258089, 'support': 34642}, '1': {'precision': 0.6300827810550336, 'recall': 0.5736418688944879, 'f1-score': 0.6005391085042631, 'support': 45246}, '2': {'precision': 0.5116150119652133, 'recall': 0.5337331790781221, 'f1-score': 0.5224401001311241, 'support': 32846}, 'accuracy': 0.5506856848865471, 'macro avg': {'precision': 0.5468525395468786, 'recall': 0.5480504052101222, 'f1-score': 0.546701038453732, 'support': 112734}, 'weighted avg': {'precision': 0.555242733104183, 'recall': 0.5506856848865471, 'f1-score': 0.5521516703841456, 'support': 112734}}
[[18595  7695  8352]
 [10908 25955  8383]
 [ 7772  7543 17531]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
3337/3337 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9031756
{'0': {'precision': 0.4585286134928691, 'recall': 0.5890769515353311, 'f1-score': 0.5156685814681226, 'support': 216240}, '1': {'precision': 0.7066284915271166, 'recall': 0.5495947628721344, 'f1-score': 0.6182966552792565, 'support': 424813}, '2': {'precision': 0.48735598515914863, 'recall': 0.5625070433116712, 'f1-score': 0.5222417912009346, 'support': 212968}, 'accuracy': 0.5628116873004294, 'macro avg': {'precision': 0.5508376967263782, 'recall': 0.567059585906379, 'f1-score': 0.5520690093161046, 'support': 854021}, 'weighted avg': {'precision': 0.5891288694308227, 'recall': 0.5628116873004294, 'f1-score': 0.5683577111854324, 'support': 854021}}
[[127382  47220  41638]
 [106964 233475  84374]
 [ 43460  49712 119796]]
Evaluating performance on  train set...
1431/1431 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9149169
{'0': {'precision': 0.48295890114449086, 'recall': 0.5372460496613995, 'f1-score': 0.5086581114583433, 'support': 99675}, '1': {'precision': 0.6659593922092788, 'recall': 0.5801230604601391, 'f1-score': 0.620084810476206, 'support': 164472}, '2': {'precision': 0.49303285277881986, 'recall': 0.5413646661893506, 'f1-score': 0.5160696170873206, 'support': 101959}, 'accuracy': 0.5576554331259252, 'macro avg': {'precision': 0.5473170487108632, 'recall': 0.5529112587702963, 'f1-score': 0.5482708463406233, 'support': 366106}, 'weighted avg': {'precision': 0.5679768653436362, 'recall': 0.5576554331259252, 'f1-score': 0.5607802884871023, 'support': 366106}}
[[53550 22645 23480]
 [35781 95414 33277]
 [21548 25214 55197]]
Evaluating performance on  val set...
492/492 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9443936
{'0': {'precision': 0.49761162510056317, 'recall': 0.514651967029824, 'f1-score': 0.5059883683773247, 'support': 38459}, '1': {'precision': 0.6018120099445401, 'recall': 0.5193291525703441, 'f1-score': 0.557536430880985, 'support': 48476}, '2': {'precision': 0.49589134125636675, 'recall': 0.5638900329489291, 'f1-score': 0.52770918901991, 'support': 38848}, 'accuracy': 0.5316616712910329, 'macro avg': {'precision': 0.5317716587671567, 'recall': 0.5326237175163657, 'f1-score': 0.5304113294260734, 'support': 125783}, 'weighted avg': {'precision': 0.5372385084545719, 'recall': 0.5316616712910329, 'f1-score': 0.5325631385628871, 'support': 125783}}
[[19793  8288 10378]
 [11410 25175 11891]
 [ 8573  8369 21906]]
testing model on single stock: results/universal/W9/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
10303/10303 - 147s - 147s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1775632
{'0': {'precision': 0.40465370918272575, 'recall': 0.5312028579528816, 'f1-score': 0.45937211822322127, 'support': 857117}, '1': {'precision': 0.46121291495740835, 'recall': 0.09350105051812761, 'f1-score': 0.15548154452566199, 'support': 911455}, '2': {'precision': 0.3999008632281675, 'recall': 0.6109949909763913, 'f1-score': 0.4834077087234797, 'support': 868832}, 'accuracy': 0.4062240748857589, 'macro avg': {'precision': 0.42192249578943386, 'recall': 0.4118996331491335, 'f1-score': 0.366087123824121, 'support': 2637404}, 'weighted avg': {'precision': 0.4226341726395843, 'recall': 0.4062240748857589, 'f1-score': 0.3622691743117127, 'support': 2637404}}
[[455303  49265 352549]
 [382175  85222 444058]
 [287689  50291 530852]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1869016
{'0': {'precision': 0.402828562147575, 'recall': 0.503211575544858, 'f1-score': 0.4474591952383522, 'support': 288332}, '1': {'precision': 0.47642634379013027, 'recall': 0.08994562393932047, 'f1-score': 0.15132268966320941, 'support': 288730}, '2': {'precision': 0.40373451823281453, 'recall': 0.6236463910470593, 'f1-score': 0.4901542805842176, 'support': 298092}, 'accuracy': 0.40788935433078066, 'macro avg': {'precision': 0.42766314139017325, 'recall': 0.4056011968437459, 'f1-score': 0.3629787218285931, 'support': 875154}, 'weighted avg': {'precision': 0.4274184580459154, 'recall': 0.40788935433078066, 'f1-score': 0.36430076840856995, 'support': 875154}}
[[145092  14395 128845]
 [117048  25970 145712]
 [ 98043  14145 185904]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1958389
{'0': {'precision': 0.4025448047374325, 'recall': 0.5202984068110933, 'f1-score': 0.45390900199292544, 'support': 118630}, '1': {'precision': 0.4777938635408397, 'recall': 0.08426054801064066, 'f1-score': 0.14325720766764213, 'support': 121421}, '2': {'precision': 0.3925904416478104, 'recall': 0.6113210766540118, 'f1-score': 0.4781274187952065, 'support': 117215}, 'accuracy': 0.4019694009505522, 'macro avg': {'precision': 0.42430970330869416, 'recall': 0.4052933438252486, 'f1-score': 0.358431209485258, 'support': 357266}, 'weighted avg': {'precision': 0.42485315565640724, 'recall': 0.4019694009505522, 'f1-score': 0.3562761743706752, 'support': 357266}}
[[61723  5684 51223]
 [51548 10231 59642]
 [40061  5498 71656]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        64 (peak)  19.51 (ave)

============================================
