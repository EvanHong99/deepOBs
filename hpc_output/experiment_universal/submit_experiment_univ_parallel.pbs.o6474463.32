This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W10/deepLOB_L1/h300
Epoch 1/50
8543/8543 - 270s - loss: 3.2486 - accuracy300: 0.3966 - val_loss: 3.3193 - val_accuracy300: 0.3446 - 270s/epoch - 32ms/step
Epoch 2/50
8543/8543 - 188s - loss: 3.2292 - accuracy300: 0.4069 - val_loss: 3.3224 - val_accuracy300: 0.3451 - 188s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 189s - loss: 3.2199 - accuracy300: 0.4120 - val_loss: 3.3196 - val_accuracy300: 0.3489 - 189s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 188s - loss: 3.2124 - accuracy300: 0.4152 - val_loss: 3.3105 - val_accuracy300: 0.3471 - 188s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 189s - loss: 3.2058 - accuracy300: 0.4182 - val_loss: 3.3250 - val_accuracy300: 0.3404 - 189s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 189s - loss: 3.1999 - accuracy300: 0.4210 - val_loss: 3.4150 - val_accuracy300: 0.3308 - 189s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 189s - loss: 3.1950 - accuracy300: 0.4234 - val_loss: 3.3220 - val_accuracy300: 0.3428 - 189s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 190s - loss: 3.1910 - accuracy300: 0.4251 - val_loss: 3.3351 - val_accuracy300: 0.3452 - 190s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 188s - loss: 3.1875 - accuracy300: 0.4264 - val_loss: 3.3613 - val_accuracy300: 0.3407 - 188s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 190s - loss: 3.1835 - accuracy300: 0.4283 - val_loss: 3.3568 - val_accuracy300: 0.3439 - 190s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 190s - loss: 3.1800 - accuracy300: 0.4294 - val_loss: 3.3488 - val_accuracy300: 0.3421 - 190s/epoch - 22ms/step
Epoch 12/50
8543/8543 - 189s - loss: 3.1772 - accuracy300: 0.4308 - val_loss: 3.4527 - val_accuracy300: 0.3380 - 189s/epoch - 22ms/step
Epoch 13/50
8543/8543 - 189s - loss: 3.1751 - accuracy300: 0.4319 - val_loss: 3.3458 - val_accuracy300: 0.3340 - 189s/epoch - 22ms/step
Epoch 14/50
8543/8543 - 190s - loss: 3.1730 - accuracy300: 0.4326 - val_loss: 3.6499 - val_accuracy300: 0.3266 - 190s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 287s - 287s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1257238
{'0': {'precision': 0.36754501856918453, 'recall': 0.1429364043186598, 'f1-score': 0.20582752289913064, 'support': 3460518}, '1': {'precision': 0.27675114422155955, 'recall': 0.6796952208746093, 'f1-score': 0.3933444403441484, 'support': 2636926}, '2': {'precision': 0.3650514372725247, 'recall': 0.1824565270669855, 'f1-score': 0.24330611345866707, 'support': 3447835}, 'accuracy': 0.30549342769341786, 'macro avg': {'precision': 0.33644920002108963, 'recall': 0.33502938408675154, 'f1-score': 0.28082602556731534, 'support': 9545279}, 'weighted avg': {'precision': 0.34156210232567247, 'recall': 0.30549342769341786, 'f1-score': 0.27116749162424175, 'support': 9545279}}
[[ 494634 2346497  619387]
 [ 369823 1792306  474797]
 [ 481321 2337434  629080]]
Evaluating performance on  train set...
8543/8543 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077379
{'0': {'precision': 0.3393609350688778, 'recall': 0.04908903271138339, 'f1-score': 0.08577114905045082, 'support': 728676}, '1': {'precision': 0.330322342253635, 'recall': 0.8689680121174799, 'f1-score': 0.4786823275280141, 'support': 724243}, '2': {'precision': 0.33570544203005553, 'recall': 0.08055181173097338, 'f1-score': 0.12992773732655585, 'support': 733801}, 'accuracy': 0.3311914648423209, 'macro avg': {'precision': 0.3351295731175228, 'recall': 0.33286961885327887, 'f1-score': 0.23146040463500692, 'support': 2186720}, 'weighted avg': {'precision': 0.33514066817431853, 'recall': 0.3311914648423209, 'f1-score': 0.23072126578589022, 'support': 2186720}}
[[ 35770 636362  56544]
 [ 34478 629344  60421]
 [ 35156 639536  59109]]
Evaluating performance on  val set...
3077/3077 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038793
{'0': {'precision': 0.323506977161574, 'recall': 0.0287100011149515, 'f1-score': 0.05273956820850051, 'support': 251132}, '1': {'precision': 0.34996497081848915, 'recall': 0.8955663519862684, 'f1-score': 0.5032661106155492, 'support': 274988}, '2': {'precision': 0.32969142182194006, 'recall': 0.07705225382730818, 'f1-score': 0.12491143016968115, 'support': 260823}, 'accuracy': 0.3476452551201294, 'macro avg': {'precision': 0.3343877899340011, 'recall': 0.3337762023095094, 'f1-score': 0.22697236966457698, 'support': 786943}, 'weighted avg': {'precision': 0.3348021741064333, 'recall': 0.3476452551201294, 'f1-score': 0.23409129812506438, 'support': 786943}}
[[  7210 224248  19674]
 [  7532 246270  21186]
 [  7545 233181  20097]]
testing model out of sample: results/universal/W10/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 168s - 168s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.120341
{'0': {'precision': 0.3704620139693785, 'recall': 0.12758170820555395, 'f1-score': 0.18979930661943803, 'support': 2006714}, '1': {'precision': 0.26797921538807346, 'recall': 0.7697522062136648, 'f1-score': 0.3975548739691952, 'support': 1455888}, '2': {'precision': 0.3742786367595819, 'recall': 0.1100952508686581, 'f1-score': 0.17014253435747395, 'support': 1998197}, 'accuracy': 0.29239036265572127, 'macro avg': {'precision': 0.33757328870567793, 'recall': 0.33580972176262563, 'f1-score': 0.2524989049820357, 'support': 5460799}, 'weighted avg': {'precision': 0.3445359338387194, 'recall': 0.29239036265572127, 'f1-score': 0.23799568485532688, 'support': 5460799}}
[[ 256020 1537843  212851]
 [ 180282 1120673  154933]
 [ 254781 1523424  219992]]
Evaluating performance on  train set...
4055/4055 - 37s - 37s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1169547
{'0': {'precision': 0.33904494772067706, 'recall': 0.13793863179926955, 'f1-score': 0.19609646207994602, 'support': 354027}, '1': {'precision': 0.322527559355468, 'recall': 0.7091822980008268, 'f1-score': 0.44340147393458124, 'support': 333838}, '2': {'precision': 0.3445424545465952, 'recall': 0.15708136092558958, 'f1-score': 0.2157840038191859, 'support': 349615}, 'accuracy': 0.3282029533099433, 'macro avg': {'precision': 0.3353716538742468, 'recall': 0.334734096908562, 'f1-score': 0.28509397994457103, 'support': 1037480}, 'weighted avg': {'precision': 0.33558259562895354, 'recall': 0.3282029533099433, 'f1-score': 0.282308119608469, 'support': 1037480}}
[[ 48834 250822  54371]
 [ 46981 236752  50105]
 [ 48219 246478  54918]]
Evaluating performance on  val set...
1545/1545 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.122202
{'0': {'precision': 0.3272420995889765, 'recall': 0.18486684836396303, 'f1-score': 0.23626306802426555, 'support': 131354}, '1': {'precision': 0.32826926033515935, 'recall': 0.6354515835970052, 'f1-score': 0.4329038281979459, 'support': 127684}, '2': {'precision': 0.3589632006962766, 'recall': 0.19427822797294414, 'f1-score': 0.25210958877942324, 'support': 135867}, 'accuracy': 0.33379167141464405, 'macro avg': {'precision': 0.3381581868734708, 'recall': 0.3381988866446375, 'f1-score': 0.3070921616672116, 'support': 394905}, 'weighted avg': {'precision': 0.3384878494195969, 'recall': 0.33379167141464405, 'f1-score': 0.3052946023362069, 'support': 394905}}
[[24283 81761 25310]
 [24719 81137 21828]
 [25203 84268 26396]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.147257
{'0': {'precision': 0.48261758691206547, 'recall': 0.008787117192590524, 'f1-score': 0.017259978425026967, 'support': 53715}, '1': {'precision': 0.2542135250425081, 'recall': 0.5058917811878543, 'f1-score': 0.3383860944836554, 'support': 33691}, '2': {'precision': 0.34183878859195493, 'recall': 0.4884081054773914, 'f1-score': 0.40218599143820016, 'support': 45204}, 'accuracy': 0.2985747681170349, 'macro avg': {'precision': 0.35955663351550954, 'recall': 0.3343623346192787, 'f1-score': 0.25261068811562754, 'support': 132610}, 'weighted avg': {'precision': 0.3766004988515155, 'recall': 0.2985747681170349, 'f1-score': 0.2300588281978852, 'support': 132610}}
[[  472 27168 26075]
 [  214 17044 16433]
 [  292 22834 22078]]
Evaluating performance on  train set...
135/135 - 6s - 6s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.114716
{'0': {'precision': 0.3421678559293238, 'recall': 0.08661620505762944, 'f1-score': 0.13823872606218682, 'support': 11626}, '1': {'precision': 0.34061368871339254, 'recall': 0.7285764560971318, 'f1-score': 0.4642076349571164, 'support': 11366}, '2': {'precision': 0.350169779286927, 'recall': 0.21842732327243844, 'f1-score': 0.2690363606717756, 'support': 11331}, 'accuracy': 0.3427147976575474, 'macro avg': {'precision': 0.34431710797654774, 'recall': 0.3445399948090666, 'f1-score': 0.29049424056369294, 'support': 34323}, 'weighted avg': {'precision': 0.34429485907557345, 'recall': 0.3427147976575474, 'f1-score': 0.28936277163690405, 'support': 34323}}
[[1007 8209 2410]
 [ 902 8281 2183]
 [1034 7822 2475]]
Evaluating performance on  val set...
46/46 - 1s - 630ms/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.135549
{'0': {'precision': 0.35403726708074534, 'recall': 0.03679001721170396, 'f1-score': 0.06665367374780745, 'support': 4648}, '1': {'precision': 0.27349768875192604, 'recall': 0.6972176759410802, 'f1-score': 0.39288019920686157, 'support': 3055}, '2': {'precision': 0.3389035473468191, 'recall': 0.29052525760241266, 'f1-score': 0.31285520974289577, 'support': 3979}, 'accuracy': 0.29592535524738917, 'macro avg': {'precision': 0.3221461677264968, 'recall': 0.3415109835850656, 'f1-score': 0.25746302756585493, 'support': 11682}, 'weighted avg': {'precision': 0.3278203964579209, 'recall': 0.29592535524738917, 'f1-score': 0.23582487277210692, 'support': 11682}}
[[ 171 3026 1451]
 [ 121 2130  804]
 [ 191 2632 1156]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1282171
{'0': {'precision': 0.35205105220472105, 'recall': 0.19584213900695746, 'f1-score': 0.25167836435764424, 'support': 168452}, '1': {'precision': 0.22740583530237682, 'recall': 0.5622539014159207, 'f1-score': 0.323835222079001, 'support': 124442}, '2': {'precision': 0.34157803966657085, 'recall': 0.13346773514232926, 'f1-score': 0.1919379131284499, 'support': 178073}, 'accuracy': 0.26907405402077006, 'macro avg': {'precision': 0.3070116423912229, 'recall': 0.2971879251884025, 'f1-score': 0.25581716652169834, 'support': 470967}, 'weighted avg': {'precision': 0.3151566183198256, 'recall': 0.26907405402077006, 'f1-score': 0.2481562116735385, 'support': 470967}}
[[ 32990 116983  18479]
 [ 27140  69968  27334]
 [ 33578 120728  23767]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1073635
{'0': {'precision': 0.31914191419141913, 'recall': 0.09597538583693117, 'f1-score': 0.14757163023158218, 'support': 40302}, '1': {'precision': 0.3938566699625983, 'recall': 0.6750046048996132, 'f1-score': 0.4974547626481328, 'support': 54290}, '2': {'precision': 0.28799153355160895, 'recall': 0.21338430248229556, 'f1-score': 0.24513695352306958, 'support': 40809}, 'accuracy': 0.3635275958080073, 'macro avg': {'precision': 0.3336633725685421, 'recall': 0.32812143107294667, 'f1-score': 0.29672111546759483, 'support': 135401}, 'weighted avg': {'precision': 0.33971080369214146, 'recall': 0.3635275958080073, 'f1-score': 0.31726534399364337, 'support': 135401}}
[[ 3868 27835  8599]
 [ 4714 36646 12930]
 [ 3538 28563  8708]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1087158
{'0': {'precision': 0.32266350523611936, 'recall': 0.0929848536613142, 'f1-score': 0.14436635282676924, 'support': 17562}, '1': {'precision': 0.33448523471860697, 'recall': 0.8441021575400646, 'f1-score': 0.47911543962843317, 'support': 17659}, '2': {'precision': 0.3908012727798669, 'recall': 0.07563966183304406, 'f1-score': 0.12674734965756637, 'support': 17861}, 'accuracy': 0.33702573377039297, 'macro avg': {'precision': 0.3493166709115311, 'recall': 0.33757555767814096, 'f1-score': 0.25007638070425625, 'support': 53082}, 'weighted avg': {'precision': 0.3495232427559966, 'recall': 0.33702573377039297, 'f1-score': 0.2498002307557367, 'support': 53082}}
[[ 1633 14838  1091]
 [ 1738 14906  1015]
 [ 1690 14820  1351]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
967/967 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1229756
{'0': {'precision': 0.38945392904710013, 'recall': 0.1329997829165676, 'f1-score': 0.1982846971249798, 'support': 96737}, '1': {'precision': 0.2681379195508932, 'recall': 0.654963539699602, 'f1-score': 0.38050110127511627, 'support': 68842}, '2': {'precision': 0.3259326385742335, 'recall': 0.18430941922889213, 'f1-score': 0.2354664983204346, 'support': 81960}, 'accuracy': 0.29514945119758906, 'macro avg': {'precision': 0.3278414957240756, 'recall': 0.3240909139483539, 'f1-score': 0.27141743224017684, 'support': 247539}, 'weighted avg': {'precision': 0.33468340119939116, 'recall': 0.29514945119758906, 'f1-score': 0.2612709826011398, 'support': 247539}}
[[12866 66625 17246]
 [ 9758 45089 13995]
 [10412 56442 15106]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1095762
{'0': {'precision': 0.3190546528803545, 'recall': 0.06229092167493367, 'f1-score': 0.10423201273946822, 'support': 17338}, '1': {'precision': 0.3313617606602476, 'recall': 0.7457434733257662, 'f1-score': 0.45884257642614523, 'support': 19382}, '2': {'precision': 0.3285097192224622, 'recall': 0.15564082885648503, 'f1-score': 0.21121333101892034, 'support': 19545}, 'accuracy': 0.33015195947747267, 'macro avg': {'precision': 0.3263087109210214, 'recall': 0.32122507461906163, 'f1-score': 0.25809597339484464, 'support': 56265}, 'weighted avg': {'precision': 0.3265786133290594, 'recall': 0.33015195947747267, 'f1-score': 0.2635497379886829, 'support': 56265}}
[[ 1080 13713  2545]
 [ 1255 14454  3673]
 [ 1050 15453  3042]]
Evaluating performance on  val set...
79/79 - 1s - 827ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1160953
{'0': {'precision': 0.37100213219616207, 'recall': 0.10286727756429205, 'f1-score': 0.16107382550335572, 'support': 6766}, '1': {'precision': 0.33918172880586855, 'recall': 0.6582036982682712, 'f1-score': 0.44767180715675997, 'support': 6814}, '2': {'precision': 0.3250711093051605, 'recall': 0.24840863219996895, 'f1-score': 0.2816157704831471, 'support': 6441}, 'accuracy': 0.33869437091054394, 'macro avg': {'precision': 0.34508499010239707, 'recall': 0.3364932026775107, 'f1-score': 0.2967871343810876, 'support': 20021}, 'weighted avg': {'precision': 0.34539572157019927, 'recall': 0.33869437091054394, 'f1-score': 0.2973951538386603, 'support': 20021}}
[[ 696 4444 1626]
 [ 633 4485 1696]
 [ 547 4294 1600]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1261855
{'0': {'precision': 0.33144204805687527, 'recall': 0.1326774939455717, 'f1-score': 0.1894981630579223, 'support': 146174}, '1': {'precision': 0.2607273535892615, 'recall': 0.5530712362133141, 'f1-score': 0.3543894068413691, 'support': 116598}, '2': {'precision': 0.3531168792377311, 'recall': 0.247125715958025, 'f1-score': 0.2907633090251731, 'support': 143514}, 'accuracy': 0.29375119989367093, 'macro avg': {'precision': 0.3150954269612893, 'recall': 0.3109581487056369, 'f1-score': 0.2782169596414882, 'support': 406286}, 'weighted avg': {'precision': 0.31880427510027454, 'recall': 0.29375119989367093, 'f1-score': 0.272589767004419, 'support': 406286}}
[[19394 91511 35269]
 [22409 64487 29702]
 [16711 91337 35466]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077907
{'0': {'precision': 0.3280331082552821, 'recall': 0.062298337056341524, 'f1-score': 0.10471058578133148, 'support': 24174}, '1': {'precision': 0.3316026049933985, 'recall': 0.8970983665770358, 'f1-score': 0.4842189632389576, 'support': 24917}, '2': {'precision': 0.3630372492836676, 'recall': 0.04799424220614417, 'f1-score': 0.08478035397637926, 'support': 26399}, 'accuracy': 0.33283878659425087, 'macro avg': {'precision': 0.3408909875107827, 'recall': 0.33579698194650714, 'f1-score': 0.22456996766555612, 'support': 75490}, 'weighted avg': {'precision': 0.3414523090664093, 'recall': 0.33283878659425087, 'f1-score': 0.22300535398497084, 'support': 75490}}
[[ 1506 21543  1125]
 [ 1466 22353  1098]
 [ 1619 23513  1267]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1168346
{'0': {'precision': 0.32991803278688525, 'recall': 0.04760965993100049, 'f1-score': 0.08321130157636317, 'support': 10145}, '1': {'precision': 0.3410535481062255, 'recall': 0.650178438044651, 'f1-score': 0.44741426082983526, 'support': 12049}, '2': {'precision': 0.2807174887892377, 'recall': 0.22437275985663083, 'f1-score': 0.24940239043824702, 'support': 11160}, 'accuracy': 0.3244288541104515, 'macro avg': {'precision': 0.3172296898941161, 'recall': 0.3073869526107608, 'f1-score': 0.2600093176148151, 'support': 33354}, 'weighted avg': {'precision': 0.31747855785341356, 'recall': 0.3244288541104515, 'f1-score': 0.27038447444149805, 'support': 33354}}
[[ 483 6978 2684]
 [ 483 7834 3732]
 [ 498 8158 2504]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
2104/2104 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1296899
{'0': {'precision': 0.36345296241240177, 'recall': 0.09737710514337733, 'f1-score': 0.15360107695759478, 'support': 210912}, '1': {'precision': 0.23372228254578925, 'recall': 0.6740154977150805, 'f1-score': 0.3470879895556015, 'support': 125825}, '2': {'precision': 0.37281765174713705, 'recall': 0.22018194070080863, 'f1-score': 0.2768558870347238, 'support': 201824}, 'accuracy': 0.27811891317789444, 'macro avg': {'precision': 0.3233309655684427, 'recall': 0.33052484785308883, 'f1-score': 0.25918165118263997, 'support': 538561}, 'weighted avg': {'precision': 0.33665313150388276, 'recall': 0.27811891317789444, 'f1-score': 0.24499512436661752, 'support': 538561}}
[[ 20538 144306  46068]
 [ 12328  84808  28689]
 [ 23642 133744  44438]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1217756
{'0': {'precision': 0.3317585729412723, 'recall': 0.11101117470700464, 'f1-score': 0.16635693426184983, 'support': 36690}, '1': {'precision': 0.32838923883700005, 'recall': 0.5913777206560309, 'f1-score': 0.4222854007681182, 'support': 35791}, '2': {'precision': 0.342978359735067, 'recall': 0.30359603382595307, 'f1-score': 0.3220878238936024, 'support': 37013}, 'accuracy': 0.33313240908177616, 'macro avg': {'precision': 0.3343753905044465, 'recall': 0.3353283097296629, 'f1-score': 0.3035767196411902, 'support': 109494}, 'weighted avg': {'precision': 0.33444991796175483, 'recall': 0.33313240908177616, 'f1-score': 0.30265666906618527, 'support': 109494}}
[[ 4073 21496 11121]
 [ 4220 21166 10405]
 [ 3984 21792 11237]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1303464
{'0': {'precision': 0.3288179325915175, 'recall': 0.16799868171706353, 'f1-score': 0.2223797578798124, 'support': 12137}, '1': {'precision': 0.3027120717781403, 'recall': 0.5393278837420526, 'f1-score': 0.38777509305818586, 'support': 11010}, '2': {'precision': 0.3593502377179081, 'recall': 0.28419238602537994, 'f1-score': 0.3173825562068061, 'support': 12766}, 'accuracy': 0.3231420377022248, 'macro avg': {'precision': 0.3302934140291886, 'recall': 0.33050631716149875, 'f1-score': 0.30917913571493477, 'support': 35913}, 'weighted avg': {'precision': 0.3316678721590339, 'recall': 0.3231420377022248, 'f1-score': 0.30685636422727136, 'support': 35913}}
[[2039 6779 3319]
 [1923 5938 3149]
 [2239 6899 3628]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
5267/5267 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1156781
{'0': {'precision': 0.3791469819736599, 'recall': 0.18777531360152672, 'f1-score': 0.2511612049723467, 'support': 459022}, '1': {'precision': 0.31495960766746706, 'recall': 0.6456328370375698, 'f1-score': 0.4233809378191134, 'support': 417090}, '2': {'precision': 0.38124092587995456, 'recall': 0.21470861745011938, 'f1-score': 0.2747068540524133, 'support': 472077}, 'accuracy': 0.3388538253909504, 'macro avg': {'precision': 0.35844917184036046, 'recall': 0.3493722560297386, 'f1-score': 0.3164163322812911, 'support': 1348189}, 'weighted avg': {'precision': 0.3600225052186069, 'recall': 0.3388538253909504, 'f1-score': 0.31268558156481885, 'support': 1348189}}
[[ 86193 290098  82731]
 [ 66027 269287  81776]
 [ 75114 295604 101359]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048098
{'0': {'precision': 0.3751988430947216, 'recall': 0.05755643059175864, 'f1-score': 0.09980285618117998, 'support': 90155}, '1': {'precision': 0.33141838605849994, 'recall': 0.8665742738032702, 'f1-score': 0.4794664555905287, 'support': 89473}, '2': {'precision': 0.37757622210866976, 'recall': 0.09676433677088449, 'f1-score': 0.15404928812793717, 'support': 91635}, 'accuracy': 0.3376464906751013, 'macro avg': {'precision': 0.3613978170872971, 'recall': 0.3402983470553045, 'f1-score': 0.24443953329988197, 'support': 271263}, 'weighted avg': {'precision': 0.36156145905613646, 'recall': 0.3376464906751013, 'f1-score': 0.24335547124992785, 'support': 271263}}
[[ 5189 78067  6899]
 [ 4220 77535  7718]
 [ 4421 78347  8867]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0993955
{'0': {'precision': 0.3143074581430746, 'recall': 0.02611114623506354, 'f1-score': 0.04821668320588407, 'support': 31634}, '1': {'precision': 0.36105988647017007, 'recall': 0.9369102039725186, 'f1-score': 0.5212457426714457, 'support': 37407}, '2': {'precision': 0.3311775801670709, 'recall': 0.035763131092681505, 'f1-score': 0.06455510032566446, 'support': 34365}, 'accuracy': 0.3587992959789567, 'macro avg': {'precision': 0.33551497492677185, 'recall': 0.33292816043342116, 'f1-score': 0.21133917540099809, 'support': 103406}, 'weighted avg': {'precision': 0.336826555968987, 'recall': 0.3587992959789567, 'f1-score': 0.22476415367906277, 'support': 103406}}
[[  826 29762  1046]
 [  924 35047  1436]
 [  878 32258  1229]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
10110/10110 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.120167
{'0': {'precision': 0.35032903386401804, 'recall': 0.10368442679085056, 'f1-score': 0.1600114014769076, 'support': 963732}, '1': {'precision': 0.24842962348977296, 'recall': 0.8283084018832287, 'f1-score': 0.3822217467280054, 'support': 646974}, '2': {'precision': 0.41201130734291164, 'recall': 0.061437801502974745, 'f1-score': 0.10693047444621824, 'support': 977395}, 'accuracy': 0.2688716553179339, 'macro avg': {'precision': 0.33692332156556754, 'recall': 0.33114354339235136, 'f1-score': 0.21638787421704375, 'support': 2588101}, 'weighted avg': {'precision': 0.3481504776791691, 'recall': 0.2688716553179339, 'f1-score': 0.19551360298810175, 'support': 2588101}}
[[ 99924 811325  52483]
 [ 77866 535894  33214]
 [107439 809907  60049]]
Evaluating performance on  train set...
1686/1686 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.119735
{'0': {'precision': 0.34661829281353757, 'recall': 0.1738479409651579, 'f1-score': 0.23155729457797652, 'support': 148929}, '1': {'precision': 0.3207523111252789, 'recall': 0.6637251812165144, 'f1-score': 0.4324961971874709, 'support': 136439}, '2': {'precision': 0.35557135574575405, 'recall': 0.18129274965800274, 'f1-score': 0.24014460320192804, 'support': 146200}, 'accuracy': 0.3312432803173544, 'macro avg': {'precision': 0.3409806532281902, 'recall': 0.3396219572798917, 'f1-score': 0.3013993649891252, 'support': 431568}, 'weighted avg': {'precision': 0.3414738176094579, 'recall': 0.3312432803173544, 'f1-score': 0.29799263606288395, 'support': 431568}}
[[25891 97342 25696]
 [23540 90558 22341]
 [25265 94430 26505]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1249425
{'0': {'precision': 0.3454938197527901, 'recall': 0.13864231022360626, 'f1-score': 0.19787848240469208, 'support': 62297}, '1': {'precision': 0.29326894565171346, 'recall': 0.6664484703798541, 'f1-score': 0.4073045606438556, 'support': 51941}, '2': {'precision': 0.3613964686998395, 'recall': 0.20413745164410058, 'f1-score': 0.2609023137239755, 'support': 66176}, 'accuracy': 0.31462081656634183, 'macro avg': {'precision': 0.33338641136811437, 'recall': 0.336409410749187, 'f1-score': 0.2886951189241744, 'support': 180414}, 'weighted avg': {'precision': 0.33629143806974954, 'recall': 0.31462081656634183, 'f1-score': 0.2812892209904188, 'support': 180414}}
[[ 8637 40351 13309]
 [ 6763 34616 10562]
 [ 9599 43068 13509]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
6546/6546 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1249802
{'0': {'precision': 0.33536798581673405, 'recall': 0.09560752436183534, 'f1-score': 0.1487959390586618, 'support': 571796}, '1': {'precision': 0.3310352946522065, 'recall': 0.584170847403266, 'f1-score': 0.4225958714897875, 'support': 548747}, '2': {'precision': 0.3367848522588253, 'recall': 0.3302168846559779, 'f1-score': 0.33346853106152646, 'support': 555226}, 'accuracy': 0.3333245811326024, 'macro avg': {'precision': 0.3343960442425886, 'recall': 0.33666508547369306, 'f1-score': 0.30162011386999193, 'support': 1675769}, 'weighted avg': {'precision': 0.33441864841325875, 'recall': 0.3333245811326024, 'f1-score': 0.2996412620650938, 'support': 1675769}}
[[ 54668 328481 188647]
 [ 55779 320562 172406]
 [ 52562 319319 183345]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.121189
{'0': {'precision': 0.3395807302512842, 'recall': 0.13339756583073525, 'f1-score': 0.19154892811694457, 'support': 110017}, '1': {'precision': 0.31266197435537235, 'recall': 0.6523452897122586, 'f1-score': 0.42271923505141135, 'support': 98943}, '2': {'precision': 0.3417338554864471, 'recall': 0.2103014837917021, 'f1-score': 0.26037150797133246, 'support': 105810}, 'accuracy': 0.3223718905867776, 'macro avg': {'precision': 0.33132552003103455, 'recall': 0.33201477977823196, 'f1-score': 0.2915465570465628, 'support': 314770}, 'weighted avg': {'precision': 0.33184301609975575, 'recall': 0.3223718905867776, 'f1-score': 0.2873484034589712, 'support': 314770}}
[[14676 73022 22319]
 [13854 64545 20544]
 [14688 68870 22252]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1128138
{'0': {'precision': 0.3221183800623053, 'recall': 0.013612427593470247, 'f1-score': 0.026121005431350257, 'support': 37980}, '1': {'precision': 0.35549512267218447, 'recall': 0.7692071532734669, 'f1-score': 0.4862609370704016, 'support': 39087}, '2': {'precision': 0.3371248257136567, 'recall': 0.25264663018670774, 'f1-score': 0.2888354474151617, 'support': 36367}, 'accuracy': 0.35060916480067705, 'macro avg': {'precision': 0.33824610948271555, 'recall': 0.3451554036845483, 'f1-score': 0.26707246330563783, 'support': 113434}, 'weighted avg': {'precision': 0.3384303865805894, 'recall': 0.35060916480067705, 'f1-score': 0.26890205537758216, 'support': 113434}}
[[  517 27842  9621]
 [  576 30066  8445]
 [  512 26667  9188]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
7633/7633 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158148
{'0': {'precision': 0.386984723241838, 'recall': 0.17864698408786153, 'f1-score': 0.24444758948045678, 'support': 681618}, '1': {'precision': 0.3069621184619762, 'recall': 0.7544681305507135, 'f1-score': 0.43637937750749944, 'support': 580556}, '2': {'precision': 0.3699159624302629, 'recall': 0.11357387968442385, 'f1-score': 0.17378975668505087, 'support': 691814}, 'accuracy': 0.32669187323565957, 'macro avg': {'precision': 0.35462093471135897, 'recall': 0.34889633144099963, 'f1-score': 0.2848722412243357, 'support': 1953988}, 'weighted avg': {'precision': 0.35716570130686376, 'recall': 0.32669187323565957, 'f1-score': 0.2764565236153168, 'support': 1953988}}
[[121769 488577  71272]
 [ 79984 438011  62561]
 [112908 500334  78572]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1136246
{'0': {'precision': 0.3351808691905443, 'recall': 0.1227302716502682, 'f1-score': 0.17967171120664763, 'support': 139444}, '1': {'precision': 0.32018766722512565, 'recall': 0.7827984105150543, 'f1-score': 0.4544797110837024, 'support': 130860}, '2': {'precision': 0.3246850156415923, 'recall': 0.08347475761108569, 'f1-score': 0.13280585082966972, 'support': 135526}, 'accuracy': 0.3224601434098021, 'macro avg': {'precision': 0.3266845173524207, 'recall': 0.32966781325880273, 'f1-score': 0.25565242437333996, 'support': 405830}, 'weighted avg': {'precision': 0.32684124063358705, 'recall': 0.3224601434098021, 'f1-score': 0.2526328828067292, 'support': 405830}}
[[ 17114 110313  12017]
 [ 16910 102437  11513]
 [ 17035 107178  11313]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1171871
{'0': {'precision': 0.31233783883960564, 'recall': 0.277765569375467, 'f1-score': 0.29403896481535324, 'support': 45506}, '1': {'precision': 0.3847442006833303, 'recall': 0.6239610673665792, 'f1-score': 0.4759872080088987, 'support': 54864}, '2': {'precision': 0.370109007458405, 'recall': 0.1387162670680572, 'f1-score': 0.20179870180652226, 'support': 46505}, 'accuracy': 0.3630570212765957, 'macro avg': {'precision': 0.35573034899378037, 'recall': 0.3468143012700345, 'f1-score': 0.32394162487692474, 'support': 146875}, 'weighted avg': {'precision': 0.35767673812683204, 'recall': 0.3630570212765957, 'f1-score': 0.33279828385089366, 'support': 146875}}
[[12640 27357  5509]
 [15161 34233  5470]
 [12668 27386  6451]]
testing model on single stock: results/universal/W10/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
22048/22048 - 167s - 167s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128154
{'0': {'precision': 0.3754479449648931, 'recall': 0.14251132584486406, 'f1-score': 0.20660151265958784, 'support': 2115074}, '1': {'precision': 0.26059378690428553, 'recall': 0.7468471360072277, 'f1-score': 0.3863724789901906, 'support': 1430049}, '2': {'precision': 0.38301954105776154, 'recall': 0.13554666749247837, 'f1-score': 0.2002329558650686, 'support': 2098945}, 'accuracy': 0.29304306751796755, 'macro avg': {'precision': 0.3396870909756467, 'recall': 0.3416350431148567, 'f1-score': 0.2644023158382824, 'support': 5644068}, 'weighted avg': {'precision': 0.34916287715223243, 'recall': 0.29304306751796755, 'f1-score': 0.2497820767826707, 'support': 5644068}}
[[ 301422 1519334  294318]
 [ 198049 1068028  163972]
 [ 303362 1511078  284505]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1054536
{'0': {'precision': 0.3341940008287909, 'recall': 0.022593464187505928, 'f1-score': 0.04232547905829443, 'support': 464028}, '1': {'precision': 0.32839148572072596, 'recall': 0.9380272436599361, 'f1-score': 0.48647442278850356, 'support': 456620}, '2': {'precision': 0.3331547245112893, 'recall': 0.038433500728981045, 'f1-score': 0.06891662048273357, 'support': 469148}, 'accuracy': 0.3287079542609131, 'macro avg': {'precision': 0.3319134036869354, 'recall': 0.33301806952547436, 'f1-score': 0.19923884077651055, 'support': 1389796}, 'weighted avg': {'precision': 0.33193674950957014, 'recall': 0.3287079542609131, 'f1-score': 0.19722768880928004, 'support': 1389796}}
[[ 10484 435610  17934]
 [ 10141 428322  18157]
 [ 10746 440371  18031]]
Evaluating performance on  val set...
1890/1890 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014434
{'0': {'precision': 0.3212934296525628, 'recall': 0.024289550162212067, 'f1-score': 0.04516468305538597, 'support': 153811}, '1': {'precision': 0.34841545345353275, 'recall': 0.9383598165724646, 'f1-score': 0.5081525400889368, 'support': 168786}, '2': {'precision': 0.3169921539430731, 'recall': 0.03436394114360216, 'f1-score': 0.06200603816704102, 'support': 161070}, 'accuracy': 0.3466289823370211, 'macro avg': {'precision': 0.3289003456830562, 'recall': 0.3323377692927596, 'f1-score': 0.20510775377045462, 'support': 483667}, 'weighted avg': {'precision': 0.32932583920447145, 'recall': 0.3466289823370211, 'f1-score': 0.212342732219582, 'support': 483667}}
[[  3736 144605   5470]
 [  3948 158382   6456]
 [  3944 151591   5535]]
training model: results/universal/W10/deepLOB_L1/h500
Epoch 1/50
8543/8543 - 192s - loss: 3.2299 - accuracy500: 0.4093 - val_loss: 3.3605 - val_accuracy500: 0.3331 - 192s/epoch - 23ms/step
Epoch 2/50
8543/8543 - 188s - loss: 3.2106 - accuracy500: 0.4197 - val_loss: 3.4123 - val_accuracy500: 0.3306 - 188s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 189s - loss: 3.1969 - accuracy500: 0.4258 - val_loss: 3.3536 - val_accuracy500: 0.3344 - 189s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 189s - loss: 3.1862 - accuracy500: 0.4306 - val_loss: 3.4100 - val_accuracy500: 0.3387 - 189s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 189s - loss: 3.1779 - accuracy500: 0.4342 - val_loss: 3.4854 - val_accuracy500: 0.3325 - 189s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 189s - loss: 3.1708 - accuracy500: 0.4370 - val_loss: 3.5753 - val_accuracy500: 0.3296 - 189s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 190s - loss: 3.1629 - accuracy500: 0.4401 - val_loss: 3.4221 - val_accuracy500: 0.3338 - 190s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 190s - loss: 3.1575 - accuracy500: 0.4419 - val_loss: 3.5409 - val_accuracy500: 0.3319 - 190s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 189s - loss: 3.1522 - accuracy500: 0.4438 - val_loss: 3.6979 - val_accuracy500: 0.3312 - 189s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 190s - loss: 3.1476 - accuracy500: 0.4455 - val_loss: 3.5151 - val_accuracy500: 0.3334 - 190s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 190s - loss: 3.1444 - accuracy500: 0.4468 - val_loss: 3.7403 - val_accuracy500: 0.3207 - 190s/epoch - 22ms/step
Epoch 12/50
8543/8543 - 190s - loss: 3.1416 - accuracy500: 0.4477 - val_loss: 3.6313 - val_accuracy500: 0.3269 - 190s/epoch - 22ms/step
Epoch 13/50
8543/8543 - 190s - loss: 3.1381 - accuracy500: 0.4488 - val_loss: 3.4238 - val_accuracy500: 0.3369 - 190s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 284s - 284s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1365726
{'0': {'precision': 0.3640633032863654, 'recall': 0.37691210732198044, 'f1-score': 0.3703763036552234, 'support': 3520919}, '1': {'precision': 0.26521973915133634, 'recall': 0.38207277554089125, 'f1-score': 0.31309876003730347, 'support': 2529806}, '2': {'precision': 0.3735122590255288, 'recall': 0.24109686100143252, 'f1-score': 0.29304034145363345, 'support': 3494554}, 'accuracy': 0.32855749947172835, 'macro avg': {'precision': 0.3342651004877435, 'recall': 0.33336058128810137, 'f1-score': 0.3255051350487201, 'support': 9545279}, 'weighted avg': {'precision': 0.34132586883986415, 'recall': 0.32855749947172835, 'f1-score': 0.32688299460000453, 'support': 9545279}}
[[1327077 1347350  846492]
 [ 996569  966570  566667]
 [1321536 1330492  842526]]
Evaluating performance on  train set...
8543/8543 - 71s - 71s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.119617
{'0': {'precision': 0.3316690690643457, 'recall': 0.4033300589256755, 'f1-score': 0.3640061602123769, 'support': 731939}, '1': {'precision': 0.3268084278392226, 'recall': 0.4872249743383764, 'f1-score': 0.3912105509223099, 'support': 717024}, '2': {'precision': 0.34409372035000174, 'recall': 0.10617994814010576, 'f1-score': 0.16228287789785303, 'support': 737757}, 'accuracy': 0.33058644911099727, 'macro avg': {'precision': 0.33419040575118997, 'recall': 0.3322449938013859, 'f1-score': 0.30583319634417994, 'support': 2186720}, 'weighted avg': {'precision': 0.33426710495588596, 'recall': 0.33058644911099727, 'f1-score': 0.30486893068773857, 'support': 2186720}}
[[295213 358924  77802]
 [296153 349352  71519]
 [298717 360705  78335]]
Evaluating performance on  val set...
3077/3077 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185446
{'0': {'precision': 0.3193638769765736, 'recall': 0.389187975787745, 'f1-score': 0.3508355255450353, 'support': 253921}, '1': {'precision': 0.34272056086987135, 'recall': 0.5097946068878324, 'f1-score': 0.4098861819915219, 'support': 267341}, '2': {'precision': 0.34522407875948796, 'recall': 0.10374095249566209, 'f1-score': 0.15953970693362737, 'support': 265681}, 'accuracy': 0.3337903761771818, 'macro avg': {'precision': 0.335769505535311, 'recall': 0.3342411783904132, 'f1-score': 0.3067538048233948, 'support': 786943}, 'weighted avg': {'precision': 0.3360293324143938, 'recall': 0.3337903761771818, 'f1-score': 0.3063126022336426, 'support': 786943}}
[[ 98823 127587  27511]
 [106287 136289  24765]
 [104327 133792  27562]]
testing model out of sample: results/universal/W10/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1297657
{'0': {'precision': 0.35480835649703163, 'recall': 0.3814688041682915, 'f1-score': 0.3676558956128274, 'support': 1959172}, '1': {'precision': 0.28606277707782174, 'recall': 0.4328990432501665, 'f1-score': 0.3444864497811051, 'support': 1545127}, '2': {'precision': 0.36799774053998735, 'recall': 0.19113161257347303, 'f1-score': 0.25159116108336205, 'support': 1956500}, 'accuracy': 0.32782675209250517, 'macro avg': {'precision': 0.3362896247049469, 'recall': 0.33516648666397697, 'f1-score': 0.32124450215909817, 'support': 5460799}, 'weighted avg': {'precision': 0.3400823757364831, 'recall': 0.32782675209250517, 'f1-score': 0.3195163487376301, 'support': 5460799}}
[[747363 837848 373961]
 [607981 668884 268262]
 [751041 831510 373949]]
Evaluating performance on  train set...
4055/4055 - 39s - 39s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1277602
{'0': {'precision': 0.3381700983772677, 'recall': 0.40899419564588335, 'f1-score': 0.37022542025546595, 'support': 352494}, '1': {'precision': 0.32676982552828543, 'recall': 0.38424880490678126, 'f1-score': 0.35318600544126777, 'support': 337003}, '2': {'precision': 0.34673771407297094, 'recall': 0.2141110341597147, 'f1-score': 0.264742930340065, 'support': 347983}, 'accuracy': 0.3355900836642634, 'macro avg': {'precision': 0.33722587932617465, 'recall': 0.3357846782374598, 'f1-score': 0.32938478534559956, 'support': 1037480}, 'weighted avg': {'precision': 0.33734064476053516, 'recall': 0.3355900836642634, 'f1-score': 0.3293104655586427, 'support': 1037480}}
[[144168 134417  73909]
 [141046 129493  66464]
 [141104 132372  74507]]
Evaluating performance on  val set...
1545/1545 - 16s - 16s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1323749
{'0': {'precision': 0.30971982669203457, 'recall': 0.418877755511022, 'f1-score': 0.35612181267399734, 'support': 124750}, '1': {'precision': 0.36207785792635533, 'recall': 0.3580952928329214, 'f1-score': 0.36007556356622467, 'support': 139192}, '2': {'precision': 0.3599466829328905, 'recall': 0.24331299680062307, 'f1-score': 0.2903549136634926, 'support': 130963}, 'accuracy': 0.3392309542801433, 'macro avg': {'precision': 0.3439147891837602, 'recall': 0.34009534838152217, 'f1-score': 0.3355174299679049, 'support': 394905}, 'weighted avg': {'precision': 0.34483125566213824, 'recall': 0.3392309542801433, 'f1-score': 0.335705003818901, 'support': 394905}}
[[52255 42315 30180]
 [62866 49844 26482]
 [53596 45502 31865]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1530269
{'0': {'precision': 0.8148148148148148, 'recall': 0.0058275940361764925, 'f1-score': 0.011572421566785647, 'support': 52852}, '1': {'precision': 0.28211578396447806, 'recall': 0.4641537735062915, 'f1-score': 0.3509324596774193, 'support': 36001}, '2': {'precision': 0.330872179833153, 'recall': 0.5520031080741367, 'f1-score': 0.4137446684595488, 'support': 43757}, 'accuracy': 0.3104743232033783, 'macro avg': {'precision': 0.475934259537482, 'recall': 0.3406614918722015, 'f1-score': 0.25874984990125127, 'support': 132610}, 'weighted avg': {'precision': 0.5105121552225098, 'recall': 0.3104743232033783, 'f1-score': 0.2364057805842622, 'support': 132610}}
[[  308 22954 29590]
 [   34 16710 19257]
 [   36 19567 24154]]
Evaluating performance on  train set...
135/135 - 9s - 9s/epoch - 64ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273768
{'0': {'precision': 0.3339984038308061, 'recall': 0.28576305906452715, 'f1-score': 0.3080036798528059, 'support': 11716}, '1': {'precision': 0.33592400690846286, 'recall': 0.4469683577868128, 'f1-score': 0.3835709951456311, 'support': 11314}, '2': {'precision': 0.3427798810167658, 'recall': 0.2806163109891083, 'f1-score': 0.3085986951017625, 'support': 11293}, 'accuracy': 0.337208285988987, 'macro avg': {'precision': 0.33756743058534494, 'recall': 0.33778257594681604, 'f1-score': 0.3333911233667332, 'support': 34323}, 'weighted avg': {'precision': 0.3375224400479681, 'recall': 0.337208285988987, 'f1-score': 0.333108947819752, 'support': 34323}}
[[3348 5163 3205]
 [3386 5057 2871]
 [3290 4834 3169]]
Evaluating performance on  val set...
46/46 - 1s - 623ms/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1366092
{'0': {'precision': 0.4152941176470588, 'recall': 0.2294691224268689, 'f1-score': 0.2956036287508723, 'support': 4615}, '1': {'precision': 0.29017857142857145, 'recall': 0.4295584259537399, 'f1-score': 0.34637277461547783, 'support': 3329}, '2': {'precision': 0.3175547098001903, 'recall': 0.35714285714285715, 'f1-score': 0.3361873583480231, 'support': 3738}, 'accuracy': 0.3273412086971409, 'macro avg': {'precision': 0.34100913295860685, 'recall': 0.338723468507822, 'f1-score': 0.3260545872381244, 'support': 11682}, 'weighted avg': {'precision': 0.3483655472059581, 'recall': 0.3273412086971409, 'f1-score': 0.3230571870300558, 'support': 11682}}
[[1059 1853 1703]
 [ 733 1430 1166]
 [ 758 1645 1335]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1424118
{'0': {'precision': 0.3897726426259901, 'recall': 0.5300755264905508, 'f1-score': 0.4492240038919043, 'support': 177686}, '1': {'precision': 0.17985845488160973, 'recall': 0.2552604380939002, 'f1-score': 0.21102622170237828, 'support': 99659}, '2': {'precision': 0.4032338817960447, 'recall': 0.18302155746764315, 'f1-score': 0.2517690690007957, 'support': 193622}, 'accuracy': 0.3292438748362412, 'macro avg': {'precision': 0.32428832643454814, 'recall': 0.3227858406840314, 'f1-score': 0.30400643153169277, 'support': 470967}, 'weighted avg': {'precision': 0.35088786728964405, 'recall': 0.3292438748362412, 'f1-score': 0.3176432940359861, 'support': 470967}}
[[94187 54847 28652]
 [50427 25439 23793]
 [97032 61153 35437]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1302246
{'0': {'precision': 0.3344745459958321, 'recall': 0.30325250798506453, 'f1-score': 0.318099237901989, 'support': 44458}, '1': {'precision': 0.32688031167577447, 'recall': 0.42365610617096383, 'f1-score': 0.3690289684431773, 'support': 44758}, '2': {'precision': 0.3231312695502103, 'recall': 0.25945653350654974, 'f1-score': 0.28781419255665375, 'support': 46185}, 'accuracy': 0.3281142679891581, 'macro avg': {'precision': 0.3281620424072723, 'recall': 0.3287883825541927, 'f1-score': 0.32498079963394, 'support': 135401}, 'weighted avg': {'precision': 0.32809503652146943, 'recall': 0.3281142679891581, 'f1-score': 0.3246043453996308, 'support': 135401}}
[[13482 19076 11900]
 [12595 18962 13201]
 [14231 19971 11983]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1283861
{'0': {'precision': 0.3601232147857743, 'recall': 0.47066820035553697, 'f1-score': 0.4080411576728691, 'support': 19126}, '1': {'precision': 0.2765124405338273, 'recall': 0.4507274224540214, 'f1-score': 0.3427527723418134, 'support': 14572}, '2': {'precision': 0.3975069252077562, 'recall': 0.08883615352868345, 'f1-score': 0.14521841794569065, 'support': 19384}, 'accuracy': 0.325760144681813, 'macro avg': {'precision': 0.3447141935091193, 'recall': 0.3367439254460806, 'f1-score': 0.2986707826534577, 'support': 53082}, 'weighted avg': {'precision': 0.35082193827811303, 'recall': 0.325760144681813, 'f1-score': 0.2941430690945229, 'support': 53082}}
[[9002 8542 1582]
 [6976 6568 1028]
 [9019 8643 1722]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1360651
{'0': {'precision': 0.40769073365758446, 'recall': 0.25537599952673457, 'f1-score': 0.31403906543642474, 'support': 101423}, '1': {'precision': 0.25950578613068825, 'recall': 0.46119469916033956, 'f1-score': 0.33212879804453255, 'support': 64669}, '2': {'precision': 0.32560294160224673, 'recall': 0.2761550456124842, 'f1-score': 0.29884736754691915, 'support': 81447}, 'accuracy': 0.31598253204545546, 'macro avg': {'precision': 0.33093315379683985, 'recall': 0.3309085814331861, 'f1-score': 0.3150050770092922, 'support': 247539}, 'weighted avg': {'precision': 0.34196865846479485, 'recall': 0.31598253204545546, 'f1-score': 0.3137664889940345, 'support': 247539}}
[[25901 47689 27833]
 [16091 29825 18753]
 [21539 37416 22492]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1293024
{'0': {'precision': 0.31284861532439573, 'recall': 0.35786645771534115, 'f1-score': 0.3338467562981334, 'support': 17867}, '1': {'precision': 0.29713599038654115, 'recall': 0.4206169199364935, 'f1-score': 0.3482547358043238, 'support': 17636}, '2': {'precision': 0.36291658994660286, 'recall': 0.18986610153164435, 'f1-score': 0.2493043258284847, 'support': 20762}, 'accuracy': 0.3155425219941349, 'macro avg': {'precision': 0.32430039855251325, 'recall': 0.32278315972782634, 'f1-score': 0.3104686059769806, 'support': 56265}, 'weighted avg': {'precision': 0.32639884078786796, 'recall': 0.3155425219941349, 'f1-score': 0.30716638990979833, 'support': 56265}}
[[6394 8169 3304]
 [6602 7418 3616]
 [7442 9378 3942]]
Evaluating performance on  val set...
79/79 - 1s - 830ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1271111
{'0': {'precision': 0.37162805458584575, 'recall': 0.33548202263286064, 'f1-score': 0.35263118271474814, 'support': 6981}, '1': {'precision': 0.3337552208581192, 'recall': 0.422867222578576, 'f1-score': 0.37306359199264333, 'support': 6236}, '2': {'precision': 0.3399793743554486, 'recall': 0.2907113462669018, 'f1-score': 0.31342101093329106, 'support': 6804}, 'accuracy': 0.3474851406023675, 'macro avg': {'precision': 0.3484542165998045, 'recall': 0.3496868638261128, 'f1-score': 0.3463719285468942, 'support': 20021}, 'weighted avg': {'precision': 0.3490761035637327, 'recall': 0.3474851406023675, 'f1-score': 0.34567001671184727, 'support': 20021}}
[[2342 2500 2139]
 [1898 2637 1701]
 [2062 2764 1978]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1324134
{'0': {'precision': 0.35484864526685594, 'recall': 0.2583604305656781, 'f1-score': 0.2990133459858632, 'support': 142696}, '1': {'precision': 0.27634682027596624, 'recall': 0.39037224077543375, 'f1-score': 0.32360894944918417, 'support': 122770}, '2': {'precision': 0.351470177724016, 'recall': 0.32187899446101403, 'f1-score': 0.33602437505560007, 'support': 140820}, 'accuracy': 0.3202670040316427, 'macro avg': {'precision': 0.3275552144222794, 'recall': 0.323537221934042, 'f1-score': 0.3195488901635491, 'support': 406286}, 'weighted avg': {'precision': 0.3299562668597381, 'recall': 0.3202670040316427, 'f1-score': 0.3192736930093695, 'support': 406286}}
[[36867 63142 42687]
 [33894 47926 40950]
 [33134 62359 45327]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1230109
{'0': {'precision': 0.3180383723852878, 'recall': 0.4780856423173804, 'f1-score': 0.38197460881815287, 'support': 23820}, '1': {'precision': 0.33077583738906385, 'recall': 0.4649496981891348, 'f1-score': 0.3865506858481097, 'support': 24850}, '2': {'precision': 0.3658741847254366, 'recall': 0.06483967188665175, 'f1-score': 0.11015741297944448, 'support': 26820}, 'accuracy': 0.3269439660882236, 'macro avg': {'precision': 0.3382294648332627, 'recall': 0.335958337464389, 'f1-score': 0.2928942358819024, 'support': 75490}, 'weighted avg': {'precision': 0.33922637731715466, 'recall': 0.3269439660882236, 'f1-score': 0.2869100747315224, 'support': 75490}}
[[11388 10980  1452]
 [11734 11554  1562]
 [12685 12396  1739]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269141
{'0': {'precision': 0.3158617532616159, 'recall': 0.2724849442195676, 'f1-score': 0.292574336142471, 'support': 10129}, '1': {'precision': 0.3579801623083859, 'recall': 0.42854770406045006, 'f1-score': 0.39009826152683297, 'support': 12043}, '2': {'precision': 0.27983135601529563, 'recall': 0.2552316222500447, 'f1-score': 0.2669659978485571, 'support': 11182}, 'accuracy': 0.32304970918030823, 'macro avg': {'precision': 0.3178910905284325, 'recall': 0.31875475684335414, 'f1-score': 0.3165461985059537, 'support': 33354}, 'weighted avg': {'precision': 0.3189900166825519, 'recall': 0.32304970918030823, 'f1-score': 0.31920167303163954, 'support': 33354}}
[[2760 4282 3087]
 [2624 5161 4258]
 [3354 4974 2854]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1398791
{'0': {'precision': 0.39237394324868746, 'recall': 0.23935328750356785, 'f1-score': 0.2973308373472435, 'support': 206707}, '1': {'precision': 0.24978318126046625, 'recall': 0.4778755648669934, 'f1-score': 0.3280803796405174, 'support': 130783}, '2': {'precision': 0.3668725116789311, 'recall': 0.2960546274698987, 'f1-score': 0.32768097234187193, 'support': 201071}, 'accuracy': 0.3184448929647709, 'macro avg': {'precision': 0.33634321206269496, 'recall': 0.33776115994682, 'f1-score': 0.317697396443211, 'support': 538561}, 'weighted avg': {'precision': 0.3482265839481291, 'recall': 0.3184448929647709, 'f1-score': 0.31612917102392296, 'support': 538561}}
[[49476 96052 61179]
 [26734 62498 41551]
 [49884 91659 59528]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.130259
{'0': {'precision': 0.32984555726415726, 'recall': 0.27138456460751414, 'f1-score': 0.2977728150651859, 'support': 36358}, '1': {'precision': 0.3196022022717127, 'recall': 0.3577734591893393, 'f1-score': 0.337612323491656, 'support': 36020}, '2': {'precision': 0.34655356869937337, 'recall': 0.3665535079211122, 'f1-score': 0.3562730772252337, 'support': 37116}, 'accuracy': 0.3320638573803131, 'macro avg': {'precision': 0.3320004427450811, 'recall': 0.33190384390598854, 'f1-score': 0.3305527385940252, 'support': 109494}, 'weighted avg': {'precision': 0.33213946291744995, 'recall': 0.3320638573803131, 'f1-score': 0.3307090017407461, 'support': 109494}}
[[ 9867 13333 13158]
 [10638 12887 12495]
 [ 9409 14102 13605]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1364704
{'0': {'precision': 0.3583676834295136, 'recall': 0.3547992164544564, 'f1-score': 0.3565745221884997, 'support': 12252}, '1': {'precision': 0.29436015831134565, 'recall': 0.327492890560499, 'f1-score': 0.31004385774458293, 'support': 10901}, '2': {'precision': 0.3666237666237666, 'recall': 0.3348746081504702, 'f1-score': 0.35003071882039727, 'support': 12760}, 'accuracy': 0.3394314036699802, 'macro avg': {'precision': 0.3397838694548753, 'recall': 0.3390555717218085, 'f1-score': 0.3388830329178267, 'support': 35913}, 'weighted avg': {'precision': 0.3418723082240315, 'recall': 0.3394314036699802, 'f1-score': 0.34012561220938003, 'support': 35913}}
[[4347 4120 3785]
 [3734 3570 3597]
 [4049 4438 4273]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
5267/5267 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1209176
{'0': {'precision': 0.34304806028306917, 'recall': 0.4833315288980314, 'f1-score': 0.40128276553012393, 'support': 443352}, '1': {'precision': 0.3928004433261443, 'recall': 0.3488935154083051, 'f1-score': 0.3695473743910215, 'support': 451023}, '2': {'precision': 0.38590645592825645, 'recall': 0.2746058958075335, 'f1-score': 0.320878747383301, 'support': 453814}, 'accuracy': 0.36809749968290795, 'macro avg': {'precision': 0.37391831984582335, 'recall': 0.36894364670462326, 'f1-score': 0.3639029624348155, 'support': 1348189}, 'weighted avg': {'precision': 0.3741187848020809, 'recall': 0.36809749968290795, 'f1-score': 0.3636012087090746, 'support': 1348189}}
[[214286 120287 108779]
 [204135 157359  89529]
 [206232 122962 124620]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1180382
{'0': {'precision': 0.33269534754560603, 'recall': 0.43510375576886545, 'f1-score': 0.37706997733919545, 'support': 89489}, '1': {'precision': 0.33477533691421957, 'recall': 0.4641523316870868, 'f1-score': 0.3889882884945086, 'support': 89699}, '2': {'precision': 0.3535360300026788, 'recall': 0.11466739071409178, 'f1-score': 0.17316855148885918, 'support': 92075}, 'accuracy': 0.33594334649399293, 'macro avg': {'precision': 0.34033557148750143, 'recall': 0.33797449272334806, 'f1-score': 0.31307560577418775, 'support': 271263}, 'weighted avg': {'precision': 0.3404571093915277, 'recall': 0.33594334649399293, 'f1-score': 0.31180061442258217, 'support': 271263}}
[[38937 40927  9625]
 [38384 41634  9681]
 [39714 41803 10558]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1216339
{'0': {'precision': 0.31731210776060004, 'recall': 0.441037019026199, 'f1-score': 0.36908168326275237, 'support': 32902}, '1': {'precision': 0.3214818783726893, 'recall': 0.5056433408577878, 'f1-score': 0.3930606085420492, 'support': 33225}, '2': {'precision': 0.35056304227432156, 'recall': 0.05094020762359505, 'f1-score': 0.08895446880269814, 'support': 37279}, 'accuracy': 0.3211612478966404, 'macro avg': {'precision': 0.32978567613587034, 'recall': 0.332540189169194, 'f1-score': 0.2836989202024999, 'support': 103406}, 'weighted avg': {'precision': 0.3306392088603785, 'recall': 0.3211612478966404, 'f1-score': 0.27579732224451625, 'support': 103406}}
[[14511 16635  1756]
 [14663 16800  1762]
 [16557 18823  1899]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
10110/10110 - 84s - 84s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1318184
{'0': {'precision': 0.3573886081176389, 'recall': 0.41551228589697564, 'f1-score': 0.38426493917262994, 'support': 941486}, '1': {'precision': 0.2560708579978525, 'recall': 0.41718998215587955, 'f1-score': 0.3173515829447953, 'support': 684259}, '2': {'precision': 0.37871266213190247, 'recall': 0.14903008865741993, 'f1-score': 0.21389050452627026, 'support': 962356}, 'accuracy': 0.3168674638277254, 'macro avg': {'precision': 0.3307240427491313, 'recall': 0.32724411890342503, 'f1-score': 0.30516900888123183, 'support': 2588101}, 'weighted avg': {'precision': 0.33853066901315093, 'recall': 0.3168674638277254, 'f1-score': 0.3032221492476487, 'support': 2588101}}
[[391199 413569 136718]
 [300227 285466  98566]
 [403178 415758 143420]]
Evaluating performance on  train set...
1686/1686 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1303748
{'0': {'precision': 0.3427522649172134, 'recall': 0.4458811417114835, 'f1-score': 0.3875736683760282, 'support': 147638}, '1': {'precision': 0.3271834849141042, 'recall': 0.32823543042521147, 'f1-score': 0.3277086134848682, 'support': 138096}, '2': {'precision': 0.34778345614452105, 'recall': 0.2407874706858483, 'f1-score': 0.2845600927058938, 'support': 145834}, 'accuracy': 0.3389315241167093, 'macro avg': {'precision': 0.33923973532527957, 'recall': 0.33830134760751446, 'f1-score': 0.33328079152226336, 'support': 431568}, 'weighted avg': {'precision': 0.3394705862434791, 'recall': 0.3389315241167093, 'f1-score': 0.3336076504726433, 'support': 431568}}
[[65829 47512 34297]
 [61212 45328 31556]
 [65019 45700 35115]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1369308
{'0': {'precision': 0.33422818791946307, 'recall': 0.3417388716184933, 'f1-score': 0.33794180408957497, 'support': 60476}, '1': {'precision': 0.31058198081629207, 'recall': 0.4045172281145244, 'f1-score': 0.35137994955964136, 'support': 54591}, '2': {'precision': 0.3558986456600038, 'recall': 0.25857346167383355, 'f1-score': 0.29952846912004544, 'support': 65347}, 'accuracy': 0.3306118150476127, 'macro avg': {'precision': 0.3335696047985863, 'recall': 0.33494318713561705, 'f1-score': 0.32961674092308724, 'support': 180414}, 'weighted avg': {'precision': 0.334922309827973, 'recall': 0.3306118150476127, 'f1-score': 0.32809448403183306, 'support': 180414}}
[[20667 23376 16433]
 [18361 22083 14147]
 [22807 25643 16897]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
6546/6546 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1419376
{'0': {'precision': 0.35361298644641986, 'recall': 0.21132225473061486, 'f1-score': 0.26454817526409785, 'support': 621378}, '1': {'precision': 0.2626005735254062, 'recall': 0.3859552848728289, 'f1-score': 0.3125469544383726, 'support': 444637}, '2': {'precision': 0.3663166012726485, 'recall': 0.39105114521593953, 'f1-score': 0.37827997588602974, 'support': 609754}, 'accuracy': 0.3230552659704291, 'macro avg': {'precision': 0.32751005374815817, 'recall': 0.32944289493979445, 'f1-score': 0.3184583685295001, 'support': 1675769}, 'weighted avg': {'precision': 0.33408678307996037, 'recall': 0.3230552659704291, 'f1-score': 0.3186668834703825, 'support': 1675769}}
[[131311 244324 245743]
 [106289 171610 166738]
 [133741 237568 238445]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1345243
{'0': {'precision': 0.31667101487085836, 'recall': 0.278808871901358, 'f1-score': 0.2965362571642163, 'support': 108838}, '1': {'precision': 0.31071574456497075, 'recall': 0.40582917551746284, 'f1-score': 0.35195983085774996, 'support': 101215}, '2': {'precision': 0.3513205067610407, 'recall': 0.2910320196338703, 'f1-score': 0.31834705218735637, 'support': 104717}, 'accuracy': 0.32371890586777646, 'macro avg': {'precision': 0.3262357553989566, 'recall': 0.3252233556842304, 'f1-score': 0.32228104673644087, 'support': 314770}, 'weighted avg': {'precision': 0.32628320204960415, 'recall': 0.32371890586777646, 'f1-score': 0.3216137996041857, 'support': 314770}}
[[30345 46991 31502]
 [35370 41076 24769]
 [30110 44131 30476]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1308163
{'0': {'precision': 0.32349303651126526, 'recall': 0.14989037273270878, 'f1-score': 0.204859278429503, 'support': 40136}, '1': {'precision': 0.3101470001330318, 'recall': 0.5389683571738189, 'f1-score': 0.3937260531343347, 'support': 34605}, '2': {'precision': 0.3642834500446673, 'recall': 0.32669991988214925, 'f1-score': 0.3444695751696324, 'support': 38693}, 'accuracy': 0.328896098171624, 'macro avg': {'precision': 0.3326411622296548, 'recall': 0.33851954992955896, 'f1-score': 0.31435163557782336, 'support': 113434}, 'weighted avg': {'precision': 0.3333354460355627, 'recall': 0.328896098171624, 'f1-score': 0.31009823632948474, 'support': 113434}}
[[ 6016 20912 13208]
 [ 7102 18651  8852]
 [ 5479 20573 12641]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
7633/7633 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1222197
{'0': {'precision': 0.340710614666592, 'recall': 0.4262026727414482, 'f1-score': 0.3786915078575826, 'support': 656704}, '1': {'precision': 0.3438193476721699, 'recall': 0.4366816806081838, 'f1-score': 0.38472623386003496, 'support': 629415}, '2': {'precision': 0.3730335526947834, 'recall': 0.18604396970064488, 'f1-score': 0.2482684071343724, 'support': 667869}, 'accuracy': 0.34749241039351314, 'macro avg': {'precision': 0.35252117167784847, 'recall': 0.3496427743500923, 'f1-score': 0.33722871628399664, 'support': 1953988}, 'weighted avg': {'precision': 0.3527599064138575, 'recall': 0.34749241039351314, 'f1-score': 0.3360570603634956, 'support': 1953988}}
[[279889 257834 118981]
 [264707 274854  89854]
 [276890 266726 124253]]
Evaluating performance on  train set...
1586/1586 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1237037
{'0': {'precision': 0.3354666913119574, 'recall': 0.4180758017492711, 'f1-score': 0.3722431242348688, 'support': 138915}, '1': {'precision': 0.33139658431289215, 'recall': 0.44245428821012867, 'f1-score': 0.37895632100115423, 'support': 133937}, '2': {'precision': 0.3454950357242275, 'recall': 0.1400006016032727, 'f1-score': 0.1992582801303629, 'support': 132978}, 'accuracy': 0.33500480496759727, 'macro avg': {'precision': 0.33745277044969235, 'recall': 0.3335102305208908, 'f1-score': 0.31681924178879534, 'support': 405830}, 'weighted avg': {'precision': 0.337409404423657, 'recall': 0.33500480496759727, 'f1-score': 0.31777688673630283, 'support': 405830}}
[[58077 61051 19787]
 [59195 59261 15481]
 [55851 58510 18617]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269424
{'0': {'precision': 0.27756366219158624, 'recall': 0.5896700143472023, 'f1-score': 0.37745528822174196, 'support': 40426}, '1': {'precision': 0.4855470443705738, 'recall': 0.3142901691743978, 'f1-score': 0.3815843027383127, 'support': 64135}, '2': {'precision': 0.37883766300441524, 'recall': 0.17438672779694664, 'f1-score': 0.2388335059554635, 'support': 42314}, 'accuracy': 0.3497804255319149, 'macro avg': {'precision': 0.3806494565221918, 'recall': 0.35944897043951557, 'f1-score': 0.33262436563850606, 'support': 146875}, 'weighted avg': {'precision': 0.3975590479716265, 'recall': 0.3497804255319149, 'f1-score': 0.33932199291079695, 'support': 146875}}
[[23838 10367  6221]
 [38100 20157  5878]
 [23945 10990  7379]]
testing model on single stock: results/universal/W10/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
22048/22048 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.138574
{'0': {'precision': 0.3693867027633324, 'recall': 0.3981239877947773, 'f1-score': 0.3832173517623926, 'support': 2135807}, '1': {'precision': 0.24808141445489676, 'recall': 0.39998951631240537, 'f1-score': 0.30623180353553386, 'support': 1411717}, '2': {'precision': 0.37428478955293193, 'recall': 0.19029746096432987, 'f1-score': 0.25231202385209883, 'support': 2096544}, 'accuracy': 0.3213914148447538, 'macro avg': {'precision': 0.33058430225705365, 'recall': 0.3294703216905042, 'f1-score': 0.31392039305000846, 'support': 5644068}, 'weighted avg': {'precision': 0.34086477793452, 'recall': 0.3213914148447538, 'f1-score': 0.31533535831643567, 'support': 5644068}}
[[850316 864569 420922]
 [600989 564672 246056]
 [850662 846915 398967]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1155353
{'0': {'precision': 0.33443484380238536, 'recall': 0.4330201532662561, 'f1-score': 0.37739548996104283, 'support': 465334}, '1': {'precision': 0.32835916565525103, 'recall': 0.5161948907124174, 'f1-score': 0.40138892792445213, 'support': 456502}, '2': {'precision': 0.3405504745222473, 'recall': 0.05068595606462091, 'f1-score': 0.08823885016805895, 'support': 467960}, 'accuracy': 0.33160406275453375, 'macro avg': {'precision': 0.33444816132662786, 'recall': 0.3333003333477648, 'f1-score': 0.28900775601785134, 'support': 1389796}, 'weighted avg': {'precision': 0.3344983864562306, 'recall': 0.33160406275453375, 'f1-score': 0.287914236064534, 'support': 1389796}}
[[201499 240691  23144]
 [198072 235644  22786]
 [202935 241306  23719]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128082
{'0': {'precision': 0.3151684727195125, 'recall': 0.4382963568734007, 'f1-score': 0.3666719081471918, 'support': 151628}, '1': {'precision': 0.3595264290452538, 'recall': 0.514095178604479, 'f1-score': 0.4231369786063162, 'support': 172896}, '2': {'precision': 0.33733479314929227, 'recall': 0.05420910753221945, 'f1-score': 0.09340775348235408, 'support': 159143}, 'accuracy': 0.33901423913560363, 'macro avg': {'precision': 0.33734323163801955, 'recall': 0.335533547670033, 'f1-score': 0.29440554674528735, 'support': 483667}, 'weighted avg': {'precision': 0.3383185490097118, 'recall': 0.33901423913560363, 'f1-score': 0.29694316390016756, 'support': 483667}}
[[66458 77097  8073]
 [75137 88885  8874]
 [69270 81246  8627]]
training model: results/universal/W10/deepLOB_L1/h1000
Epoch 1/50
8543/8543 - 189s - loss: 3.1879 - accuracy1000: 0.4289 - val_loss: 3.3162 - val_accuracy1000: 0.3664 - 189s/epoch - 22ms/step
Epoch 2/50
8543/8543 - 187s - loss: 3.1474 - accuracy1000: 0.4482 - val_loss: 3.4621 - val_accuracy1000: 0.3460 - 187s/epoch - 22ms/step
Epoch 3/50
8543/8543 - 187s - loss: 3.1278 - accuracy1000: 0.4553 - val_loss: 3.3527 - val_accuracy1000: 0.3561 - 187s/epoch - 22ms/step
Epoch 4/50
8543/8543 - 187s - loss: 3.1090 - accuracy1000: 0.4628 - val_loss: 3.6282 - val_accuracy1000: 0.3108 - 187s/epoch - 22ms/step
Epoch 5/50
8543/8543 - 187s - loss: 3.0952 - accuracy1000: 0.4673 - val_loss: 4.1748 - val_accuracy1000: 0.3058 - 187s/epoch - 22ms/step
Epoch 6/50
8543/8543 - 188s - loss: 3.0879 - accuracy1000: 0.4697 - val_loss: 4.0237 - val_accuracy1000: 0.3080 - 188s/epoch - 22ms/step
Epoch 7/50
8543/8543 - 187s - loss: 3.0811 - accuracy1000: 0.4717 - val_loss: 3.3824 - val_accuracy1000: 0.3476 - 187s/epoch - 22ms/step
Epoch 8/50
8543/8543 - 187s - loss: 3.0715 - accuracy1000: 0.4744 - val_loss: 3.6166 - val_accuracy1000: 0.3292 - 187s/epoch - 22ms/step
Epoch 9/50
8543/8543 - 186s - loss: 3.0658 - accuracy1000: 0.4765 - val_loss: 3.8514 - val_accuracy1000: 0.3150 - 186s/epoch - 22ms/step
Epoch 10/50
8543/8543 - 186s - loss: 3.0623 - accuracy1000: 0.4770 - val_loss: 3.5532 - val_accuracy1000: 0.3207 - 186s/epoch - 22ms/step
Epoch 11/50
8543/8543 - 186s - loss: 3.0585 - accuracy1000: 0.4782 - val_loss: 3.7956 - val_accuracy1000: 0.3148 - 186s/epoch - 22ms/step
testing model in sample: results/universal/W10/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 286s - 286s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1416276
{'0': {'precision': 0.3505604216152019, 'recall': 0.05013441894656946, 'f1-score': 0.08772333089541323, 'support': 3391263}, '1': {'precision': 0.2924605133024414, 'recall': 0.8497222013530387, 'f1-score': 0.4351496270842253, 'support': 2795190}, '2': {'precision': 0.3464019227513149, 'recall': 0.09684812491031092, 'f1-score': 0.15137449780671802, 'support': 3358826}, 'accuracy': 0.3007193398956699, 'macro avg': {'precision': 0.329807619222986, 'recall': 0.332234915069973, 'f1-score': 0.2247491519287855, 'support': 9545279}, 'weighted avg': {'precision': 0.3320834387190771, 'recall': 0.3007193398956699, 'f1-score': 0.21185963987035633, 'support': 9545279}}
[[ 170019 2885976  335268]
 [ 141548 2375135  278507]
 [ 173425 2860105  325296]]
Evaluating performance on  train set...
8543/8543 - 70s - 70s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1181638
{'0': {'precision': 0.3320156945420473, 'recall': 0.015603219445472672, 'f1-score': 0.029805706955672587, 'support': 726709}, '1': {'precision': 0.33176388234553605, 'recall': 0.9620104393515158, 'f1-score': 0.4933786563294117, 'support': 723225}, '2': {'precision': 0.3570810186855205, 'recall': 0.026870760302177294, 'f1-score': 0.0499804349746917, 'support': 736786}, 'accuracy': 0.3324097278115168, 'macro avg': {'precision': 0.3402868651910346, 'recall': 0.3348281396997219, 'f1-score': 0.1910549327532587, 'support': 2186720}, 'weighted avg': {'precision': 0.3403778364891421, 'recall': 0.3324097278115168, 'f1-score': 0.18992314470218036, 'support': 2186720}}
[[ 11339 696641  18729]
 [ 10558 695750  16917]
 [ 12255 704733  19798]]
Evaluating performance on  val set...
3077/3077 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1061368
{'0': {'precision': 0.3020356234096692, 'recall': 0.004919289666176258, 'f1-score': 0.009680905291059232, 'support': 241295}, '1': {'precision': 0.36729164021835725, 'recall': 0.9650254161614126, 'f1-score': 0.5320742029940584, 'support': 287809}, '2': {'precision': 0.34689236046381566, 'recall': 0.03608453337160011, 'f1-score': 0.06536921239373288, 'support': 257839}, 'accuracy': 0.36627049227199426, 'macro avg': {'precision': 0.33873987469728073, 'recall': 0.335343079733063, 'f1-score': 0.20237477355961683, 'support': 786943}, 'weighted avg': {'precision': 0.34059888042700814, 'recall': 0.36627049227199426, 'f1-score': 0.21898209995655438, 'support': 786943}}
[[  1187 231292   8816]
 [  1365 277743   8701]
 [  1378 247157   9304]]
testing model out of sample: results/universal/W10/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 163s - 163s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1523178
{'0': {'precision': 0.39262619072859717, 'recall': 0.05007629606737232, 'f1-score': 0.0888238307086412, 'support': 2070880}, '1': {'precision': 0.24514684166922535, 'recall': 0.9166156757940329, 'f1-score': 0.3868354066647985, 'support': 1333572}, '2': {'precision': 0.3630279581340964, 'recall': 0.03714159137538557, 'f1-score': 0.06738861612726332, 'support': 2056347}, 'accuracy': 0.25682157501127584, 'macro avg': {'precision': 0.33360033017730634, 'recall': 0.3346111877455969, 'f1-score': 0.18101595116690103, 'support': 5460799}, 'weighted avg': {'precision': 0.3454648564101561, 'recall': 0.25682157501127584, 'f1-score': 0.15352895063197697, 'support': 5460799}}
[[ 103702 1886114   81064]
 [  58253 1222373   52946]
 [ 102169 1877802   76376]]
Evaluating performance on  train set...
4055/4055 - 36s - 36s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1252844
{'0': {'precision': 0.3454152480777323, 'recall': 0.05150370042922127, 'f1-score': 0.0896412908862123, 'support': 350635}, '1': {'precision': 0.3364210213413301, 'recall': 0.890445749327471, 'f1-score': 0.48834099284389676, 'support': 345710}, '2': {'precision': 0.3417182110993929, 'recall': 0.07028595717238044, 'f1-score': 0.11659101242155988, 'support': 341135}, 'accuracy': 0.33723252496433664, 'macro avg': {'precision': 0.3411848268394851, 'recall': 0.33741180230969087, 'f1-score': 0.2315244320505563, 'support': 1037480}, 'weighted avg': {'precision': 0.34120255690812185, 'recall': 0.33723252496433664, 'f1-score': 0.2313577261136402, 'support': 1037480}}
[[ 18059 308006  24570]
 [ 16255 307836  21619]
 [ 17968 299190  23977]]
Evaluating performance on  val set...
1545/1545 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1259392
{'0': {'precision': 0.2864516129032258, 'recall': 0.058335921263228306, 'f1-score': 0.09693168737347677, 'support': 125583}, '1': {'precision': 0.35444435516749845, 'recall': 0.8745309964535622, 'f1-score': 0.5044406703569901, 'support': 136193}, '2': {'precision': 0.38736222482505933, 'recall': 0.09688347392378821, 'f1-score': 0.15499981973970414, 'support': 133129}, 'accuracy': 0.3528165001709272, 'macro avg': {'precision': 0.34275273096526115, 'recall': 0.3432501305468596, 'f1-score': 0.2521240591567237, 'support': 394905}, 'weighted avg': {'precision': 0.3439192681664913, 'recall': 0.3528165001709272, 'f1-score': 0.2570472172180144, 'support': 394905}}
[[  7326 106414  11843]
 [  8532 119105   8556]
 [  9717 110514  12898]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1606236
{'0': {'precision': 0.6384615384615384, 'recall': 0.00311362869040027, 'f1-score': 0.006197035875611305, 'support': 53314}, '1': {'precision': 0.3052318373419291, 'recall': 0.7831187337778004, 'f1-score': 0.43925693854684816, 'support': 39298}, '2': {'precision': 0.3166375892149088, 'recall': 0.2495624781239062, 'f1-score': 0.27912699411378156, 'support': 39998}, 'accuracy': 0.3085966367543926, 'macro avg': {'precision': 0.42011032167279216, 'recall': 0.3452649468640356, 'f1-score': 0.24152698951208032, 'support': 132610}, 'weighted avg': {'precision': 0.4426424062952984, 'recall': 0.3085966367543926, 'f1-score': 0.2168526464991284, 'support': 132610}}
[[  166 40083 13065]
 [   45 30775  8478]
 [   49 29967  9982]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1251054
{'0': {'precision': 0.32934131736526945, 'recall': 0.03325272067714631, 'f1-score': 0.060406370126304225, 'support': 11578}, '1': {'precision': 0.33380766430604275, 'recall': 0.8949516458166977, 'f1-score': 0.4862493673021765, 'support': 11271}, '2': {'precision': 0.39373297002724794, 'recall': 0.1007495206553948, 'f1-score': 0.1604441360166551, 'support': 11474}, 'accuracy': 0.3387815750371471, 'macro avg': {'precision': 0.35229398389952005, 'recall': 0.3429846290497463, 'f1-score': 0.23569995781504527, 'support': 34323}, 'weighted avg': {'precision': 0.3523337719587781, 'recall': 0.3387815750371471, 'f1-score': 0.23368696177024972, 'support': 34323}}
[[  385 10270   923]
 [  327 10087   857]
 [  457  9861  1156]]
Evaluating performance on  val set...
46/46 - 1s - 818ms/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1458683
{'0': {'precision': 0.5616438356164384, 'recall': 0.00883430295195001, 'f1-score': 0.017394993635977938, 'support': 4641}, '1': {'precision': 0.3311576118256863, 'recall': 0.9168216848259367, 'f1-score': 0.48656653268457795, 'support': 3763}, '2': {'precision': 0.19899244332493704, 'recall': 0.07230018303843808, 'f1-score': 0.1060639964197807, 'support': 3278}, 'accuracy': 0.31912343776750557, 'macro avg': {'precision': 0.3639312969223539, 'recall': 0.3326520569387749, 'f1-score': 0.20334184091344554, 'support': 11682}, 'weighted avg': {'precision': 0.38563879161231734, 'recall': 0.31912343776750557, 'f1-score': 0.1934050512087555, 'support': 11682}}
[[  41 3943  657]
 [  16 3450  297]
 [  16 3025  237]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
1840/1840 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1471407
{'0': {'precision': 0.3170588235294118, 'recall': 0.07061267522161987, 'f1-score': 0.11550176788420231, 'support': 160297}, '1': {'precision': 0.2855922753307314, 'recall': 0.8429883750504945, 'f1-score': 0.4266437990527356, 'support': 133678}, '2': {'precision': 0.3675129648290609, 'recall': 0.08448404447658651, 'f1-score': 0.1373857836539124, 'support': 176992}, 'accuracy': 0.29505464289430045, 'macro avg': {'precision': 0.3233880212297347, 'recall': 0.3326950315829003, 'f1-score': 0.22651045019695012, 'support': 470967}, 'weighted avg': {'precision': 0.32708838854522876, 'recall': 0.29505464289430045, 'f1-score': 0.21203961482817021, 'support': 470967}}
[[ 11319 135122  13856]
 [  9111 112689  11878]
 [ 15270 146769  14953]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1295227
{'0': {'precision': 0.3118279569892473, 'recall': 0.036893203883495145, 'f1-score': 0.06598012214106094, 'support': 44805}, '1': {'precision': 0.3354243789678219, 'recall': 0.8944899828021352, 'f1-score': 0.48789372057184277, 'support': 44773}, '2': {'precision': 0.3459166510932536, 'recall': 0.08078912336599524, 'f1-score': 0.1309862892525431, 'support': 45823}, 'accuracy': 0.3353298720098079, 'macro avg': {'precision': 0.3310563290167743, 'recall': 0.3373907700172085, 'f1-score': 0.22828671065514894, 'support': 135401}, 'weighted avg': {'precision': 0.3311670226621345, 'recall': 0.3353298720098079, 'f1-score': 0.2274938121292504, 'support': 135401}}
[[ 1653 39145  4007]
 [ 1731 40049  2993]
 [ 1917 40204  3702]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1236621
{'0': {'precision': 0.2754083484573503, 'recall': 0.03512934776318074, 'f1-score': 0.06231073243340348, 'support': 17279}, '1': {'precision': 0.334451560435092, 'recall': 0.9380702554744526, 'f1-score': 0.49309812502810213, 'support': 17536}, '2': {'precision': 0.3857058476077968, 'recall': 0.03574752285542235, 'f1-score': 0.06543086172344689, 'support': 18267}, 'accuracy': 0.33363475377717494, 'macro avg': {'precision': 0.3318552521667464, 'recall': 0.3363157086976852, 'f1-score': 0.20694657306165085, 'support': 53082}, 'weighted avg': {'precision': 0.3328701280101721, 'recall': 0.33363475377717494, 'f1-score': 0.2056980034156924, 'support': 53082}}
[[  607 16051   621]
 [  667 16450   419]
 [  930 16684   653]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.142778
{'0': {'precision': 0.47097253155159613, 'recall': 0.060571919606626244, 'f1-score': 0.10733894505308575, 'support': 104735}, '1': {'precision': 0.25473972551337254, 'recall': 0.8623783285961542, 'f1-score': 0.39330134878247486, 'support': 62977}, '2': {'precision': 0.36141056969000046, 'recall': 0.09449183860097461, 'f1-score': 0.1498142962124372, 'support': 79827}, 'accuracy': 0.2755000222187211, 'macro avg': {'precision': 0.3623742755849897, 'recall': 0.33914736226791836, 'f1-score': 0.21681819668266597, 'support': 247539}, 'weighted avg': {'precision': 0.380628399292054, 'recall': 0.2755000222187211, 'f1-score': 0.19378889498688726, 'support': 247539}}
[[ 6344 90797  7594]
 [ 2933 54310  5734]
 [ 4193 68091  7543]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1245768
{'0': {'precision': 0.28895184135977336, 'recall': 0.017687861271676302, 'f1-score': 0.033335148973255624, 'support': 17300}, '1': {'precision': 0.3223832591343231, 'recall': 0.8972707423580786, 'f1-score': 0.4743395518619516, 'support': 18320}, '2': {'precision': 0.3474033673227413, 'recall': 0.07096149188665536, 'f1-score': 0.11785053495294023, 'support': 20645}, 'accuracy': 0.3236292544210433, 'macro avg': {'precision': 0.31957948927227925, 'recall': 0.3286400318388034, 'f1-score': 0.20850841192938244, 'support': 56265}, 'weighted avg': {'precision': 0.3212844695857615, 'recall': 0.3236292544210433, 'f1-score': 0.20793784699994186, 'support': 56265}}
[[  306 15777  1217]
 [  347 16438  1535]
 [  406 18774  1465]]
Evaluating performance on  val set...
79/79 - 1s - 872ms/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204304
{'0': {'precision': 0.34148635936030103, 'recall': 0.0537220660056238, 'f1-score': 0.09283887468030691, 'support': 6757}, '1': {'precision': 0.33710502557929584, 'recall': 0.8375953342305967, 'f1-score': 0.48073126770234315, 'support': 6687}, '2': {'precision': 0.3939393939393939, 'recall': 0.14033753991181389, 'f1-score': 0.2069506726457399, 'support': 6577}, 'accuracy': 0.34398881174766494, 'macro avg': {'precision': 0.3575102596263302, 'recall': 0.3438849800493448, 'f1-score': 0.26017360500946335, 'support': 20021}, 'weighted avg': {'precision': 0.3572540847203286, 'recall': 0.34398881174766494, 'f1-score': 0.25988096685137774, 'support': 20021}}
[[ 363 5629  765]
 [ 431 5601  655]
 [ 269 5385  923]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1304208
{'0': {'precision': 0.3126805116215101, 'recall': 0.06326304878642634, 'f1-score': 0.10523453275705451, 'support': 143749}, '1': {'precision': 0.304614213412657, 'recall': 0.8691902329136328, 'f1-score': 0.45112744279271755, 'support': 124295}, '2': {'precision': 0.4333318542840662, 'recall': 0.07064423257765368, 'f1-score': 0.12148352707754123, 'support': 138242}, 'accuracy': 0.31233170722102166, 'macro avg': {'precision': 0.3502088597727444, 'recall': 0.3343658380925709, 'f1-score': 0.22594850087577112, 'support': 406286}, 'weighted avg': {'precision': 0.3512653567219755, 'recall': 0.31233170722102166, 'f1-score': 0.21658233387679643, 'support': 406286}}
[[  9094 127388   7267]
 [ 10755 108036   5504]
 [  9235 119241   9766]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1183363
{'0': {'precision': 0.34972677595628415, 'recall': 0.010860803529761147, 'f1-score': 0.02106735793934905, 'support': 23571}, '1': {'precision': 0.3294332624229531, 'recall': 0.9740343520683816, 'f1-score': 0.4923471987282695, 'support': 24802}, '2': {'precision': 0.38288920056100983, 'recall': 0.020134970682597633, 'f1-score': 0.03825806677644256, 'support': 27117}, 'accuracy': 0.3306398198436879, 'macro avg': {'precision': 0.3540164129800824, 'recall': 0.33501004209358015, 'f1-score': 0.1838908744813537, 'support': 75490}, 'weighted avg': {'precision': 0.3549717851674733, 'recall': 0.3306398198436879, 'f1-score': 0.1820799829596467, 'support': 75490}}
[[  256 22882   433]
 [  197 24158   447]
 [  279 26292   546]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1192957
{'0': {'precision': 0.38041733547351525, 'recall': 0.022929566563467493, 'f1-score': 0.04325212154393649, 'support': 10336}, '1': {'precision': 0.3460014226196525, 'recall': 0.8865648324943586, 'f1-score': 0.49774637592885856, 'support': 11522}, '2': {'precision': 0.3600374064837905, 'recall': 0.10046972860125261, 'f1-score': 0.15710010881392816, 'support': 11496}, 'accuracy': 0.3479942435689872, 'macro avg': {'precision': 0.3621520548589861, 'recall': 0.3366547092196929, 'f1-score': 0.23269953542890773, 'support': 33354}, 'weighted avg': {'precision': 0.3615042272535692, 'recall': 0.3479942435689872, 'f1-score': 0.23949482888575144, 'support': 33354}}
[[  237  9075  1024]
 [  278 10215  1029]
 [  108 10233  1155]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1610329
{'0': {'precision': 0.33310410040402305, 'recall': 0.018638320386715087, 'f1-score': 0.035301405679199045, 'support': 207905}, '1': {'precision': 0.24078698246723645, 'recall': 0.9147553516819572, 'f1-score': 0.38122563634058243, 'support': 128184}, '2': {'precision': 0.36008910246783804, 'recall': 0.07105673870954997, 'f1-score': 0.11869188948380124, 'support': 202472}, 'accuracy': 0.25163166289426825, 'macro avg': {'precision': 0.3113267284463659, 'recall': 0.33481680359274074, 'f1-score': 0.17840631050119424, 'support': 538561}, 'weighted avg': {'precision': 0.32127652635439025, 'recall': 0.25163166289426825, 'f1-score': 0.14898618719881185, 'support': 538561}}
[[  3875 187415  16615]
 [  1975 117257   8952]
 [  5783 182302  14387]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1294792
{'0': {'precision': 0.35347307850390464, 'recall': 0.047320347749532296, 'f1-score': 0.08346678313194544, 'support': 36348}, '1': {'precision': 0.33561787229353757, 'recall': 0.8302622253720765, 'f1-score': 0.47800943181550676, 'support': 36686}, '2': {'precision': 0.340517552079579, 'recall': 0.12956664838178827, 'f1-score': 0.18770985238312837, 'support': 36460}, 'accuracy': 0.3370321661460902, 'macro avg': {'precision': 0.3432028342923404, 'recall': 0.335716407167799, 'f1-score': 0.24972868911019352, 'support': 109494}, 'weighted avg': {'precision': 0.34317667332677676, 'recall': 0.3370321661460902, 'f1-score': 0.25036993686185993, 'support': 109494}}
[[ 1720 29915  4713]
 [ 1791 30459  4436]
 [ 1355 30381  4724]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1524372
{'0': {'precision': 0.2151394422310757, 'recall': 0.04431314623338257, 'f1-score': 0.07348938486663036, 'support': 12186}, '1': {'precision': 0.2983170947741364, 'recall': 0.7762514981100765, 'f1-score': 0.43099918099918105, 'support': 10847}, '2': {'precision': 0.33777520278099654, 'recall': 0.13579192546583851, 'f1-score': 0.1937091593753461, 'support': 12880}, 'accuracy': 0.29819285495503023, 'macro avg': {'precision': 0.28374391326206955, 'recall': 0.3187855232697659, 'f1-score': 0.23273257508038583, 'support': 35913}, 'weighted avg': {'precision': 0.2842446852633359, 'recall': 0.29819285495503023, 'f1-score': 0.22458618698068478, 'support': 35913}}
[[  540  9679  1967]
 [  965  8420  1462]
 [ 1005 10126  1749]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
5267/5267 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968068
{'0': {'precision': 0.3045170606146216, 'recall': 0.07540828991109993, 'f1-score': 0.12088222466823119, 'support': 385939}, '1': {'precision': 0.4252591400054814, 'recall': 0.8224295948920098, 'f1-score': 0.5606297347351898, 'support': 569774}, '2': {'precision': 0.3051743815691687, 'recall': 0.11718168754267777, 'f1-score': 0.16933981368975293, 'support': 392476}, 'accuracy': 0.4032765435706715, 'macro avg': {'precision': 0.3449835273964239, 'recall': 0.33833985744859585, 'f1-score': 0.28361725769772467, 'support': 1348189}, 'weighted avg': {'precision': 0.3557366449917413, 'recall': 0.4032765435706715, 'f1-score': 0.3208357463997556, 'support': 1348189}}
[[ 29103 315641  41195]
 [ 37657 468599  63518]
 [ 28811 317674  45991]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.116356
{'0': {'precision': 0.4594708994708995, 'recall': 0.024321659832851606, 'f1-score': 0.04619787842999564, 'support': 89262}, '1': {'precision': 0.3357432131904832, 'recall': 0.9616579500245854, 'f1-score': 0.49771826831313803, 'support': 89484}, '2': {'precision': 0.41477716966379985, 'recall': 0.04587265043181253, 'f1-score': 0.0826090764873624, 'support': 92517}, 'accuracy': 0.340879515451794, 'macro avg': {'precision': 0.40333042744172753, 'recall': 0.34395075342974984, 'f1-score': 0.20884174107683204, 'support': 271263}, 'weighted avg': {'precision': 0.40341246879778814, 'recall': 0.340879515451794, 'f1-score': 0.20756343650085868, 'support': 271263}}
[[ 2171 83616  3475]
 [  918 86053  2513]
 [ 1636 86637  4244]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0775512
{'0': {'precision': 0.19594594594594594, 'recall': 0.0010984016362396787, 'f1-score': 0.002184557438794727, 'support': 26402}, '1': {'precision': 0.4439965560425798, 'recall': 0.9884126154382297, 'f1-score': 0.6127464218201458, 'support': 45912}, '2': {'precision': 0.31523809523809526, 'recall': 0.01064582529267979, 'f1-score': 0.02059610478501649, 'support': 31092}, 'accuracy': 0.4423341005357523, 'macro avg': {'precision': 0.31839353240887364, 'recall': 0.33338561412238304, 'f1-score': 0.2118423613479857, 'support': 103406}, 'weighted avg': {'precision': 0.341948413080814, 'recall': 0.4423341005357523, 'f1-score': 0.2788084298211064, 'support': 103406}}
[[   29 26112   261]
 [   74 45380   458]
 [   45 30716   331]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
10110/10110 - 77s - 77s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1628867
{'0': {'precision': 0.36622379687038675, 'recall': 0.0302528616319375, 'f1-score': 0.0558888782754289, 'support': 1025027}, '1': {'precision': 0.19945015110662181, 'recall': 0.9481520779442061, 'f1-score': 0.32957251289837575, 'support': 516472}, '2': {'precision': 0.4322283533170145, 'recall': 0.019908236368743802, 'f1-score': 0.038063295116586654, 'support': 1046602}, 'accuracy': 0.2092422204543022, 'macro avg': {'precision': 0.332634100431341, 'recall': 0.3327710586482958, 'f1-score': 0.14117489543013043, 'support': 2588101}, 'weighted avg': {'precision': 0.3596346345506976, 'recall': 0.2092422204543022, 'f1-score': 0.10329570017139508, 'support': 2588101}}
[[ 31010 976618  17399]
 [ 16807 489694   9971]
 [ 36858 988908  20836]]
Evaluating performance on  train set...
1686/1686 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1291468
{'0': {'precision': 0.3469706320107453, 'recall': 0.06541467621172509, 'f1-score': 0.11007652840879645, 'support': 146114}, '1': {'precision': 0.3389704981416688, 'recall': 0.8703178087554704, 'f1-score': 0.48791021875067364, 'support': 143042}, '2': {'precision': 0.3504461856567635, 'recall': 0.09044883858101846, 'f1-score': 0.14378683693516703, 'support': 142412}, 'accuracy': 0.3404585140696252, 'macro avg': {'precision': 0.3454624386030592, 'recall': 0.342060441182738, 'f1-score': 0.24725786136487904, 'support': 431568}, 'weighted avg': {'precision': 0.34546589902993186, 'recall': 0.3404585140696252, 'f1-score': 0.24643241946591904, 'support': 431568}}
[[  9558 123125  13431]
 [  8106 124492  10444]
 [  9883 119648  12881]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1306072
{'0': {'precision': 0.30058965424819084, 'recall': 0.03898293301817929, 'f1-score': 0.06901538461538462, 'support': 57538}, '1': {'precision': 0.34204403978923276, 'recall': 0.9252304656937783, 'f1-score': 0.4994491167505234, 'support': 58794}, '2': {'precision': 0.42072732499640647, 'recall': 0.0913517056271652, 'f1-score': 0.15011026206472128, 'support': 64082}, 'accuracy': 0.3463977296662122, 'macro avg': {'precision': 0.35445367301127667, 'recall': 0.3518550347797076, 'f1-score': 0.23952492114354307, 'support': 180414}, 'weighted avg': {'precision': 0.35677116654982577, 'recall': 0.3463977296662122, 'f1-score': 0.2380911923900681, 'support': 180414}}
[[ 2243 50211  5084]
 [ 1420 54398  2976]
 [ 3799 54429  5854]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
6546/6546 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1287631
{'0': {'precision': 0.34798114711682354, 'recall': 0.045706885149533395, 'f1-score': 0.08080070015799018, 'support': 544360}, '1': {'precision': 0.357471321923137, 'recall': 0.7934797935643984, 'f1-score': 0.4928902138551951, 'support': 602803}, '2': {'precision': 0.2822424640811344, 'recall': 0.1421474595445379, 'f1-score': 0.18907163912831784, 'support': 528606}, 'accuracy': 0.34511498899908044, 'macro avg': {'precision': 0.32923164437369834, 'recall': 0.32711137941948987, 'f1-score': 0.254254184380501, 'support': 1675769}, 'weighted avg': {'precision': 0.33065826046538566, 'recall': 0.34511498899908044, 'f1-score': 0.26318947993047986, 'support': 1675769}}
[[ 24881 426561  92918]
 [ 26324 478312  98167]
 [ 20296 433170  75140]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1275114
{'0': {'precision': 0.3079007615754801, 'recall': 0.06188432608062805, 'f1-score': 0.10305570324961687, 'support': 106489}, '1': {'precision': 0.3395531126952296, 'recall': 0.8715773851457341, 'f1-score': 0.48871168649220886, 'support': 106461}, '2': {'precision': 0.34340016916264493, 'recall': 0.0677862895305441, 'f1-score': 0.11322271344089108, 'support': 101820}, 'accuracy': 0.3376465355656511, 'macro avg': {'precision': 0.33028468114445153, 'recall': 0.3337493335856354, 'f1-score': 0.23499670106090562, 'support': 314770}, 'weighted avg': {'precision': 0.3300893139568531, 'recall': 0.3376465355656511, 'f1-score': 0.23678041211534465, 'support': 314770}}
[[ 6590 93290  6609]
 [ 7084 92789  6588]
 [ 7729 87189  6902]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1127667
{'0': {'precision': 0.33707865168539325, 'recall': 0.0016541685046316719, 'f1-score': 0.003292181069958848, 'support': 36272}, '1': {'precision': 0.38209434098084183, 'recall': 0.8765274828969096, 'f1-score': 0.5321951114707841, 'support': 42390}, '2': {'precision': 0.3387247861112846, 'recall': 0.15598757621074427, 'f1-score': 0.2136063798365659, 'support': 34772}, 'accuracy': 0.3759014052224201, 'macro avg': {'precision': 0.35263259292583987, 'recall': 0.34472307587076184, 'f1-score': 0.24969789079243632, 'support': 113434}, 'weighted avg': {'precision': 0.35440550655687064, 'recall': 0.3759014052224201, 'f1-score': 0.26541147986223845, 'support': 113434}}
[[   60 30794  5418]
 [   63 37156  5171]
 [   55 29293  5424]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
7633/7633 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.136693
{'0': {'precision': 0.4037859581953642, 'recall': 0.0918298158991262, 'f1-score': 0.1496303876585786, 'support': 679899}, '1': {'precision': 0.3066564748315832, 'recall': 0.9040605753774454, 'f1-score': 0.4579699757785616, 'support': 586641}, '2': {'precision': 0.3351556350626118, 'recall': 0.03406657667198101, 'f1-score': 0.06184679456453852, 'support': 687448}, 'accuracy': 0.31536171153558773, 'macro avg': {'precision': 0.34853268936318643, 'recall': 0.34331898931618426, 'f1-score': 0.22314905266722626, 'support': 1953988}, 'weighted avg': {'precision': 0.35047963511304425, 'recall': 0.31536171153558773, 'f1-score': 0.2113185806305842, 'support': 1953988}}
[[ 62435 590843  26621]
 [ 36447 530359  19835]
 [ 55742 608287  23419]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1203194
{'0': {'precision': 0.3473862673071489, 'recall': 0.04412936573459205, 'f1-score': 0.07831072042805275, 'support': 139295}, '1': {'precision': 0.3364824265152403, 'recall': 0.9262561312696586, 'f1-score': 0.4936396512211752, 'support': 136391}, '2': {'precision': 0.30607900339036503, 'recall': 0.029828497664125892, 'f1-score': 0.05435946984813796, 'support': 130144}, 'accuracy': 0.3360076879481556, 'macro avg': {'precision': 0.3299825657375848, 'recall': 0.33340466488945886, 'f1-score': 0.20876994716578864, 'support': 405830}, 'weighted avg': {'precision': 0.3304750525013555, 'recall': 0.3360076879481556, 'f1-score': 0.21021328220104224, 'support': 405830}}
[[  6147 128677   4471]
 [  5728 126333   4330]
 [  5820 120442   3882]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.113656
{'0': {'precision': 0.27879373404181906, 'recall': 0.09086615235824655, 'f1-score': 0.13706065951960916, 'support': 44461}, '1': {'precision': 0.3869808963272285, 'recall': 0.8391322947488503, 'f1-score': 0.529687095649043, 'support': 56102}, '2': {'precision': 0.3733693626537458, 'recall': 0.08652185178787355, 'f1-score': 0.14048804431666784, 'support': 46312}, 'accuracy': 0.3753123404255319, 'macro avg': {'precision': 0.34638133100759777, 'recall': 0.3388400996316568, 'f1-score': 0.26907859982844, 'support': 146875}, 'weighted avg': {'precision': 0.349939284277132, 'recall': 0.3753123404255319, 'f1-score': 0.2881133054052594, 'support': 146875}}
[[ 4040 36992  3429]
 [ 5729 47077  3296]
 [ 4722 37583  4007]]
testing model on single stock: results/universal/W10/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
22048/22048 - 168s - 168s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1565486
{'0': {'precision': 0.3767897602581288, 'recall': 0.044178313686473014, 'f1-score': 0.07908407906831022, 'support': 2156918}, '1': {'precision': 0.24480453790746187, 'recall': 0.8848780630789073, 'f1-score': 0.3835097843364865, 'support': 1364640}, '2': {'precision': 0.3913382958815793, 'recall': 0.08453623304483843, 'f1-score': 0.13903776465888756, 'support': 2122510}, 'accuracy': 0.2626222788244224, 'macro avg': {'precision': 0.33764419801572326, 'recall': 0.33786420327007294, 'f1-score': 0.2005438760212281, 'support': 5644068}, 'weighted avg': {'precision': 0.3503490969843192, 'recall': 0.2626222788244224, 'f1-score': 0.17523525790598907, 'support': 5644068}}
[[  95289 1881864  179765]
 [  57793 1207540   99307]
 [  99815 1843266  179429]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1151863
{'0': {'precision': 0.34015461573442474, 'recall': 0.001617010605687208, 'f1-score': 0.0032187202144665986, 'support': 462582}, '1': {'precision': 0.3294285743385893, 'recall': 0.989327186725074, 'f1-score': 0.49427294166188657, 'support': 457705}, '2': {'precision': 0.34276946682009973, 'recall': 0.009516324500701797, 'f1-score': 0.01851851851851852, 'support': 469509}, 'accuracy': 0.32957067080348484, 'macro avg': {'precision': 0.3374508856310379, 'recall': 0.33348684061048767, 'f1-score': 0.17200339346495722, 'support': 1389796}, 'weighted avg': {'precision': 0.3375055459006529, 'recall': 0.32957067080348484, 'f1-score': 0.1701075049206598, 'support': 1389796}}
[[   748 457458   4376]
 [   694 452820   4191]
 [   757 464284   4468]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1080964
{'0': {'precision': 0.2948207171314741, 'recall': 0.0014701402593274438, 'f1-score': 0.0029256913922732753, 'support': 151006}, '1': {'precision': 0.3523787220785303, 'recall': 0.988735633532611, 'f1-score': 0.5195819395415517, 'support': 170449}, '2': {'precision': 0.33548248441865464, 'recall': 0.009623209133726236, 'f1-score': 0.01870973541485632, 'support': 162212}, 'accuracy': 0.352126566418631, 'macro avg': {'precision': 0.327560641209553, 'recall': 0.33327632764188825, 'f1-score': 0.1804057887828938, 'support': 483667}, 'weighted avg': {'precision': 0.32874184671114137, 'recall': 0.352126566418631, 'f1-score': 0.1902940712688983, 'support': 483667}}
[[   222 149345   1439]
 [   267 168529   1653]
 [   264 160387   1561]]
training model: results/universal/W10/deepOF_L1/h300
Epoch 1/50
8543/8543 - 256s - loss: 3.2713 - accuracy300: 0.3788 - val_loss: 3.2861 - val_accuracy300: 0.3554 - 256s/epoch - 30ms/step
Epoch 2/50
8543/8543 - 171s - loss: 3.2666 - accuracy300: 0.3812 - val_loss: 3.2845 - val_accuracy300: 0.3572 - 171s/epoch - 20ms/step
Epoch 3/50
8543/8543 - 173s - loss: 3.2649 - accuracy300: 0.3828 - val_loss: 3.2842 - val_accuracy300: 0.3574 - 173s/epoch - 20ms/step
Epoch 4/50
8543/8543 - 173s - loss: 3.2633 - accuracy300: 0.3841 - val_loss: 3.2835 - val_accuracy300: 0.3587 - 173s/epoch - 20ms/step
Epoch 5/50
8543/8543 - 173s - loss: 3.2616 - accuracy300: 0.3850 - val_loss: 3.2842 - val_accuracy300: 0.3577 - 173s/epoch - 20ms/step
Epoch 6/50
8543/8543 - 174s - loss: 3.2606 - accuracy300: 0.3860 - val_loss: 3.2840 - val_accuracy300: 0.3583 - 174s/epoch - 20ms/step
Epoch 7/50
8543/8543 - 172s - loss: 3.2593 - accuracy300: 0.3868 - val_loss: 3.2847 - val_accuracy300: 0.3571 - 172s/epoch - 20ms/step
Epoch 8/50
8543/8543 - 171s - loss: 3.2581 - accuracy300: 0.3875 - val_loss: 3.2846 - val_accuracy300: 0.3568 - 171s/epoch - 20ms/step
Epoch 9/50
8543/8543 - 172s - loss: 3.2572 - accuracy300: 0.3883 - val_loss: 3.2846 - val_accuracy300: 0.3566 - 172s/epoch - 20ms/step
Epoch 10/50
8543/8543 - 172s - loss: 3.2563 - accuracy300: 0.3890 - val_loss: 3.2850 - val_accuracy300: 0.3573 - 172s/epoch - 20ms/step
Epoch 11/50
8543/8543 - 171s - loss: 3.2555 - accuracy300: 0.3891 - val_loss: 3.2855 - val_accuracy300: 0.3561 - 171s/epoch - 20ms/step
Epoch 12/50
8543/8543 - 171s - loss: 3.2543 - accuracy300: 0.3900 - val_loss: 3.2853 - val_accuracy300: 0.3558 - 171s/epoch - 20ms/step
Epoch 13/50
8543/8543 - 171s - loss: 3.2539 - accuracy300: 0.3904 - val_loss: 3.2855 - val_accuracy300: 0.3555 - 171s/epoch - 20ms/step
Epoch 14/50
8543/8543 - 173s - loss: 3.2531 - accuracy300: 0.3908 - val_loss: 3.2866 - val_accuracy300: 0.3538 - 173s/epoch - 20ms/step
testing model in sample: results/universal/W10/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 268s - 268s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955802
{'0': {'precision': 0.38830165982294546, 'recall': 0.6190028279101379, 'f1-score': 0.47723370329368453, 'support': 3460506}, '1': {'precision': 0.28855432812466647, 'recall': 0.11790901744191999, 'f1-score': 0.1674107034688035, 'support': 2636923}, '2': {'precision': 0.3998023896887536, 'recall': 0.34222212554291476, 'f1-score': 0.36877817589006434, 'support': 3447825}, 'accuracy': 0.38059772951039333, 'macro avg': {'precision': 0.3588861258787885, 'recall': 0.35971132363165753, 'f1-score': 0.33780752755085075, 'support': 9545254}, 'weighted avg': {'precision': 0.3649001317762071, 'recall': 0.38059772951039333, 'f1-score': 0.35246855058663124, 'support': 9545254}}
[[2142063  361750  956693]
 [1511358  310917  814648]
 [1863071  404832 1179922]]
Evaluating performance on  train set...
8543/8543 - 67s - 67s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945554
{'0': {'precision': 0.3604913952387497, 'recall': 0.6480885403011831, 'f1-score': 0.46328572262613293, 'support': 728527}, '1': {'precision': 0.33824849444290306, 'recall': 0.11443013373785503, 'f1-score': 0.17100794270443878, 'support': 724477}, '2': {'precision': 0.38305374438184464, 'recall': 0.3298914554563941, 'f1-score': 0.3544905198346793, 'support': 733708}, 'accuracy': 0.3645180526745177, 'macro avg': {'precision': 0.36059787802116583, 'recall': 0.36413670983181073, 'f1-score': 0.329594728388417, 'support': 2186712}, 'weighted avg': {'precision': 0.36069247614250355, 'recall': 0.3645180526745177, 'f1-score': 0.3299474321635384, 'support': 2186712}}
[[472150  75115 181262]
 [433001  82902 208574]
 [404589  87075 242044]]
Evaluating performance on  val set...
3077/3077 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944641
{'0': {'precision': 0.3466066355791392, 'recall': 0.6439055088002995, 'f1-score': 0.450639446073567, 'support': 251071}, '1': {'precision': 0.36281285020545384, 'recall': 0.11300873017893048, 'f1-score': 0.1723377887198596, 'support': 275023}, '2': {'precision': 0.3807844940643469, 'recall': 0.3428369887328587, 'f1-score': 0.3608157369694109, 'support': 260847}, 'accuracy': 0.3585707187705304, 'macro avg': {'precision': 0.36340132661631336, 'recall': 0.3665837425706962, 'f1-score': 0.3279309905876125, 'support': 786941}, 'weighted avg': {'precision': 0.3635993626291517, 'recall': 0.3585707187705304, 'f1-score': 0.32360374484681625, 'support': 786941}}
[[161666  24807  64598]
 [163117  31080  80826]
 [141642  29777  89428]]
testing model out of sample: results/universal/W10/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 159s - 159s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943767
{'0': {'precision': 0.40125628541676917, 'recall': 0.6014254241164977, 'f1-score': 0.4813605939785704, 'support': 2006701}, '1': {'precision': 0.27963491550371067, 'recall': 0.1396278824411835, 'f1-score': 0.1862546894205207, 'support': 1455884}, '2': {'precision': 0.41594136482851435, 'recall': 0.3592958423852799, 'f1-score': 0.38554909818132604, 'support': 1998189}, 'accuracy': 0.3897073931277874, 'macro avg': {'precision': 0.3656108552496647, 'recall': 0.3667830496476537, 'f1-score': 0.3510547938601391, 'support': 5460774}, 'weighted avg': {'precision': 0.37420461794804993, 'recall': 0.3897073931277874, 'f1-score': 0.3676240720629607, 'support': 5460774}}
[[1206881  248399  551421]
 [ 795901  203282  456701]
 [1004974  275274  717941]]
Evaluating performance on  train set...
4055/4055 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09356
{'0': {'precision': 0.3730053168755236, 'recall': 0.6165127141512926, 'f1-score': 0.46479702863253824, 'support': 353897}, '1': {'precision': 0.3312225497864148, 'recall': 0.13190413724116037, 'f1-score': 0.18867245567212582, 'support': 333894}, '2': {'precision': 0.3878581732499304, 'recall': 0.35446408144589336, 'f1-score': 0.3704099944266219, 'support': 349680}, 'accuracy': 0.372225344130101, 'macro avg': {'precision': 0.36402867997062294, 'recall': 0.3676269776127821, 'f1-score': 0.34129315957709533, 'support': 1037471}, 'weighted avg': {'precision': 0.36456434029164964, 'recall': 0.372225344130101, 'f1-score': 0.3441174180360312, 'support': 1037471}}
[[218182  41533  94182]
 [188410  44042 101442]
 [178338  47393 123949]]
Evaluating performance on  val set...
1545/1545 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937691
{'0': {'precision': 0.3621401147453923, 'recall': 0.6336293565683646, 'f1-score': 0.46087496052872123, 'support': 131296}, '1': {'precision': 0.335608118553855, 'recall': 0.11895200745211312, 'f1-score': 0.1756478720207134, 'support': 127749}, '2': {'precision': 0.401976647206005, 'recall': 0.35475489474459004, 'f1-score': 0.3768923991241789, 'support': 135860}, 'accuracy': 0.3711930717514339, 'macro avg': {'precision': 0.36657496016841745, 'recall': 0.36911208625502256, 'f1-score': 0.33780507722453784, 'support': 394905}, 'weighted avg': {'precision': 0.36726224619124925, 'recall': 0.3711930717514339, 'f1-score': 0.3397132985537384, 'support': 394905}}
[[83193 13947 34156]
 [75006 15196 37547]
 [71527 16136 48197]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0992298
{'0': {'precision': 0.4182091260191675, 'recall': 0.5443188799731908, 'f1-score': 0.47300259660419175, 'support': 53713}, '1': {'precision': 0.2582299421009098, 'recall': 0.13899854560565136, 'f1-score': 0.18072010187936557, 'support': 33691}, '2': {'precision': 0.354443447037702, 'recall': 0.3494170482953917, 'f1-score': 0.3519123004422856, 'support': 45201}, 'accuracy': 0.3749029071301987, 'macro avg': {'precision': 0.34362750505259315, 'recall': 0.34424482462474465, 'f1-score': 0.3352116663086144, 'support': 132605}, 'weighted avg': {'precision': 0.35582738218574317, 'recall': 0.3749029071301987, 'f1-score': 0.3574662894770967, 'support': 132605}}
[[29237  7008 17468]
 [17710  4683 11298]
 [22963  6444 15794]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977013
{'0': {'precision': 0.3491946572382636, 'recall': 0.613493227504098, 'f1-score': 0.44506337036457516, 'support': 11591}, '1': {'precision': 0.3340298507462687, 'recall': 0.09797741003414762, 'f1-score': 0.15151309999322998, 'support': 11421}, '2': {'precision': 0.35881964740265865, 'recall': 0.33654611371474047, 'f1-score': 0.3473261544077387, 'support': 11309}, 'accuracy': 0.35068908248594155, 'macro avg': {'precision': 0.3473480517957303, 'recall': 0.3493389170843287, 'f1-score': 0.31463420825518124, 'support': 34321}, 'weighted avg': {'precision': 0.34731976311583335, 'recall': 0.35068908248594155, 'f1-score': 0.31517357073265895, 'support': 34321}}
[[7111 1094 3386]
 [6887 1119 3415]
 [6366 1137 3806]]
Evaluating performance on  val set...
46/46 - 1s - 597ms/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934885
{'0': {'precision': 0.42855055523085916, 'recall': 0.6311598880998494, 'f1-score': 0.5104864676703507, 'support': 4647}, '1': {'precision': 0.2586975914362177, 'recall': 0.09437032216075496, 'f1-score': 0.13829279923700524, 'support': 3073}, '2': {'precision': 0.3779930051116492, 'recall': 0.35461887935386166, 'f1-score': 0.36593306420106786, 'support': 3962}, 'accuracy': 0.39616504023283683, 'macro avg': {'precision': 0.35508038392624197, 'recall': 0.3600496965381553, 'f1-score': 0.3382374437028079, 'support': 11682}, 'weighted avg': {'precision': 0.3667231993574434, 'recall': 0.39616504023283683, 'f1-score': 0.363553431577133, 'support': 11682}}
[[2933  413 1301]
 [1772  290 1011]
 [2139  418 1405]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
1840/1840 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0879968
{'0': {'precision': 0.40336419987266314, 'recall': 0.725875487536287, 'f1-score': 0.5185651700022478, 'support': 168449}, '1': {'precision': 0.2847513524459745, 'recall': 0.07909708940711335, 'f1-score': 0.12380431296341717, 'support': 124442}, '2': {'precision': 0.4747339826807342, 'recall': 0.35527401991340535, 'f1-score': 0.40640728737396936, 'support': 178071}, 'accuracy': 0.4148530030023654, 'macro avg': {'precision': 0.38761651166645733, 'recall': 0.38674886561893523, 'f1-score': 0.34959225677987815, 'support': 470962}, 'weighted avg': {'precision': 0.3990081555101541, 'recall': 0.4148530030023654, 'f1-score': 0.37185079200757665, 'support': 470962}}
[[122273   9972  36204]
 [ 80805   9843  33794]
 [100055  14752  63264]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0886378
{'0': {'precision': 0.34457654761623374, 'recall': 0.7236175915814553, 'f1-score': 0.4668470689958849, 'support': 40292}, '1': {'precision': 0.4326154679669511, 'recall': 0.11773379040878765, 'f1-score': 0.1850950394065832, 'support': 54258}, '2': {'precision': 0.40300952275188096, 'recall': 0.3553575362921981, 'f1-score': 0.3776864234792111, 'support': 40849}, 'accuracy': 0.36972208066529294, 'macro avg': {'precision': 0.39340051277835525, 'recall': 0.3989029727608137, 'f1-score': 0.34320951062722643, 'support': 135399}, 'weighted avg': {'precision': 0.3974849468045976, 'recall': 0.36972208066529294, 'f1-score': 0.32704230802891365, 'support': 135399}}
[[29156  3255  7881]
 [34248  6388 13622]
 [21210  5123 14516]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0876198
{'0': {'precision': 0.3777543330821402, 'recall': 0.7131394753314744, 'f1-score': 0.49389138488216283, 'support': 17573}, '1': {'precision': 0.36889166146808067, 'recall': 0.10037910937588412, 'f1-score': 0.15781514100169025, 'support': 17673}, '2': {'precision': 0.4502583123592529, 'recall': 0.38113926889437094, 'f1-score': 0.4128256513026052, 'support': 17836}, 'accuracy': 0.3975735654270751, 'macro avg': {'precision': 0.39896810230315793, 'recall': 0.3982192845339098, 'f1-score': 0.3548440590621527, 'support': 53082}, 'weighted avg': {'precision': 0.3991655643648972, 'recall': 0.3975735654270751, 'f1-score': 0.3547601561751702, 'support': 53082}}
[[12532  1234  3807]
 [11406  1774  4493]
 [ 9237  1801  6798]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975672
{'0': {'precision': 0.41188109628851, 'recall': 0.5508864423424821, 'f1-score': 0.4713489034437924, 'support': 96735}, '1': {'precision': 0.27890154305248643, 'recall': 0.2145056796722931, 'f1-score': 0.24250137532946325, 'support': 68842}, '2': {'precision': 0.3706157503258953, 'recall': 0.2948619397976988, 'f1-score': 0.3284271754936736, 'support': 81957}, 'accuracy': 0.37256700089684647, 'macro avg': {'precision': 0.3537994632222972, 'recall': 0.35341802060415795, 'f1-score': 0.34742581808897643, 'support': 247534}, 'weighted avg': {'precision': 0.36123527647009174, 'recall': 0.37256700089684647, 'f1-score': 0.3603833084626806, 'support': 247534}}
[[53290 20141 23304]
 [36340 14767 17735]
 [39752 18039 24166]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988041
{'0': {'precision': 0.3246486343145054, 'recall': 0.5654081514836624, 'f1-score': 0.41246578226995156, 'support': 17322}, '1': {'precision': 0.3416067267754027, 'recall': 0.17408363448631906, 'f1-score': 0.23063506720016416, 'support': 19370}, '2': {'precision': 0.37196399950684256, 'recall': 0.30834483111042976, 'f1-score': 0.33717973792294154, 'support': 19569}, 'accuracy': 0.34126659675441245, 'macro avg': {'precision': 0.3460731201989169, 'recall': 0.34927887236013705, 'f1-score': 0.3267601957976857, 'support': 56261}, 'weighted avg': {'precision': 0.34694458768213887, 'recall': 0.34126659675441245, 'f1-score': 0.32367721554116213, 'support': 56261}}
[[ 9794  2973  4555]
 [10365  3372  5633]
 [10009  3526  6034]]
Evaluating performance on  val set...
79/79 - 1s - 801ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976355
{'0': {'precision': 0.35238915195867415, 'recall': 0.6042220253912016, 'f1-score': 0.44515743107292405, 'support': 6774}, '1': {'precision': 0.3323943661971831, 'recall': 0.1558327219369039, 'f1-score': 0.21218781218781219, 'support': 6815}, '2': {'precision': 0.3473421608136634, 'recall': 0.2814054726368159, 'f1-score': 0.31091643047324574, 'support': 6432}, 'accuracy': 0.34788472104290497, 'macro avg': {'precision': 0.3440418929898403, 'recall': 0.3471534066549738, 'f1-score': 0.32275389124466064, 'support': 20021}, 'weighted avg': {'precision': 0.343961665219287, 'recall': 0.34788472104290497, 'f1-score': 0.3227296767869659, 'support': 20021}}
[[4093 1030 1651]
 [4003 1062 1750]
 [3519 1103 1810]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1588/1588 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0996971
{'0': {'precision': 0.3868581943969592, 'recall': 0.5263831213698836, 'f1-score': 0.4459623549186385, 'support': 146173}, '1': {'precision': 0.2842140794359224, 'recall': 0.1949776153964905, 'f1-score': 0.23128691113857985, 'support': 116598}, '2': {'precision': 0.37868131868131866, 'recall': 0.3361716953522403, 'f1-score': 0.3561625632128751, 'support': 143510}, 'accuracy': 0.36408544824887207, 'macro avg': {'precision': 0.3499178641714001, 'recall': 0.35251081070620477, 'f1-score': 0.34447060975669785, 'support': 406281}, 'weighted avg': {'precision': 0.3545122024599045, 'recall': 0.36408544824887207, 'f1-score': 0.35263311849960494, 'support': 406281}}
[[76943 27825 41405]
 [56113 22734 37751]
 [65836 29430 48244]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974495
{'0': {'precision': 0.3480268481934593, 'recall': 0.6054407684981988, 'f1-score': 0.44198594423033327, 'support': 24151}, '1': {'precision': 0.33453388055951083, 'recall': 0.1602664419565828, 'f1-score': 0.21671188279978296, 'support': 24921}, '2': {'precision': 0.3773856512653819, 'recall': 0.30765445184736523, 'f1-score': 0.33897103292944886, 'support': 26416}, 'accuracy': 0.35426822806273844, 'macro avg': {'precision': 0.3533154600061173, 'recall': 0.3577872207673823, 'f1-score': 0.33255628665318837, 'support': 75488}, 'weighted avg': {'precision': 0.3538461028503886, 'recall': 0.35426822806273844, 'f1-score': 0.33156711233870934, 'support': 75488}}
[[14622  3545  5984]
 [13503  3994  7424]
 [13889  4400  8127]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988722
{'0': {'precision': 0.33721704394141144, 'recall': 0.5989357508868742, 'f1-score': 0.431492261820247, 'support': 10148}, '1': {'precision': 0.3519216277317257, 'recall': 0.15509797409498505, 'f1-score': 0.21530659289995385, 'support': 12044}, '2': {'precision': 0.3419477150269407, 'recall': 0.30702383085468554, 'f1-score': 0.32354607250755285, 'support': 11162}, 'accuracy': 0.3409785932721712, 'macro avg': {'precision': 0.3436954622333593, 'recall': 0.3536858519455149, 'f1-score': 0.3234483090759179, 'support': 33354}, 'weighted avg': {'precision': 0.34410994307876297, 'recall': 0.3409785932721712, 'f1-score': 0.3173039917001923, 'support': 33354}}
[[6078 1478 2592]
 [6173 1868 4003]
 [5773 1962 3427]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
2104/2104 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000122
{'0': {'precision': 0.4111104338254013, 'recall': 0.543623079147879, 'f1-score': 0.46817068191098404, 'support': 210909}, '1': {'precision': 0.23485180240320427, 'recall': 0.17475203458799593, 'f1-score': 0.20039280197221224, 'support': 125824}, '2': {'precision': 0.3998012527101903, 'recall': 0.32891692225365793, 'f1-score': 0.36091153500080186, 'support': 201823}, 'accuracy': 0.37698215227385823, 'macro avg': {'precision': 0.3485878296462653, 'recall': 0.34909734532984427, 'f1-score': 0.34315833962799935, 'support': 538556}, 'weighted avg': {'precision': 0.36569265201574414, 'recall': 0.37698215227385823, 'f1-score': 0.36541396436950324, 'support': 538556}}
[[114655  35382  60872]
 [ 65051  21988  38785]
 [ 99185  36255  66383]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982782
{'0': {'precision': 0.352134070006176, 'recall': 0.5751049561092634, 'f1-score': 0.4368108830015219, 'support': 36682}, '1': {'precision': 0.3194757442770727, 'recall': 0.15044544362834084, 'f1-score': 0.20456055744365756, 'support': 35807}, '2': {'precision': 0.36712303648921213, 'recall': 0.32464057939682195, 'f1-score': 0.34457734560995895, 'support': 37004}, 'accuracy': 0.35158411953275553, 'macro avg': {'precision': 0.3462442835908203, 'recall': 0.3500636597114754, 'f1-score': 0.3286495953517128, 'support': 109493}, 'weighted avg': {'precision': 0.34651960192471204, 'recall': 0.35158411953275553, 'f1-score': 0.3296880785766925, 'support': 109493}}
[[21096  5392 10194]
 [19905  5387 10515]
 [18908  6083 12013]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977606
{'0': {'precision': 0.3626948215183509, 'recall': 0.5965927886205756, 'f1-score': 0.4511287599274592, 'support': 12092}, '1': {'precision': 0.29760609357997825, 'recall': 0.14843962008141112, 'f1-score': 0.1980807532138331, 'support': 11055}, '2': {'precision': 0.38909506137596345, 'recall': 0.3203039323202256, 'f1-score': 0.35136412459720723, 'support': 12766}, 'accuracy': 0.36042658647286496, 'macro avg': {'precision': 0.3497986588247642, 'recall': 0.35511211367407075, 'f1-score': 0.33352454591283315, 'support': 35913}, 'weighted avg': {'precision': 0.3520432350361181, 'recall': 0.36042658647286496, 'f1-score': 0.3377703368259324, 'support': 35913}}
[[7214 1816 3062]
 [6056 1641 3358]
 [6620 2057 4089]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/EXC
Evaluating performance on  test set...
5267/5267 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0874461
{'0': {'precision': 0.40012373475562385, 'recall': 0.6171291384452495, 'f1-score': 0.48548010471428504, 'support': 459019}, '1': {'precision': 0.32182031076932816, 'recall': 0.12190683523180904, 'f1-score': 0.17682981964373903, 'support': 417089}, '2': {'precision': 0.41856983179981044, 'recall': 0.4275667477270609, 'f1-score': 0.4230204579487142, 'support': 472076}, 'accuracy': 0.39754514220610837, 'macro avg': {'precision': 0.3801712924415875, 'recall': 0.38886757380137316, 'f1-score': 0.36177679410224606, 'support': 1348184}, 'weighted avg': {'precision': 0.38235795716236604, 'recall': 0.39754514220610837, 'f1-score': 0.3681219852318608, 'support': 1348184}}
[[283274  47430 128315]
 [214179  50846 152064]
 [210513  59719 201844]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0865215
{'0': {'precision': 0.387723798188611, 'recall': 0.6756130291570087, 'f1-score': 0.49269665647595484, 'support': 90167}, '1': {'precision': 0.34056498907585575, 'recall': 0.09936478114026259, 'f1-score': 0.15384349000493477, 'support': 89418}, '2': {'precision': 0.42616062505678204, 'recall': 0.4093284029800277, 'f1-score': 0.4175749584105312, 'support': 91677}, 'accuracy': 0.39566544521532687, 'macro avg': {'precision': 0.3848164707737496, 'recall': 0.39476873775909965, 'f1-score': 0.35470503496380695, 'support': 271262}, 'weighted avg': {'precision': 0.3851688018513023, 'recall': 0.39566544521532687, 'f1-score': 0.35560961755030546, 'support': 271262}}
[[60918  7383 21866]
 [51869  8885 28664]
 [44330  9821 37526]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0861062
{'0': {'precision': 0.3655811490601006, 'recall': 0.6546971804273612, 'f1-score': 0.46917579368225526, 'support': 31636}, '1': {'precision': 0.373721632414532, 'recall': 0.10255245222504343, 'f1-score': 0.16094123568642255, 'support': 37415}, '2': {'precision': 0.41582611555750465, 'recall': 0.44159510988211326, 'f1-score': 0.42832338118832847, 'support': 34355}, 'accuracy': 0.38411697580411197, 'macro avg': {'precision': 0.38504296567737906, 'recall': 0.39961491417817263, 'f1-score': 0.3528134701856687, 'support': 103406}, 'weighted avg': {'precision': 0.3852196807577233, 'recall': 0.38411697580411197, 'f1-score': 0.34407589020815377, 'support': 103406}}
[[20712  2647  8277]
 [20542  3837 13036]
 [15401  3783 15171]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/AAL
Evaluating performance on  test set...
10110/10110 - 74s - 74s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0919464
{'0': {'precision': 0.4139859360592835, 'recall': 0.6321970514502017, 'f1-score': 0.5003344371744678, 'support': 963728}, '1': {'precision': 0.2666037929267043, 'recall': 0.10049553768775871, 'f1-score': 0.14596862094473922, 'support': 646974}, '2': {'precision': 0.43837921225332777, 'recall': 0.39133860040065727, 'f1-score': 0.4135254293727039, 'support': 977394}, 'accuracy': 0.4083217933183313, 'macro avg': {'precision': 0.37298964707977184, 'recall': 0.37467706317953925, 'f1-score': 0.3532761624973037, 'support': 2588096}, 'weighted avg': {'precision': 0.38635536405629145, 'recall': 0.4083217933183313, 'f1-score': 0.3789664226337361, 'support': 2588096}}
[[609266  81819 272643]
 [364577  65018 217379]
 [497864  97038 382492]]
Evaluating performance on  train set...
1686/1686 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907086
{'0': {'precision': 0.38513492226020385, 'recall': 0.6567698434551352, 'f1-score': 0.48554342186596233, 'support': 148903}, '1': {'precision': 0.3306818805200505, 'recall': 0.08834046544346093, 'f1-score': 0.13943214017232405, 'support': 136472}, '2': {'precision': 0.4074470194922937, 'recall': 0.3934920754355603, 'f1-score': 0.40034797738147015, 'support': 146191}, 'accuracy': 0.38783407404661163, 'macro avg': {'precision': 0.3744212740908493, 'recall': 0.37953412811138554, 'f1-score': 0.34177451313991886, 'support': 431566}, 'weighted avg': {'precision': 0.37547362432221576, 'recall': 0.38783407404661163, 'f1-score': 0.34723478295574556, 'support': 431566}}
[[97795 11193 39915]
 [80672 12056 43744]
 [75457 13209 57525]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0915691
{'0': {'precision': 0.3806334677602066, 'recall': 0.6742599370705709, 'f1-score': 0.48658167136824676, 'support': 62292}, '1': {'precision': 0.28308635666836995, 'recall': 0.07465157465157465, 'f1-score': 0.1181470592715585, 'support': 51948}, '2': {'precision': 0.44903317367394, 'recall': 0.38250672469549973, 'f1-score': 0.4131087609348479, 'support': 66174}, 'accuracy': 0.39459798020109305, 'macro avg': {'precision': 0.3709176660341722, 'recall': 0.3771394121392151, 'f1-score': 0.3392791638582177, 'support': 180414}, 'weighted avg': {'precision': 0.37763428151156, 'recall': 0.39459798020109305, 'f1-score': 0.3535463326239226, 'support': 180414}}
[[42001  4295 15996]
 [33008  3878 15062]
 [35336  5526 25312]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/WBA
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954386
{'0': {'precision': 0.36642558163925815, 'recall': 0.6049024734475588, 'f1-score': 0.4563890428311298, 'support': 571793}, '1': {'precision': 0.3322754749568221, 'recall': 0.14023792428555287, 'f1-score': 0.19723302227473452, 'support': 548746}, '2': {'precision': 0.3672019462774645, 'recall': 0.3308352469719483, 'f1-score': 0.3480712711589806, 'support': 555225}, 'accuracy': 0.36193759980522316, 'macro avg': {'precision': 0.3553010009578483, 'recall': 0.35865854823502, 'f1-score': 0.33389777875494825, 'support': 1675764}, 'weighted avg': {'precision': 0.355500011340987, 'recall': 0.36193759980522316, 'f1-score': 0.3356372159432693, 'support': 1675764}}
[[345879  73522 152392]
 [307634  76955 164157]
 [290414  81123 183688]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944189
{'0': {'precision': 0.3774249948330084, 'recall': 0.6141784532596444, 'f1-score': 0.4675383087744306, 'support': 110012}, '1': {'precision': 0.3277840435443535, 'recall': 0.13515918028974958, 'f1-score': 0.1913972183050702, 'support': 98913}, '2': {'precision': 0.37505923484377796, 'recall': 0.33649839857146907, 'f1-score': 0.3547339694428398, 'support': 105843}, 'accuracy': 0.3702790626747319, 'macro avg': {'precision': 0.36008942440704667, 'recall': 0.3619453440402877, 'f1-score': 0.3378898321741135, 'support': 314768}, 'weighted avg': {'precision': 0.3610302706254815, 'recall': 0.3702790626747319, 'f1-score': 0.34283219706844587, 'support': 314768}}
[[67567 13106 29339]
 [55538 13369 30006]
 [55916 14311 35616]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932267
{'0': {'precision': 0.3653911961424794, 'recall': 0.6192760920570479, 'f1-score': 0.4596030247595942, 'support': 37933}, '1': {'precision': 0.35739099610067354, 'recall': 0.12877762166304765, 'f1-score': 0.18933333333333335, 'support': 39145}, '2': {'precision': 0.3627022861546365, 'recall': 0.349562634098036, 'f1-score': 0.3560112619237719, 'support': 36354}, 'accuracy': 0.36356583680090276, 'macro avg': {'precision': 0.36182815946592983, 'recall': 0.3658721159393772, 'f1-score': 0.33498254000556643, 'support': 113432}, 'weighted avg': {'precision': 0.361768581145525, 'recall': 0.36356583680090276, 'f1-score': 0.3331335803610606, 'support': 113432}}
[[23491  4230 10212]
 [21987  5041 12117]
 [18812  4834 12708]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
7633/7633 - 56s - 56s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952826
{'0': {'precision': 0.37871223492137907, 'recall': 0.5878280439426304, 'f1-score': 0.46064851540925406, 'support': 681616}, '1': {'precision': 0.30482758620689654, 'recall': 0.16711480261061437, 'f1-score': 0.21587890007876923, 'support': 580553}, '2': {'precision': 0.3974312815896974, 'recall': 0.33188689445428976, 'f1-score': 0.3617138257029745, 'support': 691814}, 'accuracy': 0.3722120407393514, 'macro avg': {'precision': 0.36032370090599103, 'recall': 0.3622765803358449, 'f1-score': 0.3460804137303326, 'support': 1953983}, 'weighted avg': {'precision': 0.36338771269506337, 'recall': 0.3722120407393514, 'f1-score': 0.35289622794645675, 'support': 1953983}}
[[400673 104003 176940]
 [312358  97019 171176]
 [344957 117253 229604]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094232
{'0': {'precision': 0.37311951335008925, 'recall': 0.5878521366724295, 'f1-score': 0.45649443071892337, 'support': 139399}, '1': {'precision': 0.3294418534677298, 'recall': 0.16738518926190912, 'f1-score': 0.22198343588755864, 'support': 130824}, '2': {'precision': 0.37503340682835573, 'recall': 0.331140722824043, 'f1-score': 0.3517229765452744, 'support': 135607}, 'accuracy': 0.3665303205775817, 'macro avg': {'precision': 0.3591982578820582, 'recall': 0.3621260162527939, 'f1-score': 0.34340028105058545, 'support': 405830}, 'weighted avg': {'precision': 0.35967903624503905, 'recall': 0.3665303205775817, 'f1-score': 0.34588799705471795, 'support': 405830}}
[[81946 21040 36413]
 [70508 21898 38418]
 [67170 23532 44905]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950931
{'0': {'precision': 0.33188225283330663, 'recall': 0.5915895451847618, 'f1-score': 0.4252172539105704, 'support': 45491}, '1': {'precision': 0.3824003685786685, 'recall': 0.15129971927521965, 'f1-score': 0.2168149105965022, 'support': 54858}, '2': {'precision': 0.3526916358521812, 'recall': 0.3341572454111679, 'f1-score': 0.3431743684262805, 'support': 46526}, 'accuracy': 0.3455931914893617, 'macro avg': {'precision': 0.35565808575471874, 'recall': 0.3590155032903832, 'f1-score': 0.328402177644451, 'support': 146875}, 'weighted avg': {'precision': 0.3573426793721677, 'recall': 0.3455931914893617, 'f1-score': 0.32138976087523274, 'support': 146875}}
[[26912  6332 12247]
 [30271  8300 16287]
 [23906  7073 15547]]
testing model on single stock: results/universal/W10/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
22048/22048 - 165s - 165s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979052
{'0': {'precision': 0.39065159800675914, 'recall': 0.6210620725913822, 'f1-score': 0.47961967534900096, 'support': 2115072}, '1': {'precision': 0.26289404278477835, 'recall': 0.1053908679988364, 'f1-score': 0.1504630276698467, 'support': 1430048}, '2': {'precision': 0.3997058911340578, 'recall': 0.3252980190505412, 'f1-score': 0.35868367814908464, 'support': 2098943}, 'accuracy': 0.380415137109561, 'macro avg': {'precision': 0.35108384397519843, 'recall': 0.35058365321358664, 'f1-score': 0.3295887937226441, 'support': 5644063}, 'weighted avg': {'precision': 0.3616485569084242, 'recall': 0.380415137109561, 'f1-score': 0.3512462729842394, 'support': 5644063}}
[[1313591  203013  598468]
 [ 852373  150714  426961]
 [1196600  219561  682782]]
Evaluating performance on  train set...
5429/5429 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965793
{'0': {'precision': 0.3542370981350042, 'recall': 0.6471152498895248, 'f1-score': 0.45784529038555394, 'support': 463905}, '1': {'precision': 0.33400866974076293, 'recall': 0.11111743298750237, 'f1-score': 0.16675807484523555, 'support': 456967}, '2': {'precision': 0.37477998652377426, 'recall': 0.31195526770919746, 'f1-score': 0.3404939248638332, 'support': 468923}, 'accuracy': 0.35779377534096757, 'macro avg': {'precision': 0.35434191813318044, 'recall': 0.3567293168620749, 'f1-score': 0.32169909669820757, 'support': 1389795}, 'weighted avg': {'precision': 0.35451721758707877, 'recall': 0.35779377534096757, 'f1-score': 0.322540438951814, 'support': 1389795}}
[[300200  47677 116028]
 [278184  50777 128006]
 [269071  53569 146283]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969968
{'0': {'precision': 0.33577281881131965, 'recall': 0.6429402852107867, 'f1-score': 0.441154554905609, 'support': 153781}, '1': {'precision': 0.36336488728408317, 'recall': 0.11032557808777689, 'f1-score': 0.16926007246080343, 'support': 168746}, '2': {'precision': 0.36995455566749536, 'recall': 0.31676182201812086, 'f1-score': 0.34129804654459384, 'support': 161140}, 'accuracy': 0.3484463484174029, 'macro avg': {'precision': 0.3563640872542994, 'recall': 0.35667589510556147, 'f1-score': 0.3172375579703354, 'support': 483667}, 'weighted avg': {'precision': 0.35678747613445544, 'recall': 0.3484463484174029, 'f1-score': 0.3130251102837408, 'support': 483667}}
[[ 98872  15110  39799]
 [103000  18617  47129]
 [ 92589  17508  51043]]
training model: results/universal/W10/deepOF_L1/h500
Epoch 1/50
8543/8543 - 176s - loss: 3.2801 - accuracy500: 0.3703 - val_loss: 3.3033 - val_accuracy500: 0.3474 - 176s/epoch - 21ms/step
Epoch 2/50
8543/8543 - 175s - loss: 3.2777 - accuracy500: 0.3705 - val_loss: 3.2972 - val_accuracy500: 0.3508 - 175s/epoch - 20ms/step
Epoch 3/50
8543/8543 - 169s - loss: 3.2755 - accuracy500: 0.3734 - val_loss: 3.2990 - val_accuracy500: 0.3512 - 169s/epoch - 20ms/step
Epoch 4/50
8543/8543 - 170s - loss: 3.2741 - accuracy500: 0.3749 - val_loss: 3.2990 - val_accuracy500: 0.3508 - 170s/epoch - 20ms/step
Epoch 5/50
8543/8543 - 170s - loss: 3.2727 - accuracy500: 0.3761 - val_loss: 3.3010 - val_accuracy500: 0.3497 - 170s/epoch - 20ms/step
Epoch 6/50
8543/8543 - 171s - loss: 3.2716 - accuracy500: 0.3776 - val_loss: 3.3021 - val_accuracy500: 0.3478 - 171s/epoch - 20ms/step
Epoch 7/50
8543/8543 - 171s - loss: 3.2703 - accuracy500: 0.3783 - val_loss: 3.3061 - val_accuracy500: 0.3457 - 171s/epoch - 20ms/step
Epoch 8/50
8543/8543 - 169s - loss: 3.2689 - accuracy500: 0.3797 - val_loss: 3.3081 - val_accuracy500: 0.3456 - 169s/epoch - 20ms/step
Epoch 9/50
8543/8543 - 169s - loss: 3.2681 - accuracy500: 0.3803 - val_loss: 3.3057 - val_accuracy500: 0.3461 - 169s/epoch - 20ms/step
Epoch 10/50
8543/8543 - 170s - loss: 3.2671 - accuracy500: 0.3811 - val_loss: 3.3071 - val_accuracy500: 0.3462 - 170s/epoch - 20ms/step
Epoch 11/50
8543/8543 - 170s - loss: 3.2661 - accuracy500: 0.3821 - val_loss: 3.3077 - val_accuracy500: 0.3478 - 170s/epoch - 20ms/step
Epoch 12/50
8543/8543 - 170s - loss: 3.2654 - accuracy500: 0.3828 - val_loss: 3.3074 - val_accuracy500: 0.3471 - 170s/epoch - 20ms/step
testing model in sample: results/universal/W10/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 264s - 264s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0927008
{'0': {'precision': 0.38444513444899564, 'recall': 0.6786918825177717, 'f1-score': 0.4908488517659108, 'support': 3520907}, '1': {'precision': 0.27555192150449714, 'recall': 0.0005328473933761693, 'f1-score': 0.001063637981186706, 'support': 2529805}, '2': {'precision': 0.3916156483353596, 'recall': 0.3725735733037405, 'f1-score': 0.38185736550697413, 'support': 3494542}, 'accuracy': 0.3868868235460261, 'macro avg': {'precision': 0.3505375680962841, 'recall': 0.35059943440496283, 'f1-score': 0.29125661841802386, 'support': 9545254}, 'weighted avg': {'precision': 0.3582100093663551, 'recall': 0.3868868235460261, 'f1-score': 0.3211376624007099, 'support': 9545254}}
[[2389611    1556 1129740]
 [1635549    1348  892908]
 [2190580    1988 1301974]]
Evaluating performance on  train set...
8543/8543 - 65s - 65s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971705
{'0': {'precision': 0.35135868463912545, 'recall': 0.6988524655117998, 'f1-score': 0.4676162179457878, 'support': 731917}, '1': {'precision': 0.29683257918552036, 'recall': 0.00045739976600097336, 'f1-score': 0.0009133920540460762, 'support': 717097}, '2': {'precision': 0.3686381922216863, 'recall': 0.3647034423300592, 'f1-score': 0.36666026131124435, 'support': 737698}, 'accuracy': 0.35709823698776977, 'macro avg': {'precision': 0.33894315201544406, 'recall': 0.3546711025359533, 'f1-score': 0.2783966237703594, 'support': 2186712}, 'weighted avg': {'precision': 0.3393070525733464, 'recall': 0.35709823698776977, 'f1-score': 0.28051055262000196, 'support': 2186712}}
[[511502    344 220071]
 [476057    328 240712]
 [468224    433 269041]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983738
{'0': {'precision': 0.33944684208615844, 'recall': 0.699865680871932, 'f1-score': 0.4571621913691426, 'support': 253873}, '1': {'precision': 0.3584905660377358, 'recall': 0.00042618256315165746, 'f1-score': 0.0008513530165155019, 'support': 267491}, '2': {'precision': 0.3724277333657558, 'recall': 0.36908316608742475, 'f1-score': 0.3707479069310039, 'support': 265577}, 'accuracy': 0.3504849791788711, 'macro avg': {'precision': 0.35678838049655, 'recall': 0.35645834317416947, 'f1-score': 0.276253817105554, 'support': 786941}, 'weighted avg': {'precision': 0.3570504374343396, 'recall': 0.3504849791788711, 'f1-score': 0.2728933721310928, 'support': 786941}}
[[177677     84  76112]
 [178317    114  89060]
 [167437    120  98020]]
testing model out of sample: results/universal/W10/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 161s - 161s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935788
{'0': {'precision': 0.3769959160320973, 'recall': 0.6672820670920875, 'f1-score': 0.4817924311351823, 'support': 1959158}, '1': {'precision': 0.2787193973634652, 'recall': 0.0006704954806274699, 'f1-score': 0.0013377727761948758, 'support': 1545126}, '2': {'precision': 0.3855634324963267, 'recall': 0.3920393153044483, 'f1-score': 0.3887744082947083, 'support': 1956490}, 'accuracy': 0.3800501540624095, 'macro avg': {'precision': 0.34709291529729636, 'recall': 0.35333062595905446, 'f1-score': 0.2906348707353618, 'support': 5460774}, 'weighted avg': {'precision': 0.35225815103810765, 'recall': 0.3800501540624095, 'f1-score': 0.3125212223360729, 'support': 5460774}}
[[1307311    1169  650678]
 [ 972438    1036  571652]
 [1187957    1512  767021]]
Evaluating performance on  train set...
4055/4055 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962012
{'0': {'precision': 0.35937640318264275, 'recall': 0.681064706082576, 'f1-score': 0.4704900300978179, 'support': 352548}, '1': {'precision': 0.364656381486676, 'recall': 0.000771492749451795, 'f1-score': 0.0015397279419167242, 'support': 337009}, '2': {'precision': 0.3672477308115909, 'recall': 0.3891191501348034, 'f1-score': 0.37786721894416003, 'support': 347914}, 'accuracy': 0.36217687048601843, 'macro avg': {'precision': 0.3637601718269699, 'recall': 0.35698511632227703, 'f1-score': 0.2832989923279649, 'support': 1037471}, 'weighted avg': {'precision': 0.36373117096792235, 'recall': 0.36217687048601843, 'f1-score': 0.2870967158760499, 'support': 1037471}}
[[240108    196 112244]
 [215739    260 121010]
 [212277    257 135380]]
Evaluating performance on  val set...
1545/1545 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992475
{'0': {'precision': 0.33311040347770576, 'recall': 0.7026281830350344, 'f1-score': 0.45195334149642324, 'support': 124763}, '1': {'precision': 0.30697674418604654, 'recall': 0.00047427080863172874, 'f1-score': 0.0009470784066123293, 'support': 139161}, '2': {'precision': 0.3645763639681285, 'recall': 0.36609889984043487, 'f1-score': 0.36533604562129296, 'support': 130981}, 'accuracy': 0.3435763031615199, 'macro avg': {'precision': 0.3348878372106269, 'recall': 0.35640045122803365, 'f1-score': 0.27274548850810953, 'support': 394905}, 'weighted avg': {'precision': 0.3343376779115809, 'recall': 0.3435763031615199, 'f1-score': 0.26429377119758773, 'support': 394905}}
[[87662    68 37033]
 [92552    66 46543]
 [82948    81 47952]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942153
{'0': {'precision': 0.4028659973363385, 'recall': 0.5952394467465137, 'f1-score': 0.4805138270492366, 'support': 52851}, '1': {'precision': 0.23214285714285715, 'recall': 0.0007222222222222222, 'f1-score': 0.001439964554718653, 'support': 36000}, '2': {'precision': 0.33417884385626323, 'recall': 0.415527723179595, 'f1-score': 0.37043979665644516, 'support': 43754}, 'accuracy': 0.37454092982919196, 'macro avg': {'precision': 0.3230625661118196, 'recall': 0.3371631307161103, 'f1-score': 0.28413119608680015, 'support': 132605}, 'weighted avg': {'precision': 0.3338537371626456, 'recall': 0.37454092982919196, 'f1-score': 0.31413368922932905, 'support': 132605}}
[[31459    48 21344]
 [21094    26 14880]
 [25535    38 18181]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984415
{'0': {'precision': 0.3491804003004462, 'recall': 0.6755855701829373, 'f1-score': 0.4604002213742681, 'support': 11698}, '1': {'precision': 0.28, 'recall': 0.000618921308576481, 'f1-score': 0.0012351124834583148, 'support': 11310}, '2': {'precision': 0.3443367915630627, 'recall': 0.35498983470343853, 'f1-score': 0.34958217270194986, 'support': 11313}, 'accuracy': 0.34748404766760876, 'macro avg': {'precision': 0.3245057306211696, 'recall': 0.3437314420649841, 'f1-score': 0.2704058355198921, 'support': 34321}, 'weighted avg': {'precision': 0.324786411982971, 'recall': 0.34748404766760876, 'f1-score': 0.27256064892052273, 'support': 34321}}
[[7903    4 3791]
 [7447    7 3856]
 [7283   14 4016]]
Evaluating performance on  val set...
46/46 - 1s - 561ms/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932665
{'0': {'precision': 0.4058214747736093, 'recall': 0.6832934001306905, 'f1-score': 0.5092119146173201, 'support': 4591}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3368}, '2': {'precision': 0.3504056795131846, 'recall': 0.37120601665323666, 'f1-score': 0.36050606495369764, 'support': 3723}, 'accuracy': 0.38683444615648005, 'macro avg': {'precision': 0.252075718095598, 'recall': 0.3514998055946424, 'f1-score': 0.2899059931903392, 'support': 11682}, 'weighted avg': {'precision': 0.2711596246801255, 'recall': 0.38683444615648005, 'f1-score': 0.31501078409781996, 'support': 11682}}
[[3137    4 1450]
 [2256    0 1112]
 [2337    4 1382]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
1840/1840 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0871297
{'0': {'precision': 0.4016684027877693, 'recall': 0.7855912743972445, 'f1-score': 0.5315554777019127, 'support': 177684}, '1': {'precision': 0.21651376146788992, 'recall': 0.0011840375681072457, 'f1-score': 0.0023551954013811822, 'support': 99659}, '2': {'precision': 0.4767573373257716, 'recall': 0.302620094102335, 'f1-score': 0.3702348681591568, 'support': 193619}, 'accuracy': 0.42104883196521165, 'macro avg': {'precision': 0.3649798338604769, 'recall': 0.36313180202256223, 'f1-score': 0.30138184708748356, 'support': 470962}, 'weighted avg': {'precision': 0.3933584287707904, 'recall': 0.42104883196521165, 'f1-score': 0.35325169516139454, 'support': 470962}}
[[139587    145  37952]
 [ 73187    118  26354]
 [134744    282  58593]]
Evaluating performance on  train set...
529/529 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938146
{'0': {'precision': 0.35711477173958034, 'recall': 0.7760787929212296, 'f1-score': 0.4891471494880062, 'support': 44471}, '1': {'precision': 0.2765957446808511, 'recall': 0.0008716642081265924, 'f1-score': 0.0017378517478778158, 'support': 44742}, '2': {'precision': 0.42210079245869375, 'recall': 0.3528991469276404, 'f1-score': 0.3844103773584906, 'support': 46186}, 'accuracy': 0.37556407358990834, 'macro avg': {'precision': 0.3519371029597084, 'recall': 0.3766165346856655, 'f1-score': 0.2917651261981249, 'support': 135399}, 'weighted avg': {'precision': 0.35267501992657807, 'recall': 0.37556407358990834, 'f1-score': 0.2923581085271229, 'support': 135399}}
[[34513    36  9922]
 [32310    39 12393]
 [29821    66 16299]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895092
{'0': {'precision': 0.38966239690243193, 'recall': 0.7680606377417668, 'f1-score': 0.5170223621936415, 'support': 19130}, '1': {'precision': 0.375, 'recall': 0.001440922190201729, 'f1-score': 0.002870813397129186, 'support': 14574}, '2': {'precision': 0.45055160258502513, 'recall': 0.35617710806068736, 'f1-score': 0.39784419402253796, 'support': 19378}, 'accuracy': 0.4072190196300064, 'macro avg': {'precision': 0.4050713331624857, 'recall': 0.3752262226642187, 'f1-score': 0.30591245653776955, 'support': 53082}, 'weighted avg': {'precision': 0.40786482437805927, 'recall': 0.4072190196300064, 'f1-score': 0.3323518672051329, 'support': 53082}}
[[14693    11  4426]
 [10562    21  3991]
 [12452    24  6902]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0915515
{'0': {'precision': 0.423177434128994, 'recall': 0.6194969483637511, 'f1-score': 0.502855222035031, 'support': 101421}, '1': {'precision': 0.22142857142857142, 'recall': 0.00047936414665450215, 'f1-score': 0.0009566572543936799, 'support': 64669}, '2': {'precision': 0.3440387375912335, 'recall': 0.4178699474485536, 'f1-score': 0.3773771109854407, 'support': 81444}, 'accuracy': 0.39143713590860246, 'macro avg': {'precision': 0.3295482477162663, 'recall': 0.3459487533196531, 'f1-score': 0.2937296634249551, 'support': 247534}, 'weighted avg': {'precision': 0.34443160849374793, 'recall': 0.39143713590860246, 'f1-score': 0.3304477242281767, 'support': 247534}}
[[62830    49 38542]
 [38291    31 26347]
 [47351    60 34033]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985582
{'0': {'precision': 0.32975410079197937, 'recall': 0.622278197593059, 'f1-score': 0.431075264647718, 'support': 17865}, '1': {'precision': 0.1935483870967742, 'recall': 0.00034002040122407346, 'f1-score': 0.0006788482208519546, 'support': 17646}, '2': {'precision': 0.3824665808056135, 'recall': 0.4150361445783132, 'f1-score': 0.3980863013382023, 'support': 20750}, 'accuracy': 0.35077584827855884, 'macro avg': {'precision': 0.3019230228981224, 'recall': 0.34588478752419877, 'f1-score': 0.2766134714022574, 'support': 56261}, 'weighted avg': {'precision': 0.30647506089608906, 'recall': 0.35077584827855884, 'f1-score': 0.283916555187507, 'support': 56261}}
[[11117    10  6738]
 [10473     6  7167]
 [12123    15  8612]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978533
{'0': {'precision': 0.35431432973805854, 'recall': 0.6584108804581246, 'f1-score': 0.46070623591284743, 'support': 6985}, '1': {'precision': 0.1, 'recall': 0.00016105653084232566, 'f1-score': 0.00032159511175430133, 'support': 6209}, '2': {'precision': 0.3463234248328829, 'recall': 0.35667203749816906, 'f1-score': 0.35142156155289367, 'support': 6827}, 'accuracy': 0.3513810498976075, 'macro avg': {'precision': 0.26687925152364717, 'recall': 0.33841465816237865, 'f1-score': 0.27081646419249844, 'support': 20021}, 'weighted avg': {'precision': 0.2727204242822252, 'recall': 0.3513810498976075, 'f1-score': 0.2806645443595089, 'support': 20021}}
[[4599    6 2380]
 [3992    1 2216]
 [4389    3 2435]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1588/1588 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972685
{'0': {'precision': 0.360929980454314, 'recall': 0.615985143137461, 'f1-score': 0.4551623786011853, 'support': 142695}, '1': {'precision': 0.33560477001703576, 'recall': 0.0016046265374277102, 'f1-score': 0.0031939816954043953, 'support': 122770}, '2': {'precision': 0.36635586635586637, 'recall': 0.4218909782979207, 'f1-score': 0.39216708803939554, 'support': 140816}, 'accuracy': 0.3630590650313453, 'macro avg': {'precision': 0.3542968722757387, 'recall': 0.34649358265760316, 'f1-score': 0.2835078161119951, 'support': 406281}, 'weighted avg': {'precision': 0.3551578066724446, 'recall': 0.3630590650313453, 'f1-score': 0.29675254667729095, 'support': 406281}}
[[87898   193 54604]
 [74424   197 48149]
 [81210   197 59409]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994945
{'0': {'precision': 0.33253809925343975, 'recall': 0.6790273811523602, 'f1-score': 0.44644163733002007, 'support': 23812}, '1': {'precision': 0.3684210526315789, 'recall': 0.000563448303618143, 'f1-score': 0.0011251758087201125, 'support': 24847}, '2': {'precision': 0.3755917545756141, 'recall': 0.3755637556375564, 'f1-score': 0.37557775458476217, 'support': 26829}, 'accuracy': 0.34785661297159814, 'macro avg': {'precision': 0.3588503021535443, 'recall': 0.35171819503117824, 'f1-score': 0.27438152257450077, 'support': 75488}, 'weighted avg': {'precision': 0.35965062390934854, 'recall': 0.34785661297159814, 'f1-score': 0.2746794336739123, 'support': 75488}}
[[16169    14  7629]
 [15711    14  9122]
 [16743    10 10076]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018273
{'0': {'precision': 0.30898048497298264, 'recall': 0.6831556082148499, 'f1-score': 0.42550967067433354, 'support': 10128}, '1': {'precision': 0.21212121212121213, 'recall': 0.0005813470641973258, 'f1-score': 0.0011595163160510187, 'support': 12041}, '2': {'precision': 0.3765556368960469, 'recall': 0.3679034421099687, 'f1-score': 0.37217926106814997, 'support': 11185}, 'accuracy': 0.3310247646459195, 'macro avg': {'precision': 0.29921911133008056, 'recall': 0.35054679912967196, 'f1-score': 0.2662828160195115, 'support': 33354}, 'weighted avg': {'precision': 0.2966744817904949, 'recall': 0.3310247646459195, 'f1-score': 0.2544327131857791, 'support': 33354}}
[[6919   15 3194]
 [8415    7 3619]
 [7059   11 4115]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
2104/2104 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0921115
{'0': {'precision': 0.39575086764843825, 'recall': 0.6123393838532394, 'f1-score': 0.4807780694124216, 'support': 206704}, '1': {'precision': 0.26644736842105265, 'recall': 0.0006193465511572605, 'f1-score': 0.0012358204856316797, 'support': 130783}, '2': {'precision': 0.3903544514746683, 'recall': 0.4240434875589972, 'f1-score': 0.40650216571988435, 'support': 201069}, 'accuracy': 0.3934892564561531, 'macro avg': {'precision': 0.3508508958480531, 'recall': 0.34566740598779794, 'f1-score': 0.2961720185393126, 'support': 538556}, 'weighted avg': {'precision': 0.362336048125308, 'recall': 0.3934892564561531, 'f1-score': 0.3365951884846311, 'support': 538556}}
[[126573     92  80039]
 [ 77581     81  53121]
 [115676    131  85262]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994588
{'0': {'precision': 0.33870872380051437, 'recall': 0.6302081900937818, 'f1-score': 0.4406095274719993, 'support': 36361}, '1': {'precision': 0.32727272727272727, 'recall': 0.0004990711730945186, 'f1-score': 0.0009966225568905375, 'support': 36067}, '2': {'precision': 0.35817537813517136, 'recall': 0.40377714825306893, 'f1-score': 0.3796116627985136, 'support': 37065}, 'accuracy': 0.34613171618276967, 'macro avg': {'precision': 0.34138560973613763, 'recall': 0.3448281365066484, 'f1-score': 0.2737392709424678, 'support': 109493}, 'weighted avg': {'precision': 0.34153145636009685, 'recall': 0.34613171618276967, 'f1-score': 0.2751523339007575, 'support': 109493}}
[[22915    17 13429]
 [22660    18 13389]
 [22079    20 14966]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969808
{'0': {'precision': 0.3548970322353045, 'recall': 0.6576237947377023, 'f1-score': 0.46100529858227124, 'support': 12238}, '1': {'precision': 0.25, 'recall': 0.00036707350646967055, 'f1-score': 0.0007330706496838632, 'support': 10897}, '2': {'precision': 0.37632375189107414, 'recall': 0.389341054938175, 'f1-score': 0.38272174782675594, 'support': 12778}, 'accuracy': 0.3627377272853841, 'macro avg': {'precision': 0.3270735947087929, 'recall': 0.3491106410607823, 'f1-score': 0.281486705686237, 'support': 35913}, 'weighted avg': {'precision': 0.3306920831498288, 'recall': 0.3627377272853841, 'f1-score': 0.2934923177860309, 'support': 35913}}
[[8048    6 4184]
 [6832    4 4061]
 [7797    6 4975]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/EXC
Evaluating performance on  test set...
5267/5267 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0941547
{'0': {'precision': 0.3647408822659406, 'recall': 0.6786196007668884, 'f1-score': 0.47446748450197357, 'support': 443350}, '1': {'precision': 0.3450151057401813, 'recall': 0.0012660136312641068, 'f1-score': 0.0025227700987679957, 'support': 451022}, '2': {'precision': 0.3857851867045718, 'recall': 0.44345676183089033, 'f1-score': 0.4126155218280512, 'support': 453812}, 'accuracy': 0.3728593426416572, 'macro avg': {'precision': 0.36518039157023124, 'recall': 0.37444745874301427, 'f1-score': 0.2965352588095976, 'support': 1348184}, 'weighted avg': {'precision': 0.36522553325252927, 'recall': 0.3728593426416572, 'f1-score': 0.2957629368552572, 'support': 1348184}}
[[300866    415 142069]
 [272113    571 178338]
 [251897    669 201246]]
Evaluating performance on  train set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933846
{'0': {'precision': 0.3639187179910788, 'recall': 0.7386245515206384, 'f1-score': 0.4875986408863015, 'support': 89469}, '1': {'precision': 0.3246268656716418, 'recall': 0.0009690354199153486, 'f1-score': 0.0019323027718550108, 'support': 89780}, '2': {'precision': 0.401671066171536, 'recall': 0.39028180800539053, 'f1-score': 0.39589454130539037, 'support': 92013}, 'accuracy': 0.3763225221372695, 'macro avg': {'precision': 0.36340554994475216, 'recall': 0.37662513164864814, 'f1-score': 0.2951418283211823, 'support': 271262}, 'weighted avg': {'precision': 0.36371995927031936, 'recall': 0.3763225221372695, 'f1-score': 0.29575056356381113, 'support': 271262}}
[[66084    66 23319]
 [59519    87 30174]
 [55987   115 35911]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0931376
{'0': {'precision': 0.356043692593536, 'recall': 0.7223809813339819, 'f1-score': 0.4769905553380908, 'support': 32894}, '1': {'precision': 0.33980582524271846, 'recall': 0.0010533602190989256, 'f1-score': 0.0021002100210021, 'support': 33227}, '2': {'precision': 0.42514495131823654, 'recall': 0.41692369585624245, 'f1-score': 0.4209941908488944, 'support': 37285}, 'accuracy': 0.3804614819256136, 'macro avg': {'precision': 0.373664823051497, 'recall': 0.38011934580310774, 'f1-score': 0.3000283187359958, 'support': 103406}, 'weighted avg': {'precision': 0.37574182242241294, 'recall': 0.3804614819256136, 'f1-score': 0.3042055529800981, 'support': 103406}}
[[23762    24  9108]
 [21281    35 11911]
 [21696    44 15545]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/AAL
Evaluating performance on  test set...
10110/10110 - 74s - 74s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0915347
{'0': {'precision': 0.38583407943167786, 'recall': 0.7003306492642974, 'f1-score': 0.49755147486899004, 'support': 941481}, '1': {'precision': 0.26958026828212894, 'recall': 0.0009104739579603629, 'f1-score': 0.0018148185909666896, 'support': 684259}, '2': {'precision': 0.4079074461594604, 'recall': 0.37168365968518924, 'f1-score': 0.38895398181107416, 'support': 962356}, 'accuracy': 0.3932091390736665, 'macro avg': {'precision': 0.3544405979577558, 'recall': 0.3576415943024824, 'f1-score': 0.29610675842367695, 'support': 2588096}, 'weighted avg': {'precision': 0.36330582713628495, 'recall': 0.3932091390736665, 'f1-score': 0.32610431150357094, 'support': 2588096}}
[[659348    691 281442]
 [445875    623 237761]
 [603667    997 357692]]
Evaluating performance on  train set...
1686/1686 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944787
{'0': {'precision': 0.3672795040452768, 'recall': 0.7232367139945698, 'f1-score': 0.4871638169686632, 'support': 147693}, '1': {'precision': 0.36033519553072624, 'recall': 0.0009345997522223913, 'f1-score': 0.0018643639122737292, 'support': 138027}, '2': {'precision': 0.3833873552983081, 'recall': 0.3690056635080839, 'f1-score': 0.37605905925840527, 'support': 145846}, 'accuracy': 0.3725131266133106, 'macro avg': {'precision': 0.37033401829143703, 'recall': 0.36439232575162533, 'f1-score': 0.2883624133797807, 'support': 431566}, 'weighted avg': {'precision': 0.37050210175341813, 'recall': 0.3725131266133106, 'f1-score': 0.29440393296476913, 'support': 431566}}
[[106817     91  40785]
 [ 92126    129  45772]
 [ 91890    138  53818]]
Evaluating performance on  val set...
705/705 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0946821
{'0': {'precision': 0.3564037252248667, 'recall': 0.7401071109788754, 'f1-score': 0.48112051921258486, 'support': 60498}, '1': {'precision': 0.2982456140350877, 'recall': 0.0006231100522312838, 'f1-score': 0.00124362186579857, 'support': 54565}, '2': {'precision': 0.4149807938540333, 'recall': 0.3471561261495616, 'f1-score': 0.3780505078277968, 'support': 65351}, 'accuracy': 0.37411730796944803, 'macro avg': {'precision': 0.35654337770466255, 'recall': 0.3626287823935561, 'f1-score': 0.28680488296872675, 'support': 180414}, 'weighted avg': {'precision': 0.3600324495750522, 'recall': 0.37411730796944803, 'f1-score': 0.2986501387668618, 'support': 180414}}
[[44775    34 15689]
 [38237    34 16294]
 [42618    46 22687]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/WBA
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0931227
{'0': {'precision': 0.3852402144073028, 'recall': 0.6799898289918793, 'f1-score': 0.4918363486626721, 'support': 621374}, '1': {'precision': 0.27123287671232876, 'recall': 0.0004453070707116142, 'f1-score': 0.000889154337883139, 'support': 444637}, '2': {'precision': 0.38988452951440833, 'recall': 0.3697365982619192, 'f1-score': 0.379543365465877, 'support': 609753}, 'accuracy': 0.3867931283880069, 'macro avg': {'precision': 0.3487858735446799, 'recall': 0.35005724477483674, 'f1-score': 0.29075628948881077, 'support': 1675764}, 'weighted avg': {'precision': 0.356680109558901, 'recall': 0.3867931283880069, 'f1-score': 0.32071185199954616, 'support': 1675764}}
[[422528    246 198600]
 [290244    198 154195]
 [384019    286 225448]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966191
{'0': {'precision': 0.35895192643235246, 'recall': 0.6714598311972492, 'f1-score': 0.46781647850108093, 'support': 108766}, '1': {'precision': 0.32644628099173556, 'recall': 0.0007797463356857326, 'f1-score': 0.0015557765589767323, 'support': 101315}, '2': {'precision': 0.3575229366058325, 'recall': 0.37931166238405917, 'f1-score': 0.3680951453970726, 'support': 104687}, 'accuracy': 0.35842271133024955, 'macro avg': {'precision': 0.3476403813433069, 'recall': 0.3505170799723314, 'f1-score': 0.2791558001523768, 'support': 314768}, 'weighted avg': {'precision': 0.34801400985320535, 'recall': 0.35842271133024955, 'f1-score': 0.2845744392343079, 'support': 314768}}
[[73032    69 35665]
 [65543    79 35693]
 [64884    94 39709]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947571
{'0': {'precision': 0.3705360243356993, 'recall': 0.6639784946236559, 'f1-score': 0.47563943692107447, 'support': 40176}, '1': {'precision': 0.24489795918367346, 'recall': 0.0003470715835140998, 'f1-score': 0.0006931608133086876, 'support': 34575}, '2': {'precision': 0.3750422807441411, 'recall': 0.401308135777255, 'f1-score': 0.3877308888361579, 'support': 38681}, 'accuracy': 0.37212603145496864, 'macro avg': {'precision': 0.3301587547545046, 'recall': 0.3552112339948083, 'f1-score': 0.2880211621901803, 'support': 113432}, 'weighted avg': {'precision': 0.33377717675744667, 'recall': 0.37212603145496864, 'f1-score': 0.3008945849842431, 'support': 113432}}
[[26676    19 13481]
 [22177    12 12386]
 [23140    18 15523]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
7633/7633 - 56s - 56s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096858
{'0': {'precision': 0.35230920044290215, 'recall': 0.6507055722467302, 'f1-score': 0.4571210038457218, 'support': 656701}, '1': {'precision': 0.30303030303030304, 'recall': 0.0004289697576320869, 'f1-score': 0.0008567267327298169, 'support': 629415}, '2': {'precision': 0.3671592025215386, 'recall': 0.40691484981291187, 'f1-score': 0.38601612158659143, 'support': 667867}, 'accuracy': 0.35791201868184114, 'macro avg': {'precision': 0.34083290199824795, 'recall': 0.35268313060575807, 'f1-score': 0.28133128405501434, 'support': 1953983}, 'weighted avg': {'precision': 0.3415112298993005, 'recall': 0.35791201868184114, 'f1-score': 0.2858461338090672, 'support': 1953983}}
[[427319    302 229080]
 [389807    270 239338]
 [395783    319 271765]]
Evaluating performance on  train set...
1586/1586 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966723
{'0': {'precision': 0.3603248782299193, 'recall': 0.6565345387278577, 'f1-score': 0.4652869881042258, 'support': 138931}, '1': {'precision': 0.38943894389438943, 'recall': 0.0008808665337901896, 'f1-score': 0.0017577572209560412, 'support': 133959}, '2': {'precision': 0.35444857139107266, 'recall': 0.4062960734165789, 'f1-score': 0.3786055249083505, 'support': 132940}, 'accuracy': 0.3581401079269645, 'macro avg': {'precision': 0.36807079783846053, 'recall': 0.3545704928927423, 'f1-score': 0.28188342341117745, 'support': 405830}, 'weighted avg': {'precision': 0.3680101033024632, 'recall': 0.3581401079269645, 'f1-score': 0.2838875204523726, 'support': 405830}}
[[91213    76 47642]
 [83110   118 50731]
 [78818   109 54013]]
Evaluating performance on  val set...
574/574 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060785
{'0': {'precision': 0.28625357564414766, 'recall': 0.6654718053941806, 'f1-score': 0.4003122908766451, 'support': 40451}, '1': {'precision': 0.5352112676056338, 'recall': 0.000592620317519728, 'f1-score': 0.0011839297119623634, 'support': 64122}, '2': {'precision': 0.31107741874348527, 'recall': 0.38801947898444517, 'f1-score': 0.3453143572427867, 'support': 42302}, 'accuracy': 0.295291914893617, 'macro avg': {'precision': 0.3775140873310889, 'recall': 0.3513613015653818, 'f1-score': 0.24893685927713138, 'support': 146875}, 'weighted avg': {'precision': 0.40209196430622485, 'recall': 0.295291914893617, 'f1-score': 0.2102225454251982, 'support': 146875}}
[[26919    15 13517]
 [41250    38 22834]
 [25870    18 16414]]
testing model on single stock: results/universal/W10/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
22048/22048 - 157s - 157s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0923656
{'0': {'precision': 0.38851886354937837, 'recall': 0.6734761242136451, 'f1-score': 0.4927672567613145, 'support': 2135804}, '1': {'precision': 0.21823617339312407, 'recall': 0.00020684032281257503, 'f1-score': 0.00041328893779789174, 'support': 1411717}, '2': {'precision': 0.39036891898995374, 'recall': 0.36130065603264805, 'f1-score': 0.37527272943456574, 'support': 2096542}, 'accuracy': 0.38911454390214995, 'macro avg': {'precision': 0.3323746519774854, 'recall': 0.34499454018970194, 'f1-score': 0.2894844250445594, 'support': 5644063}, 'weighted avg': {'precision': 0.34661425519085687, 'recall': 0.38911454390214995, 'f1-score': 0.3259731090516614, 'support': 5644063}}
[[1438413     552  696839]
 [ 925320     292  486105]
 [1338566     494  757482]]
Evaluating performance on  train set...
5429/5429 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982363
{'0': {'precision': 0.3473647931043052, 'recall': 0.6908222836748682, 'f1-score': 0.4622815001416286, 'support': 465399}, '1': {'precision': 0.37669376693766937, 'recall': 0.0003045487310834704, 'f1-score': 0.0006086054179017562, 'support': 456413}, '2': {'precision': 0.35975708344920804, 'recall': 0.356589876127979, 'f1-score': 0.35816647815196934, 'support': 467983}, 'accuracy': 0.35150867573994726, 'macro avg': {'precision': 0.3612718811637275, 'recall': 0.3492389028446435, 'f1-score': 0.2736855279038332, 'support': 1389795}, 'weighted avg': {'precision': 0.36116935143606343, 'recall': 0.35150867573994726, 'f1-score': 0.27560823449070376, 'support': 1389795}}
[[321508    118 143773]
 [303062    139 153212]
 [300993    112 166878]]
Evaluating performance on  val set...
1890/1890 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010315
{'0': {'precision': 0.3258474798483498, 'recall': 0.6970140882246197, 'f1-score': 0.4440880196421364, 'support': 151545}, '1': {'precision': 0.3865546218487395, 'recall': 0.0002657822665449461, 'f1-score': 0.000531199297893102, 'support': 173074}, '2': {'precision': 0.3535741399539468, 'recall': 0.3543144208037825, 'f1-score': 0.3539438933011754, 'support': 159048}, 'accuracy': 0.3349990799454997, 'macro avg': {'precision': 0.3553254138836787, 'recall': 0.3505314304316491, 'f1-score': 0.26618770408040165, 'support': 483667}, 'weighted avg': {'precision': 0.3566883222689624, 'recall': 0.3349990799454997, 'f1-score': 0.25572413264852983, 'support': 483667}}
[[105629     25  45891]
 [115891     46  57137]
 [102647     48  56353]]
training model: results/universal/W10/deepOF_L1/h1000
Epoch 1/50
8543/8543 - 185s - loss: 3.2809 - accuracy1000: 0.3683 - val_loss: 3.2924 - val_accuracy1000: 0.3655 - 185s/epoch - 22ms/step
Epoch 2/50
8543/8543 - 173s - loss: 3.2781 - accuracy1000: 0.3699 - val_loss: 3.2919 - val_accuracy1000: 0.3655 - 173s/epoch - 20ms/step
Epoch 3/50
8543/8543 - 175s - loss: 3.2760 - accuracy1000: 0.3735 - val_loss: 3.2912 - val_accuracy1000: 0.3655 - 175s/epoch - 20ms/step
Epoch 4/50
8543/8543 - 171s - loss: 3.2747 - accuracy1000: 0.3747 - val_loss: 3.2905 - val_accuracy1000: 0.3656 - 171s/epoch - 20ms/step
Epoch 5/50
8543/8543 - 172s - loss: 3.2735 - accuracy1000: 0.3756 - val_loss: 3.2903 - val_accuracy1000: 0.3656 - 172s/epoch - 20ms/step
Epoch 6/50
8543/8543 - 172s - loss: 3.2722 - accuracy1000: 0.3768 - val_loss: 3.2901 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 7/50
8543/8543 - 172s - loss: 3.2712 - accuracy1000: 0.3777 - val_loss: 3.2894 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 8/50
8543/8543 - 172s - loss: 3.2703 - accuracy1000: 0.3783 - val_loss: 3.2890 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 9/50
8543/8543 - 172s - loss: 3.2693 - accuracy1000: 0.3794 - val_loss: 3.2887 - val_accuracy1000: 0.3656 - 172s/epoch - 20ms/step
Epoch 10/50
8543/8543 - 173s - loss: 3.2686 - accuracy1000: 0.3799 - val_loss: 3.2883 - val_accuracy1000: 0.3656 - 173s/epoch - 20ms/step
Epoch 11/50
8543/8543 - 172s - loss: 3.2677 - accuracy1000: 0.3805 - val_loss: 3.2879 - val_accuracy1000: 0.3656 - 172s/epoch - 20ms/step
Epoch 12/50
8543/8543 - 172s - loss: 3.2670 - accuracy1000: 0.3812 - val_loss: 3.2876 - val_accuracy1000: 0.3654 - 172s/epoch - 20ms/step
Epoch 13/50
8543/8543 - 173s - loss: 3.2662 - accuracy1000: 0.3818 - val_loss: 3.2877 - val_accuracy1000: 0.3655 - 173s/epoch - 20ms/step
Epoch 14/50
8543/8543 - 173s - loss: 3.2655 - accuracy1000: 0.3825 - val_loss: 3.2873 - val_accuracy1000: 0.3655 - 173s/epoch - 20ms/step
Epoch 15/50
8543/8543 - 172s - loss: 3.2650 - accuracy1000: 0.3829 - val_loss: 3.2871 - val_accuracy1000: 0.3654 - 172s/epoch - 20ms/step
Epoch 16/50
8543/8543 - 172s - loss: 3.2644 - accuracy1000: 0.3831 - val_loss: 3.2870 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 17/50
8543/8543 - 172s - loss: 3.2638 - accuracy1000: 0.3836 - val_loss: 3.2870 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 18/50
8543/8543 - 173s - loss: 3.2635 - accuracy1000: 0.3841 - val_loss: 3.2866 - val_accuracy1000: 0.3655 - 173s/epoch - 20ms/step
Epoch 19/50
8543/8543 - 172s - loss: 3.2629 - accuracy1000: 0.3844 - val_loss: 3.2867 - val_accuracy1000: 0.3653 - 172s/epoch - 20ms/step
Epoch 20/50
8543/8543 - 172s - loss: 3.2625 - accuracy1000: 0.3850 - val_loss: 3.2866 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 21/50
8543/8543 - 171s - loss: 3.2622 - accuracy1000: 0.3853 - val_loss: 3.2866 - val_accuracy1000: 0.3655 - 171s/epoch - 20ms/step
Epoch 22/50
8543/8543 - 172s - loss: 3.2617 - accuracy1000: 0.3859 - val_loss: 3.2866 - val_accuracy1000: 0.3654 - 172s/epoch - 20ms/step
Epoch 23/50
8543/8543 - 172s - loss: 3.2615 - accuracy1000: 0.3858 - val_loss: 3.2868 - val_accuracy1000: 0.3654 - 172s/epoch - 20ms/step
Epoch 24/50
8543/8543 - 172s - loss: 3.2609 - accuracy1000: 0.3862 - val_loss: 3.2865 - val_accuracy1000: 0.3655 - 172s/epoch - 20ms/step
Epoch 25/50
8543/8543 - 172s - loss: 3.2606 - accuracy1000: 0.3867 - val_loss: 3.2865 - val_accuracy1000: 0.3652 - 172s/epoch - 20ms/step
Epoch 26/50
8543/8543 - 173s - loss: 3.2601 - accuracy1000: 0.3874 - val_loss: 3.2868 - val_accuracy1000: 0.3653 - 173s/epoch - 20ms/step
Epoch 27/50
8543/8543 - 172s - loss: 3.2600 - accuracy1000: 0.3874 - val_loss: 3.2866 - val_accuracy1000: 0.3651 - 172s/epoch - 20ms/step
Epoch 28/50
8543/8543 - 172s - loss: 3.2594 - accuracy1000: 0.3878 - val_loss: 3.2867 - val_accuracy1000: 0.3652 - 172s/epoch - 20ms/step
Epoch 29/50
8543/8543 - 173s - loss: 3.2589 - accuracy1000: 0.3882 - val_loss: 3.2866 - val_accuracy1000: 0.3652 - 173s/epoch - 20ms/step
Epoch 30/50
8543/8543 - 171s - loss: 3.2584 - accuracy1000: 0.3887 - val_loss: 3.2868 - val_accuracy1000: 0.3648 - 171s/epoch - 20ms/step
Epoch 31/50
8543/8543 - 172s - loss: 3.2581 - accuracy1000: 0.3891 - val_loss: 3.2872 - val_accuracy1000: 0.3651 - 172s/epoch - 20ms/step
Epoch 32/50
8543/8543 - 172s - loss: 3.2575 - accuracy1000: 0.3895 - val_loss: 3.2874 - val_accuracy1000: 0.3650 - 172s/epoch - 20ms/step
Epoch 33/50
8543/8543 - 172s - loss: 3.2572 - accuracy1000: 0.3898 - val_loss: 3.2877 - val_accuracy1000: 0.3648 - 172s/epoch - 20ms/step
Epoch 34/50
8543/8543 - 172s - loss: 3.2568 - accuracy1000: 0.3897 - val_loss: 3.2878 - val_accuracy1000: 0.3651 - 172s/epoch - 20ms/step
Epoch 35/50
8543/8543 - 172s - loss: 3.2564 - accuracy1000: 0.3902 - val_loss: 3.2878 - val_accuracy1000: 0.3649 - 172s/epoch - 20ms/step
testing model in sample: results/universal/W10/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 270s - 270s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1092317
{'0': {'precision': 0.36604090833502706, 'recall': 0.011683295726769936, 'f1-score': 0.02264384508160322, 'support': 3391252}, '1': {'precision': 0.2920337732741052, 'recall': 0.978656541650672, 'f1-score': 0.4498354307745726, 'support': 2795189}, '2': {'precision': 0.3647089144068039, 'recall': 0.00758363147933511, 'f1-score': 0.014858304495494589, 'support': 3358813}, 'accuracy': 0.2934047642943813, 'macro avg': {'precision': 0.3409278653386454, 'recall': 0.3326411562855924, 'f1-score': 0.16244586011722348, 'support': 9545254}, 'weighted avg': {'precision': 0.34390028762804115, 'recall': 0.2934047642943813, 'f1-score': 0.14500109678898535, 'support': 9545254}}
[[  39621 3331028   20603]
 [  35892 2735530   23767]
 [  32729 3300612   25472]]
Evaluating performance on  train set...
8543/8543 - 66s - 66s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017133
{'0': {'precision': 0.38362168396770474, 'recall': 0.013728881422255979, 'f1-score': 0.026509068157635703, 'support': 726789}, '1': {'precision': 0.3307866226598046, 'recall': 0.9812008761401161, 'f1-score': 0.4947731960344344, 'support': 723172}, '2': {'precision': 0.3918624053394943, 'recall': 0.008287739005444173, 'f1-score': 0.016232173784746916, 'support': 736751}, 'accuracy': 0.33185028481116857, 'macro avg': {'precision': 0.36875690398900124, 'recall': 0.33440583218927206, 'f1-score': 0.1791714793256057, 'support': 2186712}, 'weighted avg': {'precision': 0.36892497162297466, 'recall': 0.33185028481116857, 'f1-score': 0.17790714603839922, 'support': 2186712}}
[[  9978 712475   4336]
 [  8455 709577   5140]
 [  7577 723068   6106]]
Evaluating performance on  val set...
3077/3077 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957174
{'0': {'precision': 0.3468013468013468, 'recall': 0.01237647351302078, 'f1-score': 0.02390001520255403, 'support': 241345}, '1': {'precision': 0.3654010818305753, 'recall': 0.981973652195071, 'f1-score': 0.532612384335196, 'support': 287690}, '2': {'precision': 0.3588756257219869, 'recall': 0.00722743945468504, 'f1-score': 0.014169517293804638, 'support': 257906}, 'accuracy': 0.3651544397864643, 'macro avg': {'precision': 0.35702601811796963, 'recall': 0.33385918838759227, 'f1-score': 0.19022730561051823, 'support': 786941}, 'weighted avg': {'precision': 0.3575581719634179, 'recall': 0.3651544397864643, 'f1-score': 0.2066861550556254, 'support': 786941}}
[[  2987 236999   1359]
 [  3215 282504   1971]
 [  2411 253631   1864]]
testing model out of sample: results/universal/W10/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 157s - 157s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1176356
{'0': {'precision': 0.4183551981310091, 'recall': 0.017986186461998767, 'f1-score': 0.03448957566997346, 'support': 2070867}, '1': {'precision': 0.24422618464974025, 'recall': 0.9747669788612521, 'f1-score': 0.3905905747398244, 'support': 1333570}, '2': {'precision': 0.4346799633662359, 'recall': 0.010386429850749172, 'f1-score': 0.020288087421727764, 'support': 2056337}, 'accuracy': 0.24877883611370843, 'macro avg': {'precision': 0.36575378204899506, 'recall': 0.33437986505800005, 'f1-score': 0.14845607927717522, 'support': 5460774}, 'weighted avg': {'precision': 0.3819786680386256, 'recall': 0.24877883611370843, 'f1-score': 0.11610484918058721, 'support': 5460774}}
[[  37247 2017452   16168]
 [  22041 1299920   11609]
 [  29744 2005235   21358]]
Evaluating performance on  train set...
4055/4055 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011733
{'0': {'precision': 0.3859745692739583, 'recall': 0.019998345829922794, 'f1-score': 0.03802644280306728, 'support': 350629}, '1': {'precision': 0.3327683391946109, 'recall': 0.9716443554825348, 'f1-score': 0.4957518119551405, 'support': 345716}, '2': {'precision': 0.35711386239090726, 'recall': 0.010315836377174417, 'f1-score': 0.020052424639580603, 'support': 341126}, 'accuracy': 0.33393126169309795, 'macro avg': {'precision': 0.35861892361982556, 'recall': 0.33398617922987733, 'f1-score': 0.18461022646592948, 'support': 1037471}, 'weighted avg': {'precision': 0.35875512648057, 'recall': 0.33393126169309795, 'f1-score': 0.18464411096125252, 'support': 1037471}}
[[  7012 340815   2802]
 [  6270 335913   3533]
 [  4885 332722   3519]]
Evaluating performance on  val set...
1545/1545 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991741
{'0': {'precision': 0.36856617647058826, 'recall': 0.015962867424604312, 'f1-score': 0.0306004090229236, 'support': 125604}, '1': {'precision': 0.34462872112900433, 'recall': 0.9784572007577427, 'f1-score': 0.5097241958341542, 'support': 136194}, '2': {'precision': 0.3945480631276901, 'recall': 0.008264028187848873, 'f1-score': 0.016188969424923653, 'support': 133107}, 'accuracy': 0.34531089755764044, 'macro avg': {'precision': 0.3692476535757609, 'recall': 0.3342280321233986, 'f1-score': 0.18550452476066714, 'support': 394905}, 'weighted avg': {'precision': 0.36906815338775867, 'recall': 0.34531089755764044, 'f1-score': 0.19098207431051872, 'support': 394905}}
[[  2005 122847    752]
 [  1998 133260    936]
 [  1437 130570   1100]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
518/518 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.111837
{'0': {'precision': 0.3487654320987654, 'recall': 0.010597790407592894, 'f1-score': 0.020570513170589624, 'support': 53313}, '1': {'precision': 0.2962113927458748, 'recall': 0.979871236990101, 'f1-score': 0.4549063157148595, 'support': 39297}, '2': {'precision': 0.33131313131313134, 'recall': 0.008201025128141018, 'f1-score': 0.01600585580090277, 'support': 39995}, 'accuracy': 0.29711549338260246, 'macro avg': {'precision': 0.3254299853859239, 'recall': 0.33289001750861164, 'f1-score': 0.16382756156211728, 'support': 132605}, 'weighted avg': {'precision': 0.32792744820395014, 'recall': 0.29711549338260246, 'f1-score': 0.14790757105740798, 'support': 132605}}
[[  565 52358   390]
 [  519 38506   272]
 [  536 39131   328]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034775
{'0': {'precision': 0.36542669584245074, 'recall': 0.014386629910406616, 'f1-score': 0.02768338168255284, 'support': 11608}, '1': {'precision': 0.32850975137710287, 'recall': 0.9810599324204161, 'f1-score': 0.4922040552296402, 'support': 11246}, '2': {'precision': 0.36200716845878134, 'recall': 0.00880788349175896, 'f1-score': 0.0171973437766048, 'support': 11467}, 'accuracy': 0.3292736225634451, 'macro avg': {'precision': 0.3519812052261117, 'recall': 0.3347514819408606, 'f1-score': 0.17902826022959928, 'support': 34321}, 'weighted avg': {'precision': 0.35218758049132926, 'recall': 0.3292736225634451, 'f1-score': 0.17638989075988273, 'support': 34321}}
[[  167 11357    84]
 [  119 11033    94]
 [  171 11195   101]]
Evaluating performance on  val set...
46/46 - 1s - 551ms/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104089
{'0': {'precision': 0.40641711229946526, 'recall': 0.016291532690246517, 'f1-score': 0.03132728771640561, 'support': 4665}, '1': {'precision': 0.31909856190810243, 'recall': 0.9732548809842204, 'f1-score': 0.48061810737634547, 'support': 3739}, '2': {'precision': 0.31868131868131866, 'recall': 0.008846857840146431, 'f1-score': 0.017215791035915702, 'support': 3278}, 'accuracy': 0.3204930662557781, 'macro avg': {'precision': 0.34806566429629543, 'recall': 0.33279775717153776, 'f1-score': 0.17638706204288893, 'support': 11682}, 'weighted avg': {'precision': 0.35385060045272754, 'recall': 0.3204930662557781, 'f1-score': 0.17116985650512923, 'support': 11682}}
[[  76 4557   32]
 [  70 3639   30]
 [  41 3208   29]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
1840/1840 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1106633
{'0': {'precision': 0.31837738168408114, 'recall': 0.022620651794180765, 'f1-score': 0.04224014911028919, 'support': 160296}, '1': {'precision': 0.2800237115157896, 'recall': 0.9470443902512007, 'f1-score': 0.4322415108769689, 'support': 133678}, '2': {'precision': 0.3990899357601713, 'recall': 0.01684859990507831, 'f1-score': 0.032332212945896124, 'support': 176988}, 'accuracy': 0.2828402291479992, 'macro avg': {'precision': 0.33249700965334733, 'recall': 0.32883788065015324, 'f1-score': 0.1689379576443847, 'support': 470962}, 'weighted avg': {'precision': 0.3378229242120604, 'recall': 0.2828402291479992, 'f1-score': 0.1492148439527236, 'support': 470962}}
[[  3626 154899   1771]
 [  4360 126599   2719]
 [  3403 170603   2982]]
Evaluating performance on  train set...
529/529 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099739
{'0': {'precision': 0.3684044233807267, 'recall': 0.026030271911416707, 'f1-score': 0.048624867073959, 'support': 44794}, '1': {'precision': 0.33031447895907234, 'recall': 0.9586208436613742, 'f1-score': 0.49133007519657557, 'support': 44781}, '2': {'precision': 0.4267487901451826, 'recall': 0.021167946927374302, 'f1-score': 0.04033515603883818, 'support': 45824}, 'accuracy': 0.3328237283879497, 'macro avg': {'precision': 0.37515589749499384, 'recall': 0.33527302083338845, 'f1-score': 0.1934300327697909, 'support': 135399}, 'weighted avg': {'precision': 0.37555267751457055, 'recall': 0.3328237283879497, 'f1-score': 0.1922368155112851, 'support': 135399}}
[[ 1166 43090   538]
 [ 1088 42928   765]
 [  911 43943   970]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001004
{'0': {'precision': 0.42093287827076226, 'recall': 0.021404604882563925, 'f1-score': 0.04073768235617947, 'support': 17286}, '1': {'precision': 0.33132588635259835, 'recall': 0.9724043560066138, 'f1-score': 0.49424754397658444, 'support': 17539}, '2': {'precision': 0.40934065934065933, 'recall': 0.016322506435887604, 'f1-score': 0.03139320516196997, 'support': 18257}, 'accuracy': 0.3338796578877962, 'macro avg': {'precision': 0.38719980798800663, 'recall': 0.33671048910835505, 'f1-score': 0.18879281049824462, 'support': 53082}, 'weighted avg': {'precision': 0.3873385115879024, 'recall': 0.3338796578877962, 'f1-score': 0.187369447226109, 'support': 53082}}
[[  370 16711   205]
 [  259 17055   225]
 [  250 17709   298]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
967/967 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1158257
{'0': {'precision': 0.4462347911871095, 'recall': 0.012956880418592217, 'f1-score': 0.02518255963924174, 'support': 104732}, '1': {'precision': 0.2544163933885932, 'recall': 0.9805960906362641, 'f1-score': 0.4040116581454913, 'support': 62977}, '2': {'precision': 0.3691084611016468, 'recall': 0.008142812402129659, 'f1-score': 0.015934106341774324, 'support': 79825}, 'accuracy': 0.25758885648032187, 'macro avg': {'precision': 0.3565865485591165, 'recall': 0.333898594485662, 'f1-score': 0.14837610804216914, 'support': 247534}, 'weighted avg': {'precision': 0.37256104722777783, 'recall': 0.25758885648032187, 'f1-score': 0.11858089018033001, 'support': 247534}}
[[  1357 102706    669]
 [   780  61755    442]
 [   904  78271    650]]
Evaluating performance on  train set...
220/220 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033951
{'0': {'precision': 0.3590551181102362, 'recall': 0.0131852879944483, 'f1-score': 0.025436492441568582, 'support': 17292}, '1': {'precision': 0.32578488740738054, 'recall': 0.9806412913076671, 'f1-score': 0.4890871262085752, 'support': 18338}, '2': {'precision': 0.3700234192037471, 'recall': 0.0076583781687751444, 'f1-score': 0.015006173425776429, 'support': 20631}, 'accuracy': 0.32649615186363556, 'macro avg': {'precision': 0.35162114157378793, 'recall': 0.33382831915696354, 'f1-score': 0.1765099306919734, 'support': 56261}, 'weighted avg': {'precision': 0.35223294163330293, 'recall': 0.32649615186363556, 'f1-score': 0.17273635220951722, 'support': 56261}}
[[  228 16948   116]
 [  202 17983   153]
 [  205 20268   158]]
Evaluating performance on  val set...
79/79 - 1s - 807ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021428
{'0': {'precision': 0.3739130434782609, 'recall': 0.012697475269452236, 'f1-score': 0.02456090247036984, 'support': 6773}, '1': {'precision': 0.33407866653115154, 'recall': 0.9842790836951639, 'f1-score': 0.49884281215616344, 'support': 6679}, '2': {'precision': 0.3185840707964602, 'recall': 0.005480286192723398, 'f1-score': 0.010775217000897935, 'support': 6569}, 'accuracy': 0.33444882872983367, 'macro avg': {'precision': 0.3421919269352909, 'recall': 0.33415228171911315, 'f1-score': 0.17805964387581039, 'support': 20021}, 'weighted avg': {'precision': 0.3424705668199275, 'recall': 0.33444882872983367, 'f1-score': 0.17825805580648965, 'support': 20021}}
[[  86 6643   44]
 [  72 6574   33]
 [  72 6461   36]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1588/1588 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077664
{'0': {'precision': 0.34452499046165586, 'recall': 0.012563653059520829, 'f1-score': 0.02424323780119471, 'support': 143748}, '1': {'precision': 0.3057570566016789, 'recall': 0.9749466993845287, 'f1-score': 0.46552035434265676, 'support': 124295}, '2': {'precision': 0.35811384876805435, 'recall': 0.012196357007479853, 'f1-score': 0.02358932743833336, 'support': 138238}, 'accuracy': 0.3068639685340934, 'macro avg': {'precision': 0.33613196527712974, 'recall': 0.33323556981717645, 'f1-score': 0.17111763986072825, 'support': 406281}, 'weighted avg': {'precision': 0.3372882165427034, 'recall': 0.3068639685340934, 'f1-score': 0.15902223051751618, 'support': 406281}}
[[  1806 140361   1581]
 [  1673 121181   1441]
 [  1763 134789   1686]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10258
{'0': {'precision': 0.3351528384279476, 'recall': 0.013023926692686238, 'f1-score': 0.025073505390395295, 'support': 23572}, '1': {'precision': 0.32905665473698426, 'recall': 0.9820636839983877, 'f1-score': 0.4929442112184513, 'support': 24810}, '2': {'precision': 0.3984819734345351, 'recall': 0.007747362207629307, 'f1-score': 0.015199218325914667, 'support': 27106}, 'accuracy': 0.3296153030945316, 'macro avg': {'precision': 0.35423048886648895, 'recall': 0.3342783242995678, 'f1-score': 0.17773897831158705, 'support': 75488}, 'weighted avg': {'precision': 0.35588928946805676, 'recall': 0.3296153030945316, 'f1-score': 0.1752989688604072, 'support': 75488}}
[[  307 23117   148]
 [  276 24365   169]
 [  333 26563   210]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999169
{'0': {'precision': 0.32571428571428573, 'recall': 0.011035818005808325, 'f1-score': 0.02134831460674157, 'support': 10330}, '1': {'precision': 0.3467847869253093, 'recall': 0.9855022137338311, 'f1-score': 0.5130383694129343, 'support': 11519}, '2': {'precision': 0.4349442379182156, 'recall': 0.010169491525423728, 'f1-score': 0.019874299303550193, 'support': 11505}, 'accuracy': 0.3472746896923907, 'macro avg': {'precision': 0.36914777018593686, 'recall': 0.3355691744216877, 'f1-score': 0.18475366110774205, 'support': 33354}, 'weighted avg': {'precision': 0.37066846522966607, 'recall': 0.3472746896923907, 'f1-score': 0.1906479247059596, 'support': 33354}}
[[  114 10135    81]
 [   96 11352    71]
 [  140 11248   117]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
2104/2104 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1188205
{'0': {'precision': 0.4028636021100226, 'recall': 0.012857019172494733, 'f1-score': 0.024918778578986375, 'support': 207902}, '1': {'precision': 0.23836625122754865, 'recall': 0.9808712475816015, 'f1-score': 0.383529217976445, 'support': 128184}, '2': {'precision': 0.40656622442095797, 'recall': 0.008929717982911048, 'f1-score': 0.017475606160924428, 'support': 202470}, 'accuracy': 0.24178172743410156, 'macro avg': {'precision': 0.349265359252843, 'recall': 0.3342193282456691, 'f1-score': 0.14197453423878528, 'support': 538556}, 'weighted avg': {'precision': 0.3651028892292377, 'recall': 0.24178172743410156, 'f1-score': 0.10747491284216204, 'support': 538556}}
[[  2673 203594   1635]
 [  1448 125732   1004]
 [  2514 198148   1808]]
Evaluating performance on  train set...
428/428 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019968
{'0': {'precision': 0.37560303239145415, 'recall': 0.015001376273052574, 'f1-score': 0.028850480400201158, 'support': 36330}, '1': {'precision': 0.33554092121709606, 'recall': 0.9802436166444124, 'f1-score': 0.49994788155910574, 'support': 36697}, '2': {'precision': 0.36483253588516745, 'recall': 0.008363955465364998, 'f1-score': 0.01635301056243633, 'support': 36466}, 'accuracy': 0.336295470943348, 'macro avg': {'precision': 0.3586588298312392, 'recall': 0.33453631612761, 'f1-score': 0.1817171241739144, 'support': 109493}, 'weighted avg': {'precision': 0.35858901122696263, 'recall': 0.336295470943348, 'f1-score': 0.182578377117109, 'support': 109493}}
[[  545 35495   290]
 [  484 35972   241]
 [  422 35739   305]]
Evaluating performance on  val set...
141/141 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1075215
{'0': {'precision': 0.39072847682119205, 'recall': 0.014520098441345365, 'f1-score': 0.02799968361939413, 'support': 12190}, '1': {'precision': 0.30204046882538244, 'recall': 0.9824609987999631, 'f1-score': 0.4620360321250272, 'support': 10833}, '2': {'precision': 0.4484304932735426, 'recall': 0.007757951900698216, 'f1-score': 0.015252039960344696, 'support': 12890}, 'accuracy': 0.3040681647314343, 'macro avg': {'precision': 0.38039981297337233, 'recall': 0.3349130163806689, 'f1-score': 0.16842925190158867, 'support': 35913}, 'weighted avg': {'precision': 0.3846867036875689, 'recall': 0.3040681647314343, 'f1-score': 0.154349435425046, 'support': 35913}}
[[  177 11949    64]
 [  131 10643    59]
 [  145 12645   100]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
5267/5267 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0842651
{'0': {'precision': 0.34335175929297274, 'recall': 0.02687744372786232, 'f1-score': 0.0498524563376491, 'support': 385937}, '1': {'precision': 0.422578766331256, 'recall': 0.9588520340556678, 'f1-score': 0.5866244035270823, 'support': 569773}, '2': {'precision': 0.3358933545563072, 'recall': 0.021507157162003087, 'f1-score': 0.040425857989866, 'support': 392474}, 'accuracy': 0.4191875886377527, 'macro avg': {'precision': 0.36727462672684535, 'recall': 0.33574554498184433, 'f1-score': 0.2256342392848658, 'support': 1348184}, 'weighted avg': {'precision': 0.3746636421966459, 'recall': 0.4191875886377527, 'f1-score': 0.27396019527092313, 'support': 1348184}}
[[ 10373 369703   5861]
 [ 12617 546328  10828]
 [  7221 376812   8441]]
Evaluating performance on  train set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992551
{'0': {'precision': 0.4019953952417498, 'recall': 0.029347826086956522, 'f1-score': 0.05470210432875568, 'support': 89240}, '1': {'precision': 0.33028329972150194, 'recall': 0.9603811098203914, 'f1-score': 0.49152644110526417, 'support': 89528}, '2': {'precision': 0.41949344188150156, 'recall': 0.02005535494194218, 'f1-score': 0.03828057286722523, 'support': 92494}, 'accuracy': 0.33345990223473987, 'macro avg': {'precision': 0.3839240456149178, 'recall': 0.33659476361643, 'f1-score': 0.19483637276708168, 'support': 271262}, 'weighted avg': {'precision': 0.38429377775813783, 'recall': 0.33345990223473987, 'f1-score': 0.193273360501476, 'support': 271262}}
[[ 2619 85542  1079]
 [ 2059 85981  1488]
 [ 1837 88802  1855]]
Evaluating performance on  val set...
404/404 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0795002
{'0': {'precision': 0.3205240174672489, 'recall': 0.027799871226754536, 'f1-score': 0.05116230439480012, 'support': 26403}, '1': {'precision': 0.44394929390864474, 'recall': 0.9635341785387531, 'f1-score': 0.6078370745985612, 'support': 45906}, '2': {'precision': 0.34861766689143625, 'recall': 0.016625397948355148, 'f1-score': 0.031737262124002456, 'support': 31097}, 'accuracy': 0.43984875152312247, 'macro avg': {'precision': 0.37103032608910996, 'recall': 0.33598648257128755, 'f1-score': 0.23024554703912123, 'support': 103406}, 'weighted avg': {'precision': 0.38376588889117663, 'recall': 0.43984875152312247, 'f1-score': 0.2924505416487202, 'support': 103406}}
[[  734 25365   304]
 [ 1012 44232   662]
 [  544 30036   517]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
10110/10110 - 75s - 75s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.125401
{'0': {'precision': 0.4318089842169162, 'recall': 0.022900927197802196, 'f1-score': 0.04349509813912725, 'support': 1025024}, '1': {'precision': 0.19871511908238315, 'recall': 0.9631460430498517, 'f1-score': 0.3294570588574241, 'support': 516471}, '2': {'precision': 0.4606623559917288, 'recall': 0.013410077001646281, 'f1-score': 0.026061492867674094, 'support': 1046601}, 'accuracy': 0.20669480575681892, 'macro avg': {'precision': 0.3637288197636761, 'recall': 0.3331523490831001, 'f1-score': 0.13300454995474184, 'support': 2588096}, 'weighted avg': {'precision': 0.3969616470752465, 'recall': 0.20669480575681892, 'f1-score': 0.09351064281112989, 'support': 2588096}}
[[  23474  991680    9870]
 [  12472  497437    6562]
 [  18416 1014150   14035]]
Evaluating performance on  train set...
1686/1686 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006191
{'0': {'precision': 0.3881964809384164, 'recall': 0.02173556093756414, 'f1-score': 0.04116618075801749, 'support': 146166}, '1': {'precision': 0.33048091283828185, 'recall': 0.9669565946973935, 'f1-score': 0.49260283633630697, 'support': 143024}, '2': {'precision': 0.38149582229468104, 'recall': 0.013148283418553688, 'f1-score': 0.02542044906744159, 'support': 142376}, 'accuracy': 0.33215545246845213, 'macro avg': {'precision': 0.3667244053571264, 'recall': 0.33394681301783713, 'f1-score': 0.18639648872058867, 'support': 431566}, 'weighted avg': {'precision': 0.36685855258675265, 'recall': 0.33215545246845213, 'f1-score': 0.18558085182165976, 'support': 431566}}
[[  3177 141801   1188]
 [  2879 138298   1847]
 [  2128 138376   1872]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102003
{'0': {'precision': 0.3820350354081252, 'recall': 0.017814623633488017, 'f1-score': 0.03404184656260379, 'support': 57537}, '1': {'precision': 0.32549035182779107, 'recall': 0.9757458244038507, 'f1-score': 0.4881448233317025, 'support': 58794}, '2': {'precision': 0.41486486486486485, 'recall': 0.00958132422015199, 'f1-score': 0.018730076415051172, 'support': 64083}, 'accuracy': 0.3270644185041072, 'macro avg': {'precision': 0.3741300840335937, 'recall': 0.3343805907524969, 'f1-score': 0.18030558210311917, 'support': 180414}, 'weighted avg': {'precision': 0.3752691848347444, 'recall': 0.3270644185041072, 'f1-score': 0.1765879142169808, 'support': 180414}}
[[ 1025 56125   387]
 [  947 57368   479]
 [  711 62758   614]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
6546/6546 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974545
{'0': {'precision': 0.35323448945371105, 'recall': 0.014705423095505338, 'f1-score': 0.028235385410365434, 'support': 544357}, '1': {'precision': 0.35981894019025035, 'recall': 0.9807184104923167, 'f1-score': 0.5264770264084538, 'support': 602803}, '2': {'precision': 0.34869917894945096, 'recall': 0.006668507994642492, 'f1-score': 0.013086745632646698, 'support': 528604}, 'accuracy': 0.35966281648251186, 'macro avg': {'precision': 0.35391753619780414, 'recall': 0.3340307805274882, 'f1-score': 0.1892663858171553, 'support': 1675764}, 'weighted avg': {'precision': 0.3541724159060899, 'recall': 0.35966281648251186, 'f1-score': 0.2026835322481716, 'support': 1675764}}
[[  8005 533476   2876]
 [  7915 591180   3708]
 [  6742 518337   3525]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005522
{'0': {'precision': 0.39285714285714285, 'recall': 0.01849729445362994, 'f1-score': 0.035331060470123805, 'support': 106448}, '1': {'precision': 0.33859075484110496, 'recall': 0.976417663742745, 'f1-score': 0.5028195852356264, 'support': 106478}, '2': {'precision': 0.3543365455893254, 'recall': 0.009387089805777578, 'f1-score': 0.01828964989477712, 'support': 101842}, 'accuracy': 0.3395897931174706, 'macro avg': {'precision': 0.3619281477625244, 'recall': 0.33476734933405083, 'f1-score': 0.1854800985335091, 'support': 314768}, 'weighted avg': {'precision': 0.3620370114266266, 'recall': 0.3395897931174706, 'f1-score': 0.18795684137595517, 'support': 314768}}
[[  1969 103625    854]
 [  1623 103967    888]
 [  1420  99466    956]]
Evaluating performance on  val set...
444/444 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0941658
{'0': {'precision': 0.3777219430485762, 'recall': 0.01242732357884875, 'f1-score': 0.02406295851674003, 'support': 36291}, '1': {'precision': 0.3737922380568253, 'recall': 0.9843974979346158, 'f1-score': 0.5418390879267223, 'support': 42365}, '2': {'precision': 0.3592814371257485, 'recall': 0.006901311249137336, 'f1-score': 0.01354248956099763, 'support': 34776}, 'accuracy': 0.37374814867056916, 'macro avg': {'precision': 0.37026520607705, 'recall': 0.334575377587534, 'f1-score': 0.19314817866815334, 'support': 113432}, 'weighted avg': {'precision': 0.3706007692532823, 'recall': 0.37374814867056916, 'f1-score': 0.2142185221500093, 'support': 113432}}
[[  451 35654   186]
 [  419 41704   242]
 [  324 34212   240]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
7633/7633 - 55s - 55s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076715
{'0': {'precision': 0.3878682695563833, 'recall': 0.013477061197594927, 'f1-score': 0.026049010689106207, 'support': 679896}, '1': {'precision': 0.30037023044956557, 'recall': 0.9825992387166939, 'f1-score': 0.4600944400722189, 'support': 586641}, '2': {'precision': 0.3987061325771003, 'recall': 0.006544514041830194, 'f1-score': 0.012877649449715912, 'support': 687446}, 'accuracy': 0.3019959743764403, 'macro avg': {'precision': 0.36231487752768304, 'recall': 0.334206937985373, 'f1-score': 0.16634036673701366, 'support': 1953983}, 'weighted avg': {'precision': 0.3654118348906146, 'recall': 0.3019959743764403, 'f1-score': 0.15172781400528892, 'support': 1953983}}
[[  9163 667174   3559]
 [  6982 576433   3226]
 [  7479 675468   4499]]
Evaluating performance on  train set...
1586/1586 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010792
{'0': {'precision': 0.3784426114916818, 'recall': 0.01944222993112265, 'f1-score': 0.036984411077562056, 'support': 139233}, '1': {'precision': 0.33554490381818414, 'recall': 0.9724728944146733, 'f1-score': 0.49893560204304227, 'support': 136411}, '2': {'precision': 0.32533013205282113, 'recall': 0.00832654816954204, 'f1-score': 0.01623751104719963, 'support': 130186}, 'accuracy': 0.33621713525367763, 'macro avg': {'precision': 0.34643921578756237, 'recall': 0.333413890838446, 'f1-score': 0.18405250805593465, 'support': 405830}, 'weighted avg': {'precision': 0.34698554708127105, 'recall': 0.33621713525367763, 'f1-score': 0.18560395123831747, 'support': 405830}}
[[  2707 135467   1059]
 [  2566 132656   1189]
 [  1880 127222   1084]]
Evaluating performance on  val set...
574/574 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0924972
{'0': {'precision': 0.33889528193325663, 'recall': 0.013254123630144693, 'f1-score': 0.025510535548000087, 'support': 44439}, '1': {'precision': 0.3821430550936703, 'recall': 0.9823327218650376, 'f1-score': 0.5502356784796867, 'support': 56149}, '2': {'precision': 0.3682896379525593, 'recall': 0.006373279754574719, 'f1-score': 0.012529731566428812, 'support': 46287}, 'accuracy': 0.38155574468085107, 'macro avg': {'precision': 0.36310932499316206, 'recall': 0.3339867084165857, 'f1-score': 0.1960919818647052, 'support': 146875}, 'weighted avg': {'precision': 0.3646920191060194, 'recall': 0.38155574468085107, 'f1-score': 0.22201742628213647, 'support': 146875}}
[[  589 43635   215]
 [  701 55157   291]
 [  448 45544   295]]
testing model on single stock: results/universal/W10/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
22048/22048 - 161s - 161s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1186678
{'0': {'precision': 0.41454573699609043, 'recall': 0.007423105418203971, 'f1-score': 0.014585042292614517, 'support': 2156914}, '1': {'precision': 0.24183890124783455, 'recall': 0.9893290538163911, 'f1-score': 0.38866874395709, 'support': 1364640}, '2': {'precision': 0.38546900257765737, 'recall': 0.0041568728330480574, 'f1-score': 0.008225047287263249, 'support': 2122509}, 'accuracy': 0.24360323405319892, 'macro avg': {'precision': 0.34728454694052746, 'recall': 0.33363634402254777, 'f1-score': 0.13715961117898925, 'support': 5644063}, 'weighted avg': {'precision': 0.3618535032578714, 'recall': 0.24360323405319892, 'f1-score': 0.102640479661155, 'support': 5644063}}
[[  16011 2132229    8674]
 [   9170 1350078    5392]
 [  13442 2100244    8823]]
Evaluating performance on  train set...
5429/5429 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1025542
{'0': {'precision': 0.38228961902087427, 'recall': 0.00882578581693626, 'f1-score': 0.017253251883113864, 'support': 462735}, '1': {'precision': 0.32939739265467416, 'recall': 0.9888083920668743, 'f1-score': 0.4941730797376084, 'support': 457575}, '2': {'precision': 0.3673838365575845, 'recall': 0.004328146799152262, 'f1-score': 0.008555501288377653, 'support': 469485}, 'accuracy': 0.32995513726844605, 'macro avg': {'precision': 0.3596902827443777, 'recall': 0.3339874415609876, 'f1-score': 0.17332727763636666, 'support': 1389795}, 'weighted avg': {'precision': 0.35984011980747116, 'recall': 0.32995513726844605, 'f1-score': 0.1713357797325813, 'support': 1389795}}
[[  4084 456931   1720]
 [  3342 452454   1779]
 [  3257 464196   2032]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987309
{'0': {'precision': 0.3515295358649789, 'recall': 0.008825768861522164, 'f1-score': 0.017219218870093717, 'support': 151035}, '1': {'precision': 0.35218579463657973, 'recall': 0.987966729474469, 'f1-score': 0.5192660408937703, 'support': 170361}, '2': {'precision': 0.3515981735159817, 'recall': 0.004270633693019702, 'f1-score': 0.008438767185007488, 'support': 162271}, 'accuracy': 0.3521782548737044, 'macro avg': {'precision': 0.3517711680058468, 'recall': 0.33368771067633696, 'f1-score': 0.18164134231629048, 'support': 483667}, 'weighted avg': {'precision': 0.35178371653236906, 'recall': 0.3521782548737044, 'f1-score': 0.19110824990050296, 'support': 483667}}
[[  1333 149123    579]
 [  1351 168311    699]
 [  1108 160470    693]]
training model: results/universal/W10/deepLOB_L2/h300
Epoch 1/50
8543/8543 - 396s - loss: 3.2529 - accuracy300: 0.3932 - val_loss: 3.3535 - val_accuracy300: 0.3293 - 396s/epoch - 46ms/step
Epoch 2/50
8543/8543 - 390s - loss: 3.2275 - accuracy300: 0.4073 - val_loss: 3.3428 - val_accuracy300: 0.3416 - 390s/epoch - 46ms/step
Epoch 3/50
8543/8543 - 385s - loss: 3.2160 - accuracy300: 0.4131 - val_loss: 3.3382 - val_accuracy300: 0.3376 - 385s/epoch - 45ms/step
Epoch 4/50
8543/8543 - 382s - loss: 3.2060 - accuracy300: 0.4181 - val_loss: 3.3595 - val_accuracy300: 0.3499 - 382s/epoch - 45ms/step
Epoch 5/50
8543/8543 - 386s - loss: 3.1978 - accuracy300: 0.4221 - val_loss: 3.3814 - val_accuracy300: 0.3503 - 386s/epoch - 45ms/step
Epoch 6/50
8543/8543 - 383s - loss: 3.1914 - accuracy300: 0.4250 - val_loss: 3.4155 - val_accuracy300: 0.3502 - 383s/epoch - 45ms/step
Epoch 7/50
8543/8543 - 384s - loss: 3.1857 - accuracy300: 0.4276 - val_loss: 3.4196 - val_accuracy300: 0.3497 - 384s/epoch - 45ms/step
Epoch 8/50
8543/8543 - 387s - loss: 3.1813 - accuracy300: 0.4298 - val_loss: 3.3957 - val_accuracy300: 0.3470 - 387s/epoch - 45ms/step
Epoch 9/50
8543/8543 - 387s - loss: 3.1764 - accuracy300: 0.4317 - val_loss: 3.5253 - val_accuracy300: 0.3426 - 387s/epoch - 45ms/step
Epoch 10/50
8543/8543 - 392s - loss: 3.1721 - accuracy300: 0.4333 - val_loss: 3.8169 - val_accuracy300: 0.3449 - 392s/epoch - 46ms/step
Epoch 11/50
8543/8543 - 392s - loss: 3.1683 - accuracy300: 0.4352 - val_loss: 3.8236 - val_accuracy300: 0.3383 - 392s/epoch - 46ms/step
Epoch 12/50
8543/8543 - 385s - loss: 3.1649 - accuracy300: 0.4364 - val_loss: 4.0168 - val_accuracy300: 0.3381 - 385s/epoch - 45ms/step
Epoch 13/50
8543/8543 - 389s - loss: 3.1613 - accuracy300: 0.4379 - val_loss: 4.0857 - val_accuracy300: 0.3398 - 389s/epoch - 46ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 591s - 591s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1387347
{'0': {'precision': 0.3627521920178294, 'recall': 0.2859736605906977, 'f1-score': 0.3198194486053222, 'support': 3460518}, '1': {'precision': 0.2762111431488558, 'recall': 0.6299236307731048, 'f1-score': 0.3840310098667548, 'support': 2636926}, '2': {'precision': 0.3720924154188328, 'recall': 0.08670977584484177, 'f1-score': 0.14064470723502068, 'support': 3447835}, 'accuracy': 0.30901558770571297, 'macro avg': {'precision': 0.337018583528506, 'recall': 0.33420235573621476, 'f1-score': 0.2814983885690326, 'support': 9545279}, 'weighted avg': {'precision': 0.34221860754323535, 'recall': 0.30901558770571297, 'f1-score': 0.2728387569962441, 'support': 9545279}}
[[ 989617 2181128  289773]
 [ 761139 1661062  214725]
 [ 977324 2171550  298961]]
Evaluating performance on  train set...
8543/8543 - 141s - 141s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.114913
{'0': {'precision': 0.3346045311526674, 'recall': 0.4046983844671706, 'f1-score': 0.3663286329104961, 'support': 728676}, '1': {'precision': 0.3313129725472912, 'recall': 0.5646295511313192, 'f1-score': 0.4175917316777899, 'support': 724243}, '2': {'precision': 0.35109867708875175, 'recall': 0.03403375029469843, 'f1-score': 0.062052446666302254, 'support': 733801}, 'accuracy': 0.33328318211750935, 'macro avg': {'precision': 0.33900539359623677, 'recall': 0.3344538952977294, 'f1-score': 0.2819909370848627, 'support': 2186720}, 'weighted avg': {'precision': 0.33904933089978234, 'recall': 0.33328318211750935, 'f1-score': 0.2812005738532531, 'support': 2186720}}
[[294894 411635  22147]
 [291304 408929  24010]
 [295123 413704  24974]]
Evaluating performance on  val set...
3077/3077 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1132795
{'0': {'precision': 0.31900625817740436, 'recall': 0.4029116162018381, 'f1-score': 0.35608296074198026, 'support': 251132}, '1': {'precision': 0.3507132294391992, 'recall': 0.5605917349120689, 'f1-score': 0.4314843997100225, 'support': 274988}, '2': {'precision': 0.3380892478813559, 'recall': 0.03915682282620781, 'f1-score': 0.07018496311389509, 'support': 260823}, 'accuracy': 0.3374488368280803, 'macro avg': {'precision': 0.33593624516598647, 'recall': 0.3342200579800383, 'f1-score': 0.28591744118863266, 'support': 786943}, 'weighted avg': {'precision': 0.3364107197926575, 'recall': 0.3374488368280803, 'f1-score': 0.2876735809820662, 'support': 786943}}
[[101184 139561  10387]
 [111224 154156   9608]
 [104777 145833  10213]]
testing model out of sample: results/universal/W10/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 325s - 325s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1425366
{'0': {'precision': 0.3687401979810602, 'recall': 0.29115608900919615, 'f1-score': 0.32538735562313414, 'support': 2006714}, '1': {'precision': 0.26459375500364835, 'recall': 0.6560587078126889, 'f1-score': 0.37710003288750304, 'support': 1455888}, '2': {'precision': 0.3813044685818089, 'recall': 0.05084283481558625, 'f1-score': 0.08972218481123889, 'support': 1998197}, 'accuracy': 0.3005071235912547, 'macro avg': {'precision': 0.3382128071888391, 'recall': 0.3326858772124905, 'f1-score': 0.2640698577739587, 'support': 5460799}, 'weighted avg': {'precision': 0.3455714879164901, 'recall': 0.3005071235912547, 'f1-score': 0.2529405266803826, 'support': 5460799}}
[[ 584267 1327506   94941]
 [ 430837  955148   69903]
 [ 569391 1327212  101594]]
Evaluating performance on  train set...
4055/4055 - 64s - 64s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1234218
{'0': {'precision': 0.34284301999170064, 'recall': 0.3173825725156556, 'f1-score': 0.32962187739727733, 'support': 354027}, '1': {'precision': 0.320784872884515, 'recall': 0.6186503633498883, 'f1-score': 0.42249570915101536, 'support': 333838}, '2': {'precision': 0.34925667475728156, 'recall': 0.06585243768144959, 'f1-score': 0.11081136366371062, 'support': 349615}, 'accuracy': 0.3295620156533138, 'macro avg': {'precision': 0.3376281892111657, 'recall': 0.33396179118233116, 'f1-score': 0.28764298340400113, 'support': 1037480}, 'weighted avg': {'precision': 0.3379065028510328, 'recall': 0.3295620156533138, 'f1-score': 0.2857707925436353, 'support': 1037480}}
[[112362 219331  22334]
 [106746 206529  20563]
 [108628 217964  23023]]
Evaluating performance on  val set...
1545/1545 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1262496
{'0': {'precision': 0.32748591315876696, 'recall': 0.3008739741462003, 'f1-score': 0.3136164168326495, 'support': 131354}, '1': {'precision': 0.32040485862820456, 'recall': 0.6183233607969675, 'f1-score': 0.422089812371856, 'support': 127684}, '2': {'precision': 0.36789129340714644, 'recall': 0.07532366211074065, 'f1-score': 0.12504505605278432, 'support': 135867}, 'accuracy': 0.3259138273762044, 'macro avg': {'precision': 0.3385940217313726, 'recall': 0.3315069990179695, 'f1-score': 0.2869170950857633, 'support': 394905}, 'weighted avg': {'precision': 0.33909787155768883, 'recall': 0.3259138273762044, 'f1-score': 0.28381100024119105, 'support': 394905}}
[[39521 82152  9681]
 [40831 78950  7903]
 [40328 85305 10234]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1740043
{'0': {'precision': 0.7097989949748744, 'recall': 0.010518477147910267, 'f1-score': 0.02072976096567665, 'support': 53715}, '1': {'precision': 0.25590436476865086, 'recall': 0.8342584072897806, 'f1-score': 0.3916669569761365, 'support': 33691}, '2': {'precision': 0.33826205641492263, 'recall': 0.16447659499159367, 'f1-score': 0.22133246010954988, 'support': 45204}, 'accuracy': 0.27227961692180075, 'macro avg': {'precision': 0.43465513871948264, 'recall': 0.3364178264764282, 'f1-score': 0.21124305935045432, 'support': 132610}, 'weighted avg': {'precision': 0.4678329309002048, 'recall': 0.27227961692180075, 'f1-score': 0.18335165586717767, 'support': 132610}}
[[  565 44043  9107]
 [  146 28107  5438]
 [   85 37684  7435]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1307112
{'0': {'precision': 0.32586582707677403, 'recall': 0.23146396008945466, 'f1-score': 0.27066988533494263, 'support': 11626}, '1': {'precision': 0.3221260921706356, 'recall': 0.6617103642442372, 'f1-score': 0.43331220833093276, 'support': 11366}, '2': {'precision': 0.3588516746411483, 'recall': 0.08604712734974848, 'f1-score': 0.13880979498861049, 'support': 11331}, 'accuracy': 0.3259330478105061, 'macro avg': {'precision': 0.33561453129618596, 'recall': 0.32640715056114683, 'f1-score': 0.2809306295514953, 'support': 34323}, 'weighted avg': {'precision': 0.3355169884498695, 'recall': 0.3259330478105061, 'f1-score': 0.2809978275153504, 'support': 34323}}
[[2691 8052  883]
 [2986 7521  859]
 [2581 7775  975]]
Evaluating performance on  val set...
46/46 - 1s - 950ms/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1466508
{'0': {'precision': 0.43223443223443225, 'recall': 0.17771084337349397, 'f1-score': 0.2518676627534685, 'support': 4648}, '1': {'precision': 0.2608256674893426, 'recall': 0.7610474631751227, 'f1-score': 0.38850363438883784, 'support': 3055}, '2': {'precision': 0.31388564760793464, 'recall': 0.06760492586076904, 'f1-score': 0.11124896608767575, 'support': 3979}, 'accuracy': 0.29275808936825887, 'macro avg': {'precision': 0.3356485824439031, 'recall': 0.33545441080312854, 'f1-score': 0.25054008774332737, 'support': 11682}, 'weighted avg': {'precision': 0.3470980180651904, 'recall': 0.29275808936825887, 'f1-score': 0.2397037438451364, 'support': 11682}}
[[ 826 3429  393]
 [ 535 2325  195]
 [ 550 3160  269]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
1840/1840 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1327076
{'0': {'precision': 0.37129209485704956, 'recall': 0.37791774511433524, 'f1-score': 0.3745756229590186, 'support': 168452}, '1': {'precision': 0.2668116444472459, 'recall': 0.6122611337008406, 'f1-score': 0.3716606951656451, 'support': 124442}, '2': {'precision': 0.3159592773157442, 'recall': 0.024748277391856147, 'f1-score': 0.04590122955301764, 'support': 178073}, 'accuracy': 0.30630383869782807, 'macro avg': {'precision': 0.3180210055400132, 'recall': 0.33830905206901063, 'f1-score': 0.26404584922589375, 'support': 470967}, 'weighted avg': {'precision': 0.3227642000620222, 'recall': 0.30630383869782807, 'f1-score': 0.24953337010170631, 'support': 470967}}
[[ 63661 100503   4288]
 [ 42998  76191   5253]
 [ 64799 108867   4407]]
Evaluating performance on  train set...
529/529 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022284
{'0': {'precision': 0.3092346305859274, 'recall': 0.26596694953104066, 'f1-score': 0.2859734542786634, 'support': 40302}, '1': {'precision': 0.4036912566800727, 'recall': 0.6748388285135384, 'f1-score': 0.505181150677376, 'support': 54290}, '2': {'precision': 0.31072823800460786, 'recall': 0.0760126442696464, 'f1-score': 0.12214521971964089, 'support': 40809}, 'accuracy': 0.37265603651376283, 'macro avg': {'precision': 0.3412180417568693, 'recall': 0.33893947410474184, 'f1-score': 0.3044332748918934, 'support': 135401}, 'weighted avg': {'precision': 0.3475578546079071, 'recall': 0.37265603651376283, 'f1-score': 0.3244895613485296, 'support': 135401}}
[[10719 27020  2563]
 [13335 36637  4318]
 [10609 27098  3102]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1140997
{'0': {'precision': 0.3296056001365887, 'recall': 0.43969935087119916, 'f1-score': 0.3767748231275921, 'support': 17562}, '1': {'precision': 0.33504427977589013, 'recall': 0.5248881590124016, 'f1-score': 0.40901067866913776, 'support': 17659}, '2': {'precision': 0.3936651583710407, 'recall': 0.043838530877330494, 'f1-score': 0.07889168765743074, 'support': 17861}, 'accuracy': 0.33484043555254134, 'macro avg': {'precision': 0.3527716794278399, 'recall': 0.3361420135869771, 'f1-score': 0.28822572981805356, 'support': 53082}, 'weighted avg': {'precision': 0.3529696296263587, 'recall': 0.33484043555254134, 'f1-score': 0.28726731192559524, 'support': 53082}}
[[7722 9152  688]
 [7872 9269  518]
 [7834 9244  783]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
967/967 - 16s - 16s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1537936
{'0': {'precision': 0.37970655824642036, 'recall': 0.17763627154036202, 'f1-score': 0.24204010056833786, 'support': 96737}, '1': {'precision': 0.26335966006189093, 'recall': 0.6626187501815752, 'f1-score': 0.3769138607725677, 'support': 68842}, '2': {'precision': 0.30641444539982804, 'recall': 0.10869936554416788, 'f1-score': 0.1604719232674382, 'support': 81960}, 'accuracy': 0.2896876855768182, 'macro avg': {'precision': 0.31649355456937983, 'recall': 0.3163181290887017, 'f1-score': 0.2598086282027813, 'support': 247539}, 'weighted avg': {'precision': 0.3230828555824923, 'recall': 0.2896876855768182, 'f1-score': 0.2525420884910404, 'support': 247539}}
[[17184 69369 10184]
 [13244 45616  9982]
 [14828 58223  8909]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1194658
{'0': {'precision': 0.3180864456567352, 'recall': 0.34975198984888684, 'f1-score': 0.3331685072248778, 'support': 17338}, '1': {'precision': 0.3368755051336546, 'recall': 0.5806418326282118, 'f1-score': 0.42637670726855975, 'support': 19382}, '2': {'precision': 0.2880864522930944, 'recall': 0.05592223074955231, 'f1-score': 0.0936629675650199, 'support': 19545}, 'accuracy': 0.3272194081578246, 'macro avg': {'precision': 0.31434946769449473, 'recall': 0.328772017742217, 'f1-score': 0.2844027273528192, 'support': 56265}, 'weighted avg': {'precision': 0.3141376263283657, 'recall': 0.3272194081578246, 'f1-score': 0.28207858561454674, 'support': 56265}}
[[ 6064 10147  1127]
 [ 6554 11254  1574]
 [ 6446 12006  1093]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1141822
{'0': {'precision': 0.35074749466075245, 'recall': 0.3155483298847177, 'f1-score': 0.33221815918462616, 'support': 6766}, '1': {'precision': 0.34721856050619565, 'recall': 0.5798356325212797, 'f1-score': 0.43434287912933545, 'support': 6814}, '2': {'precision': 0.338160469667319, 'recall': 0.13414066138798322, 'f1-score': 0.19208537127612269, 'support': 6441}, 'accuracy': 0.3471355077168973, 'macro avg': {'precision': 0.345375508278089, 'recall': 0.3431748745979935, 'f1-score': 0.31954880319669476, 'support': 20021}, 'weighted avg': {'precision': 0.34549704836377154, 'recall': 0.3471355077168973, 'f1-score': 0.3218931282063822, 'support': 20021}}
[[2135 3772  859]
 [2031 3951  832]
 [1921 3656  864]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1588/1588 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.136834
{'0': {'precision': 0.35415637046555304, 'recall': 0.22060694788402863, 'f1-score': 0.27186618723838346, 'support': 146174}, '1': {'precision': 0.2850669089130359, 'recall': 0.6997461362973636, 'f1-score': 0.4051011896486663, 'support': 116598}, '2': {'precision': 0.4373772525238604, 'recall': 0.0884513009183773, 'f1-score': 0.14714525000434692, 'support': 143514}, 'accuracy': 0.3114308639726695, 'macro avg': {'precision': 0.3588668439674831, 'recall': 0.33626812836658987, 'f1-score': 0.27470420896379893, 'support': 406286}, 'weighted avg': {'precision': 0.3637251683803607, 'recall': 0.3114308639726695, 'f1-score': 0.26604697177151687, 'support': 406286}}
[[ 32247 105226   8701]
 [ 27381  81589   7628]
 [ 31425  99395  12694]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.117455
{'0': {'precision': 0.32133865520417565, 'recall': 0.4329444858112021, 'f1-score': 0.3688848160157902, 'support': 24174}, '1': {'precision': 0.33238834298344666, 'recall': 0.5552434081149417, 'f1-score': 0.4158400961827472, 'support': 24917}, '2': {'precision': 0.3161141094834233, 'recall': 0.01553089132164097, 'f1-score': 0.02960716348931253, 'support': 26399}, 'accuracy': 0.32734136971784344, 'macro avg': {'precision': 0.32328036922368186, 'recall': 0.33457292841592823, 'f1-score': 0.2714440252292833, 'support': 75490}, 'weighted avg': {'precision': 0.3231587941353447, 'recall': 0.32734136971784344, 'f1-score': 0.2657372993496567, 'support': 75490}}
[[10466 13206   502]
 [10697 13835   385]
 [11407 14582   410]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1086987
{'0': {'precision': 0.3106784798321287, 'recall': 0.2626909807787087, 'f1-score': 0.28467660097206643, 'support': 10145}, '1': {'precision': 0.38947080790600236, 'recall': 0.7097684455141505, 'f1-score': 0.502955273914194, 'support': 12049}, '2': {'precision': 0.32647267565649396, 'recall': 0.08243727598566308, 'f1-score': 0.13163542709972814, 'support': 11160}, 'accuracy': 0.36388439167716014, 'macro avg': {'precision': 0.3422073211315417, 'recall': 0.3516322340928408, 'f1-score': 0.3064224339953296, 'support': 33354}, 'weighted avg': {'precision': 0.3444265156407879, 'recall': 0.36388439167716014, 'f1-score': 0.312322467430794, 'support': 33354}}
[[2665 6543  937]
 [2536 8552  961]
 [3377 6863  920]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
2104/2104 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1625386
{'0': {'precision': 0.4022579857247537, 'recall': 0.14055150963434987, 'f1-score': 0.20831605798893907, 'support': 210912}, '1': {'precision': 0.23768899574016855, 'recall': 0.8266004371150407, 'f1-score': 0.3692112722554628, 'support': 125825}, '2': {'precision': 0.37770693635264374, 'recall': 0.05107420326621215, 'f1-score': 0.08998101390131594, 'support': 201824}, 'accuracy': 0.26730305387876213, 'macro avg': {'precision': 0.33921797260585534, 'recall': 0.33940871667186756, 'f1-score': 0.22250278138190593, 'support': 538561}, 'weighted avg': {'precision': 0.3546090023165842, 'recall': 0.26730305387876213, 'f1-score': 0.20156062712250966, 'support': 538561}}
[[ 29644 171180  10088]
 [ 14923 104007   6895]
 [ 29127 162389  10308]]
Evaluating performance on  train set...
428/428 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1305133
{'0': {'precision': 0.33021320852834113, 'recall': 0.20768601798855274, 'f1-score': 0.2549944784660175, 'support': 36690}, '1': {'precision': 0.31916190372998887, 'recall': 0.658405744460898, 'f1-score': 0.4299201824401368, 'support': 35791}, '2': {'precision': 0.3343134138588684, 'recall': 0.11366276713587119, 'f1-score': 0.1696473577030869, 'support': 37013}, 'accuracy': 0.32323232323232326, 'macro avg': {'precision': 0.32789617537239946, 'recall': 0.3265848431951073, 'f1-score': 0.2848540062030804, 'support': 109494}, 'weighted avg': {'precision': 0.3279868184965675, 'recall': 0.32323232323232326, 'f1-score': 0.2833230890760907, 'support': 109494}}
[[ 7620 24816  4254]
 [ 8103 23565  4123]
 [ 7353 25453  4207]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1356252
{'0': {'precision': 0.3411199650693156, 'recall': 0.2574771360303205, 'f1-score': 0.2934547844868063, 'support': 12137}, '1': {'precision': 0.3061748824246647, 'recall': 0.6386012715712989, 'f1-score': 0.4139047506917054, 'support': 11010}, '2': {'precision': 0.3328933474128828, 'recall': 0.09877800407331976, 'f1-score': 0.15234988522411502, 'support': 12766}, 'accuracy': 0.3179071645365188, 'macro avg': {'precision': 0.3267293983022877, 'recall': 0.3316188038916464, 'f1-score': 0.28656980680087557, 'support': 35913}, 'weighted avg': {'precision': 0.3274823864509983, 'recall': 0.3179071645365188, 'f1-score': 0.2802230573664995, 'support': 35913}}
[[3125 7633 1379]
 [2831 7031 1148]
 [3205 8300 1261]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
5267/5267 - 82s - 82s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1173987
{'0': {'precision': 0.3583697344326896, 'recall': 0.3926739894819856, 'f1-score': 0.3747384309286131, 'support': 459022}, '1': {'precision': 0.3124139436722218, 'recall': 0.5146227432928145, 'f1-score': 0.3887985219265673, 'support': 417090}, '2': {'precision': 0.3841115705091732, 'recall': 0.12870358013629132, 'f1-score': 0.19280449976596772, 'support': 472077}, 'accuracy': 0.337970418094199, 'macro avg': {'precision': 0.35163174953802817, 'recall': 0.3453334376370305, 'f1-score': 0.31878048420704935, 'support': 1348189}, 'weighted avg': {'precision': 0.3531660337506596, 'recall': 0.337970418094199, 'f1-score': 0.3153828798396104, 'support': 1348189}}
[[180246 230265  48511]
 [153537 214644  48909]
 [169178 242141  60758]]
Evaluating performance on  train set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1122507
{'0': {'precision': 0.3403483818855467, 'recall': 0.42998169818645665, 'f1-score': 0.37995030702807603, 'support': 90155}, '1': {'precision': 0.3279713338355075, 'recall': 0.5206933935377153, 'f1-score': 0.4024498751738496, 'support': 89473}, '2': {'precision': 0.3670671193523113, 'recall': 0.06135210345392045, 'f1-score': 0.10513225682789315, 'support': 91635}, 'accuracy': 0.3353756317669568, 'macro avg': {'precision': 0.3451289450244552, 'recall': 0.3373423983926975, 'f1-score': 0.29584414634327294, 'support': 271263}, 'weighted avg': {'precision': 0.34529177588909976, 'recall': 0.3353756317669568, 'f1-score': 0.29453560554137503, 'support': 271263}}
[[38765 46947  4443]
 [37634 46588  5251]
 [37499 48514  5622]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101146
{'0': {'precision': 0.3091417217964673, 'recall': 0.4475880381867611, 'f1-score': 0.3657002647381675, 'support': 31634}, '1': {'precision': 0.3617946805866269, 'recall': 0.5447376159542332, 'f1-score': 0.43480673004086245, 'support': 37407}, '2': {'precision': 0.32579890880748247, 'recall': 0.012163538483922596, 'f1-score': 0.02345152603231598, 'support': 34365}, 'accuracy': 0.338026806955109, 'macro avg': {'precision': 0.33224510373019217, 'recall': 0.3348297308749723, 'f1-score': 0.2746528402704486, 'support': 103406}, 'weighted avg': {'precision': 0.33372456477556944, 'recall': 0.338026806955109, 'f1-score': 0.276959646611089, 'support': 103406}}
[[14159 17051   424]
 [16589 20377   441]
 [15053 18894   418]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
10110/10110 - 151s - 151s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1474539
{'0': {'precision': 0.37144626501202044, 'recall': 0.28505020067819686, 'f1-score': 0.32256329749322793, 'support': 963732}, '1': {'precision': 0.2462877147979054, 'recall': 0.6672091923323039, 'f1-score': 0.35977226849714217, 'support': 646974}, '2': {'precision': 0.41489883443072845, 'recall': 0.04068058461522721, 'f1-score': 0.07409609141766707, 'support': 977395}, 'accuracy': 0.2882963222841767, 'macro avg': {'precision': 0.3442109380802181, 'recall': 0.3309799925419093, 'f1-score': 0.25214388580267905, 'support': 2588101}, 'weighted avg': {'precision': 0.35656894616734286, 'recall': 0.2882963222841767, 'f1-score': 0.23803129195096495, 'support': 2588101}}
[[274712 654721  34299]
 [193534 431667  21773]
 [271328 666306  39761]]
Evaluating performance on  train set...
1686/1686 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1235008
{'0': {'precision': 0.3467657495200977, 'recall': 0.3202197020056537, 'f1-score': 0.3329644588891177, 'support': 148929}, '1': {'precision': 0.3202578233014624, 'recall': 0.602694244314309, 'f1-score': 0.4182612587867875, 'support': 136439}, '2': {'precision': 0.36922870556673376, 'recall': 0.09413816689466484, 'f1-score': 0.1500258890857065, 'support': 146200}, 'accuracy': 0.33293478663849035, 'macro avg': {'precision': 0.3454174261294313, 'recall': 0.3390173710715425, 'f1-score': 0.30041720225387053, 'support': 431568}, 'weighted avg': {'precision': 0.3459950001333818, 'recall': 0.33293478663849035, 'f1-score': 0.2979576724174133, 'support': 431568}}
[[47690 88273 12966]
 [43662 82231 10546]
 [46176 86261 13763]]
Evaluating performance on  val set...
705/705 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1358824
{'0': {'precision': 0.34063749790454295, 'recall': 0.2283256015538469, 'f1-score': 0.2733965056605224, 'support': 62297}, '1': {'precision': 0.29333848141961105, 'recall': 0.716717044338769, 'f1-score': 0.4162953105692511, 'support': 51941}, '2': {'precision': 0.394161205208954, 'recall': 0.06998005319148937, 'f1-score': 0.11885787616297723, 'support': 66176}, 'accuracy': 0.3108517077388673, 'macro avg': {'precision': 0.34271239484436933, 'recall': 0.33834089969470177, 'f1-score': 0.26951656413091696, 'support': 180414}, 'weighted avg': {'precision': 0.3466526998253077, 'recall': 0.3108517077388673, 'f1-score': 0.2578520272948453, 'support': 180414}}
[[14224 43728  4345]
 [11941 37227  2773]
 [15592 45953  4631]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
6546/6546 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1329217
{'0': {'precision': 0.33666586309943464, 'recall': 0.12944651589028255, 'f1-score': 0.1869944887191167, 'support': 571796}, '1': {'precision': 0.3258263596901993, 'recall': 0.7848862955059436, 'f1-score': 0.4604910968449651, 'support': 548747}, '2': {'precision': 0.33657131772535326, 'recall': 0.0812497973798057, 'f1-score': 0.13089980558860226, 'support': 555226}, 'accuracy': 0.3281078716696633, 'macro avg': {'precision': 0.33302118017166243, 'recall': 0.3318608695920106, 'f1-score': 0.25946179705089467, 'support': 1675769}, 'weighted avg': {'precision': 0.33308503601218253, 'recall': 0.3281078716696633, 'f1-score': 0.25796800397295655, 'support': 1675769}}
[[ 74017 450566  47213]
 [ 76334 430704  41709]
 [ 69502 440612  45112]]
Evaluating performance on  train set...
1230/1230 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1331774
{'0': {'precision': 0.34355292395031917, 'recall': 0.24312606233582082, 'f1-score': 0.28474403057368236, 'support': 110017}, '1': {'precision': 0.31216890887610044, 'recall': 0.6622803028006023, 'f1-score': 0.42432856842207506, 'support': 98943}, '2': {'precision': 0.36491241065145735, 'recall': 0.09311974293545033, 'f1-score': 0.14837626401427592, 'support': 105810}, 'accuracy': 0.32445595196492677, 'macro avg': {'precision': 0.34021141449262565, 'recall': 0.33284203602395784, 'f1-score': 0.2858162876700111, 'support': 314770}, 'weighted avg': {'precision': 0.34086784813101945, 'recall': 0.32445595196492677, 'f1-score': 0.28278018252171655, 'support': 314770}}
[[26748 74482  8787]
 [25054 65528  8361]
 [26055 69902  9853]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266217
{'0': {'precision': 0.3340795501874219, 'recall': 0.16895734597156398, 'f1-score': 0.2244177100090928, 'support': 37980}, '1': {'precision': 0.35052334625220805, 'recall': 0.6802773300585873, 'f1-score': 0.4626560528948628, 'support': 39087}, '2': {'precision': 0.3404290069686411, 'recall': 0.17194159540242526, 'f1-score': 0.22848268932127522, 'support': 36367}, 'accuracy': 0.3461043426133258, 'macro avg': {'precision': 0.34167730113609035, 'recall': 0.3403920904775255, 'f1-score': 0.30518548407507695, 'support': 113434}, 'weighted avg': {'precision': 0.3417813798993856, 'recall': 0.3461043426133258, 'f1-score': 0.3078129284711256, 'support': 113434}}
[[ 6417 24925  6638]
 [ 7020 26590  5477]
 [ 5771 24343  6253]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
7633/7633 - 113s - 113s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1269593
{'0': {'precision': 0.3612566240416978, 'recall': 0.38375453699872947, 'f1-score': 0.37216588353720775, 'support': 681618}, '1': {'precision': 0.30426589603504406, 'recall': 0.596297342547489, 'f1-score': 0.40293215947632693, 'support': 580556}, '2': {'precision': 0.38077979013162894, 'recall': 0.05072172578178528, 'f1-score': 0.0895190741447025, 'support': 691814}, 'accuracy': 0.32899280855358376, 'macro avg': {'precision': 0.3487674367361236, 'recall': 0.3435912017760013, 'f1-score': 0.2882057057194124, 'support': 1953988}, 'weighted avg': {'precision': 0.3512361380083694, 'recall': 0.32899280855358376, 'f1-score': 0.2812351952735361, 'support': 1953988}}
[[261574 388778  31266]
 [208575 346184  25797]
 [253918 402806  35090]]
Evaluating performance on  train set...
1586/1586 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1214454
{'0': {'precision': 0.344586305278174, 'recall': 0.3464544906916038, 'f1-score': 0.34551787272389184, 'support': 139444}, '1': {'precision': 0.32140178738828823, 'recall': 0.628794131132508, 'f1-score': 0.42537660645788317, 'support': 130860}, '2': {'precision': 0.31734969835656335, 'recall': 0.022512285465519533, 'f1-score': 0.04204216618437371, 'support': 135526}, 'accuracy': 0.32931523051524036, 'macro avg': {'precision': 0.3277792636743419, 'recall': 0.3325869690965438, 'f1-score': 0.27097888178871626, 'support': 405830}, 'weighted avg': {'precision': 0.3280148482623579, 'recall': 0.32931523051524036, 'f1-score': 0.2699233264654964, 'support': 405830}}
[[48311 87900  3233]
 [45246 82284  3330]
 [46643 85832  3051]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1120317
{'0': {'precision': 0.3101827083637307, 'recall': 0.42045005054278556, 'f1-score': 0.3569955872337646, 'support': 45506}, '1': {'precision': 0.3764889337334399, 'recall': 0.5236767279090113, 'f1-score': 0.4380493531640455, 'support': 54864}, '2': {'precision': 0.35814844013965536, 'recall': 0.06837974411353617, 'f1-score': 0.11483460927343636, 'support': 46505}, 'accuracy': 0.3475336170212766, 'macro avg': {'precision': 0.3482733607456086, 'recall': 0.3375021741884443, 'f1-score': 0.3032931832237488, 'support': 146875}, 'weighted avg': {'precision': 0.35013825631214324, 'recall': 0.3475336170212766, 'f1-score': 0.31059720448621647, 'support': 146875}}
[[19133 23657  2716]
 [23150 28731  2983]
 [19400 23925  3180]]
testing model on single stock: results/universal/W10/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
22048/22048 - 329s - 329s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1461421
{'0': {'precision': 0.3673837974395866, 'recall': 0.3026603324517251, 'f1-score': 0.33189605672235084, 'support': 2115074}, '1': {'precision': 0.2501563907006653, 'recall': 0.6006535440394001, 'f1-score': 0.3532100801910951, 'support': 1430049}, '2': {'precision': 0.37599138290301276, 'recall': 0.08381782276334063, 'f1-score': 0.13707763439419177, 'support': 2098945}, 'accuracy': 0.2967792025184672, 'macro avg': {'precision': 0.3311771903477549, 'recall': 0.32904389975148857, 'f1-score': 0.27406125710254586, 'support': 5644068}, 'weighted avg': {'precision': 0.3408826838263103, 'recall': 0.2967792025184672, 'f1-score': 0.2648463586134472, 'support': 5644068}}
[[ 640149 1294057  180868]
 [ 459975  858964  111110]
 [ 642329 1280687  175929]]
Evaluating performance on  train set...
5429/5429 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11274
{'0': {'precision': 0.3336941461724974, 'recall': 0.44844061134241897, 'f1-score': 0.3826501903238263, 'support': 464028}, '1': {'precision': 0.32855360430042024, 'recall': 0.5386273049800709, 'f1-score': 0.4081453835801254, 'support': 456620}, '2': {'precision': 0.341881311698627, 'recall': 0.012844560778261871, 'f1-score': 0.024758923032043623, 'support': 469148}, 'accuracy': 0.3310291582361728, 'macro avg': {'precision': 0.3347096873905149, 'recall': 0.33330415903358396, 'f1-score': 0.2718514989786651, 'support': 1389796}, 'weighted avg': {'precision': 0.3347689212492891, 'recall': 0.3310291582361728, 'f1-score': 0.27021472704524874, 'support': 1389796}}
[[208089 250122   5817]
 [204889 245948   5783]
 [210614 252508   6026]]
Evaluating performance on  val set...
1890/1890 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1111201
{'0': {'precision': 0.31807301965078344, 'recall': 0.45703493248207216, 'f1-score': 0.3750973800757697, 'support': 153811}, '1': {'precision': 0.34901191463191533, 'recall': 0.53123481805363, 'f1-score': 0.42126207137940835, 'support': 168786}, '2': {'precision': 0.33774143031146686, 'recall': 0.012050661203203576, 'f1-score': 0.023271009549386452, 'support': 161070}, 'accuracy': 0.33474063767013257, 'macro avg': {'precision': 0.3349421215313885, 'recall': 0.3334401372463019, 'f1-score': 0.2732101536681882, 'support': 483667}, 'weighted avg': {'precision': 0.33541975456013556, 'recall': 0.33474063767013257, 'f1-score': 0.27404289441867796, 'support': 483667}}
[[70297 81735  1779]
 [77094 89665  2027]
 [73618 85511  1941]]
training model: results/universal/W10/deepLOB_L2/h500
Epoch 1/50
8543/8543 - 388s - loss: 3.2326 - accuracy500: 0.4081 - val_loss: 3.3789 - val_accuracy500: 0.3434 - 388s/epoch - 45ms/step
Epoch 2/50
8543/8543 - 390s - loss: 3.2009 - accuracy500: 0.4237 - val_loss: 3.3818 - val_accuracy500: 0.3431 - 390s/epoch - 46ms/step
Epoch 3/50
8543/8543 - 392s - loss: 3.1851 - accuracy500: 0.4311 - val_loss: 3.3507 - val_accuracy500: 0.3404 - 392s/epoch - 46ms/step
Epoch 4/50
8543/8543 - 388s - loss: 3.1751 - accuracy500: 0.4352 - val_loss: 3.3476 - val_accuracy500: 0.3377 - 388s/epoch - 45ms/step
Epoch 5/50
8543/8543 - 388s - loss: 3.1678 - accuracy500: 0.4382 - val_loss: 3.3449 - val_accuracy500: 0.3422 - 388s/epoch - 45ms/step
Epoch 6/50
8543/8543 - 389s - loss: 3.1598 - accuracy500: 0.4413 - val_loss: 3.3404 - val_accuracy500: 0.3435 - 389s/epoch - 46ms/step
Epoch 7/50
8543/8543 - 393s - loss: 3.1565 - accuracy500: 0.4425 - val_loss: 3.3550 - val_accuracy500: 0.3437 - 393s/epoch - 46ms/step
Epoch 8/50
8543/8543 - 388s - loss: 3.1515 - accuracy500: 0.4447 - val_loss: 3.3305 - val_accuracy500: 0.3454 - 388s/epoch - 45ms/step
Epoch 9/50
8543/8543 - 390s - loss: 3.1465 - accuracy500: 0.4467 - val_loss: 3.3503 - val_accuracy500: 0.3425 - 390s/epoch - 46ms/step
Epoch 10/50
8543/8543 - 386s - loss: 3.1411 - accuracy500: 0.4485 - val_loss: 3.3402 - val_accuracy500: 0.3422 - 386s/epoch - 45ms/step
Epoch 11/50
8543/8543 - 388s - loss: 3.1369 - accuracy500: 0.4502 - val_loss: 3.3578 - val_accuracy500: 0.3436 - 388s/epoch - 45ms/step
Epoch 12/50
8543/8543 - 386s - loss: 3.1333 - accuracy500: 0.4512 - val_loss: 3.3867 - val_accuracy500: 0.3452 - 386s/epoch - 45ms/step
Epoch 13/50
8543/8543 - 387s - loss: 3.1298 - accuracy500: 0.4525 - val_loss: 3.3898 - val_accuracy500: 0.3440 - 387s/epoch - 45ms/step
Epoch 14/50
8543/8543 - 386s - loss: 3.1265 - accuracy500: 0.4538 - val_loss: 3.3817 - val_accuracy500: 0.3437 - 386s/epoch - 45ms/step
Epoch 15/50
8543/8543 - 389s - loss: 3.1236 - accuracy500: 0.4550 - val_loss: 3.4074 - val_accuracy500: 0.3423 - 389s/epoch - 46ms/step
Epoch 16/50
8543/8543 - 384s - loss: 3.1198 - accuracy500: 0.4560 - val_loss: 3.4418 - val_accuracy500: 0.3455 - 384s/epoch - 45ms/step
Epoch 17/50
8543/8543 - 388s - loss: 3.1169 - accuracy500: 0.4571 - val_loss: 3.3969 - val_accuracy500: 0.3453 - 388s/epoch - 45ms/step
Epoch 18/50
8543/8543 - 393s - loss: 3.1146 - accuracy500: 0.4578 - val_loss: 3.4153 - val_accuracy500: 0.3458 - 393s/epoch - 46ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 564s - 564s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1227736
{'0': {'precision': 0.37929971893451486, 'recall': 0.2975038619178686, 'f1-score': 0.3334590253357194, 'support': 3520919}, '1': {'precision': 0.2753831608107798, 'recall': 0.6595987992755176, 'f1-score': 0.38854739442185987, 'support': 2529806}, '2': {'precision': 0.3777953286461469, 'recall': 0.07829783142569839, 'f1-score': 0.1297127760087115, 'support': 3494554}, 'accuracy': 0.3132187126222293, 'macro avg': {'precision': 0.34415940279714713, 'recall': 0.34513349753969486, 'f1-score': 0.2839063985887636, 'support': 9545279}, 'weighted avg': {'precision': 0.35120772651181553, 'recall': 0.3132187126222293, 'f1-score': 0.27346712945437746, 'support': 9545279}}
[[1047487 2202507  270925]
 [ 681446 1668657  179703]
 [1032701 2188237  273616]]
Evaluating performance on  train set...
8543/8543 - 135s - 135s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1169102
{'0': {'precision': 0.3581171723242361, 'recall': 0.09117972945832918, 'f1-score': 0.14535166727104631, 'support': 731939}, '1': {'precision': 0.3316649197394919, 'recall': 0.9033533047708305, 'f1-score': 0.4851921945395035, 'support': 717024}, '2': {'precision': 0.36098631061612774, 'recall': 0.02319734004557056, 'f1-score': 0.0435933293087067, 'support': 737757}, 'accuracy': 0.33455494987927126, 'macro avg': {'precision': 0.3502561342266186, 'recall': 0.3392434580915768, 'f1-score': 0.2247123970397522, 'support': 2186720}, 'weighted avg': {'precision': 0.35041148842391395, 'recall': 0.33455494987927126, 'f1-score': 0.22245385140255675, 'support': 2186720}}
[[ 66738 649828  15373]
 [ 54376 647726  14922]
 [ 65244 655399  17114]]
Evaluating performance on  val set...
3077/3077 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1118712
{'0': {'precision': 0.35270310569590596, 'recall': 0.06520925799756618, 'f1-score': 0.11006856850369101, 'support': 253921}, '1': {'precision': 0.34447648149744337, 'recall': 0.9268462375767279, 'f1-score': 0.5022748764249017, 'support': 267341}, '2': {'precision': 0.3663428543811319, 'recall': 0.028530455696869555, 'f1-score': 0.05293813640998422, 'support': 265681}, 'accuracy': 0.34554218031039097, 'macro avg': {'precision': 0.3545074805248271, 'recall': 0.3401953170903879, 'f1-score': 0.22176052711285898, 'support': 786943}, 'weighted avg': {'precision': 0.35451328525223763, 'recall': 0.34554218031039097, 'f1-score': 0.2240213658941961, 'support': 786943}}
[[ 16558 229585   7778]
 [ 14224 247784   5333]
 [ 16164 241937   7580]]
testing model out of sample: results/universal/W10/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 318s - 318s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146375
{'0': {'precision': 0.3820233723205912, 'recall': 0.31145606409238186, 'f1-score': 0.34314931254403974, 'support': 1959172}, '1': {'precision': 0.3024754115436099, 'recall': 0.7066623002510474, 'f1-score': 0.42362497723062736, 'support': 1545127}, '2': {'precision': 0.38309663738022315, 'recall': 0.04967646307181191, 'f1-score': 0.08794856214434796, 'support': 1956500}, 'accuracy': 0.32948859681522796, 'macro avg': {'precision': 0.3558651404148081, 'recall': 0.3559316091384137, 'f1-score': 0.28490761730633835, 'support': 5460799}, 'weighted avg': {'precision': 0.359899895719038, 'recall': 0.32948859681522796, 'f1-score': 0.2744862568617479, 'support': 5460799}}
[[ 610196 1258185   90791]
 [ 387526 1091883   65718]
 [ 599552 1259756   97192]]
Evaluating performance on  train set...
4055/4055 - 64s - 64s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1111556
{'0': {'precision': 0.35097139860566856, 'recall': 0.27721039223362665, 'f1-score': 0.30976039257766985, 'support': 352494}, '1': {'precision': 0.3370429752136911, 'recall': 0.7005100844799601, 'f1-score': 0.4551131160656622, 'support': 337003}, '2': {'precision': 0.35457025920873125, 'recall': 0.059750045260831705, 'f1-score': 0.1022667188034125, 'support': 347983}, 'accuracy': 0.3417714076415931, 'macro avg': {'precision': 0.3475282110093636, 'recall': 0.34582350732480616, 'f1-score': 0.2890467424822482, 'support': 1037480}, 'weighted avg': {'precision': 0.3476541508908875, 'recall': 0.3417714076415931, 'f1-score': 0.28737926985013434, 'support': 1037480}}
[[ 97715 235172  19607]
 [ 82688 236074  18241]
 [ 98010 229181  20792]]
Evaluating performance on  val set...
1545/1545 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048335
{'0': {'precision': 0.3205716852837487, 'recall': 0.3374829659318637, 'f1-score': 0.3288100249530422, 'support': 124750}, '1': {'precision': 0.3728796568187229, 'recall': 0.6413443301339158, 'f1-score': 0.47158074902469377, 'support': 139192}, '2': {'precision': 0.36363636363636365, 'recall': 0.06710292219939983, 'f1-score': 0.11329852381873266, 'support': 130963}, 'accuracy': 0.3549182714830149, 'macro avg': {'precision': 0.35236256857961173, 'recall': 0.3486434060883931, 'f1-score': 0.3045630992654895, 'support': 394905}, 'weighted avg': {'precision': 0.3532902648028473, 'recall': 0.3549182714830149, 'f1-score': 0.3076619257948364, 'support': 394905}}
[[42101 74490  8159]
 [42702 89270  7220]
 [46528 75647  8788]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1123749
{'0': {'precision': 0.39618993053068824, 'recall': 0.5233482176644214, 'f1-score': 0.45097703538849077, 'support': 52852}, '1': {'precision': 0.27442269812665016, 'recall': 0.3637676731201911, 'f1-score': 0.3128411547603406, 'support': 36001}, '2': {'precision': 0.2987461023021296, 'recall': 0.10290924880590534, 'f1-score': 0.15308516063233044, 'support': 43757}, 'accuracy': 0.3412940200588191, 'macro avg': {'precision': 0.32311957698648935, 'recall': 0.33000837986350595, 'f1-score': 0.30563445026038727, 'support': 132610}, 'weighted avg': {'precision': 0.33097922450870787, 'recall': 0.3412940200588191, 'f1-score': 0.3151812085111863, 'support': 132610}}
[[27660 18357  6835]
 [19170 13096  3735]
 [22985 16269  4503]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1101491
{'0': {'precision': 0.3522306471521777, 'recall': 0.3409866848753841, 'f1-score': 0.3465174776650186, 'support': 11716}, '1': {'precision': 0.34491926907086917, 'recall': 0.6306346119851511, 'f1-score': 0.44593750000000004, 'support': 11314}, '2': {'precision': 0.3673202614379085, 'recall': 0.07464801204285841, 'f1-score': 0.12408007065057404, 'support': 11293}, 'accuracy': 0.3488331439559479, 'macro avg': {'precision': 0.35482339255365175, 'recall': 0.34875643630113123, 'f1-score': 0.30551168277186425, 'support': 34323}, 'weighted avg': {'precision': 0.3547853796206925, 'recall': 0.3488331439559479, 'f1-score': 0.3061029595658973, 'support': 34323}}
[[3995 6993  728]
 [3455 7135  724]
 [3892 6558  843]]
Evaluating performance on  val set...
46/46 - 1s - 993ms/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157027
{'0': {'precision': 0.37502900905082387, 'recall': 0.3501625135427952, 'f1-score': 0.36216943074854324, 'support': 4615}, '1': {'precision': 0.29298067141403866, 'recall': 0.6055872634424753, 'f1-score': 0.3949069539666994, 'support': 3329}, '2': {'precision': 0.2764227642276423, 'recall': 0.03638309256286784, 'f1-score': 0.06430260047281323, 'support': 3738}, 'accuracy': 0.32254750898818696, 'macro avg': {'precision': 0.31481081489750157, 'recall': 0.33071095651604615, 'f1-score': 0.2737929950626853, 'support': 11682}, 'weighted avg': {'precision': 0.3200958589787548, 'recall': 0.32254750898818696, 'f1-score': 0.27618732179652844, 'support': 11682}}
[[1616 2782  217]
 [1174 2016  139]
 [1519 2083  136]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
1840/1840 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1489383
{'0': {'precision': 0.3379491454772822, 'recall': 0.22813840144974842, 'f1-score': 0.2723931244876292, 'support': 177686}, '1': {'precision': 0.19036791136422718, 'recall': 0.6392899788278028, 'f1-score': 0.29337465349087793, 'support': 99659}, '2': {'precision': 0.3898678414096916, 'recall': 0.03290948342647013, 'f1-score': 0.06069554118285817, 'support': 193622}, 'accuracy': 0.23487845220578088, 'macro avg': {'precision': 0.3060616327504004, 'recall': 0.3001126212346738, 'f1-score': 0.20882110638712173, 'support': 470967}, 'weighted avg': {'precision': 0.32806480864126614, 'recall': 0.23487845220578088, 'f1-score': 0.18980068961278315, 'support': 470967}}
[[ 40537 131992   5157]
 [ 31133  63711   4815]
 [ 48280 138970   6372]]
Evaluating performance on  train set...
529/529 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1188066
{'0': {'precision': 0.32791507712721846, 'recall': 0.31128255881956, 'f1-score': 0.3193824211583065, 'support': 44458}, '1': {'precision': 0.31633055127699966, 'recall': 0.5919165288886903, 'f1-score': 0.41231353446062147, 'support': 44758}, '2': {'precision': 0.35249285487456333, 'recall': 0.07210133160116922, 'f1-score': 0.11971527178602243, 'support': 46185}, 'accuracy': 0.32246438357176094, 'macro avg': {'precision': 0.3322461610929272, 'recall': 0.3251001397698065, 'f1-score': 0.2838037424683168, 'support': 135401}, 'weighted avg': {'precision': 0.33246913845067266, 'recall': 0.32246438357176094, 'f1-score': 0.2819955737600308, 'support': 135401}}
[[13839 28066  2553]
 [14701 26493  3564]
 [13663 29192  3330]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1350062
{'0': {'precision': 0.36220980223559757, 'recall': 0.0880999686290913, 'f1-score': 0.14172764740516444, 'support': 19126}, '1': {'precision': 0.2762944044578593, 'recall': 0.8982981059566292, 'f1-score': 0.42260569177872115, 'support': 14572}, '2': {'precision': 0.3922127255460589, 'recall': 0.021306231943871233, 'f1-score': 0.04041689093311151, 'support': 19384}, 'accuracy': 0.28612335631664215, 'macro avg': {'precision': 0.34357231074650524, 'recall': 0.3359014355098639, 'f1-score': 0.20158341003899904, 'support': 53082}, 'weighted avg': {'precision': 0.3495806151106358, 'recall': 0.28612335631664215, 'f1-score': 0.18183817751249262, 'support': 53082}}
[[ 1685 17034   407]
 [ 1249 13090   233]
 [ 1718 17253   413]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
967/967 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1154028
{'0': {'precision': 0.43190273533783224, 'recall': 0.46128590161994815, 'f1-score': 0.446111010460271, 'support': 101423}, '1': {'precision': 0.2718447454887284, 'recall': 0.47848273515904066, 'f1-score': 0.3467099918765231, 'support': 64669}, '2': {'precision': 0.3034659314690823, 'recall': 0.09460139722764498, 'f1-score': 0.14423841927422149, 'support': 81447}, 'accuracy': 0.3451294543486077, 'macro avg': {'precision': 0.3357378040985477, 'recall': 0.3447900113355446, 'f1-score': 0.3123531405370052, 'support': 247539}, 'weighted avg': {'precision': 0.347828781293218, 'recall': 0.3451294543486077, 'f1-score': 0.320818505420166, 'support': 247539}}
[[46785 44160 10478]
 [26519 30943  7207]
 [35019 38723  7705]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1243297
{'0': {'precision': 0.3181673560292714, 'recall': 0.16790731516203056, 'f1-score': 0.2198124267291911, 'support': 17867}, '1': {'precision': 0.3083084905445691, 'recall': 0.7682014062145611, 'f1-score': 0.4400201367349259, 'support': 17636}, '2': {'precision': 0.29830625648116144, 'recall': 0.04156632309026105, 'f1-score': 0.07296554639611076, 'support': 20762}, 'accuracy': 0.30944636985692703, 'macro avg': {'precision': 0.30826070101833397, 'recall': 0.3258916814889509, 'f1-score': 0.24426603662007593, 'support': 56265}, 'weighted avg': {'precision': 0.3077483193189529, 'recall': 0.30944636985692703, 'f1-score': 0.23464843924471096, 'support': 56265}}
[[ 3000 13963   904]
 [ 2962 13548  1126]
 [ 3467 16432   863]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.119507
{'0': {'precision': 0.36161112101229725, 'recall': 0.2906460392493912, 'f1-score': 0.32226810673443457, 'support': 6981}, '1': {'precision': 0.3143726966832238, 'recall': 0.6292495189223861, 'f1-score': 0.41927556362859275, 'support': 6236}, '2': {'precision': 0.3599585062240664, 'recall': 0.10199882422104645, 'f1-score': 0.15895556573522676, 'support': 6804}, 'accuracy': 0.33200139853154187, 'macro avg': {'precision': 0.34531410797319584, 'recall': 0.3406314607976079, 'f1-score': 0.30016641203275135, 'support': 20021}, 'weighted avg': {'precision': 0.3463359996329843, 'recall': 0.33200139853154187, 'f1-score': 0.2969826550703498, 'support': 20021}}
[[2029 4281  671]
 [1749 3924  563]
 [1833 4277  694]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1588/1588 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1324494
{'0': {'precision': 0.331225426286559, 'recall': 0.45222010427762516, 'f1-score': 0.3823796064209909, 'support': 142696}, '1': {'precision': 0.2480156402737048, 'recall': 0.3616600146615623, 'f1-score': 0.2942460942030186, 'support': 122770}, '2': {'precision': 0.3427047689509541, 'recall': 0.07894475216588553, 'f1-score': 0.12832810993945482, 'support': 140820}, 'accuracy': 0.2954765854595039, 'macro avg': {'precision': 0.30731527850373924, 'recall': 0.2976082903683577, 'f1-score': 0.2683179368544881, 'support': 406286}, 'weighted avg': {'precision': 0.31006017718913015, 'recall': 0.2954765854595039, 'f1-score': 0.2676927035261573, 'support': 406286}}
[[64530 67745 10421]
 [67468 44401 10901]
 [62824 66879 11117]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172272
{'0': {'precision': 0.31097308488612835, 'recall': 0.031528127623845506, 'f1-score': 0.05725176291214028, 'support': 23820}, '1': {'precision': 0.33216961735362704, 'recall': 0.968692152917505, 'f1-score': 0.49470298708371435, 'support': 24850}, '2': {'precision': 0.33663366336633666, 'recall': 0.007606263982102908, 'f1-score': 0.014876394661999564, 'support': 26820}, 'accuracy': 0.3315273546165055, 'macro avg': {'precision': 0.32659212186869735, 'recall': 0.3359421815078178, 'f1-score': 0.18894371488595138, 'support': 75490}, 'weighted avg': {'precision': 0.32706727678779124, 'recall': 0.3315273546165055, 'f1-score': 0.18619805439703685, 'support': 75490}}
[[  751 22819   250]
 [  626 24072   152]
 [ 1038 25578   204]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182526
{'0': {'precision': 0.29841467205470934, 'recall': 0.2843321157073749, 'f1-score': 0.29120323559150657, 'support': 10129}, '1': {'precision': 0.3244617498854787, 'recall': 0.588142489412937, 'f1-score': 0.41820919316269595, 'support': 12043}, '2': {'precision': 0.32728243459690337, 'recall': 0.054820246825254874, 'f1-score': 0.09391037916507086, 'support': 11182}, 'accuracy': 0.31708340828686216, 'macro avg': {'precision': 0.31671961884569716, 'recall': 0.30909828398185557, 'f1-score': 0.26777426930642445, 'support': 33354}, 'weighted avg': {'precision': 0.3174973691543906, 'recall': 0.31708340828686216, 'f1-score': 0.27091793327302693, 'support': 33354}}
[[2880 6690  559]
 [4259 7083  701]
 [2512 8057  613]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1206303
{'0': {'precision': 0.37081479992293453, 'recall': 0.42831157145137805, 'f1-score': 0.39749475267417195, 'support': 206707}, '1': {'precision': 0.2360315677487035, 'recall': 0.48686755923935066, 'f1-score': 0.3179312548682818, 'support': 130783}, '2': {'precision': 0.3776053805686888, 'recall': 0.05640296213775234, 'f1-score': 0.09814586443391532, 'support': 201071}, 'accuracy': 0.3036796203215606, 'macro avg': {'precision': 0.3281505827467756, 'recall': 0.32386069760949365, 'f1-score': 0.27119062399212296, 'support': 538561}, 'weighted avg': {'precision': 0.3406195822736432, 'recall': 0.3036796203215606, 'f1-score': 0.26641223232660804, 'support': 538561}}
[[ 88535 107789  10383]
 [ 58799  63674   8310]
 [ 91424  98306  11341]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.113316
{'0': {'precision': 0.3338767824749133, 'recall': 0.3999119863578855, 'f1-score': 0.3639230605578986, 'support': 36358}, '1': {'precision': 0.33416806782814007, 'recall': 0.5186563020544143, 'f1-score': 0.40645736788286224, 'support': 36020}, '2': {'precision': 0.33718497858352425, 'recall': 0.09120056040521608, 'f1-score': 0.1435690806913371, 'support': 37116}, 'accuracy': 0.3343288216705938, 'macro avg': {'precision': 0.33507660962885916, 'recall': 0.3365896162725053, 'f1-score': 0.304649836377366, 'support': 109494}, 'weighted avg': {'precision': 0.33509400995030403, 'recall': 0.3343288216705938, 'f1-score': 0.30322044153875505, 'support': 109494}}
[[14540 18489  3329]
 [14013 18682  3325]
 [14996 18735  3385]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1246182
{'0': {'precision': 0.3076137987344356, 'recall': 0.3690009794319295, 'f1-score': 0.3355226539018145, 'support': 12252}, '1': {'precision': 0.2976899131669488, 'recall': 0.5000458673516192, 'f1-score': 0.3732027933725866, 'support': 10901}, '2': {'precision': 0.329776247848537, 'recall': 0.07507836990595611, 'f1-score': 0.12231088413661027, 'support': 12760}, 'accuracy': 0.3043466154317378, 'macro avg': {'precision': 0.31169331991664045, 'recall': 0.3147084055631682, 'f1-score': 0.27701211047033714, 'support': 35913}, 'weighted avg': {'precision': 0.31247589808911946, 'recall': 0.3043466154317378, 'f1-score': 0.2712052484543966, 'support': 35913}}
[[4521 6631 1100]
 [4603 5451  847]
 [5573 6229  958]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
5267/5267 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964074
{'0': {'precision': 0.3857251426584056, 'recall': 0.2701690755877948, 'f1-score': 0.3177677202328209, 'support': 443352}, '1': {'precision': 0.37680062006776965, 'recall': 0.7480372397859976, 'f1-score': 0.5011582661732059, 'support': 451023}, '2': {'precision': 0.3973473160377027, 'recall': 0.12456865588104378, 'f1-score': 0.18967429141817022, 'support': 453814}, 'accuracy': 0.38102447060464073, 'macro avg': {'precision': 0.38662435958795927, 'recall': 0.3809249904182787, 'f1-score': 0.33620009260806566, 'support': 1348189}, 'weighted avg': {'precision': 0.38665167450042176, 'recall': 0.38102447060464073, 'f1-score': 0.3360016346896058, 'support': 1348189}}
[[119780 276000  47572]
 [ 75473 337382  38168]
 [115279 282004  56531]]
Evaluating performance on  train set...
1060/1060 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152304
{'0': {'precision': 0.3780925171722084, 'recall': 0.06950574930997105, 'f1-score': 0.11742495752312629, 'support': 89489}, '1': {'precision': 0.3336393179275554, 'recall': 0.9076466850243593, 'f1-score': 0.4879240081505454, 'support': 89699}, '2': {'precision': 0.3803169307756464, 'recall': 0.04457235948954656, 'f1-score': 0.07979312892500923, 'support': 92075}, 'accuracy': 0.3381920866465386, 'macro avg': {'precision': 0.36401625529180337, 'recall': 0.3405749312746256, 'f1-score': 0.2283806981995603, 'support': 271263}, 'weighted avg': {'precision': 0.3641481361231542, 'recall': 0.3381920866465386, 'f1-score': 0.22716511273801823, 'support': 271263}}
[[ 6220 80052  3217]
 [ 4814 81415  3470]
 [ 5417 82554  4104]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218604
{'0': {'precision': 0.23214285714285715, 'recall': 0.0003951127591027901, 'f1-score': 0.0007888828205595, 'support': 32902}, '1': {'precision': 0.3213160522310653, 'recall': 0.997622272385252, 'f1-score': 0.48607587511548445, 'support': 33225}, '2': {'precision': 0.38341968911917096, 'recall': 0.0019850317873333512, 'f1-score': 0.003949615713065756, 'support': 37279}, 'accuracy': 0.3213836721273427, 'macro avg': {'precision': 0.31229286616436447, 'recall': 0.33333413897722936, 'f1-score': 0.1636047912163699, 'support': 103406}, 'weighted avg': {'precision': 0.3153317284467536, 'recall': 0.3213836721273427, 'f1-score': 0.1578541331977003, 'support': 103406}}
[[   13 32832    57]
 [   17 33146    62]
 [   26 37179    74]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
10110/10110 - 151s - 151s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1250092
{'0': {'precision': 0.3658080857922958, 'recall': 0.2362265609897545, 'f1-score': 0.2870718040925067, 'support': 941486}, '1': {'precision': 0.26707697999524327, 'recall': 0.738496680350569, 'f1-score': 0.3922844658773462, 'support': 684259}, '2': {'precision': 0.3969183953855412, 'recall': 0.036324395545931025, 'f1-score': 0.06655769510875101, 'support': 962356}, 'accuracy': 0.29468865395902244, 'macro avg': {'precision': 0.3432678203910268, 'recall': 0.3370158789620848, 'f1-score': 0.24863798835953466, 'support': 2588101}, 'weighted avg': {'precision': 0.35127292869345456, 'recall': 0.29468865395902244, 'f1-score': 0.23289294278649947, 'support': 2588101}}
[[222404 689845  29237]
 [155059 505323  23877]
 [230517 696882  34957]]
Evaluating performance on  train set...
1686/1686 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1146078
{'0': {'precision': 0.3439881878766112, 'recall': 0.29193026185670357, 'f1-score': 0.31582842675674977, 'support': 147638}, '1': {'precision': 0.32458675720568114, 'recall': 0.6424371451743714, 'f1-score': 0.43127494397479954, 'support': 138096}, '2': {'precision': 0.3614593134428021, 'recall': 0.08166134097672696, 'f1-score': 0.1332244477880759, 'support': 145834}, 'accuracy': 0.33303442331220107, 'macro avg': {'precision': 0.34334475284169813, 'recall': 0.33867624933593404, 'f1-score': 0.29344260617320844, 'support': 431568}, 'weighted avg': {'precision': 0.34368377271118444, 'recall': 0.33303442331220107, 'f1-score': 0.29106485200798765, 'support': 431568}}
[[43100 93601 10937]
 [39277 88718 10101]
 [42918 91007 11909]]
Evaluating performance on  val set...
705/705 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1155745
{'0': {'precision': 0.33117932148626816, 'recall': 0.36609564124611416, 'f1-score': 0.3477632570997738, 'support': 60476}, '1': {'precision': 0.30124320124320125, 'recall': 0.5681522595299592, 'f1-score': 0.39372647587130516, 'support': 54591}, '2': {'precision': 0.3772873042822109, 'recall': 0.061211685310725815, 'f1-score': 0.10533384244690516, 'support': 65347}, 'accuracy': 0.3168046825634374, 'macro avg': {'precision': 0.3365699423372268, 'recall': 0.33181986202893304, 'f1-score': 0.28227452513932805, 'support': 180414}, 'weighted avg': {'precision': 0.3388216087343598, 'recall': 0.3168046825634374, 'f1-score': 0.27386180331367993, 'support': 180414}}
[[22140 34866  3470]
 [20443 31016  3132]
 [24269 37078  4000]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
6546/6546 - 104s - 104s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1188849
{'0': {'precision': 0.3716778758741376, 'recall': 0.4470885676673458, 'f1-score': 0.4059104533875305, 'support': 621378}, '1': {'precision': 0.27087761544601213, 'recall': 0.49383654531674154, 'f1-score': 0.34985429243802446, 'support': 444637}, '2': {'precision': 0.3663265392817393, 'recall': 0.07071212324970398, 'f1-score': 0.11854204040112447, 'support': 609754}, 'accuracy': 0.322542068745752, 'macro avg': {'precision': 0.3362940102006296, 'recall': 0.33721241207793046, 'f1-score': 0.29143559540889313, 'support': 1675769}, 'weighted avg': {'precision': 0.34298506422256647, 'recall': 0.322542068745752, 'f1-score': 0.2864735366476824, 'support': 1675769}}
[[277811 298390  45177]
 [195652 219578  29407]
 [273988 292649  43117]]
Evaluating performance on  train set...
1230/1230 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1082268
{'0': {'precision': 0.3671620993961914, 'recall': 0.42125911905768204, 'f1-score': 0.3923546929554323, 'support': 108838}, '1': {'precision': 0.36249201200911535, 'recall': 0.5940621449389912, 'f1-score': 0.4502469214381723, 'support': 101215}, '2': {'precision': 0.358629589542919, 'recall': 0.08226935454606224, 'f1-score': 0.13383667730835255, 'support': 104717}, 'accuracy': 0.3640499412269276, 'macro avg': {'precision': 0.3627612336494086, 'recall': 0.36586353951424516, 'f1-score': 0.32547943056731904, 'support': 314770}, 'weighted avg': {'precision': 0.36282184546732893, 'recall': 0.3640499412269276, 'f1-score': 0.3249668569525263, 'support': 314770}}
[[45849 54594  8395]
 [34075 60128  7012]
 [44950 51152  8615]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111262
{'0': {'precision': 0.36970679059528544, 'recall': 0.30127566274666134, 'f1-score': 0.33200170229122905, 'support': 40136}, '1': {'precision': 0.3418256045873847, 'recall': 0.6339257332755383, 'f1-score': 0.44415424018789035, 'support': 34605}, '2': {'precision': 0.3729079813908525, 'recall': 0.1595120564443181, 'f1-score': 0.2234450800086887, 'support': 38693}, 'accuracy': 0.3543999153692896, 'macro avg': {'precision': 0.36148012552450753, 'recall': 0.36490448415550586, 'f1-score': 0.33320034082926936, 'support': 113434}, 'weighted avg': {'precision': 0.36229309834824724, 'recall': 0.3543999153692896, 'f1-score': 0.32918647218328645, 'support': 113434}}
[[12092 21681  6363]
 [ 8652 21937  4016]
 [11963 20558  6172]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
7633/7633 - 115s - 115s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994933
{'0': {'precision': 0.3925283865648887, 'recall': 0.34148566172887634, 'f1-score': 0.36523228988618195, 'support': 656704}, '1': {'precision': 0.3723400040551028, 'recall': 0.7615023474178404, 'f1-score': 0.500136172823661, 'support': 629415}, '2': {'precision': 0.40379616819687253, 'recall': 0.05768646246494447, 'f1-score': 0.10095102590002895, 'support': 667869}, 'accuracy': 0.3797786885078107, 'macro avg': {'precision': 0.3895548529389547, 'recall': 0.38689149053722044, 'f1-score': 0.3221064962032906, 'support': 1953988}, 'weighted avg': {'precision': 0.38987664626421875, 'recall': 0.3797786885078107, 'f1-score': 0.3183564973950947, 'support': 1953988}}
[[224255 398463  33986]
 [127215 479301  22899]
 [219839 409503  38527]]
Evaluating performance on  train set...
1586/1586 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054242
{'0': {'precision': 0.3743687155921562, 'recall': 0.2369290573372206, 'f1-score': 0.29019842966790255, 'support': 138915}, '1': {'precision': 0.35168634805286136, 'recall': 0.8064836452959228, 'f1-score': 0.48978870046250117, 'support': 133937}, '2': {'precision': 0.3519636059790177, 'recall': 0.02850847508610447, 'f1-score': 0.052744714745841706, 'support': 132978}, 'accuracy': 0.3566074464677328, 'macro avg': {'precision': 0.3593395565413451, 'recall': 0.3573070592397493, 'f1-score': 0.2775772816254152, 'support': 405830}, 'weighted avg': {'precision': 0.3595413373124665, 'recall': 0.3566074464677328, 'f1-score': 0.27826338789304694, 'support': 405830}}
[[ 32913 102176   3826]
 [ 22765 108018   3154]
 [ 32238  96949   3791]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.083684
{'0': {'precision': 0.3020365378855945, 'recall': 0.29936179686340475, 'f1-score': 0.30069321937038784, 'support': 40426}, '1': {'precision': 0.47506114206269473, 'recall': 0.7299134637873236, 'f1-score': 0.575536649536502, 'support': 64135}, '2': {'precision': 0.3717638519235422, 'recall': 0.07262371791841944, 'f1-score': 0.12151047844998024, 'support': 42314}, 'accuracy': 0.4220459574468085, 'macro avg': {'precision': 0.3829538439572771, 'recall': 0.36729965952304927, 'f1-score': 0.33258011578562335, 'support': 146875}, 'weighted avg': {'precision': 0.397678236984148, 'recall': 0.4220459574468085, 'f1-score': 0.36908569524713747, 'support': 146875}}
[[12102 25721  2603]
 [14732 46813  2590]
 [13234 26007  3073]]
testing model on single stock: results/universal/W10/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
22048/22048 - 327s - 327s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.127374
{'0': {'precision': 0.3925488973661041, 'recall': 0.2553053716932288, 'f1-score': 0.3093900802578236, 'support': 2135807}, '1': {'precision': 0.261239831422386, 'recall': 0.7105765532326946, 'f1-score': 0.38202874927879255, 'support': 1411717}, '2': {'precision': 0.37666107754425526, 'recall': 0.07457463330128059, 'f1-score': 0.12449972846383792, 'support': 2096544}, 'accuracy': 0.3020454395659301, 'macro avg': {'precision': 0.3434832687775818, 'recall': 0.3468188527424014, 'f1-score': 0.27197285266681803, 'support': 5644068}, 'weighted avg': {'precision': 0.35380366007139996, 'recall': 0.3020454395659301, 'f1-score': 0.25887943548931713, 'support': 5644068}}
[[ 545283 1428295  162229]
 [ 312070 1003133   96514]
 [ 531730 1408465  156349]]
Evaluating performance on  train set...
5429/5429 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1188791
{'0': {'precision': 0.33433734939759036, 'recall': 0.000238538340202951, 'f1-score': 0.00047673654507737306, 'support': 465334}, '1': {'precision': 0.3284868626025548, 'recall': 0.9977437119662126, 'f1-score': 0.49425146412685733, 'support': 456502}, '2': {'precision': 0.3542243767313019, 'recall': 0.0021860842807077526, 'f1-score': 0.004345351366045942, 'support': 467960}, 'accuracy': 0.3285417428169314, 'macro avg': {'precision': 0.3390161962438157, 'recall': 0.33338944486237443, 'f1-score': 0.16635785067932687, 'support': 1389796}, 'weighted avg': {'precision': 0.3391118446387454, 'recall': 0.3285417428169314, 'f1-score': 0.16396800266050596, 'support': 1389796}}
[[   111 464276    947]
 [   112 455472    918]
 [   109 466828   1023]]
Evaluating performance on  val set...
1890/1890 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106631
{'0': {'precision': 0.34328358208955223, 'recall': 0.0003033740470097871, 'f1-score': 0.0006062123588250022, 'support': 151628}, '1': {'precision': 0.3575421310180877, 'recall': 0.9977558763649824, 'f1-score': 0.5264373744047338, 'support': 172896}, '2': {'precision': 0.3438095238095238, 'recall': 0.0022684001181327487, 'f1-score': 0.004507063354828239, 'support': 159143}, 'accuracy': 0.3575083683608764, 'macro avg': {'precision': 0.34821174563905455, 'recall': 0.33344255017670826, 'f1-score': 0.17718355003946232, 'support': 483667}, 'weighted avg': {'precision': 0.3485536253604173, 'recall': 0.3575083683608764, 'f1-score': 0.18985811030337443, 'support': 483667}}
[[    46 151236    346]
 [    45 172508    343]
 [    43 158739    361]]
training model: results/universal/W10/deepLOB_L2/h1000
Epoch 1/50
8543/8543 - 387s - loss: 3.1866 - accuracy1000: 0.4304 - val_loss: 3.3441 - val_accuracy1000: 0.3648 - 387s/epoch - 45ms/step
Epoch 2/50
8543/8543 - 385s - loss: 3.1440 - accuracy1000: 0.4492 - val_loss: 3.4971 - val_accuracy1000: 0.3552 - 385s/epoch - 45ms/step
Epoch 3/50
8543/8543 - 386s - loss: 3.1187 - accuracy1000: 0.4593 - val_loss: 3.4064 - val_accuracy1000: 0.3476 - 386s/epoch - 45ms/step
Epoch 4/50
8543/8543 - 385s - loss: 3.1039 - accuracy1000: 0.4641 - val_loss: 3.3563 - val_accuracy1000: 0.3461 - 385s/epoch - 45ms/step
Epoch 5/50
8543/8543 - 391s - loss: 3.0889 - accuracy1000: 0.4695 - val_loss: 3.3586 - val_accuracy1000: 0.3527 - 391s/epoch - 46ms/step
Epoch 6/50
8543/8543 - 390s - loss: 3.0788 - accuracy1000: 0.4728 - val_loss: 3.4225 - val_accuracy1000: 0.3244 - 390s/epoch - 46ms/step
Epoch 7/50
8543/8543 - 387s - loss: 3.0704 - accuracy1000: 0.4752 - val_loss: 3.4319 - val_accuracy1000: 0.3485 - 387s/epoch - 45ms/step
Epoch 8/50
8543/8543 - 386s - loss: 3.0640 - accuracy1000: 0.4775 - val_loss: 3.4781 - val_accuracy1000: 0.3303 - 386s/epoch - 45ms/step
Epoch 9/50
8543/8543 - 385s - loss: 3.0576 - accuracy1000: 0.4796 - val_loss: 3.5518 - val_accuracy1000: 0.3217 - 385s/epoch - 45ms/step
Epoch 10/50
8543/8543 - 382s - loss: 3.0499 - accuracy1000: 0.4815 - val_loss: 3.4623 - val_accuracy1000: 0.3606 - 382s/epoch - 45ms/step
Epoch 11/50
8543/8543 - 391s - loss: 3.0448 - accuracy1000: 0.4825 - val_loss: 3.5132 - val_accuracy1000: 0.3346 - 391s/epoch - 46ms/step
testing model in sample: results/universal/W10/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 554s - 554s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1512526
{'0': {'precision': 0.351107131394039, 'recall': 0.10128556823814608, 'f1-score': 0.15721776830008166, 'support': 3391263}, '1': {'precision': 0.29308731717784003, 'recall': 0.8449042819987193, 'f1-score': 0.4352066033919007, 'support': 2795190}, '2': {'precision': 0.3499998035695344, 'recall': 0.05304829723242585, 'f1-score': 0.09213239598005331, 'support': 3358826}, 'accuracy': 0.3020691170996678, 'macro avg': {'precision': 0.33139808404713783, 'recall': 0.3330793824897637, 'f1-score': 0.2281855892240119, 'support': 9545279}, 'weighted avg': {'precision': 0.33372725952371995, 'recall': 0.3020691170996678, 'f1-score': 0.21572010973945813, 'support': 9545279}}
[[ 343486 2863127  184650]
 [ 287266 2361668  146256]
 [ 347542 2833104  178180]]
Evaluating performance on  train set...
8543/8543 - 133s - 133s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302878
{'0': {'precision': 0.3328431273796813, 'recall': 0.04547074551161469, 'f1-score': 0.08001094448217708, 'support': 726709}, '1': {'precision': 0.33193871103315936, 'recall': 0.9457236682913339, 'f1-score': 0.49140101567700367, 'support': 723225}, '2': {'precision': 0.36617362866062136, 'recall': 0.013372946825808307, 'f1-score': 0.025803528638433715, 'support': 736786}, 'accuracy': 0.3324010389990488, 'macro avg': {'precision': 0.34365182235782066, 'recall': 0.3348557868762523, 'f1-score': 0.1990718295992048, 'support': 2186720}, 'weighted avg': {'precision': 0.34377427092095103, 'recall': 0.3324010389990488, 'f1-score': 0.19780760758949312, 'support': 2186720}}
[[ 33044 684490   9175]
 [ 31374 683971   7880]
 [ 34860 692073   9853]]
Evaluating performance on  val set...
3077/3077 - 47s - 47s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1157639
{'0': {'precision': 0.30782092546921375, 'recall': 0.030518659731863487, 'f1-score': 0.05553167582894073, 'support': 241295}, '1': {'precision': 0.36752926968365257, 'recall': 0.9516450145756387, 'f1-score': 0.5302671548080702, 'support': 287809}, '2': {'precision': 0.33633042989603823, 'recall': 0.0232121595259057, 'f1-score': 0.04342715339907268, 'support': 257839}, 'accuracy': 0.36500864738615124, 'macro avg': {'precision': 0.3372268750163015, 'recall': 0.3351252779444693, 'f1-score': 0.2097419946786945, 'support': 786943}, 'weighted avg': {'precision': 0.3389991187461365, 'recall': 0.36500864738615124, 'f1-score': 0.2251908830532372, 'support': 786943}}
[[  7364 227791   6140]
 [  8247 273892   5670]
 [  8312 243542   5985]]
testing model out of sample: results/universal/W10/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 315s - 315s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1676832
{'0': {'precision': 0.3858226416704597, 'recall': 0.10478588812485513, 'f1-score': 0.16481070226391709, 'support': 2070880}, '1': {'precision': 0.2456159250624369, 'recall': 0.8873124210766273, 'f1-score': 0.38473405995152843, 'support': 1333572}, '2': {'precision': 0.3411149523561702, 'recall': 0.013387332001845992, 'f1-score': 0.025763552560773027, 'support': 2056347}, 'accuracy': 0.26146778154625355, 'macro avg': {'precision': 0.32418450636302226, 'recall': 0.33516188040110945, 'f1-score': 0.1917694382587395, 'support': 5460799}, 'weighted avg': {'precision': 0.33474764801499546, 'recall': 0.26146778154625355, 'f1-score': 0.16615747272874687, 'support': 5460799}}
[[ 216999 1822637   31244]
 [ 128347 1183295   21930]
 [ 217086 1811732   27529]]
Evaluating performance on  train set...
4055/4055 - 65s - 65s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1327057
{'0': {'precision': 0.34260017122482195, 'recall': 0.10385728749269182, 'f1-score': 0.15939491561033686, 'support': 350635}, '1': {'precision': 0.33612813227249455, 'recall': 0.8698417748980359, 'f1-score': 0.4848848871445755, 'support': 345710}, '2': {'precision': 0.3467126323565624, 'recall': 0.03714658419687221, 'f1-score': 0.06710371633429005, 'support': 341135}, 'accuracy': 0.33716408991016694, 'macro avg': {'precision': 0.3418136452846263, 'recall': 0.3369485488625333, 'f1-score': 0.2371278396964008, 'support': 1037480}, 'weighted avg': {'precision': 0.3417957758070473, 'recall': 0.33716408991016694, 'f1-score': 0.2375085947116857, 'support': 1037480}}
[[ 36416 301389  12830]
 [ 33950 300713  11047]
 [ 35927 292536  12672]]
Evaluating performance on  val set...
1545/1545 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.132697
{'0': {'precision': 0.30658245337017664, 'recall': 0.12368712325712874, 'f1-score': 0.17626299305524035, 'support': 125583}, '1': {'precision': 0.3524178102838769, 'recall': 0.8498234123633374, 'f1-score': 0.4982243171692387, 'support': 136193}, '2': {'precision': 0.40662326992352904, 'recall': 0.048329064291026, 'f1-score': 0.08639024652236962, 'support': 133129}, 'accuracy': 0.3487091832212811, 'macro avg': {'precision': 0.35520784452586085, 'recall': 0.3406131999704973, 'f1-score': 0.25362585224894957, 'support': 394905}, 'weighted avg': {'precision': 0.35611535022151763, 'recall': 0.3487091832212811, 'f1-score': 0.25700192961437035, 'support': 394905}}
[[ 15533 104555   5495]
 [ 16559 115740   3894]
 [ 18573 108122   6434]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
519/519 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.14509
{'0': {'precision': 0.5180010746910263, 'recall': 0.03616310912705856, 'f1-score': 0.06760642401290413, 'support': 53314}, '1': {'precision': 0.2988182935692559, 'recall': 0.8474477072624561, 'f1-score': 0.44183963859977304, 'support': 39298}, '2': {'precision': 0.2810940994323069, 'recall': 0.12255612780639032, 'f1-score': 0.17069136619252398, 'support': 39998}, 'accuracy': 0.3026393183017872, 'macro avg': {'precision': 0.36597115589752977, 'recall': 0.335388981398635, 'f1-score': 0.2267124762684004, 'support': 132610}, 'weighted avg': {'precision': 0.38159167774568586, 'recall': 0.3026393183017872, 'f1-score': 0.20960030369117283, 'support': 132610}}
[[ 1928 43885  7501]
 [  959 33303  5036]
 [  835 34261  4902]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1324841
{'0': {'precision': 0.33296130952380953, 'recall': 0.07730177923648299, 'f1-score': 0.1254731529510725, 'support': 11578}, '1': {'precision': 0.33214784285049526, 'recall': 0.8866116582379558, 'f1-score': 0.4832555552868922, 'support': 11271}, '2': {'precision': 0.42027114267269206, 'recall': 0.05673697054209517, 'f1-score': 0.09997696383321816, 'support': 11474}, 'accuracy': 0.33618856160592026, 'macro avg': {'precision': 0.3617934316823323, 'recall': 0.34021680267217796, 'f1-score': 0.23623522402372762, 'support': 34323}, 'weighted avg': {'precision': 0.3618814051644981, 'recall': 0.33618856160592026, 'f1-score': 0.2344386333225075, 'support': 34323}}
[[  895 10219   464]
 [  844  9993   434]
 [  949  9874   651]]
Evaluating performance on  val set...
46/46 - 1s - 956ms/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.131819
{'0': {'precision': 0.41365461847389556, 'recall': 0.044386985563456154, 'f1-score': 0.08017123954076669, 'support': 4641}, '1': {'precision': 0.3258520365752286, 'recall': 0.9375498272654796, 'f1-score': 0.48361891706648386, 'support': 3763}, '2': {'precision': 0.16806722689075632, 'recall': 0.018303843807199512, 'f1-score': 0.033012379642365884, 'support': 3278}, 'accuracy': 0.32477315528162987, 'macro avg': {'precision': 0.3025246273132935, 'recall': 0.3334135522120451, 'f1-score': 0.19893417874987215, 'support': 11682}, 'weighted avg': {'precision': 0.3164592251085288, 'recall': 0.32477315528162987, 'f1-score': 0.19689670331257936, 'support': 11682}}
[[ 206 4209  226]
 [ 164 3528   71]
 [ 128 3090   60]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
1840/1840 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1605546
{'0': {'precision': 0.33698348074313256, 'recall': 0.13476858581258538, 'f1-score': 0.19253667492558063, 'support': 160297}, '1': {'precision': 0.2875935146176433, 'recall': 0.8425918999386586, 'f1-score': 0.4288216124021563, 'support': 133678}, '2': {'precision': 0.36101249178172257, 'recall': 0.03102400108479479, 'f1-score': 0.05713780293649389, 'support': 176992}, 'accuracy': 0.2966874536857147, 'macro avg': {'precision': 0.32852982904749944, 'recall': 0.3361281622786796, 'f1-score': 0.22616536342141028, 'support': 470967}, 'weighted avg': {'precision': 0.33199500135926696, 'recall': 0.2966874536857147, 'f1-score': 0.20871950879908183, 'support': 470967}}
[[ 21603 133524   5170]
 [ 16493 112636   4549]
 [ 26011 145490   5491]]
Evaluating performance on  train set...
529/529 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1330079
{'0': {'precision': 0.35069822719619687, 'recall': 0.0790313581073541, 'f1-score': 0.12899347929037194, 'support': 44805}, '1': {'precision': 0.3355864145892588, 'recall': 0.8959864203872869, 'f1-score': 0.48828759745120587, 'support': 44773}, '2': {'precision': 0.3651977793199167, 'recall': 0.045937629574667745, 'f1-score': 0.08160970787213832, 'support': 45823}, 'accuracy': 0.33797387020775327, 'macro avg': {'precision': 0.35049414036845744, 'recall': 0.3403184693564363, 'f1-score': 0.23296359487123872, 'support': 135401}, 'weighted avg': {'precision': 0.350608211547234, 'recall': 0.33797387020775327, 'f1-score': 0.23176531254653177, 'support': 135401}}
[[ 3541 39218  2046]
 [ 3044 40116  1613]
 [ 3512 40206  2105]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1338186
{'0': {'precision': 0.3169821380965076, 'recall': 0.0688118525377626, 'f1-score': 0.11307655729909652, 'support': 17279}, '1': {'precision': 0.3362582713410875, 'recall': 0.9331090328467153, 'f1-score': 0.4943653886824375, 'support': 17536}, '2': {'precision': 0.2974588938714499, 'recall': 0.010893961789018448, 'f1-score': 0.021018166455428814, 'support': 18267}, 'accuracy': 0.33440714366451907, 'macro avg': {'precision': 0.31689976776968165, 'recall': 0.3376049490578321, 'f1-score': 0.2094867041456543, 'support': 53082}, 'weighted avg': {'precision': 0.3166316458452327, 'recall': 0.33440714366451907, 'f1-score': 0.2073580523745833, 'support': 53082}}
[[ 1189 15730   360]
 [ 1063 16363   110]
 [ 1499 16569   199]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
967/967 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1546824
{'0': {'precision': 0.43919804470263185, 'recall': 0.11838449419964672, 'f1-score': 0.18649880420558637, 'support': 104735}, '1': {'precision': 0.2529662031134753, 'recall': 0.8223319624624863, 'f1-score': 0.3869107209562944, 'support': 62977}, '2': {'precision': 0.32985944463489886, 'recall': 0.060267829180603055, 'f1-score': 0.10191501080371139, 'support': 79827}, 'accuracy': 0.27873587596297955, 'macro avg': {'precision': 0.3406745641503353, 'recall': 0.33366142861424536, 'f1-score': 0.2251081786551974, 'support': 247539}, 'weighted avg': {'precision': 0.3565585611652206, 'recall': 0.27873587596297955, 'f1-score': 0.21020929348330772, 'support': 247539}}
[[12399 87139  5197]
 [ 6612 51788  4577]
 [ 9220 65796  4811]]
Evaluating performance on  train set...
220/220 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1385357
{'0': {'precision': 0.3213718640838361, 'recall': 0.058497109826589594, 'f1-score': 0.09897794513179127, 'support': 17300}, '1': {'precision': 0.32525565176507465, 'recall': 0.9062772925764192, 'f1-score': 0.478707147593922, 'support': 18320}, '2': {'precision': 0.30772946859903383, 'recall': 0.03085492855412933, 'f1-score': 0.05608628659476117, 'support': 20645}, 'accuracy': 0.3243934950679819, 'macro avg': {'precision': 0.31811899481598155, 'recall': 0.3318764436523794, 'f1-score': 0.21125712644015815, 'support': 56265}, 'weighted avg': {'precision': 0.31763070591333126, 'recall': 0.3243934950679819, 'f1-score': 0.2068805612983113, 'support': 56265}}
[[ 1012 15528   760]
 [ 1044 16603   673]
 [ 1093 18915   637]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1223965
{'0': {'precision': 0.380146644106035, 'recall': 0.09974840905727393, 'f1-score': 0.15803048065650643, 'support': 6757}, '1': {'precision': 0.3337277406377566, 'recall': 0.8435770898758785, 'f1-score': 0.47825349724459515, 'support': 6687}, '2': {'precision': 0.420817843866171, 'recall': 0.08605747301201155, 'f1-score': 0.14289320878566017, 'support': 6577}, 'accuracy': 0.34368912641726185, 'macro avg': {'precision': 0.37823074286998754, 'recall': 0.3431276573150546, 'f1-score': 0.25972572889558726, 'support': 20021}, 'weighted avg': {'precision': 0.37800345811782443, 'recall': 0.34368912641726185, 'f1-score': 0.2600120737252839, 'support': 20021}}
[[ 674 5686  397]
 [ 664 5641  382]
 [ 435 5576  566]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1588/1588 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1389753
{'0': {'precision': 0.3449652713293467, 'recall': 0.1292182902141928, 'f1-score': 0.18801083023355852, 'support': 143749}, '1': {'precision': 0.2988739392766108, 'recall': 0.8197674886359065, 'f1-score': 0.43804409975538344, 'support': 124295}, '2': {'precision': 0.5146305461491708, 'recall': 0.042874090363275996, 'f1-score': 0.07915384050374269, 'support': 138242}, 'accuracy': 0.3110985857253265, 'macro avg': {'precision': 0.3861565855850428, 'recall': 0.33061995640445846, 'f1-score': 0.2350695901642282, 'support': 406286}, 'weighted avg': {'precision': 0.38859450001098306, 'recall': 0.3110985857253265, 'f1-score': 0.22746401656285864, 'support': 406286}}
[[ 18575 122288   2886]
 [ 19698 101893   2704]
 [ 15573 116742   5927]]
Evaluating performance on  train set...
295/295 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1339623
{'0': {'precision': 0.3235981308411215, 'recall': 0.047006915277247464, 'f1-score': 0.0820892757918133, 'support': 23571}, '1': {'precision': 0.3302642225384336, 'recall': 0.9545197967905814, 'f1-score': 0.4907342149993782, 'support': 24802}, '2': {'precision': 0.3802083333333333, 'recall': 0.005384076409632334, 'f1-score': 0.010617795716519399, 'support': 27117}, 'accuracy': 0.3302159226387601, 'macro avg': {'precision': 0.3446902289042961, 'recall': 0.335636929492487, 'f1-score': 0.19448042883590366, 'support': 75490}, 'weighted avg': {'precision': 0.3461233827587006, 'recall': 0.3302159226387601, 'f1-score': 0.1906747792627933, 'support': 75490}}
[[ 1108 22338   125]
 [ 1015 23674   113]
 [ 1301 25670   146]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1316259
{'0': {'precision': 0.2661955241460542, 'recall': 0.04373065015479876, 'f1-score': 0.07512049193950474, 'support': 10336}, '1': {'precision': 0.34300403966213733, 'recall': 0.8916854712723485, 'f1-score': 0.49543098251959017, 'support': 11522}, '2': {'precision': 0.33881385789782736, 'recall': 0.05019137091162143, 'f1-score': 0.08743086597469506, 'support': 11496}, 'accuracy': 0.33887989446543143, 'macro avg': {'precision': 0.3160044739020063, 'recall': 0.32853583077958953, 'f1-score': 0.21932744681126334, 'support': 33354}, 'weighted avg': {'precision': 0.3177577979538942, 'recall': 0.33887989446543143, 'f1-score': 0.22455796667633668, 'support': 33354}}
[[  452  9310   574]
 [  696 10274   552]
 [  550 10369   577]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
2104/2104 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.168869
{'0': {'precision': 0.34955820011236527, 'recall': 0.06583776243957577, 'f1-score': 0.11080574590286688, 'support': 207905}, '1': {'precision': 0.24107256163651153, 'recall': 0.9040051800536728, 'f1-score': 0.3806393863992839, 'support': 128184}, '2': {'precision': 0.3582416408503365, 'recall': 0.033125567979770044, 'f1-score': 0.06064359792761106, 'support': 202472}, 'accuracy': 0.25303354680342616, 'macro avg': {'precision': 0.31629080086640443, 'recall': 0.33432283682433955, 'f1-score': 0.18402957674325396, 'support': 538561}, 'weighted avg': {'precision': 0.3270018518634384, 'recall': 0.25303354680342616, 'f1-score': 0.15617094120766378, 'support': 538561}}
[[ 13688 186768   7449]
 [  7739 115879   4566]
 [ 17731 178034   6707]]
Evaluating performance on  train set...
428/428 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1338539
{'0': {'precision': 0.3252585216392187, 'recall': 0.09345768680532629, 'f1-score': 0.14519575995896736, 'support': 36348}, '1': {'precision': 0.3312730415376705, 'recall': 0.8254374965927057, 'f1-score': 0.4727979577976065, 'support': 36686}, '2': {'precision': 0.32739887419819347, 'recall': 0.0685957213384531, 'f1-score': 0.11342660831311367, 'support': 36460}, 'accuracy': 0.3304290646062798, 'macro avg': {'precision': 0.3279768124583609, 'recall': 0.32916363491216166, 'f1-score': 0.2438067753565625, 'support': 109494}, 'weighted avg': {'precision': 0.3279863965117672, 'recall': 0.3304290646062798, 'f1-score': 0.24438029026108885, 'support': 109494}}
[[ 3397 30425  2526]
 [ 3792 30282  2612]
 [ 3255 30704  2501]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1587399
{'0': {'precision': 0.2914485165794066, 'recall': 0.10963400623666503, 'f1-score': 0.15933214072748958, 'support': 12186}, '1': {'precision': 0.3014853195164076, 'recall': 0.8046464460219416, 'f1-score': 0.43862602708746895, 'support': 10847}, '2': {'precision': 0.3442622950819672, 'recall': 0.06358695652173912, 'f1-score': 0.10734648404220459, 'support': 12880}, 'accuracy': 0.3030378971403113, 'macro avg': {'precision': 0.3123987103925938, 'recall': 0.3259558029267819, 'f1-score': 0.23510155061905438, 'support': 35913}, 'weighted avg': {'precision': 0.313421358407453, 'recall': 0.3030378971403113, 'f1-score': 0.22504443229990695, 'support': 35913}}
[[ 1336  9871   979]
 [ 1538  8728   581]
 [ 1710 10351   819]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
5267/5267 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019974
{'0': {'precision': 0.3002800750865114, 'recall': 0.12973293707036604, 'f1-score': 0.18118621987406816, 'support': 385939}, '1': {'precision': 0.42764106488013215, 'recall': 0.8229719151804049, 'f1-score': 0.5628225386836372, 'support': 569774}, '2': {'precision': 0.2861952465597005, 'recall': 0.06194518900518758, 'f1-score': 0.10184636330313661, 'support': 392476}, 'accuracy': 0.4029768823213956, 'macro avg': {'precision': 0.33803879550878135, 'recall': 0.3382166804186528, 'f1-score': 0.2819517072869473, 'support': 1348189}, 'weighted avg': {'precision': 0.35000531645681027, 'recall': 0.4029768823213956, 'f1-score': 0.3193771280967806, 'support': 1348189}}
[[ 50069 311419  24451]
 [ 64680 468908  36186]
 [ 51992 316172  24312]]
Evaluating performance on  train set...
1060/1060 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1312202
{'0': {'precision': 0.3689657960701868, 'recall': 0.051119177253478525, 'f1-score': 0.08979720355410366, 'support': 89262}, '1': {'precision': 0.33577467246137743, 'recall': 0.9462808993786599, 'f1-score': 0.4956683095870846, 'support': 89484}, '2': {'precision': 0.3593563766388558, 'recall': 0.026070884269917962, 'f1-score': 0.04861482026423728, 'support': 92517}, 'accuracy': 0.33787136469035584, 'macro avg': {'precision': 0.35469894839014, 'recall': 0.3411569869673521, 'f1-score': 0.21136011113514183, 'support': 271263}, 'weighted avg': {'precision': 0.3547393473376315, 'recall': 0.33787136469035584, 'f1-score': 0.20963993734908012, 'support': 271263}}
[[ 4563 81990  2709]
 [ 3216 84677  1591]
 [ 4588 85517  2412]]
Evaluating performance on  val set...
404/404 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0822217
{'0': {'precision': 0.2525645560665016, 'recall': 0.027043405802590712, 'f1-score': 0.048855588627732725, 'support': 26402}, '1': {'precision': 0.4442750525613049, 'recall': 0.9711404425858163, 'f1-score': 0.6096492127626119, 'support': 45912}, '2': {'precision': 0.2590909090909091, 'recall': 0.0018332690081049787, 'f1-score': 0.003640776699029126, 'support': 31092}, 'accuracy': 0.4386399241823492, 'macro avg': {'precision': 0.3186435059062385, 'recall': 0.33333903913217067, 'f1-score': 0.22071519269645792, 'support': 103406}, 'weighted avg': {'precision': 0.33964586356610793, 'recall': 0.4386399241823492, 'f1-score': 0.28425138711905157, 'support': 103406}}
[[  714 25631    57]
 [ 1219 44587   106]
 [  894 30141    57]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
10110/10110 - 149s - 149s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1835892
{'0': {'precision': 0.3899041838398028, 'recall': 0.08610797569234761, 'f1-score': 0.14106303510154242, 'support': 1025027}, '1': {'precision': 0.1989866513002786, 'recall': 0.9066377267305875, 'f1-score': 0.3263473721625558, 'support': 516472}, '2': {'precision': 0.5062046359166471, 'recall': 0.004131465447228268, 'f1-score': 0.008196037697224266, 'support': 1046602}, 'accuracy': 0.2166994255633764, 'macro avg': {'precision': 0.36503182368557613, 'recall': 0.3322923892900545, 'f1-score': 0.15853548165377415, 'support': 2588101}, 'weighted avg': {'precision': 0.3988361095562939, 'recall': 0.2166994255633764, 'f1-score': 0.12430762521345132, 'support': 2588101}}
[[ 88263 934189   2575]
 [ 46576 468253   1643]
 [ 91532 950746   4324]]
Evaluating performance on  train set...
1686/1686 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1352547
{'0': {'precision': 0.35041945378617095, 'recall': 0.1297890688092859, 'f1-score': 0.18942027248391863, 'support': 146114}, '1': {'precision': 0.33907700396864243, 'recall': 0.847569245396457, 'f1-score': 0.48437559304427735, 'support': 143042}, '2': {'precision': 0.3621148916922149, 'recall': 0.050592646687076935, 'f1-score': 0.08878127522195318, 'support': 142412}, 'accuracy': 0.3415614688762837, 'macro avg': {'precision': 0.35053711648234276, 'recall': 0.34265032029760656, 'f1-score': 0.2541923802500497, 'support': 431568}, 'weighted avg': {'precision': 0.35051937777561554, 'recall': 0.3415614688762837, 'f1-score': 0.25397278352626607, 'support': 431568}}
[[ 18964 119890   7260]
 [ 16372 121238   5432]
 [ 18782 116425   7205]]
Evaluating performance on  val set...
705/705 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1377692
{'0': {'precision': 0.3182773109243697, 'recall': 0.10005561541937502, 'f1-score': 0.15224922645650965, 'support': 57538}, '1': {'precision': 0.34102661523501643, 'recall': 0.9007211620233357, 'f1-score': 0.4947379730102158, 'support': 58794}, '2': {'precision': 0.45986645830373635, 'recall': 0.05051340470022783, 'f1-score': 0.09102796642341925, 'support': 64082}, 'accuracy': 0.3433824426042325, 'macro avg': {'precision': 0.3730567948210408, 'recall': 0.3504300607143129, 'f1-score': 0.2460050552967149, 'support': 180414}, 'weighted avg': {'precision': 0.375982579584256, 'recall': 0.3433824426042325, 'f1-score': 0.24211532653432016, 'support': 180414}}
[[ 5757 49371  2410]
 [ 4445 52957  1392]
 [ 7886 52959  3237]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
6546/6546 - 100s - 100s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297215
{'0': {'precision': 0.32795232549849085, 'recall': 0.10139797193034021, 'f1-score': 0.1549024230076277, 'support': 544360}, '1': {'precision': 0.3602942181458502, 'recall': 0.8308750951803492, 'f1-score': 0.5026313042919764, 'support': 602803}, '2': {'precision': 0.26731778823208563, 'recall': 0.05933720010745243, 'f1-score': 0.09711707862315813, 'support': 528606}, 'accuracy': 0.35053578386997253, 'macro avg': {'precision': 0.3185214439588089, 'recall': 0.3305367557393806, 'f1-score': 0.2515502686409207, 'support': 1675769}, 'weighted avg': {'precision': 0.32045965181092456, 'recall': 0.35053578386997253, 'f1-score': 0.26175863831603374, 'support': 1675769}}
[[ 55197 443720  45443]
 [ 61422 500854  40527]
 [ 51689 445551  31366]]
Evaluating performance on  train set...
1230/1230 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1347954
{'0': {'precision': 0.3173602132094889, 'recall': 0.1129412427574679, 'f1-score': 0.16659509924784952, 'support': 106489}, '1': {'precision': 0.3390779933593838, 'recall': 0.8460563023078874, 'f1-score': 0.48412922367434474, 'support': 106461}, '2': {'precision': 0.36884735202492214, 'recall': 0.0406992732272638, 'f1-score': 0.07330945115209411, 'support': 101820}, 'accuracy': 0.33752581249801444, 'macro avg': {'precision': 0.3417618528645983, 'recall': 0.33323227276420636, 'f1-score': 0.24134459135809613, 'support': 314770}, 'weighted avg': {'precision': 0.3413603309676151, 'recall': 0.33752581249801444, 'f1-score': 0.2438154688239187, 'support': 314770}}
[[12027 91127  3335]
 [12633 90072  3756]
 [13237 84439  4144]]
Evaluating performance on  val set...
444/444 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173289
{'0': {'precision': 0.3066619668664082, 'recall': 0.023985443317159242, 'f1-score': 0.044491037868521315, 'support': 36272}, '1': {'precision': 0.3812284176578557, 'recall': 0.8672564284029253, 'f1-score': 0.5296384604856544, 'support': 42390}, '2': {'precision': 0.3376164925162384, 'recall': 0.1375244449557115, 'f1-score': 0.19543894065718492, 'support': 34772}, 'accuracy': 0.37391787294814605, 'macro avg': {'precision': 0.3418356256801674, 'recall': 0.3429221055585987, 'f1-score': 0.2565228130037869, 'support': 113434}, 'weighted avg': {'precision': 0.3440160460220877, 'recall': 0.37391787294814605, 'f1-score': 0.2720608998191506, 'support': 113434}}
[[  870 30598  4804]
 [ 1049 36763  4578]
 [  918 29072  4782]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
7633/7633 - 114s - 114s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1495351
{'0': {'precision': 0.3805269368075425, 'recall': 0.148466169239843, 'f1-score': 0.2135958898312258, 'support': 679899}, '1': {'precision': 0.3083072926505008, 'recall': 0.8763928876433799, 'f1-score': 0.4561463279603092, 'support': 586641}, '2': {'precision': 0.31921839515518546, 'recall': 0.009814560519486565, 'f1-score': 0.01904361374233683, 'support': 687448}, 'accuracy': 0.3182296923010786, 'macro avg': {'precision': 0.33601754153774294, 'recall': 0.3448912058009031, 'f1-score': 0.22959527717795727, 'support': 1953988}, 'weighted avg': {'precision': 0.3372751672932156, 'recall': 0.3182296923010786, 'f1-score': 0.21796923218631142, 'support': 1953988}}
[[100942 570598   8359]
 [ 66483 514128   6030]
 [ 97844 582857   6747]]
Evaluating performance on  train set...
1586/1586 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1290079
{'0': {'precision': 0.3381687810259239, 'recall': 0.08802900319465881, 'f1-score': 0.13969411295605363, 'support': 139295}, '1': {'precision': 0.33627852063370034, 'recall': 0.8979771392540563, 'f1-score': 0.4893158423574863, 'support': 136391}, '2': {'precision': 0.3, 'recall': 0.01235554462748955, 'f1-score': 0.023733616719801627, 'support': 130144}, 'accuracy': 0.33596826257299856, 'macro avg': {'precision': 0.32481576721987476, 'recall': 0.33278722902540153, 'f1-score': 0.21758119067778056, 'support': 405830}, 'weighted avg': {'precision': 0.3252933101563637, 'recall': 0.33596826257299856, 'f1-score': 0.2200077774772079, 'support': 405830}}
[[ 12262 125139   1894]
 [ 12057 122476   1858]
 [ 11941 116595   1608]]
Evaluating performance on  val set...
574/574 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1215494
{'0': {'precision': 0.2948371662293564, 'recall': 0.17185848271518858, 'f1-score': 0.21714480583145063, 'support': 44461}, '1': {'precision': 0.385289463726738, 'recall': 0.7985989804285052, 'f1-score': 0.519798591532955, 'support': 56102}, '2': {'precision': 0.386951871657754, 'recall': 0.039061150457764725, 'f1-score': 0.07095926412614981, 'support': 46312}, 'accuracy': 0.36938212765957446, 'macro avg': {'precision': 0.3556928338712828, 'recall': 0.33650620453381946, 'f1-score': 0.2693008871635185, 'support': 146875}, 'weighted avg': {'precision': 0.35843254346849207, 'recall': 0.36938212765957446, 'f1-score': 0.2866551913835862, 'support': 146875}}
[[ 7641 35347  1473]
 [ 9906 44803  1393]
 [ 8369 36134  1809]]
testing model on single stock: results/universal/W10/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
22048/22048 - 342s - 342s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1694859
{'0': {'precision': 0.3763556967352823, 'recall': 0.09162332550426117, 'f1-score': 0.1473696848304839, 'support': 2156918}, '1': {'precision': 0.24339305385964763, 'recall': 0.8631162797514362, 'f1-score': 0.37971032106723784, 'support': 1364640}, '2': {'precision': 0.39683095822041714, 'recall': 0.05229468883538829, 'f1-score': 0.0924113401958858, 'support': 2122510}, 'accuracy': 0.2633673088276045, 'macro avg': {'precision': 0.338859902938449, 'recall': 0.3356780980303619, 'f1-score': 0.20649711536453585, 'support': 5644068}, 'weighted avg': {'precision': 0.3519075161465664, 'recall': 0.2633673088276045, 'f1-score': 0.18287806101655096, 'support': 5644068}}
[[ 197624 1852638  106656]
 [ 124743 1177843   62054]
 [ 202732 1808782  110996]]
Evaluating performance on  train set...
5429/5429 - 85s - 85s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1283419
{'0': {'precision': 0.32759587351424085, 'recall': 0.02526254804553571, 'f1-score': 0.04690780204474024, 'support': 462582}, '1': {'precision': 0.3293624509991837, 'recall': 0.9723555565265837, 'f1-score': 0.4920534362876308, 'support': 457705}, '2': {'precision': 0.34413096482062, 'recall': 0.002104326008660111, 'f1-score': 0.00418307294974385, 'support': 469509}, 'accuracy': 0.3293476164847215, 'macro avg': {'precision': 0.3336964297780149, 'recall': 0.33324081019359314, 'f1-score': 0.181048103760705, 'support': 1389796}, 'weighted avg': {'precision': 0.33376364600165087, 'recall': 0.3293476164847215, 'f1-score': 0.17907521200165447, 'support': 1389796}}
[[ 11686 449984    912]
 [ 11682 445052    971]
 [ 12304 456217    988]]
Evaluating performance on  val set...
1890/1890 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1193795
{'0': {'precision': 0.32095531587057013, 'recall': 0.02758830774936095, 'f1-score': 0.050809215420828606, 'support': 151006}, '1': {'precision': 0.3528353467694889, 'recall': 0.9722497638589842, 'f1-score': 0.5177691301882282, 'support': 170449}, '2': {'precision': 0.3528245787908821, 'recall': 0.002194658841516041, 'f1-score': 0.004362183787625367, 'support': 162212}, 'accuracy': 0.3519797712062225, 'macro avg': {'precision': 0.34220508047698034, 'recall': 0.33401091014995377, 'f1-score': 0.19098017646556073, 'support': 483667}, 'weighted avg': {'precision': 0.3428784494800978, 'recall': 0.3519797712062225, 'f1-score': 0.1997930919658551, 'support': 483667}}
[[  4166 146525    315]
 [  4392 165719    338]
 [  4422 157434    356]]
training model: results/universal/W10/deepOF_L2/h300
Epoch 1/50
8543/8543 - 231s - loss: 3.2681 - accuracy300: 0.3803 - val_loss: 3.2808 - val_accuracy300: 0.3600 - 231s/epoch - 27ms/step
Epoch 2/50
8543/8543 - 231s - loss: 3.2584 - accuracy300: 0.3843 - val_loss: 3.2802 - val_accuracy300: 0.3596 - 231s/epoch - 27ms/step
Epoch 3/50
8543/8543 - 228s - loss: 3.2530 - accuracy300: 0.3875 - val_loss: 3.2797 - val_accuracy300: 0.3617 - 228s/epoch - 27ms/step
Epoch 4/50
8543/8543 - 228s - loss: 3.2479 - accuracy300: 0.3903 - val_loss: 3.2813 - val_accuracy300: 0.3612 - 228s/epoch - 27ms/step
Epoch 5/50
8543/8543 - 227s - loss: 3.2438 - accuracy300: 0.3931 - val_loss: 3.2807 - val_accuracy300: 0.3611 - 227s/epoch - 27ms/step
Epoch 6/50
8543/8543 - 229s - loss: 3.2397 - accuracy300: 0.3961 - val_loss: 3.2809 - val_accuracy300: 0.3602 - 229s/epoch - 27ms/step
Epoch 7/50
8543/8543 - 231s - loss: 3.2367 - accuracy300: 0.3981 - val_loss: 3.2819 - val_accuracy300: 0.3596 - 231s/epoch - 27ms/step
Epoch 8/50
8543/8543 - 230s - loss: 3.2335 - accuracy300: 0.3999 - val_loss: 3.2853 - val_accuracy300: 0.3572 - 230s/epoch - 27ms/step
Epoch 9/50
8543/8543 - 227s - loss: 3.2308 - accuracy300: 0.4019 - val_loss: 3.2845 - val_accuracy300: 0.3576 - 227s/epoch - 27ms/step
Epoch 10/50
8543/8543 - 229s - loss: 3.2280 - accuracy300: 0.4035 - val_loss: 3.2863 - val_accuracy300: 0.3570 - 229s/epoch - 27ms/step
Epoch 11/50
8543/8543 - 228s - loss: 3.2258 - accuracy300: 0.4052 - val_loss: 3.2847 - val_accuracy300: 0.3583 - 228s/epoch - 27ms/step
Epoch 12/50
8543/8543 - 227s - loss: 3.2236 - accuracy300: 0.4063 - val_loss: 3.2883 - val_accuracy300: 0.3570 - 227s/epoch - 27ms/step
Epoch 13/50
8543/8543 - 229s - loss: 3.2216 - accuracy300: 0.4074 - val_loss: 3.2870 - val_accuracy300: 0.3577 - 229s/epoch - 27ms/step
testing model in sample: results/universal/W10/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 342s - 342s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1044382
{'0': {'precision': 0.40926930769393594, 'recall': 0.240257638622791, 'f1-score': 0.30277443602588, 'support': 3460506}, '1': {'precision': 0.2728215803486796, 'recall': 0.5687811134416895, 'f1-score': 0.36876251320625014, 'support': 2636923}, '2': {'precision': 0.4013015829875704, 'recall': 0.23468418495718316, 'f1-score': 0.2961674291228682, 'support': 3447825}, 'accuracy': 0.32900067405225675, 'macro avg': {'precision': 0.3611308236767286, 'recall': 0.3479076456738879, 'f1-score': 0.3225681261183328, 'support': 9545254}, 'weighted avg': {'precision': 0.36869694880540765, 'recall': 0.32900067405225675, 'f1-score': 0.31861745862824514, 'support': 9545254}}
[[ 831413 1983757  645336]
 [ 575263 1499832  561828]
 [ 624781 2013894  809150]]
Evaluating performance on  train set...
8543/8543 - 84s - 84s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958049
{'0': {'precision': 0.3854105653961335, 'recall': 0.2881224717821028, 'f1-score': 0.3297401571216051, 'support': 728527}, '1': {'precision': 0.3308580864639289, 'recall': 0.5749664930701733, 'f1-score': 0.4200202069498194, 'support': 724477}, '2': {'precision': 0.3903248878841827, 'recall': 0.20379769608618142, 'f1-score': 0.26778080827798145, 'support': 733708}, 'accuracy': 0.3548629174761011, 'macro avg': {'precision': 0.36886451324808167, 'recall': 0.35562888697948586, 'f1-score': 0.3391803907831353, 'support': 2186712}, 'weighted avg': {'precision': 0.3689857510834553, 'recall': 0.3548629174761011, 'f1-score': 0.3388614999129913, 'support': 2186712}}
[[209905 411105 107517]
 [181886 416550 126041]
 [152836 431344 149528]]
Evaluating performance on  val set...
3077/3077 - 30s - 30s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933275
{'0': {'precision': 0.3684464474024553, 'recall': 0.29502013374702774, 'f1-score': 0.3276702196603901, 'support': 251071}, '1': {'precision': 0.3501724543298477, 'recall': 0.5577933481926967, 'f1-score': 0.43024498324241706, 'support': 275023}, '2': {'precision': 0.3864346696613403, 'recall': 0.21898660900834588, 'f1-score': 0.27955415805121553, 'support': 260847}, 'accuracy': 0.3616522712630299, 'macro avg': {'precision': 0.3683511904645478, 'recall': 0.3572666969826901, 'f1-score': 0.34582312031800755, 'support': 786941}, 'weighted avg': {'precision': 0.36802253431971543, 'recall': 0.3616522712630299, 'f1-score': 0.34756941017410264, 'support': 786941}}
[[ 74071 136763  40237]
 [ 71158 153406  50459]
 [ 55807 147918  57122]]
testing model out of sample: results/universal/W10/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 200s - 200s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021762
{'0': {'precision': 0.4235531479389276, 'recall': 0.33142157202293715, 'f1-score': 0.371865829182396, 'support': 2006701}, '1': {'precision': 0.26310404602311094, 'recall': 0.494572369776713, 'f1-score': 0.34348169964384834, 'support': 1455884}, '2': {'precision': 0.4291629833775328, 'recall': 0.24782140227976432, 'f1-score': 0.31420450633857533, 'support': 1998189}, 'accuracy': 0.3443281117292164, 'macro avg': {'precision': 0.37194005911319045, 'recall': 0.3579384480264715, 'f1-score': 0.34318401172160656, 'support': 5460774}, 'weighted avg': {'precision': 0.3828289266420243, 'recall': 0.3443281117292164, 'f1-score': 0.343199156457784, 'support': 5460774}}
[[ 665064  997266  344371]
 [ 421549  720040  314295]
 [ 483589 1019406  495194]]
Evaluating performance on  train set...
4055/4055 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947388
{'0': {'precision': 0.40014625347352, 'recall': 0.3478950089997937, 'f1-score': 0.3721957368852236, 'support': 353897}, '1': {'precision': 0.31469926930836223, 'recall': 0.47326097503998277, 'f1-score': 0.3780263892892643, 'support': 333894}, '2': {'precision': 0.3962637101981472, 'recall': 0.25798730267673303, 'f1-score': 0.312513098889907, 'support': 349680}, 'accuracy': 0.3579386797317708, 'macro avg': {'precision': 0.37036974432667646, 'recall': 0.35971442890550315, 'f1-score': 0.35424507502146496, 'support': 1037471}, 'weighted avg': {'precision': 0.3713378500932101, 'recall': 0.3579386797317708, 'f1-score': 0.3539561860925676, 'support': 1037471}}
[[123119 168791  61987]
 [100416 158019  75459]
 [ 84150 175317  90213]]
Evaluating performance on  val set...
1545/1545 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951353
{'0': {'precision': 0.3855608905844049, 'recall': 0.357170058493785, 'f1-score': 0.37082285587765496, 'support': 131296}, '1': {'precision': 0.31200569776341525, 'recall': 0.4595104462657242, 'f1-score': 0.37165749161899764, 'support': 127749}, '2': {'precision': 0.40507206371207405, 'recall': 0.25382746945384954, 'f1-score': 0.31209133320964916, 'support': 135860}, 'accuracy': 0.3547232878793634, 'macro avg': {'precision': 0.3675462173532981, 'recall': 0.35683599140445293, 'f1-score': 0.35152389356876723, 'support': 394905}, 'weighted avg': {'precision': 0.3684787712226255, 'recall': 0.3547232878793634, 'f1-score': 0.35088732508327536, 'support': 394905}}
[[46895 62080 22321]
 [40720 58702 28327]
 [34013 67362 34485]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
518/518 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1131839
{'0': {'precision': 0.4304470806771647, 'recall': 0.1898236925883864, 'f1-score': 0.2634625322997416, 'support': 53713}, '1': {'precision': 0.2555596265085657, 'recall': 0.6832091656525482, 'f1-score': 0.371978021978022, 'support': 33691}, '2': {'precision': 0.37641254177940475, 'recall': 0.1569655538594279, 'f1-score': 0.2215456674473068, 'support': 45201}, 'accuracy': 0.3039779797141888, 'macro avg': {'precision': 0.35413974965504497, 'recall': 0.3433328040334542, 'f1-score': 0.2856620739083568, 'support': 132605}, 'weighted avg': {'precision': 0.3675946361154067, 'recall': 0.3039779797141888, 'f1-score': 0.27674492100722653, 'support': 132605}}
[[10196 36311  7206]
 [ 6125 23018  4548]
 [ 7366 30740  7095]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051106
{'0': {'precision': 0.35355450236966823, 'recall': 0.19308083858165817, 'f1-score': 0.24976284805535406, 'support': 11591}, '1': {'precision': 0.32776188773686094, 'recall': 0.6421504246563349, 'f1-score': 0.4340030180193508, 'support': 11421}, '2': {'precision': 0.3410507569011576, 'recall': 0.1693341586347157, 'f1-score': 0.2263058378633893, 'support': 11309}, 'accuracy': 0.3346930450744442, 'macro avg': {'precision': 0.34078904900256224, 'recall': 0.3348551406242362, 'f1-score': 0.3033572346460314, 'support': 34321}, 'weighted avg': {'precision': 0.34085142526746615, 'recall': 0.3346930450744442, 'f1-score': 0.3033432114741902, 'support': 34321}}
[[2238 7599 1754]
 [2141 7334 1946]
 [1951 7443 1915]]
Evaluating performance on  val set...
46/46 - 1s - 670ms/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1115866
{'0': {'precision': 0.44218989280245025, 'recall': 0.2485474499677211, 'f1-score': 0.31822565091610416, 'support': 4647}, '1': {'precision': 0.2733679032043611, 'recall': 0.6690530426293524, 'f1-score': 0.3881442325844818, 'support': 3073}, '2': {'precision': 0.3750806972240155, 'recall': 0.14664310954063603, 'f1-score': 0.2108510252222827, 'support': 3962}, 'accuracy': 0.3246019517205958, 'macro avg': {'precision': 0.3635461644102756, 'recall': 0.3547478673792365, 'f1-score': 0.3057403029076229, 'support': 11682}, 'weighted avg': {'precision': 0.3750201781203165, 'recall': 0.3246019517205958, 'f1-score': 0.30020147136363057, 'support': 11682}}
[[1155 2888  604]
 [ 653 2056  364]
 [ 804 2577  581]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
1840/1840 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952408
{'0': {'precision': 0.43304512986634663, 'recall': 0.44124334368265766, 'f1-score': 0.4371057993983893, 'support': 168449}, '1': {'precision': 0.25657687660550926, 'recall': 0.40613297761206024, 'f1-score': 0.31447949723103724, 'support': 124442}, '2': {'precision': 0.4648154300119203, 'recall': 0.26715186639037236, 'f1-score': 0.3392946932603943, 'support': 178071}, 'accuracy': 0.3661420666635525, 'macro avg': {'precision': 0.3848124788279254, 'recall': 0.37150939589503, 'f1-score': 0.363626663296607, 'support': 470962}, 'weighted avg': {'precision': 0.3984294002425921, 'recall': 0.3661420666635525, 'f1-score': 0.3677218920440623, 'support': 470962}}
[[74327 68181 25941]
 [45069 50540 28833]
 [52242 78257 47572]]
Evaluating performance on  train set...
529/529 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.077165
{'0': {'precision': 0.38286984686739367, 'recall': 0.49580561898143555, 'f1-score': 0.43207994030431823, 'support': 40292}, '1': {'precision': 0.3960063716008647, 'recall': 0.3848833351763795, 'f1-score': 0.39036563481381786, 'support': 54258}, '2': {'precision': 0.4069797953293099, 'recall': 0.30375284584689954, 'f1-score': 0.34786996930064346, 'support': 40849}, 'accuracy': 0.3934150178361731, 'macro avg': {'precision': 0.39528533793252274, 'recall': 0.39481393333490483, 'f1-score': 0.39010518147292655, 'support': 135399}, 'weighted avg': {'precision': 0.3954078186671078, 'recall': 0.3934150178361731, 'f1-score': 0.38995830061102155, 'support': 135399}}
[[19977 14779  5536]
 [20831 20883 12544]
 [11369 17072 12408]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0868319
{'0': {'precision': 0.3881979904463845, 'recall': 0.5364479599385421, 'f1-score': 0.45043839740067376, 'support': 17573}, '1': {'precision': 0.310745154196287, 'recall': 0.34380127878685, 'f1-score': 0.32643851071831514, 'support': 17673}, '2': {'precision': 0.4586262844780963, 'recall': 0.23772146221125812, 'f1-score': 0.31313467006388246, 'support': 17836}, 'accuracy': 0.37193398892279866, 'macro avg': {'precision': 0.3858564763735893, 'recall': 0.3726569003122167, 'f1-score': 0.3633371927276238, 'support': 53082}, 'weighted avg': {'precision': 0.38607552100856446, 'recall': 0.37193398892279866, 'f1-score': 0.36301894677491864, 'support': 53082}}
[[9427 6165 1981]
 [8573 6076 3024]
 [6284 7312 4240]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
967/967 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.117238
{'0': {'precision': 0.4004947681610002, 'recall': 0.12384348994676177, 'f1-score': 0.189185774745752, 'support': 96735}, '1': {'precision': 0.2756457712813273, 'recall': 0.6976990790505796, 'f1-score': 0.3951688873713959, 'support': 68842}, '2': {'precision': 0.3414184266346952, 'recall': 0.18068011274204765, 'f1-score': 0.23630604249615017, 'support': 81957}, 'accuracy': 0.3022574676610082, 'macro avg': {'precision': 0.33918632202567417, 'recall': 0.334074227246463, 'f1-score': 0.27355356820443266, 'support': 247534}, 'weighted avg': {'precision': 0.34621303568925155, 'recall': 0.3022574676610082, 'f1-score': 0.2620732375726524, 'support': 247534}}
[[11980 68342 16413]
 [ 8660 48031 12151]
 [ 9273 57876 14808]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055973
{'0': {'precision': 0.31278701908358, 'recall': 0.17694261632605934, 'f1-score': 0.22602411415508278, 'support': 17322}, '1': {'precision': 0.3388796008810339, 'recall': 0.6592669075890553, 'f1-score': 0.44765393581406765, 'support': 19370}, '2': {'precision': 0.3395603143866044, 'recall': 0.1523327712197864, 'f1-score': 0.21031466064625368, 'support': 19569}, 'accuracy': 0.33444126481932424, 'macro avg': {'precision': 0.33040897811707276, 'recall': 0.3295140983783003, 'f1-score': 0.2946642368718014, 'support': 56261}, 'weighted avg': {'precision': 0.33108281768654774, 'recall': 0.33444126481932424, 'f1-score': 0.29686450714170337, 'support': 56261}}
[[ 3065 11588  2669]
 [ 3471 12770  3129]
 [ 3263 13325  2981]]
Evaluating performance on  val set...
79/79 - 1s - 973ms/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034786
{'0': {'precision': 0.35292389068469, 'recall': 0.1772955417773841, 'f1-score': 0.2360224034587796, 'support': 6774}, '1': {'precision': 0.33857174183173744, 'recall': 0.6796771826852531, 'f1-score': 0.4519906323185012, 'support': 6815}, '2': {'precision': 0.3316309159005788, 'recall': 0.15143034825870647, 'f1-score': 0.2079197352972569, 'support': 6432}, 'accuracy': 0.3399930073422906, 'macro avg': {'precision': 0.3410421828056687, 'recall': 0.33613435757378124, 'f1-score': 0.2986442570248459, 'support': 20021}, 'weighted avg': {'precision': 0.34119788757574065, 'recall': 0.3399930073422906, 'f1-score': 0.30050804943371034, 'support': 20021}}
[[1201 4588  985]
 [1205 4632  978]
 [ 997 4461  974]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1588/1588 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1191181
{'0': {'precision': 0.34173272466586463, 'recall': 0.14185930370177802, 'f1-score': 0.20049117243246378, 'support': 146173}, '1': {'precision': 0.28400651934552196, 'recall': 0.7278169436868557, 'f1-score': 0.4085786986550345, 'support': 116598}, '2': {'precision': 0.3323788969849783, 'recall': 0.10838965925719463, 'f1-score': 0.16347098665853954, 'support': 143510}, 'accuracy': 0.2982000142758337, 'macro avg': {'precision': 0.31937271366545494, 'recall': 0.3260219688819428, 'f1-score': 0.25751361924867927, 'support': 406281}, 'weighted avg': {'precision': 0.32186192613375186, 'recall': 0.2982000142758337, 'f1-score': 0.24713333025447226, 'support': 406281}}
[[ 20736 106837  18600]
 [ 19092  84862  12644]
 [ 20851 107104  15555]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076549
{'0': {'precision': 0.3207579233579743, 'recall': 0.15630822740259204, 'f1-score': 0.21018930957683743, 'support': 24151}, '1': {'precision': 0.3290733076881005, 'recall': 0.7242887524577666, 'f1-score': 0.452539738254024, 'support': 24921}, '2': {'precision': 0.35926928281461434, 'recall': 0.12060872198667474, 'f1-score': 0.1805917696406303, 'support': 26416}, 'accuracy': 0.3313241839762611, 'macro avg': {'precision': 0.3363668379535631, 'recall': 0.3337352339490111, 'f1-score': 0.2811069391571639, 'support': 75488}, 'weighted avg': {'precision': 0.3369796243475048, 'recall': 0.3313241839762611, 'f1-score': 0.2798396701389045, 'support': 75488}}
[[ 3775 17427  2949]
 [ 4138 18050  2733]
 [ 3856 19374  3186]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1083634
{'0': {'precision': 0.2634266886326194, 'recall': 0.1575679936933386, 'f1-score': 0.19718830928597852, 'support': 10148}, '1': {'precision': 0.33696179101846546, 'recall': 0.6348389239455331, 'f1-score': 0.4402475888872895, 'support': 12044}, '2': {'precision': 0.32201175702155455, 'recall': 0.13250313563877442, 'f1-score': 0.1877499206601079, 'support': 11162}, 'accuracy': 0.32152065719254064, 'macro avg': {'precision': 0.30746674555754644, 'recall': 0.30830335109254875, 'f1-score': 0.2750619396111253, 'support': 33354}, 'weighted avg': {'precision': 0.3095855693213651, 'recall': 0.32152065719254064, 'f1-score': 0.2817974916831789, 'support': 33354}}
[[1599 7159 1390]
 [2674 7646 1724]
 [1797 7886 1479]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
2104/2104 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1229087
{'0': {'precision': 0.40705144002497246, 'recall': 0.11747246442778639, 'f1-score': 0.18232662192393737, 'support': 210909}, '1': {'precision': 0.23178736656586088, 'recall': 0.7358453077314344, 'f1-score': 0.35252973697436757, 'support': 125824}, '2': {'precision': 0.36854079063406653, 'recall': 0.1428727152009434, 'f1-score': 0.20591721892138937, 'support': 201823}, 'accuracy': 0.2714629490712201, 'macro avg': {'precision': 0.3357931990749667, 'recall': 0.3320634957867214, 'f1-score': 0.2469245259398981, 'support': 538556}, 'weighted avg': {'precision': 0.35167231218879563, 'recall': 0.2714629490712201, 'f1-score': 0.23093208134862503, 'support': 538556}}
[[ 24776 155292  30841]
 [ 14672  92587  18565]
 [ 21419 151569  28835]]
Evaluating performance on  train set...
428/428 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077752
{'0': {'precision': 0.3344653040302428, 'recall': 0.14230412736492012, 'f1-score': 0.19965958423377766, 'support': 36682}, '1': {'precision': 0.3224710221285564, 'recall': 0.6837210601279079, 'f1-score': 0.43824679799869326, 'support': 35807}, '2': {'precision': 0.34620950684626517, 'recall': 0.16808993622311103, 'f1-score': 0.22630525741313448, 'support': 37004}, 'accuracy': 0.32807576740065575, 'macro avg': {'precision': 0.3343819443350215, 'recall': 0.33137170790531306, 'f1-score': 0.2880705465485351, 'support': 109493}, 'weighted avg': {'precision': 0.3345119118403348, 'recall': 0.32807576740065575, 'f1-score': 0.2866887902433788, 'support': 109493}}
[[ 5220 25497  5965]
 [ 5544 24482  5781]
 [ 4843 25941  6220]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1111599
{'0': {'precision': 0.35261599210266537, 'recall': 0.14770095931194177, 'f1-score': 0.2081949058693245, 'support': 12092}, '1': {'precision': 0.30332076682441644, 'recall': 0.6841248303934871, 'f1-score': 0.42029509016643973, 'support': 11055}, '2': {'precision': 0.35492052756171794, 'recall': 0.16442111859627134, 'f1-score': 0.2247323340471092, 'support': 12766}, 'accuracy': 0.3187703617074597, 'macro avg': {'precision': 0.3369524288295999, 'recall': 0.33208230276723344, 'f1-score': 0.2844074433609578, 'support': 35913}, 'weighted avg': {'precision': 0.3382607721048713, 'recall': 0.3187703617074597, 'f1-score': 0.27936368445986853, 'support': 35913}}
[[1786 8431 1875]
 [1552 7563 1940]
 [1727 8940 2099]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/EXC
Evaluating performance on  test set...
5267/5267 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0818514
{'0': {'precision': 0.4375480605668001, 'recall': 0.4090723913389206, 'f1-score': 0.4228313432751797, 'support': 459019}, '1': {'precision': 0.3213731112587756, 'recall': 0.42671707956814975, 'f1-score': 0.3666279739251435, 'support': 417089}, '2': {'precision': 0.45207129753853736, 'recall': 0.34975300587193586, 'f1-score': 0.39438389310479083, 'support': 472076}, 'accuracy': 0.3937600505568973, 'macro avg': {'precision': 0.4036641564547043, 'recall': 0.39518082559300205, 'f1-score': 0.39461440343503806, 'support': 1348184}, 'weighted avg': {'precision': 0.4066923154939726, 'recall': 0.3937600505568973, 'f1-score': 0.39548257960087874, 'support': 1348184}}
[[187772 183267  87980]
 [126970 177979 112140]
 [114404 192562 165110]]
Evaluating performance on  train set...
1060/1060 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.077349
{'0': {'precision': 0.42536829062014436, 'recall': 0.4797098716825446, 'f1-score': 0.4509077262278932, 'support': 90167}, '1': {'precision': 0.3273668872085696, 'recall': 0.3718490684202286, 'f1-score': 0.3481930612715068, 'support': 89418}, '2': {'precision': 0.4573579578873074, 'recall': 0.3392781177394548, 'f1-score': 0.38956695995240626, 'support': 91677}, 'accuracy': 0.3966939711422905, 'macro avg': {'precision': 0.4033643785720071, 'recall': 0.39694568594740937, 'f1-score': 0.39622258248393544, 'support': 271262}, 'weighted avg': {'precision': 0.4038747796816256, 'recall': 0.3966939711422905, 'f1-score': 0.39631815105367796, 'support': 271262}}
[[43254 32430 14483]
 [33747 33250 22421]
 [24685 35888 31104]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.072963
{'0': {'precision': 0.3968055446989239, 'recall': 0.4813819699077001, 'f1-score': 0.43502106691423265, 'support': 31636}, '1': {'precision': 0.3709365947859672, 'recall': 0.36963784578377656, 'f1-score': 0.3702860814736476, 'support': 37415}, '2': {'precision': 0.45305122012759974, 'recall': 0.36585649832629896, 'f1-score': 0.40481174917066576, 'support': 34355}, 'accuracy': 0.402568516333675, 'macro avg': {'precision': 0.4069311198708303, 'recall': 0.4056254380059252, 'f1-score': 0.40337296585284865, 'support': 103406}, 'weighted avg': {'precision': 0.406132212574665, 'recall': 0.402568516333675, 'f1-score': 0.40156168746488025, 'support': 103406}}
[[15229 10878  5529]
 [13940 13830  9645]
 [ 9210 12576 12569]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/AAL
Evaluating performance on  test set...
10110/10110 - 95s - 95s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974373
{'0': {'precision': 0.4410318827925088, 'recall': 0.4150901499178191, 'f1-score': 0.4276679803866752, 'support': 963728}, '1': {'precision': 0.23842442551628104, 'recall': 0.3871840290336242, 'f1-score': 0.29511790967670487, 'support': 646974}, '2': {'precision': 0.45327529758127966, 'recall': 0.292361115374148, 'f1-score': 0.3554549355956239, 'support': 977394}, 'accuracy': 0.36176556047380004, 'macro avg': {'precision': 0.37757720196335653, 'recall': 0.36487843144186377, 'f1-score': 0.3594136085530013, 'support': 2588096}, 'weighted avg': {'precision': 0.3950076561371706, 'recall': 0.36176556047380004, 'f1-score': 0.36726177978669083, 'support': 2588096}}
[[400034 386289 177405]
 [229217 250498 167259]
 [277790 413852 285752]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0895864
{'0': {'precision': 0.4150919784757853, 'recall': 0.42324869210156946, 'f1-score': 0.41913065453626486, 'support': 148903}, '1': {'precision': 0.2957663162751628, 'recall': 0.3663681927428337, 'f1-score': 0.3273031968342602, 'support': 136472}, '2': {'precision': 0.41322455912113326, 'recall': 0.31287151739847185, 'f1-score': 0.35611318947831466, 'support': 146191}, 'accuracy': 0.36787188981523106, 'macro avg': {'precision': 0.3746942846240271, 'recall': 0.3674961340809584, 'f1-score': 0.3675156802829466, 'support': 431566}, 'weighted avg': {'precision': 0.37672562970243595, 'recall': 0.36787188981523106, 'f1-score': 0.36874563105945074, 'support': 431566}}
[[63023 58080 27800]
 [49324 49999 37149]
 [39482 60970 45739]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950626
{'0': {'precision': 0.41152760983474407, 'recall': 0.4097636935722083, 'f1-score': 0.41064375749093046, 'support': 62292}, '1': {'precision': 0.26211421692484754, 'recall': 0.3814198814198814, 'f1-score': 0.31070792921491913, 'support': 51948}, '2': {'precision': 0.44062529208337226, 'recall': 0.28496086076102395, 'f1-score': 0.3460952555749289, 'support': 66174}, 'accuracy': 0.35582604454199784, 'macro avg': {'precision': 0.3714223729476546, 'recall': 0.35871481191770455, 'f1-score': 0.3558156474269261, 'support': 180414}, 'weighted avg': {'precision': 0.37917858531468135, 'recall': 0.35582604454199784, 'f1-score': 0.3581927338837174, 'support': 180414}}
[[25525 25993 10774]
 [18969 19814 13165]
 [17531 29786 18857]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/WBA
Evaluating performance on  test set...
6546/6546 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939213
{'0': {'precision': 0.3932814572503054, 'recall': 0.3147590124398165, 'f1-score': 0.34966612331968816, 'support': 571793}, '1': {'precision': 0.3264849581297598, 'recall': 0.439365389451586, 'f1-score': 0.37460632153994117, 'support': 548746}, '2': {'precision': 0.38939005093159157, 'recall': 0.3363969561889324, 'f1-score': 0.3609588670464824, 'support': 555225}, 'accuracy': 0.3627318643914059, 'macro avg': {'precision': 0.36971882210388557, 'recall': 0.36350711936011165, 'f1-score': 0.3617437706353706, 'support': 1675764}, 'weighted avg': {'precision': 0.3701189368836483, 'recall': 0.3627318643914059, 'f1-score': 0.36157463051299243, 'support': 1675764}}
[[179977 251795 140021]
 [154780 241100 152866]
 [122872 245577 186776]]
Evaluating performance on  train set...
1230/1230 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940595
{'0': {'precision': 0.4055488315799274, 'recall': 0.35636112424099187, 'f1-score': 0.37936723743353284, 'support': 110012}, '1': {'precision': 0.3149337457567139, 'recall': 0.4858512025719572, 'f1-score': 0.38215238542068414, 'support': 98913}, '2': {'precision': 0.4004121822761621, 'recall': 0.2478104362121255, 'f1-score': 0.3061488899782898, 'support': 105843}, 'accuracy': 0.3605512631525441, 'macro avg': {'precision': 0.37363158653760115, 'recall': 0.3633409210083582, 'f1-score': 0.35588950427750227, 'support': 314768}, 'weighted avg': {'precision': 0.3753466243787826, 'recall': 0.3605512631525441, 'f1-score': 0.3556222499924582, 'support': 314768}}
[[39204 52174 18634]
 [30214 48057 20642]
 [27251 52363 26229]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0883194
{'0': {'precision': 0.3995413909207013, 'recall': 0.3628766509371787, 'f1-score': 0.3803274159010845, 'support': 37933}, '1': {'precision': 0.35333810834244356, 'recall': 0.478886192361732, 'f1-score': 0.406642154470222, 'support': 39145}, '2': {'precision': 0.3913445961582967, 'recall': 0.2790889585740221, 'f1-score': 0.32581888246628127, 'support': 36354}, 'accuracy': 0.3760579025319134, 'macro avg': {'precision': 0.38140803180714716, 'recall': 0.3736172672909776, 'f1-score': 0.3709294842791959, 'support': 113432}, 'weighted avg': {'precision': 0.38096979054939195, 'recall': 0.3760579025319134, 'f1-score': 0.3719390177136246, 'support': 113432}}
[[13765 17163  7005]
 [11624 18746  8775]
 [ 9063 17145 10146]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
7633/7633 - 71s - 71s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001691
{'0': {'precision': 0.39697588362893965, 'recall': 0.3195010093659773, 'f1-score': 0.3540496469696945, 'support': 681616}, '1': {'precision': 0.2989654514593738, 'recall': 0.5263912166503316, 'f1-score': 0.38134492349966115, 'support': 580553}, '2': {'precision': 0.4139475167533037, 'recall': 0.22929284460852195, 'f1-score': 0.2951158208855261, 'support': 691814}, 'accuracy': 0.34903220754735326, 'macro avg': {'precision': 0.3699629506138724, 'recall': 0.35839502354161024, 'f1-score': 0.3435034637849606, 'support': 1953983}, 'weighted avg': {'precision': 0.3738646093604126, 'recall': 0.34903220754735326, 'f1-score': 0.3412937062663766, 'support': 1953983}}
[[217777 351076 112763]
 [163138 305598 111817]
 [167675 365511 158628]]
Evaluating performance on  train set...
1586/1586 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943359
{'0': {'precision': 0.39933363915111425, 'recall': 0.355956642443633, 'f1-score': 0.37639955092999966, 'support': 139399}, '1': {'precision': 0.3220905237969704, 'recall': 0.48563719195254695, 'f1-score': 0.38730659969031567, 'support': 130824}, '2': {'precision': 0.39655601807378943, 'recall': 0.24658019128806036, 'f1-score': 0.30408133570986867, 'support': 135607}, 'accuracy': 0.36121282310326985, 'macro avg': {'precision': 0.3726600603406247, 'recall': 0.3627246752280801, 'f1-score': 0.3559291621100613, 'support': 405830}, 'weighted avg': {'precision': 0.37350529185169506, 'recall': 0.36121282310326985, 'f1-score': 0.355750627823436, 'support': 405830}}
[[49620 66211 23568]
 [39976 63533 27315]
 [34661 67508 33438]]
Evaluating performance on  val set...
574/574 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0886451
{'0': {'precision': 0.3580902404759937, 'recall': 0.3810204216218593, 'f1-score': 0.3691996378933916, 'support': 45491}, '1': {'precision': 0.3715238152441588, 'recall': 0.4510189944948777, 'f1-score': 0.4074299734879049, 'support': 54858}, '2': {'precision': 0.3779137254901961, 'recall': 0.25890899711988996, 'f1-score': 0.3072919988265456, 'support': 46526}, 'accuracy': 0.36848340425531917, 'macro avg': {'precision': 0.3691759270701162, 'recall': 0.36364947107887563, 'f1-score': 0.3613072034026141, 'support': 146875}, 'weighted avg': {'precision': 0.36938723798001266, 'recall': 0.36848340425531917, 'f1-score': 0.36386806298152596, 'support': 146875}}
[[17333 20191  7967]
 [18254 24742 11862]
 [12817 21663 12046]]
testing model on single stock: results/universal/W10/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
22048/22048 - 207s - 207s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126648
{'0': {'precision': 0.40422731113943833, 'recall': 0.17436664094650206, 'f1-score': 0.24363807526198006, 'support': 2115072}, '1': {'precision': 0.2548711520836703, 'recall': 0.6611813030052138, 'f1-score': 0.36791788395298847, 'support': 1430048}, '2': {'precision': 0.3857991408245344, 'recall': 0.18783359052627918, 'f1-score': 0.25265656536850667, 'support': 2098943}, 'accuracy': 0.3027200440533708, 'macro avg': {'precision': 0.3482992013492143, 'recall': 0.3411271781593317, 'f1-score': 0.2880708415278251, 'support': 5644063}, 'weighted avg': {'precision': 0.35953146780270406, 'recall': 0.3027200440533708, 'f1-score': 0.2784809514911473, 'support': 5644063}}
[[ 368798 1373875  372399]
 [ 229268  945521  255259]
 [ 314287 1390404  394252]]
Evaluating performance on  train set...
5429/5429 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009487
{'0': {'precision': 0.3668903328095582, 'recall': 0.22347247820135588, 'f1-score': 0.2777610322732759, 'support': 463905}, '1': {'precision': 0.33009801876489886, 'recall': 0.6475741136668512, 'f1-score': 0.4372896083131131, 'support': 456967}, '2': {'precision': 0.3632110831712293, 'recall': 0.16325494804050986, 'f1-score': 0.22526052202979874, 'support': 468923}, 'accuracy': 0.34260016765062473, 'macro avg': {'precision': 0.3533998115818955, 'recall': 0.34476717996957235, 'f1-score': 0.3134370542053959, 'support': 1389795}, 'weighted avg': {'precision': 0.35355156115604097, 'recall': 0.34260016765062473, 'f1-score': 0.3125003989009399, 'support': 1389795}}
[[103670 293931  66304]
 [ 93135 295920  67912]
 [ 85759 306610  76554]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986887
{'0': {'precision': 0.3481379027713744, 'recall': 0.2209635780753149, 'f1-score': 0.27034122823068907, 'support': 153781}, '1': {'precision': 0.3502672138265608, 'recall': 0.6358076635890628, 'f1-score': 0.451695066886992, 'support': 168746}, '2': {'precision': 0.35660100560480484, 'recall': 0.17649249100161352, 'f1-score': 0.23612143150693465, 'support': 161140}, 'accuracy': 0.35088190842046285, 'macro avg': {'precision': 0.3516687074009133, 'recall': 0.3444212442219971, 'f1-score': 0.3193859088748719, 'support': 483667}, 'weighted avg': {'precision': 0.3517003891802001, 'recall': 0.35088190842046285, 'f1-score': 0.3222127778998431, 'support': 483667}}
[[ 33980  95762  24039]
 [ 34182 107290  27274]
 [ 29443 103257  28440]]
training model: results/universal/W10/deepOF_L2/h500
Epoch 1/50
8543/8543 - 232s - loss: 3.2789 - accuracy500: 0.3719 - val_loss: 3.3063 - val_accuracy500: 0.3463 - 232s/epoch - 27ms/step
Epoch 2/50
8543/8543 - 228s - loss: 3.2738 - accuracy500: 0.3726 - val_loss: 3.3105 - val_accuracy500: 0.3428 - 228s/epoch - 27ms/step
Epoch 3/50
8543/8543 - 229s - loss: 3.2708 - accuracy500: 0.3755 - val_loss: 3.3096 - val_accuracy500: 0.3440 - 229s/epoch - 27ms/step
Epoch 4/50
8543/8543 - 230s - loss: 3.2664 - accuracy500: 0.3797 - val_loss: 3.3097 - val_accuracy500: 0.3450 - 230s/epoch - 27ms/step
Epoch 5/50
8543/8543 - 229s - loss: 3.2618 - accuracy500: 0.3836 - val_loss: 3.3079 - val_accuracy500: 0.3465 - 229s/epoch - 27ms/step
Epoch 6/50
8543/8543 - 227s - loss: 3.2586 - accuracy500: 0.3863 - val_loss: 3.3026 - val_accuracy500: 0.3501 - 227s/epoch - 27ms/step
Epoch 7/50
8543/8543 - 231s - loss: 3.2557 - accuracy500: 0.3888 - val_loss: 3.3006 - val_accuracy500: 0.3508 - 231s/epoch - 27ms/step
Epoch 8/50
8543/8543 - 229s - loss: 3.2528 - accuracy500: 0.3912 - val_loss: 3.3033 - val_accuracy500: 0.3513 - 229s/epoch - 27ms/step
Epoch 9/50
8543/8543 - 229s - loss: 3.2505 - accuracy500: 0.3930 - val_loss: 3.3094 - val_accuracy500: 0.3471 - 229s/epoch - 27ms/step
Epoch 10/50
8543/8543 - 229s - loss: 3.2488 - accuracy500: 0.3942 - val_loss: 3.3079 - val_accuracy500: 0.3473 - 229s/epoch - 27ms/step
Epoch 11/50
8543/8543 - 230s - loss: 3.2466 - accuracy500: 0.3961 - val_loss: 3.3070 - val_accuracy500: 0.3480 - 230s/epoch - 27ms/step
Epoch 12/50
8543/8543 - 228s - loss: 3.2448 - accuracy500: 0.3974 - val_loss: 3.3110 - val_accuracy500: 0.3468 - 228s/epoch - 27ms/step
Epoch 13/50
8543/8543 - 231s - loss: 3.2423 - accuracy500: 0.3992 - val_loss: 3.3160 - val_accuracy500: 0.3462 - 231s/epoch - 27ms/step
Epoch 14/50
8543/8543 - 228s - loss: 3.2402 - accuracy500: 0.4009 - val_loss: 3.3037 - val_accuracy500: 0.3488 - 228s/epoch - 27ms/step
Epoch 15/50
8543/8543 - 230s - loss: 3.2382 - accuracy500: 0.4022 - val_loss: 3.3087 - val_accuracy500: 0.3485 - 230s/epoch - 27ms/step
Epoch 16/50
8543/8543 - 229s - loss: 3.2359 - accuracy500: 0.4038 - val_loss: 3.3100 - val_accuracy500: 0.3493 - 229s/epoch - 27ms/step
Epoch 17/50
8543/8543 - 227s - loss: 3.2346 - accuracy500: 0.4051 - val_loss: 3.3162 - val_accuracy500: 0.3468 - 227s/epoch - 27ms/step
testing model in sample: results/universal/W10/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 331s - 331s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0901066
{'0': {'precision': 0.38375758155650636, 'recall': 0.5148835229104319, 'f1-score': 0.4397538785021622, 'support': 3520907}, '1': {'precision': 0.2745428262669642, 'recall': 0.05412828261466793, 'f1-score': 0.09042797671248799, 'support': 2529805}, '2': {'precision': 0.3825301866804981, 'recall': 0.473164723732037, 'f1-score': 0.423047485493589, 'support': 3494542}, 'accuracy': 0.3774949309887406, 'macro avg': {'precision': 0.3469435315013229, 'recall': 0.3473921764190456, 'f1-score': 0.3177431135694131, 'support': 9545254}, 'weighted avg': {'precision': 0.3543627412568081, 'recall': 0.3774949309887406, 'f1-score': 0.34105481768995205, 'support': 9545254}}
[[1812857  177821 1530229]
 [1254075  136934 1138796]
 [1657032  184016 1653494]]
Evaluating performance on  train set...
8543/8543 - 80s - 80s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971788
{'0': {'precision': 0.3542738927698641, 'recall': 0.5601318182252906, 'f1-score': 0.43403070939041216, 'support': 731917}, '1': {'precision': 0.3382995610721697, 'recall': 0.04933363268846474, 'f1-score': 0.08610999549697566, 'support': 717097}, '2': {'precision': 0.3610393036423415, 'recall': 0.45267168949895487, 'f1-score': 0.401696113074205, 'support': 737698}, 'accuracy': 0.3563715752234405, 'macro avg': {'precision': 0.3512042524947918, 'recall': 0.3540457134709034, 'f1-score': 0.3072789393205309, 'support': 2186712}, 'weighted avg': {'precision': 0.3513177123182927, 'recall': 0.3563715752234405, 'f1-score': 0.3090274775043133, 'support': 2186712}}
[[409970  33299 288648]
 [379376  35377 302344]
 [367866  35897 333935]]
Evaluating performance on  val set...
3077/3077 - 29s - 29s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992879
{'0': {'precision': 0.3411900139508112, 'recall': 0.5510314212224222, 'f1-score': 0.42143443518079193, 'support': 253873}, '1': {'precision': 0.35949536974902696, 'recall': 0.050068974283246914, 'f1-score': 0.08789614958030623, 'support': 267491}, '2': {'precision': 0.3595123559648369, 'recall': 0.45981767999487905, 'f1-score': 0.40352514907038567, 'support': 265577}, 'accuracy': 0.3499652451708578, 'macro avg': {'precision': 0.35339924655489163, 'recall': 0.3536393585001827, 'f1-score': 0.3042852446104946, 'support': 786941}, 'weighted avg': {'precision': 0.353595658786802, 'recall': 0.3499652451708578, 'f1-score': 0.30201660839212174, 'support': 786941}}
[[139892  11672 102309]
 [138850  13393 115248]
 [131270  12190 122117]]
testing model out of sample: results/universal/W10/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 198s - 198s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917387
{'0': {'precision': 0.38132621644710835, 'recall': 0.595327176266539, 'f1-score': 0.46488111620254213, 'support': 1959158}, '1': {'precision': 0.297135377334743, 'recall': 0.07639506422129975, 'f1-score': 0.12154123845620798, 'support': 1545126}, '2': {'precision': 0.39070604472203474, 'recall': 0.4003680059698746, 'f1-score': 0.39547802107506935, 'support': 1956490}, 'accuracy': 0.37864522501755243, 'macro avg': {'precision': 0.35638921283462865, 'recall': 0.35736341548590445, 'f1-score': 0.3273001252446065, 'support': 5460774}, 'weighted avg': {'precision': 0.36086503012943216, 'recall': 0.37864522501755243, 'f1-score': 0.3428673076236426, 'support': 5460774}}
[[1166340  135942  656876]
 [ 862405  118040  564681]
 [1029896  143278  783316]]
Evaluating performance on  train set...
4055/4055 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953393
{'0': {'precision': 0.3650489819406014, 'recall': 0.600999012900371, 'f1-score': 0.454209478158904, 'support': 352548}, '1': {'precision': 0.3282190207485456, 'recall': 0.0780127533686044, 'f1-score': 0.12606236709173338, 'support': 337009}, '2': {'precision': 0.36945385474504644, 'recall': 0.40028857706214754, 'f1-score': 0.38425361963951915, 'support': 347914}, 'accuracy': 0.36380583168107833, 'macro avg': {'precision': 0.35424061914473115, 'recall': 0.35976678111037436, 'f1-score': 0.3215084882967188, 'support': 1037471}, 'weighted avg': {'precision': 0.3545624127020513, 'recall': 0.36380583168107833, 'f1-score': 0.3241555756261591, 'support': 1037471}}
[[211881  25972 114695]
 [187728  26291 122990]
 [180809  27839 139266]]
Evaluating performance on  val set...
1545/1545 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997247
{'0': {'precision': 0.3355428550758713, 'recall': 0.5948077555044364, 'f1-score': 0.4290500596946755, 'support': 124763}, '1': {'precision': 0.32671972092009155, 'recall': 0.06460861879405869, 'f1-score': 0.10788336933045356, 'support': 139161}, '2': {'precision': 0.36802259577902097, 'recall': 0.41084584787106526, 'f1-score': 0.3882569813458007, 'support': 130981}, 'accuracy': 0.3469543307884175, 'macro avg': {'precision': 0.34342839059166125, 'recall': 0.3567540740565201, 'f1-score': 0.3083968034569766, 'support': 394905}, 'weighted avg': {'precision': 0.3432064520037066, 'recall': 0.3469543307884175, 'f1-score': 0.30234364677767156, 'support': 394905}}
[[74210  8742 41811]
 [79572  8991 50598]
 [67382  9786 53813]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
518/518 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0952857
{'0': {'precision': 0.39992325839183696, 'recall': 0.5324591776882178, 'f1-score': 0.45677138706509657, 'support': 52851}, '1': {'precision': 0.26394236740777544, 'recall': 0.11805555555555555, 'f1-score': 0.1631415300756209, 'support': 36000}, '2': {'precision': 0.3430218696490886, 'recall': 0.36170407277048955, 'f1-score': 0.35211533968917913, 'support': 43754}, 'accuracy': 0.3636137400550507, 'macro avg': {'precision': 0.33562916514956703, 'recall': 0.337406268671421, 'f1-score': 0.3240094189432989, 'support': 132605}, 'weighted avg': {'precision': 0.3442317276164029, 'recall': 0.3636137400550507, 'f1-score': 0.34252384324316665, 'support': 132605}}
[[28141  6678 18032]
 [19471  4250 12279]
 [22754  5174 15826]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1031964
{'0': {'precision': 0.34177671068427373, 'recall': 0.48674987177295265, 'f1-score': 0.40157980111432406, 'support': 11698}, '1': {'precision': 0.3068349106203996, 'recall': 0.12900088417329797, 'f1-score': 0.18163709928415814, 'support': 11310}, '2': {'precision': 0.3257399659073299, 'recall': 0.3716078847343764, 'f1-score': 0.3471654486147239, 'support': 11313}, 'accuracy': 0.3309052766527782, 'macro avg': {'precision': 0.3247838624040011, 'recall': 0.32911954689354234, 'f1-score': 0.3101274496710687, 'support': 34321}, 'weighted avg': {'precision': 0.3249760506690066, 'recall': 0.3309052766527782, 'f1-score': 0.31116455891487904, 'support': 34321}}
[[5694 1707 4297]
 [5446 1459 4405]
 [5520 1589 4204]]
Evaluating performance on  val set...
46/46 - 1s - 684ms/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982058
{'0': {'precision': 0.4012918184829414, 'recall': 0.5277717272925289, 'f1-score': 0.4559224762442375, 'support': 4591}, '1': {'precision': 0.28887523048555624, 'recall': 0.13954869358669833, 'f1-score': 0.1881881881881882, 'support': 3368}, '2': {'precision': 0.309932785660941, 'recall': 0.33440773569701854, 'f1-score': 0.3217054263565891, 'support': 3723}, 'accuracy': 0.35422016777948984, 'macro avg': {'precision': 0.33336661154314623, 'recall': 0.3339093855254152, 'f1-score': 0.3219386969296716, 'support': 11682}, 'weighted avg': {'precision': 0.33976564594643216, 'recall': 0.35422016777948984, 'f1-score': 0.33595850099132796, 'support': 11682}}
[[2423  603 1565]
 [1691  470 1207]
 [1924  554 1245]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
1840/1840 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0839844
{'0': {'precision': 0.4130998392951049, 'recall': 0.6322066139888791, 'f1-score': 0.4996897317903699, 'support': 177684}, '1': {'precision': 0.13069236541727555, 'recall': 0.033203222990397255, 'f1-score': 0.05295331978428203, 'support': 99659}, '2': {'precision': 0.4504939095995763, 'recall': 0.40418553964228715, 'f1-score': 0.4260851811017191, 'support': 193619}, 'accuracy': 0.4117104989362199, 'macro avg': {'precision': 0.3314287047706523, 'recall': 0.35653179220718784, 'f1-score': 0.326242744225457, 'support': 470962}, 'weighted avg': {'precision': 0.3687135747113187, 'recall': 0.4117104989362199, 'f1-score': 0.37489719314839753, 'support': 470962}}
[[112333  10183  55168]
 [ 56060   3309  40290]
 [103534  11827  78258]]
Evaluating performance on  train set...
529/529 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0911671
{'0': {'precision': 0.39274814707164657, 'recall': 0.6076993996087338, 'f1-score': 0.4771320874639171, 'support': 44471}, '1': {'precision': 0.1859809027777778, 'recall': 0.019154262214474096, 'f1-score': 0.034731509625126646, 'support': 44742}, '2': {'precision': 0.3900066149303819, 'recall': 0.5233837093491535, 'f1-score': 0.44695702016326605, 'support': 46186}, 'accuracy': 0.384456310607907, 'macro avg': {'precision': 0.32291188825993544, 'recall': 0.3834124570574538, 'f1-score': 0.31960687241743657, 'support': 135399}, 'weighted avg': {'precision': 0.32348766178244404, 'recall': 0.384456310607907, 'f1-score': 0.32064974777151883, 'support': 135399}}
[[27025  1691 15755]
 [21832   857 22053]
 [19953  2060 24173]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0877656
{'0': {'precision': 0.39515039901780236, 'recall': 0.672974385781495, 'f1-score': 0.4979307677431832, 'support': 19130}, '1': {'precision': 0.1463298379408961, 'recall': 0.021064910113901467, 'f1-score': 0.036828214971209215, 'support': 14574}, '2': {'precision': 0.43240599869593566, 'recall': 0.4106718959644958, 'f1-score': 0.42125880048700437, 'support': 19378}, 'accuracy': 0.3982329226479786, 'macro avg': {'precision': 0.32462874521821133, 'recall': 0.36823706395329747, 'f1-score': 0.3186725944004656, 'support': 53082}, 'weighted avg': {'precision': 0.3404355833256287, 'recall': 0.3982329226479786, 'f1-score': 0.3433424329858458, 'support': 53082}}
[[12874   842  5414]
 [ 9235   307  5032]
 [10471   949  7958]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
967/967 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094912
{'0': {'precision': 0.4103841072028896, 'recall': 0.5175555358357736, 'f1-score': 0.4577809949068583, 'support': 101421}, '1': {'precision': 0.26596654465843395, 'recall': 0.12022762065286303, 'f1-score': 0.1655981768226449, 'support': 64669}, '2': {'precision': 0.32938026860189834, 'recall': 0.3655763469377732, 'f1-score': 0.34653569059230205, 'support': 81444}, 'accuracy': 0.3637480103743324, 'macro avg': {'precision': 0.3352436401544073, 'recall': 0.33445316780880335, 'f1-score': 0.3233049541072684, 'support': 247534}, 'weighted avg': {'precision': 0.3460025839244449, 'recall': 0.3637480103743324, 'f1-score': 0.34484526394754483, 'support': 247534}}
[[52491 11862 37068]
 [33342  7775 23552]
 [42074  9596 29774]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1008366
{'0': {'precision': 0.3132697092821821, 'recall': 0.556731038343129, 'f1-score': 0.40093521989760955, 'support': 17865}, '1': {'precision': 0.33338834791219674, 'recall': 0.1144735350787714, 'f1-score': 0.17042817970892216, 'support': 17646}, '2': {'precision': 0.3696959843927817, 'recall': 0.3287710843373494, 'f1-score': 0.34803458918960284, 'support': 20750}, 'accuracy': 0.333943584365724, 'macro avg': {'precision': 0.33878468052905353, 'recall': 0.3333252192530833, 'f1-score': 0.3064659962653782, 'support': 56261}, 'weighted avg': {'precision': 0.34039078259780353, 'recall': 0.333943584365724, 'f1-score': 0.30912712337673864, 'support': 56261}}
[[ 9946  1935  5984]
 [ 9979  2020  5647]
 [11824  2104  6822]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985059
{'0': {'precision': 0.34675896790434235, 'recall': 0.552183249821045, 'f1-score': 0.42599955820631763, 'support': 6985}, '1': {'precision': 0.3489473684210526, 'recall': 0.1067804799484619, 'f1-score': 0.16352201257861634, 'support': 6209}, '2': {'precision': 0.3455272935124321, 'recall': 0.3541819247107075, 'f1-score': 0.34980108499095836, 'support': 6827}, 'accuracy': 0.3465361370560911, 'macro avg': {'precision': 0.347077876612609, 'recall': 0.3377152181600715, 'f1-score': 0.31310755192529743, 'support': 20021}, 'weighted avg': {'precision': 0.3470176531715459, 'recall': 0.3465361370560911, 'f1-score': 0.3186158082715664, 'support': 20021}}
[[3857  643 2485]
 [3451  663 2095]
 [3815  594 2418]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1588/1588 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006279
{'0': {'precision': 0.34186812143211387, 'recall': 0.4540943971407548, 'f1-score': 0.39006961981500937, 'support': 142695}, '1': {'precision': 0.2792983757717072, 'recall': 0.0858597377209416, 'f1-score': 0.13134302321959243, 'support': 122770}, '2': {'precision': 0.3458844035262176, 'recall': 0.43968014998295646, 'f1-score': 0.38718271016640715, 'support': 140816}, 'accuracy': 0.33782529825416396, 'macro avg': {'precision': 0.32235030024334627, 'recall': 0.32654476161488427, 'f1-score': 0.30286511773366964, 'support': 406281}, 'weighted avg': {'precision': 0.3243528280874465, 'recall': 0.33782529825416396, 'f1-score': 0.3108870163137457, 'support': 406281}}
[[64797 14063 63835]
 [58976 10541 53253]
 [65765 13137 61914]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032718
{'0': {'precision': 0.3086736902871987, 'recall': 0.4491012934654796, 'f1-score': 0.3658757719349265, 'support': 23812}, '1': {'precision': 0.30639516385618837, 'recall': 0.07751438805489597, 'f1-score': 0.12372723476696754, 'support': 24847}, '2': {'precision': 0.3596955754261076, 'recall': 0.46330463304633046, 'f1-score': 0.4049783338220441, 'support': 26829}, 'accuracy': 0.3318408223823654, 'macro avg': {'precision': 0.3249214765231649, 'recall': 0.32997343818890196, 'f1-score': 0.2981937801746461, 'support': 75488}, 'weighted avg': {'precision': 0.32605726926876494, 'recall': 0.3318408223823654, 'f1-score': 0.3000695236551628, 'support': 75488}}
[[10694  2019 11099]
 [11893  1926 11028]
 [12058  2341 12430]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065122
{'0': {'precision': 0.3088923556942278, 'recall': 0.43009478672985785, 'f1-score': 0.35955427156417663, 'support': 10128}, '1': {'precision': 0.32881085395051873, 'recall': 0.06843285441408521, 'f1-score': 0.11328796315391491, 'support': 12041}, '2': {'precision': 0.3144631553803893, 'recall': 0.4708091193562807, 'f1-score': 0.37707207045934626, 'support': 11185}, 'accuracy': 0.31318582478863105, 'macro avg': {'precision': 0.31738878834171197, 'recall': 0.3231122535000746, 'f1-score': 0.28330476839247926, 'support': 33354}, 'weighted avg': {'precision': 0.3179511801828563, 'recall': 0.31318582478863105, 'f1-score': 0.2765250685023103, 'support': 33354}}
[[4356  808 4964]
 [4701  824 6516]
 [5045  874 5266]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
2104/2104 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919734
{'0': {'precision': 0.3866908938833488, 'recall': 0.5188965864230978, 'f1-score': 0.443143460351431, 'support': 206704}, '1': {'precision': 0.25560507133727156, 'recall': 0.1131492625188289, 'f1-score': 0.15686066664193304, 'support': 130783}, '2': {'precision': 0.3751770886623903, 'recall': 0.3793175477075034, 'f1-score': 0.3772359573347315, 'support': 201069}, 'accuracy': 0.3682532550004085, 'macro avg': {'precision': 0.33915768462767026, 'recall': 0.3371211322164767, 'f1-score': 0.32574669477603185, 'support': 538556}, 'weighted avg': {'precision': 0.35055933758833674, 'recall': 0.3682532550004085, 'f1-score': 0.34901605608191394, 'support': 538556}}
[[107258  21313  78133]
 [ 67099  14798  48886]
 [103017  21783  76269]]
Evaluating performance on  train set...
428/428 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102569
{'0': {'precision': 0.3301432913590968, 'recall': 0.5227578999477462, 'f1-score': 0.40470107307102704, 'support': 36361}, '1': {'precision': 0.33025924043279353, 'recall': 0.126098649735215, 'f1-score': 0.18251133673100844, 'support': 36067}, '2': {'precision': 0.341127742679634, 'recall': 0.3510859301227573, 'f1-score': 0.3460352071477955, 'support': 37065}, 'accuracy': 0.33398482094745785, 'macro avg': {'precision': 0.3338434248238415, 'recall': 0.33331415993523955, 'f1-score': 0.311082538983277, 'support': 109493}, 'weighted avg': {'precision': 0.333899884232036, 'recall': 0.33398482094745785, 'f1-score': 0.3116524988149556, 'support': 109493}}
[[19008  4609 12744]
 [19129  4548 12390]
 [19438  4614 13013]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994084
{'0': {'precision': 0.34022745305474744, 'recall': 0.5255760745219807, 'f1-score': 0.4130623254021771, 'support': 12238}, '1': {'precision': 0.30344655344655347, 'recall': 0.11149857759016243, 'f1-score': 0.16307630360378497, 'support': 10897}, '2': {'precision': 0.35912027068594277, 'recall': 0.3654719048364376, 'f1-score': 0.36226824916608485, 'support': 12778}, 'accuracy': 0.3429677275638348, 'macro avg': {'precision': 0.33426475906241454, 'recall': 0.3341821856495269, 'f1-score': 0.31280229272401566, 'support': 35913}, 'weighted avg': {'precision': 0.3357892540922805, 'recall': 0.3429677275638348, 'f1-score': 0.3191368837603798, 'support': 35913}}
[[6432 1360 4446]
 [5794 1215 3888]
 [6679 1429 4670]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/EXC
Evaluating performance on  test set...
5267/5267 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894697
{'0': {'precision': 0.37265977296946917, 'recall': 0.6302199165444908, 'f1-score': 0.468366472022442, 'support': 443350}, '1': {'precision': 0.37056631808818397, 'recall': 0.07298978763785359, 'f1-score': 0.12195777045487805, 'support': 451022}, '2': {'precision': 0.3986557557203972, 'recall': 0.44764572113562445, 'f1-score': 0.42173279412741643, 'support': 453812}, 'accuracy': 0.3823476617435009, 'macro avg': {'precision': 0.3806272822593501, 'recall': 0.3836184751059896, 'f1-score': 0.33735234553491217, 'support': 1348184}, 'weighted avg': {'precision': 0.38070993134302733, 'recall': 0.3823476617435009, 'f1-score': 0.3367814153600701, 'support': 1348184}}
[[279408  26471 137471]
 [249140  32920 168962]
 [221219  29446 203147]]
Evaluating performance on  train set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0859324
{'0': {'precision': 0.3823332226392396, 'recall': 0.682023941253395, 'f1-score': 0.4899866703069042, 'support': 89469}, '1': {'precision': 0.39229233840012284, 'recall': 0.0569169079973268, 'f1-score': 0.09941054024084198, 'support': 89780}, '2': {'precision': 0.42066364548800145, 'recall': 0.45094714877245606, 'f1-score': 0.43527930763178596, 'support': 92013}, 'accuracy': 0.396749268235138, 'macro avg': {'precision': 0.3984297355091213, 'recall': 0.39662933267439265, 'f1-score': 0.3415588393931774, 'support': 271262}, 'weighted avg': {'precision': 0.39863121723706463, 'recall': 0.396749268235138, 'f1-score': 0.34216016486509254, 'support': 271262}}
[[61020  3551 24898]
 [52424  5110 32246]
 [46155  4365 41493]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.086873
{'0': {'precision': 0.3646342060990151, 'recall': 0.6786648020915669, 'f1-score': 0.47438826141929724, 'support': 32894}, '1': {'precision': 0.39041547592877557, 'recall': 0.05345050711770548, 'f1-score': 0.09402795425667089, 'support': 33227}, '2': {'precision': 0.44279109316044, 'recall': 0.4469357650529704, 'f1-score': 0.44485377541077703, 'support': 37285}, 'accuracy': 0.39421310175425023, 'macro avg': {'precision': 0.3992802583960769, 'recall': 0.39301702475408096, 'f1-score': 0.3377566636955817, 'support': 103406}, 'weighted avg': {'precision': 0.40109934145594484, 'recall': 0.39421310175425023, 'f1-score': 0.3415195184361022, 'support': 103406}}
[[22324  1236  9334]
 [19815  1776 11636]
 [19084  1537 16664]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/AAL
Evaluating performance on  test set...
10110/10110 - 94s - 94s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0856894
{'0': {'precision': 0.3981940199576509, 'recall': 0.6297864747137755, 'f1-score': 0.4879026584281479, 'support': 941481}, '1': {'precision': 0.3169800110342486, 'recall': 0.05457728725526445, 'f1-score': 0.09312108359079087, 'support': 684259}, '2': {'precision': 0.42048637014027324, 'recall': 0.42873219473874535, 'f1-score': 0.42456924938670004, 'support': 962356}, 'accuracy': 0.40294873142263654, 'macro avg': {'precision': 0.37855346704405757, 'recall': 0.3710319855692618, 'f1-score': 0.33519766380187965, 'support': 2588096}, 'weighted avg': {'precision': 0.3850112633753716, 'recall': 0.40294873142263654, 'f1-score': 0.35997767735784497, 'support': 2588096}}
[[592932  35973 312576]
 [390855  37345 256059]
 [505266  44497 412593]]
Evaluating performance on  train set...
1686/1686 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0902944
{'0': {'precision': 0.3825484143973714, 'recall': 0.6243423858950661, 'f1-score': 0.47441329227729795, 'support': 147693}, '1': {'precision': 0.3524191094431484, 'recall': 0.05034522231157672, 'f1-score': 0.08810421883419442, 'support': 138027}, '2': {'precision': 0.3885154914404815, 'recall': 0.45500047995831217, 'f1-score': 0.41913784936049264, 'support': 145846}, 'accuracy': 0.3835334572232289, 'macro avg': {'precision': 0.37449433842700036, 'recall': 0.376562696054985, 'f1-score': 0.3272184534906617, 'support': 431566}, 'weighted avg': {'precision': 0.3749287611890855, 'recall': 0.3835334572232289, 'f1-score': 0.3321806216596505, 'support': 431566}}
[[92211  5787 49695]
 [76329  6949 54749]
 [72504  6982 66360]]
Evaluating performance on  val set...
705/705 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0908163
{'0': {'precision': 0.3719644660213979, 'recall': 0.6028298456147311, 'f1-score': 0.4600586584250528, 'support': 60498}, '1': {'precision': 0.30348365035263947, 'recall': 0.052048016127554296, 'f1-score': 0.08885690596498914, 'support': 54565}, '2': {'precision': 0.40755249352819517, 'recall': 0.4553105537788251, 'f1-score': 0.4301098583405609, 'support': 65351}, 'accuracy': 0.38281397230813574, 'macro avg': {'precision': 0.36100020330074417, 'recall': 0.37006280517370344, 'f1-score': 0.32634180757686765, 'support': 180414}, 'weighted avg': {'precision': 0.3641438837973516, 'recall': 0.38281397230813574, 'f1-score': 0.3369428932554706, 'support': 180414}}
[[36470  2910 21118]
 [29589  2840 22136]
 [31988  3608 29755]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/WBA
Evaluating performance on  test set...
6546/6546 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0899128
{'0': {'precision': 0.4014515487289288, 'recall': 0.4514109055094034, 'f1-score': 0.42496795639038965, 'support': 621374}, '1': {'precision': 0.2804699460826732, 'recall': 0.07581015525023783, 'f1-score': 0.11935816834005818, 'support': 444637}, '2': {'precision': 0.3922005232950315, 'recall': 0.5511543198639449, 'f1-score': 0.4582856901292827, 'support': 609753}, 'accuracy': 0.3880444979125939, 'macro avg': {'precision': 0.3580406727022112, 'recall': 0.3594584602078621, 'f1-score': 0.33420393828657685, 'support': 1675764}, 'weighted avg': {'precision': 0.36598489747778706, 'recall': 0.3880444979125939, 'f1-score': 0.35600249870730066, 'support': 1675764}}
[[280495  42349 298530]
 [188649  33708 222280]
 [229558  44127 336068]]
Evaluating performance on  train set...
1230/1230 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0953099
{'0': {'precision': 0.3714416947671488, 'recall': 0.6096758178107129, 'f1-score': 0.46163485234534896, 'support': 108766}, '1': {'precision': 0.30967688415114686, 'recall': 0.07369096382569215, 'f1-score': 0.11905217502232428, 'support': 101315}, '2': {'precision': 0.3661812312165018, 'recall': 0.39222635093182534, 'f1-score': 0.3787565722719306, 'support': 104687}, 'accuracy': 0.36483695928429827, 'macro avg': {'precision': 0.34909993671159917, 'recall': 0.3585310441894101, 'f1-score': 0.31981453321320125, 'support': 314768}, 'weighted avg': {'precision': 0.3498117834188325, 'recall': 0.36483695928429827, 'f1-score': 0.32380304460432, 'support': 314768}}
[[66312  8121 34333]
 [57110  7466 36739]
 [55104  8522 41061]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919179
{'0': {'precision': 0.3839620365157243, 'recall': 0.5941109119872561, 'f1-score': 0.46646016747930935, 'support': 40176}, '1': {'precision': 0.33470546486870123, 'recall': 0.06819956616052061, 'f1-score': 0.11331090821720328, 'support': 34575}, '2': {'precision': 0.37974311428700647, 'recall': 0.43414079263721206, 'f1-score': 0.40512406064919243, 'support': 38681}, 'accuracy': 0.3792580576909514, 'macro avg': {'precision': 0.36613687189047733, 'recall': 0.3654837569283296, 'f1-score': 0.32829837878190166, 'support': 113432}, 'weighted avg': {'precision': 0.36750955312986444, 'recall': 0.3792580576909514, 'f1-score': 0.33790140463211393, 'support': 113432}}
[[23869  2268 14039]
 [18827  2358 13390]
 [19469  2419 16793]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
7633/7633 - 73s - 73s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990558
{'0': {'precision': 0.3525228967939919, 'recall': 0.5874073589045852, 'f1-score': 0.44061682769271004, 'support': 656701}, '1': {'precision': 0.3040078424220317, 'recall': 0.08474535878553895, 'f1-score': 0.13254297893699735, 'support': 629415}, '2': {'precision': 0.36402788961651045, 'recall': 0.3729679711679122, 'f1-score': 0.36844370684605693, 'support': 667867}, 'accuracy': 0.35219548993005567, 'macro avg': {'precision': 0.3401862096108446, 'recall': 0.34837356295267874, 'f1-score': 0.3138678378252548, 'support': 1953983}, 'weighted avg': {'precision': 0.3408276579377018, 'recall': 0.35219548993005567, 'f1-score': 0.31671178490826996, 'support': 1953983}}
[[385751  60073 210877]
 [351776  53340 224299]
 [356731  62043 249093]]
Evaluating performance on  train set...
1586/1586 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974938
{'0': {'precision': 0.36322935339171303, 'recall': 0.6096551525577445, 'f1-score': 0.45523316591287144, 'support': 138931}, '1': {'precision': 0.3169966133428784, 'recall': 0.0859442068095462, 'f1-score': 0.13522592466437236, 'support': 133959}, '2': {'precision': 0.35559141756831103, 'recall': 0.3646457048292463, 'f1-score': 0.36006164930458845, 'support': 132940}, 'accuracy': 0.3565261316314713, 'macro avg': {'precision': 0.3452724614343008, 'recall': 0.3534150213988457, 'f1-score': 0.31684024662727744, 'support': 405830}, 'weighted avg': {'precision': 0.345466549230944, 'recall': 0.3565261316314713, 'f1-score': 0.3184272337533149, 'support': 405830}}
[[84700 12151 42080]
 [76677 11513 45769]
 [71809 12655 48476]]
Evaluating performance on  val set...
574/574 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1108586
{'0': {'precision': 0.2887317476352282, 'recall': 0.6217893253566042, 'f1-score': 0.39434632299334443, 'support': 40451}, '1': {'precision': 0.3630602926101948, 'recall': 0.0607591778172858, 'f1-score': 0.10409736416710086, 'support': 64122}, '2': {'precision': 0.3227891988905205, 'recall': 0.37414306652167745, 'f1-score': 0.34657411259771825, 'support': 42302}, 'accuracy': 0.30553191489361703, 'macro avg': {'precision': 0.3248604130453145, 'recall': 0.35223052323185583, 'f1-score': 0.28167259991938787, 'support': 146875}, 'weighted avg': {'precision': 0.3309907656021129, 'recall': 0.30553191489361703, 'f1-score': 0.2538717440519849, 'support': 146875}}
[[25152  3199 12100]
 [39121  3896 21105]
 [22839  3636 15827]]
testing model on single stock: results/universal/W10/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
22048/22048 - 198s - 198s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0900279
{'0': {'precision': 0.3824337426129926, 'recall': 0.5038210435039919, 'f1-score': 0.4348143903822749, 'support': 2135804}, '1': {'precision': 0.2495155445103137, 'recall': 0.040040603038711015, 'f1-score': 0.06900736146887552, 'support': 1411717}, '2': {'precision': 0.3743653496664101, 'recall': 0.4649422716072466, 'f1-score': 0.41476634233538096, 'support': 2096542}, 'accuracy': 0.37337641340998495, 'macro avg': {'precision': 0.33543821226323883, 'recall': 0.3362679727166498, 'f1-score': 0.3061960313955105, 'support': 5644063}, 'weighted avg': {'precision': 0.3461905956892368, 'recall': 0.37337641340998495, 'f1-score': 0.3358701411446479, 'support': 5644063}}
[[1076063   84835  974906]
 [ 701072   56526  654119]
 [1036589   85182  974771]]
Evaluating performance on  train set...
5429/5429 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000341
{'0': {'precision': 0.34255390868567287, 'recall': 0.5262409244540706, 'f1-score': 0.41497918428137903, 'support': 465399}, '1': {'precision': 0.3558199633896845, 'recall': 0.04344091864166884, 'f1-score': 0.07742880295234655, 'support': 456413}, '2': {'precision': 0.34911341045429434, 'recall': 0.46185652042916087, 'f1-score': 0.39764804796628084, 'support': 467983}, 'accuracy': 0.34600786446922027, 'macro avg': {'precision': 0.3491624275098839, 'recall': 0.34384612117496677, 'f1-score': 0.2966853450666688, 'support': 1389795}, 'weighted avg': {'precision': 0.34911929073252645, 'recall': 0.34600786446922027, 'f1-score': 0.29829070910361805, 'support': 1389795}}
[[244912  17682 202805]
 [236418  19827 200168]
 [233629  18213 216141]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043352
{'0': {'precision': 0.31960264016488515, 'recall': 0.5054802203965819, 'f1-score': 0.3916038514724189, 'support': 151545}, '1': {'precision': 0.38654704262793127, 'recall': 0.04704923905381513, 'f1-score': 0.08388791593695272, 'support': 173074}, '2': {'precision': 0.34048241738030405, 'recall': 0.4772144258337106, 'f1-score': 0.3974165307474206, 'support': 159048}, 'accuracy': 0.3321417421490406, 'macro avg': {'precision': 0.34887736672437347, 'recall': 0.34324796176136924, 'f1-score': 0.2909694327189307, 'support': 483667}, 'weighted avg': {'precision': 0.35042389180795197, 'recall': 0.3321417421490406, 'f1-score': 0.2834031001010522, 'support': 483667}}
[[76603  6439 68503]
 [86415  8143 78516]
 [76664  6484 75900]]
training model: results/universal/W10/deepOF_L2/h1000
Epoch 1/50
8543/8543 - 230s - loss: 3.2800 - accuracy1000: 0.3699 - val_loss: 3.2903 - val_accuracy1000: 0.3657 - 230s/epoch - 27ms/step
Epoch 2/50
8543/8543 - 231s - loss: 3.2761 - accuracy1000: 0.3701 - val_loss: 3.2983 - val_accuracy1000: 0.3623 - 231s/epoch - 27ms/step
Epoch 3/50
8543/8543 - 230s - loss: 3.2698 - accuracy1000: 0.3759 - val_loss: 3.3057 - val_accuracy1000: 0.3632 - 230s/epoch - 27ms/step
Epoch 4/50
8543/8543 - 230s - loss: 3.2646 - accuracy1000: 0.3799 - val_loss: 3.3095 - val_accuracy1000: 0.3640 - 230s/epoch - 27ms/step
Epoch 5/50
8543/8543 - 230s - loss: 3.2625 - accuracy1000: 0.3819 - val_loss: 3.3216 - val_accuracy1000: 0.3647 - 230s/epoch - 27ms/step
Epoch 6/50
8543/8543 - 230s - loss: 3.2596 - accuracy1000: 0.3854 - val_loss: 3.3265 - val_accuracy1000: 0.3653 - 230s/epoch - 27ms/step
Epoch 7/50
8543/8543 - 230s - loss: 3.2570 - accuracy1000: 0.3878 - val_loss: 3.3289 - val_accuracy1000: 0.3655 - 230s/epoch - 27ms/step
Epoch 8/50
8543/8543 - 231s - loss: 3.2544 - accuracy1000: 0.3905 - val_loss: 3.3280 - val_accuracy1000: 0.3656 - 231s/epoch - 27ms/step
Epoch 9/50
8543/8543 - 230s - loss: 3.2524 - accuracy1000: 0.3920 - val_loss: 3.3256 - val_accuracy1000: 0.3655 - 230s/epoch - 27ms/step
Epoch 10/50
8543/8543 - 230s - loss: 3.2515 - accuracy1000: 0.3929 - val_loss: 3.3091 - val_accuracy1000: 0.3654 - 230s/epoch - 27ms/step
Epoch 11/50
8543/8543 - 228s - loss: 3.2484 - accuracy1000: 0.3957 - val_loss: 3.3138 - val_accuracy1000: 0.3659 - 228s/epoch - 27ms/step
testing model in sample: results/universal/W10/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 339s - 339s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1112069
{'0': {'precision': 0.37308067377481585, 'recall': 0.030572189857904986, 'f1-score': 0.05651337680753766, 'support': 3391252}, '1': {'precision': 0.2958691238358, 'recall': 0.9335014555366381, 'f1-score': 0.4493262851467605, 'support': 2795189}, '2': {'precision': 0.3710462259962384, 'recall': 0.049513622818537384, 'f1-score': 0.08736850621377748, 'support': 3358813}, 'accuracy': 0.3016470803186589, 'macro avg': {'precision': 0.3466653412022847, 'recall': 0.33786242273769346, 'f1-score': 0.1977360560560252, 'support': 9545254}, 'weighted avg': {'precision': 0.34975450511455863, 'recall': 0.3016470803186589, 'f1-score': 0.18240032860726604, 'support': 9545254}}
[[ 103678 3118500  169074]
 [  73046 2609313  112830]
 [ 101173 3091333  166307]]
Evaluating performance on  train set...
8543/8543 - 83s - 83s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057482
{'0': {'precision': 0.3383149570639773, 'recall': 0.026724400066594295, 'f1-score': 0.04953583269574089, 'support': 726789}, '1': {'precision': 0.3316783807677091, 'recall': 0.9390228050864802, 'f1-score': 0.4902074019639337, 'support': 723172}, '2': {'precision': 0.3505389996459572, 'recall': 0.03897246152363553, 'f1-score': 0.07014616532830399, 'support': 736751}, 'accuracy': 0.3325591115793941, 'macro avg': {'precision': 0.3401774458258812, 'recall': 0.3349065555589033, 'f1-score': 0.20329646666265952, 'support': 2186712}, 'weighted avg': {'precision': 0.34023870808514123, 'recall': 0.3325591115793941, 'f1-score': 0.20221529998187235, 'support': 2186712}}
[[ 19423 679887  27479]
 [ 18378 679075  25719]
 [ 19610 688428  28713]]
Evaluating performance on  val set...
3077/3077 - 29s - 29s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0972915
{'0': {'precision': 0.3174505584588585, 'recall': 0.025672792061157263, 'f1-score': 0.04750386218053154, 'support': 241345}, '1': {'precision': 0.36706746375243454, 'recall': 0.9433591713302513, 'f1-score': 0.528494231050095, 'support': 287690}, '2': {'precision': 0.34525888180166053, 'recall': 0.03756795111397176, 'f1-score': 0.06776258965132584, 'support': 257906}, 'accuracy': 0.3650591340392736, 'macro avg': {'precision': 0.3432589680043178, 'recall': 0.3355333048351268, 'f1-score': 0.21458689429398414, 'support': 786941}, 'weighted avg': {'precision': 0.34470319991985443, 'recall': 0.3650591340392736, 'f1-score': 0.22998382775249612, 'support': 786941}}
[[  6196 226263   8886]
 [  6807 271395   9488]
 [  6515 241702   9689]]
testing model out of sample: results/universal/W10/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
21332/21332 - 193s - 193s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1344246
{'0': {'precision': 0.39421356717599787, 'recall': 0.012981519334655484, 'f1-score': 0.02513532807152297, 'support': 2070867}, '1': {'precision': 0.24451623905391207, 'recall': 0.9773405220573348, 'f1-score': 0.39116799339245695, 'support': 1333570}, '2': {'precision': 0.3799617676824469, 'recall': 0.011502492052615889, 'f1-score': 0.022329022915262425, 'support': 2056337}, 'accuracy': 0.24792968908803037, 'macro avg': {'precision': 0.3395638579707856, 'recall': 0.3339415111482021, 'f1-score': 0.14621078145974745, 'support': 5460774}, 'weighted avg': {'precision': 0.35228940615432947, 'recall': 0.24792968908803037, 'f1-score': 0.1134670320325235, 'support': 5460774}}
[[  26883 2019463   24521]
 [  16141 1303352   14077]
 [  25170 2007514   23653]]
Evaluating performance on  train set...
4055/4055 - 40s - 40s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069787
{'0': {'precision': 0.35355955785730847, 'recall': 0.013045127470916552, 'f1-score': 0.02516186882161698, 'support': 350629}, '1': {'precision': 0.33385761899412053, 'recall': 0.9799083640907565, 'f1-score': 0.4980337099299486, 'support': 345716}, '2': {'precision': 0.35845213849287166, 'recall': 0.010318767845312288, 'f1-score': 0.02006006622101406, 'support': 341126}, 'accuracy': 0.33433609228595307, 'macro avg': {'precision': 0.34862310511476685, 'recall': 0.33442408646899513, 'f1-score': 0.18108521499085992, 'support': 1037471}, 'weighted avg': {'precision': 0.3486029961470161, 'recall': 0.33433609228595307, 'f1-score': 0.18105924224860886, 'support': 1037471}}
[[  4574 342676   3379]
 [  4025 338770   2921]
 [  4338 333268   3520]]
Evaluating performance on  val set...
1545/1545 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1034235
{'0': {'precision': 0.3482547820942615, 'recall': 0.014060061781471928, 'f1-score': 0.02702888846374593, 'support': 125604}, '1': {'precision': 0.34614267486851796, 'recall': 0.9800284887733675, 'f1-score': 0.5115926086339926, 'support': 136194}, '2': {'precision': 0.3697399527186761, 'recall': 0.01174994553254149, 'f1-score': 0.022776090929611106, 'support': 133107}, 'accuracy': 0.34642255732391336, 'macro avg': {'precision': 0.3547124698938185, 'recall': 0.3352794986957936, 'f1-score': 0.18713252934244987, 'support': 394905}, 'weighted avg': {'precision': 0.3547681720862875, 'recall': 0.34642255732391336, 'f1-score': 0.1927107465903599, 'support': 394905}}
[[  1766 122336   1502]
 [  1556 133474   1164]
 [  1749 129794   1564]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
518/518 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111205
{'0': {'precision': 0.3825966850828729, 'recall': 0.020782923489580402, 'f1-score': 0.039424291483570253, 'support': 53313}, '1': {'precision': 0.2970371903457938, 'recall': 0.949563579917042, 'f1-score': 0.45251969124611185, 'support': 39297}, '2': {'precision': 0.3285189718482252, 'recall': 0.033554194274284285, 'f1-score': 0.060889292196007264, 'support': 39995}, 'accuracy': 0.29987557030277895, 'macro avg': {'precision': 0.3360509490922973, 'recall': 0.3346335658936355, 'f1-score': 0.1842777583085631, 'support': 132605}, 'weighted avg': {'precision': 0.3409310645896582, 'recall': 0.29987557030277895, 'f1-score': 0.1683176411156544, 'support': 132605}}
[[ 1108 50586  1619]
 [  858 37315  1124]
 [  930 37723  1342]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058248
{'0': {'precision': 0.3588957055214724, 'recall': 0.020158511371467954, 'f1-score': 0.03817292006525286, 'support': 11608}, '1': {'precision': 0.3294206854716409, 'recall': 0.9657656055486395, 'f1-score': 0.4912701284602859, 'support': 11246}, '2': {'precision': 0.33047210300429186, 'recall': 0.02014476323362693, 'f1-score': 0.037974683544303806, 'support': 11467}, 'accuracy': 0.33000203956761165, 'macro avg': {'precision': 0.33959616466580167, 'recall': 0.3353562933845782, 'f1-score': 0.18913924402328086, 'support': 34321}, 'weighted avg': {'precision': 0.3397409744371533, 'recall': 0.33000203956761165, 'f1-score': 0.18657355021661262, 'support': 34321}}
[[  234 11121   253]
 [  170 10861   215]
 [  248 10988   231]]
Evaluating performance on  val set...
46/46 - 1s - 682ms/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1061031
{'0': {'precision': 0.3783783783783784, 'recall': 0.024008574490889605, 'f1-score': 0.045152187059060676, 'support': 4665}, '1': {'precision': 0.3193585953596703, 'recall': 0.9534634929125435, 'f1-score': 0.47845926721245463, 'support': 3739}, '2': {'precision': 0.2825112107623318, 'recall': 0.01921903599755949, 'f1-score': 0.03598971722365039, 'support': 3278}, 'accuracy': 0.32015065913371, 'macro avg': {'precision': 0.32674939483346016, 'recall': 0.33223036780033083, 'f1-score': 0.18653372383172193, 'support': 11682}, 'weighted avg': {'precision': 0.33258762815133247, 'recall': 0.32015065913371, 'f1-score': 0.18126762932691423, 'support': 11682}}
[[ 112 4458   95]
 [ 109 3565   65]
 [  75 3140   63]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
1840/1840 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1268945
{'0': {'precision': 0.32143932550436616, 'recall': 0.013319109647152768, 'f1-score': 0.02557835843247194, 'support': 160296}, '1': {'precision': 0.28282559330142504, 'recall': 0.9773560346504286, 'f1-score': 0.4387007304907266, 'support': 133678}, '2': {'precision': 0.3926613243357233, 'recall': 0.005260243632336656, 'f1-score': 0.010381413812521254, 'support': 176988}, 'accuracy': 0.28392311906268447, 'macro avg': {'precision': 0.33230874771383817, 'recall': 0.33197846264330605, 'f1-score': 0.15822016757857327, 'support': 470962}, 'weighted avg': {'precision': 0.3372444916021394, 'recall': 0.28392311906268447, 'f1-score': 0.13712811322714227, 'support': 470962}}
[[  2135 157444    717]
 [  2304 130651    723]
 [  2203 173854    931]]
Evaluating performance on  train set...
529/529 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101264
{'0': {'precision': 0.34662576687116564, 'recall': 0.010090637138902531, 'f1-score': 0.019610395244913013, 'support': 44794}, '1': {'precision': 0.3303463145128689, 'recall': 0.985395591880485, 'f1-score': 0.4948110271979548, 'support': 44781}, '2': {'precision': 0.41005802707930367, 'recall': 0.004626396648044693, 'f1-score': 0.009149565179862325, 'support': 45824}, 'accuracy': 0.3308074653431709, 'macro avg': {'precision': 0.3623433694877794, 'recall': 0.3333708752224774, 'f1-score': 0.17452366254091004, 'support': 135399}, 'weighted avg': {'precision': 0.3627094139861431, 'recall': 0.3308074653431709, 'f1-score': 0.1732348859914346, 'support': 135399}}
[[  452 44211   131]
 [  480 44127   174]
 [  372 45240   212]]
Evaluating performance on  val set...
208/208 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1112198
{'0': {'precision': 0.4033816425120773, 'recall': 0.009660997338886961, 'f1-score': 0.01887005649717514, 'support': 17286}, '1': {'precision': 0.3305397889604206, 'recall': 0.9894520782256685, 'f1-score': 0.49553832755100585, 'support': 17539}, '2': {'precision': 0.40963855421686746, 'recall': 0.003724598784028044, 'f1-score': 0.007382076751886229, 'support': 18257}, 'accuracy': 0.3313552616706228, 'macro avg': {'precision': 0.38118666189645517, 'recall': 0.33427922478286115, 'f1-score': 0.1739301536000224, 'support': 53082}, 'weighted avg': {'precision': 0.3814657231336034, 'recall': 0.3313552616706228, 'f1-score': 0.17241643304296086, 'support': 53082}}
[[  167 17072    47]
 [  134 17354    51]
 [  113 18076    68]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
967/967 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1177334
{'0': {'precision': 0.44177031174285253, 'recall': 0.026114272619638695, 'f1-score': 0.0493134877347349, 'support': 104732}, '1': {'precision': 0.2563647535524456, 'recall': 0.9473776140495737, 'f1-score': 0.4035319102886671, 'support': 62977}, '2': {'precision': 0.32172701949860727, 'recall': 0.0347259630441591, 'f1-score': 0.06268585836885608, 'support': 79825}, 'accuracy': 0.263276963972626, 'macro avg': {'precision': 0.33995402826463517, 'recall': 0.33607261657112386, 'f1-score': 0.17184375213075267, 'support': 247534}, 'weighted avg': {'precision': 0.3558882040665166, 'recall': 0.263276963972626, 'f1-score': 0.1437452146209312, 'support': 247534}}
[[ 2735 98073  3924]
 [ 1394 59663  1920]
 [ 2062 74991  2772]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068985
{'0': {'precision': 0.33144246353322526, 'recall': 0.023652556095304186, 'f1-score': 0.04415416171866565, 'support': 17292}, '1': {'precision': 0.3281701233919664, 'recall': 0.9543025411713382, 'f1-score': 0.48839026568430444, 'support': 18338}, '2': {'precision': 0.39623750734861846, 'recall': 0.03266928408705346, 'f1-score': 0.060361812645531074, 'support': 20631}, 'accuracy': 0.33029985247329413, 'macro avg': {'precision': 0.35195003142460335, 'recall': 0.33687479378456525, 'f1-score': 0.19763541334950038, 'support': 56261}, 'weighted avg': {'precision': 0.35413630785602385, 'recall': 0.33029985247329413, 'f1-score': 0.19489413649327053, 'support': 56261}}
[[  409 16332   551]
 [  362 17500   476]
 [  463 19494   674]]
Evaluating performance on  val set...
79/79 - 1s - 993ms/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1035602
{'0': {'precision': 0.3264887063655031, 'recall': 0.02347556474235937, 'f1-score': 0.04380165289256199, 'support': 6773}, '1': {'precision': 0.33675095622609436, 'recall': 0.9490941757748166, 'f1-score': 0.49711798611928004, 'support': 6679}, '2': {'precision': 0.33943661971830985, 'recall': 0.03668747145684274, 'f1-score': 0.06621788707240005, 'support': 6569}, 'accuracy': 0.3365965735977224, 'macro avg': {'precision': 0.3342254274366358, 'recall': 0.3364190706580062, 'f1-score': 0.20237917536141403, 'support': 20021}, 'weighted avg': {'precision': 0.33416047149379224, 'recall': 0.3365965735977224, 'f1-score': 0.20238274434396833, 'support': 20021}}
[[ 159 6323  291]
 [ 162 6339  178]
 [ 166 6162  241]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1588/1588 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057485
{'0': {'precision': 0.35246210338009604, 'recall': 0.05208420291064919, 'f1-score': 0.09075701557670161, 'support': 143748}, '1': {'precision': 0.3065233019901406, 'recall': 0.8644354157448007, 'f1-score': 0.4525686413674148, 'support': 124295}, '2': {'precision': 0.3461794790066935, 'recall': 0.08642341469060606, 'f1-score': 0.1383162854777741, 'support': 138238}, 'accuracy': 0.312293708049355, 'macro avg': {'precision': 0.3350549614589767, 'recall': 0.3343143444486853, 'f1-score': 0.22721398080729682, 'support': 406281}, 'weighted avg': {'precision': 0.33627020480030784, 'recall': 0.312293708049355, 'f1-score': 0.21762948655181774, 'support': 406281}}
[[  7487 124216  12045]
 [  6331 107445  10519]
 [  7424 118867  11947]]
Evaluating performance on  train set...
295/295 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028792
{'0': {'precision': 0.30997304582210244, 'recall': 0.048786696080095025, 'f1-score': 0.08430466974561983, 'support': 23572}, '1': {'precision': 0.3298871607197316, 'recall': 0.8719871019750101, 'f1-score': 0.47868127005199695, 'support': 24810}, '2': {'precision': 0.3657631494030332, 'recall': 0.08363461964140781, 'f1-score': 0.13613980302666345, 'support': 27106}, 'accuracy': 0.33185406952098345, 'macro avg': {'precision': 0.33520778531495576, 'recall': 0.33480280589883765, 'f1-score': 0.2330419142747601, 'support': 75488}, 'weighted avg': {'precision': 0.3365509885186223, 'recall': 0.33185406952098345, 'f1-score': 0.23253387937254313, 'support': 75488}}
[[ 1150 20479  1943]
 [ 1188 21634  1988]
 [ 1372 23467  2267]]
Evaluating performance on  val set...
131/131 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0938865
{'0': {'precision': 0.3199245757385292, 'recall': 0.049273959341723135, 'f1-score': 0.08539552051002433, 'support': 10330}, '1': {'precision': 0.3527890781217679, 'recall': 0.8883583644413577, 'f1-score': 0.5050215916101172, 'support': 11519}, '2': {'precision': 0.35763511062749365, 'recall': 0.08570186875271621, 'f1-score': 0.13826952741550974, 'support': 11505}, 'accuracy': 0.3516219943634946, 'macro avg': {'precision': 0.34344958816259696, 'recall': 0.34111139751193237, 'f1-score': 0.24289554651188375, 'support': 33354}, 'weighted avg': {'precision': 0.34428225118525413, 'recall': 0.3516219943634946, 'f1-score': 0.24855400712181241, 'support': 33354}}
[[  509  8885   936]
 [  451 10233   835]
 [  631  9888   986]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
2104/2104 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1196905
{'0': {'precision': 0.4007884362680683, 'recall': 0.03520889649931218, 'f1-score': 0.06473121512517355, 'support': 207902}, '1': {'precision': 0.23948613763822824, 'recall': 0.9214566560569182, 'f1-score': 0.38016704485105973, 'support': 128184}, '2': {'precision': 0.37421546186221666, 'recall': 0.05006173754136415, 'f1-score': 0.0883096063705588, 'support': 202470}, 'accuracy': 0.2517324103714377, 'macro avg': {'precision': 0.33816334525617103, 'recall': 0.33557576336586487, 'f1-score': 0.1777359554489307, 'support': 538556}, 'weighted avg': {'precision': 0.3524060879597769, 'recall': 0.2517324103714377, 'f1-score': 0.14867372671734994, 'support': 538556}}
[[  7320 189668  10914]
 [  4032 118116   6036]
 [  6912 185422  10136]]
Evaluating performance on  train set...
428/428 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024518
{'0': {'precision': 0.3631045241809672, 'recall': 0.025626204238921, 'f1-score': 0.04787370802694504, 'support': 36330}, '1': {'precision': 0.33777902433362994, 'recall': 0.9517126740605499, 'f1-score': 0.4985973603249271, 'support': 36697}, '2': {'precision': 0.34871214265496747, 'recall': 0.03378489551911369, 'f1-score': 0.06160154003850096, 'support': 36466}, 'accuracy': 0.33872484999041036, 'macro avg': {'precision': 0.3498652303898549, 'recall': 0.33704125793952827, 'f1-score': 0.20269086946345768, 'support': 109493}, 'weighted avg': {'precision': 0.3498232874569315, 'recall': 0.33872484999041036, 'f1-score': 0.20350744708343674, 'support': 109493}}
[[  931 34089  1310]
 [  781 34925   991]
 [  852 34382  1232]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1086382
{'0': {'precision': 0.34173387096774194, 'recall': 0.027809680065627562, 'f1-score': 0.05143377332726445, 'support': 12190}, '1': {'precision': 0.3038296092723145, 'recall': 0.9388904273977661, 'f1-score': 0.45909408923694967, 'support': 10833}, '2': {'precision': 0.3750865051903114, 'recall': 0.04204809930178433, 'f1-score': 0.07561911405650505, 'support': 12890}, 'accuracy': 0.30774371397544065, 'macro avg': {'precision': 0.3402166618101226, 'recall': 0.33624940225505934, 'f1-score': 0.1953823255402397, 'support': 35913}, 'weighted avg': {'precision': 0.3422712415071665, 'recall': 0.30774371397544065, 'f1-score': 0.18308340561221784, 'support': 35913}}
[[  339 11321   530]
 [  289 10171   373]
 [  364 11984   542]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
5267/5267 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.080189
{'0': {'precision': 0.3163613392293114, 'recall': 0.012976211143269497, 'f1-score': 0.024929872289162623, 'support': 385937}, '1': {'precision': 0.42316098830550886, 'recall': 0.9850589620778801, 'f1-score': 0.5920076956992264, 'support': 569773}, '2': {'precision': 0.33683158420789605, 'recall': 0.00515193363127239, 'f1-score': 0.01014864095041872, 'support': 392474}, 'accuracy': 0.4215225814873934, 'macro avg': {'precision': 0.3587846372475721, 'recall': 0.3343957022841407, 'f1-score': 0.20902873631293592, 'support': 1348184}, 'weighted avg': {'precision': 0.36745643854870497, 'recall': 0.4215225814873934, 'f1-score': 0.2602867550955007, 'support': 1348184}}
[[  5008 379289   1640]
 [  6172 561260   2341]
 [  4650 385802   2022]]
Evaluating performance on  train set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1082237
{'0': {'precision': 0.35783820073850287, 'recall': 0.011945316001792917, 'f1-score': 0.02311888005725501, 'support': 89240}, '1': {'precision': 0.3301676751121638, 'recall': 0.985557590921276, 'f1-score': 0.4946310098074115, 'support': 89528}, '2': {'precision': 0.37596153846153846, 'recall': 0.004227301230350077, 'f1-score': 0.008360596146855689, 'support': 92494}, 'accuracy': 0.33064712344523006, 'macro avg': {'precision': 0.35465580477073505, 'recall': 0.333910069384473, 'f1-score': 0.17537016200384073, 'support': 271262}, 'weighted avg': {'precision': 0.35488538457213814, 'recall': 0.33064712344523006, 'f1-score': 0.173705712124642, 'support': 271262}}
[[ 1066 87869   305]
 [  949 88235   344]
 [  964 91139   391]]
Evaluating performance on  val set...
404/404 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0742183
{'0': {'precision': 0.32898415657036345, 'recall': 0.013369692837935083, 'f1-score': 0.025695152132770415, 'support': 26403}, '1': {'precision': 0.44456647512208514, 'recall': 0.9875833224415109, 'f1-score': 0.6131292093803252, 'support': 45906}, '2': {'precision': 0.38028169014084506, 'recall': 0.004341254783419623, 'f1-score': 0.008584509729111027, 'support': 31097}, 'accuracy': 0.4431464325087519, 'macro avg': {'precision': 0.38461077394443116, 'recall': 0.3350980900209552, 'f1-score': 0.21580295708073557, 'support': 103406}, 'weighted avg': {'precision': 0.3957222696090324, 'recall': 0.4431464325087519, 'f1-score': 0.2813346525986975, 'support': 103406}}
[[  353 25973    77]
 [  427 45336   143]
 [  293 30669   135]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
10110/10110 - 91s - 91s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1541853
{'0': {'precision': 0.39988479773140145, 'recall': 0.00880467189060939, 'f1-score': 0.017229973854349923, 'support': 1025024}, '1': {'precision': 0.19937712018480516, 'recall': 0.9862896464661133, 'f1-score': 0.3317012754535586, 'support': 516471}, '2': {'precision': 0.44764595103578153, 'recall': 0.004542323196710112, 'f1-score': 0.008993389272441617, 'support': 1046601}, 'accuracy': 0.20214435631444894, 'macro avg': {'precision': 0.3489692896506627, 'recall': 0.33321221385114425, 'f1-score': 0.11930821286011672, 'support': 2588096}, 'weighted avg': {'precision': 0.3791863654009737, 'recall': 0.20214435631444894, 'f1-score': 0.07665392487789584, 'support': 2588096}}
[[   9025 1012197    3802]
 [   5017  509390    2064]
 [   8527 1033320    4754]]
Evaluating performance on  train set...
1686/1686 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1096754
{'0': {'precision': 0.3600297545251674, 'recall': 0.00993391075900004, 'f1-score': 0.01933434976264822, 'support': 146166}, '1': {'precision': 0.33142059881195934, 'recall': 0.9865477122720663, 'f1-score': 0.4961609938691942, 'support': 143024}, '2': {'precision': 0.3407821229050279, 'recall': 0.004284429960105636, 'f1-score': 0.008462466878459553, 'support': 142376}, 'accuracy': 0.3317267810717248, 'macro avg': {'precision': 0.3440774920807182, 'recall': 0.33358868433039063, 'f1-score': 0.174652603503434, 'support': 431566}, 'weighted avg': {'precision': 0.3441985799510006, 'recall': 0.3317267810717248, 'f1-score': 0.1737713507061317, 'support': 431566}}
[[  1452 144140    574]
 [  1318 141100    606]
 [  1263 140503    610]]
Evaluating performance on  val set...
705/705 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.111114
{'0': {'precision': 0.3462149285336157, 'recall': 0.011366598884196256, 'f1-score': 0.022010567764951368, 'support': 57537}, '1': {'precision': 0.32675442302168, 'recall': 0.98668231452189, 'f1-score': 0.49093009380910674, 'support': 58794}, '2': {'precision': 0.4423076923076923, 'recall': 0.006819281244635863, 'f1-score': 0.013431482534462356, 'support': 64083}, 'accuracy': 0.3275909851785338, 'macro avg': {'precision': 0.371759014620996, 'recall': 0.33495606488357405, 'f1-score': 0.17545738136950684, 'support': 180414}, 'weighted avg': {'precision': 0.3740051866059682, 'recall': 0.3275909851785338, 'f1-score': 0.17177655652089407, 'support': 180414}}
[[  654 56566   317]
 [  549 58011   234]
 [  686 62960   437]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
6546/6546 - 61s - 61s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997977
{'0': {'precision': 0.3549225201818688, 'recall': 0.007026638768308298, 'f1-score': 0.01378045661047603, 'support': 544357}, '1': {'precision': 0.3603156133748229, 'recall': 0.9904230735414389, 'f1-score': 0.5283996093402549, 'support': 602803}, '2': {'precision': 0.33989779384270224, 'recall': 0.00515887129117449, 'f1-score': 0.010163484133299294, 'support': 528604}, 'accuracy': 0.36018317615129575, 'macro avg': {'precision': 0.351711975799798, 'recall': 0.33420286120030723, 'f1-score': 0.1841145166946767, 'support': 1675764}, 'weighted avg': {'precision': 0.35212310589334345, 'recall': 0.36018317615129575, 'f1-score': 0.19775745038981685, 'support': 1675764}}
[[  3825 537613   2919]
 [  3396 597030   2377]
 [  3556 522321   2727]]
Evaluating performance on  train set...
1230/1230 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043859
{'0': {'precision': 0.3735408560311284, 'recall': 0.012625883060273561, 'f1-score': 0.02442614906493648, 'support': 106448}, '1': {'precision': 0.3395446006348384, 'recall': 0.9845320160033059, 'f1-score': 0.5049443906574378, 'support': 106478}, '2': {'precision': 0.3893004115226337, 'recall': 0.00928889848981756, 'f1-score': 0.0181448519257327, 'support': 101842}, 'accuracy': 0.3403173130686728, 'macro avg': {'precision': 0.36746195606286686, 'recall': 0.33548226585113233, 'f1-score': 0.18250513054936898, 'support': 314768}, 'weighted avg': {'precision': 0.36713973319869225, 'recall': 0.3403173130686728, 'f1-score': 0.1849409455659644, 'support': 314768}}
[[  1344 104253    851]
 [  1014 104831    633]
 [  1240  99656    946]]
Evaluating performance on  val set...
444/444 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944107
{'0': {'precision': 0.3410942956926659, 'recall': 0.00807362707007247, 'f1-score': 0.015773889636608345, 'support': 36291}, '1': {'precision': 0.3744812259578912, 'recall': 0.9903930131004367, 'f1-score': 0.543469250297912, 'support': 42365}, '2': {'precision': 0.3660377358490566, 'recall': 0.005578559926386013, 'f1-score': 0.010989633490058348, 'support': 34776}, 'accuracy': 0.3741889413921997, 'macro avg': {'precision': 0.3605377524998712, 'recall': 0.33468173336563173, 'f1-score': 0.19007759114152623, 'support': 113432}, 'weighted avg': {'precision': 0.361210932757735, 'recall': 0.3741889413921997, 'f1-score': 0.21139273319630675, 'support': 113432}}
[[  293 35806   192]
 [  263 41958   144]
 [  303 34279   194]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
7633/7633 - 70s - 70s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1159986
{'0': {'precision': 0.37445295404814005, 'recall': 0.010067716238954192, 'f1-score': 0.019608236318635987, 'support': 679896}, '1': {'precision': 0.30092267742777157, 'recall': 0.9869153366368869, 'f1-score': 0.46121515633470306, 'support': 586641}, '2': {'precision': 0.3928601857374116, 'recall': 0.006707435929513009, 'f1-score': 0.013189679955033232, 'support': 687446}, 'accuracy': 0.3021628130848631, 'macro avg': {'precision': 0.35607860573777445, 'recall': 0.3345634962684514, 'f1-score': 0.16467102420279076, 'support': 1953983}, 'weighted avg': {'precision': 0.35885307564029995, 'recall': 0.3021628130848631, 'f1-score': 0.14993297008920223, 'support': 1953983}}
[[  6845 668743   4308]
 [  4858 578965   2818]
 [  6577 676258   4611]]
Evaluating performance on  train set...
1586/1586 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053478
{'0': {'precision': 0.36311172668513386, 'recall': 0.011297609043833, 'f1-score': 0.02191341900881134, 'support': 139233}, '1': {'precision': 0.33673929489331217, 'recall': 0.9854557183804825, 'f1-score': 0.5019557030915979, 'support': 136411}, '2': {'precision': 0.3510452961672474, 'recall': 0.006191141904659487, 'f1-score': 0.012167690705152397, 'support': 130186}, 'accuracy': 0.33710174210876476, 'macro avg': {'precision': 0.3502987725818978, 'recall': 0.3343148231096584, 'f1-score': 0.1786789376018539, 'support': 405830}, 'weighted avg': {'precision': 0.3503764185103913, 'recall': 0.33710174210876476, 'f1-score': 0.18014295016490342, 'support': 405830}}
[[  1573 136836    824]
 [  1318 134427    666]
 [  1441 127939    806]]
Evaluating performance on  val set...
574/574 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0921868
{'0': {'precision': 0.345679012345679, 'recall': 0.01197146650464682, 'f1-score': 0.02314150245769716, 'support': 44439}, '1': {'precision': 0.38309008834362623, 'recall': 0.9854494291973143, 'f1-score': 0.5517062591918638, 'support': 56149}, '2': {'precision': 0.36777777777777776, 'recall': 0.007151035928014345, 'f1-score': 0.014029287727552079, 'support': 46287}, 'accuracy': 0.38260425531914893, 'macro avg': {'precision': 0.3655156261556944, 'recall': 0.3348573105433252, 'f1-score': 0.196292349792371, 'support': 146875}, 'weighted avg': {'precision': 0.36694525957471247, 'recall': 0.38260425531914893, 'f1-score': 0.22233541185448014, 'support': 146875}}
[[  532 43624   283]
 [  531 55332   286]
 [  476 45480   331]]
testing model on single stock: results/universal/W10/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
22048/22048 - 205s - 205s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1210761
{'0': {'precision': 0.38200914713279455, 'recall': 0.039576450428714355, 'f1-score': 0.07172240305296818, 'support': 2156914}, '1': {'precision': 0.24151679084906041, 'recall': 0.8890974909133544, 'f1-score': 0.3798500978116397, 'support': 1364640}, '2': {'precision': 0.3744212059071007, 'recall': 0.07002326020761278, 'f1-score': 0.11798186512559262, 'support': 2122509}, 'accuracy': 0.2564262659718717, 'macro avg': {'precision': 0.3326490479629852, 'recall': 0.3328990671832272, 'f1-score': 0.18985145533006684, 'support': 5644063}, 'weighted avg': {'precision': 0.34518692126075146, 'recall': 0.2564262659718717, 'f1-score': 0.16361887939630054, 'support': 5644063}}
[[  85363 1919954  151597]
 [  54618 1213298   96724]
 [  83477 1890407  148625]]
Evaluating performance on  train set...
5429/5429 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053289
{'0': {'precision': 0.33448086832584145, 'recall': 0.032964871902925, 'f1-score': 0.06001495062359837, 'support': 462735}, '1': {'precision': 0.3304624316542464, 'recall': 0.9185292028629186, 'f1-score': 0.4860551272480842, 'support': 457575}, '2': {'precision': 0.3463675568087577, 'recall': 0.05337550720470303, 'f1-score': 0.09249713472601337, 'support': 469485}, 'accuracy': 0.33142226011749937, 'macro avg': {'precision': 0.3371036189296152, 'recall': 0.33495652732351555, 'f1-score': 0.21285573753256534, 'support': 1389795}, 'weighted avg': {'precision': 0.3371732695665977, 'recall': 0.33142226011749937, 'f1-score': 0.21125684746613374, 'support': 1389795}}
[[ 15254 422934  24547]
 [ 14537 420296  22742]
 [ 15814 428612  25059]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101488
{'0': {'precision': 0.31514593741782804, 'recall': 0.03174098718840004, 'f1-score': 0.05767322117090835, 'support': 151035}, '1': {'precision': 0.35297837814723204, 'recall': 0.9206038940837398, 'f1-score': 0.5102980412572395, 'support': 170361}, '2': {'precision': 0.33965860125952935, 'recall': 0.05052042570761257, 'f1-score': 0.0879580702441432, 'support': 162271}, 'accuracy': 0.35112381039020646, 'macro avg': {'precision': 0.33592763894152977, 'recall': 0.33428843565991745, 'f1-score': 0.2186431108907637, 'support': 483667}, 'weighted avg': {'precision': 0.3366956129370565, 'recall': 0.35112381039020646, 'f1-score': 0.2272609121208602, 'support': 483667}}
[[  4794 138534   7707]
 [  5295 156835   8231]
 [  5123 148950   8198]]
training model: results/universal/W10/deepVOL_L2/h300
Epoch 1/50
8543/8543 - 359s - loss: 3.2687 - accuracy300: 0.3761 - val_loss: 3.2859 - val_accuracy300: 0.3593 - 359s/epoch - 42ms/step
Epoch 2/50
8543/8543 - 357s - loss: 3.2614 - accuracy300: 0.3800 - val_loss: 3.2923 - val_accuracy300: 0.3640 - 357s/epoch - 42ms/step
Epoch 3/50
8543/8543 - 355s - loss: 3.2549 - accuracy300: 0.3867 - val_loss: 3.2839 - val_accuracy300: 0.3629 - 355s/epoch - 42ms/step
Epoch 4/50
8543/8543 - 355s - loss: 3.2501 - accuracy300: 0.3900 - val_loss: 3.2973 - val_accuracy300: 0.3607 - 355s/epoch - 42ms/step
Epoch 5/50
8543/8543 - 353s - loss: 3.2469 - accuracy300: 0.3924 - val_loss: 3.2981 - val_accuracy300: 0.3577 - 353s/epoch - 41ms/step
Epoch 6/50
8543/8543 - 356s - loss: 3.2428 - accuracy300: 0.3942 - val_loss: 3.3044 - val_accuracy300: 0.3569 - 356s/epoch - 42ms/step
Epoch 7/50
8543/8543 - 353s - loss: 3.2394 - accuracy300: 0.3965 - val_loss: 3.3041 - val_accuracy300: 0.3533 - 353s/epoch - 41ms/step
Epoch 8/50
8543/8543 - 354s - loss: 3.2357 - accuracy300: 0.3986 - val_loss: 3.3026 - val_accuracy300: 0.3570 - 354s/epoch - 41ms/step
Epoch 9/50
8543/8543 - 353s - loss: 3.2328 - accuracy300: 0.4002 - val_loss: 3.3016 - val_accuracy300: 0.3547 - 353s/epoch - 41ms/step
Epoch 10/50
8543/8543 - 354s - loss: 3.2304 - accuracy300: 0.4018 - val_loss: 3.3059 - val_accuracy300: 0.3536 - 354s/epoch - 41ms/step
Epoch 11/50
8543/8543 - 357s - loss: 3.2284 - accuracy300: 0.4027 - val_loss: 3.3062 - val_accuracy300: 0.3542 - 357s/epoch - 42ms/step
Epoch 12/50
8543/8543 - 356s - loss: 3.2262 - accuracy300: 0.4037 - val_loss: 3.3085 - val_accuracy300: 0.3542 - 356s/epoch - 42ms/step
Epoch 13/50
8543/8543 - 356s - loss: 3.2235 - accuracy300: 0.4053 - val_loss: 3.3189 - val_accuracy300: 0.3530 - 356s/epoch - 42ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 778s - 778s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1063088
{'0': {'precision': 0.4261482210874228, 'recall': 0.08066480220591253, 'f1-score': 0.13565224406051873, 'support': 3460518}, '1': {'precision': 0.28526176371419804, 'recall': 0.513670463259113, 'f1-score': 0.36681595101577674, 'support': 2636926}, '2': {'precision': 0.3855499905237528, 'recall': 0.46316688588636057, 'f1-score': 0.4208093262378174, 'support': 3447835}, 'accuracy': 0.3384475194491434, 'macro avg': {'precision': 0.3656533251084579, 'recall': 0.35250071711712866, 'f1-score': 0.30775917377137096, 'support': 9545279}, 'weighted avg': {'precision': 0.37256328524941956, 'recall': 0.3384475194491434, 'f1-score': 0.30251338636505143, 'support': 9545279}}
[[ 279142 1732043 1449333]
 [ 186736 1354511 1095679]
 [ 189157 1661755 1596923]]
Evaluating performance on  train set...
8543/8543 - 181s - 181s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975426
{'0': {'precision': 0.4074605622108884, 'recall': 0.09428881972234573, 'f1-score': 0.1531401009254471, 'support': 728676}, '1': {'precision': 0.3401448443677638, 'recall': 0.5041415657451987, 'f1-score': 0.40621559784854955, 'support': 724243}, '2': {'precision': 0.365076979099624, 'recall': 0.46998845736105566, 'f1-score': 0.41094256505764465, 'support': 733801}, 'accuracy': 0.3561064059413185, 'macro avg': {'precision': 0.3708941285594254, 'recall': 0.35613961427620006, 'f1-score': 0.3234327546105471, 'support': 2186720}, 'weighted avg': {'precision': 0.37094283103886494, 'recall': 0.3561064059413185, 'f1-score': 0.32347003027202514, 'support': 2186720}}
[[ 68706 363768 296202]
 [ 55530 365121 303592]
 [ 44384 344539 344878]]
Evaluating performance on  val set...
3077/3077 - 66s - 66s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945041
{'0': {'precision': 0.4006550389419084, 'recall': 0.10180701782329611, 'f1-score': 0.1623585070409119, 'support': 251132}, '1': {'precision': 0.35753255895811337, 'recall': 0.531906846844226, 'f1-score': 0.4276266934856715, 'support': 274988}, '2': {'precision': 0.36214198824301175, 'recall': 0.43601216150416183, 'f1-score': 0.39565868602015486, 'support': 260823}, 'accuracy': 0.36286872111448987, 'macro avg': {'precision': 0.3734431953810112, 'recall': 0.35657534205722796, 'f1-score': 0.3285479621822461, 'support': 786943}, 'weighted avg': {'precision': 0.3728216965674008, 'recall': 0.36286872111448987, 'f1-score': 0.3323779628794855, 'support': 786943}}
[[ 25567 132335  93230]
 [ 21646 146268 107074]
 [ 16600 130501 113722]]
testing model out of sample: results/universal/W10/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 447s - 447s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1042687
{'0': {'precision': 0.43297198635525447, 'recall': 0.1379508988326189, 'f1-score': 0.20923622519492036, 'support': 2006714}, '1': {'precision': 0.26984989871474735, 'recall': 0.6590699284560351, 'f1-score': 0.38291776800905564, 'support': 1455888}, '2': {'precision': 0.4135867190567882, 'recall': 0.26196065753276576, 'f1-score': 0.32075751494409943, 'support': 1998197}, 'accuracy': 0.322262181779626, 'macro avg': {'precision': 0.37213620137559666, 'recall': 0.35299382827380654, 'f1-score': 0.30430383604935846, 'support': 5460799}, 'weighted avg': {'precision': 0.3823890821152786, 'recall': 0.322262181779626, 'f1-score': 0.2963484555878585, 'support': 5460799}}
[[ 276828 1312922  416964]
 [ 171136  959532  325220]
 [ 191403 1283345  523449]]
Evaluating performance on  train set...
4055/4055 - 87s - 87s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966284
{'0': {'precision': 0.401305057096248, 'recall': 0.14453134930386666, 'f1-score': 0.21252214291499405, 'support': 354027}, '1': {'precision': 0.3281095518692143, 'recall': 0.646160712681001, 'f1-score': 0.43522112823823744, 'support': 333838}, '2': {'precision': 0.3896742616835753, 'recall': 0.28146961657823605, 'f1-score': 0.3268493346331224, 'support': 349615}, 'accuracy': 0.3520906427111848, 'macro avg': {'precision': 0.3730296235496792, 'recall': 0.3573872261877012, 'f1-score': 0.3248642019287846, 'support': 1037480}, 'weighted avg': {'precision': 0.3738329693334149, 'recall': 0.3520906427111848, 'f1-score': 0.3227082525218052, 'support': 1037480}}
[[ 51168 224830  78029]
 [ 42026 215713  76099]
 [ 34310 216899  98406]]
Evaluating performance on  val set...
1545/1545 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955131
{'0': {'precision': 0.39900846226173176, 'recall': 0.14215022001613958, 'f1-score': 0.20962110580971088, 'support': 131354}, '1': {'precision': 0.3292466397255542, 'recall': 0.6419128473418753, 'f1-score': 0.43524807366537277, 'support': 127684}, '2': {'precision': 0.40052031339807, 'recall': 0.29234471946830354, 'f1-score': 0.3379878998289638, 'support': 135867}, 'accuracy': 0.3554120611286259, 'macro avg': {'precision': 0.3762584717951187, 'recall': 0.3588025956087728, 'f1-score': 0.3276190264346825, 'support': 394905}, 'weighted avg': {'precision': 0.37697263625201183, 'recall': 0.3554120611286259, 'f1-score': 0.3267372855660983, 'support': 394905}}
[[18672 83037 29645]
 [15916 81962 29806]
 [12208 83939 39720]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1141348
{'0': {'precision': 0.42224932485408134, 'recall': 0.09023550218747091, 'f1-score': 0.14869466515323493, 'support': 53715}, '1': {'precision': 0.25457718017474756, 'recall': 0.5889406666468789, 'f1-score': 0.3554894653862692, 'support': 33691}, '2': {'precision': 0.35241954156054645, 'recall': 0.3367179895584462, 'f1-score': 0.3443898907165645, 'support': 45204}, 'accuracy': 0.30095769549807705, 'macro avg': {'precision': 0.3430820155297918, 'recall': 0.338631386130932, 'f1-score': 0.2828580070853562, 'support': 132610}, 'weighted avg': {'precision': 0.35584688348169324, 'recall': 0.30095769549807705, 'f1-score': 0.26794155898489097, 'support': 132610}}
[[ 4847 31411 17457]
 [ 3337 19842 10512]
 [ 3295 26688 15221]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1036657
{'0': {'precision': 0.34596375617792424, 'recall': 0.07225184930328574, 'f1-score': 0.11953892130354349, 'support': 11626}, '1': {'precision': 0.33101523322925536, 'recall': 0.6156079535456626, 'f1-score': 0.4305316268766921, 'support': 11366}, '2': {'precision': 0.3516779771311704, 'recall': 0.3338628541170241, 'f1-score': 0.3425389351684172, 'support': 11331}, 'accuracy': 0.33854849517816044, 'macro avg': {'precision': 0.3428856555127833, 'recall': 0.3405742189886574, 'f1-score': 0.29753649444955094, 'support': 34323}, 'weighted avg': {'precision': 0.3429000066742871, 'recall': 0.33854849517816044, 'f1-score': 0.296142255762865, 'support': 34323}}
[[ 840 7344 3442]
 [ 837 6997 3532]
 [ 751 6797 3783]]
Evaluating performance on  val set...
46/46 - 1s - 738ms/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1190791
{'0': {'precision': 0.4152284263959391, 'recall': 0.08799483648881239, 'f1-score': 0.14521569323628614, 'support': 4648}, '1': {'precision': 0.2595903165735568, 'recall': 0.6844517184942717, 'f1-score': 0.3764176417641764, 'support': 3055}, '2': {'precision': 0.3663890991672975, 'recall': 0.24327720532797184, 'f1-score': 0.29240296027790363, 'support': 3979}, 'accuracy': 0.2968669748330765, 'macro avg': {'precision': 0.34706928071226445, 'recall': 0.33857458677035196, 'f1-score': 0.2713454317594554, 'support': 11682}, 'weighted avg': {'precision': 0.3578918309028606, 'recall': 0.2968669748330765, 'f1-score': 0.2558114891882893, 'support': 11682}}
[[ 409 3228 1011]
 [ 301 2091  663]
 [ 275 2736  968]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
1840/1840 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024984
{'0': {'precision': 0.4423891762368137, 'recall': 0.17974259729774653, 'f1-score': 0.25562487863770295, 'support': 168452}, '1': {'precision': 0.27166880671914445, 'recall': 0.7038781118914836, 'f1-score': 0.39202978982419706, 'support': 124442}, '2': {'precision': 0.46066938816274045, 'recall': 0.20722400363895704, 'f1-score': 0.2858592588001983, 'support': 178073}, 'accuracy': 0.3286238738595273, 'macro avg': {'precision': 0.3915757903728995, 'recall': 0.3636149042760624, 'f1-score': 0.31117130908736607, 'support': 470967}, 'weighted avg': {'precision': 0.40419207952890795, 'recall': 0.3286238738595273, 'f1-score': 0.30309832526251046, 'support': 470967}}
[[ 30278 114728  23446]
 [ 17094  87592  19756]
 [ 21070 120102  36901]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0657718
{'0': {'precision': 0.4310369833212473, 'recall': 0.22122971564686617, 'f1-score': 0.2923901815140932, 'support': 40302}, '1': {'precision': 0.41759461842406037, 'recall': 0.706649475041444, 'f1-score': 0.524962540794614, 'support': 54290}, '2': {'precision': 0.43568083336980784, 'recall': 0.24391678306255973, 'f1-score': 0.31274349629257253, 'support': 40809}, 'accuracy': 0.4226999800592315, 'macro avg': {'precision': 0.42810414503837185, 'recall': 0.39059865791695664, 'f1-score': 0.37669873953375993, 'support': 135401}, 'weighted avg': {'precision': 0.42704679777138743, 'recall': 0.4226999800592315, 'f1-score': 0.3917760930519285, 'support': 135401}}
[[ 8916 26767  4619]
 [ 7652 38364  8274]
 [ 4117 26738  9954]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0772444
{'0': {'precision': 0.46467426923581073, 'recall': 0.20185628060585356, 'f1-score': 0.2814497241078163, 'support': 17562}, '1': {'precision': 0.3579909760151983, 'recall': 0.6829378787020782, 'f1-score': 0.46974506787154063, 'support': 17659}, '2': {'precision': 0.45881852953676155, 'recall': 0.3022227198925032, 'f1-score': 0.36440964018092215, 'support': 17861}, 'accuracy': 0.39567084887532494, 'macro avg': {'precision': 0.42716125826259016, 'recall': 0.3956722930668117, 'f1-score': 0.37186814405342633, 'support': 53082}, 'weighted avg': {'precision': 0.427213178060883, 'recall': 0.39567084887532494, 'f1-score': 0.3720049883500331, 'support': 53082}}
[[ 3545 10914  3103]
 [ 2335 12060  3264]
 [ 1749 10714  5398]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126698
{'0': {'precision': 0.39915381940419614, 'recall': 0.0711930285206281, 'f1-score': 0.12083410093779334, 'support': 96737}, '1': {'precision': 0.29263364058881136, 'recall': 0.5469335580023823, 'f1-score': 0.38127063207566275, 'support': 68842}, '2': {'precision': 0.33877522904181306, 'recall': 0.42003416300634455, 'f1-score': 0.37505379155567903, 'support': 81960}, 'accuracy': 0.3190002383462808, 'macro avg': {'precision': 0.34352089634494015, 'recall': 0.3460535831764517, 'f1-score': 0.29238617485637836, 'support': 247539}, 'weighted avg': {'precision': 0.3495386419327285, 'recall': 0.3190002383462808, 'f1-score': 0.2774349497722603, 'support': 247539}}
[[ 6887 48746 41104]
 [ 5101 37652 26089]
 [ 5266 42268 34426]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008317
{'0': {'precision': 0.3146, 'recall': 0.09072557388395432, 'f1-score': 0.1408362431730683, 'support': 17338}, '1': {'precision': 0.3626373626373626, 'recall': 0.5788876276958003, 'f1-score': 0.4459282222487183, 'support': 19382}, '2': {'precision': 0.3670356703567036, 'recall': 0.3816832949603479, 'f1-score': 0.37421620265864064, 'support': 19545}, 'accuracy': 0.35995734470807783, 'macro avg': {'precision': 0.34809101099802203, 'recall': 0.35043216551336753, 'f1-score': 0.3203268893601424, 'support': 56265}, 'weighted avg': {'precision': 0.3493625582468521, 'recall': 0.35995734470807783, 'f1-score': 0.32700355938367454, 'support': 56265}}
[[ 1573  9203  6562]
 [ 1859 11220  6303]
 [ 1568 10517  7460]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048052
{'0': {'precision': 0.3392272429600524, 'recall': 0.07655926692284955, 'f1-score': 0.12492463523453518, 'support': 6766}, '1': {'precision': 0.36915077989601386, 'recall': 0.5314059289697681, 'f1-score': 0.43566143295434034, 'support': 6814}, '2': {'precision': 0.3316062176165803, 'recall': 0.4471355379599441, 'f1-score': 0.3808012693375645, 'support': 6441}, 'accuracy': 0.35058188901653264, 'macro avg': {'precision': 0.34666141349088225, 'recall': 0.3517002446175206, 'f1-score': 0.31379577917547996, 'support': 20021}, 'weighted avg': {'precision': 0.34695972167961375, 'recall': 0.35058188901653264, 'f1-score': 0.31300025283207594, 'support': 20021}}
[[ 518 3044 3204]
 [ 592 3621 2601]
 [ 417 3144 2880]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1089981
{'0': {'precision': 0.37036180788348166, 'recall': 0.021919082737012055, 'f1-score': 0.04138866462134669, 'support': 146174}, '1': {'precision': 0.2825259414083846, 'recall': 0.7848419355392031, 'f1-score': 0.41548600343699554, 'support': 116598}, '2': {'precision': 0.3354717083491564, 'recall': 0.17235252309879176, 'f1-score': 0.22771420417406993, 'support': 143514}, 'accuracy': 0.29400471588979193, 'macro avg': {'precision': 0.3294531525470076, 'recall': 0.32637118045833563, 'f1-score': 0.2281962907441374, 'support': 406286}, 'weighted avg': {'precision': 0.332829862151085, 'recall': 0.29400471588979193, 'f1-score': 0.214565503091283, 'support': 406286}}
[[  3204 116800  26170]
 [  2260  91511  22827]
 [  3187 115592  24735]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005355
{'0': {'precision': 0.35546875, 'recall': 0.022586249689749316, 'f1-score': 0.04247374562427071, 'support': 24174}, '1': {'precision': 0.33102559442177093, 'recall': 0.804029377533411, 'f1-score': 0.46897165195814505, 'support': 24917}, '2': {'precision': 0.3539045633886697, 'recall': 0.18008257888556384, 'f1-score': 0.2387025507129946, 'support': 26399}, 'accuracy': 0.3355941184262816, 'macro avg': {'precision': 0.34679963593681357, 'recall': 0.33556606870290806, 'f1-score': 0.25004931609847014, 'support': 75490}, 'weighted avg': {'precision': 0.3468537934508512, 'recall': 0.3355941184262816, 'f1-score': 0.2518695935201294, 'support': 75490}}
[[  546 19373  4255]
 [  459 20034  4424]
 [  531 21114  4754]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982854
{'0': {'precision': 0.27800829875518673, 'recall': 0.019812715623459834, 'f1-score': 0.036989326463010674, 'support': 10145}, '1': {'precision': 0.35870307167235493, 'recall': 0.7850444020250643, 'f1-score': 0.4924126083448293, 'support': 12049}, '2': {'precision': 0.32422935633285416, 'recall': 0.18189964157706093, 'f1-score': 0.2330520636014006, 'support': 11160}, 'accuracy': 0.35048270072555016, 'macro avg': {'precision': 0.32031357558679857, 'recall': 0.3289189197418617, 'f1-score': 0.2541513328030802, 'support': 33354}, 'weighted avg': {'precision': 0.3226241865481269, 'recall': 0.35048270072555016, 'f1-score': 0.26711030954925113, 'support': 33354}}
[[ 201 8014 1930]
 [ 289 9459 2301]
 [ 233 8897 2030]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1147232
{'0': {'precision': 0.40695057434308596, 'recall': 0.06601331360946745, 'f1-score': 0.11359918408975013, 'support': 210912}, '1': {'precision': 0.24356620806776538, 'recall': 0.5630836479237036, 'f1-score': 0.3400438193376225, 'support': 125825}, '2': {'precision': 0.3922478005452961, 'recall': 0.41486641826541937, 'f1-score': 0.40324017664934525, 'support': 201824}, 'accuracy': 0.3128763501256125, 'macro avg': {'precision': 0.3475881943187158, 'recall': 0.34798779326619683, 'f1-score': 0.2856277266922393, 'support': 538561}, 'weighted avg': {'precision': 0.3632689663069353, 'recall': 0.3128763501256125, 'f1-score': 0.2750458909853688, 'support': 538561}}
[[ 13923 113110  83879]
 [  9122  70850  45853]
 [ 11168 106926  83730]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040926
{'0': {'precision': 0.322156652360515, 'recall': 0.06546742981738893, 'f1-score': 0.10882073121007566, 'support': 36690}, '1': {'precision': 0.34410982311023086, 'recall': 0.4951524126176972, 'f1-score': 0.40603949961050273, 'support': 35791}, '2': {'precision': 0.3554623345271781, 'recall': 0.4853429875989517, 'f1-score': 0.41037121644774416, 'support': 37013}, 'accuracy': 0.347854676968601, 'macro avg': {'precision': 0.340576269999308, 'recall': 0.3486542766780126, 'f1-score': 0.3084104824227742, 'support': 109494}, 'weighted avg': {'precision': 0.3405911706751056, 'recall': 0.347854676968601, 'f1-score': 0.307909677179001, 'support': 109494}}
[[ 2402 16934 17354]
 [ 2850 17722 15219]
 [ 2204 16845 17964]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1031454
{'0': {'precision': 0.3707607699358387, 'recall': 0.06665568097552937, 'f1-score': 0.11299671764788044, 'support': 12137}, '1': {'precision': 0.31876160249116714, 'recall': 0.48346957311534966, 'f1-score': 0.38420729726803565, 'support': 11010}, '2': {'precision': 0.3742367308595585, 'recall': 0.4992950023499922, 'f1-score': 0.42781394724478156, 'support': 12766}, 'accuracy': 0.3482304457995712, 'macro avg': {'precision': 0.3545863677621881, 'recall': 0.34980675214695706, 'f1-score': 0.30833932072023257, 'support': 35913}, 'weighted avg': {'precision': 0.3560547660817016, 'recall': 0.3482304457995712, 'f1-score': 0.30805102206833956, 'support': 35913}}
[[ 809 5655 5673]
 [ 702 5323 4985]
 [ 671 5721 6374]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
5267/5267 - 64s - 64s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0854754
{'0': {'precision': 0.47318416691040266, 'recall': 0.21146916705517382, 'f1-score': 0.2923051906010883, 'support': 459022}, '1': {'precision': 0.31705804842031826, 'recall': 0.6167014313457527, 'f1-score': 0.4188019645690477, 'support': 417090}, '2': {'precision': 0.4536497296384932, 'recall': 0.3188272252196146, 'f1-score': 0.3744730081917758, 'support': 472077}, 'accuracy': 0.3744282144417437, 'macro avg': {'precision': 0.41463064832307134, 'recall': 0.3823326078735137, 'f1-score': 0.36186005445397057, 'support': 1348189}, 'weighted avg': {'precision': 0.4180432324382771, 'recall': 0.3744282144417437, 'f1-score': 0.36021115651466207, 'support': 1348189}}
[[ 97069 281488  80465]
 [ 59068 257220 100802]
 [ 49003 272563 150511]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0746543
{'0': {'precision': 0.4650037792894936, 'recall': 0.23883312073650934, 'f1-score': 0.31557965704235674, 'support': 90155}, '1': {'precision': 0.3372135058925602, 'recall': 0.6255294893431538, 'f1-score': 0.43820000391473707, 'support': 89473}, '2': {'precision': 0.4749940663886346, 'recall': 0.30575653407540787, 'f1-score': 0.3720331162321323, 'support': 91635}, 'accuracy': 0.3889878088792058, 'macro avg': {'precision': 0.4257371171902295, 'recall': 0.39003971471835697, 'f1-score': 0.375270925729742, 'support': 271263}, 'weighted avg': {'precision': 0.4262284241053585, 'recall': 0.3889878088792058, 'f1-score': 0.3750950462718778, 'support': 271263}}
[[21532 56493 12130]
 [14667 55968 18838]
 [10106 53511 28018]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0739738
{'0': {'precision': 0.44480757686920563, 'recall': 0.21081747486881203, 'f1-score': 0.2860574345336393, 'support': 31634}, '1': {'precision': 0.3724182614054772, 'recall': 0.6300157724490069, 'f1-score': 0.4681193389480375, 'support': 37407}, '2': {'precision': 0.44950660512494034, 'recall': 0.32873563218390806, 'f1-score': 0.3797502395078743, 'support': 34365}, 'accuracy': 0.4016498075546873, 'macro avg': {'precision': 0.4222441477998744, 'recall': 0.3898562931672423, 'f1-score': 0.377975670996517, 'support': 103406}, 'weighted avg': {'precision': 0.42018245823447103, 'recall': 0.4016498075546873, 'f1-score': 0.3830551223019407, 'support': 103406}}
[[ 6669 20048  4917]
 [ 4922 23567  8918]
 [ 3402 19666 11297]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
10110/10110 - 122s - 122s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038904
{'0': {'precision': 0.4649718694157392, 'recall': 0.1455269722287939, 'f1-score': 0.2216742889973691, 'support': 963732}, '1': {'precision': 0.251659086746267, 'recall': 0.7241682045955479, 'f1-score': 0.37351590929293405, 'support': 646974}, '2': {'precision': 0.46119292297912917, 'recall': 0.200424598038664, 'f1-score': 0.2794194629675855, 'support': 977395}, 'accuracy': 0.3109078818794166, 'macro avg': {'precision': 0.3926079597137118, 'recall': 0.35670659162100193, 'f1-score': 0.29153655375262955, 'support': 2588101}, 'weighted avg': {'precision': 0.4102207806416885, 'recall': 0.3109078818794166, 'f1-score': 0.28143912227154294, 'support': 2588101}}
[[140249 700989 122494]
 [ 72089 468518 106367]
 [ 89291 692210 195894]]
Evaluating performance on  train set...
1686/1686 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935338
{'0': {'precision': 0.4256685145931844, 'recall': 0.14023460843757765, 'f1-score': 0.2109670543908118, 'support': 148929}, '1': {'precision': 0.3217425619594118, 'recall': 0.7290290899229692, 'f1-score': 0.4464522557580572, 'support': 136439}, '2': {'precision': 0.4325153374233129, 'recall': 0.21699726402188782, 'f1-score': 0.2890002277385561, 'support': 146200}, 'accuracy': 0.352384792199607, 'macro avg': {'precision': 0.3933088046586364, 'recall': 0.3620869874608115, 'f1-score': 0.31547317929580837, 'support': 431568}, 'weighted avg': {'precision': 0.39513208104474123, 'recall': 0.352384792199607, 'f1-score': 0.31184991719061583, 'support': 431568}}
[[ 20885 107963  20081]
 [ 15427  99468  21544]
 [ 12752 101723  31725]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964583
{'0': {'precision': 0.4205271565495208, 'recall': 0.13522320496974172, 'f1-score': 0.20464234959734723, 'support': 62297}, '1': {'precision': 0.2938329689826696, 'recall': 0.7142142045782714, 'f1-score': 0.4163687686946176, 'support': 51941}, '2': {'precision': 0.4663346029885731, 'recall': 0.24051015473887816, 'f1-score': 0.3173489123282755, 'support': 66176}, 'accuracy': 0.34053343975522965, 'macro avg': {'precision': 0.39356490950692113, 'recall': 0.36331585476229716, 'f1-score': 0.3127866768734135, 'support': 180414}, 'weighted avg': {'precision': 0.40085424191507396, 'recall': 0.34053343975522965, 'f1-score': 0.3069390196429824, 'support': 180414}}
[[ 8424 44194  9679]
 [ 6309 37097  8535]
 [ 5299 44961 15916]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
6546/6546 - 82s - 82s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097804
{'0': {'precision': 0.4060216231011359, 'recall': 0.15565691260519485, 'f1-score': 0.22504001233871798, 'support': 571796}, '1': {'precision': 0.33492252681764006, 'recall': 0.650848205092693, 'f1-score': 0.44226049398309475, 'support': 548747}, '2': {'precision': 0.3794330966964812, 'recall': 0.2666499767662177, 'f1-score': 0.31319757651658103, 'support': 555226}, 'accuracy': 0.3545870582401274, 'macro avg': {'precision': 0.37345908220508567, 'recall': 0.3577183648213686, 'f1-score': 0.3268326942794646, 'support': 1675769}, 'weighted avg': {'precision': 0.3739300538276678, 'recall': 0.3545870582401274, 'f1-score': 0.32537989174281545, 'support': 1675769}}
[[ 89004 364807 117985]
 [ 67442 357151 124154]
 [ 62764 344411 148051]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978452
{'0': {'precision': 0.42129185252103213, 'recall': 0.13564267340501923, 'f1-score': 0.2052131821588432, 'support': 110017}, '1': {'precision': 0.32218337294012234, 'recall': 0.6686779256743782, 'f1-score': 0.43484776286169674, 'support': 98943}, '2': {'precision': 0.3953456943618574, 'recall': 0.27647670352518666, 'f1-score': 0.32539514810406767, 'support': 105810}, 'accuracy': 0.35053531149728373, 'macro avg': {'precision': 0.3796069732743373, 'recall': 0.36026576753486134, 'f1-score': 0.32181869770820254, 'support': 314770}, 'weighted avg': {'precision': 0.3814168539824286, 'recall': 0.35053531149728373, 'f1-score': 0.31779439426656203, 'support': 314770}}
[[14923 72432 22662]
 [10702 66161 22080]
 [ 9797 66759 29254]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930573
{'0': {'precision': 0.4221597162773633, 'recall': 0.1817798841495524, 'f1-score': 0.25413185114293074, 'support': 37980}, '1': {'precision': 0.3490250923310884, 'recall': 0.65763553099496, 'f1-score': 0.45602519182152834, 'support': 39087}, '2': {'precision': 0.3813161488562649, 'recall': 0.24568977369593312, 'f1-score': 0.29883442866937576, 'support': 36367}, 'accuracy': 0.36623939912195635, 'macro avg': {'precision': 0.3841669858215722, 'recall': 0.36170172961348185, 'f1-score': 0.3363304905446116, 'support': 113434}, 'weighted avg': {'precision': 0.3838645749388658, 'recall': 0.36623939912195635, 'f1-score': 0.338031772189606, 'support': 113434}}
[[ 6904 24606  6470]
 [ 5355 25705  8027]
 [ 4095 23337  8935]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
7633/7633 - 95s - 95s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001608
{'0': {'precision': 0.403129811839993, 'recall': 0.1624737022789891, 'f1-score': 0.23160391119811027, 'support': 681618}, '1': {'precision': 0.30310400567008844, 'recall': 0.6246598088728736, 'f1-score': 0.4081575230302587, 'support': 580556}, '2': {'precision': 0.403052062772746, 'recall': 0.2812923704926469, 'f1-score': 0.33134037381824993, 'support': 691814}, 'accuracy': 0.3418634096012872, 'macro avg': {'precision': 0.36976196009427587, 'recall': 0.3561419605481699, 'f1-score': 0.3237006026822063, 'support': 1953988}, 'weighted avg': {'precision': 0.3733832781765398, 'recall': 0.3418634096012872, 'f1-score': 0.31937228020647374, 'support': 1953988}}
[[110745 418863 152010]
 [ 81697 362650 136209]
 [ 82271 414941 194602]]
Evaluating performance on  train set...
1586/1586 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096539
{'0': {'precision': 0.40502448104869615, 'recall': 0.18568027308453572, 'f1-score': 0.25462824099797904, 'support': 139444}, '1': {'precision': 0.3290604753826974, 'recall': 0.615184166284579, 'f1-score': 0.42877192048041973, 'support': 130860}, '2': {'precision': 0.3830841678833618, 'recall': 0.27491403863465314, 'f1-score': 0.32010791119664583, 'support': 135526}, 'accuracy': 0.35397333859005004, 'macro avg': {'precision': 0.3723897081049185, 'recall': 0.3585928260012559, 'f1-score': 0.33450269089168155, 'support': 405830}, 'weighted avg': {'precision': 0.3732029482307731, 'recall': 0.35397333859005004, 'f1-score': 0.33264770648948216, 'support': 405830}}
[[25892 83077 30475]
 [20832 80503 29525]
 [17203 81065 37258]]
Evaluating performance on  val set...
574/574 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0893105
{'0': {'precision': 0.3838281394062327, 'recall': 0.1829648837515932, 'f1-score': 0.24780499419625585, 'support': 45506}, '1': {'precision': 0.38315078888649773, 'recall': 0.6165791776027997, 'f1-score': 0.47261321802546924, 'support': 54864}, '2': {'precision': 0.37184908115140675, 'recall': 0.29500053757660466, 'f1-score': 0.32899675056055827, 'support': 46505}, 'accuracy': 0.38041191489361703, 'macro avg': {'precision': 0.37960933648137907, 'recall': 0.3648481996436659, 'f1-score': 0.34980498759409445, 'support': 146875}, 'weighted avg': {'precision': 0.3797821937854299, 'recall': 0.38041191489361703, 'f1-score': 0.3574880649835774, 'support': 146875}}
[[ 8326 27100 10080]
 [ 7941 33828 13095]
 [ 5425 27361 13719]]
testing model on single stock: results/universal/W10/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
22048/22048 - 269s - 269s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139318
{'0': {'precision': 0.3903281519861831, 'recall': 0.028422646205286433, 'f1-score': 0.05298692690631654, 'support': 2115074}, '1': {'precision': 0.25240090962900597, 'recall': 0.3924124278258997, 'f1-score': 0.3072059710300591, 'support': 1430049}, '2': {'precision': 0.37867990314473493, 'recall': 0.5893651334360833, 'f1-score': 0.4610957614838767, 'support': 2098945}, 'accuracy': 0.3292536517986672, 'macro avg': {'precision': 0.34046965491997466, 'recall': 0.3367334024890898, 'f1-score': 0.27376288647341745, 'support': 5644068}, 'weighted avg': {'precision': 0.35104943516878256, 'recall': 0.3292536517986672, 'f1-score': 0.2691685334394963, 'support': 5644068}}
[[  60116  853405 1201553]
 [  40748  561169  828132]
 [  53150  808750 1237045]]
Evaluating performance on  train set...
5429/5429 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1046754
{'0': {'precision': 0.35436653607674984, 'recall': 0.0495120984078547, 'f1-score': 0.08688466934663486, 'support': 464028}, '1': {'precision': 0.3368641099768395, 'recall': 0.40549034207875256, 'f1-score': 0.36800518353551714, 'support': 456620}, '2': {'precision': 0.352679348758382, 'recall': 0.5828416619062641, 'f1-score': 0.43944757072706625, 'support': 469148}, 'accuracy': 0.3465033717178636, 'macro avg': {'precision': 0.34796999827065705, 'recall': 0.3459480341309571, 'f1-score': 0.2981124745364061, 'support': 1389796}, 'weighted avg': {'precision': 0.34804654496886156, 'recall': 0.3465033717178636, 'f1-score': 0.2982606045527759, 'support': 1389796}}
[[ 22975 188456 252597]
 [ 22182 185155 249283]
 [ 19677 176032 273439]]
Evaluating performance on  val set...
1890/1890 - 23s - 23s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010625
{'0': {'precision': 0.3419242562360156, 'recall': 0.05365025908420074, 'f1-score': 0.09274775913905982, 'support': 153811}, '1': {'precision': 0.3555754801566703, 'recall': 0.44642328155178745, 'f1-score': 0.3958539096812155, 'support': 168786}, '2': {'precision': 0.3488327013241904, 'recall': 0.5362823617060906, 'f1-score': 0.4227084877891229, 'support': 161070}, 'accuracy': 0.3514422112734588, 'macro avg': {'precision': 0.3487774792389587, 'recall': 0.34545196744735956, 'f1-score': 0.30377005220313275, 'support': 483667}, 'weighted avg': {'precision': 0.34898878354721097, 'recall': 0.3514422112734588, 'f1-score': 0.3084061548722273, 'support': 483667}}
[[ 8252 68947 76612]
 [ 8804 75350 84632]
 [ 7078 67613 86379]]
training model: results/universal/W10/deepVOL_L2/h500
Epoch 1/50
8543/8543 - 359s - loss: 3.2811 - accuracy500: 0.3687 - val_loss: 3.3046 - val_accuracy500: 0.3457 - 359s/epoch - 42ms/step
Epoch 2/50
8543/8543 - 354s - loss: 3.2759 - accuracy500: 0.3728 - val_loss: 3.3012 - val_accuracy500: 0.3512 - 354s/epoch - 41ms/step
Epoch 3/50
8543/8543 - 355s - loss: 3.2736 - accuracy500: 0.3737 - val_loss: 3.3073 - val_accuracy500: 0.3466 - 355s/epoch - 42ms/step
Epoch 4/50
8543/8543 - 356s - loss: 3.2677 - accuracy500: 0.3798 - val_loss: 3.3179 - val_accuracy500: 0.3483 - 356s/epoch - 42ms/step
Epoch 5/50
8543/8543 - 354s - loss: 3.2640 - accuracy500: 0.3831 - val_loss: 3.3303 - val_accuracy500: 0.3456 - 354s/epoch - 41ms/step
Epoch 6/50
8543/8543 - 354s - loss: 3.2596 - accuracy500: 0.3873 - val_loss: 3.3310 - val_accuracy500: 0.3475 - 354s/epoch - 41ms/step
Epoch 7/50
8543/8543 - 355s - loss: 3.2550 - accuracy500: 0.3909 - val_loss: 3.3256 - val_accuracy500: 0.3480 - 355s/epoch - 42ms/step
Epoch 8/50
8543/8543 - 356s - loss: 3.2516 - accuracy500: 0.3932 - val_loss: 3.3339 - val_accuracy500: 0.3470 - 356s/epoch - 42ms/step
Epoch 9/50
8543/8543 - 354s - loss: 3.2474 - accuracy500: 0.3962 - val_loss: 3.3540 - val_accuracy500: 0.3460 - 354s/epoch - 41ms/step
Epoch 10/50
8543/8543 - 355s - loss: 3.2444 - accuracy500: 0.3979 - val_loss: 3.3583 - val_accuracy500: 0.3431 - 355s/epoch - 42ms/step
Epoch 11/50
8543/8543 - 354s - loss: 3.2418 - accuracy500: 0.3994 - val_loss: 3.3525 - val_accuracy500: 0.3452 - 354s/epoch - 41ms/step
Epoch 12/50
8543/8543 - 355s - loss: 3.2389 - accuracy500: 0.4009 - val_loss: 3.3666 - val_accuracy500: 0.3452 - 355s/epoch - 42ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 786s - 786s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973738
{'0': {'precision': 0.38417077906150093, 'recall': 0.20995825237672325, 'f1-score': 0.27152292218645363, 'support': 3520919}, '1': {'precision': 0.2625126802127202, 'recall': 0.0168783693295059, 'f1-score': 0.031717451060572464, 'support': 2529806}, '2': {'precision': 0.37438753291608345, 'recall': 0.7990481761048763, 'f1-score': 0.5098765497474006, 'support': 3494554}, 'accuracy': 0.37445338161409425, 'macro avg': {'precision': 0.34035699739676817, 'recall': 0.34196159927036845, 'f1-score': 0.27103897433147556, 'support': 9545279}, 'weighted avg': {'precision': 0.34834579475599325, 'recall': 0.37445338161409425, 'f1-score': 0.29522870416731944, 'support': 9545279}}
[[ 739246   60730 2720943]
 [ 542007   42699 1945100]
 [ 643011   59226 2792317]]
Evaluating performance on  train set...
8543/8543 - 185s - 185s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996023
{'0': {'precision': 0.36436403831362874, 'recall': 0.2368872269410429, 'f1-score': 0.28711186693834495, 'support': 731939}, '1': {'precision': 0.3374848386237908, 'recall': 0.015910206631856116, 'f1-score': 0.03038782569087153, 'support': 717024}, '2': {'precision': 0.34937494596181995, 'recall': 0.7941923966834609, 'f1-score': 0.4852725595201614, 'support': 737757}, 'accuracy': 0.35245298895148897, 'macro avg': {'precision': 0.3504079409664132, 'recall': 0.3489966100854533, 'f1-score': 0.26759075071645927, 'support': 2186720}, 'weighted avg': {'precision': 0.35049333740788874, 'recall': 0.35245298895148897, 'f1-score': 0.26978781041791927, 'support': 2186720}}
[[173387  11089 547463]
 [161945  11408 543671]
 [140530  11306 585921]]
Evaluating performance on  val set...
3077/3077 - 65s - 65s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994296
{'0': {'precision': 0.3614335044532745, 'recall': 0.26257773086904984, 'f1-score': 0.3041752586726035, 'support': 253921}, '1': {'precision': 0.3685215946843854, 'recall': 0.016596780890323595, 'f1-score': 0.03176307622923535, 'support': 267341}, '2': {'precision': 0.34835679637960004, 'recall': 0.7741652583361249, 'f1-score': 0.4804996536672146, 'support': 265681}, 'accuracy': 0.35173068443330713, 'macro avg': {'precision': 0.3594372985057533, 'recall': 0.3511132566984994, 'f1-score': 0.27214599618968444, 'support': 786943}, 'weighted avg': {'precision': 0.3594266300706998, 'recall': 0.35173068443330713, 'f1-score': 0.27116028340752174, 'support': 786943}}
[[ 66674   3777 183470]
 [ 61623   4437 201281]
 [ 56174   3826 205681]]
testing model out of sample: results/universal/W10/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 450s - 450s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096053
{'0': {'precision': 0.3767253999721703, 'recall': 0.3634377175664005, 'f1-score': 0.36996228607146187, 'support': 1959172}, '1': {'precision': 0.27211608760609046, 'recall': 0.011080642562067713, 'f1-score': 0.021294180200180965, 'support': 1545127}, '2': {'precision': 0.37643237436897986, 'recall': 0.6749062100690008, 'f1-score': 0.4833010999371925, 'support': 1956500}, 'accuracy': 0.37533188824565783, 'macro avg': {'precision': 0.34175795398241354, 'recall': 0.349808190065823, 'f1-score': 0.29151918873627847, 'support': 5460799}, 'weighted avg': {'precision': 0.34702132597477436, 'recall': 0.37533188824565783, 'f1-score': 0.3119141661732066, 'support': 5460799}}
[[ 712037   22562 1224573]
 [ 565221   17121  962785]
 [ 612811   23235 1320454]]
Evaluating performance on  train set...
4055/4055 - 88s - 88s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996554
{'0': {'precision': 0.35619069388847385, 'recall': 0.36249411337497944, 'f1-score': 0.359314760708973, 'support': 352494}, '1': {'precision': 0.33447037701974863, 'recall': 0.011056281398088444, 'f1-score': 0.021404997371769645, 'support': 337003}, '2': {'precision': 0.3518097446405675, 'recall': 0.6749496383444019, 'f1-score': 0.46253068410413245, 'support': 347983}, 'accuracy': 0.35313837375178314, 'macro avg': {'precision': 0.3474902718495967, 'recall': 0.3495000110391566, 'f1-score': 0.2810834807282917, 'support': 1037480}, 'weighted avg': {'precision': 0.34766589552335336, 'recall': 0.35313837375178314, 'f1-score': 0.2841718979038011, 'support': 1037480}}
[[127777   3787 220930]
 [121470   3726 211807]
 [109485   3627 234871]]
Evaluating performance on  val set...
1545/1545 - 33s - 33s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016315
{'0': {'precision': 0.32915034892399075, 'recall': 0.34292585170340684, 'f1-score': 0.3358969225152226, 'support': 124750}, '1': {'precision': 0.30369026013309136, 'recall': 0.010819587332605322, 'f1-score': 0.020894756193158566, 'support': 139192}, '2': {'precision': 0.3497797865179344, 'recall': 0.6943487855348457, 'f1-score': 0.4652093170784114, 'support': 130963}, 'accuracy': 0.3424114660487965, 'macro avg': {'precision': 0.32754013185833886, 'recall': 0.34936474152361924, 'f1-score': 0.27400033192893086, 'support': 394905}, 'weighted avg': {'precision': 0.32701781668619373, 'recall': 0.3424114660487965, 'f1-score': 0.26775232468657556, 'support': 394905}}
[[42780  1688 80282]
 [48927  1506 88759]
 [38264  1765 90934]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024387
{'0': {'precision': 0.4135861410448779, 'recall': 0.22947097555437826, 'f1-score': 0.29517133956386293, 'support': 52852}, '1': {'precision': 0.24247635425623387, 'recall': 0.015666231493569622, 'f1-score': 0.02943094946121533, 'support': 36001}, '2': {'precision': 0.33839144215530903, 'recall': 0.7807665059304797, 'f1-score': 0.4721490909844731, 'support': 43757}, 'accuracy': 0.3533368524244024, 'macro avg': {'precision': 0.33148464581880693, 'recall': 0.34196790432614255, 'f1-score': 0.2655837933365171, 'support': 132610}, 'weighted avg': {'precision': 0.3423213957504896, 'recall': 0.3533368524244024, 'f1-score': 0.2814249832168772, 'support': 132610}}
[[12128  1011 39713]
 [ 8354   564 27083]
 [ 8842   751 34164]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052573
{'0': {'precision': 0.3297570211423162, 'recall': 0.26758279276203484, 'f1-score': 0.2954341987466428, 'support': 11716}, '1': {'precision': 0.30652503793626706, 'recall': 0.017853986211773025, 'f1-score': 0.03374258748851583, 'support': 11314}, '2': {'precision': 0.32996646934635926, 'recall': 0.7058354733020455, 'f1-score': 0.449703808180536, 'support': 11293}, 'accuracy': 0.3294583806776797, 'macro avg': {'precision': 0.3220828428083142, 'recall': 0.3304240840919512, 'f1-score': 0.25962686480523156, 'support': 34323}, 'weighted avg': {'precision': 0.32216790132688683, 'recall': 0.3294583806776797, 'f1-score': 0.2599299540583145, 'support': 34323}}
[[3135  226 8355]
 [3281  202 7831]
 [3091  231 7971]]
Evaluating performance on  val set...
46/46 - 1s - 739ms/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016699
{'0': {'precision': 0.4033134869272586, 'recall': 0.3375947995666306, 'f1-score': 0.3675395140363294, 'support': 4615}, '1': {'precision': 0.2538860103626943, 'recall': 0.02943826975067588, 'f1-score': 0.052759084791386274, 'support': 3329}, '2': {'precision': 0.3258442082604601, 'recall': 0.6479400749063671, 'f1-score': 0.4336227732521708, 'support': 3738}, 'accuracy': 0.3490840609484677, 'macro avg': {'precision': 0.327681235183471, 'recall': 0.3383243814078912, 'f1-score': 0.2846404573599622, 'support': 11682}, 'weighted avg': {'precision': 0.33594281126042697, 'recall': 0.3490840609484677, 'f1-score': 0.2989823469410032, 'support': 11682}}
[[1558  149 2908]
 [1128   98 2103]
 [1177  139 2422]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919902
{'0': {'precision': 0.3918515416369797, 'recall': 0.40547370079803696, 'f1-score': 0.3985462551410735, 'support': 177686}, '1': {'precision': 0.23284005037783376, 'recall': 0.01484060646805607, 'f1-score': 0.027902764807425644, 'support': 99659}, '2': {'precision': 0.42156066564085026, 'recall': 0.6112631829027693, 'f1-score': 0.4989902482007868, 'support': 193622}, 'accuracy': 0.40741708017759204, 'macro avg': {'precision': 0.348750752551888, 'recall': 0.3438591633896208, 'f1-score': 0.308479756049762, 'support': 470967}, 'weighted avg': {'precision': 0.37041779744785863, 'recall': 0.40741708017759204, 'f1-score': 0.36141033525931276, 'support': 470967}}
[[ 72047   2255 103384]
 [ 39166   1479  59014]
 [ 72650   2618 118354]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0900831
{'0': {'precision': 0.37290462550212716, 'recall': 0.49487156417292727, 'f1-score': 0.4253167982833448, 'support': 44458}, '1': {'precision': 0.36226203807390817, 'recall': 0.014455516332275794, 'f1-score': 0.027801650051564108, 'support': 44758}, '2': {'precision': 0.3856813552053179, 'recall': 0.6231027389845187, 'f1-score': 0.47645300949495445, 'support': 46185}, 'accuracy': 0.37980517130597263, 'macro avg': {'precision': 0.37361600626045105, 'recall': 0.37747660649657394, 'f1-score': 0.30985715260995444, 'support': 135401}, 'weighted avg': {'precision': 0.37374473992690715, 'recall': 0.37980517130597263, 'f1-score': 0.3113571001293441, 'support': 135401}}
[[22001   482 21975]
 [20248   647 23863]
 [16750   657 28778]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0864525
{'0': {'precision': 0.4398045071952213, 'recall': 0.4234549827460002, 'f1-score': 0.43147492075330973, 'support': 19126}, '1': {'precision': 0.2694300518134715, 'recall': 0.007136975020587428, 'f1-score': 0.013905602353255784, 'support': 14572}, '2': {'precision': 0.40010501443948543, 'recall': 0.7075938918695832, 'f1-score': 0.5111711543836764, 'support': 19384}, 'accuracy': 0.41292716928525675, 'macro avg': {'precision': 0.3697798578160594, 'recall': 0.3793952832120569, 'f1-score': 0.318850559163414, 'support': 53082}, 'weighted avg': {'precision': 0.3785364402158301, 'recall': 0.41292716928525675, 'f1-score': 0.3459470899437216, 'support': 53082}}
[[ 8099   155 10872]
 [ 4775   104  9693]
 [ 5541   127 13716]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078339
{'0': {'precision': 0.3772355106721117, 'recall': 0.1848890291156838, 'f1-score': 0.24815393166238783, 'support': 101423}, '1': {'precision': 0.2548262548262548, 'recall': 0.007144072121109032, 'f1-score': 0.013898498841791763, 'support': 64669}, '2': {'precision': 0.328532729304091, 'recall': 0.7906736896386607, 'f1-score': 0.4641899489663524, 'support': 81447}, 'accuracy': 0.33777303778394513, 'macro avg': {'precision': 0.3201981649341525, 'recall': 0.32756893029181783, 'f1-score': 0.24208079315684397, 'support': 247539}, 'weighted avg': {'precision': 0.3292318441776324, 'recall': 0.33777303778394513, 'f1-score': 0.2580369033003151, 'support': 247539}}
[[18752   672 81999]
 [14587   462 49620]
 [16370   679 64398]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998287
{'0': {'precision': 0.3132390920212043, 'recall': 0.25796160519393296, 'f1-score': 0.2829256315030232, 'support': 17867}, '1': {'precision': 0.3268206039076377, 'recall': 0.010433204808346563, 'f1-score': 0.020220891257761414, 'support': 17636}, '2': {'precision': 0.37398750853908463, 'recall': 0.7383200077063866, 'f1-score': 0.49648582995951424, 'support': 20762}, 'accuracy': 0.35762907669066024, 'macro avg': {'precision': 0.33801573482264224, 'recall': 0.33557160590288876, 'f1-score': 0.26654411757343294, 'support': 56265}, 'weighted avg': {'precision': 0.33991255096323525, 'recall': 0.35762907669066024, 'f1-score': 0.27938659375998987, 'support': 56265}}
[[ 4609   178 13080]
 [ 4873   184 12579]
 [ 5232   201 15329]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1088964
{'0': {'precision': 0.28672150411280845, 'recall': 0.17476006302821945, 'f1-score': 0.21715913136347453, 'support': 6981}, '1': {'precision': 0.3217391304347826, 'recall': 0.005933290570878769, 'f1-score': 0.011651708392379154, 'support': 6236}, '2': {'precision': 0.33933933933933935, 'recall': 0.780570252792475, 'f1-score': 0.4730349588065018, 'support': 6804}, 'accuracy': 0.3280555416812347, 'macro avg': {'precision': 0.3159333246289768, 'recall': 0.32042120213052444, 'f1-score': 0.23394859952078517, 'support': 20021}, 'weighted avg': {'precision': 0.31551035924617576, 'recall': 0.3280555416812347, 'f1-score': 0.24010677834787125, 'support': 20021}}
[[1220   28 5733]
 [1592   37 4607]
 [1443   50 5311]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1588/1588 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102822
{'0': {'precision': 0.3548200607024136, 'recall': 0.0344088131412233, 'f1-score': 0.06273397472753524, 'support': 142696}, '1': {'precision': 0.3009329837185194, 'recall': 0.04019711655942006, 'f1-score': 0.07092096659457207, 'support': 122770}, '2': {'precision': 0.3458033394584216, 'recall': 0.9234412725465133, 'f1-score': 0.5031797225215673, 'support': 140820}, 'accuracy': 0.3442993359357694, 'macro avg': {'precision': 0.33385212795978486, 'recall': 0.33268240074905225, 'f1-score': 0.21227822128122487, 'support': 406286}, 'weighted avg': {'precision': 0.33541143936943235, 'recall': 0.3442993359357694, 'f1-score': 0.21786776519994064, 'support': 406286}}
[[  4910   5822 131964]
 [  3789   4935 114046]
 [  5139   5642 130039]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993661
{'0': {'precision': 0.33188976377952756, 'recall': 0.0353904282115869, 'f1-score': 0.06396054628224583, 'support': 23820}, '1': {'precision': 0.33029908972691807, 'recall': 0.04088531187122736, 'f1-score': 0.07276373272219437, 'support': 24850}, '2': {'precision': 0.3566133325700547, 'recall': 0.929082774049217, 'f1-score': 0.5153990940492688, 'support': 26820}, 'accuracy': 0.35470923301099483, 'macro avg': {'precision': 0.3396007286921668, 'recall': 0.33511950471067714, 'f1-score': 0.21737445768456964, 'support': 75490}, 'weighted avg': {'precision': 0.34014990240390947, 'recall': 0.35470923301099483, 'f1-score': 0.22724496851226672, 'support': 75490}}
[[  843  1015 21962]
 [  840  1016 22994]
 [  857  1045 24918]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032842
{'0': {'precision': 0.29136690647482016, 'recall': 0.03198736301707967, 'f1-score': 0.05764611689351481, 'support': 10129}, '1': {'precision': 0.35522388059701493, 'recall': 0.03952503529021008, 'f1-score': 0.07113502204289023, 'support': 12043}, '2': {'precision': 0.3340560481522232, 'recall': 0.9231801108925058, 'f1-score': 0.490590248075278, 'support': 11182}, 'accuracy': 0.3334832403909576, 'macro avg': {'precision': 0.3268822784080194, 'recall': 0.3315641697332652, 'f1-score': 0.20645712900389435, 'support': 33354}, 'weighted avg': {'precision': 0.3287351238277707, 'recall': 0.3334832403909576, 'f1-score': 0.20766195186348552, 'support': 33354}}
[[  324   407  9398]
 [  386   476 11181]
 [  402   457 10323]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975242
{'0': {'precision': 0.3793152990435532, 'recall': 0.17881348962541183, 'f1-score': 0.24305032697574563, 'support': 206707}, '1': {'precision': 0.2354957805907173, 'recall': 0.013656209140331695, 'f1-score': 0.025815403961927337, 'support': 130783}, '2': {'precision': 0.3794267103080965, 'recall': 0.8180891326944214, 'f1-score': 0.5184146333776655, 'support': 201071}, 'accuracy': 0.37737972114579404, 'macro avg': {'precision': 0.33141259664745565, 'recall': 0.336852943820055, 'f1-score': 0.26242678810511283, 'support': 538561}, 'weighted avg': {'precision': 0.34443207038896395, 'recall': 0.37737972114579404, 'f1-score': 0.2931043440991991, 'support': 538561}}
[[ 36962   2830 166915]
 [ 26873   1786 102124]
 [ 33609   2968 164494]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043084
{'0': {'precision': 0.3079630444346678, 'recall': 0.15402387370042356, 'f1-score': 0.20534633860144474, 'support': 36358}, '1': {'precision': 0.3160569105691057, 'recall': 0.008634092171016102, 'f1-score': 0.0168089936223111, 'support': 36020}, '2': {'precision': 0.3432455771317229, 'recall': 0.8353270826597694, 'f1-score': 0.48655859135920654, 'support': 37116}, 'accuracy': 0.3371417611923941, 'macro avg': {'precision': 0.32242184404516544, 'recall': 0.3326616828437364, 'f1-score': 0.23623797452765413, 'support': 109494}, 'weighted avg': {'precision': 0.3225856497075261, 'recall': 0.3371417611923941, 'f1-score': 0.23864824379450275, 'support': 109494}}
[[ 5600   337 30421]
 [ 6808   311 28901]
 [ 5776   336 31004]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988476
{'0': {'precision': 0.35107939992682036, 'recall': 0.15662748938948742, 'f1-score': 0.21661587086578618, 'support': 12252}, '1': {'precision': 0.30269058295964124, 'recall': 0.012384184937161728, 'f1-score': 0.02379483563937605, 'support': 10901}, '2': {'precision': 0.36382120595980133, 'recall': 0.8554075235109718, 'f1-score': 0.5105119150627908, 'support': 12760}, 'accuracy': 0.36112271322362377, 'macro avg': {'precision': 0.33919706294875435, 'recall': 0.3414730659458736, 'f1-score': 0.250307540522651, 'support': 35913}, 'weighted avg': {'precision': 0.3409187046694377, 'recall': 0.36112271322362377, 'f1-score': 0.26250931944849115, 'support': 35913}}
[[ 1919   156 10177]
 [ 1857   135  8909]
 [ 1690   155 10915]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
5267/5267 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929382
{'0': {'precision': 0.38261993699294283, 'recall': 0.5133686100434869, 'f1-score': 0.4384544107816753, 'support': 443352}, '1': {'precision': 0.3193770543120989, 'recall': 0.009048319043596447, 'f1-score': 0.017598064687225773, 'support': 451023}, '2': {'precision': 0.37193355811909146, 'recall': 0.6069402883119516, 'f1-score': 0.46122687171741444, 'support': 453814}, 'accuracy': 0.3761505248893145, 'macro avg': {'precision': 0.3579768498080444, 'recall': 0.3764524057996783, 'f1-score': 0.3057597823954385, 'support': 1348189}, 'weighted avg': {'precision': 0.35786552717531317, 'recall': 0.3761505248893145, 'f1-score': 0.3053266147549569, 'support': 1348189}}
[[227603   4249 211500]
 [193323   4081 253619]
 [173928   4448 275438]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0873809
{'0': {'precision': 0.3973884986387927, 'recall': 0.5284895350266513, 'f1-score': 0.45365729660769016, 'support': 89489}, '1': {'precision': 0.3346656976744186, 'recall': 0.010267672995239634, 'f1-score': 0.019924067884609143, 'support': 89699}, '2': {'precision': 0.3919624880433983, 'recall': 0.6364159652457236, 'f1-score': 0.48513498969259944, 'support': 92075}, 'accuracy': 0.3937617736292823, 'macro avg': {'precision': 0.3746722281188699, 'recall': 0.3917243910892048, 'f1-score': 0.31957211806163294, 'support': 271263}, 'weighted avg': {'precision': 0.37480608802888893, 'recall': 0.3937617736292823, 'f1-score': 0.3209184848551156, 'support': 271263}}
[[47294   838 41357]
 [39234   921 49544]
 [32484   993 58598]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0885903
{'0': {'precision': 0.377611489391369, 'recall': 0.4938605555893259, 'f1-score': 0.4279825635757839, 'support': 32902}, '1': {'precision': 0.30818278427205104, 'recall': 0.00872836719337848, 'f1-score': 0.016975940993970616, 'support': 33225}, '2': {'precision': 0.39946831779789344, 'recall': 0.6368733066874112, 'f1-score': 0.4909784620475014, 'support': 37279}, 'accuracy': 0.38954219290950237, 'macro avg': {'precision': 0.36175419715377116, 'recall': 0.37982074315670517, 'f1-score': 0.31197898887241865, 'support': 103406}, 'weighted avg': {'precision': 0.3631832355045296, 'recall': 0.38954219290950237, 'f1-score': 0.3186342575185571, 'support': 103406}}
[[16249   309 16344]
 [13587   290 19348]
 [13195   342 23742]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
10110/10110 - 126s - 126s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0926303
{'0': {'precision': 0.39388925165722233, 'recall': 0.4138956925541113, 'f1-score': 0.4036447219586574, 'support': 941486}, '1': {'precision': 0.26785186644341574, 'recall': 0.015897489108656224, 'f1-score': 0.030013616215850813, 'support': 684259}, '2': {'precision': 0.39611008463062425, 'recall': 0.641355174176708, 'f1-score': 0.48974604241394404, 'support': 962356}, 'accuracy': 0.39324856332886543, 'macro avg': {'precision': 0.35261706757708744, 'recall': 0.3570494519464918, 'f1-score': 0.30780146019615073, 'support': 2588101}, 'weighted avg': {'precision': 0.36139245835894573, 'recall': 0.39324856332886543, 'f1-score': 0.3368774959360257, 'support': 2588101}}
[[389677  14420 537389]
 [269799  10878 403582]
 [329830  15314 617212]]
Evaluating performance on  train set...
1686/1686 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969578
{'0': {'precision': 0.3706678097303294, 'recall': 0.39828499437814113, 'f1-score': 0.38398046206689396, 'support': 147638}, '1': {'precision': 0.3197278911564626, 'recall': 0.01497508979260804, 'f1-score': 0.028610165739741567, 'support': 138096}, '2': {'precision': 0.35960474664304853, 'recall': 0.6570552820329965, 'f1-score': 0.4648165395735103, 'support': 145834}, 'accuracy': 0.3630737218700182, 'macro avg': {'precision': 0.35000014917661354, 'recall': 0.3567717887345819, 'f1-score': 0.29246905579338195, 'support': 431568}, 'weighted avg': {'precision': 0.3506293227765997, 'recall': 0.3630737218700182, 'f1-score': 0.2975825643671235, 'support': 431568}}
[[58802  2291 86545]
 [51932  2068 84096]
 [47904  2109 95821]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945655
{'0': {'precision': 0.3616024256902651, 'recall': 0.39045241087373506, 'f1-score': 0.37547405328478184, 'support': 60476}, '1': {'precision': 0.2705685618729097, 'recall': 0.014819292557381254, 'f1-score': 0.028099546725482365, 'support': 54591}, '2': {'precision': 0.3857906049606236, 'recall': 0.661943164950189, 'f1-score': 0.4874739392573393, 'support': 65347}, 'accuracy': 0.37512609886150744, 'macro avg': {'precision': 0.3393205308412661, 'recall': 0.3557382894604351, 'f1-score': 0.2970158464225345, 'support': 180414}, 'weighted avg': {'precision': 0.3428178263306082, 'recall': 0.37512609886150744, 'f1-score': 0.3109299206845956, 'support': 180414}}
[[23613  1036 35827]
 [20742   809 33040]
 [20946  1145 43256]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
6546/6546 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975041
{'0': {'precision': 0.3842242696128703, 'recall': 0.3720151019186389, 'f1-score': 0.3780211298181292, 'support': 621378}, '1': {'precision': 0.2675078134043292, 'recall': 0.01039499636782364, 'f1-score': 0.020012339932671593, 'support': 444637}, '2': {'precision': 0.37474665470668717, 'recall': 0.6495307943859326, 'f1-score': 0.4752803891967656, 'support': 609754}, 'accuracy': 0.3770436140064651, 'macro avg': {'precision': 0.34215957924129553, 'recall': 0.34398029755746506, 'f1-score': 0.2911046196491888, 'support': 1675769}, 'weighted avg': {'precision': 0.3498069552105261, 'recall': 0.3770436140064651, 'f1-score': 0.3184188028475627, 'support': 1675769}}
[[231162   6268 383948]
 [163159   4622 276856]
 [207312   6388 396054]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989897
{'0': {'precision': 0.36547464576737426, 'recall': 0.32348995755159043, 'f1-score': 0.34320305303329385, 'support': 108838}, '1': {'precision': 0.32521783700666324, 'recall': 0.012537667341797164, 'f1-score': 0.024144524672507776, 'support': 101215}, '2': {'precision': 0.3489719530328667, 'recall': 0.7149364477591986, 'f1-score': 0.46901174628034453, 'support': 104717}, 'accuracy': 0.35372811894399087, 'macro avg': {'precision': 0.34655481193563475, 'recall': 0.3503213575508621, 'f1-score': 0.2787864413287154, 'support': 314770}, 'weighted avg': {'precision': 0.3470398985748375, 'recall': 0.35372811894399087, 'f1-score': 0.2824628299583961, 'support': 314770}}
[[35208  1382 72248]
 [32527  1269 67419]
 [28600  1251 74866]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0948672
{'0': {'precision': 0.3880373100254387, 'recall': 0.44466314530595974, 'f1-score': 0.4144248743164324, 'support': 40136}, '1': {'precision': 0.34048257372654156, 'recall': 0.01467995954341858, 'f1-score': 0.028146383355957552, 'support': 34605}, '2': {'precision': 0.36649532214286795, 'recall': 0.6246607913576099, 'f1-score': 0.4619560023699853, 'support': 38693}, 'accuracy': 0.37488759983779113, 'macro avg': {'precision': 0.365005068631616, 'recall': 0.3613346320689961, 'f1-score': 0.30150908668079174, 'support': 113434}, 'weighted avg': {'precision': 0.36618181884322126, 'recall': 0.37488759983779113, 'f1-score': 0.3127970974425576, 'support': 113434}}
[[17847   499 21790]
 [14108   508 19989]
 [14038   485 24170]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
7633/7633 - 94s - 94s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982898
{'0': {'precision': 0.3512052173889049, 'recall': 0.38762669330474614, 'f1-score': 0.3685182383636468, 'support': 656704}, '1': {'precision': 0.33317353787152443, 'recall': 0.00552099965841297, 'f1-score': 0.01086200564199142, 'support': 629415}, '2': {'precision': 0.3611927292777606, 'recall': 0.6591172819819455, 'f1-score': 0.4666588926227857, 'support': 667869}, 'accuracy': 0.35733842787161435, 'macro avg': {'precision': 0.3485238281793966, 'recall': 0.35075499164836826, 'f1-score': 0.282013045542808, 'support': 1953988}, 'weighted avg': {'precision': 0.34881059675370457, 'recall': 0.35733842787161435, 'f1-score': 0.286854944065471, 'support': 1953988}}
[[254556   3461 398687]
 [246080   3475 379860]
 [224171   3494 440204]]
Evaluating performance on  train set...
1586/1586 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011848
{'0': {'precision': 0.35090041869627736, 'recall': 0.3987834287154015, 'f1-score': 0.3733127573403058, 'support': 138915}, '1': {'precision': 0.3514309764309764, 'recall': 0.006234274323002605, 'f1-score': 0.012251215951523332, 'support': 133937}, '2': {'precision': 0.3431345003522231, 'recall': 0.6336988073215118, 'f1-score': 0.4452016980090395, 'support': 132978}, 'accuracy': 0.34620407559815686, 'macro avg': {'precision': 0.3484886318264923, 'recall': 0.3462388367866387, 'f1-score': 0.27692189043362286, 'support': 405830}, 'weighted avg': {'precision': 0.3485308674599389, 'recall': 0.34620407559815686, 'f1-score': 0.2777065869814302, 'support': 405830}}
[[55397   767 82751]
 [54538   835 78564]
 [47936   774 84268]]
Evaluating performance on  val set...
574/574 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1097671
{'0': {'precision': 0.28535556645414417, 'recall': 0.35981793895018055, 'f1-score': 0.3182897342479841, 'support': 40426}, '1': {'precision': 0.3990521327014218, 'recall': 0.006564278475091604, 'f1-score': 0.012916091425065194, 'support': 64135}, '2': {'precision': 0.30668986240708523, 'recall': 0.6874320555844401, 'f1-score': 0.42415007400170607, 'support': 42314}, 'accuracy': 0.2999489361702128, 'macro avg': {'precision': 0.3303658538542171, 'recall': 0.3512714243365707, 'f1-score': 0.2517852998915851, 'support': 146875}, 'weighted avg': {'precision': 0.3411490553067188, 'recall': 0.29994893617021273, 'f1-score': 0.2154419782234128, 'support': 146875}}
[[14546   319 25561]
 [23518   421 40196]
 [12911   315 29088]]
testing model on single stock: results/universal/W10/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
22048/22048 - 274s - 274s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984344
{'0': {'precision': 0.3835824504662445, 'recall': 0.0950666422574699, 'f1-score': 0.15237006044328577, 'support': 2135807}, '1': {'precision': 0.2509668748228539, 'recall': 0.01944369870165196, 'f1-score': 0.03609122405643321, 'support': 1411717}, '2': {'precision': 0.3741218162373568, 'recall': 0.8931908893874873, 'f1-score': 0.5273555552645537, 'support': 2096544}, 'accuracy': 0.372622548133722, 'macro avg': {'precision': 0.3362237138421517, 'recall': 0.33590041011553634, 'f1-score': 0.23860561325475757, 'support': 5644068}, 'weighted avg': {'precision': 0.34689786436109316, 'recall': 0.372622548133722, 'f1-score': 0.2625779422737354, 'support': 5644068}}
[[ 203044   42019 1890744]
 [ 142267   27449 1242001]
 [ 184025   39905 1872614]]
Evaluating performance on  train set...
5429/5429 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028837
{'0': {'precision': 0.3418984538593258, 'recall': 0.1463164092888119, 'f1-score': 0.2049317130065089, 'support': 465334}, '1': {'precision': 0.33677554362660356, 'recall': 0.016216796421483368, 'f1-score': 0.03094356342113843, 'support': 456502}, '2': {'precision': 0.3417132080573437, 'recall': 0.8533870416274896, 'f1-score': 0.4880153339203107, 'support': 467960}, 'accuracy': 0.34166165394057835, 'macro avg': {'precision': 0.3401290685144243, 'recall': 0.3386400824459283, 'f1-score': 0.24129687011598602, 'support': 1389796}, 'weighted avg': {'precision': 0.3401533730038954, 'recall': 0.34166165394057835, 'f1-score': 0.24309981320308588, 'support': 1389796}}
[[ 68086   7475 389773]
 [ 69550   7403 379549]
 [ 61505   7104 399351]]
Evaluating performance on  val set...
1890/1890 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1040318
{'0': {'precision': 0.31736661088196927, 'recall': 0.15883609887355898, 'f1-score': 0.21171351339472125, 'support': 151628}, '1': {'precision': 0.3804649987364165, 'recall': 0.017415093466592632, 'f1-score': 0.03330567999557546, 'support': 172896}, '2': {'precision': 0.3336767817218768, 'recall': 0.8384031971245987, 'f1-score': 0.4773661962508653, 'support': 159143}, 'accuracy': 0.33188329987367343, 'macro avg': {'precision': 0.34383613044675415, 'recall': 0.33821812982158345, 'f1-score': 0.24079512988038734, 'support': 483667}, 'weighted avg': {'precision': 0.3452889384016427, 'recall': 0.33188329987367343, 'f1-score': 0.23534705495202538, 'support': 483667}}
[[ 24084   2441 125103]
 [ 28548   3011 141337]
 [ 23255   2462 133426]]
training model: results/universal/W10/deepVOL_L2/h1000
Epoch 1/50
8543/8543 - 357s - loss: 3.2799 - accuracy1000: 0.3674 - val_loss: 3.2931 - val_accuracy1000: 0.3656 - 357s/epoch - 42ms/step
Epoch 2/50
8543/8543 - 350s - loss: 3.2767 - accuracy1000: 0.3703 - val_loss: 3.2925 - val_accuracy1000: 0.3650 - 350s/epoch - 41ms/step
Epoch 3/50
8543/8543 - 354s - loss: 3.2741 - accuracy1000: 0.3734 - val_loss: 3.2893 - val_accuracy1000: 0.3654 - 354s/epoch - 41ms/step
Epoch 4/50
8543/8543 - 355s - loss: 3.2696 - accuracy1000: 0.3794 - val_loss: 3.2885 - val_accuracy1000: 0.3610 - 355s/epoch - 42ms/step
Epoch 5/50
8543/8543 - 355s - loss: 3.2647 - accuracy1000: 0.3840 - val_loss: 3.2962 - val_accuracy1000: 0.3510 - 355s/epoch - 42ms/step
Epoch 6/50
8543/8543 - 355s - loss: 3.2602 - accuracy1000: 0.3882 - val_loss: 3.2980 - val_accuracy1000: 0.3492 - 355s/epoch - 42ms/step
Epoch 7/50
8543/8543 - 354s - loss: 3.2548 - accuracy1000: 0.3927 - val_loss: 3.3020 - val_accuracy1000: 0.3547 - 354s/epoch - 41ms/step
Epoch 8/50
8543/8543 - 354s - loss: 3.2519 - accuracy1000: 0.3954 - val_loss: 3.3042 - val_accuracy1000: 0.3546 - 354s/epoch - 41ms/step
Epoch 9/50
8543/8543 - 354s - loss: 3.2478 - accuracy1000: 0.3974 - val_loss: 3.3048 - val_accuracy1000: 0.3484 - 354s/epoch - 41ms/step
Epoch 10/50
8543/8543 - 356s - loss: 3.2453 - accuracy1000: 0.3989 - val_loss: 3.3063 - val_accuracy1000: 0.3481 - 356s/epoch - 42ms/step
Epoch 11/50
8543/8543 - 356s - loss: 3.2417 - accuracy1000: 0.4013 - val_loss: 3.3051 - val_accuracy1000: 0.3486 - 356s/epoch - 42ms/step
Epoch 12/50
8543/8543 - 355s - loss: 3.2389 - accuracy1000: 0.4022 - val_loss: 3.3088 - val_accuracy1000: 0.3492 - 355s/epoch - 42ms/step
Epoch 13/50
8543/8543 - 355s - loss: 3.2358 - accuracy1000: 0.4042 - val_loss: 3.3056 - val_accuracy1000: 0.3508 - 355s/epoch - 42ms/step
Epoch 14/50
8543/8543 - 354s - loss: 3.2333 - accuracy1000: 0.4050 - val_loss: 3.3039 - val_accuracy1000: 0.3535 - 354s/epoch - 41ms/step
testing model in sample: results/universal/W10/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 768s - 768s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107369
{'0': {'precision': 0.36940026123902114, 'recall': 0.17354006457181292, 'f1-score': 0.23614287663207906, 'support': 3391263}, '1': {'precision': 0.2973199165860335, 'recall': 0.835910617882863, 'f1-score': 0.43862721242115277, 'support': 2795190}, '2': {'precision': 0.3612436607964393, 'recall': 0.010052321852933139, 'f1-score': 0.019560338464996586, 'support': 3358826}, 'accuracy': 0.30997658633131625, 'macro avg': {'precision': 0.3426546128738313, 'recall': 0.33983433476920305, 'f1-score': 0.23144347583940947, 'support': 9545279}, 'weighted avg': {'precision': 0.34542245396814514, 'recall': 0.30997658633131625, 'f1-score': 0.21922552201234213, 'support': 9545279}}
[[ 588520 2770579   32164]
 [ 431123 2336529   27538]
 [ 573534 2751528   33764]]
Evaluating performance on  train set...
8543/8543 - 183s - 183s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028358
{'0': {'precision': 0.34231996949068055, 'recall': 0.1568674668952772, 'f1-score': 0.21514510409333767, 'support': 726709}, '1': {'precision': 0.3322248625776003, 'recall': 0.832005254243147, 'f1-score': 0.4748422623005024, 'support': 723225}, '2': {'precision': 0.35950403500929345, 'recall': 0.02073872196268659, 'f1-score': 0.03921523337298486, 'support': 736786}, 'accuracy': 0.33429245628155413, 'macro avg': {'precision': 0.3446829556925248, 'recall': 0.33653714770037024, 'f1-score': 0.2430675332556083, 'support': 2186720}, 'weighted avg': {'precision': 0.3447711041581205, 'recall': 0.33429245628155413, 'f1-score': 0.24175885048785134, 'support': 2186720}}
[[113997 599618  13094]
 [107369 601727  14129]
 [111647 609859  15280]]
Evaluating performance on  val set...
3077/3077 - 64s - 64s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965164
{'0': {'precision': 0.3182051482805717, 'recall': 0.1515903769245115, 'f1-score': 0.20535248115066554, 'support': 241295}, '1': {'precision': 0.36861086436832746, 'recall': 0.8405921982981769, 'f1-score': 0.5124886404318012, 'support': 287809}, '2': {'precision': 0.3707463448892294, 'recall': 0.02252180624343098, 'f1-score': 0.04246404048233651, 'support': 257839}, 'accuracy': 0.3612904619521363, 'macro avg': {'precision': 0.35252078584604285, 'recall': 0.3382347938220398, 'f1-score': 0.2534350540216011, 'support': 786943}, 'weighted avg': {'precision': 0.3538549835721756, 'recall': 0.3612904619521363, 'f1-score': 0.26431171735082626, 'support': 786943}}
[[ 36578 200228   4489]
 [ 40512 241930   5367]
 [ 37861 214171   5807]]
testing model out of sample: results/universal/W10/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 456s - 456s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.119759
{'0': {'precision': 0.37414266441503063, 'recall': 0.17235281619408174, 'f1-score': 0.23599295569073936, 'support': 2070880}, '1': {'precision': 0.2416925545290573, 'recall': 0.8040473255287304, 'f1-score': 0.37166460947928376, 'support': 1333572}, '2': {'precision': 0.37024039554444194, 'recall': 0.012672472107090875, 'f1-score': 0.024506155221323243, 'support': 2056347}, 'accuracy': 0.26648774291088173, 'macro avg': {'precision': 0.3286918714961766, 'recall': 0.3296908712766343, 'f1-score': 0.2107212401304488, 'support': 5460799}, 'weighted avg': {'precision': 0.34032780017518477, 'recall': 0.26648774291088173, 'f1-score': 0.18948651423431775, 'support': 5460799}}
[[ 356922 1686328   27630]
 [ 244622 1072255   16695]
 [ 352429 1677859   26059]]
Evaluating performance on  train set...
4055/4055 - 88s - 88s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102234
{'0': {'precision': 0.3372833585973568, 'recall': 0.16689434882427595, 'f1-score': 0.22329700688370957, 'support': 350635}, '1': {'precision': 0.3344294040277363, 'recall': 0.8222701107864974, 'f1-score': 0.4754757818746258, 'support': 345710}, '2': {'precision': 0.35690259786731554, 'recall': 0.014618845911442684, 'f1-score': 0.02808722980051139, 'support': 341135}, 'accuracy': 0.3352093534333192, 'macro avg': {'precision': 0.3428717868308029, 'recall': 0.334594435174072, 'f1-score': 0.24228667285294891, 'support': 1037480}, 'weighted avg': {'precision': 0.34278338611990555, 'recall': 0.3352093534333192, 'f1-score': 0.24314108773040816, 'support': 1037480}}
[[ 58519 287222   4894]
 [ 57351 284267   4092]
 [ 57631 278517   4987]]
Evaluating performance on  val set...
1545/1545 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009008
{'0': {'precision': 0.31721698113207547, 'recall': 0.17136077335308122, 'f1-score': 0.2225174875790366, 'support': 125583}, '1': {'precision': 0.3441777899156795, 'recall': 0.8143002944351031, 'f1-score': 0.4838487312833758, 'support': 136193}, '2': {'precision': 0.3742255266418835, 'recall': 0.013610858640867128, 'f1-score': 0.026266389313696355, 'support': 133129}, 'accuracy': 0.33991466302022005, 'macro avg': {'precision': 0.34520676589654614, 'recall': 0.33309064214301715, 'f1-score': 0.2442108693920363, 'support': 394905}, 'weighted avg': {'precision': 0.34573362206050284, 'recall': 0.33991466302022005, 'f1-score': 0.2464847040307366, 'support': 394905}}
[[ 21520 102499   1564]
 [ 23825 110902   1466]
 [ 22495 108822   1812]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104717
{'0': {'precision': 0.40643618360325584, 'recall': 0.18169711520426154, 'f1-score': 0.2511277025976046, 'support': 53314}, '1': {'precision': 0.2951839676083282, 'recall': 0.8088452338541402, 'f1-score': 0.4325214314872772, 'support': 39298}, '2': {'precision': 0.21937842778793418, 'recall': 0.00600030001500075, 'f1-score': 0.011681105811350142, 'support': 39998}, 'accuracy': 0.31455395520699797, 'macro avg': {'precision': 0.30699952633317273, 'recall': 0.3321808830244675, 'f1-score': 0.23177674663207734, 'support': 132610}, 'weighted avg': {'precision': 0.3170468034564351, 'recall': 0.31455395520699797, 'f1-score': 0.23266020979653187, 'support': 132610}}
[[ 9687 43148   479]
 [ 7137 31786   375]
 [ 7010 32748   240]]
Evaluating performance on  train set...
135/135 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032667
{'0': {'precision': 0.3369327501366867, 'recall': 0.21290378303679391, 'f1-score': 0.2609293955753149, 'support': 11578}, '1': {'precision': 0.33112384376287307, 'recall': 0.7844911720344246, 'f1-score': 0.46568704903354924, 'support': 11271}, '2': {'precision': 0.41776315789473684, 'recall': 0.011068502701760501, 'f1-score': 0.02156563083715401, 'support': 11474}, 'accuracy': 0.33312938845671997, 'macro avg': {'precision': 0.3619399172647655, 'recall': 0.33615448592432634, 'f1-score': 0.2493940251486727, 'support': 34323}, 'weighted avg': {'precision': 0.36204640322285675, 'recall': 0.33312938845671997, 'f1-score': 0.24814973399334658, 'support': 34323}}
[[2465 9015   98]
 [2350 8842   79]
 [2501 8846  127]]
Evaluating performance on  val set...
46/46 - 1s - 734ms/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003054
{'0': {'precision': 0.40246493837654057, 'recall': 0.20405085110967464, 'f1-score': 0.2708035458964827, 'support': 4641}, '1': {'precision': 0.3169945178974524, 'recall': 0.7836832314642572, 'f1-score': 0.45140058166232966, 'support': 3763}, '2': {'precision': 0.2692307692307692, 'recall': 0.0021354484441732766, 'f1-score': 0.004237288135593221, 'support': 3278}, 'accuracy': 0.33410374935798665, 'macro avg': {'precision': 0.32956340850158744, 'recall': 0.32995651033936835, 'f1-score': 0.24214713856480186, 'support': 11682}, 'weighted avg': {'precision': 0.33754739012087825, 'recall': 0.33410374935798665, 'f1-score': 0.2541781780353875, 'support': 11682}}
[[ 947 3681   13]
 [ 808 2949    6]
 [ 598 2673    7]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
1840/1840 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173668
{'0': {'precision': 0.361511089806228, 'recall': 0.12232293804625165, 'f1-score': 0.18279449602863854, 'support': 160297}, '1': {'precision': 0.28774825032226115, 'recall': 0.8867053666272685, 'f1-score': 0.4344963719573102, 'support': 133678}, '2': {'precision': 0.38123044838373304, 'recall': 0.01032815042487796, 'f1-score': 0.02011144911352297, 'support': 176992}, 'accuracy': 0.29719492023857297, 'macro avg': {'precision': 0.34349659617074074, 'recall': 0.33978548503279943, 'f1-score': 0.21246743903315723, 'support': 470967}, 'weighted avg': {'precision': 0.3479850887420602, 'recall': 0.29719492023857297, 'f1-score': 0.19309968838987154, 'support': 470967}}
[[ 19608 139181   1508]
 [ 13686 118533   1459]
 [ 20945 154219   1828]]
Evaluating performance on  train set...
529/529 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063988
{'0': {'precision': 0.3506066081569437, 'recall': 0.12125878808168732, 'f1-score': 0.1801960166498068, 'support': 44805}, '1': {'precision': 0.33136199060812005, 'recall': 0.8809997096464387, 'f1-score': 0.48158865040412185, 'support': 44773}, '2': {'precision': 0.37644341801385683, 'recall': 0.00711433123104118, 'f1-score': 0.013964745443252158, 'support': 45823}, 'accuracy': 0.3338527780444753, 'macro avg': {'precision': 0.35280400559297354, 'recall': 0.33645760965305566, 'f1-score': 0.22524980416572693, 'support': 135401}, 'weighted avg': {'precision': 0.35298680384648695, 'recall': 0.3338527780444753, 'f1-score': 0.22360069497998158, 'support': 135401}}
[[ 5433 39059   313]
 [ 5101 39445   227]
 [ 4962 40535   326]]
Evaluating performance on  val set...
208/208 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1037635
{'0': {'precision': 0.35387149917627675, 'recall': 0.12431274958041554, 'f1-score': 0.1839907490684826, 'support': 17279}, '1': {'precision': 0.33253229197957346, 'recall': 0.8837819343065694, 'f1-score': 0.48324031056094296, 'support': 17536}, '2': {'precision': 0.43103448275862066, 'recall': 0.009580117151146877, 'f1-score': 0.018743640550527498, 'support': 18267}, 'accuracy': 0.33572585810632605, 'macro avg': {'precision': 0.37247942463815703, 'recall': 0.3392249336793773, 'f1-score': 0.22865823339331767, 'support': 53082}, 'weighted avg': {'precision': 0.37337588642048924, 'recall': 0.33572585810632605, 'f1-score': 0.22598372934492847, 'support': 53082}}
[[ 2148 15007   124]
 [ 1931 15498   107]
 [ 1991 16101   175]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
967/967 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108787
{'0': {'precision': 0.41128592215351034, 'recall': 0.17272163078245095, 'f1-score': 0.24327759062392837, 'support': 104735}, '1': {'precision': 0.253513031114338, 'recall': 0.7983867126093653, 'f1-score': 0.38483027821361604, 'support': 62977}, '2': {'precision': 0.3190348525469169, 'recall': 0.02087013165971413, 'f1-score': 0.03917741537231478, 'support': 79827}, 'accuracy': 0.28292915459786133, 'macro avg': {'precision': 0.3279446019382551, 'recall': 0.33065949168384345, 'f1-score': 0.22242842806995308, 'support': 247539}, 'weighted avg': {'precision': 0.3413971794000069, 'recall': 0.28292915459786133, 'f1-score': 0.2134716162785735, 'support': 247539}}
[[18090 84311  2334]
 [11475 50280  1222]
 [14419 63742  1666]]
Evaluating performance on  train set...
220/220 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1086553
{'0': {'precision': 0.2969881414629027, 'recall': 0.16358381502890174, 'f1-score': 0.21096574602109658, 'support': 17300}, '1': {'precision': 0.3227732771301236, 'recall': 0.8025109170305676, 'f1-score': 0.4603798399849693, 'support': 18320}, '2': {'precision': 0.3251895534962089, 'recall': 0.01869702107047711, 'f1-score': 0.03536093807255405, 'support': 20645}, 'accuracy': 0.3184573002754821, 'macro avg': {'precision': 0.3149836573630784, 'recall': 0.32826391770998214, 'f1-score': 0.23556884135953995, 'support': 56265}, 'weighted avg': {'precision': 0.3157316203014541, 'recall': 0.3184573002754821, 'f1-score': 0.22774180469559205, 'support': 56265}}
[[ 2830 14129   341]
 [ 3158 14702   460]
 [ 3541 16718   386]]
Evaluating performance on  val set...
79/79 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031021
{'0': {'precision': 0.32760699216395417, 'recall': 0.1608702086724878, 'f1-score': 0.2157816377171216, 'support': 6757}, '1': {'precision': 0.3329225460595231, 'recall': 0.8079856437864513, 'f1-score': 0.47154826322220283, 'support': 6687}, '2': {'precision': 0.31223628691983124, 'recall': 0.022502660787593127, 'f1-score': 0.04197986101262233, 'support': 6577}, 'accuracy': 0.33155187053593727, 'macro avg': {'precision': 0.32425527504776946, 'recall': 0.3304528377488441, 'f1-score': 0.24310325398398225, 'support': 20021}, 'weighted avg': {'precision': 0.3243330288508865, 'recall': 0.33155187053593727, 'f1-score': 0.24411274702070215, 'support': 20021}}
[[1087 5479  191]
 [1149 5403  135]
 [1082 5347  148]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1588/1588 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050594
{'0': {'precision': 0.35390149735928605, 'recall': 0.21489540796805542, 'f1-score': 0.267412870721446, 'support': 143749}, '1': {'precision': 0.3085504773614021, 'recall': 0.7914799469005189, 'f1-score': 0.4440086565823651, 'support': 124295}, '2': {'precision': 0.4723926380368098, 'recall': 0.0005569942564488361, 'f1-score': 0.001112676565152993, 'support': 138242}, 'accuracy': 0.3183594807598588, 'macro avg': {'precision': 0.37828153758583266, 'recall': 0.3356441163750077, 'f1-score': 0.23751140128965473, 'support': 406286}, 'weighted avg': {'precision': 0.3803448088169914, 'recall': 0.3183594807598588, 'f1-score': 0.23082805550021931, 'support': 406286}}
[[ 30891 112806     52]
 [ 25884  98377     34]
 [ 30512 107653     77]]
Evaluating performance on  train set...
295/295 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052423
{'0': {'precision': 0.30105263157894735, 'recall': 0.20627041703788554, 'f1-score': 0.24480753253946277, 'support': 23571}, '1': {'precision': 0.32846690717825955, 'recall': 0.7855818079187162, 'f1-score': 0.46324298621017596, 'support': 24802}, '2': {'precision': 0.45454545454545453, 'recall': 0.0003687723568241325, 'f1-score': 0.0007369468292862671, 'support': 27117}, 'accuracy': 0.3226387601006756, 'macro avg': {'precision': 0.3613549977675538, 'recall': 0.3307403324378086, 'f1-score': 0.23626248852630835, 'support': 75490}, 'weighted avg': {'precision': 0.36519614388252286, 'recall': 0.3226387601006756, 'f1-score': 0.2289004461603155, 'support': 75490}}
[[ 4862 18704     5]
 [ 5311 19484     7]
 [ 5977 21130    10]]
Evaluating performance on  val set...
131/131 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006193
{'0': {'precision': 0.32198988656553235, 'recall': 0.22794117647058823, 'f1-score': 0.26692346909873677, 'support': 10336}, '1': {'precision': 0.34997309968488205, 'recall': 0.7904009720534629, 'f1-score': 0.48513743873854676, 'support': 11522}, '2': {'precision': 0.4666666666666667, 'recall': 0.0006089074460681977, 'f1-score': 0.0012162279558683, 'support': 11496}, 'accuracy': 0.34388679019008217, 'macro avg': {'precision': 0.37954321763902704, 'recall': 0.3396503519900398, 'f1-score': 0.25109237859771727, 'support': 33354}, 'weighted avg': {'precision': 0.38152178215837845, 'recall': 0.34388679019008217, 'f1-score': 0.2507242400410968, 'support': 33354}}
[[2356 7978    2]
 [2409 9107    6]
 [2552 8937    7]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
2104/2104 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1175555
{'0': {'precision': 0.3879041006725971, 'recall': 0.17198720569490875, 'f1-score': 0.23831247813119621, 'support': 207905}, '1': {'precision': 0.2403704004182667, 'recall': 0.8320929289146851, 'f1-score': 0.37299272625542035, 'support': 128184}, '2': {'precision': 0.34253308128544424, 'recall': 0.004474692797028725, 'f1-score': 0.008833982556297137, 'support': 202472}, 'accuracy': 0.26612398595516573, 'macro avg': {'precision': 0.32360252745876933, 'recall': 0.33618494246887415, 'f1-score': 0.20671306231430453, 'support': 538561}, 'weighted avg': {'precision': 0.3357320702605236, 'recall': 0.26612398595516573, 'f1-score': 0.1840955611422471, 'support': 538561}}
[[ 35757 171061   1087]
 [ 20871 106661    652]
 [ 35552 166014    906]]
Evaluating performance on  train set...
428/428 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022245
{'0': {'precision': 0.3405301144848183, 'recall': 0.1505722460658083, 'f1-score': 0.20881342998855398, 'support': 36348}, '1': {'precision': 0.3373815198110846, 'recall': 0.8450907703211035, 'f1-score': 0.4822404902822389, 'support': 36686}, '2': {'precision': 0.2969260954872466, 'recall': 0.01245200219418541, 'f1-score': 0.023901655742451764, 'support': 36460}, 'accuracy': 0.337278755000274, 'macro avg': {'precision': 0.3249459099277165, 'recall': 0.3360383395270324, 'f1-score': 0.23831852533774822, 'support': 109494}, 'weighted avg': {'precision': 0.3249556366426346, 'recall': 0.337278755000274, 'f1-score': 0.23885217042110043, 'support': 109494}}
[[ 5473 30353   522]
 [ 5130 31003   553]
 [ 5469 30537   454]]
Evaluating performance on  val set...
141/141 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1089195
{'0': {'precision': 0.3213835344982886, 'recall': 0.14639750533398982, 'f1-score': 0.20116141399334725, 'support': 12186}, '1': {'precision': 0.30445322618138343, 'recall': 0.8452106573246059, 'f1-score': 0.44765625, 'support': 10847}, '2': {'precision': 0.3493975903614458, 'recall': 0.006754658385093168, 'f1-score': 0.013253103815979892, 'support': 12880}, 'accuracy': 0.3073817280650461, 'macro avg': {'precision': 0.3250781170137059, 'recall': 0.33278760701456295, 'f1-score': 0.22069025593644234, 'support': 35913}, 'weighted avg': {'precision': 0.32631706790413034, 'recall': 0.3073817280650461, 'f1-score': 0.2082193164542854, 'support': 35913}}
[[ 1784 10324    78]
 [ 1595  9168    84]
 [ 2172 10621    87]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
5267/5267 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0841428
{'0': {'precision': 0.30025147669454355, 'recall': 0.11972358326056709, 'f1-score': 0.17118722560806182, 'support': 385939}, '1': {'precision': 0.4247905890120922, 'recall': 0.8852404637628253, 'f1-score': 0.5740960372238714, 'support': 569774}, '2': {'precision': 0.2786127167630058, 'recall': 0.004912402287018824, 'f1-score': 0.00965457841340424, 'support': 392476}, 'accuracy': 0.4098245869088088, 'macro avg': {'precision': 0.33455159415654717, 'recall': 0.33662548310347046, 'f1-score': 0.2516459470817792, 'support': 1348189}, 'weighted avg': {'precision': 0.3465850799495239, 'recall': 0.4098245869088088, 'f1-score': 0.2944409222256843, 'support': 1348189}}
[[ 46206 337744   1989]
 [ 62384 504387   3003]
 [ 45301 345247   1928]]
Evaluating performance on  train set...
1060/1060 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040696
{'0': {'precision': 0.34234438891412994, 'recall': 0.11818018865810759, 'f1-score': 0.17570538658849394, 'support': 89262}, '1': {'precision': 0.33136650127397077, 'recall': 0.8836440033972554, 'f1-score': 0.4819876382166847, 'support': 89484}, '2': {'precision': 0.42356164383561645, 'recall': 0.008355221202589795, 'f1-score': 0.01638718704288652, 'support': 92517}, 'accuracy': 0.3332337989331387, 'macro avg': {'precision': 0.365757511341239, 'recall': 0.33672647108598425, 'f1-score': 0.22469340394935508, 'support': 271263}, 'weighted avg': {'precision': 0.3664229822939096, 'recall': 0.3332337989331387, 'f1-score': 0.22240441718734474, 'support': 271263}}
[[10549 78270   443]
 [ 9803 79072   609]
 [10462 81282   773]]
Evaluating performance on  val set...
404/404 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0805029
{'0': {'precision': 0.2502067140730941, 'recall': 0.11461252935383683, 'f1-score': 0.15721113881961762, 'support': 26402}, '1': {'precision': 0.4451711430563394, 'recall': 0.8761761630946158, 'f1-score': 0.590379746835443, 'support': 45912}, '2': {'precision': 0.3203371970495258, 'recall': 0.00977743470989322, 'f1-score': 0.01897568740051809, 'support': 31092}, 'accuracy': 0.421223139856488, 'macro avg': {'precision': 0.33857168472631977, 'recall': 0.3335220423861152, 'f1-score': 0.25552219101852625, 'support': 103406}, 'weighted avg': {'precision': 0.3578571776843157, 'recall': 0.421223139856488, 'f1-score': 0.30797241452605567, 'support': 103406}}
[[ 3026 23163   213]
 [ 5253 40227   432]
 [ 3815 26973   304]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
10110/10110 - 124s - 124s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.130187
{'0': {'precision': 0.39844512426364626, 'recall': 0.1537491207548679, 'f1-score': 0.22188057219808846, 'support': 1025027}, '1': {'precision': 0.1985980651232964, 'recall': 0.8339329140785948, 'f1-score': 0.3207990201062197, 'support': 516472}, '2': {'precision': 0.42328330678292947, 'recall': 0.009647411336878775, 'f1-score': 0.018864857593399446, 'support': 1046602}, 'accuracy': 0.2312108375986872, 'macro avg': {'precision': 0.34010883205662407, 'recall': 0.33244314872344716, 'f1-score': 0.18718148329923587, 'support': 2588101}, 'weighted avg': {'precision': 0.3686086847942099, 'recall': 0.2312108375986872, 'f1-score': 0.15952286501869772, 'support': 2588101}}
[[157597 858180   9250]
 [ 81262 430703   4507]
 [156671 879834  10097]]
Evaluating performance on  train set...
1686/1686 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030763
{'0': {'precision': 0.33643858737990134, 'recall': 0.14187552185279986, 'f1-score': 0.19958600105906704, 'support': 146114}, '1': {'precision': 0.33382380693208763, 'recall': 0.8532948364815928, 'f1-score': 0.47990170541111704, 'support': 143042}, '2': {'precision': 0.40912248205603147, 'recall': 0.012407662275650929, 'f1-score': 0.024084890036870192, 'support': 142412}, 'accuracy': 0.33495069143217293, 'macro avg': {'precision': 0.35979495878934015, 'recall': 0.33585934020334784, 'f1-score': 0.23452419883568476, 'support': 431568}, 'weighted avg': {'precision': 0.359556694801677, 'recall': 0.33495069143217293, 'f1-score': 0.23458269858769018, 'support': 431568}}
[[ 20730 124022   1362]
 [ 19795 122057   1190]
 [ 21091 119554   1767]]
Evaluating performance on  val set...
705/705 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053172
{'0': {'precision': 0.3220557666117124, 'recall': 0.15617504953248287, 'f1-score': 0.21034644194756555, 'support': 57538}, '1': {'precision': 0.3271791887638369, 'recall': 0.8415484573255775, 'f1-score': 0.4711741738882011, 'support': 58794}, '2': {'precision': 0.41135303265940903, 'recall': 0.008255048219468805, 'f1-score': 0.016185289438257252, 'support': 64082}, 'accuracy': 0.32698681920471806, 'macro avg': {'precision': 0.3535293293449861, 'recall': 0.33532618502584305, 'f1-score': 0.2325686350913413, 'support': 180414}, 'weighted avg': {'precision': 0.3554432747035484, 'recall': 0.32698681920471806, 'f1-score': 0.22638106618191672, 'support': 180414}}
[[ 8986 48118   434]
 [ 8993 49478   323]
 [ 9923 53630   529]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
6546/6546 - 81s - 81s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964023
{'0': {'precision': 0.3330997624703088, 'recall': 0.15456866779337203, 'f1-score': 0.21115488857659104, 'support': 544360}, '1': {'precision': 0.3639907841626759, 'recall': 0.8504619253719706, 'f1-score': 0.5097939189995466, 'support': 602803}, '2': {'precision': 0.317372996468351, 'recall': 0.008840232611812958, 'f1-score': 0.017201332523512417, 'support': 528606}, 'accuracy': 0.35892476827056713, 'macro avg': {'precision': 0.33815451436711186, 'recall': 0.3379569419257185, 'f1-score': 0.24605004669988337, 'support': 1675769}, 'weighted avg': {'precision': 0.3392509310860268, 'recall': 0.35892476827056713, 'f1-score': 0.25739962159471896, 'support': 1675769}}
[[ 84141 455133   5086]
 [ 85177 512661   4965]
 [ 83282 440651   4673]]
Evaluating performance on  train set...
1230/1230 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004066
{'0': {'precision': 0.348390263054574, 'recall': 0.16665571091849862, 'f1-score': 0.22546036626034593, 'support': 106489}, '1': {'precision': 0.34140482220374635, 'recall': 0.8369919501037939, 'f1-score': 0.48498620265496833, 'support': 106461}, '2': {'precision': 0.3584305408271474, 'recall': 0.00995875073659399, 'f1-score': 0.019379067167388127, 'support': 101820}, 'accuracy': 0.34268831210089906, 'macro avg': {'precision': 0.3494085420284893, 'recall': 0.33786880391962876, 'f1-score': 0.2432752120275675, 'support': 314770}, 'weighted avg': {'precision': 0.34927543020641016, 'recall': 0.34268831210089906, 'f1-score': 0.24657477422413837, 'support': 314770}}
[[17747 87850   892]
 [16431 89107   923]
 [16762 84044  1014]]
Evaluating performance on  val set...
444/444 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0922045
{'0': {'precision': 0.3592468674145509, 'recall': 0.15097044552271724, 'f1-score': 0.21259827234785983, 'support': 36272}, '1': {'precision': 0.37966992363905083, 'recall': 0.8726586459070536, 'f1-score': 0.529129893722018, 'support': 42390}, '2': {'precision': 0.31620553359683795, 'recall': 0.006902105142068331, 'f1-score': 0.01350932988094903, 'support': 34772}, 'accuracy': 0.3765008727542007, 'macro avg': {'precision': 0.3517074415501466, 'recall': 0.3435103988572797, 'f1-score': 0.25174583198360895, 'support': 113434}, 'weighted avg': {'precision': 0.3536850437448138, 'recall': 0.3765008727542007, 'f1-score': 0.26985671974979525, 'support': 113434}}
[[ 5476 30537   259]
 [ 5138 36992   260]
 [ 4629 29903   240]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
7633/7633 - 94s - 94s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1087228
{'0': {'precision': 0.34121747759170673, 'recall': 0.2002797474330746, 'f1-score': 0.252407388527948, 'support': 679899}, '1': {'precision': 0.29849390881208987, 'recall': 0.7721008248656334, 'f1-score': 0.43054086847499545, 'support': 586641}, '2': {'precision': 0.3467808639504789, 'recall': 0.018906157265713187, 'f1-score': 0.03585740357304942, 'support': 687448}, 'accuracy': 0.3081456999735925, 'macro avg': {'precision': 0.3288307501180919, 'recall': 0.33042890985480705, 'f1-score': 0.23960188685866432, 'support': 1953988}, 'weighted avg': {'precision': 0.33034798489938827, 'recall': 0.3081456999735925, 'f1-score': 0.22970179809051477, 'support': 1953988}}
[[136170 529155  14574]
 [123787 452946   9908]
 [139114 535337  12997]]
Evaluating performance on  train set...
1586/1586 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003854
{'0': {'precision': 0.3366295475158722, 'recall': 0.19184464625435227, 'f1-score': 0.2444038979508778, 'support': 139295}, '1': {'precision': 0.3363945535703122, 'recall': 0.7890403325732637, 'f1-score': 0.4716912078929318, 'support': 136391}, '2': {'precision': 0.3520673813169985, 'recall': 0.017665047946889598, 'f1-score': 0.03364209725331811, 'support': 130144}, 'accuracy': 0.33669270384151, 'macro avg': {'precision': 0.341697160801061, 'recall': 0.3328500089248352, 'f1-score': 0.2499124010323759, 'support': 405830}, 'weighted avg': {'precision': 0.3415012681451626, 'recall': 0.33669270384151, 'f1-score': 0.2532020639325043, 'support': 405830}}
[[ 26723 110088   2484]
 [ 27026 107618   1747]
 [ 25635 102210   2299]]
Evaluating performance on  val set...
574/574 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0935627
{'0': {'precision': 0.300514050719671, 'recall': 0.1972290321855109, 'f1-score': 0.2381553754022895, 'support': 44461}, '1': {'precision': 0.3803833576845474, 'recall': 0.7796156999750454, 'f1-score': 0.5112984113252983, 'support': 56102}, '2': {'precision': 0.36481003319808186, 'recall': 0.021355156330972534, 'f1-score': 0.040348407890174, 'support': 46312}, 'accuracy': 0.364228085106383, 'macro avg': {'precision': 0.34856914720076676, 'recall': 0.33273329616384295, 'f1-score': 0.2632673982059206, 'support': 146875}, 'weighted avg': {'precision': 0.35129535046355975, 'recall': 0.364228085106383, 'f1-score': 0.28011646014735536, 'support': 146875}}
[[ 8769 34860   832]
 [11474 43738   890]
 [ 8937 36386   989]]
testing model on single stock: results/universal/W10/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
22048/22048 - 266s - 266s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1155288
{'0': {'precision': 0.38974305504405493, 'recall': 0.18889776987349544, 'f1-score': 0.25446387724887953, 'support': 2156918}, '1': {'precision': 0.24317449808834968, 'recall': 0.8074854906788603, 'f1-score': 0.3737838711072554, 'support': 1364640}, '2': {'precision': 0.37743144369757897, 'recall': 0.011957540836085578, 'f1-score': 0.023180686049665854, 'support': 2122510}, 'accuracy': 0.271921599810633, 'macro avg': {'precision': 0.3367829989433278, 'recall': 0.3361136004628138, 'f1-score': 0.21714281146860026, 'support': 5644068}, 'weighted avg': {'precision': 0.3496753532085982, 'recall': 0.271921599810633, 'f1-score': 0.19633699966105655, 'support': 5644068}}
[[ 407437 1725894   23587]
 [ 244436 1101927   18277]
 [ 393526 1703604   25380]]
Evaluating performance on  train set...
5429/5429 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028173
{'0': {'precision': 0.3409252312622915, 'recall': 0.16189345888945095, 'f1-score': 0.2195366480712236, 'support': 462582}, '1': {'precision': 0.3302242872712671, 'recall': 0.8175396816726931, 'f1-score': 0.4704302731244303, 'support': 457705}, '2': {'precision': 0.35234001135534104, 'recall': 0.027756656421921624, 'f1-score': 0.05145943896891585, 'support': 469509}, 'accuracy': 0.33250419486025284, 'macro avg': {'precision': 0.34116317662963325, 'recall': 0.3357299323280219, 'f1-score': 0.24714212005485658, 'support': 1389796}, 'weighted avg': {'precision': 0.34125727022145946, 'recall': 0.33250419486025284, 'f1-score': 0.24538325022475016, 'support': 1389796}}
[[ 74889 376348  11345]
 [ 70903 374192  12610]
 [ 73872 382605  13032]]
Evaluating performance on  val set...
1890/1890 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998535
{'0': {'precision': 0.3144378794449263, 'recall': 0.15365614611339948, 'f1-score': 0.2064342209450262, 'support': 151006}, '1': {'precision': 0.3533895908452767, 'recall': 0.8210960463247071, 'f1-score': 0.49411723170075117, 'support': 170449}, '2': {'precision': 0.37379868487607487, 'recall': 0.031890365694276626, 'f1-score': 0.0587670618173143, 'support': 162212}, 'accuracy': 0.34803077323861253, 'macro avg': {'precision': 0.3472087183887593, 'recall': 0.3355475193774611, 'f1-score': 0.2531061714876972, 'support': 483667}, 'weighted avg': {'precision': 0.34807324267432954, 'recall': 0.34803077323861253, 'f1-score': 0.2582919997140515, 'support': 483667}}
[[ 23203 123791   4012]
 [ 25840 139955   4654]
 [ 24749 132290   5173]]
training model: results/universal/W10/deepVOL_L3/h300
Epoch 1/50
8543/8543 - 650s - loss: 3.2817 - accuracy300: 0.3676 - val_loss: 3.2980 - val_accuracy300: 0.3329 - 650s/epoch - 76ms/step
Epoch 2/50
8543/8543 - 637s - loss: 3.2710 - accuracy300: 0.3736 - val_loss: 3.2881 - val_accuracy300: 0.3529 - 637s/epoch - 75ms/step
Epoch 3/50
8543/8543 - 650s - loss: 3.2644 - accuracy300: 0.3801 - val_loss: 3.2966 - val_accuracy300: 0.3540 - 650s/epoch - 76ms/step
Epoch 4/50
8543/8543 - 647s - loss: 3.2604 - accuracy300: 0.3822 - val_loss: 3.3000 - val_accuracy300: 0.3540 - 647s/epoch - 76ms/step
Epoch 5/50
8543/8543 - 653s - loss: 3.2563 - accuracy300: 0.3849 - val_loss: 3.3142 - val_accuracy300: 0.3492 - 653s/epoch - 76ms/step
Epoch 6/50
8543/8543 - 641s - loss: 3.2519 - accuracy300: 0.3889 - val_loss: 3.3482 - val_accuracy300: 0.3478 - 641s/epoch - 75ms/step
Epoch 7/50
8543/8543 - 647s - loss: 3.2481 - accuracy300: 0.3914 - val_loss: 3.3649 - val_accuracy300: 0.3469 - 647s/epoch - 76ms/step
Epoch 8/50
8543/8543 - 644s - loss: 3.2432 - accuracy300: 0.3952 - val_loss: 3.3541 - val_accuracy300: 0.3469 - 644s/epoch - 75ms/step
Epoch 9/50
8543/8543 - 642s - loss: 3.2395 - accuracy300: 0.3975 - val_loss: 3.3436 - val_accuracy300: 0.3471 - 642s/epoch - 75ms/step
Epoch 10/50
8543/8543 - 637s - loss: 3.2363 - accuracy300: 0.3996 - val_loss: 3.3579 - val_accuracy300: 0.3482 - 637s/epoch - 75ms/step
Epoch 11/50
8543/8543 - 647s - loss: 3.2324 - accuracy300: 0.4018 - val_loss: 3.3625 - val_accuracy300: 0.3488 - 647s/epoch - 76ms/step
Epoch 12/50
8543/8543 - 640s - loss: 3.2292 - accuracy300: 0.4037 - val_loss: 3.3487 - val_accuracy300: 0.3516 - 640s/epoch - 75ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1556s - 1556s/epoch - 42ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014307
{'0': {'precision': 0.3911448607772539, 'recall': 0.17529890033804188, 'f1-score': 0.24209734019181015, 'support': 3460518}, '1': {'precision': 0.27452229299363057, 'recall': 0.22081810411061972, 'f1-score': 0.24475892791839254, 'support': 2636926}, '2': {'precision': 0.37802855049611694, 'recall': 0.6439635307374048, 'f1-score': 0.4763962550535621, 'support': 3447835}, 'accuracy': 0.35715938737882885, 'macro avg': {'precision': 0.3478985680890005, 'recall': 0.34669351172868873, 'f1-score': 0.3210841743879216, 'support': 9545279}, 'weighted avg': {'precision': 0.35418963350379623, 'recall': 0.35715938737882885, 'f1-score': 0.3274633529610414, 'support': 9545279}}
[[ 606625  792438 2061455]
 [ 463067  582281 1591578]
 [ 481204  746351 2220280]]
Evaluating performance on  train set...
8543/8543 - 364s - 364s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977592
{'0': {'precision': 0.36276167506372897, 'recall': 0.23200983701947092, 'f1-score': 0.28301381420794297, 'support': 728676}, '1': {'precision': 0.329756051143827, 'recall': 0.2201070635132131, 'f1-score': 0.2639989268538269, 'support': 724243}, '2': {'precision': 0.3545907377817004, 'recall': 0.5978759909021656, 'f1-score': 0.44516261268025803, 'support': 733801}, 'accuracy': 0.3508419001975562, 'macro avg': {'precision': 0.3490361546630854, 'recall': 0.3499976304782832, 'f1-score': 0.3307251179140093, 'support': 2186720}, 'weighted avg': {'precision': 0.3490882582416798, 'recall': 0.3508419001975562, 'f1-score': 0.33112859406351486, 'support': 2186720}}
[[169060 164390 395226]
 [161517 159411 403315]
 [135459 159620 438722]]
Evaluating performance on  val set...
3077/3077 - 135s - 135s/epoch - 44ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958763
{'0': {'precision': 0.3557608645876265, 'recall': 0.24747941321695363, 'f1-score': 0.2919018946616944, 'support': 251132}, '1': {'precision': 0.35276733091684676, 'recall': 0.22615168661905247, 'f1-score': 0.2756134259002785, 'support': 274988}, '2': {'precision': 0.35139164781928534, 'recall': 0.5873408403400007, 'f1-score': 0.43971348242848185, 'support': 260823}, 'accuracy': 0.35266976134230815, 'macro avg': {'precision': 0.3533066144412529, 'recall': 0.35365731339200224, 'f1-score': 0.3357429343301516, 'support': 786943}, 'weighted avg': {'precision': 0.3532666838626828, 'recall': 0.35266976134230815, 'f1-score': 0.3352004922835457, 'support': 786943}}
[[ 62150  57662 131320]
 [ 61353  62189 151446]
 [ 51193  56438 153192]]
testing model out of sample: results/universal/W10/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 914s - 914s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1003623
{'0': {'precision': 0.4012257058801147, 'recall': 0.3310431880178242, 'f1-score': 0.3627712112205805, 'support': 2006714}, '1': {'precision': 0.26183103695379556, 'recall': 0.17668048641104261, 'f1-score': 0.21098845755082224, 'support': 1455888}, '2': {'precision': 0.3880576075820035, 'recall': 0.5481761808270156, 'f1-score': 0.4544248240103832, 'support': 1998197}, 'accuracy': 0.3693415560616679, 'macro avg': {'precision': 0.3503714501386379, 'recall': 0.3519666184186274, 'f1-score': 0.3427281642605953, 'support': 5460799}, 'weighted avg': {'precision': 0.3592436662062883, 'recall': 0.3693415560616679, 'f1-score': 0.35584242377408926, 'support': 5460799}}
[[ 664309  373066  969339]
 [ 440680  257227  757981]
 [ 550710  352123 1095364]]
Evaluating performance on  train set...
4055/4055 - 175s - 175s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980526
{'0': {'precision': 0.3731859334545704, 'recall': 0.3228623805528957, 'f1-score': 0.34620498732421245, 'support': 354027}, '1': {'precision': 0.3116308330758024, 'recall': 0.16915390099389524, 'f1-score': 0.2192813845753583, 'support': 333838}, '2': {'precision': 0.3590661563497186, 'recall': 0.5648527666147047, 'f1-score': 0.43904179635393503, 'support': 349615}, 'accuracy': 0.35494949300227474, 'macro avg': {'precision': 0.3479609742933638, 'recall': 0.3522896827204985, 'f1-score': 0.3348427227511686, 'support': 1037480}, 'weighted avg': {'precision': 0.34862072017550966, 'recall': 0.35494949300227474, 'f1-score': 0.33664838796273516, 'support': 1037480}}
[[114302  64979 174746]
 [ 99610  56470 177758]
 [ 92375  59759 197481]]
Evaluating performance on  val set...
1545/1545 - 67s - 67s/epoch - 44ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977249
{'0': {'precision': 0.36468927576097576, 'recall': 0.3068349650562602, 'f1-score': 0.33326993839665936, 'support': 131354}, '1': {'precision': 0.31146357083486625, 'recall': 0.17902008082453558, 'f1-score': 0.22736021246015128, 'support': 127684}, '2': {'precision': 0.36287203791469197, 'recall': 0.5635363995672238, 'f1-score': 0.44147180331366204, 'support': 135867}, 'accuracy': 0.35382686975348504, 'macro avg': {'precision': 0.34634162817017794, 'recall': 0.3497971484826732, 'f1-score': 0.33403398472349094, 'support': 394905}, 'weighted avg': {'precision': 0.3468546736104677, 'recall': 0.35382686975348504, 'f1-score': 0.3362531503949914, 'support': 394905}}
[[40304 25796 65254]
 [35646 22858 69180]
 [34566 24735 76566]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081784
{'0': {'precision': 0.42359626967165337, 'recall': 0.16235688355208042, 'f1-score': 0.234741531297525, 'support': 53715}, '1': {'precision': 0.2683379758588672, 'recall': 0.26591671366240244, 'f1-score': 0.26712185813530515, 'support': 33691}, '2': {'precision': 0.3603993132828893, 'recall': 0.6269356694097867, 'f1-score': 0.45769103432682756, 'support': 45204}, 'accuracy': 0.34703265213784784, 'macro avg': {'precision': 0.35077785293780334, 'recall': 0.35173642220808987, 'f1-score': 0.31985147458655255, 'support': 132610}, 'weighted avg': {'precision': 0.36260869412347246, 'recall': 0.34703265213784784, 'f1-score': 0.31896696623024684, 'support': 132610}}
[[ 8721 13526 31468]
 [ 5905  8959 18827]
 [ 5962 10902 28340]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020657
{'0': {'precision': 0.34249392409796225, 'recall': 0.15757784276621367, 'f1-score': 0.2158468335787924, 'support': 11626}, '1': {'precision': 0.3271764960034565, 'recall': 0.2664965687137075, 'f1-score': 0.2937354538401862, 'support': 11366}, '2': {'precision': 0.3374416717386894, 'recall': 0.5871502956491043, 'f1-score': 0.4285760298901665, 'support': 11331}, 'accuracy': 0.3354601870465868, 'macro avg': {'precision': 0.3357040306133694, 'recall': 0.3370749023763418, 'f1-score': 0.3127194391030484, 'support': 34323}, 'weighted avg': {'precision': 0.33575369278936235, 'recall': 0.3354601870465868, 'f1-score': 0.31186747808233756, 'support': 34323}}
[[1832 3220 6574]
 [1848 3029 6489]
 [1669 3009 6653]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034874
{'0': {'precision': 0.4250203748981255, 'recall': 0.22439759036144577, 'f1-score': 0.29372007885102785, 'support': 4648}, '1': {'precision': 0.2553132762903671, 'recall': 0.3027823240589198, 'f1-score': 0.2770290506139562, 'support': 3055}, '2': {'precision': 0.360392506690455, 'recall': 0.5076652425232471, 'f1-score': 0.4215358931552588, 'support': 3979}, 'accuracy': 0.3413799007019346, 'macro avg': {'precision': 0.3469087192929825, 'recall': 0.34494838564787084, 'f1-score': 0.3307616742067476, 'support': 11682}, 'weighted avg': {'precision': 0.35862682295111104, 'recall': 0.3413799007019346, 'f1-score': 0.3328904292920723, 'support': 11682}}
[[1043 1496 2109]
 [ 654  925 1476]
 [ 757 1202 2020]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
1840/1840 - 38s - 38s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983093
{'0': {'precision': 0.39649805003763083, 'recall': 0.4128238311210315, 'f1-score': 0.4044962773382969, 'support': 168452}, '1': {'precision': 0.24364598818026903, 'recall': 0.10800212147024317, 'f1-score': 0.1496625910336073, 'support': 124442}, '2': {'precision': 0.40815333358289974, 'recall': 0.5510492887748283, 'f1-score': 0.4689574422327893, 'support': 178073}, 'accuracy': 0.38454498935169557, 'macro avg': {'precision': 0.3494324572669332, 'recall': 0.3572917471220343, 'f1-score': 0.3410387702015645, 'support': 470967}, 'weighted avg': {'precision': 0.36051734443639516, 'recall': 0.38454498935169557, 'f1-score': 0.36153526186402535, 'support': 470967}}
[[69541 22307 76604]
 [45316 13440 65686]
 [60531 19415 98127]]
Evaluating performance on  train set...
529/529 - 12s - 12s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0811454
{'0': {'precision': 0.3701305111852627, 'recall': 0.4651382065406183, 'f1-score': 0.41223103057757643, 'support': 40302}, '1': {'precision': 0.3957096341696993, 'recall': 0.11416467121016761, 'f1-score': 0.17720469458064703, 'support': 54290}, '2': {'precision': 0.361016630241276, 'recall': 0.6112132127716925, 'f1-score': 0.4539217470427661, 'support': 40809}, 'accuracy': 0.36843893324273824, 'macro avg': {'precision': 0.375618925198746, 'recall': 0.3968386968408262, 'f1-score': 0.3477858240669965, 'support': 135401}, 'weighted avg': {'precision': 0.3776397778773987, 'recall': 0.36843893324273824, 'f1-score': 0.3305608558148689, 'support': 135401}}
[[18746  5289 16267]
 [20211  6198 27881]
 [11690  4176 24943]]
Evaluating performance on  val set...
208/208 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0847728
{'0': {'precision': 0.4186971091043335, 'recall': 0.4197699578635691, 'f1-score': 0.4192328471096704, 'support': 17562}, '1': {'precision': 0.3073823339780787, 'recall': 0.10799025992411801, 'f1-score': 0.1598290240120689, 'support': 17659}, '2': {'precision': 0.3837245054832428, 'recall': 0.6288561670679134, 'f1-score': 0.47661885767631335, 'support': 17861}, 'accuracy': 0.38640217022719564, 'macro avg': {'precision': 0.369934649521885, 'recall': 0.38553879495186677, 'f1-score': 0.3518935762660175, 'support': 53082}, 'weighted avg': {'precision': 0.3698980192578538, 'recall': 0.38640217022719564, 'f1-score': 0.35224515679374907, 'support': 53082}}
[[ 7372  2399  7791]
 [ 5504  1907 10248]
 [ 4731  1898 11232]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
967/967 - 20s - 20s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1148053
{'0': {'precision': 0.36329597121252644, 'recall': 0.1544600308051728, 'f1-score': 0.21676120290717074, 'support': 96737}, '1': {'precision': 0.2660485021398003, 'recall': 0.19505534412132128, 'f1-score': 0.22508674589738004, 'support': 68842}, '2': {'precision': 0.3171388628814016, 'recall': 0.6033918984870669, 'f1-score': 0.4157580139387469, 'support': 81960}, 'accuracy': 0.3143908636618876, 'macro avg': {'precision': 0.3154944454112428, 'recall': 0.3176357578045203, 'f1-score': 0.2858686542477659, 'support': 247539}, 'weighted avg': {'precision': 0.3209683102592076, 'recall': 0.3143908636618876, 'f1-score': 0.2849642968143125, 'support': 247539}}
[[14942 19310 62485]
 [11415 13428 43999]
 [14772 17734 49454]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100461
{'0': {'precision': 0.2992020284883287, 'recall': 0.23139923866651285, 'f1-score': 0.260968549777214, 'support': 17338}, '1': {'precision': 0.33296516567544604, 'recall': 0.20219791559178618, 'f1-score': 0.2516050333846944, 'support': 19382}, '2': {'precision': 0.3573634433507045, 'recall': 0.5683806600153491, 'f1-score': 0.43882206553297387, 'support': 19545}, 'accuracy': 0.33839864924908913, 'macro avg': {'precision': 0.3298435458381597, 'recall': 0.3339926047578827, 'f1-score': 0.31713188289829414, 'support': 56265}, 'weighted avg': {'precision': 0.33103641893435815, 'recall': 0.33839864924908913, 'f1-score': 0.31952472663185744, 'support': 56265}}
[[ 4012  3701  9625]
 [ 5111  3919 10352]
 [ 4286  4150 11109]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106027
{'0': {'precision': 0.3141228625712476, 'recall': 0.21992314513745195, 'f1-score': 0.2587151177953577, 'support': 6766}, '1': {'precision': 0.3324930678094278, 'recall': 0.19357205752861756, 'f1-score': 0.24468973193581306, 'support': 6814}, '2': {'precision': 0.33091808783246446, 'recall': 0.5814314547430524, 'f1-score': 0.421781732177047, 'support': 6441}, 'accuracy': 0.32725638080015984, 'macro avg': {'precision': 0.3258446727377133, 'recall': 0.331642219136374, 'f1-score': 0.3083955273027392, 'support': 20021}, 'weighted avg': {'precision': 0.3257782556285602, 'recall': 0.32725638080015984, 'f1-score': 0.3064022005577334, 'support': 20021}}
[[1488 1317 3961]
 [1884 1319 3611]
 [1365 1331 3745]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1588/1588 - 34s - 34s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026981
{'0': {'precision': 0.3947121801607361, 'recall': 0.09508530928892964, 'f1-score': 0.15325243815708955, 'support': 146174}, '1': {'precision': 0.28502233125746995, 'recall': 0.3886001475153948, 'f1-score': 0.32884805202345696, 'support': 116598}, '2': {'precision': 0.3511265752959647, 'recall': 0.5189389188511225, 'f1-score': 0.4188494925720649, 'support': 143514}, 'accuracy': 0.32903914976149806, 'macro avg': {'precision': 0.3436203622380569, 'recall': 0.3342081252184823, 'f1-score': 0.3003166609175371, 'support': 406286}, 'weighted avg': {'precision': 0.3478369211092654, 'recall': 0.32903914976149806, 'f1-score': 0.2974636417252693, 'support': 406286}}
[[13899 57119 75156]
 [ 8816 45310 62472]
 [12498 56541 74475]]
Evaluating performance on  train set...
295/295 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09945
{'0': {'precision': 0.32764505119453924, 'recall': 0.07545296599652519, 'f1-score': 0.12265895565044888, 'support': 24174}, '1': {'precision': 0.3314986155196866, 'recall': 0.3939880402937753, 'f1-score': 0.36005208046799064, 'support': 24917}, '2': {'precision': 0.3495249199930537, 'recall': 0.5336944581234138, 'f1-score': 0.4224081069736763, 'support': 26399}, 'accuracy': 0.3408398463372632, 'macro avg': {'precision': 0.33622286223575987, 'recall': 0.3343784881379048, 'f1-score': 0.3017063810307053, 'support': 75490}, 'weighted avg': {'precision': 0.33656843069780695, 'recall': 0.3408398463372632, 'f1-score': 0.30583821564330316, 'support': 75490}}
[[ 1824  9491 12859]
 [ 1739  9817 13361]
 [ 2004 10306 14089]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988495
{'0': {'precision': 0.29628132578819727, 'recall': 0.07225234105470675, 'f1-score': 0.11617402329820113, 'support': 10145}, '1': {'precision': 0.35938216852729776, 'recall': 0.3900738650510416, 'f1-score': 0.3740995741632507, 'support': 12049}, '2': {'precision': 0.32839006853162567, 'recall': 0.5238351254480287, 'f1-score': 0.40370140183688974, 'support': 11160}, 'accuracy': 0.33816034058883493, 'macro avg': {'precision': 0.32801785428237357, 'recall': 0.328720443851259, 'f1-score': 0.2979916664327805, 'support': 33354}, 'weighted avg': {'precision': 0.3298196007531215, 'recall': 0.33816034058883493, 'f1-score': 0.30555312346204194, 'support': 33354}}
[[ 733 3996 5416]
 [ 809 4700 6540]
 [ 932 4382 5846]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
2104/2104 - 43s - 43s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076258
{'0': {'precision': 0.3986260418522698, 'recall': 0.19093271127294795, 'f1-score': 0.2581956439503228, 'support': 210912}, '1': {'precision': 0.22970733129728818, 'recall': 0.2379097953506855, 'f1-score': 0.23373662368286466, 'support': 125825}, '2': {'precision': 0.3801888542775396, 'recall': 0.5787319644839067, 'f1-score': 0.45890638352208546, 'support': 201824}, 'accuracy': 0.3472345750991995, 'macro avg': {'precision': 0.3361740758090325, 'recall': 0.3358581570358467, 'f1-score': 0.31694621705175763, 'support': 538561}, 'weighted avg': {'precision': 0.3522519752179184, 'recall': 0.3472345750991995, 'f1-score': 0.32769694107020064, 'support': 538561}}
[[ 40270  51166 119476]
 [ 24947  29935  70943]
 [ 35805  49217 116802]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040726
{'0': {'precision': 0.30585063359396064, 'recall': 0.15459253202507495, 'f1-score': 0.20537702543677017, 'support': 36690}, '1': {'precision': 0.31710234824988925, 'recall': 0.1999664720181051, 'f1-score': 0.24526653073113897, 'support': 35791}, '2': {'precision': 0.3443893593062197, 'recall': 0.6362359171102046, 'f1-score': 0.44688401396690447, 'support': 37013}, 'accuracy': 0.33223738287029425, 'macro avg': {'precision': 0.3224474470500232, 'recall': 0.3302649737177949, 'f1-score': 0.2991758567116045, 'support': 109494}, 'weighted avg': {'precision': 0.3225560601382296, 'recall': 0.33223738287029425, 'f1-score': 0.3000542082089459, 'support': 109494}}
[[ 5672  7968 23050]
 [ 6854  7157 21780]
 [ 6019  7445 23549]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030847
{'0': {'precision': 0.3264157580021104, 'recall': 0.15292082063112797, 'f1-score': 0.20827021264658027, 'support': 12137}, '1': {'precision': 0.30315200194718267, 'recall': 0.2262488646684832, 'f1-score': 0.25911478649815367, 'support': 11010}, '2': {'precision': 0.362925942753294, 'recall': 0.6257245809180636, 'f1-score': 0.45939728548424197, 'support': 12766}, 'accuracy': 0.3434689388243811, 'macro avg': {'precision': 0.3308312342341957, 'recall': 0.3349647554058916, 'f1-score': 0.3089274282096586, 'support': 35913}, 'weighted avg': {'precision': 0.3322619714726881, 'recall': 0.3434689388243811, 'f1-score': 0.31312603003725803, 'support': 35913}}
[[1856 2813 7468]
 [1965 2491 6554]
 [1865 2913 7988]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
5267/5267 - 109s - 109s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0875331
{'0': {'precision': 0.41655675239979484, 'recall': 0.3963034451507771, 'f1-score': 0.4061777820449557, 'support': 459022}, '1': {'precision': 0.3104515746007177, 'recall': 0.14041813517466253, 'f1-score': 0.19337307529125486, 'support': 417090}, '2': {'precision': 0.40284491321658916, 'recall': 0.6168273396077335, 'f1-score': 0.48738357919543795, 'support': 472077}, 'accuracy': 0.39435791272588633, 'macro avg': {'precision': 0.3766177467390339, 'recall': 0.384516306644391, 'f1-score': 0.3623114788438828, 'support': 1348189}, 'weighted avg': {'precision': 0.3789296448397218, 'recall': 0.39435791272588633, 'f1-score': 0.3687769977050057, 'support': 1348189}}
[[181912  70854 206256]
 [133135  58567 225388]
 [121657  59230 291190]]
Evaluating performance on  train set...
1060/1060 - 22s - 22s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0816417
{'0': {'precision': 0.4255100828445827, 'recall': 0.4369696633575509, 'f1-score': 0.4311637426260548, 'support': 90155}, '1': {'precision': 0.3222904112632251, 'recall': 0.12971510958613214, 'f1-score': 0.1849797583755698, 'support': 89473}, '2': {'precision': 0.4048882378091947, 'recall': 0.6303814044851858, 'f1-score': 0.49307736957115544, 'support': 91635}, 'accuracy': 0.4009614285766949, 'macro avg': {'precision': 0.3842295773056675, 'recall': 0.3990220591429563, 'f1-score': 0.36974029019092663, 'support': 271263}, 'weighted avg': {'precision': 0.38449801542213075, 'recall': 0.4009614285766949, 'f1-score': 0.37087773083038295, 'support': 271263}}
[[39395 13314 37446]
 [30409 11606 47458]
 [22779 11091 57765]]
Evaluating performance on  val set...
404/404 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0831591
{'0': {'precision': 0.3896774583232665, 'recall': 0.40788392236201554, 'f1-score': 0.3985728848114169, 'support': 31634}, '1': {'precision': 0.36490513920186085, 'recall': 0.1341994813804903, 'f1-score': 0.19623172543194434, 'support': 37407}, '2': {'precision': 0.38325344464686845, 'recall': 0.6305252437072603, 'f1-score': 0.4767331851884447, 'support': 34365}, 'accuracy': 0.38286946598843397, 'macro avg': {'precision': 0.37927868072399856, 'recall': 0.39086954914992206, 'f1-score': 0.35717926514393533, 'support': 103406}, 'weighted avg': {'precision': 0.3785812030637667, 'recall': 0.38286946598843397, 'f1-score': 0.35135128232750523, 'support': 103406}}
[[12903  4696 14035]
 [11553  5020 20834]
 [ 8656  4041 21668]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
10110/10110 - 207s - 207s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968719
{'0': {'precision': 0.4271396533955401, 'recall': 0.3737221551219634, 'f1-score': 0.3986494301695518, 'support': 963732}, '1': {'precision': 0.24079054942711234, 'recall': 0.1570542247447347, 'f1-score': 0.19011019131697285, 'support': 646974}, '2': {'precision': 0.40951329156168953, 'recall': 0.5542774415666133, 'f1-score': 0.4710233699748989, 'support': 977395}, 'accuracy': 0.3877460732792113, 'macro avg': {'precision': 0.35914783146144735, 'recall': 0.3616846071444371, 'f1-score': 0.3532609971538078, 'support': 2588101}, 'weighted avg': {'precision': 0.37389948111653476, 'recall': 0.3877460732792113, 'f1-score': 0.37385073080605663, 'support': 2588101}}
[[360168 165706 437858]
 [202063 101610 343301]
 [280978 154669 541748]]
Evaluating performance on  train set...
1686/1686 - 35s - 35s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952821
{'0': {'precision': 0.39459341617615, 'recall': 0.35244982508443623, 'f1-score': 0.37233287935535125, 'support': 148929}, '1': {'precision': 0.2956210671493837, 'recall': 0.150814649770227, 'f1-score': 0.19973306801912202, 'support': 136439}, '2': {'precision': 0.36726813692730376, 'recall': 0.5751162790697675, 'f1-score': 0.44827117415144785, 'support': 146200}, 'accuracy': 0.36413496830163494, 'macro avg': {'precision': 0.3524942067509458, 'recall': 0.3594602513081435, 'f1-score': 0.34011237384197374, 'support': 431568}, 'weighted avg': {'precision': 0.35404674877948417, 'recall': 0.36413496830163494, 'f1-score': 0.34349115114632167, 'support': 431568}}
[[52490 25675 70764]
 [41769 20577 74093]
 [38764 23354 84082]]
Evaluating performance on  val set...
705/705 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095192
{'0': {'precision': 0.3968032043530834, 'recall': 0.33712698845851324, 'f1-score': 0.36453894554133215, 'support': 62297}, '1': {'precision': 0.26888489208633093, 'recall': 0.16693941202518242, 'f1-score': 0.2059889059140743, 'support': 51941}, '2': {'precision': 0.39366639366639367, 'recall': 0.5665498065764023, 'f1-score': 0.46454458721052694, 'support': 66176}, 'accuracy': 0.3722826388196038, 'macro avg': {'precision': 0.35311816336860263, 'recall': 0.35687206902003266, 'f1-score': 0.3450241462219778, 'support': 180414}, 'weighted avg': {'precision': 0.35882507271446457, 'recall': 0.3722826388196038, 'f1-score': 0.3555747062629016, 'support': 180414}}
[[21002 11870 29425]
 [14949  8671 28321]
 [16977 11707 37492]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
6546/6546 - 132s - 132s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0972672
{'0': {'precision': 0.38069583367216936, 'recall': 0.2947397323520976, 'f1-score': 0.33224838539243434, 'support': 571796}, '1': {'precision': 0.328866600048412, 'recall': 0.193116317720188, 'f1-score': 0.2433394069445832, 'support': 548747}, '2': {'precision': 0.358268109871844, 'recall': 0.5877354446657758, 'f1-score': 0.44517140734849453, 'support': 555226}, 'accuracy': 0.35853927361110033, 'macro avg': {'precision': 0.35594351453080847, 'recall': 0.35853049824602046, 'f1-score': 0.34025306656183735, 'support': 1675769}, 'weighted avg': {'precision': 0.3562929524647384, 'recall': 0.35853927361110033, 'f1-score': 0.3405486120897014, 'support': 1675769}}
[[168531 113733 289532]
 [147790 105972 294985]
 [126371 102529 326326]]
Evaluating performance on  train set...
1230/1230 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975573
{'0': {'precision': 0.3916434355502456, 'recall': 0.3217957224792532, 'f1-score': 0.3533004346025458, 'support': 110017}, '1': {'precision': 0.3071684117241606, 'recall': 0.1891695218459113, 'f1-score': 0.23414249704460305, 'support': 98943}, '2': {'precision': 0.35848629466470877, 'recall': 0.5537378319629525, 'f1-score': 0.4352163416898793, 'support': 105810}, 'accuracy': 0.3580741493789116, 'macro avg': {'precision': 0.352432713979705, 'recall': 0.3549010254293723, 'f1-score': 0.340886424445676, 'support': 314770}, 'weighted avg': {'precision': 0.3539442604080053, 'recall': 0.3580741493789116, 'f1-score': 0.34338105954493303, 'support': 314770}}
[[35403 22229 52385]
 [27762 18717 52464]
 [27231 19988 58591]]
Evaluating performance on  val set...
444/444 - 9s - 9s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933728
{'0': {'precision': 0.3853149658954126, 'recall': 0.37927856766719326, 'f1-score': 0.38227293836661574, 'support': 37980}, '1': {'precision': 0.3511603519810331, 'recall': 0.197047611737918, 'f1-score': 0.2524418223533268, 'support': 39087}, '2': {'precision': 0.3538694655924311, 'recall': 0.5265762916930185, 'f1-score': 0.42328393178829177, 'support': 36367}, 'accuracy': 0.3637092935098824, 'macro avg': {'precision': 0.3634482611562923, 'recall': 0.3676341570327099, 'f1-score': 0.3526662308360781, 'support': 113434}, 'weighted avg': {'precision': 0.3634645515259124, 'recall': 0.3637092935098824, 'f1-score': 0.35068397884966906, 'support': 113434}}
[[14405  7463 16112]
 [12531  7702 18854]
 [10449  6768 19150]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
7633/7633 - 160s - 160s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006783
{'0': {'precision': 0.36958844961025444, 'recall': 0.3521180485257138, 'f1-score': 0.3606417954404756, 'support': 681618}, '1': {'precision': 0.2982191994185141, 'recall': 0.1780913469157153, 'f1-score': 0.22300685680514723, 'support': 580556}, '2': {'precision': 0.3746570594597303, 'recall': 0.5187535956196319, 'f1-score': 0.43508479692745256, 'support': 691814}, 'accuracy': 0.35941008849593753, 'macro avg': {'precision': 0.3474882361628329, 'recall': 0.349654330353687, 'f1-score': 0.3395778163910251, 'support': 1953988}, 'weighted avg': {'precision': 0.35017824281271487, 'recall': 0.35941008849593753, 'f1-score': 0.34610533011742334, 'support': 1953988}}
[[240010 123594 318014]
 [196167 103392 280997]
 [213221 119712 358881]]
Evaluating performance on  train set...
1586/1586 - 34s - 34s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987949
{'0': {'precision': 0.3707350382167008, 'recall': 0.3621023493301971, 'f1-score': 0.36636784803421846, 'support': 139444}, '1': {'precision': 0.3196278245458573, 'recall': 0.1653828519027969, 'f1-score': 0.21797854660824897, 'support': 130860}, '2': {'precision': 0.35735404089677747, 'recall': 0.5324292017767809, 'f1-score': 0.4276675882874153, 'support': 135526}, 'accuracy': 0.3555503535963334, 'macro avg': {'precision': 0.3492389678864452, 'recall': 0.3533048010032583, 'f1-score': 0.33733799430996086, 'support': 405830}, 'weighted avg': {'precision': 0.34978694905683944, 'recall': 0.3555503535963334, 'f1-score': 0.3389905832015358, 'support': 405830}}
[[50493 24253 64698]
 [44151 21642 65067]
 [41553 21815 72158]]
Evaluating performance on  val set...
574/574 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977391
{'0': {'precision': 0.33450556255944086, 'recall': 0.3323517777875445, 'f1-score': 0.3334251920766323, 'support': 45506}, '1': {'precision': 0.3682406853954971, 'recall': 0.16843467483231261, 'f1-score': 0.23114346102377467, 'support': 54864}, '2': {'precision': 0.32797419253725496, 'recall': 0.5399849478550693, 'f1-score': 0.4080863234529381, 'support': 46505}, 'accuracy': 0.3368646808510638, 'macro avg': {'precision': 0.34357348016406436, 'recall': 0.3469238001583088, 'f1-score': 0.3242183255177817, 'support': 146875}, 'weighted avg': {'precision': 0.34503902582000684, 'recall': 0.3368646808510638, 'f1-score': 0.31885859478077616, 'support': 146875}}
[[15124  8207 22175]
 [16343  9241 29280]
 [13746  7647 25112]]
testing model on single stock: results/universal/W10/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
22048/22048 - 446s - 446s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1061497
{'0': {'precision': 0.37538731745395015, 'recall': 0.081851982483828, 'f1-score': 0.13439875416252792, 'support': 2115074}, '1': {'precision': 0.2576118456996101, 'recall': 0.25125013198848434, 'f1-score': 0.2543912222637987, 'support': 1430049}, '2': {'precision': 0.3776886812002379, 'recall': 0.6816476849083707, 'f1-score': 0.48606018521192296, 'support': 2098945}, 'accuracy': 0.34782784332151917, 'macro avg': {'precision': 0.3368959481179328, 'recall': 0.3382499331268944, 'f1-score': 0.2916167205460832, 'support': 5644068}, 'weighted avg': {'precision': 0.34640214936625696, 'recall': 0.34782784332151917, 'f1-score': 0.2955791494748677, 'support': 5644068}}
[[ 173123  527353 1414598]
 [ 127939  359300  942810]
 [ 160123  508081 1430741]]
Evaluating performance on  train set...
5429/5429 - 110s - 110s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024764
{'0': {'precision': 0.32588697342495826, 'recall': 0.15932874740317396, 'f1-score': 0.21402094384819692, 'support': 464028}, '1': {'precision': 0.3312050208958911, 'recall': 0.2466295825850817, 'f1-score': 0.28272781021265586, 'support': 456620}, '2': {'precision': 0.3447691728135519, 'recall': 0.6047430661539642, 'f1-score': 0.4391660436296203, 'support': 469148}, 'accuracy': 0.3383683648535469, 'macro avg': {'precision': 0.33395372237813375, 'recall': 0.33690046538074, 'f1-score': 0.3119715992301577, 'support': 1389796}, 'weighted avg': {'precision': 0.33400821777660217, 'recall': 0.3383683648535469, 'f1-score': 0.3125960603340657, 'support': 1389796}}
[[ 73933 113698 276397]
 [ 81205 112616 262799]
 [ 71729 113705 283714]]
Evaluating performance on  val set...
1890/1890 - 40s - 40s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002153
{'0': {'precision': 0.3198488026258102, 'recall': 0.17549460051621796, 'f1-score': 0.22663767191147083, 'support': 153811}, '1': {'precision': 0.3541597859832221, 'recall': 0.25412652708162997, 'f1-score': 0.29591787456277724, 'support': 168786}, '2': {'precision': 0.34285416412018893, 'recall': 0.5920966039610107, 'f1-score': 0.4342534241585312, 'support': 161070}, 'accuracy': 0.34167102572637786, 'macro avg': {'precision': 0.33895425090974046, 'recall': 0.3405725771862862, 'f1-score': 0.31893632354425977, 'support': 483667}, 'weighted avg': {'precision': 0.3394835662397506, 'recall': 0.34167102572637786, 'f1-score': 0.3199543494998476, 'support': 483667}}
[[26993 38831 87987]
 [31087 42893 94806]
 [26313 39388 95369]]
training model: results/universal/W10/deepVOL_L3/h500
Epoch 1/50
8543/8543 - 640s - loss: 3.2803 - accuracy500: 0.3729 - val_loss: 3.3031 - val_accuracy500: 0.3448 - 640s/epoch - 75ms/step
Epoch 2/50
8543/8543 - 645s - loss: 3.2786 - accuracy500: 0.3707 - val_loss: 3.3037 - val_accuracy500: 0.3478 - 645s/epoch - 75ms/step
Epoch 3/50
8543/8543 - 641s - loss: 3.2757 - accuracy500: 0.3733 - val_loss: 3.3068 - val_accuracy500: 0.3459 - 641s/epoch - 75ms/step
Epoch 4/50
8543/8543 - 633s - loss: 3.2751 - accuracy500: 0.3720 - val_loss: 3.2934 - val_accuracy500: 0.3474 - 633s/epoch - 74ms/step
Epoch 5/50
8543/8543 - 641s - loss: 3.2693 - accuracy500: 0.3788 - val_loss: 3.2964 - val_accuracy500: 0.3440 - 641s/epoch - 75ms/step
Epoch 6/50
8543/8543 - 646s - loss: 3.2656 - accuracy500: 0.3818 - val_loss: 3.3147 - val_accuracy500: 0.3447 - 646s/epoch - 76ms/step
Epoch 7/50
8543/8543 - 641s - loss: 3.2631 - accuracy500: 0.3844 - val_loss: 3.3165 - val_accuracy500: 0.3472 - 641s/epoch - 75ms/step
Epoch 8/50
8543/8543 - 646s - loss: 3.2579 - accuracy500: 0.3890 - val_loss: 3.3054 - val_accuracy500: 0.3433 - 646s/epoch - 76ms/step
Epoch 9/50
8543/8543 - 640s - loss: 3.2577 - accuracy500: 0.3882 - val_loss: 3.3258 - val_accuracy500: 0.3440 - 640s/epoch - 75ms/step
Epoch 10/50
8543/8543 - 648s - loss: 3.2518 - accuracy500: 0.3926 - val_loss: 3.3197 - val_accuracy500: 0.3396 - 648s/epoch - 76ms/step
Epoch 11/50
8543/8543 - 656s - loss: 3.2445 - accuracy500: 0.3979 - val_loss: 3.3509 - val_accuracy500: 0.3393 - 656s/epoch - 77ms/step
Epoch 12/50
8543/8543 - 648s - loss: 3.2392 - accuracy500: 0.4018 - val_loss: 3.3514 - val_accuracy500: 0.3386 - 648s/epoch - 76ms/step
Epoch 13/50
8543/8543 - 639s - loss: 3.2361 - accuracy500: 0.4033 - val_loss: 3.3816 - val_accuracy500: 0.3384 - 639s/epoch - 75ms/step
Epoch 14/50
8543/8543 - 636s - loss: 3.2320 - accuracy500: 0.4056 - val_loss: 3.3986 - val_accuracy500: 0.3381 - 636s/epoch - 74ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1560s - 1560s/epoch - 42ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969876
{'0': {'precision': 0.3817892488629307, 'recall': 0.3060919606500462, 'f1-score': 0.33977558370086064, 'support': 3520919}, '1': {'precision': 0.27444987775061125, 'recall': 0.0001774839651736141, 'f1-score': 0.000354738524524757, 'support': 2529806}, '2': {'precision': 0.3747315802128789, 'recall': 0.7206933989287331, 'f1-score': 0.49308091630552786, 'support': 3494554}, 'accuracy': 0.37680155813151195, 'macro avg': {'precision': 0.34365690227547363, 'recall': 0.3423209478479843, 'f1-score': 0.2777370795103044, 'support': 9545279}, 'weighted avg': {'precision': 0.3507570297640562, 'recall': 0.37680155813151195, 'f1-score': 0.30594366245715526, 'support': 9545279}}
[[1077725     569 2442625]
 [ 769668     449 1759689]
 [ 975434     618 2518502]]
Evaluating performance on  train set...
8543/8543 - 368s - 368s/epoch - 43ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974771
{'0': {'precision': 0.34894613895392557, 'recall': 0.35755848506501225, 'f1-score': 0.3531998194262532, 'support': 731939}, '1': {'precision': 0.3128205128205128, 'recall': 0.00017014772169411346, 'f1-score': 0.0003401104522632678, 'support': 717024}, '2': {'precision': 0.3525397437629062, 'recall': 0.6863533656746056, 'f1-score': 0.46581662245645633, 'support': 737757}, 'accuracy': 0.3513001207287627, 'macro avg': {'precision': 0.33810213184578153, 'recall': 0.3480273328204373, 'f1-score': 0.27311885077832426, 'support': 2186720}, 'weighted avg': {'precision': 0.33831298342892696, 'recall': 0.3513001207287627, 'f1-score': 0.2754920904009493, 'support': 2186720}}
[[261711    143 470085]
 [257023    122 459879]
 [231270    125 506362]]
Evaluating performance on  val set...
3077/3077 - 136s - 136s/epoch - 44ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971557
{'0': {'precision': 0.3389423247308322, 'recall': 0.3766447044553227, 'f1-score': 0.3568002954744286, 'support': 253921}, '1': {'precision': 0.28104575163398693, 'recall': 0.00016084326758708916, 'f1-score': 0.0003215025383746926, 'support': 267341}, '2': {'precision': 0.3527834585750975, 'recall': 0.6700629702538006, 'f1-score': 0.4622143177053245, 'support': 265681}, 'accuracy': 0.3478066391085504, 'macro avg': {'precision': 0.3242571783133055, 'recall': 0.34895617265890344, 'f1-score': 0.27311203857270927, 'support': 786943}, 'weighted avg': {'precision': 0.32394657349166306, 'recall': 0.3478066391085504, 'f1-score': 0.2712859772302979, 'support': 786943}}
[[ 95638     54 158229]
 [ 98926     43 168372]
 [ 87602     56 178023]]
testing model out of sample: results/universal/W10/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 895s - 895s/epoch - 42ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974046
{'0': {'precision': 0.37110366784046567, 'recall': 0.4318860212375432, 'f1-score': 0.3991943825687336, 'support': 1959172}, '1': {'precision': 0.26605504587155965, 'recall': 0.000168918153653389, 'f1-score': 0.0003376219513772647, 'support': 1545127}, '2': {'precision': 0.3727973552696008, 'recall': 0.6058803986710963, 'f1-score': 0.46158321127622703, 'support': 1956500}, 'accuracy': 0.37207101012141264, 'macro avg': {'precision': 0.33665202299387537, 'recall': 0.3459784460207643, 'f1-score': 0.28703840526544594, 'support': 5460799}, 'weighted avg': {'precision': 0.34198709302021557, 'recall': 0.37207101012141264, 'f1-score': 0.30869103194253344, 'support': 5460799}}
[[ 846139     380 1112653]
 [ 663167     261  881699]
 [ 770755     340 1185405]]
Evaluating performance on  train set...
4055/4055 - 178s - 178s/epoch - 44ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099102
{'0': {'precision': 0.35418010563636454, 'recall': 0.4143304566886245, 'f1-score': 0.3819013351602663, 'support': 352494}, '1': {'precision': 0.3522727272727273, 'recall': 0.0001839746233713053, 'f1-score': 0.0003677571853525872, 'support': 337003}, '2': {'precision': 0.34743481836830703, 'recall': 0.6239615153613826, 'f1-score': 0.44633883870251584, 'support': 347983}, 'accuracy': 0.3501166287542892, 'macro avg': {'precision': 0.3512958837591329, 'recall': 0.34615864889112613, 'f1-score': 0.2762026436827116, 'support': 1037480}, 'weighted avg': {'precision': 0.35129808619494757, 'recall': 0.3501166287542892, 'f1-score': 0.27958147879374623, 'support': 1037480}}
[[146049     59 206386]
 [135509     62 201432]
 [130800     55 217128]]
Evaluating performance on  val set...
1545/1545 - 68s - 68s/epoch - 44ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000373
{'0': {'precision': 0.32508983564902755, 'recall': 0.418436873747495, 'f1-score': 0.3659036663967952, 'support': 124750}, '1': {'precision': 0.4098360655737705, 'recall': 0.00017960802344962353, 'f1-score': 0.0003590586917337508, 'support': 139192}, '2': {'precision': 0.34291190192638504, 'recall': 0.6134175301421012, 'f1-score': 0.4399073475780043, 'support': 130963}, 'accuracy': 0.3356756688317443, 'macro avg': {'precision': 0.35927926771639435, 'recall': 0.3440113373043486, 'f1-score': 0.2687233575555111, 'support': 394905}, 'weighted avg': {'precision': 0.36087066521959865, 'recall': 0.3356756688317443, 'f1-score': 0.26160227508205314, 'support': 394905}}
[[52200    19 72531]
 [57760    25 81407]
 [50611    17 80335]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002599
{'0': {'precision': 0.43135419183377627, 'recall': 0.270245213047756, 'f1-score': 0.33230189381601605, 'support': 52852}, '1': {'precision': 0.3181818181818182, 'recall': 0.00019443904335990667, 'f1-score': 0.00038864059073369795, 'support': 36001}, '2': {'precision': 0.336523382524428, 'recall': 0.7650433073565372, 'f1-score': 0.4674341806706555, 'support': 43757}, 'accuracy': 0.3601990800090491, 'macro avg': {'precision': 0.3620197975133408, 'recall': 0.34516098648255106, 'f1-score': 0.2667082383591351, 'support': 132610}, 'weighted avg': {'precision': 0.3693390319906777, 'recall': 0.3601990800090491, 'f1-score': 0.2867832635960859, 'support': 132610}}
[[14283    11 38558]
 [ 8552     7 27442]
 [10277     4 33476]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1013955
{'0': {'precision': 0.3392440976796028, 'recall': 0.28576305906452715, 'f1-score': 0.31021542738012503, 'support': 11716}, '1': {'precision': 0.125, 'recall': 8.838607035531201e-05, 'f1-score': 0.0001766472354707649, 'support': 11314}, '2': {'precision': 0.32995173034443265, 'recall': 0.7142477641016559, 'f1-score': 0.45138364251937657, 'support': 11293}, 'accuracy': 0.3325758237916266, 'macro avg': {'precision': 0.2647319426746785, 'recall': 0.33336640307884613, 'f1-score': 0.2539252390449908, 'support': 34323}, 'weighted avg': {'precision': 0.26556474489974374, 'recall': 0.3325758237916266, 'f1-score': 0.25446371264105644, 'support': 34323}}
[[3348    2 8366]
 [3299    1 8014]
 [3222    5 8066]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957657
{'0': {'precision': 0.43126456259267104, 'recall': 0.4411700975081257, 'f1-score': 0.4361610968294773, 'support': 4615}, '1': {'precision': 1.0, 'recall': 0.00030039050765995795, 'f1-score': 0.0006006006006006006, 'support': 3329}, '2': {'precision': 0.3458333333333333, 'recall': 0.6439272338148743, 'f1-score': 0.4499906524584034, 'support': 3738}, 'accuracy': 0.3804143126177024, 'macro avg': {'precision': 0.5923659653086681, 'recall': 0.36179924061021995, 'f1-score': 0.29558411662949374, 'support': 11682}, 'weighted avg': {'precision': 0.5659999106630009, 'recall': 0.3804143126177024, 'f1-score': 0.3164653244441833, 'support': 11682}}
[[2036    0 2579]
 [1354    1 1974]
 [1331    0 2407]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
1840/1840 - 41s - 41s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969777
{'0': {'precision': 0.39563382523227547, 'recall': 0.40572695654131447, 'f1-score': 0.4006168294411025, 'support': 177686}, '1': {'precision': 0.23255813953488372, 'recall': 0.00020068433357749927, 'f1-score': 0.00040102260764950624, 'support': 99659}, '2': {'precision': 0.41474804442566043, 'recall': 0.6183284957287911, 'f1-score': 0.4964792528883396, 'support': 193622}, 'accuracy': 0.4073194087908495, 'macro avg': {'precision': 0.3476466697309399, 'recall': 0.3414187122012277, 'f1-score': 0.2991657016456972, 'support': 470967}, 'weighted avg': {'precision': 0.3689843436077566, 'recall': 0.4073194087908495, 'f1-score': 0.35533970187056324, 'support': 470967}}
[[ 72092     29 105565]
 [ 36264     20  63375]
 [ 73863     37 119722]]
Evaluating performance on  train set...
529/529 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0870528
{'0': {'precision': 0.38478165422675537, 'recall': 0.5125286787529804, 'f1-score': 0.43956171148578266, 'support': 44458}, '1': {'precision': 0.4782608695652174, 'recall': 0.00024576612002323605, 'f1-score': 0.0004912797838368951, 'support': 44758}, '2': {'precision': 0.38357405462184874, 'recall': 0.6325213814008878, 'f1-score': 0.47755118721647793, 'support': 46185}, 'accuracy': 0.3841182856847438, 'macro avg': {'precision': 0.41553885947127384, 'recall': 0.3817652754246305, 'f1-score': 0.30586805949536583, 'support': 135401}, 'weighted avg': {'precision': 0.41527012722448997, 'recall': 0.3841182856847438, 'f1-score': 0.30738122208397967, 'support': 135401}}
[[22786     6 21666]
 [19466    11 25281]
 [16966     6 29213]]
Evaluating performance on  val set...
208/208 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0864863
{'0': {'precision': 0.437161848817437, 'recall': 0.4435846491686709, 'f1-score': 0.4403498300158306, 'support': 19126}, '1': {'precision': 0.29411764705882354, 'recall': 0.00034312379906670324, 'f1-score': 0.0006854479402289396, 'support': 14572}, '2': {'precision': 0.38980331570503296, 'recall': 0.6768468840280644, 'f1-score': 0.4947023113758908, 'support': 19384}, 'accuracy': 0.4070871481858257, 'macro avg': {'precision': 0.3736942705270978, 'recall': 0.373591552331934, 'f1-score': 0.3119125297773168, 'support': 53082}, 'weighted avg': {'precision': 0.3805995882794513, 'recall': 0.4070871481858257, 'f1-score': 0.33950169172182776, 'support': 53082}}
[[ 8484     5 10637]
 [ 4666     5  9901]
 [ 6257     7 13120]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
967/967 - 20s - 20s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066129
{'0': {'precision': 0.3762586115527292, 'recall': 0.25901422754207626, 'f1-score': 0.3068172527767721, 'support': 101423}, '1': {'precision': 0.2727272727272727, 'recall': 0.00018556031483400083, 'f1-score': 0.00037086829539659727, 'support': 64669}, '2': {'precision': 0.31386343681757806, 'recall': 0.6846906577283387, 'f1-score': 0.4304210741616915, 'support': 81447}, 'accuracy': 0.3314548414593256, 'macro avg': {'precision': 0.3209497736991933, 'recall': 0.31463014852841636, 'f1-score': 0.24586973174462004, 'support': 247539}, 'weighted avg': {'precision': 0.3286815915794834, 'recall': 0.3314548414593256, 'f1-score': 0.26742782000986043, 'support': 247539}}
[[26270    18 75135]
 [17882    12 46775]
 [25667    14 55766]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980654
{'0': {'precision': 0.31907194550872714, 'recall': 0.3355907539038451, 'f1-score': 0.32712294388826757, 'support': 17867}, '1': {'precision': 0.3333333333333333, 'recall': 0.00034021320027217056, 'f1-score': 0.0006797326384955252, 'support': 17636}, '2': {'precision': 0.3776531838205847, 'recall': 0.6812927463635488, 'f1-score': 0.48594053283405186, 'support': 20762}, 'accuracy': 0.3580734026481827, 'macro avg': {'precision': 0.3433528208875484, 'recall': 0.3390745711558887, 'f1-score': 0.271247736453605, 'support': 56265}, 'weighted avg': {'precision': 0.34515881133127296, 'recall': 0.3580734026481827, 'f1-score': 0.28340514966612934, 'support': 56265}}
[[ 5996     8 11863]
 [ 6183     6 11447]
 [ 6613     4 14145]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044881
{'0': {'precision': 0.29572049481778667, 'recall': 0.2534020913909182, 'f1-score': 0.27293064876957496, 'support': 6981}, '1': {'precision': 0.5, 'recall': 0.00016035920461834508, 'f1-score': 0.0003206155819172812, 'support': 6236}, '2': {'precision': 0.3482937949704353, 'recall': 0.7185479129923574, 'f1-score': 0.4691713449450602, 'support': 6804}, 'accuracy': 0.33260076919234804, 'macro avg': {'precision': 0.381338096596074, 'recall': 0.3240367878626313, 'f1-score': 0.24747420309885082, 'support': 20021}, 'weighted avg': {'precision': 0.37721471231715753, 'recall': 0.33260076919234804, 'f1-score': 0.2547110558331466, 'support': 20021}}
[[1769    1 5211]
 [2298    1 3937]
 [1915    0 4889]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1588/1588 - 32s - 32s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016383
{'0': {'precision': 0.36033339202911313, 'recall': 0.17208611313561697, 'f1-score': 0.23293050786363378, 'support': 142696}, '1': {'precision': 0.28, 'recall': 0.00011403437321821291, 'f1-score': 0.0002279758996906041, 'support': 122770}, '2': {'precision': 0.3440435626227491, 'recall': 0.825997727595512, 'f1-score': 0.48575926900365, 'support': 140820}, 'accuracy': 0.3467680402475104, 'macro avg': {'precision': 0.3281256515506208, 'recall': 0.3327326250347824, 'f1-score': 0.23963925092232477, 'support': 406286}, 'weighted avg': {'precision': 0.33041243901468886, 'recall': 0.3467680402475104, 'f1-score': 0.2502445582973769, 'support': 406286}}
[[ 24556     16 118124]
 [ 19109     14 103647]
 [ 24483     20 116317]]
Evaluating performance on  train set...
295/295 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991828
{'0': {'precision': 0.3209500609013398, 'recall': 0.15486985726280436, 'f1-score': 0.20892563855694624, 'support': 23820}, '1': {'precision': 0.3076923076923077, 'recall': 0.00016096579476861168, 'f1-score': 0.0003217632626794836, 'support': 24850}, '2': {'precision': 0.35182782926714906, 'recall': 0.8393363161819538, 'f1-score': 0.495820622666652, 'support': 26820}, 'accuracy': 0.3471188236852563, 'macro avg': {'precision': 0.3268233992869322, 'recall': 0.3314557130798423, 'f1-score': 0.23502267482875924, 'support': 75490}, 'weighted avg': {'precision': 0.3275560561368221, 'recall': 0.3471188236852563, 'f1-score': 0.24218457580373096, 'support': 75490}}
[[ 3689     4 20127]
 [ 3501     4 21345]
 [ 4304     5 22511]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009845
{'0': {'precision': 0.3047080979284369, 'recall': 0.15973936222726823, 'f1-score': 0.2095990672971047, 'support': 10129}, '1': {'precision': 0.16666666666666666, 'recall': 8.30357884248111e-05, 'f1-score': 0.00016598887874512408, 'support': 12043}, '2': {'precision': 0.3321563592267637, 'recall': 0.8328563763190843, 'f1-score': 0.47491075981642017, 'support': 11182}, 'accuracy': 0.3277567907897104, 'macro avg': {'precision': 0.2678437079406224, 'recall': 0.3308929247782591, 'f1-score': 0.22822527199742335, 'support': 33354}, 'weighted avg': {'precision': 0.2640680997618719, 'recall': 0.3277567907897104, 'f1-score': 0.22292618795305844, 'support': 33354}}
[[ 1618     2  8509]
 [ 1826     1 10216]
 [ 1866     3  9313]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
2104/2104 - 42s - 42s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971321
{'0': {'precision': 0.39388095270893886, 'recall': 0.2766524597618852, 'f1-score': 0.32501925301156886, 'support': 206707}, '1': {'precision': 0.2545454545454545, 'recall': 0.00021409510410374437, 'f1-score': 0.00042783036526017435, 'support': 130783}, '2': {'precision': 0.3772138379972792, 'recall': 0.7377742190569501, 'f1-score': 0.49919574112959675, 'support': 201071}, 'accuracy': 0.38168192646701116, 'macro avg': {'precision': 0.34188008175055756, 'recall': 0.33821359130764633, 'f1-score': 0.27488094150214193, 'support': 538561}, 'weighted avg': {'precision': 0.3538223746119302, 'recall': 0.38168192646701116, 'f1-score': 0.3112247164863244, 'support': 538561}}
[[ 57186     41 149480]
 [ 35315     28  95440]
 [ 52685     41 148345]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006815
{'0': {'precision': 0.3248935346496322, 'recall': 0.23081577644534904, 'f1-score': 0.26989129735640316, 'support': 36358}, '1': {'precision': 0.2916666666666667, 'recall': 0.0001943364797334814, 'f1-score': 0.000388414160470536, 'support': 36020}, '2': {'precision': 0.34206121472979434, 'recall': 0.770826597693717, 'f1-score': 0.47384809036403985, 'support': 37116}, 'accuracy': 0.3380002557217747, 'macro avg': {'precision': 0.31954047201536445, 'recall': 0.33394557020626653, 'f1-score': 0.24804260062697117, 'support': 109494}, 'weighted avg': {'precision': 0.3197824219777861, 'recall': 0.3380002557217747, 'f1-score': 0.25037028685860374, 'support': 109494}}
[[ 8392    10 27956]
 [ 8939     7 27074]
 [ 8499     7 28610]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999173
{'0': {'precision': 0.32668476336598606, 'recall': 0.22592229840026118, 'f1-score': 0.2671170084439083, 'support': 12252}, '1': {'precision': 0.16666666666666666, 'recall': 9.173470323823502e-05, 'f1-score': 0.00018336847895846704, 'support': 10901}, '2': {'precision': 0.3554348618502588, 'recall': 0.7641849529780564, 'f1-score': 0.48519679554162315, 'support': 12760}, 'accuracy': 0.3486202767799961, 'macro avg': {'precision': 0.2829287639609705, 'recall': 0.33006632869385194, 'f1-score': 0.2508323908214966, 'support': 35913}, 'weighted avg': {'precision': 0.2883280118982735, 'recall': 0.3486202767799961, 'f1-score': 0.2635766323714254, 'support': 35913}}
[[2768    4 9480]
 [2697    1 8203]
 [3008    1 9751]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
5267/5267 - 107s - 107s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919139
{'0': {'precision': 0.37391513809294397, 'recall': 0.4691667117775492, 'f1-score': 0.4161601530144732, 'support': 443352}, '1': {'precision': 0.3305084745762712, 'recall': 0.00017294018265143907, 'f1-score': 0.0003456994763539342, 'support': 451023}, '2': {'precision': 0.368122213927426, 'recall': 0.6421749879906746, 'f1-score': 0.46797888355848166, 'support': 453814}, 'accuracy': 0.37050591571359803, 'macro avg': {'precision': 0.35751527553221374, 'recall': 0.3705048799836251, 'f1-score': 0.2948282453497696, 'support': 1348189}, 'weighted avg': {'precision': 0.3574439210109691, 'recall': 0.37050591571359803, 'f1-score': 0.2944963381524438, 'support': 1348189}}
[[208006     78 235268]
 [185980     78 264965]
 [162306     80 291428]]
Evaluating performance on  train set...
1060/1060 - 23s - 23s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0863274
{'0': {'precision': 0.39017052003525665, 'recall': 0.5144431159136877, 'f1-score': 0.443770754912498, 'support': 89489}, '1': {'precision': 0.30612244897959184, 'recall': 0.00016722594454787677, 'f1-score': 0.0003342692873378794, 'support': 89699}, '2': {'precision': 0.38602811606688336, 'recall': 0.6423893565028509, 'f1-score': 0.4822562037040812, 'support': 92075}, 'accuracy': 0.38781551483246884, 'macro avg': {'precision': 0.36077369502724393, 'recall': 0.3856665661203622, 'f1-score': 0.30878707596797234, 'support': 271263}, 'weighted avg': {'precision': 0.3609721414469123, 'recall': 0.38781551483246884, 'f1-score': 0.3102019982939905, 'support': 271263}}
[[46037    12 43440]
 [39050    15 50634]
 [32905    22 59148]]
Evaluating performance on  val set...
404/404 - 8s - 8s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0866576
{'0': {'precision': 0.3732434621064164, 'recall': 0.4762932344538326, 'f1-score': 0.4185183206922337, 'support': 32902}, '1': {'precision': 0.2222222222222222, 'recall': 0.00012039127163280663, 'f1-score': 0.00024065216737358244, 'support': 33225}, '2': {'precision': 0.39840721800592815, 'recall': 0.6562139542369698, 'f1-score': 0.49579959668021195, 'support': 37279}, 'accuracy': 0.38815929443165775, 'macro avg': {'precision': 0.3312909674448556, 'recall': 0.37754252665414506, 'f1-score': 0.3048528565132731, 'support': 103406}, 'weighted avg': {'precision': 0.3337911959035418, 'recall': 0.38815929443165775, 'f1-score': 0.31198381738311587, 'support': 103406}}
[[15671     5 17226]
 [13508     4 19713]
 [12807     9 24463]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
10110/10110 - 209s - 209s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944113
{'0': {'precision': 0.38839857529521576, 'recall': 0.45831589635958475, 'f1-score': 0.4204705296540286, 'support': 941486}, '1': {'precision': 0.22247706422018348, 'recall': 0.00014175918767601157, 'f1-score': 0.00028333783655496244, 'support': 684259}, '2': {'precision': 0.3897560638668164, 'recall': 0.5980655807206481, 'f1-score': 0.4719469105645057, 'support': 962356}, 'accuracy': 0.3891451686004526, 'macro avg': {'precision': 0.33354390112740523, 'recall': 0.35217441208930295, 'f1-score': 0.2975669260183631, 'support': 2588101}, 'weighted avg': {'precision': 0.3450359321932351, 'recall': 0.3891451686004526, 'f1-score': 0.32851961133269975, 'support': 2588101}}
[[431498    164 509824]
 [292840     97 391322]
 [386629    175 575552]]
Evaluating performance on  train set...
1686/1686 - 35s - 35s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981704
{'0': {'precision': 0.362868031948055, 'recall': 0.4178937671873095, 'f1-score': 0.38844187569255567, 'support': 147638}, '1': {'precision': 0.3783783783783784, 'recall': 0.00020275750202757503, 'f1-score': 0.00040529782152420933, 'support': 138096}, '2': {'precision': 0.34912111615953006, 'recall': 0.6259445671105504, 'f1-score': 0.4482374257921641, 'support': 145834}, 'accuracy': 0.35454204204204204, 'macro avg': {'precision': 0.3634558421619878, 'recall': 0.3480136972666292, 'f1-score': 0.279028199768748, 'support': 431568}, 'weighted avg': {'precision': 0.36318582447099046, 'recall': 0.35454204204204204, 'f1-score': 0.2844812599739397, 'support': 431568}}
[[61697    23 85918]
 [53802    28 84266]
 [54527    23 91284]]
Evaluating performance on  val set...
705/705 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960883
{'0': {'precision': 0.3595103912230667, 'recall': 0.4356438917917852, 'f1-score': 0.393932370905883, 'support': 60476}, '1': {'precision': 0.25, 'recall': 0.00010990822663076331, 'f1-score': 0.00021971985718209283, 'support': 54591}, '2': {'precision': 0.37442930900874827, 'recall': 0.6137083569253371, 'f1-score': 0.4650979391605878, 'support': 65347}, 'accuracy': 0.36835278858625164, 'macro avg': {'precision': 0.3279799000772717, 'recall': 0.349820718981251, 'f1-score': 0.28641667664121767, 'support': 180414}, 'weighted avg': {'precision': 0.3317776473854626, 'recall': 0.36835278858625164, 'f1-score': 0.30057647311159075, 'support': 180414}}
[[26346     7 34123]
 [21705     6 32880]
 [25232    11 40104]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
6546/6546 - 134s - 134s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0950565
{'0': {'precision': 0.39458699385667007, 'recall': 0.4100579679357814, 'f1-score': 0.4021737500582029, 'support': 621378}, '1': {'precision': 0.29073482428115016, 'recall': 0.00020466133047857015, 'f1-score': 0.0004090347230025845, 'support': 444637}, '2': {'precision': 0.37870964295945964, 'recall': 0.6395415200228288, 'f1-score': 0.47571866256696527, 'support': 609754}, 'accuracy': 0.3848113910688168, 'macro avg': {'precision': 0.3546771536990933, 'recall': 0.34993471642969626, 'f1-score': 0.2927671491160569, 'support': 1675769}, 'weighted avg': {'precision': 0.3612543595004264, 'recall': 0.3848113910688168, 'f1-score': 0.32233270206732256, 'support': 1675769}}
[[254801    110 366467]
 [171261     91 273285]
 [219679    112 389963]]
Evaluating performance on  train set...
1230/1230 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971048
{'0': {'precision': 0.36841033818801794, 'recall': 0.3990609897278524, 'f1-score': 0.38312361344500756, 'support': 108838}, '1': {'precision': 0.26229508196721313, 'recall': 0.0001580793360667885, 'f1-score': 0.0003159682451913583, 'support': 101215}, '2': {'precision': 0.35126717340053654, 'recall': 0.6602079891517136, 'f1-score': 0.4585567748803613, 'support': 104717}, 'accuracy': 0.35767068017917847, 'macro avg': {'precision': 0.32732419785192257, 'recall': 0.3531423527385443, 'f1-score': 0.28066545219018674, 'support': 314770}, 'weighted avg': {'precision': 0.32858558854402564, 'recall': 0.35767068017917847, 'f1-score': 0.28512589624554935, 'support': 314770}}
[[43433    28 65377]
 [38895    16 62304]
 [35565    17 69135]]
Evaluating performance on  val set...
444/444 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951562
{'0': {'precision': 0.3741092152950279, 'recall': 0.4577935020928842, 'f1-score': 0.4117422969187675, 'support': 40136}, '1': {'precision': 0.15789473684210525, 'recall': 8.669267446900737e-05, 'f1-score': 0.0001732902033271719, 'support': 34605}, '2': {'precision': 0.36098972022208053, 'recall': 0.5999017910216318, 'f1-score': 0.4507447035749655, 'support': 38693}, 'accuracy': 0.3666361055768112, 'macro avg': {'precision': 0.29766455745307124, 'recall': 0.352593995262995, 'f1-score': 0.2875534302323534, 'support': 113434}, 'weighted avg': {'precision': 0.30367411955899687, 'recall': 0.3666361055768112, 'f1-score': 0.2994900149165499, 'support': 113434}}
[[18374     6 21756]
 [15269     3 19333]
 [15471    10 23212]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
7633/7633 - 162s - 162s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000601
{'0': {'precision': 0.34411343516750564, 'recall': 0.4830029967839392, 'f1-score': 0.40189703407869937, 'support': 656704}, '1': {'precision': 0.2997416020671835, 'recall': 0.00018429811809378549, 'f1-score': 0.00036836974160132864, 'support': 629415}, '2': {'precision': 0.3608298177723118, 'recall': 0.5574730972690752, 'f1-score': 0.43809708715016094, 'support': 667869}, 'accuracy': 0.35293205485397044, 'macro avg': {'precision': 0.3348949516690003, 'recall': 0.3468867973903694, 'f1-score': 0.2801208303234872, 'support': 1953988}, 'weighted avg': {'precision': 0.3355340868823831, 'recall': 0.35293205485397044, 'f1-score': 0.28493046569703556, 'support': 1953988}}
[[317190    137 339377]
 [309154    116 320145]
 [295416    134 372319]]
Evaluating performance on  train set...
1586/1586 - 36s - 36s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997808
{'0': {'precision': 0.35329089534920854, 'recall': 0.47782456898103154, 'f1-score': 0.40622771934870877, 'support': 138915}, '1': {'precision': 0.36904761904761907, 'recall': 0.000231452100614468, 'f1-score': 0.00046261406794457583, 'support': 133937}, '2': {'precision': 0.34376950758271213, 'recall': 0.5632134638812435, 'f1-score': 0.42694432251554826, 'support': 132978}, 'accuracy': 0.34818273661385307, 'macro avg': {'precision': 0.3553693406598466, 'recall': 0.3470898283209632, 'f1-score': 0.2778782186440672, 'support': 405830}, 'weighted avg': {'precision': 0.35537125707599276, 'recall': 0.34818273661385307, 'f1-score': 0.2791003299243938, 'support': 405830}}
[[66377    32 72506]
 [63443    31 70463]
 [58062    21 74895]]
Evaluating performance on  val set...
574/574 - 12s - 12s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047847
{'0': {'precision': 0.28288584689501206, 'recall': 0.4764260624350665, 'f1-score': 0.354990323472491, 'support': 40426}, '1': {'precision': 0.3548387096774194, 'recall': 0.00017151321431355733, 'f1-score': 0.00034286070504628617, 'support': 64135}, '2': {'precision': 0.29443880142204165, 'recall': 0.5480455641158954, 'f1-score': 0.38307150998562867, 'support': 42314}, 'accuracy': 0.28909617021276596, 'macro avg': {'precision': 0.310721119331491, 'recall': 0.34154771325509187, 'f1-score': 0.24613489805438862, 'support': 146875}, 'weighted avg': {'precision': 0.3176334116433111, 'recall': 0.28909617021276596, 'f1-score': 0.2082186625467163, 'support': 146875}}
[[19260     8 21158]
 [29712    11 34412]
 [19112    12 23190]]
testing model on single stock: results/universal/W10/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
22048/22048 - 444s - 444s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984573
{'0': {'precision': 0.37791090997101484, 'recall': 0.24271575100184614, 'f1-score': 0.29558810825697646, 'support': 2135807}, '1': {'precision': 0.2547568710359408, 'recall': 0.00017071410204736503, 'f1-score': 0.00034119956422727854, 'support': 1411717}, '2': {'precision': 0.3746442021395397, 'recall': 0.763279950241922, 'f1-score': 0.5025966051762504, 'support': 2096544}, 'accuracy': 0.3754180495344847, 'macro avg': {'precision': 0.3357706610488318, 'recall': 0.3353888051152718, 'f1-score': 0.2661753043324847, 'support': 5644068}, 'weighted avg': {'precision': 0.34589367575499586, 'recall': 0.3754180495344847, 'f1-score': 0.2986350846516833, 'support': 5644068}}
[[ 518394     352 1617061]
 [ 357401     241 1054075]
 [ 495941     353 1600250]]
Evaluating performance on  train set...
5429/5429 - 113s - 113s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006286
{'0': {'precision': 0.32795289258806715, 'recall': 0.3126227612854423, 'f1-score': 0.3201043880842674, 'support': 465334}, '1': {'precision': 0.32905982905982906, 'recall': 0.000168673959807405, 'f1-score': 0.0003371750858263855, 'support': 456502}, '2': {'precision': 0.344657392333876, 'recall': 0.6967240789811096, 'f1-score': 0.46117798492156664, 'support': 467960}, 'accuracy': 0.339323181243866, 'macro avg': {'precision': 0.3338900379939241, 'recall': 0.3365051714087864, 'f1-score': 0.2605398493638868, 'support': 1389796}, 'weighted avg': {'precision': 0.3339410782025609, 'recall': 0.339323181243866, 'f1-score': 0.26257251154106837, 'support': 1389796}}
[[145474     80 319780]
 [156264     77 300161]
 [141844     77 326039]]
Evaluating performance on  val set...
1890/1890 - 38s - 38s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1008371
{'0': {'precision': 0.3085038305812556, 'recall': 0.3402010182815839, 'f1-score': 0.323578026251823, 'support': 151628}, '1': {'precision': 0.32926829268292684, 'recall': 0.00015616324264297612, 'f1-score': 0.00031217842731445615, 'support': 172896}, '2': {'precision': 0.3392935033409403, 'recall': 0.6745191431605537, 'f1-score': 0.4514837409914599, 'support': 159143}, 'accuracy': 0.3286476025860768, 'macro avg': {'precision': 0.32568854220170756, 'recall': 0.33829210822826017, 'f1-score': 0.25845798189019914, 'support': 483667}, 'weighted avg': {'precision': 0.3260573401891574, 'recall': 0.3286476025860768, 'f1-score': 0.2501058380217883, 'support': 483667}}
[[ 51584     30 100014]
 [ 63850     27 109019]
 [ 51773     25 107345]]
training model: results/universal/W10/deepVOL_L3/h1000
Epoch 1/50
8543/8543 - 638s - loss: 3.2755 - accuracy1000: 0.3808 - val_loss: 3.3406 - val_accuracy1000: 0.3646 - 638s/epoch - 75ms/step
Epoch 2/50
8543/8543 - 638s - loss: 3.2705 - accuracy1000: 0.3816 - val_loss: 3.2979 - val_accuracy1000: 0.3657 - 638s/epoch - 75ms/step
Epoch 3/50
8543/8543 - 642s - loss: 3.2683 - accuracy1000: 0.3815 - val_loss: 3.2984 - val_accuracy1000: 0.3605 - 642s/epoch - 75ms/step
Epoch 4/50
8543/8543 - 639s - loss: 3.2639 - accuracy1000: 0.3837 - val_loss: 3.3002 - val_accuracy1000: 0.3580 - 639s/epoch - 75ms/step
Epoch 5/50
8543/8543 - 636s - loss: 3.2593 - accuracy1000: 0.3883 - val_loss: 3.3219 - val_accuracy1000: 0.3533 - 636s/epoch - 74ms/step
Epoch 6/50
8543/8543 - 636s - loss: 3.2555 - accuracy1000: 0.3907 - val_loss: 3.3198 - val_accuracy1000: 0.3527 - 636s/epoch - 74ms/step
Epoch 7/50
8543/8543 - 633s - loss: 3.2495 - accuracy1000: 0.3950 - val_loss: 3.3323 - val_accuracy1000: 0.3531 - 633s/epoch - 74ms/step
Epoch 8/50
8543/8543 - 638s - loss: 3.2463 - accuracy1000: 0.3973 - val_loss: 3.3230 - val_accuracy1000: 0.3542 - 638s/epoch - 75ms/step
Epoch 9/50
8543/8543 - 642s - loss: 3.2429 - accuracy1000: 0.3994 - val_loss: 3.3672 - val_accuracy1000: 0.3526 - 642s/epoch - 75ms/step
Epoch 10/50
8543/8543 - 644s - loss: 3.2376 - accuracy1000: 0.4029 - val_loss: 3.3790 - val_accuracy1000: 0.3527 - 644s/epoch - 75ms/step
Epoch 11/50
8543/8543 - 640s - loss: 3.2312 - accuracy1000: 0.4063 - val_loss: 3.4037 - val_accuracy1000: 0.3546 - 640s/epoch - 75ms/step
Epoch 12/50
8543/8543 - 639s - loss: 3.2250 - accuracy1000: 0.4095 - val_loss: 3.4194 - val_accuracy1000: 0.3541 - 639s/epoch - 75ms/step
testing model in sample: results/universal/W10/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37289/37289 - 1582s - 1582s/epoch - 42ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1211596
{'0': {'precision': 0.3803255484784147, 'recall': 0.0007923301731537778, 'f1-score': 0.0015813658952284772, 'support': 3391263}, '1': {'precision': 0.2928291500098303, 'recall': 0.9991002400552378, 'f1-score': 0.4529127927885557, 'support': 2795190}, '2': {'precision': 0.3786407766990291, 'recall': 0.00015094559825367553, 'f1-score': 0.0003017708951792546, 'support': 3358826}, 'accuracy': 0.2929059485846354, 'macro avg': {'precision': 0.3505984917290914, 'recall': 0.33334783860888173, 'f1-score': 0.1515986431929878, 'support': 9545279}, 'weighted avg': {'precision': 0.3541107135540433, 'recall': 0.2929059485846354, 'f1-score': 0.1332966519735426, 'support': 9545279}}
[[   2687 3388113     463]
 [   2146 2792675     369]
 [   2232 3356087     507]]
Evaluating performance on  train set...
8543/8543 - 381s - 381s/epoch - 45ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088898
{'0': {'precision': 0.36330935251798563, 'recall': 0.0009728791029146467, 'f1-score': 0.001940561719881151, 'support': 726709}, '1': {'precision': 0.33071515320199096, 'recall': 0.9989104358947769, 'f1-score': 0.49691404941510353, 'support': 723225}, '2': {'precision': 0.34098360655737703, 'recall': 0.00014115360498163646, 'f1-score': 0.00028219039440177673, 'support': 736786}, 'accuracy': 0.3307455915709373, 'macro avg': {'precision': 0.3450027040924512, 'recall': 0.3333414895342244, 'f1-score': 0.16637893384312882, 'support': 2186720}, 'weighted avg': {'precision': 0.34500694669390064, 'recall': 0.3307455915709373, 'f1-score': 0.16508688857606874, 'support': 2186720}}
[[   707 725893    109]
 [   696 722437     92]
 [   543 736139    104]]
Evaluating performance on  val set...
3077/3077 - 133s - 133s/epoch - 43ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996792
{'0': {'precision': 0.3761969904240766, 'recall': 0.001139683789552208, 'f1-score': 0.0022724831216480875, 'support': 241295}, '1': {'precision': 0.36574174779264823, 'recall': 0.9989889127859101, 'f1-score': 0.5354491718283839, 'support': 287809}, '2': {'precision': 0.4606741573033708, 'recall': 0.00015901395832282935, 'f1-score': 0.000317918178716541, 'support': 257839}, 'accuracy': 0.3657621962454714, 'macro avg': {'precision': 0.40087096517336523, 'recall': 0.33342920351126165, 'f1-score': 0.1793465243762495, 'support': 786943}, 'weighted avg': {'precision': 0.40005182527803884, 'recall': 0.3657621962454714, 'f1-score': 0.19663101547999728, 'support': 786943}}
[[   275 240994     26]
 [   269 287518     22]
 [   187 257611     41]]
testing model out of sample: results/universal/W10/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
21333/21333 - 908s - 908s/epoch - 43ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1338738
{'0': {'precision': 0.3836301781068641, 'recall': 0.0018513868500347678, 'f1-score': 0.0036849900570625612, 'support': 2070880}, '1': {'precision': 0.24421268094775378, 'recall': 0.9980758444238481, 'f1-score': 0.39240928782310236, 'support': 1333572}, '2': {'precision': 0.3719412724306688, 'recall': 0.000110876228574263, 'f1-score': 0.0002216863721219664, 'support': 2056347}, 'accuracy': 0.24448217193125035, 'macro avg': {'precision': 0.33326137716176224, 'recall': 0.3333460358341524, 'f1-score': 0.13210532141742895, 'support': 5460799}, 'weighted avg': {'precision': 0.3451816439927178, 'recall': 0.24448217193125035, 'f1-score': 0.09731049890253311, 'support': 5460799}}
[[   3834 2066802     244]
 [   2425 1331006     141]
 [   3735 2052384     228]]
Evaluating performance on  train set...
4055/4055 - 171s - 171s/epoch - 42ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101831
{'0': {'precision': 0.32429441062534586, 'recall': 0.0016712535827855177, 'f1-score': 0.0033253698480884795, 'support': 350635}, '1': {'precision': 0.33319942949238535, 'recall': 0.9980937780220416, 'f1-score': 0.4996108678985201, 'support': 345710}, '2': {'precision': 0.375, 'recall': 0.00011432424113620707, 'f1-score': 0.0002285787966791603, 'support': 341135}, 'accuracy': 0.3331881096503065, 'macro avg': {'precision': 0.3441646133725771, 'recall': 0.3332931186153211, 'f1-score': 0.16772160551442925, 'support': 1037480}, 'weighted avg': {'precision': 0.3439343124102929, 'recall': 0.3331881096503065, 'f1-score': 0.16767980146671455, 'support': 1037480}}
[[   586 350018     31]
 [   625 345051     34]
 [   596 340500     39]]
Evaluating performance on  val set...
1545/1545 - 68s - 68s/epoch - 44ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076308
{'0': {'precision': 0.329635499207607, 'recall': 0.0016562751327807107, 'f1-score': 0.003295989351419018, 'support': 125583}, '1': {'precision': 0.34486528442210035, 'recall': 0.9982818500216605, 'f1-score': 0.5126359507645669, 'support': 136193}, '2': {'precision': 0.3333333333333333, 'recall': 9.01381366944843e-05, 'f1-score': 0.00018022753726579807, 'support': 133129}, 'accuracy': 0.34483989820336536, 'macro avg': {'precision': 0.3359447056543469, 'recall': 0.3333427544303786, 'f1-score': 0.17203738921775058, 'support': 394905}, 'weighted avg': {'precision': 0.33613447768861215, 'recall': 0.34483989820336536, 'f1-score': 0.17790441190921, 'support': 394905}}
[[   208 125363     12]
 [   222 135959     12]
 [   201 132916     12]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
519/519 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1235142
{'0': {'precision': 0.32142857142857145, 'recall': 0.0003376223881156919, 'f1-score': 0.0006745362563237773, 'support': 53314}, '1': {'precision': 0.29629601684108864, 'recall': 0.9992620489592345, 'f1-score': 0.45706537237169076, 'support': 39298}, '2': {'precision': 0.42857142857142855, 'recall': 0.00022501125056252811, 'f1-score': 0.0004497863514830455, 'support': 39998}, 'accuracy': 0.29632757710579893, 'macro avg': {'precision': 0.34876533894702955, 'recall': 0.3332748941993043, 'f1-score': 0.15272989832649922, 'support': 132610}, 'weighted avg': {'precision': 0.3462972907545733, 'recall': 0.29632757710579893, 'f1-score': 0.13585482078213532, 'support': 132610}}
[[   18 53286    10]
 [   27 39269     2]
 [   11 39978     9]]
Evaluating performance on  train set...
135/135 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101942
{'0': {'precision': 0.36363636363636365, 'recall': 0.0006909656244601831, 'f1-score': 0.001379310344827586, 'support': 11578}, '1': {'precision': 0.32841565105837073, 'recall': 0.9993789370952001, 'f1-score': 0.49437117338541553, 'support': 11271}, '2': {'precision': 0.3333333333333333, 'recall': 8.715356458079135e-05, 'f1-score': 0.00017426156661148385, 'support': 11474}, 'accuracy': 0.32843865629461294, 'macro avg': {'precision': 0.3417951160093559, 'recall': 0.33338568542808034, 'f1-score': 0.16530824843228487, 'support': 34323}, 'weighted avg': {'precision': 0.3419404273498057, 'recall': 0.32843865629461294, 'f1-score': 0.16286532726203223, 'support': 34323}}
[[    8 11569     1]
 [    6 11264     1]
 [    8 11465     1]]
Evaluating performance on  val set...
46/46 - 1s - 1s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056374
{'0': {'precision': 0.6, 'recall': 0.001292824822236587, 'f1-score': 0.0025800903031606105, 'support': 4641}, '1': {'precision': 0.3223098012337217, 'recall': 0.9997342545841085, 'f1-score': 0.48746355685131193, 'support': 3763}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3278}, 'accuracy': 0.32254750898818696, 'macro avg': {'precision': 0.30743660041124055, 'recall': 0.33367569313544837, 'f1-score': 0.16334788238482417, 'support': 11682}, 'weighted avg': {'precision': 0.3421889900738311, 'recall': 0.32254750898818696, 'f1-score': 0.1580465300058599, 'support': 11682}}
[[   6 4635    0]
 [   1 3762    0]
 [   3 3275    0]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
1840/1840 - 38s - 38s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1280404
{'0': {'precision': 0.4601593625498008, 'recall': 0.005764300018091418, 'f1-score': 0.011385970857336497, 'support': 160297}, '1': {'precision': 0.2844407857555678, 'recall': 0.9977258786038091, 'f1-score': 0.44267869500495366, 'support': 133678}, '2': {'precision': 0.4, 'recall': 0.0001355993491231242, 'f1-score': 0.00027110679348440006, 'support': 176992}, 'accuracy': 0.2852046958704113, 'macro avg': {'precision': 0.38153338276845616, 'recall': 0.33454192599034127, 'f1-score': 0.15144525755192487, 'support': 470967}, 'weighted avg': {'precision': 0.3876756560372132, 'recall': 0.2852046958704113, 'f1-score': 0.1296259043520736, 'support': 470967}}
[[   924 159359     14]
 [   282 133374     22]
 [   802 176166     24]]
Evaluating performance on  train set...
529/529 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021502
{'0': {'precision': 0.36649214659685864, 'recall': 0.004686976899899564, 'f1-score': 0.009255586407510246, 'support': 44805}, '1': {'precision': 0.33050966894884026, 'recall': 0.9951756639045853, 'f1-score': 0.49621908166560863, 'support': 44773}, '2': {'precision': 0.3333333333333333, 'recall': 0.00010911550967854571, 'f1-score': 0.0002181596055674331, 'support': 45823}, 'accuracy': 0.33066225507935687, 'macro avg': {'precision': 0.3434450496263441, 'recall': 0.33332391877138784, 'f1-score': 0.16856427589289547, 'support': 135401}, 'weighted avg': {'precision': 0.34337208269844394, 'recall': 0.33066225507935687, 'f1-score': 0.16722114474788746, 'support': 135401}}
[[  210 44590     5]
 [  211 44557     5]
 [  152 45666     5]]
Evaluating performance on  val set...
208/208 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1119447
{'0': {'precision': 0.3979933110367893, 'recall': 0.0068869726257306555, 'f1-score': 0.013539651837524177, 'support': 17279}, '1': {'precision': 0.3304342883128695, 'recall': 0.9944685218978102, 'f1-score': 0.49604619410626916, 'support': 17536}, '2': {'precision': 0.42857142857142855, 'recall': 0.00016423057973394647, 'f1-score': 0.00032833533982707676, 'support': 18267}, 'accuracy': 0.3308277758939, 'macro avg': {'precision': 0.3856663426403624, 'recall': 0.3338399083677583, 'f1-score': 0.16997139376120682, 'support': 53082}, 'weighted avg': {'precision': 0.386197513035934, 'recall': 0.3308277758939, 'f1-score': 0.16839258893034806, 'support': 53082}}
[[  119 17158     2]
 [   95 17439     2]
 [   85 18179     3]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
967/967 - 21s - 21s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1363721
{'0': {'precision': 0.3553459119496855, 'recall': 0.0010789134482264763, 'f1-score': 0.0021512950605884645, 'support': 104735}, '1': {'precision': 0.25440349528702616, 'recall': 0.9985550280261047, 'f1-score': 0.40549768350598225, 'support': 62977}, '2': {'precision': 0.4838709677419355, 'recall': 0.00018790634747641776, 'f1-score': 0.0003756668085852388, 'support': 79827}, 'accuracy': 0.2545619074166091, 'macro avg': {'precision': 0.3645401249928824, 'recall': 0.3332739492739359, 'f1-score': 0.13600821512505198, 'support': 247539}, 'weighted avg': {'precision': 0.3711119894347025, 'recall': 0.2545619074166091, 'f1-score': 0.10419502323535243, 'support': 247539}}
[[   113 104613      9]
 [    84  62886      7]
 [   121  79691     15]]
Evaluating performance on  train set...
220/220 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107478
{'0': {'precision': 0.25757575757575757, 'recall': 0.0009826589595375722, 'f1-score': 0.00195784866981458, 'support': 17300}, '1': {'precision': 0.32559215560657023, 'recall': 0.9986899563318777, 'f1-score': 0.49108209305758727, 'support': 18320}, '2': {'precision': 0.6666666666666666, 'recall': 0.00019375151368370065, 'f1-score': 0.0003873904411408648, 'support': 20645}, 'accuracy': 0.32554874255754024, 'macro avg': {'precision': 0.4166115266163315, 'recall': 0.333288788935033, 'f1-score': 0.16447577738951424, 'support': 56265}, 'weighted avg': {'precision': 0.4298274634338631, 'recall': 0.32554874255754024, 'f1-score': 0.16064147165129555, 'support': 56265}}
[[   17 17281     2]
 [   24 18296     0]
 [   25 20616     4]]
Evaluating performance on  val set...
79/79 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1122714
{'0': {'precision': 0.23529411764705882, 'recall': 0.0005919786887672044, 'f1-score': 0.0011809861234130497, 'support': 6757}, '1': {'precision': 0.33386661333866613, 'recall': 0.9986541049798116, 'f1-score': 0.5004308891303533, 'support': 6687}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6577}, 'accuracy': 0.3337495629588932, 'macro avg': {'precision': 0.18972024366190832, 'recall': 0.3330820278895263, 'f1-score': 0.1672039584179221, 'support': 20021}, 'weighted avg': {'precision': 0.19092195176748597, 'recall': 0.3337495629588932, 'f1-score': 0.16754214469060358, 'support': 20021}}
[[   4 6752    1]
 [   8 6678    1]
 [   5 6572    0]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1588/1588 - 33s - 33s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1197777
{'0': {'precision': 0.2571428571428571, 'recall': 0.00012521826238791225, 'f1-score': 0.00025031463158553454, 'support': 143749}, '1': {'precision': 0.305925247541815, 'recall': 0.9997586387223943, 'f1-score': 0.4684922778794659, 'support': 124295}, '2': {'precision': 0.18181818181818182, 'recall': 2.8934766568770708e-05, 'f1-score': 5.786032517502749e-05, 'support': 138242}, 'accuracy': 0.30591012242607424, 'macro avg': {'precision': 0.24829542883428468, 'recall': 0.333304263917117, 'f1-score': 0.15626681761207548, 'support': 406286}, 'weighted avg': {'precision': 0.24643703279351872, 'recall': 0.30591012242607424, 'f1-score': 0.14343400679343332, 'support': 406286}}
[[    18 143716     15]
 [    27 124265      3]
 [    25 138213      4]]
Evaluating performance on  train set...
295/295 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111099
{'0': {'precision': 0.375, 'recall': 0.00012727504136438844, 'f1-score': 0.00025446371771491584, 'support': 23571}, '1': {'precision': 0.32853736089030205, 'recall': 0.9998387226836546, 'f1-score': 0.4945653257812967, 'support': 24802}, '2': {'precision': 0.5, 'recall': 3.687723568241325e-05, 'f1-score': 7.374903204395442e-05, 'support': 27117}, 'accuracy': 0.32854682739435687, 'macro avg': {'precision': 0.40117912029676733, 'recall': 0.3333342916535671, 'f1-score': 0.16496451284368518, 'support': 75490}, 'weighted avg': {'precision': 0.40463648992980883, 'recall': 0.32854682739435687, 'f1-score': 0.1625938141054433, 'support': 75490}}
[[    3 23568     0]
 [    3 24798     1]
 [    2 27114     1]]
Evaluating performance on  val set...
131/131 - 3s - 3s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107414
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10336}, '1': {'precision': 0.34542837436650975, 'recall': 0.9997396285367124, 'f1-score': 0.5134502663308743, 'support': 11522}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11496}, 'accuracy': 0.3453558793548, 'macro avg': {'precision': 0.11514279145550325, 'recall': 0.3332465428455708, 'f1-score': 0.17115008877695811, 'support': 33354}, 'weighted avg': {'precision': 0.11932678927417777, 'recall': 0.3453558793548, 'f1-score': 0.1773692501248526, 'support': 33354}}
[[    0 10335     1]
 [    2 11519     1]
 [    3 11493     0]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
2104/2104 - 45s - 45s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1329372
{'0': {'precision': 0.3333333333333333, 'recall': 0.00018758567615016473, 'f1-score': 0.0003749603407331917, 'support': 207905}, '1': {'precision': 0.23799652652011183, 'recall': 0.9995709292891468, 'f1-score': 0.38445485628213383, 'support': 128184}, '2': {'precision': 0.379746835443038, 'recall': 0.0001481686356632028, 'f1-score': 0.0002962216923145282, 'support': 202472}, 'accuracy': 0.2380380309751356, 'macro avg': {'precision': 0.3170255650988277, 'recall': 0.33330222786698677, 'f1-score': 0.12837534610506052, 'support': 538561}, 'weighted avg': {'precision': 0.32809118129226483, 'recall': 0.2380380309751356, 'f1-score': 0.09176099648098447, 'support': 538561}}
[[    39 207839     27]
 [    33 128129     22]
 [    45 202397     30]]
Evaluating performance on  train set...
428/428 - 9s - 9s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1087273
{'0': {'precision': 0.3582089552238806, 'recall': 0.0006602839220864972, 'f1-score': 0.0013181381298915283, 'support': 36348}, '1': {'precision': 0.33501494256025005, 'recall': 0.9992095077141144, 'f1-score': 0.5017898086992231, 'support': 36686}, '2': {'precision': 0.25, 'recall': 5.485463521667581e-05, 'f1-score': 0.00010968520346605244, 'support': 36460}, 'accuracy': 0.33502292363051855, 'macro avg': {'precision': 0.31440796592804354, 'recall': 0.3333082154238059, 'f1-score': 0.16773921067752692, 'support': 109494}, 'weighted avg': {'precision': 0.3144056960860225, 'recall': 0.33502292363051855, 'f1-score': 0.16859893445488672, 'support': 109494}}
[[   24 36321     3]
 [   26 36657     3]
 [   17 36441     2]]
Evaluating performance on  val set...
141/141 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166205
{'0': {'precision': 0.2857142857142857, 'recall': 0.0003282455276546857, 'f1-score': 0.0006557377049180327, 'support': 12186}, '1': {'precision': 0.30199192088034543, 'recall': 0.9993546602747303, 'f1-score': 0.46382268623507766, 'support': 10847}, '2': {'precision': 0.5, 'recall': 0.00015527950310559007, 'f1-score': 0.00031046258925799446, 'support': 12880}, 'accuracy': 0.3020076295491883, 'macro avg': {'precision': 0.3625687355315437, 'recall': 0.3332793951018302, 'f1-score': 0.15492962884308456, 'support': 35913}, 'weighted avg': {'precision': 0.36748310226111414, 'recall': 0.3020076295491883, 'f1-score': 0.14042475581025424, 'support': 35913}}
[[    4 12180     2]
 [    7 10840     0]
 [    3 12875     2]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
5267/5267 - 108s - 108s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0861496
{'0': {'precision': 0.289238621863037, 'recall': 0.0017619364718258585, 'f1-score': 0.0035025367637590457, 'support': 385939}, '1': {'precision': 0.422610577283904, 'recall': 0.9981518988230421, 'f1-score': 0.5938072792216369, 'support': 569774}, '2': {'precision': 0.2761904761904762, 'recall': 7.388986842507568e-05, 'f1-score': 0.00014774021157417194, 'support': 392476}, 'accuracy': 0.42236659696822926, 'macro avg': {'precision': 0.32934655844580574, 'recall': 0.3333292417210977, 'f1-score': 0.19915251873232334, 'support': 1348189}, 'weighted avg': {'precision': 0.3418060204302892, 'recall': 0.42236659696822926, 'f1-score': 0.2520015359378953, 'support': 1348189}}
[[   680 385220     39]
 [  1016 568721     37]
 [   655 391792     29]]
Evaluating performance on  train set...
1060/1060 - 23s - 23s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1059117
{'0': {'precision': 0.39593908629441626, 'recall': 0.002621496269409155, 'f1-score': 0.005208507228473173, 'support': 89262}, '1': {'precision': 0.3299082962010537, 'recall': 0.9978431898439944, 'f1-score': 0.49587102721734444, 'support': 89484}, '2': {'precision': 0.3888888888888889, 'recall': 7.566177026924782e-05, 'f1-score': 0.0001512941049332685, 'support': 92517}, 'accuracy': 0.330056071045443, 'macro avg': {'precision': 0.37157875712811966, 'recall': 0.3335134492945577, 'f1-score': 0.16707694285025032, 'support': 271263}, 'weighted avg': {'precision': 0.37175236590099137, 'recall': 0.330056071045443, 'f1-score': 0.16534301415397948, 'support': 271263}}
[[  234 89024     4]
 [  186 89291     7]
 [  171 92339     7]]
Evaluating performance on  val set...
404/404 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0755206
{'0': {'precision': 0.26973684210526316, 'recall': 0.0015529126581319598, 'f1-score': 0.0030880469985689538, 'support': 26402}, '1': {'precision': 0.44388160316138153, 'recall': 0.9981921937619794, 'f1-score': 0.6145027420587564, 'support': 45912}, '2': {'precision': 0.25, 'recall': 6.432522835456066e-05, 'f1-score': 0.00012861736334405147, 'support': 31092}, 'accuracy': 0.44361062220760883, 'macro avg': {'precision': 0.3212061484222149, 'recall': 0.3332698105494886, 'f1-score': 0.2059064688068898, 'support': 103406}, 'weighted avg': {'precision': 0.34112221988674263, 'recall': 0.44361062220760883, 'f1-score': 0.2736647726565087, 'support': 103406}}
[[   41 26360     1]
 [   78 45829     5]
 [   33 31057     2]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
10110/10110 - 207s - 207s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1468291
{'0': {'precision': 0.41123540856031127, 'recall': 0.0016497126417157793, 'f1-score': 0.003286242188858842, 'support': 1025027}, '1': {'precision': 0.19957997992016058, 'recall': 0.998412305023312, 'f1-score': 0.3326617546589561, 'support': 516472}, '2': {'precision': 0.37623762376237624, 'recall': 0.00010892392714709125, 'f1-score': 0.0002177848037787574, 'support': 1046602}, 'accuracy': 0.1999369421827046, 'macro avg': {'precision': 0.32901767074761606, 'recall': 0.3333903138640583, 'f1-score': 0.11205526055053124, 'support': 2588101}, 'weighted avg': {'precision': 0.35484547087792395, 'recall': 0.1999369421827046, 'f1-score': 0.0677743653495533, 'support': 2588101}}
[[   1691 1023214     122]
 [    753  515652      67]
 [   1668 1044820     114]]
Evaluating performance on  train set...
1686/1686 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1118366
{'0': {'precision': 0.3487179487179487, 'recall': 0.0013961701137468004, 'f1-score': 0.002781205052522512, 'support': 146114}, '1': {'precision': 0.33146132603095774, 'recall': 0.9985179178143483, 'f1-score': 0.4977071253345228, 'support': 143042}, '2': {'precision': 0.4383561643835616, 'recall': 0.00022470016571637222, 'f1-score': 0.000449170088079447, 'support': 142412}, 'accuracy': 0.3315027990953917, 'macro avg': {'precision': 0.37284514637748933, 'recall': 0.3333795960312705, 'f1-score': 0.16697916682504158, 'support': 431568}, 'weighted avg': {'precision': 0.3725777709174137, 'recall': 0.3315027990953917, 'f1-score': 0.1660534674204961, 'support': 431568}}
[[   204 145885     25]
 [   196 142830     16]
 [   185 142195     32]]
Evaluating performance on  val set...
705/705 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126325
{'0': {'precision': 0.3805970149253731, 'recall': 0.0017727414925788176, 'f1-score': 0.003529045427810262, 'support': 57538}, '1': {'precision': 0.3259236641221374, 'recall': 0.9985202571690989, 'f1-score': 0.49143852100502683, 'support': 58794}, '2': {'precision': 0.42857142857142855, 'recall': 0.00014044505477357137, 'f1-score': 0.00028079809057298413, 'support': 64082}, 'accuracy': 0.32601682796235326, 'macro avg': {'precision': 0.3783640358729797, 'recall': 0.3334778145721504, 'f1-score': 0.16508278817447, 'support': 180414}, 'weighted avg': {'precision': 0.3798200873484727, 'recall': 0.32601682796235326, 'f1-score': 0.16137708117460392, 'support': 180414}}
[[  102 57430     6]
 [   81 58707     6]
 [   85 63988     9]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
6546/6546 - 134s - 134s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099904
{'0': {'precision': 0.39953271028037385, 'recall': 0.001256521419648762, 'f1-score': 0.0025051641541774714, 'support': 544360}, '1': {'precision': 0.35975886239253385, 'recall': 0.9989996731933982, 'f1-score': 0.5290108235509083, 'support': 602803}, '2': {'precision': 0.4050632911392405, 'recall': 0.00012107316224182094, 'f1-score': 0.0002420739687270692, 'support': 528606}, 'accuracy': 0.3598037677030665, 'macro avg': {'precision': 0.38811828793738273, 'recall': 0.33345908925842965, 'f1-score': 0.1772526872246043, 'support': 1675769}, 'weighted avg': {'precision': 0.38696994261797435, 'recall': 0.3598037677030665, 'f1-score': 0.19118445584101343, 'support': 1675769}}
[[   684 543636     40]
 [   549 602200     54]
 [   479 528063     64]]
Evaluating performance on  train set...
1230/1230 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1054274
{'0': {'precision': 0.4254658385093168, 'recall': 0.001286517856304407, 'f1-score': 0.0025652788570465586, 'support': 106489}, '1': {'precision': 0.3382091014337875, 'recall': 0.9988352542245517, 'f1-score': 0.5053163305795335, 'support': 106461}, '2': {'precision': 0.2777777777777778, 'recall': 9.821253191907288e-05, 'f1-score': 0.00019635563933396167, 'support': 101820}, 'accuracy': 0.3382914509006576, 'macro avg': {'precision': 0.3471509059069607, 'recall': 0.33340666153759174, 'f1-score': 0.16935932169197135, 'support': 314770}, 'weighted avg': {'precision': 0.3481807165806603, 'recall': 0.3382914509006576, 'f1-score': 0.1718386402174055, 'support': 314770}}
[[   137 106342     10]
 [   108 106337     16]
 [    77 101733     10]]
Evaluating performance on  val set...
444/444 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981705
{'0': {'precision': 0.3709677419354839, 'recall': 0.0012681958535509484, 'f1-score': 0.0025277503022310146, 'support': 36272}, '1': {'precision': 0.37372239580575123, 'recall': 0.9988676574663836, 'f1-score': 0.5439340218899337, 'support': 42390}, '2': {'precision': 0.5, 'recall': 0.00017255262855170826, 'f1-score': 0.0003449862005519779, 'support': 34772}, 'accuracy': 0.3737327432692138, 'macro avg': {'precision': 0.4148967125804117, 'recall': 0.33343613531616206, 'f1-score': 0.18226891946423893, 'support': 113434}, 'weighted avg': {'precision': 0.41155063114841817, 'recall': 0.3737327432692138, 'f1-score': 0.20418080652222795, 'support': 113434}}
[[   46 36224     2]
 [   44 42342     4]
 [   34 34732     6]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
7633/7633 - 157s - 157s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173642
{'0': {'precision': 0.36025307033866766, 'recall': 0.0028474817583199856, 'f1-score': 0.0056503028719940805, 'support': 679899}, '1': {'precision': 0.3002334170240459, 'recall': 0.9971822630876465, 'f1-score': 0.46151351927055706, 'support': 586641}, '2': {'precision': 0.3352941176470588, 'recall': 8.291536232558681e-05, 'f1-score': 0.00016578972627243616, 'support': 687448}, 'accuracy': 0.3004015377781235, 'macro avg': {'precision': 0.3319268683365908, 'recall': 0.3333708867360974, 'f1-score': 0.15577653728960786, 'support': 1953988}, 'weighted avg': {'precision': 0.33345251089301897, 'recall': 0.3004015377781235, 'f1-score': 0.14058344245026647, 'support': 1953988}}
[[  1936 677904     59]
 [  1599 584988     54]
 [  1839 685552     57]]
Evaluating performance on  train set...
1586/1586 - 34s - 34s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108856
{'0': {'precision': 0.33127208480565373, 'recall': 0.0026921282170932195, 'f1-score': 0.0053408532547159744, 'support': 139295}, '1': {'precision': 0.33615879244984603, 'recall': 0.9973385340674972, 'f1-score': 0.5028343298616565, 'support': 136391}, '2': {'precision': 0.38636363636363635, 'recall': 0.00013062453897221538, 'f1-score': 0.00026116078286785266, 'support': 130144}, 'accuracy': 0.33615060493310006, 'macro avg': {'precision': 0.35126483787304535, 'recall': 0.33338709560785423, 'f1-score': 0.1694787812997468, 'support': 405830}, 'weighted avg': {'precision': 0.3505814947267072, 'recall': 0.33615060493310006, 'f1-score': 0.17090904996476952, 'support': 405830}}
[[   375 138907     13]
 [   349 136028     14]
 [   408 129719     17]]
Evaluating performance on  val set...
574/574 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989993
{'0': {'precision': 0.27486910994764396, 'recall': 0.002361620296439576, 'f1-score': 0.004683005151305666, 'support': 44461}, '1': {'precision': 0.381901966138722, 'recall': 0.9971302270863783, 'f1-score': 0.5522800643689962, 'support': 56102}, '2': {'precision': 0.15384615384615385, 'recall': 4.318535152876144e-05, 'f1-score': 8.634646519158122e-05, 'support': 46312}, 'accuracy': 0.38160340425531913, 'macro avg': {'precision': 0.27020574331083996, 'recall': 0.33317834424478227, 'f1-score': 0.18568313866183117, 'support': 146875}, 'weighted avg': {'precision': 0.27759212036507136, 'recall': 0.38160340425531913, 'f1-score': 0.21239983755409417, 'support': 146875}}
[[  105 44351     5]
 [  155 55941     6]
 [  122 46188     2]]
testing model on single stock: results/universal/W10/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
22048/22048 - 454s - 454s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1353434
{'0': {'precision': 0.39087301587301587, 'recall': 0.0001826680476494702, 'f1-score': 0.00036516544126165583, 'support': 2156918}, '1': {'precision': 0.24177885019285392, 'recall': 0.9996328702075272, 'f1-score': 0.38937941700084516, 'support': 1364640}, '2': {'precision': 0.39648033126293997, 'recall': 0.00018044673523328513, 'f1-score': 0.000360729294797775, 'support': 2122510}, 'accuracy': 0.2418319552492989, 'macro avg': {'precision': 0.3430440657762699, 'recall': 0.3333319949968033, 'f1-score': 0.13003510391230153, 'support': 5644068}, 'weighted avg': {'precision': 0.3569332619108899, 'recall': 0.2418319552492989, 'f1-score': 0.09442055111043485, 'support': 5644068}}
[[    394 2156171     353]
 [    271 1364139     230]
 [    343 2121784     383]]
Evaluating performance on  train set...
5429/5429 - 111s - 111s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108105
{'0': {'precision': 0.2825278810408922, 'recall': 0.0003285903904605021, 'f1-score': 0.0006564173432371739, 'support': 462582}, '1': {'precision': 0.3293104689502253, 'recall': 0.999403545952087, 'f1-score': 0.4953873394828253, 'support': 457705}, '2': {'precision': 0.3383838383838384, 'recall': 0.00014270226981804397, 'f1-score': 0.00028528423038191896, 'support': 469509}, 'accuracy': 0.329293651730182, 'macro avg': {'precision': 0.31674072945831866, 'recall': 0.3332916128707885, 'f1-score': 0.16544301368548148, 'support': 1389796}, 'weighted avg': {'precision': 0.31680449363379837, 'recall': 0.329293651730182, 'f1-score': 0.16346201354672074, 'support': 1389796}}
[[   152 462363     67]
 [   209 457432     64]
 [   177 469265     67]]
Evaluating performance on  val set...
1890/1890 - 39s - 39s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033103
{'0': {'precision': 0.2995169082125604, 'recall': 0.00041057971206442126, 'f1-score': 0.0008200353144240245, 'support': 151006}, '1': {'precision': 0.35237202720818234, 'recall': 0.9993077108108583, 'f1-score': 0.5210229523441001, 'support': 170449}, '2': {'precision': 0.3157894736842105, 'recall': 0.00014795452864153083, 'f1-score': 0.0002957704821058858, 'support': 162212}, 'accuracy': 0.3523436579299394, 'macro avg': {'precision': 0.32255946970165106, 'recall': 0.3332887483505214, 'f1-score': 0.17404625271354335, 'support': 483667}, 'weighted avg': {'precision': 0.32360105612418566, 'recall': 0.3523436579299394, 'f1-score': 0.1839688235464334, 'support': 483667}}
[[    62 150918     26]
 [    92 170331     26]
 [    53 162135     24]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        55 (peak)  15.64 (ave)

============================================
