This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W7/deepLOB_L1/h300
Epoch 1/50
12475/12475 - 227s - loss: 3.2505 - accuracy300: 0.3929 - val_loss: 3.4557 - val_accuracy300: 0.3223 - 227s/epoch - 18ms/step
Epoch 2/50
12475/12475 - 203s - loss: 3.2267 - accuracy300: 0.4082 - val_loss: 3.4978 - val_accuracy300: 0.3271 - 203s/epoch - 16ms/step
Epoch 3/50
12475/12475 - 203s - loss: 3.2152 - accuracy300: 0.4149 - val_loss: 3.6593 - val_accuracy300: 0.3231 - 203s/epoch - 16ms/step
Epoch 4/50
12475/12475 - 204s - loss: 3.2047 - accuracy300: 0.4192 - val_loss: 3.7387 - val_accuracy300: 0.3286 - 204s/epoch - 16ms/step
Epoch 5/50
12475/12475 - 200s - loss: 3.1979 - accuracy300: 0.4220 - val_loss: 3.7637 - val_accuracy300: 0.3219 - 200s/epoch - 16ms/step
Epoch 6/50
12475/12475 - 200s - loss: 3.1923 - accuracy300: 0.4242 - val_loss: 3.7983 - val_accuracy300: 0.3318 - 200s/epoch - 16ms/step
Epoch 7/50
12475/12475 - 199s - loss: 3.1882 - accuracy300: 0.4256 - val_loss: 3.8012 - val_accuracy300: 0.3261 - 199s/epoch - 16ms/step
Epoch 8/50
12475/12475 - 202s - loss: 3.1854 - accuracy300: 0.4266 - val_loss: 3.7727 - val_accuracy300: 0.3225 - 202s/epoch - 16ms/step
Epoch 9/50
12475/12475 - 209s - loss: 3.1817 - accuracy300: 0.4280 - val_loss: 3.9516 - val_accuracy300: 0.3227 - 209s/epoch - 17ms/step
Epoch 10/50
12475/12475 - 209s - loss: 3.1794 - accuracy300: 0.4292 - val_loss: 4.0179 - val_accuracy300: 0.3239 - 209s/epoch - 17ms/step
Epoch 11/50
12475/12475 - 218s - loss: 3.1767 - accuracy300: 0.4299 - val_loss: 3.9302 - val_accuracy300: 0.3235 - 218s/epoch - 17ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 217s - 217s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1403123
{'0': {'precision': 0.2981533654506115, 'recall': 0.8014032172934619, 'f1-score': 0.4346134979660395, 'support': 2845746}, '1': {'precision': 0.4086234959294432, 'recall': 0.14563811632712548, 'f1-score': 0.2147403136648082, 'support': 3845827}, '2': {'precision': 0.30249163793547057, 'recall': 0.052223899155614484, 'f1-score': 0.08907020495638554, 'support': 2813999}, 'accuracy': 0.3143048098525791, 'macro avg': {'precision': 0.33642283310517507, 'recall': 0.33308841092540065, 'f1-score': 0.24614133886241107, 'support': 9505572}, 'weighted avg': {'precision': 0.34413238753609304, 'recall': 0.3143048098525791, 'f1-score': 0.24336222873705202, 'support': 9505572}}
[[2280590  402908  162248]
 [3109109  560099  176619]
 [2259351  407690  146958]]
Evaluating performance on  train set...
12475/12475 - 71s - 71s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1375773
{'0': {'precision': 0.33381450064494117, 'recall': 0.7143813736903376, 'f1-score': 0.45501202087771087, 'support': 1073750}, '1': {'precision': 0.3189624722077008, 'recall': 0.2352142185984481, 'f1-score': 0.2707602463518522, 'support': 1055744}, '2': {'precision': 0.34054535947264203, 'recall': 0.03735179909551613, 'f1-score': 0.06731980678620662, 'support': 1063590}, 'accuracy': 0.33043916163809034, 'macro avg': {'precision': 0.331107444108428, 'recall': 0.3289824637947673, 'f1-score': 0.2643640246719232, 'support': 3193084}, 'weighted avg': {'precision': 0.3311459000788767, 'recall': 0.33043916163809034, 'f1-score': 0.26495492641022705, 'support': 3193084}}
[[767067 267506  39177]
 [769665 248326  37753]
 [761152 262711  39727]]
Evaluating performance on  val set...
3866/3866 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1504109
{'0': {'precision': 0.3187880329149334, 'recall': 0.8335650163866943, 'f1-score': 0.46119642247080767, 'support': 315805}, '1': {'precision': 0.3443948125797033, 'recall': 0.14409084945405776, 'f1-score': 0.20317542539764763, 'support': 342985}, '2': {'precision': 0.3337680577849117, 'recall': 0.020138493759306562, 'f1-score': 0.037985089111397814, 'support': 330412}, 'accuracy': 0.3228046445518711, 'macro avg': {'precision': 0.3323169677598495, 'recall': 0.33259811986668625, 'f1-score': 0.23411897899328438, 'support': 989202}, 'weighted avg': {'precision': 0.33267025444366094, 'recall': 0.3228046445518711, 'f1-score': 0.23037255155355604, 'support': 989202}}
[[263244  46199   6362]
 [286644  49421   6920]
 [275877  47881   6654]]
testing model out of sample: results/universal/W7/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 86s - 86s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1546111
{'0': {'precision': 0.285562312093734, 'recall': 0.8684886884471218, 'f1-score': 0.4298036010262698, 'support': 1089815}, '1': {'precision': 0.35922641523730625, 'recall': 0.09201933217305788, 'f1-score': 0.14650896997372692, 'support': 1545610}, '2': {'precision': 0.3227519027782128, 'recall': 0.01809653181271771, 'f1-score': 0.03427147954046385, 'support': 1138837}, 'accuracy': 0.2939189171286996, 'macro avg': {'precision': 0.322513543369751, 'recall': 0.3262015174776325, 'f1-score': 0.2035280168468202, 'support': 3774262}, 'weighted avg': {'precision': 0.3269502327908336, 'recall': 0.2939189171286996, 'f1-score': 0.19444377986450315, 'support': 3774262}}
[[ 946492  123621   19702]
 [1379841  142226   23543]
 [ 988152  130076   20609]]
Evaluating performance on  train set...
5285/5285 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1340481
{'0': {'precision': 0.3348251353682112, 'recall': 0.690006540596846, 'f1-score': 0.45086727660468484, 'support': 454087}, '1': {'precision': 0.3389101004389838, 'recall': 0.237155863381152, 'f1-score': 0.2790462291686282, 'support': 449894}, '2': {'precision': 0.3302007898321362, 'recall': 0.07510280498813146, 'f1-score': 0.12237249233719258, 'support': 448665}, 'accuracy': 0.3354270075097254, 'macro avg': {'precision': 0.334645341879777, 'recall': 0.33408840298870984, 'f1-score': 0.2840953327035019, 'support': 1352646}, 'weighted avg': {'precision': 0.33464993748613936, 'recall': 0.3354270075097254, 'f1-score': 0.28475924043071793, 'support': 1352646}}
[[313323 104733  36031]
 [310879 106695  32320]
 [311579 103390  33696]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1420898
{'0': {'precision': 0.3205491842804386, 'recall': 0.7613519146907968, 'f1-score': 0.4511516541328027, 'support': 140571}, '1': {'precision': 0.35417607472106266, 'recall': 0.21144690812488492, 'f1-score': 0.26480336974558094, 'support': 152076}, '2': {'precision': 0.3415382313332336, 'recall': 0.03139895589014149, 'f1-score': 0.057510724206786656, 'support': 145387}, 'accuracy': 0.328159457941621, 'macro avg': {'precision': 0.338754496778245, 'recall': 0.3347325929019411, 'f1-score': 0.2578219160283901, 'support': 438034}, 'weighted avg': {'precision': 0.33919015181837636, 'recall': 0.328159457941621, 'f1-score': 0.25580294701046785, 'support': 438034}}
[[107024  29031   4516]
 [115635  32156   4285]
 [111218  29604   4565]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
696/696 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.161458
{'0': {'precision': 0.297925100909239, 'recall': 0.9315386356776336, 'f1-score': 0.45146307902592453, 'support': 53008}, '1': {'precision': 0.35981398953691146, 'recall': 0.054172318732770314, 'f1-score': 0.09416716319519276, 'support': 68559}, '2': {'precision': 0.3270575578267886, 'recall': 0.010788367017406889, 'f1-score': 0.02088772845953003, 'support': 56357}, 'accuracy': 0.30181987815022143, 'macro avg': {'precision': 0.328265549424313, 'recall': 0.33216644047593696, 'f1-score': 0.1888393235602158, 'support': 177924}, 'weighted avg': {'precision': 0.3310002239388862, 'recall': 0.30181987815022143, 'f1-score': 0.1774034483672757, 'support': 177924}}
[[49379  3091   538]
 [64132  3714   713]
 [52232  3517   608]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1352102
{'0': {'precision': 0.34004550421899354, 'recall': 0.771052524678068, 'f1-score': 0.47195285692973293, 'support': 24617}, '1': {'precision': 0.3431562343156234, 'recall': 0.2005195240489358, 'f1-score': 0.2531270659791088, 'support': 23868}, '2': {'precision': 0.33228699551569507, 'recall': 0.03151716217940539, 'f1-score': 0.05757352084223613, 'support': 23511}, 'accuracy': 0.3404078004333574, 'macro avg': {'precision': 0.33849624468343736, 'recall': 0.33436307030213636, 'f1-score': 0.2608844812503593, 'support': 71996}, 'weighted avg': {'precision': 0.33854315141915897, 'recall': 0.3404078004333574, 'f1-score': 0.2640884401682096, 'support': 71996}}
[[18981  4850   786]
 [18379  4786   703]
 [18459  4311   741]]
Evaluating performance on  val set...
73/73 - 1s - 620ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1440988
{'0': {'precision': 0.3361022825772898, 'recall': 0.7405697915008754, 'f1-score': 0.46236398867193323, 'support': 6283}, '1': {'precision': 0.3051417587698222, 'recall': 0.21851342050929112, 'f1-score': 0.2546621215159415, 'support': 5812}, '2': {'precision': 0.30278884462151395, 'recall': 0.023701855605800716, 'f1-score': 0.04396240057845263, 'support': 6413}, 'accuracy': 0.32823643829695265, 'macro avg': {'precision': 0.3146776286562087, 'recall': 0.32759502253865574, 'f1-score': 0.25366283692210917, 'support': 18508}, 'weighted avg': {'precision': 0.3148367951135232, 'recall': 0.32823643829695265, 'f1-score': 0.2521644729839002, 'support': 18508}}
[[4653 1457  173]
 [4365 1270  177]
 [4826 1435  152]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
2006/2006 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128763
{'0': {'precision': 0.33794319577943194, 'recall': 0.6813482072084673, 'f1-score': 0.4517981607765009, 'support': 171576}, '1': {'precision': 0.3472204541343107, 'recall': 0.2922503440030678, 'f1-score': 0.3173727321442242, 'support': 177324}, '2': {'precision': 0.32505233006499945, 'recall': 0.03588761174968071, 'f1-score': 0.06463874162029531, 'support': 164430}, 'accuracy': 0.3401846765238735, 'macro avg': {'precision': 0.336738659992914, 'recall': 0.33649538765373865, 'f1-score': 0.2779365448470068, 'support': 513330}, 'weighted avg': {'precision': 0.3370187134992153, 'recall': 0.3401846765238735, 'f1-score': 0.28134742148862624, 'support': 513330}}
[[116903  48764   5909]
 [119157  51823   6344]
 [109865  48664   5901]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1227322
{'0': {'precision': 0.33912871333247935, 'recall': 0.6219991456642461, 'f1-score': 0.43893799974376946, 'support': 46820}, '1': {'precision': 0.3506827451675829, 'recall': 0.2488777950245417, 'f1-score': 0.2911370663002405, 'support': 47674}, '2': {'precision': 0.3334268087492989, 'recall': 0.13811769625723114, 'f1-score': 0.19532469239235786, 'support': 43043}, 'accuracy': 0.3412318139846005, 'macro avg': {'precision': 0.3410794224164537, 'recall': 0.336331545648673, 'f1-score': 0.3084665861454559, 'support': 137537}, 'weighted avg': {'precision': 0.34134920552536485, 'recall': 0.3412318139846005, 'f1-score': 0.31146605190926957, 'support': 137537}}
[[29122 11368  6330]
 [30254 11865  5555]
 [26497 10601  5945]]
Evaluating performance on  val set...
153/153 - 1s - 988ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1365837
{'0': {'precision': 0.3230547435024629, 'recall': 0.6406448538754765, 'f1-score': 0.4295184090727578, 'support': 12592}, '1': {'precision': 0.3259104429616529, 'recall': 0.3046516870819869, 'f1-score': 0.31492270643983533, 'support': 13307}, '2': {'precision': 0.3463414634146341, 'recall': 0.04319063189111094, 'f1-score': 0.07680346156446488, 'support': 13151}, 'accuracy': 0.32494238156209987, 'macro avg': {'precision': 0.3317688832929166, 'recall': 0.3294957242828581, 'f1-score': 0.2737481923590193, 'support': 39050}, 'weighted avg': {'precision': 0.3318702222801429, 'recall': 0.32494238156209987, 'f1-score': 0.27168283187383696, 'support': 39050}}
[[8067 4006  519]
 [8700 4054  553]
 [8204 4379  568]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1431382
{'0': {'precision': 0.3299428142870535, 'recall': 0.8132766765944336, 'f1-score': 0.469437054931049, 'support': 77896}, '1': {'precision': 0.3463122137011684, 'recall': 0.16666460250424187, 'f1-score': 0.2250315632812435, 'support': 80743}, '2': {'precision': 0.32961446123428895, 'recall': 0.029430307921216554, 'f1-score': 0.05403590818062903, 'support': 79306}, 'accuracy': 0.3326062745592469, 'macro avg': {'precision': 0.33528982974083693, 'recall': 0.33645719567329735, 'f1-score': 0.24950150879764052, 'support': 237945}, 'weighted avg': {'precision': 0.33538808125921654, 'recall': 0.3326062745592469, 'f1-score': 0.2480504489655147, 'support': 237945}}
[[63351 12311  2234]
 [64773 13457  2513]
 [63882 13090  2334]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1457137
{'0': {'precision': 0.32872434098288483, 'recall': 0.7408452451086788, 'f1-score': 0.45538666793729443, 'support': 32251}, '1': {'precision': 0.34231259848428003, 'recall': 0.1418664676431259, 'f1-score': 0.20059801248790782, 'support': 32157}, '2': {'precision': 0.3293657688966116, 'recall': 0.11448675746685592, 'f1-score': 0.16991237702530085, 'support': 33113}, 'accuracy': 0.33065698670030047, 'macro avg': {'precision': 0.33346756945459216, 'recall': 0.3323994900728869, 'f1-score': 0.2752990191501677, 'support': 97521}, 'weighted avg': {'precision': 0.3334227874608701, 'recall': 0.33065698670030047, 'f1-score': 0.27443949770468024, 'support': 97521}}
[[23893  4257  4101]
 [23977  4562  3618]
 [24814  4508  3791]]
Evaluating performance on  val set...
114/114 - 1s - 814ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1575757
{'0': {'precision': 0.31963489009864515, 'recall': 0.8451298701298702, 'f1-score': 0.46384128775504135, 'support': 9240}, '1': {'precision': 0.3493855028843742, 'recall': 0.14172347136026045, 'f1-score': 0.20165026056745802, 'support': 9829}, '2': {'precision': 0.3156297420333839, 'recall': 0.020783373301358914, 'f1-score': 0.03899878128808475, 'support': 10008}, 'accuracy': 0.32362348247755957, 'macro avg': {'precision': 0.32821671167213445, 'recall': 0.3358789049304965, 'f1-score': 0.2348301098701947, 'support': 29077}, 'weighted avg': {'precision': 0.3283130636115177, 'recall': 0.32362348247755957, 'f1-score': 0.22898558011848813, 'support': 29077}}
[[7809 1191  240]
 [8225 1393  211]
 [8397 1403  208]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1065/1065 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1722192
{'0': {'precision': 0.29963142775287077, 'recall': 0.9484901220648071, 'f1-score': 0.4554002765600636, 'support': 81596}, '1': {'precision': 0.3523513753327418, 'recall': 0.04269479297702373, 'f1-score': 0.07616106790437192, 'support': 93009}, '2': {'precision': 0.3431338637149775, 'recall': 0.010137966274910577, 'f1-score': 0.019694066963798253, 'support': 97850}, 'accuracy': 0.3022737699803637, 'macro avg': {'precision': 0.33170555560019666, 'recall': 0.33377429377224715, 'f1-score': 0.18375180380941125, 'support': 272455}, 'weighted avg': {'precision': 0.3332521833394754, 'recall': 0.3022737699803637, 'f1-score': 0.16945759917535128, 'support': 272455}}
[[77393  3317   886]
 [88025  3971  1013]
 [92876  3982   992]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1368568
{'0': {'precision': 0.33850319087217173, 'recall': 0.7430803192392597, 'f1-score': 0.46512369462971326, 'support': 35334}, '1': {'precision': 0.32373095302497523, 'recall': 0.21247447998343047, 'f1-score': 0.2565604959002483, 'support': 33797}, '2': {'precision': 0.31819757365684576, 'recall': 0.027402167099489567, 'f1-score': 0.050458967734843076, 'support': 33501}, 'accuracy': 0.3347396523501442, 'macro avg': {'precision': 0.32681057251799756, 'recall': 0.32765232210739326, 'f1-score': 0.2573810527549349, 'support': 102632}, 'weighted avg': {'precision': 0.3270105199230298, 'recall': 0.3347396523501442, 'f1-score': 0.261088954556785, 'support': 102632}}
[[26256  8009  1069]
 [25718  7181   898]
 [25591  6992   918]]
Evaluating performance on  val set...
123/123 - 1s - 959ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1613618
{'0': {'precision': 0.3023506405395698, 'recall': 0.8010997144971979, 'f1-score': 0.4390102567074231, 'support': 9457}, '1': {'precision': 0.3263537906137184, 'recall': 0.17251908396946564, 'f1-score': 0.2257178526841448, 'support': 10480}, '2': {'precision': 0.39158163265306123, 'recall': 0.02682628451590353, 'f1-score': 0.050212626758259736, 'support': 11444}, 'accuracy': 0.30881743730282657, 'macro avg': {'precision': 0.34009535460211643, 'recall': 0.33348169432752234, 'f1-score': 0.23831357871660921, 'support': 31381}, 'weighted avg': {'precision': 0.34290742606341773, 'recall': 0.30881743730282657, 'f1-score': 0.22599268329350441, 'support': 31381}}
[[7576 1667  214]
 [8409 1808  263]
 [9072 2065  307]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
1646/1646 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1684401
{'0': {'precision': 0.26630285600602377, 'recall': 0.9429236366230338, 'f1-score': 0.4153121999210589, 'support': 112148}, '1': {'precision': 0.4248557838275478, 'recall': 0.0467147761351813, 'f1-score': 0.08417422339854931, 'support': 179729}, '2': {'precision': 0.3013544018058691, 'recall': 0.010316209198813056, 'f1-score': 0.019949491175899222, 'support': 129408}, 'accuracy': 0.27410897610880997, 'macro avg': {'precision': 0.3308376805464803, 'recall': 0.33331820731900935, 'f1-score': 0.1731453048318358, 'support': 421285}, 'weighted avg': {'precision': 0.3447117943809982, 'recall': 0.27410897610880997, 'f1-score': 0.15259647352275904, 'support': 421285}}
[[105747   5226   1175]
 [169413   8396   1920]
 [121933   6140   1335]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1304082
{'0': {'precision': 0.3381856164992444, 'recall': 0.6704853385032276, 'f1-score': 0.44959854634629165, 'support': 45391}, '1': {'precision': 0.35056639395846445, 'recall': 0.2507201368259969, 'f1-score': 0.2923533116406004, 'support': 44436}, '2': {'precision': 0.3275647022139071, 'recall': 0.09385120496727939, 'f1-score': 0.1459002447874169, 'support': 44773}, 'accuracy': 0.3400965824665676, 'macro avg': {'precision': 0.3387722375572053, 'recall': 0.3383522267655013, 'f1-score': 0.29595070092476966, 'support': 134600}, 'weighted avg': {'precision': 0.33874001495303707, 'recall': 0.3400965824665676, 'f1-score': 0.29666516369341206, 'support': 134600}}
[[30434 10320  4637]
 [29306 11141  3989]
 [30252 10319  4202]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1433116
{'0': {'precision': 0.3099101202287849, 'recall': 0.6863420939250323, 'f1-score': 0.4270090602047928, 'support': 11605}, '1': {'precision': 0.33601031132262543, 'recall': 0.25395279130760584, 'f1-score': 0.2892748922367804, 'support': 13345}, '2': {'precision': 0.3153846153846154, 'recall': 0.03968702105348068, 'f1-score': 0.07050225693200544, 'support': 12397}, 'accuracy': 0.3171874581626369, 'macro avg': {'precision': 0.3204350156453419, 'recall': 0.32666063542870627, 'f1-score': 0.2622620697911929, 'support': 37347}, 'weighted avg': {'precision': 0.3210535686073463, 'recall': 0.3171874581626369, 'f1-score': 0.2594540407465801, 'support': 37347}}
[[7965 3151  489]
 [9377 3389  579]
 [8359 3546  492]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
5929/5929 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1246659
{'0': {'precision': 0.3267554969073513, 'recall': 0.6371599108563645, 'f1-score': 0.4319787848693667, 'support': 502111}, '1': {'precision': 0.38871747639880266, 'recall': 0.18405249090112893, 'f1-score': 0.24981903337308228, 'support': 550343}, '2': {'precision': 0.3100753156745125, 'recall': 0.18526226621574263, 'f1-score': 0.23194386123582805, 'support': 465119}, 'accuracy': 0.334340423821457, 'macro avg': {'precision': 0.3418494296602222, 'recall': 0.3354915559910787, 'f1-score': 0.3045805598260924, 'support': 1517573}, 'weighted avg': {'precision': 0.34411352348296054, 'recall': 0.334340423821457, 'f1-score': 0.3046106860937378, 'support': 1517573}}
[[319925  79676 102510]
 [359833 101292  89218]
 [299338  79612  86169]]
Evaluating performance on  train set...
1254/1254 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1457944
{'0': {'precision': 0.32785329378174355, 'recall': 0.7823833214877991, 'f1-score': 0.46207618344023194, 'support': 105525}, '1': {'precision': 0.3284405157732544, 'recall': 0.19150747115566483, 'f1-score': 0.2419427103557454, 'support': 105740}, '2': {'precision': 0.3348464619492657, 'recall': 0.022861726661987367, 'f1-score': 0.042801191197426466, 'support': 109703}, 'accuracy': 0.32812928391615365, 'macro avg': {'precision': 0.3303800905014212, 'recall': 0.33225083976848374, 'f1-score': 0.2489400283311346, 'support': 320968}, 'weighted avg': {'precision': 0.3304369294739747, 'recall': 0.32812928391615365, 'f1-score': 0.24625205792626767, 'support': 320968}}
[[82561 20422  2542]
 [83050 20250  2440]
 [86212 20983  2508]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1366351
{'0': {'precision': 0.32025138207989984, 'recall': 0.6953739878829058, 'f1-score': 0.4385366637504686, 'support': 35322}, '1': {'precision': 0.3435997802499657, 'recall': 0.2655433196231923, 'f1-score': 0.2995704171593648, 'support': 37685}, '2': {'precision': 0.3358891182542023, 'recall': 0.031460612087062204, 'f1-score': 0.0575325167319106, 'support': 36204}, 'accuracy': 0.32696340112259753, 'macro avg': {'precision': 0.3332467601946893, 'recall': 0.3307926398643868, 'f1-score': 0.2652131992139147, 'support': 109211}, 'weighted avg': {'precision': 0.3334921086137964, 'recall': 0.32696340112259753, 'f1-score': 0.2642793348967302, 'support': 109211}}
[[24562  9635  1125]
 [26551 10007  1127]
 [25583  9482  1139]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
5331/5331 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1539744
{'0': {'precision': 0.30241380687946945, 'recall': 0.9207157765679506, 'f1-score': 0.45528645012594515, 'support': 411078}, '1': {'precision': 0.3989110707803993, 'recall': 0.07222063672071558, 'f1-score': 0.12229960780822505, 'support': 532604}, '2': {'precision': 0.312488725873369, 'recall': 0.012346646900628143, 'f1-score': 0.023754727977054316, 'support': 420924}, 'accuracy': 0.3093552278093457, 'macro avg': {'precision': 0.33793786784441254, 'recall': 0.3350943533964314, 'f1-score': 0.20044692863707483, 'support': 1364606}, 'weighted avg': {'precision': 0.34318425926299917, 'recall': 0.3093552278093457, 'f1-score': 0.19221257914810486, 'support': 1364606}}
[[378486  27738   4854]
 [487559  38465   6580]
 [385505  30222   5197]]
Evaluating performance on  train set...
2013/2013 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1290228
{'0': {'precision': 0.336532783787614, 'recall': 0.653037021759307, 'f1-score': 0.444169508037019, 'support': 174546}, '1': {'precision': 0.33481050183189165, 'recall': 0.25462312632595135, 'f1-score': 0.28926241269820424, 'support': 172989}, '2': {'precision': 0.3260599334073252, 'recall': 0.08755073699017148, 'f1-score': 0.13803699718550747, 'support': 167777}, 'accuracy': 0.33517752351973173, 'macro avg': {'precision': 0.3324677396756103, 'recall': 0.33173696169180994, 'f1-score': 0.29048963930691024, 'support': 515312}, 'weighted avg': {'precision': 0.33254483231065995, 'recall': 0.33517752351973173, 'f1-score': 0.2924959242883381, 'support': 515312}}
[[113985  44545  16016]
 [114597  44047  14345]
 [110122  42966  14689]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.140407
{'0': {'precision': 0.32730084952028016, 'recall': 0.7141364306026655, 'f1-score': 0.4488747711855282, 'support': 58374}, '1': {'precision': 0.3383405018695831, 'recall': 0.25796351531730466, 'f1-score': 0.29273492286115005, 'support': 60683}, '2': {'precision': 0.33496275605214154, 'recall': 0.024442859084114688, 'f1-score': 0.04556104356636271, 'support': 58872}, 'accuracy': 0.3303564905102597, 'macro avg': {'precision': 0.33353470248066824, 'recall': 0.33218093500136164, 'f1-score': 0.26239024587101367, 'support': 177929}, 'weighted avg': {'precision': 0.33360106468956957, 'recall': 0.3303564905102597, 'f1-score': 0.26217715478649406, 'support': 177929}}
[[41687 15270  1417]
 [43589 15654  1440]
 [42090 15343  1439]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1599284
{'0': {'precision': 0.26705022448166543, 'recall': 0.9362780442438112, 'f1-score': 0.41556949735318854, 'support': 287091}, '1': {'precision': 0.43023255813953487, 'recall': 0.049301076488654484, 'f1-score': 0.08846481967085698, 'support': 484817}, '2': {'precision': 0.2788383244368045, 'recall': 0.010230977088188233, 'f1-score': 0.019737747962663508, 'support': 301242}, 'accuracy': 0.27561943810278156, 'macro avg': {'precision': 0.3253737023526682, 'recall': 0.3319366992735513, 'f1-score': 0.174590688328903, 'support': 1073150}, 'weighted avg': {'precision': 0.34408012735050325, 'recall': 0.27561943810278156, 'f1-score': 0.15668019355612803, 'support': 1073150}}
[[268797  15299   2995]
 [455939  23902   4976]
 [281805  16355   3082]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1287438
{'0': {'precision': 0.344322640306695, 'recall': 0.7091924478059064, 'f1-score': 0.46357383746932757, 'support': 108154}, '1': {'precision': 0.32348111658456485, 'recall': 0.25315872081616636, 'f1-score': 0.28403193942295524, 'support': 101940}, '2': {'precision': 0.3611877332467954, 'recall': 0.04249186336174396, 'f1-score': 0.07603822406681525, 'support': 104773}, 'accuracy': 0.339702159959602, 'macro avg': {'precision': 0.34299716337935177, 'recall': 0.3349476773279389, 'f1-score': 0.27454800031969934, 'support': 314867}, 'weighted avg': {'precision': 0.343186990824149, 'recall': 0.339702159959602, 'f1-score': 0.2764924033721735, 'support': 314867}}
[[76702 27423  4029]
 [72288 25807  3845]
 [73772 26549  4452]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1403577
{'0': {'precision': 0.3185688192316757, 'recall': 0.6486997210474219, 'f1-score': 0.4272970650122991, 'support': 33339}, '1': {'precision': 0.316870876531574, 'recall': 0.2876290423772315, 'f1-score': 0.3015426931356135, 'support': 35066}, '2': {'precision': 0.3411159477641472, 'recall': 0.025472813238770684, 'f1-score': 0.04740561498061428, 'support': 33840}, 'accuracy': 0.31859748642965424, 'macro avg': {'precision': 0.32551854784246564, 'recall': 0.3206005255544747, 'f1-score': 0.25874845770950894, 'support': 102245}, 'weighted avg': {'precision': 0.3254489089262042, 'recall': 0.31859748642965424, 'f1-score': 0.2584357077498406, 'support': 102245}}
[[21627 10887   825]
 [24140 10086   840]
 [22121 10857   862]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
6143/6143 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1522099
{'0': {'precision': 0.26704534595257845, 'recall': 0.8017489700127386, 'f1-score': 0.4006445915102022, 'support': 435685}, '1': {'precision': 0.3378697710785804, 'recall': 0.1137190686794108, 'f1-score': 0.17016468220327396, 'support': 683975}, '2': {'precision': 0.33233051961328386, 'recall': 0.025125761303059345, 'f1-score': 0.04671932068514553, 'support': 452842}, 'accuracy': 0.2788352574432338, 'macro avg': {'precision': 0.3124152122148142, 'recall': 0.3135312666650696, 'f1-score': 0.2058428647995406, 'support': 1572502}, 'weighted avg': {'precision': 0.31665164520461014, 'recall': 0.2788352574432338, 'f1-score': 0.1984733233915184, 'support': 1572502}}
[[349310  75487  10888]
 [594223  77781  11971]
 [364522  76942  11378]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1381842
{'0': {'precision': 0.33206616719201265, 'recall': 0.709524937669927, 'f1-score': 0.4524025320097828, 'support': 177282}, '1': {'precision': 0.3383290558972124, 'recall': 0.2375881299449117, 'f1-score': 0.2791476610620942, 'support': 176444}, '2': {'precision': 0.3350375249893488, 'recall': 0.05695550194717284, 'f1-score': 0.09736005028475647, 'support': 179491}, 'accuracy': 0.3336915364663917, 'macro avg': {'precision': 0.33514424935952464, 'recall': 0.3346895231873372, 'f1-score': 0.2763034144522112, 'support': 533217}, 'weighted avg': {'precision': 0.33513880200504736, 'recall': 0.3336915364663917, 'f1-score': 0.2755576217072218, 'support': 533217}}
[[125786  40965  10531]
 [124764  41921   9759]
 [128248  41020  10223]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.140838
{'0': {'precision': 0.3147925183401467, 'recall': 0.8166118869055186, 'f1-score': 0.45441455096627503, 'support': 55069}, '1': {'precision': 0.3864140834290088, 'recall': 0.16179274760844137, 'f1-score': 0.22808543320871502, 'support': 62407}, '2': {'precision': 0.36269597543235815, 'recall': 0.0388928367159471, 'f1-score': 0.0702523323523887, 'support': 57697}, 'accuracy': 0.3271679996346469, 'macro avg': {'precision': 0.35463419240050453, 'recall': 0.3390991570766357, 'f1-score': 0.2509174388424596, 'support': 175173}, 'weighted avg': {'precision': 0.3560863979697126, 'recall': 0.3271679996346469, 'f1-score': 0.24725061143643054, 'support': 175173}}
[[44970  7914  2185]
 [50552 10097  1758]
 [47334  8119  2244]]
testing model on single stock: results/universal/W7/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
23942/23942 - 132s - 132s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1402823
{'0': {'precision': 0.2960008473308584, 'recall': 0.8306333912248831, 'f1-score': 0.4364649665521508, 'support': 1803372}, '1': {'precision': 0.42415029797217735, 'recall': 0.14916306280985098, 'f1-score': 0.22070847067279492, 'support': 2540334}, '2': {'precision': 0.29140752163111455, 'recall': 0.028579142110433872, 'f1-score': 0.05205327544195142, 'support': 1785358}, 'accuracy': 0.3145486814952495, 'macro avg': {'precision': 0.33718622231138345, 'recall': 0.336125198715056, 'f1-score': 0.23640890422229902, 'support': 6129064}, 'weighted avg': {'precision': 0.3477773789123236, 'recall': 0.3145486814952495, 'f1-score': 0.23506291719839778, 'support': 6129064}}
[[1497941  255875   49556]
 [2086895  378924   74515]
 [1475761  258573   51024]]
Evaluating performance on  train set...
9052/9052 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1388515
{'0': {'precision': 0.33221034314280007, 'recall': 0.7097299583374576, 'f1-score': 0.4525780079013087, 'support': 777917}, '1': {'precision': 0.3145294422379554, 'recall': 0.23760196088406754, 'f1-score': 0.2707066173339684, 'support': 766593}, '2': {'precision': 0.33460446034083735, 'recall': 0.03293682125891505, 'f1-score': 0.059970446066428, 'support': 772570}, 'accuracy': 0.32786999154107754, 'macro avg': {'precision': 0.3271147485738643, 'recall': 0.32675624682681337, 'f1-score': 0.261085023767235, 'support': 2317080}, 'weighted avg': {'precision': 0.32715897169957847, 'recall': 0.32786999154107754, 'f1-score': 0.2615021024703512, 'support': 2317080}}
[[552111 200018  25788]
 [559635 182144  24814]
 [550186 196938  25446]]
Evaluating performance on  val set...
2763/2763 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1545135
{'0': {'precision': 0.31870733048249333, 'recall': 0.893644905484351, 'f1-score': 0.46984889997594176, 'support': 225095}, '1': {'precision': 0.3565345080763583, 'recall': 0.09359416020483106, 'f1-score': 0.14826670780543932, 'support': 246447}, '2': {'precision': 0.3314719483465666, 'recall': 0.01611295610608509, 'f1-score': 0.030732019058867306, 'support': 235773}, 'accuracy': 0.32237404833772787, 'macro avg': {'precision': 0.3355712623018061, 'recall': 0.3344506739317557, 'f1-score': 0.2162825422800828, 'support': 707315}, 'weighted avg': {'precision': 0.33614220275883605, 'recall': 0.32237404833772787, 'f1-score': 0.21142815267338888, 'support': 707315}}
[[201155  20430   3510]
 [219229  23066   4152]
 [210775  21199   3799]]
training model: results/universal/W7/deepLOB_L1/h500
Epoch 1/50
12475/12475 - 198s - loss: 3.2267 - accuracy500: 0.4086 - val_loss: 3.5339 - val_accuracy500: 0.3188 - 198s/epoch - 16ms/step
Epoch 2/50
12475/12475 - 195s - loss: 3.1947 - accuracy500: 0.4254 - val_loss: 3.4995 - val_accuracy500: 0.3262 - 195s/epoch - 16ms/step
Epoch 3/50
12475/12475 - 194s - loss: 3.1802 - accuracy500: 0.4315 - val_loss: 3.6337 - val_accuracy500: 0.3201 - 194s/epoch - 16ms/step
Epoch 4/50
12475/12475 - 194s - loss: 3.1706 - accuracy500: 0.4347 - val_loss: 3.7103 - val_accuracy500: 0.3212 - 194s/epoch - 16ms/step
Epoch 5/50
12475/12475 - 191s - loss: 3.1617 - accuracy500: 0.4380 - val_loss: 3.8822 - val_accuracy500: 0.3205 - 191s/epoch - 15ms/step
Epoch 6/50
12475/12475 - 195s - loss: 3.1552 - accuracy500: 0.4402 - val_loss: 4.0109 - val_accuracy500: 0.3194 - 195s/epoch - 16ms/step
Epoch 7/50
12475/12475 - 194s - loss: 3.1504 - accuracy500: 0.4418 - val_loss: 3.8391 - val_accuracy500: 0.3194 - 194s/epoch - 16ms/step
Epoch 8/50
12475/12475 - 195s - loss: 3.1485 - accuracy500: 0.4427 - val_loss: 3.5595 - val_accuracy500: 0.3263 - 195s/epoch - 16ms/step
Epoch 9/50
12475/12475 - 200s - loss: 3.1460 - accuracy500: 0.4438 - val_loss: 3.5706 - val_accuracy500: 0.3278 - 200s/epoch - 16ms/step
Epoch 10/50
12475/12475 - 198s - loss: 3.1399 - accuracy500: 0.4455 - val_loss: 3.7589 - val_accuracy500: 0.3226 - 198s/epoch - 16ms/step
Epoch 11/50
12475/12475 - 197s - loss: 3.1354 - accuracy500: 0.4475 - val_loss: 3.6951 - val_accuracy500: 0.3223 - 197s/epoch - 16ms/step
Epoch 12/50
12475/12475 - 197s - loss: 3.1315 - accuracy500: 0.4487 - val_loss: 3.8792 - val_accuracy500: 0.3226 - 197s/epoch - 16ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 192s - 192s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.146065
{'0': {'precision': 0.30227799658986165, 'recall': 0.6542621031609394, 'f1-score': 0.4135091416234012, 'support': 2904200}, '1': {'precision': 0.3898559032968743, 'recall': 0.3172555993517578, 'f1-score': 0.34982875486535564, 'support': 3727619}, '2': {'precision': 0.3155709305386198, 'recall': 0.020442605888536698, 'f1-score': 0.03839781118031422, 'support': 2873753}, 'accuracy': 0.3304864767738333, 'macro avg': {'precision': 0.33590161014178527, 'recall': 0.3306534361337446, 'f1-score': 0.26724523588969035, 'support': 9505572}, 'weighted avg': {'precision': 0.34064051468296885, 'recall': 0.3304864767738333, 'f1-score': 0.27513203703659134, 'support': 9505572}}
[[1900108  925970   78122]
 [2495719 1182608   49292]
 [1890135  924871   58747]]
Evaluating performance on  train set...
12475/12475 - 67s - 67s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1582255
{'0': {'precision': 0.33501044972521093, 'recall': 0.7059147752677861, 'f1-score': 0.45438196837188427, 'support': 1066803}, '1': {'precision': 0.3382427764527064, 'recall': 0.2948490380485687, 'f1-score': 0.31505874812967327, 'support': 1068713}, '2': {'precision': 0.33370173887415266, 'recall': 0.004282466943023994, 'f1-score': 0.00845641092667625, 'support': 1057568}, 'accuracy': 0.33594794249070803, 'macro avg': {'precision': 0.3356516550173567, 'recall': 0.33501542675312623, 'f1-score': 0.25929904247607793, 'support': 3193084}, 'weighted avg': {'precision': 0.33565884446728156, 'recall': 0.33594794249070803, 'f1-score': 0.2600578802455062, 'support': 3193084}}
[[753072 309294   4437]
 [748998 315109   4606]
 [745836 307203   4529]]
Evaluating performance on  val set...
3866/3866 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.164397
{'0': {'precision': 0.31827401507898695, 'recall': 0.6868879493677333, 'f1-score': 0.4349917591141174, 'support': 314108}, '1': {'precision': 0.34694772409257096, 'recall': 0.3157848402148076, 'f1-score': 0.33063361457110724, 'support': 340770}, '2': {'precision': 0.342082239720035, 'recall': 0.001169524174154413, 'f1-score': 0.0023310787648263467, 'support': 334324}, 'accuracy': 0.32729210009684573, 'macro avg': {'precision': 0.33576799296386434, 'recall': 0.3346141045855651, 'f1-score': 0.255985484150017, 'support': 989202}, 'weighted avg': {'precision': 0.33619836290223515, 'recall': 0.32729210009684573, 'f1-score': 0.2528136254133991, 'support': 989202}}
[[215757  97992    359]
 [232767 107610    393]
 [229373 104560    391]]
testing model out of sample: results/universal/W7/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 78s - 78s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1484526
{'0': {'precision': 0.29646875644343557, 'recall': 0.6891847822191641, 'f1-score': 0.41459143061869974, 'support': 1116168}, '1': {'precision': 0.3978333943205317, 'recall': 0.3140169012343772, 'f1-score': 0.3509906801252461, 'support': 1488767}, '2': {'precision': 0.30715728068207315, 'recall': 0.0011707589066189356, 'f1-score': 0.0023326267865297194, 'support': 1169327}, 'accuracy': 0.32804108458819237, 'macro avg': {'precision': 0.3338198104820134, 'recall': 0.33479081412005346, 'f1-score': 0.25597157917682517, 'support': 3774262}, 'weighted avg': {'precision': 0.3397637655924465, 'recall': 0.32804108458819237, 'f1-score': 0.261779556716319, 'support': 3774262}}
[[ 769246  345662    1260]
 [1019441  467498    1828]
 [ 806008  361950    1369]]
Evaluating performance on  train set...
5285/5285 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.164829
{'0': {'precision': 0.3364068552024195, 'recall': 0.6936189671846351, 'f1-score': 0.45307247719009397, 'support': 457042}, '1': {'precision': 0.3330605198911726, 'recall': 0.2667736132739086, 'f1-score': 0.2962544257407292, 'support': 446952}, '2': {'precision': 0.3368580060422961, 'recall': 0.03926651391278764, 'f1-score': 0.07033436470705659, 'support': 448652}, 'accuracy': 0.33553864056079713, 'macro avg': {'precision': 0.3354417937119627, 'recall': 0.3332196981237771, 'f1-score': 0.2732204225459599, 'support': 1352646}, 'weighted avg': {'precision': 0.33545077243322485, 'recall': 0.33553864056079713, 'f1-score': 0.2743070342189573, 'support': 1352646}}
[[317013 120069  19960]
 [312996 119235  14721]
 [312341 118694  17617]]
Evaluating performance on  val set...
1714/1714 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1698936
{'0': {'precision': 0.3286282652291383, 'recall': 0.7092666430077448, 'f1-score': 0.4491496482480704, 'support': 143709}, '1': {'precision': 0.3312181728205865, 'recall': 0.2907499789804097, 'f1-score': 0.309667549718294, 'support': 142724}, '2': {'precision': 0.44122196442382056, 'recall': 0.0075263355782613575, 'f1-score': 0.014800210134447132, 'support': 151601}, 'accuracy': 0.3300337416730208, 'macro avg': {'precision': 0.3670228008245151, 'recall': 0.3358476525221386, 'f1-score': 0.2578724693669372, 'support': 438034}, 'weighted avg': {'precision': 0.36844015052273393, 'recall': 0.3300337416730208, 'f1-score': 0.2533765982153624, 'support': 438034}}
[[101928  40663   1118]
 [100900  41497    327]
 [107334  43126   1141]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1548876
{'0': {'precision': 0.27889580132483693, 'recall': 0.6698864667567404, 'f1-score': 0.39382802404296435, 'support': 49589}, '1': {'precision': 0.40130096291743494, 'recall': 0.32884704170572354, 'f1-score': 0.3614791347876569, 'support': 71477}, '2': {'precision': 0.2839506172839506, 'recall': 0.001213549544479229, 'f1-score': 0.0024167702842332007, 'support': 56858}, 'accuracy': 0.3191980845754367, 'macro avg': {'precision': 0.3213824605087408, 'recall': 0.33331568600231437, 'f1-score': 0.2525746430382848, 'support': 177924}, 'weighted avg': {'precision': 0.32968468006495866, 'recall': 0.3191980845754367, 'f1-score': 0.25575186442697356, 'support': 177924}}
[[33219 16299    71]
 [47869 23505   103]
 [38021 18768    69]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1598899
{'0': {'precision': 0.3387691640150419, 'recall': 0.7656601152290279, 'f1-score': 0.4697123519458545, 'support': 24473}, '1': {'precision': 0.3405113565843366, 'recall': 0.2255982238302771, 'f1-score': 0.271391829063211, 'support': 24322}, '2': {'precision': 0.3526315789473684, 'recall': 0.0086634196801862, 'f1-score': 0.016911362584661985, 'support': 23201}, 'accuracy': 0.3392688482693483, 'macro avg': {'precision': 0.34397069984891565, 'recall': 0.33330725291316377, 'f1-score': 0.2526718478645758, 'support': 71996}, 'weighted avg': {'precision': 0.34382493789852564, 'recall': 0.3392688482693483, 'f1-score': 0.25679791903679455, 'support': 71996}}
[[18738  5516   219]
 [18685  5487   150]
 [17889  5111   201]]
Evaluating performance on  val set...
73/73 - 1s - 577ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1668557
{'0': {'precision': 0.3156635802469136, 'recall': 0.693154862758387, 'f1-score': 0.43378220761319053, 'support': 5902}, '1': {'precision': 0.34664017341040465, 'recall': 0.3061094273408837, 'f1-score': 0.32511647606946215, 'support': 6269}, '2': {'precision': 0.5, 'recall': 0.0009468202619536059, 'f1-score': 0.0018900614269963774, 'support': 6337}, 'accuracy': 0.3250486276204884, 'macro avg': {'precision': 0.3874345845524394, 'recall': 0.33340370345374143, 'f1-score': 0.253596248369883, 'support': 18508}, 'weighted avg': {'precision': 0.3892713257903129, 'recall': 0.3250486276204884, 'f1-score': 0.24909850319188379, 'support': 18508}}
[[4091 1806    5]
 [4349 1919    1]
 [4520 1811    6]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
2006/2006 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1660895
{'0': {'precision': 0.3594505546272511, 'recall': 0.7006222183813681, 'f1-score': 0.4751353895574679, 'support': 185144}, '1': {'precision': 0.29521222366196814, 'recall': 0.2990458676474508, 'f1-score': 0.2971166799617367, 'support': 150084}, '2': {'precision': 0.294811320754717, 'recall': 0.0007018450101627157, 'f1-score': 0.00140035625063016, 'support': 178102}, 'accuracy': 0.34037169072526446, 'macro avg': {'precision': 0.31649136634797875, 'recall': 0.3334566436796605, 'f1-score': 0.25788414192327824, 'support': 513330}, 'weighted avg': {'precision': 0.3182421263340292, 'recall': 0.34037169072526446, 'f1-score': 0.25872310717969893, 'support': 513330}}
[[129716  55262    166]
 [105069  44882    133]
 [126088  51889    125]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.156105
{'0': {'precision': 0.35129924192629597, 'recall': 0.6597539398428177, 'f1-score': 0.4584745156908999, 'support': 48606}, '1': {'precision': 0.3139362286970863, 'recall': 0.2562198541783511, 'f1-score': 0.2821567537520845, 'support': 44575}, '2': {'precision': 0.323508558695432, 'recall': 0.07200829651005501, 'f1-score': 0.11779675081598408, 'support': 44356}, 'accuracy': 0.33942139206177246, 'macro avg': {'precision': 0.32958134310627146, 'recall': 0.3293273635104079, 'f1-score': 0.28614267341965616, 'support': 137537}, 'weighted avg': {'precision': 0.3302275313314726, 'recall': 0.33942139206177246, 'f1-score': 0.29146151426426953, 'support': 137537}}
[[32068 13177  3361]
 [29836 11421  3318]
 [29380 11782  3194]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145603
{'0': {'precision': 0.29479216435738176, 'recall': 0.693918159010295, 'f1-score': 0.41379488237721834, 'support': 11559}, '1': {'precision': 0.4047962037115499, 'recall': 0.30827310273618996, 'f1-score': 0.35000183170311755, 'support': 15496}, '2': {'precision': 0.15, 'recall': 0.0005002084201750729, 'f1-score': 0.0009970918155380142, 'support': 11995}, 'accuracy': 0.327887323943662, 'macro avg': {'precision': 0.2831961226896439, 'recall': 0.33423049005555333, 'f1-score': 0.254931268631958, 'support': 39050}, 'weighted avg': {'precision': 0.29396861973165567, 'recall': 0.327887323943662, 'f1-score': 0.26168101269647004, 'support': 39050}}
[[ 8021  3528    10]
 [10695  4777    24]
 [ 8493  3496     6]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.160988
{'0': {'precision': 0.3216515534413557, 'recall': 0.6715896746159019, 'f1-score': 0.43497562528269645, 'support': 77324}, '1': {'precision': 0.33767102622292766, 'recall': 0.31615470590402733, 'f1-score': 0.32655883285759596, 'support': 81419}, '2': {'precision': 0.3082706766917293, 'recall': 0.0010353273907224565, 'f1-score': 0.0020637237630241104, 'support': 79202}, 'accuracy': 0.32676879110718865, 'macro avg': {'precision': 0.32253108545200426, 'recall': 0.3295932359702172, 'f1-score': 0.2545327273011055, 'support': 237945}, 'weighted avg': {'precision': 0.3226790902842349, 'recall': 0.32676879110718865, 'f1-score': 0.2537796545893835, 'support': 237945}}
[[51930 25306    88]
 [55582 25741    96]
 [53936 25184    82]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1753821
{'0': {'precision': 0.32371344655854933, 'recall': 0.6314412927732976, 'f1-score': 0.42800612040310243, 'support': 32117}, '1': {'precision': 0.3327543424317618, 'recall': 0.29134078212290504, 'f1-score': 0.31067350653648845, 'support': 32220}, '2': {'precision': 0.3030166591625394, 'recall': 0.06084257473481196, 'f1-score': 0.10133761638266368, 'support': 33184}, 'accuracy': 0.32491463377118773, 'macro avg': {'precision': 0.3198281493842835, 'recall': 0.3278748832103382, 'f1-score': 0.2800057477740849, 'support': 97521}, 'weighted avg': {'precision': 0.3196578633722173, 'recall': 0.32491463377118773, 'f1-score': 0.2780832888468577, 'support': 97521}}
[[20280  9305  2532]
 [20721  9387  2112]
 [21647  9518  2019]]
Evaluating performance on  val set...
114/114 - 1s - 838ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1749592
{'0': {'precision': 0.3015101100588687, 'recall': 0.6719908727895038, 'f1-score': 0.41625441696113075, 'support': 8765}, '1': {'precision': 0.3542214278204185, 'recall': 0.33402736466389055, 'f1-score': 0.34382813695973874, 'support': 10086}, '2': {'precision': 0.4838709677419355, 'recall': 0.0014668492079014277, 'f1-score': 0.0029248318221702257, 'support': 10226}, 'accuracy': 0.3189462461739519, 'macro avg': {'precision': 0.3798675018737409, 'recall': 0.33582836222043194, 'f1-score': 0.2543357952476799, 'support': 29077}, 'weighted avg': {'precision': 0.3839281202253244, 'recall': 0.3189462461739519, 'f1-score': 0.24576916065115895, 'support': 29077}}
[[5890 2868    7]
 [6708 3369    9]
 [6937 3274   15]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1847154
{'0': {'precision': 0.29591546601735963, 'recall': 0.7153068492808318, 'f1-score': 0.4186425802676808, 'support': 80023}, '1': {'precision': 0.3508633724254476, 'recall': 0.29419159635216907, 'f1-score': 0.32003801422056366, 'support': 93864}, '2': {'precision': 0.3904761904761905, 'recall': 0.0012478694911127344, 'f1-score': 0.002487788598646886, 'support': 98568}, 'accuracy': 0.311897377548586, 'macro avg': {'precision': 0.3457516763063326, 'recall': 0.33691543837470456, 'f1-score': 0.24705612769563043, 'support': 272455}, 'weighted avg': {'precision': 0.3490555874155605, 'recall': 0.311897377548586, 'f1-score': 0.2341168255827606, 'support': 272455}}
[[57241 22701    81]
 [66139 27614   111]
 [70057 28388   123]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1577957
{'0': {'precision': 0.33972692232312013, 'recall': 0.7441827184521594, 'f1-score': 0.46649442919425155, 'support': 34939}, '1': {'precision': 0.3270445094717388, 'recall': 0.2500294360061227, 'f1-score': 0.28339783798211665, 'support': 33972}, '2': {'precision': 0.44, 'recall': 0.0016310311082115003, 'f1-score': 0.003250014772794422, 'support': 33721}, 'accuracy': 0.3366396445553044, 'macro avg': {'precision': 0.36892381059828633, 'recall': 0.33194772852216453, 'f1-score': 0.2510474273163875, 'support': 102632}, 'weighted avg': {'precision': 0.36847489101665565, 'recall': 0.3366396445553044, 'f1-score': 0.25368339272059226, 'support': 102632}}
[[26001  8910    28]
 [25436  8494    42]
 [25098  8568    55]]
Evaluating performance on  val set...
123/123 - 1s - 864ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1930239
{'0': {'precision': 0.30563426076455014, 'recall': 0.6932153392330384, 'f1-score': 0.4242287482673028, 'support': 9492}, '1': {'precision': 0.31667345276872966, 'recall': 0.31272617611580217, 'f1-score': 0.31468743677928385, 'support': 9948}, '2': {'precision': 0.35714285714285715, 'recall': 0.0008374507997655138, 'f1-score': 0.0016709833737154317, 'support': 11941}, 'accuracy': 0.3091361014626685, 'macro avg': {'precision': 0.3264835235587123, 'recall': 0.33559298871620197, 'f1-score': 0.246862389473434, 'support': 31381}, 'weighted avg': {'precision': 0.32873365311695896, 'recall': 0.3091361014626685, 'f1-score': 0.22871301462984256, 'support': 31381}}
[[6580 2900   12]
 [6831 3111    6]
 [8118 3813   10]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
1646/1646 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1487067
{'0': {'precision': 0.2656789042334189, 'recall': 0.6709111337007115, 'f1-score': 0.38062957669883263, 'support': 112146}, '1': {'precision': 0.4249232872329596, 'recall': 0.3257976573432421, 'f1-score': 0.3688161693936477, 'support': 179369}, '2': {'precision': 0.33214285714285713, 'recall': 0.001433305078215304, 'f1-score': 0.002854292948668764, 'support': 129770}, 'accuracy': 0.3177516408132262, 'macro avg': {'precision': 0.3409150162030785, 'recall': 0.332714032040723, 'f1-score': 0.2507666796803831, 'support': 421285}, 'weighted avg': {'precision': 0.35395295363774715, 'recall': 0.3177516408132262, 'f1-score': 0.2592322859640984, 'support': 421285}}
[[ 75240  36759    147]
 [120704  58438    227]
 [ 87255  42329    186]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1670904
{'0': {'precision': 0.33373975702453923, 'recall': 0.6713288258429448, 'f1-score': 0.44583846921406345, 'support': 45258}, '1': {'precision': 0.33824452265968186, 'recall': 0.2785341960995776, 'f1-score': 0.3054990820488177, 'support': 44508}, '2': {'precision': 0.3283171755172913, 'recall': 0.050608912878618906, 'f1-score': 0.08769929461783747, 'support': 44834}, 'accuracy': 0.33468796433878156, 'macro avg': {'precision': 0.3334338184005041, 'recall': 0.33349064494038044, 'f1-score': 0.2796789486269062, 'support': 134600}, 'weighted avg': {'precision': 0.33342313064707246, 'recall': 0.3346879643387815, 'f1-score': 0.28013982732849174, 'support': 134600}}
[[30383 12376  2499]
 [29968 12397  2143]
 [30687 11878  2269]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1643888
{'0': {'precision': 0.3017443679599499, 'recall': 0.6809355692850838, 'f1-score': 0.4181798471461868, 'support': 11330}, '1': {'precision': 0.3543032263556653, 'recall': 0.30777194409524516, 'f1-score': 0.3294024535021765, 'support': 13523}, '2': {'precision': 0.34375, 'recall': 0.0008804226028493677, 'f1-score': 0.0017563467986587897, 'support': 12494}, 'accuracy': 0.3183120464829839, 'macro avg': {'precision': 0.33326586477187176, 'recall': 0.3298626453277261, 'f1-score': 0.24977954914900735, 'support': 37347}, 'weighted avg': {'precision': 0.334827930462792, 'recall': 0.3183120464829839, 'f1-score': 0.24672479298949504, 'support': 37347}}
[[7715 3610    5]
 [9345 4162   16]
 [8508 3975   11]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
5929/5929 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1880754
{'0': {'precision': 0.3547414187487927, 'recall': 0.5606228845632024, 'f1-score': 0.4345289776614888, 'support': 560168}, '1': {'precision': 0.265145108212209, 'recall': 0.27071155820711224, 'f1-score': 0.26789942121930244, 'support': 447033}, '2': {'precision': 0.31981669528433837, 'recall': 0.11021372645834802, 'f1-score': 0.16393347069743855, 'support': 510372}, 'accuracy': 0.32374719370995664, 'macro avg': {'precision': 0.3132344074151134, 'recall': 0.31384938974288756, 'f1-score': 0.28878728985940993, 'support': 1517573}, 'weighted avg': {'precision': 0.31660347846381065, 'recall': 0.32374719370995664, 'f1-score': 0.2944412978034021, 'support': 1517573}}
[[314043 171379  74746]
 [281130 121017  44886]
 [290100 164022  56250]]
Evaluating performance on  train set...
1254/1254 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1667753
{'0': {'precision': 0.33186962600638786, 'recall': 0.735722613484488, 'f1-score': 0.4574105722199305, 'support': 105499}, '1': {'precision': 0.34380186243776506, 'recall': 0.2815095123056017, 'f1-score': 0.30955296363938234, 'support': 105968}, '2': {'precision': 0.3667711598746082, 'recall': 0.0010684833928457274, 'f1-score': 0.0021307594245128392, 'support': 109501}, 'accuracy': 0.3351299818050398, 'macro avg': {'precision': 0.3474808827729204, 'recall': 0.3394335363943118, 'f1-score': 0.25636476509460854, 'support': 320968}, 'weighted avg': {'precision': 0.34771602842115873, 'recall': 0.3351299818050398, 'f1-score': 0.2532725589383119, 'support': 320968}}
[[77618 27791    90]
 [76025 29831   112]
 [80238 29146   117]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1755043
{'0': {'precision': 0.34073367338201654, 'recall': 0.7430248066150974, 'f1-score': 0.46721400836946403, 'support': 37490}, '1': {'precision': 0.2955607476635514, 'recall': 0.24681421864520456, 'f1-score': 0.26899690999102904, 'support': 32802}, '2': {'precision': 0.30303030303030304, 'recall': 0.0005138878182892675, 'f1-score': 0.0010260356547390024, 'support': 38919}, 'accuracy': 0.3293807400353444, 'macro avg': {'precision': 0.31310824135862364, 'recall': 0.3301176376928638, 'f1-score': 0.24574565133841067, 'support': 109211}, 'weighted avg': {'precision': 0.3137296190272773, 'recall': 0.3293807400353444, 'f1-score': 0.24154546791938292, 'support': 109211}}
[[27856  9606    28]
 [24688  8096    18]
 [29209  9690    20]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
5331/5331 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1577271
{'0': {'precision': 0.3220947189618164, 'recall': 0.6712469722631991, 'f1-score': 0.43530862903469875, 'support': 439272}, '1': {'precision': 0.350559798655768, 'recall': 0.3282791706261329, 'f1-score': 0.33905384094056, 'support': 477758}, '2': {'precision': 0.332579185520362, 'recall': 0.0013137433642554561, 'f1-score': 0.002617148554336989, 'support': 447576}, 'accuracy': 0.33144072354950804, 'macro avg': {'precision': 0.3350779010459821, 'recall': 0.3336132954178625, 'f1-score': 0.25899320617653193, 'support': 1364606}, 'weighted avg': {'precision': 0.3354993318309013, 'recall': 0.33144072354950804, 'f1-score': 0.25969103896272344, 'support': 1364606}}
[[294860 143883    529]
 [320269 156838    651]
 [300316 146672    588]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1614654
{'0': {'precision': 0.3460914730919059, 'recall': 0.6736197697276046, 'f1-score': 0.45725505146778495, 'support': 178050}, '1': {'precision': 0.32843242346074314, 'recall': 0.2840183959189288, 'f1-score': 0.3046149898976941, 'support': 167211}, '2': {'precision': 0.33853412241857384, 'recall': 0.04810321609399533, 'f1-score': 0.08423697570720956, 'support': 170051}, 'accuracy': 0.34078189524016517, 'macro avg': {'precision': 0.33768600632374096, 'recall': 0.3352471272468429, 'f1-score': 0.2820356723575629, 'support': 515312}, 'weighted avg': {'precision': 0.33786747988540744, 'recall': 0.34078189524016517, 'f1-score': 0.284631099112012, 'support': 515312}}
[[119938  49016   9096]
 [112833  47491   6887]
 [113779  48092   8180]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.167536
{'0': {'precision': 0.3418039587531113, 'recall': 0.7164245847066033, 'f1-score': 0.4628050541902489, 'support': 60379}, '1': {'precision': 0.31431640625, 'recall': 0.288881309686221, 'f1-score': 0.3010625958768287, 'support': 55708}, '2': {'precision': 0.3448275862068966, 'recall': 0.0009702144173862424, 'f1-score': 0.001934984520123839, 'support': 61842}, 'accuracy': 0.3338972286698627, 'macro avg': {'precision': 0.3336493170700026, 'recall': 0.3354253696034035, 'f1-score': 0.2552675448624005, 'support': 177929}, 'weighted avg': {'precision': 0.3342487574883015, 'recall': 0.3338972286698627, 'f1-score': 0.2519823343623182, 'support': 177929}}
[[43257 17068    54]
 [39555 16093    60]
 [43743 18039    60]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1483402
{'0': {'precision': 0.2889466122285955, 'recall': 0.6716991959559226, 'f1-score': 0.40407235518974133, 'support': 310182}, '1': {'precision': 0.4003633107476102, 'recall': 0.32640805366006764, 'f1-score': 0.35962288944759013, 'support': 430115}, '2': {'precision': 0.3263009845288326, 'recall': 0.0013940087666327178, 'f1-score': 0.002776157355470795, 'support': 332853}, 'accuracy': 0.32540278619018775, 'macro avg': {'precision': 0.33853696916834614, 'recall': 0.33316708612754103, 'f1-score': 0.2554904673309341, 'support': 1073150}, 'weighted avg': {'precision': 0.3451880585937419, 'recall': 0.32540278619018775, 'f1-score': 0.26178933296972007, 'support': 1073150}}
[[208349 101408    425]
 [289189 140393    533]
 [223526 108863    464]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1544929
{'0': {'precision': 0.3355648499068869, 'recall': 0.7293426228731219, 'f1-score': 0.4596488503103475, 'support': 105495}, '1': {'precision': 0.34302972876939475, 'recall': 0.27137034434293744, 'f1-score': 0.30302110852449576, 'support': 106725}, '2': {'precision': 0.43455497382198954, 'recall': 0.004851578711506425, 'f1-score': 0.009596022853178923, 'support': 102647}, 'accuracy': 0.3379268071916079, 'macro avg': {'precision': 0.3710498508327571, 'recall': 0.33518818197585526, 'f1-score': 0.25742199389600745, 'support': 314867}, 'weighted avg': {'precision': 0.37036598323020975, 'recall': 0.3379268071916079, 'f1-score': 0.2598417307262342, 'support': 314867}}
[[76942 28263   290]
 [77405 28962   358]
 [74944 27205   498]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1591227
{'0': {'precision': 0.31796426073480805, 'recall': 0.7125295798887489, 'f1-score': 0.4397094522834168, 'support': 32539}, '1': {'precision': 0.3469018079907037, 'recall': 0.28420227361818895, 'f1-score': 0.312437474027673, 'support': 35714}, '2': {'precision': 0.2463768115942029, 'recall': 0.0005001176747469993, 'f1-score': 0.000998209095446405, 'support': 33992}, 'accuracy': 0.3261968800430339, 'macro avg': {'precision': 0.3037476267732382, 'recall': 0.3324106570605616, 'f1-score': 0.2510483784688454, 'support': 102245}, 'weighted avg': {'precision': 0.3042723930787819, 'recall': 0.3261968800430339, 'f1-score': 0.24940123173599518, 'support': 102245}}
[[23185  9335    19]
 [25531 10150    33]
 [24201  9774    17]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
6143/6143 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1379875
{'0': {'precision': 0.28054240504452505, 'recall': 0.7131306856204478, 'f1-score': 0.40267448023801816, 'support': 437837}, '1': {'precision': 0.443862867125232, 'recall': 0.2994752071473192, 'f1-score': 0.35764594517081993, 'support': 678744}, '2': {'precision': 0.27289955780164243, 'recall': 0.0009475325769157376, 'f1-score': 0.0018885080786178918, 'support': 455921}, 'accuracy': 0.3280975159332071, 'macro avg': {'precision': 0.3324349433237998, 'recall': 0.3378511417815609, 'f1-score': 0.25406964449581865, 'support': 1572502}, 'weighted avg': {'precision': 0.3488210140107998, 'recall': 0.3280975159332071, 'f1-score': 0.26703739410487726, 'support': 1572502}}
[[312235 125173    429]
 [474755 203267    722]
 [325979 129510    432]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1658936
{'0': {'precision': 0.33031370966072576, 'recall': 0.7206397055502868, 'f1-score': 0.4529928178050304, 'support': 177144}, '1': {'precision': 0.3405339970074513, 'recall': 0.25345428700941847, 'f1-score': 0.29061112394445726, 'support': 178691}, '2': {'precision': 0.3593249927262147, 'recall': 0.027849499949262044, 'f1-score': 0.05169256526971171, 'support': 177382}, 'accuracy': 0.3336108938762268, 'macro avg': {'precision': 0.3433908997981306, 'recall': 0.33398116416965573, 'f1-score': 0.26509883567306647, 'support': 533217}, 'weighted avg': {'precision': 0.3433897233268247, 'recall': 0.3336108938762268, 'f1-score': 0.2650776000740511, 'support': 533217}}
[[127657  44066   5421]
 [130014  45290   3387]
 [128801  43641   4940]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1727029
{'0': {'precision': 0.3263200727655704, 'recall': 0.7133587985976663, 'f1-score': 0.44779845292253123, 'support': 57333}, '1': {'precision': 0.33791913837351173, 'recall': 0.28114389723126465, 'f1-score': 0.30692804463296264, 'support': 57138}, '2': {'precision': 0.4424163407214255, 'recall': 0.016770452373892127, 'f1-score': 0.03231592146405727, 'support': 60702}, 'accuracy': 0.33099278998475795, 'macro avg': {'precision': 0.36888518395350256, 'recall': 0.337091049400941, 'f1-score': 0.26234747300651706, 'support': 175173}, 'weighted avg': {'precision': 0.3703338366913059, 'recall': 0.33099278998475795, 'f1-score': 0.2578737840897679, 'support': 175173}}
[[40899 15420  1014]
 [40805 16064   269]
 [43630 16054  1018]]
testing model on single stock: results/universal/W7/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
23942/23942 - 127s - 127s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1317194
{'0': {'precision': 0.28869766980443085, 'recall': 0.6729521344412763, 'f1-score': 0.40405501513204684, 'support': 1768683}, '1': {'precision': 0.42531809206296955, 'recall': 0.32616477967008156, 'f1-score': 0.3692001162115554, 'support': 2606523}, '2': {'precision': 0.2853092087496624, 'recall': 0.001204772564255487, 'f1-score': 0.002399413148738633, 'support': 1753858}, 'accuracy': 0.3332495793811257, 'macro avg': {'precision': 0.3331083235390209, 'recall': 0.3334405622252044, 'f1-score': 0.25855151483078026, 'support': 6129064}, 'weighted avg': {'precision': 0.3458289696828461, 'recall': 0.3332495793811257, 'f1-score': 0.27429670513851817, 'support': 6129064}}
[[1190239  576267    2177]
 [1753251  850156    3116]
 [1179297  572448    2113]]
Evaluating performance on  train set...
9052/9052 - 52s - 52s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1577511
{'0': {'precision': 0.3341019975382973, 'recall': 0.7001595309376069, 'f1-score': 0.4523511538255608, 'support': 772264}, '1': {'precision': 0.33964195621867405, 'recall': 0.3042716595946097, 'f1-score': 0.3209853593671556, 'support': 777473}, '2': {'precision': 0.3177441540577717, 'recall': 0.0009031163378046063, 'f1-score': 0.0018011134155659862, 'support': 767343}, 'accuracy': 0.3357518946259948, 'macro avg': {'precision': 0.33049603593824767, 'recall': 0.3351114356233404, 'f1-score': 0.25837920886942745, 'support': 2317080}, 'weighted avg': {'precision': 0.33054367913980937, 'recall': 0.3357518946259948, 'f1-score': 0.25906487196507855, 'support': 2317080}}
[[540708 230879    677]
 [540099 236563    811]
 [537585 229065    693]]
Evaluating performance on  val set...
2763/2763 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1633174
{'0': {'precision': 0.3158338213423548, 'recall': 0.672256398299765, 'f1-score': 0.42976097319081724, 'support': 223028}, '1': {'precision': 0.3489320740382623, 'recall': 0.3275191442810259, 'f1-score': 0.337886698127798, 'support': 246810}, '2': {'precision': 0.3215434083601286, 'recall': 0.001263280233454187, 'f1-score': 0.002516672958349062, 'support': 237477}, 'accuracy': 0.326681888550363, 'macro avg': {'precision': 0.3287697679135819, 'recall': 0.33367960760474835, 'f1-score': 0.2567214480923214, 'support': 707315}, 'weighted avg': {'precision': 0.32930006388506466, 'recall': 0.326681888550363, 'f1-score': 0.2542575772291741, 'support': 707315}}
[[149932  72804    292]
 [165634  80835    341]
 [159152  78025    300]]
training model: results/universal/W7/deepLOB_L1/h1000
Epoch 1/50
12475/12475 - 202s - loss: 3.1764 - accuracy1000: 0.4338 - val_loss: 3.3242 - val_accuracy1000: 0.3381 - 202s/epoch - 16ms/step
Epoch 2/50
12475/12475 - 200s - loss: 3.1193 - accuracy1000: 0.4581 - val_loss: 3.5796 - val_accuracy1000: 0.3180 - 200s/epoch - 16ms/step
Epoch 3/50
12475/12475 - 195s - loss: 3.0969 - accuracy1000: 0.4649 - val_loss: 4.3338 - val_accuracy1000: 0.3171 - 195s/epoch - 16ms/step
Epoch 4/50
12475/12475 - 194s - loss: 3.0836 - accuracy1000: 0.4691 - val_loss: 5.1092 - val_accuracy1000: 0.3169 - 194s/epoch - 16ms/step
Epoch 5/50
12475/12475 - 195s - loss: 3.0740 - accuracy1000: 0.4717 - val_loss: 5.0757 - val_accuracy1000: 0.3169 - 195s/epoch - 16ms/step
Epoch 6/50
12475/12475 - 193s - loss: 3.0691 - accuracy1000: 0.4727 - val_loss: 5.1848 - val_accuracy1000: 0.3171 - 193s/epoch - 16ms/step
Epoch 7/50
12475/12475 - 196s - loss: 3.0635 - accuracy1000: 0.4745 - val_loss: 5.2914 - val_accuracy1000: 0.3169 - 196s/epoch - 16ms/step
Epoch 8/50
12475/12475 - 197s - loss: 3.0586 - accuracy1000: 0.4759 - val_loss: 5.0089 - val_accuracy1000: 0.3169 - 197s/epoch - 16ms/step
Epoch 9/50
12475/12475 - 197s - loss: 3.0536 - accuracy1000: 0.4771 - val_loss: 5.0041 - val_accuracy1000: 0.3169 - 197s/epoch - 16ms/step
Epoch 10/50
12475/12475 - 197s - loss: 3.0509 - accuracy1000: 0.4780 - val_loss: 4.7238 - val_accuracy1000: 0.3170 - 197s/epoch - 16ms/step
Epoch 11/50
12475/12475 - 194s - loss: 3.0465 - accuracy1000: 0.4789 - val_loss: 4.6773 - val_accuracy1000: 0.3171 - 194s/epoch - 16ms/step
testing model in sample: results/universal/W7/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 190s - 190s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1167709
{'0': {'precision': 0.3276362828102013, 'recall': 0.29037358745150954, 'f1-score': 0.30788156434649666, 'support': 3035648}, '1': {'precision': 0.3884421284712669, 'recall': 0.12149726220801675, 'f1-score': 0.18509907647121066, 'support': 3462827}, '2': {'precision': 0.3143040173284755, 'recall': 0.5991200150843156, 'f1-score': 0.4123075831615492, 'support': 3007097}, 'accuracy': 0.3265251160056438, 'macro avg': {'precision': 0.34346080953664787, 'recall': 0.33699695491461396, 'f1-score': 0.30176274132641884, 'support': 9505572}, 'weighted avg': {'precision': 0.34556983889495557, 'recall': 0.3265251160056438, 'f1-score': 0.2961878602494655, 'support': 9505572}}
[[ 881472  330789 1823387]
 [ 935034  420724 2107069]
 [ 873892  331593 1801612]]
Evaluating performance on  train set...
12475/12475 - 69s - 69s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1088592
{'0': {'precision': 0.33951334957033225, 'recall': 0.2738210285314014, 'f1-score': 0.3031491398451152, 'support': 1079267}, '1': {'precision': 0.34533202243456296, 'recall': 0.09400370304053153, 'f1-score': 0.14777987313560775, 'support': 1049948}, '2': {'precision': 0.333558191998861, 'recall': 0.6386152806407556, 'f1-score': 0.43822499664592307, 'support': 1063869}, 'accuracy': 0.3362354388421977, 'macro avg': {'precision': 0.3394678546679188, 'recall': 0.3354800040708961, 'f1-score': 0.2963846698755487, 'support': 3193084}, 'weighted avg': {'precision': 0.3394425078405343, 'recall': 0.3362354388421977, 'f1-score': 0.29706516769020314, 'support': 3193084}}
[[295526  94157 689584]
 [283401  98699 667848]
 [291513  92953 679403]]
Evaluating performance on  val set...
3866/3866 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077436
{'0': {'precision': 0.31583256211290667, 'recall': 0.25478822684852837, 'f1-score': 0.2820451691857786, 'support': 313425}, '1': {'precision': 0.34107618175438, 'recall': 0.11914635349551979, 'f1-score': 0.17660144911479914, 'support': 334471}, '2': {'precision': 0.344665279564564, 'recall': 0.62561455116523, 'f1-score': 0.4444647973664244, 'support': 341306}, 'accuracy': 0.3368715388767916, 'macro avg': {'precision': 0.33385800781061686, 'recall': 0.33318304383642605, 'f1-score': 0.3010371385556674, 'support': 989202}, 'weighted avg': {'precision': 0.3343161864562244, 'recall': 0.3368715388767916, 'f1-score': 0.3024322358515991, 'support': 989202}}
[[ 79857  37123 196445]
 [ 85074  39851 209546]
 [ 87915  39865 213526]]
testing model out of sample: results/universal/W7/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 84s - 84s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1140854
{'0': {'precision': 0.27957058473225926, 'recall': 0.2655120890543138, 'f1-score': 0.2723600421005592, 'support': 1046732}, '1': {'precision': 0.43604552367063093, 'recall': 0.12661328603192845, 'f1-score': 0.19624381831197868, 'support': 1601080}, '2': {'precision': 0.2967198139305868, 'recall': 0.609867282169648, 'f1-score': 0.39921085854000116, 'support': 1126450}, 'accuracy': 0.3093645857123856, 'macro avg': {'precision': 0.3374453074444923, 'recall': 0.33399755241863005, 'f1-score': 0.28927157298417966, 'support': 3774262}, 'weighted avg': {'precision': 0.3510671168929583, 'recall': 0.3093645857123856, 'f1-score': 0.2779301213888516, 'support': 3774262}}
[[277920 126740 642072]
 [412154 202718 986208]
 [304022 135443 686985]]
Evaluating performance on  train set...
5285/5285 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250919
{'0': {'precision': 0.33645570889011395, 'recall': 0.32160276621317957, 'f1-score': 0.32886161574103967, 'support': 459256}, '1': {'precision': 0.3255835473199621, 'recall': 0.06306502095968705, 'f1-score': 0.1056632387802255, 'support': 446333}, '2': {'precision': 0.32820565515407213, 'recall': 0.6072939244883762, 'f1-score': 0.4261194867323724, 'support': 447057}, 'accuracy': 0.3307155013211143, 'macro avg': {'precision': 0.3300816371213828, 'recall': 0.33065390388708094, 'f1-score': 0.2868814470845458, 'support': 1352646}, 'weighted avg': {'precision': 0.33014153004127683, 'recall': 0.3307155013211143, 'f1-score': 0.2873570468055763, 'support': 1352646}}
[[147698  29727 281831]
 [144301  28148 273884]
 [146983  28579 271495]]
Evaluating performance on  val set...
1714/1714 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1121638
{'0': {'precision': 0.329398502806246, 'recall': 0.28652911280521487, 'f1-score': 0.30647192422032243, 'support': 144816}, '1': {'precision': 0.2995935492329881, 'recall': 0.0839234295116648, 'f1-score': 0.131117627143931, 'support': 136136}, '2': {'precision': 0.358500346803928, 'recall': 0.6251766593244292, 'f1-score': 0.45569032880755056, 'support': 157082}, 'accuracy': 0.34500289931831774, 'macro avg': {'precision': 0.3291641329477207, 'recall': 0.33187640054710293, 'f1-score': 0.297759960057268, 'support': 438034}, 'weighted avg': {'precision': 0.33057158229138833, 'recall': 0.34500289931831774, 'f1-score': 0.30548454160294425, 'support': 438034}}
[[41494 12947 90375]
 [39360 11425 85351]
 [45115 13763 98204]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1085755
{'0': {'precision': 0.2783716115364245, 'recall': 0.22948834993847497, 'f1-score': 0.25157739001784085, 'support': 50386}, '1': {'precision': 0.38643914844743427, 'recall': 0.13650260080849647, 'f1-score': 0.20174311533684525, 'support': 69017}, '2': {'precision': 0.32672065138785966, 'recall': 0.6253310777327797, 'f1-score': 0.4291963783073747, 'support': 58521}, 'accuracy': 0.32361570108585686, 'macro avg': {'precision': 0.33051047045723947, 'recall': 0.33044067615991707, 'f1-score': 0.2941722945540203, 'support': 177924}, 'weighted avg': {'precision': 0.3361936667742395, 'recall': 0.32361570108585686, 'f1-score': 0.2906672749014627, 'support': 177924}}
[[11563  6944 31879]
 [16063  9421 43533]
 [13912  8014 36595]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1353397
{'0': {'precision': 0.32988014001343563, 'recall': 0.3770915851588392, 'f1-score': 0.3519094766619519, 'support': 24742}, '1': {'precision': 0.340324118207817, 'recall': 0.05767599660729432, 'f1-score': 0.09863581419443966, 'support': 24759}, '2': {'precision': 0.3013133588076018, 'recall': 0.529317626139142, 'f1-score': 0.3840224472682706, 'support': 22495}, 'accuracy': 0.31480915606422577, 'macro avg': {'precision': 0.3238392056762848, 'recall': 0.32136173596842516, 'f1-score': 0.27818924604155404, 'support': 71996}, 'weighted avg': {'precision': 0.32454613135864174, 'recall': 0.31480915606422577, 'f1-score': 0.27484378780084856, 'support': 71996}}
[[ 9330  1408 14004]
 [ 9725  1428 13606]
 [ 9228  1360 11907]]
Evaluating performance on  val set...
73/73 - 1s - 613ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074774
{'0': {'precision': 0.31985903814262023, 'recall': 0.2694725812085225, 'f1-score': 0.29251184834123223, 'support': 5726}, '1': {'precision': 0.39416511483550587, 'recall': 0.09576232845724626, 'f1-score': 0.1540888133948071, 'support': 6631}, '2': {'precision': 0.32990971589497226, 'recall': 0.6475369858559584, 'f1-score': 0.43711589113257243, 'support': 6151}, 'accuracy': 0.33288307758807, 'macro avg': {'precision': 0.3479779562910328, 'recall': 0.33759063184057575, 'f1-score': 0.29457218428953724, 'support': 18508}, 'weighted avg': {'precision': 0.3498215037469666, 'recall': 0.33288307758807, 'f1-score': 0.29097609744863384, 'support': 18508}}
[[1543  463 3720]
 [1626  635 4370]
 [1655  513 3983]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
2006/2006 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102128
{'0': {'precision': 0.3924484962620556, 'recall': 0.2707244579605736, 'f1-score': 0.3204153780744209, 'support': 203214}, '1': {'precision': 0.22890422378658762, 'recall': 0.08574402567549985, 'f1-score': 0.12475626147700812, 'support': 115285}, '2': {'precision': 0.38054078954546283, 'recall': 0.6444764950136272, 'f1-score': 0.4785277242646148, 'support': 194831}, 'accuracy': 0.37103617555958157, 'macro avg': {'precision': 0.33396450319803533, 'recall': 0.33364832621656687, 'f1-score': 0.3078997879386813, 'support': 513330}, 'weighted avg': {'precision': 0.3511998027128089, 'recall': 0.37103617555958157, 'f1-score': 0.3364842329312361, 'support': 513330}}
[[ 55015  17927 130272]
 [ 31274   9885  74126]
 [ 53895  15372 125564]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.123948
{'0': {'precision': 0.37078707009035183, 'recall': 0.29972735775836334, 'f1-score': 0.3314918343091077, 'support': 50249}, '1': {'precision': 0.2650427722198057, 'recall': 0.042993555670539536, 'f1-score': 0.07398563189314986, 'support': 42518}, '2': {'precision': 0.3264349429577543, 'recall': 0.65637703819522, 'f1-score': 0.4360231766215845, 'support': 44770}, 'accuracy': 0.33645491758581325, 'macro avg': {'precision': 0.3207549284226373, 'recall': 0.33303265054137426, 'f1-score': 0.280500214274614, 'support': 137537}, 'weighted avg': {'precision': 0.3236602548436453, 'recall': 0.33645491758581325, 'f1-score': 0.28591296812043043, 'support': 137537}}
[[15061  2722 32466]
 [12521  1828 28169]
 [13037  2347 29386]]
Evaluating performance on  val set...
153/153 - 1s - 942ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060568
{'0': {'precision': 0.32413305024769995, 'recall': 0.2508803505751624, 'f1-score': 0.28284075871195413, 'support': 12779}, '1': {'precision': 0.38497109826589593, 'recall': 0.10246153846153847, 'f1-score': 0.16184690157958687, 'support': 13000}, '2': {'precision': 0.34872952254951556, 'recall': 0.6753070605078743, 'f1-score': 0.45994354631768025, 'support': 13271}, 'accuracy': 0.34571062740076824, 'macro avg': {'precision': 0.35261122368770376, 'recall': 0.342882983181525, 'f1-score': 0.30154373553640706, 'support': 39050}, 'weighted avg': {'precision': 0.3527454550659827, 'recall': 0.34571062740076824, 'f1-score': 0.3027488496618854, 'support': 39050}}
[[3206 1131 8442]
 [3373 1332 8295]
 [3312  997 8962]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093081
{'0': {'precision': 0.3224682103198234, 'recall': 0.24013616976874616, 'f1-score': 0.27527791691274867, 'support': 76669}, '1': {'precision': 0.3466790813159528, 'recall': 0.12131634204619506, 'f1-score': 0.17973610813130228, 'support': 82866}, '2': {'precision': 0.3320250505423008, 'recall': 0.6430174722611912, 'f1-score': 0.4379253288630827, 'support': 78410}, 'accuracy': 0.3315177877240539, 'macro avg': {'precision': 0.333724114059359, 'recall': 0.33482332802537745, 'f1-score': 0.29764645130237793, 'support': 237945}, 'weighted avg': {'precision': 0.33404907933497274, 'recall': 0.3315177877240539, 'f1-score': 0.2956020088018086, 'support': 237945}}
[[18411  9630 48628]
 [20007 10053 52806]
 [18676  9315 50419]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1206572
{'0': {'precision': 0.3340984442744198, 'recall': 0.24502774487187481, 'f1-score': 0.2827134738508021, 'support': 32078}, '1': {'precision': 0.3313114411211044, 'recall': 0.09836676395702663, 'f1-score': 0.15169507757134648, 'support': 32206}, '2': {'precision': 0.3390033057594711, 'recall': 0.6571892770105605, 'f1-score': 0.44728166274188597, 'support': 33237}, 'accuracy': 0.3370658627372566, 'macro avg': {'precision': 0.33480439705166504, 'recall': 0.333527928613154, 'f1-score': 0.2938967380546782, 'support': 97521}, 'weighted avg': {'precision': 0.33484971484817283, 'recall': 0.3370658627372566, 'f1-score': 0.29553301449945013, 'support': 97521}}
[[ 7860  3106 21112]
 [ 7560  3168 21478]
 [ 8106  3288 21843]]
Evaluating performance on  val set...
114/114 - 1s - 786ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076963
{'0': {'precision': 0.298305530014449, 'recall': 0.25809751108080464, 'f1-score': 0.2767487204484524, 'support': 8799}, '1': {'precision': 0.3339597315436242, 'recall': 0.13096115380566375, 'f1-score': 0.1881427707199032, 'support': 9499}, '2': {'precision': 0.36664975477760864, 'recall': 0.603395491232953, 'f1-score': 0.45613296865137803, 'support': 10779}, 'accuracy': 0.34456787151356744, 'macro avg': {'precision': 0.33297167211189393, 'recall': 0.33081805203980713, 'f1-score': 0.30700815327324454, 'support': 29077}, 'weighted avg': {'precision': 0.3352887696556683, 'recall': 0.34456787151356744, 'f1-score': 0.3143012497639886, 'support': 29077}}
[[2271 1124 5404]
 [2424 1244 5831]
 [2918 1357 6504]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1092135
{'0': {'precision': 0.27918966704007125, 'recall': 0.271405704689181, 'f1-score': 0.2752426635442516, 'support': 76218}, '1': {'precision': 0.3567386674779434, 'recall': 0.12296947261344211, 'f1-score': 0.18289439821566442, 'support': 95357}, '2': {'precision': 0.3652019432963527, 'recall': 0.5991078509119746, 'f1-score': 0.4537864340095806, 'support': 100880}, 'accuracy': 0.3407902222385348, 'macro avg': {'precision': 0.3337100926047891, 'recall': 0.33116100940486587, 'f1-score': 0.3039744985898322, 'support': 272455}, 'weighted avg': {'precision': 0.33817833842979744, 'recall': 0.3407902222385348, 'f1-score': 0.3090296816852448, 'support': 272455}}
[[20686  8873 46659]
 [25236 11726 58395]
 [28171 12271 60438]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1140422
{'0': {'precision': 0.34968435420576693, 'recall': 0.34374126460557947, 'f1-score': 0.3466873414152805, 'support': 35774}, '1': {'precision': 0.3363222513450131, 'recall': 0.0718792381626275, 'f1-score': 0.11844438506570797, 'support': 33918}, '2': {'precision': 0.3164720925984357, 'recall': 0.5785367334547662, 'f1-score': 0.40913726290026514, 'support': 32940}, 'accuracy': 0.3292540338296048, 'macro avg': {'precision': 0.33415956604973857, 'recall': 0.3313857454076577, 'f1-score': 0.29142299646041786, 'support': 102632}, 'weighted avg': {'precision': 0.3346088640840063, 'recall': 0.3292540338296048, 'f1-score': 0.29130067663480846, 'support': 102632}}
[[12297  2412 21065]
 [11385  2438 20095]
 [11484  2399 19057]]
Evaluating performance on  val set...
123/123 - 1s - 825ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.102603
{'0': {'precision': 0.31147757255936676, 'recall': 0.24400578751550228, 'f1-score': 0.273643949930459, 'support': 9676}, '1': {'precision': 0.29851157662624034, 'recall': 0.11439738037393049, 'f1-score': 0.16540664375715922, 'support': 9467}, '2': {'precision': 0.38868785009666385, 'recall': 0.6407092662199706, 'f1-score': 0.483848076270402, 'support': 12238}, 'accuracy': 0.3596125043816322, 'macro avg': {'precision': 0.33289233309409033, 'recall': 0.33303747803646777, 'f1-score': 0.30763288998600674, 'support': 31381}, 'weighted avg': {'precision': 0.3376765557977127, 'recall': 0.3596125043816322, 'f1-score': 0.3229666458485493, 'support': 31381}}
[[2361 1102 6213]
 [2265 1083 6119]
 [2954 1443 7841]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
1646/1646 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107908
{'0': {'precision': 0.25867893568418004, 'recall': 0.22172378290925135, 'f1-score': 0.2387799650541759, 'support': 108784}, '1': {'precision': 0.42143502805587296, 'recall': 0.1392238173581844, 'f1-score': 0.20930301503068394, 'support': 177484}, '2': {'precision': 0.3203753400962848, 'recall': 0.6392676477776873, 'f1-score': 0.4268370480631809, 'support': 135017}, 'accuracy': 0.3207852166585566, 'macro avg': {'precision': 0.3334964346121126, 'recall': 0.33340508268170765, 'f1-score': 0.29164000938268025, 'support': 421285}, 'weighted avg': {'precision': 0.3470197637056066, 'recall': 0.3207852166585566, 'f1-score': 0.2866316953048551, 'support': 421285}}
[[ 24120  15230  69434]
 [ 39111  24710 113663]
 [ 30012  18693  86312]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1295815
{'0': {'precision': 0.3379016004742146, 'recall': 0.31594466368110674, 'f1-score': 0.3265544620249539, 'support': 45106}, '1': {'precision': 0.33022170361726955, 'recall': 0.0626716272477633, 'f1-score': 0.1053493652979935, 'support': 45156}, '2': {'precision': 0.32378510524119014, 'recall': 0.6123641120483558, 'f1-score': 0.42359567215058547, 'support': 44338}, 'accuracy': 0.32861812778603267, 'macro avg': {'precision': 0.33063613644422474, 'recall': 0.33032680099240863, 'f1-score': 0.285166499824511, 'support': 134600}, 'weighted avg': {'precision': 0.33067507307366445, 'recall': 0.32861812778603267, 'f1-score': 0.28430985449707596, 'support': 134600}}
[[14251  3039 27816]
 [13438  2830 28888]
 [14486  2701 27151]]
Evaluating performance on  val set...
146/146 - 1s - 936ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107649
{'0': {'precision': 0.30113821138211383, 'recall': 0.25124355611829613, 'f1-score': 0.2739374815106992, 'support': 11057}, '1': {'precision': 0.3706808943089431, 'recall': 0.10852424873549539, 'f1-score': 0.16789413118527044, 'support': 13444}, '2': {'precision': 0.34515835607376166, 'recall': 0.6498520940370544, 'f1-score': 0.4508533160509829, 'support': 12846}, 'accuracy': 0.33697485741826655, 'macro avg': {'precision': 0.3389924872549395, 'recall': 0.3365399662969486, 'f1-score': 0.29756164291565085, 'support': 37347}, 'weighted avg': {'precision': 0.3413131814728092, 'recall': 0.33697485741826655, 'f1-score': 0.29661705440087566, 'support': 37347}}
[[2778 1197 7082]
 [3229 1459 8756]
 [3218 1280 8348]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
5929/5929 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1519294
{'0': {'precision': 0.4128817011606103, 'recall': 0.4309728623116402, 'f1-score': 0.42173335607288903, 'support': 634026}, '1': {'precision': 0.21424045755775126, 'recall': 0.03958713694915469, 'f1-score': 0.06682619633900767, 'support': 316037}, '2': {'precision': 0.36477214438986216, 'recall': 0.5125160790118236, 'f1-score': 0.42620334842868857, 'support': 567510}, 'accuracy': 0.37995997556624955, 'macro avg': {'precision': 0.3306314343694079, 'recall': 0.32769202609087283, 'f1-score': 0.30492096694686177, 'support': 1517573}, 'weighted avg': {'precision': 0.3535233459002808, 'recall': 0.37995997556624955, 'f1-score': 0.3494949670932638, 'support': 1517573}}
[[273248  23329 337449]
 [134464  12511 169062]
 [254095  22557 290858]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107273
{'0': {'precision': 0.33564109664912767, 'recall': 0.3203806502775575, 'f1-score': 0.32783337841493104, 'support': 105924}, '1': {'precision': 0.3862830402515263, 'recall': 0.0993129118064498, 'f1-score': 0.1580033496829764, 'support': 106391}, '2': {'precision': 0.3359202522505675, 'recall': 0.5951699446862949, 'f1-score': 0.429452782574047, 'support': 108653}, 'accuracy': 0.3401242491463323, 'macro avg': {'precision': 0.3526147963837405, 'recall': 0.3382878355901007, 'f1-score': 0.30509650355731815, 'support': 320968}, 'weighted avg': {'precision': 0.3525218390139928, 'recall': 0.3401242491463323, 'f1-score': 0.305939814362686, 'support': 320968}}
[[33936  8076 63912]
 [31897 10566 63928]
 [35275  8711 64667]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1098975
{'0': {'precision': 0.32470708679331134, 'recall': 0.32113626775418364, 'f1-score': 0.322911805879608, 'support': 35555}, '1': {'precision': 0.36797793583974453, 'recall': 0.0705872525269401, 'f1-score': 0.11845240876594552, 'support': 35913}, '2': {'precision': 0.34070401143571877, 'recall': 0.606231619108179, 'f1-score': 0.4362398833185575, 'support': 37743}, 'accuracy': 0.3372737178489346, 'macro avg': {'precision': 0.3444630113562582, 'recall': 0.33265171312976755, 'f1-score': 0.2925346993213704, 'support': 109211}, 'weighted avg': {'precision': 0.3444647845397191, 'recall': 0.3372737178489346, 'f1-score': 0.2948431250529084, 'support': 109211}}
[[11418  2143 21994]
 [11095  2535 22283]
 [12651  2211 22881]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
5331/5331 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1128558
{'0': {'precision': 0.24047056092181554, 'recall': 0.23884496119326906, 'f1-score': 0.23965500444487745, 'support': 329582}, '1': {'precision': 0.5032939847804458, 'recall': 0.13623103595853023, 'f1-score': 0.21442245014623618, 'support': 686958}, '2': {'precision': 0.2549174387148232, 'recall': 0.6234823280642177, 'f1-score': 0.3618774142822958, 'support': 348066}, 'accuracy': 0.28529626866656016, 'macro avg': {'precision': 0.33289399480569487, 'recall': 0.33285277507200567, 'f1-score': 0.27198495629113645, 'support': 1364606}, 'weighted avg': {'precision': 0.3764637491189787, 'recall': 0.28529626866656016, 'f1-score': 0.2581275600884734, 'support': 1364606}}
[[ 78719  45114 205749]
 [164828  93585 428545]
 [ 83807  47246 217013]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.124781
{'0': {'precision': 0.3438312573870352, 'recall': 0.3165957874292603, 'f1-score': 0.32965193818045524, 'support': 179178}, '1': {'precision': 0.33447411222553536, 'recall': 0.05897324069040094, 'f1-score': 0.10026765806808774, 'support': 167381}, '2': {'precision': 0.3277870423764475, 'recall': 0.6231533661623794, 'f1-score': 0.42959915680763455, 'support': 168753}, 'accuracy': 0.3333068121836868, 'macro avg': {'precision': 0.3353641373296727, 'recall': 0.3329074647606802, 'f1-score': 0.28650625101872584, 'support': 515312}, 'weighted avg': {'precision': 0.3355378007433733, 'recall': 0.3333068121836868, 'f1-score': 0.2878749618932821, 'support': 515312}}
[[ 56727  10055 112396]
 [ 54250   9871 103260]
 [ 54008   9586 105159]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033139
{'0': {'precision': 0.3590500010688557, 'recall': 0.2607993540573274, 'f1-score': 0.30213795522616277, 'support': 64402}, '1': {'precision': 0.22332418935077725, 'recall': 0.07034140505571926, 'f1-score': 0.10698520739966978, 'support': 45137}, '2': {'precision': 0.3845193401349491, 'recall': 0.6574499195788858, 'f1-score': 0.4852392849241594, 'support': 68390}, 'accuracy': 0.36494332008834984, 'macro avg': {'precision': 0.322297843518194, 'recall': 0.32953022623064415, 'f1-score': 0.29812081584999733, 'support': 177929}, 'weighted avg': {'precision': 0.3344086673639016, 'recall': 0.36494332008834984, 'f1-score': 0.3230097094618499, 'support': 177929}}
[[16796  5264 42342]
 [12334  3175 29628]
 [17649  5778 44963]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
4192/4192 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1087549
{'0': {'precision': 0.29144159072079534, 'recall': 0.22464756126766186, 'f1-score': 0.2537222197178019, 'support': 313175}, '1': {'precision': 0.38707952984483796, 'recall': 0.1375379592072266, 'f1-score': 0.2029597933608663, 'support': 415907}, '2': {'precision': 0.31944137819111684, 'recall': 0.635014008858714, 'f1-score': 0.42505863115821707, 'support': 344068}, 'accuracy': 0.32245725201509573, 'macro avg': {'precision': 0.33265416625225, 'recall': 0.3323998431112008, 'f1-score': 0.29391354807896175, 'support': 1073150}, 'weighted avg': {'precision': 0.33748391399582844, 'recall': 0.32245725201509573, 'f1-score': 0.288981901917538, 'support': 1073150}}
[[ 70354  43298 199523]
 [ 92746  57203 265958]
 [ 78300  47280 218488]]
Evaluating performance on  train set...
1230/1230 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111624
{'0': {'precision': 0.34920200982286786, 'recall': 0.340722412825725, 'f1-score': 0.34491010158381363, 'support': 108719}, '1': {'precision': 0.33182920912178554, 'recall': 0.06675125664926065, 'f1-score': 0.11114451712509649, 'support': 102455}, '2': {'precision': 0.3293955722773119, 'recall': 0.5977741988369514, 'f1-score': 0.4247424375837271, 'support': 103693}, 'accuracy': 0.33622767708270473, 'macro avg': {'precision': 0.3368089304073218, 'recall': 0.33508262277064566, 'f1-score': 0.2935990187642124, 'support': 314867}, 'weighted avg': {'precision': 0.3370263317612078, 'recall': 0.33622767708270473, 'f1-score': 0.2951354394601905, 'support': 314867}}
[[37043  7107 64569]
 [33992  6839 61624]
 [35044  6664 61985]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.109128
{'0': {'precision': 0.3215542116289181, 'recall': 0.24689671917205377, 'f1-score': 0.2793228952067024, 'support': 32949}, '1': {'precision': 0.34934437543133195, 'recall': 0.07339635773112169, 'f1-score': 0.12130652543794485, 'support': 34484}, '2': {'precision': 0.33980861106727306, 'recall': 0.6803688383316098, 'f1-score': 0.45324505085491756, 'support': 34812}, 'accuracy': 0.335967528974522, 'macro avg': {'precision': 0.33690239937584104, 'recall': 0.33355397174492846, 'f1-score': 0.28462482383318827, 'support': 102245}, 'weighted avg': {'precision': 0.3371421441616625, 'recall': 0.335967528974522, 'f1-score': 0.2852453519265404, 'support': 102245}}
[[ 8135  2412 22402]
 [ 8339  2531 23614]
 [ 8825  2302 23685]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
6143/6143 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.118151
{'0': {'precision': 0.3058978577664361, 'recall': 0.3028478468183773, 'f1-score': 0.3043652115265555, 'support': 481311}, '1': {'precision': 0.3895571942402772, 'recall': 0.11075920684731212, 'f1-score': 0.17247903831225292, 'support': 584755}, '2': {'precision': 0.3184659665365933, 'recall': 0.5846503803047177, 'f1-score': 0.4123305908500955, 'support': 506436}, 'accuracy': 0.3221738350730238, 'macro avg': {'precision': 0.3379736728477689, 'recall': 0.3327524779901357, 'f1-score': 0.296391613562968, 'support': 1572502}, 'weighted avg': {'precision': 0.3410553062357444, 'recall': 0.3221738350730238, 'f1-score': 0.2900927054344595, 'support': 1572502}}
[[145764  49057 286490]
 [172834  64767 347154]
 [157914  52434 296088]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1233046
{'0': {'precision': 0.33306663999733305, 'recall': 0.3364879428802371, 'f1-score': 0.3347685503191542, 'support': 178152}, '1': {'precision': 0.32608568247084335, 'recall': 0.06293014233929571, 'f1-score': 0.10550017302104218, 'support': 176831}, '2': {'precision': 0.3312943226295717, 'recall': 0.5931472109698486, 'f1-score': 0.42513516828426257, 'support': 178234}, 'accuracy': 0.33155919634970377, 'macro avg': {'precision': 0.33014888169924933, 'recall': 0.3308550987297938, 'f1-score': 0.28846796387481966, 'support': 533217}, 'weighted avg': {'precision': 0.3301591240815009, 'recall': 0.33155919634970377, 'f1-score': 0.28894226826211306, 'support': 533217}}
[[ 59946  11564 106642]
 [ 58955  11128 106748]
 [ 61081  11434 105719]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1234912
{'0': {'precision': 0.31382499653595675, 'recall': 0.33044572512401515, 'f1-score': 0.3219209722123516, 'support': 54832}, '1': {'precision': 0.3338131468914936, 'recall': 0.07928367928367928, 'f1-score': 0.1281342910516484, 'support': 61425}, '2': {'precision': 0.3328309738643435, 'recall': 0.5810136465476271, 'f1-score': 0.4232214831482901, 'support': 58916}, 'accuracy': 0.3266485131841094, 'macro avg': {'precision': 0.3268230390972646, 'recall': 0.33024768365177387, 'f1-score': 0.29109224880409673, 'support': 175173}, 'weighted avg': {'precision': 0.32722619589811924, 'recall': 0.3266485131841094, 'f1-score': 0.2880394608607481, 'support': 175173}}
[[18119  4807 31906]
 [19844  4870 36711]
 [19773  4912 34231]]
testing model on single stock: results/universal/W7/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
23942/23942 - 125s - 125s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1110911
{'0': {'precision': 0.2938202168750246, 'recall': 0.25591772318084705, 'f1-score': 0.273562348341891, 'support': 1809015}, '1': {'precision': 0.41112377216605356, 'recall': 0.1304176862450853, 'f1-score': 0.19801922934417923, 'support': 2520241}, '2': {'precision': 0.29442720474766065, 'recall': 0.6140988372093024, 'f1-score': 0.3980236024690385, 'support': 1799808}, 'accuracy': 0.30949309715153894, 'macro avg': {'precision': 0.33312373126291295, 'recall': 0.3334780822117449, 'f1-score': 0.2898683933850363, 'support': 6129064}, 'weighted avg': {'precision': 0.34223310522458195, 'recall': 0.30949309715153894, 'f1-score': 0.27904760597701456, 'support': 6129064}}
[[ 462959  236908 1109148]
 [ 652032  328684 1539525]
 [ 460663  233885 1105260]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068408
{'0': {'precision': 0.3375263835876241, 'recall': 0.25508829297676217, 'f1-score': 0.2905733942437465, 'support': 778601}, '1': {'precision': 0.3468057249844721, 'recall': 0.10149790889094062, 'f1-score': 0.1570366743318121, 'support': 764666}, '2': {'precision': 0.3352661884367597, 'recall': 0.6520011940869435, 'f1-score': 0.44282624761483463, 'support': 773813}, 'accuracy': 0.33695470160719526, 'macro avg': {'precision': 0.339866099002952, 'recall': 0.33619579865154875, 'f1-score': 0.29681210539679775, 'support': 2317080}, 'weighted avg': {'precision': 0.33983386907724306, 'recall': 0.33695470160719526, 'f1-score': 0.2973509969840328, 'support': 2317080}}
[[198612  73828 506161]
 [192887  77612 494167]
 [196935  72351 504527]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068327
{'0': {'precision': 0.31677309542032694, 'recall': 0.2492965217156779, 'f1-score': 0.2790131406837985, 'support': 222466}, '1': {'precision': 0.34401423189619085, 'recall': 0.13606393854482693, 'f1-score': 0.19500129016184858, 'support': 241607}, '2': {'precision': 0.3444559708892385, 'recall': 0.6183800494980307, 'f1-score': 0.44245270392502634, 'support': 243242}, 'accuracy': 0.3375440928016513, 'macro avg': {'precision': 0.3350810994019187, 'recall': 0.33458016991951184, 'f1-score': 0.30548904492355783, 'support': 707315}, 'weighted avg': {'precision': 0.335598211889415, 'recall': 0.3375440928016513, 'f1-score': 0.30652212193382994, 'support': 707315}}
[[ 55460  29717 137289]
 [ 59761  32874 148972]
 [ 59857  32969 150416]]
training model: results/universal/W7/deepOF_L1/h300
Epoch 1/50
12475/12475 - 181s - loss: 3.2797 - accuracy300: 0.3693 - val_loss: 3.3304 - val_accuracy300: 0.3376 - 181s/epoch - 14ms/step
Epoch 2/50
12475/12475 - 174s - loss: 3.2779 - accuracy300: 0.3704 - val_loss: 3.3300 - val_accuracy300: 0.3393 - 174s/epoch - 14ms/step
Epoch 3/50
12475/12475 - 175s - loss: 3.2771 - accuracy300: 0.3711 - val_loss: 3.3336 - val_accuracy300: 0.3402 - 175s/epoch - 14ms/step
Epoch 4/50
12475/12475 - 174s - loss: 3.2760 - accuracy300: 0.3724 - val_loss: 3.3380 - val_accuracy300: 0.3393 - 174s/epoch - 14ms/step
Epoch 5/50
12475/12475 - 175s - loss: 3.2754 - accuracy300: 0.3729 - val_loss: 3.3403 - val_accuracy300: 0.3387 - 175s/epoch - 14ms/step
Epoch 6/50
12475/12475 - 176s - loss: 3.2746 - accuracy300: 0.3737 - val_loss: 3.3389 - val_accuracy300: 0.3394 - 176s/epoch - 14ms/step
Epoch 7/50
12475/12475 - 174s - loss: 3.2739 - accuracy300: 0.3742 - val_loss: 3.3402 - val_accuracy300: 0.3400 - 174s/epoch - 14ms/step
Epoch 8/50
12475/12475 - 177s - loss: 3.2733 - accuracy300: 0.3748 - val_loss: 3.3393 - val_accuracy300: 0.3405 - 177s/epoch - 14ms/step
Epoch 9/50
12475/12475 - 174s - loss: 3.2727 - accuracy300: 0.3756 - val_loss: 3.3405 - val_accuracy300: 0.3404 - 174s/epoch - 14ms/step
Epoch 10/50
12475/12475 - 175s - loss: 3.2721 - accuracy300: 0.3761 - val_loss: 3.3403 - val_accuracy300: 0.3400 - 175s/epoch - 14ms/step
Epoch 11/50
12475/12475 - 175s - loss: 3.2716 - accuracy300: 0.3767 - val_loss: 3.3406 - val_accuracy300: 0.3384 - 175s/epoch - 14ms/step
Epoch 12/50
12475/12475 - 177s - loss: 3.2709 - accuracy300: 0.3772 - val_loss: 3.3412 - val_accuracy300: 0.3377 - 177s/epoch - 14ms/step
testing model in sample: results/universal/W7/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 196s - 196s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1204511
{'0': {'precision': 0.315123949728949, 'recall': 0.7129656440372544, 'f1-score': 0.4370680359617686, 'support': 2845736}, '1': {'precision': 0.5492395911244079, 'recall': 0.000572828976877523, 'f1-score': 0.0011444643356236473, 'support': 3845825}, '2': {'precision': 0.32862391077735836, 'recall': 0.35771357782163804, 'f1-score': 0.3425522773697416, 'support': 2813986}, 'accuracy': 0.31957298196516204, 'macro avg': {'precision': 0.3976624838769051, 'recall': 0.35708401694525665, 'f1-score': 0.2602549258890446, 'support': 9505547}, 'weighted avg': {'precision': 0.41384067670536184, 'recall': 0.31957298196516204, 'f1-score': 0.2327187448261335, 'support': 9505547}}
[[2028912    1091  815733]
 [2602877    2203 1240745]
 [1806668     717 1006601]]
Evaluating performance on  train set...
12475/12475 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103096
{'0': {'precision': 0.35007937023581037, 'recall': 0.7427248621810185, 'f1-score': 0.47586318628318275, 'support': 1073691}, '1': {'precision': 0.5118434603501545, 'recall': 0.0004707959672583666, 'f1-score': 0.0009407266498206562, 'support': 1055659}, '2': {'precision': 0.3644969508026363, 'recall': 0.3132511318682972, 'f1-score': 0.3369366445169455, 'support': 1063728}, 'accuracy': 0.35425630066036595, 'macro avg': {'precision': 0.4088065937962004, 'recall': 0.3521489300055247, 'f1-score': 0.2712468524833163, 'support': 3193078}, 'weighted avg': {'precision': 0.40836297675817124, 'recall': 0.35425630066036595, 'f1-score': 0.2725683650373468, 'support': 3193078}}
[[797457    245 275989]
 [750190    497 304972]
 [730285    229 333214]]
Evaluating performance on  val set...
3866/3866 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1088791
{'0': {'precision': 0.3304218507218927, 'recall': 0.7380061999499697, 'f1-score': 0.45647130712893064, 'support': 315809}, '1': {'precision': 0.39492753623188404, 'recall': 0.00031793627273681875, 'f1-score': 0.0006353610482874397, 'support': 342836}, '2': {'precision': 0.3603578821894716, 'recall': 0.30912160118104043, 'f1-score': 0.3327791465088673, 'support': 330556}, 'accuracy': 0.3390210887372738, 'macro avg': {'precision': 0.36190242304774944, 'recall': 0.3491485791345823, 'f1-score': 0.2632952715620285, 'support': 989201}, 'weighted avg': {'precision': 0.3627817108668991, 'recall': 0.3390210887372738, 'f1-score': 0.2571547291468734, 'support': 989201}}
[[233069     87  82653]
 [244005    109  98722]
 [228294     80 102182]]
testing model out of sample: results/universal/W7/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 81s - 81s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1225326
{'0': {'precision': 0.3049260031114255, 'recall': 0.7096976064525305, 'f1-score': 0.4265724797125857, 'support': 1089805}, '1': {'precision': 0.441131498470948, 'recall': 0.0003733163561735656, 'f1-score': 0.0007460013937426386, 'support': 1545606}, '2': {'precision': 0.33229732035769544, 'recall': 0.3607890933294463, 'f1-score': 0.3459575791995696, 'support': 1138826}, 'accuracy': 0.3139402745508562, 'macro avg': {'precision': 0.3594516073133563, 'recall': 0.35695333871271684, 'f1-score': 0.2577586867686326, 'support': 3774237}, 'weighted avg': {'precision': 0.3689631048077288, 'recall': 0.3139402745508562, 'f1-score': 0.22786574652648484, 'support': 3774237}}
[[ 773432     350  316023]
 [1035457     577  509572]
 [ 727569     381  410876]]
Evaluating performance on  train set...
5285/5285 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033702
{'0': {'precision': 0.3516343227061108, 'recall': 0.7024067757045362, 'f1-score': 0.46865408039871703, 'support': 454093}, '1': {'precision': 0.36980306345733044, 'recall': 0.0003756240025960286, 'f1-score': 0.0007504857063558146, 'support': 449918}, '2': {'precision': 0.3618574326737945, 'recall': 0.3590190536480113, 'f1-score': 0.3604326552442162, 'support': 448628}, 'accuracy': 0.35500455036414, 'macro avg': {'precision': 0.36109827294574526, 'recall': 0.3539338177850479, 'f1-score': 0.2766124071164297, 'support': 1352639}, 'weighted avg': {'precision': 0.3610683379015097, 'recall': 0.35500455036414, 'f1-score': 0.2771252164216979, 'support': 1352639}}
[[318958    145 134990]
 [300696    169 149053]
 [287419    143 161066]]
Evaluating performance on  val set...
1714/1714 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074058
{'0': {'precision': 0.3378536016331292, 'recall': 0.6920549581839904, 'f1-score': 0.4540466392318245, 'support': 140616}, '1': {'precision': 0.33544303797468356, 'recall': 0.0003485741344838472, 'f1-score': 0.0006964245824737527, 'support': 152048}, '2': {'precision': 0.360138016644754, 'recall': 0.3712121733268211, 'f1-score': 0.3655912521510549, 'support': 145367}, 'accuracy': 0.3454755485342362, 'macro avg': {'precision': 0.34447821875085555, 'recall': 0.35453856854843185, 'f1-score': 0.273444771988451, 'support': 438031}, 'weighted avg': {'precision': 0.3444122634033133, 'recall': 0.3454755485342362, 'f1-score': 0.2673258644675391, 'support': 438031}}
[[97314    47 43255]
 [99375    53 52620]
 [91347    58 53962]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
695/695 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1211162
{'0': {'precision': 0.3042045881910493, 'recall': 0.7630079613628645, 'f1-score': 0.4349846200176386, 'support': 53006}, '1': {'precision': 0.3619631901840491, 'recall': 0.000860572645458656, 'f1-score': 0.001717062949273886, 'support': 68559}, '2': {'precision': 0.3354461456054993, 'recall': 0.26670688859708275, 'f1-score': 0.29715302491103207, 'support': 56354}, 'accuracy': 0.3121251805596929, 'macro avg': {'precision': 0.33387130799353254, 'recall': 0.3435251408684687, 'f1-score': 0.24461823595931484, 'support': 177919}, 'weighted avg': {'precision': 0.3363566277178676, 'recall': 0.3121251805596929, 'f1-score': 0.2243733184945426, 'support': 177919}}
[[40444    42 12520]
 [51244    59 17256]
 [41262    62 15030]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104894
{'0': {'precision': 0.34961173425366693, 'recall': 0.7417924413164639, 'f1-score': 0.47523978315262716, 'support': 24581}, '1': {'precision': 0.18421052631578946, 'recall': 0.00029318143742670466, 'f1-score': 0.0005854311282094171, 'support': 23876}, '2': {'precision': 0.35033584162416037, 'recall': 0.2947274503972469, 'f1-score': 0.32013475471872266, 'support': 23537}, 'accuracy': 0.34972358807678416, 'macro avg': {'precision': 0.29471936739787225, 'recall': 0.34560435771704584, 'f1-score': 0.26531998966651976, 'support': 71994}, 'weighted avg': {'precision': 0.29499501722800564, 'recall': 0.34972358807678416, 'f1-score': 0.26711751791963817, 'support': 71994}}
[[18234    17  6330]
 [17335     7  6534]
 [16586    14  6937]]
Evaluating performance on  val set...
73/73 - 1s - 554ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023059
{'0': {'precision': 0.34368324687213914, 'recall': 0.7159885568976478, 'f1-score': 0.46443298969072166, 'support': 6292}, '1': {'precision': 0.3181818181818182, 'recall': 0.0024067388688327317, 'f1-score': 0.0047773417505545136, 'support': 5817}, '2': {'precision': 0.35194174757281554, 'recall': 0.2945772776996406, 'f1-score': 0.3207145895363675, 'support': 6399}, 'accuracy': 0.3460125351199481, 'macro avg': {'precision': 0.33793560420892427, 'recall': 0.33765752448870706, 'f1-score': 0.26330830699254787, 'support': 18508}, 'weighted avg': {'precision': 0.33852355027023895, 'recall': 0.3460125351199481, 'f1-score': 0.2702752769905021, 'support': 18508}}
[[4505   12 1775]
 [4107   14 1696]
 [4496   18 1885]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
2006/2006 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016669
{'0': {'precision': 0.35812955302085003, 'recall': 0.8062934943522911, 'f1-score': 0.49596670108415075, 'support': 171574}, '1': {'precision': 0.37283236994219654, 'recall': 0.0007274860001240674, 'f1-score': 0.0014521385272613682, 'support': 177323}, '2': {'precision': 0.3840422425156081, 'recall': 0.2959167538375459, 'f1-score': 0.3342687848862172, 'support': 164428}, 'accuracy': 0.3645351385574441, 'macro avg': {'precision': 0.37166805515955154, 'recall': 0.3676459113966537, 'f1-score': 0.27722920816587643, 'support': 513325}, 'weighted avg': {'precision': 0.3715088338140863, 'recall': 0.3645351385574441, 'f1-score': 0.2733465856779868, 'support': 513325}}
[[138339    137  33098]
 [132252    129  44942]
 [115691     80  48657]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007584
{'0': {'precision': 0.3688642390138251, 'recall': 0.7785111609526861, 'f1-score': 0.500559672025326, 'support': 46815}, '1': {'precision': 0.3490566037735849, 'recall': 0.0007756976037233485, 'f1-score': 0.0015479552348080744, 'support': 47699}, '2': {'precision': 0.37674442689589105, 'recall': 0.3382301666627926, 'f1-score': 0.35644995345646957, 'support': 43021}, 'accuracy': 0.37106191151343293, 'macro avg': {'precision': 0.364888423227767, 'recall': 0.37250567507306737, 'f1-score': 0.2861858602388679, 'support': 137535}, 'weighted avg': {'precision': 0.3644596086982701, 'recall': 0.37106191151343293, 'f1-score': 0.2824180783819502, 'support': 137535}}
[[36446    39 10330]
 [33920    37 13742]
 [28440    30 14551]]
Evaluating performance on  val set...
153/153 - 1s - 952ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034101
{'0': {'precision': 0.34458777745748054, 'recall': 0.7587273881307521, 'f1-score': 0.4739320051541282, 'support': 12604}, '1': {'precision': 0.4358974358974359, 'recall': 0.0012778111846061336, 'f1-score': 0.0025481525893727053, 'support': 13304}, '2': {'precision': 0.383604227728928, 'recall': 0.32864099832597776, 'f1-score': 0.3540018851686407, 'support': 13142}, 'accuracy': 0.35592829705505763, 'macro avg': {'precision': 0.3880298136946148, 'recall': 0.3628820658804453, 'f1-score': 0.27682734763738054, 'support': 39050}, 'weighted avg': {'precision': 0.38882690384294866, 'recall': 0.35592829705505763, 'f1-score': 0.2729739408424564, 'support': 39050}}
[[9563   15 3026]
 [9373   17 3914]
 [8816    7 4319]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062042
{'0': {'precision': 0.3437854607788696, 'recall': 0.7312210339825145, 'f1-score': 0.46768677458954144, 'support': 77893}, '1': {'precision': 0.4444444444444444, 'recall': 0.00014862153526045923, 'f1-score': 0.00029714370612487465, 'support': 80742}, '2': {'precision': 0.3608123260932763, 'recall': 0.3286551919803291, 'f1-score': 0.3439838460624777, 'support': 79305}, 'accuracy': 0.348966125914096, 'macro avg': {'precision': 0.38301407710553015, 'recall': 0.35334161583270135, 'f1-score': 0.27065592145271467, 'support': 237940}, 'weighted avg': {'precision': 0.38361786900314826, 'recall': 0.348966125914096, 'f1-score': 0.26785389939567905, 'support': 237940}}
[[56957     4 20932]
 [55489    12 25241]
 [53230    11 26064]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033871
{'0': {'precision': 0.34583013312852023, 'recall': 0.6704200012407717, 'f1-score': 0.4562881330884371, 'support': 32238}, '1': {'precision': 0.631578947368421, 'recall': 0.0003726939561463445, 'f1-score': 0.0007449483192103547, 'support': 32198}, '2': {'precision': 0.3688330238537352, 'recall': 0.39024906299117396, 'f1-score': 0.3792389372732747, 'support': 33084}, 'accuracy': 0.35414273995077933, 'macro avg': {'precision': 0.44874736811689214, 'recall': 0.3536805860626973, 'f1-score': 0.27875733956030735, 'support': 97520}, 'weighted avg': {'precision': 0.44797910726356266, 'recall': 0.35414273995077933, 'f1-score': 0.27974306481989325, 'support': 97520}}
[[21613     3 10622]
 [20714    12 11472]
 [20169     4 12911]]
Evaluating performance on  val set...
114/114 - 1s - 757ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076304
{'0': {'precision': 0.33420889987639063, 'recall': 0.7040251708798958, 'f1-score': 0.4532532392693745, 'support': 9217}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9827}, '2': {'precision': 0.3686988924541973, 'recall': 0.3550284062593442, 'f1-score': 0.361734538438103, 'support': 10033}, 'accuracy': 0.34566839770265156, 'macro avg': {'precision': 0.23430259744352933, 'recall': 0.3530178590464133, 'f1-score': 0.27166259256915914, 'support': 29077}, 'weighted avg': {'precision': 0.23315883406656995, 'recall': 0.34566839770265156, 'f1-score': 0.2684911693261104, 'support': 29077}}
[[6489    0 2728]
 [6456    0 3371]
 [6471    0 3562]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1103935
{'0': {'precision': 0.3120208080867792, 'recall': 0.646890128071573, 'f1-score': 0.4209842080076568, 'support': 81595}, '1': {'precision': 0.4166666666666667, 'recall': 5.375823845004247e-05, 'f1-score': 0.00010750260693821825, 'support': 93009}, '2': {'precision': 0.38557996765853614, 'recall': 0.4069660486887558, 'f1-score': 0.3959844669076517, 'support': 97846}, 'accuracy': 0.3399082400440448, 'macro avg': {'precision': 0.37142248080399404, 'recall': 0.3513033116662596, 'f1-score': 0.2723587258407489, 'support': 272450}, 'weighted avg': {'precision': 0.37416239805967283, 'recall': 0.3399082400440448, 'f1-score': 0.2683270372963831, 'support': 272450}}
[[52783     2 28810]
 [58361     5 34643]
 [58021     5 39820]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009898
{'0': {'precision': 0.36068693432350896, 'recall': 0.6612303939643192, 'f1-score': 0.4667641052336523, 'support': 35257}, '1': {'precision': 0.81875, 'recall': 0.007740715573019766, 'f1-score': 0.01533643574209032, 'support': 33847}, '2': {'precision': 0.3604851766329591, 'recall': 0.40509424958243856, 'f1-score': 0.38149006390000706, 'support': 33528}, 'accuracy': 0.36204107880583053, 'macro avg': {'precision': 0.5133073703188227, 'recall': 0.35802178637325915, 'f1-score': 0.28786353495858324, 'support': 102632}, 'weighted avg': {'precision': 0.5116856097084127, 'recall': 0.36204107880583053, 'f1-score': 0.29003033421569147, 'support': 102632}}
[[23313    45 11899]
 [21389   262 12196]
 [19933    13 13582]]
Evaluating performance on  val set...
123/123 - 1s - 795ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040076
{'0': {'precision': 0.33246087572932004, 'recall': 0.6461424332344213, 'f1-score': 0.43902790279027903, 'support': 9436}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10485}, '2': {'precision': 0.39889579020013805, 'recall': 0.4539267015706806, 'f1-score': 0.42463572915391207, 'support': 11460}, 'accuracy': 0.3600586342054109, 'macro avg': {'precision': 0.24378555530981938, 'recall': 0.36668971160170066, 'f1-score': 0.28788787731473037, 'support': 31381}, 'weighted avg': {'precision': 0.24564056528075734, 'recall': 0.3600586342054109, 'f1-score': 0.2870843104691662, 'support': 31381}}
[[6097    1 3338]
 [5984    0 4501]
 [6258    0 5202]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
1646/1646 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1308569
{'0': {'precision': 0.2762134556927279, 'recall': 0.726793643999786, 'f1-score': 0.40029663607811744, 'support': 112146}, '1': {'precision': 0.5555555555555556, 'recall': 0.00019473763276933606, 'f1-score': 0.0003893387914923912, 'support': 179729}, '2': {'precision': 0.3260445572028859, 'recall': 0.31779297554190333, 'f1-score': 0.321865889212828, 'support': 129405}, 'accuracy': 0.2911745157614888, 'macro avg': {'precision': 0.38593785615038984, 'recall': 0.34826045239148623, 'f1-score': 0.2408506213608126, 'support': 421280}, 'weighted avg': {'precision': 0.41069472695452086, 'recall': 0.2911745157614888, 'f1-score': 0.2055941355271048, 'support': 421280}}
[[ 81507     13  30626]
 [125314     35  54380]
 [ 88266     15  41124]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1041758
{'0': {'precision': 0.34852483153066427, 'recall': 0.67734196161296, 'f1-score': 0.4602361527589791, 'support': 45432}, '1': {'precision': 0.38235294117647056, 'recall': 0.00029283896109747034, 'f1-score': 0.0005852297026582935, 'support': 44393}, '2': {'precision': 0.3545061594985952, 'recall': 0.3663510072810113, 'f1-score': 0.3603312683976978, 'support': 44774}, 'accuracy': 0.3505895288969457, 'macro avg': {'precision': 0.3617946440685767, 'recall': 0.34799526928502295, 'f1-score': 0.27371755028644507, 'support': 134599}, 'weighted avg': {'precision': 0.3616715803916693, 'recall': 0.3505895288969457, 'f1-score': 0.2754025008029374, 'support': 134599}}
[[30773    14 14645]
 [29158    13 15222]
 [28364     7 16403]]
Evaluating performance on  val set...
146/146 - 1s - 900ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1120715
{'0': {'precision': 0.32359012468004295, 'recall': 0.6760976451306823, 'f1-score': 0.4376937037554098, 'support': 11593}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13334}, '2': {'precision': 0.3515470202713001, 'recall': 0.37150680518643797, 'f1-score': 0.36125141939778377, 'support': 12417}, 'accuracy': 0.3334136675235647, 'macro avg': {'precision': 0.225045714983781, 'recall': 0.34920148343904006, 'f1-score': 0.2663150410510645, 'support': 37344}, 'weighted avg': {'precision': 0.21734521385294747, 'recall': 0.3334136675235647, 'f1-score': 0.2559940547959176, 'support': 37344}}
[[7838    0 3755]
 [8580    0 4754]
 [7804    0 4613]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/EXC
Evaluating performance on  test set...
5928/5928 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978353
{'0': {'precision': 0.3810604817008933, 'recall': 0.7304663538521593, 'f1-score': 0.500845956682102, 'support': 502108}, '1': {'precision': 0.5848684210526316, 'recall': 0.0032307124829424557, 'f1-score': 0.006425929238881569, 'support': 550343}, '2': {'precision': 0.3861440304915384, 'recall': 0.45829328964540106, 'f1-score': 0.4191364208824949, 'support': 465117}, 'accuracy': 0.38331791392543857, 'macro avg': {'precision': 0.4506909777483545, 'recall': 0.39733011866016765, 'f1-score': 0.3088027689344928, 'support': 1517568}, 'weighted avg': {'precision': 0.4565290720569842, 'recall': 0.38331791392543857, 'f1-score': 0.2965024970640222, 'support': 1517568}}
[[366773    789 134546]
 [344249   1778 204316]
 [251484    473 213160]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979704
{'0': {'precision': 0.3621574650392046, 'recall': 0.6792953462147128, 'f1-score': 0.4724398032050035, 'support': 105527}, '1': {'precision': 0.6614173228346457, 'recall': 0.0007948448633150709, 'f1-score': 0.0015877816422198703, 'support': 105681}, '2': {'precision': 0.3901613467531305, 'recall': 0.4368884272672607, 'f1-score': 0.41220488178078835, 'support': 109758}, 'accuracy': 0.37299900924085416, 'macro avg': {'precision': 0.4712453782089936, 'recall': 0.3723262061150962, 'f1-score': 0.29541082220933723, 'support': 320966}, 'weighted avg': {'precision': 0.470267766693701, 'recall': 0.37299900924085416, 'f1-score': 0.2968094342673106, 'support': 320966}}
[[71684    15 33828]
 [64474    84 41123]
 [61778    28 47952]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034565
{'0': {'precision': 0.34900467121810996, 'recall': 0.6876221221646419, 'f1-score': 0.4630081610861108, 'support': 35313}, '1': {'precision': 0.5263157894736842, 'recall': 0.0010615147815933336, 'f1-score': 0.002118756290057736, 'support': 37682}, '2': {'precision': 0.3712082912032356, 'recall': 0.4054837640821736, 'f1-score': 0.3875897381756757, 'support': 36216}, 'accuracy': 0.3571709809451429, 'macro avg': {'precision': 0.41550958396501, 'recall': 0.3647224670094696, 'f1-score': 0.2842388851839481, 'support': 109211}, 'weighted avg': {'precision': 0.4175468863748969, 'recall': 0.3571709809451429, 'f1-score': 0.2789736942682153, 'support': 109211}}
[[24282    26 11005]
 [23772    40 13870]
 [21521    10 14685]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/AAL
Evaluating performance on  test set...
5331/5331 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1177603
{'0': {'precision': 0.31558565806353417, 'recall': 0.7061482249110874, 'f1-score': 0.4362197553832074, 'support': 411078}, '1': {'precision': 0.4950980392156863, 'recall': 0.0005689040429738473, 'f1-score': 0.0011365021614170643, 'support': 532603}, '2': {'precision': 0.3365340669880158, 'recall': 0.3551221134657417, 'f1-score': 0.3455783162194872, 'support': 420920}, 'accuracy': 0.3224847409609109, 'macro avg': {'precision': 0.38240592142241203, 'recall': 0.3539464141399343, 'f1-score': 0.2609781912547039, 'support': 1364601}, 'weighted avg': {'precision': 0.39211091124983, 'recall': 0.3224847409609109, 'f1-score': 0.23844806938233368, 'support': 1364601}}
[[290282    169 120627]
 [358236    303 174064]
 [271302    140 149478]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032243
{'0': {'precision': 0.3555660157968322, 'recall': 0.7271977124651168, 'f1-score': 0.4776051996733269, 'support': 174511}, '1': {'precision': 0.3515151515151515, 'recall': 0.00033514000762732433, 'f1-score': 0.0006696415685776468, 'support': 173062}, '2': {'precision': 0.35943325876211785, 'recall': 0.3390784382694337, 'f1-score': 0.34895927601809956, 'support': 167737}, 'accuracy': 0.3567522462207215, 'macro avg': {'precision': 0.3555048086913672, 'recall': 0.35553709691405927, 'f1-score': 0.2757447057533347, 'support': 515310}, 'weighted avg': {'precision': 0.35546438582448914, 'recall': 0.3567522462207215, 'f1-score': 0.2755557481725196, 'support': 515310}}
[[126904     56  47551]
 [119193     58  53811]
 [110810     51  56876]]
Evaluating performance on  val set...
696/696 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040914
{'0': {'precision': 0.34998080168587986, 'recall': 0.6708429610611896, 'f1-score': 0.45998568192754113, 'support': 58425}, '1': {'precision': 0.3783783783783784, 'recall': 0.0004616424579163438, 'f1-score': 0.000922159830059117, 'support': 60653}, '2': {'precision': 0.3643761576534175, 'recall': 0.4078095529387776, 'f1-score': 0.38487134873353274, 'support': 58851}, 'accuracy': 0.35532150464511125, 'macro avg': {'precision': 0.3642451125725586, 'recall': 0.3597047188192945, 'f1-score': 0.2819263968303776, 'support': 177929}, 'weighted avg': {'precision': 0.3644224009371299, 'recall': 0.35532150464511125, 'f1-score': 0.2786541765035846, 'support': 177929}}
[[39194    24 19207]
 [37966    28 22659]
 [34829    22 24000]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/WBA
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1311986
{'0': {'precision': 0.28422939812411313, 'recall': 0.7151301512771301, 'f1-score': 0.40678254908293326, 'support': 287089}, '1': {'precision': 0.5627118644067797, 'recall': 0.0003423972344204102, 'f1-score': 0.0006843780405349693, 'support': 484817}, '2': {'precision': 0.3165965337707724, 'recall': 0.36839519451332664, 'f1-score': 0.340537372423147, 'support': 301239}, 'accuracy': 0.29487813855536765, 'macro avg': {'precision': 0.387845932100555, 'recall': 0.361289247674959, 'f1-score': 0.2493347665155384, 'support': 1073145}, 'weighted avg': {'precision': 0.4191256865388451, 'recall': 0.29487813855536765, 'f1-score': 0.204723248837319, 'support': 1073145}}
[[205306     54  81729]
 [326830    166 157821]
 [190189     75 110975]]
Evaluating performance on  train set...
1230/1230 - 6s - 6s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997051
{'0': {'precision': 0.3629634901430503, 'recall': 0.7070828442291873, 'f1-score': 0.4796899885877676, 'support': 108191}, '1': {'precision': 0.3783783783783784, 'recall': 0.0002747684094834354, 'f1-score': 0.0005491380493832002, 'support': 101904}, '2': {'precision': 0.36854500711346944, 'recall': 0.3659279196731951, 'f1-score': 0.36723180076628353, 'support': 104772}, 'accuracy': 0.36481117424182274, 'macro avg': {'precision': 0.3699622918782994, 'recall': 0.35776184410395534, 'f1-score': 0.28249030913447815, 'support': 314867}, 'weighted avg': {'precision': 0.36980963618807133, 'recall': 0.36481117424182274, 'f1-score': 0.2871997038399342, 'support': 314867}}
[[76500    20 31671]
 [67858    28 34018]
 [66407    26 38339]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1061755
{'0': {'precision': 0.342048490563342, 'recall': 0.7179571762730163, 'f1-score': 0.46334878409893654, 'support': 33346}, '1': {'precision': 0.4444444444444444, 'recall': 0.00034232897814800024, 'f1-score': 0.0006841310110886234, 'support': 35054}, '2': {'precision': 0.3662063615205586, 'recall': 0.34867779583394887, 'f1-score': 0.35722718329044945, 'support': 33845}, 'accuracy': 0.34968947136779305, 'macro avg': {'precision': 0.38423309884278173, 'recall': 0.3556591003617044, 'f1-score': 0.2737533661334915, 'support': 102245}, 'weighted avg': {'precision': 0.38515094946006223, 'recall': 0.34968947136779305, 'f1-score': 0.2695991403148428, 'support': 102245}}
[[23941     7  9398]
 [24016    12 11026]
 [22036     8 11801]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
6143/6143 - 34s - 34s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1270913
{'0': {'precision': 0.29731381821204844, 'recall': 0.6977336681340978, 'f1-score': 0.41695670571420923, 'support': 435682}, '1': {'precision': 0.4384133611691023, 'recall': 0.00030702966345162746, 'f1-score': 0.0006136295898032295, 'support': 683973}, '2': {'precision': 0.32593897332971833, 'recall': 0.3955551826023205, 'f1-score': 0.3573884807039071, 'support': 452842}, 'accuracy': 0.30736084075200143, 'macro avg': {'precision': 0.35388871757028967, 'recall': 0.36453196013329, 'f1-score': 0.25831960533597315, 'support': 1572497}, 'weighted avg': {'precision': 0.36692981759949456, 'recall': 0.30736084075200143, 'f1-score': 0.21870995741761243, 'support': 1572497}}
[[303990    118 131574]
 [444898    210 238865]
 [273567    151 179124]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103094
{'0': {'precision': 0.34942355846393675, 'recall': 0.6838341857881589, 'f1-score': 0.46251339692662113, 'support': 177331}, '1': {'precision': 0.4097560975609756, 'recall': 0.0004762201724597339, 'f1-score': 0.0009513346999331801, 'support': 176389}, '2': {'precision': 0.365579024348275, 'recall': 0.3787605294825511, 'f1-score': 0.37205306131383664, 'support': 179496}, 'accuracy': 0.3550812428734322, 'macro avg': {'precision': 0.37491956012439576, 'recall': 0.3543569784810566, 'f1-score': 0.2785059309801303, 'support': 533216}, 'weighted avg': {'precision': 0.3748200914696282, 'recall': 0.3550812428734322, 'f1-score': 0.2793760961043359, 'support': 533216}}
[[121265     55  56011]
 [114334     84  61971]
 [111444     66  67986]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1103902
{'0': {'precision': 0.3289717277486911, 'recall': 0.7128646372234021, 'f1-score': 0.4501902971386647, 'support': 55089}, '1': {'precision': 0.4, 'recall': 0.00019225531505839756, 'f1-score': 0.000384325908370298, 'support': 62417}, '2': {'precision': 0.358252044183044, 'recall': 0.3464546447708395, 'f1-score': 0.35225459514259266, 'support': 57667}, 'accuracy': 0.3383055607884777, 'macro avg': {'precision': 0.3624079239772451, 'recall': 0.3531705124364333, 'f1-score': 0.2676097393965426, 'support': 175173}, 'weighted avg': {'precision': 0.3639193491111715, 'recall': 0.3383055607884777, 'f1-score': 0.2576766253211542, 'support': 175173}}
[[39271    12 15806]
 [42422    12 19983]
 [37682     6 19979]]
testing model on single stock: results/universal/W7/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
23942/23942 - 114s - 114s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1261866
{'0': {'precision': 0.3014789704241636, 'recall': 0.7020034712787725, 'f1-score': 0.4218096400294874, 'support': 1803370}, '1': {'precision': 0.2540192926045016, 'recall': 3.109828514608124e-05, 'f1-score': 6.21889568156735e-05, 'support': 2540333}, '2': {'precision': 0.30763294728337226, 'recall': 0.3324776683193716, 'f1-score': 0.319573156632253, 'support': 1785356}, 'accuracy': 0.3034139498412399, 'macro avg': {'precision': 0.28771040343734583, 'recall': 0.3448374126277634, 'f1-score': 0.2471483285395187, 'support': 6129059}, 'weighted avg': {'precision': 0.2836008024663733, 'recall': 0.3034139498412399, 'f1-score': 0.21722562694070066, 'support': 6129059}}
[[1265972     108  537290]
 [1741592      79  798662]
 [1191641     124  593591]]
Evaluating performance on  train set...
9052/9052 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045221
{'0': {'precision': 0.3454881408436342, 'recall': 0.7578625043546673, 'f1-score': 0.47461341285124525, 'support': 777901}, '1': {'precision': 0.3136094674556213, 'recall': 0.00013828588127243885, 'f1-score': 0.00027644986216627154, 'support': 766528}, '2': {'precision': 0.3578858892710093, 'recall': 0.2827040480218055, 'f1-score': 0.31588316873778904, 'support': 772649}, 'accuracy': 0.3487491573438615, 'macro avg': {'precision': 0.3389944991900882, 'recall': 0.34690161275258175, 'f1-score': 0.2635910104837335, 'support': 2317078}, 'weighted avg': {'precision': 0.3390762773543154, 'recall': 0.3487491573438615, 'f1-score': 0.26476491920963696, 'support': 2317078}}
[[589542    107 188252]
 [562768    106 203654]
 [554093    125 218431]]
Evaluating performance on  val set...
2763/2763 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105831
{'0': {'precision': 0.3257734656727102, 'recall': 0.7520589933810137, 'f1-score': 0.45461771466626566, 'support': 225110}, '1': {'precision': 0.2878787878787879, 'recall': 0.0001542765040944172, 'f1-score': 0.00030838774077575744, 'support': 246311}, '2': {'precision': 0.35399022975019734, 'recall': 0.28138181294061293, 'f1-score': 0.31353728498515593, 'support': 235893}, 'accuracy': 0.33324662031290203, 'macro avg': {'precision': 0.32254749443389846, 'recall': 0.34453169427524033, 'f1-score': 0.25615446246406576, 'support': 707314}, 'weighted avg': {'precision': 0.3219876805001163, 'recall': 0.33324662031290203, 'f1-score': 0.24936054398519564, 'support': 707314}}
[[169296     47  55767]
 [180908     38  65365]
 [169470     47  66376]]
training model: results/universal/W7/deepOF_L1/h500
Epoch 1/50
12475/12475 - 184s - loss: 3.2839 - accuracy500: 0.3651 - val_loss: 3.3036 - val_accuracy500: 0.3319 - 184s/epoch - 15ms/step
Epoch 2/50
12475/12475 - 180s - loss: 3.2829 - accuracy500: 0.3648 - val_loss: 3.3035 - val_accuracy500: 0.3343 - 180s/epoch - 14ms/step
Epoch 3/50
12475/12475 - 180s - loss: 3.2822 - accuracy500: 0.3663 - val_loss: 3.3060 - val_accuracy500: 0.3346 - 180s/epoch - 14ms/step
Epoch 4/50
12475/12475 - 180s - loss: 3.2812 - accuracy500: 0.3676 - val_loss: 3.3093 - val_accuracy500: 0.3326 - 180s/epoch - 14ms/step
Epoch 5/50
12475/12475 - 179s - loss: 3.2803 - accuracy500: 0.3690 - val_loss: 3.3103 - val_accuracy500: 0.3329 - 179s/epoch - 14ms/step
Epoch 6/50
12475/12475 - 176s - loss: 3.2790 - accuracy500: 0.3702 - val_loss: 3.3133 - val_accuracy500: 0.3305 - 176s/epoch - 14ms/step
Epoch 7/50
12475/12475 - 176s - loss: 3.2781 - accuracy500: 0.3712 - val_loss: 3.3143 - val_accuracy500: 0.3296 - 176s/epoch - 14ms/step
Epoch 8/50
12475/12475 - 177s - loss: 3.2775 - accuracy500: 0.3719 - val_loss: 3.3144 - val_accuracy500: 0.3309 - 177s/epoch - 14ms/step
Epoch 9/50
12475/12475 - 177s - loss: 3.2769 - accuracy500: 0.3725 - val_loss: 3.3173 - val_accuracy500: 0.3301 - 177s/epoch - 14ms/step
Epoch 10/50
12475/12475 - 180s - loss: 3.2763 - accuracy500: 0.3728 - val_loss: 3.3181 - val_accuracy500: 0.3315 - 180s/epoch - 14ms/step
Epoch 11/50
12475/12475 - 177s - loss: 3.2758 - accuracy500: 0.3735 - val_loss: 3.3161 - val_accuracy500: 0.3320 - 177s/epoch - 14ms/step
Epoch 12/50
12475/12475 - 176s - loss: 3.2755 - accuracy500: 0.3737 - val_loss: 3.3150 - val_accuracy500: 0.3313 - 176s/epoch - 14ms/step
testing model in sample: results/universal/W7/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 189s - 189s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035689
{'0': {'precision': 0.3160708247137778, 'recall': 0.7395825550041303, 'f1-score': 0.4428735276091171, 'support': 2904191}, '1': {'precision': 0.3786542923433875, 'recall': 0.00021890690340089044, 'f1-score': 0.0004375608449535856, 'support': 3727612}, '2': {'precision': 0.3281463388332512, 'recall': 0.30919733977695996, 'f1-score': 0.3183901509654501, 'support': 2873744}, 'accuracy': 0.319524904774023, 'macro avg': {'precision': 0.3409571519634722, 'recall': 0.3496662672281637, 'f1-score': 0.2539004131398403, 'support': 9505547}, 'weighted avg': {'precision': 0.3442637126333785, 'recall': 0.319524904774023, 'f1-score': 0.23173754819928669, 'support': 9505547}}
[[2147889     620  755682]
 [2663234     816 1063562]
 [1984471     719  888554]]
Evaluating performance on  train set...
12475/12475 - 68s - 68s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989313
{'0': {'precision': 0.3434712050737154, 'recall': 0.776905923122854, 'f1-score': 0.47634819906301457, 'support': 1066819}, '1': {'precision': 0.36608557844690964, 'recall': 0.0002161672516907367, 'f1-score': 0.0004320793679296103, 'support': 1068617}, '2': {'precision': 0.3548281140337934, 'recall': 0.26147505488624695, 'f1-score': 0.3010813679726732, 'support': 1057642}, 'accuracy': 0.346247727114715, 'macro avg': {'precision': 0.35479496585147285, 'recall': 0.3461990484202639, 'f1-score': 0.2592872154678725, 'support': 3193078}, 'weighted avg': {'precision': 0.35480122824799976, 'recall': 0.346247727114715, 'f1-score': 0.2590213383197902, 'support': 3193078}}
[[828818    186 237815]
 [803365    231 265021]
 [780881    214 276547]]
Evaluating performance on  val set...
3866/3866 - 22s - 22s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010748
{'0': {'precision': 0.32527620315641537, 'recall': 0.7698605195979196, 'f1-score': 0.457326106543157, 'support': 314166}, '1': {'precision': 0.3548387096774194, 'recall': 0.00016143376666069852, 'f1-score': 0.00032272071162850734, 'support': 340697}, '2': {'precision': 0.3619302512210721, 'recall': 0.2657400594607852, 'f1-score': 0.3064646036090573, 'support': 334338}, 'accuracy': 0.3343769365376703, 'macro avg': {'precision': 0.3473483880183023, 'recall': 0.3452540042751218, 'f1-score': 0.2547044769546143, 'support': 989201}, 'weighted avg': {'precision': 0.3478466397067501, 'recall': 0.3343769365376703, 'f1-score': 0.24893730011188034, 'support': 989201}}
[[241864     48  72254]
 [256262     55  84380]
 [245439     52  88847]]
testing model out of sample: results/universal/W7/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 80s - 80s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047133
{'0': {'precision': 0.3058597943028159, 'recall': 0.7288461469543683, 'f1-score': 0.4308948536914864, 'support': 1116156}, '1': {'precision': 0.41243862520458263, 'recall': 0.00033853585927655426, 'f1-score': 0.0006765164236442491, 'support': 1488764}, '2': {'precision': 0.3340812733544122, 'recall': 0.3180711475160286, 'f1-score': 0.3258796887930721, 'support': 1169317}, 'accuracy': 0.31421874143038714, 'macro avg': {'precision': 0.35079323095393694, 'recall': 0.3490852767765578, 'f1-score': 0.25248368630273427, 'support': 3774237}, 'weighted avg': {'precision': 0.3566437227706925, 'recall': 0.31421874143038714, 'f1-score': 0.22865805980765216, 'support': 3774237}}
[[ 813506     334  302316]
 [1049222     504  439038]
 [ 797007     384  371926]]
Evaluating performance on  train set...
5285/5285 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985826
{'0': {'precision': 0.34755528196766994, 'recall': 0.7310941279916708, 'f1-score': 0.4711366333730827, 'support': 457186}, '1': {'precision': 0.3423913043478261, 'recall': 0.0002819611967686352, 'f1-score': 0.0005634583823378157, 'support': 446870}, '2': {'precision': 0.3550394940662886, 'recall': 0.3091200513617324, 'f1-score': 0.330492356533055, 'support': 448583}, 'accuracy': 0.34971489066927686, 'macro avg': {'precision': 0.3483286934605949, 'recall': 0.34683204685005725, 'f1-score': 0.26739748276282516, 'support': 1352639}, 'weighted avg': {'precision': 0.3483312936284716, 'recall': 0.34971489066927686, 'f1-score': 0.26903121844282835, 'support': 1352639}}
[[334246    105 122835]
 [317680    126 129064]
 [309780    137 138666]]
Evaluating performance on  val set...
1714/1714 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990132
{'0': {'precision': 0.33931075804763067, 'recall': 0.7173121759404253, 'f1-score': 0.46069743585159095, 'support': 143685}, '1': {'precision': 0.4369747899159664, 'recall': 0.0003642629978844726, 'f1-score': 0.0007279192009686925, 'support': 142754}, '2': {'precision': 0.3676784090400871, 'recall': 0.3253931605889493, 'f1-score': 0.3452458442694663, 'support': 151592}, 'accuracy': 0.34802559636190133, 'macro avg': {'precision': 0.38132131900122807, 'recall': 0.34768986650908634, 'f1-score': 0.26889039977400864, 'support': 438031}, 'weighted avg': {'precision': 0.38095676062411693, 'recall': 0.34802559636190133, 'f1-score': 0.2708386677482823, 'support': 438031}}
[[103067     30  40588]
 [ 98459     52  44243]
 [102228     37  49327]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
695/695 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107972
{'0': {'precision': 0.28076186134636344, 'recall': 0.7949059229233468, 'f1-score': 0.41495946941783346, 'support': 49587}, '1': {'precision': 0.2222222222222222, 'recall': 0.0003917344040740378, 'f1-score': 0.0007820901358881612, 'support': 71477}, '2': {'precision': 0.34299465240641713, 'recall': 0.22562659396710932, 'f1-score': 0.2721977613919686, 'support': 56855}, 'accuracy': 0.29380223584889753, 'macro avg': {'precision': 0.2819929119916676, 'recall': 0.3403080837648434, 'f1-score': 0.22931310698189675, 'support': 177919}, 'weighted avg': {'precision': 0.2771310380506115, 'recall': 0.29380223584889753, 'f1-score': 0.2029479729011818, 'support': 177919}}
[[39417    42 10128]
 [57005    28 14444]
 [43971    56 12828]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993953
{'0': {'precision': 0.3453627967136065, 'recall': 0.7722199592668024, 'f1-score': 0.47727301335548755, 'support': 24550}, '1': {'precision': 0.22580645161290322, 'recall': 0.0002886002886002886, 'f1-score': 0.0005764638063081611, 'support': 24255}, '2': {'precision': 0.3359695371997657, 'recall': 0.24731553753935057, 'f1-score': 0.28490523858019323, 'support': 23189}, 'accuracy': 0.3430841459010473, 'macro avg': {'precision': 0.3023795951754251, 'recall': 0.3399413656982511, 'f1-score': 0.25425157191399633, 'support': 71994}, 'weighted avg': {'precision': 0.3020583623818009, 'recall': 0.3430841459010473, 'f1-score': 0.2547115340852755, 'support': 71994}}
[[18958    10  5582]
 [18495     7  5753]
 [17440    14  5735]]
Evaluating performance on  val set...
73/73 - 1s - 557ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007189
{'0': {'precision': 0.32441641293315937, 'recall': 0.7554017555705604, 'f1-score': 0.4538999898569835, 'support': 5924}, '1': {'precision': 0.3333333333333333, 'recall': 0.0004820051413881748, 'f1-score': 0.0009626183218353923, 'support': 6224}, '2': {'precision': 0.35132837407013817, 'recall': 0.2599056603773585, 'f1-score': 0.29877993673746045, 'support': 6360}, 'accuracy': 0.3312621569051221, 'macro avg': {'precision': 0.3363593734455437, 'recall': 0.33859647369643575, 'f1-score': 0.2512141816387598, 'support': 18508}, 'weighted avg': {'precision': 0.3366629541802886, 'recall': 0.3312621569051221, 'f1-score': 0.24827832688556958, 'support': 18508}}
[[4475    2 1447]
 [4616    3 1605]
 [4703    4 1653]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
2006/2006 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0932647
{'0': {'precision': 0.374820872330605, 'recall': 0.8377623661837941, 'f1-score': 0.5179204378306812, 'support': 185142}, '1': {'precision': 0.2793103448275862, 'recall': 0.0005396977692492204, 'f1-score': 0.0010773138973492757, 'support': 150084}, '2': {'precision': 0.3844634362654197, 'recall': 0.2141954755501154, 'f1-score': 0.2751160199478586, 'support': 178099}, 'accuracy': 0.37663078946086787, 'macro avg': {'precision': 0.34619821780787036, 'recall': 0.3508325131677195, 'f1-score': 0.2647045905586297, 'support': 513325}, 'weighted avg': {'precision': 0.35024137393185856, 'recall': 0.37663078946086787, 'f1-score': 0.2825664078634616, 'support': 513325}}
[[155105     96  29941]
 [118868     81  31135]
 [139838    113  38148]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942345
{'0': {'precision': 0.3718936969528315, 'recall': 0.8249382716049383, 'f1-score': 0.5126690323199387, 'support': 48600}, '1': {'precision': 0.3548387096774194, 'recall': 0.0007405745062836625, 'f1-score': 0.0014780641838174368, 'support': 44560}, '2': {'precision': 0.3710901913149104, 'recall': 0.24784225352112677, 'f1-score': 0.2971950494514403, 'support': 44375}, 'accuracy': 0.3717090195223034, 'macro avg': {'precision': 0.36594086598172043, 'recall': 0.35784036654411616, 'f1-score': 0.27044738198506546, 'support': 137535}, 'weighted avg': {'precision': 0.36610880004895163, 'recall': 0.3717090195223034, 'f1-score': 0.27752650474561086, 'support': 137535}}
[[40092    27  8481]
 [34369    33 10158]
 [33344    33 10998]]
Evaluating performance on  val set...
153/153 - 1s - 958ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034621
{'0': {'precision': 0.30896327936161055, 'recall': 0.8062035597027821, 'f1-score': 0.44672651107121486, 'support': 11574}, '1': {'precision': 0.59375, 'recall': 0.0012270731077241024, 'f1-score': 0.002449084815674143, 'support': 15484}, '2': {'precision': 0.34217987977770215, 'recall': 0.25158438959306206, 'f1-score': 0.28997068576096885, 'support': 11992}, 'accuracy': 0.316696542893726, 'macro avg': {'precision': 0.4149643863797709, 'recall': 0.3530050074678561, 'f1-score': 0.24638209388261925, 'support': 39050}, 'weighted avg': {'precision': 0.4320867378649292, 'recall': 0.316696542893726, 'f1-score': 0.22242414166631697, 'support': 39050}}
[[ 9331     7  2236]
 [11901    19  3564]
 [ 8969     6  3017]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009481
{'0': {'precision': 0.33371173775403323, 'recall': 0.7375615938748852, 'f1-score': 0.45951477354218534, 'support': 77321}, '1': {'precision': 0.2708333333333333, 'recall': 0.00015966985187550664, 'f1-score': 0.0003191515478850072, 'support': 81418}, '2': {'precision': 0.3587068463708414, 'recall': 0.3034431383442128, 'f1-score': 0.32876880984952117, 'support': 79201}, 'accuracy': 0.34073716062872994, 'macro avg': {'precision': 0.3210839724860693, 'recall': 0.3470548006903245, 'f1-score': 0.2628675783131972, 'support': 237940}, 'weighted avg': {'precision': 0.3205159895252162, 'recall': 0.34073716062872994, 'f1-score': 0.258867550620631, 'support': 237940}}
[[57029    22 20270]
 [58709    13 22696]
 [55155    13 24033]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994068
{'0': {'precision': 0.34017954090137487, 'recall': 0.692355577689243, 'f1-score': 0.456207635591743, 'support': 32128}, '1': {'precision': 0.3333333333333333, 'recall': 0.00021743181959371313, 'f1-score': 0.0004345801645196337, 'support': 32194}, '2': {'precision': 0.36181874805356584, 'recall': 0.34996084101451896, 'f1-score': 0.355791021008146, 'support': 33198}, 'accuracy': 0.3473031173092699, 'macro avg': {'precision': 0.345110540762758, 'recall': 0.3475112835077852, 'f1-score': 0.27081107892146955, 'support': 97520}, 'weighted avg': {'precision': 0.34528589439391905, 'recall': 0.3473031173092699, 'f1-score': 0.27156050149237587, 'support': 97520}}
[[22244     6  9878]
 [21573     7 10614]
 [21572     8 11618]]
Evaluating performance on  val set...
114/114 - 1s - 811ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024982
{'0': {'precision': 0.3158932886236994, 'recall': 0.7314455355103905, 'f1-score': 0.4412301546302993, 'support': 8758}, '1': {'precision': 0.2857142857142857, 'recall': 0.0001977261492832427, 'f1-score': 0.00039517881841533294, 'support': 10115}, '2': {'precision': 0.3812990558525765, 'recall': 0.3284986279890239, 'f1-score': 0.3529349828902343, 'support': 10204}, 'accuracy': 0.33566048767066753, 'macro avg': {'precision': 0.3276355433968539, 'recall': 0.3533806298828992, 'f1-score': 0.2648534387796497, 'support': 29077}, 'weighted avg': {'precision': 0.3283478002436995, 'recall': 0.33566048767066753, 'f1-score': 0.25689168392242606, 'support': 29077}}
[[6406    2 2350]
 [7024    2 3089]
 [6849    3 3352]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1065/1065 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044202
{'0': {'precision': 0.29943910300864923, 'recall': 0.6744770188198246, 'f1-score': 0.4147478186030607, 'support': 80022}, '1': {'precision': 0.16666666666666666, 'recall': 3.196147576787445e-05, 'f1-score': 6.391069545488437e-05, 'support': 93863}, '2': {'precision': 0.38145034441611975, 'recall': 0.35675949880789326, 'f1-score': 0.3686920052424639, 'support': 98565}, 'accuracy': 0.3271792989539365, 'macro avg': {'precision': 0.2825187046971452, 'recall': 0.34375615970116186, 'f1-score': 0.2611679115136598, 'support': 272450}, 'weighted avg': {'precision': 0.2833664981892689, 'recall': 0.3271792989539365, 'f1-score': 0.2552214214959995, 'support': 272450}}
[[53973     7 26042]
 [62881     3 30979]
 [63393     8 35164]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978006
{'0': {'precision': 0.35108099856060715, 'recall': 0.6916731116267079, 'f1-score': 0.46575368888031626, 'support': 34911}, '1': {'precision': 0.6470588235294118, 'recall': 0.0006480690488113825, 'f1-score': 0.0012948412348076867, 'support': 33947}, '2': {'precision': 0.35737307430734205, 'recall': 0.3578492331379167, 'f1-score': 0.35761099522139866, 'support': 33774}, 'accuracy': 0.35325239691324345, 'macro avg': {'precision': 0.4518376321324537, 'recall': 0.3500568046044787, 'f1-score': 0.2748865084455075, 'support': 102632}, 'weighted avg': {'precision': 0.4510504797213195, 'recall': 0.35325239691324345, 'f1-score': 0.27653983904149054, 'support': 102632}}
[[24147     7 10757]
 [22949    22 10976]
 [21683     5 12086]]
Evaluating performance on  val set...
123/123 - 1s - 828ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972699
{'0': {'precision': 0.32780599025805784, 'recall': 0.6678631756756757, 'f1-score': 0.4397636426833507, 'support': 9472}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9970}, '2': {'precision': 0.42083919556401556, 'recall': 0.4259150682636737, 'f1-score': 0.4233619182416119, 'support': 11939}, 'accuracy': 0.3636276727956407, 'macro avg': {'precision': 0.24954839527402448, 'recall': 0.3645927479797831, 'f1-score': 0.2877085203083209, 'support': 31381}, 'weighted avg': {'precision': 0.2590541249661612, 'recall': 0.3636276727956407, 'f1-score': 0.2938070541213888, 'support': 31381}}
[[6326    0 3146]
 [6118    0 3852]
 [6854    0 5085]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
1646/1646 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1099633
{'0': {'precision': 0.27239481579965347, 'recall': 0.7472178627478956, 'f1-score': 0.3992462556965584, 'support': 112144}, '1': {'precision': 0.49635036496350365, 'recall': 0.0003791109847407829, 'f1-score': 0.0007576432837151261, 'support': 179367}, '2': {'precision': 0.3314951196307129, 'recall': 0.2899768049380052, 'f1-score': 0.3093491172904207, 'support': 129769}, 'accuracy': 0.2883925180402583, 'macro avg': {'precision': 0.3667467667979567, 'recall': 0.3458579262235472, 'f1-score': 0.23645100542356476, 'support': 421280}, 'weighted avg': {'precision': 0.38595259759495604, 'recall': 0.2883925180402583, 'f1-score': 0.2018916015556532, 'support': 421280}}
[[ 83796     31  28317]
 [131730     68  47569]
 [ 92101     38  37630]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994879
{'0': {'precision': 0.34351871657754013, 'recall': 0.7088252819279236, 'f1-score': 0.4627664555913351, 'support': 45313}, '1': {'precision': 0.4857142857142857, 'recall': 0.00038228878544604105, 'f1-score': 0.0007639762717957936, 'support': 44469}, '2': {'precision': 0.3507938827196571, 'recall': 0.32141821183925745, 'f1-score': 0.3354641888194129, 'support': 44817}, 'accuracy': 0.34577522864211474, 'macro avg': {'precision': 0.39334229500382767, 'recall': 0.34354192751754237, 'f1-score': 0.2663315402275146, 'support': 134599}, 'weighted avg': {'precision': 0.3929198702631782, 'recall': 0.3457752286421148, 'f1-score': 0.2677420204708823, 'support': 134599}}
[[32119     8 13186]
 [30979    17 13473]
 [30402    10 14405]]
Evaluating performance on  val set...
146/146 - 1s - 910ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103359
{'0': {'precision': 0.31351647920993847, 'recall': 0.7062770371678291, 'f1-score': 0.43426338074041904, 'support': 11327}, '1': {'precision': 0.13333333333333333, 'recall': 0.00014793993638582736, 'f1-score': 0.00029555194325402693, 'support': 13519}, '2': {'precision': 0.35404673213681004, 'recall': 0.33461353816610656, 'f1-score': 0.3440559440559441, 'support': 12498}, 'accuracy': 0.32626392459297343, 'macro avg': {'precision': 0.2669655148933606, 'recall': 0.3470128384234405, 'f1-score': 0.25953829224653907, 'support': 37344}, 'weighted avg': {'precision': 0.26185225341661733, 'recall': 0.32626392459297343, 'f1-score': 0.24697161710525833, 'support': 37344}}
[[8000    6 3321]
 [9208    2 4309]
 [8309    7 4182]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/EXC
Evaluating performance on  test set...
5928/5928 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0881
{'0': {'precision': 0.4051499892609121, 'recall': 0.7273701010057733, 'f1-score': 0.520421652814659, 'support': 560166}, '1': {'precision': 0.3615604186489058, 'recall': 0.0008500529046084052, 'f1-score': 0.001696118121236738, 'support': 447031}, '2': {'precision': 0.40089068112636905, 'recall': 0.40126300279600524, 'f1-score': 0.4010767555541629, 'support': 510371}, 'accuracy': 0.4036860292257085, 'macro avg': {'precision': 0.38920036301206234, 'recall': 0.37649438556879566, 'f1-score': 0.30773150883001954, 'support': 1517568}, 'weighted avg': {'precision': 0.3908773394078639, 'recall': 0.4036860292257085, 'f1-score': 0.327483630229001, 'support': 1517568}}
[[407448    316 152402]
 [293001    380 153650]
 [305223    355 204793]]
Evaluating performance on  train set...
1254/1254 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969278
{'0': {'precision': 0.35198266794051514, 'recall': 0.6912769485903815, 'f1-score': 0.4664562891060873, 'support': 105525}, '1': {'precision': 0.3958333333333333, 'recall': 0.0003586631303740479, 'f1-score': 0.0007166768824555613, 'support': 105949}, '2': {'precision': 0.373345419981694, 'recall': 0.38743469842545575, 'f1-score': 0.38025959590526903, 'support': 109492}, 'accuracy': 0.35955833328140674, 'macro avg': {'precision': 0.3737204737518474, 'recall': 0.35969010338207036, 'f1-score': 0.28247752063127063, 'support': 320966}, 'weighted avg': {'precision': 0.37374504960772115, 'recall': 0.35955833328140674, 'f1-score': 0.2833138549933602, 'support': 320966}}
[[72947    30 32548]
 [67256    38 38655]
 [67043    28 42421]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958993
{'0': {'precision': 0.3599236746012135, 'recall': 0.6994717746238395, 'f1-score': 0.4752832411855342, 'support': 37484}, '1': {'precision': 0.23076923076923078, 'recall': 9.148572822639669e-05, 'f1-score': 0.00018289894833104712, 'support': 32792}, '2': {'precision': 0.38223481514084506, 'recall': 0.356876846025427, 'f1-score': 0.36912083095355114, 'support': 38935}, 'accuracy': 0.36733479228282867, 'macro avg': {'precision': 0.3243092401704298, 'recall': 0.35214670212583093, 'f1-score': 0.28152899036247214, 'support': 109211}, 'weighted avg': {'precision': 0.3290975832255479, 'recall': 0.36733479228282867, 'f1-score': 0.2947801429168193, 'support': 109211}}
[[26219     3 11262]
 [21594     3 11195]
 [25033     7 13895]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/AAL
Evaluating performance on  test set...
5331/5331 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100557
{'0': {'precision': 0.3304732053056197, 'recall': 0.7322973745136829, 'f1-score': 0.4554222052958474, 'support': 439271}, '1': {'precision': 0.3813813813813814, 'recall': 0.0002658249574052135, 'f1-score': 0.0005312796099487335, 'support': 477758}, '2': {'precision': 0.34670043618967217, 'recall': 0.30278927189368415, 'f1-score': 0.32326046535481245, 'support': 447572}, 'accuracy': 0.33513385964102327, 'macro avg': {'precision': 0.35285167429222436, 'recall': 0.3451174904549241, 'f1-score': 0.2597379834202029, 'support': 1364601}, 'weighted avg': {'precision': 0.3536189032545739, 'recall': 0.33513385964102327, 'f1-score': 0.25281377019816503, 'support': 1364601}}
[[321677    117 117477]
 [339743    127 137888]
 [311963     89 135520]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977094
{'0': {'precision': 0.35391352938883186, 'recall': 0.7648796818477992, 'f1-score': 0.4839165362137805, 'support': 178028}, '1': {'precision': 0.36082474226804123, 'recall': 0.0002092800765367137, 'f1-score': 0.000418317526906781, 'support': 167240}, '2': {'precision': 0.35264989498535926, 'recall': 0.2705566859952247, 'f1-score': 0.30619633943427615, 'support': 170042}, 'accuracy': 0.3535949234441404, 'macro avg': {'precision': 0.35579605554741073, 'recall': 0.3452152159731869, 'f1-score': 0.2635103977249878, 'support': 515310}, 'weighted avg': {'precision': 0.35573953765702715, 'recall': 0.3535949234441404, 'f1-score': 0.2683566988460344, 'support': 515310}}
[[136170     30  41828]
 [124581     35  42624]
 [124004     32  46006]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0968714
{'0': {'precision': 0.3534694562072869, 'recall': 0.6977818242012912, 'f1-score': 0.46923997439679405, 'support': 60410}, '1': {'precision': 0.36, 'recall': 0.0003232758620689655, 'f1-score': 0.0006459716490220707, 'support': 55680}, '2': {'precision': 0.3721001637554585, 'recall': 0.35275473406749785, 'f1-score': 0.36216929679652676, 'support': 61839}, 'accuracy': 0.35960973197174156, 'macro avg': {'precision': 0.3618565399875819, 'recall': 0.35028661137695266, 'f1-score': 0.2773517476141143, 'support': 177929}, 'weighted avg': {'precision': 0.36198816312099774, 'recall': 0.35960973197174156, 'f1-score': 0.2853887882207414, 'support': 177929}}
[[42153    19 18238]
 [37090    18 18572]
 [40012    13 21814]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/WBA
Evaluating performance on  test set...
4192/4192 - 24s - 24s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048093
{'0': {'precision': 0.29985686897602226, 'recall': 0.7361974859677799, 'f1-score': 0.42614342005693656, 'support': 310179}, '1': {'precision': 0.45382585751978893, 'recall': 0.00039989398159557697, 'f1-score': 0.000799083841084524, 'support': 430114}, '2': {'precision': 0.34143034322325255, 'recall': 0.31924699265739725, 'f1-score': 0.32996624632420296, 'support': 332852}, 'accuracy': 0.31196809378043044, 'macro avg': {'precision': 0.3650376899063546, 'recall': 0.3519481242022576, 'f1-score': 0.25230291674074135, 'support': 1073145}, 'weighted avg': {'precision': 0.3744619145091541, 'recall': 0.31196809378043044, 'f1-score': 0.2258356159312752, 'support': 1073145}}
[[228353    103  81723]
 [306701    172 123241]
 [226486    104 106262]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981163
{'0': {'precision': 0.34823458304766713, 'recall': 0.7316275764036958, 'f1-score': 0.4718713805927959, 'support': 105525}, '1': {'precision': 0.42424242424242425, 'recall': 0.0002624622710485368, 'f1-score': 0.0005245999925057144, 'support': 106682}, '2': {'precision': 0.356047992953586, 'recall': 0.3228813559322034, 'f1-score': 0.33865455641432995, 'support': 102660}, 'accuracy': 0.35056071293593805, 'macro avg': {'precision': 0.3761750000812258, 'recall': 0.35159046486898254, 'f1-score': 0.2703501789998772, 'support': 314867}, 'weighted avg': {'precision': 0.3765347643155698, 'recall': 0.35056071293593805, 'f1-score': 0.26873717974557637, 'support': 314867}}
[[77205    23 28297]
 [75001    28 31653]
 [69498    15 33147]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005611
{'0': {'precision': 0.3281460421966183, 'recall': 0.7417440501814156, 'f1-score': 0.4550007073136229, 'support': 32522}, '1': {'precision': 0.5454545454545454, 'recall': 0.00016777585146244618, 'f1-score': 0.0003354485226287983, 'support': 35762}, '2': {'precision': 0.36199993036454164, 'recall': 0.30614528429669324, 'f1-score': 0.331737979005137, 'support': 33961}, 'accuracy': 0.33767910411267055, 'macro avg': {'precision': 0.41186683933856844, 'recall': 0.3493523701098571, 'f1-score': 0.2623580449471296, 'support': 102245}, 'weighted avg': {'precision': 0.4153982167731827, 'recall': 0.33767910411267055, 'f1-score': 0.2550313738404162, 'support': 102245}}
[[24123     3  8396]
 [25828     6  9928]
 [23562     2 10397]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
6143/6143 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107095
{'0': {'precision': 0.2920618510360948, 'recall': 0.7123263892854125, 'f1-score': 0.4142688164687396, 'support': 437833}, '1': {'precision': 0.4703196347031963, 'recall': 0.00045525264311728725, 'f1-score': 0.0009096248018475099, 'support': 678744}, '2': {'precision': 0.3212086097971364, 'recall': 0.3550710650991402, 'f1-score': 0.33729206253958727, 'support': 455920}, 'accuracy': 0.3014778406572477, 'macro avg': {'precision': 0.3611966985121425, 'recall': 0.35595090234255666, 'f1-score': 0.25082350127005815, 'support': 1572497}, 'weighted avg': {'precision': 0.3774546952651631, 'recall': 0.3014778406572477, 'f1-score': 0.21353055570249832, 'support': 1572497}}
[[311880    136 125817]
 [462152    309 216283]
 [293824    212 161884]]
Evaluating performance on  train set...
2083/2083 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989728
{'0': {'precision': 0.3438525492787138, 'recall': 0.7049902069798551, 'f1-score': 0.46224789834328567, 'support': 177167}, '1': {'precision': 0.32934131736526945, 'recall': 0.00030775773311249386, 'f1-score': 0.0006149408259214329, 'support': 178712}, '2': {'precision': 0.35748399672573306, 'recall': 0.3423087116619769, 'f1-score': 0.34973181312761775, 'support': 177337}, 'accuracy': 0.3481891016023525, 'macro avg': {'precision': 0.3435592877899054, 'recall': 0.34920222545831486, 'f1-score': 0.2708648840989416, 'support': 533216}, 'weighted avg': {'precision': 0.3435225305212058, 'recall': 0.3481891016023525, 'f1-score': 0.27010697588834415, 'support': 533216}}
[[124901     53  52213]
 [121765     55  56892]
 [116574     59  60704]]
Evaluating performance on  val set...
685/685 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995407
{'0': {'precision': 0.3366884831415724, 'recall': 0.7348164705060595, 'f1-score': 0.46178833238224837, 'support': 57266}, '1': {'precision': 0.4166666666666667, 'recall': 0.00026216442953020134, 'f1-score': 0.0005239991616013415, 'support': 57216}, '2': {'precision': 0.3659256305453095, 'recall': 0.3024006854393567, 'f1-score': 0.33114410984609277, 'support': 60691}, 'accuracy': 0.34507601057240556, 'macro avg': {'precision': 0.3730935934511829, 'recall': 0.34582644012498215, 'f1-score': 0.26448548046331416, 'support': 175173}, 'weighted avg': {'precision': 0.3729410075697206, 'recall': 0.34507601057240556, 'f1-score': 0.2658641397298741, 'support': 175173}}
[[42080     8 15178]
 [40577    15 16624]
 [42325    13 18353]]
testing model on single stock: results/universal/W7/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
23942/23942 - 129s - 129s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1079924
{'0': {'precision': 0.29395123845905213, 'recall': 0.7368305891053338, 'f1-score': 0.42024851119816, 'support': 1768682}, '1': {'precision': 0.4, 'recall': 8.056719303899453e-05, 'f1-score': 0.00016110193725079545, 'support': 2606520}, '2': {'precision': 0.2975427132980666, 'recall': 0.2875713356334068, 'f1-score': 0.29247205951513183, 'support': 1753857}, 'accuracy': 0.29495359728140974, 'macro avg': {'precision': 0.33049798391903956, 'recall': 0.3414941639772599, 'f1-score': 0.23762722421684754, 'support': 6129059}, 'weighted avg': {'precision': 0.3400785723970091, 'recall': 0.29495359728140974, 'f1-score': 0.20503311545695638, 'support': 6129059}}
[[1303219     138  465325]
 [1880913     210  725397]
 [1249321     177  504359]]
Evaluating performance on  train set...
9052/9052 - 51s - 51s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996643
{'0': {'precision': 0.3398534048555701, 'recall': 0.7957081700675163, 'f1-score': 0.4762826373147696, 'support': 772258}, '1': {'precision': 0.36519607843137253, 'recall': 0.0001916450476475892, 'f1-score': 0.00038308906049336214, 'support': 777479}, '2': {'precision': 0.3482532085629846, 'recall': 0.23080742460001485, 'f1-score': 0.2776200679989529, 'support': 767341}, 'accuracy': 0.3417014878221622, 'macro avg': {'precision': 0.351100897283309, 'recall': 0.34223574657172623, 'f1-score': 0.2514285981247386, 'support': 2317078}, 'weighted avg': {'precision': 0.3511387005105685, 'recall': 0.3417014878221622, 'f1-score': 0.25080734495147644, 'support': 2317078}}
[[614492    112 157654]
 [603531    149 173799]
 [590086    147 177108]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020123
{'0': {'precision': 0.32070514202604083, 'recall': 0.786683040956641, 'f1-score': 0.45565466609900207, 'support': 223114}, '1': {'precision': 0.34782608695652173, 'recall': 0.00012971798499325062, 'f1-score': 0.000259339252211475, 'support': 246689}, '2': {'precision': 0.353396528437797, 'recall': 0.2379595050334511, 'f1-score': 0.2844109410500731, 'support': 237511}, 'accuracy': 0.3281003910568715, 'macro avg': {'precision': 0.3406425858067865, 'recall': 0.3415907546583618, 'f1-score': 0.24677498213376223, 'support': 707314}, 'weighted avg': {'precision': 0.3411416138928468, 'recall': 0.3281003910568715, 'f1-score': 0.23932459746667742, 'support': 707314}}
[[175520     24  47570]
 [190817     32  55840]
 [180957     36  56518]]
training model: results/universal/W7/deepOF_L1/h1000
Epoch 1/50
12475/12475 - 182s - loss: 3.2856 - accuracy1000: 0.3628 - val_loss: 3.3127 - val_accuracy1000: 0.3197 - 182s/epoch - 15ms/step
Epoch 2/50
12475/12475 - 176s - loss: 3.2825 - accuracy1000: 0.3648 - val_loss: 3.3183 - val_accuracy1000: 0.3202 - 176s/epoch - 14ms/step
Epoch 3/50
12475/12475 - 178s - loss: 3.2812 - accuracy1000: 0.3672 - val_loss: 3.3217 - val_accuracy1000: 0.3189 - 178s/epoch - 14ms/step
Epoch 4/50
12475/12475 - 180s - loss: 3.2799 - accuracy1000: 0.3690 - val_loss: 3.3214 - val_accuracy1000: 0.3195 - 180s/epoch - 14ms/step
Epoch 5/50
12475/12475 - 180s - loss: 3.2786 - accuracy1000: 0.3705 - val_loss: 3.3207 - val_accuracy1000: 0.3192 - 180s/epoch - 14ms/step
Epoch 6/50
12475/12475 - 178s - loss: 3.2776 - accuracy1000: 0.3721 - val_loss: 3.3232 - val_accuracy1000: 0.3195 - 178s/epoch - 14ms/step
Epoch 7/50
12475/12475 - 179s - loss: 3.2764 - accuracy1000: 0.3735 - val_loss: 3.3238 - val_accuracy1000: 0.3189 - 179s/epoch - 14ms/step
Epoch 8/50
12475/12475 - 179s - loss: 3.2755 - accuracy1000: 0.3743 - val_loss: 3.3249 - val_accuracy1000: 0.3189 - 179s/epoch - 14ms/step
Epoch 9/50
12475/12475 - 181s - loss: 3.2745 - accuracy1000: 0.3744 - val_loss: 3.3308 - val_accuracy1000: 0.3192 - 181s/epoch - 14ms/step
Epoch 10/50
12475/12475 - 178s - loss: 3.2745 - accuracy1000: 0.3748 - val_loss: 3.3334 - val_accuracy1000: 0.3198 - 178s/epoch - 14ms/step
Epoch 11/50
12475/12475 - 179s - loss: 3.2738 - accuracy1000: 0.3752 - val_loss: 3.3356 - val_accuracy1000: 0.3199 - 179s/epoch - 14ms/step
testing model in sample: results/universal/W7/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 202s - 202s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1029514
{'0': {'precision': 0.3199925956376554, 'recall': 0.9544122491468027, 'f1-score': 0.479290163032159, 'support': 3035640}, '1': {'precision': 0.3118793674144906, 'recall': 0.0004897740888137157, 'f1-score': 0.0009780123110759605, 'support': 3462821}, '2': {'precision': 0.3547166173005043, 'recall': 0.052608738160464984, 'f1-score': 0.0916279499448752, 'support': 3007086}, 'accuracy': 0.3216171568032855, 'macro avg': {'precision': 0.3288628601175501, 'recall': 0.33583692046536046, 'f1-score': 0.1906320417627034, 'support': 9505547}, 'weighted avg': {'precision': 0.32802195600345885, 'recall': 0.3216171568032855, 'f1-score': 0.1824063567897703, 'support': 9505547}}
[[2897252    1937  136451]
 [3309788    1696  151337]
 [2847082    1805  158199]]
Evaluating performance on  train set...
12475/12475 - 64s - 64s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999166
{'0': {'precision': 0.33929149503903083, 'recall': 0.9643219823879977, 'f1-score': 0.5019681873022679, 'support': 1079264}, '1': {'precision': 0.3427652733118971, 'recall': 0.000507652891145124, 'f1-score': 0.0010138042863188728, 'support': 1049930}, '2': {'precision': 0.35207691935717855, 'recall': 0.04106180749029029, 'f1-score': 0.07354612352920378, 'support': 1063884}, 'accuracy': 0.3397900082616209, 'macro avg': {'precision': 0.34471122923603553, 'recall': 0.335297147589811, 'f1-score': 0.19217603837259686, 'support': 3193078}, 'weighted avg': {'precision': 0.344693628149252, 'recall': 0.3397900082616209, 'f1-score': 0.19450359850892243, 'support': 3193078}}
[[1040758     496   38010]
 [1007014     533   42383]
 [1019673     526   43685]]
Evaluating performance on  val set...
3866/3866 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030426
{'0': {'precision': 0.3178597448758281, 'recall': 0.9634233124527315, 'f1-score': 0.4780106730547721, 'support': 313369}, '1': {'precision': 0.3932853717026379, 'recall': 0.0004901902177161918, 'f1-score': 0.0009791600120603854, 'support': 334564}, '2': {'precision': 0.36510828286975266, 'recall': 0.041694504026161254, 'f1-score': 0.0748422049232064, 'support': 341268}, 'accuracy': 0.3197530127850659, 'macro avg': {'precision': 0.3587511331494062, 'recall': 0.3352026688988696, 'f1-score': 0.18461067933001296, 'support': 989201}, 'weighted avg': {'precision': 0.3596703713084696, 'recall': 0.3197530127850659, 'f1-score': 0.17758025708072336, 'support': 989201}}
[[301907    122  11340]
 [320997    164  13403]
 [326908    131  14229]]
testing model out of sample: results/universal/W7/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 82s - 82s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1103634
{'0': {'precision': 0.27871834790556427, 'recall': 0.9427613062494148, 'f1-score': 0.430240279243799, 'support': 1046722}, '1': {'precision': 0.4759324195090851, 'recall': 0.0009324978951655012, 'f1-score': 0.0018613488358466114, 'support': 1601076}, '2': {'precision': 0.31854139199222814, 'recall': 0.06520370832330911, 'f1-score': 0.10824935612355058, 'support': 1126439}, 'accuracy': 0.28131513733769237, 'macro avg': {'precision': 0.35773071980229254, 'recall': 0.3362991708226298, 'f1-score': 0.1801169947343987, 'support': 3774237}, 'weighted avg': {'precision': 0.3742642680119636, 'recall': 0.28131513733769237, 'f1-score': 0.15241714364566558, 'support': 3774237}}
[[ 986809     798   59115]
 [1501570    1493   98013]
 [1052145     846   73448]]
Evaluating performance on  train set...
5285/5285 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997429
{'0': {'precision': 0.3405441617041145, 'recall': 0.9497259620723669, 'f1-score': 0.501327009968954, 'support': 459243}, '1': {'precision': 0.35490196078431374, 'recall': 0.0008110881576647831, 'f1-score': 0.0016184774687370064, 'support': 446314}, '2': {'precision': 0.35306237651707595, 'recall': 0.055958414787443914, 'f1-score': 0.09660541141672234, 'support': 447082}, 'accuracy': 0.34121077390197974, 'macro avg': {'precision': 0.34950283300183477, 'recall': 0.3354984883391585, 'f1-score': 0.19985029961813774, 'support': 1352639}, 'weighted avg': {'precision': 0.34941922390007996, 'recall': 0.34121077390197974, 'f1-score': 0.2026732999264144, 'support': 1352639}}
[[436155    318  22770]
 [422880    362  23072]
 [421724    340  25018]]
Evaluating performance on  val set...
1714/1714 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002955
{'0': {'precision': 0.33189321328298965, 'recall': 0.9467016465877317, 'f1-score': 0.4914830512271396, 'support': 144845}, '1': {'precision': 0.30254777070063693, 'recall': 0.0006980469381456934, 'f1-score': 0.0013928801829804704, 'support': 136094}, '2': {'precision': 0.38290507798183815, 'recall': 0.059856644514042726, 'f1-score': 0.10352933404532919, 'support': 157092}, 'accuracy': 0.3347320166837507, 'macro avg': {'precision': 0.3391153539884882, 'recall': 0.3357521126799734, 'f1-score': 0.19880175515181642, 'support': 438031}, 'weighted avg': {'precision': 0.341070228577498, 'recall': 0.3347320166837507, 'f1-score': 0.20008185570077558, 'support': 438031}}
[[137125    100   7620]
 [128465     95   7534]
 [147570    119   9403]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
695/695 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1084245
{'0': {'precision': 0.28431712962962963, 'recall': 0.9750917931924183, 'f1-score': 0.4402625624481932, 'support': 50385}, '1': {'precision': 0.3515151515151515, 'recall': 0.0016807696765967313, 'f1-score': 0.0033455426412482333, 'support': 69016}, '2': {'precision': 0.3675088745040718, 'recall': 0.03007621586520387, 'f1-score': 0.05560206612222977, 'support': 58518}, 'accuracy': 0.2866810177665117, 'macro avg': {'precision': 0.334447051882951, 'recall': 0.33561625957807295, 'f1-score': 0.1664033904038904, 'support': 177919}, 'weighted avg': {'precision': 0.3377456741078123, 'recall': 0.2866810177665117, 'f1-score': 0.14426366428105625, 'support': 177919}}
[[49130    82  1173]
 [67044   116  1856]
 [56626   132  1760]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996461
{'0': {'precision': 0.34477046511962894, 'recall': 0.9669144380706148, 'f1-score': 0.508298204444822, 'support': 24754}, '1': {'precision': 0.2777777777777778, 'recall': 0.0012123661345726409, 'f1-score': 0.0024141954693598358, 'support': 24745}, '2': {'precision': 0.33617539585870887, 'recall': 0.03680817959546566, 'f1-score': 0.06635147047039025, 'support': 22495}, 'accuracy': 0.3443759202155735, 'macro avg': {'precision': 0.3195745462520385, 'recall': 0.33497832793355103, 'f1-score': 0.19235462346152402, 'support': 71994}, 'weighted avg': {'precision': 0.31905887621918577, 'recall': 0.3443759202155735, 'f1-score': 0.19633204639203078, 'support': 71994}}
[[23935    46   773]
 [23853    30   862]
 [21635    32   828]]
Evaluating performance on  val set...
73/73 - 1s - 608ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049626
{'0': {'precision': 0.3071432585848367, 'recall': 0.9575959348168915, 'f1-score': 0.46510638297872336, 'support': 5707}, '1': {'precision': 0.38571428571428573, 'recall': 0.004069329314242653, 'f1-score': 0.008053691275167786, 'support': 6635}, '2': {'precision': 0.3612403100775194, 'recall': 0.037787868958806356, 'f1-score': 0.06841873440023491, 'support': 6166}, 'accuracy': 0.3093256969958937, 'macro avg': {'precision': 0.35136595145888067, 'recall': 0.3331510443633135, 'f1-score': 0.18052626955137538, 'support': 18508}, 'weighted avg': {'precision': 0.35333307836589223, 'recall': 0.3093256969958937, 'f1-score': 0.1690981351622088, 'support': 18508}}
[[5465   26  216]
 [6412   27  196]
 [5916   17  233]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
2006/2006 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0897135
{'0': {'precision': 0.39776793788267045, 'recall': 0.9632403598212704, 'f1-score': 0.5630327636618329, 'support': 203212}, '1': {'precision': 0.27342549923195086, 'recall': 0.0015439996530337858, 'f1-score': 0.0030706596743030634, 'support': 115285}, '2': {'precision': 0.3900257619209644, 'recall': 0.04118504527070031, 'f1-score': 0.07450290388624008, 'support': 194828}, 'accuracy': 0.39729995616811964, 'macro avg': {'precision': 0.3537397330118619, 'recall': 0.3353231349150015, 'f1-score': 0.21353544240745867, 'support': 513325}, 'weighted avg': {'precision': 0.3669040393814958, 'recall': 0.39729995616811964, 'f1-score': 0.25185655623269626, 'support': 513325}}
[[195742    195   7275]
 [109833    178   5274]
 [186526    278   8024]]
Evaluating performance on  train set...
538/538 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0951736
{'0': {'precision': 0.3681659690517248, 'recall': 0.9642473439178704, 'f1-score': 0.5328722766779731, 'support': 50262}, '1': {'precision': 0.4788732394366197, 'recall': 0.0023993789842628966, 'f1-score': 0.004774833817058327, 'support': 42511}, '2': {'precision': 0.35104698222769665, 'recall': 0.04456905410839551, 'f1-score': 0.07909604519774012, 'support': 44762}, 'accuracy': 0.3676300578034682, 'macro avg': {'precision': 0.3993620635720137, 'recall': 0.33707192567017624, 'f1-score': 0.20558105189759054, 'support': 137535}, 'weighted avg': {'precision': 0.39681319836146506, 'recall': 0.3676300578034682, 'f1-score': 0.2219559130834078, 'support': 137535}}
[[48465    51  1746]
 [40467   102  1942]
 [42707    60  1995]]
Evaluating performance on  val set...
153/153 - 1s - 986ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011574
{'0': {'precision': 0.3296844816484224, 'recall': 0.961577588230691, 'f1-score': 0.49101916045633454, 'support': 12779}, '1': {'precision': 0.2638888888888889, 'recall': 0.0014597418561770128, 'f1-score': 0.002903422982885085, 'support': 13016}, '2': {'precision': 0.3335287221570926, 'recall': 0.042927197284043754, 'f1-score': 0.07606443419557515, 'support': 13255}, 'accuracy': 0.3297311139564661, 'macro avg': {'precision': 0.30903403089813464, 'recall': 0.33532150912363723, 'f1-score': 0.18999567254493158, 'support': 39050}, 'weighted avg': {'precision': 0.30905861666978823, 'recall': 0.3297311139564661, 'f1-score': 0.18747141818896493, 'support': 39050}}
[[12288    21   470]
 [12330    19   667]
 [12654    32   569]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
930/930 - 6s - 6s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031127
{'0': {'precision': 0.32313047493462266, 'recall': 0.9492871770122738, 'f1-score': 0.48214297544203677, 'support': 76667}, '1': {'precision': 0.3116883116883117, 'recall': 0.00028962421258417204, 'f1-score': 0.0005787106808290032, 'support': 82866}, '2': {'precision': 0.34887587080430654, 'recall': 0.05620671623707067, 'f1-score': 0.09681565043552764, 'support': 78407}, 'accuracy': 0.3244935698075145, 'macro avg': {'precision': 0.3278982191424136, 'recall': 0.3352611724873096, 'f1-score': 0.19317911218613112, 'support': 237940}, 'weighted avg': {'precision': 0.32762931058388506, 'recall': 0.3244935698075145, 'f1-score': 0.1874566514297328, 'support': 237940}}
[[72779    24  3864]
 [78481    24  4361]
 [73971    29  4407]]
Evaluating performance on  train set...
381/381 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100971
{'0': {'precision': 0.33161945344261584, 'recall': 0.9506107441106818, 'f1-score': 0.4917073642473769, 'support': 32092}, '1': {'precision': 0.5555555555555556, 'recall': 0.0007761323771382447, 'f1-score': 0.0015500992063492065, 'support': 32211}, '2': {'precision': 0.3565042875387703, 'recall': 0.05882530029804016, 'f1-score': 0.10098713111788724, 'support': 33217}, 'accuracy': 0.3331214109926169, 'macro avg': {'precision': 0.4145597655123139, 'recall': 0.3367373922619534, 'f1-score': 0.1980815315238711, 'support': 97520}, 'weighted avg': {'precision': 0.4140620838705472, 'recall': 0.3331214109926169, 'f1-score': 0.19672162134234408, 'support': 97520}}
[[30507    10  1575]
 [30234    25  1952]
 [31253    10  1954]]
Evaluating performance on  val set...
114/114 - 1s - 810ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043496
{'0': {'precision': 0.3054393305439331, 'recall': 0.9621633905238041, 'f1-score': 0.46368240930869264, 'support': 8801}, '1': {'precision': 0.2, 'recall': 0.00010526315789473685, 'f1-score': 0.00021041557075223569, 'support': 9500}, '2': {'precision': 0.3835311572700297, 'recall': 0.04797698589458055, 'f1-score': 0.08528538436159683, 'support': 10776}, 'accuracy': 0.3090415104721945, 'macro avg': {'precision': 0.2963234959379876, 'recall': 0.33674854652542646, 'f1-score': 0.18305940308034727, 'support': 29077}, 'weighted avg': {'precision': 0.29993133056570465, 'recall': 0.3090415104721945, 'f1-score': 0.1720226685740798, 'support': 29077}}
[[ 8468     1   332]
 [ 9000     1   499]
 [10256     3   517]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1065/1065 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.108663
{'0': {'precision': 0.2819947831679748, 'recall': 0.9319180760197856, 'f1-score': 0.4329734771132663, 'support': 76217}, '1': {'precision': 0.21428571428571427, 'recall': 6.292210243718276e-05, 'f1-score': 0.00012580726327266625, 'support': 95356}, '2': {'precision': 0.4036018495984424, 'recall': 0.08219911377221766, 'f1-score': 0.13658150911696398, 'support': 100877}, 'accuracy': 0.29115801064415486, 'macro avg': {'precision': 0.2999607823507105, 'recall': 0.3380600372981468, 'f1-score': 0.18989359783116763, 'support': 272450}, 'weighted avg': {'precision': 0.30332306383587515, 'recall': 0.29115801064415486, 'f1-score': 0.17173745229484463, 'support': 272450}}
[[71028    14  5175]
 [88272     6  7078]
 [92577     8  8292]]
Evaluating performance on  train set...
401/401 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981717
{'0': {'precision': 0.350952894642215, 'recall': 0.9277307165422572, 'f1-score': 0.5092577672398578, 'support': 35769}, '1': {'precision': 0.3418803418803419, 'recall': 0.0011809163911195087, 'f1-score': 0.0023537026685104007, 'support': 33872}, '2': {'precision': 0.358372063811079, 'recall': 0.08647813039919978, 'f1-score': 0.1393338542684118, 'support': 32991}, 'accuracy': 0.3515180450541741, 'macro avg': {'precision': 0.35040176677787865, 'recall': 0.3384632544441922, 'f1-score': 0.21698177472559335, 'support': 102632}, 'weighted avg': {'precision': 0.35034353599091556, 'recall': 0.3515180450541741, 'f1-score': 0.2230505970784885, 'support': 102632}}
[[33184    51  2534]
 [31258    40  2574]
 [30112    26  2853]]
Evaluating performance on  val set...
123/123 - 1s - 871ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006368
{'0': {'precision': 0.3158588627138049, 'recall': 0.9422479817843097, 'f1-score': 0.4731193971677276, 'support': 9662}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9481}, '2': {'precision': 0.43605788032850995, 'recall': 0.09110965844092173, 'f1-score': 0.1507265968232511, 'support': 12238}, 'accuracy': 0.3256429049424811, 'macro avg': {'precision': 0.2506389143474383, 'recall': 0.3444525467417438, 'f1-score': 0.20794866466365958, 'support': 31381}, 'weighted avg': {'precision': 0.2673052060482804, 'recall': 0.3256429049424811, 'f1-score': 0.20445083672787775, 'support': 31381}}
[[ 9104     0   558]
 [ 8597     0   884]
 [11122     1  1115]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
1646/1646 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1139476
{'0': {'precision': 0.25914634146341464, 'recall': 0.9603151256641724, 'f1-score': 0.40815090624230793, 'support': 108782}, '1': {'precision': 0.43, 'recall': 0.0004845561803450491, 'f1-score': 0.0009680215215947593, 'support': 177482}, '2': {'precision': 0.3289180765805877, 'recall': 0.0437725899152693, 'f1-score': 0.07726298174972546, 'support': 135016}, 'accuracy': 0.26220328522597797, 'macro avg': {'precision': 0.33935480601466744, 'recall': 0.3348574239199289, 'f1-score': 0.16212730317120938, 'support': 421280}, 'weighted avg': {'precision': 0.3534868029450195, 'recall': 0.26220328522597797, 'f1-score': 0.13056166213080933, 'support': 421280}}
[[104465     53   4264]
 [169602     86   7794]
 [129045     61   5910]]
Evaluating performance on  train set...
526/526 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009669
{'0': {'precision': 0.3361768611827201, 'recall': 0.9534718837240218, 'f1-score': 0.4970891281245668, 'support': 45134}, '1': {'precision': 0.4157303370786517, 'recall': 0.0008198355897276816, 'f1-score': 0.001636444051304732, 'support': 45131}, '2': {'precision': 0.3273846153846154, 'recall': 0.04799927820634276, 'f1-score': 0.08372349215092262, 'support': 44334}, 'accuracy': 0.3358048722501653, 'macro avg': {'precision': 0.35976393788199573, 'recall': 0.33409699917336405, 'f1-score': 0.19414968810893138, 'support': 134599}, 'weighted avg': {'precision': 0.35995513959077746, 'recall': 0.3358048722501653, 'f1-score': 0.19481030591811704, 'support': 134599}}
[[43034    28  2072]
 [42794    37  2300]
 [42182    24  2128]]
Evaluating performance on  val set...
146/146 - 1s - 960ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058866
{'0': {'precision': 0.297729588948024, 'recall': 0.9519370021723389, 'f1-score': 0.4535926852410938, 'support': 11048}, '1': {'precision': 0.25, 'recall': 0.00022299858767561138, 'f1-score': 0.00044559970293353134, 'support': 13453}, '2': {'precision': 0.3979083665338645, 'recall': 0.062212878610916456, 'f1-score': 0.10760218167126794, 'support': 12843}, 'accuracy': 0.3031008997429306, 'macro avg': {'precision': 0.3152126518272962, 'recall': 0.33812429312364367, 'f1-score': 0.18721348887176506, 'support': 37344}, 'weighted avg': {'precision': 0.31498777983323134, 'recall': 0.3031008997429306, 'f1-score': 0.17135875799462466, 'support': 37344}}
[[10517     1   530]
 [12771     3   679]
 [12036     8   799]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
5928/5928 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.083983
{'0': {'precision': 0.42335250190382706, 'recall': 0.9224099996056938, 'f1-score': 0.5803469492962624, 'support': 634025}, '1': {'precision': 0.26855600539811064, 'recall': 0.0025187083709082856, 'f1-score': 0.004990611255834658, 'support': 316035}, '2': {'precision': 0.4208791373821109, 'recall': 0.09876688962974971, 'f1-score': 0.15998938180406574, 'support': 567508}, 'accuracy': 0.42283311192645073, 'macro avg': {'precision': 0.37092921489468295, 'recall': 0.3412318658687839, 'f1-score': 0.24844231411872095, 'support': 1517568}, 'weighted avg': {'precision': 0.3901910455959884, 'recall': 0.42283311192645073, 'f1-score': 0.3033319999134551, 'support': 1517568}}
[[584831   1196  47998]
 [286112    796  29127]
 [510485    972  56051]]
Evaluating performance on  train set...
1254/1254 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004442
{'0': {'precision': 0.3337500607727516, 'recall': 0.907293771123237, 'f1-score': 0.4879913883275279, 'support': 105926}, '1': {'precision': 0.3054187192118227, 'recall': 0.0005826355802392565, 'f1-score': 0.001163052449913709, 'support': 106413}, '2': {'precision': 0.35613473555860387, 'recall': 0.10755152954606129, 'f1-score': 0.1652101363199276, 'support': 108627}, 'accuracy': 0.33602001458098363, 'macro avg': {'precision': 0.3317678385143927, 'recall': 0.33847597874984586, 'f1-score': 0.21812152569912305, 'support': 320966}, 'weighted avg': {'precision': 0.3319329119733138, 'recall': 0.33602001458098363, 'f1-score': 0.2173470747006199, 'support': 320966}}
[[96106    72  9748]
 [94977    62 11374]
 [96875    69 11683]]
Evaluating performance on  val set...
427/427 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014711
{'0': {'precision': 0.32817659473487565, 'recall': 0.9146918097382494, 'f1-score': 0.48304461240050833, 'support': 35530}, '1': {'precision': 0.509090909090909, 'recall': 0.0007793147596648946, 'f1-score': 0.0015562472209871055, 'support': 35929}, '2': {'precision': 0.36624864224350745, 'recall': 0.0982464505191778, 'f1-score': 0.15493222498381337, 'support': 37752}, 'accuracy': 0.3317980789480913, 'macro avg': {'precision': 0.401172048689764, 'recall': 0.33790585833903064, 'f1-score': 0.2131776948684363, 'support': 109211}, 'weighted avg': {'precision': 0.40085577849881693, 'recall': 0.3317980789480913, 'f1-score': 0.21121948194396012, 'support': 109211}}
[[32499    12  3019]
 [32502    28  3399]
 [34028    15  3709]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
5331/5331 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1171397
{'0': {'precision': 0.24192866868026103, 'recall': 0.9381001938825357, 'f1-score': 0.3846572540637649, 'support': 329581}, '1': {'precision': 0.5564581640942323, 'recall': 0.000997151204514984, 'f1-score': 0.0019907350898301047, 'support': 686957}, '2': {'precision': 0.2667174142171214, 'recall': 0.0654335565687821, 'f1-score': 0.1050863646116188, 'support': 348063}, 'accuracy': 0.2437635616564842, 'macro avg': {'precision': 0.35503474899720494, 'recall': 0.3348436338852776, 'f1-score': 0.16391145125507126, 'support': 1364601}, 'weighted avg': {'precision': 0.40658946236199783, 'recall': 0.2437635616564842, 'f1-score': 0.12070923821872326, 'support': 1364601}}
[[309180    296  20105]
 [643762    685  42510]
 [325038    250  22775]]
Evaluating performance on  train set...
2013/2013 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984865
{'0': {'precision': 0.34759340918134496, 'recall': 0.9559308785349376, 'f1-score': 0.5098106358935726, 'support': 179105}, '1': {'precision': 0.26443768996960487, 'recall': 0.0005196077260293608, 'f1-score': 0.001037177446755244, 'support': 167434}, '2': {'precision': 0.35937012089039566, 'recall': 0.04773331911288077, 'f1-score': 0.0842730715316861, 'support': 168771}, 'accuracy': 0.34805262851487456, 'macro avg': {'precision': 0.3238004066804485, 'recall': 0.3347279351246159, 'f1-score': 0.1983736282906713, 'support': 515310}, 'weighted avg': {'precision': 0.3244315701356243, 'recall': 0.34805262851487456, 'f1-score': 0.2051311701030691, 'support': 515310}}
[[171212    135   7758]
 [160744     87   6603]
 [160608    107   8056]]
Evaluating performance on  val set...
696/696 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0944058
{'0': {'precision': 0.36409810947434457, 'recall': 0.9368577903330954, 'f1-score': 0.524396177237185, 'support': 64426}, '1': {'precision': 0.3393939393939394, 'recall': 0.0012410522350021053, 'f1-score': 0.0024730612965907085, 'support': 45123}, '2': {'precision': 0.40083402835696413, 'recall': 0.07028370868675052, 'f1-score': 0.11959686450167974, 'support': 68380}, 'accuracy': 0.3665507028084236, 'macro avg': {'precision': 0.36810869240841604, 'recall': 0.33612751708494937, 'f1-score': 0.2154887010118185, 'support': 177929}, 'weighted avg': {'precision': 0.37195110626888284, 'recall': 0.3665507028084236, 'f1-score': 0.23646720688698192, 'support': 177929}}
[[60358    60  4008]
 [41891    56  3176]
 [63525    49  4806]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
4192/4192 - 23s - 23s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076181
{'0': {'precision': 0.29342382657120125, 'recall': 0.9421853097169934, 'f1-score': 0.4474871717877148, 'support': 313173}, '1': {'precision': 0.46335697399527187, 'recall': 0.0009425206657273519, 'f1-score': 0.0018812147272238647, 'support': 415906}, '2': {'precision': 0.3433934541747253, 'recall': 0.06656862346177768, 'f1-score': 0.1115187515976288, 'support': 344066}, 'accuracy': 0.2966635450009085, 'macro avg': {'precision': 0.36672475158039947, 'recall': 0.33656548461483277, 'f1-score': 0.18696237937085583, 'support': 1073145}, 'weighted avg': {'precision': 0.3753037826848575, 'recall': 0.2966635450009085, 'f1-score': 0.1670725944115702, 'support': 1073145}}
[[295067    235  17871]
 [389590    392  25924]
 [320943    219  22904]]
Evaluating performance on  train set...
1230/1230 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987481
{'0': {'precision': 0.3470603505530701, 'recall': 0.9470817693383381, 'f1-score': 0.5079728506117493, 'support': 108696}, '1': {'precision': 0.4, 'recall': 0.0006438270641485875, 'f1-score': 0.0012855848924296584, 'support': 102512}, '2': {'precision': 0.35526679568703345, 'recall': 0.0619820758448374, 'f1-score': 0.10554934945459325, 'support': 103659}, 'accuracy': 0.34755944573423064, 'macro avg': {'precision': 0.36744238208003455, 'recall': 0.3365692240824414, 'f1-score': 0.20493592831959076, 'support': 314867}, 'weighted avg': {'precision': 0.3669977248737998, 'recall': 0.34755944573423064, 'f1-score': 0.21052553892183412, 'support': 314867}}
[[102944     51   5701]
 [ 96487     66   5959]
 [ 97186     48   6425]]
Evaluating performance on  val set...
400/400 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017281
{'0': {'precision': 0.3244979836838251, 'recall': 0.9546971719868916, 'f1-score': 0.48436285263441475, 'support': 32956}, '1': {'precision': 0.5, 'recall': 0.0006968438779361807, 'f1-score': 0.0013917480935950592, 'support': 34441}, '2': {'precision': 0.3669339442535319, 'recall': 0.055153810835629015, 'f1-score': 0.09589382826922117, 'support': 34848}, 'accuracy': 0.3267543645166023, 'macro avg': {'precision': 0.39714397597911894, 'recall': 0.33684927556681893, 'f1-score': 0.19388280966574367, 'support': 102245}, 'weighted avg': {'precision': 0.398078826736087, 'recall': 0.3267543645166023, 'f1-score': 0.18927383730292044, 'support': 102245}}
[[31463    15  1478]
 [32579    24  1838]
 [32917     9  1922]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
6143/6143 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048337
{'0': {'precision': 0.30870237679731183, 'recall': 0.9371960100310197, 'f1-score': 0.4644273383450441, 'support': 481307}, '1': {'precision': 0.40809084457061745, 'recall': 0.0009833177997622935, 'f1-score': 0.001961908271405272, 'support': 584755}, '2': {'precision': 0.352818580607583, 'recall': 0.0765488167287016, 'f1-score': 0.12580296050870254, 'support': 506435}, 'accuracy': 0.3118740449107375, 'macro avg': {'precision': 0.35653726732517077, 'recall': 0.3382427148531612, 'f1-score': 0.19739740237505066, 'support': 1572497}, 'weighted avg': {'precision': 0.3598693381011706, 'recall': 0.3118740449107375, 'f1-score': 0.18339646238645194, 'support': 1572497}}
[[451079    367  29861]
 [542930    575  41250]
 [467201    467  38767]]
Evaluating performance on  train set...
2083/2083 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004785
{'0': {'precision': 0.3357446126732356, 'recall': 0.9409849683988369, 'f1-score': 0.4949061076522042, 'support': 178158}, '1': {'precision': 0.37850467289719625, 'recall': 0.0009163258726307037, 'f1-score': 0.0018282257745978183, 'support': 176793}, '2': {'precision': 0.35149994024142467, 'recall': 0.06599164165708356, 'f1-score': 0.11112108173973827, 'support': 178265}, 'accuracy': 0.3367678389245634, 'macro avg': {'precision': 0.35524974193728553, 'recall': 0.3359643119761837, 'f1-score': 0.2026184717221801, 'support': 533216}, 'weighted avg': {'precision': 0.3551894582819906, 'recall': 0.3367678389245634, 'f1-score': 0.20311412163701822, 'support': 533216}}
[[167644    147  10367]
 [165294    162  11337]
 [166382    119  11764]]
Evaluating performance on  val set...
685/685 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038215
{'0': {'precision': 0.31415308215480947, 'recall': 0.9547418114211764, 'f1-score': 0.4727500823567106, 'support': 54863}, '1': {'precision': 0.3559322033898305, 'recall': 0.00034211426616489907, 'f1-score': 0.0006835714983236223, 'support': 61383}, '2': {'precision': 0.3658711217183771, 'recall': 0.0520304783885146, 'f1-score': 0.09110493707935281, 'support': 58927}, 'accuracy': 0.31664126320837116, 'macro avg': {'precision': 0.3453188024210057, 'recall': 0.33570480135861863, 'f1-score': 0.18817953031146237, 'support': 175173}, 'weighted avg': {'precision': 0.34619064910937236, 'recall': 0.31664126320837116, 'f1-score': 0.17894874247111617, 'support': 175173}}
[[52380    16  2467]
 [58515    21  2847]
 [55839    22  3066]]
testing model on single stock: results/universal/W7/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
23942/23942 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076727
{'0': {'precision': 0.2955544930495902, 'recall': 0.9677100164564876, 'f1-score': 0.4528125997058761, 'support': 1809013}, '1': {'precision': 0.34296724470134876, 'recall': 0.0001412564443292878, 'f1-score': 0.00028239657919379744, 'support': 2520239}, '2': {'precision': 0.30829067378499586, 'recall': 0.03510043021279504, 'f1-score': 0.06302513463199923, 'support': 1799807}, 'accuracy': 0.29598834013508435, 'macro avg': {'precision': 0.31560413717864494, 'recall': 0.334317234371204, 'f1-score': 0.17204004363902306, 'support': 6129059}, 'weighted avg': {'precision': 0.3187903817971002, 'recall': 0.29598834013508435, 'f1-score': 0.15227274933895912, 'support': 6129059}}
[[1750600     364   58049]
 [2436189     356   83694]
 [1736315     318   63174]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003654
{'0': {'precision': 0.3367790356435003, 'recall': 0.9761613950997353, 'f1-score': 0.5007853906791522, 'support': 778611}, '1': {'precision': 0.31630170316301703, 'recall': 0.000340037299476081, 'f1-score': 0.0006793442760019022, 'support': 764622}, '2': {'precision': 0.3461428451249264, 'recall': 0.02658542731425544, 'f1-score': 0.04937836021505377, 'support': 773845}, 'accuracy': 0.3370119607540186, 'macro avg': {'precision': 0.3330745279771479, 'recall': 0.3343622865711556, 'f1-score': 0.18361436505673598, 'support': 2317078}, 'weighted avg': {'precision': 0.3331489110781046, 'recall': 0.3370119607540186, 'f1-score': 0.18499491711617336, 'support': 2317078}}
[[760050    255  18306]
 [743806    260  20556]
 [752965    307  20573]]
Evaluating performance on  val set...
2763/2763 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036551
{'0': {'precision': 0.3149844383034335, 'recall': 0.9740966184443586, 'f1-score': 0.4760372121021718, 'support': 222442}, '1': {'precision': 0.3024193548387097, 'recall': 0.0003103058788483101, 'f1-score': 0.0006199756142925046, 'support': 241697}, '2': {'precision': 0.3537240983349862, 'recall': 0.027868818751927624, 'f1-score': 0.051666958914970994, 'support': 243175}, 'accuracy': 0.3160293730931383, 'macro avg': {'precision': 0.3237092971590431, 'recall': 0.3340919143583782, 'f1-score': 0.17610804887714512, 'support': 707314}, 'weighted avg': {'precision': 0.32400953020038376, 'recall': 0.3160293730931383, 'f1-score': 0.16768313438533244, 'support': 707314}}
[[216680     82   5680]
 [234920     75   6702]
 [236307     91   6777]]
training model: results/universal/W7/deepLOB_L2/h300
Epoch 1/50
12475/12475 - 517s - loss: 3.2491 - accuracy300: 0.3953 - val_loss: 3.4147 - val_accuracy300: 0.3205 - 517s/epoch - 41ms/step
Epoch 2/50
12475/12475 - 508s - loss: 3.2256 - accuracy300: 0.4091 - val_loss: 3.5837 - val_accuracy300: 0.3450 - 508s/epoch - 41ms/step
Epoch 3/50
12475/12475 - 510s - loss: 3.2154 - accuracy300: 0.4143 - val_loss: 3.8659 - val_accuracy300: 0.3223 - 510s/epoch - 41ms/step
Epoch 4/50
12475/12475 - 509s - loss: 3.2061 - accuracy300: 0.4189 - val_loss: 3.7631 - val_accuracy300: 0.3266 - 509s/epoch - 41ms/step
Epoch 5/50
12475/12475 - 509s - loss: 3.1996 - accuracy300: 0.4216 - val_loss: 3.8348 - val_accuracy300: 0.3282 - 509s/epoch - 41ms/step
Epoch 6/50
12475/12475 - 509s - loss: 3.1949 - accuracy300: 0.4238 - val_loss: 4.0753 - val_accuracy300: 0.3228 - 509s/epoch - 41ms/step
Epoch 7/50
12475/12475 - 512s - loss: 3.1901 - accuracy300: 0.4255 - val_loss: 4.1759 - val_accuracy300: 0.3231 - 512s/epoch - 41ms/step
Epoch 8/50
12475/12475 - 510s - loss: 3.1854 - accuracy300: 0.4279 - val_loss: 4.1459 - val_accuracy300: 0.3237 - 510s/epoch - 41ms/step
Epoch 9/50
12475/12475 - 511s - loss: 3.1822 - accuracy300: 0.4291 - val_loss: 3.5717 - val_accuracy300: 0.3346 - 511s/epoch - 41ms/step
Epoch 10/50
12475/12475 - 513s - loss: 3.1784 - accuracy300: 0.4307 - val_loss: 3.9069 - val_accuracy300: 0.3263 - 513s/epoch - 41ms/step
Epoch 11/50
12475/12475 - 515s - loss: 3.1749 - accuracy300: 0.4320 - val_loss: 3.7114 - val_accuracy300: 0.3278 - 515s/epoch - 41ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 518s - 518s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1431963
{'0': {'precision': 0.29663284782773947, 'recall': 0.8995577960928347, 'f1-score': 0.446146928496425, 'support': 2845746}, '1': {'precision': 0.38834170961284553, 'recall': 0.03793358359593398, 'f1-score': 0.06911586451327269, 'support': 3845827}, '2': {'precision': 0.31249950000399995, 'recall': 0.05552631681816518, 'f1-score': 0.09429744028596233, 'support': 2813999}, 'accuracy': 0.30109182277510493, 'macro avg': {'precision': 0.33249135248152833, 'recall': 0.33100589883564463, 'f1-score': 0.20318674443188667, 'support': 9505572}, 'weighted avg': {'precision': 0.3384341366033938, 'recall': 0.30109182277510493, 'f1-score': 0.18944482222866033, 'support': 9505572}}
[[2559913  117732  168101]
 [3524289  145886  175652]
 [2545702  112046  156251]]
Evaluating performance on  train set...
12475/12475 - 180s - 180s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1300913
{'0': {'precision': 0.3354312865599202, 'recall': 0.8944130384167637, 'f1-score': 0.4878895809805688, 'support': 1073750}, '1': {'precision': 0.3118680485338726, 'recall': 0.07011642974054316, 'f1-score': 0.11449195115010084, 'support': 1055744}, '2': {'precision': 0.3358598946186404, 'recall': 0.029246232100715502, 'f1-score': 0.0538070205482414, 'support': 1063590}, 'accuracy': 0.33369212961513073, 'macro avg': {'precision': 0.3277197432374777, 'recall': 0.3312585667526741, 'f1-score': 0.218729517559637, 'support': 3193084}, 'weighted avg': {'precision': 0.32778323097434925, 'recall': 0.33369212961513073, 'f1-score': 0.2198420827757121, 'support': 3193084}}
[[960376  81899  31475]
 [951684  74025  30035]
 [951048  81436  31106]]
Evaluating performance on  val set...
3866/3866 - 55s - 55s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369342
{'0': {'precision': 0.31912785682671607, 'recall': 0.938379696331597, 'f1-score': 0.4762804018598312, 'support': 315805}, '1': {'precision': 0.3422677189966398, 'recall': 0.03831071329649985, 'f1-score': 0.06890837388823629, 'support': 342985}, '2': {'precision': 0.3346094946401225, 'recall': 0.022484050216093846, 'f1-score': 0.0421367274129785, 'support': 330412}, 'accuracy': 0.3203733918855805, 'macro avg': {'precision': 0.3320016901544928, 'recall': 0.33305815328139693, 'f1-score': 0.19577516772034867, 'support': 989202}, 'weighted avg': {'precision': 0.3323222746903623, 'recall': 0.3203733918855805, 'f1-score': 0.19002059367589, 'support': 989202}}
[[296345  12314   7146]
 [322218  13140   7627]
 [310046  12937   7429]]
testing model out of sample: results/universal/W7/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 215s - 215s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1522821
{'0': {'precision': 0.28778401395191605, 'recall': 0.94362070626666, 'f1-score': 0.44105556855321987, 'support': 1089815}, '1': {'precision': 0.35493098399641165, 'recall': 0.027134270611603187, 'f1-score': 0.05041438996111845, 'support': 1545610}, '2': {'precision': 0.30045352845135154, 'recall': 0.021814359737170465, 'f1-score': 0.040675485173414815, 'support': 1138837}, 'accuracy': 0.29016374591906974, 'macro avg': {'precision': 0.3143895087998931, 'recall': 0.3308564455384779, 'f1-score': 0.1773818145625844, 'support': 3774262}, 'weighted avg': {'precision': 0.3191044522930981, 'recall': 0.29016374591906974, 'f1-score': 0.1602731096089958, 'support': 3774262}}
[[1028372   37632   23811]
 [1469640   41939   34031]
 [1075404   38590   24843]]
Evaluating performance on  train set...
5285/5285 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1278228
{'0': {'precision': 0.3342868668758404, 'recall': 0.8212016639983087, 'f1-score': 0.4751530179595015, 'support': 454087}, '1': {'precision': 0.3301979901902141, 'recall': 0.09816090012314012, 'f1-score': 0.15133353208667016, 'support': 449894}, '2': {'precision': 0.33284656002785246, 'recall': 0.07670979461290718, 'f1-score': 0.12468414159875522, 'support': 448665}, 'accuracy': 0.33377247262033083, 'macro avg': {'precision': 0.332443805697969, 'recall': 0.33202411957811867, 'f1-score': 0.25039023054830895, 'support': 1352646}, 'weighted avg': {'precision': 0.3324491529731965, 'recall': 0.33377247262033083, 'f1-score': 0.2512011767610905, 'support': 1352646}}
[[372897  45113  36077]
 [372824  44162  32908]
 [369779  44469  34417]]
Evaluating performance on  val set...
1714/1714 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1333948
{'0': {'precision': 0.3196735340324167, 'recall': 0.8902334051831459, 'f1-score': 0.4704230540790473, 'support': 140571}, '1': {'precision': 0.34151686557881955, 'recall': 0.07583050579973172, 'f1-score': 0.12410475508897295, 'support': 152076}, '2': {'precision': 0.3529136072488674, 'recall': 0.031075680769257225, 'f1-score': 0.05712154448160113, 'support': 145387}, 'accuracy': 0.32232886031677904, 'macro avg': {'precision': 0.3380346689533679, 'recall': 0.3323798639173783, 'f1-score': 0.21721645121654043, 'support': 438034}, 'weighted avg': {'precision': 0.338289716824097, 'recall': 0.32232886031677904, 'f1-score': 0.21301068834246414, 'support': 438034}}
[[125141  10965   4465]
 [136725  11532   3819]
 [129599  11270   4518]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1468261
{'0': {'precision': 0.29769493988328216, 'recall': 0.9584779655900996, 'f1-score': 0.45429102809420774, 'support': 53008}, '1': {'precision': 0.39021368844843607, 'recall': 0.01837833107250689, 'f1-score': 0.03510335989301833, 'support': 68559}, '2': {'precision': 0.31661286317357834, 'recall': 0.022623631492095037, 'f1-score': 0.04222972972972972, 'support': 56357}, 'accuracy': 0.29980216272116184, 'macro avg': {'precision': 0.33484049716843217, 'recall': 0.33315997605156716, 'f1-score': 0.1772080392389853, 'support': 177924}, 'weighted avg': {'precision': 0.33933715951497667, 'recall': 0.29980216272116184, 'f1-score': 0.16224708834390855, 'support': 177924}}
[[50807  1010  1191]
 [65738  1260  1561]
 [54123   959  1275]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1279519
{'0': {'precision': 0.340173613327376, 'recall': 0.8659869196084007, 'f1-score': 0.4884688090737239, 'support': 24617}, '1': {'precision': 0.34141058616488423, 'recall': 0.1056644880174292, 'f1-score': 0.16138217885138378, 'support': 23868}, '2': {'precision': 0.33539412673879443, 'recall': 0.027689166772999874, 'f1-score': 0.05115511551155116, 'support': 23511}, 'accuracy': 0.34017167620423355, 'macro avg': {'precision': 0.3389927754103515, 'recall': 0.33311352479960993, 'f1-score': 0.23366870114555297, 'support': 71996}, 'weighted avg': {'precision': 0.33902290437828864, 'recall': 0.34017167620423355, 'f1-score': 0.23722449078538763, 'support': 71996}}
[[21318  2583   716]
 [20772  2522   574]
 [20578  2282   651]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.131787
{'0': {'precision': 0.3383490198429351, 'recall': 0.8982969918828585, 'f1-score': 0.4915519944260582, 'support': 6283}, '1': {'precision': 0.286843997124371, 'recall': 0.06865106675843083, 'f1-score': 0.1107871720116618, 'support': 5812}, '2': {'precision': 0.3211009174311927, 'recall': 0.021830656479026978, 'f1-score': 0.04088188056650606, 'support': 6413}, 'accuracy': 0.33407175275556517, 'macro avg': {'precision': 0.31543131146616626, 'recall': 0.3295929050401054, 'f1-score': 0.21440701566807538, 'support': 18508}, 'weighted avg': {'precision': 0.31619863769430756, 'recall': 0.33407175275556517, 'f1-score': 0.21582514181887322, 'support': 18508}}
[[5644  479  160]
 [5277  399  136]
 [5760  513  140]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266778
{'0': {'precision': 0.3355382769650163, 'recall': 0.8981617475637619, 'f1-score': 0.4885590325387932, 'support': 171576}, '1': {'precision': 0.3470611755297881, 'recall': 0.08321490604768672, 'f1-score': 0.1342424752434714, 'support': 177324}, '2': {'precision': 0.3246404435972968, 'recall': 0.022787812442984858, 'f1-score': 0.04258632055099675, 'support': 164430}, 'accuracy': 0.3362476379716751, 'macro avg': {'precision': 0.3357466320307004, 'recall': 0.3347214886848111, 'f1-score': 0.2217959427777538, 'support': 513330}, 'weighted avg': {'precision': 0.3360279341532685, 'recall': 0.3362476379716751, 'f1-score': 0.2233103187718421, 'support': 513330}}
[[154103  13641   3832]
 [158605  14756   3963]
 [146563  14120   3747]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.119813
{'0': {'precision': 0.33861253411212716, 'recall': 0.755296881674498, 'f1-score': 0.4675944596872831, 'support': 46820}, '1': {'precision': 0.3445998679233956, 'recall': 0.12040105718001426, 'f1-score': 0.1784520682097278, 'support': 47674}, '2': {'precision': 0.3264822134387352, 'recall': 0.12473572938689217, 'f1-score': 0.180506993006993, 'support': 43043}, 'accuracy': 0.337887259428372, 'macro avg': {'precision': 0.33656487182475264, 'recall': 0.3334778894138015, 'f1-score': 0.27551784030133464, 'support': 137537}, 'weighted avg': {'precision': 0.3368916499818466, 'recall': 0.337887259428372, 'f1-score': 0.2775242952979137, 'support': 137537}}
[[35363  5680  5777]
 [36635  5740  5299]
 [32437  5237  5369]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1342244
{'0': {'precision': 0.32404546614133056, 'recall': 0.9078780177890724, 'f1-score': 0.4776169288295628, 'support': 12592}, '1': {'precision': 0.33356234970800414, 'recall': 0.0729691140001503, 'f1-score': 0.11974349488222963, 'support': 13307}, '2': {'precision': 0.34186046511627904, 'recall': 0.022355714394342637, 'f1-score': 0.041967025908214974, 'support': 13151}, 'accuracy': 0.3251472471190781, 'macro avg': {'precision': 0.33315609365520454, 'recall': 0.33440094872785514, 'f1-score': 0.21310914987333582, 'support': 39050}, 'weighted avg': {'precision': 0.3332881350566, 'recall': 0.3251472471190781, 'f1-score': 0.20894974166296082, 'support': 39050}}
[[11432   895   265]
 [12035   971   301]
 [11812  1045   294]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
930/930 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1314117
{'0': {'precision': 0.32838412742345174, 'recall': 0.9443488754236418, 'f1-score': 0.487312233980888, 'support': 77896}, '1': {'precision': 0.3552494501678435, 'recall': 0.03800948689050444, 'f1-score': 0.06867154460629657, 'support': 80743}, '2': {'precision': 0.3309420426656598, 'recall': 0.022104254406980557, 'f1-score': 0.041440610853043035, 'support': 79306}, 'accuracy': 0.3294164617873878, 'macro avg': {'precision': 0.338191873418985, 'recall': 0.3348208722403756, 'f1-score': 0.19914146314674255, 'support': 237945}, 'weighted avg': {'precision': 0.3383530058640535, 'recall': 0.3294164617873878, 'f1-score': 0.1966459029970493, 'support': 237945}}
[[73561  2586  1749]
 [75879  3069  1795]
 [74569  2984  1753]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1314064
{'0': {'precision': 0.3272009551889666, 'recall': 0.8327183653220055, 'f1-score': 0.4698020624688398, 'support': 32251}, '1': {'precision': 0.32190111420612816, 'recall': 0.057499144820723325, 'f1-score': 0.09756998496081898, 'support': 32157}, '2': {'precision': 0.33137436849159707, 'recall': 0.0970615770241295, 'f1-score': 0.15014481920956743, 'support': 33113}, 'accuracy': 0.327303862757765, 'macro avg': {'precision': 0.32682547929556394, 'recall': 0.32909302905561943, 'f1-score': 0.2391722888797421, 'support': 97521}, 'weighted avg': {'precision': 0.3268704340520306, 'recall': 0.327303862757765, 'f1-score': 0.23852185397559514, 'support': 97521}}
[[26856  1886  3509]
 [27332  1849  2976]
 [27890  2009  3214]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1385642
{'0': {'precision': 0.3184033252114089, 'recall': 0.9616883116883117, 'f1-score': 0.4784106815979326, 'support': 9240}, '1': {'precision': 0.3651685393258427, 'recall': 0.01983925119544206, 'f1-score': 0.0376338898002509, 'support': 9829}, '2': {'precision': 0.31811023622047246, 'recall': 0.02018385291766587, 'f1-score': 0.03795922202386545, 'support': 10008}, 'accuracy': 0.31925576916463183, 'macro avg': {'precision': 0.333894033585908, 'recall': 0.33390380526713986, 'f1-score': 0.184667931140683, 'support': 29077}, 'weighted avg': {'precision': 0.3341106559164156, 'recall': 0.31925576916463183, 'f1-score': 0.17781456459835637, 'support': 29077}}
[[8886  150  204]
 [9405  195  229]
 [9617  189  202]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1472363
{'0': {'precision': 0.2983099596004718, 'recall': 0.932999166625815, 'f1-score': 0.4520764733652616, 'support': 81596}, '1': {'precision': 0.3149458225127608, 'recall': 0.037813544925759876, 'f1-score': 0.06752035017662418, 'support': 93009}, '2': {'precision': 0.36290455068178085, 'recall': 0.022575370464997444, 'f1-score': 0.04250651837170594, 'support': 97850}, 'accuracy': 0.300434934209319, 'macro avg': {'precision': 0.32538677759833784, 'recall': 0.33112936067219073, 'f1-score': 0.18736778063786388, 'support': 272455}, 'weighted avg': {'precision': 0.32718763008152435, 'recall': 0.300434934209319, 'f1-score': 0.17370536416274596, 'support': 272455}}
[[76129  3652  1815]
 [87429  3517  2063]
 [91643  3998  2209]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1235402
{'0': {'precision': 0.34304574457533915, 'recall': 0.8809928114563876, 'f1-score': 0.4938093387374382, 'support': 35334}, '1': {'precision': 0.3336848766083105, 'recall': 0.0936177767257449, 'f1-score': 0.1462140992167102, 'support': 33797}, '2': {'precision': 0.34275031159119235, 'recall': 0.02462613056326677, 'f1-score': 0.045950763061156294, 'support': 33501}, 'accuracy': 0.3421739808246941, 'macro avg': {'precision': 0.339826977591614, 'recall': 0.3330789062484664, 'f1-score': 0.22865806700510158, 'support': 102632}, 'weighted avg': {'precision': 0.3398667501575789, 'recall': 0.3421739808246941, 'f1-score': 0.23315587340680874, 'support': 102632}}
[[31129  3391   814]
 [29865  3164   768]
 [29749  2927   825]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1458143
{'0': {'precision': 0.3017915031564579, 'recall': 0.9351802897324732, 'f1-score': 0.45632320313709296, 'support': 9457}, '1': {'precision': 0.308972503617945, 'recall': 0.040744274809160305, 'f1-score': 0.0719946046197943, 'support': 10480}, '2': {'precision': 0.37896253602305474, 'recall': 0.022981475008738202, 'f1-score': 0.04333498105124402, 'support': 11444}, 'accuracy': 0.30381440999330805, 'macro avg': {'precision': 0.32990884759915257, 'recall': 0.3329686798501239, 'f1-score': 0.19055092960271044, 'support': 31381}, 'weighted avg': {'precision': 0.33233234586260874, 'recall': 0.30381440999330805, 'f1-score': 0.17736456810278095, 'support': 31381}}
[[ 8844   406   207]
 [ 9829   427   224]
 [10632   549   263]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
1646/1646 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1600213
{'0': {'precision': 0.26628430361675126, 'recall': 0.9579662588722045, 'f1-score': 0.41673066927331825, 'support': 112148}, '1': {'precision': 0.43105806291184884, 'recall': 0.019290153508893945, 'f1-score': 0.036927763457810535, 'support': 179729}, '2': {'precision': 0.30635601880237073, 'recall': 0.02316703758654797, 'f1-score': 0.04307656939235886, 'support': 129408}, 'accuracy': 0.2703609195675137, 'macro avg': {'precision': 0.3345661284436569, 'recall': 0.33347448332254886, 'f1-score': 0.16557833404116254, 'support': 421285}, 'weighted avg': {'precision': 0.3488892468335504, 'recall': 0.2703609195675137, 'f1-score': 0.1399217959056204, 'support': 421285}}
[[107434   2133   2581]
 [172055   3467   4207]
 [123967   2443   2998]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1271789
{'0': {'precision': 0.33573993715397277, 'recall': 0.7909056861492366, 'f1-score': 0.47137914508367307, 'support': 45391}, '1': {'precision': 0.3314228399484167, 'recall': 0.10410477990818255, 'f1-score': 0.1584409357125732, 'support': 44436}, '2': {'precision': 0.335277818287881, 'recall': 0.10269582114220624, 'f1-score': 0.1572315215347, 'support': 44773}, 'accuracy': 0.3352451708766716, 'macro avg': {'precision': 0.3341468651300901, 'recall': 0.33256876239987515, 'f1-score': 0.26235053411031545, 'support': 134600}, 'weighted avg': {'precision': 0.3341609997140202, 'recall': 0.3352451708766716, 'f1-score': 0.26357042427555744, 'support': 134600}}
[[35900  4691  4800]
 [35494  4626  4316]
 [35534  4641  4598]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1412148
{'0': {'precision': 0.30959824012967463, 'recall': 0.9216716932356743, 'f1-score': 0.4635018308668992, 'support': 11605}, '1': {'precision': 0.31857070961248113, 'recall': 0.04743349569127014, 'f1-score': 0.08257239759979129, 'support': 13345}, '2': {'precision': 0.3066502463054187, 'recall': 0.020085504557554246, 'f1-score': 0.037701567113331814, 'support': 12397}, 'accuracy': 0.3100115136423274, 'macro avg': {'precision': 0.3116063986825248, 'recall': 0.3297302311614995, 'f1-score': 0.19459193186000745, 'support': 37347}, 'weighted avg': {'precision': 0.3118257637810724, 'recall': 0.3100115136423274, 'f1-score': 0.18604583288305768, 'support': 37347}}
[[10696   651   258]
 [12407   633   305]
 [11445   703   249]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
5929/5929 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1205188
{'0': {'precision': 0.32216456809582, 'recall': 0.6521466368990124, 'f1-score': 0.4312760410321386, 'support': 502111}, '1': {'precision': 0.3775440083378191, 'recall': 0.1197961998244731, 'f1-score': 0.18188088042385261, 'support': 550343}, '2': {'precision': 0.32321821762045194, 'recall': 0.2269182725281057, 'f1-score': 0.26663971907131845, 'support': 465119}, 'accuracy': 0.3287637563398927, 'macro avg': {'precision': 0.3409755980180303, 'recall': 0.33295370308386374, 'f1-score': 0.29326554684243655, 'support': 1517573}, 'weighted avg': {'precision': 0.3425706768591874, 'recall': 0.3287637563398927, 'f1-score': 0.290374507920558, 'support': 1517573}}
[[327450  57328 117333]
 [380750  65929 103664]
 [308206  51369 105544]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1322368
{'0': {'precision': 0.3285247874717263, 'recall': 0.9001563610518835, 'f1-score': 0.48136764784132285, 'support': 105525}, '1': {'precision': 0.32326418375187027, 'recall': 0.07560052960090789, 'f1-score': 0.12254251967900422, 'support': 105740}, '2': {'precision': 0.3450218279115618, 'recall': 0.022333026444126415, 'f1-score': 0.041950618129516115, 'support': 109703}, 'accuracy': 0.3284844595099823, 'macro avg': {'precision': 0.33227026637838614, 'recall': 0.3326966390323059, 'f1-score': 0.21528692854994777, 'support': 320968}, 'weighted avg': {'precision': 0.3324302191348008, 'recall': 0.3284844595099823, 'f1-score': 0.2129685069227331, 'support': 320968}}
[[94989  8242  2294]
 [95389  7994  2357]
 [98760  8493  2450]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1285075
{'0': {'precision': 0.32403223258018643, 'recall': 0.8709019874299303, 'f1-score': 0.47232778276791265, 'support': 35322}, '1': {'precision': 0.35636455781738324, 'recall': 0.11195435849807615, 'f1-score': 0.17038203699216542, 'support': 37685}, '2': {'precision': 0.31965531391054575, 'recall': 0.021516959451994253, 'f1-score': 0.04031986749825314, 'support': 36204}, 'accuracy': 0.32743954363571437, 'macro avg': {'precision': 0.33335070143603845, 'recall': 0.33479110179333355, 'f1-score': 0.2276765624194437, 'support': 109211}, 'weighted avg': {'precision': 0.3337380471322745, 'recall': 0.32743954363571437, 'f1-score': 0.22492376674405254, 'support': 109211}}
[[30762  3768   792]
 [32600  4219   866]
 [31573  3852   779]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
5331/5331 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1456703
{'0': {'precision': 0.3012849185037729, 'recall': 0.9602070653258019, 'f1-score': 0.458656751103881, 'support': 411078}, '1': {'precision': 0.39141677440880845, 'recall': 0.01762097167877072, 'f1-score': 0.03372375269727138, 'support': 532604}, '2': {'precision': 0.31166617497623494, 'recall': 0.02258840075643109, 'f1-score': 0.04212382401740244, 'support': 420924}, 'accuracy': 0.3031006752132117, 'macro avg': {'precision': 0.33478928929627205, 'recall': 0.33347214592033453, 'f1-score': 0.17816810927285162, 'support': 1364606}, 'weighted avg': {'precision': 0.33966545250542624, 'recall': 0.3031006752132117, 'f1-score': 0.1643229137293547, 'support': 1364606}}
[[394720   7205   9153]
 [511373   9385  11846]
 [404029   7387   9508]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1246753
{'0': {'precision': 0.3377791343629815, 'recall': 0.7925074192476482, 'f1-score': 0.47367186523556215, 'support': 174546}, '1': {'precision': 0.3293356592527984, 'recall': 0.10476966743550167, 'f1-score': 0.15896781436797489, 'support': 172989}, '2': {'precision': 0.32978031721012707, 'recall': 0.09976337638651304, 'f1-score': 0.15318580345212598, 'support': 167777}, 'accuracy': 0.3360895923246499, 'macro avg': {'precision': 0.33229837027530235, 'recall': 0.33234682102322094, 'f1-score': 0.261941827685221, 'support': 515312}, 'weighted avg': {'precision': 0.3323403984878419, 'recall': 0.3360895923246499, 'f1-score': 0.26368155054587394, 'support': 515312}}
[[138329  18872  17345]
 [138193  18124  16672]
 [133003  18036  16738]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1301464
{'0': {'precision': 0.3265262116465201, 'recall': 0.8820022612807071, 'f1-score': 0.47660748338362985, 'support': 58374}, '1': {'precision': 0.33980521912848044, 'recall': 0.08969563139594285, 'f1-score': 0.1419277454009726, 'support': 60683}, '2': {'precision': 0.3149066855657926, 'recall': 0.022642342709607282, 'f1-score': 0.042247048569843904, 'support': 58872}, 'accuracy': 0.32744521691236395, 'macro avg': {'precision': 0.3270793721135977, 'recall': 0.33144674512875244, 'f1-score': 0.22026075911814877, 'support': 177929}, 'weighted avg': {'precision': 0.32721044677178474, 'recall': 0.32744521691236395, 'f1-score': 0.21874598774009343, 'support': 177929}}
[[51486  5406  1482]
 [53822  5443  1418]
 [52370  5169  1333]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
4192/4192 - 58s - 58s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.159419
{'0': {'precision': 0.26759529865477305, 'recall': 0.9590269287438478, 'f1-score': 0.41843542646285536, 'support': 287091}, '1': {'precision': 0.45827173081825134, 'recall': 0.01854101650725944, 'f1-score': 0.035640086275256125, 'support': 484817}, '2': {'precision': 0.28403279486971345, 'recall': 0.023230492428014685, 'f1-score': 0.04294832453663926, 'support': 301242}, 'accuracy': 0.2714578577086148, 'macro avg': {'precision': 0.33663327478091265, 'recall': 0.33359947922637395, 'f1-score': 0.1656746124249169, 'support': 1073150}, 'weighted avg': {'precision': 0.35835133466742936, 'recall': 0.2714578577086148, 'f1-score': 0.14009766007214716, 'support': 1073150}}
[[275328   5212   6551]
 [464739   8989  11089]
 [288830   5414   6998]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.124912
{'0': {'precision': 0.34358005225863925, 'recall': 0.8522662129925846, 'f1-score': 0.4897312949114721, 'support': 108154}, '1': {'precision': 0.31913830783640335, 'recall': 0.10027467137531881, 'f1-score': 0.15260132865566917, 'support': 101940}, '2': {'precision': 0.35469909315746084, 'recall': 0.04927796283393623, 'f1-score': 0.08653386854829925, 'support': 104773}, 'accuracy': 0.34160772643687654, 'macro avg': {'precision': 0.33913915108416787, 'recall': 0.33393961573394654, 'f1-score': 0.24295549737181352, 'support': 314867}, 'weighted avg': {'precision': 0.33936679347219767, 'recall': 0.34160772643687654, 'f1-score': 0.2464183001788858, 'support': 314867}}
[[92176 11091  4887]
 [87212 10222  4506]
 [88893 10717  5163]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1322216
{'0': {'precision': 0.32405413547256967, 'recall': 0.8711719007768679, 'f1-score': 0.4723907421563685, 'support': 33339}, '1': {'precision': 0.31865766559045106, 'recall': 0.09288199395425768, 'f1-score': 0.14383818755934374, 'support': 35066}, '2': {'precision': 0.3220692532332082, 'recall': 0.02281323877068558, 'f1-score': 0.0426083836962221, 'support': 33840}, 'accuracy': 0.32346814025135706, 'macro avg': {'precision': 0.32159368476540967, 'recall': 0.32895571116727035, 'f1-score': 0.2196124378039781, 'support': 102245}, 'weighted avg': {'precision': 0.32154642333147365, 'recall': 0.32346814025135706, 'f1-score': 0.21746523098427578, 'support': 102245}}
[[29044  3473   822]
 [31006  3257   803]
 [29577  3491   772]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
6143/6143 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1596134
{'0': {'precision': 0.27412852852197045, 'recall': 0.9219573774630754, 'f1-score': 0.4226031223665093, 'support': 435685}, '1': {'precision': 0.3349522421887648, 'recall': 0.036299572352790674, 'f1-score': 0.06550067999034427, 'support': 683975}, '2': {'precision': 0.2824397471952584, 'recall': 0.02062529535687944, 'f1-score': 0.03844325401153709, 'support': 452842}, 'accuracy': 0.2771703946958414, 'macro avg': {'precision': 0.2971735059686646, 'recall': 0.3262940817242485, 'f1-score': 0.17551568545613025, 'support': 1572502}, 'weighted avg': {'precision': 0.3029778199325344, 'recall': 0.2771703946958414, 'f1-score': 0.15664933271801296, 'support': 1572502}}
[[401683  24873   9129]
 [644547  24828  14600]
 [419079  24423   9340]]
Evaluating performance on  train set...
2083/2083 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1301391
{'0': {'precision': 0.3314685961812181, 'recall': 0.8485971503029073, 'f1-score': 0.47672480448202, 'support': 177282}, '1': {'precision': 0.32922168172341904, 'recall': 0.09665956337421505, 'f1-score': 0.14944271143668292, 'support': 176444}, '2': {'precision': 0.33632173060868936, 'recall': 0.05162375829428774, 'f1-score': 0.08950840892186127, 'support': 179491}, 'accuracy': 0.33150105866842206, 'macro avg': {'precision': 0.33233733617110883, 'recall': 0.3322934906571367, 'f1-score': 0.2385586416135214, 'support': 533217}, 'weighted avg': {'precision': 0.3323587391754012, 'recall': 0.33150105866842206, 'f1-score': 0.2380812134472632, 'support': 533217}}
[[150441  17194   9647]
 [150751  17055   8638]
 [152670  17555   9266]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1352249
{'0': {'precision': 0.3134303373680144, 'recall': 0.8840182316729921, 'f1-score': 0.4627808488086355, 'support': 55069}, '1': {'precision': 0.35863992762364294, 'recall': 0.07622542343006393, 'f1-score': 0.1257284825098122, 'support': 62407}, '2': {'precision': 0.37577781150402184, 'recall': 0.04291384300743539, 'f1-score': 0.07703076875213886, 'support': 57697}, 'accuracy': 0.3191987349648633, 'macro avg': {'precision': 0.3492826921652264, 'recall': 0.33438583270349714, 'f1-score': 0.22184670002352888, 'support': 175173}, 'weighted avg': {'precision': 0.3500721549672348, 'recall': 0.3191987349648633, 'f1-score': 0.21564773244578073, 'support': 175173}}
[[48682  3971  2416]
 [55953  4757  1697]
 [50685  4536  2476]]
testing model on single stock: results/universal/W7/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
23942/23942 - 336s - 336s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1471763
{'0': {'precision': 0.29419569076851254, 'recall': 0.957490190598501, 'f1-score': 0.45009613389512226, 'support': 1803372}, '1': {'precision': 0.41244723269115224, 'recall': 0.020807500116126462, 'f1-score': 0.03961639743210676, 'support': 2540334}, '2': {'precision': 0.2908915508898798, 'recall': 0.021449479600169827, 'f1-score': 0.03995294743623517, 'support': 1785358}, 'accuracy': 0.2965973270959481, 'macro avg': {'precision': 0.33251149144984815, 'recall': 0.3332490567715991, 'f1-score': 0.1765551595878214, 'support': 6129064}, 'weighted avg': {'precision': 0.3422453342268074, 'recall': 0.2965973270959481, 'f1-score': 0.16049105717575635, 'support': 6129064}}
[[1726711   37880   38781]
 [2432905   52858   54571]
 [1709644   37419   38295]]
Evaluating performance on  train set...
9052/9052 - 130s - 130s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1316047
{'0': {'precision': 0.3347477678603149, 'recall': 0.9084298196337142, 'f1-score': 0.489221905927571, 'support': 777917}, '1': {'precision': 0.30359798185749626, 'recall': 0.060990643013959164, 'f1-score': 0.10157550108842532, 'support': 766593}, '2': {'precision': 0.33282037471626974, 'recall': 0.02239538164826488, 'f1-score': 0.041966828208150814, 'support': 772570}, 'accuracy': 0.3326341774992663, 'macro avg': {'precision': 0.3237220414780269, 'recall': 0.3306052814319794, 'f1-score': 0.21092141174138235, 'support': 2317080}, 'weighted avg': {'precision': 0.32379939576157263, 'recall': 0.3326341774992663, 'f1-score': 0.21184569284103638, 'support': 2317080}}
[[706683  53790  17444]
 [702598  46755  17240]
 [701810  53458  17302]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1383698
{'0': {'precision': 0.3184916996698699, 'recall': 0.9617672538261622, 'f1-score': 0.47852020330958295, 'support': 225095}, '1': {'precision': 0.3532869680410664, 'recall': 0.017314067527703727, 'f1-score': 0.0330103471617832, 'support': 246447}, '2': {'precision': 0.3346662366978394, 'recall': 0.02200845728730601, 'f1-score': 0.04130086995280128, 'support': 235773}, 'accuracy': 0.3194404190495041, 'macro avg': {'precision': 0.33548163480292525, 'recall': 0.3336965928803906, 'f1-score': 0.18427714014138916, 'support': 707315}, 'weighted avg': {'precision': 0.3360068218190845, 'recall': 0.3194404190495041, 'f1-score': 0.17755234400844372, 'support': 707315}}
[[216489   3756   4850]
 [236714   4267   5466]
 [226529   4055   5189]]
training model: results/universal/W7/deepLOB_L2/h500
Epoch 1/50
12475/12475 - 518s - loss: 3.2253 - accuracy500: 0.4093 - val_loss: 3.5404 - val_accuracy500: 0.3191 - 518s/epoch - 42ms/step
Epoch 2/50
12475/12475 - 512s - loss: 3.1949 - accuracy500: 0.4246 - val_loss: 3.4612 - val_accuracy500: 0.3379 - 512s/epoch - 41ms/step
Epoch 3/50
12475/12475 - 512s - loss: 3.1793 - accuracy500: 0.4315 - val_loss: 3.8499 - val_accuracy500: 0.3204 - 512s/epoch - 41ms/step
Epoch 4/50
12475/12475 - 512s - loss: 3.1685 - accuracy500: 0.4353 - val_loss: 3.6939 - val_accuracy500: 0.3242 - 512s/epoch - 41ms/step
Epoch 5/50
12475/12475 - 510s - loss: 3.1612 - accuracy500: 0.4387 - val_loss: 3.5849 - val_accuracy500: 0.3248 - 510s/epoch - 41ms/step
Epoch 6/50
12475/12475 - 511s - loss: 3.1531 - accuracy500: 0.4412 - val_loss: 3.6948 - val_accuracy500: 0.3263 - 511s/epoch - 41ms/step
Epoch 7/50
12475/12475 - 512s - loss: 3.1463 - accuracy500: 0.4432 - val_loss: 3.9860 - val_accuracy500: 0.3215 - 512s/epoch - 41ms/step
Epoch 8/50
12475/12475 - 513s - loss: 3.1395 - accuracy500: 0.4458 - val_loss: 4.4469 - val_accuracy500: 0.3212 - 513s/epoch - 41ms/step
Epoch 9/50
12475/12475 - 515s - loss: 3.1363 - accuracy500: 0.4469 - val_loss: 3.8315 - val_accuracy500: 0.3282 - 515s/epoch - 41ms/step
Epoch 10/50
12475/12475 - 514s - loss: 3.1321 - accuracy500: 0.4483 - val_loss: 3.8878 - val_accuracy500: 0.3309 - 514s/epoch - 41ms/step
Epoch 11/50
12475/12475 - 512s - loss: 3.1299 - accuracy500: 0.4489 - val_loss: 4.0438 - val_accuracy500: 0.3317 - 512s/epoch - 41ms/step
Epoch 12/50
12475/12475 - 515s - loss: 3.1254 - accuracy500: 0.4509 - val_loss: 3.8441 - val_accuracy500: 0.3304 - 515s/epoch - 41ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 524s - 524s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1454111
{'0': {'precision': 0.3017869228575442, 'recall': 0.14647441636250946, 'f1-score': 0.19722451848427852, 'support': 2904200}, '1': {'precision': 0.38949983810581196, 'recall': 0.48148563466384303, 'f1-score': 0.43063537249475653, 'support': 3727619}, '2': {'precision': 0.2985848826708333, 'recall': 0.3624107569439684, 'f1-score': 0.32741630006462, 'support': 2873753}, 'accuracy': 0.34313190200442434, 'macro avg': {'precision': 0.3299572145447298, 'recall': 0.33012360265677365, 'f1-score': 0.3184253970145517, 'support': 9505572}, 'weighted avg': {'precision': 0.3352155746874553, 'recall': 0.34313190200442434, 'f1-score': 0.3281167737959563, 'support': 9505572}}
[[ 425391 1404990 1073819]
 [ 560072 1794795 1372752]
 [ 424111 1408163 1041479]]
Evaluating performance on  train set...
12475/12475 - 180s - 180s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1578349
{'0': {'precision': 0.332658956410728, 'recall': 0.14411283057884164, 'f1-score': 0.20110428147797388, 'support': 1066803}, '1': {'precision': 0.3318926231930836, 'recall': 0.5022452239282202, 'f1-score': 0.3996737120393333, 'support': 1068713}, '2': {'precision': 0.3296305641432703, 'recall': 0.34711715936942117, 'f1-score': 0.33814794225785366, 'support': 1057568}, 'accuracy': 0.3312145875272934, 'macro avg': {'precision': 0.331394047915694, 'recall': 0.33115840462549434, 'f1-score': 0.3129753119250536, 'support': 3193084}, 'weighted avg': {'precision': 0.3313994464743972, 'recall': 0.3312145875272934, 'f1-score': 0.31295436812999367, 'support': 3193084}}
[[153740 542443 370620]
 [156006 536756 375951]
 [152409 538059 367100]]
Evaluating performance on  val set...
3866/3866 - 58s - 58s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.153404
{'0': {'precision': 0.3175051248445744, 'recall': 0.15039413195461435, 'f1-score': 0.20410764474727422, 'support': 314108}, '1': {'precision': 0.3435028603101894, 'recall': 0.4819291604307891, 'f1-score': 0.4011088518864526, 'support': 340770}, '2': {'precision': 0.33768305540375687, 'recall': 0.36596235986647685, 'f1-score': 0.35125443912690235, 'support': 334324}, 'accuracy': 0.3374609028287448, 'macro avg': {'precision': 0.3328970135195069, 'recall': 0.33276188408396007, 'f1-score': 0.31882364525354306, 'support': 989202}, 'weighted avg': {'precision': 0.3332806841043472, 'recall': 0.3374609028287448, 'f1-score': 0.32170425923146717, 'support': 989202}}
[[ 47240 151908 114960]
 [ 51531 164227 125012]
 [ 50014 161960 122350]]
testing model out of sample: results/universal/W7/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 209s - 209s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.140281
{'0': {'precision': 0.29435925905104565, 'recall': 0.15011539481511743, 'f1-score': 0.1988318389162351, 'support': 1116168}, '1': {'precision': 0.39224074613083065, 'recall': 0.4824623329238222, 'f1-score': 0.4326985693261453, 'support': 1488767}, '2': {'precision': 0.30832433785909413, 'recall': 0.36224939644770027, 'f1-score': 0.33311864030896926, 'support': 1169327}, 'accuracy': 0.34693298981363774, 'macro avg': {'precision': 0.3316414476803235, 'recall': 0.33160904139554664, 'f1-score': 0.3215496828504499, 'support': 3774262}, 'weighted avg': {'precision': 0.337295459977926, 'recall': 0.34693298981363774, 'f1-score': 0.3326853586889304, 'support': 3774262}}
[[167554 544585 404029]
 [224271 718274 546222]
 [177391 568348 423588]]
Evaluating performance on  train set...
5285/5285 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1618409
{'0': {'precision': 0.3346899246504025, 'recall': 0.1308129231011592, 'f1-score': 0.1881052611707851, 'support': 457042}, '1': {'precision': 0.331422010200355, 'recall': 0.5218054735184091, 'f1-score': 0.40537329672803185, 'support': 446952}, '2': {'precision': 0.3305982637021035, 'recall': 0.3465581341440582, 'f1-score': 0.338390120168059, 'support': 448652}, 'accuracy': 0.331567165392867, 'macro avg': {'precision': 0.3322367328509537, 'recall': 0.3330588435878755, 'f1-score': 0.31062289268895865, 'support': 1352646}, 'weighted avg': {'precision': 0.33225297309984614, 'recall': 0.331567165392867, 'f1-score': 0.30974387584692914, 'support': 1352646}}
[[ 59787 236650 160605]
 [ 59508 233222 154222]
 [ 59339 233829 155484]]
Evaluating performance on  val set...
1714/1714 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.159155
{'0': {'precision': 0.3284382541760651, 'recall': 0.14489002080593422, 'f1-score': 0.20107577762112155, 'support': 143709}, '1': {'precision': 0.3247459388282506, 'recall': 0.508022476948516, 'f1-score': 0.3962163624292003, 'support': 142724}, '2': {'precision': 0.3451282999920721, 'recall': 0.34458875601084427, 'f1-score': 0.34485831696730646, 'support': 151601}, 'accuracy': 0.3323235182657054, 'macro avg': {'precision': 0.33277083099879595, 'recall': 0.3325004179217648, 'f1-score': 0.3140501523392094, 'support': 438034}, 'weighted avg': {'precision': 0.33301151931085143, 'recall': 0.3323235182657054, 'f1-score': 0.31442045308825245, 'support': 438034}}
[[20822 73438 49449]
 [20542 72507 49675]
 [22033 77328 52240]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1379222
{'0': {'precision': 0.2727645611156686, 'recall': 0.14751255318719877, 'f1-score': 0.19147460311228026, 'support': 49589}, '1': {'precision': 0.40237646441268404, 'recall': 0.471872070736041, 'f1-score': 0.43436210149453636, 'support': 71477}, '2': {'precision': 0.31734141846501396, 'recall': 0.37553202715536954, 'f1-score': 0.34399316911279015, 'support': 56858}, 'accuracy': 0.35068343787235, 'macro avg': {'precision': 0.3308274813311222, 'recall': 0.3316388836928698, 'f1-score': 0.3232766245732022, 'support': 177924}, 'weighted avg': {'precision': 0.3390783859348602, 'recall': 0.35068343787235, 'f1-score': 0.33778859306037895, 'support': 177924}}
[[ 7315 23326 18948]
 [10765 33728 26984]
 [ 8738 26768 21352]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1557152
{'0': {'precision': 0.3275148824538392, 'recall': 0.13263596616679607, 'f1-score': 0.18880874825500235, 'support': 24473}, '1': {'precision': 0.34001881840241666, 'recall': 0.5645917276539758, 'f1-score': 0.4244297459355875, 'support': 24322}, '2': {'precision': 0.323010276971289, 'recall': 0.3020990474548511, 'f1-score': 0.31220489977728283, 'support': 23201}, 'accuracy': 0.3331712872937385, 'macro avg': {'precision': 0.330181325942515, 'recall': 0.333108913758541, 'f1-score': 0.3084811313226242, 'support': 71996}, 'weighted avg': {'precision': 0.3302873889589319, 'recall': 0.3331712872937385, 'f1-score': 0.30817215757018124, 'support': 71996}}
[[ 3246 13763  7464]
 [ 3364 13732  7226]
 [ 3301 12891  7009]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1548507
{'0': {'precision': 0.31907645722937167, 'recall': 0.14283293798712302, 'f1-score': 0.19733146067415733, 'support': 5902}, '1': {'precision': 0.3377588953797132, 'recall': 0.5072579358749402, 'f1-score': 0.4055087987758225, 'support': 6269}, '2': {'precision': 0.3413424275306154, 'recall': 0.34748303613697334, 'f1-score': 0.3443853612761964, 'support': 6337}, 'accuracy': 0.33634104171169227, 'macro avg': {'precision': 0.3327259267132334, 'recall': 0.3325246366663455, 'f1-score': 0.3157418735753921, 'support': 18508}, 'weighted avg': {'precision': 0.33302824340634773, 'recall': 0.33634104171169227, 'f1-score': 0.3181951034596804, 'support': 18508}}
[[ 843 2973 2086]
 [ 926 3180 2163]
 [ 873 3262 2202]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1719875
{'0': {'precision': 0.3624347636502378, 'recall': 0.14366115023981332, 'f1-score': 0.20576255845527228, 'support': 185144}, '1': {'precision': 0.29134892798008477, 'recall': 0.5053103595319954, 'f1-score': 0.3695974775029424, 'support': 150084}, '2': {'precision': 0.3447506123357827, 'recall': 0.3477277065950972, 'f1-score': 0.34623275992195496, 'support': 178102}, 'accuracy': 0.320199481814817, 'macro avg': {'precision': 0.3328447679887017, 'recall': 0.33223307212230196, 'f1-score': 0.30719759862672325, 'support': 513330}, 'weighted avg': {'precision': 0.335515570776012, 'recall': 0.320199481814817, 'f1-score': 0.30240024534668647, 'support': 513330}}
[[26598 93577 64969]
 [21505 75839 52740]
 [25284 90887 61931]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.165371
{'0': {'precision': 0.35378022650749924, 'recall': 0.11889478665185368, 'f1-score': 0.17797693290833222, 'support': 48606}, '1': {'precision': 0.32774212158361576, 'recall': 0.5097924845765563, 'f1-score': 0.39898165218154685, 'support': 44575}, '2': {'precision': 0.32577554128829506, 'recall': 0.38094057173775814, 'f1-score': 0.3512050133543955, 'support': 44356}, 'accuracy': 0.33009299315820473, 'macro avg': {'precision': 0.33576596312647, 'recall': 0.33654261432205607, 'f1-score': 0.30938786614809155, 'support': 137537}, 'weighted avg': {'precision': 0.3363098414869947, 'recall': 0.33009299315820473, 'f1-score': 0.30546982644148424, 'support': 137537}}
[[ 5779 24434 18393]
 [ 5274 22724 16577]
 [ 5282 22177 16897]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1429063
{'0': {'precision': 0.2992545260915868, 'recall': 0.1458603685439917, 'f1-score': 0.19612633048333625, 'support': 11559}, '1': {'precision': 0.3910637425701988, 'recall': 0.4925141972121838, 'f1-score': 0.4359648120644351, 'support': 15496}, '2': {'precision': 0.29776978417266187, 'recall': 0.34506044185077117, 'f1-score': 0.31967561305271286, 'support': 11995}, 'accuracy': 0.3446094750320102, 'macro avg': {'precision': 0.3293626842781492, 'recall': 0.3278116692023156, 'f1-score': 0.3172555852001614, 'support': 39050}, 'weighted avg': {'precision': 0.3352306116033683, 'recall': 0.3446094750320102, 'f1-score': 0.3292508056433972, 'support': 39050}}
[[1686 5735 4138]
 [2241 7632 5623]
 [1707 6149 4139]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1546284
{'0': {'precision': 0.3264392264420251, 'recall': 0.15084579173348509, 'f1-score': 0.2063420459068595, 'support': 77324}, '1': {'precision': 0.34416513745357485, 'recall': 0.48143553715963106, 'f1-score': 0.40138854755468173, 'support': 81419}, '2': {'precision': 0.3350052648860407, 'recall': 0.3735764248377566, 'f1-score': 0.35324104749795554, 'support': 79202}, 'accuracy': 0.33810334320956525, 'macro avg': {'precision': 0.3352032095938802, 'recall': 0.33528591791029094, 'f1-score': 0.3203238803198323, 'support': 237945}, 'weighted avg': {'precision': 0.335355880818004, 'recall': 0.33810334320956525, 'f1-score': 0.3219787932294846, 'support': 237945}}
[[11664 36985 28675]
 [12163 39198 30058]
 [11904 37710 29588]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1650789
{'0': {'precision': 0.33082064034815045, 'recall': 0.1325466263972351, 'f1-score': 0.18926308769589864, 'support': 32117}, '1': {'precision': 0.3298021007077492, 'recall': 0.45412787088764744, 'f1-score': 0.3821063902018646, 'support': 32220}, '2': {'precision': 0.33889343957107754, 'recall': 0.4114332208293153, 'f1-score': 0.37165684419703016, 'support': 33184}, 'accuracy': 0.3336922303914029, 'macro avg': {'precision': 0.33317206020899237, 'recall': 0.33270257270473264, 'f1-score': 0.3143421073649311, 'support': 97521}, 'weighted avg': {'precision': 0.33323109986148486, 'recall': 0.3336922303914029, 'f1-score': 0.31504077273271913, 'support': 97521}}
[[ 4257 14622 13238]
 [ 4192 14632 13396]
 [ 4419 15112 13653]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1494144
{'0': {'precision': 0.2957809694793537, 'recall': 0.15037079292641187, 'f1-score': 0.19937977460101355, 'support': 8765}, '1': {'precision': 0.3482439658910247, 'recall': 0.47779099742216935, 'f1-score': 0.4028590536699549, 'support': 10086}, '2': {'precision': 0.35528146155986273, 'recall': 0.3746332876980246, 'f1-score': 0.36470084249607304, 'support': 10226}, 'accuracy': 0.34281390789971455, 'macro avg': {'precision': 0.3331021323100804, 'recall': 0.3342650260155353, 'f1-score': 0.3223132235890138, 'support': 29077}, 'weighted avg': {'precision': 0.33490446274975294, 'recall': 0.34281390789971455, 'f1-score': 0.32810231299851744, 'support': 29077}}
[[1318 4212 3235]
 [1550 4819 3717]
 [1588 4807 3831]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.147885
{'0': {'precision': 0.2935579587532799, 'recall': 0.1495944915836697, 'f1-score': 0.19819208291253454, 'support': 80023}, '1': {'precision': 0.3415078223341126, 'recall': 0.4855855279979545, 'f1-score': 0.40099767736486486, 'support': 93864}, '2': {'precision': 0.3612593165804586, 'recall': 0.3599545491437383, 'f1-score': 0.36060575261713596, 'support': 98568}, 'accuracy': 0.341450881796994, 'macro avg': {'precision': 0.3321083658892837, 'recall': 0.3317115229084542, 'f1-score': 0.31993183763151184, 'support': 272455}, 'weighted avg': {'precision': 0.33457006509546716, 'recall': 0.341450881796994, 'f1-score': 0.3268185897232618, 'support': 272455}}
[[11971 39605 28447]
 [14000 45579 34285]
 [14808 48280 35480]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1568475
{'0': {'precision': 0.3387096774193548, 'recall': 0.14365036205958956, 'f1-score': 0.20174045862893664, 'support': 34939}, '1': {'precision': 0.3298671078226408, 'recall': 0.5341163310961968, 'f1-score': 0.4078490430326257, 'support': 33972}, '2': {'precision': 0.3286493736092907, 'recall': 0.3197414074315708, 'f1-score': 0.3241341991341991, 'support': 33721}, 'accuracy': 0.33075454049419284, 'macro avg': {'precision': 0.33240871961709545, 'recall': 0.3325027001957857, 'f1-score': 0.3112412335985872, 'support': 102632}, 'weighted avg': {'precision': 0.332477281294182, 'recall': 0.33075454049419284, 'f1-score': 0.3101779844779904, 'support': 102632}}
[[ 5019 18792 11128]
 [ 4930 18145 10897]
 [ 4869 18070 10782]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1552265
{'0': {'precision': 0.30117203850983676, 'recall': 0.15160134850400336, 'f1-score': 0.20168185003503852, 'support': 9492}, '1': {'precision': 0.32377617757811983, 'recall': 0.49266184157619625, 'f1-score': 0.3907514450867052, 'support': 9948}, '2': {'precision': 0.3853130995988139, 'recall': 0.369985763336404, 'f1-score': 0.37749391207758365, 'support': 11941}, 'accuracy': 0.3428189031579618, 'macro avg': {'precision': 0.33675377189559014, 'recall': 0.33808298447220125, 'f1-score': 0.32330906906644247, 'support': 31381}, 'weighted avg': {'precision': 0.34035480470322627, 'recall': 0.3428189031579618, 'f1-score': 0.32851771136590785, 'support': 31381}}
[[1439 4598 3455]
 [1454 4901 3593]
 [1885 5638 4418]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1293191
{'0': {'precision': 0.2639101502702365, 'recall': 0.1506518288659426, 'f1-score': 0.1918099044072569, 'support': 112146}, '1': {'precision': 0.425884249262492, 'recall': 0.468425424683195, 'f1-score': 0.446143022129004, 'support': 179369}, '2': {'precision': 0.30863039985998336, 'recall': 0.3804808507359174, 'f1-score': 0.3408098677830275, 'support': 129770}, 'accuracy': 0.35674424676881444, 'macro avg': {'precision': 0.3328082664642373, 'recall': 0.333186034761685, 'f1-score': 0.32625426477309616, 'support': 421285}, 'weighted avg': {'precision': 0.3466486264832594, 'recall': 0.35674424676881444, 'f1-score': 0.34599341969953123, 'support': 421285}}
[[16895 52448 42803]
 [27545 84021 67803]
 [19578 60817 49375]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1647956
{'0': {'precision': 0.3298282509638977, 'recall': 0.12475142516240223, 'f1-score': 0.18103116583301268, 'support': 45258}, '1': {'precision': 0.32762337757571314, 'recall': 0.5019097690302867, 'f1-score': 0.3964576326834852, 'support': 44508}, '2': {'precision': 0.327423575471124, 'recall': 0.3600169514207967, 'f1-score': 0.3429475943100572, 'support': 44834}, 'accuracy': 0.3278306092124814, 'macro avg': {'precision': 0.3282917346702449, 'recall': 0.3288927152044952, 'f1-score': 0.306812130942185, 'support': 134600}, 'weighted avg': {'precision': 0.32829819356564854, 'recall': 0.3278306092124814, 'f1-score': 0.3061987909512938, 'support': 134600}}
[[ 5646 22959 16653]
 [ 5666 22339 16503]
 [ 5806 22887 16141]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1494579
{'0': {'precision': 0.30879080118694363, 'recall': 0.146954986760812, 'f1-score': 0.1991388589881593, 'support': 11330}, '1': {'precision': 0.36160378372567986, 'recall': 0.4975227390371959, 'f1-score': 0.41881166547355975, 'support': 13523}, '2': {'precision': 0.33171024046745073, 'recall': 0.3544101168560909, 'f1-score': 0.34268467283210147, 'support': 12494}, 'accuracy': 0.3432939727421212, 'macro avg': {'precision': 0.3340349417933581, 'recall': 0.3329626142180329, 'f1-score': 0.3202117324312735, 'support': 37347}, 'weighted avg': {'precision': 0.33558131815596354, 'recall': 0.3432939727421212, 'f1-score': 0.32670189645484426, 'support': 37347}}
[[1665 5567 4098]
 [1972 6728 4823]
 [1755 6311 4428]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
5929/5929 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1915957
{'0': {'precision': 0.35593178374416923, 'recall': 0.12831686208423188, 'f1-score': 0.18863057232907413, 'support': 560168}, '1': {'precision': 0.29245886939085597, 'recall': 0.5252945531985335, 'f1-score': 0.37572952159383916, 'support': 447033}, '2': {'precision': 0.3206903882800172, 'recall': 0.3221512935662615, 'f1-score': 0.32141918091546123, 'support': 510372}, 'accuracy': 0.31044305611657563, 'macro avg': {'precision': 0.32302701380501414, 'recall': 0.3252542362830089, 'f1-score': 0.2952597582794582, 'support': 1517573}, 'weighted avg': {'precision': 0.3253825391227013, 'recall': 0.31044305611657563, 'f1-score': 0.28840237396769536, 'support': 1517573}}
[[ 71879 288454 199835]
 [ 63764 234824 148445]
 [ 66303 279652 164417]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1582025
{'0': {'precision': 0.32931873218610036, 'recall': 0.14566014843742595, 'f1-score': 0.20198209802710268, 'support': 105499}, '1': {'precision': 0.32403509297242267, 'recall': 0.5106164125018874, 'f1-score': 0.39647118734727227, 'support': 105968}, '2': {'precision': 0.3365262765560939, 'recall': 0.3298234719317632, 'f1-score': 0.3331411625257701, 'support': 109501}, 'accuracy': 0.32897983599611175, 'macro avg': {'precision': 0.32996003390487233, 'recall': 0.3287000109570255, 'f1-score': 0.31053148263338165, 'support': 320968}, 'weighted avg': {'precision': 0.33003324776355253, 'recall': 0.32897983599611175, 'f1-score': 0.31093896767999113, 'support': 320968}}
[[15367 55108 35024]
 [15679 54109 36180]
 [15617 57768 36116]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1648589
{'0': {'precision': 0.3451298701298701, 'recall': 0.1417711389703921, 'f1-score': 0.20098317262242388, 'support': 37490}, '1': {'precision': 0.30214055692365976, 'recall': 0.5348759221998659, 'f1-score': 0.3861517976031957, 'support': 32802}, '2': {'precision': 0.3568071176766829, 'recall': 0.3276805673321514, 'f1-score': 0.34162414111785266, 'support': 38919}, 'accuracy': 0.32609352537748026, 'macro avg': {'precision': 0.33469251491007096, 'recall': 0.3347758761674698, 'f1-score': 0.30958637044782406, 'support': 109211}, 'weighted avg': {'precision': 0.336379207151638, 'recall': 0.32609352537748026, 'f1-score': 0.30671892350368, 'support': 109211}}
[[ 5315 19817 12358]
 [ 4626 17545 10631]
 [ 5459 20707 12753]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1536103
{'0': {'precision': 0.3212739013591632, 'recall': 0.15131626873554427, 'f1-score': 0.2057341479871983, 'support': 439272}, '1': {'precision': 0.350116453454474, 'recall': 0.4700810870775581, 'f1-score': 0.4013255707566725, 'support': 477758}, '2': {'precision': 0.32827899336763156, 'recall': 0.3786530108853022, 'f1-score': 0.3516712456112684, 'support': 447576}, 'accuracy': 0.33748202777944697, 'macro avg': {'precision': 0.33322311606042293, 'recall': 0.33335012223280147, 'f1-score': 0.31957698811837976, 'support': 1364606}, 'weighted avg': {'precision': 0.33366947272901926, 'recall': 0.33748202777944697, 'f1-score': 0.3220778467293182, 'support': 1364606}}
[[ 66469 206802 166001]
 [ 72394 224585 180779]
 [ 68029 210071 169476]]
Evaluating performance on  train set...
2013/2013 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1640658
{'0': {'precision': 0.3438319030716928, 'recall': 0.12894130862117384, 'f1-score': 0.18754927069164817, 'support': 178050}, '1': {'precision': 0.3260945237319919, 'recall': 0.5210362954590309, 'f1-score': 0.40113540616323884, 'support': 167211}, '2': {'precision': 0.32966311958978883, 'recall': 0.35160628282103606, 'f1-score': 0.34028131500394115, 'support': 170051}, 'accuracy': 0.3296488341043872, 'macro avg': {'precision': 0.33319651546449114, 'recall': 0.33386129563374695, 'f1-score': 0.3096553306196094, 'support': 515312}, 'weighted avg': {'precision': 0.33340074537179065, 'recall': 0.3296488341043873, 'f1-score': 0.3072557556283271, 'support': 515312}}
[[22958 91634 63458]
 [21967 87123 58121]
 [21846 88414 59791]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1634632
{'0': {'precision': 0.3391620701795564, 'recall': 0.14359297106609914, 'f1-score': 0.20176398035884668, 'support': 60379}, '1': {'precision': 0.3150895593392855, 'recall': 0.51123716521864, 'f1-score': 0.3898832951161915, 'support': 55708}, '2': {'precision': 0.3463753852111199, 'recall': 0.34714271854079753, 'f1-score': 0.3467586273733858, 'support': 61842}, 'accuracy': 0.3294460149835047, 'macro avg': {'precision': 0.33354233824332064, 'recall': 0.3339909516085122, 'f1-score': 0.3128019676161413, 'support': 177929}, 'weighted avg': {'precision': 0.33413227961305025, 'recall': 0.3294460149835047, 'f1-score': 0.31105762977617213, 'support': 177929}}
[[ 8670 30581 21128]
 [ 7845 28480 19383]
 [ 9048 31326 21468]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
4192/4192 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.138149
{'0': {'precision': 0.28768815510713336, 'recall': 0.15016022851100322, 'f1-score': 0.19732547030924644, 'support': 310182}, '1': {'precision': 0.40119496867817744, 'recall': 0.47037420224823595, 'f1-score': 0.43303909691394227, 'support': 430115}, '2': {'precision': 0.3106042735546775, 'recall': 0.3797652417133089, 'f1-score': 0.3417204972554172, 'support': 332853}, 'accuracy': 0.3497162558822159, 'macro avg': {'precision': 0.3331624657799961, 'recall': 0.33343322415751603, 'f1-score': 0.32402835482620196, 'support': 1073150}, 'weighted avg': {'precision': 0.3402890793886691, 'recall': 0.3497162558822159, 'f1-score': 0.3365849255682433, 'support': 1073150}}
[[ 46577 145830 117775]
 [ 65013 202315 162787]
 [ 50311 156136 126406]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1522691
{'0': {'precision': 0.33805468194026767, 'recall': 0.13958955400729892, 'f1-score': 0.19759016745384284, 'support': 105495}, '1': {'precision': 0.3368361113986955, 'recall': 0.5487280393534786, 'f1-score': 0.417432026430305, 'support': 106725}, '2': {'precision': 0.3247916752185871, 'recall': 0.3083285434547527, 'f1-score': 0.31634606254154357, 'support': 102647}, 'accuracy': 0.33327722498705803, 'macro avg': {'precision': 0.3332274895191834, 'recall': 0.33221537893851005, 'f1-score': 0.31045608547523046, 'support': 314867}, 'weighted avg': {'precision': 0.333317888970507, 'recall': 0.33327722498705803, 'f1-score': 0.3108207021314373, 'support': 314867}}
[[14726 58252 32517]
 [14884 58563 33278]
 [13951 57047 31649]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1520051
{'0': {'precision': 0.31529621015186754, 'recall': 0.14164541012323673, 'f1-score': 0.19547469092605552, 'support': 32539}, '1': {'precision': 0.34964686967672787, 'recall': 0.5115080920647365, 'f1-score': 0.41536590079694413, 'support': 35714}, '2': {'precision': 0.3316280384397965, 'recall': 0.34516945163567897, 'f1-score': 0.33826327624978375, 'support': 33992}, 'accuracy': 0.33850066017898184, 'macro avg': {'precision': 0.3321903727561306, 'recall': 0.3327743179412174, 'f1-score': 0.3163679559909278, 'support': 102245}, 'weighted avg': {'precision': 0.33272445565467107, 'recall': 0.33850066017898184, 'f1-score': 0.3197532792350494, 'support': 102245}}
[[ 4609 16646 11284]
 [ 5083 18268 12363]
 [ 4926 17333 11733]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
6143/6143 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.130257
{'0': {'precision': 0.2762766448161894, 'recall': 0.1491080013795088, 'f1-score': 0.19368380455098347, 'support': 437837}, '1': {'precision': 0.4248284230562076, 'recall': 0.4962121212121212, 'f1-score': 0.4577540354065171, 'support': 678744}, '2': {'precision': 0.2828860925348634, 'recall': 0.33716806201074306, 'f1-score': 0.30765104915608205, 'support': 455921}, 'accuracy': 0.35345455840437723, 'macro avg': {'precision': 0.3279970534690868, 'recall': 0.3274960615341244, 'f1-score': 0.31969629637119423, 'support': 1572502}, 'weighted avg': {'precision': 0.3423128178595867, 'recall': 0.35345455840437723, 'f1-score': 0.34070819300925537, 'support': 1572502}}
[[ 65285 223442 149110]
 [101369 336801 240574]
 [ 69649 232550 153722]]
Evaluating performance on  train set...
2083/2083 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.158213
{'0': {'precision': 0.3288494442666963, 'recall': 0.13345075193063272, 'f1-score': 0.18985588139629203, 'support': 177144}, '1': {'precision': 0.3364473777087598, 'recall': 0.5334851783245939, 'f1-score': 0.41265196491144535, 'support': 178691}, '2': {'precision': 0.3337209955615484, 'recall': 0.3348648679121895, 'f1-score': 0.3342919532208503, 'support': 177382}, 'accuracy': 0.3345129656406304, 'macro avg': {'precision': 0.3330059391790015, 'recall': 0.33393359938913864, 'f1-score': 0.3122665998428626, 'support': 533217}, 'weighted avg': {'precision': 0.3330162428430343, 'recall': 0.3345129656406304, 'f1-score': 0.3125676746282971, 'support': 533217}}
[[23640 93828 59676]
 [24447 95329 58915]
 [23800 94183 59399]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.159993
{'0': {'precision': 0.32878863314311974, 'recall': 0.1497392426700155, 'f1-score': 0.2057667417669335, 'support': 57333}, '1': {'precision': 0.32288016624846627, 'recall': 0.5112184535685533, 'f1-score': 0.3957860506080417, 'support': 57138}, '2': {'precision': 0.34438091987370933, 'recall': 0.33242726763533326, 'f1-score': 0.3382985322346748, 'support': 60702}, 'accuracy': 0.33095282948856275, 'macro avg': {'precision': 0.33201657308843174, 'recall': 0.3311283212913007, 'f1-score': 0.31328377486988335, 'support': 175173}, 'weighted avg': {'precision': 0.3322645398621549, 'recall': 0.33095282948856275, 'f1-score': 0.31367302877198605, 'support': 175173}}
[[ 8585 29663 19085]
 [ 8597 29210 19331]
 [ 8929 31594 20179]]
testing model on single stock: results/universal/W7/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
23942/23942 - 346s - 346s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1326494
{'0': {'precision': 0.28842483319264706, 'recall': 0.151652387680551, 'f1-score': 0.19878472479552722, 'support': 1768683}, '1': {'precision': 0.42556411355255164, 'recall': 0.47470135502353134, 'f1-score': 0.44879175844055275, 'support': 2606523}, '2': {'precision': 0.2857231378541877, 'recall': 0.37333010996329236, 'f1-score': 0.32370389138481886, 'support': 1753858}, 'accuracy': 0.3524702956275216, 'macro avg': {'precision': 0.33323736153312883, 'recall': 0.33322795088912494, 'f1-score': 0.323760124873633, 'support': 6129064}, 'weighted avg': {'precision': 0.34597331016704636, 'recall': 0.3524702956275216, 'f1-score': 0.3408520230050899, 'support': 6129064}}
[[ 268225  837809  662649]
 [ 395003 1237320  974200]
 [ 266737  832353  654768]]
Evaluating performance on  train set...
9052/9052 - 127s - 127s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1578478
{'0': {'precision': 0.33352386144795504, 'recall': 0.14733821594687826, 'f1-score': 0.2043863013181896, 'support': 772264}, '1': {'precision': 0.3336612000966222, 'recall': 0.4939103994608173, 'f1-score': 0.39827064319855293, 'support': 777473}, '2': {'precision': 0.330117362726335, 'recall': 0.3549429655317114, 'f1-score': 0.3420803420263352, 'support': 767343}, 'accuracy': 0.33237911509313445, 'macro avg': {'precision': 0.3324341414236374, 'recall': 0.3320638603131356, 'f1-score': 0.3149124288476926, 'support': 2317080}, 'weighted avg': {'precision': 0.3324418203197468, 'recall': 0.33237911509313445, 'f1-score': 0.315042126414372, 'support': 2317080}}
[[113784 384639 273841]
 [114626 384002 278845]
 [112747 382233 272363]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1528292
{'0': {'precision': 0.3150746819103817, 'recall': 0.15322291371486987, 'f1-score': 0.20617940920938313, 'support': 223028}, '1': {'precision': 0.349061112597353, 'recall': 0.4705076779709088, 'f1-score': 0.4007862072059791, 'support': 246810}, '2': {'precision': 0.3353032227039455, 'recall': 0.3758216585185092, 'f1-score': 0.3544081119664212, 'support': 237477}, 'accuracy': 0.33867230300502604, 'macro avg': {'precision': 0.33314633907056007, 'recall': 0.3331840834014293, 'f1-score': 0.32045790946059444, 'support': 707315}, 'weighted avg': {'precision': 0.3337255010502056, 'recall': 0.33867230300502604, 'f1-score': 0.32385231513980023, 'support': 707315}}
[[ 34173 104810  84045]
 [ 37804 116126  92880]
 [ 36483 111745  89249]]
training model: results/universal/W7/deepLOB_L2/h1000
Epoch 1/50
12475/12475 - 512s - loss: 3.1691 - accuracy1000: 0.4375 - val_loss: 3.5965 - val_accuracy1000: 0.3237 - 512s/epoch - 41ms/step
Epoch 2/50
12475/12475 - 507s - loss: 3.1269 - accuracy1000: 0.4549 - val_loss: 3.9315 - val_accuracy1000: 0.3187 - 507s/epoch - 41ms/step
Epoch 3/50
12475/12475 - 509s - loss: 3.1005 - accuracy1000: 0.4646 - val_loss: 4.3517 - val_accuracy1000: 0.3172 - 509s/epoch - 41ms/step
Epoch 4/50
12475/12475 - 507s - loss: 3.0868 - accuracy1000: 0.4685 - val_loss: 4.2087 - val_accuracy1000: 0.3179 - 507s/epoch - 41ms/step
Epoch 5/50
12475/12475 - 507s - loss: 3.0799 - accuracy1000: 0.4703 - val_loss: 4.1967 - val_accuracy1000: 0.3177 - 507s/epoch - 41ms/step
Epoch 6/50
12475/12475 - 507s - loss: 3.0736 - accuracy1000: 0.4722 - val_loss: 3.7603 - val_accuracy1000: 0.3187 - 507s/epoch - 41ms/step
Epoch 7/50
12475/12475 - 508s - loss: 3.0660 - accuracy1000: 0.4738 - val_loss: 3.4377 - val_accuracy1000: 0.3246 - 508s/epoch - 41ms/step
Epoch 8/50
12475/12475 - 507s - loss: 3.0618 - accuracy1000: 0.4751 - val_loss: 3.4646 - val_accuracy1000: 0.3315 - 507s/epoch - 41ms/step
Epoch 9/50
12475/12475 - 510s - loss: 3.0562 - accuracy1000: 0.4768 - val_loss: 3.4988 - val_accuracy1000: 0.3219 - 510s/epoch - 41ms/step
Epoch 10/50
12475/12475 - 508s - loss: 3.0522 - accuracy1000: 0.4776 - val_loss: 3.4708 - val_accuracy1000: 0.3256 - 508s/epoch - 41ms/step
Epoch 11/50
12475/12475 - 507s - loss: 3.0480 - accuracy1000: 0.4789 - val_loss: 3.4783 - val_accuracy1000: 0.3313 - 507s/epoch - 41ms/step
Epoch 12/50
12475/12475 - 509s - loss: 3.0434 - accuracy1000: 0.4798 - val_loss: 3.5362 - val_accuracy1000: 0.3210 - 509s/epoch - 41ms/step
Epoch 13/50
12475/12475 - 509s - loss: 3.0408 - accuracy1000: 0.4806 - val_loss: 3.4950 - val_accuracy1000: 0.3291 - 509s/epoch - 41ms/step
Epoch 14/50
12475/12475 - 504s - loss: 3.0397 - accuracy1000: 0.4805 - val_loss: 3.5031 - val_accuracy1000: 0.3207 - 504s/epoch - 40ms/step
Epoch 15/50
12475/12475 - 508s - loss: 3.0367 - accuracy1000: 0.4813 - val_loss: 3.5324 - val_accuracy1000: 0.3237 - 508s/epoch - 41ms/step
Epoch 16/50
12475/12475 - 513s - loss: 3.0346 - accuracy1000: 0.4817 - val_loss: 3.5079 - val_accuracy1000: 0.3235 - 513s/epoch - 41ms/step
Epoch 17/50
12475/12475 - 512s - loss: 3.0319 - accuracy1000: 0.4826 - val_loss: 3.5353 - val_accuracy1000: 0.3242 - 512s/epoch - 41ms/step
testing model in sample: results/universal/W7/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 522s - 522s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1486973
{'0': {'precision': 0.31319458302988523, 'recall': 0.6369325429035251, 'f1-score': 0.41990975049125134, 'support': 3035648}, '1': {'precision': 0.35654815605971585, 'recall': 0.2886309365151652, 'f1-score': 0.3190147646773813, 'support': 3462827}, '2': {'precision': 0.34591538643346725, 'recall': 0.06083807738825851, 'f1-score': 0.10347706373240512, 'support': 3007097}, 'accuracy': 0.3278001576338594, 'macro avg': {'precision': 0.3385527085076894, 'recall': 0.3288005189356496, 'f1-score': 0.2808005263003459, 'support': 9505572}, 'weighted avg': {'precision': 0.3393393066705741, 'recall': 0.3278001576338594, 'f1-score': 0.2830504784668689, 'support': 9505572}}
[[1933503  916674  185471]
 [2302890  999479  160458]
 [1937095  887056  182946]]
Evaluating performance on  train set...
12475/12475 - 178s - 178s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1394467
{'0': {'precision': 0.3378243801785762, 'recall': 0.6814282286033021, 'f1-score': 0.45170955066617735, 'support': 1079267}, '1': {'precision': 0.3299828459308766, 'recall': 0.2751860092118848, 'f1-score': 0.3001035552587272, 'support': 1049948}, '2': {'precision': 0.3402044244512143, 'recall': 0.04492658400611353, 'f1-score': 0.07937155055668524, 'support': 1063869}, 'accuracy': 0.33577882698983175, 'macro avg': {'precision': 0.33600388352022237, 'recall': 0.33384694060710013, 'f1-score': 0.2770615521605299, 'support': 3193084}, 'weighted avg': {'precision': 0.3360389126243194, 'recall': 0.33577882698983175, 'f1-score': 0.27780329968607576, 'support': 3193084}}
[[735443 296560  47264]
 [715585 288931  45432]
 [725970 290103  47796]]
Evaluating performance on  val set...
3866/3866 - 54s - 54s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1445524
{'0': {'precision': 0.31667668103467556, 'recall': 0.6776613224854431, 'f1-score': 0.43164303830396045, 'support': 313425}, '1': {'precision': 0.3388683069161417, 'recall': 0.28194970565460087, 'f1-score': 0.30779976565126427, 'support': 334471}, '2': {'precision': 0.3408774373259053, 'recall': 0.04015751261331474, 'f1-score': 0.07185057429085172, 'support': 341306}, 'accuracy': 0.3239035101020823, 'macro avg': {'precision': 0.3321408084255742, 'recall': 0.3332561802511196, 'f1-score': 0.2704311260820255, 'support': 989202}, 'weighted avg': {'precision': 0.3325301858061321, 'recall': 0.3239035101020823, 'f1-score': 0.26562910993556044, 'support': 989202}}
[[212396  88107  12922]
 [226587  94304  13580]
 [231720  95880  13706]]
testing model out of sample: results/universal/W7/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 205s - 205s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1465775
{'0': {'precision': 0.27817566094138824, 'recall': 0.6812469667498462, 'f1-score': 0.3950424344190934, 'support': 1046732}, '1': {'precision': 0.4260072037281854, 'recall': 0.28056374447248106, 'f1-score': 0.3383161352857843, 'support': 1601080}, '2': {'precision': 0.3010212238059611, 'recall': 0.04178969328421146, 'f1-score': 0.07339080518010557, 'support': 1126450}, 'accuracy': 0.32042343642280263, 'macro avg': {'precision': 0.3350680294918449, 'recall': 0.33453346816884627, 'f1-score': 0.2689164582949944, 'support': 3774262}, 'weighted avg': {'precision': 0.3477056805356515, 'recall': 0.32042343642280263, 'f1-score': 0.27497980475199124, 'support': 3774262}}
[[ 713083  291027   42622]
 [1085190  449205   66685]
 [ 765154  314222   47074]]
Evaluating performance on  train set...
5285/5285 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.149742
{'0': {'precision': 0.3361831830664505, 'recall': 0.6402703503057119, 'f1-score': 0.4408773526488055, 'support': 459256}, '1': {'precision': 0.32393530387960934, 'recall': 0.282517761402361, 'f1-score': 0.3018122329011882, 'support': 446333}, '2': {'precision': 0.33412990057938996, 'recall': 0.06630474413777214, 'f1-score': 0.11065175233448618, 'support': 447057}, 'accuracy': 0.3325238088901309, 'macro avg': {'precision': 0.33141612917514995, 'recall': 0.3296976186152817, 'f1-score': 0.28444711262815997, 'support': 1352646}, 'weighted avg': {'precision': 0.3314631255126499, 'recall': 0.3325238088901309, 'f1-score': 0.2858486028561532, 'support': 1352646}}
[[294048 134667  30541]
 [291705 126097  28531]
 [288913 128502  29642]]
Evaluating performance on  val set...
1714/1714 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1496364
{'0': {'precision': 0.3291408946166286, 'recall': 0.6816304828195779, 'f1-score': 0.4439232687460228, 'support': 144816}, '1': {'precision': 0.30946792193815725, 'recall': 0.2682611506140918, 'f1-score': 0.2873949910484172, 'support': 136136}, '2': {'precision': 0.3654572564612326, 'recall': 0.046809946397423, 'f1-score': 0.08299003397252853, 'support': 157082}, 'accuracy': 0.3255089787550738, 'macro avg': {'precision': 0.3346886910053395, 'recall': 0.3322338599436976, 'f1-score': 0.27143609792232287, 'support': 438034}, 'weighted avg': {'precision': 0.33605005450539915, 'recall': 0.3255089787550738, 'f1-score': 0.2658429188249407, 'support': 438034}}
[[ 98711  39018   7087]
 [ 93936  36520   5680]
 [107258  42471   7353]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1485562
{'0': {'precision': 0.2824138334699065, 'recall': 0.6703250903028619, 'f1-score': 0.39739969408165665, 'support': 50386}, '1': {'precision': 0.3860017257609037, 'recall': 0.2851906052132083, 'f1-score': 0.32802539809514286, 'support': 69017}, '2': {'precision': 0.33101662578359226, 'recall': 0.041506467763708754, 'f1-score': 0.07376364657829607, 'support': 58521}, 'accuracy': 0.3141060227962501, 'macro avg': {'precision': 0.3331440616714675, 'recall': 0.33234072109325963, 'f1-score': 0.2663962462516985, 'support': 177924}, 'weighted avg': {'precision': 0.3385816892467379, 'recall': 0.3141060227962501, 'f1-score': 0.2640421317401772, 'support': 177924}}
[[33775 14569  2042]
 [46467 19683  2867]
 [39352 16740  2429]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1504188
{'0': {'precision': 0.34370352978007357, 'recall': 0.7099668579742947, 'f1-score': 0.46317732366512854, 'support': 24742}, '1': {'precision': 0.3448255981550879, 'recall': 0.24156872248475303, 'f1-score': 0.2841060231806954, 'support': 24759}, '2': {'precision': 0.327688399661304, 'recall': 0.0516114692153812, 'f1-score': 0.089177356171749, 'support': 22495}, 'accuracy': 0.34318573254069673, 'macro avg': {'precision': 0.3387391758654885, 'recall': 0.33438234989147636, 'f1-score': 0.278820234339191, 'support': 71996}, 'weighted avg': {'precision': 0.3390855084854914, 'recall': 0.34318573254069673, 'f1-score': 0.2847402494185364, 'support': 71996}}
[[17566  5950  1226]
 [17622  5981  1156]
 [15920  5414  1161]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1442779
{'0': {'precision': 0.31490328138460333, 'recall': 0.7022354173943416, 'f1-score': 0.4348202216815355, 'support': 5726}, '1': {'precision': 0.37079099422195655, 'recall': 0.2806514854471422, 'f1-score': 0.3194849785407725, 'support': 6631}, '2': {'precision': 0.32222222222222224, 'recall': 0.037717444317997076, 'f1-score': 0.06753019938873528, 'support': 6151}, 'accuracy': 0.33034363518478493, 'macro avg': {'precision': 0.33597216594292734, 'recall': 0.34020144905316024, 'f1-score': 0.27394513320368113, 'support': 18508}, 'weighted avg': {'precision': 0.33735898858779567, 'recall': 0.33034363518478493, 'f1-score': 0.2714320152632616, 'support': 18508}}
[[4021 1483  222]
 [4504 1861  266]
 [4244 1675  232]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1361111
{'0': {'precision': 0.394698848388083, 'recall': 0.6860993829165314, 'f1-score': 0.501115987190408, 'support': 203214}, '1': {'precision': 0.22423669588130835, 'recall': 0.27163984906969685, 'f1-score': 0.2456725281535728, 'support': 115285}, '2': {'precision': 0.3776309348996574, 'recall': 0.039598421195805596, 'f1-score': 0.07168042515829622, 'support': 194831}, 'accuracy': 0.3476438158689342, 'macro avg': {'precision': 0.3321888263896829, 'recall': 0.3324458843940113, 'f1-score': 0.2728229801674256, 'support': 513330}, 'weighted avg': {'precision': 0.34993799688007265, 'recall': 0.3476438158689342, 'f1-score': 0.2807584020865958, 'support': 513330}}
[[139425  55717   8072]
 [ 79326  31316   4643]
 [134493  52623   7715]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1416897
{'0': {'precision': 0.36197036965543866, 'recall': 0.5970865091842624, 'f1-score': 0.4507086685143874, 'support': 50249}, '1': {'precision': 0.2936306162395662, 'recall': 0.3069523495931135, 'f1-score': 0.30014373598574134, 'support': 42518}, '2': {'precision': 0.3279749068810037, 'recall': 0.0747375474648202, 'f1-score': 0.12173470130248128, 'support': 44770}, 'accuracy': 0.33736376393261447, 'macro avg': {'precision': 0.32785863092533624, 'recall': 0.32625880208073205, 'f1-score': 0.29086236860087006, 'support': 137537}, 'weighted avg': {'precision': 0.32977796685366517, 'recall': 0.33736376393261447, 'f1-score': 0.29707812318236754, 'support': 137537}}
[[30003 16437  3809]
 [26420 13051  3047]
 [26465 14959  3346]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.142775
{'0': {'precision': 0.3269073315965761, 'recall': 0.687377729086783, 'f1-score': 0.44308809806048066, 'support': 12779}, '1': {'precision': 0.3372574872857412, 'recall': 0.2754615384615385, 'f1-score': 0.3032432890168516, 'support': 13000}, '2': {'precision': 0.3412291933418694, 'recall': 0.04016276090724135, 'f1-score': 0.07186678352322524, 'support': 13271}, 'accuracy': 0.3302944942381562, 'macro avg': {'precision': 0.3351313374080622, 'recall': 0.3343340094851876, 'f1-score': 0.2727327235335192, 'support': 39050}, 'weighted avg': {'precision': 0.33522019846420564, 'recall': 0.3302944942381562, 'f1-score': 0.2703746388340762, 'support': 39050}}
[[8784 3495  500]
 [8890 3581  529]
 [9196 3542  533]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1406378
{'0': {'precision': 0.32199454742371997, 'recall': 0.6747316386023035, 'f1-score': 0.43594702667627366, 'support': 76669}, '1': {'precision': 0.34791555634511756, 'recall': 0.28360244249752614, 'f1-score': 0.3124842102463867, 'support': 82866}, '2': {'precision': 0.32929458876681383, 'recall': 0.04090039535773498, 'f1-score': 0.07276316237280059, 'support': 78410}, 'accuracy': 0.32965181029229446, 'macro avg': {'precision': 0.33306823084521714, 'recall': 0.3330781588191882, 'f1-score': 0.2737314664318203, 'support': 237945}, 'weighted avg': {'precision': 0.333427301072641, 'recall': 0.32965181029229446, 'f1-score': 0.2732702881597495, 'support': 237945}}
[[51731 21753  3185]
 [56018 23501  3347]
 [52909 22294  3207]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.147993
{'0': {'precision': 0.32140995240737935, 'recall': 0.595797743001434, 'f1-score': 0.4175615298063163, 'support': 32078}, '1': {'precision': 0.3304701066732821, 'recall': 0.33090107433397503, 'f1-score': 0.3306854500884352, 'support': 32206}, '2': {'precision': 0.3013769363166954, 'recall': 0.052682251707434485, 'f1-score': 0.08968678771736627, 'support': 33237}, 'accuracy': 0.3232124362957722, 'macro avg': {'precision': 0.31775233179911894, 'recall': 0.32646035634761444, 'f1-score': 0.27931125587070593, 'support': 97521}, 'weighted avg': {'precision': 0.3175744090114092, 'recall': 0.3232124362957722, 'f1-score': 0.27712507174903106, 'support': 97521}}
[[19112 10780  2186]
 [19676 10657  1873]
 [20675 10811  1751]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1504325
{'0': {'precision': 0.3048675041961243, 'recall': 0.6812137742925333, 'f1-score': 0.42122276879831344, 'support': 8799}, '1': {'precision': 0.3286935286935287, 'recall': 0.28339825244762606, 'f1-score': 0.3043699474249533, 'support': 9499}, '2': {'precision': 0.36867862969004894, 'recall': 0.04193338899712404, 'f1-score': 0.07530195751770095, 'support': 10779}, 'accuracy': 0.3142690098703443, 'macro avg': {'precision': 0.33407988752656737, 'recall': 0.33551513857909443, 'f1-score': 0.26696489124698924, 'support': 29077}, 'weighted avg': {'precision': 0.3363062196206818, 'recall': 0.3142690098703443, 'f1-score': 0.25481408237883174, 'support': 29077}}
[[5994 2449  356]
 [6389 2692  418]
 [7278 3049  452]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1580353
{'0': {'precision': 0.2806199038824991, 'recall': 0.6818336875803616, 'f1-score': 0.3976006855184233, 'support': 76218}, '1': {'precision': 0.3519964250979155, 'recall': 0.280860345858196, 'f1-score': 0.312430370443821, 'support': 95357}, '2': {'precision': 0.37248412201449144, 'recall': 0.04127676447264076, 'f1-score': 0.0743179932000107, 'support': 100880}, 'accuracy': 0.30432181461158725, 'macro avg': {'precision': 0.33503348366496866, 'recall': 0.33465693263706614, 'f1-score': 0.26144968305408495, 'support': 272455}, 'weighted avg': {'precision': 0.33961501595125854, 'recall': 0.30432181461158725, 'f1-score': 0.24809216581553542, 'support': 272455}}
[[51968 21154  3096]
 [64656 26782  3919]
 [68566 28150  4164]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1382278
{'0': {'precision': 0.34978624717091844, 'recall': 0.6998658243417006, 'f1-score': 0.4664468291228855, 'support': 35774}, '1': {'precision': 0.3307945890644538, 'recall': 0.25738545904829296, 'f1-score': 0.2895090285032084, 'support': 33918}, '2': {'precision': 0.31589105725927513, 'recall': 0.04471766848816029, 'f1-score': 0.07834481291386326, 'support': 32940}, 'accuracy': 0.3433626938966404, 'macro avg': {'precision': 0.3321572978315491, 'recall': 0.3339896506260513, 'f1-score': 0.27810022351331903, 'support': 102632}, 'weighted avg': {'precision': 0.332631104375839, 'recall': 0.3433626938966404, 'f1-score': 0.2834097964689043, 'support': 102632}}
[[25037  9070  1667]
 [23665  8730  1523]
 [22876  8591  1473]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.155896
{'0': {'precision': 0.3049200433982735, 'recall': 0.6680446465481604, 'f1-score': 0.4187206477732794, 'support': 9676}, '1': {'precision': 0.29768171127785864, 'recall': 0.2807647618041618, 'f1-score': 0.28897586431833006, 'support': 9467}, '2': {'precision': 0.38148443735035914, 'recall': 0.039058669717274064, 'f1-score': 0.07086205618560522, 'support': 12238}, 'accuracy': 0.30591759344826486, 'macro avg': {'precision': 0.32802873067549715, 'recall': 0.3292893593565321, 'f1-score': 0.2595195227590716, 'support': 31381}, 'weighted avg': {'precision': 0.33259506213577883, 'recall': 0.30591759344826486, 'f1-score': 0.24392101395606636, 'support': 31381}}
[[6464 2788  424]
 [6458 2658  351]
 [8277 3483  478]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
1646/1646 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1505799
{'0': {'precision': 0.2577979347014727, 'recall': 0.6698779232240035, 'f1-score': 0.37231354817284235, 'support': 108784}, '1': {'precision': 0.4189966257187879, 'recall': 0.28614973744112143, 'f1-score': 0.34005925777130513, 'support': 177484}, '2': {'precision': 0.32350744124576225, 'recall': 0.04169845278742677, 'f1-score': 0.07387481957748326, 'support': 135017}, 'accuracy': 0.30689200897254826, 'macro avg': {'precision': 0.33343400055534095, 'recall': 0.3325753711508506, 'f1-score': 0.2620825418405435, 'support': 421285}, 'weighted avg': {'precision': 0.3467687950967099, 'recall': 0.30689200897254826, 'f1-score': 0.26307889159502446, 'support': 421285}}
[[ 72872  31564   4348]
 [119272  50787   7425]
 [ 90527  38860   5630]]
Evaluating performance on  train set...
526/526 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1522293
{'0': {'precision': 0.33241764775835414, 'recall': 0.6197179976056401, 'f1-score': 0.43272237530573704, 'support': 45106}, '1': {'precision': 0.3438377765732026, 'recall': 0.30903977323057846, 'f1-score': 0.3255114179748548, 'support': 45156}, '2': {'precision': 0.33121725110842404, 'recall': 0.07413505345301999, 'f1-score': 0.12115292469868419, 'support': 44338}, 'accuracy': 0.33577265973254083, 'macro avg': {'precision': 0.33582422514666027, 'recall': 0.33429760809641285, 'f1-score': 0.293128905993092, 'support': 134600}, 'weighted avg': {'precision': 0.33585348839801754, 'recall': 0.33577265973254083, 'f1-score': 0.29412219484326424, 'support': 134600}}
[[27953 13654  3499]
 [28063 13955  3138]
 [28074 12977  3287]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1492364
{'0': {'precision': 0.2933007180620216, 'recall': 0.672334267884598, 'f1-score': 0.40842787682333875, 'support': 11057}, '1': {'precision': 0.3521018864311022, 'recall': 0.2735049092531985, 'f1-score': 0.3078662033742203, 'support': 13444}, '2': {'precision': 0.34017971758664955, 'recall': 0.0412579791374747, 'f1-score': 0.0735906692585393, 'support': 12846}, 'accuracy': 0.3116983961228479, 'macro avg': {'precision': 0.3285274406932578, 'recall': 0.32903238542509045, 'f1-score': 0.2632949164853661, 'support': 37347}, 'weighted avg': {'precision': 0.33059234886094224, 'recall': 0.31169839612284794, 'f1-score': 0.2570564171016111, 'support': 37347}}
[[7434 3139  484]
 [9223 3677  544]
 [8689 3627  530]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
5929/5929 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.195909
{'0': {'precision': 0.3995126860804864, 'recall': 0.49084106960913276, 'f1-score': 0.4404928555757649, 'support': 634026}, '1': {'precision': 0.19654144860596354, 'recall': 0.3339134341865035, 'f1-score': 0.2474398188910005, 'support': 316037}, '2': {'precision': 0.4115054120657084, 'recall': 0.14623883279589786, 'f1-score': 0.21579091744681736, 'support': 567510}, 'accuracy': 0.3292935496348446, 'macro avg': {'precision': 0.3358531822507194, 'recall': 0.3236644455305114, 'f1-score': 0.3012411973045276, 'support': 1517573}, 'weighted avg': {'precision': 0.3617283890128247, 'recall': 0.3292935496348446, 'f1-score': 0.31625995247172844, 'support': 1517573}}
[[311206 235440  87380]
 [179201 105529  31307]
 [288557 195961  82992]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1448541
{'0': {'precision': 0.3310754208814866, 'recall': 0.6939881424417507, 'f1-score': 0.4482891101909391, 'support': 105924}, '1': {'precision': 0.3365427465697197, 'recall': 0.2697314622477465, 'f1-score': 0.29945580999786087, 'support': 106391}, '2': {'precision': 0.3549473067915691, 'recall': 0.04463751576118469, 'f1-score': 0.07930214115781126, 'support': 108653}, 'accuracy': 0.3335441539343486, 'macro avg': {'precision': 0.34085515808092515, 'recall': 0.33611904015022726, 'f1-score': 0.27568235378220374, 'support': 320968}, 'weighted avg': {'precision': 0.3409687007943907, 'recall': 0.3335441539343486, 'f1-score': 0.27404723939011716, 'support': 320968}}
[[73510 28023  4391]
 [73271 28697  4423]
 [75253 28550  4850]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1478875
{'0': {'precision': 0.32500692036961365, 'recall': 0.6934608353255519, 'f1-score': 0.4425855786318189, 'support': 35555}, '1': {'precision': 0.3297327239994461, 'recall': 0.26519644696906414, 'f1-score': 0.2939642267388922, 'support': 35913}, '2': {'precision': 0.34699820788530467, 'recall': 0.04104072278303261, 'f1-score': 0.0734001468950648, 'support': 37743}, 'accuracy': 0.3271556894452024, 'macro avg': {'precision': 0.33391261741812145, 'recall': 0.3332326683592162, 'f1-score': 0.26998331742192533, 'support': 109211}, 'weighted avg': {'precision': 0.3341610802112312, 'recall': 0.3271556894452024, 'f1-score': 0.2661234607080659, 'support': 109211}}
[[24656  9445  1454]
 [24928  9524  1461]
 [26279  9915  1549]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
5331/5331 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1423279
{'0': {'precision': 0.2414610824666397, 'recall': 0.6719541722545528, 'f1-score': 0.3552618175839072, 'support': 329582}, '1': {'precision': 0.5027371843037431, 'recall': 0.2863493838051235, 'f1-score': 0.36487373821686536, 'support': 686958}, '2': {'precision': 0.25455516965001335, 'recall': 0.04106117805243833, 'f1-score': 0.07071554213022406, 'support': 348066}, 'accuracy': 0.3169163846560839, 'macro avg': {'precision': 0.33291781214013205, 'recall': 0.3331215780373715, 'f1-score': 0.2636170326436655, 'support': 1364606}, 'weighted avg': {'precision': 0.3763302790811798, 'recall': 0.3169163846560839, 'f1-score': 0.28752219300517456, 'support': 1364606}}
[[221464  94446  13672]
 [462067 196710  28181]
 [233652 100122  14292]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1502359
{'0': {'precision': 0.34373832538543886, 'recall': 0.6110794852046568, 'f1-score': 0.4399822386887169, 'support': 179178}, '1': {'precision': 0.3092979247631385, 'recall': 0.29099479630304514, 'f1-score': 0.2998673262389297, 'support': 167381}, '2': {'precision': 0.3428745897259751, 'recall': 0.07985635810918917, 'f1-score': 0.1295420463721306, 'support': 168753}, 'accuracy': 0.33314768528580746, 'macro avg': {'precision': 0.3319702799581841, 'recall': 0.3273102132056304, 'f1-score': 0.2897972037665924, 'support': 515312}, 'weighted avg': {'precision': 0.3322687173027574, 'recall': 0.33314768528580746, 'f1-score': 0.29280870511146906, 'support': 515312}}
[[109492  56660  13026]
 [105873  48707  12801]
 [103168  52109  13476]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1434319
{'0': {'precision': 0.36068638687703725, 'recall': 0.6889848141362069, 'f1-score': 0.47349578226791794, 'support': 64402}, '1': {'precision': 0.2514170971992721, 'recall': 0.26630037441566784, 'f1-score': 0.25864480451014565, 'support': 45137}, '2': {'precision': 0.37582758134948585, 'recall': 0.039011551396402985, 'f1-score': 0.07068579528143173, 'support': 68390}, 'accuracy': 0.3319301519145277, 'macro avg': {'precision': 0.3293103551419317, 'recall': 0.3314322466494259, 'f1-score': 0.2676087940198318, 'support': 177929}, 'weighted avg': {'precision': 0.3387867435461888, 'recall': 0.3319301519145277, 'f1-score': 0.26416563601262305, 'support': 177929}}
[[44372 17401  2629]
 [31315 12020  1802]
 [47334 18388  2668]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
4192/4192 - 59s - 59s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1437024
{'0': {'precision': 0.29226396440929314, 'recall': 0.672100263430989, 'f1-score': 0.4073786268716802, 'support': 313175}, '1': {'precision': 0.3890291038804094, 'recall': 0.2887063694527863, 'f1-score': 0.3314425306392846, 'support': 415907}, '2': {'precision': 0.32187591685662054, 'recall': 0.04145110850180778, 'f1-score': 0.0734441019936814, 'support': 344068}, 'accuracy': 0.3213176163630434, 'macro avg': {'precision': 0.334389661715441, 'recall': 0.3340859137951944, 'f1-score': 0.2707550865015487, 'support': 1073150}, 'weighted avg': {'precision': 0.33926002657829146, 'recall': 0.3213176163630434, 'f1-score': 0.27088462502529315, 'support': 1073150}}
[[210485  89838  12852]
 [278637 120075  17195]
 [231066  98740  14262]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1371218
{'0': {'precision': 0.346053514198405, 'recall': 0.6833028265528565, 'f1-score': 0.45943146222374776, 'support': 108719}, '1': {'precision': 0.33054039133901736, 'recall': 0.26298374896295934, 'f1-score': 0.29291732347665383, 'support': 102455}, '2': {'precision': 0.3502141327623126, 'recall': 0.0630900832264473, 'f1-score': 0.10691900991231726, 'support': 103693}, 'accuracy': 0.342284202536309, 'macro avg': {'precision': 0.3422693460999116, 'recall': 0.3364588862474211, 'f1-score': 0.28642259853757296, 'support': 314867}, 'weighted avg': {'precision': 0.3423758662333553, 'recall': 0.342284202536309, 'f1-score': 0.2891586810086231, 'support': 314867}}
[[74288 28041  6390]
 [69763 26944  5748]
 [70621 26530  6542]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1451021
{'0': {'precision': 0.3233397122404139, 'recall': 0.6922820115936751, 'f1-score': 0.44079850039615825, 'support': 32949}, '1': {'precision': 0.33632173060868936, 'recall': 0.2687043266442408, 'f1-score': 0.2987345853147417, 'support': 34484}, '2': {'precision': 0.3408050132562063, 'recall': 0.04061817763989429, 'f1-score': 0.07258540591873926, 'support': 34812}, 'accuracy': 0.32754657929483105, 'macro avg': {'precision': 0.3334888187017699, 'recall': 0.33386817195927004, 'f1-score': 0.2707061638765464, 'support': 102245}, 'weighted avg': {'precision': 0.3336646570335419, 'recall': 0.32754657929483105, 'f1-score': 0.26751700699681863, 'support': 102245}}
[[22810  8787  1352]
 [23835  9266  1383]
 [23900  9498  1414]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
6143/6143 - 90s - 90s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1500883
{'0': {'precision': 0.3075532564744703, 'recall': 0.6924857316786859, 'f1-score': 0.4259358772265562, 'support': 481311}, '1': {'precision': 0.37531393987461287, 'recall': 0.27191045822609466, 'f1-score': 0.3153520963345012, 'support': 584755}, '2': {'precision': 0.3291728076639646, 'recall': 0.0423370376513518, 'f1-score': 0.07502466880812916, 'support': 506436}, 'accuracy': 0.3267041949708172, 'macro avg': {'precision': 0.33734666800434926, 'recall': 0.3355777425187108, 'f1-score': 0.2721042141230622, 'support': 1572502}, 'weighted avg': {'precision': 0.3397136718175688, 'recall': 0.3267041949708172, 'f1-score': 0.27180031012258543, 'support': 1572502}}
[[333301 128915  19095]
 [401154 159001  24600]
 [349263 135732  21441]]
Evaluating performance on  train set...
2083/2083 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1486835
{'0': {'precision': 0.3335366914100996, 'recall': 0.6782073734788271, 'f1-score': 0.44716258051861296, 'support': 178152}, '1': {'precision': 0.3342190666496606, 'recall': 0.2667349050788606, 'f1-score': 0.29668791691958346, 'support': 176831}, '2': {'precision': 0.3217493297587131, 'recall': 0.053867387816017145, 'f1-score': 0.09228447571537049, 'support': 178234}, 'accuracy': 0.3330576481995135, 'macro avg': {'precision': 0.32983502927282443, 'recall': 0.33293655545790163, 'f1-score': 0.2787116577178556, 'support': 533217}, 'weighted avg': {'precision': 0.329822924743646, 'recall': 0.3330576481995135, 'f1-score': 0.2786384536239695, 'support': 533217}}
[[120824  46835  10493]
 [119918  47167   9746]
 [121509  47124   9601]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1544939
{'0': {'precision': 0.3104768126502341, 'recall': 0.6760650714911001, 'f1-score': 0.42553191489361697, 'support': 54832}, '1': {'precision': 0.3521056403796451, 'recall': 0.26393162393162395, 'f1-score': 0.3017084155283433, 'support': 61425}, '2': {'precision': 0.36288914003904243, 'recall': 0.059949758978885194, 'f1-score': 0.10290026074669696, 'support': 58916}, 'accuracy': 0.3243308044047884, 'macro avg': {'precision': 0.3418238643563072, 'recall': 0.3333154848005364, 'f1-score': 0.27671353038955243, 'support': 175173}, 'weighted avg': {'precision': 0.3427019582132952, 'recall': 0.3243308044047884, 'f1-score': 0.27360196573346174, 'support': 175173}}
[[37070 14291  3471]
 [42483 16212  2730]
 [39844 15540  3532]]
testing model on single stock: results/universal/W7/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
23942/23942 - 342s - 342s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1387242
{'0': {'precision': 0.2952134997467044, 'recall': 0.6748705787403643, 'f1-score': 0.4107497686937505, 'support': 1809015}, '1': {'precision': 0.4109588962487354, 'recall': 0.2841605227436583, 'f1-score': 0.3359949142363848, 'support': 2520241}, '2': {'precision': 0.2940463855901809, 'recall': 0.040997706422018346, 'f1-score': 0.07196203531589448, 'support': 1799808}, 'accuracy': 0.328074890391094, 'macro avg': {'precision': 0.3334062605285402, 'recall': 0.3333429359686803, 'f1-score': 0.27290223941534325, 'support': 6129064}, 'weighted avg': {'precision': 0.34246471337897366, 'recall': 0.328074890391094, 'f1-score': 0.28052546005742074, 'support': 6129064}}
[[1220851  514383   73781]
 [1700717  716153  103371]
 [1213917  512103   73788]]
Evaluating performance on  train set...
9052/9052 - 131s - 131s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1388109
{'0': {'precision': 0.3360821501743968, 'recall': 0.6838688879156333, 'f1-score': 0.4506807046707907, 'support': 778601}, '1': {'precision': 0.33123951593109474, 'recall': 0.27708960513479086, 'f1-score': 0.30175450589499453, 'support': 764666}, '2': {'precision': 0.33243466772644764, 'recall': 0.039996743399245034, 'f1-score': 0.07140269969108816, 'support': 773813}, 'accuracy': 0.3345987190774596, 'macro avg': {'precision': 0.333252111277313, 'recall': 0.33365174548322307, 'f1-score': 0.27461263675229114, 'support': 2317080}, 'weighted avg': {'precision': 0.33326590425635183, 'recall': 0.3345987190774596, 'f1-score': 0.2748693163801613, 'support': 2317080}}
[[532461 214806  31334]
 [521968 211881  30817]
 [529889 212974  30950]]
Evaluating performance on  val set...
2763/2763 - 39s - 39s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1434233
{'0': {'precision': 0.31439421003744816, 'recall': 0.6724937743295605, 'f1-score': 0.42847446171118275, 'support': 222466}, '1': {'precision': 0.3428540345949581, 'recall': 0.2869701622883443, 'f1-score': 0.3124328294651367, 'support': 241607}, '2': {'precision': 0.34179467004207864, 'recall': 0.04107432104652979, 'f1-score': 0.07333570665717336, 'support': 243242}, 'accuracy': 0.32366343142729903, 'macro avg': {'precision': 0.33301430489149497, 'recall': 0.33351275255481155, 'f1-score': 0.27141433261116427, 'support': 707315}, 'weighted avg': {'precision': 0.33353848878781067, 'recall': 0.32366343142729903, 'f1-score': 0.2667061806780959, 'support': 707315}}
[[149607  63622   9237]
 [162270  69334  10003]
 [163981  69270   9991]]
training model: results/universal/W7/deepOF_L2/h300
Epoch 1/50
12475/12475 - 288s - loss: 3.2734 - accuracy300: 0.3749 - val_loss: 3.3009 - val_accuracy300: 0.3450 - 288s/epoch - 23ms/step
Epoch 2/50
12475/12475 - 285s - loss: 3.2638 - accuracy300: 0.3811 - val_loss: 3.2887 - val_accuracy300: 0.3567 - 285s/epoch - 23ms/step
Epoch 3/50
12475/12475 - 279s - loss: 3.2584 - accuracy300: 0.3851 - val_loss: 3.2863 - val_accuracy300: 0.3588 - 279s/epoch - 22ms/step
Epoch 4/50
12475/12475 - 284s - loss: 3.2551 - accuracy300: 0.3876 - val_loss: 3.2845 - val_accuracy300: 0.3609 - 284s/epoch - 23ms/step
Epoch 5/50
12475/12475 - 280s - loss: 3.2529 - accuracy300: 0.3890 - val_loss: 3.2829 - val_accuracy300: 0.3629 - 280s/epoch - 22ms/step
Epoch 6/50
12475/12475 - 281s - loss: 3.2511 - accuracy300: 0.3903 - val_loss: 3.2824 - val_accuracy300: 0.3629 - 281s/epoch - 22ms/step
Epoch 7/50
12475/12475 - 279s - loss: 3.2494 - accuracy300: 0.3915 - val_loss: 3.2834 - val_accuracy300: 0.3638 - 279s/epoch - 22ms/step
Epoch 8/50
12475/12475 - 277s - loss: 3.2477 - accuracy300: 0.3925 - val_loss: 3.2838 - val_accuracy300: 0.3624 - 277s/epoch - 22ms/step
Epoch 9/50
12475/12475 - 280s - loss: 3.2463 - accuracy300: 0.3935 - val_loss: 3.2818 - val_accuracy300: 0.3644 - 280s/epoch - 22ms/step
Epoch 10/50
12475/12475 - 276s - loss: 3.2450 - accuracy300: 0.3943 - val_loss: 3.2831 - val_accuracy300: 0.3641 - 276s/epoch - 22ms/step
Epoch 11/50
12475/12475 - 278s - loss: 3.2438 - accuracy300: 0.3952 - val_loss: 3.2830 - val_accuracy300: 0.3643 - 278s/epoch - 22ms/step
Epoch 12/50
12475/12475 - 279s - loss: 3.2426 - accuracy300: 0.3962 - val_loss: 3.2840 - val_accuracy300: 0.3625 - 279s/epoch - 22ms/step
Epoch 13/50
12475/12475 - 286s - loss: 3.2413 - accuracy300: 0.3970 - val_loss: 3.2837 - val_accuracy300: 0.3631 - 286s/epoch - 23ms/step
Epoch 14/50
12475/12475 - 279s - loss: 3.2400 - accuracy300: 0.3979 - val_loss: 3.2849 - val_accuracy300: 0.3621 - 279s/epoch - 22ms/step
Epoch 15/50
12475/12475 - 276s - loss: 3.2387 - accuracy300: 0.3989 - val_loss: 3.2849 - val_accuracy300: 0.3629 - 276s/epoch - 22ms/step
Epoch 16/50
12475/12475 - 276s - loss: 3.2374 - accuracy300: 0.3997 - val_loss: 3.2852 - val_accuracy300: 0.3616 - 276s/epoch - 22ms/step
Epoch 17/50
12475/12475 - 279s - loss: 3.2364 - accuracy300: 0.4003 - val_loss: 3.2861 - val_accuracy300: 0.3623 - 279s/epoch - 22ms/step
Epoch 18/50
12475/12475 - 275s - loss: 3.2349 - accuracy300: 0.4014 - val_loss: 3.2872 - val_accuracy300: 0.3608 - 275s/epoch - 22ms/step
Epoch 19/50
12475/12475 - 275s - loss: 3.2339 - accuracy300: 0.4021 - val_loss: 3.2867 - val_accuracy300: 0.3622 - 275s/epoch - 22ms/step
testing model in sample: results/universal/W7/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 288s - 288s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0864236
{'0': {'precision': 0.3451930173103691, 'recall': 0.3116360758693006, 'f1-score': 0.32755734619282745, 'support': 2845736}, '1': {'precision': 0.4140261098111436, 'recall': 0.5152434133118382, 'f1-score': 0.45912239820886436, 'support': 3845825}, '2': {'precision': 0.33584894956087935, 'recall': 0.2566540842776048, 'f1-score': 0.2909588632710367, 'support': 2813986}, 'accuracy': 0.37773638907892415, 'macro avg': {'precision': 0.36502269222746403, 'recall': 0.3611778578195812, 'f1-score': 0.35921286922424284, 'support': 9505547}, 'weighted avg': {'precision': 0.37027584022804816, 'recall': 0.37773638907892415, 'f1-score': 0.36995243903771236, 'support': 9505547}}
[[ 886834 1390982  567920]
 [1003996 1981536  860293]
 [ 678266 1413499  722221]]
Evaluating performance on  train set...
12475/12475 - 100s - 100s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944114
{'0': {'precision': 0.37711169172508446, 'recall': 0.3613432542509903, 'f1-score': 0.3690591190337919, 'support': 1073691}, '1': {'precision': 0.34785851645203564, 'recall': 0.4744770801935095, 'f1-score': 0.4014197947404443, 'support': 1055659}, '2': {'precision': 0.36945672716529837, 'recall': 0.2515896921017403, 'f1-score': 0.29933834685702176, 'support': 1063728}, 'accuracy': 0.3621834480711088, 'macro avg': {'precision': 0.36480897844747284, 'recall': 0.3624700088487467, 'f1-score': 0.3566057535437526, 'support': 3193078}, 'weighted avg': {'precision': 0.3648901995169944, 'recall': 0.3621834480711088, 'f1-score': 0.356531363999232, 'support': 3193078}}
[[387971 464392 221328]
 [319355 500886 235418]
 [321470 474635 267623]]
Evaluating performance on  val set...
3866/3866 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938125
{'0': {'precision': 0.35575811852889627, 'recall': 0.38112910018397195, 'f1-score': 0.3680068486868254, 'support': 315809}, '1': {'precision': 0.367051275065388, 'recall': 0.47155782939947966, 'f1-score': 0.4127928056745702, 'support': 342836}, '2': {'precision': 0.3735873625381376, 'recall': 0.23781447016541826, 'f1-score': 0.2906254967854515, 'support': 330556}, 'accuracy': 0.36457908958846585, 'macro avg': {'precision': 0.365465585377474, 'recall': 0.36350046658295665, 'f1-score': 0.35714171704894904, 'support': 989201}, 'weighted avg': {'precision': 0.36562998905577954, 'recall': 0.36457908958846585, 'f1-score': 0.35767059568135934, 'support': 989201}}
[[120364 134604  60841]
 [110199 161667  70970]
 [107768 144177  78611]]
testing model out of sample: results/universal/W7/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 115s - 115s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0832114
{'0': {'precision': 0.33434472543093663, 'recall': 0.30819091488844336, 'f1-score': 0.3207355369967259, 'support': 1089805}, '1': {'precision': 0.4148914473748718, 'recall': 0.5475354003542947, 'f1-score': 0.47207277161474154, 'support': 1545606}, '2': {'precision': 0.35739170581409524, 'recall': 0.22907099065177647, 'f1-score': 0.27919276910505847, 'support': 1138826}, 'accuracy': 0.3823326410079706, 'macro avg': {'precision': 0.36887595953996793, 'recall': 0.3615991019648382, 'f1-score': 0.3573336925721753, 'support': 3774237}, 'weighted avg': {'precision': 0.37428392299555935, 'recall': 0.3823326410079706, 'f1-score': 0.37017539826193435, 'support': 3774237}}
[[335868 573097 180840]
 [411111 846274 288221]
 [257577 620377 260872]]
Evaluating performance on  train set...
5285/5285 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959101
{'0': {'precision': 0.3822690619259628, 'recall': 0.2703873435617814, 'f1-score': 0.3167385328970196, 'support': 454093}, '1': {'precision': 0.3406549562423724, 'recall': 0.5806969269955858, 'f1-score': 0.42940659232292683, 'support': 449918}, '2': {'precision': 0.38046178217522314, 'recall': 0.2243083356366522, 'f1-score': 0.2822254163014899, 'support': 448628}, 'accuracy': 0.3583202909275867, 'macro avg': {'precision': 0.3677952667811861, 'recall': 0.3584642020646731, 'f1-score': 0.34279018050714544, 'support': 1352639}, 'weighted avg': {'precision': 0.36782786105790827, 'recall': 0.3583202909275867, 'f1-score': 0.34276753064790955, 'support': 1352639}}
[[122781 251271  80041]
 [104827 261266  83825]
 [ 93582 254415 100631]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0928085
{'0': {'precision': 0.3695993335141628, 'recall': 0.27132758718780225, 'f1-score': 0.3129295779268713, 'support': 140616}, '1': {'precision': 0.35575874134350427, 'recall': 0.5791000210459855, 'f1-score': 0.4407508447002878, 'support': 152048}, '2': {'precision': 0.3823438448585927, 'recall': 0.22961882683139914, 'f1-score': 0.28692385716987295, 'support': 145367}, 'accuracy': 0.3643189637263116, 'macro avg': {'precision': 0.3692339732387533, 'recall': 0.36001547835506226, 'f1-score': 0.34686809326567736, 'support': 438031}, 'weighted avg': {'precision': 0.36902448155674755, 'recall': 0.3643189637263116, 'f1-score': 0.34866813150203346, 'support': 438031}}
[[38153 77517 24946]
 [35021 88051 28976]
 [30054 81934 33379]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975583
{'0': {'precision': 0.31962995860497073, 'recall': 0.3598083235860091, 'f1-score': 0.33853117372975366, 'support': 53006}, '1': {'precision': 0.3941659998545137, 'recall': 0.3951778759900232, 'f1-score': 0.39467128934986234, 'support': 68559}, '2': {'precision': 0.34270423104109865, 'recall': 0.30111438407211555, 'f1-score': 0.32056598248779156, 'support': 56354}, 'accuracy': 0.35484686851882036, 'macro avg': {'precision': 0.35216672983352765, 'recall': 0.35203352788271597, 'f1-score': 0.3512561485224692, 'support': 177919}, 'weighted avg': {'precision': 0.355660084678594, 'recall': 0.35484686851882036, 'f1-score': 0.35447382066206273, 'support': 177919}}
[[19072 19854 14080]
 [23000 27093 18466]
 [17597 21788 16969]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010357
{'0': {'precision': 0.3533397029444975, 'recall': 0.33098734795167, 'f1-score': 0.3417984750141786, 'support': 24581}, '1': {'precision': 0.33530145225172364, 'recall': 0.3829368403417658, 'f1-score': 0.3575394963241045, 'support': 23876}, '2': {'precision': 0.34543778801843317, 'recall': 0.31847729107362877, 'f1-score': 0.3314101288768044, 'support': 23537}, 'accuracy': 0.3441258993805039, 'macro avg': {'precision': 0.3446929810715515, 'recall': 0.34413382645568813, 'f1-score': 0.3435827000716958, 'support': 71994}, 'weighted avg': {'precision': 0.34477414685433105, 'recall': 0.3441258993805039, 'f1-score': 0.34362254537782577, 'support': 71994}}
[[8136 9339 7106]
 [7635 9143 7098]
 [7255 8786 7496]]
Evaluating performance on  val set...
73/73 - 1s - 816ms/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033812
{'0': {'precision': 0.351027397260274, 'recall': 0.29322949777495233, 'f1-score': 0.31953585036369936, 'support': 6292}, '1': {'precision': 0.3215421809390508, 'recall': 0.43441636582430804, 'f1-score': 0.36955250073120793, 'support': 5817}, '2': {'precision': 0.35620248470239196, 'recall': 0.3002031567432411, 'f1-score': 0.32581411126187243, 'support': 6399}, 'accuracy': 0.34001512859304084, 'macro avg': {'precision': 0.3429240209672389, 'recall': 0.34261634011416714, 'f1-score': 0.33830082078559326, 'support': 18508}, 'weighted avg': {'precision': 0.3435495434241792, 'recall': 0.34001512859304084, 'f1-score': 0.3374265704131486, 'support': 18508}}
[[1845 2665 1782]
 [1600 2527 1690]
 [1811 2667 1921]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
2006/2006 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0798413
{'0': {'precision': 0.4217047472290231, 'recall': 0.3142201032790516, 'f1-score': 0.3601131532277727, 'support': 171574}, '1': {'precision': 0.3632424675208191, 'recall': 0.5938090377446806, 'f1-score': 0.45075245986202944, 'support': 177323}, '2': {'precision': 0.41161457679595, 'recall': 0.23932663536623933, 'f1-score': 0.30267044056116166, 'support': 164428}, 'accuracy': 0.3868114742122437, 'macro avg': {'precision': 0.3988539305152641, 'recall': 0.38245192546332385, 'f1-score': 0.3711786845503213, 'support': 513325}, 'weighted avg': {'precision': 0.39827745775614104, 'recall': 0.3868114742122437, 'f1-score': 0.37302357725146296, 'support': 513325}}
[[ 53912  92034  25628]
 [ 41403 105296  30624]
 [ 32528  92548  39352]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0799438
{'0': {'precision': 0.43653767436002394, 'recall': 0.29614439816298194, 'f1-score': 0.35289026904574033, 'support': 46815}, '1': {'precision': 0.3611782577108513, 'recall': 0.5732405291515545, 'f1-score': 0.4431460892677709, 'support': 47699}, '2': {'precision': 0.39316949885271524, 'recall': 0.27481927430789616, 'f1-score': 0.32351009686422594, 'support': 43021}, 'accuracy': 0.38557458101574144, 'macro avg': {'precision': 0.39696181030786354, 'recall': 0.38140140054081084, 'f1-score': 0.3731821517259124, 'support': 137535}, 'weighted avg': {'precision': 0.39683642672670283, 'recall': 0.38557458101574144, 'f1-score': 0.37500208044901734, 'support': 137535}}
[[13864 24823  8128]
 [10236 27343 10120]
 [ 7659 23539 11823]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0815077
{'0': {'precision': 0.4040737369139736, 'recall': 0.2817359568390987, 'f1-score': 0.33199326851159316, 'support': 12604}, '1': {'precision': 0.3548446490218642, 'recall': 0.5794497895369813, 'f1-score': 0.440149590339433, 'support': 13304}, '2': {'precision': 0.42696497598688066, 'recall': 0.27735504489423224, 'f1-score': 0.3362701231606624, 'support': 13142}, 'accuracy': 0.3816901408450704, 'macro avg': {'precision': 0.3952944539742395, 'recall': 0.37951359709010407, 'f1-score': 0.3694709940038962, 'support': 39050}, 'weighted avg': {'precision': 0.39500569283150294, 'recall': 0.3816901408450704, 'f1-score': 0.37028054455245485, 'support': 39050}}
[[3551 6831 2222]
 [2925 7709 2670]
 [2312 7185 3645]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976347
{'0': {'precision': 0.3484036032194446, 'recall': 0.4195755716174753, 'f1-score': 0.3806916795769316, 'support': 77893}, '1': {'precision': 0.35115814480859564, 'recall': 0.4027519754279062, 'f1-score': 0.37518964850848296, 'support': 80742}, '2': {'precision': 0.37155055307587814, 'recall': 0.2414223567240401, 'f1-score': 0.2926739786754309, 'support': 79305}, 'accuracy': 0.3544885265192906, 'macro avg': {'precision': 0.3570374337013062, 'recall': 0.35458330125647386, 'f1-score': 0.3495184355869485, 'support': 237940}, 'weighted avg': {'precision': 0.35705316216437055, 'recall': 0.3544885265192906, 'f1-score': 0.34948848228970714, 'support': 237940}}
[[32682 29393 15818]
 [31657 32519 16566]
 [29466 30693 19146]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988346
{'0': {'precision': 0.3519031646492635, 'recall': 0.29939822569638314, 'f1-score': 0.3235343411658231, 'support': 32238}, '1': {'precision': 0.34228418100752517, 'recall': 0.5269271383315733, 'f1-score': 0.41499419066837895, 'support': 32198}, '2': {'precision': 0.3668696711327649, 'recall': 0.2276024664490388, 'f1-score': 0.2809229793504822, 'support': 33084}, 'accuracy': 0.35016406890894175, 'macro avg': {'precision': 0.35368567226318454, 'recall': 0.3513092768256651, 'f1-score': 0.33981717039489473, 'support': 97520}, 'weighted avg': {'precision': 0.35380472192165346, 'recall': 0.35016406890894175, 'f1-score': 0.3392754193034826, 'support': 97520}}
[[ 9652 15853  6733]
 [ 8970 16966  6262]
 [ 8806 16748  7530]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990475
{'0': {'precision': 0.335520462633452, 'recall': 0.3273299338179451, 'f1-score': 0.3313745949805042, 'support': 9217}, '1': {'precision': 0.34994095069382936, 'recall': 0.4824463213595197, 'f1-score': 0.4056470588235294, 'support': 9827}, '2': {'precision': 0.37478965886492277, 'recall': 0.2441941592743945, 'f1-score': 0.29571514785757397, 'support': 10033}, 'accuracy': 0.3510678543178457, 'macro avg': {'precision': 0.3534170240640681, 'recall': 0.3513234714839531, 'f1-score': 0.3442456005538692, 'support': 29077}, 'weighted avg': {'precision': 0.3539438894642693, 'recall': 0.3510678543178457, 'f1-score': 0.34417179789693464, 'support': 29077}}
[[3017 4148 2052]
 [3051 4741 2035]
 [2924 4659 2450]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035172
{'0': {'precision': 0.30577820579302173, 'recall': 0.5058765855750965, 'f1-score': 0.3811621303414364, 'support': 81595}, '1': {'precision': 0.35019029377378674, 'recall': 0.15136169617993958, 'f1-score': 0.21136551309961715, 'support': 93009}, '2': {'precision': 0.3738574322170699, 'recall': 0.3716145780103428, 'f1-score': 0.37273263114733096, 'support': 97846}, 'accuracy': 0.3366342448155625, 'macro avg': {'precision': 0.34327531059462607, 'recall': 0.3429509532551263, 'f1-score': 0.32175342486279485, 'support': 272450}, 'weighted avg': {'precision': 0.34538915781978036, 'recall': 0.3366342448155625, 'f1-score': 0.3201696313464252, 'support': 272450}}
[[41277 11919 28399]
 [46432 14078 32499]
 [47281 14204 36361]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1025242
{'0': {'precision': 0.34900234741784036, 'recall': 0.5060271719091244, 'f1-score': 0.4130960788172777, 'support': 35257}, '1': {'precision': 0.3425741257811461, 'recall': 0.1522439211746979, 'f1-score': 0.21080406635439466, 'support': 33847}, '2': {'precision': 0.34143131340828076, 'recall': 0.37139107611548555, 'f1-score': 0.3557815937598217, 'support': 33528}, 'accuracy': 0.3453698651492712, 'macro avg': {'precision': 0.34433592886908904, 'recall': 0.3432207230664359, 'f1-score': 0.32656057964383134, 'support': 102632}, 'weighted avg': {'precision': 0.34440906612146394, 'recall': 0.3453698651492712, 'f1-score': 0.3276586148602507, 'support': 102632}}
[[17841  5065 12351]
 [17027  5153 11667]
 [16252  4824 12452]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1036385
{'0': {'precision': 0.3088634224658141, 'recall': 0.591246290801187, 'f1-score': 0.4057602094621623, 'support': 9436}, '1': {'precision': 0.3364712210866057, 'recall': 0.11931330472103004, 'f1-score': 0.17615996620432303, 'support': 10485}, '2': {'precision': 0.37583333333333335, 'recall': 0.3148342059336824, 'f1-score': 0.34264007597340934, 'support': 11460}, 'accuracy': 0.33262165004301963, 'macro avg': {'precision': 0.3403893256285844, 'recall': 0.34179793381863316, 'f1-score': 0.3081867505466316, 'support': 31381}, 'weighted avg': {'precision': 0.3425444060890502, 'recall': 0.33262165004301963, 'f1-score': 0.30599553401078877, 'support': 31381}}
[[5579 1164 2693]
 [5935 1251 3299]
 [6549 1303 3608]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971467
{'0': {'precision': 0.28197231497390346, 'recall': 0.4653576587662511, 'f1-score': 0.3511647624046187, 'support': 112146}, '1': {'precision': 0.4471120499400971, 'recall': 0.3156196273278102, 'f1-score': 0.3700314088995143, 'support': 179729}, '2': {'precision': 0.3363060937014068, 'recall': 0.2841234882732506, 'f1-score': 0.3080203241305067, 'support': 129405}, 'accuracy': 0.3458056399544246, 'macro avg': {'precision': 0.3551301528718025, 'recall': 0.3550335914557707, 'f1-score': 0.34307216514487987, 'support': 421280}, 'weighted avg': {'precision': 0.3691149803317927, 'recall': 0.3458056399544246, 'f1-score': 0.3459610439110269, 'support': 421280}}
[[52188 31858 28100]
 [78544 56726 44459]
 [54350 38288 36767]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991758
{'0': {'precision': 0.348962040902707, 'recall': 0.3992340200739567, 'f1-score': 0.3724091203071585, 'support': 45432}, '1': {'precision': 0.3484345563828833, 'recall': 0.3499650845854076, 'f1-score': 0.349198143423877, 'support': 44393}, '2': {'precision': 0.35010779828574434, 'recall': 0.297404743824541, 'f1-score': 0.32161143850835666, 'support': 44774}, 'accuracy': 0.3491110632322677, 'macro avg': {'precision': 0.34916813185711154, 'recall': 0.3488679494946351, 'f1-score': 0.3477395674131307, 'support': 134599}, 'weighted avg': {'precision': 0.34916920084282227, 'recall': 0.3491110632322677, 'f1-score': 0.3478560381769861, 'support': 134599}}
[[18138 14418 12876]
 [17015 15536 11842]
 [16824 14634 13316]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955789
{'0': {'precision': 0.32747330960854093, 'recall': 0.3968774260329509, 'f1-score': 0.35885036852162383, 'support': 11593}, '1': {'precision': 0.3948014898169427, 'recall': 0.3736313184340783, 'f1-score': 0.38392478711516975, 'support': 13334}, '2': {'precision': 0.35475409836065575, 'recall': 0.3049851010711122, 'f1-score': 0.3279923783128356, 'support': 12417}, 'accuracy': 0.35802270779777207, 'macro avg': {'precision': 0.3590096325953798, 'recall': 0.3584979485127138, 'f1-score': 0.35692251131654307, 'support': 37344}, 'weighted avg': {'precision': 0.36058437186308895, 'recall': 0.35802270779777207, 'f1-score': 0.35754302686309286, 'support': 37344}}
[[4601 3645 3347]
 [4811 4982 3541]
 [4638 3992 3787]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/EXC
Evaluating performance on  test set...
5928/5928 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.065941
{'0': {'precision': 0.44200985316974406, 'recall': 0.40043377122053425, 'f1-score': 0.4201958856285404, 'support': 502108}, '1': {'precision': 0.3783743899755343, 'recall': 0.5311196835428088, 'f1-score': 0.4419206064468236, 'support': 550343}, '2': {'precision': 0.4243070656387954, 'recall': 0.2647183396865735, 'f1-score': 0.32603111892556036, 'support': 465117}, 'accuracy': 0.40623154942645073, 'macro avg': {'precision': 0.4148971029280246, 'recall': 0.39875726481663887, 'f1-score': 0.39604920366697477, 'support': 1517568}, 'weighted avg': {'precision': 0.41350688055255447, 'recall': 0.40623154942645073, 'f1-score': 0.39921390276827085, 'support': 1517568}}
[[201061 235164  65883]
 [156874 292298 101171]
 [ 96944 245048 123125]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0838916
{'0': {'precision': 0.4174018316537569, 'recall': 0.35285756251954475, 'f1-score': 0.3824254375154055, 'support': 105527}, '1': {'precision': 0.3463686144534909, 'recall': 0.5458597098816249, 'f1-score': 0.4238123050813837, 'support': 105681}, '2': {'precision': 0.4465181186646015, 'recall': 0.26528362397274, 'f1-score': 0.33282847622694567, 'support': 109758}, 'accuracy': 0.3864583787690908, 'macro avg': {'precision': 0.40342952159061646, 'recall': 0.3880002987913032, 'f1-score': 0.3796887396079116, 'support': 320966}, 'weighted avg': {'precision': 0.40397014107841556, 'recall': 0.3864583787690908, 'f1-score': 0.37909219434990316, 'support': 320966}}
[[37236 52218 16073]
 [27975 57687 20019]
 [23998 56643 29117]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0826327
{'0': {'precision': 0.3989184317260027, 'recall': 0.3760088352731289, 'f1-score': 0.38712498906673665, 'support': 35313}, '1': {'precision': 0.3602908607707072, 'recall': 0.5180722891566265, 'f1-score': 0.42501034114906494, 'support': 37682}, '2': {'precision': 0.42719161070738665, 'recall': 0.25646123260437376, 'f1-score': 0.32050795403568105, 'support': 36216}, 'accuracy': 0.38538242484731394, 'macro avg': {'precision': 0.3954669677346989, 'recall': 0.3835141190113764, 'f1-score': 0.3775477614171609, 'support': 109211}, 'weighted avg': {'precision': 0.394966241207212, 'recall': 0.38538242484731394, 'f1-score': 0.3781056896965412, 'support': 109211}}
[[13278 16613  5422]
 [11128 19522  7032]
 [ 8879 18049  9288]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/AAL
Evaluating performance on  test set...
5331/5331 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0815953
{'0': {'precision': 0.366397803329329, 'recall': 0.28045772335177266, 'f1-score': 0.3177188399087272, 'support': 411078}, '1': {'precision': 0.39336608215594726, 'recall': 0.5827605176839034, 'f1-score': 0.46968952944033887, 'support': 532603}, '2': {'precision': 0.37735668264937317, 'recall': 0.23390430485602964, 'f1-score': 0.2887975982177297, 'support': 420920}, 'accuracy': 0.3840866304509523, 'macro avg': {'precision': 0.3790401893782165, 'recall': 0.3657075152972353, 'f1-score': 0.3587353225222653, 'support': 1364601}, 'weighted avg': {'precision': 0.3803038445027462, 'recall': 0.3840866304509523, 'f1-score': 0.3681119702845882, 'support': 1364601}}
[[115290 232447  63341]
 [123112 310380  99111]
 [ 76256 246209  98455]]
Evaluating performance on  train set...
2013/2013 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923946
{'0': {'precision': 0.4112074834966401, 'recall': 0.23879870036845816, 'f1-score': 0.3021380875390605, 'support': 174511}, '1': {'precision': 0.3416057166353091, 'recall': 0.6336746368353539, 'f1-score': 0.4439069805096238, 'support': 173062}, '2': {'precision': 0.3938174501554783, 'recall': 0.2182046894841329, 'f1-score': 0.28081603216253126, 'support': 167737}, 'accuracy': 0.3647105625739846, 'macro avg': {'precision': 0.38221021676247585, 'recall': 0.363559342229315, 'f1-score': 0.3422870334037385, 'support': 515310}, 'weighted avg': {'precision': 0.38217180982622395, 'recall': 0.3647105625739846, 'f1-score': 0.3428093544513633, 'support': 515310}}
[[ 41673 106388  26450]
 [ 33509 109665  29888]
 [ 26161 104975  36601]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0902586
{'0': {'precision': 0.4101521313450821, 'recall': 0.23303380402225074, 'f1-score': 0.2972058502510369, 'support': 58425}, '1': {'precision': 0.3462328612154396, 'recall': 0.6307519825894844, 'f1-score': 0.44706336036646643, 'support': 60653}, '2': {'precision': 0.39729548176056545, 'recall': 0.231143056192758, 'f1-score': 0.29225480717585134, 'support': 58851}, 'accuracy': 0.36798385873016765, 'macro avg': {'precision': 0.38456015810702904, 'recall': 0.3649762809348311, 'f1-score': 0.3455080059311182, 'support': 177929}, 'weighted avg': {'precision': 0.3841107205808358, 'recall': 0.36798385873016765, 'f1-score': 0.3466521671808988, 'support': 177929}}
[[13615 35618  9192]
 [10952 38257 11444]
 [ 8628 36620 13603]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/WBA
Evaluating performance on  test set...
4192/4192 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0795203
{'0': {'precision': 0.300099741550197, 'recall': 0.33327295716659294, 'f1-score': 0.3158176173807131, 'support': 287089}, '1': {'precision': 0.45047308615147813, 'recall': 0.5336302151120939, 'f1-score': 0.48853824503295623, 'support': 484817}, '2': {'precision': 0.3355813940568978, 'recall': 0.20052848402763254, 'f1-score': 0.2510441645229259, 'support': 301239}, 'accuracy': 0.38652651785173486, 'macro avg': {'precision': 0.3620514072528576, 'recall': 0.35581055210210644, 'f1-score': 0.3518000089788651, 'support': 1073145}, 'weighted avg': {'precision': 0.37799416525717544, 'recall': 0.38652651785173486, 'f1-score': 0.3756656401279193, 'support': 1073145}}
[[ 95679 149451  41959]
 [148463 258713  77641]
 [ 74682 166150  60407]]
Evaluating performance on  train set...
1230/1230 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096586
{'0': {'precision': 0.39609354731107077, 'recall': 0.2963370335795029, 'f1-score': 0.33902947116858945, 'support': 108191}, '1': {'precision': 0.3337130158517451, 'recall': 0.5865029831998744, 'f1-score': 0.42538638652531485, 'support': 101904}, '2': {'precision': 0.3883670454338191, 'recall': 0.203231779483068, 'f1-score': 0.2668312458098108, 'support': 104772}, 'accuracy': 0.35926597579295383, 'macro avg': {'precision': 0.3727245361988783, 'recall': 0.3620239320874818, 'f1-score': 0.3437490345012384, 'support': 314867}, 'weighted avg': {'precision': 0.3733336304810615, 'recall': 0.35926597579295383, 'f1-score': 0.3429541842545012, 'support': 314867}}
[[32061 59414 16716]
 [25319 59767 16818]
 [23563 59916 21293]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959165
{'0': {'precision': 0.36286649855094283, 'recall': 0.2891201343489474, 'f1-score': 0.3218225819911541, 'support': 33346}, '1': {'precision': 0.35114906177524774, 'recall': 0.5701489131054944, 'f1-score': 0.4346199847776449, 'support': 35054}, '2': {'precision': 0.38171641791044775, 'recall': 0.21158221302998967, 'f1-score': 0.2722554890219561, 'support': 33845}, 'accuracy': 0.35980243532691086, 'macro avg': {'precision': 0.36524399274554614, 'recall': 0.3569504201614771, 'f1-score': 0.34289935193025173, 'support': 102245}, 'weighted avg': {'precision': 0.36508892988731356, 'recall': 0.35980243532691086, 'f1-score': 0.34408676992929427, 'support': 102245}}
[[ 9641 18128  5577]
 [ 9046 19986  6022]
 [ 7882 18802  7161]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
6143/6143 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0770267
{'0': {'precision': 0.33177269335702775, 'recall': 0.26739227234542623, 'f1-score': 0.2961236369182278, 'support': 435682}, '1': {'precision': 0.4358461554445056, 'recall': 0.6133502345852834, 'f1-score': 0.509583037504335, 'support': 683973}, '2': {'precision': 0.3451777041985249, 'recall': 0.19729177063964914, 'f1-score': 0.2510766913363057, 'support': 452842}, 'accuracy': 0.3976827936714665, 'macro avg': {'precision': 0.3709321843333528, 'recall': 0.35934475919011954, 'f1-score': 0.3522611219196228, 'support': 1572497}, 'weighted avg': {'precision': 0.38090079344487765, 'recall': 0.3976827936714665, 'f1-score': 0.3759974412344667, 'support': 1572497}}
[[116498 259565  59619]
 [154590 419515 109868]
 [ 80050 283450  89342]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971295
{'0': {'precision': 0.3840654512570702, 'recall': 0.25386988174656433, 'f1-score': 0.30568192620557594, 'support': 177331}, '1': {'precision': 0.3394414282280876, 'recall': 0.6245457483176389, 'f1-score': 0.4398330308964708, 'support': 176389}, '2': {'precision': 0.3919765572892179, 'recall': 0.19972032802959397, 'f1-score': 0.2646141581750341, 'support': 179496}, 'accuracy': 0.35826194262737804, 'macro avg': {'precision': 0.37182781225812517, 'recall': 0.3593786526979324, 'f1-score': 0.33670970509236026, 'support': 533216}, 'weighted avg': {'precision': 0.37196683660613544, 'recall': 0.35826194262737804, 'f1-score': 0.3362347961774299, 'support': 533216}}
[[ 45019 105319  26993]
 [ 37611 110163  28615]
 [ 34587 109060  35849]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0921456
{'0': {'precision': 0.3588324106693508, 'recall': 0.2717965474051081, 'f1-score': 0.30930837878036693, 'support': 55089}, '1': {'precision': 0.36431591737545566, 'recall': 0.6004614127561402, 'f1-score': 0.45348837209302323, 'support': 62417}, '2': {'precision': 0.38330443884727355, 'recall': 0.2032011375656788, 'f1-score': 0.26559985493778193, 'support': 57667}, 'accuracy': 0.3663235772636194, 'macro avg': {'precision': 0.36881758896402667, 'recall': 0.3584863659089757, 'f1-score': 0.34279886860372405, 'support': 175173}, 'weighted avg': {'precision': 0.36884247207728016, 'recall': 0.3663235772636194, 'f1-score': 0.3462932063403546, 'support': 175173}}
[[14973 31551  8565]
 [14650 37479 10288]
 [12104 33845 11718]]
testing model on single stock: results/universal/W7/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
23942/23942 - 184s - 184s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925018
{'0': {'precision': 0.3230911565478031, 'recall': 0.2745947864276327, 'f1-score': 0.29687546836799905, 'support': 1803370}, '1': {'precision': 0.4217316400312065, 'recall': 0.5160264422026561, 'f1-score': 0.46413820769464176, 'support': 2540333}, '2': {'precision': 0.3116080620838519, 'recall': 0.2597179498094498, 'f1-score': 0.28330657223297556, 'support': 1785356}, 'accuracy': 0.37032829998862793, 'macro avg': {'precision': 0.35214361955428714, 'recall': 0.3501130594799129, 'f1-score': 0.34810674943187214, 'support': 6129059}, 'weighted avg': {'precision': 0.36063007789430385, 'recall': 0.37032829998862793, 'f1-score': 0.36224892067998155, 'support': 6129059}}
[[ 495196  902229  405945]
 [ 611036 1310879  618418]
 [ 426450  895217  463689]]
Evaluating performance on  train set...
9052/9052 - 72s - 72s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960226
{'0': {'precision': 0.3702558353788567, 'recall': 0.36939147783586856, 'f1-score': 0.369823151559924, 'support': 777901}, '1': {'precision': 0.350784536095842, 'recall': 0.4588025486348835, 'f1-score': 0.3975874670382314, 'support': 766528}, '2': {'precision': 0.35960373384643385, 'recall': 0.2505924423638677, 'f1-score': 0.2953606773067902, 'support': 772649}, 'accuracy': 0.35935561944828787, 'macro avg': {'precision': 0.3602147017737109, 'recall': 0.3595954896115399, 'f1-score': 0.35425709863498184, 'support': 2317078}, 'weighted avg': {'precision': 0.36026237305530273, 'recall': 0.35935561944828787, 'f1-score': 0.35417791602868437, 'support': 2317078}}
[[287350 321993 168558]
 [238595 351685 176248]
 [250140 328889 193620]]
Evaluating performance on  val set...
2763/2763 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953039
{'0': {'precision': 0.35189362554065357, 'recall': 0.39430500644129535, 'f1-score': 0.37189405699370065, 'support': 225110}, '1': {'precision': 0.37205625061895486, 'recall': 0.457580051236039, 'f1-score': 0.4104100021666263, 'support': 246311}, '2': {'precision': 0.3591095219628902, 'recall': 0.23161348577533034, 'f1-score': 0.2816027378902988, 'support': 235893}, 'accuracy': 0.36208105593838097, 'macro avg': {'precision': 0.3610197993741662, 'recall': 0.3611661811508882, 'f1-score': 0.35463559901687525, 'support': 707314}, 'weighted avg': {'precision': 0.36132148332431424, 'recall': 0.36208105593838097, 'f1-score': 0.3551939928556088, 'support': 707314}}
[[ 88762  91570  44778]
 [ 80875 112707  52729]
 [ 82604  98653  54636]]
training model: results/universal/W7/deepOF_L2/h500
Epoch 1/50
12475/12475 - 288s - loss: 3.2823 - accuracy500: 0.3661 - val_loss: 3.2993 - val_accuracy500: 0.3447 - 288s/epoch - 23ms/step
Epoch 2/50
12475/12475 - 280s - loss: 3.2753 - accuracy500: 0.3712 - val_loss: 3.3282 - val_accuracy500: 0.3462 - 280s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 281s - loss: 3.2705 - accuracy500: 0.3757 - val_loss: 3.3420 - val_accuracy500: 0.3456 - 281s/epoch - 23ms/step
Epoch 4/50
12475/12475 - 283s - loss: 3.2673 - accuracy500: 0.3781 - val_loss: 3.3536 - val_accuracy500: 0.3454 - 283s/epoch - 23ms/step
Epoch 5/50
12475/12475 - 285s - loss: 3.2651 - accuracy500: 0.3800 - val_loss: 3.3573 - val_accuracy500: 0.3453 - 285s/epoch - 23ms/step
Epoch 6/50
12475/12475 - 295s - loss: 3.2628 - accuracy500: 0.3821 - val_loss: 3.3562 - val_accuracy500: 0.3453 - 295s/epoch - 24ms/step
Epoch 7/50
12475/12475 - 290s - loss: 3.2610 - accuracy500: 0.3833 - val_loss: 3.3501 - val_accuracy500: 0.3461 - 290s/epoch - 23ms/step
Epoch 8/50
12475/12475 - 288s - loss: 3.2593 - accuracy500: 0.3846 - val_loss: 3.3491 - val_accuracy500: 0.3477 - 288s/epoch - 23ms/step
Epoch 9/50
12475/12475 - 275s - loss: 3.2582 - accuracy500: 0.3857 - val_loss: 3.3464 - val_accuracy500: 0.3476 - 275s/epoch - 22ms/step
Epoch 10/50
12475/12475 - 275s - loss: 3.2568 - accuracy500: 0.3863 - val_loss: 3.3464 - val_accuracy500: 0.3488 - 275s/epoch - 22ms/step
Epoch 11/50
12475/12475 - 276s - loss: 3.2558 - accuracy500: 0.3874 - val_loss: 3.3425 - val_accuracy500: 0.3484 - 276s/epoch - 22ms/step
testing model in sample: results/universal/W7/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 283s - 283s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0934333
{'0': {'precision': 0.32207150399163187, 'recall': 0.2809539730685757, 'f1-score': 0.300110930966806, 'support': 2904191}, '1': {'precision': 0.39452770015809924, 'recall': 0.6036414197614988, 'f1-score': 0.4771801818069808, 'support': 3727612}, '2': {'precision': 0.3262323417744965, 'recall': 0.14402987879226542, 'f1-score': 0.19983406103628087, 'support': 2873744}, 'accuracy': 0.36610097241116163, 'macro avg': {'precision': 0.3476105153080759, 'recall': 0.34287509054077997, 'f1-score': 0.32570839127002255, 'support': 9505547}, 'weighted avg': {'precision': 0.35174320714747953, 'recall': 0.36610097241116163, 'f1-score': 0.33923286797487284, 'support': 9505547}}
[[ 815944 1728600  359647]
 [ 982280 2250141  495191]
 [ 735201 1724638  413905]]
Evaluating performance on  train set...
12475/12475 - 99s - 99s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990824
{'0': {'precision': 0.3482501337833333, 'recall': 0.33001661950152744, 'f1-score': 0.3388882953072074, 'support': 1066819}, '1': {'precision': 0.3386713775360499, 'recall': 0.5238499855420604, 'f1-score': 0.41138226557688834, 'support': 1068617}, '2': {'precision': 0.34652872260015116, 'recall': 0.17338853789845712, 'f1-score': 0.23112950123578777, 'support': 1057642}, 'accuracy': 0.3430063405904898, 'macro avg': {'precision': 0.34448341130651144, 'recall': 0.3424183809806817, 'f1-score': 0.3271333540399612, 'support': 3193078}, 'weighted avg': {'precision': 0.3444742603059844, 'recall': 0.3430063405904898, 'f1-score': 0.327456711909743, 'support': 3193078}}
[[352068 543438 171313]
 [334318 559795 174504]
 [324577 549682 183383]]
Evaluating performance on  val set...
3866/3866 - 30s - 30s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994695
{'0': {'precision': 0.32896627393610073, 'recall': 0.3206585053761387, 'f1-score': 0.3247592674379995, 'support': 314166}, '1': {'precision': 0.34972026589977595, 'recall': 0.555746014787333, 'f1-score': 0.4292940514950618, 'support': 340697}, '2': {'precision': 0.3581398962998545, 'recall': 0.15163995716909234, 'f1-score': 0.21306577011977304, 'support': 334338}, 'accuracy': 0.3445002582892658, 'macro avg': {'precision': 0.3456088120452437, 'recall': 0.34268149244418805, 'f1-score': 0.3223730296842781, 'support': 989201}, 'weighted avg': {'precision': 0.3459746204237215, 'recall': 0.3445002582892658, 'f1-score': 0.32301170229957743, 'support': 989201}}
[[100740 169817  43609]
 [104102 189341  47254]
 [101390 182249  50699]]
testing model out of sample: results/universal/W7/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 113s - 113s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0923606
{'0': {'precision': 0.31707065241292015, 'recall': 0.2971394679596759, 'f1-score': 0.3067816756469255, 'support': 1116156}, '1': {'precision': 0.4022778661529664, 'recall': 0.6062391352826909, 'f1-score': 0.48363405946111776, 'support': 1488764}, '2': {'precision': 0.3435062684152753, 'recall': 0.14237456566525586, 'f1-score': 0.20131090727818962, 'support': 1169317}, 'accuracy': 0.3711165991960759, 'macro avg': {'precision': 0.3542849289937206, 'recall': 0.3485843896358742, 'f1-score': 0.33057554746207757, 'support': 3774237}, 'weighted avg': {'precision': 0.3588711666767336, 'recall': 0.3711165991960759, 'f1-score': 0.3438653828651333, 'support': 3774237}}
[[331654 647109 137393]
 [405439 902547 180778]
 [308901 693935 166481]]
Evaluating performance on  train set...
5285/5285 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982163
{'0': {'precision': 0.3561937826278705, 'recall': 0.30385226144282634, 'f1-score': 0.3279476858792007, 'support': 457186}, '1': {'precision': 0.3396540270161133, 'recall': 0.583500794414483, 'f1-score': 0.4293719536292979, 'support': 446870}, '2': {'precision': 0.35735720331375515, 'recall': 0.1553001339774356, 'f1-score': 0.2165096157432155, 'support': 448583}, 'accuracy': 0.34697432204749384, 'macro avg': {'precision': 0.3510683376525796, 'recall': 0.3475510632782483, 'f1-score': 0.3246097517505714, 'support': 1352639}, 'weighted avg': {'precision': 0.35111539153557625, 'recall': 0.34697432204749384, 'f1-score': 0.32449830930028745, 'support': 1352639}}
[[138917 253487  64782]
 [125623 260749  60498]
 [125464 253454  69665]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004826
{'0': {'precision': 0.3476423891336997, 'recall': 0.29319692382642587, 'f1-score': 0.31810682342458674, 'support': 143685}, '1': {'precision': 0.33058432400545373, 'recall': 0.5927679784804629, 'f1-score': 0.42445294375822934, 'support': 142754}, '2': {'precision': 0.3696902000722757, 'recall': 0.14846429890759408, 'f1-score': 0.21185108485903895, 'support': 151592}, 'accuracy': 0.34073844088660393, 'macro avg': {'precision': 0.34930563773714307, 'recall': 0.344809733738161, 'f1-score': 0.31813695068061837, 'support': 438031}, 'weighted avg': {'precision': 0.34971339489923453, 'recall': 0.34073844088660393, 'f1-score': 0.315992393490359, 'support': 438031}}
[[42128 82351 19206]
 [38968 84620 19166]
 [40086 89000 22506]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
695/695 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0987495
{'0': {'precision': 0.28585172764506994, 'recall': 0.41942444592332667, 'f1-score': 0.3399893743103519, 'support': 49587}, '1': {'precision': 0.4199213359094673, 'recall': 0.340557102284651, 'f1-score': 0.3760979566611302, 'support': 71477}, '2': {'precision': 0.32786642086750156, 'recall': 0.2721484478058218, 'f1-score': 0.2974204213439951, 'support': 56855}, 'accuracy': 0.34067749931148444, 'macro avg': {'precision': 0.3445464948073462, 'recall': 0.34404333200459986, 'f1-score': 0.3378359174384924, 'support': 177919}, 'weighted avg': {'precision': 0.35313874461951156, 'recall': 0.34067749931148444, 'f1-score': 0.3408924555989404, 'support': 177919}}
[[20798 15488 13301]
 [28716 24342 18419]
 [23244 18138 15473]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982302
{'0': {'precision': 0.34103580304964065, 'recall': 0.4136048879837067, 'f1-score': 0.37383108754878136, 'support': 24550}, '1': {'precision': 0.34691542726392677, 'recall': 0.3250463821892393, 'f1-score': 0.33562503990975073, 'support': 24255}, '2': {'precision': 0.3295885913614445, 'recall': 0.277071025054983, 'f1-score': 0.30105662676006845, 'support': 23189}, 'accuracy': 0.3397922049059644, 'macro avg': {'precision': 0.33917994055833733, 'recall': 0.3385740984093097, 'f1-score': 0.3368375847395335, 'support': 71994}, 'weighted avg': {'precision': 0.33932956216123233, 'recall': 0.3397922049059644, 'f1-score': 0.33751896908454615, 'support': 71994}}
[[10154  7723  6673]
 [ 9975  7884  6396]
 [ 9645  7119  6425]]
Evaluating performance on  val set...
73/73 - 1s - 865ms/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983422
{'0': {'precision': 0.3269680436477007, 'recall': 0.424881836596894, 'f1-score': 0.3695492585523418, 'support': 5924}, '1': {'precision': 0.3575631706472828, 'recall': 0.3319408740359897, 'f1-score': 0.34427595400766536, 'support': 6224}, '2': {'precision': 0.3591017488076312, 'recall': 0.28411949685534593, 'f1-score': 0.31724016853932585, 'support': 6360}, 'accuracy': 0.34525610546790575, 'macro avg': {'precision': 0.3478776543675382, 'recall': 0.3469807358294099, 'f1-score': 0.3436884603664443, 'support': 18508}, 'weighted avg': {'precision': 0.3482990591686947, 'recall': 0.34525610546790575, 'f1-score': 0.34307493069580147, 'support': 18508}}
[[2517 1808 1599]
 [2532 2066 1626]
 [2649 1904 1807]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035407
{'0': {'precision': 0.3915816205664686, 'recall': 0.22320165062492572, 'f1-score': 0.28433325420661704, 'support': 185142}, '1': {'precision': 0.2872271421219659, 'recall': 0.714006822845873, 'f1-score': 0.40965877378758797, 'support': 150084}, '2': {'precision': 0.3641157148619835, 'recall': 0.07095491833193898, 'f1-score': 0.11876600643781866, 'support': 178099}, 'accuracy': 0.3138791214143087, 'macro avg': {'precision': 0.34764149251680604, 'recall': 0.33605446393424593, 'f1-score': 0.27091934481067453, 'support': 513325}, 'weighted avg': {'precision': 0.35154151364993846, 'recall': 0.3138791214143087, 'f1-score': 0.263531606167685, 'support': 513325}}
[[ 41324 133024  10794]
 [ 31648 107161  11275]
 [ 32559 132903  12637]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967422
{'0': {'precision': 0.3866338117278812, 'recall': 0.23890946502057614, 'f1-score': 0.29532881433531305, 'support': 48600}, '1': {'precision': 0.3218445859872611, 'recall': 0.708729802513465, 'f1-score': 0.4426674142341521, 'support': 44560}, '2': {'precision': 0.35590148203433203, 'recall': 0.07522253521126761, 'f1-score': 0.12419540871377015, 'support': 44375}, 'accuracy': 0.3383138837386847, 'macro avg': {'precision': 0.3547932932498248, 'recall': 0.34095393424843623, 'f1-score': 0.28739721242774513, 'support': 137535}, 'weighted avg': {'precision': 0.3557270968614597, 'recall': 0.3383138837386847, 'f1-score': 0.2878497227370748, 'support': 137535}}
[[11611 34208  2781]
 [ 9719 31581  3260]
 [ 8701 32336  3338]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0930225
{'0': {'precision': 0.3155699721964782, 'recall': 0.23535510627268014, 'f1-score': 0.2696228842917945, 'support': 11574}, '1': {'precision': 0.3881000432463601, 'recall': 0.6954921208989925, 'f1-score': 0.4981957809030348, 'support': 15484}, '2': {'precision': 0.31985018726591763, 'recall': 0.07121414276184122, 'f1-score': 0.11649161096712589, 'support': 11992}, 'accuracy': 0.36740076824583867, 'macro avg': {'precision': 0.34117340090291864, 'recall': 0.3340204566445046, 'f1-score': 0.2947700920539851, 'support': 39050}, 'weighted avg': {'precision': 0.3456438251862116, 'recall': 0.36740076824583867, 'f1-score': 0.31323037472506, 'support': 39050}}
[[ 2724  8173   677]
 [ 3576 10769  1139]
 [ 2332  8806   854]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954245
{'0': {'precision': 0.33209802002873146, 'recall': 0.4125916633256166, 'f1-score': 0.3679945554062394, 'support': 77321}, '1': {'precision': 0.3751232355567927, 'recall': 0.3972340268736643, 'f1-score': 0.38586214096101645, 'support': 81418}, '2': {'precision': 0.3725588832396112, 'recall': 0.2618275021780028, 'f1-score': 0.3075291779745221, 'support': 79201}, 'accuracy': 0.35715306379759604, 'macro avg': {'precision': 0.3599267129417118, 'recall': 0.35721773079242786, 'f1-score': 0.3537952914472593, 'support': 237940}, 'weighted avg': {'precision': 0.3602881848813354, 'recall': 0.35715306379759604, 'f1-score': 0.3539818829792805, 'support': 237940}}
[[31902 27643 17776]
 [31928 32342 17148]
 [32232 26232 20737]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978494
{'0': {'precision': 0.3416323474354174, 'recall': 0.39762823705179284, 'f1-score': 0.36750956531745355, 'support': 32128}, '1': {'precision': 0.352160911902267, 'recall': 0.4279990060259676, 'f1-score': 0.38639390922729633, 'support': 32194}, '2': {'precision': 0.3597790370970046, 'recall': 0.22757395023796614, 'f1-score': 0.27879771943096476, 'support': 33198}, 'accuracy': 0.34976415094339625, 'macro avg': {'precision': 0.35119076547822964, 'recall': 0.35106706443857555, 'f1-score': 0.3442337313252382, 'support': 97520}, 'weighted avg': {'precision': 0.35128565350423535, 'recall': 0.34976415094339625, 'f1-score': 0.3435442936613196, 'support': 97520}}
[[12775 12268  7085]
 [12056 13779  6359]
 [12563 13080  7555]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980159
{'0': {'precision': 0.3103418803418803, 'recall': 0.4145923726878283, 'f1-score': 0.35497116042623916, 'support': 8758}, '1': {'precision': 0.3652797704447633, 'recall': 0.37755808205635194, 'f1-score': 0.37131745260087506, 'support': 10115}, '2': {'precision': 0.37272464605605315, 'recall': 0.2528420227361819, 'f1-score': 0.3012962746700923, 'support': 10204}, 'accuracy': 0.3449461773910651, 'macro avg': {'precision': 0.3494487656142322, 'recall': 0.34833082582678737, 'f1-score': 0.3425282958990688, 'support': 29077}, 'weighted avg': {'precision': 0.35134509593283125, 'recall': 0.3449461773910651, 'f1-score': 0.34182139294990804, 'support': 29077}}
[[3631 3037 2090]
 [4044 3819 2252]
 [4025 3599 2580]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002864
{'0': {'precision': 0.29784980687421014, 'recall': 0.4182224888155757, 'f1-score': 0.34791874584165006, 'support': 80022}, '1': {'precision': 0.35086342229199374, 'recall': 0.161916836240052, 'f1-score': 0.22157910467345582, 'support': 93863}, '2': {'precision': 0.3694036241564759, 'recall': 0.43764013595089535, 'f1-score': 0.4006371408536387, 'support': 98565}, 'accuracy': 0.33694622866581025, 'macro avg': {'precision': 0.33937228444089323, 'recall': 0.3392598203355077, 'f1-score': 0.32337833045624814, 'support': 272450}, 'weighted avg': {'precision': 0.3419999958424096, 'recall': 0.33694622866581025, 'f1-score': 0.32346497768377325, 'support': 272450}}
[[33467 12635 33920]
 [38949 15198 39716]
 [39946 15483 43136]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990409
{'0': {'precision': 0.34019514516896715, 'recall': 0.4094697946206067, 'f1-score': 0.3716317219326409, 'support': 34911}, '1': {'precision': 0.338436928702011, 'recall': 0.17450732023448318, 'f1-score': 0.23027735126625334, 'support': 33947}, '2': {'precision': 0.33573814605177693, 'recall': 0.4285249008112749, 'f1-score': 0.3764990504929633, 'support': 33774}, 'accuracy': 0.33802322862265183, 'macro avg': {'precision': 0.3381234066409184, 'recall': 0.33750067188878824, 'f1-score': 0.3261360412306192, 'support': 102632}, 'weighted avg': {'precision': 0.33814688670583926, 'recall': 0.33802322862265183, 'f1-score': 0.32647847863410306, 'support': 102632}}
[[14295  5928 14688]
 [14076  5924 13947]
 [13649  5652 14473]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994046
{'0': {'precision': 0.30668722014240624, 'recall': 0.44108952702702703, 'f1-score': 0.3618099155661399, 'support': 9472}, '1': {'precision': 0.31434480165444634, 'recall': 0.16770310932798396, 'f1-score': 0.21871934070246585, 'support': 9970}, '2': {'precision': 0.3897419406704719, 'recall': 0.40606415947734315, 'f1-score': 0.3977356633029781, 'support': 11939}, 'accuracy': 0.34090691819891017, 'macro avg': {'precision': 0.3369246541557748, 'recall': 0.3382855986107847, 'f1-score': 0.3260883065238613, 'support': 31381}, 'weighted avg': {'precision': 0.3407185255839032, 'recall': 0.34090691819891017, 'f1-score': 0.3300169348083336, 'support': 31381}}
[[4178 1659 3635]
 [4342 1672 3956]
 [5103 1988 4848]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961331
{'0': {'precision': 0.2737953210394155, 'recall': 0.42975103438436296, 'f1-score': 0.33448776052691853, 'support': 112144}, '1': {'precision': 0.45804359350151236, 'recall': 0.32757419146219763, 'f1-score': 0.3819752115276473, 'support': 179367}, '2': {'precision': 0.34154827238378554, 'recall': 0.30789325647882004, 'f1-score': 0.3238487382016689, 'support': 129769}, 'accuracy': 0.34871107102164833, 'macro avg': {'precision': 0.35779572897490447, 'recall': 0.3550728274417936, 'f1-score': 0.34677057008541157, 'support': 421280}, 'weighted avg': {'precision': 0.37311238482055037, 'recall': 0.34871107102164833, 'f1-score': 0.3514291447263166, 'support': 421280}}
[[48194 33243 30707]
 [74291 58756 46320]
 [53537 36277 39955]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973973
{'0': {'precision': 0.34268495065071186, 'recall': 0.43292211948006093, 'f1-score': 0.3825542619785878, 'support': 45313}, '1': {'precision': 0.3581501270035911, 'recall': 0.27585509006274034, 'f1-score': 0.31166158536585364, 'support': 44469}, '2': {'precision': 0.3475396144119899, 'recall': 0.33424816475890845, 'f1-score': 0.34076433121019106, 'support': 44817}, 'accuracy': 0.34817494929382836, 'macro avg': {'precision': 0.3494582306887643, 'recall': 0.34767512476723655, 'f1-score': 0.3449933928515441, 'support': 134599}, 'weighted avg': {'precision': 0.3494107984878086, 'recall': 0.34817494929382836, 'f1-score': 0.3452179833766746, 'support': 134599}}
[[19617 11067 14629]
 [18708 12267 13494]
 [18920 10917 14980]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972145
{'0': {'precision': 0.31790651744568793, 'recall': 0.4263264765604308, 'f1-score': 0.36421918014858395, 'support': 11327}, '1': {'precision': 0.3995653523750388, 'recall': 0.2855980471928397, 'f1-score': 0.33310326977827626, 'support': 13519}, '2': {'precision': 0.3462492994956369, 'recall': 0.34605536885901744, 'f1-score': 0.34615230701508665, 'support': 12498}, 'accuracy': 0.34851649528706086, 'macro avg': {'precision': 0.3545737231054546, 'recall': 0.352659964204096, 'f1-score': 0.347824918980649, 'support': 37344}, 'weighted avg': {'precision': 0.35695359005360766, 'recall': 0.34851649528706086, 'f1-score': 0.3469083464746701, 'support': 37344}}
[[4829 2585 3913]
 [5405 3861 4253]
 [4956 3217 4325]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/EXC
Evaluating performance on  test set...
5928/5928 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962479
{'0': {'precision': 0.42032917344908666, 'recall': 0.31115776394854383, 'f1-score': 0.35759677732060924, 'support': 560166}, '1': {'precision': 0.29104767401641973, 'recall': 0.6136487178741519, 'f1-score': 0.39483087055802674, 'support': 447031}, '2': {'precision': 0.4010426085167148, 'recall': 0.12601421319001274, 'f1-score': 0.19177085538615674, 'support': 510371}, 'accuracy': 0.33799737474696356, 'macro avg': {'precision': 0.3708064853274071, 'recall': 0.3502735650042362, 'f1-score': 0.3147328344215976, 'support': 1517568}, 'weighted avg': {'precision': 0.37576040196472216, 'recall': 0.33799737474696356, 'f1-score': 0.3127961834298627, 'support': 1517568}}
[[174300 340028  45838]
 [122496 274320  50215]
 [117879 328178  64314]]
Evaluating performance on  train set...
1254/1254 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097875
{'0': {'precision': 0.3717243308775529, 'recall': 0.2644112769485904, 'f1-score': 0.3090162028064191, 'support': 105525}, '1': {'precision': 0.331971801297515, 'recall': 0.6689161766510302, 'f1-score': 0.4437285949523218, 'support': 105949}, '2': {'precision': 0.3863047501542258, 'recall': 0.1143827859569649, 'f1-score': 0.17650374880207453, 'support': 109492}, 'accuracy': 0.3467563542555909, 'macro avg': {'precision': 0.3633336274430979, 'recall': 0.3492367465188618, 'f1-score': 0.3097495155202718, 'support': 320966}, 'weighted avg': {'precision': 0.3635761111625863, 'recall': 0.3467563542555909, 'f1-score': 0.30827964386130513, 'support': 320966}}
[[27902 68629  8994]
 [24176 70871 10902]
 [22983 73985 12524]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1045675
{'0': {'precision': 0.37551923599518616, 'recall': 0.2580567708889126, 'f1-score': 0.3058994671347026, 'support': 37484}, '1': {'precision': 0.29824633398993217, 'recall': 0.6648877775067089, 'f1-score': 0.41178137040114826, 'support': 32792}, '2': {'precision': 0.38741785852338617, 'recall': 0.1029664825992038, 'f1-score': 0.1626930178763468, 'support': 38935}, 'accuracy': 0.32492148226826967, 'macro avg': {'precision': 0.35372780950283483, 'recall': 0.3419703436649418, 'f1-score': 0.2934579518040659, 'support': 109211}, 'weighted avg': {'precision': 0.35655905676030303, 'recall': 0.32492148226826967, 'f1-score': 0.2866370876128523, 'support': 109211}}
[[ 9673 24763  3048]
 [ 7698 21803  3291]
 [ 8388 26538  4009]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/AAL
Evaluating performance on  test set...
5331/5331 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992581
{'0': {'precision': 0.34693967789663444, 'recall': 0.23220745280248412, 'f1-score': 0.27820902361457356, 'support': 439271}, '1': {'precision': 0.3459613746182214, 'recall': 0.7062990049355532, 'f1-score': 0.4644329091676089, 'support': 477758}, '2': {'precision': 0.34610982179423905, 'recall': 0.07363954849722502, 'f1-score': 0.12144090169657644, 'support': 447572}, 'accuracy': 0.3461825104920779, 'macro avg': {'precision': 0.3463369581030316, 'recall': 0.3373820020784208, 'f1-score': 0.2880276114929196, 'support': 1364601}, 'weighted avg': {'precision': 0.34632498351113317, 'recall': 0.3461825104920779, 'f1-score': 0.29198955671616533, 'support': 1364601}}
[[102002 309943  27326]
 [105376 337440  34942]
 [ 86627 327986  32959]]
Evaluating performance on  train set...
2013/2013 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009059
{'0': {'precision': 0.3693034916821185, 'recall': 0.23829397622845844, 'f1-score': 0.28967466823261107, 'support': 178028}, '1': {'precision': 0.3255037292663921, 'recall': 0.6993542214781153, 'f1-score': 0.444241871771498, 'support': 167240}, '2': {'precision': 0.3563732762604276, 'recall': 0.08617282788958022, 'f1-score': 0.1387864121349315, 'support': 170042}, 'accuracy': 0.33773068638295395, 'macro avg': {'precision': 0.350393499069646, 'recall': 0.341273675198718, 'f1-score': 0.29090098404634684, 'support': 515310}, 'weighted avg': {'precision': 0.35082189428028027, 'recall': 0.33773068638295395, 'f1-score': 0.2900481876218754, 'support': 515310}}
[[ 42423 122450  13155]
 [ 36971 116960  13309]
 [ 35479 119910  14653]]
Evaluating performance on  val set...
696/696 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036177
{'0': {'precision': 0.3738663906969144, 'recall': 0.22724714451249792, 'f1-score': 0.2826756169630079, 'support': 60410}, '1': {'precision': 0.3133522503349886, 'recall': 0.7139906609195402, 'f1-score': 0.4355519035880581, 'support': 55680}, '2': {'precision': 0.3728033472803347, 'recall': 0.08645029835540678, 'f1-score': 0.14035364076714055, 'support': 61839}, 'accuracy': 0.3306318812560066, 'macro avg': {'precision': 0.3533406627707459, 'recall': 0.3425627012624817, 'f1-score': 0.28619372043940217, 'support': 177929}, 'weighted avg': {'precision': 0.3545600107521617, 'recall': 0.3306318812560066, 'f1-score': 0.28105195220519186, 'support': 177929}}
[[13728 42244  4438]
 [11369 39755  4556]
 [11622 44871  5346]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/WBA
Evaluating performance on  test set...
4192/4192 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0891272
{'0': {'precision': 0.3167807885769917, 'recall': 0.31470860374171045, 'f1-score': 0.3157412963001897, 'support': 310179}, '1': {'precision': 0.4199559692557259, 'recall': 0.6319882635766332, 'f1-score': 0.5046032584331193, 'support': 430114}, '2': {'precision': 0.3660295616717635, 'recall': 0.12945393147705286, 'f1-score': 0.19126354944381807, 'support': 332852}, 'accuracy': 0.3844140353819847, 'macro avg': {'precision': 0.36758877316816035, 'recall': 0.3587169329317988, 'f1-score': 0.33720270139237574, 'support': 1073145}, 'weighted avg': {'precision': 0.37340840393614083, 'recall': 0.3844140353819847, 'f1-score': 0.3528280897756342, 'support': 1073145}}
[[ 97616 178789  33774]
 [117430 271827  40857]
 [ 93104 196659  43089]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944201
{'0': {'precision': 0.36402706950190833, 'recall': 0.3226723525230988, 'f1-score': 0.34210446996413174, 'support': 105525}, '1': {'precision': 0.3604831474363944, 'recall': 0.610140417315011, 'f1-score': 0.4532041998551774, 'support': 106682}, '2': {'precision': 0.36932096948287707, 'recall': 0.14664913306058835, 'f1-score': 0.20993697010263276, 'support': 102660}, 'accuracy': 0.3626801157314041, 'macro avg': {'precision': 0.3646103954737266, 'recall': 0.35982063429956607, 'f1-score': 0.3350818799739806, 'support': 314867}, 'weighted avg': {'precision': 0.3645523677333937, 'recall': 0.3626801157314041, 'f1-score': 0.33665463193237566, 'support': 314867}}
[[34050 57760 13715]
 [29597 65091 11994]
 [29890 57715 15055]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942894
{'0': {'precision': 0.3376329263489563, 'recall': 0.3163089600885554, 'f1-score': 0.3266232735354818, 'support': 32522}, '1': {'precision': 0.37073297073297073, 'recall': 0.6003858844583636, 'f1-score': 0.4584049446502343, 'support': 35762}, '2': {'precision': 0.3774347136055403, 'recall': 0.15405906775418862, 'f1-score': 0.21880685026033497, 'support': 33961}, 'accuracy': 0.3617780820578023, 'macro avg': {'precision': 0.36193353689582247, 'recall': 0.35691797076703585, 'f1-score': 0.334611689482017, 'support': 102245}, 'weighted avg': {'precision': 0.3624305427045921, 'recall': 0.3617780820578023, 'f1-score': 0.3369046816391399, 'support': 102245}}
[[10287 17756  4479]
 [10140 21471  4151]
 [10041 18688  5232]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
6143/6143 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0841771
{'0': {'precision': 0.3170410679029929, 'recall': 0.29487955453334946, 'f1-score': 0.30555900698292787, 'support': 437833}, '1': {'precision': 0.45167122781584873, 'recall': 0.6628522683073441, 'f1-score': 0.5372543493758799, 'support': 678744}, '2': {'precision': 0.33994384513078174, 'recall': 0.12614055097385507, 'f1-score': 0.18400403138722918, 'support': 455920}, 'accuracy': 0.40478614585592215, 'macro avg': {'precision': 0.3695520469498745, 'recall': 0.3612907912715162, 'f1-score': 0.3422724625820123, 'support': 1572497}, 'weighted avg': {'precision': 0.38179238218440964, 'recall': 0.40478614585592215, 'f1-score': 0.37032382307069833, 'support': 1572497}}
[[129108 261061  47664]
 [164836 449907  64001]
 [113284 285126  57510]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960124
{'0': {'precision': 0.35693057182761107, 'recall': 0.3043681949798777, 'f1-score': 0.32856046112038606, 'support': 177167}, '1': {'precision': 0.3521546940058639, 'recall': 0.6142844352925377, 'f1-score': 0.44767050667754105, 'support': 178712}, '2': {'precision': 0.36901464467834266, 'recall': 0.1464950912669099, 'f1-score': 0.20972963372595246, 'support': 177337}, 'accuracy': 0.35573388645502013, 'macro avg': {'precision': 0.35936663683727255, 'recall': 0.35504924051310843, 'f1-score': 0.3286535338412932, 'support': 533216}, 'weighted avg': {'precision': 0.35934881612232483, 'recall': 0.35573388645502013, 'f1-score': 0.3289604716676382, 'support': 533216}}
[[ 53924  99864  23379]
 [ 47889 109780  21043]
 [ 49264 102094  25979]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988177
{'0': {'precision': 0.34971150198654344, 'recall': 0.3058708483218664, 'f1-score': 0.32632530064367093, 'support': 57266}, '1': {'precision': 0.3400774650628674, 'recall': 0.6107557326621924, 'f1-score': 0.4368889555672243, 'support': 57216}, '2': {'precision': 0.37971339005821764, 'recall': 0.13970769965892801, 'f1-score': 0.20426157237325498, 'support': 60691}, 'accuracy': 0.34788466259069606, 'macro avg': {'precision': 0.35650078570254284, 'recall': 0.35211142688099556, 'f1-score': 0.32249194286138344, 'support': 175173}, 'weighted avg': {'precision': 0.3569593286055597, 'recall': 0.34788466259069606, 'f1-score': 0.320147638262175, 'support': 175173}}
[[17516 32409  7341]
 [15761 34945  6510]
 [16810 35402  8479]]
testing model on single stock: results/universal/W7/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
23942/23942 - 185s - 185s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.092325
{'0': {'precision': 0.29485964355073385, 'recall': 0.2655977728048343, 'f1-score': 0.279464816885991, 'support': 1768682}, '1': {'precision': 0.4280112470716951, 'recall': 0.6069537160658656, 'f1-score': 0.5020131621472523, 'support': 2606520}, '2': {'precision': 0.2988399928541654, 'recall': 0.1430681064647802, 'f1-score': 0.19349938133963004, 'support': 1753857}, 'accuracy': 0.37570465547810844, 'macro avg': {'precision': 0.34057029449219806, 'recall': 0.3385398651118267, 'f1-score': 0.32499245345762445, 'support': 6129059}, 'weighted avg': {'precision': 0.35262434790383673, 'recall': 0.37570465547810844, 'f1-score': 0.3495091143873446, 'support': 6129059}}
[[ 469758 1063241  235683]
 [ 671437 1582037  353046]
 [ 451963 1050973  250921]]
Evaluating performance on  train set...
9052/9052 - 73s - 73s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000452
{'0': {'precision': 0.3432358394981373, 'recall': 0.34347717990619714, 'f1-score': 0.34335646729348196, 'support': 772258}, '1': {'precision': 0.33808313422020814, 'recall': 0.49629379057183537, 'f1-score': 0.4021888794500701, 'support': 777479}, '2': {'precision': 0.3408649861278619, 'recall': 0.1790038587798645, 'f1-score': 0.2347366972939579, 'support': 767341}, 'accuracy': 0.3402854802471043, 'macro avg': {'precision': 0.34072798661540243, 'recall': 0.33959160975263236, 'f1-score': 0.32676068134583663, 'support': 2317078}, 'weighted avg': {'precision': 0.34072173632906855, 'recall': 0.3402854802471043, 'f1-score': 0.3271259226333053, 'support': 2317078}}
[[265253 375823 131182]
 [257194 385858 134427]
 [250354 379630 137357]]
Evaluating performance on  val set...
2763/2763 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998499
{'0': {'precision': 0.32447314213278405, 'recall': 0.3304095664099967, 'f1-score': 0.3274144478248318, 'support': 223114}, '1': {'precision': 0.3535074160729221, 'recall': 0.5414307083007349, 'f1-score': 0.4277385563563522, 'support': 246689}, '2': {'precision': 0.3497507087691856, 'recall': 0.1506288129812935, 'f1-score': 0.2105703043840365, 'support': 237511}, 'accuracy': 0.3436380447721945, 'macro avg': {'precision': 0.3425770889916306, 'recall': 0.3408230292306751, 'f1-score': 0.3219077695217402, 'support': 707314}, 'weighted avg': {'precision': 0.34308741547305033, 'recall': 0.3436380447721945, 'f1-score': 0.32316892837627786, 'support': 707314}}
[[ 73719 117964  31431]
 [ 78041 133565  35083]
 [ 75436 126299  35776]]
training model: results/universal/W7/deepOF_L2/h1000
Epoch 1/50
12475/12475 - 276s - loss: 3.2845 - accuracy1000: 0.3624 - val_loss: 3.3078 - val_accuracy1000: 0.3205 - 276s/epoch - 22ms/step
Epoch 2/50
12475/12475 - 274s - loss: 3.2810 - accuracy1000: 0.3641 - val_loss: 3.3054 - val_accuracy1000: 0.3240 - 274s/epoch - 22ms/step
Epoch 3/50
12475/12475 - 278s - loss: 3.2768 - accuracy1000: 0.3687 - val_loss: 3.3053 - val_accuracy1000: 0.3248 - 278s/epoch - 22ms/step
Epoch 4/50
12475/12475 - 275s - loss: 3.2719 - accuracy1000: 0.3733 - val_loss: 3.3049 - val_accuracy1000: 0.3303 - 275s/epoch - 22ms/step
Epoch 5/50
12475/12475 - 275s - loss: 3.2690 - accuracy1000: 0.3758 - val_loss: 3.3054 - val_accuracy1000: 0.3267 - 275s/epoch - 22ms/step
Epoch 6/50
12475/12475 - 275s - loss: 3.2671 - accuracy1000: 0.3773 - val_loss: 3.3051 - val_accuracy1000: 0.3336 - 275s/epoch - 22ms/step
Epoch 7/50
12475/12475 - 273s - loss: 3.2648 - accuracy1000: 0.3796 - val_loss: 3.3053 - val_accuracy1000: 0.3388 - 273s/epoch - 22ms/step
Epoch 8/50
12475/12475 - 276s - loss: 3.2626 - accuracy1000: 0.3817 - val_loss: 3.3091 - val_accuracy1000: 0.3391 - 276s/epoch - 22ms/step
Epoch 9/50
12475/12475 - 274s - loss: 3.2606 - accuracy1000: 0.3835 - val_loss: 3.3159 - val_accuracy1000: 0.3391 - 274s/epoch - 22ms/step
Epoch 10/50
12475/12475 - 272s - loss: 3.2584 - accuracy1000: 0.3851 - val_loss: 3.3189 - val_accuracy1000: 0.3386 - 272s/epoch - 22ms/step
Epoch 11/50
12475/12475 - 272s - loss: 3.2563 - accuracy1000: 0.3866 - val_loss: 3.3203 - val_accuracy1000: 0.3386 - 272s/epoch - 22ms/step
Epoch 12/50
12475/12475 - 271s - loss: 3.2545 - accuracy1000: 0.3883 - val_loss: 3.3204 - val_accuracy1000: 0.3385 - 271s/epoch - 22ms/step
Epoch 13/50
12475/12475 - 274s - loss: 3.2529 - accuracy1000: 0.3896 - val_loss: 3.3228 - val_accuracy1000: 0.3384 - 274s/epoch - 22ms/step
Epoch 14/50
12475/12475 - 272s - loss: 3.2512 - accuracy1000: 0.3909 - val_loss: 3.3235 - val_accuracy1000: 0.3382 - 272s/epoch - 22ms/step
testing model in sample: results/universal/W7/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37133/37133 - 281s - 281s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984932
{'0': {'precision': 0.326944927331717, 'recall': 0.7082690964673017, 'f1-score': 0.447376065146428, 'support': 3035640}, '1': {'precision': 0.3650051313374343, 'recall': 0.2719733419659867, 'f1-score': 0.3116955111206354, 'support': 3462821}, '2': {'precision': 0.3497718673651468, 'recall': 0.040610411541272845, 'f1-score': 0.07277164075710062, 'support': 3007086}, 'accuracy': 0.338114576678228, 'macro avg': {'precision': 0.3472406420114327, 'recall': 0.3402842833248538, 'f1-score': 0.27728107234138805, 'support': 9505547}, 'weighted avg': {'precision': 0.34803137774773707, 'recall': 0.338114576678228, 'f1-score': 0.2794419955035812, 'support': 9505547}}
[[2150050  780232  105358]
 [2399364  941795  121662]
 [2026770  858197  122119]]
Evaluating performance on  train set...
12475/12475 - 99s - 99s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0990477
{'0': {'precision': 0.3458375563151677, 'recall': 0.7635388561093486, 'f1-score': 0.4760519679185133, 'support': 1079264}, '1': {'precision': 0.3378255488279661, 'recall': 0.2214919089844085, 'f1-score': 0.2675604870488855, 'support': 1049930}, '2': {'precision': 0.35265407236664015, 'recall': 0.04040948073286185, 'f1-score': 0.07251024843332425, 'support': 1063884}, 'accuracy': 0.34437054152764196, 'macro avg': {'precision': 0.3454390591699246, 'recall': 0.34181341527553966, 'f1-score': 0.2720409011335743, 'support': 3193078}, 'weighted avg': {'precision': 0.3454742502330323, 'recall': 0.34437054152764196, 'f1-score': 0.27304313468542935, 'support': 3193078}}
[[824060 215960  39244]
 [777707 232551  39672]
 [781028 239865  42991]]
Evaluating performance on  val set...
3866/3866 - 31s - 31s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009201
{'0': {'precision': 0.3231309562987411, 'recall': 0.7551257463246205, 'f1-score': 0.45259074938652477, 'support': 313369}, '1': {'precision': 0.3485432898181769, 'recall': 0.23038940232661015, 'f1-score': 0.2774093821810899, 'support': 334564}, '2': {'precision': 0.3660986597274686, 'recall': 0.03833936964497111, 'f1-score': 0.06940985180646514, 'support': 341268}, 'accuracy': 0.3303646073952614, 'macro avg': {'precision': 0.34592430194812884, 'recall': 0.3412848394320673, 'f1-score': 0.2664699944580266, 'support': 989201}, 'weighted avg': {'precision': 0.34654940630567754, 'recall': 0.3303646073952614, 'f1-score': 0.26114658637711524, 'support': 989201}}
[[236633  65841  10895]
 [245724  77080  11760]
 [249956  78228  13084]]
testing model out of sample: results/universal/W7/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14745/14745 - 115s - 115s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969609
{'0': {'precision': 0.29047421828867487, 'recall': 0.7176260745451036, 'f1-score': 0.4135538388568449, 'support': 1046722}, '1': {'precision': 0.4445045854302704, 'recall': 0.2892879538510352, 'f1-score': 0.3504800474599254, 'support': 1601076}, '2': {'precision': 0.32672955974842766, 'recall': 0.04242928378722683, 'f1-score': 0.07510534532760177, 'support': 1126439}, 'accuracy': 0.3344042782686938, 'macro avg': {'precision': 0.35390278782245765, 'recall': 0.3497811040611219, 'f1-score': 0.27971307721479066, 'support': 3774237}, 'weighted avg': {'precision': 0.36663630209003123, 'recall': 0.3344042782686938, 'f1-score': 0.28578562604000235, 'support': 3774237}}
[[ 751155  257818   37749]
 [1077167  463172   60737]
 [ 757639  321006   47794]]
Evaluating performance on  train set...
5285/5285 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097789
{'0': {'precision': 0.35006523511537174, 'recall': 0.7227110701741779, 'f1-score': 0.47166593716426314, 'support': 459243}, '1': {'precision': 0.34334323261031735, 'recall': 0.27121264401295947, 'f1-score': 0.3030449450157411, 'support': 446314}, '2': {'precision': 0.3519690644298659, 'recall': 0.040920904889930707, 'f1-score': 0.07331769062298998, 'support': 447082}, 'accuracy': 0.3483863765572337, 'macro avg': {'precision': 0.348459177385185, 'recall': 0.3449482063590226, 'f1-score': 0.2826761909343314, 'support': 1352639}, 'weighted avg': {'precision': 0.348476521490777, 'recall': 0.3483863765572337, 'f1-score': 0.28436375213932974, 'support': 1352639}}
[[331900 110710  16633]
 [308217 121046  17051]
 [307992 120795  18295]]
Evaluating performance on  val set...
1714/1714 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021298
{'0': {'precision': 0.3395127847824992, 'recall': 0.6980703510649314, 'f1-score': 0.4568382053946595, 'support': 144845}, '1': {'precision': 0.3057943652613582, 'recall': 0.2773009831440034, 'f1-score': 0.29085149918884656, 'support': 136094}, '2': {'precision': 0.3703505326429804, 'recall': 0.039613729534285644, 'f1-score': 0.07157192558727968, 'support': 157092}, 'accuracy': 0.33119573728800017, 'macro avg': {'precision': 0.3385525608956126, 'recall': 0.3383283545810735, 'f1-score': 0.27308721005692854, 'support': 438031}, 'weighted avg': {'precision': 0.3400960514932766, 'recall': 0.33119573728800017, 'f1-score': 0.26709810658458716, 'support': 438031}}
[[101112  38704   5029]
 [ 92804  37739   5551]
 [103899  46970   6223]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
695/695 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1049297
{'0': {'precision': 0.2856783790054394, 'recall': 0.8797658033144785, 'f1-score': 0.43130348481383995, 'support': 50385}, '1': {'precision': 0.3723030018761726, 'recall': 0.09200765039990727, 'f1-score': 0.1475508876289618, 'support': 69016}, '2': {'precision': 0.3302333742761888, 'recall': 0.03216104446495095, 'f1-score': 0.05861376271080866, 'support': 58518}, 'accuracy': 0.29540970891248264, 'macro avg': {'precision': 0.3294049183859336, 'recall': 0.3346448327264456, 'f1-score': 0.21248937838453677, 'support': 177919}, 'weighted avg': {'precision': 0.3339349125139474, 'recall': 0.29540970891248264, 'f1-score': 0.19865533365889454, 'support': 177919}}
[[44327  4638  1420]
 [60269  6350  2397]
 [50568  6068  1882]]
Evaluating performance on  train set...
282/282 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985303
{'0': {'precision': 0.343983268983269, 'recall': 0.8637795911771835, 'f1-score': 0.49202660100789286, 'support': 24754}, '1': {'precision': 0.34101382488479265, 'recall': 0.10167710648615882, 'f1-score': 0.15664788469321048, 'support': 24745}, '2': {'precision': 0.3293973941368078, 'recall': 0.035963547454989996, 'f1-score': 0.06484710031662058, 'support': 22495}, 'accuracy': 0.3431813762257966, 'macro avg': {'precision': 0.3381314960016231, 'recall': 0.3338067483727774, 'f1-score': 0.23784052867257463, 'support': 71994}, 'weighted avg': {'precision': 0.3384051909644349, 'recall': 0.3431813762257966, 'f1-score': 0.24327879975699718, 'support': 71994}}
[[21382  2533   839]
 [21421  2516   808]
 [19357  2329   809]]
Evaluating performance on  val set...
73/73 - 1s - 760ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022753
{'0': {'precision': 0.30739525004827184, 'recall': 0.8368670054319257, 'f1-score': 0.4496328375070608, 'support': 5707}, '1': {'precision': 0.3841834347215723, 'recall': 0.12373775433308214, 'f1-score': 0.1871865025079799, 'support': 6635}, '2': {'precision': 0.34652278177458035, 'recall': 0.04686993188452806, 'f1-score': 0.08257142857142857, 'support': 6166}, 'accuracy': 0.3180246379943808, 'macro avg': {'precision': 0.3460338221814749, 'recall': 0.33582489721651193, 'f1-score': 0.23979692286215645, 'support': 18508}, 'weighted avg': {'precision': 0.3479587882983132, 'recall': 0.3180246379943808, 'f1-score': 0.2332598052930987, 'support': 18508}}
[[4776  654  277]
 [5546  821  268]
 [5215  662  289]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
2006/2006 - 17s - 17s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1021463
{'0': {'precision': 0.41336831299190147, 'recall': 0.6955101076708068, 'f1-score': 0.5185452877780325, 'support': 203212}, '1': {'precision': 0.23136439267886855, 'recall': 0.31359673851758685, 'f1-score': 0.26627630779428824, 'support': 115285}, '2': {'precision': 0.4006731784582893, 'recall': 0.03116081877348225, 'f1-score': 0.05782455471949709, 'support': 194828}, 'accuracy': 0.35759022062046464, 'macro avg': {'precision': 0.3484686280430198, 'recall': 0.34675588832062526, 'f1-score': 0.28088205009727263, 'support': 513325}, 'weighted avg': {'precision': 0.36767466934664245, 'recall': 0.35759022062046464, 'f1-score': 0.2870269936412687, 'support': 513325}}
[[141336  56736   5140]
 [ 75191  36153   3941]
 [125386  63371   6071]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965363
{'0': {'precision': 0.38378894327351026, 'recall': 0.6879750109426604, 'f1-score': 0.49271521291526854, 'support': 50262}, '1': {'precision': 0.3127521446788778, 'recall': 0.3173061090070805, 'f1-score': 0.3150126691654698, 'support': 42511}, '2': {'precision': 0.34486762656758013, 'recall': 0.03317546132880568, 'f1-score': 0.06052824651504035, 'support': 44762}, 'accuracy': 0.36029374341076814, 'macro avg': {'precision': 0.34713623817332273, 'recall': 0.34615219375951556, 'f1-score': 0.2894187095319262, 'support': 137535}, 'weighted avg': {'precision': 0.3491647289030063, 'recall': 0.36029374341076814, 'f1-score': 0.2971296105060294, 'support': 137535}}
[[34579 14379  1304]
 [27505 13489  1517]
 [28015 15262  1485]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998012
{'0': {'precision': 0.3427097074571273, 'recall': 0.6912121449252681, 'f1-score': 0.4582263377687858, 'support': 12779}, '1': {'precision': 0.32694689900074325, 'recall': 0.3041641057160418, 'f1-score': 0.3151442786069652, 'support': 13016}, '2': {'precision': 0.33076263924592975, 'recall': 0.02912108638249717, 'f1-score': 0.05352933018998752, 'support': 13255}, 'accuracy': 0.3374647887323944, 'macro avg': {'precision': 0.3334730819012668, 'recall': 0.341499112341269, 'f1-score': 0.27563331552191284, 'support': 39050}, 'weighted avg': {'precision': 0.33340043462722413, 'recall': 0.3374647887323944, 'f1-score': 0.27316577650099505, 'support': 39050}}
[[8833 3605  341]
 [8617 3959  440]
 [8324 4545  386]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982791
{'0': {'precision': 0.3270656023682402, 'recall': 0.8070095347411533, 'f1-score': 0.4654807269116038, 'support': 76667}, '1': {'precision': 0.39671596891451494, 'recall': 0.15277677213815075, 'f1-score': 0.2205997665057764, 'support': 82866}, '2': {'precision': 0.3525329220548108, 'recall': 0.0757968038567985, 'f1-score': 0.1247677531097465, 'support': 78407}, 'accuracy': 0.3382113137765823, 'macro avg': {'precision': 0.35877149777918865, 'recall': 0.34519437024536753, 'f1-score': 0.2702827488423756, 'support': 237940}, 'weighted avg': {'precision': 0.3597144357249206, 'recall': 0.3382113137765823, 'f1-score': 0.26792425132165876, 'support': 237940}}
[[61871  9505  5291]
 [64582 12660  5624]
 [62717  9747  5943]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980744
{'0': {'precision': 0.3370880211780278, 'recall': 0.793562258506793, 'f1-score': 0.4731796139053529, 'support': 32092}, '1': {'precision': 0.3602665051483949, 'recall': 0.1846574151687312, 'f1-score': 0.24416576014449626, 'support': 32211}, '2': {'precision': 0.3467032967032967, 'recall': 0.05698889123039408, 'f1-score': 0.09788763347726039, 'support': 33217}, 'accuracy': 0.3415504511894996, 'macro avg': {'precision': 0.3480192743432398, 'recall': 0.34506952163530613, 'f1-score': 0.27174433584236984, 'support': 97520}, 'weighted avg': {'precision': 0.34801903793656297, 'recall': 0.3415504511894996, 'f1-score': 0.2697050552776775, 'support': 97520}}
[[25467  4932  1693]
 [24389  5948  1874]
 [25694  5630  1893]]
Evaluating performance on  val set...
114/114 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013911
{'0': {'precision': 0.3110592102417715, 'recall': 0.8171798659243268, 'f1-score': 0.4505983334377545, 'support': 8801}, '1': {'precision': 0.36692986530422667, 'recall': 0.16631578947368422, 'f1-score': 0.22888599159785603, 'support': 9500}, '2': {'precision': 0.3836363636363636, 'recall': 0.05874164810690423, 'f1-score': 0.10188314823756639, 'support': 10776}, 'accuracy': 0.3234515252605152, 'macro avg': {'precision': 0.3538751463941206, 'recall': 0.34741243450163845, 'f1-score': 0.2604558244243923, 'support': 29077}, 'weighted avg': {'precision': 0.3562104510187928, 'recall': 0.3234515252605152, 'f1-score': 0.24892614981508837, 'support': 29077}}
[[7192 1164  445]
 [7348 1580  572]
 [8581 1562  633]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058972
{'0': {'precision': 0.28053161345394617, 'recall': 0.9313670178569086, 'f1-score': 0.4311877008303518, 'support': 76217}, '1': {'precision': 0.3529038400507775, 'recall': 0.02332312597004908, 'f1-score': 0.043754549568159905, 'support': 95356}, '2': {'precision': 0.38376440070191503, 'recall': 0.04986270408517303, 'f1-score': 0.08825800112296461, 'support': 100877}, 'accuracy': 0.2871719581574601, 'macro avg': {'precision': 0.33906661806887956, 'recall': 0.3348509493040435, 'f1-score': 0.1877334171738254, 'support': 272450}, 'weighted avg': {'precision': 0.34408433842579716, 'recall': 0.2871719581574601, 'f1-score': 0.16861550450390778, 'support': 272450}}
[[70986  1650  3581]
 [88636  2224  4496]
 [93419  2428  5030]]
Evaluating performance on  train set...
401/401 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986272
{'0': {'precision': 0.3495475963034915, 'recall': 0.9104811428890939, 'f1-score': 0.5051575175665823, 'support': 35769}, '1': {'precision': 0.3209549071618037, 'recall': 0.02857817666509211, 'f1-score': 0.052483192366081115, 'support': 33872}, '2': {'precision': 0.3446564293469831, 'recall': 0.0673517019793277, 'f1-score': 0.1126831989451798, 'support': 32991}, 'accuracy': 0.34840010912775743, 'macro avg': {'precision': 0.3383863109374261, 'recall': 0.3354703405111712, 'f1-score': 0.22344130295928108, 'support': 102632}, 'weighted avg': {'precision': 0.33853878759208167, 'recall': 0.34840010912775743, 'f1-score': 0.22959916355584428, 'support': 102632}}
[[32567  1014  2188]
 [30867   968  2037]
 [29735  1034  2222]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013671
{'0': {'precision': 0.30870917573872475, 'recall': 0.9450424342786172, 'f1-score': 0.46539245667686036, 'support': 9662}, '1': {'precision': 0.30091743119266057, 'recall': 0.017297753401539922, 'f1-score': 0.03271494115300219, 'support': 9481}, '2': {'precision': 0.3934817170111288, 'recall': 0.040447785585880046, 'f1-score': 0.07335506816834618, 'support': 12238}, 'accuracy': 0.3119722124852618, 'macro avg': {'precision': 0.3343694413141714, 'recall': 0.33426265775534575, 'f1-score': 0.19048748866606957, 'support': 31381}, 'weighted avg': {'precision': 0.33941478837217953, 'recall': 0.3119722124852618, 'f1-score': 0.1817823395598502, 'support': 31381}}
[[ 9131   146   385]
 [ 8939   164   378]
 [11508   235   495]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
1646/1646 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045963
{'0': {'precision': 0.26173800479356035, 'recall': 0.8512897354341711, 'f1-score': 0.4003761430208176, 'support': 108782}, '1': {'precision': 0.4728381374722838, 'recall': 0.10573466605064176, 'f1-score': 0.17282313395036147, 'support': 177482}, '2': {'precision': 0.3178448027641808, 'recall': 0.06540706286662322, 'f1-score': 0.1084889434889435, 'support': 135016}, 'accuracy': 0.2853256741359666, 'macro avg': {'precision': 0.350806981676675, 'recall': 0.34081048811714537, 'f1-score': 0.2272294068200409, 'support': 421280}, 'weighted avg': {'precision': 0.3686545191851443, 'recall': 0.2853256741359666, 'f1-score': 0.2109629136060858, 'support': 421280}}
[[ 92605   9651   6526]
 [146289  18766  12427]
 [114914  11271   8831]]
Evaluating performance on  train set...
526/526 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980376
{'0': {'precision': 0.34012551463612073, 'recall': 0.8657774626667257, 'f1-score': 0.48838589935071025, 'support': 45134}, '1': {'precision': 0.37017391304347824, 'recall': 0.09432540825596597, 'f1-score': 0.15034168564920275, 'support': 45131}, '2': {'precision': 0.3289089137847053, 'recall': 0.06092389588126494, 'f1-score': 0.10280516119209834, 'support': 44334}, 'accuracy': 0.3420084844612516, 'macro avg': {'precision': 0.3464027804881014, 'recall': 0.3403422556013189, 'f1-score': 0.24717758206400378, 'support': 134599}, 'weighted avg': {'precision': 0.3465062268730304, 'recall': 0.3420084844612516, 'f1-score': 0.24803782949813605, 'support': 134599}}
[[39076  3526  2532]
 [37895  4257  2979]
 [37916  3717  2701]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009915
{'0': {'precision': 0.3053495344800379, 'recall': 0.875724112961622, 'f1-score': 0.4528116443966022, 'support': 11048}, '1': {'precision': 0.4078091106290672, 'recall': 0.09782204712703486, 'f1-score': 0.1577937649880096, 'support': 13453}, '2': {'precision': 0.38980263157894735, 'recall': 0.07381452931558047, 'f1-score': 0.12412438625204582, 'support': 12843}, 'accuracy': 0.3197032990574122, 'macro avg': {'precision': 0.36765375889601754, 'recall': 0.34912022980141244, 'f1-score': 0.24490993187888588, 'support': 37344}, 'weighted avg': {'precision': 0.37130443497206295, 'recall': 0.3197032990574122, 'f1-score': 0.23349378910433746, 'support': 37344}}
[[ 9675   761   612]
 [11265  1316   872]
 [10745  1150   948]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
5928/5928 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0962381
{'0': {'precision': 0.4453897575298114, 'recall': 0.6708710224360238, 'f1-score': 0.535357126899509, 'support': 634025}, '1': {'precision': 0.20990868188293652, 'recall': 0.32403056623475246, 'f1-score': 0.2547736630633544, 'support': 316035}, '2': {'precision': 0.4211005367492538, 'recall': 0.05543534188064309, 'f1-score': 0.0979731150062985, 'support': 567508}, 'accuracy': 0.3684935370276653, 'macro avg': {'precision': 0.3587996587206672, 'recall': 0.35011231018380645, 'f1-score': 0.2960346349897206, 'support': 1517568}, 'weighted avg': {'precision': 0.3872674270320724, 'recall': 0.3684935370276653, 'f1-score': 0.31336172319110767, 'support': 1517568}}
[[425349 181303  27373]
 [197754 102405  15876]
 [331901 204147  31460]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981555
{'0': {'precision': 0.35304796635125363, 'recall': 0.631554103808319, 'f1-score': 0.45291168635097306, 'support': 105926}, '1': {'precision': 0.3442056985417647, 'recall': 0.38507513179780667, 'f1-score': 0.3634952386443775, 'support': 106413}, '2': {'precision': 0.3643311077145845, 'recall': 0.04169313338304473, 'f1-score': 0.07482363825604255, 'support': 108627}, 'accuracy': 0.3502053176972016, 'macro avg': {'precision': 0.35386159086920094, 'recall': 0.35277412299639016, 'f1-score': 0.297076854417131, 'support': 320966}, 'weighted avg': {'precision': 0.35393504333904485, 'recall': 0.3502053176972016, 'f1-score': 0.29530732062310794, 'support': 320966}}
[[66898 35213  3815]
 [61349 40977  4087]
 [61240 42858  4529]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003121
{'0': {'precision': 0.34317269691492297, 'recall': 0.6305375738812271, 'f1-score': 0.4444510574138, 'support': 35530}, '1': {'precision': 0.3296731036223653, 'recall': 0.3634946700436973, 'f1-score': 0.34575876310494547, 'support': 35929}, '2': {'precision': 0.3664812239221141, 'recall': 0.04187857596948506, 'f1-score': 0.07516759378120097, 'support': 37752}, 'accuracy': 0.3391966010749833, 'macro avg': {'precision': 0.34644234148646746, 'recall': 0.3453036066314698, 'f1-score': 0.28845913809998214, 'support': 109211}, 'weighted avg': {'precision': 0.34678878525920304, 'recall': 0.3391966010749833, 'f1-score': 0.2843288649489319, 'support': 109211}}
[[22403 11821  1306]
 [21442 13060  1427]
 [21437 14734  1581]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
5331/5331 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.093326
{'0': {'precision': 0.25418143737411003, 'recall': 0.6731152584645352, 'f1-score': 0.3690154503575031, 'support': 329581}, '1': {'precision': 0.512384258754465, 'recall': 0.3420330530149631, 'f1-score': 0.41022659518839866, 'support': 686957}, '2': {'precision': 0.2607897981894192, 'recall': 0.024912156707262767, 'f1-score': 0.04547981705270225, 'support': 348063}, 'accuracy': 0.34110996547708816, 'macro avg': {'precision': 0.34245183143933144, 'recall': 0.3466868227289204, 'f1-score': 0.27490728753286797, 'support': 1364601}, 'weighted avg': {'precision': 0.3858494937931245, 'recall': 0.34110996547708816, 'f1-score': 0.3072387854456561, 'support': 1364601}}
[[221846 100076   7659]
 [435076 234962  16919]
 [215864 123528   8671]]
Evaluating performance on  train set...
2013/2013 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0978749
{'0': {'precision': 0.3594242778904484, 'recall': 0.6738505346026074, 'f1-score': 0.4687973400247042, 'support': 179105}, '1': {'precision': 0.3305444098577949, 'recall': 0.329156563183105, 'f1-score': 0.3298490266784373, 'support': 167434}, '2': {'precision': 0.358974358974359, 'recall': 0.02720846590942757, 'f1-score': 0.05058299323099971, 'support': 168771}, 'accuracy': 0.35006889057072443, 'macro avg': {'precision': 0.3496476822408674, 'recall': 0.34340518789838, 'f1-score': 0.28307645331138037, 'support': 515310}, 'weighted avg': {'precision': 0.3498933060685031, 'recall': 0.35006889057072443, 'f1-score': 0.2866795363346164, 'support': 515310}}
[[120690  54113   4302]
 [108424  55112   3898]
 [106673  57506   4592]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1052712
{'0': {'precision': 0.3774063947324368, 'recall': 0.6298854499736132, 'f1-score': 0.47200381501814465, 'support': 64426}, '1': {'precision': 0.25309620148002276, 'recall': 0.3645812556789221, 'f1-score': 0.2987777192568242, 'support': 45123}, '2': {'precision': 0.39803849000740193, 'recall': 0.031456566247440775, 'f1-score': 0.05830532364740324, 'support': 68380}, 'accuracy': 0.33262143888854545, 'macro avg': {'precision': 0.3428470287399538, 'recall': 0.34197442396665867, 'f1-score': 0.27636228597412404, 'support': 177929}, 'weighted avg': {'precision': 0.3538103189087849, 'recall': 0.33262143888854545, 'f1-score': 0.26908476326733755, 'support': 177929}}
[[40581 22117  1728]
 [27147 16451  1525]
 [39798 26431  2151]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
4192/4192 - 32s - 32s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986243
{'0': {'precision': 0.3020406259090335, 'recall': 0.7028894572648344, 'f1-score': 0.42251928800185035, 'support': 313173}, '1': {'precision': 0.397582668965635, 'recall': 0.27998153428899797, 'f1-score': 0.32857640686746864, 'support': 415906}, '2': {'precision': 0.355238613399658, 'recall': 0.053135154301790936, 'f1-score': 0.09244305109599778, 'support': 344066}, 'accuracy': 0.3306673375918445, 'macro avg': {'precision': 0.35162063609144223, 'recall': 0.34533538195187446, 'f1-score': 0.28117958198843895, 'support': 1073145}, 'weighted avg': {'precision': 0.35612476898704076, 'recall': 0.3306673375918445, 'f1-score': 0.2802836922078754, 'support': 1073145}}
[[220126  79529  13518]
 [279796 116446  19664]
 [228874  96910  18282]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965877
{'0': {'precision': 0.3578367578862474, 'recall': 0.7184257010377567, 'f1-score': 0.4777257099509366, 'support': 108696}, '1': {'precision': 0.3470615121845606, 'recall': 0.28146948649914155, 'f1-score': 0.31084298410988415, 'support': 102512}, '2': {'precision': 0.35523294570772534, 'recall': 0.046267087276550996, 'f1-score': 0.08187094571526117, 'support': 103659}, 'accuracy': 0.3548799969510936, 'macro avg': {'precision': 0.3533770719261778, 'recall': 0.34872075827114973, 'f1-score': 0.2901465465920273, 'support': 314867}, 'weighted avg': {'precision': 0.3534714209217998, 'recall': 0.3548799969510936, 'f1-score': 0.2930719005732506, 'support': 314867}}
[[78090 26282  4324]
 [69277 28854  4381]
 [70861 28002  4796]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979866
{'0': {'precision': 0.3346707675101356, 'recall': 0.7263927661123922, 'f1-score': 0.4582240682962311, 'support': 32956}, '1': {'precision': 0.35719103649853856, 'recall': 0.27676316018698643, 'f1-score': 0.3118752760645868, 'support': 34441}, '2': {'precision': 0.3799950359890792, 'recall': 0.043933654729109275, 'f1-score': 0.0787612212876508, 'support': 34848}, 'accuracy': 0.3423345884884346, 'macro avg': {'precision': 0.3572856133325844, 'recall': 0.3490298603428293, 'f1-score': 0.2829535218828229, 'support': 102245}, 'weighted avg': {'precision': 0.3577044678591386, 'recall': 0.3423345884884346, 'f1-score': 0.2795950884360417, 'support': 102245}}
[[23939  7842  1175]
 [23586  9532  1323]
 [24005  9312  1531]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
6143/6143 - 52s - 52s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0969489
{'0': {'precision': 0.3259122336311298, 'recall': 0.6872287334279369, 'f1-score': 0.4421423253215132, 'support': 481307}, '1': {'precision': 0.38475675588246, 'recall': 0.32544056912724134, 'f1-score': 0.3526215974080961, 'support': 584755}, '2': {'precision': 0.35874396748793497, 'recall': 0.04462171848312222, 'f1-score': 0.07937101682919848, 'support': 506435}, 'accuracy': 0.3457361126921069, 'macro avg': {'precision': 0.3564709856671749, 'recall': 0.35243034034610016, 'f1-score': 0.2913783131862692, 'support': 1572497}, 'weighted avg': {'precision': 0.35836810969629734, 'recall': 0.3457361126921069, 'f1-score': 0.29201944377241285, 'support': 1572497}}
[[330768 133653  16886]
 [370944 190303  23508]
 [313187 170650  22598]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973641
{'0': {'precision': 0.34820679267933463, 'recall': 0.7033363643507449, 'f1-score': 0.4658039909593767, 'support': 178158}, '1': {'precision': 0.3549496438221567, 'recall': 0.3024158196308677, 'f1-score': 0.3265835929387331, 'support': 176793}, '2': {'precision': 0.35251418767322157, 'recall': 0.04494993408689311, 'f1-score': 0.07973293000855738, 'support': 178265}, 'accuracy': 0.3502951899417872, 'macro avg': {'precision': 0.3518902080582376, 'recall': 0.35023403935616854, 'f1-score': 0.2907068379688891, 'support': 533216}, 'weighted avg': {'precision': 0.351882501305254, 'recall': 0.3502951899417872, 'f1-score': 0.29057265973964314, 'support': 533216}}
[[125305  45631   7222]
 [115832  53465   7496]
 [118721  51531   8013]]
Evaluating performance on  val set...
685/685 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989602
{'0': {'precision': 0.32633797653958946, 'recall': 0.7139784554253322, 'f1-score': 0.4479373338288688, 'support': 54863}, '1': {'precision': 0.36366433509056223, 'recall': 0.2888258964208331, 'f1-score': 0.3219532569415439, 'support': 61383}, '2': {'precision': 0.3646322378716745, 'recall': 0.039540448351349976, 'f1-score': 0.07134436670392089, 'support': 58927}, 'accuracy': 0.33812288423444253, 'macro avg': {'precision': 0.351544849833942, 'recall': 0.3474482667325051, 'f1-score': 0.28041165249144456, 'support': 175173}, 'weighted avg': {'precision': 0.3522995676777793, 'recall': 0.33812288423444253, 'f1-score': 0.27710750066196255, 'support': 175173}}
[[39171 13832  1860]
 [41454 17729  2200]
 [39407 17190  2330]]
testing model on single stock: results/universal/W7/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
23942/23942 - 195s - 195s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098387
{'0': {'precision': 0.3007520685898836, 'recall': 0.7147079650616109, 'f1-score': 0.4233547196476203, 'support': 1809013}, '1': {'precision': 0.41845065411854454, 'recall': 0.2716254291755663, 'f1-score': 0.32941828086890346, 'support': 2520239}, '2': {'precision': 0.3149082781422848, 'recall': 0.03397419834460028, 'f1-score': 0.06133157738213152, 'support': 1799807}, 'accuracy': 0.3326161487432247, 'macro avg': {'precision': 0.34470366695023763, 'recall': 0.3401025308605925, 'f1-score': 0.2713681926328851, 'support': 6129059}, 'weighted avg': {'precision': 0.35330614100785923, 'recall': 0.3326161487432247, 'f1-score': 0.27841989977679554, 'support': 6129059}}
[[1292916  460199   55898]
 [1758549  684561   77129]
 [1247478  491182   61147]]
Evaluating performance on  train set...
9052/9052 - 75s - 75s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996631
{'0': {'precision': 0.3414477913080741, 'recall': 0.785938035809923, 'f1-score': 0.476069150378306, 'support': 778611}, '1': {'precision': 0.3365372356894385, 'recall': 0.1933321301244275, 'f1-score': 0.24558302419348138, 'support': 764622}, '2': {'precision': 0.35355599673011795, 'recall': 0.03912282175371037, 'f1-score': 0.0704499840018616, 'support': 773845}, 'accuracy': 0.3409643525164021, 'macro avg': {'precision': 0.3438470079092102, 'recall': 0.3394643292293536, 'f1-score': 0.264034052857883, 'support': 2317078}, 'weighted avg': {'precision': 0.3438711690996673, 'recall': 0.3409643525164021, 'f1-score': 0.26454363134948067, 'support': 2317078}}
[[611940 138903  27768]
 [589209 147826  27587]
 [591043 152527  30275]]
Evaluating performance on  val set...
2763/2763 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013632
{'0': {'precision': 0.3190489478440366, 'recall': 0.7761393981352442, 'f1-score': 0.45220798644261356, 'support': 222442}, '1': {'precision': 0.35275856203220685, 'recall': 0.20591898120373855, 'f1-score': 0.2600415376778087, 'support': 241697}, '2': {'precision': 0.36519383242360254, 'recall': 0.03769301943045132, 'f1-score': 0.06833312210650305, 'support': 243175}, 'accuracy': 0.3274104570247443, 'macro avg': {'precision': 0.3456671140999487, 'recall': 0.3399171329231447, 'f1-score': 0.26019421540897514, 'support': 707314}, 'weighted avg': {'precision': 0.34643253551241887, 'recall': 0.3274104570247443, 'f1-score': 0.25456616922700537, 'support': 707314}}
[[172646  42039   7757]
 [183751  49770   8176]
 [184730  49279   9166]]
training model: results/universal/W7/deepVOL_L2/h300
Epoch 1/50
12475/12475 - 401s - loss: 3.2820 - accuracy300: 0.3647 - val_loss: 3.3233 - val_accuracy300: 0.3258 - 401s/epoch - 32ms/step
Epoch 2/50
12475/12475 - 396s - loss: 3.2764 - accuracy300: 0.3703 - val_loss: 3.3320 - val_accuracy300: 0.3288 - 396s/epoch - 32ms/step
Epoch 3/50
12475/12475 - 403s - loss: 3.2714 - accuracy300: 0.3745 - val_loss: 3.3365 - val_accuracy300: 0.3352 - 403s/epoch - 32ms/step
Epoch 4/50
12475/12475 - 402s - loss: 3.2681 - accuracy300: 0.3769 - val_loss: 3.3316 - val_accuracy300: 0.3362 - 402s/epoch - 32ms/step
Epoch 5/50
12475/12475 - 400s - loss: 3.2646 - accuracy300: 0.3798 - val_loss: 3.3493 - val_accuracy300: 0.3353 - 400s/epoch - 32ms/step
Epoch 6/50
12475/12475 - 398s - loss: 3.2611 - accuracy300: 0.3822 - val_loss: 3.3618 - val_accuracy300: 0.3370 - 398s/epoch - 32ms/step
Epoch 7/50
12475/12475 - 401s - loss: 3.2576 - accuracy300: 0.3845 - val_loss: 3.3703 - val_accuracy300: 0.3364 - 401s/epoch - 32ms/step
Epoch 8/50
12475/12475 - 400s - loss: 3.2551 - accuracy300: 0.3857 - val_loss: 3.3661 - val_accuracy300: 0.3376 - 400s/epoch - 32ms/step
Epoch 9/50
12475/12475 - 397s - loss: 3.2527 - accuracy300: 0.3874 - val_loss: 3.3579 - val_accuracy300: 0.3382 - 397s/epoch - 32ms/step
Epoch 10/50
12475/12475 - 416s - loss: 3.2505 - accuracy300: 0.3891 - val_loss: 3.3680 - val_accuracy300: 0.3390 - 416s/epoch - 33ms/step
Epoch 11/50
12475/12475 - 416s - loss: 3.2487 - accuracy300: 0.3901 - val_loss: 3.3716 - val_accuracy300: 0.3358 - 416s/epoch - 33ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 616s - 616s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151468
{'0': {'precision': 0.30152140874608935, 'recall': 0.7942968205876421, 'f1-score': 0.43711172144260185, 'support': 2845746}, '1': {'precision': 0.3849355330860357, 'recall': 0.026766934654106907, 'f1-score': 0.05005335195931394, 'support': 3845827}, '2': {'precision': 0.30541987323216635, 'recall': 0.18902707499185323, 'f1-score': 0.23352404333296453, 'support': 2813999}, 'accuracy': 0.3045824070345267, 'macro avg': {'precision': 0.33062560502143046, 'recall': 0.33669694341120077, 'f1-score': 0.24022970557829346, 'support': 9505572}, 'weighted avg': {'precision': 0.33642373411201987, 'recall': 0.3045824070345267, 'f1-score': 0.22024365179380573, 'support': 9505572}}
[[2260367   93255  492124]
 [3025323  102941  717563]
 [2210849   71228  531922]]
Evaluating performance on  train set...
12475/12475 - 209s - 209s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029611
{'0': {'precision': 0.34003012686032974, 'recall': 0.817996740395809, 'f1-score': 0.4803749261313154, 'support': 1073750}, '1': {'precision': 0.3467521689928329, 'recall': 0.02176758759699321, 'f1-score': 0.04096365569567004, 'support': 1055744}, '2': {'precision': 0.34043057977091656, 'recall': 0.17403604772515724, 'f1-score': 0.23032472647048938, 'support': 1063590}, 'accuracy': 0.34023783902960275, 'macro avg': {'precision': 0.34240429187469307, 'recall': 0.33793345857265317, 'f1-score': 0.2505544360991583, 'support': 3193084}, 'weighted avg': {'precision': 0.34238605403302813, 'recall': 0.34023783902960275, 'f1-score': 0.2518007000376492, 'support': 3193084}}
[[878324  22541 172885]
 [847019  22981 185744]
 [857734  20753 185103]]
Evaluating performance on  val set...
3866/3866 - 67s - 67s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106813
{'0': {'precision': 0.32210529750133016, 'recall': 0.812802203891642, 'f1-score': 0.4613730993458308, 'support': 315805}, '1': {'precision': 0.3613770844540075, 'recall': 0.019586862399230288, 'f1-score': 0.03715964875890203, 'support': 342985}, '2': {'precision': 0.336668432081424, 'recall': 0.1769972034913986, 'f1-score': 0.23201618662223278, 'support': 330412}, 'accuracy': 0.3254006765048999, 'macro avg': {'precision': 0.34005027134558724, 'recall': 0.3364620899274236, 'f1-score': 0.2435163115756552, 'support': 989202}, 'weighted avg': {'precision': 0.34058632389517285, 'recall': 0.3254006765048999, 'f1-score': 0.23767649683553746, 'support': 989202}}
[[256687   6184  52934]
 [273975   6718  62292]
 [266242   5688  58482]]
testing model out of sample: results/universal/W7/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 235s - 235s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1158154
{'0': {'precision': 0.29161383541177077, 'recall': 0.8378064166854007, 'f1-score': 0.43263956361427414, 'support': 1089815}, '1': {'precision': 0.4232497413068691, 'recall': 0.0394310337019041, 'f1-score': 0.07214120713564073, 'support': 1545610}, '2': {'precision': 0.32129815656479666, 'recall': 0.1408471976235405, 'f1-score': 0.19584290762044068, 'support': 1138837}, 'accuracy': 0.30056233510021296, 'macro avg': {'precision': 0.34538724442781216, 'recall': 0.33936154933694845, 'f1-score': 0.23354122612345185, 'support': 3774262}, 'weighted avg': {'precision': 0.3544773503875386, 'recall': 0.30056233510021296, 'f1-score': 0.21356026862124244, 'support': 3774262}}
[[ 913054   43772  132989]
 [1278825   60945  205840]
 [ 939159   39276  160402]]
Evaluating performance on  train set...
5285/5285 - 83s - 83s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102344
{'0': {'precision': 0.3391932475284462, 'recall': 0.8009103982276524, 'f1-score': 0.4765591268221508, 'support': 454087}, '1': {'precision': 0.35961760414625116, 'recall': 0.036706424179917936, 'f1-score': 0.06661355545919345, 'support': 449894}, '2': {'precision': 0.35115232917599404, 'recall': 0.18355343073339797, 'f1-score': 0.24108666695941097, 'support': 448665}, 'accuracy': 0.3419601285184742, 'macro avg': {'precision': 0.34998772695023045, 'recall': 0.34039008438032275, 'f1-score': 0.26141978308025177, 'support': 1352646}, 'weighted avg': {'precision': 0.3499532075354309, 'recall': 0.3419601285184742, 'f1-score': 0.26210515727869116, 'support': 1352646}}
[[363683  15470  74934]
 [356143  16514  77237]
 [352374  13937  82354]]
Evaluating performance on  val set...
1714/1714 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056256
{'0': {'precision': 0.32488523671023584, 'recall': 0.7914505836908039, 'f1-score': 0.4606689233253625, 'support': 140571}, '1': {'precision': 0.36283592374243934, 'recall': 0.031162050553670533, 'f1-score': 0.057394769191640875, 'support': 152076}, '2': {'precision': 0.3431642210616874, 'recall': 0.19479733401198182, 'f1-score': 0.24852138507169305, 'support': 145387}, 'accuracy': 0.32946072679289734, 'macro avg': {'precision': 0.3436284605047875, 'recall': 0.3391366560854854, 'f1-score': 0.2555283591962321, 'support': 438034}, 'weighted avg': {'precision': 0.34412784203085905, 'recall': 0.32946072679289734, 'f1-score': 0.2502473249833934, 'support': 438034}}
[[111255   4190  25126]
 [118255   4739  29082]
 [112934   4132  28321]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1134018
{'0': {'precision': 0.2996609875901662, 'recall': 0.9138054633262904, 'f1-score': 0.45132166183718914, 'support': 53008}, '1': {'precision': 0.40209640616086706, 'recall': 0.08225032453798918, 'f1-score': 0.13656563699550756, 'support': 68559}, '2': {'precision': 0.3101153504880213, 'recall': 0.012403073265077984, 'f1-score': 0.023852177918820695, 'support': 56357}, 'accuracy': 0.3078674040601605, 'macro avg': {'precision': 0.3372909147463516, 'recall': 0.3361529537097859, 'f1-score': 0.20391315891717243, 'support': 177924}, 'weighted avg': {'precision': 0.34244355987733993, 'recall': 0.3078674040601605, 'f1-score': 0.19463759441341077, 'support': 177924}}
[[48439  3927   642]
 [62007  5639   913]
 [51200  4458   699]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027858
{'0': {'precision': 0.34132932759314893, 'recall': 0.8953568672055896, 'f1-score': 0.4942426926483613, 'support': 24617}, '1': {'precision': 0.3403469915097822, 'recall': 0.07725825372884196, 'f1-score': 0.1259304787270368, 'support': 23868}, '2': {'precision': 0.3348303393213573, 'recall': 0.028539832418867764, 'f1-score': 0.05259651185577112, 'support': 23511}, 'accuracy': 0.34107450413911883, 'macro avg': {'precision': 0.3388355528080962, 'recall': 0.3337183177844331, 'f1-score': 0.22425656107705638, 'support': 71996}, 'weighted avg': {'precision': 0.3388813567212131, 'recall': 0.34107450413911883, 'f1-score': 0.22791651788186368, 'support': 71996}}
[[22041  1919   657]
 [21348  1844   676]
 [21185  1655   671]]
Evaluating performance on  val set...
73/73 - 1s - 676ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022159
{'0': {'precision': 0.34282807731434384, 'recall': 0.9118255610377208, 'f1-score': 0.49830390536661734, 'support': 6283}, '1': {'precision': 0.334534967555876, 'recall': 0.07983482450103235, 'f1-score': 0.12890679261008473, 'support': 5812}, '2': {'precision': 0.33658536585365856, 'recall': 0.02151878995789802, 'f1-score': 0.040451414333870735, 'support': 6413}, 'accuracy': 0.3420682947914415, 'macro avg': {'precision': 0.3379828035746261, 'recall': 0.33772639183221703, 'f1-score': 0.22255403743685762, 'support': 18508}, 'weighted avg': {'precision': 0.3380607300853839, 'recall': 0.3420682947914415, 'f1-score': 0.22365812817113584, 'support': 18508}}
[[5729  431  123]
 [5199  464  149]
 [5783  492  138]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023412
{'0': {'precision': 0.3350569195562796, 'recall': 0.8055613838765329, 'f1-score': 0.473267726780896, 'support': 171576}, '1': {'precision': 0.36938469685531755, 'recall': 0.18488191107802665, 'f1-score': 0.24642490707577125, 'support': 177324}, '2': {'precision': 0.3464566929133858, 'recall': 0.025421151857933467, 'f1-score': 0.047366780928638205, 'support': 164430}, 'accuracy': 0.3412600081818713, 'macro avg': {'precision': 0.350299436441661, 'recall': 0.33862148227083094, 'f1-score': 0.2556864715951018, 'support': 513330}, 'weighted avg': {'precision': 0.35056663750552003, 'recall': 0.3412600081818713, 'f1-score': 0.2584827567073015, 'support': 513330}}
[[138215  29613   3748]
 [140403  32784   4137]
 [133894  26356   4180]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005841
{'0': {'precision': 0.34061788154897493, 'recall': 0.8175993165313968, 'f1-score': 0.48089243988844504, 'support': 46820}, '1': {'precision': 0.36846607536806086, 'recall': 0.17166589755422243, 'f1-score': 0.23421335050440006, 'support': 47674}, '2': {'precision': 0.3789938817131203, 'recall': 0.025904328229909627, 'f1-score': 0.04849407415461564, 'support': 43043}, 'accuracy': 0.3459360026756437, 'macro avg': {'precision': 0.3626926128767187, 'recall': 0.33838984743850964, 'f1-score': 0.2545332881824869, 'support': 137537}, 'weighted avg': {'precision': 0.36228080110659516, 'recall': 0.3459360026756437, 'f1-score': 0.2600653041825901, 'support': 137537}}
[[38280  7638   902]
 [38565  8184   925]
 [35539  6389  1115]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1023716
{'0': {'precision': 0.32115249472944485, 'recall': 0.7984434561626429, 'f1-score': 0.4580618707002597, 'support': 12592}, '1': {'precision': 0.3712924542800061, 'recall': 0.18155857819192905, 'f1-score': 0.24386797214091047, 'support': 13307}, '2': {'precision': 0.3904607922392886, 'recall': 0.03672724507642004, 'f1-score': 0.067139282735613, 'support': 13151}, 'accuracy': 0.33170294494238156, 'macro avg': {'precision': 0.3609685804162465, 'recall': 0.3389097598103306, 'f1-score': 0.25635637519226107, 'support': 39050}, 'weighted avg': {'precision': 0.36157978953844033, 'recall': 0.33170294494238156, 'f1-score': 0.253419075246935, 'support': 39050}}
[[10054  2148   390]
 [10527  2416   364]
 [10725  1943   483]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027533
{'0': {'precision': 0.3291475701853673, 'recall': 0.9108940125295265, 'f1-score': 0.4835620919486962, 'support': 77896}, '1': {'precision': 0.40241004752206383, 'recall': 0.08809432396616425, 'f1-score': 0.14454526056960548, 'support': 80743}, '2': {'precision': 0.36470087289759423, 'recall': 0.021599878949890298, 'f1-score': 0.040784257705081955, 'support': 79306}, 'accuracy': 0.3352917691063061, 'macro avg': {'precision': 0.36541949686834174, 'recall': 0.3401960718151937, 'f1-score': 0.2229638700744612, 'support': 237945}, 'weighted avg': {'precision': 0.36585782857488064, 'recall': 0.3352917691063061, 'f1-score': 0.22094604648202956, 'support': 237945}}
[[70955  5438  1503]
 [72149  7113  1481]
 [72468  5125  1713]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027727
{'0': {'precision': 0.3333333333333333, 'recall': 0.869244364515829, 'f1-score': 0.4818784216994834, 'support': 32251}, '1': {'precision': 0.37869667626275844, 'recall': 0.04499797866716423, 'f1-score': 0.08043804547223304, 'support': 32157}, '2': {'precision': 0.3556991039799958, 'recall': 0.1031015009210884, 'f1-score': 0.15986514012783593, 'support': 33113}, 'accuracy': 0.3373119635770757, 'macro avg': {'precision': 0.3559097045253625, 'recall': 0.33911461470136056, 'f1-score': 0.24072720243318413, 'support': 97521}, 'weighted avg': {'precision': 0.3558858787543652, 'recall': 0.3373119635770757, 'f1-score': 0.24016695472291782, 'support': 97521}}
[[28034  1209  3008]
 [27534  1447  3176]
 [28534  1165  3414]]
Evaluating performance on  val set...
114/114 - 1s - 934ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052316
{'0': {'precision': 0.32080360345995934, 'recall': 0.870995670995671, 'f1-score': 0.4689020304716404, 'support': 9240}, '1': {'precision': 0.4183564567769477, 'recall': 0.03988198189032455, 'f1-score': 0.07282184655396619, 'support': 9829}, '2': {'precision': 0.34032099574189323, 'recall': 0.10381694644284573, 'f1-score': 0.1590996095245387, 'support': 10008}, 'accuracy': 0.3259964920727723, 'macro avg': {'precision': 0.35982701865960004, 'recall': 0.33823153310961374, 'f1-score': 0.23360782885004847, 'support': 29077}, 'weighted avg': {'precision': 0.36049741840683397, 'recall': 0.3259964920727723, 'f1-score': 0.22838290000545014, 'support': 29077}}
[[8048  251  941]
 [8364  392 1073]
 [8675  294 1039]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1065/1065 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126887
{'0': {'precision': 0.2993844689701751, 'recall': 0.9561253002598167, 'f1-score': 0.4559885909335329, 'support': 81596}, '1': {'precision': 0.3291743834681743, 'recall': 0.03630831424915868, 'f1-score': 0.06540264167021728, 'support': 93009}, '2': {'precision': 0.3725124378109453, 'recall': 0.006121614716402657, 'f1-score': 0.012045285447123409, 'support': 97850}, 'accuracy': 0.300937769539924, 'macro avg': {'precision': 0.33369043008309823, 'recall': 0.33285174307512605, 'f1-score': 0.1778121726836245, 'support': 272455}, 'weighted avg': {'precision': 0.33581728139282757, 'recall': 0.300937769539924, 'f1-score': 0.16321414745891547, 'support': 272455}}
[[78016  3122   458]
 [89081  3377   551]
 [93491  3760   599]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033998
{'0': {'precision': 0.3440676928101907, 'recall': 0.9540103016924208, 'f1-score': 0.5057386764286679, 'support': 35334}, '1': {'precision': 0.320707699975081, 'recall': 0.03808030298547208, 'f1-score': 0.06807722824649563, 'support': 33797}, '2': {'precision': 0.357032457496136, 'recall': 0.006895316557714695, 'f1-score': 0.013529342860489634, 'support': 33501}, 'accuracy': 0.34323602774962975, 'macro avg': {'precision': 0.3406026167604692, 'recall': 0.33299530707853586, 'f1-score': 0.19578174917855107, 'support': 102632}, 'weighted avg': {'precision': 0.34060712401971255, 'recall': 0.34323602774962975, 'f1-score': 0.2009492457629845, 'support': 102632}}
[[33709  1408   217]
 [32311  1287   199]
 [31952  1318   231]]
Evaluating performance on  val set...
123/123 - 1s - 990ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1118643
{'0': {'precision': 0.3025847443531486, 'recall': 0.9618272179338057, 'f1-score': 0.46034718356192106, 'support': 9457}, '1': {'precision': 0.33654688869412797, 'recall': 0.0366412213740458, 'f1-score': 0.066087255829963, 'support': 10480}, '2': {'precision': 0.39664804469273746, 'recall': 0.0062041244320167775, 'f1-score': 0.012217155639679945, 'support': 11444}, 'accuracy': 0.30435613906503933, 'macro avg': {'precision': 0.3452598925800046, 'recall': 0.33489085457995604, 'f1-score': 0.179550531677188, 'support': 31381}, 'weighted avg': {'precision': 0.3482296786057129, 'recall': 0.30435613906503933, 'f1-score': 0.16525639352422156, 'support': 31381}}
[[ 9096   314    47]
 [10035   384    61]
 [10930   443    71]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1227006
{'0': {'precision': 0.2668836265188681, 'recall': 0.9308681385312266, 'f1-score': 0.4148329760327114, 'support': 112148}, '1': {'precision': 0.45384512325830656, 'recall': 0.03769564177177862, 'f1-score': 0.06960962102570162, 'support': 179729}, '2': {'precision': 0.27056732920889826, 'recall': 0.03176774233432245, 'f1-score': 0.05685951784899241, 'support': 129408}, 'accuracy': 0.27364135917490534, 'macro avg': {'precision': 0.33043202632869095, 'recall': 0.3334438408791092, 'f1-score': 0.18043403830246849, 'support': 421285}, 'weighted avg': {'precision': 0.347776854251149, 'recall': 0.27364135917490534, 'f1-score': 0.15759315584283146, 'support': 421285}}
[[104395   3877   3876]
 [165747   6775   7207]
 [121021   4276   4111]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103802
{'0': {'precision': 0.33801426220515635, 'recall': 0.9502764865281664, 'f1-score': 0.4986560771325021, 'support': 45391}, '1': {'precision': 0.35465801886792453, 'recall': 0.02707264380232244, 'f1-score': 0.05030526051685205, 'support': 44436}, '2': {'precision': 0.3196220122290161, 'recall': 0.02568512273021687, 'f1-score': 0.047549151351016096, 'support': 44773}, 'accuracy': 0.33794205052005943, 'macro avg': {'precision': 0.337431431100699, 'recall': 0.33434475102023525, 'f1-score': 0.1988368296667901, 'support': 134600}, 'weighted avg': {'precision': 0.33739097663966633, 'recall': 0.33794205052005943, 'f1-score': 0.20058529499916258, 'support': 134600}}
[[43134  1099  1158]
 [41943  1203  1290]
 [42533  1090  1150]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1104486
{'0': {'precision': 0.31396237091526386, 'recall': 0.9562257647565704, 'f1-score': 0.47271565495207674, 'support': 11605}, '1': {'precision': 0.39243498817966904, 'recall': 0.02487823154739603, 'f1-score': 0.046790219152984286, 'support': 13345}, '2': {'precision': 0.2768166089965398, 'recall': 0.025812696620150035, 'f1-score': 0.047222017265550066, 'support': 12397}, 'accuracy': 0.31459019466088306, 'macro avg': {'precision': 0.3277379893638242, 'recall': 0.33563889764137217, 'f1-score': 0.18890929712353702, 'support': 37347}, 'weighted avg': {'precision': 0.3296723627991385, 'recall': 0.31459019466088306, 'f1-score': 0.17928326233315797, 'support': 37347}}
[[11097   244   264]
 [12441   332   572]
 [11807   270   320]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
5929/5929 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015471
{'0': {'precision': 0.33469449461459405, 'recall': 0.8289163153167327, 'f1-score': 0.47684969040309755, 'support': 502111}, '1': {'precision': 0.36790478273093624, 'recall': 0.06419814552015743, 'f1-score': 0.10932027179226952, 'support': 550343}, '2': {'precision': 0.39197950492713235, 'recall': 0.15000462247295854, 'f1-score': 0.2169758658276228, 'support': 465119}, 'accuracy': 0.34351494129112736, 'macro avg': {'precision': 0.3648595940908876, 'recall': 0.3477063611032829, 'f1-score': 0.2677152760076633, 'support': 1517573}, 'weighted avg': {'precision': 0.3642953087463489, 'recall': 0.34351494129112736, 'f1-score': 0.2639179261721451, 'support': 1517573}}
[[416208  39174  46729]
 [453517  35331  61495]
 [373821  21528  69770]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005197
{'0': {'precision': 0.3362013361893917, 'recall': 0.8001990049751244, 'f1-score': 0.4734739421397472, 'support': 105525}, '1': {'precision': 0.32043548624393114, 'recall': 0.02059769245318706, 'f1-score': 0.03870726960910634, 'support': 105740}, '2': {'precision': 0.3881667698265327, 'recall': 0.22294741255936484, 'f1-score': 0.28322293760711476, 'support': 109703}, 'accuracy': 0.34606876697988587, 'macro avg': {'precision': 0.34826786408661853, 'recall': 0.3479147033292254, 'f1-score': 0.26513471645198944, 'support': 320968}, 'weighted avg': {'precision': 0.34876857963129954, 'recall': 0.34606876697988587, 'f1-score': 0.26521849641421275, 'support': 320968}}
[[84441  2550 18534]
 [83545  2178 20017]
 [83176  2069 24458]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102728
{'0': {'precision': 0.3310363932269123, 'recall': 0.8119585527433327, 'f1-score': 0.4703219934568174, 'support': 35322}, '1': {'precision': 0.3506944444444444, 'recall': 0.024121003051612046, 'f1-score': 0.04513742334334732, 'support': 37685}, '2': {'precision': 0.38414573115804224, 'recall': 0.21202077118550436, 'f1-score': 0.2732353255259317, 'support': 36204}, 'accuracy': 0.3412202067557297, 'macro avg': {'precision': 0.35529218960979964, 'recall': 0.34936677566014973, 'f1-score': 0.2628982474420321, 'support': 109211}, 'weighted avg': {'precision': 0.355425732493024, 'recall': 0.3412202067557297, 'f1-score': 0.25827003668967946, 'support': 109211}}
[[28680   932  5710]
 [30180   909  6596]
 [27777   751  7676]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
5331/5331 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1120232
{'0': {'precision': 0.2999096971380939, 'recall': 0.8402298347272293, 'f1-score': 0.4420390105185831, 'support': 411078}, '1': {'precision': 0.3948338395305635, 'recall': 0.05028125962253382, 'f1-score': 0.08920273803773962, 'support': 532604}, '2': {'precision': 0.338697450034459, 'recall': 0.11675504366583991, 'f1-score': 0.17364988057043518, 'support': 420924}, 'accuracy': 0.30875212332350876, 'macro avg': {'precision': 0.3444803289010388, 'recall': 0.3357553793385344, 'f1-score': 0.23496387637558594, 'support': 1364606}, 'weighted avg': {'precision': 0.34892287312804887, 'recall': 0.30875212332350876, 'f1-score': 0.22154061303045733, 'support': 1364606}}
[[345400  22775  42903]
 [452772  26780  53052]
 [353508  18271  49145]]
Evaluating performance on  train set...
2013/2013 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021954
{'0': {'precision': 0.34043169374179827, 'recall': 0.862030639487585, 'f1-score': 0.48810269153287933, 'support': 174546}, '1': {'precision': 0.3602373683668919, 'recall': 0.060709062425934594, 'f1-score': 0.10390715437662633, 'support': 172989}, '2': {'precision': 0.36625998777699814, 'recall': 0.09644349344665837, 'f1-score': 0.1526826322444281, 'support': 167777}, 'accuracy': 0.34376649486136557, 'macro avg': {'precision': 0.35564301662856274, 'recall': 0.33972773178672594, 'f1-score': 0.24823082605131128, 'support': 515312}, 'weighted avg': {'precision': 0.355489673249483, 'recall': 0.34376649486136557, 'f1-score': 0.2499219911720076, 'support': 515312}}
[[150464  10030  14052]
 [148541  10502  13946]
 [142975   8621  16181]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028339
{'0': {'precision': 0.33305520506871805, 'recall': 0.8410765066639257, 'f1-score': 0.4771609617664782, 'support': 58374}, '1': {'precision': 0.35938378499943774, 'recall': 0.0526671390669545, 'f1-score': 0.09187076003219502, 'support': 60683}, '2': {'precision': 0.38507076126167794, 'recall': 0.1414254654164968, 'f1-score': 0.20687256193008174, 'support': 58872}, 'accuracy': 0.3406920738047199, 'macro avg': {'precision': 0.35916991710994456, 'recall': 0.345056370382459, 'f1-score': 0.25863476124291834, 'support': 177929}, 'weighted avg': {'precision': 0.3592451855672753, 'recall': 0.3406920738047199, 'f1-score': 0.25632577477048635, 'support': 177929}}
[[49097  2927  6350]
 [50541  3196  6946]
 [47776  2770  8326]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
4192/4192 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1225942
{'0': {'precision': 0.2670549477731929, 'recall': 0.8273195606967826, 'f1-score': 0.40377362660340466, 'support': 287091}, '1': {'precision': 0.46770355754164006, 'recall': 0.016622766940928225, 'f1-score': 0.032104499968130536, 'support': 484817}, '2': {'precision': 0.3116033843955107, 'recall': 0.1722568566136196, 'f1-score': 0.22186497239033628, 'support': 301242}, 'accuracy': 0.2771895820714718, 'macro avg': {'precision': 0.3487872965701146, 'recall': 0.3387330614171102, 'f1-score': 0.21924769965395716, 'support': 1073150}, 'weighted avg': {'precision': 0.37020708604565206, 'recall': 0.2771895820714718, 'f1-score': 0.18480140670834166, 'support': 1073150}}
[[237516   5026  44549]
 [406669   8059  70089]
 [245205   4146  51891]]
Evaluating performance on  train set...
1230/1230 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099879
{'0': {'precision': 0.3496530590680145, 'recall': 0.8260720824010208, 'f1-score': 0.4913369977974719, 'support': 108154}, '1': {'precision': 0.35925096682271523, 'recall': 0.017314106337061017, 'f1-score': 0.03303604016733269, 'support': 101940}, '2': {'precision': 0.35958482593919355, 'recall': 0.18682294102488237, 'f1-score': 0.24589216622280288, 'support': 104773}, 'accuracy': 0.3515198480628329, 'macro avg': {'precision': 0.35616295060997444, 'recall': 0.34340304325432136, 'f1-score': 0.25675506806253584, 'support': 314867}, 'weighted avg': {'precision': 0.3560652639891661, 'recall': 0.3515198480628329, 'f1-score': 0.26128687835215314, 'support': 314867}}
[[89343  1768 17043]
 [82357  1765 17818]
 [83819  1380 19574]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048503
{'0': {'precision': 0.3287398348357814, 'recall': 0.7820870452023156, 'f1-score': 0.4629041134802138, 'support': 33339}, '1': {'precision': 0.36451048951048953, 'recall': 0.011891861061997376, 'f1-score': 0.02303231151615576, 'support': 35066}, '2': {'precision': 0.32892683374644266, 'recall': 0.2117612293144208, 'f1-score': 0.2576493006867292, 'support': 33840}, 'accuracy': 0.3291799109980928, 'macro avg': {'precision': 0.34072571936423784, 'recall': 0.33524671185957794, 'f1-score': 0.24786190856103293, 'support': 102245}, 'weighted avg': {'precision': 0.3410696487138204, 'recall': 0.3291799109980928, 'f1-score': 0.24411231463818556, 'support': 102245}}
[[26074   364  6901]
 [26930   417  7719]
 [26311   363  7166]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
6143/6143 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1194607
{'0': {'precision': 0.28389545649003245, 'recall': 0.7889828660614894, 'f1-score': 0.4175471648838059, 'support': 435685}, '1': {'precision': 0.4874336870026525, 'recall': 0.021493475638729487, 'f1-score': 0.04117148718379579, 'support': 683975}, '2': {'precision': 0.3154417886316196, 'recall': 0.23092822662208895, 'f1-score': 0.2666486476838383, 'support': 452842}, 'accuracy': 0.2944498639747358, 'macro avg': {'precision': 0.3622569773747682, 'recall': 0.34713485610743594, 'f1-score': 0.24178909991714667, 'support': 1572502}, 'weighted avg': {'precision': 0.38151095418385406, 'recall': 0.2944498639747358, 'f1-score': 0.21038384141538924, 'support': 1572502}}
[[343748   7971  83966]
 [526298  14701 142976]
 [340780   7488 104574]]
Evaluating performance on  train set...
2083/2083 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020665
{'0': {'precision': 0.3380525027595143, 'recall': 0.6754662063830508, 'f1-score': 0.45059462551104307, 'support': 177282}, '1': {'precision': 0.35301668806161746, 'recall': 0.007792840788012061, 'f1-score': 0.015249058717193729, 'support': 176444}, '2': {'precision': 0.34714694476649555, 'recall': 0.3386409346429626, 'f1-score': 0.3428411885477066, 'support': 179491}, 'accuracy': 0.34114816294304195, 'macro avg': {'precision': 0.3460720451958757, 'recall': 0.34063332727134177, 'f1-score': 0.2695616242586478, 'support': 533217}, 'weighted avg': {'precision': 0.34606558411610905, 'recall': 0.34114816294304195, 'f1-score': 0.27026488107048663, 'support': 533217}}
[[119748   1291  56243]
 [117002   1375  58067]
 [117479   1229  60783]]
Evaluating performance on  val set...
685/685 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1078202
{'0': {'precision': 0.31671337579617836, 'recall': 0.677204961048866, 'f1-score': 0.4315844901312934, 'support': 55069}, '1': {'precision': 0.35822401614530774, 'recall': 0.005688464435079399, 'f1-score': 0.011199091453989085, 'support': 62407}, '2': {'precision': 0.3301141196484264, 'recall': 0.3228764060523077, 'f1-score': 0.32645515162666805, 'support': 57697}, 'accuracy': 0.321265263482386, 'macro avg': {'precision': 0.3350171705299709, 'recall': 0.3352566105120844, 'f1-score': 0.2564129110706502, 'support': 175173}, 'weighted avg': {'precision': 0.33591574859513296, 'recall': 0.321265263482386, 'f1-score': 0.24719169547140918, 'support': 175173}}
[[37293   323 17453]
 [41702   355 20350]
 [38755   313 18629]]
testing model on single stock: results/universal/W7/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
23942/23942 - 191s - 191s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1183951
{'0': {'precision': 0.29653202431680403, 'recall': 0.7713089700849298, 'f1-score': 0.4283742831977235, 'support': 1803372}, '1': {'precision': 0.42349761700418165, 'recall': 0.009129508167036303, 'f1-score': 0.017873705684219126, 'support': 2540334}, '2': {'precision': 0.2932652381224283, 'recall': 0.22726422375792418, 'f1-score': 0.25608040112202585, 'support': 1785358}, 'accuracy': 0.2969290253781001, 'macro avg': {'precision': 0.33776495981447135, 'recall': 0.3359009006699634, 'f1-score': 0.23410946333465618, 'support': 6129064}, 'weighted avg': {'precision': 0.34820429092512767, 'recall': 0.2969290253781001, 'f1-score': 0.20804458280756705, 'support': 6129064}}
[[1390957   15899  396516]
 [1935853   23192  581289]
 [1363938   15672  405748]]
Evaluating performance on  train set...
9052/9052 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038529
{'0': {'precision': 0.339044231317634, 'recall': 0.8130764593137828, 'f1-score': 0.47854167604511194, 'support': 777917}, '1': {'precision': 0.33090281447039344, 'recall': 0.01225422094905641, 'f1-score': 0.023633239494730698, 'support': 766593}, '2': {'precision': 0.33049263237501036, 'recall': 0.18101013500394786, 'f1-score': 0.23390886548103418, 'support': 772570}, 'accuracy': 0.3373828266611425, 'macro avg': {'precision': 0.3334798927210126, 'recall': 0.3354469384222623, 'f1-score': 0.24536126034029226, 'support': 2317080}, 'weighted avg': {'precision': 0.3334993809195988, 'recall': 0.3373828266611425, 'f1-score': 0.24647131440116526, 'support': 2317080}}
[[632506   9386 136025]
 [609932   9394 147267]
 [623118   9609 139843]]
Evaluating performance on  val set...
2763/2763 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1078292
{'0': {'precision': 0.32082916986426946, 'recall': 0.8116217597014593, 'f1-score': 0.4598732335513233, 'support': 225095}, '1': {'precision': 0.3651778329197684, 'recall': 0.010748761396973791, 'f1-score': 0.02088285028438989, 'support': 246447}, '2': {'precision': 0.3283546668299853, 'recall': 0.18191650443434998, 'f1-score': 0.2341230959860479, 'support': 235773}, 'accuracy': 0.3226737733541633, 'macro avg': {'precision': 0.3381205565380077, 'recall': 0.33476234184426107, 'f1-score': 0.23829305994058703, 'support': 707315}, 'weighted avg': {'precision': 0.33878991431354066, 'recall': 0.3226737733541633, 'f1-score': 0.23166705925958112, 'support': 707315}}
[[182692   2225  40178]
 [196243   2649  47555]
 [190502   2380  42891]]
training model: results/universal/W7/deepVOL_L2/h500
Epoch 1/50
12475/12475 - 401s - loss: 3.2836 - accuracy500: 0.3625 - val_loss: 3.3034 - val_accuracy500: 0.3430 - 401s/epoch - 32ms/step
Epoch 2/50
12475/12475 - 396s - loss: 3.2777 - accuracy500: 0.3683 - val_loss: 3.3399 - val_accuracy500: 0.3437 - 396s/epoch - 32ms/step
Epoch 3/50
12475/12475 - 401s - loss: 3.2769 - accuracy500: 0.3705 - val_loss: 3.3283 - val_accuracy500: 0.3382 - 401s/epoch - 32ms/step
Epoch 4/50
12475/12475 - 398s - loss: 3.2720 - accuracy500: 0.3750 - val_loss: 3.3232 - val_accuracy500: 0.3401 - 398s/epoch - 32ms/step
Epoch 5/50
12475/12475 - 396s - loss: 3.2697 - accuracy500: 0.3775 - val_loss: 3.3430 - val_accuracy500: 0.3362 - 396s/epoch - 32ms/step
Epoch 6/50
12475/12475 - 393s - loss: 3.2654 - accuracy500: 0.3807 - val_loss: 3.3684 - val_accuracy500: 0.3348 - 393s/epoch - 31ms/step
Epoch 7/50
12475/12475 - 395s - loss: 3.2637 - accuracy500: 0.3812 - val_loss: 3.3501 - val_accuracy500: 0.3350 - 395s/epoch - 32ms/step
Epoch 8/50
12475/12475 - 400s - loss: 3.2603 - accuracy500: 0.3840 - val_loss: 3.3755 - val_accuracy500: 0.3360 - 400s/epoch - 32ms/step
Epoch 9/50
12475/12475 - 395s - loss: 3.2583 - accuracy500: 0.3855 - val_loss: 3.3618 - val_accuracy500: 0.3371 - 395s/epoch - 32ms/step
Epoch 10/50
12475/12475 - 398s - loss: 3.2565 - accuracy500: 0.3865 - val_loss: 3.3567 - val_accuracy500: 0.3371 - 398s/epoch - 32ms/step
Epoch 11/50
12475/12475 - 397s - loss: 3.2541 - accuracy500: 0.3883 - val_loss: 3.3603 - val_accuracy500: 0.3371 - 397s/epoch - 32ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 583s - 583s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0950811
{'0': {'precision': 0.3028723824157545, 'recall': 0.1183682253288341, 'f1-score': 0.17021372464359422, 'support': 2904200}, '1': {'precision': 0.38955276768712144, 'recall': 0.8629312706046407, 'f1-score': 0.5367849082472624, 'support': 3727619}, '2': {'precision': 0.2964785497208283, 'recall': 0.011677760753968765, 'f1-score': 0.022470450577429447, 'support': 2873753}, 'accuracy': 0.3780943429811483, 'macro avg': {'precision': 0.3296345666079014, 'recall': 0.3309924188958145, 'f1-score': 0.24315636115609537, 'support': 9505572}, 'weighted avg': {'precision': 0.334931174372338, 'recall': 0.3780943429811483, 'f1-score': 0.26929876989663726, 'support': 9505572}}
[[ 343765 2526421   34014]
 [ 465321 3216679   45619]
 [ 325930 2514264   33559]]
Evaluating performance on  train set...
12475/12475 - 198s - 198s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026764
{'0': {'precision': 0.34368034613871773, 'recall': 0.11794117564348806, 'f1-score': 0.1756160064317164, 'support': 1066803}, '1': {'precision': 0.3355580861595236, 'recall': 0.8743114381503734, 'f1-score': 0.48498167281379145, 'support': 1068713}, '2': {'precision': 0.33622580112711925, 'recall': 0.013482820962812793, 'f1-score': 0.025925996634475087, 'support': 1057568}, 'accuracy': 0.33649819422226285, 'macro avg': {'precision': 0.3384880778084535, 'recall': 0.3352451449188914, 'f1-score': 0.22884122529332762, 'support': 3193084}, 'weighted avg': {'precision': 0.3384928681118413, 'recall': 0.33649819422226285, 'f1-score': 0.22958130929720247, 'support': 3193084}}
[[125820 926475  14508]
 [120683 934388  13642]
 [119593 923716  14259]]
Evaluating performance on  val set...
3866/3866 - 62s - 62s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009319
{'0': {'precision': 0.324663256456095, 'recall': 0.11679104002445019, 'f1-score': 0.17178566244129037, 'support': 314108}, '1': {'precision': 0.3452103480392384, 'recall': 0.8744842562432139, 'f1-score': 0.4950108222052049, 'support': 340770}, '2': {'precision': 0.3385753931544866, 'recall': 0.01313695696390328, 'f1-score': 0.02529254583985995, 'support': 334324}, 'accuracy': 0.34277629847088864, 'macro avg': {'precision': 0.3361496658832734, 'recall': 0.33480408441052245, 'f1-score': 0.23069634349545176, 'support': 989202}, 'weighted avg': {'precision': 0.33644345260242386, 'recall': 0.34277629847088864, 'f1-score': 0.23362265122426143, 'support': 989202}}
[[ 36685 273216   4207]
 [ 38399 297998   4373]
 [ 37910 292022   4392]]
testing model out of sample: results/universal/W7/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 230s - 230s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0909145
{'0': {'precision': 0.3245015687250284, 'recall': 0.10165226023322654, 'f1-score': 0.15480944048191622, 'support': 1116168}, '1': {'precision': 0.3970782839912911, 'recall': 0.9051705203030427, 'f1-score': 0.5520044337705523, 'support': 1488767}, '2': {'precision': 0.3194192377495463, 'recall': 0.008428779973437713, 'f1-score': 0.016424161981964416, 'support': 1169327}, 'accuracy': 0.389719897558781, 'macro avg': {'precision': 0.34699969682195525, 'recall': 0.338417186836569, 'f1-score': 0.24107934541147766, 'support': 3774262}, 'weighted avg': {'precision': 0.3515550461529972, 'recall': 0.389719897558781, 'f1-score': 0.2686100075916796, 'support': 3774262}}
[[ 113461  992700   10007]
 [ 130186 1347588   10993]
 [ 106000 1053471    9856]]
Evaluating performance on  train set...
5285/5285 - 88s - 88s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028084
{'0': {'precision': 0.3541212975219551, 'recall': 0.10887183234801177, 'f1-score': 0.16654171324528577, 'support': 457042}, '1': {'precision': 0.33287726432008036, 'recall': 0.8927200236266982, 'f1-score': 0.4849328603956853, 'support': 446952}, '2': {'precision': 0.3470295928205889, 'recall': 0.010429018482030617, 'f1-score': 0.02024949419541909, 'support': 448652}, 'accuracy': 0.33522518086772146, 'macro avg': {'precision': 0.34467605155420805, 'recall': 0.33734029148558015, 'f1-score': 0.22390802261213005, 'support': 1352646}, 'weighted avg': {'precision': 0.3447494658488332, 'recall': 0.33522518086772146, 'f1-score': 0.22322414408085145, 'support': 1352646}}
[[ 49759 402499   4784]
 [ 43929 399003   4020]
 [ 46826 397147   4679]]
Evaluating performance on  val set...
1714/1714 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035591
{'0': {'precision': 0.3512622188478694, 'recall': 0.10302068763960504, 'f1-score': 0.15931603329441452, 'support': 143709}, '1': {'precision': 0.32793006008548664, 'recall': 0.9009276645833917, 'f1-score': 0.48083884285158707, 'support': 142724}, '2': {'precision': 0.3472736897829539, 'recall': 0.008654296475616916, 'f1-score': 0.016887739012350446, 'support': 151601}, 'accuracy': 0.3303419369272705, 'macro avg': {'precision': 0.3421553229054366, 'recall': 0.3375342162328712, 'f1-score': 0.21901420505278402, 'support': 438034}, 'weighted avg': {'precision': 0.34227952795635735, 'recall': 0.3303419369272705, 'f1-score': 0.21478375869879568, 'support': 438034}}
[[ 14805 127576   1328]
 [ 13002 128584   1138]
 [ 14341 135948   1312]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0956577
{'0': {'precision': 0.26982852406361707, 'recall': 0.2100667486741011, 'f1-score': 0.2362265434548444, 'support': 49589}, '1': {'precision': 0.3965136755756671, 'recall': 0.7465898121073912, 'f1-score': 0.5179462292536153, 'support': 71477}, '2': {'precision': 0.302428722280887, 'recall': 0.02518554996658342, 'f1-score': 0.04649879044696638, 'support': 56858}, 'accuracy': 0.3665216609338819, 'macro avg': {'precision': 0.3229236406400571, 'recall': 0.3272807035826919, 'f1-score': 0.2668905210518087, 'support': 177924}, 'weighted avg': {'precision': 0.33113928958633654, 'recall': 0.3665216609338819, 'f1-score': 0.2887710984407756, 'support': 177924}}
[[10417 37765  1407]
 [16217 53364  1896]
 [11972 43454  1432]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1020545
{'0': {'precision': 0.34388885412103387, 'recall': 0.2245331589915417, 'f1-score': 0.27168001582122026, 'support': 24473}, '1': {'precision': 0.33604763317999703, 'recall': 0.7448811775347423, 'f1-score': 0.4631490144949766, 'support': 24322}, '2': {'precision': 0.32399049881235154, 'recall': 0.029395284686004913, 'f1-score': 0.05390026080771358, 'support': 23201}, 'accuracy': 0.3374354130785044, 'macro avg': {'precision': 0.3346423287044608, 'recall': 0.3329365404040963, 'f1-score': 0.26290976370797015, 'support': 71996}, 'weighted avg': {'precision': 0.33482757408818986, 'recall': 0.3374354130785044, 'f1-score': 0.2661825005380758, 'support': 71996}}
[[ 5495 18249   729]
 [ 5511 18117   694]
 [ 4973 17546   682]]
Evaluating performance on  val set...
73/73 - 1s - 675ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992005
{'0': {'precision': 0.3181993817619784, 'recall': 0.27905794645882753, 'f1-score': 0.29734609135222967, 'support': 5902}, '1': {'precision': 0.35112692763938314, 'recall': 0.7082469293348221, 'f1-score': 0.46949349688061753, 'support': 6269}, '2': {'precision': 0.3508005822416303, 'recall': 0.0380306138551365, 'f1-score': 0.06862186788154898, 'support': 6337}, 'accuracy': 0.34190620272314676, 'macro avg': {'precision': 0.3400422972143306, 'recall': 0.34177849654959536, 'f1-score': 0.27848715203813207, 'support': 18508}, 'weighted avg': {'precision': 0.340514953003874, 'recall': 0.34190620272314676, 'f1-score': 0.27734212988279805, 'support': 18508}}
[[1647 4009  246]
 [1629 4440  200]
 [1900 4196  241]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.112677
{'0': {'precision': 0.3877252800779347, 'recall': 0.05159227412176468, 'f1-score': 0.09106683191915341, 'support': 185144}, '1': {'precision': 0.29411401357686867, 'recall': 0.9517670104741345, 'f1-score': 0.4493655654701516, 'support': 150084}, '2': {'precision': 0.373134328358209, 'recall': 0.006316605091464441, 'f1-score': 0.012422908948359348, 'support': 178102}, 'accuracy': 0.2990707731868389, 'macro avg': {'precision': 0.35165787400433746, 'recall': 0.3365586298957879, 'f1-score': 0.1842851021125548, 'support': 513330}, 'weighted avg': {'precision': 0.35529345064125156, 'recall': 0.2990707731868389, 'f1-score': 0.16853798528506547, 'support': 513330}}
[[  9552 174485   1107]
 [  6456 142845    783]
 [  8628 168349   1125]]
Evaluating performance on  train set...
538/538 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1073548
{'0': {'precision': 0.3698405602741767, 'recall': 0.051063654692836274, 'f1-score': 0.0897373321040548, 'support': 48606}, '1': {'precision': 0.32454454608348066, 'recall': 0.9471676948962423, 'f1-score': 0.4834397274783156, 'support': 44575}, '2': {'precision': 0.3641304347826087, 'recall': 0.0060420236270177655, 'f1-score': 0.011886809190100241, 'support': 44356}, 'accuracy': 0.3269665617252085, 'macro avg': {'precision': 0.352838513713422, 'recall': 0.3347577910720321, 'f1-score': 0.19502128959082354, 'support': 137537}, 'weighted avg': {'precision': 0.35331883769149525, 'recall': 0.3269665617252085, 'f1-score': 0.19222718195853983, 'support': 137537}}
[[ 2482 45891   233]
 [ 2120 42220   235]
 [ 2109 41979   268]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.090339
{'0': {'precision': 0.3066453162530024, 'recall': 0.06626870836577559, 'f1-score': 0.10898484740698584, 'support': 11559}, '1': {'precision': 0.39824445545099335, 'recall': 0.9339829633453794, 'f1-score': 0.558393456537675, 'support': 15496}, '2': {'precision': 0.319047619047619, 'recall': 0.005585660691954981, 'f1-score': 0.010979106923392053, 'support': 11995}, 'accuracy': 0.39195902688860434, 'macro avg': {'precision': 0.3413124635838716, 'recall': 0.3352791108010367, 'f1-score': 0.22611913695601768, 'support': 39050}, 'weighted avg': {'precision': 0.3468037255496348, 'recall': 0.39195902688860434, 'f1-score': 0.25721677954497435, 'support': 39050}}
[[  766 10732    61]
 [  941 14473    82]
 [  791 11137    67]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
930/930 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023587
{'0': {'precision': 0.3037008097741156, 'recall': 0.11058662252340799, 'f1-score': 0.162135001896094, 'support': 77324}, '1': {'precision': 0.34171246731701166, 'recall': 0.8651911715938541, 'f1-score': 0.4899257909488605, 'support': 81419}, '2': {'precision': 0.34651290499725423, 'recall': 0.015933941062094392, 'f1-score': 0.03046690164646806, 'support': 79202}, 'accuracy': 0.33728802874613883, 'macro avg': {'precision': 0.33064206069612717, 'recall': 0.3305705783931188, 'f1-score': 0.22750923149714086, 'support': 237945}, 'weighted avg': {'precision': 0.3309578427495851, 'recall': 0.33728802874613883, 'f1-score': 0.2304702112004136, 'support': 237945}}
[[ 8551 67572  1201]
 [ 9797 70443  1179]
 [ 9808 68132  1262]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021163
{'0': {'precision': 0.3518449842388281, 'recall': 0.1181617212068375, 'f1-score': 0.17691070554506677, 'support': 32117}, '1': {'precision': 0.3339049085479657, 'recall': 0.888423339540658, 'f1-score': 0.4853833892901957, 'support': 32220}, '2': {'precision': 0.3386295928500497, 'recall': 0.010276036644165864, 'f1-score': 0.01994676961773566, 'support': 33184}, 'accuracy': 0.3359379005547523, 'macro avg': {'precision': 0.34145982854561446, 'recall': 0.3389536991305538, 'f1-score': 0.22741362148433272, 'support': 97521}, 'weighted avg': {'precision': 0.34142088290060546, 'recall': 0.3359379005547523, 'f1-score': 0.22541614150712108, 'support': 97521}}
[[ 3795 27967   355]
 [ 3284 28625   311]
 [ 3707 29136   341]]
Evaluating performance on  val set...
114/114 - 1s - 969ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974513
{'0': {'precision': 0.3417829678154372, 'recall': 0.13690815744438106, 'f1-score': 0.19550342130987294, 'support': 8765}, '1': {'precision': 0.3555318138651472, 'recall': 0.8908387864366448, 'f1-score': 0.5082301035126421, 'support': 10086}, '2': {'precision': 0.3945578231292517, 'recall': 0.011343633874437709, 'f1-score': 0.0220532319391635, 'support': 10226}, 'accuracy': 0.35426625855487154, 'macro avg': {'precision': 0.36395753493661204, 'recall': 0.34636352591848785, 'f1-score': 0.24192891892055954, 'support': 29077}, 'weighted avg': {'precision': 0.36511228417188535, 'recall': 0.35426625855487154, 'f1-score': 0.24297942227944527, 'support': 29077}}
[[1200 7469   96]
 [1019 8985   82]
 [1292 8818  116]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003336
{'0': {'precision': 0.28363935324746503, 'recall': 0.03880134461342364, 'f1-score': 0.06826426294382763, 'support': 80023}, '1': {'precision': 0.34453962969360996, 'recall': 0.9349377823233614, 'f1-score': 0.5035229450443525, 'support': 93864}, '2': {'precision': 0.3575, 'recall': 0.024663176690203716, 'f1-score': 0.04614304153063548, 'support': 98568}, 'accuracy': 0.3424161788185205, 'macro avg': {'precision': 0.3285596609803583, 'recall': 0.33280076787566293, 'f1-score': 0.2059767498396052, 'support': 272455}, 'weighted avg': {'precision': 0.3313413215631311, 'recall': 0.3424161788185205, 'f1-score': 0.21021312196431957, 'support': 272455}}
[[ 3105 74947  1971]
 [ 3709 87757  2398]
 [ 4133 92004  2431]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1072367
{'0': {'precision': 0.33446741690656895, 'recall': 0.03657803600560978, 'f1-score': 0.06594427244582043, 'support': 34939}, '1': {'precision': 0.3300776384621772, 'recall': 0.9360944307076415, 'f1-score': 0.4880597931182663, 'support': 33972}, '2': {'precision': 0.3441426834211593, 'recall': 0.025177189288573886, 'f1-score': 0.04692163148004863, 'support': 33721}, 'accuracy': 0.3305791565983319, 'macro avg': {'precision': 0.3362292462633018, 'recall': 0.3326165520006084, 'f1-score': 0.20030856568137848, 'support': 102632}, 'weighted avg': {'precision': 0.3361932929376862, 'recall': 0.3305791565983319, 'f1-score': 0.1994177114539031, 'support': 102632}}
[[ 1278 32851   810]
 [ 1363 31801   808]
 [ 1180 31692   849]]
Evaluating performance on  val set...
123/123 - 1s - 993ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1058205
{'0': {'precision': 0.2936630602782071, 'recall': 0.04003371260008428, 'f1-score': 0.07046170962358612, 'support': 9492}, '1': {'precision': 0.31560851063829787, 'recall': 0.9319461198230801, 'f1-score': 0.47153065635887403, 'support': 9948}, '2': {'precision': 0.38764044943820225, 'recall': 0.02311364207352818, 'f1-score': 0.043626017545246185, 'support': 11941}, 'accuracy': 0.3163379114750964, 'macro avg': {'precision': 0.3323040067849024, 'recall': 0.3316978248322308, 'f1-score': 0.19520612784256877, 'support': 31381}, 'weighted avg': {'precision': 0.3363799062723336, 'recall': 0.3163379114750964, 'f1-score': 0.187391982177526, 'support': 31381}}
[[  380  8905   207]
 [  448  9271   229]
 [  466 11199   276]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
1646/1646 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0858806
{'0': {'precision': 0.28944480610062306, 'recall': 0.13876553778110678, 'f1-score': 0.1875945537065053, 'support': 112146}, '1': {'precision': 0.43138464944445215, 'recall': 0.8690632160518261, 'f1-score': 0.5765714116628816, 'support': 179369}, '2': {'precision': 0.34176804541768047, 'recall': 0.016236418278492717, 'f1-score': 0.031000110346856954, 'support': 129770}, 'accuracy': 0.41195865031985474, 'macro avg': {'precision': 0.3541991669875852, 'recall': 0.34135505737047517, 'f1-score': 0.26505535857208123, 'support': 421285}, 'weighted avg': {'precision': 0.36599534677241014, 'recall': 0.41195865031985474, 'f1-score': 0.304971457987445, 'support': 421285}}
[[ 15562  94768   1816]
 [ 21244 155883   2242]
 [ 16959 110704   2107]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102165
{'0': {'precision': 0.3486822623630441, 'recall': 0.1561049980114013, 'f1-score': 0.21565934065934064, 'support': 45258}, '1': {'precision': 0.3322278736736719, 'recall': 0.8350408915251191, 'f1-score': 0.4753384449119755, 'support': 44508}, '2': {'precision': 0.32077764277035237, 'recall': 0.017665164830262748, 'f1-score': 0.03348624822949919, 'support': 44834}, 'accuracy': 0.33449479940564636, 'macro avg': {'precision': 0.3338959262690228, 'recall': 0.3362703514555944, 'f1-score': 0.24149467793360513, 'support': 134600}, 'weighted avg': {'precision': 0.3339465443347728, 'recall': 0.33449479940564636, 'f1-score': 0.24084692718294215, 'support': 134600}}
[[ 7065 37319   874]
 [ 6539 37166   803]
 [ 6658 37384   792]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0949643
{'0': {'precision': 0.3413095900575032, 'recall': 0.1624007060900265, 'f1-score': 0.2200825309491059, 'support': 11330}, '1': {'precision': 0.36742387935716797, 'recall': 0.8504030170820084, 'f1-score': 0.5131408683235912, 'support': 13523}, '2': {'precision': 0.319634703196347, 'recall': 0.01680806787257884, 'f1-score': 0.031936734849060906, 'support': 12494}, 'accuracy': 0.36281361287385866, 'macro avg': {'precision': 0.34278939087033944, 'recall': 0.34320393034820457, 'f1-score': 0.255053378040586, 'support': 37347}, 'weighted avg': {'precision': 0.34351425168376715, 'recall': 0.36281361287385866, 'f1-score': 0.2632542534392979, 'support': 37347}}
[[ 1840  9269   221]
 [ 1797 11500   226]
 [ 1754 10530   210]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
5929/5929 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1121703
{'0': {'precision': 0.4245908403245771, 'recall': 0.05511203781722626, 'f1-score': 0.0975606673008068, 'support': 560168}, '1': {'precision': 0.29553795607719985, 'recall': 0.9523771175729756, 'f1-score': 0.45109413722990926, 'support': 447033}, '2': {'precision': 0.33403263403263406, 'recall': 0.0028077559113744485, 'f1-score': 0.005568703343165029, 'support': 510372}, 'accuracy': 0.30182996139230206, 'macro avg': {'precision': 0.351387143478137, 'recall': 0.33676563710052543, 'f1-score': 0.1847411692912937, 'support': 1517573}, 'weighted avg': {'precision': 0.3561201500412172, 'recall': 0.30182996139230206, 'f1-score': 0.1707637389381033, 'support': 1517573}}
[[ 30872 527583   1713]
 [ 20145 425744   1144]
 [ 21693 487246   1433]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1047825
{'0': {'precision': 0.365903515944399, 'recall': 0.05090095640716974, 'f1-score': 0.08936966923236947, 'support': 105499}, '1': {'precision': 0.3307988648898112, 'recall': 0.9537407519251094, 'f1-score': 0.49122090748476877, 'support': 105968}, '2': {'precision': 0.3359273670557717, 'recall': 0.002365275202966183, 'f1-score': 0.004697475333720255, 'support': 109501}, 'accuracy': 0.3324163156451734, 'macro avg': {'precision': 0.34420991596332734, 'recall': 0.3356689945117484, 'f1-score': 0.19509601735028614, 'support': 320968}, 'weighted avg': {'precision': 0.34408704843858495, 'recall': 0.3324163156451734, 'f1-score': 0.19315472603253106, 'support': 320968}}
[[  5370  99868    261]
 [  4651 101066    251]
 [  4655 104587    259]]
Evaluating performance on  val set...
427/427 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125276
{'0': {'precision': 0.36980010804970287, 'recall': 0.036516404374499864, 'f1-score': 0.06646921732375217, 'support': 37490}, '1': {'precision': 0.2999639146867225, 'recall': 0.9629900615816108, 'f1-score': 0.4574391056274799, 'support': 32802}, '2': {'precision': 0.3448275862068966, 'recall': 0.001798607364012436, 'f1-score': 0.003578549153928736, 'support': 38919}, 'accuracy': 0.30241459193670966, 'macro avg': {'precision': 0.33819720298110734, 'recall': 0.3337683577733744, 'f1-score': 0.17582895736838697, 'support': 109211}, 'weighted avg': {'precision': 0.33992516512002857, 'recall': 0.30241459193670966, 'f1-score': 0.16148668224612736, 'support': 109211}}
[[ 1369 36055    66]
 [ 1147 31588    67]
 [ 1186 37663    70]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
5331/5331 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998873
{'0': {'precision': 0.35386238998925806, 'recall': 0.08549144948915478, 'f1-score': 0.1377122761726299, 'support': 439272}, '1': {'precision': 0.35141385253811697, 'recall': 0.9192185164874267, 'f1-score': 0.5084493801318001, 'support': 477758}, '2': {'precision': 0.32277182584909964, 'recall': 0.006327417019679339, 'f1-score': 0.012411526240823928, 'support': 447576}, 'accuracy': 0.3514201168688984, 'macro avg': {'precision': 0.3426826894588249, 'recall': 0.33701246099875365, 'f1-score': 0.21952439418175132, 'support': 1364606}, 'weighted avg': {'precision': 0.34280777151976743, 'recall': 0.3514201168688984, 'f1-score': 0.22641261082002792, 'support': 1364606}}
[[ 37554 398710   3008]
 [ 35660 439164   2934]
 [ 32912 411832   2832]]
Evaluating performance on  train set...
2013/2013 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052506
{'0': {'precision': 0.357215101038248, 'recall': 0.09719741645605168, 'f1-score': 0.15281438606250858, 'support': 178050}, '1': {'precision': 0.3251217664249378, 'recall': 0.898206457709122, 'f1-score': 0.4774294655898888, 'support': 167211}, '2': {'precision': 0.34384537131230924, 'recall': 0.00993819501208461, 'f1-score': 0.019318038933278468, 'support': 170051}, 'accuracy': 0.32831760176359176, 'macro avg': {'precision': 0.34206074625849836, 'recall': 0.3351140230590861, 'f1-score': 0.21652063019522527, 'support': 515312}, 'weighted avg': {'precision': 0.342389336290577, 'recall': 0.32831760176359176, 'f1-score': 0.21409381432573565, 'support': 515312}}
[[ 17306 158989   1755]
 [ 15551 150190   1470]
 [ 15590 152771   1690]]
Evaluating performance on  val set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066934
{'0': {'precision': 0.3775048480930834, 'recall': 0.08705013332450023, 'f1-score': 0.14147667626712604, 'support': 60379}, '1': {'precision': 0.31384911961886985, 'recall': 0.9176599411215625, 'f1-score': 0.4677298345776607, 'support': 55708}, '2': {'precision': 0.32174688057041, 'recall': 0.005837456744607225, 'f1-score': 0.011466869957435996, 'support': 61842}, 'accuracy': 0.3188800026977053, 'macro avg': {'precision': 0.33770028276078773, 'recall': 0.3368491770635566, 'f1-score': 0.20689112693407422, 'support': 177929}, 'weighted avg': {'precision': 0.3381952496050424, 'recall': 0.3188800026977053, 'f1-score': 0.19843672494586537, 'support': 177929}}
[[ 5256 54691   432]
 [ 4258 51121   329]
 [ 4409 57072   361]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
4192/4192 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894709
{'0': {'precision': 0.3051552649097388, 'recall': 0.10049261401370808, 'f1-score': 0.15119443164455657, 'support': 310182}, '1': {'precision': 0.4049033728822341, 'recall': 0.9084826151145624, 'f1-score': 0.5601516666487476, 'support': 430115}, '2': {'precision': 0.3407258064516129, 'recall': 0.006092779695541275, 'f1-score': 0.01197148802408465, 'support': 332853}, 'accuracy': 0.39505288170339653, 'macro avg': {'precision': 0.35026148141452856, 'recall': 0.3383560029412706, 'f1-score': 0.2411058621057963, 'support': 1073150}, 'weighted avg': {'precision': 0.356166697537449, 'recall': 0.39505288170339653, 'f1-score': 0.2719211396359117, 'support': 1073150}}
[[ 31171 277026   1985]
 [ 37424 390752   1939]
 [ 33553 297272   2028]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0989778
{'0': {'precision': 0.36947631187592944, 'recall': 0.1318830276316413, 'f1-score': 0.1943821559053028, 'support': 105495}, '1': {'precision': 0.3454587791842066, 'recall': 0.8896603420004685, 'f1-score': 0.49767017668918745, 'support': 106725}, '2': {'precision': 0.34631668077900085, 'recall': 0.007969059008056738, 'f1-score': 0.015579616985210792, 'support': 102647}, 'accuracy': 0.3483375520457844, 'macro avg': {'precision': 0.3537505906130456, 'recall': 0.34317080954672224, 'f1-score': 0.23587731652656704, 'support': 314867}, 'weighted avg': {'precision': 0.35378543976252746, 'recall': 0.3483375520457844, 'f1-score': 0.23889259938026022, 'support': 314867}}
[[13913 90681   901]
 [11133 94949   643]
 [12610 89219   818]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097259
{'0': {'precision': 0.3591358348639902, 'recall': 0.1261870370939488, 'f1-score': 0.186755207859547, 'support': 32539}, '1': {'precision': 0.355635757912271, 'recall': 0.8967071736573893, 'f1-score': 0.5092872364110557, 'support': 35714}, '2': {'precision': 0.3779527559055118, 'recall': 0.008472581783949164, 'f1-score': 0.016573631812165503, 'support': 33992}, 'accuracy': 0.3561934568927576, 'macro avg': {'precision': 0.364241449560591, 'recall': 0.3437889308450958, 'f1-score': 0.2375386920275894, 'support': 102245}, 'weighted avg': {'precision': 0.36416906907387525, 'recall': 0.3561934568927576, 'f1-score': 0.24283713592141787, 'support': 102245}}
[[ 4106 28154   279]
 [ 3494 32025   195]
 [ 3833 29871   288]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
6143/6143 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0822371
{'0': {'precision': 0.33249967092273264, 'recall': 0.09230832478753509, 'f1-score': 0.14450051752894677, 'support': 437837}, '1': {'precision': 0.4359088244546471, 'recall': 0.9268604952677298, 'f1-score': 0.5929494641219489, 'support': 678744}, '2': {'precision': 0.30556988138215574, 'recall': 0.005198268998357172, 'f1-score': 0.01022263342801131, 'support': 455921}, 'accuracy': 0.4272725885245297, 'macro avg': {'precision': 0.3579927922531785, 'recall': 0.34145569635120737, 'f1-score': 0.24922420502630235, 'support': 1572502}, 'weighted avg': {'precision': 0.36932664216202926, 'recall': 0.4272725885245297, 'f1-score': 0.2991342951706528, 'support': 1572502}}
[[ 40416 394711   2710]
 [ 46967 629101   2676]
 [ 34169 419382   2370]]
Evaluating performance on  train set...
2083/2083 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009825
{'0': {'precision': 0.356347051797155, 'recall': 0.0926252088696202, 'f1-score': 0.147032335823002, 'support': 177144}, '1': {'precision': 0.33948267850689245, 'recall': 0.9199456044232782, 'f1-score': 0.49594820459907446, 'support': 178691}, '2': {'precision': 0.3702069901594842, 'recall': 0.006150567701345119, 'f1-score': 0.012100105917517425, 'support': 177382}, 'accuracy': 0.3411087793524963, 'macro avg': {'precision': 0.3553455734878439, 'recall': 0.3395737936647478, 'f1-score': 0.2183602154465313, 'support': 533217}, 'weighted avg': {'precision': 0.3553061844935551, 'recall': 0.3411087793524963, 'f1-score': 0.21907350612021775, 'support': 533217}}
[[ 16408 159664   1072]
 [ 13521 164386    784]
 [ 16116 160175   1091]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036011
{'0': {'precision': 0.3563825935848237, 'recall': 0.08584933633335078, 'f1-score': 0.13836725514449566, 'support': 57333}, '1': {'precision': 0.32896704721072834, 'recall': 0.923903531800203, 'f1-score': 0.4851799090115344, 'support': 57138}, '2': {'precision': 0.35280898876404493, 'recall': 0.005172811439491286, 'f1-score': 0.01019612936745032, 'support': 60702}, 'accuracy': 0.33124967888886986, 'macro avg': {'precision': 0.34605287651986566, 'recall': 0.33830855985768166, 'f1-score': 0.21124776450782679, 'support': 175173}, 'weighted avg': {'precision': 0.3462018325739717, 'recall': 0.33124967888886986, 'f1-score': 0.20707611860939412, 'support': 175173}}
[[ 4922 52082   329]
 [ 4101 52790   247]
 [ 4788 55600   314]]
testing model on single stock: results/universal/W7/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
23942/23942 - 191s - 191s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0901252
{'0': {'precision': 0.2908265976283969, 'recall': 0.15192321066013525, 'f1-score': 0.19958590440891105, 'support': 1768683}, '1': {'precision': 0.4244925105263415, 'recall': 0.8325573954267812, 'f1-score': 0.5622917232932291, 'support': 2606523}, '2': {'precision': 0.2850457738524264, 'recall': 0.015107836552332058, 'f1-score': 0.028694807005574464, 'support': 1753858}, 'accuracy': 0.4022279747772254, 'macro avg': {'precision': 0.33345496066905495, 'recall': 0.3331961475464162, 'f1-score': 0.26352414490257153, 'support': 6129064}, 'weighted avg': {'precision': 0.34601684074845784, 'recall': 0.4022279747772254, 'f1-score': 0.30493353022032177, 'support': 6129064}}
[[ 268704 1472845   27134]
 [ 397117 2170080   39326]
 [ 258111 1469250   26497]]
Evaluating performance on  train set...
9052/9052 - 69s - 69s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025077
{'0': {'precision': 0.3366669299319459, 'recall': 0.13247412801839786, 'f1-score': 0.19013325403757877, 'support': 772264}, '1': {'precision': 0.3356386860298762, 'recall': 0.8536643716244808, 'f1-score': 0.4818330973901048, 'support': 777473}, '2': {'precision': 0.3287586997232859, 'recall': 0.015328216977283952, 'f1-score': 0.029290766012551053, 'support': 767343}, 'accuracy': 0.3356673054016262, 'macro avg': {'precision': 0.33368810522836934, 'recall': 0.3338222388733876, 'f1-score': 0.2337523724800782, 'support': 2317080}, 'weighted avg': {'precision': 0.3337029593464342, 'recall': 0.3356673054016262, 'f1-score': 0.23474431408825877, 'support': 2317080}}
[[102305 657704  12255]
 [102012 663701  11760]
 [ 99559 656022  11762]]
Evaluating performance on  val set...
2763/2763 - 26s - 26s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999514
{'0': {'precision': 0.32141868143572266, 'recall': 0.1353103646178955, 'f1-score': 0.19044674016622593, 'support': 223028}, '1': {'precision': 0.3497998947600812, 'recall': 0.8538187269559581, 'f1-score': 0.49627962785680907, 'support': 246810}, '2': {'precision': 0.33706331877729256, 'recall': 0.015601510883159211, 'f1-score': 0.029822633809449068, 'support': 237477}, 'accuracy': 0.34583459986003406, 'macro avg': {'precision': 0.3360939649910321, 'recall': 0.3349102008190043, 'f1-score': 0.23884966727749468, 'support': 707315}, 'weighted avg': {'precision': 0.33657460037219217, 'recall': 0.34583459986003406, 'f1-score': 0.24323522069558629, 'support': 707315}}
[[ 30178 189323   3527]
 [ 32319 210731   3760]
 [ 31393 202379   3705]]
training model: results/universal/W7/deepVOL_L2/h1000
Epoch 1/50
12475/12475 - 403s - loss: 3.2832 - accuracy1000: 0.3644 - val_loss: 3.3108 - val_accuracy1000: 0.3169 - 403s/epoch - 32ms/step
Epoch 2/50
12475/12475 - 396s - loss: 3.2812 - accuracy1000: 0.3637 - val_loss: 3.3130 - val_accuracy1000: 0.3170 - 396s/epoch - 32ms/step
Epoch 3/50
12475/12475 - 405s - loss: 3.2768 - accuracy1000: 0.3682 - val_loss: 3.3160 - val_accuracy1000: 0.3169 - 405s/epoch - 32ms/step
Epoch 4/50
12475/12475 - 397s - loss: 3.2761 - accuracy1000: 0.3687 - val_loss: 3.3099 - val_accuracy1000: 0.3214 - 397s/epoch - 32ms/step
Epoch 5/50
12475/12475 - 403s - loss: 3.2736 - accuracy1000: 0.3726 - val_loss: 3.3126 - val_accuracy1000: 0.3177 - 403s/epoch - 32ms/step
Epoch 6/50
12475/12475 - 403s - loss: 3.2684 - accuracy1000: 0.3772 - val_loss: 3.3251 - val_accuracy1000: 0.3192 - 403s/epoch - 32ms/step
Epoch 7/50
12475/12475 - 400s - loss: 3.2636 - accuracy1000: 0.3809 - val_loss: 3.3416 - val_accuracy1000: 0.3203 - 400s/epoch - 32ms/step
Epoch 8/50
12475/12475 - 407s - loss: 3.2583 - accuracy1000: 0.3848 - val_loss: 3.3540 - val_accuracy1000: 0.3194 - 407s/epoch - 33ms/step
Epoch 9/50
12475/12475 - 401s - loss: 3.2545 - accuracy1000: 0.3874 - val_loss: 3.3545 - val_accuracy1000: 0.3245 - 401s/epoch - 32ms/step
Epoch 10/50
12475/12475 - 399s - loss: 3.2521 - accuracy1000: 0.3889 - val_loss: 3.3353 - val_accuracy1000: 0.3248 - 399s/epoch - 32ms/step
Epoch 11/50
12475/12475 - 404s - loss: 3.2479 - accuracy1000: 0.3919 - val_loss: 3.3370 - val_accuracy1000: 0.3256 - 404s/epoch - 32ms/step
Epoch 12/50
12475/12475 - 396s - loss: 3.2448 - accuracy1000: 0.3933 - val_loss: 3.3478 - val_accuracy1000: 0.3228 - 396s/epoch - 32ms/step
Epoch 13/50
12475/12475 - 402s - loss: 3.2417 - accuracy1000: 0.3956 - val_loss: 3.3598 - val_accuracy1000: 0.3219 - 402s/epoch - 32ms/step
Epoch 14/50
12475/12475 - 390s - loss: 3.2384 - accuracy1000: 0.3972 - val_loss: 3.3558 - val_accuracy1000: 0.3209 - 390s/epoch - 31ms/step
testing model in sample: results/universal/W7/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 573s - 573s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032057
{'0': {'precision': 0.32013711652291266, 'recall': 0.9080245799249452, 'f1-score': 0.47337801136422664, 'support': 3035648}, '1': {'precision': 0.37142857142857144, 'recall': 1.1262474273187775e-05, 'f1-score': 2.2524265564556277e-05, 'support': 3462827}, '2': {'precision': 0.30615611791723635, 'recall': 0.09114870587812764, 'f1-score': 0.14047518315156768, 'support': 3007097}, 'accuracy': 0.31882089789020585, 'macro avg': {'precision': 0.3325739352895735, 'recall': 0.33306151609244866, 'f1-score': 0.20462523959378628, 'support': 9505572}, 'weighted avg': {'precision': 0.3343994056258161, 'recall': 0.31882089789020585, 'f1-score': 0.1956231053645455, 'support': 9505572}}
[[2756443      32  279173]
 [3120782      39  342006]
 [2732970      34  274093]]
Evaluating performance on  train set...
12475/12475 - 193s - 193s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999413
{'0': {'precision': 0.3388703445922343, 'recall': 0.8961443275852963, 'f1-score': 0.49177834714752705, 'support': 1079267}, '1': {'precision': 0.24242424242424243, 'recall': 7.619424961998118e-06, 'f1-score': 1.5238370980046305e-05, 'support': 1049948}, '2': {'precision': 0.3407401069266266, 'recall': 0.10855189877701107, 'f1-score': 0.16465009449006374, 'support': 1063869}, 'accuracy': 0.33906781030502176, 'macro avg': {'precision': 0.3073448979810344, 'recall': 0.33490128192908974, 'f1-score': 0.21881456000285696, 'support': 3193084}, 'weighted avg': {'precision': 0.30777995990640983, 'recall': 0.33906781030502176, 'f1-score': 0.22108477956203265, 'support': 3193084}}
[[967179     13 112075]
 [938576      8 111364]
 [948372     12 115485]]
Evaluating performance on  val set...
3866/3866 - 60s - 60s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022547
{'0': {'precision': 0.3174099502553823, 'recall': 0.9124575257238574, 'f1-score': 0.4709826115526088, 'support': 313425}, '1': {'precision': 0.25, 'recall': 8.969387480528956e-06, 'f1-score': 1.7938131384853643e-05, 'support': 334471}, '2': {'precision': 0.3622374926293827, 'recall': 0.0935963622086925, 'f1-score': 0.1487564436290146, 'support': 341306}, 'accuracy': 0.32140553698840074, 'macro avg': {'precision': 0.3098824809615883, 'recall': 0.33535428577334353, 'f1-score': 0.20658566443766943, 'support': 989202}, 'weighted avg': {'precision': 0.3100840812272492, 'recall': 0.32140553698840074, 'f1-score': 0.20056084759216347, 'support': 989202}}
[[285987      3  27435]
 [305660      3  28808]
 [309355      6  31945]]
testing model out of sample: results/universal/W7/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 226s - 226s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1089144
{'0': {'precision': 0.276875878782499, 'recall': 0.9297174443888215, 'f1-score': 0.4266828424974208, 'support': 1046732}, '1': {'precision': 0.25, 'recall': 2.4983136382941512e-06, 'f1-score': 4.996577344519004e-06, 'support': 1601080}, '2': {'precision': 0.32530835646006784, 'recall': 0.0749238758932931, 'f1-score': 0.12179610214374878, 'support': 1126450}, 'accuracy': 0.2802049778208296, 'macro avg': {'precision': 0.28406141174752225, 'recall': 0.334881272865251, 'f1-score': 0.18282798040617135, 'support': 3774262}, 'weighted avg': {'precision': 0.27992980892269964, 'recall': 0.2802049778208296, 'f1-score': 0.1546866127133969, 'support': 3774262}}
[[ 973165       9   73558]
 [1499592       4  101484]
 [1042049       3   84398]]
Evaluating performance on  train set...
5285/5285 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999398
{'0': {'precision': 0.3383378629806053, 'recall': 0.9075395857648022, 'f1-score': 0.49291365587710056, 'support': 459256}, '1': {'precision': 0.3333333333333333, 'recall': 8.961918567526936e-06, 'f1-score': 1.7923355252103194e-05, 'support': 446333}, '2': {'precision': 0.3327287784679089, 'recall': 0.08986997183804302, 'f1-score': 0.14151639553580705, 'support': 447057}, 'accuracy': 0.3378370985461089, 'macro avg': {'precision': 0.3347999915939492, 'recall': 0.3324728398404709, 'f1-score': 0.21148265825605325, 'support': 1352646}, 'weighted avg': {'precision': 0.33483268333563654, 'recall': 0.3378370985461089, 'f1-score': 0.2141339633336917, 'support': 1352646}}
[[416793      4  42459]
 [408215      4  38114]
 [406876      4  40177]]
Evaluating performance on  val set...
1714/1714 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005416
{'0': {'precision': 0.3304071356995287, 'recall': 0.9221287703016241, 'f1-score': 0.48649771121404933, 'support': 144816}, '1': {'precision': 0.5, 'recall': 2.2036786742669097e-05, 'f1-score': 4.4071631091066685e-05, 'support': 136136}, '2': {'precision': 0.3613088031184479, 'recall': 0.07788925529341363, 'f1-score': 0.12815208567912226, 'support': 157082}, 'accuracy': 0.3327983672500308, 'macro avg': {'precision': 0.39723864627265887, 'recall': 0.3333466874605935, 'f1-score': 0.20489795617475423, 'support': 438034}, 'weighted avg': {'precision': 0.3941962248933073, 'recall': 0.3327983672500308, 'f1-score': 0.20680823453291722, 'support': 438034}}
[[133539      3  11274]
 [125779      3  10354]
 [144847      0  12235]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
696/696 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068789
{'0': {'precision': 0.2950678271779189, 'recall': 0.7468344381375779, 'f1-score': 0.42300861080509905, 'support': 50386}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 69017}, '2': {'precision': 0.35614073383207984, 'recall': 0.3066762358811367, 'f1-score': 0.3295627742989882, 'support': 58521}, 'accuracy': 0.3123637058519368, 'macro avg': {'precision': 0.21706952033666624, 'recall': 0.3511702246729049, 'f1-score': 0.2508571283680291, 'support': 177924}, 'weighted avg': {'precision': 0.2006980476201848, 'recall': 0.3123637058519368, 'f1-score': 0.22818762493411127, 'support': 177924}}
[[37630     1 12755]
 [49326     0 19691]
 [40574     0 17947]]
Evaluating performance on  train set...
282/282 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008253
{'0': {'precision': 0.3375463662591015, 'recall': 0.6951337806159567, 'f1-score': 0.4544289583195719, 'support': 24742}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 24759}, '2': {'precision': 0.31160005702608945, 'recall': 0.291486997110469, 'f1-score': 0.3012081400156185, 'support': 22495}, 'accuracy': 0.3299627757097617, 'macro avg': {'precision': 0.21638214109506362, 'recall': 0.3288735925754752, 'f1-score': 0.2518790327783968, 'support': 71996}, 'weighted avg': {'precision': 0.21335929047147856, 'recall': 0.3299627757097617, 'f1-score': 0.2502799932828794, 'support': 71996}}
[[17199     0  7543]
 [17816     0  6943]
 [15938     0  6557]]
Evaluating performance on  val set...
73/73 - 1s - 673ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1031336
{'0': {'precision': 0.32289465741020223, 'recall': 0.7472930492490395, 'f1-score': 0.45094319738644745, 'support': 5726}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6631}, '2': {'precision': 0.3470980019029496, 'recall': 0.2965371484311494, 'f1-score': 0.31983166754339826, 'support': 6151}, 'accuracy': 0.3297492976010374, 'macro avg': {'precision': 0.22333088643771726, 'recall': 0.3479433992267296, 'f1-score': 0.2569249549766152, 'support': 18508}, 'weighted avg': {'precision': 0.21525257283530694, 'recall': 0.3297492976010374, 'f1-score': 0.24580642615594556, 'support': 18508}}
[[4279    1 1446]
 [4646    0 1985]
 [4327    0 1824]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
2006/2006 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0907936
{'0': {'precision': 0.3935057702763085, 'recall': 0.8797326955819973, 'f1-score': 0.5437785635527166, 'support': 203214}, '1': {'precision': 0.25, 'recall': 2.6022466062367175e-05, 'f1-score': 5.203951533864714e-05, 'support': 115285}, '2': {'precision': 0.37459962377345063, 'recall': 0.11345217136903264, 'f1-score': 0.1741583214491132, 'support': 194831}, 'accuracy': 0.39132916447509397, 'macro avg': {'precision': 0.33936846468325305, 'recall': 0.3310702964723641, 'f1-score': 0.2393296415057228, 'support': 513330}, 'weighted avg': {'precision': 0.35410116474847547, 'recall': 0.39132916447509397, 'f1-score': 0.2813801186674843, 'support': 513330}}
[[178774      4  24436]
 [102815      3  12467]
 [172722      5  22104]]
Evaluating performance on  train set...
538/538 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964478
{'0': {'precision': 0.3648542222507956, 'recall': 0.9035204680690163, 'f1-score': 0.5198042190228125, 'support': 50249}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 42518}, '2': {'precision': 0.3353179146630028, 'recall': 0.09812374357828903, 'f1-score': 0.15182042819374125, 'support': 44770}, 'accuracy': 0.36204075994096135, 'macro avg': {'precision': 0.23339071230459948, 'recall': 0.33388140388243515, 'f1-score': 0.2238748824055179, 'support': 137537}, 'weighted avg': {'precision': 0.24244925258906957, 'recall': 0.36204075994096135, 'f1-score': 0.23932936425769866, 'support': 137537}}
[[45401     0  4848]
 [38658     0  3860]
 [40377     0  4393]]
Evaluating performance on  val set...
153/153 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007646
{'0': {'precision': 0.32089844844003806, 'recall': 0.8966272791298223, 'f1-score': 0.4726410229968031, 'support': 12779}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13000}, '2': {'precision': 0.3591507177033493, 'recall': 0.09049807851706729, 'f1-score': 0.14456816130003008, 'support': 13271}, 'accuracy': 0.3241741357234315, 'macro avg': {'precision': 0.22668305538112912, 'recall': 0.32904178588229654, 'f1-score': 0.2057363947656111, 'support': 39050}, 'weighted avg': {'precision': 0.22706915357890897, 'recall': 0.3241741357234315, 'f1-score': 0.20380137519817787, 'support': 39050}}
[[11458     0  1321]
 [12178     0   822]
 [12070     0  1201]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
930/930 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015383
{'0': {'precision': 0.32391853593162995, 'recall': 0.9615229101722991, 'f1-score': 0.48458853457966045, 'support': 76669}, '1': {'precision': 1.0, 'recall': 1.20676755243405e-05, 'f1-score': 2.4135059794610637e-05, 'support': 82866}, '2': {'precision': 0.40785790134182837, 'recall': 0.05388343323555669, 'f1-score': 0.09519088871114917, 'support': 78410}, 'accuracy': 0.3275757002668684, 'macro avg': {'precision': 0.5772588124244861, 'recall': 0.33847280369446003, 'f1-score': 0.19326785278353475, 'support': 237945}, 'weighted avg': {'precision': 0.5870291381434991, 'recall': 0.3275757002668684, 'f1-score': 0.18751743435413282, 'support': 237945}}
[[73719     0  2950]
 [79681     1  3184]
 [74185     0  4225]]
Evaluating performance on  train set...
381/381 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012565
{'0': {'precision': 0.3274586215955863, 'recall': 0.9325394351268782, 'f1-score': 0.4847119825002026, 'support': 32078}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 32206}, '2': {'precision': 0.3527885862516213, 'recall': 0.06546920600535548, 'f1-score': 0.11044283720340059, 'support': 33237}, 'accuracy': 0.3290573312414762, 'macro avg': {'precision': 0.22674906928240254, 'recall': 0.33266954704407786, 'f1-score': 0.19838493990120107, 'support': 97521}, 'weighted avg': {'precision': 0.2279493842842911, 'recall': 0.3290573312414762, 'f1-score': 0.19707939371797792, 'support': 97521}}
[[29914     1  2163]
 [30377     0  1829]
 [31061     0  2176]]
Evaluating performance on  val set...
114/114 - 1s - 956ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044986
{'0': {'precision': 0.3029704419081065, 'recall': 0.9412433231048983, 'f1-score': 0.45839214058392147, 'support': 8799}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9499}, '2': {'precision': 0.37298850574712644, 'recall': 0.06020966694498562, 'f1-score': 0.10368240274782331, 'support': 10779}, 'accuracy': 0.30714998108470615, 'macro avg': {'precision': 0.225319649218411, 'recall': 0.33381766334996127, 'f1-score': 0.18735818111058158, 'support': 29077}, 'weighted avg': {'precision': 0.22995082098557987, 'recall': 0.30714998108470615, 'f1-score': 0.1771498113359945, 'support': 29077}}
[[ 8282     0   517]
 [ 8925     0   574]
 [10129     1   649]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1065/1065 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063924
{'0': {'precision': 0.2810018090576314, 'recall': 0.9558109632895117, 'f1-score': 0.43431732887390484, 'support': 76218}, '1': {'precision': 0.4, 'recall': 0.00014681669935086045, 'f1-score': 0.00029352566252935255, 'support': 95357}, '2': {'precision': 0.37535120358417495, 'recall': 0.04899881046788263, 'f1-score': 0.08668204017571396, 'support': 100880}, 'accuracy': 0.28557743480574777, 'macro avg': {'precision': 0.35211767088060214, 'recall': 0.3349855301522484, 'f1-score': 0.1737642982373827, 'support': 272455}, 'weighted avg': {'precision': 0.3575842810751358, 'recall': 0.28557743480574777, 'f1-score': 0.15369610435352304, 'support': 272455}}
[[72850     7  3361]
 [90478    14  4865]
 [95923    14  4943]]
Evaluating performance on  train set...
401/401 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987484
{'0': {'precision': 0.3494748886437007, 'recall': 0.9562251914798457, 'f1-score': 0.5118735878136738, 'support': 35774}, '1': {'precision': 0.4444444444444444, 'recall': 0.00011793148180906893, 'f1-score': 0.00023580039496566156, 'support': 33918}, '2': {'precision': 0.3025954842793838, 'recall': 0.04353369763205829, 'f1-score': 0.07611666976299797, 'support': 32940}, 'accuracy': 0.3473185751032816, 'macro avg': {'precision': 0.36550493912250964, 'recall': 0.3332922735312377, 'f1-score': 0.19607535265721246, 'support': 102632}, 'weighted avg': {'precision': 0.36581452748820364, 'recall': 0.3473185751032816, 'f1-score': 0.2029293661843866, 'support': 102632}}
[[34208     1  1565]
 [32174     4  1740]
 [31502     4  1434]]
Evaluating performance on  val set...
123/123 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036516
{'0': {'precision': 0.30819276300345416, 'recall': 0.9497726333195535, 'f1-score': 0.46537536397012275, 'support': 9676}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9467}, '2': {'precision': 0.37524053880692754, 'recall': 0.04780192841967642, 'f1-score': 0.0848010437051533, 'support': 12238}, 'accuracy': 0.3114942162454989, 'macro avg': {'precision': 0.22781110060346058, 'recall': 0.3325248539130767, 'f1-score': 0.1833921358917587, 'support': 31381}, 'weighted avg': {'precision': 0.2413647394519168, 'recall': 0.3114942162454989, 'f1-score': 0.17656439229592982, 'support': 31381}}
[[ 9190     1   485]
 [ 8978     0   489]
 [11651     2   585]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
1646/1646 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111404
{'0': {'precision': 0.25935951103007265, 'recall': 0.9283718193852037, 'f1-score': 0.4054486986474605, 'support': 108784}, '1': {'precision': 0.2, 'recall': 5.634310698429154e-06, 'f1-score': 1.1268303951230782e-05, 'support': 177484}, '2': {'precision': 0.33794292881781124, 'recall': 0.07981957827532829, 'f1-score': 0.12913778331645767, 'support': 135017}, 'accuracy': 0.2653073335153162, 'macro avg': {'precision': 0.2657674799492946, 'recall': 0.33606567732374354, 'f1-score': 0.1781992500892898, 'support': 421285}, 'weighted avg': {'precision': 0.25953690605668334, 'recall': 0.2653073335153162, 'f1-score': 0.14608668067308828, 'support': 421285}}
[[100992      3   7789]
 [164159      1  13324]
 [124239      1  10777]]
Evaluating performance on  train set...
526/526 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000794
{'0': {'precision': 0.3358112189425361, 'recall': 0.9244003015119939, 'f1-score': 0.49265379184857416, 'support': 45106}, '1': {'precision': 1.0, 'recall': 2.2145451324297988e-05, 'f1-score': 4.4289921828287974e-05, 'support': 45156}, '2': {'precision': 0.36486486486486486, 'recall': 0.08586314222563038, 'f1-score': 0.13901263419265317, 'support': 44338}, 'accuracy': 0.3380683506686478, 'macro avg': {'precision': 0.5668920279358004, 'recall': 0.3367618630629829, 'f1-score': 0.21057023865435187, 'support': 134600}, 'weighted avg': {'precision': 0.5682056405646391, 'recall': 0.3380683506686478, 'f1-score': 0.21090032738236048, 'support': 134600}}
[[41696     0  3410]
 [41938     1  3217]
 [40531     0  3807]]
Evaluating performance on  val set...
146/146 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1051369
{'0': {'precision': 0.29618053564259905, 'recall': 0.9341593560640319, 'f1-score': 0.4497615989201193, 'support': 11057}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 13444}, '2': {'precision': 0.3845531742822483, 'recall': 0.07403082671648763, 'f1-score': 0.1241595404399765, 'support': 12846}, 'accuracy': 0.3020322917503414, 'macro avg': {'precision': 0.2269112366416158, 'recall': 0.3360633942601732, 'f1-score': 0.19130704645336527, 'support': 37347}, 'weighted avg': {'precision': 0.21995978952606582, 'recall': 0.3020322917503414, 'f1-score': 0.17586332117042058, 'support': 37347}}
[[10329     0   728]
 [12650     0   794]
 [11895     0   951]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
5929/5929 - 57s - 57s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0878458
{'0': {'precision': 0.41794684173240537, 'recall': 0.9621387766432291, 'f1-score': 0.5827506027917569, 'support': 634026}, '1': {'precision': 0.07692307692307693, 'recall': 3.164186471837158e-06, 'f1-score': 6.328112640404998e-06, 'support': 316037}, '2': {'precision': 0.3872124702555437, 'recall': 0.039569346795651175, 'f1-score': 0.07180129943213792, 'support': 567510}, 'accuracy': 0.4167694074683722, 'macro avg': {'precision': 0.294027462970342, 'recall': 0.33390376254178405, 'f1-score': 0.21818607677884513, 'support': 1517573}, 'weighted avg': {'precision': 0.33543470510643775, 'recall': 0.4167694074683722, 'f1-score': 0.2703191141672352, 'support': 1517573}}
[[610021      7  23998]
 [304496      1  11540]
 [545049      5  22456]]
Evaluating performance on  train set...
1254/1254 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010259
{'0': {'precision': 0.33063241106719365, 'recall': 0.979249273063706, 'f1-score': 0.49435235580635006, 'support': 105924}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 106391}, '2': {'precision': 0.3525596798675314, 'recall': 0.023515227375222037, 'f1-score': 0.04408973252804141, 'support': 108653}, 'accuracy': 0.3311264674360061, 'macro avg': {'precision': 0.2277306969782417, 'recall': 0.3342548334796427, 'f1-score': 0.1794806961114638, 'support': 320968}, 'weighted avg': {'precision': 0.22846070139866997, 'recall': 0.3311264674360061, 'f1-score': 0.1780684075820677, 'support': 320968}}
[[103726      0   2198]
 [103897      0   2494]
 [106097      1   2555]]
Evaluating performance on  val set...
427/427 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101467
{'0': {'precision': 0.32525286299423223, 'recall': 0.9849247644494445, 'f1-score': 0.4890170504531427, 'support': 35555}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 35913}, '2': {'precision': 0.3905440414507772, 'recall': 0.01597647245846912, 'f1-score': 0.030697177183292183, 'support': 37743}, 'accuracy': 0.3261759346585967, 'macro avg': {'precision': 0.23859896814833648, 'recall': 0.33363374563597126, 'f1-score': 0.17323807587881165, 'support': 109211}, 'weighted avg': {'precision': 0.24086098744848602, 'recall': 0.3261759346585967, 'f1-score': 0.16981443982099317, 'support': 109211}}
[[35019     0   536]
 [35508     0   405]
 [37140     0   603]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
5331/5331 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1151111
{'0': {'precision': 0.23976440042839134, 'recall': 0.9285579916378929, 'f1-score': 0.3811193753366314, 'support': 329582}, '1': {'precision': 0.16666666666666666, 'recall': 1.4556930700275709e-06, 'f1-score': 2.911360711769467e-06, 'support': 686958}, '2': {'precision': 0.2638978650067463, 'recall': 0.06686950176116024, 'f1-score': 0.10670169141091498, 'support': 348066}, 'accuracy': 0.2413238693073312, 'macro avg': {'precision': 0.22344297736726806, 'recall': 0.33180964969737436, 'f1-score': 0.16260799270275272, 'support': 1364606}, 'weighted avg': {'precision': 0.20912183069943138, 'recall': 0.2413238693073312, 'f1-score': 0.11926615951224091, 'support': 1364606}}
[[306036      3  23543]
 [645578      1  41379]
 [324789      2  23275]]
Evaluating performance on  train set...
2013/2013 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988216
{'0': {'precision': 0.3476667443465873, 'recall': 0.8825804507249774, 'f1-score': 0.49883287384312563, 'support': 179178}, '1': {'precision': 0.3333333333333333, 'recall': 5.974393748394382e-06, 'f1-score': 1.1948573340343162e-05, 'support': 167381}, '2': {'precision': 0.3297215926949099, 'recall': 0.11811345576078648, 'f1-score': 0.17392366625364306, 'support': 168753}, 'accuracy': 0.34556152389232153, 'macro avg': {'precision': 0.33690722345827684, 'recall': 0.3335666269598374, 'f1-score': 0.22425616289003636, 'support': 515312}, 'weighted avg': {'precision': 0.3371344088964426, 'recall': 0.34556152389232153, 'f1-score': 0.23040801899610117, 'support': 515312}}
[[158139      1  21038]
 [147899      1  19481]
 [148820      1  19932]]
Evaluating performance on  val set...
696/696 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0958931
{'0': {'precision': 0.36332444953671417, 'recall': 0.9059811807086736, 'f1-score': 0.5186538307688204, 'support': 64402}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 45137}, '2': {'precision': 0.35642993134483353, 'recall': 0.09033484427547887, 'f1-score': 0.14413867923427784, 'support': 68390}, 'accuracy': 0.36264465039425836, 'macro avg': {'precision': 0.23991812696051587, 'recall': 0.33210534166138417, 'f1-score': 0.22093083666769942, 'support': 177929}, 'weighted avg': {'precision': 0.2685063379423064, 'recall': 0.36264465039425836, 'f1-score': 0.24313062110170822, 'support': 177929}}
[[58347     1  6054]
 [40036     0  5101]
 [62209     3  6178]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
4192/4192 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063358
{'0': {'precision': 0.29117222942083204, 'recall': 0.9536010217929273, 'f1-score': 0.4461248427738722, 'support': 313175}, '1': {'precision': 0.5, 'recall': 7.213151016934074e-06, 'f1-score': 1.4426093918680108e-05, 'support': 415907}, '2': {'precision': 0.36282458985321064, 'recall': 0.05007149749468128, 'f1-score': 0.0879987536744894, 'support': 344068}, 'accuracy': 0.2943437543679821, 'macro avg': {'precision': 0.3846656064246809, 'recall': 0.33455991081287517, 'f1-score': 0.1780460075140934, 'support': 1073150}, 'weighted avg': {'precision': 0.3950777560736929, 'recall': 0.2943437543679821, 'f1-score': 0.15841094229923597, 'support': 1073150}}
[[298644      3  14528]
 [400177      3  15727]
 [326840      0  17228]]
Evaluating performance on  train set...
1230/1230 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098939
{'0': {'precision': 0.3445625876756053, 'recall': 0.9353286913970879, 'f1-score': 0.5036041412338025, 'support': 108719}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 102455}, '2': {'precision': 0.3469914910858995, 'recall': 0.06607003365704532, 'f1-score': 0.11100399394022863, 'support': 103693}, 'accuracy': 0.344713799794834, 'macro avg': {'precision': 0.23051802625383497, 'recall': 0.3337995750180444, 'f1-score': 0.2048693783913437, 'support': 314867}, 'weighted avg': {'precision': 0.23324479432482387, 'recall': 0.344713799794834, 'f1-score': 0.21044338013968406, 'support': 314867}}
[[101688      1   7030]
 [ 96592      0   5863]
 [ 96842      0   6851]]
Evaluating performance on  val set...
400/400 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018773
{'0': {'precision': 0.32019965906887016, 'recall': 0.9520471030987283, 'f1-score': 0.47922331876928725, 'support': 32949}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 34484}, '2': {'precision': 0.3655913978494624, 'recall': 0.04492703665402735, 'f1-score': 0.08002046559222309, 'support': 34812}, 'accuracy': 0.3220988801408382, 'macro avg': {'precision': 0.2285970189727775, 'recall': 0.33232471325091856, 'f1-score': 0.18641459478717012, 'support': 102245}, 'weighted avg': {'precision': 0.2276612676277147, 'recall': 0.3220988801408382, 'f1-score': 0.1816773590720888, 'support': 102245}}
[[31369     0  1580]
 [33350     0  1134]
 [33248     0  1564]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
6143/6143 - 54s - 54s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042969
{'0': {'precision': 0.3043588264193528, 'recall': 0.9447529767655425, 'f1-score': 0.46039739041996375, 'support': 481311}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 584755}, '2': {'precision': 0.3590625836296211, 'recall': 0.0556358552709523, 'f1-score': 0.09634352127774158, 'support': 506436}, 'accuracy': 0.30708768573903245, 'macro avg': {'precision': 0.22114047001632464, 'recall': 0.333462944012165, 'f1-score': 0.1855803038992351, 'support': 1572502}, 'weighted avg': {'precision': 0.208796853489392, 'recall': 0.30708768573903245, 'f1-score': 0.17194646233978558, 'support': 1572502}}
[[454720      2  26589]
 [561049      0  23706]
 [478257      3  28176]]
Evaluating performance on  train set...
2083/2083 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005722
{'0': {'precision': 0.3328612785828172, 'recall': 0.9538876914095828, 'f1-score': 0.4935108307704818, 'support': 178152}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 176831}, '2': {'precision': 0.3542456573494401, 'recall': 0.04508118540794686, 'f1-score': 0.07998367476955544, 'support': 178234}, 'accuracy': 0.3337703036474831, 'macro avg': {'precision': 0.2290356453107524, 'recall': 0.3329896256058432, 'f1-score': 0.1911648351800124, 'support': 533217}, 'weighted avg': {'precision': 0.22962231698184074, 'recall': 0.3337703036474831, 'f1-score': 0.19162133205111584, 'support': 533217}}
[[169937      1   8214]
 [170398      0   6433]
 [170199      0   8035]]
Evaluating performance on  val set...
685/685 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032025
{'0': {'precision': 0.31088070580121996, 'recall': 0.9536766851473593, 'f1-score': 0.4689066437109372, 'support': 54832}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61425}, '2': {'precision': 0.381225778670877, 'recall': 0.045081132459773236, 'f1-score': 0.08062777954859372, 'support': 58916}, 'accuracy': 0.3136784778476135, 'macro avg': {'precision': 0.230702161490699, 'recall': 0.3329192725357108, 'f1-score': 0.18317814108651032, 'support': 175173}, 'weighted avg': {'precision': 0.22552852800754616, 'recall': 0.3136784778476135, 'f1-score': 0.17389298206825854, 'support': 175173}}
[[52292     0  2540]
 [59654     0  1771]
 [56260     0  2656]]
testing model on single stock: results/universal/W7/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
23942/23942 - 200s - 200s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1073536
{'0': {'precision': 0.29493439428475865, 'recall': 0.8822679745607416, 'f1-score': 0.44208400791633834, 'support': 1809015}, '1': {'precision': 0.38636363636363635, 'recall': 6.7453866515146765e-06, 'f1-score': 1.3490537776481629e-05, 'support': 2520241}, '2': {'precision': 0.288913975122818, 'recall': 0.11518061926605505, 'f1-score': 0.16470049850377363, 'support': 1799808}, 'accuracy': 0.29423024461810154, 'macro avg': {'precision': 0.3234040019237377, 'recall': 0.33248511307114936, 'f1-score': 0.20226599898596284, 'support': 6129064}, 'weighted avg': {'precision': 0.3307617450703107, 'recall': 0.29423024461810154, 'f1-score': 0.17885273767711857, 'support': 6129064}}
[[1596036      14  212965]
 [2222967      17  297257]
 [1592492      13  207303]]
Evaluating performance on  train set...
9052/9052 - 68s - 68s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002011
{'0': {'precision': 0.33699759923428624, 'recall': 0.8754689500784099, 'f1-score': 0.4866623900640027, 'support': 778601}, '1': {'precision': 0.17647058823529413, 'recall': 3.923281537298637e-06, 'f1-score': 7.846388634244516e-06, 'support': 764666}, '2': {'precision': 0.33949554140127386, 'recall': 0.1291513582738982, 'f1-score': 0.18711874688725205, 'support': 773813}, 'accuracy': 0.33731377423308645, 'macro avg': {'precision': 0.28432124295695144, 'recall': 0.33487474387794847, 'f1-score': 0.224596327779963, 'support': 2317080}, 'weighted avg': {'precision': 0.28485584872481223, 'recall': 0.33731377423308645, 'f1-score': 0.22602445419143885, 'support': 2317080}}
[[681641     11  96949]
 [667176      3  97487]
 [673871      3  99939]]
Evaluating performance on  val set...
2763/2763 - 28s - 28s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1024233
{'0': {'precision': 0.31605297798723664, 'recall': 0.8947030107971555, 'f1-score': 0.4671024609351624, 'support': 222466}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 241607}, '2': {'precision': 0.36092087444379956, 'recall': 0.11504592134582022, 'f1-score': 0.1744763496135945, 'support': 243242}, 'accuracy': 0.3209673200766278, 'macro avg': {'precision': 0.22565795081034543, 'recall': 0.3365829773809919, 'f1-score': 0.2138596035162523, 'support': 707315}, 'weighted avg': {'precision': 0.22352439456588263, 'recall': 0.3209673200766278, 'f1-score': 0.20691543697943884, 'support': 707315}}
[[199041      3  23422]
 [215478      0  26129]
 [215252      6  27984]]
training model: results/universal/W7/deepVOL_L3/h300
Epoch 1/50
12475/12475 - 681s - loss: 3.2831 - accuracy300: 0.3631 - val_loss: 3.3258 - val_accuracy300: 0.3192 - 681s/epoch - 55ms/step
Epoch 2/50
12475/12475 - 671s - loss: 3.2746 - accuracy300: 0.3681 - val_loss: 3.3417 - val_accuracy300: 0.3203 - 671s/epoch - 54ms/step
Epoch 3/50
12475/12475 - 678s - loss: 3.2631 - accuracy300: 0.3773 - val_loss: 3.3388 - val_accuracy300: 0.3241 - 678s/epoch - 54ms/step
Epoch 4/50
12475/12475 - 672s - loss: 3.2557 - accuracy300: 0.3843 - val_loss: 3.3277 - val_accuracy300: 0.3205 - 672s/epoch - 54ms/step
Epoch 5/50
12475/12475 - 692s - loss: 3.2492 - accuracy300: 0.3900 - val_loss: 3.3471 - val_accuracy300: 0.3189 - 692s/epoch - 55ms/step
Epoch 6/50
12475/12475 - 672s - loss: 3.2458 - accuracy300: 0.3924 - val_loss: 3.3441 - val_accuracy300: 0.3209 - 672s/epoch - 54ms/step
Epoch 7/50
12475/12475 - 683s - loss: 3.2424 - accuracy300: 0.3946 - val_loss: 3.3370 - val_accuracy300: 0.3212 - 683s/epoch - 55ms/step
Epoch 8/50
12475/12475 - 672s - loss: 3.2398 - accuracy300: 0.3964 - val_loss: 3.3442 - val_accuracy300: 0.3213 - 672s/epoch - 54ms/step
Epoch 9/50
12475/12475 - 674s - loss: 3.2372 - accuracy300: 0.3979 - val_loss: 3.3428 - val_accuracy300: 0.3222 - 674s/epoch - 54ms/step
Epoch 10/50
12475/12475 - 673s - loss: 3.2350 - accuracy300: 0.3995 - val_loss: 3.3444 - val_accuracy300: 0.3217 - 673s/epoch - 54ms/step
Epoch 11/50
12475/12475 - 680s - loss: 3.2334 - accuracy300: 0.4006 - val_loss: 3.3436 - val_accuracy300: 0.3218 - 680s/epoch - 55ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 1112s - 1112s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1189642
{'0': {'precision': 0.2993508765094122, 'recall': 0.9935145301091524, 'f1-score': 0.4600779692773644, 'support': 2845746}, '1': {'precision': 0.3578835010673986, 'recall': 0.0006102718609027395, 'f1-score': 0.0012184659632928693, 'support': 3845827}, '2': {'precision': 0.3080990456538561, 'recall': 0.005942788181516767, 'f1-score': 0.011660658994929709, 'support': 2813999}, 'accuracy': 0.29944121195442, 'macro avg': {'precision': 0.32177780774355563, 'recall': 0.3333558633838573, 'f1-score': 0.15765236474519564, 'support': 9505572}, 'weighted avg': {'precision': 0.3256221716119334, 'recall': 0.29944121195442, 'f1-score': 0.1416815456040382, 'support': 9505572}}
[[2827290    2112   16344]
 [3822269    2347   21211]
 [2795177    2099   16723]]
Evaluating performance on  train set...
12475/12475 - 386s - 386s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033949
{'0': {'precision': 0.3361928587157559, 'recall': 0.993879394644936, 'f1-score': 0.5024315845400235, 'support': 1073750}, '1': {'precision': 0.3151862464183381, 'recall': 0.0004167677012609117, 'f1-score': 0.000832434682255898, 'support': 1055744}, '2': {'precision': 0.3371297095197009, 'recall': 0.005510582085202004, 'f1-score': 0.010843914059067044, 'support': 1063590}, 'accuracy': 0.33618877549103, 'macro avg': {'precision': 0.32950293821793164, 'recall': 0.33326891481046633, 'f1-score': 0.17136931109378215, 'support': 3193084}, 'weighted avg': {'precision': 0.32955940348978713, 'recall': 0.33618877549103, 'f1-score': 0.17284175122706352, 'support': 3193084}}
[[1067178     504    6068]
 [1049848     440    5456]
 [1057277     452    5861]]
Evaluating performance on  val set...
3866/3866 - 119s - 119s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076345
{'0': {'precision': 0.3191698468719701, 'recall': 0.9933756590300977, 'f1-score': 0.48311552712388, 'support': 315805}, '1': {'precision': 0.33031674208144796, 'recall': 0.00042567459218333163, 'f1-score': 0.0008502534745375291, 'support': 342985}, '2': {'precision': 0.3397643844971829, 'recall': 0.0060227836761376705, 'f1-score': 0.011835762440189255, 'support': 330412}, 'accuracy': 0.3192967664844996, 'macro avg': {'precision': 0.32975032448353364, 'recall': 0.33327470576613955, 'f1-score': 0.16526718101286894, 'support': 989202}, 'weighted avg': {'precision': 0.32991375986369936, 'recall': 0.3192967664844996, 'f1-score': 0.15848391043559254, 'support': 989202}}
[[313713    141   1951]
 [340923    146   1916]
 [328267    155   1990]]
testing model out of sample: results/universal/W7/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 448s - 448s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1205097
{'0': {'precision': 0.2887723843160577, 'recall': 0.9909149718071416, 'f1-score': 0.4472168576082718, 'support': 1089815}, '1': {'precision': 0.41635812857623694, 'recall': 0.0008003312607967081, 'f1-score': 0.0015975916016017244, 'support': 1545610}, '2': {'precision': 0.3149055947373415, 'recall': 0.008743130052852164, 'f1-score': 0.017013881769156636, 'support': 1138837}, 'accuracy': 0.28909174826760836, 'macro avg': {'precision': 0.3400120358765453, 'recall': 0.3334861443735968, 'f1-score': 0.1552761103263434, 'support': 3774262}, 'weighted avg': {'precision': 0.3489058008998877, 'recall': 0.28909174826760836, 'f1-score': 0.13492145783786377, 'support': 3774262}}
[[1079914     883    9018]
 [1531729    1237   12644]
 [1128029     851    9957]]
Evaluating performance on  train set...
5285/5285 - 168s - 168s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037011
{'0': {'precision': 0.33570634983998743, 'recall': 0.9908145355405462, 'f1-score': 0.5014964102872773, 'support': 454087}, '1': {'precision': 0.3107177974434612, 'recall': 0.0007023876735408785, 'f1-score': 0.0014016069690027523, 'support': 449894}, '2': {'precision': 0.33584310978812815, 'recall': 0.008549808877447539, 'f1-score': 0.01667510709930948, 'support': 448665}, 'accuracy': 0.33568871678177437, 'macro avg': {'precision': 0.32742241902385893, 'recall': 0.33335557736384486, 'f1-score': 0.17319104145186318, 'support': 1352646}, 'weighted avg': {'precision': 0.32744044701711267, 'recall': 0.33568871678177437, 'f1-score': 0.17435094766150427, 'support': 1352646}}
[[449916    348   3823]
 [445815    316   3763]
 [444476    353   3836]]
Evaluating performance on  val set...
1714/1714 - 54s - 54s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1075648
{'0': {'precision': 0.32084925807410275, 'recall': 0.9907591181680432, 'f1-score': 0.4847244554889636, 'support': 140571}, '1': {'precision': 0.35403726708074534, 'recall': 0.0007496251874062968, 'f1-score': 0.0014960826257562436, 'support': 152076}, '2': {'precision': 0.3316845287166804, 'recall': 0.008301980232070268, 'f1-score': 0.016198515695247807, 'support': 145387}, 'accuracy': 0.32096366948684346, 'macro avg': {'precision': 0.3355236846238429, 'recall': 0.3332702411958399, 'f1-score': 0.1674730179366559, 'support': 438034}, 'weighted avg': {'precision': 0.3359677355224438, 'recall': 0.32096366948684346, 'f1-score': 0.16145042004802962, 'support': 438034}}
[[139272     97   1202]
 [150732    114   1230]
 [144069    111   1207]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1164477
{'0': {'precision': 0.2982533324953291, 'recall': 0.9847570178086327, 'f1-score': 0.45784051888592137, 'support': 53008}, '1': {'precision': 0.38162544169611307, 'recall': 0.0015752855205005908, 'f1-score': 0.0031376194764823804, 'support': 68559}, '2': {'precision': 0.31998474446987035, 'recall': 0.014887236723033518, 'f1-score': 0.02845080452364401, 'support': 56357}, 'accuracy': 0.2987061891594164, 'macro avg': {'precision': 0.33328783955377084, 'recall': 0.3337398466840556, 'f1-score': 0.16314298096201593, 'support': 177924}, 'weighted avg': {'precision': 0.33726226675571985, 'recall': 0.2987061891594164, 'f1-score': 0.1466228517194537, 'support': 177924}}
[[52200    68   740]
 [67408   108  1043]
 [55411   107   839]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033849
{'0': {'precision': 0.3419822248430984, 'recall': 0.9894381931185766, 'f1-score': 0.5082846410684473, 'support': 24617}, '1': {'precision': 0.2777777777777778, 'recall': 0.000628456510809452, 'f1-score': 0.0012540757461750691, 'support': 23868}, '2': {'precision': 0.33240611961057026, 'recall': 0.010165454468121305, 'f1-score': 0.01972761040033017, 'support': 23511}, 'accuracy': 0.3418384354686371, 'macro avg': {'precision': 0.3173887074104822, 'recall': 0.3334107013658358, 'f1-score': 0.17642210907165087, 'support': 71996}, 'weighted avg': {'precision': 0.3175700970488176, 'recall': 0.3418384354686371, 'f1-score': 0.18065157977129057, 'support': 71996}}
[[24357    16   244]
 [23617    15   236]
 [23249    23   239]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1007152
{'0': {'precision': 0.340034052836821, 'recall': 0.9853573133853255, 'f1-score': 0.5055941200489995, 'support': 6283}, '1': {'precision': 0.4, 'recall': 0.0010323468685478321, 'f1-score': 0.002059378754075854, 'support': 5812}, '2': {'precision': 0.3776223776223776, 'recall': 0.016840792140963668, 'f1-score': 0.032243618450515, 'support': 6413}, 'accuracy': 0.34066349686622, 'macro avg': {'precision': 0.3725521434863996, 'recall': 0.334410150798279, 'f1-score': 0.17996570575119678, 'support': 18508}, 'weighted avg': {'precision': 0.3718892512246625, 'recall': 0.34066349686622, 'f1-score': 0.1834555484498436, 'support': 18508}}
[[6191    5   87]
 [5715    6   91]
 [6301    4  108]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105501
{'0': {'precision': 0.33424850142856305, 'recall': 0.994806966009232, 'f1-score': 0.5003745076799726, 'support': 171576}, '1': {'precision': 0.38045375218150085, 'recall': 0.0012293880129029347, 'f1-score': 0.0024508563944304848, 'support': 177324}, '2': {'precision': 0.3217680608365019, 'recall': 0.004117253542540899, 'f1-score': 0.008130471855597055, 'support': 164430}, 'accuracy': 0.3342489236943097, 'macro avg': {'precision': 0.3454901048155219, 'recall': 0.333384535854892, 'f1-score': 0.17031861197666667, 'support': 513330}, 'weighted avg': {'precision': 0.34621184087484774, 'recall': 0.3342489236943097, 'f1-score': 0.17069671688037089, 'support': 513330}}
[[170685    222    669]
 [176348    218    758]
 [163620    133    677]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051596
{'0': {'precision': 0.3403298350824588, 'recall': 0.993912857753097, 'f1-score': 0.5070414862030455, 'support': 46820}, '1': {'precision': 0.3224489795918367, 'recall': 0.001657087720770231, 'f1-score': 0.003297230743546401, 'support': 47674}, '2': {'precision': 0.3500897666068223, 'recall': 0.0045303533675626695, 'f1-score': 0.008944954128440366, 'support': 43043}, 'accuracy': 0.34033750917934813, 'macro avg': {'precision': 0.33762286042703926, 'recall': 0.3333667662804766, 'f1-score': 0.17309455702501073, 'support': 137537}, 'weighted avg': {'precision': 0.33718627973330373, 'recall': 0.34033750917934813, 'f1-score': 0.1765480723226832, 'support': 137537}}
[[46535    84   201]
 [47434    79   161]
 [42766    82   195]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050225
{'0': {'precision': 0.3228053878309336, 'recall': 0.9934879288437103, 'f1-score': 0.48728235889845367, 'support': 12592}, '1': {'precision': 0.44776119402985076, 'recall': 0.004508905087547907, 'f1-score': 0.008927907149765641, 'support': 13307}, '2': {'precision': 0.3333333333333333, 'recall': 0.004106151623450688, 'f1-score': 0.00811237136633366, 'support': 13151}, 'accuracy': 0.32327784891165173, 'macro avg': {'precision': 0.36796663839803917, 'recall': 0.3340343285182363, 'f1-score': 0.168107545804851, 'support': 39050}, 'weighted avg': {'precision': 0.3689318903761589, 'recall': 0.32327784891165173, 'f1-score': 0.1629026611915471, 'support': 39050}}
[[12510    32    50]
 [13189    60    58]
 [13055    42    54]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059628
{'0': {'precision': 0.32704933206476583, 'recall': 0.9752490500154052, 'f1-score': 0.48983328981007745, 'support': 77896}, '1': {'precision': 0.3184713375796178, 'recall': 0.0018577461823315953, 'f1-score': 0.003693944393823725, 'support': 80743}, '2': {'precision': 0.3496436139472163, 'recall': 0.022886036365470454, 'f1-score': 0.042960105092488494, 'support': 79306}, 'accuracy': 0.3275252684443884, 'macro avg': {'precision': 0.33172142786386666, 'recall': 0.33333094418773573, 'f1-score': 0.17882911309879657, 'support': 237945}, 'weighted avg': {'precision': 0.33166909339723893, 'recall': 0.3275252684443884, 'f1-score': 0.17592850528357895, 'support': 237945}}
[[75968   159  1769]
 [78986   150  1607]
 [77329   162  1815]]
Evaluating performance on  train set...
381/381 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038944
{'0': {'precision': 0.3308314209318483, 'recall': 0.9744504046386159, 'f1-score': 0.49396046995952686, 'support': 32251}, '1': {'precision': 0.3119266055045872, 'recall': 0.0031719376807538015, 'f1-score': 0.006280014776505357, 'support': 32157}, '2': {'precision': 0.37545454545454543, 'recall': 0.02494488569444025, 'f1-score': 0.046781638490074474, 'support': 33113}, 'accuracy': 0.3317746946811456, 'macro avg': {'precision': 0.33940419063032695, 'recall': 0.33418907600460335, 'f1-score': 0.18234070774203556, 'support': 97521}, 'weighted avg': {'precision': 0.3397493296143437, 'recall': 0.3317746946811456, 'f1-score': 0.18131218862762502, 'support': 97521}}
[[31427   113   711]
 [31392   102   663]
 [32175   112   826]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1065305
{'0': {'precision': 0.3162630250008891, 'recall': 0.9624458874458874, 'f1-score': 0.47608340694344065, 'support': 9240}, '1': {'precision': 0.3037037037037037, 'recall': 0.004171329738528844, 'f1-score': 0.008229626655961463, 'support': 9829}, '2': {'precision': 0.32077764277035237, 'recall': 0.026378896882494004, 'f1-score': 0.04874896131474472, 'support': 10008}, 'accuracy': 0.31633249647487705, 'macro avg': {'precision': 0.31358145715831504, 'recall': 0.3309987046889701, 'f1-score': 0.17768733163804895, 'support': 29077}, 'weighted avg': {'precision': 0.3135714380286001, 'recall': 0.31633249647487705, 'f1-score': 0.17084910016152985, 'support': 29077}}
[[8893   48  299]
 [9528   41  260]
 [9698   46  264]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1078202
{'0': {'precision': 0.29949445891650844, 'recall': 0.9975856659640179, 'f1-score': 0.4606829964005161, 'support': 81596}, '1': {'precision': 0.38095238095238093, 'recall': 8.601318152006796e-05, 'f1-score': 0.00017198753090400947, 'support': 93009}, '2': {'precision': 0.37306501547987614, 'recall': 0.002462953500255493, 'f1-score': 0.004893599740090968, 'support': 97850}, 'accuracy': 0.2996751757170909, 'macro avg': {'precision': 0.35117061844958847, 'recall': 0.33337821088193115, 'f1-score': 0.1552495278905037, 'support': 272455}, 'weighted avg': {'precision': 0.35372432744657767, 'recall': 0.2996751757170909, 'f1-score': 0.13978354185875197, 'support': 272455}}
[[81399     6   191]
 [92787     8   214]
 [97602     7   241]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024739
{'0': {'precision': 0.34436109320361796, 'recall': 0.9977641931284316, 'f1-score': 0.5120105727895898, 'support': 35334}, '1': {'precision': 0.42857142857142855, 'recall': 8.876527502441045e-05, 'f1-score': 0.0001774937877174299, 'support': 33797}, '2': {'precision': 0.3319838056680162, 'recall': 0.0024476881287125757, 'f1-score': 0.004859547232428588, 'support': 33501}, 'accuracy': 0.34433704887364563, 'macro avg': {'precision': 0.3683054424810209, 'recall': 0.33343354884405624, 'f1-score': 0.1723492046032453, 'support': 102632}, 'weighted avg': {'precision': 0.36805161072929904, 'recall': 0.34433704887364563, 'f1-score': 0.17791897291609285, 'support': 102632}}
[[35255     2    77]
 [33706     3    88]
 [33417     2    82]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066619
{'0': {'precision': 0.3012275429959721, 'recall': 0.9964047795283917, 'f1-score': 0.4626034021453644, 'support': 9457}, '1': {'precision': 0.5, 'recall': 0.00019083969465648855, 'f1-score': 0.0003815337657382678, 'support': 10480}, '2': {'precision': 0.37894736842105264, 'recall': 0.0031457532331352674, 'f1-score': 0.0062397088135887, 'support': 11444}, 'accuracy': 0.30148816162646186, 'macro avg': {'precision': 0.39339163713900827, 'recall': 0.33324712415206115, 'f1-score': 0.15640821490823045, 'support': 31381}, 'weighted avg': {'precision': 0.39595240936628645, 'recall': 0.30148816162646186, 'f1-score': 0.14181339267761886, 'support': 31381}}
[[ 9423     0    34]
 [10453     2    25]
 [11406     2    36]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1262668
{'0': {'precision': 0.266309853816869, 'recall': 0.9774137746549203, 'f1-score': 0.41857356970339177, 'support': 112148}, '1': {'precision': 0.44344344344344344, 'recall': 0.0024648220376233105, 'f1-score': 0.004902394758974812, 'support': 179729}, '2': {'precision': 0.31846986980066827, 'recall': 0.021358803165182988, 'f1-score': 0.040032732987174746, 'support': 129408}, 'accuracy': 0.2678044554161672, 'macro avg': {'precision': 0.3427410556869936, 'recall': 0.33374579995257553, 'f1-score': 0.1545028991498471, 'support': 421285}, 'weighted avg': {'precision': 0.3579009768770921, 'recall': 0.2678044554161672, 'f1-score': 0.12581470290453273, 'support': 421285}}
[[109615    265   2268]
 [175639    443   3647]
 [126353    291   2764]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1036478
{'0': {'precision': 0.3370732635585157, 'recall': 0.9755898746447533, 'f1-score': 0.5010352669631037, 'support': 45391}, '1': {'precision': 0.3629032258064516, 'recall': 0.002025384823116392, 'f1-score': 0.0040282875302121565, 'support': 44436}, '2': {'precision': 0.3375881760161236, 'recall': 0.022446563777276482, 'f1-score': 0.042094240837696334, 'support': 44773}, 'accuracy': 0.33713224368499256, 'macro avg': {'precision': 0.34585488846036366, 'recall': 0.3333539410817154, 'f1-score': 0.18238593177700405, 'support': 134600}, 'weighted avg': {'precision': 0.34577188449398194, 'recall': 0.33713224368499256, 'f1-score': 0.18429552921575723, 'support': 134600}}
[[44283    80  1028]
 [43402    90   944]
 [43690    78  1005]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1108843
{'0': {'precision': 0.3111866078522699, 'recall': 0.9787160706591986, 'f1-score': 0.4722268418426742, 'support': 11605}, '1': {'precision': 0.39655172413793105, 'recall': 0.00172349194454852, 'f1-score': 0.0034320674475863612, 'support': 13345}, '2': {'precision': 0.34177215189873417, 'recall': 0.021779462773251594, 'f1-score': 0.040949419883218326, 'support': 12397}, 'accuracy': 0.31196615524674004, 'macro avg': {'precision': 0.3498368279629784, 'recall': 0.33407300845899957, 'f1-score': 0.17220277639115963, 'support': 37347}, 'weighted avg': {'precision': 0.3518422553306796, 'recall': 0.31196615524674004, 'f1-score': 0.1615563070116618, 'support': 37347}}
[[11358    17   230]
 [13032    23   290]
 [12109    18   270]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
5929/5929 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1082793
{'0': {'precision': 0.33087609885509245, 'recall': 0.9955567593619737, 'f1-score': 0.4966793979595487, 'support': 502111}, '1': {'precision': 0.3663003663003663, 'recall': 0.0007268194562300238, 'f1-score': 0.0014507602890639873, 'support': 550343}, '2': {'precision': 0.32521037868162694, 'recall': 0.003988226668873987, 'f1-score': 0.007879818955318665, 'support': 465119}, 'accuracy': 0.33088029373216316, 'macro avg': {'precision': 0.34079561461236185, 'recall': 0.3334239351623592, 'f1-score': 0.16866999240131045, 'support': 1517573}, 'weighted avg': {'precision': 0.34198611696774484, 'recall': 0.33088029373216316, 'f1-score': 0.16727475941606115, 'support': 1517573}}
[[499880    358   1873]
 [547967    400   1976]
 [462930    334   1855]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103778
{'0': {'precision': 0.3287162734118798, 'recall': 0.9935844586590855, 'f1-score': 0.49399863835641605, 'support': 105525}, '1': {'precision': 0.27586206896551724, 'recall': 0.0003026290902212975, 'f1-score': 0.0006045949214026603, 'support': 105740}, '2': {'precision': 0.353968253968254, 'recall': 0.006098283547396151, 'f1-score': 0.01198999937272051, 'support': 109703}, 'accuracy': 0.3288458662545799, 'macro avg': {'precision': 0.319515532115217, 'recall': 0.33332845709890097, 'f1-score': 0.1688644108835131, 'support': 320968}, 'weighted avg': {'precision': 0.3199347576371532, 'recall': 0.3288458662545799, 'f1-score': 0.16670968782163792, 'support': 320968}}
[[104848     40    637]
 [105124     32    584]
 [108990     44    669]]
Evaluating performance on  val set...
427/427 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1067421
{'0': {'precision': 0.32352697515579404, 'recall': 0.9950455806579469, 'f1-score': 0.48829180530567734, 'support': 35322}, '1': {'precision': 0.22727272727272727, 'recall': 0.00013267878466233248, 'f1-score': 0.00026520274750046406, 'support': 37685}, '2': {'precision': 0.3351449275362319, 'recall': 0.00510993260413214, 'f1-score': 0.010066383719664817, 'support': 36204}, 'accuracy': 0.32356630742324494, 'macro avg': {'precision': 0.2953148766549177, 'recall': 0.3334293973489138, 'f1-score': 0.16620779725761423, 'support': 109211}, 'weighted avg': {'precision': 0.2941643195305182, 'recall': 0.32356630742324494, 'f1-score': 0.1613562797587554, 'support': 109211}}
[[35147    10   165]
 [37478     5   202]
 [36012     7   185]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
5331/5331 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151606
{'0': {'precision': 0.3012436817569073, 'recall': 0.9964459299694949, 'f1-score': 0.4626268684024619, 'support': 411078}, '1': {'precision': 0.375, 'recall': 0.0003661256768631103, 'f1-score': 0.0007315371283228666, 'support': 532604}, '2': {'precision': 0.31548580660050773, 'recall': 0.0032476171470384205, 'f1-score': 0.006429053490007219, 'support': 420924}, 'accuracy': 0.3013170101846247, 'macro avg': {'precision': 0.33057649611913836, 'recall': 0.33335322426446545, 'f1-score': 0.15659581967359734, 'support': 1364606}, 'weighted avg': {'precision': 0.3344237808325466, 'recall': 0.3013170101846247, 'f1-score': 0.1416317166428026, 'support': 1364606}}
[[409617    169   1292]
 [530735    195   1674]
 [419401    156   1367]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034485
{'0': {'precision': 0.3387139800104757, 'recall': 0.9966026147834954, 'f1-score': 0.5055928151544437, 'support': 174546}, '1': {'precision': 0.3, 'recall': 0.0002601321471307424, 'f1-score': 0.000519813560203074, 'support': 172989}, '2': {'precision': 0.34149403640929066, 'recall': 0.0032423991369496413, 'f1-score': 0.006423805868807936, 'support': 167777}, 'accuracy': 0.33871130499580837, 'macro avg': {'precision': 0.3267360054732555, 'recall': 0.3333683820225253, 'f1-score': 0.1708454781944849, 'support': 515312}, 'weighted avg': {'precision': 0.3266229299949352, 'recall': 0.33871130499580837, 'f1-score': 0.173519911081373, 'support': 515312}}
[[173953     57    536]
 [172431     45    513]
 [167185     48    544]]
Evaluating performance on  val set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105359
{'0': {'precision': 0.32797864897194573, 'recall': 0.9957686641312913, 'f1-score': 0.4934338418179811, 'support': 58374}, '1': {'precision': 0.3793103448275862, 'recall': 0.0005438096336700559, 'f1-score': 0.0010860622017442817, 'support': 60683}, '2': {'precision': 0.34039087947882735, 'recall': 0.0035500747384155456, 'f1-score': 0.007026863463672124, 'support': 58872}, 'accuracy': 0.32804658037756634, 'macro avg': {'precision': 0.34922662442611974, 'recall': 0.3332875161677923, 'f1-score': 0.1671822558277992, 'support': 177929}, 'weighted avg': {'precision': 0.3495922933694805, 'recall': 0.32804658037756634, 'f1-score': 0.16457855718126096, 'support': 177929}}
[[58127    28   219]
 [60464    33   186]
 [58637    26   209]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
4192/4192 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128856
{'0': {'precision': 0.2671655671946833, 'recall': 0.9876102002500949, 'f1-score': 0.42056189824957463, 'support': 287091}, '1': {'precision': 0.3663773412517131, 'recall': 0.0016542324217178853, 'f1-score': 0.0032935939187607546, 'support': 484817}, '2': {'precision': 0.3236022281823809, 'recall': 0.010413554550826246, 'f1-score': 0.02017778578228317, 'support': 301242}, 'accuracy': 0.2678777430927643, 'macro avg': {'precision': 0.3190483788762591, 'recall': 0.3332259957408797, 'f1-score': 0.1480110926502062, 'support': 1073150}, 'weighted avg': {'precision': 0.32782870589128954, 'recall': 0.2678777430927643, 'f1-score': 0.11966148515855847, 'support': 1073150}}
[[283534    631   2926]
 [480384    802   3631]
 [297349    756   3137]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015359
{'0': {'precision': 0.3434963589623444, 'recall': 0.9895981655787118, 'f1-score': 0.5099763902025297, 'support': 108154}, '1': {'precision': 0.26834381551362685, 'recall': 0.0012556405728860113, 'f1-score': 0.0024995850298290324, 'support': 101940}, '2': {'precision': 0.36318230467356405, 'recall': 0.009716243688736602, 'f1-score': 0.018926154532609506, 'support': 104773}, 'accuracy': 0.3435577561319541, 'macro avg': {'precision': 0.32500749304984505, 'recall': 0.3335233499467782, 'f1-score': 0.1771340432549894, 'support': 314867}, 'weighted avg': {'precision': 0.3257158526242377, 'recall': 0.3435577561319541, 'f1-score': 0.18227932489829124, 'support': 314867}}
[[107029    201    924]
 [100951    128    861]
 [103607    148   1018]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106558
{'0': {'precision': 0.32570183690647125, 'recall': 0.9865622844116501, 'f1-score': 0.4897263333432596, 'support': 33339}, '1': {'precision': 0.29608938547486036, 'recall': 0.0015114355786231678, 'f1-score': 0.003007518796992482, 'support': 35066}, '2': {'precision': 0.33950046253469013, 'recall': 0.0108451536643026, 'f1-score': 0.021018871166346896, 'support': 33840}, 'accuracy': 0.32579588243923907, 'macro avg': {'precision': 0.3204305616386739, 'recall': 0.33297295788485864, 'f1-score': 0.1712509077688663, 'support': 102245}, 'weighted avg': {'precision': 0.3201128620847984, 'recall': 0.32579588243923907, 'f1-score': 0.1676730058363289, 'support': 102245}}
[[32891    61   387]
 [34686    53   327]
 [33408    65   367]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
6143/6143 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1261818
{'0': {'precision': 0.27699451423710486, 'recall': 0.9925175298667616, 'f1-score': 0.43311430141069507, 'support': 435685}, '1': {'precision': 0.517490952955368, 'recall': 0.0006272159070141453, 'f1-score': 0.0012529132423291921, 'support': 683975}, '2': {'precision': 0.2842235082060526, 'recall': 0.006615994099487239, 'f1-score': 0.012930987973231646, 'support': 452842}, 'accuracy': 0.27716975876660255, 'macro avg': {'precision': 0.3595696584661751, 'recall': 0.33325357995775434, 'f1-score': 0.14909940087541865, 'support': 1572502}, 'weighted avg': {'precision': 0.3836825462772614, 'recall': 0.27716975876660255, 'f1-score': 0.12426951457029303, 'support': 1572502}}
[[432425    233   3027]
 [679028    429   4518]
 [449679    167   2996]]
Evaluating performance on  train set...
2083/2083 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1039152
{'0': {'precision': 0.3323065875505499, 'recall': 0.9919224737988064, 'f1-score': 0.4978328629140704, 'support': 177282}, '1': {'precision': 0.3160621761658031, 'recall': 0.0003457187549590805, 'f1-score': 0.0006906820201882958, 'support': 176444}, '2': {'precision': 0.3327263267429761, 'recall': 0.0071257054671264855, 'f1-score': 0.013952600430905173, 'support': 179491}, 'accuracy': 0.3323037337519246, 'macro avg': {'precision': 0.3270316968197764, 'recall': 0.3331312993402973, 'f1-score': 0.17082538178838794, 'support': 533217}, 'weighted avg': {'precision': 0.327072528030725, 'recall': 0.3323037337519246, 'f1-score': 0.17044287504983135, 'support': 533217}}
[[175850     62   1370]
 [175188     61   1195]
 [178142     70   1279]]
Evaluating performance on  val set...
685/685 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1097851
{'0': {'precision': 0.31438875404065386, 'recall': 0.9925547948936788, 'f1-score': 0.47752340265674215, 'support': 55069}, '1': {'precision': 0.24193548387096775, 'recall': 0.00024035765218645343, 'f1-score': 0.00048023819814628054, 'support': 62407}, '2': {'precision': 0.33599361532322425, 'recall': 0.007296739865157634, 'f1-score': 0.0142832909245123, 'support': 57697}, 'accuracy': 0.3145176482677125, 'macro avg': {'precision': 0.29743928441161527, 'recall': 0.33336396413700764, 'f1-score': 0.16409564392646692, 'support': 175173}, 'weighted avg': {'precision': 0.29569263334820045, 'recall': 0.3145176482677125, 'f1-score': 0.15499426008921144, 'support': 175173}}
[[54659    21   389]
 [61949    15   443]
 [57250    26   421]]
testing model on single stock: results/universal/W7/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
23942/23942 - 336s - 336s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1214967
{'0': {'precision': 0.2942076214194145, 'recall': 0.9936430198539181, 'f1-score': 0.45399262933500345, 'support': 1803372}, '1': {'precision': 0.3768230193141506, 'recall': 0.00037632846704409734, 'f1-score': 0.0007519060148941885, 'support': 2540334}, '2': {'precision': 0.2994735815948528, 'recall': 0.006022321573600365, 'f1-score': 0.011807203909818527, 'support': 1785358}, 'accuracy': 0.29427266545103786, 'macro avg': {'precision': 0.323501407442806, 'recall': 0.3333472232981875, 'f1-score': 0.15551724641990539, 'support': 6129064}, 'weighted avg': {'precision': 0.32998344760142645, 'recall': 0.29427266545103786, 'f1-score': 0.13733055721421572, 'support': 6129064}}
[[1791908     825   10639]
 [2524866     956   14512]
 [1773850     756   10752]]
Evaluating performance on  train set...
9052/9052 - 127s - 127s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035491
{'0': {'precision': 0.33567544913089353, 'recall': 0.9945752567433287, 'f1-score': 0.5019422196545817, 'support': 777917}, '1': {'precision': 0.3061630218687873, 'recall': 0.00020088886801731818, 'f1-score': 0.0004015142824366181, 'support': 766593}, '2': {'precision': 0.3428644807807551, 'recall': 0.005183996272182456, 'f1-score': 0.01021356683000723, 'support': 772570}, 'accuracy': 0.335705284237057, 'macro avg': {'precision': 0.32823431726014535, 'recall': 0.3333200472945095, 'f1-score': 0.1708524335890085, 'support': 2317080}, 'weighted avg': {'precision': 0.32830842254121767, 'recall': 0.335705284237057, 'f1-score': 0.17205615647763903, 'support': 2317080}}
[[773697    196   4024]
 [762787    154   3652]
 [768412    153   4005]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081462
{'0': {'precision': 0.3181629478820415, 'recall': 0.9941802350118839, 'f1-score': 0.4820557890961495, 'support': 225095}, '1': {'precision': 0.3525641025641026, 'recall': 0.00022317171643395942, 'f1-score': 0.0004460610779268703, 'support': 246447}, '2': {'precision': 0.3385183232269971, 'recall': 0.005445916199055872, 'f1-score': 0.010719384219797469, 'support': 235773}, 'accuracy': 0.31827969150944063, 'macro avg': {'precision': 0.3364151245577138, 'recall': 0.3332831076424579, 'f1-score': 0.16440707813129127, 'support': 707315}, 'weighted avg': {'precision': 0.33693437119292297, 'recall': 0.31827969150944063, 'f1-score': 0.15713737109593875, 'support': 707315}}
[[223785     45   1265]
 [245148     55   1244]
 [234433     56   1284]]
training model: results/universal/W7/deepVOL_L3/h500
Epoch 1/50
12475/12475 - 669s - loss: 3.2835 - accuracy500: 0.3660 - val_loss: 3.3028 - val_accuracy500: 0.3182 - 669s/epoch - 54ms/step
Epoch 2/50
12475/12475 - 677s - loss: 3.2839 - accuracy500: 0.3633 - val_loss: 3.2997 - val_accuracy500: 0.3332 - 677s/epoch - 54ms/step
Epoch 3/50
12475/12475 - 673s - loss: 3.2742 - accuracy500: 0.3730 - val_loss: 3.3252 - val_accuracy500: 0.3253 - 673s/epoch - 54ms/step
Epoch 4/50
12475/12475 - 676s - loss: 3.2664 - accuracy500: 0.3808 - val_loss: 3.3343 - val_accuracy500: 0.3348 - 676s/epoch - 54ms/step
Epoch 5/50
12475/12475 - 680s - loss: 3.2547 - accuracy500: 0.3900 - val_loss: 3.3539 - val_accuracy500: 0.3310 - 680s/epoch - 54ms/step
Epoch 6/50
12475/12475 - 678s - loss: 3.2467 - accuracy500: 0.3945 - val_loss: 3.3285 - val_accuracy500: 0.3280 - 678s/epoch - 54ms/step
Epoch 7/50
12475/12475 - 676s - loss: 3.2406 - accuracy500: 0.3978 - val_loss: 3.3372 - val_accuracy500: 0.3241 - 676s/epoch - 54ms/step
Epoch 8/50
12475/12475 - 678s - loss: 3.2351 - accuracy500: 0.4006 - val_loss: 3.3405 - val_accuracy500: 0.3231 - 678s/epoch - 54ms/step
Epoch 9/50
12475/12475 - 681s - loss: 3.2319 - accuracy500: 0.4023 - val_loss: 3.3322 - val_accuracy500: 0.3203 - 681s/epoch - 55ms/step
Epoch 10/50
12475/12475 - 677s - loss: 3.2286 - accuracy500: 0.4038 - val_loss: 3.3405 - val_accuracy500: 0.3204 - 677s/epoch - 54ms/step
Epoch 11/50
12475/12475 - 673s - loss: 3.2261 - accuracy500: 0.4054 - val_loss: 3.3348 - val_accuracy500: 0.3229 - 673s/epoch - 54ms/step
Epoch 12/50
12475/12475 - 683s - loss: 3.2232 - accuracy500: 0.4072 - val_loss: 3.3312 - val_accuracy500: 0.3213 - 683s/epoch - 55ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 1102s - 1102s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037257
{'0': {'precision': 0.30888005429369675, 'recall': 0.36937159975208317, 'f1-score': 0.3364282832350372, 'support': 2904200}, '1': {'precision': 0.38820662096524167, 'recall': 0.012092705826427004, 'f1-score': 0.023454790717882475, 'support': 3727619}, '2': {'precision': 0.29985111112275464, 'recall': 0.6173345447573261, 'f1-score': 0.40364444863090293, 'support': 2873753}, 'accuracy': 0.30422924575186006, 'macro avg': {'precision': 0.33231259546056435, 'recall': 0.3329329501119454, 'f1-score': 0.25450917419460756, 'support': 9505572}, 'weighted avg': {'precision': 0.33725838487762094, 'recall': 0.30422924575186006, 'f1-score': 0.23401642624753147, 'support': 9505572}}
[[1072729   35769 1795702]
 [1335818   45077 2346724]
 [1064416   35270 1774067]]
Evaluating performance on  train set...
12475/12475 - 378s - 378s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000047
{'0': {'precision': 0.33596109339431324, 'recall': 0.3650870873066536, 'f1-score': 0.34991905096465015, 'support': 1066803}, '1': {'precision': 0.33578515224084843, 'recall': 0.011020732413660169, 'f1-score': 0.021341035288447337, 'support': 1068713}, '2': {'precision': 0.3310365288967584, 'recall': 0.6256325834367151, 'f1-score': 0.43297569894450355, 'support': 1057568}, 'accuracy': 0.33287661708868294, 'macro avg': {'precision': 0.3342609248439734, 'recall': 0.33391346771900965, 'f1-score': 0.268078595065867, 'support': 3193084}, 'weighted avg': {'precision': 0.33427116214775254, 'recall': 0.33287661708868294, 'f1-score': 0.26745409114004043, 'support': 3193084}}
[[389476  11786 665541]
 [385406  11778 671529]
 [384407  11512 661649]]
Evaluating performance on  val set...
3866/3866 - 119s - 119s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000252
{'0': {'precision': 0.3209386055633213, 'recall': 0.34281521005514026, 'f1-score': 0.33151639325335924, 'support': 314108}, '1': {'precision': 0.3512726026223327, 'recall': 0.012028641018869033, 'f1-score': 0.023260762855416117, 'support': 340770}, '2': {'precision': 0.33961253181394796, 'recall': 0.6521697514985463, 'f1-score': 0.44664040526948656, 'support': 334324}, 'accuracy': 0.3334162284346372, 'macro avg': {'precision': 0.3372745799998673, 'recall': 0.3356712008575185, 'f1-score': 0.2671391871260873, 'support': 989202}, 'weighted avg': {'precision': 0.3376996492102345, 'recall': 0.3334162284346372, 'f1-score': 0.26423433056300144, 'support': 989202}}
[[107681   3770 202657]
 [115350   4099 221321]
 [112488   3800 218036]]
testing model out of sample: results/universal/W7/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 450s - 450s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1032016
{'0': {'precision': 0.298835780600821, 'recall': 0.3667306355315687, 'f1-score': 0.32932020932231715, 'support': 1116168}, '1': {'precision': 0.4078792520501373, 'recall': 0.014666499190269532, 'f1-score': 0.028314854438176752, 'support': 1488767}, '2': {'precision': 0.30860113059715777, 'recall': 0.6204526193271857, 'f1-score': 0.41218794891453764, 'support': 1169327}, 'accuracy': 0.30646521094719975, 'macro avg': {'precision': 0.3384387210827054, 'recall': 0.3339499180163413, 'f1-score': 0.2566076708916772, 'support': 3774262}, 'weighted avg': {'precision': 0.34487371047276705, 'recall': 0.30646521094719975, 'f1-score': 0.23626165805040103, 'support': 3774262}}
[[409333  15655 691180]
 [532654  21835 934278]
 [427772  16043 725512]]
Evaluating performance on  train set...
5285/5285 - 165s - 165s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994545
{'0': {'precision': 0.33926258047236907, 'recall': 0.37416036162978455, 'f1-score': 0.3558579414981006, 'support': 457042}, '1': {'precision': 0.3471881100824989, 'recall': 0.012334657860351895, 'f1-score': 0.023822950493808757, 'support': 446952}, '2': {'precision': 0.3315804263658984, 'recall': 0.6154235353904586, 'f1-score': 0.4309641912836633, 'support': 448652}, 'accuracy': 0.33462635456727036, 'macro avg': {'precision': 0.33934370564025546, 'recall': 0.333972851626865, 'f1-score': 0.27021502775852424, 'support': 1352646}, 'weighted avg': {'precision': 0.33933334363296724, 'recall': 0.33462635456727036, 'f1-score': 0.27105590599098495, 'support': 1352646}}
[[171007   5309 280726]
 [165564   5513 275875]
 [167484   5057 276111]]
Evaluating performance on  val set...
1714/1714 - 51s - 51s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0988909
{'0': {'precision': 0.3307177947598253, 'recall': 0.37100668712467555, 'f1-score': 0.34970566532753955, 'support': 143709}, '1': {'precision': 0.3338960162052667, 'recall': 0.013858916510187495, 'f1-score': 0.026613207039448902, 'support': 142724}, '2': {'precision': 0.346711259754738, 'recall': 0.6195341719381798, 'f1-score': 0.4446064450466869, 'support': 151601}, 'accuracy': 0.3406516389138743, 'macro avg': {'precision': 0.33710835690661, 'recall': 0.3347999251910143, 'f1-score': 0.2736417724712251, 'support': 438034}, 'weighted avg': {'precision': 0.3372885946618259, 'recall': 0.3406516389138743, 'f1-score': 0.27727750927000294, 'support': 438034}}
[[53317  1979 88413]
 [52187  1978 88559]
 [55712  1967 93922]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037521
{'0': {'precision': 0.27606540171789984, 'recall': 0.4031337595031156, 'f1-score': 0.32771325295279624, 'support': 49589}, '1': {'precision': 0.3622614332012964, 'recall': 0.01407445751780293, 'f1-score': 0.027096183370592827, 'support': 71477}, '2': {'precision': 0.318836206476984, 'recall': 0.5760842801364804, 'f1-score': 0.4104868069001385, 'support': 56858}, 'accuracy': 0.30210651738944716, 'macro avg': {'precision': 0.3190543471320601, 'recall': 0.33109749905246627, 'f1-score': 0.25509874774117586, 'support': 177924}, 'weighted avg': {'precision': 0.32436071971508257, 'recall': 0.30210651738944716, 'f1-score': 0.23339844689971087, 'support': 177924}}
[[19991   819 28779]
 [29272  1006 41199]
 [23151   952 32755]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994495
{'0': {'precision': 0.34336915101788595, 'recall': 0.4086952968577616, 'f1-score': 0.3731950300361927, 'support': 24473}, '1': {'precision': 0.3309248554913295, 'recall': 0.009415344132883809, 'f1-score': 0.018309746541936515, 'support': 24322}, '2': {'precision': 0.32794309425014817, 'recall': 0.5961380974957976, 'f1-score': 0.42312163485070975, 'support': 23201}, 'accuracy': 0.33421301183399077, 'macro avg': {'precision': 0.3340790335864545, 'recall': 0.3380829128288143, 'f1-score': 0.27154213714294634, 'support': 71996}, 'weighted avg': {'precision': 0.33419405658395646, 'recall': 0.33421301183399077, 'f1-score': 0.2693951980060009, 'support': 71996}}
[[10002   255 14216]
 [ 9965   229 14128]
 [ 9162   208 13831]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098801
{'0': {'precision': 0.337688127090301, 'recall': 0.5474415452389021, 'f1-score': 0.4177117000646413, 'support': 5902}, '1': {'precision': 0.34959349593495936, 'recall': 0.013718296379007816, 'f1-score': 0.026400613967766693, 'support': 6269}, '2': {'precision': 0.3554175293305728, 'recall': 0.487612434906107, 'f1-score': 0.41115028940190274, 'support': 6337}, 'accuracy': 0.34617462718824293, 'macro avg': {'precision': 0.347566384118611, 'recall': 0.34959075884133894, 'f1-score': 0.2850875344781036, 'support': 18508}, 'weighted avg': {'precision': 0.3477911084650452, 'recall': 0.34617462718824293, 'f1-score': 0.2829208605297871, 'support': 18508}}
[[3231   89 2582]
 [3161   86 3022]
 [3176   71 3090]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
2006/2006 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097368
{'0': {'precision': 0.3617645787714648, 'recall': 0.5425452620662835, 'f1-score': 0.4340849769234758, 'support': 185144}, '1': {'precision': 0.30533518445061486, 'recall': 0.020515178166893206, 'f1-score': 0.03844713051296139, 'support': 150084}, '2': {'precision': 0.34610030942185105, 'recall': 0.43836677858755096, 'f1-score': 0.38680750289830657, 'support': 178102}, 'accuracy': 0.35377242709368245, 'macro avg': {'precision': 0.3377333575479769, 'recall': 0.33380907294024253, 'f1-score': 0.2864465367782479, 'support': 513330}, 'weighted avg': {'precision': 0.33983134495120226, 'recall': 0.35377242709368245, 'f1-score': 0.3020079052161796, 'support': 513330}}
[[100449   3837  80858]
 [ 80355   3079  66650]
 [ 96860   3168  78074]]
Evaluating performance on  train set...
538/538 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986544
{'0': {'precision': 0.3527501140847717, 'recall': 0.5407151380488006, 'f1-score': 0.4269608161673923, 'support': 48606}, '1': {'precision': 0.3088937093275488, 'recall': 0.015973079080201905, 'f1-score': 0.03037542662116041, 'support': 44575}, '2': {'precision': 0.32506669301452423, 'recall': 0.44503562088556226, 'f1-score': 0.3757065910431853, 'support': 44356}, 'accuracy': 0.33979220137126737, 'macro avg': {'precision': 0.3289035054756149, 'recall': 0.3339079460048549, 'f1-score': 0.2776809446105793, 'support': 137537}, 'weighted avg': {'precision': 0.3296085226072412, 'recall': 0.33979220137126737, 'f1-score': 0.28190002417227383, 'support': 137537}}
[[26282   795 21529]
 [24406   712 19457]
 [23818   798 19740]]
Evaluating performance on  val set...
153/153 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019813
{'0': {'precision': 0.2893263582966226, 'recall': 0.5454624102431006, 'f1-score': 0.37809960720817964, 'support': 11559}, '1': {'precision': 0.44, 'recall': 0.02058595766649458, 'f1-score': 0.03933173047284384, 'support': 15496}, '2': {'precision': 0.3033932135728543, 'recall': 0.418174239266361, 'f1-score': 0.3516545148625912, 'support': 11995}, 'accuracy': 0.29807938540332907, 'macro avg': {'precision': 0.3442398572898256, 'recall': 0.3280742023919854, 'f1-score': 0.25636195084787156, 'support': 39050}, 'weighted avg': {'precision': 0.3534382835430742, 'recall': 0.29807938540332907, 'f1-score': 0.23554503869150623, 'support': 39050}}
[[6305  219 5035]
 [8695  319 6482]
 [6792  187 5016]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
930/930 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004755
{'0': {'precision': 0.3187140411141007, 'recall': 0.3875769489421137, 'f1-score': 0.34978845087683463, 'support': 77324}, '1': {'precision': 0.3039914468995011, 'recall': 0.010476670064726907, 'f1-score': 0.020255268625704956, 'support': 81419}, '2': {'precision': 0.33073248859029963, 'recall': 0.58924017070276, 'f1-score': 0.4236666515364713, 'support': 79202}, 'accuracy': 0.32566769631637565, 'macro avg': {'precision': 0.3178126588679671, 'recall': 0.3290979299032002, 'f1-score': 0.2645701236796703, 'support': 237945}, 'weighted avg': {'precision': 0.31767676854544585, 'recall': 0.32566769631637565, 'f1-score': 0.26162118147819136, 'support': 237945}}
[[29969  1004 46351]
 [32478   853 48088]
 [31584   949 46669]]
Evaluating performance on  train set...
381/381 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997611
{'0': {'precision': 0.33178353882823763, 'recall': 0.35106018619422735, 'f1-score': 0.34114977307110433, 'support': 32117}, '1': {'precision': 0.3382497541789577, 'recall': 0.010676598386095592, 'f1-score': 0.02069982248698739, 'support': 32220}, '2': {'precision': 0.33721469586219033, 'recall': 0.635336306653809, 'f1-score': 0.4405830416383679, 'support': 33184}, 'accuracy': 0.33533290265686366, 'macro avg': {'precision': 0.3357493296231285, 'recall': 0.33235769707804397, 'f1-score': 0.2674775457321532, 'support': 97521}, 'weighted avg': {'precision': 0.33576800344216584, 'recall': 0.33533290265686366, 'f1-score': 0.26911089094639096, 'support': 97521}}
[[11275   331 20511]
 [10949   344 20927]
 [11759   342 21083]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001145
{'0': {'precision': 0.3059825712327426, 'recall': 0.356531660011409, 'f1-score': 0.3293286963852882, 'support': 8765}, '1': {'precision': 0.3167259786476868, 'recall': 0.008824112631370217, 'f1-score': 0.017169865920709945, 'support': 10086}, '2': {'precision': 0.34962062099768604, 'recall': 0.635341286915705, 'f1-score': 0.4510396056787809, 'support': 10226}, 'accuracy': 0.3339753069436324, 'macro avg': {'precision': 0.32410972362603846, 'recall': 0.33356568651949475, 'f1-score': 0.26584605599492633, 'support': 29077}, 'weighted avg': {'precision': 0.3250560899617531, 'recall': 0.3339753069436324, 'f1-score': 0.26385364030555236, 'support': 29077}}
[[3125   81 5559]
 [3470   89 6527]
 [3618  111 6497]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997612
{'0': {'precision': 0.2963620739043254, 'recall': 0.38786348924684155, 'f1-score': 0.33599454406694346, 'support': 80023}, '1': {'precision': 0.32519741564967697, 'recall': 0.004826131424188187, 'f1-score': 0.009511112044259215, 'support': 93864}, '2': {'precision': 0.359732342543828, 'recall': 0.6070428536644753, 'f1-score': 0.4517553793884485, 'support': 98568}, 'accuracy': 0.3351966379769136, 'macro avg': {'precision': 0.32709727736594346, 'recall': 0.333244158111835, 'f1-score': 0.26575367849988374, 'support': 272455}, 'weighted avg': {'precision': 0.329222110082205, 'recall': 0.3351966379769136, 'f1-score': 0.2653967321442145, 'support': 272455}}
[[31038   441 48544]
 [35458   453 57953]
 [38234   499 59835]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996512
{'0': {'precision': 0.3416919261504547, 'recall': 0.39039468788459886, 'f1-score': 0.3644233081300596, 'support': 34939}, '1': {'precision': 0.34823091247672255, 'recall': 0.005504533144942894, 'f1-score': 0.01083775247037005, 'support': 33972}, '2': {'precision': 0.3282295419454452, 'recall': 0.6052015064796418, 'f1-score': 0.4256233250258089, 'support': 33721}, 'accuracy': 0.3335704263777379, 'macro avg': {'precision': 0.3393841268575408, 'recall': 0.33370024250306113, 'f1-score': 0.26696146187541286, 'support': 102632}, 'weighted avg': {'precision': 0.3394331509701878, 'recall': 0.3335704263777379, 'f1-score': 0.2674917202517233, 'support': 102632}}
[[13640   192 21107]
 [13124   187 20661]
 [13155   158 20408]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985382
{'0': {'precision': 0.29385829207920794, 'recall': 0.4002317741255794, 'f1-score': 0.3388938447814452, 'support': 9492}, '1': {'precision': 0.2708333333333333, 'recall': 0.0039203860072376355, 'f1-score': 0.0077288941736028535, 'support': 9948}, '2': {'precision': 0.3762630400349555, 'recall': 0.5769198559584624, 'f1-score': 0.45547107438016526, 'support': 11941}, 'accuracy': 0.3418310442624518, 'macro avg': {'precision': 0.3136515551491656, 'recall': 0.3270240053637598, 'f1-score': 0.2673646044450711, 'support': 31381}, 'weighted avg': {'precision': 0.31791561357105397, 'recall': 0.3418310442624518, 'f1-score': 0.2782718050118872, 'support': 31381}}
[[3799   40 5653]
 [4142   39 5767]
 [4987   65 6889]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
1646/1646 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1052685
{'0': {'precision': 0.26093021402096367, 'recall': 0.3502755336793109, 'f1-score': 0.29907267826960854, 'support': 112146}, '1': {'precision': 0.40654677712669224, 'recall': 0.011217099944806515, 'f1-score': 0.021831834112783343, 'support': 179369}, '2': {'precision': 0.3017118777982618, 'recall': 0.6179548431840949, 'f1-score': 0.4054606128021033, 'support': 129770}, 'accuracy': 0.2883701057478904, 'macro avg': {'precision': 0.3230629563153059, 'recall': 0.3264824922694041, 'f1-score': 0.24212170839483171, 'support': 421285}, 'weighted avg': {'precision': 0.3354909836094641, 'recall': 0.2883701057478904, 'f1-score': 0.21380391552874728, 'support': 421285}}
[[ 39282   1247  71617]
 [ 63376   2012 113981]
 [ 47888   1690  80192]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993897
{'0': {'precision': 0.34692392456909993, 'recall': 0.36868619912501654, 'f1-score': 0.35747415778479996, 'support': 45258}, '1': {'precision': 0.3520227111426544, 'recall': 0.01114406398849645, 'f1-score': 0.02160419888058889, 'support': 44508}, '2': {'precision': 0.3340776082920065, 'recall': 0.6340723558014008, 'f1-score': 0.43759620713010283, 'support': 44834}, 'accuracy': 0.3388558692421991, 'macro avg': {'precision': 0.3443414146679203, 'recall': 0.3379675396383046, 'f1-score': 0.27222485459849727, 'support': 134600}, 'weighted avg': {'precision': 0.3443309457343938, 'recall': 0.3388558692421991, 'f1-score': 0.2731003972308526, 'support': 134600}}
[[16686   457 28115]
 [15461   496 28551]
 [15950   456 28428]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011161
{'0': {'precision': 0.3210064167510976, 'recall': 0.3355692850838482, 'f1-score': 0.3281263484940019, 'support': 11330}, '1': {'precision': 0.3832923832923833, 'recall': 0.01153590179693855, 'f1-score': 0.02239770279971285, 'support': 13523}, '2': {'precision': 0.33451546063117626, 'recall': 0.6719225228109492, 'f1-score': 0.4466613461026868, 'support': 12494}, 'accuracy': 0.33076284574396875, 'macro avg': {'precision': 0.3462714202248857, 'recall': 0.33967590323057867, 'f1-score': 0.26572846579880055, 'support': 37347}, 'weighted avg': {'precision': 0.3480788755771213, 'recall': 0.33076284574396875, 'f1-score': 0.2570793509948464, 'support': 37347}}
[[3802  122 7406]
 [4072  156 9295]
 [3970  129 8395]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
5929/5929 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975287
{'0': {'precision': 0.3689057140295775, 'recall': 0.41872795304265864, 'f1-score': 0.39224106576231055, 'support': 560168}, '1': {'precision': 0.2943754864610217, 'recall': 0.016074875904016035, 'f1-score': 0.030485062913092543, 'support': 447033}, '2': {'precision': 0.3370269239427486, 'recall': 0.5661497887815162, 'f1-score': 0.4225257784345107, 'support': 510372}, 'accuracy': 0.3496971809593344, 'macro avg': {'precision': 0.3334360414777826, 'recall': 0.33365087257606363, 'f1-score': 0.2817506357033046, 'support': 1517573}, 'weighted avg': {'precision': 0.33623017679028205, 'recall': 0.3496971809593344, 'f1-score': 0.2958632296741893, 'support': 1517573}}
[[234558   9068 316542]
 [187995   7186 251852]
 [213268   8157 288947]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995992
{'0': {'precision': 0.32492527590435316, 'recall': 0.3214911989687106, 'f1-score': 0.3231991156977935, 'support': 105499}, '1': {'precision': 0.32805783509183273, 'recall': 0.015844405858372337, 'f1-score': 0.030228831715967804, 'support': 105968}, '2': {'precision': 0.3383617224518362, 'recall': 0.6534369549136537, 'f1-score': 0.445852688905713, 'support': 109501}, 'accuracy': 0.33382767129433466, 'macro avg': {'precision': 0.3304482778160074, 'recall': 0.3302575199135789, 'f1-score': 0.2664268787731581, 'support': 320968}, 'weighted avg': {'precision': 0.3305434539326138, 'recall': 0.33382767129433466, 'f1-score': 0.26831892161880205, 'support': 320968}}
[[33917  1733 69849]
 [34224  1679 70065]
 [36243  1706 71552]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0976988
{'0': {'precision': 0.33990290749828506, 'recall': 0.3436383035476127, 'f1-score': 0.34176039898132426, 'support': 37490}, '1': {'precision': 0.28688106176620726, 'recall': 0.017133101640143894, 'f1-score': 0.03233508817352781, 'support': 32802}, '2': {'precision': 0.35655371304974764, 'recall': 0.6353452041419358, 'f1-score': 0.4567697124754085, 'support': 38919}, 'accuracy': 0.3495252309749018, 'macro avg': {'precision': 0.32777922743807997, 'recall': 0.33203886977656416, 'f1-score': 0.27695506654342017, 'support': 109211}, 'weighted avg': {'precision': 0.32991133263452366, 'recall': 0.3495252309749018, 'f1-score': 0.28980847496963064, 'support': 109211}}
[[12883   704 23903]
 [11520   562 20720]
 [13499   693 24727]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
5331/5331 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007125
{'0': {'precision': 0.3243500231963407, 'recall': 0.3851645449744122, 'f1-score': 0.35215099083573215, 'support': 439272}, '1': {'precision': 0.3607849117990951, 'recall': 0.01485480096617953, 'f1-score': 0.028534725558823467, 'support': 477758}, '2': {'precision': 0.3276760261435368, 'recall': 0.6027490303322788, 'f1-score': 0.42455092034870406, 'support': 447576}, 'accuracy': 0.3268818985113652, 'macro avg': {'precision': 0.3376036537129909, 'recall': 0.3342561254242902, 'f1-score': 0.26841221224775325, 'support': 1364606}, 'weighted avg': {'precision': 0.3381970226996179, 'recall': 0.3268818985113652, 'f1-score': 0.26259709116471547, 'support': 1364606}}
[[169192   6459 263621]
 [180757   7097 289904]
 [171685   6115 269776]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993692
{'0': {'precision': 0.3415592924219262, 'recall': 0.4392024712159506, 'f1-score': 0.38427518427518426, 'support': 178050}, '1': {'precision': 0.33740306880052795, 'recall': 0.012230056635029992, 'f1-score': 0.023604506209889648, 'support': 167211}, '2': {'precision': 0.3257783596919026, 'recall': 0.5369918436233836, 'f1-score': 0.4055316730024514, 'support': 170051}, 'accuracy': 0.33292646008631666, 'macro avg': {'precision': 0.33491357363811886, 'recall': 0.3294747904914547, 'f1-score': 0.27113712116250843, 'support': 515312}, 'weighted avg': {'precision': 0.3350030125378349, 'recall': 0.33292646008631666, 'f1-score': 0.2742575297563385, 'support': 515312}}
[[78200  2025 97825]
 [74006  2045 91160]
 [76744  1991 91316]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.097648
{'0': {'precision': 0.3374966407739657, 'recall': 0.4367909372463936, 'f1-score': 0.38077706068350153, 'support': 60379}, '1': {'precision': 0.3412816691505216, 'recall': 0.01644288073526244, 'f1-score': 0.031374160843951227, 'support': 55708}, '2': {'precision': 0.3538341125826451, 'recall': 0.5555771158759419, 'f1-score': 0.4323283672236763, 'support': 61842}, 'accuracy': 0.3464696592461038, 'macro avg': {'precision': 0.34420414083571077, 'recall': 0.336270311285866, 'f1-score': 0.28149319625037633, 'support': 177929}, 'weighted avg': {'precision': 0.34436004298717166, 'recall': 0.3464696592461038, 'f1-score': 0.28929955648124006, 'support': 177929}}
[[26373   908 33098]
 [25146   916 29646]
 [26624   860 34358]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
4192/4192 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026822
{'0': {'precision': 0.2985514925228977, 'recall': 0.34878555170835185, 'f1-score': 0.32171941328218506, 'support': 310182}, '1': {'precision': 0.40734086242299794, 'recall': 0.014758843565093056, 'f1-score': 0.02848559229435112, 'support': 430115}, '2': {'precision': 0.3145457448507105, 'recall': 0.6569566745680525, 'f1-score': 0.42540897975382425, 'support': 332853}, 'accuracy': 0.31049247542282066, 'macro avg': {'precision': 0.34014603326553533, 'recall': 0.34016702328049914, 'f1-score': 0.25853799511012016, 'support': 1073150}, 'weighted avg': {'precision': 0.34711476392452006, 'recall': 0.31049247542282066, 'f1-score': 0.23635307899024294, 'support': 1073150}}
[[108187   4516 197479]
 [144723   6348 279044]
 [109463   4720 218670]]
Evaluating performance on  train set...
1230/1230 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099342
{'0': {'precision': 0.34031843957221225, 'recall': 0.3492961751741789, 'f1-score': 0.3447488691275325, 'support': 105495}, '1': {'precision': 0.37435645991664623, 'recall': 0.014307800421644413, 'f1-score': 0.027562181870690587, 'support': 106725}, '2': {'precision': 0.3324971606340428, 'recall': 0.6559763071497462, 'f1-score': 0.44130726150801064, 'support': 102647}, 'accuracy': 0.3357290538544846, 'macro avg': {'precision': 0.34905735337430044, 'recall': 0.3398600942485232, 'f1-score': 0.2712061041687446, 'support': 314867}, 'weighted avg': {'precision': 0.3493059705046168, 'recall': 0.3357290538544846, 'f1-score': 0.26871575071624293, 'support': 314867}}
[[36849  1328 67318]
 [37340  1527 67858]
 [34089  1224 67334]]
Evaluating performance on  val set...
400/400 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994066
{'0': {'precision': 0.3283011595413227, 'recall': 0.31411536924920863, 'f1-score': 0.32105163965322275, 'support': 32539}, '1': {'precision': 0.36893203883495146, 'recall': 0.012768102144817158, 'f1-score': 0.024682002706359948, 'support': 35714}, '2': {'precision': 0.33881447134924725, 'recall': 0.696487408802071, 'f1-score': 0.45586706204028193, 'support': 33992}, 'accuracy': 0.3359773094038828, 'macro avg': {'precision': 0.3453492232418405, 'recall': 0.3411236267320323, 'f1-score': 0.26720023479995486, 'support': 102245}, 'weighted avg': {'precision': 0.34598867206582395, 'recall': 0.3359773094038828, 'f1-score': 0.2623504867739686, 'support': 102245}}
[[10221   377 21941]
 [10998   456 24260]
 [ 9914   403 23675]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
6143/6143 - 104s - 104s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1051754
{'0': {'precision': 0.28418665729835746, 'recall': 0.3454938710067902, 'f1-score': 0.31185575511685054, 'support': 437837}, '1': {'precision': 0.4589208006962576, 'recall': 0.015537522246973821, 'f1-score': 0.03005740148548432, 'support': 678744}, '2': {'precision': 0.29140087158177447, 'recall': 0.6501608831354555, 'f1-score': 0.40243233556347213, 'support': 455921}, 'accuracy': 0.2914069425666867, 'macro avg': {'precision': 0.3448361098587965, 'recall': 0.3370640921297398, 'f1-score': 0.248115164055269, 'support': 1572502}, 'weighted avg': {'precision': 0.36169934931196, 'recall': 0.2914069425666867, 'f1-score': 0.2164834270667979, 'support': 1572502}}
[[151270   6058 280509]
 [227898  10546 440300]
 [153123   6376 296422]]
Evaluating performance on  train set...
2083/2083 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995454
{'0': {'precision': 0.3332742107130188, 'recall': 0.3076084993000045, 'f1-score': 0.31992743199685303, 'support': 177144}, '1': {'precision': 0.3438712458686593, 'recall': 0.013391832828737876, 'f1-score': 0.025779692970643687, 'support': 178691}, '2': {'precision': 0.33473739924356866, 'recall': 0.6845564938945327, 'f1-score': 0.44961843084545056, 'support': 177382}, 'accuracy': 0.3344079427325085, 'macro avg': {'precision': 0.33729428527508226, 'recall': 0.335185608674425, 'f1-score': 0.2651085186043158, 'support': 533217}, 'weighted avg': {'precision': 0.33731222547421835, 'recall': 0.3344079427325085, 'f1-score': 0.2644965194854919, 'support': 533217}}
[[ 54491   2285 120368]
 [ 55338   2393 120960]
 [ 53673   2281 121428]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0995691
{'0': {'precision': 0.32973257036085485, 'recall': 0.2954842760713725, 'f1-score': 0.31167039214062975, 'support': 57333}, '1': {'precision': 0.33054003724394787, 'recall': 0.012426056214778256, 'f1-score': 0.023951691799075664, 'support': 57138}, '2': {'precision': 0.3432965876675956, 'recall': 0.6879674475305592, 'f1-score': 0.45803377040729587, 'support': 60702}, 'accuracy': 0.33916185713551744, 'macro avg': {'precision': 0.3345230650907994, 'recall': 0.33195925993890335, 'f1-score': 0.2645519514490004, 'support': 175173}, 'weighted avg': {'precision': 0.33469623497423673, 'recall': 0.33916185713551744, 'f1-score': 0.26854090693130783, 'support': 175173}}
[[16941   736 39656]
 [16198   710 40230]
 [18239   702 41761]]
testing model on single stock: results/universal/W7/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
23942/23942 - 331s - 331s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1061491
{'0': {'precision': 0.28585025001375014, 'recall': 0.3379237545676642, 'f1-score': 0.30971341870385494, 'support': 1768683}, '1': {'precision': 0.43274754724536785, 'recall': 0.010779494368551515, 'f1-score': 0.021035018435680997, 'support': 2606523}, '2': {'precision': 0.28411940647107203, 'recall': 0.6436541612832966, 'f1-score': 0.3942225660062405, 'support': 1753858}, 'accuracy': 0.28628433313797996, 'macro avg': {'precision': 0.33423906791006336, 'recall': 0.3307858034065041, 'f1-score': 0.24165700104859214, 'support': 6129064}, 'weighted avg': {'precision': 0.34782635763442005, 'recall': 0.28628433313797996, 'f1-score': 0.21112905968382606, 'support': 6129064}}
[[ 597680   18034 1152969]
 [ 887021   28097 1691405]
 [ 606184   18796 1128878]]
Evaluating performance on  train set...
9052/9052 - 126s - 126s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002499
{'0': {'precision': 0.3357205728894605, 'recall': 0.36201998280380804, 'f1-score': 0.348374635909098, 'support': 772264}, '1': {'precision': 0.34097058566815047, 'recall': 0.01004922357432348, 'f1-score': 0.019523055721794583, 'support': 777473}, '2': {'precision': 0.3305941884693155, 'recall': 0.6296167424476408, 'f1-score': 0.43354564984466615, 'support': 767343}, 'accuracy': 0.33253923041068933, 'macro avg': {'precision': 0.33576178234230886, 'recall': 0.3338953162752574, 'f1-score': 0.2671477804918529, 'support': 2317080}, 'weighted avg': {'precision': 0.33578446709465803, 'recall': 0.33253923041068933, 'f1-score': 0.2662377035387859, 'support': 2317080}}
[[279575   7363 485326]
 [276713   7813 492947]
 [276473   7738 483132]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004533
{'0': {'precision': 0.3222238582329352, 'recall': 0.3336173036569399, 'f1-score': 0.3278216159773715, 'support': 223028}, '1': {'precision': 0.36618950238582143, 'recall': 0.010882865362019368, 'f1-score': 0.02113753959353912, 'support': 246810}, '2': {'precision': 0.33763905292645385, 'recall': 0.666906689911023, 'f1-score': 0.44830958625306594, 'support': 237477}, 'accuracy': 0.3329025964386447, 'macro avg': {'precision': 0.3420174711817368, 'recall': 0.33713561964332744, 'f1-score': 0.26575624727465885, 'support': 707315}, 'weighted avg': {'precision': 0.3427407634641357, 'recall': 0.3329025964386447, 'f1-score': 0.2612606421889851, 'support': 707315}}
[[ 74406   2298 146324]
 [ 79757   2686 164367]
 [ 76751   2351 158375]]
training model: results/universal/W7/deepVOL_L3/h1000
Epoch 1/50
12475/12475 - 673s - loss: 3.2803 - accuracy1000: 0.3686 - val_loss: 3.3155 - val_accuracy1000: 0.3169 - 673s/epoch - 54ms/step
Epoch 2/50
12475/12475 - 671s - loss: 3.2758 - accuracy1000: 0.3704 - val_loss: 3.3214 - val_accuracy1000: 0.3172 - 671s/epoch - 54ms/step
Epoch 3/50
12475/12475 - 683s - loss: 3.2596 - accuracy1000: 0.3856 - val_loss: 3.3413 - val_accuracy1000: 0.3193 - 683s/epoch - 55ms/step
Epoch 4/50
12475/12475 - 679s - loss: 3.2361 - accuracy1000: 0.4019 - val_loss: 3.3450 - val_accuracy1000: 0.3174 - 679s/epoch - 54ms/step
Epoch 5/50
12475/12475 - 682s - loss: 3.2258 - accuracy1000: 0.4081 - val_loss: 3.3572 - val_accuracy1000: 0.3166 - 682s/epoch - 55ms/step
Epoch 6/50
12475/12475 - 687s - loss: 3.2185 - accuracy1000: 0.4118 - val_loss: 3.3745 - val_accuracy1000: 0.3169 - 687s/epoch - 55ms/step
Epoch 7/50
12475/12475 - 677s - loss: 3.2132 - accuracy1000: 0.4145 - val_loss: 3.3864 - val_accuracy1000: 0.3169 - 677s/epoch - 54ms/step
Epoch 8/50
12475/12475 - 682s - loss: 3.2096 - accuracy1000: 0.4162 - val_loss: 3.3825 - val_accuracy1000: 0.3167 - 682s/epoch - 55ms/step
Epoch 9/50
12475/12475 - 681s - loss: 3.2071 - accuracy1000: 0.4176 - val_loss: 3.3936 - val_accuracy1000: 0.3168 - 681s/epoch - 55ms/step
Epoch 10/50
12475/12475 - 688s - loss: 3.2059 - accuracy1000: 0.4184 - val_loss: 3.3900 - val_accuracy1000: 0.3173 - 688s/epoch - 55ms/step
Epoch 11/50
12475/12475 - 682s - loss: 3.2021 - accuracy1000: 0.4205 - val_loss: 3.4054 - val_accuracy1000: 0.3169 - 682s/epoch - 55ms/step
testing model in sample: results/universal/W7/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
37134/37134 - 1117s - 1117s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1038771
{'0': {'precision': 0.3193651541611926, 'recall': 0.9975385815483218, 'f1-score': 0.4838304490134578, 'support': 3035648}, '1': {'precision': 0.37958226768968456, 'recall': 0.000514319658475575, 'f1-score': 0.0010272474354141967, 'support': 3462827}, '2': {'precision': 0.3097428886902571, 'recall': 0.0019590322493753943, 'f1-score': 0.003893439643424112, 'support': 3007097}, 'accuracy': 0.3193756251596432, 'macro avg': {'precision': 0.3362301035137114, 'recall': 0.3333373111520576, 'f1-score': 0.1629170453640987, 'support': 9505572}, 'weighted avg': {'precision': 0.33825790053749416, 'recall': 0.3193756251596432, 'f1-score': 0.15611938615722018, 'support': 9505572}}
[[3028176    1480    5992]
 [3453910    1781    7136]
 [2999775    1431    5891]]
Evaluating performance on  train set...
12475/12475 - 368s - 368s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006765
{'0': {'precision': 0.33798167937684886, 'recall': 0.997321330124983, 'f1-score': 0.5048686861864398, 'support': 1079267}, '1': {'precision': 0.3155688622754491, 'recall': 0.0005019296193716261, 'f1-score': 0.00100226508104654, 'support': 1049948}, '2': {'precision': 0.33447812453337317, 'recall': 0.002105522390444688, 'f1-score': 0.004184702297663105, 'support': 1063869}, 'accuracy': 0.33796260918911, 'macro avg': {'precision': 0.32934288872855705, 'recall': 0.33330959404493316, 'f1-score': 0.17001855118838313, 'support': 3193084}, 'weighted avg': {'precision': 0.32944459864932835, 'recall': 0.33796260918911, 'f1-score': 0.1723701642676508, 'support': 3193084}}
[[1076376     600    2291]
 [1047255     527    2166]
 [1061086     543    2240]]
Evaluating performance on  val set...
3866/3866 - 113s - 113s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1039774
{'0': {'precision': 0.31682007214669355, 'recall': 0.9972880274387812, 'f1-score': 0.48087499788465765, 'support': 313425}, '1': {'precision': 0.37575757575757573, 'recall': 0.0005561020237927951, 'f1-score': 0.0011105604747944566, 'support': 334471}, '2': {'precision': 0.33618233618233617, 'recall': 0.0020743848628503453, 'f1-score': 0.004123327082338415, 'support': 341306}, 'accuracy': 0.316890786714948, 'macro avg': {'precision': 0.3429199946955352, 'recall': 0.33330617144180813, 'f1-score': 0.1620362951472635, 'support': 989202}, 'weighted avg': {'precision': 0.3434287351489766, 'recall': 0.316890786714948, 'f1-score': 0.1541616502572057, 'support': 989202}}
[[312575    146    704]
 [333591    186    694]
 [340435    163    708]]
testing model out of sample: results/universal/W7/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
14746/14746 - 425s - 425s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107817
{'0': {'precision': 0.277300025233409, 'recall': 0.9973832843554988, 'f1-score': 0.43394999815029656, 'support': 1046732}, '1': {'precision': 0.41316073354908306, 'recall': 0.00047842706173333, 'f1-score': 0.0009557473982085351, 'support': 1601080}, '2': {'precision': 0.29531622122254564, 'recall': 0.00198144613609126, 'f1-score': 0.003936480165924756, 'support': 1126450}, 'accuracy': 0.27740284060830966, 'macro avg': {'precision': 0.32859232666834587, 'recall': 0.33328105251777446, 'f1-score': 0.14628074190480994, 'support': 3774262}, 'weighted avg': {'precision': 0.34031054406915023, 'recall': 0.27740284060830966, 'f1-score': 0.12192948597396945, 'support': 3774262}}
[[1043993     521    2218]
 [1597206     766    3108]
 [1123651     567    2232]]
Evaluating performance on  train set...
5285/5285 - 166s - 166s/epoch - 31ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004915
{'0': {'precision': 0.33954180845892074, 'recall': 0.9976461929729824, 'f1-score': 0.5066491655645543, 'support': 459256}, '1': {'precision': 0.33668341708542715, 'recall': 0.00045033640801822854, 'f1-score': 0.0008994697156154207, 'support': 446333}, '2': {'precision': 0.3300715092209259, 'recall': 0.001961718528062417, 'f1-score': 0.003900256607532787, 'support': 447057}, 'accuracy': 0.3395219443963905, 'macro avg': {'precision': 0.33543224492175794, 'recall': 0.33335274930302106, 'f1-score': 0.17048296396256749, 'support': 1352646}, 'weighted avg': {'precision': 0.3354686378264376, 'recall': 0.3395219443963905, 'f1-score': 0.17360548821738173, 'support': 1352646}}
[[458175    182    899]
 [445251    201    881]
 [445966    214    877]]
Evaluating performance on  val set...
1714/1714 - 49s - 49s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014637
{'0': {'precision': 0.33061193660908017, 'recall': 0.9974519390122638, 'f1-score': 0.49661695236916464, 'support': 144816}, '1': {'precision': 0.27586206896551724, 'recall': 0.00047011811717694073, 'f1-score': 0.0009386366302944972, 'support': 136136}, '2': {'precision': 0.35906040268456374, 'recall': 0.0020435186717765244, 'f1-score': 0.004063908441788626, 'support': 157082}, 'accuracy': 0.3306410004702831, 'macro avg': {'precision': 0.3218448027530537, 'recall': 0.33332185860040575, 'f1-score': 0.1672064991470826, 'support': 438034}, 'weighted avg': {'precision': 0.3237981138614054, 'recall': 0.3306410004702831, 'f1-score': 0.16593284922277213, 'support': 438034}}
[[144447     86    283]
 [135782     64    290]
 [156679     82    321]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095539
{'0': {'precision': 0.28324545987111893, 'recall': 0.9979756281506768, 'f1-score': 0.44125415726984746, 'support': 50386}, '1': {'precision': 0.4296875, 'recall': 0.0007969051103351348, 'f1-score': 0.0015908597874032828, 'support': 69017}, '2': {'precision': 0.40671641791044777, 'recall': 0.00186257924505733, 'f1-score': 0.0037081766997227373, 'support': 58521}, 'accuracy': 0.2835367909894112, 'macro avg': {'precision': 0.37321645926052227, 'recall': 0.3335450375020231, 'f1-score': 0.14885106458565783, 'support': 177924}, 'weighted avg': {'precision': 0.38066140273995364, 'recall': 0.2835367909894112, 'f1-score': 0.12679478061863617, 'support': 177924}}
[[50284    35    67]
 [68870    55    92]
 [58374    38   109]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001598
{'0': {'precision': 0.3437447803574411, 'recall': 0.9981408131921429, 'f1-score': 0.5113784606464705, 'support': 24742}, '1': {'precision': 0.3170731707317073, 'recall': 0.0005250615937638838, 'f1-score': 0.0010483870967741937, 'support': 24759}, '2': {'precision': 0.34234234234234234, 'recall': 0.0016892642809513225, 'f1-score': 0.0033619393081482794, 'support': 22495}, 'accuracy': 0.34372742930162786, 'macro avg': {'precision': 0.3343867644771636, 'recall': 0.33345171302228604, 'f1-score': 0.1719295956837977, 'support': 71996}, 'weighted avg': {'precision': 0.3341343821981935, 'recall': 0.34372742930162786, 'f1-score': 0.17715025437775433, 'support': 71996}}
[[24696    14    32]
 [24705    13    41]
 [22443    14    38]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1053809
{'0': {'precision': 0.30968895632383225, 'recall': 0.9980789381767377, 'f1-score': 0.47270471464019853, 'support': 5726}, '1': {'precision': 0.35294117647058826, 'recall': 0.0009048408988086261, 'f1-score': 0.0018050541516245488, 'support': 6631}, '2': {'precision': 0.32432432432432434, 'recall': 0.0019509022923101934, 'f1-score': 0.0038784744667097605, 'support': 6151}, 'accuracy': 0.3097579425113464, 'macro avg': {'precision': 0.3289848190395816, 'recall': 0.33364489378928547, 'f1-score': 0.15946274775284427, 'support': 18508}, 'weighted avg': {'precision': 0.3300492124489763, 'recall': 0.3097579425113464, 'f1-score': 0.14818094913301982, 'support': 18508}}
[[5715    3    8]
 [6608    6   17]
 [6131    8   12]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
2006/2006 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0914621
{'0': {'precision': 0.3958810961630391, 'recall': 0.9984302262639385, 'f1-score': 0.5669603998161316, 'support': 203214}, '1': {'precision': 0.25225225225225223, 'recall': 0.00048575269983085396, 'f1-score': 0.0009696382037452275, 'support': 115285}, '2': {'precision': 0.3827993254637437, 'recall': 0.0011651123281202684, 'f1-score': 0.002323153757982643, 'support': 194831}, 'accuracy': 0.39580386885629126, 'macro avg': {'precision': 0.343644224626345, 'recall': 0.3333603637639632, 'f1-score': 0.19008439725928647, 'support': 513330}, 'weighted avg': {'precision': 0.3586594536769785, 'recall': 0.39580386885629126, 'f1-score': 0.2255443823629549, 'support': 513330}}
[[202895     90    229]
 [115092     56    137]
 [194528     76    227]]
Evaluating performance on  train set...
538/538 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0965456
{'0': {'precision': 0.3652707691635538, 'recall': 0.9982885231546896, 'f1-score': 0.5348437999786758, 'support': 50249}, '1': {'precision': 0.26785714285714285, 'recall': 0.0003527917587845148, 'f1-score': 0.0007046554234979096, 'support': 42518}, '2': {'precision': 0.26, 'recall': 0.0008711190529372347, 'f1-score': 0.001736420302760463, 'support': 44770}, 'accuracy': 0.3651162959785367, 'macro avg': {'precision': 0.2977093040068989, 'recall': 0.33317081132213716, 'f1-score': 0.1790949585683114, 'support': 137537}, 'weighted avg': {'precision': 0.30088951249263407, 'recall': 0.3651162959785367, 'f1-score': 0.1961876889955383, 'support': 137537}}
[[50163    24    62]
 [42454    15    49]
 [44714    17    39]]
Evaluating performance on  val set...
153/153 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1026845
{'0': {'precision': 0.3272787911439493, 'recall': 0.9982784255419047, 'f1-score': 0.4929479500753507, 'support': 12779}, '1': {'precision': 0.3125, 'recall': 0.0003846153846153846, 'f1-score': 0.0007682851874615858, 'support': 13000}, '2': {'precision': 0.41818181818181815, 'recall': 0.0017331022530329288, 'f1-score': 0.0034518985441993094, 'support': 13271}, 'accuracy': 0.3274007682458387, 'macro avg': {'precision': 0.3526535364419225, 'recall': 0.3334653810598511, 'f1-score': 0.16572271126900387, 'support': 39050}, 'weighted avg': {'precision': 0.3532518970837244, 'recall': 0.3274007682458387, 'f1-score': 0.1627446787971825, 'support': 39050}}
[[12757     6    16]
 [12979     5    16]
 [13243     5    23]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
930/930 - 14s - 14s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030062
{'0': {'precision': 0.32227104776430043, 'recall': 0.997691374610338, 'f1-score': 0.4871760577284394, 'support': 76669}, '1': {'precision': 0.3584905660377358, 'recall': 0.00045857166992493905, 'f1-score': 0.0009159716530877886, 'support': 82866}, '2': {'precision': 0.3436213991769547, 'recall': 0.002129830378778217, 'f1-score': 0.004233421212735754, 'support': 78410}, 'accuracy': 0.32233079072895, 'macro avg': {'precision': 0.34146100432633036, 'recall': 0.33342659221968035, 'f1-score': 0.16410848353142096, 'support': 237945}, 'weighted avg': {'precision': 0.341920326612407, 'recall': 0.32233079072895, 'f1-score': 0.15868854833796509, 'support': 237945}}
[[76492    29   148]
 [82657    38   171]
 [78204    39   167]]
Evaluating performance on  train set...
381/381 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018183
{'0': {'precision': 0.3288827217596875, 'recall': 0.9974749049192593, 'f1-score': 0.49466637808422487, 'support': 32078}, '1': {'precision': 0.23529411764705882, 'recall': 0.0002484009190834006, 'f1-score': 0.0004962779156327543, 'support': 32206}, '2': {'precision': 0.29949238578680204, 'recall': 0.0017751301260643258, 'f1-score': 0.003529341389005204, 'support': 33237}, 'accuracy': 0.3287907219983388, 'macro avg': {'precision': 0.2878897417311828, 'recall': 0.333166145321469, 'f1-score': 0.16623066579628762, 'support': 97521}, 'weighted avg': {'precision': 0.2879586009981888, 'recall': 0.3287907219983388, 'f1-score': 0.16407948977638664, 'support': 97521}}
[[31997     8    73]
 [32133     8    65]
 [33160    18    59]]
Evaluating performance on  val set...
114/114 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057419
{'0': {'precision': 0.3026197862805929, 'recall': 0.9977270144334583, 'f1-score': 0.46438678621492235, 'support': 8799}, '1': {'precision': 0.35714285714285715, 'recall': 0.0005263711969681019, 'f1-score': 0.0010511931041732366, 'support': 9499}, '2': {'precision': 0.5094339622641509, 'recall': 0.0025048705816866127, 'f1-score': 0.004985228951255539, 'support': 10779}, 'accuracy': 0.3030230078756405, 'macro avg': {'precision': 0.38973220189586694, 'recall': 0.3335860854040377, 'f1-score': 0.15680773609011703, 'support': 29077}, 'weighted avg': {'precision': 0.3970987439807483, 'recall': 0.3030230078756405, 'f1-score': 0.1427196890348807, 'support': 29077}}
[[ 8779     4    16]
 [ 9484     5    10]
 [10747     5    27]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1065/1065 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107447
{'0': {'precision': 0.27979000308818985, 'recall': 0.99850429032512, 'f1-score': 0.43710047038957905, 'support': 76218}, '1': {'precision': 0.3680555555555556, 'recall': 0.0005558060761139717, 'f1-score': 0.0011099360216123393, 'support': 95357}, '2': {'precision': 0.3811074918566775, 'recall': 0.0011597938144329897, 'f1-score': 0.0023125500311304815, 'support': 100880}, 'accuracy': 0.2799508175662036, 'macro avg': {'precision': 0.34298435016680767, 'recall': 0.333406630071889, 'f1-score': 0.14684098548077396, 'support': 272455}, 'weighted avg': {'precision': 0.34819633277050666, 'recall': 0.2799508175662036, 'f1-score': 0.12352151316182955, 'support': 272455}}
[[ 76104     38     76]
 [ 95190     53    114]
 [100710     53    117]]
Evaluating performance on  train set...
401/401 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993598
{'0': {'precision': 0.3485926837126205, 'recall': 0.9980991781740929, 'f1-score': 0.5167181609661151, 'support': 35774}, '1': {'precision': 0.30357142857142855, 'recall': 0.000501208797688543, 'f1-score': 0.0010007652911049626, 'support': 33918}, '2': {'precision': 0.3741496598639456, 'recall': 0.0016697024893746206, 'f1-score': 0.0033245685616707468, 'support': 32940}, 'accuracy': 0.3486047236729285, 'macro avg': {'precision': 0.34210459071599825, 'recall': 0.3334233631537187, 'f1-score': 0.17368116493963026, 'support': 102632}, 'weighted avg': {'precision': 0.34191655796768416, 'recall': 0.3486047236729285, 'f1-score': 0.18150801636884148, 'support': 102632}}
[[35706    20    48]
 [33857    17    44]
 [32866    19    55]]
Evaluating performance on  val set...
123/123 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058822
{'0': {'precision': 0.3083625917650814, 'recall': 0.9984497726333196, 'f1-score': 0.4711993366824367, 'support': 9676}, '1': {'precision': 0.4117647058823529, 'recall': 0.0007394105841343615, 'f1-score': 0.0014761703922395615, 'support': 9467}, '2': {'precision': 0.47058823529411764, 'recall': 0.0013074031704526884, 'f1-score': 0.0026075619295958283, 'support': 12238}, 'accuracy': 0.3085943723909372, 'macro avg': {'precision': 0.39690517764718397, 'recall': 0.33349886212930224, 'f1-score': 0.1584276896680907, 'support': 31381}, 'weighted avg': {'precision': 0.4028218263291984, 'recall': 0.3085943723909372, 'f1-score': 0.14675157036859832, 'support': 31381}}
[[ 9661     4    11]
 [ 9453     7     7]
 [12216     6    16]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
1646/1646 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1137824
{'0': {'precision': 0.25824181053352874, 'recall': 0.9977386380350052, 'f1-score': 0.4102895592348983, 'support': 108784}, '1': {'precision': 0.43455497382198954, 'recall': 0.0004676477879696198, 'f1-score': 0.0009342901364851555, 'support': 177484}, '2': {'precision': 0.3408521303258145, 'recall': 0.0020145611293392682, 'f1-score': 0.004005448588153001, 'support': 135017}, 'accuracy': 0.2584782273282932, 'macro avg': {'precision': 0.34454963822711093, 'recall': 0.33340694898410467, 'f1-score': 0.13840976598651214, 'support': 421285}, 'weighted avg': {'precision': 0.358996793550926, 'recall': 0.2584782273282932, 'f1-score': 0.10762207202824634, 'support': 421285}}
[[108538     50    196]
 [177071     83    330]
 [134687     58    272]]
Evaluating performance on  train set...
526/526 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013453
{'0': {'precision': 0.3351381141405942, 'recall': 0.9976499800470005, 'f1-score': 0.5017309718528925, 'support': 45106}, '1': {'precision': 0.3684210526315789, 'recall': 0.0006200726370803437, 'f1-score': 0.001238061549345596, 'support': 45156}, '2': {'precision': 0.3346613545816733, 'recall': 0.001894537417113988, 'f1-score': 0.003767745408060284, 'support': 44338}, 'accuracy': 0.3351560178306092, 'macro avg': {'precision': 0.3460735071179488, 'recall': 0.33338819670039826, 'f1-score': 0.16891225960343279, 'support': 134600}, 'weighted avg': {'precision': 0.34614692398588004, 'recall': 0.3351560178306092, 'f1-score': 0.16979225423195687, 'support': 134600}}
[[45000    22    84]
 [45045    28    83]
 [44228    26    84]]
Evaluating performance on  val set...
146/146 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.107507
{'0': {'precision': 0.2960388599645752, 'recall': 0.9976485484308583, 'f1-score': 0.45659057513607487, 'support': 11057}, '1': {'precision': 0.2, 'recall': 0.00022314787265694734, 'f1-score': 0.000445798350546103, 'support': 13444}, '2': {'precision': 0.3, 'recall': 0.0016347501167678655, 'f1-score': 0.0032517807370703003, 'support': 12846}, 'accuracy': 0.2960077114627681, 'macro avg': {'precision': 0.2653462866548584, 'recall': 0.3331688154734277, 'f1-score': 0.1534293847412304, 'support': 37347}, 'weighted avg': {'precision': 0.262829723260993, 'recall': 0.2960077114627681, 'f1-score': 0.13645775236706364, 'support': 37347}}
[[11031     6    20]
 [13412     3    29]
 [12819     6    21]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
5929/5929 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0876329
{'0': {'precision': 0.4177998384846346, 'recall': 0.9979385703425412, 'f1-score': 0.5890051027888699, 'support': 634026}, '1': {'precision': 0.18270799347471453, 'recall': 0.00035438888484576173, 'f1-score': 0.0007074056529291014, 'support': 316037}, '2': {'precision': 0.37798668233450844, 'recall': 0.001700410565452591, 'f1-score': 0.0033855907154121557, 'support': 567510}, 'accuracy': 0.4176378994618381, 'macro avg': {'precision': 0.3261648380979525, 'recall': 0.3333311232642798, 'f1-score': 0.19769936638573704, 'support': 1517573}, 'weighted avg': {'precision': 0.3539531005233252, 'recall': 0.4176378994618381, 'f1-score': 0.24749351250190557, 'support': 1517573}}
[[632719    243   1064]
 [315401    112    524]
 [566287    258    965]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016935
{'0': {'precision': 0.3300424452724587, 'recall': 0.9976209357652657, 'f1-score': 0.4959950809784535, 'support': 105924}, '1': {'precision': 0.32786885245901637, 'recall': 0.000375971651737459, 'f1-score': 0.0007510820275459333, 'support': 106391}, '2': {'precision': 0.34977578475336324, 'recall': 0.002153645090333447, 'f1-score': 0.004280931559978779, 'support': 108653}, 'accuracy': 0.3300827496822113, 'macro avg': {'precision': 0.33589569416161275, 'recall': 0.33338351750244555, 'f1-score': 0.16700903152199276, 'support': 320968}, 'weighted avg': {'precision': 0.3360020294727646, 'recall': 0.3300827496822113, 'f1-score': 0.1653835503300663, 'support': 320968}}
[[105672     37    215]
 [106131     40    220]
 [108374     45    234]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1023976
{'0': {'precision': 0.3255741376461733, 'recall': 0.9976093376459008, 'f1-score': 0.49093085860997504, 'support': 35555}, '1': {'precision': 0.3157894736842105, 'recall': 0.0003341408403642135, 'f1-score': 0.0006675753108397541, 'support': 35913}, '2': {'precision': 0.3788546255506608, 'recall': 0.002278568211323954, 'f1-score': 0.004529892020015801, 'support': 37743}, 'accuracy': 0.3256814789718984, 'macro avg': {'precision': 0.3400727456270149, 'recall': 0.33340734889919627, 'f1-score': 0.16537610864694355, 'support': 109211}, 'weighted avg': {'precision': 0.3407701235643784, 'recall': 0.3256814789718984, 'f1-score': 0.1616136929844732, 'support': 109211}}
[[35470    12    73]
 [35833    12    68]
 [37643    14    86]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
5331/5331 - 77s - 77s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1167656
{'0': {'precision': 0.24150222479459763, 'recall': 0.99762426346099, 'f1-score': 0.38886825746752324, 'support': 329582}, '1': {'precision': 0.4890190336749634, 'recall': 0.00048620148538920866, 'f1-score': 0.0009714371307121013, 'support': 686958}, '2': {'precision': 0.2662311147407105, 'recall': 0.0018732079548131675, 'f1-score': 0.0037202402179649947, 'support': 348066}, 'accuracy': 0.24167048950393008, 'macro avg': {'precision': 0.33225079107009053, 'recall': 0.3333278909670641, 'f1-score': 0.13118664493873347, 'support': 1364606}, 'weighted avg': {'precision': 0.3724124932551071, 'recall': 0.24167048950393008, 'f1-score': 0.0953580767436221, 'support': 1364606}}
[[328799    167    616]
 [685443    334   1181]
 [347232    182    652]]
Evaluating performance on  train set...
2013/2013 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992659
{'0': {'precision': 0.34773722570959636, 'recall': 0.9979964058087488, 'f1-score': 0.5157640313002044, 'support': 179178}, '1': {'precision': 0.384, 'recall': 0.0005735417998458607, 'f1-score': 0.0011453728725593715, 'support': 167381}, '2': {'precision': 0.3341404358353511, 'recall': 0.0016355264795292529, 'f1-score': 0.0032551200325512007, 'support': 168753}, 'accuracy': 0.34773302387679694, 'macro avg': {'precision': 0.3552925538483158, 'recall': 0.3334018246960413, 'f1-score': 0.173388174735105, 'support': 515312}, 'weighted avg': {'precision': 0.35506327350559863, 'recall': 0.34773302387679694, 'f1-score': 0.18077318697787556, 'support': 515312}}
[[178819     72    287]
 [167022     96    263]
 [168395     82    276]]
Evaluating performance on  val set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959935
{'0': {'precision': 0.362022150365605, 'recall': 0.9978572094034347, 'f1-score': 0.5312918533705915, 'support': 64402}, '1': {'precision': 0.26582278481012656, 'recall': 0.0004652502381638124, 'f1-score': 0.0009288747346072188, 'support': 45137}, '2': {'precision': 0.43452380952380953, 'recall': 0.0021348150314373445, 'f1-score': 0.004248755929342606, 'support': 68390}, 'accuracy': 0.3621163497799684, 'macro avg': {'precision': 0.35412291489984704, 'recall': 0.3334857582243453, 'f1-score': 0.1788231613448471, 'support': 177929}, 'weighted avg': {'precision': 0.36548554141907, 'recall': 0.3621163497799684, 'f1-score': 0.19417159079001478, 'support': 177929}}
[[64264    20   118]
 [45044    21    72]
 [68206    38   146]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
4192/4192 - 61s - 61s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1077799
{'0': {'precision': 0.2918528427843695, 'recall': 0.9975668555919215, 'f1-score': 0.45158721095790605, 'support': 313175}, '1': {'precision': 0.37448559670781895, 'recall': 0.0004375978283606672, 'f1-score': 0.0008741741575867029, 'support': 415907}, '2': {'precision': 0.32882273342354534, 'recall': 0.00211876722043317, 'f1-score': 0.004210404724432187, 'support': 344068}, 'accuracy': 0.2919666402646415, 'macro avg': {'precision': 0.3317203909719113, 'recall': 0.33337440688023845, 'f1-score': 0.15222392994664166, 'support': 1073150}, 'weighted avg': {'precision': 0.3357308627428842, 'recall': 0.2919666402646415, 'f1-score': 0.13347441222180267, 'support': 1073150}}
[[312413    138    624]
 [414861    182    864]
 [343173    166    729]]
Evaluating performance on  train set...
1230/1230 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992752
{'0': {'precision': 0.3453502219335282, 'recall': 0.9976177117155235, 'f1-score': 0.5130837297203964, 'support': 108719}, '1': {'precision': 0.36666666666666664, 'recall': 0.0005368210433849006, 'f1-score': 0.001072072511086204, 'support': 102455}, '2': {'precision': 0.3626707132018209, 'recall': 0.0023048807537635134, 'f1-score': 0.00458065010732904, 'support': 103693}, 'accuracy': 0.34539662778252406, 'macro avg': {'precision': 0.3582292006006719, 'recall': 0.33348647117089064, 'f1-score': 0.17291215077960387, 'support': 314867}, 'weighted avg': {'precision': 0.3579904479534565, 'recall': 0.34539662778252406, 'f1-score': 0.17901771399408126, 'support': 314867}}
[[108460     43    216]
 [102196     55    204]
 [103402     52    239]]
Evaluating performance on  val set...
400/400 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.103191
{'0': {'precision': 0.322067633418635, 'recall': 0.9969346565904883, 'f1-score': 0.48685341633318513, 'support': 32949}, '1': {'precision': 0.2571428571428571, 'recall': 0.00026099060433824384, 'f1-score': 0.0005214519539963498, 'support': 34484}, '2': {'precision': 0.2831050228310502, 'recall': 0.0017809950591749972, 'f1-score': 0.003539721960549228, 'support': 34812}, 'accuracy': 0.3219619541297863, 'macro avg': {'precision': 0.2874385044641808, 'recall': 0.33299221408466717, 'f1-score': 0.16363819674924357, 'support': 102245}, 'weighted avg': {'precision': 0.286904717042588, 'recall': 0.3219619541297863, 'f1-score': 0.15827218704909155, 'support': 102245}}
[[32848    17    84]
 [34402     9    73]
 [34741     9    62]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
6143/6143 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060742
{'0': {'precision': 0.30603895722968544, 'recall': 0.9971847724236512, 'f1-score': 0.46834228225576274, 'support': 481311}, '1': {'precision': 0.36772486772486773, 'recall': 0.00047541277971116107, 'f1-score': 0.0009495978726274997, 'support': 584755}, '2': {'precision': 0.3168688619295205, 'recall': 0.0021661177325466596, 'f1-score': 0.004302821348583443, 'support': 506436}, 'accuracy': 0.3060924564801825, 'macro avg': {'precision': 0.3302108956280246, 'recall': 0.3332754343119697, 'f1-score': 0.15786490049232457, 'support': 1572502}, 'weighted avg': {'precision': 0.33246550435533356, 'recall': 0.3060924564801825, 'f1-score': 0.1450889588384008, 'support': 1572502}}
[[479956    240   1115]
 [583227    278   1250]
 [505101    238   1097]]
Evaluating performance on  train set...
2083/2083 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012851
{'0': {'precision': 0.3340581209442302, 'recall': 0.9969127486640621, 'f1-score': 0.5004268796086796, 'support': 178152}, '1': {'precision': 0.35, 'recall': 0.0004354440115138183, 'f1-score': 0.0008698058751433203, 'support': 176831}, '2': {'precision': 0.3192279138827023, 'recall': 0.0024125587710537833, 'f1-score': 0.004788925331744449, 'support': 178234}, 'accuracy': 0.3340272346905669, 'macro avg': {'precision': 0.3344286782756442, 'recall': 0.3332535838155432, 'f1-score': 0.1686952036051891, 'support': 533217}, 'weighted avg': {'precision': 0.3343877640161999, 'recall': 0.3340272346905669, 'f1-score': 0.16908577073936334, 'support': 533217}}
[[177602     61    489]
 [176326     77    428]
 [177722     82    430]]
Evaluating performance on  val set...
685/685 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1045107
{'0': {'precision': 0.31303481789718907, 'recall': 0.9974102713743799, 'f1-score': 0.4765161779377105, 'support': 54832}, '1': {'precision': 0.3333333333333333, 'recall': 0.0004558404558404558, 'f1-score': 0.0009104358711733241, 'support': 61425}, '2': {'precision': 0.32894736842105265, 'recall': 0.0021216647430239662, 'f1-score': 0.004216135995682677, 'support': 58916}, 'accuracy': 0.31307907040468563, 'macro avg': {'precision': 0.3251051732171917, 'recall': 0.3333292588577481, 'f1-score': 0.16054758326818883, 'support': 175173}, 'weighted avg': {'precision': 0.32550443443243765, 'recall': 0.31307907040468563, 'f1-score': 0.15089458113059093, 'support': 175173}}
[[54690    34   108]
 [61250    28   147]
 [58769    22   125]]
testing model on single stock: results/universal/W7/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
23942/23942 - 341s - 341s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079427
{'0': {'precision': 0.29515709739956975, 'recall': 0.9973012937980061, 'f1-score': 0.455504884513155, 'support': 1809015}, '1': {'precision': 0.4281279105867743, 'recall': 0.000547169893672867, 'f1-score': 0.001092942949012111, 'support': 2520241}, '2': {'precision': 0.29015157171656836, 'recall': 0.002159119194936349, 'f1-score': 0.004286342220195114, 'support': 1799808}, 'accuracy': 0.2952160395127217, 'macro avg': {'precision': 0.3378121932343041, 'recall': 0.3333358609622051, 'f1-score': 0.15362805656078743, 'support': 6129064}, 'weighted avg': {'precision': 0.34836416295301514, 'recall': 0.2952160395127217, 'f1-score': 0.13615198687874222, 'support': 6129064}}
[[1804133     923    3959]
 [2513314    1379    5548]
 [1795003     919    3886]]
Evaluating performance on  train set...
9052/9052 - 132s - 132s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010346
{'0': {'precision': 0.33600537639759726, 'recall': 0.9972437744107701, 'f1-score': 0.5026506404716451, 'support': 778601}, '1': {'precision': 0.32634032634032634, 'recall': 0.0005492594152218093, 'f1-score': 0.0010966730334628888, 'support': 764666}, '2': {'precision': 0.324313408723748, 'recall': 0.002075436830345316, 'f1-score': 0.004124479143258877, 'support': 773813}, 'accuracy': 0.3359750202841507, 'macro avg': {'precision': 0.32888637048722386, 'recall': 0.333289490218779, 'f1-score': 0.1692905975494556, 'support': 2317080}, 'weighted avg': {'precision': 0.3289111320259323, 'recall': 0.3359750202841507, 'f1-score': 0.1706434199436152, 'support': 2317080}}
[[776455    433   1713]
 [762613    420   1633]
 [771773    434   1606]]
Evaluating performance on  val set...
2763/2763 - 39s - 39s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043131
{'0': {'precision': 0.31452599583476876, 'recall': 0.9972535128963527, 'f1-score': 0.47822389686030503, 'support': 222466}, '1': {'precision': 0.35467980295566504, 'recall': 0.0005960092215871229, 'f1-score': 0.0011900187180027518, 'support': 241607}, '2': {'precision': 0.34799482535575677, 'recall': 0.0022117890824775326, 'f1-score': 0.0043956403091654815, 'support': 243242}, 'accuracy': 0.31462219803058045, 'macro avg': {'precision': 0.33906687471539687, 'recall': 0.3333537704001391, 'f1-score': 0.16126985196249108, 'support': 707315}, 'weighted avg': {'precision': 0.33975162502035444, 'recall': 0.31462219803058045, 'f1-score': 0.15232997834261555, 'support': 707315}}
[[221855    136    475]
 [240930    144    533]
 [242578    126    538]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        90 (peak)  21.97 (ave)

============================================
